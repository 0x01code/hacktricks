# WmicExec

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§ï‡§ø‡§∏‡•Ä **‡§∏‡§æ‡§á‡§¨‡§∞ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡§Ç‡§™‡§®‡•Ä** ‡§Æ‡•á‡§Ç ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç? ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä **‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡•ã HackTricks ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§ø‡§§** ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç? ‡§Ø‡§æ ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™‡§ï‡•ã **PEASS ‡§ï‡•á ‡§®‡§µ‡•Ä‡§®‡§§‡§Æ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§Ø‡§æ HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó** ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•à? [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Ç**](https://github.com/sponsors/carlospolop) ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç!

- ‡§ñ‡•ã‡§ú‡•á‡§Ç [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ‡§π‡§Æ‡§æ‡§∞‡§æ ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π [**NFTs**](https://opensea.io/collection/the-peass-family)

- ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ **‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç ‡§Æ‡•Å‡§ù‡•á **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **‡§Ö‡§™‡§®‡•á ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç, [hacktricks ‡§∞‡•á‡§™‡•ã](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [hacktricks-cloud ‡§∞‡•á‡§™‡•ã](https://github.com/carlospolop/hacktricks-cloud)** ‡§ï‡•ã PR ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡§ï‡•á‡•§

</details>

## ‡§Ø‡§π ‡§ï‡•à‡§∏‡•á ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à

Wmi ‡§â‡§® ‡§π‡•ã‡§∏‡•ç‡§ü‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ñ‡•ã‡§≤‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§ú‡§π‡§æ‡§Ç ‡§Ü‡§™ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§®‡§æ‡§Æ / (‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° / ‡§π‡•à‡§∂) ‡§ï‡•ã ‡§ú‡§æ‡§®‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§´‡§ø‡§∞, Wmiexec wmi ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§Ü‡§¶‡•á‡§∂ ‡§ï‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à (‡§á‡§∏‡§≤‡§ø‡§è Wmicexec ‡§Ü‡§™‡§ï‡•ã ‡§Ö‡§∞‡•ç‡§ß-‡§∏‡§Ç‡§µ‡§æ‡§¶‡§æ‡§§‡•ç‡§Æ‡§ï ‡§∂‡•à‡§≤ ‡§¶‡•á‡§§‡§æ ‡§π‡•à)‡•§

**dcomexec.py:** ‡§Ø‡§π ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü wmiexec.py ‡§ï‡•á ‡§∏‡§Æ‡§æ‡§® ‡§Ö‡§∞‡•ç‡§ß-‡§∏‡§Ç‡§µ‡§æ‡§¶‡§æ‡§§‡•ç‡§Æ‡§ï ‡§∂‡•à‡§≤ ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ø‡§π ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® DCOM ‡§Ö‡§Ç‡§§-‡§¨‡§ø‡§Ç‡§¶‡•Å‡§ì‡§Ç (ShellBrowserWindow DCOM ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü) ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§µ‡§∞‡•ç‡§§‡§Æ‡§æ‡§® ‡§Æ‡•á‡§Ç, ‡§á‡§∏‡§Æ‡•á‡§Ç MMC20 ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§π‡•à‡•§ ‡§Ü‡§µ‡•á‡§¶‡§®, ‡§∂‡•à‡§≤ ‡§µ‡§ø‡§Ç‡§°‡•ã‡§ú ‡§î‡§∞ ‡§∂‡•à‡§≤ ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞ ‡§µ‡§ø‡§Ç‡§°‡•ã ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü (‡§Ø‡§π‡§æ‡§Ç ‡§∏‡•á) (https://www.hackingarticles.in/beginners-guide-to-impacket-tool-kit-part-1/))

## WMI ‡§Æ‡•Ç‡§≤‡§≠‡•Ç‡§§

### ‡§®‡•á‡§Æ‡§∏‡•ç‡§™‡•á‡§∏

WMI ‡§ï‡•ã ‡§è‡§ï ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ-‡§∂‡•à‡§≤‡•Ä‡§Ø ‡§µ‡§∞‡•ç‡§ó‡•Ä‡§ï‡§∞‡§£ ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§≠‡§æ‡§ú‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à, \root ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Ö‡§®‡•ç‡§Ø ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ‡§è‡§Ç \root ‡§ï‡•á ‡§®‡•Ä‡§ö‡•á ‡§π‡•à‡§Ç‡•§ ‡§á‡§® "‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§ï‡§æ ‡§™‡§•‡•ã‡§Ç" ‡§ï‡•ã ‡§®‡•á‡§Æ‡§∏‡•ç‡§™‡•á‡§∏ ‡§ï‡§π‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§\
‡§®‡•á‡§Æ‡§∏‡•ç‡§™‡•á‡§∏ ‡§∏‡•Ç‡§ö‡•Ä:
```bash
#Get Root namespaces
gwmi -namespace "root" -Class "__Namespace" | Select Name

#List all namespaces (you may need administrator to list all of them)
Get-WmiObject -Class "__Namespace" -Namespace "Root" -List -Recurse 2> $null | select __Namespace | sort __Namespace

#List namespaces inside "root\cimv2"
Get-WmiObject -Class "__Namespace" -Namespace "root\cimv2" -List -Recurse 2> $null | select __Namespace | sort __Namespace
```
‡§®‡§æ‡§Æ‡§∏‡•ç‡§•‡§æ‡§® ‡§ï‡•Ä ‡§ï‡§ï‡•ç‡§∑‡§æ‡§ì‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§¨‡§®‡§æ‡§è‡§Å:
```bash
gwmwi -List -Recurse #If no namespace is specified, by default is used: "root\cimv2"
gwmi -Namespace "root/microsoft" -List -Recurse
```
### **‡§ï‡§ï‡•ç‡§∑‡§æ‡§è‡§Ç**

WMI ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§®‡§æ‡§Æ ‡§ú‡•à‡§∏‡•á win32\_process ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä WMI ‡§ï‡§æ‡§∞‡•ç‡§∞‡§µ‡§æ‡§à ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§™‡•ç‡§∞‡§æ‡§∞‡§Ç‡§≠‡§ø‡§ï ‡§¨‡§ø‡§Ç‡§¶‡•Å ‡§π‡•à‡•§ ‡§π‡§Æ‡•á‡§Ç ‡§π‡§Æ‡•á‡§∂‡§æ ‡§è‡§ï ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§â‡§∏‡§ï‡•á ‡§∏‡•ç‡§•‡§æ‡§®‡§æ‡§Ç‡§§‡§∞‡§£ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§®‡§®‡•á ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡•§\
`win32` ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§®‡•á ‡§µ‡§æ‡§≤‡•Ä ‡§ï‡§ï‡•ç‡§∑‡§æ‡§ì‡§Ç ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä:
```bash
Get-WmiObject -Recurse -List -class win32* | more #If no namespace is specified, by default is used: "root\cimv2"
gwmi -Namespace "root/microsoft" -List -Recurse -Class "MSFT_MpComput*"
```
‡§ï‡§ï‡•ç‡§∑‡§æ ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç:
```bash
#When you don't specify a namespaces by default is "root/cimv2"
Get-WmiObject -Class win32_share
Get-WmiObject -Namespace "root/microsoft/windows/defender" -Class MSFT_MpComputerStatus
```
### ‡§µ‡§ø‡§ß‡§ø‡§Ø‡§æ‡§Å

WMI ‡§ï‡§ï‡•ç‡§∑‡§æ‡§ì‡§Ç ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§Ø‡§æ ‡§Ö‡§ß‡§ø‡§ï ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§®‡•ç‡§µ‡§ø‡§§ ‡§ï‡§ø‡§è ‡§ú‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§á‡§® ‡§ï‡§æ‡§∞‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§µ‡§ø‡§ß‡§ø‡§Ø‡§æ‡§Å ‡§ï‡§π‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§
```bash
#Load a class using [wmiclass], leist methods and call one
$c = [wmiclass]"win32_share"
$c.methods
#Find information about the class in https://docs.microsoft.com/en-us/windows/win32/cimwin32prov/win32-share
$c.Create("c:\share\path","name",0,$null,"My Description")
#If returned value is "0", then it was successfully executed
```

```bash
#List methods
Get-WmiObject -Query 'Select * From Meta_Class WHERE __Class LIKE "win32%"' | Where-Object { $_.PSBase.Methods } | Select-Object Name, Methods
#Call create method from win32_share class
Invoke-WmiMethod -Class win32_share -Name Create -ArgumentList @($null, "Description", $null, "Name", $null, "c:\share\path",0)
```
## WMI ‡§ú‡§æ‡§Ç‡§ö

### WMI ‡§∏‡•á‡§µ‡§æ ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç

‡§Ø‡§π‡§æ‡§Å ‡§Ü‡§™ ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§ï‡•ç‡§Ø‡§æ WMI ‡§∏‡•á‡§µ‡§æ ‡§ö‡§≤ ‡§∞‡§π‡•Ä ‡§π‡•à:
```bash
#Check if WMI service is running
Get-Service Winmgmt
Status   Name               DisplayName
------   ----               -----------
Running  Winmgmt            Windows Management Instrumentation

#From CMD
net start | findstr "Instrumentation"
```
### ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä

To gather system information using WMIC, you can use the following command:

WMIC COMPUTERSYSTEM GET NAME, MANUFACTURER, MODEL, USERNAME, DOMAIN, TOTALPHYSICALMEMORY, TOTALVIRTUALMEMORYSIZE, OSNAME, OSARCHITECTURE, OSVERSION, LASTBOOTUPTIME

This command will provide you with the following information:

- **NAME**: The name of the computer.
- **MANUFACTURER**: The manufacturer of the computer.
- **MODEL**: The model of the computer.
- **USERNAME**: The username of the currently logged-in user.
- **DOMAIN**: The domain of the computer.
- **TOTALPHYSICALMEMORY**: The total physical memory (RAM) of the computer.
- **TOTALVIRTUALMEMORYSIZE**: The total virtual memory size of the computer.
- **OSNAME**: The name of the operating system.
- **OSARCHITECTURE**: The architecture of the operating system.
- **OSVERSION**: The version of the operating system.
- **LASTBOOTUPTIME**: The date and time when the computer was last booted up.

You can use this information to gain a better understanding of the target system and its configuration.
```bash
Get-WmiObject -ClassName win32_operatingsystem | select * | more
```
### ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä

To obtain information about running processes on a Windows system, you can use the `wmic` command. This command allows you to query various attributes of processes, such as their process ID (PID), parent process ID (PPID), command line arguments, and more.

To list all running processes, you can execute the following command:

```
wmic process get Caption,ProcessId,CommandLine
```

This will display the name of the process (`Caption`), its process ID (`ProcessId`), and the command line used to launch the process (`CommandLine`).

You can also filter the results based on specific criteria. For example, to find all processes with a specific name, you can use the `where` clause:

```
wmic process where "Name='process_name'" get Caption,ProcessId,CommandLine
```

Replace `process_name` with the name of the process you want to find.

Additionally, you can sort the results based on a specific attribute. For example, to sort the processes by their process ID in ascending order, you can use the `order by` clause:

```
wmic process get Caption,ProcessId,CommandLine /order by ProcessId
```

This will display the processes sorted by their process ID.

By using the `wmic` command, you can gather valuable information about running processes on a Windows system, which can be useful for troubleshooting, monitoring, or security purposes.
```bash
Get-WmiObject win32_process | Select Name, Processid
```
‡§è‡§ï ‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§ï‡•á ‡§¶‡•É‡§∑‡•ç‡§ü‡§ø‡§ï‡•ã‡§£ ‡§∏‡•á, WMI ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§Ø‡§æ ‡§°‡•ã‡§Æ‡•á‡§® ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤ ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§Æ‡•á‡§Ç ‡§¨‡§π‡•Å‡§§ ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§
```
wmic computerystem list full /format:list
wmic process list /format:list
wmic ntdomain list /format:list
wmic useraccount list /format:list
wmic group list /format:list
wmic sysaccount list /format:list
```

```bash
Get-WmiObject Win32_Processor -ComputerName 10.0.0.182 -Credential $cred
```
## **‡§Æ‡•à‡§®‡•Å‡§Ö‡§≤ ‡§∞‡§ø‡§Æ‡•ã‡§ü WMI ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä**

‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ø‡§π‡§æ‡§Ç ‡§è‡§ï ‡§¨‡§π‡•Å‡§§ ‡§π‡•Ä ‡§õ‡§ø‡§™‡•Ä ‡§§‡§∞‡•Ä‡§ï‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§∏‡•á ‡§∞‡§ø‡§Æ‡•ã‡§ü ‡§Æ‡§∂‡•Ä‡§® ‡§™‡§∞ ‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à (‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§°‡•ã‡§Æ‡•á‡§® ‡§ï‡§Ç‡§™‡•ç‡§Ø‡•Ç‡§ü‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§π‡•à):
```bash
wmic /node:ordws01 path win32_groupuser where (groupcomponent="win32_group.name=\"administrators\",domain=\"ORDWS01\"")
```
‡§è‡§ï ‡§î‡§∞ ‡§â‡§™‡§Ø‡•ã‡§ó‡•Ä ‡§µ‡§®‡§≤‡§æ‡§á‡§®‡§∞ ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§Æ‡§∂‡•Ä‡§® ‡§™‡§∞ ‡§ï‡•å‡§® ‡§≤‡•â‡§ó ‡§á‡§® ‡§π‡•à ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à (‡§ú‡§¨ ‡§Ü‡§™ ‡§è‡§°‡§Æ‡§ø‡§® ‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•ã‡§Ç):
```
wmic /node:ordws01 path win32_loggedonuser get antecedent
```
`wmic` ‡§è‡§ï ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§´‡§º‡§æ‡§á‡§≤ ‡§∏‡•á ‡§®‡•ã‡§° ‡§™‡§¢‡§º ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§â‡§® ‡§™‡§∞ ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§ö‡§≤‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•á ‡§™‡§æ‡§∏ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§∏‡•ç‡§•‡§≤‡•ã‡§Ç ‡§ï‡•Ä ‡§è‡§ï ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§´‡§º‡§æ‡§á‡§≤ ‡§π‡•à:
```
wmic /node:@workstations.txt path win32_loggedonuser get antecedent
```
**‡§π‡§Æ WMI ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§¶‡•Ç‡§∞‡§∏‡•ç‡§• ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§è‡§ï ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§¨‡§®‡§æ‡§è‡§Ç‡§ó‡•á ‡§§‡§æ‡§ï‡§ø ‡§è‡§ï Empire ‡§è‡§ú‡•á‡§Ç‡§ü ‡§ï‡•ã ‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ‡§®‡•ç‡§µ‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á:**
```bash
wmic /node:ordws01 /user:CSCOU\jarrieta path win32_process call create "**empire launcher string here**"
```
‡§π‡§Æ ‡§á‡§∏‡•á ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§π‡•ã‡§§‡•á ‡§¶‡•á‡§ñ‡§§‡•á ‡§π‡•à‡§Ç (ReturnValue = 0)‡•§ ‡§î‡§∞ ‡§è‡§ï ‡§∏‡•á‡§ï‡§Ç‡§° ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§π‡§Æ‡§æ‡§∞‡•á ‡§è‡§Æ‡•ç‡§™‡§æ‡§Ø‡§∞ ‡§∏‡•Å‡§®‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§®‡•á ‡§á‡§∏‡•á ‡§™‡§ï‡§°‡§º ‡§≤‡§ø‡§Ø‡§æ ‡§π‡•à‡•§ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§Ü‡§à‡§°‡•Ä WMI ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§µ‡§æ‡§™‡§∏ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§

‡§Ø‡§π ‡§∏‡§≠‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§Ø‡§π‡§æ‡§Ç ‡§∏‡•á ‡§®‡§ø‡§ï‡§æ‡§≤‡•Ä ‡§ó‡§à ‡§π‡•à: [https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/](https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ **‡§∏‡§æ‡§á‡§¨‡§∞ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡§Ç‡§™‡§®‡•Ä** ‡§Æ‡•á‡§Ç ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç? ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä ‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡•ã **‡§π‡•à‡§ï‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§ø‡§§** ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç? ‡§Ø‡§æ ‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™‡§ï‡•ã **PEASS ‡§ï‡•Ä ‡§®‡§µ‡•Ä‡§®‡§§‡§Æ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§Ø‡§æ HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó** ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è? [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§è‡§Ç**](https://github.com/sponsors/carlospolop) ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç!

- ‡§ñ‡•ã‡§ú‡•á‡§Ç [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ‡§π‡§Æ‡§æ‡§∞‡§æ ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFT**](https://opensea.io/collection/the-peass-family) ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•§

- ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS ‡§î‡§∞ HackTricks swag**](https://peass.creator-spring.com)

- **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** [**üí¨**](https://emojipedia.org/speech-balloon/) [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ ‡§Æ‡•Å‡§ù‡•á **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** ‡§™‡§∞ **‡§´‡§º‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **‡§Ö‡§™‡§®‡•á ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§ï‡•ã [hacktricks ‡§∞‡•á‡§™‡•ã](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [hacktricks-cloud ‡§∞‡•á‡§™‡•ã](https://github.com/carlospolop/hacktricks-cloud) ‡§Æ‡•á‡§Ç ‡§™‡•Ä‡§Ü‡§∞ ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡§ï‡•á ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§**

</details>
