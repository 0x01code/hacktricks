# AD рдкреНрд░рдорд╛рдгрдкрддреНрд░

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ рджреЗрдЦреЗрдВ
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓** рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ**ред

</details>

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рднрд╛рдЧ

* **рд╡рд┐рд╖рдп** - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рдорд╛рд▓рд┐рдХред
* **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА** - рд╡рд┐рд╖рдп рдХреЛ рдПрдХ рдЕрд▓рдЧ рд╕реНрдерд╛рди рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдирд┐рдЬреА рдХреБрдВрдЬреА рд╕реЗ рдЬреЛрдбрд╝рддрд╛ рд╣реИред
* **NotBefore рдФрд░ NotAfter рддрд┐рдерд┐рдпрд╛рдБ** - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреА рдорд╛рдиреНрдпрддрд╛ рдХреА рдЕрд╡рдзрд┐ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреА рд╣реИрдВред
* **рдзрд╛рд░рд╛рдХ рдХреНрд░рдорд╛рдВрдХ** - CA рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ред
* **рдЬрд╛рд░рдХ** - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рдЬрд╛рд░реА рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреЛ рдкрд╣рдЪрд╛рдирддрд╛ рд╣реИ (рд╕рд╛рдорд╛рдиреНрдпрддрдГ CA рд╣реЛрддрд╛ рд╣реИ)ред
* **SubjectAlternativeName** - рд╡рд┐рд╖рдп рджреНрд╡рд╛рд░рд╛ рдЬрд╛рдиреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рдирд╛рдореЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред (_рдиреАрдЪреЗ рджреЗрдЦреЗрдВ_)
* **рдореВрд▓рднреВрдд рд╕реАрдорд╛рдПрдВ** - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдПрдХ CA рд╣реИ рдпрд╛ рдПрдХ рдЕрдВрдд рдЗрдХрд╛рдИ рд╣реИ, рдФрд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдХреЛрдИ рд╕реАрдорд╛рдПрдВ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВ, рдЗрд╕реЗ рдкрд╣рдЪрд╛рдирддрд╛ рд╣реИред
* **рд╡рд┐рд╕реНрддреГрдд рдХреБрдВрдЬреА рдЙрдкрдпреЛрдЧ (EKUs)** - рд╡рд╕реНрддреНрд░ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рд╡рд░реНрдгрди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╡рд╕реНрддреНрд░ рдЪрд┐рдиреНрд╣рд┐рддрдХрд░рдг (OIDs)ред рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рднрд╛рд╖рд╛ рдореЗрдВ рд╡рд┐рд╕реНрддреГрдд рдХреБрдВрдЬреА рдЙрдкрдпреЛрдЧ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рд╕рд╛рдорд╛рдиреНрдп EKU OIDs рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:
* рдХреЛрдб рд╕рд╛рдЗрдирд┐рдВрдЧ (OID 1.3.6.1.5.5.7.3.3) - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рдХреЛрдб рд╕рд╛рдЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред
* рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди (OID 1.3.6.1.4.1.311.10.3.4) - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред
* рд╕реБрд░рдХреНрд╖рд┐рдд рдИрдореЗрд▓ (1.3.6.1.5.5.7.3.4) - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдИрдореЗрд▓ рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред
* рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░рдорд╛рдгреАрдХрд░рдг (OID 1.3.6.1.5.5.7.3.2) - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд┐рд╕реА рдЕрдиреНрдп рд╕рд░реНрд╡рд░ (рдЬреИрд╕реЗ, AD рдХреЗ рд▓рд┐рдП) рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рд╣реИред
* рд╕реНрдорд╛рд░реНрдЯ рдХрд╛рд░реНрдб рд▓реЙрдЧрдСрди (OID 1.3.6.1.4.1.311.20.2.2) - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рд╕реНрдорд╛рд░реНрдЯ рдХрд╛рд░реНрдб рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред
* рд╕рд░реНрд╡рд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг (OID 1.3.6.1.5.5.7.3.1) - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕рд░реНрд╡рд░реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рд╣реИ (рдЬреИрд╕реЗ, HTTPS рдкреНрд░рдорд╛рдгрдкрддреНрд░)ред
* **рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдПрд▓реНрдЧреЛрд░рд┐рджрдо** - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред
* **рд╣рд╕реНрддрд╛рдХреНрд╖рд░** - рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд╢рд░реАрд░ рдХреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЛ рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдЬрд╛рд░рдХ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП
* **AIA** (Authority Information Access) рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдЖрдВрддрд░рд┐рдХ рдФрд░ рдХреНрд░реЙрд╕ рд╕реАрдП рдХреЗ AD рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рд╣реЛрддреЗ рд╣реИрдВред **рдЖрдВрддрд░рд┐рдХ рд╕реАрдП рд░реВрдЯ рд╕реАрдП рдХреЗ "рдмрдЪреНрдЪреЗ" рд╣реЛрддреЗ рд╣реИрдВ** PKI рдЯреНрд░реА рд╣рд╛рдЗрдпрд░рд╛рд░реНрдХреА рдореЗрдВ; рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдпрд╣ рдХрдВрдЯреЗрдирд░ рдкреНрд░рдорд╛рдгрд┐рдд рдкрддреНрд░ рд╢реНрд░реГрдВрдЦрд▓рд╛рдУрдВ рдХреА **рдкреНрд░рдорд╛рдгрд┐рдд рдкрддреНрд░ рд╢реНрд░реГрдВрдЦрд▓рд╛рдУрдВ рдХреА рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореМрдЬреВрдж рд╣реЛрддрд╛ рд╣реИ**ред рдкреНрд░рдорд╛рдгрд┐рдд рдкреНрд░рд╛рдзрд┐рдХрд░рдгреЛрдВ рдХреЗ рдХрдВрдЯреЗрдирд░ рдХреА рддрд░рд╣, рдкреНрд░рддреНрдпреЗрдХ **рд╕реАрдП рдХреЛ рдПрдбреА рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рддрд┐рд╖реНрдард┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рдЬрд╣рд╛рдВ objectClass рд╡рд┐рд╢реЗрд╖рддрд╛ certificationAuthority рдкрд░ рд╕реЗрдЯ рдХреА рдЬрд╛рддреА рд╣реИ рдФрд░ **`cACertificate`** рд╕рдВрдкрддреНрддрд┐ рдореЗрдВ **рд╕реАрдП рдХреЗ рдкреНрд░рдорд╛рдг рдкрддреНрд░** рдХреЗ **рдмрд╛рдЗрдЯреНрд╕** рд╣реЛрддреЗ рд╣реИрдВред рдпреЗ рд╕реАрдП рд╡рд┐рдВрдбреЛрдЬ рдорд╢реАрди рдкрд░ рд╣рд░ рдмрд╛рд░ Intermediate Certification Authorities рдкреНрд░рдорд╛рдгрд┐рдд рдкрддреНрд░ рд╕рдВрдЧреНрд░рд╣ рдореЗрдВ рдкреНрд░рд╕рд╛рд░рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред

### рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЕрдиреБрд░реЛрдз рдлреНрд▓реЛ

<figure><img src="../../.gitbook/assets/image (5) (2) (2).png" alt=""><figcaption></figcaption></figure>

рдпрд╣ AD CS рд╕реЗ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реИред рдЙрдЪреНрдЪ рд╕реНрддрд░ рдкрд░, рдкрдВрдЬреАрдХрд░рдг рдХреЗ рджреМрд░рд╛рди рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд╣рд▓реЗ **рдПрдВрдЯрд░рдкреНрд░рд╛рдЗрдЬ рд╕реАрдП рдвреВрдВрдврддреЗ рд╣реИрдВ** рдЬреЛ рдкрд╣рд▓реЗ рд╣реА рдЪрд░реНрдЪрд┐рдд рдкрдВрдЬреАрдХрд░рдг рд╕реЗрд╡рд╛рдУрдВ рдХреЗ **рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ**ред

1. рдлрд┐рд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдХ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ-рдирд┐рдЬреА рдХреБрдВрдЬреА рдЬреЛрдбрд╝реА** рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВ рдФрд░
2. рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХреЗ рд╡рд┐рд╖рдп рдФрд░ **рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рдирд╛рдо** рдЬреИрд╕реА рдЕрдиреНрдп рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ **рдкреНрд░рдорд╛рдг рдкрддреНрд░ рд╕рд╛рдЗрдирд┐рдВрдЧ рдЕрдиреБрд░реЛрдз (CSR)** рд╕рдВрджреЗрд╢ рдореЗрдВ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рд░рдЦрддреЗ рд╣реИрдВред рдлрд┐рд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдЕрдкрдиреА рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде CSR рдХреЛ **рд╕рд╛рдЗрди рдХрд░рддреЗ рд╣реИрдВ** рдФрд░ CSR рдХреЛ рдПрдХ рдПрдВрдЯрд░рдкреНрд░рд╛рдЗрдЬ рд╕реАрдП рд╕рд░реНрд╡рд░ рдХреЛ рднреЗрдЬрддреЗ рд╣реИрдВред
3. **рд╕реАрдП** рд╕рд░реНрд╡рд░ рдпрд╣ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ **рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддрд╛ рд╣реИ** рдпрд╛ рдирд╣реАрдВред рдпрджрд┐ рд╣рд╛рдВ, рддреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╡рд╣ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЬрд╛рд░реА рдХрд░реЗрдЧрд╛ рдпрд╛ рдирд╣реАрдВ, рдЬрд┐рд╕реЗ CSR рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рд╕реАрдП рдпрд╣ рдЬрд╛рдВрдЪреЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рдПрдбреА рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА **рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рддреА рд╣реИрдВ рдХрд┐ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЦрд╛рддреЗ рдХреЛ **рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ** рдпрд╛ рдирд╣реАрдВред
4. рдпрджрд┐ рд╣рд╛рдВ, рддреЛ **рд╕реАрдП рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЙрддреНрдкрдиреНрди** рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ (рдЬреИрд╕реЗ EKUs, рдЧрдгрд┐рддреАрдп рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдФрд░ рдЬрд╛рд░реА рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ) рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд "рдирдХрд╝реНрд╢рд╛" рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдФрд░ рдпрджрд┐ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХреЗ рдЯреЗрдореНрдкрд▓реЗрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрдорддрд┐ рд╣реИ, рддреЛ CSR рдореЗрдВ рджрд┐рдП рдЧрдП рдЕрдиреНрдп рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХреЛ **рд╕рд╛рдЗрди рдХрд░рддрд╛ рд╣реИ**ред рд╕реАрдП рдЕрдкрдиреА рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХреЛ рд╕рд╛рдЗрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╡рд╛рдкрд╕ рднреЗрдЬрддрд╛ рд╣реИред

### рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ

AD CS рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЛ AD рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдирдХрд╛ **objectClass** **`pKICertificateTemplate`** рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдВрдЯреЗрдирд░ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрддрд╛ рд╣реИ:

`CN=Certificate Templates,CN=Public Key Services,CN=Services,CN=Configuration,DC=<domain>,DC=<com>`

рдПрдбреА рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ **рдЗрд╕рдХреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреА рд╣реИрдВ, рдФрд░ рдЗрд╕рдХреА рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╡рд░рдгрд╛рд╡рд▓реА рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреА рд╣реИ** рдХрд┐ рдХреМрди рд╕реЗ **рдкреНрд░рдореБрдЦ рдЙрдореНрдореАрджрд╡рд╛рд░ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХреЗ рд▓рд┐рдП рдкрдВрдЬреАрдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдпрд╛ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХреЛ **рд╕рдВрдкрд╛рджрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдПрдбреА рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдкрд░ **`pKIExtendedKeyUsage`** рд╡рд┐рд╢реЗрд╖рддрд╛ рдореЗрдВ рдПрдХ **OID рдХрд╛ рдПрдХ рдПрд░реЗ** рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдЯреЗрдореНрдкрд▓реЗрдЯ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрддреЗ рд╣реИрдВред рдпреЗ EKU OIDs рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП **рдХреНрдпрд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** рдкрд░ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓рддреЗ рд╣реИрдВред рдЖрдк рдпрд╣рд╛рдВ [рд╕рдВрднрд╛рд╡рд┐рдд OIDs рдХреА рд╕реВрдЪреА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ](https://www.pkisolutions.com/object-identifiers-oid-in-pki/)ред

#### рдкреНрд░рдорд╛рдгреАрдХрд░рдг OIDs

* `1.3.6.1.5.5.7.3.2`: рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░рдорд╛рдгреАрдХрд░рдг
* `1.3.6.1.5.2.3.4`: PKINIT рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░рдорд╛рдгреАрдХрд░рдг (рдо
### рдЬрд╛рд░реА рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ

рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рдирд┐рдпрдВрддреНрд░рдг рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред

#### рдкреНрд░рдмрдВрдзрдХ рд╕реНрд╡реАрдХреГрддрд┐

**CA рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рдмрдВрдзрдХ рд╕реНрд╡реАрдХреГрддрд┐** рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЛ рд╕реЗрдЯ рдХрд░рддреА рд╣реИ рдЬрд┐рд╕рд╕реЗ AD рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ `msPKI-EnrollmentFlag` рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдкрд░ `CT_FLAG_PEND_ALL_REQUESTS` (0x2) рдмрд┐рдЯ рдЖрддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдЯреЗрдореНрдкрд▓реЗрдЯ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╕рднреА **рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЕрдиреБрд░реЛрдз** рдХреЛ **рдкреЗрдВрдбрд┐рдВрдЧ рд╕реНрдерд┐рддрд┐** рдореЗрдВ рд░рдЦ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЬреЛ `certsrv.msc` рдореЗрдВ "рдкреЗрдВрдбрд┐рдВрдЧ рдЕрдиреБрд░реЛрдз" рдЦрдВрдб рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ) рдЬрд┐рд╕рд╕реЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рдмрдВрдзрдХ рдХреЛ рдЕрдиреБрд░реЛрдз рдХреЛ **рд╕реНрд╡реАрдХреГрддрд┐ рдпрд╛ рдЕрд╕реНрд╡реАрдХреГрддрд┐** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ:

<figure><img src="../../.gitbook/assets/image (13) (2).png" alt=""><figcaption></figcaption></figure>

#### рдирд╛рдорд╛рдВрдХрди рдПрдЬреЗрдВрдЯ, рдЕрдзрд┐рдХреГрдд рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдФрд░ рдЖрд╡реЗрджрди рдиреАрддрд┐рдпрд╛рдБ

**рдЕрдзрд┐рдХреГрдд рд╣рд╕реНрддрд╛рдХреНрд╖рд░реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛** рдФрд░ **рдЖрд╡реЗрджрди рдиреАрддрд┐**ред рдкрд╣рд▓рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ CA рдЗрд╕реЗ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП CSR рдореЗрдВ **рд╣рд╕реНрддрд╛рдХреНрд╖рд░реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛** рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред рджреВрд╕рд░рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ CSR рд╕рд╛рдЗрди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдореЗрдВ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП **EKU OIDs** рдХреЛред

рдЗрди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХрд╛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрдпреЛрдЧ **рдирд╛рдорд╛рдВрдХрди рдПрдЬреЗрдВрдЯреЛрдВ** рдХреЗ рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИред рдирд╛рдорд╛рдВрдХрди рдПрдЬреЗрдВрдЯ рдПрдХ AD CS рд╢рдмреНрдж рд╣реИ рдЬрд┐рд╕реЗ рдПрдХ рдРрд╕реЗ рд╕рдВрдЧрдарди рдХреЛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рджреВрд╕рд░реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рд▓рд┐рдП, CA рдХреЛ рдирд╛рдорд╛рдВрдХрди рдПрдЬреЗрдВрдЯ рдЦрд╛рддреЗ рдХреЛ рдХрдо рд╕реЗ рдХрдо **рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЕрдиреБрд░реЛрдз рдПрдЬреЗрдВрдЯ EKU** (OID 1.3.6.1.4.1.311.20.2.1) рдХреЛ рд╕рдореЗрдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЬрд╛рд░реА рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдЬреИрд╕реЗ рд╣реА рдЬрд╛рд░реА рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдирд╛рдорд╛рдВрдХрди рдПрдЬреЗрдВрдЯ рджреВрд╕рд░реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП CSR рдХреЛ рд╕рд╛рдЗрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддрд╛ рд╣реИред CA рдХреЗрд╡рд▓ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЧреИрд░-рд╕рдореНрдкреВрд░реНрдг рд╕реЗрдЯ рдХреЗ рд╢рд░реНрддреЛрдВ рдХреЗ рддрд╣рдд рдирд╛рдорд╛рдВрдХрди рдПрдЬреЗрдВрдЯ рдХреЛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рд░реА рдХрд░реЗрдЧрд╛ (рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдиреАрддрд┐ рдореЙрдбреНрдпреВрд▓ `certpdef.dll` рдореЗрдВ рд▓рд╛рдЧреВ рдХреА рдЧрдИ рд╣реИ):

* CA рдХреЛ рд▓рдХреНрд╖реНрдп рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЗ рд▓рд┐рдП рдирд╛рдорд╛рдВрдХрди рдЕрдзрд┐рдХрд╛рд░ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ Windows рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
* рдпрджрд┐ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рдХрд╛ рд╕реНрдХреАрдорд╛ рд╕рдВрд╕реНрдХрд░рдг 1 рд╣реИ, рддреЛ CA рдХреЛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЬрд╛рд░реА рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕рд╛рдЗрди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдореЗрдВ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЕрдиреБрд░реЛрдз рдПрдЬреЗрдВрдЯ OID рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рдЯреЗрдореНрдкрд▓реЗрдЯ рдХрд╛ рд╕реНрдХреАрдорд╛ рд╕рдВрд╕реНрдХрд░рдг рдЙрд╕рдХреЗ AD рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ msPKI-Template-Schema-Version рдкреНрд░реЙрдкрд░реНрдЯреА рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* рдпрджрд┐ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рдХрд╛ рд╕реНрдХреАрдорд╛ рд╕рдВрд╕реНрдХрд░рдг 2 рд╣реИ:
* рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЛ "рдЗрд╕ рдЕрдзрд┐рдХреГрдд рд╣рд╕реНрддрд╛рдХреНрд╖рд░реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛" рд╕реЗрдЯ рдХрд░рдиреА рд╣реЛрдЧреА рдФрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдирд╛рдорд╛рдВрдХрди рдПрдЬреЗрдВрдЯреЛрдВ рдХреЛ CSR рдкрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рд╣реЛрдВрдЧреЗ (рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЗ mspkira-signature AD рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдиреЗ рдЗрд╕ рд╕реЗрдЯрд┐рдВрдЧ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рд╣реИ)ред рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рдпрд╣ рд╕реЗрдЯрд┐рдВрдЧ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ CA рдХреЛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЬрд╛рд░реА рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐рддрдиреЗ рдирд╛рдорд╛рдВрдХрди рдПрдЬреЗрдВрдЯреЛрдВ рдХреЛ CSR рдкрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рд╣реЛрдВрдЧреЗред
* рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреА "рдЖрд╡реЗрджрди рдиреАрддрд┐" рдЬрд╛рд░реА рдХрд░рдиреЗ рдХреА рдкреНрд░рддрд┐рдмрдВрдзрди рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреА рд╣реЛрдЧреА "рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЕрдиреБрд░реЛрдз рдПрдЬреЗрдВрдЯ" рдХреЗ рд░реВрдк рдореЗрдВред

### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЕрдиреБрд░реЛрдз

1. Windows **Client Certificate Enrolment Protocol** (MS-WCCE) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЬреЛ рд╡рд┐рднрд┐рдиреНрди AD CS рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╡рд┐рддрд░рд┐рдд рд╕рдВрдШрдЯрди
### рд╕реБрд░рдХреНрд╖рд┐рдд рдЪреИрдирд▓ (Schannel) рдкреНрд░рдорд╛рдгреАрдХрд░рдг

Schannel рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд░реНрдерди рдкреНрд░рджрд╛рддрд╛ (SSP) рд╣реИ рдЬрд┐рд╕реЗ Windows TLS/SSL рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╕рдордп рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред Schannel **рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░рдорд╛рдгреАрдХрд░рдг** (рдЕрдиреНрдп рдХреНрд╖рдорддрд╛рдУрдВ рдХреЗ рдмреАрдЪ) рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рджреВрд░рд╕реНрде рд╕рд░реНрд╡рд░ рдХреЛ **рдЬреБрдбрд╝рддреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкрд╣рдЪрд╛рди рд╕рддреНрдпрд╛рдкрд┐рдд** рдХрд░рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдорд┐рд▓рддреА рд╣реИред рдпрд╣ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдорд╛рдг рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдореБрдЦрддрд╛ рдкреНрд░рдорд╛рдг рдкрддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PKI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред\
**TLS рд╣реИрдВрдбрд╢реЗрдХ** рдХреЗ рджреМрд░рд╛рди, рд╕рд░реНрд╡рд░ **рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдПред рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдХреНрд▓рд╛рдЗрдВрдЯ рдЕрдкрдирд╛ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рд╕рд░реНрд╡рд░ рдХреЛ рднреЗрдЬрддрд╛ рд╣реИред рд╕рд░реНрд╡рд░ рдлрд┐рд░ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╕рд╣реА рд╣реИ рдФрд░ рд╕рдм рдХреБрдЫ рдареАрдХ рд╣реЛрдиреЗ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

<figure><img src="../../.gitbook/assets/image (8) (2) (1).png" alt=""><figcaption></figcaption></figure>

рдЬрдм рдПрдХ рдЦрд╛рддрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ AD рдореЗрдВ рдкреНрд░рдорд╛рдгрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ DC рдХреЛ рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдкреНрд░рдорд╛рдг рдХреЛ AD рдЦрд╛рддреЗ рд╕реЗ рдореИрдк рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред **Schannel** рдкрд╣рд▓реЗ **Kerberos рдХреЗ S4U2Self** рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдкреНрд░рдорд╛рдг рдкрддреНрд░** рдХреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдЦрд╛рддреЗ рд╕реЗ рдореИрдк рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред\
рдпрджрд┐ рдпрд╣ **рд╕рдлрд▓ рдирд╣реАрдВ рд╣реЛрддрд╛** рд╣реИ, рддреЛ рдпрд╣ **рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдЦрд╛рддреЗ рд╕реЗ рдореИрдк рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛, рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдХреЗ **SAN рдПрдХреНрд╕рдЯреЗрдВрд╢рди**, рд╡рд┐рд╖рдп рдФрд░ рдЬрд╛рд░реАрдХрд░реНрддрд╛ рдХреНрд╖реЗрддреНрд░реЛрдВ рдХрд╛ рд╕рдВрдпреЛрдЬрди, рдпрд╛ рдХреЗрд╡рд▓ рдЬрд╛рд░реАрдХрд░реНрддрд╛ рд╕реЗред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, AD рдкрд░рд┐рд╡реЗрд╢реЛрдВ рдореЗрдВ рдХрдИ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ Schannel рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдХреЗ AD рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред WinRM, RDP, рдФрд░ IIS рд╕рднреА Schannel рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рд▓рд┐рдП **рдЕрддрд┐рд░рд┐рдХреНрдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ**, рдФрд░ рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ - рдЬреИрд╕реЗ WinRM - рд╕рдХреНрд░рд┐рдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдг рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред\
рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЬреЛ рдЖрдорддреМрд░ рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ - рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ AD CS рд╕реЗрдЯрдЕрдк рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ - рд╣реИ **LDAPS**ред рдХрдорд╛рдВрдбрд▓рд╛рдЗрди рдЙрдкрдХрд░рдг `Get-LdapCurrentUser` рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ .NET рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ LDAP рдореЗрдВ рдкреНрд░рдорд╛рдгрд┐рдд рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгрд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдХрдорд╛рдВрдбрд▓рд╛рдЗрди рдЙрдкрдХрд░рдг рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдкреНрд░рдорд╛рдгрд┐рдд рд╣реЛ рд░рд╣реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП LDAP "рдореИрдВ рдХреМрди рд╣реВрдБ?" рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдХрд░рддрд╛ рд╣реИ:

<figure><img src="../../.gitbook/assets/image (2) (4).png" alt=""><figcaption></figcaption></figure>

## AD CS рдЬрд╛рдБрдЪ

AD рдХреЗ рд▓рд┐рдП рдЬреИрд╕реЗ рд╣реА, рдЕрдм рддрдХ рд╢рд╛рдорд┐рд▓ рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдбреЛрдореЗрди рдкреНрд░рдорд╛рдгрд┐рдд, рд▓реЗрдХрд┐рди рдЕрдиреБрдкреНрд░рдпреЛрдЧрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ LDAP рдХреНрд╡реЗрд░реА рдХрд░рдХреЗ рдЙрдкрд▓рдмреНрдз рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдпрджрд┐ рд╣рдо **рдПрдВрдЯрд░рдкреНрд░рд╛рдЗрдЬ CAs** рдФрд░ рдЙрдирдХреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо `CN=Configuration,DC=<domain>,DC=<com>` рдЦреЛрдЬ рдЖрдзрд╛рд░ рдкрд░ `(objectCategory=pKIEnrollmentService)` LDAP рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ LDAP рдХреНрд╡реЗрд░реА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣ рдЦреЛрдЬ рдЖрдзрд╛рд░ AD рд╡рдирд╕реНрдкрддрд┐ рдХреЗ рд╡рд┐рдиреНрдпрд╛рд╕ рдирд╛рдорд╛рдВрдХрди рд╕рдВрджрд░реНрдн рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ)ред рдкрд░рд┐рдгрд╛рдореЛрдВ рдореЗрдВ CA рд╕рд░реНрд╡рд░ рдХреЗ DNS рд╣реЛрд╕реНрдЯрдирд╛рдо, CA рдирд╛рдо рдЗрд╕реА рддрд░рд╣ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдкреНрд░рд╛рд░рдВрдн рдФрд░ рд╕рдорд╛рдкреНрддрд┐ рддрд┐рдерд┐рдпрд╛рдБ, рд╡рд┐рднрд┐рдиреНрди рдзреНрд╡рдЬ, рдкреНрд░рдХрд╛рд╢рд┐рдд рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ, рдФрд░ рдЕрдзрд┐рдХ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВрдЧреЗред

**рд╡рд┐рдХрд▓реНрдкреА рдЙрдкрдХрд░рдг рдЬреЛ рд╡рд┐рдХрд▓реНрдкреА рдкреНрд░рдорд╛рдг рдкрддреНрд░реЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:**

* [**Certify**](https://github.com/GhostPack/Certify) рдПрдХ C# рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ **AD CS рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╡рд┐рдиреНрдпрд╛рд╕ рдФрд░ рдЕрд╡рдпрд╡ рд╕реВрдЪрдирд╛ рдХреА рдЬрд╛рдБрдЪ рдХрд░ рд╕рдХрддрд╛ рд╣реИ** рдФрд░ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЛрдВ рд╕реЗ рдкреНрд░рдорд╛рдг рдкрддреНрд░ рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддрд╛ рд╣реИред
* [**Certipy**](https://github.com/ly4k/Certipy) рдПрдХ **python** рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рдХрд┐рд╕реА рднреА рд╕рд┐рд╕реНрдЯрдо рд╕реЗ (DC рддрдХ рдкрд╣реБрдВрдЪ рд╡рд╛рд▓реЗ) **Active Directory Certificate Services (AD CS)** рдХреА **рдЬрд╛рдБрдЪ рдФрд░ рджреБрд░реБрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдХреНрд╖рдо рд╣реИ рдЬреЛ BloodHound рдХреЗ рд▓рд┐рдП рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ [**Lyak**](https://twitter.com/ly4k\_) рдиреЗ рдмрдирд╛рдпрд╛ рд╣реИ (рдЕрдЪреНрдЫрд╛ рд╡реНрдпрдХреНрддрд┐ рдмреЗрд╣рддрд░ рд╣реИрдХрд░)ред
```bash
# https://github.com/GhostPack/Certify
Certify.exe cas #enumerate trusted root CA certificates, certificates defined by the NTAuthCertificates object, and various information about Enterprise CAs
Certify.exe find #enumerate certificate templates
Certify.exe find /vulnerable #Enumerate vulenrable certificate templater

# https://github.com/ly4k/Certipy
certipy find -u john@corp.local -p Passw0rd -dc-ip 172.16.126.128
certipy find -vulnerable [-hide-admins] -u john@corp.local -p Passw0rd -dc-ip 172.16.126.128 #Search vulnerable templates

certutil.exe -TCAInfo #enumerate Enterprise CAs
certutil -v -dstemplate #enumerate certificate templates
```
## рд╕рдВрджрд░реНрдн

* [https://www.specterops.io/assets/resources/Certified\_Pre-Owned.pdf](https://www.specterops.io/assets/resources/Certified\_Pre-Owned.pdf)
* [https://comodosslstore.com/blog/what-is-ssl-tls-client-authentication-how-does-it-work.html](https://comodosslstore.com/blog/what-is-ssl-tls-client-authentication-how-does-it-work.html)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣!
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ**ред

</details>
