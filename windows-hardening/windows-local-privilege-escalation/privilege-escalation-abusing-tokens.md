# Abusing Tokens

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a> <strong>рдХреЗ рд╕рд╛рде!</strong></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдПрдХреНрд╕реЗрд╕** рдЪрд╛рд╣рд┐рдП? [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдж рдкреАрдПрд╕ рдлреИрдорд┐рд▓реА**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореЗрд░рд╛** рдЯреНрд╡рд┐рдЯрд░ ЁЯРж[**@carlospolopm**](https://twitter.com/hacktricks\_live)\*\* рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ\*\*ред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ,** [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ**ред

</details>

## рдЯреЛрдХрди

рдЕрдЧрд░ рдЖрдкрдХреЛ **рд╡рд┐рдВрдбреЛрдЬ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрдиреНрд╕ рдХреНрдпрд╛ рд╣реИрдВ рдирд╣реАрдВ рдкрддрд╛** рддреЛ рдЗрд╕ рдкреЗрдЬ рдХреЛ рдкрдврд╝реЗрдВ рдЬрд╛рд░реА рд░рдЦреЗрдВ:

{% content-ref url="access-tokens.md" %}
[access-tokens.md](access-tokens.md)
{% endcontent-ref %}

**рд╢рд╛рдпрдж рдЖрдк рдЙрди рдЯреЛрдХрдиреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реИрдВ**

### SeImpersonatePrivilege

рдпрд╣ рдПрдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╣реИ рдЬреЛ рдХрд┐рд╕реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдХрд┐рд╕реА рднреА рдЯреЛрдХрди рдХрд╛ рдЕрдиреБрдХрд░рдг (рд▓реЗрдХрд┐рди рдирд┐рд░реНрдорд╛рдг рдирд╣реАрдВ) рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реИрдВрдбрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдПрдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХреГрдд рдЯреЛрдХрди рдХреЛ рд╡рд┐рдВрдбреЛрдЬ рд╕реЗрд╡рд╛ (DCOM) рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ NTLM рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдЦрд┐рд▓рд╛рдл рдПрдХ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХреЗ рдЦрд┐рд▓рд╛рдл рдЙрддреНрддреЗрдЬрд┐рдд рдХрд░рдХреЗ, рдмрд╛рдж рдореЗрдВ SYSTEM рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдХрд░рдиреЗ рдХреА рд╕реНрд╡реАрдХреГрддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдЧрдбрд╝рдмрдбрд╝реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрдИ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ [juicy-potato](https://github.com/ohpe/juicy-potato), [RogueWinRM](https://github.com/antonioCoco/RogueWinRM) (рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП winrm рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ), [SweetPotato](https://github.com/CCob/SweetPotato), рдФрд░ [PrintSpoofer](https://github.com/itm4n/PrintSpoofer)ред

{% content-ref url="roguepotato-and-printspoofer.md" %}
[roguepotato-and-printspoofer.md](roguepotato-and-printspoofer.md)
{% endcontent-ref %}

{% content-ref url="juicypotato.md" %}
[juicypotato.md](juicypotato.md)
{% endcontent-ref %}

### SeAssignPrimaryPrivilege

рдпрд╣ **SeImpersonatePrivilege** рдХреЗ рдмрд╣реБрдд рд╣реА рд╕рдорд╛рди рд╣реИ, рдпрд╣ **рдПрдХ рд╣реА рд╡рд┐рдзрд┐** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ рдПрдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХреГрдд рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред\
рдлрд┐рд░, рдпрд╣ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ **рдирдП/рд╕рд╕реНрдкреЗрдВрдб рдХрд┐рдП рдЧрдП рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкреНрд░рд╛рдердорд┐рдХ рдЯреЛрдХрди рд╕реМрдВрдкрдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХреГрдд рдЕрдиреБрдХрд░рдг рдЯреЛрдХрди рдХреЗ рд╕рд╛рде рдЖрдк рдПрдХ рдкреНрд░рд╛рдердорд┐рдХ рдЯреЛрдХрди рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (DuplicateTokenEx)ред\
рдЗрд╕ рдЯреЛрдХрди рдХреЗ рд╕рд╛рде, рдЖрдк 'CreateProcessAsUser' рдХреЗ рд╕рд╛рде **рдирдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛** рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рд╕реНрдкреЗрдВрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдЯреЛрдХрди рд╕реЗрдЯ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рд╕рд╛рдорд╛рдиреНрдпрдд: рдПрдХ рдЪрд▓ рд░рд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдкреНрд░рд╛рдердорд┐рдХ рдЯреЛрдХрди рдХреЛ рдЖрдк рд╕рдВрд╢реЛрдзрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ)ред

### SeTcbPrivilege

рдпрджрд┐ рдЖрдкрдиреЗ рдЗрд╕ рдЯреЛрдХрди рдХреЛ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рд╣реИ рддреЛ рдЖрдк **KERB\_S4U\_LOGON** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ **рдЕрдиреБрдХрд░рдг рдЯреЛрдХрди** рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдмрд┐рдирд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЬрд╛рдиреЗ, **рдХрд┐рд╕реА рднреА рд╡рд┐рдЪрд┐рддреНрд░ рд╕рдореВрд╣** (рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ) рдХреЛ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рдЯреЛрдХрди рдХреА **рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░** рдХреЛ "**рдордзреНрдпрдо**" рдореЗрдВ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЗрд╕ рдЯреЛрдХрди рдХреЛ **рд╡рд░реНрддрдорд╛рди рдзрд╛рдЧреЗ** (SetThreadToken) рдХреЛ рд╕реМрдВрдк рд╕рдХрддреЗ рд╣реИрдВред

### SeBackupPrivilege

рдЗрд╕ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рджреНрд╡рд╛рд░рд╛ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП **рд╕рднреА рдкрдврд╝рдиреЗ рдХреА рдкрд╣реБрдВрдЪ** рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рддреА рд╣реИ (рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реАрдорд┐рдд)ред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ **рд╕реНрдерд╛рдиреАрдп рдкреНрд░рд╢рд╛рд╕рдХ** рдЦрд╛рддреЛрдВ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реЗ, рдЗрд╕рдХреЗ рдмрд╛рдж, "**psexec**" рдпрд╛ "**wmicexec**" рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣рд╛рд╢ рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдкрд╛рд╕-рдж-рд╣реИрд╢ рддрдХрдиреАрдХ)ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рддрдХрдиреАрдХ рджреЛ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рддреА рд╣реИ: рдЬрдм рд╕реНрдерд╛рдиреАрдп рдкреНрд░рд╢рд╛рд╕рдХ рдЦрд╛рддрд╛ рдЕрдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИ, рдпрд╛ рдЬрдм рдПрдХ рдиреАрддрд┐ рд▓рд╛рдЧреВ рд╣реЛрддреА рд╣реИ рдЬреЛ рд╕реНрдерд╛рдиреАрдп рдкреНрд░рд╢рд╛рд╕рдХреЛрдВ рдХреЛ рджреВрд░рд╕реНрде рд░реВрдк рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рд╕реЗ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдЕрдзрд┐рдХрд╛рд░ рд╣рдЯрд╛ рджреЗрддреА рд╣реИред\
рдЖрдк рдЗрд╕ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХрд╛ **рджреБрд░реБрдкрдпреЛрдЧ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* [https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Acl-FullControl.ps1](https://github.com/Hackplayers/PsCabesha-tools/blob/master/Privesc/Acl-FullControl.ps1)
* [https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug](https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug)
* **IppSec** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ [https://www.youtube.com/watch?v=IfCysW0Od8w\&t=2610\&ab\_channel=IppSec](https://www.youtube.com/watch?v=IfCysW0Od8w\&t=2610\&ab\_channel=IppSec)
* рдпрд╛ рдЬреИрд╕рд╛ рдХрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ **рдмреИрдХрдЕрдк рдСрдкрд░реЗрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдирд╛** рдЦрдВрдб рдореЗрдВ:

{% content-ref url="../active-directory-methodology/privileged-groups-and-token-privileges.md" %}
[privileged-groups-and-token-privileges.md](../active-directory-methodology/privileged-groups-and-token-privileges.md)
{% endcontent-ref %}

### SeRestorePrivilege

рдЗрд╕ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рджреНрд╡рд╛рд░рд╛ рдХрд┐рд╕реА рднреА рд╕рд┐рд╕реНрдЯрдо рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП **рд▓реЗрдЦрди рдкрд╣реБрдВрдЪ** рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рддреА рд╣реИ, рдЪрд╛рд╣реЗ рдлрд╝рд╛рдЗрд▓ рдХреА рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг рд╕реВрдЪреА (ACL) рд╣реЛ рдпрд╛ рди рд╣реЛред рдпрд╣ рдЙрдЪрд┐рдд рд░реВрдк рд╕реЗ рдЙрдиреНрдирддреА рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ рдЦреЛрд▓рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ **рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛**, DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХрд░рдирд╛, рдФрд░ рдЗрдореЗрдЬ рдлрд╝рд╛рдЗрд▓ рдирд┐рд╖реНрдкрд╛рджрди рд╡рд┐рдХрд▓реНрдк рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдбреАрдмрдЧрд░реНрд╕ рд╕реЗрдЯ** рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред

### SeCreateTokenPrivilege

SeCreateTokenPrivilege рдПрдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдЕрдиреБрдорддрд┐ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧреА рдЬрдм рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рдЯреЛрдХрди рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИ, рд▓реЗрдХрд┐рди SeImpersonatePrivilege рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдореЗрдВ рднреАред рдпрд╣ рдХреНрд╖рдорддрд╛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рддрд╣рдд рдЯреЛрдХрдиреЛрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП SeCreateTokenPrivilege рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред

**рдореБрдЦреНрдп рдмрд┐рдВрджреБ:**

* **SeImpersonatePrivilege рдХреЗ рдмрд┐рдирд╛ рдЕрдиреБрдХрд░рдг:** рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╢рд░реНрддреЛрдВ рдХреЗ рддрд╣рдд рдЯреЛрдХрдиреЛрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП SeCreateTokenPrivilege рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдВрднрд╡ рд╣реИред
* **рдЯреЛрдХрди рдЕрдиреБрдХрд░рдг рдХреЗ рд▓рд┐рдП рд╢рд░реНрддреЗрдВ:** рд╕рдлрд▓ рдЕрдиреБрдХрд░рдг рдХреЗ рд▓рд┐рдП рд▓рдХреНрд╖рд┐рдд рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рдорд╛рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЙрд╕рдХрд╛ рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░ рдЙрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдЦрдВрдбрддрд╛ рд╕реНрддрд░ рд╕реЗ рдХрдо рдпрд╛ рдЙрд╕рдХреЗ рд╕рдорд╛рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП

```python
# Example Python code to set the registry values
import winreg as reg

# Define the path and values
path = r'Software\YourPath\System\CurrentControlSet\Services\DriverName' # Adjust 'YourPath' as needed
key = reg.OpenKey(reg.HKEY_CURRENT_USER, path, 0, reg.KEY_WRITE)
reg.SetValueEx(key, "ImagePath", 0, reg.REG_SZ, "path_to_binary")
reg.SetValueEx(key, "Type", 0, reg.REG_DWORD, 0x00000001)
reg.CloseKey(key)
```

рдЗрд╕ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдФрд░ рддрд░реАрдХреЗ [https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/privileged-accounts-and-token-privileges#seloaddriverprivilege](https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/privileged-accounts-and-token-privileges#seloaddriverprivilege)

### SeTakeOwnershipPrivilege

рдпрд╣ **SeRestorePrivilege** рдХреЗ рд╕рдорд╛рди рд╣реИред рдЗрд╕рдХрд╛ рдореБрдЦреНрдп рдХрд╛рд░реНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ **рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рдХреЛ рдЕрд╕реНрд╕реБрдо рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ WRITE\_OWNER рдкрд╣реБрдВрдЪ рдХреЗ рдЕрдзрд┐рдХрд╛рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рд┐рд╡реЗрдХрд╛рдзреАрди рдкрд╣реБрдВрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рджреВрд░ рдХрд░ рджреЗрддрд╛ рд╣реИред рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдкрд╣рд▓реЗ рдЗрдЪреНрдЫрд┐рдд рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА рдХреЗ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рдХреЛ рд▓рд┐рдЦрдиреЗ рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдирд╛ рд╣реЛрддрд╛ рд╣реИ, рдлрд┐рд░ DACL рдХреЛ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдмрджрд▓рдирд╛ рд╣реЛрддрд╛ рд╣реИред

```bash
takeown /f 'C:\some\file.txt' #Now the file is owned by you
icacls 'C:\some\file.txt' /grant <your_username>:F #Now you have full access
# Use this with files that might contain credentials such as
%WINDIR%\repair\sam
%WINDIR%\repair\system
%WINDIR%\repair\software
%WINDIR%\repair\security
%WINDIR%\system32\config\security.sav
%WINDIR%\system32\config\software.sav
%WINDIR%\system32\config\system.sav
%WINDIR%\system32\config\SecEvent.Evt
%WINDIR%\system32\config\default.sav
c:\inetpub\wwwwroot\web.config
```

### SeDebugPrivilege

рдпрд╣ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ **рдЕрдиреНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдбреАрдмрдЧ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдореЗрдореЛрд░реА рдореЗрдВ рдкрдврд╝рдиреЗ рдФрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдЗрд╕ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдЕрдзрд┐рдХрд╛рдВрд╢ рдПрдВрдЯреАрд╡рд╛рдпрд░рд╕ рдФрд░ рд╣реЛрд╕реНрдЯ рдЗрдиреНрдЯреНрд░реВрдЬрди рдкреНрд░рд┐рд╡реЗрдВрд╢рди рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреЛ рдЯрд╛рд▓рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╡рд╛рд▓реЗ рд╡рд┐рднрд┐рдиреНрди рдореЗрдореЛрд░реА рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрд╛рдп рдЕрдкрдирд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

#### рдореЗрдореЛрд░реА рдбрдВрдк

рдЖрдк [ProcDump](https://docs.microsoft.com/en-us/sysinternals/downloads/procdump) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ [SysInternals Suite](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite) рд╕реЗ **рдХрд┐рд╕реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдХреЛ рдХреИрдкреНрдЪрд░** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдпрд╣ **рд╕реНрдерд╛рдиреАрдп рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдЙрдкрд╕реНрдерд┐рддрд┐ рд╕реЗрд╡рд╛ (**[**LSASS**](https://en.wikipedia.org/wiki/Local\_Security\_Authority\_Subsystem\_Service)**)** рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрд░ рд▓рд╛рдЧреВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдиреЗ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд┐рдпрд╛ рд╣реЛрдиреЗ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред

рдлрд┐рд░ рдЖрдк рдЗрд╕ рдбрдВрдк рдХреЛ рдорд┐рдореАрдХреЗрдЯреНрдЬ рдореЗрдВ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХреЗрдВ:

```
mimikatz.exe
mimikatz # log
mimikatz # sekurlsa::minidump lsass.dmp
mimikatz # sekurlsa::logonpasswords
```

#### RCE

рдпрджрд┐ рдЖрдк `NT SYSTEM` рд╢реИрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* [**SeDebugPrivilege-Exploit (C++)**](https://github.com/bruno-1337/SeDebugPrivilege-Exploit)
* [**SeDebugPrivilegePoC (C#)**](https://github.com/daem0nc0re/PrivFu/tree/main/PrivilegedOperations/SeDebugPrivilegePoC)
* [**psgetsys.ps1 (Powershell Script)**](https://raw.githubusercontent.com/decoder-it/psgetsystem/master/psgetsys.ps1)

```powershell
# Get the PID of a process running as NT SYSTEM
import-module psgetsys.ps1; [MyProcess]::CreateProcessFromParent(<system_pid>,<command_to_execute>)
```

## рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреА рдЬрд╛рдВрдЪ

```
whoami /priv
```

**рдЯреЛрдХрди рдЬреЛ рдЕрдХреНрд╖рдо рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ** рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЖрдк _рд╕рдХреНрд░рд┐рдп_ рдФрд░ _рдЕрдХреНрд╖рдо_ рдЯреЛрдХрди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рд╕рднреА рдЯреЛрдХрди рд╕рдХреНрд░рд┐рдп рдХрд░реЗрдВ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЕрдХреНрд╖рдо рдЯреЛрдХрди рд╣реИрдВ, рддреЛ рдЖрдк [**EnableAllTokenPrivs.ps1**](https://raw.githubusercontent.com/fashionproof/EnableAllTokenPrivs/master/EnableAllTokenPrivs.ps1) рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╕рднреА рдЯреЛрдХрди рд╕рдХреНрд░рд┐рдп рд╣реЛрдВ:

```powershell
.\EnableAllTokenPrivs.ps1
whoami /priv
```

рдпрд╛ **рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдЗрд╕ [**рдкреЛрд╕реНрдЯ**](https://www.leeholmes.com/adjusting-token-privileges-in-powershell/) рдореЗрдВ рдПрдореНрдмреЗрдб рдХрд░реЗрдВред

## рддрд╛рд▓рд┐рдХрд╛

рдкреВрд░реА рдЯреЛрдХрди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЪреАрдЯрд╢реАрдЯ [https://github.com/gtworek/Priv2Admin](https://github.com/gtworek/Priv2Admin), рд╕рд╛рд░рд╛рдВрд╢ рдиреАрдЪреЗ рдХреЗрд╡рд▓ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд╕реАрдзреЗ рддрд░реАрдХреЗ рд╕реВрдЪреАрдд рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕рд╕реЗ рдПрдбрдорд┐рди рд╕рддреНрд░ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрдврд╝реА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

| рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░                | рдкреНрд░рднрд╛рд╡      | рдЙрдкрдХрд░рдг                  | рдирд┐рд╖реНрдкрд╛рджрди рдкрде                                                                                                                                                                                                                                                                                                                                                   | рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдБ                                                                                                                                                                                                                                                                                                            |
| -------------------------- | ----------- | ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`SeAssignPrimaryToken`** | _**рдПрдбрдорд┐рди**_ | рддреГрддреАрдп рдкрдХреНрд╖ рдЙрдкрдХрд░рдг       | _"рдпрд╣ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЯреЛрдХрди рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдФрд░ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ nt рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдкреНрд░рд╛рдЗрд╡реЗрд╕реА рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ рдЬреИрд╕реЗ рдХрд┐ potato.exe, rottenpotato.exe рдФрд░ juicypotato.exe"_                                                                                                                                                                                      | рдЕрдкрдбреЗрдЯ рдХреЗ рд▓рд┐рдП рдЖрдкрдХрд╛ рдзрдиреНрдпрд╡рд╛рдж [Aur├йlien Chalot](https://twitter.com/Defte\_)ред рдореИрдВ рдЬрд▓реНрдж рд╣реА рдЗрд╕реЗ рдХреБрдЫ рдФрд░ рд░реЗрд╕рд┐рдкреА рдЬреИрд╕рд╛ рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реВрдВрдЧрд╛ред                                                                                                                                                                                   |
| **`SeBackup`**             | **рдЦрддрд░рд╛**    | _**рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдХрдорд╛рдВрдб**_ | `robocopy /b` рдХреЗ рд╕рд╛рде рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрдврд╝реЗрдВ                                                                                                                                                                                                                                                                                                                  | <p>- рдпрджрд┐ рдЖрдк %WINDIR%\MEMORY.DMP рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдпрд╣ рдФрд░ рднреА рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИред<br><br>- <code>SeBackupPrivilege</code> (рдФрд░ robocopy) рдЦреБрд▓реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдорджрджрдЧрд╛рд░ рдирд╣реАрдВ рд╣реИред<br><br>- Robocopy рдХреЛ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП /b рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рджреЛрдиреЛрдВ SeBackup рдФрд░ SeRestore рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред</p>                                  |
| **`SeCreateToken`**        | _**рдПрдбрдорд┐рди**_ | рддреГрддреАрдп рдкрдХреНрд╖ рдЙрдкрдХрд░рдг       | `NtCreateToken` рдХреЗ рд╕рд╛рде рд╕реНрдерд╛рдирд┐рдХ рдПрдбрдорд┐рди рдЕрдзрд┐рдХрд╛рд░реЛрдВ рд╕рд╣рд┐рдд рд╡рд┐рд╡рд┐рдз рдЯреЛрдХрди рдмрдирд╛рдПрдВред                                                                                                                                                                                                                                                                                          |                                                                                                                                                                                                                                                                                                                       |
| **`SeDebug`**              | _**рдПрдбрдорд┐рди**_ | **PowerShell**         | `lsass.exe` рдЯреЛрдХрди рдХреА рдирдХрд▓ рдХрд░реЗрдВред                                                                                                                                                                                                                                                                                                                                 | [FuzzySecurity](https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/Conjure-LSASS.ps1) рдкрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рджреЗрдЦреЗрдВред                                                                                                                                                                                                  |
| **`SeLoadDriver`**         | _**рдПрдбрдорд┐рди**_ | рддреГрддреАрдп рдкрдХреНрд╖ рдЙрдкрдХрд░рдг       | <p>1. <code>szkg64.sys</code> рдЬреИрд╕реЗ рдмрдЧреА рдХрд░реНрдиреЗрд▓ рдбреНрд░рд╛рдЗрд╡рд░ рд▓реЛрдб рдХрд░реЗрдВ<br>2. рдбреНрд░рд╛рдЗрд╡рд░ рдХреА рдХрдордЬреЛрд░реА рдХрд╛ рд╢реЛрд╖рдг рдХрд░реЗрдВ<br><br>рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рдпрд╣ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ <code>ftlMC</code> рдЗрдирдмрд┐рд▓реНрдЯ рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдмрдВрдзрд┐рдд рдбреНрд░рд╛рдЗрд╡рд░реНрд╕ рдХреЛ рдЕрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЬреИрд╕реЗ: <code>fltMC sysmondrv</code></p>                                                               | <p>1. <code>szkg64</code> рдХрдордЬреЛрд░реА <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15732">CVE-2018-15732</a> рдХреЗ рд░реВрдк рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рд╣реИ<br>2. <code>szkg64</code> <a href="https://www.greyhathacker.net/?p=1025">рд╢реЛрд╖рдг рдХреЛрдб</a> рдХреЛ <a href="https://twitter.com/parvezghh">Parvez Anwar</a> рдиреЗ рдмрдирд╛рдпрд╛ рдерд╛</p> |
| **`SeRestore`**            | _**рдПрдбрдорд┐рди**_ | **PowerShell**         | <p>1. SeRestore рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд╛рде PowerShell/ISE рд▓реЙрдиреНрдЪ рдХрд░реЗрдВред<br>2. <a href="https://github.com/gtworek/PSBits/blob/master/Misc/EnableSeRestorePrivilege.ps1">Enable-SeRestorePrivilege</a> рдХреЗ рд╕рд╛рде рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╕рдХреНрд░рд┐рдп рдХрд░реЗрдВред<br>3. utilman.exe рдХреЛ utilman.old рдореЗрдВ рдирд╛рдо рдмрджрд▓реЗрдВ<br>4. cmd.exe рдХреЛ utilman.exe рдореЗрдВ рдирд╛рдо рдмрджрд▓реЗрдВ<br>5. рдХрдВрд╕реЛрд▓ рд▓реЙрдХ рдХрд░реЗрдВ рдФрд░ Win+U рджрдмрд╛рдПрдВ</p> | <p>рдХреБрдЫ AV рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рджреНрд╡рд╛рд░рд╛ рд╣рдорд▓рд╛ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред</p><p>рд╡реИрдХрд▓реНрдкрд┐рдХ рд╡рд┐рдзрд┐ "Program Files" рдореЗрдВ рд╕реНрдЯреЛрд░ рдХреА рдЧрдИ рд╕реЗрд╡рд╛ рдмрд╛рдЗрдирд░реА рдХреЛ рдмрджрд▓рдХрд░ рдирд┐рд░реНрднрд░ рд╣реИред</p>                                                                                                                                                                           |
| **`SeTakeOwnership`**      | _**рдПрдбрдорд┐рди**_ | _**рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдХрдорд╛рдВрдб**_ | <p>1. <code>takeown.exe /f "%windir%\system32"</code><br>2. <code>icalcs.exe "%windir%\system32" /grant "%username%":F</code><br>3. cmd.exe рдХреЛ utilman.exe рдореЗрдВ рдирд╛рдо рдмрджрд▓реЗрдВ<br>4. рдХрдВрд╕реЛрд▓ рд▓реЙрдХ рдХрд░реЗрдВ рдФрд░ Win+U рджрдмрд╛рдПрдВ</p>                                                                                                                                              | <p>рдХреБрдЫ AV рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рджреНрд╡рд╛рд░рд╛ рд╣рдорд▓рд╛ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред</p><p>рд╡реИрдХрд▓реНрдкрд┐рдХ рд╡рд┐рдзрд┐ "Program Files" рдореЗрдВ рд╕реНрдЯреЛрд░ рдХреА рдЧрдИ рд╕реЗрд╡рд╛ рдмрд╛рдЗрдирд░реА рдХреЛ рдмрджрд▓рдХрд░ рдирд┐рд░реНрднрд░ рд╣реИред</p>                                                                                                                                                                           |
| **`SeTcb`**                | _**рдПрдбрдорд┐рди**_ | рддреГрддреАрдп рдкрдХреНрд╖ рдЙрдкрдХрд░рдг       | <p>рдЯреЛрдХрди рдХреЛ рд╕реНрдерд╛рдирд┐рдХ рдПрдбрдорд┐рди рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВред SeImpersonate рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред</p><p>рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред</p>                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                       |

## рд╕рдВрджрд░реНрдн

* рд╡рд┐рдВрдбреЛрдЬ рдЯреЛрдХрди рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА рдЗрд╕ рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рджреЗрдЦреЗрдВ: [https://github.com/gtworek/Priv2Admin](https://github.com/gtworek/Priv2Admin)
* рдЗрд╕ рдкреЗрдкрд░ рдХреЛ рджреЗрдЦреЗрдВ [**рдпрд╣рд╛рдБ**](https://github.com/hatRiot/token-priv/blob/master/abusing\_token\_eop\_1.0.txt) рдЯреЛрдХрди рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдЗрд╡реЗрд╕реНрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВред

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a> <strong>рдХреЗ рд╕рд╛рде!</strong></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрди рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рдкреАрдбреАрдПрдл рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВ ЁЯРж[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ,** [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ**ред

</details>
