# macOS xpc\_connection\_get\_audit\_token рд╣рдорд▓рд╛

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рддрдХ рдкрд╣реБрдБрдЪ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рдЬрдорд╛ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ.**

</details>

**рдпрд╣ рддрдХрдиреАрдХ** [**https://sector7.computest.nl/post/2023-10-xpc-audit-token-spoofing/**](https://sector7.computest.nl/post/2023-10-xpc-audit-token-spoofing/) **рд╕реЗ рдХреЙрдкреА рдХреА рдЧрдИ рдереА**

## Mach Messages рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

рдпрджрд┐ рдЖрдкрдХреЛ Mach Messages рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рддреЛ рдЗрд╕ рдкреГрд╖реНрда рдХреЛ рджреЗрдЦреЗрдВ:

{% content-ref url="../../../../mac-os-architecture/macos-ipc-inter-process-communication/" %}
[macos-ipc-inter-process-communication](../../../../mac-os-architecture/macos-ipc-inter-process-communication/)
{% endcontent-ref %}

рдлрд┐рд▓рд╣рд╛рд▓ рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐:
Mach messages _mach port_ рдкрд░ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬреЛ рдХрд┐ mach kernel рдореЗрдВ рдирд┐рд░реНрдорд┐рдд **рдПрдХрд▓ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛, рдмрд╣реБрд╕рдВрдЦреНрдпрдХ рдкреНрд░реЗрд╖рдХ рд╕рдВрдЪрд╛рд░** рдЪреИрдирд▓ рд╣реИред **рдмрд╣реБрдд рд╕рд╛рд░реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рд╕рдВрджреЗрд╢ рднреЗрдЬ рд╕рдХрддреА рд╣реИрдВ** mach port рдкрд░, рд▓реЗрдХрд┐рди рдХрд┐рд╕реА рднреА рд╕рдордп **рдХреЗрд╡рд▓ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЗрд╕рд╕реЗ рдкрдврд╝ рд╕рдХрддреА рд╣реИ**ред рдлрд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░реНрд╕ рдФрд░ рд╕реЙрдХреЗрдЯреНрд╕ рдХреА рддрд░рд╣, mach ports рдХреЛ рдХрд░реНрдиреЗрд▓ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рдВрдЯрд┐рдд рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреЗрд╡рд▓ рдПрдХ рдкреВрд░реНрдгрд╛рдВрдХ рджреЗрдЦрддреА рд╣реИрдВ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реЗ рдХрд░реНрдиреЗрд▓ рдХреЛ рдпрд╣ рдмрддрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЙрдирдХреЗ рдХрд┐рд╕ mach port рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред

## XPC рдХрдиреЗрдХреНрд╢рди

рдпрджрд┐ рдЖрдкрдХреЛ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ XPC рдХрдиреЗрдХреНрд╢рди рдХреИрд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рджреЗрдЦреЗрдВ:

{% content-ref url="../" %}
[..](../)
{% endcontent-ref %}

## Vuln рд╕рд╛рд░рд╛рдВрд╢

рдЖрдкрдХреЗ рд▓рд┐рдП рдЬрд╛рдирдирд╛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдХрд┐ **XPC рдХрд╛ рдЕрдореВрд░реНрддреАрдХрд░рдг рдПрдХ-рд╕реЗ-рдПрдХ рдХрдиреЗрдХреНрд╢рди рд╣реИ**, рд▓реЗрдХрд┐рди рдпрд╣ рдПрдХ рдРрд╕реА рддрдХрдиреАрдХ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ рдЬрд┐рд╕рдореЗрдВ **рдмрд╣реБрд╕рдВрдЦреНрдпрдХ рдкреНрд░реЗрд╖рдХ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП:**

* Mach ports рдПрдХрд▓ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛, _**рдмрд╣реБрд╕рдВрдЦреНрдпрдХ рдкреНрд░реЗрд╖рдХ**_ рд╣реИрдВред
* XPC рдХрдиреЗрдХреНрд╢рди рдХрд╛ audit token _**рд╕рдмрд╕реЗ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рд╕рдВрджреЗрд╢ рд╕реЗ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЧрдпрд╛**_ audit token рд╣реЛрддрд╛ рд╣реИред
* XPC рдХрдиреЗрдХреНрд╢рди рдХреЗ **audit token** рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдХрдИ **рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдВрдЪреЛрдВ** рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред

рд╣рд╛рд▓рд╛рдВрдХрд┐ рдкрд┐рдЫрд▓реА рд╕реНрдерд┐рддрд┐ рдЖрд╢рд╛рдЬрдирдХ рд▓рдЧрддреА рд╣реИ, рдХреБрдЫ рдкрд░рд┐рджреГрд╢реНрдп рд╣реИрдВ рдЬрд╣рд╛рдБ рдпрд╣ рд╕рдорд╕реНрдпрд╛рдПрдБ рдкреИрджрд╛ рдирд╣реАрдВ рдХрд░реЗрдЧрд╛:

* Audit tokens рдЕрдХреНрд╕рд░ рдПрдХ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рддрдп рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рдХрдиреЗрдХреНрд╢рди рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдирд╛ рд╣реИред рдЬреИрд╕рд╛ рдХрд┐ рдпрд╣ рд╕реЗрд╡рд╛ рдкреЛрд░реНрдЯ рдХреЛ рдПрдХ рд╕рдВрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реЛрддрд╛ рд╣реИ, рдЕрднреА рддрдХ **рдХреЛрдИ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рд╣реБрдЖ рд╣реИ**ред рдЗрд╕ рдкреЛрд░реНрдЯ рдкрд░ рдФрд░ рдЕрдзрд┐рдХ рд╕рдВрджреЗрд╢ рдХреЗрд╡рд▓ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрдиреЗрдХреНрд╢рди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрднрд╛рд▓реЗ рдЬрд╛рдПрдВрдЧреЗред рдЗрд╕рд▓рд┐рдП рдХрд┐рд╕реА рднреА **рдЬрд╛рдВрдЪ рд╕реЗ рдкрд╣рд▓реЗ рдХрдиреЗрдХреНрд╢рди рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдирд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИ** (рдЗрд╕рдХрд╛ рдпрд╣ рднреА рдорддрд▓рдм рд╣реИ рдХрд┐ `-listener:shouldAcceptNewConnection:` рдХреЗ рднреАрддрд░ audit token рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ)ред рдЗрд╕рд▓рд┐рдП рд╣рдо **рдЙрди XPC рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдЬреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВ**ред
* XPC рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░реНрд╕ рдХреЛ рд╕рд┐рдВрдХреНрд░реЛрдирд╕рд▓реА рд╕рдВрднрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдПрдХ рд╕рдВрджреЗрд╢ рдХреЗ рд▓рд┐рдП рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдХреЛ рдкреВрд░рд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рдЗрд╕реЗ рдЕрдЧрд▓реЗ рдХреЗ рд▓рд┐рдП рдмреБрд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рд╕рдорд╛рдирд╛рдВрддрд░ рдбрд┐рд╕реНрдкреИрдЪ рдХрддрд╛рд░реЛрдВ рдкрд░ рднреАред рдЗрд╕рд▓рд┐рдП рдПрдХ **XPC рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдХреЗ рднреАрддрд░ audit token рдХреЛ рдЕрдиреНрдп рд╕рд╛рдорд╛рдиреНрдп (рдЧреИрд░-рдЙрддреНрддрд░!) рд╕рдВрджреЗрд╢реЛрдВ рджреНрд╡рд╛рд░рд╛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛**ред

рдЗрд╕рд╕реЗ рд╣рдореЗрдВ рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд░реАрдХреЛрдВ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рдЖрдпрд╛ рдЬрд┐рд╕рд╕реЗ рдпрд╣ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

1. рд╡рд┐рдХрд▓реНрдк1:
* **Exploit** рд╕реЗрд╡рд╛ **A** рдФрд░ рд╕реЗрд╡рд╛ **B** рд╕реЗ **рдЬреБрдбрд╝рддрд╛ рд╣реИ**
* рд╕реЗрд╡рд╛ **B** рд╕реЗрд╡рд╛ A рдореЗрдВ рдПрдХ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛** рдХреЛ рдмреБрд▓рд╛ рд╕рдХрддреА рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛
* рд╕реЗрд╡рд╛ **A** **`xpc_connection_get_audit_token`** рдХреЛ рдмреБрд▓рд╛рддреА рд╣реИ рдЬрдмрдХрд┐ _**рдирд╣реАрдВ**_ рдПрдХ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП **рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░** рдХреЗ рднреАрддрд░ **`dispatch_async`** рдореЗрдВред
* рдЗрд╕рд▓рд┐рдП рдПрдХ **рдЕрд▓рдЧ** рд╕рдВрджреЗрд╢ **Audit Token рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ** рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдХреЗ рдмрд╛рд╣рд░ рдЕрд╕рд┐рдВрдХреНрд░реЛрдирд╕рд▓реА рдбрд┐рд╕реНрдкреИрдЪ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред
* Exploit **рд╕реЗрд╡рд╛ B рдХреЛ рд╕реЗрд╡рд╛ A рдХреЗ рд▓рд┐рдП SEND рдЕрдзрд┐рдХрд╛рд░ рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИ**ред
* рдЗрд╕рд▓рд┐рдП svc **B** рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ **рд╕рдВрджреЗрд╢ рднреЗрдЬ рд░рд╣реА рд╣реИ** рд╕реЗрд╡рд╛ **A** рдХреЛред
* **Exploit** рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдмреБрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП**ред RC рдореЗрдВ svc **A** рдЗрд╕ **рдХреНрд░рд┐рдпрд╛** рдХреЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреА **рдЬрд╛рдВрдЪ рдХрд░рддреА рд╣реИ** рдЬрдмрдХрд┐ **svc B рдиреЗ Audit token рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд┐рдпрд╛** (рдЬрд┐рд╕рд╕реЗ exploit рдХреЛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдмреБрд▓рд╛рдиреЗ рдХреА рдкрд╣реБрдБрдЪ рдорд┐рд▓рддреА рд╣реИ)ред
2. рд╡рд┐рдХрд▓реНрдк 2:
* рд╕реЗрд╡рд╛ **B** рд╕реЗрд╡рд╛ A рдореЗрдВ рдПрдХ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛** рдХреЛ рдмреБрд▓рд╛ рд╕рдХрддреА рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛
* Exploit **рд╕реЗрд╡рд╛ A** рд╕реЗ рдЬреБрдбрд╝рддрд╛ рд╣реИ рдЬреЛ exploit рдХреЛ рдПрдХ **рд╕рдВрджреЗрд╢ рднреЗрдЬрддреА рд╣реИ рдЬрд┐рд╕рдХреА рдПрдХ рдЙрддреНрддрд░ рдХреА рдЙрдореНрдореАрдж рд╣реИ** рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** **рдкреЛрд░реНрдЯ** рдореЗрдВред
* Exploit **рд╕реЗрд╡рд╛** B рдХреЛ рдПрдХ рд╕рдВрджреЗрд╢ рднреЗрдЬрддрд╛ рд╣реИ **рдЙрд╕ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреЛрд░реНрдЯ рдХреЛ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реБрдП**ред
* рдЬрдм рд╕реЗрд╡рд╛ **B рдЙрддреНрддрд░ рджреЗрддреА рд╣реИ**, рдпрд╣ **рд╕реЗрд╡рд╛ A рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрддреА рд╣реИ**, **рдЬрдмрдХрд┐** **exploit** рдПрдХ рдЕрд▓рдЧ **рд╕рдВрджреЗрд╢ рд╕реЗрд╡рд╛ A рдХреЛ рднреЗрдЬрддрд╛ рд╣реИ** рдЬрд┐рд╕рд╕реЗ рд╡рд╣ рдПрдХ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ** рдФрд░ рдЙрдореНрдореАрдж рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕реЗрд╡рд╛ B рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ Audit token рдХреЛ рд╕рд╣реА рд╕рдордп рдкрд░ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░ рджреЗрдЧреА (Race Condition)ред

## рд╡рд┐рдХрд▓реНрдк 1: рдПрдХ рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдХреЗ рдмрд╛рд╣рд░ xpc\_connection\_get\_audit\_token рдХреЛ рдмреБрд▓рд╛рдирд╛ <a href="#variant-1-calling-xpc_connection_get_audit_token-outside-of-an-event-handler" id="variant-1-calling-xpc_connection_get_audit_token-outside-of-an-event-handler"></a>
