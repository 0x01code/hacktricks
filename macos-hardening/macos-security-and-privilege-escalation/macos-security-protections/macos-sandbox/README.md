# macOS рд╕реИрдВрдбрдмреЙрдХреНрд╕

<details>

<summary><strong> AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ </strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

macOS рд╕реИрдВрдбрдмреЙрдХреНрд╕ (рдореВрд▓ рд░реВрдк рд╕реЗ Seatbelt рдХрд╣рд▓рд╛рддрд╛ рд╣реИ) **рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИ** рдЬреЛ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХреЗ рдЕрдВрджрд░ рдЪрд▓ рд░рд╣реЗ рд╣реЛрддреЗ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рдХреЗрд╡рд▓ **рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░реЛрдлрд╛рдЗрд▓ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЕрдиреБрдордд рдХреНрд░рд┐рдпрд╛рдУрдВ рддрдХ рд╣реА рд╕реАрдорд┐рдд рд░рдЦрддрд╛ рд╣реИ** рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдРрдк рдЪрд▓ рд░рд╣рд╛ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗрд╡рд▓ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рд╣реА рдкрд╣реБрдБрдЪ рд░рд╣рд╛ рд╣реЛ**ред

рдХрд┐рд╕реА рднреА рдРрдк рдХреЗ рдкрд╛рд╕ **entitlement** **`com.apple.security.app-sandbox`** рд╣реЛрдЧрд╛, рд╡рд╣ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХреЗ рдЕрдВрджрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧрд╛ред **Apple binaries** рдЖрдорддреМрд░ рдкрд░ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХреЗ рдЕрдВрджрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ **App Store** рдХреЗ рдЕрдВрджрд░ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **рдпрд╣ entitlement рдЕрдирд┐рд╡рд╛рд░реНрдп рд╣реИ**ред рдЗрд╕рд▓рд┐рдП рдЕрдзрд┐рдХрд╛рдВрд╢ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХреЗ рдЕрдВрджрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдВрдЧреЗред

рдпрд╣ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреНрдпрд╛ рдХрд░ рд╕рдХрддреА рд╣реИ рдпрд╛ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреА, **рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдореЗрдВ рд╣реБрдХреНрд╕ рд╣реЛрддреЗ рд╣реИрдВ** рдЬреЛ рдХрд░реНрдиреЗрд▓ рдХреЗ рднрд░ рдореЗрдВ рд╕рднреА **syscalls** рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВред **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА entitlements рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реБрдП**, рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХреБрдЫ рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ **рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛**ред

рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХреЗ рдХреБрдЫ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдШрдЯрдХ рд╣реИрдВ:

* рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди `/System/Library/Extensions/Sandbox.kext`
* рдирд┐рдЬреА рдлреНрд░реЗрдорд╡рд░реНрдХ `/System/Library/PrivateFrameworks/AppSandbox.framework`
* рдпреВрдЬрд░рд▓реИрдВрдб рдореЗрдВ рдЪрд▓ рд░рд╣рд╛ рдПрдХ **daemon** `/usr/libexec/sandboxd`
* рдХрдВрдЯреЗрдирд░реНрд╕ `~/Library/Containers`

рдХрдВрдЯреЗрдирд░реНрд╕ рдлреЛрд▓реНрдбрд░ рдХреЗ рдЕрдВрджрд░ рдЖрдк рдкреНрд░рддреНрдпреЗрдХ рдРрдк рдХреЗ рд▓рд┐рдП рдПрдХ рдлреЛрд▓реНрдбрд░ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╕реИрдВрдбрдмреЙрдХреНрд╕реНрдб рдХреЗ рд╕рд╛рде рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдмрдВрдбрд▓ рдЖрдИрдбреА рдХреЗ рдирд╛рдо рд╕реЗ:
```bash
ls -l ~/Library/Containers
total 0
drwx------@ 4 username  staff  128 May 23 20:20 com.apple.AMPArtworkAgent
drwx------@ 4 username  staff  128 May 23 20:13 com.apple.AMPDeviceDiscoveryAgent
drwx------@ 4 username  staff  128 Mar 24 18:03 com.apple.AVConference.Diagnostic
drwx------@ 4 username  staff  128 Mar 25 14:14 com.apple.Accessibility-Settings.extension
drwx------@ 4 username  staff  128 Mar 25 14:10 com.apple.ActionKit.BundledIntentHandler
[...]
```
рдкреНрд░рддреНрдпреЗрдХ bundle id рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рдЕрдВрджрд░ рдЖрдк рдРрдк рдХреА **plist** рдФрд░ **Data directory** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
cd /Users/username/Library/Containers/com.apple.Safari
ls -la
total 104
drwx------@   4 username  staff    128 Mar 24 18:08 .
drwx------  348 username  staff  11136 May 23 20:57 ..
-rw-r--r--    1 username  staff  50214 Mar 24 18:08 .com.apple.containermanagerd.metadata.plist
drwx------   13 username  staff    416 Mar 24 18:05 Data

ls -l Data
total 0
drwxr-xr-x@  8 username  staff   256 Mar 24 18:08 CloudKit
lrwxr-xr-x   1 username  staff    19 Mar 24 18:02 Desktop -> ../../../../Desktop
drwx------   2 username  staff    64 Mar 24 18:02 Documents
lrwxr-xr-x   1 username  staff    21 Mar 24 18:02 Downloads -> ../../../../Downloads
drwx------  35 username  staff  1120 Mar 24 18:08 Library
lrwxr-xr-x   1 username  staff    18 Mar 24 18:02 Movies -> ../../../../Movies
lrwxr-xr-x   1 username  staff    17 Mar 24 18:02 Music -> ../../../../Music
lrwxr-xr-x   1 username  staff    20 Mar 24 18:02 Pictures -> ../../../../Pictures
drwx------   2 username  staff    64 Mar 24 18:02 SystemData
drwx------   2 username  staff    64 Mar 24 18:02 tmp
```
{% hint style="danger" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рд╕рд┐рдореНрд▓рд┐рдВрдХреНрд╕ рд╡рд╣рд╛рдБ рд╣реИрдВ "рдПрд╕реНрдХреЗрдк" рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реИрдВрдбрдмреЙрдХреНрд╕ рд╕реЗ рдФрд░ рдЕрдиреНрдп рдлреЛрд▓реНрдбрд░реНрд╕ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рдРрдк рдХреЛ рдЕрднреА рднреА рдЙрди рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП **рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред рдпреЗ рдЕрдиреБрдорддрд┐рдпрд╛рдБ **`.plist`** рдХреЗ рдЕрдВрджрд░ рд╣реЛрддреА рд╣реИрдВред
{% endhint %}
```bash
# Get permissions
plutil -convert xml1 .com.apple.containermanagerd.metadata.plist -o -

# Binary sandbox profile
<key>SandboxProfileData</key>
<data>
AAAhAboBAAAAAAgAAABZAO4B5AHjBMkEQAUPBSsGPwsgASABHgEgASABHwEf...

# In this file you can find the entitlements:
<key>Entitlements</key>
<dict>
<key>com.apple.MobileAsset.PhishingImageClassifier2</key>
<true/>
<key>com.apple.accounts.appleaccount.fullaccess</key>
<true/>
<key>com.apple.appattest.spi</key>
<true/>
<key>keychain-access-groups</key>
<array>
<string>6N38VWS5BX.ru.keepcoder.Telegram</string>
<string>6N38VWS5BX.ru.keepcoder.TelegramShare</string>
</array>
[...]

# Some parameters
<key>Parameters</key>
<dict>
<key>_HOME</key>
<string>/Users/username</string>
<key>_UID</key>
<string>501</string>
<key>_USER</key>
<string>username</string>
[...]

# The paths it can access
<key>RedirectablePaths</key>
<array>
<string>/Users/username/Downloads</string>
<string>/Users/username/Documents</string>
<string>/Users/username/Library/Calendars</string>
<string>/Users/username/Desktop</string>
<key>RedirectedPaths</key>
<array/>
[...]
```
{% hint style="warning" %}
Sandboxed рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХреА рдЧрдИ рд╣рд░ рдЪреАрдЬ рдореЗрдВ **quarantine attribute** рд╣реЛрдЧрд╛ред рдпрд╣ Gatekeeper рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдХреЗ sandbox рд╕реНрдерд╛рди рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХрд░реЗрдЧрд╛ рдЕрдЧрд░ sandbox рдПрдкреНрд▓рд┐рдХреЗрд╢рди **`open`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреБрдЫ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИред
{% endhint %}

### Sandbox рдкреНрд░реЛрдлрд╛рдЗрд▓

Sandbox рдкреНрд░реЛрдлрд╛рдЗрд▓ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреА рд╣реИрдВ рдХрд┐ **Sandbox** рдореЗрдВ рдХреНрдпрд╛ **рдЕрдиреБрдорддрд┐/рдирд┐рд╖реЗрдз** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕рдореЗрдВ **Sandbox Profile Language (SBPL)** рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ [**Scheme**](https://en.wikipedia.org/wiki/Scheme\_\(programming\_language\)) рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдХрд╛ рдкреНрд░рдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

рдпрд╣рд╛рдБ рдЖрдк рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```scheme
(version 1) ; First you get the version

(deny default) ; Then you shuold indicate the default action when no rule applies

(allow network*) ; You can use wildcards and allow everything

(allow file-read* ; You can specify where to apply the rule
(subpath "/Users/username/")
(literal "/tmp/afile")
(regex #"^/private/etc/.*")
)

(allow mach-lookup
(global-name "com.apple.analyticsd")
)
```
{% hint style="success" %}
рдЗрд╕ [**рд╢реЛрдз**](https://reverse.put.as/2011/09/14/apple-sandbox-guide-v1-0/) рдХреЛ рджреЗрдЦреЗрдВ рддрд╛рдХрд┐ рдЖрдк рдФрд░ рдЕрдзрд┐рдХ рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХреЗрдВ рдЬреЛ рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ рдпрд╛ рдЗрдирдХрд╛рд░ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред
{% endhint %}

рдорд╣рддреНрд╡рдкреВрд░реНрдг **рд╕рд┐рд╕реНрдЯрдо рд╕реЗрд╡рд╛рдПрдВ** рднреА рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдХрд╕реНрдЯрдо **рд╕реИрдВрдбрдмреЙрдХреНрд╕** рдореЗрдВ рдЪрд▓рддреА рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ `mdnsresponder` рд╕реЗрд╡рд╛ред рдЖрдк рдЗрди рдХрд╕реНрдЯрдо **рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░реЛрдлрд╛рдЗрд▓реНрд╕** рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:

* **`/usr/share/sandbox`**
* **`/System/Library/Sandbox/Profiles`**&#x20;
* рдЕрдиреНрдп рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░реЛрдлрд╛рдЗрд▓реНрд╕ рдХреА рдЬрд╛рдВрдЪ [https://github.com/s7ephen/OSX-Sandbox--Seatbelt--Profiles](https://github.com/s7ephen/OSX-Sandbox--Seatbelt--Profiles) рдкрд░ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред

**App Store** рдРрдкреНрд╕ **рдкреНрд░реЛрдлрд╛рдЗрд▓** **`/System/Library/Sandbox/Profiles/application.sb`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдЖрдк рдЗрд╕ рдкреНрд░реЛрдлрд╛рдЗрд▓ рдореЗрдВ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ рдПрдВрдЯрд╛рдЗрдЯрд▓рдореЗрдВрдЯреНрд╕ рдЬреИрд╕реЗ рдХрд┐ **`com.apple.security.network.server`** рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

SIP рдПрдХ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░реЛрдлрд╛рдЗрд▓ рд╣реИ рдЬрд┐рд╕реЗ platform_profile рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ /System/Library/Sandbox/rootless.conf рдореЗрдВ рд╣реИ

### рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░реЛрдлрд╛рдЗрд▓ рдЙрджрд╛рд╣рд░рдг

рдХрд┐рд╕реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ **рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░реЛрдлрд╛рдЗрд▓** рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
sandbox-exec -f example.sb /Path/To/The/Application
```
{% tabs %}
{% tab title="рд╕реНрдкрд░реНрд╢" %}
{% code title="touch.sb" %}
```scheme
(version 1)
(deny default)
(allow file* (literal "/tmp/hacktricks.txt"))
```
Since the provided text does not contain any English content to translate, there is no translation to provide. The text is a closing tag for a code block in markdown syntax. If you have any actual content that needs translation, please provide it, and I'll be happy to translate it for you.
```bash
# This will fail because default is denied, so it cannot execute touch
sandbox-exec -f touch.sb touch /tmp/hacktricks.txt
# Check logs
log show --style syslog --predicate 'eventMessage contains[c] "sandbox"' --last 30s
[...]
2023-05-26 13:42:44.136082+0200  localhost kernel[0]: (Sandbox) Sandbox: sandbox-exec(41398) deny(1) process-exec* /usr/bin/touch
2023-05-26 13:42:44.136100+0200  localhost kernel[0]: (Sandbox) Sandbox: sandbox-exec(41398) deny(1) file-read-metadata /usr/bin/touch
2023-05-26 13:42:44.136321+0200  localhost kernel[0]: (Sandbox) Sandbox: sandbox-exec(41398) deny(1) file-read-metadata /var
2023-05-26 13:42:52.701382+0200  localhost kernel[0]: (Sandbox) 5 duplicate reports for Sandbox: sandbox-exec(41398) deny(1) file-read-metadata /var
[...]
```
Since the content you've provided does not contain any English text that needs to be translated into Hindi, there is nothing to translate. If you provide the English text that needs translation, I can then translate it into Hindi for you, maintaining the markdown and HTML syntax as requested.
```scheme
(version 1)
(deny default)
(allow file* (literal "/tmp/hacktricks.txt"))
(allow process* (literal "/usr/bin/touch"))
; This will also fail because:
; 2023-05-26 13:44:59.840002+0200  localhost kernel[0]: (Sandbox) Sandbox: touch(41575) deny(1) file-read-metadata /usr/bin/touch
; 2023-05-26 13:44:59.840016+0200  localhost kernel[0]: (Sandbox) Sandbox: touch(41575) deny(1) file-read-data /usr/bin/touch
; 2023-05-26 13:44:59.840028+0200  localhost kernel[0]: (Sandbox) Sandbox: touch(41575) deny(1) file-read-data /usr/bin
; 2023-05-26 13:44:59.840034+0200  localhost kernel[0]: (Sandbox) Sandbox: touch(41575) deny(1) file-read-metadata /usr/lib/dyld
; 2023-05-26 13:44:59.840050+0200  localhost kernel[0]: (Sandbox) Sandbox: touch(41575) deny(1) sysctl-read kern.bootargs
; 2023-05-26 13:44:59.840061+0200  localhost kernel[0]: (Sandbox) Sandbox: touch(41575) deny(1) file-read-data /
```
The provided text does not contain any English content that needs to be translated into Hindi. It only includes markdown syntax and a filename, which should not be translated as per the instructions. If you have any English content that needs translation, please provide it, and I will translate it accordingly.
```scheme
(version 1)
(deny default)
(allow file* (literal "/private/tmp/hacktricks.txt"))
(allow process* (literal "/usr/bin/touch"))
(allow file-read-data (literal "/"))
; This one will work
```
{% endcode %}
{% endtab %}
{% endtabs %}

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **Windows** рдкрд░ рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ **Apple-рд▓рд┐рдЦрд┐рдд** **рд╕реЙрдлреНрдЯрд╡реЗрдпрд░** рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реИрдВрдбрдмреЙрдХреНрд╕рд┐рдВрдЧред
{% endhint %}

Bypasses рдЙрджрд╛рд╣рд░рдг:

* [https://lapcatsoftware.com/articles/sandbox-escape.html](https://lapcatsoftware.com/articles/sandbox-escape.html)
* [https://desi-jarvis.medium.com/office365-macos-sandbox-escape-fcce4fa4123c](https://desi-jarvis.medium.com/office365-macos-sandbox-escape-fcce4fa4123c) (рд╡реЗ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХреЗ рдмрд╛рд╣рд░ `~$` рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рд▓рд┐рдЦрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИрдВ)ред

### MacOS Sandbox Profiles

macOS рд╕рд┐рд╕реНрдЯрдо рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░реЛрдлрд╛рдЗрд▓реНрд╕ рдХреЛ рджреЛ рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ: **/usr/share/sandbox/** рдФрд░ **/System/Library/Sandbox/Profiles**ред

рдФрд░ рдпрджрд┐ рдХреЛрдИ рддреГрддреАрдп-рдкрдХреНрд╖ рдПрдкреНрд▓рд┐рдХреЗрд╢рди _**com.apple.security.app-sandbox**_ рдПрдВрдЯрд╛рдЗрдЯрд▓рдореЗрдВрдЯ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рд┐рд╕реНрдЯрдо рдЙрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрд░ **/System/Library/Sandbox/Profiles/application.sb** рдкреНрд░реЛрдлрд╛рдЗрд▓ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред

### **iOS Sandbox Profile**

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░реЛрдлрд╛рдЗрд▓ рдХрд╛ рдирд╛рдо **container** рд╣реИ рдФрд░ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ SBPL рдЯреЗрдХреНрд╕реНрдЯ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдирд╣реАрдВ рд╣реИред рдореЗрдореЛрд░реА рдореЗрдВ, рдпрд╣ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП Allow/Deny рдмрд╛рдЗрдирд░реА рдЯреНрд░реА рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### Debug & Bypass Sandbox

**macOS рдкрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдореЗрдВ рдирд╣реАрдВ рдмрдирддреА рд╣реИрдВ: iOS рдХреЗ рд╡рд┐рдкрд░реАрдд**, рдЬрд╣рд╛рдВ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХрд░реНрдиреЗрд▓ рджреНрд╡рд╛рд░рд╛ рдХрд┐рд╕реА рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдкрд╣рд▓реЗ рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, macOS рдкрд░ **рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕реНрд╡рдпрдВ рдХреЛ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдореЗрдВ рд░рдЦрдиреЗ рдХрд╛ рдЪреБрдирд╛рд╡ рдХрд░рдирд╛ рдкрдбрд╝рддрд╛ рд╣реИред**

рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдпреВрдЬрд░рд▓реИрдВрдб рд╕реЗ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдореЗрдВ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдЙрдирдХреЗ рдкрд╛рд╕ рдПрдВрдЯрд╛рдЗрдЯрд▓рдореЗрдВрдЯ рд╣реЛрддрд╛ рд╣реИ: `com.apple.security.app-sandbox`ред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╡рд┐рд╕реНрддреГрдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{% content-ref url="macos-sandbox-debug-and-bypass/" %}
[macos-sandbox-debug-and-bypass](macos-sandbox-debug-and-bypass/)
{% endcontent-ref %}

### **Check PID Privileges**

[**рдЗрд╕рдХреЗ рдЕрдиреБрд╕рд╛рд░**](https://www.youtube.com/watch?v=mG715HcDgO8\&t=3011s), **`sandbox_check`** (рдпрд╣ рдПрдХ `__mac_syscall` рд╣реИ), рдХрд┐рд╕реА рдирд┐рд╢реНрдЪрд┐рдд PID рдореЗрдВ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рджреНрд╡рд╛рд░рд╛ рдХрд┐рд╕реА рдСрдкрд░реЗрд╢рди рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрд╣ рдЬрд╛рдВрдЪ рд╕рдХрддрд╛ рд╣реИред

[**рдЯреВрд▓ sbtool**](http://newosxbook.com/src.jl?tree=listings\&file=sbtool.c) рдпрд╣ рдЬрд╛рдВрдЪ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдПрдХ PID рдХрд┐рд╕реА рдирд┐рд╢реНрдЪрд┐рдд рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```bash
sbtool <pid> mach #Check mac-ports (got from launchd with an api)
sbtool <pid> file /tmp #Check file access
sbtool <pid> inspect #Gives you an explaination of the sandbox profile
sbtool <pid> all
```
### рдРрдк рд╕реНрдЯреЛрд░ рдРрдкреНрд╕ рдореЗрдВ рдХрд╕реНрдЯрдо SBPL

рдХрдВрдкрдирд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рд╡реЗ рдЕрдкрдиреЗ рдРрдкреНрд╕ рдХреЛ **рдХрд╕реНрдЯрдо рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░реЛрдлрд╛рдЗрд▓реНрд╕ рдХреЗ рд╕рд╛рде** рдЪрд▓рд╛рдПрдВ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡рд╛рд▓реЗ рдХреЗ рдмрдЬрд╛рдп)ред рдЙрдиреНрд╣реЗрдВ рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдВрдЯрд╛рдЗрдЯрд▓рдореЗрдВрдЯ **`com.apple.security.temporary-exception.sbpl`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рд╕реЗ рдПрдкреНрдкрд▓ рджреНрд╡рд╛рд░рд╛ рдЕрдзрд┐рдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

рдЗрд╕ рдПрдВрдЯрд╛рдЗрдЯрд▓рдореЗрдВрдЯ рдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рдХреЛ **`/System/Library/Sandbox/Profiles/application.sb:`** рдореЗрдВ рдЬрд╛рдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```scheme
(sandbox-array-entitlement
"com.apple.security.temporary-exception.sbpl"
(lambda (string)
(let* ((port (open-input-string string)) (sbpl (read port)))
(with-transparent-redirection (eval sbpl)))))
```
```markdown
рдпрд╣ **рдЗрд╕ рдПрдВрдЯрд╛рдЗрдЯрд▓рдореЗрдВрдЯ рдХреЗ рдмрд╛рдж рдХреА рдЧрдИ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдЧрд╛** рдПрдХ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░реЛрдлрд╛рдЗрд▓ рдХреЗ рд░реВрдк рдореЗрдВред

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**ред
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
```
