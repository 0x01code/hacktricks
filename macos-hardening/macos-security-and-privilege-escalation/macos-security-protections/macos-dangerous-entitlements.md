# macOS рдЦрддрд░рдирд╛рдХ рдЕрдзрд┐рдХрд╛рд░ (Entitlements) рдФрд░ TCC рдЕрдиреБрдорддрд┐рдпрд╛рдБ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рддрдХ рдкрд╣реБрдБрдЪ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **[**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [**hacktricks repo**](https://github.com/carlospolop/hacktricks) рдФрд░ [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.**

</details>

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **`com.apple`** рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдЕрдзрд┐рдХрд╛рд░ (entitlements) рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЛ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИрдВ, рдХреЗрд╡рд▓ Apple рдЙрдиреНрд╣реЗрдВ рдЕрдиреБрджрд╛рди рджреЗ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

## рдЙрдЪреНрдЪ

### `com.apple.rootless.install.heritable`

рдЕрдзрд┐рдХрд╛рд░ **`com.apple.rootless.install.heritable`** SIP рдХреЛ **рдмрд╛рдпрдкрд╛рд╕** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред [рдЗрд╕реЗ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ](macos-sip.md#com.apple.rootless.install.heritable).

### **`com.apple.rootless.install`**

рдЕрдзрд┐рдХрд╛рд░ **`com.apple.rootless.install`** SIP рдХреЛ **рдмрд╛рдпрдкрд╛рд╕** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред [рдЗрд╕реЗ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ](macos-sip.md#com.apple.rootless.install).

### **`com.apple.system-task-ports` (рдкрд╣рд▓реЗ `task_for_pid-allow` рдХрд╣рд╛ рдЬрд╛рддрд╛ рдерд╛)**

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ рдХрд┐рд╕реА рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП **task port рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдХрд░реНрдиреЗрд▓ рдХреЛ рдЫреЛрдбрд╝рдХрд░ред [**рдЗрд╕реЗ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ**](../mac-os-architecture/macos-ipc-inter-process-communication/).

### `com.apple.security.get-task-allow`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ рдЕрдиреНрдп рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдЬрд┐рдирдХреЗ рдкрд╛рд╕ **`com.apple.security.cs.debugger`** рдЕрдзрд┐рдХрд╛рд░ рд╣реИ, рдЙрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ task port рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдФрд░ **рдЙрд╕ рдкрд░ рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЗрд╕ рдЕрдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдмрд╛рдЗрдирд░реА рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред [**рдЗрд╕реЗ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ**](../mac-os-architecture/macos-ipc-inter-process-communication/).

### `com.apple.security.cs.debugger`

рдбрд┐рдмрдЧрд┐рдВрдЧ рдЯреВрд▓ рдЕрдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдРрдкреНрд╕ `task_for_pid()` рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рдЕрдирд╕рд╛рдЗрдиреНрдб рдФрд░ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдРрдкреНрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реИрдз task port рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХреЗрдВ рдЬрд┐рдирдХреЗ рдкрд╛рд╕ `Get Task Allow` рдЕрдзрд┐рдХрд╛рд░ `true` рдкрд░ рд╕реЗрдЯ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдбрд┐рдмрдЧрд┐рдВрдЧ рдЯреВрд▓ рдЕрдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд╛рде рднреА, рдПрдХ рдбрд┐рдмрдЧрд░ **task ports рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛** рдЙрди рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдЬрд┐рдирдХреЗ рдкрд╛рд╕ `Get Task Allow` рдЕрдзрд┐рдХрд╛рд░ **рдирд╣реАрдВ рд╣реИ**, рдФрд░ рдЬреЛ рдЗрд╕рд▓рд┐рдП System Integrity Protection рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╣реИрдВред [**рдЗрд╕реЗ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ**](https://developer.apple.com/documentation/bundleresources/entitlements/com\_apple\_security\_cs\_debugger).

### `com.apple.security.cs.disable-library-validation`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ **Apple рджреНрд╡рд╛рд░рд╛ рд╕рд╛рдЗрди рдХрд┐рдП рдЧрдП рдпрд╛ рдореБрдЦреНрдп рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдХреЗ рд╕рдорд╛рди Team ID рдХреЗ рд╕рд╛рде рд╕рд╛рдЗрди рдХрд┐рдП рдЧрдП рдмрд┐рдирд╛ рдлреНрд░реЗрдорд╡рд░реНрдХ, рдкреНрд▓рдЧ-рдЗрдиреНрд╕, рдпрд╛ рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХрд┐рд╕реА рдордирдорд╛рдиреА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓реЛрдб рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред [**рдЗрд╕реЗ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ**](https://developer.apple.com/documentation/bundleresources/entitlements/com\_apple\_security\_cs\_disable-library-validation).

### `com.apple.private.security.clear-library-validation`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ **`com.apple.security.cs.disable-library-validation`** рдХреЗ рд╕рдорд╛рди рд╣реИ рд▓реЗрдХрд┐рди **рдЗрд╕рдХреЗ рдмрдЬрд╛рдп** рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╡реИрд▓рд┐рдбреЗрд╢рди рдХреЛ **рд╕реАрдзреЗ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ** рдХреЗ рдмрдЬрд╛рдп, рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ **`csops` рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ рдЗрд╕реЗ рдЕрдХреНрд╖рдо рдХрд░ рд╕рдХреЗ**ред\
[**рдЗрд╕реЗ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ**](https://theevilbit.github.io/posts/com.apple.private.security.clear-library-validation/).

### `com.apple.security.cs.allow-dyld-environment-variables`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ **DYLD рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ (environment variables) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬ рдФрд░ рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред [**рдЗрд╕реЗ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ**](https://developer.apple.com/documentation/bundleresources/entitlements/com\_apple\_security\_cs\_allow-dyld-environment-variables).

### `com.apple.private.tcc.manager` рдпрд╛ `com.apple.rootless.storage`.`TCC`

[**рдЗрд╕ рдмреНрд▓реЙрдЧ рдХреЗ рдЕрдиреБрд╕рд╛рд░**](https://objective-see.org/blog/blog\_0x4C.html) **рдФрд░** [**рдЗрд╕ рдмреНрд▓реЙрдЧ рдХреЗ рдЕрдиреБрд╕рд╛рд░**](https://wojciechregula.blog/post/play-the-music-and-bypass-tcc-aka-cve-2020-29621/), рдпреЗ рдЕрдзрд┐рдХрд╛рд░ **TCC** рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред

### **`system.install.apple-software`** рдФрд░ **`system.install.apple-software.standar-user`**

рдпреЗ рдЕрдзрд┐рдХрд╛рд░ **рдмрд┐рдирд╛ рдЕрдиреБрдорддрд┐ рдорд╛рдВрдЧреЗ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЬреЛ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡реГрджреНрдзрд┐ (privilege escalation)** рдХреЗ рд▓рд┐рдП рд╕рд╣рд╛рдпрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### `com.apple.private.security.kext-management`

рдЕрдзрд┐рдХрд╛рд░ рдЬреЛ **рдХрд░реНрдиреЗрд▓ рд╕реЗ рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

### **`com.apple.private.icloud-account-access`**

рдЕрдзрд┐рдХрд╛рд░ **`com.apple.private.icloud-account-access`** рдХреЗ рд╕рд╛рде рд╕рдВрднрд╡ рд╣реИ **`com.apple.iCloudHelper`** XPC рд╕реЗрд╡рд╛ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдирд╛ рдЬреЛ **iCloud рдЯреЛрдХрди рдкреНрд░рджрд╛рди рдХрд░реЗрдЧреА**ред

**iMovie** рдФрд░ **Garageband** рдореЗрдВ рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ рдерд╛ред

рдЙрд╕ рдЕрдзрд┐рдХрд╛рд░ рд╕реЗ **iCloud рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА** рдХреЗ рд▓рд┐рдП рдЯреЙрдХ рджреЗрдЦреЗрдВ: [**#OBTS v5.0: "What Happens on your Mac, Stays on Apple's iCloud?!" - Wojciech Regula**](https://www.youtube.com/watch?v=\_6e2LhmxVc0)

### `com.apple.private.tcc.manager.check-by-audit-token`

TODO: рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ рдпрд╣ рдХреНрдпрд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ

### `com.apple.private.apfs.revert-to-snapshot`

TODO: [**рдЗрд╕ рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ**](https://jhftss.github.io/The-Nightmare-of-Apple-OTA-Update/) **рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ SSV-рд╕рдВрд░рдХреНрд╖рд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЛ рд░рд┐рдмреВрдЯ рдХреЗ рдмрд╛рдж рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЕрдЧрд░ рдЖрдкрдХреЛ рдкрддрд╛ рд╣реИ рддреЛ рдХреГрдкрдпрд╛ PR рднреЗрдЬреЗрдВ!**

### `com.apple.private.apfs.create-sealed-snapshot`

TODO: [**рдЗрд╕ рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ**](https://jhftss.github.io/The-Nightmare-of-Apple-OTA-Update/) **рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ SSV-рд╕рдВрд░рдХреНрд╖рд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЛ рд░рд┐рдмреВрдЯ рдХреЗ рдмрд╛рдж рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЕрдЧрд░ рдЖрдкрдХреЛ рдкрддрд╛ рд╣реИ рддреЛ рдХреГрдкрдпрд╛ PR рднреЗрдЬреЗрдВ!**

### `keychain-access-groups`

рдпрд╣ рдЕрдзрд┐рдХрд╛рд░ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ **keychain** рд╕рдореВрд╣ рдЬрд┐рди рддрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдкрд╣реБрдБрдЪ рд╣реИ:
```xml
<key>keychain-access-groups</key>
<array>
<string>ichat</string>
<string>apple</string>
<string>appleaccount</string>
<string>InternetAccounts</string>
<string>IMCore</string>
</array>
```
### **`kTCCServiceSystemPolicyAllFiles`**

**рдкреВрд░реНрдг рдбрд┐рд╕реНрдХ рдПрдХреНрд╕реЗрд╕** рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ TCC рдХреА рд╕рдмрд╕реЗ рдЙрдЪреНрдЪ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред

### **`kTCCServiceAppleEvents`**

рдРрдк рдХреЛ рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдХреЛ рдЗрд╡реЗрдВрдЯреНрд╕ рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рдЖрдорддреМрд░ рдкрд░ **рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдЕрдиреНрдп рдПрдкреНрд╕ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реБрдП, рдпрд╣ рдЙрди рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдХреЛ рджреА рдЧрдИ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЬреИрд╕реЗ рдХрд┐ рдЙрдиреНрд╣реЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдЙрд╕рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдорд╛рдВрдЧрдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдирд╛:

{% code overflow="wrap" %}
```bash
osascript -e 'tell app "App Store" to activate' -e 'tell app "App Store" to activate' -e 'tell app "App Store" to display dialog "App Store requires your password to continue." & return & return default answer "" with icon 1 with hidden answer with title "App Store Alert"'
```
{% endcode %}

рдпрд╛ рдЙрдиреНрд╣реЗрдВ **рдордирдорд╛рдиреА рдХреНрд░рд┐рдпрд╛рдПрдВ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рдирд╛ред

### **`kTCCServiceEndpointSecurityClient`**

рдЕрдиреНрдп рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ, рдпрд╣ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ TCC рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рд▓рд┐рдЦрдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

### **`kTCCServiceSystemPolicySysAdminFiles`**

рдпрд╣ **`NFSHomeDirectory`** рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЛ **рдмрджрд▓рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╣реЛрдо рдлреЛрд▓реНрдбрд░ рдкрде рдХреЛ рдмрджрд▓рддрд╛ рд╣реИ рдФрд░ рдЗрд╕рд▓рд┐рдП TCC рдХреЛ **рдмрд╛рдпрдкрд╛рд╕** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

### **`kTCCServiceSystemPolicyAppBundles`**

рдРрдкреНрд╕ рдмрдВрдбрд▓ рдХреЗ рдЕрдВрджрд░ (рдРрдк.app рдХреЗ рдЕрдВрджрд░) рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ**ред

<figure><img src="../../../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

_рд╕рд┐рд╕реНрдЯрдо рд╕реЗрдЯрд┐рдВрдЧреНрд╕_ > _рдкреНрд░рд╛рдЗрд╡реЗрд╕реА & рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА_ > _рдРрдк рдореИрдиреЗрдЬрдореЗрдВрдЯ_ рдореЗрдВ рдЬрд╛рдХрд░ рдЗрд╕ рдПрдХреНрд╕реЗрд╕ рдХреЛ рдХреМрди рд░рдЦрддрд╛ рд╣реИ рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рд╕рдВрднрд╡ рд╣реИред

### `kTCCServiceAccessibility`

рдкреНрд░рдХреНрд░рд┐рдпрд╛ macOS рдХреА рдПрдХреНрд╕реЗрд╕рд┐рдмрд┐рд▓рд┐рдЯреА рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ **рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдЧреА**, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╡рд╣ рдХреАрд╕реНрдЯреНрд░реЛрдХреНрд╕ рджрдмрд╛ рд╕рдХреЗрдЧрд╛ред рдЗрд╕рд▓рд┐рдП рд╡рд╣ Finder рдЬреИрд╕реЗ рдРрдк рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕реЗрд╕ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕ рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде рдбрд╛рдпрд▓реЙрдЧ рдХреЛ рдордВрдЬреВрд░реА рджреЗ рд╕рдХрддрд╛ рд╣реИред

## рдордзреНрдпрдо

### `com.apple.security.cs.allow-jit`

рдпрд╣ рдЕрдиреБрдорддрд┐ `mmap()` рд╕рд┐рд╕реНрдЯрдо рдлрдВрдХреНрд╢рди рдХреЛ `MAP_JIT` рдлреНрд▓реИрдЧ рдкрд╛рд╕ рдХрд░рдХреЗ **рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдФрд░ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдореЗрдореЛрд░реА рдмрдирд╛рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред [**рдЗрд╕рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**](https://developer.apple.com/documentation/bundleresources/entitlements/com\_apple\_security\_cs\_allow-jit) рджреЗрдЦреЗрдВред

### `com.apple.security.cs.allow-unsigned-executable-memory`

рдпрд╣ рдЕрдиреБрдорддрд┐ **C рдХреЛрдб рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдпрд╛ рдкреИрдЪ рдХрд░рдиреЗ**, рд▓рдВрдмреЗ рд╕рдордп рд╕реЗ рдкреНрд░рдЪрд▓рд┐рдд **`NSCreateObjectFileImageFromMemory`** (рдЬреЛ рдореВрд▓ рд░реВрдк рд╕реЗ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ, рдпрд╛ **DVDPlayback** рдлреНрд░реЗрдорд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред [**рдЗрд╕рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**](https://developer.apple.com/documentation/bundleresources/entitlements/com\_apple\_security\_cs\_allow-unsigned-executable-memory) рджреЗрдЦреЗрдВред

{% hint style="danger" %}
рдЗрд╕ рдЕрдиреБрдорддрд┐ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рд╕реЗ рдЖрдкрдХреЗ рдРрдк рдХреЛ рдореЗрдореЛрд░реА-рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдХреЛрдб рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рдЦрддрд░рд╛ рд╣реЛрддрд╛ рд╣реИред рдзреНрдпрд╛рди рд╕реЗ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдкрдХреЗ рдРрдк рдХреЛ рдпрд╣ рдЕрдкрд╡рд╛рдж рдЪрд╛рд╣рд┐рдПред
{% endhint %}

### `com.apple.security.cs.disable-executable-page-protection`

рдпрд╣ рдЕрдиреБрдорддрд┐ рдЕрдкрдиреА рдЦреБрдж рдХреА рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рдЦрдВрдбреЛрдВ рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рддрд╛рдХрд┐ рдЬрдмрд░рди рдмрд╛рд╣рд░ рдирд┐рдХрд▓ рд╕рдХреЗрдВред [**рдЗрд╕рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**](https://developer.apple.com/documentation/bundleresources/entitlements/com\_apple\_security\_cs\_disable-executable-page-protection) рджреЗрдЦреЗрдВред

{% hint style="danger" %}
рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдореЗрдореЛрд░реА рд╕реБрд░рдХреНрд╖рд╛ рдЕрдиреБрдорддрд┐ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рдирд╛ рдПрдХ рдЕрддреНрдпрдВрдд рдЕрдиреБрдорддрд┐ рд╣реИ рдЬреЛ рдЖрдкрдХреЗ рдРрдк рд╕реЗ рдПрдХ рдореМрд▓рд┐рдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрд░рдХреНрд╖рдг рдХреЛ рд╣рдЯрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЗ рдРрдк рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдХреЛрдб рдХреЛ рдмрд┐рдирд╛ рдкрддрд╛ рд▓рдЧрд╛рдП рдкреБрдирд░реНрд▓реЗрдЦрди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рд╕рдВрднрд╡ рд╣реЛ рддреЛ рд╕рдВрдХреАрд░реНрдг рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджреЗрдВред
{% endhint %}

### `com.apple.security.cs.allow-relative-library-loads`

TODO

### `com.apple.private.nullfs_allow`

рдпрд╣ рдЕрдиреБрдорддрд┐ рдПрдХ nullfs рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ (рдЬреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдирд┐рд╖рд┐рджреНрдз рд╣реИ)ред рдЯреВрд▓: [**mount\_nullfs**](https://github.com/JamaicanMoose/mount\_nullfs/tree/master).

### `kTCCServiceAll`

рдЗрд╕ рдмреНрд▓реЙрдЧрдкреЛрд╕реНрдЯ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдпрд╣ TCC рдЕрдиреБрдорддрд┐ рдЖрдорддреМрд░ рдкрд░ рдЗрд╕ рд░реВрдк рдореЗрдВ рдкрд╛рдИ рдЬрд╛рддреА рд╣реИ:
```
[Key] com.apple.private.tcc.allow-prompting
[Value]
[Array]
[String] kTCCServiceAll
```
рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ **рд╕рднреА TCC рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкреВрдЫрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВ**ред

### **`kTCCServicePostEvent`**

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рддрдХ рдкрд╣реБрдБрдЪ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, hacktricks repo** рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдФрд░ [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВред

</details>
