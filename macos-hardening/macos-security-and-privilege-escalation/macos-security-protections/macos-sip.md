# macOS SIP

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## **рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА**

macOS рдореЗрдВ **System Integrity Protection (SIP)** рдПрдХ рддрдВрддреНрд░ рд╣реИ рдЬреЛ рдЕрдзрд┐рдХрддрдо рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рднреА рдкреНрд░рдореБрдЦ рд╕рд┐рд╕реНрдЯрдо рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдирдзрд┐рдХреГрдд рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛ рд╕рд┐рд╕реНрдЯрдо рдХреА рдЕрдЦрдВрдбрддрд╛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕рдВрд░рдХреНрд╖рд┐рдд рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЬреЛрдбрд╝рдирд╛, рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛, рдпрд╛ рд╣рдЯрд╛рдирд╛ рдЬреИрд╕реЗ рдХрд╛рд░реНрд░рд╡рд╛рдИрдпреЛрдВ рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рддрд╛ рд╣реИред SIP рджреНрд╡рд╛рд░рд╛ рд░рдХреНрд╖рд┐рдд рдореБрдЦреНрдп рдлреЛрд▓реНрдбрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* **/System**
* **/bin**
* **/sbin**
* **/usr**

SIP рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЗ рдирд┐рдпрдо рдЬреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рд╡реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ **`/System/Library/Sandbox/rootless.conf`** рдкрд░ рд╕реНрдерд┐рдд рд╣реИред рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ, рдЙрди рдкрдереЛрдВ рдХреЛ рдЬреЛ рдПрд╕реНрдЯреНрд░рд┐рдХреНрд╕ (*) рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рд╣реЛрддреЗ рд╣реИрдВ, рд╡реЗ рдЕрдиреНрдпрдерд╛ рдХрдареЛрд░ SIP рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдкрд╡рд╛рдж рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдг рдХреЛ рдзреНрдпрд╛рди рд╕реЗ рджреЗрдЦреЗрдВ:
```javascript
/usr
* /usr/libexec/cups
* /usr/local
* /usr/share/man
```
рдпрд╣ рд╕реНрдирд┐рдкреЗрдЯ рд╕реВрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЬрдмрдХрд┐ SIP рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ **`/usr`** рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ, рд╡рд╣рд╛рдВ рд╡рд┐рд╢реЗрд╖ рдЙрдкрдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдВ (`/usr/libexec/cups`, `/usr/local`, рдФрд░ `/usr/share/man`) рд╣реИрдВ рдЬрд╣рд╛рдВ рд╕рдВрд╢реЛрдзрди рд╕рдВрднрд╡ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдЙрдирдХреЗ рдкрдереЛрдВ рдХреЗ рдкрд╣рд▓реЗ рддрд╛рд░рдХ (*) рджреНрд╡рд╛рд░рд╛ рд╕реВрдЪрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдпрд╛ рдлрд╝рд╛рдЗрд▓ рдХреЛ SIP рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк **`ls -lOd`** рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ **`restricted`** рдпрд╛ **`sunlnk`** рдзреНрд╡рдЬ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```bash
ls -lOd /usr/libexec/cups
drwxr-xr-x  11 root  wheel  sunlnk 352 May 13 00:29 /usr/libexec/cups
```
рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, **`sunlnk`** рдлреНрд▓реИрдЧ рдпрд╣ рд╕рдВрдХреЗрддрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ `/usr/libexec/cups` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реНрд╡рдпрдВ **рд╣рдЯрд╛рдИ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддреА**, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рд╕рдВрд╢реЛрдзрд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдпрд╛ рд╣рдЯрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

рджреВрд╕рд░реА рдУрд░:
```bash
ls -lOd /usr/libexec
drwxr-xr-x  338 root  wheel  restricted 10816 May 13 00:29 /usr/libexec
```
рдпрд╣рд╛рдБ, **`restricted`** рдлреНрд▓реИрдЧ рдпрд╣ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ `/usr/libexec` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ SIP рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╣реИред SIP рд╕реЗ рд╕рдВрд░рдХреНрд╖рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ, рдлрд╝рд╛рдЗрд▓реЗрдВ рдирд╣реАрдВ рдмрдирд╛рдИ рдЬрд╛ рд╕рдХрддреАрдВ, рд╕рдВрд╢реЛрдзрд┐рдд рдирд╣реАрдВ рдХреА рдЬрд╛ рд╕рдХрддреАрдВ, рдпрд╛ рд╣рдЯрд╛рдИ рдЬрд╛ рд╕рдХрддреАрдВред

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдЕрдЧрд░ рдХрд┐рд╕реА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **`com.apple.rootless`** рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд **рд╡рд┐рд╢реЗрд╖рддрд╛** рд╢рд╛рдорд┐рд▓ рд╣реИ, рддреЛ рд╡рд╣ рдлрд╝рд╛рдЗрд▓ рднреА **SIP рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд** рд╣реЛрдЧреАред

**SIP рдЕрдиреНрдп рд░реВрдЯ рдХреНрд░рд┐рдпрд╛рдПрдБ рднреА рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИ** рдЬреИрд╕реЗ:

* рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рд▓реЛрдб рдХрд░рдирд╛
* Apple-рд╕рд╛рдЗрди рдХрд┐рдП рдЧрдП рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЯрд╛рд╕реНрдХ-рдкреЛрд░реНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛
* NVRAM рдЪрд░рд┐рддреНрд░рд┐рдд рдХрд░рдирд╛
* рдХрд░реНрдиреЗрд▓ рдбреАрдмрдЧрд┐рдВрдЧ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛

рд╡рд┐рдХрд▓реНрдк nvram рдЪрд░рд┐рддреНрд░рд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рд░рдЦреЗ рдЬрд╛рддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдПрдХ рдмрд┐рдЯрдлреНрд▓реИрдЧ (`csr-active-config` рдЗрдВрдЯреЗрд▓ рдкрд░ рдФрд░ `lp-sip0` ARM рдХреЗ рд▓рд┐рдП рдмреВрдЯреЗрдб рдбрд┐рд╡рд╛рдЗрд╕ рдЯреНрд░реА рд╕реЗ рдкрдврд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ)ред рдЖрдк `csr.sh` рдореЗрдВ XNU рд╕реНрд░реЛрдд рдХреЛрдб рдореЗрдВ рдЭрдВрдЭрдЯ рджреНрд╡рд╛рд░рд╛ рдЭрдВрдЭрдЯ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

<figure><img src="../../../.gitbook/assets/image (720).png" alt=""><figcaption></figcaption></figure>

### SIP рд╕реНрдерд┐рддрд┐

рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ SIP рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕рдХреНрд╖рдо рд╣реИ рдпрд╛ рдирд╣реАрдВ:
```bash
csrutil status
```
рдпрджрд┐ рдЖрдкрдХреЛ SIP рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдЕрдкрдиреЗ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдореЛрдб рдореЗрдВ рдкреБрдирд░рд╛рд░рдВрдн рдХрд░рдирд╛ рд╣реЛрдЧрд╛ (рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдХреЗ рджреМрд░рд╛рди Command+R рджрдмрд╛рдХрд░), рдлрд┐рд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛:
```bash
csrutil disable
```
рдпрджрд┐ рдЖрдк SIP рд╕рдХреНрд╖рдо рд░рдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдбреАрдмрдЧрд┐рдВрдЧ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рд╣рдЯрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рд╕рд╛рде рдРрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
csrutil enable --without debug
```
### рдЕрдиреНрдп рдкреНрд░рддрд┐рдмрдВрдз

- **рдЕрд╕рд╛рдЗрди рдХрд░реНрдгреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕** (kexts) рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ, рдЗрд╕ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреЗрд╡рд▓ рд╕рддреНрдпрд╛рдкрд┐рдд рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдХрд░реНрдгреЗрд▓ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВред
- **macOS рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдбреАрдмрдЧрд┐рдВрдЧ рд░реЛрдХрддрд╛ рд╣реИ**, рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рдФрд░ рд╕рдВрд╢реЛрдзрди рд╕реЗ рдореВрд▓ рд╕рд┐рд╕реНрдЯрдо рдШрдЯрдХреЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред
- **рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рд░реЛрдХрддрд╛ рд╣реИ** рдЬреИрд╕реЗ dtrace рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рд╕реЗ, рдЬреЛ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреА рдЕрдЦрдВрдбрддрд╛ рдХреА рдФрд░ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред

**[рдЗрд╕ рдЯреЙрдХ рдореЗрдВ SIP рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдиреЗрдВ](https://www.slideshare.net/i0n1c/syscan360-stefan-esser-os-x-el-capitan-sinking-the-ship).**

## SIP рдмрд╛рдпрдкрд╛рд╕

SIP рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛрддреА рд╣реИ:

- **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдирд╛**: рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рд╕реЗ рдореЗрд▓, рд╕рдВрджреЗрд╢ рдФрд░ рд╕рдлрд╛рд░реА рдЗрддрд┐рд╣рд╛рд╕ рдЬреИрд╕реА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рдкрдврд╝рдирд╛ред
- **TCC рдмрд╛рдпрдкрд╛рд╕**: рдЕрдирдзрд┐рдХреГрдд рд░реВрдк рд╕реЗ рд╡реЗрдмрдХреИрдо, рдорд╛рдЗрдХреНрд░реЛрдлреЛрди рдФрд░ рдЕрдиреНрдп рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП TCC (рдкрд╛рд░рджрд░реНрд╢рд┐рддрд╛, рд╕рд╣рдорддрд┐ рдФрд░ рдирд┐рдпрдВрддреНрд░рдг) рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рд╕реАрдзреЗ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдирд╛ред
- **рд╕реНрдерд╛рдпрд┐рддреНрд╡ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛**: SIP рд╕реЗ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рдореИрд▓рд╡реЗрдпрд░ рд░рдЦрдирд╛, рдЬрд┐рд╕рд╕реЗ рдЗрд╕реЗ рд╣рдЯрд╛рдирд╛ рдХрдард┐рди рд╣реЛ, рдпрд╣рд╛рдБ рддрдХ рдХрд┐ рд░реВрдЯ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рднреАред рдЗрд╕рдореЗрдВ рдореИрд▓рд╡реЗрдпрд░ рд╣рдЯрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдХрд░рдг (MRT) рдХреЗ рд╕рд╛рде рдЦрд┐рд▓рд╡рд╛рдбрд╝ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИред
- **рдХрд░реНрдгреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рд▓реЛрдб рдХрд░рдирд╛**: рдпрджреНрдпрдкрд┐ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рд╣реИрдВ, SIP рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рд╕реЗ рдЕрд╕рд╛рдЗрди рдХрд░реНрдгреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рд░рд▓ рд╣реЛ рдЬрд╛рддреА рд╣реИред

### рдЗрдВрд╕реНрдЯреЙрд▓рд░ рдкреИрдХреЗрдЬ

**Apple рдХреЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕реЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдЗрдВрд╕реНрдЯреЙрд▓рд░ рдкреИрдХреЗрдЬ** рдЗрд╕рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрджрд┐ рд╕рд╛рдзрд╛рд░рд┐рдд рдбреЗрд╡рд▓рдкрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдкреИрдХреЗрдЬ SIP рд╕рдВрд░рдХреНрд╖рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рд╡реЗ рд░реЛрдХреЗ рдЬрд╛рдПрдВрдЧреЗред

### рдЕрд╕реНрддрд┐рддреНрд╡рд╣реАрди SIP рдлрд╝рд╛рдЗрд▓

рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рдЫрд▓ рдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдпрджрд┐ рдПрдХ рдлрд╝рд╛рдЗрд▓ **`rootless.conf` рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХреА рдЧрдИ рд╣реИ рд▓реЗрдХрд┐рди рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ**, рддреЛ рдЗрд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдореИрд▓рд╡реЗрдпрд░ рдЗрд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ **рд╕реНрдерд╛рдпрд┐рддреНрд╡ рд╕реНрдерд╛рдкрд┐рдд** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдХрд╛рд░реНрдпрдХреНрд░рдо `/System/Library/LaunchDaemons` рдореЗрдВ рдПрдХ .plist рдлрд╝рд╛рдЗрд▓ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдЕрдЧрд░ рдпрд╣ `rootless.conf` рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рд╣реИ рд▓реЗрдХрд┐рди рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИред

### com.apple.rootless.install.heritable

{% hint style="danger" %}
рдЕрдзрд┐рдХрд╛рд░ **`com.apple.rootless.install.heritable`** SIP рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ
{% endhint %}

#### Shrootless

[**рдЗрд╕ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ рд╕реЗ рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ**](https://www.microsoft.com/en-us/security/blog/2021/10/28/microsoft-finds-new-macos-vulnerability-shrootless-that-could-bypass-system-integrity-protection/) macOS рдХреА рд╕рд┐рд╕реНрдЯрдо рдЗрдВрдЯреЗрдЧреНрд░рд┐рдЯреА рд╕реБрд░рдХреНрд╖рд╛ (SIP) рддрдВрддреНрд░ рдореЗрдВ рдПрдХ рд╡рдВрд╢рдЬ рд╡рд┐рдХрд▓реНрдк 'Shrootless' рд╡рдВрд╢рдЬ рдХреА рдЦреЛрдЬ рдХреАред рдЗрд╕ рд╡рдВрд╢рдЬ рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ **`system_installd`** рдбреЗрдорди рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдЕрдзрд┐рдХрд╛рд░ рд╣реИ, **`com.apple.rootless.install.heritable`**, рдЬреЛ рдЗрд╕рдХреЗ рдХрд┐рд╕реА рднреА рдмрдЪреНрдЪреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ SIP рдХреА рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

**`system_installd`** рдбреЗрдорди рдЙрди рдкреИрдХреЗрдЬреЛрдВ рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдЧрд╛ рдЬрд┐рдиреНрд╣реЗрдВ **Apple** рдиреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдХрд┐рдпрд╛ рд╣реИред

рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ рдкрд╛рдпрд╛ рдХрд┐ рдПрдХ Apple рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдкреИрдХреЗрдЬ (.pkg рдлрд╝рд╛рдЗрд▓) рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рджреМрд░рд╛рди, **`system_installd`** рдХрд┐рд╕реА рднреА **рдкреЛрд╕реНрдЯ-рд╕реНрдерд╛рдкрдирд╛** рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЬреЛ рдкреИрдХреЗрдЬ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ, **рдЪрд▓рд╛рддрд╛ рд╣реИ**ред рдпреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╢реИрд▓реА, **`zsh`**, рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдореЛрдб рдореЗрдВ рднреА **рдЪрд▓рд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ**ред рдпрд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛: рдПрдХ рд╣рд╛рдирд┐рдХрд╛рд░рдХ `/etc/zshenv` рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдХрд░ рдФрд░ **`system_installd` рдХреЛ `zsh` рдЖрдордВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╡реЗ рдЙрдкрдХрд░рдг рдкрд░ рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░ рд╕рдХрддреЗ рдереЗред

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдкрд╛рдпрд╛ рдЧрдпрд╛ рдХрд┐ **`/etc/zshenv` рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рд╣рдорд▓рд╛ рддрдХ рдкреНрд░рдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛**, рди рдХреЗрд╡рд▓ рдПрдХ SIP рдмрд╛рдпрдкрд╛рд╕ рдХреЗ рд▓рд┐рдПред рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЗ рдкрд╛рд╕ рдПрдХ `~/.zshenv` рдлрд╝рд╛рдЗрд▓ рд╣реЛрддреА рд╣реИ, рдЬреЛ `/etc/zshenv` рдХреЗ рддрд░рд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддреА рд╣реИ рд▓реЗрдХрд┐рди рд░реВрдЯ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред рдпрд╣ рдлрд╝рд╛рдЗрд▓ рд╕реНрдерд╛рдпрд┐рддреНрд╡ рддрдВрддреНрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рдереА, рд╣рд░ рдмрд╛рд░ `zsh` рд╢реБрд░реВ рд╣реЛрддреЗ рд╕рдордп рдЯреНрд░рд┐рдЧрд░ рдХрд░рддреА рдереА, рдпрд╛ рдПрдХ рдЙрдЪреНрдЪрддрдо рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдореЗрдХреЗрдирд┐рдЬрд╝рдо рдХреЗ рд░реВрдк рдореЗрдВред рдпрджрд┐ рдПрдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `sudo -s` рдпрд╛ `sudo <рдХрдорд╛рдВрдб>` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд░реВрдЯ рдореЗрдВ рдЙрдЪреНрдЪрддрдо рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рддреЛ `~/.zshenv` рдлрд╝рд╛рдЗрд▓ рдЯреНрд░рд┐рдЧрд░ рд╣реЛ рдЬрд╛рдПрдЧреА, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд░реВрдЯ рдореЗрдВ рдЙрдЪреНрдЪрддрдо рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреА рд╣реИред

#### [**CVE-2022-22583**](https://perception-point.io/blog/technical-analysis-cve-2022-22583/)

[**CVE-2022-22583**](https://perception-point.io/blog/technical-analysis-cve-2022-22583/) рдореЗрдВ рдкрд╛рдпрд╛ рдЧрдпрд╛ рдХрд┐ рд╡рд╣реА **`system_installd`** рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрднрдпрд╛рд░рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ **рдкреЛрд╕реНрдЯ-рд╕реНрдерд╛рдкрдирд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ `/tmp` рдХреЗ рдЕрдВрджрд░ SIP рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдирд╛рдорд┐рдд рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдбрд╛рд▓ рд░рд╣рд╛ рдерд╛**ред рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ **`/tmp` рд╕реНрд╡рдпрдВ SIP рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИ**, рдЗрд╕рд▓рд┐рдП рдЗрд╕ рдкрд░ **рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдореЗрдЬ рдорд╛рдЙрдВрдЯ** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛, рдлрд┐рд░ **рдЗрдВрд╕реНрдЯреЙрд▓рд░** рдЙрд╕рдореЗрдВ **рдкреЛрд╕реНрдЯ-рд╕реНрдерд╛рдкрдирд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдбрд╛рд▓ рджреЗрддрд╛ рдерд╛, **рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдореЗрдЬ рдХреЛ рдЕрдирдорд╛рдЙрдВрдЯ** рдХрд░рддрд╛ рдерд╛, **рд╕рднреА рдлрд╝реЛрд▓реНрдбрд░реНрд╕ рдХреЛ рдкреБрдирдГ рдмрдирд╛рддрд╛ рдерд╛** рдФрд░ **рдкреЛрд╕реНрдЯ рд╕реНрдерд╛рдкрдирд╛** рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреЗрдпрд▓реЛрдб** рдЬреЛрдбрд╝ рджреЗрддрд╛ рдерд╛ред

#### [fsck\_cs рдпреВрдЯрд┐рд▓рд┐рдЯреА](https://www.theregister.com/2016/03/30/apple\_os\_x\_rootless/)

рдПрдХ рд╡рдВрд╢рдЬ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдЧрдИ рдЬрд╣рд╛рдВ **`fsck_cs`** рдХреЛ **рд╕рд┐рдореНрдмреЙрд▓рд┐рдХ рд▓рд┐рдВрдХреНрд╕** рдХрд╛ рдкрд╛рд▓рди рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреЗ рдХрд╛рд░рдг рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдлрд╝рд╛рдЗрд▓ рдХреЛ рдХреНрд╖рддрд┐ рдкрд╣реБрдВрдЪрд╛рдИ рдЧрдИ рдереАред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдиреЗ _`/dev/diskX`_ рд╕реЗ рд▓рд┐рдВрдХ рдмрдирд╛рдпрд╛ рдерд╛ рдлрд╝рд╛рдЗрд▓ `/System/Library/Extensions/AppleKextExcludeList.kext/Contents/Info.plist`ред _`/dev/diskX`_ рдкрд░ **`fsck_cs`** рдХрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди `Info.plist` рдХреА рдХреНрд╖рддрд┐ рдХрд░ рджреАред рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХреА рдЕрдЦрдВрдбрддрд╛ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ SIP (рд╕рд┐рд╕реНрдЯрдо рдЗрдВрдЯреЗрдЧреНрд░рд┐рдЯреА рд╕реБрд░рдХреНрд╖рд╛) рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рдЬреЛ рдХрд░реНрдг
```bash
ln -s /System/Library/Extensions/AppleKextExcludeList.kext/Contents/Info.plist /dev/diskX
fsck_cs /dev/diskX 1>&-
touch /Library/Extensions/
reboot
```
#### рдЗрд╕ рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдорд┐рддрддрд╛ рдХреА рджреБрд░реБрдкрдпреЛрдЧрди рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ рд╣реИрдВред `Info.plist` рдлрд╝рд╛рдЗрд▓, рдЬреЛ рд╕рд╛рдорд╛рдиреНрдпрдд: рдХрд░реНрдг рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реЛрддреА рд╣реИ, рдЕрдкреНрд░рднрд╛рд╡реА рд╣реЛ рдЬрд╛рддреА рд╣реИред рдЗрд╕рдореЗрдВ рдХреБрдЫ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдХреЛ рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдХрд░рдиреЗ рдХреА рдЕрд╕рдорд░реНрдерддрд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬреИрд╕реЗ `AppleHWAccess.kext`ред рдЗрд╕ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, SIP рдХреЗ рдирд┐рдпрдВрддреНрд░рдг рддрдВрддреНрд░ рдХреЗ рдмрд╛рд╣рд░ рд╣реЛрдиреЗ рдХреЗ рдХрд╛рд░рдг, рдпрд╣ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реИрдо рдореЗрдВ рдЕрдирдзрд┐рдХреГрдд рдкрдврд╝рдиреЗ рдФрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдкрд╣реБрдВрдЪ рдорд┐рд▓ рд╕рдХрддреА рд╣реИред

#### [SIP рд╕реБрд░рдХреНрд╖рд┐рдд рдлрд╝реЛрд▓реНрдбрд░реНрд╕ рдкрд░ рдорд╛рдЙрдВрдЯ рдХрд░реЗрдВ](https://www.slideshare.net/i0n1c/syscan360-stefan-esser-os-x-el-capitan-sinking-the-ship)

**SIP рд╕реБрд░рдХреНрд╖рд┐рдд рдлрд╝реЛрд▓реНрдбрд░реНрд╕ рдкрд░ рдПрдХ рдирдИ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдорд╛рдЙрдВрдЯ рдХрд░рдирд╛ рд╕рдВрд░рдХреНрд╖рдг рдХреЛ рдЫрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╡ рдерд╛ред**
```bash
mkdir evil
# Add contento to the folder
hdiutil create -srcfolder evil evil.dmg
hdiutil attach -mountpoint /System/Library/Snadbox/ evil.dmg
```
#### [рдЕрдкрдЧреНрд░реЗрдбрд░ рдмрд╛рдпрдкрд╛рд╕ (2016)](https://objective-see.org/blog/blog\_0x14.html)

рд╕рд┐рд╕реНрдЯрдо рдХреЛ `Install macOS Sierra.app` рдХреЗ рднреАрддрд░ рд╕реНрдерд╛рдкрд┐рдд рдЗрдВрд╕реНрдЯреЙрд▓рд░ рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬ рд╕реЗ рдмреВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддрд╛рдХрд┐ рдУрдПрд╕ рдЕрдкрдЧреНрд░реЗрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, `bless` рдпреВрдЯрд┐рд▓рд┐рдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдПред рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдХрдорд╛рдВрдб рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ:
```bash
/usr/sbin/bless -setBoot -folder /Volumes/Macintosh HD/macOS Install Data -bootefi /Volumes/Macintosh HD/macOS Install Data/boot.efi -options config="\macOS Install Data\com.apple.Boot" -label macOS Installer
```
рдпрджрд┐ рдХреЛрдИ рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдЧреНрд░реЗрдб рдЗрдореЗрдЬ (`InstallESD.dmg`) рдХреЛ рдмреВрдЯ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдмрджрд▓ рджреЗрддрд╛ рд╣реИ, рддреЛ рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдХрдордЬреЛрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд░рдгрдиреАрддрд┐ рдПрдХ рджреБрд╖реНрдЯ рд╕рдВрд╕реНрдХрд░рдг (`libBaseIA.dylib`) рдХреЗ рд╕рд╛рде рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд▓реЛрдбрд░ (dyld) рдХреЛ рдмрджрд▓рдХрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред рдЗрд╕ рдкрд░рд┐рд╡рд░реНрддрди рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЛрдб рдХрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЗрдВрд╕реНрдЯреЙрд▓рд░ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рд╣рдорд▓рд╛рд╡рд░ рдХреЛрдб рдЕрдкрдЧреНрд░
```bash
csrutil authenticated-root status
Authenticated Root status: enabled
```
рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рд╕реНрдиреИрдкрд╢реЙрдЯ рдбрд┐рд╕реНрдХ рднреА **рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп** рд░реВрдк рдореЗрдВ рдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```
mount
/dev/disk3s1s1 on / (apfs, sealed, local, read-only, journaled)
```
<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
