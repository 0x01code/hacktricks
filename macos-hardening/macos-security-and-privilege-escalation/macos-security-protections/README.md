# macOS рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд░рдХреНрд╖рд╛

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **PR рдЬрдорд╛ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## рдЧреЗрдЯрдХреАрдкрд░

рдЧреЗрдЯрдХреАрдкрд░ рдЖрдо рддреМрд░ рдкрд░ **рдХреНрд╡рд╛рд░рдВрдЯрд╛рдЗрди + рдЧреЗрдЯрдХреАрдкрд░ + рдПрдХреНрд╕рдкреНрд░реЛрдЯреЗрдХреНрдЯ** рдХрд╛ рд╕рдВрдпреЛрдЬрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ macOS рд╕реБрд░рдХреНрд╖рд╛ рдореЙрдбреНрдпреВрд▓ рд╣реИрдВ рдЬреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рдЧрдП рд╕рдВрднрд╛рд╡рд┐рдд рд╣рд╛рдирд┐рдХрд╛рд░рдХ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдХреЛ рдирд┐рд╖реЗрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВрдЧреЗ**ред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА:

{% content-ref url="macos-gatekeeper.md" %}
[macos-gatekeeper.md](macos-gatekeeper.md)
{% endcontent-ref %}

## рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реАрдорд╛рдПрдВ

### SIP - рд╕рд┐рд╕реНрдЯрдо рдЕрдЦрдВрдбрддрд╛ рд╕реБрд░рдХреНрд╖рд╛

{% content-ref url="macos-sip.md" %}
[macos-sip.md](macos-sip.md)
{% endcontent-ref %}

### рд╕реИрдВрдбрдмреЙрдХреНрд╕

MacOS рд╕реИрдВрдбрдмреЙрдХреНрд╕ **рдРрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рд╕реАрдорд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ** рдЬреЛ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдЪрд▓ рд░рд╣рд╛ рд╣реИред рдЗрд╕рд╕реЗ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛрддрд╛ рд╣реИ рдХрд┐ **рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗрд╡рд▓ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рд╣реА рдкрд╣реБрдВрдЪреЗрдЧрд╛**ред

{% content-ref url="macos-sandbox/" %}
[macos-sandbox](macos-sandbox/)
{% endcontent-ref %}

### TCC - **рдкрд╛рд░рджрд░реНрд╢рд┐рддрд╛, рд╕рд╣рдорддрд┐ рдФрд░ рдирд┐рдпрдВрддреНрд░рдг**

**TCC (рдкрд╛рд░рджрд░реНрд╢рд┐рддрд╛, рд╕рд╣рдорддрд┐ рдФрд░ рдирд┐рдпрдВрддреНрд░рдг)** рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдврд╛рдВрдЪрд╛ рд╣реИред рдпрд╣ **рдРрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдирдХреЗ рдкрд╣реБрдВрдЪ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдХреЗред рдЗрд╕рдореЗрдВ рд▓реЛрдХреЗрд╢рди рд╕реЗрд╡рд╛рдПрдВ, рд╕рдВрдкрд░реНрдХ, рдлреЛрдЯреЛ, рдорд╛рдЗрдХреНрд░реЛрдлреЛрди, рдХреИрдорд░рд╛, рдкрд╣реБрдВрдЪрдиреАрдпрддрд╛ рдФрд░ рдкреВрд░реНрдг рдбрд┐рд╕реНрдХ рдкрд╣реБрдВрдЪ рдЬреИрд╕реЗ рддрддреНрд╡ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред TCC рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдРрдкреНрд╕ рдХреЗрд╡рд▓ рдЗрди рд╕реБрд╡рд┐рдзрд╛рдУрдВ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рдЙрдиреНрд╣реЛрдВрдиреЗ рд╕реНрдкрд╖реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рд╣рдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдХреА рд╣реЛ, рдЗрд╕рд╕реЗ рдирд┐рдЬрддрд╛ рдФрд░ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдбреЗрдЯрд╛ рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рдордЬрдмреВрдд рд╣реЛрддрд╛ рд╣реИред

{% content-ref url="macos-tcc/" %}
[macos-tcc](macos-tcc/)
{% endcontent-ref %}

### рд▓реЙрдиреНрдЪ/рдкрд░реНрдпрд╛рд╡рд░рдг рд╕реАрдорд╛рдПрдВ рдФрд░ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреИрд╢

macOS рдореЗрдВ рд▓реЙрдиреНрдЪ рд╕реАрдорд╛рдПрдВ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛ рд╣реИ рдЬреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдиреЗ рдХрд╛ рдирд┐рдпрдорд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ, рдЬрд┐рд╕рдореЗрдВ **рдХреМрди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд╕рдХрддрд╛ рд╣реИ**, **рдХреИрд╕реЗ**, рдФрд░ **рдХрд╣рд╛рдБ рд╕реЗ** рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдХреЗред macOS Ventura рдореЗрдВ рдкреЗрд╢ рдХрд┐рдП рдЧрдП, рдпреЗ рд╕рд┐рд╕реНрдЯрдо рдмрд╛рдЗрдирд░реА рдХреЛ рдПрдХ **рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреИрд╢** рдХреЗ рднреАрддрд░ рд░реЛрдЧрдг рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдореЗрдВ рд╡рд░реНрдЧреАрдХреГрдд рдХрд░рддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ рдирд┐рд╖реНрдкрд╛рджрдиреАрдп рдмрд╛рдЗрдирд░реА рдХреЗ рд▓рд┐рдП рдЙрд╕рдХреЗ **рд▓реЙрдиреНрдЪ** рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ **рдирд┐рдпрдо** рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдЗрд╕рдХреЗ **рд╕реНрд╡рдпрдВ**, **рдорд╛рддрд╛-рдкрд┐рддрд╛**, рдФрд░ **рдЬрд┐рдореНрдореЗрджрд╛рд░** рд╕реАрдорд╛рдПрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред macOS Sonoma рдореЗрдВ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдРрдкреНрд╕ рдХреЗ рд▓рд┐рдП **рдкрд░реНрдпрд╛рд╡рд░рдг** рд╕реАрдорд╛рдПрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд┐рдП рдЧрдП, рдпреЗ рд╕реБрд╡рд┐рдзрд╛рдПрдВ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдиреЗ рдХреА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдХреЗ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рд┐рд╕реНрдЯрдо рд╢реЛрд╖рдгреЛрдВ рдХреЛ рдХрдо рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИрдВред

{% content-ref url="macos-launch-environment-constraints.md" %}
[macos-launch-environment-constraints.md](macos-launch-environment-constraints.md)
{% endcontent-ref %}

## MRT - рдореИрд▓рд╡реЗрдпрд░ рд╣рдЯрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЯреВрд▓

рдореИрд▓рд╡реЗрдпрд░ рд╣рдЯрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЯреВрд▓ (MRT) macOS рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдврд╛рдВрдЪрд╛ рдХрд╛ рдПрдХ рдФрд░ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред рдЬреИрд╕рд╛ рдХрд┐ рдирд╛рдо рд╕реБрдЭрд╛рддрд╛ рд╣реИ, MRT рдХрд╛ рдореБрдЦреНрдп рдХрд╛рд░реНрдп рд╣реИ **рдкреНрд░рд╢реНрдирд┐рдд рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рдЬреНрдЮрд╛рдд рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рд╣рдЯрд╛рдирд╛**ред

рдЬрдм рдХрд┐рд╕реА рдореИрдХ рдкрд░ рдореИрд▓рд╡реЗрдпрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдпрд╛ рддреЛ XProtect рджреНрд╡рд╛рд░рд╛ рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рддрд░реАрдХреЗ рд╕реЗ), рддреЛ MRT рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ **рд╣рдЯрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред MRT рдкрд┐рдЫрд▓реЗ рдкреНрд▓рд╛рди рдореЗрдВ рдЪреБрдкрдЪрд╛рдк рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рд╛рдорд╛рдиреНрдпрдд: рдЬрдм рд╕рд┐рд╕реНрдЯрдо рдЕрдкрдбреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╛ рдЬрдм рдПрдХ рдирдпрд╛ рдореИрд▓рд╡реЗрдпрд░ рдкрд░рд┐рднрд╛рд╖рд╛ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИ (рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ MRT рдХреЗ рдирд┐рдпрдо рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВ, рд╡реЗ рдмрд╛рдЗрдирд░реА рдХреЗ рднреАрддрд░ рд╣реИрдВ)ред

рдЬрдмрдХрд┐ XProtect рдФрд░ MRT рджреЛрдиреЛрдВ macOS рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИрдВ, рд╡реЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВ:

* **XProtect** рдПрдХ рдирд┐рд╡рд╛рд░рдХ рдЙрдкрдХрд░рдг рд╣реИред рдпрд╣ **рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ рд╣реА рд╡реЗ рдбрд╛рдЙрдирд▓реЛрдб рд╣реЛрддреА рд╣реИрдВ** (рдХреБрдЫ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ), рдФрд░ рдпрджрд┐ рдпрд╣ рдХрд┐рд╕реА рднреА рдЬреНрдЮрд╛рдд рдкреНрд░рдХрд╛рд░ рдХреЗ рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ **рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЦреЛрд▓рдиреЗ рд╕реЗ рд░реЛрдХрддрд╛ рд╣реИ**, рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рд╣реА рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрддрд╛ рд╣реИред
* **MRT**, рджреВрд╕рд░реА рдУрд░, рдПрдХ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рддреНрдордХ рдЙрдкрдХрд░рдг** рд╣реИред рдпрд╣ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдореИрд▓рд╡реЗрдпрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рдмрд╛рдж рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рджреЛрд╖реА рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЛ рд╣рдЯрд╛рдХрд░ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╕рд╛рдл рдХрд░рдирд╛ рд╣реИред

MRT рдПрдкреНрд▓рд┐рдХреЗрд╢рди **`/Library/Apple/System/Library/CoreServices/MRT.app`** рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред

## рдкреГрд╖реНрдарднреВрдорд┐ рдХрд╛рд░реНрдп рдкреНрд░рдмрдВрдзрди

**macOS** рдЕрдм рд╣рд░ рдмрд╛рд░ **рдЪреЗрддрд╛рд╡рдиреА рджреЗрддрд╛ рд╣реИ** рдЬрдм рднреА рдХреЛрдИ рдЯреВрд▓ рдПрдХ рдкреНрд░рд╕рд┐рджреНрдз **рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдХреЛрдб рдирд┐рд╖реНрдард╛рдВрддрд░рдг рдХреЗ рд▓рд┐рдП** (рдЬреИрд╕реЗ рд▓реЙрдЧрд┐рди рдЖрдЗрдЯрдо, рдбреЗрдорди...), рддрд╛рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдмреЗрд╣рддрд░ рдкрддрд╛ рдЪрд▓реЗ **рдХреМрди рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕реНрдерд┐рд░ рд░рдЦ рд░рд╣рд╛ рд╣реИ**ред

<figure><img src="../../../.gitbook/assets/image (711).png" alt=""><figcaption></figcaption></figure>

рдпрд╣ рдПрдХ **рдбреЗрдорди** рдореЗрдВ рдЪрд▓рддрд╛ рд╣реИ рдЬреЛ `/System/Library/PrivateFrameworks/BackgroundTaskManagement.framework/Versions/A/Resources/backgroundtaskmanagementd` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ рдФрд░ **рдПрдЬреЗрдВрдЯ** `/System/Library/PrivateFrameworks/BackgroundTaskManagement.framework/Support/BackgroundTaskManagementAgent.app` рдореЗрдВ рд╣реИред

**`backgroundtaskmanagementd`** рдХреЛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ рд╕реНрдерд╛рдпреА рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдХреБрдЫ рд╕реНрдерд╛рдкрд┐рдд рд╣реИ рдХреИрд╕реЗ **FSEvents рдкреНрд░рд╛рдкреНрдд рдХрд░рдХреЗ** рдФрд░ рдЙрдирдХреЗ рд▓рд┐рдП рдХреБрдЫ **рд╣реИрдВрдбрд▓рд░** рдмрдирд╛рдХрд░ред

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдПрдХ plist рдлрд╝рд╛рдЗрд▓ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдкреНрдкрд▓ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдП рдЧрдП **рдкреНрд░рд╕рд┐рджреНрдз рдРрдкреНрд▓рд┐рдХреЗрд╢рди** рд╣реИрдВ рдЬреЛ рдирд┐рд░рдВрддрд░ рдмрдиреЗ рд░рд╣рддреЗ рд╣реИрдВ рдЬреЛ рд╕реНрдерд┐рдд рд╣реИ: `/System/Library/PrivateFrameworks/BackgroundTaskManagement.framework/Versions/A/Resources/attributions.plist`
```json
[...]
"us.zoom.ZoomDaemon" => {
"AssociatedBundleIdentifiers" => [
0 => "us.zoom.xos"
]
"Attribution" => "Zoom"
"Program" => "/Library/PrivilegedHelperTools/us.zoom.ZoomDaemon"
"ProgramArguments" => [
0 => "/Library/PrivilegedHelperTools/us.zoom.ZoomDaemon"
]
"TeamIdentifier" => "BJ4HAAB9B3"
}
[...]
```
### рдЬрд╛рдВрдЪ

рдЖрдк Apple cli рдЙрдкрдХрд░рдг рдЪрд▓рд╛ рдХрд░ рд╕рднреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рдкреГрд╖реНрдарднреВрдорд┐ рдЖрдЗрдЯрдо рдХреЛ **рдЬрд╛рдВрдЪрдирд╛** рд╕рдВрднрд╡ рд╣реИ:
```bash
# The tool will always ask for the users password
sfltool dumpbtm
```
рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ [**DumpBTM**](https://github.com/objective-see/DumpBTM) рдХреЗ рд╕рд╛рде рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред
```bash
# You need to grant the Terminal Full Disk Access for this to work
chmod +x dumpBTM
xattr -rc dumpBTM # Remove quarantine attr
./dumpBTM
```
рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА **`/private/var/db/com.apple.backgroundtaskmanagement/BackgroundItems-v4.btm`** рдореЗрдВ рд╕реНрдЯреЛрд░ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИ рдФрд░ рдЯрд░реНрдорд┐рдирд▓ рдХреЛ FDA рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

### BTM рдХреЗ рд╕рд╛рде рдЦрд┐рд▓рд╡рд╛рдбрд╝

рдЬрдм рдПрдХ рдирдИ рд╕реНрдерд╛рдпрд┐рддреНрд╡ рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рдПрдХ рдкреНрд░рдХрд╛рд░ рдХреА рдШрдЯрдирд╛ рд╣реЛрддреА рд╣реИ **`ES_EVENT_TYPE_NOTIFY_BTM_LAUNCH_ITEM_ADD`**ред рдЗрд╕рд▓рд┐рдП, рдЗрд╕ **рдШрдЯрдирд╛** рдХреЛ рднреЗрдЬрдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ **рдПрдЬреЗрдВрдЯ** рдХреЛ рд░реЛрдХрдиреЗ рдХрд╛ рдХреЛрдИ рддрд░реАрдХрд╛ рдПрдЯреИрдХрд░ рдХреЛ BTM рдХреЛ _**рдмрд╛рдпрдкрд╛рд╕**_ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛ред

* **рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рдирд╛**: рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдЪрд▓рд╛рдиреЗ рд╕реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рд░реАрд╕реЗрдЯ рд╣реЛ рдЬрд╛рдПрдЧрд╛ (рдЗрд╕реЗ рдореВрд▓ рд╕реЗ рдкреБрдирдГ рдирд┐рд░реНрдорд╛рдг рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП), рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ, рдЗрд╕рдХреЗ рдмрд╛рдж рдЗрд╕реЗ рдЪрд▓рд╛рдиреЗ рдХреЗ рдмрд╛рдж **рдХреЛрдИ рдирдИ рд╕реНрдерд╛рдпрд┐рддреНрд╡ рд╕реВрдЪрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬрдм рддрдХ рд╕рд┐рд╕реНрдЯрдо рдкреБрдирд░рд╛рд░рдВрдн рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ**ред
* **рд░реВрдЯ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред
```bash
# Reset the database
sfltool resettbtm
```
* **рдПрдЬреЗрдВрдЯ рдХреЛ рд░реЛрдХреЗрдВ**: рдПрдЬреЗрдВрдЯ рдХреЛ рд░реЛрдХрдирд╛ рд╕рдВрднрд╡ рд╣реИ рддрд╛рдХрд┐ рдЬрдм рдирдИ рдкрд╣рдЪрд╛рдиреЗрдВ рдорд┐рд▓рддреА рд╣реИрдВ рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╕реВрдЪрд┐рдд рди рдХрд░реЗрдВред
```bash
# Get PID
pgrep BackgroundTaskManagementAgent
1011

# Stop it
kill -SIGSTOP 1011

# Check it's stopped (a T means it's stopped)
ps -o state 1011
T
```
* **рдмрдЧ**: рдЕрдЧрд░ **рдкрд░рд┐рд╕реНрдерд┐рддрд┐ рдХреЛ рдмрдирд╛рдиреЗ рд╡рд╛рд▓реА рдкреНрд░рдХреНрд░рд┐рдпрд╛** рддреБрд░рдВрдд рдЙрд╕рдХреЗ рдмрд╛рдж рдореЗрдВ рдореМрдЬреВрдж рд╣реЛрддреА рд╣реИ, рддреЛ рдбреЗрдорди рдЙрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ **рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛, **рд╡рд┐рдлрд▓** рд╣реЛ рдЬрд╛рдПрдЧрд╛, рдФрд░ **рдирдпреА рдЪреАрдЬ рдХреЛ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдмрдирд╛ рд░рд╣реЗ рд╣реИрдВ** рдЗрд╕ рдШрдЯрдирд╛ рдХреЛ рднреЗрдЬрдиреЗ рдореЗрдВ **рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдЧрд╛**ред

BTM рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдВрджрд░реНрдн рдФрд░ **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**:

* [https://youtu.be/9hjUmT031tc?t=26481](https://youtu.be/9hjUmT031tc?t=26481)
* [https://www.patreon.com/posts/new-developer-77420730?l=fr](https://www.patreon.com/posts/new-developer-77420730?l=fr)
* [https://support.apple.com/en-gb/guide/deployment/depdca572563/web](https://support.apple.com/en-gb/guide/deployment/depdca572563/web)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВред

</details>
