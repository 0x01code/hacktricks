# macOS рд▓реЙрдиреНрдЪ/рд╡рд╛рддрд╛рд╡рд░рдг рдкреНрд░рддрд┐рдмрдВрдз

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХрд▓ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ**
*
* .

</details>

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

macOS рдореЗрдВ рд▓реЙрдиреНрдЪ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╣реИ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХреИрд╕реЗ, рдХреМрди рдФрд░ рдХрд╣рд╛рдВ рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдврд╝рд╛рдирд╛ред macOS Ventura рдореЗрдВ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдХрд┐рдП рдЧрдП рдЗрди рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдиреЗ **рдкреНрд░рддреНрдпреЗрдХ рд╕рд┐рд╕реНрдЯрдо рдмрд╛рдЗрдирд░реА рдХреЛ рдЕрд▓рдЧ рдкреНрд░рддрд┐рдмрдВрдз рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдореЗрдВ рд╡рд░реНрдЧреАрдХреГрдд** рдХрд┐рдпрд╛ рд╣реИ, рдЬреЛ **рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреИрд╢** рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рд╕рд┐рд╕реНрдЯрдо рдмрд╛рдЗрдирд░реА рдФрд░ рдЙрдирдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрд╢ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред рдпреЗ рдкреНрд░рддрд┐рдмрдВрдз рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╣рд░ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдмрд╛рдЗрдирд░реА рддрдХ рдлреИрд▓рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдмрд╛рдЗрдирд░реА рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ **рдирд┐рдпрдо** рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред рдпреЗ рдирд┐рдпрдо рд╕реНрд╡рдпрдВ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рд╕рдВрддреБрд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрддреЗ рд╣реИрдВ, рдЬреЛ рдПрдХ рдмрд╛рдЗрдирд░реА рдХреЛ рдкреВрд░рд╛ рдХрд░рдирд╛ рд╣реЛрддрд╛ рд╣реИ, рдорд╛рддрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рдФрд░ рдЕрдиреНрдп рд╕рдВрдмрдВрдзрд┐рдд рд╕рдВрд╕реНрдерд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдкрд╛рд▓рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВред

рдЗрд╕ рддрдВрддреНрд░ рдХреЛ macOS Sonoma рд╕реЗ рд╢реБрд░реВ рд╣реЛрдХрд░ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдРрдкреНрд╕ рддрдХ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдЙрдирдХреЗ рдРрдкреНрд╕ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ **рдкрд░реНрдпрд╛рд╡рд░рдг рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдХреБрдВрдЬреА рдФрд░ рдорд╛рди рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА** рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

рдЖрдк **рд▓реЙрдиреНрдЪ рдкрд░реНрдпрд╛рд╡рд░рдг рдФрд░ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ** рдХреЛ рдкреНрд░рддрд┐рдмрдВрдз рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдирд┐рдпрдореЛрдВ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдпрд╛ рддреЛ **`launchd` рдкреНрд░реЙрдкрд░реНрдЯреА рд╕реВрдЪреА рдлрд╝рд╛рдЗрд▓реЛрдВ** рдореЗрдВ рд╕рд╣реЗрдЬрддреЗ рд╣реИрдВ, рдпрд╛ рдХреЛрдб рд╕рд╛рдЗрдирд┐рдВрдЧ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реА **рдЕрд▓рдЧ рдкреНрд░реЙрдкрд░реНрдЯреА рд╕реВрдЪреА** рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВред

4 рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреНрд░рддрд┐рдмрдВрдз рд╣реЛрддреЗ рд╣реИрдВ:

* **рд╕реНрд╡рдпрдВ рдкреНрд░рддрд┐рдмрдВрдз**: **рдЪрд▓ рд░рд╣реЗ** рдмрд╛рдЗрдирд░реА рдкрд░ рд▓рд╛рдЧреВ рдкреНрд░рддрд┐рдмрдВрдзред
* **рдорд╛рддрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛**: **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдорд╛рддрд╛** рдкрд░ рд▓рд╛рдЧреВ рдкреНрд░рддрд┐рдмрдВрдз (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **`launchd`** рдПрдХ XP рд╕реЗрд╡рд╛ рдЪрд▓рд╛ рд░рд╣рд╛ рд╣реИ)
* **рдЬрд┐рдореНрдореЗрджрд╛рд░ рдкреНрд░рддрд┐рдмрдВрдз**: **рд╕реЗрд╡рд╛ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдкреНрд░рдХреНрд░рд┐рдпрд╛** рдкрд░ рд▓рд╛рдЧреВ рдкреНрд░рддрд┐рдмрдВрдз
* **рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдкреНрд░рддрд┐рдмрдВрдз**: рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдкреНрд░рддрд┐рдмрдВрдз рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЛрдб рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХреЛрдб рдХрд╛ рд╡рд┐рд╡рд░рдг рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпреЛрдЧ рдХрд░реЗрдВ

рддреЛ рдЬрдм рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреВрд╕рд░реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреА рд╣реИ - `execve(_:_:_:)` рдпрд╛ `posix_spawn(_:_:_:_:_:_:)` рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ - рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдпрд╣ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ **рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓** рдлрд╝рд╛рдЗрд▓ рдЕрдкрдиреЗ **рд╕реНрд╡рдпрдВ рдкреНрд░рддрд┐рдмрдВрдз** рдХреЛ рдкреВрд░рд╛ рдХрд░рддреА рд╣реИред рдпрд╣ рднреА рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ **рдорд╛рддрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛** рдХрд╛ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдорд╛рддрд╛ рдкреНрд░рддрд┐рдмрдВрдз** рдХреЛ рдкреВрд░рд╛ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдХрд┐ **рдЬрд┐рдореНрдореЗрджрд╛рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛** рдХрд╛
```
Category 1:
Self Constraint: (on-authorized-authapfs-volume || on-system-volume) && launch-type == 1 && validation-category == 1
Parent Constraint: is-init-proc
```
* `(on-authorized-authapfs-volume || on-system-volume)`: рд╕рд┐рд╕реНрдЯрдо рдпрд╛ рдХреНрд░рд┐рдкрдЯреЗрдХреНрд╕ рд╡реЙрд▓реНрдпреВрдо рдореЗрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
* `launch-type == 1`: рд╕рд┐рд╕реНрдЯрдо рд╕реЗрд╡рд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рд▓реЙрдиреНрдЪрдбреЗрдордиреНрд╕ рдореЗрдВ рдкреНрд▓рд┐рд╕реНрдЯ)ред
* &#x20; `validation-category == 1`: рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рдПрдХреНрд╕реАрдХреНрдпреВрдЯреЗрдмрд▓ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
* `is-init-proc`: рд▓реЙрдиреНрдЪреНрдб

### LC рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдХреЛ рдЙрд▓рдЯрд╛ рдХрд░рдирд╛

рдЖрдкрдХреЗ рдкрд╛рд╕ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [**рдпрд╣рд╛рдВ**](https://theevilbit.github.io/posts/launch\_constraints\_deep\_dive/#reversing-constraints) рд╣реИ, рд▓реЗрдХрд┐рди рдореВрд▓ рд░реВрдк рд╕реЗ рд╡реЗ **AMFI (AppleMobileFileIntegrity)** рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ **рдХрд░реНрдирд▓ рдбреЗрд╡рд▓рдкрдореЗрдВрдЯ рдХрд┐рдЯ** рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рддрд╛рдХрд┐ рдЖрдк **KEXT** рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХреЗрдВред **`kConstraintCategory`** рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рддреАрдХреНрд╖рд╛рдкреВрд░реНрд╡рдХ рд╣реИрдВред рдЙрдиреНрд╣реЗрдВ рдирд┐рдХрд╛рд▓рдХрд░ рдЖрдкрдХреЛ рдПрдХ DER (ASN.1) рдХреЛрдбреЗрдб рд╕реНрдЯреНрд░реАрдо рдорд┐рд▓реЗрдЧреА рдЬрд┐рд╕реЗ рдЖрдкрдХреЛ [ASN.1 рдбрд┐рдХреЛрдбрд░](https://holtstrom.com/michael/tools/asn1decoder.php) рдпрд╛ python-asn1 рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдФрд░ рдЗрд╕рдХреЗ `dump.py` рд╕реНрдХреНрд░рд┐рдкреНрдЯ, [andrivet/python-asn1](https://github.com/andrivet/python-asn1/tree/master) рдХреЗ рд╕рд╛рде рдбрд┐рдХреЛрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рдЬреЛ рдЖрдкрдХреЛ рдПрдХ рдЕрдзрд┐рдХ рд╕рдордЭрдиреЗ рдпреЛрдЧреНрдп рд╕реНрдЯреНрд░рд┐рдВрдЧ рджреЗрдЧрд╛ред

## рд▓реЙрдиреНрдЪ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреА рдмрд╛рдзрд╛рдПрдБ

рдпреЗ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЧрдИ рд▓реЙрдиреНрдЪ рдкрд░реНрдпрд╛рд╡рд░рдг рдмрд╛рдзрд╛рдПрдБ рд╣реИрдВред рдбреЗрд╡рд▓рдкрд░ рдЕрдкрдиреЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдореЗрдВ рдПрдХреНрд╕реЗрд╕ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдореЗрдВ **рддрдереНрдп** рдФрд░ **
```bash
codesign -d -vvvv app.app
```
## рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреИрд╢

**macOS** рдореЗрдВ рдХреБрдЫ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреИрд╢ рд╣реЛрддреЗ рд╣реИрдВ:

* **`/System/Volumes/Preboot/*/boot/*/usr/standalone/firmware/FUD/BaseSystemTrustCache.img4`**
* **`/System/Volumes/Preboot/*/boot/*/usr/standalone/firmware/FUD/StaticTrustCache.img4`**
* **`/System/Library/Security/OSLaunchPolicyData`**

рдФрд░ iOS рдореЗрдВ рдРрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ **`/usr/standalone/firmware/FUD/StaticTrustCache.img4`** рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред

### рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреИрд╢реЛрдВ рдХреА рдЧрдгрдирд╛

рдкрд┐рдЫрд▓реЗ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреИрд╢ рдлрд╝рд╛рдЗрд▓реЗрдВ **IMG4** рдФрд░ **IM4P** рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╣реЛрддреА рд╣реИрдВ, рдЬрд╣рд╛рдВ IM4P рдПрдХ IMG4 рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдкреЗрд▓реЛрдб рдЕрдиреБрднрд╛рдЧ рд╣реЛрддрд╛ рд╣реИред

рдЖрдк [**pyimg4**](https://github.com/m1stadev/PyIMG4) рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдкреЗрд▓реЛрдб рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% code overflow="wrap" %}
```bash
# Installation
python3 -m pip install pyimg4

# Extract payloads data
cp /System/Volumes/Preboot/*/boot/*/usr/standalone/firmware/FUD/BaseSystemTrustCache.img4 /tmp
pyimg4 img4 extract -i /tmp/BaseSystemTrustCache.img4 -p /tmp/BaseSystemTrustCache.im4p
pyimg4 im4p extract -i /tmp/BaseSystemTrustCache.im4p -o /tmp/BaseSystemTrustCache.data

cp /System/Volumes/Preboot/*/boot/*/usr/standalone/firmware/FUD/StaticTrustCache.img4 /tmp
pyimg4 img4 extract -i /tmp/StaticTrustCache.img4 -p /tmp/StaticTrustCache.im4p
pyimg4 im4p extract -i /tmp/StaticTrustCache.im4p -o /tmp/StaticTrustCache.data

pyimg4 im4p extract -i /System/Library/Security/OSLaunchPolicyData -o /tmp/OSLaunchPolicyData.data
```
{% endcode %}

(рдПрдХ рд╡рд┐рдХрд▓реНрдк рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЖрдк рдЯреВрд▓ [**img4tool**](https://github.com/tihmstar/img4tool) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЬреЛ M1 рдореЗрдВ рдЪрд▓реЗрдЧрд╛, рдпрджрд┐ рд░рд┐рд▓реАрдЬ рдкреБрд░рд╛рдирд╛ рд╣реИ рдФрд░ x86\_64 рдХреЗ рд▓рд┐рдП рдпрджрд┐ рдЖрдк рдЗрд╕реЗ рд╕рд╣реА рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВ).

рдЕрдм рдЖрдк рдЯреВрд▓ [**trustcache**](https://github.com/CRKatri/trustcache) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрдардиреАрдп рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
# Install
wget https://github.com/CRKatri/trustcache/releases/download/v2.0/trustcache_macos_arm64
sudo mv ./trustcache_macos_arm64 /usr/local/bin/trustcache
xattr -rc /usr/local/bin/trustcache
chmod +x /usr/local/bin/trustcache

# Run
trustcache info /tmp/OSLaunchPolicyData.data | head
trustcache info /tmp/StaticTrustCache.data | head
trustcache info /tmp/BaseSystemTrustCache.data | head

version = 2
uuid = 35EB5284-FD1E-4A5A-9EFB-4F79402BA6C0
entry count = 969
0065fc3204c9f0765049b82022e4aa5b44f3a9c8 [none] [2] [1]
00aab02b28f99a5da9b267910177c09a9bf488a2 [none] [2] [1]
0186a480beeee93050c6c4699520706729b63eff [none] [2] [2]
0191be4c08426793ff3658ee59138e70441fc98a [none] [2] [3]
01b57a71112235fc6241194058cea5c2c7be3eb1 [none] [2] [2]
01e6934cb8833314ea29640c3f633d740fc187f2 [none] [2] [2]
020bf8c388deaef2740d98223f3d2238b08bab56 [none] [2] [3]
```
рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреИрд╢ рдХрд╛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдкрд╛рд▓рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП **LC рд╢реНрд░реЗрдгреА 4 рд╡реЗрдВ рд╕реНрддрдВрдн** рд╣реЛрддреА рд╣реИред
```c
struct trust_cache_entry2 {
uint8_t cdhash[CS_CDHASH_LEN];
uint8_t hash_type;
uint8_t flags;
uint8_t constraintCategory;
uint8_t reserved0;
} __attribute__((__packed__));
```
рддреЛ, рдЖрдк рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП [**рдЗрд╕ рддрд░рд╣ рдХрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ**](https://gist.github.com/xpn/66dc3597acd48a4c31f5f77c3cc62f30) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЙрд╕ рдбреЗрдЯрд╛ рд╕реЗ рдЖрдк **`0` рдХреЗ рд▓реЙрдиреНрдЪ рд╕реАрдорд╛рдУрдВ рдХреЗ рд╕рд╛рде рдРрдкреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рдЬреЛ рдРрд╕реЗ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рд╕реАрдорд┐рдд рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ ([**рдпрд╣рд╛рдВ рдЬрд╛рдВрдЪреЗрдВ**](https://gist.github.com/LinusHenze/4cd5d7ef057a144cda7234e2c247c056) рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдорд╛рди рдХреНрдпрд╛ рд╣реИ)ред

## рд╣рдорд▓рд╛ рдирд┐рд╡рд╛рд░рдг

рд▓реЙрдиреНрдЪ рдХрдВрд╕реНрдЯреНрд░реЗрдВрдЯреНрд╕ рдиреЗ рдХрдИ рдкреБрд░рд╛рдиреЗ рд╣рдорд▓реЛрдВ рдХреЛ рдирд┐рд╡рд╛рд░рдг рдХрд┐рдпрд╛ рд╣реИ рдЬреЛ **рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдирд╣реАрдВ рдЪрд▓рд╛рдИ рдЬрд╛рдПрдЧреА:** рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕реНрдерд╛рдиреЛрдВ рд╕реЗ рдпрд╛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдорд╛рддрд╛-рдкрд┐рддрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдЖрд╣реНрд╡рд╛рдирд┐рдд рд╣реЛрдиреЗ рд╕реЗ (рдпрджрд┐ рдХреЗрд╡рд▓ рд▓реЙрдиреНрдЪрдбреА рд╣реА рдЗрд╕реЗ рд▓реЙрдиреНрдЪ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдерд╛)

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд▓реЙрдиреНрдЪ рдХрдВрд╕реНрдЯреНрд░реЗрдВрдЯреНрд╕ рдиреЗ **рдбрд╛рдЙрдирдЧреНрд░реЗрдб рд╣рдорд▓реЛрдВ рдХреЛ рднреА рдирд┐рд╡рд╛рд░рдг рдХрд┐рдпрд╛ рд╣реИ**ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ **рд╕рд╛рдорд╛рдиреНрдп XPC** рджреБрд░реБрдкрдпреЛрдЧ, **рдЗрд▓реЗрдХреНрдЯреНрд░реЙрди** рдХреЛрдб рдЗрдВрдЬреЗрдХреНрд╢рди рдпрд╛ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕рддреНрдпрд╛рдкрди рдХреЗ рдмрд┐рдирд╛ **рдбрд╛рдпрд▓рд┐рдм рдЗрдВрдЬреЗрдХреНрд╢рди** рдХреЛ рдирд┐рд╡рд╛рд░рдг рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ (рдЬрдм рддрдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓реЛрдб рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЯреАрдо рдЖрдИрдбреА рдкрддрд╛ рдирд╣реАрдВ рд╣реЛ)ред

### XPC рдбреЗрдорди рд╕реБрд░рдХреНрд╖рд╛

рдЗрд╕ рд▓реЗрдЦ рд▓рд┐рдЦрдиреЗ рдХреЗ рд╕рдордп (рд╕реЛрдиреЛрдорд╛ рд░рд┐рд▓реАрдЬ) рдореЗрдВ **рдбреЗрдорди XPC рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛** рдЬреБрдбрд╝реЗ рдЧреНрд░рд╛рд╣рдХ рдХреА рдмрдЬрд╛рдп рдЦреБрдж рдбреЗрдорди XPC рд╕реЗрд╡рд╛ рд╣реЛрддреА рд╣реИред (рдЬрдорд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ FB: FB13206884)ред рдПрдХ рд╕реЗрдХрдВрдб рдХреЗ рд▓рд┐рдП рдорд╛рди рд▓реЗрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдПрдХ рдмрдЧ рд╣реИ, рд╣рдо рдлрд┐рд░ рднреА **рд╣рдорд╛рд░реЗ рд╣рдорд▓реЗ рдХреЛ рдЪрд╛рд▓реВ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ**, рд▓реЗрдХрд┐рди рдпрджрд┐ рдпрд╣ **рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рдХреНрд░рд┐рдп рд╣реИ** (рд╢рд╛рдпрдж рдХреНрдпреЛрдВрдХрд┐ рдореВрд▓ рдРрдк рдиреЗ рдЗрд╕реЗ рдЖрд╣реНрд╡рд╛рдирд┐рдд рдХрд┐рдпрд╛ рдерд╛), рддреЛ рд╣рдореЗрдВ рдЗрд╕рд╕реЗ **рдЬреБрдбрд╝рдиреЗ рд╕реЗ рдХреБрдЫ рдирд╣реАрдВ рд░реЛрдХ рд╕рдХрддрд╛** рд╣реИред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рд╕реАрдорд╛ рд╕реЗрдЯ рдХрд░рдирд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдЪрд╛рд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рд╣рдорд▓реЗ рдХрд╛ рд╕рдордп-рд╕реАрдорд╛ рд╕реАрдорд┐рдд рдХрд░реЗрдЧрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рдореБрдЦреНрдп рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рд╣рдорд╛рд░реА XPC рд╕реЗрд╡рд╛ рдХреЛ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЬреБрдбрд╝реЗ рдЧреНрд░рд╛рд╣рдХ рдХреА рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред рдпрд╣ рдЕрднреА рднреА рдЗрд╕реА рддрд░рд╣ рдХрд╛рдо рдХрд░рдиреЗ рдХрд╛ рдПрдХрдорд╛рддреНрд░ рддрд░реАрдХрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдЕрднреА рднреА рдЗрд╕реА рддрд░рд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред

### рдЗрд▓реЗрдХреНрдЯреНрд░реЙрди рд╕реБрд░рдХреНрд╖рд╛

рдпрджрд┐ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдХрд┐ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ **рд▓реЙрдиреНрдЪ рд╕рд░реНрд╡рд┐рд╕ рджреНрд╡рд╛рд░рд╛ рдЦреЛрд▓рдирд╛** рд╣реЛрддрд╛ рд╣реИ (рдорд╛рддрд╛-рдкрд┐рддрд╛ рдХреА рд╕реАрдорд╛рдУрдВ рдореЗрдВ)ред рдЗрд╕реЗ **`open`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ (рдЬреЛ env variables рд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ) рдпрд╛ **рд▓реЙрдиреНрдЪ рд╕рд░реНрд╡рд┐рд╕реЗрдЬ рдПрдкреАрдЖрдИ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ (рдЬрд╣рд╛рдВ env variables рджрд░реНрд╢рд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ) рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## рд╕рдВрджрд░реНрдн

* [https://youtu.be/f1HA5QhLQ7Y?t=24146](https://youtu.be/f1HA5QhLQ7Y?t=24146)
* [https://theevilbit.github.io/posts/launch\_constraints\_deep\_dive/](https://theevilbit.github.io/posts/launch\_constraints\_deep\_dive/)
* [https://eclecticlight.co/2023/06/13/why-wont-a-system-app-or-command-tool-run-launch-constraints-and-trust-caches/](https://eclecticlight.co/2023/06/13/why-wont-a-system-app-or-command-tool-run-launch-constraints-and-trust-caches/)
* [https://developer.apple.com/videos/play/wwdc2023/10266/](https://developer.apple.com/videos/play/wwdc2023/10266/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ**
*
* .

</details>
