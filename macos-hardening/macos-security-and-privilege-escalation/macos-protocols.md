# macOS рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛рдПрдВ рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓

<details>

<summary><strong> AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ </strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**.
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ.

</details>

## рд░рд┐рдореЛрдЯ рдПрдХреНрд╕реЗрд╕ рд╕реЗрд╡рд╛рдПрдВ

рдпреЗ macOS рдХреА рд╕рд╛рдорд╛рдиреНрдп рд╕реЗрд╡рд╛рдПрдВ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рджреВрд░рд╕реНрде рд░реВрдк рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЖрдк рдЗрди рд╕реЗрд╡рд╛рдУрдВ рдХреЛ `System Settings` --> `Sharing` рдореЗрдВ рд╕рдХреНрд╖рдо/рдЕрдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ

* **VNC**, рдЬрд┐рд╕реЗ тАЬScreen SharingтАЭ рдХреЗ рдирд╛рдо рд╕реЗ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ (tcp:5900)
* **SSH**, рдЬрд┐рд╕реЗ тАЬRemote LoginтАЭ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ (tcp:22)
* **Apple Remote Desktop** (ARD), рдпрд╛ тАЬRemote ManagementтАЭ (tcp:3283, tcp:5900)
* **AppleEvent**, рдЬрд┐рд╕реЗ тАЬRemote Apple EventтАЭ рдХреЗ рдирд╛рдо рд╕реЗ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ (tcp:3031)

рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреЛрдИ рднреА рд╕рдХреНрд╖рдо рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд▓рд╛рдПрдВ:
```bash
rmMgmt=$(netstat -na | grep LISTEN | grep tcp46 | grep "*.3283" | wc -l);
scrShrng=$(netstat -na | grep LISTEN | egrep 'tcp4|tcp6' | grep "*.5900" | wc -l);
flShrng=$(netstat -na | grep LISTEN | egrep 'tcp4|tcp6' | egrep "\*.88|\*.445|\*.548" | wc -l);
rLgn=$(netstat -na | grep LISTEN | egrep 'tcp4|tcp6' | grep "*.22" | wc -l);
rAE=$(netstat -na | grep LISTEN | egrep 'tcp4|tcp6' | grep "*.3031" | wc -l);
bmM=$(netstat -na | grep LISTEN | egrep 'tcp4|tcp6' | grep "*.4488" | wc -l);
printf "\nThe following services are OFF if '0', or ON otherwise:\nScreen Sharing: %s\nFile Sharing: %s\nRemote Login: %s\nRemote Mgmt: %s\nRemote Apple Events: %s\nBack to My Mac: %s\n\n" "$scrShrng" "$flShrng" "$rLgn" "$rmMgmt" "$rAE" "$bmM";
```
### ARD рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ

(рдпрд╣ рднрд╛рдЧ [**рдЗрд╕ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**](https://lockboxx.blogspot.com/2019/07/macos-red-teaming-206-ard-apple-remote.html))

рдпрд╣ рдореВрд▓ рд░реВрдк рд╕реЗ рдПрдХ рд╡рд┐рдХреГрдд [VNC](https://en.wikipedia.org/wiki/Virtual\_Network\_Computing) рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХреБрдЫ **рдЕрддрд┐рд░рд┐рдХреНрдд macOS рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реБрд╡рд┐рдзрд╛рдПрдБ** рд╣реИрдВред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, **рд╕реНрдХреНрд░реАрди рд╢реЗрдпрд░рд┐рдВрдЧ рд╡рд┐рдХрд▓реНрдк** рдПрдХ **рдореВрд▓ VNC** рд╕рд░реНрд╡рд░ рд╣реИред рдПрдХ рдЙрдиреНрдирдд ARD рдпрд╛ рд░рд┐рдореЛрдЯ рдореИрдиреЗрдЬрдореЗрдВрдЯ рд╡рд┐рдХрд▓реНрдк рднреА рд╣реИ рдЬреЛ **рдХрдВрдЯреНрд░реЛрд▓ рд╕реНрдХреНрд░реАрди рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ ARD рдХреЛ VNC рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдкреАрдЫреЗ рдХреА рдУрд░ **рд╕рдВрдЧрдд** рдмрдирд╛рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╡рд┐рдзрд┐ рдореЗрдВ рдПрдХ рдХрдордЬреЛрд░реА рд╣реИ рдЬреЛ рдЗрд╕ **рдкрд╛рд╕рд╡рд░реНрдб** рдХреЛ рдПрдХ **8 рдЕрдХреНрд╖рд░ рдСрде рдмрдлрд░** рддрдХ **рд╕реАрдорд┐рдд** рдХрд░ рджреЗрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЗрд╕реЗ [Hydra](https://thudinh.blogspot.com/2017/09/brute-forcing-passwords-with-thc-hydra.html) рдпрд╛ [GoRedShell](https://github.com/ahhh/GoRedShell/) рдЬреИрд╕реЗ рдЯреВрд▓ рдХреЗ рд╕рд╛рде рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд░рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ (рдФрд░ рдореВрд▓ рд░реВрдк рд╕реЗ **рдХреЛрдИ рд░реЗрдЯ рд▓рд┐рдорд┐рдЯ рдирд╣реАрдВ рд╣реЛрддреА**).\
рдЖрдк **nmap** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рд╕реНрдХреНрд░реАрди рд╢реЗрдпрд░рд┐рдВрдЧ** рдпрд╛ рд░рд┐рдореЛрдЯ рдореИрдиреЗрдЬрдореЗрдВрдЯ рдХреЗ **рдХрдордЬреЛрд░ рдЙрджрд╛рд╣рд░рдгреЛрдВ** рдХреА рдкрд╣рдЪрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╕реНрдХреНрд░рд┐рдкреНрдЯ `vnc-info` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдФрд░ рдЕрдЧрд░ рд╕реЗрд╡рд╛ `VNC Authentication (2)` рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреА рд╣реИ рддреЛ рд╡реЗ рд╕рдВрднрд╡рддрдГ **рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдХрдордЬреЛрд░** рд╣реЛрддреЗ рд╣реИрдВред рд╕реЗрд╡рд╛ рд╕рднреА рдкрд╛рд╕рд╡рд░реНрдбреЛрдВ рдХреЛ рддрд╛рд░ рдкрд░ рднреЗрдЬреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ 8 рдЕрдХреНрд╖рд░реЛрдВ рддрдХ рд╕реАрдорд┐рдд рдХрд░ рджреЗрдЧреА, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдпрджрд┐ рдЖрдк VNC рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ "password" рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ "passwords" рдФрд░ "password123" рджреЛрдиреЛрдВ рдкреНрд░рдорд╛рдгрд┐рдд рд╣реЛрдВрдЧреЗред

<figure><img src="../../.gitbook/assets/image (9) (3).png" alt=""><figcaption></figcaption></figure>

рдпрджрд┐ рдЖрдк рдЗрд╕реЗ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдПрд╕реНрдХреЗрд▓реЗрд╢рди (TCC рдкреНрд░реЙрдореНрдкреНрдЯреНрд╕ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ), GUI рдХреЗ рд╕рд╛рде рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рд╕реВрд╕реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕реЗ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ:

{% code overflow="wrap" %}
```bash
sudo /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -activate -configure -allowAccessFor -allUsers -privs -all -clientopts -setmenuextra -menuextra yes
```
{% endcode %}

рдЖрдк **рдирд┐рд░реАрдХреНрд╖рдг** рдореЛрдб, **рд╕рд╛рдЭрд╛ рдирд┐рдпрдВрддреНрд░рдг**, рдФрд░ **рдкреВрд░реНрдг рдирд┐рдпрдВрддреНрд░рдг** рдХреЗ рдмреАрдЪ рд╕реНрд╡рд┐рдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд░ рдЬрд╛рд╕реВрд╕реА рдХрд░рдиреЗ рд╕реЗ рд▓реЗрдХрд░ рдЙрдирдХреЗ рдбреЗрд╕реНрдХрдЯреЙрдк рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рдХрд░рдиреЗ рддрдХ рдПрдХ рдмрдЯрди рдХреЗ рдХреНрд▓рд┐рдХ рдкрд░ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ рдЖрдкрдХреЛ ARD рд╕рддреНрд░ рддрдХ рдкрд╣реБрдБрдЪ рдорд┐рд▓ рдЬрд╛рддреА рд╣реИ, рддреЛ рд╡рд╣ рд╕рддреНрд░ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рддрдХ рдЦреБрд▓рд╛ рд░рд╣реЗрдЧрд╛, рднрд▓реЗ рд╣реА рд╕рддреНрд░ рдХреЗ рджреМрд░рд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдмрджрд▓ рдЬрд╛рдПред

рдЖрдк ARD рдХреЗ рдЬрд░рд┐рдП **рд╕реАрдзреЗ unix рдХрдорд╛рдВрдбреНрд╕ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рдпрджрд┐ рдЖрдк рдПрдХ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╣реИрдВ рддреЛ рдЪреАрдЬреЛрдВ рдХреЛ рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд░реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рдЗрд╕ unix рдХрдорд╛рдВрдб рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдордп рдкрд░ рджреВрд░рд╕реНрде рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕рдордп рдкрд░ рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ (рд▓рдХреНрд╖реНрдп рд╕рд░реНрд╡рд░ рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрдиреЗ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрдЬрд╛рдп)ред рдЕрдВрдд рдореЗрдВ, рджреВрд░рд╕реНрде Spotlight рдореЗрд░реА рдкрд╕рдВрджреАрджрд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЕрдЪреНрдЫрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк рддреЗрдЬреА рд╕реЗ рдФрд░ рджреВрд░рд╕реНрде рд░реВрдк рд╕реЗ рдХрдо рдкреНрд░рднрд╛рд╡, рд╕реВрдЪреАрдмрджреНрдз рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдлрд╛рдЗрд▓реЛрдВ рдХреА рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП рд╕реЛрдирд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рддреЗрдЬ рд╣реИ, рдЖрдкрдХреЛ рдПрдХ рд╕рд╛рде рдХрдИ рдорд╢реАрдиреЛрдВ рдкрд░ рдЦреЛрдЬреЗрдВ рдЪрд▓рд╛рдиреЗ рджреЗрддрд╛ рд╣реИ, рдФрд░ CPU рдХреЛ рд╕реНрдкрд╛рдЗрдХ рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред

## Bonjour Protocol

**Bonjour** рдПрдХ Apple-рдбрд┐рдЬрд╝рд╛рдЗрди рдХреА рдЧрдИ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдФрд░ **рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдПрдХ рд╣реА рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рд╕реНрдерд┐рдд рд╣реЛрдиреЗ рдкрд░ рдЕрдиреНрдп рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдФрд░ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдмрдирд╛рддреА рд╣реИ**ред рдЗрд╕реЗ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рднреА Bonjour-рдЬрд╛рдЧрд░реВрдХ рдЙрдкрдХрд░рдг рдХреЛ TCP/IP рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдкреНрд▓рдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдпрд╣ **рдПрдХ IP рдкрддрд╛ рдЪреБрдиреЗрдЧрд╛** рдФрд░ рдЙрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдЕрдиреНрдп рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдХреЛ **рдЙрд╕рдХреА рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдЧрд░реВрдХ рдХрд░реЗрдЧрд╛**ред Bonjour рдХреЛ рдХрднреА-рдХрднреА Rendezvous, **Zero Configuration**, рдпрд╛ Zeroconf рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред\
Zero Configuration Networking, рдЬреИрд╕реЗ рдХрд┐ Bonjour рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:

* рдПрдХ **IP рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рднрд▓реЗ рд╣реА DHCP рд╕рд░реНрд╡рд░ рди рд╣реЛ)
* рдирд╛рдо-рд╕реЗ-рдкрддрд╛ рдЕрдиреБрд╡рд╛рдж рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рднрд▓реЗ рд╣реА DNS рд╕рд░реНрд╡рд░ рди рд╣реЛ)
* рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ **рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП

рдЙрдкрдХрд░рдг рдХреЛ **169.254/16 рд░реЗрдВрдЬ рдореЗрдВ рдПрдХ IP рдкрддрд╛ рдорд┐рд▓реЗрдЧрд╛** рдФрд░ рдпрд╣ рдЬрд╛рдВрдЪреЗрдЧрд╛ рдХрд┐ рдХреЛрдИ рдЕрдиреНрдп рдЙрдкрдХрд░рдг рдЙрд╕ IP рдкрддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рд╡рд╣ IP рдкрддрд╛ рд░рдЦреЗрдЧрд╛ред Macs рдЗрд╕ рд╕рдмрдиреЗрдЯ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рд░реВрдЯрд┐рдВрдЧ рдЯреЗрдмрд▓ рдореЗрдВ рдПрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рд░рдЦрддреЗ рд╣реИрдВ: `netstat -rn | grep 169`

DNS рдХреЗ рд▓рд┐рдП **Multicast DNS (mDNS) рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред [**mDNS** **рд╕реЗрд╡рд╛рдПрдВ** рдкреЛрд░реНрдЯ **5353/UDP** рдкрд░ рд╕реБрдирддреА рд╣реИрдВ](../../network-services-pentesting/5353-udp-multicast-dns-mdns.md), **рдирд┐рдпрдорд┐рдд DNS рдкреНрд░рд╢реНрдиреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВ рдФрд░ рдПрдХ IP рдкрддреЗ рдкрд░ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреЗ рдмрдЬрд╛рдп **рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдкрддреЗ 224.0.0.251** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВред рдЗрди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╕реБрдирдиреЗ рд╡рд╛рд▓реА рдХреЛрдИ рднреА рдорд╢реАрди рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдЧреА, рдЖрдорддреМрд░ рдкрд░ рдПрдХ рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдкрддреЗ рдкрд░, рддрд╛рдХрд┐ рд╕рднреА рдЙрдкрдХрд░рдг рдЕрдкрдиреА рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░ рд╕рдХреЗрдВред\
рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдХрд░рдг рдиреЗрдЯрд╡рд░реНрдХ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдкрд░ рдЕрдкрдирд╛ рдирд╛рдо **рдЪреБрдиреЗрдЧрд╛**, рдЙрдкрдХрд░рдг рдПрдХ рдирд╛рдо рдЪреБрдиреЗрдЧрд╛ рдЬреЛ **.local рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ** (рдпрд╣ рд╣реЛрд╕реНрдЯрдирд╛рдо рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдПрдХ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдПрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред

**рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП DNS Service Discovery (DNS-SD)** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

Zero Configuration Networking рдХреА рдЕрдВрддрд┐рдо рдЖрд╡рд╢реНрдпрдХрддрд╛ **DNS Service Discovery (DNS-SD)** рджреНрд╡рд╛рд░рд╛ рдкреВрд░реА рдХреА рдЬрд╛рддреА рд╣реИред DNS Service Discovery DNS SRV рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХреЗ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ, рд▓реЗрдХрд┐рди рдпрджрд┐ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛрд╕реНрдЯ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рд╕реЗрд╡рд╛ рдХреА рдкреЗрд╢рдХрд╢ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдХрдИ рдкрд░рд┐рдгрд╛рдо рд╡рд╛рдкрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **DNS PTR рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ**ред рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ `<Service>.<Domain>` рдХреЗ рдирд╛рдо рдХреЗ рд▓рд┐рдП PTR рд▓реБрдХрдЕрдк рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ рдФрд░ **рд╢реВрдиреНрдп рдпрд╛ рдЕрдзрд┐рдХ PTR рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХреА рдПрдХ рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ** рдЬреЛ `<Instance>.<Service>.<Domain>` рдХреЗ рд░реВрдк рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВред

`dns-sd` рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ **рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдХрд░рдиреЗ рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд▓реБрдХрдЕрдк рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```bash
#Search ssh services
dns-sd -B _ssh._tcp

Browsing for _ssh._tcp
DATE: ---Tue 27 Jul 2021---
12:23:20.361  ...STARTING...
Timestamp     A/R    Flags  if Domain               Service Type         Instance Name
12:23:20.362  Add        3   1 local.               _ssh._tcp.           M-C02C934RMD6R
12:23:20.362  Add        3  10 local.               _ssh._tcp.           M-C02C934RMD6R
12:23:20.362  Add        2  16 local.               _ssh._tcp.           M-C02C934RMD6R
```

```bash
#Announce HTTP service
dns-sd -R "Index" _http._tcp . 80 path=/index.html

#Search HTTP services
dns-sd -B _http._tcp
```
рдЬрдм рдПрдХ рдирдИ рд╕реЗрд╡рд╛ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ, рддреЛ **рдирдИ рд╕реЗрд╡рд╛ рдЕрдкрдиреА рдЙрдкрд╕реНрдерд┐рддрд┐ рд╕рдмрдиреЗрдЯ рдкрд░ рд╕рднреА рдХреЛ рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдХрд░рддреА рд╣реИ**ред рд╢реНрд░реЛрддрд╛ рдХреЛ рдкреВрдЫрдирд╛ рдирд╣реАрдВ рдкрдбрд╝рд╛; рдЙрд╕реЗ рдХреЗрд╡рд▓ рд╕реБрдирдирд╛ рдерд╛ред

рдЖрдк рдЕрдкрдиреЗ рд╡рд░реНрддрдорд╛рди рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ **рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рд╕реЗрд╡рд╛рдУрдВ** рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП [**рдЗрд╕ рдЙрдкрдХрд░рдг**](https://apps.apple.com/us/app/discovery-dns-sd-browser/id1381004916?mt=12) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдпрд╛ рдЖрдк [**python-zeroconf**](https://github.com/jstasiak/python-zeroconf) рдХреЗ рд╕рд╛рде рдЕрдкрдиреА рдЦреБрдж рдХреА рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдкрд╛рдпрдерди рдореЗрдВ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ:
```python
from zeroconf import ServiceBrowser, Zeroconf


class MyListener:

def remove_service(self, zeroconf, type, name):
print("Service %s removed" % (name,))

def add_service(self, zeroconf, type, name):
info = zeroconf.get_service_info(type, name)
print("Service %s added, service info: %s" % (name, info))


zeroconf = Zeroconf()
listener = MyListener()
browser = ServiceBrowser(zeroconf, "_http._tcp.local.", listener)
try:
input("Press enter to exit...\n\n")
finally:
zeroconf.close()
```
рдпрджрд┐ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ Bonjour **disabled** рд╣реЛрдиреЗ рдкрд░ рдЕрдзрд┐рдХ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рд╕рд╛рде рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
sudo launchctl unload -w /System/Library/LaunchDaemons/com.apple.mDNSResponder.plist
```
## рд╕рдВрджрд░реНрдн

* [**The Mac Hacker's Handbook**](https://www.amazon.com/-/es/Charlie-Miller-ebook-dp-B004U7MUMU/dp/B004U7MUMU/ref=mt\_other?\_encoding=UTF8\&me=\&qid=)
* [**https://taomm.org/vol1/analysis.html**](https://taomm.org/vol1/analysis.html)
* [**https://lockboxx.blogspot.com/2019/07/macos-red-teaming-206-ard-apple-remote.html**](https://lockboxx.blogspot.com/2019/07/macos-red-teaming-206-ard-apple-remote.html)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
