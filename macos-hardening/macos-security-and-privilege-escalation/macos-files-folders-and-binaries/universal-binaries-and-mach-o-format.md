# macOS рдпреВрдирд┐рд╡рд░реНрд╕рд▓ рдмрд╛рдЗрдирд░реАрдЬ рдФрд░ Mach-O рдкреНрд░рд╛рд░реВрдк

<details>

<summary><strong>рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

Mac OS рдмрд╛рдЗрдирд░реАрдЬ рдЖрдо рддреМрд░ рдкрд░ **рдпреВрдирд┐рд╡рд░реНрд╕рд▓ рдмрд╛рдЗрдирд░реАрдЬ** рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрдореНрдкрд╛рдЗрд▓ рдХреА рдЬрд╛рддреА рд╣реИрдВред рдПрдХ **рдпреВрдирд┐рд╡рд░реНрд╕рд▓ рдмрд╛рдЗрдирд░реА** рдореЗрдВ **рдПрдХ рд╣реА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдХрдИ рд╡рд┐рд╢реНрд╡рдХрд░реНрдорд╛рдУрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред

рдпреЗ рдмрд╛рдЗрдирд░реАрдЬ **Mach-O рд╕рдВрд░рдЪрдирд╛** рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреА рд╣реИрдВ рдЬреЛ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реЗ рдмрдиреА рд╣реЛрддреА рд╣реИ:

* рд╣реЗрдбрд░
* рд▓реЛрдб рдХрдорд╛рдВрдбреНрд╕
* рдбреЗрдЯрд╛

![https://alexdremov.me/content/images/2022/10/6XLCD.gif](<../../../.gitbook/assets/image (467).png>)

## рдлреИрдЯ рд╣реЗрдбрд░

рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЦреЛрдЬреЗрдВ: `mdfind fat.h | grep -i mach-o | grep -E "fat.h$"`

<pre class="language-c"><code class="lang-c"><strong>#define FAT_MAGIC	0xcafebabe
</strong><strong>#define FAT_CIGAM	0xbebafeca	/* NXSwapLong(FAT_MAGIC) */
</strong>
struct fat_header {
<strong>	uint32_t	magic;		/* FAT_MAGIC or FAT_MAGIC_64 */
</strong><strong>	uint32_t	nfat_arch;	/* number of structs that follow */
</strong>};

struct fat_arch {
cpu_type_t	cputype;	/* cpu specifier (int) */
cpu_subtype_t	cpusubtype;	/* machine specifier (int) */
uint32_t	offset;		/* file offset to this object file */
uint32_t	size;		/* size of this object file */
uint32_t	align;		/* alignment as a power of 2 */
};
</code></pre>

рд╣реЗрдбрд░ рдореЗрдВ **рдореИрдЬрд┐рдХ** рдмрд╛рдЗрдЯреНрд╕ рд╣реЛрддреЗ рд╣реИрдВ рдЬрд┐рдирдХреЗ рдмрд╛рдж рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдореМрдЬреВрдж **рд╡рд┐рд╢реНрд╡рдХрд░реНрдореЛрдВ** рдХреА рд╕рдВрдЦреНрдпрд╛ (`nfat_arch`) рд╣реЛрддреА рд╣реИ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рд╡рд┐рд╢реНрд╡рдХрд░реНрдо рдХреЗ рдкрд╛рд╕ `fat_arch` рд╕рдВрд░рдЪрдирд╛ рд╣реЛрддреА рд╣реИред

рдЗрд╕реЗ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рджреЗрдЦреЗрдВ:

<pre class="language-shell-session"><code class="lang-shell-session">% file /bin/ls
/bin/ls: Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64e:Mach-O 64-bit executable arm64e]
/bin/ls (for architecture x86_64):	Mach-O 64-bit executable x86_64
/bin/ls (for architecture arm64e):	Mach-O 64-bit executable arm64e

% otool -f -v /bin/ls
Fat headers
fat_magic FAT_MAGIC
<strong>nfat_arch 2
</strong><strong>architecture x86_64
</strong>    cputype CPU_TYPE_X86_64
cpusubtype CPU_SUBTYPE_X86_64_ALL
capabilities 0x0
<strong>    offset 16384
</strong><strong>    size 72896
</strong>    align 2^14 (16384)
<strong>architecture arm64e
</strong>    cputype CPU_TYPE_ARM64
cpusubtype CPU_SUBTYPE_ARM64E
capabilities PTR_AUTH_VERSION USERSPACE 0
<strong>    offset 98304
</strong><strong>    size 88816
</strong>    align 2^14 (16384)
</code></pre>

рдпрд╛ [Mach-O View](https://sourceforge.net/projects/machoview/) рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ:

<figure><img src="../../../.gitbook/assets/image (1091).png" alt=""><figcaption></figcaption></figure>

рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рд╕реЛрдЪ рд░рд╣реЗ рд╣реЛрдВрдЧреЗ, рдЖрдо рддреМрд░ рдкрд░ 2 рд╡рд┐рд╢реНрд╡рдХрд░реНрдореЛрдВ рдХреЗ рд▓рд┐рдП рдХреЙрдореНрдкрд╛рдЗрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдпреВрдирд┐рд╡рд░реНрд╕рд▓ рдмрд╛рдЗрдирд░реА рдПрдХ рдХреЗрд╡рд▓ 1 рд╡рд┐рд╢реНрд╡рдХрд░реНрдо рдХреЗ рд▓рд┐рдП рдХреЙрдореНрдкрд╛рдЗрд▓ рдХрд┐рдП рдЧрдП рдмрд╛рдЗрдирд░реА рдХреЗ **рдЖрдХрд╛рд░ рдХреЛ рджреЛрдЧреБрдирд╛ рдХрд░ рджреЗрддрд╛ рд╣реИ**ред

## **Mach-O рд╣реЗрдбрд░**

рд╣реЗрдбрд░ рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИ, рдЬреИрд╕реЗ рдпрд╣ рдХрд┐рд╕реА Mach-O рдлрд╝рд╛рдЗрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдореИрдЬрд┐рдХ рдмрд╛рдЗрдЯреНрд╕ рдФрд░ рд▓рдХреНрд╖реНрдп рд╡рд┐рд╢реНрд╡рдХрд░реНрдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред рдЖрдк рдЗрд╕реЗ рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: `mdfind loader.h | grep -i mach-o | grep -E "loader.h$"`
```c
#define	MH_MAGIC	0xfeedface	/* the mach magic number */
#define MH_CIGAM	0xcefaedfe	/* NXSwapInt(MH_MAGIC) */
struct mach_header {
uint32_t	magic;		/* mach magic number identifier */
cpu_type_t	cputype;	/* cpu specifier (e.g. I386) */
cpu_subtype_t	cpusubtype;	/* machine specifier */
uint32_t	filetype;	/* type of file (usage and alignment for the file) */
uint32_t	ncmds;		/* number of load commands */
uint32_t	sizeofcmds;	/* the size of all the load commands */
uint32_t	flags;		/* flags */
};

#define MH_MAGIC_64 0xfeedfacf /* the 64-bit mach magic number */
#define MH_CIGAM_64 0xcffaedfe /* NXSwapInt(MH_MAGIC_64) */
struct mach_header_64 {
uint32_t	magic;		/* mach magic number identifier */
int32_t		cputype;	/* cpu specifier */
int32_t		cpusubtype;	/* machine specifier */
uint32_t	filetype;	/* type of file */
uint32_t	ncmds;		/* number of load commands */
uint32_t	sizeofcmds;	/* the size of all the load commands */
uint32_t	flags;		/* flags */
uint32_t	reserved;	/* reserved */
};
```
### Mach-O рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдХрд╛рд░

рд╡рд┐рднрд┐рдиреНрди рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдХрд╛рд░ рд╣реИрдВ, рдЖрдк рдЙрдиреНрд╣реЗрдВ [**рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдБ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ**](https://opensource.apple.com/source/xnu/xnu-2050.18.24/EXTERNAL\_HEADERS/mach-o/loader.h). рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* `MH_OBJECT`: рд╕реНрдерд╛рдирд╛рдВрддрд░рдгреАрдп рдСрдмреНрдЬреЗрдХреНрдЯ рдлрд╝рд╛рдЗрд▓ (рдХреЙрдореНрдкрд╛рдЗрд▓реЗрд╢рди рдХреЗ рдмреАрдЪ рдХреЗ рдЙрддреНрдкрд╛рдж, рдЕрднреА рддрдХ рдХреНрд░рд┐рдпрд╛рд╢реАрд▓ рдирд╣реАрдВ).
* `MH_EXECUTE`: рдХреНрд░рд┐рдпрд╛рд╢реАрд▓ рдлрд╝рд╛рдЗрд▓реЗрдВред
* `MH_FVMLIB`: рд╕реНрдерд┐рд░ VM рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдлрд╝рд╛рдЗрд▓ред
* `MH_CORE`: рдХреЛрдб рдбрдВрдкреНрд╕
* `MH_PRELOAD`: рдкреВрд░реНрд╡-рд▓реЛрдб рдХреНрд░рд┐рдпрд╛рд╢реАрд▓ рдлрд╝рд╛рдЗрд▓ (рдЕрдм XNU рдореЗрдВ рд╕рдорд░реНрдерд┐рдд рдирд╣реАрдВ)
* `MH_DYLIB`: рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬрд╝
* `MH_DYLINKER`: рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд┐рдВрдХрд░
* `MH_BUNDLE`: "рдкреНрд▓рдЧрдЗрди рдлрд╝рд╛рдЗрд▓реЗрдВ". -bundle рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ gcc рдореЗрдВ рдЙрддреНрдкрдиреНрди рдХреА рдЧрдИ рдФрд░ `NSBundle` рдпрд╛ `dlopen` рджреНрд╡рд╛рд░рд╛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рд▓реЛрдб рдХреА рдЧрдИред
* `MH_DYSM`: рд╕рд╣рд╛рдпрдХ `.dSym` рдлрд╝рд╛рдЗрд▓ (рдбреАрдмрдЧрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓)ред
* `MH_KEXT_BUNDLE`: рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ред
```bash
# Checking the mac header of a binary
otool -arch arm64e -hv /bin/ls
Mach header
magic  cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
MH_MAGIC_64    ARM64          E USR00     EXECUTE    19       1728   NOUNDEFS DYLDLINK TWOLEVEL PIE
```
рдпрд╛ [Mach-O View](https://sourceforge.net/projects/machoview/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

<figure><img src="../../../.gitbook/assets/image (1130).png" alt=""><figcaption></figcaption></figure>

## **Mach-O рдзреНрд╡рдЬ**

рд╕реНрд░реЛрдд рдХреЛрдб рднреА рдХрдИ рдзреНрд╡рдЬреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИрдВ:

* `MH_NOUNDEFS`: рдХреЛрдИ рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд рд╕рдВрджрд░реНрдн рдирд╣реАрдВ (рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд▓рд┐рдВрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛)
* `MH_DYLDLINK`: Dyld рд▓рд┐рдВрдХрд┐рдВрдЧ
* `MH_PREBOUND`: рдбрд╛рдпрдирд╛рдорд┐рдХ рд╕рдВрджрд░реНрдн рдкреВрд░реНрд╡рдмрдВрдзрд┐рддред
* `MH_SPLIT_SEGS`: рдлрд╝рд╛рдЗрд▓ рдЖрд░ / рдУ рдФрд░ рдЖрд░ / рдбрдмреНрд▓реНрдпреВ рд╕реЗрдЧрдореЗрдВрдЯ рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреА рд╣реИред
* `MH_WEAK_DEFINES`: рдмрд╛рдЗрдирд░реА рдореЗрдВ рдХрдордЬреЛрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдкреНрд░рддреАрдХ рд╣реИрдВ
* `MH_BINDS_TO_WEAK`: рдмрд╛рдЗрдирд░реА рдХрдордЬреЛрд░ рдкреНрд░рддреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ
* `MH_ALLOW_STACK_EXECUTION`: рд╕реНрдЯреИрдХ рдХреЛ рдХреНрд░рд┐рдпрд╛рд╢реАрд▓ рдмрдирд╛рдПрдВ
* `MH_NO_REEXPORTED_DYLIBS`: рдкреБрд╕реНрддрдХрд╛рд▓рдп LC\_REEXPORT рдХрдорд╛рдВрдб рдирд╣реАрдВ
* `MH_PIE`: рд╕реНрдерд╛рдиреАрдп рд╕реНрд╡рддрдВрддреНрд░ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓
* `MH_HAS_TLV_DESCRIPTORS`: рдзрд╛рдЧреЗ рд╕реЗ рдзрд╛рдЧреЗ рд╕реНрдерд╛рдиреАрдп рдЪрд░ рдкреНрд░рд╛рдкреНрдд рд╣реИрдВ
* `MH_NO_HEAP_EXECUTION`: рд╣реАрдк / рдбреЗрдЯрд╛ рдкреГрд╖реНрдареЛрдВ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдирд╣реАрдВ
* `MH_HAS_OBJC`: рдмрд╛рдЗрдирд░реА рдореЗрдВ рдСрдмреНрдЬреЗрдХреНрдЯ-рд╕реА рдЦрдВрдб рд╣реИрдВ
* `MH_SIM_SUPPORT`: рд╕рд┐рдореНрдпреБрд▓реЗрдЯрд░ рд╕рдорд░реНрдерди
* `MH_DYLIB_IN_CACHE`: рд╕рд╛рдЭрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреИрд╢ рдореЗрдВ рдбрд╛рдпрд▓рд┐рдмреНрд╕ / рдлреНрд░реЗрдорд╡рд░реНрдХ рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## **Mach-O рд▓реЛрдб рдХрдорд╛рдВрдбреНрд╕**

**рдлрд╝рд╛рдЗрд▓ рдХрд╛ рд▓реЗрдЖрдЙрдЯ рдореЗрдореЛрд░реА рдореЗрдВ** рдпрд╣рд╛рдБ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдореБрдЦреНрдп рдзрд╛рдЧреЗ рдХреА рд╕реНрдерд╛рдирд┐рдХреА, рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдкреНрд░рд╛рд░рдВрдн рдкрд░ рдореБрдЦреНрдп рдзрд╛рдЧреЗ рдХрд╛ рд╕рдВрджрд░реНрдн, рдФрд░ рдЖрд╡рд╢реНрдпрдХ **рд╕рд╛рдЭрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдп**ред рдирд┐рд░реНрджреЗрд╢ рджрд┐рдП рдЧрдП рд╣реИрдВ рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓реЛрдбрд░ **(dyld)** рдХреЛ рдореЗрдореЛрд░реА рдореЗрдВ рдмрд╛рдЗрдирд░реА рдХреЗ рд▓реЛрдбрд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрд░ред

рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ **load\_command** рд╕рдВрд░рдЪрдирд╛, рдЬреЛ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд **`loader.h`** рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```objectivec
struct load_command {
uint32_t cmd;           /* type of load command */
uint32_t cmdsize;       /* total size of command in bytes */
};
```
рд╡реНрдпрд╡рд╕реНрдерд╛ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓реЛрдб рдХрдорд╛рдВрдб рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕рдВрднрд╛рд▓рддреА рд╣реИред рд╕рдмрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рд▓реЛрдб рдХрдорд╛рдВрдб рд╣реИрдВ: `LC_SEGMENT_64`, `LC_LOAD_DYLINKER`, `LC_MAIN`, `LC_LOAD_DYLIB`, рдФрд░ `LC_CODE_SIGNATURE`ред

### **LC\_SEGMENT/LC\_SEGMENT\_64**

{% hint style="success" %}
рдореВрд▓ рд░реВрдк рд╕реЗ, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓реЛрдб рдХрдорд╛рдВрдб **рдХреИрд╕реЗ \_\_TEXT** (рдХрд╛рд░реНрдпрд╛рддреНрдордХ рдХреЛрдб) **рдФрд░ \_\_DATA** (рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛) **рд╕реЗрдЧрдореЗрдВрдЯ** рдХреЛ **рдбреЗрдЯрд╛ рд╕реЗрдХреНрд╢рди рдореЗрдВ рджрд┐рдЦрд╛рдП рдЧрдП рдСрдлрд╕реЗрдЯ рдХреЗ рдЕрдиреБрд╕рд╛рд░** рдмрд╛рдЗрдирд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред
{% endhint %}

рдпреЗ рдХрдорд╛рдВрдб **рд╕реЗрдЧрдореЗрдВрдЯ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд** рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ **рд╡рд░реНрдЪреБрдЕрд▓ рдореЗрдореЛрд░реА рд╕реНрдкреЗрд╕** рдореЗрдВ **рдореИрдк** рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬрдм рдпрд╣ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИред

рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕реЗрдЧрдореЗрдВрдЯ рд╣реЛрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ **\_\_TEXT** рд╕реЗрдЧрдореЗрдВрдЯ, рдЬреЛ рдХрд┐рд╕реА рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдХрд╛рд░реНрдпрд╛рддреНрдордХ рдХреЛрдб рдХреЛ рдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ **\_\_DATA** рд╕реЗрдЧрдореЗрдВрдЯ, рдЬреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдбреЗрдЯрд╛ рдХреЛ рд╕рдореЗрддрддрд╛ рд╣реИред рдпреЗ **рд╕реЗрдЧрдореЗрдВрдЯ рдбреЗрдЯрд╛ рд╕реЗрдХреНрд╢рди рдореЗрдВ рд╕реНрдерд┐рдд** рд╣реЛрддреЗ рд╣реИрдВ Mach-O рдлрд╝рд╛рдЗрд▓ рдореЗрдВред

**рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрдЧрдореЗрдВрдЯ** рдХреЛ рдФрд░ рднреА рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдорд▓реНрдЯреАрдкрд▓ **рд╕реЗрдХреНрд╢рди** рдореЗрдВред **рд▓реЛрдб рдХрдорд╛рдВрдб рд╕рдВрд░рдЪрдирд╛** рдореЗрдВ **рдЬрд╛рдирдХрд╛рд░реА** рд╣реЛрддреА рд╣реИ **рдЗрди рд╕реЗрдХреНрд╢рдиреНрд╕** рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдкрдиреЗ рд╕рдВрдмрдВрдзрд┐рдд рд╕реЗрдЧрдореЗрдВрдЯ рдХреЗ рднреАрддрд░ред

рд╣реЗрдбрд░ рдореЗрдВ рдкрд╣рд▓реЗ рдЖрдкрдХреЛ **рд╕реЗрдЧрдореЗрдВрдЯ рд╣реЗрдбрд░** рдорд┐рд▓рддрд╛ рд╣реИ:

<pre class="language-c"><code class="lang-c">struct segment_command_64 { /* for 64-bit architectures */
uint32_t	cmd;		/* LC_SEGMENT_64 */
uint32_t	cmdsize;	/* includes sizeof section_64 structs */
char		segname[16];	/* segment name */
uint64_t	vmaddr;		/* memory address of this segment */
uint64_t	vmsize;		/* memory size of this segment */
uint64_t	fileoff;	/* file offset of this segment */
uint64_t	filesize;	/* amount to map from the file */
int32_t		maxprot;	/* maximum VM protection */
int32_t		initprot;	/* initial VM protection */
<strong>	uint32_t	nsects;		/* number of sections in segment */
</strong>	uint32_t	flags;		/* flags */
};
</code></pre>

рд╕реЗрдЧрдореЗрдВрдЯ рд╣реЗрдбрд░ рдХрд╛ рдЙрджрд╛рд╣рд░рдг:

<figure><img src="../../../.gitbook/assets/image (1123).png" alt=""><figcaption></figcaption></figure>

рдпрд╣ рд╣реЗрдбрд░ **рдЙрди рд╕реЗрдХреНрд╢рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдирдХреЗ рд╣реЗрдбрд░ рдЗрд╕рдХреЗ рдмрд╛рдж рджрд┐рдЦрд╛рдИ рджреЗрддреЗ рд╣реИрдВ**:
```c
struct section_64 { /* for 64-bit architectures */
char		sectname[16];	/* name of this section */
char		segname[16];	/* segment this section goes in */
uint64_t	addr;		/* memory address of this section */
uint64_t	size;		/* size in bytes of this section */
uint32_t	offset;		/* file offset of this section */
uint32_t	align;		/* section alignment (power of 2) */
uint32_t	reloff;		/* file offset of relocation entries */
uint32_t	nreloc;		/* number of relocation entries */
uint32_t	flags;		/* flags (section type and attributes)*/
uint32_t	reserved1;	/* reserved (for offset or index) */
uint32_t	reserved2;	/* reserved (for count or sizeof) */
uint32_t	reserved3;	/* reserved */
};
```
рдЙрджрд╛рд╣рд░рдг рдХрд╛ **рдЦрдВрдб рд╢реАрд░реНрд╖рдХ**:

<figure><img src="../../../.gitbook/assets/image (1105).png" alt=""><figcaption></figcaption></figure>

рдпрджрд┐ рдЖрдк **рдЦрдВрдб рдСрдлрд╕реЗрдЯ** (0x37DC) + **рдСрдлрд╕реЗрдЯ** рдЬреЛ **рдЖрд░реНрдХ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ**, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ `0x18000` рдЬреЛрдбрд╝реЗрдВ --> `0x37DC + 0x18000 = 0x1B7DC`

<figure><img src="../../../.gitbook/assets/image (698).png" alt=""><figcaption></figcaption></figure>

рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЖрдк **рдХрдорд╛рдВрдб рд▓рд╛рдЗрди** рд╕реЗ **рд╣реЗрдбрд░реНрд╕ рдЬрд╛рдирдХрд╛рд░реА** рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:
```bash
otool -lv /bin/ls
```
рдЗрд╕ cmd рджреНрд╡рд╛рд░рд╛ рд▓реЛрдб рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рд╛рдорд╛рдиреНрдп рд╕реЗрдЧрдореЗрдВрдЯ:

* **`__PAGEZERO`:** рдпрд╣ рдХрд░реНрдиреЗрд▓ рдХреЛ **рдкрддрд╛ рджреЗрддрд╛ рд╣реИ** рдХрд┐ **рдПрдбреНрд░реЗрд╕ рдЬреАрд░реЛ** рдХреЛ **рдкрдврд╝рд╛ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддрд╛, рд▓рд┐рдЦрд╛ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддрд╛, рдпрд╛ рдирд╣реАрдВ рдЪрд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛**ред рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ maxprot рдФрд░ minprot рдЪрд░ рдореВрд▓реНрдп рд╢реВрдиреНрдп рдкрд░ рд╕реЗрдЯ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЗрд╕ рдкреГрд╖реНрда рдкрд░ **рдХреЛрдИ рдкрдврд╝рдиреЗ-рд▓рд┐рдЦрдиреЗ-рдЪрд▓рд╛рдиреЗ рдХреЗ рдЕрдзрд┐рдХрд╛рд░ рди рд╣реЛрдВ**ред
* рдпрд╣ рдЖрд╡рдВрдЯрди NULL рдкреНрд╡рд╛рдЗрдВрдЯрд░ рдбрд┐рдлрд░реЗрдВрд╕ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЛ **рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ**ред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ XNU рдПрдХ рдХрдареЛрд░ рдкреЗрдЬ рдЬреАрд░реЛ рдХреЛ рдкреНрд░рдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдореЗрдореЛрд░реА рдХрд╛ рдкрд╣рд▓рд╛ рдкреЗрдЬ (рдХреЗрд╡рд▓ рдкрд╣рд▓рд╛) рдЕрдкреНрд░рд╛рдкреНрдп рд╣реИ (рдХреЗрд╡рд▓ i386 рдореЗрдВ)ред рдПрдХ рдмрд╛рдЗрдирд░реА рдЗрд╕ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдПрдХ рдЫреЛрдЯрд╛ \_\_PAGEZERO (рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ `-pagezero_size` рдХрд░рдХреЗ) рдкрд╣рд▓реЗ 4k рдХреЛ рдХрд╡рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдмрд╛рдХреА 32рдмрд┐рдЯ рдореЗрдореЛрд░реА рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рдХрд░реНрдиреЗрд▓ рдореЛрдб рдореЗрдВ рджреЛрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдПред
* **`__TEXT`**: **рдкрд╛рдареНрдпрдХреНрд░рд┐рдпрд╛рддреНрдордХ** **рдХреЛрдб** рдХреЛ **рдкрдврд╝рдиреЗ** рдФрд░ **рдЪрд▓рд╛рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ (рдХреЛрдИ рд▓реЗрдЦрдирдпреЛрдЧреНрдп рдирд╣реАрдВ)**ред** рдЗрд╕ рд╕реЗрдЧрдореЗрдВрдЯ рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рдЦрдВрдб:
* `__text`: рдХрдВрдкрд╛рдЗрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдмрд╛рдЗрдирд░реА рдХреЛрдб
* `__const`: рд╕реНрдерд┐рд░ рдбреЗрдЯрд╛ (рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП)
* `__[c/u/os_log]string`: C, рдпреВрдирд┐рдХреЛрдб рдпрд╛ os рд▓реЙрдЧ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╕реНрдерд┐рд░
* `__stubs` рдФрд░ `__stubs_helper`: рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓реЛрдбрд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рд╕рдВрд▓рдЧреНрди
* `__unwind_info`: рд╕реНрдЯреИрдХ рдЕрдирд╡рд╛рдЗрдВрдб рдбреЗрдЯрд╛ред
* рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рд╕рднреА рд╕рд╛рдордЧреНрд░реА рд╕рд╛рдЗрди рдХреА рдЧрдИ рд╣реИ рд▓реЗрдХрд┐рди рдЗрд╕реЗ рднреА рдЪрд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдЬреЛ рдЗрд╕ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЬреИрд╕реЗ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╕рдорд░реНрдкрд┐рдд рдЦрдВрдбреЛрдВ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдФрд░ рдЕрдзрд┐рдХ рд╡рд┐рдХрд▓реНрдк рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП)ред
* **`__DATA`**: рдбреЗрдЯрд╛ рдХреЛ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреЛ **рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп** рдФрд░ **рд▓реЗрдЦрдирдпреЛрдЧреНрдп** рд╣реИ (рдХреЛрдИ рдЪрд▓рд╛рдпрд╛ рдирд╣реАрдВ)**ред**
* `__got:` рдЧреНрд▓реЛрдмрд▓ рдСрдлрд╕реЗрдЯ рдЯреЗрдмрд▓
* `__nl_symbol_ptr`: рдЧреБрдгрдореБрдЦ (рд▓реЛрдб рдкрд░ рдмрд╛рдЗрдВрдб) рд╕рд┐рдореНрдмрд▓ рдкреЙрдЗрдВрдЯрд░
* `__la_symbol_ptr`: рдЖрд▓рд╕реА (рдЙрдкрдпреЛрдЧ рдкрд░ рдмрд╛рдЗрдВрдб) рд╕рд┐рдореНрдмрд▓ рдкреЙрдЗрдВрдЯрд░
* `__const`: рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп рдбреЗрдЯрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдирд╣реАрдВ)
* `__cfstring`: рдХреЛрд░ рдлрд╛рдЙрдВрдбреЗрд╢рди рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕
* `__data`: рдЧреНрд▓реЛрдмрд▓ рдЪрд░ (рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ)
* `__bss`: рд╕реНрдереИрддрд┐рдХ рдЪрд░ (рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ рдкреНрд░рд╛рд░рдВрдн рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ)
* `__objc_*` (\_\_objc\_classlist, \_\_objc\_protolist, рдЖрджрд┐): рд╡рд╕реНрддреБ-рд╕реА рд░рдирдЯрд╛рдЗрдо рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЧрдИ рдЬрд╛рдирдХрд╛рд░реА
* **`__DATA_CONST`**: \_\_DATA.\_\_const рдХреЛ рд╕реНрдерд┐рд░ рдирд╣реАрдВ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ (рд▓реЗрдЦрди рдЕрдиреБрдорддрд┐рдпрд╛рдБ), рди рд╣реА рдЕрдиреНрдп рдкреЙрдЗрдВрдЯрд░ рдФрд░ рдЧреЛрдЯред рдпрд╣ рдЦрдВрдб `__const`, рдХреБрдЫ рдкреНрд░рд╛рд░рдВрднрдХрд░реНрддрд╛рдУрдВ рдФрд░ рдЧреЛрдЯ рдЯреЗрдмрд▓ (рдПрдХ рдмрд╛рд░ рд╕реБрд▓рдЭрд╛рдпрд╛ рдЧрдпрд╛) рдХреЛ **рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп** рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП `mprotect` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
* **`__LINKEDIT`**: рд▓рд┐рдВрдХрд░ (рдбрд╛рдпрд▓реНрдб) рдХреЗ рд▓рд┐рдП рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреИрд╕реЗ, рд╕рд┐рдореНрдмрд▓, рд╕реНрдЯреНрд░рд┐рдВрдЧ, рдФрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рддрд╛рд▓рд┐рдХрд╛ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБред рдпрд╣ `__TEXT` рдпрд╛ `__DATA` рдореЗрдВ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЕрдиреНрдп рд▓реЛрдб рдХрдорд╛рдВрдб рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
* рдбрд╛рдпрд▓реНрдб рдЬрд╛рдирдХрд╛рд░реА: Rebase, Non-lazy/lazy/weak binding opcodes рдФрд░ export info
* рдлрд╝рдВрдХреНрд╢рди рд╢реБрд░реВ рд╣реЛрддреЗ рд╣реИрдВ: рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЗ рдкреНрд░рд╛рд░рдВрдн рдкрддреЛрдВ рдХреА рддрд╛рд▓рд┐рдХрд╛
* рдХреЛрдб рдореЗрдВ рдбреЗрдЯрд╛: \_\_text рдореЗрдВ рдбреЗрдЯрд╛ рдЖрдЗрд▓реИрдВрдбреНрд╕
* рд╕рд┐рдореНрдмрд▓ рдЯреЗрдмрд▓: рдмрд╛рдЗрдирд░реА рдореЗрдВ рд╕рд┐рдореНрдмрд▓реНрд╕
* рдЗрдВрдбрд╛рдпрд░реЗрдХреНрдЯ рд╕рд┐рдореНрдмрд▓ рдЯреЗрдмрд▓: рдкреЙрдЗрдВрдЯрд░/рд╕реНрдЯрдм рд╕рд┐рдореНрдмрд▓реНрд╕
* рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЯреЗрдмрд▓
* рдХреЛрдб рд╣рд╕реНрддрд╛рдХреНрд╖рд░
* **`__OBJC`**: рд╡рд╕реНрддреБ-рд╕реА рд░рдирдЯрд╛рдЗрдо рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА \_\_DATA рд╕реЗрдЧрдореЗрдВрдЯ рдореЗрдВ рднреА рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИ, рд╡рд┐рднрд┐рдиреНрди \_\_objc\_\* рдЦрдВрдбреЛрдВ рдореЗрдВред
* **`__RESTRICT`**: рдПрдХ рд╕реЗрдЧрдореЗрдВрдЯ рдЬрд┐рд╕рдореЗрдВ рд╕рд╛рдордЧреНрд░реА рдирд╣реАрдВ рд╣реИ рдФрд░ рдПрдХ рд╣реА рдЦрдВрдб рд╣реИ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо рд╣реИ **`__restrict`** (рднреА рдЦрд╛рд▓реА) рдЬреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдмрд╛рдЗрдирд░реА рдХреЛ рдЪрд▓рд╛рддреЗ рд╕рдордп, рдпрд╣ DYLD рдкрд░реНрдпрд╛рд╡рд░рдгреАрдп рдЪрд░реЛрдВ рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░реЗрдЧрд╛ред

рдЬреИрд╕рд╛ рдХрд┐ рдХреЛрдб рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрд╛, **рд╕реЗрдЧрдореЗрдВрдЯ рднреА рдзреНрд╡рдЬ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ** (рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╡реЗ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рд╣реЛрддреЗ):

* `SG_HIGHVM`: рдХреЗрд╡рд▓ рдХреЛрд░ (рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рд╣реЛрддрд╛)
* `SG_FVMLIB`: рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рд╣реЛрддрд╛
* `SG_NORELOC`: рд╕реЗрдЧрдореЗрдВрдЯ рдореЗрдВ рдХреЛрдИ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдирд╣реАрдВ рд╣реИ
* `SG_PROTECTED_VERSION_1`: рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рдиред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП Finder рджреНрд╡рд╛рд░рд╛ рдкрд╛рда `__TEXT` рд╕реЗрдЧрдореЗрдВрдЯ рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### **`LC_UNIXTHREAD/LC_MAIN`**

**`LC_MAIN`** рдореЗрдВ **entryoff рд╡рд┐рд╢реЗрд╖рддрд╛** рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рд╣реЛрддрд╛ рд╣реИред рд▓реЛрдб рд╕рдордп рдкрд░, **dyld** рдмрд╕ (рдореЗрдореЛрд░реА рдореЗрдВ) рдХреЗ **рдмреЗрд╕** рдореЗрдВ рдЗрд╕ рдорд╛рди рдХреЛ **рдЬреЛрдбрд╝рддрд╛** рд╣реИ, рдлрд┐рд░ рдЗрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдкрд░ рдЬрд╛рдХрд░ рдмрд╛рдЗрдирд░реА рдХреЛрдб рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдЙрдЫрд▓рддрд╛** рд╣реИред

**`LC_UNIXTHREAD`** рдореЗрдВ рдорд╛рди рд╣реЛрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдкреНрд░рдореБрдЦ рдзрд╛рдЧрд╛ рд╢реБрд░реВ рдХрд░рддреЗ рд╕рдордп рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдореЗрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкреНрд░рд╛рдпреЛрдЧрд┐рдХ рд╣реЛ рдЧрдпрд╛ рд╣реИ рд▓реЗрдХрд┐рди **`dyld`** рдЕрднреА рднреА рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рд╕рд╛рде рдЗрд╕ рджреНрд╡рд╛рд░рд╛ рд╕реЗрдЯ рдХрд┐рдП рдЧрдП рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдХреЗ рдорд╛рдиреЛрдВ рдХреЛ рджреЗрдЦрдирд╛ рд╕рдВрднрд╡ рд╣реИ:
```bash
otool -l /usr/lib/dyld
[...]
Load command 13
cmd LC_UNIXTHREAD
cmdsize 288
flavor ARM_THREAD_STATE64
count ARM_THREAD_STATE64_COUNT
x0  0x0000000000000000 x1  0x0000000000000000 x2  0x0000000000000000
x3  0x0000000000000000 x4  0x0000000000000000 x5  0x0000000000000000
x6  0x0000000000000000 x7  0x0000000000000000 x8  0x0000000000000000
x9  0x0000000000000000 x10 0x0000000000000000 x11 0x0000000000000000
x12 0x0000000000000000 x13 0x0000000000000000 x14 0x0000000000000000
x15 0x0000000000000000 x16 0x0000000000000000 x17 0x0000000000000000
x18 0x0000000000000000 x19 0x0000000000000000 x20 0x0000000000000000
x21 0x0000000000000000 x22 0x0000000000000000 x23 0x0000000000000000
x24 0x0000000000000000 x25 0x0000000000000000 x26 0x0000000000000000
x27 0x0000000000000000 x28 0x0000000000000000  fp 0x0000000000000000
lr 0x0000000000000000 sp  0x0000000000000000  pc 0x0000000000004b70
cpsr 0x00000000

[...]
```
### **`LC_CODE_SIGNATURE`**

рдореЗрдВ **Macho-O рдлрд╝рд╛рдЗрд▓ рдХреЗ рдХреЛрдб рд╣рд╕реНрддрд╛рдХреНрд╖рд░** рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ **рдУрдлрд╝реНрд╕реЗрдЯ** рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ рдЬреЛ **рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдмреНрд▓реЙрдм** рдХреА **рдУрд░ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ**ред рдпрд╣ рдЖрдо рддреМрд░ рдкрд░ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрдд рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рдЗрд╕ рдЦрдВрдб рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА [**рдЗрд╕ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ**](https://davedelong.com/blog/2018/01/10/reading-your-own-entitlements/) рдФрд░ рдЗрд╕ [**рдЧрд┐рд╕реНрдЯ**](https://gist.github.com/carlospolop/ef26f8eb9fafd4bc22e69e1a32b81da4) рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

### **`LC_ENCRYPTION_INFO[_64]`**

рдмрд╛рдЗрдирд░реА рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХрд╛ рд╕рдорд░реНрдердиред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдХреЛрдИ рд╣рдорд▓рд╛рд╡рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХрдВрдкреНрд░рдорд╛рдЗрдЬ рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдореЗрдореЛрд░реА рдХреЛ рдЕрдирдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХреЗрдЧрд╛ред

### **`LC_LOAD_DYLINKER`**

**рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд┐рдВрдХрд░ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдХрд╛ рдкрде** рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреЛ рд╕рд╛рдЭрд╛ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрддрд╛ рд╕реНрдерд╛рди рдореЗрдВ рдореИрдк рдХрд░рддрд╛ рд╣реИред **рдорд╛рди рд╣рдореЗрд╢рд╛ `/usr/lib/dyld` рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ macOS рдореЗрдВ, dylib рдореИрдкрд┐рдВрдЧ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдореЛрдб** рдореЗрдВ рд╣реЛрддреА рд╣реИ, рдХрд░реНрдиреЗрд▓ рдореЛрдб рдореЗрдВ рдирд╣реАрдВред

### **`LC_IDENT`**

рдкреБрд░рд╛рдирд╛ рд╣реИ рд▓реЗрдХрд┐рди рдЬрдм рдкреИрдирд┐рдХ рдкрд░ рдбрдВрдк рдЬреЗрдирд░реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ Mach-O рдХреЛрд░ рдбрдВрдк рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХрд░реНрдиреЗрд▓ рд╕рдВрд╕реНрдХрд░рдг `LC_IDENT` рдХрдорд╛рдВрдб рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### **`LC_UUID`**

рд░реИрдВрдбрдо UUIDред рдпрд╣ рдХрд┐рд╕реА рдХрд╛рдо рдХреЗ рд▓рд┐рдП рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рд╣реИ рд▓реЗрдХрд┐рди XNU рдЗрд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдмрд╛рдХреА рд╕рд╛рде рдХреИрд╢ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдХреНрд░реИрд╢ рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### **`LC_DYLD_ENVIRONMENT`**

рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдареАрдХ рдкрд╣рд▓реЗ dyld рдХреЛ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░реЛрдВ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдпрд╣ рдмрд╣реБрдд рд╣реА рдЦрддрд░рдирд╛рдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ рд╡рд┐рдЪрд╛рд░рд╢реАрд▓ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рд▓реЛрдб рдХрдорд╛рдВрдб рдХреЗрд╡рд▓ `#define SUPPORT_LC_DYLD_ENVIRONMENT` рдХреЗ рд╕рд╛рде рдбрд╛рдпрд▓реНрдб рдмрд┐рд▓реНрдб рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЖрдЧреЗ рд╕рдВрд╡рд┐рджрд╛рди рдХреЗрд╡рд▓ `DYLD_..._PATH` рд░реВрдк рдХреЗ рдЪрд░реЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рддрд╛ рд╣реИред

### **`LC_LOAD_DYLIB`**

рдпрд╣ рд▓реЛрдб рдХрдорд╛рдВрдб рдПрдХ **рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА** рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ **рд▓реЛрдбрд░** (dyld) рдХреЛ **рдЙрд╕ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рд▓реЛрдб рдФрд░ рд▓рд┐рдВрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд** рдХрд░рддрд╛ рд╣реИред Mach-O рдмрд╛рдЗрдирд░реА рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рд▓рд┐рдП рдПрдХ `LC_LOAD_DYLIB` рд▓реЛрдб рдХрдорд╛рдВрдб рд╣реЛрддрд╛ рд╣реИред

* рдпрд╣ рд▓реЛрдб рдХрдорд╛рдВрдб рдПрдХ рдкреНрд░рдХрд╛рд░ рдХреА рд╕рдВрд░рдЪрдирд╛ рд╣реИ **`dylib_command`** (рдЬрд┐рд╕рдореЗрдВ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд┐рд░реНрднрд░ рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рд╡рд░реНрдгрди рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╕рдВрд░рдЪрдирд╛ dylib рд╣реЛрддрд╛ рд╣реИ):
```objectivec
struct dylib_command {
uint32_t        cmd;            /* LC_LOAD_{,WEAK_}DYLIB */
uint32_t        cmdsize;        /* includes pathname string */
struct dylib    dylib;          /* the library identification */
};

struct dylib {
union lc_str  name;                 /* library's path name */
uint32_t timestamp;                 /* library's build time stamp */
uint32_t current_version;           /* library's current version number */
uint32_t compatibility_version;     /* library's compatibility vers number*/
};
```
![](<../../../.gitbook/assets/image (483).png>)

рдЖрдк рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ cli рд╕реЗ рднреА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
otool -L /bin/ls
/bin/ls:
/usr/lib/libutil.dylib (compatibility version 1.0.0, current version 1.0.0)
/usr/lib/libncurses.5.4.dylib (compatibility version 5.4.0, current version 5.4.0)
/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1319.0.0)
```
рдХреБрдЫ рд╕рдВрднрд╛рд╡рд┐рдд рдореИрд▓рд╡реЗрдпрд░ рд╕рдВрдмрдВрдзрд┐рдд рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬ рд╣реИрдВ:

* **DiskArbitration**: USB рдбреНрд░рд╛рдЗрд╡ рдХреА рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ
* **AVFoundation:** рдСрдбрд┐рдпреЛ рдФрд░ рд╡реАрдбрд┐рдпреЛ рдХреИрдкреНрдЪрд░
* **CoreWLAN**: рд╡рд╛рдИрдлрд╛рдИ рд╕реНрдХреИрдиред

{% hint style="info" %}
рдПрдХ Mach-O рдмрд╛рдЗрдирд░реА рдореЗрдВ рдПрдХ рдпрд╛ **рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдирд┐рд░реНрдорд╛рддрд╛рдУрдВ** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ **LC\_MAIN** рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкрддреЗ рд╕реЗ **рдкрд╣рд▓реЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд** рд╣реЛрдВрдЧреЗред\
рдХрд┐рд╕реА рднреА рдирд┐рд░реНрдорд╛рддрд╛рдУрдВ рдХреЗ offsets рдХреЛ **\_\_DATA\_CONST** рд╕реЗрдЧрдореЗрдВрдЯ рдХреЗ **\_\_mod\_init\_func** рдЦрдВрдб рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред
{% endhint %}

## **Mach-O рдбреЗрдЯрд╛**

рдлрд╝рд╛рдЗрд▓ рдХреЗ рдореВрд▓ рдореЗрдВ рдбреЗрдЯрд╛ рдХреНрд╖реЗрддреНрд░ рд╣реИ, рдЬреЛ рд▓реЛрдб-рдХрдорд╛рдВрдбреНрд╕ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрдИ рд╕реЗрдЧрдореЗрдВрдЯреЛрдВ рд╕реЗ рдмрдирд╛ рд╣реЛрддрд╛ рд╣реИред **рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрдЧрдореЗрдВрдЯ рдореЗрдВ рдХрдИ рдбреЗрдЯрд╛ рдЦрдВрдб рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ**, рд╣рд░ рдЦрдВрдб **рдХреЛрдб рдпрд╛ рдбреЗрдЯрд╛** рд╡рд┐рд╢рд┐рд╖реНрдЯ рдПрдХ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣реЛрддрд╛ рд╣реИред

{% hint style="success" %}
рдбреЗрдЯрд╛ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдЙрд╕ рд╕рднреА **рдЬрд╛рдирдХрд╛рд░реА** рдХреЛ рд╕рдореЗрдЯрддрд╛ рд╣реИ рдЬреЛ рд▓реЛрдб рдХрдорд╛рдВрдбреНрд╕ **LC\_SEGMENTS\_64** рджреНрд╡рд╛рд░рд╛ рд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИред
{% endhint %}

![https://www.oreilly.com/api/v2/epubs/9781785883378/files/graphics/B05055\_02\_38.jpg](<../../../.gitbook/assets/image (507) (3).png>)

рдЗрд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* **рдХрд╛рд░реНрдп рд╕рд╛рд░рдгреА:** рдЬреЛ рдХрд╛рд░реНрдп рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреА рд╣реИред
* **рдкреНрд░рддреАрдХ рд╕рд╛рд░рдгреА**: рдЬреЛ рдмрд╛рдЗрдирд░реА рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЧрдИ рдмрд╛рд╣реНрдп рдХрд╛рд░реНрдп рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреА рд╣реИ
* рдпрд╣ рдЖрдВрддрд░рд┐рдХ рдХрд╛рд░реНрдп, рдЪрд░ рдирд╛рдореЛрдВ рдХреЛ рднреА рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрдзрд┐рдХред

рдЗрд╕реЗ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк [**Mach-O View**](https://sourceforge.net/projects/machoview/) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

<figure><img src="../../../.gitbook/assets/image (1117).png" alt=""><figcaption></figcaption></figure>

рдпрд╛ CLI рд╕реЗ:
```bash
size -m /bin/ls
```
<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ **The PEASS Family** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
