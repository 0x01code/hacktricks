# macOS AppleFS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ**

</details>

## Apple Propietary File System (APFS)

APFS, рдпрд╛рдиреА Apple File System, рдПрдХ рдЖрдзреБрдирд┐рдХ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╣реИ рдЬрд┐рд╕реЗ Apple Inc. рдиреЗ рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдкреБрд░рд╛рдиреЗ Hierarchical File System Plus (HFS+) рдХреЛ рдмрджрд▓рдирд╛ рдерд╛ рдЬрд┐рд╕рдореЗрдВ **рдмреЗрд╣рддрд░ рдкреНрд░рджрд░реНрд╢рди, рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдХреБрд╢рд▓рддрд╛** рдХреЛ рдорд╣рддреНрд╡ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

APFS рдХреА рдХреБрдЫ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

1. **рд╕реНрдерд╛рди рд╕рд╛рдЭрд╛рдХрд░рдг**: APFS рдПрдХ рд╣реА рд╢рд╛рд░реАрд░рд┐рдХ рдЙрдкрдХрд░рдг рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдореБрдХреНрдд рд╕рдВрдЧреНрд░рд╣ рдХреЛ **рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ**ред рдЗрд╕рд╕реЗ рд╕реНрдерд╛рди рдХрд╛ рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╕рдВрдЧреНрд░рд╣ рдбрд╛рдЗрдирд╛рдорд┐рдХ рд░реВрдк рд╕реЗ рдмрдврд╝ рдФрд░ рдШрдЯ рд╕рдХрддреЗ рд╣реИрдВ рдмрд┐рдирд╛ рдореИрдиреБрдЕрд▓ рдЖрдХрд╛рд░ рдмрджрд▓рдиреЗ рдпрд╛ рдкреБрдирд░реНрд╡рд┐рднрд╛рдЬрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗред
1. рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ, рдлрд╝рд╛рдЗрд▓ рдбрд┐рд╕реНрдХ рдореЗрдВ рдкрд╛рд░рдВрдкрд░рд┐рдХ рд╡рд┐рднрд╛рдЬрдиреЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ, **APFS рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рднрд╛рдЬрди (рд╕рдВрдЧреНрд░рд╣) рд╕рднреА рдбрд┐рд╕реНрдХ рд╕реНрдерд╛рди рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВ**, рдЬрдмрдХрд┐ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рднрд╛рдЬрди рдореЗрдВ рдЖрдорддреМрд░ рдкрд░ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдЖрдХрд╛рд░ рд╣реЛрддрд╛ рдерд╛ред
2. **рд╕реНрдиреИрдкрд╢реЙрдЯ**: APFS **рд╕реНрдиреИрдкрд╢реЙрдЯ рдмрдирд╛рдиреЗ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ**, рдЬреЛ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕рдордп-рд╕реАрдорд╛ рдореЗрдВ **рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп** рдЙрджрд╛рд╣рд░рдг рд╣реИрдВред рд╕реНрдиреИрдкрд╢реЙрдЯ рд╕реБрд░рдХреНрд╖рд┐рдд рдмреИрдХрдЕрдк рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рд╡рд╛рдкрд╕ рд▓рд╛рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдЗрдиреНрд╣реЗрдВ рдХрдо рд╕реЗ рдХрдо рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдВрдЧреНрд░рд╣ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рддреНрд╡рд░рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдкреВрд░реНрд╡рд╡рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
3. **рдХреНрд▓реЛрди**: APFS **рдлрд╝рд╛рдЗрд▓ рдпрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреНрд▓реЛрди рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдореВрд▓ рд╕рдВрдЧреНрд░рд╣ рдХреЗ рд╕рд╛рде рд╕рдорд╛рди рд╕рдВрдЧреНрд░рд╣ рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВ** рдЬрдм рддрдХ рдХрд┐ рдХреНрд▓реЛрди рдпрд╛ рдореВрд▓ рдлрд╝рд╛рдЗрд▓ рд╕рдВрд╢реЛрдзрд┐рдд рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рдлрд╝рд╛рдЗрд▓ рдпрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдЧреНрд░рд╣ рд╕реНрдерд╛рди рдХреЛ рджреЛрд╣рд░рд╛рдиреЗ рдХрд╛ рдПрдХ рдХреБрд╢рд▓ рддрд░реАрдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред
4. **рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди**: APFS **рдкреВрд░реЗ рдбрд┐рд╕реНрдХ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХрд╛ рд╕рдорд░реНрдерди** рдХрд░рддрд╛ рд╣реИ рд╕рд╛рде рд╣реА рдлрд╝рд╛рдЗрд▓ рдФрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди, рд╡рд┐рднрд┐рдиреНрди рдЙрдкрдпреЛрдЧ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдбреЗрдЯрд╛ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИред
5. **рдХреНрд░реИрд╢ рд╕реБрд░рдХреНрд╖рд╛**: APFS рдПрдХ **рдХреЙрдкреА-рдСрди-рд░рд╛рдЗрдЯ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдпреЛрдЬрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреА рд╕рдВрдЧрддрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ**, рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдЕрдЪрд╛рдирдХ рдмрд┐рдЬрд▓реА рдХреА рдЖрдкрд╛рддрдХрд╛рд▓реАрди рдЧреБрдордирд╛рдореА рдпрд╛ рд╕рд┐рд╕реНрдЯрдо рдХреНрд░реИрд╢ рдХреЗ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рднреА, рдбреЗрдЯрд╛ рдХреЗ рдХрд░рдкреНрд╢рди рдХрд╛ рдЬреЛрдЦрд┐рдо рдХрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

рд╕рдордЧреНрд░ рд░реВрдк рд╕реЗ, APFS Apple рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдзрд┐рдХ рдЖрдзреБрдирд┐рдХ, рд▓рдЪреАрд▓рд╛ рдФрд░ рдХреБрд╢рд▓ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рджрд░реНрд╢рди, рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд╛ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
```bash
diskutil list # Get overview of the APFS volumes
```
## Firmlinks

`Data` рд╡реЙрд▓реНрдпреВрдо **`/System/Volumes/Data`** рдореЗрдВ рдорд╛рдЙрдВрдЯ рд╣реЛрддрд╛ рд╣реИ (рдЖрдк `diskutil apfs list` рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред)

рдлрд░реНрдорд▓рд┐рдВрдХреНрд╕ рдХреА рд╕реВрдЪреА **`/usr/share/firmlinks`** рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдорд┐рд▓ рд╕рдХрддреА рд╣реИред
```bash
cat /usr/share/firmlinks
/AppleInternal	AppleInternal
/Applications	Applications
/Library	Library
[...]
```
**рдмрд╛рдПрдВ** рдореЗрдВ, **рд╕рд┐рд╕реНрдЯрдо рд╡реЙрд▓реНрдпреВрдо** рдкрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдкрде рд╣реИ, рдФрд░ **рджрд╛рдПрдВ** рдореЗрдВ, рдпрд╣ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдкрде рд╣реИ рдЬрд╣рд╛рдВ рдпрд╣ **рдбреЗрдЯрд╛ рд╡реЙрд▓реНрдпреВрдо** рдкрд░ рдореИрдк рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, `/library` --> `/system/Volumes/data/library`
