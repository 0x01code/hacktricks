# macOS Keychain

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **follow** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## рдореБрдЦреНрдп Keychains

* **User Keychain** (`~/Library/Keychains/login.keycahin-db`), рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░рдорд╛рдг-рдкрддреНрд░** рдЬреИрд╕реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд╛рд╕рд╡рд░реНрдб, рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд╛рд╕рд╡рд░реНрдб, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдирд┐рд░реНрдорд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░, рдиреЗрдЯрд╡рд░реНрдХ рдкрд╛рд╕рд╡рд░реНрдб, рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдирд┐рд░реНрдорд┐рдд рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ/рдирд┐рдЬреА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **System Keychain** (`/Library/Keychains/System.keychain`), рдЬреЛ **рд╕рд┐рд╕реНрдЯрдо-рд╡реНрдпрд╛рдкреА рдкреНрд░рдорд╛рдг-рдкрддреНрд░** рдЬреИрд╕реЗ WiFi рдкрд╛рд╕рд╡рд░реНрдб, рд╕рд┐рд╕реНрдЯрдо рд░реВрдЯ рдкреНрд░рдорд╛рдгрдкрддреНрд░, рд╕рд┐рд╕реНрдЯрдо рдирд┐рдЬреА рдХреБрдВрдЬрд┐рдпрд╛рдБ, рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд╛рд╕рд╡рд░реНрдб рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред

### Password Keychain Access

рдпреЗ рдлрд╛рдЗрд▓реЗрдВ, рдЬрдмрдХрд┐ рдЗрдирдореЗрдВ рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд╕реБрд░рдХреНрд╖рд╛ рдирд╣реАрдВ рд╣реЛрддреА рдФрд░ рдЗрдиреНрд╣реЗрдВ **рдбрд╛рдЙрдирд▓реЛрдб** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╣реЛрддреА рд╣реИрдВ рдФрд░ рдЗрдиреНрд╣реЗрдВ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкреНрд▓реЗрдирдЯреЗрдХреНрд╕реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ**ред рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рд▓рд┐рдП [**Chainbreaker**](https://github.com/n0fate/chainbreaker) рдЬреИрд╕реЗ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## Keychain Entries Protections

### ACLs

Keychain рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ **Access Control Lists (ACLs)** рджреНрд╡рд╛рд░рд╛ рд╢рд╛рд╕рд┐рдд рд╣реЛрддреА рд╣реИ, рдЬреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреА рд╣реИрдВ рдХрд┐ рдХреМрди рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* **ACLAuhtorizationExportClear**: рдкреНрд░рдзрд╛рд░рдХ рдХреЛ рдЧреБрдкреНрдд рд╕рдВрджреЗрд╢ рдХрд╛ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* **ACLAuhtorizationExportWrapped**: рдкреНрд░рдзрд╛рд░рдХ рдХреЛ рджреВрд╕рд░реЗ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* **ACLAuhtorizationAny**: рдкреНрд░рдзрд╛рд░рдХ рдХреЛ рдХреЛрдИ рднреА рдХреНрд░рд┐рдпрд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

ACLs рдХреЗ рд╕рд╛рде рдПрдХ **рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рд╕реВрдЪреА** рднреА рд╣реЛрддреА рд╣реИ рдЬреЛ рдмрд┐рдирд╛ рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЗ рдпреЗ рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

* &#x20;**N`il`** (рдХреЛрдИ рдЕрдзрд┐рдХрд╛рд░ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ, **рд╕рднреА рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╣реИрдВ**)
* рдПрдХ **рдЦрд╛рд▓реА** рд╕реВрдЪреА (**рдХреЛрдИ рднреА** рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдирд╣реАрдВ рд╣реИ)
* рд╡рд┐рд╢рд┐рд╖реНрдЯ **рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ** рдХреА **рд╕реВрдЪреА**ред

рд╕рд╛рде рд╣реА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдореЗрдВ **`ACLAuthorizationPartitionID`,** рдХреБрдВрдЬреА рднреА рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **teamid, apple,** рдФрд░ **cdhash** рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

* рдпрджрд┐ **teamid** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ, рддреЛ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдореВрд▓реНрдп рддрдХ **рдмрд┐рдирд╛ рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЗ рдкрд╣реБрдБрдЪрдиреЗ** рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдкрд╛рд╕ **рд╕рдорд╛рди teamid** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
* рдпрджрд┐ **apple** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ, рддреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ **Apple** рджреНрд╡рд╛рд░рд╛ **рд╕рд╛рдЗрди** рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
* рдпрджрд┐ **cdhash** рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдХреЗ рдкрд╛рд╕ рд╡рд┐рд╢рд┐рд╖реНрдЯ **cdhash** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

### Keychain Entry рдмрдирд╛рдирд╛

рдЬрдм **рдирдИ** **рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐** **`Keychain Access.app`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдирд┐рдпрдо рд▓рд╛рдЧреВ рд╣реЛрддреЗ рд╣реИрдВ:

* рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **рдХреЛрдИ рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдирд┐рд░реНрдпрд╛рдд/рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░реЙрдореНрдкреНрдЯ рдХрд┐рдП рдмрд┐рдирд╛)ред
* рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдЦрдВрдбрддрд╛ рдЬрд╛рдВрдЪ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
* рдХреЛрдИ рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди ACLs рдмрджрд▓ рдирд╣реАрдВ рд╕рдХрддрд╛ред
* **partitionID** рдХреЛ **`apple`** рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЬрдм рдХреЛрдИ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди keychain рдореЗрдВ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдмрдирд╛рддрд╛ рд╣реИ**, рддреЛ рдирд┐рдпрдо рдереЛрдбрд╝реЗ рдЕрд▓рдЧ рд╣реЛрддреЗ рд╣реИрдВ:

* рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* рдХреЗрд╡рд▓ **рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдмрдирд╛рдиреЗ рд╡рд╛рд▓рд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди** (рдпрд╛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЬреЛрдбрд╝реЗ рдЧрдП рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди) рдирд┐рд░реНрдпрд╛рдд/рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░реЙрдореНрдкреНрдЯ рдХрд┐рдП рдмрд┐рдирд╛)ред
* рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдЦрдВрдбрддрд╛ рдЬрд╛рдВрдЪ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
* рдХреЛрдИ рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди ACLs рдмрджрд▓ рдирд╣реАрдВ рд╕рдХрддрд╛ред
* **partitionID** рдХреЛ **`teamid:[teamID here]`** рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## Keychain рддрдХ рдкрд╣реБрдБрдЪ

### `security`
```bash
# Dump all metadata and decrypted secrets (a lot of pop-ups)
security dump-keychain -a -d

# Find generic password for the "Slack" account and print the secrets
security find-generic-password -a "Slack" -g

# Change the specified entrys PartitionID entry
security set-generic-password-parition-list -s "test service" -a "test acount" -S
```
### APIs

{% hint style="success" %}
**keychain enumeration рдФрд░ dumping** рдЬреЛ **prompt рдирд╣реАрдВ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛** рдЙрд╕реЗ [**LockSmith**](https://github.com/its-a-feature/LockSmith) рдЯреВрд▓ рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

рдкреНрд░рддреНрдпреЗрдХ keychain рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ **рдЬрд╛рдирдХрд╛рд░реА** рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

* API **`SecItemCopyMatching`** рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдЖрдк рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
* **`kSecReturnData`**: рдпрджрд┐ рд╕рдЪ рд╣реИ, рддреЛ рдпрд╣ рдбреЗрдЯрд╛ рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ (рдкреЙрдк-рдЕрдк рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП false рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ)
* **`kSecReturnRef`**: keychain рдЖрдЗрдЯрдо рдХрд╛ рд╕рдВрджрд░реНрдн рднреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ (рдпрджрд┐ рдмрд╛рдж рдореЗрдВ рдЖрдк рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдкреЙрдк-рдЕрдк рдХреЗ рдмрд┐рдирд╛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рд╕рдЪ рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдВ)
* **`kSecReturnAttributes`**: рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **`kSecMatchLimit`**: рдХрд┐рддрдиреЗ рдкрд░рд┐рдгрд╛рдо рд▓реМрдЯрд╛рдиреЗ рд╣реИрдВ
* **`kSecClass`**: keychain рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХрд╛ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ

рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЗ **ACLs** рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

* API **`SecAccessCopyACLList`** рдХреЗ рд╕рд╛рде рдЖрдк **keychain рдЖрдЗрдЯрдо рдХреЗ рд▓рд┐рдП ACL** рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдпрд╣ ACLs рдХреА рдПрдХ рд╕реВрдЪреА рд▓реМрдЯрд╛рдПрдЧрд╛ (рдЬреИрд╕реЗ `ACLAuhtorizationExportClear` рдФрд░ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдЕрдиреНрдп) рдЬрд╣рд╛рдБ рдкреНрд░рддреНрдпреЗрдХ рд╕реВрдЪреА рдореЗрдВ рд╣реЛрдЧрд╛:
* рд╡рд┐рд╡рд░рдг
* **Trusted Application List**ред рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:
* рдПрдХ рдРрдк: /Applications/Slack.app
* рдПрдХ рдмрд╛рдЗрдирд░реА: /usr/libexec/airportd
* рдПрдХ рд╕рдореВрд╣: group://AirPort

рдбреЗрдЯрд╛ рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдВ:

* API **`SecKeychainItemCopyContent`** рдкреНрд▓реЗрдирдЯреЗрдХреНрд╕реНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ
* API **`SecItemExport`** рдХреБрдВрдЬрд┐рдпреЛрдВ рдФрд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЛ рдирд┐рд░реНрдпрд╛рдд рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдирд┐рд░реНрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░рдирд╛ рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИ

рдФрд░ рдпреЗ **рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ** рд╣реИрдВ рдЬреЛ **рдмрд┐рдирд╛ prompt рдХреЗ рдПрдХ рд░рд╣рд╕реНрдп рдХреЛ рдирд┐рд░реНрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП**:

* рдпрджрд┐ **1+ trusted** рдРрдкреНрд╕ рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВ:
* рдЙрдЪрд┐рдд **authorizations** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ (**`Nil`**, рдпрд╛ рд░рд╣рд╕реНрдп рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рд╕реВрдЪреА рдХреЗ рдРрдкреНрд╕ рдХрд╛ **рднрд╛рдЧ** рд╣реЛрдирд╛)
* рдХреЛрдб рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд╛ **PartitionID** рд╕реЗ рдореЗрд▓ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП
* рдХреЛрдб рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд╛ рдПрдХ **trusted app** рдХреЗ рд╕рд╛рде рдореЗрд▓ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рдпрд╛ рд╕рд╣реА KeychainAccessGroup рдХрд╛ рд╕рджрд╕реНрдп рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП)
* рдпрджрд┐ **рд╕рднреА рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рд╡рд┐рд╢реНрд╡рд╛рд╕ рд╣реИ**:
* рдЙрдЪрд┐рдд **authorizations** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ
* рдХреЛрдб рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд╛ **PartitionID** рд╕реЗ рдореЗрд▓ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП
* рдпрджрд┐ **рдХреЛрдИ PartitionID рдирд╣реАрдВ рд╣реИ**, рддреЛ рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ

{% hint style="danger" %}
рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ **1 рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╕реВрдЪреАрдмрджреНрдз рд╣реИ**, рддреЛ рдЖрдкрдХреЛ рдЙрд╕ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдореЗрдВ рдХреЛрдб **рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛**ред

рдпрджрд┐ **apple** рдХреЛ **partitionID** рдореЗрдВ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕реЗ **`osascript`** рдХреЗ рд╕рд╛рде рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдХреБрдЫ рднреА рдЬреЛ рд╕рднреА рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ apple рдХреЗ рд╕рд╛рде partitionID рдореЗрдВ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд░рддрд╛ рд╣реИред **`Python`** рднреА рдЗрд╕рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

### рджреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

* **Invisible**: рдпрд╣ рдПрдХ рдмреВрд▓рд┐рдпрди рдлреНрд▓реИрдЧ рд╣реИ рдЬреЛ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ **UI** Keychain рдРрдк рд╕реЗ **рдЫрд┐рдкрд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рд╣реИ
* **General**: рдпрд╣ **рдореЗрдЯрд╛рдбреЗрдЯрд╛** рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ (рдЗрд╕рд▓рд┐рдП рдпрд╣ ENCRYPTED рдирд╣реАрдВ рд╣реИ)
* Microsoft рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдПрдВрдбрдкреЙрдЗрдВрдЯ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рднреА рд░рд┐рдлреНрд░реЗрд╢ рдЯреЛрдХрди рдХреЛ рд╕рд╛рджреЗ рдкрд╛рда рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд░ рд░рд╣рд╛ рдерд╛ред

## рд╕рдВрджрд░реНрдн

* [**#OBTS v5.0: "Lock Picking the macOS Keychain" - Cody Thomas**](https://www.youtube.com/watch?v=jKE1ZW33JpY)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**official PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**ред
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
