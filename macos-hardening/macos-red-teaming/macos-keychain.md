# macOS Keychain

{% hint style="success" %}
рд╕реАрдЦреЗрдВ рдФрд░ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдХрд░реЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
рд╕реАрдЦреЗрдВ рдФрд░ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдХрд░реЗрдВ GCP рд╣реИрдХрд┐рдВрдЧ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВред

</details>
{% endhint %}

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) рдПрдХ **рдбрд╛рд░реНрдХ-рд╡реЗрдм** рд╕реЗ рдкреНрд░реЗрд░рд┐рдд рдЦреЛрдЬ рдЗрдВрдЬрди рд╣реИ рдЬреЛ **рдореБрдлреНрдд** рд╕реБрд╡рд┐рдзрд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЬрд╛рдВрдЪ рд╕рдХреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдХрдВрдкрдиреА рдпрд╛ рдЙрд╕рдХреЗ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ **рд╕реНрдЯреАрд▓рд░ рдореИрд▓рд╡реЗрдпрд░реНрд╕** рджреНрд╡рд╛рд░рд╛ **рдХрдореНрдкреНрд░реЛрдорд╛рдЗрдЬ** рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

рд╡реНрд╣рд╛рдЗрдЯрдЗрдВрдЯреЗрд▓ рдХрд╛ рдореБрдЦреНрдп рдЙрджреНрджреЗрд╢реНрдп рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдиреЗ рдФрд░ рд░реИрдВрд╕рдорд╡реЗрдпрд░ рд╣рдорд▓реЛрдВ рд╕реЗ рд▓рдбрд╝рдирд╛ рд╣реИ рдЬреЛ рдЬрд╛рдирдХрд╛рд░реА рдЪреЛрд░реА рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдореИрд▓рд╡реЗрдпрд░ рд╕реЗ рд╣реЛрддреЗ рд╣реИрдВред

рдЖрдк рдЙрдирдХреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдЪреЗрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдореБрдлреНрдд** рдореЗрдВ рдЙрдирдХрд╛ рдЗрдВрдЬрди рдЖрдЬрдорд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% embed url="https://whiteintel.io" %}

***

## рдореБрдЦреНрдп Keychains

* **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ Keychain** (`~/Library/Keychains/login.keycahin-db`), рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░рдорд╛рдгрдкрддреНрд░** рдЬреИрд╕реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд╛рд╕рд╡рд░реНрдб, рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд╛рд╕рд╡рд░реНрдб, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдкреНрд░рдорд╛рдгрдкрддреНрд░, рдиреЗрдЯрд╡рд░реНрдХ рдкрд╛рд╕рд╡рд░реНрдб рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ/рдирд┐рдЬреА рдХреБрдВрдЬреА рд╕рдВрдЬреНрдЮрд╛рди рдореЗрдВ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рд╕рд┐рд╕реНрдЯрдо Keychain** (`/Library/Keychains/System.keychain`), рдЬрд┐рд╕рдореЗрдВ **рд╕рд┐рд╕реНрдЯрдо-рд╡реНрдпрд╛рдкреА рдкреНрд░рдорд╛рдгрдкрддреНрд░** рдЬреИрд╕реЗ WiFi рдкрд╛рд╕рд╡рд░реНрдб, рд╕рд┐рд╕реНрдЯрдо рд░реВрдЯ рдкреНрд░рдорд╛рдгрдкрддреНрд░, рд╕рд┐рд╕реНрдЯрдо рдирд┐рдЬреА рдХреБрдВрдЬреА рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд╛рд╕рд╡рд░реНрдб рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВред

### рдкрд╛рд╕рд╡рд░реНрдб Keychain рдПрдХреНрд╕реЗрд╕

рдпреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ, рдЬреЛ рдХрд┐ рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд░реВрдк рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рд╕реЗ рд▓реЗрдкрд┐рдд рдирд╣реАрдВ рд╣реИрдВ рдФрд░ **рдбрд╛рдЙрдирд▓реЛрдб** рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╣реЛрддреА рд╣реИрдВ рдФрд░ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рд╛рджрд╛рдкрд╛рда рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ** рдЙрдирдХрд╛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред [**Chainbreaker**](https://github.com/n0fate/chainbreaker) рдЬреИрд╕рд╛ рдПрдХ рдЙрдкрдХрд░рдг рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рд▓рд┐рдП рдкреНрд░рдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## Keychain Entries рд╕реБрд░рдХреНрд╖рд╛

### ACLs

Keychain рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдПрдВрдЯреНрд░реА рдХреЛ **рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рдЕрдзрд┐рдХрд╛рд░ рд╕реВрдЪреА (ACLs)** рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдХреМрди рдХрд┐рд╕реА рднреА рдХреБрдВрдЬреАрдбрд╛рди рдПрдВрдЯреНрд░реА рдкрд░ рд╡рд┐рднрд┐рдиреНрди рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ:

* **ACLAuhtorizationExportClear**: рдзрд╛рд░рдХ рдХреЛ рдЧреЛрдкрдиреАрдп рд╕реАрдзреЗ рдкрд╛рда рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* **ACLAuhtorizationExportWrapped**: рдзрд╛рд░рдХ рдХреЛ рджрд┐рдпреЗ рдЧрдП рдПрдХ рдЕрдиреНрдп рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╕рд╛рдл рдкрд╛рда рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* **ACLAuhtorizationAny**: рдзрд╛рд░рдХ рдХреЛ рдХрд┐рд╕реА рднреА рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

ACLs рдХреЗ рд╕рд╛рде рдПрдХ **рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рд╕реВрдЪреА** рднреА рд╣реЛрддреА рд╣реИ рдЬреЛ рдЗрди рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░ рд╕рдХрддреА рд╣реИрдВ рдмрд┐рдирд╛ рдкреНрд░реЙрдореНрдкреНрдЯ рдХрд┐рдПред рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

* **рдирд┐рд▓** (рдХреЛрдИ рдЕрдзрд┐рдХрд╛рд░реАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, **рд╕рднреА рдкрд░ рднрд░реЛрд╕рд╛ рд╣реИ**)
* рдПрдХ **рдЦрд╛рд▓реА** рд╕реВрдЪреА (**рдХреЛрдИ рдирд╣реАрдВ** рднрд░реЛрд╕рд╛ рд╣реИ)
* рд╡рд┐рд╢рд┐рд╖реНрдЯ **рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ** рдХреА **рд╕реВрдЪреА**ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдВрдЯреНрд░реА рдореЗрдВ рдХреБрдВрдЬреА **`ACLAuthorizationPartitionID`** рднреА рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **рдЯреАрдордЖрдИрдбреА, рдПрдкреНрдкрд▓,** рдФрд░ **рд╕реАрдбреАрд╣реИрд╢** рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

* рдпрджрд┐ **рдЯреАрдордЖрдИрдбреАрдЖрдИ** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдПрдВрдЯреНрд░реА рдорд╛рди **рдкреНрд░рдореНрдкреНрдЯ рдХреЗ рдмрд┐рдирд╛** рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ **рдПрдВрдЯреНрд░реА рдорд╛рди** рдХрд╛ **рд╕рдорд╛рди рдЯреАрдордЖрдИрдбреА** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
* рдпрджрд┐ **рдПрдкреНрдкрд▓** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ **рдПрдкреНрдкрд▓** рджреНрд╡рд╛рд░рд╛ **рд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
* рдпрджрд┐ **рд╕реАрдбреАрд╣реИрд╢** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ **рд╕реАрдбреАрд╣реИрд╢** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

### рдПрдХ Keychain рдПрдВрдЯреНрд░реА рдмрдирд╛рдирд╛

рдЬрдм рдПрдХ **рдирдпрд╛** **рдПрдВрдЯреНрд░реА** **`Keychain Access.app`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдирд┐рдпрдо рд▓рд╛рдЧреВ рд╣реЛрддреЗ рд╣реИрдВ:

* рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **рдХреЛрдИ рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдП рдмрд┐рдирд╛ рдирд┐рд░реНрдпрд╛рдд/рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░реЙрдореНрдкреНрдЯ рдХрд┐рдП рдмрд┐рдирд╛)ред
* рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдЦрдВрдбрддрд╛ рдЬрд╛рдВрдЪ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
* рдХреЛрдИ рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди ACLs рдирд╣реАрдВ рдмрджрд▓ рд╕рдХрддреЗред
* **рдкрд╛рд░реНрдЯреАрд╢рдирдЖрдИрдбреА** рдХреЛ **`рдПрдкреНрдкрд▓`** рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЬрдм рдПрдХ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди keychain рдореЗрдВ рдПрдХ рдПрдВрдЯреНрд░реА рдмрдирд╛рддрд╛ рд╣реИ**, рддреЛ рдирд┐рдпрдо рдереЛрдбрд╝реЗ рдЕрд▓рдЧ рд╣реЛрддреЗ рд╣реИрдВ:

* рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* рдХреЗрд╡рд▓ **рдмрдирд╛рдиреЗ рд╡рд╛рд▓рд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди** (рдпрд╛ рдХреЛрдИ рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЬреЛрдбрд╝реЗ рдЧрдП рд╣реЛрдВ) рдирд┐рд░реНрдпрд╛рдд/рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░реЙрдореНрдкреНрдЯ рдХрд┐рдП рдмрд┐рдирд╛)ред
* рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдЦрдВрдбрддрд╛ рдЬрд╛рдВрдЪ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
* рдХреЛрдИ рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди ACLs рдирд╣реАрдВ рдмрджрд▓ рд╕рдХрддреЗред
* **рдкрд╛рд░реНрдЯреАрд╢рдирдЖрдИрдбреА** рдХреЛ **`teamid:[рдпрд╣рд╛рдБ рдЯреАрдордЖрдИрдбреА]`** рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## Keychain рддрдХ рдкрд╣реБрдВрдЪрдирд╛

### `рд╕реБрд░рдХреНрд╖рд╛`
```bash
# Dump all metadata and decrypted secrets (a lot of pop-ups)
security dump-keychain -a -d

# Find generic password for the "Slack" account and print the secrets
security find-generic-password -a "Slack" -g

# Change the specified entrys PartitionID entry
security set-generic-password-parition-list -s "test service" -a "test acount" -S
```
### рдПрдкреАрдЖрдИ

{% hint style="success" %}
**рдХреАрдЪреЗрди рдЗрдиреБрдорд░реЗрд╢рди рдФрд░ рдбрдВрдкрд┐рдВрдЧ** рдСрдл рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдЬреЛ **рдкреНрд░реЙрдореНрдкреНрдЯ рдирд╣реАрдВ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВрдЧреЗ** рдХреЛ рдЙрдкрдХрд░рдг [**LockSmith**](https://github.com/its-a-feature/LockSmith) рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

рдкреНрд░рддреНрдпреЗрдХ рдХреАрдЪреЗрди рдПрдВрдЯреНрд░реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ **рдЬрд╛рдирдХрд╛рд░реА** рдХреА рд╕реВрдЪреА рдФрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

* рдПрдкреАрдЖрдИ **`SecItemCopyMatching`** рдкреНрд░рддреНрдпреЗрдХ рдПрдВрдЯреНрд░реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рдЖрдк рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
* **`kSecReturnData`**: рдпрджрд┐ рд╕рддреНрдп рд╣реИ, рддреЛ рдпрд╣ рдбреЗрдЯрд╛ рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ (рдкреЙрдк-рдЕрдк рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рдХрдЯ рд╣реЛрдиреЗ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдЭреВрдард╛ рдХрд░реЗрдВ)
* **`kSecReturnRef`**: рдХреАрдЪреЗрди рдЖрдЗрдЯрдо рдХрд╛ рд╕рдВрджрд░реНрдн рднреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ (рдпрджрд┐ рдмрд╛рдж рдореЗрдВ рдЖрдк рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдкреЙрдк-рдЕрдк рдХреЗ рдмрд┐рдирд╛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЗрд╕реЗ рд╕рддреНрдп рдХрд░реЗрдВ)
* **`kSecReturnAttributes`**: рдПрдВрдЯреНрд░реАрдЬ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **`kSecMatchLimit`**: рд╡рд╛рдкрд╕реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рддрдиреЗ рдкрд░рд┐рдгрд╛рдо
* **`kSecClass`**: рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдХреАрдЪреЗрди рдПрдВрдЯреНрд░реА

рдкреНрд░рддреНрдпреЗрдХ рдПрдВрдЯреНрд░реА рдХреА **ACLs** рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

* рдПрдкреАрдЖрдИ **`SecAccessCopyACLList`** рдХреЗ рд╕рд╛рде рдЖрдк **рдХреАрдЪреЗрди рдЖрдЗрдЯрдо рдХреЗ рд▓рд┐рдП ACL** рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдпрд╣ рдПрдХ ACL рдХреА рд╕реВрдЪреА рд╡рд╛рдкрд╕ рдХрд░реЗрдЧрд╛ (рдЬреИрд╕реЗ `ACLAuhtorizationExportClear` рдФрд░ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдЕрдиреНрдп) рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рд╕реВрдЪреА рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ:
* рд╡рд┐рд╡рд░рдг
* **рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реВрдЪреА**ред рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:
* рдПрдХ рдРрдк: /Applications/Slack.app
* рдПрдХ рдмрд╛рдЗрдирд░реА: /usr/libexec/airportd
* рдПрдХ рд╕рдореВрд╣: group://AirPort

рдбреЗрдЯрд╛ рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдВ:

* рдПрдкреАрдЖрдИ **`SecKeychainItemCopyContent`** рдкреНрд▓реЗрдирдЯреЗрдХреНрд╕реНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ
* рдПрдкреАрдЖрдИ **`SecItemExport`** рдХреБрдВрдЬрд┐рдпрд╛рдБ рдФрд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЛ рдирд┐рд░реНрдпрд╛рдд рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╕рдВрджреЗрд╢ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░рдирд╛ рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИ

рдФрд░ рдпреЗ рд╣реИрдВ **рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ** рдЬрд┐рдиреНрд╣реЗрдВ **рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдЧреБрдкреНрдд рд╕реАрдХреНрд░реЗрдЯ рдирд┐рд░реНрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдкреВрд░рд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:

* рдпрджрд┐ **1+ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп** рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реВрдЪреАрдЬрд╝ рд╣реИрдВ:
* рдЙрдЪрд┐рдд **рдЕрдзрд┐рдХрд╛рд░рдг** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (**`Nil`**, рдпрд╛ рдЧреБрдкреНрдд рд╕реВрдЪреА рдореЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХреГрдд рд╕реВрдЪреА рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рд╕реЗ рдЧреБрдкреНрдд рд╕реВрдЪрдирд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП)
* рдХреЛрдб рд╕рд╛рдЗрдиреЗрдЪрд░ рдХреЛ рдорд┐рд▓рд╛рдирд╛ рдЪрд╛рд╣рд┐рдП **PartitionID** рдХреЗ рд╕рд╛рде
* рдХреЛрдб рд╕рд╛рдЗрдиреЗрдЪрд░ рдХреЛ рдорд┐рд▓рд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдЙрд╕ рдПрдХ **рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдХреЗ рд╕рд╛рде (рдпрд╛ рд╕рд╣реА KeychainAccessGroup рдХрд╛ рд╕рджрд╕реНрдп рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП)
* рдпрджрд┐ **рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп** рд╣реИрдВ:
* рдЙрдЪрд┐рдд **рдЕрдзрд┐рдХрд╛рд░рдг** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ
* рдХреЛрдб рд╕рд╛рдЗрдиреЗрдЪрд░ рдХреЛ рдорд┐рд▓рд╛рдирд╛ рдЪрд╛рд╣рд┐рдП **PartitionID** рдХреЗ рд╕рд╛рде
* рдпрджрд┐ **рдХреЛрдИ PartitionID рдирд╣реАрдВ** рд╣реИ, рддреЛ рдпрд╣ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ

{% hint style="danger" %}
рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ **1 рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реВрдЪреАрдЬрд╝ рд╣реИ**, рддреЛ рдЖрдкрдХреЛ **рдЙрд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

рдпрджрд┐ **рдкрд╛рд░реНрдЯреАрд╢рдирдЖрдИрдбреА** рдореЗрдВ **рдПрдкреНрдкрд▓** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕реЗ **`osascript`** рдХреЗ рд╕рд╛рде рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЬреЛ рдХреБрдЫ рднреА рдкрд╛рд░реНрдЯреАрд╢рдирдЖрдИрдбреА рдореЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдХреЗ рд╕рд╛рде рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╣реИред **`Python`** рднреА рдЗрд╕рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

### рджреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

* **рдЕрджреГрд╢реНрдп**: рдпрд╣ рдПрдХ рдмреВрд▓рд┐рдпрди рдлреНрд▓реИрдЧ рд╣реИ рдЬреЛ **UI** рдХреАрдЪреЗрди рдРрдк рд╕реЗ рдПрдВрдЯреНрд░реА рдХреЛ **рдЫреБрдкрд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рд╣реИ
* **рд╕рд╛рдорд╛рдиреНрдп**: рдпрд╣ **рдореЗрдЯрд╛рдбреЗрдЯрд╛** рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ (рдЗрд╕рд▓рд┐рдП рдпрд╣ **рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдирд╣реАрдВ** рд╣реИ)
* рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдиреЗ рд╕рднреА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЕрдВрдд рдмрд┐рдВрджреБ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рд░реЗ рд░рд┐рдлреНрд░реЗрд╢ рдЯреЛрдХрди рдХреЛ рд╕рд╛рджрд╛ рдкрд╛рда рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдпрд╛ рдерд╛ред

## рд╕рдВрджрд░реНрдн

* [**#OBTS v5.0: "Lock Picking the macOS Keychain" - Cody Thomas**](https://www.youtube.com/watch?v=jKE1ZW33JpY)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) рдПрдХ **рдбрд╛рд░реНрдХ-рд╡реЗрдм** рд╕реЗ рдкреНрд░реЗрд░рд┐рдд рдЦреЛрдЬ рдЗрдВрдЬрди рд╣реИ рдЬреЛ рдПрдХ рдХрдВрдкрдиреА рдпрд╛ рдЙрд╕рдХреЗ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ **рд╕реНрдЯреАрд▓рд░ рдореИрд▓рд╡реЗрдпрд░** рджреНрд╡рд╛рд░рд╛ **рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝** рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП **рдореБрдлреНрдд** рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

рд╡реНрд╣рд╛рдЗрдЯрдЗрдВрдЯреЗрд▓ рдХрд╛ рдореБрдЦреНрдп рдЙрджреНрджреЗрд╢реНрдп рдЦрд╛рддрд╛ рд╣рд╕реНрддрд╛рдВрддрд░рдг рдФрд░ рд░реИрдВрд╕рдорд╡реЗрдпрд░ рд╣рдорд▓реЛрдВ рдХрд╛ рдореБрдХрд╛рдмрд▓рд╛ рдХрд░рдирд╛ рд╣реИ рдЬреЛ рд╕реВрдЪрдирд╛ рдЪреЛрд░реА рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдореИрд▓рд╡реЗрдпрд░ рд╕реЗ рд╣реЛрддрд╛ рд╣реИред

рдЖрдк рдЙрдирдХреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдЪреЗрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдХреЗ рдЗрдВрдЬрди рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдореБрдлреНрдд** рдореЗрдВ:

{% embed url="https://whiteintel.io" %}

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдЬрд╛рдВрдЪреЗрдВ!
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
{% endhint %}
