# рд╕реНрдЯреИрдХ рдХреИрдиреЗрд░реАрдЬ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдХреЛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## **рд╕реНрдЯреИрдХрдЧрд╛рд░реНрдб рдФрд░ рд╕реНрдЯреИрдХрд╢реАрд▓реНрдб**

**рд╕реНрдЯреИрдХрдЧрд╛рд░реНрдб** рдПрдХ рд╡рд┐рд╢реЗрд╖ рдорд╛рди рдЬреЛ рдПрдХ **рдХреИрдиреЗрд░реА** рдХреЗ рд░реВрдк рдореЗрдВ рдбрд╛рд▓рддрд╛ рд╣реИ, **рдИрдЖрдИрдкреА (рдПрдХреНрд╕рдЯреЗрдВрдбреЗрдб рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдкреЙрдЗрдВрдЯрд░)** рд╕реЗ рдкрд╣рд▓реЗ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ `0x000aff0d` (рдирд▓, рдиреНрдпреВрд▓рд╛рдЗрди, рдИрдУрдПрдл, рдХреИрд░рд┐рдЬ рд░рд┐рдЯрд░реНрди рдХреЛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ) рдХреЛ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдПред рд╣рд╛рд▓рд╛рдВрдХрд┐, `recv()`, `memcpy()`, `read()`, рдФрд░ `bcopy()` рдЬреИрд╕реЗ рдлрд╝рдВрдХреНрд╢рди рдЕрдм рднреА рд╕рдВрдХреНрд░рдорд┐рдд рд╣реИрдВ, рдФрд░ рдпрд╣ **рдИрдмреАрдкреА (рдмреЗрд╕ рдкреЙрдЗрдВрдЯрд░)** рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд░рдЦрддрд╛ рд╣реИред

**рд╕реНрдЯреИрдХрд╢реАрд▓реНрдб** рд╕реНрдЯреИрдХрдЧрд╛рд░реНрдб рд╕реЗ рдПрдХ рдЕрдзрд┐рдХ рд╡рд┐рд╡реЗрдХрдкреВрд░реНрдг рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЕрдкрдирд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ **рдЧреНрд▓реЛрдмрд▓ рд░рд┐рдЯрд░реНрди рд╕реНрдЯреИрдХ** рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рд╕рднреА рд░рд┐рдЯрд░реНрди рдкрддреЛрдВ (**рдИрдЖрдИрдкреА** рдХреЛ) рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╕реЗрдЯрдЕрдк рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рднреА рдУрд╡рд░рдлреНрд▓реЛ рд╣рд╛рдирд┐ рдирд╣реАрдВ рдкрд╣реБрдВрдЪрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд░рд┐рдЯрд░реНрди рдкрддреЛрдВ рдХреЗ рдмреАрдЪ рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдУрд╡рд░рдлреНрд▓реЛ рдШрдЯрдирд╛рдПрдВ рдкрддрд╛ рд▓рдЧрд╛рдИ рдЬрд╛ рд╕рдХреЗрдВред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рд╕реНрдЯреИрдХрд╢реАрд▓реНрдб рд╕реНрдЯреИрдХрд╢реАрд▓реНрдб рдХреЛ рднреА рджреБрд░реНрдЧрдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ Return-to-libc, ROP (Return-Oriented Programming), рдпрд╛ ret2ret рдЬреИрд╕реА рддрдХрдиреАрдХреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдЗрд╕рдХрд╛ рд╕реБрдЭрд╛рд╡ рджреЗрддрд╛ рд╣реИ рдХрд┐ рд╕реНрдЯреИрдХрд╢реАрд▓реНрдб рднреА рд╕реНрдерд╛рдиреАрдп рдЪрд░реЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд░рдЦрддрд╛ред

## **рд╕реНрдЯреИрдХ рд╕реНрдореИрд╢ рдкреНрд░реЛрдЯреЗрдХреНрдЯрд░ (ProPolice) `-fstack-protector`:**

рдпрд╣ рддрдВрддреНрд░ **рдИрдмреАрдкреА** рдХреЗ рдкрд╣рд▓реЗ рдПрдХ **рдХреИрдиреЗрд░реА** рд░рдЦрддрд╛ рд╣реИ, рдФрд░ рд╕реНрдерд╛рдиреАрдп рдЪрд░реЛрдВ рдХреЛ рдкреБрдирд░реНрд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдмрдлрд░реНрд╕ рдХреЛ рдЕрдиреНрдп рдЪрд░реЛрдВ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рд╕реЗ рдмрдЪрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдпрд╣ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рддрдмрд╛рджрд▓реЗ рдХреЛ рдкреБрдирд░реНрд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрди рдкреНрд░рддрд┐рдпреЛрдВ рдХреЛ рд╕реНрдерд╛рдиреАрдп рдЪрд░реЛрдВ рдХреЗ рдКрдкрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрди рдкреНрд░рддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ 8 рддрддреНрд╡реЛрдВ рд╕реЗ рдХрдо рдЖрдпрд╛рдд рд╡рд╛рд▓реЗ рд╕рд░рдгрд┐рдпреЛрдВ рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рдмрдлрд░реНрд╕ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд░рдЦрддрд╛ред

**рдХреИрдиреЗрд░реА** рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕рдВрдЦреНрдпрд╛ рд╣реИ рдЬреЛ `/dev/urandom` рд╕реЗ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдпрд╛ рдПрдХ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди `0xff0a0000` рд╣реЛрддрд╛ рд╣реИред рдпрд╣ **рдЯреАрдПрд▓рдПрд╕ (рд╕реВрддреНрд░ рд╕реНрдерд╛рдиреАрдп рд╕рдВрдЧреНрд░рд╣рдг)** рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдзрд╛рдЧреЗ-рд╕реНрдерд╛рдиреАрдп рд╕реНрдерд╛рдиреЛрдВ рдХреЛ рдзрд╛рдЧреЗ-рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╡реИрд╢реНрд╡рд┐рдХ рдпрд╛ рд╕реНрдереИрддрд┐рдХ рдЪрд░реЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд░рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдпреЗ рдЪрд░ рдЖрджрд┐рдХреЛрдВ рд╕реЗ рдкрд╣рд▓реЗ рдореВрд▓ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдХреЙрдкреА рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдФрд░ рдмрдЪреНрдЪреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рдХреЛ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдмрд┐рдирд╛ рдорд╛рддрд╛-рдкрд┐рддрд╛ рдпрд╛ рднрд╛рдИ-рдмрд╣рдиреЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд┐рдПред рддрдерд╛рдкрд┐, рдпрджрд┐ рдПрдХ **`fork()` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдмрд┐рдирд╛ рдПрдХ рдирдпрд╛ рдХреИрдиреЗрд░реА рдмрдирд╛рдП, рддреЛ рд╕рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ (рдорд╛рддрд╛-рдкрд┐рддрд╛ рдФрд░ рдмрдЪреНрдЪреЗ) рдПрдХ рд╣реА рдХреИрдиреЗрд░реА рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рддреА рд╣реИрдВ**, рдЬрд┐рд╕рд╕реЗ рдпрд╣ рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред **i386** рд╕рдВрд░рдЪрдирд╛ рдкрд░, рдХреИрдиреЗрд░реА `gs:0x14` рдкрд░ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрддреА рд╣реИ, рдФрд░ **x86\_64** рдкрд░, `fs:0x28` рдкрд░ рд╣реЛрддреА рд╣реИред

рдпрд╣ рд╕реНрдерд╛рдиреАрдп рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдзрд╛рди рдЙрди рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдирдореЗрдВ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд░рдорд┐рдд рдмрдлрд░реНрд╕ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЗрди рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЗ рд╢реБрд░реВ рдореЗрдВ рдХреИрдиреЗрд░реА рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдбрд╛рд▓рддрд╛ рд╣реИ, рдФрд░ рдЗрдирдХреА рдкреВрд░реНрдгрддрд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХреЗ рд▓рд┐рдП рдЕрдВрдд рдореЗрдВ рдХреЛрдб рдбрд╛рд▓рддрд╛ рд╣реИред

рдЬрдм рдПрдХ рд╡реЗрдм рд╕рд░реНрд╡рд░ `fork()` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рд╣рдорд▓рд╛ рд╕рдВрднрд╛рд╡рдирд╛ рдмрдирд╛рддрд╛ рд╣реИ рдХрд┐ рдХреИрдиреЗрд░реА рдмрд╛рдЗрдЯ рдХреЛ рдмрд╛рдЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, `fork()` рдХреЗ рдмрд╛рдж `execve()` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рд╣рдорд▓реЗ рдХреЛ рдирдХрд╛рд░ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред `vfork()` рдмрдЪреНрдЪреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбреБрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд┐рдП рдмрд┐рдирд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрдм рддрдХ рд╡рд╣ рд▓рд┐рдЦрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдирд╣реАрдВ рдХрд░рддрд╛, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдПрдХ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд┐рд░реНрдорд╛рдг рдФрд░ рдореЗрдореЛрд░реА рд╣реИрдВрдбрд▓рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рднрд┐рдиреНрди рджреГрд╖реНрдЯрд┐рдХреЛрдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

### рд▓рдВрдмрд╛рдИ

`x64` рдмрд╛рдЗрдирд░реА рдореЗрдВ, рдХреИрдиреЗрд░реА рдХреБрдХреА рдПрдХ **`0x8`** рдмрд╛рдЗрдЯ рдХреНрд╡реЙрд░реНрдб рд╣реИред **рдкрд╣рд▓реЗ рд╕рд╛рдд рдмрд╛рдЗрдЯ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ** рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЖрдЦрд┐рд░реА рдмрд╛рдЗрдЯ рдПрдХ **рдирд▓ рдмрд╛рдЗрдЯ** рд╣реЛрддрд╛ рд╣реИред

`x86` рдмрд╛рдЗрдирд░реА рдореЗрдВ, рдХреИрдиреЗрд░реА рдХреБрдХреА рдПрдХ **`0x4`** рдмрд╛рдЗрдЯ рдбрд╡рд░реНрдб рд╣реЛрддреА рд╣реИред **рдкрд╣рд▓реЗ рддреАрди рдмрд╛рдЗрдЯ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ** рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЖрдЦрд┐рд░реА рдмрд╛рдЗрдЯ рдПрдХ **рдирд▓ рдмрд╛рдЗрдЯ** рд╣реЛрддрд╛ рд╣реИред

{% hint style="danger" %}
рджреЛрдиреЛрдВ рдХреИрдиреЗрд░реА рдХреА рдХрдо рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рдЗрдЯ рдПрдХ рдирд▓ рдмрд╛рдЗрдЯ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдирд┐рдЪрд▓реЗ рдкрддреЛрдВ рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рдкрд╣рд▓рд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЗрд╕реЗ рдкрдврд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ **рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкрдврд╝рдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рдВрдХреНрд╢рди рдЙрд╕реЗ рдкрдврд╝рдирд╛ рдмрдВрдж рдХрд░ рджреЗрдВрдЧреЗ**ред
{% endhint %}

## рдмрд╛рдпрдкрд╛рд╕

**рдХреИрдиреЗрд░реА рдХреЛ рд▓реАрдХ рдХрд░рдирд╛** рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ) рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдорд╛рди рдХреЗ рд╕рд╛рдеред

* рдпрджрд┐ **рдХреИрдиреЗрд░реА рдмрдЪреНрдЪреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рдлреЛрд░реНрдХ рдХреА рдЧрдИ рд╣реИ** рддреЛ рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдЗрд╕реЗ рдПрдХ рдмрд╛рдЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ **рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="bf-forked-stack-canaries.md" %}
[bf-forked-stack-canaries.md](bf-forked-stack-canaries.md)
{% endcontent-ref %}

* рдпрджрд┐ рдмрд╛рдЗрдирд░реА рдореЗрдВ рдХреЛрдИ **рджрд┐рд▓рдЪрд╕реНрдк рд▓реАрдХ рдпрд╛ рдЕрд░реНрдмрд┐рдЯреНрд░реЗ рд░реАрдб рд╡рд▓рдирд░реЗрдмрд┐рд▓рд┐рдЯреА** рд╣реИ рддреЛ рдЗрд╕реЗ рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="print-stack-canary.md" %}
[print-stack-canary.md](print-stack-canary
