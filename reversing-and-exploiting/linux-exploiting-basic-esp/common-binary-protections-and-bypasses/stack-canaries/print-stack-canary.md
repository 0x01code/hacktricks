# Druk Staprooikanon

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS-familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFT's**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

## Vergroot gedrukte stak

Stel jou voor 'n situasie waar 'n **program vatbaar** vir stak-oorvloei 'n **puts**-funksie kan uitvoer wat na 'n **deel** van die **stak-oorvloei** wys. Die aanvaller weet dat die **eerste byte van die staprooikanon 'n nulbyte** (`\x00`) is en die res van die staprooikanon **willekeurige** bytes is. Dan kan die aanvaller 'n oorvloei skep wat die stak oorskryf tot net die eerste byte van die staprooikanon.

Dan roep die aanvaller die puts-funksionaliteit aan op die middel van die nutslading wat al die staprooikanon sal druk (behalwe die eerste nulbyte).

Met hierdie inligting kan die aanvaller 'n nuwe aanval **skep en stuur** deur die staprooikanon te ken (in dieselfde program-sessie).

Dit is vanselfsprekend dat hierdie taktiek baie **beperk** is aangesien die aanvaller in staat moet wees om die **inhoud** van sy **nutslading** te **druk** om die **staprooikanon te eksfiltreer** en dan 'n nuwe nutslading (in dieselfde program-sessie) te skep en te stuur om die **werklike bufferoorvloei** uit te voer.

**CTF-voorbeelde:**&#x20;

* [**https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html**](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)
* 64-bis, ASLR geaktiveer maar geen PIE nie, die eerste stap is om 'n oorvloei te vul tot die byte 0x00 van die staprooikanon om dan puts te roep en dit te lek. Met die staprooikanon word 'n ROP-gadget geskep om puts te roep om die adres van puts van die GOT te lek en 'n ROP-gadget om `system('/bin/sh')` te roep

## Willekeurige Lees

Met 'n willekeurige lees soos die een wat deur formaat **strings** voorsien word, kan dit moontlik wees om die staprooikanon te lek. Kyk na hierdie voorbeeld: [**https://ir0nstone.gitbook.io/notes/types/stack/canaries**](https://ir0nstone.gitbook.io/notes/types/stack/canaries) en jy kan lees oor die misbruik van formaatstrings om willekeurige geheue-adresse te lees in:

{% content-ref url="../../format-strings/" %}
[format-strings](../../format-strings/)
{% endcontent-ref %}

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS-familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFT's**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
