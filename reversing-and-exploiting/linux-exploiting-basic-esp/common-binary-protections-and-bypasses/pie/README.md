# PIE

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** reposit√≥rios [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informa√ß√µes B√°sicas

Um bin√°rio compilado como PIE, ou **Executable de Posi√ß√£o Independente**, significa que o **programa pode carregar em diferentes locais de mem√≥ria** cada vez que √© executado, impedindo endere√ßos codificados.

O truque para explorar esses bin√°rios est√° em explorar os **endere√ßos relativos** ‚Äî os deslocamentos entre partes do programa permanecem os mesmos mesmo se as localiza√ß√µes absolutas mudarem. Para **burlar o PIE, voc√™ s√≥ precisa vazar um endere√ßo**, normalmente da **pilha** usando vulnerabilidades como ataques de string de formato. Uma vez que voc√™ tem um endere√ßo, voc√™ pode calcular outros por seus **deslocamentos fixos**.

Uma dica √∫til na explora√ß√£o de bin√°rios PIE √© que o **endere√ßo base deles geralmente termina em 000** devido √†s p√°ginas de mem√≥ria serem as unidades de randomiza√ß√£o, com tamanho de 0x1000 bytes. Este alinhamento pode ser um **verificador cr√≠tico se um exploit n√£o estiver funcionando** como esperado, indicando se o endere√ßo base correto foi identificado.\
Ou voc√™ pode usar isso para o seu exploit, se voc√™ vazar que um endere√ßo est√° localizado em **`0x649e1024`** voc√™ sabe que o **endere√ßo base √© `0x649e1000`** e a partir da√≠ voc√™ pode apenas **calcular deslocamentos** de fun√ß√µes e locais.

## Bypasses

Para burlar o PIE √© necess√°rio **vazar algum endere√ßo do bin√°rio carregado**, existem algumas op√ß√µes para isso:

* **ASLR desativado**: Se o ASLR estiver desativado, um bin√°rio compilado com PIE sempre **ser√° carregado no mesmo endere√ßo**, portanto o **PIE ser√° in√∫til** j√° que os endere√ßos dos objetos sempre estar√£o no mesmo lugar.
* Ser **dado** o vazamento (comum em desafios CTF f√°ceis, [**verifique este exemplo**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit))
* **For√ßar os valores de EBP e EIP** na pilha at√© vazar os corretos:

{% content-ref url="bypassing-canary-and-pie.md" %}
[bypassing-canary-and-pie.md](bypassing-canary-and-pie.md)
{% endcontent-ref %}

* Use uma vulnerabilidade de leitura arbitr√°ria como [**string de formato**](../../format-strings/) para vazar um endere√ßo do bin√°rio (por exemplo, da pilha, como na t√©cnica anterior) para obter a base do bin√°rio e usar deslocamentos a partir da√≠. [**Encontre um exemplo aqui**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-bypass).

## Refer√™ncias

* [https://ir0nstone.gitbook.io/notes/types/stack/pie](https://ir0nstone.gitbook.io/notes/types/stack/pie)

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** reposit√≥rios [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
