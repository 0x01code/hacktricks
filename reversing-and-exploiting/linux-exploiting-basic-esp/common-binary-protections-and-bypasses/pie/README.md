# PIE

<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

- **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
- [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手する
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見つける
- **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**に参加するか、[telegramグループ](https://t.me/peass)に参加するか、**Twitter** 🐦で**フォロー**する [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**。**
- **ハッキングトリックを共有するために、** [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出する。

</details>

## 基本情報

PIEとしてコンパイルされたバイナリは、**プログラムが実行されるたびに異なるメモリ位置にロード**できることを意味し、ハードコードされたアドレスを防ぎます。

これらのバイナリを悪用するトリックは、**相対アドレス**を悪用することにあります。プログラムの部分間のオフセットは、絶対位置が変わっても同じままです。**PIEをバイパスするには、通常はスタックからのリークなどの脆弱性を使用して、1つのアドレスをリークするだけ**です。アドレスを取得したら、**固定オフセット**によって他のアドレスを計算できます。

PIEバイナリを悪用する際の役立つヒントは、その**ベースアドレスが通常000で終わる**ことです。これは、メモリページがランダム化の単位であり、0x1000バイトのサイズであるためです。このアライメントは、正しいベースアドレスが特定されたかどうかを示すため、エクスプロイトが期待どおりに機能していない場合に重要な**チェック**になります。\
または、エクスプロイトにこれを使用できます。アドレスが**`0x649e1024`**にあることが漏洩した場合、**ベースアドレスが`0x649e1000`**であることがわかり、そこから関数や場所の**オフセットを計算**するだけです。

## バイパス

PIEをバイパスするには、**ロードされたバイナリのアドレスをいくつか漏洩する必要**があります。これにはいくつかのオプションがあります：

- リークが**与えられる**（簡単なCTFチャレンジで一般的、[**この例**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit)をチェック）
- スタックで**正しいリークが発生するまでEBPとEIPの値をブルートフォース**する：

{% content-ref url="bypassing-canary-and-pie.md" %}
[bypassing-canary-and-pie.md](bypassing-canary-and-pie.md)
{% endcontent-ref %}

- スタックからバイナリのアドレスを漏洩するために[**フォーマット文字列**](../../format-strings/)などの任意の読み取り脆弱性を使用し、バイナリのベースを取得してそこからオフセットを使用します。[**こちらで例を見つける**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-bypass)。

## 参考文献

- [https://ir0nstone.gitbook.io/notes/types/stack/pie](https://ir0nstone.gitbook.io/notes/types/stack/pie)

<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

- **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
- [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手する
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見つける
- **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**に参加するか、[telegramグループ](https://t.me/peass)に参加するか、**Twitter** 🐦で**フォロー**する [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**。**
- **ハッキングトリックを共有するために、** [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出する。

</details>
