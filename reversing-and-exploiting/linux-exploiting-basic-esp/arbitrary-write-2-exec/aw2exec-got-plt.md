# AW2Exec - GOT/PLT

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**swag oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## **Informaci√≥n B√°sica**

### **GOT: Global Offset Table**

La **Tabla de Desplazamiento Global (GOT)** es un mecanismo utilizado en binarios enlazados din√°micamente para gestionar las **direcciones de funciones externas**. Dado que estas **direcciones no se conocen hasta tiempo de ejecuci√≥n** (debido al enlace din√°mico), la GOT proporciona una forma de **actualizar din√°micamente las direcciones de estos s√≠mbolos externos** una vez que se resuelven.

Cada entrada en la GOT corresponde a un s√≠mbolo en las bibliotecas externas que el binario puede llamar. Cuando se llama a una **funci√≥n por primera vez, su direcci√≥n real es resuelta por el enlazador din√°mico y almacenada en la GOT**. Las llamadas posteriores a la misma funci√≥n utilizan la direcci√≥n almacenada en la GOT, evitando as√≠ el costo de resolver la direcci√≥n nuevamente.

### **PLT: Procedure Linkage Table**

La **Tabla de Enlace de Procedimientos (PLT)** trabaja estrechamente con la GOT y sirve como un trampol√≠n para manejar las llamadas a funciones externas. Cuando un binario **llama a una funci√≥n externa por primera vez, el control se pasa a una entrada en la PLT asociada con esa funci√≥n**. Esta entrada de la PLT es responsable de invocar al enlazador din√°mico para resolver la direcci√≥n de la funci√≥n si a√∫n no ha sido resuelta. Despu√©s de resolver la direcci√≥n, se almacena en la GOT.

**Por lo tanto,** las entradas de la GOT se utilizan directamente una vez que se resuelve la direcci√≥n de una funci√≥n o variable externa. **Las entradas de la PLT se utilizan para facilitar la resoluci√≥n inicial** de estas direcciones a trav√©s del enlazador din√°mico.

## Obtener Ejecuci√≥n

### Verificar la GOT

Obt√©n la direcci√≥n de la tabla GOT con: **`objdump -s -j .got ./exec`**

![](<../../../.gitbook/assets/image (619).png>)

Observa c√≥mo despu√©s de **cargar** el **ejecutable** en GEF puedes **ver** las **funciones** que est√°n en la **GOT**: `gef‚û§ x/20x 0xDIR_GOT`

![](https://github.com/carlospolop/hacktricks/blob/es/.gitbook/assets/image%20\(620\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(1\)%20\(5\).png)

Usando GEF puedes **iniciar** una **sesi√≥n de depuraci√≥n** y ejecutar **`got`** para ver la tabla got:

![](<../../../.gitbook/assets/image (621).png>)

### GOT2Exec

En un binario, la GOT tiene las **direcciones de las funciones o** de la secci√≥n **PLT** que cargar√° la direcci√≥n de la funci√≥n. El objetivo de esta escritura arbitraria es **sobrescribir una entrada de la GOT** de una funci√≥n que se ejecutar√° m√°s tarde **con** la **direcci√≥n** de la PLT de la funci√≥n **`system`** por ejemplo.

Idealmente, **sobrescribir√°s** la **GOT** de una **funci√≥n** que **ser√° llamada con par√°metros controlados por ti** (as√≠ podr√°s controlar los par√°metros enviados a la funci√≥n del sistema).

Si **`system`** **no se utiliza** en el script, la funci√≥n del sistema **no** tendr√° una entrada en la PLT. En este escenario, deber√°s **filtrar primero la direcci√≥n** de la funci√≥n `system` y luego sobrescribir la GOT para apuntar a esta direcci√≥n.

Puedes ver las direcciones de la PLT con **`objdump -j .plt -d ./vuln_binary`**

## **One Gadget**

{% content-ref url="../one-gadget.md" %}
[one-gadget.md](../one-gadget.md)
{% endcontent-ref %}

## **Protecciones**

La protecci√≥n **FullRELRO** est√° dise√±ada para protegerse contra este tipo de t√©cnica al resolver todas las direcciones de las funciones cuando se inicia el binario y hacer que la **tabla GOT sea de solo lectura** despu√©s de eso:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## Referencias

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**swag oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
