# AW2Exec - GOT/PLT

<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝したい** または **HackTricks をPDFでダウンロードしたい** 場合は [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェック！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションを見つける
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)** に参加するか、[telegramグループ](https://t.me/peass) に参加するか、**Twitter** 🐦 で **@hacktricks\_live** をフォローする

</details>

## **基本情報**

### **GOT: Global Offset Table**

**Global Offset Table (GOT)** は、動的リンクされたバイナリで **外部関数のアドレスを管理する** メカニズムです。これらの **アドレスは実行時まで不明** です（動的リンクのため）、GOT はこれらの外部シンボルのアドレスを **解決された後に動的に更新する方法** を提供します。

GOT の各エントリは、バイナリが呼び出す可能性のある外部ライブラリ内のシンボルに対応します。 **関数が最初に呼び出されると、その実際のアドレスが動的リンカによって解決され、GOT に格納されます**。同じ関数への後続の呼び出しでは、GOT に格納されたアドレスが使用され、アドレスを再度解決するオーバーヘッドが回避されます。

### **PLT: Procedure Linkage Table**

**Procedure Linkage Table (PLT)** は GOT と密接に連携し、外部関数への呼び出しを処理するトランポリンとして機能します。バイナリが **外部関数を最初に呼び出すと、その関数に関連する PLT のエントリに制御が渡されます**。この PLT エントリは、関数のアドレスがまだ解決されていない場合に、動的リンカを呼び出してアドレスを解決する責任があります。アドレスが解決された後、それはGOTに格納されます。

**したがって、** 外部関数や変数のアドレスが解決されると、GOT エントリが直接使用されます。 **PLT エントリは、** これらのアドレスの初期解決を **動的リンカを介して容易にするために使用** されます。

## 実行を取得

### GOT を確認

**`objdump -s -j .got ./exec`** で GOT テーブルのアドレスを取得します

![](<../../../.gitbook/assets/image (619).png>)

GEF で **実行可能ファイル** を **ロード** した後、 **GOT** にある **関数** を **確認** できます: `gef➤ x/20x 0xADDR_GOT`

![](<../../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

GEF を使用して **デバッグ** セッションを開始し、 **`got`** を実行して GOT テーブルを表示できます:

![](<../../../.gitbook/assets/image (621).png>)

### GOT2Exec

バイナリ内の GOT には、**関数のアドレスまたは** その **関数アドレスをロードする PLT** セクションへのアドレスが含まれています。この任意の書き込みの目的は、後で実行される関数の **GOT エントリを上書き** することです。たとえば、そのアドレスを **`system`** **関数** の **PLT** のアドレスにします。

理想的には、**制御可能なパラメータで呼び出される関数** の **GOT** を **上書き** します（したがって、システム関数に送信されるパラメータを制御できます）。

**`system`** がスクリプトで **使用されていない** 場合、システム関数には PLT にエントリがありません。このシナリオでは、まず `system` 関数のアドレスをリークしてから、GOT をそのアドレスを指すように上書きする必要があります。

**`objdump -j .plt -d ./vuln_binary`** で PLT のアドレスを確認できます

## **One Gadget**

{% content-ref url="../one-gadget.md" %}
[one-gadget.md](../one-gadget.md)
{% endcontent-ref %}

## **保護**

**Full RELRO** 保護は、バイナリが開始されるときにすべての関数のアドレスを解決し、その後 **GOT テーブルを読み取り専用** にすることで、この種のテクニックに対抗するためのものです:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## 参考文献

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝したい** または **HackTricks をPDFでダウンロードしたい** 場合は [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェック！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションを見つける
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)** に参加するか、[telegramグループ](https://t.me/peass) に参加するか、**Twitter** 🐦 で **@hacktricks\_live** をフォローする

</details>
