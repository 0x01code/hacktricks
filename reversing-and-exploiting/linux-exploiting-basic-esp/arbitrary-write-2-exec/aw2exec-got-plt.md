# AW2Exec - GOT/PLT

<details>

<summary><strong>从零开始学习AWS黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS红队专家）</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想在HackTricks中看到您的**公司广告**或**下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS和HackTricks周边产品**](https://peass.creator-spring.com)
* 探索[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或在**Twitter**上关注我们 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**。**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>

## **基本信息**

### **GOT：全局偏移表**

**全局偏移表（GOT）**是在动态链接二进制文件中使用的机制，用于管理**外部函数的地址**。由于这些**地址直到运行时才知道**（由于动态链接），GOT提供了一种方法来**动态更新这些外部符号的地址**一旦它们被解析。

GOT中的每个条目对应于二进制文件可能调用的外部库中的一个符号。当**首次调用函数时，动态链接器会解析其实际地址并将其存储在GOT中**。对同一函数的后续调用使用GOT中存储的地址，从而避免再次解析地址的开销。

### **PLT：过程链接表**

**过程链接表（PLT）**与GOT密切配合，作为处理对外部函数的调用的跳板。当二进制文件**首次调用外部函数时，控制会传递到与该函数相关联的PLT条目**。此PLT条目负责调用动态链接器以解析函数的地址（如果尚未解析）。地址解析后，将其存储在GOT中。

**因此，**一旦外部函数或变量的地址解析完成，将直接使用GOT条目。**PLT条目用于通过动态链接器**便捷地解析这些地址的初始解析。

## 获取执行

### 检查GOT

使用以下命令获取GOT表的地址：**`objdump -s -j .got ./exec`**

![](<../../../.gitbook/assets/image (619).png>)

在GEF中**加载**可执行文件后，您可以**查看**GOT中的**函数**：`gef➤ x/20x 0xDIR_GOT`

![](<../../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

使用GEF，您可以**开始**调试会话并执行**`got`**以查看got表：

![](<../../../.gitbook/assets/image (621).png>)

### GOT2Exec

在二进制文件中，GOT中有**函数的地址或**将加载函数地址的**PLT**部分的地址。此任意写入的目标是**覆盖将稍后执行的函数的GOT条目**，例如，用**`system`**函数的**PLT地址**覆盖。

理想情况下，您将**覆盖**将由您控制参数调用的**函数**的**GOT**（因此，您将能够控制发送到system函数的参数）。

如果脚本**未使用**`system`，则系统函数**不会**在PLT中有一个条目。在这种情况下，您将**需要首先泄漏`system`函数的地址**，然后覆盖GOT以指向此地址。

您可以使用**`objdump -j .plt -d ./vuln_binary`**查看PLT地址。

## **保护**

**FullRELRO**保护旨在通过在二进制文件启动时解析所有函数的地址并在此后将**GOT表设置为只读**来防止这种技术：

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

<details>

<summary><strong>从零开始学习AWS黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS红队专家）</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想在HackTricks中看到您的**公司广告**或**下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS和HackTricks周边产品**](https://peass.creator-spring.com)
* 探索[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或在**Twitter**上关注我们 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**。**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>
