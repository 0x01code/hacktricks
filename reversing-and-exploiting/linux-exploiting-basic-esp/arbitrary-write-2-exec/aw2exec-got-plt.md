# AW2Exec - GOT/PLT

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

## **Grundlegende Informationen**

### **GOT: Global Offset Table**

Die **Global Offset Table (GOT)** ist ein Mechanismus, der in dynamisch verkn√ºpften Bin√§rdateien verwendet wird, um die **Adressen externer Funktionen zu verwalten**. Da diese **Adressen erst zur Laufzeit bekannt sind** (aufgrund der dynamischen Verkn√ºpfung), bietet die GOT eine M√∂glichkeit, die Adressen dieser externen Symbole **dynamisch zu aktualisieren**, sobald sie aufgel√∂st sind.

Jeder Eintrag in der GOT entspricht einem Symbol in den externen Bibliotheken, die die Bin√§rdatei aufrufen kann. Wenn eine **Funktion zum ersten Mal aufgerufen wird, wird ihre tats√§chliche Adresse vom dynamischen Linker aufgel√∂st und in der GOT gespeichert**. Nachfolgende Aufrufe derselben Funktion verwenden die in der GOT gespeicherte Adresse, um den Overhead der erneuten Adressaufl√∂sung zu vermeiden.

### **PLT: Procedure Linkage Table**

Die **Procedure Linkage Table (PLT)** arbeitet eng mit der GOT zusammen und dient als Trampolin, um Aufrufe externer Funktionen zu verarbeiten. Wenn eine Bin√§rdatei eine **externe Funktion zum ersten Mal aufruft, wird die Kontrolle an einen Eintrag in der PLT √ºbergeben, der mit dieser Funktion verkn√ºpft ist**. Dieser PLT-Eintrag ist daf√ºr verantwortlich, den dynamischen Linker aufzurufen, um die Adresse der Funktion aufzul√∂sen, wenn sie noch nicht aufgel√∂st wurde. Nachdem die Adresse aufgel√∂st ist, wird sie in der GOT gespeichert.

**Daher** werden GOT-Eintr√§ge direkt verwendet, sobald die Adresse einer externen Funktion oder Variablen aufgel√∂st ist. **PLT-Eintr√§ge werden verwendet, um die anf√§ngliche Aufl√∂sung** dieser Adressen √ºber den dynamischen Linker zu erleichtern.

## Ausf√ºhrung erhalten

### √úberpr√ºfen der GOT

Holen Sie sich die Adresse der GOT-Tabelle mit: **`objdump -s -j .got ./exec`**

![](<../../../.gitbook/assets/image (619).png>)

Beachten Sie, wie nach dem **Laden** des **ausf√ºhrbaren** Codes in GEF die **Funktionen** in der **GOT** sichtbar sind: `gef‚û§ x/20x 0xDIR_GOT`

![](<../../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

Mit GEF k√∂nnen Sie eine **Debugging-Sitzung starten** und **`got`** ausf√ºhren, um die GOT-Tabelle zu sehen:

![](<../../../.gitbook/assets/image (621).png>)

### GOT2Exec

In einem Bin√§rfile enth√§lt die GOT die **Adressen der Funktionen oder** des **PLT**-Abschnitts, der die Funktionsadresse laden wird. Das Ziel dieses willk√ºrlichen Schreibens ist es, einen **GOT-Eintrag zu √ºberschreiben**, der sp√§ter mit der Adresse des PLT der **`system`**-**Funktion** beispielsweise **ausgef√ºhrt wird**.

Idealerweise werden Sie die **GOT** einer **Funktion √ºberschreiben**, die **mit von Ihnen kontrollierten Parametern aufgerufen wird** (damit Sie die an die Systemfunktion gesendeten Parameter kontrollieren k√∂nnen).

Wenn **`system`** **nicht vom Skript verwendet wird**, wird die Systemfunktion **keinen Eintrag im PLT haben**. In diesem Szenario m√ºssen Sie zuerst die Adresse der `system`-Funktion **leaken** und dann die GOT √ºberschreiben, um auf diese Adresse zu verweisen.

Sie k√∂nnen die PLT-Adressen mit **`objdump -j .plt -d ./vuln_binary`** sehen

## **Schutzma√ünahmen**

Der Schutz **FullRELRO** soll diese Art von Technik sch√ºtzen, indem er alle Adressen der Funktionen aufl√∂st, wenn die Bin√§rdatei gestartet wird und die **GOT-Tabelle nachtr√§glich schreibgesch√ºtzt** macht:

{% content-ref url="../common-binary-protections/relro.md" %}
[relro.md](../common-binary-protections/relro.md)
{% endcontent-ref %}

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
