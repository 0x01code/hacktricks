# –ü–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è —Å—Ç–µ–∫—É

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ **—Ä–µ–∫–ª–∞–º—É –≤–∞—à–æ—ó –∫–æ–º–ø–∞–Ω—ñ—ó –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—Ç–∞** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub**.

</details>

## –©–æ —Ç–∞–∫–µ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è —Å—Ç–µ–∫—É

**–ü–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è —Å—Ç–µ–∫—É** - —Ü–µ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, —è–∫–∞ –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –∑–∞–ø–∏—Å—É—î –±—ñ–ª—å—à–µ –¥–∞–Ω–∏—Ö —É —Å—Ç–µ–∫, –Ω—ñ–∂ –≤–∏–¥—ñ–ª–µ–Ω–æ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è. –¶—ñ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ –ø–µ—Ä–µ–∑–∞–ø–∏—à—É—Ç—å **—Å—É—Å—ñ–¥–Ω—ñ –ø—Ä–æ—Å—Ç–æ—Ä–∏ –ø–∞–º'—è—Ç—ñ**, —â–æ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –ø–æ—Ä—É—à–µ–Ω–Ω—è –¥—ñ–π—Å–Ω–∏—Ö –¥–∞–Ω–∏—Ö, —Ä–æ–∑—Ä–∏–≤—É –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞, –º–æ–∂–ª–∏–≤–æ, –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ –∫–æ–¥—É. –¶—è –ø—Ä–æ–±–ª–µ–º–∞ —á–∞—Å—Ç–æ –≤–∏–Ω–∏–∫–∞—î —á–µ—Ä–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ –Ω–µ –≤–∏–∫–æ–Ω—É—é—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –º–µ–∂ –≤–≤–µ–¥–µ–Ω–Ω—è.

–û—Å–Ω–æ–≤–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Ü—å–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ **EIP** —Ç–∞ **EBP** –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó **–∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ —Å—Ç–µ—Ü—ñ**. –¢–æ–º—É –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ —ó—Ö —ñ **–∫–µ—Ä—É–≤–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º –ø—Ä–æ–≥—Ä–∞–º–∏**.

–í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –∑–∞–∑–≤–∏—á–∞–π –≤–∏–Ω–∏–∫–∞—î —Ç–æ–º—É, —â–æ —Ñ—É–Ω–∫—Ü—ñ—è **–∫–æ–ø—ñ—é—î —É —Å—Ç–µ–∫ –±—ñ–ª—å—à–µ –±–∞–π—Ç—ñ–≤, –Ω—ñ–∂ –≤–∏–¥—ñ–ª–µ–Ω–æ –¥–ª—è –Ω–µ—ó**, —Ç–æ–º—É –º–æ–∂–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ —ñ–Ω—à—ñ —á–∞—Å—Ç–∏–Ω–∏ —Å—Ç–µ–∫—É.\
–î–µ—è–∫—ñ –∑–∞–≥–∞–ª—å–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó, –≤—Ä–∞–∑–ª–∏–≤—ñ –¥–æ —Ü—å–æ–≥–æ, —Ü–µ: `strcpy`, `strcat`, `sprintf`, `gets`, `fgets`...

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞—Å—Ç—É–ø–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏:
```c
void vulnerable() {
char buffer[128];
printf("Enter some text: ");
gets(buffer); // This is where the vulnerability lies
printf("You entered: %s\n", buffer);
}
```
### –ü–æ—à—É–∫ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω—å —Å—Ç–µ–∫—É

–ù–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∏–π —Å–ø–æ—Å—ñ–± –∑–Ω–∞–π—Ç–∏ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è —Å—Ç–µ–∫—É - —Ü–µ –≤–≤–µ—Å—Ç–∏ –¥—É–∂–µ –≤–µ–ª–∏–∫–∏–π –≤–≤—ñ–¥ –∑ `A` (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `python3 -c 'print("A"*1000)'`) —ñ –æ—á—ñ–∫—É–≤–∞—Ç–∏ `Segmentation Fault`, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ **–±—É–ª–∞ —Å–ø—Ä–æ–±–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ –∞–¥—Ä–µ—Å–∏ `0x41414141`**.

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —è–∫—â–æ –≤–∏ –≤–∏—è–≤–∏–ª–∏, —â–æ —ñ—Å–Ω—É—î —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è —Å—Ç–µ–∫—É, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ –∑—Å—É–≤, –ø–æ–∫–∏ –±—É–¥–µ –º–æ–∂–ª–∏–≤–æ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫ EIP**, –¥–ª—è —Ü—å–æ–≥–æ –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **–ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –î–µ –ë—Ä—é–π–Ω–∞**. –Ø–∫–∞ –¥–ª—è –∑–∞–¥–∞–Ω–æ–≥–æ –∞–ª—Ñ–∞–≤—ñ—Ç—É —Ä–æ–∑–º—ñ—Ä—É _k_ —Ç–∞ –ø—ñ–¥–ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π –¥–æ–≤–∂–∏–Ω–∏ _n_ —î **—Ü–∏–∫–ª—ñ—á–Ω–æ—é –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—é, –≤ —è–∫—ñ–π –∫–æ–∂–Ω–∞ –º–æ–∂–ª–∏–≤–∞ –ø—ñ–¥–ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –¥–æ–≤–∂–∏–Ω–∏ **_**n**_** –∑'—è–≤–ª—è—î—Ç—å—Å—è —Ä—ñ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑** —è–∫ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å.

–¢–∞–∫–∏–º —á–∏–Ω–æ–º, –∑–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –≤—Ä—É—á–Ω—É –≤–∏–∑–Ω–∞—á–∞—Ç–∏, —è–∫–∏–π –∑—Å—É–≤ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É—î EIP, –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–¥–Ω—É –∑ —Ü–∏—Ö –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π —è–∫ –¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è, –∞ –ø–æ—Ç—ñ–º –∑–Ω–∞–π—Ç–∏ –∑—Å—É–≤ –±–∞–π—Ç—ñ–≤, —è–∫—ñ –∑–∞–∫—ñ–Ω—á–∏–ª–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –π–æ–≥–æ.

–ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **pwntools** –¥–ª—è —Ü—å–æ–≥–æ:
```python
from pwn import *

# Generate a De Bruijn sequence of length 1000 with an alphabet size of 256 (byte values)
pattern = cyclic(1000)

# This is an example value that you'd have found in the EIP/IP register upon crash
eip_value = p32(0x6161616c)
offset = cyclic_find(eip_value)  # Finds the offset of the sequence in the De Bruijn pattern
print(f"The offset is: {offset}")
```
–∞–±–æ **GEF**:
```bash
#Patterns
pattern create 200 #Generate length 200 pattern
pattern search "avaaawaa" #Search for the offset of that substring
pattern search $rsp #Search the offset given the content of $rsp
```
## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è —Å—Ç–µ–∫—É

–ü—ñ–¥ —á–∞—Å –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è (–ø—Ä–∏–ø—É—Å–∫–∞—é—á–∏, —â–æ —Ä–æ–∑–º—ñ—Ä –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –≤–µ–ª–∏–∫–∏–π), –≤–∏ –∑–º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è —ñ–Ω—à–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö –≤ —Å—Ç–µ—Ü—ñ –¥–æ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è EBP —Ç–∞ EIP (–∞–±–æ –Ω–∞–≤—ñ—Ç—å –±—ñ–ª—å—à–µ). –ù–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∏–π —Å–ø–æ—Å—ñ–± –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è —Ü–∏–º —Ç–∏–ø–æ–º –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –ø–æ–ª—è–≥–∞—î –≤ **–∑–º—ñ–Ω—ñ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞ EIP**, —â–æ–± –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó **–∫–µ—Ä—É–≤–∞–Ω–Ω—è –±—É–¥–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ —Ç—É–¥–∏, –∫—É–¥–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∫–∞–∑–∞–≤** —É —Ü—å–æ–º—É –≤–∫–∞–∑—ñ–≤–Ω–∏–∫—É.

–û–¥–Ω–∞–∫ —É —ñ–Ω—à–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö –º–æ–∂–ª–∏–≤–æ, —â–æ –ø—Ä–æ—Å—Ç–æ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å –∑–Ω–∞—á–µ–Ω—å –¥–µ—è–∫–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö –≤ —Å—Ç–µ—Ü—ñ** –±—É–¥–µ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤ –ø—Ä–æ—Å—Ç–∏—Ö –∑–∞–≤–¥–∞–Ω–Ω—è—Ö CTF).

### Ret2win

–£ —Ü—å–æ–º—É —Ç–∏–ø—ñ –∑–∞–≤–¥–∞–Ω—å CTF —î **—Ñ—É–Ω–∫—Ü—ñ—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ** –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É, —è–∫–∞ **–Ω—ñ–∫–æ–ª–∏ –Ω–µ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è**, —ñ **–≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —ó—ó –≤–∏–∫–ª–∏–∫–∞—Ç–∏, —â–æ–± –ø–µ—Ä–µ–º–æ–≥—Ç–∏**. –î–ª—è —Ü–∏—Ö –∑–∞–≤–¥–∞–Ω—å –≤–∞–º –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ **–∑—Å—É–≤ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É EIP** —Ç–∞ **–∑–Ω–∞–π—Ç–∏ –∞–¥—Ä–µ—Å—É —Ñ—É–Ω–∫—Ü—ñ—ó**, —è–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ (–∑–∞–∑–≤–∏—á–∞–π [**ASLR**](../common-binary-protections/aslr.md) –±—É–¥–µ –≤–∏–º–∫–Ω–µ–Ω–æ), —â–æ–± –ø—Ä–∏ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó –±—É–ª–∞ –≤–∏–∫–ª–∏–∫–∞–Ω–∞ —Å—Ö–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è:

{% content-ref url="ret2win.md" %}
[ret2win.md](ret2win.md)
{% endcontent-ref %}

### Ret2Shellcode

## –¢–∏–ø–∏ –∑–∞—Ö–∏—Å—Ç—É

{% content-ref url="../common-binary-protections/" %}
[common-binary-protections](../common-binary-protections/)
{% endcontent-ref %}

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ **—Ä–µ–∫–ª–∞–º—É –≤–∞—à–æ—ó –∫–æ–º–ø–∞–Ω—ñ—ó –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –î—ñ–∑–Ω–∞–π—Ç–µ—Å—è –ø—Ä–æ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ –≥—Ä—É–ø–∏ [**telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>
