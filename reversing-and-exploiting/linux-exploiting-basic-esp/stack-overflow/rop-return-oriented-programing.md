# ROP - Return Oriented Programing

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –î—ñ–∑–Ω–∞–π—Ç–µ—Å—è –ø—Ä–æ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—Ç–∞** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤**.

</details>

## **–û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è**

**Return-Oriented Programming (ROP)** - —Ü–µ –≤–∏—Å–æ–∫–æ—Ä—ñ–≤–Ω–µ–≤–∞ —Ç–µ—Ö–Ω—ñ–∫–∞ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –æ–±—Ö–æ–¥—É –∑–∞—Ö–æ–¥—ñ–≤ –±–µ–∑–ø–µ–∫–∏, —Ç–∞–∫–∏—Ö —è–∫ **No-Execute (NX)** –∞–±–æ **Data Execution Prevention (DEP)**. –ó–∞–º—ñ—Å—Ç—å –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è shellcode, –∞—Ç–∞–∫—É—é—á–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —à–º–∞—Ç–∫–∏ –∫–æ–¥—É, —è–∫—ñ –≤–∂–µ –ø—Ä–∏—Å—É—Ç–Ω—ñ –≤ –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞—Ö, –≤—ñ–¥–æ–º—ñ —è–∫ **"–≥–∞–¥–∂–µ—Ç–∏"**. –ö–æ–∂–µ–Ω –≥–∞–¥–∂–µ—Ç –∑–∞–∑–≤–∏—á–∞–π –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—î—é `ret` —Ç–∞ –≤–∏–∫–æ–Ω—É—î –Ω–µ–≤–µ–ª–∏–∫—É –æ–ø–µ—Ä–∞—Ü—ñ—é, —Ç–∞–∫—É —è–∫ –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –º—ñ–∂ —Ä–µ–≥—ñ—Å—Ç—Ä–∞–º–∏ –∞–±–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π. –ó'—î–¥–Ω–∞–≤—à–∏ —Ü—ñ –≥–∞–¥–∂–µ—Ç–∏, –∞—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ —Å–∫–ª–∞—Å—Ç–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ö–æ–¥—è—á–∏ –∑–∞—Ö–∏—Å—Ç NX/DEP.

### –ö–æ–Ω–≤–µ–Ω—Ü—ñ—ó –≤–∏–∫–ª–∏–∫—É

–†–æ–∑—É–º—ñ–Ω–Ω—è **–∫–æ–Ω–≤–µ–Ω—Ü—ñ–π –≤–∏–∫–ª–∏–∫—É** —î –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—Ö –ª–∞–Ω—Ü—é–∂–∫—ñ–≤ ROP, –æ—Å–æ–±–ª–∏–≤–æ –ø—Ä–∏ –≤–∏–∫–ª–∏–∫—É —Ñ—É–Ω–∫—Ü—ñ–π –∞–±–æ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—ñ –¥–∞–Ω–∏–º–∏:

**x86 (32-–±—ñ—Ç)**

* **cdecl**: –í–∏–∫–ª–∏–∫–∞—é—á–∏–π –æ—á–∏—â–∞—î —Å—Ç–µ–∫. –ê—Ä–≥—É–º–µ–Ω—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–π –≤–∏—Ç–∞–ª—é—é—Ç—å—Å—è –Ω–∞ —Å—Ç–µ–∫ —É –∑–≤–æ—Ä–æ—Ç–Ω—å–æ–º—É –ø–æ—Ä—è–¥–∫—É (—Å–ø—Ä–∞–≤–∞ –Ω–∞–ª—ñ–≤–æ). **–ê—Ä–≥—É–º–µ–Ω—Ç–∏ –≤–∏—Ç–∞–ª—é—é—Ç—å—Å—è –Ω–∞ —Å—Ç–µ–∫ –∑–ø—Ä–∞–≤–∞ –Ω–∞–ª—ñ–≤–æ.**
* **stdcall**: –°—Ö–æ–∂–µ –Ω–∞ cdecl, –∞–ª–µ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å –∑–∞ –æ—á–∏—â–µ–Ω–Ω—è —Å—Ç–µ–∫—É.

**x64 (64-–±—ñ—Ç)**

* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫–æ–Ω–≤–µ–Ω—Ü—ñ—é –≤–∏–∫–ª–∏–∫—É **System V AMD64 ABI** –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ö, –ø–æ–¥—ñ–±–Ω–∏—Ö –¥–æ Unix, –¥–µ **–ø–µ—Ä—à—ñ —à—ñ—Å—Ç—å —Ü—ñ–ª–∏—Ö –∞–±–æ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–æ–≤–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è –≤ —Ä–µ–≥—ñ—Å—Ç—Ä–∏ `RDI`, `RSI`, `RDX`, `RCX`, `R8` —Ç–∞ `R9`**. –î–æ–¥–∞—Ç–∫–æ–≤—ñ –∞—Ä–≥—É–º–µ–Ω—Ç–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è –Ω–∞ —Å—Ç–µ–∫—É. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –≤ `RAX`.
* –ö–æ–Ω–≤–µ–Ω—Ü—ñ—è –≤–∏–∫–ª–∏–∫—É **Windows x64** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `RCX`, `RDX`, `R8` —Ç–∞ `R9` –¥–ª—è –ø–µ—Ä—à–∏—Ö —á–æ—Ç–∏—Ä—å–æ—Ö —Ü—ñ–ª–∏—Ö –∞–±–æ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–æ–≤–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤, –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∞—Ä–≥—É–º–µ–Ω—Ç–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è –Ω–∞ —Å—Ç–µ–∫—É. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –≤ `RAX`.
* **–†–µ–≥—ñ—Å—Ç—Ä–∏**: 64-–±—ñ—Ç–Ω—ñ —Ä–µ–≥—ñ—Å—Ç—Ä–∏ –≤–∫–ª—é—á–∞—é—Ç—å `RAX`, `RBX`, `RCX`, `RDX`, `RSI`, `RDI`, `RBP`, `RSP` —Ç–∞ `R8` –¥–æ `R15`.

{% hint style="danger" %}
–ó —Ü–∏—Ö –∫–æ–Ω–≤–µ–Ω—Ü—ñ–π –≤–∏–∫–ª–∏–∫—É –º–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ –≤ **32 –±—ñ—Ç–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∏** –¥–æ —Ñ—É–Ω–∫—Ü—ñ–π **–ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è —á–µ—Ä–µ–∑ —Å—Ç–µ–∫**, —Ç–æ–¥—ñ —è–∫ –≤ **x64** –≤–æ–Ω–∏ **—Ä–æ–∑–º—ñ—â—É—é—Ç—å—Å—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —Ä–µ–≥—ñ—Å—Ç—Ä–∞—Ö**.
{% endhint %}

### –Ø–∫ –ø—Ä–∞—Ü—é—î ROP

1. **–ü–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –ø–æ—Ç–æ–∫—É –∫–µ—Ä—É–≤–∞–Ω–Ω—è**: –°–ø–æ—á–∞—Ç–∫—É –∞—Ç–∞–∫—É—é—á–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ—Ö–æ–ø–∏—Ç–∏ –ø–æ—Ç—ñ–∫ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º–∏, –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è –±—É—Ñ–µ—Ä–∞ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –∑–±–µ—Ä–µ–∂–µ–Ω–æ—ó –∞–¥—Ä–µ—Å–∏ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –Ω–∞ —Å—Ç–µ–∫—É.
2. **–õ–∞–Ω—Ü—é–∂–æ–∫ –≥–∞–¥–∂–µ—Ç—ñ–≤**: –ü–æ—Ç—ñ–º –∞—Ç–∞–∫—É—é—á–∏–π —É–≤–∞–∂–Ω–æ –≤–∏–±–∏—Ä–∞—î —Ç–∞ –∑'—î–¥–Ω—É—î –≥–∞–¥–∂–µ—Ç–∏ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –±–∞–∂–∞–Ω–∏—Ö –¥—ñ–π. –¶–µ –º–æ–∂–µ –≤–∫–ª—é—á–∞—Ç–∏ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫—É –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ –¥–ª—è –≤–∏–∫–ª–∏–∫—É —Ñ—É–Ω–∫—Ü—ñ—ó, –≤–∏–∫–ª–∏–∫ —Ñ—É–Ω–∫—Ü—ñ—ó (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `system("/bin/sh")`), —Ç–∞ –æ–±—Ä–æ–±–∫—É –±—É–¥—å-—è–∫–∏—Ö –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –∑–∞–≤–µ—Ä—à–∞–ª—å–Ω–∏—Ö –∞–±–æ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π.
3. **–í–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è**: –ö–æ–ª–∏ –≤—Ä–∞–∑–ª–∏–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è, –∑–∞–º—ñ—Å—Ç—å –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ –∑–∞–∫–æ–Ω–Ω–æ–≥–æ –º—ñ—Å—Ü—è –≤–æ–Ω–∞ –ø–æ—á–∏–Ω–∞—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –ª–∞–Ω—Ü—é–∂–æ–∫ –≥–∞–¥–∂–µ—Ç—ñ–≤.

### –õ–∞–Ω—Ü—é–∂–æ–∫ ROP –≤ x86

–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ –≥—ñ–ø–æ—Ç–µ—Ç–∏—á–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π, –¥–µ –º–∏ —Ö–æ—á–µ–º–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ `system("/bin/sh")` –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ROP —É 32-–±—ñ—Ç–Ω–æ–º—É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ:

1. **–ü–æ—à—É–∫ –≥–∞–¥–∂–µ—Ç—ñ–≤**: –ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, —â–æ –º–∏ –∑–Ω–∞–π—à–ª–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –≥–∞–¥–∂–µ—Ç–∏ –≤ –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞—Ö:
* `pop eax; ret`: –í–∏–¥–∞–ª—è—î –≤–µ—Ä—Ö–Ω—ñ–π –µ–ª–µ–º–µ–Ω—Ç —Å—Ç–µ–∫—É –≤ `EAX` —Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è.
* `pop ebx; ret`: –í–∏–¥–∞–ª—è—î –≤–µ—Ä—Ö–Ω—ñ–π –µ–ª–µ–º–µ–Ω—Ç —Å—Ç–µ–∫—É –≤ `EAX` —Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è.
* `mov [ebx], eax; ret`: –ü–µ—Ä–µ–º—ñ—â—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑ `EAX` –≤ –º—ñ—Å—Ü–µ, –Ω–∞ —è–∫–µ –≤–∫–∞–∑—É—î `EBX`.
* –ê–¥—Ä–µ—Å–∞ `system`.
2. **–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –ª–∞–Ω—Ü—é–∂–∫–∞**: –ù–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ —Å—Ç–µ–∫, —è–∫–∏–π –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:
* –ê–¥—Ä–µ—Å–∞ –≥–∞–¥–∂–µ—Ç–∞, —è–∫–∏–π –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î `EBX`.
* –ê–¥—Ä–µ—Å–∞ –≥–∞–¥–∂–µ—Ç–∞ `pop eax; ret`.
* –ê–¥—Ä–µ—Å–∞ —Ä—è–¥–∫–∞ `"/bin/sh"` –≤ –ø–∞–º'—è—Ç—ñ (–∞–±–æ —Ç–∞–º, –¥–µ –º–∏ –ø–ª–∞–Ω—É—î–º–æ –∑–∞–ø–∏—Å–∞—Ç–∏ –π–æ–≥–æ).
* –ê–¥—Ä–µ—Å–∞ –≥–∞–¥–∂–µ—Ç–∞ `mov [ebx], eax; ret`, —â–æ–± –ø–µ—Ä–µ–º—ñ—Å—Ç–∏—Ç–∏ `"/bin/sh"` –≤ –º—ñ—Å—Ü–µ, –Ω–∞ —è–∫–µ –≤–∫–∞–∑—É—î `EBX`.
* –ê–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü—ñ—ó `system`, –∑ `EBX` –≤–∫–∞–∑—É—é—á–∏ –Ω–∞—à —Ä—è–¥–æ–∫.
3. **–í–∏–∫–æ–Ω–∞–Ω–Ω—è**: –ö–æ–ª–∏ –≤—Ä–∞–∑–ª–∏–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è, –≤–æ–Ω–∞ –ø–æ—á–∏–Ω–∞—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –Ω–∞—à –ª–∞–Ω—Ü—é–∂–æ–∫ –≥–∞–¥–∂–µ—Ç—ñ–≤, –≤ –∫—ñ–Ω—Ü–µ–≤–æ–º—É –ø—ñ–¥—Å—É–º–∫—É –≤–∏–∫–ª–∏–∫–∞—é—á–∏ `system("/bin/sh")` —Ç–∞ –≤—ñ–¥–∫—Ä–∏–≤–∞—é—á–∏ –æ–±–æ–ª–æ–Ω–∫—É.

### ROP –≤ x64

–†–æ–∑–≥–ª—è–Ω–µ–º–æ –≥—ñ–ø–æ—Ç–µ—Ç–∏—á–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π, –¥–µ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ `execve("/bin/sh", NULL, NULL)` –Ω–∞ —Å–∏—Å—Ç–µ–º—ñ x64 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–Ω–≤–µ–Ω—Ü—ñ—ó –≤–∏–∫–ª–∏–∫—É System V AMD64 ABI:

1. **–ü–æ—à—É–∫ –≥–∞–¥–∂–µ—Ç—ñ–≤**: –°–ø–æ—á–∞—Ç–∫—É –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ –≥–∞–¥–∂–µ—Ç–∏, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—Ç—å –≤–∞–º –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ —Ä–µ–≥—ñ—Å—Ç—Ä–∏ `RDI`, `RSI` —Ç–∞ `RDX`, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –±—É–¥—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∏ –¥–ª—è `execve`.
2. **–ü–æ–±—É–¥–æ–≤–∞ –ª–∞–Ω—Ü—é–∂–∫–∞**:
* **–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ `RDI` –¥–ª—è –≤–∫–∞–∑—ñ–≤–∫–∏ –Ω–∞ —Ä—è–¥–æ–∫ `"/bin/sh"`**: –ó–∞–∑–≤–∏—á–∞–π —Ü–µ —Ä–æ–±–∏—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≥–∞–¥–∂–µ—Ç–∞ `pop RDI; ret`, –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—î –∞–¥—Ä–µ—Å–∞ —Ä—è–¥–∫–∞ (—è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ —Ä–æ–∑–º—ñ—â–µ–Ω–∏–π —É –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –∞–±–æ –∑–Ω–∞–π–¥–µ–Ω–∏–π –≤ –ø–∞–º'—è—Ç—ñ).
* **–û–±–Ω—É–ª–∏—Ç–∏ `RSI` —Ç–∞ `RDX`**: –û—Å–∫—ñ–ª—å–∫–∏ –¥—Ä—É–≥–∏–π —ñ —Ç—Ä–µ—Ç—ñ–π –∞—Ä–≥—É–º–µ–Ω—Ç–∏ –¥–ª—è `execve` —î `NULL`, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω—ñ –≥–∞–¥–∂–µ—Ç–∏ –¥–ª—è –æ–±–Ω—É–ª–µ–Ω–Ω—è —Ü–∏—Ö —Ä–µ–≥—ñ—Å—Ç—Ä—ñ–≤, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `xor RSI, RSI; ret` —Ç–∞ `xor RDX, RDX; ret`.
* **–í–∏–∫–ª–∏–∫–∞—Ç–∏ `execve`**: –ù–∞—Ä–µ—à—Ç—ñ, –ø–æ—Ç—Ä—ñ–±–µ–Ω –≥–∞–¥–∂–µ—Ç, —è–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –¥–æ `execve` (–∞–±–æ –≤–∏–∫–ª–∏–∫–∞—î –π–æ–≥–æ –æ–ø–æ—Å–µ—Ä–µ–¥–∫–æ–≤–∞–Ω–æ).
3. **–í–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è**: –ü—ñ—Å–ª—è –ø–æ–±—É–¥–æ–≤–∏ —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Ü—å–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ –≤—Ä–∞–∑–ª–∏–≤–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏, –ª–∞–Ω—Ü—é–∂–æ–∫ ROP –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è, —Å—Ç–≤–æ—Ä—é—é—á–∏ –æ–±–æ–ª–æ–Ω–∫—É.

–û—Å–∫—ñ–ª—å–∫–∏ x64 –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ä–µ–≥—ñ—Å—Ç—Ä–∏ –¥–ª—è –ø–µ—Ä—à–∏—Ö –∫—ñ–ª—å–∫–æ—Ö –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤, —á–∞—Å—Ç–æ –≤—ñ–Ω –ø–æ—Ç—Ä–µ–±—É—î –º–µ–Ω—à–µ –≥–∞–¥–∂–µ—Ç—ñ–≤, –Ω—ñ–∂ x86 –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö –≤–∏–∫–ª–∏–∫—ñ–≤ —Ñ—É–Ω–∫—Ü—ñ–π, –∞–ª–µ –ø–æ—à—É–∫ —Ç–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –≥–∞–¥–∂–µ—Ç—ñ–≤ –º–æ–∂–µ –±—É—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ—à–∏–º —á–µ—Ä–µ–∑ –∑–±—ñ–ª—å—à–µ–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–µ–≥—ñ—Å—Ç—Ä—ñ–≤ —Ç–∞ –±—ñ–ª—å—à–∏–π –∞–¥—Ä–µ—Å–Ω–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä. –ó–±—ñ–ª—å—à–µ–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–µ–≥—ñ—Å—Ç—Ä—ñ–≤ —Ç–∞ –±—ñ–ª—å—à–∏–π –∞–¥—Ä–µ—Å–Ω–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä —É **x64** –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—ñ –Ω–∞–¥–∞—é—Ç—å —è–∫ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ, —Ç–∞–∫ —ñ –≤–∏–∫–ª–∏–∫–∏ –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏ –µ–∫—Å–ø–ª–æ–π—Ç—ñ–≤, –æ—Å–æ–±–ª–∏–≤–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ Return-Oriented Programming (ROP).

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –î—ñ–∑–Ω–∞–π—Ç–µ—Å—è –ø—Ä–æ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—Ç–∞** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤**.

</details>
