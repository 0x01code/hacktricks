# Ret2ret & Ret2pop

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## Ret2ret

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдореБрдЦреНрдп рдЙрджреНрджреЗрд╢реНрдп рд╣реИ **рд╕реНрдЯреИрдХ рдореЗрдВ рдореМрдЬреВрдж рдПрдХ рдореМрдЬреВрджрд╛ рдкреЙрдЗрдВрдЯрд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ ASLR рдХреЛ рдЫрд▓рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛**ред

рдореВрд▓ рд░реВрдк рд╕реЗ, рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ рдЖрдо рддреМрд░ рдкрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рджреНрд╡рд╛рд░рд╛ рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ **рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЗ рдЕрдВрдд рдореЗрдВ рдореЗрдореЛрд░реА рдореЗрдВ рдПрдХ рдирд▓ рдмрд╛рдЗрдЯ рд╣реЛрддрд╛ рд╣реИ**ред рдпрд╣ рдПрдХ рдореМрдЬреВрджрд╛ рдкреЙрдЗрдВрдЯрд░ рджреНрд╡рд╛рд░рд╛ рдкреЙрдЗрдВрдЯ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕реНрдерд╛рди рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рд╕реНрдЯреИрдХ рдореЗрдВ `0xbfffffdd` рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдУрд╡рд░рдлреНрд▓реЛ рдЗрд╕реЗ `0xbfffff00` рдореЗрдВ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ (рдЕрдВрддрд┐рдо рдЬрд╝реАрд░реЛ рдмрд╛рдЗрдЯ рдХрд╛ рдзреНрдпрд╛рди рджреЗрдВ)ред

рдпрджрд┐ рд╡рд╣ рдкрддрд╛ рд╣рдорд╛рд░реЗ рд╢реЗрд▓рдХреЛрдб рдХреЛ рд╕реНрдЯреИрдХ рдореЗрдВ рдкреЙрдЗрдВрдЯ рдХрд░рддрд╛ рд╣реИ, рддреЛ **`ret` рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдореЗрдВ рдкрддреЗ рдЬреЛрдбрд╝рдХрд░** рдЗрд╕реЗ рдкрд╣реБрдВрдЪрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдЬрдм рддрдХ рдпрд╣ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛рдПред

рдЗрд╕рд▓рд┐рдП рд╣рдорд▓рд╛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реЛрдЧрд╛:

* NOP sled
* рд╢реЗрд▓рдХреЛрдб
* EIP рд╕реЗ рд╕реНрдЯреИрдХ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░реЗрдВ **`ret` рдХреЗ рдкрддреЛрдВ рдХреЗ рд╕рд╛рде** (RET sled)
* рд╕реНрдЯреНрд░рд┐рдВрдЧ рджреНрд╡рд╛рд░рд╛ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ 0x00, рд╕реНрдЯреИрдХ рд╕реЗ рдПрдХ рдкрддреЗ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдЗрд╕реЗ NOP sled рдкрд░ рдкреЙрдЗрдВрдЯ рдХрд░рдирд╛

[**рдЗрд╕ рд▓рд┐рдВрдХ**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2ret.c) рдкрд░ рдЖрдк рдПрдХ рд╡рдВрд▓рд░реЗрдмрд▓ рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ [**рдЗрд╕рдореЗрдВ**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2retexploit.c) рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

## Ret2pop

рдпрджрд┐ рдЖрдк рд╕реНрдЯреИрдХ рдореЗрдВ **рдПрдХ рдкреВрд░реНрдг рдкреЙрдЗрдВрдЯрд░ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рдЖрдк рд╕рдВрд╢реЛрдзрд┐рдд рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ** (ret2ret рдореЗрдВ рд╣рдордиреЗ рдЕрдВрддрд┐рдо рд╕рдмрд╕реЗ рдХрдо рдмрд╛рдЗрдЯ рдХреЛ `0x00` рдореЗрдВ рдмрджрд▓ рджрд┐рдпрд╛), рддреЛ рдЖрдк **рдПрдХ рд╣реА `ret2ret` рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди RET sled рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ 1 рд╕реЗ рдХрдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛** (рддрд╛рдХрд┐ рдЕрдВрддрд┐рдо `0x00` рд╕рд╣реА рдкреЙрдЗрдВрдЯрд░ рд╕реЗ рдкрд╣рд▓реЗ рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░реЗ), рдФрд░ **RET sled рдХрд╛ рдЕрдВрддрд┐рдо** рдкрддрд╛ **`pop <reg>; ret`** рдХреЛ рдкреЙрдЗрдВрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред\
рдЗрд╕ рдкреНрд░рдХрд╛рд░, **рдкреВрд░реНрдг рдкреЙрдЗрдВрдЯрд░ рд╕реЗ рдкрд╣рд▓реЗ рдХрд╛ рдбреЗрдЯрд╛ рд╕реНрдЯреИрдХ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛** (рдпрд╣ `0x00` рджреНрд╡рд╛рд░рд╛ рдкреНрд░рднрд╛рд╡рд┐рдд рдбреЗрдЯрд╛ рд╣реИ) рдФрд░ **рдЕрдВрддрд┐рдо `ret` рд╕реНрдЯреИрдХ рдореЗрдВ рдХрд┐рд╕реА рднреА рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рдмрд┐рдирд╛ рд╕рд╣реА рдкрддреЗ рдкрд░ рдкреЙрдЗрдВрдЯ рдХрд░реЗрдЧрд╛**ред

[**рдЗрд╕ рд▓рд┐рдВрдХ**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2pop.c) рдкрд░ рдЖрдк рдПрдХ рд╡рдВрд▓рд░реЗрдмрд▓ рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ [**рдЗрд╕рдореЗрдВ**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2popexploit.c) рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

## рд╕рдВрджрд░реНрдн

* [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
