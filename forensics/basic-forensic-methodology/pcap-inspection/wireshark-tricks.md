# Wireshark рдЯреНрд░рд┐рдХреНрд╕

## Wireshark рдЯреНрд░рд┐рдХреНрд╕

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХрд▓ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

## рдЕрдкрдиреА Wireshark рдХреМрд╢рд▓ рдХреЛ рд╕реБрдзрд╛рд░реЗрдВ

### рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреБрдЫ рд╢рд╛рдирджрд╛рд░ рдореВрд▓рднреВрдд рдЯреНрд░рд┐рдХреНрд╕ рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВ:

* [https://unit42.paloaltonetworks.com/unit42-customizing-wireshark-changing-column-display/](https://unit42.paloaltonetworks.com/unit42-customizing-wireshark-changing-column-display/)
* [https://unit42.paloaltonetworks.com/using-wireshark-display-filter-expressions/](https://unit42.paloaltonetworks.com/using-wireshark-display-filter-expressions/)
* [https://unit42.paloaltonetworks.com/using-wireshark-identifying-hosts-and-users/](https://unit42.paloaltonetworks.com/using-wireshark-identifying-hosts-and-users/)
* [https://unit42.paloaltonetworks.com/using-wireshark-exporting-objects-from-a-pcap/](https://unit42.paloaltonetworks.com/using-wireshark-exporting-objects-from-a-pcap/)

### рд╡рд┐рд╢реНрд▓реЗрд╖рд┐рдд рдЬрд╛рдирдХрд╛рд░реА

**рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рдЬрд╛рдирдХрд╛рд░реА**

_**рд╡рд┐рд╢реНрд▓реЗрд╖рдг** --> **рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рдЬрд╛рдирдХрд╛рд░реА**_ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдЖрдкрдХреЛ рдкреИрдХреЗрдЯреНрд╕ рдореЗрдВ рдХреНрдпрд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИ рдХрд╛ **рдЕрд╡рд▓реЛрдХрди** рдорд┐рд▓реЗрдЧрд╛:

![](<../../../.gitbook/assets/image (570).png>)

**рд╕рдВрдХрд▓рд┐рдд рдкрддреЗ**

_**рдЖрдБрдХрдбрд╝реЗ --> рд╕рдВрдХрд▓рд┐рдд рдкрддреЗ**_ рдХреЗ рддрд╣рдд рдЖрдкрдХреЛ рд╡рд┐рднрд┐рдиреНрди **рдЬрд╛рдирдХрд╛рд░реА** рдорд┐рд▓реЗрдЧреА рдЬреЛ wireshark рджреНрд╡рд╛рд░рд╛ "**рд╕рдВрдХрд▓рд┐рдд**" рдХреА рдЧрдИ рд╣реИ, рдЬреИрд╕реЗ рдкреЛрд░реНрдЯ/рдЯреНрд░рд╛рдВрд╕рдкреЛрд░реНрдЯ рд╕реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓, MAC рд╕реЗ рдирд┐рд░реНрдорд╛рддрд╛ рдЖрджрд┐ред рд╕рдВрдЪрд╛рд░ рдореЗрдВ рдХреНрдпрд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЗрд╕реЗ рдЬрд╛рдирдирд╛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛрддрд╛ рд╣реИред

![](<../../../.gitbook/assets/image (571).png>)

**рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╡реНрдпрд╡рд╕реНрдерд╛**

_**рдЖрдБрдХрдбрд╝реЗ --> рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╡реНрдпрд╡рд╕реНрдерд╛**_ рдХреЗ рддрд╣рдд рдЖрдкрдХреЛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ **рдкреНрд░реЛрдЯреЛрдХреЙрд▓** рдорд┐рд▓реЗрдВрдЧреЗ рдФрд░ рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ред

![](<../../../.gitbook/assets/image (572).png>)

**рдмрд╛рддрдЪреАрддреЗрдВ**

_**рдЖрдБрдХрдбрд╝реЗ --> рдмрд╛рддрдЪреАрддреЗрдВ**_ рдХреЗ рддрд╣рдд рдЖрдкрдХреЛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рд╣реЛ рд░рд╣реА рдмрд╛рддрдЪреАрддреЛрдВ рдХрд╛ **рд╕рд╛рд░рд╛рдВрд╢** рдФрд░ рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдорд┐рд▓реЗрдЧрд╛ред

![](<../../../.gitbook/assets/image (573).png>)

**рдЕрдВрдд-рдмрд┐рдВрджреБ**

_**рдЖрдБрдХрдбрд╝реЗ --> рдЕрдВрдд-рдмрд┐рдВрджреБ**_ рдХреЗ рддрд╣рдд рдЖрдкрдХреЛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ **рдЕрдВрдд-рдмрд┐рдВрджреБ** рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдмрд┐рдВрджреБ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдорд┐рд▓реЗрдЧрд╛ред

![](<../../../.gitbook/assets/image (575).png>)

**DNS рдЬрд╛рдирдХрд╛рд░реА**

_**рдЖрдБрдХрдбрд╝реЗ --> DNS**_ рдХреЗ рддрд╣рдд рдЖрдкрдХреЛ DNS рдЕрдиреБрд░реЛрдз рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЖрдБрдХрдбрд╝реЗ рдорд┐рд▓реЗрдВрдЧреЗред

![](<../../../.gitbook/assets/image (577).png>)

**I/O рдЧреНрд░рд╛рдл**

_**рдЖрдБрдХрдбрд╝реЗ --> I/O рдЧреНрд░рд╛рдл**_ рдХреЗ рддрд╣рдд рдЖрдкрдХреЛ рд╕рдВрдЪрд╛рд░ рдХрд╛ **рдЧреНрд░рд╛рдл** рдорд┐рд▓реЗрдЧрд╛ред

![](<../../../.gitbook/assets/image (574).png>)

### рдлрд╝рд┐рд▓реНрдЯрд░

рдпрд╣рд╛рдВ рдЖрдкрдХреЛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ wireshark рдлрд╝рд┐рд▓реНрдЯрд░ рдорд┐рд▓реЗрдВрдЧреЗ: [https://www.wireshark.org/docs/dfref/](https://www.wireshark.org/docs/dfref/)\
рдЕрдиреНрдп рджрд┐рд▓рдЪрд╕реНрдк рдлрд╝рд┐рд▓реНрдЯрд░:

* `(http.request or ssl.handshake.type == 1) and !(udp.port eq 1900)`
* HTTP рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTPS рдЯреНрд░реИрдлрд╝рд┐рдХ
* `(http.request or ssl.handshake.type == 1 or tcp.flags eq 0x0002) and !(udp.port eq 1900)`
* HTTP рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTPS рдЯреНрд░реИрдлрд╝рд┐рдХ + TCP SYN
* `(http.request or ssl.handshake.type == 1 or tcp.flags eq 0x0002 or dns) and !(udp.port eq 1900)`
* HTTP рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTPS рдЯреНрд░реИрдлрд╝рд┐рдХ + TCP SYN + DNS рдЕрдиреБрд░реЛрдз

### рдЦреЛрдЬ

рдпрджрд┐ рдЖрдк рд╕рддреНрд░реЛрдВ рдХреЗ рдкреИрдХреЗрдЯреНрд╕ рдореЗрдВ **рд╕рд╛рдордЧреНрд░реА** рдХреА **рдЦреЛрдЬ** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ _CTRL+f_ рджрдмрд╛рдПрдВред рдЖрдк рдореБрдЦреНрдп рдЬрд╛рдирдХрд╛рд░реА рдкрдЯ
## рд╕реНрдерд╛рдиреАрдп рд╣реЛрд╕реНрдЯрдиреЗрдо рдХреА рдкрд╣рдЪрд╛рди

### DHCP рд╕реЗ

рд╡рд░реНрддрдорд╛рди Wireshark рдореЗрдВ `bootp` рдХреА рдмрдЬрд╛рдп `DHCP` рдХреА рдЦреЛрдЬ рдХрд░рдиреА рд╣реЛрдЧреА

![](<../../../.gitbook/assets/image (404).png>)

### NBNS рд╕реЗ

![](<../../../.gitbook/assets/image (405).png>)

## TLS рдХреА рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди

### рд╕рд░реНрд╡рд░ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде https рдЯреНрд░реИрдлрд┐рдХ рдХреА рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди

_edit>preference>protocol>ssl>_

![](<../../../.gitbook/assets/image (98).png>)

_Edit_ рджрдмрд╛рдПрдВ рдФрд░ рд╕рд░реНрд╡рд░ рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рднреА рдбреЗрдЯрд╛ рдХреЛ рдЬреЛрдбрд╝реЗрдВ (_IP, рдкреЛрд░реНрдЯ, рдкреНрд░реЛрдЯреЛрдХреЙрд▓, рдХреБрдВрдЬреА рдлрд╝рд╛рдЗрд▓ рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб_)

### рд╕рдорд╛рдирд╛рдВрддрд░ рд╕рддреНрд░ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде https рдЯреНрд░реИрдлрд┐рдХ рдХреА рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди

рдпрд╣ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ Firefox рдФрд░ Chrome рджреЛрдиреЛрдВ TLS рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕рдорд╛рдирд╛рдВрддрд░ рд╕рддреНрд░ рдХреБрдВрдЬреА рдХреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓реЙрдЧ рдХрд░рдиреЗ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВред рдлрд┐рд░ рдЖрдк Wireshark рдХреЛ рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдкрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЪреМрдВрдХрд╛рдиреЗ рд╡рд╛рд▓реА рдмрд╛рдд! рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ TLS рдЯреНрд░реИрдлрд┐рдХред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП: [https://redflagsecurity.net/2019/03/10/decrypting-tls-wireshark/](https://redflagsecurity.net/2019/03/10/decrypting-tls-wireshark/)\
рдЗрд╕реЗ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ `SSLKEYLOGFILE` рдЪрд░ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдВ

рд╕рд╛рдЭрд╛ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреА рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдЧреА:

![](<../../../.gitbook/assets/image (99).png>)

Wireshark рдореЗрдВ рдЗрд╕реЗ рдЖрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП \_edit > preference > protocol > ssl > рдЬрд╛рдПрдВ рдФрд░ рдЗрд╕реЗ (Pre)-Master-Secret log filename рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВ:

![](<../../../.gitbook/assets/image (100).png>)

## ADB рд╕рдВрдЪрд╛рд░

ADB рд╕рдВрдЪрд╛рд░ рд╕реЗ рдПрдХ APK рдирд┐рдХрд╛рд▓реЗрдВ рдЬрд╣рд╛рдВ APK рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛:
```python
from scapy.all import *

pcap = rdpcap("final2.pcapng")

def rm_data(data):
splitted = data.split(b"DATA")
if len(splitted) == 1:
return data
else:
return splitted[0]+splitted[1][4:]

all_bytes = b""
for pkt in pcap:
if Raw in pkt:
a = pkt[Raw]
if b"WRTE" == bytes(a)[:4]:
all_bytes += rm_data(bytes(a)[24:])
else:
all_bytes += rm_data(bytes(a))
print(all_bytes)

f = open('all_bytes.data', 'w+b')
f.write(all_bytes)
f.close()
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдиреЗ рдХреА рдЙрдкрд▓рдмреНрдзрддрд╛ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>
