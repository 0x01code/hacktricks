# Wireshark рдЯреНрд░рд┐рдХреНрд╕

## Wireshark рдЯреНрд░рд┐рдХреНрд╕

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реБрд░реБрдЖрдд рд╕реЗ рд▓реЗрдХрд░ рдПрдХреНрд╕рдкрд░реНрдЯ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>

## рдЕрдкрдиреЗ Wireshark рдХреМрд╢рд▓ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░реЗрдВ

### рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓реНрд╕

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓реНрд╕ рдХреБрдЫ рдмреЗрд╕рд┐рдХ рдЯреНрд░рд┐рдХреНрд╕ рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрджреНрднреБрдд рд╣реИрдВ:

* [https://unit42.paloaltonetworks.com/unit42-customizing-wireshark-changing-column-display/](https://unit42.paloaltonetworks.com/unit42-customizing-wireshark-changing-column-display/)
* [https://unit42.paloaltonetworks.com/using-wireshark-display-filter-expressions/](https://unit42.paloaltonetworks.com/using-wireshark-display-filter-expressions/)
* [https://unit42.paloaltonetworks.com/using-wireshark-identifying-hosts-and-users/](https://unit42.paloaltonetworks.com/using-wireshark-identifying-hosts-and-users/)
* [https://unit42.paloaltonetworks.com/using-wireshark-exporting-objects-from-a-pcap/](https://unit42.paloaltonetworks.com/using-wireshark-exporting-objects-from-a-pcap/)

### рд╡рд┐рд╢реНрд▓реЗрд╖рд┐рдд рдЬрд╛рдирдХрд╛рд░реА

**рдПрдХреНрд╕рдкрд░реНрдЯ рдЬрд╛рдирдХрд╛рд░реА**

_**Analyze** --> **Expert Information**_ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рд╕реЗ рдЖрдкрдХреЛ рдкреИрдХреЗрдЯреНрд╕ рдореЗрдВ рд╣реЛ рд░рд╣реА рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ **рдЕрд╡рд▓реЛрдХрди** рдорд┐рд▓реЗрдЧрд╛:

![](<../../../.gitbook/assets/image (570).png>)

**Resolved Addresses**

_**Statistics --> Resolved Addresses**_ рдХреЗ рдЕрдВрддрд░реНрдЧрдд рдЖрдкрдХреЛ Wireshark рджреНрд╡рд╛рд░рд╛ "**resolved**" рдХреА рдЧрдИ рдХрдИ **рдЬрд╛рдирдХрд╛рд░рд┐рдпрд╛рдВ** рдорд┐рд▓реЗрдВрдЧреА рдЬреИрд╕реЗ рдХрд┐ рдкреЛрд░реНрдЯ/рдЯреНрд░рд╛рдВрд╕рдкреЛрд░реНрдЯ рд╕реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓, MAC рд╕реЗ рдирд┐рд░реНрдорд╛рддрд╛ рдЖрджрд┐ред рдпрд╣ рдЬрд╛рдирдирд╛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдХрд┐ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рдХреНрдпрд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред

![](<../../../.gitbook/assets/image (571).png>)

**Protocol Hierarchy**

_**Statistics --> Protocol Hierarchy**_ рдХреЗ рдЕрдВрддрд░реНрдЧрдд рдЖрдкрдХреЛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ **рдкреНрд░реЛрдЯреЛрдХреЙрд▓реНрд╕** рдФрд░ рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдорд┐рд▓реЗрдЧрд╛ред

![](<../../../.gitbook/assets/image (572).png>)

**Conversations**

_**Statistics --> Conversations**_ рдХреЗ рдЕрдВрддрд░реНрдЧрдд рдЖрдкрдХреЛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рд╣реЛрдиреЗ рд╡рд╛рд▓реА **рдмрд╛рддрдЪреАрдд рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢** рдФрд░ рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдорд┐рд▓реЗрдЧрд╛ред

![](<../../../.gitbook/assets/image (573).png>)

**Endpoints**

_**Statistics --> Endpoints**_ рдХреЗ рдЕрдВрддрд░реНрдЧрдд рдЖрдкрдХреЛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ **рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢** рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдбреЗрдЯрд╛ рдорд┐рд▓реЗрдЧрд╛ред

![](<../../../.gitbook/assets/image (575).png>)

**DNS рдЬрд╛рдирдХрд╛рд░реА**

_**Statistics --> DNS**_ рдХреЗ рдЕрдВрддрд░реНрдЧрдд рдЖрдкрдХреЛ рдХреИрдкреНрдЪрд░ рдХрд┐рдП рдЧрдП DNS рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рд╛рдВрдЦреНрдпрд┐рдХреА рдорд┐рд▓реЗрдЧреАред

![](<../../../.gitbook/assets/image (577).png>)

**I/O Graph**

_**Statistics --> I/O Graph**_ рдХреЗ рдЕрдВрддрд░реНрдЧрдд рдЖрдкрдХреЛ рд╕рдВрдЪрд╛рд░ рдХрд╛ **рдЧреНрд░рд╛рдл** рдорд┐рд▓реЗрдЧрд╛ред

![](<../../../.gitbook/assets/image (574).png>)

### рдлрд┐рд▓реНрдЯрд░реНрд╕

рдпрд╣рд╛рдВ рдЖрдкрдХреЛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ Wireshark рдлрд┐рд▓реНрдЯрд░ рдорд┐рд▓реЗрдВрдЧреЗ: [https://www.wireshark.org/docs/dfref/](https://www.wireshark.org/docs/dfref/)\
рдЕрдиреНрдп рд░реЛрдЪрдХ рдлрд┐рд▓реНрдЯрд░реНрд╕:

* `(http.request or ssl.handshake.type == 1) and !(udp.port eq 1900)`
* HTTP рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTPS рдЯреНрд░реИрдлрд┐рдХ
* `(http.request or ssl.handshake.type == 1 or tcp.flags eq 0x0002) and !(udp.port eq 1900)`
* HTTP рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTPS рдЯреНрд░реИрдлрд┐рдХ + TCP SYN
* `(http.request or ssl.handshake.type == 1 or tcp.flags eq 0x0002 or dns) and !(udp.port eq 1900)`
* HTTP рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTPS рдЯреНрд░реИрдлрд┐рдХ + TCP SYN + DNS рдЕрдиреБрд░реЛрдз

### рдЦреЛрдЬ

рдпрджрд┐ рдЖрдк рд╕рддреНрд░реЛрдВ рдХреЗ **рдкреИрдХреЗрдЯреНрд╕** рдореЗрдВ **рд╕рд╛рдордЧреНрд░реА** рдХреА **рдЦреЛрдЬ** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ _CTRL+f_ рджрдмрд╛рдПрдВред рдЖрдк рдореБрдЦреНрдп рдЬрд╛рдирдХрд╛рд░реА рдмрд╛рд░ (No., Time, Source, рдЖрджрд┐) рдореЗрдВ рдирдИ рдкрд░рддреЗрдВ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рджрд╛рдПрдВ рдмрдЯрди рдХреЛ рджрдмрд╛рдХрд░ рдФрд░ рдлрд┐рд░ рдХреЙрд▓рдо рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВред

рдЕрднреНрдпрд╛рд╕: [https://www.malware-traffic-analysis.net/](https://www.malware-traffic-analysis.net)

## рдбреЛрдореЗрдиреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛

рдЖрдк рдПрдХ рдХреЙрд▓рдо рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ HTTP рд╣реЗрдбрд░ рдХреЗ Host рдХреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ:

![](<../../../.gitbook/assets/image (403).png>)

рдФрд░ рдПрдХ рдХреЙрд▓рдо рдЬреЛ рдПрдХ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTPS рдХрдиреЗрдХреНрд╢рди рд╕реЗ Server рдирд╛рдо рдЬреЛрдбрд╝рддрд╛ рд╣реИ (**ssl.handshake.type == 1**):

![](<../../../.gitbook/assets/image (408) (1).png>)

## рд╕реНрдерд╛рдиреАрдп рд╣реЛрд╕реНрдЯрдиреЗрдореНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛

### DHCP рд╕реЗ

рд╡рд░реНрддрдорд╛рди Wireshark рдореЗрдВ `bootp` рдХреЗ рдмрдЬрд╛рдп рдЖрдкрдХреЛ `DHCP` рдХреЗ рд▓рд┐рдП рдЦреЛрдЬ рдХрд░рдиреА рд╣реЛрдЧреА

![](<../../../.gitbook/assets/image (404).png>)

### NBNS рд╕реЗ

![](<../../../.gitbook/assets/image (405).png>)

## TLS рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдирд╛

### рд╕рд░реНрд╡рд░ рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреА рдХреЗ рд╕рд╛рде https рдЯреНрд░реИрдлрд┐рдХ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдирд╛

_edit>preference>protocol>ssl>_

![](<../../../.gitbook/assets/image (98).png>)

_Edit_ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рд╕рд░реНрд╡рд░ рдФрд░ рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреА рдХреА рд╕рднреА рдбреЗрдЯрд╛ рдЬреЛрдбрд╝реЗрдВ (_IP, Port, Protocol, Key file рдФрд░ password_)

### рд╕рд┐рдореЗрдЯреНрд░рд┐рдХ рд╕реЗрд╢рди рдХреАрдЬрд╝ рдХреЗ рд╕рд╛рде https рдЯреНрд░реИрдлрд┐рдХ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдирд╛

рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ рдХрд┐ Firefox рдФрд░ Chrome рджреЛрдиреЛрдВ TLS рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдП рдЧрдП рд╕рд┐рдореЗрдЯреНрд░рд┐рдХ рд╕реЗрд╢рди рдХреА рдХреЛ рдПрдХ рдлрд╛рдЗрд▓ рдореЗрдВ рд▓реЙрдЧ рдХрд░рдиреЗ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВред рдлрд┐рд░ рдЖрдк Wireshark рдХреЛ рдЙрд╕ рдлрд╛рдЗрд▓ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рддрддреНрдХрд╛рд▓! рдбрд┐рдХреНрд░рд┐рдкреНрдЯреЗрдб TLS рдЯреНрд░реИрдлрд┐рдХред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП: [https://redflagsecurity.net/2019/03/10/decrypting-tls-wireshark/](https://redflagsecurity.net/2019/03/10/decrypting-tls-wireshark/)\
рдЗрд╕рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рдЕрдВрджрд░ `SSLKEYLOGFILE` рд╡реЗрд░рд┐рдПрдмрд▓ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬ рдХрд░реЗрдВ

рд╢реЗрдпрд░реНрдб рдХреАрдЬрд╝ рдХреА рдПрдХ рдлрд╛рдЗрд▓ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдЧреА:

![](<../../../.gitbook/assets/image (99).png>)

Wireshark рдореЗрдВ рдЗрд╕реЗ рдЖрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП \_edit > preference > protocol > ssl > рдореЗрдВ рдЬрд╛рдПрдВ рдФрд░ рдЗрд╕реЗ (Pre)-Master-Secret log filename рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВ:

![](<../../../.gitbook/assets/image (100).png>)

## ADB рд╕рдВрдЪрд╛рд░

ADB рд╕рдВрдЪрд╛рд░ рд╕реЗ рдПрдХ APK рдирд┐рдХрд╛рд▓реЗрдВ рдЬрд╣рд╛рдВ APK рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛:
```python
from scapy.all import *

pcap = rdpcap("final2.pcapng")

def rm_data(data):
splitted = data.split(b"DATA")
if len(splitted) == 1:
return data
else:
return splitted[0]+splitted[1][4:]

all_bytes = b""
for pkt in pcap:
if Raw in pkt:
a = pkt[Raw]
if b"WRTE" == bytes(a)[:4]:
all_bytes += rm_data(bytes(a)[24:])
else:
all_bytes += rm_data(bytes(a))
print(all_bytes)

f = open('all_bytes.data', 'w+b')
f.write(all_bytes)
f.close()
```
<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ.

</details>
