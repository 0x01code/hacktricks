# Windows рдЖрд░реНрдЯрд┐рдлреИрдХреНрдЯреНрд╕

## Windows рдЖрд░реНрдЯрд┐рдлреИрдХреНрдЯреНрд╕

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## рд╕рд╛рдорд╛рдиреНрдп Windows рдЖрд░реНрдЯрд┐рдлреИрдХреНрдЯреНрд╕

### Windows 10 рд╕реВрдЪрдирд╛рдПрдБ

рдкрде `\Users\<username>\AppData\Local\Microsoft\Windows\Notifications` рдореЗрдВ рдЖрдкрдХреЛ рдбреЗрдЯрд╛рдмреЗрд╕ `appdb.dat` (Windows anniversary рд╕реЗ рдкрд╣рд▓реЗ) рдпрд╛ `wpndatabase.db` (Windows Anniversary рдХреЗ рдмрд╛рдж) рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ SQLite рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ, рдЖрдк `Notification` рддрд╛рд▓рд┐рдХрд╛ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рд╕рднреА рд╕реВрдЪрдирд╛рдПрдБ (XML рдкреНрд░рд╛рд░реВрдк рдореЗрдВ) рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬреЛ рджрд┐рд▓рдЪрд╕реНрдк рдбреЗрдЯрд╛ рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддреА рд╣реИрдВред

### рдЯрд╛рдЗрдорд▓рд╛рдЗрди

рдЯрд╛рдЗрдорд▓рд╛рдЗрди рдПрдХ Windows рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬреЛ рд╡реЗрдм рдкреЗрдЬреЛрдВ рдХреЗ рдпрд╛рддрд╛рдпрд╛рдд, рд╕рдВрдкрд╛рджрд┐рдд рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдФрд░ рдЪрд▓рд╛рдП рдЧрдП рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХрд╛ **рдХрд╛рд▓рд╛рдВрддрд░рд┐рдХ рдЗрддрд┐рд╣рд╛рд╕** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

рдбреЗрдЯрд╛рдмреЗрд╕ рдкрде `\Users\<username>\AppData\Local\ConnectedDevicesPlatform\<id>\ActivitiesCache.db` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред рдЗрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдПрдХ SQLite рдЙрдкрдХрд░рдг рдХреЗ рд╕рд╛рде рдЦреЛрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдЙрдкрдХрд░рдг [**WxTCmd**](https://github.com/EricZimmerman/WxTCmd) рдХреЗ рд╕рд╛рде рдЬреЛ 2 рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдХрд░рдг [**TimeLine Explorer**](https://ericzimmerman.github.io/#!index.md) рдХреЗ рд╕рд╛рде рдЦреЛрд▓реА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

### ADS (рд╡реИрдХрд▓реНрдкрд┐рдХ рдбреЗрдЯрд╛ рд╕реНрдЯреНрд░реАрдореНрд╕)

рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ **ADS Zone.Identifier** рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддреА рд╣реИрдВ рдЬреЛ рдЗрд╕реЗ рдЗрдВрдЯреНрд░рд╛рдиреЗрдЯ, рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рдХреИрд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИред рдХреБрдЫ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ (рдЬреИрд╕реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░) рдЖрдо рддреМрд░ рдкрд░ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпреЗ рдЧрдП URL рдЬреИрд╕реА **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА** рднреА рдбрд╛рд▓рддреЗ рд╣реИрдВред

## **рдлрд╝рд╛рдЗрд▓ рдмреИрдХрдЕрдкреНрд╕**

### рд░реАрд╕рд╛рдЗрдХрд▓ рдмрд┐рди

Vista/Win7/Win8/Win10 рдореЗрдВ **рд░реАрд╕рд╛рдЗрдХрд▓ рдмрд┐рди** рдбреНрд░рд╛рдЗрд╡ рдХреА рд░реВрдЯ рдореЗрдВ рдлрд╝реЛрд▓реНрдбрд░ **`$Recycle.bin`** рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (`C:\$Recycle.bin`)ред\
рдЬрдм рдЗрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╣рдЯрд╛рдИ рдЬрд╛рддреА рд╣реИ рддреЛ 2 рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИрдВ:

* `$I{id}`: рдлрд╝рд╛рдЗрд▓ рд╕реВрдЪрдирд╛ (рдЬрдм рдпрд╣ рд╣рдЯрд╛рдИ рдЧрдИ рдереА рдХреА рддрд╛рд░реАрдЦ}
* `$R{id}`: рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА

![](<../../../.gitbook/assets/image (486).png>)

рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде рдЖрдк рдЙрдкрдХрд░рдг [**Rifiuti**](https://github.com/abelcheung/rifiuti2) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдЯрд╛рдИ рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдореВрд▓ рдкрддрд╛ рдФрд░ рд╣рдЯрд╛рдИ рдЧрдИ рддрд╛рд░реАрдЦ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (Vista тАУ Win10 рдХреЗ рд▓рд┐рдП `rifiuti-vista.exe` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ)ред
```
.\rifiuti-vista.exe C:\Users\student\Desktop\Recycle
```
![](<../../../.gitbook/assets/image (495) (1) (1) (1).png>)

### рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкреА

рд╢реИрдбреЛ рдХреЙрдкреА рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╡рд┐рдВрдбреЛрдЬ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдлрд╝рд╛рдЗрд▓ рдпрд╛ рд╡реЙрд▓реНрдпреВрдо рдХреА **рдмреИрдХрдЕрдк рдХреЙрдкрд┐рдпрд╛рдВ** рдпрд╛ рд╕реНрдиреИрдкрд╢реЙрдЯ рдмрдирд╛ рд╕рдХрддреА рд╣реИ, рднрд▓реЗ рд╣реА рд╡реЗ рдЙрдкрдпреЛрдЧ рдореЗрдВ рд╣реЛрдВред

рдпреЗ рдмреИрдХрдЕрдкреНрд╕ рдЖрдо рддреМрд░ рдкрд░ `\System Volume Information` рдореЗрдВ рд░реВрдЯ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рд╕реНрдерд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдХрд╛ рдирд╛рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЫрд╡рд┐ рдореЗрдВ рджрд┐рдЦрд╛рдП рдЧрдП **UIDs** рд╕реЗ рдорд┐рд▓рдХрд░ рдмрдирддрд╛ рд╣реИ:

![](<../../../.gitbook/assets/image (520).png>)

**ArsenalImageMounter** рдХреЗ рд╕рд╛рде рдлреЛрд░реЗрдВрд╕рд┐рдХреНрд╕ рдЗрдореЗрдЬ рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░рдХреЗ, рдЙрдкрдХрд░рдг [**ShadowCopyView**](https://www.nirsoft.net/utils/shadow\_copy\_view.html) рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рд╢реИрдбреЛ рдХреЙрдкреА рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдФрд░ рд╢реИрдбреЛ рдХреЙрдкреА рдмреИрдХрдЕрдк рд╕реЗ **рдлрд╝рд╛рдЗрд▓реЗрдВ рдирд┐рдХрд╛рд▓рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![](<../../../.gitbook/assets/image (521).png>)

рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдПрдВрдЯреНрд░реА `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\BackupRestore` рдлрд╝рд╛рдЗрд▓реЗрдВ рдФрд░ рдХреБрдВрдЬреАрдпреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИ **рдЬрд┐рдиреНрд╣реЗрдВ рдмреИрдХрдЕрдк рди рдХрд░реЗрдВ**:

![](<../../../.gitbook/assets/image (522).png>)

рд░рдЬрд┐рд╕реНрдЯреНрд░реА `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VSS` рдореЗрдВ рднреА `рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкрд┐рдпреЛрдВ` рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рдиреНрдпрд╛рд╕ рд╕реВрдЪрдирд╛ рд╣реЛрддреА рд╣реИред

### рдСрдлрд┐рд╕ рдСрдЯреЛрд╕реЗрд╡реНрдб рдлрд╝рд╛рдЗрд▓реЗрдВ

рдЖрдк рдСрдлрд┐рд╕ рдСрдЯреЛрд╕реЗрд╡реНрдб рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: `C:\Usuarios\\AppData\Roaming\Microsoft{Excel|Word|Powerpoint}\`

## рд╢реИрд▓ рдЖрдЗрдЯрдореНрд╕

рдПрдХ рд╢реИрд▓ рдЖрдЗрдЯрдо рдПрдХ рдЖрдЗрдЯрдо рд╣реИ рдЬреЛ рджреВрд╕рд░реА рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддрд╛ рд╣реИред

### рд╣рд╛рд▓ рдХреА рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ (LNK)

рд╡рд┐рдВрдбреЛрдЬ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ** рдпреЗ **рд╢реЙрд░реНрдЯрдХрдЯ** рдмрдирд╛рддрд╛ рд╣реИ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ рдлрд╝рд╛рдЗрд▓ **рдЦреЛрд▓рддрд╛ рд╣реИ, рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдмрдирд╛рддрд╛ рд╣реИ**:

* Win7-Win10: `C:\Users\\AppData\Roaming\Microsoft\Windows\Recent\`
* Office: `C:\Users\\AppData\Roaming\Microsoft\Office\Recent\`

рдЬрдм рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ рд▓рд┐рдВрдХ рдлрд╝рд╛рдЗрд▓ рдлрд╝реЛрд▓реНрдбрд░, рдорд╛рддрд╛-рдкрд┐рддрд╛ рдлрд╝реЛрд▓реНрдбрд░ рдФрд░ рдкрд░рджрд╛рджреА рдлрд╝реЛрд▓реНрдбрд░ рдХрд╛ рднреА рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЧрдП рд▓рд┐рдВрдХ рдлрд╝рд╛рдЗрд▓реЗрдВ **рдореВрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреА рд╣реИрдВ** рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ рдХреЛрдИ **рдлрд╝рд╛рдЗрд▓ рд╣реИ** рдпрд╛ рдПрдХ **рдлрд╝реЛрд▓реНрдбрд░**, рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЗ **MAC рд╕рдордп**, рдЬрд╣рд╛рдБ рдлрд╝рд╛рдЗрд▓ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реИ рдФрд░ **рд▓рдХреНрд╖рд┐рдд рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдлрд╝реЛрд▓реНрдбрд░**ред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдЙрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд▓рд┐рдВрдХ рдлрд╝рд╛рдЗрд▓ рдХреА **рдирд┐рд░реНрдорд┐рдд рддрд┐рдерд┐** рд╡рд╣ **рд╕рдордп** рд╣реИ рдЬрдм рдореВрд▓ рдлрд╝рд╛рдЗрд▓ рдХрд╛ **рдкрд╣рд▓реА рдмрд╛рд░ рдЙрдкрдпреЛрдЧ** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рд▓рд┐рдВрдХ рдлрд╝рд╛рдЗрд▓ рдХрд╛ **рд╕рдВрд╢реЛрдзрд┐рдд рддрд┐рдерд┐** рд╡рд╣ **рд╕рдордп** рд╣реИ рдЬрдм рдореВрд▓ рдлрд╝рд╛рдЗрд▓ рдХрд╛ **рдЕрдВрддрд┐рдо рдмрд╛рд░ рдЙрдкрдпреЛрдЧ** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк [**LinkParser**](http://4discovery.com/our-tools/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рдЙрдкрдХрд░рдг рдореЗрдВ рдЖрдкрдХреЛ **2 рд╕реЗрдЯ** рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдорд┐рд▓реЗрдВрдЧреЗ:

* **рдкрд╣рд▓рд╛ рд╕реЗрдЯ:**
1. рдлрд╝рд╛рдЗрд▓ рд╕рдВрд╢реЛрдзрд┐рдд рддрд┐рдерд┐
2. рдлрд╝рд╛рдЗрд▓ рдПрдХреНрд╕реЗрд╕ рддрд┐рдерд┐
3. рдлрд╝рд╛рдЗрд▓ рдирд┐рд░реНрдорд╛рдг рддрд┐рдерд┐
* **рджреВрд╕рд░рд╛ рд╕реЗрдЯ:**
1. рд▓рд┐рдВрдХ рд╕рдВрд╢реЛрдзрд┐рдд рддрд┐рдерд┐
2. рд▓рд┐рдВрдХ рдПрдХреНрд╕реЗрд╕ рддрд┐рдерд┐
3. рд▓рд┐рдВрдХ рдирд┐рд░реНрдорд╛рдг рддрд┐рдерд┐ред

рдкрд╣рд▓реЗ рд╕реЗрдЯ рдХрд╛ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк **рдлрд╝рд╛рдЗрд▓ рдЗрд╕рд▓реНрдл рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕** рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред рджреВрд╕рд░рд╛ рд╕реЗрдЯ **рд▓рд┐рдВрдХ рдХреА рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕** рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред

рдЖрдк рд╡рд┐рдВрдбреЛрдЬ CLI рдЙрдкрдХрд░рдг рдЪрд▓рд╛рдХрд░ рдЗрд╕реА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [**LECmd.exe**](https://github.com/EricZimmerman/LECmd)
```
LECmd.exe -d C:\Users\student\Desktop\LNKs --csv C:\Users\student\Desktop\LNKs
```
### рдЬрдореНрдкрд▓рд┐рд╕реНрдЯреНрд╕

рдпреЗ рд╣рд╛рд▓ рдХреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реИрдВ рдЬреЛ рдкреНрд░рддрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рджрд░реНрд╢рд╛рдИ рдЬрд╛рддреА рд╣реИрдВред рдпрд╣ рдПрдХ рдРрд╕реА **рд╕реВрдЪреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЧрдИ рд╣рд╛рд▓ рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ** рд╣реИрдВ рдЬрд┐рд╕реЗ рдЖрдк рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпреЗ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ рдпрд╛ рдХрд╕реНрдЯрдо** рд╣реЛ рд╕рдХрддреА рд╣реИрдВред

**рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЧрдП рдЬрдореНрдкрд▓рд┐рд╕реНрдЯреНрд╕** `C:\Users\{username}\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations\` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред рдЬрдореНрдкрд▓рд┐рд╕реНрдЯреНрд╕ рдХрд╛ рдирд╛рдо рдЗрд╕ рдкреНрд░рд╛рд░реВрдк рдХрд╛ рд╣реЛрддрд╛ рд╣реИ `{id}.autmaticDestinations-ms` рдЬрд╣рд╛рдВ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЖрдИрдбреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдЖрдИрдбреА рд╣реЛрддреА рд╣реИред

рдХрд╕реНрдЯрдо рдЬрдореНрдкрд▓рд┐рд╕реНрдЯреНрд╕ `C:\Users\{username}\AppData\Roaming\Microsoft\Windows\Recent\CustomDestination\` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрддреА рд╣реИрдВ рдФрд░ рдЗрдиреНрд╣реЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рд╕рд╛рдорд╛рдиреНрдпрдд: рдХреБрдЫ **рдорд╣рддреНрд╡рдкреВрд░реНрдг** рдШрдЯрдирд╛ рд╣реЛрдиреЗ рдХреЗ рдХрд╛рд░рдг рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рд╢рд╛рдпрдж рдкрд╕рдВрджреАрджрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛ)

рдХрд┐рд╕реА рднреА рдЬрдореНрдкрд▓рд┐рд╕реНрдЯ рдХрд╛ **рдирд┐рд░реНрдорд╛рдг рд╕рдордп** рджрд░реНрд╢рд╛рддрд╛ рд╣реИ **рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рдкрд╣рд▓рд╛ рд╕рдордп** рдФрд░ **рд╕рдВрд╢реЛрдзрд┐рдд рд╕рдордп** рдЕрдВрддрд┐рдо рдмрд╛рд░ред

рдЖрдк [**JumplistExplorer**](https://ericzimmerman.github.io/#!index.md) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрдореНрдкрд▓рд┐рд╕реНрдЯреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

![](<../../../.gitbook/assets/image (474).png>)

(_рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ JumplistExplorer рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╕рдордп рдЪрд┐рд╣реНрдирд┐рдд рдЬрдореНрдкрд▓рд┐рд╕реНрдЯ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВ_)

### рд╢реЗрд▓рдмреИрдЧреНрд╕

[**рдЗрд╕ рд▓рд┐рдВрдХ рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдЬрд╛рдиреЗрдВ рдХрд┐ рд╢реЗрд▓рдмреИрдЧреНрд╕ рдХреНрдпрд╛ рд╣реИрдВред**](interesting-windows-registry-keys.md#shellbags)

## Windows USB рдХрд╛ рдЙрдкрдпреЛрдЧ

рдПрдХ USB рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдпрд╣ рдкрд╣рдЪрд╛рдирдирд╛ рд╕рдВрднрд╡ рд╣реИ рдзрдиреНрдпрд╡рд╛рдж рд╣реИ:

* Windows рд╣рд╛рд▓ рдХреА рдлрд╝реЛрд▓реНрдбрд░
* Microsoft Office рд╣рд╛рд▓ рдХреА рдлрд╝реЛрд▓реНрдбрд░
* рдЬрдореНрдкрд▓рд┐рд╕реНрдЯреНрд╕

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреБрдЫ LNK рдлрд╝рд╛рдЗрд▓ рдореВрд▓ рдкрде рдХреА рдмрдЬрд╛рдп WPDNSE рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреА рд╣реИрдВ:

![](<../../../.gitbook/assets/image (476).png>)

рдлрд╝реЛрд▓реНрдбрд░ WPDNSE рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЗрдВ рдореВрд▓ рд╡рд╛рд▓реЛрдВ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рд╣реЛрддреА рд╣реИрдВ, рдлрд┐рд░ рд╡реЗ PC рдХреА рдкреБрдирд░рд╛рд░рдВрднреА рдирд╣реАрдВ рд╣реЛрдВрдЧреА рдФрд░ GUID рдПрдХ рд╢реЗрд▓рдмреИрдЧ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

### рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реВрдЪрдирд╛

[рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдкреГрд╖реНрда рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ](interesting-windows-registry-keys.md#usb-information) рдХрд┐ рдХреМрди рд╕реА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреАрдпрд╛рдБ USB рдХрдиреЗрдХреНрдЯреЗрдб рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреА рд╣реИрдВред

### setupapi

USB рдХрдиреЗрдХреНрд╢рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдХрдм рд╣реБрдЖ рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓ `C:\Windows\inf\setupapi.dev.log` рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ (рдЦреЛрдЬ рдХрд░реЗрдВ `Section start`).

![](<../../../.gitbook/assets/image (477) (2) (2) (2) (2) (2) (2) (2) (3) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (14).png>)

### USB рдбрд┐рдЯреЗрдХреНрдЯрд┐рд╡

[**USBDetective**](https://usbdetective.com) рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдЫрд╡рд┐ рдореЗрдВ рдХрдиреЗрдХреНрдЯ рдХрд┐рдП рдЧрдП USB рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![](<../../../.gitbook/assets/image (483).png>)

### рдкреНрд▓рдЧ рдФрд░ рдкреНрд▓реЗ рд╕рдлрд╛рдИ

'рдкреНрд▓рдЧ рдФрд░ рдкреНрд▓реЗ рд╕рдлрд╛рдИ' рдирд╛рдордХ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдп рдХреЛ рдкреБрд░рд╛рдиреЗ рдбреНрд░рд╛рдЗрд╡рд░ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рдердорд┐рдХ рд░реВрдк рд╕реЗ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдирд╡реАрдирддрдо рдбреНрд░рд╛рдЗрд╡рд░ рдкреИрдХреЗрдЬ рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рдЙрд╕рдХреЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд╡рд┐рдкрд░реАрдд, рдСрдирд▓рд╛рдЗрди рд╕реНрд░реЛрдд рд╕реБрдЭрд╛рд╡ рджреЗрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ 30 рджрд┐рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдХреНрд░рд┐рдп рд░рд╣реЗ рдбреНрд░рд╛рдЗрд╡рд░реНрд╕ рдкрд░ рднреА рдирд┐рд╢рд╛рдирд╛ рд╕рд╛рдзрддрд╛ рд╣реИред рдЗрд╕ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдкрд┐рдЫрд▓реЗ 30 рджрд┐рдиреЛрдВ рдореЗрдВ рдХрдиреЗрдХреНрдЯ рдирд╣реАрдВ рдХрд┐рдП рдЧрдП рд╣рдЯрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдХрд╛рд░реНрдп рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрде рдкрд░ рд╕реНрдерд┐рдд рд╣реИ:
`C:\Windows\System32\Tasks\Microsoft\Windows\Plug and Play\Plug and Play Cleanup`.

рдХрд╛рд░реНрдп рдХреА рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЪрд┐рддреНрд░ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
![](https://2.bp.blogspot.com/-wqYubtuR_W8/W19bV5S9XyI/AAAAAAAANhU/OHsBDEvjqmg9ayzdNwJ4y2DKZnhCdwSMgCLcBGAs/s1600/xml.png)

**рдХрд╛рд░реНрдп рдХреЗ рдореБрдЦреНрдп рдШрдЯрдХ рдФрд░ рд╕реЗрдЯрд┐рдВрдЧреНрд╕:**
- **pnpclean.dll**: рдпрд╣ DLL рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдлрд╛рдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред
- **UseUnifiedSchedulingEngine**: `TRUE` рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░реНрдп рдирд┐рд░реНрдзрд╛рд░рдг рдЗрдВрдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИред
- **MaintenanceSettings**:
- **рдЕрд╡рдзрд┐ ('P1M')**: рдХрд╛рд░реНрдп рд╕реВрдЪреАрдХрд░рдгрдХрд░реНрддрд╛ рдХреЛ рдирд┐рдпрдорд┐рдд рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдорд╛рд╕рд┐рдХ рд╕рдлрд╛рдИ рдХрд╛рд░реНрдп рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- **рд╕рдордпрд╕реАрдорд╛ ('P2M')**: рдпрджрд┐ рдХрд╛рд░реНрдп рджреЛ рд▓рдЧрд╛рддрд╛рд░ рдорд╣реАрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЯрд╛рд╕реНрдХ рд╕реНрдХреЗрдбреНрдпреВрд▓рд░ рдХреЛ рдЖрдкрд╛рддрдХрд╛рд▓реАрди рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдорд╛рд╕рд┐рдХ рд╕рдлрд╛рдИ рдХрд╛рд░реНрдп рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рд╡рд┐рдиреНрдпрд╛рд╕ рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреА рдирд┐рдпрдорд┐рдд рд░рдЦрд░рдЦрд╛рд╡ рдФрд░ рд╕рдлрд╛рдИ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд▓рдЧрд╛рддрд╛рд░ рд╡рд┐рдлрд▓рддрд╛рдУрдВ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдХрд╛рд░реНрдп рдХреЛ рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рд╡рдзрд╛рди рдХрд░рддрд╛ рд╣реИред

**рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:** [**https://blog.1234n6.com/2018/07/windows-plug-and-play-cleanup.html**](https://blog.1234n6.com/2018/07/windows-plug-and-play-cleanup.html)

## рдИрдореЗрд▓

рдИрдореЗрд▓ рдореЗрдВ **2 рджрд┐рд▓рдЪрд╕реНрдк рднрд╛рдЧ рд╣реЛрддреЗ рд╣реИрдВ: рд╣реЗрдбрд░реНрд╕ рдФрд░ рд╕рд╛рдордЧреНрд░реА**ред **рд╣реЗрдбрд░реНрд╕** рдореЗрдВ рдЖрдк рдЬрд╛рдирдХрд╛рд░реА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ:

* **рдХреМрди** рдИрдореЗрд▓ рднреЗрдЬрд╛ (рдИрдореЗрд▓ рдкрддрд╛, рдЖрдИрдкреА, рдИрдореЗрд▓ рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдореЗрд▓ рд╕рд░реНрд╡рд░)
* **рдХрдм** рдИрдореЗрд▓ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, `References` рдФрд░ `In-Reply-To` рд╣реЗрдбрд░реНрд╕ рдореЗрдВ рдЖрдк рдореЗрд╕реЗрдЬ рдХреА рдЖрдИрдбреА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

![](<../../../.gitbook/assets/image (484).png>)

### Windows рдореЗрд▓ рдРрдк

рдпрд╣ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдИрдореЗрд▓ рдХреЛ HTML рдпрд╛ рдкрд╛рда рдореЗрдВ рд╕рд╣реЗрдЬрддрд╛ рд╣реИред рдЖрдк рдИрдореЗрд▓ рдХреЛ рдиреАрдЪреЗ рдЙрдкрдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ `\Users\<username>\AppData\Local\Comms\Unistore\data\3\`ред рдИрдореЗрд▓ `.dat` рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рд╕рд╣реЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред

рдИрдореЗрд▓реЛрдВ рдХреА **рдореЗрдЯрд╛рдбреЗрдЯрд╛** рдФрд░ **рд╕рдВрдкрд░реНрдХ** рдХреЛ **EDB рдбреЗрдЯрд╛рдмреЗрд╕** рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: `\Users\<username>\AppData\Local\Comms\UnistoreDB\store.vol`

рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди **рдмрджрд▓реЗрдВ** `.vol` рд╕реЗ `.edb` рдФрд░ рдЖрдк рдЗрд╕реЗ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг [ESEDatabaseView](https://www.nirsoft.net/utils/ese\_database\_view.html) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред `Message` рдЯреЗрдмрд▓ рдХреЗ рдЕрдВрджрд░ рдЖрдк рдИрдореЗрд▓ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

### Microsoft Outlook

рдЬрдм Exchange рд╕рд░реНрд╡рд░ рдпрд╛ Outlook рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдХреБрдЫ MAPI рд╣реЗрдбрд░реНрд╕ рд╣реЛрддреЗ рд╣реИрдВ:

* `Mapi-Client-Submit-Time`: рдИрдореЗрд▓ рднреЗрдЬреЗ рдЬрд╛рдиреЗ рдХрд╛ рд╕рдордп
* `Mapi-Conversation-Index`: рдереНрд░реЗрдб рдХреЗ рдмрдЪреНрдЪреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдФрд░ рд╣рд░ рдореЗрд╕реЗрдЬ рдХреЗ рд╕рдордп рдХрд╛ рдЪрд┐рдиреНрд╣рд╛рдВрдХ
* `Mapi-Entry-ID`: рдореЗрд╕реЗрдЬ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ред
* `Mappi-Message-Flags` рдФрд░ `Pr_last_Verb-Executed`: MAPI рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА (рдореЗрд╕реЗрдЬ рдкрдврд╝рд╛ рдЧрдпрд╛? рдкрдврд╝рд╛ рдирд╣реАрдВ рдЧрдпрд╛? рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреА рдЧрдИ? рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛? рдмрд╛рд╣рд░ рдСрдлрд┐рд╕?)

Microsoft Outlook рдХреНрд▓рд╛рдЗрдВрдЯ рдореЗрдВ
### Microsoft Outlook OST Files

рдПрдХ **OST рдлрд╝рд╛рдЗрд▓** Microsoft Outlook рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдХреА рдЬрд╛рддреА рд╣реИ рдЬрдм рдпрд╣ **IMAP** рдпрд╛ **Exchange** рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдПрдХ PST рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рдорд╛рди рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддреА рд╣реИред рдпрд╣ рдлрд╝рд╛рдЗрд▓ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рд╕рдордХрд▓реАрди рд╣реЛрддреА рд╣реИ, **рдкрд┐рдЫрд▓реЗ 12 рдорд╣реАрдиреЗ** рддрдХ рдХреЗ рдбреЗрдЯрд╛ рдХреЛ **рдЕрдзрд┐рдХрддрдо 50GB** рдЖрдХрд╛рд░ рддрдХ рд░рдЦрддреА рд╣реИ, рдФрд░ PST рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред рдПрдХ OST рдлрд╝рд╛рдЗрд▓ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, [**Kernel OST viewer**](https://www.nucleustechnologies.com/ost-viewer.html) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### рдЕрдЯреИрдЪрдореЗрдВрдЯ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛

рдЦреЛ рдЧрдП рдЕрдЯреИрдЪрдореЗрдВрдЯ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реЗ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

- **IE10 рдХреЗ рд▓рд┐рдП**: `%APPDATA%\Local\Microsoft\Windows\Temporary Internet Files\Content.Outlook`
- **IE11 рдФрд░ рдКрдкрд░ рдХреЗ рд▓рд┐рдП**: `%APPDATA%\Local\Microsoft\InetCache\Content.Outlook`

### Thunderbird MBOX Files

**Thunderbird** рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **MBOX рдлрд╝рд╛рдЗрд▓реЗрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ `\Users\%USERNAME%\AppData\Roaming\Thunderbird\Profiles` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред

### рдЫрд╡рд┐ рдердВрдмрдиреЗрд▓реНрд╕

- **Windows XP рдФрд░ 8-8.1**: рдердВрдмрдиреЗрд▓реНрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдкрд░ `thumbs.db` рдлрд╝рд╛рдЗрд▓ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬреЛ рдЫрд╡рд┐ рдкреВрд░реНрд╡рд╛рд╡рд▓реЛрдХрди рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддреА рд╣реИ, рднрд▓реЗ рд╣реА рдЙрд╕рдХреЗ рд╣рдЯрд╛рдиреЗ рдХреЗ рдмрд╛рдж рднреАред
- **Windows 7/10**: `thumbs.db` рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм UNC рдкрде рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣реБрдБрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **Windows Vista рдФрд░ рдирдПрд░реЗ**: рдердВрдмрдиреЗрд▓ рдкреВрд░реНрд╡рд╛рд╡рд▓реЛрдХрди `%userprofile%\AppData\Local\Microsoft\Windows\Explorer` рдореЗрдВ рдХреЗрдВрджреНрд░реАрдХреГрдд рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЗрдВ **thumbcache\_xxx.db** рдирд╛рдо рд╕реЗ рд╣реЛрддреА рд╣реИрдВред [**Thumbsviewer**](https://thumbsviewer.github.io) рдФрд░ [**ThumbCache Viewer**](https://thumbcacheviewer.github.io) рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг рд╣реИрдВред

### Windows рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реВрдЪрдирд╛

Windows рд░рдЬрд┐рд╕реНрдЯреНрд░реА, рд╡рд┐рднрд┐рдиреНрди `HKEY_LOCAL_MACHINE` рдЙрдкрдХреАрдЬреЛрдВ рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╡реНрдпрд╛рдкрдХ рд╕рд┐рд╕реНрдЯрдо рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЧрддрд┐рд╡рд┐рдзрд┐ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИ:

- рд╡рд┐рднрд┐рдиреНрди `HKEY_LOCAL_MACHINE` рдЙрдкрдХреАрдЬреЛрдВ рдХреЗ рд▓рд┐рдП `%windir%\System32\Config` рдореЗрдВред
- `HKEY_CURRENT_USER` рдХреЗ рд▓рд┐рдП `%UserProfile%{User}\NTUSER.DAT` рдореЗрдВред
- Windows Vista рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рдХреЗ рд╕рдВрд╕реНрдХрд░рдг `%Windir%\System32\Config\RegBack\` рдореЗрдВ `HKEY_LOCAL_MACHINE` рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдлрд╝рд╛рдЗрд▓реЗрдВ рдмреИрдХрдЕрдк рдХрд░рддреЗ рд╣реИрдВред
- рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдХрд╛рд░реНрдпрдХреНрд░рдо рдирд┐рд╖реНрдкрд╛рджрди рд╕реВрдЪрдирд╛ `%UserProfile%\{User}\AppData\Local\Microsoft\Windows\USERCLASS.DAT` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реИ Windows Vista рдФрд░ Windows 2008 рд╕рд░реНрд╡рд░ рдХреЗ рдмрд╛рдж рд╕реЗред

### рдЙрдкрдХрд░рдг

рдХреБрдЫ рдЙрдкрдХрд░рдг рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИрдВ:

* **рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕рдВрдкрд╛рджрдХ**: рдпрд╣ Windows рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рд╣реИред рдпрд╣ рд╡рд░реНрддрдорд╛рди рд╕рддреНрд░ рдХреА Windows рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ GUI рд╣реИред
* [**рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░**](https://ericzimmerman.github.io/#!index.md): рдпрд╣ рдЖрдкрдХреЛ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдлрд╝рд╛рдЗрд▓ рд▓реЛрдб рдХрд░рдиреЗ рдФрд░ рдЙрдирдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдПрдХ GUI рдХреЗ рд╕рд╛рдеред рдпрд╣ рдмреБрдХрдорд╛рд░реНрдХреНрд╕ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд╡рд╛рд▓реЗ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд░рддрд╛ рд╣реИред
* [**RegRipper**](https://github.com/keydet89/RegRipper3.0): рдлрд┐рд░ рд╕реЗ, рдЗрд╕рдореЗрдВ рдПрдХ GUI рд╣реИ рдЬреЛ рд▓реЛрдб рдХрд┐рдП рдЧрдП рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдФрд░ рд▓реЛрдб рдХрд┐рдП рдЧрдП рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд▓рдЧрдЗрдиреНрд╕ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
* [**Windows рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд░рд┐рдХрд╡рд░реА**](https://www.mitec.cz/wrr.html): рдПрдХ рдФрд░ GUI рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬреЛ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд░рдЦрддрд╛ рд╣реИред

### рд╣рдЯрд╛рдП рдЧрдП рддрддреНрд╡ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛

рдЬрдм рдПрдХ рдХреБрдВрдЬреА рд╣рдЯрд╛рдИ рдЬрд╛рддреА рд╣реИ рддреЛ рдЙрд╕реЗ рдРрд╕рд╛ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЬрдм рддрдХ рд╡рд╣ рдЬрдЧрд╣ рдЬрд┐рд╕реЗ рд╡рд╣ рдзрд╛рд░рдг рдХрд░ рд░рд╣реА рд╣реИ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реЛрддреА, рддрдм рддрдХ рд╡рд╣ рд╣рдЯрд╛рдпрд╛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, **рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░** рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрди рд╣рдЯрд╛рдП рдЧрдП рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### рдЕрдВрддрд┐рдо рд▓реЗрдЦрди рд╕рдордп

рдкреНрд░рддреНрдпреЗрдХ рдХреБрдВрдЬреА-рдорд╛рди рдореЗрдВ рдПрдХ **рд╕рдордп рдЪрд┐рд╣реНрдирд╛рдВрдХ** рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ рдЖрдЦрд┐рд░реА рдмрд╛рд░ рдпрд╣ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

### SAM

рдлрд╝рд╛рдЗрд▓/рд╣рд╛рдЗрд╡ **SAM** рдореЗрдВ рд╕рд┐рд╕реНрдЯрдо рдХреЗ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛, рд╕рдореВрд╣ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╛рд╕рд╡рд░реНрдб** рд╣реИрд╢ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред

`SAM\Domains\Account\Users` рдореЗрдВ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо, RID, рдЕрдВрддрд┐рдо рд▓реЙрдЧрд┐рди, рдЕрдВрддрд┐рдо рд╡рд┐рдлрд▓ рд▓реЙрдЧрд┐рди, рд▓реЙрдЧрд┐рди рдХрд╛рдЙрдВрдЯрд░, рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐ рдФрд░ рдЦрд╛рддрд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред **рд╣реИрд╢** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдлрд╝рд╛рдЗрд▓/рд╣рд╛рдЗрд╡ **SYSTEM** рдХреА рднреА **рдЖрд╡рд╢реНрдпрдХрддрд╛** рд╣реИред

### Windows рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ

{% content-ref url="interesting-windows-registry-keys.md" %}
[interesting-windows-registry-keys.md](interesting-windows-registry-keys.md)
{% endcontent-ref %}

## рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдо

### рдореМрд▓рд┐рдХ Windows рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ

[рдЗрд╕ рдкреЛрд╕реНрдЯ](https://jonahacks.medium.com/investigating-common-windows-processes-18dee5f97c1d) рдореЗрдВ рдЖрдк рд╕рдВрджреЗрд╣рд╛рддреНрдордХ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдп Windows рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реАрдЦ рд╕рдХрддреЗ рд╣реИрдВред

### Windows рд╣рд╛рд▓ рдХреЗ APPs

рд░рдЬрд┐рд╕реНрдЯреНрд░реА `NTUSER.DAT` рдореЗрдВ рдкрде `Software\Microsoft\Current Version\Search\RecentApps` рдореЗрдВ рдЖрдк **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди**, **рдЕрдВрддрд┐рдо рд╕рдордп** рдЬрдм рдпрд╣ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ **рдХрд┐рддрдиреА рдмрд╛рд░** рдпрд╣ рдЪрд▓рд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА рд╕рдмрдХреАрдЬ рд╣реЛ рд╕рдХрддреА рд╣реИред

### BAM (рдкреГрд╖реНрдарднреВрдорд┐ рдЧрддрд┐рд╡рд┐рдзрд┐ рдирд┐рдпрдВрддреНрд░рдХ)

рдЖрдк рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕рдВрдкрд╛рджрдХ рдХреЗ рд╕рд╛рде `SYSTEM` рдлрд╝рд╛рдЗрд▓ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкрде `SYSTEM\CurrentControlSet\Services\bam\UserSettings\{SID}` рдореЗрдВ рдЖрдк рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдЬрд╛рдирдХрд╛рд░реА** (рдкрде рдореЗрдВ `{SID}` рдзреНрдпрд╛рди рджреЗрдВ) рдФрд░ **рдХрдм** рд╡реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЧрдП рдереЗ (рд╕рдордп рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рдбреЗрдЯрд╛ рдорд╛рди рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ) рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### Windows Prefetch

рдкреНрд░реАрдлреЗрдЪрд┐рдВрдЧ рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рдПрдХ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рдЪреБрдкрдЪрд╛рдк **рдЙрд╕реЗ рдЖрд╡рд╢реНрдпрдХ рд╕рдВрд╕рд╛рдзрди рд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдЬреЛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд┐рдХрдЯ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдкрд╣реБрдБрдЪ рд╕рдХрддрд╛ рд╣реИ** рддрд╛рдХрд┐ рд╕рдВрд╕рд╛рдзрди рддреЗрдЬреА рд╕реЗ рдкрд╣реБрдБрдЪреЗ рдЬрд╛ рд╕рдХреЗрдВред

Windows рдкреНрд░реАрдлреЗрдЪ рдореЗрдВ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рдХреИрд╢** рдмрдирд╛рдиреЗ рд╕реЗ рдЙрдиреНрд╣реЗрдВ рддреЗрдЬреА рд╕реЗ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИред рдпреЗ рдХреИрд╢реЗрдЬ `.pf` рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рддреЗ рд╣реИрдВ рдкрде рдореЗрдВ: `C:\Windows\Prefetch`ред XP/VISTA/WIN7 рдореЗрдВ 128 рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕реАрдорд╛ рд╣реЛрддреА рд╣реИ рдФрд░ Win8/Win10 рдореЗрдВ 1024 рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рд╣реИрдВред

рдлрд╝рд╛рдЗрд▓ рдирд╛рдо `{рдкреНрд░реЛрдЧреНрд░рд╛рдо_рдирд╛рдо}-{рд╣реИрд╢}.pf` рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ (рд╣реИрд╢ рдкрде рдФрд░ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рддрд░реНрдХреЛрдВ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ)ред W10 рдореЗрдВ рдпреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕рдВрдХреБрдЪрд┐рдд рд╣реЛрддреА рд╣реИрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдлрд╝рд╛рдЗрд▓ рдХреА рдХреЗрд╡рд▓ рдореМрдЬ
```bash
.\PECmd.exe -d C:\Users\student\Desktop\Prefetch --html "C:\Users\student\Desktop\out_folder"
```
![](<../../../.gitbook/assets/image (487).png>)

### рд╕реБрдкрд░рдкреНрд░реАрдлреЗрдЪ

**рд╕реБрдкрд░рдкреНрд░реАрдлреЗрдЪ** рдХрд╛ рдЙрд╕реА рд▓рдХреНрд╖реНрдп рд╣реИ рдЬреИрд╕реЗ рдкреНрд░реАрдлреЗрдЪ, **рдкреНрд░реЛрдЧреНрд░рд╛рдореНрд╕ рдХреЛ рддреЗрдЬреА рд╕реЗ рд▓реЛрдб рдХрд░рдирд╛** рдЕрдЧрд▓реЗ рдХреНрдпрд╛ рд▓реЛрдб рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ рдХрд╛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХрд░рдХреЗред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдкреНрд░реАрдлреЗрдЪ рд╕реЗрд╡рд╛ рдХреА рдЬрдЧрд╣ рдирд╣реАрдВ рд▓реЗрддрд╛ рд╣реИред\
рдпрд╣ рд╕реЗрд╡рд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рдлрд╝рд╛рдЗрд▓реНрд╕ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧреА `C:\Windows\Prefetch\Ag*.db` рдореЗрдВред

рдЗрди рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЖрдк **рдкреНрд░реЛрдЧреНрд░рд╛рдо** рдХрд╛ **рдирд╛рдо**, **рдПрдХреНрдЬреАрдХреНрдпреВрд╢рдиреНрд╕** рдХреА **рд╕рдВрдЦреНрдпрд╛**, **рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреЛрд▓реА рдЧрдИ**, **рд╡реЙрд▓реНрдпреВрдо рдПрдХреНрд╕реЗрд╕**, **рдкреВрд░рд╛ рдкрде**, **рд╕рдордпрдЕрдВрддрд░** рдФрд░ **рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕** рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдЙрдкрдХрд░рдг [**CrowdResponse**](https://www.crowdstrike.com/resources/community-tools/crowdresponse/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред

### SRUM

**рд╕рд┐рд╕реНрдЯрдо рд░рд┐рд╕реЛрд░реНрд╕ рдпреВрдЬрд╝реЗрдЬ рдореЙрдирд┐рдЯрд░** (SRUM) **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╕рдВрд╕рд╛рдзрдиреЛрдВ** рдХрд╛ **рдирд┐рдЧрд░рд╛рдиреА** рдХрд░рддрд╛ рд╣реИред рдпрд╣ W8 рдореЗрдВ рдкреНрд░рдХрдЯ рд╣реБрдЖ рдФрд░ рдбреЗрдЯрд╛ рдХреЛ `C:\Windows\System32\sru\SRUDB.dat` рдореЗрдВ рд╕реНрдерд┐рдд рдПрдХ ESE рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:

* рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЖрдИрдбреА рдФрд░ рдкрде
* рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЪрд▓рд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛
* рднреЗрдЬреЗ рдЧрдП рдмрд╛рдЗрдЯреНрд╕
* рдкреНрд░рд╛рдкреНрдд рдмрд╛рдЗрдЯреНрд╕
* рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕
* рдХрдиреЗрдХреНрд╢рди рдЕрд╡рдзрд┐
* рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрд╡рдзрд┐

рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд╣рд░ 60 рдорд┐рдирдЯ рдореЗрдВ рдЕрдкрдбреЗрдЯ рд╣реЛрддреА рд╣реИред

рдЖрдк рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЙрдкрдХрд░рдг [**srum\_dump**](https://github.com/MarkBaggett/srum-dump) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред
```bash
.\srum_dump.exe -i C:\Users\student\Desktop\SRUDB.dat -t SRUM_TEMPLATE.xlsx -o C:\Users\student\Desktop\srum
```
### AppCompatCache (ShimCache)

**AppCompatCache**, рдЬрд┐рд╕реЗ **ShimCache** рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, **Microsoft** рджреНрд╡рд╛рд░рд╛ рд╡рд┐рдХрд╕рд┐рдд **Application Compatibility Database** рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдмрдирддрд╛ рд╣реИ рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕рдВрдЧрддрддрд╛ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред рдпрд╣ рд╕рд┐рд╕реНрдЯрдо рдХреЙрдореНрдкреЛрдиреЗрдВрдЯ рд╡рд┐рднрд┐рдиреНрди рдлрд╝рд╛рдЗрд▓ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

- рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкреВрд░рд╛ рдкрде
- рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЖрдХрд╛рд░
- Last Modified time under **$Standard\_Information** (SI)
- Last Updated time of the ShimCache
- Process Execution Flag

Such data is stored within the registry at specific locations based on the version of the operating system:

- For XP, the data is stored under `SYSTEM\CurrentControlSet\Control\SessionManager\Appcompatibility\AppcompatCache` with a capacity for 96 entries.
- рдЙрдкрд╕рд░реНрд╡рд░ 2003 рдХреЗ рд▓рд┐рдП, рд╕рд╛рде рд╣реА Windows рд╕рдВрд╕реНрдХрд░рдг 2008, 2012, 2016, 7, 8, рдФрд░ 10 рдХреЗ рд▓рд┐рдП, рд╕реНрдЯреЛрд░реЗрдЬ рдкрде `SYSTEM\CurrentControlSet\Control\SessionManager\AppcompatCache\AppCompatCache` рд╣реИ, рдЬрд┐рд╕рдореЗрдВ 512 рдФрд░ 1024 рдПрдВрдЯреНрд░реА рдХреЛ рд╕рдорд╛рд╣рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

рд╕рдВрдЧреНрд░рд╣рд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, [**AppCompatCacheParser** рдЯреВрд▓](https://github.com/EricZimmerman/AppCompatCacheParser) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕реБрдЭрд╛рд╡рд┐рдд рд╣реИред

![](<../../../.gitbook/assets/image (488).png>)

### Amcache

**Amcache.hve** рдлрд╝рд╛рдЗрд▓ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдПрдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╣рд╛рдЗрд╡ рд╣реИ рдЬреЛ рдПрдХ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХреА рдЧрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рд╡рд┐рд╡рд░рдг рдХреЛ рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИред рдЖрдорддреМрд░ рдкрд░ рдпрд╣ `C:\Windows\AppCompat\Programas\Amcache.hve` рдкрд░ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпрд╣ рдлрд╝рд╛рдЗрд▓ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд░рд┐рдХреЙрд░реНрдб рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрдиреАрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдкрде рдФрд░ рдЙрдирдХреЗ SHA1 рд╣реИрд╢ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐ рдХрд╛ рдЯреНрд░реИрдХрд┐рдВрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдореВрд▓реНрдп рд╣реИред

**Amcache.hve** рд╕реЗ рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдиреЗ рдФрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, [**AmcacheParser**](https://github.com/EricZimmerman/AmcacheParser) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ рдХрд┐ AmcacheParser рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдП **Amcache.hve** рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдФрд░ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ CSV рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП:
```bash
AmcacheParser.exe -f C:\Users\genericUser\Desktop\Amcache.hve --csv C:\Users\genericUser\Desktop\outputFolder
```
рдореЗрдВ рдЙрддреНрдкрдиреНрди CSV рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ, `Amcache_Unassociated file entries` рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЕрд╕рдВрдмрджреНрдз рдлрд╝рд╛рдЗрд▓ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд┐рдз рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк CVS рдлрд╝рд╛рдЗрд▓ рдЬреЛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ, рд╡рд╣ рд╣реИ `Amcache_Unassociated file entries`ред

### RecentFileCache

рдЗрд╕ рдЖрд░реНрдЯрд┐рдлреИрдХреНрдЯ рдХреЛ рдХреЗрд╡рд▓ W7 рдореЗрдВ `C:\Windows\AppCompat\Programs\RecentFileCache.bcf` рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдХреБрдЫ рдмрд╛рдЗрдирд░реА рдХреЗ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддрд╛ рд╣реИред

рдЖрдк рдЙрдкрдХрд░рдг [**RecentFileCacheParse**](https://github.com/EricZimmerman/RecentFileCacheParser) рдХрд╛ рдЙрдкрдпреЛрдЧ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдп

рдЖрдк рдЗрдиреНрд╣реЗрдВ `C:\Windows\Tasks` рдпрд╛ `C:\Windows\System32\Tasks` рд╕реЗ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ XML рдХреЗ рд░реВрдк рдореЗрдВ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред

### рд╕реЗрд╡рд╛рдПрдВ

рдЖрдк рдЙрдиреНрд╣реЗрдВ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ `SYSTEM\ControlSet001\Services` рдХреЗ рддрд╣рдд рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдФрд░ рдХрдмред

### **Windows Store**

рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди `\ProgramData\Microsoft\Windows\AppRepository\` рдореЗрдВ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
рдЗрд╕ рднрдВрдбрд╛рд░ рдореЗрдВ рдПрдХ **рд▓реЙрдЧ** рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХреА рдЧрдИ рд╣реИ рдЬреЛ рддрдВрддреНрд░ рдореЗрдВ рд╣реИ рдбреЗрдЯрд╛рдмреЗрд╕ **`StateRepository-Machine.srd`**ред

рдЗрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ, "рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЖрдИрдбреА", "рдкреИрдХреЗрдЬ рдирдВрдмрд░", рдФрд░ "рдкреНрд░рджрд░реНрд╢рди рдирд╛рдо" рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВред рдпреЗ рд╕реНрддрдВрдн рдкреВрд░реНрд╡ рд╕реНрдерд╛рдкрд┐рдд рдФрд░ рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдирдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП рдереЗ рдХреНрдпреЛрдВрдХрд┐ рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рдЖрдИрдбреА рд╕рддрдд рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдПред

рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкрде рдореЗрдВ рднреА рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ: `Software\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\Applications\`\
рдФрд░ **рдЕрдирдЗрдВрд╕реНрдЯреЙрд▓** **рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдореЗрдВ: `Software\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\Deleted\`

## Windows рдШрдЯрдирд╛рдПрдБ

Windows рдШрдЯрдирд╛рдУрдВ рдореЗрдВ рдЬреЛ рдЬрд╛рдирдХрд╛рд░реА рджрд┐рдЦрд╛рдИ рджреЗрддреА рд╣реИ:

* рдХреНрдпрд╛ рд╣реБрдЖ
* рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк (UTC + 0)
* рд╢рд╛рдорд┐рд▓ рд╣реБрдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛
* рд╢рд╛рдорд┐рд▓ рд╣реБрдП рд╣реЛрд╕реНрдЯ (рд╣реЛрд╕реНрдЯрдирд╛рдо, рдЖрдИрдкреА)
* рдкрд╣реБрдВрдЪреЗ рдЧрдП рд╕рдВрдкрддреНрддрд┐рдпрд╛рдБ (рдлрд╝рд╛рдЗрд▓реЗрдВ, рдлрд╝реЛрд▓реНрдбрд░, рдкреНрд░рд┐рдВрдЯрд░, рд╕реЗрд╡рд╛рдПрдБ)

рд▓реЙрдЧ `C:\Windows\System32\config` рдореЗрдВ рдкрд╣рд▓реЗ Windows Vista рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ `C:\Windows\System32\winevt\Logs` рдореЗрдВ Windows Vista рдХреЗ рдмрд╛рдж рд╕реНрдерд┐рдд рд╣реИрдВред Windows Vista рд╕реЗ рдкрд╣рд▓реЗ, рдЗрд╡реЗрдВрдЯ рд▓реЙрдЧ рдмрд╛рдЗрдирд░реА рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдереЗ рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж, рд╡реЗ **XML рдкреНрд░рд╛рд░реВрдк** рдореЗрдВ рд╣реИрдВ рдФрд░ **.evtx** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред

рдЗрд╡реЗрдВрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕реНрдерд┐рддрд┐ рд╕рд┐рд╕реНрдЯрдо рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдорд┐рд▓ рд╕рдХрддреА рд╣реИ **`HKLM\SYSTEM\CurrentControlSet\services\EventLog\{Application|System|Security}`**

рдЗрдиреНрд╣реЗрдВ Windows рдЗрд╡реЗрдВрдЯ рд╡реНрдпреВрдЕрд░ (**`eventvwr.msc`**) рд╕реЗ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ [**рдЗрд╡реЗрдВрдЯ рд▓реЙрдЧ рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░**](https://eventlogxp.com) **рдпрд╛** [**Evtx рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░/EvtxECmd**](https://ericzimmerman.github.io/#!index.md)** рдЬреИрд╕реЗ рдЕрдиреНрдп рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рдеред**

## Windows рд╕реБрд░рдХреНрд╖рд╛ рдЗрд╡реЗрдВрдЯ рд▓реЙрдЧрд┐рдВрдЧ рдХреЛ рд╕рдордЭрдирд╛

рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдиреНрдпрд╛рд╕ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдПрдХреНрд╕реЗрд╕ рдЗрд╡реЗрдВрдЯ рд░рд┐рдХреЙрд░реНрдб рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬреЛ `C:\Windows\System32\winevt\Security.evtx` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЖрдХрд╛рд░ рд╕рдорд╛рдпреЛрдЬреНрдп рд╣реИ, рдФрд░ рдЬрдм рдЗрд╕рдХреА рдХреНрд╖рдорддрд╛ рдкреВрд░реА рд╣реЛ рдЬрд╛рддреА рд╣реИ, рдкреБрд░рд╛рдиреЗ рдЗрд╡реЗрдВрдЯ рдУрд╡рд░рд░рд╛рдЗрдЯ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред рд░рд┐рдХреЙрд░реНрдб рдХрд┐рдП рдЧрдП рдЗрд╡реЗрдВрдЯ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрд┐рди рдФрд░ рд▓реЙрдЧрдСрдл, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреНрд░рд┐рдпрд╛рдПрдБ, рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рд╕рд╛рде, рд╕рд╛рде рд╣реА рдлрд╝рд╛рдЗрд▓, рдлрд╝реЛрд▓реНрдбрд░, рдФрд░ рд╕рд╛рдЭрд╛ рд╕рдВрдкрддреНрддрд┐ рдПрдХреНрд╕реЗрд╕ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдореБрдЦреНрдп рдЗрд╡реЗрдВрдЯ рдЖрдИрдбреА:

- **EventID 4624**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рдорд╛рдгреАрдХреГрдд рд╣реИред
- **EventID 4625**: рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╡рд┐рдлрд▓рддрд╛ рдХреА рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИред
- **EventIDs 4634/4647**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрдСрдл рдЗрд╡реЗрдВрдЯ рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реИред
- **EventID 4672**: рдкреНрд░рдмрдВрдзрдиреАрдп рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред
#### рд╕рд┐рд╕реНрдЯрдо рдкрд╛рд╡рд░ рдЗрд╡реЗрдВрдЯреНрд╕

рдЗрд╡реЗрдВрдЯрдЖрдИрдбреА 6005 рд╕рд┐рд╕реНрдЯрдо рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЗрд╡реЗрдВрдЯрдЖрдИрдбреА 6006 рд╢рдЯрдбрд╛рдЙрди рдХреЛ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░рддрд╛ рд╣реИред

#### рд▓реЙрдЧ рд╣рдЯрд╛рдирд╛

рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдЗрд╡реЗрдВрдЯрдЖрдИрдбреА 1102 рд▓реЙрдЧ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреА рд╕реВрдЪрдирд╛ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рдлреЛрд░реЗрдВрд╕рд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЗрд╡реЗрдВрдЯ рд╣реИред

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
