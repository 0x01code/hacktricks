# Windows Artifacts

## Windows Artifacts

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рддрдХ рдкрд╣реБрдБрдЪрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **[**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **Twitter рдкрд░** рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **hacktricks repo** рдФрд░ [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## Generic Windows Artifacts

### Windows 10 Notifications

рдкрде `\Users\<username>\AppData\Local\Microsoft\Windows\Notifications` рдореЗрдВ рдЖрдк рдбреЗрдЯрд╛рдмреЗрд╕ `appdb.dat` (Windows anniversary рд╕реЗ рдкрд╣рд▓реЗ) рдпрд╛ `wpndatabase.db` (Windows Anniversary рдХреЗ рдмрд╛рдж) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ SQLite рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЕрдВрджрд░, рдЖрдк `Notification` рдЯреЗрдмрд▓ рдореЗрдВ рд╕рднреА рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди (XML рдкреНрд░рд╛рд░реВрдк рдореЗрдВ) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдбреЗрдЯрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### Timeline

Timeline рдПрдХ Windows рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬреЛ рд╡реЗрдм рдкреЗрдЬреЛрдВ рдХреЗ рджреМрд░реЗ, рд╕рдВрдкрд╛рджрд┐рдд рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ, рдФрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХрд╛ **рдХрд╛рд▓рд╛рдиреБрдХреНрд░рдорд┐рдХ рдЗрддрд┐рд╣рд╛рд╕** рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред

рдбреЗрдЯрд╛рдмреЗрд╕ рдкрде `\Users\<username>\AppData\Local\ConnectedDevicesPlatform\<id>\ActivitiesCache.db` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред рдЗрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ SQLite рдЯреВрд▓ рдХреЗ рд╕рд╛рде рдпрд╛ [**WxTCmd**](https://github.com/EricZimmerman/WxTCmd) рдЯреВрд▓ рдХреЗ рд╕рд╛рде рдЦреЛрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ **рдЬреЛ 2 рдлрд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ [**TimeLine Explorer**](https://ericzimmerman.github.io/#!index.md) рдЯреВрд▓ рдХреЗ рд╕рд╛рде рдЦреЛрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред**

### ADS (Alternate Data Streams)

рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдлрд╛рдЗрд▓реЗрдВ **ADS Zone.Identifier** рдпреБрдХреНрдд рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреА рд╣реИрдВ рдХрд┐ рдлрд╛рдЗрд▓ рдХреЛ рдЗрдВрдЯреНрд░рд╛рдиреЗрдЯ, рдЗрдВрдЯрд░рдиреЗрдЯ, рдЖрджрд┐ рд╕реЗ **рдХреИрд╕реЗ** **рдбрд╛рдЙрдирд▓реЛрдб** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдХреБрдЫ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ (рдЬреИрд╕реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░) рдЖрдорддреМрд░ рдкрд░ **рдФрд░ рднреА** **рдЬрд╛рдирдХрд╛рд░реА** рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рдлрд╛рдЗрд▓ рдХрд╣рд╛рдБ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдереА рдЙрд╕рдХрд╛ **URL**ред

## **File Backups**

### Recycle Bin

Vista/Win7/Win8/Win10 рдореЗрдВ **Recycle Bin** рдбреНрд░рд╛рдЗрд╡ рдХреА рдЬрдбрд╝ рдореЗрдВ рдлреЛрд▓реНрдбрд░ **`$Recycle.bin`** рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (`C:\$Recycle.bin`).\
рдЬрдм рдЗрд╕ рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ рдлрд╛рдЗрд▓ рдХреЛ рд╣рдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ 2 рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╛рдЗрд▓реЗрдВ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИрдВ:

* `$I{id}`: рдлрд╛рдЗрд▓ рдЬрд╛рдирдХрд╛рд░реА (рдЬрдм рдпрд╣ рд╣рдЯрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЙрд╕рдХреА рддрд╛рд░реАрдЦ)
* `$R{id}`: рдлрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА

![](<../../../.gitbook/assets/image (486).png>)

рдЗрди рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рд╣реЛрдиреЗ рдкрд░ рдЖрдк [**Rifiuti**](https://github.com/abelcheung/rifiuti2) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдЯрд╛рдП рдЧрдП рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рдореВрд▓ рдкрддреЗ рдФрд░ рд╣рдЯрд╛рдиреЗ рдХреА рддрд╛рд░реАрдЦ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (Vista тАУ Win10 рдХреЗ рд▓рд┐рдП `rifiuti-vista.exe` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ)ред
```
.\rifiuti-vista.exe C:\Users\student\Desktop\Recycle
```
### рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкреАрдЬ

рд╢реИрдбреЛ рдХреЙрдкреА рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╡рд┐рдВрдбреЛрдЬ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдлрд╛рдЗрд▓реЛрдВ рдпрд╛ рд╡реЙрд▓реНрдпреВрдореНрд╕ рдХреА **рдмреИрдХрдЕрдк рдХреЙрдкреАрдЬ** рдпрд╛ рд╕реНрдиреИрдкрд╢реЙрдЯреНрд╕ рдмрдирд╛ рд╕рдХрддреА рд╣реИ, рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдЬрдм рд╡реЗ рдЗрд╕реНрддреЗрдорд╛рд▓ рдореЗрдВ рд╣реЛрдВред

рдпреЗ рдмреИрдХрдЕрдк рдЖрдорддреМрд░ рдкрд░ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реВрдЯ рд╕реЗ `\System Volume Information` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдирд╛рдо **UIDs** рд╕реЗ рдмрдирд╛ рд╣реЛрддрд╛ рд╣реИ рдЬреИрд╕рд╛ рдХрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд┐рддреНрд░ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:

![](<../../../.gitbook/assets/image (520).png>)

**ArsenalImageMounter** рдХреЗ рд╕рд╛рде рдлреЛрд░реЗрдВрд╕рд┐рдХ рдЗрдореЗрдЬ рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, [**ShadowCopyView**](https://www.nirsoft.net/utils/shadow\_copy\_view.html) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╢реИрдбреЛ рдХреЙрдкреА рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рд╢реИрдбреЛ рдХреЙрдкреА рдмреИрдХрдЕрдкреНрд╕ рд╕реЗ **рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓рд╛** рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![](<../../../.gitbook/assets/image (521).png>)

рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\BackupRestore` рдореЗрдВ **рдмреИрдХрдЕрдк рдирд╣реАрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдлрд╛рдЗрд▓реЗрдВ рдФрд░ рдХреБрдВрдЬрд┐рдпрд╛рдБ рд╣реЛрддреА рд╣реИрдВ:

![](<../../../.gitbook/assets/image (522).png>)

рд░рдЬрд┐рд╕реНрдЯреНрд░реА `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VSS` рдореЗрдВ рднреА `Volume Shadow Copies` рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред

### рдСрдлрд┐рд╕ рдСрдЯреЛрд╕реЗрд╡реНрдб рдлрд╛рдЗрд▓реНрд╕

рдЖрдк рдСрдлрд┐рд╕ рдСрдЯреЛрд╕реЗрд╡реНрдб рдлрд╛рдЗрд▓реНрд╕ рдХреЛ рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: `C:\Usuarios\\AppData\Roaming\Microsoft{Excel|Word|Powerpoint}\`

## рд╢реЗрд▓ рдЖрдЗрдЯрдореНрд╕

рдПрдХ рд╢реЗрд▓ рдЖрдЗрдЯрдо рдПрдХ рдРрд╕реА рд╡рд╕реНрддреБ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рджреВрд╕рд░реА рдлрд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред

### рд╣рд╛рд▓ рдХреЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ (LNK)

рд╡рд┐рдВрдбреЛрдЬ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ** рдпреЗ **рд╢реЙрд░реНрдЯрдХрдЯреНрд╕** рдмрдирд╛рддрд╛ рд╣реИ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдЦреЛрд▓рддрд╛ рд╣реИ, рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдлрд╛рдЗрд▓ рдмрдирд╛рддрд╛ рд╣реИ**:

* Win7-Win10: `C:\Users\\AppData\Roaming\Microsoft\Windows\Recent\`
* Office: `C:\Users\\AppData\Roaming\Microsoft\Office\Recent\`

рдЬрдм рдПрдХ рдлреЛрд▓реНрдбрд░ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕ рдлреЛрд▓реНрдбрд░, рдорд╛рддрд╛-рдкрд┐рддрд╛ рдлреЛрд▓реНрдбрд░, рдФрд░ рджрд╛рджрд╛-рджрд╛рджреА рдлреЛрд▓реНрдбрд░ рдХрд╛ рднреА рд▓рд┐рдВрдХ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдИ рдЧрдИ рд▓рд┐рдВрдХ рдлрд╛рдЗрд▓реЗрдВ **рдореВрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреА рд╣реИрдВ** рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ рдПрдХ **рдлрд╛рдЗрд▓** рд╣реИ **рдпрд╛** рдПрдХ **рдлреЛрд▓реНрдбрд░**, **MAC** **рд╕рдордп** рдЙрд╕ рдлрд╛рдЗрд▓ рдХрд╛, **рд╡реЙрд▓реНрдпреВрдо рдЬрд╛рдирдХрд╛рд░реА** рдЬрд╣рд╛рдБ рдлрд╛рдЗрд▓ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ рдФрд░ **рд▓рдХреНрд╖реНрдп рдлрд╛рдЗрд▓ рдХрд╛ рдлреЛрд▓реНрдбрд░**ред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдЙрди рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИ рдпрджрд┐ рд╡реЗ рд╣рдЯрд╛ рджреА рдЧрдИ рд╣реЛрдВред

рд╕рд╛рде рд╣реА, рд▓рд┐рдВрдХ рдлрд╛рдЗрд▓ рдХреА **рдмрдирд╛рдИ рдЧрдИ рддрд╛рд░реАрдЦ** рдореВрд▓ рдлрд╛рдЗрд▓ рдХреА **рдкрд╣рд▓реА рдмрд╛рд░** **рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЧрдИ** рддрд╛рд░реАрдЦ рд╣реИ рдФрд░ рд▓рд┐рдВрдХ рдлрд╛рдЗрд▓ рдХреА **рд╕рдВрд╢реЛрдзрд┐рдд рддрд╛рд░реАрдЦ** рдореВрд▓ рдлрд╛рдЗрд▓ рдХреА рдЖрдЦрд┐рд░реА рдмрд╛рд░ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЧрдИ рддрд╛рд░реАрдЦ рд╣реИред

рдЗрди рдлрд╛рдЗрд▓реЛрдВ рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк [**LinkParser**](http://4discovery.com/our-tools/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рдЯреВрд▓ рдореЗрдВ рдЖрдкрдХреЛ **2 рд╕реЗрдЯ** рд╕рдордпрд╕реАрдорд╛ рдорд┐рд▓реЗрдЧреА:

* **рдкрд╣рд▓рд╛ рд╕реЗрдЯ:**
1. FileModifiedDate
2. FileAccessDate
3. FileCreationDate
* **рджреВрд╕рд░рд╛ рд╕реЗрдЯ:**
1. LinkModifiedDate
2. LinkAccessDate
3. LinkCreationDate.

рдкрд╣рд▓рд╛ рд╕реЗрдЯ рд╕рдордпрд╕реАрдорд╛ **рдлрд╛рдЗрд▓ рд╕реНрд╡рдпрдВ рдХреЗ рд╕рдордпрд╕реАрдорд╛ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддрд╛ рд╣реИ**ред рджреВрд╕рд░рд╛ рд╕реЗрдЯ **рд▓рд┐рдВрдХ рдХреА рдЧрдИ рдлрд╛рдЗрд▓ рдХреЗ рд╕рдордпрд╕реАрдорд╛ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддрд╛ рд╣реИ**ред

рдЖрдк рд╡рд┐рдВрдбреЛрдЬ CLI рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА рд╕рдорд╛рди рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [**LECmd.exe**](https://github.com/EricZimmerman/LECmd)
```
LECmd.exe -d C:\Users\student\Desktop\LNKs --csv C:\Users\student\Desktop\LNKs
```
### Jumplists

рдпреЗ рд╡реЗ рд╣рд╛рд▓ рдХреА рдлрд╛рдЗрд▓реЗрдВ рд╣реИрдВ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдЗрдВрдЧрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВред рдпрд╣ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЧрдИ рд╣рд╛рд▓ рдХреА рдлрд╛рдЗрд▓реЛрдВ рдХреА рд╕реВрдЪреА** рд╣реИ рдЬрд┐рд╕реЗ рдЖрдк рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпреЗ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ рдпрд╛ рдХрд╕реНрдЯрдо** рд╣реЛ рд╕рдХрддреА рд╣реИрдВред

рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдИ рдЧрдИ **jumplists** `C:\Users\{username}\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations\` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛рддреА рд╣реИрдВред Jumplists рдХрд╛ рдирд╛рдо `{id}.autmaticDestinations-ms` рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рддреЗ рд╣реБрдП рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдкреНрд░рд╛рд░рдВрднрд┐рдХ ID рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА ID рд╣реЛрддреА рд╣реИред

рдХрд╕реНрдЯрдо jumplists `C:\Users\{username}\AppData\Roaming\Microsoft\Windows\Recent\CustomDestination\` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛рддреА рд╣реИрдВ рдФрд░ рдпреЗ рдЖрдорддреМрд░ рдкрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдлрд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдХреБрдЫ **рдорд╣рддреНрд╡рдкреВрд░реНрдг** рд╣реБрдЖ рд╣реЛрддрд╛ рд╣реИ (рд╢рд╛рдпрдж рдкрд╕рдВрджреАрджрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд)

рдХрд┐рд╕реА рднреА jumplist рдХрд╛ **рдирд┐рд░реНрдорд┐рдд рд╕рдордп** рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ **рдкрд╣рд▓реА рдмрд╛рд░ рдлрд╛рдЗрд▓ рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛** рдФрд░ **рд╕рдВрд╢реЛрдзрд┐рдд рд╕рдордп рдЕрдВрддрд┐рдо рдмрд╛рд░**ред

рдЖрдк [**JumplistExplorer**](https://ericzimmerman.github.io/#!index.md) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ jumplists рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

(_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ JumplistExplorer рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╕рдордпрд╛рдВрдХ jumplist рдлрд╛рдЗрд▓ рд╕реНрд╡рдпрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВ_)

### Shellbags

[**рдЗрд╕ рд▓рд┐рдВрдХ рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ shellbags рдХреНрдпрд╛ рд╣реИрдВред**](interesting-windows-registry-keys.md#shellbags)

## Windows USBs рдХрд╛ рдЙрдкрдпреЛрдЧ

рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ USB рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж:

* Windows Recent Folder
* Microsoft Office Recent Folder
* Jumplists

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреБрдЫ LNK рдлрд╛рдЗрд▓ рдХреЗ рдмрдЬрд╛рдп рдореВрд▓ рдкрде рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, WPDNSE рдлреЛрд▓реНрдбрд░ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рддреА рд╣реИ:

### Registry Information

[рдЗрд╕ рдкреГрд╖реНрда рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ](interesting-windows-registry-keys.md#usb-information) рдЬреЛ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬрд┐рдпрд╛рдБ USB рд╕реЗ рдЬреБрдбрд╝реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреА рд╣реИрдВред

### setupapi

рдлрд╛рдЗрд▓ `C:\Windows\inf\setupapi.dev.log` рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ USB рдХрдиреЗрдХреНрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдордпрд╛рдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП (рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП `Section start`).

### USB Detective

[**USBDetective**](https://usbdetective.com) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрди USB рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ рдЬреЛ рдПрдХ рдЗрдореЗрдЬ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реБрдП рд╣реИрдВред

### Plug and Play Cleanup

'Plug and Play Cleanup' рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдп рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреЗ рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ **рд╕рд╛рдл** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред рдпрд╣ рдкреНрд░рддреАрдд рд╣реЛрддрд╛ рд╣реИ (рдСрдирд▓рд╛рдЗрди рд░рд┐рдкреЛрд░реНрдЯреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░) рдХрд┐ рдпрд╣ **30 рджрд┐рдиреЛрдВ рдореЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдирд╣реАрдВ рдХрд┐рдП рдЧрдП рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреЛ рднреА рдЙрдард╛рддрд╛ рд╣реИ**, рдЗрд╕рдХреЗ рд╡рд┐рд╡рд░рдг рдХреЗ рдмрд╛рд╡рдЬреВрдж рдЬреЛ рдХрд╣рддрд╛ рд╣реИ рдХрд┐ "рдкреНрд░рддреНрдпреЗрдХ рдбреНрд░рд╛рдЗрд╡рд░ рдкреИрдХреЗрдЬ рдХрд╛ рд╕рдмрд╕реЗ рд╡рд░реНрддрдорд╛рди рд╕рдВрд╕реНрдХрд░рдг рд░рдЦрд╛ рдЬрд╛рдПрдЧрд╛"ред рдЗрд╕ рдкреНрд░рдХрд╛рд░, **30 рджрд┐рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЬреБрдбрд╝реЗ рдирд╣реАрдВ рдЧрдП рд╣рдЯрд╛рдиреЗ рдпреЛрдЧреНрдп рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреЛ рд╣рдЯрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред

рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдп рд╕реНрд╡рдпрдВ 'C:\Windows\System32\Tasks\Microsoft\Windows\Plug and Play\Plug and Play Cleanup' рдкрд░ рд╕реНрдерд┐рдд рд╣реИ, рдФрд░ рдЗрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдиреАрдЪреЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХреА рдЧрдИ рд╣реИ:

### Emails

рдИрдореЗрд▓ рдореЗрдВ **2 рджрд┐рд▓рдЪрд╕реНрдк рднрд╛рдЧ рд╣реЛрддреЗ рд╣реИрдВ: рд╣реЗрдбрд░реНрд╕ рдФрд░ рдИрдореЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА**ред **рд╣реЗрдбрд░реНрд╕** рдореЗрдВ рдЖрдк рдЬрд╛рдирдХрд╛рд░реА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ:

* **рдХрд┐рд╕рдиреЗ** рдИрдореЗрд▓ рднреЗрдЬреЗ (рдИрдореЗрд▓ рдкрддрд╛, IP, рдореЗрд▓ рд╕рд░реНрд╡рд░ рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ рдИрдореЗрд▓ рдХреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд┐рдпрд╛)
* **рдХрдм** рдИрдореЗрд▓ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛

рд╕рд╛рде рд╣реА, `References` рдФрд░ `In-Reply-To` рд╣реЗрдбрд░реНрд╕ рдореЗрдВ рдЖрдк рд╕рдВрджреЗрд╢реЛрдВ рдХреА ID рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

### Windows Mail App

рдпрд╣ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдИрдореЗрд▓ рдХреЛ HTML рдпрд╛ рдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ рд╕реЗрд╡ рдХрд░рддрд╛ рд╣реИред рдЖрдк `\Users\<username>\AppData\Local\Comms\Unistore\data\3\` рдХреЗ рдЕрдВрджрд░ рд╕рдмрдлреЛрд▓реНрдбрд░реНрд╕ рдореЗрдВ рдИрдореЗрд▓ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдИрдореЗрд▓ `.dat` рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рд╕реЗрд╡ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

рдИрдореЗрд▓ рдХреА **рдореЗрдЯрд╛рдбреЗрдЯрд╛** рдФрд░ **рд╕рдВрдкрд░реНрдХ** **EDB рдбреЗрдЯрд╛рдмреЗрд╕** рдХреЗ рдЕрдВрджрд░ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ: `\Users\<username>\AppData\Local\Comms\UnistoreDB\store.vol`

**рдлрд╛рдЗрд▓ рдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдмрджрд▓реЗрдВ** `.vol` рд╕реЗ `.edb` рдореЗрдВ рдФрд░ рдЖрдк [ESEDatabaseView](https://www.nirsoft.net/utils/ese\_database\_view.html) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВред `Message` рдЯреЗрдмрд▓ рдХреЗ рдЕрдВрджрд░ рдЖрдк рдИрдореЗрд▓ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

### Microsoft Outlook

рдЬрдм Exchange рд╕рд░реНрд╡рд░ рдпрд╛ Outlook рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдХреБрдЫ MAPI рд╣реЗрдбрд░реНрд╕ рд╣реЛрдВрдЧреЗ:

* `Mapi-Client-Submit-Time`: рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рд╕рдордп рдЬрдм рдИрдореЗрд▓ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛
* `Mapi-Conversation-Index`: рдереНрд░реЗрдб рдХреЗ рдмрдЪреНрдЪреЛрдВ рдХреЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдФрд░ рдереНрд░реЗрдб рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрджреЗрд╢ рдХрд╛ рд╕рдордпрд╛рдВрдХ
* `Mapi-Entry-ID`: рд╕рдВрджреЗрд╢ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ред
* `Mappi-Message-Flags` рдФрд░ `Pr_last_Verb-Executed`: MAPI рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА (рд╕рдВрджреЗрд╢ рдкрдврд╝рд╛ рдЧрдпрд╛? рдирд╣реАрдВ рдкрдврд╝рд╛ рдЧрдпрд╛? рдЬрд╡рд╛рдм рджрд┐рдпрд╛ рдЧрдпрд╛? рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛? рдСрдлрд┐рд╕ рд╕реЗ рдмрд╛рд╣рд░?)

Microsoft Outlook рдХреНрд▓рд╛рдЗрдВрдЯ рдореЗрдВ, рд╕рднреА рднреЗрдЬреЗ/рдкреНрд░рд╛рдкреНрдд рд╕рдВрджреЗрд╢, рд╕рдВрдкрд░реНрдХ рдбреЗрдЯрд╛, рдФрд░ рдХреИрд▓реЗрдВрдбрд░ рдбреЗрдЯрд╛ рдПрдХ PST рдлрд╛рдЗрд▓ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ:

* `%USERPROFILE%\Local Settings\Application Data\Microsoft\Outlook` (WinXP)
* `%USERPROFILE%\AppData\Local\Microsoft\Outlook`

рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкрде `HKEY_CURRENT_USER\Software\Microsoft\WindowsNT\CurrentVersion\Windows Messaging Subsystem\Profiles\Outlook` рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реА рдлрд╛рдЗрд▓ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИред

рдЖрдк [**Kernel PST Viewer**](https://www.nucleustechnologies.com/es/visor-de-pst.html) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PST рдлрд╛рдЗрд▓ рдХреЛ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВред

### Outlook OST

рдЬрдм Microsoft Outlook рдХреЛ **IMAP** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╛ рдПрдХ **Exchange** рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ **OST** рдлрд╛рдЗрд▓ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд▓рдЧрднрдЧ рд╡рд╣реА рдЬрд╛рдирдХрд╛рд░реА PST рдлрд╛рдЗрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдлрд╛рдЗрд▓ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде **рдкрд┐рдЫрд▓реЗ 12 рдорд╣реАрдиреЛрдВ** рдХреЗ рд▓рд┐рдП рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝ рд░рдЦрддреА рд╣реИ, рдПрдХ **рдЕрдзрд┐рдХрддрдо рдлрд╛рдЗрд▓-рдЖрдХрд╛рд░ 50GB** рдХреЗ рд╕рд╛рде рдФрд░ **рд╡рд╣реА рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдЬрд╣рд╛рдВ PST** рдлрд╛рдЗрд▓ рд╕реЗрд╡ рдХреА рдЬрд╛рддреА рд╣реИред рдЖрдк рдЗрд╕ рдлрд╛рдЗрд▓ рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг [**Kernel OST viewer**](https://www.nucleustechnologies.com/ost-viewer.html) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### Recovering Attachments

рдЖрдк рдЙрдиреНрд╣реЗрдВ рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

* `%APPDATA%\Local\Microsoft\Windows\Temporary Internet Files\Content.Outlook` -> IE10
* `%APPDATA%\Local\Microsoft\InetCache\Content.Outlook` -> IE11+

### Thunderbird MBOX

**Thunderbird** рдЬрд╛рдирдХрд╛рд░реА рдХреЛ **MBOX** **рдлрд╛рдЗрд▓реЛрдВ** рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ рдлреЛрд▓реНрдбрд░ `\Users\%USERNAME%\AppData\Roaming\Thunderbird\Profiles` рдореЗрдВред

## Thumbnails

рдЬрдм рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд┐рд╕реА рдлреЛрд▓реНрдбрд░ рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдердВрдмрдиреЗрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рдПрдХ `thumbs.db` рдлрд╛рдЗрд▓ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИред рдпрд╣ db **рдлреЛрд▓реНрдбрд░ рдХреА рдЫрд╡рд┐рдпреЛрдВ рдХреЗ рдердВрдмрдиреЗрд▓реНрд╕ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ** рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдЕрдЧрд░ рд╡реЗ рд╣рдЯрд╛ рджрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред WinXP рдФрд░ Win 8-8.1 рдореЗрдВ рдпрд╣ рдлрд╛рдЗрд▓ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИред Win7/Win10 рдореЗрдВ, рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ рдЕрдЧрд░ рдпрд╣ UNC рдкрде (\IP\folder...) рдХреЗ рдорд╛рдзреНрдпрдо рд╕
```bash
.\PECmd.exe -d C:\Users\student\Desktop\Prefetch --html "C:\Users\student\Desktop\out_folder"
```
### Superprefetch

**Superprefetch** рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рднреА prefetch рдХреА рддрд░рд╣ рд╣реИ, **рдкреНрд░реЛрдЧреНрд░рд╛рдореНрд╕ рдХреЛ рддреЗрдЬреА рд╕реЗ рд▓реЛрдб рдХрд░рдирд╛** рдпрд╣ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдХрд░ рдХрд┐ рдЕрдЧрд▓рд╛ рдХреНрдпрд╛ рд▓реЛрдб рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ prefetch рд╕реЗрд╡рд╛ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИред\
рдпрд╣ рд╕реЗрд╡рд╛ `C:\Windows\Prefetch\Ag*.db` рдореЗрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рдлрд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░рддреА рд╣реИред

рдЗрди рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЖрдк **рдкреНрд░реЛрдЧреНрд░рд╛рдо** рдХрд╛ **рдирд╛рдо**, **рд╕рдВрдЦреНрдпрд╛** **рдЪрд▓рд╛рдиреЗ рдХреА**, **рдЦреЛрд▓реА рдЧрдИ** **рдлрд╛рдЗрд▓реЗрдВ**, **рдкрд╣реБрдВрдЪреА рдЧрдИ** **рд╡реЙрд▓реНрдпреВрдо**, **рдкреВрд░рд╛** **рдкрде**, **рд╕рдордп рд╕реАрдорд╛рдПрдВ** рдФрд░ **рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ [**CrowdResponse**](https://www.crowdstrike.com/resources/community-tools/crowdresponse/) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### SRUM

**System Resource Usage Monitor** (SRUM) **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдЙрдкрднреЛрдЧ рдХрд┐рдП рдЧрдП** **рд╕рдВрд╕рд╛рдзрдиреЛрдВ** рдХреА **рдирд┐рдЧрд░рд╛рдиреА** рдХрд░рддрд╛ рд╣реИред рдпрд╣ W8 рдореЗрдВ рдЖрдпрд╛ рдерд╛ рдФрд░ рдпрд╣ рдбреЗрдЯрд╛ рдХреЛ `C:\Windows\System32\sru\SRUDB.dat` рдореЗрдВ рд╕реНрдерд┐рдд ESE рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛ рд╣реИ:

* AppID рдФрд░ рдкрде
* рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЬрд┐рд╕рдиреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЪрд▓рд╛рдИ
* рднреЗрдЬреЗ рдЧрдП рдмрд╛рдЗрдЯреНрд╕
* рдкреНрд░рд╛рдкреНрдд рдмрд╛рдЗрдЯреНрд╕
* рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕
* рдХрдиреЗрдХреНрд╢рди рдЕрд╡рдзрд┐
* рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрд╡рдзрд┐

рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд╣рд░ 60 рдорд┐рдирдЯ рдореЗрдВ рдЕрдкрдбреЗрдЯ рд╣реЛрддреА рд╣реИред

рдЖрдк рдЗрд╕ рдлрд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ [**srum\_dump**](https://github.com/MarkBaggett/srum-dump) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
.\srum_dump.exe -i C:\Users\student\Desktop\SRUDB.dat -t SRUM_TEMPLATE.xlsx -o C:\Users\student\Desktop\srum
```
### AppCompatCache (ShimCache)

**Shimcache**, рдЬрд┐рд╕реЗ **AppCompatCache** рдХреЗ рдирд╛рдо рд╕реЗ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, **Application Compatibility Database** рдХрд╛ рдПрдХ рдШрдЯрдХ рд╣реИ, рдЬрд┐рд╕реЗ **Microsoft** рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рджреНрд╡рд╛рд░рд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕рдВрдЧрддрддрд╛ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдХреИрд╢ рдореЗрдВ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд┐рднрд┐рдиреНрди рдлрд╛рдЗрд▓ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐:

* рдлрд╛рдЗрд▓ рдкреВрд░рд╛ рдкрде
* рдлрд╛рдЗрд▓ рдЖрдХрд╛рд░
* **$Standard\_Information** (SI) рдЕрдВрддрд┐рдо рд╕рдВрд╢реЛрдзрд┐рдд рд╕рдордп
* ShimCache рдЕрдВрддрд┐рдо рдЕрдкрдбреЗрдЯ рд╕рдордп
* рдкреНрд░реЛрд╕реЗрд╕ рдирд┐рд╖реНрдкрд╛рджрди рдзреНрд╡рдЬ

рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдорд┐рд▓ рд╕рдХрддреА рд╣реИ:

* `SYSTEM\CurrentControlSet\Control\SessionManager\Appcompatibility\AppcompatCache`
* XP (96 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ)
* `SYSTEM\CurrentControlSet\Control\SessionManager\AppcompatCache\AppCompatCache`
* Server 2003 (512 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ)
* 2008/2012/2016 Win7/Win8/Win10 (1024 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ)

рдЖрдк рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**AppCompatCacheParser**](https://github.com/EricZimmerman/AppCompatCacheParser) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

![](<../../../.gitbook/assets/image (488).png>)

### Amcache

**Amcache.hve** рдлрд╛рдЗрд▓ рдПрдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдлрд╛рдЗрд▓ рд╣реИ рдЬреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреА рд╣реИред рдпрд╣ `C:\Windows\AppCompat\Programas\Amcache.hve` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред

**Amcache.hve** рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдЪрд▓рд╛рдП рдЧрдП рдкреНрд░реЛрд╕реЗрд╕реЛрдВ рдХрд╛ рд░рд┐рдХреЙрд░реНрдб рд░рдЦрддрд╛ рд╣реИ рдФрд░ рдЙрди рдлрд╛рдЗрд▓реЛрдВ рдХрд╛ рдкрде рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЧрдП рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд╛ SHA1 рднреА рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИред

рдЖрдк рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**Amcacheparser**](https://github.com/EricZimmerman/AmcacheParser) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
AmcacheParser.exe -f C:\Users\student\Desktop\Amcache.hve --csv C:\Users\student\Desktop\srum
```
### RecentFileCache

рдпрд╣ рдЖрд░реНрдЯрд┐рдлреИрдХреНрдЯ рдХреЗрд╡рд▓ W7 рдореЗрдВ `C:\Windows\AppCompat\Programs\RecentFileCache.bcf` рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рдХреБрдЫ рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХреЗ рд╣рд╛рд▓рд┐рдпрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред

рдЖрдк рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**RecentFileCacheParse**](https://github.com/EricZimmerman/RecentFileCacheParser) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### Scheduled tasks

рдЖрдк рдЗрдиреНрд╣реЗрдВ `C:\Windows\Tasks` рдпрд╛ `C:\Windows\System32\Tasks` рд╕реЗ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ XML рдХреЗ рд░реВрдк рдореЗрдВ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред

### Services

рдЖрдк рдЗрдиреНрд╣реЗрдВ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рдЕрдВрддрд░реНрдЧрдд `SYSTEM\ControlSet001\Services` рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ рдФрд░ рдХрдмред

### **Windows Store**

рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди `\ProgramData\Microsoft\Windows\AppRepository\` рдореЗрдВ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред\
рдЗрд╕ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рдбреЗрдЯрд╛рдмреЗрд╕ **`StateRepository-Machine.srd`** рдХреЗ рдЕрдВрджрд░ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ **рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдерд╛рдкрд┐рдд** рдХреЗ рд╕рд╛рде рдПрдХ **рд▓реЙрдЧ** рд╣реЛрддрд╛ рд╣реИред

рдЗрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЯреЗрдмрд▓ рдореЗрдВ, "Application ID", "PackageNumber", рдФрд░ "Display Name" рдХреЙрд▓рдо рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрди рдХреЙрд▓рдореЛрдВ рдореЗрдВ рдкреНрд░реА-рдЗрдВрд╕реНрдЯреЙрд▓реНрдб рдФрд░ рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИ рдФрд░ рдпрд╣ рднреА рдкрддрд╛ рдЪрд▓ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдирдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП рдереЗ рдХреНрдпреЛрдВрдХрд┐ рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рдЖрдИрдбреА рдХреНрд░рдорд┐рдХ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдПред

рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкрде рдореЗрдВ **рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рднреА рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ: `Software\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\Applications\`\
рдФрд░ **рдЕрдирдЗрдВрд╕реНрдЯреЙрд▓реНрдб** **рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдпрд╣рд╛рдБ рдкрд░ рд╣реИрдВ: `Software\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\Deleted\`

## Windows Events

Windows рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЗ рдЕрдВрджрд░ рдЬреЛ рдЬрд╛рдирдХрд╛рд░реА рдЖрддреА рд╣реИ рд╡рд╣ рд╣реИрдВ:

* рдХреНрдпрд╛ рд╣реБрдЖ
* Timestamp (UTC + 0)
* рд╢рд╛рдорд┐рд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛
* рд╢рд╛рдорд┐рд▓ рд╣реЛрд╕реНрдЯреНрд╕ (hostname, IP)
* рдкрд╣реБрдБрдЪреЗ рдЧрдП рдПрд╕реЗрдЯреНрд╕ (рдлрд╝рд╛рдЗрд▓реЗрдВ, рдлрд╝реЛрд▓реНрдбрд░, рдкреНрд░рд┐рдВрдЯрд░, рд╕реЗрд╡рд╛рдПрдБ)

рд▓реЙрдЧреНрд╕ Windows Vista рд╕реЗ рдкрд╣рд▓реЗ `C:\Windows\System32\config` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИрдВ рдФрд░ Windows Vista рдХреЗ рдмрд╛рдж `C:\Windows\System32\winevt\Logs` рдореЗрдВ рд╣реИрдВред Windows Vista рд╕реЗ рдкрд╣рд▓реЗ, рдЗрд╡реЗрдВрдЯ рд▓реЙрдЧреНрд╕ рдмрд╛рдЗрдирд░реА рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ рдереЗ рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж, рд╡реЗ **XML рдлреЙрд░реНрдореЗрдЯ** рдореЗрдВ рд╣реИрдВ рдФрд░ **.evtx** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред

рдЗрд╡реЗрдВрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рд╕реНрдерд╛рди SYSTEM рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ **`HKLM\SYSTEM\CurrentControlSet\services\EventLog\{Application|System|Security}`**

рдЙрдиреНрд╣реЗрдВ Windows Event Viewer (**`eventvwr.msc`**) рд╕реЗ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдЕрдиреНрдп рдЯреВрд▓реНрд╕ рдЬреИрд╕реЗ рдХрд┐ [**Event Log Explorer**](https://eventlogxp.com) **рдпрд╛** [**Evtx Explorer/EvtxECmd**](https://ericzimmerman.github.io/#!index.md)** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред**

### Security

рдпрд╣ рдПрдХреНрд╕реЗрд╕ рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЛ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛ рд╣реИ рдЬреЛ `C:\Windows\System32\winevt\Security.evtx` рдореЗрдВ рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИред

рдЗрд╡реЗрдВрдЯ рдлрд╝рд╛рдЗрд▓ рдХрд╛ **рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЬрдм рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ рдкрд╣реБрдБрдЪ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдпрд╣ рдкреБрд░рд╛рдиреА рдШрдЯрдирд╛рдУрдВ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрдЧрд╛ред

рд░рдЬрд┐рд╕реНрдЯрд░ рдХреА рдЧрдИ рдШрдЯрдирд╛рдПрдБ рд╣реИрдВ:

* рд▓реЙрдЧрд┐рди/рд▓реЙрдЧрдСрдл
* рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдХреНрд░рд┐рдпрд╛рдПрдБ
* рдлрд╝рд╛рдЗрд▓реЛрдВ, рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдФрд░ рд╕рд╛рдЭрд╛ рдПрд╕реЗрдЯреНрд╕ рддрдХ рдкрд╣реБрдБрдЪ
* рд╕реБрд░рдХреНрд╖рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рд╕рдВрд╢реЛрдзрди

рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдШрдЯрдирд╛рдПрдБ:

| EventID   | рд╡рд┐рд╡рд░рдг                        |
| --------- | ---------------------------- |
| 4624      | рд╕рдлрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг              |
| 4625      | рдкреНрд░рдорд╛рдгреАрдХрд░рдг рддреНрд░реБрдЯрд┐           |
| 4634/4647 | рд▓реЙрдЧ рдСрдл                      |
| 4672      | рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди |

EventID 4634/4647 рдХреЗ рдЕрдВрджрд░ рджрд┐рд▓рдЪрд╕реНрдк рдЙрдк-рдкреНрд░рдХрд╛рд░ рд╣реИрдВ:

* **2 (рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡)**: рд▓реЙрдЧрд┐рди рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдерд╛ рдХреАрдмреЛрд░реНрдб рдпрд╛ VNC рдпрд╛ `PSexec -U-` рдЬреИрд╕реЗ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ
* **3 (рдиреЗрдЯрд╡рд░реНрдХ)**: рд╕рд╛рдЭрд╛ рдлрд╝реЛрд▓реНрдбрд░ рд╕реЗ рдХрдиреЗрдХреНрд╢рди
* **4 (рдмреИрдЪ)**: рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХреА рдЧрдИ
* **5 (рд╕реЗрд╡рд╛)**: рд╕реЗрд╡рд╛ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рдмрдВрдзрдХ рджреНрд╡рд╛рд░рд╛ рд╕реЗрд╡рд╛ рд╢реБрд░реВ рдХреА рдЧрдИ
* **6 (рдкреНрд░реЙрдХреНрд╕реА):** рдкреНрд░реЙрдХреНрд╕реА рд▓реЙрдЧрд┐рди
* **7 (рдЕрдирд▓реЙрдХ)**: рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрдХреНрд░реАрди рдЕрдирдмреНрд▓реЙрдХ рдХреА рдЧрдИ
* **8 (рдиреЗрдЯрд╡рд░реНрдХ рдХреНрд▓рд┐рдпрд░рдЯреЗрдХреНрд╕реНрдЯ)**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдиреЗ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдкрд╛рд╕рд╡рд░реНрдб рднреЗрдЬрдХрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд┐рдпрд╛ред рдпрд╣ рдШрдЯрдирд╛ IIS рд╕реЗ рдЖрддреА рдереА
* **9 (рдирдИ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕)**: рдпрд╣ рддрдм рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ рдЬрдм `RunAs` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрд▓рдЧ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рд╕рд╛рде рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛ рддрдХ рдкрд╣реБрдБрдЪрддрд╛ рд╣реИред
* **10 (рд░рд┐рдореЛрдЯ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡)**: рдЯрд░реНрдорд┐рдирд▓ рд╕реЗрд╡рд╛рдУрдВ рдпрд╛ RDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг
* **11 (рдХреИрд╢ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡)**: рдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓рд░ рд╕реЗ рд╕рдВрдкрд░реНрдХ рдирд╣реАрдВ рд╣реЛ рдкрд╛рдиреЗ рдХреЗ рдХрд╛рд░рдг рдЕрдВрддрд┐рдо рдХреИрд╢ рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╣реБрдБрдЪ
* **12 (рдХреИрд╢ рд░рд┐рдореЛрдЯ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡)**: рдХреИрд╢ рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рд╕рд╛рде рджреВрд░рд╕реНрде рд░реВрдк рд╕реЗ рд▓реЙрдЧрд┐рди (10 рдФрд░ 11 рдХрд╛ рд╕рдВрдпреЛрдЬрди)ред
* **13 (рдХреИрд╢реНрдб рдЕрдирд▓реЙрдХ)**: рдХреИрд╢ рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рд╕рд╛рде рд▓реЙрдХ рдХрд┐рдП рдЧрдП рдорд╢реАрди рдХреЛ рдЕрдирд▓реЙрдХ рдХрд░рдирд╛ред

рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ, рдЖрдк рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЗрди рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓реЙрдЧрд┐рди рдХреЛ рдХреИрд╕реЗ рдирдХрд▓ рдХрд░реЗрдВ рдФрд░ рдЙрдирдореЗрдВ рд╕реЗ рдХрд┐рдирдореЗрдВ рдЖрдк рдореЗрдореЛрд░реА рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдбрдВрдк рдХрд░ рдкрд╛рдПрдВрдЧреЗ: [https://www.alteredsecurity.com/post/fantastic-windows-logon-types-and-where-to-find-credentials-in-them](https://www.alteredsecurity.com/post/fantastic-windows-logon-types-and-where-to-find-credentials-in-them)

рдШрдЯрдирд╛рдУрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдФрд░ рдЙрдк-рд╕реНрдерд┐рддрд┐ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдШрдЯрдирд╛ рдХреЗ рдХрд╛рд░рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдмрддрд╛ рд╕рдХрддреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, Event ID 4625 рдХреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдерд┐рддрд┐ рдФрд░ рдЙрдк-рд╕реНрдерд┐рддрд┐ рдХреЛрдбреНрд╕ рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ:

![](<../../../.gitbook/assets/image (455).png>)

### Recovering Windows Events

рд╕рдВрджрд┐рдЧреНрдз PC рдХреЛ **рдЕрдирдкреНрд▓рдЧ рдХрд░рдХреЗ** рдмрдВрдж рдХрд░рдирд╛ рдЕрддреНрдпрдзрд┐рдХ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ рддрд╛рдХрд┐ Windows рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЛ рд░рд┐рдХрд╡рд░ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рдЕрдзрд┐рдХрддрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЕрдЧрд░ рд╡реЗ рд╣рдЯрд╛ рджрд┐рдП рдЧрдП рд╣реЛрдВ, рддреЛ рдЙрдиреНрд╣реЗрдВ рд░рд┐рдХрд╡рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдЯреВрд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ [**Bulk_extractor**](../partitions-file-systems-carving/file-data-carving-recovery-tools.md#bulk-extractor) рдЬрд┐рд╕рдореЗрдВ **evtx** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛред

## Identifying Common Attacks with Windows Events

* [https://redteamrecipe.com/event-codes/](https://redteamrecipe.com/event-codes/)

### Brute Force Attack

рдПрдХ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдЕрдЯреИрдХ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рдХрдИ EventIDs 4625 рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреЗ**ред рдЕрдЧрд░ рдЕрдЯреИрдХ **рд╕рдлрд▓** рдерд╛, рддреЛ EventIDs 4625 рдХреЗ рдмрд╛рдж, **рдПрдХ EventID 4624 рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛**ред

### Time Change

рдпрд╣ рдлреЛрд░реЗрдВрд╕рд┐рдХ рдЯреАрдо рдХреЗ рд▓рд┐рдП рднрдпрд╛рдирдХ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╕рднреА рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕ рдореЙрдбрд┐рдлрд╛рдЗрдб рд╣реЛ рдЬрд╛рдПрдВрдЧреЗред рдпрд╣ рдШрдЯрдирд╛ Security Event рд▓реЙрдЧ рдореЗрдВ EventID 4616 рджреНрд╡рд╛рд░рд╛ рд░рд┐рдХреЙрд░реНрдб рдХреА рдЬрд╛рддреА рд╣реИред

### USB devices

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд System EventIDs рдЙрдкрдпреЛрдЧреА рд╣реИрдВ:

* 20001 / 20003 / 10000: рдкрд╣рд▓реА рдмрд╛рд░ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛
* 10100: рдбреНрд░рд╛рдЗ
