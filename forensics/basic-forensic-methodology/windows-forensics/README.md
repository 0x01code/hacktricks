# Windows Artifacts

## Windows Artifacts

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## рд╕рд╛рдорд╛рдиреНрдп Windows Artifacts

### Windows 10 Notifications

рдкрде `\Users\<username>\AppData\Local\Microsoft\Windows\Notifications` рдореЗрдВ рдЖрдк `appdb.dat` рдбреЗрдЯрд╛рдмреЗрд╕ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ (Windows anniversary рд╕реЗ рдкрд╣рд▓реЗ) рдпрд╛ `wpndatabase.db` (Windows Anniversary рдХреЗ рдмрд╛рдж).

рдЗрд╕ SQLite рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЕрдВрджрд░, рдЖрдк `Notification` рдЯреЗрдмрд▓ рдореЗрдВ рд╕рднреА рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рдиреНрд╕ (XML рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдбреЗрдЯрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### Timeline

Timeline рдПрдХ Windows рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬреЛ рд╡реЗрдм рдкреЗрдЬреЗрд╕ рдХреЗ рджреМрд░реЗ, рд╕рдВрдкрд╛рджрд┐рдд рджрд╕реНрддрд╛рд╡реЗрдЬрд╝, рдФрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдХрд╛ **рдХрд╛рд▓рд╛рдиреБрдХреНрд░рдорд┐рдХ рдЗрддрд┐рд╣рд╛рд╕** рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред

рдбреЗрдЯрд╛рдмреЗрд╕ рдкрде `\Users\<username>\AppData\Local\ConnectedDevicesPlatform\<id>\ActivitiesCache.db` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред рдЗрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ SQLite рдЯреВрд▓ рдХреЗ рд╕рд╛рде рдпрд╛ [**WxTCmd**](https://github.com/EricZimmerman/WxTCmd) рдЯреВрд▓ рдХреЗ рд╕рд╛рде рдЦреЛрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ **рдЬреЛ 2 рдлрд╛рдЗрд▓реЗрдВ рдЬрдирд░реЗрдЯ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ [**TimeLine Explorer**](https://ericzimmerman.github.io/#!index.md) рдЯреВрд▓ рдХреЗ рд╕рд╛рде рдЦреЛрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред**

### ADS (Alternate Data Streams)

рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдлрд╛рдЗрд▓реЗрдВ **ADS Zone.Identifier** рдпреБрдХреНрдд рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддреА рд╣реИрдВ рдХрд┐ рдлрд╛рдЗрд▓ рдХреЛ рдЗрдВрдЯреНрд░рд╛рдиреЗрдЯ, рдЗрдВрдЯрд░рдиреЗрдЯ, рдЖрджрд┐ рд╕реЗ **рдХреИрд╕реЗ** **рдбрд╛рдЙрдирд▓реЛрдб** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдХреБрдЫ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ (рдЬреИрд╕реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░реНрд╕) рдЖрдорддреМрд░ рдкрд░ **рдФрд░ рднреА** **рдЬрд╛рдирдХрд╛рд░реА** рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рдлрд╛рдЗрд▓ рдХрд╣рд╛рдБ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдереА рдЙрд╕рдХрд╛ **URL**ред

## **рдлрд╛рдЗрд▓ рдмреИрдХрдЕрдкреНрд╕**

### Recycle Bin

Vista/Win7/Win8/Win10 рдореЗрдВ **Recycle Bin** рдбреНрд░рд╛рдЗрд╡ рдХреЗ рд░реВрдЯ рдореЗрдВ **`$Recycle.bin`** рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (`C:\$Recycle.bin`).\
рдЬрдм рдЗрд╕ рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ рдлрд╛рдЗрд▓ рдХреЛ рдбрд┐рд▓реАрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ 2 рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╛рдЗрд▓реЗрдВ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИрдВ:

* `$I{id}`: рдлрд╛рдЗрд▓ рдЬрд╛рдирдХрд╛рд░реА (рдЬрдм рдпрд╣ рдбрд┐рд▓реАрдЯ рдХреА рдЧрдИ рдереА рдЙрд╕рдХреА рддрд╛рд░реАрдЦ)
* `$R{id}`: рдлрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА

![](<../../../.gitbook/assets/image (486).png>)

рдЗрди рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рд╣реЛрдиреЗ рд╕реЗ рдЖрдк [**Rifiuti**](https://github.com/abelcheung/rifiuti2) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбрд┐рд▓реАрдЯ рдХреА рдЧрдИ рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рдореВрд▓ рдкрддреЗ рдФрд░ рдЙрд╕реЗ рдбрд┐рд▓реАрдЯ рдХрд┐рдП рдЬрд╛рдиреЗ рдХреА рддрд╛рд░реАрдЦ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (Vista тАУ Win10 рдХреЗ рд▓рд┐рдП `rifiuti-vista.exe` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ).
```
.\rifiuti-vista.exe C:\Users\student\Desktop\Recycle
```
### рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкреАрдЬ

рд╢реИрдбреЛ рдХреЙрдкреА рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╡рд┐рдВрдбреЛрдЬ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИ рдЬреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдлрд╛рдЗрд▓реЛрдВ рдпрд╛ рд╡реЙрд▓реНрдпреВрдореНрд╕ рдХреА **рдмреИрдХрдЕрдк рдХреЙрдкреАрдЬ** рдпрд╛ рд╕реНрдиреИрдкрд╢реЙрдЯреНрд╕ рдмрдирд╛ рд╕рдХрддреА рд╣реИ, рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдЬрдм рд╡реЗ рдЗрд╕реНрддреЗрдорд╛рд▓ рдореЗрдВ рд╣реЛрдВред

рдпреЗ рдмреИрдХрдЕрдк рдЖрдорддреМрд░ рдкрд░ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реВрдЯ рд╕реЗ `\System Volume Information` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдирд╛рдо **UIDs** рд╕реЗ рдмрдирд╛ рд╣реЛрддрд╛ рд╣реИ рдЬреИрд╕рд╛ рдХрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд┐рддреНрд░ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:

![](<../../../.gitbook/assets/image (520).png>)

**ArsenalImageMounter** рдХреЗ рд╕рд╛рде рдлреЛрд░реЗрдВрд╕рд┐рдХ рдЗрдореЗрдЬ рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░рдиреЗ рдкрд░, [**ShadowCopyView**](https://www.nirsoft.net/utils/shadow\_copy\_view.html) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╢реИрдбреЛ рдХреЙрдкреА рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рд╢реИрдбреЛ рдХреЙрдкреА рдмреИрдХрдЕрдкреНрд╕ рд╕реЗ **рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓рд╛** рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![](<../../../.gitbook/assets/image (521).png>)

рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\BackupRestore` рдореЗрдВ **рдмреИрдХрдЕрдк рдирд╣реАрдВ рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдлрд╛рдЗрд▓реЗрдВ рдФрд░ рдХреБрдВрдЬрд┐рдпрд╛рдБ рд╣реЛрддреА рд╣реИрдВ:

![](<../../../.gitbook/assets/image (522).png>)

рд░рдЬрд┐рд╕реНрдЯреНрд░реА `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VSS` рдореЗрдВ рднреА `Volume Shadow Copies` рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред

### рдСрдлрд┐рд╕ рдСрдЯреЛрд╕реЗрд╡реНрдб рдлрд╛рдЗрд▓реНрд╕

рдЖрдк рдСрдлрд┐рд╕ рдСрдЯреЛрд╕реЗрд╡реНрдб рдлрд╛рдЗрд▓реНрд╕ рдХреЛ рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: `C:\Usuarios\\AppData\Roaming\Microsoft{Excel|Word|Powerpoint}\`

## рд╢реЗрд▓ рдЖрдЗрдЯрдореНрд╕

рдПрдХ рд╢реЗрд▓ рдЖрдЗрдЯрдо рдПрдХ рдРрд╕реА рд╡рд╕реНрддреБ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рджреВрд╕рд░реА рдлрд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред

### рд╣рд╛рд▓ рдХреЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ (LNK)

рд╡рд┐рдВрдбреЛрдЬ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ** рдпреЗ **рд╢реЙрд░реНрдЯрдХрдЯреНрд╕** рдмрдирд╛рддрд╛ рд╣реИ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдЦреЛрд▓рддрд╛ рд╣реИ, рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдлрд╛рдЗрд▓ рдмрдирд╛рддрд╛ рд╣реИ**:

* Win7-Win10: `C:\Users\\AppData\Roaming\Microsoft\Windows\Recent\`
* Office: `C:\Users\\AppData\Roaming\Microsoft\Office\Recent\`

рдЬрдм рдПрдХ рдлреЛрд▓реНрдбрд░ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕ рдлреЛрд▓реНрдбрд░, рдкреИрд░реЗрдВрдЯ рдлреЛрд▓реНрдбрд░, рдФрд░ рдЧреНрд░реИрдВрдбрдкреИрд░реЗрдВрдЯ рдлреЛрд▓реНрдбрд░ рдХрд╛ рднреА рд▓рд┐рдВрдХ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдИ рдЧрдИ рд▓рд┐рдВрдХ рдлрд╛рдЗрд▓реЗрдВ **рдореВрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреА рд╣реИрдВ** рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ рдПрдХ **рдлрд╛рдЗрд▓** рд╣реИ **рдпрд╛** рдПрдХ **рдлреЛрд▓реНрдбрд░**, **MAC** **рд╕рдордп** рдЙрд╕ рдлрд╛рдЗрд▓ рдХрд╛, **рд╡реЙрд▓реНрдпреВрдо рдЬрд╛рдирдХрд╛рд░реА** рдЬрд╣рд╛рдБ рдлрд╛рдЗрд▓ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ рдФрд░ **рд▓рдХреНрд╖реНрдп рдлрд╛рдЗрд▓ рдХрд╛ рдлреЛрд▓реНрдбрд░**ред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдЙрди рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИ рдпрджрд┐ рд╡реЗ рд╣рдЯрд╛ рджреА рдЧрдИ рд╣реЛрдВред

рд╕рд╛рде рд╣реА, рд▓рд┐рдВрдХ рдлрд╛рдЗрд▓ рдХреА **рдмрдирд╛рдИ рдЧрдИ рддрд╛рд░реАрдЦ** рдореВрд▓ рдлрд╛рдЗрд▓ рдХреА **рдкрд╣рд▓реА рдмрд╛рд░** **рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЧрдИ** рддрд╛рд░реАрдЦ рд╣реИ рдФрд░ рд▓рд┐рдВрдХ рдлрд╛рдЗрд▓ рдХреА **рд╕рдВрд╢реЛрдзрд┐рдд рддрд╛рд░реАрдЦ** рдореВрд▓ рдлрд╛рдЗрд▓ рдХреА рдЖрдЦрд┐рд░реА рдмрд╛рд░ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЧрдИ рддрд╛рд░реАрдЦ рд╣реИред

рдЗрди рдлрд╛рдЗрд▓реЛрдВ рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк [**LinkParser**](http://4discovery.com/our-tools/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рдЯреВрд▓ рдореЗрдВ рдЖрдкрдХреЛ **2 рд╕реЗрдЯ** рд╕рдордпрд╕реАрдорд╛рдПрдБ рдорд┐рд▓реЗрдВрдЧреА:

* **рдкрд╣рд▓рд╛ рд╕реЗрдЯ:**
1. FileModifiedDate
2. FileAccessDate
3. FileCreationDate
* **рджреВрд╕рд░рд╛ рд╕реЗрдЯ:**
1. LinkModifiedDate
2. LinkAccessDate
3. LinkCreationDate.

рдкрд╣рд▓рд╛ рд╕реЗрдЯ рд╕рдордпрд╕реАрдорд╛ **рдлрд╛рдЗрд▓ рд╕реНрд╡рдпрдВ рдХреЗ рд╕рдордпрд╕реАрдорд╛рдУрдВ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддрд╛ рд╣реИ**ред рджреВрд╕рд░рд╛ рд╕реЗрдЯ **рд▓рд┐рдВрдХ рдХреА рдЧрдИ рдлрд╛рдЗрд▓ рдХреЗ рд╕рдордпрд╕реАрдорд╛рдУрдВ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддрд╛ рд╣реИ**ред

рдЖрдк рд╡рд┐рдВрдбреЛрдЬ CLI рдЯреВрд▓ [**LECmd.exe**](https://github.com/EricZimmerman/LECmd) рдЪрд▓рд╛рдХрд░ рднреА рд╕рдорд╛рди рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
LECmd.exe -d C:\Users\student\Desktop\LNKs --csv C:\Users\student\Desktop\LNKs
```
### Jumplists

рдпреЗ рд╡реЗ рд╣рд╛рд▓ рдХреА рдлрд╛рдЗрд▓реЗрдВ рд╣реИрдВ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрддрд┐рдд рд╣реЛрддреА рд╣реИрдВред рдпрд╣ **рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдпреБрдХреНрдд рдлрд╛рдЗрд▓реЛрдВ рдХреА рд╕реВрдЪреА** рд╣реИ рдЬрд┐рд╕реЗ рдЖрдк рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпреЗ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ рдпрд╛ рдХрд╕реНрдЯрдо рд╣реЛ рд╕рдХрддреА рд╣реИрдВ**ред

рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдИ рдЧрдИ **jumplists** `C:\Users\{username}\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations\` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИрдВред Jumplists рдХрд╛ рдирд╛рдо `{id}.autmaticDestinations-ms` рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рддреЗ рд╣реБрдП рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдкреНрд░рд╛рд░рдВрднрд┐рдХ ID рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА ID рд╣реЛрддреА рд╣реИред

рдХрд╕реНрдЯрдо jumplists `C:\Users\{username}\AppData\Roaming\Microsoft\Windows\Recent\CustomDestination\` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИрдВ рдФрд░ рдпреЗ рдЖрдорддреМрд░ рдкрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдлрд╛рдЗрд▓ рдХреЗ рд╕рд╛рде рдХреБрдЫ **рдорд╣рддреНрд╡рдкреВрд░реНрдг** рд╣реБрдЖ рд╣реЛрддрд╛ рд╣реИ (рд╢рд╛рдпрдж рдкрд╕рдВрджреАрджрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд)

рдХрд┐рд╕реА рднреА jumplist рдХрд╛ **рдирд┐рд░реНрдорд┐рдд рд╕рдордп** рдЙрд╕ рд╕рдордп рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдЬрдм **рдкрд╣рд▓реА рдмрд╛рд░ рдлрд╛рдЗрд▓ рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛** рдФрд░ **рд╕рдВрд╢реЛрдзрд┐рдд рд╕рдордп рдЕрдВрддрд┐рдо рдмрд╛рд░**ред

рдЖрдк [**JumplistExplorer**](https://ericzimmerman.github.io/#!index.md) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ jumplists рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

(_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ JumplistExplorer рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╕рдордпрд╛рдВрдХ jumplist рдлрд╛рдЗрд▓ рд╕реНрд╡рдпрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВ_)

### Shellbags

[**рдЗрд╕ рд▓рд┐рдВрдХ рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ рдФрд░ рдЬрд╛рдиреЗрдВ рдХрд┐ shellbags рдХреНрдпрд╛ рд╣реИрдВред**](interesting-windows-registry-keys.md#shellbags)

## Windows USBs рдХрд╛ рдЙрдкрдпреЛрдЧ

рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ USB рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рдкрд╣рдЪрд╛рди рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рдХрд╛рд░рдг рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ:

* Windows Recent Folder
* Microsoft Office Recent Folder
* Jumplists

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреБрдЫ LNK рдлрд╛рдЗрд▓ рдХреЗ рдмрдЬрд╛рдп рдореВрд▓ рдкрде рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, WPDNSE рдлреЛрд▓реНрдбрд░ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддреА рд╣реИ:

рдлреЛрд▓реНрдбрд░ WPDNSE рдореЗрдВ рдлрд╛рдЗрд▓реЗрдВ рдореВрд▓ рд╡рд╛рд▓реЛрдВ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рд╣реЛрддреА рд╣реИрдВ, рдлрд┐рд░ рднреА рд╡реЗ рдкреАрд╕реА рдХреЗ рдкреБрдирдГ рдЖрд░рдВрдн рд╣реЛрдиреЗ рдкрд░ рдирд╣реАрдВ рдмрдЪреЗрдВрдЧреА рдФрд░ GUID рдПрдХ shellbag рд╕реЗ рд▓рд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### Registry Information

[рдЗрд╕ рдкреГрд╖реНрда рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ](interesting-windows-registry-keys.md#usb-information) рдФрд░ рдЬрд╛рдиреЗрдВ рдХрд┐ рдХреМрди рд╕реА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬрд┐рдпрд╛рдБ USB рд╕реЗ рдЬреБрдбрд╝реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреА рд╣реИрдВред

### setupapi

рдлрд╛рдЗрд▓ `C:\Windows\inf\setupapi.dev.log` рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ USB рдХрдиреЗрдХреНрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдордпрд╛рдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ (рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП `Section start` рджреЗрдЦреЗрдВ)ред

### USB Detective

[**USBDetective**](https://usbdetective.com) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрди USB рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ рдЬреЛ рдПрдХ рдЗрдореЗрдЬ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реБрдП рд╣реИрдВред

### Plug and Play Cleanup

'Plug and Play Cleanup' рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдп рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреЗ рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ **рд╕рд╛рдл** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред рдпрд╣ рдкреНрд░рддреАрдд рд╣реЛрддрд╛ рд╣реИ (рдСрдирд▓рд╛рдЗрди рд░рд┐рдкреЛрд░реНрдЯреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░) рдХрд┐ рдпрд╣ **30 рджрд┐рдиреЛрдВ рд╕реЗ рдЙрдкрдпреЛрдЧ рдореЗрдВ рдирд╣реАрдВ рдЖрдП рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреЛ рднреА рдЙрдард╛рддрд╛ рд╣реИ**, рдЗрд╕рдХреЗ рд╡рд┐рд╡рд░рдг рдХреЗ рдмрд╛рд╡рдЬреВрдж рдЬреЛ рдХрд╣рддрд╛ рд╣реИ рдХрд┐ "рдкреНрд░рддреНрдпреЗрдХ рдбреНрд░рд╛рдЗрд╡рд░ рдкреИрдХреЗрдЬ рдХрд╛ рд╕рдмрд╕реЗ рд╡рд░реНрддрдорд╛рди рд╕рдВрд╕реНрдХрд░рдг рд░рдЦрд╛ рдЬрд╛рдПрдЧрд╛"ред рдЗрд╕ рдкреНрд░рдХрд╛рд░, **30 рджрд┐рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЬреБрдбрд╝реЗ рдирд╣реАрдВ рдЧрдП рд╣рдЯрд╛рдиреЗ рдпреЛрдЧреНрдп рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдбреНрд░рд╛рдЗрд╡рд░ рд╣рдЯрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред

рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдп рд╕реНрд╡рдпрдВ 'C:\Windows\System32\Tasks\Microsoft\Windows\Plug and Play\Plug and Play Cleanup' рдкрд░ рд╕реНрдерд┐рдд рд╣реИ, рдФрд░ рдЗрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдиреАрдЪреЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХреА рдЧрдИ рд╣реИ:

рдХрд╛рд░реНрдп 'pnpclean.dll' рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддрд╛ рд╣реИ рдЬреЛ рд╕рдлрд╛рдИ рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИ рдФрд░ рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ 'UseUnifiedSchedulingEngine' рдлрд╝реАрд▓реНрдб 'TRUE' рдкрд░ рд╕реЗрдЯ рд╣реИ рдЬреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рд╛рдорд╛рдиреНрдп рдХрд╛рд░реНрдп рдЕрдиреБрд╕реВрдЪрди рдЗрдВрдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд╛рд░реНрдп рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред 'MaintenanceSettings' рдХреЗ рднреАрддрд░ 'P1M' рдФрд░ 'P2M' рдХреЗ 'Period' рдФрд░ 'Deadline' рдорд╛рди рдЯрд╛рд╕реНрдХ рд╕реНрдХреЗрдбреНрдпреВрд▓рд░ рдХреЛ рдирд┐рд░реНрджреЗрд╢ рджреЗрддреЗ рд╣реИрдВ рдХрд┐ рд╡рд╣ рдХрд╛рд░реНрдп рдХреЛ рд╣рд░ рдорд╣реАрдиреЗ рдирд┐рдпрдорд┐рдд рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░рдЦрд░рдЦрд╛рд╡ рдХреЗ рджреМрд░рд╛рди рдПрдХ рдмрд╛рд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗ рдФрд░ рдпрджрд┐ рдпрд╣ 2 рд▓рдЧрд╛рддрд╛рд░ рдорд╣реАрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рдлрд▓ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЖрдкрд╛рддрдХрд╛рд▓реАрди рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░рдЦрд░рдЦрд╛рд╡ рдХреЗ рджреМрд░рд╛рди рдХрд╛рд░реНрдп рдХрд╛ рдкреНрд░рдпрд╛рд╕ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред **рдпрд╣ рдЕрдиреБрднрд╛рдЧ** [**рдпрд╣рд╛рдБ рд╕реЗ**](https://blog.1234n6.com/2018/07/windows-plug-and-play-cleanup.html)** рдХреЙрдкреА рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред**

## Emails

рдИрдореЗрд▓ рдореЗрдВ **2 рджрд┐рд▓рдЪрд╕реНрдк рднрд╛рдЧ рд╣реЛрддреЗ рд╣реИрдВ: рд╣реЗрдбрд░реНрд╕ рдФрд░ рдИрдореЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА**ред **рд╣реЗрдбрд░реНрд╕** рдореЗрдВ рдЖрдк рдЬреИрд╕реА рдЬрд╛рдирдХрд╛рд░реА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

* **рдХрд┐рд╕рдиреЗ** рдИрдореЗрд▓ рднреЗрдЬреЗ (рдИрдореЗрд▓ рдкрддрд╛, IP, рдореЗрд▓ рд╕рд░реНрд╡рд░ рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ рдИрдореЗрд▓ рдХреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд┐рдпрд╛)
* **рдХрдм** рдИрдореЗрд▓ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛

рд╕рд╛рде рд╣реА, `References` рдФрд░ `In-Reply-To` рд╣реЗрдбрд░реНрд╕ рдХреЗ рдЕрдВрджрд░ рдЖрдк рд╕рдВрджреЗрд╢реЛрдВ рдХреА ID рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

### Windows Mail App

рдпрд╣ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдИрдореЗрд▓ рдХреЛ HTML рдпрд╛ рдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ рд╕реЗрд╡ рдХрд░рддрд╛ рд╣реИред рдЖрдк `\Users\<username>\AppData\Local\Comms\Unistore\data\3\` рдХреЗ рдЕрдВрджрд░ рд╕рдмрдлреЛрд▓реНрдбрд░реНрд╕ рдореЗрдВ рдИрдореЗрд▓ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдИрдореЗрд▓ `.dat` рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рд╕реЗрд╡ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

рдИрдореЗрд▓ рдХрд╛ **рдореЗрдЯрд╛рдбреЗрдЯрд╛** рдФрд░ **рд╕рдВрдкрд░реНрдХ** **EDB рдбреЗрдЯрд╛рдмреЗрд╕** рдХреЗ рдЕрдВрджрд░ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ: `\Users\<username>\AppData\Local\Comms\UnistoreDB\store.vol`

**рдлрд╛рдЗрд▓ рдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдмрджрд▓реЗрдВ** `.vol` рд╕реЗ `.edb` рдореЗрдВ рдФрд░ рдЖрдк [ESEDatabaseView](https://www.nirsoft.net/utils/ese\_database\_view.html) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВред `Message` рдЯреЗрдмрд▓ рдХреЗ рдЕрдВрджрд░ рдЖрдк рдИрдореЗрд▓ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

### Microsoft Outlook

рдЬрдм Exchange рд╕рд░реНрд╡рд░ рдпрд╛ Outlook рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдХреБрдЫ MAPI рд╣реЗрдбрд░реНрд╕ рд╣реЛрдВрдЧреЗ:

* `Mapi-Client-Submit-Time`: рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рд╕рдордп рдЬрдм рдИрдореЗрд▓ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛
* `Mapi-Conversation-Index`: рдереНрд░реЗрдб рдХреЗ рдмрдЪреНрдЪреЛрдВ рдХреЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдФрд░ рдереНрд░реЗрдб рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрджреЗрд╢ рдХрд╛ рд╕рдордпрд╛рдВрдХ
* `Mapi-Entry-ID`: рд╕рдВрджреЗрд╢ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ред
* `Mappi-Message-Flags` рдФрд░ `Pr_last_Verb-Executed`: MAPI рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА (рд╕рдВрджреЗрд╢ рдкрдврд╝рд╛ рдЧрдпрд╛? рдирд╣реАрдВ рдкрдврд╝рд╛ рдЧрдпрд╛? рдЬрд╡рд╛рдм рджрд┐рдпрд╛ рдЧрдпрд╛? рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛? рдСрдлрд┐рд╕ рд╕реЗ рдмрд╛рд╣рд░?)

Microsoft Outlook рдХреНрд▓рд╛рдЗрдВрдЯ рдореЗрдВ, рд╕рднреА рднреЗрдЬреЗ/рдкреНрд░рд╛рдкреНрдд рд╕рдВрджреЗрд╢, рд╕рдВрдкрд░реНрдХ рдбреЗрдЯрд╛, рдФрд░ рдХреИрд▓реЗрдВрдбрд░ рдбреЗрдЯрд╛ PST рдлрд╛рдЗрд▓ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВ:

* `%USERPROFILE%\Local Settings\Application Data\Microsoft\Outlook` (WinXP)
* `%USERPROFILE%\AppData\Local\Microsoft\Outlook`

рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкрде `HKEY_CURRENT_USER\Software\Microsoft\WindowsNT\CurrentVersion\Windows Messaging Subsystem\Profiles\Outlook` рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реА рдлрд╛рдЗрд▓ рдЙрдкрдпреЛрдЧ рдореЗрдВ рд╣реИред

рдЖрдк [**Kernel PST Viewer**](https://www.nucleustechnologies.com/es/visor-de-pst.html) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PST рдлрд╛рдЗрд▓ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВред

### Outlook OST

рдЬрдм Microsoft Outlook рдХреЛ **IMAP** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╛ Exchange рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ **OST** рдлрд╛рдЗрд▓ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд▓рдЧрднрдЧ рд╡рд╣реА рдЬрд╛рдирдХрд╛рд░реА PST рдлрд╛рдЗрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдлрд╛рдЗрд▓ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде **рдкрд┐рдЫрд▓реЗ 12 рдорд╣реАрдиреЛрдВ** рдХреЗ рд▓рд┐рдП рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝
```bash
.\PECmd.exe -d C:\Users\student\Desktop\Prefetch --html "C:\Users\student\Desktop\out_folder"
```
### Superprefetch

**Superprefetch** рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рднреА prefetch рдХреА рддрд░рд╣ рд╣реИ, **рдкреНрд░реЛрдЧреНрд░рд╛рдореНрд╕ рдХреЛ рддреЗрдЬреА рд╕реЗ рд▓реЛрдб рдХрд░рдирд╛** рдпрд╣ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдХрд░ рдХрд┐ рдЖрдЧреЗ рдХреНрдпрд╛ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ prefetch рд╕реЗрд╡рд╛ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИред\
рдпрд╣ рд╕реЗрд╡рд╛ `C:\Windows\Prefetch\Ag*.db` рдореЗрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рдлрд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧреАред

рдЗрди рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЖрдк **рдкреНрд░реЛрдЧреНрд░рд╛рдо** рдХрд╛ **рдирд╛рдо**, **рд╕рдВрдЦреНрдпрд╛** **рдСрдл** **рдПрдХреНрдЬреАрдХреНрдпреВрд╢рдВрд╕**, **рдЦреЛрд▓реА рдЧрдИ** **рдлрд╛рдЗрд▓реЗрдВ**, **рд╡реЙрд▓реНрдпреВрдо** **рдПрдХреНрд╕реЗрд╕**, **рдкреВрд░рд╛** **рдкрде**, **рд╕рдордп рд╕реАрдорд╛рдПрдВ** рдФрд░ **рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ [**CrowdResponse**](https://www.crowdstrike.com/resources/community-tools/crowdresponse/) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### SRUM

**System Resource Usage Monitor** (SRUM) **рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдкрднреЛрдЧ рдХрд┐рдП рдЧрдП рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдирд┐рдЧрд░рд╛рдиреА** рдХрд░рддрд╛ рд╣реИред рдпрд╣ W8 рдореЗрдВ рдЖрдпрд╛ рдерд╛ рдФрд░ рдпрд╣ рдбреЗрдЯрд╛ рдХреЛ ESE рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИ рдЬреЛ `C:\Windows\System32\sru\SRUDB.dat` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред

рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛ рд╣реИ:

* AppID рдФрд░ Path
* рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЬрд┐рд╕рдиреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛
* Sent Bytes
* Received Bytes
* Network Interface
* Connection duration
* Process duration

рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд╣рд░ 60 рдорд┐рдирдЯ рдореЗрдВ рдЕрдкрдбреЗрдЯ рд╣реЛрддреА рд╣реИред

рдЖрдк рдЗрд╕ рдлрд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ [**srum\_dump**](https://github.com/MarkBaggett/srum-dump) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
.\srum_dump.exe -i C:\Users\student\Desktop\SRUDB.dat -t SRUM_TEMPLATE.xlsx -o C:\Users\student\Desktop\srum
```
### AppCompatCache (ShimCache)

**Shimcache**, рдЬрд┐рд╕реЗ **AppCompatCache** рдХреЗ рдирд╛рдо рд╕реЗ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, **Application Compatibility Database** рдХрд╛ рдПрдХ рдШрдЯрдХ рд╣реИ, рдЬрд┐рд╕реЗ **Microsoft** рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рджреНрд╡рд╛рд░рд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕рдВрдЧрддрддрд╛ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдХреИрд╢ рд╡рд┐рднрд┐рдиреНрди рдлрд╛рдЗрд▓ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐:

* рдлрд╛рдЗрд▓ рдкреВрд░рд╛ рдкрде
* рдлрд╛рдЗрд▓ рдЖрдХрд╛рд░
* **$Standard\_Information** (SI) рдЕрдВрддрд┐рдо рд╕рдВрд╢реЛрдзрд┐рдд рд╕рдордп
* ShimCache рдЕрдВрддрд┐рдо рдЕрдкрдбреЗрдЯреЗрдб рд╕рдордп
* рдкреНрд░реЛрд╕реЗрд╕ рдирд┐рд╖реНрдкрд╛рджрди рдзреНрд╡рдЬ

рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдорд┐рд▓ рд╕рдХрддреА рд╣реИ:

* `SYSTEM\CurrentControlSet\Control\SessionManager\Appcompatibility\AppcompatCache`
* XP (96 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ)
* `SYSTEM\CurrentControlSet\Control\SessionManager\AppcompatCache\AppCompatCache`
* Server 2003 (512 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ)
* 2008/2012/2016 Win7/Win8/Win10 (1024 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ)

рдЖрдк рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**AppCompatCacheParser**](https://github.com/EricZimmerman/AppCompatCacheParser) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

![](<../../../.gitbook/assets/image (488).png>)

### Amcache

**Amcache.hve** рдлрд╛рдЗрд▓ рдПрдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдлрд╛рдЗрд▓ рд╣реИ рдЬреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рддреА рд╣реИред рдпрд╣ `C:\Windows\AppCompat\Programas\Amcache.hve` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред

**Amcache.hve** рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдЪрд▓рд╛рдП рдЧрдП рдкреНрд░реЛрд╕реЗрд╕ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрди рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рдкрде рдХреА рд╕реВрдЪреА рдмрдирд╛рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЧрдП рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд╛ SHA1 рднреА рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИред

рдЖрдк рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**Amcacheparser**](https://github.com/EricZimmerman/AmcacheParser) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
AmcacheParser.exe -f C:\Users\student\Desktop\Amcache.hve --csv C:\Users\student\Desktop\srum
```
```markdown
рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк CVS рдлрд╝рд╛рдЗрд▓ рдЬреЛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рд╡рд╣ рд╣реИ `Amcache_Unassociated file entries`.

### RecentFileCache

рдпрд╣ рдЖрд░реНрдЯрд┐рдлреИрдХреНрдЯ рдХреЗрд╡рд▓ W7 рдореЗрдВ `C:\Windows\AppCompat\Programs\RecentFileCache.bcf` рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рдХреБрдЫ рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХреЗ рд╣рд╛рд▓ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред

рдЖрдк [**RecentFileCacheParse**](https://github.com/EricZimmerman/RecentFileCacheParser) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### Scheduled tasks

рдЖрдк рдЗрдиреНрд╣реЗрдВ `C:\Windows\Tasks` рдпрд╛ `C:\Windows\System32\Tasks` рд╕реЗ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ XML рдХреЗ рд░реВрдк рдореЗрдВ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред

### Services

рдЖрдк рдЗрдиреНрд╣реЗрдВ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рдЕрдВрддрд░реНрдЧрдд `SYSTEM\ControlSet001\Services` рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ рдФрд░ рдХрдмред

### **Windows Store**

рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди `\ProgramData\Microsoft\Windows\AppRepository\` рдореЗрдВ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред\
рдЗрд╕ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рдПрдХ **рд▓реЙрдЧ** рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЕрдВрджрд░ рд╕реНрдерд╛рдкрд┐рдд **рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдХреА рдЬрд╛рдирдХрд╛рд░реА рдбреЗрдЯрд╛рдмреЗрд╕ **`StateRepository-Machine.srd`** рдореЗрдВ рд╣реЛрддреА рд╣реИред

рдЗрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЯреЗрдмрд▓ рдореЗрдВ, "Application ID", "PackageNumber", рдФрд░ "Display Name" рдХреЙрд▓рдо рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВред рдЗрди рдХреЙрд▓рдореЛрдВ рдореЗрдВ рдкреНрд░реА-рдЗрдВрд╕реНрдЯреЙрд▓реНрдб рдФрд░ рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИ рдФрд░ рдпрд╣ рднреА рдкрддрд╛ рдЪрд▓ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдирдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП рдереЗ рдХреНрдпреЛрдВрдХрд┐ рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рдЖрдИрдбреА рдЕрдиреБрдХреНрд░рдорд┐рдХ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред

рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди **рдЦреЛрдЬрдирд╛** рднреА рд╕рдВрднрд╡ рд╣реИ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкрде рдореЗрдВ: `Software\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\Applications\`\
рдФрд░ **рдЕрдирдЗрдВрд╕реНрдЯреЙрд▓реНрдб** **рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдпрд╣рд╛рдБ рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВ: `Software\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\Deleted\`

## Windows Events

Windows рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЗ рдЕрдВрджрд░ рдЬреЛ рдЬрд╛рдирдХрд╛рд░реА рдЖрддреА рд╣реИ рд╡рд╣ рд╣реИрдВ:

* рдХреНрдпрд╛ рд╣реБрдЖ
* Timestamp (UTC + 0)
* рд╢рд╛рдорд┐рд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛
* рд╢рд╛рдорд┐рд▓ рд╣реЛрд╕реНрдЯреНрд╕ (hostname, IP)
* рдкрд╣реБрдБрдЪреЗ рдЧрдП рдПрд╕реЗрдЯреНрд╕ (рдлрд╝рд╛рдЗрд▓реЗрдВ, рдлрд╝реЛрд▓реНрдбрд░, рдкреНрд░рд┐рдВрдЯрд░, рд╕реЗрд╡рд╛рдПрдБ)

рд▓реЙрдЧреНрд╕ рдХрд╛ рд╕реНрдерд╛рди `C:\Windows\System32\config` рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ Windows Vista рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ `C:\Windows\System32\winevt\Logs` рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ Windows Vista рдХреЗ рдмрд╛рджред Windows Vista рд╕реЗ рдкрд╣рд▓реЗ, рдЗрд╡реЗрдВрдЯ рд▓реЙрдЧреНрд╕ рдмрд╛рдЗрдирд░реА рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ рдереЗ рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж, рд╡реЗ **XML рдлреЙрд░реНрдореЗрдЯ** рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ **.evtx** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред

рдЗрд╡реЗрдВрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рд╕реНрдерд╛рди SYSTEM рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ **`HKLM\SYSTEM\CurrentControlSet\services\EventLog\{Application|System|Security}`**

рдЙрдиреНрд╣реЗрдВ Windows Event Viewer (**`eventvwr.msc`**) рд╕реЗ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдЕрдиреНрдп рдЯреВрд▓реНрд╕ рдЬреИрд╕реЗ [**Event Log Explorer**](https://eventlogxp.com) **рдпрд╛** [**Evtx Explorer/EvtxECmd**](https://ericzimmerman.github.io/#!index.md)** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред**

### Security

рдпрд╣ рдПрдХреНрд╕реЗрд╕ рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЛ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛ рд╣реИ рдЬреЛ `C:\Windows\System32\winevt\Security.evtx` рдореЗрдВ рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИред

рдЗрд╡реЗрдВрдЯ рдлрд╝рд╛рдЗрд▓ рдХрд╛ **рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЬрдм рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ рдкрд╣реБрдБрдЪ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдпрд╣ рдкреБрд░рд╛рдиреА рдШрдЯрдирд╛рдУрдВ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрдЧрд╛ред

рд░рдЬрд┐рд╕реНрдЯрд░ рдХреА рдЧрдИ рдШрдЯрдирд╛рдПрдБ рд╣реИрдВ:

* рд▓реЙрдЧрд┐рди/рд▓реЙрдЧрдСрдл
* рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдХреНрд░рд┐рдпрд╛рдПрдБ
* рдлрд╝рд╛рдЗрд▓реЛрдВ, рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдФрд░ рд╕рд╛рдЭрд╛ рдПрд╕реЗрдЯреНрд╕ рддрдХ рдкрд╣реБрдБрдЪ
* рд╕реБрд░рдХреНрд╖рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рд╕рдВрд╢реЛрдзрди

рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдШрдЯрдирд╛рдПрдБ:

| EventID   | рд╡рд┐рд╡рд░рдг                        |
| --------- | ---------------------------- |
| 4624      | рд╕рдлрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг              |
| 4625      | рдкреНрд░рдорд╛рдгреАрдХрд░рдг рддреНрд░реБрдЯрд┐           |
| 4634/4647 | рд▓реЙрдЧ рдСрдл                      |
| 4672      | рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди |

EventID 4634/4647 рдХреЗ рдЕрдВрджрд░ рджрд┐рд▓рдЪрд╕реНрдк рдЙрдк-рдкреНрд░рдХрд╛рд░ рд╣реИрдВ:

* **2 (рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡)**: рд▓реЙрдЧрд┐рди рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдерд╛ рдЬрд┐рд╕рдореЗрдВ рдХреАрдмреЛрд░реНрдб рдпрд╛ VNC рдпрд╛ `PSexec -U-` рдЬреИрд╕реЗ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реБрдЖ
* **3 (рдиреЗрдЯрд╡рд░реНрдХ)**: рд╕рд╛рдЭрд╛ рдлрд╝реЛрд▓реНрдбрд░ рд╕реЗ рдХрдиреЗрдХреНрд╢рди
* **4 (рдмреИрдЪ)**: рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реБрдИ
* **5 (рд╕реЗрд╡рд╛)**: рд╕реЗрд╡рд╛ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рдмрдВрдзрдХ рджреНрд╡рд╛рд░рд╛ рд╕реЗрд╡рд╛ рд╢реБрд░реВ рдХреА рдЧрдИ
* **6 (рдкреНрд░реЙрдХреНрд╕реА):** рдкреНрд░реЙрдХреНрд╕реА рд▓реЙрдЧрд┐рди
* **7 (рдЕрдирд▓реЙрдХ)**: рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрдХреНрд░реАрди рдЕрдирдмреНрд▓реЙрдХ рдХреА рдЧрдИ
* **8 (рдиреЗрдЯрд╡рд░реНрдХ рдХреНрд▓рд┐рдпрд░рдЯреЗрдХреНрд╕реНрдЯ)**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдиреЗ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдкрд╛рд╕рд╡рд░реНрдб рднреЗрдЬрдХрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд┐рдпрд╛ред рдпрд╣ рдШрдЯрдирд╛ IIS рд╕реЗ рдЖрддреА рдереА
* **9 (рдирдИ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕)**: рдпрд╣ рддрдм рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм `RunAs` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрд▓рдЧ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рд╕рд╛рде рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛ рддрдХ рдкрд╣реБрдБрдЪрддрд╛ рд╣реИред
* **10 (рд░рд┐рдореЛрдЯ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡)**: рдЯрд░реНрдорд┐рдирд▓ рд╕реЗрд╡рд╛рдУрдВ рдпрд╛ RDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг
* **11 (рдХреИрд╢ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡)**: рдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓рд░ рд╕реЗ рд╕рдВрдкрд░реНрдХ рдирд╣реАрдВ рд╣реЛ рдкрд╛рдиреЗ рдХреЗ рдХрд╛рд░рдг рдЕрдВрддрд┐рдо рдХреИрд╢ рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╣реБрдБрдЪ
* **12 (рдХреИрд╢ рд░рд┐рдореЛрдЯ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡)**: рдХреИрд╢ рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рд╕рд╛рде рджреВрд░рд╕реНрде рд░реВрдк рд╕реЗ рд▓реЙрдЧрд┐рди (10 рдФрд░ 11 рдХрд╛ рд╕рдВрдпреЛрдЬрди)ред
* **13 (рдХреИрд╢реНрдб рдЕрдирд▓реЙрдХ)**: рдХреИрд╢ рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рд╕рд╛рде рд▓реЙрдХ рдХрд┐рдП рдЧрдП рдорд╢реАрди рдХреЛ рдЕрдирд▓реЙрдХ рдХрд░рдирд╛ред

рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ, рдЖрдк рдЗрди рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓реЙрдЧрд┐рди рдХреА рдирдХрд▓ рдХреИрд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдореЗрдВ рд╕реЗ рдХрд┐рдирдореЗрдВ рдЖрдк рдореЗрдореЛрд░реА рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ: [https://www.alteredsecurity.com/post/fantastic-windows-logon-types-and-where-to-find-credentials-in-them](https://www.alteredsecurity.com/post/fantastic-windows-logon-types-and-where-to-find-credentials-in-them)

рдШрдЯрдирд╛рдУрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдФрд░ рдЙрдк-рд╕реНрдерд┐рддрд┐ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдШрдЯрдирд╛ рдХреЗ рдХрд╛рд░рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдмрддрд╛ рд╕рдХрддреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, Event ID 4625 рдХреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдерд┐рддрд┐ рдФрд░ рдЙрдк-рд╕реНрдерд┐рддрд┐ рдХреЛрдбреНрд╕ рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ:

![](<../../../.gitbook/assets/image (455).png>)

### Windows Events рдХреА рд░рд┐рдХрд╡рд░реА

рд╕рдВрджрд┐рдЧреНрдз PC рдХреЛ **рдЕрдирдкреНрд▓рдЧ рдХрд░рдХреЗ** рдмрдВрдж рдХрд░рдирд╛ рдЕрддреНрдпрдзрд┐рдХ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ рддрд╛рдХрд┐ Windows Events рдХреА рд░рд┐рдХрд╡рд░реА рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рдЕрдзрд┐рдХрддрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдпрджрд┐ рд╡реЗ рд╣рдЯрд╛ рджрд┐рдП рдЧрдП рдереЗ, рддреЛ рдЙрдиреНрд╣реЗрдВ рд░рд┐рдХрд╡рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдПрдХ рдЯреВрд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ [**Bulk_extractor**](../partitions-file-systems-carving/file-data-carving-recovery-tools.md#bulk-extractor) рдЬрд┐рд╕рдореЗрдВ **evtx** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

## Windows Events рдХреЗ рд╕рд╛рде рд╕рд╛рдорд╛рдиреНрдп рд╣рдорд▓реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛

* [https://redteamrecipe.com/event-codes/](https://redteamrecipe.com/event-codes/)

### Brute Force Attack

рдПрдХ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рд╣рдорд▓реЗ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рдХрдИ EventIDs 4625 рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреЗ**ред рдпрджрд┐ рд╣рдорд▓рд╛ **рд╕рдлрд▓** рдерд╛, рддреЛ EventIDs 4625 рдХреЗ рдмрд╛рдж, **рдПрдХ EventID 4624 рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛**ред

### Time Change

рдпрд╣ рдлреЛрд░реЗрдВрд╕рд┐рдХ рдЯреАрдо рдХреЗ рд▓рд┐рдП рднрдпрд╛рдирдХ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╕рднреА рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕ рд╕рдВрд╢реЛрдзрд┐рдд рд╣реЛ рдЬрд╛рдПрдВрдЧреЗред рдпрд╣ рдШрдЯрдирд╛ Security Event рд▓реЙ
