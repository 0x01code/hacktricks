# Windows рдЖрд░реНрдЯрд┐рдлреИрдХреНрдЯреНрд╕

## Windows рдЖрд░реНрдЯрд┐рдлреИрдХреНрдЯреНрд╕

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВред

</details>

## рд╕рд╛рдорд╛рдиреНрдп Windows рдЖрд░реНрдЯрд┐рдлреИрдХреНрдЯреНрд╕

### Windows 10 рд╕реВрдЪрдирд╛рдПрдБ

рдкрде `\Users\<username>\AppData\Local\Microsoft\Windows\Notifications` рдореЗрдВ рдЖрдкрдХреЛ рдбреЗрдЯрд╛рдмреЗрд╕ `appdb.dat` (Windows anniversary рд╕реЗ рдкрд╣рд▓реЗ) рдпрд╛ `wpndatabase.db` (Windows Anniversary рдХреЗ рдмрд╛рдж) рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ SQLite рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЕрдВрджрд░, рдЖрдк `Notification` рддрд╛рд▓рд┐рдХрд╛ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рд╕рднреА рд╕реВрдЪрдирд╛рдПрдБ (XML рдкреНрд░рд╛рд░реВрдк рдореЗрдВ) рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬреЛ рджрд┐рд▓рдЪрд╕реНрдк рдбреЗрдЯрд╛ рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддреА рд╣реИрдВред

### рдЯрд╛рдЗрдорд▓рд╛рдЗрди

рдЯрд╛рдЗрдорд▓рд╛рдЗрди рдПрдХ Windows рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬреЛ рд╡реЗрдм рдкреЗрдЬ, рд╕рдВрдкрд╛рджрд┐рдд рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдФрд░ рдЪрд▓рд╛рдП рдЧрдП рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХрд╛ **рдХрд╛рд▓рд╛рдВрдХрд┐рдХ рдЗрддрд┐рд╣рд╛рд╕** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

рдбреЗрдЯрд╛рдмреЗрд╕ рдкрде `\Users\<username>\AppData\Local\ConnectedDevicesPlatform\<id>\ActivitiesCache.db` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред рдЗрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдПрдХ SQLite рдЙрдкрдХрд░рдг рдпрд╛ рдЙрдкрдХрд░рдг [**WxTCmd**](https://github.com/EricZimmerman/WxTCmd) рдХреЗ рд╕рд╛рде рдЦреЛрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ **рдЬреЛ 2 рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдХрд░рдг** [**TimeLine Explorer**](https://ericzimmerman.github.io/#!index.md) **рдХреЗ рд╕рд╛рде рдЦреЛрд▓реА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ**ред

### ADS (рд╡реИрдХрд▓реНрдкрд┐рдХ рдбреЗрдЯрд╛ рд╕реНрдЯреНрд░реАрдореНрд╕)

рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ **ADS Zone.Identifier** рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддреА рд╣реИрдВ рдЬреЛ рдЗрд╕реЗ рдЗрдВрдЯреНрд░рд╛рдиреЗрдЯ, рдЗрдВрдЯрд░рдиреЗрдЯ рдЖрджрд┐ рд╕реЗ **рдХреИрд╕реЗ** рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред рдХреБрдЫ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ (рдЬреИрд╕реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░) рдЖрдо рддреМрд░ рдкрд░ **рдЕрдзрд┐рдХ** **рдЬрд╛рдирдХрд╛рд░реА** рднреА рдбрд╛рд▓рддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдХрд╣рд╛рдВ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

## **рдлрд╝рд╛рдЗрд▓ рдмреИрдХрдЕрдкреНрд╕**

### рд░реАрд╕рд╛рдЗрдХрд▓ рдмрд┐рди

Vista/Win7/Win8/Win10 рдореЗрдВ **рд░реАрд╕рд╛рдЗрдХрд▓ рдмрд┐рди** рдХреЛ рдбреНрд░рд╛рдЗрд╡ рдХреА рд░реВрдЯ рдореЗрдВ рдлрд╝реЛрд▓реНрдбрд░ **`$Recycle.bin`** рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (`C:\$Recycle.bin`)ред\
рдЬрдм рдЗрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╣рдЯрд╛рдИ рдЬрд╛рддреА рд╣реИ рддреЛ 2 рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИрдВ:

* `$I{id}`: рдлрд╝рд╛рдЗрд▓ рдХреА рдЬрд╛рдирдХрд╛рд░реА (рдЬрдм рдпрд╣ рд╣рдЯрд╛рдИ рдЧрдИ рдереА рдХреА рддрд╛рд░реАрдЦ}
* `$R{id}`: рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА

![](<../../../.gitbook/assets/image (486).png>)

рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде рдЖрдк рдЙрдкрдХрд░рдг [**Rifiuti**](https://github.com/abelcheung/rifiuti2) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдЯрд╛рдИ рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдореВрд▓ рдкрддрд╛ рдФрд░ рд╣рдЯрд╛рдИ рдЧрдИ рддрд╛рд░реАрдЦ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (Vista - Win10 рдХреЗ рд▓рд┐рдП `rifiuti-vista.exe` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ)ред
```
.\rifiuti-vista.exe C:\Users\student\Desktop\Recycle
```
![](<../../../.gitbook/assets/image (495) (1) (1) (1).png>)

### рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкреА

рд╢реИрдбреЛ рдХреЙрдкреА рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╡рд┐рдВрдбреЛрдЬ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдлрд╝рд╛рдЗрд▓ рдпрд╛ рд╡реЙрд▓реНрдпреВрдо рдХреА **рдмреИрдХрдЕрдк рдХреЙрдкрд┐рдпрд╛рдВ** рдпрд╛ рд╕реНрдиреИрдкрд╢реЙрдЯ рдмрдирд╛ рд╕рдХрддреА рд╣реИ, рднрд▓реЗ рд╣реА рд╡реЗ рдЙрдкрдпреЛрдЧ рдореЗрдВ рд╣реЛрдВред

рдпреЗ рдмреИрдХрдЕрдкреНрд╕ рдЖрдо рддреМрд░ рдкрд░ `\System Volume Information` рдореЗрдВ рд░реВрдЯ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рд╕реНрдерд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдХрд╛ рдирд╛рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЫрд╡рд┐ рдореЗрдВ рджрд┐рдЦрд╛рдП рдЧрдП **UIDs** рд╕реЗ рдорд┐рд▓рдХрд░ рдмрдирддрд╛ рд╣реИ:

![](<../../../.gitbook/assets/image (520).png>)

**ArsenalImageMounter** рдХреЗ рд╕рд╛рде рдлреЛрд░реЗрдВрд╕рд┐рдХреНрд╕ рдЗрдореЗрдЬ рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░рдХреЗ, рдЙрдкрдХрд░рдг [**ShadowCopyView**](https://www.nirsoft.net/utils/shadow\_copy\_view.html) рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рд╢реИрдбреЛ рдХреЙрдкреА рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдФрд░ рд╢реИрдбреЛ рдХреЙрдкреА рдмреИрдХрдЕрдк рд╕реЗ **рдлрд╝рд╛рдЗрд▓реЗрдВ рдирд┐рдХрд╛рд▓рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![](<../../../.gitbook/assets/image (521).png>)

рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдПрдВрдЯреНрд░реА `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\BackupRestore` рдлрд╝рд╛рдЗрд▓реЗрдВ рдФрд░ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИ **рдЬрд┐рдиреНрд╣реЗрдВ рдмреИрдХрдЕрдк рди рдХрд░реЗрдВ**:

![](<../../../.gitbook/assets/image (522).png>)

рд░рдЬрд┐рд╕реНрдЯреНрд░реА `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\VSS` рдореЗрдВ рднреА `рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкрд┐рдпреЛрдВ` рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рдиреНрдпрд╛рд╕ рд╕реВрдЪрдирд╛ рд╣реЛрддреА рд╣реИред

### рдСрдлрд┐рд╕ рдСрдЯреЛрд╕реЗрд╡реНрдб рдлрд╝рд╛рдЗрд▓реЗрдВ

рдЖрдк рдСрдлрд┐рд╕ рдСрдЯреЛрд╕реЗрд╡реНрдб рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: `C:\Usuarios\\AppData\Roaming\Microsoft{Excel|Word|Powerpoint}\`

## рд╢реИрд▓ рдЖрдЗрдЯрдореНрд╕

рдПрдХ рд╢реИрд▓ рдЖрдЗрдЯрдо рдПрдХ рдЖрдЗрдЯрдо рд╣реИ рдЬреЛ рджреВрд╕рд░реА рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддрд╛ рд╣реИред

### рд╣рд╛рд▓ рдХреЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ (LNK)

рд╡рд┐рдВрдбреЛрдЬ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ** рдпреЗ **рд╢реЙрд░реНрдЯрдХрдЯ** рдмрдирд╛рддрд╛ рд╣реИ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ рдлрд╝рд╛рдЗрд▓ **рдЦреЛрд▓рддрд╛ рд╣реИ, рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдмрдирд╛рддрд╛ рд╣реИ**:

* Win7-Win10: `C:\Users\\AppData\Roaming\Microsoft\Windows\Recent\`
* Office: `C:\Users\\AppData\Roaming\Microsoft\Office\Recent\`

рдЬрдм рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ рд▓рд┐рдВрдХ рдлрд╝рд╛рдЗрд▓, рдорд╛рддрд╛-рдкрд┐рддрд╛ рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд┐рдВрдХ, рдФрд░ рдкрд░рджрд╛рджреА рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдП рднреА рдПрдХ рд▓рд┐рдВрдХ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЧрдП рд▓рд┐рдВрдХ рдлрд╝рд╛рдЗрд▓реЗрдВ **рдореВрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреА рд╣реИрдВ** рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ рдПрдХ **рдлрд╝рд╛рдЗрд▓ рд╣реИ** **рдпрд╛** рдПрдХ **рдлрд╝реЛрд▓реНрдбрд░**, рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЗ **MAC рд╕рдордп**, рдЬрд╣рд╛рдБ рдлрд╝рд╛рдЗрд▓ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реИ рдЙрд╕рдХреА **рд╡реЙрд▓реНрдпреВрдо рдЬрд╛рдирдХрд╛рд░реА** рдФрд░ **рд▓рдХреНрд╖рд┐рдд рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдлрд╝реЛрд▓реНрдбрд░**ред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдЙрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрдХ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬреЛ рд╣рдЯрд╛ рджреА рдЧрдИ рд╣реЛрдВред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд▓рд┐рдВрдХ рдлрд╝рд╛рдЗрд▓ рдХрд╛ **рдирд┐рд░реНрдорд╛рдг рддрд┐рдерд┐** рдлрд╝рд╛рдЗрд▓ рдХрд╛ **рдкрд╣рд▓рд╛ рд╕рдордп** рд╣реЛрддрд╛ рд╣реИ рдФрд░ рд▓рд┐рдВрдХ рдлрд╝рд╛рдЗрд▓ рдХрд╛ **рд╕рдВрд╢реЛрдзрд┐рдд рддрд┐рдерд┐** рдореВрд▓ рдлрд╝рд╛рдЗрд▓ рдХрд╛ **рдЕрдВрддрд┐рдо рд╕рдордп** рд╣реЛрддрд╛ рд╣реИред

рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк [**LinkParser**](http://4discovery.com/our-tools/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рдЙрдкрдХрд░рдг рдореЗрдВ рдЖрдкрдХреЛ **2 рд╕реЗрдЯ** рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдорд┐рд▓реЗрдВрдЧреЗ:

* **рдкрд╣рд▓рд╛ рд╕реЗрдЯ:**
1. рдлрд╝рд╛рдЗрд▓ рд╕рдВрд╢реЛрдзрд┐рдд рддрд┐рдерд┐
2. рдлрд╝рд╛рдЗрд▓ рдПрдХреНрд╕реЗрд╕ рддрд┐рдерд┐
3. рдлрд╝рд╛рдЗрд▓ рдирд┐рд░реНрдорд╛рдг рддрд┐рдерд┐
* **рджреВрд╕рд░рд╛ рд╕реЗрдЯ:**
1. рд▓рд┐рдВрдХ рд╕рдВрд╢реЛрдзрд┐рдд рддрд┐рдерд┐
2. рд▓рд┐рдВрдХ рдПрдХреНрд╕реЗрд╕ рддрд┐рдерд┐
3. рд▓рд┐рдВрдХ рдирд┐рд░реНрдорд╛рдг рддрд┐рдерд┐ред

рдкрд╣рд▓реЗ рд╕реЗрдЯ рдХрд╛ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдлрд╝рд╛рдЗрд▓ рдЗрд╕реА рддрд┐рдерд┐рдпреЛрдВ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред рджреВрд╕рд░рд╛ рд╕реЗрдЯ рд▓рд┐рдВрдХ рдлрд╝рд╛рдЗрд▓ рдХреА рддрд┐рдерд┐рдпреЛрдВ рдХрд╛ рд╕рдВрджрд░реНрдн рдХрд░рддрд╛ рд╣реИред

рдЖрдк рд╡рд┐рдВрдбреЛрдЬ CLI рдЙрдкрдХрд░рдг рдЪрд▓рд╛рдХрд░ рдЗрд╕реА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [**LECmd.exe**](https://github.com/EricZimmerman/LECmd)
```
LECmd.exe -d C:\Users\student\Desktop\LNKs --csv C:\Users\student\Desktop\LNKs
```
### рдЬрдореНрдкрд▓рд┐рд╕реНрдЯреНрд╕

рдпреЗ рд╣рд╛рд▓ рдХреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реИрдВ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рджрд░реНрд╢рд╛рдП рдЬрд╛рддреЗ рд╣реИрдВред рдпрд╣ рдПрдХ рдРрд╕реА **рд╕реВрдЪреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ** рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпреЗ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ рдпрд╛ рдХрд╕реНрдЯрдо рднреА рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ**ред

**рдЬрдореНрдкрд▓рд┐рд╕реНрдЯреНрд╕** рдЬреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ, рд╡реЗ `C:\Users\{рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо}\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations\` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред рдЬрдореНрдкрд▓рд┐рд╕реНрдЯреНрд╕ рдХрд╛ рдирд╛рдо `{id}.autmaticDestinations-ms` рдирд╛рдордХ рдкреНрд░рд╛рд░реВрдк рдХрд╛ рд╣реЛрддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЖрдИрдбреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдЖрдИрдбреА рд╣реЛрддреА рд╣реИред

рдХрд╕реНрдЯрдо рдЬрдореНрдкрд▓рд┐рд╕реНрдЯреНрд╕ `C:\Users\{рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо}\AppData\Roaming\Microsoft\Windows\Recent\CustomDestination\` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдЖрдо рддреМрд░ рдкрд░ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХрд┐рд╕реА **рдорд╣рддреНрд╡рдкреВрд░реНрдг** рдШрдЯрдирд╛ рдХреЗ рд╕рд╛рде рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдХреБрдЫ рд╣реЛ рдЧрдпрд╛ рд╣реИ (рд╢рд╛рдпрдж рдкрд╕рдВрджреАрджрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛ)

рдХрд┐рд╕реА рднреА рдЬрдореНрдкрд▓рд┐рд╕реНрдЯ рдХрд╛ **рдирд┐рд░реНрдорд╛рдг рд╕рдордп** рджрд░реНрд╢рд╛рддрд╛ рд╣реИ **рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкрд╣рд▓рд╛ рд╕рдордп** рдФрд░ **рд╕рдВрд╢реЛрдзрд┐рдд рд╕рдордп** рдЕрдВрддрд┐рдо рдмрд╛рд░ред

рдЖрдк [**JumplistExplorer**](https://ericzimmerman.github.io/#!index.md) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрдореНрдкрд▓рд┐рд╕реНрдЯреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

![](<../../../.gitbook/assets/image (474).png>)

(_рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ JumplistExplorer рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╕рдордп рдЪрд┐рд╣реНрдирд┐рдд рдЬрдореНрдкрд▓рд┐рд╕реНрдЯ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВ_)

### рд╢реЗрд▓рдмреИрдЧреНрд╕

[**рдЗрд╕ рд▓рд┐рдВрдХ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рд╢реЗрд▓рдмреИрдЧреНрд╕ рдХреНрдпрд╛ рд╣реИрдВ рдпрд╣ рдЬрд╛рди рд╕рдХреЗрдВред**](interesting-windows-registry-keys.md#shellbags)
```bash
.\PECmd.exe -d C:\Users\student\Desktop\Prefetch --html "C:\Users\student\Desktop\out_folder"
```
![](<../../../.gitbook/assets/image (487).png>)

### рд╕реБрдкрд░рдкреНрд░реАрдлреЗрдЪ

**рд╕реБрдкрд░рдкреНрд░реАрдлреЗрдЪ** рдХрд╛ рдЙрд╕реА рд▓рдХреНрд╖реНрдп рд╣реИ рдЬреИрд╕реЗ рдкреНрд░реАрдлреЗрдЪ, **рдкреНрд░реЛрдЧреНрд░рд╛рдореНрд╕ рдХреЛ рддреЗрдЬреА рд╕реЗ рд▓реЛрдб рдХрд░рдирд╛** рдЕрдЧрд▓реЗ рдХреНрдпрд╛ рд▓реЛрдб рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ рдХрд╛ рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХрд░рдХреЗред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдкреНрд░реАрдлреЗрдЪ рд╕реЗрд╡рд╛ рдХреА рдЬрдЧрд╣ рдирд╣реАрдВ рд▓реЗрддрд╛ рд╣реИред\
рдпрд╣ рд╕реЗрд╡рд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рдлрд╝рд╛рдЗрд▓реНрд╕ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧреА `C:\Windows\Prefetch\Ag*.db` рдореЗрдВред

рдЗрди рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдЖрдк **рдкреНрд░реЛрдЧреНрд░рд╛рдо** рдХрд╛ **рдирд╛рдо**, **рдПрдХреНрдЬреАрдХреНрдпреВрд╢рдиреНрд╕** рдХреА **рд╕рдВрдЦреНрдпрд╛**, **рдлрд╝рд╛рдЗрд▓реЗрдВ** **рдУрдкрди** рдХреА рдЧрдИрдВ, **рд╡реЙрд▓реНрдпреВрдо** **рдПрдХреНрд╕реЗрд╕**, **рдкреВрд░рд╛** **рдкрде**, **рд╕рдордпрдЕрдВрддрд░** рдФрд░ **рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕** рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдЙрдкрдХрд░рдг [**CrowdResponse**](https://www.crowdstrike.com/resources/community-tools/crowdresponse/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред

### SRUM

**рд╕рд┐рд╕реНрдЯрдо рд░рд┐рд╕реЛрд░реНрд╕ рдпреВрдЬрд╝реЗрдЬрд╝ рдореЙрдирд┐рдЯрд░** (SRUM) **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╕рдВрд╕рд╛рдзрдиреЛрдВ** рдХрд╛ **рдирд┐рдЧрд░рд╛рдиреА** рдХрд░рддрд╛ рд╣реИред рдпрд╣ W8 рдореЗрдВ рдкреНрд░рдХрдЯ рд╣реБрдЖ рдФрд░ рдпрд╣ рдбреЗрдЯрд╛ рдХреЛ `C:\Windows\System32\sru\SRUDB.dat` рдореЗрдВ рд╕реНрдерд┐рдд рдПрдХ ESE рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:

* рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЖрдИрдбреА рдФрд░ рдкрде
* рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЪрд▓рд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛
* рднреЗрдЬреЗ рдЧрдП рдмрд╛рдЗрдЯреНрд╕
* рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЧрдП рдмрд╛рдЗрдЯреНрд╕
* рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕
* рдХрдиреЗрдХреНрд╢рди рдЕрд╡рдзрд┐
* рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрд╡рдзрд┐

рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд╣рд░ 60 рдорд┐рдирдЯ рдореЗрдВ рдЕрдкрдбреЗрдЯ рд╣реЛрддреА рд╣реИред

рдЖрдк рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЙрдкрдХрд░рдг [**srum\_dump**](https://github.com/MarkBaggett/srum-dump) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред
```bash
.\srum_dump.exe -i C:\Users\student\Desktop\SRUDB.dat -t SRUM_TEMPLATE.xlsx -o C:\Users\student\Desktop\srum
```
### AppCompatCache (ShimCache)

**Shimcache**, рдЬрд┐рд╕реЗ **AppCompatCache** рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, **Application Compatibility Database** рдХрд╛ рдПрдХ рдШрдЯрдХ рд╣реИ, рдЬрд┐рд╕реЗ **Microsoft** рдиреЗ рдмрдирд╛рдпрд╛ рдерд╛ рдФрд░ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рджреНрд╡рд╛рд░рд╛ рдЖрд╡реЗрджрди рд╕рдВрдЧрддрддрд╛ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдХреИрд╢ рд╡рд┐рднрд┐рдиреНрди рдлрд╝рд╛рдЗрд▓ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ:

* рдлрд╝рд╛рдЗрд▓ рдкреВрд░рд╛ рдкрде
* рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЖрдХрд╛рд░
* **$Standard\_Information** (SI) рдЕрдВрддрд┐рдо рд╕рдВрд╢реЛрдзрд┐рдд рд╕рдордп
* ShimCache рдЕрдВрддрд┐рдо рдЕрдкрдб
```bash
AmcacheParser.exe -f C:\Users\student\Desktop\Amcache.hve --csv C:\Users\student\Desktop\srum
```
### рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдлрд╛рдЗрд▓ рдХреИрд╢ рдмрдирд╛рдИ рдЧрдИ рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк CVS рдлрд╝рд╛рдЗрд▓ рд╣реИ `Amcache_Unassociated file entries`.

### RecentFileCache

рдЗрд╕ рдЖрд░реНрдЯрд┐рдлреИрдХреНрдЯ рдХреЛ рдХреЗрд╡рд▓ W7 рдореЗрдВ `C:\Windows\AppCompat\Programs\RecentFileCache.bcf` рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдХреБрдЫ рдмрд╛рдЗрдирд░реА рдХреЗ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддрд╛ рд╣реИред

рдЖрдк рдЯреВрд▓ [**RecentFileCacheParse**](https://github.com/EricZimmerman/RecentFileCacheParser) рдХрд╛ рдЙрдкрдпреЛрдЧ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдп

рдЖрдк рдЗрдиреНрд╣реЗрдВ `C:\Windows\Tasks` рдпрд╛ `C:\Windows\System32\Tasks` рд╕реЗ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ XML рдХреЗ рд░реВрдк рдореЗрдВ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред

### рд╕реЗрд╡рд╛рдПрдВ

рдЖрдк рдЙрдиреНрд╣реЗрдВ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ `SYSTEM\ControlSet001\Services` рдХреЗ рддрд╣рдд рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдФрд░ рдХрдмред

### **Windows Store**

рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди `\ProgramData\Microsoft\Windows\AppRepository\` рдореЗрдВ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
рдЗрд╕ рднрдВрдбрд╛рд░ рдореЗрдВ рдПрдХ **рд▓реЙрдЧ** рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХреА рдЬрд╛рддреА рд╣реИ рдЬреЛ рдбреЗрдЯрд╛рдмреЗрд╕ **`StateRepository-Machine.srd`** рдХреЗ рдЕрдВрджрд░ рд╣реИред

рдЗрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ Application рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рдЕрдВрджрд░, "Application ID", "PackageNumber", рдФрд░ "Display Name" рдирд╛рдордХ рд╕реНрддрдВрдн рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдпреЗ рд╕реНрддрдВрдн рдкреВрд░реНрд╡ рд╕реНрдерд╛рдкрд┐рдд рдФрд░ рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдирдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП рдереЗ рдХреНрдпреЛрдВрдХрд┐ рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рдЖрдИрдбреА рд╕реАрдХреНрд╡реЗрдВрд╢рд┐рдпрд▓ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдПред

рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдкрде `Software\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\Applications\` рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рднреА рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
рдФрд░ **рдЕрдирдЗрдВрд╕реНрдЯреЙрд▓** **рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдореЗрдВ: `Software\Microsoft\Windows\CurrentVersion\Appx\AppxAllUserStore\Deleted\`

## Windows рдШрдЯрдирд╛рдПрдВ

Windows рдШрдЯрдирд╛рдУрдВ рдХреЗ рдЕрдВрджрд░ рдЬреЛ рдЬрд╛рдирдХрд╛рд░реА рдЖрддреА рд╣реИ:

* рдХреНрдпрд╛ рд╣реБрдЖ
* рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк (UTC + 0)
* рд╢рд╛рдорд┐рд▓ рд╣реБрдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛
* рд╢рд╛рдорд┐рд▓ рд╣реБрдП рд╣реЛрд╕реНрдЯ (рд╣реЛрд╕реНрдЯрдирд╛рдо, рдЖрдИрдкреА)
* рдПрд╕реЗрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪрд╛ (рдлрд╝рд╛рдЗрд▓реЗрдВ, рдлрд╝реЛрд▓реНрдбрд░, рдкреНрд░рд┐рдВрдЯрд░, рд╕реЗрд╡рд╛рдПрдВ)

рд▓реЙрдЧ `C:\Windows\System32\config` рдореЗрдВ Windows Vista рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ `C:\Windows\System32\winevt\Logs` рдореЗрдВ Windows Vista рдХреЗ рдмрд╛рдж рд╕реНрдерд┐рдд рд╣реИрдВред Windows Vista рд╕реЗ рдкрд╣рд▓реЗ, рдЗрд╡реЗрдВрдЯ рд▓реЙрдЧ рдмрд╛рдЗрдирд░реА рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдереЗ рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж, рд╡реЗ **XML рдкреНрд░рд╛рд░реВрдк** рдореЗрдВ рд╣реИрдВ рдФрд░ **.evtx** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред

рдЗрд╡реЗрдВрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ **`HKLM\SYSTEM\CurrentControlSet\services\EventLog\{Application|System|Security}`** рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЗрдиреНрд╣реЗрдВ Windows рдЗрд╡реЗрдВрдЯ рд╡реНрдпреВрдЕрд░ (**`eventvwr.msc`**) рд╕реЗ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ [**Event Log Explorer**](https://eventlogxp.com) рдЬреИрд╕реЗ рдЕрдиреНрдп рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ **рдпрд╛** [**Evtx Explorer/EvtxECmd**](https://ericzimmerman.github.io/#!index.md)**.**

### рд╕реБрд░рдХреНрд╖рд╛

рдпрд╣ рдкрд╣реБрдВрдЪ рдШрдЯрдирд╛рдУрдВ рдХреЛ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛ рд╣реИ рдЬреЛ `C:\Windows\System32\winevt\Security.evtx` рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╡реЗрдВрдЯ рдлрд╝рд╛рдЗрд▓ рдХреА **рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░** рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЬрдм рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ рдкрд╣реБрдВрдЪ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдкреБрд░рд╛рдиреА рдШрдЯрдирд╛рдУрдВ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрдЧрд╛ред

рдШрдЯрдирд╛рдПрдВ рдЬреЛ рд░рдЬрд┐рд╕реНрдЯрд░ рдХреА рдЧрдИ рд╣реИрдВ:

* рд▓реЙрдЧрд┐рди/рд▓реЙрдЧрдСрдл
* рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдХреНрд░рд┐рдпрд╛рдПрдБ
* рдлрд╝рд╛рдЗрд▓реЛрдВ, рдлрд╝реЛрд▓реНрдбрд░ рдФрд░ рд╕рд╛рдЭрд╛ рдПрд╕реЗрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪ
* рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдиреНрдпрд╛рд╕ рдХрд╛ рд╕рдВрд╢реЛрдзрди

рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдШрдЯрдирд╛рдПрдВ:

| рдЗрд╡реЗрдВрдЯ рдЖрдИрдбреА   | рд╡рд┐рд╡рд░рдг                  |
| --------- | ---------------------------- |
| 4624      | рд╕рдлрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг    |
| 4625      | рдкреНрд░рдорд╛рдгреАрдХрд░рдг рддреНрд░реБрдЯрд┐         |
| 4634/4647 | рд▓реЙрдЧ рдСрдл                      |
| 4672      | рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди |

рдЗрд╡реЗрдВрдЯ рдЖрдИрдбреА 4634/4647 рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЙрдк-рдкреНрд░рдХрд╛рд░ рд╣реИрдВ:

* **2 (рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡)**: рд▓реЙрдЧрд┐рди рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдерд╛ рдЬрд┐рд╕рдореЗрдВ рдХреАрдмреЛрд░реНрдб рдпрд╛ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдЬреИрд╕реЗ VNC рдпрд╛ `PSexec -U-` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред
* **3 (рдиреЗрдЯрд╡рд░реНрдХ)**: рд╕рд╛рдЭрд╛ рдлрд╝реЛрд▓реНрдбрд░ рдХрдиреЗрдХреНрд╢рди
* **4 (рдмреИрдЪ)**: рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХреА рдЧрдИ
* **5 (рд╕реЗрд╡рд╛)**: рд╕реЗрд╡рд╛ рдХрдВрдЯреНрд░реЛрд▓ рдкреНрд░рдмрдВрдзрдХ рджреНрд╡рд╛рд░рд╛ рд╢реБрд░реВ рдХреА рдЧрдИ рд╕реЗрд╡рд╛
* **6 (рдкреНрд░реЙрдХреНрд╕реА):** рдкреНрд░реЙрдХреНрд╕реА рд▓реЙрдЧрд┐рди
* **7 (рдЕрдирд▓реЙрдХ)**: рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрдХреНрд░реАрди рдЕрдирдмреНрд▓реЙрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛
* **8 (рдиреЗрдЯрд╡рд░реНрдХ рдХреНрд▓рд┐рдпрд░рдЯреЗрдХреНрд╕реНрдЯ)**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдкрд╛рд╕рд╡рд░реНрдб рднреЗрдЬрд╛ рдЧрдпрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдгред рдпрд╣ рдШрдЯрдирд╛ IIS рд╕реЗ рдЖрддреА рдереА
* **9 (рдирдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг)**: рдпрд╣ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ рдЬрдм `RunAs` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд╕рд╛рде рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛ рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИред
* **10 (рд░рд┐рдореЛрдЯ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡)**: рдЯрд░реНрдорд┐рдирд▓ рд╕реЗрд╡рд╛рдУрдВ рдпрд╛ RDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг
* **11 (рдХреИрд╢ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡)**: рдЕрдВрддрд┐рдо рдХреИрд╢ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╣реБрдВрдЪ рдХреНрдпреЛрдВрдХрд┐ рдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓рд░ рд╕реЗ рд╕рдВрдкрд░реНрдХ рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрд╛
* **12 (рдХреИрд╢ рд░рд┐рдореЛрдЯ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡)**: рдХреИрд╢ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд╕рд╛рде рджреВрд░рд╕реНрде рд▓реЙрдЧрд┐рди (10 рдФрд░ 11 рдХрд╛ рд╕рдВрдпреЛрдЬрди)ред
* **13 (рдХреИрд╢ рдЕрдирд▓реЙрдХ)**: рдХреИрд╢ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд╕рд╛рде рдмрдВрдж рдорд╢реАрди рдХреЛ рдЕрдирд▓реЙрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ред

рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ, рдЖрдк рдпрд╣рд╛рдБ рдкрд╛рдПрдВрдЧреЗ рдХрд┐ рдЗрди рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓реЙрдЧрд┐рди рдХреЛ рдХреИрд╕реЗ рдорд┐рдорд┐рдХ рдХрд░реЗрдВ рдФрд░ рдХрд┐рд╕рдореЗрдВ рд╕реЗ рдЖрдк рдореЗрдореЛрд░реА рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [https://www.alteredsecurity.com/post/fantastic-windows-logon-types-and-where-to-find-credentials-in-them](https://www.alteredsecurity.com/post/fantastic-windows-logon-types-and-where-to-find-credentials-in-them)

рдЗрд╡реЗрдВрдЯ рдЖрдИрдбреА 4625 рдХреЗ рд╕реНрдерд┐рддрд┐ рдФрд░ рдЙрдк-рд╕реНрдерд┐рддрд┐ рдЬрд╛рдирдХрд╛рд░реА рдШрдЯрдирд╛ рдХреЗ рдХрд╛рд░рдгреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рджреЗ рд╕рдХрддреА рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╡реЗрдВрдЯ рдЖрдИрдбреА 4625 рдХреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдерд┐рддрд┐ рдФрд░ рд╕рдм рд╕реНрдерд┐рддрд┐ рдХреЛрдбреНрд╕ рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ:

![](<../../../.gitbook/assets/image (455).png>)

### Windows рдЗрд╡реЗрдВрдЯ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐

Windows рдЗрд╡реЗрдВрдЯ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХреЗ рд▓рд┐рдП рд╕рдВрджреЗрд╣рд╛рд╕реНрдкрдж PC рдХреЛ **рдЕрдирдкреНрд▓рдЧ рдХрд░рдХреЗ** рдмрдВрдж рдХрд░рдирд╛ рдЕрддреНрдпрдзрд┐рдХ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдпрджрд┐ рд╡реЗ рд╣рдЯрд╛ рджрд┐рдП рдЧрдП рдереЗ, рддреЛ рдЙрдиреНрд╣реЗрдВ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдХрд░рдг рдЬреЛ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ [**Bulk\_extractor**](../partitions-file-systems-carving/file-data-carving-recovery-tools.md#bulk-extractor) рдЬреЛ **evtx** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рд╕рдВрдХреЗрддрд┐рдд рдХрд░рддрд╛ рд╣реИред

## Windows рдЗрд╡реЗрдВрдЯ рдХреЗ рд╕рд╛рде рд╕рд╛рдорд╛рдиреНрдп рд╣рдорд▓реЛрдВ рдХреА рдкрд╣рдЪрд╛рди

* [https://redteamrecipe.com/event-codes/](https://redteamrecipe.com/event-codes/)

### рдмреНрд░реВрдЯ рдлрд╝реЛрд░реНрд╕ рд╣рдорд▓рд╛

рдПрдХ рдмреНрд░реВрдЯ рдлрд╝реЛрд░реНрд╕ рд╣рдорд▓рд╛ рдЖрд╕рд╛рдиреА рд╕реЗ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рдХрдИ рдЗрд╡реЗрдВрдЯ рдЖрдИрдбреА 4625** рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреЗред рдпрджрд┐ рд╣рдорд▓рд╛ **рд╕рдлрд▓** рд░рд╣рд╛ рд╣реИ, рддреЛ рдЗрд╡реЗрдВрдЯ рдЖрдИрдбреА 4625 рдХреЗ рдмрд╛рдж, **рдПрдХ рдЗрд╡реЗрдВрдЯ рдЖрдИрдбреА 4624** рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред

### рд╕рдордп рдкрд░рд┐рд╡
