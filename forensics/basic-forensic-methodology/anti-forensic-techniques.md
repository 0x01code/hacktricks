<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks** рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░рд╛ рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


# рд╕рдордп-рдЪрд┐рд╣реНрди

рдХрд┐рд╕реА рд╣рдорд▓рд╛рд╡рд░ рдХреЛ **рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рдордп-рдЪрд┐рд╣реНрдиреЛрдВ рдХреЛ рдмрджрд▓рдиреЗ** рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдкреА рд╣реЛ рд╕рдХрддреА рд╣реИред\
рдПрдордПрдлрдЯреА рдореЗрдВ рд╕рдордп-рдЪрд┐рд╣реНрди рдвреВрдВрдврдирд╛ рд╕рдВрднрд╡ рд╣реИ рдЬреЛ рдЧреБрдгреЛрдВ `$STANDARD_INFORMATION` __ рдФрд░ __ `$FILE_NAME` рдореЗрдВ рд╣реИрдВред

рджреЛрдиреЛрдВ рдЧреБрдгреЛрдВ рдореЗрдВ 4 рд╕рдордп-рдЪрд┐рд╣реНрди рд╣реЛрддреЗ рд╣реИрдВ: **рд╕рдВрд╢реЛрдзрди**, **рдкрд╣реБрдВрдЪ**, **рдирд┐рд░реНрдорд╛рдг**, рдФрд░ **рдПрдордПрдлрдЯреА рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕рдВрд╢реЛрдзрди** (MACE рдпрд╛ MACB)ред

**Windows рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░** рдФрд░ рдЕрдиреНрдп рдЙрдкрдХрд░рдг **`$STANDARD_INFORMATION`** рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рджрд┐рдЦрд╛рддреЗ рд╣реИрдВред

## рдЯрд╛рдЗрдорд╕реНрдЯреЙрдореНрдк - рдПрдВрдЯреА-рдлреЛрд░реЗрдВрд╕рд┐рдХ рдЯреВрд▓

рдпрд╣ рдЙрдкрдХрд░рдг **`$STANDARD_INFORMATION`** рдХреЗ рднреАрддрд░ рд╕рдордп-рдЪрд┐рд╣реНрди рдЬрд╛рдирдХрд╛рд░реА рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ** **рд▓реЗрдХрд┐рди** **`$FILE_NAME`** рдХреЗ рднреАрддрд░ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ **рдирд╣реАрдВ**ред рдЗрд╕рд▓рд┐рдП, рдпрд╣ рд╕рдВрджреЗрд╣рд╛рд╕реНрдкрдж рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред

## Usnjrnl

**USN Journal** (рдЕрдкрдбреЗрдЯ рд╕реАрдХреНрд╡реЗрдВрд╕ рдирдВрдмрд░ рдЬрд░реНрдирд▓) NTFS (Windows NT рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо) рдХрд╛ рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬреЛ рд╡реЙрд▓реНрдпреВрдо рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИред [**UsnJrnl2Csv**](https://github.com/jschicht/UsnJrnl2Csv) рдЙрдкрдХрд░рдг рдЗрди рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (449).png>)

рдкрд┐рдЫрд▓реА рдЫрд╡рд┐ рдЙрдкрдХрд░рдг рджреНрд╡рд╛рд░рд╛ рджрд┐рдЦрд╛рдИ рдЧрдИ **рдЖрдЙрдЯрдкреБрдЯ** рд╣реИ рдЬрд╣рд╛рдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ **рдкрд░рд┐рд╡рд░реНрддрди рдХрд┐рдП рдЧрдП рдереЗ** рдлрд╝рд╛рдЗрд▓ рдореЗрдВред

## $LogFile

рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╕рднреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд▓реЙрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ [рд╡реНрд░рд╛рдЗрдЯ-рдЕрд╣реЗрдб рд▓реЙрдЧрд┐рдВрдЧ](https://en.wikipedia.org/wiki/Write-ahead_logging) рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рд▓реЙрдЧ рдХрд┐рдП рдЧрдП рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ `**$LogFile**` рдирд╛рдордХ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдПрдХ NTFS рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдореВрд▓ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред [LogFileParser](https://github.com/jschicht/LogFileParser) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдФрд░ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (450).png>)

рдлрд┐рд░ рд╕реЗ, рдЙрдкрдХрд░рдг рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ **рдХреБрдЫ рдкрд░рд┐рд╡рд░реНрддрди рдХрд┐рдП рдЧрдП рдереЗ**ред

рдЗрд╕реА рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдордп-рдЪрд┐рд╣реНрдиреЛрдВ рдХреЛ **рдХрд┐рд╕ рд╕рдордп рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛** рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ:

![](<../../.gitbook/assets/image (451).png>)

* CTIME: рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рд╕рдордп
* ATIME: рдлрд╝рд╛рдЗрд▓ рдХрд╛ рд╕рдВрд╢реЛрдзрди рд╕рдордп
* MTIME: рдлрд╝рд╛рдЗрд▓ рдХрд╛ MFT рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕рдВрд╢реЛрдзрди
* RTIME: рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрд╣реБрдВрдЪ рд╕рдордп

## `$STANDARD_INFORMATION` рдФрд░ `$FILE_NAME` рддреБрд▓рдирд╛

рд╕рдВрджреЗрд╣рд╛рд╕реНрдкрдж рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реЛрдЧрд╛ рдХрд┐ рджреЛрдиреЛрдВ рдЧреБрдгреЛрдВ рдкрд░ рд╕рдордп рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ рдФрд░ **рдорд┐рд▓рд╛рди** рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ **рдЕрд╕рдВрдЧрддрд┐рдпрд╛рдБ**ред

## рдиреИрдиреЛрд╕реЗрдХрдВрдб

**NTFS** рд╕рдордп-рдЪрд┐рд╣реНрдиреЛрдВ рдХрд╛ рдПрдХ **рдкреНрд░реЗрд╕рд┐рдЬрди** рд╣реИ **100 рдиреИрдиреЛрд╕реЗрдХрдВрдб**ред рдлрд┐рд░, 2010-10-10 10:10:**00.000:0000 рдЬреИрд╕реЗ рд╕рдордп-рдЪрд┐рд╣реНрди рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреЛрдЬрдирд╛ рдмрд╣реБрдд рд╕рдВрджреЗрд╣рд╛рд╕реНрдкрдж рд╣реИред

## SetMace - рдПрдВрдЯреА-рдлреЛрд░реЗрдВрд╕рд┐рдХ рдЯреВрд▓

рдпрд╣ рдЙрдкрдХрд░рдг рджреЛрдиреЛрдВ рдЧреБрдгреЛрдВ `$STARNDAR_INFORMATION` рдФрд░ `$FILE_NAME` рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, Windows Vista рд╕реЗ, рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЗрд╡ рдУрдПрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

# рдбреЗрдЯрд╛ рдЫреБрдкрд╛рдирд╛

NFTS рдПрдХ рдХреНрд▓рд╕реНрдЯрд░ рдФрд░ рдиреНрдпреВрдирддрдо рдЬрд╛рдирдХрд╛рд░реА рдЖрдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрджрд┐ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдПрдХ рдХреНрд▓рд╕реНрдЯрд░ рдФрд░ рдЖрдзрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ, рддреЛ **рд╢реЗрд╖ рдЖрдзрд╛ рдХрднреА рднреА рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рд╣реЛрдЧрд╛** рдЬрдм рддрдХ рдлрд╝рд╛рдЗрд▓ рд╣рдЯрд╛рдИ рдирд╣реАрдВ рдЬрд╛рддреАред рдлрд┐рд░, рдЗрд╕ "рдЫрд┐рдкреА" рдЬрдЧрд╣ рдореЗрдВ рдбреЗрдЯрд╛ рдЫреБрдкрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИред

рдЗрд╕ рддрд░рд╣ рдХреЗ "рдЫрд┐рдкреА" рдЬрдЧрд╣ рдореЗрдВ рдбреЗрдЯрд╛ рдЫреБрдкрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдХрд░рдг рдЬреИрд╕реЗ slacker рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, `$logfile` рдФрд░ `$usnjrnl` рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рджрд┐рдЦрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ рдбреЗрдЯрд╛ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛:

![](<../../.gitbook/assets/image (452).png>)

рдлрд┐рд░, FTK Imager рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЫрд┐рдкреА рдЬрдЧрд╣ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЙрдкрдХрд░рдг рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЕрдВрдзрд╛рдХреГрдд рдпрд╛ рдпрд╣рд╛рдБ рддрдХ рдХрд┐ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рднреА рд╕рд╣реЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред

# UsbKill

рдпрд╣ рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ **USB** рдкреЛрд░реНрдЯ рдореЗрдВ рдХрд┐рд╕реА рднреА рдкрд░рд┐рд╡рд░реНрддрди рдХреЛ рдбрд┐рдЯреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИ рддреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ **рдмрдВрдж рдХрд░ рджреЗрдЧрд╛**ред\
рдЗрд╕реЗ рдЦреЛрдЬрдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИ рдХрд┐ рдЪрд▓ рд░рд╣реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ **рдкреНрд░рддреНрдпреЗрдХ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рдЬрд╛рдВрдЪ** рдХрд░реЗрдВред

# рд▓рд╛рдЗрд╡ рд▓рд┐рдирдХреНрд╕ рд╡рд┐рддрд░рдг

рдпреЗ рдбрд┐рд╕реНрдЯреНрд░реЛ **рд░реИрдо рдореЗрдореЛрд░реА рдХреЗ рдЕрдВрджрд░ рдЪрд▓рд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ**ред рдЗрдиреНрд╣реЗрдВ рдкрд╣рдЪрд╛рдирдиреЗ рдХрд╛ рдПрдХрдорд╛рддреНрд░ рддрд░реАрдХрд╛ рд╣реИ **рдпрджрд┐ NTFS рдлрд╛рдЗрд▓-рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд▓реЗрдЦрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**ред рдпрджрд┐ рдпрд╣ рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рдЙрдкрджреНрд░рд╡ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реЛрдЧрд╛ред

# рд╕реБрд░рдХреНрд╖рд┐рдд рдорд┐рдЯрд╛рдирд╛

[https://github.com/Claudio-C/awesome-data-sanitization](https://github.com/Claudio-C/awesome-data-sanitization)

# Windows рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди

рдлреЛрд░реЗрдВрд╕рд┐рдХреНрд╕ рдЬрд╛рдВрдЪ рдХреЛ рдХрдард┐рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рд╡рд┐рдВрдбреЛрдЬ рд▓реЙрдЧрд┐рдВрдЧ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред

## рд╕рдордп-рдЪрд┐рд╣реНрдиреЛрдВ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ - UserAssist

рдпрд╣ рдПрдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА рд╣реИ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдХреНрд░рд┐рдпрд╛рд╢реАрд▓ рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдИ рдЧрдИ рдкреНрд░рддреНрдпреЗрдХ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рджрд┐рдирд╛рдВрдХ рдФрд░ рдШрдВрдЯреЗ рдХреЛ рдмрдирд╛рдП рд░рдЦрддреА рд╣реИред

UserAssist рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреЛ рдХрджрдо рд╣реИрдВ:

1. рджреЛ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд╕реЗрдЯ рдХрд░реЗрдВ, `HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\Start_TrackProgs` рдФрд░ `HKEY_CURRENT_USER\SOFTWARE
## рд╣рдЯрд╛рдПрдВ USB рдЗрддрд┐рд╣рд╛рд╕

рд╕рднреА **USB рдбрд┐рд╡рд╛рдЗрд╕ рдПрдВрдЯреНрд░реАрдЬ** Windows рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ **USBSTOR** рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА рдХреЗ рддрд╣рдд рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдЙрдкрдХрдВрдЬреА рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИрдВ рдЬреЛ рдЬрдм рднреА рдЖрдк рдЕрдкрдиреЗ PC рдпрд╛ рд▓реИрдкрдЯреЙрдк рдореЗрдВ рдПрдХ USB рдбрд┐рд╡рд╛рдЗрд╕ рдкреНрд▓рдЧ рдХрд░рддреЗ рд╣реИрдВред рдЖрдк рдЗрд╕ рдХреБрдВрдЬреА рдХреЛ рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\USBSTOR`ред **рдЗрд╕реЗ рд╣рдЯрд╛рдиреЗ** рд╕реЗ рдЖрдк USB рдЗрддрд┐рд╣рд╛рд╕ рдХреЛ рд╣рдЯрд╛ рджреЗрдВрдЧреЗред\
рдЖрдк рдЗрд╕реЗ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг [**USBDeview**](https://www.nirsoft.net/utils/usb_devices_view.html) рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдФрд░ рдЗрдиреНрд╣реЗрдВ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП)ред

рдПрдХ рдФрд░ рдлрд╝рд╛рдЗрд▓ рдЬреЛ USBs рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╕рд╣реЗрдЬрддреА рд╣реИ, рд╡рд╣ рд╣реИ рдлрд╝рд╛рдЗрд▓ `setupapi.dev.log` `C:\Windows\INF` рдХреЗ рдЕрдВрджрд░ред рдЗрд╕реЗ рднреА рд╣рдЯрд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

## рд╢реИрдбреЛ рдХреЙрдкрд┐рдпреЛрдВ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ

`vssadmin list shadowstorage` рдХреЗ рд╕рд╛рде рд╢реИрдбреЛ рдХреЙрдкрд┐рдпреЛрдВ рдХреА **рд╕реВрдЪреА** рдмрдирд╛рдПрдВ\
рдЙрдиреНрд╣реЗрдВ рд░рди рдХрд░рдХреЗ рд╣рдЯрд╛рдПрдВ `vssadmin delete shadow`

рдЖрдк GUI рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рдЙрдиреНрд╣реЗрдВ рд╣рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдЪрд░рдгреЛрдВ](https://www.ubackup.com/windows-10/how-to-delete-shadow-copies-windows-10-5740.html) рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред

рд╢реИрдбреЛ рдХреЙрдкрд┐рдпреЛрдВ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рд╕реЗ рдЪрд░рдг](https://support.waters.com/KB_Inf/Other/WKB15560_How_to_disable_Volume_Shadow_Copy_Service_VSS_in_Windows):

1. "рд╕реЗрд╡рд╛рдПрдВ" рдХрд╛рд░реНрдпрдХреНрд░рдо рдЦреЛрд▓реЗрдВ рдЬрд┐рд╕реЗ рд╡рд┐рдВрдбреЛрдЬ рд╕реНрдЯрд╛рд░реНрдЯ рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж "рд╕реЗрд╡рд╛рдПрдВ" рд▓рд┐рдЦрдХрд░ рдЯреЗрдХреНрд╕реНрдЯ рдЦреЛрдЬ рдмреЙрдХреНрд╕ рдореЗрдВ рдЯрд╛рдЗрдк рдХрд░рдХреЗред
2. рд╕реВрдЪреА рд╕реЗ "рд╡реЙрд▓реНрдпреВрдо рд╢реИрдбреЛ рдХреЙрдкреА" рдвреВрдВрдвреЗрдВ, рдЗрд╕реЗ рдЪреБрдиреЗрдВ, рдФрд░ рдлрд┐рд░ рд░рд╛рдЗрдЯ-рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдкреНрд░реЙрдкрд░реНрдЯреАрдЬрд╝ рддрдХ рдкрд╣реБрдБрдЪреЗрдВред
3. "рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдкреНрд░рдХрд╛рд░" рдбреНрд░реЙрдк-рдбрд╛рдЙрди рдореЗрдиреВ рд╕реЗ "рдбрд┐рд╕реЗрдмрд▓реНрдб" рдЪреБрдиреЗрдВ, рдФрд░ рдлрд┐рд░ рдмрджрд▓рд╛рд╡ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП "рдПрдкреНрд▓рд╛рдИ" рдФрд░ "рдУрдХреЗ" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ `HKLM\SYSTEM\CurrentControlSet\Control\BackupRestore\FilesNotToSnapshot` рдореЗрдВ рдХреМрди рд╕реА рдлрд╝рд╛рдЗрд▓реЗрдВ рд╢реИрдбреЛ рдХреЙрдкреА рдореЗрдВ рдХреЙрдкреА рдХреА рдЬрд╛рдПрдВрдЧреА, рдЙрд╕рдХреА рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## рд╣рдЯрд╛рдПрдВ рд╣рдЯрд╛рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЗрдВ

* рдЖрдк рдПрдХ **Windows рдЙрдкрдХрд░рдг** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `cipher /w:C` рдпрд╣ cipher рдХреЛ рд╕реА рдбреНрд░рд╛рдЗрд╡ рдХреЗ рдЙрдкрд▓рдмреНрдз рдЕрдкреНрд░рдпреБрдХреНрдд рдбрд┐рд╕реНрдХ рд╕реНрдерд╛рди рд╕реЗ рдХрд┐рд╕реА рднреА рдбреЗрдЯрд╛ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрдд рджреЗрдЧрд╛ред
* рдЖрдк [**Eraser**](https://eraser.heidi.ie) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ

## рд╣рдЯрд╛рдПрдВ Windows рдШрдЯрдирд╛ рд▓реЙрдЧ

* Windows + R --> eventvwr.msc --> "Windows Logs" рдХреЛ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд░реЗрдВ --> рдкреНрд░рддреНрдпреЗрдХ рд╢реНрд░реЗрдгреА рдкрд░ рд░рд╛рдЗрдЯ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ "рдХреНрд▓рд┐рдпрд░ рд▓реЙрдЧ" рдЪреБрдиреЗрдВ
* `for /F "tokens=*" %1 in ('wevtutil.exe el') DO wevtutil.exe cl "%1"`
* `Get-EventLog -LogName * | ForEach { Clear-EventLog $_.Log }`

## Windows рдШрдЯрдирд╛ рд▓реЙрдЧ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ

* `reg add 'HKLM\SYSTEM\CurrentControlSet\Services\eventlog' /v Start /t REG_DWORD /d 4 /f`
* рд╕реЗрд╡рд╛рдУрдВ рдЦрдВрдб рдХреЗ рдЕрдВрджрд░ рд╕реЗрд╡рд╛ "Windows Event Log" рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ
* `WEvtUtil.exec clear-log` рдпрд╛ `WEvtUtil.exe cl`

## $UsnJrnl рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ

* `fsutil usn deletejournal /d c:`

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
