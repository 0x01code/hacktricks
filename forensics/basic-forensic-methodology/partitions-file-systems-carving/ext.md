<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ.

</details>


# Ext - рдПрдХреНрд╕рдЯреЗрдВрдбреЗрдб рдлрд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо

**Ext2** рд╕рдмрд╕реЗ рдЖрдо рдлрд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рд╣реИ **рдиреЙрди-рдЬрд░реНрдирд▓рд┐рдВрдЧ** рдкрд╛рд░реНрдЯреАрд╢рдиреНрд╕ рдХреЗ рд▓рд┐рдП (**рдкрд╛рд░реНрдЯреАрд╢рдиреНрд╕ рдЬреЛ рдЬреНрдпрд╛рджрд╛ рдирд╣реАрдВ рдмрджрд▓рддреЗ**) рдЬреИрд╕реЗ рдХрд┐ рдмреВрдЯ рдкрд╛рд░реНрдЯреАрд╢рдиред **Ext3/4** **рдЬрд░реНрдирд▓рд┐рдВрдЧ** рд╣реИрдВ рдФрд░ рдЖрдорддреМрд░ рдкрд░ **рдмрд╛рдХреА рдкрд╛рд░реНрдЯреАрд╢рдиреНрд╕** рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

рдлрд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╕рднреА рдмреНрд▓реЙрдХ рдЧреНрд░реБрдкреНрд╕ рдХрд╛ рдЖрдХрд╛рд░ рд╕рдорд╛рди рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдпреЗ рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВред рдЗрд╕рд╕реЗ рдХрд░реНрдиреЗрд▓ рдХреЛ рдбрд┐рд╕реНрдХ рдореЗрдВ рдмреНрд▓реЙрдХ рдЧреНрд░реБрдк рдХреЗ рд╕реНрдерд╛рди рдХреЛ рдЙрд╕рдХреЗ рдЗрдВрдЯреАрдЬрд░ рдЗрдВрдбреЗрдХреНрд╕ рд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдирд┐рдХрд╛рд▓рдиреЗ рдореЗрдВ рдорджрдж рдорд┐рд▓рддреА рд╣реИред

рдкреНрд░рддреНрдпреЗрдХ рдмреНрд▓реЙрдХ рдЧреНрд░реБрдк рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИ:

* рдлрд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕реБрдкрд░рдмреНрд▓реЙрдХ рдХреА рдПрдХ рдкреНрд░рддрд┐
* рдмреНрд▓реЙрдХ рдЧреНрд░реБрдк рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░реНрд╕ рдХреА рдПрдХ рдкреНрд░рддрд┐
* рдПрдХ рдбреЗрдЯрд╛ рдмреНрд▓реЙрдХ рдмрд┐рдЯрдореИрдк рдЬреЛ рдЧреНрд░реБрдк рдХреЗ рдЕрдВрджрд░ рдореБрдХреНрдд рдмреНрд▓реЙрдХреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рд╣реЛрддрд╛ рд╣реИ
* рдПрдХ рдЗрдиреЛрдб рдмрд┐рдЯрдореИрдк, рдЬреЛ рдЧреНрд░реБрдк рдХреЗ рдЕрдВрджрд░ рдореБрдХреНрдд рдЗрдиреЛрдбреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рд╣реЛрддрд╛ рд╣реИ
* рдЗрдиреЛрдб рдЯреЗрдмрд▓: рдпрд╣ рд▓рдЧрд╛рддрд╛рд░ рдмреНрд▓реЙрдХреНрд╕ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рд╣реЛрддреА рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдореЗрдВ рдПрдХ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдЗрдиреЛрдбреНрд╕ рд╣реЛрддреЗ рд╣реИрдВред рд╕рднреА рдЗрдиреЛрдбреНрд╕ рдХрд╛ рдЖрдХрд╛рд░ рд╕рдорд╛рди рд╣реЛрддрд╛ рд╣реИ: 128 рдмрд╛рдЗрдЯреНрд╕ред рдПрдХ 1,024 рдмрд╛рдЗрдЯ рдмреНрд▓реЙрдХ рдореЗрдВ 8 рдЗрдиреЛрдбреНрд╕ рд╣реЛрддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ рдПрдХ 4,096-рдмрд╛рдЗрдЯ рдмреНрд▓реЙрдХ рдореЗрдВ 32 рдЗрдиреЛрдбреНрд╕ рд╣реЛрддреЗ рд╣реИрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ Ext2 рдореЗрдВ, рдЗрдиреЛрдб рдирдВрдмрд░ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдмреНрд▓реЙрдХ рдирдВрдмрд░ рдХреЗ рдмреАрдЪ рдбрд┐рд╕реНрдХ рдкрд░ рдореИрдкрд┐рдВрдЧ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рдХреНрдпреЛрдВрдХрд┐ рдмрд╛рдж рд╡рд╛рд▓рд╛ рдорд╛рди рдмреНрд▓реЙрдХ рдЧреНрд░реБрдк рдирдВрдмрд░ рдФрд░ рдЗрдиреЛрдб рдЯреЗрдмрд▓ рдХреЗ рдЕрдВрджрд░ рд╕рд╛рдкреЗрдХреНрд╖ рд╕реНрдерд┐рддрд┐ рд╕реЗ рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдмреНрд▓реЙрдХ рдЧреНрд░реБрдк рдореЗрдВ 4,096 рдЗрдиреЛрдбреНрд╕ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рд╣рдореЗрдВ рдЗрдиреЛрдб 13,021 рдХреЗ рдбрд┐рд╕реНрдХ рдкрд░ рдкрддреЗ рдХреЛ рдЬрд╛рдирдирд╛ рд╣реИред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЗрдиреЛрдб рддреАрд╕рд░реЗ рдмреНрд▓реЙрдХ рдЧреНрд░реБрдк рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдбрд┐рд╕реНрдХ рдкрддрд╛ рд╕рдВрдмрдВрдзрд┐рдд рдЗрдиреЛрдб рдЯреЗрдмрд▓ рдХреА 733рд╡реАрдВ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИред рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрдиреЛрдб рдирдВрдмрд░ рд╕рд┐рд░реНрдл рдПрдХ рдХреБрдВрдЬреА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ Ext2 рд░реВрдЯреАрдиреНрд╕ рджреНрд╡рд╛рд░рд╛ рдбрд┐рд╕реНрдХ рдкрд░ рдЙрдЪрд┐рдд рдЗрдиреЛрдб рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдХреЛ рдЬрд▓реНрджреА рд╕реЗ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ
* рдбреЗрдЯрд╛ рдмреНрд▓реЙрдХреНрд╕, рдЬрд┐рд╕рдореЗрдВ рдлрд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рд╣реИрдВред рдХреЛрдИ рднреА рдмреНрд▓реЙрдХ рдЬрд┐рд╕рдореЗрдВ рдХреЛрдИ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рд╣реЛрддреА, рдЙрд╕реЗ рдореБрдХреНрдд рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред

![](<../../../.gitbook/assets/image (406).png>)

## Ext рд╡реИрдХрд▓реНрдкрд┐рдХ рдлреАрдЪрд░реНрд╕

**рдлреАрдЪрд░реНрд╕ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддреЗ рд╣реИрдВ** рдбреЗрдЯрд╛ рдХрд╣рд╛рдБ рд╕реНрдерд┐рдд рд╣реИ, **рдХреИрд╕реЗ** рдбреЗрдЯрд╛ рдЗрдиреЛрдбреНрд╕ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдХреБрдЫ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП **рдЕрддрд┐рд░рд┐рдХреНрдд рдореЗрдЯрд╛рдбреЗрдЯрд╛** рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП Ext рдореЗрдВ рдлреАрдЪрд░реНрд╕ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВред

Ext рдореЗрдВ рд╡реИрдХрд▓реНрдкрд┐рдХ рдлреАрдЪрд░реНрд╕ рд╣реЛрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдкрдХрд╛ OS рд╕рдорд░реНрдерди рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдЗрд╕рдХреА 3 рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ рд╣реИрдВ:

* рд╕рдВрдЧрдд
* рдЕрд╕рдВрдЧрдд
* рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдЧрдд: рдЗрд╕реЗ рдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ

рдпрджрд┐ **рдЕрд╕рдВрдЧрдд** рдлреАрдЪрд░реНрд╕ рд╣реИрдВ рддреЛ рдЖрдк рдлрд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдорд╛рдЙрдВрдЯ рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдВрдЧреЗ рдХреНрдпреЛрдВрдХрд┐ OS рдХреЛ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдкрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧрд╛ред

{% hint style="info" %}
рдПрдХ рд╕рдВрджрд┐рдЧреНрдз рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ рдЧреИрд░-рдорд╛рдирдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ
{% endhint %}

**рдХреЛрдИ рднреА рдЙрдкрдпреЛрдЧрд┐рддрд╛** рдЬреЛ **рд╕реБрдкрд░рдмреНрд▓реЙрдХ** рдХреЛ рдкрдврд╝рддреА рд╣реИ, рд╡рд╣ рдПрдХ **Ext рдлрд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо** рдХреЗ **рдлреАрдЪрд░реНрд╕** рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк `file -sL /dev/sd*` рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## рд╕реБрдкрд░рдмреНрд▓реЙрдХ

рд╕реБрдкрд░рдмреНрд▓реЙрдХ рд╢реБрд░реБрдЖрдд рд╕реЗ рдкрд╣рд▓реЗ 1024 рдмрд╛рдЗрдЯреНрд╕ рд╣реИ рдФрд░ рдпрд╣ рдкреНрд░рддреНрдпреЗрдХ рдЧреНрд░реБрдк рдХреЗ рдкрд╣рд▓реЗ рдмреНрд▓реЙрдХ рдореЗрдВ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* рдмреНрд▓реЙрдХ рдЖрдХрд╛рд░
* рдХреБрд▓ рдмреНрд▓реЙрдХреНрд╕
* рдкреНрд░рддрд┐ рдмреНрд▓реЙрдХ рдЧреНрд░реБрдк рдмреНрд▓реЙрдХреНрд╕
* рдкрд╣рд▓реЗ рдмреНрд▓реЙрдХ рдЧреНрд░реБрдк рд╕реЗ рдкрд╣рд▓реЗ рдЖрд░рдХреНрд╖рд┐рдд рдмреНрд▓реЙрдХреНрд╕
* рдХреБрд▓ рдЗрдиреЛрдбреНрд╕
* рдкреНрд░рддрд┐ рдмреНрд▓реЙрдХ рдЧреНрд░реБрдк рдЗрдиреЛрдбреНрд╕
* рд╡реЙрд▓реНрдпреВрдо рдирд╛рдо
* рдЕрдВрддрд┐рдо рд▓рд┐рдЦрдиреЗ рдХрд╛ рд╕рдордп
* рдЕрдВрддрд┐рдо рдорд╛рдЙрдВрдЯ рд╕рдордп
* рдкрде рдЬрд╣рд╛рдБ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдЕрдВрддрд┐рдо рдмрд╛рд░ рдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛
* рдлрд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рдХреА рд╕реНрдерд┐рддрд┐ (рд╕рд╛рдл?)

рдПрдХ Ext рдлрд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рдлрд╛рдЗрд▓ рд╕реЗ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ:
```bash
fsstat -o <offsetstart> /pat/to/filesystem-file.ext
#You can get the <offsetstart> with the "p" command inside fdisk
```
рдЖрдк рдореБрдлреНрдд GUI рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [https://www.disk-editor.org/index.html](https://www.disk-editor.org/index.html)\
рдпрд╛ рдЖрдк **python** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдкрд░рдмреНрд▓реЙрдХ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [https://pypi.org/project/superblock/](https://pypi.org/project/superblock/)

## inodes

**inodes** рдореЗрдВ **blocks** рдХреА рд╕реВрдЪреА рд╣реЛрддреА рд╣реИ рдЬреЛ рдПрдХ **file** рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ **data** рдХреЛ **contains** рдХрд░рддреА рд╣реИред\
рдпрджрд┐ file рдмрдбрд╝реА рд╣реИ, рддреЛ рдПрдХ inode рдореЗрдВ **other inodes** рдХреА рдУрд░ рд╕рдВрдХреЗрдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ pointers рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ blocks/more inodes рдХреА рдУрд░ рд╕рдВрдХреЗрдд рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ file data рд╣реЛрддрд╛ рд╣реИред

![](<../../../.gitbook/assets/image (416).png>)

**Ext2** рдФрд░ **Ext3** рдореЗрдВ inodes рдХрд╛ рдЖрдХрд╛рд░ **128B** рд╣реЛрддрд╛ рд╣реИ, **Ext4** рд╡рд░реНрддрдорд╛рди рдореЗрдВ **156B** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рднрд╡рд┐рд╖реНрдп рдХреЗ рд╡рд┐рд╕реНрддрд╛рд░ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рд╕реНрдХ рдкрд░ **256B** рдЖрд╡рдВрдЯрд┐рдд рдХрд░рддрд╛ рд╣реИред

Inode рд╕рдВрд░рдЪрдирд╛:

| Offset | Size | Name              | DescriptionF                                     |
| ------ | ---- | ----------------- | ------------------------------------------------ |
| 0x0    | 2    | File Mode         | File mode рдФрд░ type                                |
| 0x2    | 2    | UID               | Owner ID рдХреЗ Lower 16 bits                        |
| 0x4    | 4    | Size Il           | File size рдХреЗ Lower 32 bits                       |
| 0x8    | 4    | Atime             | Access time in seconds since epoch               |
| 0xC    | 4    | Ctime             | Change time in seconds since epoch               |
| 0x10   | 4    | Mtime             | Modify time in seconds since epoch               |
| 0x14   | 4    | Dtime             | Delete time in seconds since epoch               |
| 0x18   | 2    | GID               | Group ID рдХреЗ Lower 16 bits                        |
| 0x1A   | 2    | Hlink count       | Hard link count                                  |
| 0xC    | 4    | Blocks Io         | Block count рдХреЗ Lower 32 bits                     |
| 0x20   | 4    | Flags             | Flags                                            |
| 0x24   | 4    | Union osd1        | Linux: I version                                 |
| 0x28   | 69   | Block\[15]        | 15 points to data block                         |
| 0x64   | 4    | Version           | NFS рдХреЗ рд▓рд┐рдП File version                         |
| 0x68   | 4    | File ACL low      | Extended attributes (ACL, etc) рдХреЗ Lower 32 bits  |
| 0x6C   | 4    | File size hi      | File size рдХреЗ Upper 32 bits (ext4 only)           |
| 0x70   | 4    | Obsolete fragment | An obsoleted fragment address                    |
| 0x74   | 12   | Osd 2             | Second operating system dependent union          |
| 0x74   | 2    | Blocks hi         | Block count рдХреЗ Upper 16 bits                     |
| 0x76   | 2    | File ACL hi       | Extended attributes (ACL, etc.) рдХреЗ Upper 16 bits |
| 0x78   | 2    | UID hi            | Owner ID рдХреЗ Upper 16 bits                        |
| 0x7A   | 2    | GID hi            | Group ID рдХреЗ Upper 16 bits                        |
| 0x7C   | 2    | Checksum Io       | Inode checksum рдХреЗ Lower 16 bits                  |

"Modify" рд╡рд╣ timestamp рд╣реИ рдЬрдм file рдХреЗ _content_ рдореЗрдВ рдЖрдЦрд┐рд░реА рдмрд╛рд░ рдкрд░рд┐рд╡рд░реНрддрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдЗрд╕реЗ рдЕрдХреНрд╕рд░ "_mtime_" рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред\
"Change" рд╡рд╣ timestamp рд╣реИ рдЬрдм file рдХреЗ _inode_ рдореЗрдВ рдЖрдЦрд┐рд░реА рдмрд╛рд░ рдкрд░рд┐рд╡рд░реНрддрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЬреИрд╕реЗ рдХрд┐ permissions, ownership, file name, рдФрд░ hard links рдХреА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдмрджрд▓рд╛рд╡ рдХрд░рдирд╛ред рдЗрд╕реЗ рдЕрдХреНрд╕рд░ "_ctime_" рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред

Inode рд╕рдВрд░рдЪрдирд╛ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд (Ext4):

| Offset | Size | Name         | Description                                 |
| ------ | ---- | ------------ | ------------------------------------------- |
| 0x80   | 2    | Extra size   | рдорд╛рдирдХ 128 рд╕реЗ рдХрд┐рддрдиреЗ bytes рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╣реИрдВ |
| 0x82   | 2    | Checksum hi  | Inode checksum рдХреЗ Upper 16 bits             |
| 0x84   | 4    | Ctime extra  | Change time extra bits                      |
| 0x88   | 4    | Mtime extra  | Modify time extra bits                      |
| 0x8C   | 4    | Atime extra  | Access time extra bits                      |
| 0x90   | 4    | Crtime       | File create time (seconds since epoch)      |
| 0x94   | 4    | Crtime extra | File create time extra bits                 |
| 0x98   | 4    | Version hi   | Version рдХреЗ Upper 32 bits                    |
| 0x9C   |      | Unused       | рднрд╡рд┐рд╖реНрдп рдХреЗ рд╡рд┐рд╕реНрддрд╛рд░ рдХреЗ рд▓рд┐рдП рдЖрд░рдХреНрд╖рд┐рдд рд╕реНрдерд╛рди        |

рд╡рд┐рд╢реЗрд╖ inodes:

| Inode | Special Purpose                                      |
| ----- | ---------------------------------------------------- |
| 0     | рдХреЛрдИ рдРрд╕рд╛ inode рдирд╣реАрдВ, рдирдВрдмрд░рд┐рдВрдЧ 1 рд╕реЗ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ         |
| 1     | Defective block list                                 |
| 2     | Root directory                                       |
| 3     | User quotas                                          |
| 4     | Group quotas                                         |
| 5     | Boot loader                                          |
| 6     | Undelete directory                                   |
| 7     | Reserved group descriptors (for resizing filesystem) |
| 8     | Journal                                              |
| 9     | Exclude inode (for snapshots)                        |
| 10    | Replica inode                                        |
| 11    | рдкрд╣рд▓рд╛ non-reserved inode (рдЕрдХреНрд╕рд░ lost + found)         |

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ creation time рдХреЗрд╡рд▓ Ext4 рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИред
{% endhint %}

Inode number рдЬрд╛рдирдХрд░ рдЖрдк рдЖрд╕рд╛рдиреА рд╕реЗ рдЙрд╕рдХрд╛ index рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

* **Block group** рдЬрд╣рд╛рдВ рдПрдХ inode рд╕рдВрдмрдВрдзрд┐рдд рд╣реИ: (Inode number - 1) / (Inodes per group)
* **рдЙрд╕рдХреЗ group рдХреЗ рдЕрдВрджрд░ Index**: (Inode number - 1) mod(Inodes/groups)
* **inode table рдореЗрдВ Offset**: Inode number \* (Inode size)
* "-1" рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ inode 0 undefined (рдЙрдкрдпреЛрдЧ рдореЗрдВ рдирд╣реАрдВ) рд╣реИ
```bash
ls -ali /bin | sort -n #Get all inode numbers and sort by them
stat /bin/ls #Get the inode information of a file
istat -o <start offset> /path/to/image.ext 657103 #Get information of that inode inside the given ext file
icat -o <start offset> /path/to/image.ext 657103 #Cat the file
```
File Mode

| Number | Description                                                                                         |
| ------ | --------------------------------------------------------------------------------------------------- |
| **15** | **Reg/Slink-13/Socket-14**                                                                          |
| **14** | **Directory/Block Bit 13**                                                                          |
| **13** | **Char Device/Block Bit 14**                                                                        |
| **12** | **FIFO**                                                                                            |
| 11     | Set UID                                                                                             |
| 10     | Set GID                                                                                             |
| 9      | Sticky Bit (рдЗрд╕рдХреЗ рдмрд┐рдирд╛, рдХреЛрдИ рднреА рд╡реНрдпрдХреНрддрд┐ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ рдПрдХ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдкрд░ Write & exec рдЕрдиреБрдорддрд┐рдпрд╛рдВ рд╣реИрдВ, рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдирд╛рдо рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ)  |
| 8      | Owner Read                                                                                          |
| 7      | Owner Write                                                                                         |
| 6      | Owner Exec                                                                                          |
| 5      | Group Read                                                                                          |
| 4      | Group Write                                                                                         |
| 3      | Group Exec                                                                                          |
| 2      | Others Read                                                                                         |
| 1      | Others Write                                                                                        |
| 0      | Others Exec                                                                                         |

рдмреЛрд▓реНрдб рдмрд┐рдЯреНрд╕ (12, 13, 14, 15) рдлрд╛рдЗрд▓ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рджрд░реНрд╢рд╛рддреЗ рд╣реИрдВ (рдПрдХ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА, рд╕реЙрдХреЗрдЯ...) рдХреЗрд╡рд▓ рдПрдХ рдмреЛрд▓реНрдб рд╡рд┐рдХрд▓реНрдк рдореМрдЬреВрдж рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

Directories

| Offset | Size | Name      | Description                                                                                                                                                  |
| ------ | ---- | --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 0x0    | 4    | Inode     |                                                                                                                                                              |
| 0x4    | 2    | Rec len   | Record length                                                                                                                                                |
| 0x6    | 1    | Name len  | Name length                                                                                                                                                  |
| 0x7    | 1    | File type | <p>0x00 рдЕрдЬреНрдЮрд╛рдд<br>0x01 рдирд┐рдпрдорд┐рдд</p><p>0x02 рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛</p><p>0x03 Char device</p><p>0x04 Block device</p><p>0x05 FIFO</p><p>0x06 Socket</p><p>0x07 Sym link</p> |
| 0x8    |      | Name      | Name string (255 рдЕрдХреНрд╖рд░реЛрдВ рддрдХ)                                                                                                                               |

**рдкреНрд░рджрд░реНрд╢рди рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, Root hash Directory blocks рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред**

**Extended Attributes**

рдЗрд╕реЗ рд╕реНрдЯреЛрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ

* inodes рдХреЗ рдмреАрдЪ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реНрдерд╛рди рдореЗрдВ (256 - inode size, рдЖрдорддреМрд░ рдкрд░ = 100)
* рдПрдХ рдбреЗрдЯрд╛ рдмреНрд▓реЙрдХ рдЬрд┐рд╕реЗ inode рдореЗрдВ file_acl рджреНрд╡рд╛рд░рд╛ рд╕рдВрдХреЗрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ

рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреЛ рдпреВрдЬрд░ рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЕрдЧрд░ рдирд╛рдо "user" рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИред рдЗрд╕ рддрд░рд╣ рдбреЗрдЯрд╛ рдЫрд┐рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

Extended Attributes Entries

| Offset | Size | Name         | Description                                                                                                                                                                                                        |
| ------ | ---- | ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 0x0    | 1    | Name len     | рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдирд╛рдо рдХреА рд▓рдВрдмрд╛рдИ                                                                                                                                                                                           |
| 0x1    | 1    | Name index   | <p>0x0 = рдХреЛрдИ рдкреНрд░реАрдлрд┐рдХреНрд╕ рдирд╣реАрдВ</p><p>0x1 = user. рдкреНрд░реАрдлрд┐рдХреНрд╕</p><p>0x2 = system.posix_acl_access</p><p>0x3 = system.posix_acl_default</p><p>0x4 = trusted.</p><p>0x6 = security.</p><p>0x7 = system.</p><p>0x8 = system.richacl</p> |
| 0x2    | 2    | Value offs   | рдкрд╣рд▓реЗ inode рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдпрд╛ рдмреНрд▓реЙрдХ рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗ рдСрдлрд╕реЗрдЯ                                                                                                                                                                    |
| 0x4    | 4    | Value blocks | рдбрд┐рд╕реНрдХ рдмреНрд▓реЙрдХ рдЬрд╣рд╛рдВ рдореВрд▓реНрдп рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ рдпрд╛ рдЗрд╕ рдмреНрд▓реЙрдХ рдХреЗ рд▓рд┐рдП рд╢реВрдиреНрдп                                                                                                                                                     |
| 0x8    | 4    | Value size   | рдореВрд▓реНрдп рдХреА рд▓рдВрдмрд╛рдИ                                                                                                                                                                                                    |
| 0xC    | 4    | Hash         | рдмреНрд▓реЙрдХ рдореЗрдВ рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд╣реИрд╢ рдпрд╛ рдЕрдЧрд░ inode рдореЗрдВ рд╣реИ рддреЛ рд╢реВрдиреНрдп                                                                                                                                                  |
| 0x10   |      | Name         | рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдирд╛рдо рдмрд┐рдирд╛ рдЯреНрд░реЗрд▓рд┐рдВрдЧ NULL рдХреЗ                                                                                                                                                                             |
```bash
setfattr -n 'user.secret' -v 'This is a secret' file.txt #Save a secret using extended attributes
getfattr file.txt #Get extended attribute names of a file
getdattr -n 'user.secret' file.txt #Get extended attribute called "user.secret"
```
## рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рджреГрд╢реНрдп

рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреА рд╕рд╛рдордЧреНрд░реА рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк **рдирд┐рдГрд╢реБрд▓реНрдХ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**: [https://www.disk-editor.org/index.html](https://www.disk-editor.org/index.html)\
рдпрд╛ рдЖрдк рдЗрд╕реЗ рдЕрдкрдиреЗ рд▓рд┐рдирдХреНрд╕ рдореЗрдВ `mount` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд╛рдЙрдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

[https://piazza.com/class\_profile/get\_resource/il71xfllx3l16f/inz4wsb2m0w2oz#:\~:text=The%20Ext2%20file%20system%20divides,lower%20average%20disk%20seek%20time.](https://piazza.com/class\_profile/get\_resource/il71xfllx3l16f/inz4wsb2m0w2oz#:\~:text=The%20Ext2%20file%20system%20divides,lower%20average%20disk%20seek%20time.)


<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
