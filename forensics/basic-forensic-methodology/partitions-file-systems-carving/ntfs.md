# NTFS

## NTFS

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## **NTFS**

**NTFS** (**New Technology File System**) рдПрдХ рдкреНрд░реЛрдкреНрд░рд╛рдЗрдЯрд░реА рдЬрд░реНрдирд▓рд┐рдВрдЧ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╣реИ рдЬрд┐рд╕реЗ Microsoft рдиреЗ рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рд╣реИред

рдХреНрд▓рд╕реНрдЯрд░ NTFS рдореЗрдВ рдЖрдХрд╛рд░ рдХреА рд╕рдмрд╕реЗ рдЫреЛрдЯреА рдЗрдХрд╛рдИ рд╣реИ рдФрд░ рдХреНрд▓рд╕реНрдЯрд░ рдХрд╛ рдЖрдХрд╛рд░ рдПрдХ рдкрд╛рд░реНрдЯреАрд╢рди рдХреЗ рдЖрдХрд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

| рдкрд╛рд░реНрдЯреАрд╢рди рдХрд╛ рдЖрдХрд╛рд░           | рдХреНрд▓рд╕реНрдЯрд░ рдкреНрд░рддрд┐ рд╕реЗрдХреНрдЯрд░ | рдХреНрд▓рд╕реНрдЯрд░ рдХрд╛ рдЖрдХрд╛рд░ |
| ------------------------ | ------------------- | ------------ |
| 512MB рдпрд╛ рдХрдо            | 1                   | 512 рдмрд╛рдЗрдЯреНрд╕    |
| 513MB-1024MB (1GB)       | 2                   | 1KB          |
| 1025MB-2048MB (2GB)      | 4                   | 2KB          |
| 2049MB-4096MB (4GB)      | 8                   | 4KB          |
| 4097MB-8192MB (8GB)      | 16                  | 8KB          |
| 8193MB-16,384MB (16GB)   | 32                  | 16KB         |
| 16,385MB-32,768MB (32GB) | 64                  | 32KB         |
| 32,768MB рд╕реЗ рдЕрдзрд┐рдХ    | 128                 | 64KB         |

### **Slack-Space**

рдЪреВрдВрдХрд┐ NTFS рдХреА рд╕рдмрд╕реЗ рдЫреЛрдЯреА рдЗрдХрд╛рдИ рдПрдХ **рдХреНрд▓рд╕реНрдЯрд░** рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рдлрд╛рдЗрд▓ рдХрдИ рдкреВрд░реНрдг рдХреНрд▓рд╕реНрдЯрд░реНрд╕ рдХреЛ рдШреЗрд░ рд▓реЗрдЧреАред рдЗрд╕рд▓рд┐рдП, рдпрд╣ рдмрд╣реБрдд рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ **рдкреНрд░рддреНрдпреЗрдХ рдлрд╛рдЗрд▓ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╕реЗ рдЕрдзрд┐рдХ рд╕реНрдерд╛рди рдШреЗрд░ рд▓реЗрдЧреА**ред рдпреЗ **рдЕрдиреБрдкрдпреЛрдЧреА** **рд╕реНрдерд╛рди** рдЬреЛ рдПрдХ рдлрд╛рдЗрд▓ рджреНрд╡рд╛рд░рд╛ **рдмреБрдХ** рдХрд┐рдП рдЧрдП рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ **рд╕реНрд▓реИрдХрд┐рдВрдЧ** **рд╕реНрдкреЗрд╕** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд▓реЛрдЧ рдЗрд╕ рдХреНрд╖реЗрддреНрд░ рдХрд╛ рдлрд╛рдпрджрд╛ рдЙрдард╛рдХрд░ **рдЬрд╛рдирдХрд╛рд░реА рдЫрд┐рдкрд╛** рд╕рдХрддреЗ рд╣реИрдВред

![](<../../../.gitbook/assets/image (498).png>)

### **NTFS boot sector**

рдЬрдм рдЖрдк рдПрдХ NTFS рд╡реЙрд▓реНрдпреВрдо рдХреЛ рдлреЙрд░реНрдореЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдлреЙрд░реНрдореЗрдЯ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдкрд╣рд▓реЗ 16 рд╕реЗрдХреНрдЯрд░реНрд╕ рдХреЛ рдмреВрдЯ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдлрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдЖрд╡рдВрдЯрд┐рдд рдХрд░рддрд╛ рд╣реИред рдкрд╣рд▓рд╛ рд╕реЗрдХреНрдЯрд░ рдПрдХ рдмреВрдЯ рд╕реЗрдХреНрдЯрд░ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ "рдмреВрдЯрд╕реНрдЯреНрд░реИрдк" рдХреЛрдб рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдмрд╛рдХреА 15 рд╕реЗрдХреНрдЯрд░реНрд╕ рдмреВрдЯ рд╕реЗрдХреНрдЯрд░ рдХреЗ IPL (Initial Program Loader) рд╣реЛрддреЗ рд╣реИрдВред рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреА рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП NTFS рдкрд╛рд░реНрдЯреАрд╢рди рдХреЗ рдмрд╣реБрдд рдЕрдВрддрд┐рдо рд╕реЗрдХреНрдЯрд░ рдореЗрдВ рдмреВрдЯ рд╕реЗрдХреНрдЯрд░ рдХреА рдПрдХ рд╕реНрдкреЗрдпрд░ рдХреЙрдкреА рд╣реЛрддреА рд╣реИред

### **Master File Table (MFT)**

NTFS рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ Master File Table (MFT) рдирд╛рдордХ рдПрдХ рдлрд╛рдЗрд▓ рд╣реЛрддреА рд╣реИред NTFS рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╡реЙрд▓реНрдпреВрдо рдкрд░ рд╣рд░ рдлрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП MFT рдореЗрдВ рдХрдо рд╕реЗ рдХрдо **рдПрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рд╣реЛрддреА рд╣реИ**, MFT рдЦреБрдж рдХреЛ рднреА рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╣реБрдПред рдПрдХ рдлрд╛рдЗрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА, рдЬреИрд╕реЗ рдХрд┐ рдЗрд╕рдХрд╛ **рдЖрдХрд╛рд░, рд╕рдордп рдФрд░ рддрд╛рд░реАрдЦ рдХреЗ рд╕реНрдЯреИрдореНрдкреНрд╕, рдЕрдиреБрдорддрд┐рдпрд╛рдВ, рдФрд░ рдбреЗрдЯрд╛ рд╕рд╛рдордЧреНрд░реА**, MFT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдореЗрдВ рдпрд╛ MFT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╡рд░реНрдгрд┐рдд MFT рдХреЗ рдмрд╛рд╣рд░реА рд╕реНрдерд╛рди рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИред

рдЬреИрд╕реЗ-рдЬреИрд╕реЗ **рдлрд╛рдЗрд▓реЗрдВ NTFS рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╡реЙрд▓реНрдпреВрдо рдореЗрдВ рдЬреЛрдбрд╝реА рдЬрд╛рддреА рд╣реИрдВ**, MFT рдореЗрдВ рдФрд░ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдВ рдЬреЛрдбрд╝реА рдЬрд╛рддреА рд╣реИрдВ рдФрд░ **MFT рдХрд╛ рдЖрдХрд╛рд░ рдмрдврд╝рддрд╛ рд╣реИ**ред рдЬрдм **рдлрд╛рдЗрд▓реЗрдВ** NTFS рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╡реЙрд▓реНрдпреВрдо рд╕реЗ **рд╣рдЯрд╛рдИ рдЬрд╛рддреА рд╣реИрдВ**, рдЙрдирдХреА **MFT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдВ рдореБрдХреНрдд рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВ** рдФрд░ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЖрд╡рдВрдЯрд┐рдд рдбрд┐рд╕реНрдХ рд╕реНрдкреЗрд╕ рдХреЛ рдкреБрдирдГ рдЖрд╡рдВрдЯрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ MFT рдХрд╛ рдЖрдХрд╛рд░ рдХрдо рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред

NTFS рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо **MFT рдХреЛ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХреЗ рд╕рдВрд▓рдЧреНрди рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП MFT рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рди рдЖрд░рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ** рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдмрдврд╝рддрд╛ рд╣реИред NTFS рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддреНрдпреЗрдХ рд╡реЙрд▓реНрдпреВрдо рдХреЗ рд▓рд┐рдП MFT рдХреЗ рд▓рд┐рдП рдЖрд░рдХреНрд╖рд┐рдд рд╕реНрдерд╛рди рдХреЛ **MFT рдЬреЛрди** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдлрд╛рдЗрд▓реЛрдВ рдФрд░ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реАрдЬ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рди рднреА рдЗрд╕реА рд╕реНрдерд╛рди рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ MFT рдЬреЛрди рдХреЗ рдмрд╛рд╣рд░ рдХреЗ рд╕рднреА рд╡реЙрд▓реНрдпреВрдо рд╕реНрдерд╛рди рдХреЗ рдЖрд╡рдВрдЯрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рджред

рдФрд╕рдд рдлрд╛рдЗрд▓ рдЖрдХрд╛рд░ рдФрд░ рдЕрдиреНрдп рдЪрд░реЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, **рдпрд╛ рддреЛ рдЖрд░рдХреНрд╖рд┐рдд MFT рдЬреЛрди рдпрд╛ рдбрд┐рд╕реНрдХ рдкрд░ рдЕрдирд╛рд░рдХреНрд╖рд┐рдд рд╕реНрдерд╛рди рдХреЛ рдкрд╣рд▓реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдбрд┐рд╕реНрдХ рдХреНрд╖рдорддрд╛ рддрдХ рднрд░ рдЬрд╛рддреА рд╣реИ**ред рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдмрдбрд╝реА рдлрд╛рдЗрд▓реЛрдВ рд╡рд╛рд▓реЗ рд╡реЙрд▓реНрдпреВрдо рдЕрдирд╛рд░рдХреНрд╖рд┐рдд рд╕реНрдерд╛рди рдХреЛ рдкрд╣рд▓реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд░реЗрдВрдЧреЗ, рдЬрдмрдХрд┐ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдЫреЛрдЯреА рдлрд╛рдЗрд▓реЛрдВ рд╡рд╛рд▓реЗ рд╡реЙрд▓реНрдпреВрдо MFT рдЬреЛрди рдХреЛ рдкрд╣рд▓реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдХрд┐рд╕реА рднреА рдорд╛рдорд▓реЗ рдореЗрдВ, MFT рдХрд╛ рд╡рд┐рдЦрдВрдбрди рддрдм рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдПрдХ рдХреНрд╖реЗрддреНрд░ рдпрд╛ рджреВрд╕рд░рд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдЕрдирд╛рд░рдХреНрд╖рд┐рдд рд╕реНрдерд╛рди рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдлрд╛рдЗрд▓реЛрдВ рдФрд░ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реАрдЬ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рди MFT рдЬреЛрди рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрджрд┐ MFT рдЬреЛрди рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдирдИ MFT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рди рдЕрдирд╛рд░рдХреНрд╖рд┐рдд рд╕реНрдерд╛рди рд╕реЗ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

NTFS рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдПрдХ **$MFTMirror** рднреА рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред рдпрд╣ MFT рдХреА **рдкрд╣рд▓реА 4 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рдПрдХ рдкреНрд░рддрд┐рд▓рд┐рдкрд┐** рд╣реИ: $MFT, $MFT Mirror, $Log, $Volumeред

NTFS рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рдкрд╣рд▓реЗ 16 рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХреЛ рд╡рд┐рд╢реЗрд╖ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЖрд░рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ:

| рд╕рд┐рд╕реНрдЯрдо рдлрд╛рдЗрд▓           | рдлрд╛рдЗрд▓ рдХрд╛ рдирд╛рдо | MFT рд░рд┐рдХреЙрд░реНрдб | рдлрд╛рдЗрд▓ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп                                                                                                                                                                                                           |
| --------------------- | --------- | ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| рдорд╛рд╕реНрдЯрд░ рдлрд╛рдЗрд▓ рдЯреЗрдмрд▓     | $Mft      | 0          | NTFS рд╡реЙрд▓реНрдпреВрдо рдкрд░ рдкреНрд░рддреНрдпреЗрдХ рдлрд╛рдЗрд▓ рдФрд░ рдлреЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдмреЗрд╕ рдлрд╛рдЗрд▓ рд░рд┐рдХреЙрд░реНрдб рд╣реЛрддрд╛ рд╣реИред рдпрджрд┐ рдХрд┐рд╕реА рдлрд╛рдЗрд▓ рдпрд╛ рдлреЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдП рдЖрд╡рдВрдЯрди рдЬрд╛рдирдХрд╛рд░реА рдПрдХрд▓ рд░рд┐рдХреЙрд░реНрдб рдореЗрдВ рдлрд┐рдЯ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдмрдбрд╝реА рд╣реИ, рддреЛ рдЕрдиреНрдп рдлрд╛рдЗрд▓ рд░рд┐рдХреЙрд░реНрдбреНрд╕ рднреА рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред            |
| рдорд╛рд╕реНрдЯрд░ рдлрд╛рдЗрд▓ рдЯреЗрдмрд▓ 2   | $MftMirr  | 1          | MFT рдХреЗ рдкрд╣рд▓реЗ рдЪрд╛рд░ рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХреА рдПрдХ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдЫрд╡рд┐ред рдпрд╣ рдлрд╛рдЗрд▓ рдПрдХрд▓-рд╕реЗрдХреНрдЯрд░ рд╡рд┐рдлрд▓рддрд╛ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ MFT рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЧрд╛рд░рдВрдЯреА рджреЗрддреА рд╣реИред                                                                                            |
| рд▓реЙрдЧ рдлрд╛рдЗрд▓              | $LogFile  | 2          | NTFS рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХреЗ рд▓рд┐рдП рд▓реЗрди-рджреЗрди рдХреЗ рдЪрд░рдгреЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рд╣реЛрддреА рд╣реИред рд▓реЙрдЧ рдлрд╛рдЗрд▓ рдХрд╛ рдЖрдХрд╛рд░ рд╡реЙрд▓реНрдпреВрдо рдХреЗ рдЖрдХрд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ 4 MB рддрдХ рдмрдбрд╝рд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ Windows NT/2000 рджреНрд╡рд╛рд░рд╛ рд╕рд┐рд╕реНрдЯрдо рд╡рд┐рдлрд▓рддрд╛ рдХреЗ рдмрд╛рдж NTFS рдХреЛ рд╕рдВрдЧрддрддрд╛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред |
| рд╡реЙрд▓реНрдпреВрдо                | $Volume   | 3          | рд╡реЙрд▓реНрдпреВрдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИ,
