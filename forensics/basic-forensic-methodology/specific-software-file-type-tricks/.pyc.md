# рдкрд╛рдпрдерди рдмрд╛рдЗрдирд░реАрдЬрд╝ (exe, elf) рдХреЛ рдбреАрдХрдВрдкрд╛рдЗрд▓ рдХрд░реЗрдВ - .pyc рд╕реЗ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж рдЯреНрд╡рд┐рдЯрд░ ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П рдЯреНрд╡рд┐рдЪ ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе рдпреВрдЯреНрдпреВрдм ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рддрдХ рдкрд╣реБрдБрдЪ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **[**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рдЧреНрд░реБрдк**](https://discord.gg/hRep4RUj7f) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдЧреНрд░реБрдк**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<img src="../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

рдпрджрд┐ рдЖрдк **рд╣реИрдХрд┐рдВрдЧ рдХрд░рд┐рдпрд░** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдЕрд╣реИрдХрдмрд▓ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - **рд╣рдо рднрд░реНрддреА рдХрд░ рд░рд╣реЗ рд╣реИрдВ!** (_рдзрд╛рд░рд╛рдкреНрд░рд╡рд╛рд╣ рдкреЛрд▓рд┐рд╢ рд▓рд┐рдЦрд┐рдд рдФрд░ рдмреЛрд▓реА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ_).

{% embed url="https://www.stmcyber.com/careers" %}

## рд╕рдВрдХрд▓рд┐рдд рдмрд╛рдЗрдирд░реА рд╕реЗ .pyc рддрдХ

рдПрдХ **ELF** рд╕рдВрдХрд▓рд┐рдд рдмрд╛рдЗрдирд░реА рд╕реЗ рдЖрдк **.pyc рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЗрд╕рдХреЗ рд╕рд╛рде:
```bash
pyi-archive_viewer <binary>
# The list of python modules will be given here:
[(0, 230, 311, 1, 'm', 'struct'),
(230, 1061, 1792, 1, 'm', 'pyimod01_os_path'),
(1291, 4071, 8907, 1, 'm', 'pyimod02_archive'),
(5362, 5609, 13152, 1, 'm', 'pyimod03_importers'),
(10971, 1473, 3468, 1, 'm', 'pyimod04_ctypes'),
(12444, 816, 1372, 1, 's', 'pyiboot01_bootstrap'),
(13260, 696, 1053, 1, 's', 'pyi_rth_pkgutil'),
(13956, 1134, 2075, 1, 's', 'pyi_rth_multiprocessing'),
(15090, 445, 672, 1, 's', 'pyi_rth_inspect'),
(15535, 2514, 4421, 1, 's', 'binary_name'),
...

? X binary_name
to filename? /tmp/binary.pyc
```
рдПрдХ **python exe binary** рдореЗрдВ рд╕рдВрдХрд▓рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЖрдк **.pyc рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд▓рд╛рдХрд░:
```bash
python pyinstxtractor.py executable.exe
```
## .pyc рд╕реЗ python рдХреЛрдб рддрдХ

**.pyc** рдбреЗрдЯрд╛ ("compiled" python) рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **рдореВрд▓** **python** **рдХреЛрдб** рдХреЛ **рдирд┐рдХрд╛рд▓рдиреЗ** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП:
```bash
uncompyle6 binary.pyc  > decompiled.py
```
**рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ** рдХрд┐ рдмрд╛рдЗрдирд░реА рдореЗрдВ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди** "**.pyc**" рд╣реИ (рдпрджрд┐ рдирд╣реАрдВ, рддреЛ uncompyle6 рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛)

**uncompyle6** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╕рдордп рдЖрдкрдХреЛ **рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддреНрд░реБрдЯрд┐рдпрд╛рдБ** рдорд┐рд▓ рд╕рдХрддреА рд╣реИрдВ:

### рддреНрд░реБрдЯрд┐: рдЕрдЬреНрдЮрд╛рдд рдореИрдЬрд┐рдХ рдирдВрдмрд░ 227
```bash
/kali/.local/bin/uncompyle6 /tmp/binary.pyc
Unknown magic number 227 in /tmp/binary.pyc
```
рдЗрд╕реЗ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЙрддреНрдкрдиреНрди рдлрд╝рд╛рдЗрд▓ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ **рд╕рд╣реА рдореИрдЬрд┐рдХ рдирдВрдмрд░ рдЬреЛрдбрд╝рдирд╛ рд╣реЛрдЧрд╛**ред

**рдореИрдЬрд┐рдХ рдирдВрдмрд░ рдкрд╛рдпрдерди рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд╕рд╛рде рдмрджрд▓рддреЗ рд╣реИрдВ**, **рдкрд╛рдпрдерди 3.8** рдХрд╛ рдореИрдЬрд┐рдХ рдирдВрдмрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **рдкрд╛рдпрдерди 3.8** рдЯрд░реНрдорд┐рдирд▓ рдЦреЛрд▓рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЪрд▓рд╛рдирд╛ рд╣реЛрдЧрд╛:
```
>> import imp
>> imp.get_magic().hex()
'550d0d0a'
```
**рдореИрдЬрд┐рдХ рдирдВрдмрд░** рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ python3.8 рдХреЗ рд▓рд┐рдП **`0x550d0d0a`** рд╣реИ, рдлрд┐рд░, рдЗрд╕ рддреНрд░реБрдЯрд┐ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **.pyc рдлрд╛рдЗрд▓** рдХреА **рд╢реБрд░реБрдЖрдд** рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдмрд╛рдЗрдЯреНрд╕ **рдЬреЛрдбрд╝рдиреЗ** рд╣реЛрдВрдЧреЗ: `0x0d550a0d000000000000000000000000`

**рдПрдХ рдмрд╛рд░** рдЖрдкрдиреЗ рд╡рд╣ рдореИрдЬрд┐рдХ рд╣реЗрдбрд░ **рдЬреЛрдбрд╝ рджрд┐рдпрд╛**, рддреЛ **рддреНрд░реБрдЯрд┐ рдареАрдХ рд╣реЛ рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП.**

рдпрд╣ рд╣реИ рдХрд┐ рдХреИрд╕реЗ рдПрдХ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ **.pyc python3.8 рдореИрдЬрд┐рдХ рд╣реЗрдбрд░** рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛:
```bash
hexdump 'binary.pyc' | head
0000000 0d55 0a0d 0000 0000 0000 0000 0000 0000
0000010 00e3 0000 0000 0000 0000 0000 0000 0000
0000020 0700 0000 4000 0000 7300 0132 0000 0064
0000030 0164 006c 005a 0064 0164 016c 015a 0064
```
### рддреНрд░реБрдЯрд┐: рдбрд┐рдХрдореНрдкрд╛рдЗрд▓рд┐рдВрдЧ рд╕рд╛рдорд╛рдиреНрдп рддреНрд░реБрдЯрд┐рдпрд╛рдБ

**рдЕрдиреНрдп рддреНрд░реБрдЯрд┐рдпрд╛рдБ** рдЬреИрд╕реЗ: `class 'AssertionError'>; co_code рдХреЛ рдЗрдирдореЗрдВ рд╕реЗ рдПрдХ рдкреНрд░рдХрд╛рд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (<class 'str'>, <class 'bytes'>, <class 'list'>, <class 'tuple'>); рдкреНрд░рдХрд╛рд░ рд╣реИ <class 'NoneType'>` рджрд┐рдЦрд╛рдИ рджреЗ рд╕рдХрддреА рд╣реИрдВред

рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╢рд╛рдпрдж рдпрд╣ рд╣реИ рдХрд┐ рдЖрдкрдиреЗ рдореИрдЬрд┐рдХ рдирдВрдмрд░ рдХреЛ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ **рдирд╣реАрдВ рдЬреЛрдбрд╝рд╛** рд╣реИ рдпрд╛ рдЖрдкрдиреЗ **рд╕рд╣реА рдореИрдЬрд┐рдХ рдирдВрдмрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛** рд╣реИ, рдЗрд╕рд▓рд┐рдП **рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк рд╕рд╣реА рдПрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ** (рдпрд╛ рдирдпрд╛ рдПрдХ рдЖрдЬрдорд╛рдПрдВ)ред

рдкрд┐рдЫрд▓реА рддреНрд░реБрдЯрд┐ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред

## рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдг

рдЙрдкрдХрд░рдг [https://github.com/countercept/python-exe-unpacker](https://github.com/countercept/python-exe-unpacker) рд╕рдореБрджрд╛рдп рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рдХрдИ рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рдЬреЛрдбрд╝рддрд╛ рд╣реИ рдЬреЛ **рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдкрд╛рдпрдерди рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдХреЛ рдЕрдирдкреИрдХ рдФрд░ рдбрд┐рдХрдореНрдкрд╛рдЗрд▓ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВ** (py2exe рдФрд░ pyinstaller)ред

рдХрдИ YARA рдирд┐рдпрдо рдЙрдкрд▓рдмреНрдз рд╣реИрдВ рдЬреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдкрд╛рдпрдерди рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ (рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпрд╣ рднреА рдкреБрд╖реНрдЯрд┐ рдХрд░рддреА рд╣реИ рдХрд┐ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ py2exe рдпрд╛ pyinstaller рдХреЗ рд╕рд╛рде рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ)ред

### ImportError: рдлрд╝рд╛рдЗрд▓ рдирд╛рдо: 'unpacked/malware\_3.exe/**pycache**/archive.cpython-35.pyc' рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ

рд╡рд░реНрддрдорд╛рди рдореЗрдВ, unpy2exe рдпрд╛ pyinstxtractor рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдкреНрдд рдкрд╛рдпрдерди рдмрд╛рдЗрдЯрдХреЛрдб рдлрд╝рд╛рдЗрд▓ рдкреВрд░реА рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИ рдФрд░ рдмрджрд▓реЗ рдореЗрдВ, рдЗрд╕реЗ uncompyle6 рджреНрд╡рд╛рд░рд╛ рдкреНрд▓реЗрди рдкрд╛рдпрдерди рд╕реЛрд░реНрд╕ рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдкрд╣рдЪрд╛рдирд╛ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддрд╛**ред рдпрд╣ рдПрдХ рдЧреБрдо рдкрд╛рдпрдерди **рдмрд╛рдЗрдЯрдХреЛрдб рд╕рдВрд╕реНрдХрд░рдг рд╕рдВрдЦреНрдпрд╛** рдХреЗ рдХрд╛рд░рдг рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП рд╣рдордиреЗ рдПрдХ prepend рд╡рд┐рдХрд▓реНрдк рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рд╣реИ; рдпрд╣ рдЗрд╕рдореЗрдВ рдПрдХ рдкрд╛рдпрдерди рдмрд╛рдЗрдЯрдХреЛрдб рд╕рдВрд╕реНрдХрд░рдг рд╕рдВрдЦреНрдпрд╛ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдЧрд╛ рдФрд░ рдбрд┐рдХрдореНрдкрд╛рдЗрд▓рд┐рдВрдЧ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЖрд╕рд╛рди рдмрдирд╛рдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛ред рдЬрдм рд╣рдо uncompyle6 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ .pyc рдлрд╝рд╛рдЗрд▓ рдХреЛ рдбрд┐рдХрдореНрдкрд╛рдЗрд▓ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдпрд╣ рдПрдХ рддреНрд░реБрдЯрд┐ рд▓реМрдЯрд╛рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, **рдПрдХ рдмрд╛рд░ рдЬрдм рд╣рдо prepend рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рд╣рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдкрд╛рдпрдерди рд╕реЛрд░реНрд╕ рдХреЛрдб рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдбрд┐рдХрдореНрдкрд╛рдЗрд▓ рд╣реЛ рдЧрдпрд╛ рд╣реИ**ред
```
test@test: uncompyle6 unpacked/malware_3.exe/archive.py
Traceback (most recent call last):
тАжтАжтАжтАжтАжтАжтАжтАжтАж.
ImportError: File name: 'unpacked/malware_3.exe/__pycache__/archive.cpython-35.pyc' doesn't exist
```

```
test@test:python python_exe_unpack.py -p unpacked/malware_3.exe/archive
[*] On Python 2.7
[+] Magic bytes are already appended.

# Successfully decompiled file
[+] Successfully decompiled.
```
## рдкрд╛рдпрдерди рдЕрд╕реЗрдВрдмрд▓реА рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рдпрджрд┐ рдЖрдк рдкрд┐рдЫрд▓реЗ рдЪрд░рдгреЛрдВ рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рддреЗ рд╣реБрдП рдкрд╛рдпрдерди "рдореВрд▓" рдХреЛрдб рдирд┐рдХрд╛рд▓рдиреЗ рдореЗрдВ рд╕рдлрд▓ рдирд╣реАрдВ рд╣реЛ рдкрд╛рдП, рддреЛ рдЖрдк **рдЕрд╕реЗрдВрдмрд▓реА** рдирд┐рдХрд╛рд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рд▓реЗрдХрд┐рди рдпрд╣ **рдмрд╣реБрдд рд╡рд░реНрдгрдирд╛рддреНрдордХ рдирд╣реАрдВ рд╣реИ**, рдЗрд╕рд▓рд┐рдП рдореВрд▓ рдХреЛрдб рдХреЛ **рдлрд┐рд░ рд╕реЗ** рдирд┐рдХрд╛рд▓рдиреЗ рдХрд╛ **рдкреНрд░рдпрд╛рд╕** рдХрд░реЗрдВ)ред [рдпрд╣рд╛рдБ](https://bits.theorem.co/protecting-a-python-codebase/) рдореИрдВрдиреЗ рдПрдХ рдмрд╣реБрдд рд╣реА рд╕рд░рд▓ рдХреЛрдб рдкрд╛рдпрд╛ рд╣реИ рдЬреЛ _.pyc_ рдмрд╛рдЗрдирд░реА рдХреЛ **рдбрд┐рд╕рд╛рд╕реЗрдВрдмрд▓** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ (рдХреЛрдб рдлреНрд▓реЛ рдХреЛ рд╕рдордЭрдиреЗ рдореЗрдВ рд╢реБрднрдХрд╛рдордирд╛рдПрдБ)ред рдЕрдЧрд░ _.pyc_ рдкрд╛рдпрдерди2 рд╕реЗ рд╣реИ, рддреЛ рдкрд╛рдпрдерди2 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```bash
>>> import dis
>>> import marshal
>>> import struct
>>> import imp
>>>
>>> with open('hello.pyc', 'r') as f:  # Read the binary file
...     magic = f.read(4)
...     timestamp = f.read(4)
...     code = f.read()
...
>>>
>>> # Unpack the structured content and un-marshal the code
>>> magic = struct.unpack('<H', magic[:2])
>>> timestamp = struct.unpack('<I', timestamp)
>>> code = marshal.loads(code)
>>> magic, timestamp, code
((62211,), (1425911959,), <code object <module> at 0x7fd54f90d5b0, file "hello.py", line 1>)
>>>
>>> # Verify if the magic number corresponds with the current python version
>>> struct.unpack('<H', imp.get_magic()[:2]) == magic
True
>>>
>>> # Disassemble the code object
>>> dis.disassemble(code)
1           0 LOAD_CONST               0 (<code object hello_world at 0x7f31b7240eb0, file "hello.py", line 1>)
3 MAKE_FUNCTION            0
6 STORE_NAME               0 (hello_world)
9 LOAD_CONST               1 (None)
12 RETURN_VALUE
>>>
>>> # Also disassemble that const being loaded (our function)
>>> dis.disassemble(code.co_consts[0])
2           0 LOAD_CONST               1 ('Hello  {0}')
3 LOAD_ATTR                0 (format)
6 LOAD_FAST                0 (name)
9 CALL_FUNCTION            1
12 PRINT_ITEM
13 PRINT_NEWLINE
14 LOAD_CONST               0 (None)
17 RETURN_VALUE
```
## Python рд╕реЗ Executable рддрдХ

рд╢реБрд░реБрдЖрдд рдореЗрдВ, рд╣рдо рдЖрдкрдХреЛ рджрд┐рдЦрд╛рдПрдВрдЧреЗ рдХрд┐ payloads рдХреЛ py2exe рдФрд░ PyInstaller рдореЗрдВ рдХреИрд╕реЗ compile рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### py2exe рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ payload рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП:

1. [http://www.py2exe.org/](http://www.py2exe.org) рд╕реЗ py2exe рдкреИрдХреЗрдЬ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВред
2. Payload рдХреЗ рд▓рд┐рдП (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рдЗрд╕реЗ hello.py рдирд╛рдо рджреЗрдВрдЧреЗ), Figure 1 рдореЗрдВ рджрд┐рдЦрд╛рдП рдЧрдП рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рддрд░рд╣ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред рд╡рд┐рдХрд▓реНрдк тАЬbundle_filesтАЭ рдХрд╛ рдорд╛рди 1 рд╣реЛрдиреЗ рдкрд░ рд╕рдм рдХреБрдЫ рдмрдВрдбрд▓ рдХрд░ рджреЗрдЧрд╛, рдЬрд┐рд╕рдореЗрдВ Python interpreter рднреА рд╢рд╛рдорд┐рд▓ рд╣реИ, рдПрдХ exe рдореЗрдВред
3. рд╕реНрдХреНрд░рд┐рдкреНрдЯ рддреИрдпрд╛рд░ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдХрдорд╛рдВрдб тАЬpython setup.py py2exeтАЭ рдЬрд╛рд░реА рдХрд░реЗрдВрдЧреЗред рдпрд╣ executable рдмрдирд╛ рджреЗрдЧрд╛, рдЬреИрд╕реЗ рдХрд┐ Figure 2 рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред
```
from distutils.core import setup
import py2exe, sys, os

sys.argv.append('py2exe')

setup(
options = {'py2exe': {'bundle_files': 1}},
#windows = [{'script': "hello.py"}],
console = [{'script': "hello.py"}],
zipfile = None,
)
```

```
C:\Users\test\Desktop\test>python setup.py py2exe
running py2exe
*** searching for required modules ***
*** parsing results ***
*** finding dlls needed ***
*** create binaries ***
*** byte compile python files ***
*** copy extensions ***
*** copy dlls ***
copying C:\Python27\lib\site-packages\py2exe\run.exe -> C:\Users\test\Desktop\test\dist\hello.exe
Adding python27.dll as resource to C:\Users\test\Desktop\test\dist\hello.exe
```
### PyInstaller рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреЗрд▓реЛрдб рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП:

1. PyInstaller рдХреЛ pip рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ (pip install pyinstaller)ред
2. рдЙрд╕рдХреЗ рдмрд╛рдж, рд╣рдо рдХрдорд╛рдВрдб тАЬpyinstaller тАУonefile hello.pyтАЭ рдЬрд╛рд░реА рдХрд░реЗрдВрдЧреЗ (рдпрд╛рдж рджрд┐рд▓рд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ 'hello.py' рд╣рдорд╛рд░рд╛ рдкреЗрд▓реЛрдб рд╣реИ)ред рдпрд╣ рд╕рдм рдХреБрдЫ рдПрдХ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдореЗрдВ рдмрдВрдбрд▓ рдХрд░ рджреЗрдЧрд╛ред
```
C:\Users\test\Desktop\test>pyinstaller --onefile hello.py
108 INFO: PyInstaller: 3.3.1
108 INFO: Python: 2.7.14
108 INFO: Platform: Windows-10-10.0.16299
тАжтАжтАжтАжтАжтАжтАжтАжтАжтАжтАжтАж
5967 INFO: checking EXE
5967 INFO: Building EXE because out00-EXE.toc is non existent
5982 INFO: Building EXE from out00-EXE.toc
5982 INFO: Appending archive to EXE C:\Users\test\Desktop\test\dist\hello.exe
6325 INFO: Building EXE from out00-EXE.toc completed successfully.
```
## рд╕рдВрджрд░реНрдн

* [https://blog.f-secure.com/how-to-decompile-any-python-binary/](https://blog.f-secure.com/how-to-decompile-any-python-binary/)

<img src="../../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

рдпрджрд┐ рдЖрдк **рд╣реИрдХрд┐рдВрдЧ рдХрд░рд┐рдпрд░** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдЕрд╣реИрдХреНрдп рдЪреАрдЬреЛрдВ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - **рд╣рдо рднрд░реНрддреА рдХрд░ рд░рд╣реЗ рд╣реИрдВ!** (_рдзрд╛рд░рд╛рдкреНрд░рд╡рд╛рд╣ рдкреЛрд▓рд┐рд╢ рд▓рд┐рдЦрд┐рдд рдФрд░ рдмреЛрд▓реА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж рдЯреНрд╡рд┐рдЯрд░ ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П рдЯреНрд╡рд┐рдЪ ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе рдпреВрдЯреНрдпреВрдм ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рддрдХ рдкрд╣реБрдБрдЪ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╕рдВрдЧреНрд░рд╣ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **[**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рдЧреНрд░реБрдк**](https://discord.gg/hRep4RUj7f) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдЧреНрд░реБрдк**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) рдФрд░ [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.**

</details>
