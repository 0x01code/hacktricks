# рд▓рд┐рдирдХреНрд╕ рдлреЛрд░реЗрдВрд╕рд┐рдХреНрд╕

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрд╕рд╛рдиреА рд╕реЗ **рд╕рдореБрджрд╛рдп рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рдЙрдкрдХрд░рдгреЛрдВ** рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣** рдмрдирд╛рдПрдВ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪреЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ **рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

## рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдПрдХрддреНрд░ рдХрд░рдирд╛

### рдореМрд▓рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ **USB** рдХреЗ рд╕рд╛рде рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдореЗрдВ **рдЕрдЪреНрдЫреЗ рдЬрд╛рдиреЗ рдорд╛рдиреЗ рдмрд╛рдЗрдирд░реА рдФрд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА** рд╣реЛрдВ (рдЖрдк рдмрд╕ рдЙрдмрдВрдЯреВ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлреЛрд▓реНрдбрд░ _/bin_, _/sbin_, _/lib,_ рдФрд░ _/lib64_ рдХреЙрдкреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ), рдлрд┐рд░ USB рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░реЗрдВ, рдФрд░ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдЙрди рдмрд╛рдЗрдирд░реАрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ:
```bash
export PATH=/mnt/usb/bin:/mnt/usb/sbin
export LD_LIBRARY_PATH=/mnt/usb/lib:/mnt/usb/lib64
```
рдЬрдм рдЖрдкрдиреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЕрдЪреНрдЫреЗ рдФрд░ рдЬрд╛рдиреЗ-рдорд╛рдиреЗ binaries рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ, рддреЛ рдЖрдк **рдХреБрдЫ рдореМрд▓рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдирд╛** рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
date #Date and time (Clock may be skewed, Might be at a different timezone)
uname -a #OS info
ifconfig -a || ip a #Network interfaces (promiscuous mode?)
ps -ef #Running processes
netstat -anp #Proccess and ports
lsof -V #Open files
netstat -rn; route #Routing table
df; mount #Free space and mounted devices
free #Meam and swap space
w #Who is connected
last -Faiwx #Logins
lsmod #What is loaded
cat /etc/passwd #Unexpected data?
cat /etc/shadow #Unexpected data?
find /directory -type f -mtime -1 -print #Find modified files during the last minute in the directory
```
#### рд╕рдВрджреЗрд╣рдЬрдирдХ рдЬрд╛рдирдХрд╛рд░реА

рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╕рдордп рдЖрдкрдХреЛ рдРрд╕реА рдЕрдЬреАрдм рдЪреАрдЬреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдЬреИрд╕реЗ:

* **рд░реВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ** рдЖрдо рддреМрд░ рдкрд░ рдХрдо PIDS рдХреЗ рд╕рд╛рде рдЪрд▓рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЕрдЧрд░ рдЖрдк рдПрдХ рдмрдбрд╝реА PID рдХреЗ рд╕рд╛рде рдПрдХ рд░реВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрд╛рддреЗ рд╣реИрдВ рддреЛ рдЖрдк рд╕рдВрджреЗрд╣ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* `/etc/passwd` рдореЗрдВ рд╢реИрд▓реА рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА **рд░рдЬрд┐рд╕реНрдЯрд░реНрдб рд▓реЙрдЧрд┐рди** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
* `/etc/shadow` рдореЗрдВ **рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдЬрд┐рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдкрд╛рд╕ рдПрдХ рд╢реИрд▓ рдирд╣реАрдВ рд╣реИ

### рдореЗрдореЛрд░реА рдбрдВрдк

рдЪрд▓ рд░рд╣реЗ рд╕рд┐рд╕реНрдЯрдо рдХреА рдореЗрдореЛрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, [**LiME**](https://github.com/504ensicsLabs/LiME) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕реБрдЭрд╛рд╡рд┐рдд рд╣реИред\
рдЗрд╕реЗ **рдХрдВрдкрд╛рдЗрд▓** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкреАрдбреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬреЛ рдкреАрдбреАрдЖрдИ рдпрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИред

{% hint style="info" %}
рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рдЖрдк **LiME рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЪреАрдЬрд╝ рдХреЛ** рдкреАрдбреАрдЖрдИ рдпрдВрддреНрд░ рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХрдИ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░ рджреЗрдЧрд╛
{% endhint %}

рддреЛ, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдЕрднрд┐рдиреНрди рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдпреВрдмрдВрдЯреВ рд╣реИ рддреЛ рдЖрдк `apt-get install lime-forensics-dkms` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ\
рдЕрдиреНрдп рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЖрдкрдХреЛ [**LiME**](https://github.com/504ensicsLabs/LiME) рдХреЛ github рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рд╕рд╣реА рдХрд░реНрдиреЗрд▓ рд╣реЗрдбрд░реНрд╕ рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдХрдВрдкрд╛рдЗрд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдкреАрдбреАрдЖрдИ рдпрдВрддреНрд░ рдХреЗ рд╕рдЯреАрдХ рдХрд░реНрдиреЗрд▓ рд╣реЗрдбрд░реНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдмрд╕ рдЕрдкрдиреЗ рдпрдВрддреНрд░ рдореЗрдВ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ `/lib/modules/<рдХрд░реНрдиреЗрд▓ рд╕рдВрд╕реНрдХрд░рдг>` рдХреА **рдирдХрд▓** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ LiME рдХреЛ **рдХрдВрдкрд╛рдЗрд▓** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
make -C /lib/modules/<kernel version>/build M=$PWD
sudo insmod lime.ko "path=/home/sansforensics/Desktop/mem_dump.bin format=lime"
```
LiME рд╕рдорд░реНрдерд┐рдд рдХрд░рддрд╛ рд╣реИ 3 **рдлреЙрд░реНрдореЗрдЯ**:

* Raw (рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрдЧрдореЗрдВрдЯ рдХреЛ рдПрдХ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛)
* Padded (рд░реЙ рдХреЗ рд╕рдорд╛рди, рд▓реЗрдХрд┐рди рджрд╛рдПрдВ рдмрд┐рдЯреНрд╕ рдореЗрдВ рд╢реВрдиреНрдп рд╣реИрдВ)
* Lime (рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдЕрдиреБрд╢рдВрд╕рд┐рдд рдлреЙрд░реНрдореЗрдЯ)

LiME рдХрд╛ рдЙрдкрдпреЛрдЧ **рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбрдВрдк рднреЗрдЬрдиреЗ** рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЗрд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ: `path=tcp:4444`

### рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬрд┐рдВрдЧ

#### рдмрдВрдж рдХрд░рдирд╛

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ **рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдмрдВрдж рдХрд░рдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред рдпрд╣ рд╣рдореЗрд╢рд╛ рдПрдХ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рд╕рдордп рд╕рд┐рд╕реНрдЯрдо рдПрдХ рдЙрддреНрдкрд╛рджрди рд╕рд░реНрд╡рд░ рд╣реЛрдЧрд╛ рдЬрд┐рд╕реЗ рдХрдВрдкрдиреА рдХреЛ рдмрдВрдж рдХрд░рдиреЗ рдХреА рд╕рд╛рдорд░реНрдереНрдп рдирд╣реАрдВ рд╣реЛрдЧреАред\
рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдмрдВрдж рдХрд░рдиреЗ рдХреЗ **2 рддрд░реАрдХреЗ** рд╣реИрдВ, рдПрдХ **рд╕рд╛рдорд╛рдиреНрдп рдмрдВрдж рдХрд░рдирд╛** рдФрд░ рдПрдХ **"рдкреНрд▓рдЧ рдирд┐рдХрд╛рд▓рдирд╛" рдмрдВрдж рдХрд░рдирд╛**ред рдкрд╣рд▓рд╛ рд╡рд╛рд▓рд╛ **рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ** рдФрд░ **рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо** рдХреЛ **рд╕рдордХрд╛рд▓реАрди** рд╣реЛрдиреЗ рджреЗрдЧрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рднреА рд╕рдВрднрд╛рд╡рд┐рдд **рдореИрд▓рд╡реЗрдпрд░** рдХреЛ **рд╕рдмреВрдд рдирд╖реНрдЯ** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред "рдкреНрд▓рдЧ рдирд┐рдХрд╛рд▓рдирд╛" рджреГрд╖реНрдЯрд┐рдХреЛрдг **рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рд╣рд╛рдирд┐** рд▓реЗ рд╕рдХрддрд╛ рд╣реИ (рдЬреНрдпрд╛рджрд╛рддрд░ рдЬрд╛рдирдХрд╛рд░реА рдирд╖реНрдЯ рдирд╣реАрдВ рд╣реЛрдиреЗ рд╡рд╛рд▓реА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдореЗрдореЛрд░реА рдХрд╛ рдЫрд╡рд┐ рд▓реЗ рд▓реА рд╣реИ) рдФрд░ **рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рдХреБрдЫ рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рдореМрдХрд╛ рдирд╣реАрдВ** рд╣реЛрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╡рд╣рд╛рдБ рдХреЛрдИ **рдореИрд▓рд╡реЗрдпрд░** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рд╕рд┐рд╕реНрдЯрдо рдкрд░ **`sync`** **рдХрдорд╛рдВрдб** рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ рдФрд░ рдкреНрд▓рдЧ рдирд┐рдХрд╛рд▓реЗрдВред

#### рдбрд┐рд╕реНрдХ рдХреА рдЫрд╡рд┐ рд▓реЗрдирд╛

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ **рдорд╛рдорд▓реЗ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреЛ рдЕрдкрдиреЗ рдХрдВрдкреНрдпреВрдЯрд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ**, рдЖрдкрдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдпрд╣ **рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдЙрдВрдЯ** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рддрд╛рдХрд┐ рдХреЛрдИ рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рди рдХрд░реЗрдВред
```bash
#Create a raw copy of the disk
dd if=<subject device> of=<image file> bs=512

#Raw copy with hashes along the way (more secure as it checks hashes while it's copying the data)
dcfldd if=<subject device> of=<image file> bs=512 hash=<algorithm> hashwindow=<chunk size> hashlog=<hash file>
dcfldd if=/dev/sdc of=/media/usb/pc.image hash=sha256 hashwindow=1M hashlog=/media/usb/pc.hashes
```
### рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬ рдкреВрд░реНрд╡ рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рдХреЛрдИ рдЕрдзрд┐рдХ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬрд┐рдВрдЧред
```bash
#Find out if it's a disk image using "file" command
file disk.img
disk.img: Linux rev 1.0 ext4 filesystem data, UUID=59e7a736-9c90-4fab-ae35-1d6a28e5de27 (extents) (64bit) (large files) (huge files)

#Check which type of disk image it's
img_stat -t evidence.img
raw
#You can list supported types with
img_stat -i list
Supported image format types:
raw (Single or split raw file (dd))
aff (Advanced Forensic Format)
afd (AFF Multiple File)
afm (AFF with external metadata)
afflib (All AFFLIB image formats (including beta ones))
ewf (Expert Witness Format (EnCase))

#Data of the image
fsstat -i raw -f ext4 disk.img
FILE SYSTEM INFORMATION
--------------------------------------------
File System Type: Ext4
Volume Name:
Volume ID: 162850f203fd75afab4f1e4736a7e776

Last Written at: 2020-02-06 06:22:48 (UTC)
Last Checked at: 2020-02-06 06:15:09 (UTC)

Last Mounted at: 2020-02-06 06:15:18 (UTC)
Unmounted properly
Last mounted on: /mnt/disk0

Source OS: Linux
[...]

#ls inside the image
fls -i raw -f ext4 disk.img
d/d 11: lost+found
d/d 12: Documents
d/d 8193:       folder1
d/d 8194:       folder2
V/V 65537:      $OrphanFiles

#ls inside folder
fls -i raw -f ext4 disk.img 12
r/r 16: secret.txt

#cat file inside image
icat -i raw -f ext4 disk.img 16
ThisisTheMasterSecret
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ **рдСрдЯреЛрдореЗрдЯ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдмрдирд╛рдПрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рдЬреНрдЮрд╛рдд рдореИрд▓рд╡реЗрдпрд░ рдХреА рдЦреЛрдЬ

### рд╕рдВрд╢реЛрдзрд┐рдд рд╕рд┐рд╕реНрдЯрдо рдлрд╝рд╛рдЗрд▓реЗрдВ

рдХреБрдЫ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдореЗрдВ рдмрд╣реБрдд рд╕рд╛рд░реЗ рд╕реНрдерд╛рдкрд┐рдд рдШрдЯрдХреЛрдВ рдХреА рдЕрдЦрдВрдбрддрд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реЛрддреА рд╣реИ, рдЬреЛ рдЕрд╕рд╛рдорд╛рдиреНрдп рдпрд╛ рдЕрдиреБрдЪрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рднрд╛рд╡реА рддрд░реАрдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд▓рд┐рдирдХреНрд╕ рдкрд░ `rpm -Va` рдХрд╛ рдЙрдкрдпреЛрдЧ рд░реЗрдбрд╣реИрдЯ рдкреИрдХреЗрдЬ рдкреНрд░рдмрдВрдзрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрдерд╛рдкрд┐рдд рд╕рднреА рдкреИрдХреЗрдЬ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
```bash
#RedHat
rpm -Va
#Debian
dpkg --verify
debsums | grep -v "OK$" #apt-get install debsums
```
### рдореИрд▓рд╡реЗрдпрд░/рд░реВрдЯрдХрд┐рдЯ рдбрд┐рдЯреЗрдХреНрдЯрд░реНрд╕

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ рддрд╛рдХрд┐ рдЖрдк рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдЯреВрд▓реНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рди рд╕рдХреЗрдВ:

{% content-ref url="malware-analysis.md" %}
[malware-analysis.md](malware-analysis.md)
{% endcontent-ref %}

## рд╕реНрдерд╛рдкрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреА рдЦреЛрдЬ

### рдкреИрдХреЗрдЬ рдкреНрд░рдмрдВрдзрдХ

рдбреЗрдмрд┐рдпрди-рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдореЛрдВ рдкрд░, _**/var/ lib/dpkg/status**_ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдкреИрдХреЗрдЬ рдХреЗ рд╡рд┐рд╡рд░рдг рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ _**/var/log/dpkg.log**_ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рд┐рдХреЙрд░реНрдб рд╣реЛрддреА рд╣реИ рдЬрдм рдПрдХ рдкреИрдХреЗрдЬ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддрд╛ рд╣реИред\
рд░реЗрдбрд╣реИрдЯ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рд▓рд┐рдирдХреНрд╕ рд╡рд┐рддрд░рдгреЛрдВ рдкрд░ **`rpm -qa --root=/ mntpath/var/lib/rpm`** рдХрдорд╛рдВрдб рдПрдХ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдПрдХ рдЖрд░рдкреАрдПрдо рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреА рд╕реВрдЪреА рджреЗрдЧреАред
```bash
#Debian
cat /var/lib/dpkg/status | grep -E "Package:|Status:"
cat /var/log/dpkg.log | grep installed
#RedHat
rpm -qa --root=/ mntpath/var/lib/rpm
```
### рдЕрдиреНрдп

**рдЙрдкрд░реНрдпреБрдХреНрдд рдХрдорд╛рдВрдбреНрд╕ рджреНрд╡рд╛рд░рд╛ рд╕рднреА рд╕реНрдерд╛рдкрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреА рд╕реВрдЪреА рдирд╣реАрдВ рд╣реЛрдЧреА** рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреБрдЫ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рд▓рд┐рдП рдкреИрдХреЗрдЬ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рд╕реНрд░реЛрдд рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рдкрдбрд╝рддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, _**/usr/local**_ рдФрд░ _**/opt**_ рдЬреИрд╕реА рд╕реНрдерд╛рдиреЛрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддреА рд╣реИ рдЬреЛ рд╕реНрд░реЛрдд рдХреЛрдб рд╕реЗ рд╕рдВрдХрд▓рд┐рдд рдФрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдП рдЧрдП рд╣реЛрдВред
```bash
ls /opt /usr/local
```
рдПрдХ рдФрд░ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдЪрд╛рд░ рд╣реИ **$PATH** рдХреЗ рдЕрдВрджрд░ **рд╕рд╛рдорд╛рдиреНрдп рдлреЛрд▓реНрдбрд░** рдХреА **рдЬрд╛рдБрдЪ рдХрд░рдирд╛** рдЬреЛ **рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП рдкреИрдХреЗрдЬ** рд╕реЗ **рд╕рдВрдмрдВрдзрд┐рдд рдирд╣реАрдВ** рд╣реИрдВ:
```bash
#Both lines are going to print the executables in /sbin non related to installed packages
#Debian
find /sbin/ -exec dpkg -S {} \; | grep "no path found"
#RedHat
find /sbin/ тАУexec rpm -qf {} \; | grep "is not"
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрд╕рд╛рдиреА рд╕реЗ **рдСрдЯреЛрдореЗрдЯ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдмрдирд╛рдПрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рд╣рдЯрд╛рдП рдЧрдП рдЪрд▓ рд░рд╣реЗ рдмрд╛рдЗрдирд░реА рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

![](<../../.gitbook/assets/image (641).png>)

## рдСрдЯреЛрд╕реНрдЯрд╛рд░реНрдЯ рд╕реНрдерд╛рдиреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

### рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдпрд╛рдПрдБ
```bash
cat /var/spool/cron/crontabs/*  \
/var/spool/cron/atjobs \
/var/spool/anacron \
/etc/cron* \
/etc/at* \
/etc/anacrontab \
/etc/incron.d/* \
/var/spool/incron/* \

#MacOS
ls -l /usr/lib/cron/tabs/ /Library/LaunchAgents/ /Library/LaunchDaemons/ ~/Library/LaunchAgents/
```
### рд╕реЗрд╡рд╛рдПрдВ

рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдП, рдЕрдирдзрд┐рдХреГрдд рд╕реЗрд╡рд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдкрдиреЗ рдЖрдк рдХреЛ рдЕрдВрдХреБрд░рд┐рдд рдХрд░рдирд╛ рдмрд╣реБрдд рд╕рд╛рдорд╛рдиреНрдп рд╣реИред рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рдХрдИ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реИрдВ рдЬреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдмреВрдЯ рд╣реЛрддреЗ рд╕рдордп рд╕реЗрд╡рд╛рдПрдВ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдкреНрд░рд╛рд░рдВрднреА рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ _**/etc/inittab**_ рдЕрдиреНрдп рд╕реНрдХреНрд░рд┐рдкреНрдЯреЛрдВ рдХреЛ рдмреБрд▓рд╛рддрд╛ рд╣реИ рдЬреИрд╕реЗ rc.sysinit рдФрд░ _**/etc/rc.d/**_ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рддрд╣рдд рд╡рд┐рднрд┐рдиреНрди рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ, рдпрд╛ рдХреБрдЫ рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ _**/etc/rc.boot/**_ред рдЕрдиреНрдп рд▓рд┐рдирдХреНрд╕ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдкрд░, рдЬреИрд╕реЗ рдбреЗрдмрд┐рдпрди, рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ _**/etc/init.d/**_ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВред рд╕рд╛рде рд╣реА, рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп рд╕реЗрд╡рд╛рдПрдВ _**/etc/inetd.conf**_ рдпрд╛ _**/etc/xinetd/**_ рдореЗрдВ рд╕рдХреНрд╖рдо рдХреА рдЬрд╛рддреА рд╣реИрдВ рд▓рд┐рдирдХреНрд╕ рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░ред рдбрд┐рдЬрд┐рдЯрд▓ рдЬрд╛рдВрдЪрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЗрди рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рд╣рд░ рдЕрдиреВрдареА рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред

* _**/etc/inittab**_
* _**/etc/rc.d/**_
* _**/etc/rc.boot/**_
* _**/etc/init.d/**_
* _**/etc/inetd.conf**_
* _**/etc/xinetd/**_
* _**/etc/systemd/system**_
* _**/etc/systemd/system/multi-user.target.wants/**_

### рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓

рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдкрд░, рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓ рдореИрд▓рд╡реЗрдпрд░ рдкреИрдХреЗрдЬ рдХреЗ рд▓рд┐рдП рд░реВрдЯрдХрд┐рдЯ рдШрдЯрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдорддреМрд░ рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓ рд╕рд┐рд╕реНрдЯрдо рдмреВрдЯ рд╣реЛрдиреЗ рдкрд░ `/lib/modules/'uname -r'` рдФрд░ `/etc/modprobe.d` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реВрдЪрдирд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд▓реЛрдб рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ `/etc/modprobe` рдпрд╛ `/etc/modprobe.conf` рдлрд╝рд╛рдЗрд▓ред рдЗрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдЬреЛ рдореИрд▓рд╡реЗрдпрд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВред

### рдЕрдиреНрдп рдСрдЯреЛрд╕реНрдЯрд╛рд░реНрдЯ рд╕реНрдерд╛рди

рд▓рд┐рдирдХреНрд╕ рдХрдИ рд╡рд┐рдиреНрдпрд╛рд╕ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдПрдХ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рдкрд░ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬреЛ рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рдЕрдиреБрдХрд░рдг рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддреА рд╣реИрдВред

* _**/etc/profile.d/\***_ , _**/etc/profile**_ , _**/etc/bash.bashrc**_ рдЬрдм рдХреЛрдИ рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддрд╛ рд▓реЙрдЧ рдЗрди рдХрд░рддрд╛ рд╣реИ рддреЛ рдЗрдиреНрд╣реЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* _**тИ╝/.bashrc**_ , _**тИ╝/.bash\_profile**_ , _**\~/.profile**_ , _**тИ╝/.config/autostart**_ рдЬрдм рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧ рдЗрди рдХрд░рддрд╛ рд╣реИ рддреЛ рдЗрдиреНрд╣реЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* _**/etc/rc.local**_ рдЗрд╕реЗ рдкрд╛рд░рдВрдкрд░рд┐рдХ рд░реВрдк рд╕реЗ рдЙрди рд╕рднреА рд╕рд╛рдзрд╛рд░рдг рд╕рд┐рд╕реНрдЯрдо рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдмрд╛рдж рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдкреНрд░реЛрд╕реЗрд╕ рдХреЗ рдЕрдВрдд рдореЗрдВ рдПрдХ рдорд▓реНрдЯреАрдпреВрдЬрд░ рд░рдирд▓реЗрд╡рд▓ рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдмрд╛рджред

## рд▓реЙрдЧ рдХреА рдЬрд╛рдВрдЪ

рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЙрдкрд▓рдмреНрдз рд╕рднреА рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдирд┐рд╖реНрдкрд╛рджрди рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдВ рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рдирдИ рд╕реЗрд╡рд╛ рдХрд╛ рдирд┐рд░реНрдорд╛рдгред

### рд╢реБрджреНрдз рд▓реЙрдЧ

рд╕рд┐рд╕реНрдЯрдо рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рд▓реЙрдЧ рдореЗрдВ рджрд░реНрдЬ рдХрд┐рдП рдЧрдП **рд▓реЙрдЧрд┐рди** рдШрдЯрдирд╛рдПрдВ, рдЬрд┐рд╕рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реЙрдЧрд┐рди, рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдордп рдкрд░ рдХрд┐рд╕реА рдЦрд╛рддреЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдореИрд▓рд╡реЗрдпрд░** рдпрд╛ рдПрдХ **рдЕрддрд┐рдХреНрд░рдордгрдХрд╛рд░реА рдиреЗ рдкрд╣реБрдВрдЪ** рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдПрдХ рдореИрд▓рд╡реЗрдпрд░ рд╕рдВрдХреНрд░рдордг рдХреЗ рд╕рдордп рдХреЗ рдЖрд╕рдкрд╛рд╕ рдЕрдиреНрдп рдШрдЯрдирд╛рдПрдВ рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧ рдореЗрдВ рдХреИрдкреНрдЪрд░ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ **рдирдИ** **рд╕реЗрд╡рд╛** рдХрд╛ **рдирд┐рд░реНрдорд╛рдг** рдпрд╛ рдШрдЯрдирд╛ рдХреЗ рд╕рдордп рдирдП рдЦрд╛рддреЛрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдгред\
рд░реЛрдЪрдХ рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧрд┐рди:

* **/var/log/syslog** (debian) рдпрд╛ **/var/log/messages** (Redhat)
* рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрджреЗрд╢ рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рджрд┐рдЦрд╛рддрд╛ рд╣реИред рдпрд╣ рд╡реИрд╢реНрд╡рд┐рдХ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЧрдП рд╕рднреА рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдбреЗрдЯрд╛ рд▓реЙрдЧ рд╣реИред
* **/var/log/auth.log** (debian) рдпрд╛ **/var/log/secure** (Redhat)
* рд╕рдлрд▓ рдпрд╛ рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рди, рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд▓реЙрдЧ рд░рдЦрддрд╛ рд╣реИред рд╕рдВрдЧреНрд░рд╣рдг рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рдХрд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред
* `cat /var/log/auth.log | grep -iE "session opened for|accepted password|new session|not in sudoers"`
* **/var/log/boot.log**: рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕рдВрджреЗрд╢ рдФрд░ рдмреВрдЯ рдЬрд╛рдирдХрд╛рд░реАред
* **/var/log/maillog** рдпрд╛ **var/log/mail.log:** рдореЗрд▓ рд╕рд░реНрд╡рд░ рд▓реЙрдЧ рдХреЗ рд▓рд┐рдП рд╣реИ, рдкреЛрд╕реНрдЯрдлрд┐рдХреНрд╕, smtpd, рдпрд╛ рдЖрдкрдХреЗ рд╕рд░реНрд╡рд░ рдкрд░ рдЪрд▓ рд░рд╣реА рдИрдореЗрд▓ рд╕рдВрдмрдВрдзрд┐рдд рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИред
* **/var/log/kern.log**: рдХрд░реНрдиреЗрд▓ рд▓реЙрдЧ рдФрд░ рдЪреЗрддрд╛рд╡рдиреА рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддрд╛ рд╣реИред рдХрд░реНрдиреЗрд▓ рдЧрддрд┐рд╡рд┐рдзрд┐ рд▓реЙрдЧ (рдЬреИрд╕реЗ, dmesg, kern.log, klog) рджрд┐рдЦрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рд╕реЗрд╡рд╛ рдХрд╛ рдмрд╛рд░-рдмрд╛рд░ рдХреНрд░реИрд╢ рд╣реЛ рд░рд╣рд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рдВрдХреЗрдд рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдПрдХ рдЕрд╕реНрдерд┐рд░ рдЯреНрд░реЛрдЬрдирд╛рдЗрдЬрд╝ рд╡рд░реНрдЬрди рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
* **/var/log/dmesg**: рдбрд┐рд╡рд╛рдЗрд╕ рдбреНрд░рд╛рдЗрд╡рд░ рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рднрдВрдбрд╛рд░рдг рд╕реНрдерд╛рдиред рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рдВрджреЗрд╢ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП **dmesg** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **/var/log/faillog:** рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рд▓реЙрдЧрд┐рди рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рд╣реИрдХреНрд╕ рдФрд░ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рд╣рдорд▓реЛрдВ рдЬреИрд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдЙрд▓реНрд▓рдВрдШрдиреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред
* **/var/log/cron**: Crond рд╕рдВрдмрдВрдзрд┐рдд рд╕рдВрджреЗрд╢реЛрдВ (рдХреНрд░реЙрди рдЬреЙрдмреНрд╕) рдХрд╛ рд░рд┐рдХреЙрд░реНрдб рд░рдЦрддрд╛ рд╣реИред рдЬреИрд╕реЗ рдЬрдм рдХреНрд░реЙрди рдбреЗрдорди рдиреЗ рдПрдХ рдиреМрдХрд░реА рд╢реБрд░реВ рдХреАред
* **/var/log/daemon.log:** рдЪрд▓ рд░рд╣реЗ рдкреГрд╖реНрда рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЯреНрд░реИрдХ рд░рдЦрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдЙрдиреНрд╣реЗрдВ рдЧреНрд░рд╛рдлрд┐рдХрд▓ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред
* **/var/log/btmp**: рд╕рднреА рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рди рдкреНрд░рдпрд╛рд╕реЛрдВ рдХрд╛ рдПрдХ рдиреЛрдЯ рд░рдЦрддрд╛ рд╣реИред
* **/var/log/httpd/**: Apache httpd рдбреЗрдорди рдХреЗ error\_log рдФрд░ access\_log рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд░рдЦрдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред httpd рдХреЛрдИ рднреА рддреНрд░реБрдЯрд┐ рдЬреЛ рдЖрддреА рд╣реИ, рдЙрд╕реЗ **error\_log** рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреА рддрд░рд╣ред **access\_log** HTTP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рд▓реЙрдЧ рд░рдЦрддрд╛ рд╣реИред
* **/var/log/mysqld.log** рдпрд╛ **/var/log/mysql.log**: MySQL рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдЬреЛ рд╣рд░ debug, рд╡рд┐рдлрд▓рддрд╛ рдФрд░ рд╕рдлрд▓рддрд╛ рд╕рдВрджреЗрд╢ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ MySQL рдбреЗрдорди mysqld рдХреА рд╢реБрд░реБрдЖрдд, рдмрдВрдж рдХрд░рдирд╛ рдФрд░ рдкреБрдирд░рд╛рд░рдВрдн рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рд╕рд┐рд╕реНрдЯрдо рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред RedHat, CentOS, Fedora, рдФрд░ рдЕрдиреНрдп RedHat-рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдо /var/log/mariadb/mariadb.log рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, Debian/Ubuntu /var/log/mysql/error.log рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред
* **/var/log/xferlog**: FTP рдлрд╝рд╛рдЗрд▓ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рд╕рддреНрд░реЛрдВ рдХреЛ рд░рдЦрддрд╛ рд╣реИред рдлрд╝рд╛рдЗрд▓ рдирд╛рдореЛрдВ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░реЗрд░рд┐рдд FTP рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдЬреИрд╕реА рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рд╣реИред
* **/var/log/\*** : рдЗрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд▓реЙрдЧ рдХреЗ рд▓рд┐рдП рд╣рдореЗрд╢рд╛ рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП

{% hint style="info"
```
pip3 install usbrip
usbrip ids download #Download USB ID database
```
### рдЙрджрд╛рд╣рд░рдг
```
usbrip events history #Get USB history of your curent linux machine
usbrip events history --pid 0002 --vid 0e0f --user kali #Search by pid OR vid OR user
#Search for vid and/or pid
usbrip ids download #Downlaod database
usbrip ids search --pid 0002 --vid 0e0f #Search for pid AND vid
```
рдЕрдзрд┐рдХ рдЙрджрд╛рд╣рд░рдг рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рдЧрд┐рдЯрд╣рдм рдореЗрдВ: [https://github.com/snovvcrash/usbrip](https://github.com/snovvcrash/usbrip)

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ **рдСрдЯреЛрдореЗрдЯ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪреЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдФрд░ рд▓реЙрдЧрдСрди рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛

рдЕрдиреВрдареЗ рдирд╛рдореЛрдВ рдпрд╛ рдЦрд╛рддреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдЬреЛ рдЕрдиреБрдорддрд┐рдд рдШрдЯрдирд╛рдУрдВ рдХреЗ рдирд┐рдХрдЯ рдмрдирд╛рдП рдЧрдП рдпрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╣реЛрдВред\
рдЕрд╕рд╛рдорд╛рдиреНрдп рдирд╛рдореЛрдВ рдпрд╛ рдЦрд╛рддреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдЬреЛ рдЕрдиреБрдорддрд┐рдд рдШрдЯрдирд╛рдУрдВ рдХреЗ рдирд┐рдХрдЯ рдмрдирд╛рдП рдЧрдП рдпрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╣реЛрдВред\
рд╕реБрджреВрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рджреА рдЧрдИ рд╣реЛрдВред\
рдХрд┐рд╕реА рднреА рдЦрд╛рддреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ рдЬрд┐рдирдореЗрдВ **рдХреЛрдИ рдкрд╛рд╕рд╡рд░реНрдб рдирд╣реАрдВ** рд╣реИ рдпрд╛ **рдЖрд╕рд╛рдиреА рд╕реЗ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓рд╛ рдкрд╛рд╕рд╡рд░реНрдб** рд╣реИред

## рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреА рдЬрд╛рдВрдЪ

рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдПрдБ рдПрдХ **рдореИрд▓рд╡реЗрдпрд░** рдШрдЯрдирд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдмрд╣реБрдд рд╕рд╛рд░реА **рдЬрд╛рдирдХрд╛рд░реА** рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИрдВ, рдЬреИрд╕реЗ **рдШрдЯрдирд╛рдУрдВ рдХрд╛ рд╕рдордп** рдФрд░ **рдореИрд▓рд╡реЗрдпрд░** рдХреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ **рд╕рд╛рдордЧреНрд░реА**ред\
**рдореИрд▓рд╡реЗрдпрд░** рдХреЛ **рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг** рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдврд╝рд╛рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдХреБрдЫ рдореИрд▓рд╡реЗрдпрд░ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдлрд╝рд╛рдЗрд▓реЛрдВ рдкрд░ рджрд┐рдирд╛рдВрдХ-рд╕рдордп рдЫрд╛рдкреЛрдВ рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЙрдиреНрд╣реЗрдВ рдЯрд╛рдЗрдорд▓рд╛рдЗрди рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд╕рд╛рде рдЦреЛрдЬрдирд╛ рдХрдард┐рди рд╣реЛред рдЕрдиреНрдп рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдХреЛрдб рдбреЗрдЯрд╛ рдХреЛ рдХреЗрд╡рд▓ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВред\
рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдПрдВрдЯреА-рдлреЛрд░реЗрдВрд╕рд┐рдХ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рджрд┐рдирд╛рдВрдХ-рд╕рдордп рдЫрд╛рдкреЛрдВ рдХреЗ рдЯрд╛рдЗрдорд▓рд╛рдЗрди рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

* **рдСрдЯреЙрдкреНрд╕реА** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рд╕рдВрджреЗрд╣рд╛рд╕реНрдкрдж рдЧрддрд┐рд╡рд┐рдзрд┐ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдЯрд╛рдЗрдорд▓рд╛рдЗрди рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк **Sleuth Kit** рд╕реЗ `mactime` рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рд╕реАрдзрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **$PATH** рдореЗрдВ **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ (рд╢рд╛рдпрдж рдХреБрдЫ sh рдпрд╛ php рд╕реНрдХреНрд░рд┐рдкреНрдЯ?)
* `/dev` рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╡рд┐рд╢реЗрд╖ рдлрд╝рд╛рдЗрд▓реЗрдВ рдереАрдВ, рдЖрдк рдпрд╣рд╛рдБ рдореИрд▓рд╡реЗрдпрд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЧреИрд░-рд╡рд┐рд╢реЗрд╖ рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред
* рдЕрд╕рд╛рдорд╛рдиреНрдп рдпрд╛ **рдЫрд┐рдкреА рд╣реБрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ** рдФрд░ **рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдБ** рдЦреЛрдЬреЗрдВ, рдЬреИрд╕реЗ тАЬ.. тАЭ (рдбреЙрдЯ рдбреЙрдЯ рд╕реНрдкреЗрд╕) рдпрд╛ тАЬ..^G тАЭ (рдбреЙрдЯ рдбреЙрдЯ рдХрдВрдЯреНрд░реЛрд▓-рдЬреА)
* рд╕рд┐рд╕реНрдЯрдо рдкрд░ /bin/bash рдХреА setuid рдкреНрд░рддрд┐рдпрд╛рдВ `find / -user root -perm -04000 тАУprint`
* рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╣рдЯрд╛рдП рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдЯрд╛рдП рдЧрдП **рдЗрдиреЛрдб рдХреА рджрд┐рдирд╛рдВрдХ-рд╕рдордп рдЫрд╛рдкреЛрдВ** рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ, рдЬреЛ рдПрдХ рд╣реА рд╕рдордп рдкрд░ рд╣реЛрдиреЗ рд╡рд╛рд▓реА рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдЧрддрд┐рд╡рд┐рдзрд┐ рдЬреИрд╕реЗ рд░реВрдЯрдХрд┐рдЯ рдпрд╛ рдЯреНрд░реЛрдЬрдирд╛рдЗрдЬрд╝ рд╕реЗрд╡рд╛ рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддреА рд╣реИред
* рдХреНрдпреЛрдВрдХрд┐ рдЗрдиреЛрдб рдЕрдЧрд▓реА рдЙрдкрд▓рдмреНрдзрддрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, **рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдбрд╛рд▓реА рдЧрдИ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдлрд╝рд╛рдЗрд▓реЗрдВ рд▓рдЧрднрдЧ рдПрдХ рд╣реА рд╕рдордп рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ**ред рдЗрд╕рд▓рд┐рдП, рдЬрдм рдореИрд▓рд╡реЗрдпрд░ рдХрд╛ рдПрдХ рдШрдЯрдХ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдкрдбрд╝реЛрд╕реА рдЗрдиреЛрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
* рдирдП рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА **рд╕рдВрд╢реЛрдзрд┐рдд рдФрд░ рдпрд╛ рдмрджрд▓реА рдЧрдИ рд╕рдордп** рдХреА рджрд┐рдирд╛рдВрдХ-рд╕рдордп рдЫрд╛рдкреЛрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ рдЬреИрд╕реЗ _/bin_ рдпрд╛ _/sbin_ рдЬреИрд╕реЗ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреАред
* рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдФрд░ рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рджреЗрдЦрдирд╛ **рдирд┐рд░реНрдорд╛рдг рддрд┐рдерд┐** рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд░реНрдгрд┐рдд рд╣реЛрддрд╛ рд╣реИ рдмрдЬрд╛рдп рд╡рд░реНрдгрд╛рдиреБрдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рджреЗрдЦрдирд╛ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реА рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░ рдЕрдзрд┐рдХ рд╣рд╛рд▓ рдХреА рд╣реИрдВ (рдЕрдВрддрд┐рдо рд╡рд╛рд▓реЗ рд╕рд╛рдорд╛рдиреНрдпрддрдГ)ред

рдЖрдк `ls -laR --sort=time /bin` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдХреА рд╕рдмрд╕реЗ рд╣рд╛рд▓ рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред\
рдЖрдк `ls -lai /bin |sort -n` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдЗрдиреЛрдб рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** **рдлрд╝рд╛рдЗрд▓реЗрдВ рджрд┐рдЦрд╛рдиреЗ** рдХреЗ рд▓рд┐рдП **рд╕рдордп** рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд╣ **рдЗрдиреЛрдб** рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд** рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ред рдпрджрд┐ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдПрдХ **рдлрд╝рд╛рдЗрд▓** рдХрд╛ **рдЗрдиреЛрдб рд╕рдордп** рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдЙрд╕рдХрд╛ **рдЗрдиреЛрдб рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд░реВрдк рд╕реЗ рдмрдбрд╝рд╛** рд╣реИ, рддреЛ рдЙрд╕ **рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдП рдЧрдП** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
{% endhint %}

## рд╡рд┐рднрд┐рдиреНрди рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ

#### рдЬреЛрдбрд╝реА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ
```bash
git diff --no-index --diff-filter=A _openwrt1.extracted/squashfs-root/ _openwrt2.extracted/squashfs-root/
```
#### рд╕рдВрд╢реЛрдзрд┐рдд рд╕рд╛рдордЧреНрд░реА рдЦреЛрдЬреЗрдВ
```bash
git diff --no-index --diff-filter=M _openwrt1.extracted/squashfs-root/ _openwrt2.extracted/squashfs-root/ | grep -E "^\+" | grep -v "Installed-Time"
```
#### рд╣рдЯрд╛рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреЛрдЬреЗрдВ
```bash
git diff --no-index --diff-filter=A _openwrt1.extracted/squashfs-root/ _openwrt2.extracted/squashfs-root/
```
#### рдЕрдиреНрдп рдлрд╝рд┐рд▓реНрдЯрд░

**`-diff-filter=[(A|C|D|M|R|T|U|X|B)тАжтАЛ[*]]`**

рдХреЗрд╡рд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЪреБрдиреЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ (`A`), рдХреЙрдкреА рдХрд┐рдпрд╛ рдЧрдпрд╛ (`C`), рд╣рдЯрд╛рдпрд╛ рдЧрдпрд╛ (`D`), рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ (`M`), рдирд╛рдо рдмрджрд▓рд╛ рдЧрдпрд╛ (`R`), рдФрд░ рдЙрдирдХреЗ рдкреНрд░рдХрд╛рд░ (рдЬреИрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рдлрд╝рд╛рдЗрд▓, рд╕рд┐рдВрдХрд▓рд┐рдВрдХ, рд╕рдмрдореЙрдбреНрдпреВрд▓, тАжтАЛ) рдмрджрд▓ рдЧрдпрд╛ (`T`), рдЕрдорд░реНрдЬрд┐рдд (`U`), рдЕрдЬреНрдЮрд╛рдд (`X`), рдпрд╛ рдЙрдирдХреЗ рд╕рдВрдпреЛрдЬрди рдЯреВрдЯ рдЧрдпрд╛ (`B`). рдлрд╝рд┐рд▓реНрдЯрд░ рд╡рд░реНрдгреЛрдВ рдХрд╛ рдХреЛрдИ рднреА рд╕рдВрдпреЛрдЬрди (рд╕рд╣рд┐рдд рдХрд┐рд╕реА рднреА рдирд╣реАрдВ) рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ. рдЬрдм `*` (рд╕рднреА рдпрд╛ рдХреЛрдИ рдирд╣реАрдВ) рд╕рдВрдпреЛрдЬрди рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рддреБрд▓рдирд╛ рдореЗрдВ рдХрд┐рд╕реА рдЕрдиреНрдп рдорд╛рдирджрдВрдб рдХреЛ рдорд┐рд▓рдиреЗ рдкрд░ рд╕рднреА рдкрде рдЪрдпрдирд┐рдд рд╣реЛрддреЗ рд╣реИрдВ; рдЕрдЧрд░ рдХреЛрдИ рдРрд╕реА рдлрд╝рд╛рдЗрд▓ рдирд╣реАрдВ рд╣реИ рдЬреЛ рдЕрдиреНрдп рдорд╛рдирджрдВрдб рдХреЛ рдорд┐рд▓рддреА рд╣реИ, рддреЛ рдХреБрдЫ рднреА рдЪрдпрдирд┐рдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **рдпреЗ рдКрдкрд░реА рдорд╛рдорд▓реЗ рдЫреЛрдЯреЗ рдЕрдХреНрд╖рд░ рдореЗрдВ рдмрджрд▓реЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `--diff-filter=ad` рдЬреЛрдбрд╝реЗ рдФрд░ рд╣рдЯрд╛рдП рдЧрдП рдкрдереЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕рднреА рд╡рд┐рднреЗрджреЛрдВ рдореЗрдВ рд╕рднреА рдкреНрд░рдХрд╛рд░ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕реВрдЪреА рд╕реЗ рдХрд╛рдо рдХреЗ рдкреЗрдбрд╝ рд╕реЗ рд╡рд░реНрдХрд┐рдВрдЧ рдЯреНрд░реА рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╡рд┐рднреЗрдж рдХрднреА рднреА рдЬреЛрдбрд╝реЗ рдЧрдП рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЛ рдирд╣реАрдВ рд░рдЦ рд╕рдХрддреЗ (рдХреНрдпреЛрдВрдХрд┐ рд╡рд┐рднреЗрдж рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдкрдереЛрдВ рдХрд╛ рд╕реЗрдЯ рд╕реВрдЪреА рдореЗрдВ рдХреНрдпрд╛ рд╣реИ рдЙрд╕рд╕реЗ рд╕реАрдорд┐рдд рд╣реЛрддрд╛ рд╣реИ)ред рдЙрд╕реА рддрд░рд╣, рдХреЙрдкреА рдФрд░ рдирд╛рдо рдмрджрд▓реЗ рдЧрдП рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдЙрд╕ рд╕рдордп рдкреНрд░рдХрдЯ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреАрдВ рдЬрдм рдЙрди рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП рдкрд╣рдЪрд╛рди рдЕрдХреНрд╖рдо рд╣реЛред

## рд╕рдВрджрд░реНрдн

* [https://cdn.ttgtmedia.com/rms/security/Malware%20Forensics%20Field%20Guide%20for%20Linux%20Systems\_Ch3.pdf](https://cdn.ttgtmedia.com/rms/security/Malware%20Forensics%20Field%20Guide%20for%20Linux%20Systems\_Ch3.pdf)
* [https://www.plesk.com/blog/featured/linux-logs-explained/](https://www.plesk.com/blog/featured/linux-logs-explained/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

* рдЕрдкрдиреЗ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди рдХреА
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**

**рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ**ред

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд░реНрд▓реНрдб рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд** рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдмрдирд╛рдПрдВ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪреЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
