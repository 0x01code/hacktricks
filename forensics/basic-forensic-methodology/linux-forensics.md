# рд▓рд┐рдирдХреНрд╕ рдлреЛрд░реЗрдВрд╕рд┐рдХреНрд╕

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд░реНрдХрдлреНрд▓реЛрдЬрд╝ рдХреЛ рдСрдЯреЛрдореЗрдЯ** рдХрд░реЗрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЯреВрд▓реНрд╕ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдкрд░ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**ред
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛрдЬрд╝ рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реВрдЪрдирд╛ рд╕рдВрдЧреНрд░рд╣рдг

### рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдпрд╣ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреБрдЫ **USB** рд╣реЛ рдЬрд┐рд╕рдореЗрдВ **рдЕрдЪреНрдЫреЗ рдЬреНрдЮрд╛рдд рдмрд╛рдЗрдирд░реАрдЬрд╝ рдФрд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬрд╝ рд╣реЛрдВ** (рдЖрдк рдмрд╕ рдЙрдмрдВрдЯреВ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлреЛрд▓реНрдбрд░реНрд╕ _/bin_, _/sbin_, _/lib,_ рдФрд░ _/lib64_ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ), рдлрд┐рд░ USB рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░реЗрдВ, рдФрд░ рдЙрди рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рд╡рд░рдг рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░реЗрдВ:
```bash
export PATH=/mnt/usb/bin:/mnt/usb/sbin
export LD_LIBRARY_PATH=/mnt/usb/lib:/mnt/usb/lib64
```
рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдкрдиреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЕрдЪреНрдЫреЗ рдФрд░ рдЬреНрдЮрд╛рдд рдмрд╛рдЗрдирд░реАрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ, рддреЛ рдЖрдк **рдХреБрдЫ рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдирд╛** рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
date #Date and time (Clock may be skewed, Might be at a different timezone)
uname -a #OS info
ifconfig -a || ip a #Network interfaces (promiscuous mode?)
ps -ef #Running processes
netstat -anp #Proccess and ports
lsof -V #Open files
netstat -rn; route #Routing table
df; mount #Free space and mounted devices
free #Meam and swap space
w #Who is connected
last -Faiwx #Logins
lsmod #What is loaded
cat /etc/passwd #Unexpected data?
cat /etc/shadow #Unexpected data?
find /directory -type f -mtime -1 -print #Find modified files during the last minute in the directory
```
#### рд╕рдВрджрд┐рдЧреНрдз рдЬрд╛рдирдХрд╛рд░реА

рдмреБрдирд┐рдпрд╛рджреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╕рдордп рдЖрдкрдХреЛ рдЕрдЬреАрдм рдЪреАрдЬреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдЬреИрд╕реЗ:

* **Root рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ** рдЖрдорддреМрд░ рдкрд░ рдХрдо PIDS рдХреЗ рд╕рд╛рде рдЪрд▓рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдкрдХреЛ рдмрдбрд╝реЗ PID рдХреЗ рд╕рд╛рде рдПрдХ root рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдорд┐рд▓рддреА рд╣реИ рддреЛ рдЖрдкрдХреЛ рд╕рдВрджреЗрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ
* `/etc/passwd` рдореЗрдВ рдмрд┐рдирд╛ рд╢реЗрд▓ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА **рдкрдВрдЬреАрдХреГрдд рд▓реЙрдЧрд┐рди** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
* рдмрд┐рдирд╛ рд╢реЗрд▓ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП `/etc/shadow` рдореЗрдВ **рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢реЗрдЬ** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

### рдореЗрдореЛрд░реА рдбрдВрдк

рдЪрд▓ рд░рд╣реЗ рд╕рд┐рд╕реНрдЯрдо рдХреА рдореЗрдореЛрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, [**LiME**](https://github.com/504ensicsLabs/LiME) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕реБрдЭрд╛рд╡рд┐рдд рд╣реИред\
рдЗрд╕реЗ **рдХрдВрдкрд╛рдЗрд▓** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкреАрдбрд╝рд┐рдд рдорд╢реАрди рдХреЗ **рд╕рдорд╛рди рдХрд░реНрдиреЗрд▓** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

{% hint style="info" %}
рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдЖрдк рдкреАрдбрд╝рд┐рдд рдорд╢реАрди рдореЗрдВ LiME рдпрд╛ рдХреЛрдИ рдЕрдиреНрдп рдЪреАрдЬ **рдЗрдВрд╕реНрдЯреЙрд▓ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ** рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рд╕реЗ рдЙрд╕рдореЗрдВ рдХрдИ рдмрджрд▓рд╛рд╡ рд╣реЛрдВрдЧреЗред
{% endhint %}

рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ Ubuntu рдХрд╛ рд╕рдорд╛рди рд╕рдВрд╕реНрдХрд░рдг рд╣реИ рддреЛ рдЖрдк `apt-get install lime-forensics-dkms` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЕрдиреНрдп рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЖрдкрдХреЛ github рд╕реЗ [**LiME**](https://github.com/504ensicsLabs/LiME) рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рд╕рд╣реА рдХрд░реНрдиреЗрд▓ рд╣реЗрдбрд░реНрд╕ рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдХрдВрдкрд╛рдЗрд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдкреАрдбрд╝рд┐рдд рдорд╢реАрди рдХреЗ **рдмрд┐рд▓реНрдХреБрд▓ рд╕рд╣реА рдХрд░реНрдиреЗрд▓ рд╣реЗрдбрд░реНрд╕** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдмрд╕ **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреЛ рдХреЙрдкреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** `/lib/modules/<kernel version>` рдЕрдкрдиреА рдорд╢реАрди рдореЗрдВ, рдФрд░ рдлрд┐рд░ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ LiME рдХреЛ **рдХрдВрдкрд╛рдЗрд▓** рдХрд░реЗрдВ:
```bash
make -C /lib/modules/<kernel version>/build M=$PWD
sudo insmod lime.ko "path=/home/sansforensics/Desktop/mem_dump.bin format=lime"
```
LiME 3 **рдкреНрд░рд╛рд░реВрдкреЛрдВ** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ:

* Raw (рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрдЧрдореЗрдВрдЯ рдПрдХ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛)
* Padded (рд░реЙ рдХреА рддрд░рд╣, рд▓реЗрдХрд┐рди рджрд╛рдИрдВ рдУрд░ рд╢реВрдиреНрдп рдХреЗ рд╕рд╛рде)
* Lime (рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдЕрдиреБрд╢рдВрд╕рд┐рдд рдкреНрд░рд╛рд░реВрдк)

LiME рдХрд╛ рдЙрдкрдпреЛрдЧ **рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбрдВрдк рднреЗрдЬрдиреЗ** рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп рдЗрд╕ рддрд░рд╣ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ: `path=tcp:4444`

### рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬрд┐рдВрдЧ

#### рд╢рдЯ рдбрд╛рдЙрди рдХрд░рдирд╛

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ **рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╢рдЯ рдбрд╛рдЙрди** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред рдпрд╣ рд╣рдореЗрд╢рд╛ рдПрдХ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХрднреА-рдХрднреА рд╕рд┐рд╕реНрдЯрдо рдПрдХ рдкреНрд░реЛрдбрдХреНрд╢рди рд╕рд░реНрд╡рд░ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдХрдВрдкрдиреА рд╢рдЯ рдбрд╛рдЙрди рдХрд░рдиреЗ рдХрд╛ рдЦрд░реНрдЪ рдирд╣реАрдВ рдЙрдард╛ рд╕рдХрддреАред\
рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╢рдЯ рдбрд╛рдЙрди рдХрд░рдиреЗ рдХреЗ **2 рддрд░реАрдХреЗ** рд╣реИрдВ, рдПрдХ **рд╕рд╛рдорд╛рдиреНрдп рд╢рдЯ рдбрд╛рдЙрди** рдФрд░ рдПрдХ **"рдкреНрд▓рдЧ рдЦреАрдВрдЪрдирд╛" рд╢рдЯ рдбрд╛рдЙрди**ред рдкрд╣рд▓рд╛ рддрд░реАрдХрд╛ **рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд╕рдорд╛рдкреНрдд** рдХрд░рдиреЗ рдФрд░ **рдлрд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо** рдХреЛ **рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдВрднрд╛рд╡рд┐рдд **рдореИрд▓рд╡реЗрдпрд░** рдХреЛ рднреА **рд╕рдмреВрдд рдирд╖реНрдЯ** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред "рдкреНрд▓рдЧ рдЦреАрдВрдЪрдирд╛" рджреГрд╖реНрдЯрд┐рдХреЛрдг рдореЗрдВ рдХреБрдЫ **рд╕реВрдЪрдирд╛ рд╣рд╛рдирд┐** рд╣реЛ рд╕рдХрддреА рд╣реИ (рдЬреНрдпрд╛рджрд╛ рд╕реВрдЪрдирд╛ рдЦреЛрдиреЗ рд╡рд╛рд▓реА рдирд╣реАрдВ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдореЗрдореЛрд░реА рдХреА рдПрдХ рдЗрдореЗрдЬ рд▓реЗ рд▓реА рд╣реИ) рдФрд░ **рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рдХреБрдЫ рднреА рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рдЕрд╡рд╕рд░ рдирд╣реАрдВ** рд╣реЛрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рдЖрдк **рд╕рдВрджреЗрд╣** рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд╡рд╣рд╛рдВ **рдореИрд▓рд╡реЗрдпрд░** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рд╕рд┐рд╕реНрдЯрдо рдкрд░ **`sync`** **рдХрдорд╛рдВрдб** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ рдФрд░ рдкреНрд▓рдЧ рдЦреАрдВрдЪ рд▓реЗрдВред

#### рдбрд┐рд╕реНрдХ рдХреА рдЗрдореЗрдЬ рд▓реЗрдирд╛

рдпрд╣ рдзреНрдпрд╛рди рджреЗрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ **рдХреЗрд╕ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рд╕реЗ рдЕрдкрдиреЗ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ**, рдЖрдкрдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдпрд╣ **рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдЙрдВрдЯ** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рддрд╛рдХрд┐ рдХрд┐рд╕реА рднреА рд╕реВрдЪрдирд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
```bash
#Create a raw copy of the disk
dd if=<subject device> of=<image file> bs=512

#Raw copy with hashes along the way (more secure as it checks hashes while it's copying the data)
dcfldd if=<subject device> of=<image file> bs=512 hash=<algorithm> hashwindow=<chunk size> hashlog=<hash file>
dcfldd if=/dev/sdc of=/media/usb/pc.image hash=sha256 hashwindow=1M hashlog=/media/usb/pc.hashes
```
### рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬ рдкреНрд░реА-рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬ рдХреА рдЗрдореЗрдЬрд┐рдВрдЧ рдЬрд┐рд╕рдореЗрдВ рдХреЛрдИ рдФрд░ рдбреЗрдЯрд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ред
```bash
#Find out if it's a disk image using "file" command
file disk.img
disk.img: Linux rev 1.0 ext4 filesystem data, UUID=59e7a736-9c90-4fab-ae35-1d6a28e5de27 (extents) (64bit) (large files) (huge files)

#Check which type of disk image it's
img_stat -t evidence.img
raw
#You can list supported types with
img_stat -i list
Supported image format types:
raw (Single or split raw file (dd))
aff (Advanced Forensic Format)
afd (AFF Multiple File)
afm (AFF with external metadata)
afflib (All AFFLIB image formats (including beta ones))
ewf (Expert Witness Format (EnCase))

#Data of the image
fsstat -i raw -f ext4 disk.img
FILE SYSTEM INFORMATION
--------------------------------------------
File System Type: Ext4
Volume Name:
Volume ID: 162850f203fd75afab4f1e4736a7e776

Last Written at: 2020-02-06 06:22:48 (UTC)
Last Checked at: 2020-02-06 06:15:09 (UTC)

Last Mounted at: 2020-02-06 06:15:18 (UTC)
Unmounted properly
Last mounted on: /mnt/disk0

Source OS: Linux
[...]

#ls inside the image
fls -i raw -f ext4 disk.img
d/d 11: lost+found
d/d 12: Documents
d/d 8193:       folder1
d/d 8194:       folder2
V/V 65537:      $OrphanFiles

#ls inside folder
fls -i raw -f ext4 disk.img 12
r/r 16: secret.txt

#cat file inside image
icat -i raw -f ext4 disk.img 16
ThisisTheMasterSecret
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рд╡рд░реНрдХрдлреНрд▓реЛ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдмрдирд╛рдПрдВ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВ**ред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рдЬреНрдЮрд╛рдд Malware рдХреА рдЦреЛрдЬ

### рд╕рдВрд╢реЛрдзрд┐рдд рд╕рд┐рд╕реНрдЯрдо рдлрд╛рдЗрд▓реЗрдВ

рдХреБрдЫ Linux рд╕рд┐рд╕реНрдЯрдореНрд╕ рдореЗрдВ рдХрдИ рд╕реНрдерд╛рдкрд┐рдд рдШрдЯрдХреЛрдВ рдХреА **рд╕рддреНрдпрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛** рд╣реЛрддреА рд╣реИ, рдЬреЛ рдЕрд╕рд╛рдорд╛рдиреНрдп рдпрд╛ рдЕрдиреБрдЪрд┐рдд рд╕реНрдерд╛рди рдкрд░ рдореМрдЬреВрдж рдлрд╛рдЗрд▓реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рднрд╛рд╡реА рддрд░реАрдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, Linux рдкрд░ `rpm -Va` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ RedHat Package Manager рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рд╕рднреА рдкреИрдХреЗрдЬреЛрдВ рдХреА рд╕рддреНрдпрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИред
```bash
#RedHat
rpm -Va
#Debian
dpkg --verify
debsums | grep -v "OK$" #apt-get install debsums
```
### рдореИрд▓рд╡реЗрдпрд░/рд░реВрдЯрдХрд┐рдЯ рдбрд┐рдЯреЗрдХреНрдЯрд░реНрд╕

рдореИрд▓рд╡реЗрдпрд░ рдЦреЛрдЬрдиреЗ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рдЯреВрд▓реНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдкрдврд╝реЗрдВ:

{% content-ref url="malware-analysis.md" %}
[malware-analysis.md](malware-analysis.md)
{% endcontent-ref %}

## рд╕реНрдерд╛рдкрд┐рдд рдкреНрд░реЛрдЧреНрд░рд╛рдореНрд╕ рдХреА рдЦреЛрдЬ

### рдкреИрдХреЗрдЬ рдореИрдиреЗрдЬрд░

Debian-рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдореНрд╕ рдкрд░, _**/var/lib/dpkg/status**_ рдлрд╛рдЗрд▓ рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдкреИрдХреЗрдЬреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ _**/var/log/dpkg.log**_ рдлрд╛рдЗрд▓ рдореЗрдВ рдПрдХ рдкреИрдХреЗрдЬ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрдиреЗ рдкрд░ рдЬрд╛рдирдХрд╛рд░реА рджрд░реНрдЬ рдХреА рдЬрд╛рддреА рд╣реИред\
RedHat рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд Linux рд╡рд┐рддрд░рдгреЛрдВ рдкрд░ **`rpm -qa --root=/mntpath/var/lib/rpm`** рдХрдорд╛рдВрдб рдПрдХ рд╕рд┐рд╕реНрдЯрдо рдкрд░ RPM рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреА рд╕реВрдЪреА рджреЗрдЧрд╛ред
```bash
#Debian
cat /var/lib/dpkg/status | grep -E "Package:|Status:"
cat /var/log/dpkg.log | grep installed
#RedHat
rpm -qa --root=/ mntpath/var/lib/rpm
```
### рдЕрдиреНрдп

**рдЙрдкрд░реЛрдХреНрдд рдЖрджреЗрд╢реЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рднреА рд╕реНрдерд╛рдкрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕реВрдЪреАрдмрджреНрдз рдирд╣реАрдВ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ** рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреБрдЫ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рд▓рд┐рдП рдкреИрдХреЗрдЬ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЗрдиреНрд╣реЗрдВ рд╕реНрд░реЛрдд рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рдкрдбрд╝рддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, _**/usr/local**_ рдФрд░ _**/opt**_ рдЬреИрд╕реЗ рд╕реНрдерд╛рдиреЛрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛ рд╕реЗ рд╕реНрд░реЛрдд рдХреЛрдб рд╕реЗ рд╕рдВрдХрд▓рд┐рдд рдФрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдП рдЧрдП рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдкрддрд╛ рдЪрд▓ рд╕рдХрддрд╛ рд╣реИред
```bash
ls /opt /usr/local
```
рдПрдХ рдФрд░ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдЪрд╛рд░ рд╣реИ **рд╕рд╛рдорд╛рдиреНрдп рдлреЛрд▓реНрдбрд░реНрд╕** рдХреА **рдЬрд╛рдВрдЪ** рдХрд░рдирд╛ **$PATH** рдХреЗ рдЕрдВрджрд░ **рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП рдкреИрдХреЗрдЬреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдирд╣реАрдВ** рдмрд╛рдЗрдирд░реАрдЬ рдХреЗ рд▓рд┐рдП:
```bash
#Both lines are going to print the executables in /sbin non related to installed packages
#Debian
find /sbin/ -exec dpkg -S {} \; | grep "no path found"
#RedHat
find /sbin/ тАУexec rpm -qf {} \; | grep "is not"
```
```markdown
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд░реНрдХрдлреНрд▓реЛрдЬрд╝ рдХреЛ рдСрдЯреЛрдореЗрдЯ** рдХрд░реЗрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЯреВрд▓реНрд╕ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рд╣рдЯрд╛рдП рдЧрдП рдЪрд▓ рд░рд╣реЗ рдмрд╛рдЗрдирд░реАрдЬ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

![](<../../.gitbook/assets/image (641).png>)

## рдСрдЯреЛрд╕реНрдЯрд╛рд░реНрдЯ рд╕реНрдерд╛рдиреЛрдВ рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░реЗрдВ

### рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдп
```
```bash
cat /var/spool/cron/crontabs/*  \
/var/spool/cron/atjobs \
/var/spool/anacron \
/etc/cron* \
/etc/at* \
/etc/anacrontab \
/etc/incron.d/* \
/var/spool/incron/* \

#MacOS
ls -l /usr/lib/cron/tabs/ /Library/LaunchAgents/ /Library/LaunchDaemons/ ~/Library/LaunchAgents/
```
### рд╕реЗрд╡рд╛рдПрдВ

рдореИрд▓рд╡реЗрдпрд░ рджреНрд╡рд╛рд░рд╛ рдЦреБрдж рдХреЛ рдПрдХ рдирдИ, рдЕрдирдзрд┐рдХреГрдд рд╕реЗрд╡рд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рдмреЗрд╣рдж рдЖрдо рд╣реИред рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рдХрдИ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдмреВрдЯ рд╣реЛрдиреЗ рдкрд░ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЬрд╛рддреА рд╣реИрдВред рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬреЗрд╢рди рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ _**/etc/inittab**_ рдЕрдиреНрдп рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдЬреИрд╕реЗ рдХрд┐ rc.sysinit рдФрд░ _**/etc/rc.d/**_ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕, рдпрд╛ рдХреБрдЫ рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ _**/etc/rc.boot/**_ рдХреЛ рдХреЙрд▓ рдХрд░рддреА рд╣реИред рд▓рд┐рдирдХреНрд╕ рдХреЗ рдЕрдиреНрдп рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ, рдЬреИрд╕реЗ рдХрд┐ рдбреЗрдмрд┐рдпрди, рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ _**/etc/init.d/**_ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп рд╕реЗрд╡рд╛рдПрдВ _**/etc/inetd.conf**_ рдпрд╛ _**/etc/xinetd/**_ рдореЗрдВ рд╕рдХреНрд╖рдо рдХреА рдЬрд╛рддреА рд╣реИрдВ, рдЬреЛ рд▓рд┐рдирдХреНрд╕ рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИрдВред рдбрд┐рдЬрд┐рдЯрд▓ рдЬрд╛рдВрдЪрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдЗрди рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдЕрд╕рд╛рдорд╛рдиреНрдп рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред

* _**/etc/inittab**_
* _**/etc/rc.d/**_
* _**/etc/rc.boot/**_
* _**/etc/init.d/**_
* _**/etc/inetd.conf**_
* _**/etc/xinetd/**_
* _**/etc/systemd/system**_
* _**/etc/systemd/system/multi-user.target.wants/**_

### рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓

рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдореНрд╕ рдкрд░, рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓реНрд╕ рдЖрдорддреМрд░ рдкрд░ рдореИрд▓рд╡реЗрдпрд░ рдкреИрдХреЗрдЬреЛрдВ рдХреЗ рд░реВрдЯрдХрд┐рдЯ рдШрдЯрдХреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓реНрд╕ `/lib/modules/'uname -r'` рдФрд░ `/etc/modprobe.d` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╕рд┐рд╕реНрдЯрдо рдмреВрдЯ рд╣реЛрдиреЗ рдкрд░ рд▓реЛрдб рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдФрд░ `/etc/modprobe` рдпрд╛ `/etc/modprobe.conf` рдлрд╛рдЗрд▓ред рдЗрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдореИрд▓рд╡реЗрдпрд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЖрдЗрдЯрдореЛрдВ рдХреЗ рд▓рд┐рдП рдХреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдПред

### рдЕрдиреНрдп рдСрдЯреЛрд╕реНрдЯрд╛рд░реНрдЯ рд╕реНрдерд╛рди

рдХрдИ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╛рдЗрд▓реЗрдВ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рд▓рд┐рдирдХреНрд╕ рдХрд░рддрд╛ рд╣реИ рдЬрдм рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рдирд┐рд╢рд╛рди рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

* _**/etc/profile.d/\***_ , _**/etc/profile**_ , _**/etc/bash.bashrc**_ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреЗ рд▓реЙрдЧ рдЗрди рд╣реЛрдиреЗ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
* _**тИ╝/.bashrc**_ , _**тИ╝/.bash\_profile**_ , _**\~/.profile**_ , _**тИ╝/.config/autostart**_ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓реЙрдЧ рдЗрди рд╣реЛрдиреЗ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
* _**/etc/rc.local**_ рдкрд░рдВрдкрд░рд╛рдЧрдд рд░реВрдк рд╕реЗ рд╕рднреА рд╕рд╛рдорд╛рдиреНрдп рд╕рд┐рд╕реНрдЯрдо рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдорд▓реНрдЯреАрдпреВрдЬрд░ рд░рдирд▓реЗрд╡рд▓ рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрдд рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## рд▓реЙрдЧреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

рд╕рдордЭреМрддрд╛ рдХрд┐рдП рдЧрдП рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЙрдкрд▓рдмреНрдз рд╕рднреА рд▓реЙрдЧ рдлрд╛рдЗрд▓реЛрдВ рдореЗрдВ рдореИрд▓рд┐рд╢рд╕ рдирд┐рд╖реНрдкрд╛рджрди рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рдирдИ рд╕реЗрд╡рд╛ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рдирд┐рд╢рд╛рдиреЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░реЗрдВред

### рд╢реБрджреНрдз рд▓реЙрдЧреНрд╕

**рд▓реЙрдЧрд┐рди** рдШрдЯрдирд╛рдПрдВ рдЬреЛ рд╕рд┐рд╕реНрдЯрдо рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рд▓реЙрдЧреНрд╕ рдореЗрдВ рджрд░реНрдЬ рдХреА рдЧрдИ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реЙрдЧрд┐рди рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, рдпрд╣ рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддреА рд╣реИрдВ рдХрд┐ **рдореИрд▓рд╡реЗрдпрд░** рдпрд╛ рдПрдХ **рдШреБрд╕рдкреИрдард┐рдпрд╛** рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдордп рдкрд░ рдПрдХ рджрд┐рдП рдЧрдП рдЦрд╛рддреЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдордЭреМрддрд╛ рдХрд┐рдП рдЧрдП рд╕рд┐рд╕реНрдЯрдо рддрдХ рдкрд╣реБрдВрдЪ рдЧрдпрд╛ред рдЕрдиреНрдп рдШрдЯрдирд╛рдПрдВ рдЬреЛ рдореИрд▓рд╡реЗрдпрд░ рд╕рдВрдХреНрд░рдордг рдХреЗ рд╕рдордп рдХреЗ рдЖрд╕рдкрд╛рд╕ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ, рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧреНрд╕ рдореЗрдВ рдХреИрдкреНрдЪрд░ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдШрдЯрдирд╛ рдХреЗ рд╕рдордп рдХреЗ рдЖрд╕рдкрд╛рд╕ рдПрдХ **рдирдИ** **рд╕реЗрд╡рд╛** рдпрд╛ рдирдП рдЦрд╛рддреЛрдВ рдХрд╛ **рдирд┐рд░реНрдорд╛рдг** рд╢рд╛рдорд┐рд▓ рд╣реИред\
рд░реЛрдЪрдХ рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧрд┐рдиреНрд╕:

* **/var/log/syslog** (рдбреЗрдмрд┐рдпрди) рдпрд╛ **/var/log/messages** (рд░реЗрдбрд╣реИрдЯ)
* рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрджреЗрд╢ рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рджрд┐рдЦрд╛рддрд╛ рд╣реИред рдпрд╣ рд╡реИрд╢реНрд╡рд┐рдХ рд╕рд┐рд╕реНрдЯрдо рдХреА рд╕рднреА рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдбреЗрдЯрд╛ рд▓реЙрдЧ рд╣реИред
* **/var/log/auth.log** (рдбреЗрдмрд┐рдпрди) рдпрд╛ **/var/log/secure** (рд░реЗрдбрд╣реИрдЯ)
* рд╕рдлрд▓ рдпрд╛ рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рдиреНрд╕ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд▓реЙрдЧреНрд╕ рд░рдЦрддреЗ рд╣реИрдВ, рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рднрдВрдбрд╛рд░рдг рдХрд░рддреЗ рд╣реИрдВред рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдкреНрд░рдХрд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред
* `cat /var/log/auth.log | grep -iE "session opened for|accepted password|new session|not in sudoers"`
* **/var/log/boot.log**: рд╕реНрдЯрд╛рд░реНрдЯ-рдЕрдк рд╕рдВрджреЗрд╢ рдФрд░ рдмреВрдЯ рдЬрд╛рдирдХрд╛рд░реАред
* **/var/log/maillog** рдпрд╛ **var/log/mail.log:** рдореЗрд▓ рд╕рд░реНрд╡рд░ рд▓реЙрдЧреНрд╕ рдХреЗ рд▓рд┐рдП рд╣реИ, рдЬреЛ рдЖрдкрдХреЗ рд╕рд░реНрд╡рд░ рдкрд░ рдЪрд▓ рд░рд╣реА рдкреЛрд╕реНрдЯрдлрд┐рдХреНрд╕, smtpd, рдпрд╛ рдИрдореЗрд▓-рд╕рдВрдмрдВрдзрд┐рдд рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред
* **/var/log/kern.log**: рдХрд░реНрдиреЗрд▓ рд▓реЙрдЧреНрд╕ рдФрд░ рдЪреЗрддрд╛рд╡рдиреА рдЬрд╛рдирдХрд╛рд░реА рд░рдЦрддрд╛ рд╣реИред рдХрд░реНрдиреЗрд▓ рдЧрддрд┐рд╡рд┐рдзрд┐ рд▓реЙрдЧреНрд╕ (рдЬреИрд╕реЗ рдХрд┐ dmesg, kern.log, klog) рдпрд╣ рджрд┐рдЦрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕реЗрд╡рд╛ рдмрд╛рд░-рдмрд╛рд░ рдХреНрд░реИрд╢ рд╣реБрдИ, рдЬреЛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддреА рд╣реИ рдХрд┐ рдПрдХ рдЕрд╕реНрдерд┐рд░ рдЯреНрд░реЛрдЬрдирд╛рдЗрдЬреНрдб рд╕рдВрд╕реНрдХрд░рдг рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред
* **/var/log/dmesg**: рдбрд┐рд╡рд╛рдЗрд╕ рдбреНрд░рд╛рдЗрд╡рд░ рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рднрдВрдбрд╛рд░ред **dmesg** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рдлрд╛рдЗрд▓ рдореЗрдВ рд╕рдВрджреЗрд╢ рджреЗрдЦреЗрдВред
* **/var/log/faillog:** рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рдиреНрд╕ рдХреА рдЬрд╛рдирдХрд╛рд░реА рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рд▓реЙрдЧрд┐рди рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рд╣реИрдХреНрд╕ рдФрд░ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рд╣рдорд▓реЛрдВ рдЬреИрд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдЙрд▓реНрд▓рдВрдШрдиреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред
* **/var/log/cron**: рдХреНрд░реЙрдиреНрдб-рд╕рдВрдмрдВрдзрд┐рдд рд╕рдВрджреЗрд╢реЛрдВ (рдХреНрд░реЙрди рдЬреЙрдмреНрд╕) рдХрд╛ рд░рд┐рдХреЙрд░реНрдб рд░рдЦрддрд╛ рд╣реИред рдЬреИрд╕реЗ рдЬрдм рдХреНрд░реЙрди рдбреЗрдореЙрди рдиреЗ рдПрдХ рдЬреЙрдм рд╢реБрд░реВ рдХрд┐рдпрд╛ред
* **/var/log/daemon.log:** рдЪрд▓ рд░рд╣реА рдкреГрд╖реНрдарднреВрдорд┐ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЯреНрд░реИрдХ рд░рдЦрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдЙрдиреНрд╣реЗрдВ рдЧреНрд░рд╛рдлрд┐рдХрд▓реА рдкреНрд░рд╕реНрддреБрдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред
* **/var/log/btmp**: рд╕рднреА рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рди рдкреНрд░рдпрд╛рд╕реЛрдВ рдХрд╛ рдиреЛрдЯ рд░рдЦрддрд╛ рд╣реИред
* **/var/log/httpd/**: рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЬрд┐рд╕рдореЗрдВ рдЕрдкрд╛рдЪреЗ httpd рдбреЗрдореЙрди рдХреА error\_log рдФрд░ access\_log рдлрд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рд╣реИрдВред рд╣рд░ рдЧрд▓рддреА рдЬреЛ httpd рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рддреА рд╣реИ, **error\_log** рдлрд╛рдЗрд▓ рдореЗрдВ рд░рдЦреА рдЬрд╛рддреА рд╣реИред рд╕рд┐рд╕реНрдЯрдо-рд╕рдВрдмрдВрдзрд┐рдд рдЧрд▓рддрд┐рдпреЛрдВ рдФрд░ рдЕрдиреНрдп рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪреЗрдВред **access\_log** HTTP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИред
* **/var/log/mysqld.log** рдпрд╛ **/var/log/mysql.log**: MySQL рд▓реЙрдЧ рдлрд╛рдЗрд▓ рдЬреЛ рд╣рд░ рдбреАрдмрдЧ, рд╡рд┐рдлрд▓рддрд╛ рдФрд░ рд╕рдлрд▓рддрд╛ рд╕рдВрджреЗрд╢ рдХреЛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ MySQL рдбреЗрдореЙрди mysqld рдХреЗ рд╢реБрд░реВ рд╣реЛрдиреЗ, рдмрдВрдж рд╣реЛрдиреЗ рдФрд░ рдкреБрдирдГ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рд╕рд┐рд╕реНрдЯрдо рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдкрд░ рдирд┐рд░реНрдгрдп рд▓реЗрддрд╛ рд╣реИред рд░реЗрдбрд╣реИрдЯ, рд╕реЗрдВрдЯреЛрд╕, рдлреЗрдбреЛрд░рд╛, рдФрд░ рдЕрдиреНрдп рд░реЗрдбрд╣реИрдЯ-рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдо /var/log/mariadb/mariadb.log рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдбреЗрдмрд┐рдпрди/рдЙрдмреБрдВрдЯреВ /var/log/mysql/error.log рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред
* **/var/log/xferlog**: FTP
```
pip3 install usbrip
usbrip ids download #Download USB ID database
```
### рдЙрджрд╛рд╣рд░рдг
```
usbrip events history #Get USB history of your curent linux machine
usbrip events history --pid 0002 --vid 0e0f --user kali #Search by pid OR vid OR user
#Search for vid and/or pid
usbrip ids download #Downlaod database
usbrip ids search --pid 0002 --vid 0e0f #Search for pid AND vid
```
рдЧрд┐рдЯрд╣рдм рдкрд░ рдФрд░ рдЙрджрд╛рд╣рд░рдг рдФрд░ рдЬрд╛рдирдХрд╛рд░реА: [https://github.com/snovvcrash/usbrip](https://github.com/snovvcrash/usbrip)

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдФрд░ **рдСрдЯреЛрдореЗрдЯ рд╡рд░реНрдХрдлреНрд▓реЛрдЬ** рдмрдирд╛рдПрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЯреВрд▓реНрд╕ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдФрд░ рд▓реЙрдЧрдСрди рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ

_**/etc/passwd**_, _**/etc/shadow**_ рдФрд░ **рд╕реБрд░рдХреНрд╖рд╛ рд▓реЙрдЧреНрд╕** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдЕрд╕рд╛рдорд╛рдиреНрдп рдирд╛рдореЛрдВ рдпрд╛ рдЦрд╛рддреЛрдВ рдХреЗ рд▓рд┐рдП рдЬреЛ рдЕрдирдзрд┐рдХреГрдд рдШрдЯрдирд╛рдУрдВ рдХреЗ рдирд┐рдХрдЯ рд╕рдордп рдореЗрдВ рдмрдирд╛рдП рдЧрдП рдпрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдП рдЧрдП рд╣реЛрдВред рд╕рд╛рде рд╣реА, рд╕рдВрднрд╛рд╡рд┐рдд sudo рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рд╣рдорд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, _**/etc/sudoers**_ рдФрд░ _**/etc/groups**_ рдЬреИрд╕реА рдлрд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рджрд┐рдП рдЧрдП рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдПред\
рдЕрдВрдд рдореЗрдВ, **рдХреЛрдИ рдкрд╛рд╕рд╡рд░реНрдб рдирд╣реАрдВ** рдпрд╛ **рдЖрд╕рд╛рдиреА рд╕реЗ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдП рдЧрдП** рдкрд╛рд╕рд╡рд░реНрдб рд╡рд╛рд▓реЗ рдЦрд╛рддреЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░реЗрдВред

## рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдПрдВ **рдорд╛рд▓рд╡реЗрдпрд░** рдШрдЯрдирд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рдорд╛рддреНрд░рд╛ рдореЗрдВ **рдЬрд╛рдирдХрд╛рд░реА** рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдШрдЯрдирд╛рдУрдВ рдХреА **рд╕рдордп** рдФрд░ рдорд╛рд▓рд╡реЗрдпрд░ рдХреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ **рд╕рд╛рдордЧреНрд░реА** рд╢рд╛рдорд┐рд▓ рд╣реИред\
**рдорд╛рд▓рд╡реЗрдпрд░** рдХреЛ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЛ **рдмрд╛рдзрд┐рдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдмрдврд╝рддреЗ рд╣реБрдП рдбрд┐рдЬрд╛рдЗрди рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдХреБрдЫ рдорд╛рд▓рд╡реЗрдпрд░ рд╕рдордпрд░реЗрдЦрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд╕рд╛рде рдЙрдиреНрд╣реЗрдВ рдЦреЛрдЬрдирд╛ рдХрдард┐рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдлрд╛рдЗрд▓реЛрдВ рдкрд░ рджрд┐рдирд╛рдВрдХ-рд╕рдордп рд╕реНрдЯрд╛рдореНрдкреНрд╕ рдХреЛ рдмрджрд▓ рджреЗрддреЗ рд╣реИрдВред рдЕрдиреНрдп рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдХреЛрдб рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдбреЗрдЯрд╛ рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдореЗрдореЛрд░реА рдореЗрдВ рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВред\
рдРрд╕реА рдПрдВрдЯреА-рдлреЛрд░реЗрдВрд╕рд┐рдХ рддрдХрдиреАрдХреЛрдВ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП, рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рджрд┐рдирд╛рдВрдХ-рд╕рдордп рд╕реНрдЯрд╛рдореНрдкреНрд╕ рдХреЗ **рд╕рдордпрд░реЗрдЦрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг** рдкрд░ рдФрд░ рдорд╛рд▓рд╡реЗрдпрд░ рдкрд╛рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рд╕рд╛рдорд╛рдиреНрдп рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдлрд╛рдЗрд▓реЛрдВ рдкрд░ **рд╕рд╛рд╡рдзрд╛рдиреАрдкреВрд░реНрд╡рдХ рдзреНрдпрд╛рди рджреЗрдирд╛** рдЖрд╡рд╢реНрдпрдХ рд╣реИред

* **рдСрдЯреЛрдкреНрд╕реА** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдШрдЯрдирд╛рдУрдВ рдХреА рд╕рдордпрд░реЗрдЦрд╛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╕рдВрджрд┐рдЧреНрдз рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреА рдЦреЛрдЬ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИред рдЖрдк рд╕реАрдзреЗ **Sleuth Kit** рд╕реЗ `mactime` рдлреАрдЪрд░ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **$PATH** рдХреЗ рдЕрдВрджрд░ **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ (рд╢рд╛рдпрдж рдХреБрдЫ sh рдпрд╛ php рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕?)
* `/dev` рдореЗрдВ рдлрд╛рдЗрд▓реЗрдВ рд╡рд┐рд╢реЗрд╖ рдлрд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рдереАрдВ, рдЖрдкрдХреЛ рдпрд╣рд╛рдВ рдорд╛рд▓рд╡реЗрдпрд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЧреИрд░-рд╡рд┐рд╢реЗрд╖ рдлрд╛рдЗрд▓реЗрдВ рдорд┐рд▓ рд╕рдХрддреА рд╣реИрдВред
* рдЕрд╕рд╛рдорд╛рдиреНрдп рдпрд╛ **рдЫрд┐рдкреА рд╣реБрдИ рдлрд╛рдЗрд▓реЛрдВ** рдФрд░ **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реАрдЬ** рдХреА рддрд▓рд╛рд╢ рдХрд░реЗрдВ, рдЬреИрд╕реЗ рдХрд┐ тАЬ.. тАЭ (рдбреЙрдЯ рдбреЙрдЯ рд╕реНрдкреЗрд╕) рдпрд╛ тАЬ..^G тАЭ (рдбреЙрдЯ рдбреЙрдЯ рдХрдВрдЯреНрд░реЛрд▓-рдЬреА)
* рд╕рд┐рд╕реНрдЯрдо рдкрд░ /bin/bash рдХреА Setuid рдкреНрд░рддрд┐рдпрд╛рдВ `find / -user root -perm -04000 тАУprint`
* рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рдирд╖реНрдЯ рд╣реЛрдиреЗ рдХреЗ рд╕рдордп рдХреЗ рджрд┐рдирд╛рдВрдХ-рд╕рдордп рд╕реНрдЯрд╛рдореНрдкреНрд╕ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ, рдЬреЛ рд░реВрдЯрдХрд┐рдЯ рдпрд╛ рдЯреНрд░реЛрдЬрдирд╛рдЗрдЬреНрдб рд╕реЗрд╡рд╛ рдХреА рд╕реНрдерд╛рдкрдирд╛ рдЬреИрд╕реА рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдЧрддрд┐рд╡рд┐рдзрд┐ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддреА рд╣реИред
* рдЪреВрдВрдХрд┐ inodes рдХреЛ рдЕрдЧрд▓реЗ рдЙрдкрд▓рдмреНрдз рдЖрдзрд╛рд░ рдкрд░ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд▓рдЧрднрдЧ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд░рдЦреА рдЧрдИ **рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рд▓рдЧрд╛рддрд╛рд░ inodes рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЗрд╕рд▓рд┐рдП, рдорд╛рд▓рд╡реЗрдпрд░ рдХреЗ рдПрдХ рдШрдЯрдХ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдкрдбрд╝реЛрд╕реА inodes рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рдЙрддреНрдкрд╛рджрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
* _/bin_ рдпрд╛ _/sbin_ рдЬреИрд╕реА рдбрд╛рдпрд░реЗрдХреНрдЯрд░реАрдЬ рдХреА рднреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдХреНрдпреЛрдВрдХрд┐ рдирдИ рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╛рдЗрд▓реЛрдВ рдХрд╛ **рд╕рдВрд╢реЛрдзрд┐рдд рдФрд░ рдпрд╛ рдмрджрд▓рд╛ рд╣реБрдЖ рд╕рдордп** рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
* рдПрдХ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреА рдлрд╛рдЗрд▓реЛрдВ рдФрд░ рдлреЛрд▓реНрдбрд░реЛрдВ рдХреЛ рд╡рд░реНрдгрд╛рдиреБрдХреНрд░рдо рдХреЗ рдмрдЬрд╛рдп **рдирд┐рд░реНрдорд╛рдг рддрд┐рдерд┐ рджреНрд╡рд╛рд░рд╛ рдХреНрд░рдорд┐рдд** рджреЗрдЦрдирд╛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛрддрд╛ рд╣реИ рддрд╛рдХрд┐ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХреЗ рдХрд┐ рдХреМрди рд╕реА рдлрд╛рдЗрд▓реЗрдВ рдпрд╛ рдлреЛрд▓реНрдбрд░ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рд╣реИрдВ (рдЖрдорддреМрд░ рдкрд░ рдЕрдВрддрд┐рдо рд╡рд╛рд▓реЗ)ред

рдЖрдк рдПрдХ рдлреЛрд▓реНрдбрд░ рдХреА рд╕рдмрд╕реЗ рд╣рд╛рд▓ рдХреА рдлрд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ `ls -laR --sort=time /bin` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ\
рдЖрдк рдПрдХ рдлреЛрд▓реНрдбрд░ рдХреЗ рдЕрдВрджрд░ рдлрд╛рдЗрд▓реЛрдВ рдХреЗ inodes рдХреА рдЬрд╛рдВрдЪ `ls -lai /bin |sort -n` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** **рд╕рдордп** рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ **рдлрд╛рдЗрд▓реЗрдВ** **рд╡реИрдз рдкреНрд░рддреАрдд** рд╣реЛрдВ, рд▓реЗрдХрд┐рди рд╡рд╣ **inode** рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ред рдпрджрд┐ рдЖрдк рдкрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ **рдлрд╛рдЗрд▓** рдмрддрд╛рддреА рд╣реИ рдХрд┐ рдпрд╣ рдЙрд╕реА рд╕рдордп рдмрдирд╛рдИ рдФрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХреА рдЧрдИ рдереА рдЬреИрд╕реЗ рдЙрд╕реА рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдмрд╛рдХреА рдлрд╛рдЗрд▓реЗрдВ, рд▓реЗрдХрд┐рди **inode** **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд░реВрдк рд╕реЗ рдмрдбрд╝рд╛** рд╣реИ, рддреЛ рдЙрд╕ **рдлрд╛рдЗрд▓ рдХреЗ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдкреНрд╕ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдП рдЧрдП рдереЗ**ред
{% endhint %}

## рд╡рд┐рднрд┐рдиреНрди рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреА рдлрд╛рдЗрд▓реЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ

#### рдЬреЛрдбрд╝реА рдЧрдИ рдлрд╛рдЗрд▓реЗрдВ рдЦреЛрдЬреЗрдВ
```bash
git diff --no-index --diff-filter=A _openwrt1.extracted/squashfs-root/ _openwrt2.extracted/squashfs-root/
```
#### рд╕рдВрд╢реЛрдзрд┐рдд рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ
```bash
git diff --no-index --diff-filter=M _openwrt1.extracted/squashfs-root/ _openwrt2.extracted/squashfs-root/ | grep -E "^\+" | grep -v "Installed-Time"
```
#### рд╣рдЯрд╛рдП рдЧрдП рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ
```bash
git diff --no-index --diff-filter=A _openwrt1.extracted/squashfs-root/ _openwrt2.extracted/squashfs-root/
```
#### рдЕрдиреНрдп рдлрд┐рд▓реНрдЯрд░реНрд╕

**`-diff-filter=[(A|C|D|M|R|T|U|X|B)тАжтАЛ[*]]`**

рдХреЗрд╡рд▓ рдЙрди рдлрд╛рдЗрд▓реЛрдВ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдЬреЛ рдЬреЛрдбрд╝реА рдЧрдИ рд╣реИрдВ (`A`), рдХреЙрдкреА рдХреА рдЧрдИ рд╣реИрдВ (`C`), рд╣рдЯрд╛рдИ рдЧрдИ рд╣реИрдВ (`D`), рд╕рдВрд╢реЛрдзрд┐рдд рдХреА рдЧрдИ рд╣реИрдВ (`M`), рдирд╛рдо рдмрджрд▓реЗ рдЧрдП рд╣реИрдВ (`R`), рдФрд░ рдЬрд┐рдирдХрд╛ рдкреНрд░рдХрд╛рд░ (рдпрд╛рдиреА рдирд┐рдпрдорд┐рдд рдлрд╛рдЗрд▓, рд╕рд┐рдорд▓рд┐рдВрдХ, рд╕рдмрдореЙрдбреНрдпреВрд▓, тАжтАЛ) рдмрджрд▓рд╛ рдЧрдпрд╛ рд╣реИ (`T`), рдЬреЛ рдЕрдирдорд░реНрдЬреНрдб рд╣реИрдВ (`U`), рдЕрдЬреНрдЮрд╛рдд рд╣реИрдВ (`X`), рдпрд╛ рдЬрд┐рдирдХреА рдЬреЛрдбрд╝реА рдЯреВрдЯреА рд╣реБрдИ рд╣реИ (`B`). рдлрд┐рд▓реНрдЯрд░ рдЕрдХреНрд╖рд░реЛрдВ рдХрд╛ рдХреЛрдИ рднреА рд╕рдВрдпреЛрдЬрди (рд╢реВрдиреНрдп рд╕рд╣рд┐рдд) рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЬрдм `*` (рд╕рднреА-рдпрд╛-рдХреЛрдИ рдирд╣реАрдВ) рд╕рдВрдпреЛрдЬрди рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рднреА рдкрде рдЪреБрдиреЗ рдЬрд╛рддреЗ рд╣реИрдВ рдЕрдЧрд░ рдХреЛрдИ рднреА рдлрд╛рдЗрд▓ рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдиреНрдп рдорд╛рдирджрдВрдбреЛрдВ рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИ; рдЕрдЧрд░ рдХреЛрдИ рднреА рдлрд╛рдЗрд▓ рдЕрдиреНрдп рдорд╛рдирджрдВрдбреЛрдВ рд╕реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддреА рд╣реИ, рддреЛ рдХреБрдЫ рднреА рдЪреБрдирд╛ рдирд╣реАрдВ рдЬрд╛рддрд╛ рд╣реИред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **рдЗрди рдЕрдкрд░-рдХреЗрд╕ рдЕрдХреНрд╖рд░реЛрдВ рдХреЛ рдирд┐рдЪрд▓реЗ рдХреЗрд╕ рдореЗрдВ рдмрджрд▓рдХрд░ рдмрд╛рд╣рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `--diff-filter=ad` рдЬреЛрдбрд╝реЗ рдЧрдП рдФрд░ рд╣рдЯрд╛рдП рдЧрдП рдкрдереЛрдВ рдХреЛ рдмрд╛рд╣рд░ рдХрд░рддрд╛ рд╣реИред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕рднреА рдбрд┐рдлреНрд╕ рдореЗрдВ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рд╕реБрд╡рд┐рдзрд╛рдПрдБ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрдВрдбреЗрдХреНрд╕ рд╕реЗ рд╡рд░реНрдХрд┐рдВрдЧ рдЯреНрд░реА рддрдХ рдХреЗ рдбрд┐рдлреНрд╕ рдореЗрдВ рдХрднреА рднреА рдЬреЛрдбрд╝реЗ рдЧрдП рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ (рдХреНрдпреЛрдВрдХрд┐ рдбрд┐рдл рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдкрдереЛрдВ рдХрд╛ рд╕реЗрдЯ рдЗрдВрдбреЗрдХреНрд╕ рдореЗрдВ рдХреНрдпрд╛ рд╣реИ рдЗрд╕рд╕реЗ рд╕реАрдорд┐рдд рд╣реЛрддрд╛ рд╣реИ)ред рдЗрд╕реА рддрд░рд╣, рдХреЙрдкреА рдХрд┐рдП рдЧрдП рдФрд░ рдирд╛рдо рдмрджрд▓реЗ рдЧрдП рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдирд╣реАрдВ рдЖ рд╕рдХрддреА рд╣реИрдВ рдЕрдЧрд░ рдЙрди рдкреНрд░рдХрд╛рд░реЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдЕрдХреНрд╖рдо рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛред

## рд╕рдВрджрд░реНрдн

* [https://cdn.ttgtmedia.com/rms/security/Malware%20Forensics%20Field%20Guide%20for%20Linux%20Systems\_Ch3.pdf](https://cdn.ttgtmedia.com/rms/security/Malware%20Forensics%20Field%20Guide%20for%20Linux%20Systems\_Ch3.pdf)
* [https://www.plesk.com/blog/featured/linux-logs-explained/](https://www.plesk.com/blog/featured/linux-logs-explained/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рддрдХ рдкрд╣реБрдБрдЪ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!

* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **рдЬреБрдбрд╝реЗрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рд╕реЗ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**

**рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ [**hacktricks repo**](https://github.com/carlospolop/hacktricks) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд░реНрдХрдлреНрд▓реЛрдЬрд╝ рдХреЛ рдмрд┐рд▓реНрдб рдФрд░ рдСрдЯреЛрдореЗрдЯ рдХрд░реЗрдВ** рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЯреВрд▓реНрд╕ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдБрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
