# рд▓рд┐рдирдХреНрд╕ рдлреЛрд░реЗрдВрд╕рд┐рдХреНрд╕

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдмрдирд╛рдПрдВ рдФрд░ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ** рджреНрд╡рд╛рд░рд╛ рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣реЛрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ,** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ**ред

</details>

## рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдЗрдХрдЯреНрдард╛ рдХрд░рдирд╛

### рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдпрд╣ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреБрдЫ **USB** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдореЗрдВ **рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЬреНрдЮрд╛рдд рдмрд╛рдЗрдирд░реА рдФрд░ рдкреБрд╕реНрддрдХрд╛рд▓рдп** рд╣реЛрдВ (рдЖрдк рд╕рд┐рд░реНрдл рдпреВрдмрдВрдЯреВ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд╝реЛрд▓реНрдбрд░ _/bin_, _/sbin_, _/lib,_ рдФрд░ _/lib64_ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ), рдлрд┐рд░ USB рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░реЗрдВ, рдФрд░ рдЙрди рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП env variables рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ:
```bash
export PATH=/mnt/usb/bin:/mnt/usb/sbin
export LD_LIBRARY_PATH=/mnt/usb/lib:/mnt/usb/lib64
```
рдЬрдм рдЖрдкрдиреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЕрдЪреНрдЫреЗ рдФрд░ рдЬреНрдЮрд╛рдд рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ, рддреЛ рдЖрдк **рдХреБрдЫ рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдирд╛ рд╢реБрд░реВ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
date #Date and time (Clock may be skewed, Might be at a different timezone)
uname -a #OS info
ifconfig -a || ip a #Network interfaces (promiscuous mode?)
ps -ef #Running processes
netstat -anp #Proccess and ports
lsof -V #Open files
netstat -rn; route #Routing table
df; mount #Free space and mounted devices
free #Meam and swap space
w #Who is connected
last -Faiwx #Logins
lsmod #What is loaded
cat /etc/passwd #Unexpected data?
cat /etc/shadow #Unexpected data?
find /directory -type f -mtime -1 -print #Find modified files during the last minute in the directory
```
#### рд╕рдВрджрд┐рдЧреНрдз рдЬрд╛рдирдХрд╛рд░реА

рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╕рдордп рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪреАрдЬреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП:

* **рд░реВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ** рдЖрдорддреМрд░ рдкрд░ рдХрдо PIDS рдХреЗ рд╕рд╛рде рдЪрд▓рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ рдмрдбрд╝реА PID рдХреЗ рд╕рд╛рде рдПрдХ рд░реВрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдорд┐рд▓рддреА рд╣реИ рддреЛ рдЖрдк рд╕рдВрджреЗрд╣ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* `/etc/passwd` рдореЗрдВ рд╢реЗрд▓ рдХреЗ рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ **рдкрдВрдЬреАрдХреГрдд рд▓реЙрдЧрд┐рди** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
* рд╢реЗрд▓ рдХреЗ рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП `/etc/shadow` рдореЗрдВ **рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

### рдореЗрдореЛрд░реА рдбрдВрдк

рдЪрд▓ рд░рд╣реЗ рд╕рд┐рд╕реНрдЯрдо рдХреА рдореЗрдореЛрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, [**LiME**](https://github.com/504ensicsLabs/LiME) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред\
рдЗрд╕реЗ **рдХрдВрдкрд╛рдЗрд▓** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкреАрдбреАрдЖрдИрдПрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬреЛ рдкреАрдбреАрдЖрдИрдПрд╕ рдпрд╛рддреНрд░реА рдорд╢реАрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реА рд╣реИред

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк **LiME рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЪреАрдЬрд╝ рдХреЛ** рдкреАрдбреАрдЖрдИрдПрд╕ рдпрд╛рддреНрд░реА рдорд╢реАрди рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рд╕реЗ рдХрдИ рдмрджрд▓рд╛рд╡ рд╣реЛ рдЬрд╛рдПрдВрдЧреЗ
{% endhint %}

рддреЛ, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдПрдХрд╕рдВрджрд░реНрдн рд░реВрдк рдореЗрдВ рдЙрдмрдВрдЯреВ рдХрд╛ рд╕рдВрд╕реНрдХрд░рдг рд╣реИ, рддреЛ рдЖрдк `apt-get install lime-forensics-dkms` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ\
рдЕрдиреНрдп рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЖрдкрдХреЛ [**LiME**](https://github.com/504ensicsLabs/LiME) рдХреЛ github рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рд╕рд╣реА рдХрд░реНрдирд▓ рд╣реЗрдбрд░ рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдХрдВрдкрд╛рдЗрд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдкреАрдбреАрдЖрдИрдПрд╕ рдпрд╛рддреНрд░реА рдорд╢реАрди рдХреЗ **рдареАрдХ рдХрд░реНрдирд▓ рд╣реЗрдбрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП, рдЖрдк рдмрд╕ рдЗрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ `/lib/modules/<kernel version>` рдХреЛ рдЕрдкрдиреА рдорд╢реАрди рдкрд░ **рдХреЙрдкреА рдХрд░реЗрдВ**, рдФрд░ рдлрд┐рд░ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ LiME рдХреЛ **рдХрдВрдкрд╛рдЗрд▓** рдХрд░реЗрдВ:
```bash
make -C /lib/modules/<kernel version>/build M=$PWD
sudo insmod lime.ko "path=/home/sansforensics/Desktop/mem_dump.bin format=lime"
```
LiME 3 **рдлреЙрд░реНрдореЗрдЯ** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ:

* рд░реЙ (рд╣рд░ рд╕реЗрдЧрдореЗрдВрдЯ рдХреЛ рдПрдХ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛)
* рдкреИрдбреЗрдб (рд░реЙ рдХреЗ рд╕рдорд╛рди, рд▓реЗрдХрд┐рди рджрд╛рдпреАрдВ рдмрд┐рдЯреНрд╕ рдореЗрдВ рд╢реВрдиреНрдп рд╣реЛрддрд╛ рд╣реИ)
* рд▓рд╛рдЗрдо (рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдЕрдиреБрд╢рдВрд╕рд┐рдд рдлреЙрд░реНрдореЗрдЯ)

LiME рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк **рдбрдВрдк рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬ рд╕рдХрддреЗ** рд╣реИрдВ рдЗрд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдХрд░реЗрдВ: `path=tcp:4444`

### рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬрд┐рдВрдЧ

#### рдмрдВрдж рдХрд░рдирд╛

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ **рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдмрдВрдж рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛** рд╣реЛрдЧреАред рдпрд╣ рд╣рдореЗрд╢рд╛ рдПрдХ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реЛрддрд╛ рдХреНрдпреЛрдВрдХрд┐ рдХрднреА-рдХрднреА рд╕рд┐рд╕реНрдЯрдо рдПрдХ рдЙрддреНрдкрд╛рджрди рд╕рд░реНрд╡рд░ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдХрдВрдкрдиреА рдХреЛ рдмрдВрдж рдирд╣реАрдВ рдХрд░рдиреЗ рдХреА рдЖрд░реНрдерд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛрддреА рд╣реИред\
рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдмрдВрдж рдХрд░рдиреЗ рдХреЗ **2 рддрд░реАрдХреЗ** рд╣реЛрддреЗ рд╣реИрдВ, рдПрдХ **рд╕рд╛рдорд╛рдиреНрдп рдмрдВрдж рдХрд░рдирд╛** рдФрд░ рдПрдХ **"рдкреНрд▓рдЧ рдирд┐рдХрд╛рд▓реЗрдВ" рдмрдВрдж рдХрд░рдирд╛**ред рдкрд╣рд▓рд╛ рд╡рд╛рд▓рд╛ рддрд░реАрдХрд╛ **рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд╕рдорд╛рдкреНрдд рдХрд░рдиреЗ** рдФрд░ **рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо** рдХреЛ **рд╕рдордХрд╛рд▓реАрди** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рднреА рд╕рдВрднрд╛рд╡рд┐рдд **рдореИрд▓рд╡реЗрдпрд░** рдХреЛ **рд╕рдмреВрдд рдирд╖реНрдЯ** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред "рдкреНрд▓рдЧ рдирд┐рдХрд╛рд▓реЗрдВ" рддрд░реАрдХрд╛ **рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдХреА рд╣рд╛рдирд┐** рд▓реЗ рд╕рдХрддрд╛ рд╣реИ (рдЬреНрдпрд╛рджрд╛рддрд░ рдЬрд╛рдирдХрд╛рд░реА рдирд╖реНрдЯ рдирд╣реАрдВ рд╣реЛрдЧреА рдХреНрдпреЛрдВрдХрд┐ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдореЗрдореЛрд░реА рдХреА рдЫрд╡рд┐ рд▓реЗ рд▓реА рд╣реИ) рдФрд░ **рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рдореМрдХрд╛ рдирд╣реАрдВ рд╣реЛрдЧрд╛**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдПрдХ **рдореИрд▓рд╡реЗрдпрд░** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рд╕рд┐рд╕реНрдЯрдо рдкрд░ **`sync`** **рдХрдорд╛рдВрдб** рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ рдФрд░ рдкреНрд▓рдЧ рдирд┐рдХрд╛рд▓реЗрдВред

#### рдбрд┐рд╕реНрдХ рдХреА рдЫрд╡рд┐ рд▓реЗрдирд╛

рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ **рдХреЗрд╕ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреЛ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ**, рдЖрдкрдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдпрд╣ **рдХреЗрд╡рд▓ рд░реАрдб рдУрдирд▓реА** рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдЙрдВрдЯ рд╣реЛрдЧрд╛ рддрд╛рдХрд┐ рдХреЛрдИ рднреА рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрд╢реЛрдзрд┐рдд рди рд╣реЛред
```bash
#Create a raw copy of the disk
dd if=<subject device> of=<image file> bs=512

#Raw copy with hashes along the way (more secure as it checks hashes while it's copying the data)
dcfldd if=<subject device> of=<image file> bs=512 hash=<algorithm> hashwindow=<chunk size> hashlog=<hash file>
dcfldd if=/dev/sdc of=/media/usb/pc.image hash=sha256 hashwindow=1M hashlog=/media/usb/pc.hashes
```
### рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬ рдкреВрд░реНрд╡-рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рдХреЛрдИ рдЕрдзрд┐рдХ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдбрд┐рд╕реНрдХ рдЗрдореЗрдЬ рдХреЛ рдЗрдореЗрдЬрд┐рдВрдЧ рдХрд░реЗрдВред
```bash
#Find out if it's a disk image using "file" command
file disk.img
disk.img: Linux rev 1.0 ext4 filesystem data, UUID=59e7a736-9c90-4fab-ae35-1d6a28e5de27 (extents) (64bit) (large files) (huge files)

#Check which type of disk image it's
img_stat -t evidence.img
raw
#You can list supported types with
img_stat -i list
Supported image format types:
raw (Single or split raw file (dd))
aff (Advanced Forensic Format)
afd (AFF Multiple File)
afm (AFF with external metadata)
afflib (All AFFLIB image formats (including beta ones))
ewf (Expert Witness Format (EnCase))

#Data of the image
fsstat -i raw -f ext4 disk.img
FILE SYSTEM INFORMATION
--------------------------------------------
File System Type: Ext4
Volume Name:
Volume ID: 162850f203fd75afab4f1e4736a7e776

Last Written at: 2020-02-06 06:22:48 (UTC)
Last Checked at: 2020-02-06 06:15:09 (UTC)

Last Mounted at: 2020-02-06 06:15:18 (UTC)
Unmounted properly
Last mounted on: /mnt/disk0

Source OS: Linux
[...]

#ls inside the image
fls -i raw -f ext4 disk.img
d/d 11: lost+found
d/d 12: Documents
d/d 8193:       folder1
d/d 8194:       folder2
V/V 65537:      $OrphanFiles

#ls inside folder
fls -i raw -f ext4 disk.img 12
r/r 16: secret.txt

#cat file inside image
icat -i raw -f ext4 disk.img 16
ThisisTheMasterSecret
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдмрдирд╛рдПрдВ рдФрд░ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВ, рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рдЬреНрдЮрд╛рдд рдореИрд▓рд╡реЗрдпрд░ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ

### рд╕рдВрд╢реЛрдзрд┐рдд рд╕рд┐рд╕реНрдЯрдо рдлрд╝рд╛рдЗрд▓реЗрдВ

рдХреБрдЫ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдореЗрдВ рдПрдХ рд╕реБрд╡рд┐рдзрд╛ рд╣реЛрддреА рд╣реИ рдЬреЛ рдмрд╣реБрдд рд╕рд╛рд░реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрдВрдкреЛрдиреЗрдВрдЯреЛрдВ рдХреА рдкреНрд░рд╛рдорд╛рдгрд┐рдХрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрд╕рд╛рдорд╛рдиреНрдп рдпрд╛ рдЕрдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрд╣рдЪрд╛рдирдиреЗ рдХрд╛ рдПрдХ рдкреНрд░рднрд╛рд╡реА рддрд░реАрдХрд╛ рд╣реЛрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд▓рд┐рдирдХреНрд╕ рдкрд░ `rpm -Va` рдХрд╛ рдЙрдкрдпреЛрдЧ рд░реЗрдбрд╣реИрдЯ рдкреИрдХреЗрдЬ рдкреНрд░рдмрдВрдзрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрдерд╛рдкрд┐рдд рд╕рднреА рдкреИрдХреЗрдЬреЛрдВ рдХреА рдкреНрд░рд╛рдорд╛рдгрд┐рдХрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
```bash
#RedHat
rpm -Va
#Debian
dpkg --verify
debsums | grep -v "OK$" #apt-get install debsums
```
### рдореИрд▓рд╡реЗрдпрд░/рд░реВрдЯрдХрд┐рдЯ рдбрд┐рдЯреЗрдХреНрдЯрд░реНрд╕

рдореИрд▓рд╡реЗрдпрд░ рдХреЛ рдЦреЛрдЬрдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрдХ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдЯреВрд▓реНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрдЬ рдХреЛ рдкрдврд╝реЗрдВ:

{% content-ref url="malware-analysis.md" %}
[malware-analysis.md](malware-analysis.md)
{% endcontent-ref %}

## рд╕реНрдерд╛рдкрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреА рдЦреЛрдЬ

### рдкреИрдХреЗрдЬ рдкреНрд░рдмрдВрдзрдХ

рдбреЗрдмрд┐рдпрди-рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдореЛрдВ рдкрд░, _**/var/ lib/dpkg/status**_ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдкреИрдХреЗрдЬ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ _**/var/log/dpkg.log**_ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЬрдм рдХреЛрдИ рдкреИрдХреЗрдЬ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддрд╛ рд╣реИ рддреЛ рдЬрд╛рдирдХрд╛рд░реА рджрд░реНрдЬ рдХреА рдЬрд╛рддреА рд╣реИред\
рд░реЗрдбрд╣реИрдЯ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рд▓рд┐рдирдХреНрд╕ рд╡рд┐рддрд░рдгреЛрдВ рдкрд░ **`rpm -qa --root=/ mntpath/var/lib/rpm`** рдХрдорд╛рдВрдб рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдПрдХ рдЖрд░рдкреАрдПрдо рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдЧреАред
```bash
#Debian
cat /var/lib/dpkg/status | grep -E "Package:|Status:"
cat /var/log/dpkg.log | grep installed
#RedHat
rpm -qa --root=/ mntpath/var/lib/rpm
```
### рдЕрдиреНрдп

**рдЙрдкрд░реЛрдХреНрдд рдХрдорд╛рдВрдбреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рднреА рд╕реНрдерд╛рдкрд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреА рд╕реВрдЪреА рдирд╣реАрдВ рджреА рдЬрд╛рдПрдЧреА** рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреБрдЫ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рд▓рд┐рдП рдкреИрдХреЗрдЬ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рд╕реНрд░реЛрдд рдХреЛрдб рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдЗрд╕рд▓рд┐рдП, _**/usr/local**_ рдФрд░ _**/opt**_ рдЬреИрд╕реЗ рд╕реНрдерд╛рдиреЛрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдЕрдиреНрдп рдРрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЛ рдЦреЛрд▓ рд╕рдХрддреА рд╣реИ рдЬреЛ рд╕реНрд░реЛрдд рдХреЛрдб рд╕реЗ рд╕рдВрдХрд▓рд┐рдд рдФрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВред
```bash
ls /opt /usr/local
```
рдПрдХ рдФрд░ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдЪрд╛рд░ рд╣реИ **рдЬрд╛рдВрдЪреЗрдВ** рдХрд┐ **$PATH** рдХреЗ рднреАрддрд░ **рд╕рд╛рдорд╛рдиреНрдп рдлрд╝реЛрд▓реНрдбрд░** рдореЗрдВ рдХрд┐рд╕реА **рд╕реНрдерд╛рдкрд┐рдд рдкреИрдХреЗрдЬ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдирд╣реАрдВ** рд╣реИрдВ рдмрд╛рдЗрдирд░реА рдХреЛред
```bash
#Both lines are going to print the executables in /sbin non related to installed packages
#Debian
find /sbin/ -exec dpkg -S {} \; | grep "no path found"
#RedHat
find /sbin/ тАУexec rpm -qf {} \; | grep "is not"
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдмрдирд╛рдПрдВ рдФрд░ рд╡рд┐рд╢реНрд╡ рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рд╣рдЯрд╛рдП рдЧрдП рдЪрд▓ рд░рд╣реЗ рдмрд╛рдЗрдирд░реА рдХреЛ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

![](<../../.gitbook/assets/image (641).png>)

## рдСрдЯреЛрд╕реНрдЯрд╛рд░реНрдЯ рд╕реНрдерд╛рдиреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

### рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдпреЛрдВ рдХреА рд╕реВрдЪреА
```bash
cat /var/spool/cron/crontabs/*  \
/var/spool/cron/atjobs \
/var/spool/anacron \
/etc/cron* \
/etc/at* \
/etc/anacrontab \
/etc/incron.d/* \
/var/spool/incron/* \

#MacOS
ls -l /usr/lib/cron/tabs/ /Library/LaunchAgents/ /Library/LaunchDaemons/ ~/Library/LaunchAgents/
```
### рд╕реЗрд╡рд╛рдПрдВ

рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдирдП, рдЕрдирдзрд┐рдХреГрдд рд╕реЗрд╡рд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдкрдиреЗ рдЖрдк рдХреЛ рдЕрдВрджрд░ рдШреБрд╕рд╛рдирд╛ рдмрд╣реБрдд рд╕рд╛рдорд╛рдиреНрдп рд╣реИред рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рдХрдИ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдмреВрдЯ рд╣реЛрддреЗ рд╕рдордп рд╕реЗрд╡рд╛рдПрдВ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ _**/etc/inittab**_ рдЕрдиреНрдп рд╕реНрдХреНрд░рд┐рдкреНрдЯреЛрдВ рдХреЛ рдмреБрд▓рд╛рддрд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ rc.sysinit рдФрд░ _**/etc/rc.d/**_ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рддрд╣рдд рд╡рд┐рднрд┐рдиреНрди рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ, рдпрд╛ рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ _**/etc/rc.boot/**_ред рдЕрдиреНрдп рд▓рд┐рдирдХреНрд╕ рдХреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдкрд░, рдЬреИрд╕реЗ рдбреЗрдмрд┐рдпрди, рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯ _**/etc/init.d/**_ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп рд╕реЗрд╡рд╛рдПрдВ _**/etc/inetd.conf**_ рдпрд╛ _**/etc/xinetd/**_ рдореЗрдВ рд╕рдХреНрд╖рдо рдХреА рдЬрд╛рддреА рд╣реИрдВ, рд▓рд┐рдирдХреНрд╕ рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред рдбрд┐рдЬрд┐рдЯрд▓ рдЬрд╛рдВрдЪрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЗрди рд╕рднреА рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕реНрдХреНрд░рд┐рдкреНрдЯреЛрдВ рдХреА рдЕрдиреМрдкрдЪрд╛рд░рд┐рдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред

* _**/etc/inittab**_
* _**/etc/rc.d/**_
* _**/etc/rc.boot/**_
* _**/etc/init.d/**_
* _**/etc/inetd.conf**_
* _**/etc/xinetd/**_
* _**/etc/systemd/system**_
* _**/etc/systemd/system/multi-user.target.wants/**_

### рдХрд░реНрдирд▓ рдореЙрдбреНрдпреВрд▓

рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдкрд░, рдореИрд▓рд╡реЗрдпрд░ рдкреИрдХреЗрдЬ рдХреЗ рд▓рд┐рдП рдХрд░реНрдирд▓ рдореЙрдбреНрдпреВрд▓ рдЖрдорддреМрд░ рдкрд░ рд░реВрдЯрдХрд┐рдЯ рдШрдЯрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рд╣реЛрддреЗ рд╣реИрдВред рдХрд░реНрдирд▓ рдореЙрдбреНрдпреВрд▓ рд╕рд┐рд╕реНрдЯрдо рдмреВрдЯ рд╣реЛрддреЗ рд╕рдордп `/lib/modules/'uname -r'` рдФрд░ `/etc/modprobe.d` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд▓реЛрдб рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ `/etc/modprobe` рдпрд╛ `/etc/modprobe.conf` рдлрд╝рд╛рдЗрд▓ рдореЗрдВред рдЗрди рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдЬреЛ рдореИрд▓рд╡реЗрдпрд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

### рдЕрдиреНрдп рдЖрдЯреЛрд╕реНрдЯрд╛рд░реНрдЯ рд╕реНрдерд╛рди

рд▓рд┐рдирдХреНрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдПрдХ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕рдордп рдкрд░ рдПрдХреНрд╕реЗрдХреНрдпреВрдЯреЗрдмрд▓ рдЪрд╛рд▓реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рд┐рдирдХреНрд╕ рдХрдИ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рд╕рдВрдХреЗрдд рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

* _**/etc/profile.d/\***_ , _**/etc/profile**_ , _**/etc/bash.bashrc**_ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдореЗрдВ рд▓реЙрдЧ рдЗрди рд╣реЛрдиреЗ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред
* _**тИ╝/.bashrc**_ , _**тИ╝/.bash\_profile**_ , _**\~/.profile**_ , _**тИ╝/.config/autostart**_ рд╡рд┐рд╢реЗрд╖ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧ рдЗрди рд╣реЛрдиреЗ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред
* _**/etc/rc.local**_ рдпрд╣ рдкрд╛рд░рдВрдкрд░рд┐рдХ рд░реВрдк рд╕реЗ рд╕рднреА рд╕рд╛рдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдо рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдмрд╛рдж рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдПрдХ рдорд▓реНрдЯреАрдпреВрдЬрд░ рд░рдирд▓реЗрд╡рд▓ рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрдд рдореЗрдВред

## рд▓реЙрдЧ рдЬрд╛рдВрдЪреЗрдВ

рд╕рдВрдХреНрд░рдорд┐рдд рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЙрдкрд▓рдмреНрдз рд╕рднреА рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдЦреЛрдЬреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдЦрд░рд╛рдм рдирд┐рд╖реНрдкрд╛рджрди рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдирд┐рд╢рд╛рди рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рдирдИ рд╕реЗрд╡рд╛ рдХреА рд╕реГрдЬрдирд╛ред

### рдкреНрдпреЛрд░ рд▓реЙрдЧ

рд╕рд┐рд╕реНрдЯрдо рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рд▓реЙрдЧ рдореЗрдВ рд░рд┐рдХреЙрд░реНрдб рдХрд┐рдП рдЧрдП **рд▓реЙрдЧрд┐рди** рдШрдЯрдирд╛рдПрдВ, рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реЙрдЧрд┐рди, рдЗрд╕рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХрд┐рд╕реА рдЦрд╛рддреЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рд╕рдВрдХреНрд░рдорд┐рдд рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ **рдореИрд▓рд╡реЗрдпрд░** рдпрд╛ **рдЕрддрд┐рдЪрд╛рд░реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдиреЗ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдордп рдкрд░ рдкрд╣реБрдВрдЪ рд╣рд╛рд╕рд┐рд▓ рдХреА рд╣реИред рдореИрд▓рд╡реЗрдпрд░ рд╕рдВрдХреНрд░рдордг рдХреЗ рд╕рдордп рдХреЗ рдЖрд╕рдкрд╛рд╕ рдХреА рдЕрдиреНрдп рдШрдЯрдирд╛рдПрдВ рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧ рдореЗрдВ рдХреИрдкреНрдЪрд░ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ **рдирдИ рд╕реЗрд╡рд╛** рдХреА **рд╕реГрдЬрдирд╛** рдпрд╛ рдШрдЯрдирд╛рдУрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреА рд╣реИред\
рджрд┐рд▓рдЪрд╕реНрдк рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧрд┐рди:

* **/var/log/syslog** (рдбреЗрдмрд┐рдпрди) рдпрд╛ **/var/log/messages** (рд░реЗрдбрд╣реИрдЯ)
* рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрджреЗрд╢ рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рджрд┐рдЦрд╛рддрд╛ рд╣реИред рдпрд╣ рд╡реИрд╢реНрд╡рд┐рдХ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рд╕рднреА рдЧрддрд┐рд╡рд┐рдзрд┐ рдХрд╛ рдбреЗрдЯрд╛ рд▓реЙрдЧ рд╣реИред
* **/var/log/auth.log** (рдбреЗрдмрд┐рдпрди) рдпрд╛ **/var/log/secure** (рд░реЗрдбрд╣реИрдЯ)
* рд╕рдлрд▓ рдпрд╛ рдЕрд╕рдлрд▓ рд▓реЙрдЧрд┐рди, рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд▓реЙрдЧ рд░рдЦрддрд╛ рд╣реИред рд╕рдВрдЧреНрд░рд╣рдг рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рдХрд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред
* `cat /var/log/auth.log | grep -iE "session opened for|accepted password|new session|not in sudoers"`
* **/var/log/boot.log**: рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рд╕рдВ
### рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдирд┐рд╢рд╛рди

* **SSH**: рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝ рд╣реБрдП рд╕рд┐рд╕реНрдЯрдо рд╕реЗ SSH рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдП рдЧрдП рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИрдВ (_**тИ╝/.ssh/authorized\_keys**_ рдФрд░ _**тИ╝/.ssh/known\_keys**_)ред рдпреЗ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рджреВрд░рд╕реНрде рд╣реЛрд╕реНрдЯреЛрдВ рдХреЗ рд╣реЛрд╕реНрдЯрдирд╛рдо рдпрд╛ рдЖрдИрдкреА тАЛтАЛрдкрддреЗ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреА рд╣реИрдВред
* **Gnome рдбреЗрд╕реНрдХрдЯреЙрдк**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдореЗрдВ _**тИ╝/.recently-used.xbel**_ рдлрд╝рд╛рдЗрд▓ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ Gnome рдбреЗрд╕реНрдХрдЯреЙрдк рдкрд░ рдЪрд▓ рд░рд╣реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдПрдХреНрд╕реЗрд╕ рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИред
* **VIM**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдореЗрдВ _**тИ╝/.viminfo**_ рдлрд╝рд╛рдЗрд▓ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ VIM рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдЦреЛрдЬ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЗрддрд┐рд╣рд╛рд╕ рдФрд░ vim рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦреЛрд▓реА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдкрде рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред
* **Open Office**: рд╣рд╛рд▓ рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВред
* **MySQL**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдореЗрдВ _**тИ╝/.mysql\_history**_ рдлрд╝рд╛рдЗрд▓ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ MySQL рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХреНрд╡реЗрд░реА рд╣реЛрддреА рд╣реИрдВред
* **Less**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдореЗрдВ _**тИ╝/.lesshst**_ рдлрд╝рд╛рдЗрд▓ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ less рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдЦреЛрдЬ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЗрддрд┐рд╣рд╛рд╕ рдФрд░ less рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╢реЗрд▓ рдХрдорд╛рдВрдбреНрд╕ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред

### USB рд▓реЙрдЧ

[**usbrip**](https://github.com/snovvcrash/usbrip) рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╣реИ рдЬреЛ рдкреНрдпреБрдерди 3 рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рд▓рд┐рдирдХреНрд╕ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ (`/var/log/syslog*` рдпрд╛ `/var/log/messages*` рдЬрд┐рд╕ рдкрд░ рд╡рд┐рддрд░рдг рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ) рдХреЛ USB рдШрдЯрдирд╛ рдЗрддрд┐рд╣рд╛рд╕ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рд░реНрд╕ рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛрддрд╛ рд╣реИ рдХрд┐ **рдХреМрди рд╕реЗ USB рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ** рдФрд░ рдпрд╣ рдФрд░ рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛ рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдЕрдзрд┐рдХреГрдд USB рд╕реВрдЪреА рд╣реЛ рдЬрд┐рд╕рдореЗрдВ "рдЙрд▓реНрд▓рдВрдШрди рдШрдЯрдирд╛рдПрдВ" (рдЙрд╕ рд╕реВрдЪреА рдореЗрдВ рдирд╣реАрдВ рд╢рд╛рдорд┐рд▓ USB рдХрд╛ рдЙрдкрдпреЛрдЧ) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛред

### рд╕реНрдерд╛рдкрдирд╛
```
pip3 install usbrip
usbrip ids download #Download USB ID database
```
### рдЙрджрд╛рд╣рд░рдг

```markdown
#### Example 1: Collecting System Information

To collect system information in Linux, you can use the following commands:

- `uname -a`: Displays the kernel version, hostname, and other system information.
- `cat /etc/issue`: Shows the distribution and version of Linux.
- `cat /etc/passwd`: Lists all the user accounts on the system.
- `cat /etc/group`: Displays the groups on the system.
- `cat /etc/shadow`: Shows the encrypted passwords of user accounts.

#### Example 2: Analyzing Log Files

To analyze log files in Linux, you can use the following commands:

- `cat /var/log/auth.log`: Displays authentication-related logs.
- `cat /var/log/syslog`: Shows system-wide logs.
- `cat /var/log/apache2/access.log`: Lists Apache access logs.
- `cat /var/log/apache2/error.log`: Displays Apache error logs.
- `cat /var/log/secure`: Shows security-related logs.

#### Example 3: Examining Network Connections

To examine network connections in Linux, you can use the following commands:

- `netstat -tuln`: Lists all the listening ports.
- `netstat -antp`: Displays all the active network connections.
- `lsof -i`: Shows the processes that are using network connections.
- `tcpdump -i eth0`: Captures network traffic on the specified interface.
- `iptables -L`: Lists the firewall rules.

#### Example 4: Recovering Deleted Files

To recover deleted files in Linux, you can use the following commands:

- `extundelete /dev/sda1 --restore-all`: Recovers all deleted files on the specified partition.
- `photorec /dev/sda1`: Recovers various file types, including documents, photos, and videos.
- `foremost -t all -i /dev/sda1 -o /recovery`: Recovers files based on their headers and footers.
- `scalpel /dev/sda1 -o /recovery`: Carves files based on their file signatures.
- `testdisk /dev/sda1`: Recovers lost partitions and repairs damaged file systems.
```

```html
#### рдЙрджрд╛рд╣рд░рдг 1: рд╕рд┐рд╕реНрдЯрдо рд╕реВрдЪрдирд╛ рдХрд╛ рд╕рдВрдЧреНрд░рд╣рдг

рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рд╕рд┐рд╕реНрдЯрдо рд╕реВрдЪрдирд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- `uname -a`: рдХрд░реНрдирд▓ рд╕рдВрд╕реНрдХрд░рдг, рд╣реЛрд╕реНрдЯрдирд╛рдо рдФрд░ рдЕрдиреНрдп рд╕рд┐рд╕реНрдЯрдо рд╕реВрдЪрдирд╛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /etc/issue`: рд▓рд┐рдирдХреНрд╕ рдХрд╛ рд╡рд┐рддрд░рдг рдФрд░ рд╕рдВрд╕реНрдХрд░рдг рджрд┐рдЦрд╛рддрд╛ рд╣реИред
- `cat /etc/passwd`: рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреА рд╕реВрдЪреА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /etc/group`: рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕рдореВрд╣реЛрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /etc/shadow`: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

#### рдЙрджрд╛рд╣рд░рдг 2: рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- `cat /var/log/auth.log`: рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рдВрдмрдВрдзрд┐рдд рд▓реЙрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /var/log/syslog`: рд╕рд┐рд╕реНрдЯрдо-рд╡реНрдпрд╛рдкрдХ рд▓реЙрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /var/log/apache2/access.log`: рдПрдкрд╛рдЪ рдПрдХреНрд╕реЗрд╕ рд▓реЙрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /var/log/apache2/error.log`: рдПрдкрд╛рдЪ рддреНрд░реБрдЯрд┐ рд▓реЙрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /var/log/secure`: рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдмрдВрдзрд┐рдд рд▓реЙрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

#### рдЙрджрд╛рд╣рд░рдг 3: рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдХреА рдЬрд╛рдВрдЪ

рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- `netstat -tuln`: рд╕рднреА рд╕реБрдирдиреЗ рд╡рд╛рд▓реЗ рдкреЛрд░реНрдЯреЛрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `netstat -antp`: рд╕рднреА рд╕рдХреНрд░рд┐рдп рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `lsof -i`: рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `tcpdump -i eth0`: рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдкрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рддрд╛ рд╣реИред
- `iptables -L`: рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдирд┐рдпрдореЛрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

#### рдЙрджрд╛рд╣рд░рдг 4: рд╣рдЯрд╛рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐

рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рд╣рдЯрд╛рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- `extundelete /dev/sda1 --restore-all`: рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкрд╛рд░реНрдЯреАрд╢рди рдкрд░ рд╕рднреА рд╣рдЯрд╛рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХрд░рддрд╛ рд╣реИред
- `photorec /dev/sda1`: рджрд╕реНрддрд╛рд╡реЗрдЬрд╝, рдлрд╝реЛрдЯреЛ рдФрд░ рд╡реАрдбрд┐рдпреЛ рдЬреИрд╕реЗ рд╡рд┐рднрд┐рдиреНрди рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХрд░рддрд╛ рд╣реИред
- `foremost -t all -i /dev/sda1 -o /recovery`: рд╣реЗрдбрд░ рдФрд░ рдлрд╝реБрдЯрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХрд░рддрд╛ рд╣реИред
- `scalpel /dev/sda1 -o /recovery`: рдлрд╝рд╛рдЗрд▓ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рддрд╛ рд╣реИред
- `testdisk /dev/sda1`: рдЦреЛрдП рдЧрдП рдкрд╛рд░реНрдЯреАрд╢рдиреЛрдВ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдХреНрд╖рддрд┐рдЧреНрд░рд╕реНрдд рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдорд░рдореНрдордд рдХрд░рддрд╛ рд╣реИред
```

```html
#### рдЙрджрд╛рд╣рд░рдг 1: рд╕рд┐рд╕реНрдЯрдо рд╕реВрдЪрдирд╛ рдХрд╛ рд╕рдВрдЧреНрд░рд╣рдг

рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рд╕рд┐рд╕реНрдЯрдо рд╕реВрдЪрдирд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- `uname -a`: рдХрд░реНрдирд▓ рд╕рдВрд╕реНрдХрд░рдг, рд╣реЛрд╕реНрдЯрдирд╛рдо рдФрд░ рдЕрдиреНрдп рд╕рд┐рд╕реНрдЯрдо рд╕реВрдЪрдирд╛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /etc/issue`: рд▓рд┐рдирдХреНрд╕ рдХрд╛ рд╡рд┐рддрд░рдг рдФрд░ рд╕рдВрд╕реНрдХрд░рдг рджрд┐рдЦрд╛рддрд╛ рд╣реИред
- `cat /etc/passwd`: рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреА рд╕реВрдЪреА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /etc/group`: рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕рдореВрд╣реЛрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /etc/shadow`: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

#### рдЙрджрд╛рд╣рд░рдг 2: рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- `cat /var/log/auth.log`: рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рдВрдмрдВрдзрд┐рдд рд▓реЙрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /var/log/syslog`: рд╕рд┐рд╕реНрдЯрдо-рд╡реНрдпрд╛рдкрдХ рд▓реЙрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /var/log/apache2/access.log`: рдПрдкрд╛рдЪ рдПрдХреНрд╕реЗрд╕ рд▓реЙрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /var/log/apache2/error.log`: рдПрдкрд╛рдЪ рддреНрд░реБрдЯрд┐ рд▓реЙрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `cat /var/log/secure`: рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдмрдВрдзрд┐рдд рд▓реЙрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

#### рдЙрджрд╛рд╣рд░рдг 3: рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдХреА рдЬрд╛рдВрдЪ

рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- `netstat -tuln`: рд╕рднреА рд╕реБрдирдиреЗ рд╡рд╛рд▓реЗ рдкреЛрд░реНрдЯреЛрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `netstat -antp`: рд╕рднреА рд╕рдХреНрд░рд┐рдп рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `lsof -i`: рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
- `tcpdump -i eth0`: рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдкрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рддрд╛ рд╣реИред
- `iptables -L`: рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдирд┐рдпрдореЛрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

#### рдЙрджрд╛рд╣рд░рдг 4: рд╣рдЯрд╛рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐

рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рд╣рдЯрд╛рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- `extundelete /dev/sda1 --restore-all`: рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкрд╛рд░реНрдЯреАрд╢рди рдкрд░ рд╕рднреА рд╣рдЯрд╛рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХрд░рддрд╛ рд╣реИред
- `photorec /dev/sda1`: рджрд╕реНрддрд╛рд╡реЗрдЬрд╝, рдлрд╝реЛрдЯреЛ рдФрд░ рд╡реАрдбрд┐рдпреЛ рдЬреИрд╕реЗ рд╡рд┐рднрд┐рдиреНрди рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХрд░рддрд╛ рд╣реИред
- `foremost -t all -i /dev/sda1 -o /recovery`: рд╣реЗрдбрд░ рдФрд░ рдлрд╝реБрдЯрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдХрд░рддрд╛ рд╣реИред
- `scalpel /dev/sda1 -o /recovery`: рдлрд╝рд╛рдЗрд▓ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рддрд╛ рд╣
```
usbrip events history #Get USB history of your curent linux machine
usbrip events history --pid 0002 --vid 0e0f --user kali #Search by pid OR vid OR user
#Search for vid and/or pid
usbrip ids download #Downlaod database
usbrip ids search --pid 0002 --vid 0e0f #Search for pid AND vid
```
рдЕрдзрд┐рдХ рдЙрджрд╛рд╣рд░рдг рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рдЧрд┐рдЯрд╣рдм рдореЗрдВ рдореМрдЬреВрдж рд╣реИ: [https://github.com/snovvcrash/usbrip](https://github.com/snovvcrash/usbrip)

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдмрдирд╛рдПрдВ рдФрд░ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВ, рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдФрд░ рд▓реЙрдЧрдСрди рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ

рдЕрдиреИрддрд┐рдХ рдирд╛рдо рдпрд╛ рдЦрд╛рддреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдЬреЛ рдЕрдиреБрдорддрд┐ рджреНрд╡рд╛рд░рд╛ рдирд╣реАрдВ рдмрдирд╛рдП рдЧрдП рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЬрд┐рдиреНрд╣реЗрдВ рдЬреНрдЮрд╛рдд рдЕрдирдзрд┐рдХреГрдд рдШрдЯрдирд╛рдУрдВ рдХреЗ рдХрд░реАрдм рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рд╕рд╛рде рд╣реА, рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрдбреЛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рд╣рдорд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рджрд┐рдП рдЧрдП рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ, рдЬреИрд╕реЗ _**/etc/sudoers**_ рдФрд░ _**/etc/groups**_ред\
рдЕрдВрдд рдореЗрдВ, рдХреЛрдИ рдкрд╛рд╕рд╡рд░реНрдб рдпрд╛ рдЖрд╕рд╛рдиреА рд╕реЗ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде рдЦрд╛рддреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

## рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдПрдВ рдПрдХ рдореИрд▓рд╡реЗрдпрд░ рдШрдЯрдирд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдмрд╣реБрдд рд╕рд╛рд░реА **рдЬрд╛рдирдХрд╛рд░реА** рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдШрдЯрдирд╛рдУрдВ рдХрд╛ **рд╕рдордп** рдФрд░ рдореИрд▓рд╡реЗрдпрд░ рдХреА **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рд╛рдордЧреНрд░реА** рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреА рд╣реИред\
рдореИрд▓рд╡реЗрдпрд░ рдЕрдм рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдХреБрдЫ рдореИрд▓рд╡реЗрдпрд░ рдЕрд╡реИрдз рдлрд╝рд╛рдЗрд▓реЛрдВ рдкрд░ рддрд╛рд░реАрдЦ-рд╕рдордп рдЪрд┐рд╣реНрдиреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЙрдиреНрд╣реЗрдВ рдЯрд╛рдЗрдорд▓рд╛рдЗрди рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд╕рд╛рде рдвреВрдВрдврд╝рдирд╛ рдХрдард┐рди рд╣реЛред рдЕрдиреНрдп рджреБрд╖реНрдЯ рдХреЛрдб рдХреЗрд╡рд▓ рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдореЗрдореЛрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдбреЗрдЯрд╛ рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред\
рдЗрд╕ рддрд░рд╣ рдХреА рдПрдВрдЯреА-рдлрд╝реЛрд░реЗрдВрд╕рд┐рдХ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рддрд╛рд░реАрдЦ-рд╕рдордп рдЪрд┐рд╣реНрдиреЛрдВ рдХреЗ рдЯрд╛рдЗрдорд▓рд╛рдЗрди рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рд╕рддрд░реНрдХрддрд╛ рд╕реЗ рдзреНрдпрд╛рди рджреЗрдирд╛** рдЖрд╡рд╢реНрдпрдХ рд╣реИред

* **рдСрдЯреЛрдкреНрд╕реА** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рд╕рдВрджрд┐рдЧреНрдз рдЧрддрд┐рд╡рд┐рдзрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдЯрд╛рдЗрдорд▓рд╛рдЗрди рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рд╕реАрдзреЗ **рд╕реНрд▓реВрде рдХрд┐рдЯ** рдХреЗ `mactime` рдлрд╝реАрдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **$PATH** рдореЗрдВ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ (рдХреБрдЫ sh рдпрд╛ php рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ?)
* `/dev` рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрд╣рд▓реЗ рд╡рд┐рд╢реЗрд╖ рдлрд╝рд╛рдЗрд▓реЗрдВ рдереАрдВ, рдЖрдк рдпрд╣рд╛рдВ рдореИрд▓рд╡реЗрдпрд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЧреИрд░-рд╡рд┐рд╢реЗрд╖ рдлрд╝рд╛рдЗрд▓реЗрдВ рднреА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред
* рдЕрд╕рд╛рдорд╛рдиреНрдп рдпрд╛ **рдЫрд┐рдкреА рд╣реБрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ** рдФрд░ **рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдВ** рдЬреИрд╕реЗ " .. " (рдбреЙрдЯ рдбреЙрдЯ рд╕реНрдкреЗрд╕) рдпрд╛ " ..^G " (рдбреЙрдЯ рдбреЙрдЯ рдХрдВрдЯреНрд░реЛрд▓-рдЬреА)
* рд╕рд┐рд╕реНрдЯрдо рдкрд░ /bin/bash рдХреА setuid рдкреНрд░рддрд┐рдпрд╛рдВ `find / -user root -perm -04000 тАУprint`
* рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рд╣рдЯрд╛рдИ рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ **рдбрд┐рд▓реАрдЯреЗрдб рдЗрдиреЛрдб рдХреЗ рджрд┐рдирд╛рдВрдХ-рд╕рдордп рдЪрд┐рд╣реНрдиреЛрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛** рдХрд░реЗрдВ, рдЬреЛ рдХрд┐рд╕реА рд░реВрдЯрдХрд┐рдЯ рдпрд╛ рдЯреНрд░реЛрдЬрдирд╛рдЗрдЬрд╝реНрдб рд╕реЗрд╡рд╛ рдХреЗ рд╕реНрдерд╛рдкрдирд╛ рдЬреИрд╕реА рджреБрд╖реНрдЯ рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреА рд╕рдВрдХреЗрдд рд╣реЛ рд╕рдХрддреА рд╣реИред
* рдХреНрдпреЛрдВрдХрд┐ рдЗрдиреЛрдбреНрд╕ рдЕрдЧрд▓реЗ рдЙрдкрд▓рдмреНрдз рдЖрдзрд╛рд░ рдкрд░ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдПрдХ рд╣реА рд╕рдордп рдкрд░ рд░рдЦреЗ рдЧрдП рджреБрд╖реНрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рдВрдЦреНрдпрд╛рдмрджреНрдз рдЗрдиреЛрдбреНрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реМрдВрдкрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдЬрдм рдореИрд▓рд╡реЗрдпрд░ рдХрд╛ рдПрдХ рдШрдЯрдХ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдкрдбрд╝реЛрд╕реА рдЗрдиреЛрдбреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
* _/bin_ рдпрд╛ _/sbin_ рдЬреИрд╕реЗ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреА рднреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдХреНрдпреЛрдВрдХрд┐ рдирдИ рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА **рд╕рдВрд╢реЛрдзрд┐рдд рдФрд░ рдпрд╛ рдмрджрд▓реА рдЧрдИ рд╕рдордп** рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛ рд╕рдХрддреА рд╣реИред
* рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдФрд░ рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдХреЛ рдирд┐рд░реНрдорд╛рдг рддрд┐рдерд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рджреЗрдЦрдирд╛ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ рдмрдЬрд╛рдп рд╡рд░реНрдгрд╛рдиреБрдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ, рдЬрд┐рд╕рд╕реЗ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реА рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░ рдирд╡реАрдирддрдо рд╣реИрдВ (рдЖрдорддреМрд░ рдкрд░ рдЕрдВрддрд┐рдо рд╡рд╛рд▓реЗ рд╣реЛрддреЗ рд╣реИрдВ)ред

рдЖрдк `ls -laR --sort=time /bin` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдХреА рд╕рдмрд╕реЗ рд╣рд╛рд▓ рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред\
рдЖрдк `ls -lai /bin |sort -n` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рднреАрддрд░ рдХреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдЗрдиреЛрдбреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** рдлрд╝рд╛рдЗрд▓ рдХреЛ **рд╕рдордп** рдХреЛ **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░рдХреЗ **рдлрд╝рд╛рдЗрд▓реЗрдВ рд╡рд╛рд╕реНрддрд╡рд┐рдХ** рджрд┐рдЦрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╡рд╣ **рдЗрди
```bash
git diff --no-index --diff-filter=A _openwrt1.extracted/squashfs-root/ _openwrt2.extracted/squashfs-root/
```
#### рд╕рдВрд╢реЛрдзрд┐рдд рд╕рд╛рдордЧреНрд░реА рдЦреЛрдЬреЗрдВ

To find modified content in Linux, you can use the `find` command along with the `-mtime` option. The `-mtime` option allows you to specify a time range to search for modified files.

For example, to find files modified within the last 24 hours, you can use the following command:

```bash
find /path/to/directory -mtime 0
```

This will display a list of files that have been modified within the last 24 hours in the specified directory.

You can also use the `-mmin` option to search for files modified within a specific number of minutes. For example, to find files modified within the last 30 minutes, you can use the following command:

```bash
find /path/to/directory -mmin -30
```

This will display a list of files that have been modified within the last 30 minutes in the specified directory.

By using the `find` command with the appropriate options, you can easily identify modified content in Linux for forensic analysis.
```bash
git diff --no-index --diff-filter=M _openwrt1.extracted/squashfs-root/ _openwrt2.extracted/squashfs-root/ | grep -E "^\+" | grep -v "Installed-Time"
```
#### рд╣рдЯрд╛рдП рдЧрдП рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреЛрдЬреЗрдВ

To find deleted files on a Linux system, you can use various techniques:

1. **File Recovery Tools**: Use tools like `extundelete`, `foremost`, or `scalpel` to recover deleted files from the file system.

2. **File System Analysis**: Analyze the file system metadata to identify deleted files. Tools like `fls` and `icat` from The Sleuth Kit can be used for this purpose.

3. **Carving**: Use file carving techniques to search for deleted files based on their file signatures. Tools like `photorec` and `testdisk` can be helpful in this process.

4. **Memory Analysis**: Analyze the system's memory to identify deleted files that might still be present in memory. Tools like `Volatility` can be used for this purpose.

Remember to perform these actions on a forensic image or a copy of the system to avoid modifying the original evidence.
```bash
git diff --no-index --diff-filter=A _openwrt1.extracted/squashfs-root/ _openwrt2.extracted/squashfs-root/
```
#### рдЕрдиреНрдп рдлрд╝рд┐рд▓реНрдЯрд░

**`-diff-filter=[(A|C|D|M|R|T|U|X|B)тАжтАЛ[*]]`**

рдХреЗрд╡рд▓ рд╡реЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЪреБрдиреЗрдВ рдЬреЛ рдЬреЛрдбрд╝реА рдЧрдИ (`A`), рдХреЙрдкреА рдХреА рдЧрдИ (`C`), рд╣рдЯрд╛рдИ рдЧрдИ (`D`), рд╕рдВрд╢реЛрдзрд┐рдд (`M`), рдирд╛рдо рдмрджрд▓реА рдЧрдИ (`R`), рдФрд░ рдЙрдирдХреЗ рдкреНрд░рдХрд╛рд░ (рдпрд╛рдиреА рдирд┐рдпрдорд┐рдд рдлрд╝рд╛рдЗрд▓, рд╕рд┐рдВрдмрд▓рд┐рдВрдХ, рд╕рдмрдореЙрдбреНрдпреВрд▓, ... ) рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рд╣реБрдЖ (`T`), рдЕрд╕рдВрдЧрдард┐рдд (`U`), рдЕрдЬреНрдЮрд╛рдд (`X`), рдпрд╛ рдЙрдирдХреЗ рд╕рдВрдпреЛрдЬрди рдХреЛ рддреЛрдбрд╝ рджрд┐рдпрд╛ рдЧрдпрд╛ (`B`)ред рдЗрд╕ рдлрд╝рд┐рд▓реНрдЯрд░ рдЕрдХреНрд╖рд░реЛрдВ рдХрд╛ рдХреЛрдИ рднреА рд╕рдВрдпреЛрдЬрди (рдЗрд╕рдореЗрдВ рдХреЛрдИ рднреА рдирд╣реАрдВ) рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЬрдм рд╕рдВрдпреЛрдЬрди рдореЗрдВ рдЗрд╕ рд╕рдВрдпреЛрдЬрди рдореЗрдВ рдЕрдиреНрдп рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдЕрдиреБрд░реВрдк рдХреЛрдИ рдлрд╝рд╛рдЗрд▓ рдореМрдЬреВрдж рд╣реЛрддреА рд╣реИ, рддреЛ рд╕рднреА рдкрде рдЪрдпрдирд┐рдд рд╣реЛрддреЗ рд╣реИрдВ; рдпрджрд┐ рдХреЛрдИ рдРрд╕реА рдлрд╝рд╛рдЗрд▓ рдирд╣реАрдВ рд╣реИ рдЬреЛ рдЕрдиреНрдп рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдЕрдиреБрд░реВрдк рд╣реЛ, рддреЛ рдХреБрдЫ рднреА рдЪрдпрдирд┐рдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **рдпреЗ рдЕрдкрд░рдХреЗрд╕ рдЕрдХреНрд╖рд░ рдмрд╛рд╣рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд╛рдЙрдирдХреЗрд╕ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЙрджрд╛ред `--diff-filter=ad` рдЬреЛрдбрд╝реА рдЧрдИ рдФрд░ рд╣рдЯрд╛рдИ рдЧрдИ рдкрдереЛрдВ рдХреЛ рдЫреЛрдбрд╝рддрд╛ рд╣реИред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕рднреА рдЕрдВрддрд░ рд╡рд┐рд╢реЗрд╖рдгреЛрдВ рдореЗрдВ рд╕рднреА рдкреНрд░рдХрд╛рд░ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрдВрдбреЗрдХреНрд╕ рд╕реЗ рдХрд╛рд░реНрдп рд╡реГрдХреНрд╖рд╛ рддрдХ рдХреЗ рдЕрдВрддрд░ рдореЗрдВ рдХрднреА рднреА рдЬреЛрдбрд╝реА рдЧрдИ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ (рдХреНрдпреЛрдВрдХрд┐ рдЕрдВрддрд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдкрдереЛрдВ рдХрд╛ рд╕реЗрдЯ рдЗрдВрдбреЗрдХреНрд╕ рджреНрд╡рд╛рд░рд╛ рд╕реАрдорд┐рдд рд╣реЛрддрд╛ рд╣реИ)ред рдЙрд╕реА рддрд░рд╣, рдХреЙрдкреА рдФрд░ рдирд╛рдо рдмрджрд▓реА рдЧрдИ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдпрджрд┐ рдЙрди рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП рдкрд╣рдЪрд╛рди рдЕрдХреНрд╖рдо рд╣реИред

## рд╕рдВрджрд░реНрдн

* [https://cdn.ttgtmedia.com/rms/security/Malware%20Forensics%20Field%20Guide%20for%20Linux%20Systems\_Ch3.pdf](https://cdn.ttgtmedia.com/rms/security/Malware%20Forensics%20Field%20Guide%20for%20Linux%20Systems\_Ch3.pdf)
* [https://www.plesk.com/blog/featured/linux-logs-explained/](https://www.plesk.com/blog/featured/linux-logs-explained/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ рдкреАрдбреАрдПрдлрд╝ рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**

**рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрд╕рд╛рдиреА рд╕реЗ рдмрдирд╛рдПрдВ рдФрд░ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣** рдмрдирд╛рдПрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддрд╛ рд╣реИред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
