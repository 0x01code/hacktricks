# Docker Socket рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ Privilege Escalation

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВ.

</details>

рдХреБрдЫ рдЕрд╡рд╕рд░реЛрдВ рдкрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ **docker socket рддрдХ рдкрд╣реБрдВрдЪ** рд╣реЛрддреА рд╣реИ рдФрд░ рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **privileges рдмрдврд╝рд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред рдХреБрдЫ рдХреНрд░рд┐рдпрд╛рдПрдВ рдмрд╣реБрдд рд╕рдВрджрд┐рдЧреНрдз рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдФрд░ рдЖрдк рдЙрдирд╕реЗ рдмрдЪрдирд╛ рдЪрд╛рд╣ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣рд╛рдВ рдЖрдкрдХреЛ рд╡рд┐рднрд┐рдиреНрди рдлреНрд▓реИрдЧреНрд╕ рдорд┐рд▓реЗрдВрдЧреЗ рдЬреЛ privileges рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:

### рдорд╛рдЙрдВрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдЖрдк **filesystem** рдХреЗ рд╡рд┐рднрд┐рдиреНрди рднрд╛рдЧреЛрдВ рдХреЛ рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓ рд░рд╣реЗ рдХрдВрдЯреЗрдирд░ рдореЗрдВ **рдорд╛рдЙрдВрдЯ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ **рдПрдХреНрд╕реЗрд╕** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЖрдк рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ privileges рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдЙрдВрдЯ рдХрд╛ рднреА **рджреБрд░реБрдкрдпреЛрдЧ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

* **`-v /:/host`** -> рд╣реЛрд╕реНрдЯ filesystem рдХреЛ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдорд╛рдЙрдВрдЯ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рд╣реЛрд╕реНрдЯ filesystem рдХреЛ **рдкрдврд╝ рд╕рдХреЗрдВред**
* рдпрджрд┐ рдЖрдк рдХрдВрдЯреЗрдирд░ рдореЗрдВ рд╣реЛрддреЗ рд╣реБрдП рднреА рд╣реЛрд╕реНрдЯ рдХреА рддрд░рд╣ рдорд╣рд╕реВрд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлреНрд▓реИрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреНрдп рд░рдХреНрд╖рд╛ рддрдВрддреНрд░реЛрдВ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
* `--privileged`
* `--cap-add=ALL`
* `--security-opt apparmor=unconfined`
* `--security-opt seccomp=unconfined`
* `-security-opt label:disable`
* `--pid=host`
* `--userns=host`
* `--uts=host`
* `--cgroupns=host`
* \*\*`--device=/dev/sda1 --cap-add=SYS_ADMIN --security-opt apparmor=unconfined` \*\* -> рдпрд╣ рдкрд┐рдЫрд▓реА рд╡рд┐рдзрд┐ рдХреЗ рд╕рдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ рд╣рдо **рдбрд┐рд╡рд╛рдЗрд╕ рдбрд┐рд╕реНрдХ рдХреЛ рдорд╛рдЙрдВрдЯ** рдХрд░ рд░рд╣реЗ рд╣реИрдВред рдлрд┐рд░, рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ `mount /dev/sda1 /mnt` рдЪрд▓рд╛рдПрдВ рдФрд░ рдЖрдк `/mnt` рдореЗрдВ **рд╣реЛрд╕реНрдЯ filesystem** рдХреЛ **рдПрдХреНрд╕реЗрд╕** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* рдорд╛рдЙрдВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `</dev/sda1>` рдбрд┐рд╡рд╛рдЗрд╕ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрд╕реНрдЯ рдореЗрдВ `fdisk -l` рдЪрд▓рд╛рдПрдВ
* **`-v /tmp:/host`** -> рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ рдЖрдк **рдХреЗрд╡рд▓ рдХреБрдЫ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛** рдХреЛ рд╣реЛрд╕реНрдЯ рд╕реЗ рдорд╛рдЙрдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╣реЛрд╕реНрдЯ рдХреЗ рдЕрдВрджрд░ рдПрдХреНрд╕реЗрд╕ рд╣реИред рдЗрд╕реЗ рдорд╛рдЙрдВрдЯ рдХрд░реЗрдВ рдФрд░ рдорд╛рдЙрдВрдЯ рдХреА рдЧрдИ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ **suid** рдХреЗ рд╕рд╛рде рдПрдХ **`/bin/bash`** рдмрдирд╛рдПрдВ рддрд╛рдХрд┐ рдЖрдк рдЗрд╕реЗ рд╣реЛрд╕реНрдЯ рд╕реЗ рдЪрд▓рд╛ рд╕рдХреЗрдВ рдФрд░ рд░реВрдЯ рддрдХ рдПрд╕реНрдХреЗрд▓реЗрдЯ рдХрд░ рд╕рдХреЗрдВред

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╢рд╛рдпрдж рдЖрдк `/tmp` рдлреЛрд▓реНрдбрд░ рдХреЛ рдорд╛рдЙрдВрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдЖрдк рдПрдХ **рдЕрд▓рдЧ рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдлреЛрд▓реНрдбрд░** рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `find / -writable -type d 2>/dev/null`

**рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд▓рд┐рдирдХреНрд╕ рдорд╢реАрди рдХреА рд╕рднреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдВ suid рдмрд┐рдЯ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░реЗрдВрдЧреА!** suid рдмрд┐рдЯ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `mount | grep -v "nosuid"` рдЪрд▓рд╛рдПрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЖрдорддреМрд░ рдкрд░ `/dev/shm`, `/run`, `/proc`, `/sys/fs/cgroup` рдФрд░ `/var/lib/lxcfs` suid рдмрд┐рдЯ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред

рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк **`/etc`** рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдлреЛрд▓реНрдбрд░ рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рд╣реИрдВ, рддреЛ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рд╕реЗ рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╣реЛрд╕реНрдЯ рдореЗрдВ рдЙрдирдХрд╛ **рджреБрд░реБрдкрдпреЛрдЧ** рдХрд░рдХреЗ privileges рдмрдврд╝рд╛ рд╕рдХреЗрдВ (рд╢рд╛рдпрдж `/etc/shadow` рдореЗрдВ рд╕рдВрд╢реЛрдзрди рдХрд░рдХреЗ)
{% endhint %}

### рдХрдВрдЯреЗрдирд░ рд╕реЗ рдмрдЪрдирд╛

* **`--privileged`** -> рдЗрд╕ рдлреНрд▓реИрдЧ рдХреЗ рд╕рд╛рде рдЖрдк [рдХрдВрдЯреЗрдирд░ рд╕реЗ рд╕рднреА рдЕрд▓рдЧрд╛рд╡ рдХреЛ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВ](docker-privileged.md#what-affects)ред рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ privileged рдХрдВрдЯреЗрдирд░ рд╕реЗ рдмрдЪрдиреЗ рдХреА рддрдХрдиреАрдХреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ [docker-breakout-privilege-escalation/#automatic-enumeration-and-escape](docker-breakout-privilege-escalation/#automatic-enumeration-and-escape)ред
* **`--cap-add=<CAPABILITY/ALL> [--security-opt apparmor=unconfined] [--security-opt seccomp=unconfined] [-security-opt label:disable]`** -> [capabilities рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрд╕реНрдХреЗрд▓реЗрдЯ рдХрд░рдиреЗ](../linux-capabilities.md) рдХреЗ рд▓рд┐рдП, **рдХрдВрдЯреЗрдирд░ рдХреЛ рд╡рд╣ рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░реЗрдВ** рдФрд░ рдЕрдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ рдЬреЛ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХреЛ рдХрд╛рдо рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХ рд╕рдХрддреЗ рд╣реИрдВред

### Curl

рдЗрд╕ рдкреГрд╖реНрда рдкрд░ рд╣рдордиреЗ docker рдлреНрд▓реИрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ privileges рдмрдврд╝рд╛рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдкрд░ рдЪрд░реНрдЪрд╛ рдХреА рд╣реИ, рдЖрдк рдЗрди рддрд░реАрдХреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ **рддрд░реАрдХреЗ curl** рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреГрд╖реНрда рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="authz-and-authn-docker-access-authorization-plugin.md" %}
[authz-and-authn-docker-access-authorization-plugin.md](authz-and-authn-docker-access-authorization-plugin.md)
{% endcontent-ref %}

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВ.

</details>
