# UTS рдиреЗрдорд╕реНрдкреЗрд╕

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

рдПрдХ UTS (UNIX Time-Sharing System) рдиреЗрдорд╕реНрдкреЗрд╕ рдПрдХ рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдиреЗрд▓ рд╕реБрд╡рд┐рдзрд╛ рд╣реИ рдЬреЛ рджреЛ рд╕рд┐рд╕реНрдЯрдо рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреА рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ: **рд╣реЛрд╕реНрдЯрдирд╛рдо** рдФрд░ **NIS** (рдиреЗрдЯрд╡рд░реНрдХ рд╕реВрдЪрдирд╛ рд╕реЗрд╡рд╛) рдбреЛрдореЗрди рдирд╛рдоред рдпрд╣ рдЕрд▓рдЧрд╛рд╡ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ UTS рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рдкрд╛рд╕ рдЕрдкрдирд╛ **рд╕реНрд╡рддрдВрддреНрд░ рд╣реЛрд╕реНрдЯрдирд╛рдо рдФрд░ NIS рдбреЛрдореЗрди рдирд╛рдо** рд╣реЛ, рдЬреЛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдкрдХрд░рдгреАрдХрд░рдг рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реИ рдЬрд╣рд╛рдВ рдкреНрд░рддреНрдпреЗрдХ рдХрдВрдЯреЗрдирд░ рдПрдХ рдЕрд▓рдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдХрдЯ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

### рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:

1. рдЬрдм рдПрдХ рдирдпрд╛ UTS рдиреЗрдорд╕реНрдкреЗрд╕ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЕрдкрдиреЗ **рдореВрд▓ рдиреЗрдорд╕реНрдкреЗрд╕ рд╕реЗ рд╣реЛрд╕реНрдЯрдирд╛рдо рдФрд░ NIS рдбреЛрдореЗрди рдирд╛рдо рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ**ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐, рдирд┐рд░реНрдорд╛рдг рдХреЗ рд╕рдордп, рдирдпрд╛ рдиреЗрдорд╕реНрдкреЗрд╕ **рдЕрдкрдиреЗ рдореВрд▓ рд╕рд┐рджреНрдзрд╛рдВрддреЛрдВ рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ рдЗрд╕рдХреЗ рдореВрд▓**ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рднреАрддрд░ рд╣реЛрд╕реНрдЯрдирд╛рдо рдпрд╛ NIS рдбреЛрдореЗрди рдирд╛рдо рдореЗрдВ рдХреЛрдИ рднреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдкрд░рд┐рд╡рд░реНрддрди рдЕрдиреНрдп рдиреЗрдорд╕реНрдкреЗрд╕ рдкрд░ рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рдбрд╛рд▓реЗрдЧрд╛ред
2. UTS рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рднреАрддрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ **`sethostname()` рдФрд░ `setdomainname()` рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реЛрд╕реНрдЯрдирд╛рдо рдФрд░ NIS рдбреЛрдореЗрди рдирд╛рдо рдХреЛ рдмрджрд▓ рд╕рдХрддреА рд╣реИрдВ**ред рдпреЗ рдкрд░рд┐рд╡рд░реНрддрди рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдиреАрдп рд╣реИрдВ рдФрд░ рдЕрдиреНрдп рдиреЗрдорд╕реНрдкреЗрд╕ рдпрд╛ рдореБрдЦреНрдп рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рдбрд╛рд▓рддреЗред
3. рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ `setns()` рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рдмреАрдЪ рд▓реЗ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ рдпрд╛ `unshare()` рдпрд╛ `clone()` рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ `CLONE_NEWUTS` рдзреНрд╡рдЬ рдХреЗ рд╕рд╛рде рдирдП рдиреЗрдорд╕реНрдкреЗрд╕ рдмрдирд╛ рд╕рдХрддреА рд╣реИрдВред рдЬрдм рдХреЛрдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирдП рдиреЗрдорд╕реНрдкреЗрд╕ рдореЗрдВ рдЬрд╛рддреА рд╣реИ рдпрд╛ рдПрдХ рдирдпрд╛ рдиреЗрдорд╕реНрдкреЗрд╕ рдмрдирд╛рддреА рд╣реИ, рддреЛ рд╡рд╣ рдЙрд╕ рдиреЗрдорд╕реНрдкреЗрд╕ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реЛрд╕реНрдЯрдирд╛рдо рдФрд░ NIS рдбреЛрдореЗрди рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдЧреАред

## рд▓реИрдм:

### рд╡рд┐рднрд┐рдиреНрди рдиреЗрдорд╕реНрдкреЗрд╕ рдмрдирд╛рдПрдВ

#### CLI
```bash
sudo unshare -u [--mount-proc] /bin/bash
```
рдпрджрд┐ рдЖрдк `--mount-proc` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддреЛ `/proc` рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рдПрдХ рдирдпрд╛ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдорд╛рдЙрдВрдЯ рдХрд░рдХреЗ, рдЖрдк рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдирдпрд╛ рдорд╛рдЙрдВрдЯ рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рд▓рд┐рдП рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реВрдЪрдирд╛ рдХрд╛ рд╕рдЯреАрдХ рдФрд░ рдЕрд▓рдЧрдЬрд╛ рджреГрд╢реНрдп рд╣реИред
```bash
docker run -ti --name ubuntu1 -v /usr:/ubuntu1 ubuntu bash
```
### &#x20;рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдЖрдкрдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд┐рд╕ рдиреЗрдорд╕реНрдкреЗрд╕ рдореЗрдВ рд╣реИ
```bash
ls -l /proc/self/ns/uts
lrwxrwxrwx 1 root root 0 Apr  4 20:49 /proc/self/ns/uts -> 'uts:[4026531838]'
```
### рд╕рднреА UTS рдиреЗрдорд╕реНрдкреЗрд╕ рдЦреЛрдЬреЗрдВ

{% code overflow="wrap" %}
```bash
sudo find /proc -maxdepth 3 -type l -name uts -exec readlink {} \; 2>/dev/null | sort -u
# Find the processes with an specific namespace
sudo find /proc -maxdepth 3 -type l -name uts -exec ls -l  {} \; 2>/dev/null | grep <ns-number>
```
{% endcode %}

### рдПрдХ UTS рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рдЕрдВрджрд░ рдЬрд╛рдПрдВ
```bash
nsenter -u TARGET_PID --pid /bin/bash
```
рдЖрдк рдХреЗрд╡рд▓ **рд░реВрдЯ рд╣реЛрдиреЗ рдкрд░** **рджреВрд╕рд░реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдиреЗрдорд╕реНрдкреЗрд╕ рдореЗрдВ рдкреНрд░рд╡реЗрд╢** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдФрд░ рдЖрдк **рдЙрд╕рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдирд╣реАрдВ** рдХрд░ рд╕рдХрддреЗ **рдмрд┐рдирд╛ рдПрдХ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░** рдХреЗ рдЬреЛ рдЗрд╕реЗ рдкреЙрдЗрдВрдЯ рдХрд░рддрд╛ рд╣реИ (рдЬреИрд╕реЗ `/proc/self/ns/uts`).

### рд╣реЛрд╕реНрдЯрдирд╛рдо рдмрджрд▓реЗрдВ
```bash
unshare -u /bin/bash
hostname newhostname # Hostname won't be changed inside the host UTS ns
```
## рд╕рдВрджрд░реНрдн
* [https://stackoverflow.com/questions/44666700/unshare-pid-bin-bash-fork-cannot-allocate-memory](https://stackoverflow.com/questions/44666700/unshare-pid-bin-bash-fork-cannot-allocate-memory)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
