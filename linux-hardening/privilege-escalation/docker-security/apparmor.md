# AppArmor

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ**

</details>

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

**AppArmor** рдПрдХ рдХрд░реНрдирд▓ рдПрдиреНрд╣рд╛рдВрд╕рдореЗрдВрдЯ рд╣реИ рдЬреЛ **рдкреНрд░реЛрдЧреНрд░рд╛рдореЛрдВ** рдХреЛ **рд╕реАрдорд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ** рдХреЗ **рд╕реЗрдЯ** рдореЗрдВ рдмрд╛рдзрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **рдкреНрд░реЛрдЧреНрд░рд╛рдо рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓** рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓реНрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдПрдХреНрд╕реЗрд╕, рд░реЙ рд╕реЙрдХреЗрдЯ рдПрдХреНрд╕реЗрд╕ рдФрд░ рдорд┐рд▓рддреЗ рдкрдереЛрдВ рдкрд░ рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрдврд╝рдиреЗ, рд▓рд┐рдЦрдиреЗ рдпрд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдЬреИрд╕реА **рдХреНрд╖рдорддрд╛рдУрдВ** рдХреЛ **рдЕрдиреБрдорддрд┐** рджреЗ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣ рдПрдХ рдЕрдирд┐рд╡рд╛рд░реНрдп рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг рдпрд╛ **MAC** рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдмрдЬрд╛рдп рдкреНрд░реЛрдЧреНрд░рд╛рдореЛрдВ рдХреЛ рдмрд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг** рдЧреБрдгреЛрдВ рдХреЛ **рдмрд╛рдзрд┐рдд рдХрд░рддрд╛ рд╣реИ**ред\
AppArmor рдмрд╛рдзреНрдпрддрд╛ рдХрд░реНрдирд▓ рдореЗрдВ рд▓реЛрдб рдХрд┐рдП рдЧрдП рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓реНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рддреА рд╣реИ, рдЖрдорддреМрд░ рдкрд░ рдмреВрдЯ рдкрд░ред\
AppArmor рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рджреЛ рдореЛрдб рдореЗрдВ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:

* **рдирд┐рд╖реНрдкрд╛рджрди**: рдирд┐рд╖реНрдкрд╛рджрди рдореЛрдб рдореЗрдВ рд▓реЛрдб рдХрд┐рдП рдЧрдП рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓реНрд╕ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдиреАрддрд┐ рдХреЗ **рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк** рд╣реЛрдВрдЧреЗ рдФрд░ рдиреАрддрд┐ рдЙрд▓реНрд▓рдВрдШрди рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреА **рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ** рдХрд░реЗрдВрдЧреЗ (рд╕рд┐рд╕рд▓реЙрдЧ рдпрд╛ рдСрдбрд┐рдЯрдбреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ)ред
* **рд╢рд┐рдХрд╛рдпрдд**: рд╢рд┐рдХрд╛рдпрдд рдореЛрдб рдореЗрдВ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓реНрд╕ **рдиреАрддрд┐ рдХрд╛ рдкрд╛рд▓рди рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ** рдмрд▓реНрдХрд┐ рдмрдЬрд╛рдп рдЗрд╕рдХреЗ **рдиреАрддрд┐ рдЙрд▓реНрд▓рдВрдШрди** рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреА **рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ** рдХрд░реЗрдВрдЧреЗред

AppArmor рд▓рд┐рдирдХреНрд╕ рдкрд░ рдХреБрдЫ рдЕрдиреНрдп MAC рд╕рд┐рд╕реНрдЯрдореЛрдВ рд╕реЗ рдЕрд▓рдЧ рд╣реЛрддрд╛ рд╣реИ: рдпрд╣ **рдкрд╛рде-рдЖрдзрд╛рд░рд┐рдд** рд╣реИ, рдпрд╣ рдирд┐рд╖реНрдкрд╛рджрди рдФрд░ рд╢рд┐рдХрд╛рдпрдд рдореЛрдб рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдорд┐рд╢реНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдпрд╣ рд╡рд┐рдХрд╛рд╕ рдХреЛ рд╕реБрдЧрдо рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдВрдХрд▓реВрдб рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рд▓реЛрдХрдкреНрд░рд┐рдп MAC рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмрд╣реБрдд рдХрдо рдмрд╛рдзрд╛ рд╣реЛрддреА рд╣реИред

### AppArmor рдХреЗ рдЕрдВрдЧ

* **рдХрд░реНрдирд▓ рдореЙрдбреНрдпреВрд▓**: рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ
* **рдиреАрддрд┐рдпрд╛рдБ**: рд╡реНрдпрд╡рд╣рд╛рд░ рдФрд░ рд╕рдВрдЧреНрд░рд╣рдг рдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рдХрд░рддреА рд╣реИрдВ
* **рдкрд╛рд░реНрд╕рд░**: рдиреАрддрд┐рдпреЛрдВ рдХреЛ рдХрд░реНрдирд▓ рдореЗрдВ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИ
* **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЙрдкрдХрд░рдг**: apparmor рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпреВрдЬрд░рдореЛрдб рдкреНрд░реЛрдЧреНрд░рд╛рдо

### рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдкрде

Apparmor рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдЖрдорддреМрд░ рдкрд░ _**/etc/apparmor.d/**_ рдореЗрдВ рд╕рд╣реЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред\
`sudo aa-status` рдХреЗ рд╕рд╛рде рдЖрдк рдЙрди рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХреА рд╕реВрдЪреА рджреЗрдЦ рд╕рдХреЗрдВрдЧреЗ рдЬрд┐рдиреНрд╣реЗрдВ рдХрд┐рд╕реА рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдЖрдк рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд┐рд╕реА рднреА рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЗ рдЙрд▓реНрд▓реЗрдЦрд┐рдд рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рд╕реВрдЪреАрдмрджреНрдз рдмрд╛рдЗрдирд░реА рдХреЗ рдкрде рдХреЗ рд▓рд┐рдП рдЪрд╛рд░ "/" рдХреЛ рдПрдХ рдбреЙрдЯ рдореЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрдк рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХрд╛ рдирд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, _/usr/bin/man_ рдХреЗ рд▓рд┐рдП рдПрдХ **apparmor** рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ _/etc/apparmor.d/usr.bin.man_ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрдЧрд╛ред

### рдХрдорд╛рдВрдбреНрд╕
```bash
aa-status     #check the current status
aa-enforce    #set profile to enforce mode (from disable or complain)
aa-complain   #set profile to complain mode (from diable or enforcement)
apparmor_parser #to load/reload an altered policy
aa-genprof    #generate a new profile
aa-logprof    #used to change the policy when the binary/program is changed
aa-mergeprof  #used to merge the policies
```
## рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдирд╛

* рдкреНрд░рднрд╛рд╡рд┐рдд рдПрдХреНрдЬрд╝реАрдХреНрдпреВрдЯреЗрдмрд▓ рдХреЛ рджрд░реНрд╢рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, **рдкреВрд░реНрдг рдкрде рдФрд░ рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб** (рдлрд╝рд╛рдЗрд▓ рдЧреНрд▓реЙрдмрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП) рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред
* **рдлрд╝рд╛рдЗрд▓реЛрдВ** рдкрд░ рдмрд╛рдЗрдирд░реА рдХреЗ рдкрд╛рд╕ рдПрдХреНрд╕реЗрд╕ рдХреЛ рджрд░реНрд╢рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд **рдПрдХреНрд╕реЗрд╕ рдирд┐рдпрдВрддреНрд░рдг** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
* **r** (рдкрдврд╝рдирд╛)
* **w** (рд▓рд┐рдЦрдирд╛)
* **m** (рдореЗрдореЛрд░реА рдореИрдк рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХреНрд╕реЗрдХреНрдпреВрдЯреЗрдмрд▓)
* **k** (рдлрд╝рд╛рдЗрд▓ рд▓реЙрдХрд┐рдВрдЧ)
* **l** (рд╣рд╛рд░реНрдб рд▓рд┐рдВрдХ рдмрдирд╛рдирд╛)
* **ix** (рдирдИ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рд╕рд╛рде рдПрдХ рдФрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП)
* **Px** (рдПрдХ рдФрд░ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЗ рддрд╣рдд рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ, рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЛ рд╕рд╛рдлрд╝ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж)
* **Cx** (рдПрдХ рдмрд╛рд▓ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЗ рддрд╣рдд рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ, рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЛ рд╕рд╛рдлрд╝ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж)
* **Ux** (рдмрд┐рдирд╛ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЛ рд╕рд╛рдлрд╝ рдХрд┐рдП рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ)
* **рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЪрд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЗ рдмрд╛рд╣рд░ рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: @{PROC} рдФрд░ @{HOME} (рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ #include \<tunables/global> рдЬреЛрдбрд╝реЗрдВ)
* **рдЕрдиреБрдорддрд┐ рдирд┐рдпрдореЛрдВ рдХреЛ рдЕрдиреБрдорддрд┐ рдирд┐рдпрдореЛрдВ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред

### aa-genprof

рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдирд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреА рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдРрдкрд╛рд░реНрдорд░ рдХреА рдорджрдж рд╕реЗ рдЖрдк **рдРрдкрд╛рд░реНрдорд░ рдХреЛ рдПрдХ рдмрд╛рдЗрдирд░реА рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЧрдП рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдФрд░ рдлрд┐рд░ рдЖрдкрдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдпрд╛ рдирдХрд╛рд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЪреБрдирдиреЗ рджреЗрдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛрддреА рд╣реИ**ред\
рдЖрдкрдХреЛ рдмрд╕ рдпрд╣ рдЪрд▓рд╛рдирд╛ рд╣реЛрдЧрд╛:
```bash
sudo aa-genprof /path/to/binary
```
рддреЛ, рдПрдХ рдЕрд▓рдЧ рдХрдВрд╕реЛрд▓ рдореЗрдВ рд╡реЗ рд╕рднреА рдХрд╛рд░реНрд░рд╡рд╛рдЗрдпрд╛рдБ рдХрд░реЗрдВ рдЬреЛ рдмрд╛рдЗрдирд░реА рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдХрд░реЗрдЧрд╛:
```bash
/path/to/binary -a dosomething
```
рддреЛ, рдкрд╣рд▓реЗ рдХрдВрд╕реЛрд▓ рдореЗрдВ "**s**" рджрдмрд╛рдПрдВ рдФрд░ рдлрд┐рд░ рд░рд┐рдХреЙрд░реНрдб рдХреА рдЧрдИ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдореЗрдВ рдЗрдВрдЧреЛрд░ рдХрд░рдирд╛, рдЕрдиреБрдорддрд┐ рджреЗрдирд╛, рдпрд╛ рдЬреЛ рднреА рдЪрд╛рд╣реЗрдВ рдЙрд╕реЗ рджрд░реНрдЬ рдХрд░реЗрдВред рдЬрдм рдЖрдк рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рдПрдВ рддреЛ "**f**" рджрдмрд╛рдПрдВ рдФрд░ рдирдпрд╛ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ _/etc/apparmor.d/path.to.binary_ рдореЗрдВ рдмрдирд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

{% hint style="info" %}
рдПрд░реЛ рдХреА рдХреАрдЬрд┐рдП рдЙрд╕реЗ рдЪреБрдирдиреЗ рдХреЗ рд▓рд┐рдП рдЬреЛ рдЖрдк рдЕрдиреБрдорддрд┐ рджреЗрдирд╛/рдордирд╛ рдХрд░рдирд╛/рдЬреЛ рднреА рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ
{% endhint %}

### aa-easyprof

рдЖрдк рдПрдХ рдмрд╛рдЗрдирд░реА рдХреЗ рдПрдХ рдПрдкрд╛рд░рдореЛрд░ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЯреЗрдореНрдкрд▓реЗрдЯ рднреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
sudo aa-easyprof /path/to/binary
# vim:syntax=apparmor
# AppArmor policy for binary
# ###AUTHOR###
# ###COPYRIGHT###
# ###COMMENT###

#include <tunables/global>

# No template variables specified

"/path/to/binary" {
#include <abstractions/base>

# No abstractions specified

# No policy groups specified

# No read paths specified

# No write paths specified
}
```
{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ рдирдИ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХреБрдЫ рднреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╕рдм рдХреБрдЫ рдирд┐рд╖реЗрдзрд┐рдд рд╣реЛрддрд╛ рд╣реИред рдЖрдкрдХреЛ `/etc/passwd r,` рдЬреИрд╕реА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рдЬрд┐рд╕рд╕реЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП `/etc/passwd` рдмрд╛рдЗрдирд░реА рдХреЛ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓реЗред
{% endhint %}

рдлрд┐рд░ рдЖрдк рдирдИ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЛ **рдкреНрд░рдмрд▓** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
```bash
sudo apparmor_parser -a /etc/apparmor.d/path.to.binary
```
### рд▓реЙрдЧреНрд╕ рд╕реЗ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЯреВрд▓ рд▓реЙрдЧреНрд╕ рдХреЛ рдкрдврд╝реЗрдЧрд╛ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдкреВрдЫреЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рд╡рд╣ рдХреБрдЫ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ:
```bash
sudo aa-logprof
```
{% hint style="info" %}
рдПрд░реЛ рдХреАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдХреНрдпрд╛ рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ / рдирд┐рд╖реЗрдз рдХрд░рдирд╛ / рдХреБрдЫ рднреА рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ
{% endhint %}

### рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдкреНрд░рдмрдВрдзрди
```bash
#Main profile management commands
apparmor_parser -a /etc/apparmor.d/profile.name #Load a new profile in enforce mode
apparmor_parser -C /etc/apparmor.d/profile.name #Load a new profile in complain mode
apparmor_parser -r /etc/apparmor.d/profile.name #Replace existing profile
apparmor_parser -R /etc/apparmor.d/profile.name #Remove profile
```
## рд▓реЙрдЧ

**`service_bin`** рдХреЗ _/var/log/audit/audit.log_ рд╕реЗ **AUDIT** рдФрд░ **DENIED** рд▓реЙрдЧ рдХрд╛ рдЙрджрд╛рд╣рд░рдг:
```bash
type=AVC msg=audit(1610061880.392:286): apparmor="AUDIT" operation="getattr" profile="/bin/rcat" name="/dev/pts/1" pid=954 comm="service_bin" requested_mask="r" fsuid=1000 ouid=1000
type=AVC msg=audit(1610061880.392:287): apparmor="DENIED" operation="open" profile="/bin/rcat" name="/etc/hosts" pid=954 comm="service_bin" requested_mask="r" denied_mask="r" fsuid=1000 ouid=0
```
рдЖрдк рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
sudo aa-notify -s 1 -v
Profile: /bin/service_bin
Operation: open
Name: /etc/passwd
Denied: r
Logfile: /var/log/audit/audit.log

Profile: /bin/service_bin
Operation: open
Name: /etc/hosts
Denied: r
Logfile: /var/log/audit/audit.log

AppArmor denials: 2 (since Wed Jan  6 23:51:08 2021)
For more information, please see: https://wiki.ubuntu.com/DebuggingApparmor
```
## рдбреЙрдХрд░ рдореЗрдВ Apparmor

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдбреЙрдХрд░ рдХрд╛ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ **рдбреЙрдХрд░-рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓** рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд▓реЛрдб рд╣реЛрддрд╛ рд╣реИ:
```bash
sudo aa-status
apparmor module is loaded.
50 profiles are loaded.
13 profiles are in enforce mode.
/sbin/dhclient
/usr/bin/lxc-start
/usr/lib/NetworkManager/nm-dhcp-client.action
/usr/lib/NetworkManager/nm-dhcp-helper
/usr/lib/chromium-browser/chromium-browser//browser_java
/usr/lib/chromium-browser/chromium-browser//browser_openjdk
/usr/lib/chromium-browser/chromium-browser//sanitized_helper
/usr/lib/connman/scripts/dhclient-script
docker-default
```
рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **Apparmor docker-default рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓** [https://github.com/moby/moby/tree/master/profiles/apparmor](https://github.com/moby/moby/tree/master/profiles/apparmor) рд╕реЗ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИред

**docker-default рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рд╕рд╛рд░рд╛рдВрд╢**:

* рд╕рднреА **рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ** рддрдХ **рдкрд╣реБрдВрдЪ**
* рдХреЛрдИ **рдХреНрд╖рдорддрд╛** рдкрд░рд┐рднрд╛рд╖рд┐рдд рдирд╣реАрдВ рд╣реИ (рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреБрдЫ рдХреНрд╖рдорддрд╛рдПрдВ рдореВрд▓ рдмреЗрд╕ рдирд┐рдпрдореЛрдВ рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рдиреЗ рд╕реЗ рдЖрдПрдЧреА, рдЬреИрд╕реЗ #include \<abstractions/base>)
* рдХрд┐рд╕реА рднреА **/proc** рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **рд▓рд┐рдЦрдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ
* рдЕрдиреНрдп **рдЙрдкрдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдВ**/**рдлрд╝рд╛рдЗрд▓реЗрдВ** /**proc** рдФрд░ /**sys** рдХреА рдкрдврд╝рдиреЗ/рд▓рд┐рдЦрдиреЗ/рд▓реЙрдХ/рд▓рд┐рдВрдХ/рдПрдХреНрд╕реАрдХреНрдпреВрдЯ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ
* **рдорд╛рдЙрдВрдЯ** рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ
* **Ptrace** рдХреЗрд╡рд▓ рдЙрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкрд░ рдЪрд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ **рдПрдХ рд╣реА apparmor рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓** рджреНрд╡рд╛рд░рд╛ рд╕реАрдорд┐рдд рд╣реЛ

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк **рдПрдХ рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛рддреЗ рд╣реИрдВ**, рддреЛ рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрдЙрдЯрдкреБрдЯ рджрд┐рдЦрд╛рдИ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП:
```bash
1 processes are in enforce mode.
docker-default (825)
```
рдиреЛрдЯ рдХрд░реЗрдВ рдХрд┐ **рдПрдкрд╛рд░реНрдорд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХрдВрдЯреЗрдирд░ рдХреЛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдХреНрд╖рдорддрд╛ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рднреА рдмреНрд▓реЙрдХ рдХрд░реЗрдЧрд╛**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ SYS\_ADMIN рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рддреА рд╣реИ рддреЛ рдпрд╣ рдХрдВрдЯреЗрдирд░ рдХреЛ /proc рдХреЗ рдЕрдВрджрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рднреА рдмреНрд▓реЙрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдбреЙрдХрд░ рдПрдкрд╛рд░реНрдорд░ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЗрд╕ рдкрд╣реБрдВрдЪ рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ:
```bash
docker run -it --cap-add SYS_ADMIN --security-opt seccomp=unconfined ubuntu /bin/bash
echo "" > /proc/stat
sh: 1: cannot create /proc/stat: Permission denied
```
рдЖрдкрдХреЛ apparmor рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЗрд╕рдХреА рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ:
```bash
docker run -it --cap-add SYS_ADMIN --security-opt seccomp=unconfined --security-opt apparmor=unconfined ubuntu /bin/bash
```
рдиреЛрдЯ рдХрд░реЗрдВ рдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **AppArmor** рднреА **рдХрдВрдЯреЗрдирд░ рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХреЗрдЧрд╛** рднреА рдЕрдВрджрд░ рд╕реЗ, SYS\_ADMIN рдХреНрд╖рдорддрд╛ рдХреЗ рд╕рд╛рде рднреАред

рдиреЛрдЯ рдХрд░реЗрдВ рдХрд┐ рдЖрдк рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рдореЗрдВ **рдХреНрд╖рдорддрд╛рдУрдВ** рдХреЛ **рдЬреЛрдбрд╝ рд╕рдХрддреЗ/рд╣рдЯрд╛ рд╕рдХрддреЗ** рд╣реИрдВ (рдпрд╣ рдЕрднреА рднреА **AppArmor** рдФрд░ **Seccomp** рдЬреИрд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реЛрдЧрд╛):

* `--cap-add=SYS_ADMIN` `SYS_ADMIN` рдХреНрд╖рдорддрд╛ рджреЗрдВ
* `--cap-add=ALL` рд╕рднреА рдХреНрд╖рдорддрд╛рдПрдВ рджреЗрдВ
* `--cap-drop=ALL --cap-add=SYS_PTRACE` рд╕рднреА рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рд╣рдЯрд╛рдПрдВ рдФрд░ рдХреЗрд╡рд▓ `SYS_PTRACE` рджреЗрдВ

{% hint style="info" %}
рдЖрдорддреМрд░ рдкрд░, рдЬрдм рдЖрдкрдХреЛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░рд┐рдд рдХреНрд╖рдорддрд╛** рдЙрдкрд▓рдмреНрдз рд╣реИ **рдбреЙрдХрд░** рдХрдВрдЯреЗрдирд░ **рдХреЗ рдЕрдВрджрд░** рд▓реЗрдХрд┐рди рдХреБрдЫ рд╣рд┐рд╕реНрд╕рд╛ **рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХрд╛рдо рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИ**, рддреЛ рдпрд╣ рдбреЙрдХрд░ **AppArmor рдЗрд╕реЗ рд░реЛрдХ рд░рд╣рд╛ рд╣реЛрдЧрд╛**ред
{% endhint %}

### рдЙрджрд╛рд╣рд░рдг

(рдпрд╣рд╛рдВ рд╕реЗ рдЙрджрд╛рд╣рд░рдг [**рдпрд╣рд╛рдВ**](https://sreeninet.wordpress.com/2016/03/06/docker-security-part-2docker-engine/) рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ)

AppArmor рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рдирдпрд╛ рдбреЙрдХрд░ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ "mydocker" рдмрдирд╛рдпрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрдВрдХреНрддрд┐ рдЬреЛрдбрд╝реА рд╣реИ:
```
deny /etc/* w,   # deny write for all files directly in /etc (not in a subdir)
```
рдпрджрд┐ рд╣рдо рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреА рд╣реЛрдЧреА:
```
sudo apparmor_parser -r -W mydocker
```
рдпрджрд┐ рд╣рдо рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреА рд╕реВрдЪреА рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдХрдорд╛рдВрдб рдореЗрд░реЗ рдирдП AppArmor рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреА рд╕реВрдЪреА рдмрдирд╛ рд░рд╣реА рд╣реИред
```
$ sudo apparmor_status  | grep mydocker
mydocker
```
рдЬреИрд╕рд╛ рдиреАрдЪреЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╣рдореЗрдВ " /etc/ " рдХреЛ рдмрджрд▓рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдкрд░ рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ AppArmor рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ " /etc/ " рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреА рдкрд╣реБрдВрдЪ рдХреЛ рд░реЛрдХ рд░рд╣рд╛ рд╣реИред
```
$ docker run --rm -it --security-opt apparmor:mydocker -v ~/haproxy:/localhost busybox chmod 400 /etc/hostname
chmod: /etc/hostname: Permission denied
```
### AppArmor Docker Bypass1

рдЖрдк рдпрд╣ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕рд╛ **рдПрдкрд╛рд░реНрдорд░ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛ рд░рд╣рд╛ рд╣реИ** рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░рдХреЗ:
```bash
docker inspect 9d622d73a614 | grep lowpriv
"AppArmorProfile": "lowpriv",
"apparmor=lowpriv"
```
рддрдм, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрдВрдХреНрддрд┐ рдХреЛ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ **рдЙрдкрдпреЛрдЧ рдореЗрдВ рдЖрдиреЗ рд╡рд╛рд▓реА рд╕рдЯреАрдХ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдкрддрд╛ рдЪрд▓ рд╕рдХреЗ**:
```bash
find /etc/apparmor.d/ -name "*lowpriv*" -maxdepth 1 2>/dev/null
```
рдЕрдЬреАрдм рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк **рдПрдкрд╛рд░реНрдорд░ рдбреЙрдХрд░ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдФрд░ рдЗрд╕реЗ рд░реАрд▓реЛрдб рдХрд░рдХреЗ** рдЙрд╕реЗ рдмрд╛рдИрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рд╣рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ "рдмрд╛рдИрдкрд╛рд╕" рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рдПрдкрд╛рд░реНрдорд░ рдбреЙрдХрд░ рдмрд╛рдИрдкрд╛рд╕2

**рдПрдкрд╛рд░реНрдорд░ рдкрд╛рде рдЖрдзрд╛рд░рд┐рдд рд╣реИ**, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрджрд┐ рдпрд╣ **рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реИ** рдЬреИрд╕реЗ рдХрд┐ **`/proc`** рдЬреИрд╕реЗ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рдЕрдВрджрд░, рддреЛ рдпрджрд┐ рдЖрдк **рдХреИрд╕реЗ рдХреЙрдиреНрдЯреЗрдирд░ рдЪрд▓рд╛рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк **рд╣реЛрд╕реНрдЯ рдХреЗ рдкреНрд░реЙрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** **`/host/proc`** рдФрд░ рдЗрд╕реЗ **рдПрдкрд╛рд░реНрдорд░ рджреНрд╡рд╛рд░рд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред

### рдПрдкрд╛рд░реНрдорд░ рд╢реЗрдмреИрдВрдЧ рдмрд╛рдИрдкрд╛рд╕

[**рдЗрд╕ рдмрдЧ**](https://bugs.launchpad.net/apparmor/+bug/1911431) рдореЗрдВ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рдпрджрд┐ рдЖрдк рдХреБрдЫ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд╕рд╛рде рдкрд░реНрд▓ рдХреЛ рд░рди рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХ рд░рд╣реЗ рд╣реИрдВ**, рддреЛ рдпрджрд┐ рдЖрдк рдмрд╕ рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рдореЗрдВ **`#!/usr/bin/perl`** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рд╢реЗрд▓ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдЖрдк **рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕реАрдзреЗ рдЪрд▓рд╛рддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рдЪрд╛рд╣реЗрдВ рдЬреЛ рднреА рдЪрд╛рд╣реЗрдВ рд╡рд╣ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛:
```perl
echo '#!/usr/bin/perl
use POSIX qw(strftime);
use POSIX qw(setuid);
POSIX::setuid(0);
exec "/bin/sh"' > /tmp/test.pl
chmod +x /tmp/test.pl
/tmp/test.pl
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛** рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT рд╕рдВрдЧреНрд░рд╣**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдирд╛ рдпреЛрдЧрджрд╛рди рджреЗрдВред**

</details>
