# euid, ruid, suid

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* –ü—Ä–∞—Ü—é—î—Ç–µ –≤ **–∫—ñ–±–µ—Ä–±–µ–∑–ø–µ—Ü—ñ–≤—ñ–π –∫–æ–º–ø–∞–Ω—ñ—ó**? –•–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks**? –∞–±–æ —Ö–æ—á–µ—Ç–µ –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **–æ—Å—Ç–∞–Ω–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó PEASS –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF**? –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –î—ñ–∑–Ω–∞–π—Ç–µ—Å—è –ø—Ä–æ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** [**üí¨**](https://emojipedia.org/speech-balloon/) [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –º–Ω–æ—é –Ω–∞ **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é hacktricks](https://github.com/carlospolop/hacktricks) —Ç–∞ [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

### –ó–º—ñ–Ω–Ω—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

- **`ruid`**: **–†–µ–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** –≤–∫–∞–∑—É—î –Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π —ñ–Ω—ñ—Ü—ñ—é–≤–∞–≤ –ø—Ä–æ—Ü–µ—Å.
- **`euid`**: –í—ñ–¥–æ–º–∏–π —è–∫ **–µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, –≤—ñ–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –ø—Ä–æ—Ü–µ—Å—É. –ó–∞–≥–∞–ª–æ–º, `euid` –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î `ruid`, –∑–∞ –≤–∏–Ω—è—Ç–∫–æ–º –≤–∏–ø–∞–¥–∫—ñ–≤, –∫–æ–ª–∏ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª SetUID, –¥–µ `euid` –ø—Ä–∏–ø—É—Å–∫–∞—î —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –≤–ª–∞—Å–Ω–∏–∫–∞ —Ñ–∞–π–ª—É, –Ω–∞–¥–∞—é—á–∏ –ø–µ–≤–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω—ñ –¥–æ–∑–≤–æ–ª–∏.
- **`suid`**: –¶–µ–π **–∑–±–µ—Ä–µ–∂–µ–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** —î –∫–ª—é—á–æ–≤–∏–º, –∫–æ–ª–∏ –≤–∏—Å–æ–∫–æ–ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏–π –ø—Ä–æ—Ü–µ—Å (–∑–∞–∑–≤–∏—á–∞–π –∑–∞–ø—É—â–µ–Ω–∏–π —è–∫ root) –ø–æ–≤–∏–Ω–µ–Ω —Ç–∏–º—á–∞—Å–æ–≤–æ –≤—ñ–¥–º–æ–≤–∏—Ç–∏—Å—è –≤—ñ–¥ —Å–≤–æ—ó—Ö –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–µ–≤–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å, –ª–∏—à–µ —â–æ–± –ø—ñ–∑–Ω—ñ—à–µ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —Å–≤–æ–≥–æ –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –ø—ñ–¥–≤–∏—â–µ–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å—É.

#### –í–∞–∂–ª–∏–≤–∞ –ø—Ä–∏–º—ñ—Ç–∫–∞
–ü—Ä–æ—Ü–µ—Å, —è–∫–∏–π –Ω–µ –ø—Ä–∞—Ü—é—î –ø—ñ–¥ root, –º–æ–∂–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —Å–≤—ñ–π `euid`, —â–æ–± –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω–æ–º—É `ruid`, `euid` –∞–±–æ `suid`.

### –†–æ–∑—É–º—ñ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π set*uid

- **`setuid`**: –ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ –ø–æ—á–∞—Ç–∫–æ–≤–∏—Ö –ø—Ä–∏–ø—É—â–µ–Ω—å, `setuid` –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∑–º—ñ–Ω—é—î `euid`, –∞ –Ω–µ `ruid`. –ó–æ–∫—Ä–µ–º–∞, –¥–ª—è –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ –≤—ñ–Ω –≤–∏—Ä—ñ–≤–Ω—é—î `ruid`, `euid` —Ç–∞ `suid` –∑ –≤–∫–∞–∑–∞–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, —á–∞—Å—Ç–æ root, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∑–∞–∫—Ä—ñ–ø–ª—é—é—á–∏ —Ü—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è `suid`. –î–µ—Ç–∞–ª—å–Ω—ñ –≤—ñ–¥–æ–º–æ—Å—Ç—ñ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ [setuid man](https://man7.org/linux/man-pages/man2/setuid.2.html).
- **`setreuid`** —Ç–∞ **`setresuid`**: –¶—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–æ–∑–≤–æ–ª—è—é—Ç—å –¥–æ–∫–ª–∞–¥–Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è `ruid`, `euid` —Ç–∞ `suid`. –û–¥–Ω–∞–∫ —ó—Ö –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∑–∞–ª–µ–∂–∞—Ç—å –≤—ñ–¥ —Ä—ñ–≤–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –ø—Ä–æ—Ü–µ—Å—É. –î–ª—è –ø—Ä–æ—Ü–µ—Å—ñ–≤, —è–∫—ñ –Ω–µ —î root, –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –æ–±–º–µ–∂–µ–Ω—ñ –ø–æ—Ç–æ—á–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ `ruid`, `euid` —Ç–∞ `suid`. –ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ —Ü—å–æ–≥–æ, root-–ø—Ä–æ—Ü–µ—Å–∏ –∞–±–æ —Ç—ñ, —è–∫—ñ –º–∞—é—Ç—å –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å `CAP_SETUID`, –º–æ–∂—É—Ç—å –ø—Ä–∏–∑–Ω–∞—á–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Ü–∏–º —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞–º. –î–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ [setresuid man](https://man7.org/linux/man-pages/man2/setresuid.2.html) —Ç–∞ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ [setreuid man](https://man7.org/linux/man-pages/man2/setreuid.2.html).

–¶—ñ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –Ω–µ —è–∫ –∑–∞—Å—ñ–± –±–µ–∑–ø–µ–∫–∏, –∞ –¥–ª—è –ø–æ–ª–µ–≥—à–µ–Ω–Ω—è –∑–∞–¥—É–º–∞–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –ø—Ä–∏–π–º–∞—î —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å —ñ–Ω—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –∑–º—ñ–Ω—é—é—á–∏ —Å–≤—ñ–π –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

–ó–æ–∫—Ä–µ–º–∞, —Ö–æ—á–∞ `setuid` –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–≥–∞–ª—å–Ω–∏–º –≤–∏–±–æ—Ä–æ–º –¥–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –¥–æ root (–æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –≤–∏—Ä—ñ–≤–Ω—é—î –≤—Å—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ –¥–æ root), –≤–∞–∂–ª–∏–≤–æ —Ä–æ–∑—Ä—ñ–∑–Ω—è—Ç–∏ —Ü—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ç–∞ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è –ø–æ–≤–µ–¥—ñ–Ω–∫–æ—é —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —Ä—ñ–∑–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö.

### –ú–µ—Ö–∞–Ω—ñ–∑–º–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º –≤ Linux

#### **–°–∏—Å—Ç–µ–º–Ω–∏–π –≤–∏–∫–ª–∏–∫ `execve`**
- **–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å**: `execve` –∑–∞–ø—É—Å–∫–∞—î –ø—Ä–æ–≥—Ä–∞–º—É, –≤–∏–∑–Ω–∞—á–µ–Ω—É –ø–µ—Ä—à–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º. –í—ñ–Ω –ø—Ä–∏–π–º–∞—î –¥–≤–∞ –º–∞—Å–∏–≤–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤, `argv` –¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ —Ç–∞ `envp` –¥–ª—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.
- **–ü–æ–≤–µ–¥—ñ–Ω–∫–∞**: –í—ñ–Ω –∑–±–µ—Ä—ñ–≥–∞—î –ø—Ä–æ—Å—Ç—ñ—Ä –ø–∞–º'—è—Ç—ñ –≤–∏–∫–ª–∏–∫–∞—é—á–æ–≥–æ, –∞–ª–µ –æ–Ω–æ–≤–ª—é—î —Å—Ç–µ–∫, –∫—É–ø—É —Ç–∞ —Å–µ–≥–º–µ–Ω—Ç–∏ –¥–∞–Ω–∏—Ö. –ö–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–∏ –∑–∞–º—ñ–Ω—é—î—Ç—å—Å—è –Ω–æ–≤–æ—é –ø—Ä–æ–≥—Ä–∞–º–æ—é.
- **–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**:
- `ruid`, `euid` —Ç–∞ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ –≥—Ä—É–ø –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –Ω–µ–∑–º—ñ–Ω–Ω–∏–º–∏.
- `euid` –º–æ–∂–µ –º–∞—Ç–∏ –Ω—é–∞–Ω—Å–æ–≤—ñ –∑–º—ñ–Ω–∏, —è–∫—â–æ —É –Ω–æ–≤—ñ–π –ø—Ä–æ–≥—Ä–∞–º—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –±—ñ—Ç SetUID.
- `suid` –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –∑ `euid` –ø—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è**: –î–æ–∫–ª–∞–¥–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ [`execve` man](https://man7.org/linux/man-pages/man2/execve.2.html).

#### **–§—É–Ω–∫—Ü—ñ—è `system`**
- **–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å**: –ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ `execve`, `system` —Å—Ç–≤–æ—Ä—é—î –¥–æ—á—ñ—Ä–Ω—ñ–π –ø—Ä–æ—Ü–µ—Å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `fork` —Ç–∞ –≤–∏–∫–æ–Ω—É—î –∫–æ–º–∞–Ω–¥—É –≤ —Ü—å–æ–º—É –¥–æ—á—ñ—Ä–Ω—å–æ–º—É –ø—Ä–æ—Ü–µ—Å—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `execl`.
- **–í–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∏**: –í–∏–∫–æ–Ω—É—î –∫–æ–º–∞–Ω–¥—É —á–µ—Ä–µ–∑ `sh` –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `execl("/bin/sh", "sh", "-c", command, (char *) NULL);`.
- **–ü–æ–≤–µ–¥—ñ–Ω–∫–∞**: –û—Å–∫—ñ–ª—å–∫–∏ `execl` —î —Ñ–æ—Ä–º–æ—é `execve`, –≤—ñ–Ω –ø—Ä–∞—Ü—é—î –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, –∞–ª–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –Ω–æ–≤–æ–≥–æ –¥–æ—á—ñ—Ä–Ω—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É.
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è**: –î–æ–¥–∞—Ç–∫–æ–≤—ñ –≤—ñ–¥–æ–º–æ—Å—Ç—ñ –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ [`system` man](https://man7.org/linux/man-pages/man3/system.3.html).

#### **–ü–æ–≤–µ–¥—ñ–Ω–∫–∞ `bash` —Ç–∞ `sh` –∑ SUID**
- **`bash`**:
- –ú–∞—î –æ–ø—Ü—ñ—é `-p`, —è–∫–∞ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Ç–µ, —è–∫ `euid` —Ç–∞ `ruid` –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –≤ `bash`.
- –ë–µ–∑ `-p` `bash` –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î `euid` –Ω–∞ `ruid`, —è–∫—â–æ –≤–æ–Ω–∏ —Å–ø–æ—á–∞—Ç–∫—É –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è.
- –ó `-p` –ø–æ—á–∞—Ç–∫–æ–≤–∏–π `euid` –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è.
- –î–æ–∫–ª–∞–¥–Ω—ñ—à—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ [`bash` man](https://linux.die.net/man/1/bash).
- **`sh`**:
- –ù–µ –º–∞—î –º–µ—Ö–∞–Ω—ñ–∑–º—É, –ø–æ–¥—ñ–±–Ω–æ–≥–æ –¥–æ `-p` –≤ `bash`.
- –ü–æ–≤–µ–¥—ñ–Ω–∫–∞ —â–æ–¥–æ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–µ –∑–≥–∞–¥—É—î—Ç—å—Å—è —è–≤–Ω–æ, –∑–∞ –≤–∏–Ω—è—Ç–∫–æ–º –æ–ø—Ü—ñ—ó `-i`, —è–∫–∞ –ø—ñ–¥–∫—Ä–µ—Å–ª—é—î –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä—ñ–≤–Ω–æ—Å—Ç—ñ `euid` —Ç–∞ `ruid`.
- –î–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ [`sh` man](https://man7.org/linux/man-pages/man1/sh.1p.html).

–¶—ñ –º–µ—Ö–∞–Ω—ñ–∑–º–∏, –≤—ñ–¥–º—ñ–Ω–Ω—ñ —É —Å–≤–æ—ó–π —Ä–æ–±–æ—Ç—ñ, –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å —à–∏—Ä–æ–∫–∏–π —Å–ø–µ–∫—Ç—Ä –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ—Ö–æ–¥—É –º—ñ–∂ –ø—Ä–æ–≥—Ä–∞–º–∞–º–∏, –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º–∏ –Ω—é–∞–Ω—Å–∞–º–∏ —É –∫–µ—Ä—É–≤–∞–Ω–Ω—ñ —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

–ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∑—è—Ç—ñ –∑ https://0xdf.gitlab.io/2022/05/31/setuid-rabbithole.html#testing-on-jail, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —ó—Ö –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó

#### –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `setuid` –∑ `system`

**–ú–µ—Ç–∞**: –†–æ–∑—É–º—ñ–Ω–Ω—è –µ—Ñ–µ–∫—Ç—É `setuid` –≤ –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ `system` —Ç–∞ `bash` —è–∫ `sh`.

**–ö–æ–¥ –Ω–∞ C**:
```c
#define _GNU_SOURCE
#include <stdlib.h>
#include <unistd.h>

int main(void) {
setuid(1000);
system("id");
return 0;
}
```
**–ö–æ–º–ø—ñ–ª—è—Ü—ñ—è —Ç–∞ –¥–æ–∑–≤–æ–ª–∏:**
```bash
oxdf@hacky$ gcc a.c -o /mnt/nfsshare/a;
oxdf@hacky$ chmod 4755 /mnt/nfsshare/a
```

```bash
bash-4.2$ $ ./a
uid=99(nobody) gid=99(nobody) groups=99(nobody) context=system_u:system_r:unconfined_service_t:s0
```
**–ê–Ω–∞–ª—ñ–∑:**

* `ruid` —Ç–∞ `euid` —Å–ø–æ—á–∞—Ç–∫—É —Ä—ñ–≤–Ω—ñ 99 (nobody) —Ç–∞ 1000 (frank) –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ.
* `setuid` –≤–∏—Ä—ñ–≤–Ω—é—î –æ–±–∏–¥–≤–∞ –Ω–∞ 1000.
* `system` –≤–∏–∫–æ–Ω—É—î `/bin/bash -c id` —á–µ—Ä–µ–∑ —Å–∏–º–≤–æ–ª—ñ—á–Ω–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –∑ sh –Ω–∞ bash.
* `bash`, –±–µ–∑ `-p`, –Ω–∞–ª–∞—à—Ç–æ–≤—É—î `euid` –¥–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ `ruid`, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Ç–æ–≥–æ, —â–æ –æ–±–∏–¥–≤–∞ —Å—Ç–∞—é—Ç—å 99 (nobody).

#### –í–∏–ø–∞–¥–æ–∫ 2: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è setreuid –∑ system

**C –ö–æ–¥**:
```c
#define _GNU_SOURCE
#include <stdlib.h>
#include <unistd.h>

int main(void) {
setreuid(1000, 1000);
system("id");
return 0;
}
```
**–ö–æ–º–ø—ñ–ª—è—Ü—ñ—è —Ç–∞ –¥–æ–∑–≤–æ–ª–∏:**
```bash
oxdf@hacky$ gcc b.c -o /mnt/nfsshare/b; chmod 4755 /mnt/nfsshare/b
```
**–í–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–∞ –†–µ–∑—É–ª—å—Ç–∞—Ç:**
```bash
bash-4.2$ $ ./b
uid=1000(frank) gid=99(nobody) groups=99(nobody) context=system_u:system_r:unconfined_service_t:s0
```
**–ê–Ω–∞–ª—ñ–∑:**

* `setreuid` –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î —è–∫ ruid, —Ç–∞–∫ —ñ euid –Ω–∞ 1000.
* `system` –≤–∏–∫–ª–∏–∫–∞—î bash, —è–∫–∏–π –∑–±–µ—Ä—ñ–≥–∞—î —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —á–µ—Ä–µ–∑ —ó—Ö —Ä—ñ–≤–Ω—ñ—Å—Ç—å, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∞—Ü—é—é—á–∏ —è–∫ frank.

#### –°—Ü–µ–Ω–∞—Ä—ñ–π 3: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è setuid –∑ execve
–ú–µ—Ç–∞: –î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ setuid —Ç–∞ execve.
```bash
#define _GNU_SOURCE
#include <stdlib.h>
#include <unistd.h>

int main(void) {
setuid(1000);
execve("/usr/bin/id", NULL, NULL);
return 0;
}
```
**–í–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–∞ –†–µ–∑—É–ª—å—Ç–∞—Ç:**
```bash
bash-4.2$ $ ./c
uid=99(nobody) gid=99(nobody) euid=1000(frank) groups=99(nobody) context=system_u:system_r:unconfined_service_t:s0
```
**–ê–Ω–∞–ª—ñ–∑:**

* `ruid` –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è 99, –∞–ª–µ euid –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ 1000, –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –µ—Ñ–µ–∫—Ç—É setuid.

**–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É –Ω–∞ –º–æ–≤—ñ C 2 (–í–∏–∫–ª–∏–∫ Bash):**
```bash
#define _GNU_SOURCE
#include <stdlib.h>
#include <unistd.h>

int main(void) {
setuid(1000);
execve("/bin/bash", NULL, NULL);
return 0;
}
```
**–í–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–∞ –†–µ–∑—É–ª—å—Ç–∞—Ç:**
```bash
bash-4.2$ $ ./d
bash-4.2$ $ id
uid=99(nobody) gid=99(nobody) groups=99(nobody) context=system_u:system_r:unconfined_service_t:s0
```
**–ê–Ω–∞–ª—ñ–∑:**

* –•–æ—á–∞ `euid` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ 1000 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `setuid`, `bash` —Å–∫–∏–¥–∞—î euid –Ω–∞ `ruid` (99) —á–µ—Ä–µ–∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å `-p`.

**–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É –Ω–∞ –º–æ–≤—ñ C 3 (–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è bash -p):**
```bash
#define _GNU_SOURCE
#include <stdlib.h>
#include <unistd.h>

int main(void) {
char *const paramList[10] = {"/bin/bash", "-p", NULL};
setuid(1000);
execve(paramList[0], paramList, NULL);
return 0;
}
```
**–í–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–∞ –†–µ–∑—É–ª—å—Ç–∞—Ç:**
```bash
bash-4.2$ $ ./e
bash-4.2$ $ id
uid=99(nobody) gid=99(nobody) euid=100
```
## –ü–æ—Å–∏–ª–∞–Ω–Ω—è
* [https://0xdf.gitlab.io/2022/05/31/setuid-rabbithole.html#testing-on-jail](https://0xdf.gitlab.io/2022/05/31/setuid-rabbithole.html#testing-on-jail)


<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* –í–∏ –ø—Ä–∞—Ü—é—î—Ç–µ –≤ **–∫—ñ–±–µ—Ä–±–µ–∑–ø–µ—Ü—ñ –∫–æ–º–ø–∞–Ω—ñ—ó**? –•–æ—á–µ—Ç–µ, —â–æ–± –≤–∞—à–∞ **–∫–æ–º–ø–∞–Ω—ñ—è —Ä–µ–∫–ª–∞–º—É–≤–∞–ª–∞—Å—è –Ω–∞ HackTricks**? –∞–±–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **–æ—Å—Ç–∞–Ω–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó PEASS –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**? –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** [**üí¨**](https://emojipedia.org/speech-balloon/) [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ –≥—Ä—É–ø–∏ [**telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –º–Ω–æ—é –Ω–∞ **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é hacktricks](https://github.com/carlospolop/hacktricks) —Ç–∞ [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
