<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде</strong>!</summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>


# рд╕рд╛рд░рд╛рдВрд╢

рдЕрдЧрд░ рдЖрдк `/etc/ssh_config` рдпрд╛ `$HOME/.ssh/config` рдореЗрдВ рдЗрд╕ рддрд░рд╣ рдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЦреЛрдЬрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдХреНрдпрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
ForwardAgent yes
```
рдпрджрд┐ рдЖрдк рдорд╢реАрди рдХреЗ рдЕрдВрджрд░ рд░реВрдЯ рд╣реИрдВ рддреЛ рдЖрдк рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ **рдХрд┐рд╕реА рднреА рдПрдЬреЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рдХрд┐рд╕реА рднреА ssh рдХрдиреЗрдХреНрд╢рди рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ рдЖрдк _/tmp_ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ

рдмреЙрдм рдХрд╛ рдПрдХ ssh-рдПрдЬреЗрдВрдЯ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреЙрдм рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВ:
```bash
SSH_AUTH_SOCK=/tmp/ssh-haqzR16816/agent.16816 ssh bob@boston
```
## рдХреНрдпреЛрдВ рдпрд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ?

рдЬрдм рдЖрдк рдЪрд░ `SSH_AUTH_SOCK` рдХреЛ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдмреЙрдм рдХреА рдХреБрдВрдЬреА рддрдХ рдкрд╣реБрдВрдЪ рд░рд╣реЗ рд╣реИрдВ рдЬреЛ рдмреЙрдм рдХреЗ ssh рдХрдиреЗрдХреНрд╢рди рдореЗрдВ рдкреНрд░рдпреЛрдЧ рдХреА рдЧрдИ рд╣реИрдВред рдлрд┐рд░, рдЕрдЧрд░ рдЙрд╕рдХреА рдирд┐рдЬреА рдХреБрдВрдЬреА рд╡рд╣рд╛рдБ рдЕрднреА рднреА рд╣реИ (рд╕рд╛рдорд╛рдиреНрдпрдд: рдпрд╣ рд░рд╣реЗрдЧреА), рддреЛ рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рднреА рд╣реЛрд╕реНрдЯ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреЗрдВрдЧреЗред

рдХреНрдпреЛрдВрдХрд┐ рдирд┐рдЬреА рдХреБрдВрдЬреА рдПрдЬреЗрдВрдЯ рдХреА рдореЗрдореЛрд░реА рдореЗрдВ рдЕрдирдХреНрд░рд┐рдкреНрдЯреЗрдб рд░реВрдк рд╕реЗ рд╕рд╣реЗрдЬреА рдЬрд╛рддреА рд╣реИ, рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрджрд┐ рдЖрдк рдмреЙрдм рд╣реИрдВ рд▓реЗрдХрд┐рди рдЖрдкрдХреЛ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдирд╣реАрдВ рдкрддрд╛ рд╣реИ, рддреЛ рднреА рдЖрдк рдПрдЬ
```
mylaptop:~ env|grep SSH_AUTH_SOCK
SSH_AUTH_SOCK=/tmp/launch-oQKpeY/Listeners

mylaptop:~ ls -l /tmp/launch-oQKpeY/Listeners
srwx------  1 alice  wheel  0 Apr  3 11:04 /tmp/launch-oQKpeY/Listeners
```
[ssh-add](http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-add) рдХрд╛рд░реНрдпрдХреНрд░рдо рд╣рдореЗрдВ рдПрдЬреЗрдВрдЯ рдореЗрдВ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рдФрд░ рдЙрдирдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ:
```
mylaptop:~ alice$ ssh-add -l
2048 2c:2a:d6:09:bb:55:b3:ca:0c:f1:30:f9:d9:a3:c6:9e /Users/alice/.ssh/id_rsa (RSA)
```
рдореЗрд░реЗ рд▓реИрдкрдЯреЙрдк рдореЗрдВ \~/.ssh/config рдореЗрдВ "ForwardAgent yes" рд╣реИред рдЗрд╕рд▓рд┐рдП ssh рдПрдХ рдЯрдирд▓ рдмрдирд╛рдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдЬреЛ рд╕реНрдерд╛рдиреАрдп рд╕реЙрдХреЗрдЯ рдХреЛ рд░рд┐рдореЛрдЯ рд╕рд░реНрд╡рд░ рдкрд░ рд╕реНрдерд╛рдиреАрдп рд╕реЙрдХреЗрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдЧрд╛:
```
mylaptop:~ alice$ ssh seattle

seattle:~ $ env|grep SSH_AUTH_SOCK
SSH_AUTH_SOCK=/tmp/ssh-WsKcHa9990/agent.9990
```
рднрд▓реЗ рд╣реА рдореЗрд░реА рдХреБрдВрдЬреА "рд╕рд┐рдПрдЯрд▓" рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдПрд╕рдПрд╕рдПрдЪ рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЕрднреА рднреА рдореЗрд░реЗ рд╕реНрдерд╛рдиреАрдп рдорд╢реАрди рдкрд░ рдЪрд▓ рд░рд╣реЗ рдПрдЬреЗрдВрдЯ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ:
```
seattle:~ alice $ ssh-add -l
2048 2c:2a:d6:09:bb:55:b3:ca:0c:f1:30:f9:d9:a3:c6:9e /Users/alice/.ssh/id_rsa (RSA)
```
рддреЛ... рд╣рдо рдХрд┐рд╕рдХреЗ рд╕рд╛рде рдЙрд▓рдЭ рд╕рдХрддреЗ рд╣реИрдВ?
```
seattle:~ alice $ who
alice   pts/0        2012-04-06 18:24 (office.example.com)
bob     pts/1        2012-04-03 01:29 (office.example.com)
alice   pts/3        2012-04-06 18:31 (office.example.com)
alice   pts/5        2012-04-06 18:31 (office.example.com)
alice   pts/6        2012-04-06 18:33 (office.example.com)
charlie pts/23       2012-04-06 13:10 (office.example.com)
charlie pts/27       2012-04-03 12:32 (office.example.com)
bob     pts/29       2012-04-02 10:58 (office.example.com)
```
рдореБрдЭреЗ рдХрднреА рднреА рдмреЙрдм рдкрд╕рдВрдж рдирд╣реАрдВ рдерд╛ред рдЙрд╕рдХреА рдПрдЬреЗрдВрдЯ рдХрдиреЗрдХреНрд╢рди рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, рдореБрдЭреЗ рдЙрд╕рдХреЗ ssh рд╕рддреНрд░ рдХреЗ рдПрдХ рдмрдЪреНрдЪрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЦреЛрдЬрдирд╛ рд╣реЛрдЧрд╛:
```
seattle:~ alice $ sudo -s
[sudo] password for alice:

seattle:~ root # pstree -p bob
sshd(16816)тФАтФАтФАbash(16817)

sshd(25296)тФАтФАтФАbash(25297)тФАтФАтФАvim(14308)
```
рдПрдХ рдЪрд▓ рд░рд╣реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╡рд╛рддрд╛рд╡рд░рдг рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд░реВрдЯ рдХреЗ рд▓рд┐рдП рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВред Linux рдкрд░, рдбреЗрдЯрд╛ /proc/<pid>/environ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИред рдпрд╣ NULL-terminated strings рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдореИрдВ NULLs рдХреЛ рдиреНрдпреВрд▓рд╛рдЗрди рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП tr рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реВрдВрдЧрд╛:
```
seattle:~ root # tr '' 'n' < /proc/16817/environ | grep SSH_AUTH_SOCK
SSH_AUTH_SOCK=/tmp/ssh-haqzR16816/agent.16816
```
рдореБрдЭреЗ рдЕрдм рд╡рд╣ рд╕рдм рдХреБрдЫ рдкрддрд╛ рдЪрд▓ рдЧрдпрд╛ рд╣реИ рдЬрд┐рд╕рдХреА рдореБрджреНрд░рд╛рдЧрд╛рд░ рдмреЙрдм рдХреА ssh-agent рдХреЛ рд╣рд╛рдИрдЬреИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:
```
seattle:~ root # SSH_AUTH_SOCK=/tmp/ssh-haqzR16816/agent.16816 ssh-add -l
2048 05:f1:12:f2:e6:ad:cb:0b:60:e3:92:fa:c3:62:19:17 /home/bob/.ssh/id_rsa (RSA)
```
рдпрджрд┐ рдореЗрд░реЗ рдкрд╛рд╕ рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рд▓рдХреНрд╖реНрдп рдХрд╛ рдзреНрдпрд╛рди рд╣реИ, рддреЛ рдореБрдЭреЗ рдЕрдм рд╕реАрдзреЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЕрдиреНрдпрдерд╛, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реВрдЪреА рдХреЛ рджреЗрдЦрдирд╛ рдпрд╛ рдмреЙрдм рдХреЗ рд╣рд┐рд╕реНрдЯреНрд░реА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЧреНрд░реЗрдк рдХрд░рдирд╛ рдмрд╣реБрдд рд╕рд╛рд░реЗ рдЕрд╡рд╕рд░ рдкреНрд░рд╕реНрддреБрдд рдХрд░реЗрдЧрд╛ред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореБрдЭреЗ рдкрддрд╛ рд╣реИ рдХрд┐ рдмреЙрдм рдХреЗ рдкрд╛рд╕ рд╕рд░реНрд╡рд░ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо "рдмреЛрд╕реНрдЯрди" рд╣реИ рдкрд░ рд╡рд┐рднрд┐рдиреНрди рдЧреБрдкреНрдд рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реИрдВред
```
seattle:~ root # SSH_AUTH_SOCK=/tmp/ssh-haqzR16816/agent.16816 ssh bob@boston
bob@boston:~$ whoami
bob
```
## **рдЕрдкрдиреЗ рдЖрдк рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦреЗрдВ!**

рдЕрдкрдиреЗ ssh-agent рдХреЛ рдЕрдкрдиреА рдХреБрдВрдЬреАрдпреЛрдВ рдХреЛ рдЕрдирд┐рд╢реНрдЪрд┐рддрдХрд╛рд▓ рддрдХ рд╕рдВрдЧреНрд░рд╣рд┐рдд рди рдХрд░рдиреЗ рджреЗрдВред OS X рдкрд░, рдЕрдкрдиреЗ Keychain рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдпрддрд╛ рдХреЗ рдмрд╛рдж рдпрд╛ рдЬрдм рдЖрдкрдХреА рд╕реНрдХреНрд░реАрди рд▓реЙрдХ рд╣реЛрддреА рд╣реИ, рдЗрд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВред рдЕрдиреНрдп Unix-y рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдкрд░, ssh-agent рдХреЛ -t рд╡рд┐рдХрд▓реНрдк рдХреЗ рд╕рд╛рде рдкрд╛рд╕ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЗрд╕рдХреА рдХреБрдВрдЬреАрдпрд╛рдБ  рд╕реЗрдХрдВрдб рдХреЗ рдмрд╛рдж рд╣рдЯрд╛ рджреА рдЬрд╛рдПрдВред

рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╣реЛрд╕реНрдЯреНрд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рддреЗ рд╕рдордп рдПрдЬреЗрдВрдЯ рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдХреЛ рд╕рдХреНрд╖рдо рди рдХрд░реЗрдВред рднрд╛рдЧреНрдпрд╢рд╛рд▓реА рд░реВрдк рд╕реЗ, \~/.ssh/config рд╕рд┐рдВрдЯреИрдХреНрд╕ рдЗрд╕реЗ рдмрд╣реБрдд рд╣реА рд╕рд░рд▓ рдмрдирд╛рддрд╛ рд╣реИ:
```
Host trustworthyhost
ForwardAgent yes
```

```
Host *
ForwardAgent no
```
## **рд╕реБрдЭрд╛рд╡рд┐рдд рдкрдарди**

* [OpenSSH рдХреБрдВрдЬреА рдкреНрд░рдмрдВрдзрди](http://www.ibm.com/developerworks/library/l-keyc/index.html) тАУ рдбреЗрдирд┐рдпрд▓ рд░реЙрдмрд┐рдиреНрд╕
* [SSH рдПрдЬреЗрдВрдЯ рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рдЗрд▓рд╕реНрдЯреНрд░реЗрдЯреЗрдб рдЧрд╛рдЗрдб](http://www.unixwiz.net/techtips/ssh-agent-forwarding.html) тАУ рд╕реНрдЯреАрд╡ рдлреНрд░реАрдбрд▓
* [ssh-agent рдореИрдиреБрдЕрд▓](http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-agent)
* [ssh-add рдореИрдиреБрдЕрд▓](http://www.openbsd.org/cgi-bin/man.cgi?query=ssh-add)


<details>

<summary><strong>рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** рдЯреНрд╡рд┐рдЯрд░ рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
