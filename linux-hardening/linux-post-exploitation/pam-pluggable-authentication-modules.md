# PAM - Pluggable Authentication Modules

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

#### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) is a **dark-web** fueled search engine that offers **free** functionalities to check if a company or its customers have been **compromised** by **stealer malwares**.

Their primary goal of WhiteIntel is to combat account takeovers and ransomware attacks resulting from information-stealing malware.

You can check their website and try their engine for **free** at:

{% embed url="https://whiteintel.io" %}

***

### Basic Information

**PAM (Pluggable Authentication Modules)** acts as a security mechanism that **verifies the identity of users attempting to access computer services**, controlling their access based on various criteria. It's akin to a digital gatekeeper, ensuring that only authorized users can engage with specific services while potentially limiting their usage to prevent system overloads.

#### Configuration Files

* **Solaris and UNIX-based systems** typically utilize a central configuration file located at `/etc/pam.conf`.
* **Linux systems** prefer a directory approach, storing service-specific configurations within `/etc/pam.d`. For instance, the configuration file for the login service is found at `/etc/pam.d/login`.

An example of a PAM configuration for the login service might look like this:
```
auth required /lib/security/pam_securetty.so
auth required /lib/security/pam_nologin.so
auth sufficient /lib/security/pam_ldap.so
auth required /lib/security/pam_unix_auth.so try_first_pass
account sufficient /lib/security/pam_ldap.so
account required /lib/security/pam_unix_acct.so
password required /lib/security/pam_cracklib.so
password required /lib/security/pam_ldap.so
password required /lib/security/pam_pwdb.so use_first_pass
session required /lib/security/pam_unix_session.so
```
#### **PAM Management Realms**

–¶—ñ –æ–±–ª–∞—Å—Ç—ñ, –∞–±–æ –≥—Ä—É–ø–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è, –≤–∫–ª—é—á–∞—é—Ç—å **auth**, **account**, **password** —Ç–∞ **session**, –∫–æ–∂–Ω–∞ –∑ —è–∫–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ —Ä—ñ–∑–Ω—ñ –∞—Å–ø–µ–∫—Ç–∏ –ø—Ä–æ—Ü–µ—Å—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å–µ—Å—ñ—è–º–∏:

* **Auth**: –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –æ—Å–æ–±—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —á–∞—Å—Ç–æ –∑–∞–ø–∏—Ç—É—é—á–∏ –ø–∞—Ä–æ–ª—å.
* **Account**: –û–±—Ä–æ–±–ª—è—î –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É, –ø–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏ —É–º–æ–≤–∏, —Ç–∞–∫—ñ —è–∫ —á–ª–µ–Ω—Å—Ç–≤–æ –≤ –≥—Ä—É–ø—ñ –∞–±–æ –æ–±–º–µ–∂–µ–Ω–Ω—è –∑–∞ —á–∞—Å–æ–º –¥–æ–±–∏.
* **Password**: –ö–µ—Ä—É—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º–∏ –ø–∞—Ä–æ–ª—ñ–≤, –≤–∫–ª—é—á–∞—é—á–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ –∞–±–æ –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –∞—Ç–∞–∫–∞–º —Å–ª–æ–≤–Ω–∏–∫—ñ–≤.
* **Session**: –ö–µ—Ä—É—î –¥—ñ—è–º–∏ –ø—ñ–¥ —á–∞—Å –ø–æ—á–∞—Ç–∫—É –∞–±–æ –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è —Å–µ—Å—ñ—ó —Å–ª—É–∂–±–∏, —Ç–∞–∫–∏–º–∏ —è–∫ –º–æ–Ω—Ç—É–≤–∞–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥—ñ–≤ –∞–±–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–±–º–µ–∂–µ–Ω—å —Ä–µ—Å—É—Ä—Å—ñ–≤.

#### **PAM Module Controls**

–ö–æ–Ω—Ç—Ä–æ–ª—ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å —Ä–µ–∞–∫—Ü—ñ—é –º–æ–¥—É–ª—è –Ω–∞ —É—Å–ø—ñ—Ö –∞–±–æ –Ω–µ–≤–¥–∞—á—É, –≤–ø–ª–∏–≤–∞—é—á–∏ –Ω–∞ –∑–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–æ—Ü–µ—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –î–æ –Ω–∏—Ö –≤—ñ–¥–Ω–æ—Å—è—Ç—å—Å—è:

* **Required**: –ù–µ–≤–¥–∞—á–∞ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ–≥–æ –º–æ–¥—É–ª—è –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –æ—Å—Ç–∞—Ç–æ—á–Ω–æ—ó –Ω–µ–≤–¥–∞—á—ñ, –∞–ª–µ –ª–∏—à–µ –ø—ñ—Å–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤—Å—ñ—Ö –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –º–æ–¥—É–ª—ñ–≤.
* **Requisite**: –ù–µ–≥–∞–π–Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø—Ä–æ—Ü–µ—Å—É —É —Ä–∞–∑—ñ –Ω–µ–≤–¥–∞—á—ñ.
* **Sufficient**: –£—Å–ø—ñ—Ö –æ–±—Ö–æ–¥–∏—Ç—å —Ä–µ—à—Ç—É –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ —Ç–æ–≥–æ –∂ —Ä—ñ–≤–Ω—è, —è–∫—â–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –º–æ–¥—É–ª—å –Ω–µ –∑–∞–∑–Ω–∞—î –Ω–µ–≤–¥–∞—á—ñ.
* **Optional**: –í–∏–∫–ª–∏–∫–∞—î –Ω–µ–≤–¥–∞—á—É –ª–∏—à–µ —è–∫—â–æ —Ü–µ —î–¥–∏–Ω–∏–π –º–æ–¥—É–ª—å —É —Å—Ç–µ–∫—É.

#### Example Scenario

–£ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—ñ –∑ –∫—ñ–ª—å–∫–æ–º–∞ –º–æ–¥—É–ª—è–º–∏ auth –ø—Ä–æ—Ü–µ—Å —Å–ª—ñ–¥—É—î —Å—Ç—Ä–æ–≥–æ–º—É –ø–æ—Ä—è–¥–∫—É. –Ø–∫—â–æ –º–æ–¥—É–ª—å `pam_securetty` –≤–∏—è–≤–ª—è—î, —â–æ —Ç–µ—Ä–º—ñ–Ω–∞–ª –¥–ª—è –≤—Ö–æ–¥—É –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π, –≤—Ö—ñ–¥ root –±–ª–æ–∫—É—î—Ç—å—Å—è, –∞–ª–µ –≤—Å—ñ –º–æ–¥—É–ª—ñ –≤—Å–µ —â–µ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è —á–µ—Ä–µ–∑ –π–æ–≥–æ —Å—Ç–∞—Ç—É—Å "required". –ú–æ–¥—É–ª—å `pam_env` –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞, —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –ø–æ–∫—Ä–∞—â—É—î –¥–æ—Å–≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –ú–æ–¥—É–ª—ñ `pam_ldap` —Ç–∞ `pam_unix` –ø—Ä–∞—Ü—é—é—Ç—å —Ä–∞–∑–æ–º –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –ø—Ä–∏—á–æ–º—É `pam_unix` –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ä–∞–Ω—ñ—à–µ –Ω–∞–¥–∞–Ω–∏–π –ø–∞—Ä–æ–ª—å, –ø—ñ–¥–≤–∏—â—É—é—á–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —ñ –≥–Ω—É—á–∫—ñ—Å—Ç—å –º–µ—Ç–æ–¥—ñ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.

### References

* [https://hotpotato.tistory.com/434](https://hotpotato.tistory.com/434)

#### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) —î **dark-web** –ø–æ—à—É–∫–æ–≤–æ—é —Å–∏—Å—Ç–µ–º–æ—é, —è–∫–∞ –ø—Ä–æ–ø–æ–Ω—É—î **–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω—ñ** —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —á–∏ –±—É–ª–∞ –∫–æ–º–ø–∞–Ω—ñ—è –∞–±–æ —ó—ó –∫–ª—ñ—î–Ω—Ç–∏ **–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω—ñ** **stealer malwares**.

–á—Ö–Ω—è –æ—Å–Ω–æ–≤–Ω–∞ –º–µ—Ç–∞ - –±–æ—Ä–æ—Ç–∏—Å—è –∑ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è–º–∏ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ —Ç–∞ –∞—Ç–∞–∫–∞–º–∏ –ø—Ä–æ–≥—Ä–∞–º-–≤–∏–º–∞–≥–∞—á—ñ–≤, —â–æ –≤–∏–Ω–∏–∫–∞—é—Ç—å –≤–Ω–∞—Å–ª—ñ–¥–æ–∫ —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è, —â–æ –∫—Ä–∞–¥–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.

–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —ó—Ö–Ω—ñ–π –≤–µ–±-—Å–∞–π—Ç —ñ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —ó—Ö–Ω—ñ–π –¥–≤–∏–≥—É–Ω **–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ** –∑–∞ –∞–¥—Ä–µ—Å–æ—é:

{% embed url="https://whiteintel.io" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
