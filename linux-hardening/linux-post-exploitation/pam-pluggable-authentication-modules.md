<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Obtén el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **síguenos** en **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>


## Información Básica

**PAM (Módulos de Autenticación Enchufables)** actúa como un mecanismo de seguridad que **verifica la identidad de los usuarios que intentan acceder a los servicios informáticos**, controlando su acceso en función de varios criterios. Es como un portero digital, asegurando que solo los usuarios autorizados puedan interactuar con servicios específicos, al mismo tiempo que potencialmente limita su uso para evitar sobrecargas del sistema.

### Archivos de Configuración

- Los **sistemas Solaris y basados en UNIX** suelen utilizar un archivo de configuración central ubicado en `/etc/pam.conf`.
- Los **sistemas Linux** prefieren un enfoque de directorio, almacenando configuraciones específicas del servicio dentro de `/etc/pam.d`. Por ejemplo, el archivo de configuración para el servicio de inicio de sesión se encuentra en `/etc/pam.d/login`.

Un ejemplo de una configuración PAM para el servicio de inicio de sesión podría verse así:
```text
auth required /lib/security/pam_securetty.so
auth required /lib/security/pam_nologin.so
auth sufficient /lib/security/pam_ldap.so
auth required /lib/security/pam_unix_auth.so try_first_pass
account sufficient /lib/security/pam_ldap.so
account required /lib/security/pam_unix_acct.so
password required /lib/security/pam_cracklib.so
password required /lib/security/pam_ldap.so
password required /lib/security/pam_pwdb.so use_first_pass
session required /lib/security/pam_unix_session.so
```
### **Reinos de Gestión de PAM**

Estos reinos, o grupos de gestión, incluyen **auth**, **account**, **password** y **session**, cada uno responsable de diferentes aspectos del proceso de autenticación y gestión de sesiones:

- **Auth**: Valida la identidad del usuario, a menudo solicitando una contraseña.
- **Account**: Maneja la verificación de la cuenta, verificando condiciones como la membresía a un grupo o restricciones de hora del día.
- **Password**: Gestiona las actualizaciones de contraseñas, incluyendo comprobaciones de complejidad o prevención de ataques de diccionario.
- **Session**: Gestiona acciones durante el inicio o fin de una sesión de servicio, como montar directorios o establecer límites de recursos.

### **Controles de Módulos PAM**

Los controles dictan la respuesta del módulo ante el éxito o el fracaso, influyendo en el proceso de autenticación en general. Estos incluyen:

- **Required**: El fracaso de un módulo requerido resulta en un fracaso eventual, pero solo después de que se verifiquen todos los módulos subsiguientes.
- **Requisite**: Terminación inmediata del proceso al fallar.
- **Sufficient**: El éxito evita el resto de las comprobaciones del mismo reino a menos que falle un módulo subsiguiente.
- **Optional**: Solo causa un fallo si es el único módulo en la pila.

### Escenario de Ejemplo

En una configuración con múltiples módulos de autenticación, el proceso sigue un orden estricto. Si el módulo `pam_securetty` encuentra que el terminal de inicio de sesión no está autorizado, los inicios de sesión de root se bloquean, sin embargo, todos los módulos se procesan debido a su estado "required". El `pam_env` establece variables de entorno, potencialmente ayudando en la experiencia del usuario. Los módulos `pam_ldap` y `pam_unix` trabajan juntos para autenticar al usuario, con `pam_unix` intentando usar una contraseña suministrada previamente, mejorando la eficiencia y flexibilidad en los métodos de autenticación.

# Referencias
* [https://hotpotato.tistory.com/434](https://hotpotato.tistory.com/434)


<details>

<summary><strong>Aprende hacking en AWS de cero a héroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Obtén el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **síguenos** en **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
