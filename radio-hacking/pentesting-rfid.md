# RFID Pentest

<details>

<summary><strong>AWS hackleme becerilerini sıfırdan kahraman seviyesine öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile!</strong></summary>

* Bir **cybersecurity şirketinde** çalışıyor musunuz? **Şirketinizi HackTricks'te reklamını görmek** ister misiniz? veya **PEASS'ın en son sürümüne veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family), özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonunu keşfedin.
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin.
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter**'da takip edin 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Hacking hilelerinizi** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ve** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **göndererek paylaşın**.

</details>

## Giriş

**Radyo Frekansı Tanımlama (RFID)** en popüler kısa menzilli radyo çözümüdür. Genellikle bir varlığı tanımlayan bilgileri depolamak ve iletmek için kullanılır.

Bir RFID etiketi, **kendi güç kaynağına (aktif)**, örneğin gömülü bir pil, veya **alınan radyo dalgalarından indüklenen akımı** kullanarak okuma anteninden güç alabilir (**pasif**).

### Sınıflar

EPCglobal, RFID etiketlerini altı kategoriye ayırır. Her kategorideki bir etiket, önceki kategoride listelenen tüm yeteneklere sahiptir, bu da geriye dönük uyumluluğu sağlar.

* **Sınıf 0** etiketler, **UHF** bantlarında çalışan **pasif** etiketlerdir. Üretim fabrikasında satıcı tarafından **önceden programlanır**. Sonuç olarak, bellekte depolanan bilgileri **değiştiremezsiniz**.
* **Sınıf 1** etiketler ayrıca **HF** bantlarında da çalışabilir. Üretimden sonra sadece bir kez **yazılabilir**. Birçok Sınıf 1 etiket, aldıkları komutların **döngüsel tekrarlı kontrol toplamı** (CRC) işleyebilir. CRC'ler, hata tespiti için komutların sonunda birkaç ekstra bayttır.
* **Sınıf 2** etiketler birden çok kez **yazılabilir**.
* **Sınıf 3** etiketler, etiketin hareketi gibi çevresel parametreleri kaydedebilen **gömülü sensörler** içerebilir. Bu etiketler, entegre bir **pil** gibi bir gömülü güç kaynağına sahip olmalarına rağmen, diğer etiketler veya okuyucularla kablosuz **iletişim başlatamazlar**, bu yüzden **yarı pasif** olarak kabul edilirler.
* **Sınıf 4** etiketler, aynı sınıftaki diğer etiketlerle iletişim başlatabilir, bu da onları **aktif etiketler** yapar.
* **Sınıf 5** etiketler, diğer tüm önceki etiket sınıflarıyla **iletişim kurabilir ve diğer etiketlere güç sağlayabilir**. Sınıf 5 etiketler, **RFID okuyucuları** olarak hareket edebilir.

### RFID Etiketlerinde Depolanan Bilgiler

Bir RFID etiketinin belleği genellikle dört tür veri depolar: etikete bağlı olan **tanımlama verileri** (bu veriler banka hesapları gibi kullanıcı tanımlı alanları içerir); varlığa ilişkin **daha fazla ayrıntı** sağlayan **ek veriler**; etiketin iç **yapılandırması** için kullanılan **kontrol verileri**; ve etiketin **üretimi**, **türü** ve **satıcısı** hakkında bilgiler içeren etiketin **üretici verileri**. İlk iki veri türünü tüm ticari etiketlerde bulabilirsiniz; son iki veri, etiketin satıcısına bağlı olarak farklılık gösterebilir.

ISO standardı, etiketin hangi **nesne türüne** ait olduğunu belirten bir kod olan **Uygulama Ailesi Tanımlayıcısı (AFI)** değerini belirtir. ISO tarafından belirtilen başka bir önemli kayıt ise **Veri Depolama Formatı Tanımlayıcısı (DSFID)**'dir ve bu, kullanıcı verilerinin **mantıksal düzenini** tanımlar.

Çoğu RFID **güvenlik kontrolleri**, her kullanıcı bellek bloğunda ve AFI ve DSFID değerlerini içeren özel kayıtlarda **okuma** veya **yazma** işlemlerini **kısıtlayan** mekanizmalara sahiptir. Bu **kilit** **mekanizmaları**, kontrol bellekte depolanan verileri kullanır ve satıcı tarafından önceden yapılandırılmış **varsayılan parolaları** kullanır, ancak etiket sahiplerinin **özel parolaları yapılandırmasına** izin verir.

### Düşük ve Yüksek Frekanslı Etiket Karşılaştırması

<figure><img src="../.gitbook/assets/image (27).png" alt=""><figcaption></figcaption></figure>

## Düşük Frekanslı RFID Etiketler (125kHz)

**Düşük frekanslı etiketler**, yüksek güvenlik gerektirmeyen sistemlerde sıklıkla kullanılır: bina erişimi, interkom anahtarları, spor salonu üyelik kartları vb. Daha yüksek menzilleri nedeniyle, ücretli otopark için kullanmak pratiktir: sürücü kartı okuyucuya yakın getirmek zorunda kalmaz, çünkü daha uzaktan tetiklenir. Aynı zamanda, düşük frekanslı etiketler çok basittir, veri transfer hızları düşüktür. Bu nedenle, bakiye tutma ve şifreleme gibi karmaşık iki yönlü veri transferini uygulamak imkansızdır. Düşük frekanslı etiketler yalnızca kimlik doğrulama yöntemleri olmadan kısa kimliklerini iletebilir.

Bu cihazlar, **pasif** **RFID** teknolojisine dayanır ve genellikle **30 kHz ila 300 kHz** aralığında çalışır, ancak genellikle 125 kHz ila 134 kHz kullanılır:

* **Uzun Menzil** — düşük frekans, daha uzun menzile dönüşür. Bir metreye kadar mesafeden çalışan bazı EM-Marin ve HID okuyucuları vardır. Bunlar genellikle otoparklarda kullanılır.
* **Basit protokol** — düşük veri transfer hızı nedeniyle bu etiketler yalnızca kısa kimliklerini iletebilir. Çoğu durumda, veri kimlik doğrulanmaz ve herhangi bir şekilde korunmaz. Kart okuyucunun menziline girdiği anda kimlik bilgilerini iletmeye başlar.
* **Düşük güvenlik** — Bu kartlar kolayca kopyalanabilir veya protokolün basitliği nedeniyle başkasının cebinden okunabilir.

**Popüler 125 kHz protokolleri:**

* **EM-Marin** — EM4100, EM4102. CIS'teki en popüler protokol. Basitliği ve kararlılığı nedeniyle bir metreye kadar okunabilir.
* **HID Prox II** — HID Global tarafından tanıtılan düşük frekanslı protokol. Bu protokol batı ülkelerinde daha popülerdir. Daha karmaşıktır ve bu prot
## Yüksek Frekanslı RFID Etiketleri (13.56 MHz)

**Yüksek frekanslı etiketler**, şifreleme, büyük iki yönlü veri transferi, kimlik doğrulama vb. gerektiğinde daha karmaşık bir okuyucu-etiket etkileşimi için kullanılır.\
Genellikle banka kartlarında, toplu taşıma araçlarında ve diğer güvenli geçişlerde bulunur.

**Yüksek frekanslı 13.56 MHz etiketler**, bir dizi standart ve protokol olarak kullanılır. Genellikle [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/) olarak adlandırılır, ancak her zaman doğru değildir. Fiziksel ve mantıksal seviyelerde kullanılan temel protokol seti ISO 14443 olarak adlandırılır. Yüksek seviye protokoller ve ISO 19092 gibi alternatif standartlar da buna dayanır. Birçok insan bu teknolojiyi, 13.56 MHz frekansında çalışan cihazlar için bir terim olan **Yakın Alan İletişimi (NFC)** olarak adlandırır.

<figure><img src="../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

Basitçe söylemek gerekirse, NFC'nin mimarisi şu şekilde çalışır: kartları üreten şirket, iletişim protokolünü seçer ve düşük seviyeli ISO 14443'e dayanarak uygular. Örneğin, NXP kendi yüksek seviye iletişim protokolünü Mifare olarak adlandırır. Ancak alt seviyede Mifare kartları ISO 14443-A standardına dayanır.

Flipper hem düşük seviye ISO 14443 protokolüyle, hem de banka kartlarında kullanılan Mifare Ultralight veri transfer protokolü ve EMV ile etkileşimde bulunabilir. Mifare Classic ve NFC NDEF desteği eklemek üzerinde çalışıyoruz. NFC'yi oluşturan protokol ve standartlara ayrı bir makalede daha detaylı bakmak, ileride yayınlamayı planladığımız bir konudur.

ISO 14443-A standardına dayanan tüm yüksek frekanslı kartlar benzersiz bir çip kimliğine sahiptir. Bu, bir ağ kartının MAC adresi gibi kartın seri numarası olarak işlev görür. **UID genellikle 4 veya 7 bayt uzunluğundadır**, ancak nadiren **10 bayta kadar** çıkabilir. UID'ler gizli değildir ve kolayca okunabilir, **bazen kartın üzerine bile basılır**.

UID'ye dayanan birçok erişim kontrol sistemi, kimlik doğrulama ve erişim sağlamak için kullanılır. Bazen bu, RFID etiketlerinin **şifreleme**yi desteklemesine rağmen **gerçekleşir**. Bu tür **yanlış kullanım**, güvenlik açısından aptal **125 kHz kartlarının** seviyesine indirir. Sanal kartlar (örneğin Apple Pay), telefon sahiplerinin ödeme uygulamasıyla kapıları açmaması için dinamik bir UID kullanır.

* **Düşük menzil** - yüksek frekanslı kartlar, okuyucuya yakın yerleştirilmeleri gereken şekilde özel olarak tasarlanmıştır. Bu aynı zamanda kartı yetkisiz etkileşimlerden korumaya yardımcı olur. Başardığımız maksimum okuma mesafesi yaklaşık 15 cm idi ve bu özel olarak yapılmış yüksek menzilli okuyucularla gerçekleştirildi.
* **Gelişmiş protokoller** - 424 kbps'ye kadar veri transfer hızları, tam teşekküllü iki yönlü veri transferi ile karmaşık protokollere olanak sağlar. Bu da **şifreleme**, veri transferi vb. gibi işlemlere olanak tanır.
* **Yüksek güvenlik** - yüksek frekanslı temasız kartlar, akıllı kartlardan hiçbir şekilde geri kalmaz. AES gibi şifreleme gücü yüksek algoritmalara destek veren ve asimetrik şifrelemeyi uygulayan kartlar bulunmaktadır.

### Saldırı

Bu Etiketlere **Flipper Zero ile saldırabilirsiniz**:

{% content-ref url="../todo/radio-hacking/flipper-zero/fz-nfc.md" %}
[fz-nfc.md](../todo/radio-hacking/flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Veya **proxmark** kullanarak:

{% content-ref url="../todo/radio-hacking/proxmark-3.md" %}
[proxmark-3.md](../todo/radio-hacking/proxmark-3.md)
{% endcontent-ref %}

## Referanslar

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahramana kadar AWS hackleme öğrenin<strong>!</strong></summary>

* Bir **cybersecurity şirketinde mi çalışıyorsunuz**? **Şirketinizi HackTricks'te reklamını yapmak** ister misiniz? veya **PEASS'ın en son sürümüne erişmek veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* Özel [**NFT'lerimizden oluşan PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya **Twitter** 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**'u** takip edin.
* **Hacking hilelerinizi** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ve** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ile göndererek paylaşın.**

</details>
