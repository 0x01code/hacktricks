# Test d'intrusion RFID

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©**? Vous voulez voir votre **entreprise annonc√©e dans HackTricks**? ou voulez-vous avoir acc√®s √† la **derni√®re version du PEASS ou t√©l√©charger HackTricks en PDF**? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Introduction

**L'identification par radiofr√©quence (RFID)** est la solution radio √† courte port√©e la plus populaire. Elle est g√©n√©ralement utilis√©e pour stocker et transmettre des informations qui identifient une entit√©.

Une √©tiquette RFID peut compter sur **sa propre source d'alimentation (active)**, telle qu'une batterie int√©gr√©e, ou recevoir son alimentation de l'antenne de lecture en utilisant le courant **induit par les ondes radio re√ßues** (**passive**).

### Classes

EPCglobal divise les √©tiquettes RFID en six cat√©gories. Une √©tiquette dans chaque cat√©gorie poss√®de toutes les capacit√©s r√©pertori√©es dans la cat√©gorie pr√©c√©dente, ce qui la rend r√©trocompatible.

* Les √©tiquettes de **classe 0** sont des √©tiquettes **passives** qui fonctionnent dans les bandes **UHF**. Le vendeur les **pr√©programme** √† l'usine de production. Par cons√©quent, vous **ne pouvez pas modifier** les informations stock√©es dans leur m√©moire.
* Les √©tiquettes de **classe 1** peuvent √©galement fonctionner dans les bandes **HF**. De plus, elles ne peuvent √™tre **√©crites qu'une seule fois** apr√®s la production. De nombreuses √©tiquettes de classe 1 peuvent √©galement traiter des **contr√¥les de redondance cyclique** (CRC) des commandes qu'elles re√ßoivent. Les CRC sont quelques octets suppl√©mentaires √† la fin des commandes pour la d√©tection d'erreurs.
* Les √©tiquettes de **classe 2** peuvent √™tre **√©crites plusieurs fois**.
* Les √©tiquettes de **classe 3** peuvent contenir des **capteurs int√©gr√©s** qui peuvent enregistrer des param√®tres environnementaux, tels que la temp√©rature actuelle ou le mouvement de l'√©tiquette. Ces √©tiquettes sont **semi-passives**, car bien qu'elles **aient** une source d'alimentation int√©gr√©e, telle qu'une **batterie** int√©gr√©e, elles **ne peuvent pas initier** de **communication** sans fil avec d'autres √©tiquettes ou lecteurs.
* Les √©tiquettes de **classe 4** peuvent initier une communication avec d'autres √©tiquettes de la m√™me classe, ce qui en fait des √©tiquettes **actives**.
* Les √©tiquettes de **classe 5** peuvent fournir **de l'√©nergie √† d'autres √©tiquettes et communiquer avec toutes les classes d'√©tiquettes pr√©c√©dentes**. Les √©tiquettes de classe 5 peuvent agir en tant que **lecteurs RFID**.

### Informations stock√©es dans les √©tiquettes RFID

La m√©moire d'une √©tiquette RFID stocke g√©n√©ralement quatre types de donn√©es : les **donn√©es d'identification**, qui **identifient** l'**entit√©** √† laquelle l'√©tiquette est attach√©e (ces donn√©es incluent des champs d√©finis par l'utilisateur, tels que des comptes bancaires) ; les **donn√©es suppl√©mentaires**, qui fournissent **d'autres** **d√©tails** concernant l'entit√© ; les **donn√©es de contr√¥le**, utilis√©es pour la **configuration interne** de l'√©tiquette ; et les **donn√©es du fabricant** de l'√©tiquette, qui contiennent un Identifiant Unique de l'√©tiquette (**UID**) et des d√©tails concernant la **production**, le **type** et le **vendeur** de l'√©tiquette. Vous trouverez les deux premiers types de donn√©es dans toutes les √©tiquettes commerciales ; les deux derniers peuvent diff√©rer en fonction du vendeur de l'√©tiquette.

La norme ISO sp√©cifie la valeur de l'Identifiant de Famille d'Application (**AFI**), un code qui indique le **type d'objet** auquel l'√©tiquette appartient. Un autre registre important, √©galement sp√©cifi√© par l'ISO, est l'Identifiant de Format de Stockage des Donn√©es (**DSFID**), qui d√©finit l'**organisation logique des donn√©es utilisateur**.

La plupart des **contr√¥les de s√©curit√©** RFID ont des m√©canismes qui **restreignent** les op√©rations de **lecture** ou d'**√©criture** sur chaque bloc m√©moire utilisateur et sur les registres sp√©ciaux contenant les valeurs AFI et DSFID. Ces **m√©canismes de verrouillage** utilisent des donn√©es stock√©es dans la m√©moire de contr√¥le et ont des **mots de passe par d√©faut** pr√©configur√©s par le vendeur mais permettent aux propri√©taires d'√©tiquettes de **configurer des mots de passe personnalis√©s**.

### Comparaison des √©tiquettes √† basse et haute fr√©quence

<figure><img src="../.gitbook/assets/image (27).png" alt=""><figcaption></figcaption></figure>

## √âtiquettes RFID √† basse fr√©quence (125 kHz)

Les **√©tiquettes √† basse fr√©quence** sont souvent utilis√©es dans des syst√®mes qui **ne n√©cessitent pas une s√©curit√© √©lev√©e** : acc√®s aux b√¢timents, cl√©s d'interphone, cartes d'adh√©sion √† une salle de sport, etc. En raison de leur port√©e plus grande, elles sont pratiques pour les parkings payants : le conducteur n'a pas besoin d'approcher la carte du lecteur, car elle est activ√©e de plus loin. En m√™me temps, les √©tiquettes √† basse fr√©quence sont tr√®s primitives, elles ont un faible d√©bit de transfert de donn√©es. Pour cette raison, il est impossible de mettre en ≈ìuvre un transfert de donn√©es bidirectionnel complexe pour des choses telles que le maintien de l'√©quilibre et la cryptographie. Les √©tiquettes √† basse fr√©quence ne transmettent que leur ID court sans aucun moyen d'authentification.

Ces dispositifs reposent sur la technologie **RFID passive** et fonctionnent dans une **plage de 30 kHz √† 300 kHz**, bien qu'il soit plus courant d'utiliser 125 kHz √† 134 kHz :

* **Longue port√©e** ‚Äî une fr√©quence plus basse se traduit par une port√©e plus grande. Il existe des lecteurs EM-Marin et HID, qui fonctionnent √† une distance allant jusqu'√† un m√®tre. Ils sont souvent utilis√©s dans les parkings.
* **Protocole primitif** ‚Äî en raison du faible d√©bit de transfert de donn√©es, ces √©tiquettes ne peuvent transmettre que leur ID court. Dans la plupart des cas, les donn√©es ne sont pas authentifi√©es et ne sont prot√©g√©es d'aucune mani√®re. D√®s que la carte est √† port√©e du lecteur, elle commence simplement √† transmettre son ID.
* **Faible s√©curit√©** ‚Äî ces cartes peuvent √™tre facilement copi√©es, voire lues depuis la poche de quelqu'un d'autre en raison de la primitivit√© du protocole.

**Protocoles populaires √† 125 kHz :**

* **EM-Marin** ‚Äî EM4100, EM4102. Le protocole le plus populaire dans la CEI. Peut √™tre lu √† partir d'environ un m√®tre en raison de sa simplicit√© et de sa stabilit√©.
* **HID Prox II** ‚Äî protocole basse fr√©quence introduit par HID Global. Ce protocole est plus populaire dans les pays occidentaux. Il est plus complexe et les cartes et lecteurs pour ce protocole sont relativement co√ªteux.
* **Indala** ‚Äî tr√®s ancien protocole basse fr√©quence introduit par Motorola, et plus tard acquis par HID. Vous avez moins de chances de le rencontrer dans la nature par rapport aux deux pr√©c√©dents car il est en voie de disparition.

En r√©alit√©, il existe de nombreux autres protocoles √† basse fr√©quence. Mais ils utilisent tous la m√™me modulation sur la couche physique et peuvent √™tre consid√©r√©s, d'une mani√®re ou d'une autre, comme une variation de ceux r√©pertori√©s ci-dessus.

### Attaque

Vous pouvez **attaquer ces √©tiquettes avec le Flipper Zero** :

{% content-ref url="../todo/radio-hacking/flipper-zero/fz-125khz-rfid.md" %}
[fz-125khz-rfid.md](../todo/radio-hacking/flipper-zero/fz-125khz-rfid.md)
{% endcontent-ref %}

## √âtiquettes RFID √† haute fr√©quence (13,56 MHz)

Les **√©tiquettes √† haute fr√©quence** sont utilis√©es pour une interaction lecteur-√©tiquette plus complexe lorsque vous avez besoin de cryptographie, d'un transfert de donn√©es bidirectionnel important, d'authentification, etc.\
On les trouve g√©n√©ralement dans les cartes bancaires, les transports publics et autres passes s√©curis√©es.

**Les √©tiquettes √† haute fr√©quence de 13,56 MHz sont un ensemble de normes et de protocoles**. Elles sont g√©n√©ralement appel√©es [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/), mais ce n'est pas toujours correct. L'ensemble de protocoles de base utilis√© aux niveaux physique et logique est l'ISO 14443. Les protocoles de haut niveau, ainsi que les normes alternatives (comme l'ISO 19092), sont bas√©s sur celui-ci. Beaucoup de gens se r√©f√®rent √† cette technologie comme **Near Field Communication (NFC)**, un terme pour les appareils fonctionnant sur la fr√©quence de 13,56 MHz.

<figure><img src="../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

Pour simplifier, l'architecture du NFC fonctionne comme suit : le protocole de transmission est choisi par l'entreprise fabriquant les cartes et mis en ≈ìuvre sur la base de l'ISO 14443 de bas niveau. Par exemple, NXP a invent√© son propre protocole de transmission de haut niveau appel√© Mifare. Mais au niveau inf√©rieur, les cartes Mifare sont bas√©es sur la norme ISO 14443-A.

Flipper peut interagir √† la fois avec le protocole de transmission ISO 14443 de bas niveau, ainsi qu'avec le protocole de transfert de donn√©es Mifare Ultralight et EMV utilis√© dans les cartes bancaires. Nous travaillons √† ajouter le support pour Mifare Classic et NFC NDEF. Un examen approfondi des protocoles et normes qui composent le NFC vaut un article s√©par√© que nous pr√©voyons de publier ult√©rieurement.

Toutes les cartes √† haute fr√©quence bas√©es sur la norme ISO 14443-A ont un identifiant de puce unique. Il agit comme le num√©ro de s√©rie de la carte, comme l'adresse MAC d'une carte r√©seau. **G√©n√©ralement, l'UID est long de 4 ou 7 octets**, mais peut rarement aller **jusqu'√† 10**. Les UIDs ne sont pas un secret et ils sont facilement lisibles, **parfois m√™me imprim√©s sur la carte elle-m√™me**.

Il existe de nombreux syst√®mes de contr√¥le d'acc√®s qui s'appuient sur l'UID pour **authentifier et accorder l'acc√®s**. Parfois, cela se produit **m√™me** lorsque les √©tiquettes RFID **supportent la cryptographie**. Un tel **mauvais usage** les ram√®ne au niveau des **cartes 125 kHz** en termes de **s√©curit√©**. Les cartes virtuelles (comme Apple Pay) utilisent un UID dynamique pour que les propri√©taires de t√©l√©phones ne puissent pas ouvrir des portes avec leur application de paiement.

* **Courte port√©e** ‚Äî les cartes √† haute fr√©quence sont sp√©cialement con√ßues pour √™tre plac√©es √† proximit√© du lecteur. Cela aide √©galement √† prot√©ger la carte contre les interactions non autoris√©es. La port√©e de lecture maximale que nous avons r√©ussi √† atteindre √©tait d'environ 15 cm, et c'√©tait avec des lecteurs √† longue port√©e fabriqu√©s sur mesure.
* **Protocoles avanc√©s** ‚Äî des vitesses de transfert de donn√©es allant jusqu'√† 424 kbps permettent des protocoles complexes avec un transfert de donn√©es bidirectionnel complet. Ce qui **permet la cryptographie**, le transfert de donn√©es, etc.
* **Haute s√©curit√©** ‚Äî les cartes sans contact √† haute fr√©quence ne sont en aucun cas inf√©rieures aux cartes √† puce. Il existe des cartes qui prennent en charge des algorithmes de chiffrement cryptographiquement forts comme l'AES et mettent en ≈ìuvre la cryptographie asym√©trique.

### Attaque

Vous pouvez **attaquer ces √©tiquettes avec le Flipper Zero** :

{% content-ref url="../todo/radio-hacking/flipper-zero/fz-nfc.md" %}
[fz-nfc.md](../todo/radio-hacking/flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Ou en utilisant le **proxmark** :

{% content-ref url="../todo/radio-hacking/proxmark-3.md" %}
[proxmark-3.md](../todo/radio-hacking/proxmark-3.md)
{% endcontent-ref %}

## R√©f√©rences

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©**? Vous voulez voir votre **entreprise annonc√©e dans HackTricks**? ou voulez-vous avoir acc√®s √† la **derni√®re version du PEASS ou t√©l√©charger HackTricks en PDF**? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
