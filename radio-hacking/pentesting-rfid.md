# Pentesting RFID

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Arbeiten Sie in einem **Cybersecurity-Unternehmen**? M√∂chten Sie Ihr **Unternehmen in HackTricks bewerben**? Oder m√∂chten Sie Zugriff auf die **neueste Version von PEASS oder HackTricks im PDF-Format** haben? √úberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* **Treten Sie der** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie mir auf **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an das** [**hacktricks-Repository**](https://github.com/carlospolop/hacktricks) **und das** [**hacktricks-cloud-Repository**](https://github.com/carlospolop/hacktricks-cloud) **senden**.

</details>

## Einf√ºhrung

**Radio Frequency Identification (RFID)** ist die beliebteste Kurzstrecken-Funkl√∂sung. Es wird normalerweise verwendet, um Informationen zu speichern und zu √ºbertragen, die eine Entit√§t identifizieren.

Ein RFID-Tag kann sich auf **seine eigene Stromquelle (aktiv)**, wie z.B. eine eingebettete Batterie, verlassen oder seine Energie von der Lesenantenne erhalten, indem es den **durch die empfangenen Radiowellen induzierten Strom** (**passiv**) verwendet.

### Klassen

EPCglobal teilt RFID-Tags in sechs Kategorien ein. Ein Tag in jeder Kategorie verf√ºgt √ºber alle in der vorherigen Kategorie aufgef√ºhrten Funktionen, was es abw√§rtskompatibel macht.

* **Klasse 0**-Tags sind **passive** Tags, die in **UHF**-B√§ndern arbeiten. Der Hersteller **programmiert** sie im Produktionswerk vor. Dadurch k√∂nnen Sie die in ihrem Speicher gespeicherten Informationen **nicht √§ndern**.
* **Klasse 1**-Tags k√∂nnen auch in **HF**-B√§ndern arbeiten. Dar√ºber hinaus k√∂nnen sie nach der Produktion **nur einmal beschrieben** werden. Viele Klasse-1-Tags k√∂nnen auch **zyklische Redundanzpr√ºfungen** (CRCs) der empfangenen Befehle verarbeiten. CRCs sind einige zus√§tzliche Bytes am Ende der Befehle zur Fehlererkennung.
* **Klasse 2**-Tags k√∂nnen **mehrmals beschrieben** werden.
* **Klasse 3**-Tags k√∂nnen **eingebettete Sensoren** enthalten, die Umgebungsparameter wie die aktuelle Temperatur oder die Bewegung des Tags erfassen k√∂nnen. Diese Tags sind **halbpassiv**, weil sie zwar √ºber eine eingebettete Stromquelle wie eine integrierte **Batterie** verf√ºgen, aber keine drahtlose **Kommunikation** mit anderen Tags oder Leseger√§ten **initiieren** k√∂nnen.
* **Klasse 4**-Tags k√∂nnen die Kommunikation mit anderen Tags derselben Klasse initiieren, was sie zu **aktiven Tags** macht.
* **Klasse 5**-Tags k√∂nnen **Strom an andere Tags liefern und mit allen vorherigen Tag**-Klassen kommunizieren. Klasse-5-Tags k√∂nnen als **RFID-Leseger√§te** fungieren.

### In RFID-Tags gespeicherte Informationen

Der Speicher eines RFID-Tags speichert in der Regel vier Arten von Daten: die **Identifikationsdaten**, die die **Entit√§t** identifizieren, an die das Tag angebracht ist (diese Daten umfassen benutzerdefinierte Felder wie Bankkonten); die **zus√§tzlichen Daten**, die weitere **Details** zur Entit√§t liefern; die **Steuerungsdaten**, die f√ºr die interne **Konfiguration** des Tags verwendet werden; und die **Herstellerdaten** des Tags, die eine eindeutige Kennung (**UID**) des Tags und Details zur **Produktion**, zum **Typ** und zum **Hersteller** des Tags enthalten. Die ersten beiden Arten von Daten finden Sie in allen kommerziellen Tags; die letzten beiden k√∂nnen je nach Hersteller des Tags unterschiedlich sein.

Der ISO-Standard spezifiziert den Wert des Application Family Identifier (**AFI**), einen Code, der angibt, zu welcher **Art von Objekt** das Tag geh√∂rt. Ein weiteres wichtiges Register, das ebenfalls von ISO spezifiziert wird, ist der Data Storage Format Identifier (**DSFID**), der die **logische Organisation der Benutzerdaten** definiert.

Die meisten RFID-**Sicherheitskontrollen** verf√ºgen √ºber Mechanismen, die die **Lese-** oder **Schreiboperationen** auf jedem Benutzerspeicherblock und auf den speziellen Registern, die die AFI- und DSFID-Werte enthalten, **einschr√§nken**. Diese **Sperrmechanismen** verwenden Daten, die im Steuerspeicher gespeichert sind, und haben **Standardpassw√∂rter**, die vom Hersteller vorkonfiguriert sind, erm√∂glichen es den Tag-Besitzern jedoch, **benutzerdefinierte Passw√∂rter** zu konfigurieren.

### Vergleich von Nieder- und Hochfrequenz-Tags

<figure><img src="../.gitbook/assets/image (27).png" alt=""><figcaption></figcaption></figure>

## Niederfrequenz-RFID-Tags (125 kHz)

**Niederfrequenz-Tags** werden oft in Systemen verwendet, die **keine hohe Sicherheit erfordern**: Geb√§udezugang, Gegensprechanlagen, Fitnessstudio-Mitgliedskarten usw. Aufgrund ihrer gr√∂√üeren Reichweite sind sie bequem f√ºr die Verwendung bei kostenpflichtigem Parken: Der Fahrer muss die Karte nicht nah an das Leseger√§t bringen, da es aus gr√∂√üerer Entfernung ausgel√∂st wird. Gleichzeitig sind Niederfrequenz-Tags sehr primitiv, sie haben eine niedrige Daten√ºbertragungsrate. Aus diesem Grund ist es unm√∂glich, komplexe bidirektionale Daten√ºbertragung f√ºr Dinge wie das F√ºhren von Kontost√§nden und Kryptographie zu implementieren. Niederfrequenz-Tags √ºbertragen nur ihre kurze ID ohne jegliche Authentifizierungsm√∂glichkeiten.

Diese Ger√§te basieren auf der **passiven** **RFID**-Technologie und arbeiten in einem **Frequenzbereich von 30 kHz bis 300 kHz**, obwohl es √ºblicher ist, 125 kHz bis 134 kHz zu verwenden:

* **Gro√üe Reichweite** - eine niedrigere Frequenz bedeutet eine gr√∂√üere Reichweite. Es gibt einige EM-Marin- und HID-Leseger√§te, die aus einer Entfernung von bis zu einem Meter arbeiten. Diese werden oft bei Parkpl√§tzen verwendet.
* **Primitives Protokoll** - aufgrund der niedrigen Daten√ºbertragungsrate k√∂nnen diese Tags nur ihre kurze ID √ºbertragen. In den meisten F√§llen werden die Daten nicht authentifiziert und in keiner Weise gesch√ºtzt. Sobald die Karte im Bereich des Leseger√§ts ist, beginnt sie einfach, ihre ID zu √ºbertragen.
* **Geringe Sicherheit** - Diese Karten k√∂nnen leicht kopiert oder sogar aus der Tasche einer anderen Person gelesen werden, aufgrund der Primitivit√§t des Protokolls.

**Beliebte 125 kHz Protokolle:**

* **EM-Marin** - EM4100, EM4102. Das beliebteste Protokoll in der GUS. Kann aufgrund seiner Einfachheit und Stabilit√§t aus etwa einem Meter Entfernung gelesen werden.
* **HID Prox II** - niederfrequentes Protokoll, das von HID Global eingef√ºhrt wurde. Dieses Protokoll ist in westlichen L√§ndern beliebter. Es ist komplexer und die Karten und Leseger√§te f√ºr dieses Protokoll sind relativ teuer.
* **Indala** - sehr altes niederfrequentes Protokoll, das von Motorola eingef√ºhrt wurde und sp√§ter von HID √ºbernommen wurde. Sie werden es im Vergleich zu den beiden vorherigen Protokollen weniger h√§ufig antreffen, da es an Bedeutung verliert.

In Wirklichkeit gibt es noch viele weitere Niederfrequenz-Protokolle. Aber sie verwenden alle die gleiche Modulation auf der physikalischen Ebene und k√∂nnen in gewisser Weise als Variation der oben aufgef√ºhrten Protokolle betrachtet werden.

### Angriff

Sie k√∂nnen **diese Tags mit dem Flipper Zero** angreifen:

{% content-ref url="../todo/radio-hacking/flipper-zero/fz-125khz-rfid.md" %}
[fz-125khz-rfid.md](../todo/radio-hacking/flipper-zero/fz-125khz-rfid.md)
{% endcontent-ref %}
## Hochfrequente RFID-Tags (13,56 MHz)

**Hochfrequente Tags** werden f√ºr eine komplexere Reader-Tag-Interaktion verwendet, wenn Kryptografie, ein gro√üer bidirektionaler Datentransfer, Authentifizierung usw. erforderlich sind.\
Sie werden normalerweise in Bankkarten, √∂ffentlichen Verkehrsmitteln und anderen sicheren Zug√§ngen verwendet.

**Hochfrequente 13,56 MHz-Tags sind eine Reihe von Standards und Protokollen**. Sie werden normalerweise als [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/) bezeichnet, aber das ist nicht immer korrekt. Der grundlegende Protokollsatz, der auf physischer und logischer Ebene verwendet wird, ist ISO 14443. Hochrangige Protokolle sowie alternative Standards (wie ISO 19092) basieren darauf. Viele Menschen bezeichnen diese Technologie als **Near Field Communication (NFC)**, ein Begriff f√ºr Ger√§te, die √ºber die Frequenz von 13,56 MHz arbeiten.

<figure><img src="../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

Einfach ausgedr√ºckt funktioniert die Architektur von NFC wie folgt: Das √úbertragungsprotokoll wird vom Unternehmen, das die Karten herstellt, ausgew√§hlt und basierend auf dem Low-Level-ISO 14443 implementiert. Zum Beispiel hat NXP sein eigenes hochrangiges √úbertragungsprotokoll namens Mifare erfunden. Aber auf niedrigerer Ebene basieren Mifare-Karten auf dem ISO 14443-A-Standard.

Flipper kann sowohl mit dem Low-Level-ISO 14443-Protokoll als auch mit dem Mifare Ultralight-Datentransferprotokoll und EMV, das in Bankkarten verwendet wird, interagieren. Wir arbeiten daran, Unterst√ºtzung f√ºr Mifare Classic und NFC NDEF hinzuzuf√ºgen. Ein genauer Blick auf die Protokolle und Standards, die NFC ausmachen, ist einen separaten Artikel wert, den wir sp√§ter ver√∂ffentlichen m√∂chten.

Alle hochfrequenten Karten, die auf dem ISO 14443-A-Standard basieren, haben eine eindeutige Chip-ID. Sie fungiert als Seriennummer der Karte, √§hnlich wie die MAC-Adresse einer Netzwerkkarte. **Normalerweise ist die UID 4 oder 7 Bytes lang**, kann aber selten **bis zu 10 Bytes** betragen. UIDs sind kein Geheimnis und lassen sich leicht lesen, **manchmal sogar auf der Karte selbst gedruckt**.

Es gibt viele Zugangskontrollsysteme, die auf der UID basieren, um **Authentifizierung und Zugriff** zu gew√§hren. Manchmal geschieht dies **sogar**, wenn RFID-Tags **Kryptografie unterst√ºtzen**. Eine solche **Fehlverwendung** bringt sie in Bezug auf **Sicherheit** auf die Ebene der dummen **125 kHz-Karten**. Virtuelle Karten (wie Apple Pay) verwenden eine dynamische UID, damit Telefonbesitzer keine T√ºren mit ihrer Zahlungs-App √∂ffnen k√∂nnen.

* **Geringe Reichweite** - Hochfrequente Karten sind speziell so konzipiert, dass sie nahe an den Leser gelegt werden m√ºssen. Dies dient auch dem Schutz der Karte vor unbefugten Interaktionen. Die maximale Lesereichweite, die wir erreichen konnten, betrug etwa 15 cm, und das war mit speziell angefertigten Hochreichweiten-Leseger√§ten.
* **Fortgeschrittene Protokolle** - Daten√ºbertragungsgeschwindigkeiten von bis zu 424 kbps erm√∂glichen komplexe Protokolle mit vollst√§ndigem bidirektionalem Datentransfer. Dies wiederum erm√∂glicht Kryptografie, Datentransfer usw.
* **Hohe Sicherheit** - Hochfrequente kontaktlose Karten sind den Smartcards in keiner Weise unterlegen. Es gibt Karten, die kryptografisch starke Algorithmen wie AES unterst√ºtzen und asymmetrische Kryptografie implementieren.

### Angriff

Sie k√∂nnen diese Tags mit dem Flipper Zero **angreifen**:

{% content-ref url="../todo/radio-hacking/flipper-zero/fz-nfc.md" %}
[fz-nfc.md](../todo/radio-hacking/flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Oder mit dem **proxmark**:

{% content-ref url="../todo/radio-hacking/proxmark-3.md" %}
[proxmark-3.md](../todo/radio-hacking/proxmark-3.md)
{% endcontent-ref %}

## Referenzen

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Arbeiten Sie in einem **Cybersecurity-Unternehmen**? M√∂chten Sie Ihr **Unternehmen in HackTricks bewerben**? Oder m√∂chten Sie Zugriff auf die **neueste Version des PEASS oder HackTricks als PDF herunterladen**? √úberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* **Treten Sie der** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder folgen Sie mir auf **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an das** [**hacktricks-Repo**](https://github.com/carlospolop/hacktricks) **und das** [**hacktricks-cloud-Repo**](https://github.com/carlospolop/hacktricks-cloud) **senden**.

</details>
