<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ PRs рдЬрдорд╛ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ.

</details>


# рдкрд░рд┐рдЪрдп

Bluetooth 4.0 рд╕реНрдкреЗрд╕рд┐рдлрд┐рдХреЗрд╢рди рдХреЗ рдмрд╛рдж рд╕реЗ рдЙрдкрд▓рдмреНрдз, BLE рдХреЗрд╡рд▓ 40 рдЪреИрдирд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ 2400 рд╕реЗ 2483.5 MHz рдХреА рд░реЗрдВрдЬ рдХреЛ рдХрд╡рд░ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд, рдкрд╛рд░рдВрдкрд░рд┐рдХ Bluetooth рдЙрд╕реА рд░реЗрдВрдЬ рдореЗрдВ 79 рдЪреИрдирд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

BLE рдбрд┐рд╡рд╛рдЗрд╕реЗрд╕ **рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреИрдХреЗрдЯреНрд╕** (**рдмреАрдХрдиреНрд╕**) рднреЗрдЬрдХрд░ рд╕рдВрд╡рд╛рдж рдХрд░рддреЗ рд╣реИрдВ, рдпреЗ рдкреИрдХреЗрдЯреНрд╕ рдЕрдиреНрдп рдирдЬрджреАрдХреА рдбрд┐рд╡рд╛рдЗрд╕реЗрд╕ рдХреЛ BLE рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдЕрд╕реНрддрд┐рддреНрд╡ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдпреЗ рдмреАрдХрдиреНрд╕ рдХрднреА-рдХрднреА **рдбреЗрдЯрд╛ рднреА рднреЗрдЬрддреЗ рд╣реИрдВ**ред

рд╕реБрдирдиреЗ рд╡рд╛рд▓реА рдбрд┐рд╡рд╛рдЗрд╕, рдЬрд┐рд╕реЗ рдХреЗрдВрджреНрд░реАрдп рдбрд┐рд╡рд╛рдЗрд╕ рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреИрдХреЗрдЯ рдХреЗ рдЬрд╡рд╛рдм рдореЗрдВ рдПрдХ **SCAN рдЕрдиреБрд░реЛрдз** рднреЗрдЬ рд╕рдХрддреА рд╣реИ рдЬреЛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд▓рд┐рдП рд╣реЛрддреА рд╣реИред рдЙрд╕ рд╕реНрдХреИрди рдХрд╛ **рдЙрддреНрддрд░** рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреИрдХреЗрдЯ рдХреА рд╕рдорд╛рди рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рдЬреЛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдЕрдиреБрд░реЛрдз рдореЗрдВ рдлрд┐рдЯ рдирд╣реАрдВ рд╣реЛ рдкрд╛рддреА, рдЬреИрд╕реЗ рдХрд┐ рдкреВрд░рд╛ рдбрд┐рд╡рд╛рдЗрд╕ рдирд╛рдоред

![](<../.gitbook/assets/image (201) (2) (1) (1).png>)

рдкреНрд░реАрдПрдореНрдмрд▓ рдмрд╛рдЗрдЯ рдлреНрд░реАрдХреНрд╡реЗрдВрд╕реА рдХреЛ рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝ рдХрд░рддреА рд╣реИ, рдЬрдмрдХрд┐ рдЪрд╛рд░-рдмрд╛рдЗрдЯ рдПрдХреНрд╕реЗрд╕ рдПрдбреНрд░реЗрд╕ рдПрдХ **рдХрдиреЗрдХреНрд╢рди рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛** рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрди рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдПрдХ рд╣реА рдЪреИрдирд▓реЛрдВ рдкрд░ рдХрдИ рдбрд┐рд╡рд╛рдЗрд╕реЗрд╕ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реЛрддреЗ рд╣реИрдВред рдЕрдЧрд▓рд╛, рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдбреЗрдЯрд╛ рдпреВрдирд┐рдЯ (**PDU**) **рд╡рд┐рдЬреНрдЮрд╛рдкрди рдбреЗрдЯрд╛** рд╕рдореЗрдЯреЗ рд╣реБрдП рд╣реЛрддрд╛ рд╣реИред PDU рдХреЗ рдХрдИ рдкреНрд░рдХрд╛рд░ рд╣реЛрддреЗ рд╣реИрдВ; рд╕рдмрд╕реЗ рдЖрдо рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ ADV\_NONCONN\_IND рдФрд░ ADV\_IND рд╣реИрдВред рдбрд┐рд╡рд╛рдЗрд╕реЗрд╕ **ADV\_NONCONN\_IND** PDU рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдпрджрд┐ рд╡реЗ **рдХрдиреЗрдХреНрд╢рди рд╕реНрд╡реАрдХрд╛рд░ рдирд╣реАрдВ рдХрд░рддреЗ**, рдХреЗрд╡рд▓ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреИрдХреЗрдЯ рдореЗрдВ рдбреЗрдЯрд╛ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдбрд┐рд╡рд╛рдЗрд╕реЗрд╕ **ADV\_IND** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдпрджрд┐ рд╡реЗ **рдХрдиреЗрдХреНрд╢рди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ** рдФрд░ рдПрдХ **рдХрдиреЗрдХреНрд╢рди** рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж **рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреИрдХреЗрдЯреНрд╕ рднреЗрдЬрдирд╛ рдмрдВрдж рдХрд░ рджреЗрддреЗ рд╣реИрдВ**ред

## GATT

**рдЬреЗрдиреЗрд░рд┐рдХ рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдкреНрд░реЛрдлрд╛рдЗрд▓** (GATT) рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ **рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдбреЗрдЯрд╛ рдХреЛ рдХреИрд╕реЗ рдлреЙрд░реНрдореЗрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЯреНрд░рд╛рдВрд╕рдлрд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП**ред рдЬрдм рдЖрдк BLE рдбрд┐рд╡рд╛рдЗрд╕ рдХреА рдЕрдЯреИрдХ рд╕рд░рдлреЗрд╕ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░ рд░рд╣реЗ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЕрдХреНрд╕рд░ рдЕрдкрдирд╛ рдзреНрдпрд╛рди GATT (рдпрд╛ GATTs) рдкрд░ рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣реАрдВ рд╕реЗ **рдбрд┐рд╡рд╛рдЗрд╕ рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддреА рд╣реИ** рдФрд░ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд, рд╕рдореВрд╣рд┐рдд рдФрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред GATT рдПрдХ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдбрд┐рд╡рд╛рдЗрд╕ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ, рд╡рд┐рд╡рд░рдгрдХреЛрдВ, рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ 16- рдпрд╛ 32-рдмрд┐рдЯреНрд╕ рдорд╛рдиреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИред рдПрдХ **рд╡рд┐рд╢реЗрд╖рддрд╛** рдПрдХ **рдбреЗрдЯрд╛** рдорд╛рди рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдХреЗрдВрджреНрд░реАрдп рдбрд┐рд╡рд╛рдЗрд╕ рдФрд░ рдкрд░рд┐рдзреАрдп рдХреЗ рдмреАрдЪ **рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдЗрди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдореЗрдВ **рд╡рд┐рд╡рд░рдгрдХ** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ **рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ**ред **рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ** рдЕрдХреНрд╕рд░ **рд╕реЗрд╡рд╛рдУрдВ** рдореЗрдВ **рд╕рдореВрд╣рд┐рдд** рдХреА рдЬрд╛рддреА рд╣реИрдВ рдпрджрд┐ рд╡реЗ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХрд░рдиреЗ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрддреА рд╣реИрдВред

# рд╕реВрдЪреАрдХрд░рдг
```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```
## GATTool

**GATTool** рджреВрд╕рд░реЗ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд╕рд╛рде **рд╕рдВрдмрдВрдз** рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ, рдЙрд╕ рдбрд┐рд╡рд╛рдЗрд╕ рдХреА **рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ** рдХреА рд╕реВрдЪреА рдмрдирд╛рдиреЗ, рдФрд░ рдЙрд╕рдХреЗ рдЧреБрдгреЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рдФрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред\
GATTTool `-I` рд╡рд┐рдХрд▓реНрдк рдХреЗ рд╕рд╛рде рдПрдХ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рд╢реЗрд▓ рд╢реБрд░реВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```
## Bettercap
```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```
<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВ.

</details>
