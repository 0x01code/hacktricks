<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>


# Introdu√ß√£o

Dispon√≠vel desde a especifica√ß√£o Bluetooth 4.0, o BLE usa apenas 40 canais, cobrindo a faixa de 2400 a 2483,5 MHz. Em contraste, o Bluetooth tradicional usa 79 canais nessa mesma faixa.

Os dispositivos BLE se comunicam enviando **pacotes de publicidade** (**beacons**), esses pacotes transmitem a exist√™ncia do dispositivo BLE para outros dispositivos pr√≥ximos. Esses beacons √†s vezes **enviam dados** tamb√©m.

O dispositivo ouvinte, tamb√©m chamado de dispositivo central, pode responder a um pacote de publicidade com uma **solicita√ß√£o de SCAN** enviada especificamente ao dispositivo anunciante. A **resposta** a esse scan usa a mesma estrutura do **pacote de publicidade** com informa√ß√µes adicionais que n√£o puderam ser inclu√≠das na solicita√ß√£o de publicidade inicial, como o nome completo do dispositivo.

![](<../.gitbook/assets/image (201) (2) (1) (1).png>)

O byte de pre√¢mbulo sincroniza a frequ√™ncia, enquanto o endere√ßo de acesso de quatro bytes √© um **identificador de conex√£o**, que √© usado em cen√°rios onde v√°rios dispositivos est√£o tentando estabelecer conex√µes nos mesmos canais. Em seguida, a Unidade de Dados do Protocolo (**PDU**) cont√©m os **dados de publicidade**. Existem v√°rios tipos de PDU; os mais comumente usados s√£o ADV\_NONCONN\_IND e ADV\_IND. Os dispositivos usam o tipo de PDU **ADV\_NONCONN\_IND** se eles **n√£o aceitam conex√µes**, transmitindo dados apenas no pacote de publicidade. Os dispositivos usam **ADV\_IND** se eles **permitem conex√µes** e **param de enviar pacotes de publicidade** uma vez que uma **conex√£o** tenha sido **estabelecida**.

## GATT

O **Perfil de Atributo Gen√©rico** (GATT) define como o **dispositivo deve formatar e transferir dados**. Ao analisar a superf√≠cie de ataque de um dispositivo BLE, voc√™ frequentemente concentrar√° sua aten√ß√£o no GATT (ou GATTs), porque √© assim que a **funcionalidade do dispositivo √© acionada** e como os dados s√£o armazenados, agrupados e modificados. O GATT lista as caracter√≠sticas, descritores e servi√ßos de um dispositivo em uma tabela como valores de 16 ou 32 bits. Uma **caracter√≠stica** √© um **valor de dados** **enviado** entre o dispositivo central e perif√©rico. Essas caracter√≠sticas podem ter **descritores** que **fornecem informa√ß√µes adicionais sobre elas**. **Caracter√≠sticas** s√£o frequentemente **agrupadas** em **servi√ßos** se estiverem relacionadas √† realiza√ß√£o de uma a√ß√£o espec√≠fica.

# Enumera√ß√£o
```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```
## GATTool

**GATTool** permite **estabelecer** uma **conex√£o** com outro dispositivo, listar as **caracter√≠sticas** desse dispositivo e ler e escrever seus atributos.\
GATTTool pode iniciar um shell interativo com a op√ß√£o `-I`:
```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```
## Bettercap
```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```
<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
