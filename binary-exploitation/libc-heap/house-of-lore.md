# House of Lore | Küçük Bin Saldırısı

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini alın**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı göndererek HackTricks ve HackTricks Cloud** github depolarına PR gönderin.

</details>

## Temel Bilgiler

### Kod

* [https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/) adresinden kontrol edin
* Bu çalışmıyor
* Veya: [https://github.com/shellphish/how2heap/blob/master/glibc\_2.39/house\_of\_lore.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.39/house\_of\_lore.c)
* Bu, bazı kontrolleri atlamaya çalışsa da çalışmıyor ve hata alıyor: `malloc(): unaligned tcache chunk detected`
* Bu örnek hala çalışıyor**:** [**https://guyinatuxedo.github.io/40-house\_of\_lore/house\_lore\_exp/index.html**](https://guyinatuxedo.github.io/40-house\_of\_lore/house\_lore\_exp/index.html)&#x20;

### Amaç

* **Küçük bir parça ekleyerek sahte küçük parçayı yerleştirin ve ardından onu ayırabilirsiniz**.\
Eklenen küçük parça sahte olan, saldırganın rastgele bir konumda oluşturduğu değil.

### Gereksinimler

* 2 sahte parça oluşturun ve bunları birbirine ve meşru parçaya bağlayın:
* `sahte0.bk` -> `sahte1`
* `sahte1.fd` -> `sahte0`
* `sahte0.fd` -> `meşru` (başka bir zayıflık aracılığıyla serbest bırakılan küçük parça içindeki bir işaretçiyi değiştirmeniz gerekir)
* `meşru.bk` -> `sahte0`

Böylece `sahte0`'ı ayırabilirsiniz.

### Saldırı

* Küçük bir parça (`meşru`) ayrıldıktan sonra, üst parçayla birleşmesini önlemek için başka bir parça ayrılır. Daha sonra, meşru serbest bırakılır (onu sıralanmamış listeye taşır) ve daha büyük bir parça ayrılır, **`meşru`'yu küçük bine taşır.**
* Bir saldırgan birkaç sahte küçük parça oluşturur ve geçerlilik kontrollerini atlamak için gerekli bağlantıları yapar:
* `sahte0.bk` -> `sahte1`
* `sahte1.fd` -> `sahte0`
* `sahte0.fd` -> `meşru` (başka bir zayıflık aracılığıyla serbest bırakılan küçük parça içindeki bir işaretçiyi değiştirmeniz gerekir)
* `meşru.bk` -> `sahte0`
* Meşru alınmak üzere küçük bir parça ayrılır, **`sahte0`**'ı küçük parça listesinin üstüne taşır
* Başka bir küçük parça ayrılır, sahte0'ı bir parça olarak alır, potansiyel olarak içindeki işaretçileri okuma/yazma izni verir.

## Referanslar

* [https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/)
* [https://heap-exploitation.dhavalkapil.com/attacks/house\_of\_lore](https://heap-exploitation.dhavalkapil.com/attacks/house\_of\_lore)
* [https://guyinatuxedo.github.io/40-house\_of\_lore/house\_lore\_exp/index.html](https://guyinatuxedo.github.io/40-house\_of\_lore/house\_lore\_exp/index.html)
