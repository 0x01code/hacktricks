# House of Lore | Küçük Bin Saldırısı

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana dönüşün</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile öğrenin!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı paylaşarak PR göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>

## Temel Bilgiler

### Kod

* [https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/) adresinden kontrol edin
* Bu çalışmıyor
* Veya: [https://github.com/shellphish/how2heap/blob/master/glibc\_2.39/house\_of\_lore.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.39/house\_of\_lore.c)
* Bu, bazı kontrolleri atlamaya çalışsa da çalışmıyor ve hata alınıyor: `malloc(): unaligned tcache chunk detected`
* Bu örnek hala çalışıyor: [**https://guyinatuxedo.github.io/40-house\_of\_lore/house\_lore\_exp/index.html**](https://guyinatuxedo.github.io/40-house\_of\_lore/house\_lore\_exp/index.html)&#x20;

### Amaç

* **Küçük bir parça ekleyerek sahte bir küçük parçayı yerleştirin ve ardından onu ayırabilir hale getirin**.\
Eklenen küçük parça, saldırganın oluşturduğu sahte parçadır ve rastgele bir konumda sahte değildir.

### Gereksinimler

* 2 sahte parça oluşturun ve bunları birbirine ve meşru parçaya bağlayın:
* `sahte0.bk` -> `sahte1`
* `sahte1.fd` -> `sahte0`
* `sahte0.fd` -> `meşru` (başka bir zayıflıktan dolayı serbest bırakılan küçük parça içindeki bir işaretçiyi değiştirmeniz gerekmektedir)
* `meşru.bk` -> `sahte0`

Böylece `sahte0`'ı tahsis edebileceksiniz.

### Saldırı

* Bir küçük parça (`meşru`) tahsis edilir, ardından üst parçayla birleşmesini önlemek için başka bir parça tahsis edilir. Daha sonra, `meşru` serbest bırakılır (onu sıralanmamış kova listesine taşır) ve daha büyük bir parça tahsis edilir, **`meşru`'yu küçük kovaya taşır.**
* Bir saldırgan birkaç sahte küçük parça oluşturur ve gerekli bağlantıları yaparak sağlamlık kontrollerini atlar:
* `sahte0.bk` -> `sahte1`
* `sahte1.fd` -> `sahte0`
* `sahte0.fd` -> `meşru` (başka bir zayıflıktan dolayı serbest bırakılan küçük parça içindeki bir işaretçiyi değiştirmeniz gerekmektedir)
* `meşru.bk` -> `sahte0`
* Meşru almak için bir küçük parça tahsis edilir, **`sahte0`**'ı küçük kova listesinin üstüne taşır
* Başka bir küçük parça tahsis edilir, `sahte0`'ı bir parça olarak alarak, içindeki işaretçilere okuma/yazma yapma olasılığı sağlar.

## Referanslar

* [https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/)
* [https://heap-exploitation.dhavalkapil.com/attacks/house\_of\_lore](https://heap-exploitation.dhavalkapil.com/attacks/house\_of\_lore)
* [https://guyinatuxedo.github.io/40-house\_of\_lore/house\_lore\_exp/index.html](https://guyinatuxedo.github.io/40-house\_of\_lore/house\_lore\_exp/index.html)
