# рдмрд┐рдиреНрд╕ рдФрд░ рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди

<details>

<summary><strong>рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

рдЪрдВрдХреНрд╕ рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреА рдХреБрд╢рд▓рддрд╛ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рд░ рдЪрдВрдХреНрд╕ рдХреЗрд╡рд▓ рдПрдХ рд▓рд┐рдВрдХреНрдб рд╕реВрдЪреА рдореЗрдВ рдирд╣реАрдВ рд╣реИ, рдмрд▓реНрдХрд┐ рдХрдИ рдкреНрд░рдХрд╛рд░ рд╣реИрдВред рдпреЗ рдмрд┐рдиреНрд╕ рд╣реИрдВ рдФрд░ 5 рдкреНрд░рдХрд╛рд░ рдХреЗ рдмрд┐рдиреНрд╕ рд╣реИрдВ: [62](https://sourceware.org/git/gitweb.cgi?p=glibc.git;a=blob;f=malloc/malloc.c;h=6e766d11bc85b6480fa5c9f2a76559f8acf9deb5;hb=HEAD#l1407) small bins, 63 large bins, 1 unsorted bin, 10 fast bins рдФрд░ 64 tcache bins рдкреНрд░рддрд┐ рдереНрд░реЗрдбред

рдкреНрд░рддреНрдпреЗрдХ рдЕрдирд╕реЙрд░реНрдЯреЗрдб, small рдФрд░ large bins рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкрддрд╛ рдПрдХ рд╣реА рдПрд░реЗ рдореЗрдВ рд╣реИред рдЗрдВрдбреЗрдХреНрд╕ 0 рдЕрдкреНрд░рдпреБрдХреНрдд рд╣реИ, 1 рдЕрдирд╕реЙрд░реНрдЯреЗрдб рдмрд┐рди рд╣реИ, рдмрд┐рди 2-64 small bins рд╣реИрдВ рдФрд░ рдмрд┐рди 65-127 large bins рд╣реИрдВред

### Small Bins

Small bins large bins рд╕реЗ рддреЗрдЬ рд╣реЛрддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди fast bins рд╕реЗ рдзреАрдореЗ рд╣реЛрддреЗ рд╣реИрдВред

62 рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдмрд┐рди рдореЗрдВ **рдПрдХ рд╣реА рдЖрдХрд╛рд░ рдХреЗ рдЪрдВрдХреНрд╕** рд╣реЛрдВрдЧреЗ: 16, 24, ... (32 рдмрд┐рдЯреНрд╕ рдореЗрдВ 504 рдмрд╛рдЗрдЯ рддрдХ рдФрд░ 64 рдмрд┐рдЯреНрд╕ рдореЗрдВ 1024 рддрдХ рдХрд╛ рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░)ред рдпрд╣ рдЗрд╕рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЬрдЧрд╣ рдХреЛ рдХрд╣рд╛рдБ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЗрди рд╕реВрдЪрд┐рдпреЛрдВ рдкрд░ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдФрд░ рд╣рдЯрд╛рдиреЗ рдХреА рдЧрддрд┐ рдореЗрдВред

### Large Bins

Small bins рдХреА рд╡рд┐рдкрд░реАрдд, рдЬреЛ рдирд┐рд╢реНрдЪрд┐рдд рдЖрдХрд╛рд░реЛрдВ рдХреЗ рдЪрдВрдХреНрд╕ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рддреЗ рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ **large bin рдПрдХ рдЪрдВрдХ рд╕рд╛рдЗрдЬ рдХреА рд╢реНрд░реЗрдгреА рдХрд╛ рдкреНрд░рдмрдВрдзрди** рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЕрдзрд┐рдХ рд▓рдЪреАрд▓рд╛ рд╣реИ, рд╡рд┐рднрд┐рдиреНрди рдЖрдХрд╛рд░реЛрдВ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд▓рдЧ рдмрд┐рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред

рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрдХ, large bins small bins рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдкрд░ рд╢реБрд░реВ рд╣реЛрддреЗ рд╣реИрдВред Large bins рдХреЗ рд▓рд┐рдП рд╢реНрд░реЗрдгрд┐рдпрд╛рдВ рдкреНрд░рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рдмрдврд╝рддреА рд╣реИрдВ, рдЕрд░реНрдерд╛рдд рдкрд╣рд▓рд╛ рдмрд┐рди 512 рд╕реЗ 576 рдмрд╛рдЗрдЯ рддрдХ рдХреЗ рдЪрдВрдХреНрд╕ рдХреЛ рдХрд╡рд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЕрдЧрд▓рд╛ 576 рд╕реЗ 640 рдмрд╛рдЗрдЯ рдХреЛ рдХрд╡рд░ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдкреИрдЯрд░реНрди рдЬрд╛рд░реА рд░рд╣рддрд╛ рд╣реИ, рд╕рдмрд╕реЗ рдмрдбрд╝рд╛ рдмрд┐рди 1MB рд╕реЗ рдКрдкрд░ рдХреЗ рд╕рднреА рдЪрдВрдХреНрд╕ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред

Large bins small bins рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдзреАрдореЗ рд╣реЛрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЙрдиреНрд╣реЗрдВ **рдПрдХ рд╕реВрдЪреА рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдЪрдВрдХ рд╕рд╛рдЗрдЬ рдХреА рдЦреЛрдЬ рдФрд░ рдХреНрд░рдордмрджреНрдз рдХрд░рдирд╛** рд╣реЛрддрд╛ рд╣реИ рдПрдХ рдЖрд╡рдВрдЯрди рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡реЛрддреНрддрдо рдореЗрд▓ рдХреЛ рдвреВрдВрдврдиреЗ рдХреЗ рд▓рд┐рдПред рдЬрдм рдПрдХ рдЪрдВрдХ large bin рдореЗрдВ рдбрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рдХреНрд░рдордмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рдЬрдм рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╕рд╣реА рдЪрдВрдХ рдвреВрдВрдврдирд╛ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рдо рдЙрдиреНрд╣реЗрдВ **рдзреАрдорд╛** рдмрдирд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреНрдпреЛрдВрдХрд┐ рдмрдбрд╝реА рдЖрд╡рдВрдЯрди рдЫреЛрдЯреЗ рд╕реЗ рдХрдо рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕реЗ рд╕реНрд╡реАрдХрд╛рд░реНрдп рд╡реНрдпрд╛рдкрд╛рд░ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

рд╣реИрдВ:

* 64B рд░реЗрдВрдЬ рдХреЗ 32 рдмрд┐рдиреНрд╕
* 512B рд░реЗрдВрдЬ рдХреЗ 16 рдмрд┐рдиреНрд╕
* 4096B рд░реЗрдВрдЬ рдХреЗ 8 рдмрд┐рдиреНрд╕
* 4рдмрд┐рдиреНрд╕ рдХрд╛ 32768рдмреА рд░реЗрдВрдЬ
* 2рдмрд┐рдиреНрд╕ рдХрд╛ 262144рдмреА рд░реЗрдВрдЬ
* 1рдмрд┐рдиреНрд╕ рдмрдЪреА рд╣реБрдИ рд╕рд╛рдЗрдЬрд╝ рдХреЗ рд▓рд┐рдП

### рдЕрдирд╕реЙрд░реНрдЯреЗрдб рдмрд┐рди

рдЕрдирд╕реЙрд░реНрдЯреЗрдб рдмрд┐рди рдПрдХ **рддреЗрдЬ рдХреИрд╢** рд╣реИ рдЬрд┐рд╕реЗ рд╣реАрдк рдкреНрд░рдмрдВрдзрдХ рджреНрд╡рд╛рд░рд╛ рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди рдХреЛ рддреЗрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣рд╛рдБ рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ: рдЬрдм рдХреЛрдИ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдореЗрдореЛрд░реА рдХреЛ рдореБрдХреНрдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╣реАрдк рдкреНрд░рдмрдВрдзрдХ рдЙрд╕реЗ рддреБрд░рдВрдд рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдмрд┐рди рдореЗрдВ рдирд╣реАрдВ рдбрд╛рд▓рддрд╛ред рдмрд▓реНрдХрд┐, рдкрд╣рд▓реЗ рдпрд╣ **рдХрд┐рд╕реА рднреА рдкрдбрд╝реЛрд╕реА рдлреНрд░реА рдЪрдВрдХ рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рддрд╛ рд╣реИ** рддрд╛рдХрд┐ рдПрдХ рдмрдбрд╝реЗ рдмреНрд▓реЙрдХ рдХреЛ рдирд┐: рд╢реБрд▓реНрдХ рдореЗрдореЛрд░реА рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдлрд┐рд░, рдпрд╣ рдЗрд╕ рдирдП рдЪрдВрдХ рдХреЛ "рдЕрдирд╕реЙрд░реНрдЯреЗрдб рдмрд┐рди" рдирд╛рдордХ рд╕рд╛рдорд╛рдиреНрдп рдмрд┐рди рдореЗрдВ рд░рдЦрддрд╛ рд╣реИред

рдЬрдм рдХреЛрдИ рдкреНрд░реЛрдЧреНрд░рд╛рдо **рдореЗрдореЛрд░реА рдХреЗ рд▓рд┐рдП рдкреВрдЫрддрд╛ рд╣реИ**, рддреЛ рд╣реАрдк рдкреНрд░рдмрдВрдзрдХ **рдЕрдирд╕реЙрд░реНрдЯреЗрдб рдмрд┐рди рдХреА рдЬрд╛рдБрдЪ рдХрд░рддрд╛ рд╣реИ** рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдкрд░реНрдпрд╛рдкреНрдд рд╕рд╛рдЗрдЬрд╝ рдХрд╛ рдЪрдВрдХ рд╣реИред рдЕрдЧрд░ рд╡рд╣ рдПрдХ рдкрд╛рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдЗрд╕реЗ рддреБрд░рдВрдд рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдЕрдЧрд░ рдЙрд╕реЗ рдПрдХ рдЙрдкрдпреБрдХреНрдд рдЪрдВрдХ рдирд╣реАрдВ рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдореБрдХреНрдд рдЪрдВрдХреНрд╕ рдХреЛ рдЙрдирдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдмрд┐рдиреНрд╕ рдореЗрдВ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╛ рддреЛ рдЫреЛрдЯреЗ рдпрд╛ рдмрдбрд╝реЗ, рдЙрдирдХреЗ рдЖрдХрд╛рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ред

рдЗрд╕рд▓рд┐рдП, рдЕрдирд╕реЙрд░реНрдЯреЗрдб рдмрд┐рди рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди рдХреЛ рддреЗрдЬ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдореБрдХреНрдд рдореЗрдореЛрд░реА рдХреЛ рддреЗрдЬреА рд╕реЗ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╕рдордп рдЧреНрд░рд╛рд╣рдХ рдЦреЛрдЬ рдФрд░ рдорд░реНрдЬ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

{% hint style="danger" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЪрдВрдХреНрд╕ рд╡рд┐рднрд┐рдиреНрди рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдХреЗ рд╣реЛрдВ, рддреЛ рднреА рдпрджрд┐ рдПрдХ рдЙрдкрд▓рдмреНрдз рдЪрдВрдХ рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрд▓рдмреНрдз рдЪрдВрдХ рдХреЗ рд╕рд╛рде рдЯрдХрд░рд╛ рд░рд╣рд╛ рд╣реИ (рдпрджрд┐ рд╡реЗ рд╡рд┐рднрд┐рдиреНрди рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдХреЗ рд╣реЛрдВ), рддреЛ рд╡реЗ рдорд░реНрдЬ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗред
{% endhint %}

### рдлрд╛рд╕реНрдЯ рдмрд┐рдиреНрд╕

рдлрд╛рд╕реНрдЯ рдмрд┐рдиреНрд╕ рдЫреЛрдЯреЗ рдЪрдВрдХреНрд╕ рдХреЗ рд▓рд┐рдП рдореЗрдореЛрд░реА рдЖрд╡рдВрдЯрди рдХреЛ рддреЗрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВ рдЬрд┐рд╕реЗ рдПрдХ рддреНрд╡рд░рд┐рдд рдкрд╣реБрдВрдЪ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рд╣рд╛рд▓ рд╣реА рдореБрдХреНрдд рдЪрдВрдХреНрд╕ рдХреЛ рд░рдЦрдХрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпреЗ рдмрд┐рдиреНрд╕ рдПрдХ рд▓рд╛рд╕реНрдЯ-рдЗрди, рдлрд░реНрд╕реНрдЯ-рдЖрдЙрдЯ (LIFO) рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ **рд╕рдмрд╕реЗ рд╣рд╛рд▓ рд╣реА рдореБрдХреНрдд рдЪрдВрдХ рдкрд╣рд▓реЗ** рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬрдм рдПрдХ рдирдпрд╛ рдЖрд╡рдВрдЯрди рдЕрдиреБрд░реЛрдз рд╣реЛред рдпрд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдЧрддрд┐ рдХреЗ рд▓рд┐рдП рдлрд╛рдпрджреЗрдордВрдж рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдПрдХ рд╕реНрдЯреИрдХ (LIFO) рдХреЗ рд╢реАрд░реНрд╖ рд╕реЗ рдбрд╛рд▓рдирд╛ рдФрд░ рд╣рдЯрд╛рдирд╛ рддреЗрдЬ рд╣реЛрддрд╛ рд╣реИ рддреБрд▓рдирд╛рддреНрдордХ рд░реВрдк рд╕реЗ рдПрдХ рдХрддрд╛рд░ (FIFO) рдХреЗ рд╕рд╛рдеред

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, **рдлрд╛рд╕реНрдЯ рдмрд┐рдиреНрд╕ рдПрдХрд▓ рд▓рд┐рдВрдХреНрдб рд▓рд┐рд╕реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ**, рдбрдмрд▓ рд▓рд┐рдВрдХреНрдб рдирд╣реАрдВ, рдЬреЛ рдЧрддрд┐ рдХреЛ рдФрд░ рдмрдврд╝рд╛рддрд╛ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ рдлрд╛рд╕реНрдЯ рдмрд┐рдиреНрд╕ рдореЗрдВ рдЪрдВрдХреНрд╕ рдХреЛ рдкрдбрд╝реЛрд╕рд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдорд░реНрдЬ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рдЬрдЯрд┐рд▓ рд╕рдВрд░рдЪрдирд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рдЬреЛ рдордзреНрдп рд╕реЗ рд╣рдЯрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред рдПрдХрд▓ рд▓рд┐рдВрдХреНрдб рд▓рд┐рд╕реНрдЯ рдЗрди рдСрдкрд░реЗрд╢рди рдХреЗ рд▓рд┐рдП рдЗрд╕ рд╕рд░рд▓ рдФрд░ рддреЗрдЬ рд╣реИред

рдореВрд▓ рд░реВрдк рд╕реЗ, рдпрд╣рд╛рдБ рдпрд╣ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рд╣реЗрдбрд░ (рдкрд╣рд▓реЗ рдЪрдВрдХ рдХреЗ рд▓рд┐рдП рдкреЙрдЗрдВрдЯрд░) рд╣рдореЗрд╢рд╛ рдЙрд╕ рд╕рд╛рдЗрдЬрд╝ рдХреЗ рд╣рд╛рд▓ рд╣реА рдореБрдХреНрдд рдЪрдВрдХ рдХреА рдУрд░ рдкреЙрдЗрдВрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИред рддреЛ:

* рдЬрдм рдЙрд╕ рд╕рд╛рдЗрдЬрд╝ рдХрд╛ рдирдпрд╛ рдЪрдВрдХ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣реЗрдбрд░ рдПрдХ рдЙрдкрдпреБрдХреНрдд рдЪрдВрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдореБрдХреНрдд рдЪрдВрдХ рдХреА рдУрд░ рдкреЙрдЗрдВрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдореБрдХреНрдд рдЪрдВрдХ рдЕрдЧрд▓реЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЪрдВрдХ рдХреА рдУрд░ рдкреЙрдЗрдВрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИ, рдЗрд╕ рдкрддреЗ рдХреЛ рд╣реЗрдбрд░ рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЕрдЧрд▓реА рдЖрд╡рдВрдЯрди рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛рдВ рд╕реЗ рдПрдХ рдЙрдкрд▓рдмреНрдз рдЪрдВрдХ рдорд┐рд▓реЗрдЧрд╛ред
* рдЬрдм рдПрдХ рдЪрдВрдХ рдореБрдХреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдореБрдХреНрдд рдЪрдВрдХ рд╡рд░реНрддрдорд╛рди рдЙрдкрд▓рдмреНрдз рдЪрдВрдХ рдХреЗ рдкрддреЗ рдХреЛ рд╕рд╣реЗрдЬреЗрдЧрд╛ рдФрд░ рдЗрд╕ рдирдП рдореБрдХреНрдд рдЪрдВрдХ рдХрд╛ рдкрддрд╛ рд╣реЗрдбрд░ рдореЗрдВ рдбрд╛рд▓рд╛ рдЬрд╛рдПрдЧрд╛ред

{% hint style="danger" %}
рдлрд╛рд╕реНрдЯ рдмрд┐рдиреНрд╕ рдореЗрдВ рдЪрдВрдХреНрд╕ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рдХреБрдЫ рд╕рдордп рддрдХ рдлрд╛рд╕реНрдЯ рдмрд┐рди рдЪрдВрдХреНрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рд░рд╣реЗрдВ рдФрд░ рдЕрдиреНрдп рдЪрдВрдХреНрд╕ рдХреЗ рд╕рд╛рде рдорд░реНрдЬ рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдпред
{% endhint %}

### рдЯреАрдХреИрд╢ (рдкрд░-рдереНрд░реЗрдб рдХреИрд╢) рдмрд┐рдиреНрд╕

рд╣рд╛рд▓рд╛рдВрдХрд┐ рдзрд╛рдЧреЗ рдЕрдкрдиреА рдЕрдкрдиреА рд╣реАрдк рд░рдЦрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ (рджреЗрдЦреЗрдВ [рдПрд░реАрдирд╛рд╕](bins-and-memory-allocations.md#arenas) рдФрд░ [рд╕рдмрд╣реАрдкреНрд╕](bins-and-memory-allocations.md#subheaps)), рдПрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЬрд┐рд╕рдореЗрдВ рдмрд╣реБрдд рд╕рд╛рд░реЗ рдзрд╛рдЧреЗ рд╣реЛрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ рдПрдХ рд╡реЗрдм рд╕рд░реНрд╡рд░) **рджреВрд╕рд░реЗ рдзрд╛рдЧреЛрдВ рдХреЗ рд╕рд╛рде рд╣реАрдк рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛** рд╣реИред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореБрдЦреНрдп рд╕рдорд╛рдзрд╛рди рд╣реИ **рд▓реЙрдХрд░реНрд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ, рдЬреЛ рдзрд╛рдЧреЛрдВ рдХреЛ **рдзреАрдорд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

рдЗрд╕рд▓рд┐рдП, рдПрдХ рдЯреАрдХреИрд╢ рдПрдХ рддрд░рд╣ рдХрд╛ рдлрд╛рд╕реНрдЯ рдмрд┐рди рдкреНрд░рддрд┐ рдзрд╛рдЧ рд╣реИ рдЬрд┐рд╕ рдкреНрд░рдХрд╛рд░ рд╕реЗ рдпрд╣ рдПрдХ **рдПрдХрд▓ рд▓рд┐рдВрдХреНрдб рд▓рд┐рд╕реНрдЯ** рд╣реИ рдЬреЛ рдЪрдВрдХреНрд╕ рдХреЛ рдорд░реНрдЬ рдирд╣реАрдВ рдХрд░рддрд╛ред рдкреНрд░рддреНрдпреЗрдХ рдзрд╛рдЧ рдХреЗ рдкрд╛рд╕ **64 рдПрдХрд▓-рд▓рд┐рдВрдХреНрдб рдЯреАрдХреИрд╢ рдмрд┐рдиреНрд╕** рд╣реЛрддреЗ рд╣реИрдВред рдкреНрд░рддреНрдпреЗрдХ рдмрд┐рди рдореЗрдВ [24 рд╕реЗ 1032рдмреА рддрдХ рдХреЗ 64-рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдФрд░ 12 рд╕реЗ 516рдмреА рддрдХ рдХреЗ 32-рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдо рдкрд░](https://sourceware.org/git/?p=glibc.git;a=blob;f=malloc/malloc.c;h=2527e2504761744df2bdb1abdc02d936ff907ad2;hb=d5c3fafc4307c9b7a4c7d5cb381fcdbfad340bcc#l315) рдПрдХ рд╕рдорд╛рди-рд╕рд╛рдЗрдЬрд╝ рдЪрдВрдХреНрд╕ рдХреА рдЕрдзрд┐рдХрддрдо рд╕рдВрдЦреНрдпрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред

**рдЬрдм рдПрдХ рдзрд╛рдЧ рдореБрдХреНрдд рдХрд░рддрд╛ рд╣реИ**, рдЕрдЧрд░ рдпрд╣ рдЯреАрдХреИрд╢ рдореЗрдВ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдмрдбрд╝рд╛ рдирд╣реАрдВ рд╣реИ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдЯреАрдХреИрд╢ рдмрд┐рди **рднрд░рд╛ рдирд╣реАрдВ рд╣реИ** (рдкрд╣рд▓реЗ рд╕реЗ рд╣реА 7 рдЪрдВрдХреНрд╕ рд╣реИрдВ), **рддреЛ рд╡рд╣ рд╡рд╣рд╛рдБ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред рдпрджрд┐ рдпрд╣ рдЯреАрдХреИрд╢ рдореЗрдВ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╣реАрдк рд▓реЙрдХ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рддрд╛рдХрд┐ рд╡рд╣ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдмрд┐рдиреНрд╕ рдореЗрдВ рдореБрдХреНрдд рдСрдкрд░реЗрд╢рди рдХрд░ рд╕рдХреЗред

рдЬрдм рдПрдХ **рдЪрдВрдХ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**, рдЕрдЧрд░ **рдЯреАрдХреИрд╢ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд╕рд╛рдЗрдЬрд╝ рдХрд╛ рдПрдХ рдореБрдХреНрдд рдЪрдВрдХ рд╣реИ**, **рддреЛ рдпрд╣ рдЙрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛**, рдЕрдЧрд░ рдирд╣реАрдВ, рддреЛ рдпрд╣ рд╣реАрдк рд▓реЙрдХ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рддрд╛рдХрд┐ рд╡рд╣ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдмрд┐рдиреНрд╕ рдореЗрдВ рдПрдХ рдвреВрдВрдв рд╕рдХреЗ рдпрд╛ рдПрдХ рдирдпрд╛ рдмрдирд╛ рд╕рдХреЗред\
рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдПрдХ рдЕрдиреБрдХреВрд▓рди рднреА рд╣реИ, рд╣реАрдк рд▓реЙрдХ рдХреЗ рд╕рд╛рде рд╣реЛрддреЗ рд╣реБрдП, рдзрд╛рдЧ **рдЕрдкрдиреЗ рдЯреАрдХреИрд╢ рдХреЛ рд╣реАрдк рдЪрдВрдХреНрд╕ рдХреЗ рд╕рд╛рде рднрд░реЗрдЧрд╛ (7) рдЕрдиреБрд░реЛрдзрд┐рдд рд╕рд╛рдЗрдЬрд╝ рдХреЗ**, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдорд╛рдорд▓реЗ рдореЗрдВ рдФрд░ рдЪрд╛рд╣рд┐рдП рд╣реЛрдВ, рддреЛ рд╡рд╣ рдЙрдиреНрд╣реЗрдВ рдЯреАрдХреИрд╢ рдореЗрдВ рдкрд╛рдПрдЧрд╛ред
## рдЖрд╡рдВрдЯрди рдлреНрд▓реЛ

{% hint style="success" %}
(рдпрд╣ рд╡рд░реНрддрдорд╛рди рд╡реНрдпрд╛рдЦреНрдпрд╛рди [https://heap-exploitation.dhavalkapil.com/diving\_into\_glibc\_heap/core\_functions](https://heap-exploitation.dhavalkapil.com/diving\_into\_glibc\_heap/core\_functions) рд╕реЗ рд╣реИред TODO: рдЕрдВрддрд┐рдо рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ)
{% endhint %}

рдЖрд╡рдВрдЯрди рдЕрдВрддрддрдГ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: `void * _int_malloc (mstate av, size_t bytes)` рдФрд░ рдЗрд╕рдХрд╛ рдпрд╣ рдХреНрд░рдо рд╣реИ:

1. **рд╕рдВрд░реЗрдЦрдг** рдЖрджрд┐ рдХреА рджреЗрдЦрднрд╛рд▓ рдХреЗ рд▓рд┐рдП `рдмрд╛рдЗрдЯреНрд╕` рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддрд╛ рд╣реИред
2. рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ рдХрд┐ `av` **NULL** рд╣реИ рдпрд╛ рдирд╣реАрдВред
3. рдЙрдкрдпреЛрдЧреА рдПрд░реАрдирд╛ рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ (рдЬрдм `av` NULL рд╣реЛрддрд╛ рд╣реИ), `sysmalloc` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `sysmalloc` рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ, рддреЛ `alloc_perturb` рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред рдкреЙрдЗрдВрдЯрд░ рд▓реМрдЯрд╛рддрд╛ рд╣реИред
4. рдЖрдХрд╛рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░:
* \[рдореВрд▓ рдореЗрдВ рдЬреЛрдбрд╝] рдЕрдЧрд▓реЗ fastbin рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ tcache рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* \[рдореВрд▓ рдореЗрдВ рдЬреЛрдбрд╝] рдпрджрд┐ рдХреЛрдИ tcache рдирд╣реАрдВ рд╣реИ рд▓реЗрдХрд┐рди рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдмрд┐рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдмрд╛рдж рдореЗрдВ рдЪрд░рдг рджреЗрдЦреЗрдВ), рддреЛ рдЙрд╕ рдмрд┐рди рд╕реЗ tcache рднрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ
* рдпрджрд┐ рдЖрдХрд╛рд░ **fastbin** рд╕реАрдорд╛ рдореЗрдВ рд╣реИ:
1. рдЙрдЪрд┐рдд рдмрд┐рди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдЪрд┐рдд рдмрд┐рди рдПрд░реЗ рдореЗрдВ рдЗрдВрдбреЗрдХреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
2. рдЙрд╕ рдмрд┐рди рдореЗрдВ рдкрд╣рд▓рд╛ рдЪрдВрдХ рд╣рдЯрд╛рддрд╛ рд╣реИ рдФрд░ `рд╡рд┐рдХреНрдЯрд┐рдо` рдХреЛ рдЙрд╕ рдкрд░ рдкреЙрдЗрдВрдЯ рдХрд░рддрд╛ рд╣реИред
3. рдпрджрд┐ `рд╡рд┐рдХреНрдЯрд┐рдо` NULL рд╣реИ, рддреЛ рдЕрдЧрд▓реЗ рдорд╛рдорд▓реЗ рдкрд░ рдЬрд╛рдПрдВ (smallbin)ред
4. рдпрджрд┐ `рд╡рд┐рдХреНрдЯрд┐рдо` NULL рдирд╣реАрдВ рд╣реИ, рддреЛ рдЪрдВрдХ рдХрд╛ рдЖрдХрд╛рд░ рдЬрд╛рдВрдЪреЗрдВ рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдпрд╣ рд╡рд┐рд╢реЗрд╖ рдмрд┐рди рдХрд╛ рд╣реИред рдЕрдиреНрдпрдерд╛ рдПрдХ рддреНрд░реБрдЯрд┐ ("malloc(): memory corruption (fast)") рдлреЗрдВрдХреА рдЬрд╛рддреА рд╣реИред
5. `alloc_perturb` рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдкреЙрдЗрдВрдЯрд░ рд▓реМрдЯрд╛рддрд╛ рд╣реИред
* рдпрджрд┐ рдЖрдХрд╛рд░ **smallbin** рд╕реАрдорд╛ рдореЗрдВ рд╣реИ:
1. рдЙрдЪрд┐рдд рдмрд┐рди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдЪрд┐рдд рдмрд┐рди рдПрд░реЗ рдореЗрдВ рдЗрдВрдбреЗрдХреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
2. рдЗрд╕ рдмрд┐рди рдореЗрдВ рдХреЛрдИ рдЪрдВрдХ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЕрдЧрд▓реЗ рдорд╛рдорд▓реЗ рдкрд░ рдЬрд╛рдПрдВред рдЗрд╕реЗ `рдмрд┐рди` рдФрд░ `рдмрд┐рди->рдмреАрдХреЗ` рдХреЗ рдкреЙрдЗрдВрдЯрд░ рдХреА рддреБрд▓рдирд╛ рдХрд░рдХреЗ рдЬрд╛рдВрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИред
3. `рд╡рд┐рдХреНрдЯрд┐рдо` рдХреЛ `рдмрд┐рди->рдмреАрдХреЗ` (рдмрд┐рди рдореЗрдВ рдЕрдВрддрд┐рдо рдЪрдВрдХ) рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдпрд╣ NULL рд╣реИ (рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬреЗрд╢рди рдХреЗ рджреМрд░рд╛рди рд╣реЛрддрд╛ рд╣реИ), рддреЛ `malloc_consolidate` рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рдмрд┐рдиреЛрдВ рдореЗрдВ рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХрд╛ рдпрд╣ рдкреВрд░рд╛ рдХрджрдо рдЫреЛрдбрд╝ рджреЗрдВред
4. рдЕрдиреНрдпрдерд╛, рдЬрдм `рд╡рд┐рдХреНрдЯрд┐рдо` рдЧреИрд░ NULL рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ `рд╡рд┐рдХреНрдЯрд┐рдо->рдмреАрдХреЗ->рдПрдлрдбреА` рдФрд░ `рд╡рд┐рдХреНрдЯрд┐рдо` рдмрд░рд╛рдмрд░ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВред рдпрджрд┐ рд╡реЗ рдмрд░рд╛рдмрд░ рдирд╣реАрдВ рд╣реИрдВ, рддреЛ рдПрдХ рддреНрд░реБрдЯрд┐ (`malloc(): smallbin double linked list corrupted`) рдлреЗрдВрдХреА рдЬрд╛рддреА рд╣реИред
5. `рд╡рд┐рдХреНрдЯрд┐рдо` рдХреЗ рд▓рд┐рдП рдЕрдЧрд▓реЗ рдЪрдВрдХ рдХреЗ рд▓рд┐рдП PREV\_INSUSE рдмрд┐рдЯ рд╕реЗрдЯ рдХрд░реЗрдВ (рдпрд╛рдж рд░рдЦреЗрдВ, рдпрд╣ рдбрдмрд▓реА рд▓рд┐рдВрдХреНрдб рд╕реВрдЪреА рдореЗрдВ рдирд╣реАрдВ рд╣реИ)ред
6. рдЗрд╕ рдЪрдВрдХ рдХреЛ рдмрд┐рди рд╕реВрдЪреА рд╕реЗ рд╣рдЯрд╛рдПрдВред
7. `рдПрд╡реА` рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЗрд╕ рдЪрдВрдХ рдХреЗ рд▓рд┐рдП рдЙрдЪрд┐рдд рдПрд░рд┐рдирд╛ рдмрд┐рдЯ рд╕реЗрдЯ рдХрд░реЗрдВред
8. `alloc_perturb` рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдкреЙрдЗрдВрдЯрд░ рд▓реМрдЯрд╛рддрд╛ рд╣реИред
* рдпрджрд┐ рдЖрдХрд╛рд░ smallbin рд╕реАрдорд╛ рдореЗрдВ рдирд╣реАрдВ рд╣реИ:
1. рдЙрдЪрд┐рдд рдмрд┐рди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдЪрд┐рдд рдмрд┐рди рдПрд░реЗ рдореЗрдВ рдЗрдВрдбреЗрдХреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
2. рджреЗрдЦреЗрдВ рдХрд┐ `av` рдореЗрдВ fastchunks рд╣реИрдВ рдпрд╛ рдирд╣реАрдВред рдпрд╣ `av->flags` рдореЗрдВ `FASTCHUNKS_BIT` рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рд╣рд╛рдВ, рддреЛ `av` рдкрд░ `malloc_consolidate` рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВред
5. рдпрджрд┐ рдЕрдм рддрдХ рдХреЛрдИ рдкреЙрдЗрдВрдЯрд░ рд▓реМрдЯрд╛рдпрд╛ рдирд╣реАрдВ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдПрдХ рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд╛рдорд▓реЛрдВ рдореЗрдВ рд╕реЗ рдХреЛрдИ рднреА рд╣реИ:
1. рдЖрдХрд╛рд░ 'fastbin' рд╕реАрдорд╛ рдореЗрдВ рдЖрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдХреЛрдИ fastchunk рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИред
2. рдЖрдХрд╛рд░ 'smallbin' рд╕реАрдорд╛ рдореЗрдВ рдЖрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдХреЛрдИ smallchunk рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ (рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬреЗрд╢рди рдХреЗ рджреМрд░рд╛рди `malloc_consolidate` рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)ред
3. рдЖрдХрд╛рд░ 'largbin' рд╕реАрдорд╛ рдореЗрдВ рдЖрддрд╛ рд╣реИред
6. рдЕрдЧрд▓реЗ, **рдЕрдирд╕реЙрд░реНрдЯреЗрдб рдЪрдВрдХ** рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИ рдФрд░ рдЪрдВрдХреЛрдВ рдХреЛ рдмрд┐рди рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдПрдХрдорд╛рддреНрд░ рд╕реНрдерд╛рди рд╣реИ рдЬрд╣рд╛рдВ рдЪрдВрдХреЛрдВ рдХреЛ рдмрд┐рди рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред 'TAIL' рд╕реЗ рдЕрдирд╕реЙрд░реНрдЯреЗрдб рдмрд┐рди рдХреЛ рдШреБрдорд╛рдПрдВред
1. `рд╡рд┐рдХреНрдЯрд┐рдо` рд╡рд░реНрддрдорд╛рди рдЪрдВрдХ рдХреЛ рд╕реЛрдЪрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред
2. рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ `рд╡рд┐рдХреНрдЯрд┐рдо` рдХрд╛ рдЪрдВрдХ рдЖрдХрд╛рд░ рдиреНрдпреВрдирддрдо (`2*SIZE_SZ`) рдФрд░ рдЕрдзрд┐рдХрддрдо (`av->system_mem`) рд╕реАрдорд╛ рдореЗрдВ рд╣реИ рдпрд╛ рдирд╣реАрдВред рдЕрдиреНрдпрдерд╛ рдПрдХ рддреНрд░реБрдЯрд┐ (`malloc(): memory corruption`) рдлреЗрдВрдХреА рдЬрд╛рддреА рд╣реИред
3. рдпрджрд┐ (рдЕрдиреБрд░реЛрдзрд┐рдд рдЪрдВрдХ рдХрд╛ рдЖрдХрд╛рд░ smallbin рд╕реАрдорд╛ рдореЗрдВ рд╣реИ) рдФрд░ (`рд╡рд┐рдХреНрдЯрд┐рдо` рдЕрдВрддрд┐рдо рд╢реЗрд╖ рдЪрдВрдХ рд╣реИ) рдФрд░ (рдпрд╣ рдЕрдирд╕реЙрд░реНрдЯреЗрдб рдмрд┐рди рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рдЪрдВрдХ рд╣реИ) рдФрд░ (рдЪрдВрдХ рдХрд╛ рдЖрдХрд╛рд░ рдЕрдиреБрд░реЛрдзрд┐рдд рдЪрдВрдХ рд╕реЗ рдЕрдзрд┐рдХ рд╣реИ): **рдЪрдВрдХ рдХреЛ 2 рдЪрдВрдХ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░реЗрдВ**:
* рдкрд╣рд▓рд╛ рдЪрдВрдХ рдЕрдиреБрд░реЛрдзрд┐рдд рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ рдФрд░ рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* рдмрдЪрд╛ рд╣реБрдЖ рдЪрдВрдХ рдирдпрд╛ рдЕрдВрддрд┐рдо рд╢реЗрд╖ рдЪрдВрдХ рдмрди рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдЕрдирд╕реЙрд░реНрдЯреЗрдб рдмрд┐рди рдореЗрдВ рдлрд┐рд░ рд╕реЗ рдбрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИред
1. рджреЛрдиреЛрдВ рдЪрдВрдХ рдХреЗ рд▓рд┐рдП `рдЪрдВрдХ_рд╕рд╛рдЗрдЬрд╝` рдФрд░ `рдЪрдВрдХ_рдкрд┐рдЫрд▓рд╛_рд╕рд╛рдЗрдЬрд╝` рдлрд╝реАрд▓реНрдб рдХреЛ рдЙрдкрдпреБрдХреНрдд рдврдВрдЧ рд╕реЗ рд╕реЗрдЯ рдХрд░реЗрдВред
2. рдкрд╣рд▓рд╛ рдЪрдВрдХ `alloc_perturb` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
3. рдпрджрд┐ рдЙрдкрд░реЛрдХреНрдд рд╕реНрдерд┐рддрд┐ рдЧрд▓рдд рд╣реИ, рддреЛ рдпрд╣рд╛рдБ рддрдХ рдирд┐рдпрдВрддреНрд░рдг рдкрд╣реБрдВрдЪрддрд╛ рд╣реИред рдЕрдирд╕реЙрд░реНрдЯреЗрдб рдмрд┐рди рд╕реЗ `рд╡рд┐рдХреНрдЯрд┐рдо` рдХреЛ рд╣рдЯрд╛рдПрдВред рдпрджрд┐ `рд╡рд┐рдХреНрдЯрд┐рдо` рдХрд╛ рдЖрдХрд╛рд░ рдЕрдиреБрд░реЛрдзрд┐рдд рдЖрдХрд╛рд░ рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ, рддреЛ рдЗрд╕ рдЪрдВрдХ рдХреЛ рд▓реМрдЯрд╛рдПрдВ рдФрд░ `alloc_perturb` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЗрд╕реЗ рд▓реМрдЯрд╛рдПрдВред
4. рдпрджрд┐ `рд╡рд┐рдХреНрдЯрд┐рдо` рдХрд╛ рдЖрдХрд╛рд░ smallbin рд╕реАрдорд╛ рдореЗрдВ рд╣реИ, рддреЛ рдЪрдВрдХ рдХреЛ рдЙрдЪрд┐рдд smallbin рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ (`рд╣реЗрдб` рдкрд░)ред
5. рдЕрдиреНрдпрдерд╛ рдЙрдЪрд┐рдд largebin рдореЗрдВ рдбрд╛рд▓реЗрдВ рдФрд░ рдХреНрд░рдордмрджреНрдз рдХреНрд░рдо рдмрдирд╛рдП рд░рдЦреЗрдВ:
6. рдкрд┐рдЫрд▓рд╛ рдЪрдВрдХ (рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛) рдЬрд╛рдВрдЪреЗрдВред рдпрджрд┐ `рд╡рд┐рдХреНрдЯрд┐рдо` рдкрд┐рдЫрд▓реЗ рдЪрдВрдХ рд╕реЗ рдЫреЛрдЯрд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рдЕрдВрддрд┐рдо рдореЗрдВ рдбрд╛рд▓реЗрдВред
7. рдЕрдиреНрдпрдерд╛, рдПрдХ рдЪрдВрдХ рдвреВрдВрдврдиреЗ рдХреЗ рд▓рд┐рдП рд▓реВрдк рдЪрд▓рд╛рдПрдВ рдЬрд┐рд╕рдХрд╛ рдЖрдХрд╛рд░ `рд╡рд┐рдХреНрдЯрд┐рдо` рдХреЗ рдЖрдХрд╛рд░ рд╕реЗ рдЕрдзрд┐рдХ рд╣реИред рдпрджрд┐ рдЖрдХрд╛рд░ рдмрд┐рд▓реНрдХреБрд▓ рд╕рдорд╛рди рд╣реИ, рддреЛ рд╣рдореЗрд╢рд╛ рджреВрд╕рд░реЗ рд╕реНрдерд╛рди рдкрд░ рдбрд╛рд▓реЗрдВред
8. рдЗрд╕ рдкреВрд░реЗ рдХрджрдо рдХреЛ рдЕрдзрд┐рдХрддрдо `MAX_ITERS` (10000) рдмрд╛рд░ рдпрд╛ рддрдм рддрдХ рджреЛрдиреЛрдВ рдЪрдВрдХ рдЦрддреНрдо рд╣реЛ рдЬрд╛рдПрдВ рддрдХ рджреЛрд╣рд░рд╛рдПрдВред
7. рдЕрдирд╕реЙрд░реНрдЯреЗрдб рдЪрдВрдХреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдпрджрд┐ рдЕрдиреБрд░реЛрдзрд┐рдд рдЖрдХрд╛рд░ smallbin рд╕реАрдорд╛ рдореЗрдВ рдирд╣реАрдВ рд╣реИ, рддреЛ рдмрдбрд╝реЗ рдмрд┐рдиреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
1. рдЙрдЪрд┐рдд рдмрд┐рди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдЪрд┐рдд рдмрд┐рди рдПрд░реЗ рдореЗрдВ рдЗрдВрдбреЗрдХреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
2. рдпрджрд┐
## рдореБрдХреНрдд рдлреНрд▓реЛ

{% hint style="success" %}
(рдпрд╣ рд╡рд░реНрддрдорд╛рди рд╡реНрдпрд╛рдЦреНрдпрд╛рди [https://heap-exploitation.dhavalkapil.com/diving\_into\_glibc\_heap/core\_functions](https://heap-exploitation.dhavalkapil.com/diving\_into\_glibc\_heap/core\_functions) рд╕реЗ рд╣реИред TODO: рдЕрдВрддрд┐рдо рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдФрд░ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ)
{% endhint %}

рдореЗрдореЛрд░реА рдХреЗ рдЯреБрдХрдбрд╝реЛрдВ рдХреЛ рдореБрдХреНрдд рдХрд░рдиреЗ рдХрд╛ рдЕрдВрддрд┐рдо рдХрд╛рд░реНрдп рд╣реИ `_int_free (mstate av, mchunkptr p, int have_lock)` :

1. рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ `p` рдореЗрдореЛрд░реА рдореЗрдВ `p + chunksize(p)` рд╕реЗ рдкрд╣рд▓реЗ рд╣реИ (рд▓рдкреЗрдЯрди рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП)ред рдЕрдиреНрдпрдерд╛ рдПрдХ рддреНрд░реБрдЯрд┐ (`free(): invalid pointer`) рдЙрдард╛рдИ рдЬрд╛рддреА рд╣реИред
2. рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЯреБрдХрдбрд╝рд╛ рдХрдо рд╕реЗ рдХрдо рдЖрдХрд╛рд░ `MINSIZE` рдпрд╛ `MALLOC_ALIGNMENT` рдХрд╛ рдПрдХ рдЧреБрдгрдХ рд╣реИред рдЕрдиреНрдпрдерд╛ рдПрдХ рддреНрд░реБрдЯрд┐ (`free(): invalid size`) рдЙрдард╛рдИ рдЬрд╛рддреА рд╣реИред
3. рдЕрдЧрд░ рдЯреБрдХрдбрд╝рд╛ fastbin рд╕реВрдЪреА рдореЗрдВ рд╣реИ:
1. рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЕрдЧрд▓реЗ рдЯреБрдХрдбрд╝реЗ рдХрд╛ рдЖрдХрд╛рд░ рдиреНрдпреВрдирддрдо рдФрд░ рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ (`av->system_mem`) рдХреЗ рдмреАрдЪ рд╣реИ, рдЕрдиреНрдпрдерд╛ рдПрдХ рддреНрд░реБрдЯрд┐ (`free(): invalid next size (fast)`) рдЙрдард╛рдИ рдЬрд╛рддреА рд╣реИред
2. рдЯреБрдХрдбрд╝реЗ рдкрд░ `free_perturb` рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВред
3. `av` рдХреЗ рд▓рд┐рдП `FASTCHUNKS_BIT` рд╕реЗрдЯ рдХрд░реЗрдВред
4. рдЯреБрдХрдбрд╝реЗ рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рдЕрдиреБрд╕рд╛рд░ fastbin рдПрд░реЗ рдореЗрдВ рд╕реВрдЪреА рдореЗрдВ рд╕реВрдЪреА рдореЗрдВ рдЗрдВрдбреЗрдХреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
5. рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдмрд┐рди рдХрд╛ рд╢реАрд░реНрд╖ рд╡рд╣ рдЯреБрдХрдбрд╝рд╛ рдирд╣реАрдВ рд╣реИ рдЬрд┐рд╕реЗ рд╣рдо рдЬреЛрдбрд╝рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред рдЕрдиреНрдпрдерд╛, рдПрдХ рддреНрд░реБрдЯрд┐ (`double free or corruption (fasttop)`) рдЙрдард╛рдИ рдЬрд╛рддреА рд╣реИред
6. рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдлрд╛рд╕реНрдЯрдмрд┐рди рдЪрдВрдХ рдХрд╛ рдЖрдХрд╛рд░ рд╢реАрд░реНрд╖ рдкрд░ рдЬреЛрдбрд╝рдиреЗ рдЬрд╛ рд░рд╣реЗ рдЪрдВрдХ рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рд╕рдорд╛рди рд╣реИред рдЕрдиреНрдпрдерд╛, рдПрдХ рддреНрд░реБрдЯрд┐ (`invalid fastbin entry (free)`) рдЙрдард╛рдИ рдЬрд╛рддреА рд╣реИред
7. рдЯреБрдХрдбрд╝рд╛ рдлрд╛рд╕реНрдЯрдмрд┐рди рд╕реВрдЪреА рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рдбрд╛рд▓реЗрдВ рдФрд░ рд╡рд╛рдкрд╕ рд▓реМрдЯреЗрдВред
4. рдЕрдЧрд░ рдЯреБрдХрдбрд╝рд╛ mmapped рдирд╣реАрдВ рд╣реИ:
1. рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЯреБрдХрдбрд╝рд╛ рд╢реАрд░реНрд╖ рдЯреБрдХрдбрд╝рд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред рдЕрдЧрд░ рд╣рд╛рдВ, рддреЛ рдПрдХ рддреНрд░реБрдЯрд┐ (`double free or corruption (top)`) рдЙрдард╛рдИ рдЬрд╛рддреА рд╣реИред
2. рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЕрдЧрд▓рд╛ рдЯреБрдХрдбрд╝рд╛ (рдореЗрдореЛрд░реА рдХреЗ рдЕрдиреБрд╕рд╛рд░) рдПрд░реАрдирд╛ рдХреА рд╕реАрдорд╛рдУрдВ рдХреЗ рднреАрддрд░ рд╣реИ рдпрд╛ рдирд╣реАрдВред рдЕрдЧрд░ рдирд╣реАрдВ, рддреЛ рдПрдХ рддреНрд░реБрдЯрд┐ (`double free or corruption (out)`) рдЙрдард╛рдИ рдЬрд╛рддреА рд╣реИред
3. рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЕрдЧрд▓реЗ рдЯреБрдХрдбрд╝реЗ (рдореЗрдореЛрд░реА рдХреЗ рдЕрдиреБрд╕рд╛рд░) рдХрд╛ рдкрд┐рдЫрд▓рд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдмрд┐рдЯ рдорд╛рд░реНрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред рдЕрдЧрд░ рдирд╣реАрдВ, рддреЛ рдПрдХ рддреНрд░реБрдЯрд┐ (`double free or corruption (!prev)`) рдЙрдард╛рдИ рдЬрд╛рддреА рд╣реИред
4. рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЕрдЧрд▓реЗ рдЯреБрдХрдбрд╝реЗ рдХрд╛ рдЖрдХрд╛рд░ рдиреНрдпреВрдирддрдо рдФрд░ рдЕрдзрд┐рдХрддрдо рдЖрдХрд╛рд░ (`av->system_mem`) рдХреЗ рдмреАрдЪ рд╣реИ рдпрд╛ рдирд╣реАрдВред рдЕрдЧрд░ рдирд╣реАрдВ, рддреЛ рдПрдХ рддреНрд░реБрдЯрд┐ (`free(): invalid next size (normal)`) рдЙрдард╛рдИ рдЬрд╛рддреА рд╣реИред
5. рдЯреБрдХрдбрд╝реЗ рдкрд░ `free_perturb` рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВред
6. рдЕрдЧрд░ рдкрд┐рдЫрд▓рд╛ рдЯреБрдХрдбрд╝рд╛ (рдореЗрдореЛрд░реА рдХреЗ рдЕрдиреБрд╕рд╛рд░) рдЗрд╕реНрддреЗрдорд╛рд▓ рдореЗрдВ рдирд╣реАрдВ рд╣реИ, рддреЛ рдкрд┐рдЫрд▓реЗ рдЯреБрдХрдбрд╝реЗ рдкрд░ `unlink` рдХреЙрд▓ рдХрд░реЗрдВред
7. рдЕрдЧрд▓рд╛ рдЯреБрдХрдбрд╝рд╛ (рдореЗрдореЛрд░реА рдХреЗ рдЕрдиреБрд╕рд╛рд░) рд╢реАрд░реНрд╖ рдЯреБрдХрдбрд╝рд╛ рдирд╣реАрдВ рд╣реИ:
1. рдЕрдЧрд▓рд╛ рдЯреБрдХрдбрд╝рд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдореЗрдВ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЕрдЧрд▓реЗ рдЯреБрдХрдбрд╝реЗ рдкрд░ `unlink` рдХреЙрд▓ рдХрд░реЗрдВред
2. рдЯреБрдХрдбрд╝реЗ рдХреЛ рдкрд┐рдЫрд▓реЗ, рдЕрдЧрд▓реЗ (рдореЗрдореЛрд░реА рдХреЗ рдЕрдиреБрд╕рд╛рд░) рдорд┐рд▓рд╛рдПрдВ, рдпрджрд┐ рдХреЛрдИ рднреА рдирд┐:рд╢реБрд▓реНрдХ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрд╕рдВрд╡рд┐рдиреНрдпрд╕реНрдд рдмрд┐рди рдХреЗ рд╕рд┐рд░реЗ рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред рдбрд╛рд▓рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ `unsorted_chunks(av)->fd->bk == unsorted_chunks(av)` рд╣реИ рдпрд╛ рдирд╣реАрдВред рдЕрдЧрд░ рдирд╣реАрдВ, рддреЛ рдПрдХ рддреНрд░реБрдЯрд┐ ("free(): corrupted unsorted chunks") рдЙрдард╛рдИ рдЬрд╛рддреА рд╣реИред
8. рдЕрдЧрд▓рд╛ рдЯреБрдХрдбрд╝рд╛ (рдореЗрдореЛрд░реА рдХреЗ рдЕрдиреБрд╕рд╛рд░) рд╢реАрд░реНрд╖ рдЯреБрдХрдбрд╝рд╛ рдерд╛, рддреЛ рдЯреБрдХрдбрд╝реЗ рдХреЛ рдЙрдЪрд┐рдд рд░реВрдк рд╕реЗ рдПрдХрд▓ рд╢реАрд░реНрд╖ рдЯреБрдХрдбрд╝реЗ рдореЗрдВ рдорд┐рд▓рд╛рдПрдВред
5. рдЕрдЧрд░ рдЯреБрдХрдбрд╝рд╛ mmapped рдерд╛, рддреЛ `munmap_chunk` рдХреЙрд▓ рдХрд░реЗрдВред

## рд╣реАрдк рдлрд╝рдВрдХреНрд╢рди рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдВрдЪреЗрдВ

рд╣реАрдк рдореЗрдВ рдкреНрд░рдпреБрдХреНрдд рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рджреНрд╡рд╛рд░рд╛ рдХреА рдЧрдИ рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдВрдЪреЗрдВ рджреЗрдЦреЗрдВ:

{% content-ref url="heap-functions-security-checks.md" %}
[heap-functions-security-checks.md](heap-functions-security-checks.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн

* [https://azeria-labs.com/heap-exploitation-part-1-understanding-the-glibc-heap-implementation/](https://azeria-labs.com/heap-exploitation-part-1-understanding-the-glibc-heap-implementation/)
* [https://azeria-labs.com/heap-exploitation-part-2-glibc-heap-free-bins/](https://azeria-labs.com/heap-exploitation-part-2-glibc-heap-free-bins/)
* [https://heap-exploitation.dhavalkapil.com/diving\_into\_glibc\_heap/core\_functions](https://heap-exploitation.dhavalkapil.com/diving\_into\_glibc\_heap/core\_functions)
