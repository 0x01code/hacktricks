# House of Force



<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい場合**は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* 独占的な[NFTs](https://opensea.io/collection/the-peass-family)のコレクションである[**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見する
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**に参加するか、[telegramグループ](https://t.me/peass)に参加するか、**Twitter**で**@hacktricks\_live**をフォローする
* **HackTricks**および**HackTricks Cloud**のGitHubリポジトリにPRを提出して、あなたのハッキングテクニックを共有する

</details>

## 基本情報

### コード

* このテクニックはパッチされました（[こちら](https://sourceware.org/git/?p=glibc.git;a=commitdiff;h=30a17d8c95fbfb15c52d1115803b63aaa73a285c)） 、エラーが発生します：`malloc(): corrupted top size`

### ゴール

* この攻撃の目標は、特定のアドレスにチャンクを割り当てることです。

### 必要条件

* 上部チャンクヘッダーのサイズを上書きできるオーバーフローが必要です（例：-1）。
* ヒープ割り当てのサイズを制御できる必要があります

### 攻撃

攻撃者がアドレスPにチャンクを持ちたい場合、上部チャンクのサイズを-1で上書きしている必要があります。まず、（\&top\_chunk - P）のmallocが必要です。このポインタは、top\_chunkの前または後ろにある可能性があります。なぜなら、どのサイズも-1（0xFFFFFFFFFFFFFFFF）より小さいからです。その後、この初期チャンクを割り当てた後、上部チャンクは指定されたPアドレスに移動され、次のチャンクはそのアドレスから取得されます。

### 参考文献

* [https://github.com/shellphish/how2heap/tree/master](https://github.com/shellphish/how2heap/tree/master?tab=readme-ov-file)
* [https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_force/](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_force/)
* [https://heap-exploitation.dhavalkapil.com/attacks/house\_of\_force](https://heap-exploitation.dhavalkapil.com/attacks/house\_of\_force)
