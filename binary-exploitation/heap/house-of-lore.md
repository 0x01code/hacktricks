# House of Lore

<details>

<summary><strong>htARTE (HackTricks AWS Red Team 전문가)로부터 AWS 해킹을 제로부터 영웅까지 배우세요</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사가 HackTricks에 광고되길 원하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구입하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f)에 가입하거나 [**텔레그램 그룹**](https://t.me/peass)에 가입하거나** 트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우하세요.**
* **해킹 요령을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소로 PR을 제출하세요.

</details>

## 기본 정보

### 코드

* 이것은 작동하지 않습니다
* [https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/)에서 확인하세요
* 또는: [https://github.com/shellphish/how2heap/blob/master/glibc\_2.39/house\_of\_lore.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.39/house\_of\_lore.c)

### 목표

* 작은 bin에 가짜 작은 청크를 삽입하여 할당할 수 있도록 함

### 요구 사항

* 가짜 청크 생성
* 피해자 청크 및 가짜 청크의 주소를 알아야 함
* `bk` 및 `fd` 포인터를 수정할 수 있어야 함

### 공격

* 피해자 작은 청크가 할당됨
* 공격자는 몇 개의 가짜 작은 청크를 생성하고, 첫 번째 가짜 청크를 실제 청크를 가리키도록 `fd`를 설정하고, `bk`를 두 번째 가짜 청크를 가리키도록 함. 또한 두 번째 가짜 청크의 `bk`를 첫 번째 가짜 청크를 가리키도록 함.
* 그런 다음, 첫 번째 청크가 해제될 때 상단 청크에 병합되지 않도록 새로운 큰 청크가 할당됨
* 그런 다음, 초기 포인터가 해제되고 더 큰 크기의 두 번째 포인터가 할당되어 초기 작은 청크가 작은 bin에 배치됨
* 실제 작은 청크가 수정되어 `bk` 포인터가 가짜 청크를 가리키도록 함
* 그런 다음, 이 크기의 2개의 청크가 할당되면 공격자가 어떤 방식으로든 제어하는 유효하지 않은 청크가 먼저 오고 그 다음에 유효한 청크가 옴

## 참고 자료

* [https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/house\_of\_lore/)
* [https://heap-exploitation.dhavalkapil.com/attacks/house\_of\_lore](https://heap-exploitation.dhavalkapil.com/attacks/house\_of\_lore)
