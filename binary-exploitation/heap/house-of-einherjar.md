# Huis van Einherjar

<details>

<summary><strong>Leer AWS hak vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Basiese Inligting

### Kode

* Kyk na die voorbeeld van [https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)

### Doel

* Die doel is om geheue by amper enige spesifieke adres toe te ken.

### Vereistes

* Af een oor die kop van die volgende blokkie om die vorige in gebruik te wysig
* In staat wees om die `prev_size` data te wysig, wat deel is van die huidige blokkie (aan die einde)
* Heap lek

### Aanval

* `A` valse blokkie word binne 'n blokkie wat deur die aanvaller beheer word, geskep wat met `fd` en `bk` na die oorspronklike blokkie wys om beskerming te omseil
* 2 ander blokkies (`B` en `C`) word geskep.
* Deur die af een in die `B` een te misbruik, word die `prev in gebruik` bit skoongemaak en die `prev_size` data word oorskryf met die verskil tussen die plek waar die `C` blokkie toegewys is, na die valse `A` blokkie wat vooraf gegenereer is.
* Hierdie `prev_size` en die grootte van die valse blokkie `A` moet dieselfde wees om kontroles te omseil.
* Dan word die Tcache gevul
* Dan word `C` vrygestel sodat dit konsolideer met die valse blokkie `A`
* Dan word 'n nuwe blokkie `D` geskep wat in die valse `A` blokkie begin en die `B` blokkie dek
* Dan word `B` vrygestel en sy `fd` word oorskryf na die teikenadres wat dit na die teikenadres laat wys deur die `D` blokkie wat dit bevat, te misbruik.
* Dan word 2 mallocs gedoen omdat die tweede een die teikenadres gaan bevat

## Verwysings

* [https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)

<details>

<summary><strong>Leer AWS hak vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
