# House of Einherjar

<details>

<summary><strong>htARTE (HackTricks AWS Red Team 전문가)로부터 AWS 해킹을 제로부터 영웅까지 배우세요</strong>!</summary>

다른 HackTricks 지원 방법:

* **회사가 HackTricks에 광고되길 원하거나 HackTricks를 PDF로 다운로드하길 원하면** [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [Discord 그룹](https://discord.gg/hRep4RUj7f)** 또는 [텔레그램 그룹](https://t.me/peass)에 **가입**하거나 **트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우**하세요.
* **HackTricks** 및 **HackTricks Cloud** github 저장소로 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>

## 기본 정보

### 코드

* [https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)에서 예제를 확인하세요.

### 목표

* 거의 모든 특정 주소에 메모리를 할당하는 것이 목표입니다.

### 요구 사항

* 다음 청크의 헤더에서 하나가 부족하여 `prev in use`를 수정할 수 있어야 합니다.
* 현재 청크의 일부인 `prev_size` 데이터를 수정할 수 있어야 합니다.
* 힙 누수

### 공격

* 공격자가 제어하는 청크 내에 `fd`와 `bk`를 가리키는 가짜 청크 `A`가 생성되어 보호 기능을 우회합니다.
* 다른 2개의 청크(`B` 및 `C`)가 생성됩니다.
* `B`에서의 off by one을 악용하여 `prev in use` 비트가 지워지고 `prev_size` 데이터가 `C` 청크가 할당된 위치와 이전에 생성된 가짜 `A` 청크 사이의 차이로 덮어씌워집니다.
* 이 `prev_size`와 가짜 청크 `A`의 크기는 체크를 우회하기 위해 동일해야 합니다.
* 그런 다음, Tcache가 채워집니다.
* 그런 다음, `C`가 해제되어 가짜 청크 `A`와 통합됩니다.
* 그런 다음, 가짜 `A` 청크에서 시작하고 `B` 청크를 포함하는 새로운 청크 `D`가 생성됩니다.
* 그런 다음, `B`가 해제되고 `fd`가 대상 주소를 가리키도록 덮어씌워집니다. 이는 그것을 포함하는 `D` 청크를 악용합니다.
* 그런 다음, 대상 주소를 포함하는 두 번의 malloc가 수행됩니다.

## 참고 자료

* [https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/house\_of\_einherjar.c)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team 전문가)로부터 AWS 해킹을 제로부터 영웅까지 배우세요</strong>!</summary>

다른 HackTricks 지원 방법:

* **회사가 HackTricks에 광고되길 원하거나 HackTricks를 PDF로 다운로드하길 원하면** [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [Discord 그룹](https://discord.gg/hRep4RUj7f)** 또는 [텔레그램 그룹](https://t.me/peass)에 **가입**하거나 **트위터** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**를 팔로우**하세요.
* **HackTricks** 및 **HackTricks Cloud** github 저장소로 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>
