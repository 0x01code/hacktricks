# **Free2system**

In heap exploitation, a common technique is to overwrite the **`free`** GOT address to point to **`system`**. This way, when the **`free`** function is called on a chunk containing the string **`"/bin/sh"`**, a shell will be executed. This technique is often used in CTFs. 

## **Strlen2system**

Another common technique is to overwrite the **`strlen`** GOT address to point to **`system`**. This way, if the **`strlen`** function is called with user input, it's possible to pass the string **`"/bin/sh"`** and get a shell. This technique can also be used with the **`puts`** function, which will call **`strlen`** with the user input. 

These techniques are often used in heap exploitation CTFs to gain code execution. For more information, you can check out the [**Heap Exploitation**](https://heap-exploitation.readthedocs.io/en/latest/) guide. 
---
## **Heap Exploitation**

Heap exploitation is a set of techniques that can be used to exploit memory management vulnerabilities in C programs. These vulnerabilities can be used to corrupt data, the control flow of a program, or to leak information. Heap exploitation is a common technique used in CTFs to exploit memory corruption vulnerabilities in binary programs. 

There are several techniques that can be used to exploit the heap, including:

- **Fastbin Duplication**
- **House of Force**
- **House of Spirit**
- **House of Lore**
- **House of Orange**
- **Tcache Poisoning**

These techniques can be used to exploit memory corruption vulnerabilities in the heap in order to gain control over program execution. For more information, you can check out the [**Heap Exploitation**](https://heap-exploitation.readthedocs.io/en/latest/) guide. 

--- 
**Note**: The above information is based on the assumption that you are familiar with the basics of heap memory management in C. If you are not familiar with this topic, I would recommend reading up on it before attempting to understand heap exploitation. 

**Heap exploitation** is a technique used to exploit memory management vulnerabilities in C programs. These vulnerabilities can be used to corrupt data, control the flow of a program, or even execute arbitrary code. Heap exploitation is a common technique used in CTFs and can be used to exploit a wide range of vulnerabilities. 

There are several techniques that can be used to exploit heap memory vulnerabilities, including:

- **Heap Spraying**
- **Heap Feng Shui**
- **Heap Feng Shui with House of Spirit**
- **House of Force**
- **House of Lore**
- **House of Orange**

These techniques can be used to exploit memory management vulnerabilities in C programs and can be used to gain control over program execution. For more information on heap exploitation, you can check out the [**Heap Exploitation**](https://heap-exploitation.readthedocs.io/en/latest/) guide. 

--- 
**Note**: The above information is based on the assumption that you are familiar with the basics of heap memory management in C. If you are not familiar with this topic, I would recommend reading up on it before attempting to understand heap exploitation. 

Heap exploitation is a technique used to exploit memory management vulnerabilities in C programs. These vulnerabilities can be used to corrupt data, control the flow of a program, or even execute arbitrary code. Heap exploitation is a common technique used in CTFs and can be used to exploit a wide range of vulnerabilities. 

There are several techniques that can be used to exploit heap memory vulnerabilities, including:

- **Fastbin Duplication**
- **House of Force**
- **House of Spirit**
- **House of Lore**
- **House of Orange**

These techniques can be used to exploit memory management vulnerabilities in C programs and can be used to gain control over program execution. For more information on heap exploitation, you can check out the [**Heap Exploitation**](https://heap-exploitation.readthedocs.io/en/latest/) guide. 

--- 
**Note**: The above information is based on the assumption that you are familiar with the basics of heap memory management in C. If you are not familiar with this topic, I would recommend reading up on it before attempting to understand heap exploitation. 

Heap exploitation is a technique used to exploit memory management vulnerabilities in C programs. These vulnerabilities can be used to corrupt data, control the flow of a program, or even execute arbitrary code. Heap exploitation is a common technique used in CTFs and can be used to exploit a wide range of vulnerabilities. 

There are several techniques that can be used to exploit heap memory vulnerabilities, including:

- **Fastbin Duplication**
- **House of Spirit**
- **House of Force**
- **House of Unsorted Bin**

These techniques can be used to exploit memory management vulnerabilities in C programs and can be used to gain control over program execution. 
--- 
**Fastbin Duplication** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Spraying** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program Use the following code to test the Heap Feng Shui technique: 
```c
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

int main() {
    char *a = malloc(10);
    char *b = malloc(10);
    char *c = malloc(10);
    printf("A: %p\nB: %p\nC: %p\n", a, b, c);
    free(a);
    free(b);
    free(c);
    return 0;
}
```
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shunasdfi** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap   Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**House of Quality** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over program execution. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management  in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng Shui** is a technique used to exploit memory management vulnerabilities in C programs. This technique is used to exploit heap memory corruption vulnerabilities in order to gain control over the heap. 
--- 
**Heap Feng
## **Schutzmaßnahmen**

Der Schutz **Full RELRO** soll diese Art von Technik schützen, indem er beim Starten des Binärdatei alle Adressen der Funktionen auflöst und die **GOT-Tabelle nachher schreibgeschützt** macht:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## Referenzen

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

{% hint style="success" %}
Lerne & übe AWS-Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & übe GCP-Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterstütze HackTricks</summary>

* Überprüfe die [**Abonnementpläne**](https://github.com/sponsors/carlospolop)!
* **Trete der** 💬 [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories einreichst.

</details>
{% endhint %}
