# WWW2Exec - GOT/PLT

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ **рдЖрдкрдХреА рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, рджреЗрдЦреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## **рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА**

### **GOT: рдЧреНрд▓реЛрдмрд▓ рдСрдлрд╕реЗрдЯ рдЯреЗрдмрд▓**

**рдЧреНрд▓реЛрдмрд▓ рдСрдлрд╕реЗрдЯ рдЯреЗрдмрд▓ (GOT)** рдПрдХ рддрдВрддреНрд░ рд╣реИ рдЬреЛ рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд┐рдВрдХ рдХрд┐рдП рдЧрдП рдмрд╛рдЗрдирд░реА рдореЗрдВ **рдмрд╛рд╣рд░реА рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЗ рдкрддреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ рдпреЗ **рдкрддреЗ рд░рдирдЯрд╛рдЗрдо рддрдХ рдирд╣реАрдВ рдкрддреЗ рд╣реЛрддреЗ** (рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд┐рдВрдХрд┐рдВрдЧ рдХреЗ рдХрд╛рд░рдг), GOT рдПрдХ рддрд░реАрдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ **рдЗрди рдмрд╛рд╣рд░реА рдкреНрд░рддреАрдХреЛрдВ рдХреЗ рдкрддреЛрдВ рдХреЛ рдбрд╛рдпрдирд╛рдорд┐рдХ рд░реВрдк рд╕реЗ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдЬрдм рд╡реЗ рд╣рд▓ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред

GOT рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдПрдХ рдкреНрд░рддреАрдХ рдХрд╛ рд╕рдВрджрд░реНрдн рдХрд░рддреА рд╣реИ рдЬреЛ рдмрд╛рдЗрдирд░реА рджреНрд╡рд╛рд░рд╛ рдХреЙрд▓ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЬрдм рдПрдХ **рдлрд╝рдВрдХреНрд╢рди рдкрд╣рд▓реА рдмрд╛рд░ рдХреЙрд▓ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЙрд╕рдХрд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкрддрд╛ рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд┐рдВрдХрд░ рджреНрд╡рд╛рд░рд╛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ GOT рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдЙрд╕рдХреЗ рдмрд╛рдж рдХрд┐рдП рдЧрдП рдХреЙрд▓реНрд╕ рдореЗрдВ рд╡рд╣реА рдкрддрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ GOT рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкрддрд╛ рдлрд┐рд░ рд╕реЗ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рдУрд╡рд░рд╣реЗрдб рд╕реЗ рдмрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИред

### **PLT: рдкреНрд░реЛрд╕реАрдЬрд░ рд▓рд┐рдВрдХреЗрдЬ рдЯреЗрдмрд▓**

**рдкреНрд░реЛрд╕реАрдЬрд░ рд▓рд┐рдВрдХреЗрдЬ рдЯреЗрдмрд▓ (PLT)** GOT рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреА рд╣реИ рдФрд░ рдмрд╛рд╣рд░реА рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреНрд░реИрдореНрдкреЛрд▓реАрди рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддреА рд╣реИред рдЬрдм рдПрдХ рдмрд╛рдЗрдирд░реА **рдкрд╣рд▓реА рдмрд╛рд░ рдПрдХ рдмрд╛рд╣рд░реА рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЙрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рд╕рдВрдмрдВрдзрд┐рдд PLT рдореЗрдВ рдПрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдореЗрдВ рдирд┐рдпрдВрддреНрд░рдг рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрд╣ PLT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд┐рдВрдХрд░ рдХреЛ рдЖрдордВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реЛрддреА рд╣реИ рддрд╛рдХрд┐ рдпрджрд┐ рдкрддрд╛ рд╣рд▓ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдкрддрд╛ рд╣рд▓ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдпрд╣ GOT рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

**рдЗрд╕рд▓рд┐рдП,** GOT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХрд╛ рд╕реАрдзрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдмрд╛рд╣рд░реА рдлрд╝рдВрдХреНрд╢рди рдпрд╛ рдкреНрд░рддреАрдХ рдХрд╛ рдкрддрд╛ рд╣рд▓ рд╣реЛрддрд╛ рд╣реИред **PLT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдкрд╣рд▓реЗ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдЗрди рдкрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд┐рдВрдХрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

### GOT рдХреА рдЬрд╛рдБрдЪ

**`objdump -s -j .got ./exec`** рдХреЗ рд╕рд╛рде GOT рдЯреЗрдмрд▓ рдХрд╛ рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

![](<../../.gitbook/assets/image (118).png>)

**GEF рдореЗрдВ** рдПрдХ рдмрд╛рд░ **executable** рдХреЛ **рд▓реЛрдб** рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЖрдк **рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ** рдХрд┐ **GOT** рдореЗрдВ рдХреМрди-рдХреМрди рд╕реЗ **рдлрд╝рдВрдХреНрд╢рди рд╣реИрдВ**: `gefтЮд x/20x 0xDIR_GOT`

![](<../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (2) (2).png>)

GEF рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк **рдбреАрдмрдЧрд┐рдВрдЧ** рд╕рддреНрд░ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **`got`** рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП GOT рдЯреЗрдмрд▓ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:

![](<../../.gitbook/assets/image (493).png>)

### GOT2Exec

рдПрдХ рдмрд╛рдЗрдирд░реА рдореЗрдВ GOT рдореЗрдВ **рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЗ рдкрддреЗ** рдпрд╛ **PLT** рдЦрдВрдб рдХреЗ рдкрддреЗ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рдлрд╝рдВрдХреНрд╢рди рдкрддреЗ рдХреЛ рд▓реЛрдб рдХрд░реЗрдЧрд╛ред рдЗрд╕ рдЕрд░реНрдмрд┐рдЯреНрд░реЗрд░реА рд░рд╛рдЗрдЯ рдХрд╛ рд▓рдХреНрд╖реНрдп рд╣реИ рдХрд┐рд╕реА рдРрд╕реА рдЧреЛрдЯ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ **рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдирд╛** рдЬреЛ рдмрд╛рдж рдореЗрдВ **рдЙрдЪрд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ **`system`** **рдлрд╝рдВрдХреНрд╢рди** рдХреЗ **PLT** рдХрд╛ **рдкрддрд╛**ред

рдЖрджрд░реНрд╢рди, рдЖрдкрдХреЛ рдПрдХ **рдлрд╝рдВрдХреНрд╢рди** рдХреА **GOT** рдХреЛ **рдУрд╡рд░рд░рд╛рдЗрдб** рдХрд░рдирд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде **рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛** (рдЗрд╕рд▓рд┐рдП рдЖрдк рд╕рд┐рд╕реНрдЯрдо рдлрд╝рдВрдХреНрд╢рди рдХреЛ рднреЗрдЬреЗ рдЧрдП рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХреЗрдВрдЧреЗ)ред

рдпрджрд┐ **`system`** **рдХрд┐рд╕реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**, рддреЛ рд╕рд┐рд╕реНрдЯрдо рдлрд╝рдВрдХреНрд╢рди **PLT рдореЗрдВ рдПрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдирд╣реАрдВ рд╣реЛрдЧреА**ред рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ `system` рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ **рд▓реАрдХ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА** рдФрд░ рдлрд┐рд░ GOT рдХреЛ рдЗрд╕ рдкрддреЗ рдкрд░ рдкреЙрдЗрдВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

рдЖрдк **`objdump -j .plt -d ./vuln_binary`** рдХреЗ рд╕рд╛рде PLT рдкрддреЛрдВ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

## libc GOT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ

**libc рдХреА GOT** рдЖрдо рддреМрд░ рдкрд░ **рдЖрдВрд╢рд┐рдХ RELRO** рдХреЗ рд╕рд╛рде рдХреЙрдореНрдкрд╛рдЗрд▓ рдХреА рдЬрд╛рддреА рд╣реИ, рдЗрд╕реЗ рдПрдХ рдЕрдЪреНрдЫрд╛ рд▓рдХреНрд╖реНрдп рдмрдирд╛рддреЗ рд╣реИрдВ рдпрджрд┐ рдЗрд╕рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ ([**ASLR**](../common-binary-protections-and-bypasses/aslr/))ред

libc рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рдлрд╝рдВрдХреНрд╢рди рдЕрдиреНрдп рдЖрдВрддрд░рд┐рдХ рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВрдЧреЗ рдЬрд┐рдирдХреА GOT рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ [**рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдБ**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#1---targetting-libc-got-entries) рдкрд╛рдПрдВред

## **рд╡рди рдЧреИрдЬреЗрдЯ**

{% content-ref url="../rop-return-oriented-programing/ret2lib/one-gadget.md" %}
[one-gadget.md](../rop-return-oriented-programing/ret2lib/one-gadget.md)
{% endcontent-ref %}

## **рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп**

**рдкреВрд░реНрдг RELRO** рд╕реБрд░рдХреНрд╖рд╛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рддрдХрдиреАрдХ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдмрд╛рдЗрдирд░реА рд╢реБрд░реВ рд╣реЛрдиреЗ рдкрд░ рд╕рднреА рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЗ рдкрддреЛрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж **GOT рдЯреЗрдмрд▓ рдХреЛ рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп** рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ **рдЖрдкрдХреА рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдо
