# WWW2Exec - GOT/PLT

<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)コレクションを見る
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦で**フォロー**する [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**。**
* **ハッキングトリックを共有するために** [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出する。

</details>

## **基本情報**

### **GOT: Global Offset Table**

**Global Offset Table (GOT)** は、動的リンクされたバイナリで**外部関数のアドレスを管理する**ために使用されるメカニズムです。これらの**アドレスは実行時にはわかりません**（動的リンクのため）、GOTはこれらの外部シンボルのアドレスを**解決した後に動的に更新する方法**を提供します。

GOTの各エントリは、バイナリが呼び出す可能性のある外部ライブラリのシンボルに対応します。**関数が最初に呼び出されると、その実際のアドレスが動的リンカによって解決され、GOTに格納されます**。同じ関数への後続の呼び出しでは、GOTに格納されたアドレスが使用され、アドレスを再度解決するオーバーヘッドが回避されます。

### **PLT: Procedure Linkage Table**

**Procedure Linkage Table (PLT)** はGOTと密接に連携し、外部関数への呼び出しを処理するトランポリンとして機能します。バイナリが**外部関数を最初に呼び出すと、その関数に関連するPLTのエントリに制御が渡されます**。このPLTエントリは、関数のアドレスがまだ解決されていない場合に、動的リンカを呼び出してアドレスを解決する責任があります。アドレスが解決された後、それは**GOT**に格納されます。

**したがって、**外部関数や変数のアドレスが解決されると、GOTエントリが直接使用されます。**PLTエントリは、これらのアドレスの初期解決**を動的リンカを介して容易にするために使用されます。

## 実行を取得

### GOTを確認する

**`objdump -s -j .got ./exec`** を使用してGOTテーブルへのアドレスを取得します。

![](<../../.gitbook/assets/image (121).png>)

GEFで**実行可能ファイル**を**ロード**した後、**GOTにある関数**を**見る**ことができます：`gef➤ x/20x 0xDIR_GOT`

![](<../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (2) (2).png>)

GEFを使用して**デバッグ**セッションを開始し、**`got`** を実行してGOTテーブルを表示できます：

![](<../../.gitbook/assets/image (496).png>)

### GOT2Exec

バイナリ内のGOTには、**関数のアドレスまたは**後で実行される**PLT**セクションへの**アドレス**が含まれています。この任意の書き込みの目標は、後で**実行される関数のGOTエントリ**を**`system`** **関数のPLTのアドレス**に**上書きする**ことです。

理想的には、**制御可能なパラメータで呼び出される関数**の**GOT**を**上書き**します（したがって、システム関数に送信されるパラメータを制御できます）。

**`system`** **がスクリプトで使用されていない**場合、システム関数にはPLTにエントリがありません。このシナリオでは、まず`system`関数のアドレスをリークしてから、GOTをそのアドレスを指すように上書きする必要があります。

**`objdump -j .plt -d ./vuln_binary`** でPLTのアドレスを確認できます。

## libcのGOTエントリ

**libcのGOT**は通常、**部分的なRELRO**でコンパイルされており、そのアドレスを特定できれば（[**ASLR**](../common-binary-protections-and-bypasses/aslr/)）この攻撃の対象となります。

libcの一般的な関数は、コード実行を取得するために上書きできるように、他の内部関数を呼び出すことがあります。

[**このテクニックについての詳細はこちら**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#1---targetting-libc-got-entries)を参照してください。

## **One Gadget**

{% content-ref url="../rop-return-oriented-programing/ret2lib/one-gadget.md" %}
[one-gadget.md](../rop-return-oriented-programing/ret2lib/one-gadget.md)
{% endcontent-ref %}

## **保護**

**Full RELRO** 保護は、バイナリが起動されるとすべての関数のアドレスを解決し、**GOTテーブルを読み取り専用**にすることで、この種のテクニックに対抗するために意図されています：

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## 参考文献

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)コレクションを見る
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦で**フォロー**する [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**。**
* **ハッキングトリックを共有するために** [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出する。

</details>
