# WWW2Exec - GOT/PLT

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen** m√∂chten oder **HackTricks in PDF herunterladen** m√∂chten, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

## **Grundlegende Informationen**

### **GOT: Global Offset Table**

Die **Global Offset Table (GOT)** ist ein Mechanismus, der in dynamisch verkn√ºpften Bin√§rdateien verwendet wird, um die **Adressen externer Funktionen** zu verwalten. Da diese **Adressen erst zur Laufzeit bekannt sind** (aufgrund der dynamischen Verkn√ºpfung), bietet die GOT eine M√∂glichkeit, die Adressen dieser externen Symbole **dynamisch zu aktualisieren**, sobald sie aufgel√∂st sind.

Jeder Eintrag in der GOT entspricht einem Symbol in den externen Bibliotheken, die die Bin√§rdatei aufrufen kann. Wenn eine **Funktion zum ersten Mal aufgerufen wird, wird ihre tats√§chliche Adresse vom dynamischen Linker aufgel√∂st und in der GOT gespeichert**. Nachfolgende Aufrufe derselben Funktion verwenden die in der GOT gespeicherte Adresse, um den Overhead der erneuten Adressaufl√∂sung zu vermeiden.

### **PLT: Procedure Linkage Table**

Die **Procedure Linkage Table (PLT)** arbeitet eng mit der GOT zusammen und dient als Trampolin, um Aufrufe externer Funktionen zu verarbeiten. Wenn eine Bin√§rdatei eine **externe Funktion zum ersten Mal aufruft, wird die Kontrolle an einen Eintrag in der PLT √ºbergeben, der mit dieser Funktion verkn√ºpft ist**. Dieser PLT-Eintrag ist daf√ºr verantwortlich, den dynamischen Linker aufzurufen, um die Adresse der Funktion aufzul√∂sen, wenn sie noch nicht aufgel√∂st wurde. Nachdem die Adresse aufgel√∂st ist, wird sie in der **GOT** gespeichert.

**Daher** werden GOT-Eintr√§ge direkt verwendet, sobald die Adresse einer externen Funktion oder Variablen aufgel√∂st ist. **PLT-Eintr√§ge werden verwendet, um die anf√§ngliche Aufl√∂sung** dieser Adressen √ºber den dynamischen Linker zu erleichtern.

## Ausf√ºhrung erhalten

### √úberpr√ºfen der GOT

Holen Sie sich die Adresse der GOT-Tabelle mit: **`objdump -s -j .got ./exec`**

![](<../../.gitbook/assets/image (121).png>)

Beobachten Sie, wie nach dem **Laden** des **ausf√ºhrbaren** Codes in GEF die **Funktionen** in der **GOT** angezeigt werden k√∂nnen: `gef‚û§ x/20x 0xADDR_GOT`

![](<../../.gitbook/assets/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (2) (2).png>)

Mit GEF k√∂nnen Sie eine **Debugging-Sitzung starten** und **`got`** ausf√ºhren, um die GOT-Tabelle zu sehen:

![](<../../.gitbook/assets/image (496).png>)

### GOT2Exec

In einem Bin√§rcode enth√§lt die GOT die **Adressen der Funktionen oder** des **PLT**-Abschnitts, der die Funktionsadresse laden wird. Das Ziel dieses willk√ºrlichen Schreibens besteht darin, einen GOT-Eintrag einer Funktion zu **√ºberschreiben, die sp√§ter ausgef√ºhrt wird, mit** der **Adresse** des PLT der **`system`-Funktion** beispielsweise.

Idealerweise √ºberschreiben Sie die **GOT** einer **Funktion**, die **mit von Ihnen kontrollierten Parametern aufgerufen wird** (damit Sie die an die Systemfunktion gesendeten Parameter steuern k√∂nnen).

Wenn **`system`** **nicht vom Bin√§rcode verwendet wird**, wird die Systemfunktion **keinen Eintrag im PLT haben**. In diesem Szenario m√ºssen Sie zuerst die Adresse der `system`-Funktion **leaken** und dann die GOT √ºberschreiben, um auf diese Adresse zu verweisen.

Sie k√∂nnen die PLT-Adressen mit **`objdump -j .plt -d ./vuln_binary`** sehen

## libc-GOT-Eintr√§ge

Die **GOT von libc** wird normalerweise mit **partiellem RELRO** kompiliert, was sie zu einem interessanten Ziel macht, vorausgesetzt, dass es m√∂glich ist, ihre Adresse herauszufinden ([**ASLR**](../common-binary-protections-and-bypasses/aslr/)).

Gemeinsame Funktionen der libc werden **andere interne Funktionen** aufrufen, deren GOT √ºberschrieben werden k√∂nnte, um Codeausf√ºhrung zu erhalten.

Finden Sie [**weitere Informationen zu dieser Technik hier**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#1---targetting-libc-got-entries).

## **Free2system**

Bei Heap-Exploitation-CTFs ist es h√§ufig m√∂glich, den Inhalt von Chunks zu steuern und irgendwann sogar die GOT-Tabelle zu √ºberschreiben. Ein einfacher Trick, um RCE zu erhalten, wenn keine Gadgets verf√ºgbar sind, besteht darin, die `free`-GOT-Adresse zu √ºberschreiben, um auf `system` zu verweisen, und innerhalb eines Chunks `"/bin/sh"` zu schreiben. Auf diese Weise wird beim Freigeben dieses Chunks `system("/bin/sh")` ausgef√ºhrt.

## **Strlen2system**

Eine weitere g√§ngige Technik besteht darin, die **`strlen`-GOT-Adresse auf** `system` zu verweisen, sodass bei Aufruf dieser Funktion mit Benutzereingabe m√∂glich ist, den String `"/bin/sh"` zu √ºbergeben und eine Shell zu erhalten.

Dar√ºber hinaus ist es m√∂glich, wenn `puts` mit Benutzereingabe verwendet wird, die `puts`-GOT-Adresse auf `system` zu √ºberschreiben und den String `"/bin/sh"` zu √ºbergeben, um eine Shell zu erhalten, da **`puts` `strlen` mit der Benutzereingabe aufrufen wird**.

## **One Gadget**

{% content-ref url="../rop-return-oriented-programing/ret2lib/one-gadget.md" %}
[one-gadget.md](../rop-return-oriented-programing/ret2lib/one-gadget.md)
{% endcontent-ref %}

## **Ausnutzen der GOT aus dem Heap**

Ein h√§ufiger Weg, um RCE aus einer Heap-Schwachstelle zu erhalten, besteht darin, einen Fastbin zu missbrauchen, sodass es m√∂glich ist, den Teil der GOT-Tabelle in den Fastbin aufzunehmen. Daher ist es immer m√∂glich, den Zeiger einer Funktion, normalerweise `free`, zu √ºberschreiben.\
Dann, wenn `free` auf `system` zeigt und ein Chunk freigegeben wird, in dem `/bin/sh\x00` geschrieben wurde, wird eine Shell ausgef√ºhrt.

Es ist m√∂glich, ein [**Beispiel hier zu finden**](https://ctf-wiki.mahaloz.re/pwn/linux/glibc-heap/chunk\_extend\_overlapping/#hitcon-trainging-lab13)**.**
## **Schutzma√ünahmen**

Der Schutz **Full RELRO** soll diese Art von Technik sch√ºtzen, indem er beim Starten des Bin√§rdatei alle Adressen der Funktionen aufl√∂st und die **GOT-Tabelle nachher schreibgesch√ºtzt** macht:

{% content-ref url="../common-binary-protections-and-bypasses/relro.md" %}
[relro.md](../common-binary-protections-and-bypasses/relro.md)
{% endcontent-ref %}

## Referenzen

* [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
