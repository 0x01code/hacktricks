# WWW2Exec - .dtors рдФрд░ .fini\_array

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## .dtors

{% hint style="danger" %}
рдЖрдЬрдХрд▓ рдХрд┐рд╕реА рднреА **рдмрд╛рдЗрдирд░реА рдореЗрдВ .dtors рд╕реЗрдХреНрд╢рди рдкрд╛рдирд╛ рдмрд╣реБрдд рдЕрдЬреАрдм рд╣реИ!**
{% endhint %}

рдбрд┐рд╕реНрдЯреНрд░рдХреНрдЯрд░реНрд╕ рд╡реЗ рдлрд╝рдВрдХреНрд╢рди рд╣реИрдВ рдЬреЛ **рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ** (рдЬрдм `main` рдлрд╝рдВрдХреНрд╢рди рд╡рд╛рдкрд╕ рд▓реМрдЯрддрд╛ рд╣реИ) **рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд** рд╣реЛрддреЗ рд╣реИрдВред\
рдЗрди рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЗ рдкрддреЗ рдмрд╛рдЗрдирд░реА рдХреЗ **`.dtors`** рд╕реЗрдХреНрд╢рди рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **рдПрдХ рд╢реИрд▓рдХреЛрдб** рдореЗрдВ **рдкрддреЗ** рдХреЛ **рд▓рд┐рдЦрдиреЗ** рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ **`__DTOR_END__`** , рддреЛ рдпрд╣ **рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд** рд╣реЛ рдЬрд╛рдПрдЧрд╛ред

рдЗрд╕ рд╕реЗрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ:
```bash
objdump -s -j .dtors /exec
rabin -s /exec | grep тАЬ__DTORтАЭ
```
рд╕рд╛рдорд╛рдиреНрдпрдд: рдЖрдкрдХреЛ **DTOR** рдорд╛рд░реНрдХрд░ **`ffffffff`** рдФрд░ **`00000000`** рдХреЗ рдмреАрдЪ рдорд┐рд▓реЗрдВрдЧреЗред рддреЛ рдЕрдЧрд░ рдЖрдк рдмрд╕ рдЙрди рдорд╛рдиреЛрдВ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ **рдХреЛрдИ рдлрд╝рдВрдХреНрд╢рди рд░рдЬрд┐рд╕реНрдЯрд░ рдирд╣реАрдВ рд╣реИ**ред рдЗрд╕рд▓рд┐рдП **`00000000`** рдХреЛ **рд╢реИрд▓рдХреЛрдб рдХреЗ рдкрддреЗ** рд╕реЗ **рдУрд╡рд░рд░рд╛рдЗрдЯ** рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

{% hint style="warning" %}
рдмрд┐рд▓реНрдХреБрд▓, рдкрд╣рд▓реЗ рдЖрдкрдХреЛ рд╢реИрд▓рдХреЛрдб рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ **рд╕реНрдерд╛рди рдЦреЛрдЬрдирд╛** рд╣реЛрдЧрд╛ рддрд╛рдХрд┐ рдЖрдк рдмрд╛рдж рдореЗрдВ рдЗрд╕реЗ рдмреБрд▓рд╛ рд╕рдХреЗрдВред
{% endhint %}

## **.fini\_array**

рдореВрд▓ рд░реВрдк рд╕реЗ рдпрд╣ рдПрдХ рд╕рдВрд░рдЪрдирд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **рдлрд╝рдВрдХреНрд╢рди рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХреЙрд▓ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ**, рдЬреИрд╕реЗ **`.dtors`**ред рдпрд╣ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреЗ **рд╢реИрд▓рдХреЛрдб рдХреЛ рдПрдХ рдкрддреЗ рдкрд░ рдЬрд╛рдХрд░ рдмреБрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ**, рдпрд╛ рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдЖрдкрдХреЛ **рджреЛрдмрд╛рд░рд╛ `main` рдкрд░ рдЬрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ** рддрд╛рдХрд┐ рдЖрдк **рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХрд╛ рджреВрд╕рд░реА рдмрд╛рд░ рд╢реЛрдз рдХрд░ рд╕рдХреЗрдВ**ред
```bash
objdump -s -j .fini_array ./greeting

./greeting:     file format elf32-i386

Contents of section .fini_array:
8049934 a0850408

#Put your address in 0x8049934
```
### рдЕрдирдВрдд рд▓реВрдк

**`.fini_array`** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдирдВрдд рд▓реВрдк рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдпрд╣рд╛рдБ [**рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣рд╛рдБ рдХреНрдпрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛**](https://guyinatuxedo.github.io/17-stack\_pivot/insomnihack18\_onewrite/index.html)**:** рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХрдо рд╕реЗ рдХрдо 2 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ **`.fini_array`** рдореЗрдВ рд╣реИрдВ, рддреЛ рдЖрдк:

* рдЕрдкрдиреА рдкрд╣рд▓реА рд▓реЗрдЦрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рд╡рд┐рдХрд▓реНрдкреА рд▓реЗрдЦрди рдХрд╛рд░реНрдп** рдХреЛ рдлрд┐рд░ рд╕реЗ рдмреБрд▓рд╛рдПрдВ
* рдлрд┐рд░, **`__libc_csu_fini`** рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╕реНрдЯреИрдХ рдореЗрдВ рд╡рд╛рдкрд╕реА рдкрддрд╛ рд▓рдЧрд╛рдПрдВ (рдЬреЛ рд╕рднреА `.fini_array` рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдмреБрд▓рд╛рдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ) рдФрд░ рд╡рд╣рд╛рдБ **`__libc_csu_fini`** рдХрд╛ рдкрддрд╛ рдбрд╛рд▓реЗрдВ
* рдпрд╣ **`__libc_csu_fini`** рдХреЛ рдлрд┐рд░ рд╕реЗ рдмреБрд▓рд╛рдПрдЧрд╛ рдФрд░ **`.fini_array`** рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдлрд┐рд░ рд╕реЗ рдмреБрд▓рд╛рдПрдЧрд╛ рдЬреЛ рд╡рд┐рдХрд▓реНрдкреА WWW рдлрд╝рдВрдХреНрд╢рди рдХреЛ 2 рдмрд╛рд░ рдмреБрд▓рд╛рдПрдЧрд╛: рдПрдХ рдмрд╛рд░ рдХреЗ рд▓рд┐рдП **рд╡рд┐рдХрд▓реНрдкреА рд▓реЗрдЦрди** рдФрд░ рдПрдХ рдФрд░ рдмрд╛рд░ **`__libc_csu_fini`** рдХреЗ рд╡рд╛рдкрд╕реА рдкрддреЗ рдХреЛ рдлрд┐рд░ рд╕реЗ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдЯреИрдХ рдкрд░ рдЕрдкрдиреЗ рдЖрдк рдХреЛ рдлрд┐рд░ рд╕реЗ рдмреБрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдПред

{% hint style="danger" %}
[**рдкреВрд░реНрдг RELRO**](../common-binary-protections-and-bypasses/relro.md)** рдХреЗ рд╕рд╛рде**, рдЦрдВрдб **`.fini_array`** рдХреЛ **рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп** рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
{% endhint %}
