# PIE

{% hint style="success" %}
Lernen Sie AWS-Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen Sie GCP-Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositorys senden.

</details>
{% endhint %}

## Grundlegende Informationen

Ein als PIE kompiliertes Bin√§rprogramm, oder **Position Independent Executable**, bedeutet, dass das **Programm bei jeder Ausf√ºhrung an verschiedenen Speicherorten geladen werden kann**, was das Verwenden von fest codierten Adressen verhindert.

Der Trick, um diese Bin√§rdateien auszunutzen, besteht darin, die **relativen Adressen** auszunutzen - die Abst√§nde zwischen den Teilen des Programms bleiben gleich, auch wenn sich die absoluten Positionen √§ndern. Um **PIE zu umgehen, m√ºssen Sie nur eine Adresse leaken**, normalerweise vom **Stack** aus, indem Sie Schwachstellen wie Format-String-Angriffe ausnutzen. Sobald Sie eine Adresse haben, k√∂nnen Sie andere durch ihre **festen Abst√§nde** berechnen.

Ein hilfreicher Hinweis beim Ausnutzen von PIE-Bin√§rdateien ist, dass ihre **Basisadresse normalerweise mit 000 endet**, da Speicherseiten die Einheiten der Zufallsverteilung sind, die in 0x1000-Byte-Gr√∂√üen vorliegen. Diese Ausrichtung kann ein kritischer **Check sein, wenn ein Exploit nicht wie erwartet funktioniert**, und darauf hinweisen, ob die richtige Basisadresse identifiziert wurde.\
Oder Sie k√∂nnen dies f√ºr Ihren Exploit verwenden, wenn Sie leaken, dass eine Adresse sich bei **`0x649e1024`** befindet, wissen Sie, dass die **Basisadresse `0x649e1000`** ist und von dort aus einfach **Offsets von Funktionen und Positionen berechnen** k√∂nnen.

## Umgehungen

Um PIE zu umgehen, muss eine Adresse des geladenen Bin√§rprogramms **geleakt** werden, hierf√ºr gibt es einige Optionen:

* **ASLR deaktiviert**: Wenn ASLR deaktiviert ist, wird ein mit PIE kompiliertes Bin√§rprogramm immer an der **gleichen Adresse geladen**, daher ist **PIE nutzlos**, da die Adressen der Objekte immer am gleichen Ort sein werden.
* Den Leak **erhalten** (√ºblich bei einfachen CTF-Herausforderungen, [**√ºberpr√ºfen Sie dieses Beispiel**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit))
* **Brute-Force EBP- und EIP-Werte** im Stack, bis Sie die richtigen leaken:

{% content-ref url="bypassing-canary-and-pie.md" %}
[bypassing-canary-and-pie.md](bypassing-canary-and-pie.md)
{% endcontent-ref %}

* Verwenden Sie eine **beliebige Lese**-Schwachstelle wie [**Format-String**](../../format-strings/), um eine Adresse des Bin√§rprogramms zu leaken (z. B. vom Stack, wie bei der vorherigen Technik), um die Basis des Bin√§rprogramms zu erhalten und von dort aus Offsets zu verwenden. [**Finden Sie hier ein Beispiel**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-bypass).

## Referenzen

* [https://ir0nstone.gitbook.io/notes/types/stack/pie](https://ir0nstone.gitbook.io/notes/types/stack/pie)

{% hint style="success" %}
Lernen Sie AWS-Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen Sie GCP-Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositorys senden.

</details>
{% endhint %}
