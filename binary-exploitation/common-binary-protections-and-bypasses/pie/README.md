# PIE

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>を通じてゼロからヒーローまでAWSハッキングを学ぶ</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

- **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
- [**公式PEASS＆HackTricksスウェグ**](https://peass.creator-spring.com)を入手する
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見る
- 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)で**フォロー**する。
- **ハッキングトリックを共有するために** [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出する。

</details>

## 基本情報

PIE（Position Independent Executable）としてコンパイルされたバイナリは、**プログラムが実行されるたびに異なるメモリ位置にロード**されるため、ハードコードされたアドレスを防ぎます。

これらのバイナリを悪用するトリックは、**相対アドレスを悪用**することにあります。プログラムの部分間のオフセットは、絶対位置が変わっても同じままです。**PIEをバイパスするには、通常はスタックなどの脆弱性を利用して**アドレスを1つリークするだけで十分です。アドレスを取得すると、**固定オフセット**によって他のアドレスを計算できます。

PIEバイナリを悪用する際の役立つヒントは、**ベースアドレスが通常000で終わる**ことです。これは、メモリページがランダム化の単位であり、0x1000バイトのサイズであるためです。このアライメントは、正しいベースアドレスが特定されたかどうかを示すため、エクスプロイトが期待どおりに機能していない場合に重要な**チェック**となります。\
または、エクスプロイトにこれを使用できます。アドレスが**`0x649e1024`**にあることが漏洩した場合、**ベースアドレスが`0x649e1000`**であることがわかり、そこから関数や場所の**オフセットを計算**するだけです。

## バイパス

PIEをバイパスするには、**ロードされたバイナリのアドレスをいくつか漏洩する必要**があります。これにはいくつかのオプションがあります：

- **ASLRが無効になっている**場合：ASLRが無効になっている場合、PIEでコンパイルされたバイナリは常に**同じアドレスにロード**されるため、**PIEは無意味**になります。
- 漏洩が**与えられる**（簡単なCTFチャレンジで一般的、[**この例をチェック**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit)）
- スタック内の正しい値を漏洩するまで、スタック内の**EBPおよびEIPの値をブルートフォース**する：

{% content-ref url="bypassing-canary-and-pie.md" %}
[bypassing-canary-and-pie.md](bypassing-canary-and-pie.md)
{% endcontent-ref %}

- スタックからバイナリのアドレスを漏洩するために[**フォーマット文字列**](../../format-strings/)などの**任意の読み取り**脆弱性を使用し、バイナリのベースを取得してそこからオフセットを使用します。[**こちらで例を見つける**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-bypass)。

## 参考文献

- [https://ir0nstone.gitbook.io/notes/types/stack/pie](https://ir0nstone.gitbook.io/notes/types/stack/pie)

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>を通じてゼロからヒーローまでAWSハッキングを学ぶ</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

- **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
- [**公式PEASS＆HackTricksスウェグ**](https://peass.creator-spring.com)を入手する
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見る
- 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)で**フォロー**する。
- **ハッキングトリックを共有するために** [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出する。

</details>
