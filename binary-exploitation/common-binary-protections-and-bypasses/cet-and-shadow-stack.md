# CET ve Shadow Stack

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana dönüşün</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile öğrenin!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı paylaşarak PR göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>

## Kontrol Akışı Uygulama Teknolojisi (CET)

**CET**, **Dönüşe Yönelik Programlama (ROP)** ve **Atlamaya Yönelik Programlama (JOP)** gibi yaygın kontrol akışı ele geçirme saldırılarını engellemek amacıyla donanım seviyesinde uygulanan bir güvenlik özelliğidir. Bu tür saldırılar, bir programın yürütme akışını manipüle ederek kötü amaçlı kodu yürütmek veya zararsız kod parçalarını bir araya getirerek kötü amaçlı bir eylem gerçekleştirmek için kullanılır.

CET, **Dolaylı Dalış Takibi (IBT)** ve **Shadow Stack** olmak üzere iki ana özellik sunar.

* **IBT**, dolaylı sıçramaların ve çağrıların geçerli hedeflere yapıldığından emin olur. Dolaylı dallanmalar için geçerli hedefler olarak açıkça işaretlenen bir yeni komut seti kullanılarak bu sağlanır, böylece saldırganların kontrol akışını keyfi konumlara yönlendirmesini engeller.
* **Shadow Stack**, dönüş adresleri için bütünlük sağlayan bir mekanizmadır. Normal çağrı yığınından ayrılmış, güvenli ve gizli bir dönüş adresi kopyasını tutar. Bir işlev döndüğünde, dönüş adresi shadow stack'e karşı doğrulanır, bu da saldırganların kontrol akışını ele geçirmek için yığında dönüş adreslerini üzerine yazmasını engeller.

## Shadow Stack

**Shadow stack**, **yalnızca dönüş adreslerini depolamak için kullanılan özel bir yığın**tır. Normal yığınla birlikte çalışır ancak korunur ve normal program yürütmesinden gizlenir, bu da saldırganların müdahale etmesini zorlaştırır. Shadow stack'in temel amacı, dönüş adreslerinde yapılan herhangi bir değişikliğin kullanılmadan önce tespit edilmesini sağlamaktır, bu da ROP saldırılarını etkili bir şekilde azaltır.

## CET ve Shadow Stack'in Saldırıları Nasıl Önlediği

**ROP ve JOP saldırıları**, bir uygulamanın kontrol akışını ele geçirme yeteneğine dayanır ve onlara yığında işaretçileri veya dönüş adreslerini üzerine yazma izni veren zayıflıkları kullanarak uygulamanın kontrol akışını ele geçirirler. Varolan kod parçaları veya dönüşe yönelik programlama parçaları dizilerine yönlendirerek saldırganlar keyfi kodları yürütebilirler.

* **CET'in IBT** özelliği, dolaylı dallanmaların yalnızca açıkça geçerli hedefler olarak işaretlenmiş adreslere sıçramasını sağlayarak bu saldırıları önemli ölçüde zorlaştırır. Bu, saldırganların ikili dosya üzerine yayılmış keyfi parçaları yürütmesini imkansız hale getirir.
* **Shadow stack** ise, saldırganın normal yığında bir dönüş adresini üzerine yazabilse bile, işlevden dönerken bozulmuş adresi shadow stack'te saklanan güvenli kopya ile karşılaştırıldığında farklılık tespit edilir. Adresler eşleşmiyorsa, program saldırının başarılı olmasını engellemek için sonlandırılabilir veya diğer güvenlik önlemleri alınabilir.
