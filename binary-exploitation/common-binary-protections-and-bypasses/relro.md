# Relro

## Relro

**RELRO**は**Relocation Read-Only**の略で、**GOT (Global Offset Table)**の上書きに関連するリスクを緩和するためにバイナリで使用されるセキュリティ機能です。この概念を明確にするために、**Partial RELRO**と**Full RELRO**の2つの異なるタイプに分けて説明します。

### **Partial RELRO**

**Partial RELRO**は、バイナリのパフォーマンスに大きな影響を与えることなくセキュリティを向上させるシンプルなアプローチを取ります。**メモリ内のプログラムの変数よりもGOTを上に配置することで、Partial RELROはバッファオーバーフローがGOTに到達して破損させるのを防ぐことを目指します**。

これは**GOTが任意の書き込み**脆弱性から悪用されるのを防ぎません。

### **Full RELRO**

**Full RELRO**は、**GOTと.fini\_array**セクションを完全に**読み取り専用**にすることで保護を強化します。バイナリが開始されると、すべての関数アドレスが解決され、GOTにロードされます。その後、GOTは読み取り専用としてマークされ、ランタイム中にそれに対する変更を防ぎます。

ただし、Full RELROのトレードオフはパフォーマンスと起動時間です。Full RELROを有効にするには、GOTを読み取り専用にマークする前に起動時にすべての動的シンボルを解決する必要があるため、**Full RELROが有効になっているバイナリはロード時間が長くなる可能性があります**。この追加の起動オーバーヘッドのため、Full RELROはすべてのバイナリでデフォルトで有効になっているわけではありません。

バイナリでFull RELROが**有効**かどうかを確認することができます。
```bash
readelf -l /proc/ID_PROC/exe | grep BIND_NOW
```
## バイパス

完全なRELROが有効になっている場合、GOTテーブルに書き込む必要がない別の方法を見つけることで任意の実行を得ることができます。

**LIBCのGOTは通常Partial RELRO**であるため、任意の書き込みで変更できます。[libcのGOTエントリをターゲットにする](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#1---targetting-libc-got-entries)**に関する詳細情報**。

{% hint style="success" %}
AWSハッキングの学習と実践:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCPハッキングの学習と実践: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricksのサポート</summary>

* [**購読プラン**](https://github.com/sponsors/carlospolop)をチェック！
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**をフォロー**してください。
* **HackTricks**と**HackTricks Cloud**のGitHubリポジトリにPRを提出してハッキングトリックを共有してください。

</details>
{% endhint %}
