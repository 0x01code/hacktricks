# Ret2ret & Reo2pop

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS-familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFT's**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

## Ret2ret

Die hoofdoel van hierdie tegniek is om te probeer **ASLR te omseil deur 'n bestaande aanwyser in die stok te misbruik**.

Oor die algemeen word stokoorvloeiings veroorsaak deur strings, en **strings eindig met 'n nulbyte aan die einde** in die geheue. Dit maak dit moontlik om die plek wat deur 'n bestaande aanwyser in die stok aangedui word, te probeer verminder. As die stok byvoorbeeld `0xbfffffdd` bevat het, kan hierdie oorvloeiing dit omskep na `0xbfffff00` (let op die laaste genulbyteerde byte).

As daardie adres na ons shellkode in die stok verwys, is dit moontlik om die vloei daardie adres te laat bereik deur **adresse by die `ret`-instruksie te voeg** totdat dit bereik word.

Dus sal die aanval so lyk:

* NOP-glybaan
* Shellkode
* Oorskryf die stok vanaf die EIP met **adresse na `ret`** (RET-glybaan)
* 0x00 bygevoeg deur die string wat 'n adres van die stok wysig om dit na die NOP-glybaan te laat wys

Deur [**hierdie skakel**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2ret.c) kan jy 'n voorbeeld sien van 'n kwesbare bin√™re l√™er en [**in hierdie een**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2retexploit.c) die aanval.

## Ret2pop

In die geval dat jy 'n **perfekte aanwyser in die stok vind wat jy nie wil wysig nie** (in `ret2ret` het ons die finale laagste byte na `0x00` verander), kan jy dieselfde `ret2ret`-aanval uitvoer, maar die **lengte van die RET-glybaan moet met 1 verkort word** (sodat die finale `0x00` die data net voor die perfekte aanwyser oorskryf), en die **laaste** adres van die RET-glybaan moet na **`pop <reg>; ret`** wys.\
Op hierdie manier sal die **data voor die perfekte aanwyser van die stok verwyder word** (dit is die data wat deur die `0x00` geraak word) en die **finale `ret` sal na die perfekte adres** in die stok wys sonder enige verandering.

Deur [**hierdie skakel**](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2pop.c) kan jy 'n voorbeeld sien van 'n kwesbare bin√™re l√™er en [**in hierdie een** ](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/ret2popexploit.c)die aanval.

## Verwysings

* [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md)

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS-familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFT's**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
