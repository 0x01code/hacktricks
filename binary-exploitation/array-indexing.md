# Indexation de tableau

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

## Informations de base

Cette cat√©gorie inclut toutes les vuln√©rabilit√©s qui se produisent parce qu'il est possible de remplacer certaines donn√©es par des erreurs dans la manipulation des index dans les tableaux. Il s'agit d'une cat√©gorie tr√®s large sans m√©thodologie sp√©cifique car le m√©canisme d'exploitation repose enti√®rement sur les conditions de la vuln√©rabilit√©.

Cependant, vous pouvez trouver quelques exemples int√©ressants :

* [https://guyinatuxedo.github.io/11-index/swampctf19\_dreamheaps/index.html](https://guyinatuxedo.github.io/11-index/swampctf19\_dreamheaps/index.html)
* Il y a **2 tableaux en collision**, un pour les **adresses** o√π les donn√©es sont stock√©es et un avec les **tailles** de ces donn√©es. Il est possible de remplacer l'un par l'autre, permettant d'√©crire une adresse arbitraire en la d√©signant comme une taille. Cela permet d'√©crire l'adresse de la fonction `free` dans la table GOT, puis de la remplacer par l'adresse de `system`, et d'appeler free √† partir d'une m√©moire avec `/bin/sh`.
* [https://guyinatuxedo.github.io/11-index/csaw18\_doubletrouble/index.html](https://guyinatuxedo.github.io/11-index/csaw18\_doubletrouble/index.html)
* 64 bits, pas de nx. Remplacez une taille pour obtenir une sorte de d√©bordement de tampon o√π tout va √™tre utilis√© comme un double nombre et tri√© du plus petit au plus grand, il est donc n√©cessaire de cr√©er un shellcode qui satisfait cette exigence, en tenant compte du fait que le canari ne doit pas √™tre d√©plac√© de sa position et enfin en √©crasant le RIP avec une adresse de ret, qui satisfait les exigences pr√©c√©dentes et en pla√ßant l'adresse la plus grande une nouvelle adresse pointant vers le d√©but de la pile (fuit√©e par le programme) afin de pouvoir utiliser le ret pour sauter l√†-bas.
* [https://faraz.faith/2019-10-20-secconctf-2019-sum/](https://faraz.faith/2019-10-20-secconctf-2019-sum/)
* 64 bits, pas de relro, canari, nx, pas de pie. Il y a un d√©calage d'un octet dans un tableau dans la pile qui permet de contr√¥ler un pointeur accordant WWW (il √©crit la somme de tous les nombres du tableau dans l'adresse √©cras√©e par le d√©calage d'un octet dans le tableau). La pile est contr√¥l√©e de sorte que l'adresse GOT `exit` est √©cras√©e avec `pop rdi; ret`, et dans la pile est ajout√©e l'adresse de `main` (retour √† `main`). Ensuite, une cha√Æne ROP pour divulguer l'adresse mise dans la GOT en utilisant puts est utilis√©e (`exit` sera appel√© donc il appellera `pop rdi; ret` ex√©cutant ainsi cette cha√Æne dans la pile). Enfin, une nouvelle cha√Æne ROP ex√©cutant ret2lib est utilis√©e.
* [https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html)
* 32 bits, pas de relro, pas de canari, nx, pie. Abuser d'un mauvais index pour divulguer des adresses de libc et de tas √† partir de la pile. Abuser du d√©bordement de tampon pour effectuer un ret2lib appelant `system('/bin/sh')` (l'adresse du tas est n√©cessaire pour contourner une v√©rification).
