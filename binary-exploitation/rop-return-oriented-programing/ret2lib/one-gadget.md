# One Gadget

{% hint style="success" %}
学习并练习 AWS 黑客技术：<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks 培训 AWS 红队专家 (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
学习并练习 GCP 黑客技术：<img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks 培训 GCP 红队专家 (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持 HackTricks</summary>

* 检查[**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或 **关注**我们的 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github 仓库提交 PR 来分享黑客技巧。**

</details>
{% endhint %}

## 基本信息

[**One Gadget**](https://github.com/david942j/one\_gadget) 允许获取一个 shell，而不是使用 **system** 和 **"/bin/sh"。One Gadget** 将在 libc 库中找到一种方法来使用一个 **地址** 获取 shell (`execve("/bin/sh")`)。\
然而，通常会有一些限制条件，最常见且易于避免的是 `[rsp+0x30] == NULL`。由于您控制 **RSP** 中的值，只需发送更多的 NULL 值即可避免这个限制条件。

![](<../../../.gitbook/assets/image (754).png>)
```python
ONE_GADGET = libc.address + 0x4526a
rop2 = base + p64(ONE_GADGET) + "\x00"*100
```
要找到One Gadget指示的地址，您需要**添加`libc`加载的基地址**。

{% hint style="success" %}
One Gadget对于任意写入执行技术非常有帮助，可能会**简化ROP链**，因为您只需要调用一个地址（并满足要求）。
{% endhint %}

### ARM64

github存储库提到该工具支持**ARM64**，但在Kali 2023.3的libc中运行时**找不到任何gadget**。

## Angry Gadget

来自[**github存储库**](https://github.com/ChrisTheCoolHut/angry\_gadget)：受[OneGadget](https://github.com/david942j/one\_gadget)启发，这个工具是用Python编写的，并使用[angr](https://github.com/angr/angr)来测试执行`execve('/bin/sh', NULL, NULL)`的gadget的约束条件。\
如果您已经尝试过One Gadget中的所有gadget，Angry Gadget提供了更多带有复杂约束条件的gadget供尝试！
```bash
pip install angry_gadget

angry_gadget.py examples/libc6_2.23-0ubuntu10_amd64.so
```
{% hint style="success" %}
学习并练习AWS Hacking：<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks 培训 AWS 红队专家 (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
学习并练习GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks 培训 GCP 红队专家 (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>支持 HackTricks</summary>

* 检查[**订阅计划**](https://github.com/sponsors/carlospolop)!
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或 **关注**我们的 **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* 通过向 [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享黑客技巧。

</details>
{% endhint %}
