# 계정 탈취

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션인 [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**를 팔로우**하세요.
* **HackTricks**와 **HackTricks Cloud** github 저장소에 **PR을 제출**하여 여러분의 해킹 기교를 공유하세요.

</details>

## **인증 문제**

계정의 이메일을 변경하려고 시도하고, 확인 프로세스를 **조사**해야 합니다. 약점이 발견되면 의도한 피해자의 이메일로 변경한 후 확인해야 합니다.

## **유니코드 정규화 문제**

1. 피해자의 계정 `victim@gmail.com`
2. 유니코드를 사용하여 계정을 생성해야 합니다.\
예: `vićtim@gmail.com`

자세한 내용은 유니코드 정규화에 대한 문서를 참조하세요:

[unicode-normalization.md](unicode-injection/unicode-normalization.md)

## **재사용 가능한 재설정 토큰**

대상 시스템이 **재설정 링크를 재사용**할 수 있다면, `gau`, `wayback`, `scan.io`와 같은 도구를 사용하여 **더 많은 재설정 링크를 찾으려고 노력**해야 합니다.

## **계정 탈취 전 사전 조치**

1. 피해자의 이메일을 사용하여 플랫폼에 가입하고 비밀번호를 설정해야 합니다 (피해자의 이메일에 액세스할 수 없는 경우 이 작업이 불가능할 수 있음).
2. 피해자가 OAuth를 사용하여 가입하고 계정을 확인할 때까지 기다려야 합니다.
3. 일반적인 가입이 확인되어 피해자의 계정에 액세스할 수 있기를 기대합니다.


## **CORS 구성 오류로 인한 계정 탈취**

페이지에 **CORS 구성 오류**가 있는 경우 사용자로부터 민감한 정보를 **탈취하여 계정을 탈취**하거나 인증 정보를 변경할 수 있습니다:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **Csrf를 통한 계정 탈취**

페이지가 CSRF에 취약한 경우 사용자가 **비밀번호**, 이메일 또는 인증을 수정할 수 있으므로 이를 통해 액세스할 수 있습니다:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS를 통한 계정 탈취**

응용 프로그램에서 XSS를 찾으면 쿠키, 로컬 스토리지 또는 웹 페이지에서 정보를 훔칠 수 있으며, 이를 통해 계정을 탈취할 수 있습니다:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Same Origin + 쿠키**

제한된 XSS 또는 서브도메인 탈취를 찾으면 쿠키를 조작하여 피해자 계정을 침해할 수 있습니다 (예: 쿠키 고정화):

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **비밀번호 재설정 메커니즘 공격**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **응답 조작**

인증 응답을 **단순한 부울 값으로 축소**하여 false를 true로 변경하고 액세스를 확인해 보세요.

## OAuth를 통한 계정 탈취

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Host 헤더 삽입

1. Host 헤더는 비밀번호 재설정 요청 시작 후 수정됩니다.
2. `X-Forwarded-For` 프록시 헤더가 `attacker.com`로 변경됩니다.
3. Host, Referrer 및 Origin 헤더가 동시에 `attacker.com`로 변경됩니다.
4. 비밀번호 재설정을 시작한 후 메일을 다시 보내기로 선택하면 위에서 언급한 세 가지 방법이 모두 사용됩니다.

## 응답 조작

1. **코드 조작**: 상태 코드를 `200 OK`로 변경합니다.
2. **코드 및 본문 조작**:
- 상태 코드를 `200 OK`로 변경합니다.
- 응답 본문을 `{"success":true}` 또는 빈 객체 `{}`로 수정합니다.

이러한 조작 기술은 데이터 전송 및 수신에 JSON이 사용되는 시나리오에서 효과적입니다.


## 참고 자료

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션인 [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**를 팔로우**하세요.
* **HackTricks**와 **HackTricks Cloud** github 저장소에 **PR을 제출**하여 여러분의 해킹 기교를 공유하세요.

</details>
