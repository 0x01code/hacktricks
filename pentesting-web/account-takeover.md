# Kuchukua Udhibiti wa Akaunti

<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikionekana kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## **Tatizo la Uthibitisho**

Barua pepe ya akaunti inapaswa kujaribiwa kubadilishwa, na mchakato wa uthibitisho **unapaswa kuchunguzwa**. Ikiwa itagundulika kuwa **dhaifu**, barua pepe inapaswa kubadilishwa kuwa ya muhanga anayetarajiwa kisha kuthibitishwa.

## **Tatizo la Urambazaji wa Unicode**

1. Akaunti ya muhanga inapaswa kuwa `victim@gmail.com`
2. Akaunti inapaswa kuundwa kwa kutumia Unicode\
kwa mfano: `viƒátim@gmail.com`

Kama ilivyoelezwa katika [**mhadhara huu**](https://www.youtube.com/watch?v=CiIyaZ3x49c), shambulio lililopita pia linaweza kufanywa kwa kudhuru watoa huduma wa utambulisho wa tatu:

* Unda akaunti kwenye tovuti ya tatu ya utambulisho na barua pepe kama ile ya muhanga kwa kutumia herufi za Unicode (`viƒátim@company.com`).
* Mtoa huduma wa tatu asithibitishe barua pepe
* Ikiwa mtoa huduma wa utambulisho anathibitisha barua pepe, labda unaweza kushambulia sehemu ya kikoa kama vile: `victim@ƒáompany.com` na kusajili kikoa hicho na matumaini kwamba mtoa huduma wa utambulisho atazalisha toleo la ascii la jina la kikoa wakati jukwaa la muhanga linanormalisha jina la kikoa.
* Ingia kupitia mtoa huduma huyu wa utambulisho kwenye jukwaa la muhanga ambalo linapaswa kusawazisha herufi za Unicode na kuruhusu ufikie akaunti ya muhanga.

Kwa maelezo zaidi, tazama hati kuhusu Urambazaji wa Unicode:

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **Kutumia Upya Kiungo cha Kurejesha**

Ikiwa mfumo wa lengo unaruhusu **kiungo cha kurejesha kutumika tena**, jitihada zinapaswa kufanywa kutafuta **viungo vingine vya kurejesha** kwa kutumia zana kama `gau`, `wayback`, au `scan.io`.

## **Kabla ya Kuchukua Udhibiti wa Akaunti**

1. Barua pepe ya muhanga inapaswa kutumika kusajili kwenye jukwaa, na nenosiri linapaswa kuwekwa (jaribio la kuthibitisha linapaswa kufanywa, ingawa kukosa ufikiaji wa barua pepe za muhanga kunaweza kufanya hili kuwa haiwezekani).
2. Mtu anapaswa kusubiri hadi muhanga asajiliwe kwa kutumia OAuth na kuthibitisha akaunti.
3. Kuna matumaini kwamba usajili wa kawaida utathibitishwa, kuruhusu ufikiaji wa akaunti ya muhanga.

## **Kosa la Urambazaji wa CORS kwa Kuchukua Udhibiti wa Akaunti**

Ikiwa ukurasa una **makosa ya urambazaji wa CORS** unaweza kuwa na uwezo wa **kuiba habari nyeti** kutoka kwa mtumiaji ili **kuchukua udhibiti wa akaunti yake** au kumfanya abadilishe habari ya uthibitisho kwa lengo hilo:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **Csrf kwa Kuchukua Udhibiti wa Akaunti**

Ikiwa ukurasa una kasoro ya CSRF unaweza kuweza kufanya mtumiaji **abadilishe nenosiri lake**, barua pepe au uthibitisho ili kisha uweze kufikia:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS kwa Kuchukua Udhibiti wa Akaunti**

Ikiwa unapata XSS kwenye programu unaweza kuiba vidakuzi, uhifadhi wa ndani, au habari kutoka kwa ukurasa wa wavuti ambayo inaweza kuruhusu kuchukua udhibiti wa akaunti:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Asili Sawa + Vidakuzi**

Ikiwa unapata XSS iliyozuiliwa au kuchukua udhibiti wa subdomain, unaweza kucheza na vidakuzi (kufanya yao kubaki kwa mfano) kujaribu kuhatarisha akaunti ya muhanga:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Kushambulia Mfumo wa Kurejesha Nenosiri**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Ubadilishaji wa Majibu**

Ikiwa jibu la uthibitisho linaweza **kupunguzwa kuwa boolean rahisi jaribu kubadilisha uwongo kuwa kweli** na uone ikiwa unapata ufikiaji wowote.

## OAuth kwa Kuchukua Udhibiti wa Akaunti

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Uingizaji wa Kichwa cha Mwenyeji

1. Kichwa cha Mwenyeji kinabadilishwa baada ya kuanzisha ombi la kurejesha nenosiri.
2. Kichwa cha mbadala cha `X-Forwarded-For` kinabadilishwa kuwa `attacker.com`.
3. Kichwa cha Mwenyeji, Kumbukumbu, na Asili vinabadilishwa wakati mmoja kuwa `attacker.com`.
4. Baada ya kuanzisha ombi la kurejesha nenosiri na kisha kuchagua kutuma tena barua pepe, njia zote tatu zilizotajwa hapo juu zinatumika.

## Ubadilishaji wa Majibu

1. **Ubadilishaji wa Nambari**: Nambari ya hali inabadilishwa kuwa `200 OK`.
2. **Ubadilishaji wa Nambari na Mwili**:
* Nambari ya hali inabadilishwa kuwa `200 OK`.
* Mwili wa jibu unabadilishwa kuwa `{"success":true}` au kitu tupu `{}`.

Mbinu hizi za ubadilishaji ni muhimu katika hali ambapo JSON hutumiwa kwa uhamishaji na upokeaji wa data.

## Badilisha barua pepe ya kikao cha sasa

Kutoka [ripoti hii](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

* Mshambuliaji anaomba kubadilisha barua pepe yake na mpya
* Mshambuliaji anapokea kiungo cha kuthibitisha mabadiliko ya barua pepe
* Mshambuliaji anamtumia muhanga kiungo ili aibonyeze
* Barua pepe ya muhanga inabadilishwa kuwa ile iliyotajwa na mshambuliaji
* Shambulio linaweza kurejesha nenosiri na kuchukua udhibiti wa akaunti

Hii pia ilitokea katika [**ripoti hii**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea).

### Vidakuzi Vya Zamani

Kama ilivyoelezwa [**katika chapisho hili**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9), ilikuwa inawezekana kuingia kwenye akaunti, kuokoa vidakuzi kama mtumiaji aliyethibitishwa, kutoka, kisha kuingia tena.\
Na kuingia kwa mara ya pili, ingawa vidakuzi tofauti vinaweza kuzalishwa vidakuzi vya zamani vikaanza kufanya kazi tena.

## Marejeo

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikionekana kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.
</details>
