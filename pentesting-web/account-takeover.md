# Account√ºbernahme

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>

## **Autorisierungsproblem**

Die E-Mail eines Kontos sollte versucht werden zu √§ndern, und der Best√§tigungsprozess **muss √ºberpr√ºft werden**. Wenn er als **schwach** erkannt wird, sollte die E-Mail in die des beabsichtigten Opfers ge√§ndert und dann best√§tigt werden.

## **Unicode-Normalisierungsproblem**

1. Das Konto des beabsichtigten Opfers `victim@gmail.com`
2. Ein Konto sollte unter Verwendung von Unicode erstellt werden\
zum Beispiel: `viƒátim@gmail.com`

Weitere Details finden Sie im Dokument zur Unicode-Normalisierung:

[unicode-normalization.md](unicode-injection/unicode-normalization.md)

## **Wiederverwendung des Zur√ºcksetzungs-Tokens**

Wenn das Zielsystem das **Wiederverwenden des Zur√ºcksetzungslinks** zul√§sst, sollten Anstrengungen unternommen werden, um mit Tools wie `gau`, `wayback` oder `scan.io` **weitere Zur√ºcksetzungslinks zu finden**.

## **Vor der Konto√ºbernahme**

1. Die E-Mail des Opfers sollte verwendet werden, um sich auf der Plattform anzumelden, und ein Passwort sollte festgelegt werden (es sollte versucht werden, es zu best√§tigen, obwohl dies ohne Zugriff auf die E-Mails des Opfers unm√∂glich sein kann).
2. Man sollte warten, bis das Opfer sich √ºber OAuth anmeldet und das Konto best√§tigt.
3. Es wird gehofft, dass die normale Anmeldung best√§tigt wird, um Zugriff auf das Konto des Opfers zu erhalten.


## **CORS-Fehlkonfiguration zur Konto√ºbernahme**

Wenn die Seite **CORS-Fehlkonfigurationen** enth√§lt, k√∂nnen Sie m√∂glicherweise **sensible Informationen** vom Benutzer stehlen, um sein Konto zu **√ºbernehmen** oder ihn dazu zu bringen, Authentifizierungsinformationen zu √§ndern:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **Csrf zur Konto√ºbernahme**

Wenn die Seite anf√§llig f√ºr CSRF ist, k√∂nnen Sie m√∂glicherweise den **Benutzer dazu bringen, sein Passwort**, seine E-Mail oder seine Authentifizierung zu √§ndern, um dann darauf zugreifen zu k√∂nnen:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS zur Konto√ºbernahme**

Wenn Sie eine XSS in der Anwendung finden, k√∂nnen Sie m√∂glicherweise Cookies, den lokalen Speicher oder Informationen von der Webseite stehlen, die es Ihnen erm√∂glichen, das Konto zu √ºbernehmen:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Same Origin + Cookies**

Wenn Sie eine begrenzte XSS oder eine Subdomain-√úbernahme finden, k√∂nnen Sie mit den Cookies spielen (z.B. Fixierung), um zu versuchen, das Opferkonto zu kompromittieren:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Angriff auf den Passwort-Reset-Mechanismus**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Manipulation der Antwort**

Wenn die Authentifizierungsantwort auf einen einfachen booleschen Wert reduziert werden kann, versuchen Sie einfach, false in true zu √§ndern, und sehen Sie, ob Sie Zugriff erhalten.

## OAuth zur Konto√ºbernahme

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Host Header Injection

1. Der Host-Header wird nach der Initiierung einer Passwortzur√ºcksetzungsanforderung ge√§ndert.
2. Der `X-Forwarded-For`-Proxy-Header wird auf `attacker.com` ge√§ndert.
3. Der Host-, Referrer- und Origin-Header werden gleichzeitig auf `attacker.com` ge√§ndert.
4. Nachdem eine Passwortzur√ºcksetzung initiiert und dann die E-Mail erneut gesendet wurde, werden alle drei oben genannten Methoden angewendet.

## Manipulation der Antwort

1. **Code-Manipulation**: Der Statuscode wird auf `200 OK` ge√§ndert.
2. **Code- und Body-Manipulation**:
- Der Statuscode wird auf `200 OK` ge√§ndert.
- Der Antwort-Body wird auf `{"success":true}` oder ein leeres Objekt `{}` ge√§ndert.

Diese Manipulationstechniken sind in Szenarien wirksam, in denen JSON f√ºr die Daten√ºbertragung und -empfang verwendet wird.


## Referenzen

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
