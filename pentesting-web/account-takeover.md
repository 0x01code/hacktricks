# Hesap Ele Geçirme

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana dönüşün</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerimizden oluşan The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin
* **Katılın** 💬 [**Discord grubumuza**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı paylaşarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına PR gönderin.

</details>

## **Yetkilendirme Sorunu**

Bir hesabın e-posta adresi değiştirilmeye çalışılmalı ve onay süreci **incelenmelidir**. Eğer **zayıf** bulunursa, e-posta hedef kurbanın e-posta adresiyle değiştirilmeli ve ardından onaylanmalıdır.

## **Unicode Normalizasyon Sorunu**

1. Hedef kurbanın hesabı `victim@gmail.com`
2. Unicode kullanılarak bir hesap oluşturulmalıdır\
örneğin: `vićtim@gmail.com`

Daha fazla ayrıntı için Unicode Normalizasyon belgesine bakın:

[unicode-normalization.md](unicode-injection/unicode-normalization.md)

## **Sıfırdan Yeniden Kullanma**

Hedef sistem **sıfırdan yeniden kullanıma izin veriyorsa**, `gau`, `wayback` veya `scan.io` gibi araçlar kullanılarak **daha fazla sıfırdan yeniden kullanım bağlantısı bulunmaya çalışılmalıdır**.

## **Hesap Ele Geçirmeden Önce**

1. Kurbanın e-posta adresi platformda kullanılmalı ve bir şifre belirlenmelidir (onaylanmaya çalışılmalıdır, ancak kurbanın e-postalarına erişim olmaması bu işlemi imkansız hale getirebilir).
2. Kurbanın OAuth kullanarak kaydolmasını ve hesabı onaylamasını beklemelisiniz.
3. Normal kaydın onaylanacağı umulur, böylece kurbanın hesabına erişim sağlanabilir.

## **Hesap Ele Geçirme için CORS Yanlı Yapılandırma**

Sayfa **CORS yanlı yapılandırmaları** içeriyorsa, kullanıcıdan **duyarlı bilgileri çalabilir** ve hesabını **ele geçirebilir** veya aynı amaçla kimlik doğrulama bilgilerini değiştirebilirsiniz:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **Csrf ile Hesap Ele Geçirme**

Sayfa CSRF'ye karşı savunmasızsa, kullanıcıyı **şifresini, e-postasını veya kimlik doğrulamayı değiştirmeye zorlayabilir** ve ardından buna erişebilirsiniz:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS ile Hesap Ele Geçirme**

Uygulamada bir XSS bulursanız, çerezleri, yerel depolamayı veya hesabı ele geçirmenize izin verebilecek web sayfasından bilgileri çalabilirsiniz:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Aynı Köken + Çerezler**

Sınırlı bir XSS veya alt alan adı ele geçirme bulursanız, çerezlerle oynayabilir (örneğin sabitleyebilir) ve kurbanın hesabını tehlikeye atabilirsiniz:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Şifre Sıfırlama Mekanizmasına Saldırı**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Yanıt Manipülasyonu**

Kimlik doğrulama yanıtı **basit bir boole değerine indirgenebiliyorsa, false'ı true'a değiştirmeyi deneyin** ve herhangi bir erişim elde edip edemediğinizi kontrol edin.

## OAuth ile Hesap Ele Geçirme

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Host Başlığı Enjeksiyonu

1. Şifre sıfırlama isteği başlatıldıktan sonra Host başlığı değiştirilir.
2. `X-Forwarded-For` proxy başlığı `attacker.com` olarak değiştirilir.
3. Host, Referrer ve Origin başlıkları aynı anda `attacker.com` olarak değiştirilir.
4. Şifre sıfırlama başlatıldıktan sonra e-postayı yeniden gönderme seçeneği seçilirse, yukarıda belirtilen üç yöntem de kullanılır.

## Yanıt Manipülasyonu

1. **Kod Manipülasyonu**: Durum kodu `200 OK` olarak değiştirilir.
2. **Kod ve Gövde Manipülasyonu**:
* Durum kodu `200 OK` olarak değiştirilir.
* Yanıt gövdesi `{"success":true}` veya boş bir nesne `{}` olarak değiştirilir.

Bu manipülasyon teknikleri, veri iletimi ve alımı için JSON'un kullanıldığı senaryolarda etkilidir.

## Mevcut Oturumun E-postasını Değiştirme

[Şu rapordan](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

* Saldırgan e-postasını yeni bir e-posta ile değiştirmeyi talep eder
* Saldırgan, e-posta değişikliğini onaylamak için bir bağlantı alır
* Saldırgan, kurbanın bağlantıya tıklaması için bağlantıyı kurbanın e-postasına gönderir
* Kurbanın e-postası, saldırgan tarafından belirtilen e-posta adresine değiştirilir
* Saldırgan şifreyi kurtarabilir ve hesabı ele geçirebilir

## Referanslar

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana dönüşün</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerimizden oluşan The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin
* **Katılın** 💬 [**Discord grubumuza**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı paylaşarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına PR gönderin.

</details>
