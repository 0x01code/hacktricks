# Prise de contr√¥le de compte

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

## **Probl√®me d'autorisation**

L'e-mail d'un compte doit √™tre tent√© d'√™tre modifi√©, et le processus de confirmation **doit √™tre examin√©**. S'il est jug√© **faible**, l'e-mail doit √™tre chang√© pour celui de la victime pr√©vue, puis confirm√©.

## **Probl√®me de normalisation Unicode**

1. Le compte de la victime pr√©vue `victim@gmail.com`
2. Un compte devrait √™tre cr√©√© en utilisant Unicode\
par exemple : `viƒátim@gmail.com`

Comme expliqu√© dans [**cette pr√©sentation**](https://www.youtube.com/watch?v=CiIyaZ3x49c), l'attaque pr√©c√©dente pourrait √©galement √™tre r√©alis√©e en abusant des fournisseurs d'identit√© tiers :

* Cr√©er un compte dans le fournisseur d'identit√© tiers avec un e-mail similaire √† celui de la victime en utilisant un caract√®re Unicode (`viƒátim@company.com`).
* Le fournisseur d'identit√© tiers ne devrait pas v√©rifier l'e-mail
* Si le fournisseur d'identit√© v√©rifie l'e-mail, peut-√™tre pouvez-vous attaquer la partie domaine comme : `victim@ƒáompany.com` et enregistrer ce domaine en esp√©rant que le fournisseur d'identit√© g√©n√®re la version ASCII du domaine tandis que la plateforme de la victime normalise le nom de domaine.
* Connectez-vous via ce fournisseur d'identit√© sur la plateforme de la victime qui devrait normaliser le caract√®re Unicode et vous permettre d'acc√©der au compte de la victime.

Pour plus de d√©tails, consultez le document sur la normalisation Unicode :

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **R√©utilisation du jeton de r√©initialisation**

Si le syst√®me cible permet le **r√©utilisation du lien de r√©initialisation**, des efforts doivent √™tre d√©ploy√©s pour **trouver plus de liens de r√©initialisation** en utilisant des outils tels que `gau`, `wayback`, ou `scan.io`.

## **Pr√©paration √† la prise de contr√¥le de compte**

1. L'e-mail de la victime devrait √™tre utilis√© pour s'inscrire sur la plateforme, et un mot de passe devrait √™tre d√©fini (une tentative de confirmation devrait √™tre faite, bien que le manque d'acc√®s aux e-mails de la victime puisse rendre cela impossible).
2. Il faut attendre que la victime s'inscrive en utilisant OAuth et confirme le compte.
3. On esp√®re que l'inscription r√©guli√®re sera confirm√©e, permettant l'acc√®s au compte de la victime.

## **Mauvaise configuration CORS pour la prise de contr√¥le de compte**

Si la page contient des **mauvaises configurations CORS**, vous pourriez √™tre en mesure de **voler des informations sensibles** √† l'utilisateur pour **prendre le contr√¥le de son compte** ou le faire changer d'informations d'authentification √† cette fin :

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **CSRF pour la prise de contr√¥le de compte**

Si la page est vuln√©rable au CSRF, vous pourriez √™tre en mesure de faire **modifier son mot de passe** √† l'utilisateur, son e-mail ou son authentification pour ensuite y acc√©der :

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS pour la prise de contr√¥le de compte**

Si vous trouvez un XSS dans l'application, vous pourriez √™tre en mesure de voler des cookies, du stockage local, ou des informations de la page web qui pourraient vous permettre de prendre le contr√¥le du compte :

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **M√™me origine + Cookies**

Si vous trouvez un XSS limit√© ou une prise de contr√¥le de sous-domaine, vous pourriez jouer avec les cookies (les fixer par exemple) pour essayer de compromettre le compte de la victime :

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Attaque du m√©canisme de r√©initialisation de mot de passe**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Manipulation de la r√©ponse**

Si la r√©ponse d'authentification peut √™tre **r√©duite √† un simple bool√©en, essayez de changer false en true** et voyez si vous obtenez un acc√®s.

## OAuth pour la prise de contr√¥le de compte

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Injection d'en-t√™te Host

1. L'en-t√™te Host est modifi√© lors de l'initiation d'une demande de r√©initialisation de mot de passe.
2. L'en-t√™te proxy `X-Forwarded-For` est modifi√© en `attacker.com`.
3. Les en-t√™tes Host, Referrer et Origin sont simultan√©ment chang√©s en `attacker.com`.
4. Apr√®s avoir initi√© une r√©initialisation de mot de passe et ensuite opt√© pour renvoyer le courrier, les trois m√©thodes susmentionn√©es sont employ√©es.

## Manipulation de la r√©ponse

1. **Manipulation du code** : Le code d'√©tat est modifi√© en `200 OK`.
2. **Manipulation du code et du corps** :
* Le code d'√©tat est chang√© en `200 OK`.
* Le corps de la r√©ponse est modifi√© en `{"success":true}` ou un objet vide `{}`.

Ces techniques de manipulation sont efficaces dans les sc√©narios o√π JSON est utilis√© pour la transmission et la r√©ception des donn√©es.

## Changer l'e-mail de la session actuelle

D'apr√®s [ce rapport](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea) :

* L'attaquant demande √† changer son e-mail avec un nouveau
* L'attaquant re√ßoit un lien pour confirmer le changement de l'e-mail
* L'attaquant envoie le lien √† la victime pour qu'elle clique dessus
* L'e-mail de la victime est chang√© pour celui indiqu√© par l'attaquant
* L'attaquant peut r√©cup√©rer le mot de passe et prendre le contr√¥le du compte

Cela s'est √©galement produit dans [**ce rapport**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea).

### Anciens cookies

Comme expliqu√© dans [**ce post**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9), il √©tait possible de se connecter √† un compte, enregistrer les cookies en tant qu'utilisateur authentifi√©, se d√©connecter, puis se reconnecter.\
Avec la nouvelle connexion, bien que diff√©rents cookies puissent √™tre g√©n√©r√©s, les anciens ont recommenc√© √† fonctionner.

## R√©f√©rences

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.
</details>
