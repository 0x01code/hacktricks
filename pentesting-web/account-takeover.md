# Account Takeover

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

## **Autorisierungsproblem**

Die E-Mail eines Kontos sollte versucht werden zu √§ndern, und der Best√§tigungsprozess **muss √ºberpr√ºft werden**. Wenn er als **schwach** befunden wird, sollte die E-Mail in die des beabsichtigten Opfers ge√§ndert und dann best√§tigt werden.

## **Unicode-Normalisierungsproblem**

1. Das Konto des beabsichtigten Opfers `victim@gmail.com`
2. Ein Konto sollte unter Verwendung von Unicode erstellt werden\
zum Beispiel: `viƒátim@gmail.com`

Wie in [**diesem Vortrag**](https://www.youtube.com/watch?v=CiIyaZ3x49c) erkl√§rt, k√∂nnte der vorherige Angriff auch durch den Missbrauch von Drittanbieter-Identit√§tsanbietern durchgef√ºhrt werden:

* Erstellen Sie ein Konto beim Drittanbieter mit einer √§hnlichen E-Mail wie die des Opfers unter Verwendung eines Unicode-Zeichens (`viƒátim@company.com`).
* Der Drittanbieter sollte die E-Mail nicht √ºberpr√ºfen.
* Wenn der Identit√§tsanbieter die E-Mail √ºberpr√ºft, k√∂nnen Sie m√∂glicherweise den Domain-Teil angreifen, z. B. `victim@ƒáompany.com`, und diese Domain registrieren und hoffen, dass der Identit√§tsanbieter die ASCII-Version des Domainnamens generiert, w√§hrend die Opferplattform den Domainnamen normalisiert.
* Melden Sie sich √ºber diesen Identit√§tsanbieter auf der Opferplattform an, die das Unicode-Zeichen normalisieren sollte und Ihnen den Zugriff auf das Opferkonto erm√∂glicht.

F√ºr weitere Details siehe das Dokument zur Unicode-Normalisierung:

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **Wiederverwendung des Zur√ºcksetzungs-Token**

Sollte das Zielsystem das **Wiederverwenden des Zur√ºcksetzungslinks zulassen**, sollten Anstrengungen unternommen werden, um **weitere Zur√ºcksetzungslinks zu finden**, indem Tools wie `gau`, `wayback` oder `scan.io` verwendet werden.

## **Vor Konto√ºbernahme**

1. Die E-Mail des Opfers sollte verwendet werden, um sich auf der Plattform anzumelden, und ein Passwort sollte festgelegt werden (ein Versuch, es zu best√§tigen, sollte unternommen werden, obwohl der fehlende Zugriff auf die E-Mails des Opfers dies unm√∂glich machen k√∂nnte).
2. Man sollte warten, bis das Opfer sich √ºber OAuth anmeldet und das Konto best√§tigt.
3. Es wird gehofft, dass die normale Anmeldung best√§tigt wird, was den Zugriff auf das Konto des Opfers erm√∂glicht.

## **CORS-Fehlkonfiguration zur Konto√ºbernahme**

Wenn die Seite **CORS-Fehlkonfigurationen** enth√§lt, k√∂nnten Sie in der Lage sein, **sensible Informationen** vom Benutzer zu **stehlen, um sein Konto zu √ºbernehmen** oder ihn dazu zu bringen, die Authentifizierungsinformationen zu √§ndern:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **CSRF zur Konto√ºbernahme**

Wenn die Seite anf√§llig f√ºr CSRF ist, k√∂nnten Sie den **Benutzer dazu bringen, sein Passwort**, seine E-Mail oder Authentifizierung zu √§ndern, um dann darauf zugreifen zu k√∂nnen:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS zur Konto√ºbernahme**

Wenn Sie eine XSS in der Anwendung finden, k√∂nnten Sie Cookies, den lokalen Speicher oder Informationen von der Webseite stehlen, die es Ihnen erm√∂glichen k√∂nnten, das Konto zu √ºbernehmen:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Same Origin + Cookies**

Wenn Sie eine begrenzte XSS oder eine Subdomain-√úbernahme finden, k√∂nnten Sie mit den Cookies spielen (zum Beispiel sie fixieren), um zu versuchen, das Opferkonto zu gef√§hrden:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Angriff auf den Passwort-Zur√ºcksetzungsmechanismus**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Antwortmanipulation**

Wenn die Authentifizierungsantwort auf ein einfaches Boolesches reduziert werden kann, versuchen Sie einfach, false in true zu √§ndern und sehen Sie, ob Sie Zugriff erhalten.

## OAuth zur Konto√ºbernahme

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Host-Header-Injection

1. Der Host-Header wird nach der Initiierung einer Passwortzur√ºcksetzungsanforderung ge√§ndert.
2. Der `X-Forwarded-For`-Proxy-Header wird auf `attacker.com` ge√§ndert.
3. Der Host-, Referrer- und Origin-Header werden gleichzeitig auf `attacker.com` ge√§ndert.
4. Nach der Initiierung eines Passwort-Resets und dem anschlie√üenden erneuten Senden der E-Mail werden alle drei oben genannten Methoden angewendet.

## Antwortmanipulation

1. **Code-Manipulation**: Der Statuscode wird auf `200 OK` ge√§ndert.
2. **Code- und Body-Manipulation**:
* Der Statuscode wird auf `200 OK` ge√§ndert.
* Der Antwort-Body wird auf `{"success":true}` oder ein leeres Objekt `{}` ge√§ndert.

Diese Manipulationstechniken sind in Szenarien wirksam, in denen JSON f√ºr die Daten√ºbertragung und -empfang verwendet wird.

## √Ñndern der E-Mail der aktuellen Sitzung

Aus [diesem Bericht](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

* Der Angreifer fordert an, seine E-Mail mit einer neuen zu √§ndern.
* Der Angreifer erh√§lt einen Link zur Best√§tigung der √Ñnderung der E-Mail.
* Der Angreifer sendet dem Opfer den Link, damit er darauf klickt.
* Die E-Mail des Opfers wird auf die vom Angreifer angegebene ge√§ndert.
* Der Angreifer kann das Passwort wiederherstellen und das Konto √ºbernehmen.

Dies geschah auch in [**diesem Bericht**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea).

### Alte Cookies

Wie [**in diesem Beitrag**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9) erkl√§rt, war es m√∂glich, sich in ein Konto einzuloggen, die Cookies als authentifizierter Benutzer zu speichern, sich auszuloggen und sich dann erneut einzuloggen.\
Mit dem neuen Login k√∂nnten zwar unterschiedliche Cookies generiert werden, aber die alten begannen wieder zu funktionieren.

## Referenzen

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
</details>
