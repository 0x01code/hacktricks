# Hesap Ele Geçirme

<details>

<summary><strong>AWS hacklemeyi sıfırdan kahraman seviyesine öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini alın**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni keşfedin**](https://opensea.io/collection/the-peass-family), özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı göndererek HackTricks ve HackTricks Cloud github depolarına PR gönderin.**

</details>

## **Yetkilendirme Sorunu**

Bir hesabın e-postası değiştirilmeye çalışılmalı ve onay süreci **incelenmelidir**. Eğer **zayıf** bulunursa, e-posta hedef kurbanın e-postasıyla değiştirilmeli ve ardından onaylanmalıdır.

## **Unicode Normalizasyon Sorunu**

1. Hedef kurbanın hesabı `victim@gmail.com`
2. Unicode kullanarak bir hesap oluşturulmalıdır\
örneğin: `vićtim@gmail.com`

[**Bu konuşmada**](https://www.youtube.com/watch?v=CiIyaZ3x49c) açıklandığı gibi, önceki saldırı üçüncü taraf kimlik sağlayıcıları kötüye kullanılarak da gerçekleştirilebilir:

* Kurbanın e-postasına benzer bir e-posta ile üçüncü taraf kimlik sağlayıcıda hesap oluşturun (`vićtim@company.com`).
* Üçüncü taraf sağlayıcının e-postayı doğrulamaması gerekir
* Eğer kimlik sağlayıcı e-postayı doğrularsa, belki de alan kısmına saldırabilirsiniz: `victim@ćompany.com` ve bu alanı kaydedip kimlik sağlayıcının alan adının ascii sürümünü oluşturmasını umabilirsiniz.
* Kurban platformunun unicode karakteri normalize etmesine izin vermesi ve kurbanın hesabına erişmenize izin vermesi için bu kimlik sağlayıcı aracılığıyla giriş yapın.

Daha fazla ayrıntı için Unicode Normalizasyonu belgesine bakın:

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **Sıfırdan Yeniden Kullanılan Sıfırlama Tokenı**

Hedef sistem **sıfırlama bağlantısının yeniden kullanılmasına izin veriyorsa**, `gau`, `wayback` veya `scan.io` gibi araçlar kullanılarak **daha fazla sıfırlama bağlantısı bulunmaya çalışılmalıdır**.

## **Hesap Ele Geçirmeden Önce**

1. Kurbanın e-postası platforma kaydolmak için kullanılmalı ve bir şifre belirlenmelidir (onaylamak için bir deneme yapılmalı, ancak kurbanın e-postalarına erişim olmaması bu işlemi imkansız hale getirebilir).
2. Kurbanın OAuth kullanarak kaydolmasını ve hesabı onaylamasını beklemelisiniz.
3. Normal kaydolmanın onaylanacağı umulur, böylece kurbanın hesabına erişim sağlanabilir.

## **Hesap Ele Geçirme için CORS Yanlı Yapılandırma**

Sayfa **CORS yanlı yapılandırmaları** içeriyorsa, kullanıcıdan **duyarlı bilgileri çalabilir** ve hesabını **ele geçirebilir** veya kimlik doğrulama bilgilerini değiştirmesini sağlayabilirsiniz:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **Csrf ile Hesap Ele Geçirme**

Sayfa CSRF'ye karşı savunmasızsa, kullanıcıyı **şifresini değiştirmeye**, e-postasını veya kimlik doğrulamasını değiştirmeye zorlayabilir ve ardından buna erişebilirsiniz:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS ile Hesap Ele Geçirme**

Uygulamada bir XSS bulursanız, çerezleri, yerel depolama alanını veya sayfadan bilgi çalabileceğiniz bilgileri çalabilir ve hesabı ele geçirebilirsiniz:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Aynı Köken + Çerezler**

Sınırlı bir XSS veya bir alt alan ele geçirme bulursanız, çerezlerle oynayabilir (örneğin bunları sabitleyebilir) ve kurbanın hesabını tehlikeye atmak için deneyebilirsiniz:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Şifre Sıfırlama Mekanizmasına Saldırı**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Yanıt Manipülasyonu**

Kimlik doğrulama yanıtı **basit bir boole değerine indirgenebiliyorsa, false'yi true'ye değiştirmeyi deneyin** ve herhangi bir erişim elde edip edemediğinizi görün.

## OAuth ile Hesap Ele Geçirme

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Host Başlık Enjeksiyonu

1. Şifre sıfırlama isteği başlatılırken Host başlığı değiştirilir.
2. `X-Forwarded-For` proxy başlığı `attacker.com` olarak değiştirilir.
3. Host, Referrer ve Origin başlıkları aynı anda `attacker.com` olarak değiştirilir.
4. Şifre sıfırlama başlatıldıktan sonra postayı yeniden göndermeyi seçerseniz, yukarıda belirtilen üç yöntem de kullanılır.

## Yanıt Manipülasyonu

1. **Kod Manipülasyonu**: Durum kodu `200 OK` olarak değiştirilir.
2. **Kod ve Gövde Manipülasyonu**:
* Durum kodu `200 OK` olarak değiştirilir.
* Yanıt gövdesi `{"success":true}` veya boş bir nesne `{}` olarak değiştirilir.

Bu manipülasyon teknikleri, veri iletimi ve alımı için JSON'un kullanıldığı senaryolarda etkilidir.

## Mevcut Oturumun E-postasını Değiştirme

[**Bu raporda**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea) açıklandığı gibi:

* Saldırgan e-postasını yeni bir e-posta ile değiştirmeyi talep eder
* Saldırgan e-posta değişikliğini onaylamak için bir bağlantı alır
* Saldırgan kurbanın bağlantıya tıklaması için kurbanın e-postasını gönderir
* Kurbanın e-postası saldırgan tarafından belirtilen e-postaya değiştirilir
* Saldırgan şifreyi kurtarabilir ve hesabı ele geçirebilir

Bu ayrıca [**bu raporda**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea) da gerçekleşti.

### Eski Çerezler

[**Bu yazıda**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9) açıklandığı gibi, bir hesaba giriş yapmak, kimlik doğrulanmış bir kullanıcı olarak çerezleri kaydetmek, çıkış yapmak ve ardından tekrar giriş yapmak mümkündü.\
Yeni girişle birlikte farklı çerezler oluşturulabilir, ancak eski çerezler tekrar çalışmaya başlar. 

## Referanslar

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

<details>

<summary><strong>AWS hacklemeyi sıfırdan kahraman seviyesine öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini alın**](https://peass.creator-spring.com)
* [**PEASS Ailesi'ni keşfedin**](https://opensea.io/collection/the-peass-family), özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı göndererek HackTricks ve HackTricks Cloud github depolarına PR gönderin.**
</detaylar>
