# Rekening Oorname

<details>

<summary><strong>Leer AWS hak vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

## **Outorisasieprobleem**

Die e-pos van 'n rekening moet probeer word om verander te word, en die bevestigingsproses **moet ondersoek word**. As dit as **swak** bevind word, moet die e-pos na di√© van die beoogde slagoffer verander word en dan bevestig word.

## **Unicode Normaliseringprobleem**

1. Die rekening van die beoogde slagoffer `victim@gmail.com`
2. 'n Rekening moet geskep word met behulp van Unicode\
byvoorbeeld: `viƒátim@gmail.com`

Soos verduidelik in [**hierdie gesprek**](https://www.youtube.com/watch?v=CiIyaZ3x49c), kan die vorige aanval ook gedoen word deur derdeparty-identiteitsverskaffers te misbruik:

* Skep 'n rekening in die derdeparty-identiteit met 'n soortgelyke e-pos aan die slagoffer deur van 'n Unicode-karakter gebruik te maak (`viƒátim@company.com`).
* Die derdeparty-verskaffer moet nie die e-pos verifieer nie
* As die identiteitsverskaffer die e-pos verifieer, kan jy dalk die domeindeel aanval soos: `victim@ƒáompany.com` en daardie domein registreer en hoop dat die identiteitsverskaffer die ASCII-weergawe van die domein genereer terwyl die slagofferplatform die domeinnaam normaliseer.
* Meld aan via hierdie identiteitsverskaffer in die slagofferplatform wat die Unicode-karakter sal normaliseer en jou toegang tot die slagofferrekening sal gee.

Vir verdere besonderhede, verwys na die dokument oor Unicode Normalisering:

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **Herbruik van Herstelteken**

Indien die teikensisteem die **herstel skakel hergebruik toelaat**, moet pogings aangewend word om **meer herstel skakels te vind** deur middel van gereedskap soos `gau`, `wayback`, of `scan.io`.

## **Voor Rekening Oorname**

1. Die slagoffer se e-pos moet gebruik word om op die platform aan te meld, en 'n wagwoord moet ingestel word (daar moet 'n poging aangewend word om dit te bevestig, alhoewel die gebrek aan toegang tot die slagoffer se e-posse dit moontlik onmoontlik kan maak).
2. 'n Persoon moet wag totdat die slagoffer aanmeld deur gebruik te maak van OAuth en die rekening bevestig.
3. Daar word gehoop dat die gewone aanmelding bevestig sal word, wat toegang tot die slagoffer se rekening sal gee.

## **CORS Foutkonfigurasie tot Rekening Oorname**

As die bladsy **CORS-foutkonfigurasies** bevat, kan jy dalk **sensitiewe inligting** van die gebruiker steel om **sy rekening oor te neem** of hom te dwing om outentiseringsinligting te verander vir dieselfde doel:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **Csrf tot Rekening Oorname**

As die bladsy vatbaar is vir CSRF, kan jy dalk die **gebruiker se wagwoord, e-pos of outentisering laat wysig** sodat jy dit dan kan toegang:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS tot Rekening Oorname**

As jy 'n XSS in die aansoek vind, kan jy dalk koekies, plaaslike stoor, of inligting van die webbladsy steel wat jou kan toelaat om die rekening oor te neem:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Selfde Oorsprong + Koekies**

As jy 'n beperkte XSS of 'n subdomein oorneem, kan jy met die koekies speel (hulle byvoorbeeld fikseer) om te probeer om die slagofferrekening te kompromitteer:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Aanval op Wagwoordherstel Meganisme**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Responsmanipulasie**

As die outentiseringsrespons tot 'n eenvoudige booleaanse waarde gereduseer kan word, probeer net om vals na waar te verander en sien of jy enige toegang kry.

## OAuth tot Rekeningsoorname

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Aanbiedingskopinjeksie

1. Die Aanbiedingskop word gewysig na 'n wagwoordherstelversoekinisiasie.
2. Die `X-Forwarded-For` proksikop word verander na `attacker.com`.
3. Die Aanbiedingskoppe, Verwysers en Oorsprongkoppe word gelyktydig na `attacker.com` verander.
4. Nadat 'n wagwoordherstel ge√Ønisieer is en dan gekies word om die e-pos weer te stuur, word al drie van die genoemde metodes gebruik.

## Responsmanipulasie

1. **Kode-manipulasie**: Die statuskode word verander na `200 OK`.
2. **Kode en Liggaammanipulasie**:
* Die statuskode word verander na `200 OK`.
* Die responsliggaam word verander na `{"success":true}` of 'n le√´ voorwerp `{}`.

Hierdie manipulasietegnieke is doeltreffend in situasies waar JSON gebruik word vir data-oordrag en -ontvangs.

## Verander e-pos van huidige sessie

Vanaf [hierdie verslag](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

* Aanvaller versoek om sy e-pos met 'n nuwe een te verander
* Aanvaller ontvang 'n skakel om die verandering van die e-pos te bevestig
* Aanvaller stuur die slagoffer die skakel sodat hy dit kliek
* Die slagoffer se e-pos word verander na di√© wat deur die aanvaller aangedui is
* Die aanval kan die wagwoord herstel en die rekening oorneem

Dit het ook in [**hierdie verslag**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea) gebeur.

### Oue Koekies

Soos verduidelik [**in hierdie pos**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9), was dit moontlik om in te teken op 'n rekening, die koekies as 'n geaute
</details>
