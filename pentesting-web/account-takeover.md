# Hesap Ele Geçirme

<details>

<summary><strong>AWS hackleme becerilerini sıfırdan kahraman seviyesine öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya HackTricks'i **PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına **PR göndererek paylaşın**.

</details>

## **Yetkilendirme Sorunu**

Bir hesabın e-postası değiştirilmeye çalışılmalı ve onay süreci **incelenmelidir**. Eğer **zayıf** bulunursa, e-posta hedefin e-postasıyla değiştirilmeli ve ardından onaylanmalıdır.

## **Unicode Normalleştirme Sorunu**

1. Hedefin kurban hesabı `victim@gmail.com`
2. Unicode kullanarak bir hesap oluşturulmalıdır\
örneğin: `vićtim@gmail.com`

Daha fazla ayrıntı için Unicode Normalleştirme belgesine bakın:

[unicode-normalization.md](unicode-injection/unicode-normalization.md)

## **Sıfırlama Token'ının Tekrar Kullanılması**

Hedef sistem **sıfırlama bağlantısının tekrar kullanılmasına izin veriyorsa**, `gau`, `wayback` veya `scan.io` gibi araçlar kullanılarak **daha fazla sıfırlama bağlantısı bulunmaya** çalışılmalıdır.

## **Hesap Ele Geçirmeden Önce**

1. Kurbanın e-postası platforma kaydolmak için kullanılmalı ve bir şifre belirlenmelidir (erişim kurbanın e-postalarına sahip olunmadığı durumlarda bunun imkansız olabileceğinden dolayı onaylama denemesi yapılmalıdır).
2. Kurban OAuth kullanarak kaydolup hesabı onayladığında beklenmelidir.
3. Normal kaydolmanın onaylanması umulur, bu da kurbanın hesabına erişim sağlar.

## **Hesap Ele Geçirme için CORS Yanılandırması**

Eğer sayfa **CORS yanılandırmaları** içeriyorsa, kullanıcıdan **hassas bilgileri çalmak** veya hesabını ele geçirmesi için kimlik doğrulama bilgilerini değiştirmesini isteyebilirsiniz:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **Hesap Ele Geçirme için CSRF**

Eğer sayfa CSRF'ye karşı savunmasızsa, kullanıcıyı **şifresini, e-postasını veya kimlik doğrulamasını değiştirmeye** zorlayarak hesabını ele geçirebilirsiniz:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **Hesap Ele Geçirme için XSS**

Uygulamada bir XSS bulursanız, çerezleri, yerel depolamayı veya web sayfasından bilgi çalabilir ve bu da hesabı ele geçirmenize olanak sağlayabilir:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Aynı Köken + Çerezler**

Sınırlı bir XSS veya bir alt alan ele geçirme bulursanız, çerezlerle oynayabilir (örneğin, onları sabitleyebilir) ve kurbanın hesabını tehlikeye atmayı deneyebilirsiniz:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Şifre Sıfırlama Mekanizmasına Saldırma**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Yanıt Manipülasyonu**

Kimlik doğrulama yanıtı **basit bir boolean'a indirgenebilirse, false'yi true olarak değiştirmeyi** deneyin ve herhangi bir erişim elde edip edemediğinizi kontrol edin.

## OAuth ile Hesap Ele Geçirme

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Host Başlığı Enjeksiyonu

1. Şifre sıfırlama isteği başlatıldıktan sonra Host başlığı değiştirilir.
2. `X-Forwarded-For` proxy başlığı `attacker.com` olarak değiştirilir.
3. Host, Referrer ve Origin başlıkları aynı anda `attacker.com` olarak değiştirilir.
4. Şifre sıfırlama başlatıldıktan sonra e-postayı yeniden göndermeyi seçtiğinizde, yukarıda bahsedilen üç yöntem bir arada kullanılır.

## Yanıt Manipülasyonu

1. **Kod Manipülasyonu**: Durum kodu `200 OK` olarak değiştirilir.
2. **Kod ve Gövde Manipülasyonu**:
- Durum kodu `200 OK` olarak değiştirilir.
- Yanıt gövdesi `{"success":true}` veya boş bir nesne `{}` olarak değiştirilir.

Bu manipülasyon teknikleri, veri iletimi ve alımı için JSON'un kullanıldığı senaryolarda etkilidir.


## Referanslar

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)

<details>

<summary><strong>AWS hackleme becerilerini sıfırdan kahraman seviyesine öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya HackTricks'i **PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına **PR göndererek paylaşın**.

</details>
