# Account Takeover

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) su GitHub.

</details>

## **Problema di autorizzazione**

L'email di un account dovrebbe essere modificata e il processo di conferma **deve essere esaminato**. Se viene rilevata una debolezza, l'email dovrebbe essere cambiata con quella della vittima prevista e quindi confermata.

## **Problema di normalizzazione Unicode**

1. L'account della vittima prevista `victim@gmail.com`
2. Dovrebbe essere creato un account utilizzando Unicode\
ad esempio: `viƒátim@gmail.com`

Per ulteriori dettagli, consulta il documento sulla normalizzazione Unicode:

[unicode-normalization.md](unicode-injection/unicode-normalization.md)

## **Riutilizzo del token di reset**

Se il sistema di destinazione consente il **riutilizzo del link di reset**, si dovrebbero fare sforzi per **trovare altri link di reset** utilizzando strumenti come `gau`, `wayback` o `scan.io`.

## **Preparazione per il takeover dell'account**

1. L'email della vittima dovrebbe essere utilizzata per registrarsi sulla piattaforma e impostare una password (si dovrebbe tentare di confermarla, anche se l'accesso alle email della vittima potrebbe rendere ci√≤ impossibile).
2. Bisogna aspettare che la vittima si registri utilizzando OAuth e confermi l'account.
3. Si spera che la registrazione regolare venga confermata, consentendo l'accesso all'account della vittima.


## **Configurazione errata di CORS per il takeover dell'account**

Se la pagina contiene **configurazioni errate di CORS**, potresti essere in grado di **rubare informazioni sensibili** dall'utente per **prendere il controllo del suo account** o fargli cambiare le informazioni di autenticazione per lo stesso scopo:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **Csrf per il takeover dell'account**

Se la pagina √® vulnerabile a CSRF, potresti essere in grado di far **modificare la password** dell'utente, l'email o l'autenticazione in modo da poter accedere successivamente:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS per il takeover dell'account**

Se trovi una XSS nell'applicazione, potresti essere in grado di rubare cookie, local storage o informazioni dalla pagina web che potrebbero consentirti di prendere il controllo dell'account:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Same Origin + Cookies**

Se trovi una XSS limitata o un subdominio da prendere in consegna, potresti giocare con i cookie (ad esempio fissarli) per cercare di compromettere l'account della vittima:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Attacco al meccanismo di reset della password**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Manipolazione della risposta**

Se la risposta di autenticazione pu√≤ essere **ridotta a un semplice booleano, prova a cambiare false in true** e vedi se ottieni l'accesso.

## OAuth per il takeover dell'account

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Iniezione dell'header Host

1. L'header Host viene modificato in seguito a una richiesta di reset della password.
2. L'header proxy `X-Forwarded-For` viene modificato in `attacker.com`.
3. Gli header Host, Referrer e Origin vengono contemporaneamente modificati in `attacker.com`.
4. Dopo aver avviato un reset della password e quindi optato per l'invio di una nuova email, vengono utilizzati tutti e tre i metodi sopra citati.

## Manipolazione della risposta

1. **Manipolazione del codice**: il codice di stato viene modificato in `200 OK`.
2. **Manipolazione del codice e del corpo**:
- Il codice di stato viene cambiato in `200 OK`.
- Il corpo della risposta viene modificato in `{"success":true}` o in un oggetto vuoto `{}`.

Queste tecniche di manipolazione sono efficaci in scenari in cui viene utilizzato JSON per la trasmissione e la ricezione dei dati.


## Riferimenti

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) su GitHub.

</details>
