# Presa di Account

<details>

<summary><strong>Impara l'hacking AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e ai [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repository di Github.

</details>

## **Problema di Autorizzazione**

L'email di un account dovrebbe essere tentata di essere cambiata, e il processo di conferma **deve essere esaminato**. Se risulta essere **debole**, l'email dovrebbe essere cambiata con quella della vittima prevista e poi confermata.

## **Problema di Normalizzazione Unicode**

1. L'account della vittima prevista `victim@gmail.com`
2. Un account dovrebbe essere creato utilizzando Unicode\
ad esempio: `viƒátim@gmail.com`

Come spiegato in [**questa presentazione**](https://www.youtube.com/watch?v=CiIyaZ3x49c), l'attacco precedente potrebbe essere effettuato abusando dei fornitori di identit√† di terze parti:

* Crea un account nel fornitore di identit√† di terze parti con un'email simile a quella della vittima utilizzando alcuni caratteri unicode (`viƒátim@azienda.com`).
* Il fornitore di terze parti non dovrebbe verificare l'email
* Se il fornitore di identit√† verifica l'email, forse puoi attaccare la parte del dominio come: `victim@ƒáompany.com` e registrare quel dominio e sperare che il fornitore di identit√† generi la versione ascii del dominio mentre la piattaforma della vittima normalizza il nome di dominio.
* Accedi tramite questo fornitore di identit√† alla piattaforma della vittima che dovrebbe normalizzare il carattere unicode e consentirti di accedere all'account della vittima.

Per ulteriori dettagli, fare riferimento al documento sulla Normalizzazione Unicode:

{% content-ref url="unicode-injection/unicode-normalization.md" %}
[unicode-normalization.md](unicode-injection/unicode-normalization.md)
{% endcontent-ref %}

## **Riutilizzo del Token di Reset**

Se il sistema di destinazione consente il **riutilizzo del link di reset**, sforzi dovrebbero essere fatti per **trovare pi√π link di reset** utilizzando strumenti come `gau`, `wayback`, o `scan.io`.

## **Pre Account Takeover**

1. L'email della vittima dovrebbe essere utilizzata per registrarsi sulla piattaforma, e dovrebbe essere impostata una password (dovrebbe essere tentato di confermarla, anche se la mancanza di accesso alle email della vittima potrebbe rendere ci√≤ impossibile).
2. Bisogna aspettare che la vittima si registri utilizzando OAuth e confermi l'account.
3. Si spera che la registrazione regolare venga confermata, consentendo l'accesso all'account della vittima.

## **Configurazione Errata di CORS per Account Takeover**

Se la pagina contiene **configurazioni CORS errate** potresti essere in grado di **rubare informazioni sensibili** dall'utente per **prendere il controllo del suo account** o fargli cambiare le informazioni di autenticazione allo stesso scopo:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **Csrf per Account Takeover**

Se la pagina √® vulnerabile al CSRF potresti essere in grado di far **modificare la password** all'utente, l'email o l'autenticazione in modo da poter poi accedervi:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS per Account Takeover**

Se trovi un XSS nell'applicazione potresti essere in grado di rubare cookie, local storage o informazioni dalla pagina web che potrebbero consentirti di prendere il controllo dell'account:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Stesso Origine + Cookie**

Se trovi un XSS limitato o un subdominio da prendere, potresti giocare con i cookie (fissandoli ad esempio) per cercare di compromettere l'account della vittima:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Attacco al Meccanismo di Reset della Password**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Manipolazione della Risposta**

Se la risposta di autenticazione potesse essere **ridotta a un semplice booleano prova a cambiare false in true** e vedi se ottieni accesso.

## OAuth per il Takeover dell'Account

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Iniezione dell'Intestazione Host

1. L'intestazione Host viene modificata in seguito all'iniziazione di una richiesta di reset della password.
2. L'intestazione proxy `X-Forwarded-For` viene modificata in `attacker.com`.
3. L'Host, Referrer e le intestazioni di Origine vengono contemporaneamente cambiate in `attacker.com`.
4. Dopo aver iniziato un reset della password e poi optato per inviare di nuovo la mail, vengono utilizzati tutti e tre i metodi sopra menzionati.

## Manipolazione della Risposta

1. **Manipolazione del Codice**: Il codice di stato viene modificato in `200 OK`.
2. **Manipolazione del Codice e del Corpo**:
* Il codice di stato viene cambiato in `200 OK`.
* Il corpo della risposta viene modificato in `{"success":true}` o in un oggetto vuoto `{}`.

Queste tecniche di manipolazione sono efficaci nei casi in cui viene utilizzato JSON per la trasmissione e la ricezione dei dati.

## Cambio email della sessione corrente

Da [questo report](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

* L'attaccante richiede di cambiare la sua email con una nuova
* L'attaccante riceve un link per confermare il cambio dell'email
* L'attaccante invia alla vittima il link affinch√© lo clicchi
* L'email della vittima viene cambiata con quella indicata dall'attaccante
* L'attacco pu√≤ recuperare la password e prendere il controllo dell'account

Questo √® successo anche in [**questo report**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea).

### Vecchi Cookie

Come spiegato [**in questo post**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9), era possibile accedere a un account, salvare i cookie come utente autenticato, disconnettersi e quindi accedere di nuovo.\
Con il nuovo accesso, anche se potrebbero essere generati cookie diversi, quelli vecchi hanno iniziato a funzionare di nuovo.

## Riferimenti

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

<details>

<summary><strong>Impara l'hacking AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e ai [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repository di Github.
</details>
