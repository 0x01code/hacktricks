# Assumir Controle de Conta

<details>

<summary><strong>Aprenda hacking AWS do zero ao avan√ßado com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## **Problema de Autoriza√ß√£o**

O e-mail de uma conta deve ser tentado a ser alterado, e o processo de confirma√ß√£o **deve ser examinado**. Se for considerado **fraco**, o e-mail deve ser alterado para o da v√≠tima pretendida e ent√£o confirmado.

## **Problema de Normaliza√ß√£o Unicode**

1. A conta da v√≠tima pretendida `victim@gmail.com`
2. Uma conta deve ser criada usando Unicode\
por exemplo: `viƒátim@gmail.com`

Para mais detalhes, consulte o documento sobre Normaliza√ß√£o Unicode:

[unicode-normalization.md](unicode-injection/unicode-normalization.md)

## **Reutiliza√ß√£o de Token de Redefini√ß√£o**

Caso o sistema-alvo permita que o **link de redefini√ß√£o seja reutilizado**, esfor√ßos devem ser feitos para **encontrar mais links de redefini√ß√£o** usando ferramentas como `gau`, `wayback` ou `scan.io`.

## **Pr√©-Assumir Controle de Conta**

1. O e-mail da v√≠tima deve ser usado para se inscrever na plataforma, e uma senha deve ser definida (uma tentativa de confirm√°-la deve ser feita, embora a falta de acesso aos e-mails da v√≠tima possa tornar isso imposs√≠vel).
2. Deve-se aguardar at√© que a v√≠tima se inscreva usando OAuth e confirme a conta.
3. Espera-se que a inscri√ß√£o regular seja confirmada, permitindo o acesso √† conta da v√≠tima.

## **Configura√ß√£o Incorreta de CORS para Assumir Conta**

Se a p√°gina contiver **configura√ß√µes CORS incorretas**, voc√™ pode ser capaz de **roubar informa√ß√µes sens√≠veis** do usu√°rio para **assumir sua conta** ou faz√™-lo alterar informa√ß√µes de autentica√ß√£o para o mesmo prop√≥sito:

{% content-ref url="cors-bypass.md" %}
[cors-bypass.md](cors-bypass.md)
{% endcontent-ref %}

## **CSRF para Assumir Conta**

Se a p√°gina for vulner√°vel a CSRF, voc√™ pode ser capaz de fazer com que o **usu√°rio modifique sua senha**, e-mail ou autentica√ß√£o para ent√£o acess√°-la:

{% content-ref url="csrf-cross-site-request-forgery.md" %}
[csrf-cross-site-request-forgery.md](csrf-cross-site-request-forgery.md)
{% endcontent-ref %}

## **XSS para Assumir Conta**

Se voc√™ encontrar um XSS na aplica√ß√£o, pode ser capaz de roubar cookies, armazenamento local ou informa√ß√µes da p√°gina da web que poderiam permitir que voc√™ assumisse a conta:

{% content-ref url="xss-cross-site-scripting/" %}
[xss-cross-site-scripting](xss-cross-site-scripting/)
{% endcontent-ref %}

## **Mesma Origem + Cookies**

Se voc√™ encontrar um XSS limitado ou assumir um subdom√≠nio, voc√™ pode brincar com os cookies (fixando-os, por exemplo) para tentar comprometer a conta da v√≠tima:

{% content-ref url="hacking-with-cookies/" %}
[hacking-with-cookies](hacking-with-cookies/)
{% endcontent-ref %}

## **Atacando o Mecanismo de Redefini√ß√£o de Senha**

{% content-ref url="reset-password.md" %}
[reset-password.md](reset-password.md)
{% endcontent-ref %}

## **Manipula√ß√£o de Resposta**

Se a resposta de autentica√ß√£o puder ser **reduzida a um simples booleano, tente alterar false para true** e veja se obt√©m algum acesso.

## OAuth para Assumir Conta

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

## Inje√ß√£o de Cabe√ßalho de Host

1. O cabe√ßalho Host √© modificado ap√≥s a inicia√ß√£o de uma solicita√ß√£o de redefini√ß√£o de senha.
2. O cabe√ßalho de proxy `X-Forwarded-For` √© alterado para `attacker.com`.
3. O Host, Referrer e Origin headers s√£o simultaneamente alterados para `attacker.com`.
4. Ap√≥s iniciar uma redefini√ß√£o de senha e optar por reenviar o e-mail, todos os tr√™s m√©todos mencionados acima s√£o empregados.

## Manipula√ß√£o de Resposta

1. **Manipula√ß√£o de C√≥digo**: O c√≥digo de status √© alterado para `200 OK`.
2. **Manipula√ß√£o de C√≥digo e Corpo**:
* O c√≥digo de status √© alterado para `200 OK`.
* O corpo da resposta √© modificado para `{"success":true}` ou um objeto vazio `{}`.

Essas t√©cnicas de manipula√ß√£o s√£o eficazes em cen√°rios onde JSON √© utilizado para transmiss√£o e recebimento de dados.

## Alterar e-mail da sess√£o atual

De [este relat√≥rio](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

* Atacante solicita alterar seu e-mail por um novo
* Atacante recebe um link para confirmar a mudan√ßa do e-mail
* Atacante envia o link para a v√≠tima clicar
* O e-mail da v√≠tima √© alterado para o indicado pelo atacante
* O ataque pode recuperar a senha e assumir a conta

## Refer√™ncias

* [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
* [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)

<details>

<summary><strong>Aprenda hacking AWS do zero ao avan√ßado com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
