# Bypass de Restablecimiento/Olvido de Contraseña

<details>

<summary><strong>Aprende hacking en AWS de cero a héroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Red Team de AWS de HackTricks)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Obtén [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colección exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Únete al** 💬 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **síguenos** en **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en GitHub.

</details>

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Únete al servidor de [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para comunicarte con hackers experimentados y cazadores de recompensas por errores.

**Información sobre Hacking**\
Involúcrate con contenido que explora la emoción y los desafíos del hacking

**Noticias de Hacking en Tiempo Real**\
Mantente al día con el mundo del hacking a través de noticias e información en tiempo real

**Últimos Anuncios**\
Mantente informado sobre los nuevos programas de recompensas por errores que se lanzan y las actualizaciones cruciales de las plataformas

**Únete a nosotros en** [**Discord**](https://discord.com/invite/N3FrSbmwdy) y comienza a colaborar con los mejores hackers hoy mismo!

## **Fuga de Token de Restablecimiento de Contraseña a través del Referente**

* El encabezado HTTP referer puede filtrar el token de restablecimiento de contraseña si se incluye en la URL. Esto puede ocurrir cuando un usuario hace clic en un enlace de un sitio web de terceros después de solicitar un restablecimiento de contraseña.
* **Impacto**: Posible toma de control de la cuenta a través de ataques de falsificación de solicitudes entre sitios (CSRF).
* **Referencias**:
* [Informe de HackerOne 342693](https://hackerone.com/reports/342693)
* [Informe de HackerOne 272379](https://hackerone.com/reports/272379)
* [Artículo sobre Fuga de Token de Restablecimiento de Contraseña](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Envenenamiento de Restablecimiento de Contraseña**

* Los atacantes pueden manipular el encabezado Host durante las solicitudes de restablecimiento de contraseña para dirigir el enlace de restablecimiento a un sitio malicioso.
* **Parche**: Utiliza `$_SERVER['SERVER_NAME']` para construir URLs de restablecimiento de contraseña en lugar de `$_SERVER['HTTP_HOST']`.
* **Impacto**: Conduce a una posible toma de control de la cuenta al filtrar tokens de restablecimiento a los atacantes.
* **Pasos de Mitigación**:
* Valida el encabezado Host frente a una lista blanca de dominios permitidos.
* Utiliza métodos seguros del lado del servidor para generar URLs absolutas.
* **Referencias**:
* [Artículo de Acunetix sobre Envenenamiento de Restablecimiento de Contraseña](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Restablecimiento de Contraseña al Manipular el Parámetro de Correo Electrónico**

* Los atacantes pueden manipular la solicitud de restablecimiento de contraseña agregando parámetros de correo electrónico adicionales para desviar el enlace de restablecimiento.
* **Pasos de Mitigación**:
* Analiza y valida adecuadamente los parámetros de correo electrónico del lado del servidor.
* Utiliza declaraciones preparadas o consultas parametrizadas para prevenir ataques de inyección.
* **Referencias**:
* [Toma de Control de Cuenta en Readme.com](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)

## **Cambio de Correo Electrónico y Contraseña de cualquier Usuario a través de Parámetros de API**

* Los atacantes pueden modificar los parámetros de correo electrónico y contraseña en las solicitudes de API para cambiar las credenciales de la cuenta.
* **Pasos de Mitigación**:
* Asegura una validación estricta de parámetros y verificaciones de autenticación.
* Implementa un registro y monitoreo robustos para detectar y responder a actividades sospechosas.
* **Referencia**:
* [Toma de Control Total de Cuenta a través de la Manipulación de Parámetros de API](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Sin Límite de Tasa: Bombardeo de Correos Electrónicos**

* La falta de límites de tasa en las solicitudes de restablecimiento de contraseña puede llevar a un bombardeo de correos electrónicos, abrumando al usuario con correos de restablecimiento.
* **Pasos de Mitigación**:
* Implementa límites de tasa basados en la dirección IP o la cuenta de usuario.
* Utiliza desafíos CAPTCHA para prevenir abusos automatizados.
* **Referencias**:
* [Informe de HackerOne 280534](https://hackerone.com/reports/280534)

## **Descubre Cómo se Genera el Token de Restablecimiento de Contraseña**

* Comprender el patrón o método detrás de la generación de tokens puede llevar a predecir o realizar fuerza bruta en los tokens.
* **Pasos de Mitigación**:
* Utiliza métodos criptográficos sólidos para la generación de tokens.
* Asegura suficiente aleatoriedad y longitud para prevenir la predictibilidad.
* **Herramientas**: Utiliza Burp Sequencer para analizar la aleatoriedad de los tokens.

## **GUID Adivinable**

* Si los GUID (por ejemplo, versión 1) son adivinables o predecibles, los atacantes pueden realizar fuerza bruta en ellos para generar tokens de restablecimiento válidos.
* **Pasos de Mitigación**:
* Utiliza GUID versión 4 para aleatoriedad o implementa medidas de seguridad adicionales para otras versiones.
* **Herramientas**: Utiliza [guidtool](https://github.com/intruder-io/guidtool) para analizar y generar GUIDs.

## **Manipulación de Respuesta: Reemplazar una Mala Respuesta por una Buena**

* Manipulación de respuestas HTTP para evadir mensajes de error o restricciones.
* **Pasos de Mitigación**:
* Implementa verificaciones del lado del servidor para garantizar la integridad de la respuesta.
* Utiliza canales de comunicación seguros como HTTPS para prevenir ataques de intermediarios.
* **Referencia**:
* [Error Crítico en Evento de Recompensas por Errores en Vivo](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Uso de Token Expirado**

* Probar si los tokens expirados aún pueden ser utilizados para el restablecimiento de contraseña.
* **Pasos de Mitigación**:
* Implementa políticas estrictas de expiración de tokens y valida la expiración del token del lado del servidor.

## **Fuerza Bruta en Token de Restablecimiento de Contraseña**

* Intentar realizar fuerza bruta en el token de restablecimiento utilizando herramientas como Burpsuite e IP-Rotator para evadir los límites de tasa basados en IP.
* **Pasos de Mitigación**:
* Implementa mecanismos robustos de limitación de tasa y bloqueo de cuentas.
* Monitorea actividades sospechosas que indiquen ataques de fuerza bruta.

## **Intenta Usar tu Token**

* Probar si el token de restablecimiento de un atacante puede ser utilizado junto con el correo electrónico de la víctima.
* **Pasos de Mitigación**:
* Asegura que los tokens estén vinculados a la sesión del usuario u otros atributos específicos del usuario.

## **Invalidación de Sesión en Cierre de Sesión/Restablecimiento de Contraseña**

* Asegurarse de que las sesiones se invaliden cuando un usuario cierra sesión o restablece su contraseña.
* **Pasos de Mitigación**:
* Implementa una gestión adecuada de sesiones, asegurando que todas las sesiones se invaliden al cerrar sesión o restablecer la contraseña.

## **Invalidación de Sesión en Cierre de Sesión/Restablecimiento de Contraseña**

* Los tokens de restablecimiento deben tener un tiempo de expiración después del cual se vuelven inválidos.
* **Pasos de Mitigación**:
* Establece un tiempo de expiración razonable para los tokens de restablecimiento y aplícalo estrictamente del lado del servidor.
## Referencias

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Únete al servidor de [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para comunicarte con hackers experimentados y cazadores de recompensas por errores.

**Ideas de Hacking**\
Participa en contenido que explora la emoción y los desafíos del hacking

**Noticias de Hacking en Tiempo Real**\
Mantente al día con el mundo del hacking a través de noticias e información en tiempo real

**Últimos Anuncios**\
Mantente informado sobre los nuevos programas de recompensas por errores y actualizaciones importantes de plataformas

**Únete a nosotros en** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ¡y comienza a colaborar con los mejores hackers hoy mismo!
