# Şifre Sıfırlama/Unutulan Şifre Atlatma

<details>

<summary><strong>AWS hacklemeyi sıfırdan kahraman seviyesine öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**]'na göz atın (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Bize katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı paylaşarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına PR göndererek katkıda bulunun.

</details>

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve ödül avcıları ile iletişim kurmak için [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katılın!

**Hackleme İçgörüleri**\
Hackleme heyecanını ve zorluklarını ele alan içeriklerle etkileşime geçin

**Gerçek Zamanlı Hack Haberleri**\
Hızla değişen hackleme dünyasında gerçek zamanlı haberler ve içgörülerle güncel kalın

**En Son Duyurular**\
Başlatılan en yeni ödül avı programları ve önemli platform güncellemeleri hakkında bilgi sahibi olun

**Bize katılın** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugün en iyi hackerlarla işbirliğine başlayın!

## **Referans Üzerinden Şifre Sıfırlama Jetonu Sızıntısı**

* Eğer URL'de bulunuyorsa, HTTP referer başlığı şifre sıfırlama jetonunu sızdırabilir. Bu durum, bir kullanıcının şifre sıfırlama isteğinden sonra üçüncü taraf bir web sitesi bağlantısına tıkladığında meydana gelebilir.
* **Etki**: Cross-Site Request Forgery (CSRF) saldırıları aracılığıyla potansiyel hesap ele geçirme.
* **Sömürü**: Bir şifre sıfırlama jetonunun referer başlığında sızıp sızmadığını kontrol etmek için, **e-posta adresinize bir şifre sıfırlama isteği gönderin** ve sağlanan sıfırlama bağlantısına **tıklayın**. Şifrenizi hemen değiştirmeyin. Bunun yerine, **Burp Suite** kullanarak **üçüncü taraf bir web sitesine** (Facebook veya Twitter gibi) **gezin**. İstekleri inceleyerek, referer başlığının şifre sıfırlama jetonunu içerip içermediğini kontrol edin, çünkü bu hassas bilgilerin üçüncü taraflara açığa çıkmasına neden olabilir.
* **Referanslar**:
* [HackerOne Raporu 342693](https://hackerone.com/reports/342693)
* [HackerOne Raporu 272379](https://hackerone.com/reports/272379)
* [Şifre Sıfırlama Jetonu Sızıntısı Makalesi](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Şifre Sıfırlama Zehirlenmesi**

* Saldırganlar, şifre sıfırlama istekleri sırasında Host başlığını manipüle ederek sıfırlama bağlantısını kötü niyetli bir siteye yönlendirebilir.
* **Etki**: Sıfırlama jetonlarını saldırganlara sızdırarak potansiyel hesap ele geçirmeye yol açar.
* **Önlem Adımları**:
* Host başlığını izin verilen alan adları beyaz listesine karşı doğrulayın.
* Mutlak URL'ler oluşturmak için güvenli, sunucu taraflı yöntemler kullanın.
* **Yama**: Şifre sıfırlama URL'lerini oluşturmak için `$_SERVER['HTTP_HOST']` yerine `$_SERVER['SERVER_NAME']` kullanın.
* **Referanslar**:
* [Acunetix'ten Şifre Sıfırlama Zehirlenmesi Makalesi](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **E-posta Parametresini Manipüle Ederek Şifre Sıfırlama**

Saldırganlar, şifre sıfırlama isteğini yönlendirmek için ek e-posta parametreleri ekleyerek manipüle edebilir.

* İkinci parametre olarak saldırgan e-postasını ekleyin &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* Attacker e-postasını ikinci parametre olarak %20 kullanarak ekleyin
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* Saldırgan e-postasını ikinci parametre olarak ekleyin |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* İkinci parametre olarak saldırgan e-postasını cc olarak ekleyin
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* İkinci parametre olarak saldırgan e-postasını bcc olarak ekleyin
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* Saldırgan e-postasını ikinci parametre olarak , kullanarak ekleyin.
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* Attacker e-postasını ikinci parametre olarak json dizisine ekleyin
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **Önleme Adımları**:
* Sunucu tarafında e-posta parametrelerini doğru bir şekilde ayrıştırın ve doğrulayın.
* Enjeksiyon saldırılarını önlemek için hazırlanmış ifadeler veya parametreli sorgular kullanın.
* **Referanslar**:
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **API Parametreleri Aracılığıyla Herhangi Bir Kullanıcının E-posta ve Şifresini Değiştirme**

* Saldırganlar, hesap kimlik bilgilerini değiştirmek için API isteklerinde e-posta ve şifre parametrelerini değiştirebilirler.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **Önleme Adımları**:
* Sıkı parametre doğrulaması ve kimlik doğrulama kontrolleri sağlayın.
* Şüpheli faaliyetleri tespit etmek ve yanıtlamak için güçlü günlükleme ve izleme uygulayın.
* **Referans**:
* [API Parametre Manipülasyonu Aracılığıyla Tam Hesap Ele Geçirme](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Hız Sınırlaması Yok: E-posta Bombardımanı**

* Şifre sıfırlama isteklerinde hız sınırlamasının olmaması, kullanıcıyı sıfırlama e-postalarıyla ezme riskini taşır.
* **Önleme Adımları**:
* IP adresine veya kullanıcı hesabına dayalı hız sınırlaması uygulayın.
* Otomatik kötüye kullanımı önlemek için CAPTCHA zorlukları kullanın.
* **Referanslar**:
* [HackerOne Rapor 280534](https://hackerone.com/reports/280534)

## **Şifre Sıfırlama Jetonunun Nasıl Oluşturulduğunu Bulma**

* Jeton oluşturma desenini veya yöntemini anlamak, jetonları tahmin etmeye veya kaba kuvvet uygulamaya yol açabilir. Bazı seçenekler:
* Zaman Damgasına Dayalı
* Kullanıcı Kimliğine Dayalı
* Kullanıcının E-postasına Dayalı
* Ad ve Soyada Dayalı
* Doğum Tarihine Dayalı
* Kriptografiye Dayalı
* **Önleme Adımları**:
* Jeton oluşturmak için güçlü, kriptografik yöntemler kullanın.
* Tahmin edilebilirliği önlemek için yeterli rastgelelik ve uzunluk sağlayın.
* **Araçlar**: Jetonların rastgeleliğini analiz etmek için Burp Sequencer'ı kullanın.

## **Tahmin Edilebilir UUID**

* UUID'lerin (sürüm 1) tahmin edilebilir veya öngörülebilir olması durumunda, saldırganlar bunları geçerli sıfırlama jetonları oluşturmak için kaba kuvvet uygulayabilir. Kontrol edin:
{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **Önleme Adımları**:
* Rastgelelik için GUID sürüm 4 kullanın veya diğer sürümler için ek güvenlik önlemleri uygulayın.
* **Araçlar**: [guidtool](https://github.com/intruder-io/guidtool) kullanarak GUID'leri analiz etme ve oluşturma.

## **Yanıt Manipülasyonu: Kötü Yanıtı İyi Olanla Değiştirme**

* HTTP yanıtlarını manipüle ederek hata mesajlarını veya kısıtlamaları atlamak.
* **Önleme Adımları**:
* Yanıt bütünlüğünü sağlamak için sunucu taraflı kontrolleri uygulayın.
* Orta Adam Saldırılarını önlemek için HTTPS gibi güvenli iletişim kanallarını kullanın.
* **Referans**:
* [Canlı Bug Bounty Etkinliğindeki Kritik Hata](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Süresi Geçmiş Jetonun Kullanılması**

* Süresi geçmiş jetonların hala şifre sıfırlamak için kullanılıp kullanılamadığını test etme.
* **Önleme Adımları**:
* Katı jeton süresi dolma politikaları uygulayın ve jetonun süresinin sunucu taraflı olarak geçerliliğini doğrulayın.

## **Kaba Kuvvet Şifre Sıfırlama Jetonu**

* Sıfırlama jetonunu Burpsuite ve IP-Rotator gibi araçlar kullanarak kaba kuvvet uygulama, IP tabanlı hız sınırlarını atlamak için.
* **Önleme Adımları**:
* Güçlü hız sınırlama ve hesap kilit mekanizmaları uygulayın.
* Kaba kuvvet saldırılarını gösteren şüpheli faaliyetleri izleyin.

## **Jetonunuzu Kullanmayı Deneyin**

* Saldırganın sıfırlama jetonunun kurbanın e-postasıyla birlikte kullanılıp kullanılamadığını test etme.
* **Önleme Adımları**:
* Jetonların kullanıcı oturumuna veya diğer kullanıcıya özgü özelliklere bağlı olduğundan emin olun.

## **Oturum İptali Çıkış/Şifre Sıfırlama İşleminde**

* Kullanıcının çıkış yapması veya şifresini sıfırlaması durumunda oturumların iptal edildiğinden emin olma.
* **Önleme Adımları**:
* Tüm oturumların çıkış veya şifre sıfırlama işleminden sonra iptal edildiğinden emin olacak şekilde uygun oturum yönetimi uygulayın.

## **Oturum İptali Çıkış/Şifre Sıfırlama İşleminde**

* Sıfırlama jetonlarının geçerlilik süresi olmalı ve bu süre dolduktan sonra geçersiz hale gelmelidir.
* **Önleme Adımları**:
* Sıfırlama jetonları için makul bir geçerlilik süresi belirleyin ve bunu sunucu taraflı olarak kesinlikle uygulayın.

## Referanslar

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katılarak deneyimli hackerlar ve hata avcılarıyla iletişim kurun!

**Hacking Insights**\
Hacking'in heyecanını ve zorluklarını inceleyen içeriklerle etkileşime geçin

**Gerçek Zamanlı Hack Haberleri**\
Hızlı tempolu hacking dünyasını gerçek zamanlı haberler ve içgörülerle takip edin

**En Son Duyurular**\
Yeni hata avcılıklarını ve önemli platform güncellemelerini takip edin

**Bize Katılın** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugün en iyi hackerlarla işbirliğine başlayın!

<details>

<summary><strong>Sıfırdan Kahraman'a AWS hackleme öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**'u takip edin.**
* **Hacking hilelerinizi paylaşarak HackTricks ve HackTricks Cloud github depolarına PR göndererek katkıda bulunun.**

</details>
