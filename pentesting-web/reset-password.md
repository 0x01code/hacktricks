# Zur√ºckgesetztes/Vergessenes Passwort umgehen

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks in PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Treten Sie dem [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) Server bei, um mit erfahrenen Hackern und Bug-Bounty-J√§gern zu kommunizieren!

**Hacking-Einblicke**\
Besch√§ftigen Sie sich mit Inhalten, die sich mit dem Nervenkitzel und den Herausforderungen des Hackens befassen

**Echtzeit-Hack-News**\
Bleiben Sie mit der schnelllebigen Hacking-Welt durch Echtzeitnachrichten und Einblicke auf dem Laufenden

**Neueste Ank√ºndigungen**\
Bleiben Sie √ºber die neuesten Bug-Bounties und wichtige Plattformupdates informiert

**Treten Sie uns bei** [**Discord**](https://discord.com/invite/N3FrSbmwdy) und beginnen Sie noch heute mit der Zusammenarbeit mit Top-Hackern!

## **Passwort-Reset-Token-Leak √ºber Referrer**

* Der HTTP-Referer-Header kann das Passwort-Reset-Token preisgeben, wenn es in der URL enthalten ist. Dies kann passieren, wenn ein Benutzer nach dem Anfordern eines Passwort-Resets auf einen Link einer Website eines Drittanbieters klickt.
* **Auswirkungen**: Potenzielle √úbernahme des Kontos durch Cross-Site Request Forgery (CSRF)-Angriffe.
* **Referenzen**:
* [HackerOne-Bericht 342693](https://hackerone.com/reports/342693)
* [HackerOne-Bericht 272379](https://hackerone.com/reports/272379)
* [Artikel zum Passwort-Reset-Token-Leak](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Passwort-Reset-Vergiftung**

* Angreifer k√∂nnen den Host-Header w√§hrend der Passwort-Reset-Anfragen manipulieren, um den Reset-Link auf eine b√∂sartige Website zu lenken.
* **Patch**: Verwenden Sie `$_SERVER['SERVER_NAME']`, um Passwort-Reset-URLs zu erstellen, anstelle von `$_SERVER['HTTP_HOST']`.
* **Auswirkungen**: F√ºhrt zu potenzieller √úbernahme des Kontos, indem Reset-Tokens an Angreifer durchsickern.
* **Ma√ünahmen zur Abhilfe**:
* Validieren Sie den Host-Header gegen eine Whitelist erlaubter Domains.
* Verwenden Sie sichere, serverseitige Methoden zur Generierung absoluter URLs.
* **Referenzen**:
* [Acunetix-Artikel zur Passwort-Reset-Vergiftung](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Passwort-Reset durch Manipulation des E-Mail-Parameters**

* Angreifer k√∂nnen die Passwort-Reset-Anfrage manipulieren, indem sie zus√§tzliche E-Mail-Parameter hinzuf√ºgen, um den Reset-Link umzuleiten.
* **Ma√ünahmen zur Abhilfe**:
* Analysieren und validieren Sie E-Mail-Parameter ordnungsgem√§√ü serverseitig.
* Verwenden Sie vorbereitete Anweisungen oder parameterisierte Abfragen, um Injektionsangriffe zu verhindern.
* **Referenzen**:
* [Account√ºbernahme bei Readme.com](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)

## **√Ñndern der E-Mail und des Passworts eines beliebigen Benutzers √ºber API-Parameter**

* Angreifer k√∂nnen E-Mail- und Passwortparameter in API-Anfragen √§ndern, um Kontozugangsdaten zu √§ndern.
* **Ma√ünahmen zur Abhilfe**:
* Stellen Sie eine strenge Parametervalidierung und Authentifizierungspr√ºfungen sicher.
* Implementieren Sie robustes Logging und Monitoring, um verd√§chtige Aktivit√§ten zu erkennen und darauf zu reagieren.
* **Referenz**:
* [Vollst√§ndige Konto√ºbernahme √ºber API-Parametermanipulation](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Keine Rate-Begrenzung: E-Mail-Bombardierung**

* Fehlende Rate-Begrenzung bei Passwort-Reset-Anfragen kann zu einer E-Mail-Bombardierung f√ºhren, bei der der Benutzer mit Reset-E-Mails √ºberflutet wird.
* **Ma√ünahmen zur Abhilfe**:
* Implementieren Sie eine Rate-Begrenzung basierend auf der IP-Adresse oder dem Benutzerkonto.
* Verwenden Sie CAPTCHA-Herausforderungen, um automatischen Missbrauch zu verhindern.
* **Referenzen**:
* [HackerOne-Bericht 280534](https://hackerone.com/reports/280534)

## **Finden Sie heraus, wie das Passwort-Reset-Token generiert wird**

* Das Verst√§ndnis des Musters oder der Methode hinter der Token-Generierung kann dazu f√ºhren, dass Tokens vorhergesagt oder durch Brute-Force erzwungen werden.
* **Ma√ünahmen zur Abhilfe**:
* Verwenden Sie starke, kryptografische Methoden zur Token-Generierung.
* Stellen Sie ausreichende Zuf√§lligkeit und L√§nge sicher, um Vorhersagbarkeit zu verhindern.
* **Tools**: Verwenden Sie Burp Sequencer, um die Zuf√§lligkeit der Tokens zu analysieren.

## **Erratbare GUID**

* Wenn GUIDs (z. B. Version 1) erratbar oder vorhersagbar sind, k√∂nnen Angreifer versuchen, sie durch Brute-Force zu generieren, um g√ºltige Reset-Tokens zu erhalten.
* **Ma√ünahmen zur Abhilfe**:
* Verwenden Sie GUID-Version 4 f√ºr Zuf√§lligkeit oder implementieren Sie zus√§tzliche Sicherheitsma√ünahmen f√ºr andere Versionen.
* **Tools**: Verwenden Sie [guidtool](https://github.com/intruder-io/guidtool) zur Analyse und Generierung von GUIDs.

## **Antwortmanipulation: Ersetzen einer schlechten Antwort durch eine gute**

* Manipulation von HTTP-Antworten, um Fehlermeldungen oder Einschr√§nkungen zu umgehen.
* **Ma√ünahmen zur Abhilfe**:
* Implementieren Sie serverseitige √úberpr√ºfungen, um die Integrit√§t der Antwort sicherzustellen.
* Verwenden Sie sichere Kommunikationskan√§le wie HTTPS, um Man-in-the-Middle-Angriffe zu verhindern.
* **Referenz**:
* [Kritischer Fehler in Live-Bug-Bounty-Veranstaltung](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Verwendung eines abgelaufenen Tokens**

* Testen, ob abgelaufene Tokens immer noch f√ºr das Zur√ºcksetzen des Passworts verwendet werden k√∂nnen.
* **Ma√ünahmen zur Abhilfe**:
* Implementieren Sie strenge Richtlinien f√ºr die Token-Verfallzeit und validieren Sie den Ablauf serverseitig.

## **Brute-Force-Passwort-Reset-Token**

* Versuch, das Reset-Token durch Brute-Force mit Tools wie Burpsuite und IP-Rotator zu erzwingen, um IP-basierte Rate-Limits zu umgehen.
* **Ma√ünahmen zur Abhilfe**:
* Implementieren Sie robuste Rate-Limiting- und Kontosperrenmechanismen.
* √úberwachen Sie verd√§chtige Aktivit√§ten, die auf Brute-Force-Angriffe hinweisen.

## **Versuchen Sie, Ihr Token zu verwenden**

* Testen, ob ein von einem Angreifer generiertes Reset-Token in Verbindung mit der E-Mail des Opfers verwendet werden kann.
* **Ma√ünahmen zur Abhilfe**:
* Stellen Sie sicher, dass Tokens an die Benutzersitzung oder andere benutzerspezifische Attribute gebunden sind.

## **Sitzungsinvalidierung beim Ausloggen/Passwort-Reset**

* Stellen Sie sicher, dass Sitzungen ung√ºltig werden, wenn ein Benutzer sich ausloggt oder sein Passwort zur√ºcksetzt.
* **Ma√ünahmen zur Abhilfe**:
* Implementieren Sie eine ordnungsgem√§√üe Sitzungsverwaltung und stellen Sie sicher, dass alle Sitzungen beim Ausloggen oder Passwort-Reset ung√ºltig werden.

## **Sitzungsinvalidierung beim Ausloggen/Passwort-Reset**

* Reset-Tokens sollten eine Ablaufzeit haben, nach der sie ung√ºltig werden.
* **Ma√ünahmen zur Abhilfe**:
* Legen Sie eine angemessene Ablaufzeit f√ºr Reset-Tokens fest und erzwingen Sie diese strikt serverseitig.
## Referenzen

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Treten Sie dem [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) Server bei, um mit erfahrenen Hackern und Bug-Bounty-J√§gern zu kommunizieren!

**Hacking-Einblicke**\
Besch√§ftigen Sie sich mit Inhalten, die sich mit dem Nervenkitzel und den Herausforderungen des Hackens befassen

**Echtzeit-Hack-News**\
Bleiben Sie mit den schnelllebigen Hacking-Welt durch Echtzeit-Nachrichten und Einblicke auf dem Laufenden

**Neueste Ank√ºndigungen**\
Bleiben Sie √ºber die neuesten Bug-Bounties und wichtige Plattform-Updates informiert

**Treten Sie uns bei auf** [**Discord**](https://discord.com/invite/N3FrSbmwdy) und beginnen Sie noch heute mit Top-Hackern zusammenzuarbeiten!

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
