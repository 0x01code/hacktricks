# Contournement de r√©initialisation/mot de passe oubli√©

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Rejoignez le serveur [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) pour communiquer avec des pirates exp√©riment√©s et des chasseurs de primes !

**Perspectives de piratage**\
Engagez-vous avec du contenu qui explore le frisson et les d√©fis du piratage

**Actualit√©s de piratage en temps r√©el**\
Restez √† jour avec le monde du piratage en √©volution rapide gr√¢ce aux actualit√©s et aux informations en temps r√©el

**Derni√®res annonces**\
Restez inform√© des derni√®res primes de bugs lanc√©es et des mises √† jour cruciales de la plateforme

**Rejoignez-nous sur** [**Discord**](https://discord.com/invite/N3FrSbmwdy) et commencez √† collaborer avec les meilleurs pirates d√®s aujourd'hui !

## **Fuite de jeton de r√©initialisation de mot de passe via le r√©f√©rent**

* L'en-t√™te HTTP referer peut divulguer le jeton de r√©initialisation de mot de passe s'il est inclus dans l'URL. Cela peut se produire lorsqu'un utilisateur clique sur un lien de site Web tiers apr√®s avoir demand√© une r√©initialisation de mot de passe.
* **Impact** : Perte potentielle de compte via des attaques de falsification de requ√™te intersite (CSRF).
* **Exploitation** : Pour v√©rifier si un jeton de r√©initialisation de mot de passe fuite dans l'en-t√™te referer, **demandez une r√©initialisation de mot de passe** √† votre adresse e-mail et **cliquez sur le lien de r√©initialisation** fourni. **Ne changez pas votre mot de passe** imm√©diatement. Au lieu de cela, **acc√©dez √† un site Web tiers** (comme Facebook ou Twitter) tout en **interceptant les requ√™tes √† l'aide de Burp Suite**. Inspectez les requ√™tes pour voir si l'en-t√™te **referer contient le jeton de r√©initialisation de mot de passe**, car cela pourrait exposer des informations sensibles √† des tiers.
* **R√©f√©rences** :
* [Rapport HackerOne 342693](https://hackerone.com/reports/342693)
* [Rapport HackerOne 272379](https://hackerone.com/reports/272379)
* [Article sur la fuite de jeton de r√©initialisation de mot de passe](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Empoisonnement de r√©initialisation de mot de passe**

* Les attaquants peuvent manipuler l'en-t√™te Host lors des demandes de r√©initialisation de mot de passe pour pointer le lien de r√©initialisation vers un site malveillant.
* **Impact** : Conduit √† une perte potentielle de compte en divulguant des jetons de r√©initialisation aux attaquants.
* **√âtapes d'att√©nuation** :
* Valider l'en-t√™te Host par rapport √† une liste blanche de domaines autoris√©s.
* Utiliser des m√©thodes s√©curis√©es c√¥t√© serveur pour g√©n√©rer des URL absolues.
* **Correctif** : Utilisez `$_SERVER['SERVER_NAME']` pour construire des URL de r√©initialisation de mot de passe au lieu de `$_SERVER['HTTP_HOST']`.
* **R√©f√©rences** :
* [Article Acunetix sur l'empoisonnement de r√©initialisation de mot de passe](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **R√©initialisation de mot de passe en manipulant le param√®tre d'e-mail**

Les attaquants peuvent manipuler la demande de r√©initialisation de mot de passe en ajoutant des param√®tres d'e-mail suppl√©mentaires pour d√©tourner le lien de r√©initialisation.

* Ajoutez l'e-mail de l'attaquant en tant que deuxi√®me param√®tre en utilisant &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* Ajoutez l'adresse e-mail de l'attaquant en tant que deuxi√®me param√®tre en utilisant %20
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* Ajoutez l'e-mail de l'attaquant en tant que deuxi√®me param√®tre en utilisant |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* Ajoutez l'e-mail de l'attaquant en tant que deuxi√®me param√®tre en utilisant cc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* Ajoutez l'e-mail de l'attaquant en tant que deuxi√®me param√®tre en utilisant bcc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* Ajoutez l'e-mail de l'attaquant en tant que deuxi√®me param√®tre en utilisant ,
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* Ajoutez l'e-mail de l'attaquant en tant que deuxi√®me param√®tre dans le tableau json
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **√âtapes d'att√©nuation**:
* Analyser et valider correctement les param√®tres d'email c√¥t√© serveur.
* Utiliser des instructions pr√©par√©es ou des requ√™tes param√©tr√©es pour pr√©venir les attaques par injection.
* **R√©f√©rences**:
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **Changement de l'email et du mot de passe de n'importe quel utilisateur via les param√®tres de l'API**

* Les attaquants peuvent modifier les param√®tres d'email et de mot de passe dans les requ√™tes API pour changer les informations d'identification du compte.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **√âtapes d'att√©nuation**:
* Assurez-vous d'une validation stricte des param√®tres et de v√©rifications d'authentification.
* Mettez en place une journalisation et une surveillance robustes pour d√©tecter et r√©pondre aux activit√©s suspectes.
* **R√©f√©rence**:
* [Prise de contr√¥le compl√®te du compte via la manipulation des param√®tres de l'API](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Absence de limitation de taux : bombardement d'e-mails**

* L'absence de limitation de taux sur les demandes de r√©initialisation de mot de passe peut entra√Æner un bombardement d'e-mails, submergeant l'utilisateur de courriels de r√©initialisation.
* **√âtapes d'att√©nuation**:
* Mettez en place une limitation de taux bas√©e sur l'adresse IP ou le compte utilisateur.
* Utilisez des d√©fis CAPTCHA pour pr√©venir les abus automatis√©s.
* **R√©f√©rences**:
* [Rapport HackerOne 280534](https://hackerone.com/reports/280534)

## **D√©couvrez comment le jeton de r√©initialisation de mot de passe est g√©n√©r√©**

* Comprendre le motif ou la m√©thode derri√®re la g√©n√©ration de jetons peut permettre de pr√©dire ou de forcer les jetons. Quelques options :
* Bas√© sur l'horodatage
* Bas√© sur l'ID utilisateur
* Bas√© sur l'e-mail de l'utilisateur
* Bas√© sur le pr√©nom et le nom de famille
* Bas√© sur la date de naissance
* Bas√© sur la cryptographie
* **√âtapes d'att√©nuation**:
* Utilisez des m√©thodes cryptographiques solides pour la g√©n√©ration de jetons.
* Assurez une al√©atoire suffisante et une longueur pour √©viter la pr√©visibilit√©.
* **Outils** : Utilisez Burp Sequencer pour analyser l'al√©atoire des jetons.

## **UUID devinable**

* Si les UUID (version 1) sont devinables ou pr√©visibles, les attaquants peuvent les forcer pour g√©n√©rer des jetons de r√©initialisation valides. V√©rifiez :

{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **√âtapes d'att√©nuation**:
* Utilisez GUID version 4 pour l'al√©atoire ou mettez en place des mesures de s√©curit√© suppl√©mentaires pour les autres versions.
* **Outils** : Utilisez [guidtool](https://github.com/intruder-io/guidtool) pour analyser et g√©n√©rer des GUID.

## **Manipulation de la r√©ponse : Remplacer une mauvaise r√©ponse par une bonne**

* Manipuler les r√©ponses HTTP pour contourner les messages d'erreur ou les restrictions.
* **√âtapes d'att√©nuation**:
* Mettez en place des v√©rifications c√¥t√© serveur pour assurer l'int√©grit√© des r√©ponses.
* Utilisez des canaux de communication s√©curis√©s comme HTTPS pour pr√©venir les attaques de l'homme du milieu.
* **R√©f√©rence**:
* [Bug critique dans un √©v√©nement de prime aux bogues en direct](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Utilisation d'un jeton expir√©**

* Tester si les jetons expir√©s peuvent toujours √™tre utilis√©s pour la r√©initialisation du mot de passe.
* **√âtapes d'att√©nuation**:
* Mettez en place des politiques strictes d'expiration des jetons et validez l'expiration des jetons c√¥t√© serveur.

## **Forcer le jeton de r√©initialisation de mot de passe par force brute**

* Tenter de forcer le jeton de r√©initialisation en utilisant des outils comme Burpsuite et IP-Rotator pour contourner les limites de taux bas√©es sur l'IP.
* **√âtapes d'att√©nuation**:
* Mettez en place des m√©canismes robustes de limitation de taux et de verrouillage de compte.
* Surveillez les activit√©s suspectes indicatives d'attaques par force brute.

## **Essayez d'utiliser votre jeton**

* Tester si le jeton de r√©initialisation d'un attaquant peut √™tre utilis√© en conjonction avec l'e-mail de la victime.
* **√âtapes d'att√©nuation**:
* Assurez-vous que les jetons sont li√©s √† la session utilisateur ou √† d'autres attributs sp√©cifiques √† l'utilisateur.

## **Invalidation de session lors de la d√©connexion/r√©initialisation du mot de passe**

* S'assurer que les sessions sont invalid√©es lorsqu'un utilisateur se d√©connecte ou r√©initialise son mot de passe.
* **√âtapes d'att√©nuation**:
* Mettez en place une gestion de session appropri√©e, en veillant √† ce que toutes les sessions soient invalid√©es lors de la d√©connexion ou de la r√©initialisation du mot de passe.

## **Invalidation de session lors de la d√©connexion/r√©initialisation du mot de passe**

* Les jetons de r√©initialisation doivent avoir une dur√©e d'expiration apr√®s laquelle ils deviennent invalides.
* **√âtapes d'att√©nuation**:
* D√©finissez une dur√©e d'expiration raisonnable pour les jetons de r√©initialisation et faites-en strictement respecter la validit√© c√¥t√© serveur.

## R√©f√©rences

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Rejoignez le serveur [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) pour communiquer avec des hackers exp√©riment√©s et des chasseurs de primes en s√©curit√© !

**Perspectives de piratage**\
Engagez-vous avec du contenu qui explore le frisson et les d√©fis du piratage

**Actualit√©s de piratage en temps r√©el**\
Restez inform√© du monde du piratage √† rythme rapide gr√¢ce √† des actualit√©s et des informations en temps r√©el

**Derni√®res annonces**\
Restez inform√© des derni√®res primes aux bogues lanc√©es et des mises √† jour cruciales de la plateforme

**Rejoignez-nous sur** [**Discord**](https://discord.com/invite/N3FrSbmwdy) et commencez √† collaborer avec les meilleurs hackers d√®s aujourd'hui !

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
