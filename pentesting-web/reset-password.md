# Contournement de r√©initialisation/mot de passe oubli√©

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Rejoignez le serveur [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) pour communiquer avec des pirates exp√©riment√©s et des chasseurs de primes !

**Perspectives de piratage**\
Engagez-vous avec du contenu qui explore le frisson et les d√©fis du piratage

**Actualit√©s de piratage en temps r√©el**\
Restez √† jour avec le monde du piratage en √©volution rapide gr√¢ce √† des actualit√©s et des perspectives en temps r√©el

**Derni√®res annonces**\
Restez inform√© des derni√®res primes de bugs lanc√©es et des mises √† jour cruciales de la plateforme

**Rejoignez-nous sur** [**Discord**](https://discord.com/invite/N3FrSbmwdy) et commencez √† collaborer avec les meilleurs pirates d√®s aujourd'hui !

## **Fuite de jeton de r√©initialisation de mot de passe via le r√©f√©rent**
* L'en-t√™te HTTP referer peut divulguer le jeton de r√©initialisation de mot de passe s'il est inclus dans l'URL. Cela peut se produire lorsqu'un utilisateur clique sur un lien de site Web tiers apr√®s avoir demand√© une r√©initialisation de mot de passe.
* **Impact** : Prise de contr√¥le potentielle du compte via des attaques de falsification de requ√™te intersite (CSRF).
* **R√©f√©rences** :
- [Rapport HackerOne 342693](https://hackerone.com/reports/342693)
- [Rapport HackerOne 272379](https://hackerone.com/reports/272379)
- [Article sur la fuite de jeton de r√©initialisation de mot de passe](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Empoisonnement de r√©initialisation de mot de passe**
* Les attaquants peuvent manipuler l'en-t√™te Host lors des demandes de r√©initialisation de mot de passe pour pointer le lien de r√©initialisation vers un site malveillant.
* **Correctif** : Utilisez `$_SERVER['SERVER_NAME']` pour construire les URL de r√©initialisation de mot de passe au lieu de `$_SERVER['HTTP_HOST']`.
* **Impact** : Conduit √† une prise de contr√¥le potentielle du compte en divulguant des jetons de r√©initialisation aux attaquants.
* **√âtapes d'att√©nuation** :
- Valider l'en-t√™te Host par rapport √† une liste blanche de domaines autoris√©s.
- Utiliser des m√©thodes s√©curis√©es c√¥t√© serveur pour g√©n√©rer des URL absolues.
* **R√©f√©rences** :
- [Article d'Acunetix sur l'empoisonnement de r√©initialisation de mot de passe](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **R√©initialisation de mot de passe en manipulant le param√®tre d'e-mail**
* Les attaquants peuvent manipuler la demande de r√©initialisation de mot de passe en ajoutant des param√®tres d'e-mail suppl√©mentaires pour d√©tourner le lien de r√©initialisation.
* **√âtapes d'att√©nuation** :
- Analyser et valider correctement les param√®tres d'e-mail c√¥t√© serveur.
- Utiliser des instructions pr√©par√©es ou des requ√™tes param√©tr√©es pour pr√©venir les attaques par injection.
* **R√©f√©rences** :
- [Prise de contr√¥le de compte Readme.com](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)

## **Changement d'e-mail et de mot de passe de n'importe quel utilisateur via les param√®tres API**
* Les attaquants peuvent modifier les param√®tres d'e-mail et de mot de passe dans les requ√™tes API pour changer les informations d'identification du compte.
* **√âtapes d'att√©nuation** :
- Assurer une validation stricte des param√®tres et des v√©rifications d'authentification.
- Mettre en place une journalisation et une surveillance robustes pour d√©tecter et r√©pondre aux activit√©s suspectes.
* **R√©f√©rence** :
- [Prise de contr√¥le compl√®te du compte via la manipulation des param√®tres API](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Absence de limitation de taux : bombardement d'e-mails**
* Le manque de limitation de taux sur les demandes de r√©initialisation de mot de passe peut entra√Æner un bombardement d'e-mails, submergeant l'utilisateur de courriels de r√©initialisation.
* **√âtapes d'att√©nuation** :
- Mettre en place une limitation de taux bas√©e sur l'adresse IP ou le compte utilisateur.
- Utiliser des d√©fis CAPTCHA pour pr√©venir les abus automatis√©s.
* **R√©f√©rences** :
- [Rapport HackerOne 280534](https://hackerone.com/reports/280534)

## **D√©couvrez comment le jeton de r√©initialisation de mot de passe est g√©n√©r√©**
* Comprendre le motif ou la m√©thode derri√®re la g√©n√©ration de jetons peut permettre de pr√©dire ou de forcer les jetons.
* **√âtapes d'att√©nuation** :
- Utiliser des m√©thodes cryptographiques solides pour la g√©n√©ration de jetons.
- Assurer une al√©atoire suffisante et une longueur ad√©quate pour √©viter la pr√©visibilit√©.
* **Outils** : Utilisez Burp Sequencer pour analyser l'al√©atoire des jetons.

## **GUID devinable**
* Si les GUID (par exemple, version 1) sont devinables ou pr√©visibles, les attaquants peuvent les forcer pour g√©n√©rer des jetons de r√©initialisation valides.
* **√âtapes d'att√©nuation** :
- Utilisez GUID version 4 pour l'al√©atoire ou mettez en place des mesures de s√©curit√© suppl√©mentaires pour les autres versions.
* **Outils** : Utilisez [guidtool](https://github.com/intruder-io/guidtool) pour analyser et g√©n√©rer des GUID.

## **Manipulation de r√©ponse : remplacer une mauvaise r√©ponse par une bonne**
* Manipuler les r√©ponses HTTP pour contourner les messages d'erreur ou les restrictions.
* **√âtapes d'att√©nuation** :
- Mettre en place des v√©rifications c√¥t√© serveur pour assurer l'int√©grit√© des r√©ponses.
- Utiliser des canaux de communication s√©curis√©s comme HTTPS pour pr√©venir les attaques de l'homme du milieu.
* **R√©f√©rence** :
- [Bug critique dans un √©v√©nement de prime de bugs en direct](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Utilisation de jeton expir√©**
* Tester si les jetons expir√©s peuvent toujours √™tre utilis√©s pour la r√©initialisation de mot de passe.
* **√âtapes d'att√©nuation** :
- Mettre en place des politiques strictes d'expiration des jetons et valider l'expiration des jetons c√¥t√© serveur.

## **Brute Force du jeton de r√©initialisation de mot de passe**
* Tenter de forcer le jeton de r√©initialisation en utilisant des outils comme Burpsuite et IP-Rotator pour contourner les limites de taux bas√©es sur l'IP.
* **√âtapes d'att√©nuation** :
- Mettre en place des m√©canismes robustes de limitation de taux et de verrouillage de compte.
- Surveiller les activit√©s suspectes indiquant des attaques par force brute.

## **Essayez d'utiliser votre jeton**
* Tester si le jeton de r√©initialisation d'un attaquant peut √™tre utilis√© en conjonction avec l'e-mail de la victime.
* **√âtapes d'att√©nuation** :
- S'assurer que les jetons sont li√©s √† la session utilisateur ou √† d'autres attributs sp√©cifiques √† l'utilisateur.

## **Invalidation de session lors de la d√©connexion/r√©initialisation de mot de passe**
* S'assurer que les sessions sont invalid√©es lorsqu'un utilisateur se d√©connecte ou r√©initialise son mot de passe.
* **√âtapes d'att√©nuation** :
- Mettre en place une gestion de session appropri√©e, en veillant √† ce que toutes les sessions soient invalid√©es lors de la d√©connexion ou de la r√©initialisation du mot de passe.

## **Temps d'expiration du jeton de r√©initialisation**
* Les jetons de r√©initialisation doivent avoir un temps d'expiration apr√®s lequel ils deviennent invalides.
* **√âtapes d'att√©nuation** :
- D√©finir un temps d'expiration raisonnable pour les jetons de r√©initialisation et les appliquer strictement c√¥t√© serveur.

## **V√©rifications suppl√©mentaires**
* M√©thodes suppl√©mentaires pour tester les vuln√©rabilit√©s, telles que l'utilisation de formats d'e-mail sp√©ciaux ou de mots de passe longs pour causer un potentiel de d√©ni de service (DoS).
* **√âtapes d'att√©nuation** :
- Effectuer une validation des entr√©es et imposer des limites de longueur pour pr√©venir les abus.

# R√©f√©rences
* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Rejoignez le serveur [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) pour communiquer avec des pirates exp√©riment√©s et des chasseurs de primes !

**Perspectives de piratage**\
Engagez-vous avec du contenu qui explore le frisson et les d√©fis du piratage

**Actualit√©s de piratage en temps r√©el**\
Restez √† jour avec le monde du piratage en √©volution rapide gr√¢ce √† des actualit√©s et des perspectives en temps r√©el

**Derni√®res annonces**\
Restez inform√© des derni√®res primes de bugs lanc√©es et des mises √† jour cruciales de la plateforme

**Rejoignez-nous sur** [**Discord**](https://discord.com/invite/N3FrSbmwdy) et commencez √† collaborer avec les meilleurs pirates d√®s aujourd'hui !

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
