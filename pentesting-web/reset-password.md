# Rudisha/Epuka Nenosiri Bypass

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Jiunge na [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server ili kuwasiliana na wadukuzi wenye uzoefu na wawindaji wa zawadi za mdudu!

**Machapisho ya Kudukua**\
Shiriki na yaliyomo yanayochimba kina cha msisimko na changamoto za kudukua

**Taarifa za Kudukua Halisi**\
Kaa up-to-date na ulimwengu wa kudukua wenye kasi kupitia habari za wakati halisi na ufahamu

**Matangazo ya Karibuni**\
Baki mwelekezi na zawadi mpya za mdudu zinazoanzishwa na sasisho muhimu za jukwaa

**Jiunge nasi kwenye** [**Discord**](https://discord.com/invite/N3FrSbmwdy) na anza kushirikiana na wadukuzi bora leo!

## **Nenosiri la Rudisha Token Kuvuja Kupitia Referrer**

* Kichwa cha HTTP cha referrer kinaweza kuvuja nenosiri la kurejesha ikiwa kitajumuishwa kwenye URL. Hii inaweza kutokea wakati mtumiaji anapobofya kiungo cha tovuti ya tatu baada ya kuomba kurejesha nenosiri.
* **Athari**: Kuchukua akaunti inayowezekana kupitia mashambulizi ya Udukuzi wa Ombi la Msalaba wa Tovuti (CSRF).
* **Udanganyifu**: Ili kuthibitisha ikiwa tokeni ya kurejesha nenosiri inavuja kwenye kichwa cha referrer, **omba kurejesha nenosiri** kwa anwani yako ya barua pepe na **bonyeza kiungo cha kurejesha** kilichotolewa. **Usibadilishe nenosiri lako** mara moja. Badala yake, **nenda kwenye tovuti ya tatu** (kama Facebook au Twitter) wakati **ukizuia maombi kwa kutumia Burp Suite**. Angalia maombi ili uone ikiwa **kichwa cha referrer kina tokeni ya kurejesha nenosiri**, kwani hii inaweza kufunua habari nyeti kwa watu wa tatu.
* **Marejeo**:
* [Ripoti ya HackerOne 342693](https://hackerone.com/reports/342693)
* [Ripoti ya HackerOne 272379](https://hackerone.com/reports/272379)
* [Makala ya Kuvuja kwa Tokeni ya Kurejesha Nenosiri](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Udanganyifu wa Rudisha Nenosiri**

* Wadukuzi wanaweza kudanganya kichwa cha Mwenyeji wakati wa maombi ya kurejesha nenosiri ili kuuelekeza kiungo cha kurejesha kwenye tovuti yenye nia mbaya.
* **Athari**: Inasababisha kuchukua akaunti inayowezekana kwa kuvuja kwa tokeni za kurejesha kwa wadukuzi.
* **Hatua za Kupunguza Hatari**:
* Thibitisha kichwa cha Mwenyeji dhidi ya orodha nyeupe ya uwanja ulioruhusiwa.
* Tumia njia salama, za upande wa seva kuzalisha URL za kipekee.
* **Kifuniko**: Tumia `$_SERVER['SERVER_NAME']` kujenga URL za kurejesha nenosiri badala ya `$_SERVER['HTTP_HOST']`.
* **Marejeo**:
* [Makala ya Acunetix juu ya Udanganyifu wa Rudisha Nenosiri](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Rudisha Nenosiri Kwa Kudanganya Parameta ya Barua pepe**

Wadukuzi wanaweza kudanganya ombi la kurejesha nenosiri kwa kuongeza parameta za barua pepe ziada kuelekeza kiungo cha kurejesha. 

* Ongeza barua pepe ya muhudumu kama parameta ya pili kwa kutumia &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* Ongeza barua pepe ya mshambuliaji kama parameter ya pili kwa kutumia %20
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* Ongeza barua pepe ya mshambuliaji kama parameter ya pili kwa kutumia |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* Ongeza barua pepe ya mshambuliaji kama parameter ya pili kwa kutumia cc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* Ongeza barua pepe ya mshambuliaji kama parameter ya pili kwa kutumia bcc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* Ongeza barua pepe ya mshambuliaji kama parameter ya pili kwa kutumia ,
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* Ongeza barua pepe ya mshambuliaji kama parameter ya pili katika json array
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **Hatua za Kupunguza Hatari**:
* Tafsiri na thibitisha vigezo vya barua pepe kwa upande wa seva ipasavyo.
* Tumia taarifa zilizotayarishwa au maswali yenye vigezo ili kuzuia mashambulizi ya kuingiza.
* **Vyanzo**:
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **Kubadilisha Barua pepe Na Nywila ya Mtumiaji yeyote kupitia Vigezo vya API**

* Wachomozaji wanaweza kubadilisha vigezo vya barua pepe na nywila katika maombi ya API ili kubadilisha maelezo ya akaunti.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **Hatua za Kupunguza Hatari**:
* Hakikisha ukaguzi wa kigezo na uhakiki wa uthibitishaji.
* Tekeleza ufuatiliaji na uchunguzi imara ili kugundua na kujibu shughuli za shaka.
* **Marejeo**:
* [Kuchukua Udhibiti Kamili kupitia Ubadilishaji wa Vigezo vya API](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Hakuna Kikomo cha Kiwango: Bomba la Barua pepe**

* Kutokuwepo kwa kikomo cha kiwango kwenye maombi ya kurejesha nenosiri kunaweza kusababisha bomba la barua pepe, kuzidiwa na mtumiaji kwa barua pepe za kurejesha.
* **Hatua za Kupunguza Hatari**:
* Tekeleza kikomo cha kiwango kulingana na anwani ya IP au akaunti ya mtumiaji.
* Tumia changamoto za CAPTCHA kuzuia unyanyasaji wa kiotomatiki.
* **Marejeo**:
* [Ripoti ya HackerOne 280534](https://hackerone.com/reports/280534)

## **Kugundua Jinsi Tokeni ya Kurejesha Nenosiri Inavyotengenezwa**

* Kuelewa mchoro au njia nyuma ya utengenezaji wa tokeni kunaweza kusababisha kutabiri au kubadilisha nguvu za tokeni. Baadhi ya chaguo:
* Kulingana na Muda wa Mwisho
* Kulingana na Kitambulisho cha Mtumiaji
* Kulingana na Barua pepe ya Mtumiaji
* Kulingana na Jina la Kwanza na la Mwisho
* Kulingana na Tarehe ya Kuzaliwa
* Kulingana na Kriptografia
* **Hatua za Kupunguza Hatari**:
* Tumia njia imara, za kriptografia kwa utengenezaji wa tokeni.
* Hakikisha upatikanaji wa kutosha na urefu wa kutosha kuzuia kutabirika.
* **Zana**: Tumia Burp Sequencer kuchambua kutabirika kwa tokeni.

## **UUID Inayoweza Kutabirika**

* Ikiwa UUIDs (toleo 1) zinaweza kutabirika au kubashiriwa, wachomaji wanaweza kuzibadilisha kwa nguvu ili kuzalisha tokeni halali za kurejesha. Angalia:

{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **Hatua za Kupunguza Hatari**:
* Tumia GUID toleo 4 kwa kutabirika au tekeleza hatua za usalama zaidi kwa toleo nyingine.
* **Zana**: Tumia [guidtool](https://github.com/intruder-io/guidtool) kwa kuchambua na kuzalisha GUIDs.

## **Ubadilishaji wa Majibu: Badilisha Majibu Mabaya na Mema**

* Kubadilisha majibu ya HTTP ili kuzidi ujumbe wa kosa au vizuizi.
* **Hatua za Kupunguza Hatari**:
* Tekeleza ukaguzi wa upande wa seva ili kuhakikisha uadilifu wa majibu.
* Tumia njia salama za mawasiliano kama HTTPS kuzuia mashambulizi ya mtu katikati.
* **Marejeo**:
* [Kosa Kubwa katika Tukio la Tuzo ya Bug Moja kwa Moja](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Kutumia Tokeni Iliyomalizika Muda**

* Jaribio la kuona ikiwa tokeni zilizomalizika muda zinaweza bado kutumika kwa kurejesha nenosiri.
* **Hatua za Kupunguza Hatari**:
* Tekeleza sera kali za ukomo wa tokeni na thibitisha muda wa kumalizika kwa tokeni upande wa seva.

## **Kubadilisha Nguvu ya Kurejesha Nenosiri kwa Nguvu**

* Kujaribu kubadilisha nguvu ya kurejesha tokeni kwa kutumia zana kama Burpsuite na IP-Rotator kwa kuzidi mipaka ya kiwango cha IP.
* **Hatua za Kupunguza Hatari**:
* Tekeleza mifumo imara ya kikomo cha kiwango na kufunga akaunti.
* Fuatilia shughuli za shaka zinazoashiria mashambulizi ya kubadilisha nguvu.

## **Jaribu Kutumia Tokeni Yako**

* Jaribio la kuona ikiwa tokeni ya kubadilisha ya mshambuliaji inaweza kutumika pamoja na barua pepe ya muathiriwa.
* **Hatua za Kupunguza Hatari**:
* Hakikisha kuwa tokeni zimefungwa kwa kikao cha mtumiaji au sifa zingine za mtumiaji.

## **Kufuta Kikao katika Kutoka/Reseti ya Nenosiri**

* Kuhakikisha kuwa vikao vinabatilishwa wakati mtumiaji anatoka au kurejesha nenosiri lake.
* **Hatua za Kupunguza Hatari**:
* Tekeleza usimamizi sahihi wa kikao, kuhakikisha kuwa vikao vyote vinabatilishwa wakati wa kutoka au kurejesha nenosiri.

## **Kufuta Kikao katika Kutoka/Reseti ya Nenosiri**

* Tokeni za kurejesha zinapaswa kuwa na muda wa kumalizika ambapo baada ya hapo zinakuwa batili.
* **Hatua za Kupunguza Hatari**:
* Weka muda wa kumalizika wa kufaa kwa tokeni za kurejesha na uhakikishe kutekelezwa kwa nguvu upande wa seva.

## Marejeo

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Jiunge na [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server ili kuwasiliana na wachomaji wenye uzoefu na wawindaji wa tuzo za mdudu!

**Machapisho ya Kuchomwa**\
Shiriki na yaliyomo yanayochimba katika msisimko na changamoto za kuchoma

**Machapisho ya Habari za Kuchoma kwa Wakati Halisi**\
Kaa sawa na ulimwengu wa kuchoma kwa kasi kupitia habari za wakati halisi na ufahamu

**Matangazo Mapya Zaidi**\
Baki na habari za hivi karibuni za tuzo za mdudu zinazoanzishwa na sasisho muhimu za jukwaa

**Jiunge nasi kwenye** [**Discord**](https://discord.com/invite/N3FrSbmwdy) na anza kushirikiana na wachomaji bora leo!
