# Resetowanie/Zapomniane hasło - ominięcie

<details>

<summary><strong>Dowiedz się, jak hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Dołącz do serwera [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), aby komunikować się z doświadczonymi hakerami i łowcami błędów!

**Wgląd w hakerstwo**\
Zajmuj się treściami, które zagłębiają się w emocje i wyzwania hakerstwa

**Aktualności na żywo z hakerstwa**\
Bądź na bieżąco z szybkim tempem świata hakerstwa dzięki aktualnym wiadomościom i wglądom

**Najnowsze ogłoszenia**\
Bądź na bieżąco z najnowszymi programami bug bounty i ważnymi aktualizacjami platformy

**Dołącz do nas na** [**Discordzie**](https://discord.com/invite/N3FrSbmwdy) i zacznij współpracować z najlepszymi hakerami już dziś!

## **Wyciek tokena resetowania hasła za pomocą nagłówka Referrer**
* Nagłówek HTTP referer może wyciekać token resetowania hasła, jeśli jest zawarty w adresie URL. Może to się zdarzyć, gdy użytkownik kliknie na link strony trzeciej po żądaniu resetowania hasła.
* **Wpływ**: Potencjalne przejęcie konta za pomocą ataków Cross-Site Request Forgery (CSRF).
* **Odwołania**:
- [Raport HackerOne 342693](https://hackerone.com/reports/342693)
- [Raport HackerOne 272379](https://hackerone.com/reports/272379)
- [Artykuł o wycieku tokena resetowania hasła](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Zatrucie resetowania hasła**
* Atakujący mogą manipulować nagłówkiem Host podczas żądań resetowania hasła, aby skierować link resetu do złośliwej witryny.
* **Poprawka**: Użyj `$_SERVER['SERVER_NAME']` do tworzenia adresów URL resetowania hasła zamiast `$_SERVER['HTTP_HOST']`.
* **Wpływ**: Prowadzi do potencjalnego przejęcia konta poprzez wyciek tokenów resetu do atakujących.
* **Kroki łagodzenia**:
- Sprawdź nagłówek Host na podstawie białej listy dozwolonych domen.
- Użyj bezpiecznych, serwerowych metod do generowania absolutnych adresów URL.
* **Odwołania**:
- [Artykuł Acunetix na temat zatrucia resetowania hasła](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Resetowanie hasła poprzez manipulację parametrem email**
* Atakujący mogą manipulować żądaniem resetowania hasła poprzez dodawanie dodatkowych parametrów email w celu zmiany kierunku linku resetu.
* **Kroki łagodzenia**:
- Poprawnie analizuj i sprawdzaj parametry email po stronie serwera.
- Używaj przygotowanych instrukcji lub zapytań z parametrami, aby zapobiec atakom wstrzykiwania.
* **Odwołania**:
- [Przejęcie konta Readme.com](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)

## **Zmiana adresu e-mail i hasła dowolnego użytkownika za pomocą parametrów API**
* Atakujący mogą modyfikować parametry adresu e-mail i hasła w żądaniach API, aby zmieniać dane logowania do konta.
* **Kroki łagodzenia**:
- Zapewnij ścisłą walidację parametrów i sprawdzanie uwierzytelniania.
- Wdrożenie solidnego rejestrowania i monitorowania w celu wykrywania i reagowania na podejrzane działania.
* **Odwołanie**:
- [Pełne przejęcie konta poprzez manipulację parametrami API](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Brak limitu ilościowego: bombardowanie e-mailem**
* Brak limitu ilościowego dla żądań resetowania hasła może prowadzić do bombardowania e-mailem, przytłaczając użytkownika resetowymi wiadomościami e-mail.
* **Kroki łagodzenia**:
- Wdrożenie limitowania ilościowego na podstawie adresu IP lub konta użytkownika.
- Używanie wyzwań CAPTCHA w celu zapobiegania automatycznemu nadużyciu.
* **Odwołania**:
- [Raport HackerOne 280534](https://hackerone.com/reports/280534)

## **Dowiedz się, jak jest generowany token resetowania hasła**
* Zrozumienie wzorca lub metody generowania tokenów może prowadzić do przewidywania lub prób siłowych tokenów.
* **Kroki łagodzenia**:
- Używaj silnych, kryptograficznych metod generowania tokenów.
- Zapewnij wystarczającą losowość i długość, aby zapobiec przewidywalności.
* **Narzędzia**: Użyj Burp Sequencer do analizy losowości tokenów.

## **Przewidywalne GUID**
* Jeśli GUID-y (np. wersja 1) są przewidywalne lub przewidywalne, atakujący mogą próbować siłowo je generować, aby uzyskać ważne tokeny resetu.
* **Kroki łagodzenia**:
- Używaj wersji 4 GUID do generowania losowości lub wdroż dodatkowe środki bezpieczeństwa dla innych wersji.
* **Narzędzia**: Użyj [guidtool](https://github.com/intruder-io/guidtool) do analizy i generowania GUID-ów.

## **Manipulacja odpowiedzią: zamiana złej odpowiedzi na dobrą**
* Manipulowanie odpowiedziami HTTP w celu ominięcia komunikatów o błędach lub ograniczeń.
* **Kroki łagodzenia**:
- Wdrożenie sprawdzeń po stronie serwera w celu zapewnienia integralności odpowiedzi.
- Używanie bezpiecznych kanałów komunikacji, takich jak HTTPS, w celu zapobiegania atakom typu man-in-the-middle.
* **Odwołanie**:
- [Krytyczny błąd w żywym wydarzeniu bug bounty](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Użycie wygasłego tokenu**
* Testowanie, czy wygasłe tokeny nadal można używać do resetowania hasła.
* **Kroki łagodzenia**:
- Wdrożenie ścisłych zasad wygasania tokenów i sprawdzanie wygaśnięcia tokenów po stronie serwera.

## **Siłowe łamanie tokenu resetowania hasła**
* Próba siłowego łamania tokenu resetu za pomocą narzędzi takich jak Burpsuite i IP-Rotator w celu ominięcia limitów ilościowych opartych na adresie IP.
* **Kroki łag
## Odwołania
* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Dołącz do serwera [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), aby komunikować się z doświadczonymi hakerami i łowcami błędów!

**Wgląd w hakerstwo**\
Zajmuj się treściami, które zagłębiają się w emocje i wyzwania hakerstwa

**Aktualności na żywo z hakerstwa**\
Bądź na bieżąco z szybkim tempem świata hakerstwa dzięki aktualnym wiadomościom i wglądom

**Najnowsze ogłoszenia**\
Bądź na bieżąco z najnowszymi programami bug bounty i ważnymi aktualizacjami platformy

**Dołącz do nas na** [**Discordzie**](https://discord.com/invite/N3FrSbmwdy) i zacznij współpracować z najlepszymi hakerami już dziś!

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriów github.

</details>
