# Şifre Sıfırlama/Unutulan Şifre Atlatma

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin!</summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* **Deneyimli hackerlar ve ödül avcılarıyla iletişim kurmak için** [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katılın!

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve ödül avcılarıyla iletişim kurmak için [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katılın!

**Hacking İçgörüleri**\
Hacking'in heyecanını ve zorluklarını ele alan içeriklerle etkileşime geçin

**Gerçek Zamanlı Hack Haberleri**\
Hızlı tempolu hacking dünyasını gerçek zamanlı haberler ve içgörülerle takip edin

**En Son Duyurular**\
Yeni ödül avcıları başlatmaları ve önemli platform güncellemeleri hakkında bilgi edinin

**Bize katılın** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugün en iyi hackerlarla işbirliği yapmaya başlayın!

## **Referrer Aracılığıyla Şifre Sıfırlama Jetonu Sızıntısı**
* HTTP referer başlığı, şifre sıfırlama jetonunu URL içinde yer aldığında sızabilir. Bu durum, bir kullanıcının şifre sıfırlama isteğinden sonra üçüncü taraf bir web sitesi bağlantısına tıklaması durumunda ortaya çıkabilir.
* **Etki**: Cross-Site Request Forgery (CSRF) saldırıları aracılığıyla potansiyel hesap ele geçirme.
* **Referanslar**:
- [HackerOne Raporu 342693](https://hackerone.com/reports/342693)
- [HackerOne Raporu 272379](https://hackerone.com/reports/272379)
- [Şifre Sıfırlama Jetonu Sızıntısı Makalesi](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Şifre Sıfırlama Zehirlenmesi**
* Saldırganlar, şifre sıfırlama isteklerinde Host başlığını manipüle ederek sıfırlama bağlantısını kötü niyetli bir siteye yönlendirebilir.
* **Yama**: Şifre sıfırlama URL'lerini oluşturmak için `$_SERVER['HTTP_HOST']` yerine `$_SERVER['SERVER_NAME']` kullanın.
* **Etki**: Sıfırlama jetonlarını saldırganlara sızdırarak potansiyel hesap ele geçirmeye yol açar.
* **Hafifletme Adımları**:
- Host başlığını izin verilen alan adları beyaz listesine karşı doğrulayın.
- Mutlak URL'ler oluşturmak için güvenli, sunucu tarafı yöntemler kullanın.
* **Referanslar**:
- [Şifre Sıfırlama Zehirlenmesi Hakkında Acunetix Makalesi](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **E-posta Parametresini Manipüle Ederek Şifre Sıfırlama**
* Saldırganlar, sıfırlama bağlantısını yönlendirmek için şifre sıfırlama isteğine ek e-posta parametreleri ekleyebilir.
* **Hafifletme Adımları**:
- Sunucu tarafında e-posta parametrelerini düzgün bir şekilde ayrıştırın ve doğrulayın.
- Enjeksiyon saldırılarını önlemek için hazırlanmış ifadeler veya parametreli sorgular kullanın.
* **Referanslar**:
- [Readme.com Hesap Ele Geçirme](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)

## **API Parametreleri Aracılığıyla Herhangi Bir Kullanıcının E-posta ve Şifresini Değiştirme**
* Saldırganlar, API isteklerinde e-posta ve şifre parametrelerini değiştirerek hesap kimlik bilgilerini değiştirebilir.
* **Hafifletme Adımları**:
- Sıkı parametre doğrulama ve kimlik doğrulama kontrolleri sağlayın.
- Şüpheli faaliyetleri tespit etmek ve yanıtlamak için sağlam günlükleme ve izleme uygulayın.
* **Referans**:
- [API Parametre Manipülasyonu Aracılığıyla Tam Hesap Ele Geçirme](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Hız Sınırlaması Yok: E-posta Bombardımanı**
* Şifre sıfırlama isteklerinde hız sınırlamasının olmaması, kullanıcıyı sıfırlama e-postalarıyla ezme durumuna yol açabilir.
* **Hafifletme Adımları**:
- IP adresine veya kullanıcı hesabına dayalı hız sınırlaması uygulayın.
- Otomatik kötüye kullanımı önlemek için CAPTCHA meydan okumaları kullanın.
* **Referanslar**:
- [HackerOne Raporu 280534](https://hackerone.com/reports/280534)

## **Şifre Sıfırlama Jetonunun Nasıl Oluşturulduğunu Bulma**
* Jeton oluşturma desenini veya yöntemini anlamak, jetonların tahmin edilmesine veya brute-force saldırılarına yol açabilir.
* **Hafifletme Adımları**:
- Jeton oluşturmak için güçlü, kriptografik yöntemler kullanın.
- Tahmin edilebilirliği önlemek için yeterli rastgelelik ve uzunluk sağlayın.
* **Araçlar**: Jetonların rastgeleliğini analiz etmek için Burp Sequencer'ı kullanın.

## **Tahmin Edilebilir GUID**
* GUID'ler (örneğin, sürüm 1) tahmin edilebilir veya öngörülebilir ise, saldırganlar geçerli sıfırlama jetonları oluşturmak için brute-force saldırısı yapabilir.
* **Hafifletme Adımları**:
- Rastgelelik için GUID sürüm 4 kullanın veya diğer sürümler için ek güvenlik önlemleri uygulayın.
* **Araçlar**: GUID'leri analiz etmek ve oluşturmak için [guidtool](https://github.com/intruder-io/guidtool) kullanın.

## **Yanıt Manipülasyonu: Kötü Yanıtı İyi Bir Yanıtla Değiştirme**
* HTTP yanıtlarını manipüle ederek hata mesajlarını veya kısıtlamaları atlatma.
* **Hafifletme Adımları**:
- Yanıt bütünlüğünü sağlamak için sunucu tarafı kontrolleri uygulayın.
- Orta adam saldırılarını önlemek için HTTPS gibi güvenli iletişim kanalları kullanın.
* **Referans**:
- [Canlı Bug Bounty Etkinliğindeki Kritik Hata](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Süresi Dolmuş Jetonu Kullanma**
* Süresi dolmuş jetonların hala şifre sıfırlama için kullanılıp kullanılamayacağını test etme.
* **Hafifletme Adımları**:
- Jeton süresi dolma politikalarını sıkı bir şekilde uygulayın ve jeton süresinin sunucu tarafında doğrulan
## Referanslar
* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve ödül avcıları ile iletişim kurmak için [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katılın!

**Hacking İçgörüleri**\
Hacking'in heyecanına ve zorluklarına dalmış içeriklerle etkileşim kurun

**Gerçek Zamanlı Hack Haberleri**\
Hızlı tempolu hacking dünyasını gerçek zamanlı haberler ve içgörülerle takip edin

**En Son Duyurular**\
Yeni ödül avları başlatma ve önemli platform güncellemeleri hakkında bilgi edinin

**Bize** [**Discord**](https://discord.com/invite/N3FrSbmwdy) **katılın ve bugün en iyi hackerlarla işbirliği yapmaya başlayın!**

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklam vermek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerimizden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına **PR göndererek paylaşın**.

</details>
