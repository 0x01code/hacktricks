# Ανάκτηση/Παράκαμψη Ξεχασμένου Κωδικού

<details>

<summary><strong>Μάθετε το χάκινγκ στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Ειδικός Ερυθρού Συνεργείου AWS του HackTricks)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι υποστήριξης του HackTricks:

* Αν θέλετε να δείτε την **εταιρεία σας διαφημισμένη στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα τηλεγραφήματος**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Συμμετέχετε στον [**Διακομιστή Discord του HackenProof**](https://discord.com/invite/N3FrSbmwdy) για να επικοινωνείτε με έμπειρους χάκερ και κυνηγούς ευρημάτων ασφαλείας!

**Εισαγωγή στο Χάκινγκ**\
Ασχοληθείτε με περιεχόμενο που εξετάζει την αγωνία και τις προκλήσεις του χάκινγκ

**Ειδήσεις Χάκινγκ σε Πραγματικό Χρόνο**\
Μείνετε ενήμεροι με τον γρήγορο κόσμο του χάκινγκ μέσω ειδήσεων και αναλύσεων σε πραγματικό χρόνο

**Τελευταίες Ανακοινώσεις**\
Μείνετε ενήμεροι με τις νεότερες ανακοινώσεις για νέες αμοιβές ευρημάτων και κρίσιμες ενημερώσεις πλατφόρμας

**Ελάτε στο** [**Discord**](https://discord.com/invite/N3FrSbmwdy) και αρχίστε να συνεργάζεστε με κορυφαίους χάκερ σήμερα!

## **Διαρροή Διακριτικού Ανάκτησης Κωδικού μέσω του Αναφέροντος (Referrer)**

* Η κεφαλίδα HTTP referer μπορεί να διαρρεύσει το διακριτικό ανάκτησης κωδικού αν περιλαμβάνεται στο URL. Αυτό μπορεί να συμβεί όταν ένας χρήστης κάνει κλικ σε σύνδεσμο ιστότοπου τρίτου μετά την αίτηση επαναφοράς κωδικού.
* **Επίπτωση**: Πιθανή ανάληψη λογαριασμού μέσω επιθέσεων Cross-Site Request Forgery (CSRF).
* **Εκμετάλλευση**: Για να ελέγξετε αν ένα διακριτικό επαναφοράς κωδικού διαρρέει στην κεφαλίδα αναφορέα, **ζητήστε επαναφορά κωδικού** στη διεύθυνση email σας και **κάντε κλικ στον σύνδεσμο επαναφοράς** που παρέχεται. **Μην αλλάξετε αμέσως τον κωδικό σας**. Αντίθετα, **πλοηγηθείτε σε ιστότοπο τρίτου** (όπως το Facebook ή το Twitter) ενώ **παρεμβάλλετε τις αιτήσεις χρησιμοποιώντας το Burp Suite**. Ελέγξτε τις αιτήσεις για να δείτε αν η **κεφαλίδα αναφορέα περιέχει το διακριτικό επαναφοράς κωδικού**, καθώς αυτό θα μπορούσε να αποκαλύψει ευαίσθητες πληροφορίες σε τρίτους.
* **Αναφορές**:
* [Αναφορά HackerOne 342693](https://hackerone.com/reports/342693)
* [Αναφορά HackerOne 272379](https://hackerone.com/reports/272379)
* [Άρθρο Διαρροής Διακριτικού Επαναφοράς Κωδικού](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Δηλητηρίαση Επαναφοράς Κωδικού**

* Οι επιτιθέμενοι μπορούν να διαμορφώσουν την κεφαλίδα Host κατά την αίτηση επαναφοράς κωδικού για να κατευθύνουν τον σύνδεσμο επαναφοράς σε κακόβουλο ιστότοπο.
* **Επίπτωση**: Οδηγεί σε πιθανή ανάληψη λογαριασμού με τη διαρροή διακριτικών επαναφοράς σε επιτιθέμενους.
* **Βήματα Αντιμετώπισης**:
* Επικυρώστε την κεφαλίδα Host έναντι μιας λίστας επιτρεπόμενων τομέων.
* Χρησιμοποιήστε ασφαλείς, μεθόδους στην πλευρά του διακομιστή για τη δημιουργία απόλυτων διευθύνσεων URL.
* **Επιδιόρθωση**: Χρησιμοποιήστε `$_SERVER['SERVER_NAME']` για την κατασκευή των διευθύνσεων επαναφοράς κωδικού αντί για `$_SERVER['HTTP_HOST']`.
* **Αναφορές**:
* [Άρθρο της Acunetix για τη Δηλητηρίαση Επαναφοράς Κωδικού](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Επαναφορά Κωδικού με Διαμόρφωση Παραμέτρου Email**

Οι επιτιθέμενοι μπορούν να διαμορφώσουν το αίτημα επαναφοράς κωδικού προσθέτοντας επιπλέον παραμέτρους email για να αποκρούσουν τον σύνδεσμο επαναφοράς.

* Προσθέστε το email του επιτιθέμενου ως δεύτερη παράμετρο χρησιμοποιώντας &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* Προσθέστε το email του επιτιθέμενου ως δεύτερη παράμετρο χρησιμοποιώντας το %20
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* Προσθέστε το email του επιτιθέμενου ως δεύτερη παράμετρο χρησιμοποιώντας |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* Προσθέστε το email του επιτιθέμενου ως δεύτερη παράμετρο χρησιμοποιώντας το cc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* Προσθέστε το email του εισβολέα ως δεύτερη παράμετρο χρησιμοποιώντας το bcc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* Προσθέστε το email του επιτιθέμενου ως δεύτερη παράμετρο χρησιμοποιώντας ,
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* Προσθέστε το email του εισβολέα ως δεύτερη παράμετρο στον πίνακα json
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **Βήματα Αντιμετώπισης**:
* Να γίνεται σωστή ανάλυση και επικύρωση παραμέτρων email στον διακομιστή.
* Χρήση προετοιμασμένων δηλώσεων ή ερωτημάτων με παραμέτρους για την πρόληψη επιθέσεων ενσωμάτωσης.
* **Αναφορές**:
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **Αλλαγή Email Και Κωδικού πρόσβασης οποιουδήποτε Χρήστη μέσω Παραμέτρων API**

* Οι επιτιθέμενοι μπορούν να τροποποιήσουν τις παραμέτρους email και κωδικού πρόσβασης σε αιτήματα API για να αλλάξουν τα διαπιστευτήρια λογαριασμού.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **Βήματα Αντιμετώπισης**:
* Βεβαιωθείτε για αυστηρό έλεγχο παραμέτρων και ελέγχους ταυτοποίησης.
* Εφαρμόστε αξιόπιστη καταγραφή και παρακολούθηση για ανίχνευση και αντίδραση σε ύποπτες δραστηριότητες.
* **Αναφορά**:
* [Πλήρης Κατάληψη Λογαριασμού μέσω Αλλοίωσης Παραμέτρων API](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Χωρίς Όριο Ρυθμού: Email Bombing**

* Η έλλειψη ορίου ρυθμού σε αιτήσεις επαναφοράς κωδικού πρόσβασης μπορεί να οδηγήσει σε email bombing, κατακλύζοντας τον χρήστη με email επαναφοράς.
* **Βήματα Αντιμετώπισης**:
* Εφαρμόστε όριο ρυθμού με βάση τη διεύθυνση IP ή τον λογαριασμό χρήστη.
* Χρησιμοποιήστε προκλήσεις CAPTCHA για την πρόληψη αυτοματοποιημένων καταχρήσεων.
* **Αναφορές**:
* [Αναφορά HackerOne 280534](https://hackerone.com/reports/280534)

## **Ανακαλύψτε Πώς Δημιουργείται το Token Επαναφοράς Κωδικού**

* Η κατανόηση του προτύπου ή της μεθόδου πίσω από τη δημιουργία του token μπορεί να οδηγήσει στην πρόβλεψη ή στη δύναμη των token. Κάποιες επιλογές:
* Βασισμένο στην Χρονική Σήμανση
* Βασισμένο στον Αναγνωριστικό Χρήστη
* Βασισμένο στο Email του Χρήστη
* Βασισμένο στο Όνομα και το Επώνυμο
* Βασισμένο στην Ημερομηνία Γέννησης
* Βασισμένο στην Κρυπτογραφία
* **Βήματα Αντιμετώπισης**:
* Χρησιμοποιήστε ισχυρές, κρυπτογραφικές μεθόδους για τη δημιουργία token.
* Βεβαιωθείτε για επαρκή τυχαιότητα και μήκος για την πρόληψη της προβλεψιμότητας.
* **Εργαλεία**: Χρησιμοποιήστε το Burp Sequencer για να αναλύσετε την τυχαιότητα των token.

## **Μαντεψιάρικο UUID**

* Εάν τα UUIDs (έκδοση 1) είναι μαντεψιάρικα ή προβλέψιμα, οι επιτιθέμενοι μπορεί να τα δοκιμάσουν με δύναμη για τη δημιουργία έγκυρων token επαναφοράς. Ελέγξτε:

{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **Βήματα Αντιμετώπισης**:
* Χρησιμοποιήστε GUID έκδοση 4 για τυχαιότητα ή εφαρμόστε επιπλέον μέτρα ασφαλείας για άλλες εκδόσεις.
* **Εργαλεία**: Χρησιμοποιήστε το [guidtool](https://github.com/intruder-io/guidtool) για ανάλυση και δημιουργία GUIDs.

## **Αλλαγή Απάντησης: Αντικατάσταση Κακής Απάντησης με Καλή**

* Αλλοίωση των απαντήσεων HTTP για να παρακάμψετε μηνύματα σφαλμάτων ή περιορισμούς.
* **Βήματα Αντιμετώπισης**:
* Εφαρμόστε ελέγχους στην πλευρά του διακομιστή για να διασφαλίσετε την ακεραιότητα της απάντησης.
* Χρησιμοποιήστε ασφαλείς κανάλια επικοινωνίας όπως το HTTPS για την πρόληψη επιθέσεων man-in-the-middle.
* **Αναφορά**:
* [Κρίσιμο Σφάλμα σε Ζωντανό Συμβάν Ανταμοιβής Ευρημάτων](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Χρήση Ληγμένου Token**

* Δοκιμάζοντας εάν τα ληγμένα token μπορούν ακόμα να χρησιμοποιηθούν για επαναφορά κωδικού πρόσβασης.
* **Βήματα Αντιμετώπισης**:
* Εφαρμόστε αυστηρές πολιτικές λήξης token και επικυρώστε τη λήξη του token στην πλευρά του διακομιστή.

## **Δοκιμή Βίας στο Token Επαναφοράς Κωδικού**

* Προσπάθεια βίας στο token επαναφοράς χρησιμοποιώντας εργαλεία όπως το Burpsuite και το IP-Rotator για την παράκαμψη των ορίων ρυθμού βάσει IP.
* **Βήματα Αντιμετώπισης**:
* Εφαρμόστε αξιόπιστα μέτρα ορίου ρυθμού και κλειδώματος λογαριασμού.
* Παρακολουθήστε για ύποπτες δραστηριότητες που υποδηλώνουν επιθέσεις βίας.

## **Δοκιμή Χρήσης του Token Σας**

* Δοκιμάζοντας εάν το token επαναφοράς ενός επιτιθέμενου μπορεί να χρησιμοποιηθεί σε συνδυασμό με το email του θύματος.
* **Βήματα Αντιμετώπισης**:
* Βεβαιωθείτε ότι τα token είναι δεμένα με τη συνεδρία χρήστη ή άλλα χαρακτηριστικά που αφορούν τον χρήστη.

## **Ακύρωση Συνεδρίας στην Αποσύνδεση/Επαναφορά Κωδικού**

* Βεβαιωθείτε ότι οι συνεδρίες ακυρώνονται όταν ένας χρήστης αποσυνδέεται ή επαναφέρει τον κωδικό του.
* **Βήματα Αντιμετώπισης**:
* Εφαρμόστε σωστή διαχείριση συνεδριών, εξασφαλίζοντας ότι όλες οι συνεδρίες ακυρώνονται κατά την αποσύνδεση ή την επαναφορά κωδικού.

## **Ακύρωση Συνεδρίας στην Αποσύνδεση/Επαναφορά Κωδικού**

* Τα token επαναφοράς πρέπει να έχουν μια χρονική λήξη μετά την οποία γίνονται άκυρα.
* **Βήματα Αντιμετώπισης**:
* Ορίστε μια λογική χρονική λήξη για τα token επαναφοράς και εφαρμόστε την αυστηρά στην πλευρά του διακομιστή.

## Αναφορές

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Εγγραφείτε στο [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server για επικοινωνία με έμπειρους χάκερ και κυνηγούς ευρημάτων ασφαλείας!

**Εισαγωγή στο Hacking**\
Ασχοληθείτε με περιεχόμενο που εξερευνά την αγωνία και τις προκλήσεις του χάκινγκ

**Ειδήσεις Χάκινγκ σε Πραγματικό Χρόνο**\
Μείνετε ενημερωμένοι με τον γρήγορο ρυθμό του κόσμου του χάκινγκ μέσω ειδήσεων και αναλύσεων σε πραγματικό χρόνο

**Τελευταίες Ανακοινώσεις**\
Μείνετε ενήμεροι με τις νεότερες ανακοινώσεις για νέες ανταμοιβές ευρημάτων και κρίσιμες ενημερώσεις πλατφόρμας

**Ελάτε στο** [**Discord**](https://discord.com/invite/N3FrSbmwdy) και αρχίστε τη συνεργασία με κορυφαίους χάκερ σήμερα!

<details>

<summary><strong>Μάθετε το χάκινγκ στο AWS από το μηδέν μέχρι τον ήρωα με</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι υποστήριξης του HackTricks:

* Αν θέλετε να δείτε τη
