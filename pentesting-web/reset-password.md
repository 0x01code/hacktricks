# Herstel/Vergete Wagwoord Oorskryding

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kontroleer die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Sluit aan by [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om te kommunikeer met ervare hackers en foutbeloningsjagters!

**Hakinsigte**\
Gaan in gesprek met inhoud wat die opwinding en uitdagings van hakken ondersoek

**Haknuus in Werklikheid**\
Bly op hoogte van die snelveranderende hakw√™reld deur werklikheidsnuus en insigte

**Nuutste Aankondigings**\
Bly ingelig met die nuutste foutbelonings wat bekendgestel word en kritieke platformopdaterings

**Sluit by ons aan op** [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin vandag saamwerk met top hackers!

## **Wagwoord Herstel Token Lek deur Verwysing**

* Die HTTP verwysingskop kan die wagwoord herstel token lek as dit ingesluit is in die URL. Dit kan gebeur wanneer 'n gebruiker op 'n skakel van 'n derde party webwerf klik nadat 'n wagwoordherstel versoek is.
* **Impak**: Potensi√´le rekening oorneem via Cross-Site Request Forgery (CSRF) aanvalle.
* **Uitbuiting**: Om te kontroleer of 'n wagwoordherstel token in die verwysingskop lek, **versoek 'n wagwoordherstel** na jou e-posadres en **klik op die herstelskakel** wat voorsien word. **Verander nie dadelik jou wagwoord** nie. In plaas daarvan, **navigeer na 'n derde party webwerf** (soos Facebook of Twitter) terwyl jy die versoeke met Burp Suite onderskep. Inspekteer die versoeke om te sien of die **verwysingskop die wagwoordherstel token bevat**, aangesien dit sensitiewe inligting aan derdepartye kan blootstel.
* **Verwysings**:
* [HackerOne Verslag 342693](https://hackerone.com/reports/342693)
* [HackerOne Verslag 272379](https://hackerone.com/reports/272379)
* [Wagwoord Herstel Token Lek Artikel](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Wagwoord Herstel Vergiftiging**

* Aanvallers kan die Host-kop manipuleer tydens wagwoordherstelversoeke om die herstelskakel na 'n skadelike webwerf te rig.
* **Impak**: Lei tot potensi√´le rekening oorneem deur herstel tokens aan aanvallers te lek.
* **Mitigasie Stappe**:
* Valideer die Host-kop teen 'n witlys van toegelate domeine.
* Gebruik veilige, bedienerkant metodes om absolute URL's te genereer.
* **Patch**: Gebruik `$_SERVER['SERVER_NAME']` om wagwoordherstel-URL's saam te stel in plaas van `$_SERVER['HTTP_HOST']`.
* **Verwysings**:
* [Acunetix Artikel oor Wagwoord Herstel Vergiftiging](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Wagwoord Herstel deur E-posparameter te Manipuleer**

Aanvallers kan die wagwoordherstelversoek manipuleer deur addisionele e-posparameters by te voeg om die herstelskakel te stuur.

* Voeg aanvaller se e-pos as tweede parameter by deur &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
* Voeg aanvaller se e-pos by as tweede parameter deur gebruik te maak van %20
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
* Voeg aanvaller se e-pos by as tweede parameter deur | te gebruik
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
* Voeg aanvaller se e-pos by as tweede parameter met behulp van cc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
* Voeg aanvaller se e-pos as tweede parameter by deur bcc te gebruik
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
* Voeg aanvaller se e-pos by as tweede parameter deur gebruik te maak van ,
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
* Voeg aanvaller se e-pos as tweede parameter by in json-array
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
* **Mitigasie Stappe**:
* Parseer en valideer e-pos parameters behoorlik aan die kant van die bediener.
* Gebruik voorbereide stateerments of geparametriseerde navrae om inspuitingsaanvalle te voorkom.
* **Verwysings**:
* [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
* [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
* [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **Verandering van E-pos en Wagwoord van enige Gebruiker deur API-parameters**

* Aanvallers kan e-pos en wagwoord parameters in API-versoeke wysig om rekeninggelde te verander.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
* **Migrasie Stappe**:
* Verseker streng parameter validering en outentifikasie kontroles.
* Implementeer robuuste logging en monitering om verdagte aktiwiteite op te spoor en daarop te reageer.
* **Verwysing**:
* [Volledige Rekening Oorname deur API Parameter Manipulasie](https://medium.com/@adeshkolte/volledige-rekening-oorname-verandering-van-e-pos-en-wagwoord-van-enige-gebruiker-deur-api-parameters-3d527ab27240)

## **Geen Tariefbeperking: E-pos Bombardering**

* 'n Gebrek aan tariefbeperking op wagwoord herstelaanvrae kan lei tot e-pos bombardering, waar die gebruiker oorweldig word met herstel e-posse.
* **Migrasie Stappe**:
* Implementeer tariefbeperking gebaseer op IP-adres of gebruikersrekening.
* Gebruik CAPTCHA-uitdagings om outomatiese misbruik te voorkom.
* **Verwysings**:
* [HackerOne Verslag 280534](https://hackerone.com/reports/280534)

## **Vind Uit Hoe Wagwoord Herstel Token gegenereer word**

* Begrip van die patroon of metode agter token generasie kan lei tot die voorspelling of kragtige kragtige tokens. Sommige opsies:
* Gebaseer op Tydstempel
* Gebaseer op die GebruikersID
* Gebaseer op die e-pos van die Gebruiker
* Gebaseer op Voornaam en Van
* Gebaseer op Geboortedatum
* Gebaseer op Kriptografie
* **Migrasie Stappe**:
* Gebruik sterk, kriptografiese metodes vir token generasie.
* Verseker voldoende willekeurigheid en lengte om voorspelbaarheid te voorkom.
* **Hulpmiddels**: Gebruik Burp Sequencer om die willekeurigheid van tokens te analiseer.

## **Raai-bare UUID**

* As UUID's (weergawe 1) raai-baar of voorspelbaar is, kan aanvallers hulle kragtig kragtig maak om geldige herstel tokens te genereer. Kontroleer:
{% content-ref url="uuid-insecurities.md" %}
[uuid-insecurities.md](uuid-insecurities.md)
{% endcontent-ref %}

* **Migrasie Stappe**:
* Gebruik GUID weergawe 4 vir willekeurigheid of implementeer addisionele sekuriteitsmaatre√´ls vir ander weergawes.
* **Hulpmiddels**: Gebruik [guidtool](https://github.com/intruder-io/guidtool) vir die analise en generering van GUID's.

## **Respons Manipulasie: Vervang Slegte Respons met Goeie Een**

* Manipuleer HTTP-respons om foutboodskappe of beperkings te omseil.
* **Migrasie Stappe**:
* Implementeer bedienerkant kontroles om responsintegriteit te verseker.
* Gebruik veilige kommunikasiekanale soos HTTPS om man-in-die-middel aanvalle te voorkom.
* **Verwysing**:
* [Kritiese Fout in Lewende Bug Bounty Gebeurtenis](https://medium.com/@innocenthacker/hoe-ek-die-mees-kritiese-fout-in-lewende-bug-bounty-gebeurtenis-gevind-het-7a88b3aa97b3)

## **Gebruik van Vervalle Token**

* Toets of vervalle tokens steeds gebruik kan word vir wagwoord herstel.
* **Migrasie Stappe**:
* Implementeer streng token verval beleide en valideer token verval aan bedienerkant.

## **Kragtige Kragtige Wagwoord Herstel Token**

* Poging om die herstel token kragtig te kragtig met behulp van hulpmiddels soos Burpsuite en IP-Rotator om IP-gebaseerde tariefbeperkings te omseil.
* **Migrasie Stappe**:
* Implementeer robuuste tariefbeperking en rekening sluitingsmeganismes.
* Monitor vir verdagte aktiwiteite wat dui op kragtige kragtige aanvalle.

## **Probeer Jou Token Gebruik**

* Toets of 'n aanvaller se herstel token gebruik kan word in samehang met die slagoffer se e-pos.
* **Migrasie Stappe**:
* Verseker dat tokens gebind is aan die gebruikersessie of ander gebruikerspesifieke eienskappe.

## **Sessie Ongeldigverklaring in Uitlog/ Wagwoord Herstel**

* Verseker dat sessies ongeldig verklaar word wanneer 'n gebruiker uitlog of hul wagwoord herstel.
* **Migrasie Stappe**:
* Implementeer behoorlike sessiebestuur, verseker dat alle sessies ongeldig verklaar word by uitlog of wagwoord herstel.

## **Sessie Ongeldigverklaring in Uitlog/ Wagwoord Herstel**

* Herstel tokens moet 'n vervaltydperk h√™ waarna hulle ongeldig word.
* **Migrasie Stappe**:
* Stel 'n redelike vervaltydperk vir herstel tokens en handhaaf dit streng aan die bedienerkant.

## Verwysings

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Sluit aan by [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om te kommunikeer met ervare hackers en foutbeloningsjagters!

**Hack-insigte**\
Betrokkenheid by inhoud wat die opwinding en uitdagings van hack bekyk

**Re√´le Tyd Hack Nuus**\
Bly op hoogte van die vinnige hackw√™reld deur middel van nuus en insigte in re√´le tyd

**Nuutste Aankondigings**\
Bly ingelig met die nuutste foutbelonings wat bekendgestel word en kritieke platformopdaterings

**Sluit by ons aan op** [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin vandag saamwerk met top hackers!
