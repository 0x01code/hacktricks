# рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдФрд░ рдХреИрд╢ рдбрд┐рд╕реЗрдкреНрд╢рди

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реБрд░реБрдЖрдд рд╕реЗ рд▓реЗрдХрд░ рдПрдХреНрд╕рдкрд░реНрдЯ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ.

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд░реНрдХрдлреНрд▓реЛрдЬрд╝ рдмрд┐рд▓реНрдб рдФрд░ рдСрдЯреЛрдореЗрдЯ** рдХрд░реЗрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рдХрдореНрдпреБрдирд┐рдЯреА рдЯреВрд▓реНрд╕ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ.\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рдЕрдВрддрд░

> **рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдФрд░ рд╡реЗрдм рдХреИрд╢ рдбрд┐рд╕реЗрдкреНрд╢рди рдореЗрдВ рдХреНрдпрд╛ рдЕрдВрддрд░ рд╣реИ?**
>
> * **рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ** рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХреИрд╢ рдореЗрдВ рдХреБрдЫ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╕рд╛рдордЧреНрд░реА рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рд╕рд╛рдордЧреНрд░реА рдХреИрд╢ рд╕реЗ рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕реЗрд╡рд╛ рдХреА рдЬрд╛рддреА рд╣реИ.
> * **рд╡реЗрдм рдХреИрд╢ рдбрд┐рд╕реЗрдкреНрд╢рди** рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХреИрд╢ рдореЗрдВ рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдХреБрдЫ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рд╛рдордЧреНрд░реА рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдХреИрд╢ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ.

## рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ

рдХреИрд╢ рдХреЛ рдкреЙрдЗрдЬрд╝рди рдХрд░рдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп **рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХреЛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЖрдВрд╢рд┐рдХ рд░реВрдк рд╕реЗ рдпрд╛ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЛрдб рдХрд░рдирд╛** рд╣реИ.\
рдкреЙрдЗрдЬрд╝рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреНрд░рддрд┐рд╕рд╛рдж рдХреЗрд╡рд▓ рдЙрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕реЗрд╡рд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдкреГрд╖реНрда рдкрд░ рдЬрд╛рддреЗ рд╣реИрдВ рдЬрдмрдХрд┐ рдХреИрд╢ рдкреЙрдЗрдЬрд╝рди рд╣реЛрддрд╛ рд╣реИ. рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдкреНрд░рднрд╛рд╡ рдЧреИрд░-рдореМрдЬреВрдж рд╕реЗ рд▓реЗрдХрд░ рд╡рд┐рд╢рд╛рд▓ рддрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдпрд╣ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдкреГрд╖реНрда рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реИ рдпрд╛ рдирд╣реАрдВ.

рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ **рдЕрдирдХреАрдб рдЗрдирдкреБрдЯреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреА рд╣реЛрдЧреА** (рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдЬреЛ рдХреИрд╢реНрдб рдЕрдиреБрд░реЛрдз рдкрд░ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдЬреЛ рд▓реМрдЯрд╛рдП рдЧрдП рдкреГрд╖реНрда рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВ), рджреЗрдЦреЗрдВ **рдХреИрд╕реЗ рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░реЗрдВ** рдФрд░ **рдкреНрд░рддрд┐рд╕рд╛рдж рдХреЛ рдХреИрд╢ рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**.

### рдЦреЛрдЬ: HTTP рд╣реЗрдбрд░реНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

рдЖрдорддреМрд░ рдкрд░, рдЬрдм рдПрдХ рдкреНрд░рддрд┐рд╕рд╛рдж **рдХреИрд╢ рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛрддрд╛ рд╣реИ** рддреЛ рд╡рд╣рд╛рдВ рдПрдХ **рд╣реЗрдбрд░ рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ**, рдЖрдк рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХрд┐рди рд╣реЗрдбрд░реНрд╕ рдкрд░ рдзреНрдпрд╛рди рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП: [**HTTP рдХреИрд╢ рд╣реЗрдбрд░реНрд╕**](../network-services-pentesting/pentesting-web/special-http-headers.md#cache-headers).

### рдЦреЛрдЬ: 400 рдХреЛрдб рдХреИрд╢рд┐рдВрдЧ

рдпрджрд┐ рдЖрдк рд╕реЛрдЪ рд░рд╣реЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рддрд┐рд╕рд╛рдж рдХреИрд╢ рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк **рдЦрд░рд╛рдм рд╣реЗрдбрд░ рдХреЗ рд╕рд╛рде рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рдЬрд┐рд╕рдХрд╛ рдЬрд╡рд╛рдм **рд╕реНрдЯреЗрдЯрд╕ рдХреЛрдб 400** рдХреЗ рд╕рд╛рде рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП. рдлрд┐рд░ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдЕрдиреБрд░реЛрдз рдХрд╛ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдФрд░ рдпрджрд┐ **рдкреНрд░рддрд┐рд╕рд╛рдж 400 рд╕реНрдЯреЗрдЯрд╕ рдХреЛрдб рд╣реИ**, рддреЛ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИ (рдФрд░ рдЖрдк рдпрд╣рд╛рдВ рддрдХ рдХрд┐ DoS рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ).\
рдПрдХ рдЦрд░рд╛рдм рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЗрдбрд░ рд╕рд┐рд░реНрдл `\:` рд╣реЛ рд╕рдХрддрд╛ рд╣реИ.\
_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХрднреА-рдХрднреА рдЗрд╕ рддрд░рд╣ рдХреЗ рд╕реНрдЯреЗрдЯрд╕ рдХреЛрдбреНрд╕ рдХреИрд╢ рдирд╣реАрдВ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЗрд╕рд▓рд┐рдП рдпрд╣ рдкрд░реАрдХреНрд╖рдг рдмреЗрдХрд╛рд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ._

### рдЦреЛрдЬ: рдЕрдирдХреАрдб рдЗрдирдкреБрдЯреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВ рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВ

рдЖрдк [**Param Miner**](https://portswigger.net/bappstore/17d2949a985c4b7ca092728dba871943) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдФрд░ рд╣реЗрдбрд░реНрд╕ рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдкреГрд╖реНрда рдХреЗ рдкреНрд░рддрд┐рд╕рд╛рдж рдХреЛ **рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ**. рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдкреГрд╖реНрда `X-Forwarded-For` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╡рд╣рд╛рдВ рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ:
```markup
<script type="text/javascript" src="//<X-Forwarded-For_value>/resources/js/tracking.js"></script>
```
### рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рд╕реЗ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

рдкреИрд░рд╛рдореАрдЯрд░/рд╣реЗрдбрд░ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдЗрд╕реЗ рдХреИрд╕реЗ **рд╕реИрдирд┐рдЯрд╛рдЗрдЬ** рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдФрд░ **рдХрд╣рд╛рдВ** рдкрд░ рдпрд╣ **рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд** рд╣реЛ рд░рд╣рд╛ рд╣реИ рдпрд╛ рд╣реЗрдбрд░ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реИред рдХреНрдпрд╛ рдЖрдк рдЗрд╕рдХрд╛ рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (XSS рдХрд░рдирд╛ рдпрд╛ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд JS рдХреЛрдб рд▓реЛрдб рдХрд░рдирд╛? DoS рдХрд░рдирд╛?...)

### рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХреИрд╢ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░реЗрдВ

рдЬрдм рдЖрдкрдиреЗ **рдкрд╣рдЪрд╛рди** рд▓рд┐рдпрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕рд╛ **рдкреГрд╖реНрда** рджреБрд░реБрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рд╣реИ, рдХрд┐рд╕ **рдкреИрд░рд╛рдореАрдЯрд░**/**рд╣реЗрдбрд░** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ рдФрд░ **рдХреИрд╕реЗ** рдЗрд╕рдХрд╛ **рджреБрд░реБрдкрдпреЛрдЧ** рдХрд░рдирд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдкреГрд╖реНрда рдХреЛ рдХреИрд╢ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдЬрд┐рд╕ рд╕рдВрд╕рд╛рдзрди рдХреЛ рдЖрдк рдХреИрд╢ рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЙрд╕рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╕рдордп рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ, рдЖрдкрдХреЛ рдХрдИ рд╕реЗрдХрдВрдб рддрдХ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИред\
рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╣реЗрдбрд░ **`X-Cache`** рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЬрдм рдЕрдиреБрд░реЛрдз рдХреИрд╢ рдореЗрдВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ рддреЛ рдЗрд╕рдХрд╛ рдорд╛рди **`miss`** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЬрдм рдпрд╣ рдХреИрд╢ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ рддреЛ рдорд╛рди **`hit`** рд╣реЛ рд╕рдХрддрд╛ рд╣реИред\
рд╣реЗрдбрд░ **`Cache-Control`** рднреА рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рд╕рдВрд╕рд╛рдзрди рдХреИрд╢ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЕрдЧрд▓реА рдмрд╛рд░ рдпрд╣ рдХрдм рдлрд┐рд░ рд╕реЗ рдХреИрд╢ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрдЧрд╛: `Cache-Control: public, max-age=1800`\
рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЗрдбрд░ **`Vary`** рд╣реИред рдпрд╣ рд╣реЗрдбрд░ рдЕрдХреНрд╕рд░ **рдЕрддрд┐рд░рд┐рдХреНрдд рд╣реЗрдбрд░реНрд╕ рдХреЛ рд╕рдВрдХреЗрдд рджреЗрдиреЗ** рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдХреИрд╢ рдХреА рдХреБрдВрдЬреА рдХреЗ **рднрд╛рдЧ рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдиреЗ рдЬрд╛рддреЗ рд╣реИрдВ** рднрд▓реЗ рд╣реА рд╡реЗ рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдЕрдирдХреАрдб рд╣реЛрдВред рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЙрд╕ рд╡рд┐рдХреНрдЯрд┐рдо рдХрд╛ `User-Agent` рдкрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╡рд╣ рд▓рдХреНрд╖рд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рд╡рд╣ рдЙрд╕ рд╡рд┐рд╢реЗрд╖ `User-Agent` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдХреИрд╢ рдХреЛ рдЬрд╣рд░реАрд▓рд╛ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред\
рдХреИрд╢ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдПрдХ рдФрд░ рд╣реЗрдбрд░ **`Age`** рд╣реИред рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдСрдмреНрдЬреЗрдХреНрдЯ рдкреНрд░реЙрдХреНрд╕реА рдХреИрд╢ рдореЗрдВ рдХрд┐рддрдиреЗ рд╕реЗрдХрдВрдб рд╕реЗ рд╣реИред

рдЬрдм рдЖрдк рдХрд┐рд╕реА рдЕрдиреБрд░реЛрдз рдХреЛ рдХреИрд╢ рдХрд░ рд░рд╣реЗ рд╣реЛрдВ, рддреЛ рдЖрдк рдЬрд┐рди рд╣реЗрдбрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдЙрдирдХреЗ рд╕рд╛рде **рд╕рд╛рд╡рдзрд╛рди рд░рд╣реЗрдВ** рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рд╣реЗрдбрд░реНрд╕ **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд░реВрдк рд╕реЗ** **рдХреАрдб** рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рд╡рд┐рдХреНрдЯрд┐рдо рдХреЛ рдЙрд╕реА рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛**ред рд╣рдореЗрд╢рд╛ **рд╡рд┐рднрд┐рдиреНрди рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ** рдХреЗ рд╕рд╛рде Cache Poisoning рдХрд╛ **рдкрд░реАрдХреНрд╖рдг** рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЬрд╛рдВрдЪ рд╕рдХреЗрдВ рдХрд┐ рдпрд╣ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред

## рд╢реЛрд╖рдг рдХреЗ рдЙрджрд╛рд╣рд░рдг

### рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рдЙрджрд╛рд╣рд░рдг

рдПрдХ рд╣реЗрдбрд░ рдЬреИрд╕реЗ `X-Forwarded-For` рдХреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдмрд┐рдирд╛ рд╕реИрдирд┐рдЯрд╛рдЗрдЬ рдХрд┐рдП рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ>\
рдЖрдк рдПрдХ рдореВрд▓ XSS рдкреЗрд▓реЛрдб рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХреИрд╢ рдХреЛ рдЬрд╣рд░реАрд▓рд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЬреЛ рдХреЛрдИ рднреА рдкреГрд╖реНрда рддрдХ рдкрд╣реБрдВрдЪреЗрдЧрд╛ рдЙрд╕реЗ XSS рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝реЗрдЧрд╛:
```markup
GET /en?region=uk HTTP/1.1
Host: innocent-website.com
X-Forwarded-Host: a."><script>alert(1)</script>"
```
_Note that this will poison a request to `/en?region=uk` not to `/en`_

### рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреБрдХреА-рд╣реИрдВрдбрд▓рд┐рдВрдЧ рднреЗрджреНрдпрддрд╛рдУрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛

рдХреБрдХреАрдЬрд╝ рднреА рдПрдХ рдкреГрд╖реНрда рдХреЗ рдкреНрд░рддрд┐рд╕рд╛рдж рдореЗрдВ рдкрд░рд┐рд▓рдХреНрд╖рд┐рдд рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдпрджрд┐ рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ XSS рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдХрдИ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдореЗрдВ XSS рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдХреИрд╢ рдкреНрд░рддрд┐рд╕рд╛рдж рдХреЛ рд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВред
```markup
GET / HTTP/1.1
Host: vulnerable.com
Cookie: session=VftzO7ZtiBj5zNLRAuFpXpSQLjS4lBmU; fehost=asd"%2balert(1)%2b"
```
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдмрд╣реБрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдирд┐рдпрдорд┐рдд рдЕрдиреБрд░реЛрдз рдХреИрд╢ рдХреЛ рд╕рд╛рдл рдХрд░ рджреЗрдВрдЧреЗред

### рд╡реЗрдм рдХреИрд╢ рд╡рд┐рд╖рд╛рдХреНрддрддрд╛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рд╣реЗрдбрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ <a href="#using-multiple-headers-to-exploit-web-cache-poisoning-vulnerabilities" id="using-multiple-headers-to-exploit-web-cache-poisoning-vulnerabilities"></a>

рдХрднреА-рдХрднреА рдЖрдкрдХреЛ рдХреИрд╢ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдХрдИ рдЕрдирдХреАрдб рдЗрдирдкреБрдЯреНрд╕ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛** рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдПрдХ **Open redirect** рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рдЖрдк `X-Forwarded-Host` рдХреЛ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдбреЛрдореЗрди рдкрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ `X-Forwarded-Scheme` рдХреЛ `http` рдкрд░ред **рдпрджрд┐** **рд╕рд░реНрд╡рд░** рд╕рднреА **HTTP** рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ **HTTPS** рдкрд░ **рдЕрдЧреНрд░реЗрд╖рд┐рдд** рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ рд╣реЗрдбрд░ `X-Forwarded-Scheme` рдХрд╛ рдЙрдкрдпреЛрдЧ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП рдбреЛрдореЗрди рдирд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рдХрд░ рд░рд╣рд╛ рд╣реИред рдЖрдк рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдкреГрд╖реНрда рдХреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рджреНрд╡рд╛рд░рд╛ рдХрд╣рд╛рдВ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред
```markup
GET /resources/js/tracking.js HTTP/1.1
Host: acc11fe01f16f89c80556c2b0056002e.web-security-academy.net
X-Forwarded-Host: ac8e1f8f1fb1f8cb80586c1d01d500d3.web-security-academy.net/
X-Forwarded-Scheme: http
```
### рд╕реАрдорд┐рдд `Vary` рд╣реИрдбрд░ рдХрд╛ рджреЛрд╣рди

рдпрджрд┐ рдЖрдкрдиреЗ рдкрд╛рдпрд╛ рд╣реИ рдХрд┐ **`X-Host`** рд╣реИрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ **рдбреЛрдореЗрди рдирд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ JS рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ **`Vary`** рд╣реИрдбрд░ **`User-Agent`** рдХреЛ рд╕рдВрдХреЗрдд рдХрд░ рд░рд╣рд╛ рд╣реИред рддрдм, рдЖрдкрдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ User-Agent рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдЦреЛрдЬрдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЙрд╕ User-Agent рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреИрд╢ рдХреЛ рд╡рд┐рд╖рд╛рдХреНрдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛:
```markup
GET / HTTP/1.1
Host: vulnerbale.net
User-Agent: THE SPECIAL USER-AGENT OF THE VICTIM
X-Host: attacker.com
```
### HTTP рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

рдпрд╣рд╛рдВ рдЬрд╛рдиреЗрдВ рдХрд┐ [HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рд╣рдорд▓реЗ рдХреИрд╕реЗ рдХрд░реЗрдВ](http-request-smuggling/#using-http-request-smuggling-to-perform-web-cache-poisoning)ред

### рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдкрд░реАрдХреНрд╖рдг

[рд╡реЗрдм рдХреИрд╢ рд╡рд▓реНрдирд░реЗрдмрд┐рд▓рд┐рдЯреА рд╕реНрдХреИрдирд░](https://github.com/Hackmanit/Web-Cache-Vulnerability-Scanner) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЕрддреНрдпрдзрд┐рдХ рдЕрдиреБрдХреВрд▓рдиреАрдп рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: `wcvs -u example.com`

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд░реНрдХрдлреНрд▓реЛрдЬрд╝ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рди** рдХрд░реЗрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЙрджрд╛рд╣рд░рдг

### Apache Traffic Server ([CVE-2021-27577](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27577))

ATS рдиреЗ URL рдХреЗ рдЕрдВрджрд░ рдХреЗ рдлреНрд░реИрдЧрдореЗрдВрдЯ рдХреЛ рдмрд┐рдирд╛ рд╣рдЯрд╛рдП рдЖрдЧреЗ рднреЗрдЬрд╛ рдФрд░ рдХреИрд╢ рдХреБрдВрдЬреА рдХреЗрд╡рд▓ рд╣реЛрд╕реНрдЯ, рдкрде рдФрд░ рдХреНрд╡реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрдирд╛рдИ (рдлреНрд░реИрдЧрдореЗрдВрдЯ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рддреЗ рд╣реБрдП)ред рдЗрд╕рд▓рд┐рдП рдЕрдиреБрд░реЛрдз `/#/../?r=javascript:alert(1)` рдХреЛ рдмреИрдХрдПрдВрдб рдХреЛ `/#/../?r=javascript:alert(1)` рдХреЗ рд░реВрдк рдореЗрдВ рднреЗрдЬрд╛ рдЧрдпрд╛ рдФрд░ рдХреИрд╢ рдХреБрдВрдЬреА рдореЗрдВ рдкреЗрд▓реЛрдб рдирд╣реАрдВ рдерд╛, рдХреЗрд╡рд▓ рд╣реЛрд╕реНрдЯ, рдкрде рдФрд░ рдХреНрд╡реЗрд░реА рдереЗред

### GitHub CP-DoS

рдХрдВрдЯреЗрдВрдЯ-рдЯрд╛рдЗрдк рд╣реЗрдбрд░ рдореЗрдВ рдЦрд░рд╛рдм рдорд╛рди рднреЗрдЬрдиреЗ рд╕реЗ 405 рдХреИрд╢реНрдб рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЯреНрд░рд┐рдЧрд░ рд╣реБрдИред рдХреИрд╢ рдХреБрдВрдЬреА рдореЗрдВ рдХреБрдХреА рд╢рд╛рдорд┐рд▓ рдереА рдЗрд╕рд▓рд┐рдП рдХреЗрд╡рд▓ рдЕрдкреНрд░рдорд╛рдгрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдкрд░ рд╣рдорд▓рд╛ рд╕рдВрднрд╡ рдерд╛ред

### GitLab + GCP CP-DoS

GitLab рд╕реНрдерд┐рд░ рд╕рд╛рдордЧреНрд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП GCP рдмрдХреЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред **GCP Buckets** **`x-http-method-override` рд╣реЗрдбрд░** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП `x-http-method-override: HEAD` рд╣реЗрдбрд░ рднреЗрдЬрдирд╛ рд╕рдВрднрд╡ рдерд╛ рдФрд░ рдХреИрд╢ рдХреЛ рдЦрд╛рд▓реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╢рд░реАрд░ рд▓реМрдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╣рд░ рджреЗрдирд╛ рд╕рдВрднрд╡ рдерд╛ред рдпрд╣ `PURGE` рд╡рд┐рдзрд┐ рдХрд╛ рднреА рд╕рдорд░реНрдерди рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### Rack Middleware (Ruby on rails)

Ruby on Rails рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдХреНрд╕рд░ Rack рдорд┐рдбрд▓рд╡реЗрдпрд░ рдХреЗ рд╕рд╛рде рддреИрдирд╛рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ Rack рдХреЛрдб **`x-forwarded-scheme` рдорд╛рди рдХреЛ рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдЙрд╕реЗ рдЕрдиреБрд░реЛрдз рдХреА рдпреЛрдЬрдирд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ**ред

![](<../.gitbook/assets/image (159) (2).png>)

`x-forwarded-scheme: http` рд╣реЗрдбрд░ рднреЗрдЬрдиреЗ рд╕реЗ рдПрдХ 301 рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдЙрд╕реА рд╕реНрдерд╛рди рдкрд░ рд╣реЛрдЧрд╛ рдЬреЛ рдЙрд╕ рд╕рдВрд╕рд╛рдзрди рдкрд░ рдПрдХ DoS рдХрд╛ рдХрд╛рд░рдг рдмрдиреЗрдЧрд╛ рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╣реИ:

![](<../.gitbook/assets/image (166).png>)

рдПрдкреНрд▓рд┐рдХреЗрд╢рди `X-forwarded-host` рд╣реЗрдбрд░ рдХрд╛ рднреА рд╕рдорд░реНрдерди рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЙрд╕ рд╣реЛрд╕реНрдЯ рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рд╕рд░реНрд╡рд░ рд╕реЗ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлрд╛рдЗрд▓реЗрдВ рд▓реЛрдб рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

![](<../.gitbook/assets/image (157) (2).png>)

### 403 рдФрд░ рд╕реНрдЯреЛрд░реЗрдЬ рдмрдХреЗрдЯреНрд╕

рдкрд╣рд▓реЗ, **Cloudflare** **403 рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ** рдХреЛ **рдХреИрд╢** рдХрд░рддрд╛ рдерд╛, рдЗрд╕рд▓рд┐рдП **рдЦрд░рд╛рдм Authorization** рд╣реЗрдбрд░реНрд╕ рднреЗрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рд╕реЗ **S3** рдпрд╛ **Azure Storage Blobs** рдХрд╛ рдкреНрд░рдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп 403 рд╡рд╛рдкрд╕ рдЖрдПрдЧрд╛ рдЬреЛ рдХреИрд╢ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред Cloudflare рдЕрдм 403 рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдХреИрд╢ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдпрд╣ рдЕрдиреНрдп рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИред

![](<../.gitbook/assets/image (171).png>)

### рдХреБрдВрдЬреАрдпреБрдХреНрдд рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХрд╛ рдЗрдВрдЬреЗрдХреНрд╢рди

рдЕрдХреНрд╕рд░, рдХреИрд╢ рдХреЛ рдХреИрд╢ рдХреБрдВрдЬреА рдореЗрдВ рдХреЗрд╡рд▓ рд╡рд┐рд╢рд┐рд╖реНрдЯ GET рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, Fastly рдиреЗ Varnish рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд░реЛрдз рдореЗрдВ `size` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **рдХреИрд╢** рдХрд┐рдпрд╛ рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдкрдиреЗ **рдпрд╣ рднреА** **`siz%65`** рдкреИрд░рд╛рдореАрдЯрд░ рднреЗрдЬрд╛ рддреЛ рдЦрд░рд╛рдм рдорд╛рди рдХреЗ рд╕рд╛рде, **рдХреИрд╢ рдХреБрдВрдЬреА** **рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд▓рд┐рдЦреЗ рдЧрдП size рдкреИрд░рд╛рдореАрдЯрд░** рдХреЗ рд╕рд╛рде рдмрдирд╛рдИ рдЧрдИ рдереА, рд▓реЗрдХрд┐рди **рдмреИрдХрдПрдВрдб** рдиреЗ **URL рдПрдиреНрдХреЛрдбреЗрдб рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдЕрдВрджрд░ рдХреЗ рдорд╛рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред

![](<../.gitbook/assets/image (180).png>)

рджреВрд╕рд░реЗ `size` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ URL рдПрдиреНрдХреЛрдб рдХрд░рдиреЗ рд╕реЗ рд╡рд╣ рдХреИрд╢ рджреНрд╡рд╛рд░рд╛ рдЕрдирджреЗрдЦрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд▓реЗрдХрд┐рди рдмреИрдХрдПрдВрдб рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ред рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ 0 рдХрд╛ рдорд╛рди рджреЗрдиреЗ рд╕реЗ рдПрдХ рдХреИрд╢реЗрдмрд▓ 400 рдмреИрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реЛрдЧрд╛ред

### рдпреВрдЬрд░ рдПрдЬреЗрдВрдЯ рдирд┐рдпрдо

FFUF рдпрд╛ Nuclei рдЬреИрд╕реЗ рдЯреВрд▓реНрд╕ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдЯреНрд░реИрдлрд┐рдХ рдХреА рдмрдбрд╝реА рдорд╛рддреНрд░рд╛ рдХреЗ рдХрд╛рд░рдг, рдХреБрдЫ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдиреЗ рдЙрдирдХреЗ рдпреВрдЬрд░-рдПрдЬреЗрдВрдЯреНрд╕ рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдмреНрд▓реЙрдХ рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛ред рд╡рд┐рдбрдВрдмрдирд╛ рдпрд╣ рд╣реИ рдХрд┐, рдпреЗ рдЯреНрд╡реАрдХреНрд╕ рдЕрдирдЪрд╛рд╣реЗ рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдФрд░ DoS рдЕрд╡рд╕рд░реЛрдВ рдХреЛ рдкреЗрд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

![](<../.gitbook/assets/image (167) (2).png>)

рдореИрдВрдиреЗ рдкрд╛рдпрд╛ рдХрд┐ рдпрд╣ рд╡рд┐рднрд┐рдиреНрди рд▓рдХреНрд╖реНрдпреЛрдВ рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд╡рд┐рднрд┐рдиреНрди рдЙрдкрдХрд░рдгреЛрдВ рдпрд╛ рд╕реНрдХреИрдирд░реЛрдВ рд╕реЗ рдпреВрдЬрд░-рдПрдЬреЗрдВрдЯреНрд╕ рдХреЗ рд╕рд╛рдеред

### рдЕрд╡реИрдз рд╣реЗрдбрд░ рдлреАрд▓реНрдбреНрд╕

рд╣реЗрдбрд░ рдирд╛рдо рдкреНрд░рд╛рд░реВрдк [RFC7230](https://datatracker.ietf.mrg/doc/html/rfc7230) рдореЗрдВ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реИ:

![](<../.gitbook/assets/image (175) (2).png>)

рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рдпрджрд┐ рдПрдХ рд╣реЗрдбрд░ рдирд╛рдо рдореЗрдВ **tchar** рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рд╡рд░реНрдгреЛрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдЕрдиреНрдп рд╡рд░реНрдг рд╣реЛрддреЗ рд╣реИрдВ рддреЛ рдЗрд╕реЗ 400 рдмреИрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЗ рд╕рд╛рде рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рд╕рд░реНрд╡рд░ рд╣рдореЗрд╢рд╛ RFC рдХрд╛ рд╕рдореНрдорд╛рди рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕ рдмрд╛рд░реАрдХреА рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ Akamai рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рдирд╛ рдерд╛ рдЬреЛ рдЕрд╡реИрдз рд╣реЗрдбрд░реНрд╕ рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЙрдиреНрд╣реЗрдВ рдЖрдЧреЗ рднреЗрдЬрддрд╛ рд╣реИ рдФрд░ рдХрд┐рд╕реА рднреА 400 рддреНрд░реБрдЯрд┐ рдХреЛ рдХреИрд╢ рдХрд░рддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдХреИрд╢-рдХрдВрдЯреНрд░реЛрд▓ рд╣реЗрдбрд░ рдореМрдЬреВрдж рди рд╣реЛред

![](<../.gitbook/assets/image (163).png>)

рдПрдХ рдЕрд╡реИрдз рд╡рд░реНрдг, `\` рд╡рд╛рд▓рд╛ рд╣реЗрдбрд░ рднреЗрдЬрдиреЗ рд╕реЗ рдПрдХ рдХреИрд╢реЗрдмрд▓ 400 рдмреИрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рддреНрд░реБрдЯрд┐ рд╣реЛрдЧреАред рдпрд╣ рдореЗрд░реЗ рдкрд░реАрдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди рд╕рдмрд╕реЗ рдЖрдо рд░реВрдк рд╕реЗ рдкрд╣рдЪрд╛рдиреЗ рдЧрдП рдкреИрдЯрд░реНрдиреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдерд╛ред

### рдирдП рд╣реЗрдбрд░реНрд╕ рдХреА рдЦреЛрдЬ

[https://gist.github.com/iustin24/92a5ba76ee436c85716f003dda8eecc6](https://gist.github.com/iustin24/92a5ba76ee436c85716f003dda8eecc6)

## рдХреИрд╢ рдбрд┐рд╕реЗрдкреНрд╢рди

рдХреИрд╢ рдбрд┐рд╕реЗрдкреНрд╢рди рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ **рдРрд╕реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдирд╛ рд╣реИ рдЬреЛ рдХреИрд╢ рджреНрд╡рд╛рд░рд╛ рдЙрдирдХреА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рд╕рд╣реЗрдЬреЗ рдЬрд╛рдПрдВрдЧреЗ**ред

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ `.css`, `.js`, `.png` рдЖрджрд┐ рдЬреИрд╕реЗ **рдПрдХ
