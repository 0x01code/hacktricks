<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ企業**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**最新バージョンのPEASSにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)にPRを提出してください。**

</details>


# 説明

**攻撃者**が被害者によってクリックされる予定の**`<a`**タグの**`href`**引数を**制御**できる状況で、その**`<a`**タグには**`target="_blank" rel="opener"`**属性が付いています。この場合、**攻撃者**はこの**リンク**を自分の制御下にあるウェブ（**悪意のあるウェブサイト**）に向けます。そして、被害者がリンクをクリックして攻撃者のウェブサイトにアクセスすると、この**悪意のあるウェブサイト**は**`window.opener`**というJavaScriptオブジェクトを介して**元のページ**を**制御**することができます。\
もしページに**`rel="opener"`**がなく、**`target="_blank"`**があり、**`rel="noopener"`**もない場合、それも脆弱性の可能性があります。

この挙動を悪用する一般的な方法は、`window.opener.location = https://attacker.com/victim.html`というコードを使用して、元のウェブの場所を攻撃者が制御するウェブに変更することです。この攻撃者が制御するウェブは、元のウェブサイトの**ログインフォーム**を**模倣**し、ユーザーに資格情報を要求することができます。

ただし、攻撃者が今や元のウェブサイトのウィンドウオブジェクトを制御できるようになったため、他の方法でも悪用することができ、よりステルス性の高い攻撃を行うことができます（たとえば、JavaScriptイベントを変更して情報を彼が制御するサーバーに外部流出させるなど）。

# 概要

## バックリンクあり

予防属性が使用されていない場合の親ページと子ページの間のリンク：

![](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## バックリンクなし

予防属性が使用されている場合の親ページと子ページの間のリンク：

![](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## 例 <a href="#examples" id="examples"></a>

以下のページをフォルダに作成し、`python3 -m http.server`でウェブサーバーを実行します。\
その後、`http://127.0.0.1:8000/`vulnerable.htmlにアクセスし、リンクをクリックして元のウェブサイトのURLがどのように変化するかを確認してください。

{% code title="vulnerable.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% code title="malicious.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<script>
window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
</script>
</body>
</html>
```
{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
{% endcode %}

## アクセス可能なプロパティ <a href="#accessible-properties" id="accessible-properties"></a>

悪意のあるサイトは、**クロスオリジン**（クロスドメイン）アクセスの場合、以下のプロパティにのみアクセスできます。これらは、**opener** JavaScriptオブジェクト参照（実際には**window** JavaScriptクラスのインスタンスへの参照）から取得できます。

* `opener.closed`：ウィンドウが閉じられたかどうかを示すブール値を返します。
* `opener.frames`：現在のウィンドウ内のすべてのiframe要素を返します。
* `opener.length`：現在のウィンドウ内のiframe要素の数を返します。
* `opener.opener`：ウィンドウを作成したウィンドウへの参照を返します。
* `opener.parent`：現在のウィンドウの親ウィンドウを返します。
* `opener.self`：現在のウィンドウを返します。
* `opener.top`：最上位のブラウザウィンドウを返します。

ドメインが同じ場合、悪意のあるサイトは[**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window) JavaScriptオブジェクト参照によって公開されるすべてのプロパティにアクセスできます。

# 予防策

予防策については、[HTML5チートシート](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing)に文書化されています。

# 参考文献

{% embed url="https://owasp.org/www-community/attacks/Reverse_Tabnabbing" %}




<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ企業**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**PEASSの最新バージョンを入手したり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見しましょう。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**をフォロー**しましょう。

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>
