# OAuth –¥–ª—è –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è <a href="#d4a8" id="d4a8"></a>

OAuth –ø—Ä–æ–ø–æ–Ω—É—î —Ä—ñ–∑–Ω—ñ –≤–µ—Ä—Å—ñ—ó, –∑ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∏–º–∏ –≤—ñ–¥–æ–º–æ—Å—Ç—è–º–∏, –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ –Ω–∞ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó OAuth 2.0](https://oauth.net/2/). –¶—è –¥–∏—Å–∫—É—Å—ñ—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∑–æ—Å–µ—Ä–µ–¥–∂–µ–Ω–∞ –Ω–∞ —à–∏—Ä–æ–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–æ–º—É [OAuth 2.0 —Ç–∏–ø—ñ –Ω–∞–¥–∞–Ω–Ω—è –∫–æ–¥—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó](https://oauth.net/2/grant-types/authorization-code/), –Ω–∞–¥–∞—é—á–∏ **—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –¥–æ–¥–∞—Ç–∫—É –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –∞–±–æ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥—ñ—ó –≤ –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —ñ–Ω—à–æ–º—É –¥–æ–¥–∞—Ç–∫—É** (—Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó).

–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, —â–æ —ñ—Å–Ω—É—î –≥—ñ–ø–æ—Ç–µ—Ç–∏—á–Ω–∏–π –≤–µ–±-—Å–∞–π—Ç _**https://example.com**_, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π **–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó –≤—Å—ñ—Ö –≤–∞—à–∏—Ö –ø–æ—Å—Ç—ñ–≤ —É —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂–∞—Ö**, –≤–∫–ª—é—á–∞—é—á–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ñ. –î–ª—è –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è OAuth 2.0. _https://example.com_ –±—É–¥–µ –∑–∞–ø–∏—Ç—É–≤–∞—Ç–∏ –≤–∞—à—É –∑–≥–æ–¥—É –Ω–∞ **–¥–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–∏—Ö –ø–æ—Å—Ç—ñ–≤ —É —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂–∞—Ö**. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –Ω–∞ _https://socialmedia.com_ –∑'—è–≤–∏—Ç—å—Å—è –µ–∫—Ä–∞–Ω –∑–≥–æ–¥–∏, –¥–µ –±—É–¥—É—Ç—å –≤–∫–∞–∑–∞–Ω—ñ **–¥–æ–∑–≤–æ–ª–∏, —è–∫—ñ –∑–∞–ø–∏—Ç—É—é—Ç—å—Å—è, —Ç–∞ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫, —è–∫–∏–π —Ä–æ–±–∏—Ç—å –∑–∞–ø–∏—Ç**. –ü—ñ—Å–ª—è –≤–∞—à–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó _https://example.com_ –æ—Ç—Ä–∏–º—É—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–¥–æ—Å—Ç—É–ø—É –¥–æ –≤–∞—à–∏—Ö –ø–æ—Å—Ç—ñ–≤ –≤—ñ–¥ –≤–∞—à–æ–≥–æ —ñ–º–µ–Ω—ñ**.

–í–∞–∂–ª–∏–≤–æ —Ä–æ–∑—É–º—ñ—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≤ —Ä–∞–º–∫–∞—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É OAuth 2.0:

- **–≤–ª–∞—Å–Ω–∏–∫ —Ä–µ—Å—É—Ä—Å—É**: –í–∏, —è–∫ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á/—Å—É—Ç–Ω—ñ—Å—Ç—å**, –∞–≤—Ç–æ—Ä–∏–∑—É—î—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ —Å–≤–æ–≥–æ —Ä–µ—Å—É—Ä—Å—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ –ø–æ—Å—Ç—ñ–≤ —É –≤–∞—à–æ–º—É –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ —É —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂–∞—Ö.
- **—Å–µ—Ä–≤–µ—Ä —Ä–µ—Å—É—Ä—Å—ñ–≤**: **–°–µ—Ä–≤–µ—Ä, —â–æ –∫–µ—Ä—É—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º–∏ –∑–∞–ø–∏—Ç–∞–º–∏** –ø—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –¥–æ–¥–∞—Ç–æ–∫ –æ—Ç—Ä–∏–º–∞–≤ `—Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø—É` –≤—ñ–¥ `–≤–ª–∞—Å–Ω–∏–∫–∞ —Ä–µ—Å—É—Ä—Å—É`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **https://socialmedia.com**.
- **–∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π –¥–æ–¥–∞—Ç–æ–∫**: **–î–æ–¥–∞—Ç–æ–∫, —è–∫–∏–π —à—É–∫–∞—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é** –≤—ñ–¥ `–≤–ª–∞—Å–Ω–∏–∫–∞ —Ä–µ—Å—É—Ä—Å—É`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ **https://example.com**.
- **—Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**: **–°–µ—Ä–≤–µ—Ä, —è–∫–∏–π –≤–∏–¥–∞–≤–∞—Ç–∏–º–µ `—Ç–æ–∫–µ–Ω–∏ –¥–æ—Å—Ç—É–ø—É`** –¥–ª—è `–∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É` –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó `–≤–ª–∞—Å–Ω–∏–∫–∞ —Ä–µ—Å—É—Ä—Å—É` —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **https://socialmedia.com**.
- **client\_id**: –ü—É–±–ª—ñ—á–Ω–∏–π, —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –¥–æ–¥–∞—Ç–∫—É.
- **client\_secret:** –ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω–∏–π –∫–ª—é—á, –≤—ñ–¥–æ–º–∏–π –ª–∏—à–µ –¥–æ–¥–∞—Ç–∫—É —Ç–∞ —Å–µ—Ä–≤–µ—Ä—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó `—Ç–æ–∫–µ–Ω—ñ–≤ –¥–æ—Å—Ç—É–ø—É`.
- **response\_type**: –ó–Ω–∞—á–µ–Ω–Ω—è, —â–æ –≤–∫–∞–∑—É—î **—Ç–∏–ø –∑–∞–ø–∏—Ç–∞–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `–∫–æ–¥`.
- **scope**: **–†—ñ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø—É**, —è–∫–∏–π `–∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π –¥–æ–¥–∞—Ç–æ–∫` –∑–∞–ø–∏—Ç—É—î –≤—ñ–¥ `–≤–ª–∞—Å–Ω–∏–∫–∞ —Ä–µ—Å—É—Ä—Å—É`.
- **redirect\_uri**: **URL, –Ω–∞ —è–∫–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±—É–¥–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø—ñ—Å–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**. –ó–∞–∑–≤–∏—á–∞–π —Ü–µ –ø–æ–≤–∏–Ω–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ–º—É URL –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è.
- **state**: –ü–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è **–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—ñ–¥ —á–∞—Å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ —Ç–∞ –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**. –ô–æ–≥–æ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å —î –∫—Ä–∏—Ç–∏—á–Ω–æ—é –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —è–∫ **–º–µ—Ö–∞–Ω—ñ–∑–º –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ CSRF**.
- **grant\_type**: –ü–∞—Ä–∞–º–µ—Ç—Ä, —â–æ –≤–∫–∞–∑—É—î **—Ç–∏–ø –Ω–∞–¥–∞–Ω–Ω—è —Ç–∞ —Ç–∏–ø —Ç–æ–∫–µ–Ω–∞, —è–∫–∏–π –ø–æ–≤–µ—Ä–Ω–µ—Ç—å—Å—è**.
- **code**: –ö–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –≤—ñ–¥ `—Å–µ—Ä–≤–µ—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó`, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ä–∞–∑–æ–º –∑ `client_id` —Ç–∞ `client_secret` –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–º –¥–æ–¥–∞—Ç–∫–æ–º –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è `—Ç–æ–∫–µ–Ω–∞ –¥–æ—Å—Ç—É–ø—É`.
- **access\_token**: **–¢–æ–∫–µ–Ω, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π –¥–æ–¥–∞—Ç–æ–∫ –¥–ª—è –∑–∞–ø–∏—Ç—ñ–≤ API** –≤—ñ–¥ —ñ–º–µ–Ω—ñ `–≤–ª–∞—Å–Ω–∏–∫–∞ —Ä–µ—Å—É—Ä—Å—É`.
- **refresh\_token**: –î–æ–∑–≤–æ–ª—è—î –¥–æ–¥–∞—Ç–∫—É **–æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–æ–≤–∏–π `—Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø—É` –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**.

### –ü–æ—Ç—ñ–∫

**–§–∞–∫—Ç–∏—á–Ω–∏–π –ø–æ—Ç—ñ–∫ OAuth** –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:

1. –í–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –Ω–∞ [https://example.com](https://example.com) —Ç–∞ –≤–∏–±–∏—Ä–∞—î—Ç–µ –∫–Ω–æ–ø–∫—É "–Ü–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏—Å—è –∑ —Å–æ—Ü—ñ–∞–ª—å–Ω–∏–º–∏ –º–µ—Ä–µ–∂–∞–º–∏".
2. –°–∞–π—Ç –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ [https://socialmedia.com](https://socialmedia.com), –∑–∞–ø–∏—Ç—É—é—á–∏ –≤–∞—à—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –¥–ª—è –¥–æ–∑–≤–æ–ª—É –¥–æ–¥–∞—Ç–∫—É https://example.com –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–∏—Ö –ø–æ—Å—Ç—ñ–≤. –ó–∞–ø–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π —Ç–∞–∫:
```
https://socialmedia.com/auth
?response_type=code
&client_id=example_clientId
&redirect_uri=https%3A%2F%2Fexample.com%2Fcallback
&scope=readPosts
&state=randomString123
```
3. –ü–æ—Ç—ñ–º –≤–∞–º –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –∑–≥–æ–¥–∏.

4. –ü—ñ—Å–ª—è –≤–∞—à–æ–≥–æ —Å—Ö–≤–∞–ª–µ–Ω–Ω—è, —Å–æ—Ü—ñ–∞–ª—å–Ω—ñ –º–µ—Ä–µ–∂—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ `redirect_uri` –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ `code` —Ç–∞ `state`:
```
https://example.com?code=uniqueCode123&state=randomString123
```
5. https://example.com –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ü–µ–π `code`, —Ä–∞–∑–æ–º –∑ –π–æ–≥–æ `client_id` —Ç–∞ `client_secret`, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è `access_token` –≤—ñ–¥ –≤–∞—à–æ–≥–æ —ñ–º–µ–Ω—ñ, —â–æ –¥–æ–∑–≤–æ–ª—è—î –¥–æ—Å—Ç—É–ø –¥–æ –¥–æ–∑–≤–æ–ª—ñ–≤, –Ω–∞ —è–∫—ñ –≤–∏ –¥–∞–ª–∏ –∑–≥–æ–¥—É:
```
POST /oauth/access_token
Host: socialmedia.com
...{"client_id": "example_clientId", "client_secret": "example_clientSecret", "code": "uniqueCode123", "grant_type": "authorization_code"}
```
6. –ù–∞—Ä–µ—à—Ç—ñ, –ø—Ä–æ—Ü–µ—Å –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è, –æ—Å–∫—ñ–ª—å–∫–∏ https://example.com –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–∞—à `access_token` –¥–ª—è –∑–¥—ñ–π—Å–Ω–µ–Ω–Ω—è –≤–∏–∫–ª–∏–∫—É API –¥–æ —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂ –¥–ª—è –¥–æ—Å—Ç—É–ø—É

## –í—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ <a href="#323a" id="323a"></a>

### –í—ñ–¥–∫—Ä–∏—Ç–∏–π redirect\_uri <a href="#cc36" id="cc36"></a>

`redirect_uri` —î –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è –±–µ–∑–ø–µ–∫–∏ –≤ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è—Ö OAuth —Ç–∞ OpenID, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –≤–∫–∞–∑—É—î, –∫—É–¥–∏ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ, —Ç–∞–∫—ñ —è–∫ –∫–æ–¥–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, –ø—ñ—Å–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó. –Ø–∫—â–æ –≤—ñ–Ω –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, —Ü–µ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç–∏ —Ü—ñ –∑–∞–ø–∏—Ç–∏ –Ω–∞ –∑–ª–æ–≤—ñ—Å–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É.

–¢–µ—Ö–Ω—ñ–∫–∏ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤–∞—Ä—ñ—é—é—Ç—å—Å—è –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –ª–æ–≥—ñ–∫–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ–π–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—ñ–¥ —Å—Ç—Ä–æ–≥–æ–≥–æ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —à–ª—è—Ö—ñ–≤ –¥–æ –ø—Ä–∏–π–Ω—è—Ç—Ç—è –±—É–¥—å-—è–∫–æ–≥–æ URL –≤ –º–µ–∂–∞—Ö –≤–∫–∞–∑–∞–Ω–æ–≥–æ –¥–æ–º–µ–Ω—É –∞–±–æ –ø—ñ–¥–∫–∞—Ç–∞–ª–æ–≥—É. –°–µ—Ä–µ–¥ –∑–∞–≥–∞–ª—å–Ω–∏—Ö –º–µ—Ç–æ–¥—ñ–≤ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –º–æ–∂–Ω–∞ –≤–∏–¥—ñ–ª–∏—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç—ñ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è, –æ–±—Ö—ñ–¥ —à–ª—è—Ö—ñ–≤, –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—é —Å–ª–∞–±–∫–∏—Ö —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤ —Ç–∞ HTML-—ñ–Ω'—î–∫—Ü—ñ—é –¥–ª—è –∫—Ä–∞–¥—ñ–∂–∫–∏ —Ç–æ–∫–µ–Ω—ñ–≤.

–ö—Ä—ñ–º `redirect_uri`, —ñ–Ω—à—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ OAuth —Ç–∞ OpenID, —Ç–∞–∫—ñ —è–∫ `client_uri`, `policy_uri`, `tos_uri` —Ç–∞ `initiate_login_uri`, —Ç–∞–∫–æ–∂ –ø—ñ–¥–¥–∞—é—Ç—å—Å—è –∞—Ç–∞–∫–∞–º –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è. –¶—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —î –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º–∏, —ñ —ó—Ö –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤–∞—Ä—ñ—é—î—Ç—å—Å—è –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ —Å–µ—Ä–≤–µ—Ä–∞.

–î–ª—è —Ç–∏—Ö, —Ö—Ç–æ –∞—Ç–∞–∫—É—î —Å–µ—Ä–≤–µ—Ä OpenID, —Ç–æ—á–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è (`**.well-known/openid-configuration**`) —á–∞—Å—Ç–æ –º—ñ—Å—Ç–∏—Ç—å —Ü—ñ–Ω–Ω—ñ –¥–µ—Ç–∞–ª—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ `registration_endpoint`, `request_uri_parameter_supported` —Ç–∞ "`require_request_uri_registration`. –¶—ñ –¥–µ—Ç–∞–ª—ñ –º–æ–∂—É—Ç—å –¥–æ–ø–æ–º–æ–≥—Ç–∏ –≤ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–æ—á–∫–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —Ç–∞ —ñ–Ω—à–∏—Ö –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Å–µ—Ä–≤–µ—Ä–∞.

### XSS —É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è <a href="#bda5" id="bda5"></a>

–Ø–∫ –∑–∞–∑–Ω–∞—á–µ–Ω–æ –≤ —Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ –ø—Ä–æ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥—É –∑–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫ [https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html](https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html), –º–æ–∂–ª–∏–≤–æ, —â–æ **URL –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ** —Å–µ—Ä–≤–µ—Ä–∞ –ø—ñ—Å–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —â–æ **–ø—ñ–¥–¥–∞—î—Ç—å—Å—è XSS**. –ú–æ–∂–ª–∏–≤–∏–π –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
```
https://app.victim.com/login?redirectUrl=https://app.victim.com/dashboard</script><h1>test</h1>
```
### CSRF - –ù–µ–Ω–∞–ª–µ–∂–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Å—Ç–∞–Ω—É <a href="#bda5" id="bda5"></a>

–ü—Ä–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó OAuth, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∞–±–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ **`state`** –º–æ–∂–µ –∑–Ω–∞—á–Ω–æ –∑–±—ñ–ª—å—à–∏—Ç–∏ —Ä–∏–∑–∏–∫ –∞—Ç–∞–∫–∏ **Cross-Site Request Forgery (CSRF)**. –¶—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `state` –∞–±–æ **–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ —Å—Ç–∞—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∞–±–æ –Ω–µ –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è**, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –æ–±—ñ–π—Ç–∏ –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ CSRF.

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ, –ø–µ—Ä–µ—Ö–æ–ø–ª—é—é—á–∏ –ø—Ä–æ—Ü–µ—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, —â–æ–± –∑–≤'—è–∑–∞—Ç–∏ —Å–≤—ñ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∑ –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º –∂–µ—Ä—Ç–≤–∏, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ–≥–æ **–∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É**. –¶–µ –æ—Å–æ–±–ª–∏–≤–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –≤ –¥–æ–¥–∞—Ç–∫–∞—Ö, –¥–µ OAuth –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è **–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**.

–†–µ–∞–ª—å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –±—É–ª–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ –≤ —Ä—ñ–∑–Ω–∏—Ö **CTF –≤–∏–∫–ª–∏–∫–∞—Ö** —Ç–∞ **–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö –¥–ª—è —Ö–∞–∫—ñ–Ω–≥—É**, –ø—ñ–¥–∫—Ä–µ—Å–ª—é—é—á–∏ —ó—ó –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏. –ü—Ä–æ–±–ª–µ–º–∞ —Ç–∞–∫–æ–∂ –ø–æ—à–∏—Ä—é—î—Ç—å—Å—è –Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ –ø–æ—Å–ª—É–≥–∞–º–∏ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤, —Ç–∞–∫–∏–º–∏ —è–∫ **Slack**, **Stripe** —Ç–∞ **PayPal**, –¥–µ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∞–±–æ –ø–ª–∞—Ç–µ–∂—ñ –Ω–∞ —Å–≤–æ—ó –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏.

–ù–∞–ª–µ–∂–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ **`state`** —î –≤–∞–∂–ª–∏–≤–∏–º–∏ –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ CSRF —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ –ø–æ—Ç–æ–∫—É OAuth.

### –ü–µ—Ä–µ–¥ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è–º –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É <a href="#ebe4" id="ebe4"></a>

1. **–ë–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É**: –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –ø–µ—Ä–µ–¥—á–∞—Å–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –∂–µ—Ä—Ç–≤–∏. –Ø–∫—â–æ –ø–æ—Ç—ñ–º –∂–µ—Ä—Ç–≤–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–æ—Ä–æ–Ω–Ω—é —Å–ª—É–∂–±—É –¥–ª—è –≤—Ö–æ–¥—É, –¥–æ–¥–∞—Ç–æ–∫ –º–æ–∂–µ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –∑–≤'—è–∑–∞—Ç–∏ —Ü–µ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —Å—Ç–æ—Ä–æ–Ω–Ω—å–æ–≥–æ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ —Å—Ç–≤–æ—Ä–µ–Ω–∏–º –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É.

2. **–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è —Å–ª–∞–±–∫–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ OAuth**: –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ —Å–ª—É–∂–±–∏ OAuth, —è–∫—ñ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É, —Ä–µ—î—Å—Ç—Ä—É—é—á–∏—Å—å —É —ó—Ö —Å–ª—É–∂–±—ñ, –∞ –ø–æ—Ç—ñ–º –∑–º—ñ–Ω—é—é—á–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –∞–¥—Ä–µ—Å—É –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –Ω–∞ –∂–µ—Ä—Ç–≤–∏–Ω—É. –¶–µ–π –º–µ—Ç–æ–¥ —Ç–∞–∫–æ–∂ —Å—Ç–≤–æ—Ä—é—î —Ä–∏–∑–∏–∫ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É, —Å—Ö–æ–∂–∏–π –Ω–∞ –ø–µ—Ä—à–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π, –∞–ª–µ —á–µ—Ä–µ–∑ —ñ–Ω—à–∏–π –≤–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏.

### –†–æ–∑–∫—Ä–∏—Ç—Ç—è —Å–µ–∫—Ä–µ—Ç—ñ–≤ <a href="#e177" id="e177"></a>

–í–∏—è–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞—Ö–∏—Å—Ç —Å–µ–∫—Ä–µ—Ç–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ OAuth —î –≤–∞–∂–ª–∏–≤–∏–º. –•–æ—á–∞ **`client_id`** –º–æ–∂–Ω–∞ –±–µ–∑–ø–µ—á–Ω–æ —Ä–æ–∑–∫—Ä–∏—Ç–∏, —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è **`client_secret`** —Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–Ω–∏–π —Ä–∏–∑–∏–∫. –Ø–∫—â–æ `client_secret` —Å—Ç–∞—î –≤—ñ–¥–æ–º–∏–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º, –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å —Ç–∞ –¥–æ–≤—ñ—Ä—É –¥–æ–¥–∞—Ç–∫–∞ –¥–ª—è **–≤–∏–∫—Ä–∞–¥–µ–Ω–Ω—è `access_tokens`** —Ç–∞ –æ—Å–æ–±–∏—Å—Ç–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

–ß–∞—Å—Ç–æ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –¥–æ–¥–∞—Ç–∫–∏ –ø–æ–º–∏–ª–∫–æ–≤–æ –æ–±—Ä–æ–±–ª—è—é—Ç—å –æ–±–º—ñ–Ω –∫–æ–¥—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –Ω–∞ `access_token` –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞, –∞ –Ω–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞. –¶—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è `client_secret`, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ `access_tokens` –≤—ñ–¥ —ñ–º–µ–Ω—ñ –¥–æ–¥–∞—Ç–∫–∞. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —á–µ—Ä–µ–∑ —Å–æ—Ü—ñ–∞–ª—å–Ω–∏–π —ñ–Ω–∂–µ–Ω–µ—Ä—ñ–Ω–≥ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –ø—ñ–¥–≤–∏—â–∏—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó, –¥–æ–¥–∞–≤—à–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –æ–±—Å—è–≥–∏ –¥–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó OAuth, –ø–æ–¥–∞–ª—å—à–µ –µ–∫—Å–ø–ª—É–∞—Ç—É—é—á–∏ –¥–æ–≤—ñ—Ä—É –¥–æ–¥–∞—Ç–∫–∞. 

### –ü–µ—Ä–µ–±—ñ—Ä —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞

–í–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–ø–µ—Ä–µ–±—Ä–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç –∫–ª—ñ—î–Ω—Ç–∞** –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ –ø–æ—Å–ª—É–≥ –∑ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–æ–º —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∫—Ä–∞—Å—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏.\
–ó–∞–ø–∏—Ç –¥–æ BF –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –ø–æ–¥—ñ–±–Ω–æ:
```
POST /token HTTP/1.1
content-type: application/x-www-form-urlencoded
host: 10.10.10.10:3000
content-length: 135
Connection: close

code=77515&redirect_uri=http%3A%2F%2F10.10.10.10%3A3000%2Fcallback&grant_type=authorization_code&client_id=public_client_id&client_secret=[bruteforce]
```
### –í–∏—Ç—ñ–∫ –∑–∞–≥–æ–ª–æ–≤–∫–∞ Referer –∑ –∫–æ–¥–æ–º + State

–ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –∫–ª—ñ—î–Ω—Ç –æ—Ç—Ä–∏–º–∞–≤ **–∫–æ–¥ —ñ State**, —è–∫—â–æ –≤–æ–Ω–∏ **–≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫—É Referer** –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥—ñ –Ω–∞ —ñ–Ω—à—É —Å—Ç–æ—Ä—ñ–Ω–∫—É, —Ç–æ —Ü–µ —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å.

### –¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø—É –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –≤ —ñ—Å—Ç–æ—Ä—ñ—ó –±—Ä–∞—É–∑–µ—Ä–∞

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **—ñ—Å—Ç–æ—Ä—ñ—ó –±—Ä–∞—É–∑–µ—Ä–∞ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π —Ç–∞–º —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø—É**.

### –í—ñ—á–Ω–∏–π –∫–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó

**–ö–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –ø–æ–≤–∏–Ω–µ–Ω —ñ—Å–Ω—É–≤–∞—Ç–∏ –ª–∏—à–µ –ø—Ä–æ—Ç—è–≥–æ–º –ø–µ–≤–Ω–æ–≥–æ —á–∞—Å—É, —â–æ–± –æ–±–º–µ–∂–∏—Ç–∏ –≤—ñ–∫–Ω–æ —á–∞—Å—É, –ø—Ä–æ—Ç—è–≥–æ–º —è–∫–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –π–æ–≥–æ –≤–∫—Ä–∞—Å—Ç–∏ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏**.

### –ö–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó/–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ –∫–ª—ñ—î–Ω—Ç–æ–º

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ **–∫–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –∑ —ñ–Ω—à–∏–º –∫–ª—ñ—î–Ω—Ç–æ–º, —Ç–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–æ–ª–æ–¥—ñ—Ç–∏ —ñ–Ω—à–∏–º–∏ –æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –∑–∞–ø–∏—Å–∞–º–∏**.

### –©–∞—Å–ª–∏–≤—ñ —à–ª—è—Ö–∏, XSS, Iframes —Ç–∞ Post Messages –¥–ª—è –≤–∏—Ç–æ–∫—É –∫–æ–¥—É —Ç–∞ –∑–Ω–∞—á–µ–Ω—å State

**[–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ–π –ø–æ—Å—Ç](https://labs.detectify.com/writeups/account-hijacking-using-dirty-dancing-in-sign-in-oauth-flows/#gadget-2-xss-on-sandbox-third-party-domain-that-gets-the-url)**

### AWS Cognito <a href="#bda5" id="bda5"></a>

–£ —Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ –ø—Ä–æ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥—É –∑–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫: [**https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/**](https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/) –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ **—Ç–æ–∫–µ–Ω**, —è–∫–∏–π **AWS Cognito** –ø–æ–≤–µ—Ä—Ç–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ, –º–æ–∂–µ –º–∞—Ç–∏ **–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–æ–∑–≤–æ–ª—ñ–≤ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**. –¢–æ–º—É, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–º—ñ–Ω–∏—Ç–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –∞–¥—Ä–µ—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ —ñ–Ω—à—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –∞–¥—Ä–µ—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–∞—Ö–æ–ø–∏—Ç–∏** —ñ–Ω—à—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏.
```bash
# Read info of the user
aws cognito-idp get-user --region us-east-1 --access-token eyJraWQiOiJPVj[...]

# Change email address
aws cognito-idp update-user-attributes --region us-east-1 --access-token eyJraWQ[...] --user-attributes Name=email,Value=imaginary@flickr.com
{
"CodeDeliveryDetailsList": [
{
"Destination": "i***@f***.com",
"DeliveryMedium": "EMAIL",
"AttributeName": "email"
}
]
}
```
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–∫–ª–∞–¥–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ç–µ, —è–∫ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ AWS Cognito –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

{% embed url="https://cloud.hacktricks.xyz/pentesting-cloud/aws-pentesting/aws-unauthenticated-enum-access/aws-cognito-unauthenticated-enum" %}

### –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞–º–∏ —ñ–Ω—à–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤ <a href="#bda5" id="bda5"></a>

–Ø–∫ [**–∑–∞–∑–Ω–∞—á–µ–Ω–æ –≤ —Ü—å–æ–º—É –æ–ø–∏—Å—ñ**](https://salt.security/blog/oh-auth-abusing-oauth-to-take-over-millions-of-accounts), –ø–æ—Ç–æ–∫–∏ OAuth, —è–∫—ñ –æ—á—ñ–∫—É—é—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ **—Ç–æ–∫–µ–Ω** (–∞ –Ω–µ –∫–æ–¥), –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏, —è–∫—â–æ –≤–æ–Ω–∏ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å, —á–∏ –Ω–∞–ª–µ–∂–∏—Ç—å —Ç–æ–∫–µ–Ω –¥–æ–¥–∞—Ç–∫—É.

–¶–µ —Ç–æ–º—É, —â–æ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫** –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **–¥–æ–¥–∞—Ç–æ–∫, —è–∫–∏–π –ø—ñ–¥—Ç—Ä–∏–º—É—î OAuth —Ç–∞ –≤–≤—ñ–π—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Facebook** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥) —É —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫. –ü–æ—Ç—ñ–º, –∫–æ–ª–∏ –∂–µ—Ä—Ç–≤–∞ —É–≤—ñ–π–¥–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Facebook —É **–¥–æ–¥–∞—Ç–æ–∫ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ **OAuth —Ç–æ–∫–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –Ω–∞–¥–∞–Ω–∏–π –π–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É, —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –≤—Ö–æ–¥—É –≤ –¥–æ–¥–∞—Ç–æ–∫ OAuth –∂–µ—Ä—Ç–≤–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç–æ–∫–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∂–µ—Ä—Ç–≤–∏**.

{% hint style="danger" %}
–û—Ç–∂–µ, —è–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ –¥–æ–º–æ–≥—Ç–∏—Å—è —Ç–æ–≥–æ, —â–æ–± –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —É–≤—ñ–π—à–æ–≤ —É –π–æ–≥–æ –≤–ª–∞—Å–Ω–∏–π –¥–æ–¥–∞—Ç–æ–∫ OAuth, –≤—ñ–Ω –∑–º–æ–∂–µ –∑–∞–≤–æ–ª–æ–¥—ñ—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º –∂–µ—Ä—Ç–≤–∏ –≤ –¥–æ–¥–∞—Ç–∫–∞—Ö, —è–∫—ñ –æ—á—ñ–∫—É—é—Ç—å —Ç–æ–∫–µ–Ω —ñ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å, —á–∏ –±—É–≤ —Ç–æ–∫–µ–Ω –Ω–∞–¥–∞–Ω–∏–π —ó—Ö–Ω—å–æ–º—É —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—É –¥–æ–¥–∞—Ç–∫—É.
{% endhint %}

### –î–≤–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è —Ç–∞ cookie <a href="#bda5" id="bda5"></a>

–ó–≥—ñ–¥–Ω–æ –∑ [**—Ü–∏–º –æ–ø–∏—Å–æ–º**](https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f), –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ –∑–º—É—Å–∏—Ç–∏ –∂–µ—Ä—Ç–≤—É –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É –∑ **returnUrl**, —è–∫–∞ –≤–∫–∞–∑—É—î –Ω–∞ —Ö–æ—Å—Ç –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞. –¶—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –±—É–¥–µ **–∑–±–µ—Ä–µ–∂–µ–Ω–∞ –≤ cookie (RU)** —ñ –Ω–∞ **–ø–æ–¥–∞–ª—å—à–æ–º—É –µ—Ç–∞–ø—ñ** **prompt** –∑–∞–ø–∏—Ç–∞—î **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, —á–∏ –≤—ñ–Ω —Ö–æ—á–µ –Ω–∞–¥–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ü—å–æ–≥–æ —Ö–æ—Å—Ç–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É.

–î–ª—è –æ–±—Ö—ñ–¥—É —Ü—å–æ–≥–æ prompt, –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –≤–∫–ª–∞–¥–∫—É –¥–ª—è —ñ–Ω—ñ—Ü—ñ—é–≤–∞–Ω–Ω—è **–ø–æ—Ç–æ–∫—É OAuth**, —è–∫–∏–π –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ RU cookie, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **returnUrl**, –∑–∞–∫—Ä–∏—Ç–∏ –≤–∫–ª–∞–¥–∫—É –¥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è prompt —ñ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –Ω–æ–≤—É –≤–∫–ª–∞–¥–∫—É –±–µ–∑ —Ü—å–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è. –¢–æ–¥—ñ **prompt –Ω–µ –ø–æ–≤—ñ–¥–æ–º–∏—Ç—å –ø—Ä–æ —Ö–æ—Å—Ç –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞**, –∞–ª–µ cookie –±—É–¥–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ –Ω—å–æ–≥–æ, —Ç–æ–º—É **—Ç–æ–∫–µ–Ω –±—É–¥–µ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ —Ö–æ—Å—Ç –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞** —É –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ñ.

### –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ SSRF <a href="#bda5" id="bda5"></a>

**[–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è](https://portswigger.net/research/hidden-oauth-attack-vectors) –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –≤—ñ–¥–æ–º–æ—Å—Ç–µ–π –ø—Ä–æ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É.**
