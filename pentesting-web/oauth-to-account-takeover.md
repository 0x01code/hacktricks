# OAuth to Account takeover

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –±–∞—á–∏—Ç–∏ —Å–≤–æ—é **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω–æ—é –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFTs**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ —É **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—ñ—Å–ª–∞–≤—à–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Basic Information <a href="#d4a8" id="d4a8"></a>

OAuth –ø—Ä–æ–ø–æ–Ω—É—î —Ä—ñ–∑–Ω—ñ –≤–µ—Ä—Å—ñ—ó, –∑ –æ—Å–Ω–æ–≤–Ω–∏–º–∏ —ñ–Ω—Å–∞–π—Ç–∞–º–∏, –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ –Ω–∞ [OAuth 2.0 –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è](https://oauth.net/2/). –¶–µ –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∑–æ—Å–µ—Ä–µ–¥–∂–µ–Ω–æ –Ω–∞ —à–∏—Ä–æ–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–æ–º—É [OAuth 2.0 authorization code grant type](https://oauth.net/2/grant-types/authorization-code/), —â–æ –Ω–∞–¥–∞—î **—Ä–∞–º–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –¥–æ–¥–∞—Ç–∫—É –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –∞–±–æ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥—ñ—ó –≤ –æ–±–ª—ñ–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Å—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —ñ–Ω—à–æ–º—É –¥–æ–¥–∞—Ç–∫—É** (—Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó).

–†–æ–∑–≥–ª—è–Ω–µ–º–æ –≥—ñ–ø–æ—Ç–µ—Ç–∏—á–Ω–∏–π –≤–µ–±—Å–∞–π—Ç _**https://example.com**_, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è **–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó –≤—Å—ñ—Ö –≤–∞—à–∏—Ö –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π —É —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂–∞—Ö**, –≤–∫–ª—é—á–∞—é—á–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ñ. –î–ª—è –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è OAuth 2.0. _https://example.com_ –∑–∞–ø–∏—Ç—É–≤–∞—Ç–∏–º–µ –≤–∞—à –¥–æ–∑–≤—ñ–ª –Ω–∞ **–¥–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–∏—Ö –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π —É —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂–∞—Ö**. –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ, –Ω–∞ _https://socialmedia.com_ –∑'—è–≤–∏—Ç—å—Å—è –µ–∫—Ä–∞–Ω –∑–≥–æ–¥–∏, –¥–µ –±—É–¥–µ –∑–∞–∑–Ω–∞—á–µ–Ω–æ **–¥–æ–∑–≤–æ–ª–∏, —è–∫—ñ –∑–∞–ø–∏—Ç—É—é—Ç—å—Å—è, —Ç–∞ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫, —è–∫–∏–π —Ä–æ–±–∏—Ç—å –∑–∞–ø–∏—Ç**. –ü—ñ—Å–ª—è –≤–∞—à–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó _https://example.com_ –æ—Ç—Ä–∏–º–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–¥–æ—Å—Ç—É–ø—É –¥–æ –≤–∞—à–∏—Ö –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π –≤—ñ–¥ –≤–∞—à–æ–≥–æ —ñ–º–µ–Ω—ñ**.

–í–∞–∂–ª–∏–≤–æ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≤ —Ä–∞–º–∫–∞—Ö OAuth 2.0:

* **resource owner**: –í–∏, —è–∫ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á/—Å—É–±'—î–∫—Ç**, –Ω–∞–¥–∞—î—Ç–µ –¥–æ–∑–≤—ñ–ª –Ω–∞ –¥–æ—Å—Ç—É–ø –¥–æ –≤–∞—à–æ–≥–æ —Ä–µ—Å—É—Ä—Å—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ –≤–∞—à–∏—Ö –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π —É —Å–æ—Ü—ñ–∞–ª—å–Ω–∏—Ö –º–µ—Ä–µ–∂–∞—Ö.
* **resource server**: **–°–µ—Ä–≤–µ—Ä, —è–∫–∏–π –∫–µ—Ä—É—î –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º–∏ –∑–∞–ø–∏—Ç–∞–º–∏** –ø—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –¥–æ–¥–∞—Ç–æ–∫ –æ—Ç—Ä–∏–º–∞–≤ `access token` –≤—ñ–¥ —ñ–º–µ–Ω—ñ `resource owner`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **https://socialmedia.com**.
* **client application**: **–î–æ–¥–∞—Ç–æ–∫, —è–∫–∏–π –∑–∞–ø–∏—Ç—É—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é** –≤—ñ–¥ `resource owner`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **https://example.com**.
* **authorization server**: **–°–µ—Ä–≤–µ—Ä, —è–∫–∏–π –≤–∏–¥–∞—î `access tokens`** –¥–ª—è `client application` –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó `resource owner` —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **https://socialmedia.com**.
* **client\_id**: –ü—É–±–ª—ñ—á–Ω–∏–π, —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –¥–ª—è –¥–æ–¥–∞—Ç–∫—É.
* **client\_secret:** –ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω–∏–π –∫–ª—é—á, –≤—ñ–¥–æ–º–∏–π –ª–∏—à–µ –¥–æ–¥–∞—Ç–∫—É —Ç–∞ —Å–µ—Ä–≤–µ—Ä—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó `access_tokens`.
* **response\_type**: –ó–Ω–∞—á–µ–Ω–Ω—è, —â–æ –≤–∫–∞–∑—É—î **—Ç–∏–ø –∑–∞–ø–∏—Ç—É–≤–∞–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `code`.
* **scope**: **–†—ñ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø—É**, —è–∫–∏–π `client application` –∑–∞–ø–∏—Ç—É—î —É `resource owner`.
* **redirect\_uri**: **URL, –Ω–∞ —è–∫–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –ø—ñ—Å–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**. –ó–∞–∑–≤–∏—á–∞–π –ø–æ–≤–∏–Ω–µ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ–º—É URL –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è.
* **state**: –ü–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è **–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—ñ–¥ —á–∞—Å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ —Ç–∞ –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó**. –ô–æ–≥–æ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å —î –∫—Ä–∏—Ç–∏—á–Ω–æ—é –¥–ª—è —Å–ª—É–∂—ñ–Ω–Ω—è —è–∫ **–º–µ—Ö–∞–Ω—ñ–∑–º –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ CSRF**.
* **grant\_type**: –ü–∞—Ä–∞–º–µ—Ç—Ä, —â–æ –≤–∫–∞–∑—É—î **—Ç–∏–ø –≥—Ä–∞–Ω—Ç—É —Ç–∞ —Ç–∏–ø —Ç–æ–∫–µ–Ω–∞, —è–∫–∏–π –±—É–¥–µ –ø–æ–≤–µ—Ä–Ω—É—Ç–æ**.
* **code**: –ö–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –≤—ñ–¥ `authorization server`, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ä–∞–∑–æ–º –∑ `client_id` —Ç–∞ `client_secret` –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–º –¥–æ–¥–∞—Ç–∫–æ–º –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è `access_token`.
* **access\_token**: **–¢–æ–∫–µ–Ω, —è–∫–∏–π –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π –¥–æ–¥–∞—Ç–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–ª—è API –∑–∞–ø–∏—Ç—ñ–≤** –≤—ñ–¥ —ñ–º–µ–Ω—ñ `resource owner`.
* **refresh\_token**: –î–æ–∑–≤–æ–ª—è—î –¥–æ–¥–∞—Ç–∫—É **–æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–æ–≤–∏–π `access_token` –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**.

### Flow

**–§–∞–∫—Ç–∏—á–Ω–∏–π –ø–æ—Ç—ñ–∫ OAuth** –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:

1. –í–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –Ω–∞ [https://example.com](https://example.com) —ñ –Ω–∞—Ç–∏—Å–∫–∞—î—Ç–µ –∫–Ω–æ–ø–∫—É ‚Äú–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ —Å–æ—Ü—ñ–∞–ª—å–Ω–∏–º–∏ –º–µ—Ä–µ–∂–∞–º–∏‚Äù.
2. –°–∞–π—Ç –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç –Ω–∞ [https://socialmedia.com](https://socialmedia.com), –∑–∞–ø–∏—Ç—É—é—á–∏ –≤–∞—à—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ–¥–∞—Ç–∫—É https://example.com –¥–æ –≤–∞—à–∏—Ö –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π. –ó–∞–ø–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:
```
https://socialmedia.com/auth
?response_type=code
&client_id=example_clientId
&redirect_uri=https%3A%2F%2Fexample.com%2Fcallback
&scope=readPosts
&state=randomString123
```
3. –í–∞–º –±—É–¥–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ —Å—Ç–æ—Ä—ñ–Ω–∫—É –∑–≥–æ–¥–∏.
4. –ü—ñ—Å–ª—è –≤–∞—à–æ–≥–æ —Å—Ö–≤–∞–ª–µ–Ω–Ω—è, Social Media –Ω–∞–¥—Å–∏–ª–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ `redirect_uri` –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ `code` —Ç–∞ `state`:
```
https://example.com?code=uniqueCode123&state=randomString123
```
5. https://example.com –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ü–µ–π `code`, —Ä–∞–∑–æ–º –∑ –π–æ–≥–æ `client_id` —Ç–∞ `client_secret`, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä–Ω–∏–π –∑–∞–ø–∏—Ç –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è `access_token` –≤—ñ–¥ –≤–∞—à–æ–≥–æ —ñ–º–µ–Ω—ñ, —â–æ –¥–æ–∑–≤–æ–ª—è—î –¥–æ—Å—Ç—É–ø –¥–æ –¥–æ–∑–≤–æ–ª—ñ–≤, –Ω–∞ —è–∫—ñ –≤–∏ –ø–æ–≥–æ–¥–∏–ª–∏—Å—è:
```
POST /oauth/access_token
Host: socialmedia.com
...{"client_id": "example_clientId", "client_secret": "example_clientSecret", "code": "uniqueCode123", "grant_type": "authorization_code"}
```
6. –ù–∞—Ä–µ—à—Ç—ñ, –ø—Ä–æ—Ü–µ—Å –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è, –∫–æ–ª–∏ https://example.com –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–∞—à `access_token` –¥–ª—è –∑–¥—ñ–π—Å–Ω–µ–Ω–Ω—è API –≤–∏–∫–ª–∏–∫—É –¥–æ Social Media –¥–ª—è –¥–æ—Å—Ç—É–ø—É

## –£—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ <a href="#id-323a" id="id-323a"></a>

### Open redirect\_uri <a href="#cc36" id="cc36"></a>

`redirect_uri` —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è –±–µ–∑–ø–µ–∫–∏ –≤ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è—Ö OAuth —Ç–∞ OpenID, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –≤–∏–∑–Ω–∞—á–∞—î, –∫—É–¥–∏ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ, —Ç–∞–∫—ñ —è–∫ –∫–æ–¥–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, –ø—ñ—Å–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó. –Ø–∫—â–æ –≤—ñ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π, —Ü–µ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç–∏ —Ü—ñ –∑–∞–ø–∏—Ç–∏ –Ω–∞ —à–∫—ñ–¥–ª–∏–≤—ñ —Å–µ—Ä–≤–µ—Ä–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤.

–¢–µ—Ö–Ω—ñ–∫–∏ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤–∞—Ä—ñ—é—é—Ç—å—Å—è –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –ª–æ–≥—ñ–∫–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó —Å–µ—Ä–≤–µ—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –≤–∞—Ä—ñ—é–≤–∞—Ç–∏—Å—è –≤—ñ–¥ —Å—É–≤–æ—Ä–æ–≥–æ —Å–ø—ñ–≤–ø–∞–¥—ñ–Ω–Ω—è —à–ª—è—Ö—ñ–≤ –¥–æ –ø—Ä–∏–π–Ω—è—Ç—Ç—è –±—É–¥—å-—è–∫–æ–≥–æ URL –≤ –º–µ–∂–∞—Ö –∑–∞–∑–Ω–∞—á–µ–Ω–æ–≥–æ –¥–æ–º–µ–Ω—É –∞–±–æ –ø—ñ–¥–∫–∞—Ç–∞–ª–æ–≥—É. –ü–æ—à–∏—Ä–µ–Ω—ñ –º–µ—Ç–æ–¥–∏ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤–∫–ª—é—á–∞—é—Ç—å –≤—ñ–¥–∫—Ä–∏—Ç—ñ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è, –æ–±—Ö–æ–¥–∏ —à–ª—è—Ö—ñ–≤, –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—é —Å–ª–∞–±–∫–∏—Ö —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤ —Ç–∞ HTML —ñ–Ω'—î–∫—Ü—ñ—ó –¥–ª—è –∫—Ä–∞–¥—ñ–∂–∫–∏ —Ç–æ–∫–µ–Ω—ñ–≤.

–û–∫—Ä—ñ–º `redirect_uri`, —ñ–Ω—à—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ OAuth —Ç–∞ OpenID, —Ç–∞–∫—ñ —è–∫ `client_uri`, `policy_uri`, `tos_uri` —Ç–∞ `initiate_login_uri`, —Ç–∞–∫–æ–∂ –≤—Ä–∞–∑–ª–∏–≤—ñ –¥–æ –∞—Ç–∞–∫ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è. –¶—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —î –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º–∏, —ñ —ó—Ö –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –≤–∞—Ä—ñ—é—î—Ç—å—Å—è –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä—ñ–≤.

–î–ª—è —Ç–∏—Ö, —Ö—Ç–æ –Ω–∞—Ü—ñ–ª–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä OpenID, –∫—ñ–Ω—Ü–µ–≤–∞ —Ç–æ—á–∫–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è (`**.well-known/openid-configuration**`) —á–∞—Å—Ç–æ –º—ñ—Å—Ç–∏—Ç—å —Ü—ñ–Ω–Ω—ñ –¥–µ—Ç–∞–ª—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ `registration_endpoint`, `request_uri_parameter_supported` —Ç–∞ "`require_request_uri_registration`. –¶—ñ –¥–µ—Ç–∞–ª—ñ –º–æ–∂—É—Ç—å –¥–æ–ø–æ–º–æ–≥—Ç–∏ —É –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—ñ –∫—ñ–Ω—Ü–µ–≤–æ—ó —Ç–æ—á–∫–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —Ç–∞ —ñ–Ω—à–∏—Ö —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Å–µ—Ä–≤–µ—Ä–∞.

### XSS –≤ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è <a href="#bda5" id="bda5"></a>

–Ø–∫ –∑–∞–∑–Ω–∞—á–µ–Ω–æ –≤ —Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ –ø—Ä–æ –±–∞–≥ –±–∞—É–Ω—Ç—ñ [https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html](https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html), –º–æ–∂–ª–∏–≤–æ, —â–æ **URL –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ** —Å–µ—Ä–≤–µ—Ä–∞ –ø—ñ—Å–ª—è –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —â–æ —Ä–æ–±–∏—Ç—å –π–æ–≥–æ **–≤—Ä–∞–∑–ª–∏–≤–∏–º –¥–æ XSS**. –ú–æ–∂–ª–∏–≤–∏–π –∫–æ—Ä–∏—Å–Ω–∏–π –Ω–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—á –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
```
https://app.victim.com/login?redirectUrl=https://app.victim.com/dashboard</script><h1>test</h1>
```
### CSRF - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ state <a href="#bda5" id="bda5"></a>

–£ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è—Ö OAuth –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∞–±–æ –ø—Ä–æ–ø—É—Å–∫ **–ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `state`** –º–æ–∂–µ –∑–Ω–∞—á–Ω–æ –∑–±—ñ–ª—å—à–∏—Ç–∏ —Ä–∏–∑–∏–∫ –∞—Ç–∞–∫ **Cross-Site Request Forgery (CSRF)**. –¶—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `state` –∞–±–æ **–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ —Å—Ç–∞—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è, –∞–±–æ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º**, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –æ–±—Ö–æ–¥–∏—Ç–∏ –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ CSRF.

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Ü–∏–º, –ø–µ—Ä–µ—Ö–æ–ø–ª—é—é—á–∏ –ø—Ä–æ—Ü–µ—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, —â–æ–± –ø–æ–≤'—è–∑–∞—Ç–∏ —Å–≤—ñ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∑ –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º –∂–µ—Ä—Ç–≤–∏, —â–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ–≥–æ **–∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É**. –¶–µ –æ—Å–æ–±–ª–∏–≤–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –≤ –¥–æ–¥–∞—Ç–∫–∞—Ö, –¥–µ OAuth –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è **–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**.

–†–µ–∞–ª—å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –±—É–ª–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ –≤ —Ä—ñ–∑–Ω–∏—Ö **CTF-–∑–º–∞–≥–∞–Ω–Ω—è—Ö** —Ç–∞ **—Ö–∞–∫–µ—Ä—Å—å–∫–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö**, —â–æ –ø—ñ–¥–∫—Ä–µ—Å–ª—é—î —ó—ó –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏. –ü—Ä–æ–±–ª–µ–º–∞ —Ç–∞–∫–æ–∂ –ø–æ—à–∏—Ä—é—î—Ç—å—Å—è –Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ **Slack**, **Stripe** —Ç–∞ **PayPal**, –¥–µ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∞–±–æ –ø–ª–∞—Ç–µ–∂—ñ –Ω–∞ —Å–≤–æ—ó –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏.

–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ **–ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `state`** —î –≤–∞–∂–ª–∏–≤–æ—é –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ CSRF —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ OAuth-–ø–æ—Ç–æ–∫—É.

### Pre Account Takeover <a href="#ebe4" id="ebe4"></a>

1. **–ë–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É**: –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –∂–µ—Ä—Ç–≤–∏. –Ø–∫—â–æ –∂–µ—Ä—Ç–≤–∞ –ø—ñ–∑–Ω—ñ—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —Å–µ—Ä–≤—ñ—Å –¥–ª—è –≤—Ö–æ–¥—É, –¥–æ–¥–∞—Ç–æ–∫ –º–æ–∂–µ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –ø–æ–≤'—è–∑–∞—Ç–∏ —Ü–µ–π —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ —Å—Ç–≤–æ—Ä–µ–Ω–∏–º –æ–±–ª—ñ–∫–æ–≤–∏–º –∑–∞–ø–∏—Å–æ–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞, —â–æ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É.
2. **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–ª–∞–±–∫–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ –≤ OAuth**: –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Å–µ—Ä–≤—ñ—Å–∞–º–∏ OAuth, —è–∫—ñ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ñ –ª–∏—Å—Ç–∏, –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞–≤—à–∏—Å—å —É —ó—Ö–Ω—å–æ–º—É —Å–µ—Ä–≤—ñ—Å—ñ, –∞ –ø–æ—Ç—ñ–º –∑–º—ñ–Ω–∏–≤—à–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –Ω–∞ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –∂–µ—Ä—Ç–≤–∏. –¶–µ–π –º–µ—Ç–æ–¥ –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ —Ä–∏–∑–∏–∫—É—î –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–º –¥–æ—Å—Ç—É–ø–æ–º –¥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É, —è–∫ —ñ –≤ –ø–µ—Ä—à–æ–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó, –∞–ª–µ —á–µ—Ä–µ–∑ —ñ–Ω—à–∏–π –≤–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏.

### Disclosure of Secrets <a href="#e177" id="e177"></a>

–Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Ç–∞ –∑–∞—Ö–∏—Å—Ç —Å–µ–∫—Ä–µ—Ç–Ω–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ OAuth —î –≤–∞–∂–ª–∏–≤–∏–º–∏. –•–æ—á–∞ **`client_id`** –º–æ–∂–Ω–∞ –±–µ–∑–ø–µ—á–Ω–æ —Ä–æ–∑–∫—Ä–∏–≤–∞—Ç–∏, —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è **`client_secret`** —Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–Ω—ñ —Ä–∏–∑–∏–∫–∏. –Ø–∫—â–æ `client_secret` —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–æ, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å —Ç–∞ –¥–æ–≤—ñ—Ä—É –¥–æ –¥–æ–¥–∞—Ç–∫—É –¥–ª—è **–∫—Ä–∞–¥—ñ–∂–∫–∏ `access_tokens` –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤** —Ç–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

–ü–æ—à–∏—Ä–µ–Ω–∞ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –¥–æ–¥–∞—Ç–∫–∏ –ø–æ–º–∏–ª–∫–æ–≤–æ –æ–±—Ä–æ–±–ª—è—é—Ç—å –æ–±–º—ñ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ–π–Ω–æ–≥–æ `code` –Ω–∞ `access_token` –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞, –∞ –Ω–µ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞. –¶—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è `client_secret`, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ `access_tokens` –ø—ñ–¥ –≤–∏–≥–ª—è–¥–æ–º –¥–æ–¥–∞—Ç–∫—É. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —á–µ—Ä–µ–∑ —Å–æ—Ü—ñ–∞–ª—å–Ω—É —ñ–Ω–∂–µ–Ω–µ—Ä—ñ—é –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –ø—ñ–¥–≤–∏—â–∏—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó, –¥–æ–¥–∞—é—á–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –æ–±–ª–∞—Å—Ç—ñ –¥–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó OAuth, —â–µ –±—ñ–ª—å—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –¥–æ–≤—ñ—Ä–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å –¥–æ–¥–∞—Ç–∫—É.

### Client Secret Bruteforce

–í–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **bruteforce client\_secret** –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ –ø–æ—Å–ª—É–≥ –∑ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–æ–º —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤–∫—Ä–∞—Å—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏.\
–ó–∞–ø–∏—Ç –Ω–∞ BF –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –ø—Ä–∏–±–ª–∏–∑–Ω–æ —Ç–∞–∫:
```
POST /token HTTP/1.1
content-type: application/x-www-form-urlencoded
host: 10.10.10.10:3000
content-length: 135
Connection: close

code=77515&redirect_uri=http%3A%2F%2F10.10.10.10%3A3000%2Fcallback&grant_type=authorization_code&client_id=public_client_id&client_secret=[bruteforce]
```
### Referer Header leaking Code + State

–Ø–∫—â–æ –∫–ª—ñ—î–Ω—Ç –º–∞—î **code —ñ state**, —ñ –≤–æ–Ω–∏ **–≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ Referer** –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥—ñ –Ω–∞ —ñ–Ω—à—É —Å—Ç–æ—Ä—ñ–Ω–∫—É, —Ç–æ —Ü–µ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å.

### Access Token Stored in Browser History

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **—ñ—Å—Ç–æ—Ä—ñ—ó –±—Ä–∞—É–∑–µ—Ä–∞ —ñ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–æ —Ç–∞–º access token**.

### Everlasting Authorization Code

**Authorization code –ø–æ–≤–∏–Ω–µ–Ω –∂–∏—Ç–∏ –ª–∏—à–µ –¥–µ—è–∫–∏–π —á–∞—Å, —â–æ–± –æ–±–º–µ–∂–∏—Ç–∏ —á–∞—Å–æ–≤–∏–π –ø—Ä–æ–º—ñ–∂–æ–∫, –ø—Ä–æ—Ç—è–≥–æ–º —è–∫–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –π–æ–≥–æ –≤–∫—Ä–∞—Å—Ç–∏ —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏**.

### Authorization/Refresh Token not bound to client

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ **authorization code —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –π–æ–≥–æ –∑ —ñ–Ω—à–∏–º –∫–ª—ñ—î–Ω—Ç–æ–º, —Ç–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞—Ö–æ–ø–∏—Ç–∏ —ñ–Ω—à—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏**.

### Happy Paths, XSS, Iframes & Post Messages to leak code & state values

[**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ–π –ø–æ—Å—Ç**](https://labs.detectify.com/writeups/account-hijacking-using-dirty-dancing-in-sign-in-oauth-flows/#gadget-2-xss-on-sandbox-third-party-domain-that-gets-the-url)

### AWS Cognito <a href="#bda5" id="bda5"></a>

–£ —Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ –ø—Ä–æ bug bounty: [**https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/**](https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/) –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ **token**, —è–∫–∏–π –ø–æ–≤–µ—Ä—Ç–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ **AWS Cognito**, –º–æ–∂–µ –º–∞—Ç–∏ **–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–æ–∑–≤–æ–ª—ñ–≤ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**. –¢–æ–º—É, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–º—ñ–Ω–∏—Ç–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ —ñ–Ω—à—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É**, –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–∞—Ö–æ–ø–∏—Ç–∏** —ñ–Ω—à—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏.
```bash
# Read info of the user
aws cognito-idp get-user --region us-east-1 --access-token eyJraWQiOiJPVj[...]

# Change email address
aws cognito-idp update-user-attributes --region us-east-1 --access-token eyJraWQ[...] --user-attributes Name=email,Value=imaginary@flickr.com
{
"CodeDeliveryDetailsList": [
{
"Destination": "i***@f***.com",
"DeliveryMedium": "EMAIL",
"AttributeName": "email"
}
]
}
```
–î–ª—è –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ç–µ, —è–∫ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ AWS cognito, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

{% embed url="https://cloud.hacktricks.xyz/pentesting-cloud/aws-pentesting/aws-unauthenticated-enum-access/aws-cognito-unauthenticated-enum" %}

### –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞–º–∏ —ñ–Ω—à–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤ <a href="#bda5" id="bda5"></a>

–Ø–∫ [**–∑–≥–∞–¥–∞–Ω–æ –≤ —Ü—å–æ–º—É –æ–ø–∏—Å—ñ**](https://salt.security/blog/oh-auth-abusing-oauth-to-take-over-millions-of-accounts), OAuth –ø–æ—Ç–æ–∫–∏, —è–∫—ñ –æ—á—ñ–∫—É—é—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ **—Ç–æ–∫–µ–Ω** (–∞ –Ω–µ –∫–æ–¥), –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏, —è–∫—â–æ –≤–æ–Ω–∏ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å, —â–æ —Ç–æ–∫–µ–Ω –Ω–∞–ª–µ–∂–∏—Ç—å –¥–æ–¥–∞—Ç–∫—É.

–¶–µ —Ç–æ–º—É, —â–æ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫** –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **–¥–æ–¥–∞—Ç–æ–∫, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î OAuth —ñ –≤—Ö—ñ–¥ —á–µ—Ä–µ–∑ Facebook** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥) —É —Å–≤–æ—î–º—É –≤–ª–∞—Å–Ω–æ–º—É –¥–æ–¥–∞—Ç–∫—É. –ü–æ—Ç—ñ–º, –∫–æ–ª–∏ –∂–µ—Ä—Ç–≤–∞ –≤—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ Facebook —É **–¥–æ–¥–∞—Ç–æ–∫ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ **OAuth —Ç–æ–∫–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –Ω–∞–¥–∞–Ω–∏–π –π–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É, —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –≤—Ö–æ–¥—É –≤ –¥–æ–¥–∞—Ç–æ–∫ –∂–µ—Ä—Ç–≤–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç–æ–∫–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∂–µ—Ä—Ç–≤–∏**.

{% hint style="danger" %}
–û—Ç–∂–µ, —è–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑—É–º—ñ—î –∑–º—É—Å–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —É–≤—ñ–π—Ç–∏ —É —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π OAuth –¥–æ–¥–∞—Ç–æ–∫, –≤—ñ–Ω –∑–º–æ–∂–µ –∑–∞—Ö–æ–ø–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∂–µ—Ä—Ç–≤–∏ –≤ –¥–æ–¥–∞—Ç–∫–∞—Ö, —è–∫—ñ –æ—á—ñ–∫—É—é—Ç—å —Ç–æ–∫–µ–Ω —ñ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å, —á–∏ –±—É–≤ —Ç–æ–∫–µ–Ω –Ω–∞–¥–∞–Ω–∏–π —ó—Ö–Ω—å–æ–º—É ID –¥–æ–¥–∞—Ç–∫—É.
{% endhint %}

### –î–≤–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è —Ç–∞ cookie <a href="#bda5" id="bda5"></a>

–ó–≥—ñ–¥–Ω–æ –∑ [**—Ü–∏–º –æ–ø–∏—Å–æ–º**](https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f), –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ –∑–º—É—Å–∏—Ç–∏ –∂–µ—Ä—Ç–≤—É –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É –∑ **returnUrl**, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ö–æ—Å—Ç –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞. –¶—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –±—É–¥–µ **–∑–±–µ—Ä–µ–∂–µ–Ω–∞ –≤ cookie (RU)** —ñ –Ω–∞ **–ø—ñ–∑–Ω—ñ—à–æ–º—É –µ—Ç–∞–ø—ñ** **–ø—ñ–¥–∫–∞–∑–∫–∞** –∑–∞–ø–∏—Ç–∞—î **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, —á–∏ —Ö–æ—á–µ –≤—ñ–Ω –Ω–∞–¥–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ü—å–æ–≥–æ —Ö–æ—Å—Ç–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞.

–©–æ–± –æ–±—ñ–π—Ç–∏ —Ü—é –ø—ñ–¥–∫–∞–∑–∫—É, –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –≤–∫–ª–∞–¥–∫—É –¥–ª—è —ñ–Ω—ñ—Ü—ñ–∞—Ü—ñ—ó **Oauth –ø–æ—Ç–æ–∫—É**, —è–∫–∏–π –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–µ–π RU cookie, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **returnUrl**, –∑–∞–∫—Ä–∏—Ç–∏ –≤–∫–ª–∞–¥–∫—É –¥–æ –ø–æ—è–≤–∏ –ø—ñ–¥–∫–∞–∑–∫–∏ —ñ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –Ω–æ–≤—É –≤–∫–ª–∞–¥–∫—É –±–µ–∑ —Ü—å–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è. –¢–æ–¥—ñ **–ø—ñ–¥–∫–∞–∑–∫–∞ –Ω–µ –ø–æ–≤—ñ–¥–æ–º–∏—Ç—å –ø—Ä–æ —Ö–æ—Å—Ç –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞**, –∞–ª–µ cookie –±—É–¥–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ –Ω—å–æ–≥–æ, —Ç–æ–º—É **—Ç–æ–∫–µ–Ω –±—É–¥–µ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ —Ö–æ—Å—Ç –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞** –ø—Ä–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ñ.

### –û–±—Ö—ñ–¥ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –ø—ñ–¥–∫–∞–∑–∫–æ—é <a href="#bda5" id="bda5"></a>

–Ø–∫ –ø–æ—è—Å–Ω–µ–Ω–æ –≤ [**—Ü—å–æ–º—É –≤—ñ–¥–µ–æ**](https://www.youtube.com/watch?v=n9x7\_J\_a\_7Q), –¥–µ—è–∫—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó OAuth –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∫–∞–∑–∞—Ç–∏ **`prompt`** GET –ø–∞—Ä–∞–º–µ—Ç—Ä —è–∫ None (**`&prompt=none`**), —â–æ–± **–∑–∞–ø–æ–±—ñ–≥—Ç–∏ –∑–∞–ø–∏—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏** –Ω–∞–¥–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø —É –ø—ñ–¥–∫–∞–∑—Ü—ñ –Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω—Ü—ñ, —è–∫—â–æ –≤–æ–Ω–∏ –≤–∂–µ —É–≤—ñ–π—à–ª–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É.

### response\_mode

–Ø–∫ [**–ø–æ—è—Å–Ω–µ–Ω–æ –≤ —Ü—å–æ–º—É –≤—ñ–¥–µ–æ**](https://www.youtube.com/watch?v=n9x7\_J\_a\_7Q), –º–æ–∂–ª–∏–≤–æ –≤–∫–∞–∑–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä **`response_mode`**, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏, –¥–µ –≤–∏ —Ö–æ—á–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ–¥ —É —Ñ—ñ–Ω–∞–ª—å–Ω–æ–º—É URL:

* `response_mode=query` -> –ö–æ–¥ –Ω–∞–¥–∞—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ GET –ø–∞—Ä–∞–º–µ—Ç—Ä–∞: `?code=2397rf3gu93f`
* `response_mode=fragment` -> –ö–æ–¥ –Ω–∞–¥–∞—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ URL `#code=2397rf3gu93f`
* `response_mode=form_post` -> –ö–æ–¥ –Ω–∞–¥–∞—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ POST —Ñ–æ—Ä–º–∏ –∑ input –ø—ñ–¥ –Ω–∞–∑–≤–æ—é `code` —ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º
* `response_mode=web_message` -> –ö–æ–¥ –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è —É post –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ: `window.opener.postMessage({"code": "asdasdasd...`

### SSRFs –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ <a href="#bda5" id="bda5"></a>

[**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è**](https://portswigger.net/research/hidden-oauth-attack-vectors) **–¥–ª—è –ø–æ–¥–∞–ª—å—à–∏—Ö –¥–µ—Ç–∞–ª–µ–π —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏.**

–î–∏–Ω–∞–º—ñ—á–Ω–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–ª—ñ—î–Ω—Ç—ñ–≤ –≤ OAuth —Å–ª—É–∂–∏—Ç—å –º–µ–Ω—à –æ—á–µ–≤–∏–¥–Ω–∏–º, –∞–ª–µ –∫—Ä–∏—Ç–∏—á–Ω–∏–º –≤–µ–∫—Ç–æ—Ä–æ–º –¥–ª—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –±–µ–∑–ø–µ–∫–∏, –∑–æ–∫—Ä–µ–º–∞ –¥–ª—è **Server-Side Request Forgery (SSRF)** –∞—Ç–∞–∫. –¶—è –∫—ñ–Ω—Ü–µ–≤–∞ —Ç–æ—á–∫–∞ –¥–æ–∑–≤–æ–ª—è—î OAuth —Å–µ—Ä–≤–µ—Ä–∞–º –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–µ—Ç–∞–ª—ñ –ø—Ä–æ –∫–ª—ñ—î–Ω—Ç—Å—å–∫—ñ –¥–æ–¥–∞—Ç–∫–∏, –≤–∫–ª—é—á–∞—é—á–∏ —á—É—Ç–ª–∏–≤—ñ URL, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ.

**–ö–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏:**

* **–î–∏–Ω–∞–º—ñ—á–Ω–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–ª—ñ—î–Ω—Ç—ñ–≤** —á–∞—Å—Ç–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –Ω–∞ `/register` —ñ –ø—Ä–∏–π–º–∞—î –¥–µ—Ç–∞–ª—ñ, —Ç–∞–∫—ñ —è–∫ `client_name`, `client_secret`, `redirect_uris` —Ç–∞ URL –¥–ª—è –ª–æ–≥–æ—Ç–∏–ø—ñ–≤ –∞–±–æ JSON Web Key Sets (JWKs) —á–µ—Ä–µ–∑ POST –∑–∞–ø–∏—Ç–∏.
* –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è–º, –≤–∏–∫–ª–∞–¥–µ–Ω–∏–º —É **RFC7591** —Ç–∞ **OpenID Connect Registration 1.0**, —è–∫—ñ –≤–∫–ª—é—á–∞—é—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤—Ä–∞–∑–ª–∏–≤—ñ –¥–æ SSRF.
* –ü—Ä–æ—Ü–µ—Å —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –º–æ–∂–µ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –ø—ñ–¥–¥–∞–≤–∞—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∏ SSRF –∫—ñ–ª—å–∫–æ–º–∞ —Å–ø–æ—Å–æ–±–∞–º–∏:
* **`logo_uri`**: URL –¥–ª—è –ª–æ–≥–æ—Ç–∏–ø—É –∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ–≥–æ –¥–æ–¥–∞—Ç–∫—É, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ –æ—Ç—Ä–∏–º–∞–Ω–∏–π —Å–µ—Ä–≤–µ—Ä–æ–º, –≤–∏–∫–ª–∏–∫–∞—é—á–∏ SSRF –∞–±–æ –ø—Ä–∏–∑–≤–æ–¥—è—á–∏ –¥–æ XSS, —è–∫—â–æ URL –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.
* **`jwks_uri`**: URL –¥–æ JWK –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∫–ª—ñ—î–Ω—Ç–∞, —è–∫–∏–π, —è–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π, –º–æ–∂–µ –∑–º—É—Å–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä —Ä–æ–±–∏—Ç–∏ –≤–∏—Ö—ñ–¥–Ω—ñ –∑–∞–ø–∏—Ç–∏ –¥–æ —Å–µ—Ä–≤–µ—Ä–∞, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º.
* **`sector_identifier_uri`**: –ü–æ—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ JSON –º–∞—Å–∏–≤ `redirect_uris`, —è–∫–∏–π —Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏, —Å—Ç–≤–æ—Ä—é—é—á–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –¥–ª—è SSRF.
* **`request_uris`**: –ü–µ—Ä–µ–ª—ñ–∫ –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö URI –∑–∞–ø–∏—Ç—ñ–≤ –¥–ª—è –∫–ª—ñ—î–Ω—Ç–∞, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ, —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä –æ—Ç—Ä–∏–º—É—î —Ü—ñ URI –Ω–∞ –ø–æ—á–∞—Ç–∫—É –ø—Ä–æ—Ü–µ—Å—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.

**–°—Ç—Ä–∞—Ç–µ–≥—ñ—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó:**

* SSRF –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–ª–∏–∫–∞–Ω–∏–π —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—î—é –Ω–æ–≤–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ –∑ –∑–ª–æ–≤–º–∏—Å–Ω–∏–º–∏ URL –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ `logo_uri`, `jwks_uri` –∞–±–æ `sector_identifier_uri`.
* –•–æ—á–∞ –ø—Ä—è–º–∞ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è —á–µ—Ä–µ–∑ `request_uris` –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–º'—è–∫—à–µ–Ω–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–Ω—Ç—Ä–æ–ª—é –±—ñ–ª–æ–≥–æ —Å–ø–∏—Å–∫—É, –Ω–∞–¥–∞–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ–≥–æ, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º `request_uri` –º–æ–∂–µ —Å–ø—Ä–∏—è—Ç–∏ SSRF –ø—ñ–¥ —á–∞—Å —Ñ–∞–∑–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.

## Race Conditions —É –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤ OAuth

–Ø–∫—â–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, —è–∫—É –≤–∏ —Ç–µ—Å—Ç—É—î—Ç–µ, —î –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º OAuth, [**–ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Ü–µ, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –º–æ–∂–ª–∏–≤—ñ Race Conditions**](race-condition.md).

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [**https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1**](https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1)
* [**https://portswigger.net/research/hidden-oauth-attack-vectors**](https://portswigger.net/research/hidden-oauth-attack-vectors)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ AWS hacking –≤—ñ–¥ –ø–æ—á–∞—Ç–∫—ñ–≤—Ü—è –¥–æ –µ–∫—Å–ø–µ—Ä—Ç–∞ –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –±–∞—á–∏—Ç–∏ —Å–≤–æ—é **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω–æ—é –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFTs**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ –≤ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –ø–æ–¥–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.

</details>
