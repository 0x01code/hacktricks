# OAuth to Account takeover

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Basic Information <a href="#d4a8" id="d4a8"></a>

OAuth рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд╕реНрдХрд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рдирдХреА рдмреБрдирд┐рдпрд╛рджреА рдЬрд╛рдирдХрд╛рд░реА [OAuth 2.0 documentation](https://oauth.net/2/) рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реИред рдпрд╣ рдЪрд░реНрдЪрд╛ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рд╡реНрдпрд╛рдкрдХ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ [OAuth 2.0 authorization code grant type](https://oauth.net/2/grant-types/authorization-code/) рдкрд░ рдХреЗрдВрджреНрд░рд┐рдд рд╣реИ, рдЬреЛ рдПрдХ **authorization framework рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХрд┐рд╕реА рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди (authorization server) рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЦрд╛рддреЗ рдкрд░ рдкрд╣реБрдВрдЪрдиреЗ рдпрд╛ рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдмрдирд╛рддрд╛ рд╣реИ**ред

рдПрдХ рдХрд╛рд▓реНрдкрдирд┐рдХ рд╡реЗрдмрд╕рд╛рдЗрдЯ _**https://example.com**_ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ, рдЬрд┐рд╕реЗ **рдЖрдкрдХреЗ рд╕рднреА рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ рдкреЛрд╕реНрдЯ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**, рдЬрд┐рд╕рдореЗрдВ рдирд┐рдЬреА рдкреЛрд╕реНрдЯ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, OAuth 2.0 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред _https://example.com_ рдЖрдкрдХреА **рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ рдкреЛрд╕реНрдЯ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рдорд╛рдВрдЧреЗрдЧрд╛ред рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, _https://socialmedia.com_ рдкрд░ рдПрдХ рд╕рд╣рдорддрд┐ рд╕реНрдХреНрд░реАрди рджрд┐рдЦрд╛рдИ рджреЗрдЧреА, рдЬрд┐рд╕рдореЗрдВ **рдЕрдиреБрд░реЛрдзрд┐рдд рдЕрдиреБрдорддрд┐рдпреЛрдВ рдФрд░ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдбреЗрд╡рд▓рдкрд░** рдХрд╛ рд╡рд┐рд╡рд░рдг рд╣реЛрдЧрд╛ред рдЖрдкрдХреА рдЕрдиреБрдорддрд┐ рдХреЗ рдмрд╛рдж, _https://example.com_ рдХреЛ **рдЖрдкрдХреА рдУрд░ рд╕реЗ рдЖрдкрдХреЗ рдкреЛрд╕реНрдЯ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдорд┐рд▓ рдЬрд╛рдПрдЧреА**ред

OAuth 2.0 framework рдХреЗ рднреАрддрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдШрдЯрдХреЛрдВ рдХреЛ рд╕рдордЭрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ:

* **resource owner**: рдЖрдк, рдПрдХ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рдЗрдХрд╛рдИ** рдХреЗ рд░реВрдк рдореЗрдВ, рдЕрдкрдиреЗ рд╕рдВрд╕рд╛рдзрди, рдЬреИрд╕реЗ рдХрд┐ рдЖрдкрдХреЗ рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ рдЕрдХрд╛рдЙрдВрдЯ рдкреЛрд╕реНрдЯ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред
* **resource server**: **рд╕рд░реНрд╡рд░ рдЬреЛ рдкреНрд░рдорд╛рдгрд┐рдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ** рдЬрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ `access token` рдХреЛ `resource owner` рдХреА рдУрд░ рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ **https://socialmedia.com**ред
* **client application**: **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬреЛ `resource owner` рд╕реЗ рдЕрдиреБрдорддрд┐ рдорд╛рдВрдЧ рд░рд╣рд╛ рд╣реИ**, рдЬреИрд╕реЗ рдХрд┐ **https://example.com**ред
* **authorization server**: **рд╕рд░реНрд╡рд░ рдЬреЛ `access tokens` рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИ** `client application` рдХреЛ `resource owner` рдХреА рд╕рдлрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдФрд░ рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЬреИрд╕реЗ рдХрд┐ **https://socialmedia.com**ред
* **client\_id**: рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ, рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ред
* **client\_secret:** рдПрдХ рдЧреЛрдкрдиреАрдп рдХреБрдВрдЬреА, рдЬреЛ рдХреЗрд╡рд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ authorization server рдХреЛ рдЬреНрдЮрд╛рдд рд╣реЛрддреА рд╣реИ, `access_tokens` рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИред
* **response\_type**: рдПрдХ рдорд╛рди рдЬреЛ **рдЕрдиреБрд░реЛрдзрд┐рдд рдЯреЛрдХрди рдХреЗ рдкреНрд░рдХрд╛рд░** рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ `code`ред
* **scope**: **рдкрд╣реБрдВрдЪ рдХрд╛ рд╕реНрддрд░** рдЬреЛ `client application` `resource owner` рд╕реЗ рдЕрдиреБрд░реЛрдз рдХрд░ рд░рд╣рд╛ рд╣реИред
* **redirect\_uri**: **URL рдЬрд╣рд╛рдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдиреБрдорддрд┐ рдХреЗ рдмрд╛рдж рдкреБрдирдГ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рдкреВрд░реНрд╡-рдкрдВрдЬреАрдХреГрдд redirect URL рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
* **state**: рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдЬреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкреБрдирдГ рдирд┐рд░реНрджреЗрд╢рд┐рдд рд╣реЛрдиреЗ рдФрд░ authorization server рд╕реЗ рд╡рд╛рдкрд╕ рдЖрдиреЗ рдХреЗ рджреМрд░рд╛рди рдбреЗрдЯрд╛ рдХреЛ рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ**ред рдЗрд╕рдХреА рд╡рд┐рд╢рд┐рд╖реНрдЯрддрд╛ рдПрдХ **CSRF рд╕реБрд░рдХреНрд╖рд╛ рддрдВрддреНрд░** рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред
* **grant\_type**: рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдЬреЛ **grant type рдФрд░ рд▓реМрдЯрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЯреЛрдХрди рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ**ред
* **code**: `authorization server` рд╕реЗ рдкреНрд░рд╛рдкреНрдд authorization code, рдЬрд┐рд╕реЗ `client_id` рдФрд░ `client_secret` рдХреЗ рд╕рд╛рде `access_token` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП client application рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **access\_token**: **рдЯреЛрдХрди рдЬреЛ client application API рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП `resource owner` рдХреА рдУрд░ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ**ред
* **refresh\_token**: рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ **рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреБрдирдГ рдЕрдиреБрд░реЛрдз рдХрд┐рдП рдПрдХ рдирдпрд╛ `access_token` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдмрдирд╛рддрд╛ рд╣реИ**ред

### Flow

**рд╡рд╛рд╕реНрддрд╡рд┐рдХ OAuth рдкреНрд░рд╡рд╛рд╣** рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ:

1. рдЖрдк [https://example.com](https://example.com) рдкрд░ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ "Integrate with Social Media" рдмрдЯрди рдЪреБрдирддреЗ рд╣реИрдВред
2. рд╕рд╛рдЗрдЯ рддрдм [https://socialmedia.com](https://socialmedia.com) рдХреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХреА рдЕрдиреБрдорддрд┐ рдорд╛рдВрдЧреА рдЬрд╛рддреА рд╣реИ рддрд╛рдХрд┐ https://example.com рдХрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЖрдкрдХреЗ рдкреЛрд╕реНрдЯ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреЗред рдЕрдиреБрд░реЛрдз рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╕рдВрд░рдЪрд┐рдд рд╣реИ:
```
https://socialmedia.com/auth
?response_type=code
&client_id=example_clientId
&redirect_uri=https%3A%2F%2Fexample.com%2Fcallback
&scope=readPosts
&state=randomString123
```
3. рдЗрд╕рдХреЗ рдмрд╛рдж рдЖрдкрдХреЛ рдПрдХ рд╕рд╣рдорддрд┐ рдкреГрд╖реНрда рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
4. рдЖрдкрдХреА рд╕реНрд╡реАрдХреГрддрд┐ рдХреЗ рдмрд╛рдж, Social Media `redirect_uri` рдкрд░ `code` рдФрд░ `state` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рднреЗрдЬрддрд╛ рд╣реИ:
```
https://example.com?code=uniqueCode123&state=randomString123
```
5. https://example.com рдЗрд╕ `code`, `client_id` рдФрд░ `client_secret` рдХреЗ рд╕рд╛рде, рдЖрдкрдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдПрдХ `access_token` рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдЬрд┐рд╕рд╕реЗ рдЙрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХреЗ рдЬрд┐рдирдХреЗ рд▓рд┐рдП рдЖрдкрдиреЗ рд╕рд╣рдорддрд┐ рджреА рд╣реИ:
```
POST /oauth/access_token
Host: socialmedia.com
...{"client_id": "example_clientId", "client_secret": "example_clientSecret", "code": "uniqueCode123", "grant_type": "authorization_code"}
```
6. рдЕрдВрдд рдореЗрдВ, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИ рдЬрдм https://example.com рдЖрдкрдХреЗ `access_token` рдХрд╛ рдЙрдкрдпреЛрдЧ Social Media рдкрд░ API рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИ

## рдХрдордЬреЛрд░рд┐рдпрд╛рдБ <a href="#id-323a" id="id-323a"></a>

### Open redirect\_uri <a href="#cc36" id="cc36"></a>

`redirect_uri` OAuth рдФрд░ OpenID рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛, рдЬреИрд╕реЗ рдХрд┐ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛрдб, рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рдмрд╛рдж рдХрд╣рд╛рдБ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред рдпрджрд┐ рдЧрд▓рдд рддрд░реАрдХреЗ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рдЗрди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╕рд░реНрд╡рд░реЛрдВ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЦрд╛рддрд╛ рдЕрдзрд┐рдЧреНрд░рд╣рдг рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рд╢реЛрд╖рдг рддрдХрдиреАрдХреЗрдВ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рд╕рд░реНрд╡рд░ рдХреЗ рд╕рддреНрдпрд╛рдкрди рддрд░реНрдХ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИрдВред рдпреЗ рд╕рдЦреНрдд рдкрде рдорд┐рд▓рд╛рди рд╕реЗ рд▓реЗрдХрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдбреЛрдореЗрди рдпрд╛ рдЙрдкрдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рднреАрддрд░ рдХрд┐рд╕реА рднреА URL рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рддрдХ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рд╕рд╛рдорд╛рдиреНрдп рд╢реЛрд╖рдг рд╡рд┐рдзрд┐рдпреЛрдВ рдореЗрдВ рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ, рдкрде рдЯреНрд░реИрд╡рд░реНрд╕рд▓, рдХрдордЬреЛрд░ regexes рдХрд╛ рд╢реЛрд╖рдг, рдФрд░ рдЯреЛрдХрди рдЪреЛрд░реА рдХреЗ рд▓рд┐рдП HTML рдЗрдВрдЬреЗрдХреНрд╢рди рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

`redirect_uri` рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЕрдиреНрдп OAuth рдФрд░ OpenID рдкреИрд░рд╛рдореАрдЯрд░ рдЬреИрд╕реЗ `client_uri`, `policy_uri`, `tos_uri`, рдФрд░ `initiate_login_uri` рднреА рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╣рдорд▓реЛрдВ рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИрдВред рдпреЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╣реИрдВ рдФрд░ рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рдмреАрдЪ рдЙрдирдХрд╛ рд╕рдорд░реНрдерди рднрд┐рдиреНрди рд╣реЛрддрд╛ рд╣реИред

рдЬреЛ рд▓реЛрдЧ OpenID рд╕рд░реНрд╡рд░ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЙрдирдХреЗ рд▓рд┐рдП рдбрд┐рд╕реНрдХрд╡рд░реА рдПрдВрдбрдкреЙрдЗрдВрдЯ (`**.well-known/openid-configuration**`) рдЕрдХреНрд╕рд░ рдореВрд▓реНрдпрд╡рд╛рди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рд╡рд░рдг рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ `registration_endpoint`, `request_uri_parameter_supported`, рдФрд░ "`require_request_uri_registration`ред рдпреЗ рд╡рд┐рд╡рд░рдг рд╕рд░реНрд╡рд░ рдХреЗ рдкрдВрдЬреАрдХрд░рдг рдПрдВрдбрдкреЙрдЗрдВрдЯ рдФрд░ рдЕрдиреНрдп рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рд╢рд┐рд╖реНрдЯрддрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрдХ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

### redirect рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ XSS <a href="#bda5" id="bda5"></a>

рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ [https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html](https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html) рдпрд╣ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ **URL рд╕рд░реНрд╡рд░ рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдкрд░рд┐рд▓рдХреНрд╖рд┐рдд рд╣реЛ** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд╛рдж, **XSS рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓** рд╣реЛред рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рдкреЗрд▓реЛрдб:
```
https://app.victim.com/login?redirectUrl=https://app.victim.com/dashboard</script><h1>test</h1>
```
### CSRF - Improper handling of state parameter <a href="#bda5" id="bda5"></a>

OAuth рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ, **`state` parameter** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдпрд╛ рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ **Cross-Site Request Forgery (CSRF)** рд╣рдорд▓реЛрдВ рдХреЗ рдЬреЛрдЦрд┐рдо рдХреЛ рдХрд╛рдлреА рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рднреЗрджреНрдпрддрд╛ рддрдм рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм `state` parameter рдХрд╛ **рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛, рд╕реНрдерд┐рд░ рдорд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдорд╛рдиреНрдп рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛**, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ CSRF рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕рдХреЛ рдЕрдзрд┐рдХреГрдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд░рдХреЗ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рд╕реЗ рд▓рд┐рдВрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд **рдЦрд╛рддрд╛ рдЕрдзрд┐рдЧреНрд░рд╣рдг** рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдЙрди рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ OAuth рдХрд╛ рдЙрдкрдпреЛрдЧ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЙрджреНрджреЗрд╢реНрдпреЛрдВ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрд╕ рднреЗрджреНрдпрддрд╛ рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рджреБрдирд┐рдпрд╛ рдХреЗ рдЙрджрд╛рд╣рд░рдг рд╡рд┐рднрд┐рдиреНрди **CTF рдЪреБрдиреМрддрд┐рдпреЛрдВ** рдФрд░ **рд╣реИрдХрд┐рдВрдЧ рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ** рдореЗрдВ рдкреНрд░рд▓реЗрдЦрд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВ, рдЬреЛ рдЗрд╕рдХреЗ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдирд┐рд╣рд┐рддрд╛рд░реНрдереЛрдВ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред рдпрд╣ рдореБрджреНрджрд╛ **Slack**, **Stripe**, рдФрд░ **PayPal** рдЬреИрд╕реА рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдПрдХреАрдХрд░рдг рддрдХ рднреА рдлреИрд▓рд╛ рд╣реБрдЖ рд╣реИ, рдЬрд╣рд╛рдВ рд╣рдорд▓рд╛рд╡рд░ рд╕реВрдЪрдирд╛рдУрдВ рдпрд╛ рднреБрдЧрддрд╛рдиреЛрдВ рдХреЛ рдЕрдкрдиреЗ рдЦрд╛рддреЛрдВ рдореЗрдВ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

CSRF рд╕реЗ рдмрдЪрд╛рд╡ рдФрд░ OAuth рдкреНрд░рд╡рд╛рд╣ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **`state` parameter** рдХрд╛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдкреНрд░рдмрдВрдзрди рдФрд░ рдорд╛рдиреНрдпрдХрд░рдг рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред

### Pre Account Takeover <a href="#ebe4" id="ebe4"></a>

1. **рдЦрд╛рддрд╛ рдирд┐рд░реНрдорд╛рдг рдкрд░ рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдХреЗ рдмрд┐рдирд╛**: рд╣рдорд▓рд╛рд╡рд░ рдкреАрдбрд╝рд┐рдд рдХреЗ рдИрдореЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдкреАрдбрд╝рд┐рдд рдмрд╛рдж рдореЗрдВ рд▓реЙрдЧрд┐рди рдХреЗ рд▓рд┐рдП рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЗрд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдЗрд╕ рддреГрддреАрдп-рдкрдХреНрд╖ рдЦрд╛рддреЗ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╣рд▓реЗ рд╕реЗ рдмрдирд╛рдП рдЧрдП рдЦрд╛рддреЗ рд╕реЗ рд▓рд┐рдВрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рд╣реЛ рд╕рдХрддреА рд╣реИред
2. **рд▓реИрдХреНрд╕ OAuth рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдХрд╛ рд╢реЛрд╖рдг**: рд╣рдорд▓рд╛рд╡рд░ рдЙрди OAuth рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд░рддреА рд╣реИрдВ, рдЕрдкрдиреА рд╕реЗрд╡рд╛ рдХреЗ рд╕рд╛рде рдкрдВрдЬреАрдХрд░рдг рдХрд░рдХреЗ рдФрд░ рдлрд┐рд░ рдЦрд╛рддреЗ рдХреЗ рдИрдореЗрд▓ рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдИрдореЗрд▓ рдореЗрдВ рдмрджрд▓рдХрд░ред рдпрд╣ рд╡рд┐рдзрд┐ рдкрд╣рд▓реЗ рдкрд░рд┐рджреГрд╢реНрдп рдХреЗ рд╕рдорд╛рди рд╣реА рдЕрдирдзрд┐рдХреГрдд рдЦрд╛рддрд╛ рдкрд╣реБрдВрдЪ рдХрд╛ рдЬреЛрдЦрд┐рдо рдкреИрджрд╛ рдХрд░рддреА рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рдЕрд▓рдЧ рд╣рдорд▓реЗ рд╡реЗрдХреНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред

### Disclosure of Secrets <a href="#e177" id="e177"></a>

рдЧреБрдкреНрдд OAuth parameters рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдЬрдмрдХрд┐ **`client_id`** рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдкреНрд░рдХрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, **`client_secret`** рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬреЛрдЦрд┐рдо рдкреИрджрд╛ рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ `client_secret` рд╕реЗ рд╕рдордЭреМрддрд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдХреЗ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `access_tokens`** рдФрд░ рдирд┐рдЬреА рдЬрд╛рдирдХрд╛рд░реА рдЪреБрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рднреЗрджреНрдпрддрд╛ рддрдм рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЧрд▓рддреА рд╕реЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг `code` рдХреЗ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рдХреЛ `access_token` рдХреЗ рд▓рд┐рдП рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдкрд░ рд╕рдВрднрд╛рд▓рддреЗ рд╣реИрдВ рдмрдЬрд╛рдп рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХреЗред рдпрд╣ рдЧрд▓рддреА `client_secret` рдХреЗ рдЦреБрд▓рд╛рд╕реЗ рдХреА рдУрд░ рд▓реЗ рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдирд╛рдо рдкрд░ `access_tokens` рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕рд╛рдорд╛рдЬрд┐рдХ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рд╣рдорд▓рд╛рд╡рд░ OAuth рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реНрдХреЛрдк рдЬреЛрдбрд╝рдХрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╕реНрдерд┐рддрд┐ рдХрд╛ рдФрд░ рдЕрдзрд┐рдХ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### Client Secret Bruteforce

рдЖрдк рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЗ client\_secret рдХреЛ рдкрд╣рдЪрд╛рди рдкреНрд░рджрд╛рддрд╛ рдХреЗ рд╕рд╛рде **bruteforce** рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЦрд╛рддреЛрдВ рдХреЛ рдЪреБрд░рд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред\
BF рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдЗрд╕ рдкреНрд░рдХрд╛рд░ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ:
```
POST /token HTTP/1.1
content-type: application/x-www-form-urlencoded
host: 10.10.10.10:3000
content-length: 135
Connection: close

code=77515&redirect_uri=http%3A%2F%2F10.10.10.10%3A3000%2Fcallback&grant_type=authorization_code&client_id=public_client_id&client_secret=[bruteforce]
```
### Referer Header leaking Code + State

рдПрдХ рдмрд╛рд░ рдЬрдм рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдкрд╛рд╕ **code рдФрд░ state** рд╣реЛрддрд╛ рд╣реИ, рдЕрдЧрд░ рдпрд╣ **Referer header рдХреЗ рдЕрдВрджрд░ рдкрд░рд┐рд▓рдХреНрд╖рд┐рдд рд╣реЛрддрд╛ рд╣реИ** рдЬрдм рд╡рд╣ рдХрд┐рд╕реА рдЕрдиреНрдп рдкреЗрдЬ рдкрд░ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИред

### Access Token Stored in Browser History

**рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рдЬрд╛рдПрдВ рдФрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ access token рд╡рд╣рд╛рдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рд╣реИ**ред

### Everlasting Authorization Code

**authorization code рдХреЛ рдХреЗрд╡рд▓ рдХреБрдЫ рд╕рдордп рдХреЗ рд▓рд┐рдП рд╣реА рдЬреАрд╡рд┐рдд рд░рд╣рдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рдЙрд╕ рд╕рдордп рдХреА рдЦрд┐рдбрд╝рдХреА рдХреЛ рд╕реАрдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕реЗ рдЪреБрд░рд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред

### Authorization/Refresh Token not bound to client

рдпрджрд┐ рдЖрдк **authorization code рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдПрдХ рдЕрд▓рдЧ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЕрдиреНрдп рдЦрд╛рддреЛрдВ рдХреЛ рдЕрдзрд┐рдЧреНрд░рд╣рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

### Happy Paths, XSS, Iframes & Post Messages to leak code & state values

[**рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреЛ рджреЗрдЦреЗрдВ**](https://labs.detectify.com/writeups/account-hijacking-using-dirty-dancing-in-sign-in-oauth-flows/#gadget-2-xss-on-sandbox-third-party-domain-that-gets-the-url)

### AWS Cognito <a href="#bda5" id="bda5"></a>

рдЗрд╕ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ: [**https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/**](https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/) рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **token** рдЬреЛ **AWS Cognito** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╡рд╛рдкрд╕ рджреЗрддрд╛ рд╣реИ, рдЙрд╕рдореЗрдВ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдИрдореЗрд▓ рдХреЛ рдХрд┐рд╕реА рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдИрдореЗрд▓ рдХреЗ рд▓рд┐рдП рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рдЕрдиреНрдп рдЦрд╛рддреЛрдВ рдХреЛ **рдЕрдзрд┐рдЧреНрд░рд╣рд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
# Read info of the user
aws cognito-idp get-user --region us-east-1 --access-token eyJraWQiOiJPVj[...]

# Change email address
aws cognito-idp update-user-attributes --region us-east-1 --access-token eyJraWQ[...] --user-attributes Name=email,Value=imaginary@flickr.com
{
"CodeDeliveryDetailsList": [
{
"Destination": "i***@f***.com",
"DeliveryMedium": "EMAIL",
"AttributeName": "email"
}
]
}
```
For more detailed info about how to abuse AWS cognito check:

{% embed url="https://cloud.hacktricks.xyz/pentesting-cloud/aws-pentesting/aws-unauthenticated-enum-access/aws-cognito-unauthenticated-enum" %}

### рдЕрдиреНрдп Apps рдХреЗ tokens рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛ <a href="#bda5" id="bda5"></a>

рдЬреИрд╕рд╛ рдХрд┐ [**рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**](https://salt.security/blog/oh-auth-abusing-oauth-to-take-over-millions-of-accounts), OAuth flows рдЬреЛ **token** (рдФрд░ рдХреЛрдб рдирд╣реАрдВ) рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЙрдореНрдореАрдж рдХрд░рддреЗ рд╣реИрдВ, рд╡реЗ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдпрджрд┐ рд╡реЗ рдпрд╣ рдирд╣реАрдВ рдЬрд╛рдВрдЪрддреЗ рдХрд┐ token рдРрдк рдХрд╛ рд╣реИред

рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдПрдХ **attacker** рдПрдХ **application supporting OAuth рдФрд░ Facebook рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП) рдЕрдкрдиреЗ рдРрдк рдореЗрдВ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред рдлрд┐рд░, рдПрдХ рдмрд╛рд░ рдЬрдм рдПрдХ рдкреАрдбрд╝рд┐рдд Facebook рдХреЗ рд╕рд╛рде **attacker рдХреЗ рдРрдк рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рддрд╛ рд╣реИ**, рддреЛ attacker **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ OAuth token рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЙрд╕рдХреЗ рдРрдк рдХреЛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдЗрд╕реЗ рдкреАрдбрд╝рд┐рдд рдХреЗ OAuth рдРрдк рдореЗрдВ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ token рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред

{% hint style="danger" %}
рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ attacker рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдкрдиреЗ OAuth рдРрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдЙрди рдРрдкреНрд╕ рдореЗрдВ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рдХреЛ рдЯреЗрдХрдУрд╡рд░ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛ рдЬреЛ token рдХреА рдЙрдореНрдореАрдж рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдирд╣реАрдВ рдЬрд╛рдВрдЪ рд░рд╣реЗ рд╣реИрдВ рдХрд┐ token рдЙрдирдХреЗ рдРрдк ID рдХреЛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред
{% endhint %}

### рджреЛ рд▓рд┐рдВрдХ рдФрд░ рдХреБрдХреА <a href="#bda5" id="bda5"></a>

[**рдЗрд╕ рд▓реЗрдЦ**](https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдпрд╣ рд╕рдВрднрд╡ рдерд╛ рдХрд┐ рдПрдХ рдкреАрдбрд╝рд┐рдд рдХреЛ рдПрдХ рдкреЗрдЬ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЬрд╛рдП рдЬрд┐рд╕рдореЗрдВ **returnUrl** attacker рдХреЗ рд╣реЛрд╕реНрдЯ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░ рд░рд╣рд╛ рд╣реЛред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА **рдХреБрдХреА (RU)** рдореЗрдВ **рд╕рдВрдЧреНрд░рд╣реАрдд** рдХреА рдЬрд╛рдПрдЧреА рдФрд░ **рдмрд╛рдж рдХреЗ рдЪрд░рдг рдореЗрдВ** **рдкреНрд░реЙрдореНрдкреНрдЯ** **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рд╕реЗ **рдкреВрдЫреЗрдЧрд╛** рдХрд┐ рдХреНрдпрд╛ рд╡рд╣ рдЙрд╕ attacker рдХреЗ рд╣реЛрд╕реНрдЯ рдХреЛ рдПрдХреНрд╕реЗрд╕ рджреЗрдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИред

рдЗрд╕ рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╕рдВрднрд╡ рдерд╛ рдХрд┐ рдПрдХ рдЯреИрдм рдЦреЛрд▓рдХрд░ **Oauth flow** рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЬрд╛рдП рдЬреЛ рдЗрд╕ RU рдХреБрдХреА рдХреЛ **returnUrl** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрдЯ рдХрд░реЗрдЧрд╛, рдкреНрд░реЙрдореНрдкреНрдЯ рджрд┐рдЦрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЯреИрдм рдХреЛ рдмрдВрдж рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдП, рдФрд░ рдмрд┐рдирд╛ рдЙрд╕ рдорд╛рди рдХреЗ рдПрдХ рдирдпрд╛ рдЯреИрдм рдЦреЛрд▓рд╛ рдЬрд╛рдПред рдлрд┐рд░, **рдкреНрд░реЙрдореНрдкреНрдЯ attacker рдХреЗ рд╣реЛрд╕реНрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрд┐рдд рдирд╣реАрдВ рдХрд░реЗрдЧрд╛**, рд▓реЗрдХрд┐рди рдХреБрдХреА рдЗрд╕реЗ рд╕реЗрдЯ рдХрд░ рджреЗрдЧреА, рдЗрд╕рд▓рд┐рдП **token рдХреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрд╢рди рдореЗрдВ attacker рдХреЗ рд╣реЛрд╕реНрдЯ рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛**ред

### рдкреНрд░реЙрдореНрдкреНрдЯ рдЗрдВрдЯрд░реИрдХреНрд╢рди рдмрд╛рдпрдкрд╛рд╕ <a href="#bda5" id="bda5"></a>

рдЬреИрд╕рд╛ рдХрд┐ [**рдЗрд╕ рд╡реАрдбрд┐рдпреЛ**](https://www.youtube.com/watch?v=n9x7\_J\_a\_7Q) рдореЗрдВ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдХреБрдЫ OAuth implementations **`prompt`** GET parameter рдХреЛ None (**`&prompt=none`**) рдХреЗ рд░реВрдк рдореЗрдВ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╡реЗрдм рдореЗрдВ рджрд┐рдП рдЧрдП рдПрдХреНрд╕реЗрд╕ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рдкреВрдЫрд╛ рдЬрд╛рдП** рдпрджрд┐ рд╡реЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдореЗрдВ рд▓реЙрдЧ рдЗрди рд╣реИрдВред

### response\_mode

рдЬреИрд╕рд╛ рдХрд┐ [**рдЗрд╕ рд╡реАрдбрд┐рдпреЛ**](https://www.youtube.com/watch?v=n9x7\_J\_a\_7Q) рдореЗрдВ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдпрд╣ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ parameter **`response_mode`** рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП рдХрд┐ рдЖрдк рдЕрдВрддрд┐рдо URL рдореЗрдВ рдХреЛрдб рдХрд╣рд╛рдБ рдЪрд╛рд╣рддреЗ рд╣реИрдВ:

* `response_mode=query` -> рдХреЛрдб рдПрдХ GET parameter рдХреЗ рдЕрдВрджрд░ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: `?code=2397rf3gu93f`
* `response_mode=fragment` -> рдХреЛрдб URL fragment parameter рдХреЗ рдЕрдВрджрд░ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ `#code=2397rf3gu93f`
* `response_mode=form_post` -> рдХреЛрдб рдПрдХ POST form рдХреЗ рдЕрдВрджрд░ рдПрдХ input рдХреЗ рд╕рд╛рде рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо `code` рдФрд░ рдорд╛рди рд╣реЛрддрд╛ рд╣реИ
* `response_mode=web_message` -> рдХреЛрдб рдПрдХ post message рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ: `window.opener.postMessage({"code": "asdasdasd...`

### SSRFs parameters <a href="#bda5" id="bda5"></a>

[**рдЗрд╕ рд╢реЛрдз рдХреЛ рджреЗрдЦреЗрдВ**](https://portswigger.net/research/hidden-oauth-attack-vectors) **рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рдФрд░ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдПред**

OAuth рдореЗрдВ Dynamic Client Registration рдПрдХ рдХрдо рд╕реНрдкрд╖реНрдЯ рд▓реЗрдХрд┐рди рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡реЗрдХреНрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ **Server-Side Request Forgery (SSRF)** рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдПред рдпрд╣ endpoint OAuth servers рдХреЛ client applications рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ URLs рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ exploited рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рдореБрдЦреНрдп рдмрд┐рдВрджреБ:**

* **Dynamic Client Registration** рдЕрдХреНрд╕рд░ `/register` рдкрд░ рдореИрдк рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ POST requests рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ `client_name`, `client_secret`, `redirect_uris`, рдФрд░ рд▓реЛрдЧреЛ рдпрд╛ JSON Web Key Sets (JWKs) рдХреЗ рд▓рд┐рдП URLs рдЬреИрд╕реЗ рд╡рд┐рд╡рд░рдг рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИред
* рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ **RFC7591** рдФрд░ **OpenID Connect Registration 1.0** рдореЗрдВ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╡рд┐рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ SSRF рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдХрдордЬреЛрд░ parameters рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
* рдкрдВрдЬреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдХрдИ рддрд░реАрдХреЛрдВ рд╕реЗ servers рдХреЛ SSRF рдХреЗ рд▓рд┐рдП рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддреА рд╣реИ:
* **`logo_uri`**: client application рдХреЗ рд▓реЛрдЧреЛ рдХреЗ рд▓рд┐рдП рдПрдХ URL рдЬрд┐рд╕реЗ server рджреНрд╡рд╛рд░рд╛ fetch рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, SSRF рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдпрджрд┐ URL рдХреЛ рдЧрд▓рдд рддрд░реАрдХреЗ рд╕реЗ рд╕рдВрднрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ XSS рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред
* **`jwks_uri`**: client рдХреЗ JWK рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рд▓рд┐рдП рдПрдХ URL, рдЬреЛ рдпрджрд┐ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд░реВрдк рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ server рдХреЛ рдПрдХ attacker-рдирд┐рдпрдВрддреНрд░рд┐рдд server рдкрд░ рдЖрдЙрдЯрдмрд╛рдЙрдВрдб requests рдХрд░рдиреЗ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред
* **`sector_identifier_uri`**: `redirect_uris` рдХреА рдПрдХ JSON array рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ server fetch рдХрд░ рд╕рдХрддрд╛ рд╣реИ, SSRF рдХрд╛ рдЕрд╡рд╕рд░ рдкреИрджрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
* **`request_uris`**: client рдХреЗ рд▓рд┐рдП рдЕрдиреБрдордд request URIs рдХреА рд╕реВрдЪреА, рдЬрд┐рд╕реЗ exploited рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ server рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЗрди URIs рдХреЛ fetch рдХрд░рддрд╛ рд╣реИред

**Exploitation Strategy:**

* SSRF рдХреЛ рдПрдХ рдирдП client рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд░рдХреЗ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ `logo_uri`, `jwks_uri`, рдпрд╛ `sector_identifier_uri` рдЬреИрд╕реЗ parameters рдореЗрдВ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг URLs рд╣реЛрддреЗ рд╣реИрдВред
* рдЬрдмрдХрд┐ `request_uris` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реАрдзреЗ exploitation рдХреЛ whitelist controls рджреНрд╡рд╛рд░рд╛ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдПрдХ рдкреВрд░реНрд╡-рдкрдВрдЬреАрдХреГрдд, attacker-рдирд┐рдпрдВрддреНрд░рд┐рдд `request_uri` рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдЪрд░рдг рдХреЗ рджреМрд░рд╛рди SSRF рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред

## OAuth providers Race Conditions

рдпрджрд┐ рдЖрдк рдЬрд┐рд╕ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░ рд░рд╣реЗ рд╣реИрдВ рд╡рд╣ рдПрдХ OAuth provider рд╣реИ [**рд╕рдВрднрд╛рд╡рд┐рдд Race Conditions рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдкрдврд╝реЗрдВ**](race-condition.md)ред

## References

* [**https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1**](https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1)
* [**https://portswigger.net/research/hidden-oauth-attack-vectors**](https://portswigger.net/research/hidden-oauth-attack-vectors)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS hacking рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк **HackTricks рдореЗрдВ рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**official PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреА hacking tricks рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
