# OAuth рд╕реЗ рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдирд╛

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PRs рдЬрдорд╛ рдХрд░рдХреЗред

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## рдореМрд▓рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА <a href="#d4a8" id="d4a8"></a>

OAuth рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд╕реНрдХрд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рдирдХреЗ рдореМрд▓рд┐рдХ рдЕрдВрд╢ [OAuth 2.0 рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг](https://oauth.net/2/) рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реИрдВред рдпрд╣ рдЪрд░реНрдЪрд╛ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рд╡реНрдпрд╛рдкрдХ рд░реВрдк рд╕реЗ рдкреНрд░рдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ [OAuth 2.0 рдЕрдзрд┐рдХрд╛рд░реАрдХрд░рдг рдХреЛрдб рдЧреНрд░рд╛рдВрдЯ рдкреНрд░рдХрд╛рд░](https://oauth.net/2/grant-types/authorization-code/) рдкрд░ рдХреЗрдВрджреНрд░рд┐рдд рд╣реИ, рдЬреЛ рдПрдХ **рдЕрдзрд┐рдХрд╛рд░реАрдХрд░рдг рдврд╛рдВрдЪрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЦрд╛рддреЗ рдкрд░ рдкрд╣реБрдВрдЪ рдпрд╛ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреЗ рдХреА рд╕реНрд╡реАрдХреГрддрд┐ рджреЗрддрд╛ рд╣реИ** (рдЕрдзрд┐рдХрд╛рд░реАрдХрд░рдг рд╕рд░реНрд╡рд░)ред

рдПрдХ рдХрд▓реНрдкрд┐рдд рд╡реЗрдмрд╕рд╛рдЗрдЯ _**https://example.com**_, рдЬрд┐рд╕реЗ **рдЖрдкрдХреЗ рд╕рднреА рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ рдкреЛрд╕реНрдЯреНрд╕ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**ред рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, OAuth 2.0 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред _https://example.com_ рдЖрдкрдХреА рдЕрдиреБрдорддрд┐ рдХреЗ рд▓рд┐рдП **рдЖрдкрдХреЗ рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ рдкреЛрд╕реНрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ** рдХреА рдЕрдиреБрд░реЛрдз рдХрд░реЗрдЧрд╛ред рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, _https://socialmedia.com_ рдкрд░ рдПрдХ рд╕рд╣рдорддрд┐ рд╕реНрдХреНрд░реАрди рдкреНрд░рдХрдЯ рд╣реЛрдЧреА, рдЬрд┐рд╕рдореЗрдВ **рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдЬреЛ рдорд╛рдВрдЧреА рдЬрд╛ рд░рд╣реА рд╣реИрдВ рдФрд░ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдбреЗрд╡рд▓рдкрд░** рдХрд╛ рд╡рд┐рд╡рд░рдг рд╣реЛрдЧрд╛ред рдЖрдкрдХреА рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрддрд┐ рдХреЗ рдмрд╛рдж, _https://example.com_ рдХреЛ **рдЖрдкрдХреЗ рдкреЛрд╕реНрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИ**ред

OAuth 2.0 рдврд╛рдВрдЪрд╛ рдХреЗ рднреАрддрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдШрдЯрдХреЛрдВ рдХреЛ рд╕рдордЭрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ:

- **рд╕рдВрд╕рд╛рдзрди рд╕реНрд╡рд╛рдореА**: рдЖрдк, рдЬреИрд╕реЗ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рд╕рдВрд╕реНрдерд╛**, рдЕрдкрдиреЗ рд╕рдВрд╕рд╛рдзрди, рдЬреИрд╕реЗ рдХрд┐ рдЖрдкрдХреЗ рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ рдЦрд╛рддреЗ рдХреЗ рдкреЛрд╕реНрдЯреНрд╕, рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЕрдзрд┐рдХреГрддрд┐ рджреЗрддреЗ рд╣реИрдВред
- **рд╕рдВрд╕рд╛рдзрди рд╕рд░реНрд╡рд░**: **рдкреНрд░рдорд╛рдгрд┐рдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╕рд░реНрд╡рд░** рдЬрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ `рд╕рдВрд╕рд╛рдзрди рд╕реНрд╡рд╛рдореА` рдХреЗ рдкрдХреНрд╖ рдореЗрдВ `рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди` рдкреНрд░рд╛рдкреНрдд рдХрд░ рд▓рд┐рдпрд╛ рд╣реЛ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, **https://socialmedia.com**ред
- **рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди**: `рд╕рдВрд╕рд╛рдзрди рд╕реНрд╡рд╛рдореА` рд╕реЗ рдЕрдзрд┐рдХреГрддрд┐ рдорд╛рдВрдЧрдиреЗ рд╡рд╛рд▓рд╛ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди**, рдЬреИрд╕реЗ рдХрд┐ **https://example.com**ред
- **рдЕрдзрд┐рдХрд░рдг рд╕рд░реНрд╡рд░**: `рд╕рдВрд╕рд╛рдзрди рд╕реНрд╡рд╛рдореА` рдХреА рд╕рдлрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдФрд░ рдЕрдзрд┐рдХрд░рдг рдХреЗ рдмрд╛рдж `рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди` рдХреЛ `рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди` рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ **рд╕рд░реНрд╡рд░**, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, **https://socialmedia.com**ред
- **client\_id**: рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ, рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ред
- **client\_secret:** рдПрдХ рдЧреЛрдкрдиреАрдп рдХреБрдВрдЬреА, рдЬрд┐рд╕реЗ рдХреЗрд╡рд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ рдЕрдзрд┐рдХрд░рдг рд╕рд░реНрд╡рд░ рдЬрд╛рдирддреЗ рд╣реИрдВ, `рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди` рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИред
- **response\_type**: `рдХреЛрдб` рдЬреИрд╕реЗ `рдЯреЛрдХрди рдХреЗ рдкреНрд░рдХрд╛рд░` рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдорд╛рдиред
- **scope**: `рд╕рдВрд╕рд╛рдзрди рд╕реНрд╡рд╛рдореА` рд╕реЗ `рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди` рджреНрд╡рд╛рд░рд╛ рдорд╛рдВрдЧреА рдЬрд╛ рд░рд╣реА **рдкрд╣реБрдВрдЪ рдХрд╛ рд╕реНрддрд░**ред
- **redirect\_uri**: **рдЙрд╕ URL рдХреЛ рдЬрд┐рд╕ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд╛рдж рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрд╣ рд╕рд╛рдорд╛рдиреНрдпрдд: рдкреВрд░реНрд╡-рдкрдВрдЬреАрдХреГрдд рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд URL рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
- **state**: рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдЬреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреЗ рдмреАрдЪ рдбреЗрдЯрд╛ рдХреЛ рдмрдирд╛рдП рд░рдЦрдиреЗ** рдХреЗ рд▓рд┐рдП рд╣реИред рдЗрд╕рдХреА рдЕрджреНрд╡рд┐рддреАрдпрддрд╛ CSRF рд╕рдВрд░рдХреНрд╖рдг рддрдВрддреНрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред
- **grant\_type**: **рдЧреНрд░рд╛рдВрдЯ рдкреНрд░рдХрд╛рд░ рдФрд░ рд╡рд╛рдкрд╕ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЯреЛрдХрди рдХреЗ рдкреНрд░рдХрд╛рд░** рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ред
- **code**: `рдЕрдзрд┐рдХрд░рдг рд╕рд░реНрд╡рд░` рд╕реЗ рдЕрдзрд┐рдХреГрддрд┐ рдХреЛрдб, рдЬрд┐рд╕реЗ `рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди` рджреНрд╡рд╛рд░рд╛ `рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `client_id` рдФрд░ `client_secret` рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **access\_token**: `рд╕рдВрд╕рд╛рдзрди рд╕реНрд╡рд╛рдореА` рдХреЗ рдкрдХреНрд╖ рд╕реЗ `рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди` рджреНрд╡рд╛рд░рд╛ API рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ **рдЯреЛрдХрди**ред
- **refresh\_token**: рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ **рдирдП `рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рд╕реНрд╡реАрдХреГрддрд┐ рджреЗрддрд╛ рд╣реИ рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдлрд┐рд░ рд╕реЗ рдкреНрд░рд╢реНрдирд┐рдд рдХрд┐рдП**ред

### рдлреНрд▓реЛ

**рд╡рд╛рд╕реНрддрд╡рд┐рдХ OAuth рдлреНрд▓реЛ** рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдЧреЗ рдмрдврд╝рддрд╛ рд╣реИ:

1. рдЖрдк [https://example.com](https://example.com) рдкрд░ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ "рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдг рдХрд░реЗрдВ" рдмрдЯрди рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВред
2. рдлрд┐рд░ рд╕рд╛рдЗрдЯ рдПрдХ рдЕрдиреБрдорддрд┐ рдХреЗ рд▓рд┐рдП рдЖрдкрд╕реЗ рдкреВрдЫрддреА рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЖрдкрдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП https://example.com рдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЖрдкрдХреЗ рдкреЛрд╕реНрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреА рдЪрд╛рд╣рд┐рдПред рдЕрдиреБрд░реЛрдз рдХрд╛ рд╕рдВрд░рдЪрдирд╛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ:
```
https://socialmedia.com/auth
?response_type=code
&client_id=example_clientId
&redirect_uri=https%3A%2F%2Fexample.com%2Fcallback
&scope=readPosts
&state=randomString123
```
3. рдлрд┐рд░ рдЖрдкрдХреЛ рд╕рд╣рдорддрд┐ рдкреГрд╖реНрда рдХреЗ рд╕рд╛рде рдкреЗрд╢ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

4. рдЖрдкрдХреА рдордВрдЬреВрд░реА рдХреЗ рдмрд╛рдж, рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ `redirect_uri` рдкрд░ `code` рдФрд░ `state` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рднреЗрдЬрддрд╛ рд╣реИ:
```
https://example.com?code=uniqueCode123&state=randomString123
```
5. https://example.com рдЗрд╕ `code` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рд╕рд╛рде рдЙрд╕рдХреЗ `client_id` рдФрд░ `client_secret`, рдЖрдкрдХреА рдУрд░ рд╕реЗ рдПрдХ `access_token` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЬрд┐рд╕рд╕реЗ рдЖрдкрдХреЛ рдЙрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдорд┐рд▓рддреА рд╣реИ рдЬрд┐рд╕рдХреА рдЖрдкрдиреЗ рд╕рд╣рдорддрд┐ рджреА рдереА:
```
POST /oauth/access_token
Host: socialmedia.com
...{"client_id": "example_clientId", "client_secret": "example_clientSecret", "code": "uniqueCode123", "grant_type": "authorization_code"}
```
6. рдЕрдВрдд рдореЗрдВ, рдкреНрд░рдХреНрд░рд┐рдпрд╛ https://example.com рдЖрдкрдХреЗ `access_token` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ Social Media рдХреЛ рдПрдкреАрдЖрдИ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреА рд╣реИ

## рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ <a href="#323a" id="323a"></a>

### рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ\_рдпреВрдЖрд░рдЖрдИ <a href="#cc36" id="cc36"></a>

`redirect_uri` OAuth рдФрд░ OpenID рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдиреЛрдВ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЕрдзрд┐рдХреГрддрд┐ рдХреЛрдб рдЬреИрд╕реА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдХреЛ рдкреЛрд╕реНрдЯ-рдЕрдзрд┐рдХреГрддрд┐ рдкреНрд░реЗрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдЧрд▓рддреА рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЖрдХреНрд░рдордгрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЗрди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рд╢реЛрдзрди рддрдХрдиреАрдХ рдЕрдзрд┐рдХреГрддрд┐ рд╕рд░реНрд╡рд░ рдХреА рдорд╛рдиреНрдпрддрд╛ рддрд░реНрдХ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИред рдпреЗ рдХрдард┐рди рдкрде рдореИрдЪрд┐рдВрдЧ рд╕реЗ рд▓реЗрдХрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдбреЛрдореЗрди рдпрд╛ рд╕рдмрдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреЗ рднреАрддрд░ рдХрд┐рд╕реА рднреА URL рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рддрдХ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рд╕рд╛рдорд╛рдиреНрдп рд╢реЛрдзрди рд╡рд┐рдзрд┐рдпреЛрдВ рдореЗрдВ рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреНрд╕, рдкрде рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓, рдХрдордЬреЛрд░ рд░реЗрдЬреЗрдХреНрд╕ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ, рдФрд░ рдЯреЛрдХрди рдЪреЛрд░реА рдХреЗ рд▓рд┐рдП рдПрдЪрдЯреАрдПрдордПрд▓ рдЗрдВрдЬреЗрдХреНрд╢рди рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

`redirect_uri` рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЕрдиреНрдп OAuth рдФрд░ OpenID рдкреИрд░рд╛рдореАрдЯрд░ рдЬреИрд╕реЗ `client_uri`, `policy_uri`, `tos_uri`, рдФрд░ `initiate_login_uri` рднреА рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИрдВред рдпреЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╣реИрдВ рдФрд░ рдЙрдирдХрд╛ рд╕рдорд░реНрдерди рд╕рд░реНрд╡рд░реНрд╕ рдХреЗ рдмреАрдЪ рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рдУрдкрдирдЖрдИрдбреА рд╕рд░реНрд╡рд░ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЛрдВ рдХреЗ рд▓рд┐рдП, рдбрд┐рд╕реНрдХрд╡рд░реА рдПрдВрдбрдкреЙрдЗрдВрдЯ (`**.well-known/openid-configuration**`) рдЕрдХреНрд╕рд░ рдореВрд▓реНрдпрд╡рд╛рди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рд╡рд░рдгреЛрдВ рдЬреИрд╕реЗ `registration_endpoint`, `request_uri_parameter_supported`, рдФрд░ "`require_request_uri_registration` рд╕реВрдЪреАрдд рдХрд░рддрд╛ рд╣реИред рдпреЗ рд╡рд┐рд╡рд░рдг рдкрдВрдЬреАрдХрд░рдг рдЕрдВрддрдмрд┐рдВрджреБ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЗ рдЕрдиреНрдп рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдПрдХреНрд╕рдПрд╕рдПрд╕ <a href="#bda5" id="bda5"></a>

рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ [https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html](https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html) рдРрд╕рд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ **URL рд╕рд░реНрд╡рд░ рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рд╣реЛ рд░рд╣рд╛ рд╣реЛ**, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд╛рдж, **рдПрдХреНрд╕рдПрд╕рдПрд╕ рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд▓реНрдк рд╣реЛ**ред рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рдкреЗрд▓реЛрдб:
```
https://app.victim.com/login?redirectUrl=https://app.victim.com/dashboard</script><h1>test</h1>
```
### CSRF - рд░рд╛рдЬреНрдп рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдЧрд▓рдд рд╣реИрдВрдбрд▓рд┐рдВрдЧ <a href="#bda5" id="bda5"></a>

OAuth рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдиреЛрдВ рдореЗрдВ, **`state` рдкреИрд░рд╛рдореАрдЯрд░** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдпрд╛ рдЙрдкреЗрдХреНрд╖рдг **рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдлрд╝реЙрд░реНрдЬрд╝рд░реА (CSRF)** рд╣рдорд▓реЛрдВ рдХреЗ рдЬреЛрдЦрд┐рдо рдХреЛ рдХрд╛рдлреА рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ рдЬрдм `state` рдкреИрд░рд╛рдореАрдЯрд░ рдпрд╛ рддреЛ **рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕реНрдерд┐рд░ рдорд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ CSRF рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЫрд▓рдирд╛ рджреЗрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред

рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕реЗ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░рдХреЗ рдЕрдзрд┐рдХрд╛рд░реА рдХреЗ рдЦрд╛рддреЗ рдХреЛ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХрд╛рд░реАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЕрдВрддрд░реНрд╡рд┐рд░рд╛рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд **рдЦрд╛рддрд╛ рдЕрдзрд┐рдХрд╛рд░** рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдРрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдореЗрдВ рдЧрдВрднреАрд░ рд╣реИ рдЬрд╣рд╛рдБ OAuth рдХрд╛ рдЙрдкрдпреЛрдЧ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЙрджреНрджреЗрд╢реНрдпреЛрдВ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ-рдЬреАрд╡рди рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рд╡рд┐рднрд┐рдиреНрди **CTF рдЪреИрд▓реЗрдВрдЬреЗрд╕** рдФрд░ **рд╣реИрдХрд┐рдВрдЧ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдореЛрдВ** рдореЗрдВ рджрд░реНрдЬ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЗрд╕рдХреЗ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдкреНрд░рднрд╛рд╡ рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрд╕ рдореБрджреНрджреЗ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рднреА **Slack**, **Stripe**, рдФрд░ **PayPal** рдЬреИрд╕реА рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдгреЛрдВ рддрдХ рдлреИрд▓рддрд╛ рд╣реИ, рдЬрд╣рд╛рдБ рд╣рдорд▓рд╛рд╡рд░ рд╕реВрдЪрдирд╛рдПрдВ рдпрд╛ рднреБрдЧрддрд╛рдиреЛрдВ рдХреЛ рдЕрдкрдиреЗ рдЦрд╛рддреЛрдВ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

**`state` рдкреИрд░рд╛рдореАрдЯрд░** рдХрд╛ рд╕рд╣реА рд╣реИрдВрдбрд▓рд┐рдВрдЧ рдФрд░ рд╕рддреНрдпрд╛рдкрди CSRF рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдФрд░ OAuth рдлреНрд▓реЛ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдПред

### рдкрд╣рд▓реЗ рдЦрд╛рддрд╛ рдЕрдзрд┐рдХрд╛рд░ <a href="#ebe4" id="ebe4"></a>

1. **рдЦрд╛рддрд╛ рдмрдирд╛рдиреЗ рдкрд░ рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдХреЗ рдмрд┐рдирд╛**: рд╣рдорд▓рд╛рд╡рд░ рдЕрдЧреНрд░рд┐рдо рд░реВрдк рд╕реЗ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рдИрдореЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЕрдЧрд░ рд╡рд┐рдХреНрдЯрд┐рдо рдмрд╛рдж рдореЗрдВ рд▓реЙрдЧрд┐рди рдХреЗ рд▓рд┐рдП рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЗрд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЧрд▓рддреА рд╕реЗ рдЗрд╕ рддреГрддреАрдп-рдкрдХреНрд╖ рдЦрд╛рддреЗ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╣рд▓реЗ рд╕реЗ рдмрдирд╛рдП рдЧрдП рдЦрд╛рддреЗ рд╕реЗ рдЬреЛрдбрд╝ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рд╣реЛ рд╕рдХрддреА рд╣реИред

2. **рд▓реИрдХреНрд╕ OAuth рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдХрд╛ рд╢реЛрд╖рдг**: рд╣рдорд▓рд╛рд╡рд░ OAuth рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдирд╣реАрдВ рдХрд░рддреА рд╣реИрдВ, рдЙрдирдХреА рд╕реЗрд╡рд╛ рдореЗрдВ рдкрдВрдЬреАрдХрд░рдг рдХрд░рдХреЗ рдФрд░ рдлрд┐рд░ рдЦрд╛рддреЗ рдХреЗ рдИрдореЗрд▓ рдХреЛ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рдИрдореЗрд▓ рдкрд░ рдмрджрд▓рдХрд░ред рдпрд╣ рд╡рд┐рдзрд┐ рдЕрдирдзрд┐рдХреГрдд рдЦрд╛рддреЗ рдЙрдкрдпреЛрдЧ рдХреА рддрд░рд╣ рдЕрдирдзрд┐рдХреГрдд рдЦрд╛рддреЗ рдкрд╣реБрдВрдЪ рдХрд╛ рдЦрддрд░рд╛ рдЙрдард╛рддреА рд╣реИ, рдкрд╣рд▓реЗ рд╕реНрдерд┐рддрд┐ рдХреЗ рдЕрдВрддрд░реНрд╡рд╛рд░реНрддрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред

### рд░рд╣рд╕реНрдпреЛрдВ рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ <a href="#e177" id="e177"></a>

рдЧреЛрдкрдиреАрдп OAuth рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред **`client_id`** рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдЦреБрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди **`client_secret`** рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬреЛрдЦрд┐рдо рд▓реЗрдХрд░ рдЖрддрд╛ рд╣реИред рдЕрдЧрд░ `client_secret` рдХрд╛ рд╕рдВрдХрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдЖрд╡реЗрджрди рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдХреЗ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `access_tokens`** рдФрд░ рдирд┐рдЬреА рд╕реВрдЪрдирд╛ рдЪреБрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЧрд▓рддреА рд╕реЗ рдЕрдзрд┐рдХрд╛рд░реА рддрд░рдл `access_token` рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХреГрддрд┐ `code` рдХрд╛ рд╡рд┐рдирд┐рдордп рд╕рдВрднрд╛рд▓рддреА рд╣реИ рдмрдЬрд╛рдп рд╕рд░реНрд╡рд░-рддрд░рдлред рдпрд╣ рдЧрд▓рддреА `client_secret` рдХрд╛ рдкреНрд░рдХрдЯ рд╣реЛрдиреЗ рдХрд╛ рдХрд╛рд░рдг рдмрдирддреА рд╣реИ, рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЖрд╡реЗрджрди рдХреЗ рд░реВрдк рдореЗрдВ `access_tokens` рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рд╕рд╛рдорд╛рдЬрд┐рдХ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рд╣рдорд▓рд╛рд╡рд░ OAuth рдЕрдзрд┐рдХреГрддрд┐ рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реНрдХреЛрдк рдЬреЛрдбрд╝рдХрд░ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЖрд╡реЗрджрди рдХреА рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╕реНрдерд┐рддрд┐ рдХрд╛ рдФрд░ рднреА рд╢реЛрд╖рдг рдХрд░рддреЗ рд╣реБрдПред

### рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реАрдХреНрд░реЗрдЯ рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕

рдЖрдк рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЗ **рдХреНрд▓рд╛рдЗрдВрдЯ_рд╕реАрдХреНрд░реЗрдЯ** рдХрд╛ **рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдкрд╣рдЪрд╛рди рдкреНрд░рджрд╛рддрд╛ рдХреЗ рд╕рд╛рде рдЦрд╛рддреЛрдВ рдХреА рдЪреЛрд░реА рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
BF рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ:
```
POST /token HTTP/1.1
content-type: application/x-www-form-urlencoded
host: 10.10.10.10:3000
content-length: 135
Connection: close

code=77515&redirect_uri=http%3A%2F%2F10.10.10.10%3A3000%2Fcallback&grant_type=authorization_code&client_id=public_client_id&client_secret=[bruteforce]
```
### Referer Header рд▓реАрдХ рдХреЛрдб + рд╕реНрдерд┐рддрд┐

рдЬрдм рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдкрд╛рд╕ **рдХреЛрдб рдФрд░ рд╕реНрдерд┐рддрд┐** рд╣реЛрддреА рд╣реИ, рдФрд░ рд╡рд╣ рдХрд┐рд╕реА рдЕрд▓рдЧ рдкреЗрдЬ рдкрд░ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░рддреЗ рд╕рдордп **Referer рд╣реЗрдбрд░ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рд╣реЛрддреА рд╣реИ**, рддреЛ рдпрд╣ рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдорд┐рдд рд╣реЛрддрд╛ рд╣реИред

### рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рд╕рдВрдЧреНрд░рд╣реАрдд

**рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рдЬрд╛рдПрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рд╡рд╣рд╛рдБ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ**ред

### рдЕрдирдВрдд рдЕрдзрд┐рдХреГрддрд┐ рдХреЛрдб

**рдЕрдзрд┐рдХреГрддрд┐ рдХреЛрдб рдХреЛ рдХреЗрд╡рд▓ рдХреБрдЫ рд╕рдордп рддрдХ рдЬреАрд╡рд┐рдд рд░рд╣рдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╣рдорд▓рд╛рд╡рд╛рд░ рдЙрд╕реЗ рдЪреБрд░рд╛ рдФрд░ рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗ** рдХрд╛ рд╕рдордп рдЦрд┐рдбрд╝рдХреА рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

### рдЕрдзрд┐рдХреГрддрд┐/рддрд╛рдЬрдЧреА рдЯреЛрдХрди рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдирд╣реАрдВ рдмрд╛рдБрдзрд╛ рдЧрдпрд╛

рдЕрдЧрд░ рдЖрдк **рдЕрдзрд┐рдХреГрддрд┐ рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ рдПрдХ рдЕрд▓рдЧ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рддреЛ рдЖрдк рдЕрдиреНрдп рдЦрд╛рддреЛрдВ рдХреЛ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВред

### рдЦреБрд╢ рдкрде, XSS, рдЖрдЗрдлреНрд░реЗрдореНрд╕ рдФрд░ рдкреЛрд╕реНрдЯ рдореИрд╕реЗрдЬреЗрд╕ рдХреЛрдб рдФрд░ рд╕реНрдерд┐рддрд┐ рдорд╛рдиреЛрдВ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП

**[рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ](https://labs.detectify.com/writeups/account-hijacking-using-dirty-dancing-in-sign-in-oauth-flows/#gadget-2-xss-on-sandbox-third-party-domain-that-gets-the-url)**

### AWS Cognito <a href="#bda5" id="bda5"></a>

рдЗрд╕ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ: [**https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/**](https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/) рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **AWS Cognito** рдЬреЛ рдЯреЛрдХрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╡рд╛рдкрд╕ рджреЗрддрд╛ рд╣реИ, рдЙрд╕рдореЗрдВ **рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рддрд╛рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░ рд╕рдХреЗ**ред рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рдЖрдк **рдПрдХ рдЕрд▓рдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдИрдореЗрд▓ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдИрдореЗрд▓ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рджреВрд╕рд░реЛрдВ рдХреЗ рдЦрд╛рддреЛрдВ рдХреЛ **рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ**ред
```bash
# Read info of the user
aws cognito-idp get-user --region us-east-1 --access-token eyJraWQiOiJPVj[...]

# Change email address
aws cognito-idp update-user-attributes --region us-east-1 --access-token eyJraWQ[...] --user-attributes Name=email,Value=imaginary@flickr.com
{
"CodeDeliveryDetailsList": [
{
"Destination": "i***@f***.com",
"DeliveryMedium": "EMAIL",
"AttributeName": "email"
}
]
}
```
### рдЕрдиреНрдп рдРрдкреНрд╕ рдЯреЛрдХрди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ <a href="#bda5" id="bda5"></a>

[**рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд**](https://salt.security/blog/oh-auth-abusing-oauth-to-take-over-millions-of-accounts) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдУрдЖрде рдлреНрд▓реЛ рдЬреЛ **рдЯреЛрдХрди** (рдФрд░ рди рдХреЛрдб) рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЙрдореНрдореАрдж рдХрд░рддреЗ рд╣реИрдВ, рд╡реЗ рд╕рдВрдХреЗрдд рдирд╣реАрдВ рдХрд░рддреЗ рдХрд┐ рдЯреЛрдХрди рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ, рд╡реЗ рд╕рдВрдХреЗрдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдпрджрд┐ рд╡реЗ рдпрд╣ рдирд╣реАрдВ рдЬрд╛рдВрдЪрддреЗ рдХрд┐ рдЯреЛрдХрди рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рд╣реИред

рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** рдПрдХ **рдУрдЖрде рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реА рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлреЗрд╕рдмреБрдХ рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП) рдЕрдкрдиреА рдЦреБрдж рдХреА рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВред рдлрд┐рд░, рдПрдХ рдмрд╛рд░ рдЬрдм рдПрдХ рдкреАрдбрд╝рд┐рдд рдлреЗрд╕рдмреБрдХ рдореЗрдВ **рд╣рдорд▓рд╛рд╡рд░ рдХреА рдРрдкреНрд▓рд┐рдХреЗрд╢рди** рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рддрд╛ рд╣реИ, рд╣рдорд▓рд╛рд╡рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ **рдУрдЖрде рдЯреЛрдХрди рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЙрд╕рдХреА рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреАрдбрд╝рд┐рдд рдУрдЖрде рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкреАрдбрд╝рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЯреЛрдХрди рд╣реИ**ред

{% hint style="danger" %}
рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдкрдиреА рдУрдЖрде рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓ рдЬрд╛рддреА рд╣реИ, рддреЛ рд╡рд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЦрд╛рддреЗ рдкрд░ рдХрдмреНрдЬрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рди рдРрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдЯреЛрдХрди рдХреА рд╣реИ рдФрд░ рдпрд╣ рдирд╣реАрдВ рдЬрд╛рдВрдЪрддреЗ рдХрд┐ рдХреНрдпрд╛ рдЯреЛрдХрди рдЙрдирдХреА рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдЖрдИрдбреА рдХреЛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдпрд╛ рдирд╣реАрдВред
{% endhint %}

### рджреЛ рд▓рд┐рдВрдХ рдФрд░ рдХреБрдХреА <a href="#bda5" id="bda5"></a>

[**рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд**](https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдПрдХ рдкреАрдбрд╝рд┐рдд рдХреЛ рдПрдХ рдкреГрд╖реНрда рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╡ рдерд╛ рдЬрд┐рд╕рдореЗрдВ рдПрдХ **returnUrl** рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╣реЛрд╕реНрдЯ рдХреА рдУрд░ рдкреНрд╡рд╛рдЗрдВрдЯ рдХрд░ рд░рд╣рд╛ рд╣реЛред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдПрдХ рдХреБрдХреА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрдЧреА (рдЖрд░рдпреВ) рдФрд░ рдПрдХ **рдмрд╛рдж рдореЗрдВ рдХрджрдо** рдореЗрдВ **рдкреНрд░реЙрдореНрдкреНрдЯ** **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдкреВрдЫреЗрдЧрд╛** рдХрд┐ рдХреНрдпрд╛ рд╡рд╣ рдЙрд╕ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╣реЛрд╕реНрдЯ рдХреЛ рдПрдХреНрд╕реЗрд╕ рджреЗрдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИред

рдЗрд╕ рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдРрд╕рд╛ рдУрдЖрде рдлреНрд▓реЛ рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреИрдм рдЦреЛрд▓рдирд╛ рд╕рдВрднрд╡ рдерд╛ рдЬреЛ рдЗрд╕ рдЖрд░рдпреВ рдХреБрдХреА рдХреЛ рд╕реЗрдЯ рдХрд░реЗрдЧрд╛ рдЙрд╕ **returnUrl** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдкреНрд░реЙрдореНрдкреНрдЯ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрдЧрд╛, рдФрд░ рдПрдХ рдирдпрд╛ рдЯреИрдм рдЦреЛрд▓реЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдЙрд╕ рдорд╛рди рдХреЗ рдмрд┐рдирд╛ред рдлрд┐рд░, **рдкреНрд░реЙрдореНрдкреНрдЯ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╣реЛрд╕реНрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрд┐рдд рдирд╣реАрдВ рдХрд░реЗрдЧрд╛**, рд▓реЗрдХрд┐рди рдХреБрдХреА рдЙрд╕реЗ рд╕реЗрдЯ рдХрд░ рджреЗрдЧреА, рдЗрд╕рд▓рд┐рдП **рдЯреЛрдХрди рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╣реЛрд╕реНрдЯ рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛** рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдореЗрдВред

### SSRF рдкреИрд░рд╛рдореАрдЯрд░ <a href="#bda5" id="bda5"></a>

**[рдЗрд╕ рдЕрдиреБрд╕рдВрдзрд╛рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ](https://portswigger.net/research/hidden-oauth-attack-vectors) рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдПред**

рдУрдЖрде рдореЗрдВ рдбрд╛рдпрдирд╛рдорд┐рдХ рдХреНрд▓рд╛рдЗрдВрдЯ рд░рдЬрд┐рд╕реНрдЯреНрд░реЗрд╢рди SSRF рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрдо рдЕрд╡рдзрд╛рд░рдгрд╛рддреНрдордХ рд▓реЗрдХрд┐рди рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡реЗрдХреНрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ **рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдлреЙрд░реНрдЬрд░реА (SSRF)** рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдПред рдЗрд╕ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреА рдУрдЖрде рд╕рд░реНрд╡рд░ рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдпреВрдЖрд░рдПрд▓ рдЬрд┐рдиреНрд╣реЗрдВ рд╢реЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рдореБрдЦреНрдп рдмрд┐рдВрджреБ:**

- **рдбрд╛рдпрдирд╛рдорд┐рдХ рдХреНрд▓рд╛рдЗрдВрдЯ рд░рдЬрд┐рд╕реНрдЯреНрд░реЗрд╢рди** рдЕрдХреНрд╕рд░ `/рд░рдЬрд┐рд╕реНрдЯрд░` рдХреЗ рд▓рд┐рдП рдореИрдк рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ `client_name`, `client_secret`, `redirect_uris`, рдФрд░ рд▓реЛрдЧреЛ рдпрд╛ рдЬреЗрд╕рди рд╡реЗрдм рдХреБрдВрдЬ (JWKs) рдХреЗ рд▓рд┐рдП рдпреВрдЖрд░рдПрд▓ рдЬреИрд╕реЗ рд╡рд┐рд╡рд░рдг рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ POST рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред
- рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ **RFC7591** рдФрд░ **OpenID Connect Registration 1.0** рдореЗрдВ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╡рд┐рдирд┐рдордпреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ SSRF рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рдмрд╛рдзрд╛рдкреВрд░реНрдг рдкреИрд░рд╛рдореАрдЯрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
- рдкрдВрдЬреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрдИ рддрд░реАрдХреЛрдВ рд╕реЗ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рд╕рд░реНрд╡рд░ рдХреЛ SSRF рдХреЗ рд▓рд┐рдП рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддреА рд╣реИ:
- **`logo_uri`**: рдХреНрд▓рд╛рдЗрдВрдЯ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓реЛрдЧреЛ рдХреЗ рд▓рд┐рдП рдПрдХ URL рдЬреЛ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, SSRF рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдпрджрд┐ рдпреВрдЖрд░рдПрд▓ рдХреЛ рдЧрд▓рдд рдврдВрдЧ рд╕реЗ рд╕рдВрднрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ XSS рдореЗрдВ рд▓реЗ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- **`jwks_uri`**: рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ JWK рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рд▓рд┐рдП рдПрдХ URL, рдЬреЛ рдпрджрд┐ рджреБрд░реБрдкрдпреЛрдЧ рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕рд░реНрд╡рд░ рдХреЛ рдЖрдЙрдЯрдмрд╛рдЙрдВрдб рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рд░рдг рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред
- **`sector_identifier_uri`**: `redirect_uris` рдХреЗ рдПрдХ JSON рдЕрд░реНрд░рд╛рдп рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╕рд░реНрд╡рд░ рд╢реЛрд╖рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдПрдХ SSRF рдЕрд╡рд╕рд░ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред
- **`request_uris`**: рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдордд рдЕрдиреБрд░реЛрдз рдпреВрдЖрд░рдЖрдИ рдХреА рд╕реВрдЪреА, рдЬрд┐рд╕реЗ рдпрджрд┐ рд╕рд░реНрд╡рд░ рдЕрдзрд┐рдХреГрдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЙрди рдпреВрдЖрд░рдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рджреМрд░рд╛рди SSRF рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рд╢реЛрд╖рдг рд░рдгрдиреАрддрд┐:**

- SSRF рдХреЛ рдирдП рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рджрд░реНрдЬ рдХрд░рдХреЗ рд╡рд┐рдирд╛рд╢рдХрд╛рд░реА рдпреВрдЖрд░рдПрд▓ рдХреЗ рд╕рд╛рде рдкреИрд░рд╛рдореАрдЯрд░ рдЬреИрд╕реЗ `logo_uri`, `jwks_uri`, рдпрд╛ `sector_identifier_uri` рдореЗрдВ рджрд░реНрдЬ рдХрд░рдХреЗ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- `request_uris` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реАрдзрд╛ рд╢реЛрд╖рдг рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рд╕рд░реНрд╡рд░ рдЕрдзрд┐рдХреГрдд рдХрдВрдЯреНрд░реЛрд▓реНрд╕ рдХреЗ рджреНрд╡рд╛рд░рд╛ рд░реЛрдХрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рдкреВрд░реНрд╡-рдкрдВрдЬреАрдХреГрдд, рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд `request_uri` рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рд╕реЗ рдЕрдзрд┐рдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЪрд░рдг рдХреЗ рджреМрд░рд╛рди SSRF рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред
