# OAuth рд╕реЗ рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдирд╛

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдореМрд▓рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА <a href="#d4a8" id="d4a8"></a>

OAuth рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд╕реНрдХрд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рдирдХреЗ рдореМрд▓рд┐рдХ рдЕрдВрд╢ [OAuth 2.0 рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг](https://oauth.net/2/) рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реИрдВред рдпрд╣ рдЪрд░реНрдЪрд╛ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рд╡реНрдпрд╛рдкрдХ рд░реВрдк рд╕реЗ рдкреНрд░рдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ [OAuth 2.0 рдЕрдзрд┐рдХрд╛рд░реАрдХрд░рдг рдХреЛрдб рдЧреНрд░рд╛рдВрдЯ рдкреНрд░рдХрд╛рд░](https://oauth.net/2/grant-types/authorization-code/) рдкрд░ рдХреЗрдВрджреНрд░рд┐рдд рд╣реИ, рдЬреЛ рдПрдХ **рдЕрдзрд┐рдХрд╛рд░реАрдХрд░рдг рдврд╛рдВрдЪрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдПрдХ рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдпрд╛ рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ** (рдЕрдзрд┐рдХрд╛рд░реАрдХрд░рдг рд╕рд░реНрд╡рд░)ред

рдПрдХ рдХрд▓реНрдкрд┐рдд рд╡реЗрдмрд╕рд╛рдЗрдЯ _**https://example.com**_, рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╣реИ **рдЖрдкрдХреЗ рд╕рднреА рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ рдкреЛрд╕реНрдЯреНрд╕ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдирд╛**, рдХреЛ рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП OAuth 2.0 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред _https://example.com_ рдЖрдкрдХреА рдЕрдиреБрдорддрд┐ **рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ рдкреЛрд╕реНрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ** рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд░реЗрдЧрд╛ред рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, _https://socialmedia.com_ рдкрд░ рдПрдХ рд╕рд╣рдорддрд┐ рд╕реНрдХреНрд░реАрди рдкреНрд░рдХрдЯ рд╣реЛрдЧреА, рдЬрд┐рд╕рдореЗрдВ **рдЕрдиреБрдорддрд┐ рдХреА рдЬрд╛ рд░рд╣реА рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдФрд░ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдбреЗрд╡рд▓рдкрд░** рдХрд╛ рд╡рд┐рд╡рд░рдг рд╣реЛрдЧрд╛ред рдЖрдкрдХреА рдЕрдзрд┐рдХреГрддрд┐ рдХреЗ рдмрд╛рдж, _https://example.com_ рдХреЛ **рдЖрдкрдХреЗ рдкреЛрд╕реНрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИ**ред

OAuth 2.0 рдврд╛рдВрдЪрд╛ рдХреЗ рднреАрддрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдШрдЯрдХреЛрдВ рдХреЛ рд╕рдордЭрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ:

- **рд╕рдВрд╕рд╛рдзрди рд╕реНрд╡рд╛рдореА**: рдЖрдк, рдЬреИрд╕рд╛ рдХрд┐ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рд╕рдВрд╕реНрдерд╛**, рдЕрдкрдиреЗ рд╕рдВрд╕рд╛рдзрди рдЬреИрд╕реЗ рдХрд┐ рдЖрдкрдХреЗ рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ рдЦрд╛рддреЗ рдХреЗ рдкреЛрд╕реНрдЯреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЕрдзрд┐рдХреГрддрд┐ рджреЗрддреЗ рд╣реИрдВред
- **рд╕рдВрд╕рд╛рдзрди рд╕рд░реНрд╡рд░**: **рдкреНрд░рдорд╛рдгрд┐рдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╕рд░реНрд╡рд░** рдЬрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ `рд╕рдВрд╕рд╛рдзрди рд╕реНрд╡рд╛рдореА` рдХреЗ рдкрдХреНрд╖ рдореЗрдВ `рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди` рдкреНрд░рд╛рдкреНрдд рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ **https://socialmedia.com**ред
- **рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди**: `рд╕рдВрд╕рд╛рдзрди рд╕реНрд╡рд╛рдореА` рд╕реЗ рдЕрдзрд┐рдХреГрддрд┐ рдорд╛рдВрдЧрдиреЗ рд╡рд╛рд▓реА **рдПрдкреНрд▓рд┐рдХреЗрд╢рди**, рдЬреИрд╕реЗ рдХрд┐ **https://example.com**ред
- **рдЕрдзрд┐рдХрд░рдг рд╕рд░реНрд╡рд░**: `рд╕рдВрд╕рд╛рдзрди рд╕реНрд╡рд╛рдореА` рдХреА рд╕рдлрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдФрд░ рдЕрдзрд┐рдХрд░рдг рдкреНрд░рд╛рдкреНрддрд┐ рдХреЗ рдмрд╛рдж `рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди` рдХреЛ `рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди` рдЬрд╛рд░реА рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ **рд╕рд░реНрд╡рд░**, рдЬреИрд╕реЗ рдХрд┐ **https://socialmedia.com**ред
- **client\_id**: рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ, рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ред
- **client\_secret:** рдПрдХ рдЧреЛрдкрдиреАрдп рдХреБрдВрдЬреА, рдЬрд┐рд╕реЗ рдХреЗрд╡рд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ рдЕрдзрд┐рдХрд░рдг рд╕рд░реНрд╡рд░ рдЬрд╛рдирддреЗ рд╣реИрдВ, `рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди` рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИред
- **response\_type**: `рдХреЛрдб` рдЬреИрд╕реЗ `рдЯреЛрдХрди` рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдорд╛рдиред
- **scope**: `рд╕рдВрд╕рд╛рдзрди рд╕реНрд╡рд╛рдореА` рд╕реЗ `рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди` рджреНрд╡рд╛рд░рд╛ рдорд╛рдВрдЧреА рдЬрд╛ рд░рд╣реА **рдкрд╣реБрдВрдЪ рдХрд╛ рд╕реНрддрд░**ред
- **redirect\_uri**: рдЙрд╕ URL рдХреЛ рдЬрд┐рд╕ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдзрд┐рдХреГрддрд┐ рдкреНрд░рд╛рдкреНрддрд┐ рдХреЗ рдмрд╛рдж рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рд╕рд╛рдорд╛рдиреНрдпрдд: рдкреВрд░реНрд╡-рдкрдВрдЬреАрдХреГрдд рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд URL рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
- **state**: рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдЬреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреЗ рдмреАрдЪ рдбреЗрдЯрд╛ рдХреЛ рдмрдирд╛рдП рд░рдЦрдиреЗ** рдХреЗ рд▓рд┐рдП рд╣реИред рдЗрд╕рдХреА рдЕрджреНрд╡рд┐рддреАрдпрддрд╛ CSRF рд╕рдВрд░рдХреНрд╖рдг рддрдВрддреНрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрд╡рд╛рдирд┐рд╡реГрддреНрдд рд╣реИред
- **grant\_type**: **рдЧреНрд░рд╛рдВрдЯ рдкреНрд░рдХрд╛рд░ рдФрд░ рд╡рд╛рдкрд╕ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЯреЛрдХрди рдХреЗ рдкреНрд░рдХрд╛рд░** рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдкреИрд░рд╛рдореАрдЯрд░ред
- **code**: `рдЕрдзрд┐рдХрд░рдг рд╕рд░реНрд╡рд░` рд╕реЗ рдЕрдзрд┐рдХреГрддрд┐ рдХреЛрдб, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ `рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди` рджреНрд╡рд╛рд░рд╛ `рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `client_id` рдФрд░ `client_secret` рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **access\_token**: `рд╕рдВрд╕рд╛рдзрди рд╕реНрд╡рд╛рдореА` рдХреЗ рдкрдХреНрд╖ рд╕реЗ `рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди` рджреНрд╡рд╛рд░рд╛ API рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ **рдЯреЛрдХрди**ред
- **refresh\_token**: рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдлрд┐рд░ рд╕реЗ рдкреНрд░рд╢реНрди рди рдХрд░рддреЗ рд╣реБрдП рдирдП `рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рд╕реНрд╡реАрдХреГрддрд┐ рджреЗрддрд╛ рд╣реИ**ред

### рдкреНрд░рд╡рд╛рд╣

**рд╡рд╛рд╕реНрддрд╡рд┐рдХ OAuth рдкреНрд░рд╡рд╛рд╣** рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдЧреЗ рдмрдврд╝рддрд╛ рд╣реИ:

1. рдЖрдк [https://example.com](https://example.com) рдкрд░ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ "рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдг рдХрд░реЗрдВ" рдмрдЯрди рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВред
2. рдлрд┐рд░ рд╕рд╛рдЗрдЯ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрддреА рд╣реИ [https://socialmedia.com](https://socialmedia.com) рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХреА рдЕрдзрд┐рдХреГрддрд┐ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ https://example.com рдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЖрдкрдХреЗ рдкреЛрд╕реНрдЯ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВред рдЕрдиреБрд░реЛрдз рдХрд╛ рдврд╛рдВрдЪрд╛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ:
```
https://socialmedia.com/auth
?response_type=code
&client_id=example_clientId
&redirect_uri=https%3A%2F%2Fexample.com%2Fcallback
&scope=readPosts
&state=randomString123
```
3. рдлрд┐рд░ рдЖрдкрдХреЛ рдПрдХ рд╕рд╣рдорддрд┐ рдкреГрд╖реНрда рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

4. рдЖрдкрдХреЗ рд╕реНрд╡реАрдХреГрддрд┐ рдХреЗ рдмрд╛рдж, рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ `redirect_uri` рдкрд░ `code` рдФрд░ `state` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рднреЗрдЬрддрд╛ рд╣реИ:
```
https://example.com?code=uniqueCode123&state=randomString123
```
5. https://example.com рдЗрд╕ `code` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЖрдкрдХреЗ рдкрдХреНрд╖ рдореЗрдВ рдПрдХ `access_token` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдЕрдиреБрд░реЛрдз рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕рдХреЗ `client_id` рдФрд░ `client_secret` рдХреЗ рд╕рд╛рде, рдЬрд┐рд╕рд╕реЗ рдЖрдкрдХреЛ рдЙрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рд╕реНрд╡реАрдХреГрддрд┐ рдорд┐рд▓реА рдереА:
```
POST /oauth/access_token
Host: socialmedia.com
...{"client_id": "example_clientId", "client_secret": "example_clientSecret", "code": "uniqueCode123", "grant_type": "authorization_code"}
```
6. рдЕрдВрдд рдореЗрдВ, рдкреНрд░рдХреНрд░рд┐рдпрд╛ https://example.com рдЖрдкрдХреЗ `access_token` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ Social Media рдХреЛ рдПрдкреАрдЖрдИ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреА рд╣реИ

## рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ <a href="#323a" id="323a"></a>

### рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ\_рдпреВрдЖрд░рдЖрдИ <a href="#cc36" id="cc36"></a>

`redirect_uri` OAuth рдФрд░ OpenID рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдиреЛрдВ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЕрдзрд┐рдХреГрддрд┐ рдХреЛрдб рдЬреИрд╕реА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдХреЛ рдкреЛрд╕реНрдЯ-рдЕрдзрд┐рдХреГрддрд┐ рдореЗрдВ рднреЗрдЬрддрд╛ рд╣реИред рдпрджрд┐ рдЧрд▓рддреА рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЖрдХреНрд░рдордгрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЗрди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рд╕рд░реНрд╡рд░реЛрдВ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рд╢реЛрдзрди рддрдХрдиреАрдХ рдЕрдзрд┐рдХреГрддрд┐ рд╕рд░реНрд╡рд░ рдХреА рдорд╛рдиреНрдпрддрд╛ рддрд░реНрдХ рдкрд░ рднрд┐рдиреНрди рд╣реЛрддреА рд╣реИред рдпреЗ рдХрдард┐рди рдкрде рдореИрдЪрд┐рдВрдЧ рд╕реЗ рд▓реЗрдХрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдбреЛрдореЗрди рдпрд╛ рд╕рдмрдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреЗ рднреАрддрд░ рдХрд┐рд╕реА рднреА URL рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рддрдХ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рд╕рд╛рдорд╛рдиреНрдп рд╢реЛрдзрди рд╡рд┐рдзрд┐рдпреЛрдВ рдореЗрдВ рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреНрд╕, рдкрде рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓, рдХрдордЬреЛрд░ рд░реЗрдЬреЗрдХреНрд╕ рдХрд╛ рд╢реЛрдзрди, рдФрд░ рдЯреЛрдХрди рдЪреЛрд░реА рдХреЗ рд▓рд┐рдП HTML рдЗрдиреНрдЬреЗрдХреНрд╢рди рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

`redirect_uri` рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЕрдиреНрдп OAuth рдФрд░ OpenID рдкреИрд░рд╛рдореАрдЯрд░ рдЬреИрд╕реЗ `client_uri`, `policy_uri`, `tos_uri`, рдФрд░ `initiate_login_uri` рднреА рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИрдВред рдпреЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╣реИрдВ рдФрд░ рдЙрдирдХрд╛ рд╕рдорд░реНрдерди рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рдмреАрдЪ рднрд┐рдиреНрди рд╣реЛрддрд╛ рд╣реИред

рдУрдкрдирдЖрдИрдбреА рд╕рд░реНрд╡рд░ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЛрдВ рдХреЗ рд▓рд┐рдП, рдбрд┐рд╕реНрдХрд╡рд░реА рдПрдВрдбрдкреЙрдЗрдВрдЯ (`**.well-known/openid-configuration**`) рдЕрдХреНрд╕рд░ рдореВрд▓реНрдпрд╡рд╛рди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рд╡рд░рдгреЛрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ `registration_endpoint`, `request_uri_parameter_supported`, рдФрд░ "`require_request_uri_registrationред рдпреЗ рд╡рд┐рд╡рд░рдг рдкрдВрдЬреАрдХрд░рдг рдЕрдВрддрдмрд┐рдВрджреБ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЗ рдЕрдиреНрдп рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ XSS <a href="#bda5" id="bda5"></a>

рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд░рд┐рдкреЛрд░реНрдЯ [https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html](https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html) рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рд╣реИ, рд╢рд╛рдпрдж рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░рдорд╛рдгреАрдХреГрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рд╕рд░реНрд╡рд░ рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ **URL рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рд╣реЛ рд░рд╣рд╛ рд╣реЛ**, **XSS рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд┐рдд рди рд╣реЛ**ред рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рдкреЗрд▓реЛрдб:
```
https://app.victim.com/login?redirectUrl=https://app.victim.com/dashboard</script><h1>test</h1>
```
### CSRF - рд░рд╛рдЬреНрдп рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдЧрд▓рдд рд╣реИрдВрдбрд▓рд┐рдВрдЧ <a href="#bda5" id="bda5"></a>

OAuth рдХреЗ рдЕрдорд▓рди рдореЗрдВ, **`state` рдкреИрд░рд╛рдореАрдЯрд░** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдпрд╛ рдЙрд╕рдХреА рдЕрдирджреЗрдЦреА **рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдлреЙрд░реНрдЬрд░реА (CSRF)** рд╣рдорд▓реЛрдВ рдХреЗ рдЬреЛрдЦрд┐рдо рдХреЛ рдХрд╛рдлреА рдмрдврд╝рд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдХрдордЬреЛрд░реА рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм `state` рдкреИрд░рд╛рдореАрдЯрд░ рдпрд╛ рддреЛ **рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕реНрдерд┐рд░ рдорд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд╛рд░ CSRF рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЫрд▓рдирд╛ рдорд┐рд▓рддрд╛ рд╣реИред

рд╣рдорд▓рд╛рд╡рд░ рдЕрдзрд┐рдХрд╛рд░рд┐рдпреЛрдВ рдХреЛ рдЗрд╕рдХрд╛ рд╢рд┐рдХрд╛рд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХреГрддреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЕрдВрддрд░реНрд╡рд┐рд░реЛрдз рдХрд░рдХреЗ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд **рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓** рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдЬрдм OAuth рдХрд╛ рдЙрдкрдпреЛрдЧ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЙрджреНрджреЗрд╢реНрдпреЛрдВ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрд╕ рдХрдордЬреЛрд░реА рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ-рдЬреАрд╡рди рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рд╡рд┐рднрд┐рдиреНрди **CTF рдЪреИрд▓реЗрдВрдЬреЗрд╕** рдФрд░ **рд╣реИрдХрд┐рдВрдЧ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдореЛрдВ** рдореЗрдВ рджрд░реНрдЬ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЗрд╕рдХреЗ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдкреНрд░рднрд╛рд╡ рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рд╕рдорд╕реНрдпрд╛ **Slack**, **Stripe**, рдФрд░ **PayPal** рдЬреИрд╕реА рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдгреЛрдВ рддрдХ рдлреИрд▓рддреА рд╣реИ, рдЬрд╣рд╛рдВ рд╣рдорд▓рд╛рд╡рд░ рд╕реВрдЪрдирд╛рдПрдВ рдпрд╛ рднреБрдЧрддрд╛рдиреЛрдВ рдХреЛ рдЕрдкрдиреЗ рдЦрд╛рддреЛрдВ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

**`state` рдкреИрд░рд╛рдореАрдЯрд░** рдХрд╛ рдЙрдЪрд┐рдд рд╣реИрдВрдбрд▓рд┐рдВрдЧ рдФрд░ рд╕рддреНрдпрд╛рдкрди CSRF рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдиреЗ рдФрд░ OAuth рдлреНрд▓реЛ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред

### рдкрд╣рд▓реЗ рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдирд╛ <a href="#ebe4" id="ebe4"></a>

1. **рдЦрд╛рддрд╛ рдмрдирд╛рдиреЗ рдкрд░ рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдХреЗ рдмрд┐рдирд╛**: рд╣рдорд▓рд╛рд╡рд░ рдкреАрдбрд╝рд┐рдд рдХреЗ рдИрдореЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╣рд▓реЗ рд╣реА рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЕрдЧрд░ рдкреАрдбрд╝рд┐рдд рдмрд╛рдж рдореЗрдВ рд▓реЙрдЧрд┐рди рдХреЗ рд▓рд┐рдП рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЗрд╡рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЗрд╕ рддреГрддреАрдп-рдкрдХреНрд╖ рдЦрд╛рддреЗ рдХреЛ рдЕрдирдзрд┐рдХреГрдд рд░реВрдк рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╣рд▓реЗ рд╕реЗ рдмрдирд╛рдП рдЧрдП рдЦрд╛рддреЗ рд╕реЗ рдЬреЛрдбрд╝ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рд╣реЛ рд╕рдХрддреА рд╣реИред

2. **рд▓реИрдХреНрд╕ OAuth рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдХрд╛ рд╢реЛрд╖рдг**: рд╣рдорд▓рд╛рд╡рд░ OAuth рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдирд╣реАрдВ рдХрд░рддреА рд╣реИрдВ, рдЙрдирдХреА рд╕реЗрд╡рд╛ рдореЗрдВ рдкрдВрдЬреАрдХрд░рдг рдХрд░рдХреЗ рдФрд░ рдлрд┐рд░ рдЦрд╛рддреЗ рдХрд╛ рдИрдореЗрд▓ рдкреАрдбрд╝рд┐рдд рдХреЗ рдирд╛рдо рдкрд░ рдмрджрд▓рдХрд░ред рдпрд╣ рд╡рд┐рдзрд┐ рдкрд╣рд▓реЗ рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рдорд╛рди рдЕрдирдзрд┐рдХреГрдд рдЦрд╛рддреЗ рддрдХ рдкрд╣реБрдВрдЪ рдХрд╛ рдЦрддрд░рд╛ рдЙрдард╛рддреА рд╣реИ, рдкрд╣рд▓реЗ рдХреЗ рд╕реНрдерд┐рддрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реЗрдХрд┐рди рдПрдХ рд╡рд┐рднрд┐рдиреНрди рд╣рдорд▓рд╛ рд╡реЗрдХреНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред

### рд░рд╣рд╕реНрдпреЛрдВ рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ <a href="#e177" id="e177"></a>

рд░рд╣рд╕реНрдпрдордп OAuth рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдЬрдмрдХрд┐ **`client_id`** рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдЦреБрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, **`client_secret`** рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬреЛрдЦрд┐рдо рд▓реЗрдХрд░ рдЖрддрд╛ рд╣реИред рдЕрдЧрд░ `client_secret` рдХрд╛ рд╕рдВрдХрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `access_tokens` рдФрд░ рдирд┐рдЬреА рдЬрд╛рдирдХрд╛рд░реА рдЪреБрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдХрдордЬреЛрд░реА рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЧрд▓рддреА рд╕реЗ рдЕрдзрд┐рдХреГрддреАрдХрд░рдг `code` рдХрд╛ рд╡рд┐рдирд┐рдордп рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдкрд░ рдЕрдзрд┐рдХреГрдд рдХрд░рддреА рд╣реИ рдмрдЬрд╛рдп рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдкрд░ред рдпрд╣ рдЧрд▓рддреА `client_secret` рдХрд╛ рдкреНрд░рдХрдЯ рд╣реЛрдиреЗ рдХрд╛ рдХрд╛рд░рдг рдмрдирддреА рд╣реИ, рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `access_tokens` рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдирд╛рдо рдореЗрдВред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рд╕рд╛рдорд╛рдЬрд┐рдХ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рд╣рдорд▓рд╛рд╡рд░ OAuth рдЕрдзрд┐рдХреГрддреАрдХрд░рдг рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реНрдХреЛрдк рдЬреЛрдбрд╝рдХрд░ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рд╕реНрдерд┐рддрд┐ рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реАрдХреНрд░реЗрдЯ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕

рдЖрдк рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЗ **рдХреНрд▓рд╛рдЗрдВрдЯ_рд╕реАрдХреНрд░реЗрдЯ** рдХрд╛ **рдмреНрд░реВрдЯрдлреЛрд░реНрд╕** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЖрдИрдбреЗрдВрдЯрд┐рдЯреА рдкреНрд░рджрд╛рддрд╛ рдХреЗ рд╕рд╛рде рдЦрд╛рддреЛрдВ рдХреЛ рдЪреБрд░рд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛ рд╕рдХрддреА рд╣реИред\
BF рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ:
```
POST /token HTTP/1.1
content-type: application/x-www-form-urlencoded
host: 10.10.10.10:3000
content-length: 135
Connection: close

code=77515&redirect_uri=http%3A%2F%2F10.10.10.10%3A3000%2Fcallback&grant_type=authorization_code&client_id=public_client_id&client_secret=[bruteforce]
```
### Referer Header leaking Code + State

рдЬрдм рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдкрд╛рд╕ **рдХреЛрдб рдФрд░ рд╕реНрдерд┐рддрд┐** рд╣реЛрддреА рд╣реИ, рдФрд░ рдпрджрд┐ рд╡рд╣ рдХрд┐рд╕реА рдЕрд▓рдЧ рдкреГрд╖реНрда рдкрд░ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░рддреЗ рд╕рдордп **рд░реЗрдлрд░рд░ рд╣реЗрдбрд░ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рд╣реЛрддреА рд╣реИ**, рддреЛ рдпрд╣ рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдорд┐рдд рд╣реИред

### Access Token Stored in Browser History

**рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рдЬрд╛рдПрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рд╡рд╣рд╛рдВ рд╕рд╣реЗрдЬрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ**ред

### Everlasting Authorization Code

**рдЕрдзрд┐рдХреГрддреА рдХреЛрдб рдХреЛ рдХреЗрд╡рд▓ рдХреБрдЫ рд╕рдордп рддрдХ рдЬреАрд╡рд┐рдд рд░рд╣рдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕реЗ рдЪреБрд░рд╛ рдФрд░ рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗ** рдХреЗ рд╕рдордп рдЦрд┐рдбрд╝рдХреА рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

### Authorization/Refresh Token not bound to client

рдпрджрд┐ рдЖрдк **рдЕрдзрд┐рдХреГрддреА рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕реЗ рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЕрдиреНрдп рдЦрд╛рддреЛрдВ рдХреЛ рдЕрдзрд┐рдХреГрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

### Happy Paths, XSS, Iframes & Post Messages to leak code & state values

**[рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ](https://labs.detectify.com/writeups/account-hijacking-using-dirty-dancing-in-sign-in-oauth-flows/#gadget-2-xss-on-sandbox-third-party-domain-that-gets-the-url)**

### AWS Cognito <a href="#bda5" id="bda5"></a>

рдЗрд╕ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ: [**https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/**](https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/) рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **AWS Cognito** рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╡рд╛рдкрд╕ рджреЗрддрд╛ рд╣реИ, рдЙрд╕рдореЗрдВ **рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рддрд╛рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░ рд╕рдХреЗ**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдИрдореЗрд▓ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдИрдореЗрд▓ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рджреВрд╕рд░реЛрдВ рдХреЗ рдЦрд╛рддреЛрдВ рдХреЛ **рдЕрдзрд┐рдХреГрдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
# Read info of the user
aws cognito-idp get-user --region us-east-1 --access-token eyJraWQiOiJPVj[...]

# Change email address
aws cognito-idp update-user-attributes --region us-east-1 --access-token eyJraWQ[...] --user-attributes Name=email,Value=imaginary@flickr.com
{
"CodeDeliveryDetailsList": [
{
"Destination": "i***@f***.com",
"DeliveryMedium": "EMAIL",
"AttributeName": "email"
}
]
}
```
### рдЕрдиреНрдп рдРрдкреНрд╕ рдЯреЛрдХрди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ <a href="#bda5" id="bda5"></a>

[**рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд**](https://salt.security/blog/oh-auth-abusing-oauth-to-take-over-millions-of-accounts) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдУрдЖрде рдлреНрд▓реЛ рдЬреЛ **рдЯреЛрдХрди** (рдФрд░ рдХреЛрдб рдирд╣реАрдВ) рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЙрдореНрдореАрдж рд░рдЦрддреЗ рд╣реИрдВ, рд╡реЗ рд╕рдВрдХреНрд░рд╛рдВрдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдЧрд░ рд╡реЗ рдпрд╣ рдирд╣реАрдВ рдЬрд╛рдВрдЪрддреЗ рдХрд┐ рдЯреЛрдХрди рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рд╣реИ рдпрд╛ рдирд╣реАрдВред

рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** рдПрдХ **рдУрдЖрде рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлреЗрд╕рдмреБрдХ рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП) рдЕрдкрдиреА рдЦреБрдж рдХреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВред рдлрд┐рд░, рдПрдХ рдмрд╛рд░ рдЬрдм рдПрдХ рдкреАрдбрд╝рд┐рдд рдлреЗрд╕рдмреБрдХ рдореЗрдВ **рд╣рдорд▓рд╛рд╡рд░ рдХреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рддрд╛ рд╣реИ, рд╣рдорд▓рд╛рд╡рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдУрдЖрде рдЯреЛрдХрди рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреАрдбрд╝рд┐рдд рдУрдЖрде рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкреАрдбрд╝рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЯреЛрдХрди рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

{% hint style="danger" %}
рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдпрд╣ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓рддрд╛ рдорд┐рд▓рддреА рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдкрдиреА рдУрдЖрде рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рддреЛ рд╡рд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЦрд╛рддреЗ рдХреЛ рдЕрдзрд┐рдХрд╛рд░ рдореЗрдВ рд▓реЗ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рди рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдЯреЛрдХрди рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдирд╣реАрдВ рдЬрд╛рдВрдЪ рд░рд╣реЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдЯреЛрдХрди рдЙрдирдХреЗ рдРрдк рдЖрдИрдбреА рдХреЛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдпрд╛ рдирд╣реАрдВред
{% endhint %}

### рджреЛ рд▓рд┐рдВрдХ рдФрд░ рдХреБрдХреА <a href="#bda5" id="bda5"></a>

[**рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд**](https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдПрдХ рдкреАрдбрд╝рд┐рдд рдХреЛ рдПрдХ рдкреГрд╖реНрда рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╡ рдерд╛ рдЬрд┐рд╕рдореЗрдВ рдПрдХ **returnUrl** рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╣реЛрд╕реНрдЯ рдХреЛ рдкреНрд╡рд╛рдЗрдВрдЯ рдХрд░ рд░рд╣рд╛ рдерд╛ред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рдПрдХ **рдХреБрдХреА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛрдЧреА (рдЖрд░рдпреВ)** рдФрд░ **рдПрдХ рдмрд╛рдж рдХреЗ рд╕реНрдЯреЗрдк рдореЗрдВ** **рдкреНрд░реЙрдореНрдкреНрдЯ** **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдкреВрдЫреЗрдЧрд╛** рдХрд┐ рдХреНрдпрд╛ рд╡рд╣ рдЙрд╕ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╣реЛрд╕реНрдЯ рдХреЛ рдПрдХреНрд╕реЗрд╕ рджреЗрдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИред

рдЗрд╕ рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдРрд╕рд╛ рдЯреИрдм рдЦреЛрд▓рдирд╛ рд╕рдВрднрд╡ рдерд╛ рдЬреЛ рдЗрд╕ RU рдХреБрдХреА рдХреЛ рд╕реЗрдЯ рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ **returnUrl** рд╣реЛрдЧрд╛, рдкреНрд░реЙрдореНрдкреНрдЯ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрдЧрд╛, рдФрд░ рдПрдХ рдирдпрд╛ рдЯреИрдм рдЦреЛрд▓реЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рд╡рд╣ рдорд╛рдиреНрдпрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧреАред рдлрд┐рд░, **рдкреНрд░реЙрдореНрдкреНрдЯ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╣реЛрд╕реНрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрд┐рдд рдирд╣реАрдВ рдХрд░реЗрдЧрд╛**, рд▓реЗрдХрд┐рди рдХреБрдХреА рдЙрд╕реЗ рд╕реЗрдЯ рдХрд░ рджреЗрдЧреА, рдЗрд╕рд▓рд┐рдП **рдЯреЛрдХрди рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╣реЛрд╕реНрдЯ рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛** рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдореЗрдВред

### SSRF рдкреИрд░рд╛рдореАрдЯрд░ <a href="#bda5" id="bda5"></a>

**[рдЗрд╕ рдЕрдиреБрд╕рдВрдзрд╛рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ](https://portswigger.net/research/hidden-oauth-attack-vectors) рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдПред**

рдУрдЖрде рдореЗрдВ рдбрд╛рдпрдирд╛рдорд┐рдХ рдХреНрд▓рд╛рдЗрдВрдЯ рд░рдЬрд┐рд╕реНрдЯреНрд░реЗрд╢рди SSRF рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрдо рдЬреНрдЮрд╛рдд рд▓реЗрдХрд┐рди рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡реЗрдХреНрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ **рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдлреЙрд░реНрдЬрд░реА (SSRF)** рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдПред рдЗрд╕ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдУрдЖрде рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдпреВрдЖрд░рдПрд▓ рдЬреЛ рд╢реЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рдореБрдЦреНрдп рдмрд┐рдВрджреБ:**

- **рдбрд╛рдпрдирд╛рдорд┐рдХ рдХреНрд▓рд╛рдЗрдВрдЯ рд░рдЬрд┐рд╕реНрдЯреНрд░реЗрд╢рди** рдЕрдХреНрд╕рд░ `/рд░рдЬрд┐рд╕реНрдЯрд░` рдХреЗ рд▓рд┐рдП рдореИрдк рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ `client_name`, `client_secret`, `redirect_uris`, рдФрд░ рд▓реЛрдЧреЛ рдпрд╛ рдЬреЗрд╕рди рд╡реЗрдм рдХреБрдВрдЬ (JWKs) рдХреЗ рд▓рд┐рдП рдпреВрдЖрд░рдПрд▓ рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ POST рдЕрдиреБрд░реЛрдз рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред
- рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ **RFC7591** рдФрд░ **OpenID Connect Registration 1.0** рдореЗрдВ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╡рд┐рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ SSRF рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд░рд╛рдВрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рдирд╛рддреНрдордХ рдкреИрд░рд╛рдореАрдЯрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
- рдкрдВрдЬреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрдИ рддрд░реАрдХреЛрдВ рд╕реЗ рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ SSRF рдХреЗ рд▓рд┐рдП рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддреА рд╣реИ:
- **`logo_uri`**: рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓реЛрдЧреЛ рдХреЗ рд▓рд┐рдП рдПрдХ рдпреВрдЖрд░рдПрд▓ рдЬреЛ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдлреЗрдЪ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, SSRF рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдпрджрд┐ рдпреВрдЖрд░рдПрд▓ рдХреЛ рдЧрд▓рдд рдврдВрдЧ рд╕реЗ рд╕рдВрднрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ XSS рдореЗрдВ рд▓реЗ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- **`jwks_uri`**: рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ JWK рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рд▓рд┐рдП рдПрдХ рдпреВрдЖрд░рдПрд▓, рдЬреЛ рдпрджрд┐ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рд░реВрдк рд╕реЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╕рд░реНрд╡рд░ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕рд░реНрд╡рд░ рдХреЛ рдЖрдЙрдЯрдмрд╛рдЙрдВрдб рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рд░рдг рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред
- **`sector_identifier_uri`**: `redirect_uris` рдХрд╛ рдПрдХ рдЬреЗрд╕рди рдЕрд░реЗ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╕рд░реНрд╡рд░ рдлреЗрдЪ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдПрдХ SSRF рдЕрд╡рд╕рд░ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред
- **`request_uris`**: рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдордд рдЕрдиреБрд░реЛрдз рдпреВрдЖрд░рдЖрдИ рдХреА рд╕реВрдЪреА, рдЬреЛ рдпрджрд┐ рд╕рд░реНрд╡рд░ рдЗрди рдпреВрдЖрд░рдЖрдИ рдХреЛ рдЕрдзрд┐рдХреГрдд рдХрд░рддрд╛ рд╣реИ рддреЛ рдЗрди рдпреВрдЖрд░рдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╢реБрд░реВ рдореЗрдВред

**рд╢реЛрд╖рдг рд░рдгрдиреАрддрд┐:**

- SSRF рдХреЛ рдирдП рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рджрд░реНрдЬ рдХрд░рдХреЗ рдЬреИрд╕реЗ `logo_uri`, `jwks_uri`, рдпрд╛ `sector_identifier_uri` рдЬреИрд╕реЗ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдпреВрдЖрд░рдПрд▓ рджреЗрдХрд░ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- `request_uris` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реАрдзреЗ рд╢реЛрд╖рдг рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рд╕рд░реНрд╡рд░ рдЗрди рдпреВрдЖрд░рдЖрдИ рдХреЛ рдкреНрд░рд╛рдзрд┐рдХреГрдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдЪрд░рдг рдХреЗ рджреМрд░рд╛рди SSRF рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред

## OAuth рдкреНрд░рджрд╛рддрд╛рдУрдВ рд░реЗрд╕ рдХрдВрдбреАрд╢рдиреНрд╕

рдпрджрд┐ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдЬрд┐рд╕реЗ рдЖрдк рдкрд░реАрдХреНрд╖рдг рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдПрдХ OAuth рдкреНрд░рджрд╛рддрд╛ рд╣реИ [**рдЗрд╕реЗ рдкрдврд╝реЗрдВ рдпрд╣рд╛рдБ рд╕рдВрднрд╛рд╡рд┐рдд рд░реЗрд╕ рдХрдВрдбреАрд╢рди рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП**](race-condition.md)ред

## рд╕рдВрджрд░реНрдн

* [**https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1**](https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1)
* [**https://portswigger.net/research/hidden-oauth-attack-vectors**](https://portswigger.net/research/hidden-oauth-attack-vectors)
