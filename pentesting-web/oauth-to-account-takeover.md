# OAuth рд╕реЗ рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░реЗрдВ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╕рдВрдЧреНрд░рд╣ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗ**ред

</details>

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА <a href="#d4a8" id="d4a8"></a>

OAuth рдХреЗ рдХреБрдЫ рд╡рд┐рднрд┐рдиреНрди рд╕рдВрд╕реНрдХрд░рдг рд╣реИрдВ, рдЖрдк [https://oauth.net/2/](https://oauth.net/2/) рдкрд░ рдЬрд╛рдХрд░ рдПрдХ рдореВрд▓рднреВрдд рд╕рдордЭ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рд╣рдо рдЙрд╕ рд╕рдмрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рдкреНрд░рд╡рд╛рд╣ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░реЗрдВрдЧреЗ рдЬрд┐рд╕рдХрд╛ рдЖрдк рдЖрдЬрдХрд▓ рд╕рд╛рдордирд╛ рдХрд░реЗрдВрдЧреЗ, рдЬреЛ рд╣реИ [OAuth 2.0 рдЕрдзрд┐рдХреГрддреА рдХреЛрдб рдЧреНрд░рд╛рдВрдЯ рдкреНрд░рдХрд╛рд░](https://oauth.net/2/grant-types/authorization-code/)ред рд╕рд╛рд░рд╛рдВрд╢ рдореЗрдВ, OAuth рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдПрдХ **рдЕрдзрд┐рдХреГрддреА рддрдВрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХрд┐рд╕реА рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди** (рдЕрдзрд┐рдХреГрддреА рд╕рд░реНрд╡рд░) рд╕реЗ рдЖрдкрдХреЗ рдЦрд╛рддреЗ рдХреЗ рдЦрд┐рд▓рд╛рдл рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рдпрд╛ рдХреБрдЫ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдорд╛рди рд▓реЗрдВ рд╡реЗрдмрд╕рд╛рдЗрдЯ _**https://yourtweetreader.com**_ рдореЗрдВ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ **рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдХрднреА рднреА рднреЗрдЬреЗ рдЧрдП рд╕рднреА рдЯреНрд╡реАрдЯреНрд╕ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдирд╛**, рдЗрд╕рдореЗрдВ рдирд┐рдЬреА рдЯреНрд╡реАрдЯреНрд╕ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП, OAuth 2.0 рдХрд╛ рдкреНрд░рдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред _https://yourtweetreader.com_ рдЖрдкрд╕реЗ рдХрд╣реЗрдЧрд╛ рдХрд┐ **рдЙрдирдХреЗ рдЯреНрд╡рд┐рдЯрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЖрдкрдХреЗ рд╕рднреА рдЯреНрд╡реАрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВ**ред рдПрдХ рд╕рд╣рдорддрд┐ рдкреГрд╖реНрда _https://twitter.com_ рдкрд░ рдЙрднрд░реЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдмрддрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ **рдХреМрди рд╕реА рдЕрдиреБрдорддрд┐рдпрд╛рдВ рдорд╛рдВрдЧреА рдЬрд╛ рд░рд╣реА рд╣реИрдВ**, рдФрд░ рдЙрд╕рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдбреЗрд╡рд▓рдкрд░ рдХреМрди рд╣реИред рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, _https://yourtweetreader.com_ рдЖрдкрдХреЗ рдЯреНрд╡реАрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреЗрдЧрд╛ред

OAuth 2.0 рд╕рдВрджрд░реНрдн рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рддрддреНрд╡:

* **рд╕рдВрд╕рд╛рдзрди рдорд╛рд▓рд┐рдХ**: `рд╕рдВрд╕рд╛рдзрди рдорд╛рд▓рд┐рдХ` рд╡рд╣ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рд╕рдВрдЧрдарди** рд╣реИ рдЬреЛ рдЕрдкрдиреЗ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрди, рдЬреИрд╕реЗ рдЙрдирдХреЗ рдЯреНрд╡рд┐рдЯрд░ рдЦрд╛рддреЗ рдХреЗ рдЯреНрд╡реАрдЯреНрд╕, рдХреЗ рд▓рд┐рдП рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдпрд╣ рдЖрдк рд╣реЛрдВрдЧреЗред
* **рд╕рдВрд╕рд╛рдзрди рд╕рд░реНрд╡рд░**: `рд╕рдВрд╕рд╛рдзрди рд╕рд░реНрд╡рд░` рдПрдХ **рдкреНрд░рдорд╛рдгрд┐рдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рд╡рд╛рд▓рд╛ рд╕рд░реНрд╡рд░** рд╣реИ рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ `рд╕рдВрд╕рд╛рдзрди рдорд╛рд▓рд┐рдХ` рдХреЗ рд▓рд┐рдП `рдкрд╣реБрдВрдЪ рдЯреЛрдХрди` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджреЗрддрд╛ рд╣реИред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдпрд╣ рд╣реЛрдЧрд╛ **https://twitter.com**
* **рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди**: `рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди` рдПрдХ **рдЕрдиреБрдорддрд┐ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рд╣реИ рдЬреЛ `рд╕рдВрд╕рд╛рдзрди рдорд╛рд▓рд┐рдХ` рд╕реЗ рдЕрдиреБрдорддрд┐ рдорд╛рдВрдЧрддрд╛ рд╣реИред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдпрд╣ рд╣реЛрдЧрд╛ **https://yourtweetreader.com**ред
* **рдЕрдзрд┐рдХреГрддреА рд╕рд░реНрд╡рд░**: `рдЕрдзрд┐рдХреГрддреА рд╕рд░реНрд╡рд░` рдПрдХ **рд╕рд░реНрд╡рд░ рд╣реИ рдЬреЛ `рд╕рдВрд╕рд╛рдзрди рдорд╛рд▓рд┐рдХ` рдХреА рдкрд╣реБрдВрдЪ рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж `рдкрд╣реБрдВрдЪ рдЯреЛрдХрди` рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИ** `рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди` рдХреЛред рдЙрдкрд░реЛрдХреНрдд рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдпрд╣ рд╣реЛрдЧрд╛ **https://twitter.com**
* **client\_id**: `client_id` рдПрдХ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛**
```
https://twitter.com/auth
?response_type=code
&client_id=yourtweetreader_clientId
&redirect_uri=https%3A%2F%2Fyourtweetreader.com%2Fcallback
&scope=readTweets
&state=kasodk9d1jd992k9klaskdh123
```
3\. рдЖрдкрдХреЛ рд╕рд╣рдорддрд┐ рдкреГрд╖реНрда рдХреЗ рд╕рд╛рде рдПрдХ рд╕рд╣рдорддрд┐ рдкреГрд╖реНрда рдкрд░ рдкреНрд░реЛрдореНрдкреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛:

![](https://miro.medium.com/max/1215/1\*y66EY3Fn2qn-NPI9nhZC7A.png)

4\. рдПрдХ рдмрд╛рд░ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЯреНрд╡рд┐рдЯрд░ `redirect_uri` рдХреЗ рд╕рд╛рде `code` рдФрд░ `state` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдЧрд╛:
```
https://yourtweetreader.com?code=asd91j3jd91j92j1j9d1&state=kasodk9d1jd992k9klaskdh123
```
5\. [https://yourtweetreader.com](https://yourtweetreader.com) рдлрд┐рд░ рдЙрд╕ `code` рдХреЛ рд▓реЗрдЧреА, рдФрд░ рдЕрдкрдиреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ `client_id` рдФрд░ `client_secret` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдкрдХреА рдУрд░ рд╕реЗ рд╕рд░реНрд╡рд░ рд╕реЗ рдПрдХ `access_token` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдЧреА, рдЬрд┐рд╕рд╕реЗ рдЙрдиреНрд╣реЗрдВ рдЖрдкрдХреА рд╕рд╣рдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдХреА рдЧрдИ рдЕрдиреБрдорддрд┐рдпреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдорд┐рд▓реЗрдЧреА:
```
POST /oauth/access_token
Host: twitter.com
...{"client_id": "yourtweetreader_clientId", "client_secret": "yourtweetreader_clientSecret", "code": "asd91j3jd91j92j1j9d1", "grant_type": "authorization_code"}
```
6\. рдЕрдВрдд рдореЗрдВ, рдкреНрд░рд╡рд╛рд╣ рдкреВрд░реНрдг рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ [https://yourtweetreader.com](https://yourtweetreader.com) рдЖрдкрдХреЗ `access_token` рдХреЗ рд╕рд╛рде рдЯреНрд╡рд┐рдЯрд░ рдХреЛ API рдХреЙрд▓ рдХрд░реЗрдЧрд╛ рддрд╛рдХрд┐ рдЖрдкрдХреЗ рдЯреНрд╡реАрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреЗрдВред

## рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЦреЛрдЬ <a href="#323a" id="323a"></a>

рдЕрдм, рд░реЛрдЪрдХ рд╣рд┐рд╕реНрд╕рд╛! OAuth рдХреЗ рдЕрдВрдорд▓рдг рдореЗрдВ рдХрдИ рдЪреАрдЬреЗрдВ рдЧрд▓рдд рд╣реЛ рд╕рдХрддреА рд╣реИрдВ, рдпрд╣рд╛рдВ рдореИрдВ рдЖрдорддреМрд░ рдкрд░ рджреЗрдЦрдиреЗ рд╡рд╛рд▓реЗ рдмрдЧ рдХреА рд╡рд┐рднрд┐рдиреНрди рд╢реНрд░реЗрдгрд┐рдпрд╛рдВ рд╣реИрдВ:

### рдХрдордЬреЛрд░ redirect\_uri рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди <a href="#cc36" id="cc36"></a>

`redirect_uri` рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЕрдзрд┐рдХреГрддрд┐ рдХреЗ рдмрд╛рдж рдЗрд╕ URL рдХреЗ рдмрд╛рдж **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛, рдЬреИрд╕реЗ рдХреЛрдб, рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрджрд┐ `redirect_uri` рдХрд┐рд╕реА **рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╕рд░реНрд╡рд░** рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ `рдХреЛрдб` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рдХреЛ рдЕрдзрд┐рдХрд╛рд░ рдореЗрдВ рд▓реЗ рд╕рдХрддрд╛ рд╣реИ** рдФрд░ рдкреАрдбрд╝рд┐рдд рдХреЗ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдЕрдзрд┐рдХреГрддрд┐ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рднрд┐рдиреНрди рд╣реЛрдЧрд╛ред **рдХреБрдЫ** рдХреЗрд╡рд▓ рдЙрд╕реА рдирд┐рд░реНрджрд┐рд╖реНрдЯ **`redirect_uri` рдкрде рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВрдЧреЗ** рд▓реЗрдХрд┐рди рдХреБрдЫ рдРрд╕рд╛ рдХрд░реЗрдВрдЧреЗ **рдЬреЛ рднреА** `redirect_uri` рдХреЗ рдбреЛрдореЗрди рдпрд╛ рдЙрдкрдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╣реЛрдЧрд╛, рдЙрд╕реЗ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВрдЧреЗред

рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╕рдВрднрд╛рд▓реЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рддрд░реНрдХ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, `redirect_uri` рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рдХрдИ рддрдХрдиреАрдХ рд╣реИрдВред рдПрдХ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЬрд╣рд╛рдВ `redirect_uri` [https://yourtweetreader.com](https://yourtweetreader.com)/callback рд╣реИ, рдЗрдирдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* рдЦреБрд▓реЗ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ: [`https://yourtweetreader.com`](https://yourtweetreader.com)`/callback?redirectUrl=https://evil.com`
* рдкрде рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓: `https://yourtweetreader.com/callback/../redirect?url=https://evil.com`
* рдХрдордЬреЛрд░ `redirect_uri` рд░реЗрдЬреЗрдХреНрд╕: `https://yourtweetreader.com.evil.com`
* HTML рдЗрдВрдЬреЗрдХреНрд╢рди рдФрд░ рд░реЗрдлрд░рд░ рд╣реИрдбрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЯреЛрдХрди рдЪреЛрд░реА: `https://yourtweetreader.com/callback/home/attackerimg.jpg`

рдЦреБрд▓реЗ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ **рдЕрдиреНрдп рдкреИрд░рд╛рдореАрдЯрд░** рд╣реИрдВ:

* **client\_uri** - рдЧреНрд░рд╛рд╣рдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рд╣реЛрдо рдкреЗрдЬ рдХрд╛ URL
* **policy\_uri** - рд░рд┐рд▓рд╛рдпрд┐рдВрдЧ рдкрд╛рд░реНрдЯреА рдЧреНрд░рд╛рд╣рдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ URL рддрд╛рдХрд┐ рдЕрдВрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдкрдиреЗ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдбреЗрдЯрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрдврд╝ рд╕рдХреЗрдВред
* **tos\_uri** - рд░рд┐рд▓рд╛рдпрд┐рдВрдЧ рдкрд╛рд░реНрдЯреА рдЧреНрд░рд╛рд╣рдХ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ URL рддрд╛рдХрд┐ рдЕрдВрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд░рд┐рд▓рд╛рдпрд┐рдВрдЧ рдкрд╛рд░реНрдЯреА рдХреА рд╕реЗрд╡рд╛ рдХреА рд╢рд░реНрддреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрдврд╝ рд╕рдХреЗрдВред
* **initiate\_login\_uri** - рдПрдХ рддреГрддреАрдп рдкрдХреНрд╖ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓рд╛ https рдпреЛрдЬрдирд╛ рдХрд╛ URI рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ RP рджреНрд╡рд╛рд░рд╛ рд▓реЙрдЧрд┐рди рдкреНрд░рд╛рд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдЧреНрд░рд╛рд╣рдХ-рд╕рд╛рдЗрдб рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

рдпреЗ рд╕рднреА рдкреИрд░рд╛рдореАрдЯрд░ **OAuth рдФрд░ OpenID** рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ **рд╡реИрдХрд▓реНрдкрд┐рдХ рд╣реИрдВ** рдФрд░ рд╣рдореЗрд╢рд╛ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕рд░реНрд╡рд░ рдкрд░ рд╕рдорд░реНрдерд┐рдд рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рд╣рдореЗрд╢рд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рд╕рд░реНрд╡рд░ рдкрд░ рдХреМрди рд╕реЗ рдкреИрд░рд╛рдореАрдЯрд░ рд╕рдорд░реНрдерд┐рдд рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рдкрд╣рдЪрд╛рдирдирд╛ред

рдпрджрд┐ рдЖрдк рдПрдХ OpenID рд╕рд░реНрд╡рд░ рдХреЛ рд▓рдХреНрд╖реНрдп рдмрдирд╛рддреЗ рд╣реИрдВ, рддреЛ рдбрд┐рд╕реНрдХрд╡рд░реА рдЕрдВрддрдмрд┐рдВрджреБ рдкрд░ \*\*`.well-known/openid-configuration`\*\* рдХреБрдЫ рдкреИрд░рд╛рдореАрдЯрд░ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ "_registration\_endpoint_", "_request\_uri\_parameter\_supported_", рдФрд░ "_require\_request\_uri\_registration_"ред рдпреЗ рдЖрдкрдХреЛ рдкрдВрдЬреАрдХрд░рдг рдЕрдВрддрдмрд┐рдВрджреБ рдФрд░ рдЕрдиреНрдп рд╕рд░реНрд╡рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдорд╛рдиреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рдЕрдВрдорд▓рдг рдореЗрдВ XSS <a href="#bda5" id="bda5"></a>

рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд░рд┐рдкреЛрд░реНрдЯ [https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html](https://blog.dixitaditya.com/2021/11/19/account-takeover-chain.html) рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╕рдВрднрд╡рддрдГ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ **URL рдХреЛ рд╕рд░реНрд╡рд░ рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ**, рдЬреЛ **XSS рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓** рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рдкреЗрд▓реЛрдб:
```
https://app.victim.com/login?redirectUrl=https://app.victim.com/dashboard</script><h1>test</h1>
```
### CSRF - рд░рд╛рдЬреНрдп рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдЕрдиреБрдЪрд┐рдд рд╣реИрдВрдбрд▓рд┐рдВрдЧ <a href="#bda5" id="bda5"></a>

рдЕрдХреНрд╕рд░, **`state` рдкреИрд░рд╛рдореАрдЯрд░ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╛ рдЧрд▓рдд рддрд░реАрдХреЗ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрджрд┐ рдПрдХ рд╕реНрдерд┐рддрд┐ рдкреИрд░рд╛рдореАрдЯрд░ **рдЕрд╕реНрддрд┐рддреНрд╡рд╣реАрди рд╣реЛрддрд╛ рд╣реИ**, **рдпрд╛ рдПрдХ рд╕реНрдерд┐рд░ рдорд╛рди** рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдХрднреА рдирд╣реАрдВ рдмрджрд▓рддрд╛ рд╣реИ, рддреЛ OAuth рдлреНрд▓реЛ рдмрд╣реБрдд рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ **CSRF рдХреЗ рд▓рд┐рдП рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рд╣реЛрдЧрд╛**ред рдХрднреА-рдХрднреА, рдпрджрд┐ `state` рдкреИрд░рд╛рдореАрдЯрд░ рд╣реЛрддрд╛ рд╣реИ, рддреЛ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╢рд╛рдпрдж рд╣реА рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдХреЛрдИ рдорд╛рдиреНрдпрддрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдирд╣реАрдВ рдХрд░реЗрдЧрд╛** рдФрд░ рд╣рдорд▓рд╛ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред рдЗрд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдпрд╣ рд╣реЛрдЧрд╛ рдХрд┐ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдкрд░ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдПрдВ рдФрд░ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдард╣рд░реЗрдВред рдлрд┐рд░ рдЖрдкрдХреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рд╕рд╛рдордиреЗ рдЖрдирд╛ рд╣реЛрдЧрд╛ рдЬреИрд╕реЗ:
```
https://yourtweetreader.com?code=asd91j3jd91j92j1j9d1
```
рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЖрдк рдлрд┐рд░ рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХреЛ **рдЫреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдпреЗ рдХреЛрдб рдЖрдорддреМрд░ рдкрд░ рдПрдХ рдмрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддреЗ рд╣реИрдВ**ред рдлрд┐рд░ рдЖрдк рдЗрд╕ URL рдХреЛ рдПрдХ **рд▓реЙрдЧ рдЗрди рдХрд┐рдП рд╣реБрдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдЖрдкрдХреЗ рдЦрд╛рддреЗ рдХреЛ рдЙрдирдХреЗ рдЦрд╛рддреЗ рдореЗрдВ рдЬреЛрдбрд╝ рджреЗрдЧрд╛**ред рдкрд╣рд▓реЗ рдЗрд╕реЗ рдмрд╣реБрдд рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдирд╣реАрдВ рд▓рдЧ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк рдмрд╕ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рдореЗрдВ рдЬреЛрдбрд╝ рд░рд╣реЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрдИ OAuth рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╕рд╛рдЗрди-рдЗрди рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ Google рдЦрд╛рддреЗ рдХреЛ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдПрдХрд▓ рдХреНрд▓рд┐рдХ рдХреЗ рд╕рд╛рде рдПрдХ **рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдХреНрдпреЛрдВрдХрд┐ рдЕрдкрдиреЗ Google рдЦрд╛рддреЗ рд╕реЗ рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рд╕реЗ рдЖрдкрдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рддрдХ рдкрд╣реБрдВрдЪ рдорд┐рд▓ рдЬрд╛рдПрдЧреАред

рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ **рдЙрджрд╛рд╣рд░рдг** рдЖрдк [**CTF writeup**](https://github.com/gr455/ctf-writeups/blob/master/hacktivity20/notes\_surfer.md) рдФрд░ **HTB рдмреЙрдХреНрд╕ рдУрдЙрдЪ** рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

рдореИрдВрдиреЗ рдХрдИ рдмрд╛рд░ рджреЗрдЦрд╛ рд╣реИ рдХрд┐ рд░рд╛рдЬреНрдп рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдорд╛рди рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рдЖрд╡реЗрджрди `redirect_uri` рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рд╛рдердорд┐рдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЗ рд▓рд┐рдП рдХрд░реЗрдЧрд╛, рд▓реЗрдХрд┐рди рдлрд┐рд░ `state` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рджреВрд╕рд░реЗ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдХреНрд╡реЗрд░реА рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ `code` рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╛ рд░реЗрдлрд░рд░ рд╣реЗрдбрд░ рдореЗрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ рд╕рд┐рд░реНрдл рд╕рд╛рдЗрди-рдЗрди рдФрд░ рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдиреЗ рдЬреИрд╕реА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдкрд░ рд╣реА рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдореИрдВрдиреЗ рджреЗрдЦрд╛ рд╣реИ рдХрд┐ рдЧрд▓рддрд┐рдпреЛрдВ рдореЗрдВ:

* Slack рдПрдХреАрдХрд░рдг рдПрдХ рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ рдХреЛ рд╕рднреА рд╕реВрдЪрдирд╛рдУрдВ / рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдкрдирд╛ Slack рдЦрд╛рддрд╛ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ
* рд╕реНрдЯреНрд░рд╛рдЗрдк рдПрдХреАрдХрд░рдг рдПрдХ рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ рдХреЛ рднреБрдЧрддрд╛рди рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░рдиреЗ рдФрд░ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЧреНрд░рд╛рд╣рдХреЛрдВ рд╕реЗ рднреБрдЧрддрд╛рди рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ
* рдкреЗрдкрд╛рд▓ рдПрдХреАрдХрд░рдг рдПрдХ рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рдореЗрдВ рдЕрдкрдирд╛ PayPal рдЦрд╛рддрд╛ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ рдХреЗ PayPal рдореЗрдВ рдкреИрд╕рд╛ рдЬрдорд╛ рд╣реЛрдЧрд╛

### рдкрд╣рд▓реЗ рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ <a href="#ebe4" id="ebe4"></a>

рдореИрдВ рджреЗрдЦрддрд╛ рд╣реВрдВ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ "X рдХреЗ рд╕рд╛рде рд╕рд╛рдЗрди рдЗрди рдХрд░реЗрдВ" рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо / рдкрд╛рд╕рд╡рд░реНрдб рднреА рд╣реЛрддреЗ рд╣реИрдВред рдЗрд╕реЗ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд░реАрдХреЗ рд╣реИрдВ:

1. рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди **рдЦрд╛рддрд╛ рдмрдирд╛рдиреЗ рдкрд░ рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ**, рддреЛ рдкрд╣рд▓реЗ рд╣реА рдкреАрдбрд╝рд┐рдд рдХреЗ рдИрдореЗрд▓ рдкрддреЗ рдФрд░ рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред рдпрджрд┐ **рдкреАрдбрд╝рд┐рдд** рдлрд┐рд░ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдЬреИрд╕реЗ Google рдХреЗ рд╕рд╛рде **рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рдиреЗ рдпрд╛ рд╕рд╛рдЗрди рдЗрди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ**, рддреЛ рд╕рдВрднрд╡рддрдГ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдХ рд▓реБрдХрдЕрдк рдХрд░реЗрдЧрд╛, рджреЗрдЦреЗрдЧрд╛ рдХрд┐ рдИрдореЗрд▓ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд░рдЬрд┐рд╕реНрдЯрд░ рд╣реИ, рдФрд░ рдлрд┐рд░ **рдЙрдирдХреЗ Google рдЦрд╛рддреЗ рдХреЛ рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдП рдЧрдП рдЦрд╛рддреЗ рд╕реЗ рд▓рд┐рдВрдХ рдХрд░реЗрдЧрд╛**ред рдпрд╣ рдПрдХ "рдкрд╣рд▓реЗ рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдиреЗ" рд╣реИ рдЬрд╣рд╛рдВ рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рддрдХ рдкрд╣реБрдВрдЪ рд╣реЛрдЧреА рдпрджрд┐ рд╡рд╣ рдЙрд╕реЗ рдкрд╣рд▓реЗ рд╣реА рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░ рджреЗрддрд╛ рд╣реИред
2. рдпрджрд┐ **OAuth рдРрдк рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ**, рддреЛ рдЙрд╕ OAuth рдРрдк рдХреЗ рд╕рд╛рде рд╕рд╛рдЗрди рдЕрдк рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ рдИрдореЗрд▓ рдкрддреЗ рдХреЛ **рдкреАрдбрд╝рд┐рдд рдХреЗ рдИрдореЗрд▓ рдкрддреЗ рдХреЗ рд╕рд╛рде рдмрджрд▓реЗрдВ**ред рдЙрдкрд░реЛрдХреНрдд рдХреА рддрд░рд╣реА рд╕рдорд╕реНрдпрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рдЗрд╕реЗ рдЙрд▓рдЯреА рджрд┐рд╢рд╛ рд╕реЗ рд╣рдорд▓рд╛ рдХрд░ рд░рд╣реЗ рд╣реЛрдВрдЧреЗ рдФрд░ рдЦрд╛рддрд╛ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЗ рдЦрд╛рддреЗ рдореЗрдВ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд░рд╣реЗ рд╣реЛрдВрдЧреЗред

### рд░рд╣рд╕реНрдпреЛрдВ рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ <a href="#e177" id="e177"></a>

рдпрд╣ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдЖрдк рдкрд╣рдЪрд╛рдиреЗрдВ **рдХреМрди рд╕реЗ OAuth рдкреИрд░рд╛рдореАрдЯрд░ рдЧреЛрдкрдиреАрдп рд╣реЛрддреЗ рд╣реИрдВ**, рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦреЗрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `client_id` рд▓реАрдХ рдХрд░рдирд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдареАрдХ рдФрд░ рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рд▓реЗрдХрд┐рди **`client_secret` рд▓реАрдХ рд╣реЛрдирд╛ рдЦрддрд░рдирд╛рдХ рд╣реЛрддрд╛ рд╣реИ**ред рдпрджрд┐ рдпрд╣ рд▓реАрдХ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ **рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ** рд╕рдВрднрд╡рддрдГ **рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдЧреНрд░рд╛рд╣рдХ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдФрд░ рдкрд╣реБрдВрдЪ рдХреА рдкрд╣рдЪрд╛рди рдЪреЛрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдЧреНрд░рд╛рд╣рдХ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред рд╣рдорд╛рд░реЗ рдкрд╣рд▓реЗ рдЙрджрд╛рд╣рд░рдг рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛рддреЗ рд╣реИрдВ, рдореИрдВрдиреЗ рджреЗрдЦрд╛ рд╣реИ рдХрд┐ рдЗрд╕ рдХрджрдо рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕рд░реНрд╡рд░ рд╕реЗ рдирд╣реАрдВ:

_5._ [_https://yourtweetreader.com_](https://yourtweetreader.com) _рдлрд┐рд░ рдЙрд╕ `code` рдХреЛ рд▓реЗ рд▓реЗрдЧрд╛, рдФрд░ рдЕрдкрдиреЗ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ `client_id` рдФрд░ `client_secret` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдкрдХреЗ рд▓рд┐рдП рдПрдХ `access_token` рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░ рд╕реЗ рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рдЙрдиреНрд╣реЗрдВ рдЖрдкрдХреА рд╕рд╣рдорддрд┐
```
POST /token HTTP/1.1
content-type: application/x-www-form-urlencoded
host: 10.10.10.10:3000
content-length: 135
Connection: close

code=77515&redirect_uri=http%3A%2F%2F10.10.10.10%3A3000%2Fcallback&grant_type=authorization_code&client_id=public_client_id&client_secret=[bruteforce]
```
### Referer рд╣реЗрдбрд░ рд▓реАрдХ рдХреЛрдб + рд╕реНрдерд┐рддрд┐

рдЬрдм рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдкрд╛рд╕ **рдХреЛрдб рдФрд░ рд╕реНрдерд┐рддрд┐** рд╣реЛрддреА рд╣реИ, рдФрд░ рдпрджрд┐ рд╡рд╣ рдПрдХ рдЕрд▓рдЧ рдкреГрд╖реНрда рдкрд░ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░рддреЗ рд╕рдордп **Referer рд╣реЗрдбрд░ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрддреА рд╣реИ**, рддреЛ рдпрд╣ рд╕рдВрдХрдЯрдкреВрд░реНрдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди

**рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрддрд┐рд╣рд╛рд╕ рдореЗрдВ рдЬрд╛рдПрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдПрдХреНрд╕реЗрд╕ рдЯреЛрдХрди рд╡рд╣рд╛рдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ**ред

### рдЕрд╡рд┐рдирд╛рд╢реА рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛрдб

**рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛрдб рдХреЛ рдХреЗрд╡рд▓ рдХреБрдЫ рд╕рдордп рддрдХ рдЬреАрдиреЗ рдХреА рдЖрд╡рдзрд┐ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╣рдорд▓рд╛рд╡рд╛рд░ рдЖрдХреНрд░рдордгрдХрд╛рд░реА рдЗрд╕реЗ рдЪреБрд░рд╛ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗрдВ**ред

### рдкреНрд░рд╛рдзрд┐рдХрд░рдг / рддрд╛рдЬрдЧреА рдЯреЛрдХрди рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдЬреБрдбрд╝рд╛ рдирд╣реАрдВ рд╣реИ

рдпрджрд┐ рдЖрдк **рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдПрдХ рдЕрд▓рдЧ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рдЕрдиреНрдп рдЦрд╛рддреЛрдВ рдХреЛ рдЕрдзрд┐рдХрд╛рд░ рдореЗрдВ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВред

### рдЦреБрд╢ рдкрде, XSS, рдЖрдИрдлреНрд░реЗрдо рдФрд░ рдкреЛрд╕реНрдЯ рд╕рдВрджреЗрд╢ рддрд╛рдХрддреНрд╡реЛрдВ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдФрд░ рд╕реНрдерд┐рддрд┐ рдорд╛рдиреЛрдВ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП

### AWS Cognito <a href="#bda5" id="bda5"></a>

рдЗрд╕ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд░рд┐рдкреЛрд░реНрдЯ рдореЗрдВ: [**https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/**](https://security.lauritz-holtmann.de/advisories/flickr-account-takeover/) рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **AWS Cognito** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╡рд╛рдкрд╕ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдЕрдиреБрдорддрд┐рдпрд╛рдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **рдПрдХ рдЕрд▓рдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдИрдореЗрд▓ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдИрдореЗрд▓ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рдЕрдиреНрдп рдЦрд╛рддреЛрдВ рдХреЛ **рдЕрдзрд┐рдХрд╛рд░ рдореЗрдВ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ**ред
```bash
# Read info of the user
aws cognito-idp get-user --region us-east-1 --access-token eyJraWQiOiJPVj[...]

# Change email address
aws cognito-idp update-user-attributes --region us-east-1 --access-token eyJraWQ[...] --user-attributes Name=email,Value=imaginary@flickr.com
{
"CodeDeliveryDetailsList": [
{
"Destination": "i***@f***.com",
"DeliveryMedium": "EMAIL",
"AttributeName": "email"
}
]
}
```
рдПрд╡реАрдПрд╕ рдХреЛрдЧреНрдирд┐рдЯреЛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{% embed url="https://cloud.hacktricks.xyz/pentesting-cloud/aws-pentesting/aws-unauthenticated-enum-access/aws-cognito-unauthenticated-enum" %}

### рджреЛ рд▓рд┐рдВрдХ рдФрд░ рдХреБрдХреА <a href="#bda5" id="bda5"></a>

[**рдЗрд╕ рд▓реЗрдЦ**](https://medium.com/@metnew/why-electron-apps-cant-store-your-secrets-confidentially-inspect-option-a49950d6d51f) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдПрдХ рд╣рдорд▓рд╛рд╡рд░реНрдзреА рдХреЗ рд╣реЛрд╕реНрдЯ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ **returnUrl** рдХреЗ рд╕рд╛рде рдПрдХ рдкреЗрдЬ рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЛ рдЦреЛрд▓рдирд╛ рд╕рдВрднрд╡ рдерд╛ред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА **рдХреБрдХреА (RU)** рдореЗрдВ **рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛рдПрдЧреА** рдФрд░ рдПрдХ **рдмрд╛рдж рдХреЗ рдЪрд░рдг** рдореЗрдВ **рдкреНрд░реЙрдореНрдкреНрдЯ** рдкреВрдЫреЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЙрд╕ рд╣рдорд▓рд╛рд╡рд░реНрдзреА рдХреЗ рд╣реЛрд╕реНрдЯ рдХреЛ рдкрд╣реБрдВрдЪ рджреЗрдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИред

рдЗрд╕ рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рдЯреИрдм рдЦреЛрд▓рдирд╛ рд╕рдВрднрд╡ рдерд╛ рдЬрд┐рд╕рд╕реЗ **Oauth рдлреНрд▓реЛ** рд╢реБрд░реВ рд╣реЛрдЧрд╛ рдФрд░ рдпрд╣ RU рдХреБрдХреА **returnUrl** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрдЯ рдХрд░реЗрдЧрд╛, рдкреНрд░реЙрдореНрдкреНрдЯ рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрдЧрд╛, рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж рдПрдХ рдирдпрд╛ рдЯреИрдм рдЦреЛрд▓реЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рд╡рд╣ рдорд╛рдиреНрдпрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧреАред рдлрд┐рд░, **рдкреНрд░реЙрдореНрдкреНрдЯ рд╣рдорд▓рд╛рд╡рд░реНрдзреА рдХреЗ рд╣реЛрд╕реНрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрд┐рдд рдирд╣реАрдВ рдХрд░реЗрдЧрд╛**, рд▓реЗрдХрд┐рди рдХреБрдХреА рдЙрд╕реЗ рд╕реЗрдЯ рдХрд░ рджреЗрдЧреА, рдЗрд╕рд▓рд┐рдП **рдЯреЛрдХрди рд╣рдорд▓рд╛рд╡рд░реНрдзреА рдХреЗ рд╣реЛрд╕реНрдЯ рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛** рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдореЗрдВред

### SSRF рдкреИрд░рд╛рдореАрдЯрд░ <a href="#bda5" id="bda5"></a>

рдЖрдк рдПрдХ **рдбрд╛рдпрдиреЗрдорд┐рдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдкрдВрдЬреАрдХрд░рдг рдЕрдВрдд рдмрд┐рдВрджреБ** рдХреЛ рдЫреВрдиреЗ рдХреЗ рд▓рд┐рдП рдЫрд┐рдкреЗ рд╣реБрдП URL рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИрдВред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдУрдЖрде рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдЧреНрд░рд╛рд╣рдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬреИрд╕реЗ "client\_name", "client\_secret", "redirect\_uris" рдЖрджрд┐ред рдпреЗ рд╡рд┐рд╡рд░рдг рд╕реНрдерд╛рдиреАрдп рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдУрдЖрде рдЕрдзрд┐рдХреГрддрд┐ рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рдкрд╛рд╕ рдПрдХ **рд╡рд┐рд╢реЗрд╖ рдкрдВрдЬреАрдХрд░рдг рдЕрдВрдд рдмрд┐рдВрджреБ** рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдЕрдВрдд рдмрд┐рдВрджреБ рд╕рд╛рдорд╛рдиреНрдпрддрдГ "/register" рдХреЗ рд▓рд┐рдП рдореИрдк рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рд╛рд░реВрдк рдХреЗ рд╕рд╛рде POST рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ:
```json
POST /connect/register HTTP/1.1
Content-Type: application/json
Host: server.example.com
Authorization: Bearer eyJhbGciOiJSUzI1NiJ9.eyJ ...

{
"application_type": "web",
"redirect_uris": ["https://client.example.org/callback"],
"client_name": "My Example",
"logo_uri": "https://client.example.org/logo.png",
"subject_type": "pairwise",
"sector_identifier_uri": "https://example.org/rdrct_uris.json",
"token_endpoint_auth_method": "client_secret_basic",
"jwks_uri": "https://client.example.org/public_keys.jwks",
"contacts": ["ve7jtb@example.org"],
"request_uris": ["https://client.example.org/rf.txt"]
}
```
рдЗрд╕ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рджреЛ рд╡рд┐рдирд┐рд░реНрджреЗрд╢ рд╣реИрдВ: [RFC7591](https://tools.ietf.org/html/rfc7591) рдУрдЖрде рдХреЗ рд▓рд┐рдП рдФрд░ [Openid Connect Registration 1.0](https://openid.net/specs/openid-connect-registration-1\_0.html#rfc.section.3.1) рдХреЗ рд▓рд┐рдПред

рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдпрд╣рд╛рдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдХрдИ рдорд╛рдиреЛрдВ рдХреЛ URL рд╕рдВрджрд░реНрдн рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпреЗ [рд╕рд░реНрд╡рд░ рд╕рд╛рдЗрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдлреЙрд░реНрдЬрд░реА](https://portswigger.net/web-security/ssrf) рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рд▓рдХреНрд╖реНрдп рд▓рдЧрддреЗ рд╣реИрдВред рдЗрд╕реА рдмреАрдЪ, рд╣рдордиреЗ рдЬрд┐рддрдиреЗ рднреА рд╕рд░реНрд╡рд░реЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рд╣реИ, рдЙрдирдореЗрдВ рд╕реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╕рд░реНрд╡рд░ рдЗрди URL рдХреЛ рддреБрд░рдВрдд рдирд╣реАрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рдЙрдиреНрд╣реЗрдВ рдПрдХ рдкрдВрдЬреАрдХрд░рдг рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред рдмрдЬрд╛рдп рдЗрд╕рдХреЗ, рд╡реЗ рдмрд╕ рдЗрди рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреЛ рд╕рд╣реЗрдЬрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдУрдЖрде рдЕрдзрд┐рдХреГрддрд┐ рдкреНрд░рд╡рд╛рд╣ рдХреЗ рджреМрд░рд╛рди рдмрд╛рдж рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рдпрд╣ рджреВрд╕рд░реЗ рдХреНрд░рдо рдХреА рдПрд╕рдПрд╕рдЖрд░рдПрдл рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдХрд╛рд▓реЗ-рдмреЙрдХреНрд╕ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрди рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдореЗрдВ рд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рдПрд╕рдПрд╕рдЖрд░рдПрдл рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд░реБрдЪрд┐рдХрд░ рд╣реИрдВ:

* **logo\_uri** - рдПрдХ URL рдЬреЛ рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ **рд▓реЛрдЧреЛ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ**ред **рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж**, рдЖрдк рдЕрдкрдиреЗ рдирдП "client\_id" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдУрдЖрде рдЕрдзрд┐рдХреГрддрд┐ рдЕрдВрдд рдмрд┐рдВрджреБ ("/authorize") рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд▓реЙрдЧрд┐рди рдХреЗ рдмрд╛рдж, рд╕рд░реНрд╡рд░ рдЖрдкрд╕реЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдордВрдЬреВрд░реА рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдкреВрдЫреЗрдЧрд╛ рдФрд░ **"logo\_uri" рд╕реЗ рдЫрд╡рд┐ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред рдпрджрд┐ **рд╕рд░реНрд╡рд░ рдЦреБрдж рдЫрд╡рд┐ рдХреЛ рдлрд╝реЗрдЪ рдХрд░рддрд╛ рд╣реИ**, рддреЛ рдЗрд╕ рдЪрд░рдг рджреНрд╡рд╛рд░рд╛ рдПрд╕рдПрд╕рдЖрд░рдПрдл рдЯреНрд░рд┐рдЧрд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рд╕рд░реНрд╡рд░ рдХреЗрд╡рд▓ рдПрдХ **рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб "\<img>" рдЯреИрдЧ** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реЛрдЧреЛ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ URL рдирд╣реАрдВ рднрд╛рдЧрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрд╕рдПрд╕рдЖрд░рдПрдл рдирд╣реАрдВ рд▓реЗрдХрд┐рди **рдПрдХреНрд╕рдПрд╕рдПрд╕ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЕрдЧрд░ URL рдирд╣реАрдВ рднрд╛рдЧрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред
*   **jwks\_uri** - рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ JSON рд╡реЗрдм рдХреБрдВрдЬреА рд╕реЗрдЯ \[JWK] рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рд▓рд┐рдП URLред рдпрд╣ рдХреБрдВрдЬреА рд╕реЗрдЯ рд╕рд░реНрд╡рд░ рдкрд░ рдЖрд╡реЗрджрд┐рдд JWT рдХрд╛ рд╡реИрдзреАрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддрд╛ рд╣реИ рдЬрдм JWT рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЧреНрд░рд╛рд╣рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЯреЛрдХрди рдЕрдВрдд рдмрд┐рдВрджреБ рдкрд░ рдмрдирд╛рдП рдЧрдП рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ \[RFC7523]ред рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдПрд╕рдПрд╕рдЖрд░рдПрдл рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **рдПрдХ рджреБрд╖реНрдЯ "jwks\_uri" рдХреЗ рд╕рд╛рде рдПрдХ рдирдпрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрдВрдЬреАрдХреГрдд рдХрд░реЗрдВ**, рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдзрд┐рдХреГрддрд┐ рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХреГрддрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░реЗрдВ, рдФрд░ рдлрд┐рд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдмреЙрдбреА рдХреЗ рд╕рд╛рде "/token" рдЕрдВрдд рдмрд┐рдВрджреБ рдХреЛ рдлрд╝реЗрдЪ рдХрд░реЗрдВ:

`POST /oauth/token HTTP/1.1`\
`...`\
\`\`\
`grant_type=authorization_code&code=n0esc3NRze7LTCu7iYzS6a5acc3f0ogp4&client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer&client_assertion=eyJhbGci...`

рдпрджрд┐ рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рд╣реИ, рддреЛ **рд╕рд░реНрд╡рд░ рдХреЛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ "jwks\_uri" рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡рд░-рд╕реЗ-рд╕рд░реНрд╡рд░ рдПрдЪрдЯреАрдЯреАрдкреА рдЕрдиреБрд░реЛрдз рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП** рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЖрдкрдХреЗ рдЕрдиреБрд░реЛрдз рдореЗрдВ "client\_assertion" рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рдорд╛рдиреНрдпрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдХреБрдВрдЬреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдпрд╣ рд╢рд╛рдпрдж рдХреЗрд╡рд▓ рдПрдХ **рдЕрдВрдзрд╛ рдПрд╕рдПрд╕рдЖрд░рдПрдл рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрддрддрд╛ рд╣реА рд╣реЛрдЧреА**, рдХреНрдпреЛрдВрдХрд┐ рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рдЙрдЪрд┐рдд JSON рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЙрдореНрдореАрдж рд╣реЛрддреА рд╣реИред
* **sector\_identifier\_uri** - рдпрд╣ URL рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рд╕рдВрджрд░реНрдн рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдПрдХрд▓ **JSON рдПрд░реЗ рдСрдлрд╝ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ
