# Condi√ß√£o de Corrida

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir e **automatizar fluxos de trabalho** com as ferramentas comunit√°rias **mais avan√ßadas** do mundo.\
Obtenha Acesso Hoje:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Aprenda a hackear AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do GitHub** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Explorando RC

O principal problema ao abusar de RCs √© que voc√™ precisa que as solicita√ß√µes sejam processadas em paralelo com uma diferen√ßa de tempo muito curta (geralmente >1ms). Na se√ß√£o a seguir, diferentes solu√ß√µes s√£o propostas para tornar isso poss√≠vel.

<figure><img src="../.gitbook/assets/image (5) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Ataque de pacote √∫nico (HTTP/2) / Sincroniza√ß√£o do √∫ltimo byte (HTTP/1.1)

HTTP2 permite enviar **2 solicita√ß√µes em uma √∫nica conex√£o TCP** (enquanto no HTTP/1.1 elas t√™m que ser sequenciais).\
O uso de um √∫nico pacote TCP **elimina completamente o efeito da varia√ß√£o de rede**, ent√£o isso claramente tem potencial para ataques de condi√ß√£o de corrida tamb√©m. No entanto, **duas solicita√ß√µes n√£o s√£o suficientes para um ataque de corrida confi√°vel** devido √† **varia√ß√£o do lado do servidor** - varia√ß√µes no tempo de processamento de solicita√ß√µes da aplica√ß√£o causadas por vari√°veis incontrol√°veis como a conten√ß√£o de CPU.

Mas, usando a t√©cnica de '**sincroniza√ß√£o do √∫ltimo byte**' do HTTP/1.1, √© poss√≠vel pr√©-enviar a maior parte dos dados retendo um pequeno fragmento de cada solicita√ß√£o e depois 'completar' **20-30 solicita√ß√µes com um √∫nico pacote TCP**.

Para **pr√©-enviar a maior parte de cada solicita√ß√£o**:

* Se a solicita√ß√£o n√£o tem corpo, envie todos os cabe√ßalhos, mas n√£o defina a flag END\_STREAM. Retenha um quadro de dados vazio com a flag END\_STREAM definida.
* Se a solicita√ß√£o tem um corpo, envie os cabe√ßalhos e todos os dados do corpo exceto o √∫ltimo byte e a flag END\_STREAM. Retenha um quadro de dados contendo o √∫ltimo byte.

Em seguida, **prepare-se para enviar os quadros finais**:

* Espere por 100ms para garantir que os quadros iniciais foram enviados.
* Garanta que TCP\_NODELAY est√° desativado - √© crucial que o algoritmo de Nagle agrupe os quadros finais.
* Envie um pacote ping para aquecer a conex√£o local. Se voc√™ n√£o fizer isso, a pilha de rede do SO colocar√° o primeiro quadro final em um pacote separado.

Finalmente, envie os quadros retidos. Voc√™ deve ser capaz de verificar que eles chegaram em um √∫nico pacote usando o Wireshark.

{% hint style="info" %}
Note que **n√£o funciona para arquivos est√°ticos** em certos servidores, mas arquivos est√°ticos s√£o irrelevantes para ataques de RC.
{% endhint %}

Usando essa t√©cnica, voc√™ pode fazer com que 20-30 solicita√ß√µes cheguem ao servidor simultaneamente - independentemente da varia√ß√£o de rede:

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

**Adaptando-se √† arquitetura alvo**

Vale ressaltar que muitas aplica√ß√µes est√£o por tr√°s de um servidor frontal, e estes podem decidir encaminhar algumas solicita√ß√µes por conex√µes existentes para o back-end, e criar novas conex√µes para outras.

Como resultado, √© importante n√£o atribuir inconsist√™ncias no tempo das solicita√ß√µes ao comportamento da aplica√ß√£o, como mecanismos de bloqueio que permitem apenas um √∫nico thread acessar um recurso por vez. Al√©m disso, o roteamento de solicita√ß√µes front-end √© frequentemente feito com base em cada conex√£o, ent√£o voc√™ pode ser capaz de uniformizar o tempo das solicita√ß√µes realizando um aquecimento de conex√£o do lado do servidor - **enviando algumas solicita√ß√µes inconsequentes pela sua conex√£o antes de realizar o ataque** (isso √© apenas enviar v√°rias solicita√ß√µes antes de come√ßar o ataque real).

#### Mecanismos de bloqueio baseados em sess√£o <a href="#session-based-locking-mechanisms" id="session-based-locking-mechanisms"></a>

Alguns frameworks tentam prevenir a corrup√ß√£o acidental de dados usando alguma forma de **bloqueio de solicita√ß√£o**. Por exemplo, o m√≥dulo de **manipulador de sess√£o nativo do PHP** processa apenas **uma solicita√ß√£o por sess√£o por vez**.

√â extremamente importante identificar esse tipo de comportamento, pois ele pode mascarar vulnerabilidades trivialmente explor√°veis. Se voc√™ notar que todas as suas solicita√ß√µes est√£o sendo processadas sequencialmente, tente enviar cada uma delas usando um token de sess√£o diferente.

#### **Abusando de limites de taxa ou recursos**

Se o aquecimento de conex√£o n√£o fizer diferen√ßa, existem v√°rias solu√ß√µes para esse problema.

Usando o Turbo Intruder, voc√™ pode introduzir um curto atraso do lado do cliente. No entanto, como isso envolve dividir suas solicita√ß√µes de ataque reais em v√°rios pacotes TCP, voc√™ n√£o poder√° usar a t√©cnica de ataque de pacote √∫nico. Como resultado, em alvos com alta varia√ß√£o de rede, o ataque √© improv√°vel de funcionar de forma confi√°vel, independentemente do atraso que voc√™ definir.

<figure><img src="../.gitbook/assets/image (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Em vez disso, voc√™ pode ser capaz de resolver esse problema abusando de um recurso de seguran√ßa comum.

Servidores web frequentemente **atrasam o processamento de solicita√ß√µes se muitas forem enviadas rapidamente**. Ao enviar um grande n√∫mero de solicita√ß√µes fict√≠cias para acionar intencionalmente o limite de taxa ou recursos, voc√™ pode ser capaz de causar um atraso adequado do lado do servidor. Isso torna o ataque de pacote √∫nico vi√°vel mesmo quando a execu√ß√£o atrasada √© necess√°ria.

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
Para mais informa√ß√µes sobre essa t√©cnica, confira o relat√≥rio original em [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)
{% endhint %}

#### Exemplos de Ataque

* **Tubo Intruder - Ataque de pacote √∫nico HTTP2 (1 endpoint)**: Voc√™ pode enviar a solicita√ß√£o para o **Turbo Intruder** (`Extens√µes` -> `Turbo Intruder` -> `Enviar para Turbo Intruder`), voc√™ pode alterar na solicita√ß√£o o valor que deseja for√ßar bruta para **`%s`** como em `csrf=Bn9VQB8OyefIs3ShR2fPESR0FzzulI1d&username=carlos&password=%s` e depois selecionar o **`examples/race-single-packer-attack.py`** no menu suspenso:

<figure><img src="../.gitbook/assets/image (4) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Se voc√™ for **enviar valores diferentes**, voc√™ poderia modificar o c√≥digo com este que usa uma lista de palavras da √°rea de transfer√™ncia:
```python
passwords = wordlists.clipboard
for password in passwords:
engine.queue(target.req, password, gate='race1')
```
{% hint style="warning" %}
Se a web n√£o suportar HTTP2 (apenas HTTP1.1) use `Engine.THREADED` ou `Engine.BURP` em vez de `Engine.BURP2`.
{% endhint %}

* **Tubo Intruder - Ataque de pacote √∫nico HTTP2 (V√°rios endpoints)**: Caso precise enviar uma solicita√ß√£o para 1 endpoint e depois v√°rias para outros endpoints para acionar o RCE, voc√™ pode alterar o script `race-single-packet-attack.py` com algo como:
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=1,
engine=Engine.BURP2
)

# Hardcode the second request for the RC
confirmationReq = '''POST /confirm?token[]= HTTP/2
Host: 0a9c00370490e77e837419c4005900d0.web-security-academy.net
Cookie: phpsessionid=MpDEOYRvaNT1OAm0OtAsmLZ91iDfISLU
Content-Length: 0

'''

# For each attempt (20 in total) send 50 confirmation requests.
for attempt in range(20):
currentAttempt = str(attempt)
username = 'aUser' + currentAttempt

# queue a single registration request
engine.queue(target.req, username, gate=currentAttempt)

# queue 50 confirmation requests - note that this will probably sent in two separate packets
for i in range(50):
engine.queue(confirmationReq, gate=currentAttempt)

# send all the queued requests for this attempt
engine.openGate(currentAttempt)
```
* Tamb√©m est√° dispon√≠vel no **Repeater** atrav√©s da nova op√ß√£o '**Enviar grupo em paralelo**' no Burp Suite.
* Para **limit-overrun**, voc√™ poderia simplesmente adicionar **o mesmo pedido 50 vezes** no grupo.
* Para **aquecimento de conex√£o**, voc√™ poderia **adicionar** no **in√≠cio** do **grupo** alguns **pedidos** para alguma parte n√£o est√°tica do servidor web.
* Para **atrasar** o processo **entre** o processamento **de um pedido e outro** em 2 etapas de subestados, voc√™ poderia **adicionar pedidos extras entre** ambos os pedidos.
* Para um RC **multi-endpoint**, voc√™ poderia come√ßar enviando o **pedido** que **vai para o estado oculto** e depois **50 pedidos** logo ap√≥s ele que **exploram o estado oculto**.

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### BF Bruto

Antes da pesquisa anterior, estes eram alguns payloads usados que apenas tentavam enviar os pacotes o mais r√°pido poss√≠vel para causar um RC.

* **Repeater:** Verifique os exemplos da se√ß√£o anterior.
* **Intruder**: Envie o **pedido** para o **Intruder**, defina o **n√∫mero de threads** para **30** dentro do menu **Op√ß√µes e,** selecione como payload **Null payloads** e gere **30.**
* **Turbo Intruder**
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
pipeline=False
)
a = ['Session=<session_id_1>','Session=<session_id_2>','Session=<session_id_3>']
for i in range(len(a)):
engine.queue(target.req,a[i], gate='race1')
# open TCP connections and send partial requests
engine.start(timeout=10)
engine.openGate('race1')
engine.complete(timeout=60)

def handleResponse(req, interesting):
table.add(req)
```
* **Python - asyncio**
```python
import asyncio
import httpx

async def use_code(client):
resp = await client.post(f'http://victim.com', cookies={"session": "asdasdasd"}, data={"code": "123123123"})
return resp.text

async def main():
async with httpx.AsyncClient() as client:
tasks = []
for _ in range(20): #20 times
tasks.append(asyncio.ensure_future(use_code(client)))

# Get responses
results = await asyncio.gather(*tasks, return_exceptions=True)

# Print results
for r in results:
print(r)

# Async2sync sleep
await asyncio.sleep(0.5)
print(results)

asyncio.run(main())
```
## **Metodologia RC**

### Excedente de limite / TOCTOU

Este √© o tipo mais b√°sico de condi√ß√£o de corrida onde **vulnerabilidades** que **aparecem** em locais que **limitam o n√∫mero de vezes que voc√™ pode realizar uma a√ß√£o**. Como usar o mesmo c√≥digo de desconto v√°rias vezes em uma loja online. Um exemplo muito f√°cil pode ser encontrado neste [**relat√≥rio**](https://medium.com/@pravinponnusamy/race-condition-vulnerability-found-in-bug-bounty-program-573260454c43) ou neste [**bug**](https://hackerone.com/reports/759247)**.**

Existem muitas varia√ß√µes desse tipo de ataque, incluindo:

* Resgatar um cart√£o-presente v√°rias vezes
* Avaliar um produto v√°rias vezes
* Sacar ou transferir dinheiro em excesso ao saldo da sua conta
* Reutilizar uma √∫nica solu√ß√£o CAPTCHA
* Bypassar um limite de taxa anti-for√ßa bruta

### **Subestados ocultos**

Outros RC mais complicados explorar√£o **subestados no estado da m√°quina** que podem permitir que um atacante **abuse** de estados aos quais ele **nunca deveria ter acesso**, mas existe uma **pequena janela** para o atacante acess√°-lo.

1. **Prever subestados ocultos e interessantes**

O primeiro passo √© identificar todos os endpoints que escrevem nele ou leem dados dele e, em seguida, usam esses dados para algo importante. Por exemplo, usu√°rios podem ser armazenados em uma tabela de banco de dados que √© modificada por registro, edi√ß√µes de perfil, inicia√ß√£o de redefini√ß√£o de senha e conclus√£o de redefini√ß√£o de senha.

Podemos usar tr√™s perguntas-chave para descartar endpoints que provavelmente n√£o causar√£o colis√µes. Para cada objeto e os endpoints associados, pergunte:

* **Como o estado √© armazenado?**

Dados armazenados em uma estrutura de dados persistente do lado do servidor s√£o ideais para explora√ß√£o. Alguns endpoints armazenam seu estado inteiramente do lado do cliente, como redefini√ß√µes de senha que funcionam enviando um JWT por e-mail - esses podem ser ignorados com seguran√ßa.

Aplica√ß√µes geralmente armazenam algum estado na sess√£o do usu√°rio. Esses geralmente s√£o um tanto protegidos contra subestados - mais sobre isso mais tarde.

* **Estamos editando ou acrescentando?**

Opera√ß√µes que editam dados existentes (como alterar o e-mail principal de uma conta) t√™m um grande potencial de colis√£o, enquanto a√ß√µes que simplesmente acrescentam a dados existentes (como adicionar um endere√ßo de e-mail adicional) s√£o improv√°veis de serem vulner√°veis a algo al√©m de ataques de excedente de limite.

* **Em que a opera√ß√£o √© baseada?**

A maioria dos endpoints opera em um registro espec√≠fico, que √© procurado usando uma 'chave', como um nome de usu√°rio, token de redefini√ß√£o de senha ou nome de arquivo. Para um ataque bem-sucedido, precisamos de duas opera√ß√µes que usem a mesma chave. Por exemplo, imagine duas implementa√ß√µes plaus√≠veis de redefini√ß√£o de senha:

<figure><img src="../.gitbook/assets/image (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

2. **Procurar por pistas**

Neste ponto, √© hora de **lan√ßar alguns ataques RC** sobre os endpoints potencialmente interessantes para tentar encontrar resultados inesperados em compara√ß√£o com os regulares. **Qualquer desvio da resposta esperada**, como uma mudan√ßa em uma ou mais respostas, ou um efeito secund√°rio como conte√∫dos de e-mail diferentes ou uma mudan√ßa vis√≠vel na sua sess√£o, pode ser uma pista indicando que algo est√° errado.

3. **Provar o conceito**

O passo final √© **provar o conceito e transform√°-lo em um ataque vi√°vel**.

Quando voc√™ envia um lote de solicita√ß√µes, pode descobrir que um par de solicita√ß√µes iniciais desencadeia um estado final vulner√°vel, mas solicita√ß√µes posteriores sobrescrevem/invalidam isso e o estado final √© inexplor√°vel. Neste cen√°rio, voc√™ vai querer eliminar todas as solicita√ß√µes desnecess√°rias - duas devem ser suficientes para explorar a maioria das vulnerabilidades. No entanto, reduzir para duas solicita√ß√µes tornar√° o ataque mais sens√≠vel ao tempo, ent√£o voc√™ pode precisar tentar o ataque v√°rias vezes ou automatiz√°-lo.

### Ataques Sens√≠veis ao Tempo

√Äs vezes voc√™ pode n√£o encontrar condi√ß√µes de corrida, mas as **t√©cnicas para entregar solicita√ß√µes com tempo preciso** ainda podem revelar a presen√ßa de outras vulnerabilidades.

Um exemplo √© quando **timestamps de alta resolu√ß√£o s√£o usados em vez de strings aleat√≥rias criptograficamente** seguras para gerar tokens de seguran√ßa.

Considere um **token de redefini√ß√£o de senha que √© randomizado apenas usando um timestamp**. Neste caso, pode ser poss√≠vel **acionar duas redefini√ß√µes de senha para dois usu√°rios diferentes**, que usam o **mesmo token**. Tudo o que voc√™ precisa fazer √© cronometrar as solicita√ß√µes para que elas gerem o mesmo timestamp.

{% hint style="warning" %}
Para confirmar, por exemplo, a situa√ß√£o anterior, voc√™ poderia simplesmente pedir **2 tokens de redefini√ß√£o de senha ao mesmo tempo** (usando ataque de pacote √∫nico) e verificar se eles s√£o **iguais**.
{% endhint %}

Confira o [**exemplo neste laborat√≥rio**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-exploiting-time-sensitive-vulnerabilities).

## Estudos de caso de subestados ocultos

### Pagar & adicionar um item

[**Confira este laborat√≥rio**](https://portswigger.net/web-security/logic-flaws/examples/lab-logic-flaws-insufficient-workflow-validation) para ver como **pagar** em uma loja e **adicionar um item extra** que voc√™ **n√£o precisar√° pagar**.

### Confirmar outros e-mails

A ideia √© **verificar um endere√ßo de e-mail e alter√°-lo para um diferente ao mesmo tempo** para descobrir se a plataforma verifica o novo alterado.

### Mudar e-mail para 2 endere√ßos de e-mail baseados em Cookie

De acordo com [**este relato**](https://portswigger.net/research/smashing-the-state-machine) o Gitlab era vulner√°vel a uma tomada de controle dessa maneira porque poderia **enviar** o **token de verifica√ß√£o de e-mail de um e-mail para o outro e-mail**.

Voc√™ tamb√©m pode conferir [**este laborat√≥rio**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-single-endpoint) para aprender sobre isso.

### Estados ocultos do banco de dados / Bypass de confirma√ß√£o

Se **2 escritas diferentes** s√£o usadas para **adicionar** **informa√ß√µes** dentro de um **banco de dados**, existe uma pequena por√ß√£o de tempo onde **apenas os primeiros dados foram escritos** no banco de dados. Por exemplo, ao criar um usu√°rio, o **nome de usu√°rio** e **senha** podem ser **escritos** e **depois o token** para confirmar a conta rec√©m-criada √© escrito. Isso significa que por um pequeno tempo o **token para confirmar uma conta √© nulo**.

Portanto, **registrar uma conta e enviar v√°rias solicita√ß√µes com um token vazio** (`token=` ou `token[]=` ou qualquer outra varia√ß√£o) para confirmar a conta imediatamente poderia permitir **confirmar uma conta** onde voc√™ n√£o controla o e-mail.

Confira [**este laborat√≥rio**](https://portswigger.net/web-security/race-conditions/lab-race-conditions-partial-construction) para verificar um exemplo.

### Bypass de 2FA

O seguinte pseudo-c√≥digo demonstra como um site poderia ser vulner√°vel a uma varia√ß√£o de ataque de corrida dessa forma:
```python
session['userid'] = user.userid
if user.mfa_enabled:
session['enforce_mfa'] = True
# generate and send MFA code to user
# redirect browser to MFA code entry form
```
Como voc√™ pode ver, isso √© de fato uma **sequ√™ncia de m√∫ltiplos passos dentro do intervalo de uma √∫nica requisi√ß√£o**. Mais importante, ela passa por um subestado no qual o **usu√°rio temporariamente possui uma sess√£o v√°lida de login**, **mas a MFA ainda n√£o est√° sendo aplicada**. Um atacante poderia potencialmente explorar isso enviando uma requisi√ß√£o de login junto com uma requisi√ß√£o para um endpoint sens√≠vel e autenticado.

### Persist√™ncia eterna OAuth2

Existem v√°rios [**provedores OAuth**](https://en.wikipedia.org/wiki/List_of_OAuth_providers). Esses servi√ßos permitem que voc√™ crie uma aplica√ß√£o e autentique usu√°rios que o provedor registrou. Para fazer isso, o **cliente** precisar√° **permitir que sua aplica√ß√£o** acesse alguns dos seus dados dentro do **provedor OAuth**.\
At√© aqui, apenas um login comum com google/linkedin/github... onde voc√™ √© apresentado com uma p√°gina dizendo: "_Aplica√ß√£o \<InsertCoolName> quer acessar suas informa√ß√µes, voc√™ deseja permitir?_"

#### Condi√ß√£o de Corrida em `authorization_code`

O **problema** aparece quando voc√™ **aceita** e automaticamente envia um **`authorization_code`** para a aplica√ß√£o maliciosa. Ent√£o, essa **aplica√ß√£o abusa de uma Condi√ß√£o de Corrida no provedor de servi√ßo OAuth para gerar mais de um AT/RT** (_Token de Autentica√ß√£o/Token de Atualiza√ß√£o_) a partir do **`authorization_code`** para sua conta. Basicamente, ela abusar√° do fato de voc√™ ter aceitado a aplica√ß√£o para acessar seus dados para **criar v√°rias contas**. Ent√£o, se voc√™ **parar de permitir que a aplica√ß√£o acesse seus dados, um par de AT/RT ser√° deletado, mas os outros ainda ser√£o v√°lidos**.

#### Condi√ß√£o de Corrida em `Refresh Token`

Uma vez que voc√™ tenha **obtido um RT v√°lido**, voc√™ poderia tentar **abusar dele para gerar v√°rios AT/RT** e **mesmo que o usu√°rio cancele as permiss√µes** para a aplica√ß√£o maliciosa acessar seus dados, **v√°rios RTs ainda ser√£o v√°lidos.**

## **RC em WebSockets**

Em [**WS_RaceCondition_PoC**](https://github.com/redrays-io/WS_RaceCondition_PoC) voc√™ pode encontrar um PoC em Java para enviar mensagens websocket em **paralelo** para abusar de **Condi√ß√µes de Corrida tamb√©m em Web Sockets**.

## Refer√™ncias

* [https://hackerone.com/reports/759247](https://hackerone.com/reports/759247)
* [https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html](https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html)
* [https://hackerone.com/reports/55140](https://hackerone.com/reports/55140)
* [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)
* [https://portswigger.net/web-security/race-conditions](https://portswigger.net/web-security/race-conditions)

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas dicas de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) no github.

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) para construir e **automatizar fluxos de trabalho** com facilidade, alimentados pelas **ferramentas comunit√°rias mais avan√ßadas**.\
Obtenha Acesso Hoje:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
