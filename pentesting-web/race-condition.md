# рд░реЗрд╕ рдХрдВрдбреАрд╢рди

<figure><img src="../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдмрдирд╛рдПрдВ рдФрд░ рд╡рд┐рд╢реНрд╡ рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛** рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

## RC рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛

RC рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреА рдореБрдЦреНрдп рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рдмрд╣реБрдд рдХрдо рд╕рдордп рдЕрдВрддрд░ рдХреЗ рд╕рд╛рде рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ (рдЖрдорддреМрд░ рдкрд░ >1ms)ред рдЗрд╕ рдЕрдзреНрдпрд╛рдп рдореЗрдВ, рдЗрд╕реЗ рд╕рдВрднрд╡ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рд╕рдорд╛рдзрд╛рди рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВред

<figure><img src="../.gitbook/assets/image (5) (1).png" alt=""><figcaption></figcaption></figure>

### рдПрдХрд▓-рдкреИрдХреЗрдЯ рд╣рдорд▓рд╛ (HTTP/2) / рдЕрдВрддрд┐рдо-рдмрд╛рдЗрдЯ рд╕рд┐рдВрдХ (HTTP/1.1)

HTTP2 рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ рдХрд┐ **рдПрдХрд▓ TCP рдХрдиреЗрдХреНрд╢рди рдореЗрдВ 2 рдЕрдиреБрд░реЛрдз** рднреЗрдЬреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ (рдЬрдмрдХрд┐ HTTP/1.1 рдореЗрдВ рд╡реЗ рдХреНрд░рдорд╢рдГ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП)ред\
рдПрдХрд▓ TCP рдкреИрдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ **рдиреЗрдЯрд╡рд░реНрдХ рдЬрд┐рдЯрд░ рдХрд╛ рдкреНрд░рднрд╛рд╡ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ**, рдЗрд╕рд▓рд┐рдП рдпрд╣ рд░реЗрд╕ рдХрдВрдбреАрд╢рди рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рднреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, **рджреЛ рдЕрдиреБрд░реЛрдз рдПрдХ рд╕реНрдерд┐рд░ рд░реЗрд╕ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реИрдВ** рдзрдиреНрдпрд╡рд╛рдж рд╣реИ **рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдЬрд┐рдЯрд░** рдХреЗ рд▓рд┐рдП - рдЕрдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд╛рд░рдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рдЕрдиреБрдкреНрд░рдмрдВрдзрди рдХреЗ рд╕рдордп рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреА рдЕрдиреБрд░реЛрдз-рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╕рдордп рдореЗрдВ рд╡рд┐рднрд┐рдиреНрдирддрд╛рдПрдВред

рд▓реЗрдХрд┐рди, HTTP/1.1 '**рдЕрдВрддрд┐рдо-рдмрд╛рдЗрдЯ рд╕рд┐рдВрдХ**' рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдмрдбрд╝реЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рдкреВрд░реНрд╡-рднреЗрдЬреЗрдВ рдФрд░ рдлрд┐рд░ рдПрдХрд▓ TCP рдкреИрдХреЗрдЯ рдХреЗ рд╕рд╛рде **20-30 рдЕрдиреБрд░реЛрдз рдкреВрд░реЗ рдХрд░реЗрдВ**ред

**рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рдмрдбрд╝реЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рдкреВрд░реНрд╡-рднреЗрдЬреЗрдВ**:

* рдпрджрд┐ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдХреЛрдИ рдмреЙрдбреА рдирд╣реАрдВ рд╣реИ, рддреЛ рд╕рднреА рд╣реИрдбрд░ рднреЗрдЬреЗрдВ, рд▓реЗрдХрд┐рди END\_STREAM рдлрд╝реНрд▓реИрдЧ рд╕реЗрдЯ рди рдХрд░реЗрдВред END\_STREAM рд╕реЗрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрдХ рдЦрд╛рд▓реА рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдо рд░реЛрдХреЗрдВред
* рдпрджрд┐ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдПрдХ рдмреЙрдбреА рд╣реИ, рддреЛ рд╣реИрдбрд░ рдФрд░ рдЕрдВрддрд┐рдо рдмрд╛рдЗрдЯ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рд╕рднреА рдмреЙрдбреА рдбреЗрдЯрд╛ рднреЗрдЬреЗрдВред рдЕрдВрддрд┐рдо рдмрд╛рдЗрдЯ рдпреБрдХреНрдд рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдо рд░реЛрдХреЗрдВред

рдЕрдЧрд▓реЗ, **рдЕрдВрддрд┐рдо рдлрд╝реНрд░реЗрдо рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реЛрдВ**:

* рдкрд╣рд▓реЗ рддреЛ 100ms рддрдХ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдлрд╝реНрд░реЗрдо рднреЗрдЬ рджрд┐рдП рдЧрдП рд╣реЛрдВред
* рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ TCP\_NODELAY рдЕрдХреНрд╖рдо рд╣реИ - рдирд╛рдЧрд▓ рдХреЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЗ рджреНрд╡рд╛рд░рд╛ рдЕрдВрддрд┐рдо рдлрд╝реНрд░реЗрдо рдХреЛ рдмреИрдЪ рдореЗрдВ рднреЗрдЬрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред
* рд╕реНрдерд╛рдиреАрдп рдХрдиреЗрдХреНрд╢рди рдХреЛ рдЧрд░реНрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд┐рдВрдЧ рдкреИрдХреЗрдЯ рднреЗрдЬреЗрдВред рдпрджрд┐ рдЖрдк рдР
#### **рджрд░ рдпрд╛ рд╕рдВрд╕рд╛рдзрди рд╕реАрдорд╛рдУрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ**

рдпрджрд┐ рдХрдиреЗрдХреНрд╢рди рд╡рд╛рд░реНрдорд┐рдВрдЧ рдХреЛрдИ рдлрд░реНрдХ рдирд╣реАрдВ рдкрдбрд╝рддрд╛ рд╣реИ, рддреЛ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╕рдорд╛рдзрд╛рди рд╣реИрдВред

Turbo Intruder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдПрдХ рдЫреЛрдЯреА рд╕рдордп-рд╕рдВрдмрдВрдзреА рджреЗрд░реА рд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдЖрдкрдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╣рдорд▓рд╛ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдХрдИ TCP рдкреИрдХреЗрдЯреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝рд╛ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдПрдХрд▓-рдкреИрдХреЗрдЯ рд╣рдорд▓рд╛ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд╕рдХреЗрдВрдЧреЗред рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдЙрдЪреНрдЪ-рдЬрд┐рдЯрд░ рд▓рдХреНрд╖реНрдпреЛрдВ рдкрд░, рдЪрд╛рд╣реЗ рдЖрдк рдХрд┐рддрдиреА рднреА рджреЗрд░реА рд╕реЗрдЯ рдХрд░реЗрдВ, рд╣рдорд▓рд╛ рд╕рдВрднрд╡рддрдГ рд╕реНрдерд┐рд░рддрд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред

<figure><img src="../.gitbook/assets/image (2) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рдЖрдк рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд╡реЗрдм рд╕рд░реНрд╡рд░ рдЕрдХреНрд╕рд░ **рдЕрдЧрд░ рдмрд╣реБрдд рддреЗрдЬреА рд╕реЗ рдмрд╣реБрдд рд╕рд╛рд░реЗ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ рддреЛ рдЙрдирдХреА рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдореЗрдВ рджреЗрд░реА рдХрд░рддреЗ рд╣реИрдВ**ред рдПрдХ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдбрдореА рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рднреЗрдЬрдХрд░ рд░реЗрдЯ рдпрд╛ рд╕рдВрд╕рд╛рдзрди рд╕реАрдорд╛ рдХреЛ рдЗрдЪреНрдЫрд┐рдд рд░реВрдк рд╕реЗ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдХреЗ, рдЖрдк рд╕рдВрдЧрдд рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рджреЗрд░реА рдХрд╛ рдХрд╛рд░рдг рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рд╕реЗ рдПрдХрд▓-рдкреИрдХреЗрдЯ рд╣рдорд▓рд╛ рд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИ, рдЬрдм рд╡рд┐рд▓рдВрдмрд┐рдд рдирд┐рд╖реНрдкрд╛рджрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine) рдореЗрдВ рдореВрд▓ рд░рд┐рдкреЛрд░реНрдЯ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
{% endhint %}

#### рд╣рдорд▓рд╛ рдЙрджрд╛рд╣рд░рдг

* **Tubo Intruder - HTTP2 single-packet attack (1 endpoint)**: рдЖрдк рдЕрдиреБрд░реЛрдз рдХреЛ **Turbo intruder** (`Extensions` -> `Turbo Intruder` -> `Send to Turbo Intruder`) рдХреЛ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ, рдЖрдк рдЕрдиреБрд░реЛрдз рдореЗрдВ рдЬрд┐рд╕ рдорд╛рди рдХреЛ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдЙрд╕реЗ **`%s`** рдХреА рддрд░рд╣ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ `csrf=Bn9VQB8OyefIs3ShR2fPESR0FzzulI1d&username=carlos&password=%s` рдФрд░ рдлрд┐рд░ рдбреНрд░реЙрдк рдбрд╛рдЙрди рд╕реЗ **`examples/race-single-packer-attack.py`** рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ:

<figure><img src="../.gitbook/assets/image (4) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

рдпрджрд┐ рдЖрдк **рд╡рд┐рднрд┐рдиреНрди рдорд╛рди** рднреЗрдЬрдиреЗ рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдк рдХреНрд▓рд┐рдкрдмреЛрд░реНрдб рд╕реЗ рдПрдХ рд╡рд░реНрдбрд▓рд┐рд╕реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЗрд╕ рдХреЛрдб рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```python
passwords = wordlists.clipboard
for password in passwords:
engine.queue(target.req, password, gate='race1')
```
{% hint style="warning" %}
рдпрджрд┐ рд╡реЗрдм HTTP2 рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддреА рд╣реИ (рдХреЗрд╡рд▓ HTTP1.1), рддреЛ `Engine.BURP2` рдХреА рдмрдЬрд╛рдп `Engine.THREADED` рдпрд╛ `Engine.BURP` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
{% endhint %}

* **Tubo Intruder - HTTP2 single-packet attack (Several endpoints)**: рдпрджрд┐ рдЖрдкрдХреЛ RCE рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 1 рдПрдВрдбрдкреЙрдЗрдВрдЯ рдкрд░ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рдФрд░ рдлрд┐рд░ рдЕрдиреНрдп рдПрдВрдбрдкреЙрдЗрдВрдЯ рдкрд░ рдХрдИ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ, рддреЛ рдЖрдк `race-single-packet-attack.py` рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░рд╣ рд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ:
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=1,
engine=Engine.BURP2
)

# Hardcode the second request for the RC
confirmationReq = '''POST /confirm?token[]= HTTP/2
Host: 0a9c00370490e77e837419c4005900d0.web-security-academy.net
Cookie: phpsessionid=MpDEOYRvaNT1OAm0OtAsmLZ91iDfISLU
Content-Length: 0

'''

# For each attempt (20 in total) send 50 confirmation requests.
for attempt in range(20):
currentAttempt = str(attempt)
username = 'aUser' + currentAttempt

# queue a single registration request
engine.queue(target.req, username, gate=currentAttempt)

# queue 50 confirmation requests - note that this will probably sent in two separate packets
for i in range(50):
engine.queue(confirmationReq, gate=currentAttempt)

# send all the queued requests for this attempt
engine.openGate(currentAttempt)
```
* рдпрд╣ рднреА **Repeater** рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИ рдмрд░реНрдк рд╕реНрд╡реАрдЯ рдХреЗ рдирдП '**рд╕рдореВрд╣ рдХреЛ рдкреИрд░рд▓реЗрд▓ рдореЗрдВ рднреЗрдЬреЗрдВ**' рд╡рд┐рдХрд▓реНрдк рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред
* **рд▓рд┐рдорд┐рдЯ-рдУрд╡рд░рди** рдХреЗ рд▓рд┐рдП рдЖрдк рд╕рд┐рд░реНрдл **рд╕рдореВрд╣ рдореЗрдВ рд╕рдорд╛рди рдЕрдиреБрд░реЛрдз рдХреЛ 50 рдмрд╛рд░ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ**ред
* **рдХрдиреЗрдХреНрд╢рди рд╡рд╛рд░реНрдорд┐рдВрдЧ** рдХреЗ рд▓рд┐рдП, рдЖрдк **рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЗ рдХреБрдЫ рдЧреИрд░ рд╕реНрдерд┐рд░ рднрд╛рдЧ рдХреЗ рд▓рд┐рдП рд╕рдореВрд╣ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдХреБрдЫ рдЕрдиреБрд░реЛрдз рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ**ред
* **рджреЗрд░реА рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП, рдПрдХ 2 рдЙрдк-рдЕрд╡рд╕реНрдерд╛ рдЪрд░рдг рдореЗрдВ **рдПрдХ рдЕрдиреБрд░реЛрдз рдФрд░ рджреВрд╕рд░реЗ рдХреЗ рдмреАрдЪ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЗ рдмреАрдЪ рдЕрддрд┐рд░рд┐рдХреНрдд рдЕрдиреБрд░реЛрдз рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ**ред
* **рдорд▓реНрдЯреА-рдПрдВрдбрдкреЙрдЗрдВрдЯ** рдЖрд░рд╕реА рдХреЗ рд▓рд┐рдП, рдЖрдк **рдЫрд┐рдкреЗ рд╣реБрдП рд╕реНрдерд┐рддрд┐ рдХреЛ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрд░реЛрдз** рдХреЛ рднреЗрдЬрдирд╛ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ рдЗрд╕рдХреЗ рдмрд╛рдж **50 рдЕрдиреБрд░реЛрдз** рдЬреЛ рдЫрд┐рдкреЗ рд╣реБрдП рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред

<figure><img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Raw BF

рдкрд┐рдЫрд▓реЗ рд╢реЛрдз рд╕реЗ рдкрд╣рд▓реЗ рдпреЗ рдХреБрдЫ рдкреЗрд▓реЛрдбреНрд╕ рдереЗ рдЬреЛ рд╕рд┐рд░реНрдл рдПрдХ рд░реЗрд╕ рдХрдВрдбреАрд╢рди рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рдЬрд┐рддрдиреА рддреЗрдЬреА рд╕реЗ рд╣реЛ рд╕рдХреЗ рднреЗрдЬрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рдереЗред

* **Repeater:** рдкрд┐рдЫрд▓реЗ рдЦрдВрдб рд╕реЗ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВред
* **Intruder**: **Intruder** рдХреЛ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ, **рд╡рд┐рдХрд▓реНрдк** рдореЗрдиреВ рдореЗрдВ **рд╕реНрдерд╛рдиреАрдп рдзрд╛рдЧреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛** рдХреЛ **30** рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░, рдкреЗрд▓реЛрдб рдХреЗ рд░реВрдк рдореЗрдВ **Null payloads** рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ **30** рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВред
* **Turbo Intruder**
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
pipeline=False
)
a = ['Session=<session_id_1>','Session=<session_id_2>','Session=<session_id_3>']
for i in range(len(a)):
engine.queue(target.req,a[i], gate='race1')
# open TCP connections and send partial requests
engine.start(timeout=10)
engine.openGate('race1')
engine.complete(timeout=60)

def handleResponse(req, interesting):
table.add(req)
```
* **Python - asyncio**
```python
import asyncio
import httpx

async def use_code(client):
resp = await client.post(f'http://victim.com', cookies={"session": "asdasdasd"}, data={"code": "123123123"})
return resp.text

async def main():
async with httpx.AsyncClient() as client:
tasks = []
for _ in range(20): #20 times
tasks.append(asyncio.ensure_future(use_code(client)))

# Get responses
results = await asyncio.gather(*tasks, return_exceptions=True)

# Print results
for r in results:
print(r)

# Async2sync sleep
await asyncio.sleep(0.5)
print(results)

asyncio.run(main())
```
## **RC Methodology**

### Limit-overrun / TOCTOU

рдпрд╣ рд╕рдмрд╕реЗ рдореВрд▓рднреВрдд рдкреНрд░рдХрд╛рд░ рдХреА рд░реЗрд╕ рдХрдВрдбреАрд╢рди рд╣реИ рдЬрд╣рд╛рдВ **рдХрдо рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреЗ рдХреА рд╕реАрдорд╛ рд░рдЦрдиреЗ рд╡рд╛рд▓реА рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛рдПрдВ** рд╣реЛрддреА рд╣реИрдВред рдЬреИрд╕реЗ рдХрд┐ рд╡реЗрдм рд╕реНрдЯреЛрд░ рдореЗрдВ рдХрдИ рдмрд╛рд░ рдПрдХ рд╣реА рдбрд┐рд╕реНрдХрд╛рдЙрдВрдЯ рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред рдЗрд╕рдХрд╛ рдПрдХ рдЖрд╕рд╛рди рдЙрджрд╛рд╣рд░рдг [**рдЗрд╕ рд░рд┐рдкреЛрд░реНрдЯ**](https://medium.com/@pravinponnusamy/race-condition-vulnerability-found-in-bug-bounty-program-573260454c43) рдпрд╛ [**рдЗрд╕ рдмрдЧ**](https://hackerone.com/reports/759247) рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рдорд▓реЗ рдХреЗ рдХрдИ рд░реВрдк рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* рдПрдХ рдЧрд┐рдлреНрдЯ рдХрд╛рд░реНрдб рдХреЛ рдХрдИ рдмрд╛рд░ рд░рд┐рдбреАрдо рдХрд░рдирд╛
* рдПрдХ рдкреНрд░реЛрдбрдХреНрдЯ рдХреЛ рдХрдИ рдмрд╛рд░ рд░реЗрдЯ рдХрд░рдирд╛
* рдЕрдкрдиреЗ рдЦрд╛рддрд╛ рд╢реЗрд╖ рд░рд╛рд╢рд┐ рд╕реЗ рдЕрдзрд┐рдХ рдирдХрджреА рдирд┐рдХрд╛рд▓рдирд╛ рдпрд╛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛
* рдПрдХрд▓ CAPTCHA рд╕рдорд╛рдзрд╛рди рдХрд╛ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛
* рдПрдХ рдПрдВрдЯреА-рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рджрд░ рд╕реАрдорд╛ рдХреЛ рджреМрдбрд╝рдирд╛

### **рдЫрд┐рдкреЗ рд╣реБрдП рдЙрдк-рдЕрд╡рд╕реНрдерд╛рдПрдВ**

рджреВрд╕рд░реЗ рд╕рдмрд╕реЗ рдЬрдЯрд┐рд▓ RC рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЙрд╕рдХреЗ рдкрд╣реБрдВрдЪ рдХреЗ рд▓рд┐рдП рдХрднреА рдирд╣реАрдВ рдереЗ рдЕрд╡рд╕реНрдерд╛рдУрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдорд╢реАрди рдХреА рдЕрд╡рд╕реНрдерд╛ рдореЗрдВ **рдЙрдк-рдЕрд╡рд╕реНрдерд╛рдУрдВ рдХрд╛ рд╢реЛрд╖рдг** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЗрд╕реЗ рдПрдХ **рдЫреЛрдЯреА рд╕рдордп-рдЦрд┐рдбрд╝рдХреА** рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╡рд╣ рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИред

1. **рдЫрд┐рдкреЗ рд╣реБрдП рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдЙрдк-рдЕрд╡рд╕реНрдерд╛рдУрдВ рдХреА рд╕рдВрднрд╛рд╡рд┐рдд рдкрд╣рдЪрд╛рди рдХрд░реЗрдВ**

рдкрд╣рд▓рд╛ рдХрджрдо рд╣реИ рд╕рднреА рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛ рдЬреЛ рдЗрд╕реЗ рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рдпрд╛ рдЙрд╕рд╕реЗ рдбреЗрдЯрд╛ рдкрдврд╝рддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ рдЙрд╕ рдбреЗрдЯрд╛ рдХрд╛ рдХреБрдЫ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрд╛рдо рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдбреЗрдЯрд╛рдмреЗрд╕ рдЯреЗрдмрд▓ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдкрдВрдЬреАрдХрд░рдг, рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓-рд╕рдВрдкрд╛рджрди, рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдкреНрд░рд╛рд░рдВрдн рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдкреВрд░реНрдг рдХрд░рдиреЗ рд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рд╣рдо рддреАрди рдореБрдЦреНрдп рдкреНрд░рд╢реНрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╕рдВрднрд╛рд╡рд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдЯрдХрд░рд╛рд╡ рдХрд╛ рдХрд╛рд░рдг рдирд╣реАрдВ рд╣реЛ рд╕рдХреЗред рдкреНрд░рддреНрдпреЗрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдкреВрдЫреЗрдВ:

* **рдЕрд╡рд╕реНрдерд╛ рдХреИрд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИ?**

рд╕реНрдерд╛рдпреА рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдбреЗрдЯрд╛ рдЗрд╕рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЖрджрд░реНрд╢ рд╣реИред рдХреБрдЫ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдЕрдкрдиреА рдЕрд╡рд╕реНрдерд╛ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рдИрдореЗрд▓ рднреЗрдЬрдХрд░ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ - рдЗрдиреНрд╣реЗрдВ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдЫреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рдЕрдХреНрд╕рд░ рдХреБрдЫ рдЕрд╡рд╕реНрдерд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рддреНрд░ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреЗ рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ рдЕрд╡рд╕реНрдерд╛рдУрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕рдВрд░рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ - рдЗрд╕ рдкрд░ рдмрд╛рдж рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрдЧреАред

* **рдХреНрдпрд╛ рд╣рдо рд╕рдВрдкрд╛рджрди рдпрд╛ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рдХрд░ рд░рд╣реЗ рд╣реИрдВ?**

рдореМрдЬреВрджрд╛ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХрд╛рд░реНрд░рд╡рд╛рдИ (рдЬреИрд╕реЗ рдХрд┐ рдЦрд╛рддрд╛ рдХрд╛ рдкреНрд░рд╛рдердорд┐рдХ рдИрдореЗрд▓ рдкрддрд╛ рдмрджрд▓рдирд╛) рдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдЯрдХрд░рд╛рд╡ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛрддреА рд╣реИ, рдЬрдмрдХрд┐ рдореМрдЬреВрджрд╛ рдбреЗрдЯрд╛ рдореЗрдВ рд╕рд┐рд░реНрдл рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрд░рд╡рд╛рдИ (рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдИрдореЗрд▓ рдкрддрд╛ рдЬреЛрдбрд╝рдирд╛) рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЗрд╡рд▓ рд╕реАрдорд┐рдд рд╣реЛрддреА рд╣реИ, рдФрд░ рдЗрд╕рд╕реЗ рдЕрдзрд┐рдХ рдХреБрдЫ рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдХрд┐рд╕реА рднреА рдЯрдХрд░рд╛рд╡ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред

* **рдСрдкрд░реЗрд╢рди рдХрд┐рд╕ рдкрд░ рдХреА рдЬрд╛рддреА рд╣реИ?**

рдЕрдзрд┐рдХрд╛рдВрд╢ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд░рд┐рдХреЙрд░реНрдб рдкрд░ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕реЗ рдПрдХ 'рдХреБрдВрдЬреА' рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦреЛрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо, рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЯреЛрдХрди рдпрд╛ рдлрд╝рд╛рдЗрд▓рдирд╛рдоред рд╕рдлрд▓ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рджреЛ рдСрдкрд░реЗрд╢рди рдЪрд╛рд╣рд┐рдП рдЬреЛ рдПрдХ рд╣реА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рджреЛ рд╕рдВрднрд╛рд╡рд┐рдд рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЕрдорд▓реЛрдВ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ:

<figure><img src="../.gitbook/assets/image (2) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

2. **рд╕рдВрдХреЗрддреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдм рдХрд░реЗрдВ**

рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░ рдпрд╣ рд╕рдордп рд╣реИ рдХ
### 2FA рдХреЛ рдмрд╛рдЗрдкрд╛рд╕ рдХрд░реЗрдВ

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд╕реЗрдбреЛ-рдХреЛрдб рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдПрдХ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреИрд╕реЗ рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рд░реЗрд╕ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддреА рд╣реИ:
```python
session['userid'] = user.userid
if user.mfa_enabled:
session['enforce_mfa'] = True
# generate and send MFA code to user
# redirect browser to MFA code entry form
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ **рдПрдХрд▓ рдЕрдиреБрд░реЛрдз рдХреЗ рджреМрд░рд╛рди рдХрдИ рдЪрд░рдгреЛрдВ рдХрд╛ рдЕрдиреБрдХреНрд░рдо** рд╣реИред рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдЗрд╕рдореЗрдВ рдПрдХ рдЙрдк-рд╕реНрдерд┐рддрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдпреВрдЬрд░ рдХреЗ рдкрд╛рд╕ рдПрдХ рдорд╛рдиреНрдп рд▓реЙрдЧ-рдЗрди рд╕рддреНрд░ рд╣реЛрддрд╛ рд╣реИ, **рд▓реЗрдХрд┐рди MFA рдЕрднреА рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛ рд░рд╣рд╛ рд╣реИ**ред рдХрд┐рд╕реА рд╣рдорд▓рд╛рд╡рд░реНрдзреА рд╡реНрдпрдХреНрддрд┐ рджреНрд╡рд╛рд░рд╛ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд▓реЙрдЧрд┐рди рдЕрдиреБрд░реЛрдз рднреЗрдЬрдХрд░ рд╕рдВрд╡реЗрджрдирд╢реАрд▓, рдкреНрд░рдорд╛рдгрд┐рдд рдЕрдВрдд рдмрд┐рдВрджреБ рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рднреА рднреЗрдЬрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### OAuth2 рдЕрд╡рд┐рдирд╛рд╢реА рдЯрд┐рдХрд╛рдХрд░рдг

рдХрдИ [**OAUth рдкреНрд░рджрд╛рддрд╛рдУрдВ**](https://en.wikipedia.org/wiki/List\_of\_OAuth\_providers) рд╣реИрдВред рдпреЗ рд╕реЗрд╡рд╛рдПрдВ рдЖрдкрдХреЛ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдмрдирд╛рдиреЗ рдФрд░ рдкреНрд░рджрд╛рддрд╛ рджреНрд╡рд╛рд░рд╛ рдкрдВрдЬреАрдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВрдЧреАред рдЗрд╕рдХреЗ рд▓рд┐рдП, **рдХреНрд▓рд╛рдЗрдВрдЯ** рдХреЛ рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рдХреЗ рдХреБрдЫ рд╣рд┐рд╕реНрд╕реЗ рддрдХ рдкрд╣реБрдВрдЪ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП **рдЖрдкрдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдЕрдиреБрдорддрд┐** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред\
рддреЛ, рдЕрдм рддрдХ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдмрд╕ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд▓реЙрдЧрд┐рди рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХреЛ рдПрдХ рдкреЗрдЬ рдХреЗ рд╕рд╛рде рдкреНрд░реЛрдореНрдкреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: "_рдПрдкреНрд▓рд┐рдХреЗрд╢рди \<InsertCoolName> рдЖрдкрдХреА рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рдХреНрдпрд╛ рдЖрдк рдЗрд╕реЗ рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рдЪрд╛рд╣реЗрдВрдЧреЗ?_"

#### `authorization_code` рдореЗрдВ рд░реЗрд╕ рдХрдВрдбреАрд╢рди

рд╕рдорд╕реНрдпрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рдЖрдк рдЗрд╕реЗ **рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ** рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдПрдХ **`authorization_code`** рдХреЛ рджреБрд╖реНрдкреНрд░рднрд╛рд╡реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рднреЗрдЬрддреЗ рд╣реИрдВред рдлрд┐рд░, рдпрд╣ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди OAUth рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдореЗрдВ рд░реЗрд╕ рдХрдВрдбреАрд╢рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЖрдкрдХреЗ рдЦрд╛рддреЗ рдХреЗ рд▓рд┐рдП `authorization_code` рд╕реЗ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ AT/RT** (_рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЯреЛрдХрди/рддрд╛рдЬрдЧреА рдЯреЛрдХрди_) рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХреЗред рдореВрд▓ рд░реВрдк рд╕реЗ, рдпрд╣ рдЗрд╕ рдмрд╛рдд рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ рдХрд┐ рдЖрдкрдиреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА рд╣реИ рддрд╛рдХрд┐ **рдХрдИ рдЦрд╛рддреЗ рдмрдирд╛ рд╕рдХреЗрдВ**ред рдлрд┐рд░, рдпрджрд┐ рдЖрдк **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рдмрдВрдж рдХрд░ рджреЗрддреЗ рд╣реИрдВ рддреЛ рдПрдХ рдкреЗрдпрд░ AT/RT рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рд▓реЗрдХрд┐рди рдЕрдиреНрдп рд╡рд╛рд▓реЗ рдЕрднреА рднреА рдорд╛рдиреНрдп рд░рд╣реЗрдВрдЧреЗ**ред

#### `Refresh Token` рдореЗрдВ рд░реЗрд╕ рдХрдВрдбреАрд╢рди

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдкрдиреЗ **рдПрдХ рдорд╛рдиреНрдп RT рдкреНрд░рд╛рдкреНрдд рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ** рддреЛ рдЖрдк рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕реЗ рджреБрд╖реНрдкреНрд░рднрд╛рд╡реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдХрдИ AT/RT рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ рдФрд░ **рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреБрд╖реНрдкреНрд░рднрд╛рд╡реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд░рджреНрдж рдХрд░ рджреЗрддрд╛ рд╣реИ рддреЛ рдХрдИ RT рдЕрднреА рднреА рдорд╛рдиреНрдп рд░рд╣реЗрдВрдЧреЗ**ред

## **рд╡реЗрдмрд╕реЙрдХреЗрдЯ рдореЗрдВ RC**

[**WS\_RaceCondition\_PoC**](https://github.com/redrays-io/WS\_RaceCondition\_PoC) рдореЗрдВ рдЖрдкрдХреЛ рдЬрд╛рд╡рд╛ рдореЗрдВ рд╡реЗрдмрд╕реЙрдХреЗрдЯ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ **рд╕рдордпрд╛рдиреБрд╕рд╛рд░** рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ PoC рдорд┐рд▓реЗрдЧрд╛ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **рд╡реЗрдмрд╕реЙрдХреЗрдЯ рдореЗрдВ рднреА рд░реЗрд╕ рдХрдВрдбреАрд╢рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## рд╕рдВрджрд░реНрдн

* [https://hackerone.com/reports/759247](https://hackerone.com/reports/759247)
* [https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html](https://pandaonair.com/2020/06/11/race-conditions-exploring-the-possibilities.html)
* [https://hackerone.com/reports/55140](https://hackerone.com/reports/55140)
* [https://portswigger.net/research/smashing-the-state-machine](https://portswigger.net/research/smashing-the-state-machine)
* [https://portswigger.net/web-security/race-conditions](https://portswigger.net/web-security/race-conditions)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣реЗрдВрдЧреЗ? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд░рдЦрддреЗ рд╣реИрдВ? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░
