# Iframe 陷阱

<details>

<summary><strong>从零开始学习 AWS 黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS 红队专家）</strong></a><strong>！</strong></summary>

支持 HackTricks 的其他方式：

* 如果您想看到您的公司在 HackTricks 中被广告，或者**下载 HackTricks 的 PDF**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 探索[**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们独家[**NFTs**](https://opensea.io/collection/the-peass-family)收藏
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或在 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** 上关注我们**。
* 通过向 [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享您的黑客技巧。

</details>

## 基本信息

通过滥用 XSS 通过 iframe 窃取用户在网页上移动时的信息，最初是在 trustedsec.com 的这两篇文章中发布的：[**这里**](https://trustedsec.com/blog/persisting-xss-with-iframe-traps) **和** [**这里**](https://trustedsec.com/blog/js-tap-weaponizing-javascript-for-red-teams)。

攻击始于一个易受 XSS 攻击的页面，可以通过让**受害者不离开 XSS**，使他们在**iframe 中导航**，占据整个 Web 应用程序。

XSS 攻击基本上会在 iframe 中将网页加载到整个屏幕的 100% 中。因此，受害者**不会注意到他在 iframe 中**。然后，如果受害者通过在 iframe 中点击链接（在网页内）来导航页面，他将**在 iframe 中导航**，加载的任意 JS 将窃取此导航中的信息。

此外，为了使其更加逼真，可以使用一些**监听器**来检查 iframe 何时更改页面的位置，并使用用户认为自己在使用浏览器移动页面的位置更新浏览器的 URL。

<figure><img src="../.gitbook/assets/image (1248).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png">https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png</a></p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (1249).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png">https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png</a></p></figcaption></figure>

此外，可以使用监听器窃取敏感信息，不仅包括受害者正在访问的其他页面，还包括用于**填写表单**并发送它们（凭据？）或**窃取本地存储**的数据...

当然，主要的限制是**受害者关闭选项卡或在浏览器中输入另一个 URL 将会逃离 iframe**。另一种方法是**刷新页面**，但是，这可能会被部分地**通过在每次在 iframe 中加载新页面时禁用右键单击上下文菜单**或注意到用户的鼠标离开 iframe 时，潜在地点击浏览器的重新加载按钮来防止，此时浏览器的 URL 将被更新为易受 XSS 攻击的原始 URL，因此如果用户重新加载它，它将再次被感染（请注意，这并不是非常隐蔽的方法）。

<details>

<summary><strong>从零开始学习 AWS 黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS 红队专家）</strong></a><strong>！</strong></summary>

支持 HackTricks 的其他方式：

* 如果您想看到您的公司在 HackTricks 中被广告，或者**下载 HackTricks 的 PDF**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 探索[**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们独家[**NFTs**](https://opensea.io/collection/the-peass-family)收藏
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或在 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** 上关注我们**。
* 通过向 [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来分享您的黑客技巧。

</details>
