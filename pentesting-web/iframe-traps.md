# Iframe Traps

<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクション
* **💬 [Discordグループに参加](https://discord.gg/hRep4RUj7f)**または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦で**フォロー**する [**@carlospolopm**](https://twitter.com/hacktricks\_live)**。**
* **ハッキングトリックを共有するには、** [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してください。

</details>

## 基本情報

このXSSを悪用する形式は、信頼できるtrustedsec.comの2つの投稿で元々公開されました：[**こちら**](https://trustedsec.com/blog/persisting-xss-with-iframe-traps) **および** [**こちら**](https://trustedsec.com/blog/js-tap-weaponizing-javascript-for-red-teams)。

攻撃は、XSSに対して脆弱なページで始まり、**被害者がXSSを離れないように**し、**全てのWebアプリケーションを占有するiframe内でナビゲートさせる**ことが可能な場合に発生します。

XSS攻撃は基本的に、Webページをiframe内に100％表示します。したがって、被害者は**自分がiframe内にいることに気づかない**でしょう。その後、被害者がiframe内（Web内）のリンクをクリックしてページを移動すると、そのナビゲーションから情報を盗む任意のJSがロードされたiframe内を**ナビゲート**することになります。

さらに、よりリアルにするために、いくつかの**リスナー**を使用して、iframeがページの場所を変更したときにチェックし、ユーザーがブラウザを使用してページを移動していると思わせるためにブラウザのURLをその場所に更新することが可能です。

<figure><img src="../.gitbook/assets/image (1248).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png">https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png</a></p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (1249).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png">https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png</a></p></figcaption></figure>

さらに、**リスナー**を使用して、被害者が訪れている他のページだけでなく、**記入されたフォームのデータを盗む**、それらを送信する（資格情報？）か**ローカルストレージを盗む**ことが可能です...

もちろん、**被害者がタブを閉じたり、ブラウザに別のURLを入力するとiframeを脱出**します。これを行う別の方法は**ページをリフレッシュ**することですが、これは新しいページがiframe内でロードされるたびに右クリックコンテキストメニューを無効にするか、ユーザーのマウスがiframeを離れるのを検知して、おそらくブラウザのリロードボタンをクリックするために、ブラウザのURLが元のXSSに対して更新されるので、ユーザーがそれをリロードすると再び毒されます（これはあまりステルスではないことに注意してください）。

<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクション
* **💬 [Discordグループに参加](https://discord.gg/hRep4RUj7f)**または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦で**フォロー**する [**@carlospolopm**](https://twitter.com/hacktricks\_live)**。**
* **ハッキングトリックを共有するには、** [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してください。

</details>
