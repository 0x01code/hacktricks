<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- ¬øTrabajas en una empresa de ciberseguridad? ¬øQuieres ver tu empresa anunciada en HackTricks? ¬øO quieres tener acceso a la √∫ltima versi√≥n de PEASS o descargar HackTricks en PDF? ¬°Consulta los [PLANES DE SUSCRIPCI√ìN](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obt√©n la [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PRs al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


**Publicaci√≥n tomada de** [**https://medium.com/@vickieli/how-to-find-more-idors-ae2db67c9489**](https://medium.com/@vickieli/how-to-find-more-idors-ae2db67c9489)

# Lugares inesperados para buscar IDORs <a href="#8d15" id="8d15"></a>

## No ignores los IDs codificados y hasheados <a href="#d6ce" id="d6ce"></a>

Cuando te enfrentes a un ID codificado, es posible que puedas decodificarlo utilizando esquemas de codificaci√≥n comunes.

Y si la aplicaci√≥n est√° utilizando un ID hasheado/aleatorio, verifica si el ID es predecible. A veces, las aplicaciones utilizan algoritmos que producen entrop√≠a insuficiente, y como tal, los IDs pueden ser predichos despu√©s de un an√°lisis cuidadoso. En este caso, intenta crear algunas cuentas para analizar c√≥mo se crean estos IDs. Es posible que puedas encontrar un patr√≥n que te permita predecir los IDs pertenecientes a otros usuarios.

Adem√°s, es posible que puedas filtrar IDs aleatorios o hasheados a trav√©s de otro punto final de API, en otras p√°ginas p√∫blicas de la aplicaci√≥n (p√°gina de perfil de otros usuarios, etc.), o en una URL a trav√©s del referer.

Por ejemplo, una vez encontr√© un punto final de API que permite a los usuarios recuperar mensajes directos detallados a trav√©s de un ID de conversaci√≥n hasheado. La solicitud se parece un poco a esto:
```
GET /api_v1/messages?conversation_id=SOME_RANDOM_ID
```
Esto parece estar bien a primera vista ya que el _conversation\_id_ es una secuencia larga, aleatoria y alfanum√©rica. Pero m√°s tarde descubr√≠ que en realidad se puede encontrar una lista de conversaciones para cada usuario simplemente usando su ID de usuario.
```
GET /api_v1/messages?user_id=ANOTHER_USERS_ID
```
Esto devolver√≠a una lista de _conversation\_ids_ pertenecientes a ese usuario. Y el _user\_id_ est√° disponible p√∫blicamente en la p√°gina de perfil de cada usuario. Por lo tanto, puedes leer los mensajes de cualquier usuario obteniendo primero su _user\_id_ en su p√°gina de perfil, luego recuperando una lista de _conversation\_ids_ pertenecientes a ese usuario, y finalmente cargando los mensajes a trav√©s del punto final de la API /api\_v1/messages!

## Si no puedes adivinarlo, intenta crearlo <a href="#b54f" id="b54f"></a>

Si los IDs de referencia de objeto parecen impredecibles, intenta ver si hay algo que puedas hacer para manipular el proceso de creaci√≥n o vinculaci√≥n de estos IDs de objeto.

## Ofrece una ID a la aplicaci√≥n, incluso si no la solicita <a href="#9292" id="9292"></a>

Si no se utilizan IDs en la solicitud generada por la aplicaci√≥n, intenta agregarla a la solicitud. Intenta agregar _id, user\_id, message\_id_ u otros par√°metros de referencia de objeto y ve si hace alguna diferencia en el comportamiento de la aplicaci√≥n.

Por ejemplo, si esta solicitud muestra todos tus mensajes directos:
```
GET /api_v1/messages
```
¬øY este? ¬øMostrar√≠a los mensajes de otro usuario en su lugar?
```
GET /api_v1/messages?user_id=ANOTHER_USERS_ID
```
## HPP (HTTP parameter pollution) <a href="#cb9a" id="cb9a"></a>

Las vulnerabilidades de HPP (suministro de m√∫ltiples valores para el mismo par√°metro) tambi√©n pueden llevar a IDOR. Las aplicaciones pueden no anticipar que el usuario env√≠e m√∫ltiples valores para el mismo par√°metro y al hacerlo, es posible que pueda evitar el control de acceso establecido en el punto final.

Aunque esto parece ser raro y nunca lo he visto antes, te√≥ricamente, se ver√≠a as√≠. Si esta solicitud falla:
```
GET /api_v1/messages?user_id=ANOTHER_USERS_ID
```
## Insecure Direct Object Reference (IDOR)

La vulnerabilidad de Insecure Direct Object Reference (IDOR) ocurre cuando una aplicaci√≥n web permite a un usuario acceder a recursos o funcionalidades que no deber√≠a tener acceso. Esto se debe a que la aplicaci√≥n no valida adecuadamente los identificadores de objeto directo (por ejemplo, un ID de usuario o un n√∫mero de pedido) antes de permitir el acceso a los recursos correspondientes.

Un ejemplo com√∫n de IDOR es cuando una aplicaci√≥n web permite a un usuario acceder a los detalles de una orden simplemente cambiando el n√∫mero de orden en la URL. Si la aplicaci√≥n no valida adecuadamente el n√∫mero de orden, un usuario malintencionado podr√≠a acceder a los detalles de cualquier orden simplemente cambiando el n√∫mero de orden en la URL.

Para encontrar vulnerabilidades de IDOR, se puede utilizar una t√©cnica llamada "secuenciaci√≥n de objetos". Esto implica enviar solicitudes repetidas con diferentes valores de identificaci√≥n de objeto directo para ver si se puede acceder a recursos o funcionalidades que no deber√≠an estar disponibles para el usuario.

Es importante tener en cuenta que las vulnerabilidades de IDOR pueden ser especialmente peligrosas en aplicaciones que manejan informaci√≥n confidencial, como datos de tarjetas de cr√©dito o informaci√≥n m√©dica. Por lo tanto, es importante que los desarrolladores validen adecuadamente los identificadores de objeto directo y limiten el acceso del usuario solo a los recursos y funcionalidades que deber√≠an estar disponibles para ellos.
```
GET /api_v1/messages?user_id=YOUR_USER_ID&user_id=ANOTHER_USERS_ID
```
Claro, ¬øqu√© necesitas que traduzca?
```
GET /api_v1/messages?user_id=ANOTHER_USERS_ID&user_id=YOUR_USER_ID
```
Lo siguiente es el contenido de un libro de hacking sobre t√©cnicas de hacking de plataformas en la nube, SaaS, CI/CD... El siguiente contenido es del archivo /hive/hacktricks/pentesting-web/idor.md. Traduzca el texto relevante al espa√±ol y devuelva la traducci√≥n manteniendo la sintaxis de markdown. No traduzca cosas como c√≥digo, nombres de t√©cnicas de hacking, nombres de plataformas en la nube/SaaS (como Workspace, aws, gcp...), la palabra 'leak' y las etiquetas de markdown. Adem√°s, no agregue nada aparte de la traducci√≥n y la sintaxis de markdown.
```
GET /api_v1/messages?user_ids[]=YOUR_USER_ID&user_ids[]=ANOTHER_USERS_ID
```
## Blind IDORs <a href="#7639" id="7639"></a>

A veces, los endpoints susceptibles a IDOR no responden directamente con la informaci√≥n filtrada. En su lugar, pueden hacer que la aplicaci√≥n filtre informaci√≥n en otro lugar: en archivos de exportaci√≥n, correos electr√≥nicos y tal vez incluso alertas de texto.

## Cambiar el m√©todo de solicitud <a href="#6597" id="6597"></a>

Si un m√©todo de solicitud no funciona, hay muchos otros que se pueden probar en su lugar: GET, POST, PUT, DELETE, PATCH...

Un truco com√∫n que funciona es sustituir POST por PUT o viceversa: ¬°es posible que no se hayan implementado los mismos controles de acceso!

## Cambiar el tipo de archivo solicitado <a href="#8f78" id="8f78"></a>

A veces, cambiar el tipo de archivo solicitado puede hacer que el servidor procese la autorizaci√≥n de manera diferente. Por ejemplo, intente agregar .json al final de la URL de solicitud y vea qu√© sucede.

# C√≥mo aumentar el impacto de IDORs <a href="#45b0" id="45b0"></a>

## IDOR cr√≠ticos primero <a href="#71f7" id="71f7"></a>

Siempre busque IDORs en funcionalidades cr√≠ticas primero. Tanto los IDOR basados en escritura como los basados en lectura pueden tener un alto impacto.

En t√©rminos de IDORs que cambian el estado (escritura), los IDORs de restablecimiento de contrase√±a, cambio de contrase√±a, recuperaci√≥n de cuenta a menudo tienen el mayor impacto comercial. (Por ejemplo, en comparaci√≥n con un IDOR de "cambiar la configuraci√≥n de suscripci√≥n por correo electr√≥nico".)

En cuanto a los IDORs que no cambian el estado (lectura), busque funcionalidades que manejen informaci√≥n sensible en la aplicaci√≥n. Por ejemplo, busque funcionalidades que manejen mensajes directos, informaci√≥n de usuario sensible y contenido privado. Considere qu√© funcionalidades en la aplicaci√≥n utilizan esta informaci√≥n y busque IDORs en consecuencia.
