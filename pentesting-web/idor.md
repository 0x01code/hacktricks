<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Travaillez-vous dans une entreprise de cybers√©curit√© ? Voulez-vous voir votre entreprise annonc√©e dans HackTricks ? ou voulez-vous avoir acc√®s √† la derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


**Post tir√© de** [**https://medium.com/@vickieli/how-to-find-more-idors-ae2db67c9489**](https://medium.com/@vickieli/how-to-find-more-idors-ae2db67c9489)

# Endroits inattendus pour trouver des IDORs <a href="#8d15" id="8d15"></a>

## Ne pas ignorer les IDs encod√©s et hach√©s <a href="#d6ce" id="d6ce"></a>

Lorsque vous √™tes confront√© √† un ID encod√©, il peut √™tre possible de d√©coder l'ID encod√© en utilisant des sch√©mas d'encodage courants.

Et si l'application utilise un ID hach√© / al√©atoire, v√©rifiez si l'ID est pr√©visible. Parfois, les applications utilisent des algorithmes qui produisent une entropie insuffisante, et en tant que tel, les IDs peuvent en fait √™tre pr√©dits apr√®s une analyse minutieuse. Dans ce cas, essayez de cr√©er quelques comptes pour analyser comment ces IDs sont cr√©√©s. Vous pourriez √™tre en mesure de trouver un mod√®le qui vous permettra de pr√©dire les IDs appartenant √† d'autres utilisateurs.

De plus, il peut √™tre possible de divulguer des IDs al√©atoires ou hach√©s via un autre point d'API, sur d'autres pages publiques de l'application (page de profil d'autres utilisateurs, etc.), ou dans une URL via referer.

Par exemple, j'ai d√©j√† trouv√© un point d'API qui permet aux utilisateurs de r√©cup√©rer des messages directs d√©taill√©s via un ID de conversation hach√©. La requ√™te ressemble √† ceci :
```
GET /api_v1/messages?conversation_id=SOME_RANDOM_ID
```
Cela semble correct √† premi√®re vue car l'_conversation\_id_ est une longue s√©quence alphanum√©rique al√©atoire. Mais j'ai d√©couvert plus tard que l'on peut en fait trouver une liste de conversations pour chaque utilisateur en utilisant simplement leur ID utilisateur !
```
GET /api_v1/messages?user_id=ANOTHER_USERS_ID
```
Cela renverrait une liste d' _identifiants de conversation_ appartenant √† cet utilisateur. Et l' _identifiant d'utilisateur_ est publiquement disponible sur la page de profil de chaque utilisateur. Par cons√©quent, vous pouvez lire les messages de n'importe quel utilisateur en obtenant d'abord leur _identifiant d'utilisateur_ sur leur page de profil, puis en r√©cup√©rant une liste d' _identifiants de conversation_ appartenant √† cet utilisateur, et enfin en chargeant les messages via le point d'extr√©mit√© API /api_v1/messages !

## Si vous ne pouvez pas le deviner, essayez de le cr√©er <a href="#b54f" id="b54f"></a>

Si les identifiants de r√©f√©rence d'objet semblent impr√©visibles, voyez s'il y a quelque chose que vous pouvez faire pour manipuler le processus de cr√©ation ou de liaison de ces identifiants d'objet.

## Offrez √† l'application un identifiant, m√™me si elle ne le demande pas <a href="#9292" id="9292"></a>

Si aucun identifiant n'est utilis√© dans la demande g√©n√©r√©e par l'application, essayez de l'ajouter √† la demande. Essayez d'ajouter _id, user_id, message_id_ ou d'autres param√®tres de r√©f√©rence d'objet et voyez si cela fait une diff√©rence dans le comportement de l'application.

Par exemple, si cette demande affiche tous vos messages directs :
```
GET /api_v1/messages
```
Et celui-ci ? Afficherait-il les messages d'un autre utilisateur √† la place ?
```
GET /api_v1/messages?user_id=ANOTHER_USERS_ID
```
## HPP (Pollution de param√®tres HTTP) <a href="#cb9a" id="cb9a"></a>

Les vuln√©rabilit√©s HPP (fourniture de plusieurs valeurs pour le m√™me param√®tre) peuvent √©galement conduire √† une IDOR. Les applications pourraient ne pas anticiper que l'utilisateur soumette plusieurs valeurs pour le m√™me param√®tre et en le faisant, vous pourriez contourner le contr√¥le d'acc√®s √©tabli sur le point d'extr√©mit√©.

Bien que cela semble rare et que je ne l'ai jamais vu se produire auparavant, th√©oriquement, cela ressemblerait √† ceci. Si cette requ√™te √©choue:
```
GET /api_v1/messages?user_id=ANOTHER_USERS_ID
```
## IDOR (Insecure Direct Object Reference)

L'IDOR (Insecure Direct Object Reference) est une vuln√©rabilit√© qui permet √† un attaquant d'acc√©der √† des ressources qu'il ne devrait pas √™tre en mesure d'acc√©der. Cette vuln√©rabilit√© est souvent caus√©e par une mauvaise mise en ≈ìuvre de l'authentification et de l'autorisation.

### Comment identifier une IDOR

L'identification d'une IDOR peut √™tre difficile, car elle peut √™tre cach√©e derri√®re une interface utilisateur complexe. Cependant, il existe plusieurs techniques pour identifier cette vuln√©rabilit√© :

- Identifier les param√®tres d'URL qui sont utilis√©s pour acc√©der aux ressources. Si ces param√®tres sont pr√©visibles ou incr√©mentables, cela peut indiquer une vuln√©rabilit√© IDOR.
- Utiliser un proxy pour intercepter les requ√™tes et les r√©ponses. Si les r√©ponses contiennent des informations sensibles qui ne devraient pas √™tre accessibles, cela peut indiquer une vuln√©rabilit√© IDOR.
- Utiliser des outils d'analyse de s√©curit√© automatis√©s pour identifier les vuln√©rabilit√©s IDOR.

### Comment exploiter une IDOR

L'exploitation d'une IDOR peut √™tre assez simple. Tout ce que l'attaquant a √† faire est de modifier les param√®tres d'URL pour acc√©der √† des ressources qu'il ne devrait pas √™tre en mesure d'acc√©der. Par exemple, si un utilisateur est autoris√© √† acc√©der √† son propre profil en utilisant l'URL `https://example.com/profile?id=1234`, l'attaquant peut essayer de remplacer l'ID `1234` par l'ID d'un autre utilisateur pour acc√©der √† son profil.

### Comment pr√©venir une IDOR

Pour pr√©venir une IDOR, il est important de mettre en place une authentification et une autorisation solides. Voici quelques bonnes pratiques √† suivre :

- Ne jamais utiliser des identifiants pr√©visibles ou incr√©mentables pour acc√©der aux ressources.
- Utiliser des jetons d'acc√®s pour limiter l'acc√®s aux ressources.
- V√©rifier que l'utilisateur est autoris√© √† acc√©der √† la ressource demand√©e avant de renvoyer les donn√©es.
- Utiliser des outils d'analyse de s√©curit√© automatis√©s pour identifier les vuln√©rabilit√©s IDOR.
```
GET /api_v1/messages?user_id=YOUR_USER_ID&user_id=ANOTHER_USERS_ID
```
Sure, please provide the English text you want me to translate.
```
GET /api_v1/messages?user_id=ANOTHER_USERS_ID&user_id=YOUR_USER_ID
```
Je suis d√©sol√©, mais je ne suis pas s√ªr de comprendre ce que vous voulez dire par "les param√®tres". Pouvez-vous fournir plus de contexte ou de d√©tails pour que je puisse mieux comprendre votre demande ?
```
GET /api_v1/messages?user_ids[]=YOUR_USER_ID&user_ids[]=ANOTHER_USERS_ID
```
## IDORs aveugles <a href="#7639" id="7639"></a>

Parfois, les points d'extr√©mit√© susceptibles d'IDOR ne r√©pondent pas directement avec les informations divulgu√©es. Ils peuvent conduire l'application √† divulguer des informations ailleurs: dans des fichiers d'exportation, des e-mails et peut-√™tre m√™me des alertes textuelles.

## Changer la m√©thode de demande <a href="#6597" id="6597"></a>

Si une m√©thode de demande ne fonctionne pas, il en existe de nombreuses autres que vous pouvez essayer √† la place: GET, POST, PUT, DELETE, PATCH...

Une astuce courante qui fonctionne consiste √† substituer POST √† PUT ou vice versa: les m√™mes contr√¥les d'acc√®s peuvent ne pas avoir √©t√© mis en ≈ìuvre!

## Changer le type de fichier demand√© <a href="#8f78" id="8f78"></a>

Parfois, changer le type de fichier demand√© peut amener le serveur √† traiter l'autorisation diff√©remment. Par exemple, essayez d'ajouter .json √† la fin de l'URL de demande et voyez ce qui se passe.

# Comment augmenter l'impact des IDORs <a href="#45b0" id="45b0"></a>

## IDORs critiques en premier <a href="#71f7" id="71f7"></a>

Recherchez toujours les IDORs dans les fonctionnalit√©s critiques en premier. Les IDORs bas√©s sur l'√©criture et la lecture peuvent avoir un impact √©lev√©.

En termes d'IDORs de modification d'√©tat (√©criture), les IDORs de r√©initialisation de mot de passe, de modification de mot de passe, de r√©cup√©ration de compte ont souvent le plus grand impact commercial. (Par exemple, par rapport √† un IDOR de "modification des param√®tres d'abonnement par e-mail".)

Quant aux IDORs de non-modification d'√©tat (lecture), recherchez les fonctionnalit√©s qui g√®rent les informations sensibles dans l'application. Par exemple, recherchez les fonctionnalit√©s qui g√®rent les messages directs, les informations sensibles sur les utilisateurs et le contenu priv√©. Consid√©rez quelles fonctionnalit√©s de l'application utilisent ces informations et recherchez des IDORs en cons√©quence.
