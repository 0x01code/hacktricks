# рдХреБрдХреАрдЬрд╝ рд╣реИрдХрд┐рдВрдЧ

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**GitHub рд░реЗрдкреЛрдЬрд╝**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

рдЙрди рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ рдЬреЛ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рддреЗрдЬреА рд╕реЗ рдареАрдХ рдХрд░ рд╕рдХреЗрдВред Intruder рдЖрдкрдХреА рдЕрдЯреИрдХ рд╕рд░рдлреЗрд╕ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ, рд╕рдХреНрд░рд┐рдп рдЦрддрд░реЗ рдХреЗ рд╕реНрдХреИрди рдЪрд▓рд╛рддрд╛ рд╣реИ, рдФрд░ рдЖрдкрдХреЗ рдкреВрд░реЗ рдЯреЗрдХ рд╕реНрдЯреИрдХ рдореЗрдВ рдореБрджреНрджреЛрдВ рдХреЛ рдЦреЛрдЬрддрд╛ рд╣реИ, APIs рд╕реЗ рд▓реЗрдХрд░ рд╡реЗрдм рдРрдкреНрд╕ рдФрд░ рдХреНрд▓рд╛рдЙрдб рд╕рд┐рд╕реНрдЯрдореНрд╕ рддрдХред рдЖрдЬ рд╣реА [**рдореБрдлреНрдд рдореЗрдВ рдЗрд╕реЗ рдЖрдЬрдорд╛рдПрдВ**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks)ред

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## рдХреБрдХреАрдЬрд╝ рдЧреБрдг

### Expires & Max-Age

* `Expires` рдПрдХ рд╕рдорд╛рдкреНрддрд┐ рддрд┐рдерд┐ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрдм рдПрдХ рдХреБрдХреА рдорд┐рдЯрд╛рдИ рдЬрд╛рддреА рд╣реИ
* `Max-age` рд╕реЗрдХрдВрдб рдореЗрдВ рд╕рдордп рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрдм рдПрдХ рдХреБрдХреА рдорд┐рдЯрд╛рдИ рдЬрд╛рдПрдЧреА **(рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЕрдм 2009 рдирд╣реАрдВ рд╣реИ)**

### **Domain**

`Domain` рдЧреБрдг рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ **рдХреМрди рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреБрдХреА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдпрджрд┐ рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЧреБрдг **рдбрд┐рдлрд╝реЙрд▓реНрдЯ** рдЙрд╕реА рд╣реЛрд╕реНрдЯ рдХреЗ рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдиреЗ рдХреБрдХреА рд╕реЗрдЯ рдХреА, _**рдЙрдкрдбреЛрдореЗрдиреНрд╕ рдХреЛ рдЫреЛрдбрд╝рдХрд░**_ред **рдпрджрд┐ `Domain` рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ**, рддреЛ **рдЙрдкрдбреЛрдореЗрдиреНрд╕ рд╣рдореЗрд╢рд╛ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВ**ред рдЗрд╕рд▓рд┐рдП, `Domain` рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рдЗрд╕реЗ рдЫреЛрдбрд╝рдиреЗ рд╕реЗ рдХрдо рдкреНрд░рддрд┐рдмрдВрдзрд╛рддреНрдордХ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬрдм рдЙрдкрдбреЛрдореЗрдиреНрд╕ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рддреЛ рдпрд╣ рд╕рд╣рд╛рдпрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк `Domain=mozilla.org` рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдХреБрдХреАрдЬрд╝ `developer.mozilla.org` рдЬреИрд╕реЗ рдЙрдкрдбреЛрдореЗрдиреНрд╕ рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реЛрддреА рд╣реИрдВред рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдХреБрдХреА рдЙрдкрдбреЛрдореЗрдиреНрд╕ рдХреЛ рднреЗрдЬреА рдирд╣реАрдВ рдЬрд╛рдПрдЧреАред

рдпрджрд┐ рдПрдХ **рдЙрдкрдбреЛрдореЗрди** `sub.example.com` **рдПрдХ рдХреБрдХреА рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ** _рдбреЛрдореЗрди_ рдЧреБрдг рдХреЗ рд╕рд╛рде **`.example.com`**, рддреЛ рдпрд╣ **рднреЗрдЬреА рдЬрд╛рдПрдЧреА** рдореВрд▓ рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдзреЛрдВ рдкрд░ред

### **Path**

`Path` рдЧреБрдг рдПрдХ **URL рдкрде рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЕрдиреБрд░реЛрдзрд┐рдд URL рдореЗрдВ рдореМрдЬреВрдж рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ `Cookie` рд╣реЗрдбрд░ рднреЗрдЬрд╛ рдЬрд╛ рд╕рдХреЗ**ред `%x2F` ("/") рд╡рд░реНрдг рдХреЛ рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╡рд┐рднрд╛рдЬрдХ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдЙрдкрдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдБ рднреА рдореЗрд▓ рдЦрд╛рддреА рд╣реИрдВред

#### рдХреНрд░рдо

рдЬрдм 2 рдХреБрдХреАрдЬрд╝ рдХрд╛ **рд╕рдорд╛рди рдирд╛рдо** рд╣реЛрддрд╛ рд╣реИ рддреЛ рднреЗрдЬреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╡рд╣ рд╣реЛрддреА рд╣реИ:

* рд╡рд╣ рдЬрд┐рд╕рдХрд╛ **URL рдкрде рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдкрде рд╕рдмрд╕реЗ рд▓рдВрдмрд╛** рд╣реЛ
* рдпрджрд┐ рджреЛрдиреЛрдВ рдХрд╛ рдкрде рд╕рдорд╛рди рд╣реЛ рддреЛ **рдирд╡реАрдирддрдо** рд╡рд╛рд▓реА

### SameSite

рдпрд╣ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ **рдХреБрдХреА** рдХреЛ **рдЕрдиреНрдп рдбреЛрдореЗрдиреНрд╕ рд╕реЗ рднреЗрдЬрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред рдЗрд╕рдХреЗ 3 рд╕рдВрднрд╛рд╡рд┐рдд рдореВрд▓реНрдп рд╣реИрдВ:

* **Strict**: рдХреБрдХреА рддреГрддреАрдп рдкрдХреНрд╖ рдХреА рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рджреНрд╡рд╛рд░рд╛ рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рдирд╣реАрдВ рднреЗрдЬреА рдЬрд╛рдПрдЧреАред
* **Lax**: рдХреБрдХреА рддреГрддреАрдп рдкрдХреНрд╖ рдХреА рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдП рдЧрдП GET рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рднреЗрдЬреА рдЬрд╛рдПрдЧреАред
* **None**: рдХреБрдХреА рдХрд┐рд╕реА рднреА рддреГрддреАрдп рдкрдХреНрд╖ рдбреЛрдореЗрди рд╕реЗ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИ

| **рдЕрдиреБрд░реЛрдз рдкреНрд░рдХрд╛рд░** | **рдЙрджрд╛рд╣рд░рдг рдХреЛрдб**                   | **рдХреБрдХреАрдЬрд╝ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИрдВ рдЬрдм** |
| ---------------- | ---------------------------------- | --------------------- |
| рд▓рд┐рдВрдХ             | \<a href="...">\</a>               | NotSet\*, Lax, None   |
| рдкреНрд░реАрд░реЗрдВрдбрд░        | \<link rel="prerender" href=".."/> | NotSet\*, Lax, None   |
| рдлреЙрд░реНрдо GET         | \<form method="GET" action="...">  | NotSet\*, Lax, None   |
| рдлреЙрд░реНрдо POST        | \<form method="POST" action="..."> | NotSet\*, None        |
| iframe           | \<iframe src="...">\</iframe>      | NotSet\*, None        |
| AJAX             | $.get("...")                       | NotSet\*, None        |
| рдЗрдореЗрдЬ            | \<img src="...">                   | NetSet\*, None        |

[Invicti](https://www.netsparker.com/blog/web-security/same-site-cookie-attribute-prevent-cross-site-request-forgery/) рд╕реЗ рд▓реА рдЧрдИ рддрд╛рд▓рд┐рдХрд╛ рдФрд░ рдереЛрдбрд╝реА рд╕рдВрд╢реЛрдзрд┐рддред\
_**SameSite**_ рдЧреБрдг рд╡рд╛рд▓реА рдХреБрдХреА **CSRF рд╣рдорд▓реЛрдВ рдХреЛ рдХрдо рдХрд░реЗрдЧреА** рдЬрд╣рд╛рдВ рдПрдХ рд▓реЙрдЧ рдЗрди рд╕рддреНрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

**\*рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ Chrome80 (рдлрд╝рд░рд╡рд░реА/2019) рд╕реЗ рдПрдХ рдХреБрдХреА рдХреЗ рдмрд┐рдирд╛ рдХреБрдХреА samesite** **рдЧреБрдг рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╣рд╛рд░ lax рд╣реЛрдЧрд╛** ([https://www.troyhunt.com/promiscuous-cookies-and-their-impending-death-via-the-samesite-policy/](https://www.troyhunt.com/promiscuous-cookies-and-their-impending-death-via-the-samesite-policy/)).\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ, рдЗрд╕ рдкрд░рд┐рд╡рд░реНрддрди рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, Chrome рдореЗрдВ **рдмрд┐рдирд╛ SameSite** **рдиреАрддрд┐ рд╡рд╛рд▓реА рдХреБрдХреАрдЬрд╝** рдХреЛ **рдкрд╣рд▓реЗ 2 рдорд┐рдирдЯ рдХреЗ рд▓рд┐рдП None рдХреЗ рд░реВрдк рдореЗрдВ рдФрд░ рдлрд┐рд░ рд╢реАрд░реНрд╖-рд╕реНрддрд░реАрдп рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ POST рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП Lax рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдирд╛ рдЬрд╛рдПрдЧрд╛ред**

## рдХреБрдХреАрдЬрд╝ рдлреНрд▓реИрдЧреНрд╕

### HttpOnly

рдпрд╣ рд░реЛрдХрддрд╛ рд╣реИ рдХрд┐ **рдХреНрд▓рд╛рдЗрдВрдЯ** рдХреБрдХреА рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХреЗ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **Javascript** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ: `document.cookie`)

#### **рдмрд╛рдпрдкрд╛рд╕**

* рдпрджрд┐ рдкреГрд╖реНрда **рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдЙрддреНрддрд░ рдореЗрдВ рдХреБрдХреАрдЬрд╝ рднреЗрдЬ рд░рд╣рд╛ рд╣реИ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **PHPinfo** рдкреГрд╖реНрда рдкрд░), рддреЛ XSS рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рдкреГрд╖реНрда рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдФрд░ **рдЙрддреНрддрд░ рд╕реЗ рдХреБрдХреАрдЬрд╝ рдЪреБрд░рд╛рдирд╛** (рдПрдХ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВ [https://hackcommander.github.io/posts/2022/11/12/bypass-httponly-via-php-info-page/](https://hackcommander.github.io/posts/2022/11/12/bypass-httponly-via-php-info-page/)).
* рдЗрд╕реЗ **TRACE** **HTTP** рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд╕рд╛рде рдмрд╛рдпрдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╕рд░реНрд╡рд░ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдХреБрдХреАрдЬрд╝ рдХреЛ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕ рддрдХрдиреАрдХ рдХреЛ **Cross-Site Tracking** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред
* рдЖрдзреБрдирд┐рдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ JS рд╕реЗ TRACE рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрдиреЗ рд╕реЗ рдЗрд╕ рддрдХрдиреАрдХ рд╕реЗ рдмрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕рдХреЗ рдХреБрдЫ рдмрд╛рдпрдкрд╛рд╕ IE6.0 SP2 рдХреЗ рд▓рд┐рдП `TRACE` рдХреЗ рдмрдЬрд╛рдп `\r\nTRACE` рднреЗрдЬрдиреЗ рдЬреИрд╕реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдореЗрдВ рдкрд╛рдП рдЧрдП рд╣реИрдВред
* рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреА рд╢реВрдиреНрдп/рджрд┐рди рдХреА рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рд╢реЛрд╖рдг рд╣реИред
* рдХреБрдХреА рдЬрд╛рд░ рдУрд╡рд░рдлреНрд▓реЛ рд╣рдорд▓реЗ рдХреЛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рдХреЗ HttpOnly рдХреБрдХреАрдЬрд╝ рдХреЛ **рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛** рд╕рдВрднрд╡ рд╣реИ:

{% content-ref url="cookie-jar-overflow.md"
```js
document.cookie = "a=v1"
document.cookie = "=test value;" // empty name
document.cookie = "b=v2"
```
рдЗрд╕рд╕реЗ рднреЗрдЬрд╛ рдЧрдпрд╛ рдХреБрдХреА рд╣реИрдбрд░ рд╣реЛрддрд╛ рд╣реИ:
```
a=v1; test value; b=v2;
```
рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреЛрдИ рдРрд╕рд╛ рд╡реЗрдХреНрдЯрд░ рд╣реИ рдЬреЛ рдЖрдкрдХреЛ **рдЦрд╛рд▓реА рдХреБрдХреА рд╕реЗрдЯ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рддреЛ рдЖрдк **рдХрд┐рд╕реА рднреА рдЕрдиреНрдп рдХреБрдХреА рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```js
function setCookie(name, value) {
document.cookie = `${name}=${value}`;
}

setCookie("", "a=b"); // this sets the empty cookie to a=b
```
рд╣рд╛рд▓рд╛рдВрдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдЕрдВрджрд░ рдпрд╣ рдЦрд╛рд▓реА рдирд╛рдо рд╡рд╛рд▓реА рдХреБрдХреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд╕реЗ **sent cookie header:** рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реЛрдЧрд╛:
```
a=b;
```
### Chrome Bug - document.cookie рднреНрд░рд╖реНрдЯрд╛рдЪрд╛рд░ <a href="#chrome-bugdocumentcookie-corruption" id="chrome-bugdocumentcookie-corruption"></a>

рдпрджрд┐ рдХрд┐рд╕реА рд╕реЗрдЯ рдХреБрдХреА рдореЗрдВ рдпреВрдирд┐рдХреЛрдб рд╕рд░реЛрдЧреЗрдЯ рдХреЛрдбрдкреЙрдЗрдВрдЯ рд╣реЛрддрд╛ рд╣реИ, рддреЛ `document.cookie` рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рднреНрд░рд╖реНрдЯ рд╣реЛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдПрдХ рдЦрд╛рд▓реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рд▓реМрдЯрд╛рдПрдЧрд╛ред
```js
document.cookie
// "a=b;"
document.cookie = "\ud800=meep";
document.cookie
// ""
```
### рдХреБрдХреА рд╕реНрдордЧрд▓рд┐рдВрдЧ

рдХрдИ рд╡реЗрдмрд╕рд░реНрд╡рд░, рдЬрд┐рдирдореЗрдВ рдЬрд╛рд╡рд╛ рд╡реЗрдмрд╕рд░реНрд╡рд░ Jetty, TomCat, Undertow, рдФрд░ рдкрд╛рдпрдерди рд╡реЗрдм рдлреНрд░реЗрдорд╡рд░реНрдХ Zope, рд╕рд╛рде рд╣реА рдкрд╛рдпрдерди рд╡реЗрдм рд╕рд░реНрд╡рд░/рдлреНрд░реЗрдорд╡рд░реНрдХреНрд╕ рдЬреИрд╕реЗ рдХрд┐ cherrypy, web.py, aiohttp server, bottle, рдФрд░ webob, **рдХреБрдХреА рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЛ рдЧрд▓рдд рддрд░реАрдХреЗ рд╕реЗ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рдП рдЧрдП рд╣реИрдВ** рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ RFC2965 рдХреЗ рд▓рд┐рдП рдмрдЪреЗ рд╣реБрдП рд╕рдорд░реНрдерди рдХреЗ рдХрд╛рд░рдг, рдЬреЛ рдХрд┐ рдПрдХ рдкреБрд░рд╛рдиреА рдХреБрдХреА рдХреЛрдЯрд┐рдВрдЧ рдореИрдХреЗрдирд┐рдЬреНрдо рд╣реИ рдЬреЛ рдХрд┐ RFC2616 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдПрдХ quoted-string рдкрд░рд┐рднрд╛рд╖рд╛ рдХреЗ рд▓рд┐рдПред

рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, **рдпреЗ рд╕рд░реНрд╡рд░ рдПрдХ рдХреБрдХреА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдкрдврд╝рдирд╛ рдЬрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВ рдЬрдм рд╡реЗ рдПрдХ рдбрдмрд▓-рдХреЛрдЯреЗрдб (dquoted) рдХреБрдХреА рдореВрд▓реНрдп рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рддреЗ рд╣реИрдВ, рднрд▓реЗ рд╣реА рдПрдХ рд╕реЗрдореАрдХреЛрд▓рди рдХрд╛ рд╕рд╛рдордирд╛ рдХрд┐рдпрд╛ рдЬрд╛рдП**ред рдпрд╣ рд╕рдорд╕реНрдпрд╛рдЧреНрд░рд╕реНрдд рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рд╕реЗрдореАрдХреЛрд▓рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреБрдХреА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рдХреА-рд╡реИрд▓реНрдпреВ рдЬреЛрдбрд╝реЛрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП**ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдЧрд░ рдПрдХ **рдмреНрд░рд╛рдЙрдЬрд╝рд░ рддреАрди рдХреБрдХреАрдЬрд╝ рднреЗрдЬрддрд╛ рд╣реИ, RENDER\_TEXT, JSESSIONID,** рдФрд░ **ASDF:**
```basic
RENDER_TEXT="hello world; JSESSIONID=13371337; ASDF=end";
```
### рдХреБрдХреА рдЗрдВрдЬреЗрдХреНрд╢рди

рдХрдИ рд╡реЗрдмрд╕рд░реНрд╡рд░реНрд╕, рдЬреИрд╕реЗ рдХрд┐ Java рдХрд╛ Undertow, Python рдХрд╛ Zope, рдФрд░ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ Python рдХреЗ stdlib http.cookie.SimpleCookie рдФрд░ http.cookie.BaseCookie, **рдЧрд▓рдд рдбрд┐рд▓рд┐рдорд┐рдЯрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреБрдХреАрдЬрд╝ рдХреЛ рдЧрд▓рдд рддрд░реАрдХреЗ рд╕реЗ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рдП рдЧрдП рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЕрдЧрд▓реЗ рдХреБрдХреА рдирд╛рдо/рдореВрд▓реНрдп рдЬреЛрдбрд╝реА рдХреА рд╢реБрд░реБрдЖрдд рд╣реЛрддреА рд╣реИ**ред рдЗрд╕рд╕реЗ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ **рдПрдХ рдХреБрдХреА рдореВрд▓реНрдп рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реБрдП рдХрдИ рдХреБрдХреАрдЬрд╝ рдХреЛ рд╕реНрдкреВрдл рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ**ред

**Undertow** рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рдЕрдЧрд▓реА рдХреБрдХреА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддрд╛ рд╣реИ рддреБрд░рдВрдд **рдПрдХ рдХреЛрдЯреЗрдб** рдХреБрдХреА рдореВрд▓реНрдп рдХреЗ **рдЕрдВрдд рдХреЗ рдмрд╛рдж**, рдмрд┐рдирд╛ рд╕реЗрдореАрдХреЛрд▓рди рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд┐рдП:
```bash
LANGUAGE="en-us" CSRF_TOKEN="SPOOFED_VALUE"
```
**Zope** рдЕрдЧрд▓реЗ рдХреБрдХреА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдирд╛ **рдХреЙрдорд╛** рдкрд░ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИ:
```bash
LANGUAGE=en-us,CSRF_TOKEN=SPOOFED_VALUE
```
рдФрд░ **Python's SimpleCookie** рдФрд░ **BaseCookie** рддреБрд░рдВрдд рдЕрдЧрд▓реЗ рдХреБрдХреА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддреЗ рд╣реИрдВ **space** рдЕрдХреНрд╖рд░ рдкрд░:
```
LANGUAGE=en-us CSRF_TOKEN=SPOOFED_VALUE
```
рдирддреАрдЬрддрди, **cherrypy**, **web.py**, **aiohttp** рд╕рд░реНрд╡рд░, **bottle**, рдФрд░ **webob** (Pyramid, TurboGears) рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рд╕рднреА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИрдВред

рдЗрд╕ рдореБрджреНрджреЗ рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг **рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рднрд╛рд╡** рд╕рд╛рдордиреЗ рдЖрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди **рдХреБрдХреА-рдЖрдзрд╛рд░рд┐рдд CSRF рд╕реБрд░рдХреНрд╖рд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **CSRF-рдЯреЛрдХрди рдХреБрдХреА** рдХрд╛ рдирдХрд▓реА рд╕рдВрд╕реНрдХрд░рдг **рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд░рдХреЗ рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, Python рдХреЗ http.cookie рдкреИрдХреЗрдЬ рдореЗрдВ рдЕрдВрддрд┐рдо рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдХреБрдХреА рдирд╛рдо рдкрд┐рдЫрд▓реЗ рд╕рднреА рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣рдорд▓рд╛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **`__Secure-`** рдФрд░ **`__Host-`** рдХреБрдХреАрдЬ рдХрд╛ **рд╕реНрдкреВрдлрд┐рдВрдЧ** рдПрдХ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрджрд░реНрдн рдореЗрдВ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╕рд╛рде рд╣реА, рдПрдХ рдРрд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдЬрд╣рд╛рдВ рдХреБрдХреАрдЬ рдХреЛ рдПрдХ рдмреИрдХрдПрдВрдб рд╕рд░реНрд╡рд░ рдкрд░ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, **рдХреБрдХреА рдЗрдВрдЬреЗрдХреНрд╢рди рд╕реЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдмрд╛рдпрдкрд╛рд╕ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ** рдпрджрд┐ рдмреИрдХрдПрдВрдб рд╕рд░реНрд╡рд░ рд╕реНрдкреВрдлрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд▓реЗрдХрд┐рди рдлреНрд░рдВрдЯрдПрдВрдб рд╕рд░реНрд╡рд░ рди рд╣реЛред

### рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдХреБрдХреАрдЬ рдХреА рдЬрд╛рдВрдЪ

#### **рдореВрд▓ рдЬрд╛рдВрдЪ**

* **рдХреБрдХреА** рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк **рд▓реЙрдЧрд┐рди** рдХрд░рддреЗ рд╣реИрдВ рддреЛ **рд╕рдорд╛рди** рд╣реЛрддреА рд╣реИред
* рд▓реЙрдЧ рдЖрдЙрдЯ рдХрд░реЗрдВ рдФрд░ рд╕рдорд╛рди рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВред
* рдПрдХ рд╣реА рдЦрд╛рддреЗ рдореЗрдВ 2 рдЙрдкрдХрд░рдгреЛрдВ (рдпрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ) рдХреЗ рд╕рд╛рде рд╕рдорд╛рди рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВред
* рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреБрдХреА рдореЗрдВ рдХреЛрдИ рдЬрд╛рдирдХрд╛рд░реА рд╣реИ рдФрд░ рдЙрд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВред
* рд▓рдЧрднрдЧ рд╕рдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЗ рд╕рд╛рде рдХрдИ рдЦрд╛рддреЗ рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдФрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рд╕рдорд╛рдирддрд╛рдПрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
* "**рдореБрдЭреЗ рдпрд╛рдж рд░рдЦреЗрдВ**" рд╡рд┐рдХрд▓реНрдк рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдпрджрд┐ рд╡рд╣ рдореМрдЬреВрдж рд╣реИ рддреЛ рджреЗрдЦреЗрдВ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдпрд╣ рдореМрдЬреВрдж рд╣реИ рдФрд░ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рд╣рдореЗрд╢рд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдХреБрдХреА рдХреЗ рдмрд┐рдирд╛ **рдореБрдЭреЗ рдпрд╛рдж рд░рдЦреЗрдВ** рдХреА рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдкрд┐рдЫрд▓реА рдХреБрдХреА рдкрд╛рд╕рд╡рд░реНрдб рдмрджрд▓рдиреЗ рдХреЗ рдмрд╛рдж рднреА рдХрд╛рдо рдХрд░рддреА рд╣реИред

#### **рдЙрдиреНрдирдд рдХреБрдХреА рд╣рдорд▓реЗ**

рдпрджрд┐ рдХреБрдХреА рд╕рдорд╛рди рд░рд╣рддреА рд╣реИ (рдпрд╛ рд▓рдЧрднрдЧ) рдЬрдм рдЖрдк рд▓реЙрдЧрд┐рди рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╢рд╛рдпрдж рдпрд╣ рд╣реИ рдХрд┐ рдХреБрдХреА рдЖрдкрдХреЗ рдЦрд╛рддреЗ рдХреЗ рдХрд┐рд╕реА рдлрд╝реАрд▓реНрдб (рд╢рд╛рдпрдж рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо) рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИред рддрдм рдЖрдк:

* рдмрд╣реБрдд рд╕рдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдореЛрдВ рдХреЗ рд╕рд╛рде **рдЦрд╛рддреЗ** рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдФрд░ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдПрдВ рдХрд┐ рдПрд▓реНрдЧреЛрд░рд┐рдердо рдХреИрд╕реЗ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИред
* **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЛ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВред рдпрджрд┐ рдХреБрдХреА рдХреЗрд╡рд▓ рдЖрдкрдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╡рд┐рдзрд┐ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╣реЗрдЬрддреА рд╣реИ, рддреЛ рдЖрдк "**Bmin**" рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЗ рд╕рд╛рде рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдкрдиреА рдХреБрдХреА рдХреЗ рд╣рд░ рдПрдХ **рдмрд┐рдЯ** рдХреЛ **рдмреНрд░реВрдЯрдлреЛрд░реНрд╕** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдЖрдЬрдорд╛рдИ рдЧрдИ рдХреБрдХреАрдЬ рдореЗрдВ рд╕реЗ рдПрдХ "**рдПрдбрдорд┐рди**" рдХреА рд╣реЛрдЧреАред
* **рдкреИрдбрд┐рдВрдЧ** **рдУрд░реЗрдХрд▓** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ (рдЖрдк рдХреБрдХреА рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред **padbuster** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

**рдкреИрдбрд┐рдВрдЧ рдУрд░реЗрдХрд▓ - Padbuster рдЙрджрд╛рд╣рд░рдг**
```bash
padbuster <URL/path/when/successfully/login/with/cookie> <COOKIE> <PAD[8-16]>
# When cookies and regular Base64
padbuster http://web.com/index.php u7bvLewln6PJPSAbMb5pFfnCHSEd6olf 8 -cookies auth=u7bvLewln6PJPSAbMb5pFfnCHSEd6olf

# If Base64 urlsafe or hex-lowercase or hex-uppercase --encoding parameter is needed, for example:
padBuster http://web.com/home.jsp?UID=7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6
7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6 8 -encoding 2
```
Padbuster рдХрдИ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ рдФрд░ рдЖрдкрд╕реЗ рдкреВрдЫреЗрдЧрд╛ рдХрд┐ рдХреМрди рд╕реА рд╕реНрдерд┐рддрд┐ рддреНрд░реБрдЯрд┐ рдХреА рд╕реНрдерд┐рддрд┐ рд╣реИ (рд╡рд╣ рдЬреЛ рдорд╛рдиреНрдп рдирд╣реАрдВ рд╣реИ)ред

рдлрд┐рд░ рдпрд╣ рдХреБрдХреА рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрдЧрд╛ (рдЗрд╕рдореЗрдВ рдХрдИ рдорд┐рдирдЯ рд▓рдЧ рд╕рдХрддреЗ рд╣реИрдВ)

рдпрджрд┐ рд╣рдорд▓рд╛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдЕрдкрдиреА рдкрд╕рдВрдж рдХреА рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ **encrypt** рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **user=administrator** рдХреЛ **encrypt** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ
```
padbuster http://web.com/index.php 1dMjA5hfXh0jenxJQ0iW6QXKkzAGIWsiDAKV3UwJPT2lBP+zAD0D0w== 8 -cookies thecookie=1dMjA5hfXh0jenxJQ0iW6QXKkzAGIWsiDAKV3UwJPT2lBP+zAD0D0w== -plaintext user=administrator
```
рдпрд╣ рдирд┐рд╖реНрдкрд╛рджрди рдЖрдкрдХреЛ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдФрд░ рдПрдиреНрдХреЛрдбреЗрдб рдХреБрдХреА рджреЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ **user=administrator** рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╢рд╛рдорд┐рд▓ рд╣реИред

**CBC-MAC**

рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреБрдХреА рдореЗрдВ рдХреЛрдИ рдореВрд▓реНрдп рд╣реЛ рдФрд░ рдЙрд╕реЗ CBC рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛред рдлрд┐рд░, рдореВрд▓реНрдп рдХреА рдЕрдЦрдВрдбрддрд╛ рд╡рд╣реА рд╕рд┐рдЧреНрдиреЗрдЪрд░ рд╣реЛрддреА рд╣реИ рдЬреЛ CBC рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрд╕реА рдореВрд▓реНрдп рдХреЗ рд╕рд╛рде рдмрдирд╛рдИ рдЧрдИ рд╣реИред рдЪреВрдВрдХрд┐ IV рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╢реВрдиреНрдп рд╡реЗрдХреНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдЕрдЦрдВрдбрддрд╛ рдЬрд╛рдВрдЪ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддреА рд╣реИред

**рд╣рдорд▓рд╛**

1. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо **administ** рдХрд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ = **t**
2. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо **rator\x00\x00\x00 XOR t** рдХрд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ = **t'**
3. рдХреБрдХреА рдореЗрдВ рдореВрд▓реНрдп **administrator+t'** рд╕реЗрдЯ рдХрд░реЗрдВ (**t'** **(rator\x00\x00\x00 XOR t) XOR t** = **rator\x00\x00\x00** рдХрд╛ рд╡реИрдз рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╣реЛрдЧрд╛)

**ECB**

рдпрджрд┐ рдХреБрдХреА рдХреЛ ECB рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рдпрд╣ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред\
рдЬрдм рдЖрдк рд▓реЙрдЧ рдЗрди рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓реА рдХреБрдХреА рд╣рдореЗрд╢рд╛ рд╕рдорд╛рди рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред

**рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛:**

рд▓рдЧрднрдЧ рд╕рдорд╛рди рдбреЗрдЯрд╛ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо, рдкрд╛рд╕рд╡рд░реНрдб, рдИрдореЗрд▓, рдЖрджрд┐) рдХреЗ рд╕рд╛рде 2 рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдПрдВ рдФрд░ рджрд┐рдП рдЧрдП рдХреБрдХреА рдореЗрдВ рдХреБрдЫ рдкреИрдЯрд░реНрди рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" рдирд╛рдордХ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдПрдВ рдФрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреБрдХреА рдореЗрдВ рдХреЛрдИ рдкреИрдЯрд░реНрди рд╣реИ рдпрд╛ рдирд╣реАрдВ (рдХреНрдпреЛрдВрдХрд┐ ECB рд╣рд░ рдмреНрд▓реЙрдХ рдХреЛ рдПрдХ рд╣реА рдХреБрдВрдЬреА рд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рддрд╛ рд╣реИ, рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рд╕рдорд╛рди рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдмрд╛рдЗрдЯреНрд╕ рдкреНрд░рдХрдЯ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ)ред

рдПрдХ рдкреИрдЯрд░реНрди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдмреНрд▓реЙрдХ рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде)ред рддреЛ, рдЬрд╛рдирддреЗ рд╣реБрдП рдХрд┐ "a" рдХрд╛ рдПрдХ рд╕рдореВрд╣ рдХреИрд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЖрдк рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ: "a"\*(рдмреНрд▓реЙрдХ рдХрд╛ рдЖрдХрд╛рд░)+"admin"ред рдлрд┐рд░, рдЖрдк рдХреБрдХреА рд╕реЗ "a" рдХреЗ рдПрдХ рдмреНрд▓реЙрдХ рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдкреИрдЯрд░реНрди рдХреЛ рд╣рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдФрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо "admin" рдХреА рдХреБрдХреА рд╣реЛрдЧреАред

## рд╕рдВрджрд░реНрдн

* [https://blog.ankursundara.com/cookie-bugs/](https://blog.ankursundara.com/cookie-bugs/)

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛рдУрдВ рдХреЛ рдЦреЛрдЬреЗрдВ рддрд╛рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рддреЗрдЬреА рд╕реЗ рдареАрдХ рдХрд░ рд╕рдХреЗрдВред Intruder рдЖрдкрдХреА рд╣рдорд▓реЗ рдХреА рд╕рддрд╣ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рддрд╛ рд╣реИ, рд╕рдХреНрд░рд┐рдп рдЦрддрд░реЗ рдХреЗ рд╕реНрдХреИрди рдЪрд▓рд╛рддрд╛ рд╣реИ, рдЖрдкрдХреЗ рдкреВрд░реЗ рддрдХрдиреАрдХреА рд╕реНрдЯреИрдХ рдореЗрдВ рдореБрджреНрджреЛрдВ рдХреЛ рдЦреЛрдЬрддрд╛ рд╣реИ, APIs рд╕реЗ рд▓реЗрдХрд░ рд╡реЗрдм рдРрдкреНрд╕ рдФрд░ рдХреНрд▓рд╛рдЙрдб рд╕рд┐рд╕реНрдЯрдореНрд╕ рддрдХред рдЖрдЬ рд╣реА [**рдореБрдлреНрдд рдореЗрдВ рдЖрдЬрдорд╛рдПрдВ**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks)ред

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}


<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
