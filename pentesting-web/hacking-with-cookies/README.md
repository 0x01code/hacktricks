# рдХреБрдХреА рд╣реИрдХрд┐рдВрдЧ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдХреБрдХреА рдЧреБрдг

рдХреБрдХреА рдХрдИ рдЧреБрдгреЛрдВ рдХреЗ рд╕рд╛рде рдЖрддреА рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдЙрдирдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдпрд╣рд╛рдВ рдЗрди рдЧреБрдгреЛрдВ рдХреА рдПрдХ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рд╕реВрдЪреА рд╣реИ рдЬреЛ рдПрдХ рдЕрдзрд┐рдХ рдкрд╛рд╕рд┐рд╡ рдЖрд╡рд╛рдЬ рдореЗрдВ рд╣реИ:

### рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдФрд░ рдЕрдзрд┐рдХрддрдо рдЖрдпреБ

рдХреБрдХреА рдХреА рд╕рдорд╛рдкреНрддрд┐ рддрд┐рдерд┐ рдХреЛ `Expires` рдЧреБрдг рд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЙрд▓реНрдЯреЗ, `Max-age` рдЧреБрдг рд╕рдордп рдХреЛ рд╕реЗрдХрдВрдб рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрдм рддрдХ рдХреБрдХреА рд╣рдЯрд╛ рджреА рдЬрд╛рддреА рд╣реИред **`Max-age` рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЕрдзрд┐рдХ рдЖрдзреБрдирд┐рдХ рдЕрднреНрдпрд╛рд╕ рдХреЛ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рдХрд░рддрд╛ рд╣реИред**

### рдбреЛрдореЗрди

рдХреБрдХреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣реЛрд╕реНрдЯ рдХреЛ `Domain` рдЧреБрдг рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рдХреБрдХреА рдЬрд╛рд░реА рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣реЛрд╕реНрдЯ рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрд╕рдХреЗ рдЙрдк-рдбреЛрдореЗрдиреЛрдВ рдХреЛ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд░рддреЗред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬрдм `Domain` рдЧреБрдг рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЙрдк-рдбреЛрдореЗрдиреЛрдВ рдХреЛ рднреА рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред рдпрд╣ `Domain` рдЧреБрдг рдХреА рд╡рд┐рд╢реЗрд╖рд┐рдХрд░рдг рдХреЛ рдХрдо рдкреНрд░рддрд┐рдмрдВрдзрдХ рд╡рд┐рдХрд▓реНрдк рдмрдирд╛рддрд╛ рд╣реИ, рдЬреЛ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдк-рдбреЛрдореЗрдиреЛрдВ рдХреЗ рдмреАрдЪ рдХреБрдХреА рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `Domain=mozilla.org` рд╕реЗрдЯ рдХрд░рдиреЗ рд╕реЗ рдХреБрдХреА рдЙрд╕рдХреЗ рдЙрдк-рдбреЛрдореЗрдиреЛрдВ рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реЛрддреА рд╣реИ рдЬреИрд╕реЗ `developer.mozilla.org`.

### рдкрде

`Path` рдЧреБрдг рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ `Cookie` рд╣реЗрдбрд░ рдХреЛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдзрд┐рдд URL рдореЗрдВ рд╡рд┐рд╢реЗрд╖ URL рдкрде рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрд╣ рдЧреБрдг `/` рд╡рд░реНрдг рдХреЛ рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╡рд┐рднрд╛рдЬрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдирддрд╛ рд╣реИ, рдЙрдкрдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рдорд┐рд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

### рдХреНрд░рдорд╡рд╛рд░реНрддреА рдирд┐рдпрдо

рдЬрдм рджреЛ рдХреБрдХреА рдПрдХ рд╣реА рдирд╛рдо рд░рдЦрддреА рд╣реИрдВ, рддреЛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЪреБрдиреА рдЧрдИ рдХреБрдХреА рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрдзрд╛рд░реЛрдВ рдкрд░ рд╣реЛрддреА рд╣реИ:

* рдЕрдиреБрд░реЛрдзрд┐рдд URL рдореЗрдВ рд╕рдмрд╕реЗ рд▓рдВрдмрд╛ рдкрде рдорд┐рд▓рд╛рдиреЗ рд╡рд╛рд▓реА рдХреБрдХреАред
* рдпрджрд┐ рдкрде рд╕рдорд╛рди рд╣реИ рддреЛ рд╕рдмрд╕реЗ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рд╕реЗрдЯ рдХреА рдЧрдИ рдХреБрдХреАред

### SameSite

* `SameSite` рдЧреБрдг рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдХреБрдХреА рддреГрддреАрдп-рдкрдХреНрд╖ рдбреЛрдореЗрди рд╕реЗ рдЙрддреНрдкрдиреНрди рдЕрдиреБрд░реЛрдзреЛрдВ рдкрд░ рднреЗрдЬреА рдЬрд╛рдПред рдЗрд╕рдореЗрдВ рддреАрди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд╣реИрдВ:
* **рд╕рдЦреНрдд**: рдХреБрдХреА рдХреЛ рддреГрддреАрдп-рдкрдХреНрд╖ рдЕрдиреБрд░реЛрдзреЛрдВ рдкрд░ рднреЗрдЬрдиреЗ рд╕реЗ рд░реЛрдХрддрд╛ рд╣реИред
* **рд▓реИрдХреНрд╕**: рддреГрддреАрдп-рдкрдХреНрд╖ рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рд░рдВрднрд┐рдд GET рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд╕рд╛рде рдХреБрдХреА рдХреЛ рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* **рдХреЛрдИ рдирд╣реАрдВ**: рдХреБрдХреА рдХреЛ рдХрд┐рд╕реА рднреА рддреГрддреАрдп-рдкрдХреНрд╖ рдбреЛрдореЗрди рд╕реЗ рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

рдзреНрдпрд╛рди рд░рдЦреЗрдВ, рдХреБрдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╕рдордп, рдЗрди рдЧреБрдгреЛрдВ рдХреЛ рд╕рдордЭрдирд╛ рд╡рд┐рднрд┐рдиреНрди рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЙрдирдХреЗ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред

| **рдЕрдиреБрд░реЛрдз рдкреНрд░рдХрд╛рд░** | **рдЙрджрд╛рд╣рд░рдг рдХреЛрдб**                   | **рдХреБрдХреА рднреЗрдЬреА рдЬрд╛рддреА рд╣реИ рдЬрдм** |
| ---------------- | ---------------------------------- | --------------------- |
| рд▓рд┐рдВрдХ             | \<a href="...">\</a>               | NotSet\*, Lax, None   |
| рдкреНрд░реАрд░реЗрдВрдбрд░        | \<link rel="prerender" href=".."/> | NotSet\*, Lax, None   |
| рдлреЙрд░реНрдо GET         | \<form method="GET" action="...">  | NotSet\*, Lax, None   |
| рдлреЙрд░реНрдо POST        | \<form method="POST" action="..."> | NotSet\*, None        |
| рдЖрдЗрдлреНрд░реЗрдо           | \<iframe src="...">\</iframe>      | NotSet\*, None        |
| AJAX             | $.get("...")                       | NotSet\*, None        |
| рдЫрд╡рд┐            | \<img src="...">                   | NetSet\*, None        |

рдЯреЗрдмрд▓ [Invicti](https://www.netsparker.com/blog/web-security/same-site-cookie-attribute-prevent-cross-site-request-forgery/) рд╕реЗ рд╣реИ рдФрд░ рдереЛрдбрд╝рд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред\
_**SameSite**_ рдЧреБрдг рд╡рд╛рд▓реА рдХреБрдХреА **CSRF рд╣рдорд▓реЛрдВ** рдХреЛ **рд░реЛрдХреЗрдЧреА** рдЬрд╣рд╛рдВ рдПрдХ рд▓реЙрдЧ рдЗрди рд╕рддреНрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

**\*рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ Chrome80 (рдлрд░рд╡рд░реА/2019) рд╕реЗ рдПрдХ рдХреБрдХреА рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╣рд╛рд░ рдЬрдм рдХреЛрдИ рдХреБрдХреА samesite рдЧреБрдг рдХреЗ рдмрд┐рдирд╛ рд╣реЛрдЧрд╛ рддреЛ рд╡рд╣ lax рд╣реЛрдЧрд╛** ([https://www.troyhunt.com/promiscuous-cookies-and-their-impending-death-via-the-samesite-policy/](https://www.troyhunt.com/promiscuous-cookies-and-their-impending-death-via-the-samesite-policy/))ред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ, рдЗрд╕ рдкрд░рд┐рд╡рд░реНрддрди рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, **Chrome рдореЗрдВ SameSite рдЧреБрдг рдХреЗ рдмрд┐рдирд╛ рдХреБрдХреА** **рдкрд╣рд▓реЗ 2 рдорд┐рдирдЯ рдХреЗ рд▓рд┐рдП None рдХреЗ рд░реВрдк рдореЗрдВ** **рдФрд░ рдлрд┐рд░ рд╢реАрд░реНрд╖-рд╕реНрддрд░реАрдп рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ POST рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП Lax рдХреЗ рд░реВрдк рдореЗрдВ** рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

## рдХреБрдХреА рдзреНрд╡рдЬ

### HttpOnly

рдпрд╣ **рдЧреНрд░рд╛рд╣рдХ** рдХреЛ рдХреБрдХреА рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╕реЗ рд░реЛрдХрддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ: `document.cookie`)

#### **рдмрд╛рдпрдкрд╛рд╕**

* рдЕрдЧрд░ рдкреГрд╖реНрда **рдХреБрдХреА рдХреЛ рдЕрдиреБрд░реЛрдз рдХреЗ рд░реВрдк рдореЗрдВ рднреЗрдЬ рд░рд╣рд╛ рд╣реИ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **PHPinfo** рдкреГрд╖реНрда рдореЗрдВ), рддреЛ XSS рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рдкреГрд╖реНрда рдХреЛ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдХрд░ рдХреБрдХреА рдХреЛ рдЙрддреНрддрд░ рд╕реЗ **рдЪреБрд░рд╛ рд╕рдХрддреЗ** рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [https://hackcommander.github.io/posts/2022/11/12/bypass-httponly-via-php-info-page/](https://hackcommander.github.io/posts/2022/11/12/bypass-httponly-via-php-info-page/) рдореЗрдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВ)ред
* рдЗрд╕реЗ **TRACE** **HTTP** рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд╕рд╛рде рдмрд╛рдпрдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╕рд░реНрд╡рд░ рд╕реЗ рдЙрддреНрддрд░ (рдпрджрд┐ рдпрд╣ HTTP рд╡рд┐рдзрд┐ рдЙрдкрд▓рдмреНрдз рд╣реИ) рдХреБрдХреА рднреЗрдЬреЗрдЧрд╛ред рдЗрд╕ рддрдХрдиреАрдХ рдХреЛ **рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рдЯреНрд░реИрдХрд┐рдВрдЧ** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред
* рдпрд╣ рддрдХрдиреАрдХ **рдЖрдзреБрдирд┐рдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░реНрд╕ рджреНрд╡рд╛рд░рд╛ TRACE** рдЕрдиреБрд░реЛрдз рдХреЛ рдЬрд╛рдиреЗ рдирд╣реАрдВ рджреЗрдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдмрдЪрд╛рдИ рдЬрд╛рддреА рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреБрдЫ рдмрд╛рдпрдкрд╛рд╕ рдЗрд╕рдХреЗ рд▓рд┐рдП рдорд┐рд▓реЗ рд╣реИрдВ рдЬреИрд╕реЗ IE6.0 SP2 рдореЗрдВ `TRACE` рдХреА рдмрдЬрд╛рдп `\r\nTRACE` рднреЗрдЬрдирд╛ред
* рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреЗ рдЬреАрд░реЛ/рдбреЗ рд╡рд▓рдирд░реЗрдмрд┐рд▓рд┐рдЯреА рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛ред
* рдХреБрдХреА рдЬрд╛рд░ рдореЗрдВ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдПрдХ рдХреБрдХреА рдЬрд╛рд░ рдУрд╡рд░рдлреНрд▓реЛ рдЕрдЯреИрдХ рдХрд░рдХреЗ:

{% content-ref url="cookie-jar-overflow.md" %}
[cookie-jar-overflow.md](cookie-jar-overflow.md)
{% endcontent-ref %}

* рдЗрди рдХреБрдХреАрдЬрд╝ рдХреЛ рдЙрджреНрдзрд╛рд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**рдХреБрдХреА рд╕реНрдордЧрд▓рд┐рдВрдЧ**](./#cookie-smuggling) рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ

### рд╕реБрд░рдХреНрд╖рд┐рдд

рдЕрди
## рдХреБрдХреА рд╣рдорд▓реЗ

рдпрджрд┐ рдХреЛрдИ рдХрд╕реНрдЯрдо рдХреБрдХреА рдореЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ рдЬрд╛рдВрдЪреЗрдВ (рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЕрдЧрд░ рдЖрдк CTF рдЦреЗрд▓ рд░рд╣реЗ рд╣реИрдВ), рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХрдордЬреЛрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### рдХреБрдХреА рдХреЛ рдбрд┐рдХреЛрдб рдФрд░ рдореИрдирд┐рдкреБрд▓реЗрдЯ рдХрд░рдирд╛

рдХреБрдХреА рдореЗрдВ рдПрдиреНрдХреЛрдб рдХрд┐рдП рдЧрдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдХреЛ рд╣рдореЗрд╢рд╛ рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдПред Base64 рдпрд╛ рд╕рдорд╛рди рдкреНрд░рд╛рд░реВрдкреЛрдВ рдореЗрдВ рдПрдиреНрдХреЛрдб рдХреА рдЧрдИ рдХреБрдХреА рдХреЛ рдЕрдХреНрд╕рд░ рдбрд┐рдХреЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдХрдордЬреЛрд░реА рд╣рдорд▓рд╛рджрд╛рд░ рдХреЛ рдХреБрдХреА рдХреА рд╕рд╛рдордЧреНрд░реА рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рдиреЗ рдФрд░ рдЙрдирдХреЗ рд╕рдВрд╢реЛрдзрд┐рдд рдбреЗрдЯрд╛ рдХреЛ рдкреБрдирдГ рдХреБрдХреА рдореЗрдВ рдПрдиреНрдХреЛрдб рдХрд░рдХреЗ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред

### рд╕рддреНрд░ рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ

рдЗрд╕ рд╣рдорд▓реЗ рдореЗрдВ, рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдХреБрдХреА рдЪреБрд░рд╛рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рддрд╛рдХрд┐ рдЙрдирдХреЗ рдЦрд╛рддреЗ рддрдХ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЪреЛрд░реА рд╣реБрдИ рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдПрдХ рд╣рдорд▓рд╛рджрд╛рд░ рдорд╛рдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### рд╕рддреНрд░ рдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛

рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдПрдХ рд╣рдорд▓рд╛рджрд╛рд░ рдПрдХ рдкреАрдбрд╝рд┐рдд рдХреЛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдзреЛрдЦрд╛ рджреЗрддрд╛ рд╣реИред рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд▓реЙрдЧрд┐рди рдХреЗ рдмрд╛рдж рдПрдХ рдирдИ рдХреБрдХреА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рджрд╛рд░, рдореМрдЬреВрджрд╛ рдХреБрдХреА рдХреЗ рд╕рд╛рде, рдкреАрдбрд╝рд┐рдд рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рддрдХрдиреАрдХ рдкреАрдбрд╝рд┐рдд рдХреЗ рджреНрд╡рд╛рд░рд╛ рд╣рдорд▓рд╛рджрд╛рд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдХреБрдХреА рдХреЗ рд╕рд╛рде рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИред

рдпрджрд┐ рдЖрдкрдиреЗ **рдПрдХ рд╕рдмрдбреЛрдореЗрди рдореЗрдВ XSS** рдкрд╛рдпрд╛ рд╣реИ рдпрд╛ рдЖрдк **рдПрдХ рд╕рдмрдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓** рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдкрдврд╝реЗрдВ:

{% content-ref url="cookie-tossing.md" %}
[cookie-tossing.md](cookie-tossing.md)
{% endcontent-ref %}

### рд╕рддреНрд░ рджрд╛рди

рдпрд╣рд╛рдБ, рд╣рдорд▓рд╛рджрд╛рд░ рдкреАрдбрд╝рд┐рдд рдХреЛ рд╣рдорд▓рд╛рджрд╛рд░ рдХреА рд╕рддреНрд░ рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордирд╛ рдХрд░рддрд╛ рд╣реИред рдкреАрдбрд╝рд┐рдд, рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдореЗрдВ рд▓реЙрдЧ рдЗрди рд╣реИрдВ рдорд╛рдирдХрд░, рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рд╣рдорд▓рд╛рджрд╛рд░ рдХреЗ рдЦрд╛рддреЗ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░реЗрдВрдЧреЗред

рдпрджрд┐ рдЖрдкрдиреЗ **рдПрдХ рд╕рдмрдбреЛрдореЗрди рдореЗрдВ XSS** рдкрд╛рдпрд╛ рд╣реИ рдпрд╛ рдЖрдк **рдПрдХ рд╕рдмрдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓** рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдкрдврд╝реЗрдВ:

{% content-ref url="cookie-tossing.md" %}
[cookie-tossing.md](cookie-tossing.md)
{% endcontent-ref %}

### [JWT рдХреБрдХреА](../hacking-jwt-json-web-tokens.md)

рдкреВрд░реНрд╡ рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рддрд╛рдХрд┐ JWT рдореЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд рджреЛрд╖реЛрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рд╡рд┐рд╡рд░рдг рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдкреГрд╖реНрда рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреЗрдВред

рдХреБрдХреА рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ JSON рд╡реЗрдм рдЯреЛрдХрди (JWT) рдореЗрдВ рднреА рдХрдордЬреЛрд░рд┐рдпрд╛рдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдкреЙрдЯреЗрдВрд╢рд┐рдпрд▓ рджреЛрд╖реЛрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЧрд╣рд░рд╛рдИ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, JWT рд╣реИрдХрд┐рдВрдЧ рдкрд░ рд▓рд┐рдВрдХрд┐рдд рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рдЕрдиреБрд░реЛрдз рдлрд░реНрдЬреА (CSRF)

рдпрд╣ рд╣рдорд▓рд╛ рдПрдХ рд▓реЙрдЧ-рдЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рдЕрдирдЪрд╛рд╣реЗ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╡реЗ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдкреНрд░рдорд╛рдгрд┐рдд рд╣реИрдВред рд╣рдорд▓рд╛рджрд╛рд░ рдЙрди рдХреБрдХреА рдХрд╛ рд╢реЛрдз рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╣рд░ рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИрдВ рд╡рд┐рдХрд▓рд╛рдВрдЧ рд╕рд╛рдЗрдЯ рдкрд░ред

### рдЦрд╛рд▓реА рдХреБрдХреА

(рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП [рдореВрд▓ рдЕрдиреБрд╕рдВрдзрд╛рди](https://blog.ankursundara.com/cookie-bugs/) рджреЗрдЦреЗрдВ) рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреБрдХреА рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдмрд┐рдирд╛ рдирд╛рдо рдХреЗ, рдЬреЛ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░реВрдк рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```js
document.cookie = "a=v1"
document.cookie = "=test value;" // Setting an empty named cookie
document.cookie = "b=v2"
```
рднреЗрдЬреЗ рдЧрдП рдХреБрдХреА рд╣реЗрдбрд░ рдореЗрдВ рдкрд░рд┐рдгрд╛рдо `a=v1; test value; b=v2;` рд╣реИред рд░реЛрдЪрдХ рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдпрджрд┐ рдПрдХ рдЦрд╛рд▓реА рдирд╛рдо рдХреБрдХреА рд╕реЗрдЯ рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рдпрд╣ рдЕрдиреНрдп рдХреБрдХреА рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдЦрд╛рд▓реА рдХреБрдХреА рдХреЛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдорд╛рди рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```js
function setCookie(name, value) {
document.cookie = `${name}=${value}`;
}

setCookie("", "a=b"); // Setting the empty cookie modifies another cookie's value
```
#### Chrome рдмрдЧ: рдпреВрдирд┐рдХреЛрдб рд╕рд░реЛрдЧреЗрдЯ рдХреЛрдбрдкреЙрдЗрдВрдЯ рд╕рдорд╕реНрдпрд╛

Chrome рдореЗрдВ, рдпрджрд┐ рдПрдХ рдпреВрдирд┐рдХреЛрдб рд╕рд░реЛрдЧреЗрдЯ рдХреЛрдбрдкреЙрдЗрдВрдЯ рд╕реЗрдЯ рдХреБрдХреА рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ, рддреЛ `document.cookie` рдХреЛрд░рдкреНрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЦрд╛рд▓реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╡рд╛рдкрд╕ рдЖрддрд╛ рд╣реИ:
```js
document.cookie = "\ud800=meep";
```
рдЗрд╕рд╕реЗ `document.cookie` рдПрдХ рдЦрд╛рд▓реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╕реНрдерд╛рдпреА рдХреНрд╖рддрд┐ рдХреА рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИред

#### рдкрд╛рд░реНрд╕рд┐рдВрдЧ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рдХрд╛рд░рдг рдХреБрдХреА рд╕реНрдордЧрд▓рд┐рдВрдЧ

(рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП [рдореВрд▓ рд╢реЛрдз](https://blog.ankursundara.com/cookie-bugs/) рджреЗрдЦреЗрдВ) рдХрдИ рд╡реЗрдм рд╕рд░реНрд╡рд░, рдЬреИрд╕реЗ рдХрд┐ рдЬрд╛рд╡рд╛ (Jetty, TomCat, Undertow) рдФрд░ рдкрд╛рдпрдерди (Zope, cherrypy, web.py, aiohttp, bottle, webob), рдкреБрд░рд╛рдиреЗ RFC2965 рд╕рдорд░реНрдерди рдХреЗ рдХрд╛рд░рдг рдХреБрдХреА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдЧрд▓рдд рдврдВрдЧ рд╕реЗ рд╣реИрдВрдбрд▓ рдХрд░рддреЗ рд╣реИрдВред рд╡реЗ рдбрдмрд▓-рдХреЛрдЯреНрдб рдХреБрдХреА рдорд╛рди рдХреЛ рдПрдХрд▓ рдорд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдкрдврд╝рддреЗ рд╣реИрдВ, рдпрджрд┐ рдЗрд╕рдореЗрдВ рд╕реЗрдореАрдХреЛрд▓рди рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рд╡рд╣ рд╕рд╛рдорд╛рдиреНрдпрдд: рдХреБрдВрдЬреА-рдорд╛рди рдЬреЛрдбрд╝реЛрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП:
```
RENDER_TEXT="hello world; JSESSIONID=13371337; ASDF=end";
```
#### рдХреБрдХреА рдЗрдВрдЬреЗрдХреНрд╢рди рд╕рдВрд░рдЪрдирд╛рдУрдВ

(рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП [рдореВрд▓ рдЕрдиреБрд╕рдВрдзрд╛рди](https://blog.ankursundara.com/cookie-bugs/) рджреЗрдЦреЗрдВ) рд╕рд░реНрд╡рд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдХреБрдХреА рдХрд╛ рдЧрд▓рдд рдкрд╛рд░реНрд╕рд┐рдВрдЧ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ Undertow, Zope, рдФрд░ рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ Python рдХрд╛ `http.cookie.SimpleCookie` рдФрд░ `http.cookie.BaseCookie` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИ, рдХреБрдХреА рдЗрдВрдЬреЗрдХреНрд╢рди рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЕрд╡рд╕рд░ рдмрдирд╛рддрд╛ рд╣реИред рдпреЗ рд╕рд░реНрд╡рд░реНрд╕ рдирдП рдХреБрдХреА рдХреА рд╢реБрд░реБрдЖрдд рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдЕрд▓рдЧ рдирд╣реАрдВ рдХрд░ рдкрд╛рддреЗ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд╛рд░ рдХреБрдХреА рдмрдирд╛рдиреЗ рдХрд╛ рдореМрдХрд╛ рдорд┐рд▓рддрд╛ рд╣реИ:

* Undertow рдПрдХ quoted value рдХреЗ рдмрд╛рдж рдмрд┐рдирд╛ semicolon рдХреЗ рддреБрд░рдВрдд рдПрдХ рдирдИ рдХреБрдХреА рдХреА рдЙрдореНрдореАрдж рдХрд░рддрд╛ рд╣реИред
* Zope рдЕрдЧрд▓реА рдХреБрдХреА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ comma рдХреА рддрд▓рд╛рд╢ рдХрд░рддрд╛ рд╣реИред
* Python рдХреА рдХреБрдХреА рдХреНрд▓рд╛рд╕реЗрд╕ рдПрдХ space character рдкрд░ рдкрд╛рд░реНрд╕рд┐рдВрдЧ рд╢реБрд░реВ рдХрд░рддреА рд╣реИрдВред

рдпрд╣ рд╡рдВрд╢рд╛рд╡рд╢реЗрд╖реА рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдореЗрдВ рдЦрддрд░рдирд╛рдХ рд╣реИ рдЬреЛ рдХреБрдХреА-рдЖрдзрд╛рд░рд┐рдд CSRF рд╕реБрд░рдХреНрд╖рд╛ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ spoofed CSRF-token рдХреБрдХреА рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреЛ рдЫрд▓ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕рдорд╕реНрдпрд╛ Python рдХреЗ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдХреБрдХреА рдирд╛рдореЛрдВ рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЦрддрд░рдирд╛рдХ рд╣реИ, рдЬрд╣рд╛рдВ рдЕрдВрддрд┐рдо рдШрдЯрдирд╛ рдкрд╣рд▓реЗ рд╡рд╛рд▓реЛрдВ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░ рджреЗрддреА рд╣реИред рдпрд╣ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрджрд░реНрднреЛрдВ рдореЗрдВ `__Secure-` рдФрд░ `__Host-` рдХреБрдХреАрдЬ рдХреЗ рд▓рд┐рдП рднреА рдЪрд┐рдВрддрд╛ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдХреБрдХреАрдЬ рдХреЛ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░реНрд╕ рдХреЛ spoofing рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдмрдирд╛рдиреЗ рдкрд░ рдЕрдзрд┐рдХ рдЪрд┐рдВрддрд╛ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### рдЕрддрд┐рд░рд┐рдХреНрдд рд╡рдВрд░реНрдирд░рдмрд▓ рдХреБрдХреА рдЬрд╛рдВрдЪреЗрдВ

#### **рдореМрд▓рд┐рдХ рдЬрд╛рдВрдЪреЗрдВ**

* **рдХреБрдХреА** рд╣рд░ рдмрд╛рд░ **рд▓реЙрдЧрд┐рди** рдХрд░рдиреЗ рдкрд░ **рдПрдХ рд╕рдорд╛рди** рд╣реИред
* рд▓реЙрдЧ рдЖрдЙрдЯ рдХрд░реЗрдВ рдФрд░ рдЙрд╕реА рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред
* рдПрдХ рд╣реА рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ 2 рдбрд┐рд╡рд╛рдЗрд╕ (рдпрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░) рд╕реЗ рдПрдХ рд╣реА рдЦрд╛рддреЗ рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред
* рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреБрдХреА рдореЗрдВ рдХреЛрдИ рдЬрд╛рдирдХрд╛рд░реА рд╣реИ рдФрд░ рдЙрд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред
* рд▓рдЧрднрдЧ рд╕рдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рд╡рд╛рд▓реЗ рдХрдИ рдЦрд╛рддреЗ рдмрдирд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рд╕рдорд╛рдирддрд╛рдПрдБ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
* рдпрджрд┐ **remember me** рд╡рд┐рдХрд▓реНрдк рд╣реИ рддреЛ рджреЗрдЦреЗрдВ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдпрд╣ рдореМрдЬреВрдж рд╣реИ рдФрд░ рдпрд╣ рд╡рдВрд░реНрдирд░рдмрд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рд╣рдореЗрд╢рд╛ **remember me** рдХреА рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдХреБрдХреА рдХреЗред
* рдкрд╛рд╕рд╡рд░реНрдб рдмрджрд▓рдиреЗ рдХреЗ рдмрд╛рдж рднреА рдкрд┐рдЫрд▓реА рдХреБрдХреА рдХрд╛рдо рдХрд░рддреА рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрд╣ рджреЗрдЦреЗрдВред

#### **рдЙрдиреНрдирдд рдХреБрдХреА рд╣рдорд▓реЗ**

рдпрджрд┐ рд▓реЙрдЧ рдЗрди рдХрд░рддреЗ рд╕рдордп рдХреБрдХреА рд╡рд╣реА рд░рд╣рддреА рд╣реИ (рдпрд╛ рд▓рдЧрднрдЧ рд╡рд╣реА) рддреЛ рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдХреБрдХреА рдЖрдкрдХреЗ рдЦрд╛рддреЗ рдХреЗ рдХрд┐рд╕реА рдХреНрд╖реЗрддреНрд░ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИ (рд╕рдВрднрд╛рд╡рддрдГ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо)ред рддреЛ рдЖрдк:

* рдмрд╣реБрдд рд╕рд╛рд░реЗ **рдЦрд╛рддреЗ** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдореЛрдВ рдХреЗ рд╕рд╛рде рдмрдирд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рдпрд╣ рджреЗрдЦрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдХрд┐ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреИрд╕реЗ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИред
* **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо** рдХреЛ **рдмреНрд░реВрдЯрдлреЛрд░реНрд╕** рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред рдпрджрд┐ рдХреБрдХреА рдХреЗрд╡рд▓ рдЖрдкрдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рд╕рд╣реЗрдЬрддреА рд╣реИ, рддреЛ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо "**Bmin**" рдХреЗ рд╕рд╛рде рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдкрдиреА рдХреБрдХреА рдХреЗ рд╣рд░ рдПрдХ **рдмрд┐рдЯ** рдХреЛ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЖрдкрдХреА рдХреЛрдИ рдПрдХ рдХреБрдХреА рд╡рд╣ рд╣реЛрдЧреА рдЬреЛ "**admin**" рдХреА рд╣реЛрдЧреАред
* **рдкреИрдбрд┐рдВрдЧ** **рдУрд░реЗрдХрд▓** рдХрд╛ рдкреНрд░рдпреЛрдЧ рдХрд░реЗрдВ (рдЖрдк рдХреБрдХреА рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред **рдкреИрдбрдмрд╕реНрдЯрд░** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

**рдкреИрдбрд┐рдВрдЧ рдУрд░реЗрдХрд▓ - рдкреИрдбрдмрд╕реНрдЯрд░ рдЙрджрд╛рд╣рд░рдг**
```bash
padbuster <URL/path/when/successfully/login/with/cookie> <COOKIE> <PAD[8-16]>
# When cookies and regular Base64
padbuster http://web.com/index.php u7bvLewln6PJPSAbMb5pFfnCHSEd6olf 8 -cookies auth=u7bvLewln6PJPSAbMb5pFfnCHSEd6olf

# If Base64 urlsafe or hex-lowercase or hex-uppercase --encoding parameter is needed, for example:
padBuster http://web.com/home.jsp?UID=7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6
7B216A634951170FF851D6CC68FC9537858795A28ED4AAC6 8 -encoding 2
```
Padbuster рдХрдИ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ рдФрд░ рдЖрдкрд╕реЗ рдкреВрдЫреЗрдЧрд╛ рдХрд┐ рдХреМрди рд╕реА рд╕реНрдерд┐рддрд┐ рддреНрд░реБрдЯрд┐ рд╣реИ (рдЬреЛ рдорд╛рдиреНрдп рдирд╣реАрдВ рд╣реИ)ред

рдлрд┐рд░ рдпрд╣ рдХреБрдХреА рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рд▓рдЧреЗрдЧрд╛ (рдпрд╣ рдХрдИ рдорд┐рдирдЯ рд▓реЗ рд╕рдХрддрд╛ рд╣реИ)ред

рдпрджрд┐ рд╣рдорд▓рд╛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдХрд┐рд╕реА рднреА рд╡рд╛рдХреНрдп рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **user=administrator** рдХреЛ **рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ** рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдВ
```
padbuster http://web.com/index.php 1dMjA5hfXh0jenxJQ0iW6QXKkzAGIWsiDAKV3UwJPT2lBP+zAD0D0w== 8 -cookies thecookie=1dMjA5hfXh0jenxJQ0iW6QXKkzAGIWsiDAKV3UwJPT2lBP+zAD0D0w== -plaintext user=administrator
```
рдпрд╣ рдирд┐рд╖реНрдкрд╛рджрди рдЖрдкрдХреЛ рдХреБрдХреА рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рдПрдиреНрдХреЛрдб рдХрд┐рдпрд╛ рджреЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ **user=administrator** рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╢рд╛рдорд┐рд▓ рд╣реИред

**CBC-MAC**

рд╕рдВрднрд╡рддрдГ рдХреБрдХреА рдореЗрдВ рдХреБрдЫ рдореВрд▓реНрдп рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ CBC рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдлрд┐рд░, рдореВрд▓реНрдп рдХреА рдЕрдЦрдВрдбрддрд╛ рдЙрд╕ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ CBC рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╣реА рдореВрд▓реНрдп рдХреЗ рд╕рд╛рде рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЬреИрд╕рд╛ рдХрд┐ IV рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╢реВрдиреНрдп рд╡реЗрдХреНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдЕрдЦрдВрдбрддрд╛ рдЬрд╛рдВрдЪрдиреЗ рдореЗрдВ рдХрдордЬреЛрд░реА рд╣реЛ рд╕рдХрддреА рд╣реИред

**рд╣рдорд▓рд╛**

1. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо **administ** рдХрд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ = **t**
2. рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо **rator\x00\x00\x00 XOR t** рдХрд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ = **t'**
3. рдХреБрдХреА рдореЗрдВ рдорд╛рди **administrator+t'** рд╕реЗрдЯ рдХрд░реЗрдВ (**t'** **(rator\x00\x00\x00 XOR t) XOR t** = **rator\x00\x00\x00** рдХрд╛ рдПрдХ рд╡реИрдз рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╣реЛрдЧрд╛)

**ECB**

рдпрджрд┐ рдХреБрдХреА ECB рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рдпрд╣ рдХрдордЬреЛрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред\
рдЬрдм рдЖрдк рд▓реЙрдЧ рдЗрди рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рд╣рдореЗрд╢рд╛ рд╡рд╣реА рдХреБрдХреА рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред

**рдХреИрд╕реЗ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ рдФрд░ рд╣рдорд▓рд╛ рдХрд░реЗрдВ:**

рд▓рдЧрднрдЧ рд╕рдорд╛рди рдбреЗрдЯрд╛ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо, рдкрд╛рд╕рд╡рд░реНрдб, рдИрдореЗрд▓, рдЖрджрд┐) рдХреЗ рд╕рд╛рде 2 рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдПрдВ рдФрд░ рджреА рдЧрдИ рдХреБрдХреА рдореЗрдВ рдХреЛрдИ рдкреИрдЯрд░реНрди рдЦреЛрдЬрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" рдирд╛рдо рдХреЗ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдПрдВ рдФрд░ рдХреБрдХреА рдореЗрдВ рдХреЛрдИ рдкреИрдЯрд░реНрди рд╣реИ рдпрд╛ рдирд╣реАрдВ рджреЗрдЦреЗрдВ (рдХреНрдпреЛрдВрдХрд┐ ECB рд╣рд░ рдмреНрд▓реЙрдХ рдХреЗ рд╕рд╛рде рд╕рдорд╛рди рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рддрд╛ рд╣реИ, рдЕрдЧрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рд╣реЛрддрд╛ рд╣реИ рддреЛ рд╕рдорд╛рди рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдмрд╛рдЗрдЯреНрд╕ рджрд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ)ред

рдПрдХ рдкреИрдЯрд░реНрди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рдПрдХ рдкреНрд░рдпреБрдХреНрдд рдмреНрд▓реЙрдХ рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде)ред рддреЛ, рдЬрд╛рдирддреЗ рд╣реБрдП рдХрд┐ рдХрд┐рддрдиреЗ "a" рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рд╣реЛрддреЗ рд╣реИрдВ, рдЖрдк рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ: "a"\*(рдмреНрд▓реЙрдХ рдХрд╛ рдЖрдХрд╛рд░)+"admin"ред рдлрд┐рд░, рдЖрдк "a" рдХреЗ рдПрдХ рдмреНрд▓реЙрдХ рдХреЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдкреИрдЯрд░реНрди рдХреЛ рдХреБрдХреА рд╕реЗ рд╣рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдФрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо "admin" рдХреА рдХреБрдХреА рд╣реЛрдЧреАред

## рд╕рдВрджрд░реНрдн

* [https://blog.ankursundara.com/cookie-bugs/](https://blog.ankursundara.com/cookie-bugs/)
* [https://www.linkedin.com/posts/rickey-martin-24533653\_100daysofhacking-penetrationtester-ethicalhacking-activity-7016286424526180352-bwDd](https://www.linkedin.com/posts/rickey-martin-24533653\_100daysofhacking-penetrationtester-ethicalhacking-activity-7016286424526180352-bwDd)
