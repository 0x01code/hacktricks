<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-opslagplekke.

</details>


## Beskrywing

As 'n aanvaller 'n subdomein of die domein van 'n maatskappy kan **beheer of 'n XSS in 'n subdomein vind**, sal hy hierdie aanval kan uitvoer.

Soos aangedui in die Cookies Hacking-seksie, wanneer 'n **koekie aan 'n domein gekoppel word (deur dit te spesifiseer), sal dit in die domein en subdomeine gebruik word**.

{% hint style="danger" %}
Daarom **sal 'n aanvaller in staat wees om 'n spesifieke koekie aan die domein en subdomeine toe te ken deur iets soos** `document.cookie="session=1234; Path=/app/login; domain=.example.com"` te doen.
{% endhint %}

Dit kan gevaarlik wees omdat die aanvaller moontlik in staat sal wees om:

* **Die koekie van die slagoffer aan die aanvaller se rekening te koppel**, sodat as die gebruiker nie daarvan bewus is nie, **hy die aksies in die aanvaller se rekening sal uitvoer** en die aanvaller moontlik interessante inligting kan verkry (kyk na die geskiedenis van die gebruiker se soektogte op die platform, die slagoffer kan sy kredietkaart in die rekening stel...)
* As die **koekie nie verander nadat die gebruiker aanteken nie**, kan die aanvaller net 'n koekie **vaststel**, wag totdat die slagoffer aanteken en dan **daardie koekie gebruik om as die slagoffer aan te teken**.
* As die **koekie 'n aanvanklike waarde stel** (soos in flask waar die **koekie** die **CSRF-token** van die sessie kan **stel** en hierdie waarde behou word nadat die slagoffer aanteken), kan die **aanvaller hierdie bekende waarde stel en dit dan misbruik** (in daardie scenario kan die aanvaller dan die gebruiker 'n CSRF-versoek laat uitvoer omdat hy die CSRF-token ken).

## Koekievolgorde

Wanneer 'n webblaaier twee koekies met dieselfde naam ontvang wat **gedeeltelik dieselfde omvang be√Ønvloed** (domein, subdomeine en pad), sal die **blaaier beide waardes van die koekie stuur** as beide geldig is vir die versoek.

Afhanklik van wie die **spesifiekste pad het** of watter een die **oudste een is**, sal die blaaier **die waarde van die koekie eerste stel** en dan die waarde van die ander een soos in: `Cookie: iduser=MoreSpecificAndOldestCookie; iduser=LessSpecific;`

Die meeste **webwerwe sal slegs die eerste waarde gebruik**. Dus, as 'n aanvaller 'n koekie wil stel, is dit beter om dit te stel voordat 'n ander een gestel word of om dit met 'n meer spesifieke pad te stel.

{% hint style="warning" %}
Verder is die vermo√´ om **'n koekie in 'n meer spesifieke pad te stel** baie interessant, aangesien jy die slagoffer in staat sal stel om met sy koekie te werk, behalwe in die spesifieke pad waar die kwaadwillige koekie gestuur sal word voordat dit gestuur word.
{% endhint %}

## Beskermingsoorskryding

Moontlike beskerming teen hierdie aanval sou wees dat die **webbediener nie versoek aanvaar met twee koekies met dieselfde naam nie, maar twee verskillende waardes**.

Om die scenario waar die aanvaller 'n koekie stel nadat die slagoffer reeds die koekie gekry het, te omseil, kan die aanvaller 'n **koekie-oorvloei veroorsaak** en dan, sodra die **wettige koekie uitgevee is, die kwaadwillige een stel**.

{% content-ref url="cookie-jar-overflow.md" %}
[cookie-jar-overflow.md](cookie-jar-overflow.md)
{% endcontent-ref %}

'n Ander nuttige **omseiling** sou wees om die naam van die koekie **URL-kodering** te gee, aangesien sommige beskermings vir 2 koekies met dieselfde naam in 'n versoek sal kyk en dan sal die bediener die name van die koekies ontkodeer.

## Koekiebom

'n Koekie Tossing-aanval kan ook gebruik word om 'n **Koekiebom**-aanval uit te voer:

{% content-ref url="cookie-bomb.md" %}
[cookie-bomb.md](cookie-bomb.md)
{% endcontent-ref %}

## Verdediging

### Gebruik die voorvoegsel `__Host` in die koekienaam

* As 'n koekienaam hierdie voorvoegsel het, **sal dit slegs aanvaar word** in 'n Set-Cookie-aanwysing as dit gemerk is as Secure, van 'n veilige oorsprong af gestuur is, nie 'n Domain-attribuut insluit nie, en die Path-attribuut op / gestel is.
* **Dit voorkom dat subdomeine 'n koekie aan die apex-domein kan afdwing, aangesien hierdie koekies as "domein-geblokkeer" beskou kan word**

## Verwysings

* [**@blueminimal**](https://twitter.com/blueminimal)
* [**https://speakerdeck.com/filedescriptor/the-cookie-monster-in-your-browsers**](https://speakerdeck.com/filedescriptor/the-cookie-monster-in-your-browsers)
* [**https://github.blog/2013-04-09-yummy-cookies-across-domains/**](https://github.blog/2013-04-09-yummy-cookies-across-domains/)


<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-opslagplekke.

</details>
