# Inseguridades de UUID

<details>

<summary><strong>Aprende a hackear AWS desde cero hasta convertirte en un h칠roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Equipos Rojos de AWS de HackTricks)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Obt칠n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informaci칩n B치sica

Los Identificadores 칔nicos Universalmente (UUIDs) son **n칰meros de 128 bits utilizados para identificar informaci칩n de forma 칰nica** en sistemas inform치ticos. Los UUIDs son esenciales en aplicaciones donde se necesitan identificadores 칰nicos sin coordinaci칩n central. Com칰nmente se utilizan como claves de bases de datos y pueden hacer referencia a varios elementos como documentos y sesiones.

Los UUIDs est치n dise침ados para ser 칰nicos y **dif칤ciles de adivinar**. Est치n estructurados en un formato espec칤fico, divididos en cinco grupos representados por 32 d칤gitos hexadecimales. Existen diferentes versiones de UUIDs, cada una sirviendo para diferentes prop칩sitos:

* **UUID v1** est치 basado en el tiempo, incorporando la marca de tiempo, la secuencia de reloj y el ID del nodo (direcci칩n MAC), pero potencialmente puede exponer informaci칩n del sistema.
* **UUID v2** es similar al v1 pero incluye modificaciones para dominios locales (poco utilizado).
* **UUID v3 y v5** generan UUIDs utilizando valores hash de espacio de nombres y nombre, con v3 utilizando MD5 y v5 utilizando SHA-1.
* **UUID v4** se genera casi completamente al azar, proporcionando un alto nivel de anonimato pero con un ligero riesgo de duplicados.

{% hint style="success" %}
Ten en cuenta que la versi칩n y subversi칩n del UUID generalmente aparece en la misma posici칩n dentro del UUID. Por ejemplo en:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* La **posici칩n de la M** indica la **versi칩n** del UUID. En el ejemplo anterior, es un UUID v**1**.
* La **posici칩n de la N** indica la variante del UUID.
{% endhint %}

## Ataque Sandwich

El "Ataque Sandwich" es un tipo espec칤fico de ataque que **explota la previsibilidad de la generaci칩n de UUID v1 en aplicaciones web**, particularmente en funciones como restablecimiento de contrase침as. El UUID v1 se genera en funci칩n del tiempo, la secuencia de reloj y la direcci칩n MAC del nodo, lo que puede hacerlo algo predecible si un atacante puede obtener algunos de estos UUIDs generados cerca en el tiempo.

### Ejemplo

Imagina una aplicaci칩n web que utiliza UUID v1 para generar enlaces de restablecimiento de contrase침a. As칤 es como un atacante podr칤a explotar esto para obtener acceso no autorizado:

1. **Configuraci칩n Inicial**:

* El atacante tiene control sobre dos cuentas de correo electr칩nico: \`atacante1@acme.com\` y \`atacante2@acme.com\`.
* La cuenta de correo electr칩nico del objetivo es \`victima@acme.com\`.

2. **Ejecuci칩n**:

* El atacante inicia un restablecimiento de contrase침a para su primera cuenta (\`atacante1@acme.com\`) y recibe un enlace de restablecimiento de contrase침a con un UUID, digamos \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Inmediatamente despu칠s, el atacante inicia un restablecimiento de contrase침a para la cuenta de la v칤ctima (\`victima@acme.com\`) y luego r치pidamente para la segunda cuenta controlada por el atacante (\`atacante2@acme.com\`).
* El atacante recibe un enlace de restablecimiento para la segunda cuenta con un UUID, digamos \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **An치lisis**:

* El atacante ahora tiene dos UUIDs generados cerca en el tiempo (\`99874128\` y \`998796b4\`). Dada la naturaleza secuencial de los UUIDs basados en el tiempo, es probable que el UUID para la cuenta de la v칤ctima caiga entre estos dos valores.

4. **Ataque de Fuerza Bruta:**

* El atacante utiliza una herramienta para generar UUIDs entre estos dos valores y prueba cada UUID generado intentando acceder al enlace de restablecimiento de contrase침a (por ejemplo, \`https://www.acme.com/reset/\<UUID-generado>\`).
* Si la aplicaci칩n web no limita adecuadamente la velocidad o bloquea tales intentos, el atacante puede probar r치pidamente todos los UUIDs posibles en el rango.

5. **Acceso Obtenido:**

* Una vez que se descubre el UUID correcto para el enlace de restablecimiento de contrase침a de la v칤ctima, el atacante puede restablecer la contrase침a de la v칤ctima y obtener acceso no autorizado a su cuenta.

### Herramientas

* Puedes realizar el ataque sandwich autom치ticamente con la herramienta: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Puedes detectar este tipo de UUIDs en Burp Suite con la extensi칩n [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248).

## Referencias

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)
