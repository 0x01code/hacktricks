# Ευπάθειες UUID

<details>

<summary><strong>Μάθετε να κάνετε χάκινγκ στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Ειδικός Ερυθρού Συνεργείου AWS του HackTricks)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι υποστήριξης του HackTricks:

* Αν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε** στην 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα τηλεγραφήματος**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs** στα [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

## Βασικές Πληροφορίες

Τα Μοναδικά Παγκοσμίως Αναγνωριστικά (UUIDs) είναι **128-μπιτα νούμερα που χρησιμοποιούνται για τη μοναδική αναγνώριση πληροφοριών** σε υπολογιστικά συστήματα. Τα UUIDs είναι απαραίτητα σε εφαρμογές όπου απαιτούνται μοναδικά αναγνωριστικά χωρίς κεντρικό συντονισμό. Χρησιμοποιούνται συχνά ως κλειδιά βάσεων δεδομένων και μπορούν να αναφέρονται σε διάφορα στοιχεία όπως έγγραφα και συνεδρίες.

Τα UUIDs σχεδιάστηκαν να είναι μοναδικά και **δύσκολα να μαντευτούν**. Δομούνται σε ένα συγκεκριμένο μορφότυπο, χωρισμένο σε πέντε ομάδες που αναπαρίστανται ως 32 δεκαεξαδικά ψηφία. Υπάρχουν διαφορετικές εκδόσεις των UUIDs, καθεμία εξυπηρετώντας διαφορετικούς σκοπούς:

* **UUID v1** βασίζεται στο χρόνο, τη σειρά ρολογιού και τη διεύθυνση MAC του κόμβου, αλλά μπορεί να αποκαλύψει πιθανώς πληροφορίες συστήματος.
* **UUID v2** είναι παρόμοιο με το v1 αλλά περιλαμβάνει τροποποιήσεις για τοπικούς τομείς (δεν χρησιμοποιείται ευρέως).
* **UUID v3 και v5** δημιουργούν UUIDs χρησιμοποιώντας τιμές κατακερματισμού από το πεδίο ονομασίας και το όνομα, με το v3 να χρησιμοποιεί το MD5 και το v5 το SHA-1.
* **UUID v4** δημιουργείται σχεδόν εντελώς τυχαία, παρέχοντας υψηλό επίπεδο ανωνυμίας αλλά με ελαφρύ κίνδυνο διπλοτύπων.

{% hint style="success" %}
Σημειώστε ότι η έκδοση και η υποέκδοση του UUID εμφανίζονται συνήθως στην ίδια θέση μέσα στο UUID. Για παράδειγμα στο:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* Η **θέση του M** υποδηλώνει την **έκδοση του UUID**. Στο παράδειγμα παραπάνω, είναι το UUID v**1**.
* Η **θέση του N** υποδηλώνει την παραλλαγή του UUID.
{% endhint %}

## Επίθεση Sandwich

Η "Επίθεση Sandwich" είναι ένα συγκεκριμένο είδος επίθεσης που **εκμεταλλεύεται την προβλεψιμότητα της δημιουργίας UUID v1 σε web εφαρμογές**, ιδιαίτερα σε χαρακτηριστικά όπως η επαναφορά κωδικών. Το UUID v1 δημιουργείται βασιζόμενο στον χρόνο, τη σειρά ρολογιού και τη διεύθυνση MAC του κόμβου, κάτι που μπορεί να το καθιστά κάπως προβλέψιμο αν ένας επιτιθέμενος μπορεί να αποκτήσει μερικά από αυτά τα UUIDs που δημιουργήθηκαν κοντά στον ίδιο χρόνο.

### Παράδειγμα

Φανταστείτε μια web εφαρμογή που χρησιμοποιεί το UUID v1 για τη δημιουργία συνδέσμων επαναφοράς κωδικού. Έτσι μπορεί να εκμεταλλευτεί ένας επιτιθέμενος αυτό για να αποκτήσει μη εξουσιοδοτημένη πρόσβαση:

1. **Αρχική Διάταξη**:

* Ο επιτιθέμενος έχει έλεγχο σε δύο λογαριασμούς email: \`attacker1@acme.com\` και \`attacker2@acme.com\`.
* Ο στόχος έχει το λογαριασμό email \`victim@acme.com\`.

2. **Εκτέλεση**:

* Ο επιτιθέμενος ενεργοποιεί μια επαναφορά κωδικού για τον πρώτο του λογαριασμό (\`attacker1@acme.com\`) και λαμβάνει ένα σύνδεσμο επαναφοράς κωδικού με ένα UUID, λέμε ότι \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Αμέσως μετά, ο επιτιθέμενος ενεργοποιεί μια επαναφορά κωδικού για τον λογαριασμό του θύματος (\`victim@acme.com\`) και στη συνέχεια γρήγορα για τον δεύτερο λογαριασμό που ελέγχει ο επιτιθέμενος (\`attacker2@acme.com\`).
* Ο επιτιθέμενος λαμβάνει έναν σύνδεσμο επαναφοράς για τον δεύτερο λογαριασμό με ένα UUID, λέμε ότι \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **Ανάλυση**:

* Ο επιτιθέμενος τώρα έχει δύο UUIDs που δημιουργήθηκαν κοντά στον ίδιο χρόνο (\`99874128\` και \`998796b4\`). Δεδομένης της συνεχούς φύσης των UUIDs βασισμένων στον χρόνο, το UUID για τον λογαριασμό του θύματος πιθανότατα θα βρίσκεται μεταξύ αυτών των δύο τιμών.

4. **Επίθεση Βίας:**

* Ο επιτιθέμενος χρησιμοποιεί ένα εργαλείο για τη δημιουργία UUIDs μεταξύ αυτών των δύο τιμών και δοκιμάζει κάθε δημιουργημένο UUID δοκιμάζοντας να έχει πρόσβαση στον σύνδεσμο επαναφοράς κωδικού (π.χ., \`https://www.acme.com/reset/\<δημιουργημένο-UUID>\`).
* Αν η web εφαρμογή δεν περιορίζει επαρκώς τον ρυθμό ή αποκλείει τέτοιες προσπάθειες, ο επιτιθέμενος μπορεί γρήγορα να δοκιμάσει όλα τα πιθανά UUIDs στο εύρος.

5. **Πρόσβαση Κερδισμένη:**

* Μόλις ανακαλύψει το σωστό UUID για τον σύνδεσμο επαναφοράς κωδικού του θύματος, ο επιτιθέμενος μπορεί να επαναφέρει τον κωδικό του θύματος και να αποκτήσει μη εξουσιοδοτημένη πρόσβαση στον λογαριασμό του.

### Εργαλεία

* Μπορείτε να εκτελέσετε αυτήν την επίθεση αυτόματα με το εργαλείο: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Μπορείτε να ανιχνεύσετε αυτού του τύπου τα UUIDs στο Burp Suite με
