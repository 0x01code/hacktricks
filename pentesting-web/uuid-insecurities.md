# Vulnerabilit√† delle UUID

<details>

<summary><strong>Impara l'hacking AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repository di Github.

</details>

## Informazioni di Base

Gli Identificatori Unici Universali (UUID) sono **numeri a 128 bit utilizzati per identificare in modo univoco le informazioni** nei sistemi informatici. Gli UUID sono essenziali nelle applicazioni in cui sono necessari identificatori univoci senza coordinazione centrale. Sono comunemente utilizzati come chiavi di database e possono fare riferimento a vari elementi come documenti e sessioni.

Gli UUID sono progettati per essere unici e **difficili da indovinare**. Sono strutturati in un formato specifico, divisi in cinque gruppi rappresentati da 32 cifre esadecimali. Esistono diverse versioni di UUID, ognuna con scopi diversi:

* **UUID v1** √® basato sul tempo, incorpora il timestamp, la sequenza dell'orologio e l'ID del nodo (indirizzo MAC), ma pu√≤ potenzialmente esporre informazioni di sistema.
* **UUID v2** √® simile al v1 ma include modifiche per i domini locali (non comunemente usato).
* **UUID v3 e v5** generano UUID utilizzando valori hash da namespace e nome, con v3 che utilizza MD5 e v5 che utilizza SHA-1.
* **UUID v4** √® generato quasi interamente in modo casuale, fornendo un alto livello di anonimato ma con un leggero rischio di duplicati.

{% hint style="success" %}
Nota che la versione e la sottoversione dell'UUID di solito appaiono nella stessa posizione all'interno dell'UUID. Ad esempio in:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* La **posizione della M** indica la **versione** dell'UUID. Nell'esempio sopra, √® un UUID v**1**.
* La **posizione della N** indica la variante dell'UUID.
{% endhint %}

## Attacco Sandwich

Il "Sandwich Attack" √® un tipo specifico di attacco che **sfrutta la prevedibilit√† della generazione di UUID v1 nelle applicazioni web**, in particolare nelle funzionalit√† come il reset della password. UUID v1 √® generato in base al tempo, alla sequenza dell'orologio e all'indirizzo MAC del nodo, il che pu√≤ renderlo in parte prevedibile se un attaccante pu√≤ ottenere alcuni di questi UUID generati vicini nel tempo.

### Esempio

Immagina un'applicazione web che utilizza UUID v1 per generare link di reset della password. Ecco come un attaccante potrebbe sfruttare questo per ottenere l'accesso non autorizzato:

1. **Configurazione Iniziale**:

* L'attaccante ha il controllo su due account email: \`attacker1@acme.com\` e \`attacker2@acme.com\`.
* L'account email del target √® \`vittima@acme.com\`.

2. **Esecuzione**:

* L'attaccante avvia un reset della password per il suo primo account (\`attacker1@acme.com\`) e riceve un link di reset della password con un UUID, ad esempio \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Subito dopo, l'attaccante avvia un reset della password per l'account della vittima (\`vittima@acme.com\`) e quindi rapidamente per il secondo account controllato dall'attaccante (\`attacker2@acme.com\`).
* L'attaccante riceve un link di reset per il secondo account con un UUID, ad esempio \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **Analisi**:

* L'attaccante ha ora due UUID generati vicini nel tempo (\`99874128\` e \`998796b4\`). Date la natura sequenziale degli UUID basati sul tempo, l'UUID per l'account della vittima probabilmente si trover√† tra questi due valori.

4. **Attacco di Forza Bruta:**

* L'attaccante utilizza uno strumento per generare UUID tra questi due valori e testa ciascun UUID generato cercando di accedere al link di reset della password (ad esempio, \`https://www.acme.com/reset/\<generated-UUID>\`).
* Se l'applicazione web non limita adeguatamente la velocit√† o blocca tali tentativi, l'attaccante pu√≤ testare rapidamente tutti gli UUID possibili nell'intervallo.

5. **Accesso Ottenuto:**

* Una volta scoperto l'UUID corretto per il link di reset della password della vittima, l'attaccante pu√≤ reimpostare la password della vittima e ottenere l'accesso non autorizzato al suo account.

### Strumenti

* Puoi eseguire l'attacco sandwich automaticamente con lo strumento: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Puoi rilevare questo tipo di UUID in Burp Suite con l'estensione [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248).

## Riferimenti

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)
