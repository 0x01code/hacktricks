# Vuln√©rabilit√©s des UUID

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert de l'√©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

## Informations de base

Les Identifiants Universellement Uniques (UUID) sont des **nombres de 128 bits utilis√©s pour identifier de mani√®re unique des informations** dans les syst√®mes informatiques. Les UUID sont essentiels dans les applications o√π des identifiants uniques sont n√©cessaires sans coordination centrale. Ils sont couramment utilis√©s comme cl√©s de base de donn√©es et peuvent faire r√©f√©rence √† divers √©l√©ments tels que des documents et des sessions.

Les UUID sont con√ßus pour √™tre uniques et **difficiles √† deviner**. Ils sont structur√©s dans un format sp√©cifique, divis√© en cinq groupes repr√©sent√©s par 32 chiffres hexad√©cimaux. Il existe diff√©rentes versions d'UUID, chacune servant √† des fins diff√©rentes :

* **UUID v1** est bas√© sur le temps, incorporant le timestamp, la s√©quence d'horloge et l'ID du n≈ìud (adresse MAC), mais il peut potentiellement exposer des informations syst√®me.
* **UUID v2** est similaire √† v1 mais inclut des modifications pour les domaines locaux (peu utilis√©).
* **UUID v3 et v5** g√©n√®rent des UUID en utilisant des valeurs de hachage √† partir de l'espace de noms et du nom, v3 utilisant MD5 et v5 utilisant SHA-1.
* **UUID v4** est g√©n√©r√© presque enti√®rement de mani√®re al√©atoire, offrant un haut niveau d'anonymat mais avec un l√©ger risque de doublons.

{% hint style="success" %}
Notez que la version et la sous-version de l'UUID apparaissent g√©n√©ralement √† la m√™me position √† l'int√©rieur de l'UUID. Par exemple dans :\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* La **position du M** indique la **version** de l'UUID. Dans l'exemple ci-dessus, il s'agit de l'UUID v**1**.
* La **position du N** indique la variante de l'UUID.
{% endhint %}

## Attaque Sandwich

L'¬´ Attaque Sandwich ¬ª est un type sp√©cifique d'attaque qui **exploite la pr√©visibilit√© de la g√©n√©ration d'UUID v1 dans les applications web**, en particulier dans des fonctionnalit√©s telles que les r√©initialisations de mot de passe. L'UUID v1 est g√©n√©r√© en fonction du temps, de la s√©quence d'horloge et de l'adresse MAC du n≈ìud, ce qui le rend quelque peu pr√©visible si un attaquant peut obtenir certains de ces UUID g√©n√©r√©s proches dans le temps.

### Exemple

Imaginez une application web qui utilise l'UUID v1 pour g√©n√©rer des liens de r√©initialisation de mot de passe. Voici comment un attaquant pourrait exploiter cela pour obtenir un acc√®s non autoris√© :

1. **Configuration initiale** :

* L'attaquant contr√¥le deux comptes e-mail : \`attaquant1@acme.com\` et \`attaquant2@acme.com\`.
* Le compte e-mail de la cible est \`victime@acme.com\`.

2. **Ex√©cution** :

* L'attaquant d√©clenche une r√©initialisation de mot de passe pour son premier compte (\`attaquant1@acme.com\`) et re√ßoit un lien de r√©initialisation de mot de passe avec un UUID, disons \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Imm√©diatement apr√®s, l'attaquant d√©clenche une r√©initialisation de mot de passe pour le compte de la victime (\`victime@acme.com\`) puis rapidement pour le deuxi√®me compte contr√¥l√© par l'attaquant (\`attaquant2@acme.com\`).
* L'attaquant re√ßoit un lien de r√©initialisation pour le deuxi√®me compte avec un UUID, disons \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **Analyse** :

* L'attaquant a maintenant deux UUID g√©n√©r√©s proches dans le temps (\`99874128\` et \`998796b4\`). Compte tenu de la nature s√©quentielle des UUID bas√©s sur le temps, l'UUID pour le compte de la victime se situera probablement entre ces deux valeurs.

4. **Attaque par Force Brute** :

* L'attaquant utilise un outil pour g√©n√©rer des UUID entre ces deux valeurs et teste chaque UUID g√©n√©r√© en essayant d'acc√©der au lien de r√©initialisation de mot de passe (par exemple, \`https://www.acme.com/reset/\<UUID-g√©n√©r√©>\`).
* Si l'application web ne limite pas correctement le taux ou ne bloque pas de telles tentatives, l'attaquant peut rapidement tester tous les UUID possibles dans la plage.

5. **Acc√®s Obtenu** :

* Une fois que le bon UUID pour le lien de r√©initialisation de mot de passe de la victime est d√©couvert, l'attaquant peut r√©initialiser le mot de passe de la victime et obtenir un acc√®s non autoris√© √† son compte.

### Outils

* Vous pouvez effectuer l'attaque sandwich automatiquement avec l'outil : [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Vous pouvez d√©tecter ce type d'UUID dans Burp Suite avec l'extension [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248).

## R√©f√©rences

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)
