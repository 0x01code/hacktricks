# UUID-Sicherheitsl√ºcken

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositorys einreichen.

</details>

## Grundlegende Informationen

Universally Unique Identifiers (UUIDs) sind **128-Bit-Nummern, die zur eindeutigen Identifizierung von Informationen** in Computersystemen verwendet werden. UUIDs sind in Anwendungen unerl√§sslich, in denen eindeutige Kennungen ohne zentrale Koordination erforderlich sind. Sie werden h√§ufig als Datenbankschl√ºssel verwendet und k√∂nnen sich auf verschiedene Elemente wie Dokumente und Sitzungen beziehen.

UUIDs sind darauf ausgelegt, eindeutig und **schwer zu erraten** zu sein. Sie sind in einem bestimmten Format strukturiert, das in f√ºnf Gruppen aufgeteilt ist und durch 32 hexadezimale Ziffern dargestellt wird. Es gibt verschiedene Versionen von UUIDs, von denen jede unterschiedliche Zwecke erf√ºllt:

* **UUID v1** basiert auf der Zeit und enth√§lt den Zeitstempel, die Taktfrequenz und die Knoten-ID (MAC-Adresse), kann jedoch potenziell Systeminformationen preisgeben.
* **UUID v2** √§hnelt v1, enth√§lt jedoch Modifikationen f√ºr lokale Dom√§nen (wenig verwendet).
* **UUID v3 und v5** generieren UUIDs mithilfe von Hash-Werten aus Namespace und Name, wobei v3 MD5 und v5 SHA-1 verwendet.
* **UUID v4** wird fast vollst√§ndig zuf√§llig generiert und bietet ein hohes Ma√ü an Anonymit√§t, birgt jedoch ein geringes Risiko von Duplikaten.

{% hint style="success" %}
Beachten Sie, dass die Version und Unter-Version des UUID normalerweise an derselben Stelle innerhalb des UUID erscheinen. Zum Beispiel in:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* Die **Position des M** gibt die UUID-**Version** an. Im obigen Beispiel handelt es sich um UUID v**1**.
* Die **Position des N** gibt die UUID-Variante an.
{% endhint %}

## Sandwich-Angriff

Der "Sandwich-Angriff" ist ein spezifischer Angriffstyp, der die Vorhersehbarkeit der UUID-v1-Generierung in Webanwendungen **ausnutzt**, insbesondere in Funktionen wie Passwortzur√ºcksetzungen. UUID v1 wird basierend auf der Zeit, der Taktfrequenz und der MAC-Adresse des Knotens generiert, was sie f√ºr einen Angreifer etwas vorhersehbar machen kann, wenn er einige dieser nahe in der Zeit generierten UUIDs erhalten kann.

### Beispiel

Stellen Sie sich eine Webanwendung vor, die UUID v1 f√ºr die Generierung von Passwortzur√ºcksetzungslinks verwendet. So k√∂nnte ein Angreifer dies ausnutzen, um unbefugten Zugriff zu erlangen:

1. **Erstkonfiguration**:

* Der Angreifer hat die Kontrolle √ºber zwei E-Mail-Konten: \`attacker1@acme.com\` und \`attacker2@acme.com\`.
* Das E-Mail-Konto des Ziels ist \`victim@acme.com\`.

2. **Ausf√ºhrung**:

* Der Angreifer l√∂st einen Passwortzur√ºcksetzungsvorgang f√ºr sein erstes Konto aus (\`attacker1@acme.com\`) und erh√§lt einen Passwortzur√ºcksetzungslink mit einer UUID, z. B. \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Unmittelbar danach l√∂st der Angreifer einen Passwortzur√ºcksetzungsvorgang f√ºr das Konto des Opfers (\`victim@acme.com\`) und dann schnell f√ºr das zweite vom Angreifer kontrollierte Konto (\`attacker2@acme.com\`) aus.
* Der Angreifer erh√§lt einen Zur√ºcksetzungslink f√ºr das zweite Konto mit einer UUID, z. B. \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **Analyse**:

* Der Angreifer hat jetzt zwei nahe in der Zeit generierte UUIDs (\`99874128\` und \`998796b4\`). Angesichts der sequenziellen Natur von zeitbasierten UUIDs wird die UUID f√ºr das Konto des Opfers wahrscheinlich zwischen diesen beiden Werten liegen.

4. **Brute-Force-Angriff:**

* Der Angreifer verwendet ein Tool, um UUIDs zwischen diesen beiden Werten zu generieren, und testet jede generierte UUID, indem er versucht, auf den Passwortzur√ºcksetzungslink zuzugreifen (z. B. \`https://www.acme.com/reset/\<generierte-UUID>\`).
* Wenn die Webanwendung solche Versuche nicht angemessen drosselt oder blockiert, kann der Angreifer schnell alle m√∂glichen UUIDs im Bereich testen.

5. **Zugriff erhalten:**

* Sobald die richtige UUID f√ºr den Passwortzur√ºcksetzungslink des Opfers entdeckt wurde, kann der Angreifer das Passwort des Opfers zur√ºcksetzen und unbefugten Zugriff auf sein Konto erlangen.

### Tools

* Sie k√∂nnen den Sandwich-Angriff automatisch mit dem Tool durchf√ºhren: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Sie k√∂nnen diese Art von UUIDs in Burp Suite mit der Erweiterung [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248) erkennen.

## Referenzen

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)
