# Inseguran√ßas de UUID

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

## Informa√ß√µes B√°sicas

Identificadores √önicos Universalmente (UUIDs) s√£o **n√∫meros de 128 bits usados para identificar informa√ß√µes de forma √∫nica** em sistemas de computador. UUIDs s√£o essenciais em aplica√ß√µes onde identificadores √∫nicos s√£o necess√°rios sem coordena√ß√£o central. Eles s√£o comumente usados como chaves de banco de dados e podem se referir a v√°rios elementos como documentos e sess√µes.

UUIDs s√£o projetados para serem √∫nicos e **dif√≠ceis de adivinhar**. Eles s√£o estruturados em um formato espec√≠fico, divididos em cinco grupos representados por 32 d√≠gitos hexadecimais. Existem diferentes vers√µes de UUIDs, cada uma servindo a prop√≥sitos diferentes:

* **UUID v1** √© baseado em tempo, incorporando o timestamp, sequ√™ncia de rel√≥gio e ID do n√≥ (endere√ßo MAC), mas pode potencialmente expor informa√ß√µes do sistema.
* **UUID v2** √© semelhante ao v1, mas inclui modifica√ß√µes para dom√≠nios locais (n√£o amplamente usados).
* **UUID v3 e v5** geram UUIDs usando valores de hash de namespace e nome, com v3 usando MD5 e v5 usando SHA-1.
* **UUID v4** √© gerado quase que inteiramente aleatoriamente, fornecendo um alto n√≠vel de anonimato, mas com um leve risco de duplicatas.

{% hint style="success" %}
Note que a vers√£o e subvers√£o do UUID geralmente aparece na mesma posi√ß√£o dentro do UUID. Por exemplo em:\
12345678 - abcd - 1a56 - a539 - 103755193864\
xxxxxxxx  - xxxx - Mxxx - Nxxx - xxxxxxxxxxxx

* A **posi√ß√£o do M** indica a **vers√£o** do UUID. No exemplo acima, √© o UUID v**1**.
* A **posi√ß√£o do N** indica a variante do UUID.
{% endhint %}

## Ataque de Sandu√≠che

O "Ataque de Sandu√≠che" √© um tipo espec√≠fico de ataque que **explora a previsibilidade da gera√ß√£o de UUID v1 em aplica√ß√µes web**, particularmente em recursos como redefini√ß√µes de senha. O UUID v1 √© gerado com base no tempo, sequ√™ncia de rel√≥gio e o endere√ßo MAC do n√≥, o que pode torn√°-lo um pouco previs√≠vel se um atacante puder obter alguns desses UUIDs gerados pr√≥ximos no tempo.

### Exemplo

Imagine uma aplica√ß√£o web que usa UUID v1 para gerar links de redefini√ß√£o de senha. Veja como um atacante pode explorar isso para obter acesso n√£o autorizado:

1. **Configura√ß√£o Inicial**:

* O atacante tem controle sobre duas contas de e-mail: \`atacante1@acme.com\` e \`atacante2@acme.com\`.
* A conta de e-mail do alvo √© \`v√≠tima@acme.com\`.

2. **Execu√ß√£o**:

* O atacante aciona uma redefini√ß√£o de senha para sua primeira conta (\`atacante1@acme.com\`) e recebe um link de redefini√ß√£o de senha com um UUID, digamos \`99874128-7592-11e9-8201-bb2f15014a14\`.
* Imediatamente depois, o atacante aciona uma redefini√ß√£o de senha para a conta da v√≠tima (\`v√≠tima@acme.com\`) e ent√£o rapidamente para a segunda conta controlada pelo atacante (\`atacante2@acme.com\`).
* O atacante recebe um link de redefini√ß√£o para a segunda conta com um UUID, digamos \`998796b4-7592-11e9-8201-bb2f15014a14\`.

3. **An√°lise**:

* O atacante agora tem dois UUIDs gerados pr√≥ximos no tempo (\`99874128\` e \`998796b4\`). Dada a natureza sequencial dos UUIDs baseados em tempo, o UUID para a conta da v√≠tima provavelmente estar√° entre esses dois valores.

4. **Ataque de For√ßa Bruta:**

* O atacante usa uma ferramenta para gerar UUIDs entre esses dois valores e testa cada UUID gerado tentando acessar o link de redefini√ß√£o de senha (por exemplo, \`https://www.acme.com/reset/\<UUID-gerado>\`).
* Se a aplica√ß√£o web n√£o limitar adequadamente a taxa ou bloquear tais tentativas, o atacante pode testar rapidamente todos os UUIDs poss√≠veis no intervalo.

5. **Acesso Obtido:**

* Uma vez que o UUID correto para o link de redefini√ß√£o de senha da v√≠tima √© descoberto, o atacante pode redefinir a senha da v√≠tima e obter acesso n√£o autorizado √† conta.

### Ferramentas

* Voc√™ pode realizar o ataque de sandu√≠che automaticamente com a ferramenta: [**https://github.com/Lupin-Holmes/sandwich**](https://github.com/Lupin-Holmes/sandwich)
* Voc√™ pode detectar esse tipo de UUIDs no Burp Suite com a extens√£o [**UUID Detector**](https://portswigger.net/bappstore/65f32f209a72480ea5f1a0dac4f38248).

## Refer√™ncias

* [https://versprite.com/blog/universally-unique-identifiers/](https://versprite.com/blog/universally-unique-identifiers/)
