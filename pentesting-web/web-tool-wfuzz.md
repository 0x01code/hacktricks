# Outil Web - WFuzz

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

Un outil pour FUZZ les applications web n'importe o√π.

> Wfuzz a √©t√© cr√©√© pour faciliter la t√¢che dans les √©valuations des applications web et il est bas√© sur un concept simple : il remplace toute r√©f√©rence au mot-cl√© FUZZ par la valeur d'une charge utile donn√©e.

## Installation

Install√© dans Kali

Github : [https://github.com/xmendez/wfuzz](https://github.com/xmendez/wfuzz)
```
pip install wfuzz
```
## Options de filtrage
```bash
--hs/ss "regex" #Hide/Show
#Simple example, match a string: "Invalid username"
#Regex example: "Invalid *"

--hc/sc CODE #Hide/Show by code in response
--hl/sl NUM #Hide/Show by number of lines in response
--hw/sw NUM #Hide/Show by number of words in response
--hh/sh NUM #Hide/Show by number of chars in response
--hc/sc NUM #Hide/Show by response code
```
## Options de sortie
```bash
wfuzz -e printers #Prints the available output formats
-f /tmp/output,csv #Saves the output in that location in csv format
```
### Options d'encodeurs

Les encodeurs sont utilis√©s pour modifier les caract√®res d'une requ√™te afin de contourner les filtres de s√©curit√©. Voici les options d'encodeurs disponibles dans wfuzz :

- **URL encodeur (URL)** : Encode les caract√®res sp√©ciaux en utilisant le format d'encodage d'URL (%XX).
- **HTML encodeur (HTML)** : Encode les caract√®res sp√©ciaux en utilisant le format d'encodage HTML (&#xXX;).
- **Base64 encodeur (B64)** : Encode les donn√©es en utilisant l'algorithme Base64.
- **Quoted Printable encodeur (QP)** : Encode les donn√©es en utilisant l'algorithme Quoted Printable.
- **Hexadecimal encodeur (HEX)** : Encode les donn√©es en utilisant l'algorithme Hexadecimal.
- **ASCII encodeur (ASCII)** : Encode les donn√©es en utilisant l'algorithme ASCII.

Il est important de noter que l'utilisation d'encodeurs peut augmenter le temps de traitement de la requ√™te.
```bash
wfuzz -e encoders #Prints the available encoders
#Examples: urlencode, md5, base64, hexlify, uri_hex, doble urlencode
```
Pour utiliser un encodeur, vous devez l'indiquer dans l'option **"-w"** ou **"-z"**.

Exemples :
```bash
-z file,/path/to/file,md5 #Will use a list inside the file, and will transform each value into its md5 hash before sending it
-w /path/to/file,base64 #Will use a list, and transform to base64
-z list,each-element-here,hexlify #Inline list and to hex before sending values
```
## Fiche de r√©f√©rence

### Bruteforce de formulaire de connexion

#### **POST, Liste unique, filtre de cha√Æne (cach√©)**
```bash
wfuzz -c -w users.txt --hs "Login name" -d "name=FUZZ&password=FUZZ&autologin=1&enter=Sign+in" http://zipper.htb/zabbix/index.php
#Here we have filtered by line
```
#### **POST, 2 listes, code de filtre (montrer)**

Dans cette section, nous allons voir comment utiliser wfuzz pour envoyer une requ√™te POST avec deux listes et filtrer le code de r√©ponse.

La syntaxe de base est la suivante :

```
wfuzz -c -z file,<list1> -z file,<list2> --hs <response_code> <url> -d "<post_data>"
```

Explications :

- `-c` : affiche la sortie en couleurs
- `-z file,<list1>` : sp√©cifie que la liste 1 est un fichier
- `-z file,<list2>` : sp√©cifie que la liste 2 est un fichier
- `--hs <response_code>` : sp√©cifie le code de r√©ponse √† filtrer
- `<url>` : l'URL cible
- `-d "<post_data>"` : les donn√©es POST √† envoyer

Exemple :

```
wfuzz -c -z file,users.txt -z file,passwords.txt --hs 200 http://example.com/login.php -d "username=FUZZ&password=FUZ2Z"
```

Dans cet exemple, nous envoyons une requ√™te POST √† l'URL `http://example.com/login.php` avec les donn√©es POST `username=FUZZ&password=FUZ2Z`. Les valeurs `FUZZ` et `FUZ2Z` seront remplac√©es par les √©l√©ments des listes `users.txt` et `passwords.txt`, respectivement.

Nous filtrons √©galement le code de r√©ponse `200` pour ne voir que les r√©ponses r√©ussies.

Notez que les fichiers `users.txt` et `passwords.txt` doivent √™tre dans le m√™me r√©pertoire que le fichier de commande wfuzz.
```bash
wfuzz.py -c -z file,users.txt -z file,pass.txt --sc 200 -d "name=FUZZ&password=FUZ2Z&autologin=1&enter=Sign+in" http://zipper.htb/zabbix/index.php
#Here we have filtered by code
```
#### **GET, 2 listes, filtre de cha√Æne (show), proxy, cookies**

Dans cette section, nous allons utiliser wfuzz pour envoyer des requ√™tes GET avec deux listes diff√©rentes et filtrer les r√©sultats en utilisant une cha√Æne sp√©cifique. Nous allons √©galement utiliser un proxy et des cookies pour simuler une session authentifi√©e.

La commande suivante envoie des requ√™tes GET √† l'URL sp√©cifi√©e en utilisant deux listes diff√©rentes pour les param√®tres "id" et "category". Nous filtrons ensuite les r√©sultats pour n'afficher que ceux qui contiennent la cha√Æne "admin".

```
wfuzz -c -z file,/path/to/ids.txt -z file,/path/to/categories.txt -u "http://example.com/product.php?id=FUZZ&category=FUZ2Z" --hl 0 --hc 404 -H "Cookie: session=123456" -x http://localhost:8080 -s "admin"
```

- `-c` : affiche les r√©sultats en couleur
- `-z file` : sp√©cifie que nous utilisons une liste de fichiers pour les valeurs de param√®tres
- `-u` : sp√©cifie l'URL cible avec les param√®tres FUZZ et FUZ2Z qui seront remplac√©s par les valeurs des listes
- `--hl 0` : d√©sactive l'affichage de la ligne d'en-t√™te
- `--hc 404` : ignore les r√©ponses avec un code d'√©tat 404
- `-H` : sp√©cifie les cookies de session
- `-x` : sp√©cifie le proxy √† utiliser
- `-s` : filtre les r√©sultats pour n'afficher que ceux qui contiennent la cha√Æne "admin"
```bash
wfuzz -c -w users.txt -w pass.txt --ss "Welcome " -p 127.0.0.1:8080:HTTP -b "PHPSESSIONID=1234567890abcdef;customcookie=hey" "http://example.com/index.php?username=FUZZ&password=FUZ2Z&action=sign+in"
```
### Bruteforce de r√©pertoires/Bruteforce RESTful

[Liste de mots de passe de param√®tres Arjun](https://raw.githubusercontent.com/s0md3v/Arjun/master/arjun/db/params.txt)
```
wfuzz -c -w /tmp/tmp/params.txt --hc 404 https://domain.com/api/FUZZ
```
### Brute-Force des Param√®tres de Chemin

Les param√®tres de chemin sont des variables qui font partie de l'URL et qui sont utilis√©es pour identifier une ressource sp√©cifique sur le serveur. Les attaquants peuvent utiliser des techniques de brute-force pour deviner les valeurs de ces param√®tres et acc√©der √† des ressources non autoris√©es.

Wfuzz peut √™tre utilis√© pour effectuer une attaque de brute-force sur les param√®tres de chemin en utilisant la syntaxe suivante :

```
wfuzz -c -z file,/path/to/wordlist.txt http://example.com/FUZZ
```

Dans cet exemple, Wfuzz va remplacer le mot-cl√© `FUZZ` par chaque mot du fichier de liste de mots sp√©cifi√© dans le chemin de l'URL. L'option `-c` est utilis√©e pour afficher les codes de r√©ponse HTTP pour chaque requ√™te.

Il est important de noter que l'utilisation de cette technique peut √™tre d√©tect√©e par les syst√®mes de d√©tection d'intrusion et peut entra√Æner un blocage de l'adresse IP de l'attaquant. Il est donc recommand√© d'utiliser des listes de mots sp√©cifiques √† la cible et de limiter le nombre de tentatives pour √©viter d'√™tre d√©tect√©.
```bash
wfuzz -c -w ~/git/Arjun/db/params.txt --hw 11 'http://example.com/path%3BFUZZ=FUZZ'
```
### Authentification d'en-t√™te

#### **Basique, 2 listes, cha√Æne de filtre (show), proxy**
```bash
wfuzz -c -w users.txt -w pass.txt -p 127.0.0.1:8080:HTTP --ss "Welcome" --basic FUZZ:FUZ2Z "http://example.com/index.php"
```
#### **NTLM, 2 listes, cha√Æne de filtre (show), proxy**

NTLM est un protocole d'authentification utilis√© par les syst√®mes d'exploitation Windows. Il est souvent utilis√© pour l'authentification des utilisateurs dans les environnements Active Directory. 

Lors de l'utilisation de WFuzz avec NTLM, il est possible d'utiliser deux listes de mots de passe diff√©rentes pour les tentatives d'authentification. Cela peut √™tre fait en utilisant l'option `--ntlm-file` pour sp√©cifier le chemin d'acc√®s √† la liste de mots de passe NTLM et l'option `--pw-list` pour sp√©cifier le chemin d'acc√®s √† la liste de mots de passe standard. 

Il est √©galement possible de filtrer les r√©sultats de WFuzz en utilisant une cha√Æne de filtre. Cela peut √™tre fait en utilisant l'option `--filter` suivie de la cha√Æne de filtre. Par exemple, `--filter='show="401"'` affichera uniquement les r√©sultats avec un code de r√©ponse 401. 

Enfin, si vous utilisez un proxy pour vous connecter √† la cible, vous pouvez sp√©cifier l'adresse du proxy en utilisant l'option `--proxy`. Par exemple, `--proxy=http://127.0.0.1:8080` sp√©cifiera un proxy sur le port 8080 de l'adresse IP 127.0.0.1.
```bash
wfuzz -c -w users.txt -w pass.txt -p 127.0.0.1:8080:HTTP --ss "Welcome" --ntlm 'domain\FUZZ:FUZ2Z' "http://example.com/index.php"
```
### Bruteforce de Cookie/Header (brute vhost)

#### **Cookie, code de filtre (afficher), proxy**
```bash
wfuzz -c -w users.txt -p 127.0.0.1:8080:HTTP --ss "Welcome " -H "Cookie:id=1312321&user=FUZZ"  "http://example.com/index.php"
```
#### **User-Agent, code de filtre (masquer), proxy**

Le header User-Agent est utilis√© pour identifier le client HTTP utilis√© pour effectuer une requ√™te. Il est souvent utilis√© pour diff√©rencier les requ√™tes provenant de navigateurs web et celles provenant d'outils automatis√©s tels que les scripts de fuzzing. Il est possible de modifier le User-Agent pour masquer l'outil utilis√© et √©viter d'√™tre d√©tect√©.

Il est √©galement possible de filtrer le code source de la r√©ponse pour masquer les erreurs et les informations sensibles. Cela peut √™tre fait en utilisant des outils tels que grep ou awk.

L'utilisation d'un proxy peut √©galement aider √† masquer l'adresse IP de l'attaquant et √† √©viter d'√™tre d√©tect√©. Les proxies peuvent √™tre configur√©s pour rediriger le trafic √† travers des serveurs distants, ce qui rend plus difficile la d√©tection de l'origine de la requ√™te.
```bash
wfuzz -c -w user-agents.txt -p 127.0.0.1:8080:HTTP --ss "Welcome " -H "User-Agent: FUZZ"  "http://example.com/index.php"
```
#### **H√¥te**
```bash
wfuzz -c -w /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-
top1million-20000.txt --hc 400,404,403 -H "Host: FUZZ.example.com" -u 
http://example.com -t 100
```
#### **Utilisation de fichier**

##### **Description**

Lorsque vous utilisez l'option `--hc` pour sp√©cifier le code de r√©ponse attendu, vous pouvez utiliser l'option `--hc-r` pour sp√©cifier une r√©ponse diff√©rente pour chaque m√©thode HTTP. Cela peut √™tre utile pour d√©tecter les m√©thodes HTTP autoris√©es sur une cible.

##### **Syntaxe**

```
wfuzz -c -z file,<http_methods_file> --hc <response_code> --hc-r <http_method>:<response_code> <url>
```

##### **Exemple**

```
wfuzz -c -z file,/usr/share/wfuzz/wordlist/http_methods.txt --hc 200 --hc-r PUT:403 http://example.com/FUZZ
```

Dans cet exemple, wfuzz utilise le fichier `http_methods.txt` pour bruteforcer les m√©thodes HTTP sur l'URL `http://example.com/FUZZ`. Si wfuzz re√ßoit une r√©ponse `200`, il consid√®re que la m√©thode HTTP est autoris√©e. Si wfuzz re√ßoit une r√©ponse `403` pour la m√©thode HTTP `PUT`, il consid√®re que la m√©thode HTTP `PUT` est interdite.
```bash
wfuzz -c -w methods.txt -p 127.0.0.1:8080:HTTP --sc 200 -X FUZZ "http://example.com/index.php"
```
#### **Utilisation de la liste en ligne**

---

The inline list is a very useful feature of wfuzz that allows you to specify a list of values for a parameter in a single line. This is particularly useful when you have a small list of values that you want to test.

La liste en ligne est une fonctionnalit√© tr√®s utile de wfuzz qui vous permet de sp√©cifier une liste de valeurs pour un param√®tre en une seule ligne. Cela est particuli√®rement utile lorsque vous avez une petite liste de valeurs que vous souhaitez tester.

---

To use the inline list, you simply need to specify the parameter name followed by the list of values enclosed in curly braces {} and separated by commas. For example, to test the parameter "id" with the values 1, 2, and 3, you would use the following syntax:

Pour utiliser la liste en ligne, vous devez simplement sp√©cifier le nom du param√®tre suivi de la liste de valeurs entre accolades {} et s√©par√©es par des virgules. Par exemple, pour tester le param√®tre "id" avec les valeurs 1, 2 et 3, vous utiliseriez la syntaxe suivante :

```
wfuzz -u http://example.com/index.php?id={1,2,3}
```

---

This will send requests to the URL http://example.com/index.php?id=1, http://example.com/index.php?id=2, and http://example.com/index.php?id=3.

Cela enverra des requ√™tes aux URL http://example.com/index.php?id=1, http://example.com/index.php?id=2 et http://example.com/index.php?id=3.
```bash
$ wfuzz -z list,GET-HEAD-POST-TRACE-OPTIONS -X FUZZ http://testphp.vulnweb.com/
```
### Bruteforce de r√©pertoires et de fichiers

---

#### WFuzz

WFuzz est un outil de bruteforce tr√®s puissant qui peut √™tre utilis√© pour tester la s√©curit√© des applications web. Il est capable de tester des r√©pertoires et des fichiers en utilisant des listes de mots personnalis√©es pour trouver des pages cach√©es ou des fichiers sensibles.

Pour utiliser WFuzz, vous devez sp√©cifier l'URL de la cible et la liste de mots √† utiliser pour la bruteforce. WFuzz peut √©galement √™tre utilis√© pour tester des param√®tres de requ√™te en utilisant des listes de valeurs personnalis√©es.

Voici un exemple de commande WFuzz pour tester les r√©pertoires et les fichiers sur une cible :

```
wfuzz -c -z file,/path/to/wordlist.txt --hc 404 http://target.com/FUZZ
```

Dans cet exemple, WFuzz utilise le fichier `/path/to/wordlist.txt` pour tester les r√©pertoires et les fichiers sur la cible `http://target.com/`. L'option `--hc 404` indique √† WFuzz d'ignorer les r√©ponses HTTP avec le code d'erreur 404.

WFuzz peut √©galement √™tre utilis√© pour tester les param√®tres de requ√™te en utilisant l'option `-d` pour sp√©cifier les donn√©es de requ√™te et l'option `-z` pour sp√©cifier les listes de valeurs √† tester.

#### DirBuster

DirBuster est un autre outil de bruteforce de r√©pertoires et de fichiers qui peut √™tre utilis√© pour tester la s√©curit√© des applications web. Il est capable de tester des r√©pertoires et des fichiers en utilisant des listes de mots personnalis√©es pour trouver des pages cach√©es ou des fichiers sensibles.

Pour utiliser DirBuster, vous devez sp√©cifier l'URL de la cible et la liste de mots √† utiliser pour la bruteforce. DirBuster peut √©galement √™tre utilis√© pour tester des param√®tres de requ√™te en utilisant des listes de valeurs personnalis√©es.

Voici un exemple de configuration DirBuster pour tester les r√©pertoires et les fichiers sur une cible :

![DirBuster Example](https://raw.githubusercontent.com/Hackplayers/hackplayers.github.io/master/_posts/dirbuster/dirbuster1.png)

Dans cet exemple, DirBuster utilise le fichier `/path/to/wordlist.txt` pour tester les r√©pertoires et les fichiers sur la cible `http://target.com/`. L'option `Follow Redirects` indique √† DirBuster de suivre les redirections HTTP.

DirBuster peut √©galement √™tre utilis√© pour tester les param√®tres de requ√™te en utilisant l'option `Injection String` pour sp√©cifier les listes de valeurs √† tester.
```bash
#Filter by whitelisting codes
wfuzz -c -z file,/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --sc 200,202,204,301,302,307,403 http://example.com/uploads/FUZZ
```
## Outil pour contourner les sites Web

[https://github.com/carlospolop/fuzzhttpbypass](https://github.com/carlospolop/fuzzhttpbypass)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
