<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks рдХреНрд▓рд╛рдЙрдб тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж рдЯреНрд╡рд┐рдЯрд░ ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П рдЯреНрд╡рд┐рдЪ ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе рдпреВрдЯреНрдпреВрдм ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣

- [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗред**

</details>


# рдкрд░рд┐рдЪрдп

рд╣рдордиреЗ [рдЧрд▓рдд рдврдВрдЧ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП JSON рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE](https://www.alphabot.com/security/blog/2017/net/How-to-configure-Json.NET-to-create-a-vulnerable-web-API.html) рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реА рдереА, рдЙрд╕рдХреЗ рдмрд╛рдж рд╣рдордиреЗ JSF рдЕрдорд▓рд╛рдиреБрд╕рд╛рд░ ViewStates рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд┐рдпрд╛ред [JavaServer Faces (JSF)](https://en.wikipedia.org/wiki/JavaServer_Faces) рдПрдХ рдпреВрдЬрд╝рд░ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ (UI) рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рд╣реИ рдЬреЛ рдкреБрдирд░реНрдпреЛрдЧреНрдп рдШрдЯрдХреЛрдВ рдХреЗ рд╕рд╛рде рд╡реЗрдм UI рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрддреА рд╣реИред JSF рдЕрдзрд┐рдХрд╛рдВрд╢ рдЙрджреНрдпреЛрдЧреА рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдПрдХ JSF рдЕрдорд▓рд╛рдиреБрд╕рд╛рд░рди рдХреЛ рдЖрдорддреМрд░ рдкрд░ рдЬрд╛рд╡рд╛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╕рд░реНрд╡рд░ рдЬреИрд╕реЗ JBoss EAP рдпрд╛ WebLogic рд╕рд░реНрд╡рд░ рдкрд░ рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред JSF рд╡рд┐рдирд┐рдордп рдХреЗ рджреЛ рдкреНрд░рд╕рд┐рджреНрдз рдЕрдорд▓рд╛рдиреБрд╕рд╛рд░рди рд╣реИрдВ:

* Oracle Mojarra (JSF рд╕рдВрджрд░реНрдн рдЕрдорд▓рд╛рдиреБрд╕рд╛рд░рди)
* Apache MyFaces

# рд╕реАрдорд╛

рдЗрд╕ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ рдореЗрдВ рд╣рдо рджреЛ JSF 2.x рдЕрдорд▓рд╛рдиреБрд╕рд╛рд░рди рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░реЗрдВрдЧреЗ: Oracle Mojarra (рд╕рдВрджрд░реНрдн рдЕрдорд▓рд╛рдиреБрд╕рд╛рд░рди) рдФрд░ Apache MyFacesред рдкреБрд░рд╛рдиреЗ рдЕрдорд▓рд╛рдиреБрд╕рд╛рд░рди (JSF 1.x) рдХреЛ рднреА рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рд╡рд░реНрдгрд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖реЛрдВ рдХрд╛ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛрдиреЗ рдХрд╛ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред (JSF 2.0.x рдХреЛ 2009 рдореЗрдВ рдкреНрд░рдердо рдмрд╛рд░ рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд╡рд░реНрддрдорд╛рди рд╕рдВрд╕реНрдХрд░рдг 2.3.x рд╣реИ)ред

# ViewState рдХреА рд╕реНрдерд┐рддрд┐

JSF рдФрд░ рд╕рдордХрдХреНрд╖ рд╡реЗрдм рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рдПрдХ рдЕрдВрддрд░ рд╣реИ рдХрд┐ JSF ViewStates (рд╕рддреНрд░реЛрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛) рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реНрдпреВ рдХреА рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдХреМрди рд╕реЗ рд╣рд┐рд╕реНрд╕реЗ рджрд┐рдЦрд╛рдП рдЬрд╛рдПрдВ) рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред ViewState рдХреЛ `рд╕рд░реНрд╡рд░` рдпрд╛ `рдЧреНрд░рд╛рд╣рдХ` рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред JSF ViewStates рдХреЛ рдЖрдорддреМрд░ рдкрд░ HTML рдлрд╝реЙрд░реНрдо рдореЗрдВ рдЫрд┐рдкреЗ рд╣реБрдП рдлрд╝реАрд▓реНрдб рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдирд╛рдо `javax.faces.ViewState` рд╣реЛрддрд╛ рд╣реИред рдпрджрд┐ рдлрд╝реЙрд░реНрдо рд╕рдмрдорд┐рдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╡реЗ рд╕рд░реНрд╡рд░ рдХреЛ рд╡рд╛рдкрд╕ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред

## рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб ViewState

рдпрджрд┐ JSF ViewState рдХреЛ `рд╕рд░реНрд╡рд░` рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЫрд┐рдкреЗ рд╣реБрдП `javax.faces.ViewState` рдлрд╝реАрд▓реНрдб рдореЗрдВ рдПрдХ рдЖрдИрдбреА рд╣реЛрддреА рд╣реИ рдЬреЛ рд╕рд░реНрд╡рд░ рдХреЛ рд╕рд╣реА рд╕реНрдерд┐рддрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИред MyFaces рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╡рд╣ рдЖрдИрдбреА рдПрдХ **рд╕рдВрдХрд▓рд┐рдд рдЬрд╛рд╡рд╛ рдСрдмреНрдЬреЗрдХреНрдЯ** рд╣реЛрддреА рд╣реИ!

## рдЧреНрд░рд╛рд╣рдХ-рд╕рд╛рдЗрдб ViewState

рдпрджрд┐ JSF ViewState рдХреЛ `рдЧреНрд░рд╛рд╣рдХ` рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЫрд┐рдкреЗ рд╣реБрдП `javax.faces.ViewState` рдлрд╝реАрд▓реНрдб рдореЗрдВ рдПрдХ **рд╕рдВрдХрд▓рд┐рдд рдЬрд╛рд╡рд╛ рдСрдмреНрдЬреЗрдХреНрдЯ** рд╣реЛрддреА рд╣реИ рдЬреЛ рдХрдо рд╕реЗ рдХрдо Base64 рдХреЛрдбрд┐рдВрдЧ рд╣реЛрддреА рд╣реИред рдЖрдкрдиреЗ рд╢рд╛рдпрдж рдЕрдм рддрдХ рдпрд╣ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдпрд╣ рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рдЖрдкрджрд╛ рдХрд╛ рдорд╛рд░реНрдЧ рд╣реИ! рд╢рд╛рдпрдж рдпрд╣реА рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдЖрдЬрдХрд▓ JSF ViewStates рдХреЛ рдЧреНрд░рд╛рд╣рдХ рдХреЛ рднреЗрдЬрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ
# ViewState рдкрд░ рд╣рдорд▓рд╛

рдЪрд▓реЛ рдорд╛рди рд▓реЗрддреЗ рд╣реИрдВ рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ JSF рдЖрдзрд╛рд░рд┐рдд рд▓реЙрдЧрд┐рди рдкреЗрдЬ рд╣реИ:

![JSF рдЖрдзрд╛рд░рд┐рдд рд▓реЙрдЧрд┐рди](https://www.alphabot.com/images/blog/jsf-viewstate/jsf-viewstate-login.png)

рдЙрд╕ рд▓реЙрдЧрд┐рди рдкреЗрдЬ рдореЗрдВ ViewState рд╣реИ рдЬреЛ рди рддреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╣реИ рдФрд░ рди рд╣реА рд╕рд╛рдЗрди рд╣реИред рдЗрд╕рд▓рд┐рдП рдЬрдм рд╣рдо рдЗрд╕рдХреЗ HTML рд╕реНрд░реЛрдд рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ рддреЛ рд╣рдореЗрдВ ViewState рдХреЛ рд╕рдореЗрдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрдХ рдЫрд┐рдкрд╛ рд╣реБрдЖ рдлрд╝реАрд▓реНрдб рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ: рдЕрдирдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб MyFaces ViewState:
```
<input type="hidden" name="javax.faces.ViewState" id="j_id__v_0:javax.faces.ViewState:1" value="rO0ABXVyABNbTGphdmEubGFuZy5PYmplY3Q7kM5YnxBzKWwCAAB4cAAAAAJwdAAML2xvZ2luLnhodG1s" autocomplete="off" />
```
рдпрджрд┐ рдЖрдк Base64 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдКрдкрд░ рджрд┐рдП рдЧрдП ViewState рдХреЛ рдбрд┐рдХреЛрдб рдХрд░реЗрдВ, рддреЛ рдЖрдк рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдЗрд╕рдореЗрдВ рдПрдХ рд╕реАрд░реАрдпрд▓рд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЬрд╛рд╡рд╛ рдСрдмреНрдЬреЗрдХреНрдЯ рд╣реИред рдЬрдм рдлрд╝реЙрд░реНрдо рд╕рдмрдорд┐рдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд▓реЙрдЧрд┐рди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ), рддреЛ рдпрд╣ ViewState POST рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд░реНрд╡рд░ рдХреЛ рд╡рд╛рдкрд╕ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЕрдм ViewState рдХреЛ рд╕рд░реНрд╡рд░ рдХреЛ рд╡рд╛рдкрд╕ POST рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╣реА рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рд╡рд┐рд╖рд╛рджреА ViewState рдХреЛ рдПрдЯреИрдХрд░ ViewState рдХреЗ рд╕рд╛рде рдмрджрд▓ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рд░реНрд╡рд░ рдХреЗ рдХреНрд▓рд╛рд╕рдкрде рдкрд░ рдореМрдЬреВрдж рд╣реЛрддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `InvokerTransformer` commons-collections-3.2.1.jar рд╕реЗ) рдпрд╛ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдЬрдирддрд╛ рдХреЗ рд▓рд┐рдП рдЕрднреА рддрдХ рдирд╣реАрдВ рдЬрд╛рдирд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдЧреИрдЬреЗрдЯред рдЗрд╕ рдЦрддрд░рдирд╛рдХ рдЧреИрдЬреЗрдЯ рдХреЛ ViewState рдореЗрдВ рд░рдЦрдХрд░ рд╣рдорд▓рд╛рд╡рд░ рд╕реНрдкрд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡рд╣ рдХрд┐рд╕ рдХрдорд╛рдВрдб рдХреЛ рд╕рд░реНрд╡рд░ рдкрд░ рдЪрд▓рд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИред рдПрдХ рдЕрдЯреИрдХрд░ рдХреА рдХреНрд╖рдорддрд╛ рдЙрдкрд▓рдмреНрдз рдЧреИрдЬреЗрдЯреНрд╕ рдХреА рдХреНрд▓рд╛рд╕рдкрде рдХреА рд╕реАрдорд╛ рджреНрд╡рд╛рд░рд╛ рд╕реАрдорд┐рдд рд╣реЛрддреА рд╣реИред `InvokerTransformer` рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ рд╕рд░реНрд╡рд░ рдкрд░ рдХреМрди рд╕реЗ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдХрдорд╛рдВрдб рдЪрд▓рд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рд╡рд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдиреЗ рд╣рдорд╛рд░реЗ рд▓рд┐рдирдХреНрд╕ рдЖрдзрд╛рд░рд┐рдд рд╕рд░реНрд╡рд░ рдХреЗ UI рдкрд░ рдХреИрд▓рдХреБрд▓реЗрдЯрд░ рд╢реБрд░реВ рдХрд░рдиреЗ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ред

рдЬрдм рдЕрдЯреИрдХрд░ рдиреЗ рдЕрдкрдиреЗ рд╕рдВрд╢реЛрдзрд┐рдд рдлрд╝реЙрд░реНрдо рдХреЛ рд╕рд░реНрд╡рд░ рдХреЛ рд╡рд╛рдкрд╕ рднреЗрдЬрд╛ рд╣реИ, рддреЛ JSF рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП ViewState рдХреЛ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред рдЕрдм рд╡рд┐рд╖рд╛рджреАрдХрд░рдг рдХреЗ рдкрд╣рд▓реЗ рд╣реА ViewState рдХреЗ рдЕрдВрдд рд╣реЛ рдЬрд╛рдиреЗ рдкрд░ рдХрдорд╛рдВрдб рдЪрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХреИрд▓рдХреБрд▓реЗрдЯрд░ рд╕рд░реНрд╡рд░ рдкрд░ рд╢реБрд░реВ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ:

![JSF ViewState рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╢реБрд░реВ рд╣реБрдЖ рдХреИрд▓рдХреБрд▓реЗрдЯрд░](https://www.alphabot.com/images/blog/jsf-viewstate/jsf-viewstate-started-calculator.png)

рдпрд╣ рд╕рдм рдХреБрдЫ JSF рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди ViewState рдХреЛ рджреЗрдЦрдиреЗ рдФрд░ рдпрд╣ рдирд┐рд░реНрдгрдп рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╣реЛ рдЧрдпрд╛ рдерд╛ рдХрд┐ рдпрд╣ рдЕрдЪреНрдЫрд╛ рдирд╣реАрдВ рдерд╛ред рдЬрдм ViewState рдХреЛ рдЕрдорд╛рдиреНрдп рдкрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдЖрдорддреМрд░ рдкрд░ рддреНрд░реБрдЯрд┐ рдХрд╛ рдЬрд╡рд╛рдм рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреИрд╕реЗ "рд╡реНрдпреВ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдИ рд╣реИ"ред рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА рдпрд╣ рдмрд╣реБрдд рджреЗрд░ рд╣реЛ рдЪреБрдХреА рдереАред рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪ рдорд┐рд▓ рдЧрдИ рдереА рдФрд░ рдХрдорд╛рдВрдб рдЪрд▓рд╛ рджреА рдЧрдИ рдереАред (рдЕрдзрд┐рдХрд╛рдВрд╢ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рджреБрдирд┐рдпрд╛ рдХреЗ рд╣рдорд▓рд╛рд╡рд░ рдХреИрд▓рдХреБрд▓реЗрдЯрд░ рд╢реБрд░реВ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡реЗ рдЖрдорддреМрд░ рдкрд░ рдПрдХ рд░рд┐рдореЛрдЯ рд╢реЗрд▓ рдбрд┐рдкреНрд▓реЙрдп рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕реЗ рд╡реЗ рдлрд┐рд░ рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред)

\=> рд╕рдордЧреНрд░ рд░реВрдк рд╕реЗ рдпрд╣ рдЙрджрд╛рд╣рд░рдг рдПрдХ рдмрд╣реБрдд рдЦрддрд░рдирд╛рдХ рдЧреИрд░ рдкреНрд░рдорд╛рдгреАрдХреГрдд рджреВрд░рд╕реНрде рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди (RCE) рд╕рдВрдХрдЯ рдХрд╛ рдПрдХ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рдЙрджрд╛рд╣рд░рдг рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред

(рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЪрд┐рддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЬреЗрдПрд╕рдПрдлрд╝ рдХреЗ рдЦрд┐рд▓рд╛рдл рд▓рдЧрднрдЧ рд╡рд╣реА рд╣рдорд▓рд╛ рдкрд░рд┐рджреГрд╢реНрдп рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ 2015 рдХреЗ рдкреНрд░рд╕реНрддреБрддрд┐ рдореЗрдВ рднреА рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ (рдкреГрд╖реНрда 65 рд╕реЗ 67 рддрдХ): [Marshalling Pickles](https://frohoff.github.io/appseccali-marshalling-pickles/) рдЬрд┐рд╕реЗ рдлреНрд░реЛрд╣реЛрдл рдФрд░ рд▓реЙрд░реЗрдВрд╕ рдиреЗ рдЖрдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдерд╛ред)

# рдПрдХ рд╕рдлрд▓ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡рд╛рдкреЗрдХреНрд╖рд╛рдПрдВ

рдЕрдм, рдПрдХ рдЖрдкрджрд╛ рдХреЗ рд▓рд┐рдП рдХреНрдпрд╛ рдШрдЯрдХ рд╣реИрдВ?

* рдЕрдирдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб ViewState (рдпрд╛, рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреБрдВрдЬреА рдХреЗ рд╕реНрд╡рд╛рдорд┐рддреНрд╡)
* рд╕рд░реНрд╡рд░ рдХреА рдХреНрд▓рд╛рд╕рдкрде рдкрд░ рдЧреИрдЬреЗрдЯ
* Mojarra рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ: ViewState рдХреЛ `client` рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛
* MyFaces рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ: ViewState рдХреЛ `client` **рдпрд╛** `server` рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛

рдЪрд▓рд┐рдП рджреЛрдиреЛрдВ JSF рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдиреЛрдВ рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рдЙрди рдмрд┐рдВрджреБрдУрдВ рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓реЗрдВред

# рдУрд░реЗрдХрд▓ рдореЛрдЬрд╛рд░рд╛ (JSF рд╕рдВрджрд░реНрдн рдЕрдорд▓реАрдп)

рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдХрд╣рд╛ рдЧрдпрд╛ рд╣реИ, рдУрд░реЗрдХрд▓ рдореЛрдЬрд╛рд░рд╛ JSF рд╕рдВрджрд░реНрдн рдЕрдорд▓реАрдп рд╣реИ рд▓реЗрдХрд┐рди рдЙрд╕ рдирд╛рдо рдХреЗ рддрд╣рдд рдЬрд╛рдирд╛ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕рди JSF RI рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣
## Mojarra: ViewState рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░ рд╕рдВрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ

Mojarra рдХреА рдбрд┐рдлрд╝реЙрд▓реНрдЯ `javax.faces.STATE_SAVING_METHOD` рд╕реЗрдЯрд┐рдВрдЧ `server` рд╣реИред рд╡рд┐рдХрд╛рд╕рдХ рдХреЛ рдЗрд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ `client` рдореЗрдВ рдмрджрд▓рдирд╛ рд╣реЛрдЧрд╛ рддрд╛рдХрд┐ Mojarra рдЙрдкрд░реЛрдХреНрдд рд╡рд┐рдзрд┐ рдХреЗ рд╣рдорд▓реЗ рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрдХреНрд░рдорд┐рдд рд╣реЛ рд╕рдХреЗред рдпрджрд┐ рд╕реАрд░реАрдпрд▓рд╛рдЗрдЬрд╝реНрдб ViewState рдХреЛ рд╕рд░реНрд╡рд░ рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди Mojarra `server` рд╕рд╛рдЗрдб ViewState рд╕реЗрд╡ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЙрд╕реЗ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ (рд╣рд╛рд▓рд╛рдВрдХрд┐, `StringIndexOutOfBoundsException` рд╣реЛ рд╕рдХрддреА рд╣реИ)ред

## Mojarra: рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп

Mojarra рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб ViewState рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рднреА рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред

Mojarra < 2.2 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдФрд░ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб ViewState рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рд╣реИрдВ:

* Mojarra рдХреЛ 2.0.11-04 рдпрд╛ 2.1.29-08 рдореЗрдВ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВред
* рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб ViewState рдХреА рдмрдЬрд╛рдп рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб ViewState рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ Mojarra рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдФрд░ рдЕрдкрдбреЗрдЯ рдпрд╛ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб ViewState рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рди рд╣реЛрдиреЗ рдкрд░: рдПрдХ рдЕрд╕реНрдерд╛рдпреА рд╕рдорд╛рдзрд╛рди рдХреЗ рд░реВрдк рдореЗрдВ ViewState рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдпрд╣ рд╕рд╣реА рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ (рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рдореЗрдВ рджрд┐рдпрд╛ рдЧрдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП)

рдмрд╛рдж рдХреЗ Mojarra рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП:

* рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ ViewState рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдЕрдХреНрд╖рдо рдирд╣реАрдВ рд╣реИ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ: `com.sun.faces.disableClientStateEncryption`

# Apache MyFaces

Apache MyFaces рдПрдХ рдФрд░ рдмрдбрд╝рд╛ рдФрд░ рд╡реНрдпрд╛рдкрдХрддрд╛ рд╕реЗ рдЙрдкрдпреЛрдЧ рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ JSF рдЕрдорд▓рд╛рдиреБрд╕рд╛рд░реА рд╣реИред

## MyFaces: рдЕрдирдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб ViewState

MyFaces рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ ViewState рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдЙрдирдХреЗ [рд╕реБрд░рдХреНрд╖рд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рдХрд┐ рдкреГрд╖реНрда](https://wiki.apache.org/myfaces/Secure_Your_Application) рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:

> рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЙрддреНрдкрд╛рджрди рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЗрд╕реЗ рдЕрдХреНрд╖рдо рдХрд░рдирд╛ рдХреЗрд╡рд▓ рдкрд░реАрдХреНрд╖рдг/рд╡рд┐рдХрд╛рд╕ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдорд╛рдиреНрдп рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкреИрд░рд╛рдореАрдЯрд░ `org.apache.myfaces.USE_ENCRYPTION` рдХреЛ `false` рдкрд░ рд╕реЗрдЯ рдХрд░рдХреЗ ViewState рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреЛ рдЕрдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред (рдпрд╣ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛрдЧрд╛ рд▓реЗрдХрд┐рди рдПрдХ рдЖрд╕рд╛рди рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реЛрдЧрд╛)ред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ MyFaces рд╣рд░ рд╕рд░реНрд╡рд░ рдкреБрдирд░рд╛рд░рдВрдн рдХреЗ рд╕рд╛рде ViewState рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рд╕реАрдХреНрд░реЗрдЯ рдХреЛ рдмрджрд▓рддрд╛ рд╣реИред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ MyFaces `DES` рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдФрд░ `HMAC-SHA1` рдХрд╛ рдЙрдкрдпреЛрдЧ ViewState рдХреА рдкреНрд░рдорд╛рдгрд┐рддрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред `AES` рдФрд░ `HMAC-SHA256` рдЬреИрд╕реЗ рдирд╡реАрдирддрдо рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛ рд╕рдВрднрд╡ рдФрд░ рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИред

## MyFaces: ViewState рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░ рд╕рдВрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ

MyFaces рдХреА рдбрд┐рдлрд╝реЙрд▓реНрдЯ `javax.faces.STATE_SAVING_METHOD` рд╕реЗрдЯрд┐рдВрдЧ `server` рд╣реИред рд▓реЗрдХрд┐рди: **MyFaces рд╣рдореЗрд╢рд╛ ViewState рдХреЛ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рддрд╛ рд╣реИ**, рдЪрд╛рд╣реЗ рдЙрд╕ рд╕реЗрдЯрд┐рдВрдЧ рдХреЗ рдмрд╛рд╡рдЬреВрджред рдЗрд╕рд▓рд┐рдП, [MyFaces рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреЛ рдЕрдХреНрд╖рдо рди рдХрд░реЗрдВ](https://issues.apache.org/jira/browse/MYFACES-4021) рдХрд╛ рдмрд╣реБрдд рдорд╣рддреНрд╡ рд╣реИ!

(рд╣рдордиреЗ MyFaces рдмрдЧ рдЯреНрд░реИрдХрд░ рдореЗрдВ рдПрдХ рдореБрджреНрджрд╛ рдмрдирд╛рдпрд╛ рд╣реИ: [MYFACES-4133 рд╕реНрдерд┐рддрд┐ рд╕рд╣реЗрдЬрдиреЗ рдХреА рд╡рд┐рдзрд┐ рд╕рд░реНрд╡рд░ рд╣реЛрдиреЗ рдкрд░ ViewState-ID рдХреЛ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рди рдХрд░реЗрдВ](https://issues.apache.org/jira/browse/MYFACES-4133), рд╢рд╛рдпрдж [рдЗрд╕ рдмрд╛рд░](https://issues.apache.org/jira/browse/MYFACES-4021) рд╕реБрд░рдХреНрд╖рд┐рдд рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреА рдЗрдЪреНрдЫрд╛ рдкреВрд░реА рд╣реЛ рдЬрд╛рдПрдЧреАред)

## MyFaces: рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп

MyFaces рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб ViewState рдХреА рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреЛ рдЕрдХреНрд╖рдо рди рдХрд░реЗрдВ (рджреНрд╡рд╛рд░рд╛ `org.apache.myfaces.USE_ENCRYPTION`) рдЪрд╛рд╣реЗ ViewState рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░ рд╕рдВрдЧреНрд░рд╣рд┐рдд рд╣реЛ рдпрд╛ рд╕рд░реНрд╡рд░ рдкрд░ред

## рдХрд╕реНрдЯрдо рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди

рдпрджрд┐ рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рдЖрдк рдкрд╛рд╕рд╡рд░реНрдб рдЪреЛрд░реА рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╡реЗрдм рд╕рд░реНрд╡рд░ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреЗрд▓реЛрдб рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рд╕рд╛рдЗрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```python
#!/usr/bin/python3
import sys
import hmac
from urllib import parse
from base64 import b64encode
from hashlib import sha1
from pyDes import *

YELLOW = "\033[93m"
GREEN = "\033[32m"

def encrypt(payload,key):
cipher = des(key, ECB, IV=None, pad=None, padmode=PAD_PKCS5)
enc_payload = cipher.encrypt(payload)
return enc_payload

def hmac_sig(enc_payload,key):
hmac_sig = hmac.new(key, enc_payload, sha1)
hmac_sig = hmac_sig.digest()
return hmac_sig

key = b'JsF9876-'

if len(sys.argv) != 3 :
print(YELLOW + "[!] Usage : {} [Payload File] [Output File]".format(sys.argv[0]))
else:
with open(sys.argv[1], "rb") as f:
payload = f.read()
f.close()
print(YELLOW + "[+] Encrypting payload")
print(YELLOW + "  [!] Key : JsF9876-\n")
enc_payload = encrypt(payload,key)
print(YELLOW + "[+] Creating HMAC signature")
hmac_sig = hmac_sig(enc_payload,key)
print(YELLOW + "[+] Appending signature to the encrypted payload\n")
payload = b64encode(enc_payload + hmac_sig)
payload = parse.quote_plus(payload)
print(YELLOW + "[*] Final payload : {}\n".format(payload))
with open(sys.argv[2], "w") as f:
f.write(payload)
f.close()
print(GREEN + "[*] Saved to : {}".format(sys.argv[2]))
```
# Badsecrets рдХреЗ рд╕рд╛рде рдЬреНрдЮрд╛рдд рдХреБрдВрдЬреА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛

![Badsecrets](https://github.com/blacklanternsecurity/badsecrets) рдПрдХ рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреА рд╡рд╛рд▓реА рдпрд╛ рдХрдордЬреЛрд░ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреА рд╕реВрдЪреА рдХреЗ рдЦрд┐рд▓рд╛рдл рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдЙрддреНрдкрд╛рджреЛрдВ рдХреЛ рджреЗрдЦрдХрд░ рдЬреНрдЮрд╛рдд рддрдХрдиреАрдХреА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреА рд╣реИред рдЗрд╕рдХрд╛ `Jsf_viewstate` рдореЙрдбреНрдпреВрд▓ Mojarra рдФрд░ MyFaces рджреЛрдиреЛрдВ рдкрд░ рдЬреНрдЮрд╛рдд рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдмрдирд╛рдП рдЧрдП рдЬрд╛рд╡рд╛ рд╕рд░реНрд╡рд░ рдлреЗрд╕ рд╡реНрдпреВрд╕реНрдЯреЗрдЯ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдпрд╛ рд╕рдВрдкреАрдбрд┐рдд рд╡реНрдпреВрд╕реНрдЯреЗрдЯреНрд╕ рдХрд╛ рднреАред

рдЗрд╕реЗ рд╕рдмрд╕реЗ рддреЗрдЬрд╝ рддрд░реАрдХреЗ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `cli.py` рдЙрджрд╛рд╣рд░рдг рдЙрдкрдХрд░рдг рдХреЗ рд╕рд╛рде рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░реВрдк рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```
pip install badsecrets
git clone https://github.com/blacklanternsecurity/badsecrets
cd badsecrets
python examples/cli.py Ly8gp+FZKt9XsaxT5gZu41DDxO74k029z88gNBOru2jXW0g1Og+RUPdf2d8hGNTiofkD1VvmQTZAfeV+5qijOoD+SPzw6K72Y1H0sxfx5mFcfFtmqX7iN6Gq0fwLM+9PKQz88f+e7KImJqG1cz5KYhcrgT87c5Ayl03wEHvWwktTq9TcBJc4f1VnNHXVZgALGqQuETU8hYwZ1VilDmQ7J4pZbv+pvPUvzk+/e2oNeybso6TXqUrbT2Mz3k7yfe92q3pRjdxRlGxmkO9bPqNOtETlLPE5dDiZYo1U9gr8BBQ=
```
![](https://user-images.githubusercontent.com/24899338/227623883-f760570d-796e-459d-87b0-b87ad33999ae.png)

рдпрджрд┐ рдпрд╣ рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рднреА рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо (Mojarra рдпрд╛ MyFaces), рдЙрдкрдпреЛрдЧ рдореЗрдВ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдПрд▓реНрдЧреЛрд░рд┐рджрдо, рдФрд░ рдХрдВрдкреНрд░реЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдЬреЛ рд╕рднреА рдЙрддреНрдкреАрдбрд╝рди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВред

рд╡реНрдпрд╛рдкрдХ рдорд╛рддреНрд░рд╛ рдореЗрдВ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, рд╕рдмрдбреЛрдореЗрди рдЧрдгрдирд╛ рдХреЗ рд╕рд╛рде, `badsecrets` [**BBOT**]() рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```
bbot -f subdomain-enum -m badsecrets -t evil.corp
```
![](https://user-images.githubusercontent.com/24899338/227626488-e45e99b2-0f6d-451e-8a43-7d6db75098de.png)


# рдЕрдВрддрд┐рдо рд╡рд┐рдЪрд╛рд░

рдЗрд╕ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ рдореЗрдВ рджрд┐рдП рдЧрдП рдЬреЗрдПрд╕рдПрдл рд╡реНрдпреВрд╕реНрдЯреЗрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХрд╛рдВрд╢ рддрдереНрдп рдФрд░ рдЙрдирдХреЗ рдЦрддрд░реЛрдВ рдХреЛ рдирдП рдирд╣реАрдВ рдХрд╣рд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдРрд╕реЗ рд╕рдВрдХреНрд╖реЗрдкрд┐рдд рддрд░реАрдХреЗ рдореЗрдВ рдХрднреА рдкреЗрд╢ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдпрд╣ рдПрдХ рдмрд╛рд░ рдлрд┐рд░ рд╕реЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рджрд┐рдЦрд╛рд╡рдЯреА рд░реВрдк рд╕реЗ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдмрджрд▓рд╛рд╡ рдЧрдВрднреАрд░ рд╕реБрд░рдХреНрд╖рд╛ рдЦрддрд░реЛрдВ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддреЗ рд╣реИрдВред

\=> рдПрдХ рд╕рдорд╕реНрдпрд╛ рдореЗрдВ рдпрд╣ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╕реБрд░рдХреНрд╖рд╛ рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдФрд░ рд╡рд┐рдХрд╛рд╕рдХрд░реНрддрд╛рдУрдВ рдХреЗ рдмреАрдЪ рдкрд░реНрдпрд╛рдкреНрдд рдЬреНрдЮрд╛рди рд╕рдВрдЪрд╛рд░ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЙрди рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдирд┐рд╢реНрдЪрд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдЦрддрд░рдирд╛рдХ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред

# рд╕рдВрджрд░реНрдн

* [https://www.alphabot.com/security/blog/2017/java/Misconfigured-JSF-ViewStates-can-lead-to-severe-RCE-vulnerabilities.html](https://www.alphabot.com/security/blog/2017/java/Misconfigured-JSF-ViewStates-can-lead-to-severe-RCE-vulnerabilities.html)
* [https://0xrick.github.io/hack-the-box/arkham/](https://0xrick.github.io/hack-the-box/arkham/)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ рдкреАрдбреАрдПрдлрд╝ рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд░рдЦрддреЗ рд╣реИрдВ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>
