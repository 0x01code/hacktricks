# HTTP/2 рдбрд╛рдЙрдирдЧреНрд░реЗрдбреНрд╕ рдореЗрдВ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╕реНрдордЧрд▓рд┐рдВрдЧ

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>

## рдореВрд▓

рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рдореБрдЦреНрдп рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ **рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА** **HTTP/2** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдмрд╛рдд рдХрд░реЗрдЧрд╛** рд▓реЗрдХрд┐рди рдлрд┐рд░ рд╡рд╣ рдЙрд╕ **рд╕рдВрдЪрд╛рд░** рдХреЛ **HTTP/1.1** рдореЗрдВ **рдкрд░рд┐рд╡рд░реНрддрд┐рдд** рдХрд░ рджреЗрдЧрд╛ред

![](<../../.gitbook/assets/image (636) (1).png>)

рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреА рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** **HTTP/2 рд╕рдВрдЪрд╛рд░** рдореЗрдВ рдЕрдирд╛рд╡рд╢реНрдпрдХ **рд╣реЗрдбрд░реНрд╕** рдХреЛ **рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛ рдЬрд┐рдиреНрд╣реЗрдВ рд╢рд╛рдпрдж рдкреНрд░реЙрдХреНрд╕реА рджреНрд╡рд╛рд░рд╛ **рдЬрд╛рдВрдЪрд╛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛**ред рд▓реЗрдХрд┐рди рдлрд┐рд░, рдЬрдм рд╡реЗ **HTTP/1.1 рд╕рдВрдЪрд╛рд░** рдореЗрдВ **рдЕрдВрдзрд╛рдзреБрдВрдз рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ**, **рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╕реНрдордЧрд▓рд┐рдВрдЧ рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред

## рдЙрджрд╛рд╣рд░рдг

### H2.CL Desync

HTTP/2 рд╡рд┐рдирд┐рд░реНрджреЗрд╢ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ **Content-Length рд╣реЗрдбрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рд▓реЗрдХрд┐рди рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред рдЗрд╕рд▓рд┐рдП, **рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА** **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рднреЗрдЬреА рдЧрдИ рд╕рднреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЕрдиреБрд░реЛрдз рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдиреЗрдЧрд╛**, рд▓реЗрдХрд┐рди рдлрд┐рд░, рдЬрдм **HTTP/1.1 рдореЗрдВ рдбрд╛рдЙрдирдЧреНрд░реЗрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**, рдпрд╣ **рд╣реЗрдбрд░** **рдЕрдиреБрд░реЛрдз рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛** рдФрд░ рдЗрд╕рд▓рд┐рдП, **рдмреИрдХ-рдПрдВрдб рдЕрдиреБрд░реЛрдз рдХреЛ 2 рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдиреЗрдЧрд╛** рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдиреАрдЪреЗ рдЪрд┐рддреНрд░ рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ:

![](<../../.gitbook/assets/image (639).png>)

### H2.TE Desync URL Token Hijack

HTTP/2 рд╡рд┐рдирд┐рд░реНрджреЗрд╢ рдпрд╣ рднреА рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ **рдХрд┐рд╕реА рднреА рд╕рдВрджреЗрд╢ рдореЗрдВ рдХрдиреЗрдХреНрд╢рди-рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╣реЗрдбрд░ рдлреАрд▓реНрдбреНрд╕ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП рдЬрд┐рдиреНрд╣реЗрдВ рд╡рд┐рдХреГрдд рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП... рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк рдЗрд╕ рдирд┐рдпрдо рдХрд╛ рдкрд╛рд▓рди рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИрдВ**ред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ AWS рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд░ рдкрд░ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЗрд╕рд▓рд┐рдП рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ Host рд╣реЗрдбрд░ рдХреЛ рдПрдХ рд╕рд░реНрд╡рд░ рдХреА рдУрд░ рдЗрдВрдЧрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЙрдиреНрд╣реЗрдВ рдЙрд╕ рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪрд╛рдПрдЧрд╛ред

![](<../../.gitbook/assets/image (631) (1).png>)

### H2.TE Desync Header Hijack

рдпрд╣ рд╡рд╣реА рддрдХрдиреАрдХ рд╣реИ рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ, рд▓реЗрдХрд┐рди рдЬреЗрдореНрд╕ рдиреЗ рджреЗрдЦрд╛ рдХрд┐ рдЧреНрд░рд╛рд╣рдХ рдЙрд╕реЗ рдЕрдкрдиреА рд╕рд╛рдЦ рдкреНрд░реЗрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣ рд░рд╣реЗ рдереЗ, рдЗрд╕рд▓рд┐рдП рдЙрд╕рдиреЗ рдмрд╕ рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рдХреЛ рд▓реЛрдЧреЛрдВ рдХреА рд╕рд╛рдЦ рдЙрд╕реЗ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП CORS рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛:

![](<../../.gitbook/assets/image (662) (1) (1) (1) (1) (1).png>)

### H2.TE via Request Header Injection

**HTTP/2 рд╣реЗрдбрд░реНрд╕ рдореЗрдВ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджрд┐рдП рдЧрдП рдЕрдХреНрд╖рд░реЛрдВ рдХреЛ рдбрд╛рд▓рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрдЧрд╛**, рд▓реЗрдХрд┐рди рдпрджрд┐ рд╕рд░реНрд╡рд░ **рдЗрд╕ рдирд┐рдпрдо рдХрд╛ рд╕рдореНрдорд╛рди рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИ**, рддреЛ рдЖрдк **рдордирдорд╛рдиреЗ рд╣реЗрдбрд░реНрд╕ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬрдм рд╕рдВрдЪрд╛рд░ рдХреЛ **HTTP/1.1 рдореЗрдВ рдбрд╛рдЙрдирдЧреНрд░реЗрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ **рд╣реЗрдбрд░ Transfer-Encoding рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛**ред

![](<../../.gitbook/assets/image (648) (1) (1) (1) (1) (1).png>)

### H2.TE via Header Name Injection

рдХреБрдЫ рд╕рд░реНрд╡рд░реЛрдВ рдкрд░ HTTP/2 рдЖрдкрдХреЛ рд╣реЗрдбрд░ рдирд╛рдо рдореЗрдВ **рдХреЛрд▓рди рдбрд╛рд▓рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдФрд░ рдПрдХ** рдХреЗ рд╕рд╛рде рдЖрдк рд╣реЗрдбрд░ рдирд╛рдо рдХреЗ рдЕрдВрджрд░ рдПрдХ рдирдпрд╛ рд╣реЗрдбрд░ рдЗрд╕ рддрд░рд╣ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

![](<../../.gitbook/assets/image (632) (1).png>)

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рд╕рд┐рд░реНрдл рдирдИ рд▓рд╛рдЗрди рдЕрдХреНрд╖рд░ рднреЗрдЬрддреЗ рд╣реИрдВ рдПрдХ рд╣реЗрдбрд░ рдХреЗ рдмрд┐рдирд╛ рд╕рд╛рдордЧреНрд░реА рдХреЗ, рдЕрдиреБрд░реЛрдз рдХреЛ **рдЕрдорд╛рдиреНрдп** рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдирд╛ рдЬрд╛рдПрдЧрд╛:

![](<../../.gitbook/assets/image (647) (1) (1) (1).png>)

### H2.TE via Request Line Injection

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрд╢рди рдЕрдиреБрд░реЛрдз рд▓рд╛рдЗрди рдХреЗ рдЕрдВрджрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛:

![](<../../.gitbook/assets/image (640) (1).png>)

### URL Prefix Injection

HTTP/2 рдХрдиреЗрдХреНрд╢рди рдХреА рд╕реНрдХреАрдо рдХреЗ рдЕрдВрджрд░ рдЖрдк рдПрдХ рдкреВрд░рд╛ URL рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдкрде рдореЗрдВ рдЗрдВрдЧрд┐рдд рдХрд┐рдП рдЧрдП URL рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рджреЗрдЧрд╛:

![](<../../.gitbook/assets/image (661) (1) (1).png>)

### Request Line Injection via spaces

![](<../../.gitbook/assets/image (641) (1).png>)

## Frontend->backend connection reuse

рдХрднреА-рдХрднреА рдЖрдк рдкрд╛рдПрдВрдЧреЗ рдХрд┐ HTTP Request Smuggling рд╣рдорд▓рд╛ рдХрд░рддреЗ рд╕рдордп **рдЖрдк рдХреЗрд╡рд▓ рдЕрдкрдиреЗ рдЖрдк рдкрд░ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА рдиреЗ рдкреНрд░рддрд┐ IP рдмреИрдХ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде **рдПрдХ рдЕрд▓рдЧ рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ рд╣реИ**ред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдпрд╣рд╛рдВ рддрдХ рдХрд┐** рдЙрд╕ **рдкреНрд░рддрд┐рдмрдВрдз** рдХреЗ рд╕рд╛рде рднреА рдЖрдк **рдЕрдзрд┐рдХреГрддрддрд╛ рдмрд╛рдпрдкрд╛рд╕**, рдЖрдВрддрд░рд┐рдХ рд╣реЗрдбрд░реНрд╕ рдХреА рд▓реАрдХреЗрдЬ рдФрд░ **рдХреИрд╢ рдбрд┐рд╕реЗрдкреНрд╢рди рдФрд░ рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ** рд╣рдорд▓реЗ рдЬреИрд╕реЗ рд╣рдорд▓реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдорддреМрд░ рдкрд░ рдпрд╣ рдкреНрд░рддрд┐рдмрдВрдз рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ рдЗрд╕рд▓рд┐рдП рдЖрдк **рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА рдФрд░ рдмреИрдХ рдПрдВрдб рдХреЗ рдмреАрдЪ рдХрдиреЗрдХреНрд╢рди рдореЗрдВ рдЕрдиреБрд░реЛрдз рдХреЛ рд╕реНрдордЧрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдиреНрдп рд▓реЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рднреА **рд╕рдВрднрд╡** рд╣реИ рдХрд┐ **рдкреНрд░реЙрдХреНрд╕реА** рдПрдХ рд╣реА IP рд╕реЗ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд╕рд╛рде рднреА **рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдкреБрди: рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ** (рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдлреА рдХрдареЛрд░ рдкреНрд░рддрд┐рдмрдВрдз)ред

![](<../../.gitbook/assets/image (646) (1) (1).png>)

рд╕рдмрд╕реЗ рдХрдареЛрд░ рдкреНрд░рддрд┐рдмрдВрдз (рдХреЛрдИ рдХрдиреЗрдХреНрд╢рди рдкреБрди: рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ) рдореЗрдВ рдЖрдк рд╕рдордп рдЖрдзрд╛рд░рд┐рдд рддрдХрдиреАрдХ рдХреЗ рд╕рд╛рде рднреЗрджреНрдпрддрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдлрд┐рд░ рдЗрд╕реЗ рдкрд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╕рдордп рдЖрдк рдкрд╛рдПрдВрдЧреЗ рдХрд┐ рдпрд╣ рдПрдХ "рдЧрд▓рдд рд╕рдХрд╛рд░рд╛рддреНрдордХ" рд╣реИред

### Tunnelling Confirmation

рдпрджрд┐ **рдПрдВрдбрдкреЙрдЗрдВрдЯ рднреЗрджреНрдп рд╣реИ** рд▓реЗрдХрд┐рди рдХрдиреЗрдХреНрд╢рди **"рдЯрдирд▓" рдХреЗ рдЕрдВрджрд░ рд╣реИ** рдЗрд╕рдХреА **рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ** рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ 1 рдореЗрдВ **2 рдкреВрд░реНрдг рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╕реНрдордЧрд▓ рдХрд░рдирд╛** рд╣реИред

**HTTP/1.1** рдХреА **рд╕рдорд╕реНрдпрд╛** рдпрд╣ рд╣реИ рдХрд┐ рдпрджрд┐ рдЖрдк **2 HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ** рддреЛ рдЖрдк **рдирд╣реАрдВ рдЬрд╛рдирддреЗ** рдХрд┐ рдПрдВрдбрдкреЙрдЗрдВрдЯ **рднреЗрджреНрдп рдерд╛** рдпрд╛ рдирд╣реАрдВ рдФрд░ **"рд╕реНрдордЧрд▓" рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЕрдиреБрд░реЛрдз рд╕рд┐рд░реНрдл рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЕрдиреБрд░реЛрдз рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдирд╛ рдЧрдпрд╛ рдерд╛**ред

рд╣рд╛рд▓
