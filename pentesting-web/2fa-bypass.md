# 2FA/OTP Bypass

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>でAWSハッキングをゼロからヒーローまで学ぶ</strong></a><strong>！</strong></summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝したい**または **HackTricks をPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスウォッグ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)を入手する
* \*\*💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)をフォローする。
* **HackTricks**と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出して、あなたのハッキングテクニックを共有してください。

</details>

## **強化された二要素認証バイパステクニック**

### **直接エンドポイントアクセス**

2FAをバイパスするために、パスを知っていることが重要なため、直接次のエンドポイントにアクセスします。失敗した場合は、**Referrerヘッダー**を変更して、2FA確認ページからのナビゲーションを模倣します。

### **トークンの再利用**

以前に使用したトークンを再利用してアカウント内で認証することが効果的です。

### **未使用トークンの利用**

自分のアカウントからトークンを抽出して、別のアカウントで2FAをバイパスする試みができます。

### **トークンの露出**

Webアプリケーションからの応答でトークンが開示されているかどうかを調査します。

### **検証リンクの悪用**

アカウント作成時に送信された**メール検証リンク**を使用すると、2FAなしでプロファイルにアクセスできる場合があります。詳細は[ポスト](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b)で説明されています。

### **セッション操作**

ユーザーと被害者のアカウントのセッションを開始し、ユーザーのアカウントの2FAを完了せずに次のステップにアクセスしようとすることで、バックエンドセッション管理の制限を突破しようとします。

### **パスワードリセットメカニズム**

パスワードリセット機能を調査し、同じリンクを使用して複数のリセットを許可する可能性があるかどうかを確認します。新しくリセットされた資格情報でログインすることで、2FAをバイパスできるかもしれません。

### **OAuthプラットフォームの侵害**

信頼された**OAuth**プラットフォーム（例：Google、Facebook）でユーザーアカウントを侵害することで、2FAをバイパスする経路が提供される可能性があります。

### **ブルートフォース攻撃**

#### **レート制限の不在**

コード試行回数の制限がない場合、ブルートフォース攻撃が可能ですが、潜在的なサイレントレート制限を考慮する必要があります。

#### **遅いブルートフォース**

全体的なレート制限が存在する場合でも、遅いブルートフォース攻撃が有効です。

#### **コード再送信リミットリセット**

コードを再送信すると、レート制限がリセットされ、継続的なブルートフォース試行が容易になります。

#### **クライアントサイドのレート制限回避**

文書には、クライアントサイドのレート制限をバイパスするためのテクニックが詳細に記載されています。

#### **内部アクションのレート制限の不在**

ログイン試行を保護するレート制限があるかもしれませんが、内部アカウントアクションにはレート制限がない場合があります。

#### **SMSコード再送信コスト**

SMS経由でコードを過剰に再送信すると、企業にコストがかかりますが、2FAをバイパスすることはできません。

#### **無限OTP再生成**

簡単なコードで無限のOTP生成が可能であり、少数のコードを繰り返し試行することでブルートフォースが可能です。

### **レースコンディションの悪用**

2FAバイパスのためのレースコンディションの悪用は、特定の文書に見つかる可能性があります。

### **CSRF/Clickjackingの脆弱性**

2FAを無効にするためにCSRFまたはClickjackingの脆弱性を探索することは、有効な戦略です。

### **"Remember Me"機能の悪用**

#### **予測可能なCookie値**

"remember me" cookie値を推測することで制限をバイパスできる可能性があります。

#### **IPアドレスなりすまし**

**X-Forwarded-For**ヘッダーを介して被害者のIPアドレスをなりすますことで、制限をバイパスできる可能性があります。

### **古いバージョンの利用**

#### **サブドメイン**

古い2FAサポートがない古いバージョンを使用するか、脆弱な2FA実装を含むサブドメインをテストすることができます。

#### **APIエンドポイント**

/v\*ディレクトリパスで示される古いAPIバージョンは、2FAバイパス方法に脆弱である可能性があります。

### **以前のセッションの処理**

2FAの有効化時に既存のセッションを終了することで、侵害されたセッションからの未承認アクセスを防ぎます。

### **バックアップコードのアクセス制御の欠陥**

2FAの有効化時にバックアップコードを即座に生成し、潜在的な不正な取得を行うことは、CORSの誤構成/XSSの脆弱性を特に考慮するとリスクがあります。

### **2FAページでの情報開示**

2FA確認ページでの機密情報開示（電話番号など）は懸念事項です。

### **パスワードリセットによる2FAの無効化**

アカウント作成、2FAの有効化、パスワードリセット、および2FA要件なしでの後続ログインを含む潜在的なバイパス方法を示すプロセスがあります。

### **デコイリクエスト**

デコイリクエストを利用してブルートフォース試行を曖昧にしたり、レート制限メカニズムを誤誘導したりすることで、バイパス戦略に別のレイヤーを追加できます。このようなリクエストを作成するには、アプリケーションのセキュリティ対策とレート制限の動作について繊細な理解が必要です。

## 参考文献

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/jp/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>でAWSハッキングをゼロからヒーローまで学ぶ</strong></a><strong>！</strong></summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝したい**または **HackTricks をPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスウォッグ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)を入手する
* \*\*💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)をフォローする。
* **HackTricks**と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出して、あなたのハッキングテクニックを共有してください。

</details>
