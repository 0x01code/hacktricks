# 2FA/OTP Bypass

<details>

<summary><strong>从零开始学习AWS黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS红队专家）</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想看到您的**公司在HackTricks中被广告**或**下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS & HackTricks周边产品**](https://peass.creator-spring.com)
* 探索[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord群**](https://discord.gg/hRep4RUj7f) 或 [**电报群**](https://t.me/peass) 或 **关注**我们的**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**。**
* 通过向[**HackTricks**](https://github.com/carlospolop/hacktricks)和[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>

## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) 是一个由**暗网**支持的搜索引擎，提供免费功能，用于检查公司或其客户是否受到**窃取恶意软件**的**侵害**。

WhiteIntel的主要目标是打击由信息窃取恶意软件导致的账户劫持和勒索软件攻击。

您可以访问他们的网站并免费尝试他们的引擎：

{% embed url="https://whiteintel.io" %}

---

## **增强型两步验证绕过技术**

### **直接访问端点**

要绕过两步验证，直接访问后续端点，了解路径至关重要。如果不成功，修改**引用者标头**以模拟从两步验证页面导航。

### **令牌重用**

在账户内重复使用先前使用过的令牌进行身份验证可能是有效的。

### **利用未使用的令牌**

尝试从自己的账户中提取令牌以绕过另一个账户的两步验证。

### **令牌暴露**

调查令牌是否在Web应用程序的响应中披露。

### **验证链接利用**

使用在账户创建时发送的**电子邮件验证链接**可以允许在没有两步验证的情况下访问个人资料，如详细[帖子](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b)中所述。

### **会话操纵**

为用户和受害者的账户启动会话，并为用户的账户完成两步验证而不继续，允许尝试访问受害者账户流程的下一步，利用后端会话管理限制。

### **密码重置机制**

调查密码重置功能，该功能在重置后将用户登录到应用程序，以确定其是否允许使用相同链接进行多次重置至关重要。使用新重置的凭据登录可能会绕过两步验证。

### **OAuth平台被入侵**

入侵用户在受信任的**OAuth**平台（例如Google、Facebook）上的账户可以提供绕过两步验证的途径。

### **暴力破解攻击**

#### **速率限制缺失**

代码尝试次数没有限制会导致暴力破解攻击，尽管应考虑潜在的静默速率限制。

#### **慢速暴力破解**

在存在流速限制但没有全局速率限制的情况下，慢速暴力破解攻击是可行的。

#### **代码重新发送限制重置**

重新发送代码会重置速率限制，促进持续的暴力破解尝试。

#### **客户端速率限制规避**

一份文件详细介绍了绕过客户端速率限制的技术。

#### **内部操作缺乏速率限制**

速率限制可能保护登录尝试，但不保护内部账户操作。

#### **短信代码重新发送成本**

通过短信大量重新发送代码会给公司带来成本，尽管不会绕过两步验证。

#### **无限OTP生成**

使用简单代码进行无限OTP生成允许通过重试一小组代码进行暴力破解。

### **竞争条件利用**

利用竞争条件进行两步验证绕过可以在特定文件中找到。

### **CSRF/点击劫持漏洞**

探索CSRF或点击劫持漏洞以禁用两步验证是一种可行的策略。

### **“记住我”功能利用**

#### **可预测的Cookie值**

猜测“记住我”Cookie值可以绕过限制。

#### **IP地址冒充**

通过**X-Forwarded-For**标头冒充受害者的IP地址可以绕过限制。

### **利用旧版本**

#### **子域**

测试子域可能使用不支持两步验证的过时版本或包含易受攻击的两步验证实现。

#### **API端点**

旧的API版本，通过/v\*目录路径指示，可能容易受到两步验证绕过方法的攻击。

### **处理先前会话**

在两步验证激活时终止现有会话可保护账户免受来自受损会话的未经授权访问。

### **带有备用代码的访问控制缺陷**

在两步验证激活后立即生成备用代码并潜在地未经授权地检索备用代码，尤其是在CORS配置错误/XSS漏洞的情况下，存在风险。

### **2FA页面上的信息泄露**

在2FA验证页面上泄露敏感信息（例如电话号码）是一个问题。

### **密码重置禁用2FA**

一个演示潜在绕过方法的过程涉及账户创建、2FA激活、密码重置和随后登录而无需2FA要求。

### **诱饵请求**

利用诱饵请求来混淆暴力破解尝试或误导速率限制机制为绕过策略增加了另一层。制作这样的请求需要对应用程序的安全措施和速率限制行为有细致的理解。

## 参考资料

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)


## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) 是一个由**暗网**支持的搜索引擎，提供免费功能，用于检查公司或其客户是否受到**窃取恶意软件**的**侵害**。

WhiteIntel的主要目标是打击由信息窃取恶意软件导致的账户劫持和勒索软件攻击。

您可以访问他们的网站并免费尝试他们的引擎：

{% embed url="https://whiteintel.io" %}
