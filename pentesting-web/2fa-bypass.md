# 2FA/OTP Bypass

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) ist eine **dark-web**-gest√ºtzte Suchmaschine, die **kostenlose** Funktionen bietet, um zu √ºberpr√ºfen, ob ein Unternehmen oder dessen Kunden **kompromittiert** wurden durch **Stealer-Malware**.

Das Hauptziel von WhiteIntel ist es, Konto√ºbernahmen und Ransomware-Angriffe zu bek√§mpfen, die aus informationsstehlender Malware resultieren.

Du kannst ihre Website besuchen und ihre Engine **kostenlos** ausprobieren unter:

{% embed url="https://whiteintel.io" %}

***

## **Erweiterte Techniken zum Umgehen der Zwei-Faktor-Authentifizierung**

### **Direkter Zugriff auf Endpunkte**

Um 2FA zu umgehen, greife direkt auf den nachfolgenden Endpunkt zu, wobei der Pfad entscheidend ist. Wenn dies nicht erfolgreich ist, √§ndere den **Referrer-Header**, um die Navigation von der 2FA-√úberpr√ºfungsseite zu imitieren.

### **Token-Wiederverwendung**

Die Wiederverwendung zuvor verwendeter Tokens zur Authentifizierung innerhalb eines Kontos kann effektiv sein.

### **Nutzung ungenutzter Tokens**

Das Extrahieren eines Tokens aus dem eigenen Konto, um 2FA in einem anderen Konto zu umgehen, kann versucht werden.

### **Offenlegung des Tokens**

Untersuche, ob das Token in einer Antwort der Webanwendung offengelegt wird.

### **Ausnutzung des Best√§tigungslinks**

Die Verwendung des **E-Mail-Best√§tigungslinks, der bei der Kontoerstellung gesendet wird**, kann den Zugriff auf das Profil ohne 2FA erm√∂glichen, wie in einem detaillierten [Beitrag](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b) hervorgehoben.

### **Sitzungsmanipulation**

Das Initiieren von Sitzungen sowohl f√ºr das Benutzer- als auch f√ºr das Opferkonto und das Abschlie√üen der 2FA f√ºr das Benutzerkonto, ohne fortzufahren, erm√∂glicht den Versuch, auf den n√§chsten Schritt im Fluss des Opferkontos zuzugreifen, indem die Einschr√§nkungen des Backend-Sitzungsmanagements ausgenutzt werden.

### **Passwortzur√ºcksetzmechanismus**

Die Untersuchung der Passwortzur√ºcksetzfunktion, die einen Benutzer nach dem Zur√ºcksetzen in die Anwendung einloggt, ist entscheidend, um festzustellen, ob mehrere Zur√ºcksetzungen mit demselben Link m√∂glich sind. Das Einloggen mit den neu zur√ºckgesetzten Anmeldedaten k√∂nnte 2FA umgehen.

### **Kompromittierung der OAuth-Plattform**

Die Kompromittierung eines Benutzerkontos auf einer vertrauensw√ºrdigen **OAuth**-Plattform (z. B. Google, Facebook) kann einen Weg bieten, 2FA zu umgehen.

### **Brute-Force-Angriffe**

#### **Fehlende Ratenbegrenzung**

Das Fehlen einer Begrenzung der Anzahl der Codeversuche erm√∂glicht Brute-Force-Angriffe, obwohl potenzielle stille Ratenbegrenzungen ber√ºcksichtigt werden sollten.

#### **Langsame Brute-Force**

Ein langsamer Brute-Force-Angriff ist m√∂glich, wenn Flussratenbegrenzungen existieren, ohne dass eine √ºbergeordnete Ratenbegrenzung besteht.

#### **Zur√ºcksetzen der Code-Resend-Grenze**

Das Zur√ºcksetzen des Codes setzt die Ratenbegrenzung zur√ºck und erleichtert fortgesetzte Brute-Force-Versuche.

#### **Umgehung der clientseitigen Ratenbegrenzung**

Ein Dokument beschreibt Techniken zur Umgehung der clientseitigen Ratenbegrenzung.

#### **Interne Aktionen ohne Ratenbegrenzung**

Ratenbegrenzungen k√∂nnen Login-Versuche sch√ºtzen, jedoch nicht interne Kontenaktionen.

#### **Kosten f√ºr SMS-Code-Resend**

√úberm√§√üiges Zur√ºcksetzen von Codes per SMS verursacht Kosten f√ºr das Unternehmen, umgeht jedoch nicht 2FA.

#### **Unendliche OTP-Regeneration**

Endlose OTP-Generierung mit einfachen Codes erm√∂glicht Brute-Force durch das Wiederholen einer kleinen Menge von Codes.

### **Ausnutzung von Race Conditions**

Die Ausnutzung von Race Conditions zum Umgehen von 2FA kann in einem spezifischen Dokument gefunden werden.

### **CSRF/Clickjacking-Schwachstellen**

Die Untersuchung von CSRF- oder Clickjacking-Schwachstellen zur Deaktivierung von 2FA ist eine praktikable Strategie.

### **Ausnutzung der "Erinnere mich"-Funktion**

#### **Vorhersehbare Cookie-Werte**

Das Erraten des Wertes des "Erinnere mich"-Cookies kann Einschr√§nkungen umgehen.

#### **IP-Adressensimulation**

Die Simulation der IP-Adresse des Opfers √ºber den **X-Forwarded-For**-Header kann Einschr√§nkungen umgehen.

### **Nutzung √§lterer Versionen**

#### **Subdomains**

Das Testen von Subdomains kann veraltete Versionen verwenden, die keine 2FA-Unterst√ºtzung bieten oder anf√§llige 2FA-Implementierungen enthalten.

#### **API-Endpunkte**

√Ñltere API-Versionen, die durch /v\*/-Verzeichnispfade angezeigt werden, k√∂nnen anf√§llig f√ºr Methoden zum Umgehen von 2FA sein.

### **Umgang mit vorherigen Sitzungen**

Das Beenden bestehender Sitzungen bei Aktivierung von 2FA sichert Konten gegen unbefugten Zugriff aus kompromittierten Sitzungen.

### **Zugriffskontrollfehler mit Backup-Codes**

Die sofortige Generierung und potenzielle unbefugte Abholung von Backup-Codes bei Aktivierung von 2FA, insbesondere bei CORS-Fehlkonfigurationen/XSS-Schwachstellen, stellt ein Risiko dar.

### **Offenlegung von Informationen auf der 2FA-Seite**

Die Offenlegung sensibler Informationen (z. B. Telefonnummer) auf der 2FA-√úberpr√ºfungsseite ist ein Anliegen.

### **Passwortzur√ºcksetzung, die 2FA deaktiviert**

Ein Prozess, der eine potenzielle Umgehungsmethode demonstriert, umfasst die Kontoerstellung, Aktivierung von 2FA, Passwortzur√ºcksetzung und anschlie√üendes Einloggen ohne die 2FA-Anforderung.

### **T√§uschungsanfragen**

Die Nutzung von T√§uschungsanfragen zur Verschleierung von Brute-Force-Versuchen oder zur Irref√ºhrung von Ratenbegrenzungsmechanismen f√ºgt eine weitere Ebene zu Umgehungsstrategien hinzu. Das Erstellen solcher Anfragen erfordert ein nuanciertes Verst√§ndnis der Sicherheitsma√ünahmen und Ratenbegrenzungsverhalten der Anwendung.

## Referenzen

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) ist eine **dark-web**-gest√ºtzte Suchmaschine, die **kostenlose** Funktionen bietet, um zu √ºberpr√ºfen, ob ein Unternehmen oder dessen Kunden **kompromittiert** wurden durch **Stealer-Malware**.

Das Hauptziel von WhiteIntel ist es, Konto√ºbernahmen und Ransomware-Angriffe zu bek√§mpfen, die aus informationsstehlender Malware resultieren.

Du kannst ihre Website besuchen und ihre Engine **kostenlos** ausprobieren unter:

{% embed url="https://whiteintel.io" %}

P

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}
