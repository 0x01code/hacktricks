# 2FA/OTP Umgehung

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) ist eine von **Dark Web** angetriebene Suchmaschine, die **kostenlose** Funktionen bietet, um zu √ºberpr√ºfen, ob ein Unternehmen oder seine Kunden von **Stealer-Malware** **kompromittiert** wurden.

Das Hauptziel von WhiteIntel ist es, Konto√ºbernahmen und Ransomware-Angriffe aufgrund von informationsstehlender Malware zu bek√§mpfen.

Sie k√∂nnen ihre Website besuchen und ihre Engine **kostenlos** ausprobieren unter:

{% embed url="https://whiteintel.io" %}

---

## **Erweiterte Techniken zur Umgehung der Zwei-Faktor-Authentifizierung**

### **Direkter Endpunktzugriff**

Um die 2FA zu umgehen, ist der direkte Zugriff auf den nachfolgenden Endpunkt entscheidend. Wenn dies nicht erfolgreich ist, √§ndern Sie den **Referrer-Header**, um die Navigation von der 2FA-Verifizierungsseite zu imitieren.

### **Token-Wiederverwendung**

Die Wiederverwendung zuvor verwendeter Tokens zur Authentifizierung in einem Konto kann effektiv sein.

### **Verwendung ungenutzter Tokens**

Es kann versucht werden, einen Token aus dem eigenen Konto zu extrahieren, um die 2FA in einem anderen Konto zu umgehen.

### **Offenlegung des Tokens**

Untersuchen Sie, ob der Token in einer Antwort der Webanwendung offengelegt wird.

### **Ausnutzung des Verifizierungslinks**

Die Verwendung des **E-Mail-Verifizierungslinks, der bei der Kontoerstellung gesendet wird**, kann den Profilzugriff ohne 2FA erm√∂glichen, wie in einem detaillierten [Beitrag](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b) hervorgehoben.

### **Sitzungsmanipulation**

Das Initiieren von Sitzungen f√ºr das Konto des Benutzers und das Konto eines Opfers sowie das Abschlie√üen der 2FA f√ºr das Konto des Benutzers ohne Fortsetzung erm√∂glicht den Versuch, den n√§chsten Schritt im Kontofluss des Opfers zu erreichen, indem die Einschr√§nkungen des Backend-Sitzungsmanagements ausgenutzt werden.

### **Passwort-Reset-Mechanismus**

Die Untersuchung der Passwort-Reset-Funktion, die einen Benutzer nach dem Zur√ºcksetzen in die Anwendung einloggt, um festzustellen, ob mehrere Resets mit demselben Link m√∂glich sind, ist entscheidend. Das Einloggen mit den neu zur√ºckgesetzten Anmeldedaten k√∂nnte die 2FA umgehen.

### **Kompromittierung der OAuth-Plattform**

Die Kompromittierung des Kontos eines Benutzers auf einer vertrauensw√ºrdigen **OAuth**-Plattform (z. B. Google, Facebook) kann einen Weg zur Umgehung der 2FA bieten.

### **Brute-Force-Angriffe**

#### **Fehlen einer Rate-Limitierung**

Das Fehlen einer Begrenzung f√ºr die Anzahl der Codeversuche erm√∂glicht Brute-Force-Angriffe, obwohl eine potenzielle stille Rate-Limitierung in Betracht gezogen werden sollte.

#### **Langsamer Brute-Force**

Ein langsamer Brute-Force-Angriff ist m√∂glich, wenn Flussratenbeschr√§nkungen ohne eine √ºbergreifende Rate-Limitierung vorhanden sind.

#### **Zur√ºcksetzen des Code-Resend-Limits**

Das erneute Senden des Codes setzt die Rate-Limitierung zur√ºck und erm√∂glicht fortgesetzte Brute-Force-Versuche.

#### **Umgehung der Rate-Limitierung auf Clientseite**

Ein Dokument beschreibt Techniken zur Umgehung der Rate-Limitierung auf Clientseite.

#### **Interne Aktionen ohne Rate-Limitierung**

Rate-Limits k√∂nnen Anmeldeversuche sch√ºtzen, aber nicht interne Kontohandlungen.

#### **Kosten f√ºr das erneute Senden von SMS-Codes**

Das √ºberm√§√üige erneute Senden von Codes √ºber SMS verursacht Kosten f√ºr das Unternehmen, umgeht jedoch nicht die 2FA.

#### **Unendliche OTP-Regenerierung**

Die endlose OTP-Generierung mit einfachen Codes erm√∂glicht Brute-Force, indem ein kleiner Satz von Codes erneut versucht wird.

### **Ausnutzung von Race Conditions**

Die Ausnutzung von Race Conditions zur Umgehung der 2FA kann in einem spezifischen Dokument gefunden werden.

### **CSRF/Clickjacking-Schwachstellen**

Die Erkundung von CSRF- oder Clickjacking-Schwachstellen zur Deaktivierung der 2FA ist eine praktikable Strategie.

### **"Remember Me"-Funktionsexploits**

#### **Vorhersehbare Cookie-Werte**

Das Erraten des "Remember Me"-Cookie-Werts kann Einschr√§nkungen umgehen.

#### **IP-Adressen-Imitation**

Die Imitation der IP-Adresse des Opfers durch den **X-Forwarded-For**-Header kann Einschr√§nkungen umgehen.

### **Verwendung √§lterer Versionen**

#### **Subdomains**

Das Testen von Subdomains kann veraltete Versionen ohne 2FA-Unterst√ºtzung verwenden oder anf√§llige 2FA-Implementierungen enthalten.

#### **API-Endpunkte**

√Ñltere API-Versionen, die durch /v\*/-Verzeichnispfade angezeigt werden, k√∂nnen anf√§llig f√ºr 2FA-Umgehungsmethoden sein.

### **Behandlung fr√ºherer Sitzungen**

Das Beenden bestehender Sitzungen bei Aktivierung der 2FA sichert Konten gegen unbefugten Zugriff von kompromittierten Sitzungen.

### **Zugriffssteuerungsfehler mit Backup-Codes**

Die sofortige Generierung und potenzielle unbefugte Abrufung von Backup-Codes bei Aktivierung der 2FA, insbesondere bei CORS-Fehlkonfigurationen/XSS-Schwachstellen, birgt ein Risiko.

### **Offenlegung von Informationen auf der 2FA-Seite**

Die Offenlegung sensibler Informationen (z. B. Telefonnummer) auf der 2FA-Verifizierungsseite ist ein Anliegen.

### **Passwort-Reset deaktiviert 2FA**

Ein Prozess, der eine potenzielle Umgehungsmethode zeigt, beinhaltet die Kontoerstellung, 2FA-Aktivierung, Passwort-Reset und anschlie√üendes Einloggen ohne die 2FA-Anforderung.

### **Lockanfragen**

Die Verwendung von Lockanfragen zur Verschleierung von Brute-Force-Versuchen oder zur Irref√ºhrung von Rate-Limiting-Mechanismen f√ºgt Umgehungstrategien eine weitere Ebene hinzu. Das Erstellen solcher Anfragen erfordert ein nuanciertes Verst√§ndnis der Sicherheitsma√ünahmen und des Rate-Limiting-Verhaltens der Anwendung.

## Referenzen

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
