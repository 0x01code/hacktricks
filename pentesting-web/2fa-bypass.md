# Contournement de l'authentification √† deux facteurs (2FA/OTP)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) est un moteur de recherche aliment√© par le **dark web** qui offre des fonctionnalit√©s **gratuites** pour v√©rifier si une entreprise ou ses clients ont √©t√© **compromis** par des **logiciels malveillants voleurs**.

Le but principal de WhiteIntel est de lutter contre les prises de contr√¥le de compte et les attaques de ransomware r√©sultant de logiciels malveillants voleurs d'informations.

Vous pouvez consulter leur site Web et essayer leur moteur **gratuitement** sur :

{% embed url="https://whiteintel.io" %}

***

## **Techniques am√©lior√©es de contournement de l'authentification √† deux facteurs (2FA)**

### **Acc√®s direct aux points de terminaison**

Pour contourner la 2FA, acc√©dez directement au point de terminaison suivant en connaissant le chemin est crucial. En cas d'√©chec, modifiez l'en-t√™te **Referrer** pour imiter la navigation depuis la page de v√©rification 2FA.

### **R√©utilisation de jetons**

La r√©utilisation de jetons pr√©c√©demment utilis√©s pour l'authentification dans un compte peut √™tre efficace.

### **Utilisation de jetons inutilis√©s**

Extraire un jeton de son propre compte pour contourner la 2FA dans un autre compte peut √™tre tent√©.

### **Exposition du jeton**

V√©rifiez si le jeton est divulgu√© dans une r√©ponse de l'application web.

### **Exploitation du lien de v√©rification**

L'utilisation du **lien de v√©rification par e-mail envoy√© lors de la cr√©ation du compte** peut permettre l'acc√®s au profil sans 2FA, comme indiqu√© dans un [article](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b) d√©taill√©.

### **Manipulation de session**

Lancer des sessions pour le compte de l'utilisateur et celui d'une victime, et terminer la 2FA pour le compte de l'utilisateur sans poursuivre, permet de tenter d'acc√©der √† l'√©tape suivante dans le flux du compte de la victime, en exploitant les limitations de gestion de session c√¥t√© serveur.

### **M√©canisme de r√©initialisation de mot de passe**

L'investigation de la fonction de r√©initialisation de mot de passe, qui connecte un utilisateur √† l'application apr√®s la r√©initialisation, pour sa capacit√© √† permettre plusieurs r√©initialisations en utilisant le m√™me lien est cruciale. Se connecter avec les nouvelles informations de connexion r√©initialis√©es pourrait contourner la 2FA.

### **Compromission de la plateforme OAuth**

La compromission du compte d'un utilisateur sur une plateforme **OAuth** de confiance (par exemple, Google, Facebook) peut offrir une voie de contournement de la 2FA.

### **Attaques par force brute**

#### **Absence de limite de taux**

L'absence de limite sur le nombre de tentatives de code permet des attaques par force brute, bien que des limites de taux silencieuses potentielles doivent √™tre prises en compte.

#### **Force brute lente**

Une attaque par force brute lente est possible lorsque des limites de d√©bit existent sans limite globale.

#### **R√©initialisation de la limite de renvoi de code**

Le renvoi du code r√©initialise la limite de taux, facilitant les tentatives de force brute continues.

#### **Contournement de la limite de taux c√¥t√© client**

Un document d√©taille les techniques pour contourner la limitation de taux c√¥t√© client.

#### **Actions internes sans limite de taux**

Les limites de taux peuvent prot√©ger les tentatives de connexion mais pas les actions de compte internes.

#### **Co√ªts de renvoi de code SMS**

Le renvoi excessif de codes via SMS entra√Æne des co√ªts pour l'entreprise, bien que cela ne contourne pas la 2FA.

#### **R√©g√©n√©ration infinie d'OTP**

La g√©n√©ration infinie d'OTP avec des codes simples permet la force brute en r√©essayant un petit ensemble de codes.

### **Exploitation de la condition de course**

L'exploitation des conditions de course pour contourner la 2FA peut √™tre trouv√©e dans un document sp√©cifique.

### **Vuln√©rabilit√©s CSRF/Clickjacking**

Explorer les vuln√©rabilit√©s CSRF ou Clickjacking pour d√©sactiver la 2FA est une strat√©gie viable.

### **Exploitation de la fonction "Se souvenir de moi"**

#### **Valeurs de cookie pr√©visibles**

Deviner la valeur du cookie "se souvenir de moi" peut contourner les restrictions.

#### **Impersonation de l'adresse IP**

L'usurpation de l'adresse IP de la victime via l'en-t√™te **X-Forwarded-For** peut contourner les restrictions.

### **Utilisation de versions plus anciennes**

#### **Sous-domaines**

Tester les sous-domaines peut utiliser des versions obsol√®tes sans prise en charge de la 2FA ou contenir des impl√©mentations de 2FA vuln√©rables.

#### **Points de terminaison API**

Les anciennes versions d'API, indiqu√©es par des chemins de r√©pertoire /v\*, peuvent √™tre vuln√©rables aux m√©thodes de contournement de la 2FA.

### **Gestion des sessions pr√©c√©dentes**

La terminaison des sessions existantes lors de l'activation de la 2FA s√©curise les comptes contre les acc√®s non autoris√©s √† partir de sessions compromises.

### **D√©fauts de contr√¥le d'acc√®s avec codes de secours**

La g√©n√©ration imm√©diate et la r√©cup√©ration potentiellement non autoris√©e de codes de secours lors de l'activation de la 2FA, en particulier avec des configurations CORS/XSS incorrectes, posent un risque.

### **Divulgation d'informations sur la page 2FA**

La divulgation d'informations sensibles (par exemple, num√©ro de t√©l√©phone) sur la page de v√©rification 2FA est une pr√©occupation.

### **D√©sactivation de la r√©initialisation de mot de passe 2FA**

Un processus d√©montrant une m√©thode de contournement potentielle implique la cr√©ation de compte, l'activation de la 2FA, la r√©initialisation du mot de passe et la connexion ult√©rieure sans l'exigence de 2FA.

### **Requ√™tes leurres**

L'utilisation de requ√™tes leurres pour obscurcir les tentatives de force brute ou induire en erreur les m√©canismes de limitation de taux ajoute une autre couche aux strat√©gies de contournement. La cr√©ation de telles requ√™tes n√©cessite une compr√©hension nuanc√©e des mesures de s√©curit√© de l'application et des comportements de limitation de taux.

## R√©f√©rences

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) est un moteur de recherche aliment√© par le **dark web** qui offre des fonctionnalit√©s **gratuites** pour v√©rifier si une entreprise ou ses clients ont √©t√© **compromis** par des **logiciels malveillants voleurs**.

Le but principal de WhiteIntel est de lutter contre les prises de contr√¥le de compte et les attaques de ransomware r√©sultant de logiciels malveillants voleurs d'informations.

Vous pouvez consulter leur site Web et essayer leur moteur **gratuitement** sur :

{% embed url="https://whiteintel.io" %}

P
