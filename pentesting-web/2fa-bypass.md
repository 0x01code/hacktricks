# 2FA/OTP Bypass

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 상품**](https://peass.creator-spring.com)을 구매하세요.
* 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션인 [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)을 **팔로우**하세요.
* **Hacking 트릭을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks)와 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하세요.

</details>

## **향상된 이중 인증 우회 기법**

### **직접 엔드포인트 접근**

2FA 우회를 위해 경로를 알고 다음 엔드포인트에 직접 접근하는 것이 중요합니다. 성공하지 못하면 **Referrer 헤더**를 변경하여 2FA 확인 페이지에서의 탐색을 모방하세요.

### **토큰 재사용**

계정 내에서 이전에 사용한 토큰을 재사용하는 것은 효과적일 수 있습니다.

### **사용되지 않은 토큰 활용**

자신의 계정에서 토큰을 추출하여 다른 계정의 2FA 우회를 시도할 수 있습니다.

### **토큰 노출**

토큰이 웹 애플리케이션의 응답에서 노출되는지 조사하세요.

### **검증 링크 악용**

계정 생성 시 전송된 **이메일 검증 링크**를 사용하여 2FA 없이 프로필에 액세스할 수 있습니다. 자세한 내용은 [포스트](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b)를 참조하세요.

### **세션 조작**

사용자와 피해자의 계정에 대한 세션을 시작하고 사용자 계정의 2FA를 완료하지 않고 다음 단계로 진행하여 백엔드 세션 관리 제한을 이용하여 피해자의 계정 흐름의 다음 단계에 액세스를 시도할 수 있습니다.

### **비밀번호 재설정 메커니즘**

비밀번호 재설정 기능을 조사하여 동일한 링크를 사용하여 여러 번 재설정할 수 있는지 확인하세요. 새로 재설정된 자격 증명으로 로그인하면 2FA를 우회할 수 있습니다.

### **OAuth 플랫폼 침해**

신뢰할 수 있는 **OAuth** 플랫폼 (예: Google, Facebook)의 사용자 계정을 침해하여 2FA를 우회할 수 있습니다.

### **무차별 대입 공격**

#### **제한 없는 속도 제한**

코드 시도 횟수에 제한이 없으면 무차별 대입 공격이 가능하지만 잠재적인 은밀한 속도 제한을 고려해야 합니다.

#### **느린 무차별 대입**

전반적인 속도 제한이 없는 경우 느린 무차별 대입 공격이 가능합니다.

#### **코드 재전송 제한 재설정**

코드를 재전송하면 속도 제한이 재설정되어 계속해서 무차별 대입 공격을 시도할 수 있습니다.

#### **클라이언트 측 속도 제한 우회**

문서에는 클라이언트 측 속도 제한을 우회하는 기법에 대한 내용이 있습니다.

#### **내부 동작에 제한 없음**

속도 제한은 로그인 시도를 보호하지만 내부 계정 동작은 보호하지 않을 수 있습니다.

#### **SMS 코드 재전송 비용**

SMS를 통한 코드 재전송이 과도하게 이루어지면 회사에 비용이 발생하지만 2FA를 우회하지는 않습니다.

#### **무한 OTP 재생성**

간단한 코드로 무한한 OTP 생성이 가능하므로 소수의 코드 집합을 재시도하여 무차별 대입을 할 수 있습니다.

### **경쟁 조건 악용**

2FA 우회를 위해 경쟁 조건을 악용할 수 있는 내용은 특정 문서에서 찾을 수 있습니다.

### **CSRF/Clickjacking 취약점**

CSRF 또는 Clickjacking 취약점을 탐색하여 2FA를 비활성화하는 것은 유효한 전략입니다.

### **"Remember Me" 기능 악용**

#### **예측 가능한 쿠키 값**

"remember me" 쿠키 값 추측을 통해 제한을 우회할 수 있습니다.

#### **IP 주소 위장**

**X-Forwarded-For** 헤더를 통해 피해자의 IP 주소를 위장하여 제한을 우회할 수 있습니다.

### **이전 버전 활용**

#### **하위 도메인**

하위 도메인을 테스트하면 2FA 지원이 없는 오래된 버전을 사용하거나 취약한 2FA 구현이 포함된 버전을 사용할 수 있습니다.

#### **API 엔드포인트**

/v\* 디렉토리 경로로 표시된 오래된 API 버전은 2FA 우회 방법에 취약할 수 있습니다.

### **이전 세션 처리**

2FA 활성화 시 기존 세션을 종료하여 침해된 세션으로부터의 무단 액세스로부터 계정을 보호합니다.

### **백업 코드와의 접근 제어 결함**

2FA 활성화 시 즉시 백업 코드를 생성하고 무단으로 검색할 수 있는 가능성은 CORS 구성 오류/XSS 취약점과 함께 위험을 초래할 수 있습니다.

### **2FA 페이지에서의 정보 노출**

2FA 확인 페이지에서 민감한 정보 (예: 전화번호)가 노출되는 것은 문제입니다.

### **비밀번호 재설정으로 2FA 비활성화**

계정 생성, 2FA 활성화, 비밀번호 재설정 및 2FA 요구 사항 없이 로그인하는 잠재적인 우회 방법을 보여주는 프로세스입니다.

### **속임수 요청**

속임수 요청을 사용하여 무차별 대입 공격을 난독화하거나 속도 제한 메커니즘을 오도할 수 있으며, 이러한 요청을 작성하려면 애플리케이션의 보안 조치와 속도 제한 동작에 대한 세심한 이해가 필요합니다.

## 참고 자료

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/kr/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
