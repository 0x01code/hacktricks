<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- ¬øTrabajas en una empresa de ciberseguridad? ¬øQuieres ver tu empresa anunciada en HackTricks? ¬øO quieres tener acceso a la √∫ltima versi√≥n de PEASS o descargar HackTricks en PDF? ¬°Consulta los [PLANES DE SUSCRIPCI√ìN](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obt√©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) **grupo de Discord** o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live).

- **Comparte tus trucos de hacking enviando PRs al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# **Bypass de autenticaci√≥n de dos factores**

## **Bypass directo**

Para saltarse la autenticaci√≥n de dos factores, simplemente **intenta acceder directamente al siguiente endpoint** (necesitas conocer la ruta del siguiente endpoint). Si esto no funciona, intenta cambiar el **encabezado Referrer** como si vinieras de la p√°gina de autenticaci√≥n de dos factores.

## **Reutilizaci√≥n de token**

Quiz√°s puedas reutilizar un token previamente utilizado dentro de la cuenta para autenticarte.

## Compartir tokens no utilizados

Comprueba si puedes obtener el token de tu cuenta e intenta usarlo para saltarte la autenticaci√≥n de dos factores en una cuenta diferente.

## Token filtrado

¬øSe filtra el token en una respuesta de la aplicaci√≥n web?

## Permiso de sesi√≥n

Usando la misma sesi√≥n, inicia el flujo usando tu cuenta y la cuenta de la v√≠ctima. Cuando llegues al punto de autenticaci√≥n de dos factores en ambas cuentas, completa la autenticaci√≥n de dos factores con tu cuenta pero no accedas a la siguiente parte. En lugar de eso, intenta acceder al siguiente paso con el flujo de la cuenta de la v√≠ctima. Si el back-end solo establece un booleano dentro de tus sesiones diciendo que has pasado la autenticaci√≥n de dos factores con √©xito, podr√°s saltarte la autenticaci√≥n de dos factores de la v√≠ctima.

## **Funci√≥n de restablecimiento de contrase√±a**

En casi todas las aplicaciones web, la **funci√≥n de restablecimiento de contrase√±a inicia sesi√≥n autom√°ticamente en la aplicaci√≥n** despu√©s de que se complete el procedimiento de restablecimiento.\
Comprueba si se env√≠a un **correo electr√≥nico** con un **enlace** para **restablecer la contrase√±a** y si puedes **reutilizar** ese **enlace** para restablecer la contrase√±a **tantas veces como quieras** (incluso si la v√≠ctima cambia su direcci√≥n de correo electr√≥nico).

## OAuth

Si puedes comprometer la cuenta del usuario en una plataforma de **OAuth** confiable (Google, Facebook...)

## Fuerza bruta

### Falta de l√≠mite de velocidad

¬øHay alg√∫n l√≠mite en el n√∫mero de c√≥digos que puedes probar, para que puedas simplemente hacer fuerza bruta? Ten cuidado con un posible l√≠mite de velocidad "silencioso", siempre prueba varios c√≥digos y luego el real para confirmar la vulnerabilidad.

### L√≠mite de velocidad del flujo pero sin l√≠mite de velocidad

En este caso, hay un l√≠mite de velocidad del flujo (tienes que hacer fuerza bruta muy lentamente: 1 hilo y algo de tiempo de espera antes de 2 intentos) pero no hay l√≠mite de velocidad. As√≠ que con suficiente tiempo, puedes ser capaz de encontrar el c√≥digo v√°lido.

### Reenviar el c√≥digo y restablecer el l√≠mite

Hay un l√≠mite de velocidad, pero cuando "reenv√≠as el c√≥digo" se env√≠a el mismo c√≥digo y se restablece el l√≠mite de velocidad. Entonces, puedes hacer fuerza bruta en el c√≥digo mientras lo reenv√≠as para que nunca se alcance el l√≠mite de velocidad.

### Bypass del l√≠mite de velocidad del lado del cliente

{% content-ref url="rate-limit-bypass.md" %}
[rate-limit-bypass.md](rate-limit-bypass.md)
{% endcontent-ref %}

### Falta de l√≠mite de velocidad en la cuenta del usuario

A veces puedes configurar la autenticaci√≥n de dos factores para algunas acciones dentro de tu cuenta (cambiar correo electr√≥nico, contrase√±a...). Sin embargo, incluso en los casos en que hay un l√≠mite de velocidad cuando intentas iniciar sesi√≥n, no hay ning√∫n l√≠mite de velocidad para proteger las acciones dentro de la cuenta.

### Falta de l√≠mite de velocidad al reenviar el c√≥digo por SMS

No podr√°s saltarte la autenticaci√≥n de dos factores, pero podr√°s gastar el dinero de la empresa.

### Regeneraci√≥n infinita de OTP

Si puedes **generar un nuevo OTP infinitas veces**, el **OTP es lo suficientemente simple** (4 n√∫meros), y puedes probar hasta 4 o 5 tokens por OTP generado, simplemente puedes probar los mismos 4 o 5 tokens cada vez y generar OTP hasta que coincida con los que est√°s usando.

## CSRF/Clickjacking

Comprueba si hay una vulnerabilidad de Cross Site Request Forgery (CSRF) o de Clickjacking para desactivar la autenticaci√≥n de dos factores.

## Funcionalidad de recordarme

### Cookie adivinable

Si la funcionalidad de "recordarme" utiliza una nueva cookie con un c√≥digo adivinable, intenta adivinarlo.

### Direcci√≥n IP

Si la funcionalidad de "recordarme" est√° vinculada a tu direcci√≥n IP, puedes intentar averiguar la direcci√≥n IP de la v√≠ctima e impersonarla usando el encabezado **X-Forwarded-For**.

## Versiones antiguas

### Subdominios

Si puedes encontrar algunos subdominios de "pruebas" con la funcionalidad de inicio de sesi√≥n, podr√≠an estar utilizando versiones antiguas que no admiten la autenticaci√≥n de dos factores (por lo que se
