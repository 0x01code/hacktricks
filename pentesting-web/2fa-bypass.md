# Bypass de 2FA/OTP

<details>

<summary><strong>Aprenda hacking AWS do zero ao herói com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Família PEASS**](https://opensea.io/collection/the-peass-family), nossa coleção exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** 💬 [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositórios do github.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) é um motor de busca alimentado pela **dark web** que oferece funcionalidades **gratuitas** para verificar se uma empresa ou seus clientes foram **comprometidos** por **malwares roubadores**.

O objetivo principal do WhiteIntel é combater tomadas de conta e ataques de ransomware resultantes de malwares que roubam informações.

Você pode verificar o site deles e experimentar o motor de busca de forma **gratuita** em:

{% embed url="https://whiteintel.io" %}

---

## **Técnicas Avançadas de Bypass de Autenticação de Dois Fatores**

### **Acesso Direto ao Endpoint**

Para contornar o 2FA, acesse diretamente o endpoint subsequente, sendo crucial conhecer o caminho. Se não tiver sucesso, altere o **cabeçalho Referrer** para imitar a navegação a partir da página de verificação do 2FA.

### **Reutilização de Token**

Reutilizar tokens previamente usados para autenticação em uma conta pode ser eficaz.

### **Utilização de Tokens Não Utilizados**

Extrair um token da própria conta para contornar o 2FA em outra conta pode ser tentado.

### **Exposição do Token**

Investigar se o token é revelado em uma resposta da aplicação web.

### **Exploração do Link de Verificação**

Usar o **link de verificação por e-mail enviado durante a criação da conta** pode permitir acesso ao perfil sem 2FA, como destacado em um post detalhado [aqui](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Manipulação de Sessão**

Iniciar sessões para a conta do usuário e da vítima, e completar o 2FA para a conta do usuário sem prosseguir, permite uma tentativa de acessar a próxima etapa no fluxo da conta da vítima, explorando limitações de gerenciamento de sessão do backend.

### **Mecanismo de Redefinição de Senha**

Investigar a função de redefinição de senha, que faz login do usuário na aplicação pós-redefinição, para verificar seu potencial de permitir múltiplas redefinições usando o mesmo link é crucial. Fazer login com as novas credenciais redefinidas pode contornar o 2FA.

### **Comprometimento da Plataforma OAuth**

Comprometer a conta de um usuário em uma plataforma **OAuth** confiável (por exemplo, Google, Facebook) pode oferecer uma rota para contornar o 2FA.

### **Ataques de Força Bruta**

#### **Ausência de Limite de Taxa**

A falta de um limite no número de tentativas de código permite ataques de força bruta, embora um potencial limite de taxa silencioso deva ser considerado.

#### **Força Bruta Lenta**

Um ataque de força bruta lento é viável onde existem limites de taxa de fluxo sem um limite de taxa geral.

#### **Redefinição do Limite de Reenvio de Código**

O reenvio do código redefine o limite de taxa, facilitando tentativas contínuas de força bruta.

#### **Contorno de Limite de Taxa do Lado do Cliente**

Um documento detalha técnicas para contornar limites de taxa do lado do cliente.

#### **Ações Internas Sem Limite de Taxa**

Limites de taxa podem proteger tentativas de login, mas não ações internas da conta.

#### **Custos de Reenvio de Código SMS**

O reenvio excessivo de códigos via SMS incorre em custos para a empresa, embora não contorne o 2FA.

#### **Regeneração Infinita de OTP**

A geração infinita de OTP com códigos simples permite a força bruta ao tentar novamente um pequeno conjunto de códigos.

### **Exploração de Condição de Corrida**

Explorar condições de corrida para contornar o 2FA pode ser encontrado em um documento específico.

### **Vulnerabilidades CSRF/Clickjacking**

Explorar vulnerabilidades CSRF ou Clickjacking para desativar o 2FA é uma estratégia viável.

### **Explorações da Funcionalidade "Lembrar-me"**

#### **Valores de Cookie Previsíveis**

Adivinhar o valor do cookie "lembrar-me" pode contornar restrições.

#### **Impersonação de Endereço IP**

Impersonar o endereço IP da vítima através do cabeçalho **X-Forwarded-For** pode contornar restrições.

### **Utilizando Versões Antigas**

#### **Subdomínios**

Testar subdomínios pode usar versões desatualizadas sem suporte de 2FA ou conter implementações de 2FA vulneráveis.

#### **Endpoints de API**

Versões antigas de API, indicadas por caminhos de diretório /v\*, podem ser vulneráveis a métodos de contorno de 2FA.

### **Tratamento de Sessões Anteriores**

Encerrar sessões existentes ao ativar o 2FA protege contas contra acesso não autorizado de sessões comprometidas.

### **Falhas de Controle de Acesso com Códigos de Backup**

A geração imediata e a recuperação não autorizada potencial de códigos de backup ao ativar o 2FA, especialmente com misconfigurações de CORS/vulnerabilidades XSS, representam um risco.

### **Divulgação de Informações na Página de 2FA**

A divulgação de informações sensíveis (por exemplo, número de telefone) na página de verificação de 2FA é uma preocupação.

### **Redefinição de Senha Desativando o 2FA**

Um processo demonstrando um método potencial de contorno envolve criação de conta, ativação de 2FA, redefinição de senha e login subsequente sem a exigência de 2FA.

### **Requisições Falsas**

Utilizar requisições falsas para obscurecer tentativas de força bruta ou enganar mecanismos de limitação de taxa adiciona outra camada às estratégias de contorno. Criar tais requisições requer uma compreensão sutil das medidas de segurança e comportamentos de limitação de taxa da aplicação.

## Referências

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)


### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) é um motor de busca alimentado pela **dark web** que oferece funcionalidades **gratuitas** para verificar se uma empresa ou seus clientes foram **comprometidos** por **malwares roubadores**.

O objetivo principal do WhiteIntel é combater tomadas de conta e ataques de ransomware resultantes de malwares que roubam informações.

Você pode verificar o site deles e experimentar o motor de busca de forma **gratuita** em:

{% embed url="https://whiteintel.io" %}
