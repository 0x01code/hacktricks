# 2FA/OTP バイパス

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong>を使って、ゼロからヒーローまでAWSハッキングを学びましょう！</summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝したい** または **HackTricks をPDFでダウンロードしたい** 場合は [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェック！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family)を入手
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)** に参加するか、[telegramグループ](https://t.me/peass)に参加するか、**Twitter** 🐦 で **@carlospolopm** をフォローする [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ハッキングテクニックを共有するために、** [**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) のGitHubリポジトリにPRを提出する。

</details>

## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) は、**ダークウェブ**を活用した検索エンジンで、企業やその顧客が**盗難マルウェア**によって**侵害**されていないかをチェックするための**無料**機能を提供しています。

WhiteIntelの主な目標は、情報窃取マルウェアによるアカウント乗っ取りやランサムウェア攻撃に対抗することです。

彼らのウェブサイトをチェックして、無料でエンジンを試すことができます：

{% embed url="https://whiteintel.io" %}

---

## **強化された二要素認証バイパステクニック**

### **直接エンドポイントアクセス**

2FAをバイパスするために、パスを知っている場合は、直接次のエンドポイントにアクセスします。失敗した場合は、**Referrerヘッダー**を変更して、2FA確認ページからのナビゲーションを模倣します。

### **トークンの再利用**

アカウント内で以前に使用したトークンを再利用することは効果的です。

### **未使用トークンの利用**

自分のアカウントからトークンを抽出して、別のアカウントで2FAをバイパスしようとすることができます。

### **トークンの露出**

Webアプリケーションからのレスポンスでトークンが公開されていないか調査します。

### **検証リンクの悪用**

アカウント作成時に送信された**メール検証リンク**を使用すると、2FAなしでプロファイルにアクセスできる場合があります。詳細は[こちら](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b)。

### **セッション操作**

ユーザーと被害者のアカウントのセッションを開始し、ユーザーのアカウントの2FAを完了せずに次のステップにアクセスしようとすることで、バックエンドセッション管理の制限を突破しようとします。

### **パスワードリセットメカニズム**

パスワードリセット機能を調査し、リセット後にユーザーをアプリケーションにログインさせる潜在的な能力を確認することが重要です。新しくリセットされた資格情報でログインすることで、2FAをバイパスできるかもしれません。

### **OAuthプラットフォームの侵害**

信頼された**OAuth**プラットフォーム（例：Google、Facebook）でユーザーアカウントを侵害することで、2FAをバイパスできる可能性があります。

### **ブルートフォース攻撃**

#### **レート制限の不在**

コード試行回数の制限がない場合、ブルートフォース攻撃が可能ですが、潜在的なサイレントレート制限を考慮する必要があります。

#### **遅いブルートフォース**

全体的なレート制限が存在しない場合、遅いブルートフォース攻撃が有効です。

#### **コード再送信制限のリセット**

コードを再送信すると、レート制限がリセットされ、継続的なブルートフォース試行が可能になります。

#### **クライアントサイドのレート制限回避**

文書には、クライアントサイドのレート制限をバイパスするためのテクニックが詳細に記載されています。

#### **内部アクションのレート制限の不在**

ログイン試行を保護するレート制限があるかもしれませんが、内部アカウントアクションにはレート制限がない場合があります。

#### **SMSコード再送信のコスト**

SMS経由でコードを過剰に再送信すると、企業にコストがかかりますが、2FAをバイパスすることはできません。

#### **無限OTP再生成**

簡単なコードを使って無限のOTP生成を行うことで、少数のコードを繰り返し試行することでブルートフォースが可能になります。

### **レースコンディションの悪用**

2FAバイパスのためのレースコンディションの悪用は、特定の文書に記載されています。

### **CSRF/Clickjackingの脆弱性**

2FAを無効にするためにCSRFまたはClickjackingの脆弱性を探索することは、有効な戦略です。

### **"Remember Me"機能の悪用**

#### **予測可能なCookie値**

"Remember me"クッキーの値を推測することで制限をバイパスできます。

#### **IPアドレスなりすまし**

**X-Forwarded-For**ヘッダーを通じて被害者のIPアドレスをなりすますことで制限をバイパスできます。

### **古いバージョンの利用**

#### **サブドメイン**

古い2FAサポートがない古いバージョンを使用するか、脆弱な2FA実装を含むサブドメインをテストすることができます。

#### **APIエンドポイント**

/v\*ディレクトリパスで示される古いAPIバージョンは、2FAバイパス手法に脆弱である可能性があります。

### **以前のセッションの処理**

2FAの有効化時に既存のセッションを終了することで、侵害されたセッションからの未承認アクセスを防ぎます。

### **バックアップコードのアクセス制御の欠陥**

2FAの有効化時にバックアップコードを即座に生成し、潜在的な未承認のバックアップコードの取得、特にCORSの誤構成/XSSの脆弱性がリスクをもたらす可能性があります。

### **2FAページでの情報漏洩**

2FA確認ページでの機密情報漏洩（電話番号など）は懸念事項です。

### **パスワードリセットによる2FAの無効化**

アカウント作成、2FAの有効化、パスワードリセット、および2FA要件なしでのサブセクエントログインを含むプロセスは、潜在的なバイパス手法を示しています。

### **デコイリクエスト**

デコイリクエストを使用してブルートフォース試行を曖昧にしたり、レート制限メカニズムを誤認させたりすることで、バイパス戦略に別のレイヤーを追加できます。このようなリクエストを作成するには、アプリケーションのセキュリティ対策とレート制限の動作に対する微妙な理解が必要です。

## 参考文献

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
