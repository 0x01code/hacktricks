# 2FA/OTP 우회

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 **제로**부터 **히어로**까지 AWS 해킹을 배우세요!</summary>

HackTricks를 지원하는 다른 방법:

* **회사가 HackTricks에 광고**되길 원하거나 **PDF로 HackTricks 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **Discord 그룹**에 **가입**하거나 [**텔레그램 그룹**](https://t.me/peass)에 가입하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)를 **팔로우**하세요.
* **HackTricks** 및 **HackTricks Cloud** github 저장소로 **PR 제출**을 통해 당신의 해킹 기술을 공유하세요.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io)은 **다크 웹**을 통해 **무료**로 제공되는 검색 엔진으로, 회사나 고객이 **스틸러 악성 코드**에 의해 **침해**당했는지 확인할 수 있는 기능을 제공합니다.

WhiteIntel의 주요 목표는 정보를 도난당한 악성 코드로 인한 계정 탈취 및 랜섬웨어 공격을 막는 것입니다.

그들의 웹사이트를 확인하고 **무료**로 엔진을 시도해 볼 수 있습니다:

{% embed url="https://whiteintel.io" %}

---

## **향상된 이중 인증 우회 기술**

### **직접 엔드포인트 액세스**

2FA를 우회하려면 경로를 알고 직접 해당 엔드포인트에 액세스해야 합니다. 실패할 경우 **Referrer 헤더**를 변경하여 2FA 확인 페이지에서의 탐색을 모방해야 합니다.

### **토큰 재사용**

계정 내에서 이전에 사용한 토큰을 인증에 재사용하는 것이 효과적일 수 있습니다.

### **사용되지 않은 토큰 활용**

자신의 계정에서 토큰을 추출하여 다른 계정의 2FA를 우회하는 시도를 할 수 있습니다.

### **토큰 노출**

웹 애플리케이션의 응답에서 토큰이 노출되었는지 조사합니다.

### **검증 링크 악용**

계정 생성 시 전송된 **이메일 검증 링크**를 사용하여 2FA 없이 프로필 액세스를 허용할 수 있습니다. 자세한 내용은 [포스트](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b)에서 확인할 수 있습니다.

### **세션 조작**

사용자 및 피해자의 계정에 대한 세션을 시작하고 사용자의 계정에 대해 2FA를 완료하지 않은 채로 다음 단계로 진입하여 피해자의 계정 흐름의 다음 단계에 액세스를 시도함으로써 백엔드 세션 관리 제한을 이용할 수 있습니다.

### **비밀번호 재설정 메커니즘**

비밀번호 재설정 기능을 조사하여 재설정 후 사용자를 애플리케이션에 로그인시키는 데 사용되는 링크가 동일한 링크를 여러 번 사용할 수 있는지 확인하는 것이 중요합니다. 새로 재설정된 자격 증명으로 로그인하면 2FA를 우회할 수 있습니다.

### **OAuth 플랫폼 침해**

신뢰할 수 있는 **OAuth** 플랫폼(예: Google, Facebook)에서 사용자의 계정을 침해하면 2FA를 우회할 수 있는 경로를 제공할 수 있습니다.

### **무차별 대입 공격**

#### **속도 제한 부재**

코드 시도 횟수에 대한 제한이 없으면 무차별 대입 공격이 가능하지만 잠재적인 은폐된 속도 제한을 고려해야 합니다.

#### **느린 무차별 대입**

전반적인 속도 제한이 없는 경우 느린 무차별 대입 공격이 가능합니다.

#### **코드 재전송 제한 재설정**

코드를 재전송하면 속도 제한이 재설정되어 계속해서 무차별 대입 시도를 할 수 있습니다.

#### **클라이언트 측 속도 제한 우회**

문서에는 클라이언트 측 속도 제한을 우회하는 기술에 대한 세부 정보가 있습니다.

#### **내부 작업 속도 제한 부재**

로그인 시도를 보호하는 속도 제한이 있을 수 있지만 내부 계정 작업에는 속도 제한이 없을 수 있습니다.

#### **SMS 코드 재전송 비용**

SMS를 통해 코드를 반복해서 재전송하면 회사에 비용이 발생하지만 2FA를 우회하지는 않습니다.

#### **무한 OTP 재생성**

간단한 코드를 재시도하여 소수의 코드 집합을 통해 무차별 대입을 허용하는 끊임없는 OTP 생성이 가능합니다.

### **레이스 컨디션 악용**

2FA 우회를 위해 레이스 컨디션을 악용하는 방법은 특정 문서에서 찾을 수 있습니다.

### **CSRF/Clickjacking 취약점**

2FA를 비활성화하기 위해 CSRF 또는 Clickjacking 취약점을 탐색하는 것은 실행 가능한 전략입니다.

### **"나를 기억해" 기능 악용**

#### **예측 가능한 쿠키 값**

"나를 기억해" 쿠키 값을 추측하여 제한을 우회할 수 있습니다.

#### **IP 주소 위장**

**X-Forwarded-For** 헤더를 통해 피해자의 IP 주소를 위장하여 제한을 우회할 수 있습니다.

### **이전 버전 활용**

#### **서브도메인**

서브도메인을 테스트하면 2FA 지원이 없는 오래된 버전을 사용하거나 취약한 2FA 구현이 포함된 경우가 있을 수 있습니다.

#### **API 엔드포인트**

/v\* 디렉토리 경로로 표시된 오래된 API 버전은 2FA 우회 방법에 취약할 수 있습니다.

### **이전 세션 처리**

2FA 활성화 시 기존 세션을 종료하여 침해된 세션으로부터의 무단 액세스로부터 계정을 보호합니다.

### **백업 코드와의 액세스 제어 결함**

2FA 활성화 시 즉시 백업 코드를 생성하고 무단으로 검색할 수 있는 가능성, 특히 CORS 구성 오류/XSS 취약점이 있는 경우, 위험을 초래할 수 있습니다.

### **2FA 페이지의 정보 노출**

2FA 확인 페이지에서 (예: 전화번호)와 같은 민감한 정보가 노출되는 것은 문제입니다.

### **비밀번호 재설정으로 2FA 비활성화**

계정 생성, 2FA 활성화, 비밀번호 재설정 및 2FA 요구 사항 없이 후속 로그인을 보여주는 잠재적인 우회 방법을 보여주는 프로세스가 있습니다.

### **속임수 요청**

속임수 요청을 활용하여 무차별 대입 시도를 혼란스럽게 하거나 속도 제한 메커니즘을 오도하는 것은 우회 전략에 추가적인 층을 더합니다. 이러한 요청을 작성하려면 애플리케이션의 보안 조치와 속도 제한 행동에 대한 세심한 이해가 필요합니다.

## 참고 자료

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io)은 **다크 웹**을 통해 **무료**로 제공되는 검색 엔진으로, 회사나 고객이 **스틸러 악성 코드**에 의해 **침해**당했는지 확인할 수 있는 기능을 제공합니다.

WhiteIntel의 주요 목표는 정보를 도난당한 악성 코드로 인한 계정 탈취 및 랜섬웨어 공격을 막는 것입니다.

그들의 웹사이트를 확인하고 **무료**로 엔진을 시도해 볼 수 있습니다:

{% embed url="https://whiteintel.io" %}
