# 2FA/OTP Bypass

<details>

<summary><strong>Lernen Sie das Hacken von AWS von Null auf Heldenniveau mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>

## **Verbesserte Techniken zum Umgehen der Zwei-Faktor-Authentifizierung**

### **Direkter Zugriff auf Endpunkt**

Um die 2FA zu umgehen, greifen Sie direkt auf den entsprechenden Endpunkt zu. Es ist wichtig, den Pfad zu kennen. Wenn dies nicht erfolgreich ist, √§ndern Sie den **Referrer-Header**, um die Navigation von der 2FA-Verifizierungsseite zu imitieren.

### **Token-Wiederverwendung**

Die Wiederverwendung zuvor verwendeter Tokens zur Authentifizierung in einem Konto kann effektiv sein.

### **Verwendung ungenutzter Tokens**

Es kann versucht werden, einen Token aus dem eigenen Konto zu extrahieren, um die 2FA in einem anderen Konto zu umgehen.

### **Offenlegung des Tokens**

√úberpr√ºfen Sie, ob der Token in einer Antwort der Webanwendung offengelegt wird.

### **Ausnutzung des Verifizierungslinks**

Die Verwendung des per E-Mail gesendeten **Verifizierungslinks bei der Kontoerstellung** erm√∂glicht den Zugriff auf das Profil ohne 2FA, wie in einem detaillierten [Beitrag](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b) beschrieben.

### **Sitzungsmanipulation**

Durch das Initiieren von Sitzungen f√ºr das Konto des Benutzers und das Konto des Opfers und das Abschlie√üen der 2FA f√ºr das Konto des Benutzers ohne Fortfahren kann versucht werden, auf den n√§chsten Schritt im Kontofluss des Opfers zuzugreifen und die Einschr√§nkungen des Backend-Sitzungsmanagements auszunutzen.

### **Passwortzur√ºcksetzungsmechanismus**

Untersuchen Sie die Passwortzur√ºcksetzungsfunktion, die einen Benutzer nach dem Zur√ºcksetzen in die Anwendung einloggt, um festzustellen, ob mehrere Zur√ºcksetzungen mit demselben Link m√∂glich sind. Das Einloggen mit den neu zur√ºckgesetzten Anmeldeinformationen kann die 2FA umgehen.

### **Kompromittierung der OAuth-Plattform**

Die Kompromittierung eines Benutzerkontos auf einer vertrauensw√ºrdigen **OAuth**-Plattform (z. B. Google, Facebook) kann einen Weg bieten, die 2FA zu umgehen.

### **Brute-Force-Angriffe**

#### **Fehlende Rate-Limitierung**

Das Fehlen einer Begrenzung f√ºr die Anzahl der Codeversuche erm√∂glicht Brute-Force-Angriffe, obwohl eine potenzielle stille Rate-Limitierung ber√ºcksichtigt werden sollte.

#### **Langsamer Brute-Force**

Ein langsamer Brute-Force-Angriff ist m√∂glich, wenn Flussratenbegrenzungen ohne eine √ºbergeordnete Rate-Limitierung vorhanden sind.

#### **Code-Neusendung zur Zur√ºcksetzung der Rate-Limitierung**

Das erneute Senden des Codes setzt die Rate-Limitierung zur√ºck und erm√∂glicht fortgesetzte Brute-Force-Versuche.

#### **Umgehung der clientseitigen Rate-Limitierung**

Ein Dokument beschreibt Techniken zum Umgehen der clientseitigen Rate-Limitierung.

#### **Fehlende Rate-Limitierung f√ºr interne Aktionen**

Rate-Limits k√∂nnen Anmeldeversuche sch√ºtzen, aber nicht interne Kontobewegungen.

#### **Kosten f√ºr die erneute Sendung von SMS-Codes**

Das √ºberm√§√üige erneute Senden von Codes per SMS verursacht Kosten f√ºr das Unternehmen, umgeht jedoch nicht die 2FA.

#### **Unendliche OTP-Regeneration**

Die endlose OTP-Generierung mit einfachen Codes erm√∂glicht Brute-Force-Angriffe durch erneutes Ausprobieren einer kleinen Menge von Codes.

### **Ausnutzung von Rennbedingungen**

Die Ausnutzung von Rennbedingungen zur Umgehung der 2FA kann in einem spezifischen Dokument gefunden werden.

### **CSRF/Clickjacking-Schwachstellen**

Die Erkundung von CSRF- oder Clickjacking-Schwachstellen zur Deaktivierung der 2FA ist eine m√∂gliche Strategie.

### **Ausnutzung der Funktion "Remember Me"**

#### **Vorhersagbare Cookie-Werte**

Das Erraten des Werts des "Remember Me"-Cookies kann Einschr√§nkungen umgehen.

#### **IP-Adressen-Imitation**

Die Imitation der IP-Adresse des Opfers √ºber den **X-Forwarded-For**-Header kann Einschr√§nkungen umgehen.

### **Verwendung √§lterer Versionen**

#### **Subdomains**

Das Testen von Subdomains kann veraltete Versionen ohne 2FA-Unterst√ºtzung verwenden oder anf√§llige 2FA-Implementierungen enthalten.

#### **API-Endpunkte**

√Ñltere API-Versionen, die durch Verzeichnispfade wie /v\* angezeigt werden, k√∂nnen anf√§llig f√ºr 2FA-Umgehungsmethoden sein.

### **Behandlung fr√ºherer Sitzungen**

Das Beenden bestehender Sitzungen beim Aktivieren der 2FA sichert Konten gegen unbefugten Zugriff aus kompromittierten Sitzungen.

### **Zugriffskontrollfehler mit Backup-Codes**

Die sofortige Generierung und potenzielle unbefugte Abrufung von Backup-Codes beim Aktivieren der 2FA, insbesondere bei CORS-Fehlkonfigurationen/XSS-Schwachstellen, birgt ein Risiko.

### **Informationen auf der 2FA-Seite offenlegen**

Die Offenlegung sensibler Informationen (z. B. Telefonnummer) auf der 2FA-Verifizierungsseite ist ein Problem.

### **Deaktivierung der 2FA durch Zur√ºcksetzen des Passworts**

Ein Prozess, der eine potenzielle Umgehungsmethode zeigt, umfasst die Kontoerstellung, Aktivierung der 2FA, Zur√ºcksetzen des Passworts und anschlie√üendes Einloggen ohne die Anforderung der 2FA.

### **Ablenkungsanfragen**

Die Verwendung von Ablenkungsanfragen zur Verschleierung von Brute-Force-Versuchen oder zur Irref√ºhrung von Rate-Limiting-Mechanismen f√ºgt Umgehungstrategien eine weitere Ebene hinzu. Das Erstellen solcher Anfragen erfordert ein nuanciertes Verst√§ndnis der Sicherheitsma√ünahmen und des Verhaltens der Rate-Limiting-Mechanismen der Anwendung.

## Referenzen

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/de/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)

<details>

<summary><strong>Lernen Sie das Hacken von AWS von Null auf Heldenniveau mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der**

</details>
