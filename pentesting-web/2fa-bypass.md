# 2FA/OTP バイパス

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>を通じてゼロからヒーローまでAWSハッキングを学ぶ</strong></a><strong>！</strong></summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝したい**または**HackTricks をPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見る
* **💬 [Discord グループ](https://discord.gg/hRep4RUj7f)** に参加するか、[**telegram グループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 で **@carlospolopm** をフォローする [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ハッキングトリックを共有するために、** [**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) の GitHub リポジトリに PR を提出する

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) は、**ダークウェブ**を活用した検索エンジンで、企業やその顧客が**スティーラーマルウェア**によって**侵害**されていないかをチェックする**無料**の機能を提供しています。

WhiteIntel の主な目標は、情報窃取マルウェアによるアカウント乗っ取りやランサムウェア攻撃に対抗することです。

彼らのウェブサイトをチェックして、無料でエンジンを試すことができます：

{% embed url="https://whiteintel.io" %}

***

## **強化された二要素認証バイパステクニック**

### **直接エンドポイントアクセス**

2FA をバイパスするには、パスを知っていることが重要です。失敗した場合は、**Referrer ヘッダー**を変更して、2FA 検証ページからのナビゲーションを模倣します。

### **トークンの再利用**

アカウント内で以前に使用したトークンを認証に再利用することが効果的です。

### **未使用トークンの利用**

自分のアカウントからトークンを抽出して、別のアカウントで2FA をバイパスしようとすることができます。

### **トークンの露出**

Web アプリケーションからのレスポンスでトークンが公開されていないか調査します。

### **検証リンクの悪用**

アカウント作成時に送信された**電子メール検証リンク**を使用すると、2FA をバイパスしてプロファイルにアクセスできます。詳細は[こちら](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b)。

### **セッション操作**

ユーザーと被害者のアカウントのセッションを開始し、ユーザーのアカウントの2FA を完了せずに次のステップにアクセスしようとすることで、バックエンドセッション管理の制限を突破しようとします。

### **パスワードリセットメカニズム**

パスワードリセット機能を調査し、リセット後にユーザーをアプリケーションにログインさせる潜在的な能力を確認することが重要です。新しくリセットされた資格情報でログインすることで、2FA をバイパスできるかもしれません。

### **OAuth プラットフォームの侵害**

信頼された**OAuth**プラットフォーム（例：Google、Facebook）でユーザーアカウントを侵害することで、2FA をバイパスする経路が提供される可能性があります。

### **ブルートフォース攻撃**

#### **レート制限の不在**

コード試行回数の制限がない場合、ブルートフォース攻撃が可能ですが、潜在的なサイレントレート制限を考慮する必要があります。

#### **遅いブルートフォース**

全体的なレート制限が存在しない場合、遅いブルートフォース攻撃が有効です。

#### **コード再送信リミットのリセット**

コードを再送信すると、レート制限がリセットされ、継続的なブルートフォース試行が容易になります。

#### **クライアントサイドのレート制限回避**

文書には、クライアントサイドのレート制限をバイパスするためのテクニックが詳細に記載されています。

#### **内部アクションのレート制限の不在**

ログイン試行を保護するレート制限があるかもしれませんが、内部アカウントアクションにはレート制限がない場合があります。

#### **SMS コード再送信のコスト**

SMS 経由でコードを過剰に再送信すると、企業にコストがかかりますが、2FA をバイパスすることはできません。

#### **無限 OTP 再生成**

簡単なコードを再試行することで、無限の OTP 生成が可能になり、少数のコードを再試行することでブルートフォースが可能になります。

### **レースコンディションの悪用**

2FA バイパスのためのレースコンディションの悪用は、特定の文書に見つかります。

### **CSRF/Clickjacking 脆弱性**

2FA を無効にするために CSRF または Clickjacking 脆弱性を探索することは、有効な戦略です。

### **"Remember Me" 機能の悪用**

#### **予測可能な Cookie 値**

"remember me" クッキーの値を推測することで制限をバイパスできます。

#### **IP アドレスなりすまし**

**X-Forwarded-For** ヘッダーを介して被害者の IP アドレスをなりすますことで制限をバイパスできます。

### **古いバージョンの利用**

#### **サブドメイン**

古い 2FA サポートがないバージョンを使用するか、脆弱な 2FA 実装が含まれている可能性があるサブドメインをテストします。

#### **API エンドポイント**

/v\* ディレクトリパスで示される古い API バージョンは、2FA バイパス手法に脆弱である可能性があります。

### **以前のセッションの処理**

2FA の有効化時に既存のセッションを終了することで、侵害されたセッションからの未承認アクセスからアカウントを保護します。

### **バックアップコードのアクセス制御の欠陥**

2FA の有効化時にバックアップコードを即座に生成し、潜在的な不正な取得を行うことは、CORS の誤構成/XSS 脆弱性など、リスクをもたらします。

### **2FA ページでの情報開示**

2FA 検証ページでの機密情報開示（電話番号など）は懸念事項です。

### **パスワードリセットによる 2FA の無効化**

アカウント作成、2FA の有効化、パスワードリセット、および 2FA 要件なしでの後続ログインを実証するプロセスは、潜在的なバイパス手法を示しています。

### **デコイリクエスト**

デコイリクエストを利用してブルートフォース試行を曖昧にしたり、レート制限メカニズムを誤誘導したりすることで、バイパス戦略に別のレイヤーを追加します。このようなリクエストを作成するには、アプリケーションのセキュリティ対策とレート制限の動作に対する微妙な理解が必要です。

## 参考文献

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) は、**ダークウェブ**を活用した検索エンジンで、企業やその顧客が**スティーラーマルウェア**によって**侵害**されていないかをチェックする**無料**の機能を提供しています。

WhiteIntel の主な目標は、情報窃取マルウェアによるアカウント乗っ取りやランサムウェア攻撃に対抗することです。

彼らのウェブサイトをチェックして、無料でエンジンを試すことができます：

{% embed url="https://whiteintel.io" %}

P
