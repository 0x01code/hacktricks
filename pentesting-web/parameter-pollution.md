# Contaminaci칩n de Par치metros

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Red Team de AWS de HackTricks)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** 춰Consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Obt칠n [**productos oficiales de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤gueme** en **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

# Visi칩n General de la Contaminaci칩n de Par치metros HTTP (HPP)

La Contaminaci칩n de Par치metros HTTP (HPP) es una t칠cnica de ataque que implica la manipulaci칩n de par치metros HTTP para alterar el comportamiento esperado de una aplicaci칩n web. Este tipo de ataque es relativamente sencillo pero puede ser sorprendentemente efectivo. Aunque la manipulaci칩n de par치metros ocurre en el lado del servidor y no es visible para el usuario, los cambios de comportamiento resultantes pueden ser observados en el lado del cliente.

## Ejemplo de Contaminaci칩n de Par치metros HTTP (HPP)

Considera una URL est치ndar de transacci칩n para una aplicaci칩n bancaria:

**URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Esta URL inicia una transacci칩n de 10,000 desde la cuentaA a la cuentaB. Sin embargo, introducir otro par치metro `from` de la siguiente manera:

**URL Manipulada:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

podr칤a resultar en que la transacci칩n se descuente de la cuentaC en lugar de la cuentaA. Esto ejemplifica c칩mo se puede utilizar HPP para manipular par치metros. Es importante destacar que esta vulnerabilidad no se limita a las solicitudes GET, sino que tambi칠n puede ser explotada en solicitudes POST en diversas funcionalidades como cambios de contrase침a, autenticaci칩n de dos factores o transmisiones de claves API.

Es importante reconocer que el an치lisis de par치metros depende de la tecnolog칤a web espec칤fica utilizada. Herramientas como [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) pueden ser utilizadas para identificar tecnolog칤as web y comprender sus comportamientos de an치lisis de par치metros.

## PHP

Un ejemplo notable de explotaci칩n de HPP involucr칩 los siguientes pasos:

1. **Manipulaci칩n de OTP:**
- Se ten칤a como objetivo una p치gina de inicio de sesi칩n que solicitaba un OTP.
- Despu칠s de enviar una solicitud de OTP, la solicitud HTTP subsiguiente fue interceptada utilizando Burp Suite.
- Se agreg칩 otro correo electr칩nico a la solicitud, duplicando efectivamente el par치metro `email`.
- El OTP destinado al primer correo electr칩nico fue enviado por error al segundo correo electr칩nico, permitiendo el acceso no autorizado a la primera cuenta.

Este incidente destaca c칩mo el backend de la aplicaci칩n procesaba los par치metros `email`, utilizando el primero para la generaci칩n de OTP y el segundo para la entrega de OTP.

# An치lisis de Par치metros en Flask y PHP

Diferentes tecnolog칤as web analizan los par치metros de manera 칰nica. Por ejemplo, con una consulta como `a=1&a=2`, Flask y PHP interpretar치n el par치metro de manera diferente:

- **Flask:** Toma la primera ocurrencia (a=1).
- **PHP (en el Servidor HTTP Apache):** Toma la 칰ltima ocurrencia (a=2).

Esta diferencia en el manejo de par치metros puede impactar significativamente en el comportamiento de la aplicaci칩n y en la vulnerabilidad a ataques de HPP. Se pueden encontrar m치s detalles al respecto en [este art칤culo](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution).

# Referencias
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Red Team de AWS de HackTricks)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** 춰Consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Obt칠n [**productos oficiales de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤gueme** en **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
