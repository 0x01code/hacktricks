# Polui√ß√£o de Par√¢metros

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

**Copiado de** [**https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654**](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)

**Resumo :**

Polui√ß√£o de Par√¢metros HTTP (HPP) significa poluir os par√¢metros HTTP de uma aplica√ß√£o web para alcan√ßar uma tarefa maliciosa espec√≠fica. Refere-se a manipular como um site trata par√¢metros que recebe durante solicita√ß√µes HTTP. Isso muda o comportamento do site do seu intencionado. Polui√ß√£o de par√¢metros HTTP √© um tipo simples de ataque, mas eficaz.

Quando voc√™ polui qualquer par√¢metro, o c√≥digo √© executado apenas no lado do servidor, que √© invis√≠vel para n√≥s, mas podemos ver os resultados na nossa tela. O processo intermedi√°rio √© uma caixa preta.

Por exemplo, existe uma URL https://www.anybank.com/send que tem tr√™s par√¢metros :

1. from :
2. to :
3. amount :

**URL : https://www.anybank.com/send/?from=accountA\&to=accountB\&amount=10000**

Agora, esta √© uma URL normal que proceder√° uma transa√ß√£o de 10000 de accountA para accountB, mas e se adicionarmos outro mesmo par√¢metro **‚Äúfrom :‚Äù**

Ent√£o a URL ser√° como **https://www.anybank.com/send/?from=accountA\&to=accountB\&amount=10000\&from=accountC**

Quando esta URL proceder uma transa√ß√£o de 10000, ser√° deduzido de accountC em vez de accountA. √â assim que voc√™ manipula os par√¢metros em um ataque de **Polui√ß√£o de Par√¢metros HTTP**. Embora o escopo desta vulnerabilidade n√£o esteja limitado apenas a solicita√ß√µes **GET**, voc√™ tamb√©m pode realizar este ataque em uma solicita√ß√£o baseada em **POST**. Voc√™ pode tentar esta vulnerabilidade em muitos lugares como mudan√ßa de senha, 2FA, coment√°rios, upload de foto de perfil, em um par√¢metro onde a chave da API √© passada, OTP etc.

Quando voc√™ manipula qualquer par√¢metro, sua manipula√ß√£o depende de como cada tecnologia web est√° analisando seus par√¢metros. Voc√™ pode identificar tecnologias web usando ‚Äú[Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/)‚Äù. Abaixo est√° a captura de tela de algumas tecnologias e sua an√°lise de par√¢metros.Tecnologias e sua an√°lise de par√¢metros

![Image for post](https://miro.medium.com/max/1760/1\*POs4sP0fQVlPvTH9vw1U-A.jpeg)

Gostaria de compartilhar uma das minhas descobertas de HPP onde consegui assumir uma conta usando essa vulnerabilidade.

**Como encontrei essa vulnerabilidade ?**

1. Fui para uma p√°gina de login daquele programa, ele pediu um OTP para login

Enviar OTP

![Image for post](https://miro.medium.com/max/600/1\*s-M09yWBylPVEhA6\_e0nSw.jpeg)

2\. Digitei um email e cliquei em "Enviar Senha de Uso √önico"

3\. Interceptei a solicita√ß√£o usando o burp suite e adicionei outro email usando o mesmo par√¢metro (criei dois emails para fins de teste)Solicita√ß√£o Burp

![Image for post](https://miro.medium.com/max/1737/1\*z\_RpnZyKHLn6B4Lz4ONT3Q.png)

4\. Recebi um OTP de shrey‚Ä¶‚Ä¶@gmail.com na minha outra conta radhika‚Ä¶..@gmail.com OTP

![Image for post](https://miro.medium.com/max/784/1\*a671GrRtiMYfLUL7nURD8Q.png)

5\. Copiei o OTP e fui para shrey‚Ä¶.@gmail.com na tela de login do programa, inseri este OTP e entrei na conta.Tomada de Conta

![Image for post](https://miro.medium.com/max/1698/1\*Ux-ILfCr\_Mk\_xmzzsXwNnA.jpeg)

Ent√£o o que aconteceu aqui √© que a aplica√ß√£o back-end pegou o valor do primeiro par√¢metro ‚Äú**email**‚Äù para gerar um OTP e usou o valor do segundo par√¢metro ‚Äú**email**‚Äù para fornecer o valor, o que significa que um OTP de shrey‚Ä¶.@gmail.com foi enviado para radhika‚Ä¶.@gmail.com.

**NOTA :** Aqui em uma imagem no 4¬∫ passo onde recebi um OTP para radhika‚Ä¶.@gmail.com, fiquei confuso porque a mensagem dizia Oi Radhika, ent√£o pensei que o par√¢metro n√£o estava polu√≠do e o OTP era para radhika‚Ä¶.@gmail.com, mas quando tentei o OTP em shrey‚Ä¶.@gmail.com funcionou.

## Flask & PHP

Neste [**relato**](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution) voc√™ pode ver como uma consulta HTTP como `a=1&a=2` ser√° interpretada de forma diferente pelo Flask e PHP rodando em um Apache HTTP Server. No Flask, o par√¢metro ser√° `1` (primeira ocorr√™ncia) enquanto no PHP ser√° `2` (√∫ltima ocorr√™ncia).

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
