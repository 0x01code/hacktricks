# Pollution de param√®tres

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

# Aper√ßu de la pollution de param√®tres HTTP (HPP)

La pollution de param√®tres HTTP (HPP) est une technique d'attaque impliquant la manipulation des param√®tres HTTP pour modifier le comportement attendu d'une application web. Ce type d'attaque est relativement simple mais peut √™tre remarquablement efficace. Bien que la manipulation des param√®tres se produise c√¥t√© serveur et ne soit pas visible pour l'utilisateur, les changements de comportement r√©sultants peuvent √™tre observ√©s c√¥t√© client.

## Exemple de pollution de param√®tres HTTP (HPP)

Consid√©rons une URL de transaction standard pour une application bancaire :

**URL :** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Cette URL initie une transaction de 10 000 de accountA √† accountB. Cependant, l'introduction d'un autre param√®tre `from` comme suit :

**URL manipul√©e :** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

pourrait entra√Æner la d√©duction de la transaction √† partir de accountC au lieu de accountA. Cela illustre comment HPP peut √™tre utilis√© pour manipuler les param√®tres. Notamment, cette vuln√©rabilit√© n'est pas limit√©e aux requ√™tes GET mais peut √©galement √™tre exploit√©e dans les requ√™tes POST √† travers diverses fonctionnalit√©s telles que les changements de mot de passe, l'authentification √† deux facteurs ou les transmissions de cl√©s API.

Il est important de reconna√Ætre que l'analyse des param√®tres d√©pend de la technologie web sp√©cifique utilis√©e. Des outils comme [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) peuvent √™tre utilis√©s pour identifier les technologies web et comprendre leurs comportements d'analyse des param√®tres.

## PHP

Un exemple notable d'exploitation de HPP impliquait les √©tapes suivantes :

1. **Manipulation de l'OTP :**
- Une page de connexion demandant un OTP √©tait la cible.
- Apr√®s avoir envoy√© une demande d'OTP, la requ√™te HTTP suivante a √©t√© intercept√©e √† l'aide de Burp Suite.
- Un autre e-mail a √©t√© ajout√© √† la requ√™te, dupliquant efficacement le param√®tre `email`.
- L'OTP destin√© au premier e-mail a √©t√© envoy√© par erreur au deuxi√®me e-mail, permettant un acc√®s non autoris√© au premier compte.

Cet incident souligne comment l'application backend a trait√© les param√®tres `email`, en utilisant le premier pour la g√©n√©ration de l'OTP et le second pour la livraison de l'OTP.

# Analyse des param√®tres dans Flask & PHP

Les diff√©rentes technologies web analysent les param√®tres de mani√®re unique. Par exemple, avec une requ√™te comme `a=1&a=2`, Flask et PHP interpr√©teront le param√®tre diff√©remment :

- **Flask :** Prend la premi√®re occurrence (a=1).
- **PHP (sur le serveur HTTP Apache) :** Prend la derni√®re occurrence (a=2).

Cette diff√©rence dans la gestion des param√®tres peut avoir un impact significatif sur le comportement de l'application et sa vuln√©rabilit√© aux attaques HPP. Plus de d√©tails √† ce sujet peuvent √™tre trouv√©s dans [cette analyse](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution).

# R√©f√©rences
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
