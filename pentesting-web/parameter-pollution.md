# Parameter Pollution

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>

# √úbersicht √ºber HTTP-Parameterverunreinigung (HPP)

HTTP-Parameterverunreinigung (HPP) ist eine Technik, bei der Angreifer HTTP-Parameter manipulieren, um das Verhalten einer Webanwendung auf ungewollte Weise zu √§ndern. Diese Manipulation erfolgt durch Hinzuf√ºgen, √Ñndern oder Duplizieren von HTTP-Parametern. Die Auswirkungen dieser Manipulationen sind f√ºr den Benutzer nicht direkt sichtbar, k√∂nnen jedoch die Funktionalit√§t der Anwendung auf der Serverseite erheblich ver√§ndern und sich auf der Clientseite bemerkbar machen.

## Beispiel f√ºr HTTP-Parameterverunreinigung (HPP)

Eine URL f√ºr eine Bankanwendungstransaktion:

- **Urspr√ºngliche URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Durch Hinzuf√ºgen eines zus√§tzlichen `from`-Parameters:

- **Manipulierte URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

Die Transaktion kann f√§lschlicherweise auf `accountC` anstelle von `accountA` belastet werden, was das Potenzial von HPP zur Manipulation von Transaktionen oder anderen Funktionen wie Passwortr√ºcksetzungen, 2FA-Einstellungen oder API-Schl√ºsselanforderungen zeigt.

### Technologiespezifische Parameteranalyse

- Die Art und Weise, wie Parameter analysiert und priorisiert werden, h√§ngt von der zugrunde liegenden Webtechnologie ab und beeinflusst, wie HPP ausgenutzt werden kann.
- Tools wie [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) helfen dabei, diese Technologien und ihr Analyseverhalten zu identifizieren.

## PHP und HPP-Ausnutzung

**Fall von OTP-Manipulation:**

- **Kontext:** Ein Anmeldeverfahren, das eine Einmalpasswort (OTP) erfordert, wurde ausgenutzt.
- **Methode:** Indem sie den OTP-Anforderung mit Tools wie Burp Suite abfangen, haben Angreifer den `email`-Parameter in der HTTP-Anforderung dupliziert.
- **Ergebnis:** Das f√ºr die urspr√ºngliche E-Mail vorgesehene OTP wurde stattdessen an die zweite angegebene E-Mail-Adresse in der manipulierten Anforderung gesendet. Diese Schwachstelle erm√∂glichte einen unbefugten Zugriff, indem die beabsichtigte Sicherheitsma√ünahme umgangen wurde.

Dieses Szenario verdeutlicht ein schwerwiegendes Vers√§umnis in der Backend-Anwendung, das den ersten `email`-Parameter f√ºr die OTP-Generierung verarbeitet, aber den letzten f√ºr die Zustellung verwendet hat.

**Fall von API-Schl√ºssel-Manipulation:**

- **Szenario:** Eine Anwendung erm√∂glicht Benutzern die Aktualisierung ihres API-Schl√ºssels √ºber eine Profil-Einstellungsseite.
- **Angriffsvektor:** Ein Angreifer entdeckt, dass er durch Anh√§ngen eines zus√§tzlichen `api_key`-Parameters an die POST-Anforderung das Ergebnis der API-Schl√ºssel-Aktualisierungsfunktion manipulieren kann.
- **Technik:** Unter Verwendung eines Tools wie Burp Suite erstellt der Angreifer eine Anforderung, die zwei `api_key`-Parameter enth√§lt: einen legitimen und einen b√∂sartigen. Der Server aktualisiert nur das letzte Auftreten und verwendet den vom Angreifer angegebenen Wert f√ºr den API-Schl√ºssel.
- **Ergebnis:** Der Angreifer erh√§lt die Kontrolle √ºber die API-Funktionalit√§t des Opfers und kann potenziell unbefugt auf private Daten zugreifen oder diese √§ndern.

Dieses Beispiel unterstreicht die Notwendigkeit einer sicheren Parameterverarbeitung, insbesondere bei Funktionen von so gro√üer Bedeutung wie der Verwaltung von API-Schl√ºsseln.

## Parameteranalyse: Flask vs. PHP

Die Art und Weise, wie Webtechnologien doppelte HTTP-Parameter behandeln, variiert und beeinflusst ihre Anf√§lligkeit f√ºr HPP-Angriffe:

- **Flask:** Nimmt den Wert des ersten Parameters an, den es findet, z.B. `a=1` in einer Abfragezeichenfolge `a=1&a=2`, wobei die erste Instanz Vorrang vor den nachfolgenden Duplikaten hat.
- **PHP (auf Apache HTTP Server):** Priorisiert hingegen den letzten Parameterwert und w√§hlt in diesem Beispiel `a=2`. Dieses Verhalten kann unbeabsichtigt HPP-Angriffe erleichtern, indem der manipulierte Parameter des Angreifers √ºber den urspr√ºnglichen Parameter gestellt wird.

## Referenzen
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
