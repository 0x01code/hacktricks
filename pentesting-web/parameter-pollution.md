# Polui√ß√£o de Par√¢metros

<details>

<summary><strong>Aprenda hacking na AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

# Vis√£o Geral da Polui√ß√£o de Par√¢metros HTTP (HPP)

A Polui√ß√£o de Par√¢metros HTTP (HPP) √© uma t√©cnica em que os atacantes manipulam os par√¢metros HTTP para alterar o comportamento de uma aplica√ß√£o web de maneiras n√£o intencionais. Essa manipula√ß√£o √© feita adicionando, modificando ou duplicando os par√¢metros HTTP. O efeito dessas manipula√ß√µes n√£o √© diretamente vis√≠vel para o usu√°rio, mas pode alterar significativamente a funcionalidade da aplica√ß√£o no lado do servidor, com impactos observ√°veis no lado do cliente.

## Exemplo de Polui√ß√£o de Par√¢metros HTTP (HPP)

Uma URL de transa√ß√£o de aplicativo banc√°rio:

- **URL Original:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Inserindo um par√¢metro `from` adicional:

- **URL Manipulada:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

A transa√ß√£o pode ser cobrada incorretamente para `accountC` em vez de `accountA`, demonstrando o potencial do HPP para manipular transa√ß√µes ou outras funcionalidades, como redefini√ß√µes de senha, configura√ß√µes de 2FA ou solicita√ß√µes de chave de API.

### **An√°lise de Par√¢metros Espec√≠ficos de Tecnologia**

- A forma como os par√¢metros s√£o analisados e priorizados depende da tecnologia web subjacente, afetando como o HPP pode ser explorado.
- Ferramentas como [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) ajudam a identificar essas tecnologias e seus comportamentos de an√°lise.

## Explora√ß√£o de PHP e HPP

**Caso de Manipula√ß√£o de OTP:**

- **Contexto:** Um mecanismo de login que requer um One-Time Password (OTP) foi explorado.
- **M√©todo:** Ao interceptar a solicita√ß√£o de OTP usando ferramentas como Burp Suite, os atacantes duplicaram o par√¢metro `email` na solicita√ß√£o HTTP.
- **Resultado:** O OTP, destinado ao email inicial, foi enviado para o segundo endere√ßo de email especificado na solicita√ß√£o manipulada. Essa falha permitiu acesso n√£o autorizado ao contornar a medida de seguran√ßa pretendida.

Este cen√°rio destaca uma falha cr√≠tica no backend da aplica√ß√£o, que processou o primeiro par√¢metro `email` para gera√ß√£o de OTP, mas usou o √∫ltimo para entrega.

**Caso de Manipula√ß√£o de Chave de API:**

- **Cen√°rio:** Uma aplica√ß√£o permite que os usu√°rios atualizem sua chave de API por meio de uma p√°gina de configura√ß√µes de perfil.
- **Vetor de Ataque:** Um atacante descobre que, ao adicionar um par√¢metro `api_key` adicional √† solicita√ß√£o POST, pode manipular o resultado da fun√ß√£o de atualiza√ß√£o da chave de API.
- **T√©cnica:** Utilizando uma ferramenta como Burp Suite, o atacante cria uma solicita√ß√£o que inclui dois par√¢metros `api_key`: um leg√≠timo e um malicioso. O servidor, processando apenas a √∫ltima ocorr√™ncia, atualiza a chave de API para o valor fornecido pelo atacante.
- **Resultado:** O atacante obt√©m controle sobre a funcionalidade da API da v√≠tima, potencialmente acessando ou modificando dados privados sem autoriza√ß√£o.

Este exemplo destaca ainda mais a necessidade de manipula√ß√£o segura de par√¢metros, especialmente em recursos t√£o cr√≠ticos quanto o gerenciamento de chaves de API.

## An√°lise de Par√¢metros: Flask vs. PHP

A forma como as tecnologias web lidam com par√¢metros HTTP duplicados varia, afetando sua suscetibilidade a ataques de HPP:

- **Flask:** Adota o valor do primeiro par√¢metro encontrado, como `a=1` em uma string de consulta `a=1&a=2`, priorizando a inst√¢ncia inicial sobre duplicatas subsequentes.
- **PHP (no Servidor HTTP Apache):** Contrariamente, prioriza o valor do √∫ltimo par√¢metro, optando por `a=2` no exemplo dado. Esse comportamento pode facilitar inadvertidamente exploits de HPP ao honrar o par√¢metro manipulado do atacante sobre o original.

# Refer√™ncias
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<details>

<summary><strong>Aprenda hacking na AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
