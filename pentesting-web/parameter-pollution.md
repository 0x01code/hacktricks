# Polui√ß√£o de Par√¢metros

<details>

<summary><strong>Aprenda hacking na AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Especialista em Equipe Vermelha AWS do HackTricks)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

# Vis√£o Geral da Polui√ß√£o de Par√¢metros HTTP (HPP)

A Polui√ß√£o de Par√¢metros HTTP (HPP) √© uma t√©cnica de ataque que envolve a manipula√ß√£o de par√¢metros HTTP para alterar o comportamento esperado de uma aplica√ß√£o web. Esse tipo de ataque √© relativamente simples, mas pode ser surpreendentemente eficaz. Embora a manipula√ß√£o de par√¢metros ocorra no lado do servidor e n√£o seja vis√≠vel para o usu√°rio, as altera√ß√µes de comportamento resultantes podem ser observadas no lado do cliente.

##Exemplo de Polui√ß√£o de Par√¢metros HTTP (HPP)

Considere uma URL de transa√ß√£o padr√£o para uma aplica√ß√£o banc√°ria:

**URL:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

Esta URL inicia uma transa√ß√£o de 10.000 de accountA para accountB. No entanto, introduzir outro par√¢metro `from` assim:

**URL Manipulada:** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

pode resultar na dedu√ß√£o da transa√ß√£o de accountC em vez de accountA. Isso exemplifica como o HPP pode ser usado para manipular par√¢metros. Notavelmente, essa vulnerabilidade n√£o se limita a solicita√ß√µes GET, mas tamb√©m pode ser explorada em solicita√ß√µes POST em v√°rias funcionalidades, como altera√ß√µes de senha, 2FA ou transmiss√µes de chave de API.

√â importante reconhecer que a an√°lise de par√¢metros depende da tecnologia web espec√≠fica em uso. Ferramentas como [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) podem ser usadas para identificar tecnologias web e entender seus comportamentos de an√°lise de par√¢metros.

## PHP

Um exemplo not√°vel de explora√ß√£o do HPP envolveu os seguintes passos:

1. **Manipula√ß√£o de OTP:**
- Uma p√°gina de login solicitando um OTP era o alvo.
- Ap√≥s enviar uma solicita√ß√£o de OTP, a solicita√ß√£o HTTP subsequente foi interceptada usando o Burp Suite.
- Outro e-mail foi adicionado √† solicita√ß√£o, duplicando efetivamente o par√¢metro `email`.
- O OTP destinado ao primeiro e-mail foi erroneamente enviado ao segundo e-mail, permitindo o acesso n√£o autorizado √† primeira conta.

Este incidente destaca como o backend da aplica√ß√£o processou os par√¢metros `email`, utilizando o primeiro para gera√ß√£o de OTP e o segundo para entrega de OTP.

# An√°lise de Par√¢metros no Flask & PHP

Diferentes tecnologias web analisam par√¢metros de forma √∫nica. Por exemplo, com uma consulta como `a=1&a=2`, Flask e PHP interpretar√£o o par√¢metro de forma diferente:

- **Flask:** Pega a primeira ocorr√™ncia (a=1).
- **PHP (no Servidor HTTP Apache):** Pega a √∫ltima ocorr√™ncia (a=2).

Essa diferen√ßa no tratamento de par√¢metros pode impactar significativamente o comportamento da aplica√ß√£o e a vulnerabilidade a ataques de HPP. Mais detalhes sobre isso podem ser encontrados neste [artigo](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution).

# Refer√™ncias
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<details>

<summary><strong>Aprenda hacking na AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Especialista em Equipe Vermelha AWS do HackTricks)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
