# Pollution de param√®tres

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert Red Team AWS HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

# Aper√ßu de la pollution de param√®tres HTTP (HPP)

La pollution de param√®tres HTTP (HPP) est une technique o√π les attaquants manipulent les param√®tres HTTP pour modifier le comportement d'une application web de mani√®re non intentionnelle. Cette manipulation est r√©alis√©e en ajoutant, modifiant ou dupliquant des param√®tres HTTP. Les effets de ces manipulations ne sont pas directement visibles pour l'utilisateur, mais peuvent modifier significativement la fonctionnalit√© de l'application c√¥t√© serveur, avec des impacts observables c√¥t√© client.

## Exemple de pollution de param√®tres HTTP (HPP)

Une URL de transaction d'application bancaire :

- **URL d'origine :** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

En ins√©rant un param√®tre `from` suppl√©mentaire :

- **URL manipul√©e :** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

La transaction peut √™tre incorrectement factur√©e √† `accountC` au lieu de `accountA`, d√©montrant le potentiel de la HPP pour manipuler des transactions ou d'autres fonctionnalit√©s telles que les r√©initialisations de mot de passe, les param√®tres de double authentification (2FA) ou les demandes de cl√© API.

### **Analyse des param√®tres sp√©cifiques √† la technologie**

- La fa√ßon dont les param√®tres sont analys√©s et prioris√©s d√©pend de la technologie web sous-jacente, ce qui affecte la mani√®re dont la HPP peut √™tre exploit√©e.
- Des outils comme [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) aident √† identifier ces technologies et leurs comportements d'analyse.

## Exploitation de PHP et de la HPP

**Cas de manipulation OTP :**

- **Contexte :** Un m√©canisme de connexion n√©cessitant un mot de passe √† usage unique (OTP) a √©t√© exploit√©.
- **M√©thode :** En interceptant la demande OTP √† l'aide d'outils comme Burp Suite, les attaquants ont dupliqu√© le param√®tre `email` dans la demande HTTP.
- **R√©sultat :** L'OTP, destin√© √† l'e-mail initial, a √©t√© envoy√© √† la deuxi√®me adresse e-mail sp√©cifi√©e dans la demande manipul√©e. Cette faille a permis un acc√®s non autoris√© en contournant la mesure de s√©curit√© pr√©vue.

Ce sc√©nario met en lumi√®re une lacune critique dans le backend de l'application, qui traitait le premier param√®tre `email` pour la g√©n√©ration de l'OTP mais utilisait le dernier pour la livraison.

**Cas de manipulation de cl√© API :**

- **Sc√©nario :** Une application permet aux utilisateurs de mettre √† jour leur cl√© API via une page de param√®tres de profil.
- **Vecteur d'attaque :** Un attaquant d√©couvre qu'en ajoutant un param√®tre `api_key` suppl√©mentaire √† la requ√™te POST, il peut manipuler le r√©sultat de la fonction de mise √† jour de la cl√© API.
- **Technique :** En utilisant un outil comme Burp Suite, l'attaquant cr√©e une requ√™te qui inclut deux param√®tres `api_key` : un l√©gitime et un malveillant. Le serveur, ne traitant que la derni√®re occurrence, met √† jour la cl√© API avec la valeur fournie par l'attaquant.
- **R√©sultat :** L'attaquant prend le contr√¥le de la fonctionnalit√© API de la victime, potentiellement en acc√©dant ou en modifiant des donn√©es priv√©es de mani√®re non autoris√©e.

Cet exemple souligne davantage la n√©cessit√© d'une manipulation s√©curis√©e des param√®tres, en particulier dans des fonctionnalit√©s aussi critiques que la gestion des cl√©s API.

## Analyse des param√®tres : Flask vs PHP

La mani√®re dont les technologies web g√®rent les param√®tres HTTP dupliqu√©s varie, affectant leur susceptibilit√© aux attaques HPP :

- **Flask :** Adopte la premi√®re valeur de param√®tre rencontr√©e, telle que `a=1` dans une cha√Æne de requ√™te `a=1&a=2`, en priorisant l'instance initiale sur les doublons ult√©rieurs.
- **PHP (sur le serveur HTTP Apache) :** Au contraire, priorise la derni√®re valeur de param√®tre, optant pour `a=2` dans l'exemple donn√©. Ce comportement peut faciliter involontairement les exploits HPP en honorant le param√®tre manipul√© de l'attaquant par rapport √† l'original.

## R√©f√©rences
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert Red Team AWS HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
