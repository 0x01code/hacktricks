# Pollution de param√®tres

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

**Copi√© depuis** [**https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654**](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)

**R√©sum√© :**

La pollution des param√®tres HTTP (HPP) consiste √† polluer les param√®tres HTTP d'une application web pour accomplir une t√¢che malveillante sp√©cifique. Cela consiste √† manipuler la fa√ßon dont un site web traite les param√®tres qu'il re√ßoit lors des requ√™tes HTTP. Cela modifie le comportement d'un site web par rapport √† son comportement pr√©vu. La pollution des param√®tres HTTP est une attaque simple mais efficace.

Lorsque vous polluez un param√®tre, le code s'ex√©cute uniquement c√¥t√© serveur, ce qui est invisible pour nous, mais nous pouvons voir les r√©sultats √† l'√©cran. Le processus interm√©diaire est une bo√Æte noire.

Par exemple, il y a une URL https://www.anybank.com/send qui a trois param√®tres :

1. from :
2. to :
3. amount :

**URL : https://www.anybank.com/send/?from=accountA\&to=accountB\&amount=10000**

Maintenant, c'est une URL normale qui effectuera une transaction de 10000 de accountA √† accountB, mais que se passe-t-il si nous ajoutons un autre param√®tre identique **"from :"**

Ainsi, l'URL sera comme **https://www.anybank.com/send/?from=accountA\&to=accountB\&amount=10000\&from=accountC**

Lorsque cette URL effectuera une transaction de 10000, elle sera d√©duite du compteC plut√¥t que du compteA. C'est ainsi que vous manipulez les param√®tres dans une attaque de **pollution des param√®tres HTTP**. Bien que la port√©e de cette vuln√©rabilit√© ne se limite pas uniquement √† une requ√™te **GET**, vous pouvez √©galement effectuer cette attaque sur une requ√™te bas√©e sur **POST**. Vous pouvez essayer cette vuln√©rabilit√© √† de nombreux endroits comme le changement de mot de passe, la 2FA, les commentaires, le t√©l√©chargement de photo de profil, sur un param√®tre o√π la cl√© API est transmise, OTP, etc.

Lorsque vous manipulez un param√®tre, sa manipulation d√©pend de la fa√ßon dont chaque technologie web analyse ses param√®tres. Vous pouvez identifier les technologies web en utilisant "[Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/)". Ci-dessous se trouve la capture d'√©cran de certaines technologies et de leur analyse de param√®tres. Technologies et leur analyse de param√®tres

![Image pour l'article](https://miro.medium.com/max/1760/1\*POs4sP0fQVlPvTH9vw1U-A.jpeg)

J'aimerais partager l'une de mes d√©couvertes de HPP o√π j'ai pu prendre le contr√¥le d'un compte en utilisant cette vuln√©rabilit√©.

**Comment ai-je trouv√© cette vuln√©rabilit√© ?**

1. Je suis all√© sur une page de connexion de ce programme, il a demand√© un OTP pour la connexion

Envoyer un OTP

![Image pour l'article](https://miro.medium.com/max/600/1\*s-M09yWBylPVEhA6\_e0nSw.jpeg)

2. J'ai saisi un e-mail et cliqu√© sur "Envoyer un mot de passe unique"

3. J'ai intercept√© la requ√™te en utilisant Burp Suite et ajout√© un autre e-mail en utilisant le m√™me param√®tre (j'ai cr√©√© deux e-mails √† des fins de test) Requ√™te Burp

![Image pour l'article](https://miro.medium.com/max/1737/1\*z\_RpnZyKHLn6B4Lz4ONT3Q.png)

4. J'ai re√ßu un OTP de shrey‚Ä¶‚Ä¶@gmail.com sur mon autre compte radhika‚Ä¶..@gmail.com OTP

![Image pour l'article](https://miro.medium.com/max/784/1\*a671GrRtiMYfLUL7nURD8Q.png)

5. J'ai copi√© l'OTP et suis all√© sur shrey‚Ä¶.@gmail.com sur l'√©cran de connexion du programme, j'ai saisi cet OTP et j'√©tais dans le compte. Prise de contr√¥le du compte

![Image pour l'article](https://miro.medium.com/max/1698/1\*Ux-ILfCr\_Mk\_xmzzsXwNnA.jpeg)

Ce qui s'est pass√© ici, c'est que l'application c√¥t√© serveur a pris la valeur du premier param√®tre "e-mail" pour g√©n√©rer un OTP et a utilis√© la valeur du deuxi√®me param√®tre "e-mail" pour fournir la valeur, ce qui signifie qu'un OTP de shrey‚Ä¶.@gmail.com a √©t√© envoy√© √† radhika‚Ä¶.@gmail.com.

**NOTE :** Ici, sur l'image de la 4√®me √©tape o√π j'ai re√ßu un OTP √† radhika‚Ä¶.@gmail.com, j'√©tais confus car le message disait Salut Radhika, donc je pensais que le param√®tre n'√©tait pas pollu√© et que l'OTP √©tait pour radhika‚Ä¶.@gmail.com, mais quand j'ai essay√© l'OTP sur shrey‚Ä¶.@gmail.com, √ßa a fonctionn√©.
## Flask & PHP

Dans [**ce compte rendu**](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution), vous pouvez voir comment une requ√™te HTTP comme `a=1&a=2` sera interpr√©t√©e diff√©remment par Flask et PHP s'ex√©cutant sur un serveur Apache HTTP. Dans Flask, le param√®tre sera `1` (premi√®re occurrence) tandis que dans PHP, il sera `2` (derni√®re occurrence).

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
