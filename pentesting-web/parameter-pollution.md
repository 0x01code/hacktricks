# Pollution de Param√®tres

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PRs aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

**Copi√© depuis** [**https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654**](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)

**R√©sum√© :**

La Pollution de Param√®tres HTTP (HPP) consiste √† polluer les param√®tres HTTP d'une application web pour r√©aliser une t√¢che malveillante sp√©cifique. Cela se r√©f√®re √† la manipulation de la mani√®re dont un site web traite les param√®tres qu'il re√ßoit pendant les requ√™tes HTTP. Cela change le comportement d'un site web de celui qui √©tait pr√©vu. La pollution de param√®tres HTTP est une attaque simple mais efficace.

Lorsque vous polluez un param√®tre, le code s'ex√©cute uniquement c√¥t√© serveur, ce qui est invisible pour nous, mais nous pouvons voir les r√©sultats sur notre √©cran. Le processus interm√©diaire est une bo√Æte noire.

Par exemple, il y a une URL https://www.anybank.com/send qui a trois param√®tres :

1. from :
2. to :
3. amount :

**URL : https://www.anybank.com/send/?from=accountA\&to=accountB\&amount=10000**

Maintenant, c'est une URL normale qui proc√©dera √† une transaction de 10000 de accountA √† accountB, mais que se passe-t-il si nous ajoutons un autre param√®tre identique **‚Äúfrom :‚Äù**

Donc l'URL sera comme **https://www.anybank.com/send/?from=accountA\&to=accountB\&amount=10000\&from=accountC**

Lorsque cette URL proc√©dera √† une transaction de 10000, elle sera d√©duite de accountC plut√¥t que de accountA. C'est ainsi que vous manipulez les param√®tres dans une attaque de **Pollution de Param√®tres HTTP**. Bien que la port√©e de cette vuln√©rabilit√© ne soit pas limit√©e uniquement aux requ√™tes **GET**, vous pouvez √©galement r√©aliser cette attaque sur une requ√™te bas√©e sur **POST**. Vous pouvez essayer cette vuln√©rabilit√© dans de nombreux endroits comme le changement de mot de passe, la 2FA, les commentaires, le t√©l√©chargement de photo de profil, sur un param√®tre o√π la cl√© API est pass√©e, l'OTP, etc.

Lorsque vous manipulez un param√®tre, sa manipulation d√©pend de la mani√®re dont chaque technologie web analyse ses param√®tres. Vous pouvez identifier les technologies web en utilisant ‚Äú[Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/)‚Äù. Ci-dessous la capture d'√©cran de certaines technologies et de leur analyse de param√®tres.Technologies et leur analyse de param√®tres

![Image for post](https://miro.medium.com/max/1760/1\*POs4sP0fQVlPvTH9vw1U-A.jpeg)

Je voudrais partager une de mes d√©couvertes de HPP o√π j'ai pu prendre le contr√¥le d'un compte en utilisant cette vuln√©rabilit√©.

**Comment ai-je trouv√© cette vuln√©rabilit√© ?**

1. Je suis all√© sur une page de connexion de ce programme, il a demand√© un OTP pour se connecter

Envoyer OTP

![Image for post](https://miro.medium.com/max/600/1\*s-M09yWBylPVEhA6\_e0nSw.jpeg)

2\. J'ai tap√© un email et cliqu√© sur "Envoyer un mot de passe √† usage unique"

3\. J'ai intercept√© la requ√™te en utilisant burp suite et ajout√© un autre email en utilisant le m√™me param√®tre (j'ai cr√©√© deux emails √† des fins de test)Requ√™te Burp

![Image for post](https://miro.medium.com/max/1737/1\*z\_RpnZyKHLn6B4Lz4ONT3Q.png)

4\. J'ai re√ßu un OTP de shrey‚Ä¶‚Ä¶@gmail.com sur mon autre compte radhika‚Ä¶..@gmail.com OTP

![Image for post](https://miro.medium.com/max/784/1\*a671GrRtiMYfLUL7nURD8Q.png)

5\. J'ai copi√© l'OTP et suis all√© sur shrey‚Ä¶.@gmail.com sur l'√©cran de connexion de ce programme, j'ai entr√© cet OTP et j'√©tais dans le compte.Prise de Contr√¥le du Compte

![Image for post](https://miro.medium.com/max/1698/1\*Ux-ILfCr\_Mk\_xmzzsXwNnA.jpeg)

Alors ce qui s'est pass√© ici, c'est que l'application back-end a pris la valeur du premier param√®tre "**email**" pour g√©n√©rer un OTP et a utilis√© la valeur du second param√®tre "**email**" pour fournir la valeur, ce qui signifie qu'un OTP de shrey‚Ä¶.@gmail.com a √©t√© envoy√© √† radhika‚Ä¶.@gmail.com.

**NOTE :** Ici, dans une image √† la 4√®me √©tape o√π j'ai re√ßu un OTP √† radhika‚Ä¶.@gmail.com, j'√©tais confus parce que le message disait Bonjour Radhika, donc je pensais que le param√®tre n'√©tait pas pollu√© et que l'OTP √©tait pour radhika‚Ä¶.@gmail.com mais quand j'ai essay√© l'OTP sur shrey‚Ä¶.@gmail.com, cela a fonctionn√©.

## Flask & PHP

Dans [**ce compte-rendu**](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution), vous pouvez voir comment une requ√™te HTTP comme `a=1&a=2` sera interpr√©t√©e diff√©remment par Flask et PHP fonctionnant sur un serveur HTTP Apache. Dans Flask, le param√®tre sera `1` (premi√®re occurrence) tandis que dans PHP, il sera `2` (derni√®re occurrence).

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PRs aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
