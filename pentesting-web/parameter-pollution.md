# Contaminaci√≥n de Par√°metros

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

**Copiado de** [**https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654**](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)

**Resumen:**

La Contaminaci√≥n de Par√°metros HTTP (HPP) significa contaminar los par√°metros HTTP de una aplicaci√≥n web para lograr una tarea maliciosa espec√≠fica. Se refiere a manipular c√≥mo un sitio web trata los par√°metros que recibe durante las solicitudes HTTP. Cambia el comportamiento de un sitio web de su intenci√≥n original. La contaminaci√≥n de par√°metros HTTP es un tipo de ataque simple pero efectivo.

Cuando contaminas cualquier par√°metro, el c√≥digo solo se ejecuta en el lado del servidor, que es invisible para nosotros, pero podemos ver los resultados en nuestra pantalla. El proceso intermedio es una caja negra.

Por ejemplo, hay una URL https://www.anybank.com/send que tiene tres par√°metros:

1. from:
2. to:
3. amount:

**URL: https://www.anybank.com/send/?from=accountA\&to=accountB\&amount=10000**

Ahora esta es una URL normal que proceder√° una transacci√≥n de 10000 de accountA a accountB pero ¬øqu√© pasa si agregamos otro par√°metro igual **‚Äúfrom:‚Äù**?

Entonces la URL ser√° como **https://www.anybank.com/send/?from=accountA\&to=accountB\&amount=10000\&from=accountC**

Cuando esta URL proceda una transacci√≥n de 10000, se deducir√° de accountC en lugar de accountA. As√≠ es como manipulas los par√°metros en un ataque de **Contaminaci√≥n de Par√°metros HTTP**. Aunque el alcance de esta vulnerabilidad no se limita solo a solicitudes **GET**, tambi√©n puedes realizar este ataque en una solicitud basada en **POST**. Puedes probar esta vulnerabilidad en muchos lugares como cambio de contrase√±a, 2FA, comentarios, subida de foto de perfil, en un par√°metro donde se pasa la clave API, OTP, etc.

Cuando manipulas cualquier par√°metro, su manipulaci√≥n depende de c√≥mo cada tecnolog√≠a web est√° analizando sus par√°metros. Puedes identificar tecnolog√≠as web usando ‚Äú[Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/)‚Äù. A continuaci√≥n se muestra la captura de pantalla de algunas tecnolog√≠as y su an√°lisis de par√°metros. Tecnolog√≠as y su an√°lisis de par√°metros

![Imagen para el post](https://miro.medium.com/max/1760/1\*POs4sP0fQVlPvTH9vw1U-A.jpeg)

Me gustar√≠a compartir uno de mis hallazgos de HPP donde pude tomar control de una cuenta usando esta vulnerabilidad.

**¬øC√≥mo encontr√© esta vulnerabilidad?**

1. Fui a una p√°gina de inicio de sesi√≥n de ese programa, pidi√≥ un OTP para iniciar sesi√≥n

Enviar OTP

![Imagen para el post](https://miro.medium.com/max/600/1\*s-M09yWBylPVEhA6\_e0nSw.jpeg)

2\. Escrib√≠ un correo electr√≥nico y hice clic en "Enviar Contrase√±a de Un Solo Uso"

3\. Intercept√© la solicitud usando burp suite y agregu√© otro correo electr√≥nico usando el mismo par√°metro (cre√© dos correos electr√≥nicos para prop√≥sitos de prueba) Solicitud de Burp

![Imagen para el post](https://miro.medium.com/max/1737/1\*z\_RpnZyKHLn6B4Lz4ONT3Q.png)

4\. Recib√≠ un OTP de shrey‚Ä¶‚Ä¶@gmail.com en mi otra cuenta radhika‚Ä¶..@gmail.com OTP

![Imagen para el post](https://miro.medium.com/max/784/1\*a671GrRtiMYfLUL7nURD8Q.png)

5\. Copi√© el OTP y fui a shrey‚Ä¶.@gmail.com en la pantalla de inicio de sesi√≥n de ese programa, ingres√© este OTP y estaba dentro de la cuenta. Toma de Cuenta

![Imagen para el post](https://miro.medium.com/max/1698/1\*Ux-ILfCr\_Mk\_xmzzsXwNnA.jpeg)

Entonces, lo que sucedi√≥ aqu√≠ es que la aplicaci√≥n de back-end tom√≥ el valor del primer par√°metro "**email**" para generar un OTP y us√≥ el valor del segundo par√°metro "**email**" para suministrar el valor, lo que significa que un OTP de shrey‚Ä¶.@gmail.com fue enviado a radhika‚Ä¶.@gmail.com.

**NOTA:** Aqu√≠ en una imagen en el 4¬∫ paso donde recib√≠ un OTP a radhika‚Ä¶.@gmail.com estaba confundido porque el mensaje dec√≠a Hola Radhika, as√≠ que pens√© que el par√°metro no estaba contaminado y el OTP era para radhika‚Ä¶.@gmail.com pero cuando prob√© el OTP en shrey‚Ä¶.@gmail.com funcion√≥.

## Flask & PHP

En [**este informe**](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution) puedes ver c√≥mo una consulta HTTP como `a=1&a=2` ser√° interpretada de manera diferente por Flask y PHP ejecut√°ndose en un Apache HTTP Server. En Flask, el par√°metro ser√° `1` (primera ocurrencia) mientras que en PHP ser√° `2` (√∫ltima ocurrencia).

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
