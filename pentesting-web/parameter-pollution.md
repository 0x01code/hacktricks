# Pollution de Param√®tres

{% hint style="success" %}
Apprenez et pratiquez le Hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le Hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supportez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


# Vue d'ensemble de la Pollution de Param√®tres HTTP (HPP)

La Pollution de Param√®tres HTTP (HPP) est une technique o√π les attaquants manipulent les param√®tres HTTP pour changer le comportement d'une application web de mani√®re inattendue. Cette manipulation se fait en ajoutant, modifiant ou dupliquant des param√®tres HTTP. L'effet de ces manipulations n'est pas directement visible pour l'utilisateur mais peut alt√©rer de mani√®re significative la fonctionnalit√© de l'application c√¥t√© serveur, avec des impacts observables c√¥t√© client.

## Exemple de Pollution de Param√®tres HTTP (HPP)

Une URL de transaction d'application bancaire :

- **URL d'origine :** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000`

En ins√©rant un param√®tre `from` suppl√©mentaire :

- **URL manipul√©e :** `https://www.victim.com/send/?from=accountA&to=accountB&amount=10000&from=accountC`

La transaction peut √™tre incorrectement factur√©e √† `accountC` au lieu de `accountA`, montrant le potentiel de la HPP pour manipuler des transactions ou d'autres fonctionnalit√©s telles que les r√©initialisations de mot de passe, les param√®tres 2FA ou les demandes de cl√© API.

### **Analyse des Param√®tres Sp√©cifique √† la Technologie**

- La mani√®re dont les param√®tres sont analys√©s et prioris√©s d√©pend de la technologie web sous-jacente, affectant la fa√ßon dont la HPP peut √™tre exploit√©e.
- Des outils comme [Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/) aident √† identifier ces technologies et leurs comportements d'analyse.

## Exploitation de PHP et HPP

**Cas de Manipulation d'OTP :**

- **Contexte :** Un m√©canisme de connexion n√©cessitant un Mot de Passe √† Usage Unique (OTP) a √©t√© exploit√©.
- **M√©thode :** En interceptant la demande d'OTP √† l'aide d'outils comme Burp Suite, les attaquants ont dupliqu√© le param√®tre `email` dans la requ√™te HTTP.
- **R√©sultat :** L'OTP, destin√© √† l'email initial, a √©t√© envoy√© √† la deuxi√®me adresse email sp√©cifi√©e dans la requ√™te manipul√©e. Ce d√©faut a permis un acc√®s non autoris√© en contournant la mesure de s√©curit√© pr√©vue.

Ce sc√©nario met en √©vidence une n√©gligence critique dans le backend de l'application, qui a trait√© le premier param√®tre `email` pour la g√©n√©ration d'OTP mais a utilis√© le dernier pour la livraison.

**Cas de Manipulation de Cl√© API :**

- **Sc√©nario :** Une application permet aux utilisateurs de mettre √† jour leur cl√© API via une page de param√®tres de profil.
- **Vecteur d'attaque :** Un attaquant d√©couvre qu'en ajoutant un param√®tre `api_key` suppl√©mentaire √† la requ√™te POST, il peut manipuler le r√©sultat de la fonction de mise √† jour de la cl√© API.
- **Technique :** En utilisant un outil comme Burp Suite, l'attaquant cr√©e une requ√™te qui inclut deux param√®tres `api_key` : un l√©gitime et un malveillant. Le serveur, ne traitant que la derni√®re occurrence, met √† jour la cl√© API avec la valeur fournie par l'attaquant.
- **R√©sultat :** L'attaquant prend le contr√¥le de la fonctionnalit√© API de la victime, acc√©dant ou modifiant potentiellement des donn√©es priv√©es sans autorisation.

Cet exemple souligne encore la n√©cessit√© d'une gestion s√©curis√©e des param√®tres, en particulier dans des fonctionnalit√©s aussi critiques que la gestion des cl√©s API.

## Analyse des Param√®tres : Flask vs. PHP

La mani√®re dont les technologies web g√®rent les param√®tres HTTP dupliqu√©s varie, affectant leur susceptibilit√© aux attaques HPP :

- **Flask :** Adopte la premi√®re valeur de param√®tre rencontr√©e, comme `a=1` dans une cha√Æne de requ√™te `a=1&a=2`, priorisant l'instance initiale sur les duplicatas suivants.
- **PHP (sur Apache HTTP Server) :** Au contraire, priorise la derni√®re valeur de param√®tre, optant pour `a=2` dans l'exemple donn√©. Ce comportement peut involontairement faciliter les exploits HPP en honorant le param√®tre manipul√© par l'attaquant plut√¥t que l'original.

## R√©f√©rences
* [https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)
* [https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution)

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


{% hint style="success" %}
Apprenez et pratiquez le Hacking AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le Hacking GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Supportez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop) !
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez-nous sur** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de hacking en soumettant des PRs aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}
