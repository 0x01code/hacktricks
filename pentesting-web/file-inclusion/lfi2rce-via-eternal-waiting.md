# LFI2RCE —á–µ—Ä–µ–∑ –≤—ñ—á–Ω–µ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, –∫–æ–ª–∏ —Ñ–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –≤ PHP (–Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ü—å–æ–≥–æ –Ω–µ –æ—á—ñ–∫—É—î—Ç—å—Å—è), –≤—ñ–Ω —Å—Ç–≤–æ—Ä–∏—Ç—å —Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ñ–∞–π–ª —É `/tmp` –∑ —ñ–º'—è–º, —Ç–∞–∫–∏–º —è–∫ **`php[a-zA-Z0-9]{6}`**, —Ö–æ—á–∞ —è –±–∞—á–∏–≤ –¥–µ—è–∫—ñ –æ–±—Ä–∞–∑–∏ Docker, –¥–µ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏ –Ω–µ –º—ñ—Å—Ç—è—Ç—å —Ü–∏—Ñ—Ä.

–ü—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–º—É –≤–∫–ª—é—á–µ–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤, **—è–∫—â–æ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤–∫–ª—é—á–∏—Ç–∏ —Ü–µ–π –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π —Ñ–∞–π–ª, –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ RCE**.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º **PHP –¥–æ–∑–≤–æ–ª—è—î –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ª–∏—à–µ 20 —Ñ–∞–π–ª—ñ–≤ –∑–∞ –æ–¥–∏–Ω –∑–∞–ø–∏—Ç** (–≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ `/etc/php/<version>/apache2/php.ini`):
```
; Maximum number of files that can be uploaded via a single request
max_file_uploads = 20
```
–¢–∞–∫–æ–∂, **–∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö —ñ–º–µ–Ω —Ñ–∞–π–ª—ñ–≤ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 62\*62\*62\*62\*62\*62 = 56800235584**

### –Ü–Ω—à—ñ —Ç–µ—Ö–Ω—ñ–∫–∏

–Ü–Ω—à—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ –ø–æ–ª—è–≥–∞—é—Ç—å —É –∞—Ç–∞–∫–∞—Ö –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ PHP (–≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ, —è–∫—â–æ –≤–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç–µ –ª–∏—à–µ –æ—Å—Ç–∞–Ω–Ω—é —á–∞—Å—Ç–∏–Ω—É —à–ª—è—Ö—É), —Ä–æ–∑–∫—Ä–∏—Ç—Ç—ñ —à–ª—è—Ö—É –¥–æ —Ñ–∞–π–ª—É, –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—ñ –æ—á—ñ–∫—É–≤–∞–Ω–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ –∞–±–æ **–ø—Ä–∏–∑–≤–æ–¥–∂–µ–Ω–Ω—ñ PHP –¥–æ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ–π–Ω–æ—ó –ø–æ–º–∏–ª–∫–∏, —â–æ–± —Ç–∏–º—á–∞—Å–æ–≤—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —Ñ–∞–π–ª–∏ –Ω–µ –≤–∏–¥–∞–ª—è–ª–∏—Å—è**.\
–¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ **–¥—É–∂–µ —Å—Ö–æ–∂–∞ –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—é, –∞–ª–µ –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ –Ω—É–ª—å-–¥–µ–Ω—å**.

### –¢–µ—Ö–Ω—ñ–∫–∞ –≤—ñ—á–Ω–æ–≥–æ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è

–£ —Ü—ñ–π —Ç–µ—Ö–Ω—ñ—Ü—ñ **–Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ª–∏—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤—ñ–¥–Ω–æ—Å–Ω–∏–π —à–ª—è—Ö**. –Ø–∫—â–æ –Ω–∞–º –≤–¥–∞—Å—Ç—å—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª–∏ —ñ –∑—Ä–æ–±–∏—Ç–∏ **LFI –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è**, —É –Ω–∞—Å –±—É–¥–µ "–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —á–∞—Å—É" –¥–ª—è **–ø–µ—Ä–µ–±–æ—Ä—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤** —Ç–∞ **–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è** –±—É–¥—å-—è–∫–æ–≥–æ –∑ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö.

**–ü–µ—Ä–µ–≤–∞–≥–∏ —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏**:

* –í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ª–∏—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤—ñ–¥–Ω–æ—Å–Ω–∏–π —à–ª—è—Ö –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ include
* –ù–µ –ø–æ—Ç—Ä–µ–±—É—î nginx –∞–±–æ –Ω–µ–æ—á—ñ–∫—É–≤–∞–Ω–æ–≥–æ —Ä—ñ–≤–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ —Ñ–∞–π–ª—ñ–≤ –∂—É—Ä–Ω–∞–ª—É
* –ù–µ –ø–æ—Ç—Ä–µ–±—É—î 0-–¥–Ω—è –¥–ª—è –≤–∏–∫–ª–∏–∫—É —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ–π–Ω–æ—ó –ø–æ–º–∏–ª–∫–∏
* –ù–µ –ø–æ—Ç—Ä–µ–±—É—î —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è —à–ª—è—Ö—É

**–û—Å–Ω–æ–≤–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏** —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏:

* –ü–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± –±—É–ª–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ñ–∞–π–ª–∏ (—ó—Ö –º–æ–∂–µ –±—É—Ç–∏ –±—ñ–ª—å—à–µ)
* **–ë–æ–∂–µ–≤—ñ–ª—å–Ω–∞** –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö —ñ–º–µ–Ω —Ñ–∞–π–ª—ñ–≤: **56800235584**
* –Ø–∫—â–æ —Å–µ—Ä–≤–µ—Ä **–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ü–∏—Ñ—Ä–∏**, –∑–∞–≥–∞–ª—å–Ω–∞ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—å: **19770609664**
* –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º **–ª–∏—à–µ 20 —Ñ–∞–π–ª—ñ–≤** –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –∑–∞ **–æ–¥–∏–Ω –∑–∞–ø–∏—Ç**.
* **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö —Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.
* –¶–µ –æ–±–º–µ–∂–µ–Ω–Ω—è —Ä–∞–∑–æ–º –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º–∏ –º–æ–∂–µ –∑—Ä–æ–±–∏—Ç–∏ —Ü—é –∞—Ç–∞–∫—É –∑–∞–Ω–∞–¥—Ç–æ —Ç—Ä–∏–≤–∞–ª–æ—é
* **–¢–∞–π–º-–∞—É—Ç –¥–ª—è –∑–∞–ø–∏—Ç—É PHP**. –Ü–¥–µ–∞–ª—å–Ω–æ —Ü–µ –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ –≤—ñ—á–Ω–∏–º –∞–±–æ –ø–æ–≤–∏–Ω–Ω–æ –∑–∞–≤–µ—Ä—à—É–≤–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å PHP –±–µ–∑ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ç–∏–º—á–∞—Å–æ–≤–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤, —è–∫—â–æ –Ω—ñ, —Ü–µ —Ç–∞–∫–æ–∂ –±—É–¥–µ –ø—Ä–æ–±–ª–µ–º–æ—é

–û—Ç–∂–µ, —è–∫ –≤–∏ –º–æ–∂–µ—Ç–µ **–∑—Ä–æ–±–∏—Ç–∏ –≤–∫–ª—é—á–µ–Ω–Ω—è PHP –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è**? –ü—Ä–æ—Å—Ç–æ –≤–∫–ª—é—á–∏–≤—à–∏ —Ñ–∞–π–ª **`/sys/kernel/security/apparmor/revision`** (**–Ω–∞ –∂–∞–ª—å, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö Docker**).\
–°–ø—Ä–æ–±—É–π—Ç–µ —Ü–µ –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–ª–∏–∫–∞–≤—à–∏:
```bash
php -a # open php cli
include("/sys/kernel/security/apparmor/revision");
```
## Apache2

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Apache –ø—ñ–¥—Ç—Ä–∏–º—É—î **150 –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö –ø—ñ–¥–∫–ª—é—á–µ–Ω—å**, –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º [https://ubiq.co/tech-blog/increase-max-connections-apache/](https://ubiq.co/tech-blog/increase-max-connections-apache/) –º–æ–∂–Ω–∞ –∑–±—ñ–ª—å—à–∏—Ç–∏ —Ü–µ —á–∏—Å–ª–æ –¥–æ 8000. –î–æ—Ç—Ä–∏–º—É–π—Ç–µ—Å—å —Ü—å–æ–≥–æ, —â–æ–± –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ PHP –∑ —Ü–∏–º –º–æ–¥—É–ª–µ–º: [https://www.digitalocean.com/community/tutorials/how-to-configure-apache-http-with-mpm-event-and-php-fpm-on-ubuntu-18-04](https://www.digitalocean.com/community/tutorials/how-to-configure-apache-http-with-mpm-event-and-php-fpm-on-ubuntu-18-04).

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (—è–∫ —è –±–∞—á—É –≤ –º–æ—ó—Ö —Ç–µ—Å—Ç–∞—Ö), **PHP-–ø—Ä–æ—Ü–µ—Å –º–æ–∂–µ —Ç—Ä–∏–≤–∞—Ç–∏ –≤—ñ—á–Ω–æ**.

–ó—Ä–æ–±–∏–º–æ –¥–µ—è–∫—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è:

* –ú–∏ –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **149 –ø—ñ–¥–∫–ª—é—á–µ–Ω—å**, —â–æ–± –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ **149 \* 20 = 2980 —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤** –∑ –Ω–∞—à–∏–º –≤–µ–±-—à–µ–ª–ª–æ–º.
* –ü–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **–æ—Å—Ç–∞–Ω–Ω—î –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è**, —â–æ–± **–±—Ä—É—Ç—Ñ–æ—Ä—Å–∏—Ç–∏** –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ —Ñ–∞–π–ª–∏.
* –ó—ñ —à–≤–∏–¥–∫—ñ—Å—Ç—é **10 –∑–∞–ø–∏—Ç—ñ–≤/—Å** —á–∞—Å —Å–∫–ª–∞–¥–∞—î:
* 56800235584 / 2980 / 10 / 3600 \~= **530 –≥–æ–¥–∏–Ω** (50% —à–∞–Ω—Å—ñ–≤ –∑–∞ 265 –≥–æ–¥–∏–Ω)
* (–±–µ–∑ —Ü–∏—Ñ—Ä) 19770609664 / 2980 / 10 / 3600 \~= 185 –≥–æ–¥–∏–Ω (50% —à–∞–Ω—Å—ñ–≤ –∑–∞ 93 –≥–æ–¥–∏–Ω–∏)

{% hint style="warning" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ –º–∏ **–ø–æ–≤–Ω—ñ—Å—Ç—é DoSing —ñ–Ω—à–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤**!
{% endhint %}

–Ø–∫—â–æ —Å–µ—Ä–≤–µ—Ä Apache –ø–æ–∫—Ä–∞—â–µ–Ω–∏–π —ñ –º–∏ –º–æ–∂–µ–º–æ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ **4000 –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è–º–∏** (–ø–æ–ª–æ–≤–∏–Ω–∞ —à–ª—è—Ö—É –¥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞), –º–∏ –º–æ–≥–ª–∏ –± —Å—Ç–≤–æ—Ä–∏—Ç–∏ `3999*20 = 79980` **—Ñ–∞–π–ª—ñ–≤**, —ñ **—á–∞—Å** —Å–∫–æ—Ä–æ—Ç–∏–≤—Å—è –± –¥–æ –ø—Ä–∏–±–ª–∏–∑–Ω–æ **19,7 –≥–æ–¥–∏–Ω** –∞–±–æ **6,9 –≥–æ–¥–∏–Ω** (10 –≥–æ–¥–∏–Ω, 3,5 –≥–æ–¥–∏–Ω–∏ 50% —à–∞–Ω—Å—ñ–≤).

## PHP-FMP

–Ø–∫—â–æ –∑–∞–º—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–≤–∏—á–∞–π–Ω–æ–≥–æ –º–æ–¥—É–ª—è php –¥–ª—è apache –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è PHP-—Å–∫—Ä–∏–ø—Ç—ñ–≤ **–≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î** **PHP-FMP** (—Ü–µ –ø–æ–∫—Ä–∞—â—É—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏, —Ç–æ–º—É —Ü–µ –∑–≤–∏—á–∞–π–Ω–æ –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è), —î —â–µ —â–æ—Å—å, —â–æ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è —Ç–µ—Ö–Ω—ñ–∫–∏.

PHP-FMP –¥–æ–∑–≤–æ–ª—è—î **–Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä** **`request_terminate_timeout`** –≤ **`/etc/php/<php-version>/fpm/pool.d/www.conf`**.\
–¶–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –≤–∫–∞–∑—É—î –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–µ–∫—É–Ω–¥, **–∫–æ–ª–∏** **–∑–∞–ø–∏—Ç –¥–æ PHP –ø–æ–≤–∏–Ω–µ–Ω –∑–∞–≤–µ—Ä—à–∏—Ç–∏—Å—è** (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–∏–π, –∞–ª–µ **30 —Å, —è–∫—â–æ –ø–∞—Ä–∞–º–µ—Ç—Ä —Ä–æ–∑–∫–æ–º–µ–Ω—Ç–æ–≤–∞–Ω–∏–π**). –ö–æ–ª–∏ –∑–∞–ø–∏—Ç –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è PHP –ø—Ä–æ—Ç—è–≥–æ–º –≤–∫–∞–∑–∞–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Å–µ–∫—É–Ω–¥, –≤—ñ–Ω **–∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è**. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —è–∫—â–æ –∑–∞–ø–∏—Ç –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞–≤ —Ç–∏–º—á–∞—Å–æ–≤—ñ —Ñ–∞–π–ª–∏, —á–µ—Ä–µ–∑ —Ç–µ, —â–æ **–æ–±—Ä–æ–±–∫–∞ php –±—É–ª–∞ –∑—É–ø–∏–Ω–µ–Ω–∞**, —Ü—ñ **—Ñ–∞–π–ª–∏ –Ω–µ –±—É–¥—É—Ç—å –≤–∏–¥–∞–ª–µ–Ω—ñ**. –¢–æ–º—É, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç —Ç–∞–∫–∏–º —á–∞—Å–æ–º, –≤–∏ –º–æ–∂–µ—Ç–µ **—Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–∏—Å—è—á—ñ —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤**, —è–∫—ñ –Ω–µ –±—É–¥—É—Ç—å –≤–∏–¥–∞–ª–µ–Ω—ñ, —â–æ **–ø—Ä–∏—Å–∫–æ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å —ó—Ö –ø–æ—à—É–∫—É** —ñ –∑–º–µ–Ω—à–∏—Ç—å –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å DoS –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏ —à–ª—è—Ö–æ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—Å—ñ—Ö –ø—ñ–¥–∫–ª—é—á–µ–Ω—å.

–¢–∞–∫–∏–º —á–∏–Ω–æ–º, –¥–ª—è **—É–Ω–∏–∫–Ω–µ–Ω–Ω—è DoS** –ø—Ä–∏–ø—É—Å—Ç–∏–º–æ, —â–æ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ª–∏—à–µ 100 –ø—ñ–¥–∫–ª—é—á–µ–Ω—å** –æ–¥–Ω–æ—á–∞—Å–Ω–æ, –∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —á–∞—Å –æ–±—Ä–æ–±–∫–∏ php –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **php-fmp** (`request_terminate_timeout`**)** —Å—Ç–∞–Ω–æ–≤–∏—Ç—å **30 —Å**. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –∫—ñ–ª—å–∫—ñ—Å—Ç—å **—Ç–∏–º—á–∞—Å–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤**, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ **–∑–∞ —Å–µ–∫—É–Ω–¥—É**, —Å—Ç–∞–Ω–æ–≤–∏—Ç—å `100*20/30 = 66.67`.

–û—Ç–∂–µ, –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó **10000 —Ñ–∞–π–ª—ñ–≤** –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è: **`10000/66.67 = 150 —Å`** (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó **100000 —Ñ–∞–π–ª—ñ–≤** —á–∞—Å —Å—Ç–∞–Ω–æ–≤–∏—Ç–∏–º–µ **25 —Ö–≤–∏–ª–∏–Ω**).

–ü–æ—Ç—ñ–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—ñ **100 –ø—ñ–¥–∫–ª—é—á–µ–Ω—å** –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è **–ø–æ—à—É–∫—É –±—Ä—É—Ç—Ñ–æ—Ä—Å**. –ü—Ä–∏–ø—É—Å–∫–∞—é—á–∏ —à–≤–∏–¥–∫—ñ—Å—Ç—å 300 –∑–∞–ø–∏—Ç—ñ–≤/—Å, —á–∞—Å, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Ü—å–æ–≥–æ, –Ω–∞—Å—Ç—É–ø–Ω–∏–π:

* 56800235584 / 10000 / 300 / 3600 \~= **5,25 –≥–æ–¥–∏–Ω–∏** (50% —à–∞–Ω—Å—ñ–≤ –∑–∞ 2,63 –≥–æ–¥–∏–Ω–∏)
* (–∑ 100000 —Ñ–∞–π–ª—ñ–≤) 56800235584 / 100000 / 300 / 3600 \~= **0,525 –≥–æ–¥–∏–Ω–∏** (50% —à–∞–Ω—Å—ñ–≤ –∑–∞ 0,263 –≥–æ–¥–∏–Ω–∏)

–¢–∞–∫, –º–æ–∂–ª–∏–≤–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ 100000 —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤ –Ω–∞ —Å–µ—Ä–µ–¥–Ω—å–æ—Ä–æ–∑–º—ñ—Ä–Ω–æ–º—É –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ EC2:

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –¥–ª—è —Ç–æ–≥–æ, —â–æ–± —Å–ø—Ä–∞—Ü—é–≤–∞–≤ —Ç–∞–π–º–∞—É—Ç, –±—É–¥–µ **–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –≤–∫–ª—é—á–∏—Ç–∏ —É—Ä–∞–∑–ª–∏–≤—É —Å—Ç–æ—Ä—ñ–Ω–∫—É LFI**, —â–æ–± –≤–æ–Ω–∞ –ø–æ—Ç—Ä–∞–ø–∏–ª–∞ –≤ –≤—ñ—á–Ω–∏–π —Ü–∏–∫–ª –≤–∫–ª—é—á–µ–Ω–Ω—è.
{% endhint %}

## Nginx

–ó–¥–∞—î—Ç—å—Å—è, –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º Nginx –ø—ñ–¥—Ç—Ä–∏–º—É—î **512 –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –ø—ñ–¥–∫–ª—é—á–µ–Ω—å** –æ–¥–Ω–æ—á–∞—Å–Ω–æ (—ñ —Ü–µ —á–∏—Å–ª–æ –º–æ–∂–Ω–∞ –ø–æ–∫—Ä–∞—â–∏—Ç–∏).
