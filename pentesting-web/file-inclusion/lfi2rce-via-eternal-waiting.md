# LFI2RCE рдИрдЯрд░реНрдирд▓ рд╡реЗрдЯрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдиреА рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ**ред

</details>

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЬрдм рдПрдХ рдлрд╝рд╛рдЗрд▓ PHP рдореЗрдВ рдЕрдкрд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИ (рдпрджреНрдпрдкрд┐ рдЗрд╕рдХреА рдЙрдореНрдореАрдж рдирд╣реАрдВ рд╣реИ), рддреЛ рдпрд╣ `/tmp` рдореЗрдВ рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо рд╣реЛрдЧрд╛ **`php[a-zA-Z0-9]{6}`**, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдореИрдВрдиреЗ рдХреБрдЫ рдбреЙрдХрд░ рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рджреЗрдЦрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдЙрддреНрдкрдиреНрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдЕрдВрдХ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред

рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдореНрдорд┐рд▓рди рдореЗрдВ, **рдпрджрд┐ рдЖрдк рдЙрд╕ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ RCE рдорд┐рд▓реЗрдЧреА**ред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **PHP рдХреЗрд╡рд▓ рдПрдХ рд╣реА рдЕрдиреБрд░реЛрдз рдореЗрдВ 20 рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ** (рдЗрд╕реЗ `/etc/php/<version>/apache2/php.ini` рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ):
```
; Maximum number of files that can be uploaded via a single request
max_file_uploads = 20
```
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЕрдиреНрдп рддрдХрдиреАрдХреЛрдВ рдореЗрдВ PHP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ (рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ рдкрде рдХрд╛ рдЕрдВрддрд┐рдо рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ рддреЛ рдЖрдк рдЗрд╕реЗ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ), рдлрд╝рд╛рдЗрд▓ рдХреЗ рдкрде рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рдХрд░рдирд╛, рдЕрдкреЗрдХреНрд╖рд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛, рдпрд╛ PHP рдХреЛ рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдлреЙрд▓реНрдЯ рдХрд░рд╛рдирд╛ рддрд╛рдХрд┐ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣рдЯрд╛рдИ рди рдЬрд╛рдПрдВред\
рдпрд╣ рддрдХрдиреАрдХ **рдкрд┐рдЫрд▓реА рддрдХрдиреАрдХ рдХреЗ рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИ рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рд▓рд┐рдП рдЬрд╝реАрд░реЛ рдбреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ**ред

### рдЕрд╡рд┐рдирд╛рд╢реА рдкреНрд░рддреАрдХреНрд╖рд╛ рддрдХрдиреАрдХ

рдЗрд╕ рддрдХрдиреАрдХ рдореЗрдВ **рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рд╕рдВрдмрдВрдзрд┐рдд рдкрде рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ**ред рдпрджрд┐ рд╣рдо рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ **LFI рдХреЛ рдХрднреА рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрдиреЗ рджреЗрддреЗ рд╣реИрдВ**, рддреЛ рд╣рдореЗрдВ "рдкрд░реНрдпрд╛рдкреНрдд рд╕рдордп" рд╣реЛрдЧрд╛ **рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░рдиреЗ** рдФрд░ **рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЦреЛрдЬрдиреЗ** рдХреЗ рд▓рд┐рдПред

**рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рд▓рд╛рдн**:

* рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдПрдХ рд╕рдВрдмрдВрдзрд┐рдд рдкрде рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ
* рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП nginx рдпрд╛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕реНрддрд░ рдХреА рдкрд╣реБрдБрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ
* рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдлреЙрд▓реНрдЯ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 0 рджрд┐рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ
* рдкрде рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ

рдЗрд╕ рддрдХрдиреАрдХ рдХреА **рдореБрдЦреНрдп рд╕рдорд╕реНрдпрд╛рдПрдВ** рд╣реИрдВ:

* рд╡рд┐рд╢реЗрд╖ рдлрд╝рд╛рдЗрд▓(рдлрд╝рд╛рдЗрд▓реЗрдВ) рдореМрдЬреВрдж рд╣реЛрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ (рдЗрд╕рд╕реЗ рдЕрдзрд┐рдХ рднреА рд╣реЛ рд╕рдХрддреА рд╣реИрдВ)
* рдкреЛрдЯреЗрдВрд╢рд┐рдпрд▓ рдлрд╝рд╛рдЗрд▓ рдирд╛рдореЛрдВ рдХреА **рдЕрддреНрдпрдзрд┐рдХ** рдорд╛рддреНрд░рд╛: **56800235584**
* рдпрджрд┐ рд╕рд░реНрд╡рд░ **рдЕрдВрдХ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИ**, рддреЛ рдХреБрд▓ рдкреЛрдЯреЗрдВрд╢рд┐рдпрд▓ рдорд╛рддреНрд░рд╛ рд╣реИ: **19770609664**
* рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **рдХреЗрд╡рд▓ 20 рдлрд╝рд╛рдЗрд▓реЗрдВ** рдПрдХ **рдПрдХрд▓ рдЕрдиреБрд░реЛрдз** рдореЗрдВ рдЕрдкрд▓реЛрдб рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред
* рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рд░реНрд╡рд░ рдХреА **рдЕрдзрд┐рдХрддрдо рдкрд╛рд░реНрд▓рд▓ рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛**ред
* рдЗрди рдкреВрд░реНрд╡ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕реАрдорд╛рдУрдВ рдХреЗ рд╕рд╛рде рдпрд╣ рд╣рдорд▓рд╛ рдмрд╣реБрдд рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдЪрд▓ рд╕рдХрддрд╛ рд╣реИ
* **PHP рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рд╕рдордп рд╕реАрдорд╛**ред рдЖрджрд░реНрд╢рд╡рд╛рджреА рд░реВрдк рд╕реЗ рдпрд╣ рдЕрдирдВрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдпрд╛ рдпрджрд┐ рдРрд╕рд╛ рдирд╣реАрдВ рд╣реИ, рддреЛ PHP рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдорд╛рд░ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рд╕реЗ рдЕрд╕реНрдерд╛рдпреА рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣рдЯрд╛рдИ рдирд╣реАрдВ рдЬрд╛рдПрдВрдЧреА, рдпрджрд┐ рдРрд╕рд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рднреА рдПрдХ рдкрд░реЗрд╢рд╛рдиреА рд╣реЛрдЧреА

рддреЛ, рдЖрдк рдХреИрд╕реЗ **PHP рдЗрдВрдХрд▓реВрдб рдХреЛ рдХрднреА рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ** рд╣реИрдВ? рдмрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдХреЗ **`/sys/kernel/security/apparmor/revision`** (**рджреБрдЦрдж рд╣реИ рдХрд┐ рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ**ред)

рдЗрд╕реЗ рдХреЙрд▓ рдХрд░рдХреЗ рдЖрдЬрд╝рдорд╛рдПрдВ:
```bash
php -a # open php cli
include("/sys/kernel/security/apparmor/revision");
```
## Apache2

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, Apache **150 рд╕рдордп-рд╕реАрдорд┐рдд рд╕рдВрдмрдВрдз** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, [https://ubiq.co/tech-blog/increase-max-connections-apache/](https://ubiq.co/tech-blog/increase-max-connections-apache/) рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЗрд╕ рд╕рдВрдЦреНрдпрд╛ рдХреЛ 8000 рддрдХ рдмрдврд╝рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП PHP рдХреЗ рд╕рд╛рде рдЗрд╕ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ: [https://www.digitalocean.com/community/tutorials/how-to-configure-apache-http-with-mpm-event-and-php-fpm-on-ubuntu-18-04](https://www.digitalocean.com/community/tutorials/how-to-configure-apache-http-with-mpm-event-and-php-fpm-on-ubuntu-18-04)ред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, (рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВ рдЕрдкрдиреЗ рдкрд░реАрдХреНрд╖рдгреЛрдВ рдореЗрдВ рджреЗрдЦ рд╕рдХрддрд╛ рд╣реВрдБ), **PHP рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЕрдирдВрдд рд╕рдордп рддрдХ рдЪрд▓ рд╕рдХрддреА рд╣реИ**ред

рдЪрд▓рд┐рдП рдХреБрдЫ рдЧрдгрд┐рдд рдХрд░реЗрдВ:

* рд╣рдо **149 рд╕рдВрдмрдВрдз** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╣рдо рдЕрдкрдиреЗ рд╡реЗрдмрд╢реЗрд▓ рдХреЗ рд╕рд╛рде **149 \* 20 = 2980 рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ** рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХреЗрдВред
* рдлрд┐рд░, **рдЕрдВрддрд┐рдо рд╕рдВрдмрдВрдз** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рд╣рдо рд╕рдВрднрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ **рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕** рдХрд░ рд╕рдХреЗрдВред
* **10 рдЕрдиреБрд░реЛрдз/рд╕реЗрдХрдВрдб** рдХреА рдЧрддрд┐ рдкрд░ рд╕рдордп рд╣реИрдВ:
* 56800235584 / 2980 / 10 / 3600 \~= **530 рдШрдВрдЯреЗ** (50% рдЕрд╡рд╕рд░ рдореЗрдВ 265 рдШрдВрдЯреЗ)
* (рдЕрдВрдХреЛрдВ рдХреЗ рдмрд┐рдирд╛) 19770609664 / 2980 / 10 / 3600 \~= 185 рдШрдВрдЯреЗ (50% рдЕрд╡рд╕рд░ рдореЗрдВ 93 рдШрдВрдЯреЗ)

{% hint style="warning" %}
рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдо **рдЕрдиреНрдп рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ DoS рдХрд░ рд░рд╣реЗ рд╣реИрдВ**!
{% endhint %}

рдпрджрд┐ Apache рд╕рд░реНрд╡рд░ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╣рдо **4000 рд╕рдВрдмрдВрдзреЛрдВ** (рдЕрдзрд┐рдХрддрдо рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдЖрдзреЗ рд░рд╛рд╕реНрддреЗ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдо `3999*20 = 79980` **рдлрд╝рд╛рдЗрд▓реЗрдВ** рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рд╕рдВрдЦреНрдпрд╛** рдХреЛ рд▓рдЧрднрдЧ **19.7 рдШрдВрдЯреЗ** рдпрд╛ **6.9 рдШрдВрдЯреЗ** (10 рдШрдВрдЯреЗ, 3.5 рдШрдВрдЯреЗ 50% рдЕрд╡рд╕рд░) рддрдХ рдХрдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## PHP-FMP

рдпрджрд┐ рд╡реЗрдм рдкреГрд╖реНрда рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдо PHP рдореЙрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп **PHP-FMP** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдпрд╣ рд╡реЗрдм рдкреГрд╖реНрда рдХреА рдХреБрд╢рд▓рддрд╛ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдЖрдорддреМрд░ рдкрд░ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ), рддреЛ рддрдХрдиреАрдХ рдХреЛ рд╕реБрдзрд╛рд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдФрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

PHP-FMP рдХреЛ **`/etc/php/<php-version>/fpm/pool.d/www.conf`** рдореЗрдВ **`request_terminate_timeout`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред\
рдпрд╣ рдкреИрд░рд╛рдореАрдЯрд░ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ PHP рдХреЛ рдХрд┐рддрдиреЗ рд╕реЗрдХрдВрдб рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЕрдирдВрдд рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди **30 рд╕реЗрдХрдВрдб рд╣реЛрддрд╛ рд╣реИ рдЕрдЧрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдЕрдирдЯрд┐рдХрдореЗрдВрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**)ред рдЬрдм PHP рджреНрд╡рд╛рд░рд╛ рдПрдХ рдЕрдиреБрд░реЛрдз рдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реЗрдХрдВрдб рдХреЗ рдмрд╛рдж рд╡рд╣ **рдорд░ рдЬрд╛рддрд╛ рд╣реИ**ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ, рдХрд┐ рдпрджрд┐ рдЕрдиреБрд░реЛрдз рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░ рд░рд╣рд╛ рдерд╛, рдХреНрдпреЛрдВрдХрд┐ **php рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рд░реБрдХ рдЧрдИ рдереА**, рд╡рд╣ **рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣рдЯрд╛рдИ рдирд╣реАрдВ рдЬрд╛рдПрдВрдЧреА**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рдЙрд╕ рд╕рдордп рддрдХ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк **рд╣рдЬрд╛рд░реЛрдВ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ рд╣рдЯрд╛рдИ рдирд╣реАрдВ рдЬрд╛рдПрдВрдЧреА, рдЬреЛ рдЙрдиреНрд╣реЗрдВ **рдвреВрдВрдврдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рддреЗрдЬрд╝ рдХрд░реЗрдЧреА** рдФрд░ рд╕рднреА рд╕рдВрдмрдВрдзреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдХреЛ DoS рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рдХрдо рдХрд░реЗрдЧреАред

рддреЛ, **DoS рд╕реЗ рдмрдЪрдиреЗ** рдХреЗ рд▓рд┐рдП рдорд╛рди рд▓реЗрдВ рдХрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░ рдХреЗрд╡рд▓ 100 рд╕рдВрдмрдВрдз** рдПрдХ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ рдФрд░ php-fmp (`request_terminate_timeout`**)** рджреНрд╡рд╛рд░рд╛ PHP рдХреА рдЕрдзрд┐рдХрддрдо рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╕рдордп **30 рд╕реЗрдХрдВрдб** рд╣реИред рдЗрд╕рд▓рд┐рдП, рд╕реЗрдХрдВрдб рдореЗрдВ рдЙрддреНрдкрдиреНрди рд╣реЛрдиреЗ рд╡рд╛рд▓реА **рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЛрдВ** рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣реИ `100*20/30 = 66.67`ред

рдлрд┐рд░, **10000 рдлрд╝рд╛рдЗрд▓реЗрдВ** рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЪрд╛рд╣рд┐рдП: **`10000/66.67 = 150 рд╕реЗрдХрдВрдб`** (100000 рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордп рд╣реЛрдЧрд╛ **25 рдорд┐рдирдЯ**)ред

рдлрд┐рд░, рд╣рдорд▓рд╛рд╡рд░ рдЗрди **100 рд╕рдВрдмрдВрдзреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ рдПрдХ **рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдЦреЛрдЬ** рдХрд░ рд╕рдХреЗред рд╕реЗрдХрдВрдб рдореЗрдВ 300 рдЕрдиреБрд░реЛрдз рдХреА рдЧрддрд┐ рдХреЗ рд╕
