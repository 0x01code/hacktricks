# LFI2RCE рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╢рд╛рд╢реНрд╡рдд рдкреНрд░рддреАрдХреНрд╖рд╛

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдореМрд▓рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЬрдм рдПрдХ рдлрд╝рд╛рдЗрд▓ PHP рдореЗрдВ рдЕрдкрд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИ (рдпрд╣ рдЙрдореНрдореАрдж рдирд╣реАрдВ рдереА рднреА), рддреЛ рдпрд╣ `/tmp` рдореЗрдВ рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо **`php[a-zA-Z0-9]{6}`** рдЬреИрд╕рд╛ рд╣реЛрдЧрд╛, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдореИрдВрдиреЗ рдХреБрдЫ рдбреЙрдХрд░ рдЫрд╡рд┐рдпрд╛рдБ рджреЗрдЦреА рд╣реИрдВ рдЬрд╣рд╛рдВ рдЙрддреНрдкрдиреНрди рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдВрдХ рдирд╣реАрдВ рд╕рдорд╛рдпреБрдХреНрдд рд╣реЛрддреА рд╣реИрдВред

рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рд╕рдорд╛рд╡реЗрд╢ рдореЗрдВ, **рдпрджрд┐ рдЖрдк рдЙрд╕ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдорд╛рд╡реЗрд╢рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ RCE рдорд┐рд▓реЗрдЧрд╛**ред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **PHP рдХреЗрд╡рд▓ рдПрдХ рд╣реА рдЕрдиреБрд░реЛрдз рдореЗрдВ 20 рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ** ( `/etc/php/<version>/apache2/php.ini` рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ):
```
; Maximum number of files that can be uploaded via a single request
max_file_uploads = 20
```
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, **рд╕рдВрднрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓ рдирд╛рдореЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ 62\*62\*62\*62\*62\*62 = 56800235584 рд╣реИ**

### рдЕрдиреНрдп рддрдХрдиреАрдХреЗрдВ

рдЕрдиреНрдп рддрдХрдиреАрдХреЗрдВ PHP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдкрд░ рдирд┐рд░реНрднрд░ рд╣реИрдВ (рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ рдкрде рдХреЗ рдЕрдВрддрд┐рдо рд╣рд┐рд╕реНрд╕реЗ рдХрд╛ рдирд┐рдпрдВрддреНрд░рдг рд╣реИ рддреЛ рдЖрдк рдпрд╣ рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдВрдЧреЗ), рдлрд╝рд╛рдЗрд▓ рдХреЗ рдкрде рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдирд╛, рдЕрдкреЗрдХреНрд╖рд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛, рдпрд╛ **PHP рдХреЛ рд╡рд┐рднрд╛рдЬрди рддреНрд░реБрдЯрд┐ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рд╛рдирд╛ рддрд╛рдХрд┐ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣рдЯрд╛рдИ рди рдЬрд╛рдПрдВ**ред
рдпрд╣ рддрдХрдиреАрдХ **рдкрд┐рдЫрд▓реЗ рддрдХрдиреАрдХ рдХреЗ рдмрд╣реБрдд рд╣реА рд╕рдорд╛рди рд╣реИ рд▓реЗрдХрд┐рди рдХрд┐рд╕реА рдЬрд╝реАрд░реЛ рджрд┐рди рдХреЛ рдЦреЛрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ**ред

### рд╢рд╛рд╢реНрд╡рдд рдкреНрд░рддреАрдХреНрд╖рд╛ рддрдХрдиреАрдХ

рдЗрд╕ рддрдХрдиреАрдХ рдореЗрдВ **рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рд╕рдВрдмрдВрдзрд┐рдд рдкрде рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ**ред рдпрджрд┐ рд╣рдо рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдФрд░ **LFI рдХреЛ рдХрднреА рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрдиреЗ рджреЗрдиреЗ** рдореЗрдВ рдХрд╛рдордпрд╛рдм рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ "рдкрд░реНрдпрд╛рдкреНрдд рд╕рдордп" рд╣реЛрдЧрд╛ **рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕ рдХрд░рдиреЗ** рдФрд░ **рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЦреЛрдЬрдиреЗ** рдХреЗ рд▓рд┐рдПред

**рдЗрд╕ рддрдХрдиреАрдХ рдХреЗ рд▓рд╛рдн**:

* рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдПрдХ рд╕рдВрдмрдВрдзрд┐рдд рдкрде рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ
* рдПрдирдЬрд┐рдиреНрдХреНрд╕ рдпрд╛ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╕реНрддрд░ рдХреЗ рдПрдХреНрд╕реЗрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рддрд╛рдХрд┐ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓реЗрдВ
* рд╡рд┐рднрд╛рдЬрди рддреНрд░реБрдЯрд┐ рдХрд╛ рдХрд╛рд░рдг рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЬрд╝реАрд░реЛ рджрд┐рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ
* рдкрде рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ

рдЗрд╕ рддрдХрдиреАрдХ рдХреА **рдореБрдЦреНрдп рд╕рдорд╕реНрдпрд╛рдПрдВ** рд╣реИрдВ:

* рдирд┐рд╢реНрдЪрд┐рдд рдлрд╝рд╛рдЗрд▓(рдУрдВ) рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдЕрдзрд┐рдХ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ)
* **рд╕рдВрднрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓ рдирд╛рдореЛрдВ рдХреА рдЕрддреНрдпрдзрд┐рдХ рд╕рдВрдЦреНрдпрд╛: 56800235584**
* рдпрджрд┐ рд╕рд░реНрд╡рд░ **рдЕрдВрдХ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИ** рддреЛ рдХреБрд▓ рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рддреНрд░рд╛ рд╣реИ: **19770609664**
* рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **рдХреЗрд╡рд▓ 20 рдлрд╝рд╛рдЗрд▓реЗрдВ** рдПрдХ **рдПрдХрд▓ рдЕрдиреБрд░реЛрдз** рдореЗрдВ рдЕрдкрд▓реЛрдб рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред
* рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд╕рд░реНрд╡рд░ рдХреА **рдкрд╛рд░рд▓реЗрд▓ рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХреА рдЕрдзрд┐рдХрддрдо рд╕рдВрдЦреНрдпрд╛**ред
* рдпрд╣ рд╕реАрдорд╛ рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЛрдВ рдХреЗ рд╕рд╛рде рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдЪрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛ рд╕рдХрддреА рд╣реИ
* **PHP рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рд╕рдордп рд╕реАрдорд╛**ред рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ рдпрд╣ рд╢рд╛рд╢реНрд╡рдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдпрд╛ рдпрджрд┐ рдирд╣реАрдВ, рддреЛ PHP рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╣рдЯрд╛рдП рдмрд┐рдирд╛ рдЕрд╕реНрдерд╛рдпреА рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣рдЯрд╛ рджреЗрдирд╛ рднреА рдПрдХ рдкреАрдбрд╝рд╛ рд╣реЛрдЧреАред

рддреЛ, рдЖрдк **PHP рдЗрдирдХреНрд▓реВрдб рдХреЛ рдХрднреА рд╕рдорд╛рдкреНрдд рдХреИрд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**? рдмрд╕ рдлрд╝рд╛рдЗрд▓ **`/sys/kernel/security/apparmor/revision`** рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдХреЗред (**рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ, рджреБрдГрдЦ рдХреА рдмрд╛рдд...**).

рдмрд╕ рдЗрд╕реЗ рдмреБрд▓рд╛рдХрд░ рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ:
```bash
php -a # open php cli
include("/sys/kernel/security/apparmor/revision");
```
## Apache2

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, Apache **150 рд╕рдорднрд╛рд╡рд┐рдд рдХрдиреЗрдХреНрд╢рди** рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, [https://ubiq.co/tech-blog/increase-max-connections-apache/](https://ubiq.co/tech-blog/increase-max-connections-apache/) рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЗрд╕ рд╕рдВрдЦреНрдпрд╛ рдХреЛ 8000 рддрдХ рдмрдврд╝рд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдЗрд╕ рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕рд╛рде PHP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдлреЙрд▓реЛ рдХрд░реЗрдВ: [https://www.digitalocean.com/community/tutorials/how-to-configure-apache-http-with-mpm-event-and-php-fpm-on-ubuntu-18-04](https://www.digitalocean.com/community/tutorials/how-to-configure-apache-http-with-mpm-event-and-php-fpm-on-ubuntu-18-04)ред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, (рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВ рдЕрдкрдиреЗ рдЯреЗрд╕реНрдЯ рдореЗрдВ рджреЗрдЦ рд╕рдХрддрд╛ рд╣реВрдБ), **PHP рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╢рд╛рд╢реНрд╡рдд** рд╣реЛ рд╕рдХрддреА рд╣реИред

рд╣рдо рдХреБрдЫ рдЧрдгрд┐рдд рдХрд░реЗрдВ:

* рд╣рдо **149 рдХрдиреЗрдХреНрд╢рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╣рдорд╛рд░реЗ рд╡реЗрдмрд╢реЗрд▓ рдХреЗ рд╕рд╛рде **149 \* 20 = 2980 рдЯреЗрдореНрдк рдлрд╝рд╛рдЗрд▓реЗрдВ** рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХреЗрдВред
* рдлрд┐рд░, **рдЕрдВрддрд┐рдо рдХрдиреЗрдХреНрд╢рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ **рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕** рд╕рдВрднрд╛рд╡рд┐рдд рдлрд╝рд╛рдЗрд▓реЗрдВред
* **10 рдЕрдиреБрд░реЛрдз/рд╕реЗрдХрдВрдб** рдХреА рдЧрддрд┐ рдкрд░ рд╕рдордп рд╣реИ:
* 56800235584 / 2980 / 10 / 3600 \~= **530 рдШрдВрдЯреЗ** (50% рдХреА рд╕рдВрднрд╛рд╡рдирд╛ 265 рдШрдВрдЯреЗ рдореЗрдВ)
* (рдмрд┐рдирд╛ рдЕрдВрдХ) 19770609664 / 2980 / 10 / 3600 \~= 185 рдШрдВрдЯреЗ (50% рдХреА рд╕рдВрднрд╛рд╡рдирд╛ 93 рдШрдВрдЯреЗ рдореЗрдВ)

{% hint style="warning" %}
рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдо **рдЕрдиреНрдп рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ DoS** рдХрд░ рд░рд╣реЗ рд╣реИрдВ!
{% endhint %}

рдпрджрд┐ Apache рд╕рд░реНрд╡рд░ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рд╣рдо **4000 рдХрдиреЗрдХреНрд╢рди** (рдЕрдзрд┐рдХрддрдо рд╕рдВрдЦреНрдпрд╛ рдХреА рдУрд░ рдЖрдзрд╛) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдо `3999*20 = 79980` **рдлрд╝рд╛рдЗрд▓реЗрдВ** рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рд╕рдВрдЦреНрдпрд╛** рдХреЛ рд▓рдЧрднрдЧ **19.7 рдШрдВрдЯреЗ** рдпрд╛ **6.9 рдШрдВрдЯреЗ** (10 рдШрдВрдЯреЗ, 3.5 рдШрдВрдЯреЗ 50% рдХреА рд╕рдВрднрд╛рд╡рдирд╛) рддрдХ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## PHP-FMP

рдпрджрд┐ Apache рдХреЗ рд▓рд┐рдП рдирд┐рдпрдорд┐рдд php рдореЙрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп **рд╡реЗрдм рдкреГрд╖реНрда PHP-FMP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ** (рдпрд╣ рд╡реЗрдм рдкреГрд╖реНрда рдХреА рдХреБрд╢рд▓рддрд╛ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдкрд╛рдирд╛ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ), рддреЛ рддрдХрдиреАрдХ рдХреЛ рд╕реБрдзрд╛рд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдФрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

PHP-FMP рдХреЛ **`/etc/php/<php-version>/fpm/pool.d/www.conf`** рдореЗрдВ **`request_terminate_timeout`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред\
рдпрд╣ рдкреИрд░рд╛рдореАрдЯрд░ рд╕реЗрдХрдВрдб рдХреА рдЕрдзрд┐рдХрддрдо рдорд╛рддреНрд░рд╛ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ **рдЬрдм** **PHP рдХреЛ рдЕрдиреБрд░реЛрдз рд╕рдорд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП** (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдирдВрдд, рд▓реЗрдХрд┐рди **30 рд╕реЗрдХрдВрдб рдЕрдЧрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдЕрдирдХрдореЗрдВрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**ред рдЬрдм рдПрдХ рдЕрдиреБрд░реЛрдз PHP рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реЛрддрд╛ рд╣реИ рддреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕реЗрдХрдВрдб рдХреА рд╕рдВрдЦреНрдпрд╛, рддреЛ рд╡рд╣ **рдорд╛рд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ, рдХрд┐ рдпрджрд┐ рдЕрдиреБрд░реЛрдз рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░ рд░рд╣рд╛ рдерд╛, рдХреНрдпреЛрдВрдХрд┐ **php рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд░реЛрдХ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛**, рддреЛ рд╡рд╣ **рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣рдЯрд╛рдИ рдирд╣реАрдВ рдЬрд╛рдПрдВрдЧреА**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рдЙрд╕ рд╕рдордп рддрдХ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк **рд╣рдЬрд╛рд░реЛрдВ рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ рд╣рдЯрд╛рдИ рдирд╣реАрдВ рдЬрд╛рдПрдВрдЧреА, рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдЦреЛрдЬрдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ **рддреЗрдЬ рдХрд░реЗрдЧреА** рдФрд░ рд╕рднреА рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдХреЛ DoS рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рдХрдо рдХрд░реЗрдЧреАред

рдЗрд╕рд▓рд┐рдП, **DoS рд╕реЗ рдмрдЪрдиреЗ** рдХреЗ рд▓рд┐рдП рдорд╛рди рд▓реЗрдВ рдХрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░ рдХреЗрд╡рд▓ 100 рдХрдиреЗрдХреНрд╢рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реЛрдЧрд╛ рдФрд░ php рджреНрд╡рд╛рд░рд╛ рдЕрдзрд┐рдХрддрдо рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╕рдордп (`request_terminate_timeout`**)** **30 рд╕реЗрдХрдВрдб** рд╣реИред рдЗрд╕рд▓рд┐рдП, **рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдЙрддреНрдкрдиреНрди рдХреА рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЛрдВ** рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣реИ `100*20/30 = 66.67`ред

рдлрд┐рд░, **10000 рдлрд╝рд╛рдЗрд▓реЗрдВ** рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЪрд╛рд╣рд┐рдП рд╣реЛрдЧрд╛: **`10000/66.67 = 150 рд╕реЗрдХрдВрдб`** (рдпрджрд┐ **100000 рдлрд╝рд╛рдЗрд▓реЗрдВ** рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордп рд╣реЛрдЧрд╛ **25 рдорд┐рдирдЯ**)ред

рдлрд┐рд░, рд╣рдорд▓рд╛рд╡рд░ рдЙрди **100 рдХрдиреЗрдХреНрд╢рдиреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ **рдЦреЛрдЬ рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕** рдХрд░ рд╕рдХрддрд╛ рд╣реИред \*\*\*\* 300 рдЕрдиреБрд░реЛрдз/рд╕реЗрдХрдВрдб рдХреА рдЧрддрд┐ рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╕рдордп рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ:

* 56800235584 / 10000 / 300 / 3600 \~= **5.25 рдШрдВрдЯреЗ** (50% рдХреА рд╕рдВрднрд╛рд╡рдирд╛ 2.63 рдШрдВрдЯреЗ рдореЗрдВ)
* (100000 рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде) 56800235584 / 100000 / 300 / 3600 \~= **0.525 рдШрдВрдЯреЗ** (50% рдХреА рд╕рдВрднрд╛рд╡рдирд╛ 0.263 рдШрдВрдЯреЗ рдореЗрдВ)

рд╣рд╛рдБ, рдПрдХ EC2 рдордзреНрдпрдо рдЖрдХрд╛рд░ рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдореЗрдВ 100000 рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ:

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рд╡рд┐рдХрд▓реНрдкрдиреАрдп LFI рдкреГрд╖реНрда рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛** рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдЧрд╛, рддрд╛рдХрд┐ рдпрд╣ рдПрдХ рд╢рд╛рд╢реНрд╡рдд рд╕рдорд╛рд╡реЗрд╢ рд▓реВрдк рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░реЗред
{% endhint %}

## Nginx

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ Nginx **рдПрдХ рд╕рд╛рде 512 рд╕рдорднрд╛рд╡рд┐рдд рдХрдиреЗрдХреНрд╢рди** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ (рдФрд░ рдпрд╣ рд╕рдВрдЦреНрдпрд╛ рд╕реБрдзрд╛рд░реА рдЬрд╛ рд╕рдХрддреА рд╣реИ)ред
