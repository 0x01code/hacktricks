# Alan/Alt Alan Ele Geçirme

<details>

<summary><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* Hacking hilelerinizi göndererek **HackTricks** ve **HackTricks Cloud** github depolarına **katkıda bulunun**.

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Dünyanın en gelişmiş topluluk araçları tarafından desteklenen **iş akışlarını kolayca oluşturun ve otomatikleştirin** için [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)'i kullanın.\
Bugün Erişim Alın:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Alan ele geçirme

Eğer **kapsam içindeki bir hizmet tarafından kullanılan** bir **alan adı** (domain.tld) keşfederseniz, ancak **şirket** onun **sahipliğini kaybetmişse**, bunu **kaydetmeyi** (yeterince ucuzsa) deneyebilir ve şirkete bildirebilirsiniz. Bu alan adı, **GET** parametresi veya **Referer** başlığı aracılığıyla bir oturum çerezi gibi **hassas bilgiler** alıyorsa, bu kesinlikle bir **zafiyet**.

### Alt alan ele geçirme

Şirketin bir alt alanı, **kayıtlı olmayan bir isme sahip üçüncü taraf bir hizmete** işaret ediyor. Bu **üçüncü taraf hizmetinde** bir **hesap oluşturabilir** ve kullanımda olan **ismi kaydedebilirseniz**, alt alan ele geçirmeyi gerçekleştirebilirsiniz.

Mümkün ele geçirmeleri kontrol etmek için birkaç araç bulunmaktadır:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)

#### [BBOT](https://github.com/blacklanternsecurity/bbot) ile Ele Geçirilebilir Alt Alanları Tarama:

Alt alan ele geçirme kontrolleri, BBOT'un varsayılan alt alan taramasına dahildir. İmzalar doğrudan [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz) adresinden alınır.
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### DNS Wildcard ile Alt Alan Adı Ele Geçirme

Bir alan adında DNS wildcard kullanıldığında, açıkça farklı bir adresi olmayan herhangi bir alt alan adı, **aynı bilgiye çözümlenecektir**. Bu bir A ip adresi, bir CNAME olabilir...

Örneğin, `*.testing.com` `1.1.1.1` adresine wildcard olarak ayarlandığında, `not-existent.testing.com` `1.1.1.1` adresine yönlendirilecektir.

Ancak, IP adresine yönlendirmek yerine, sistem yöneticisi bunu bir **CNAME aracılığıyla üçüncü taraf hizmetine** (örneğin bir **github alt alan adı**) yönlendirirse (`sohomdatta1.github.io` gibi). Bir saldırgan, kendi üçüncü taraf sayfasını (bu durumda Github'ta) oluşturabilir ve `something.testing.com`'un oraya yönlendiğini söyleyebilir. Çünkü **CNAME wildcard**'ı kabul edecektir, saldırgan, kurbanın alan adı için kendi sayfalarına yönlendiren **keyfi alt alan adları oluşturabilecektir**.

Bu zafiyetin bir örneğini CTF yazısında bulabilirsiniz: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Alt Alan Adı Ele Geçirme Sömürüsü

Alt alan adı ele geçirme, internet üzerinde belirli bir alan adı için DNS sahteciliği olarak kabul edilir ve saldırganlara bir alan adı için A kayıtlarını ayarlayarak tarayıcıların içeriği saldırganın sunucusundan almasını sağlar. Bu tarayıcı şeffaflığı, alan adlarının dolandırıcılığa karşı savunmasız olmasına neden olur. Saldırganlar bu amaçla [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) veya [_Doppelganger alanları_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) kullanabilir. Özellikle, bir dolandırıcılık e-postasındaki URL'nin meşru görünmesi, kullanıcıları aldatır ve alan adının doğal güvenine dayanarak spam filtrelerinden kaçar.

Daha fazla ayrıntı için bu [yazıya](https://0xpatrik.com/subdomain-takeover/) bakın.

### **SSL Sertifikaları**
Saldırganlar tarafından [_Let's Encrypt_](https://letsencrypt.org/) gibi hizmetler aracılığıyla oluşturulan SSL sertifikaları, sahte alan adlarının meşruiyetini artırarak dolandırıcılık saldırılarını daha ikna edici hale getirir.

### **Çerez Güvenliği ve Tarayıcı Şeffaflığı**
Tarayıcı şeffaflığı ayrıca çerez güvenliğine de etki eder ve [Aynı Köken Politikası](https://en.wikipedia.org/wiki/Same-origin_policy) gibi politikalar tarafından yönetilir. Oturumları yönetmek ve giriş belirteçlerini depolamak için sıklıkla kullanılan çerezler, alt alan adı ele geçirme yoluyla istismar edilebilir. Saldırganlar, kullanıcıları bir tehlikeli alt alan adına yönlendirerek **oturum çerezlerini toplayabilir**, böylece kullanıcı verileri ve gizlilikleri tehlikeye atılır.

### **E-postalar ve Alt Alan Adı Ele Geçirme**
Alt alan adı ele geçirmenin başka bir yönü, e-posta hizmetlerini içerir. Saldırganlar, meşru bir alt alan adından e-posta almak veya göndermek için **MX kayıtlarını manipüle edebilir**, dolandırıcılık saldırılarının etkinliğini artırır.

### **Daha Yüksek Riskler**
Daha fazla risk, **NS kaydı ele geçirme**'sini içerir. Bir saldırgan, bir alan adının bir NS kaydı üzerinde kontrol sağlarsa, trafiğin bir bölümünü kendi kontrolündeki bir sunucuya yönlendirebilir. Bu risk, saldırının süresini uzatan yüksek bir **TTL (Yaşam Süresi)**'ye DNS kayıtları için ayarlanırsa daha da artar.

### CNAME Kaydı Zafiyeti
Saldırganlar, artık kullanılmayan veya devre dışı bırakılan harici hizmetlere yönlendirilen talep edilmemiş CNAME kayıtlarını istismar edebilir. Bu, güvenilir bir alan adı altında bir sayfa oluşturmalarına olanak tanır ve dolandırıcılığı veya kötü amaçlı yazılım dağıtımını daha da kolaylaştırır.

### **Azaltma Stratejileri**
Azaltma stratejileri şunları içerir:
1. **Zararlı DNS kayıtlarını kaldırmak** - Bu, alt alan adının artık gereksiz olduğu durumlarda etkilidir.
2. **Alan adını talep etmek** - Kaynakları ilgili bulut sağlayıcıya kaydetmek veya süresi dolmuş bir alan adını yeniden satın almak.
3. **Zayıf noktaları düzenli olarak izlemek** - [aquatone](https://github.com/michenriksen/aquatone) gibi araçlar, savunmasız alan adlarını tespit etmede yardımcı olabilir. Kuruluşlar ayrıca altyapı yönetim süreçlerini gözden geçirmeli ve DNS kaydı oluşturmanın kaynak oluşturma sürecinin son adımı ve kaynak yok etme sürecinin ilk adımı olduğunu sağlamalıdır.

Alt alan adı ele geçirmeyi önlemek için, bulut sağlayıcılar için alan adı sahipliğinin doğrulanması önemlidir. [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/) gibi bazı sağlayıcılar, bu sorunu tanımış ve alan adı doğrulama mekanizmaları uygulamıştır.

## Referanslar
* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kullanarak dünyanın en gelişmiş topluluk araçları tarafından desteklenen iş akışlarını kolayca oluşturabilir ve otomatikleştirebilirsiniz.\
Bugün Erişim Alın:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklam vermek veya HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi Twitter'da takip edin 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live).
* Hacking hilelerinizi göndererek HackTricks ve HackTricks Cloud github depolarına PR göndererek katkıda bulunun.

</details>
