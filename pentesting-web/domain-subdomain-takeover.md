# Domein/Subdomein oorname

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Gebruik [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) om maklik en **outomatiese werksvloei** te bou met behulp van die w√™reld se **mees gevorderde** gemeenskapsinstrumente.\
Kry vandag toegang:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Domein oorname

As jy 'n domein (domein.tld) ontdek wat **deur 'n diens binne die omvang** gebruik word, maar die **maatskappy** het die **eienaarskap** daarvan **verloor**, kan jy probeer om dit te **registreer** (as dit goedkoop genoeg is) en die maatskappy daarvan bewus maak. As hierdie domein **sensitiewe inligting** soos 'n sessiekoekie via 'n **GET**-parameter of in die **Referer**-kop ontvang, is dit beslis 'n **kwesbaarheid**.

### Subdomein oorname

'n Subdomein van die maatskappy verwys na 'n **derdepartydiens met 'n nie-geregistreerde naam**. As jy 'n **rekening** kan **skep** in hierdie **derdepartydiens** en die **naam** wat gebruik word, kan registreer, kan jy die subdomein oorneem.

Daar is verskeie hulpmiddels met woordeboeke om vir moontlike oornames te kyk:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)

#### Skandering vir oorneembare subdomeine met [BBOT](https://github.com/blacklanternsecurity/bbot):

Subdomein-oornames is ingesluit in BBOT se verstek subdomeinversameling. Handtekeninge word direk vanaf [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz) gehaal.
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### Subdomein Oorname Generasie deur DNS Wildcard

Wanneer 'n DNS wildcard gebruik word in 'n domein, sal enige aangevraagde subdomein van daardie domein wat nie eksplisiet 'n ander adres het nie, **opgelos word na dieselfde inligting**. Dit kan 'n A IP-adres wees, 'n CNAME...

Byvoorbeeld, as `*.testing.com` wildekaart is na `1.1.1.1`. Dan sal `not-existent.testing.com` na `1.1.1.1` verwys.

Maar as die sysadmin dit in plaas daarvan na 'n **derde party-diens via CNAME** verwys, soos 'n **github subdomein** byvoorbeeld (`sohomdatta1.github.io`). 'n Aanvaller kan **sy eie derde party-bladsy skep** (in hierdie geval op Gihub) en s√™ dat `something.testing.com` daarheen verwys. Omdat die **CNAME-wildekaart** dit goedkeur, sal die aanvaller in staat wees om **arbitr√™re subdomeine vir die slagoffer se domein te genereer wat na sy bladsye verwys**.

Jy kan 'n voorbeeld van hierdie kwesbaarheid vind in die CTF write-up: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Uitbuiting van 'n subdomein-oornaamname

Subdomein-oornaamname is in wese DNS-spoofing vir 'n spesifieke domein regoor die internet, wat aanvallers in staat stel om A-rekords vir 'n domein in te stel, sodat webblaaie inhoud van die aanvaller se bediener vertoon. Hierdie **deursigtigheid** in webblaaie maak domeine vatbaar vir hengel. Aanvallers kan [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) of [_Doppelganger-domeine_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) gebruik vir hierdie doel. Veral kwesbaar is domeine waar die URL in 'n hengel-e-pos legitiem lyk, wat gebruikers mislei en spamfilters ontduik as gevolg van die inherente vertroue in die domein.

Kyk na hierdie [berig vir verdere besonderhede](https://0xpatrik.com/subdomain-takeover/)

### **SSL-sertifikate**
SSL-sertifikate, as dit deur aanvallers gegenereer word deur dienste soos [_Let's Encrypt_](https://letsencrypt.org/), dra by tot die geloofwaardigheid van hierdie valse domeine en maak hengelaanvalle oortuigender.

### **Koekie-sekuriteit en webblaaier-deursigtigheid**
Webblaaier-deursigtigheid strek ook tot koekie-sekuriteit, wat beheer word deur beleide soos die [Sekere-oorsprong-beleid](https://en.wikipedia.org/wiki/Same-origin_policy). Koekies, wat dikwels gebruik word om sessies te bestuur en intekeningsimbole te stoor, kan uitgebuit word deur subdomein-oornaamname. Aanvallers kan **sessie-koekies versamel** deur gebruikers eenvoudig na 'n gekompromitteerde subdomein te stuur, wat gebruikersdata en privaatheid in gevaar bring.

### **E-posse en subdomein-oornaamname**
'n Ander aspek van subdomein-oornaamname behels e-posdienste. Aanvallers kan **MX-rekords** manipuleer om e-posse vanaf 'n legitieme subdomein te ontvang of te stuur, wat die doeltreffendheid van hengelaanvalle verbeter.

### **Ho√´r Orde Risiko's**
Verdere risiko's sluit **NS-rekord-oornaamname** in. As 'n aanvaller beheer oor een NS-rekord van 'n domein verkry, kan hy moontlik 'n gedeelte van die verkeer na 'n bediener onder sy beheer rig. Hierdie risiko word versterk as die aanvaller 'n ho√´ **TTL (Time to Live)** vir DNS-rekords instel, wat die duur van die aanval verleng.

### CNAME-rekord-kwesbaarheid
Aanvallers kan ongebruikte CNAME-rekords wat na eksterne dienste verwys en nie meer gebruik word of buite bedryf gestel is nie, uitbuit. Dit stel hulle in staat om 'n bladsy onder die vertroude domein te skep, wat hengel of die verspreiding van kwaadwillige sagteware verder fasiliteer.

### **Versagtingsstrategie√´**
Versagtingsstrategie√´ sluit in:
1. **Verwydering van kwesbare DNS-rekords** - Dit is doeltreffend as die subdomein nie meer benodig word nie.
2. **Eis die domeinnaam op** - Registreer die hulpbron by die betrokke wolkverskaffer of koop 'n vervalde domein terug.
3. **Gereelde monitering vir kwesbaarhede** - Hulpmiddels soos [aquatone](https://github.com/michenriksen/aquatone) kan help om vatbare domeine te identifiseer. Organisasies moet ook hul infrastruktuurbestuursprosesse hersien, om te verseker dat DNS-rekord-skepping die finale stap in hulpbron-skepping is en die eerste stap in hulpbron-vernietiging.

Vir wolkverskaffers is die verifikasie van domeineienaarskap van kritieke belang om subdomein-oornaamname te voorkom. Sommige, soos [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/), het hierdie probleem erken en domeinverifikasiemeganismes ge√Ømplementeer.

## Verwysings
* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Gebruik [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) om maklik werkstrome te bou en outomatiseer wat aangedryf word deur die w√™reld se **mees gevorderde** gemeenskapsinstrumente.\
Kry Vandag Toegang:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks-uitrusting**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFT's**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
