# Kumiliki Kikoa/Subdomain

<details>

<summary><strong>Jifunze kuhusu kuvamia AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikionekana kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kuvamia kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Tumia [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kujenga na **kutumia** **mifumo ya kazi** iliyowezeshwa na zana za **jamii za juu zaidi** duniani.\
Pata Ufikiaji Leo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Kumiliki Kikoa

Ikiwa unagundua kikoa (kikoa.tld) ambacho **kinatumika na huduma fulani ndani ya wigo** lakini **kampuni** imepoteza **umiliki** wake, unaweza kujaribu kukirekodi (ikiwa ni cha bei rahisi) na kuwajulisha kampuni. Ikiwa kikoa hiki kinapokea **habari nyeti** kama kuki za vikao kupitia **parameta ya GET** au kwenye kichwa cha **Referer**, hii bila shaka ni **hitilafu**.

### Kumiliki Subdomain

Subdomain ya kampuni inaelekeza kwenye **huduma ya mtu wa tatu yenye jina lisililorekodiwa**. Ikiwa unaweza **kuunda** **akaunti** kwenye **huduma ya mtu wa tatu** na **kurekodi** **jina** linalotumiwa, unaweza kufanya kumiliki subdomain.

Kuna zana kadhaa na maneno ya kamusi ya kuangalia kwa kumiliki:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)
* [https://github.com/PentestPad/subzy](https://github.com/PentestPad/subzy)

#### Uchunguzi wa Subdomains za Kutekwa na [BBOT](https://github.com/blacklanternsecurity/bbot):

Uchunguzi wa kumiliki subdomain umewekwa katika uchunguzi wa kawaida wa subdomain wa BBOT. Saini zinachukuliwa moja kwa moja kutoka [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz).
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### Kizazi cha Kuchukua Subdomain kupitia DNS Wildcard

Wakati wildcard ya DNS inapotumika kwenye kikoa, subdomain yoyote iliyotakiwa ya kikoa hiyo ambayo haina anwani tofauti kwa uwazi itakuwa **imeelekezwa kwenye habari ile ile**. Hii inaweza kuwa anwani ya A ip, CNAME...

Kwa mfano, ikiwa `*.testing.com` imeelekezwa kwa `1.1.1.1`. Kisha, `not-existent.testing.com` itakuwa inaelekeza kwa `1.1.1.1`.

Hata hivyo, badala ya kuielekeza kwa anwani ya IP, msimamizi wa mfumo anaweza kuielekeza kwa **huduma ya mtu wa tatu kupitia CNAME**, kama vile **subdomain ya github** kwa mfano (`sohomdatta1.github.io`). Mshambuliaji anaweza **kuunda ukurasa wake wa mtu wa tatu** (kwenye Gihub kwa kesi hii) na kusema kwamba `kitu.testing.com` inaelekeza hapo. Kwa sababu, **CNAME wildcard** itakubaliana na mshambuliaji ataweza **kuzalisha subdomains za kiholela kwa kikoa cha muathiriwa zinazo elekezwa kwenye kurasa zake**.

Unaweza kupata mfano wa udhaifu huu katika CTF write-up: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Kutumia kuchukua subdomain

Kuchukua subdomain ni kimsingi udanganyifu wa DNS kwa kikoa maalum kwenye mtandao, kuruhusu wachomaji kuanzisha rekodi za A kwa kikoa, kuongoza vivinjari kuonyesha maudhui kutoka kwenye seva ya mshambuliaji. Hii **uwazi** kwenye vivinjari inafanya vikoa kuwa hatarini kwa udanganyifu. Wachomaji wanaweza kutumia [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) au [_Doppelganger domains_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) kwa lengo hili. Hasa hatarini ni vikoa ambapo URL katika barua pepe ya udanganyifu inaonekana kuwa halali, kuwapotosha watumiaji na kuepuka vichujio vya barua taka kutokana na imani ya asili ya kikoa.

Angalia [chapisho hili kwa maelezo zaidi](https://0xpatrik.com/subdomain-takeover/)

### **Vyeti vya SSL**

Vyeti vya SSL, ikiwa vinazalishwa na wachomaji kupitia huduma kama [_Let's Encrypt_](https://letsencrypt.org/), huongeza uhalali wa vikoa bandia hivi, kufanya mashambulizi ya udanganyifu kuwa ya kushawishi zaidi.

### **Usalama wa Vidakuzi na Uwazi wa Kivinjari**

Uwazi wa kivinjari pia unahusiana na usalama wa vidakuzi, unatawaliwa na sera kama [Sera ya Asili Moja](https://en.wikipedia.org/wiki/Same-origin\_policy). Vidakuzi, mara nyingi hutumika kusimamia vikao na kuhifadhi alama za kuingia, vinaweza kutumika vibaya kupitia kuchukua subdomain. Wachomaji wanaweza **kukusanya vidakuzi vya kikao** kwa urahisi tu kwa kuwaongoza watumiaji kwenye subdomain iliyoharibiwa, kuweka data na faragha ya mtumiaji hatarini.

### **Barua pepe na Kuchukua Subdomain**

Mwonekano mwingine wa kuchukua subdomain unahusisha huduma za barua pepe. Wachomaji wanaweza kubadilisha **rekodi za MX** kupokea au kutuma barua pepe kutoka kwa subdomain halali, kuongeza ufanisi wa mashambulizi ya udanganyifu.

### **Hatari za Viwango vya Juu**

Hatari zaidi ni pamoja na **kuchukua rekodi za NS**. Ikiwa mshambuliaji anapata udhibiti wa rekodi moja ya NS ya kikoa, wanaweza kuelekeza sehemu ya trafiki kwenye seva chini ya udhibiti wao. Hatari hii inaongezeka ikiwa mshambuliaji anaweka **TTL (Muda wa Kuishi)** wa juu kwa rekodi za DNS, kuzidisha muda wa shambulizi.

### Udhaifu wa Rekodi ya CNAME

Wachomaji wanaweza kutumia rekodi za CNAME ambazo hazijadaiwa zinazo elekeza kwa huduma za nje ambazo hazitumiwi tena au zimeondolewa. Hii inawaruhusu kuunda ukurasa chini ya kikoa kinachotegemewa, kuwezesha zaidi udanganyifu au usambazaji wa programu hasidi.

### **Mbinu za Kupunguza Hatari**

Mbinu za kupunguza hatari ni pamoja na:

1. **Kuondoa rekodi za DNS zenye udhaifu** - Hii ni yenye ufanisi ikiwa subdomain haifai tena.
2. **Kudai jina la kikoa** - Kusajili rasilimali na mtoa huduma wa wingu husika au kununua upya kikoa kilichoisha muda wake.
3. **Kufuatilia mara kwa mara kwa udhaifu** - Zana kama [aquatone](https://github.com/michenriksen/aquatone) inaweza kusaidia kutambua vikoa vinavyoweza kuathiriwa. Mashirika pia yanapaswa kupitia upya michakato yao ya usimamizi wa miundombinu, kuhakikisha kuwa uundaji wa rekodi za DNS ni hatua ya mwisho katika uundaji wa rasilimali na hatua ya kwanza katika uharibifu wa rasilimali.

Kwa watoa huduma wa wingu, kuthibitisha umiliki wa kikoa ni muhimu ili kuzuia kuchukua subdomain. Baadhi, kama [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/), wametambua suala hili na kutekeleza mbinu za uthibitisho wa kikoa.

## Marejeo

* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Tumia [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kujenga na **kutumia mifumo ya kazi** kwa urahisi ikiwa na zana za jamii za juu zaidi duniani.\
Pata Ufikiaji Leo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Jifunze kuhusu kuchomwa kwa AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kuchomwa kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
