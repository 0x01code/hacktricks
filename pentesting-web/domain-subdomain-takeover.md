# Alan/Alt Alan Ele Geçirme

<details>

<summary><strong>Sıfırdan Kahraman Olarak AWS hacklemeyi öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**]'na(https://github.com/sponsors/carlospolop) göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'da **takip edin**.
* **Hacking püf noktalarınızı göndererek HackTricks** ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına PR'lar göndererek paylaşın.

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) kullanarak dünyanın **en gelişmiş** topluluk araçları tarafından desteklenen ve **iş akışlarını otomatikleştirmenizi** sağlayan **kolayca oluşturun**.\
Bugün Erişim Alın:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Alan Ele Geçirme

Eğer **kapsam içinde bazı hizmetler tarafından kullanılan bir alan (alan.tld)** keşfederseniz ama **şirket** bunun **sahipliğini kaybetmişse**, bunu **kaydedip** şirkete bildirebilirsiniz. Eğer bu alan, bir **oturum çerezi gibi hassas bilgileri** **GET** parametresi veya **Referer** başlığı aracılığıyla alıyorsa, bu kesinlikle bir **zafiyettir**.

### Alt Alan Ele Geçirme

Şirketin bir alt alanı, **kayıtlı olmayan bir isimle üçüncü taraf bir hizmete işaret ediyor**. Bu **üçüncü taraf hizmetinde bir hesap oluşturabilir** ve kullanımda olan **isim**i **kaydedebilirseniz**, alt alan ele geçirme işlemini gerçekleştirebilirsiniz.

Muhtemel ele geçirmeleri kontrol etmek için sözlüklerle birlikte birçok araç bulunmaktadır:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)
* [https://github.com/PentestPad/subzy](https://github.com/PentestPad/subzy)

[BBOT](https://github.com/blacklanternsecurity/bbot) ile Hijackable Alt Alanları Tarayın:

Alt alan ele geçirme kontrolleri, BBOT'un varsayılan alt alan numaralandırmasına dahil edilmiştir. İmzalar doğrudan [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz) adresinden alınır.
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### DNS Yabancı Ana Bilgisayar Adı Yoluyla Alt Alan Adı Ele Geçirme

Bir alan adında DNS yabancı ana bilgisayar adı kullanıldığında, açıkça farklı bir adresi olmayan o alan adının talep edilen alt alanı **aynı bilgilere çözümlenecektir**. Bu bir A ip adresi, bir CNAME olabilir...

Örneğin, `*.testing.com` `1.1.1.1`'e yabancı ana bilgisayar adı olarak ayarlandığında, `not-existent.testing.com` `1.1.1.1`'e işaret edecektir.

Ancak, IP adresine işaret etmek yerine, sistem yöneticisi bunu **CNAME aracılığıyla üçüncü taraf hizmetine işaret ederse**, örneğin bir **github alt alanı** (`sohomdatta1.github.io`). Bir saldırgan kendi üçüncü taraf sayfasını (bu durumda Github'ta) oluşturabilir ve `something.testing.com`'un oraya işaret ettiğini söyleyebilir. Çünkü **CNAME yabancı ana bilgisayar adı** saldırganın, kurbanın alan adı için **kendi sayfalarına işaret eden keyfi alt alanlar oluşturmasına izin verecektir**.

Bu zafiyetin bir örneğini CTF yazısında bulabilirsiniz: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Alt Alan Adı Ele Geçirme Sömürüsü

Alt alan adı ele geçirme aslında internet üzerinde belirli bir alan adı için DNS sahteciliğidir ve saldırganların bir alan adı için A kayıtlarını ayarlamalarına izin verir, bu da tarayıcıların içeriği saldırganın sunucusundan göstermesine neden olur. Bu, tarayıcılardaki bu **şeffaflık**, alan adlarını dolandırıcılığa karşı savunmasız hale getirir. Saldırganlar bu amaçla [_tutarsızlık_](https://en.wikipedia.org/wiki/Typosquatting) veya [_Doppelganger alanları_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) kullanabilir. Özellikle, bir dolandırıcılık e-postasındaki URL'nin meşru görünmesi, kullanıcıları aldatması ve alan adının doğal güveni nedeniyle spam filtrelerinden kaçınması nedeniyle dolandırıcılığa karşı savunmasız olan alanlardır.

Daha fazla ayrıntı için bu [gönderiye bakın](https://0xpatrik.com/subdomain-takeover/)

### **SSL Sertifikaları**
Saldırganlar tarafından [_Let's Encrypt_](https://letsencrypt.org/) gibi hizmetler aracılığıyla oluşturulan SSL sertifikaları, bu sahte alan adlarının meşruiyetini artırarak dolandırıcılık saldırılarını daha inandırıcı hale getirir.

### **Çerez Güvenliği ve Tarayıcı Şeffaflığı**
Tarayıcı şeffaflığı ayrıca çerez güvenliğine de uzanır ve [Aynı köken politikası](https://en.wikipedia.org/wiki/Same-origin_policy) gibi politikalar tarafından yönetilir. Oturumları yönetmek ve giriş belirteçlerini saklamak için sıkça kullanılan çerezler, alt alan ele geçirme yoluyla sömürülebilir. Saldırganlar, kullanıcıları tehlikeye atarak oturum çerezlerini **toplayabilir** sadece kullanıcıları bir tehlikeli alt alana yönlendirerek, kullanıcı verilerini ve gizliliğini tehlikeye atarlar.

### **E-postalar ve Alt Alan Adı Ele Geçirme**
Alt alan ele geçirmenin başka bir yönü de e-posta hizmetlerini içerir. Saldırganlar, meşru bir alt alan üzerinden e-posta almak veya göndermek için **MX kayıtlarını manipüle edebilir**, dolandırıcılık saldırılarının etkinliğini artırır.

### **Daha Yüksek Düzey Riskler**
Daha fazla risk, **NS kaydı ele geçirmeyi** içerir. Bir saldırgan bir alanın bir NS kaydını ele geçirirse, trafiğin bir kısmını kendi kontrolündeki bir sunucuya yönlendirebilir. Bu risk, saldırının süresini uzatan yüksek bir **TTL (Yaşam Süresi)** ayarlarsa daha da artar.

### CNAME Kaydı Zafiyeti
Saldırganlar, artık kullanılmayan veya devre dışı bırakılan harici hizmetlere işaret eden talep edilmemiş CNAME kayıtlarını sömürebilir. Bu, güvenilir alan altında bir sayfa oluşturmalarına izin verir ve dolandırıcılığı veya kötü amaçlı yazılım dağıtımını daha da kolaylaştırır.

### **Hafifletme Stratejileri**
Hafifletme stratejileri şunları içerir:
1. **Zararlı DNS kayıtlarını kaldırma** - Bu, alt alanın artık gerekli olmadığı durumlarda etkilidir.
2. **Alan adını talep etme** - Kaynağı ilgili bulut sağlayıcıyla kaydetmek veya süresi dolmuş bir alan adını yeniden satın almak.
3. **Zafiyetler için düzenli izleme** - [aquatone](https://github.com/michenriksen/aquatone) gibi araçlar, hassas alanları tanımlamaya yardımcı olabilir. Kuruluşlar ayrıca altyapı yönetim süreçlerini gözden geçirmeli ve DNS kaydı oluşturmanın kaynak oluşturmanın son adımı ve kaynağın yok edilmesinin ilk adımı olduğundan emin olmalıdır.

Bulut sağlayıcılar için, alt alan ele geçirmeleri önlemek için alan adı sahipliğinin doğrulanması önemlidir. [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/) gibi bazıları, bu sorunu tanımış ve alan doğrulama mekanizmaları uygulamıştır.

## Referanslar
* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kullanarak dünyanın en gelişmiş topluluk araçları tarafından desteklenen **otomatik iş akışları** oluşturun ve otomatikleştirin.\
Bugün Erişim Alın:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Sıfırdan Kahraman'a AWS hackleme öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek veya HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzdaki özel [**NFT'leri**](https://opensea.io/collection/the-peass-family) keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi Twitter'da 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)** takip edin.**
* **Hacking püf noktalarınızı göndererek HackTricks ve HackTricks Cloud** github depolarına PR'lar göndererek paylaşın.

</details>
