# Alan/Alt Alan ele geçirme

<details>

<summary><strong>AWS hacklemeyi sıfırdan kahraman olmaya öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**]'na göz atın (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks ürünleri**]'ni alın (https://peass.creator-spring.com)
* [**PEASS Ailesi**]'ni keşfedin (https://opensea.io/collection/the-peass-family), özel [**NFT'ler**]'imiz koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**]'da takip edin (https://twitter.com/hacktricks\_live)**.**
* **Hacking püf noktalarınızı paylaşarak PR'lar göndererek** [**HackTricks**]'e (https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**]'a (https://github.com/carlospolop/hacktricks-cloud) katkıda bulunun.

</details>

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**]'i kullanarak dünyanın en gelişmiş topluluk araçları tarafından desteklenen **iş akışlarını kolayca oluşturun ve otomatikleştirin**.\
Bugün Erişim Alın:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Alan ele geçirme

Eğer **kullanılan bir hizmete sahip bir alan (domain.tld)** keşfederseniz ama **şirket** bunun **sahipliğini kaybetmişse**, bunu **kaydedip** şirkete bildirebilirsiniz (eğer yeterince ucuzsa). Bu alan, **GET** parametresi aracılığıyla bir oturum çerezi gibi **duyarlı bilgiler** alıyorsa veya **Referer** başlığında ise, bu kesinlikle bir **zafiyet**tir.

### Alt alan ele geçirme

Şirketin bir alt alanı, **kayıtlı olmayan bir isimle üçüncü taraf bir hizmete işaret ediyor**. Bu **üçüncü taraf hizmetinde bir hesap oluşturabilir** ve kullanımda olan **isim**i **kaydedebilirseniz**, alt alan ele geçirme işlemini gerçekleştirebilirsiniz.

Muhtemel ele geçirmeleri kontrol etmek için sözlüklerle birçok araç bulunmaktadır:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)
* [https://github.com/PentestPad/subzy](https://github.com/PentestPad/subzy)

[BBOT ile Hijackable Alt Alanları Tarayın](https://github.com/blacklanternsecurity/bbot):

Alt alan ele geçirme kontrolleri, BBOT'un varsayılan alt alan numaralandırmasına dahildir. İmzalar doğrudan [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)'den alınır.
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### DNS Yerine Göre Alt Alan Adı Ele Geçirme

Bir alan adında DNS yıldız karakteri kullanıldığında, açıkça farklı bir adresi olmayan o alan adının herhangi bir istenilen alt alanı **aynı bilgiye çözümlenecektir**. Bu bir A ip adresi, bir CNAME olabilir...

Örneğin, `*.testing.com` `1.1.1.1` olarak yıldızlandığında, `not-existent.testing.com` `1.1.1.1`e işaret edecektir.

Ancak, IP adresine işaret etmek yerine, sistem yöneticisi bunu **CNAME aracılığıyla üçüncü taraf hizmetine işaret ederse**, örneğin bir **github alt alanı** (`sohomdatta1.github.io`). Bir saldırgan **kendi üçüncü taraf sayfasını** (bu durumda Github'ta) oluşturabilir ve `something.testing.com`in oraya işaret ettiğini söyleyebilir. Çünkü **CNAME yıldız karakteri** saldırganın, **kurbanın alan adı için kendi sayfalarına işaret eden keyfi alt alanlar oluşturmasına izin verecektir**.

Bu zafiyetin bir örneğini CTF yazısında bulabilirsiniz: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Bir alt alan ele geçirme

Alt alan ele geçirme aslında internet üzerinde belirli bir alan adı için DNS sahteciliğidir ve saldırganlara bir alan adı için A kayıtları ayarlamalarına izin verir, tarayıcıları saldırganın sunucusundan içerik göstermeye yönlendirir. Bu **tarayıcılardaki şeffaflık**, alan adlarını dolandırıcılığa karşı savunmasız hale getirir. Saldırganlar bu amaçla [_tutarsızlık_](https://en.wikipedia.org/wiki/Typosquatting) veya [_Doppelganger alanları_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) kullanabilir. Özellikle, bir dolandırıcılık e-postasındaki URL'nin meşru görünmesi, kullanıcıları aldatması ve alan adının doğal güveni nedeniyle spam filtrelerinden kaçınması nedeniyle alanlar savunmasızdır.

Daha fazla ayrıntı için bu [gönderiye bakın](https://0xpatrik.com/subdomain-takeover/)

### **SSL Sertifikaları**

Saldırganlar tarafından [_Let's Encrypt_](https://letsencrypt.org/) gibi hizmetler aracılığıyla oluşturulan SSL sertifikaları, bu sahte alan adlarının meşruiyetini artırarak dolandırıcılık saldırılarını daha inandırıcı hale getirir.

### **Çerez Güvenliği ve Tarayıcı Şeffaflığı**

Tarayıcı şeffaflığı ayrıca çerez güvenliğine de uzanır, [Aynı köken politikası](https://en.wikipedia.org/wiki/Same-origin\_policy) gibi politikalar tarafından yönetilir. Oturumları yönetmek ve giriş belirteçlerini saklamak için sık ​​kullanılan çerezler, alt alan ele geçirme yoluyla kötüye kullanılabilir. Saldırganlar, kullanıcıları tehlikeye atarak oturum çerezlerini **toplayabilir**, basitçe kullanıcıları tehlikeye atan bir alt alana yönlendirerek kullanıcı verilerini ve gizliliğini tehlikeye atabilir.

### **E-postalar ve Alt Alan Ele Geçirme**

Alt alan ele geçirmenin başka bir yönü de e-posta hizmetlerini içerir. Saldırganlar, meşru bir alt alan üzerinden e-posta almak veya göndermek için **MX kayıtlarını manipüle edebilir**, dolandırıcılık saldırılarının etkinliğini artırır.

### **Daha Yüksek Düzey Riskler**

Daha fazla riskler arasında **NS kaydı ele geçirme** bulunmaktadır. Bir saldırgan bir alanın bir NS kaydını ele geçirirse, potansiyel olarak trafiğin bir kısmını kendi kontrolündeki bir sunucuya yönlendirebilir. Bu risk, saldırganın DNS kayıtları için yüksek bir **TTL (Yaşam Süresi)** belirlemesi durumunda artar, saldırının süresini uzatır.

### CNAME Kaydı Zafiyeti

Saldırganlar, artık kullanılmayan veya devre dışı bırakılan harici hizmetlere işaret eden talep edilmemiş CNAME kayıtlarını sömürebilir. Bu, güvenilir alan altında bir sayfa oluşturmalarına izin verir ve dolandırıcılığı veya kötü amaçlı yazılım dağıtımını daha da kolaylaştırır.

### **Hafifletme Stratejileri**

Hafifletme stratejileri şunları içerir:

1. **Zararlı DNS kayıtlarını kaldırma** - Bu, alt alan artık gereksizse etkilidir.
2. **Alan adını talep etme** - Kaynağı ilgili bulut sağlayıcıyla kaydetmek veya süresi dolmuş bir alan adını yeniden satın almak.
3. **Zafiyetler için düzenli izleme** - [aquatone](https://github.com/michenriksen/aquatone) gibi araçlar, savunmasız alanları tanımlamaya yardımcı olabilir. Kuruluşlar ayrıca altyapı yönetim süreçlerini gözden geçirmeli ve DNS kaydı oluşturmanın kaynağın oluşturulmasının son adımı ve kaynağın yok edilmesinin ilk adımı olduğundan emin olmalıdır.

Bulut sağlayıcılar için, alt alan ele geçirmelerini önlemek için alan sahipliğini doğrulamak önemlidir. [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/) gibi bazıları, bu sorunu tanımış ve alan doğrulama mekanizmaları uygulamıştır.

## Referanslar

* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kullanarak dünyanın **en gelişmiş** topluluk araçları tarafından desteklenen **iş akışlarını kolayca oluşturun ve otomatikleştirin**.\
Bugün Erişim Alın:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmaya kadar AWS hackleme öğrenin!</summary>

HackTricks'i desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi Twitter'da takip edin 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Hacking püf noktalarınızı göndererek HackTricks ve HackTricks Cloud github depolarına PR göndererek paylaşın.**

</details>
