# Kuchukua Udhibiti wa Kikoa/Subdomain

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa kwenye HackTricks** au **kupakua HackTricks kwa muundo wa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PR kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Tumia [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kujenga na **kuautomatisha mchakato** wa kazi zinazotumia zana za jamii za **juu zaidi** duniani.\
Pata Ufikiaji Leo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Kuchukua Udhibiti wa Kikoa

Ikiwa unagundua kikoa (kikoa.tld) ambacho **kinatumika na huduma fulani ndani ya wigo** lakini **kampuni** imepoteza **umiliki** wake, unaweza kujaribu **kulirekodi** (ikiwa ni cha bei rahisi) na kuwajulisha kampuni. Ikiwa kikoa hiki kinapokea **habari nyeti** kama kuki za kikao kupitia **parameta ya GET** au kwenye kichwa cha **Referer**, hii ni kwa hakika **hitilafu**.

### Kuchukua Udhibiti wa Subdomain

Subdomain ya kampuni inaelekeza kwa **huduma ya mtu wa tatu ambayo haijasajiliwa**. Ikiwa unaweza **kuunda** akaunti kwenye **huduma ya mtu wa tatu** hii na **kusajili** jina linalotumiwa, unaweza kufanya kuchukua udhibiti wa subdomain.

Kuna zana kadhaa na kamusi za kuchunguza kuchukua udhibiti:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)

#### Kuchunguza Subdomains Zinazoweza Kudukuliwa na [BBOT](https://github.com/blacklanternsecurity/bbot):

Uchunguzi wa kuchukua udhibiti wa subdomain umewekwa katika uchunguzi wa kawaida wa subdomain wa BBOT. Saini zinachukuliwa moja kwa moja kutoka [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz).
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### Kizazi cha Kuchukua Udhibiti wa Subdomain kupitia DNS Wildcard

Wakati wildcard ya DNS inapotumiwa katika kikoa, kikoa chochote kilichotakiwa cha subdomain ambacho hakina anwani tofauti kwa uwazi kitakuwa **kinaelekezwa kwenye habari ile ile**. Hii inaweza kuwa anwani ya IP ya A, CNAME...

Kwa mfano, ikiwa `*.testing.com` imefungwa kwa `1.1.1.1`. Kisha, `not-existent.testing.com` itakuwa inaelekeza kwa `1.1.1.1`.

Walakini, badala ya kuielekeza kwa anwani ya IP, msimamizi wa mfumo anaweza kuielekeza kwa **huduma ya mtu wa tatu kupitia CNAME**, kama **subdomain ya github** kwa mfano (`sohomdatta1.github.io`). Mshambuliaji anaweza **kuunda ukurasa wake wa mtu wa tatu** (katika Gihub katika kesi hii) na kusema kuwa `something.testing.com` inaelekeza hapo. Kwa sababu, **CNAME wildcard** itakubaliana, mshambuliaji ataweza **kuzalisha subdomains za kiholela kwa kikoa cha muathirika zinazoashiria kurasa zake**.

Unaweza kupata mfano wa udhaifu huu katika CTF write-up: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Kufaidika na kuchukua udhibiti wa subdomain

Kuchukua udhibiti wa subdomain ni kimsingi udanganyifu wa DNS kwa kikoa maalum kwenye mtandao, kuruhusu wadukuzi kuweka rekodi za A kwa kikoa, kuongoza vivinjari kuonyesha maudhui kutoka kwenye seva ya mshambuliaji. Hii **uwazi** katika vivinjari hufanya vikoa kuwa rahisi kwa ulaghai. Wadukuzi wanaweza kutumia [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) au [_Doppelganger domains_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) kwa madhumuni haya. Hasa, vikoa ambapo URL katika barua pepe ya ulaghai inaonekana kuwa halali, kuwadanganya watumiaji na kuepuka vichujio vya barua taka kutokana na imani ya asili ya kikoa.

Angalia [chapisho hili kwa maelezo zaidi](https://0xpatrik.com/subdomain-takeover/)

### **Vyeti vya SSL**
Vyeti vya SSL, ikiwa vinazalishwa na wadukuzi kupitia huduma kama [_Let's Encrypt_](https://letsencrypt.org/), huongeza uhalali wa vikoa bandia hivi, kufanya mashambulizi ya ulaghai kuwa ya kuaminika zaidi.

### **Usalama wa Vidakuzi na Uwazi wa Kivinjari**
Uwazi wa kivinjari pia unahusisha usalama wa vidakuzi, unaoongozwa na sera kama [Sera ya Asili Iliyotumiwa](https://en.wikipedia.org/wiki/Same-origin_policy). Vidakuzi, mara nyingi hutumiwa kusimamia vikao na kuhifadhi alama za kuingia, vinaweza kudukuliwa kupitia kuchukua udhibiti wa subdomain. Wadukuzi wanaweza **kukusanya vidakuzi vya kikao** kwa kuwaongoza watumiaji kwenye subdomain iliyodhurika, kuweka data na faragha ya mtumiaji hatarini.

### **Barua pepe na Kuchukua Udhibiti wa Subdomain**
Nyanja nyingine ya kuchukua udhibiti wa subdomain inahusisha huduma za barua pepe. Wadukuzi wanaweza kubadilisha **rekodi za MX** ili kupokea au kutuma barua pepe kutoka kwa subdomain halali, kuongeza ufanisi wa mashambulizi ya ulaghai.

### **Hatari za Viwango Vya Juu**
Hatari zaidi ni kuchukua udhibiti wa **rekodi za NS**. Ikiwa mshambuliaji anapata udhibiti juu ya rekodi moja ya NS ya kikoa, wanaweza kuelekeza sehemu ya trafiki kwenye seva chini ya udhibiti wao. Hatari hii inaongezeka ikiwa mshambuliaji anaweka **TTL (Muda wa Kuishi)** kubwa kwa rekodi za DNS, kuongeza muda wa mashambulizi.

### Udhaifu wa Rekodi ya CNAME
Wadukuzi wanaweza kutumia rekodi za CNAME ambazo hazijadaiwa zinazoashiria huduma za nje ambazo hazitumiwi tena au zimeondolewa. Hii inawaruhusu kuunda ukurasa chini ya kikoa kinachotegemewa, kuwezesha zaidi ulaghai au usambazaji wa programu hasidi.

### **Mbinu za Kupunguza Hatari**
Mbinu za kupunguza hatari ni pamoja na:
1. **Kuondoa rekodi za DNS zinazoweza kudhurika** - Hii ni yenye ufanisi ikiwa subdomain haifai tena.
2. **Kudai jina la kikoa** - Kusajili rasilimali na mtoa huduma wa wingu husika au kununua tena kikoa kilichoisha muda wake.
3. **Ufuatiliaji wa kawaida kwa udhaifu** - Zana kama [aquatone](https://github.com/michenriksen/aquatone) zinaweza kusaidia kutambua vikoa vinavyoweza kuathiriwa. Mashirika pia yanapaswa kupitia upya michakato yao ya usimamizi wa miundombinu, kuhakikisha kuwa uundaji wa rekodi za DNS ni hatua ya mwisho katika uundaji wa rasilimali na hatua ya kwanza katika uharibifu wa rasilimali.

Kwa watoa huduma wa wingu, kuhakikisha umiliki wa kikoa ni muhimu ili kuzuia kuchukua udhibiti wa subdomain. Baadhi yao, kama [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/), wamegundua shida hii na kutekeleza mifumo ya uthibitisho wa kikoa.

## Marejeo
* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Tumia [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) kujenga na **kutumia kiotomatiki** mchakato wa kazi ulioendeshwa na zana za jamii za **hali ya juu zaidi** duniani.\
Pata Ufikiaji Leo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa katika HackTricks** au **kupakua HackTricks kwa muundo wa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi wa PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) za kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PR kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
