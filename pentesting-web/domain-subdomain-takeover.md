# Κατάληψη Domain/Subdomain

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Χρησιμοποιήστε το [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) για να δημιουργήσετε και να **αυτοματοποιήσετε ροές εργασίας** με τα πιο προηγμένα εργαλεία της κοινότητας.\
Αποκτήστε πρόσβαση σήμερα:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Κατάληψη Domain

Εάν ανακαλύψετε κάποιο domain (domain.tld) που **χρησιμοποιείται από κάποια υπηρεσία εντός του πεδίου εφαρμογής** αλλά η **εταιρεία** έχει **χάσει την ιδιοκτησία** του, μπορείτε να προσπαθήσετε να το **καταχωρίσετε** (εάν είναι αρκετά φθηνό) και να ενημερώσετε την εταιρεία. Εάν αυτό το domain λαμβάνει κάποιες **ευαίσθητες πληροφορίες** όπως ένα sessions cookie μέσω παραμέτρου **GET** ή στην κεφαλίδα **Referer**, τότε αυτό είναι σίγουρα μια **ευπάθεια**.

### Κατάληψη Subdomain

Ένα subdomain της εταιρείας δείχνει σε μια **υπηρεσία τρίτου μέρους με ένα μη καταχωρημένο όνομα**. Εάν μπορείτε να **δημιουργήσετε** ένα **λογαριασμό** σε αυτήν την **υπηρεσία τρίτου μέρους** και να **καταχωρίσετε** το **όνομα** που χρησιμοποιείται, μπορείτε να πραγματοποιήσετε την κατάληψη του subdomain.

Υπάρχουν αρκετά εργαλεία με λεξικά για να ελέγξετε τις πιθανές καταλήψεις:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)

#### Σάρωση για Καταλήψιμα Subdomains με το [BBOT](https://github.com/blacklanternsecurity/bbot):

Ο έλεγχος για κατάληψη subdomain περιλαμβάνεται στην προεπιλεγμένη αναγνώριση subdomain του BBOT. Οι υπογραφές ανακτώνται απευθείας από το [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz).
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### Δημιουργία Κατάληψης Υποτομέα μέσω Αγριοχαρτογράφησης DNS

Όταν χρησιμοποιείται η αγριοχαρτογράφηση DNS σε έναν τομέα, οποιοδήποτε αιτούμενος υποτομέας αυτού του τομέα που δεν έχει διαφορετική διεύθυνση θα **επιλυθεί στις ίδιες πληροφορίες**. Αυτό μπορεί να είναι μια διεύθυνση IP τύπου A, ένα CNAME...

Για παράδειγμα, αν ο `*.testing.com` έχει αγριοχαρτογραφηθεί στο `1.1.1.1`. Τότε, ο `not-existent.testing.com` θα δείχνει στο `1.1.1.1`.

Ωστόσο, αν αντί να δείχνει σε μια διεύθυνση IP, ο διαχειριστής συστήματος τον κατευθύνει σε ένα **υπηρεσία τρίτου μέσω CNAME**, όπως ένα **υποτομέα του github** για παράδειγμα (`sohomdatta1.github.io`). Ένας επιτιθέμενος μπορεί να **δημιουργήσει τη δική του σελίδα τρίτου μέρους** (σε αυτήν την περίπτωση στο Gihub) και να πει ότι το `something.testing.com` δείχνει εκεί. Επειδή η **αγριοχαρτογράφηση CNAME** θα συμφωνήσει, ο επιτιθέμενος θα μπορεί να **δημιουργήσει αυθαίρετους υποτομείς για τον τομέα του θύματος που δείχνουν στις σελίδες του**.

Μπορείτε να βρείτε ένα παράδειγμα αυτής της ευπάθειας στο CTF write-up: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Εκμετάλλευση μιας κατάληψης υποτομέα

Η κατάληψη υποτομέα είναι ουσιαστικά απάτη DNS για έναν συγκεκριμένο τομέα σε όλο το διαδίκτυο, επιτρέποντας στους επιτιθέμενους να ορίσουν εγγραφές A για έναν τομέα, με αποτέλεσμα οι περιηγητές να εμφανίζουν περιεχόμενο από τον διακομιστή του επιτιθέμενου. Αυτή η **διαφάνεια** στους περιηγητές καθιστά τους τομείς ευάλωτους σε φισινγκ. Οι επιτιθέμενοι μπορεί να χρησιμοποιήσουν [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) ή [_Doppelganger domains_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) για αυτόν τον σκοπό. Ευάλωτοι είναι ιδιαίτερα οι τομείς όπου η διεύθυνση URL σε ένα φισινγκ email φαίνεται νόμιμη, παραπλανώντας τους χρήστες και αποφεύγοντας τα φίλτρα ανεπιθύμητων email λόγω της εμπιστοσύνης που έχει ο τομέας.

Ελέγξτε αυτήν την [ανάρτηση για περισσότερες λεπτομέρειες](https://0xpatrik.com/subdomain-takeover/)

### **Πιστοποιητικά SSL**
Τα πιστοποιητικά SSL, αν δημιουργηθούν από επιτιθέμενους μέσω υπηρεσιών όπως το [_Let's Encrypt_](https://letsencrypt.org/), προσθέτουν στην νομιμότητα αυτών των ψεύτικων τομέων, καθιστώντας τις επιθέσεις φισινγκ πιο πειστικές.

### **Ασφάλεια των Cookies και Διαφάνεια του Περιηγητή**
Η διαφάνεια του περιηγητή επεκτείνεται επίσης στην ασφάλεια των cookies, που διέπεται από πολιτικές όπως η [Πολιτική Ίδιας Προέλευσης](https://en.wikipedia.org/wiki/Same-origin_policy). Τα cookies, που συχνά χρησιμοποιούνται για τη διαχείριση συνεδριών και την αποθήκευση διαπιστευτηρίων σύνδεσης, μπορούν να εκμεταλλευτούνται μέσω της κατάληψης υποτομέα. Οι επιτιθέμενοι μπορούν να **συλλέξουν cookies συνεδρίας** απλά κατευθύνοντας τους χρήστες σε έναν παραβιασμένο υποτομέα, θέτοντας σε κίνδυνο τα δεδομένα και την ιδιωτικότητα των χρηστών.

### **Emails και Κατάληψη Υποτομέα**
Ένα άλλο στοιχείο της κατάληψης υποτομέα αφορά τις υπηρεσίες email. Οι επιτιθέμενοι μπορούν να παραπλανήσουν τις εγγραφές **MX** για να λαμβάνουν ή να αποστέλλουν emails από ένα νόμιμο υποτομέα, ενισχύοντας την αποτελεσματικότητα των επιθέσεων φισινγκ.

### **Υψηλότεροι Κίνδυνοι**
Περαιτέρω κίνδυνοι περιλαμβάνουν την **κατάληψη εγγραφών NS**. Αν έ
