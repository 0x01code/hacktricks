# Domein/Subdomein oorneem

<details>

<summary><strong>Leer AWS hakwerk vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Gebruik [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) om maklik te bou en **outomatiseer werksvloei** aangedryf deur die w√™reld se **mees gevorderde** gemeenskapshulpmiddels.\
Kry Vandaag Toegang:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Domeinoorneem

As jy 'n domein (domein.tld) ontdek wat **deur 'n diens binne die omvang gebruik word** maar die **maatskappy** het die **eienaarskap** daarvan **verloor**, kan jy probeer om dit te **registreer** (as dit goedkoop genoeg is) en die maatskappy daarvan in kennis stel. As hierdie domein sekere **sensitiewe inligting** ontvang soos 'n sessiekoekie via 'n **GET**-parameter of in die **Verwysings**-kop, is dit beslis 'n **kwesbaarheid**.

### Subdomeinoorneem

'n Subdomein van die maatskappy wys na 'n **derdepartydiens met 'n naam wat nie geregistreer is nie**. As jy 'n **rekening** in hierdie **derdepartydiens kan skep** en die **naam** wat gebruik word, kan **registreer**, kan jy die subdomeinoorneem uitvoer.

Daar is verskeie gereedskappe met woordeboeke om vir moontlike oornames te kyk:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)
* [https://github.com/PentestPad/subzy](https://github.com/PentestPad/subzy)

#### Skandering vir Oorvatbare Subdomeine met [BBOT](https://github.com/blacklanternsecurity/bbot):

Subdomeinoorneemkontroles is ingesluit in BBOT se standaard subdomeinopname. Handtekeninge word direk van [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz) gehaal.
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### Subdomein Oorname Generasie via DNS Wildcard

Wanneer 'n DNS wildcard in 'n domein gebruik word, sal enige aangevraagde subdomein van daardie domein wat nie uitdruklik 'n ander adres het nie, **opgelos word na dieselfde inligting**. Dit kan 'n A ip-adres wees, 'n CNAME...

Byvoorbeeld, as `*.testing.com` wilkaart is na `1.1.1.1`. Dan sal `not-existent.testing.com` na `1.1.1.1` wys.

Maar, as die sysadmin dit in plaas van na 'n IP-adres na 'n **derde party-diens via CNAME** wys, soos 'n **github subdomein** byvoorbeeld (`sohomdatta1.github.io`). 'n Aanvaller kan sy eie derde party-bladsy (in Gihub in hierdie geval) **skep en s√™ dat `something.testing.com` daarheen wys**. Omdat die **CNAME wildcard** saamstem, sal die aanvaller in staat wees om **willekeurige subdomeine vir die domein van die slagoffer te genereer wat na sy bladsye wys**.

Jy kan 'n voorbeeld van hierdie kwesbaarheid in die CTF-verslag vind: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Uitbuiting van 'n subdomein-oornaam

Subdomein-oornaam is in wese DNS-spoofing vir 'n spesifieke domein regoor die internet, wat aanvallers in staat stel om A-rekords vir 'n domein in te stel, wat daartoe lei dat webblaaie inhoud van die aanvaller se bediener wys. Hierdie **deursigtigheid** in webblaaie maak domeine vatbaar vir hengel. Aanvallers kan [_tikfout-hengel_](https://en.wikipedia.org/wiki/Typosquatting) of [_Doppelganger-domeine_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) vir hierdie doel gebruik. Veral vatbaar is domeine waar die URL in 'n hengel-e-pos legitiem lyk, wat gebruikers mislei en spamfilters ontduik as gevolg van die domein se inherente vertroue.

Kyk na hierdie [berig vir verdere besonderhede](https://0xpatrik.com/subdomain-takeover/)

### **SSL-sertifikate**

SSL-sertifikate, indien deur aanvallers gegenereer via dienste soos [_Let's Encrypt_](https://letsencrypt.org/), dra by tot die geloofwaardigheid van hierdie valse domeine, wat hengelaanvalle oortuigender maak.

### **Koekie-sekuriteit en webblaaier-deursigtigheid**

Webblaaier-deursigtigheid strek ook tot koekie-sekuriteit, wat beheer word deur beleide soos die [Gelyke-oorsprong-beleid](https://en.wikipedia.org/wiki/Same-origin\_policy). Koekies, dikwels gebruik om sessies te bestuur en aanmeldingstokens te stoor, kan deur subdomein-oornaam uitgebuit word. Aanvallers kan **sessiekoekies versamel** deur eenvoudig gebruikers na 'n gekompromitteerde subdomein te rig, wat gebruikersdata en privaatheid in gevaar bring.

### **E-posse en subdomein-oornaam**

'n Ander aspek van subdomein-oornaam behels e-posdienste. Aanvallers kan **MX-rekords** manipuleer om e-pos van 'n legitieme subdomein te ontvang of te stuur, wat die doeltreffendheid van hengelaanvalle verhoog.

### **Ho√´r Orde Risiko's**

Verdere risiko's sluit **NS-rekord-oornaam** in. As 'n aanvaller beheer oor een NS-rekord van 'n domein verkry, kan hulle moontlik 'n gedeelte van die verkeer na 'n bediener onder hul beheer rig. Hierdie risiko word versterk as die aanvaller 'n ho√´ **TTL (Tyd om te Lewe)** vir DNS-rekords instel, wat die duur van die aanval verleng.

### CNAME-rekord-kwesbaarheid

Aanvallers kan onge√´iste CNAME-rekords wat na eksterne dienste wys wat nie meer gebruik word of buite werking gestel is, uitbuit. Dit stel hulle in staat om 'n bladsy onder die vertroude domein te skep, wat hengel of malware-verspreiding verder fasiliteer.

### **Versagtingsstrategie√´**

Versagtingsstrategie√´ sluit in:

1. **Verwydering van kwesbare DNS-rekords** - Dit is doeltreffend as die subdomein nie meer benodig word nie.
2. **Eis die domeinnaam op** - Registreer die hulpbron by die betrokke wolkverskaffer of koop 'n vervalde domein terug.
3. **Gereelde monitering vir kwesbaarhede** - Gereedskap soos [aquatone](https://github.com/michenriksen/aquatone) kan help om vatbare domeine te identifiseer. Organisasies moet ook hul infrastruktuurbestuursprosesse hersien, om te verseker dat DNS-rekord-skepping die laaste stap in hulpbron-skepping is en die eerste stap in hulpbron-vernietiging.

Vir wolkverskaffers is die verifikasie van domeinbesit krities om subdomein-oornames te voorkom. Sommige, soos [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/), het hierdie probleem herken en domeinverifikasiemeganismes ge√Ømplementeer.

## Verwysings

* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Gebruik [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) om maklik werkstrome te bou en te **outomatiseer** wat aangedryf word deur die w√™reld se **mees gevorderde** gemeenskapsinstrumente.\
Kry Vandag Toegang:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks in PDF aflaai**, kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
