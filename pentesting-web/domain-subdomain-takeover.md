# Domain/Subdomain takeover

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter**'da **bizi takip edin** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=domain-subdomain-takeover) kullanarak dünyanın **en gelişmiş** topluluk araçlarıyla desteklenen **iş akışlarını** kolayca oluşturun ve **otomatikleştirin**.\
Bugün Erişim Alın:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=domain-subdomain-takeover" %}

## Domain takeover

Eğer bazı hizmetler tarafından **kullanılan** bir domain (domain.tld) keşfettiyseniz ancak **şirket** bunun **sahipliğini** **kaybetmişse**, bunu **kaydetmeyi** (eğer yeterince ucuzsa) deneyebilir ve şirkete bildirebilirsiniz. Eğer bu domain bazı **hassas bilgileri** alıyorsa, örneğin bir oturum çerezi **GET** parametresi veya **Referer** başlığı aracılığıyla, bu kesinlikle bir **açık**tır.

### Subdomain takeover

Şirketin bir alt domaini, **kayıtlı olmayan bir isimle üçüncü taraf bir hizmete** işaret ediyor. Eğer bu **üçüncü taraf hizmette** bir **hesap oluşturabilir** ve kullanılan **isimi** **kaydedebilirseniz**, alt domaini ele geçirebilirsiniz.

Olası ele geçirmeleri kontrol etmek için çeşitli araçlar ve sözlükler mevcuttur:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)
* [https://github.com/PentestPad/subzy](https://github.com/PentestPad/subzy)

#### [BBOT](https://github.com/blacklanternsecurity/bbot) ile Ele Geçirilebilir Alt Domainleri Tarama:

Alt domain ele geçirme kontrolleri BBOT'un varsayılan alt domain belirleme işlemlerine dahildir. İmzalar doğrudan [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz) adresinden alınmaktadır.
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### DNS Wildcard ile Alt Alan Adı Ele Geçirme Üretimi

DNS wildcard bir alanda kullanıldığında, o alanın farklı bir adresi olmayan herhangi bir istenen alt alan adı **aynı bilgilere çözümlenecektir**. Bu bir A IP adresi, bir CNAME olabilir...

Örneğin, `*.testing.com` `1.1.1.1` adresine wildcard olarak ayarlandığında, `not-existent.testing.com` `1.1.1.1` adresine işaret edecektir.

Ancak, bir IP adresine işaret etmek yerine, sistem yöneticisi bunu bir **CNAME aracılığıyla üçüncü taraf bir hizmete** yönlendirirse, örneğin bir **github alt alan adı** (`sohomdatta1.github.io`) gibi. Bir saldırgan **kendi üçüncü taraf sayfasını** (bu durumda GitHub'da) oluşturabilir ve `something.testing.com` adresinin oraya işaret ettiğini söyleyebilir. Çünkü, **CNAME wildcard** saldırgana **kurbanın alanı için keyfi alt alan adları oluşturma** yetkisi verecektir.

Bu güvenlik açığını bir örneğini CTF yazısında bulabilirsiniz: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Alt Alan Adı Ele Geçirme Sömürüsü

Alt alan adı ele geçirme, temelde belirli bir alan için internet genelinde DNS sahtekarlığıdır ve saldırganların bir alan için A kayıtları ayarlamasına olanak tanır, bu da tarayıcıların saldırganın sunucusundan içerik göstermesine neden olur. Bu tarayıcılardaki **şeffaflık**, alanları phishing'e karşı savunmasız hale getirir. Saldırganlar bu amaçla [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) veya [_Doppelganger alanları_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) kullanabilir. Özellikle, bir phishing e-postasında URL'nin meşru göründüğü alanlar savunmasızdır, bu da kullanıcıları kandırarak alanın doğuştan güveni nedeniyle spam filtrelerinden kaçınmalarına neden olur.

Daha fazla ayrıntı için bu [gönderiyi kontrol edin](https://0xpatrik.com/subdomain-takeover/)

### **SSL Sertifikaları**

Saldırganlar tarafından [_Let's Encrypt_](https://letsencrypt.org/) gibi hizmetler aracılığıyla üretilen SSL sertifikaları, bu sahte alanların meşruiyetini artırarak phishing saldırılarını daha inandırıcı hale getirir.

### **Çerez Güvenliği ve Tarayıcı Şeffaflığı**

Tarayıcı şeffaflığı, [Aynı köken politikası](https://en.wikipedia.org/wiki/Same-origin_policy) gibi politikalarla yönetilen çerez güvenliğine de uzanır. Oturumları yönetmek ve giriş belirteçlerini depolamak için sıklıkla kullanılan çerezler, alt alan adı ele geçirme yoluyla istismar edilebilir. Saldırganlar, kullanıcıları tehlikeye atılmış bir alt alan adına yönlendirerek **oturum çerezlerini toplayabilir**, bu da kullanıcı verilerini ve gizliliğini tehlikeye atar.

### **E-postalar ve Alt Alan Adı Ele Geçirme**

Alt alan adı ele geçirmenin bir diğer yönü e-posta hizmetleridir. Saldırganlar, meşru bir alt alan adından e-posta almak veya göndermek için **MX kayıtlarını** manipüle edebilir, bu da phishing saldırılarının etkinliğini artırır.

### **Yüksek Düzey Riskler**

Diğer riskler arasında **NS kaydı ele geçirme** bulunmaktadır. Bir saldırgan bir alanın bir NS kaydını kontrol altına alırsa, trafiğin bir kısmını kendi kontrolündeki bir sunucuya yönlendirebilir. Bu risk, saldırganın DNS kayıtları için yüksek bir **TTL (Yaşam Süresi)** ayarlaması durumunda artar ve saldırının süresini uzatır.

### CNAME Kayıt Açığı

Saldırganlar, artık kullanılmayan veya devre dışı bırakılan dış hizmetlere işaret eden talep edilmemiş CNAME kayıtlarını istismar edebilir. Bu, onlara güvenilir bir alan altında bir sayfa oluşturma imkanı tanır ve phishing veya kötü amaçlı yazılım dağıtımını daha da kolaylaştırır.

### **Azaltma Stratejileri**

Azaltma stratejileri şunları içerir:

1. **Savunmasız DNS kayıtlarını kaldırmak** - Bu, alt alan adı artık gerekli değilse etkilidir.
2. **Alan adını talep etmek** - İlgili bulut sağlayıcısıyla kaynağı kaydetmek veya süresi dolmuş bir alan adını yeniden satın almak.
3. **Savunmasızlıklar için düzenli izleme** - [aquatone](https://github.com/michenriksen/aquatone) gibi araçlar, savunmasız alanları tanımlamaya yardımcı olabilir. Kuruluşlar ayrıca, DNS kaydı oluşturmanın kaynak oluşturmadaki son adım ve kaynak yok etmedeki ilk adım olduğundan emin olarak altyapı yönetim süreçlerini gözden geçirmelidir.

Bulut sağlayıcıları için, alan sahipliğini doğrulamak, alt alan adı ele geçirmelerini önlemek için kritik öneme sahiptir. [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/) gibi bazıları bu sorunu tanımış ve alan doğrulama mekanizmaları uygulamıştır.

## Referanslar

* [https://0xpatrik.com/subdomain-takeover/](https://0xpatrik.com/subdomain-takeover/)

<figure><img src="../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
Dünyanın **en gelişmiş** topluluk araçlarıyla desteklenen **iş akışlarını** kolayca oluşturmak ve **otomatikleştirmek için** [**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_term=trickest&utm_content=domain-subdomain-takeover) kullanın.\
Bugün Erişim Alın:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=domain-subdomain-takeover" %}

{% hint style="success" %}
AWS Hacking'i öğrenin ve pratik yapın:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking'i öğrenin ve pratik yapın: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** bizi takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}
