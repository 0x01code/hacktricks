# рдИрдореЗрд▓ рдЗрдВрдЬреЗрдХреНрд╢рди

<figure><img src="../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдмрдирд╛рдПрдВ рдФрд░ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВ, рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT рд╕рдВрдЧреНрд░рд╣**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ**ред

</details>

## рднреЗрдЬреЗ рдЧрдП рдИрдореЗрд▓ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░реЗрдВ

### рднреЗрдЬрдиреЗ рд╡рд╛рд▓реЗ рддрд░реНрдХ рдХреЗ рдмрд╛рдж Cc рдФрд░ Bcc рдореЗрдВ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░реЗрдВ
```
From:sender@domain.com%0ACc:recipient@domain.co,%0ABcc:recipient1@domain.com
```
рдпрд╣ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдФрд░ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛1 рдЦрд╛рддреЛрдВ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛ред

### рддрд░реНрдХ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░реЗрдВ
```
From:sender@domain.com%0ATo:attacker@domain.com
```
рд╕рдВрджреЗрд╢ рдореВрд▓ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдФрд░ рд╣рдорд▓рд╛рд╡рд░ рдЦрд╛рддреЗ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛ред

### рд╡рд┐рд╖рдп рддрд░реНрдХ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ
```
From:sender@domain.com%0ASubject:This is%20Fake%20Subject
```
рдЬрд╛рд▓реА рд╡рд┐рд╖рдп рдХреЛ рдореВрд▓ рд╡рд┐рд╖рдп рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЗрд╕реЗ рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ рдореЗрд▓ рд╕реЗрд╡рд╛ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░реЗрдЧрд╛ред

### рд╕рдВрджреЗрд╢ рдХреЗ рд╢рд░реАрд░ рдХреЛ рдмрджрд▓реЗрдВ

рджреЛ-рдкрдВрдХреНрддрд┐ рдлреАрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ, рдлрд┐рд░ рдЕрдкрдирд╛ рд╕рдВрджреЗрд╢ рд▓рд┐рдЦреЗрдВ рддрд╛рдХрд┐ рд╕рдВрджреЗрд╢ рдХреЗ рд╢рд░реАрд░ рдХреЛ рдмрджрд▓ рд╕рдХреЗрдВред
```
From:sender@domain.com%0A%0AMy%20New%20%0Fake%20Message.
```
### PHP mail() рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ

The PHP `mail()` function is commonly used to send emails from a web application. However, if not properly secured, it can be vulnerable to email injection attacks. Email injection occurs when an attacker is able to manipulate the email headers and inject malicious content into the email.

PHP `mail()` рдлрд╝рдВрдХреНрд╢рди рдЖрдорддреМрд░ рдкрд░ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ рдИрдореЗрд▓ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдЗрд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ рдИрдореЗрд▓ рдЗрдВрдЬреЗрдХреНрд╢рди рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд░рдорд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдИрдореЗрд▓ рдЗрдВрдЬреЗрдХреНрд╢рди рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм рд╣рдорд▓рд╛рд╡рд░ рдИрдореЗрд▓ рд╣реИрдбрд░реНрд╕ рдХреЛ рдорд╛рдирд┐рдкреБрд░реЗрдЯ рдХрд░рдХреЗ рдИрдореЗрд▓ рдореЗрдВ рджреБрд╖реНрдЯ рд╕рд╛рдордЧреНрд░реА рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

#### Exploiting Email Injection Vulnerabilities

To exploit an email injection vulnerability, an attacker can craft a malicious payload that includes additional email headers. These headers can be used to modify the recipient, subject, or even inject additional recipients into the email.

рдИрдореЗрд▓ рдЗрдВрдЬреЗрдХреНрд╢рди рд╕рдВрдХрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рджреБрд╖реНрдЯ рдкреЗрд▓реЛрдб рддреИрдпрд╛рд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рдИрдореЗрд▓ рд╣реИрдбрд░реНрд╕ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреЗ рд╣реИрдВред рдЗрди рд╣реИрдбрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛, рд╡рд┐рд╖рдп рдпрд╛ рдИрдореЗрд▓ рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

#### Example of Email Injection

Here is an example of a vulnerable PHP code that uses the `mail()` function without proper input validation:

рдпрд╣рд╛рдВ рдПрдХ рдРрд╕рд╛ PHP рдХреЛрдб рдХрд╛ рдЙрджрд╛рд╣рд░рдг рд╣реИ рдЬреЛ рд╕рд╣реА рдЗрдирдкреБрдЯ рдорд╛рдиреНрдпрддрд╛ рдХреЗ рдмрд┐рдирд╛ `mail()` рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ:

```php
<?php
$to = $_POST['to'];
$subject = $_POST['subject'];
$message = $_POST['message'];

mail($to, $subject, $message);
?>
```

In this example, the values for the recipient (`$to`), subject (`$subject`), and message (`$message`) are directly taken from user input without any validation. This allows an attacker to manipulate these values and inject additional email headers.

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ (`$to`), рд╡рд┐рд╖рдп (`$subject`) рдФрд░ рд╕рдВрджреЗрд╢ (`$message`) рдХреЗ рд▓рд┐рдП рдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рд╕реЗ рд╕реАрдзреЗ рд▓рд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдорд╛рдиреНрдпрддрд╛ рдХреЗред рдЗрд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЗрди рдорд╛рдиреЛрдВ рдХреЛ рдорд╛рдирд┐рдкреБрд░реЗрдЯ рдХрд░рдиреЗ рдФрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдИрдореЗрд▓ рд╣реИрдбрд░реНрд╕ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред

#### Prevention Techniques

To prevent email injection attacks, it is important to properly validate and sanitize user input before using it in the `mail()` function. This can be done by:

- Validating and sanitizing user input using appropriate functions or regular expressions.
- Using whitelisting techniques to only allow specific characters or patterns in the input.
- Implementing proper input validation and sanitization measures throughout the application.

рдИрдореЗрд▓ рдЗрдВрдЬреЗрдХреНрд╢рди рд╣рдорд▓реЛрдВ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП, `mail()` рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдХреА рд╕рд╣реА рдорд╛рдиреНрдпрддрд╛ рдФрд░ рд╕реИрдирд┐рдЯрд╛рдЗрдЬрд╝реЗрд╢рди рдХрд░рдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

- рдЙрдкрдпреБрдХреНрдд рдлрд╝рдВрдХреНрд╢рди рдпрд╛ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдХреА рдорд╛рдиреНрдпрддрд╛ рдФрд░ рд╕реИрдирд┐рдЯрд╛рдЗрдЬрд╝реЗрд╢рди рдХрд░рдирд╛ред
- рдЗрдирдкреБрдЯ рдореЗрдВ рдХреЗрд╡рд▓ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╡рд░реНрдг рдпрд╛ рдкреИрдЯрд░реНрди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред
- рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рд╕рд╣реА рдорд╛рдиреНрдпрддрд╛ рдФрд░ рд╕реИрдирд┐рдЯрд╛рдЗрдЬрд╝реЗрд╢рди рдЙрдкрд╛рдпреЛрдЧ рдХрд░рдирд╛ред
```bash
# The function has the following definition:

php --rf mail

Function [ <internal:standard> function mail ] {
- Parameters [5] {
Parameter #0 [ <required> $to ]
Parameter #1 [ <required> $subject ]
Parameter #2 [ <required> $message ]
Parameter #3 [ <optional> $additional_headers ]
Parameter #4 [ <optional> $additional_parameters ]
}
}
```
#### рдкрд╛рдВрдЪрд╡рд╛рдВ рдкреИрд░рд╛рдореАрдЯрд░ ($рдЕрддрд┐рд░рд┐рдХреНрдд_рдкреИрд░рд╛рдореАрдЯрд░)

рдЗрд╕ рдЦрдВрдб рдореЗрдВ рд╣рдо **рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╣ рдорд╛рдирдХрд┐рдд рдХрд░реЗрдВрдЧреЗ рдЬрдм рдХрд┐рд╕реА рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ рдЗрд╕рдХрд╛ рдирд┐рдпрдВрддреНрд░рдг рд╣реЛрддрд╛ рд╣реИ**ред

рдпрд╣ рдкреИрд░рд╛рдореАрдЯрд░ PHP рджреНрд╡рд╛рд░рд╛ рдмрд╛рдЗрдирд░реА рд╕реЗрдВрдбрдореЗрд▓ рдХреЛ рдЖрдордВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕реЗ рдлрд╝рдВрдХреНрд╢рди `escapeshellcmd($рдЕрддрд┐рд░рд┐рдХреНрдд_рдкреИрд░рд╛рдореАрдЯрд░)` рдХреЗ рд╕рд╛рде рд╕реИрдирд┐рдЯрд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **рд╕реЗрдВрдбрдореЗрд▓ рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░рд┐рдХреНрдд рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред

#### /usr/sbin/sendmail рдХреЗ рдЕрдВрддрд░

**sendmail** рдЗрдВрдЯрд░рдлрд╝реЗрд╕ **MTA рдИрдореЗрд▓ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░** (Sendmail, Postfix, Exim рдЖрджрд┐) рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, **рдореБрдЦреНрдп рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛** (-t -i -f рдкреИрд░рд╛рдореАрдЯрд░ рдЬреИрд╕реЗ) рд╕рдВрдЧрддрддрд╛ рдХреЗ рдХрд╛рд░рдг **рдПрдХ рд╣реА рд░рд╣рддреА рд╣реИ**, **рдЕрдиреНрдп рдлрд╝рдВрдХреНрд╢рди рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░** MTA рдХреЗ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрдиреЗ рдкрд░ рдмрд╣реБрдд рдЕрдзрд┐рдХ рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣рд╛рдВ рдХреБрдЫ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ sendmail рдХрдорд╛рдВрдб/рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдореИрди рдкреЗрдЬ рдХреЗ:

* Sendmail MTA: http://www.sendmail.org/\~ca/email/man/sendmail.html
* Postfix MTA: http://www.postfix.org/mailq.1.html
* Exim MTA: https://linux.die.net/man/8/eximReferences

**sendmail рдХреЗ рдореВрд▓реНрдп рдХреЗ рдЖрдзрд╛рд░ рдкрд░** рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреА рдЦреЛрдЬ рдХреА рдЧрдИ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдлрд┐рд░ рдЕрдирд┐рдпрдорд┐рдд рдХрдорд╛рдВрдбреНрд╕ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рджреЗрдЦреЗрдВ рдХреИрд╕реЗ [**https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html**](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html) рдореЗрдВред

## рдИрдореЗрд▓ рдирд╛рдо рдореЗрдВ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░реЗрдВ

### рдИрдореЗрд▓ рдХреЗ рдЕрдирджреЗрдЦреЗ рд╣рд┐рд╕реНрд╕реЗ

рдЪрд┐рд╣реНрди: **+, -** рдФрд░ **{}** рдЕрд╕рд╛рдорд╛рдиреНрдп рдореМрдХреЛрдВ рдкрд░ рдЯреИрдЧрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдзрд┐рдХрд╛рдВрд╢ рдИрдореЗрд▓ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдЕрдирджреЗрдЦрд╛ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ

* рдЙрджрд╛ред john.doe+intigriti@example.com тЖТ john.doe@example.com

**рджреЛрдиреЛрдВ рдУрд░ рд╕реЗ рдмреНрд░реИрдХреЗрдЯреНрд╕ () рдХреЗ рдмреАрдЪ рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдВ** рднреА рдЕрдирджреЗрдЦреА рдХреА рдЬрд╛рдПрдВрдЧреА

* рдЙрджрд╛ред john.doe(intigriti)@example.com тЖТ john.doe@example.com

### рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдмрд╛рдИрдкрд╛рд╕

<figure><img src="../.gitbook/assets/image (4) (6).png" alt=""><figcaption></figcaption></figure>

### рдЙрджреНрдзрд░рдг

<figure><img src="../.gitbook/assets/image (6) (4).png" alt=""><figcaption></figcaption></figure>

### рдЖрдИрдкреА

рдЖрдк рд╡рд░реНрдЧрд╛рдХрд╛рд░ рдмреНрд░реИрдХреЗрдЯреНрд╕ рдХреЗ рдмреАрдЪ рдбреЛрдореЗрди рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдИрдкреА рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* john.doe@\[127.0.0.1]
* john.doe@\[IPv6:2001:db8::1]

### рдЕрдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реНрдмрд▓рддрд╛рдПрдВ

![](<../.gitbook/assets/image (296).png>)

## рддреГрддреАрдп рдкрдХреНрд╖ SSO

### XSS

рдХреБрдЫ рд╕реЗрд╡рд╛рдПрдВ рдЬреИрд╕реЗ **github** рдпрд╛ **salesforce** рдЖрдкрдХреЛ рдПрдХ **XSS рдкреЗрд▓реЛрдб рдХреЗ рд╕рд╛рде рдИрдореЗрд▓ рдкрддрд╛ рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВ**ред рдпрджрд┐ рдЖрдк рдЗрд╕ рдкреНрд░рджрд╛рддрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рд╕реЗрд╡рд╛рдПрдВ рдИрдореЗрд▓ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕реИрдирд┐рдЯрд╛рдЗрдЬрд╝ рдирд╣реАрдВ рдХрд░ рд░рд╣реА рд╣реИрдВ, рддреЛ рдЖрдк XSS рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддреЗ рд╣реИрдВред

### рдЦрд╛рддрд╛ рдЕрдзрд┐рдХрд╛рд░

рдпрджрд┐ **SSO рд╕реЗрд╡рд╛** рдЖрдкрдХреЛ **рджрд┐рдП рдЧрдП рдИрдореЗрд▓ рдкрддреЗ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд┐рдП рдмрд┐рдирд╛ рдЦрд╛рддрд╛ рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ** (рдЬреИрд╕реЗ **salesforce**) рдФрд░ рдлрд┐рд░ рдЖрдк рдЙрд╕ рдЦрд╛рддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЕрд▓рдЧ рд╕реЗрд╡рд╛ рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ salesforce рдХрд╛ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд░рддреА рд╣реИ, рддреЛ рдЖрдк рдХрд┐рд╕реА рднреА рдЦрд╛рддреЗ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ salesforce рджреНрд╡рд╛рд░рд╛ рджрд┐рдП рдЧрдП рдИрдореЗрд▓ рдХреА рдкреБрд╖реНрдЯрд┐ рдХреА рдЬрд╛рддреА рд╣реИ рд▓реЗрдХрд┐рди рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдзреНрдпрд╛рди рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдПред

## рдЬрд╡рд╛рдм-рдХреЛ

рдЖрдк _**From: company.com**_ рдФрд░ _**Replay-To: attacker.com**_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдИрдореЗрд▓
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рд╛рдиреА рд╕реЗ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдмрдирд╛рдПрдВ рдФрд░ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВ, рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
