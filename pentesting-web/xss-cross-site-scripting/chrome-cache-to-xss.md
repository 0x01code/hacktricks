# Chrome Cache to XSS

<details>

<summary><strong>Aprende a hackear AWS desde cero hasta convertirte en un experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obt√©n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

M√°s detalles en [**este informe**](https://blog.arkark.dev/2022/11/18/seccon-en/#web-spanote).

La t√©cnica discutida aqu√≠ implica comprender el comportamiento y la interacci√≥n de dos tipos principales de cach√©: la **cach√© de retroceso/avance (bfcache)** y la **cach√© de disco**. El bfcache, que almacena una instant√°nea completa de una p√°gina incluyendo el mont√≥n de JavaScript, tiene prioridad sobre la cach√© de disco para las navegaciones de retroceso/avance debido a su capacidad para almacenar una instant√°nea m√°s completa. La cach√© de disco, en cambio, almacena recursos obtenidos de la web sin incluir el mont√≥n de JavaScript, y se utiliza para las navegaciones de retroceso/avance para reducir los costos de comunicaci√≥n. Un aspecto interesante de la cach√© de disco es su inclusi√≥n de recursos obtenidos usando `fetch`, lo que significa que los recursos de URL accedidos ser√°n renderizados por el navegador desde la cach√©.

### Puntos Clave:

- El **bfcache** tiene precedencia sobre la cach√© de disco en las navegaciones de retroceso/avance.
- Para utilizar una p√°gina almacenada en la cach√© de disco en lugar del bfcache, este √∫ltimo debe estar deshabilitado.

### Deshabilitar bfcache:

Por defecto, Puppeteer deshabilita el bfcache, aline√°ndose con las condiciones enumeradas en la documentaci√≥n de Chromium. Un m√©todo efectivo para deshabilitar el bfcache es a trav√©s del uso de `RelatedActiveContentsExist`, logrado abriendo una p√°gina con `window.open()` que retiene una referencia a `window.opener`.

### Reproducir el comportamiento:

1. Visita una p√°gina web, por ejemplo, `https://example.com`.
2. Ejecuta `open("http://spanote.seccon.games:3000/api/token")`, lo que resulta en una respuesta del servidor con un c√≥digo de estado 500.
3. En la pesta√±a reci√©n abierta, navega a `http://spanote.seccon.games:3000/`. Esta acci√≥n almacena la respuesta de `http://spanote.seccon.games:3000/api/token` como una cach√© de disco.
4. Usa `history.back()` para retroceder. La acci√≥n resulta en la renderizaci√≥n de la respuesta JSON almacenada en la p√°gina.

La confirmaci√≥n de que se utiliz√≥ la cach√© de disco se puede verificar mediante el uso de DevTools en Google Chrome.

Para m√°s detalles sobre bfcache y cach√© de disco, se pueden encontrar referencias en [web.dev sobre bfcache](https://web.dev/i18n/en/bfcache/) y en [los documentos de dise√±o de Chromium sobre cach√© de disco](https://www.chromium.org/developers/design-documents/network-stack/disk-cache/), respectivamente.


<details>

<summary><strong>Aprende a hackear AWS desde cero hasta convertirte en un experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obt√©n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
