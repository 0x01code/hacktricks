# DOM XSS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗред**

</details>

## **DOM vulnerabilities**

> **рд╕реНрд░реЛрдд**
>
> рд╕реНрд░реЛрдд рдПрдХ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреНрд░реЙрдкрд░реНрдЯреА рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдЖрдХреНрд░рдордХ рдирд┐рдпрдВрддреНрд░рд┐рдд рдбреЗрдЯрд╛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИред рд╕реНрд░реЛрдд рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг `location.search` рдкреНрд░реЙрдкрд░реНрдЯреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХреНрд╡реЗрд░реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╕реЗ рдЗрдирдкреБрдЯ рдкрдврд╝рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдЖрдХреНрд░рдордХ рдХрдВрдЯреНрд░реЛрд▓ рдХрд░рдирд╛ рдЖрдХреНрд░рдордХ рдХреЗ рд▓рд┐рдП рдЕрдкреЗрдХреНрд╖рд┐рдд рд╣реЛрддрд╛ рд╣реИред рдЕрдВрддрддрдГ, рдХрд┐рд╕реА рднреА рдкреНрд░реЙрдкрд░реНрдЯреА рдЬрд┐рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рд╕реНрд░реЛрдд рд╣реИред рдЗрд╕рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд URL (рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдХрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ `document.referrer` рд╕реНрдЯреНрд░рд┐рдВрдЧ), рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХреБрдХреА (рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдХрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ `document.cookie` рд╕реНрдЯреНрд░рд┐рдВрдЧ), рдФрд░ рд╡реЗрдм рд╕рдВрджреЗрд╢ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

> **рд╕рд┐рдВрдХ**
>
> рд╕рд┐рдВрдХ рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рдЦрддрд░рдирд╛рдХ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлрдВрдХреНрд╢рди рдпрд╛ DOM рдСрдмреНрдЬреЗрдХреНрдЯ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдпрджрд┐ рдЖрдХреНрд░рдордХ рдирд┐рдпрдВрддреНрд░рд┐рдд рдбреЗрдЯрд╛ рдЙрд╕реЗ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдЕрд╡рд╛рдВрдЫрдиреАрдп рдкреНрд░рднрд╛рд╡ рдкреИрджрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `eval()` рдлрдВрдХреНрд╢рди рдПрдХ рд╕рд┐рдВрдХ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЙрд╕ рддрд░реНрдХ рдХреЛ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЙрд╕реЗ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдЪрдЯреАрдПрдордПрд▓ рд╕рд┐рдВрдХ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг `document.body.innerHTML` рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЖрдХреНрд░рдордХ рдПрдЪрдЯреАрдПрдордПрд▓ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдиреЗ рдФрд░ рдЕрдирд┐рдпрдорд┐рдд рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдкреНрд░рдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рджреЗрддрд╛ рд╣реИред

рдореВрд▓ рд░реВрдк рд╕реЗ, DOM-рдЖрдзрд╛рд░рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдХреА рдХрдорд┐рдпрд╛рдБ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдПрдХ рд╡реЗрдмрд╕рд╛рдЗрдЯ **рд╕реНрд░реЛрдд рд╕реЗ рдбреЗрдЯрд╛ рдХреЛ рд╕рд┐рдВрдХ рдореЗрдВ рдкрд╛рд╕ рдХрд░рддреА рд╣реИ**, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рддреНрд░ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рддрд░реАрдХреЗ рд╕реЗ рд╣реИрдВрдбрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

{% hint style="info" %}
**рдЖрдк** [**https://github.com/wisec/domxsswiki/wiki**](https://github.com/wisec/domxsswiki/wiki) **рдореЗрдВ рдЕрджреНрдпрддрд┐рдд рд╕реНрд░реЛрдд рдФрд░ рд╕рд┐рдВрдХ рдХреА рд╕реВрдЪреА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред**
{% endhint %}

**рд╕рд╛рдорд╛рдиреНрдп рд╕реНрд░реЛрдд:**
```javascript
document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database
```
**рд╕рд╛рдорд╛рдиреНрдп рд╕рд┐рдВрдХ:**

| [**рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ**](dom-xss.md#open-redirect)                                    | [**рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрдВрдЬреЗрдХреНрд╢рди**](dom-xss.md#javascript-injection)                         | [**DOM-рдбреЗрдЯрд╛ рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди**](dom-xss.md#dom-data-manipulation) | **рдЬреЗрдХреНрд╡реЗрд░реА**                                                             |
| -------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- | ------------------------------------------------------------- | ---------------------------------------------------------------------- |
| `location`                                                                       | `eval()`                                                                            | `scriptElement.src`                                           | `add()`                                                                |
| `location.host`                                                                  | `Function() constructor`                                                            | `scriptElement.text`                                          | `after()`                                                              |
| `location.hostname`                                                              | `setTimeout()`                                                                      | `scriptElement.textContent`                                   | `append()`                                                             |
| `location.href`                                                                  | `setInterval()`                                                                     | `scriptElement.innerText`                                     | `animate()`                                                            |
| `location.pathname`                                                              | `setImmediate()`                                                                    | `someDOMElement.setAttribute()`                               | `insertAfter()`                                                        |
| `location.search`                                                                | `execCommand()`                                                                     | `someDOMElement.search`                                       | `insertBefore()`                                                       |
| `location.protocol`                                                              | `execScript()`                                                                      | `someDOMElement.text`                                         | `before()`                                                             |
| `location.assign()`                                                              | `msSetImmediate()`                                                                  | `someDOMElement.textContent`                                  | `html()`                                                               |
| `location.replace()`                                                             | `range.createContextualFragment()`                                                  | `someDOMElement.innerText`                                    | `prepend()`                                                            |
| `open()`                                                                         | `crypto.generateCRMFRequest()`                                                      | `someDOMElement.outerText`                                    | `replaceAll()`                                                         |
| `domElem.srcdoc`                                                                 | **\`\`**[**рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓-рдкрде рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди**](dom-xss.md#local-file-path-manipulation) | `someDOMElement.value`                                        | `replaceWith()`                                                        |
| `XMLHttpRequest.open()`                                                          | `FileReader.readAsArrayBuffer()`                                                    | `someDOMElement.name`                                         | `wrap()`                                                               |
| `XMLHttpRequest.send()`                                                          | `FileReader.readAsBinaryString()`                                                   | `someDOMElement.target`                                       | `wrapInner()`                                                          |
| `jQuery.ajax()`                                                                  | `FileReader.readAsDataURL()`                                                        | `someDOMElement.method`                                       | `wrapAll()`                                                            |
| `$.ajax()`                                                                       | `FileReader.readAsText()`                                                           | `someDOMElement.type`                                         | `has()`                                                                |
| **\`\`**[**рдПрдЬреЗрдХреНрд╕ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди**](dom-xss.md#ajax-request-manipulation)    | `FileReader.readAsFile()`                                                           | `someDOMElement.backgroundImage`                              | `constructor()`                                                        |
| `XMLHttpRequest.setRequestHeader()`                                              | `FileReader.root.getFile()`                                                         | `someDOMElement.cssText`                                      | `init()`                                                               |
| `XMLHttpRequest.open()`                                                          | `FileReader.root.getFile()`                                                         | `someDOMElement.codebase`                                     | `index()`                                                              |
| `XMLHttpRequest.send()`                                                          | [**рд▓рд┐рдВрдХ рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди**](dom-xss.md#link-manipulation)                               | `someDOMElement.innerHTML`                                    | `jQuery.parseHTML()`                                                   |
| `jQuery.globalEval()`                                                            | `someDOMElement.href`                                                               | `someDOMElement.outerHTML`                                    | `$.parseHTML()`                                                        |
| `$.globalEval()`                                                                 | `someDOMElement.src`                                                                | `someDOMElement.insertAdjacentHTML`                           | [**рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб JSON рдЗрдВрдЬреЗрдХреНрд╢рди**](dom-xss.md#client-side-sql-injection) |
| **\`\`**[**HTML5-рд╕реНрдЯреЛрд░реЗрдЬ рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди**](dom-xss.md#html-5-storage-manipulation) | `someDOMElement.action`                                                             | `someDOMElement.onevent`                                      | `JSON.parse()`                                                         |
| `sessionStorage.setItem()`                                                       | [**XPath рдЗрдВрдЬреЗрдХреНрд╢рди**](dom-xss.md#xpath-injection)                                   | `document.write()`                                            | `jQuery.parseJSON()`                                                   |
| `localStorage.setItem()`                                                         | `document.evaluate()`                                                               | `document.writeln()`                                          | `$.parseJSON()`                                                        |
| **``**[**`рд╕реЗрд╡рд╛ рдХреА рдирдХрд╛рд░рд╛рддреНрдордХрддрд╛`**](dom-xss.md#denial-of-service)**``**              | `someDOMElement.evaluate()`                                                         | `document.title`                                              | **\`\`**[**рдХреБрдХреА рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди**](dom-xss.md#cookie-manipulation)      |
| `requestFileSystem()`                                                            | **\`\`**[**рджрд╕реНрддрд╛рд╡реЗрдЬрд╝-рдбреЛрдореЗрди рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди**](dom-xss.md#document-domain-manipulation) | `document.implementation.createHTMLDocument()`                | `document.cookie`                                                      |
| `RegExp()`                                                                       | `document.domain`                                                                   | `history.pushState()`                                         | [**рд╡реЗрдмрд╕реЙрдХреЗрдЯ-URL рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ**](dom-xss.md#websocket-url-poisoning)      |
| [**рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб SQL рдЗрдВрдЬреЗрдХреНрд╢рди**](dom-xss.md#client-side-sql-injection)            | [**рд╡реЗрдм-рд╕рдВрджреЗрд╢ рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди**](dom-xss.md#web-message-manipulation)                 | `history.replaceState()`                                      | `WebSocket`                                                            |
| `executeSql()`                                                                   | `postMessage()`                                                                     | \`\`                                                          | \`\`                                                                   |

**`innerHTML`** рд╕рд┐рдВрдХ рдХрд┐рд╕реА рднреА рдЖрдзреБрдирд┐рдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдкрд░ `script` рддрддреНрд╡реЛрдВ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рди рд╣реА `svg onload` рдШрдЯрдирд╛рдПрдВ рдЪрд▓реЗрдВрдЧреАред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЖрдкрдХреЛ `img` рдпрд╛ `iframe` рдЬреИрд╕реЗ рд╡реИрдХрд▓реНрдкрд┐рдХ рддрддреНрд╡реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ XSS рд╢рд╛рдпрдж **рд╕рдмрд╕реЗ рдореБрд╢реНрдХрд┐рд▓ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП** рд╣реЛрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЖрдкрдХреЛ JS рдХреЛрдб рдХреЗ рдЕрдВрджрд░ рджреЗрдЦрдирд╛ рд╣реЛрдЧрд╛, рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╡рд╣ рдХрд┐рд╕реА рдРрд╕реЗ рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ **рдореВрд▓реНрдп рдЖрдк рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ**, рдФрд░ рдЙрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ **рддрд░реАрдХрд╛ рд╣реИ** рдЬрд┐рд╕рд╕реЗ рдЖрдк рдЗрд╕реЗ рджреБрд░реБрд╕реНрдд рдХрд░рдХреЗ рдЕрдиреБрдорд╛рдирд┐рдд JS рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## рдЗрдиреНрд╣реЗрдВ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг

* [https://github.com/mozilla/eslint-plugin-no-unsanitized](https://github.com/mozilla/eslint-plugin-no-unsanitized)

## рдЙрджрд╛рд╣рд░рдг

### рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/open-redirection](https://portswigger.net/web-security/dom-based/open-redirection)

#### рдХреИрд╕реЗ

DOM-рдЖрдзрд╛рд░рд┐рдд рдУрдкрди-рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╕рдВрд░рдЪрдирд╛рдПрдВ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╣рдорд▓рд╛рд╡рд░-рдирд┐рдпрдВрддреНрд░рд┐рдд рдбреЗрдЯрд╛** рдХреЛ рдПрдХ **рд╕рд┐рдВрдХ** рдореЗрдВ рд▓рд┐рдЦрддрд╛ рд╣реИ рдЬреЛ **рдХреНрд░реЙрд╕-рдбреЛрдореЗрди рдиреЗрд╡рд┐рдЧреЗрд╢рди** рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдпрджрд┐ рдЖрдк URL рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬрд╣рд╛рдВ рдкреАрдбрд╝рд┐рдд рдХреЛ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**, рддреЛ рдЖрдк **рдЕрдиреБрдорд╛рдирд┐рдд рдХреЛрдб** рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ: **`javascript:alert(1)`**

#### рд╕рд┐рдВрдХреНрд╕
```
location
location.host
location.hostname
location.href
location.pathname
location.search
location.protocol
location.assign()
location.replace()
open()
domElem.srcdoc
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.ajax()
$.ajax()
```
### рдХреБрдХреА рдореЗрдВ рдЦреЗрд▓рдирд╛

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/cookie-manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)

#### рдХреИрд╕реЗ

DOM-рдЖрдзрд╛рд░рд┐рдд рдХреБрдХреА-рдореЗрдирд┐рдкреБрд▓реЗрд╢рди рд╕рдВрдХрдЯ рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╣рдорд▓рд╛рд╡рд░-рдирд┐рдпрдВрддреНрд░рдгреАрдп рдбреЗрдЯрд╛ рдХреЛ рдХреБрдХреА рдХреЗ рдорд╛рди рдореЗрдВ рд▓рд┐рдЦрддрд╛ рд╣реИ**ред\
рдпрд╣ рд╡реЗрдм рдкреЗрдЬ рдХреЛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдврдВрдЧ рд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдпрджрд┐ рдХреБрдХреА рд╡реЗрдм рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИ) рдпрд╛ рдПрдХ [рд╕рддреНрд░ рд╕реНрдерд╛рдкрдирд╛](../hacking-with-cookies/#session-fixation) рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП (рдпрджрд┐ рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рддреНрд░ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)ред

#### рд╕реНрд░реЛрдд
```
document.cookie
```
### рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрдВрдЬреЗрдХреНрд╢рди

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/javascript-injection](https://portswigger.net/web-security/dom-based/javascript-injection)

#### рдХреИрд╕реЗ

DOM-рдЖрдзрд╛рд░рд┐рдд рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрдВрдЬреЗрдХреНрд╢рди рд╕рдВрдХрдЯ рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╣рдорд▓рд╛рд╡рд░-рдирд┐рдпрдВрддреНрд░рдгреАрдп рдбреЗрдЯрд╛ рдХреЛ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд░рддрд╛ рд╣реИ**ред

#### рд╕рд┐рдВрдХреНрд╕
```
eval()
Function() constructor
setTimeout()
setInterval()
setImmediate()
execCommand()
execScript()
msSetImmediate()
range.createContextualFragment()
crypto.generateCRMFRequest()
```
### рджрд╕реНрддрд╛рд╡реЗрдЬрд╝-рдбреЛрдореЗрди рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/document-domain-manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)

#### рдХреИрд╕реЗ

рджрд╕реНрддрд╛рд╡реЗрдЬрд╝-рдбреЛрдореЗрди рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди рд╕рдВрдХрдЯ рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╣рдорд▓рд╛рд╡рд░-рдирд┐рдпрдВрддреНрд░рдгреАрдп рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ** рддрд╛рдХрд┐ **`document.domain`** рдЧреБрдгрд╕реВрддреНрд░ рдХреЛ рд╕реЗрдЯ рдХрд░ рд╕рдХреЗред

`document.domain` рдЧреБрдгрд╕реВрддреНрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░реНрд╕ рджреНрд╡рд╛рд░рд╛ **рд╕рдорд╛рди рдореВрд▓ рдиреАрддрд┐** рдХреЗ **рдкреНрд░рд╡рд░реНрддрди** рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ **рджреЛ рдкреГрд╖реНрда** **рдЕрд▓рдЧ-рдЕрд▓рдЧ** рдореВрд▓реЛрдВ рд╕реЗ **рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдПрдХ рд╣реА `document.domain`** рдорд╛рди рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╡реЗ рджреЛ рдкреГрд╖реНрда **рд╡рд┐рд╡рд╛рджрд┐рдд рддрд░реАрдХреЛрдВ рдореЗрдВ рд╕рдВрд╡рд╛рдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдмреНрд░рд╛рдЙрдЬрд╝рд░реНрд╕ **рдЖрдорддреМрд░ рдкрд░ рдХреБрдЫ рдкреНрд░рддрд┐рдмрдВрдз** рд▓рдЧрд╛рддреЗ рд╣реИрдВ `document.domain` рдХреЛ рд╕реМрдВрдкрдиреЗ рдХреЗ рд▓рд┐рдП, рдФрд░ рдкреГрд╖реНрда рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдореВрд▓ рд╕реЗ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ рдореВрд▓реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рд░реЛрдХ рд╕рдХрддреЗ рд╣реИрдВред **рд▓реЗрдХрд┐рди рдпрд╣ рд╣рдореЗрд╢рд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ** рдФрд░ рд╡реЗ рдЖрдорддреМрд░ рдкрд░ **рдмрдЪреНрдЪрд╛** рдпрд╛ **рдорд╛рддрд╛-рдкрд┐рддрд╛** рдбреЛрдореЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред

#### рд╕реНрд░реЛрдд
```
document.domain
```
### WebSocket-URL poisoning

From: [https://portswigger.net/web-security/dom-based/websocket-url-poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)

#### рдХреИрд╕реЗ

WebSocket-URL poisoning рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рдирд┐рдпрдВрддреНрд░рдг рдпреЛрдЧреНрдп рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдПрдХ WebSocket рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рдХреНрд╖реНрдп URL рдХреЗ рд░реВрдк рдореЗрдВ**ред

#### Sinks

`WebSocket` constructor WebSocket-URL poisoning vulnerabilities рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред

### рд▓рд┐рдВрдХ рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди

From: [https://portswigger.net/web-security/dom-based/link-manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)

#### рдХреИрд╕реЗ

DOM-based link-manipulation vulnerabilities рддрдм рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╣рдорд▓рд╛рд╡рд░-рдирд┐рдпрдВрддреНрд░рдг рдпреЛрдЧреНрдп рдбреЗрдЯрд╛ рдХреЛ рдореМрдЬреВрджрд╛ рдкреЗрдЬ рдХреЗ рднреАрддрд░ рдиреЗрд╡рд┐рдЧреЗрд╢рди рд▓рдХреНрд╖реНрдп рдХреЗ рд░реВрдк рдореЗрдВ рд▓рд┐рдЦрддрд╛ рд╣реИ**, рдЬреИрд╕реЗ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд▓рд┐рдВрдХ рдпрд╛ рдПрдХ рдлреЙрд░реНрдо рдХреЗ рд╕рдмрдорд┐рд╢рди URLред

#### Sinks
```
someDOMElement.href
someDOMElement.src
someDOMElement.action
```
### рдПрдЬреЗрдХреНрд╕ рдЕрдиреБрд░реЛрдз рдореЗрдВ рджрдЦрд▓ рджреЗрдиреЗ рдХреА рд╡рд┐рдзрд┐

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)

#### рдХреИрд╕реЗ

рдПрдЬреЗрдХреНрд╕ рдЕрдиреБрд░реЛрдз рдореЗрдВ рджрдЦрд▓ рджреЗрдиреЗ рдХреА рд╡рд┐рдзрд┐ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдХ `XmlHttpRequest` рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрд╛рд░реА рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдПрдХ рдПрдЬреЗрдХреНрд╕ рдЕрдиреБрд░реЛрдз рдореЗрдВ **рд╣рдорд▓рд╛рд╡рд░-рдирд┐рдпрдВрддреНрд░рдг рдпреЛрдЧреНрдп рдбреЗрдЯрд╛** рд▓рд┐рдЦрддрд╛ рд╣реИред

#### рд╕реНрд░реЛрдд
```
XMLHttpRequest.setRequestHeader()
XMLHttpRequest.open()
XMLHttpRequest.send()
jQuery.globalEval()
$.globalEval()
```
### рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓-рдкрде рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/local-file-path-manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)

#### рдХреИрд╕реЗ

рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓-рдкрде рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди рд╕рдВрдХрдЯ рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╣рдорд▓рд╛рд╡рд░-рдирд┐рдпрдВрддреНрд░рдгреАрдп рдбреЗрдЯрд╛ рдХреЛ рдлрд╝рд╛рдЗрд▓-рд╣реИрдВрдбрд▓рд┐рдВрдЧ API рдХреЗ `filename` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИ**ред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рд╕рдВрдХрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ URL рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ, рдпрджрд┐ рджреВрд╕рд░реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рджреЗрдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдПрдХ рд╡рд┐рдЪрд┐рддреНрд░ рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓ рдЦреЛрд▓рдиреЗ/рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрд░рд┐рдд рдХрд░реЗрдЧрд╛**ред

#### рд╕реНрд░реЛрдд
```
FileReader.readAsArrayBuffer()
FileReader.readAsBinaryString()
FileReader.readAsDataURL()
FileReader.readAsText()
FileReader.readAsFile()
FileReader.root.getFile()
FileReader.root.getFile()
```
### рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб SQL рдЗрдВрдЬреЗрдХреНрд╢рди

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/client-side-sql-injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)

#### рдХреИрд╕реЗ

рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб SQL рдЗрдВрдЬреЗрдХреНрд╢рди рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рдПрдХ рдЕрдкрд░рд╛рдзреА рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб SQL рдХреНрд╡реЗрд░реА рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ**.

#### рд╕рд┐рдВрдХреНрд╕
```
executeSql()
```
### HTML5-storage рдкрд░рд┐рд╡рд░реНрддрди

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/html5-storage-manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)

#### рдХреИрд╕реЗ

HTML5-storage рдкрд░рд┐рд╡рд░реНрддрди рд╕рдВрдХрдЯрд┐рддрддрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╡реЗрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ HTML5 рд╕рдВрдЧреНрд░рд╣ рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░реНрддреА рдирд┐рдпрдВрддреНрд░рдг рд╡рд╛рд▓рд╛ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИ** (рдпрд╛ рддреЛ `localStorage` рдпрд╛ `sessionStorage` рдореЗрдВ)ред\
рдпрд╣ **рд╡реНрдпрд╡рд╣рд╛рд░ рд╕реНрд╡рдпрдВ рдореЗрдВ рдХреЛрдИ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдХрдЯ рдирд╣реАрдВ рд╣реИ**ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдмрд╛рдж рдореЗрдВ **рд╕рдВрдЧреНрд░рд╣ рд╕реЗ рдбреЗрдЯрд╛ рдкрдврд╝рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд░рддрд╛ рд╣реИ**, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рднрдВрдбрд╛рд░рдг рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд╣ рдЕрдиреНрдп DOM-рдЖрдзрд╛рд░рд┐рдд рд╣рдорд▓реЛрдВ, рдЬреИрд╕реЗ рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рдФрд░ JavaScript рдЗрдВрдЬреЗрдХреНрд╢рди, рдХреЛ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред

#### рд╕реНрд░реЛрдд
```
sessionStorage.setItem()
localStorage.setItem()
```
### XPath рдЕрдкрд╡рд╛рдж

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/client-side-xpath-injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)

#### рдХреИрд╕реЗ

DOM-рдЖрдзрд╛рд░рд┐рдд XPath-рдЕрдкрд╡рд╛рдж рд╕рдВрджрд░реНрдн рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ **рд╣рдорд▓рд╛рд╡рд░-рдирд┐рдпрдВрддреНрд░рдг рдпреЛрдЧреНрдп рдбреЗрдЯрд╛ рдХреЛ рдПрдХ XPath рдХреНрд╡реЗрд░реА рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ**ред

#### рд╕реНрд░реЛрдд
```
document.evaluate()
someDOMElement.evaluate()
```
### рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб JSON рдЗрдВрдЬреЗрдХреНрд╢рди

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/client-side-json-injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)

#### рдХреИрд╕реЗ

DOM-рдЖрдзрд╛рд░рд┐рдд JSON-рдЗрдВрдЬреЗрдХреНрд╢рди рд╕рдВрдХрдЯ рдЙрддреНрдкрдиреНрди рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╣рдорд▓рд╛рд╡рд░-рдирд┐рдпрдВрддреНрд░рдгреАрдп рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдХ JSON рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд░реНрд╕ рдХреА рдЬрд╛рддреА рд╣реИ рдФрд░ рдлрд┐рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдкреНрд░реЛрд╕реЗрд╕ рдХреА рдЬрд╛рддреА рд╣реИ**.

#### рд╕рд┐рдВрдХреНрд╕
```
JSON.parse()
jQuery.parseJSON()
$.parseJSON()
```
### рд╡реЗрдм-рд╕рдВрджреЗрд╢ рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/web-message-manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)

#### рдХреИрд╕реЗ

рд╡реЗрдм-рд╕рдВрджреЗрд╢ рд╕рдВрджреЗрд╢ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЕрдкрд░рд╛рдзреА рдирд┐рдпрдВрддреНрд░рдг рд╡рд╛рд▓рд╛ рдбреЗрдЯрд╛ рдХреЛ рджреВрд╕рд░реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рд╡реЗрдм-рд╕рдВрджреЗрд╢ рдХреЗ рд░реВрдк рдореЗрдВ рднреЗрдЬрддрд╛ рд╣реИ рдЬреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рднреАрддрд░ рд╣реЛрддрд╛ рд╣реИред\
[https://portswigger.net/web-security/dom-based/controlling-the-web-message-source](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source) рдореЗрдВ рд╡реЗрдм-рд╕рдВрджреЗрд╢ рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди рдХрд╛ рдЙрджрд╛рд╣рд░рдг

#### рд╕рдВрджреЗрд╢рдХ

рд╡реЗрдм рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП `postMessage()` рд╡рд┐рдзрд┐ рдПрдХ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдШрдЯрдирд╛ рд╕реБрдирдиреЗ рд╡рд╛рд▓реЗ рдЗрд╡реЗрдВрдЯ рд▓рд┐рд╕реНрдЯрдирд░ рдХреЛ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдбреЗрдЯрд╛ рдХрд╛ рд╣реИрдВрдбрд▓ рдХрд░рддрд╛ рд╣реИ рддреЛ рд╕рдВрджреЗрд╢рдХреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрджреЗрд╢ рдЙрддреНрдкрдиреНрди рд╣реЛ рд╕рдХрддреА рд╣реИред

### DOM-рдбреЗрдЯрд╛ рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/dom-data-manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)

#### рдХреИрд╕реЗ

DOM-рдбреЗрдЯрд╛ рдорд╛рдирд┐рдкреБрд▓реЗрд╢рди рд╕рдВрджреЗрд╢ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЕрдкрд░рд╛рдзреА рдирд┐рдпрдВрддреНрд░рдг рд╡рд╛рд▓рд╛ рдбреЗрдЯрд╛ рдбреЙрдо рдХреЗ рднреАрддрд░ рдПрдХ рдлрд╝реАрд▓реНрдб рдореЗрдВ рд▓рд┐рдЦрддрд╛ рд╣реИ рдЬреЛ рджреГрд╢реНрдпрдорд╛рди UI рдпрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рддрд░реНрдХ рдореЗрдВ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИред рдПрдХ рдЕрдкрд░рд╛рдзреА рдЗрд╕ рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ URL рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рджреВрд╕рд░реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдпрджрд┐ рджреЗрдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб UI рдХреА рджрд┐рдЦрд╛рд╡рдЯ рдпрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдЧрд╛ред

#### рд╕рдВрджреЗрд╢рдХ
```
scriptElement.src
scriptElement.text
scriptElement.textContent
scriptElement.innerText
someDOMElement.setAttribute()
someDOMElement.search
someDOMElement.text
someDOMElement.textContent
someDOMElement.innerText
someDOMElement.outerText
someDOMElement.value
someDOMElement.name
someDOMElement.target
someDOMElement.method
someDOMElement.type
someDOMElement.backgroundImage
someDOMElement.cssText
someDOMElement.codebase
document.title
document.implementation.createHTMLDocument()
history.pushState()
history.replaceState()
```
### рдирдХрд╛рд░рд╛рддреНрдордХ рд╕реЗрд╡рд╛

рд╕реНрд░реЛрдд: [https://portswigger.net/web-security/dom-based/denial-of-service](https://portswigger.net/web-security/dom-based/denial-of-service)

#### рдХреИрд╕реЗ

DOM-рдЖрдзрд╛рд░рд┐рдд рдирдХрд╛рд░рд╛рддреНрдордХ рд╕реЗрд╡рд╛ рд╕рдВрдмрдВрдзрд┐рддрддрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╣рдорд▓рд╛рд╡рд░рдг-рдирд┐рдпрдВрддреНрд░рд┐рдд рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдПрдХ рд╕рдорд╕реНрдпрд╛рддреНрдордХ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо API рдореЗрдВ рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИ**, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ API рдЬрд┐рд╕рдХреЗ рдЖрд╣реНрд╡рд╛рди рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ **рдЕрддреНрдпрдзрд┐рдХ рдорд╛рддреНрд░рд╛ рдореЗрдВ CPU рдпрд╛ рдбрд┐рд╕реНрдХ рд╕реНрдерд╛рди рдХрд╛ рдЙрдкрднреЛрдЧ** рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░рдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рджреНрд╡рд╛рд░рд╛ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `localStorage` рдореЗрдВ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣рдг рдХрд░рдиреЗ рдХреЗ рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдХреЗ рдпрд╛ рд╡реНрдпрд╕реНрдд рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЛ рдмрдВрдж рдХрд░рдХреЗред

#### рд╕реНрд░реЛрдд
```
requestFileSystem()
RegExp()
```
## рдбреЙрдо рдХреНрд▓реЙрдмрд░рд┐рдВрдЧ

{% content-ref url="dom-clobbering.md" %}
[dom-clobbering.md](dom-clobbering.md)
{% endcontent-ref %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рдЪрд╛рд╣рд┐рдП? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** **рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдирд╛ рдпреЛрдЧрджрд╛рди рджреЗрдВред**

</details>
