# DOM Invader

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

## DOM Invader

DOM Invader is 'n blaaierhulpmiddel wat in Burp se ingeboude blaaier ge√Ønstalleer is. Dit help om **DOM XSS-gebreklikhede** op te spoor deur gebruik te maak van verskillende bronne en sappe, insluitend webboodskappe en prototipevervuiling. Die hulpmiddel is vooraf ge√Ønstalleer as 'n uitbreiding.

DOM Invader integreer 'n oortjie binne die blaaier se DevTools-paneel wat die volgende moontlik maak:

1. **Identifikasie van beheerbare sappe** op 'n webbladsy vir DOM XSS-toetsing, met konteks- en sanitiseringsbesonderhede.
2. **Log, wysig en herstuur webboodskappe** wat gestuur word via die `postMessage()`-metode vir DOM XSS-toetsing. DOM Invader kan ook outomaties kwesbaarhede opspoor deur spesiaal vervaardigde webboodskappe.
3. Opsoek na **kli√´ntkant prototipevervuiling**-bronne en skandering van beheerbare gadgets wat na risikovolle sappe gestuur word.
4. Identifikasie van **DOM-oorvleuelingsgebreklikhede**.

### Aktiveer dit

Gaan na die **Burp-uitbreiding** in die ingeboude blaaier en aktiveer dit:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Vernuwe die bladsy en in die **Dev Tools** sal jy die **DOM Invader-oortjie vind:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Voeg 'n Canary in

In die vorige prent kan jy 'n **willekeurige groep karakters sien, dit is die Canary**. Jy moet dit nou begin **inspuit** in verskillende dele van die web (parameters, vorms, URL...) en elke keer daarop klik om dit te soek. DOM Invader sal nagaan of die **canary in enige interessante sap ge√´indig het** wat uitgebuit kan word.

Verder sal die opsies **Inject URL parameters** en **Inject forms** outomaties 'n **nuwe oortjie** oopmaak deur die **canary** in elke **URL-parameter** en **vorm** wat dit vind, in te spuit.

### Voeg 'n le√´ Canary in

As jy net potensi√´le sappe wil vind wat die bladsy mag h√™, selfs al is hulle nie uitbuitbaar nie, kan jy soek na 'n le√´ canary.

### Stuur boodskappe

DOM Invader maak dit moontlik om DOM XSS te toets deur gebruik te maak van webboodskappe met funksies soos:

1. **Log webboodskappe** wat gestuur word via `postMessage()`, soortgelyk aan Burp Proxy se HTTP-versoek-/reaksiegeskiedenislogboek.
2. **Wysiging** en **heruitreiking** van webboodskappe om handmatig te toets vir DOM XSS, soortgelyk aan Burp Repeater se funksie.
3. **Outomatiese verandering** en stuur van webboodskappe vir die sondering van DOM XSS.

#### Boodskapbesonderhede

Gedetailleerde inligting oor elke boodskap kan besigtig word deur daarop te klik, wat insluit of die kli√´ntkant JavaScript die `origin`, `data` of `source` eienskappe van die boodskap benader.

* **`origin`**: As die **oorsprongsinligting van die boodskap nie nagegaan word nie**, kan jy dalk kruisoorsprong-boodskappe na die gebeurtenishanterer stuur **vanaf 'n willekeurige eksterne domein**. Maar as dit nagegaan word, kan dit steeds onveilig wees.
* **`data`**: Hierdie is waar die payload gestuur word. As hierdie data nie gebruik word nie, is die sap nutteloos.
* **`source`**: Evalueer of die bron-eienskap, wat gewoonlik na 'n iframe verwys, geverifieer word in plaas van die oorsprong. Selfs as dit nagegaan word, verseker dit nie dat die verifikasie omseil kan word nie.

#### Antwoord op 'n boodskap

1. Klik op enige boodskap in die **Boodskappe**-sig om die besonderhededialoog van die boodskap oop te maak.
2. Wysig die **Data**-veld soos vereis.
3. Klik op **Stuur**.

### Prototipevervuiling

DOM Invader kan ook soek na **Prototipevervuiling-gebreklikhede**. Eerstens moet jy dit aktiveer:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Dan sal dit **soek na bronne** wat jou in staat stel om arbitr√™re eienskappe by die **`Object.prototype`** te voeg.

As iets gevind word, sal 'n **Toets**-knoppie verskyn om die gevonde bron te **toets**. Klik daarop, 'n nuwe oortjie sal verskyn, skep 'n voorwerp in die konsole en kyk of die `testproperty` bestaan:
```javascript
let b = {}
b.testproperty
```
Sodra jy 'n bron gevind het, kan jy **soek vir 'n gadget**:

1. 'n Nuwe oortjie word deur DOM Invader geopen wanneer die **Soek vir gadgets**-knoppie, wat langs enige ge√Ødentifiseerde prototipevervuilingsbron in die **DOM**-sigbaarheid gevind kan word, gekliek word. Die soektog na geskikte gadgets begin dan.
2. Intussen, in dieselfde oortjie, moet die **DOM Invader**-oortjie in die DevTools-paneel geopen word. Nadat die soektog voltooi is, word enige lekke wat toeganklik is via die ge√Ødentifiseerde gadgets in die **DOM**-sigbaarheid vertoon. Byvoorbeeld, 'n gadget-eienskap genaamd `html` wat aan die `innerHTML`-lek oorgedra word, word in die voorbeeld hieronder getoon.

## DOM-vervuiling

In die vorige prentjie is dit moontlik om te sien dat die soektog na DOM-vervuilings aangeskakel kan word. Sodra dit gedoen is, sal **DOM Invader begin soek na DOM-vervuilbaarhede**.

## Verwysings

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks-uitrusting**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
