# Najeźdźca DOM

<details>

<summary><strong>Dowiedz się, jak hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>

## Najeźdźca DOM

Najeźdźca DOM to narzędzie przeglądarki zainstalowane w wbudowanej przeglądarce Burp. Pomaga w **wykrywaniu podatności na XSS DOM** za pomocą różnych źródeł i ujść, w tym wiadomości internetowych i zanieczyszczenia prototypu. Narzędzie jest zainstalowane domyślnie jako rozszerzenie.

Najeźdźca DOM integruje zakładkę w panelu Narzędzi Deweloperskich przeglądarki, umożliwiając:

1. **Identyfikację kontrolowalnych ujść** na stronie internetowej do testowania XSS DOM, dostarczając kontekstu i szczegółów dotyczących sanitacji.
2. **Rejestrowanie, edytowanie i ponowne wysyłanie wiadomości internetowych** wysłanych za pomocą metody `postMessage()` do testowania XSS DOM. Najeźdźca DOM może również automatycznie wykrywać podatności za pomocą specjalnie przygotowanych wiadomości internetowych.
3. Wykrywanie źródeł **zanieczyszczenia prototypu po stronie klienta** i skanowanie kontrolowalnych gadżetów wysyłanych do ryzykownych ujść.
4. Identyfikację **podatności na zastępowanie DOM**.

### Włącz to

W wbudowanej przeglądarce Burp przejdź do **rozszerzenia Burp** i włącz je:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Teraz odśwież stronę i w **Narzędziach Deweloperskich** znajdziesz zakładkę **Najeźdźca DOM:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Wstrzyknij kanarka

Na poprzednim obrazie możesz zobaczyć **losową grupę znaków, która jest kanarkiem**. Teraz powinieneś zacząć **wstrzykiwać** go w różne części strony internetowej (parametry, formularze, adres URL...) i za każdym razem kliknąć szukaj. Najeźdźca DOM sprawdzi, czy **kanarek trafił do jakiegokolwiek interesującego ujścia**, które można by wykorzystać.

Co więcej, opcje **Wstrzyknij parametry URL** i Wstrzyknij formularze automatycznie otworzą **nową kartę** **wstrzykując** **kanarka** w każdym parametrze **URL** i **formularzu**, które znajdzie.

### Wstrzyknij pusty kanarek

Jeśli chcesz tylko znaleźć potencjalne ujścia, jakie strona może mieć, nawet jeśli nie są one wykorzystywalne, możesz **szukać pustego kanarka**.

### Wiadomości internetowe

Najeźdźca DOM umożliwia testowanie XSS DOM za pomocą wiadomości internetowych z funkcjami takimi jak:

1. **Rejestrowanie wiadomości internetowych** wysłanych za pomocą `postMessage()`, podobnie jak rejestrowanie historii żądań/odpowiedzi HTTP w Burp Proxy.
2. **Modyfikacja** i **ponowne wysyłanie** wiadomości internetowych w celu ręcznego testowania XSS DOM, podobnie jak funkcja Burp Repeater.
3. **Automatyczna zmiana** i wysyłanie wiadomości internetowych do sondowania XSS DOM.

#### Szczegóły wiadomości

Szczegółowe informacje o każdej wiadomości można zobaczyć, klikając na nią, co obejmuje dostęp do właściwości `origin`, `data` lub `source` wiadomości przez JavaScript po stronie klienta.

* **`origin`** : Jeśli **informacje o pochodzeniu wiadomości nie są sprawdzane**, możesz wysłać wiadomości międzydomenowe do obsługi zdarzeń **z dowolnej zewnętrznej domeny**. Ale jeśli jest sprawdzane, nadal może to być niebezpieczne.
* **`data`**: Tutaj jest wysyłana ładunek. Jeśli te dane nie są używane, ujście jest bezużyteczne.
* **`source`**: Ocenia, czy właściwość źródłowa, zazwyczaj odnosząca się do ramki, jest walidowana zamiast pochodzenia. Nawet jeśli to jest sprawdzane, nie zapewnia to, że walidacja nie może zostać obejścia.

#### Odpowiedz na wiadomość

1. Z widoku **Wiadomości**, kliknij dowolną wiadomość, aby otworzyć okno szczegółów wiadomości.
2. Edytuj pole **Dane** według potrzeb.
3. Kliknij **Wyślij**.

### Zanieczyszczenie prototypu

Najeźdźca DOM może również szukać **podatności na zanieczyszczenie prototypu**. Najpierw musisz to włączyć:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Następnie będzie **szukać źródeł**, które umożliwiają dodanie dowolnych właściwości do **`Object.prototype`**.

Jeśli coś zostanie znalezione, pojawi się przycisk **Test**, aby **przetestować znalezione źródło**. Kliknij na niego, pojawi się nowa karta, utwórz obiekt w konsoli i sprawdź, czy `testproperty` istnieje:
```javascript
let b = {}
b.testproperty
```
Gdy już znajdziesz źródło, możesz **przeskanować urządzenie**:

1. Nowa karta zostanie otwarta przez DOM Invader, gdy przycisk **Skanuj urządzenie** znajdujący się obok zidentyfikowanego źródła zanieczyszczenia prototypu w widoku **DOM** zostanie kliknięty. Następnie rozpocznie się skanowanie odpowiednich urządzeń.
2. W międzyczasie, w tej samej karcie, karta **DOM Invader** powinna być otwarta w panelu Narzędzi deweloperskich. Po zakończeniu skanowania, wszystkie ujścia dostępne za pomocą zidentyfikowanych urządzeń są wyświetlane w widoku **DOM**. Na przykład, właściwość urządzenia o nazwie `html` przekazywana do ujścia `innerHTML` jest pokazana na poniższym przykładzie.

## Nadpisywanie DOM

Na poprzednim obrazie można zobaczyć, że skanowanie nadpisywania DOM można włączyć. Gdy to zrobisz, **DOM Invader zacznie szukać podatności na nadpisywanie DOM**.

## Odnośniki

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
