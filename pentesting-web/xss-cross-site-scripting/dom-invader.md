# DOM Invader

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>

## DOM Invader

DOM Invader ist ein Browser-Tool, das im integrierten Browser von Burp installiert ist. Es hilft bei der **Erkennung von DOM XSS-Schwachstellen** unter Verwendung verschiedener Quellen und Senken, einschlie√ülich Webnachrichten und Prototypenverunreinigung. Das Tool ist als Erweiterung vorinstalliert.

DOM Invader integriert eine Registerkarte im DevTools-Panel des Browsers und erm√∂glicht Folgendes:

1. **Identifizierung von steuerbaren Senken** auf einer Webseite f√ºr DOM XSS-Tests und Bereitstellung von Kontext- und S√§uberungsdetails.
2. **Protokollierung, Bearbeitung und erneutes Senden von Webnachrichten**, die √ºber die Methode `postMessage()` gesendet werden, f√ºr DOM XSS-Tests. DOM Invader kann auch Schwachstellen automatisch erkennen, indem speziell erstellte Webnachrichten verwendet werden.
3. Erkennung von **Quellen f√ºr clientseitige Prototypenverunreinigung** und Scannen von steuerbaren Gadgets, die an gef√§hrliche Senken gesendet werden.
4. Identifizierung von **DOM-√úberschreibungsschwachstellen**.

### Aktivieren

Gehen Sie im integrierten Browser von Burp zu **Burp Extension** und aktivieren Sie es:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Aktualisieren Sie nun die Seite und im **Dev Tools** finden Sie die **DOM Invader-Registerkarte:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Einen Canary injizieren

In dem vorherigen Bild k√∂nnen Sie eine **zuf√§llige Gruppe von Zeichen sehen, das ist der Canary**. Sie sollten jetzt anfangen, es in verschiedenen Teilen des Webs (Parameter, Formulare, URL usw.) einzuf√ºgen und jedes Mal auf "Search" zu klicken. DOM Invader √ºberpr√ºft, ob der **Canary in einer interessanten Senke gelandet ist**, die ausgenutzt werden k√∂nnte.

Dar√ºber hinaus √∂ffnen die Optionen **Inject URL params** und **Inject forms** automatisch einen **neuen Tab**, in dem der **Canary** in jedem **URL-Parameter** und **Formular** eingef√ºgt wird, den er findet.

### Einen leeren Canary injizieren

Wenn Sie nur potenzielle Senken finden m√∂chten, die die Seite haben k√∂nnte, auch wenn sie nicht ausnutzbar sind, k√∂nnen Sie nach einem leeren Canary suchen.

### Webnachrichten senden

DOM Invader erm√∂glicht das Testen von DOM XSS mit Webnachrichten und bietet Funktionen wie:

1. **Protokollierung von Webnachrichten**, die √ºber `postMessage()` gesendet werden, √§hnlich wie die Protokollierung des HTTP-Anforderungs-/Antwortverlaufs von Burp Proxy.
2. **√Ñnderung** und **Erneutes Senden** von Webnachrichten zur manuellen √úberpr√ºfung auf DOM XSS, √§hnlich wie die Funktion von Burp Repeater.
3. **Automatische √Ñnderung** und Senden von Webnachrichten zum Sondieren von DOM XSS.

#### Nachrichtendetails

Detaillierte Informationen zu jeder Nachricht k√∂nnen durch Anklicken angezeigt werden, einschlie√ülich der Frage, ob der clientseitige JavaScript auf die Eigenschaften `origin`, `data` oder `source` der Nachricht zugreift.

* **`origin`**: Wenn die **Herkunftsinformationen der Nachricht nicht √ºberpr√ºft werden**, k√∂nnen Sie m√∂glicherweise Cross-Origin-Nachrichten an den Ereignishandler **von einer beliebigen externen Dom√§ne** senden. Aber selbst wenn dies √ºberpr√ºft wird, k√∂nnte es unsicher sein.
* **`data`**: Hier wird die Nutzlast gesendet. Wenn diese Daten nicht verwendet werden, ist die Senke nutzlos.
* **`source`**: √úberpr√ºft, ob die Quelleigenschaft, die normalerweise auf ein iFrame verweist, anstelle der Herkunft validiert wird. Selbst wenn dies √ºberpr√ºft wird, garantiert es nicht, dass die Validierung umgangen werden kann.

#### Eine Nachricht beantworten

1. Klicken Sie in der Ansicht **Messages** auf eine beliebige Nachricht, um den Dialog mit den Nachrichtendetails zu √∂ffnen.
2. Bearbeiten Sie das Feld **Data** wie erforderlich.
3. Klicken Sie auf **Send**.

### Prototypenverunreinigung

DOM Invader kann auch nach **Prototypenverunreinigungsschwachstellen** suchen. Zuerst m√ºssen Sie es aktivieren:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Dann wird es nach Quellen suchen, mit denen Sie beliebige Eigenschaften zum **`Object.prototype`** hinzuf√ºgen k√∂nnen.

Wenn etwas gefunden wird, wird eine Schaltfl√§che **Test** angezeigt, um die gefundene Quelle zu **testen**. Klicken Sie darauf, ein neuer Tab wird ge√∂ffnet, erstellen Sie ein Objekt in der Konsole und √ºberpr√ºfen Sie, ob die `testproperty` existiert:
```javascript
let b = {}
b.testproperty
```
Sobald Sie eine Quelle gefunden haben, k√∂nnen Sie nach einem Gadget suchen:

1. DOM Invader √∂ffnet einen neuen Tab, wenn auf die Schaltfl√§che "Scan nach Gadgets" geklickt wird, die sich neben jeder identifizierten Quelle f√ºr Prototypenverschmutzung in der DOM-Ansicht befindet. Die Suche nach geeigneten Gadgets beginnt dann.
2. Gleichzeitig sollte im selben Tab der DOM Invader-Tab im DevTools-Panel ge√∂ffnet werden. Nach Abschluss des Scans werden alle √ºber die identifizierten Gadgets zug√§nglichen Sinks in der DOM-Ansicht angezeigt. Zum Beispiel wird im folgenden Beispiel eine Gadget-Eigenschaft mit dem Namen `html`, die an den Sink `innerHTML` √ºbergeben wird, angezeigt.

## DOM-√úberschreibung

Im vorherigen Bild ist zu sehen, dass der Scan f√ºr DOM-√úberschreibungen aktiviert werden kann. Sobald dies geschehen ist, beginnt DOM Invader nach DOM-√úberschreibungs-Schwachstellen zu suchen.

## Referenzen

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie Pull Requests an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
