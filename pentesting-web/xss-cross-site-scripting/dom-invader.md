# DOM Invader

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι υποστήριξης του HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

## DOM Invader

Το DOM Invader είναι ένα εργαλείο περιήγησης που είναι εγκατεστημένο στον ενσωματωμένο περιηγητή του Burp. Βοηθά στον εντοπισμό ευπάθειας DOM XSS χρησιμοποιώντας διάφορες πηγές και απορροές, συμπεριλαμβανομένων των μηνυμάτων ιστού και της προσβολής του πρωτοτύπου. Το εργαλείο είναι προεγκατεστημένο ως πρόσθετο.

Το DOM Invader ενσωματώνει έναν καρτέλα στο πλαίσιο των εργαλείων του περιηγητή που επιτρέπει τα εξής:

1. **Αναγνώριση ελεγχόμενων απορροών** σε μια ιστοσελίδα για τον έλεγχο του DOM XSS, παρέχοντας πληροφορίες περιβάλλοντος και λεπτομέρειες απολύμανσης.
2. **Καταγραφή, επεξεργασία και επανάληψη μηνυμάτων ιστού** που αποστέλλονται μέσω της μεθόδου `postMessage()` για τον έλεγχο του DOM XSS. Το DOM Invader μπορεί επίσης να ανιχνεύσει αυτόματα ευπάθειες χρησιμοποιώντας ειδικά δημιουργημένα μηνύματα ιστού.
3. Εντοπισμός πηγών **προσβολής του πρωτοτύπου πλευράς πελάτη** και σάρωση ελεγχόμενων συσκευών που αποστέλλονται σε επικίνδυνες απορροές.
4. Αναγνώριση ευπάθειας **κατακλυσμού DOM**.

### Ενεργοποίηση

Στον ενσωματωμένο περιηγητή του Burp, μεταβείτε στην **επέκταση Burp** και ενεργοποιήστε το:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Τώρα ανανεώστε τη σελίδα και στα **Dev Tools** θα βρείτε την καρτέλα **DOM Invader:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Εισαγωγή ενός Canary

Στην προηγούμενη εικόνα μπορείτε να δείτε μια **τυχαία ομάδα χαρακτήρων, που είναι το Canary**. Τώρα πρέπει να **εισάγετε** το Canary σε διάφορα μέρη του ιστού (παραμέτρους, φόρμες, url...) και κάθε φορά κάντε κλικ στην αναζήτηση. Το DOM Invader θα ελέγξει αν το **canary κατέληξε σε κάποια ενδιαφέρουσα απορροή** που θα μπορούσε να εκμεταλλευτείτε.

Επιπλέον, οι επιλογές **Εισαγωγή παραμέτρων URL** και Εισαγωγή φορμών θα ανοίξουν αυτόματα μια **νέα καρτέλα** **εισάγοντας** το **canary** σε κάθε **παράμετρο URL** και **φόρμα** που βρίσκει.

### Εισαγωγή ενός κενού Canary

Εάν θέλετε απλά να βρείτε πιθανές απορροές που μπορεί να έχει η σελίδα, ακόμα κι αν δεν είναι εκμεταλλεύσιμες, μπορείτε να **αναζητήσετε ένα κενό canary**.

### Μηνύματα ιστού

Το DOM Invader επιτρέπει τον έλεγχο του DOM XSS χρησιμοποιώντας μηνύματα ιστού με δυνατότητες όπως:

1. **Καταγραφή μηνυμάτων ιστού** που αποστέλλονται μέσω `postMessage()`, παρόμοια με την καταγραφή ιστορικού αιτημάτων/απαντήσεων HTTP του Burp Proxy.
2. **Τροποποίηση** και **επανάληψη** μηνυμάτων ιστού για τον χειροκίνητο έλεγχο του DOM XSS, παρόμοια με τη λειτουργία του Burp Repeater.
3. **Αυτόματη τροποποίηση** και αποστολή μηνυμάτων ιστού για τον έλεγχο του DOM XSS.

#### Λεπτομέρειες μηνύματος

Μπορείτε να δείτε λεπ
```javascript
let b = {}
b.testproperty
```
Αφού βρείτε μια πηγή, μπορείτε να **σαρώσετε για ένα gadget**:

1. Όταν κάνετε κλικ στο κουμπί **Σάρωση για gadgets**, το οποίο μπορεί να βρεθεί δίπλα σε οποιαδήποτε εντοπισμένη πηγή μόλυνσης πρωτοτύπου στην προβολή **DOM**, ανοίγει ένα νέο παράθυρο από το DOM Invader. Στη συνέχεια, ξεκινά η σάρωση για κατάλληλα gadgets.
2. Παράλληλα, στο ίδιο παράθυρο, πρέπει να ανοίξει η καρτέλα **DOM Invader** στο πάνελ DevTools. Αφού ολοκληρωθεί η σάρωση, εμφανίζονται στην προβολή **DOM** οποιεσδήποτε απορροές προσβάσιμες μέσω των εντοπισμένων gadgets. Για παράδειγμα, στο παρακάτω παράδειγμα εμφανίζεται μια ιδιότητα gadget με το όνομα `html` που περνιέται στην απόρροια `innerHTML`.

## Κατακλυσμός DOM

Στην προηγούμενη εικόνα είναι δυνατόν να δείτε ότι η σάρωση για κατακλυσμό DOM μπορεί να ενεργοποιηθεί. Αφού γίνει αυτό, το **DOM Invader θα αρχίσει να αναζητά ευπάθειες κατακλυσμού DOM**.

## Αναφορές

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>Μάθετε το hacking του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF**, ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα κόλπα σας για το hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
