# DOM Invader

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## DOM Invader

DOM Invader √® uno strumento del browser installato nel browser integrato di Burp. Aiuta a **individuare vulnerabilit√† DOM XSS** utilizzando varie fonti e sink, inclusi i messaggi web e la pollution del prototype. Lo strumento √® preinstallato come estensione.

DOM Invader integra una scheda all'interno del pannello DevTools del browser che consente quanto segue:

1. **Identificazione dei sink controllabili** su una pagina web per il testing di DOM XSS, fornendo contesto e dettagli di sanitizzazione.
2. **Registrazione, modifica e reinvio di messaggi web** inviati tramite il metodo `postMessage()` per il testing di DOM XSS. DOM Invader pu√≤ anche rilevare automaticamente vulnerabilit√† utilizzando messaggi web appositamente creati.
3. Rilevamento delle **fonti di pollution del prototype lato client** e scansione dei gadget controllabili inviati a sink rischiosi.
4. Identificazione di **vulnerabilit√† di clobbering del DOM**.

### Abilita

Nel browser integrato di Burp, vai all'estensione di Burp e abilitala:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Ora aggiorna la pagina e nella **Dev Tools** troverai la scheda **DOM Invader:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Inietta un Canary

Nell'immagine precedente puoi vedere un **gruppo casuale di caratteri, che √® il Canary**. Ora dovresti iniziare a **iniettarlo** in diverse parti del web (parametri, form, URL...) e ogni volta fare clic su cerca. DOM Invader verificher√† se il **canary √® finito in qualche sink interessante** che potrebbe essere sfruttato.

Inoltre, le opzioni **Inietta parametri URL** e Inietta form apriranno automaticamente una **nuova scheda** **iniettando** il **canary** in ogni **parametro URL** e **form** trovato.

### Inietta un Canary vuoto

Se vuoi solo trovare i possibili sink che la pagina potrebbe avere, anche se non sono sfruttabili, puoi **cercare un canary vuoto**.

### Messaggi Post

DOM Invader consente di testare DOM XSS utilizzando messaggi web con funzionalit√† come:

1. **Registrazione dei messaggi web** inviati tramite `postMessage()`, simile alla registrazione della cronologia delle richieste/risposte HTTP di Burp Proxy.
2. **Modifica** e **riemissione** dei messaggi web per testare manualmente DOM XSS, simile alla funzione di Burp Repeater.
3. **Modifica automatica** e invio di messaggi web per sondare DOM XSS.

#### Dettagli del messaggio

√à possibile visualizzare informazioni dettagliate su ciascun messaggio facendo clic su di esso, che include se il JavaScript lato client accede alle propriet√† `origin`, `data` o `source` del messaggio.

* **`origin`**: Se le **informazioni sull'origine del messaggio non sono controllate**, potresti essere in grado di inviare messaggi cross-origin all'event handler **da un dominio esterno arbitrario**. Ma se viene controllato, potrebbe comunque essere insicuro.
* **`data`**: Qui viene inviato il payload. Se questi dati non vengono utilizzati, il sink √® inutile.
* **`source`**: Valuta se la propriet√† source, di solito facendo riferimento a un iframe, viene convalidata anzich√© l'origine. Anche se questo viene controllato, non garantisce che la convalida non possa essere elusa.

#### Rispondi a un messaggio

1. Dalla vista **Messaggi**, fai clic su qualsiasi messaggio per aprire il dialogo dei dettagli del messaggio.
2. Modifica il campo **Data** come richiesto.
3. Fai clic su **Invia**.

### Pollution del Prototype

DOM Invader pu√≤ anche cercare **vulnerabilit√† di Pollution del Prototype**. Prima, √® necessario abilitarlo:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Quindi, verr√† **ricercato le fonti** che consentono di aggiungere propriet√† arbitrarie all'**`Object.prototype`**.

Se viene trovato qualcosa, apparir√† un pulsante **Test** per **testare la fonte trovata**. Fare clic su di esso, verr√† visualizzata una nuova scheda, creare un oggetto nella console e verificare se la `testproperty` esiste:
```javascript
let b = {}
b.testproperty
```
Una volta trovata una sorgente, puoi **scansionare per un gadget**:

1. Viene aperta una nuova scheda da DOM Invader quando viene cliccato il pulsante **Scansiona per gadget**, che si trova accanto a qualsiasi sorgente di inquinamento del prototipo identificata nella vista **DOM**. Inizia quindi la scansione per trovare gadget adatti.
2. Nel frattempo, nella stessa scheda, la scheda **DOM Invader** dovrebbe essere aperta nel pannello DevTools. Dopo il completamento della scansione, tutti i sink accessibili tramite i gadget identificati vengono visualizzati nella vista **DOM**. Ad esempio, una propriet√† del gadget chiamata `html` passata al sink `innerHTML` viene mostrata nell'esempio seguente.

## Sovrascrittura del DOM

Nell'immagine precedente √® possibile vedere che la scansione della sovrascrittura del DOM pu√≤ essere attivata. Una volta fatto ci√≤, **DOM Invader inizier√† a cercare vulnerabilit√† di sovrascrittura del DOM**.

## Riferimenti

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>Impara l'hacking di AWS da zero a esperto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF**, controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository github di** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
