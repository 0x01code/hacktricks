# DOM Invader

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## DOM Invader

DOM Invader est un outil de navigateur install√© dans le navigateur int√©gr√© de Burp. Il aide √† **d√©tecter les vuln√©rabilit√©s DOM XSS** en utilisant diverses sources et cibles, y compris les messages web et la pollution de prototype. L'outil est pr√©install√© en tant qu'extension.

DOM Invader int√®gre un onglet dans le panneau DevTools du navigateur, ce qui permet de :

1. **Identifier les cibles contr√¥lables** sur une page web pour les tests DOM XSS, en fournissant des informations de contexte et de d√©sinfection.
2. **Enregistrer, modifier et renvoyer les messages web** envoy√©s via la m√©thode `postMessage()` pour les tests DOM XSS. DOM Invader peut √©galement d√©tecter automatiquement les vuln√©rabilit√©s √† l'aide de messages web sp√©cialement con√ßus.
3. D√©tecter les **sources de pollution de prototype c√¥t√© client** et analyser les gadgets contr√¥lables envoy√©s vers des cibles risqu√©es.
4. Identifier les **vuln√©rabilit√©s de clobbering DOM**.

### L'activer

Dans le navigateur int√©gr√© de Burp, acc√©dez √† l'**extension Burp** et activez-la :

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Actualisez ensuite la page et dans les **Dev Tools**, vous trouverez l'onglet **DOM Invader** :

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Injecter un canari

Sur l'image pr√©c√©dente, vous pouvez voir un **groupe al√©atoire de caract√®res, qui est le canari**. Vous devez maintenant commencer √† **l'injecter** dans diff√©rentes parties du web (param√®tres, formulaires, URL...) et √† chaque fois cliquer sur Rechercher. DOM Invader v√©rifiera si le **canari se retrouve dans une cible int√©ressante** qui pourrait √™tre exploit√©e.

De plus, les options **Injecter les param√®tres d'URL** et **Injecter les formulaires** ouvriront automatiquement un **nouvel onglet** en injectant le **canari** dans chaque **param√®tre d'URL** et **formulaire** trouv√©.

### Injecter un canari vide

Si vous voulez simplement trouver les cibles potentielles que la page pourrait avoir, m√™me si elles ne sont pas exploitables, vous pouvez **rechercher un canari vide**.

### Messages web

DOM Invader permet de tester les DOM XSS √† l'aide de messages web avec des fonctionnalit√©s telles que :

1. **Enregistrement des messages web** envoy√©s via `postMessage()`, similaire √† l'enregistrement de l'historique des requ√™tes/r√©ponses HTTP de Burp Proxy.
2. **Modification** et **renvoi** des messages web pour tester manuellement les DOM XSS, similaire √† la fonction de Burp Repeater.
3. **Modification automatique** et envoi de messages web pour sonder les DOM XSS.

#### D√©tails du message

Vous pouvez cliquer sur chaque message pour afficher des informations plus d√©taill√©es √† son sujet, notamment si les propri√©t√©s `origin`, `data` ou `source` du message sont accessibles par le JavaScript c√¥t√© client.

* **`origin`** : Si les **informations d'origine du message ne sont pas v√©rifi√©es**, vous pouvez √™tre en mesure d'envoyer des messages inter-domaines √† l'**event handler depuis un domaine externe arbitraire**. Mais si c'est v√©rifi√©, cela pourrait toujours √™tre insecure.
* **`data`** : C'est l√† que la charge utile est envoy√©e. Si ces donn√©es ne sont pas utilis√©es, la cible est inutile.
* **`source`** : √âvalue si la propri√©t√© source, faisant g√©n√©ralement r√©f√©rence √† un iframe, est valid√©e au lieu de l'origine. M√™me si cela est v√©rifi√©, cela ne garantit pas que la validation ne peut pas √™tre contourn√©e.

#### R√©pondre √† un message

1. Depuis la vue **Messages**, cliquez sur n'importe quel message pour ouvrir la bo√Æte de dialogue des d√©tails du message.
2. Modifiez le champ **Data** selon vos besoins.
3. Cliquez sur **Envoyer**.

### Pollution de prototype

DOM Invader peut √©galement rechercher des **vuln√©rabilit√©s de pollution de prototype**. Tout d'abord, vous devez l'activer :

<figure><img src="../../.gitbook/assets/image (5) (1) (1).png" alt=""><figcaption></figcaption></figure>

Ensuite, il **recherchera les sources** qui vous permettent d'ajouter des propri√©t√©s arbitraires √† **`Object.prototype`**.

Si quelque chose est trouv√©, un bouton **Test** appara√Ætra pour **tester la source trouv√©e**. Cliquez dessus, un nouvel onglet appara√Ætra, cr√©ez un objet dans la console et v√©rifiez si la propri√©t√© `testproperty` existe :
```javascript
let b = {}
b.testproperty
```
Une fois que vous avez trouv√© une source, vous pouvez **analyser les gadgets** :

1. Dans la vue **DOM**, cliquez sur le bouton **Analyser les gadgets** √† c√¥t√© de toute source de pollution de prototype que DOM Invader a trouv√©e. DOM Invader ouvre un nouvel onglet et commence √† analyser les gadgets appropri√©s.
2. Dans le m√™me onglet, ouvrez l'onglet **DOM Invader** dans le panneau DevTools. Une fois l'analyse termin√©e, la vue **DOM** affiche les √©ventuelles failles que DOM Invader a pu acc√©der via les gadgets identifi√©s. Dans l'exemple ci-dessous, une propri√©t√© de gadget appel√©e `html` a √©t√© transmise √† la faille `innerHTML`.

## Substitution de DOM

Sur l'image pr√©c√©dente, il est possible de voir que l'analyse de la substitution de DOM peut √™tre activ√©e. Une fois activ√©e, **DOM Invader commencera √† rechercher des vuln√©rabilit√©s de substitution de DOM**.

## R√©f√©rences

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Vous travaillez dans une **entreprise de cybers√©curit√©** ? Vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ? ou souhaitez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
