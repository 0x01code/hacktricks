# DOM Eindringling

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

## DOM Eindringling

DOM Eindringling ist ein Browser-Tool, das im integrierten Browser von Burp installiert ist. Es hilft bei der **Erkennung von DOM-XSS-Schwachstellen** unter Verwendung verschiedener Quellen und Senken, einschlie√ülich Webnachrichten und Prototypenverunreinigungen. Das Tool ist als Erweiterung vorinstalliert.

DOM Eindringling integriert einen Tab im DevTools-Panel des Browsers, der Folgendes erm√∂glicht:

1. **Identifizierung von steuerbaren Senken** auf einer Webseite f√ºr DOM-XSS-Tests, Bereitstellung von Kontext- und S√§uberungsdetails.
2. **Protokollierung, Bearbeitung und erneutes Senden von Webnachrichten**, die √ºber die Methode `postMessage()` gesendet wurden, f√ºr DOM-XSS-Tests. DOM Eindringling kann auch Schwachstellen automatisch erkennen, die mithilfe speziell erstellter Webnachrichten erstellt wurden.
3. Erkennung von **Client-seitigen Prototypenverunreinigungsquellen** und Scannen von steuerbaren Ger√§ten, die an gef√§hrliche Senken gesendet wurden.
4. Identifizierung von **DOM-√úberschreibungs-Schwachstellen**.

### Aktivieren

Gehen Sie im integrierten Browser von Burp zu der **Burp-Erweiterung** und aktivieren Sie sie:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Aktualisieren Sie nun die Seite und im **DevTools** finden Sie den **DOM Eindringling-Tab:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Einf√ºgen eines Kanarienvogels

Im vorherigen Bild k√∂nnen Sie eine **zuf√§llige Gruppe von Zeichen sehen, das ist der Kanarienvogel**. Sie sollten ihn jetzt in verschiedenen Teilen des Webs einf√ºgen (Parameter, Formulare, URL...) und jedes Mal auf Suche klicken. DOM Eindringling √ºberpr√ºft, ob der **Kanarienvogel in einer interessanten Senke gelandet ist**, die ausgenutzt werden k√∂nnte.

Dar√ºber hinaus werden die Optionen **URL-Parameter einf√ºgen** und Formulare einf√ºgen automatisch einen **neuen Tab √∂ffnen**, in dem der **Kanarienvogel** in jedem **URL-Parameter** und **Formular** eingef√ºgt wird, den er findet.

### Einf√ºgen eines leeren Kanarienvogels

Wenn Sie nur potenzielle Senken finden m√∂chten, die die Seite haben k√∂nnte, auch wenn sie nicht ausnutzbar sind, k√∂nnen Sie nach einem leeren Kanarienvogel suchen.

### Webnachrichten

DOM Eindringling erm√∂glicht das Testen von DOM-XSS mithilfe von Webnachrichten mit Funktionen wie:

1. **Protokollierung von Webnachrichten**, die √ºber `postMessage()` gesendet wurden, √§hnlich der Protokollierung des HTTP-Anforderungs-/Antwortverlaufs von Burp Proxy.
2. **√Ñnderung** und **Neuausstellung** von Webnachrichten, um manuell auf DOM-XSS zu testen, √§hnlich der Funktion von Burp Repeater.
3. **Automatische √Ñnderung** und Senden von Webnachrichten zum Sondieren von DOM-XSS.

#### Nachrichtendetails

Detaillierte Informationen zu jeder Nachricht k√∂nnen durch Klicken darauf angezeigt werden, einschlie√ülich ob das clientseitige JavaScript auf die Eigenschaften `origin`, `data` oder `source` der Nachricht zugreift.

* **`origin`** : Wenn die **Herkunftsinformation der Nachricht nicht √ºberpr√ºft wird**, k√∂nnen Sie m√∂glicherweise Cross-Origin-Nachrichten an den Ereignishandler **von einer beliebigen externen Domain** senden. Aber selbst wenn dies √ºberpr√ºft wird, k√∂nnte es unsicher sein.
* **`data`**: Hier wird die Nutzlast gesendet. Wenn diese Daten nicht verwendet werden, ist die Senke nutzlos.
* **`source`**: √úberpr√ºft, ob die Quelleigenschaft, die normalerweise auf ein iFrame verweist, anstelle der Herkunft validiert wird. Selbst wenn dies √ºberpr√ºft wird, garantiert dies nicht, dass die Validierung umgangen werden kann.

#### Nachricht beantworten

1. Klicken Sie in der **Nachrichten**-Ansicht auf eine Nachricht, um den Dialog mit den Nachrichtendetails zu √∂ffnen.
2. Bearbeiten Sie das Feld **Daten** wie erforderlich.
3. Klicken Sie auf **Senden**.

### Prototypenverunreinigung

DOM Eindringling kann auch nach **Prototypenverunreinigungs-Schwachstellen** suchen. Zuerst m√ºssen Sie es aktivieren:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Dann wird es nach **Quellen suchen**, die es Ihnen erm√∂glichen, beliebige Eigenschaften zum **`Object.prototype`** hinzuzuf√ºgen.

Wenn etwas gefunden wird, wird eine **Test**-Schaltfl√§che angezeigt, um die gefundene Quelle zu **testen**. Klicken Sie darauf, es wird ein neuer Tab ge√∂ffnet, erstellen Sie ein Objekt in der Konsole und √ºberpr√ºfen Sie, ob die `testproperty` existiert:
```javascript
let b = {}
b.testproperty
```
Sobald Sie eine Quelle gefunden haben, k√∂nnen Sie nach einem Gadget scannen:

1. Ein neuer Tab wird von DOM Invader ge√∂ffnet, wenn die Schaltfl√§che **Nach Gadgets scannen**, die neben jeder identifizierten Quelle f√ºr Prototypenverschmutzung in der **DOM**-Ansicht gefunden werden kann, angeklickt wird. Die Suche nach geeigneten Gadgets beginnt dann.
2. In der Zwischenzeit sollte im selben Tab der **DOM Invader**-Tab im DevTools-Panel ge√∂ffnet werden. Nach Abschluss des Scans werden alle √ºber die identifizierten Gadgets zug√§nglichen Sinks in der **DOM**-Ansicht angezeigt. Zum Beispiel wird im folgenden Beispiel eine Gadget-Eigenschaft namens `html`, die an den `innerHTML`-Sink √ºbergeben wird, angezeigt.

## DOM-√úberschreibung

Im vorherigen Bild ist zu sehen, dass der Scan f√ºr DOM-√úberschreibungen aktiviert werden kann. Sobald dies erledigt ist, **beginnt DOM Invader mit der Suche nach DOM-√úberschreibungs-Schwachstellen**.

## Referenzen

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
