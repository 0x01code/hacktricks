# DOM Invader

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PR kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## DOM Invader

DOM Invader ni chombo cha kivinjari kilichosanikishwa kwenye kivinjari kilichojengwa ndani ya Burp. Inasaidia **kugundua udhaifu wa DOM XSS** kwa kutumia vyanzo na visima mbalimbali, ikiwa ni pamoja na ujumbe wa wavuti na uchafuzi wa mfano. Chombo hiki kimesanikishwa tayari kama kifaa cha nyongeza.

DOM Invader inaunganisha kichupo ndani ya kikoa cha DevTools cha kivinjari kinachowezesha yafuatayo:

1. **Ugunduzi wa visima vinavyoweza kudhibitiwa** kwenye ukurasa wa wavuti kwa ajili ya majaribio ya DOM XSS, ikitoa muktadha na maelezo ya kusafisha.
2. **Kuweka kumbukumbu, kuhariri, na kutuma tena ujumbe wa wavuti** uliotumwa kupitia njia ya `postMessage()` kwa ajili ya majaribio ya DOM XSS. DOM Invader pia inaweza kugundua udhaifu kiotomatiki kwa kutumia ujumbe wa wavuti ulioandaliwa kwa umakini.
3. Ugunduzi wa **vyanzo vya uchafuzi wa mfano** upande wa mteja na uchunguzi wa vifaa vinavyoweza kudhibitiwa vinavyotumwa kwenye visima hatari.
4. Ugunduzi wa **udhaifu wa kuchafua DOM**.

### Kuwezesha

Katika kivinjari kilichojengwa ndani ya Burp, nenda kwenye **kifaa cha nyongeza cha Burp** na kuwezesha:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Sasa refusha ukurasa na katika **Dev Tools** utapata **kichupo cha DOM Invader:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Ingiza Kifaru

Katika picha iliyotangulia unaweza kuona **kikundi cha wahusika cha nasibu, hiyo ndiyo Kifaru**. Sasa unapaswa kuanza **kuingiza** katika sehemu tofauti za wavuti (parameta, fomu, url...) na kila wakati bonyeza tafuta. DOM Invader itachunguza ikiwa **kifaru kimeishia kwenye kisima chochote cha kuvutia** ambacho kinaweza kudukuliwa.

Zaidi ya hayo, chaguo **Ingiza parameta za URL** na Ingiza fomu zitafungua kiotomatiki **kichupo kipya** **kikiingiza** **kifaru** katika kila **parameta ya URL** na **fomu** inayopatikana.

### Ingiza Kifaru Tasa

Ikiwa unataka tu kupata visima vya uwezekano ambavyo ukurasa unaweza kuwa navyo, hata kama havina uwezekano wa kudukuliwa, unaweza **kutafuta kifaru tasa**.

### Ujumbe wa Wavuti

DOM Invader inaruhusu majaribio ya DOM XSS kwa kutumia ujumbe wa wavuti na huduma kama vile:

1. **Kuweka kumbukumbu ya ujumbe wa wavuti** uliotumwa kupitia `postMessage()`, kama vile kumbukumbu ya historia ya maombi/jibu ya HTTP ya Burp Proxy.
2. **Kuhariri** na **kutuma tena** ujumbe wa wavuti ili kufanya majaribio ya DOM XSS kwa njia ya mwongozo, kama vile kazi ya Burp Repeater.
3. **Kubadilisha kiotomatiki** na kutuma ujumbe wa wavuti kwa ajili ya kuchunguza DOM XSS.

#### Maelezo ya Ujumbe

Maelezo ya kina yanaweza kuonekana kuhusu kila ujumbe kwa kubonyeza juu yake, ambayo ni pamoja na ikiwa JavaScript upande wa mteja unafikia mali za `origin`, `data`, au `source` za ujumbe.

* **`origin`**: Ikiwa **habari ya asili ya ujumbe haijathibitishwa**, huenda uweze kutuma ujumbe wa msalaba wa asili kwa kushughulikiaji wa tukio **kutoka kwenye kikoa cha nje cha aina yoyote**. Lakini ikiwa imehakikiwa, bado inaweza kuwa na usalama mdogo.
* **`data`**: Hapa ndipo mzigo unatumwa. Ikiwa data hii haikutumiwa, kisima ni bure.
* **`source`**: Inathibitisha ikiwa mali ya chanzo, kawaida ikirejelea iframe, imehakikiwa badala ya asili. Hata kama hii imehakikiwa, haimhakikishii mtu kuwa uthibitisho hauwezi kudukuliwa.

#### Jibu ujumbe

1. Kutoka kwenye **Tazama Ujumbe**, bonyeza kwenye ujumbe wowote ili kufungua dirisha la maelezo ya ujumbe.
2. Hariri uwanja wa **Data** kama inavyohitajika.
3. Bonyeza **Tuma**.

### Uchafuzi wa Mfano

DOM Invader pia inaweza kutafuta **udhaifu wa Uchafuzi wa Mfano**. Kwanza, unahitaji kuwezesha:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Kisha, itaanza **kutafuta vyanzo** vinavyokuwezesha kuongeza mali za kiholela kwenye **`Object.prototype`**.

Ikiwa kitu chochote kitapatikana, kitufe cha **Jaribu** kitatokea ili **jaribu chanzo kilichopatikana**. Bonyeza juu yake, kichupo kipya kitatokea, tengeneza kitu kwenye konsoli na angalia ikiwa `testproperty` ipo:
```javascript
let b = {}
b.testproperty
```
Marafiki, mara baada ya kupata chanzo, unaweza **kutafuta kifaa**:

1. Kichupo kipya kinafunguliwa na DOM Invader wakati kitufe cha **Tafuta vifaa** kinachopatikana karibu na chanzo chochote cha uchafuzi wa protini kilichotambuliwa katika mtazamo wa **DOM** kinapobonyezwa. Utafutaji wa vifaa vinavyofaa huanza kisha.
2. Wakati huo huo, kichupo cha **DOM Invader** kinapaswa kufunguliwa katika kichupo cha DevTools. Baada ya utafutaji kukamilika, sink zozote zinazopatikana kupitia vifaa vilivyotambuliwa zinaonyeshwa katika mtazamo wa **DOM**. Kwa mfano, mali ya kifaa inayoitwa `html` inayopitishwa kwa sink ya `innerHTML` inaonyeshwa katika mfano hapa chini.

## Uchafuzi wa DOM

Katika picha iliyotangulia, inawezekana kuona kuwa utafutaji wa uchafuzi wa DOM unaweza kuwashwa. Mara baada ya kufanywa hivyo, **DOM Invader itaanza kutafuta udhaifu wa uchafuzi wa DOM**.

## Marejeo

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka mwanzo hadi kuwa bingwa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa muundo wa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi wa PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) za kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PR kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
