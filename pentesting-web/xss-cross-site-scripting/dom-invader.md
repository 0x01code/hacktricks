# DOM Invader

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) **groupe Discord** ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## DOM Invader

DOM Invader est un outil de navigateur install√© dans le navigateur int√©gr√© de Burp. Il aide √† **d√©tecter les vuln√©rabilit√©s XSS DOM** en utilisant diverses sources et sinks, y compris les messages Web et la pollution de prototype. L'outil est pr√©install√© en tant qu'extension.

DOM Invader int√®gre un onglet dans le panneau DevTools du navigateur permettant ce qui suit :

1. **Identification des sinks contr√¥lables** sur une page Web pour les tests DOM XSS, fournissant des d√©tails de contexte et de d√©sinfection.
2. **Journalisation, √©dition et renvoi de messages Web** envoy√©s via la m√©thode `postMessage()` pour les tests DOM XSS. DOM Invader peut √©galement d√©tecter automatiquement les vuln√©rabilit√©s √† l'aide de messages Web sp√©cialement con√ßus.
3. D√©tection des sources de **pollution de prototype c√¥t√© client** et num√©risation des gadgets contr√¥lables envoy√©s √† des sinks risqu√©s.
4. Identification des vuln√©rabilit√©s de **clobbering DOM**.

### L'activer

Dans le navigateur int√©gr√© de Burp, allez √† l'**extension Burp** et activez-la :

<figure><img src="../../.gitbook/assets/image (4) (1).png" alt=""><figcaption></figcaption></figure>

Maintenant, actualisez la page et dans les **outils de d√©veloppement**, vous trouverez l'onglet **DOM Invader :**

<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

### Injecter un canari

Dans l'image pr√©c√©dente, vous pouvez voir un **groupe al√©atoire de caract√®res, qui est le canari**. Vous devez maintenant commencer √† **l'injecter** dans diff√©rentes parties du Web (params, formulaires, URL...) et cliquer sur Rechercher √† chaque fois. DOM Invader v√©rifiera si le **canari s'est termin√© dans un sink int√©ressant** qui pourrait √™tre exploit√©.

De plus, les options **Injecter les param√®tres d'URL** et **Injecter les formulaires** ouvriront automatiquement un **nouvel onglet** en **injectant** le **canari** dans chaque **param√®tre d'URL** et **formulaire** qu'il trouve.

### Injecter un canari vide

Si vous voulez simplement trouver des sinks potentiels que la page pourrait avoir, m√™me s'ils ne sont pas exploitables, vous pouvez **rechercher un canari vide**.

### Messages postaux

DOM Invader permet de tester les XSS DOM √† l'aide de messages Web avec des fonctionnalit√©s telles que :

1. **Journalisation des messages Web** envoy√©s via `postMessage()`, semblable √† la journalisation de l'historique des demandes/r√©ponses HTTP de Burp Proxy.
2. **Modification** et **r√©√©mission** de messages Web pour tester manuellement les XSS DOM, similaire √† la fonction de Burp Repeater.
3. **Modification automatique** et envoi de messages Web pour sonder les XSS DOM.

#### D√©tails du message

Vous pouvez cliquer sur chaque message pour afficher des informations plus d√©taill√©es √† son sujet, notamment si les propri√©t√©s `origin`, `data` ou `source` du message sont accessibles par le JavaScript c√¥t√© client.

* **`origin`** : Si les informations d'origine du message ne sont pas v√©rifi√©es, vous pouvez √™tre en mesure d'envoyer des messages entre domaines √† l'event handler **√† partir d'un domaine externe arbitraire**. Mais m√™me si cela est v√©rifi√©, cela peut encore √™tre ins√©curis√©.
* **`data`**: C'est l√† que la charge utile est envoy√©e. Si ces donn√©es ne sont pas utilis√©es, le sink est inutile.
* **`source`**: √âvalue si la propri√©t√© source, faisant g√©n√©ralement r√©f√©rence √† un iframe, est valid√©e au lieu de l'origine. M√™me si cela est v√©rifi√©, cela ne garantit pas que la validation ne peut pas √™tre contourn√©e.

#### R√©pondre √† un message

1. √Ä partir de la vue **Messages**, cliquez sur n'importe quel message pour ouvrir la bo√Æte de dialogue des d√©tails du message.
2. Modifiez le champ **Data** selon les besoins.
3. Cliquez sur **Envoyer**.

### Pollution de prototype

DOM Invader peut √©galement rechercher des **vuln√©rabilit√©s de pollution de prototype**. Tout d'abord, vous devez l'activer :

<figure><img src="../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

Ensuite, il **recherchera des sources** qui vous permettent d'ajouter des propri√©t√©s arbitraires √† **`Object.prototype`**.

Si quelque chose est trouv√©, un bouton **Test** appara√Ætra pour **tester la source trouv√©e**. Cliquez dessus, un nouvel onglet appara√Ætra, cr√©ez un objet dans la console et v√©rifiez si la propri√©t√© `testproperty` existe :
```javascript
let b = {}
b.testproperty
```
Une fois que vous avez trouv√© une source, vous pouvez **analyser pour trouver un gadget** :

1. Dans la vue **DOM**, cliquez sur le bouton **Analyser pour trouver un gadget** √† c√¥t√© de toute source de pollution de prototype que DOM Invader a trouv√©e. DOM Invader ouvre un nouvel onglet et commence √† rechercher des gadgets appropri√©s.
2. Dans le m√™me onglet, ouvrez l'onglet **DOM Invader** dans le panneau DevTools. Une fois l'analyse termin√©e, la vue **DOM** affiche toutes les failles que DOM Invader a pu acc√©der via les gadgets identifi√©s. Dans l'exemple ci-dessous, une propri√©t√© de gadget appel√©e `html` a √©t√© pass√©e √† la faille `innerHTML`.

## √âcrasement de DOM

Dans l'image pr√©c√©dente, il est possible de voir que l'analyse d'√©crasement de DOM peut √™tre activ√©e. Une fois cela fait, **DOM Invader commencera √† rechercher des vuln√©rabilit√©s d'√©crasement de DOM**.

## R√©f√©rences

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
