# DOM Invader

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

## DOM Invader

DOM Invader est un outil de navigateur install√© dans le navigateur int√©gr√© de Burp. Il aide √† **d√©tecter les vuln√©rabilit√©s XSS DOM** en utilisant diverses sources et sinks, y compris les messages web et la pollution de prototype. L'outil est pr√©install√© en tant qu'extension.

DOM Invader int√®gre un onglet dans le panneau DevTools du navigateur permettant ce qui suit :

1. **Identification des sinks contr√¥lables** sur une page web pour les tests XSS DOM, fournissant des d√©tails de contexte et de d√©sinfection.
2. **Journalisation, √©dition et renvoi des messages web** envoy√©s via la m√©thode `postMessage()` pour les tests XSS DOM. DOM Invader peut √©galement d√©tecter automatiquement les vuln√©rabilit√©s en utilisant des messages web sp√©cialement con√ßus.
3. D√©tection des sources de **pollution de prototype c√¥t√© client** et balayage des gadgets contr√¥lables envoy√©s vers des sinks risqu√©s.
4. Identification des **vuln√©rabilit√©s de clobbering DOM**.

### Activer

Dans le navigateur int√©gr√© de Burp, acc√©dez √† l'**extension Burp** et activez-la :

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Maintenant, actualisez la page et dans les **Dev Tools**, vous trouverez l'onglet **DOM Invader** :

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Injecter un canari

Sur l'image pr√©c√©dente, vous pouvez voir un **groupe al√©atoire de caract√®res, qui est le Canari**. Vous devriez maintenant commencer √† **l'injecter** dans diff√©rentes parties du web (param√®tres, formulaires, URL...) et cliquer √† chaque fois sur rechercher. DOM Invader v√©rifiera si le **canari se termine dans un sink int√©ressant** qui pourrait √™tre exploit√©.

De plus, les options **Injecter les param√®tres d'URL** et Injecter les formulaires ouvriront automatiquement un **nouvel onglet** en **injectant** le **canari** dans chaque **param√®tre d'URL** et **formulaire** qu'il trouve.

### Injecter un canari vide

Si vous voulez simplement trouver les sinks potentiels que la page pourrait avoir, m√™me s'ils ne sont pas exploitables, vous pouvez **rechercher un canari vide**.

### Messages post

DOM Invader permet de tester les XSS DOM en utilisant des messages web avec des fonctionnalit√©s telles que :

1. **Journalisation des messages web** envoy√©s via `postMessage()`, similaire √† l'historique de journalisation des requ√™tes/r√©ponses HTTP de Burp Proxy.
2. **Modification** et **r√©√©mission** des messages web pour tester manuellement les XSS DOM, similaire √† la fonction de Burp Repeater.
3. **Modification automatique** et envoi de messages web pour sonder les XSS DOM.

#### D√©tails du message

Des informations d√©taill√©es peuvent √™tre consult√©es sur chaque message en cliquant dessus, ce qui inclut si le JavaScript c√¥t√© client acc√®de aux propri√©t√©s `origin`, `data` ou `source` du message.

* **`origin`** : Si les informations d'**origine du message ne sont pas v√©rifi√©es**, vous pourriez √™tre en mesure d'envoyer des messages cross-origin au gestionnaire d'√©v√©nements **√† partir d'un domaine externe arbitraire**. Mais s'il est v√©rifi√©, cela pourrait toujours √™tre ins√©curis√©.
* **`data`** : C'est l√† que la charge utile est envoy√©e. Si ces donn√©es ne sont pas utilis√©es, le sink est inutile.
* **`source`** : √âvalue si la propri√©t√© source, faisant g√©n√©ralement r√©f√©rence √† un iframe, est valid√©e au lieu de l'origine. M√™me si cela est v√©rifi√©, cela ne garantit pas que la validation ne peut pas √™tre contourn√©e.

#### R√©pondre √† un message

1. Depuis la vue **Messages**, cliquez sur n'importe quel message pour ouvrir la bo√Æte de dialogue des d√©tails du message.
2. Modifiez le champ **Data** selon vos besoins.
3. Cliquez sur **Envoyer**.

### Pollution de prototype

DOM Invader peut √©galement rechercher des **vuln√©rabilit√©s de pollution de prototype**. Tout d'abord, vous devez l'activer :

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Ensuite, il **recherchera des sources** qui vous permettent d'ajouter des propri√©t√©s arbitraires √† l'**`Object.prototype`**.

Si quelque chose est trouv√©, un bouton **Tester** appara√Ætra pour **tester la source trouv√©e**. Cliquez dessus, un nouvel onglet appara√Ætra, cr√©ez un objet dans la console et v√©rifiez si la `testproperty` existe :
```javascript
let b = {}
b.testproperty
```
Une fois que vous avez trouv√© une source, vous pouvez **analyser un gadget** :

1. Un nouvel onglet est ouvert par DOM Invader lorsque le bouton **Analyser les gadgets**, qui se trouve √† c√¥t√© de toute source de pollution de prototype identifi√©e dans la vue **DOM**, est cliqu√©. La recherche de gadgets appropri√©s commence alors.
2. Pendant ce temps, dans le m√™me onglet, l'onglet **DOM Invader** doit √™tre ouvert dans le panneau DevTools. Apr√®s la fin de l'analyse, toutes les failles accessibles via les gadgets identifi√©s sont affich√©es dans la vue **DOM**. Par exemple, une propri√©t√© de gadget nomm√©e `html` pass√©e √† la faille `innerHTML` est affich√©e dans l'exemple ci-dessous.

## Substitution de DOM

Dans l'image pr√©c√©dente, il est possible de voir que l'analyse de la substitution de DOM peut √™tre activ√©e. Une fois cela fait, **DOM Invader commencera √† rechercher des vuln√©rabilit√©s de substitution de DOM**.

## R√©f√©rences

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
