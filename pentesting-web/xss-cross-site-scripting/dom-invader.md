# DOM Invader

<details>

<summary><strong>AWS hackleme becerilerinizi sıfırdan kahraman seviyesine getirin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile</strong>!</summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**'ı** takip edin.
* Hacking hilelerinizi göndererek **HackTricks** ve **HackTricks Cloud** github depolarına PR göndererek **hacking hilelerinizi paylaşın**.

</details>

## DOM Invader

DOM Invader, Burp'un yerleşik tarayıcısına yüklenen bir tarayıcı aracıdır. Web mesajları ve prototip kirliliği de dahil olmak üzere çeşitli kaynaklar ve sızıntılar kullanarak **DOM XSS açıklarını tespit etmeye yardımcı olur**. Araç, bir uzantı olarak önceden yüklenmiştir.

DOM Invader, tarayıcının DevTools panelinde bir sekme entegre ederek aşağıdakileri sağlar:

1. DOM XSS testi için bir web sayfasındaki **kontrol edilebilir sızıntıların belirlenmesi**, bağlam ve temizleme ayrıntıları sağlar.
2. DOM XSS testi için `postMessage()` yöntemi aracılığıyla gönderilen web mesajlarının **günlüğünü, düzenlemesini ve yeniden göndermesini** sağlar. DOM Invader, özel olarak oluşturulmuş web mesajlarını kullanarak zafiyetleri otomatik olarak tespit edebilir.
3. **İstemci tarafı prototip kirliliği** kaynaklarının tespiti ve riskli sızıntılara gönderilen kontrol edilebilir cihazların taraması.
4. **DOM clobbering açıklarının** belirlenmesi.

### Etkinleştirme

Burp'un yerleşik tarayıcısında **Burp uzantısı**na gidin ve etkinleştirin:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Şimdi sayfayı yenileyin ve **Dev Araçları**'nda **DOM Invader sekmesini** bulacaksınız:

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Bir Canary Enjekte Edin

Önceki görüntüde **rastgele bir karakter grubu olan Canary'yi** görebilirsiniz. Şimdi, web'in farklı bölümlerine (parametreler, formlar, url...) enjekte etmeye başlamalısınız ve her seferinde arama düğmesine tıklamalısınız. DOM Invader, sömürülebilecek herhangi bir ilginç sızıntıya **canary'nin ulaşıp ulaşmadığını kontrol edecektir**.

Ayrıca, **URL parametrelerini enjekte et** ve **formları enjekte et** seçenekleri, bulduğu her **URL** parametresine ve **form**a **canary'yi otomatik olarak enjekte eden** yeni bir sekme açacaktır.

### Boş Bir Canary Enjekte Edin

Eğer sayfanın potansiyel sızıntıları olabilecek yerlerini bulmak istiyorsanız, bunlar sömürülebilir olmasa bile, **boş bir canary için arama yapabilirsiniz**.

### Web Mesajları

DOM Invader, web mesajlarını kullanarak DOM XSS testi yapmanıza olanak sağlar ve şu özelliklere sahiptir:

1. `postMessage()` ile gönderilen web mesajlarının, Burp Proxy'nin HTTP istek/yanıt geçmişi günlüğüne benzer şekilde **günlüğünü tutar**.
2. DOM XSS için manuel olarak test etmek için web mesajlarını **düzenleme** ve **yeniden gönderme** özelliği, Burp Repeater'ın işlevine benzer şekilde kullanılabilir.
3. DOM XSS'yi sonda araştırmak için **otomatik değişiklik** ve web mesajlarının gönderilmesi.

#### Mesaj ayrıntıları

Her bir mesaj hakkında ayrıntılı bilgiler, üzerine tıklanarak görüntülenebilir ve bunlar, istemci tarafındaki JavaScript'in mesajın `origin`, `data` veya `source` özelliklerine erişip erişmediğini içerir.

* **`origin`**: Mesajın **köken bilgisi kontrol edilmediyse**, herhangi bir **keyfi harici etki alanından** olay işleyiciye çapraz kökenli mesajlar gönderebilirsiniz. Ancak kontrol edilse bile güvensiz olabilir.
* **`data`**: Buraya yüklenen veriler gönderilir. Bu veri kullanılmıyorsa, sızıntı işe yaramaz.
* **`source`**: Genellikle bir iframe'e referans olan kaynağı doğrulandığından, kaynak özelliğinin değerlendirilip değerlendirilmediğini değerlendirir. Bu kontrol edilse bile, doğrulamanın atlatılamayacağı garanti edilmez.

#### Bir mesajı yanıtla

1. **Mesajlar** görünümünden herhangi bir mesaja tıklayarak mesaj ayrıntıları iletişim kutusunu açın.
2. **Veri** alanını gerektiği gibi düzenleyin.
3. **Gönder** düğmesine tıklayın.

### Prototip Kirliliği

DOM Invader ayrıca **Prototip Kirliliği açıklarını** arayabilir. İlk olarak, bunu etkinleştirmeniz gerekmektedir:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Ardından, **`Object.prototype`**'ye keyfi özellikler eklemenizi sağlayan kaynakları **aramaya başlayacaktır**.

Herhangi bir şey bulunursa, **Test** düğmesi görünecek ve **bulunan kaynağı test etmek** için üzerine tıklayın, yeni bir sekme açılacak ve konsolda bir nesne oluşturup `testproperty`'nin var olup olmadığını kontrol edin:
```javascript
let b = {}
b.testproperty
```
Bir kaynak bulduktan sonra **gadget taraması yapabilirsiniz**:

1. DOM Invader tarafından **Gadget taraması** düğmesi tıklanarak yeni bir sekme açılır. Bu düğme, **DOM** görünümünde tanımlanan herhangi bir prototip kirliliği kaynağının yanında bulunabilir. Uygun gadget'lar için tarama başlar.
2. Aynı sekmede, **DOM Invader** sekmesi DevTools panelinde açılmalıdır. Tarama tamamlandıktan sonra, tanımlanan gadget'lar aracılığıyla erişilebilen herhangi bir sızıntı **DOM** görünümünde gösterilir. Örneğin, `innerHTML` sızıntısına geçirilen `html` adlı bir gadget özelliği aşağıdaki örnekte gösterilir.

## DOM clobbering

Önceki görüntüde DOM clobbering taramasının etkinleştirilebileceği görülebilir. Bittiğinde, **DOM Invader DOM clobbering zafiyetlerini aramaya başlayacaktır**.

## Referanslar

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahraman olmak için</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>'ı öğrenin!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı yapmak veya HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**'da takip edin.**
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR göndererek paylaşın.

</details>
