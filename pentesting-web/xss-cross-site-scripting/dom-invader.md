# DOM Invader

<details>

<summary><strong>Dowiedz się, jak hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repozytoriów GitHub.

</details>

## DOM Invader

DOM Invader to narzędzie przeglądarkowe zainstalowane w wbudowanej przeglądarce Burp. Pomaga w **wykrywaniu podatności na DOM XSS** za pomocą różnych źródeł i ujść, w tym wiadomości internetowych i zanieczyszczenia prototypu. Narzędzie jest preinstalowane jako rozszerzenie.

DOM Invader integruje zakładkę w panelu Narzędzi deweloperskich przeglądarki, umożliwiającą:

1. **Identyfikację kontrolowalnych ujść** na stronie internetowej do testowania DOM XSS, dostarczając kontekstu i szczegółów dotyczących oczyszczania.
2. **Rejestrowanie, edytowanie i ponowne wysyłanie wiadomości internetowych** wysyłanych za pomocą metody `postMessage()` do testowania DOM XSS. DOM Invader może również automatycznie wykrywać podatności za pomocą specjalnie przygotowanych wiadomości internetowych.
3. Wykrywanie źródeł **zanieczyszczenia prototypu po stronie klienta** i skanowanie kontrolowalnych gadżetów wysyłanych do ryzykownych ujść.
4. Identyfikację podatności na **zastępowanie DOM**.

### Włączanie

W wbudowanej przeglądarce Burp przejdź do **rozszerzenia Burp** i włącz je:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Teraz odśwież stronę, a w **Narzędziach deweloperskich** znajdziesz zakładkę **DOM Invader:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Wstrzykiwanie kanarka

Na poprzednim obrazku możesz zobaczyć **losową grupę znaków, która jest kanarkiem**. Teraz powinieneś zacząć **wstrzykiwać** go w różne części strony internetowej (parametry, formularze, adres URL...) i za każdym razem kliknąć przycisk wyszukiwania. DOM Invader sprawdzi, czy **kanarek trafił do jakiegokolwiek interesującego ujścia**, które można by wykorzystać.

Ponadto, opcje **Wstrzykiwanie parametrów URL** i **Wstrzykiwanie formularzy** automatycznie otworzą **nową kartę** i **wstrzykną** kanarka do każdego **parametru URL** i **formularza**, które zostaną znalezione.

### Wstrzykiwanie pustego kanarka

Jeśli chcesz tylko znaleźć potencjalne ujścia, które strona może mieć, nawet jeśli nie są one wykorzystywalne, możesz **wyszukać pusty kanarek**.

### Wiadomości internetowe

DOM Invader umożliwia testowanie DOM XSS za pomocą wiadomości internetowych z funkcjami takimi jak:

1. **Rejestrowanie wiadomości internetowych** wysyłanych za pomocą `postMessage()`, podobnie jak rejestrowanie historii żądań/odpowiedzi HTTP w Burp Proxy.
2. **Modyfikowanie** i **ponowne wysyłanie** wiadomości internetowych w celu ręcznego testowania DOM XSS, podobnie jak funkcja Burp Repeater.
3. **Automatyczna zmiana** i wysyłanie wiadomości internetowych w celu sondowania DOM XSS.

#### Szczegóły wiadomości

Szczegółowe informacje o każdej wiadomości można zobaczyć, klikając na nią, co obejmuje informacje, czy skrypt po stronie klienta JavaScript ma dostęp do właściwości `origin`, `data` lub `source` wiadomości.

* **`origin`**: Jeśli **informacje o pochodzeniu wiadomości nie są sprawdzane**, możesz wysyłać wiadomości międzydomenowe do obsługi zdarzeń **z dowolnej zewnętrznej domeny**. Ale jeśli jest sprawdzane, to nadal może być niewłaściwe.
* **`data`**: Tutaj jest wysyłany ładunek. Jeśli te dane nie są używane, ujście jest bezużyteczne.
* **`source`**: Ocena, czy właściwość źródłowa, zazwyczaj odnosząca się do elementu iframe, jest sprawdzana zamiast pochodzenia. Nawet jeśli jest to sprawdzane, nie gwarantuje to, że walidacja nie może zostać ominięta.

#### Odpowiedź na wiadomość

1. Z widoku **Wiadomości** kliknij dowolną wiadomość, aby otworzyć okno szczegółów wiadomości.
2. Edytuj pole **Data** według potrzeb.
3. Kliknij **Wyślij**.

### Zanieczyszczenie prototypu

DOM Invader może również wyszukiwać **podatności na zanieczyszczenie prototypu**. Najpierw musisz je włączyć:

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Następnie będzie **wyszukiwać źródła**, które umożliwiają dodawanie dowolnych właściwości do **`Object.prototype`**.

Jeśli coś zostanie znalezione, pojawi się przycisk **Test**, aby **przetestować znalezione źródło**. Kliknij na niego, pojawi się nowa karta, utwórz obiekt w konsoli i sprawdź, czy istnieje `testproperty`:
```javascript
let b = {}
b.testproperty
```
Gdy już znajdziesz źródło, możesz **przeszukać gadżety**:

1. Nowa karta zostaje otwarta przez DOM Invader, gdy klikniesz przycisk **Przeszukaj gadżety**, który znajduje się obok zidentyfikowanego źródła zanieczyszczenia prototypu w widoku **DOM**. Następnie rozpoczyna się skanowanie odpowiednich gadżetów.
2. W międzyczasie, w tej samej karcie, powinna być otwarta karta **DOM Invader** w panelu narzędzi DevTools. Po zakończeniu skanowania, wszystkie ujścia dostępne za pomocą zidentyfikowanych gadżetów są wyświetlane w widoku **DOM**. Na przykład, w poniższym przykładzie pokazano właściwość gadżetu o nazwie `html`, która jest przekazywana do ujścia `innerHTML`.

## Nadpisywanie DOM

Na poprzednim obrazku można zobaczyć, że można włączyć skanowanie nadpisywania DOM. Po włączeniu, **DOM Invader rozpocznie wyszukiwanie podatności na nadpisywanie DOM**.

## Odnośniki

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
