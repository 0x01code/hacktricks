# DOM Invader

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs exclusifs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## DOM Invader

DOM Invader est un outil de navigateur install√© dans le navigateur int√©gr√© de Burp. Il aide √† **d√©tecter les vuln√©rabilit√©s DOM XSS** en utilisant diverses sources et puits, y compris les messages web et la pollution de prototype. L'outil est pr√©install√© en tant qu'extension.

DOM Invader int√®gre un onglet dans le panneau DevTools du navigateur permettant :

1. **Identification des puits contr√¥lables** sur une page web pour les tests DOM XSS, fournissant le contexte et les d√©tails de la sanitisation.
2. **Enregistrement, √©dition et renvoi des messages web** envoy√©s via la m√©thode `postMessage()` pour les tests DOM XSS. DOM Invader peut √©galement d√©tecter automatiquement les vuln√©rabilit√©s en utilisant des messages web sp√©cialement con√ßus.
3. D√©tection de **sources de pollution de prototype c√¥t√© client** et analyse des gadgets contr√¥lables envoy√©s aux puits risqu√©s.
4. Identification des **vuln√©rabilit√©s de clobbering DOM**.

### Activer

Dans le navigateur int√©gr√© de Burp, allez √† l'**extension Burp** et activez-la :

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

Maintenant, rafra√Æchissez la page et dans les **Dev Tools**, vous trouverez l'**onglet DOM Invader** :

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Injecter un Canary

Dans l'image pr√©c√©dente, vous pouvez voir un **groupe al√©atoire de caract√®res, c'est le Canary**. Vous devriez maintenant commencer √† **l'injecter** dans diff√©rentes parties du web (param√®tres, formulaires, URL...) et √† chaque fois cliquer pour le rechercher. DOM Invader v√©rifiera si le **canary a termin√© dans un puits int√©ressant** qui pourrait √™tre exploit√©.

De plus, les options **Injecter les param√®tres URL** et Injecter les formulaires ouvriront automatiquement un **nouvel onglet** **injectant** le **canary** dans chaque **param√®tre URL** et **formulaire** trouv√©.

### Injecter un Canary vide

Si vous voulez juste trouver des puits potentiels que la page pourrait avoir, m√™me s'ils ne sont pas exploitables, vous pouvez **rechercher un canary vide**.

### Messages Post

DOM Invader permet de tester les DOM XSS en utilisant des messages web avec des fonctionnalit√©s telles que :

1. **Enregistrement des messages web** envoy√©s via `postMessage()`, semblable √† l'historique de logging des requ√™tes/r√©ponses HTTP de Burp Proxy.
2. **Modification** et **r√©√©mission** des messages web pour tester manuellement les DOM XSS, similaire √† la fonction de Burp Repeater.
3. **Alt√©ration automatique** et envoi de messages web pour sonder les DOM XSS.

#### D√©tails du message

Vous pouvez cliquer sur chaque message pour voir plus d'informations d√©taill√©es √† son sujet, y compris si les propri√©t√©s `origin`, `data` ou `source` du message sont acc√©d√©es par le JavaScript c√¥t√© client.

* **`origin`** : Si **l'information d'origine du message n'est pas v√©rifi√©e**, vous pourriez √™tre capable d'envoyer des messages cross-origin au gestionnaire d'√©v√©nements **depuis un domaine externe arbitraire**. Mais si elle est v√©rifi√©e, cela pourrait toujours √™tre non s√©curis√©.
* **`data`**: C'est l√† que le payload est envoy√©. Si ces donn√©es ne sont pas utilis√©es, le puits est inutile.
* **`source`**: √âvalue si la propri√©t√© source, faisant g√©n√©ralement r√©f√©rence √† un iframe, est valid√©e au lieu de l'origine. M√™me si cela est v√©rifi√©, cela ne garantit pas que la validation ne peut pas √™tre contourn√©e.

#### R√©pondre √† un message

1. Depuis la vue **Messages**, cliquez sur n'importe quel message pour ouvrir la bo√Æte de dialogue des d√©tails du message.
2. Modifiez le champ **Data** comme n√©cessaire.
3. Cliquez sur **Envoyer**.

### Pollution de Prototype

DOM Invader peut √©galement rechercher des **vuln√©rabilit√©s de pollution de prototype**. Tout d'abord, vous devez l'activer :

<figure><img src="../../.gitbook/assets/image (5) (1) (1) (3).png" alt=""><figcaption></figcaption></figure>

Ensuite, il **recherchera des sources** qui vous permettent d'ajouter des propri√©t√©s arbitraires √† l'**`Object.prototype`**.

Si quelque chose est trouv√©, un bouton **Tester** appara√Ætra pour **tester la source trouv√©e**. Cliquez dessus, un nouvel onglet appara√Ætra, cr√©ez un objet dans la console et v√©rifiez si la `testproperty` existe :
```javascript
let b = {}
b.testproperty
```
Une fois que vous avez trouv√© une source, vous pouvez **scanner √† la recherche d'un gadget** :

1. Depuis la vue **DOM**, cliquez sur le bouton **Scanner √† la recherche de gadgets** √† c√¥t√© de toute source de pollution de prototype que DOM Invader a trouv√©e. DOM Invader ouvre un nouvel onglet et commence le scan √† la recherche de gadgets appropri√©s.
2. Dans le m√™me onglet, ouvrez l'onglet **DOM Invader** dans le panneau DevTools. Une fois le scan termin√©, la vue **DOM** affiche tous les points d'injection que DOM Invader a pu acc√©der via les gadgets identifi√©s. Dans l'exemple ci-dessous, une propri√©t√© de gadget appel√©e `html` a √©t√© pass√©e au point d'injection `innerHTML`.

## DOM clobbering

Dans l'image pr√©c√©dente, il est possible de voir que le scan de DOM clobbering peut √™tre activ√©. Une fois fait, **DOM Invader commencera √† rechercher des vuln√©rabilit√©s de DOM clobbering**.

## R√©f√©rences

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> !</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
