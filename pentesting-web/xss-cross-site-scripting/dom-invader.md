# DOM Invader

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>

## DOM Invader

DOM Invader рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ Burp рдХреЗ рдЗрдирдмрд┐рд▓реНрдЯ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рднрд┐рдиреНрди рд╕реНрд░реЛрддреЛрдВ рдФрд░ рд╕рд┐рдВрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **DOM XSS рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ** рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╡реЗрдм рд╕рдВрджреЗрд╢ рдФрд░ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдпрд╣ рдЙрдкрдХрд░рдг рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддрд╛ рд╣реИред

DOM Invader рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ DevTools рдкреИрдирд▓ рдореЗрдВ рдПрдХ рдЯреИрдм рдХреЛ рдПрдХреАрдХреГрдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛рд░реНрдп рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

1. DOM XSS рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рд╡реЗрдмрдкреЗрдЬ рдкрд░ **рдирд┐рдпрдВрддреНрд░рдг рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╕рд┐рдВрдХреНрд╕ рдХреА рдкрд╣рдЪрд╛рди** рдХрд░рдирд╛, рд╕рдВрджрд░реНрдн рдФрд░ рд╕реНрд╡рдЪреНрдЫреАрдХрд░рдг рд╡рд┐рд╡рд░рдг рдкреНрд░рджрд╛рди рдХрд░рдирд╛ред
2. `postMessage()` рд╡рд┐рдзрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬреЗ рдЧрдП рд╡реЗрдм рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ **рд▓реЙрдЧ рдХрд░рдирд╛, рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рдФрд░ рдкреБрдирдГ рднреЗрдЬрдирд╛** DOM XSS рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдПред DOM Invader рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдП рдЧрдП рд╡реЗрдм рд╕рдВрджреЗрд╢реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрдХрдЯрдкреВрд░реНрдгрддрд╛ рдХреА рдЬрд╛рдВрдЪ рднреА рдХрд░ рд╕рдХрддрд╛ рд╣реИред
3. **рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдкреНрд░рджреВрд╖рдг** рд╕реНрд░реЛрддреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдФрд░ рдЬреЛрдЦрд┐рдордкреВрд░реНрдг рд╕рд┐рдВрдХреНрд╕ рдХреЛ рднреЗрдЬреЗ рдЧрдП рдирд┐рдпрдВрддреНрд░рдг рдпрдВрддреНрд░реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ред
4. **DOM clobbering рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди** рдХрд░рдирд╛ред

### рдЗрд╕реЗ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ

Burp рдХреЗ рдЗрдирдмрд┐рд▓реНрдЯ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдЬрд╛рдПрдВ рдФрд░ **Burp рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдореЗрдВ рдЬрд╛рдПрдВ рдФрд░ рдЗрд╕реЗ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ:

<figure><img src="../../.gitbook/assets/image (4) (1) (1) (2).png" alt=""><figcaption></figcaption></figure>

рдЕрдм рдкреГрд╖реНрда рдХреЛ рд░рд┐рдлреНрд░реЗрд╢ рдХрд░реЗрдВ рдФрд░ **Dev Tools** рдореЗрдВ рдЖрдкрдХреЛ **DOM Invader рдЯреИрдм рдорд┐рд▓реЗрдЧрд╛:**

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### рдПрдХ рдХреИрдирд╛рд░реА рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ

рдкрд┐рдЫрд▓реА рдЫрд╡рд┐ рдореЗрдВ рдЖрдк рдПрдХ **рд░реИрдВрдбрдо рдЧреНрд░реБрдк рдСрдлрд╝ рдЪрд╛рд░реНрд╕ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд╡рд╣реА рдХреИрдирд╛рд░реА рд╣реИ**ред рдЕрдм рдЖрдкрдХреЛ рдЗрд╕реЗ рд╡реЗрдм рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╣рд┐рд╕реНрд╕реЛрдВ рдореЗрдВ **рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП** (рдкреИрд░рд╛рдореАрдЯрд░, рдлрд╝реЙрд░реНрдо, URL...) рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рд░ рдЦреЛрдЬ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред DOM Invader рдпрд╣ рдЬрд╛рдВрдЪреЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ **рджрд┐рд▓рдЪрд╕реНрдк рд╕рд┐рдВрдХ рдореЗрдВ рдХреИрдирд╛рд░реА рд╕рдорд╛рдкреНрдд рд╣реБрдИ рд╣реИ** рдЬрд┐рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╡рд┐рдХрд▓реНрдк **Inject URL params** рдФрд░ **Inject forms** рдЖрдкрдХреЛ рд╣рд░ **URL** рдкреИрд░рд╛рдореАрдЯрд░ рдФрд░ **рдлрд╝реЙрд░реНрдо** рдореЗрдВ **рдХреИрдирд╛рд░реА рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдпрд╛ рдЯреИрдм рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЦреЛрд▓реЗрдВрдЧреЗ**ред

### рдПрдХ рдЦрд╛рд▓реА рдХреИрдирд╛рд░реА рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ

рдпрджрд┐ рдЖрдк рдХреЗрд╡рд▓ рдкреГрд╖реНрда рдореЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рд┐рдВрдХреНрд╕ рдЦреЛрдЬрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЪрд╛рд╣реЗ рд╡реЗ рдЙрдкрдпреЛрдЧреА рди рд╣реЛрдВ, рддреЛ рдЖрдк **рдПрдХ рдЦрд╛рд▓реА рдХреИрдирд╛рд░реА рдХреЗ рд▓рд┐рдП рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ**ред

### рдкреЛрд╕реНрдЯ рд╕рдВрджреЗрд╢

DOM Invader рд╡реЗрдм рд╕рдВрджреЗрд╢реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ DOM XSS рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреИрд╕реЗ:

1. `postMessage()` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬреЗ рдЧрдП рд╡
```javascript
let b = {}
b.testproperty
```
рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдкрдиреЗ рдПрдХ рд╕реНрд░реЛрдд рдвреВрдВрдврд╝ рд▓рд┐рдпрд╛ рд╣реИ, рддреЛ рдЖрдк **рдЧреИрдЬреЗрдЯ рдХреЗ рд▓рд┐рдП рд╕реНрдХреИрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**:

1. **DOM** рджреГрд╢реНрдп рд╕реЗ, DOM Invader рджреНрд╡рд╛рд░рд╛ рдкрд╛рдП рдЧрдП рдХрд┐рд╕реА рднреА prototype pollution рд╕реНрд░реЛрдд рдХреЗ рдкрд╛рд╕ рдЙрдкрд╕реНрдерд┐рдд **Scan for gadgets** рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред DOM Invader рдПрдХ рдирдпрд╛ рдЯреИрдм рдЦреЛрд▓рддрд╛ рд╣реИ рдФрд░ рдЙрдкрдпреБрдХреНрдд рдЧреИрдЬреЗрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд╕реНрдХреИрдирд┐рдВрдЧ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИред
2. рдПрдХ рд╣реА рдЯреИрдм рдореЗрдВ, DevTools рдкреИрдирд▓ рдореЗрдВ **DOM Invader** рдЯреИрдм рдЦреЛрд▓реЗрдВред рд╕реНрдХреИрди рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, **DOM** рджреГрд╢реНрдп рдореЗрдВ DOM Invader рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдВрдЪреЗ рдЧрдП рдХрд┐рд╕реА рднреА рд╕рд┐рдВрдХреНрд╕ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдПрдХ рдЧреИрдЬреЗрдЯ рдкреНрд░реЙрдкрд░реНрдЯреА рдЬрд┐рд╕реЗ `html` рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, `innerHTML` рд╕рд┐рдВрдХ рдореЗрдВ рдкрд╛рд╕ рдХреА рдЧрдИ рдереАред

## DOM clobbering

рдкрд┐рдЫрд▓реА рдЫрд╡рд┐ рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ DOM clobbering рд╕реНрдХреИрди рдХреЛ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдПрдХ рдмрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рдкрд░, **DOM Invader DOM clobbering vulnerabilities рдХреЗ рд▓рд┐рдП рдЦреЛрдЬрдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрдЧрд╛**ред

## рд╕рдВрджрд░реНрдн

* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
* [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛред**

</details>
