# SOME - Aynı Köken Yöntem Yürütme

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahraman olmaya kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

* **Bir siber güvenlik şirketinde mi çalışıyorsunuz?** **Şirketinizi HackTricks'te reklam görmek ister misiniz?** ya da **PEASS'ın en son sürümüne erişmek veya HackTricks'i PDF olarak indirmek ister misiniz?** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu görün
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* **Katılın** [**💬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **Twitter** 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**'u takip edin**.
* **Hacking püf noktalarınızı göndererek** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ve** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **üzerinden paylaşın**.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) **karanlık ağ** destekli bir arama motorudur ve şirketin veya müşterilerinin **hırsız kötü amaçlı yazılımlar** tarafından **kompromize edilip edilmediğini kontrol etmek için ücretsiz** işlevsellikler sunar.

WhiteIntel'in asıl amacı, bilgi çalan kötü amaçlı yazılımlardan kaynaklanan hesap ele geçirmeleri ve fidye yazılımı saldırılarıyla mücadele etmektir.

Websitesini ziyaret edebilir ve motorlarını **ücretsiz** deneyebilirsiniz:

{% embed url="https://whiteintel.io" %}

---

## Aynı Köken Yöntem Yürütme

Bazı durumlarda bir sayfada sınırlı bir şekilde javascript yürütebilirsiniz. Örneğin, [**yürütülecek bir geri çağrı değerini kontrol edebileceğiniz durumlar**](./#javascript-function) gibi.

Bu durumlarda, yapabileceğiniz en iyi şeylerden biri, **DOM'a erişmek ve orada bulabileceğiniz hassas eylemleri çağırmaktır** (örneğin bir düğmeye tıklamak gibi). Ancak genellikle bu zayıf noktayı **DOM'da ilginç bir şey olmayan küçük uç noktalarda bulacaksınız**.

Bu senaryolarda, bu saldırı çok faydalı olacaktır, çünkü amacı, **aynı kökenden farklı bir sayfadaki DOM içindeki sınırlı JS yürütümünü kötüye kullanabilmektir** ve daha ilginç eylemler yapmaktır.

Temelde, saldırı akışı aşağıdaki gibidir:

* **Kötüye kullanabileceğiniz bir geri çağrı bulun** (potansiyel olarak \[\w\\.\_]'ye sınırlı olabilir).
* Eğer sınırlı değilse ve herhangi bir JS yürütebiliyorsanız, bunu normal bir XSS olarak kötüye kullanabilirsiniz.
* **Kurbanın, saldırgan tarafından kontrol edilen bir sayfayı açmasını sağlayın**
* **Sayfa kendini** bir **farklı pencerede açacak** (yeni pencere, başlangıçtaki pencereyi referans alan **`opener`** nesnesine sahip olacaktır)
* **Başlangıç sayfası**, **ilginç DOM**'un bulunduğu **sayfayı yükleyecektir**.
* **İkinci sayfa**, **kötüye kullanılan geri çağrıyı kötüye kullanarak** ve **`opener`** nesnesini kullanarak **başlangıç sayfasında bazı eylemleri erişip yürütmesi** için **vulnerable** sayfayı yükleyecektir (şimdi ilginç DOM'u içeren başlangıç sayfasını içerir).

{% hint style="danger" %}
Unutmayın ki, başlangıç sayfa ikinci sayfayı oluşturduktan sonra yeni bir URL'ye erişse bile, **ikinci sayfanın `opener` nesnesi hala yeni DOM'daki ilk sayfaya geçerli bir referanstır**.

Ayrıca, ikinci sayfanın opener nesnesini kullanabilmesi için **her iki sayfanın aynı kökende olması gerekir**. Bu nedenle, bu zayıflığı kötüye kullanmak için **aynı kökende XSS türü** bir şey bulmanız gerekmektedir.
{% endhint %}

### Sömürü

* Bu formu kullanarak bu tür bir zayıflığı sömürmek için **PoC oluşturabilirsiniz**: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Bir HTML öğesine tıklamak için bir DOM yolunu bulmak için bu tarayıcı eklentisini kullanabilirsiniz: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Örnek

* [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/) adresinde zayıf bir örnek bulabilirsiniz
* Bu örnekte sunucu **javascript kodu oluşturuyor** ve **callback parametresinin içeriğine göre** HTML'ye ekliyor: `<script>opener.{callbacl_content}</script>` . Bu nedenle, bu örnekte `opener`'ın kullanımını açıkça belirtmenize gerek yoktur.
* Ayrıca bu CTF çözümüne bakın: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Referanslar

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)
