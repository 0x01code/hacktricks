# SOME - Same Origin Method Execution

<details>

<summary><strong>Leer AWS hak vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Werk jy by 'n **cybersecurity maatskappy**? Wil jy jou **maatskappy geadverteer sien in HackTricks**? of wil jy toegang h√™ tot die **nuutste weergawe van die PEASS of HackTricks aflaai in PDF**? Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Sluit aan by die** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** my op **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **en** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) is 'n **dark-web** aangedrewe soekenjin wat **gratis** funksies bied om te kyk of 'n maatskappy of sy kli√´nte deur **steelmalware** **gekompromiteer** is.

Die prim√™re doel van WhiteIntel is om rekening-oorneeminge en lospryse-aanvalle te beveg wat voortspruit uit inligtingsteelmalware.

Jy kan hul webwerf besoek en hul enjin **gratis** probeer by:

{% embed url="https://whiteintel.io" %}

***

## Same Origin Method Execution

Daar sal geleenthede wees waar jy 'n beperkte hoeveelheid javascript in 'n bladsy kan uitvoer. Byvoorbeeld, in die geval waar jy 'n **terugroepwaarde kan beheer wat uitgevoer sal word**.

In daardie geval is een van die beste dinge wat jy kan doen om **toegang tot die DOM te kry om enige** sensitiewe aksie wat jy daar kan vind, te roep (soos 'n knoppie kliek). Gewoonlik sal jy egter hierdie kwesbaarheid vind in **klein eindpunte sonder enige interessante ding in die DOM**.

In daardie scenario's sal hierdie aanval baie nuttig wees, omdat die doel is om in staat te wees om **die beperkte JS-uitvoering binne 'n DOM vanaf 'n ander bladsy van dieselfde domein te misbruik** met baie interessante aksies.

Basies is die aanvalsproses die volgende:

* Vind 'n **terugroepwaarde wat jy kan misbruik** (moontlik beperk tot \[\w\\.\_]).
* As dit nie beperk is nie en jy enige JS kan uitvoer, kan jy dit net misbruik as 'n gewone XSS
* Maak die **slagoffer oop 'n bladsy** wat deur die **aanvaller beheer word**
* Die **bladsy sal homself oopmaak** in 'n **ander venster** (die nuwe venster sal die objek **`opener`** h√™ wat na die aanvanklike een verwys)
* Die **aanvanklike bladsy** sal die **bladsy** laai waar die **interessante DOM** gele√´ is.
* Die **tweede bladsy** sal die **kwesbare bladsy laai wat die terugroepwaarde misbruik** en die **`opener`** objek gebruik om **toegang te verkry en 'n aksie in die aanvanklike bladsy uit te voer** (wat nou die interessante DOM bevat).

{% hint style="danger" %}
Let daarop dat selfs al het die aanvanklike bladsy toegang tot 'n nuwe URL nadat die tweede bladsy geskep is, is die **`opener` objek van die tweede bladsy steeds 'n geldige verwysing na die eerste bladsy in die nuwe DOM**.

Verder moet beide bladsye in dieselfde oorsprong wees sodat die tweede bladsy die opener objek kan gebruik. Dit is die rede waarom jy, om hierdie kwesbaarheid te misbruik, 'n soort **XSS in dieselfde oorsprong** moet vind.
{% endhint %}

### Uitbuiting

* Jy kan hierdie vorm gebruik om 'n **PoC te genereer** om hierdie tipe kwesbaarheid te misbruik: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Om 'n DOM-pad na 'n HTML-element met 'n kliek te vind, kan jy hierdie blaaieruitbreiding gebruik: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Voorbeeld

* Jy kan 'n kwesbare voorbeeld vind by [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/)
* Let daarop dat in hierdie voorbeeld die bediener **javascript-kode genereer** en dit by die HTML voeg op grond van die **inhoud van die terugroepwaarde parameter:** `<script>opener.{callbacl_content}</script>` . Daarom hoef jy in hierdie voorbeeld nie die gebruik van `opener` uitdruklik aan te dui nie.
* Kyk ook na hierdie CTF skryfstuk: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Verwysings

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/) 

<details>

<summary><strong>Leer AWS hak vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Werk jy by 'n **cybersecurity maatskappy**? Wil jy jou **maatskappy geadverteer sien in HackTricks**? of wil jy toegang h√™ tot die **nuutste weergawe van die PEASS of HackTricks aflaai in PDF**? Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Sluit aan by die** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** my op **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **en** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>
