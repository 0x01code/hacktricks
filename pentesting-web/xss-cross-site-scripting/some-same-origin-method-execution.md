# SOME - Same Origin Method Execution

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Arbeiten Sie in einem **Cybersicherheitsunternehmen**? M√∂chten Sie Ihr **Unternehmen in HackTricks beworben sehen**? Oder m√∂chten Sie Zugang zur **neuesten Version des PEASS erhalten oder HackTricks als PDF herunterladen**? √úberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* **Treten Sie der** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie mir auf **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an das** [**hacktricks-Repository**](https://github.com/carlospolop/hacktricks) **und das** [**hacktricks-cloud-Repository**](https://github.com/carlospolop/hacktricks-cloud) **senden**.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) ist eine von **Dark Web** angetriebene Suchmaschine, die **kostenlose** Funktionen bietet, um zu √ºberpr√ºfen, ob ein Unternehmen oder seine Kunden von **Stealer-Malware**n **kompromittiert** wurden.

Das Hauptziel von WhiteIntel ist es, Konto√ºbernahmen und Ransomware-Angriffe aufgrund von informationsstehlender Malware zu bek√§mpfen.

Sie k√∂nnen ihre Website besuchen und ihr Tool kostenlos ausprobieren unter:

{% embed url="https://whiteintel.io" %}

---

## Same Origin Method Execution

Es wird Situationen geben, in denen Sie etwas begrenztes JavaScript auf einer Seite ausf√ºhren k√∂nnen. Zum Beispiel, wenn Sie einen **Callback-Wert steuern k√∂nnen, der ausgef√ºhrt wird**.

In solchen F√§llen ist eine der besten Dinge, die Sie tun k√∂nnten, auf das DOM zuzugreifen, um eine beliebige sensible Aktion auszuf√ºhren, die Sie dort finden k√∂nnen (wie das Klicken auf eine Schaltfl√§che). Normalerweise finden Sie diese Schwachstelle jedoch in **kleinen Endpunkten ohne interessante Dinge im DOM**.

In diesen Szenarien wird dieser Angriff sehr n√ºtzlich sein, da sein Ziel darin besteht, die begrenzte JS-Ausf√ºhrung innerhalb eines DOM von einer anderen Seite derselben Domain aus zu **missbrauchen** mit vielen interessanten Aktionen.

Grunds√§tzlich folgt der Angriffsablauf wie folgt:

* Finden Sie einen **Callback, den Sie missbrauchen k√∂nnen** (potenziell auf \[\w\\.\_] beschr√§nkt).
* Wenn es nicht begrenzt ist und Sie beliebiges JS ausf√ºhren k√∂nnen, k√∂nnten Sie dies einfach wie ein regul√§res XSS missbrauchen.
* Lassen Sie das **Opfer eine Seite** √∂ffnen, die vom **Angreifer kontrolliert wird**.
* Die **Seite wird sich selbst** in einem **anderen Fenster** √∂ffnen (das neue Fenster wird das Objekt **`opener`** haben, das auf das urspr√ºngliche verweist).
* Die **urspr√ºngliche Seite** wird die **Seite** laden, auf der sich das **interessante DOM** befindet.
* Die **zweite Seite** wird die **verwundbare Seite laden, den Callback missbrauchen** und das **`opener`**-Objekt verwenden, um **auf die urspr√ºngliche Seite zuzugreifen und eine Aktion auszuf√ºhren** (die jetzt das interessante DOM enth√§lt).

{% hint style="danger" %}
Beachten Sie, dass selbst wenn die urspr√ºngliche Seite nach dem Erstellen der zweiten Seite auf eine neue URL zugreift, das **`opener`-Objekt der zweiten Seite immer noch eine g√ºltige Referenz zur ersten Seite im neuen DOM** ist.

Dar√ºber hinaus m√ºssen beide Seiten **im selben Ursprung** sein, damit die zweite Seite das `opener`-Objekt verwenden kann. Dies ist der Grund, warum Sie, um diese Schwachstelle auszunutzen, eine Art **XSS im selben Ursprung** finden m√ºssen.
{% endhint %}

### Ausnutzung

* Sie k√∂nnen dieses Formular verwenden, um einen **PoC zu generieren**, um diese Art von Schwachstelle auszunutzen: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Um einen DOM-Pfad zu einem HTML-Element mit einem Klick zu finden, k√∂nnen Sie diese Browsererweiterung verwenden: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Beispiel

* Ein anf√§lliges Beispiel finden Sie unter [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/)
* Beachten Sie, dass in diesem Beispiel der Server **JavaScript-Code generiert** und ihn auf der Grundlage des **Inhalts des Callback-Parameters** zum HTML hinzuf√ºgt: `<script>opener.{callbacl_content}</script>` . Deshalb m√ºssen Sie in diesem Beispiel die Verwendung von `opener` nicht explizit angeben.
* √úberpr√ºfen Sie auch dieses CTF-Write-up: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Referenzen

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/) 

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Arbeiten Sie in einem **Cybersicherheitsunternehmen**? M√∂chten Sie Ihr **Unternehmen in HackTricks beworben sehen**? Oder m√∂chten Sie Zugang zur **neuesten Version des PEASS erhalten oder HackTricks als PDF herunterladen**? √úberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* **Treten Sie der** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie mir auf **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an das** [**hacktricks-Repository**](https://github.com/carlospolop/hacktricks) **und das** [**hacktricks-cloud-Repository**](https://github.com/carlospolop/hacktricks-cloud) **senden**.

</details>
