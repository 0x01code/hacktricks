# SOME - Same Origin Method Execution

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'ı takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) **karanlık ağ** destekli bir arama motorudur ve bir şirketin veya müşterilerinin **zarar görüp görmediğini** kontrol etmek için **ücretsiz** işlevler sunar.

WhiteIntel'in ana hedefi, bilgi çalan kötü amaçlı yazılımlardan kaynaklanan hesap ele geçirmeleri ve fidye yazılımı saldırılarıyla mücadele etmektir.

Web sitelerini kontrol edebilir ve motorlarını **ücretsiz** deneyebilirsiniz:

{% embed url="https://whiteintel.io" %}

***

## Same Origin Method Execution

Bir sayfada sınırlı javascript çalıştırabileceğiniz durumlar olacaktır. Örneğin, [**çalıştırılacak bir geri çağırma değerini kontrol edebildiğiniz**](./#javascript-function) durumlarda.

Bu durumlarda yapabileceğiniz en iyi şey, **orada bulabileceğiniz** hassas bir eylemi çağırmak için **DOM'a erişmek** olacaktır (örneğin bir düğmeye tıklamak). Ancak genellikle bu güvenlik açığını **ilginç bir şey olmayan küçük uç noktalar** içinde bulacaksınız.

Bu senaryolarda, bu saldırı çok faydalı olacaktır, çünkü amacı, **aynı alan adından farklı bir sayfa içindeki sınırlı JS yürütmesini kötüye kullanabilmektir** ve daha ilginç eylemler gerçekleştirmektir.

Temelde, saldırı akışı şu şekildedir:

* **kötüye kullanabileceğiniz bir geri çağırma bulun** (potansiyel olarak \[\w\\.\_] ile sınırlı).
* Eğer sınırlı değilse ve herhangi bir JS çalıştırabiliyorsanız, bunu normal bir XSS olarak kötüye kullanabilirsiniz.
* **kurbanı bir sayfa açmaya zorlayın** **saldırgan** tarafından kontrol edilen.
* **sayfa kendisini** **farklı bir pencerede** açacaktır (yeni pencere, başlangıçtaki nesne **`opener`** ile referans alacaktır).
* **ilk sayfa**, **ilginç DOM**'un bulunduğu **sayfayı** yükleyecektir.
* **ikinci sayfa**, **geri çağırmayı kötüye kullanarak** **kırılgan sayfayı** yükleyecek ve **ilk sayfadaki** bazı eylemleri **erişmek ve yürütmek için `opener` nesnesini** kullanacaktır (artık ilginç DOM'u içermektedir).

{% hint style="danger" %}
İlk sayfa, ikinci sayfayı oluşturduktan sonra yeni bir URL'ye erişse bile, **ikinci sayfanın `opener` nesnesi, yeni DOM'daki ilk sayfaya hala geçerli bir referanstır**.

Ayrıca, ikinci sayfanın opener nesnesini kullanabilmesi için **her iki sayfanın da aynı kökene sahip olması gerekir**. Bu, bu güvenlik açığını kötüye kullanmak için bazı türde bir **aynı köken XSS** bulmanız gerektiği anlamına gelir.
{% endhint %}

### Exploitation

* Bu tür bir güvenlik açığını istismar etmek için **bir PoC oluşturmak** için bu formu kullanabilirsiniz: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Bir HTML öğesine tıklamak için bir DOM yolu bulmak üzere bu tarayıcı uzantısını kullanabilirsiniz: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Örnek

* Kırılgan bir örneği [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/) adresinde bulabilirsiniz.
* Bu örnekte sunucunun **javascript kodu ürettiğini** ve **geri çağırma parametresinin içeriğine** dayanarak HTML'ye **eklediğini** unutmayın: `<script>opener.{callbacl_content}</script>` . Bu nedenle bu örnekte `opener` kullanımını açıkça belirtmenize gerek yoktur.
* Ayrıca bu CTF yazımını kontrol edin: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Referanslar

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)

{% hint style="success" %}
AWS Hacking öğrenin ve pratik yapın:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Eğitim AWS Kırmızı Takım Uzmanı (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
GCP Hacking öğrenin ve pratik yapın: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Eğitim GCP Kırmızı Takım Uzmanı (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks'i Destekleyin</summary>

* [**abonelik planlarını**](https://github.com/sponsors/carlospolop) kontrol edin!
* **💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın ya da **Twitter'da** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**'ı takip edin.**
* **Hacking ipuçlarını paylaşmak için** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR gönderin.

</details>
{% endhint %}
