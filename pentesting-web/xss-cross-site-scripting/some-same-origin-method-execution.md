# Ex√©cution de la m√©thode Same Origin (SOME)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert Red Team AWS HackTricks)</strong></a><strong>!</strong></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©**? Vous voulez voir votre **entreprise annonc√©e dans HackTricks**? ou voulez-vous avoir acc√®s √† la **derni√®re version du PEASS ou t√©l√©charger HackTricks en PDF**? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) est un moteur de recherche aliment√© par le **dark web** qui offre des fonctionnalit√©s **gratuites** pour v√©rifier si une entreprise ou ses clients ont √©t√© **compromis** par des **logiciels malveillants voleurs**.

Le but principal de WhiteIntel est de lutter contre les prises de contr√¥le de compte et les attaques de ransomware r√©sultant de logiciels malveillants volant des informations.

Vous pouvez consulter leur site Web et essayer leur moteur **gratuitement** sur :

{% embed url="https://whiteintel.io" %}

---

## Ex√©cution de la m√©thode Same Origin

Il y aura des occasions o√π vous _pouvez ex√©cuter un peu de javascript limit√© sur une page. Par exemple, dans le cas o√π vous pouvez [**contr√¥ler une valeur de rappel qui sera ex√©cut√©e**](./#javascript-function).

Dans ce cas, l'une des meilleures choses que vous pourriez faire est d'**acc√©der au DOM pour appeler n'importe quelle** action sensible que vous pouvez trouver (comme cliquer sur un bouton). Cependant, vous trouverez g√©n√©ralement cette vuln√©rabilit√© dans **de petits points de terminaison sans rien d'int√©ressant dans le DOM**.

Dans ces sc√©narios, cette attaque sera tr√®s utile, car son objectif est de pouvoir **abuser de l'ex√©cution JS limit√©e √† l'int√©rieur d'un DOM √† partir d'une page diff√©rente du m√™me domaine** avec des actions plus int√©ressantes.

Essentiellement, le flux de l'attaque est le suivant :

* Trouver un **rappel que vous pouvez abuser** (potentiellement limit√© √† \[\w\\.\_]).
* S'il n'est pas limit√© et que vous pouvez ex√©cuter n'importe quel JS, vous pourriez simplement abuser de cela comme un XSS r√©gulier.
* Faites **ouvrir une page** contr√¥l√©e par la **attaquant** √† la **victime**.
* La **page s'ouvrira** dans une **fen√™tre diff√©rente** (la nouvelle fen√™tre aura l'objet **`opener`** faisant r√©f√©rence √† la premi√®re).
* La **page initiale** chargera la **page** o√π se trouve le **DOM int√©ressant**.
* La **deuxi√®me page** chargera en **abusant du rappel de la page vuln√©r√©able** et en utilisant l'objet **`opener`** pour **acc√©der et ex√©cuter une action dans la page initiale** (qui contient maintenant le DOM int√©ressant).

{% hint style="danger" %}
Notez que m√™me si la page initiale acc√®de √† une nouvelle URL apr√®s avoir cr√©√© la deuxi√®me page, l'**objet `opener` de la deuxi√®me page reste une r√©f√©rence valide √† la premi√®re page dans le nouveau DOM**.

De plus, pour que la deuxi√®me page puisse utiliser l'objet opener, **les deux pages doivent √™tre dans la m√™me origine**. C'est la raison pour laquelle, pour abuser de cette vuln√©rabilit√©, vous devez trouver une sorte de **XSS dans la m√™me origine**.
{% endhint %}

### Exploitation

* Vous pouvez utiliser ce formulaire pour **g√©n√©rer un PoC** pour exploiter ce type de vuln√©rabilit√© : [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Pour trouver un chemin DOM vers un √©l√©ment HTML avec un clic, vous pouvez utiliser cette extension de navigateur : [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Exemple

* Vous pouvez trouver un exemple vuln√©rable sur [https://www.someattack.com/Playground/](https://www.someattack.com/Playground.
* Notez que dans cet exemple, le serveur **g√©n√®re du code javascript** et **l'ajoute** au HTML en fonction du **contenu du param√®tre de rappel:** `<script>opener.{callbacl_content}</script>` . C'est pourquoi dans cet exemple, vous n'avez pas besoin d'indiquer explicitement l'utilisation de `opener`.
* Consultez √©galement ce write-up CTF : [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## R√©f√©rences

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitb historians. Sm.

 is.





  of

  of  of  of  of  of  of  of  of                                                        of     .

 Pic                                    of  4. 5. 6. 7. 8. 9. 10. 11. 12. 13. 14. 15. 16. 17. 18. 19. 20. 21. 22. 23. 24. 25. 26. 27. 28. 29. 30. 31. 32. 33. 34. 35. 36. 37. 38. 39. 40. 41. 42. 43. 44. 45. 46. 47. 48. 49. 50. 51. 52. 53. 54. 55. 56. 57. 58. 59. 60. 61. 62. 63. 64. 65. 66. 67. 68. 69. 70. 71. 72. 73. 74. 75. 76. 77. 78. 79. 80. 81. 82. 83. 84. 85. 86. 87. 88. 89. 90. 91. 92. 93. 94. 95. 96. 97. 98. 99. 100. 101. 102. 103. 104. 105. 106. 107. 108. 109. 110. 111. 112. 113. 114. 115. 116. 117. 118. 119. 120.  121. 122. 123. 124. 125. 126. 127. 128. 129. 130. 131. 132. 133. 134. 135. 136. 137. 138. 139. 140.

### Ex√©cution de la m√©thode Same Origin

Il y aura des occasions o√π vous _pouvez ex√©cuter un peu de javascript limit√© sur une page. Par exemple, dans le cas o√π vous pouvez [**contr√¥ler une valeur de rappel qui sera ex√©cut√©e**](./#javascript-function).

Dans ce cas, l'une des meilleures choses que vous pourriez faire est d'**acc√©der au DOM pour appeler n'importe quelle** action sensible que vous pouvez trouver (comme cliquer sur un bouton). Cependant, vous trouverez g√©n√©ralement cette vuln√©rabilit√© dans **de petits points de terminaison sans rien d'int√©ressant dans le DOM**.

Dans ces sc√©narios, cette attaque sera tr√®s utile, car son objectif est de pouvoir **abuser *abuser de l'ex√©cution JS limit√©e √† l'int√©rieur d'un DOM √† partir d'une page diff√©rente du m√™me domaine** avec des actions plus int√©ressantes.

Essentiellement, le flux de l'attaque est le suivant :

* Trouver un **rappel que vous pouvez abuser** (potentiellement limit√© √† \[\w\\.\_]).
* S'il n'est pas limit√© et que vous pouvez ex√©cuter n'importe quel JS, vous pourriez simplement abuser de cela comme un XSS r√©gulier.
* Faites **ouvrir une page** contr√¥l√©e par la **attaquant** √† la **victime**.
* La **page s'ouvrira** dans une **fen√™tre diff√©rente** (la nouvelle fen√™tre aura l'objet **`opener`** faisant r√©f√©rence √† la premi√®re).
* La **page initiale** chargera la **page** o√π se trouve le **DOM int√©ressant**.
* La **deuxi√®me page** chargera en **abusant du rappel de la page vuln√©rable** et en utilisant l'objet **`opener`** pour **acc√©der et ex√©cuter une action dans la page initiale** (qui contient maintenant le DOM int√©ressant).

{% hint style="danger" %}
Notez que m√™me si la page initiale acc√®de √† une nouvelle URL apr√®s avoir cr√©√© la deuxi√®me page, l'**objet `opener` de la deuxi√®me page reste une r√©f√©rence valide √† la premi√®re page dans le nouveau DOM**.

De plus, pour que la deuxi√®me page puisse utiliser l'objet opener, **les deux pages doivent √™tre dans la m√™me origine**. C'est la raison pour laquelle, pour abuser de cette vuln√©rabilit√©, vous devez trouver une sorte de **XSS dans la m√™me origine**.
{% endhint %}

### Exploitation

* Vous pouvez utiliser ce formulaire pour **g√©n√©rer un PoC** pour exploiter ce type de vuln√©rabilit√© : [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Pour trouver un chemin DOM vers un √©l√©ment HTML avec un clic, vous pouvez utiliser cette extension de navigateur : [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Exemple

* Vous pouvez trouver un exemple vuln√©rable sur [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/).
* Notez que dans cet exemple, le serveur **g√©n√®re du code javascript** et **l'ajoute** au HTML en fonction du **contenu du param√®tre de rappel:** `<script>opener.{callbacl_content}</script>` . C'est pourquoi dans cet exemple, vous n'avez pas besoin d'indiquer explicitement l'utilisation de `opener`.
* Consultez √©galement ce write-up CTF : [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## R√©f√©rences

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)
