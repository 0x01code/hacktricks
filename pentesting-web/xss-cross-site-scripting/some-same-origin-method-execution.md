# SOME - Esecuzione del Metodo Same Origin

<details>

<summary><strong>Impara l'hacking AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

* Lavori in una **azienda di sicurezza informatica**? Vuoi vedere la tua **azienda pubblicizzata su HackTricks**? o vuoi avere accesso all'**ultima versione del PEASS o scaricare HackTricks in PDF**? Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* **Unisciti al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguimi** su **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR al** [**repo di hacktricks**](https://github.com/carlospolop/hacktricks) **e al** [**repo di hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) √® un motore di ricerca alimentato dal **dark web** che offre funzionalit√† **gratuite** per verificare se un'azienda o i suoi clienti sono stati **compromessi** da **malware ruba-informazioni**.

Il loro obiettivo principale √® contrastare i takeover di account e gli attacchi ransomware derivanti da malware che rubano informazioni.

Puoi controllare il loro sito web e provare il loro motore **gratuitamente** su:

{% embed url="https://whiteintel.io" %}

***

## Esecuzione del Metodo Same Origin

Ci saranno occasioni in cui potrai eseguire un po' di javascript limitato in una pagina. Ad esempio, nel caso in cui puoi [**controllare un valore di callback che verr√† eseguito**](./#javascript-function).

In quei casi, una delle migliori cose che potresti fare √® **accedere al DOM per chiamare qualsiasi** azione sensibile che puoi trovare l√¨ dentro (come cliccare su un pulsante). Tuttavia, di solito troverai questa vulnerabilit√† in **piccoli endpoint senza nulla di interessante nel DOM**.

In quegli scenari, questo attacco sar√† molto utile, perch√© il suo obiettivo √® quello di poter **abusare dell'esecuzione JS limitata all'interno di un DOM da una pagina diversa dello stesso dominio** con molte azioni interessanti.

Fondamentalmente, il flusso dell'attacco √® il seguente:

* Trova un **callback che puoi abusare** (potenzialmente limitato a \[\w\\.\_]).
* Se non √® limitato e puoi eseguire qualsiasi JS, potresti semplicemente abusare di questo come un XSS regolare
* Fai aprire una pagina al **vittima** controllata dall'**attaccante**
* La **pagina si aprir√† da sola** in una **finestra diversa** (la nuova finestra avr√† l'oggetto **`opener`** che fa riferimento a quella iniziale)
* La **pagina iniziale** caricher√† la **pagina** dove si trova il **DOM interessante**.
* La **seconda pagina** caricher√† la **pagina vulnerabile abusando del callback** e utilizzando l'oggetto **`opener`** per **accedere ed eseguire un'azione nella pagina iniziale** (che ora contiene il DOM interessante).

{% hint style="danger" %}
Nota che anche se la pagina iniziale accede a un nuovo URL dopo aver creato la seconda pagina, l'**oggetto `opener` della seconda pagina √® ancora un riferimento valido alla prima pagina nel nuovo DOM**.

Inoltre, affinch√© la seconda pagina possa utilizzare l'oggetto opener **entrambe le pagine devono essere dello stesso dominio**. Questo √® il motivo per cui, per abusare di questa vulnerabilit√†, √® necessario trovare una sorta di **XSS nello stesso dominio**.
{% endhint %}

### Sfruttamento

* Puoi utilizzare questo modulo per **generare un PoC** per sfruttare questo tipo di vulnerabilit√†: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Per trovare un percorso DOM verso un elemento HTML con un clic puoi utilizzare questa estensione del browser: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Esempio

* Puoi trovare un esempio vulnerabile in [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/)
* Nota che in questo esempio il server **genera codice javascript** e lo **aggiunge** all'HTML in base al **contenuto del parametro di callback:** `<script>opener.{callbacl_content}</script>` . Per questo motivo in questo esempio non √® necessario indicare esplicitamente l'uso di `opener`.
* Controlla anche questo CTF writeup: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Riferimenti

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/) 

<details>

<summary><strong>Impara l'hacking AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

* Lavori in una **azienda di sicurezza informatica**? Vuoi vedere la tua **azienda pubblicizzata su HackTricks**? o vuoi avere accesso all'**ultima versione del PEASS o scaricare HackTricks in PDF**? Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* **Unisciti al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguimi** su **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR al** [**repo di hacktricks**](https://github.com/carlospolop/hacktricks) **e al** [**repo di hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
