# SOME - Same Origin Method Execution

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Arbeiten Sie in einem **Cybersicherheitsunternehmen**? M√∂chten Sie Ihr **Unternehmen in HackTricks bewerben**? Oder m√∂chten Sie Zugriff auf die **neueste Version des PEASS erhalten oder HackTricks als PDF herunterladen**? √úberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* **Treten Sie der** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie mir auf **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an das** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **und das** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **senden**.

</details>

## Same Origin Method Execution

Es wird Situationen geben, in denen Sie etwas begrenztes JavaScript auf einer Seite ausf√ºhren k√∂nnen. Zum Beispiel, wenn Sie einen **Callback-Wert kontrollieren k√∂nnen, der ausgef√ºhrt wird**.

In solchen F√§llen ist eine der besten Dinge, die Sie tun k√∂nnen, den **DOM zu √∂ffnen, um eine beliebige** sensible Aktion auszuf√ºhren, die Sie darin finden k√∂nnen (wie das Klicken auf eine Schaltfl√§che). In der Regel finden Sie jedoch diese Schwachstelle in **kleinen Endpunkten ohne interessante Dinge im DOM**.

In solchen Szenarien ist dieser Angriff sehr n√ºtzlich, da sein Ziel darin besteht, die **begrenzte JS-Ausf√ºhrung innerhalb eines DOMs von einer anderen Seite derselben Domain** mit viel interessanteren Aktionen zu missbrauchen.

Grunds√§tzlich sieht der Angriffsablauf wie folgt aus:

* Finden Sie einen **Callback, den Sie missbrauchen k√∂nnen** (potenziell auf \[\w\\.\_] beschr√§nkt).
* Wenn er nicht begrenzt ist und Sie beliebiges JS ausf√ºhren k√∂nnen, k√∂nnen Sie dies einfach als regul√§res XSS missbrauchen.
* Lassen Sie das **Opfer eine Seite** √∂ffnen, die vom **Angreifer kontrolliert wird**.
* Die **Seite wird sich selbst in einem anderen Fenster √∂ffnen** (das neue Fenster wird das Objekt **`opener`** auf die urspr√ºngliche Seite verweisen).
* Die **urspr√ºngliche Seite** l√§dt die **Seite**, auf der sich der **interessante DOM** befindet.
* Die **zweite Seite** l√§dt die **verwundbare Seite, indem sie den Callback missbraucht** und das Objekt **`opener`** verwendet, um eine Aktion in der urspr√ºnglichen Seite auszuf√ºhren (die jetzt den interessanten DOM enth√§lt).

{% hint style="danger" %}
Beachten Sie, dass selbst wenn die urspr√ºngliche Seite nach dem Erstellen der zweiten Seite auf eine neue URL zugreift, das **`opener`-Objekt der zweiten Seite immer noch eine g√ºltige Referenz auf die erste Seite im neuen DOM** ist.

Dar√ºber hinaus m√ºssen sich beide Seiten in derselben Herkunft befinden, damit die zweite Seite das Opener-Objekt verwenden kann. Aus diesem Grund m√ºssen Sie, um diese Schwachstelle auszunutzen, eine Art **XSS in derselben Herkunft** finden.
{% endhint %}

### Ausnutzung

* Sie k√∂nnen dieses Formular verwenden, um **einen PoC zu generieren**, um diese Art von Schwachstelle auszunutzen: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Um einen DOM-Pfad zu einem HTML-Element mit einem Klick zu finden, k√∂nnen Sie diese Browser-Erweiterung verwenden: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Beispiel

* Sie finden ein anf√§lliges Beispiel unter [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/)
* Beachten Sie, dass in diesem Beispiel der Server **JavaScript-Code generiert** und ihn auf der Grundlage des **Inhalts des Callback-Parameters** zum HTML hinzuf√ºgt: `<script>opener.{callbacl_content}</script>`. Aus diesem Grund m√ºssen Sie in diesem Beispiel nicht explizit die Verwendung von `opener` angeben.
* √úberpr√ºfen Sie auch diese CTF-Write-up: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Referenzen

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Arbeiten Sie in einem **Cybersicherheitsunternehmen**? M√∂chten Sie Ihr **Unternehmen in HackTricks bewerben**? Oder m√∂chten Sie Zugriff auf die **neueste Version des PEASS erhalten oder HackTricks als PDF herunterladen**? √úberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* **Treten Sie der** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie mir auf **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an das** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **und das** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **senden**.

</details>
