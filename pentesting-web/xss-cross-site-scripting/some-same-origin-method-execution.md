# SOME - Same Origin Method Execution

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) √© um mecanismo de busca alimentado pela **dark web** que oferece funcionalidades **gratuitas** para verificar se uma empresa ou seus clientes foram **comprometidos** por **malwares de roubo**.

O principal objetivo do WhiteIntel √© combater tomadas de conta de contas e ataques de ransomware resultantes de malwares de roubo de informa√ß√µes.

Voc√™ pode verificar o site deles e experimentar o mecanismo gratuitamente em:

{% embed url="https://whiteintel.io" %}

---

## Same Origin Method Execution

Haver√° ocasi√µes em que voc√™ pode executar algum javascript limitado em uma p√°gina. Por exemplo, no caso em que voc√™ pode [**controlar um valor de retorno que ser√° executado**](./#javascript-function).

Nesses casos, uma das melhores coisas que voc√™ poderia fazer √© **acessar o DOM para chamar qualquer** a√ß√£o sens√≠vel que voc√™ possa encontrar l√° (como clicar em um bot√£o). No entanto, geralmente voc√™ encontrar√° essa vulnerabilidade em **pequenos pontos de extremidade sem nada interessante no DOM**.

Nesses cen√°rios, esse ataque ser√° muito √∫til, porque seu objetivo √© ser capaz de **abusar da execu√ß√£o limitada de JS dentro de um DOM de uma p√°gina diferente do mesmo dom√≠nio** com a√ß√µes muito interessantes.

Basicamente, o fluxo do ataque √© o seguinte:

* Encontre um **callback que voc√™ pode abusar** (potencialmente limitado a \[\w\\.\_]).
* Se n√£o for limitado e voc√™ puder executar qualquer JS, voc√™ poderia simplesmente abusar disso como um XSS regular.
* Fa√ßa a **v√≠tima abrir uma p√°gina** controlada pelo **atacante**.
* A **p√°gina se abrir√°** em uma **janela diferente** (a nova janela ter√° o objeto **`opener`** referenciando a inicial).
* A **p√°gina inicial** carregar√° a **p√°gina** onde est√° localizado o **DOM interessante**.
* A **segunda p√°gina** carregar√° a **p√°gina vulner√°vel abusando do callback** e usando o objeto **`opener`** para **acessar e executar alguma a√ß√£o na p√°gina inicial** (que agora cont√©m o DOM interessante).

{% hint style="danger" %}
Observe que mesmo que a p√°gina inicial acesse uma nova URL ap√≥s ter criado a segunda p√°gina, o **objeto `opener` da segunda p√°gina ainda √© uma refer√™ncia v√°lida para a primeira p√°gina no novo DOM**.

Al√©m disso, para que a segunda p√°gina possa usar o objeto opener **ambas as p√°ginas devem estar na mesma origem**. Esta √© a raz√£o pela qual, para abusar dessa vulnerabilidade, voc√™ precisa encontrar algum tipo de **XSS na mesma origem**.
{% endhint %}

### Explora√ß√£o

* Voc√™ pode usar este formul√°rio para **gerar um PoC** para explorar esse tipo de vulnerabilidade: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Para encontrar um caminho DOM para um elemento HTML com um clique, voc√™ pode usar esta extens√£o do navegador: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Exemplo

* Voc√™ pode encontrar um exemplo vulner√°vel em [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/)
* Observe que neste exemplo o servidor est√° **gerando c√≥digo javascript** e **adicionando** ao HTML com base no **conte√∫do do par√¢metro de callback:** `<script>opener.{callbacl_content}</script>` . Por isso, neste exemplo voc√™ n√£o precisa indicar o uso de `opener` explicitamente.
* Confira tamb√©m este CTF writeup: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Refer√™ncias

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/) 

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
