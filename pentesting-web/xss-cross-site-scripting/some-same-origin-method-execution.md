# SOME - Aynı Kök Yöntem İcra

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana dönüşün</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>ile öğrenin!</strong></summary>

* Bir **cybersecurity şirketinde** çalışıyor musunuz? **Şirketinizi HackTricks'te reklamını görmek** ister misiniz? veya **PEASS'ın en son sürümüne erişmek veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT koleksiyonumuz**](https://opensea.io/collection/the-peass-family)
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter**'da takip edin 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Hacking hilelerinizi** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ve** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **göndererek paylaşın**.

</details>

## Aynı Kök Yöntem İcra

Bazı durumlarda, bir sayfada sınırlı bir javascript kodunu çalıştırabilirsiniz. Örneğin, **çalıştırılacak bir geri çağırma değerini kontrol edebildiğiniz** durumlarda.

Bu durumlarda, yapabileceğiniz en iyi şeylerden biri, DOM'a erişerek orada bulabileceğiniz hassas bir işlemi (örneğin bir düğmeye tıklama) çağırmaktır. Ancak genellikle DOM'da ilginç bir şey olmayan **küçük uç noktalarda** bu zafiyeti bulacaksınız.

Bu senaryolarda, bu saldırı çok faydalı olacaktır, çünkü amacı, **aynı kökten farklı bir sayfadan DOM içindeki sınırlı JS yürütmesini istismar etmek** ve daha ilginç işlemler yapmaktır.

Temel olarak, saldırı akışı aşağıdaki gibidir:

* **Kötü niyetli** tarafından kontrol edilen bir sayfayı **kurbanın açmasını sağlayın**
* **Sayfa kendini** bir **farklı pencerede** açacak (yeni pencere, başlangıçtaki pencereye referans olan **`opener`** nesnesine sahip olacak)
* **Başlangıç sayfası**, **ilginç DOM**'un bulunduğu **sayfayı** yükleyecek.
* **İkinci sayfa**, **geri çağırma**yı istismar eden ve **`opener`** nesnesini kullanarak **başlangıç sayfasında bazı işlemleri erişip yürüten** **zafiyetli sayfayı** yükleyecektir (şimdi ilginç DOM'u içeren).

{% hint style="danger" %}
İlk sayfa, ikinci sayfa oluşturulduktan sonra yeni bir URL'ye erişse bile, **ikinci sayfanın `opener` nesnesi hala yeni DOM'daki ilk sayfaya geçerli bir referanstır**.

Ayrıca, ikinci sayfanın opener nesnesini kullanabilmesi için **her iki sayfanın aynı kökte olması gerekir**. Bu nedenle, bu zafiyeti istismar etmek için bir tür **aynı kökten XSS** bulmanız gerekmektedir.
{% endhint %}

### Sömürü

* Bu tür bir zafiyeti istismar etmek için bir PoC oluşturmak için bu formu kullanabilirsiniz: [https://www.someattack.com/Playground/SOMEGenerator](https://www.someattack.com/Playground/SOMEGenerator)
* Bir HTML öğesine tıklama ile bir DOM yolunu bulmak için bu tarayıcı eklentisini kullanabilirsiniz: [https://www.someattack.com/Playground/targeting\_tool](https://www.someattack.com/Playground/targeting\_tool)

### Örnek

* [https://www.someattack.com/Playground/](https://www.someattack.com/Playground/) adresinde zafiyetli bir örnek bulabilirsiniz.
* Bu örnekte sunucu, **geri çağırma parametresinin içeriğine** dayanarak **javascript kodu oluşturuyor** ve **HTML'ye ekliyor:** `<script>opener.{callbacl_content}</script>`. Bu nedenle, bu örnekte `opener`'ın kullanımını açıkça belirtmenize gerek yoktur.
* Ayrıca bu CTF çözümünü kontrol edin: [https://ctftime.org/writeup/36068](https://ctftime.org/writeup/36068)

## Referanslar

* [https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/](https://conference.hitb.org/hitbsecconf2017ams/sessions/everybody-wants-some-advance-same-origin-method-execution/)

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana dönüşün</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>ile öğrenin!</strong></summary>

* Bir **cybersecurity şirketinde** çalışıyor musunuz? **Şirketinizi HackTricks'te reklamını görmek** ister misiniz? veya **PEASS'ın en son sürümüne erişmek veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT koleksiyonumuz**](https://opensea.io/collection/the-peass-family)
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter**'da takip edin 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Hacking hilelerinizi** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ve** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **göndererek paylaşın**.

</details>
