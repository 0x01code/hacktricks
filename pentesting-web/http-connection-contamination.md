# HTTP 연결 오염

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)을 **팔로우**하세요.
* **HackTricks**와 **HackTricks Cloud** github 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>

**이 글은 [https://portswigger.net/research/http-3-connection-contamination](https://portswigger.net/research/http-3-connection-contamination)의 요약입니다. 자세한 내용은 해당 글을 확인하세요!**

웹 브라우저는 공유 IP 주소와 공통 TLS 인증서를 통해 HTTP/2+ 연결을 통해 다른 웹 사이트에 대해 단일 연결을 재사용할 수 있습니다. 그러나 이는 역방향 프록시에서의 **첫 번째 요청 라우팅**과 충돌할 수 있습니다. 여기서 후속 요청은 첫 번째 요청에 의해 결정된 백엔드로 전달됩니다. 이러한 잘못된 라우팅은 와일드카드 TLS 인증서와 `*.example.com`과 같은 도메인과 결합될 때 보안 취약점을 유발할 수 있습니다.

예를 들어, `wordpress.example.com`과 `secure.example.com`이 동일한 역방향 프록시에서 제공되고 공통 와일드카드 인증서를 가지고 있다면, 브라우저의 연결 재사용은 `secure.example.com`으로의 요청이 잘못된 처리로 WordPress 백엔드에 의해 처리되어 XSS와 같은 취약점을 악용할 수 있습니다.

연결 재사용을 관찰하기 위해 Chrome의 네트워크 탭이나 Wireshark와 같은 도구를 사용할 수 있습니다. 테스트를 위한 스니펫은 다음과 같습니다:
```javascript
fetch('//sub1.hackxor.net/', {mode: 'no-cors', credentials: 'include'}).then(()=>{ fetch('//sub2.hackxor.net/', {mode: 'no-cors', credentials: 'include'}) })
```
현재 위협은 첫 번째 요청 라우팅의 희귀성과 HTTP/2의 복잡성으로 인해 제한되고 있습니다. 그러나 HTTP/3에서 제안된 변경 사항은 IP 주소 일치 요구 사항을 완화하여 MITM 공격 없이도 와일드카드 인증서를 사용하는 서버를 보다 취약하게 만들 수 있으므로 공격 표면이 확대될 수 있습니다.

최선의 방법은 역방향 프록시에서 첫 번째 요청 라우팅을 피하고, 특히 HTTP/3의 도래와 함께 와일드카드 TLS 인증서에 주의하는 것입니다. 이러한 복잡하고 상호 연결된 취약점에 대한 정기적인 테스트와 인식은 웹 보안을 유지하는 데 중요합니다.

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요!</summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 구매하세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **HackTricks**와 **HackTricks Cloud** github 저장소에 PR을 제출하여 여러분의 해킹 기법을 공유하세요.

</details>
