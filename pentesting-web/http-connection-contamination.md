# Contamina√ß√£o da Conex√£o HTTP

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

**Este √© um resumo do post: [https://portswigger.net/research/http-3-connection-contamination](https://portswigger.net/research/http-3-connection-contamination)**. Verifique para mais detalhes!

Navegadores da web podem reutilizar uma √∫nica conex√£o HTTP/2+ para diferentes sites por meio da [coalesc√™ncia de conex√£o HTTP](https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing), desde que compartilhem endere√ßos IP e um certificado TLS comum. No entanto, isso pode entrar em conflito com o **roteamento de primeira solicita√ß√£o** em proxies reversos, onde solicita√ß√µes subsequentes s√£o direcionadas ao back-end determinado pela primeira solicita√ß√£o. Esse encaminhamento incorreto pode levar a vulnerabilidades de seguran√ßa, especialmente quando combinado com certificados TLS curinga e dom√≠nios como `*.example.com`.

Por exemplo, se `wordpress.example.com` e `secure.example.com` forem ambos servidos pelo mesmo proxy reverso e tiverem um certificado curinga comum, a coalesc√™ncia de conex√£o do navegador poderia fazer com que as solicita√ß√µes para `secure.example.com` fossem processadas incorretamente pelo back-end do WordPress, explorando vulnerabilidades como XSS.

Para observar a coalesc√™ncia de conex√£o, pode-se usar a guia de Rede do Chrome ou ferramentas como o Wireshark. Aqui est√° um trecho para teste:
```javascript
fetch('//sub1.hackxor.net/', {mode: 'no-cors', credentials: 'include'}).then(()=>{ fetch('//sub2.hackxor.net/', {mode: 'no-cors', credentials: 'include'}) })
```
A amea√ßa est√° atualmente limitada devido √† raridade do roteamento do primeiro pedido e √† complexidade do HTTP/2. No entanto, as mudan√ßas propostas no HTTP/3, que relaxam o requisito de correspond√™ncia de endere√ßo IP, poderiam ampliar a superf√≠cie de ataque, tornando os servidores com um certificado curinga mais vulner√°veis sem a necessidade de um ataque MITM.

As melhores pr√°ticas incluem evitar o roteamento do primeiro pedido em proxies reversos e ter cautela com certificados TLS curinga, especialmente com o advento do HTTP/3. Testes regulares e consci√™ncia dessas vulnerabilidades complexas e interconectadas s√£o cruciais para manter a seguran√ßa na web.

<details>

<summary><strong>Aprenda hacking na AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
