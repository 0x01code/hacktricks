# HTTP Connection Request Smuggling

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХреЛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛рдП? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рдкреАрдбреАрдПрдл рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* [**рдж рдкреАрдПрд╕ рдлреИрдорд┐рд▓реА**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**рдПрдирдПрдлрдЯреА**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдкреАрдПрд╕ рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ**ред

</details>

**рдпрд╣ рдкреЛрд╕реНрдЯ [https://portswigger.net/research/browser-powered-desync-attacks](https://portswigger.net/research/browser-powered-desync-attacks) рдХрд╛ рд╕рд╛рд░рд╛рдВрд╢ рд╣реИ**

## Connection State Attacks <a href="#state" id="state"></a>

### рдкрд╣рд▓реА-рдЕрдиреБрд░реЛрдз рдорд╛рдиреНрдпрддрд╛

рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЛ рд░реВрдЯ рдХрд░рддреЗ рд╕рдордп, рдЧрд▓рддреА рд╕реЗ рдХреБрдЫ рдкреНрд░реЙрдХреНрд╕реА рдореЗрдВ **рд╣реЛрд╕реНрдЯ рд╣реЗрдбрд░** рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рдкрд┐рдЫрд▓реЗ-рдПрдВрдб рд╕рд░реНрд╡рд░ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░ рд╕рдХреЗрдВ, рдЕрдХреНрд╕рд░ рдЙрдиреНрд╣реЗрдВ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╣реЛрд╕реНрдЯ рдХреА рд╕рдлреЗрдж рд╕реВрдЪреА рдкрд░ рдирд┐рд░реНрднрд░ рд╣реЛрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреБрдЫ рдкреНрд░реЙрдХреНрд╕реА рдореЗрдВ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЧрдбрд╝рдмрдбрд╝реА рд╣реЛрддреА рд╣реИ рдЬрд╣рд╛рдВ рд╕рдлреЗрдж рд╕реВрдЪреА рдХреЗрд╡рд▓ рдХрдиреЗрдХреНрд╢рди рдореЗрдВ рдкрд╣рд▓реЗ рдЕрдиреБрд░реЛрдз рдкрд░ рд╣реА рд▓рд╛рдЧреВ рд╣реЛрддреА рд╣реИред рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕реЗ рдЗрд╕ рддрд░рд╣ рд╕реЗ рд╢рд╛рд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдкрд╣рд▓реЗ рдХрд┐рд╕реА рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рд╣реЛрд╕реНрдЯ рдХреЛ рдЕрдиреБрд░реЛрдз рдХрд░рдХреЗ рдФрд░ рдлрд┐рд░ рдЙрд╕реА рдХрдиреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдВрддрд░рд┐рдХ рд╕рд╛рдЗрдЯ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рдХреЗ рдЗрд╕рдХрд╛ рд╢рд╛рд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```text
GET / HTTP/1.1
Host: [allowed-external-host]

GET / HTTP/1.1
Host: [internal-host]
```
### рдкрд╣рд▓реА рдЕрдиреБрд░реЛрдз рдорд╛рд░реНрдЧрдирд┐рд░реНрдзрд╛рд░рдг

рдХреБрдЫ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ, рдПрдХ рдлреНрд░рдВрдЯ-рдПрдВрдб рд╕рд░реНрд╡рд░ **рдкрд╣рд▓реЗ рдЕрдиреБрд░реЛрдз рдХреЗ рд╣реЛрд╕реНрдЯ рд╣реЗрдбрд░** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЙрд╕ рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рдкрд┐рдЫрд▓реЗ-рдПрдВрдб рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдорд╛рд░реНрдЧрдирд┐рд░реНрдзрд╛рд░рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдФрд░ рдлрд┐рд░ рд╕рднреА рдЖрдЧрд╛рдореА рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдЙрд╕реА рдкрд┐рдЫрд▓реЗ-рдПрдВрдб рдХрдиреЗрдХреНрд╢рди рдкрд░ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдорд╛рд░реНрдЧрд┐рдХреГрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕реЗ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```text
GET / HTTP/1.1
Host: example.com

POST /pwreset HTTP/1.1
Host: psres.net
```
рдпрд╣ рд╕рдорд╕реНрдпрд╛ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ [рд╣реЛрд╕реНрдЯ рд╣реЗрдбрд░ рд╣рдорд▓реЛрдВ](https://portswigger.net/web-security/host-header) рдХреЗ рд╕рд╛рде рдХрдВрдмрд╛рдЗрди рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдЬреИрд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдкреЙрдЗрдЬрдирд┐рдВрдЧ рдпрд╛ [рд╡реЗрдм рдХреИрд╢ рдкреЙрдЗрдЬрдирд┐рдВрдЧ](https://portswigger.net/web-security/web-cache-poisoning), рдЕрдиреНрдп рд╡рдВрд╢рд╛рдЬ рдпрд╛ рдЕрддрд┐рд╕рдВрджреЗрд╣рд┐рдд рдкрд╣реБрдВрдЪ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╛ рдЕрддрд┐рд░рд┐рдХреНрдд рд╡рд░реНрдЪреБрдЕрд▓ рд╣реЛрд╕реНрдЯреНрд╕ рддрдХ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

{% hint style="info" %}
рдЗрди рд╡рдВрд╢рд╛рдЬреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП, HTTP рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рд╕реНрдордЧреНрд▓рд░ рдореЗрдВ 'рдХрдиреЗрдХреНрд╢рди-рд╕реНрдЯреЗрдЯ рдкреНрд░реЛрдм' рдлреАрдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}
