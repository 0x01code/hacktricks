# Unicode Injection

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories senden.

</details>

## Einf√ºhrung

Je nachdem, wie sich das Back-End/Front-End verh√§lt, wenn es **seltsame Unicode-Zeichen empf√§ngt**, kann ein Angreifer m√∂glicherweise **Schutzma√ünahmen umgehen und beliebige Zeichen einschleusen**, die zur **Ausnutzung von Injektionsl√ºcken** wie XSS oder SQLi verwendet werden k√∂nnten.

## Unicode-Normalisierung

Die Unicode-Normalisierung tritt auf, wenn **Unicode-Zeichen in ASCII-Zeichen normalisiert werden**.

Ein h√§ufiges Szenario dieser Art von Schwachstelle tritt auf, wenn das System die **Eingabe** des Benutzers **nach der √úberpr√ºfung** auf irgendeine Weise **modifiziert**. Zum Beispiel k√∂nnte in einigen Sprachen ein einfacher Aufruf zum **√Ñndern der Eingabe in Gro√ü- oder Kleinschreibung** die gegebene Eingabe normalisieren und das **Unicode in ASCII umwandeln**, wodurch neue Zeichen generiert werden.\
Weitere Informationen finden Sie unter:

{% content-ref url="unicode-normalization.md" %}
[unicode-normalization.md](unicode-normalization.md)
{% endcontent-ref %}

## `\u` zu `%`

Unicode-Zeichen werden normalerweise mit dem **Pr√§fix `\u`** dargestellt. Zum Beispiel ist das Zeichen `„±ã` `\u3c4b` ([hier √ºberpr√ºfen](https://unicode-explorer.com/c/3c4B)). Wenn ein Backend das Pr√§fix **`\u` in `%` umwandelt**, wird der resultierende String `%3c4b` sein, der URL-decodiert **`<4b`** ist. Und, wie Sie sehen k√∂nnen, wird ein **`<`-Zeichen eingeschleust**.\
Sie k√∂nnen diese Technik verwenden, um **beliebige Zeichen einzuschleusen**, wenn das Backend anf√§llig ist.\
√úberpr√ºfen Sie [https://unicode-explorer.com/](https://unicode-explorer.com/), um die ben√∂tigten Zeichen zu finden.

Diese Schwachstelle stammt tats√§chlich von einer Schwachstelle, die ein Forscher gefunden hat. F√ºr eine detailliertere Erkl√§rung siehe [https://www.youtube.com/watch?v=aUsAHb0E7Cg](https://www.youtube.com/watch?v=aUsAHb0E7Cg)

## Emoji-Injektion

Back-Ends verhalten sich manchmal seltsam, wenn sie **Emojis empfangen**. Das ist in [**diesem Write-up**](https://medium.com/@fpatrik/how-i-found-an-xss-vulnerability-via-using-emojis-7ad72de49209) passiert, wo es dem Forscher gelungen ist, XSS mit einer Payload wie `üíãimg src=x onerror=alert(document.domain)//üíõ` zu erreichen.

In diesem Fall lag der Fehler darin, dass der Server nach Entfernen der b√∂sartigen Zeichen die UTF-8-Zeichenfolge von Windows-1252 in UTF-8 **konvertiert hat** (im Grunde genommen stimmten die Eingabe-Codierung und die Konvertierungscodierung nicht √ºberein). Dann wird kein ordnungsgem√§√ües <, sondern ein seltsames Unicode-Zeichen erzeugt: `‚Äπ`\
``Dann haben sie diese Ausgabe genommen und **noch einmal von UTF-8 in ASCII konvertiert**. Dadurch wurde das `‚Äπ` in `<` normalisiert, und so konnte der Exploit auf diesem System funktionieren.\
Das ist passiert:
```php
<?php

$str = isset($_GET["str"]) ? htmlspecialchars($_GET["str"]) : "";

$str = iconv("Windows-1252", "UTF-8", $str);
$str = iconv("UTF-8", "ASCII//TRANSLIT", $str);

echo "String: " . $str;
```
Emoji-Listen:

* [https://github.com/iorch/jakaton\_feminicidios/blob/master/data/emojis.csv](https://github.com/iorch/jakaton\_feminicidios/blob/master/data/emojis.csv)
* [https://unicode.org/emoji/charts-14.0/full-emoji-list.html](https://unicode.org/emoji/charts-14.0/full-emoji-list.html)

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) **bei oder folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) **und** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **GitHub-Repositories senden.**

</details>
