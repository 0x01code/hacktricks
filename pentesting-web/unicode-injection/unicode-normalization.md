# Unicode Normalization

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) is a **dark-web** fueled search engine that offers **free** functionalities to check if a company or its customers have been **compromised** by **stealer malwares**.

Their primary goal of WhiteIntel is to combat account takeovers and ransomware attacks resulting from information-stealing malware.

You can check their website and try their engine for **free** at:

{% embed url="https://whiteintel.io" %}

***

**This is a summary of:** [**https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/**](https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/). Check a look for further details (images taken form there).

## Understanding Unicode and Normalization

Unicode normalization is a process that ensures different binary representations of characters are standardized to the same binary value. This process is crucial in dealing with strings in programming and data processing. The Unicode standard defines two types of character equivalence:

1. **Canonical Equivalence**: Characters are considered canonically equivalent if they have the same appearance and meaning when printed or displayed.
2. **Compatibility Equivalence**: A weaker form of equivalence where characters may represent the same abstract character but can be displayed differently.

There are **four Unicode normalization algorithms**: NFC, NFD, NFKC, and NFKD. Each algorithm employs canonical and compatibility normalization techniques differently. For a more in-depth understanding, you can explore these techniques on [Unicode.org](https://unicode.org/).

### Key Points on Unicode Encoding

Understanding Unicode encoding is pivotal, especially when dealing with interoperability issues among different systems or languages. Here are the main points:

* **Code Points and Characters**: In Unicode, each character or symbol is assigned a numerical value known as a "code point".
* **Bytes Representation**: The code point (or character) is represented by one or more bytes in memory. For instance, LATIN-1 characters (common in English-speaking countries) are represented using one byte. However, languages with a larger set of characters need more bytes for representation.
* **Encoding**: This term refers to how characters are transformed into a series of bytes. UTF-8 is a prevalent encoding standard where ASCII characters are represented using one byte, and up to four bytes for other characters.
* **Processing Data**: Systems processing data must be aware of the encoding used to correctly convert the byte stream into characters.
* **Variants of UTF**: Besides UTF-8, there are other encoding standards like UTF-16 (using a minimum of 2 bytes, up to 4) and UTF-32 (using 4 bytes for all characters).

It's crucial to comprehend these concepts to effectively handle and mitigate potential issues arising from Unicode's complexity and its various encoding methods.

An example of how Unicode normalise two different bytes representing the same character:
```python
unicodedata.normalize("NFKD","chloe\u0301") == unicodedata.normalize("NFKD", "chlo\u00e9")
```
**–°–ø–∏—Å–æ–∫ –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤ Unicode –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —Ç—É—Ç:** [https://appcheck-ng.com/wp-content/uploads/unicode\_normalization.html](https://appcheck-ng.com/wp-content/uploads/unicode\_normalization.html) —Ç–∞ [https://0xacb.com/normalization\_table](https://0xacb.com/normalization\_table)

### –í–∏—è–≤–ª–µ–Ω–Ω—è

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –≤ –≤–µ–±-–¥–æ–¥–∞—Ç–∫—É –∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –Ω–∞–∑–∞–¥, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ **‚ÄòKELVIN SIGN‚Äô (U+0212A)**, —è–∫–µ **–Ω–æ—Ä–º–∞–ª—ñ–∑—É—î—Ç—å—Å—è –¥–æ "K"** (–≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –π–æ–≥–æ —è–∫ `%e2%84%aa`). **–Ø–∫—â–æ "K" –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –Ω–∞–∑–∞–¥**, —Ç–æ–¥—ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —è–∫–∞—Å—å —Ñ–æ—Ä–º–∞ **–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó Unicode**.

–Ü–Ω—à–∏–π **–ø—Ä–∏–∫–ª–∞–¥**: `%F0%9D%95%83%E2%85%87%F0%9D%99%A4%F0%9D%93%83%E2%85%88%F0%9D%94%B0%F0%9D%94%A5%F0%9D%99%96%F0%9D%93%83` –ø—ñ—Å–ª—è **–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó** –±—É–¥–µ `Leonishan`.

## **–í—Ä–∞–∑–ª–∏–≤—ñ –ø—Ä–∏–∫–ª–∞–¥–∏**

### **–û–±—Ö—ñ–¥ —Ñ—ñ–ª—å—Ç—Ä–∞ SQL Injection**

–£—è–≤—ñ—Ç—å –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫—É, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å–∏–º–≤–æ–ª `'` –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è SQL-–∑–∞–ø–∏—Ç—ñ–≤ –∑ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –¶—è –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞, —è–∫ –∑–∞—Ö—ñ–¥ –±–µ–∑–ø–µ–∫–∏, **–≤–∏–¥–∞–ª—è—î** –≤—Å—ñ –≤–∏–ø–∞–¥–∫–∏ —Å–∏–º–≤–æ–ª—É **`'`** –∑ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –∞–ª–µ **–ø—ñ—Å–ª—è —Ü—å–æ–≥–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è** —ñ **–ø–µ—Ä–µ–¥ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º** –∑–∞–ø–∏—Ç—É, –≤–æ–Ω–∞ **–Ω–æ—Ä–º–∞–ª—ñ–∑—É—î** –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **Unicode**.

–¢–æ–¥—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –≤—Å—Ç–∞–≤–∏—Ç–∏ —ñ–Ω—à–∏–π —Å–∏–º–≤–æ–ª Unicode, –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–∏–π `' (0x27)`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `%ef%bc%87`, –∫–æ–ª–∏ –≤–≤–µ–¥–µ–Ω–Ω—è –Ω–æ—Ä–º–∞–ª—ñ–∑—É—î—Ç—å—Å—è, —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –æ–¥–∏–Ω–∞—Ä–Ω–∞ –ª–∞–ø–∫–∞, —ñ –∑'—è–≤–ª—è—î—Ç—å—Å—è **–≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å SQL Injection**:

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (702).png>)

**–î–µ—è–∫—ñ —Ü—ñ–∫–∞–≤—ñ —Å–∏–º–≤–æ–ª–∏ Unicode**

* `o` -- %e1%b4%bc
* `r` -- %e1%b4%bf
* `1` -- %c2%b9
* `=` -- %e2%81%bc
* `/` -- %ef%bc%8f
* `-`-- %ef%b9%a3
* `#`-- %ef%b9%9f
* `*`-- %ef%b9%a1
* `'` -- %ef%bc%87
* `"` -- %ef%bc%82
* `|` -- %ef%bd%9c
```
' or 1=1-- -
%ef%bc%87+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3

" or 1=1-- -
%ef%bc%82+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3

' || 1==1//
%ef%bc%87+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f

" || 1==1//
%ef%bc%82+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f
```
#### sqlmap —à–∞–±–ª–æ–Ω

{% embed url="https://github.com/carlospolop/sqlmap_to_unicode_template" %}

### XSS (–ú—ñ–∂—Å–∞–π—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç–∏–Ω–≥)

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –æ–¥–∏–Ω –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤, —â–æ–± –æ–±–º–∞–Ω—É—Ç–∏ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫ —ñ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ XSS:

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (312) (2).png>)

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–µ—Ä—à–∏–π –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∏–π —Å–∏–º–≤–æ–ª Unicode –º–æ–∂–µ –±—É—Ç–∏ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∏–π —è–∫: `%e2%89%ae` –∞–±–æ —è–∫ `%u226e`

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (215) (1) (1).png>)

### –§–∞–∑–∑–∏–Ω–≥ —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤

–ö–æ–ª–∏ –±–µ–∫–µ–Ω–¥ **–ø–µ—Ä–µ–≤—ñ—Ä—è—î –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤–∏—Ä–∞–∑—É**, –º–æ–∂–ª–∏–≤–æ, —â–æ **–≤–≤–µ–¥–µ–Ω–Ω—è** **–Ω–æ—Ä–º–∞–ª—ñ–∑—É—î—Ç—å—Å—è** –¥–ª—è **—Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤–∏—Ä–∞–∑—É**, –∞–ª–µ **–Ω–µ** –¥–ª—è —Ç–æ–≥–æ, –¥–µ –≤–æ–Ω–æ **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è**. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤ Open Redirect –∞–±–æ SSRF —Ä–µ–≥—É–ª—è—Ä–Ω–∏–π –≤–∏—Ä–∞–∑ –º–æ–∂–µ **–Ω–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∏–π URL**, –∞–ª–µ –ø–æ—Ç—ñ–º **–¥–æ—Å—Ç—É–ø–∞—Ç–∏—Å—è –¥–æ –Ω—å–æ–≥–æ —è–∫ —î**.

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [**recollapse**](https://github.com/0xacb/recollapse) \*\*\*\* –¥–æ–∑–≤–æ–ª—è—î **–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –≤–∞—Ä—ñ–∞—Ü—ñ—ó –≤–≤–µ–¥–µ–Ω–Ω—è** –¥–ª—è —Ñ–∞–∑–∑–∏–Ω–≥—É –±–µ–∫–µ–Ω–¥—É. –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ **github** —Ç–∞ —Ü–µ–π [**–ø–æ—Å—Ç**](https://0xacb.com/2022/11/21/recollapse/).

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [**https://labs.spotify.com/2013/06/18/creative-usernames/**](https://labs.spotify.com/2013/06/18/creative-usernames/)
* [**https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work**](https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work)
* [**https://jlajara.gitlab.io/posts/2020/02/19/Bypass\_WAF\_Unicode.html**](https://jlajara.gitlab.io/posts/2020/02/19/Bypass\_WAF\_Unicode.html)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) —î **–ø–æ—à—É–∫–æ–≤–æ—é —Å–∏—Å—Ç–µ–º–æ—é** –Ω–∞ –æ—Å–Ω–æ–≤—ñ **—Ç–µ–º–Ω–æ–≥–æ –≤–µ–±—É**, —è–∫–∞ –ø—Ä–æ–ø–æ–Ω—É—î **–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω—ñ** —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —á–∏ –±—É–ª–∞ –∫–æ–º–ø–∞–Ω—ñ—è –∞–±–æ —ó—ó –∫–ª—ñ—î–Ω—Ç–∏ **–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω—ñ** **—à–∫—ñ–¥–ª–∏–≤–∏–º–∏ –ø—Ä–æ–≥—Ä–∞–º–∞–º–∏-–∫—Ä–∞–¥—ñ—è–º–∏**.

–á—Ö–Ω—è –æ—Å–Ω–æ–≤–Ω–∞ –º–µ—Ç–∞ - –±–æ—Ä–æ—Ç–∏—Å—è –∑ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è–º–∏ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ —Ç–∞ –∞—Ç–∞–∫–∞–º–∏ –ø—Ä–æ–≥—Ä–∞–º-–≤–∏–º–∞–≥–∞—á—ñ–≤, —â–æ –≤–∏–Ω–∏–∫–∞—é—Ç—å –≤–Ω–∞—Å–ª—ñ–¥–æ–∫ —à–∫—ñ–¥–ª–∏–≤–∏—Ö –ø—Ä–æ–≥—Ä–∞–º, —â–æ –∫—Ä–∞–¥—É—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é.

–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —ó—Ö–Ω—ñ–π –≤–µ–±-—Å–∞–π—Ç —ñ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —ó—Ö–Ω—ñ–π –¥–≤–∏–≥—É–Ω **–±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ** –∑–∞ –∞–¥—Ä–µ—Å–æ—é:

{% embed url="https://whiteintel.io" %}

{% hint style="success" %}
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ Hacking AWS:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
–í—á—ñ—Ç—å—Å—è —Ç–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ Hacking GCP: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>–ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ HackTricks</summary>

* –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ø–ª–∞–Ω–∏ –ø—ñ–¥–ø–∏—Å–∫–∏**](https://github.com/sponsors/carlospolop)!
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **–î—ñ–ª—ñ—Ç—å—Å—è —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ github.

</details>
{% endhint %}
