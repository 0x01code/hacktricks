# Unicode Normalisierung

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) ist eine von **Dark Web** angetriebene Suchmaschine, die **kostenlose** Funktionen bietet, um zu √ºberpr√ºfen, ob ein Unternehmen oder seine Kunden von **Stealer-Malware** **kompromittiert** wurden.

Das Hauptziel von WhiteIntel ist es, Konto√ºbernahmen und Ransomware-Angriffe zu bek√§mpfen, die durch informationsstehlende Malware verursacht werden.

Sie k√∂nnen ihre Website besuchen und ihren Motor **kostenlos** ausprobieren unter:

{% embed url="https://whiteintel.io" %}

***

**Dies ist eine Zusammenfassung von:** [**https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/**](https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/). Schauen Sie f√ºr weitere Details dort vorbei (Bilder von dort √ºbernommen).

## Verst√§ndnis von Unicode und Normalisierung

Unicode-Normalisierung ist ein Prozess, der sicherstellt, dass verschiedene bin√§re Darstellungen von Zeichen auf denselben bin√§ren Wert standardisiert werden. Dieser Prozess ist entscheidend im Umgang mit Zeichenfolgen in der Programmierung und Datenverarbeitung. Der Unicode-Standard definiert zwei Arten von Zeichen√§quivalenz:

1. **Kanonische √Ñquivalenz**: Zeichen gelten als kanonisch √§quivalent, wenn sie dasselbe Aussehen und dieselbe Bedeutung haben, wenn sie gedruckt oder angezeigt werden.
2. **Kompatibilit√§ts√§quivalenz**: Eine schw√§chere Form der √Ñquivalenz, bei der Zeichen dasselbe abstrakte Zeichen darstellen k√∂nnen, aber unterschiedlich angezeigt werden k√∂nnen.

Es gibt **vier Unicode-Normalisierungsalgorithmen**: NFC, NFD, NFKC und NFKD. Jeder Algorithmus wendet kanonische und kompatible Normalisierungstechniken unterschiedlich an. F√ºr ein tieferes Verst√§ndnis k√∂nnen Sie diese Techniken auf [Unicode.org](https://unicode.org/) erkunden.

### Schl√ºsselpunkte zur Unicode-Codierung

Das Verst√§ndnis der Unicode-Codierung ist entscheidend, insbesondere beim Umgang mit Interoperabilit√§tsproblemen zwischen verschiedenen Systemen oder Sprachen. Hier sind die wichtigsten Punkte:

* **Codepunkte und Zeichen**: In Unicode wird jedem Zeichen oder Symbol ein numerischer Wert zugewiesen, der als "Codepunkt" bekannt ist.
* **Byte-Repr√§sentation**: Der Codepunkt (oder das Zeichen) wird durch ein oder mehrere Bytes im Speicher dargestellt. Zum Beispiel werden LATIN-1-Zeichen (√ºblich in englischsprachigen L√§ndern) mit einem Byte dargestellt. Sprachen mit einem gr√∂√üeren Zeichensatz ben√∂tigen jedoch mehr Bytes zur Darstellung.
* **Codierung**: Dieser Begriff bezieht sich darauf, wie Zeichen in eine Reihe von Bytes umgewandelt werden. UTF-8 ist ein verbreiteter Codierungsstandard, bei dem ASCII-Zeichen mit einem Byte und bis zu vier Bytes f√ºr andere Zeichen dargestellt werden.
* **Datenverarbeitung**: Systeme, die Daten verarbeiten, m√ºssen sich der verwendeten Codierung bewusst sein, um den Byte-Stream korrekt in Zeichen umzuwandeln.
* **Varianten von UTF**: Neben UTF-8 gibt es andere Codierungsstandards wie UTF-16 (mindestens 2 Bytes, bis zu 4) und UTF-32 (4 Bytes f√ºr alle Zeichen).

Es ist entscheidend, diese Konzepte zu verstehen, um potenzielle Probleme, die aus der Komplexit√§t von Unicode und seinen verschiedenen Codierungsmethoden resultieren k√∂nnen, effektiv zu behandeln und zu mildern.

Ein Beispiel daf√ºr, wie Unicode zwei verschiedene Bytes normalisiert, die dasselbe Zeichen darstellen:
```python
unicodedata.normalize("NFKD","chloe\u0301") == unicodedata.normalize("NFKD", "chlo\u00e9")
```
**Eine Liste √§quivalenter Unicode-Zeichen finden Sie hier:** [https://appcheck-ng.com/wp-content/uploads/unicode\_normalization.html](https://appcheck-ng.com/wp-content/uploads/unicode\_normalization.html) und [https://0xacb.com/normalization\_table](https://0xacb.com/normalization\_table)

### Entdeckung

Wenn Sie in einer Webanwendung einen Wert finden, der zur√ºckgegeben wird, k√∂nnten Sie versuchen, **'KELVIN SIGN' (U+0212A)** zu senden, der sich zu "K" **normalisiert** (Sie k√∂nnen es als `%e2%84%aa` senden). **Wenn ein "K" zur√ºckgegeben wird**, wird eine Art von **Unicode-Normalisierung** durchgef√ºhrt.

Ein anderes **Beispiel**: `%F0%9D%95%83%E2%85%87%F0%9D%99%A4%F0%9D%93%83%E2%85%88%F0%9D%94%B0%F0%9D%94%A5%F0%9D%99%96%F0%9D%93%83` wird nach der **Unicode-Normalisierung** zu `Leonishan`.

## **Beispiele f√ºr verwundbare Stellen**

### **SQL-Injection-Filterumgehung**

Stellen Sie sich eine Webseite vor, die das Zeichen `'` verwendet, um SQL-Abfragen mit der Benutzereingabe zu erstellen. Diese Webseite l√∂scht als Sicherheitsma√ünahme alle Vorkommen des Zeichens **`'`** aus der Benutzereingabe, aber **nach dieser L√∂schung** und **vor der Erstellung** der Abfrage **normalisiert** sie die Benutzereingabe mit **Unicode**.

Dann k√∂nnte ein b√∂sartiger Benutzer ein anderes Unicode-Zeichen einf√ºgen, das √§quivalent zu `' (0x27)` ist, wie `%ef%bc%87`. Wenn die Eingabe normalisiert wird, wird ein einfaches Anf√ºhrungszeichen erstellt und eine **SQL-Injection-Schwachstelle** tritt auf:

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (702).png>)

**Einige interessante Unicode-Zeichen**

* `o` -- %e1%b4%bc
* `r` -- %e1%b4%bf
* `1` -- %c2%b9
* `=` -- %e2%81%bc
* `/` -- %ef%bc%8f
* `-`-- %ef%b9%a3
* `#`-- %ef%b9%9f
* `*`-- %ef%b9%a1
* `'` -- %ef%bc%87
* `"` -- %ef%bc%82
* `|` -- %ef%bd%9c
```
' or 1=1-- -
%ef%bc%87+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3

" or 1=1-- -
%ef%bc%82+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3

' || 1==1//
%ef%bc%87+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f

" || 1==1//
%ef%bc%82+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f
```
#### sqlmap Vorlage

{% embed url="https://github.com/carlospolop/sqlmap_to_unicode_template" %}

### XSS (Cross Site Scripting)

Sie k√∂nnten eines der folgenden Zeichen verwenden, um die Webanwendung zu t√§uschen und eine XSS auszunutzen:

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (312) (2).png>)

Beachten Sie, dass zum Beispiel das erste vorgeschlagene Unicode-Zeichen gesendet werden kann als: `%e2%89%ae` oder als `%u226e`

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (215) (1) (1).png>)

### Fuzzing Regexes

Wenn das Backend **Benutzereingaben mit einem Regex √ºberpr√ºft**, k√∂nnte es m√∂glich sein, dass die **Eingabe** f√ºr den **Regex normalisiert wird**, aber **nicht** f√ºr den Ort, an dem sie **verwendet wird**. Zum Beispiel k√∂nnte in einem Open Redirect oder SSRF der Regex die gesendete URL **normalisieren**, aber dann darauf zugreifen, wie sie ist.

Das Tool [**recollapse**](https://github.com/0xacb/recollapse) erm√∂glicht es, **Variationen der Eingabe zu generieren**, um das Backend zu fuzz. Weitere Informationen finden Sie auf **GitHub** und in diesem [**Beitrag**](https://0xacb.com/2022/11/21/recollapse/).

## Referenzen

* [**https://labs.spotify.com/2013/06/18/creative-usernames/**](https://labs.spotify.com/2013/06/18/creative-usernames/)
* [**https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work**](https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work)
* [**https://jlajara.gitlab.io/posts/2020/02/19/Bypass\_WAF\_Unicode.html**](https://jlajara.gitlab.io/posts/2020/02/19/Bypass\_WAF\_Unicode.html)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) ist eine von Dark Web angetriebene Suchmaschine, die kostenlose Funktionen bietet, um zu √ºberpr√ºfen, ob ein Unternehmen oder seine Kunden von Stealer-Malware **kompromittiert** wurden.

Das Hauptziel von WhiteIntel ist es, Konto√ºbernahmen und Ransomware-Angriffe aufgrund von informationsstehlender Malware zu bek√§mpfen.

Sie k√∂nnen ihre Website besuchen und ihre Engine **kostenlos** ausprobieren unter:

{% embed url="https://whiteintel.io" %}

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
