# Unicode Normalisering

<details>

<summary><strong>Leer AWS hak van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

**Dit is 'n opsomming van:** [**https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/**](https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/). Kyk vir verdere besonderhede (afbeeldings geneem van daar).

## Begrip van Unicode en Normalisering

Unicode normalisering is 'n proses wat verseker dat verskillende bin√™re voorstellings van karakters gestandaardiseer word na dieselfde bin√™re waarde. Hierdie proses is krities in die hantering van strings in programmering en data verwerking. Die Unicode standaard definieer twee tipes karakter-ekwivalensie:

1. **Kanoniese Ekwivalensie**: Karakters word kanonies ekwivalent beskou as hulle dieselfde voorkoms en betekenis het wanneer dit gedruk of vertoon word.
2. **Verenigbaarheid Ekwivalensie**: 'n Swakker vorm van ekwivalensie waar karakters dieselfde abstrakte karakter kan verteenwoordig, maar anders vertoon kan word.

Daar is **vier Unicode normaliseringsalgoritmes**: NFC, NFD, NFKC, en NFKD. Elke algoritme maak gebruik van kanoniese en verenigbare normaliserings tegnieke op 'n ander manier. Vir 'n meer diepgaande begrip, kan jy hierdie tegnieke verken op [Unicode.org](https://unicode.org/).

### Sleutelpunte oor Unicode Enkodering

Begrip van Unicode enkodering is van kardinale belang, veral wanneer dit kom by interoperabiliteitsprobleme tussen verskillende stelsels of tale. Hier is die belangrikste punte:

* **Kodepunte en Karakters**: In Unicode word elke karakter of simbool toegewys aan 'n numeriese waarde wat bekend staan as 'n "kodepunt".
* **Bytes Voorstelling**: Die kodepunt (of karakter) word verteenwoordig deur een of meer bytes in geheue. Byvoorbeeld, LATYN-1 karakters (gewoonlik in Engelsprekende lande) word voorgestel deur een byte. Tog, tale met 'n groter stel karakters benodig meer bytes vir voorstelling.
* **Enkodering**: Hierdie term verwys na hoe karakters omskep word na 'n reeks bytes. UTF-8 is 'n algemene enkoderingsstandaard waar ASCII karakters voorgestel word deur een byte, en tot vier bytes vir ander karakters.
* **Verwerking van Data**: Stelsels wat data verwerk moet bewus wees van die enkodering wat gebruik word om die bytevloei korrek te omskep na karakters.
* **Variante van UTF**: Behalwe UTF-8, is daar ander enkoderingsstandaarde soos UTF-16 (wat 'n minimum van 2 bytes gebruik, tot 4) en UTF-32 (wat 4 bytes vir alle karakters gebruik).

Dit is krities om hierdie konsepte te begryp om potensi√´le probleme wat voortspruit uit die kompleksiteit van Unicode en sy verskeie enkoderingsmetodes doeltreffend te hanteer en te verminder.

'n Voorbeeld van hoe Unicode twee verskillende bytes normaliseer wat dieselfde karakter voorstel:
```python
unicodedata.normalize("NFKD","chloe\u0301") == unicodedata.normalize("NFKD", "chlo\u00e9")
```
**'n Lys van Unicode-ekwivalente karakters kan hier gevind word:** [https://appcheck-ng.com/wp-content/uploads/unicode\_normalization.html](https://appcheck-ng.com/wp-content/uploads/unicode\_normalization.html) en [https://0xacb.com/normalization\_table](https://0xacb.com/normalization\_table)

### Ontdekking

As jy binne 'n webtoep 'n waarde kan vind wat teruggekaats word, kan jy probeer om **'KELVIN TEKEN' (U+0212A)** te stuur wat **genormaliseer word na "K"** (jy kan dit stuur as `%e2%84%aa`). **As 'n "K" teruggekaats word**, dan word daar op 'n of ander manier **Unicode normalisering** uitgevoer.

Ander **voorbeeld**: `%F0%9D%95%83%E2%85%87%F0%9D%99%A4%F0%9D%93%83%E2%85%88%F0%9D%94%B0%F0%9D%94%A5%F0%9D%99%96%F0%9D%93%83` na **unicode** is `Leonishan`.

## **Vatbare Voorbeelde**

### **SQL Injection filter omseil**

Stel jou 'n webbladsy voor wat die karakter `'` gebruik om SQL-navrae met die gebruikersinvoer te skep. Hierdie web, as 'n sekuriteitsmaatre√´l, **verwyder** alle voorkomste van die karakter **`'`** uit die gebruikersinvoer, maar **na daardie verwydering** en **voor die skepping** van die navraag, **normaliseer** dit die invoer van die gebruiker met behulp van **Unicode**.

Dan kan 'n kwaadwillige gebruiker 'n ander Unicode-karakter invoeg wat ekwivalent is aan `' (0x27)` soos `%ef%bc%87`, wanneer die invoer genormaliseer word, word 'n enkele aanhalingsteken geskep en 'n **SQLInjection kwesbaarheid** verskyn:

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (699).png>)

**Sommige interessante Unicode-karakters**

* `o` -- %e1%b4%bc
* `r` -- %e1%b4%bf
* `1` -- %c2%b9
* `=` -- %e2%81%bc
* `/` -- %ef%bc%8f
* `-`-- %ef%b9%a3
* `#`-- %ef%b9%9f
* `*`-- %ef%b9%a1
* `'` -- %ef%bc%87
* `"` -- %ef%bc%82
* `|` -- %ef%bd%9c
```
' or 1=1-- -
%ef%bc%87+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3

" or 1=1-- -
%ef%bc%82+%e1%b4%bc%e1%b4%bf+%c2%b9%e2%81%bc%c2%b9%ef%b9%a3%ef%b9%a3+%ef%b9%a3

' || 1==1//
%ef%bc%87+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f

" || 1==1//
%ef%bc%82+%ef%bd%9c%ef%bd%9c+%c2%b9%e2%81%bc%e2%81%bc%c2%b9%ef%bc%8f%ef%bc%8f
```
#### sqlmap sjabloon

{% embed url="https://github.com/carlospolop/sqlmap_to_unicode_template" %}

### XSS (Cross Site Scripting)

Jy kan een van die volgende karakters gebruik om die webtoepassing te mislei en 'n XSS te benut:

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (312) (2).png>)

Let daarop dat byvoorbeeld die eerste Unicode-karakter voorgestel kan word as: `%e2%89%ae` of as `%u226e`

![https://appcheck-ng.com/unicode-normalization-vulnerabilities-the-special-k-polyglot/](<../../.gitbook/assets/image (215) (1) (1).png>)

### Fuzzing Regexes

Wanneer die agterkant **gebruikerinvoer met 'n regex nagaan**, kan dit moontlik wees dat die **invoer** genormaliseer word vir die **regex** maar **nie** vir waar dit **gebruik** word nie. Byvoorbeeld, in 'n Oop Herlei of SSRF kan die regex die gestuurde URL **normaliseer** maar dit dan **soos dit is** toegang gee.

Die instrument [**recollapse**](https://github.com/0xacb/recollapse) \*\*\*\* maak dit moontlik om **variasies van die invoer te genereer** om die agterkant te fuzz. Vir meer inligting kyk na die **github** en hierdie [**pos**](https://0xacb.com/2022/11/21/recollapse/).

## Verwysings

* [**https://labs.spotify.com/2013/06/18/creative-usernames/**](https://labs.spotify.com/2013/06/18/creative-usernames/)
* [**https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work**](https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work)
* [**https://jlajara.gitlab.io/posts/2020/02/19/Bypass\_WAF\_Unicode.html**](https://jlajara.gitlab.io/posts/2020/02/19/Bypass\_WAF\_Unicode.html)

<details>

<summary><strong>Leer AWS hakwerk van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kontroleer die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
