# рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдердбреЛрд▓реЙрдЬреА

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PRs рдЬрдорд╛ рдХрд░рдХреЗред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди JavaScript рдореЗрдВ рд▓рд┐рдЦреЗ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рдкрд┐рдЫрд▓реЗ рдкреНрд▓рд╛рди рдореЗрдВ рд▓реЛрдб рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ [DOM](https://www.w3schools.com/js/js\_htmldom.asp) рд╣реЛрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдпрд╣ рдЕрдиреНрдп рд╕рд╛рдЗрдЯреЛрдВ рдХреЗ DOM рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрд╣ рдЕрдиреНрдп рд╕рд╛рдЗрдЯреЛрдВ рдХреА рдЧреЛрдкрдиреАрдпрддрд╛, рдЕрдЦрдВрдбрддрд╛, рдФрд░ рдЙрдкрд▓рдмреНрдзрддрд╛ (CIA) рдХреЛ рдХрдордЬреЛрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

## рдореБрдЦреНрдп рдШрдЯрдХ

рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓реЗрдЖрдЙрдЯ рдЬрдм рд╡рд┐рдЬреБрдЕрд▓рд╛рдЗрдЬрд╝ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рддреЛ рдЙрдирдореЗрдВ рддреАрди рдШрдЯрдХ рд╣реЛрддреЗ рд╣реИрдВред рдЪрд▓рд┐рдП рд╣рд░ рдШрдЯрдХ рдХреЛ рдЧрд╣рд░рд╛рдИ рд╕реЗ рджреЗрдЦрддреЗ рд╣реИрдВред

<figure><img src="../../.gitbook/assets/image (16) (1).png" alt=""><figcaption><p><a href="http://webblaze.cs.berkeley.edu/papers/Extensions.pdf">http://webblaze.cs.berkeley.edu/papers/Extensions.pdf</a></p></figcaption></figure>

### **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕**

рдкреНрд░рддреНрдпреЗрдХ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдкрд╛рд╕ рдПрдХ **рдПрдХрд▓ рд╡реЗрдм рдкреГрд╖реНрда** рдХреЗ DOM рддрдХ рд╕реАрдзрд╛ рдкрд╣реБрдВрдЪ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рд▓рд┐рдП рдпрд╣ **рд╕рдВрднрд╛рд╡рд┐рдд рджреБрд░реБрдкрдпреЛрдЧреА рдЗрдирдкреБрдЯ** рдХреЗ рд▓рд┐рдП рдЕрд╡ exposed рд╣реЛрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдХреЛрдИ рдЕрдиреНрдп рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдирд╣реАрдВ рд╣реЛрддреАрдВ рд╕рд┐рд╡рд╛рдп рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреАред

### **рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░**

рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рдореЗрдВ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдЕрдзрд┐рдХрд╛рдВрд╢ рдЕрдиреБрдорддрд┐рдпреЛрдВ/рдкрд╣реБрдВрдЪ рд╣реЛрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рдХреЗрд╡рд▓ [XMLHttpRequest](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest) рдФрд░ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реЗрдм рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рдХреЛ рд╣реЛрд╕реНрдЯ рдорд╢реАрди рддрдХ рд╕реАрдзрд╛ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реЛрддреАред

### **рдиреЗрдЯрд┐рд╡ рдмрд╛рдЗрдирд░реА**

рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдПрдХ рдиреЗрдЯрд┐рд╡ рдмрд╛рдЗрдирд░реА рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреВрд░реНрдг рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рд╣реЛрд╕реНрдЯ рдорд╢реАрди рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИред рдиреЗрдЯрд┐рд╡ рдмрд╛рдЗрдирд░реА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рдХреЗ рд╕рд╛рде рд╕рд╛рдорд╛рдиреНрдп рдиреЗрдЯрд╕реНрдХреЗрдк рдкреНрд▓рдЧрдЗрди рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдЗрдВрдЯрд░рдлреЗрд╕ ([NPAPI](https://en.wikipedia.org/wiki/NPAPI)) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмрд╛рддрдЪреАрдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдлреНрд▓реИрд╢ рдФрд░ рдЕрдиреНрдп рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдкреНрд▓рдЧрдЗрдиреНрд╕ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### рд╕реАрдорд╛рдПрдБ

{% hint style="danger" %}
рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреВрд░реНрдг рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рджреБрд░реБрдкрдпреЛрдЧреА рдЗрдирдкреБрдЯ рдХреЛ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рдФрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рд╕реЗ рдиреЗрдЯрд┐рд╡ рдмрд╛рдЗрдирд░реА рддрдХ рдкрд╣реБрдВрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдкреНрд░реЗрд░рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред
{% endhint %}

рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдШрдЯрдХ рдХреЛ рдПрдХ-рджреВрд╕рд░реЗ рд╕реЗ **рдордЬрдмреВрдд рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХ рд╕реАрдорд╛рдПрдБ** рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рдШрдЯрдХ рдПрдХ **рдЕрд▓рдЧ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рдХреНрд░рд┐рдпрд╛** рдореЗрдВ рдЪрд▓рддрд╛ рд╣реИред рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдФрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ **рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ** рдореЗрдВ рдЪрд▓рддреЗ рд╣реИрдВ рдЬреЛ рдЕрдзрд┐рдХрд╛рдВрд╢ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдкрд▓рдмреНрдз рд╣реЛрддреЗ рд╣реИрдВред

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдЕрдкрдиреЗ рд╕рдВрдмрдВрдзрд┐рдд рд╡реЗрдм рдкреГрд╖реНрдареЛрдВ рд╕реЗ **рдПрдХ рдЕрд▓рдЧ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реАрдк** рдореЗрдВ рдЪрд▓рддреЗ рд╣реИрдВред рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рд╡реЗрдм рдкреГрд╖реНрда рдХреЗ рдкрд╛рд╕ **рдПрдХ рд╣реА рдЖрдзрд╛рд░рд┐рдХ DOM** рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рджреЛрдиреЛрдВ **рдХрднреА рднреА рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХрд╛ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рдирд╣реАрдВ** рдХрд░рддреЗ, рдЬрд┐рд╕рд╕реЗ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рд▓реАрдХ рди рд╣реЛред

## **`manifest.json`**

рдПрдХ Chrome рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдмрд╕ рдПрдХ [.crx рдлрд╝рд╛рдЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди](https://www.lifewire.com/crx-file-2620391) рд╡рд╛рд▓реА ZIP рдлрд╝реЛрд▓реНрдбрд░ рд╣реЛрддреА рд╣реИред рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рдлрд╝реЛрд▓реНрдбрд░ рдХреА рдореВрд▓ рдлрд╝рд╛рдЗрд▓ **`manifest.json`** рд╣реЛрддреА рд╣реИ, рдЬреЛ рд▓реЗрдЖрдЙрдЯ, рдЕрдиреБрдорддрд┐рдпрд╛рдБ, рдФрд░ рдЕрдиреНрдп рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреА рд╣реИред

рдЙрджрд╛рд╣рд░рдг:
```json
{
"manifest_version": 2,
"name": "My extension",
"version": "1.0",
"permissions": [
"storage"
],
"content_scripts": [
{
"js": [
"script.js"
],
"matches": [
"https://example.com/*",
"https://www.example.com/*"
],
"exclude_matches": ["*://*/*business*"],
}
],
"background": {
"scripts": [
"background.js"
]
},
"options_ui": {
"page": "options.html"
}
}
```
### `рд╕рд╛рдордЧреНрд░реА_рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕`
Content scripts рдХрднреА рднреА рдЙрд╕ рд╕рдордп **рд▓реЛрдб** рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдПрдХ рдорд┐рд▓рд╛рди рдкреГрд╖реНрда рдкрд░ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рддрд╛ рд╣реИ**, рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдХрд┐рд╕реА рднреА рдкреГрд╖реНрда рдХреЛ рдорд┐рд▓рд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ **`https://example.com/*`** рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд╕рд╛рде рдФрд░ **`*://*/*/business*`** рд░реЗрдЬреЗрдХреНрд╕ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддреЗред рд╡реЗ рдкреГрд╖реНрда рдХреЗ рдЕрдкрдиреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рддрд░рд╣ **рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд** рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдкреГрд╖реНрда рдХреЗ [рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдореЙрдбрд▓ (DOM)](https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model) рдХрд╛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░рд┐рдХ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```json
"content_scripts": [
{
"js": [
"script.js"
],
"matches": [
"https://example.com/*",
"https://www.example.com/*"
],
"exclude_matches": ["*://*/*business*"],
}
],
```
рдЕрдзрд┐рдХ URL рд╢рд╛рдорд┐рд▓ рдпрд╛ рдЕрдкрд╡рд░реНрдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **`include_globs`** рдФрд░ **`exclude_globs`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред

рдпрд╣ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реИ рдЬреЛ рдкреГрд╖реНрда рдореЗрдВ рдПрдХ рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдмрдЯрди рдЬреЛрдбрд╝реЗрдЧрд╛ рдЬрдм [рд╕реНрдЯреЛрд░реЗрдЬ API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕реНрдЯреЛрд░реЗрдЬ рд╕реЗ `message` рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
```js
chrome.storage.local.get("message", result =>
{
let div = document.createElement("div");
div.innerHTML = result.message + " <button>Explain</button>";
div.querySelector("button").addEventListener("click", () =>
{
chrome.runtime.sendMessage("explain");
});
document.body.appendChild(div);
});
```
<figure><img src="../../.gitbook/assets/image (23).png" alt=""><figcaption></figcaption></figure>

рдЬрдм рдпрд╣ рдмрдЯрди рдХреНрд▓рд┐рдХ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рджреНрд╡рд╛рд░рд╛ рдПрдХ рд╕рдВрджреЗрд╢ рд╡рд┐рд╕реНрддрд╛рд░ рдкреГрд╖реНрдареЛрдВ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, [**runtime.sendMessage() API**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред рдпрд╣ рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рд╕реАрдзреА рдкрд╣реБрдВрдЪ рдХреА рд╕реАрдорд╛ рдХреЗ рдХрд╛рд░рдг рд╣реИ, `storage` рдореЗрдВ рдХреБрдЫ рдЕрдкрд╡рд╛рджреЛрдВ рдХреЗ рдмреАрдЪред рдЗрди рдЕрдкрд╡рд╛рджреЛрдВ рд╕реЗ рдкрд░реЗ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП, рд╕рдВрджреЗрд╢ рд╡рд┐рд╕реНрддрд╛рд░ рдкреГрд╖реНрдареЛрдВ рдХреЛ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ рдЬрд┐рдирдХреЗ рд╕рд╛рде рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдЪрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="warning" %}
рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рдХреНрд╖рдорддрд╛рдПрдБ рдереЛрдбрд╝реА рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдЪреНрд░реЛрдорд┐рдпрдо рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреЗ рд▓рд┐рдП, рдХреНрд╖рдорддрд╛рдУрдВ рдХреА рд╕реВрдЪреА [Chrome Developers рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг](https://developer.chrome.com/docs/extensions/mv3/content\_scripts/#capabilities) рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИ, рдФрд░ рдлрд╝рд╛рдпрд░рдлрд╝реЙрдХреНрд╕ рдХреЗ рд▓рд┐рдП, [MDN](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Content\_scripts#webextension\_apis) рдкреНрд░рд╛рдердорд┐рдХ рд╕реНрд░реЛрдд рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред\
рдпрд╣ рднреА рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯреЛрдВ рдХреЛ рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЙрдиреНрд╣реЗрдВ рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░рдиреЗ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рд╡рд╛рдкрд╕ рднреЗрдЬрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИред
{% endhint %}

рдХреНрд░реЛрдо рдореЗрдВ рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рджреЗрдЦрдиреЗ рдФрд░ рдбреАрдмрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╡рд┐рдХрд╛рд╕рдХ рдЙрдкрдХрд░рдг рдореЗрдиреВ рдХреЛ рд╡рд┐рдХрд▓реНрдк > рдЕрдзрд┐рдХ рдЙрдкрдХрд░рдг > рдбреЗрд╡рд▓рдкрд░ рдЙрдкрдХрд░рдг рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ Ctrl + Shift + I рджрдмрд╛рдХрд░ред

рд╡рд┐рдХрд╛рд╕рдХ рдЙрдкрдХрд░рдг рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрдиреЗ рдкрд░, **рд╕реНрд░реЛрдд рдЯреИрдм** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж **рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдЯреИрдм рдкрд░ рдХреНрд▓рд┐рдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рднрд┐рдиреНрди рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕реЗ рдЪрд▓ рд░рд╣реЗ рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рдЕрд╡рд▓реЛрдХрди рдХрд░рдиреЗ рдФрд░ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдлреНрд▓реЛ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

### рдЗрдВрдЬреЗрдХреНрдЯреЗрдб рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ

{% hint style="success" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЕрдирд┐рд╡рд╛рд░реНрдп рдирд╣реАрдВ рд╣реИрдВ** рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рднреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рд╕реНрдХреНрд░рд┐рдкреНрдЯреЛрдВ рдХреЛ **рдбрд╛рдпрдирд╛рдорд┐рдХ рд░реВрдк рд╕реЗ рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ **рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рд╡реЗрдм рдкреЗрдЬреЛрдВ рдореЗрдВ **`tabs.executeScript`** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЕрдзрд┐рдХ **рдЧреНрд░реИрдиреБрд▓рд░ рдирд┐рдпрдВрддреНрд░рдг** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
{% endhint %}

рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдкреНрд░реЛрдЧреНрд░рд╛рдорд╛рддреНрдордХ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдЙрди рд╕реНрдерд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП [рд╣реЛрд╕реНрдЯ рдЕрдиреБрдорддрд┐рдпрд╛рдБ](https://developer.chrome.com/docs/extensions/reference/permissions) рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдЬрд┐рдирдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдП рдЬрд╛рдиреЗ рд╣реИрдВред рдпреЗ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдореИрдирд┐рдлрд╝реЗрд╕реНрдЯ рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рдорд╛рдВрдЧрдиреЗ рдпрд╛ рдПрдХ рдЕрд╕реНрдерд╛рдпреА рдЖрдзрд╛рд░ рдкрд░ [**activeTab**](https://developer.chrome.com/docs/extensions/reference/manifest/activeTab) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

#### рдЙрджрд╛рд╣рд░рдг activeTab рдЖрдзрд╛рд░рд┐рдд рдПрдХреНрд╕рдЯреЗрдВрд╢рди

{% code title="manifest.json" %}
```json
{
"name": "My extension",
...
"permissions": [
"activeTab",
"scripting"
],
"background": {
"service_worker": "background.js"
},
"action": {
"default_title": "Action Button"
}
}
```
{% endcode %}

* **рдХреНрд▓рд┐рдХ рдкрд░ рдПрдХ JS рдлрд╝рд╛рдЗрд▓ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ:**
```javascript
// content-script.js
document.body.style.backgroundColor = "orange";

//service-worker.js - Inject the JS file
chrome.action.onClicked.addListener((tab) => {
chrome.scripting.executeScript({
target: { tabId: tab.id },
files: ["content-script.js"]
});
});
```
* **рдХреНрд▓рд┐рдХ рдкрд░ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд░реЗрдВ:
```javascript
//service-worker.js - Inject a function
function injectedFunction() {
document.body.style.backgroundColor = "orange";
}

chrome.action.onClicked.addListener((tab) => {
chrome.scripting.executeScript({
target : {tabId : tab.id},
func : injectedFunction,
});
});
```
#### рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЙрджрд╛рд╣рд░рдг
```javascript
// service-workser.js
chrome.scripting.registerContentScripts([{
id : "test",
matches : [ "https://*.example.com/*" ],
excludeMatches : [ "*://*/*business*" ],
js : [ "contentScript.js" ],
}]);

// Another example
chrome.tabs.executeScript(tabId, { file: "content_script.js" });
```
### рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ `run_at`

`run_at` рдлрд╝реАрд▓реНрдб **рдЬрдм JavaScript рдлрд╝рд╛рдЗрд▓реЗрдВ рд╡реЗрдм рдкреЗрдЬ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рд╣реЛрддреА рд╣реИрдВ** рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред рдкрд╕рдВрджреАрджрд╛ рдФрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди `"document_idle"` рд╣реИред

рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рди рд╣реИрдВ:

- **`document_idle`**: рдЬрдм рд╕рдВрднрд╡ рд╣реЛ
- **`document_start`**: `css` рд╕реЗ рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдХреЗ рдмрд╛рдж, рд▓реЗрдХрд┐рди рдХрд┐рд╕реА рднреА рдЕрдиреНрдп DOM рдирд┐рд░реНрдорд┐рдд рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗред
- **`document_end`**: DOM рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж, рд▓реЗрдХрд┐рди рдЫрд╡рд┐рдпреЛрдВ рдФрд░ рдлрд╝реНрд░реЗрдореНрд╕ рдЬреИрд╕реЗ рд╕рдм-рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рд▓реЛрдб рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗред

#### `manifest.json` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ
```json
{
"name": "My extension",
...
"content_scripts": [
{
"matches": ["https://*.example.com/*"],
"run_at": "document_idle",
"js": ["contentScript.js"]
}
],
...
}

```
рджреНрд╡рд╛рд░рд╛ **`service-worker.js`**
```javascript
chrome.scripting.registerContentScripts([{
id : "test",
matches : [ "https://*.example.com/*" ],
runAt : "document_idle",
js : [ "contentScript.js" ],
}]);
```
### `рдкреГрд╖реНрдарднреВрдорд┐`

рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рджреНрд╡рд╛рд░рд╛ рднреЗрдЬреЗ рдЧрдП рд╕рдВрджреЗрд╢ **рдкреГрд╖реНрдарднреВрдорд┐ рдкреГрд╖реНрда** рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЬреЛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдШрдЯрдХреЛрдВ рдХреЛ рд╕рдордиреНрд╡рдпрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдореБрдЦреНрдп рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддрд╛ рд╣реИред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдкреГрд╖реНрдарднреВрдорд┐ рдкреГрд╖реНрда рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдЬреАрд╡рдирдХрд╛рд▓ рддрдХ рдмрдирд╛ рд░рд╣рддрд╛ рд╣реИ, рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдВрддрд░реНрдХреНрд░рд┐рдпрд╛ рдХреЗ рдмрд┐рдирд╛ рдЧреБрдкреНрдд рд░реВрдк рд╕реЗ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ рдЕрдкрдирд╛ рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдореЙрдбрд▓ (DOM) рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдЬрдЯрд┐рд▓ рдЗрдВрдЯрд░реИрдХреНрд╢рди рдФрд░ рд╕реНрдерд┐рддрд┐ рдкреНрд░рдмрдВрдзрди рдХреА рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

**рдореБрдЦреНрдп рдмрд┐рдВрджреБ**:

* **рдкреГрд╖реНрдарднреВрдорд┐ рдкреГрд╖реНрда рдХреА рднреВрдорд┐рдХрд╛:** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд▓рд┐рдП рдирд╕ рдХреЗрдВрджреНрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╣рд┐рд╕реНрд╕реЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рдФрд░ рд╕рдордиреНрд╡рдп рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИред
* **рд╕реНрдерд╛рдпрд┐рддреНрд╡:** рдпрд╣ рдПрдХ рд╕рджреИрд╡ рдореМрдЬреВрджрд╛ рдПрдВрдЯрд┐рдЯреА рд╣реИ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдЕрджреГрд╢реНрдп рд╣реЛрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЗ рд▓рд┐рдП рдЕрднрд┐рдиреНрди рд╣реИред
* **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрддреНрдкрд╛рджрди:** рдпрджрд┐ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдПрдХ рдкреГрд╖реНрдарднреВрдорд┐ рдмрдирд╛рдПрдЧрд╛ред рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрддреНрдкрд╛рджрд┐рдд рдкреГрд╖реНрда рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдореИрдирд┐рдлреЗрд╕реНрдЯ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕рднреА рдкреГрд╖реНрдарднреВрдорд┐ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдЧрд╛, рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдкреГрд╖реНрдарднреВрдорд┐ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд╕рдВрдпрдВрддреНрд░рд┐рдд рдХрд╛рд░реНрдп рдХреА рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реБрдПред

{% hint style="success" %}
рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкреГрд╖реНрдарднреВрдорд┐ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ (рдЬрдм рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдШреЛрд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛ) рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рд╕реБрд╡рд┐рдзрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рдкреГрд╖реНрдарднреВрдорд┐ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдПрдХреАрдХреГрдд рдФрд░ рдкрд░рд┐рдЪрд╛рд▓рдирд╢реАрд▓ рд╣реЛрдВ, рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рд╕реЗрдЯрдЕрдк рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕реБрдЧрдо рдмрдирд╛рддреЗ рд╣реИрдВред
{% endhint %}

рдЙрджрд╛рд╣рд░рдг рдкреГрд╖реНрдарднреВрдорд┐ рд╕реНрдХреНрд░рд┐рдкреНрдЯ:
```js
chrome.runtime.onMessage.addListener((request, sender, sendResponse) =>
{
if (request == "explain")
{
chrome.tabs.create({ url: "https://example.net/explanation" });
}
})
```
рдпрд╣ [runtime.onMessage API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage) рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдВрджреЗрд╢ рд╕реБрдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред рдЬрдм рдПрдХ `"explain"` рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ [tabs API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдкреГрд╖реНрда рдХреЛ рдПрдХ рдирдП рдЯреИрдм рдореЗрдВ рдЦреЛрд▓рддрд╛ рд╣реИред

рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдбреАрдмрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк **рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╡рд┐рд╡рд░рдг рдкрд░ рдЬрд╛рдХрд░ рд╕реЗрд╡рд╛ рдХрд╛рд░реНрдпрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ,** рдпрд╣ рдбреЗрд╡рд▓рдкрд░ рдЯреВрд▓реНрд╕ рдХреЛ рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде рдЦреЛрд▓реЗрдЧрд╛:

<figure><img src="https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/browser-extension-pentesting-methodology/broken-reference" alt=""><figcaption></figcaption></figure>

### рд╡рд┐рдХрд▓реНрдк рдкреГрд╖реНрда рдФрд░ рдЕрдиреНрдп

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреГрд╖реНрда рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:

* **рдХреНрд░рд┐рдпрд╛ рдкреГрд╖реНрда** рдПрдХ **рдбреНрд░реЙрдк-рдбрд╛рдЙрди рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЖрдЗрдХреЙрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред
* рдкреГрд╖реНрда рдЬреЛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди **рдирдП рдЯреИрдм рдореЗрдВ рд▓реЛрдб рдХрд░реЗрдЧрд╛**ред
* **рд╡рд┐рдХрд▓реНрдк рдкреГрд╖реНрда**: рдпрд╣ рдкреГрд╖реНрда рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдкрд░ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИред рдкрд┐рдЫрд▓реЗ рдореИрдирд┐рдлреЗрд╕реНрдЯ рдореЗрдВ рдореЗрд░реА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдореИрдВ рдЗрд╕ рдкреГрд╖реНрда рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрд╛ `chrome://extensions/?options=fadlhnelkbeojnebcbkacjilhnbjfjca` рдпрд╛ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ:

<figure><img src="../../.gitbook/assets/image (24).png" alt="" width="375"><figcaption></figcaption></figure>

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпреЗ рдкреГрд╖реНрда рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рдкреЗрдЬ рдХреА рддрд░рд╣ рд╕реНрдерд╛рдпреА рдирд╣реАрдВ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдпреЗ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдкрд░ рдбрд╛рдпрдирд╛рдорд┐рдХ рд░реВрдк рд╕реЗ рд╕рд╛рдордЧреНрд░реА рд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдмрд╛рд╡рдЬреВрдж, рдЗрдиреНрд╣реЗрдВ рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рдкреЗрдЬ рдХреЗ рд╕рд╛рде рдХреБрдЫ рдпреЛрдЧреНрдпрддрд╛рдПрдБ рд╕рд╛рдЭрд╛ рдХрд░рдиреА рдкрдбрд╝рддреА рд╣реИрдВ:

* **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░:** рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рдкреЗрдЬ рдХреА рддрд░рд╣, рдпреЗ рдкреГрд╖реНрда рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рд╕реЗ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рднреАрддрд░ рдмрд╛рддрдЪреАрдд рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рддреЗ рд╣реИрдВред
* **рдПрдХреНрд╕рдЯреЗрдВрд╢рди-рд╡рд┐рд╢рд┐рд╖реНрдЯ API рддрдХ рдкрд╣реБрдВрдЪ:** рдпреЗ рдкреГрд╖реНрда рдПрдХреНрд╕рдЯреЗрдВрд╢рди-рд╡рд┐рд╢рд┐рд╖реНрдЯ API рддрдХ рд╡реНрдпрд╛рдкрдХ рдкрд╣реБрдВрдЪ рдХрд╛ рдЖрдирдВрдж рд▓реЗрддреЗ рд╣реИрдВ, рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд▓рд┐рдП рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рдЕрдзреАрдиред

### `permissions` рдФрд░ `host_permissions`

**`permissions`** рдФрд░ **`host_permissions`** `manifest.json` рд╕реЗ рдПрдВрдЯреНрд░реА рд╣реИрдВ рдЬреЛ рджрд┐рдЦрд╛рдПрдЧреА **рдЬрд┐рди permissions** рдХрд╛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдкрд╛рд╕ рд╣реИ (рд╕реНрдЯреЛрд░реЗрдЬ, рд╕реНрдерд╛рди...) рдФрд░ **рдХрд┐рд╕ рд╡реЗрдм рдкреГрд╖реНрдареЛрдВ** рдореЗрдВред

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЗрддрдиреЗ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХреГрдд** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдПрдХ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдпрд╛ рдХрд┐рд╕реА рдХреЛ рдХрдВрдкреНрд░рдорд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рддрд░реАрдХреЛрдВ рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЪреБрд░рд╛рдиреЗ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рд╕реВрд╕реА рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИред

рджреЗрдЦреЗрдВ рдХрд┐ рдпреЗ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреА рд╣реИрдВ рдФрд░ рдЗрдиреНрд╣реЗрдВ рдХреИрд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="browext-permissions-and-host_permissions.md" %}
[browext-permissions-and-host\_permissions.md](browext-permissions-and-host\_permissions.md)
{% endcontent-ref %}

### `content_security_policy`

**рдХрдВрдЯреЗрдВрдЯ рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐** рдХреЛ `manifest.json` рдХреЗ рдЕрдВрджрд░ рднреА рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдПрдХ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реИ, рддреЛ рдпрд╣ **рд╡рдВрд╢рд╛рд╕реНрдкрдж** рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкреГрд╖реНрдареЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗрдЯрд┐рдВрдЧ рдмрд╣реБрдд рдкреНрд░рддрд┐рдмрдВрдзрдХрд╛рд░реА рд╣реИ:
```bash
script-src 'self'; object-src 'self';
```
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП CSP рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рдмрд╛рдпрдкрд╛рд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

{% content-ref url="../content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../content-security-policy-csp-bypass/)
{% endcontent-ref %}

### `web_accessible_resources`

рдПрдХ рд╡реЗрдмрдкреЗрдЬ рдХреЛ рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдкреЗрдЬ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ `.html` рдкреЗрдЬ, рдЗрд╕ рдкреЗрдЬ рдХреЛ `manifest.json` рдХреЗ **`web_accessible_resources`** рдлрд╝реАрд▓реНрдб рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```javascript
{
...
"web_accessible_resources": [
{
"resources": [ "images/*.png" ],
"matches": [ "https://example.com/*" ]
},
{
"resources": [ "fonts/*.woff" ],
"matches": [ "https://example.com/*" ]
}
],
...
}
```
рдпреЗ рдкреЗрдЬ URL рдореЗрдВ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИрдВ:
```
chrome-extension://<extension-id>/message.html
```
рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЖрдИрдбреА рдПрдХреНрд╕реЗрд╕рд┐рдмрд▓ рд╣реИ**:

<figure><img src="../../.gitbook/assets/image (1194).png" alt="" width="375"><figcaption></figcaption></figure>

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдЧрд░ `manifest.json` рдкреИрд░рд╛рдореАрдЯрд░ **`use_dynamic_url`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ **рдЖрдИрдбреА рдбрд╛рдпрдирд╛рдорд┐рдХ рд╣реЛ рд╕рдХрддреА рд╣реИ**ред

{% hint style="success" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдПрдХ рдкреГрд╖реНрда рдпрд╣рд╛рдБ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ **рдХреНрд▓рд┐рдХрдЬреИрдХрд┐рдВрдЧ** рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕рдВрд░рдХреНрд╖рд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдзрдиреНрдпрд╡рд╛рдж **рдХрдВрдЯреЗрдВрдЯ рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐** рдХреЗ рдХрд╛рд░рдгред рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдпрд╣ рднреА рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП (рдлреНрд░реЗрдо-рдЕрднрд┐рдХрд░рдг рдЦрдВрдб) рдХрд┐ рдХреНрдпрд╛ рдХреНрд▓рд┐рдХрдЬреИрдХрд┐рдВрдЧ рд╣рдорд▓рд╛ рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИ рдпрд╛ рдирд╣реАрдВред
{% endhint %}

рдЗрди рдкреГрд╖реНрдареЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рдЗрди рдкреГрд╖реНрдареЛрдВ рдХреЛ **рдХреНрд▓рд┐рдХрдЬреИрдХрд┐рдВрдЧ** рдХреЗ рд▓рд┐рдП **рд╕рдВрднрд╛рд╡рд┐рдд рд╡рд┐рдХрд▓реНрдк** рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="browext-clickjacking.md" %}
[browext-clickjacking.md](browext-clickjacking.md)
{% endcontent-ref %}

{% hint style="success" %}
рдЗрди рдкреГрд╖реНрдареЛрдВ рдХреЛ рдХреЗрд╡рд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рджреНрд╡рд╛рд░рд╛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рдФрд░ рдХрд┐рд╕реА рднреА рдпреВрдЖрд░рдПрд▓ рджреНрд╡рд╛рд░рд╛ рдирд╣реАрдВ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреНрд▓рд┐рдХрдЬреИрдХрд┐рдВрдЧ рд╣рдорд▓реЛрдВ рд╕реЗ рдмрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

{% hint style="danger" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **`web_accessible_resources`** рд╕реЗ рдкреГрд╖реНрда рдФрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдЕрдиреНрдп рдкреГрд╖реНрда рднреА **рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо** рд╣реИрдВред рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЗрдирдореЗрдВ рд╕реЗ рдХреЛрдИ рднреА рдкреГрд╖реНрда **XSS** рдХреЗ рд▓рд┐рдП рд╡рдВрд░реНрдгрдирд╢реАрд▓ рд╣реИ рддреЛ рдпрд╣ рдПрдХ рдмрдбрд╝реА рд╕рдВрдХреНрд░рдордг рдХреЛ рдЦреЛрд▓ рд╕рдХрддрд╛ рд╣реИред

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк рдХреЗрд╡рд▓ рдЗрдлреНрд░реЗрдореНрд╕ рдХреЗ рдЕрдВрджрд░ **`web_accessible_resources`** рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдкреГрд╖реНрда рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдПрдХ рдирдП рдЯреИрдм рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЖрдИрдбреА рдЬрд╛рдирддреЗ рд╣реБрдП рдХрд┐рд╕реА рднреА рдкреГрд╖реНрда рддрдХред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдПрдХ XSS рдорд┐рд▓рддрд╛ рд╣реИ рдФрд░ рдЙрд╕реА рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЙрд╕ рдкреГрд╖реНрда рдХреЛ **`web_accessible_resources`** рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рднреА рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

### `externally_connectable`

[**рджрд╕реНрддрд╛рд╡реЗрдЬрд╝**](https://developer.chrome.com/docs/extensions/reference/manifest/externally-connectable) рдХреЗ рдЕрдиреБрд╕рд╛рд░, `"externally_connectable"` рдореИрдирд┐рдлрд╝реЗрд╕реНрдЯ рдкреНрд░реЙрдкрд░реНрдЯреА рдШреЛрд╖рд┐рдд рдХрд░рддреА рд╣реИ **рдХреМрди рд╕реА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдФрд░ рд╡реЗрдм рдкреЗрдЬ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЖрдкрдХреА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ [runtime.connect](https://developer.chrome.com/docs/extensions/reference/runtime#method-connect) рдФрд░ [runtime.sendMessage](https://developer.chrome.com/docs/extensions/reference/runtime#method-sendMessage) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред

* рдпрджрд┐ **`externally_connectable`** рдХреБрдВрдЬреА рдЖрдкрдХреА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдореИрдирд┐рдлрд╝реЗрд╕реНрдЯ рдореЗрдВ рдШреЛрд╖рд┐рдд рдирд╣реАрдВ рд╣реИ рдпрд╛ рдпрд╣ **`"ids": ["*"]`** рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ **рд╕рднреА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдХреЛрдИ рднреА рд╡реЗрдм рдкреЗрдЬ рдХрдиреЗрдХреНрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛**ред
* рдпрджрд┐ **рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЖрдИрдбреА** рдШреЛрд╖рд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВ, рдЬреИрд╕реЗ `"ids": ["aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"]`, **рдХреЗрд╡рд▓ рд╡реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред
* рдпрджрд┐ **рдорд┐рд▓рд╛рди** рдШреЛрд╖рд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВ, рддреЛ рд╡реЗ рд╡реЗрдм рдРрдкреНрд╕ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХреЗрдВрдЧреЗ:
```json
"matches": [
"https://*.google.com/*",
"*://*.chromium.org/*",
```
* рдпрджрд┐ рдпрд╣ рдЦрд╛рд▓реА рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИ: **`"externally_connectable": {}`**, рдХреЛрдИ рднреА рдРрдк рдпрд╛ рд╡реЗрдм рдХрдиреЗрдХреНрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХреЗрдЧрд╛ред

рдпрд╣рд╛рдБ рдЬрд┐рддрдиреА рдХрдо рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдФрд░ рдпреВрдЖрд░рдПрд▓ рд╣реИрдВ, рдЙрддрдиреА рд╣реА **рд╣рдорд▓реЗ рдХреА рд╕рддрд╣ рдЫреЛрдЯреА** рд╣реЛрдЧреАред

{% hint style="danger" %}
рдпрджрд┐ рдХреЛрдИ рд╡реЗрдм рдкреЗрдЬ **XSS рдпрд╛ рдЯреЗрдХрдУрд╡рд░** рдХреЗ рд▓рд┐рдП **`externally_connectable`** рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ, рддреЛ рд╣рдорд▓рд╡рд╛рджреА рдХреЛ **рд╕рдВрджреЗрд╢ рд╕реАрдзреЗ рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдореЗрдВ рднреЗрдЬрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрдЧреА, рдкреВрд░реА рддрд░рд╣ рд╕реЗ **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рдЗрд╕рдХреА рд╕реАрдПрд╕рдкреА рдХреЛ рдЫреЛрдбрд╝рдХрд░**ред

рдЗрд╕рд▓рд┐рдП, рдпрд╣ рдПрдХ **рдмрд╣реБрдд рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдмрд╛рдпрдкрд╛рд╕** рд╣реИред

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрджрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдХ рд░реВрдЧ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрджреА рд╡рд╣ рд╡рд┐рдХрд▓реНрдкрд┐рдд рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ, рддреЛ рд╡рд╣ **рдПрдХ рдЕрдиреБрдордд рд╡реЗрдм рдкреЗрдЬ рдореЗрдВ XSS рдбреЗрдЯрд╛ рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ **`WebRequest`** рдпрд╛ **`DeclarativeNetRequest`** рдПрдкреАрдЖрдИ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдПрдХ рд▓рдХреНрд╖рд┐рдд рдбреЛрдореЗрди рдкрд░ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдореЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреГрд╖реНрда рдХреЗ рдЕрдиреБрд░реЛрдз рдХреЛ **рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлрд╝рд╛рдЗрд▓** рдХреЗ рд▓рд┐рдП рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИред (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд▓рдХреНрд╖рд┐рдд рдкреГрд╖реНрда рдкрд░ рд╕реАрдПрд╕рдкреА рдЗрди рд╣рдорд▓реЛрдВ рдХреЛ рд░реЛрдХ рд╕рдХрддреА рд╣реИ)ред рдпрд╣ рд╡рд┐рдЪрд╛рд░ [**рдЗрд╕ рд▓реЗрдЦ рд╕реЗ рдЖрддрд╛ рд╣реИ**](https://www.darkrelay.com/post/opera-zero-day-rce-vulnerability)ред
{% endhint %}

## рд╕рдВрдЪрд╛рд░ рд╕рд╛рд░рд╛рдВрд╢

### рдПрдХреНрд╕рдЯреЗрдВрд╢рди <--> рд╡реЗрдм рдРрдк

рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рд╡реЗрдм рдкреГрд╖реНрда рдХреЗ рдмреАрдЪ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдо рддреМрд░ рдкрд░ рд╕рдВрджреЗрд╢реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдЖрдк рдЖрдо рддреМрд░ рдкрд░ рдлрд╝рдВрдХреНрд╢рди **`window.postMessage`** рдХреЗ рдХреЙрд▓ рдФрд░ рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рд╕реБрдирдиреЗ рд╡рд╛рд▓реЗ рдЬреИрд╕реЗ **`window.addEventListener`** рджреЗрдЦреЗрдВрдЧреЗред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХреНрд╕рдЯреЗрдВрд╢рди рднреА **рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╕рд╛рде рд╕рдВрджреЗрд╢ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ** (рдФрд░ рдЗрд╕рд▓рд┐рдП рд╡реЗрдм рдХреЛ рдЗрд╕рдХреА рдЙрдореНрдореАрдж рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП) рдпрд╛ рдмрд╕ рд╡реЗрдм рдХреЛ рдПрдХ рдирдпрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдЕрдВрджрд░

рдЖрдо рддреМрд░ рдкрд░ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди **`chrome.runtime.sendMessage`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдЕрдВрджрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЖрдо рддреМрд░ рдкрд░ `background` рд╕реНрдХреНрд░рд┐рдкреНрдЯ рджреНрд╡рд╛рд░рд╛ рд╕рдВрднрд╛рд▓рд╛ рдЬрд╛рддрд╛ рд╣реИ) рдФрд░ рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдФрд░ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реБрдирдиреЗ рд╡рд╛рд▓рд╛ рдШреЛрд╖рдХ рдШреЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **`chrome.runtime.onMessage.addListener`** рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рд╣реЛрддрд╛ рд╣реИред

рдПрдХрд▓ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рдмрдЬрд╛рдп рдПрдХ рд╕реНрдерд╛рдпреА рдХрдиреЗрдХреНрд╢рди рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП **`chrome.runtime.connect()`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ, рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:

<details>

<summary><code>chrome.runtime.connect()</code> рдЙрджрд╛рд╣рд░рдг</summary>
```javascript
var port = chrome.runtime.connect();

// Listen for messages from the web page
window.addEventListener("message", (event) => {
// Only accept messages from the same window
if (event.source !== window) {
return;
}

// Check if the message type is "FROM_PAGE"
if (event.data.type && (event.data.type === "FROM_PAGE")) {
console.log("Content script received: " + event.data.text);
// Forward the message to the background script
port.postMessage({ type: 'FROM_PAGE', text: event.data.text });
}
}, false);

// Listen for messages from the background script
port.onMessage.addListener(function(msg) {
console.log("Content script received message from background script:", msg);
// Handle the response message from the background script
});
```
</details>

рдПрдХ рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реЗ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЯреИрдм рдореЗрдВ рд╕реНрдерд┐рдд рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдореИрд╕реЗрдЬ рднреЗрдЬрдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ **`chrome.tabs.sendMessage`** рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдЬрд╣рд╛рдВ рдЖрдкрдХреЛ рдореИрд╕реЗрдЬ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП **рдЯреИрдм рдХреА рдЖрдИрдбреА** рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред

### рдЕрдиреБрдордд `externally_connectable` рд╕реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рддрдХ

**рд╡реЗрдм рдРрдкреНрд╕ рдФрд░ рдмрд╛рд╣рд░реА рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕** рдЬреЛ `externally_connectable` рд╡рд┐рдиреНрдпрд╛рд╕ рдореЗрдВ рдЕрдиреБрдордд рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ:
```javascript
chrome.runtime.sendMessage(extensionId, ...
```
рдЬрд╣рд╛рдБ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЖрдИрдбреА** рдХреЛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

## рд╡реЗрдм **тЖФя╕О** рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдЪрд╛рд░
рдЬрд╣рд╛рдВ **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЬрд╣рд╛рдВ рдореЗрдЬрд╝рдмрд╛рди рдкреЗрдЬ рд╣реЛрддреЗ рд╣реИрдВ, рд╡реЗ рдПрдХ-рджреВрд╕рд░реЗ рд╕реЗ **рдЕрд▓рдЧ** рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ **рдЕрд▓рдЧрд╛рд╡** рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛрддрд╛ рд╣реИред рдЗрд╕ рдЕрд▓рдЧрд╛рд╡ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рджреЛрдиреЛрдВ рдХреЛ рдкреЗрдЬ рдХреЗ **рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдореЙрдбрд▓ (DOM)** рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИред рдореЗрдЬрд╝рдмрд╛рди рдкреЗрдЬ рдХреЛ **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╛ рдкреНрд░рд╕рд╛рд░рд┐рдд рд░реВрдк рд╕реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рджреЛрдиреЛрдВ рдкрдХреНрд╖реЛрдВ рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдВрдЪреА рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ **DOM** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдП рдЬреИрд╕реЗ рд╕рдВрдЪрд╛рд░ рдЪреИрдирд▓ред

### рдкреЛрд╕реНрдЯ рдореИрд╕реЗрдЬреЗрд╕

{% code title="content-script.js" %}
```javascript
// This is like "chrome.runtime.sendMessage" but to maintain the connection
var port = chrome.runtime.connect();

window.addEventListener("message", (event) => {
// We only accept messages from ourselves
if (event.source !== window) {
return;
}

if (event.data.type && (event.data.type === "FROM_PAGE")) {
console.log("Content script received: " + event.data.text);
// Forward the message to the background script
port.postMessage(event.data.text);
}
}, false);
```
{% endcode %}

{% code title="example.js" %}
```javascript
document.getElementById("theButton").addEventListener("click", () => {
window.postMessage(
{type : "FROM_PAGE", text : "Hello from the webpage!"}, "*");
}, false);
```
{% endcode %}

рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдкреЛрд╕реНрдЯ рд╕рдВрджреЗрд╢ рд╕рдВрдЪрд╛рд░ рдХреЛ рдкреНрд░рд╛рдкреНрдд рд╕рдВрджреЗрд╢ рдХреА рдорд╛рдиреНрдпрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП, рдпрд╣ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЪреЗрдХ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

* **`event.isTrusted`**: рдпрд╣ рдХреЗрд╡рд▓ рддрдм рд╕рдЪ рд╣реИ рдЕрдЧрд░ рдШрдЯрдирд╛ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░реЗрд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛
* рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрджреЗрд╢ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХреЗрд╡рд▓ рдЕрдЧрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛрдИ рдХреНрд░рд┐рдпрд╛ рдХрд░рддрд╛ рд╣реИ
* **рдореВрд▓ рд╕реНрдерд╛рди**: рд╕рдВрджреЗрд╢ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХреЗрд╡рд▓ рдбреЛрдореЗрди рдХреА рд╕реВрдЪреА рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИред
* рдпрджрд┐ рдПрдХ рд░реЗрдЧреЗрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдмрд╣реБрдд рд╕рд╛рд╡рдзрд╛рди рд░рд╣реЗрдВ
* **рд╕реНрд░реЛрдд**: `received_message.source !== window` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд╕рдВрджреЗрд╢ **рд╡рд╣реА рд╡рд┐рдВрдбреЛ рд╕реЗ** рдерд╛ рдЬрд╣рд╛рдВ рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реБрди рд░рд╣рд╛ рдерд╛ред

рдкрд┐рдЫрд▓реА рдЬрд╛рдВрдЪреЗрдВ, рдпрджреА рднреА рдХреА рдЧрдИ рд╣реЛрдВ, рднреА рд╡рд┐рдХрд▓реНрдкрд╢реАрд▓ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдореЗрдВ **рд╕рдВрднрд╛рд╡рд┐рдд рдкреЛрд╕реНрдЯ рд╕рдВрджреЗрд╢ рдмрд╛рдпрдкрд╛рд╕** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

{% content-ref url="../postmessage-vulnerabilities/" %}
[postmessage-vulnerabilities](../postmessage-vulnerabilities/)
{% endcontent-ref %}

### рдЖрдИрдлреНрд░реЗрдо

рдПрдХ рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рдВрдЪрд╛рд░ рдХрд╛ рддрд░реАрдХрд╛ **рдЖрдИрдлреНрд░реЗрдо URL** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

### DOM

рдпрд╣ "рдареАрдХ рдард╛рдХ" рдПрдХ рд╕рдВрдЪрд╛рд░ рддрд░реАрдХрд╛ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди **рд╡реЗрдм рдФрд░ рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╡реЗрдм DOM рддрдХ рдкрд╣реБрдВрдЪ рд╣реЛрдЧреА**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ **рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝ рд░рд╣рд╛ рд╣реИ, **рд╡реЗрдм DOM рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░рддрд╛ рд╣реИ**, рддреЛ рд╡реЗрдм **рдЗрд╕ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддрд╛ рд╣реИ (рдХреНрдпреЛрдВрдХрд┐ рд╡реЗрдм рдкрд░ рднрд░реЛрд╕рд╛ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдпрд╛ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗрдм XSS рдХреЗ рд▓рд┐рдП рд╡рдВрд╢рд╡рд╛рджреА рд╣реИ) рдФрд░ **рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдХреНрд╖рддрд┐ рдкрд╣реБрдВрдЪрд╛ рд╕рдХрддрд╛ рд╣реИ**ред

рдЖрдк рдПрдХ **рдбреАрдУрдПрдо рдЖрдзрд╛рд░рд┐рдд XSS рдХрд╛ рдЙрджрд╛рд╣рд░рдг рднреА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдХреНрд╖рддрд┐ рдкрд╣реБрдВрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП** рдореЗрдВ:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ **тЖФя╕О** рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдЪрд╛рд░

рдПрдХ рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлрд╝рдВрдХреНрд╢рди [**runtime.sendMessage()**](https://developer.chrome.com/docs/extensions/reference/runtime#method-sendMessage) **рдпрд╛** [**tabs.sendMessage()**](https://developer.chrome.com/docs/extensions/reference/tabs#method-sendMessage) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдПрдХ **рдПрдХ-рдмрд╛рд░ рдХрд╛ JSON-рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрдмрд▓** рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред

**рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рд╡рд╛рдкрд╕реА **рдкреНрд░реЙрдорд┐рд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкрд┐рдЫрд▓реЗ рд╕рдВрдЧрддрддрд╛ рдХреЗ рд▓рд┐рдП, рдЖрдк рдЕрдм рднреА рдЖрдЦрд┐рд░реА рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ **рдХреЙрд▓рдмреИрдХ** рдкрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

**рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рд╕реЗ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдирд╛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рджрд┐рдЦрддрд╛ рд╣реИ:
```javascript
(async () => {
const response = await chrome.runtime.sendMessage({greeting: "hello"});
// do something with response here, not outside the function
console.log(response);
})();
```
**рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рд╕реЗ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдирд╛ (рд╕рд╛рдорд╛рдиреНрдпрдд: рдПрдХ **рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рд╕реНрдХреНрд░рд┐рдкреНрдЯ**). рдЪрдпрдирд┐рдд рдЯреИрдм рдореЗрдВ рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХрд╛ рдЙрджрд╛рд╣рд░рдг:
```javascript
// From https://stackoverflow.com/questions/36153999/how-to-send-a-message-between-chrome-extension-popup-and-content-script
(async () => {
const [tab] = await chrome.tabs.query({active: true, lastFocusedWindow: true});
const response = await chrome.tabs.sendMessage(tab.id, {greeting: "hello"});
// do something with response here, not outside the function
console.log(response);
})();
```
**рдкреНрд░рд╛рдкреНрддрд┐ рд╕реНрдерд┐рддрд┐** рдкрд░, рдЖрдкрдХреЛ рд╕рдВрджреЗрд╢ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП [**runtime.onMessage**](https://developer.chrome.com/docs/extensions/reference/runtime#event-onMessage) **рдШрдЯрдирд╛ рд╕реБрдирдиреЗ рд╡рд╛рд▓рд╛** рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдпрд╣ рдПрдХ рд╕рд╛рдордЧреНрд░реА рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкреЗрдЬ рд╕реЗ рдПрдХ рдЬреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИред
```javascript
// From https://stackoverflow.com/questions/70406787/javascript-send-message-from-content-js-to-background-js
chrome.runtime.onMessage.addListener(
function(request, sender, sendResponse) {
console.log(sender.tab ?
"from a content script:" + sender.tab.url :
"from the extension");
if (request.greeting === "hello")
sendResponse({farewell: "goodbye"});
}
);
```
рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, **`sendResponse()`** рдХреЛ рд╕рдорд╡рд░реНрддреА рдврдВрдЧ рд╕реЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред `sendResponse()` рдХреЛ рдЕрд╕рдорд╡рд░реНрддреА рдврдВрдЧ рд╕реЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `return true;` рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рдЕрддреНрдпрд╛рд╡рд╢реНрдпрдХ рд╣реИред

рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рдЪрд╛рд░ рд╣реИ рдХрд┐ рдЬрд╣рд╛рдВ рдХрдИ рдкреГрд╖реНрда `onMessage` рдШрдЯрдирд╛рдПрдБ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд┐рдП рдЧрдП рд╣реИрдВ, **рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдШрдЯрдирд╛ рдХреЗ рд▓рд┐рдП `sendResponse()` рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдкрд╣рд▓рд╛ рдкреГрд╖реНрда** рдХреЗрд╡рд▓ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛ред рдПрдХ рд╣реА рдШрдЯрдирд╛ рдХреЗ рд▓рд┐рдП рдХрд┐рд╕реА рднреА рдЖрдЧрд╛рдореА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рдзреНрдпрд╛рди рдореЗрдВ рдирд╣реАрдВ рд▓реА рдЬрд╛рдПрдВрдЧреАред

рдирдП рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдмрдирд╛рддреЗ рд╕рдордп, рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдкреНрд░рдорд╛рдгреЛрдВ рдХреЛ рдкреНрд░рдорд┐рд╕реЗрд╕ рдХреА рдУрд░ рдмрдврд╝рд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдХреЙрд▓рдмреИрдХреНрд╕ рдХреА рдмрдЬрд╛рдпред рдХреЙрд▓рдмреИрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ, `sendResponse()` рдлрд╝рдВрдХреНрд╢рди рдХреЗрд╡рд▓ рддрднреА рдорд╛рдиреНрдп рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдЕрдЧрд░ рдпрд╣ рд╕рдорд╡рд░реНрддреА рд╕рдВрджрд░реНрдн рдореЗрдВ рд╕реАрдзреЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдпрд╛ рдпрджрд┐ рдШрдЯрдирд╛ рд╣реИрдВрдбрд▓рд░ рдПрдХ рдЕрд╕рдорд╡рд░реНрддреА рдХрд╛рд░реНрдп рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ `true` рд▓реМрдЯрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдХреЛрдИ рднреА рд╣реИрдВрдбрд▓рд░ `true` рдирд╣реАрдВ рд▓реМрдЯрд╛рддрд╛ рд╣реИ рдпрд╛ рдпрджрд┐ `sendResponse()` рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдореЗрдореЛрд░реА рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЧрд╛рд░реНрдмреЗрдЬ-рдХрд▓реЗрдХреНрдЯреЗрдб), рддреЛ `sendMessage()` рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рд╕рдВрдмрдВрдзрд┐рдд рдХреЙрд▓рдмреИрдХ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрдЧрд╛ред
```bash
extension_id=your_extension_id   # Replace with the actual extension ID
curl -L -o "$extension_id.zip" "https://clients2.google.com/service/update2/crx?response=redirect&os=mac&arch=x86-64&nacl_arch=x86-64&prod=chromecrx&prodchannel=stable&prodversion=44.0.2403.130&x=id%3D$extension_id%26uc"
unzip -d "$extension_id-source" "$extension_id.zip"
```
### рдПрд╕реАрдЖрд░рдПрдХреНрд╕ рд╡реНрдпреВрдЕрд░ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

[https://robwu.nl/crxviewer/](https://robwu.nl/crxviewer/)

### рдПрд╕реАрдЖрд░рдПрдХреНрд╕ рд╡реНрдпреВрдЕрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

рдПрдХ рдФрд░ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рддрд░реАрдХрд╛ рд╣реИ рдХреНрд░реЛрдо рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕реЛрд░реНрд╕ рд╡реНрдпреВрдЕрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛, рдЬреЛ рдПрдХ рдУрдкрди-рд╕реЛрд░реНрд╕ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╣реИред рдЗрд╕реЗ [рдХреНрд░реЛрдо рд╡реЗрдм рд╕реНрдЯреЛрд░ рд╕реЗ](https://chrome.google.com/webstore/detail/chrome-extension-source-v/jifpbeccnghkjeaalbbjmodiffmgedin?hl=en) рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╡реНрдпреВрдЕрд░ рдХрд╛ рд╕реЛрд░реНрд╕ рдХреЛрдб рдЗрд╕рдХреЗ [GitHub рднрдВрдбрд╛рд░](https://github.com/Rob--W/crxviewer) рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИред

### рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХреА рдЧрдИ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рд╕реЛрд░реНрд╕ рджреЗрдЦреЗрдВ

рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХреА рдЧрдИ рдХреНрд░реЛрдо рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдЬрд╛рдВрдЪ рднреА рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЗ рд╕реЗ:

1. "рдкреНрд░реЛрдлрд╛рдЗрд▓ рдкрде" рдлреАрд▓реНрдб рдХреЛ рдвреВрдВрдврдХрд░ `chrome://version/` рдкрд░ рдЬрд╛рдХрд░ рдЕрдкрдиреЗ рдХреНрд░реЛрдо рд╕реНрдерд╛рдиреАрдп рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рддрдХ рдкрд╣реБрдВрдЪреЗрдВред
2. рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рдЕрдВрджрд░ `Extensions/` рдЙрдкрдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдЬрд╛рдПрдВред
3. рдпрд╣ рдЙрдкрдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕рднреА рдЗрдВрд╕реНрдЯреЙрд▓ рдХреА рдЧрдИ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдХреЛ рд╕рдореЗрддрддрд╛ рд╣реИ, рдЬреЛ рд╕рд╛рдорд╛рдиреНрдпрдд: рдЙрдирдХреЗ рд╕реЛрд░реНрд╕ рдХреЛрдб рдХреЛ рдПрдХ рдкрдардиреАрдп рд╕реНрд╡рд░реВрдк рдореЗрдВ рд░рдЦрддреЗ рд╣реИрдВред

рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдЙрдирдХреЗ рдЖрдИрдбреА рдХреЛ рдирд╛рдореЛрдВ рд╕реЗ рдореИрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* `about:extensions` рдкреГрд╖реНрда рдкрд░ "рдбреЗрд╡рд▓рдкрд░ рдореЛрдб" рдХреЛ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ рддрд╛рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдЖрдИрдбреА рджреЗрдЦ рд╕рдХреЗрдВред
* рдкреНрд░рддреНрдпреЗрдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рдЕрдВрджрд░, `manifest.json` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдПрдХ рдкрдардиреАрдп `рдирд╛рдо` рдлрд╝реАрд▓реНрдб рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдЖрдкрдХреЛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред

### рдлрд╝рд╛рдЗрд▓ рдЖрд░реНрдХрд╛рдЗрд╡рд░ рдпрд╛ рдЕрдирдкреИрдХрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

рдХреНрд░реЛрдо рд╡реЗрдм рд╕реНрдЯреЛрд░ рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдПрдХ `.crx` рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╣реЛрдЧрд╛ред рдлрд╝рд╛рдЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ `.zip` рдореЗрдВ рдмрджрд▓реЗрдВред рдХрд┐рд╕реА рднреА рдлрд╝рд╛рдЗрд▓ рдЖрд░реНрдХрд╛рдЗрд╡рд░ (рдЬреИрд╕реЗ WinRAR, 7-Zip, рдЖрджрд┐) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ ZIP рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдирд┐рдХрд╛рд▓реЗрдВред

### рдХреНрд░реЛрдо рдореЗрдВ рдбреЗрд╡рд▓рдкрд░ рдореЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

рдХреНрд░реЛрдо рдЦреЛрд▓реЗрдВ рдФрд░ `chrome://extensions/` рдкрд░ рдЬрд╛рдПрдВред рдКрдкрд░ рджрд╛рдПрдВ "рдбреЗрд╡рд▓рдкрд░ рдореЛрдб" рдХреЛ рд╕рдХреНрд╖рдо рдХрд░реЗрдВред "рдЕрдирдкреИрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓реЛрдб рдХрд░реЗрдВ..." рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред рдЕрдкрдиреА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рддрдХ рдкрд╣реБрдВрдЪреЗрдВред рдпрд╣ рд╕реЛрд░реНрд╕ рдХреЛрдб рдбрд╛рдЙрдирд▓реЛрдб рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рдкрд╣рд▓реЗ рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдпрд╛ рд╡рд┐рдХрд╕рд┐рдд рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдХреЛрдб рдХреЛ рджреЗрдЦрдиреЗ рдФрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред

## рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдЪреЗрдХрд▓рд┐рд╕реНрдЯ

рд╣рд╛рд▓рд╛рдВрдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдореЗрдВ **рд╕реАрдорд┐рдд рд╣рдорд▓реЗ рдХреНрд╖реЗрддреНрд░** рд╣реЛрддрд╛ рд╣реИ, рдХреБрдЫ рдореЗрдВ **рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖** рдпрд╛ **рд╕рдВрднрд╛рд╡рд┐рдд рдордЬрдмреВрддреА рдмрдврд╝рд╛рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛** рд╣реЛ рд╕рдХрддреА рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдмрд╕реЗ рд╕рд╛рдорд╛рдиреНрдп рд╣реИрдВ:

* [ ] **рдЕрдиреБрдорддрд┐рдпреЛрдВ** рдХреЛ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХреЗ **рдорд░реНрдпрд╛рджрд┐рдд** рдХрд░реЗрдВ
* [ ] **рдЕрдиреБрдорддрд┐рдпреЛрдВ** рдХреЛ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХреЗ **`host_permissions`** рдХрд░реЗрдВ
* **рдордЬрдмреВрдд** **`content_security_policy`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
* [ ] рдпрджрд┐ рдХреЛрдИ **`externally_connectable`** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рдФрд░ рд╕рдВрднрд╡ рд╣реИ, рддреЛ рдЗрд╕реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЫреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ **`{}`**
* рдпрджрд┐ **XSS рдпрд╛ рд▓реЗрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдХреЗрддрд╢реАрд▓ URL** рдпрд╣рд╛рдБ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **рд╕рдВрджреЗрд╢ рд▓реЗрдиреЗ рдХреА рдХреНрд╖рдорддрд╛** рд╣реЛрдЧреАред рдмрд╣реБрдд рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдмрд╛рдпрдкрд╛рд╕ред
* [ ] **`web_accessible_resources`** рдХреЛ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХреЗ **рдорд░реНрдпрд╛рджрд┐рдд** рдХрд░реЗрдВ, рдпрджрд┐ рд╕рдВрднрд╡ рд╣реЛ рддреЛ рдЦрд╛рд▓реА рднреАред
* рдпрджрд┐ **`web_accessible_resources`** рдХреЛ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ [**рдХреНрд▓рд┐рдХрдЬреИрдХрд┐рдВрдЧ**](browext-clickjacking.md) рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
* рдпрджрд┐ рдХрд┐рд╕реА **рд╕рдВрдЪрд╛рд░** рдХрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕реЗ **рд╡реЗрдм рдкреГрд╖реНрда** рдХреЗ рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ, [**XSS рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**](browext-xss-example.md) рдЬреЛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ **рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖** рдХрд╛ рдХрд╛рд░рдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
* рдпрджрд┐ рдкреЛрд╕реНрдЯ рдореИрд╕реЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ [**рдкреЛрд╕реНрдЯ рдореИрд╕реЗрдЬ рджреЛрд╖** рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ рдХрд░реЗрдВ](../postmessage-vulnerabilities/)**ред**
* рдпрджрд┐ **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдбреАрдУрдПрдо рд╡рд┐рд╡рд░рдг рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ**, рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рд╡реЗ рд╡реЗрдм рджреНрд╡рд╛рд░рд╛ **рд╕рдВрд╢реЛрдзрд┐рдд** рд╣реЛрдиреЗ рдкрд░ рдПрдХ XSS рдирд╣реАрдВ рд▓рд╛ рд░рд╣реЗ рд╣реИрдВ
* рд╡рд┐рд╢реЗрд╖ рдзреНрдпрд╛рди рджреЗрдВ рдпрджрд┐ рдпрд╣ рд╕рдВрдЪрд╛рд░ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИ **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ -> рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдЪрд╛рд░** рдореЗрдВ
* **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА** рдХреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди **рдХреЛрдб** рдореЗрдВ рдирд╣реАрдВ рд░рдЦрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП
* **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА** рдХреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди **рдореЗрдореЛрд░реА** рдореЗрдВ рдирд╣реАрдВ рд░рдЦрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП

## рдЙрдкрдХрд░рдг

### [**Tarnish**](https://thehackerblog.com/tarnish/)

* рдХрд┐рд╕реА рднреА рдХреНрд░реЛрдо рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдПрдХ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдХреНрд░реЛрдо рд╡реЗрдмрд╕реНрдЯреЛрд░ рд▓рд┐рдВрдХ рд╕реЗ рдЦреАрдВрдЪрддрд╛ рд╣реИред
* [**manifest.json**](https://developer.chrome.com/extensions/manifest) **рд╡реНрдпреВрдЕрд░**: рдмрд╕ рдПрдХ JSON-рд╕реБрдВрджрд░ рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддрд╛ рд╣реИ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдореИрдирд┐рдлреЗрд╕реНрдЯ рдХрд╛ред
* **рдлрд┐рдВрдЧрд░рдкреНрд░рд┐рдВрдЯ рд╡рд┐рд╢реНрд▓реЗрд╖рдг**: [web\_accessible\_resources](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдФрд░ рдХреНрд░реЛрдо рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдлрд┐рдВрдЧрд░рдкреНрд░рд┐рдВрдЯрд┐рдВрдЧ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрддреНрдкрд╛рджрдиред
* **рд╕рдВрднрд╛рд╡рд┐рдд рдХреНрд▓рд┐рдХрдЬреИрдХрд┐рдВрдЧ рд╡рд┐рд╢реНрд▓реЗрд╖рдг**: [web\_accessible\_resources](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) рдирд┐рд░реНрджреЗрд╢рд┐рдд рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдПрдЪрдЯреАрдПрдордПрд▓ рдкреГрд╖реНрдареЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ред рдЗрдирдореЗрдВ рдХреНрд▓рд┐рдХрдЬреИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдпрджрд┐ рдкреГрд╖реНрдареЛрдВ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╣реИред
* **рдЕрдиреБрдорддрд┐ рдЪреЗрддрд╛рд╡рдиреА рд╡реНрдпреВрдЕрд░**: рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдкрд░ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдХреНрд░реЛрдо рдЕрдиреБрдорддрд┐ рдкреНрд░реЙрдореНрдкреНрдЯ рдЪреЗрддрд╛рд╡рдирд┐рдпреЛрдВ рдХреА рд╕реВрдЪреА рджрд┐рдЦрд╛рддрд╛ рд╣реИред
* **рдЦрддрд░рдирд╛рдХ рдХрд╛рд░реНрдп(рдПрд╕)**: рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╢рд╛рдпрдж рд╢реЛрд╖рд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рдЦрддрд░рдирд╛рдХ рдХрд╛рд░реНрдпреЛрдВ рдХреА рд╕реНрдерд╛рди рджрд┐рдЦрд╛рддрд╛ рд╣реИ (рдЬреИрд╕реЗ innerHTML, chrome.tabs.executeScript рдЬреИрд╕реЗ рдХрд╛рд░реНрдп)ред
* **рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ(рдПрд╕)**: рдпрд╣ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╣рд╛рдБ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рдмрд╛рд╣реНрдп рдЗрдирдкреБрдЯ рд▓реЗрддрд╛ рд╣реИред рдпрд╣ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рддрд╣ рдХреНрд╖реЗрддреНрд░ рдХреЛ рд╕рдордЭрдиреЗ рдФрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд╕рдВрднрд╛рд╡рд┐рдд рдмрд┐рдВрджреБрдУрдВ рдХреА рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред
* рдЦрддрд░рдирд╛рдХ рдХрд╛рд░реНрдп(рдПрд╕) рдФрд░ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ(рдПрд╕) рд╕реНрдХреИрдирд░реНрд╕ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИрдВ:
* рд╕рдВрдмрдВрдзрд┐рдд рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ рдФрд░ рдЕрд▓рд░реНрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдкрдВрдХ
* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдХреЛ PRs рдЬрдорд╛ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
