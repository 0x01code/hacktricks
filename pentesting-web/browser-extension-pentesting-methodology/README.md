# рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдердбреЛрд▓реЙрдЬреА

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди JavaScript рдореЗрдВ рд▓рд┐рдЦреЗ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рджреНрд╡рд╛рд░рд╛ рдкреГрд╖реНрдарднреВрдорд┐ рдореЗрдВ рд▓реЛрдб рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдЕрдкрдирд╛ [DOM](https://www.w3schools.com/js/js_htmldom.asp) рд╣реЛрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдпрд╣ рдЕрдиреНрдп рд╕рд╛рдЗрдЯреЛрдВ рдХреЗ DOMs рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрд╣ рдЕрдиреНрдп рд╕рд╛рдЗрдЯреЛрдВ рдХреА рдЧреЛрдкрдиреАрдпрддрд╛, рдЕрдЦрдВрдбрддрд╛, рдФрд░ рдЙрдкрд▓рдмреНрдзрддрд╛ (CIA) рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

## рдореБрдЦреНрдп рдШрдЯрдХ

рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рд▓реЗрдЖрдЙрдЯ рджреЗрдЦрдиреЗ рдореЗрдВ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫреА рд▓рдЧрддреА рд╣реИ рдЬрдм рдЗрд╕реЗ рджреГрд╢реНрдпрд╛рддреНрдордХ рд░реВрдк рд╕реЗ рджреЗрдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рддреАрди рдШрдЯрдХ рд╣реЛрддреЗ рд╣реИрдВред рдЖрдЗрдП рдкреНрд░рддреНрдпреЗрдХ рдШрдЯрдХ рдХреЛ рдЧрд╣рд░рд╛рдИ рд╕реЗ рджреЗрдЦреЗрдВред

<figure><img src="../../.gitbook/assets/image.png" alt=""><figcaption><p><a href="http://webblaze.cs.berkeley.edu/papers/Extensions.pdf">http://webblaze.cs.berkeley.edu/papers/Extensions.pdf</a></p></figcaption></figure>

### **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕**

рдкреНрд░рддреНрдпреЗрдХ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ **рдПрдХрд▓ рд╡реЗрдм рдкреЗрдЬ** рдХреЗ DOM рддрдХ рд╕реАрдзреА рдкрд╣реБрдВрдЪ рд╣реЛрддреА рд╣реИ рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдпрд╣ **рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдЗрдирдкреБрдЯ** рдХреЗ рд▓рд┐рдП рдЙрдЬрд╛рдЧрд░ рд╣реЛрддреА рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдХреЛрдИ рдЕрдиреБрдорддрд┐рдпрд╛рдВ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИрдВред

рдХреНрд░реЛрдо рдореЗрдВ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЛ рджреЗрдЦрдиреЗ рдФрд░ рдбрд┐рдмрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдХреНрд░реЛрдо рдбреЗрд╡рд▓рдкрд░ рдЯреВрд▓реНрд╕ рдореЗрдиреВ рдХреЛ рд╡рд┐рдХрд▓реНрдк > рдЕрдзрд┐рдХ рдЙрдкрдХрд░рдг > рдбреЗрд╡рд▓рдкрд░ рдЯреВрд▓реНрд╕ рд╕реЗ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ (Ctrl + Shift + I рджрдмрд╛рдПрдВ)ред

рдбреЗрд╡рд▓рдкрд░ рдЯреВрд▓реНрд╕ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрдиреЗ рдХреЗ рд╕рд╛рде, **рд╕реЛрд░реНрд╕ рдЯреИрдм** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдлрд┐рд░ **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕** рдЯреИрдм рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред рдпрд╣рд╛рдВ рдЖрдк рд╡рд┐рднрд┐рдиреНрди рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреЛрдВ рдХреА рдЪрд▓ рд░рд╣реА рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдкреНрд░рд╡рд╛рд╣ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХреЗ рд▓рд┐рдП рдмреНрд░реЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдордиреЗ Wappalyzer рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рджрд┐рдЦрд╛рдпрд╛ рд╣реИред

<figure><img src="../../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

### **рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░**

рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рдореЗрдВ рдЕрдзрд┐рдХрд╛рдВрд╢ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░/рдкрд╣реБрдВрдЪ рд╣реЛрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рдХреЗрд╡рд▓ [XMLHttpRequest](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest) рдФрд░ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реЗрдм рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рд╕рд╛рде рд╣реА, рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рдХреЛ рд╣реЛрд╕реНрдЯ рдорд╢реАрди рддрдХ рд╕реАрдзреА рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред

### **рдиреЗрдЯрд┐рд╡ рдмрд╛рдЗрдирд░реА**

рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдПрдХ рдиреЗрдЯрд┐рд╡ рдмрд╛рдЗрдирд░реА рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреВрд░реА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рд╣реЛрд╕реНрдЯ рдорд╢реАрди рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИред** рдиреЗрдЯрд┐рд╡ рдмрд╛рдЗрдирд░реА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рдХреЗ рд╕рд╛рде рдорд╛рдирдХ Netscape Plugin Application Programming Interface ([NPAPI](https://en.wikipedia.org/wiki/NPAPI)) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░рддреА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдлреНрд▓реИрд╢ рдФрд░ рдЕрдиреНрдп рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдкреНрд▓рдЧ-рдЗрдиреНрд╕ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

### рд╕реАрдорд╛рдПрдВ

{% hint style="danger" %}
рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреВрд░реА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рддрдХ рдФрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ рд╕реЗ рдиреЗрдЯрд┐рд╡ рдмрд╛рдЗрдирд░реА рддрдХ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдЗрдирдкреБрдЯ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордирд╛рдирд╛ рд╣реЛрдЧрд╛ред
{% endhint %}

рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдШрдЯрдХ рдХреЛ рдПрдХ рджреВрд╕рд░реЗ рд╕реЗ **рдордЬрдмреВрдд рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХ рд╕реАрдорд╛рдУрдВ** рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рдШрдЯрдХ рдПрдХ **рдЕрд▓рдЧ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рдХреНрд░рд┐рдпрд╛** рдореЗрдВ рдЪрд▓рддрд╛ рд╣реИред рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдФрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛрд░ **рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ** рдореЗрдВ рдЪрд▓рддреЗ рд╣реИрдВ рдЬреЛ рдЕрдзрд┐рдХрд╛рдВрд╢ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдкрд▓рдмреНрдз рд╣реЛрддреЗ рд╣реИрдВред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдЕрдкрдиреЗ рд╕рдВрдмрдВрдзрд┐рдд рд╡реЗрдм рдкреЗрдЬреЛрдВ рд╕реЗ **рдПрдХ рдЕрд▓рдЧ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реАрдк рдореЗрдВ рдЪрд▓рдХрд░** рдЕрд▓рдЧ рд╣реЛрддреА рд╣реИрдВред рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рд╡реЗрдм рдкреЗрдЬ рдХреЗ рдкрд╛рд╕ **рдПрдХ рд╣реА рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд DOM рддрдХ рдкрд╣реБрдВрдЪ** рд╣реЛрддреА рд╣реИ, рд▓реЗрдХрд┐рди рджреЛрдиреЛрдВ рдХрднреА рднреА рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреЙрдЗрдВрдЯрд░реНрд╕ рдХрд╛ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рд▓реАрдХ рд╣реЛрдирд╛ рд░реЛрдХрд╛ рдЬрд╛рддрд╛ рд╣реИред

## **`manifest.json`**

рдПрдХ рдХреНрд░реЛрдо рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕рд┐рд░реНрдл рдПрдХ ZIP рдлреЛрд▓реНрдбрд░ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ [.crx рдлрд╛рдЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди](https://www.lifewire.com/crx-file-2620391) рд╣реЛрддрд╛ рд╣реИред рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдХреЛрд░ **`manifest.json`** рдлрд╛рдЗрд▓ рд╣реЛрддреА рд╣реИ рдЬреЛ рдлреЛрд▓реНрдбрд░ рдХреА рдЬрдбрд╝ рдореЗрдВ рд╣реЛрддреА рд╣реИ, рдЬреЛ рд▓реЗрдЖрдЙрдЯ, рдЕрдиреБрдорддрд┐рдпрд╛рдВ, рдФрд░ рдЕрдиреНрдп рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреА рд╣реИред

рдЙрджрд╛рд╣рд░рдг:
```json
{
"manifest_version": 2,
"name": "My extension",
"version": "1.0",
"permissions": [
"storage"
],
"content_scripts": [
{
"js": [
"script.js"
],
"matches": [
"https://example.com/*",
"https://www.example.com/*"
],
"exclude_matches": ["*://*/*business*"],
}
],
"background": {
"scripts": [
"background.js"
]
},
"options_ui": {
"page": "options.html"
}
}
```
### `content_scripts`

Content scripts рддрдм **рд▓реЛрдб** рд╣реЛрддреЗ рд╣реИрдВ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдорд┐рд▓рд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреГрд╖реНрда рдкрд░ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рддрд╛ рд╣реИ**, рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдХреЛрдИ рднреА рдкреГрд╖реНрда рдЬреЛ **`https://example.com/*`** рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ рдФрд░ **`*://*/*/business*`** regex рд╕реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИред рд╡реЗ **рдкреГрд╖реНрда рдХреЗ рдЕрдкрдиреЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреА рддрд░рд╣** рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдкреГрд╖реНрда рдХреЗ [Document Object Model (DOM)](https://developer.mozilla.org/en-US/docs/Web/API/Document\_Object\_Model) рддрдХ рдордирдорд╛рдиреА рдкрд╣реБрдБрдЪ рд╣реЛрддреА рд╣реИред&#x20;
```json
"content_scripts": [
{
"js": [
"script.js"
],
"matches": [
"https://example.com/*",
"https://www.example.com/*"
],
"exclude_matches": ["*://*/*business*"],
}
],
```
рдЕрдзрд┐рдХ URLs рд╢рд╛рдорд┐рд▓ рдпрд╛ рдмрд╛рд╣рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **`include_globs`** рдФрд░ **`exclude_globs`** рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рд╕рдВрднрд╡ рд╣реИред

рдпрд╣ рдПрдХ рдЙрджрд╛рд╣рд░рдг content script рд╣реИ рдЬреЛ рдкреЗрдЬ рдореЗрдВ рдПрдХ explain рдмрдЯрди рдЬреЛрдбрд╝ рджреЗрдЧрд╛ рдЬрдм [the storage API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ extension рдХреЗ storage рд╕реЗ `message` рдорд╛рди рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
```js
chrome.storage.local.get("message", result =>
{
let div = document.createElement("div");
div.innerHTML = result.message + " <button>Explain</button>";
div.querySelector("button").addEventListener("click", () =>
{
chrome.runtime.sendMessage("explain");
});
document.body.appendChild(div);
});
```
<figure><img src="../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

рдЬрдм рдЗрд╕ рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ content script [**runtime.sendMessage() API**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage) **рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрджреЗрд╢ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкреЗрдЬреЗрд╕ рдХреЛ рднреЗрдЬрддрд╛ рд╣реИ**ред рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ content script рдХреЗрд╡рд▓ рдХреБрдЫ APIs рдЬреИрд╕реЗ рдХрд┐ `storage` рддрдХ рд╕реАрдзреА рдкрд╣реБрдБрдЪ рд░рдЦрддрд╛ рд╣реИред рдмрд╛рдХреА рд╕рдм рдХреБрдЫ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкреЗрдЬреЗрд╕ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рдиреНрд╣реЗрдВ content scripts рд╕рдВрджреЗрд╢ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="warning" %}
**Content script рдХреНрд╖рдорддрд╛рдПрдВ** рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдереЛрдбрд╝реА рднрд┐рдиреНрди рд╣реЛрддреА рд╣реИрдВред Chromium-рдЖрдзрд╛рд░рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдХреЗ рд▓рд┐рдП рдЖрдк рд╕реВрдЪреА [Chrome Developers documentation](https://developer.chrome.com/docs/extensions/mv3/content\_scripts/#capabilities) рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ, Firefox рдХреЗ рд▓рд┐рдП [MDN](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Content\_scripts#webextension\_apis) рдЕрдВрддрд┐рдо рд╕реНрд░реЛрдд рд╣реИред\
рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ Content Script **background scripts рдХреЗ рд╕рд╛рде рднреА рд╕рдВрд╡рд╛рдж рдХрд░ рд╕рдХрддрд╛ рд╣реИ** рддрд╛рдХрд┐ рд╡реЗ рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░ рд╕рдХреЗрдВ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╡рд╛рдкрд╕ рднреЗрдЬ рд╕рдХреЗрдВред
{% endhint %}

### Injected content scripts

{% hint style="success" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **Content Scripts рдЕрдирд┐рд╡рд╛рд░реНрдп рдирд╣реАрдВ рд╣реИрдВ** рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ **рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ** scripts рдХреЛ **inject** рдХрд┐рдпрд╛ рдЬрд╛рдП рдФрд░ рд╡реЗрдм рдкреЗрдЬреЗрд╕ рдореЗрдВ **`tabs.executeScript`** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ inject** рдХрд┐рдпрд╛ рдЬрд╛рдПред рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЕрдзрд┐рдХ **рд╡рд┐рд╕реНрддреГрдд рдирд┐рдпрдВрддреНрд░рдг** рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
{% endhint %}

Content script рдХреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ inject рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдЙрд╕ рдкреЗрдЬ рдХреЗ рд▓рд┐рдП [host permissions](https://developer.chrome.com/docs/extensions/reference/permissions) рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдпрд╣ scripts рдХреЛ inject рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣рд╛ рд╣реИред Host permissions рдпрд╛ рддреЛ рдЖрдкрдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ manifest рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ **рдорд╛рдВрдЧрдХрд░** рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ рдпрд╛ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ [**activeTab**](https://developer.chrome.com/docs/extensions/reference/manifest/activeTab)** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред**

#### рдЙрджрд╛рд╣рд░рдг activeTab-рдЖрдзрд╛рд░рд┐рдд рдПрдХреНрд╕рдЯреЗрдВрд╢рди

{% code title="manifest.json" %}
```json
{
"name": "My extension",
...
"permissions": [
"activeTab",
"scripting"
],
"background": {
"service_worker": "background.js"
},
"action": {
"default_title": "Action Button"
}
}
```
{% endcode %}

* **рдХреНрд▓рд┐рдХ рдкрд░ JS рдлрд╝рд╛рдЗрд▓ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ:**
```javascript
// content-script.js
document.body.style.backgroundColor = "orange";

//service-worker.js - Inject the JS file
chrome.action.onClicked.addListener((tab) => {
chrome.scripting.executeScript({
target: { tabId: tab.id },
files: ["content-script.js"]
});
});
```
* **рдПрдХ рдлрдВрдХреНрд╢рди рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ** рдХреНрд▓рд┐рдХ рдкрд░:
```javascript
//service-worker.js - Inject a function
function injectedFunction() {
document.body.style.backgroundColor = "orange";
}

chrome.action.onClicked.addListener((tab) => {
chrome.scripting.executeScript({
target : {tabId : tab.id},
func : injectedFunction,
});
});
```
#### рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдЙрджрд╛рд╣рд░рдг
```javascript
// service-workser.js
chrome.scripting.registerContentScripts([{
id : "test",
matches : [ "https://*.nytimes.com/*" ],
excludeMatches : [ "*://*/*business*" ],
js : [ "contentScript.js" ],
}]);

// ANother example
chrome.tabs.executeScript(tabId, { file: "content_script.js" });
```
рдЕрдзрд┐рдХ URLs рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рдиреЗ рдпрд╛ рдмрд╛рд╣рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **`include_globs`** рдФрд░ **`exclude_globs`** рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### Content Scripts `run_at`

`run_at` рдлрд╝реАрд▓реНрдб рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ **рдЬрдм JavaScript рдлрд╝рд╛рдЗрд▓реЗрдВ рд╡реЗрдм рдкреЗрдЬ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХреА рдЬрд╛рддреА рд╣реИрдВ**ред рдкрд╕рдВрджреАрджрд╛ рдФрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди `"document_idle"` рд╣реИред

рд╕рдВрднрд╛рд╡рд┐рдд рдорд╛рди рд╣реИрдВ:

* **`document_idle`**: рдЬрдм рднреА рд╕рдВрднрд╡ рд╣реЛ
* **`document_start`**: `css` рд╕реЗ рдХреЛрдИ рднреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЖрдиреЗ рдХреЗ рдмрд╛рдж, рд▓реЗрдХрд┐рди рдХрд┐рд╕реА рдЕрдиреНрдп DOM рдХреЗ рдирд┐рд░реНрдорд╛рдг рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рдЪрд▓рдиреЗ рд╕реЗ рдкрд╣рд▓реЗред
* **`document_end`**: DOM рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж, рд▓реЗрдХрд┐рди рдЗрдореЗрдЬреЗрд╕ рдФрд░ рдлреНрд░реЗрдореНрд╕ рдЬреИрд╕реЗ рд╕рдмрд░рд┐рд╕реЛрд░реНрд╕реЗрдЬ рд▓реЛрдб рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗред

#### `manifest.json` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ
```json
{
"name": "My extension",
...
"content_scripts": [
{
"matches": ["https://*.nytimes.com/*"],
"run_at": "document_idle",
"js": ["contentScript.js"]
}
],
...
}

```
Via **`service-worker.js`**
```javascript
chrome.scripting.registerContentScripts([{
id : "test",
matches : [ "https://*.nytimes.com/*" ],
runAt : "document_idle",
js : [ "contentScript.js" ],
}]);
```
### `рдкреГрд╖реНрдарднреВрдорд┐`

рдЬрдм рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЛрдИ рд╕рдВрджреЗрд╢ рднреЗрдЬрддреА рд╣реИрдВ, рддреЛ рдЙрд╕рдХрд╛ рдЧрдВрддрд╡реНрдп **рдкреГрд╖реНрдарднреВрдорд┐ рдкреГрд╖реНрда** рд╣реЛрддрд╛ рд╣реИред рдкреГрд╖реНрдарднреВрдорд┐ рдкреГрд╖реНрда рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкреГрд╖реНрда рд╣реЛрддрд╛ рд╣реИ рдЬреЛ **рд╣рдореЗрд╢рд╛ рдореМрдЬреВрдж** рд╣реЛрддрд╛ рд╣реИ, рдЬрдм рддрдХ рдХрд┐ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореИрдирд┐рдлреЗрд╕реНрдЯ рдореЗрдВ рдЕрдиреНрдпрдерд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рди рд╣реЛред рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдЕрджреГрд╢реНрдп рд╣реЛрддрд╛ рд╣реИ, рдмрд╛рд╡рдЬреВрдж рдЗрд╕рдХреЗ рдХрд┐ рдпрд╣ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдкреГрд╖реНрда рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЕрдкрдирд╛ DOM рдФрд░ рд╕рдм рдХреБрдЫ рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдХрд╛рд░реНрдп рдЖрдорддреМрд░ рдкрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдЕрдиреНрдп рд╕рднреА рднрд╛рдЧреЛрдВ рдХрд╛ рд╕рдордиреНрд╡рдп рдХрд░рдирд╛ рд╣реЛрддрд╛ рд╣реИред

{% hint style="success" %}
рдпрджрд┐ рдкреГрд╖реНрдарднреВрдорд┐ рдкреГрд╖реНрда рдХреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдШреЛрд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕рд╣рд╛рдпрдХ рд░реВрдк рд╕реЗ **рдПрдХ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдЧрд╛** рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдЧрд╛ рдХрд┐ рд╕рднреА **рдШреЛрд╖рд┐рдд рдкреГрд╖реНрдарднреВрдорд┐ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдЙрд╕рдореЗрдВ рд▓реЛрдб рдХреА рдЧрдИ рд╣реИрдВ**, рдЬреИрд╕реЗ рдХрд┐ рдкрд┐рдЫрд▓реЗ manifest.json рдЙрджрд╛рд╣рд░рдг рдореЗрдВред
{% endhint %}

рдкреГрд╖реНрдарднреВрдорд┐ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрджрд╛рд╣рд░рдг:
```js
chrome.runtime.onMessage.addListener((request, sender, sendResponse) =>
{
if (request == "explain")
{
chrome.tabs.create({ url: "https://example.net/explanation" });
}
})
```
рдпрд╣ [runtime.onMessage API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage) рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд╕реБрдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред рдЬрдм рдПрдХ `"explain"` рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ [tabs API](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдирдП рдЯреИрдм рдореЗрдВ рдкреЗрдЬ рдЦреЛрд▓рддрд╛ рд╣реИред

### рд╡рд┐рдХрд▓реНрдк рдкреГрд╖реНрда рдФрд░ рдЕрдиреНрдп

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреГрд╖реНрда рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:

* **рдПрдХреНрд╢рди рдкреГрд╖реНрда** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЖрдЗрдХрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдкрд░ **рдбреНрд░реЙрдк-рдбрд╛рдЙрди рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд** рд╣реЛрддреЗ рд╣реИрдВред
* рдкреГрд╖реНрда рдЬреЛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди **рдирдП рдЯреИрдм рдореЗрдВ рд▓реЛрдб рдХрд░реЗрдЧрд╛**ред
* **рд╡рд┐рдХрд▓реНрдк рдкреГрд╖реНрда**: рдпрд╣ рдкреГрд╖реНрда рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдкрд░ рдКрдкрд░ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИред рдкрд┐рдЫрд▓реЗ рдореЗрдирд┐рдлреЗрд╕реНрдЯ рдореЗрдВ рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдореИрдВ рдЗрд╕ рдкреГрд╖реНрда рддрдХ `chrome://extensions/?options=fadlhnelkbeojnebcbkacjilhnbjfjca` рдкрд░ рдпрд╛ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдкрд╣реБрдБрдЪ рд╕рдХрддрд╛ рдерд╛:

<figure><img src="../../.gitbook/assets/image (8).png" alt="" width="375"><figcaption></figcaption></figure>

рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рдкреГрд╖реНрда рдХреЗ рд╡рд┐рдкрд░реАрдд, рдпреЗ рдкреГрд╖реНрда рд╕реНрдерд╛рдпреА рдирд╣реАрдВ рд╣реЛрддреЗ рдмрд▓реНрдХрд┐ рдЬрд░реВрд░рдд рдкрдбрд╝рдиреЗ рдкрд░ рд▓реЛрдб рд╣реЛрддреЗ рд╣реИрдВред рдлрд┐рд░ рднреА рдЗрди рд╕рднреА рдХреЛ **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рд╕реЗ рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ**ред рдФрд░ рдЗрди рд╕рднреА рдХреЛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди-рд╡рд┐рд╢рд┐рд╖реНрдЯ APIs рддрдХ **рдкреВрд░реА рдкрд╣реБрдБрдЪ рд╣реЛрддреА рд╣реИ**, рдЬрд┐рддрдирд╛ рдХрд┐ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВред

рдХреБрд▓ рдорд┐рд▓рд╛рдХрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╕рдВрджрд░реНрдн рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддреЗ рд╣реИрдВ:

<figure><img src="../../.gitbook/assets/image (9).png" alt="" width="563"><figcaption></figcaption></figure>

### `permissions` & `host_permissions`

**`permissions`** рдФрд░ **`host_permissions`** `manifest.json` рд╕реЗ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рд╣реИрдВ рдЬреЛ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдВрдЧреА **рдХрд┐рди рдЕрдиреБрдорддрд┐рдпреЛрдВ** рдХреЗ рд▓рд┐рдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╣реИ (storage, location...) рдФрд░ **рдХрд┐рди рд╡реЗрдм рдкреГрд╖реНрдареЛрдВ** рдореЗрдВред

рдЪреВрдВрдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЗрддрдиреЗ **рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдпрд╛ рд╕рдордЭреМрддрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╣рдорд▓рд╛рд╡рд░ рдХреЛ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдЪреБрд░рд╛рдиреЗ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд░ рдЬрд╛рд╕реВрд╕реА рдХрд░рдиреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╕рд╛рдзрди рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред

рджреЗрдЦреЗрдВ рдХрд┐ рдпреЗ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреА рд╣реИрдВ рдФрд░ рдЗрдирдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХреИрд╕реЗ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

{% content-ref url="browext-permissions-and-host_permissions.md" %}
[browext-permissions-and-host_permissions.md](browext-permissions-and-host_permissions.md)
{% endcontent-ref %}

### `content_security_policy`

рдПрдХ **рдХрдВрдЯреЗрдВрдЯ рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдкреЙрд▓рд┐рд╕реА** рднреА `manifest.json` рдХреЗ рдЕрдВрджрд░ рдШреЛрд╖рд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдЕрдЧрд░ рдПрдХ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╣реИ, рддреЛ рдпрд╣ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓** рд╣реЛ рд╕рдХрддреА рд╣реИред

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкреГрд╖реНрдареЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗрдЯрд┐рдВрдЧ рдХрд╛рдлреА рдкреНрд░рддрд┐рдмрдВрдзрд╛рддреНрдордХ рд╣реИ:
```bash
script-src 'self'; object-src 'self';
```
CSP рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рдмрд╛рдИрдкрд╛рд╕ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{% content-ref url="../content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../content-security-policy-csp-bypass/)
{% endcontent-ref %}

### `web_accessible_resources`

рдПрдХ рд╡реЗрдмрдкреЗрдЬ рдХреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдкреЗрдЬ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП `.html` рдкреЗрдЬ, рдЗрд╕ рдкреЗрдЬ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ **`web_accessible_resources`** рдлреАрд▓реНрдб рдореЗрдВ `manifest.json` рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```javascript
{
...
"web_accessible_resources": [
{
"resources": [ "images/*.png" ],
"matches": [ "https://example.com/*" ]
},
{
"resources": [ "fonts/*.woff" ],
"matches": [ "https://example.com/*" ]
}
],
...
}
```
рдпреЗ рдкреГрд╖реНрда URL рдХреА рддрд░рд╣ рд╕реБрд▓рдн рд╣реИрдВ:
```
chrome-extension://<extension-id>/message.html
```
рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ **extension-id рд╕реБрд▓рдн рд╣реЛрддреА рд╣реИ**:

<figure><img src="../../.gitbook/assets/image (722).png" alt="" width="375"><figcaption></figcaption></figure>

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдЧрд░ `manifest.json` рдкреИрд░рд╛рдореАрдЯрд░ **`use_dynamic_url`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ **id рдЧрддрд┐рд╢реАрд▓ рд╣реЛ рд╕рдХрддреА рд╣реИ**ред

рдЗрди рдкреГрд╖реНрдареЛрдВ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрдиреЗ рд╕реЗ рдпреЗ рдкреГрд╖реНрда **рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ ClickJacking рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛрддреЗ рд╣реИрдВ**:

{% content-ref url="browext-clickjacking.md" %}
[browext-clickjacking.md](browext-clickjacking.md)
{% endcontent-ref %}

{% hint style="success" %}
рдЗрди рдкреГрд╖реНрдареЛрдВ рдХреЛ рдХреЗрд╡рд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рджреНрд╡рд╛рд░рд╛ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдФрд░ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ URLs рджреНрд╡рд╛рд░рд╛ рдирд╣реАрдВ, ClickJacking рд╣рдорд▓реЛрдВ рдХреЛ рд░реЛрдХ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

### `externally_connectable`

[**рджрд╕реНрддрд╛рд╡реЗрдЬрд╝**](https://developer.chrome.com/docs/extensions/reference/manifest/externally-connectable) рдХреЗ рдЕрдиреБрд╕рд╛рд░, `"externally_connectable"` рдореИрдирд┐рдлреЗрд╕реНрдЯ рдкреНрд░реЙрдкрд░реНрдЯреА рдШреЛрд╖рд┐рдд рдХрд░рддреА рд╣реИ **рдХреМрди рд╕реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдФрд░ рд╡реЗрдм рдкреГрд╖реНрда рдЖрдкрдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕реЗ [runtime.connect](https://developer.chrome.com/docs/extensions/reference/runtime#method-connect) рдФрд░ [runtime.sendMessage](https://developer.chrome.com/docs/extensions/reference/runtime#method-sendMessage) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬреБрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ**ред

* рдЕрдЧрд░ **`externally_connectable`** рдХреБрдВрдЬреА рдЖрдкрдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдореИрдирд┐рдлреЗрд╕реНрдЯ рдореЗрдВ **рдирд╣реАрдВ** рдШреЛрд╖рд┐рдд рдХреА рдЧрдИ рд╣реИ рдпрд╛ рдЗрд╕реЗ **`"ids": ["*"]`** рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, **рд╕рднреА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЬреБрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдХреЛрдИ рднреА рд╡реЗрдм рдкреГрд╖реНрда рдирд╣реАрдВ рдЬреБрдбрд╝ рд╕рдХрддрд╛**ред
* рдЕрдЧрд░ **рд╡рд┐рд╢рд┐рд╖реНрдЯ IDs рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХреА рдЧрдИ рд╣реИрдВ**, рдЬреИрд╕реЗ рдХрд┐ `"ids": ["aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"]`, **рдХреЗрд╡рд▓ рд╡реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧ** рдЬреБрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред
* рдЕрдЧрд░ **рдореИрдЪреЗрд╕** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рдЧрдП рд╣реИрдВ, рддреЛ рд╡реЗ рд╡реЗрдм рдРрдкреНрд╕ рдЬреБрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ:
```json
"matches": [
"https://*.google.com/*",
"*://*.chromium.org/*",
```
* рдпрджрд┐ рдЗрд╕реЗ рдЦрд╛рд▓реА рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: **`"externally_connectable": {}`**, рдХреЛрдИ рднреА рдРрдк рдпрд╛ рд╡реЗрдм рдХрдиреЗрдХреНрдЯ рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдЧрд╛ред

рдпрд╣рд╛рдБ рдкрд░ **рдХрдо рд╕реЗ рдХрдо рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдФрд░ URLs** рдЗрдВрдЧрд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рддрдирд╛ рдХрдо рд╣реЛрдЧрд╛, **рд╣рдорд▓реЗ рдХреА рд╕рддрд╣ рдЙрддрдиреА рд╣реА рдЫреЛрдЯреА** рд╣реЛрдЧреАред

{% hint style="danger" %}
рдпрджрд┐ рдХреЛрдИ рд╡реЗрдм рдкреЗрдЬ **XSS рдпрд╛ рдЯреЗрдХрдУрд╡рд░ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓** рд╣реИ рдФрд░ рдЙрд╕реЗ **`externally_connectable`** рдореЗрдВ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рд╕реАрдзреЗ **background script рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо** рд╣реЛрдЧрд╛, Content Script рдФрд░ рдЙрд╕рдХреЗ CSP рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рджрд░рдХрд┐рдирд╛рд░ рдХрд░рддреЗ рд╣реБрдПред

рдЗрд╕рд▓рд┐рдП, рдпрд╣ рдПрдХ **рдмрд╣реБрдд рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдмрд╛рдИрдкрд╛рд╕** рд╣реИред
{% endhint %}

## рд╡реЗрдм **тЖФя╕О** Content Script рд╕рдВрдЪрд╛рд░

рд╣рд╛рд▓рд╛рдВрдХрд┐ **content scripts рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╣реЛрд╕реНрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреЗрдЬреЛрдВ** рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рд╡рд╛рддрд╛рд╡рд░рдг рдПрдХ рджреВрд╕рд░реЗ рд╕реЗ **рдЕрд▓рдЧ** рд╣реЛрддреЗ рд╣реИрдВ, рд╡реЗ **рдкреЗрдЬ рдХреЗ DOM рддрдХ рдкрд╣реБрдБрдЪ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВ**ред рдпрджрд┐ рдкреЗрдЬ content script рдХреЗ рд╕рд╛рде, рдпрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде content script рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡рд╛рдж рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рд╕рд╛рдЭрд╛ DOM** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

### Post Messages

{% code title="content-script.js" %}
```javascript
var port = chrome.runtime.connect();

window.addEventListener("message", (event) => {
// We only accept messages from ourselves
if (event.source !== window) {
return;
}

if (event.data.type && (event.data.type === "FROM_PAGE")) {
console.log("Content script received: " + event.data.text);
port.postMessage(event.data.text);
}
}, false);
```
{% endcode %}

{% code title="example.js" %}
```javascript
document.getElementById("theButton").addEventListener("click", () => {
window.postMessage(
{type : "FROM_PAGE", text : "Hello from the webpage!"}, "*");
}, false);
```
{% endcode %}

рд╕реБрд░рдХреНрд╖рд┐рдд Post Message рд╕рдВрдЪрд╛рд░ рдХреЛ рдкреНрд░рд╛рдкреНрдд рд╕рдВрджреЗрд╢ рдХреА рдкреНрд░рд╛рдорд╛рдгрд┐рдХрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП, рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

* **`event.isTrusted`**: рдпрд╣ рдХреЗрд╡рд▓ рддрдм рд╕рдЪ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдШрдЯрдирд╛ рдХрд┐рд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдЯреНрд░рд┐рдЧрд░ рдХреА рдЧрдИ рд╣реЛ
* рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╢рд╛рдпрдж рдХреЗрд╡рд▓ рддрдм рд╕рдВрджреЗрд╢ рдХреА рдЙрдореНрдореАрдж рд╣реЛрддреА рд╣реИ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреБрдЫ рдХреНрд░рд┐рдпрд╛ рдХрд░рддрд╛ рд╣реИ
* **origin domain**: рдЗрд╕реЗ рдбреЛрдореЗрдиреНрд╕ рдХреА рдЕрдиреБрдорддрд┐ рд╕реВрдЪреА рдХреЗ рдЦрд┐рд▓рд╛рдл рдЬрд╛рдВрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* рдпрджрд┐ рдПрдХ regex рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдмрд╣реБрдд рд╕рд╛рд╡рдзрд╛рди рд░рд╣реЗрдВ
* **Source**: `received_message.source !== window` рдХрд╛ рдЙрдкрдпреЛрдЧ рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рд╕рдВрджреЗрд╢ **рдЙрд╕реА рд╡рд┐рдВрдбреЛ рд╕реЗ рдерд╛** рдЬрд╣рд╛рдВ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕реБрди рд░рд╣реА рд╣реИред

рдкрд┐рдЫрд▓реА рдЬрд╛рдВрдЪреЗрдВ, рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдЕрдЧрд░ рдХреА рдЧрдИ рд╣реИрдВ, рддреЛ рднреА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдореЗрдВ **рд╕рдВрднрд╛рд╡рд┐рдд Post Message рдмрд╛рдпрдкрд╛рд╕** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

{% content-ref url="../postmessage-vulnerabilities/" %}
[postmessage-vulnerabilities](../postmessage-vulnerabilities/)
{% endcontent-ref %}

### Iframe

рд╕рдВрдЪрд╛рд░ рдХрд╛ рдПрдХ рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рддрд░реАрдХрд╛ **Iframe URLs** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЖрдк рдПрдХ рдЙрджрд╛рд╣рд░рдг рдпрд╣рд╛рдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

### DOM

рдпрд╣ "рдмрд┐рд▓реНрдХреБрд▓" рд╕рдВрдЪрд╛рд░ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди **рд╡реЗрдм рдФрд░ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╡реЗрдм DOM рддрдХ рдкрд╣реБрдВрдЪ рд╣реЛрдЧреА**ред рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдЗрд╕рд╕реЗ рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝ рд░рд╣реА рд╣реИ, **рд╡реЗрдм DOM рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░рддреЗ рд╣реБрдП**, рд╡реЗрдм рдЗрд╕ **рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддрд╛ рд╣реИ (рдХреНрдпреЛрдВрдХрд┐ рд╡реЗрдм рдкрд░ рднрд░реЛрд╕рд╛ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдпрд╛ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗрдм XSS рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИ) рдФрд░ **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред

рдЖрдк **DOM рдЖрдзрд╛рд░рд┐рдд XSS рдХрд╛ рдЙрджрд╛рд╣рд░рдг рдЬреЛ рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ** рдпрд╣рд╛рдВ рднреА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдореЗрдореЛрд░реА/рдХреЛрдб рдореЗрдВ

рдпрджрд┐ рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЕрдкрдиреА рдореЗрдореЛрд░реА рдХреЗ рдЕрдВрджрд░ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИ**, рддреЛ рдЗрд╕реЗ **рдбрдВрдк рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** (рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ Windows рдорд╢реАрдиреЛрдВ рдореЗрдВ) рдФрд░ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреА **рдЦреЛрдЬ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ**ред

рдЗрд╕рд▓рд┐рдП, рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдореЗрдореЛрд░реА рдХреЛ **рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рдорд╛рдирд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП** рдФрд░ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА** рдЬреИрд╕реЗ рдХрд┐ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдпрд╛ рдореНрдиреЗрдореЛрдирд┐рдХ рд╡рд╛рдХреНрдпрд╛рдВрд╢реЛрдВ рдХреЛ **рд╕реНрдЯреЛрд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП**ред

рдмреЗрд╢рдХ, **рдХреЛрдб рдореЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рди рдбрд╛рд▓реЗрдВ**, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ** рд╣реЛрдЧреАред

## рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ **тЖФя╕О** рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╕рдВрдЪрд╛рд░

рдПрдХ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ [**runtime.sendMessage()**](https://developer.chrome.com/docs/extensions/reference/runtime#method-sendMessage) **рдпрд╛** [**tabs.sendMessage()**](https://developer.chrome.com/docs/extensions/reference/tabs#method-sendMessage) рдлрдВрдХреНрд╢рдиреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ **рдПрдХ рдмрд╛рд░ рдХрд╛ JSON-рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрдмрд▓** рд╕рдВрджреЗрд╢ рднреЗрдЬ рд╕рдХрддреА рд╣реИред

**рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рд▓реМрдЯрд╛рдП рдЧрдП **Promise** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкрд┐рдЫрд▓реА рд╕рдВрдЧрддрддрд╛ рдХреЗ рд▓рд┐рдП, рдЖрдк рдЕрднреА рднреА рдЕрдВрддрд┐рдо рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ **callback** рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдПрдХ **рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рд╕реЗ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдирд╛ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ:
```javascript
(async () => {
const response = await chrome.runtime.sendMessage({greeting: "hello"});
// do something with response here, not outside the function
console.log(response);
})();
```
рдПрдХ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди** (рдЖрдорддреМрд░ рдкрд░ рдПрдХ **рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рд╕реНрдХреНрд░рд┐рдкреНрдЯ**) рд╕реЗ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рднреЗрдЬрдирд╛ рдЗрд╕реА рддрд░рд╣ рд╣реЛрддрд╛ рд╣реИ, рд╕рд┐рд╡рд╛рдп рдЗрд╕рдХреЗ рдХрд┐ рдЖрдкрдХреЛ рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕ рдЯреИрдм рдореЗрдВ рдЗрд╕реЗ рднреЗрдЬрдирд╛ рд╣реИред рдпрд╣ рдЙрджрд╛рд╣рд░рдг рдЪрдпрдирд┐рдд рдЯреИрдм рдореЗрдВ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддрд╛ рд╣реИред
```javascript
(async () => {
const [tab] = await chrome.tabs.query({active: true, lastFocusedWindow: true});
const response = await chrome.tabs.sendMessage(tab.id, {greeting: "hello"});
// do something with response here, not outside the function
console.log(response);
})();
```
**рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЫреЛрд░** рдкрд░, рдЖрдкрдХреЛ рд╕рдВрджреЗрд╢ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ [**runtime.onMessage**](https://developer.chrome.com/docs/extensions/reference/runtime#event-onMessage) **рдЗрд╡реЗрдВрдЯ рд▓рд┐рд╕рдирд░** рд╕реЗрдЯ рдЕрдк рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдпрд╣ рдПрдХ рдХрдВрдЯреЗрдВрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдпрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкреЗрдЬ рд╕реЗ рджреЗрдЦрдиреЗ рдореЗрдВ рд╕рдорд╛рди рд▓рдЧрддрд╛ рд╣реИред
```javascript
chrome.runtime.onMessage.addListener(
function(request, sender, sendResponse) {
console.log(sender.tab ?
"from a content script:" + sender.tab.url :
"from the extension");
if (request.greeting === "hello")
sendResponse({farewell: "goodbye"});
}
);
```
рдЙрдкрд░реЛрдХреНрдд рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, **`sendResponse()`** рдХреЛ рд╕рдордХрд╛рд▓рд┐рдХ рд░реВрдк рд╕реЗ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдпрджрд┐ рдЖрдк **рдЕрд╕рдордХрд╛рд▓рд┐рдХ** рд░реВрдк рд╕реЗ `sendResponse()` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ `onMessage` рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ рдореЗрдВ `return true;` рдЬреЛрдбрд╝реЗрдВред

> рдпрджрд┐ рдХрдИ рдкреГрд╖реНрда `onMessage` рдЗрд╡реЗрдВрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд╕реБрди рд░рд╣реЗ рд╣реИрдВ, **рдХреЗрд╡рд▓ рдкрд╣рд▓реЗ рдХреЙрд▓ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ `sendResponse()`** рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢реЗрд╖ рдЗрд╡реЗрдВрдЯ рдореЗрдВ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рднреЗрдЬрдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрдЧрд╛ред рдЙрд╕ рдЗрд╡реЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рд╕рднреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдЕрдирджреЗрдЦреА рдХреА рдЬрд╛рдПрдВрдЧреАред

рдирдП рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХреЙрд▓рдмреИрдХ рдХреЗ рдмрдЬрд╛рдп рдкреНрд░реЙрдорд┐рд╕реЗрд╕ рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджреЗрдиреА рдЪрд╛рд╣рд┐рдПред рдпрджрд┐ рдЖрдк рдХреЙрд▓рдмреИрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ `sendResponse()` рдХреЙрд▓рдмреИрдХ рдХреЗрд╡рд▓ рддрднреА рдорд╛рдиреНрдп рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЗрд╕реЗ рд╕рдордХрд╛рд▓рд┐рдХ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╛ рдпрджрд┐ рдЗрд╡реЗрдВрдЯ рд╣реИрдВрдбрд▓рд░ `true` рд▓реМрдЯрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рджрд░реНрд╢рд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдХрд┐ рдпрд╣ рдЕрд╕рдордХрд╛рд▓рд┐рдХ рд░реВрдк рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдЧрд╛ред `sendMessage()` рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдХреЙрд▓рдмреИрдХ рд╕реНрд╡рддрдГ рд╣реА рдЖрдордВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдпрджрд┐ рдХреЛрдИ рд╣реИрдВрдбрд▓рд░реНрд╕ true рдирд╣реАрдВ рд▓реМрдЯрд╛рддреЗ рд╣реИрдВ рдпрд╛ рдпрджрд┐ `sendResponse()` рдХреЙрд▓рдмреИрдХ рдХреЛ рдЧрд╛рд░реНрдмреЗрдЬ-рдХрд▓реЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

## рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓реЛрдб рдХрд░рдирд╛

1. **рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░реЗрдВ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдФрд░ рдЕрдирдЬрд╝рд┐рдк рдХрд░реЗрдВ
2. **`chrome://extensions/`** рдкрд░ рдЬрд╛рдПрдВ рдФрд░ `Developer Mode` **рд╕рдХреНрд╖рдо** рдХрд░реЗрдВ
3. **`Load unpacked`** рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ

**Firefox** рдореЗрдВ рдЖрдк **`about:debugging#/runtime/this-firefox`** рдкрд░ рдЬрд╛рдПрдВ рдФрд░ **`Load Temporary Add-on`** рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

## рд╕реНрдЯреЛрд░ рд╕реЗ рд╕реЛрд░реНрд╕ рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛

[**рдпрд╣рд╛рдБ рд╕реЗ**](https://gist.github.com/paulirish/78d6c1406c901be02c2d):

### рд╡рд┐рдХрд▓реНрдк 1: рдХрдорд╛рдВрдб-рд▓рд╛рдЗрди рдбрд╛рдЙрдирд▓реЛрдб рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЬрд╝рд┐рдк рдХреЗ рд░реВрдк рдореЗрдВ рдФрд░ рдирд┐рдХрд╛рд▓реЗрдВ

{% code overflow="wrap" %}
```bash
extension_id=jifpbeccnghkjeaalbbjmodiffmgedin   # change this ID
curl -L -o "$extension_id.zip" "https://clients2.google.com/service/update2/crx?response=redirect&os=mac&arch=x86-64&nacl_arch=x86-64&prod=chromecrx&prodchannel=stable&prodversion=44.0.2403.130&x=id%3D$extension_id%26uc"
unzip -d "$extension_id-source" "$extension_id.zip"
```
{% endcode %}

crxviewer рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж [рдЬрд╛рджреБрдИ рдбрд╛рдЙрдирд▓реЛрдб URL](https://github.com/Rob--W/crxviewer/blob/6113c25e3569e1ec59365ad9a177aa97e2bcda61/src/cws\_pattern.js#L27-L74) рдХреЗ рд▓рд┐рдПред

### рд╡рд┐рдХрд▓реНрдк 2: CRX Viewer рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

[https://robwu.nl/crxviewer/](https://robwu.nl/crxviewer/)

### рд╡рд┐рдХрд▓реНрдк 3: CRX Viewer рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

[Chrome extension source viewer](https://chrome.google.com/webstore/detail/chrome-extension-source-v/jifpbeccnghkjeaalbbjmodiffmgedin?hl=en) рдУрдкрди рд╕реЛрд░реНрд╕ рд╣реИ ([github repo](https://github.com/Rob--W/crxviewer)) рдФрд░ рдпрд╣ рдмрд╣реБрдд рдЖрд╕рд╛рди рдмрдирд╛рддрд╛ рд╣реИред

### рд╡рд┐рдХрд▓реНрдк 3: рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рд╕реНрд░реЛрдд рджреЗрдЦреЗрдВ

1. рдЕрдкрдиреЗ Chrome рд╕реНрдерд╛рдиреАрдп рдкреНрд░реЛрдлрд╛рдЗрд▓ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рдЦреЛрдЬреЗрдВред `chrome://version/` рдЦреЛрд▓реЗрдВ рдФрд░ "Profile Path:" рдлрд╝реАрд▓реНрдб рдвреВрдВрдвреЗрдВред рдЙрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдХреЛ рдЦреЛрд▓реЗрдВред
2. `Extensions/` рдЙрдкрдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдЦреЛрд▓реЗрдВ
3. рдпрд╣рд╛рдБ рдЖрдкрдХреЗ рд╕рднреА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╣реИрдВ, рдЖрдорддреМрд░ рдкрд░ рдкрдардиреАрдп рд╕реНрд░реЛрдд рдХреЗ рд╕рд╛рдеред

#### рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЖрдИрдбреА рдФрд░ рдирд╛рдореЛрдВ рдХреЗ рдмреАрдЪ рдореИрдкрд┐рдВрдЧ

* `about:extensions` рдкрд░, рдбреЗрд╡рд▓рдкрд░ рдореЛрдб рдХреЛ рдЪрд╛рд▓реВ рдХрд░реЗрдВ рдФрд░ рдЖрдк рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЗ рдиреАрдЪреЗ рдЖрдИрдбреА рджреЗрдЦреЗрдВрдЧреЗ
* `Extensions/` рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдХреЗ рдЕрдВрджрд░, manifest.json рдореЗрдВ рдкрдардиреАрдп `name` рдлрд╝реАрд▓реНрдб рд╣реЛрддрд╛ рд╣реИ

## рд╕реБрд░рдХреНрд╖рд╛ рдСрдбрд┐рдЯ рдЪреЗрдХрд▓рд┐рд╕реНрдЯ

рднрд▓реЗ рд╣реА рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА **рд╕реАрдорд┐рдд рдЕрдЯреИрдХ рд╕рд░рдлреЗрд╕** рд╣реЛрддреА рд╣реИ, рдХреБрдЫ рдореЗрдВ **рдХрдордЬреЛрд░рд┐рдпрд╛рдБ** рдпрд╛ **рд╕рдВрднрд╛рд╡рд┐рдд рд╣рд╛рд░реНрдбрдирд┐рдВрдЧ рд╕реБрдзрд╛рд░** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдмрд╕реЗ рдЖрдо рд╣реИрдВ:

* [ ] **рд╕реАрдорд┐рдд** рдХрд░реЗрдВ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ **`permissions`** рдХреА рдорд╛рдВрдЧ
* [ ] **рд╕реАрдорд┐рдд** рдХрд░реЗрдВ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ **`host_permissions`**
* [ ] рдПрдХ **рдордЬрдмреВрдд** **`content_security_policy`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
* [ ] **рд╕реАрдорд┐рдд** рдХрд░реЗрдВ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ **`externally_connectable`**, рдЕрдЧрд░ рдХреЛрдИ рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИ рдФрд░ рд╕рдВрднрд╡ рд╣реИ, рддреЛ рдЗрд╕реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рди рдЫреЛрдбрд╝реЗрдВ, **`{}`** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВ
* [ ] рдЕрдЧрд░ **URL XSS рдпрд╛ рдЯреЗрдХрдУрд╡рд░ рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓** рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рд╕реАрдзреЗ **рдкреГрд╖реНрдарднреВрдорд┐ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЛ рд╕рдВрджреЗрд╢ рднреЗрдЬрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛**ред рдмрд╣реБрдд рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдмрд╛рдИрдкрд╛рд╕ред
* [ ] **рд╕реАрдорд┐рдд** рдХрд░реЗрдВ рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ **`web_accessible_resources`**, рдпрд╣рд╛рдБ рддрдХ рдХрд┐ рдЦрд╛рд▓реА рдЕрдЧрд░ рд╕рдВрднрд╡ рд╣реЛред
* [ ] рдЕрдЧрд░ **`web_accessible_resources`** рдирд╣реАрдВ рд╣реИ, рддреЛ [**ClickJacking**](browext-clickjacking.md) рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░реЗрдВ
* [ ] рдЕрдЧрд░ рдХреЛрдИ **рд╕рдВрдЪрд╛рд░** рд╣реЛрддрд╛ рд╣реИ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рд╕реЗ **рд╡реЗрдм рдкреЗрдЬ** рддрдХ, [**XSS рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░реЗрдВ**](browext-xss-example.md) **рдХрдордЬреЛрд░рд┐рдпрд╛рдБ** рдЬреЛ рд╕рдВрдЪрд╛рд░ рдореЗрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред
* [ ] рдЕрдЧрд░ Post Messages рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИ, рддреЛ [**Post Message рдХрдордЬреЛрд░рд┐рдпреЛрдВ**](../postmessage-vulnerabilities/) рдХреЗ рд▓рд┐рдП рдЬрд╛рдБрдЪ рдХрд░реЗрдВред
* [ ] рдЕрдЧрд░ **Content Script DOM рд╡рд┐рд╡рд░рдгреЛрдВ** рддрдХ рдкрд╣реБрдБрдЪрддрд╛ рд╣реИ, рддреЛ рдЬрд╛рдБрдЪреЗрдВ рдХрд┐ рд╡реЗ **XSS рдкреЗрд╢ рдирд╣реАрдВ рдХрд░ рд░рд╣реЗ рд╣реИрдВ** рдЕрдЧрд░ рд╡реЗ **рд╡реЗрдм рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╢реЛрдзрд┐рдд** рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ
* [ ] рд╡рд┐рд╢реЗрд╖ рдЬреЛрд░ рджреЗрдВ рдЕрдЧрд░ рдпрд╣ рд╕рдВрдЪрд╛рд░ **Content Script -> Background script рд╕рдВрдЪрд╛рд░** рдореЗрдВ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИ
* [ ] **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП** рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди **рдХреЛрдб** рдХреЗ рдЕрдВрджрд░
* [ ] **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП** рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди **рдореЗрдореЛрд░реА** рдХреЗ рдЕрдВрджрд░

## рдЙрдкрдХрд░рдг

### [**Tarnish**](https://thehackerblog.com/tarnish/)

* рдХрд┐рд╕реА рднреА Chrome рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП Chrome рд╡реЗрдмрд╕реНрдЯреЛрд░ рд▓рд┐рдВрдХ рд╕реЗ рдЦреАрдВрдЪрддрд╛ рд╣реИред
* [**manifest.json**](https://developer.chrome.com/extensions/manifest) **рджрд░реНрд╢рдХ**: рдмрд╕ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдореИрдирд┐рдлреЗрд╕реНрдЯ рдХрд╛ JSON-рдкреНрд░реАрдЯрд┐рдлрд╛рдЗрдб рд╕рдВрд╕реНрдХрд░рдг рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **рдлрд┐рдВрдЧрд░рдкреНрд░рд┐рдВрдЯ рд╡рд┐рд╢реНрд▓реЗрд╖рдг**: [web\_accessible\_resources](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдФрд░ Chrome рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдлрд┐рдВрдЧрд░рдкреНрд░рд┐рдВрдЯрд┐рдВрдЧ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрддреНрдкрд╛рджрдиред
* **рд╕рдВрднрд╛рд╡рд┐рдд Clickjacking рд╡рд┐рд╢реНрд▓реЗрд╖рдг**: рдПрдХреНрд╕рдЯреЗрдВрд╢рди HTML рдкреГрд╖реНрдареЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдЬрд┐рдирдореЗрдВ [web\_accessible\_resources](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) рдирд┐рд░реНрджреЗрд╢ рд╕реЗрдЯ рд╣реИред рдпреЗ рдкреГрд╖реНрдареЛрдВ рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рдЖрдзрд╛рд░ рдкрд░ clickjacking рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИрдВред
* **рдЕрдиреБрдорддрд┐ рдЪреЗрддрд╛рд╡рдиреА(рдпрд╛рдБ) рджрд░реНрд╢рдХ**: рдЬреЛ рд╕рднреА Chrome рдЕрдиреБрдорддрд┐ рдкреНрд░реЙрдореНрдкреНрдЯ рдЪреЗрддрд╛рд╡рдирд┐рдпреЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╕рдордп рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрдЧреАред
* **рдЦрддрд░рдирд╛рдХ рдлрд╝рдВрдХреНрд╢рди(рдпрд╛рдБ)**: рдЦрддрд░рдирд╛рдХ рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХрд╛ рд╕реНрдерд╛рди рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╢реЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдЬреИрд╕реЗ рдХрд┐ innerHTML, chrome.tabs.executeScript рдЬреИрд╕реЗ рдлрд╝рдВрдХреНрд╢рди)ред
* **рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ(рдпрд╛рдБ)**: рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рдмрд╛рд╣рд░реА рдЗрдирдкреБрдЯ рдХрд╣рд╛рдБ рд▓реЗрддрд╛ рд╣реИред рдпрд╣ рдПрдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд░рдлреЗрд╕ рдХреНрд╖реЗрддреНрд░ рдХреЛ рд╕рдордЭрдиреЗ рдФрд░ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд░реВрдк рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдП рдЧрдП рдбреЗрдЯрд╛ рдХреЛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рднреЗрдЬрдиреЗ рдХреЗ рд╕рдВрднрд╛рд╡рд┐рдд рдмрд┐рдВрджреБрдУрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реИред
* рдЦрддрд░рдирд╛рдХ рдлрд╝рдВрдХреНрд╢рди(рдпрд╛рдБ) рдФрд░ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ(рдпрд╛рдБ) рд╕реНрдХреИрдирд░реНрд╕ рдХреЗ рд▓рд┐рдП рдЙрдирдХреЗ рдЙрддреНрдкрдиреНрди рдЕрд▓рд░реНрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ:
* рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ рдФрд░ рд▓рд╛рдЗрди рдЬрд┐рд╕рдиреЗ рдЕрд▓рд░реНрдЯ рдХрд╛ рдХрд╛рд░рдг рдмрдирд╛ред
* рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╡рд┐рд╡рд░рдгред
* рдХреЛрдб рд╡рд╛рд▓реА рдкреВрд░реА рд╕реНрд░реЛрдд рдлрд╝рд╛рдЗрд▓ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП "View File" рдмрдЯрдиред
* рдЕрд▓рд░реНрдЯреЗрдб рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрдеред
* рдЕрд▓рд░реНрдЯреЗрдб рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкреВрд░рд╛ Chrome рдПрдХреНрд╕рдЯреЗрдВрд╢рди URIред
* рдпрд╣ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдлрд╝рд╛рдЗрд▓ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ Background Page рд╕реНрдХреНрд░рд┐рдкреНрдЯ, Content Script, Browser Action, рдЖрджрд┐ред
* рдЕрдЧрд░ рдЦрддрд░рдирд╛рдХ рд▓рд╛рдЗрди рдПрдХ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╣реИ, рддреЛ рдЙрди рд╕рднреА рдкреГрд╖реНрдареЛрдВ рдХреЗ рдкрде рдЬрд╣рд╛рдБ рдпрд╣ рд╢рд╛рдорд┐рд▓ рд╣реИ рдФрд░ рдЗрди рдкреГрд╖реНрдареЛрдВ рдХрд╛ рдкреНрд░рдХрд╛рд░, рдФрд░ [web\_accessible\_resource](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) рд╕реНрдерд┐рддрд┐ред
* **Content Security Policy (CSP) рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рдФрд░ рдмрд╛рдИрдкрд╛рд╕ рдЬрд╛рдБрдЪрдХрд░реНрддрд╛**: рдпрд╣ рдЖрдкрдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ CSP рдореЗрдВ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдЧрд╛ рдФрд░ рдпрд╣ рднреА рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░реЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдЖрдкрдХреЗ CSP рдХреЛ рд╕рдлреЗрдж рд╕реВрдЪреАрдмрджреНрдз CDNs рдЖрджрд┐ рдХреЗ рдХрд╛рд░рдг рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рдХреЛрдИ рд╕рдВрднрд╛рд╡рд┐рдд рддрд░реАрдХреЗ рд╣реИрдВред
* **рдЬреНрдЮрд╛рдд рдХрдордЬреЛрд░ рд▓рд╛рдЗрдмреНрд░реЗрд░рд┐рдпрд╛рдБ**: рдпрд╣ [Retire.js](https://retirejs.github.io/retire.js/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬреНрдЮрд╛рдд-рдХрдордЬреЛрд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░рд┐рдпреЛрдВ рдХреЗ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдБрдЪ рдХрд░рддрд╛ рд╣реИред
* рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдФрд░ рд╕реНрд╡рд░реВрдкрд┐рдд рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред
* рдореВрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред
* рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдПрдХ рд╕реБрдВрджрд░реАрдХреГрдд рд╕рдВрд╕реНрдХрд░рдг рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ (рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕реБрдВрджрд░ HTML рдФрд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ)ред
* рд╕реНрдХреИрди рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХреИрд╢рд┐рдВрдЧ, рдПрдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕реНрдХреИрди рдЪрд▓рд╛рдиреЗ рдореЗрдВ рдкрд╣рд▓реА рдм
