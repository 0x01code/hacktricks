# Browser Extension Pentesting Methodology

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞–ø–∏—Å–∞–Ω—ñ –Ω–∞ JavaScript —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º –≤ —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ. –í–æ–Ω–∏ –º–∞—é—Ç—å —Å–≤—ñ–π [DOM](https://www.w3schools.com/js/js\_htmldom.asp), –∞–ª–µ –º–æ–∂—É—Ç—å –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ DOM —ñ–Ω—à–∏—Ö —Å–∞–π—Ç—ñ–≤. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –ø–æ—Ä—É—à–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å, —Ü—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å —Ç–∞ –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å (CIA) —ñ–Ω—à–∏—Ö —Å–∞–π—Ç—ñ–≤.

## –û—Å–Ω–æ–≤–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

–ú–∞–∫–µ—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω—å –≤–∏–≥–ª—è–¥–∞—é—Ç—å –∫—Ä–∞—â–µ, –∫–æ–ª–∏ —ó—Ö –≤—ñ–∑—É–∞–ª—ñ–∑—É–≤–∞—Ç–∏, —ñ —Å–∫–ª–∞–¥–∞—é—Ç—å—Å—è –∑ —Ç—Ä—å–æ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤. –î–∞–≤–∞–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ñ—à–µ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –∫–æ–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.

<figure><img src="../../.gitbook/assets/image (4) (1).png" alt=""><figcaption><p><a href="http://webblaze.cs.berkeley.edu/papers/Extensions.pdf">http://webblaze.cs.berkeley.edu/papers/Extensions.pdf</a></p></figcaption></figure>

### **–°—Ü–µ–Ω–∞—Ä—ñ—ó –≤–º—ñ—Å—Ç—É**

–ö–æ–∂–µ–Ω —Å—Ü–µ–Ω–∞—Ä—ñ–π –≤–º—ñ—Å—Ç—É –º–∞—î –ø—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ DOM **–æ–¥–Ω—ñ—î—ó –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏** —ñ —Ç–∏–º —Å–∞–º–∏–º –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –¥–ª—è **–ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –≤–≤–æ–¥—É**. –û–¥–Ω–∞–∫ —Å—Ü–µ–Ω–∞—Ä—ñ–π –≤–º—ñ—Å—Ç—É –Ω–µ –º–∞—î —ñ–Ω—à–∏—Ö –¥–æ–∑–≤–æ–ª—ñ–≤, –∫—Ä—ñ–º –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —è–¥—Ä—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

### **–Ø–¥—Ä–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è**

–Ø–¥—Ä–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –º—ñ—Å—Ç–∏—Ç—å –±—ñ–ª—å—à—ñ—Å—Ç—å –ø—Ä–∏–≤—ñ–ª–µ—ó–≤/–¥–æ—Å—Ç—É–ø—ñ–≤ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∞–ª–µ —è–¥—Ä–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –º–æ–∂–µ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –ª–∏—à–µ –∑ –≤–º—ñ—Å—Ç–æ–º –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏ —á–µ—Ä–µ–∑ [XMLHttpRequest](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest) —Ç–∞ —Å—Ü–µ–Ω–∞—Ä—ñ—ó –≤–º—ñ—Å—Ç—É. –ö—Ä—ñ–º —Ç–æ–≥–æ, —è–¥—Ä–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –Ω–µ –º–∞—î –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–∏.

### **–ù–∞—Ç–∏–≤–Ω–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª**

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—î –Ω–∞—Ç–∏–≤–Ω–æ–º—É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—É, —è–∫–∏–π –º–æ–∂–µ **–æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–∏ –∑ –ø–æ–≤–Ω–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**. –ù–∞—Ç–∏–≤–Ω–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –≤–∑–∞—î–º–æ–¥—ñ—î –∑ —è–¥—Ä–æ–º —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫—ñ–≤ Netscape ([NPAPI](https://en.wikipedia.org/wiki/NPAPI)), —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è Flash —Ç–∞ —ñ–Ω—à–∏–º–∏ –¥–æ–¥–∞—Ç–∫–∞–º–∏ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞.

### –ú–µ–∂—ñ

{% hint style="danger" %}
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–≤–Ω–∏—Ö –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π –≤–≤—ñ–¥ –≤—ñ–¥ —Å—Ü–µ–Ω–∞—Ä—ñ—é –≤–º—ñ—Å—Ç—É –¥–æ —è–¥—Ä–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ –≤—ñ–¥ —è–¥—Ä–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–æ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É.
{% endhint %}

–ö–æ–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –≤—ñ–¥–æ–∫—Ä–µ–º–ª–µ–Ω–∏–π –æ–¥–∏–Ω –≤—ñ–¥ –æ–¥–Ω–æ–≥–æ **–º—ñ—Ü–Ω–∏–º–∏ –∑–∞—Ö–∏—Å–Ω–∏–º–∏ –º–µ–∂–∞–º–∏**. –ö–æ–∂–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∞—Ü—é—î –≤ **–æ–∫—Ä–µ–º–æ–º—É –ø—Ä–æ—Ü–µ—Å—ñ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏**. –°—Ü–µ–Ω–∞—Ä—ñ—ó –≤–º—ñ—Å—Ç—É —Ç–∞ —è–¥—Ä–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø—Ä–∞—Ü—é—é—Ç—å –≤ **–ø—ñ—Å–æ—á–Ω–∏—Ü—è—Ö**, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏—Ö –¥–ª—è –±—ñ–ª—å—à–æ—Å—Ç—ñ —Å–ª—É–∂–± –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏.

–ö—Ä—ñ–º —Ç–æ–≥–æ, —Å—Ü–µ–Ω–∞—Ä—ñ—ó –≤–º—ñ—Å—Ç—É –≤—ñ–¥–æ–∫—Ä–µ–º–ª–µ–Ω—ñ –≤—ñ–¥ –ø–æ–≤'—è–∑–∞–Ω–∏—Ö –∑ –Ω–∏–º–∏ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **–∑–∞–ø—É—Å–∫—É –≤ –æ–∫—Ä–µ–º–æ–º—É –∫—É–ø—ñ JavaScript**. –°—Ü–µ–Ω–∞—Ä—ñ–π –≤–º—ñ—Å—Ç—É —Ç–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ –º–∞—é—Ç—å **–¥–æ—Å—Ç—É–ø –¥–æ –æ–¥–Ω–æ–≥–æ –π —Ç–æ–≥–æ –∂ DOM**, –∞–ª–µ –¥–≤–∞ **–Ω—ñ–∫–æ–ª–∏ –Ω–µ –æ–±–º—ñ–Ω—é—é—Ç—å—Å—è –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞–º–∏ JavaScript**, —â–æ –∑–∞–ø–æ–±—ñ–≥–∞—î –≤–∏—Ç–æ–∫—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ JavaScript.

## **`manifest.json`**

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome - —Ü–µ –ø—Ä–æ—Å—Ç–æ ZIP-–ø–∞–ø–∫–∞ –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º [.crx](https://www.lifewire.com/crx-file-2620391). –Ø–¥—Ä–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è - —Ü–µ —Ñ–∞–π–ª **`manifest.json`** —É –∫–æ—Ä–µ–Ω—ñ –ø–∞–ø–∫–∏, —è–∫–∏–π –≤–∫–∞–∑—É—î –º–∞–∫–µ—Ç, –¥–æ–∑–≤–æ–ª–∏ —Ç–∞ —ñ–Ω—à—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó.

–ü—Ä–∏–∫–ª–∞–¥:

```json
{
"manifest_version": 2,
"name": "My extension",
"version": "1.0",
"permissions": [
"storage"
],
"content_scripts": [
{
"js": [
"script.js"
],
"matches": [
"https://example.com/*",
"https://www.example.com/*"
],
"exclude_matches": ["*://*/*business*"],
}
],
"background": {
"scripts": [
"background.js"
]
},
"options_ui": {
"page": "options.html"
}
}
```

### `content_scripts`

–°—Ü–µ–Ω–∞—Ä—ñ—ó –≤–º—ñ—Å—Ç—É –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É, —É –Ω–∞—à–æ–º—É –≤–∏–ø–∞–¥–∫—É –±—É–¥—å-—è–∫—É —Å—Ç–æ—Ä—ñ–Ω–∫—É, —è–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤–∏—Ä–∞–∑—É `https://example.com/*`, —ñ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ä–µ–≥—É–ª—è—Ä–Ω–æ–º—É –≤–∏—Ä–∞–∑—É `*://*/*/business*`. –í–æ–Ω–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è —Ç–∞–∫, —è–∫ –≤–ª–∞—Å–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —ñ –º–∞—é—Ç—å –¥–æ–≤—ñ–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ [–æ–±'—î–∫—Ç–Ω–æ—ó –º–æ–¥–µ–ª—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (DOM)](https://developer.mozilla.org/en-US/docs/Web/API/Document\_Object\_Model) —Å—Ç–æ—Ä—ñ–Ω–∫–∏.

```json
"content_scripts": [
{
"js": [
"script.js"
],
"matches": [
"https://example.com/*",
"https://www.example.com/*"
],
"exclude_matches": ["*://*/*business*"],
}
],
```

–î–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è –∞–±–æ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö URL-–∞–¥—Ä–µ—Å –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`include_globs`** —Ç–∞ **`exclude_globs`**.

–û—Å—å –ø—Ä–∏–∫–ª–∞–¥ –≤–º—ñ—Å—Ç–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç—É, —è–∫–∏–π –¥–æ–¥–∞—Å—Ç—å –∫–Ω–æ–ø–∫—É –ø–æ—è—Å–Ω–µ–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É, –∫–æ–ª–∏ [API —Å—Ö–æ–≤–∏—â–∞](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/storage) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è `message` –∑ —Å—Ö–æ–≤–∏—â–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

```js
chrome.storage.local.get("message", result =>
{
let div = document.createElement("div");
div.innerHTML = result.message + " <button>Explain</button>";
div.querySelector("button").addEventListener("click", () =>
{
chrome.runtime.sendMessage("explain");
});
document.body.appendChild(div);
});
```

<figure><img src="../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∫—Ä–∏–ø—Ç–∞ –≤–º—ñ—Å—Ç—É, –∫–æ–ª–∏ —Ü—é –∫–Ω–æ–ø–∫—É –Ω–∞—Ç–∏—Å–∫–∞—é—Ç—å, —á–µ—Ä–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è [API **runtime.sendMessage()**](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/sendMessage). –¶–µ —á–µ—Ä–µ–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–∞ –≤–º—ñ—Å—Ç—É —É –ø—Ä—è–º–æ–º—É –¥–æ—Å—Ç—É–ø—ñ –¥–æ API, –¥–µ `storage` —î –æ–¥–Ω–∏–º —ñ–∑ –∫—ñ–ª—å–∫–æ—Ö –≤–∏–Ω—è—Ç–∫—ñ–≤. –î–ª—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É –ø–æ–∑–∞ —Ü–∏–º–∏ –≤–∏–Ω—è—Ç–∫–∞–º–∏, –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∑ —è–∫–∏–º–∏ –º–æ–∂—É—Ç—å —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è —Å–∫—Ä–∏–ø—Ç–∏ –≤–º—ñ—Å—Ç—É.

{% hint style="warning" %}
–ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –±—Ä–∞—É–∑–µ—Ä–∞, –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ —Å–∫—Ä–∏–ø—Ç–∞ –≤–º—ñ—Å—Ç—É –º–æ–∂—É—Ç—å —Ç—Ä–æ—Ö–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—Ç–∏—Å—è. –î–ª—è –±—Ä–∞—É–∑–µ—Ä—ñ–≤ –Ω–∞ –æ—Å–Ω–æ–≤—ñ Chromium, —Å–ø–∏—Å–æ–∫ –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π –¥–æ—Å—Ç—É–ø–Ω–∏–π —É [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤ Chrome](https://developer.chrome.com/docs/extensions/mv3/content\_scripts/#capabilities), –∞ –¥–ª—è Firefox - –Ω–∞ [MDN](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Content\_scripts#webextension\_apis) —î –æ—Å–Ω–æ–≤–Ω–µ –¥–∂–µ—Ä–µ–ª–æ.\
–¢–∞–∫–æ–∂ –≤–∞—Ä—Ç–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ —Å–∫—Ä–∏–ø—Ç–∏ –≤–º—ñ—Å—Ç—É –º–æ–∂—É—Ç—å —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ —Ñ–æ–Ω–æ–≤–∏–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏, —â–æ –¥–æ–∑–≤–æ–ª—è—î —ó–º –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥—ñ—ó —Ç–∞ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞–∑–∞–¥.
{% endhint %}

–î–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É —Ç–∞ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç—ñ–≤ –≤–º—ñ—Å—Ç—É –≤ Chrome, –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –º–µ–Ω—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ Chrome –∑ –û–ø—Ü—ñ—ó > –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ > –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –∞–±–æ –Ω–∞—Ç–∏—Å–Ω—É–≤—à–∏ Ctrl + Shift + I.

–ü—ñ—Å–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞, —Å–ª—ñ–¥ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Source**, –∞ –ø–æ—Ç—ñ–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Content Scripts**. –¶–µ –¥–æ–∑–≤–æ–ª—è—î —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ –∑–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º —Å–∫—Ä–∏–ø—Ç—ñ–≤ –≤–º—ñ—Å—Ç—É –∑ —Ä—ñ–∑–Ω–∏—Ö —Ä–æ–∑—à–∏—Ä–µ–Ω—å —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Ç–æ—á–∫–∏ –∑—É–ø–∏–Ω–∫–∏ –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –ø–æ—Ç–æ–∫—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

### –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏ –≤–º—ñ—Å—Ç—É

{% hint style="success" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **–°–∫—Ä–∏–ø—Ç–∏ –≤–º—ñ—Å—Ç—É –Ω–µ —î –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º–∏**, –æ—Å–∫—ñ–ª—å–∫–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ **–¥–∏–Ω–∞–º—ñ—á–Ω–æ –≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏** —Å–∫—Ä–∏–ø—Ç–∏ —Ç–∞ **–ø—Ä–æ–≥—Ä–∞–º–Ω–æ –≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ —ó—Ö** –Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏ —á–µ—Ä–µ–∑ **`tabs.executeScript`**. –¶–µ —Ñ–∞–∫—Ç–∏—á–Ω–æ –Ω–∞–¥–∞—î –±—ñ–ª—å—à–µ **–≥—Ä–∞–Ω—É–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—é**.
{% endhint %}

–î–ª—è –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç–∞ –≤–º—ñ—Å—Ç—É, —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—é –ø–æ—Ç—Ä—ñ–±–Ω–æ –º–∞—Ç–∏ [–ø—Ä–∞–≤–∞ —Ö–æ—Å—Ç–∞](https://developer.chrome.com/docs/extensions/reference/permissions) –¥–ª—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏, –≤ —è–∫—É –±—É–¥—É—Ç—å –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏. –¶—ñ –¥–æ–∑–≤–æ–ª–∏ –º–æ–∂–Ω–∞ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –∞–±–æ **–∑–∞–ø–∏—Ç–∞–≤—à–∏ —ó—Ö** —É –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∞–±–æ —Ç–∏–º—á–∞—Å–æ–≤–æ —á–µ—Ä–µ–∑ [**activeTab**](https://developer.chrome.com/docs/extensions/reference/manifest/activeTab).

#### –ü—Ä–∏–∫–ª–∞–¥ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ activeTab

{% code title="manifest.json" %}
```json
{
"name": "My extension",
...
"permissions": [
"activeTab",
"scripting"
],
"background": {
"service_worker": "background.js"
},
"action": {
"default_title": "Action Button"
}
}
```
{% endcode %}

* **–í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è JS-—Ñ–∞–π–ª—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ:**

```javascript
// content-script.js
document.body.style.backgroundColor = "orange";

//service-worker.js - Inject the JS file
chrome.action.onClicked.addListener((tab) => {
chrome.scripting.executeScript({
target: { tabId: tab.id },
files: ["content-script.js"]
});
});
```

* **–í–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é** –ø—Ä–∏ –∫–ª—ñ—Ü—ñ:

```javascript
//service-worker.js - Inject a function
function injectedFunction() {
document.body.style.backgroundColor = "orange";
}

chrome.action.onClicked.addListener((tab) => {
chrome.scripting.executeScript({
target : {tabId : tab.id},
func : injectedFunction,
});
});
```

#### –ü—Ä–∏–∫–ª–∞–¥ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ –Ω–∞ —Å–∫—Ä–∏–ø—Ç–∏–∑–∞—Ü—ñ—é

```javascript
// service-workser.js
chrome.scripting.registerContentScripts([{
id : "test",
matches : [ "https://*.example.com/*" ],
excludeMatches : [ "*://*/*business*" ],
js : [ "contentScript.js" ],
}]);

// Another example
chrome.tabs.executeScript(tabId, { file: "content_script.js" });
```

–î–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è –∞–±–æ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö URL-–∞–¥—Ä–µ—Å —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`include_globs`** —Ç–∞ **`exclude_globs`**.

### –°—Ü–µ–Ω–∞—Ä—ñ—ó –≤–º—ñ—Å—Ç—É `run_at`

–ü–æ–ª–µ `run_at` –∫–æ–Ω—Ç—Ä–æ–ª—é—î **–∫–æ–ª–∏ —Ñ–∞–π–ª–∏ JavaScript –≤–Ω–µ–¥—Ä—é—é—Ç—å—Å—è –Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫—É**. –ü–µ—Ä–µ–≤–∞–≥–∞ —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º - `"document_idle"`.

–ú–æ–∂–ª–∏–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è:

* **`document_idle`**: –ö–æ–ª–∏ —Ü–µ –º–æ–∂–ª–∏–≤–æ
* **`document_start`**: –ü—ñ—Å–ª—è –±—É–¥—å-—è–∫–∏—Ö —Ñ–∞–π–ª—ñ–≤ –∑ `css`, –∞–ª–µ –ø–µ—Ä–µ–¥ –±—É–¥—å-—è–∫–æ—é —ñ–Ω—à–æ—é –ø–æ–±—É–¥–æ–≤–æ—é DOM –∞–±–æ –∑–∞–ø—É—Å–∫–æ–º –±—É–¥—å-—è–∫–æ–≥–æ —ñ–Ω—à–æ–≥–æ —Å–∫—Ä–∏–ø—Ç—É.
* **`document_end`**: –ù–µ–≥–∞–π–Ω–æ –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è DOM, –∞–ª–µ –ø–µ—Ä–µ–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–∞ —Ñ—Ä–µ–π–º–∏.

#### –ß–µ—Ä–µ–∑ `manifest.json`

```json
{
"name": "My extension",
...
"content_scripts": [
{
"matches": ["https://*.example.com/*"],
"run_at": "document_idle",
"js": ["contentScript.js"]
}
],
...
}

```

–ß–µ—Ä–µ–∑ **`service-worker.js`**

```javascript
chrome.scripting.registerContentScripts([{
id : "test",
matches : [ "https://*.example.com/*" ],
runAt : "document_idle",
js : [ "contentScript.js" ],
}]);
```

### `—Ñ–æ–Ω`

–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –∫–æ–Ω—Ç–µ–Ω—Ç-—Å–∫—Ä–∏–ø—Ç–∞–º–∏, –æ—Ç—Ä–∏–º—É—î **—Ñ–æ–Ω–æ–≤–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞**, —è–∫–∞ –≤–∏–∫–æ–Ω—É—î —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—É —Ä–æ–ª—å —É –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—ó –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è. –ó–æ–∫—Ä–µ–º–∞, —Ñ–æ–Ω–æ–≤–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ —ñ—Å–Ω—É—î –ø—Ä–æ—Ç—è–≥–æ–º —É—Å—å–æ–≥–æ —Ç–µ—Ä–º—ñ–Ω—É –¥—ñ—ó —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –ø—Ä–∞—Ü—é—é—á–∏ –Ω–µ–ø–æ–º—ñ—Ç–Ω–æ –±–µ–∑ –ø—Ä—è–º–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º. –í–æ–Ω–∞ –º–∞—î –≤–ª–∞—Å–Ω—É –º–æ–¥–µ–ª—å –æ–±'—î–∫—Ç—ñ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (DOM), —â–æ –¥–æ–∑–≤–æ–ª—è—î —Å–∫–ª–∞–¥–Ω—ñ –≤–∑–∞—î–º–æ–¥—ñ—ó —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Å—Ç–∞–Ω–æ–º.

**–ö–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏**:

* **–†–æ–ª—å —Ñ–æ–Ω–æ–≤–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏:** –î—ñ—î —è–∫ –Ω–µ—Ä–≤–æ–≤–∏–π —Ü–µ–Ω—Ç—Ä –¥–ª—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é —Ç–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—é –º—ñ–∂ —Ä—ñ–∑–Ω–∏–º–∏ —á–∞—Å—Ç–∏–Ω–∞–º–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* **–ü–æ—Å—Ç—ñ–π–Ω—ñ—Å—Ç—å:** –¶–µ –∑–∞–≤–∂–¥–∏ –ø—Ä–∏—Å—É—Ç–Ω—è —Å—É—Ç–Ω—ñ—Å—Ç—å, –Ω–µ–≤–∏–¥–∏–º–∞ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –∞–ª–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∞ –¥–ª—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è:** –Ø–∫—â–æ –Ω–µ –≤–∫–∞–∑–∞–Ω–æ —è–≤–Ω–æ, –±—Ä–∞—É–∑–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç—å —Ñ–æ–Ω–æ–≤—É —Å—Ç–æ—Ä—ñ–Ω–∫—É. –¶—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –±—É–¥–µ –º—ñ—Å—Ç–∏—Ç–∏ –≤—Å—ñ —Ñ–æ–Ω–æ–≤—ñ —Å–∫—Ä–∏–ø—Ç–∏, –≤–∫–∞–∑–∞–Ω—ñ –≤ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ –±–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω—É —Ä–æ–±–æ—Ç—É —Ñ–æ–Ω–æ–≤–∏—Ö –∑–∞–≤–¥–∞–Ω—å —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

{% hint style="success" %}
–ó—Ä—É—á–Ω—ñ—Å—Ç—å, —è–∫—É –Ω–∞–¥–∞—î –±—Ä–∞—É–∑–µ—Ä —É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–º—É —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ñ–æ–Ω–æ–≤–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (—è–∫—â–æ –Ω–µ –≤–∫–∞–∑–∞–Ω–æ —è–≤–Ω–æ), –∑–∞–±–µ–∑–ø–µ—á—É—î —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –≤—Å—ñ—Ö –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö —Ñ–æ–Ω–æ–≤–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤ —Ç–∞ —ó—Ö–Ω—é –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω—ñ—Å—Ç—å, —Å–ø—Ä–æ—â—É—é—á–∏ –ø—Ä–æ—Ü–µ—Å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
{% endhint %}

–ü—Ä–∏–∫–ª–∞–¥ —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞:

```js
chrome.runtime.onMessage.addListener((request, sender, sendResponse) =>
{
if (request == "explain")
{
chrome.tabs.create({ url: "https://example.net/explanation" });
}
})
```

–í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î [API runtime.onMessage](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage) –¥–ª—è –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å. –ö–æ–ª–∏ –æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è `"explain"`, –≤—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î [API –≤–∫–ª–∞–¥–æ–∫](https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/tabs) –¥–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –≤ –Ω–æ–≤—ñ–π –≤–∫–ª–∞–¥—Ü—ñ.

–î–ª—è –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç—É –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ **–¥–µ—Ç–∞–ª–µ–π —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–æ–±–æ—á–∏–π —Å–∫—Ä–∏–ø—Ç —Å–ª—É–∂–±–∏**, —Ü–µ –≤—ñ–¥–∫—Ä–∏—î —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –∑ —Ñ–æ–Ω–æ–≤–∏–º —Å–∫—Ä–∏–ø—Ç–æ–º:

<figure><img src="https://github.com/carlospolop/hacktricks/blob/ua/pentesting-web/browser-extension-pentesting-methodology/broken-reference" alt=""><figcaption></figcaption></figure>

### –°—Ç–æ—Ä—ñ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Ç–∞ —ñ–Ω—à—ñ

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ –≤–∏–¥–∏ —Å—Ç–æ—Ä—ñ–Ω–æ–∫:

* **–°—Ç–æ—Ä—ñ–Ω–∫–∏ –¥—ñ–π** –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –≤ **—Ä–æ–∑–∫—Ä–∏–≤–Ω–æ–º—É —Å–ø–∏—Å–∫—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –Ω–∞ –∑–Ω–∞—á–æ–∫ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è**.
* –°—Ç–æ—Ä—ñ–Ω–∫–∏, —è–∫—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è **–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –≤ –Ω–æ–≤—ñ–π –≤–∫–ª–∞–¥—Ü—ñ**.
* **–°—Ç–æ—Ä—ñ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤**: –¶—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –≤–≥–æ—Ä—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ. –£ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ –≤ –º–æ—î–º—É –≤–∏–ø–∞–¥–∫—É —è –º—ñ–≥ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ü—ñ—î—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑–∞ –∞–¥—Ä–µ—Å–æ—é `chrome://extensions/?options=fadlhnelkbeojnebcbkacjilhnbjfjca` –∞–±–æ –Ω–∞—Ç–∏—Å–Ω—É–≤—à–∏:

<figure><img src="../../.gitbook/assets/image (8).png" alt="" width="375"><figcaption></figcaption></figure>

–ó–∞—É–≤–∞–∂—Ç–µ, —â–æ —Ü—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –Ω–µ —î –ø–æ—Å—Ç—ñ–π–Ω–∏–º–∏, —è–∫ —Ñ–æ–Ω–æ–≤—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –¥–∏–Ω–∞–º—ñ—á–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å –≤–º—ñ—Å—Ç –∑–∞ –ø–æ—Ç—Ä–µ–±–æ—é. –ù–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Ü–µ, –≤–æ–Ω–∏ –º–∞—é—Ç—å —Å–ø—ñ–ª—å–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∑ —Ñ–æ–Ω–æ–≤–æ—é —Å—Ç–æ—Ä—ñ–Ω–∫–æ—é:

* **–í–∑–∞—î–º–æ–¥—ñ—è –∑ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–∏–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏:** –ü–æ–¥—ñ–±–Ω–æ –¥–æ —Ñ–æ–Ω–æ–≤–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏, —Ü—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –º–æ–∂—É—Ç—å –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤, —Å–ø—Ä–∏—è—é—á–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* **–î–æ—Å—Ç—É–ø –¥–æ API, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö –¥–ª—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è:** –¶—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –º–∞—é—Ç—å –ø–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ API, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö –¥–ª—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –¥–æ–∑–≤–æ–ª—ñ–≤, –≤–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –¥–ª—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

### `permissions` —Ç–∞ `host_permissions`

**`permissions`** —Ç–∞ **`host_permissions`** - —Ü–µ –∑–∞–ø–∏—Å–∏ –∑ `manifest.json`, —è–∫—ñ –≤–∫–∞–∑—É—é—Ç—å, **—è–∫—ñ –¥–æ–∑–≤–æ–ª–∏** –º–∞—é—Ç—å —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ (–∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è, –º—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è...) —Ç–∞ –Ω–∞ **—è–∫–∏—Ö –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö**.

–û—Å–∫—ñ–ª—å–∫–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ –º–æ–∂—É—Ç—å –º–∞—Ç–∏ —Ç–∞–∫—É **–≤–µ–ª–∏–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–∏–≤—ñ–ª–µ—ó–≤**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–π –∞–±–æ –∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∏–π –º–æ–∂–µ –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É **—Ä—ñ–∑–Ω—ñ —Å–ø–æ—Å–æ–±–∏ –∫—Ä–∞–¥—ñ–∂–∫–∏ —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Ç–∞ —à–ø–∏–≥—É–Ω—Å—Ç–≤–∞ –∑–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º**.

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —è–∫ –ø—Ä–∞—Ü—é—é—Ç—å —Ü—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ —è–∫ –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–ª–æ–≤–∂–∏–≤–∞–Ω—ñ –≤:

{% content-ref url="browext-permissions-and-host_permissions.md" %}
[browext-permissions-and-host\_permissions.md](browext-permissions-and-host\_permissions.md)
{% endcontent-ref %}

### `content_security_policy`

–ü–æ–ª—ñ—Ç–∏–∫–∞ –±–µ–∑–ø–µ–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∑–Ω–∞—á–µ–Ω–∞ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ `manifest.json`. –Ø–∫—â–æ –≤–æ–Ω–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–∞, –≤–æ–Ω–∞ –º–æ–∂–µ –±—É—Ç–∏ **—É—Ä–∞–∑–ª–∏–≤–æ—é**.

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–æ–∫ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ –¥–æ—Å–∏—Ç—å –æ–±–º–µ–∂–µ–Ω–µ:

```bash
script-src 'self'; object-src 'self';
```

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ CSP —Ç–∞ –º–æ–∂–ª–∏–≤—ñ –æ–±—Ö—ñ–¥–Ω—ñ —à–ª—è—Ö–∏ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

{% content-ref url="../content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../content-security-policy-csp-bypass/)
{% endcontent-ref %}

### `web_accessible_resources`

–¥–ª—è —Ç–æ–≥–æ, —â–æ–± –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ –º–æ–≥–ª–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ `.html`, —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ –≤ –ø–æ–ª—ñ **`web_accessible_resources`** —Ñ–∞–π–ª—É `manifest.json`.\
–ù–∞–ø—Ä–∏–∫–ª–∞–¥:

```javascript
{
...
"web_accessible_resources": [
{
"resources": [ "images/*.png" ],
"matches": [ "https://example.com/*" ]
},
{
"resources": [ "fonts/*.woff" ],
"matches": [ "https://example.com/*" ]
}
],
...
}
```

–¶—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –∑–∞ URL-–∞–¥—Ä–µ—Å–æ—é:

```
chrome-extension://<extension-id>/message.html
```

–£ –ø—É–±–ª—ñ—á–Ω–∏—Ö —Ä–æ–∑—à–∏—Ä–µ–Ω—å **—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–æ—Å—Ç—É–ø–Ω–∏–π**:

<figure><img src="../../.gitbook/assets/image (722).png" alt="" width="375"><figcaption></figcaption></figure>

–•–æ—á–∞, —è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä `manifest.json` **`use_dynamic_url`**, —Ü–µ–π **—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –º–æ–∂–µ –±—É—Ç–∏ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–º**.

–ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –¥–æ—Å—Ç—É–ø—É –¥–æ —Ü–∏—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫ —Ä–æ–±–∏—Ç—å —ó—Ö **–ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏ –¥–æ –∞—Ç–∞–∫ ClickJacking**:

{% content-ref url="browext-clickjacking.md" %}
[browext-clickjacking.md](browext-clickjacking.md)
{% endcontent-ref %}

{% hint style="success" %}
–î–æ–∑–≤–æ–ª–∏—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ü–∏—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –ª–∏—à–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º, –∞ –Ω–µ –≤–∏–ø–∞–¥–∫–æ–≤–∏–º URL-–∞–¥—Ä–µ—Å–∞–º –º–æ–∂–µ –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –∞—Ç–∞–∫–∞–º CLickJacking.
{% endhint %}

### `externally_connectable`

–ó–≥—ñ–¥–Ω–æ –∑ [**–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é**](https://developer.chrome.com/docs/extensions/reference/manifest/externally-connectable), –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å –º–∞–Ω—ñ—Ñ–µ—Å—Ç—É `"externally_connectable"` –≤–∫–∞–∑—É—î, **—è–∫—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏ –º–æ–∂—É—Ç—å –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è** –¥–æ –≤–∞—à–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —á–µ—Ä–µ–∑ [runtime.connect](https://developer.chrome.com/docs/extensions/reference/runtime#method-connect) —Ç–∞ [runtime.sendMessage](https://developer.chrome.com/docs/extensions/reference/runtime#method-sendMessage).

* –Ø–∫—â–æ –∫–ª—é—á **`externally_connectable`** –Ω–µ –≤–∫–∞–∑–∞–Ω–∏–π —É –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ –≤–∞—à–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∞–±–æ –≤–∫–∞–∑–∞–Ω–∏–π —è–∫ **`"ids": ["*"]`**, **–≤—Å—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –º–æ–∂—É—Ç—å –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è, –∞–ª–µ –∂–æ–¥–Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ –Ω–µ –º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è**.
* –Ø–∫—â–æ –≤–∫–∞–∑–∞–Ω—ñ **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏**, —è–∫ —É `"ids": ["aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"]`, **–ª–∏—à–µ —Ü—ñ –¥–æ–¥–∞—Ç–∫–∏** –º–æ–∂—É—Ç—å –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è.
* –Ø–∫—â–æ –≤–∫–∞–∑–∞–Ω—ñ **–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ**, —Ü—ñ –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∏ –∑–º–æ–∂—É—Ç—å –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è:

```json
"matches": [
"https://*.google.com/*",
"*://*.chromium.org/*",
```

* –Ø–∫—â–æ –≤–∫–∞–∑–∞–Ω–æ —è–∫ –ø–æ—Ä–æ–∂–Ω—î: **`"externally_connectable": {}`**, –∂–æ–¥–µ–Ω –¥–æ–¥–∞—Ç–æ–∫ –∞–±–æ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ –Ω–µ –∑–º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è.

–ß–∏–º **–º–µ–Ω—à–µ —Ä–æ–∑—à–∏—Ä–µ–Ω—å —Ç–∞ URL-–∞–¥—Ä–µ—Å** –≤–∫–∞–∑–∞–Ω–æ —Ç—É—Ç, —Ç–∏–º **–º–µ–Ω—à–∞ –ø–æ–≤–µ—Ä—Ö–Ω—è –∞—Ç–∞–∫–∏** –±—É–¥–µ.

{% hint style="danger" %}
–Ø–∫—â–æ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞, **–≤—Ä–∞–∑–ª–∏–≤–∞ –¥–æ XSS –∞–±–æ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è**, –≤–∫–∞–∑–∞–Ω–∞ –≤ **`externally_connectable`**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ **–Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –¥–æ —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞**, –ø–æ–≤–Ω—ñ—Å—Ç—é –æ–±—Ö–æ–¥—è—á–∏ –°–∫—Ä–∏–ø—Ç –≤–º—ñ—Å—Ç—É —Ç–∞ –π–æ–≥–æ CSP.

–û—Ç–∂–µ, —Ü–µ **–¥—É–∂–µ –ø–æ—Ç—É–∂–Ω–∏–π –æ–±—Ö—ñ–¥**.

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —è–∫—â–æ –∫–ª—ñ—î–Ω—Ç –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –π–æ–º—É –Ω–µ –¥–æ–∑–≤–æ–ª–µ–Ω–æ —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –≤—Ä–∞–∑–ª–∏–≤–∏–º —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º, –≤–æ–Ω–æ –º–æ–∂–µ –≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ **–¥–∞–Ω—ñ XSS –Ω–∞ –¥–æ–∑–≤–æ–ª–µ–Ω—É –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫—É** –∞–±–æ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ API **`WebRequest`** –∞–±–æ **`DeclarativeNetRequest`** –¥–ª—è –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Ç–∞–º–∏ –Ω–∞ —Ü—ñ–ª—å–æ–≤–æ–º—É –¥–æ–º–µ–Ω—ñ, –∑–º—ñ–Ω—é—é—á–∏ –∑–∞–ø–∏—Ç —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–ª—è **—Ñ–∞–π–ª—É JavaScript**. (–ó–∞—É–≤–∞–∂—Ç–µ, —â–æ CSP –Ω–∞ —Ü—ñ–ª—å–æ–≤—ñ–π —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –º–æ–∂–µ –∑–∞–ø–æ–±—ñ–≥—Ç–∏ —Ü–∏–º –∞—Ç–∞–∫–∞–º). –¶—è —ñ–¥–µ—è –≤–∑—è—Ç–∞ –∑ [**—Ü—å–æ–≥–æ –æ–ø–∏—Å—É**](https://www.darkrelay.com/post/opera-zero-day-rce-vulnerability).
{% endhint %}

##

## –í–∑–∞—î–º–æ–¥—ñ—è –º—ñ–∂ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–æ—é **‚ÜîÔ∏é** –°–∫—Ä–∏–ø—Ç–æ–º –≤–º—ñ—Å—Ç—É

–°–µ—Ä–µ–¥–æ–≤–∏—â–∞, –¥–µ –ø—Ä–∞—Ü—é—é—Ç—å **—Å–∫—Ä–∏–ø—Ç–∏ –≤–º—ñ—Å—Ç—É** —Ç–∞ –¥–µ —ñ—Å–Ω—É—é—Ç—å —Å—Ç–æ—Ä—ñ–Ω–∫–∏-–≥–æ—Å–ø–æ–¥–∞—Ä—ñ, **–≤—ñ–¥–æ–∫—Ä–µ–º–ª–µ–Ω—ñ** –æ–¥–Ω–µ –≤—ñ–¥ –æ–¥–Ω–æ–≥–æ, –∑–∞–±–µ–∑–ø–µ—á—É—é—á–∏ **—ñ–∑–æ–ª—è—Ü—ñ—é**. –ù–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Ü—é —ñ–∑–æ–ª—è—Ü—ñ—é, –æ–±–∏–¥–≤–∞ –º–∞—é—Ç—å –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ **–û–±'—î–∫—Ç–Ω–æ—é –º–æ–¥–µ–ª–ª—é –¥–æ–∫—É–º–µ–Ω—Ç–∞ (DOM)** —Å—Ç–æ—Ä—ñ–Ω–∫–∏, —Å–ø—ñ–ª—å–Ω–∏–º —Ä–µ—Å—É—Ä—Å–æ–º. –î–ª—è —Ç–æ–≥–æ —â–æ–± —Å—Ç–æ—Ä—ñ–Ω–∫–∞-–≥–æ—Å–ø–æ–¥–∞—Ä –≤–∑–∞—î–º–æ–¥—ñ—è–ª–∞ –∑ **—Å–∫—Ä–∏–ø—Ç–æ–º –≤–º—ñ—Å—Ç—É**, –∞–±–æ –æ–ø–æ—Å–µ—Ä–µ–¥–∫–æ–≤–∞–Ω–æ –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç –≤–º—ñ—Å—Ç—É, –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **DOM**, –¥–æ —è–∫–æ–≥–æ –º–∞—é—Ç—å –¥–æ—Å—Ç—É–ø –æ–±–∏–¥–≤—ñ —Å—Ç–æ—Ä–æ–Ω–∏, —è–∫ –∫–∞–Ω–∞–ª –∑–≤'—è–∑–∫—É.

### –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è Post

{% code title="content-script.js" %}
```javascript
var port = chrome.runtime.connect();

window.addEventListener("message", (event) => {
// We only accept messages from ourselves
if (event.source !== window) {
return;
}

if (event.data.type && (event.data.type === "FROM_PAGE")) {
console.log("Content script received: " + event.data.text);
port.postMessage(event.data.text);
}
}, false);
```
{% endcode %}

{% code title="example.js" %}
```javascript
document.getElementById("theButton").addEventListener("click", () => {
window.postMessage(
{type : "FROM_PAGE", text : "Hello from the webpage!"}, "*");
}, false);
```
{% endcode %}

–ë–µ–∑–ø–µ—á–Ω–∞ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è Post Message –ø–æ–≤–∏–Ω–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –∞–≤—Ç–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –æ—Ç—Ä–∏–º–∞–Ω–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —Ü–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏, –ø–µ—Ä–µ–≤—ñ—Ä–∏–≤—à–∏:

* **`event.isTrusted`**: –¶–µ –ø—Ä–∞–≤–¥–∞ –ª–∏—à–µ –≤ —Ç–æ–º—É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –ø–æ–¥—ñ—è –±—É–ª–∞ —Å–ø—Ä–æ–≤–æ–∫–æ–≤–∞–Ω–∞ –¥—ñ—î—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
* –°—Ü–µ–Ω–∞—Ä—ñ–π –∫–æ–Ω—Ç–µ–Ω—Ç—É –º–æ–∂–µ –æ—á—ñ–∫—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ª–∏—à–µ —É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–∫–æ–Ω—É—î –ø–µ–≤–Ω—É –¥—ñ—é
* **–ø–æ—á–∞—Ç–∫–æ–≤–∏–π –¥–æ–º–µ–Ω**: –º–æ–∂–µ –æ—á—ñ–∫—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ª–∏—à–µ –≤—ñ–¥ —Å–ø–∏—Å–∫—É –¥–æ–º–µ–Ω—ñ–≤.
* –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–∏–π –≤–∏—Ä–∞–∑, –±—É–¥—å—Ç–µ –¥—É–∂–µ –æ–±–µ—Ä–µ–∂–Ω—ñ
* **–î–∂–µ—Ä–µ–ª–æ**: `received_message.source !== window` –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —á–∏ –±—É–ª–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è **–∑ —Ç–æ–≥–æ –∂ –≤—ñ–∫–Ω–∞**, –¥–µ –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É—î—Ç—å—Å—è —Å—Ü–µ–Ω–∞—Ä—ñ–π –∫–æ–Ω—Ç–µ–Ω—Ç—É.

–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–æ–Ω–∏ –≤–∏–∫–æ–Ω–∞–Ω—ñ, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–º–∏, —Ç–æ–º—É –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É **–ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö –æ–±—Ö—ñ–¥—ñ–≤ Post Message**:

{% content-ref url="../postmessage-vulnerabilities/" %}
[postmessage-vulnerabilities](../postmessage-vulnerabilities/)
{% endcontent-ref %}

### Iframe

–©–µ –æ–¥–∏–Ω –º–æ–∂–ª–∏–≤–∏–π —Å–ø–æ—Å—ñ–± –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó –º–æ–∂–µ –±—É—Ç–∏ —á–µ—Ä–µ–∑ **URL-–∞–¥—Ä–µ—Å–∏ Iframe**, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥ —É:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

### DOM

–¶–µ –Ω–µ "—Ç–æ—á–Ω–æ" —Å–ø–æ—Å—ñ–± –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó, –∞–ª–µ **–≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞ —Ç–∞ —Å—Ü–µ–Ω–∞—Ä—ñ–π –∫–æ–Ω—Ç–µ–Ω—Ç—É –º–∞—Ç–∏–º—É—Ç—å –¥–æ—Å—Ç—É–ø –¥–æ DOM –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏**. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, —è–∫—â–æ **—Å—Ü–µ–Ω–∞—Ä—ñ–π –∫–æ–Ω—Ç–µ–Ω—Ç—É** —á–∏—Ç–∞—î –ø–µ–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑ –Ω—å–æ–≥–æ, **–¥–æ–≤—ñ—Ä—è—é—á–∏ DOM –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏**, –≤–µ–± –º–æ–∂–µ **–∑–º—ñ–Ω–∏—Ç–∏ —Ü—ñ –¥–∞–Ω—ñ** (—Ç–æ–º—É —â–æ –≤–µ–± –Ω–µ –ø–æ–≤–∏–Ω–µ–Ω –¥–æ–≤—ñ—Ä—è—Ç–∏, –∞–±–æ —Ç–æ–º—É —â–æ –≤–µ–± –≤—Ä–∞–∑–ª–∏–≤–∏–π –¥–æ XSS) —ñ **–ø–æ—à–∫–æ–¥–∏—Ç–∏ —Å—Ü–µ–Ω–∞—Ä—ñ–π –∫–æ–Ω—Ç–µ–Ω—Ç—É**.

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥ **DOM-–æ—Å–Ω–æ–≤–∞–Ω–æ–≥–æ XSS –¥–ª—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—ó —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞** –≤:

{% content-ref url="browext-xss-example.md" %}
[browext-xss-example.md](browext-xss-example.md)
{% endcontent-ref %}

## –ß—É—Ç–ª–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –≤ –ø–∞–º'—è—Ç—ñ/–∫–æ–¥—ñ

–Ø–∫—â–æ –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ë—Ä–∞—É–∑–µ—Ä–∞ –∑–±–µ—Ä—ñ–≥–∞—î **—á—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å–≤–æ—î—ó –ø–∞–º'—è—Ç—ñ**, —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ **–≤–∏—Ç—è–≥–Ω—É—Ç–æ** (–æ—Å–æ–±–ª–∏–≤–æ –Ω–∞ –º–∞—à–∏–Ω–∞—Ö –∑ Windows) —ñ **–ø–æ—à—É–∫–æ–≤–æ** –¥–ª—è —Ü—ñ—î—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.

–û—Ç–∂–µ, –ø–∞–º'—è—Ç—å –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ë—Ä–∞—É–∑–µ—Ä–∞ **–Ω–µ –ø–æ–≤–∏–Ω–Ω–∞ –≤–≤–∞–∂–∞—Ç–∏—Å—è –±–µ–∑–ø–µ—á–Ω–æ—é** —ñ **—á—É—Ç–ª–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è** —Ç–∞–∫–∞ —è–∫ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –∞–±–æ –º–Ω–µ–º–æ–Ω—ñ—á–Ω—ñ —Ñ—Ä–∞–∑–∏ **–Ω–µ –ø–æ–≤–∏–Ω–Ω—ñ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è**.

–ó–≤—ñ—Å–Ω–æ, **–Ω–µ —Ä–æ–∑–º—ñ—â—É–π—Ç–µ —á—É—Ç–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –≤ –∫–æ–¥—ñ**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –±—É–¥–µ **–ø—É–±–ª—ñ—á–Ω–æ—é**.

## –ö–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è –º—ñ–∂ —Å—Ü–µ–Ω–∞—Ä—ñ—î–º –∫–æ–Ω—Ç–µ–Ω—Ç—É **‚ÜîÔ∏é** –°—Ü–µ–Ω–∞—Ä—ñ—î–º –§–æ–Ω—É

–°—Ü–µ–Ω–∞—Ä—ñ–π –∫–æ–Ω—Ç–µ–Ω—Ç—É –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó [**runtime.sendMessage()**](https://developer.chrome.com/docs/extensions/reference/runtime#method-sendMessage) **–∞–±–æ** [**tabs.sendMessage()**](https://developer.chrome.com/docs/extensions/reference/tabs#method-sendMessage) –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è **–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ JSON-—Å–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–≥–æ** –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.

–î–ª—è –æ–±—Ä–æ–±–∫–∏ **–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø–æ–≤–µ—Ä–Ω–µ–Ω—É **–æ–±—ñ—Ü—è–Ω–∫—É**. –•–æ—á–∞, –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º–∏ –≤–µ—Ä—Å—ñ—è–º–∏, –≤—Å–µ —â–µ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ **–∑–≤–æ—Ä–æ—Ç–Ω–∏–π –≤–∏–∫–ª–∏–∫** —è–∫ –æ—Å—Ç–∞–Ω–Ω—ñ–π –∞—Ä–≥—É–º–µ–Ω—Ç.

–í—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—É –∑ **—Å—Ü–µ–Ω–∞—Ä—ñ—é –∫–æ–Ω—Ç–µ–Ω—Ç—É** –≤–∏–≥–ª—è–¥–∞—î –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:

```javascript
(async () => {
const response = await chrome.runtime.sendMessage({greeting: "hello"});
// do something with response here, not outside the function
console.log(response);
})();
```

–ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—É –∑ **—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è** (–∑–∞–∑–≤–∏—á–∞–π **—Ñ–æ–Ω–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç**) –°–∫—Ä–∏–ø—Ç –∫–æ–Ω—Ç–µ–Ω—Ç—É –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó, –∑–∞ –≤–∏–Ω—è—Ç–∫–æ–º —Ç–æ–≥–æ, —â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏, –Ω–∞ —è–∫—É –≤–∫–ª–∞–¥–∫—É –π–æ–≥–æ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏. –ü—Ä–∏–∫–ª–∞–¥ —Ç–æ–≥–æ, —è–∫ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É —Å–∫—Ä–∏–ø—Ç –∫–æ–Ω—Ç–µ–Ω—Ç—É –Ω–∞ –≤–∏–±—Ä–∞–Ω—ñ–π –≤–∫–ª–∞–¥—Ü—ñ:

```javascript
// From https://stackoverflow.com/questions/36153999/how-to-send-a-message-between-chrome-extension-popup-and-content-script
(async () => {
const [tab] = await chrome.tabs.query({active: true, lastFocusedWindow: true});
const response = await chrome.tabs.sendMessage(tab.id, {greeting: "hello"});
// do something with response here, not outside the function
console.log(response);
})();
```

–ù–∞ **–ø—Ä–∏–π–º–∞—é—á–æ–º—É –∫—ñ–Ω—Ü—ñ**, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ [**runtime.onMessage**](https://developer.chrome.com/docs/extensions/reference/runtime#event-onMessage) **—Å–ª—É—Ö–∞—á –ø–æ–¥—ñ–π** –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è. –¶–µ –≤–∏–≥–ª—è–¥–∞—î –æ–¥–Ω–∞–∫–æ–≤–æ —è–∫ –∑ –∫–æ–Ω—Ç–µ–Ω—Ç-—Å–∫—Ä–∏–ø—Ç–∞, —Ç–∞–∫ —ñ –∑ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

```javascript
// From https://stackoverflow.com/questions/70406787/javascript-send-message-from-content-js-to-background-js
chrome.runtime.onMessage.addListener(
function(request, sender, sendResponse) {
console.log(sender.tab ?
"from a content script:" + sender.tab.url :
"from the extension");
if (request.greeting === "hello")
sendResponse({farewell: "goodbye"});
}
);
```

–£ –≤–∫–∞–∑–∞–Ω–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ **`sendResponse()`** –≤–∏–∫–æ–Ω—É–≤–∞–ª–∞—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ. –©–æ–± –∑–º—ñ–Ω–∏—Ç–∏ –æ–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ–π `onMessage` –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è `sendResponse()`, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤–∫–ª—é—á–∏—Ç–∏ `return true;`.

–í–∞–∂–ª–∏–≤–æ—é —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏ —Ç–µ, —â–æ –≤ —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö, –¥–µ –∫—ñ–ª—å–∫–∞ —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–¥—ñ–π `onMessage`, **–ø–µ—Ä—à–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞, —è–∫–∞ –≤–∏–∫–æ–Ω—É—î `sendResponse()`** –¥–ª—è –ø–µ–≤–Ω–æ—ó –ø–æ–¥—ñ—ó –±—É–¥–µ —î–¥–∏–Ω–æ—é, —è–∫–∞ –∑–º–æ–∂–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–æ—Å—Ç–∞–≤–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å. –ë—É–¥—å-—è–∫—ñ –ø–æ–¥–∞–ª—å—à—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ —Ç—É –∂ –ø–æ–¥—ñ—é –Ω–µ –±—É–¥—É—Ç—å –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏—Å—è.

–ü—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –Ω–æ–≤–∏—Ö —Ä–æ–∑—à–∏—Ä–µ–Ω—å, –ø–µ—Ä–µ–≤–∞–≥–∞ –ø–æ–≤–∏–Ω–Ω–∞ –±—É—Ç–∏ –Ω–∞–¥–∞–Ω–∞ –æ–±—ñ—Ü—è–Ω–∫–∞–º, –∞ –Ω–µ –∑–≤–æ—Ä–æ—Ç–Ω—ñ–º –≤–∏–∫–ª–∏–∫–∞–º. –©–æ–¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–≤–æ—Ä–æ—Ç–Ω–∏—Ö –≤–∏–∫–ª–∏–∫—ñ–≤, —Ñ—É–Ω–∫—Ü—ñ—è `sendResponse()` –≤–≤–∞–∂–∞—î—Ç—å—Å—è –¥—ñ–π—Å–Ω–æ—é –ª–∏—à–µ –≤ —Ç–æ–º—É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –≤–æ–Ω–∞ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ, –∞–±–æ —è–∫—â–æ –æ–±—Ä–æ–±–Ω–∏–∫ –ø–æ–¥—ñ–π –≤–∫–∞–∑—É—î –Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É –æ–ø–µ—Ä–∞—Ü—ñ—é, –ø–æ–≤–µ—Ä—Ç–∞—é—á–∏ `true`. –Ø–∫—â–æ –∂–æ–¥–µ–Ω –∑ –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤ –Ω–µ –ø–æ–≤–µ—Ä—Ç–∞—î `true`, –∞–±–æ —è–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è `sendResponse()` –≤–∏–¥–∞–ª–µ–Ω–∞ –∑ –ø–∞–º'—è—Ç—ñ (—Å–º—ñ—Ç—Ç—î–∑–±—ñ—Ä–Ω–∏–∫–æ–º), –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –≤–∏–∫–ª–∏–∫, –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ —Ñ—É–Ω–∫—Ü—ñ—î—é `sendMessage()`, –±—É–¥–µ –∑–∞–ø—É—â–µ–Ω–∏–π –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º.

## –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –≤ –±—Ä–∞—É–∑–µ—Ä

1. **–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ** —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ —Ç–∞ —Ä–æ–∑–ø–∞–∫—É–π—Ç–µ –π–æ–≥–æ
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **`chrome://extensions/`** —Ç–∞ **—É–≤—ñ–º–∫–Ω—ñ—Ç—å** `–†–µ–∂–∏–º —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞`
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É **`–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ä–æ–∑–ø–∞–∫–æ–≤–∞–Ω–µ`**

–£ **Firefox** –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **`about:debugging#/runtime/this-firefox`** —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É **`–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∏–º—á–∞—Å–æ–≤–µ –¥–æ–¥–∞—Ç–æ–∫`**.

## –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É –∑ –º–∞–≥–∞–∑–∏–Ω—É

–í–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ä—ñ–∑–Ω–∏—Ö –º–µ—Ç–æ–¥—ñ–≤. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω—ñ –ø–æ—è—Å–Ω–µ–Ω–Ω—è —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –∫–æ–∂–Ω–æ—ó –æ–ø—Ü—ñ—ó.

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —è–∫ ZIP —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω–∏–π —Ä—è–¥–æ–∫

–í–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome –º–æ–∂–Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫ ZIP-—Ñ–∞–π–ª –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞. –¶–µ –≤–∫–ª—é—á–∞—î –≤ —Å–µ–±–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `curl` –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è ZIP-—Ñ–∞–π–ª—É –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ URL, –∞ –ø–æ—Ç—ñ–º —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è –≤–º—ñ—Å—Ç—É ZIP-—Ñ–∞–π–ª—É –≤ –∫–∞—Ç–∞–ª–æ–≥. –û—Å—å –∫—Ä–æ–∫–∏:

1. –ó–∞–º—ñ–Ω—ñ—Ç—å `"extension_id"` –Ω–∞ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π ID —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
2. –í–∏–∫–æ–Ω–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏:

```bash
extension_id=your_extension_id   # Replace with the actual extension ID
curl -L -o "$extension_id.zip" "https://clients2.google.com/service/update2/crx?response=redirect&os=mac&arch=x86-64&nacl_arch=x86-64&prod=chromecrx&prodchannel=stable&prodversion=44.0.2403.130&x=id%3D$extension_id%26uc"
unzip -d "$extension_id-source" "$extension_id.zip"
```

### –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –≤–µ–±-—Å–∞–π—Ç CRX Viewer

[https://robwu.nl/crxviewer/](https://robwu.nl/crxviewer/)

### –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è CRX Viewer

–©–µ –æ–¥–∏–Ω –∑—Ä—É—á–Ω–∏–π –º–µ—Ç–æ–¥ - –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–µ—Ä–µ–≥–ª—è–¥–∞—á–∞ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome, —è–∫–∏–π —î –ø—Ä–æ–µ–∫—Ç–æ–º –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –≤–∏—Ö—ñ–¥–Ω–∏–º –∫–æ–¥–æ–º. –ô–æ–≥–æ –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑ [Chrome Web Store](https://chrome.google.com/webstore/detail/chrome-extension-source-v/jifpbeccnghkjeaalbbjmodiffmgedin?hl=en). –í–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ –ø–µ—Ä–µ–≥–ª—è–¥–∞—á–∞ –¥–æ—Å—Ç—É–ø–Ω–∏–π —É –π–æ–≥–æ [—Å—Ö–æ–≤–∏—â—ñ –Ω–∞ GitHub](https://github.com/Rob--W/crxviewer).

### –ü–µ—Ä–µ–≥–ª—è–¥ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É –ª–æ–∫–∞–ª—å–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è

–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –ª–æ–∫–∞–ª—å–Ω–æ, —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏. –û—Å—å —è–∫ —Ü–µ –∑—Ä–æ–±–∏—Ç–∏:

1. –û—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ –∫–∞—Ç–∞–ª–æ–≥—É –≤–∞—à–æ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é Chrome, –≤—ñ–¥–≤—ñ–¥–∞–≤—à–∏ `chrome://version/` —Ç–∞ –∑–Ω–∞—Ö–æ–¥—è—á–∏ –ø–æ–ª–µ "–®–ª—è—Ö –ø—Ä–æ—Ñ—ñ–ª—é".
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –ø—ñ–¥–∫–∞—Ç–∞–ª–æ–≥—É `Extensions/` —É –∫–∞—Ç–∞–ª–æ–∑—ñ –ø—Ä–æ—Ñ—ñ–ª—é.
3. –¶–µ–π –∫–∞—Ç–∞–ª–æ–≥ –º—ñ—Å—Ç–∏—Ç—å –≤—Å—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∑–∞–∑–≤–∏—á–∞–π –∑ —ó—Ö –≤–∏—Ö—ñ–¥–Ω–∏–º –∫–æ–¥–æ–º —É —á–∏—Ç–∞–±–µ–ª—å–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ.

–î–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ä–æ–∑—à–∏—Ä–µ–Ω—å –≤–∏ –º–æ–∂–µ—Ç–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ —ó—Ö —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏:

* –£–≤—ñ–º–∫–Ω—ñ—Ç—å —Ä–µ–∂–∏–º —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ `about:extensions`, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ –∫–æ–∂–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* –£ –∫–æ–∂–Ω–æ–º—É –∫–∞—Ç–∞–ª–æ–∑—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª `manifest.json` –º—ñ—Å—Ç–∏—Ç—å —á–∏—Ç–∞–±–µ–ª—å–Ω–µ –ø–æ–ª–µ `name`, —è–∫–µ –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∞–º —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ –∞—Ä—Ö—ñ–≤–∞—Ç–æ—Ä–∞ –∞–±–æ —Ä–æ–∑–ø–∞–∫—É–≤–∞–ª—å–Ω–∏–∫–∞

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ Chrome Web Store —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è. –§–∞–π–ª –º–∞—Ç–∏–º–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è `.crx`. –ó–º—ñ–Ω—ñ—Ç—å —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—É –∑ `.crx` –Ω–∞ `.zip`. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –±—É–¥—å-—è–∫–∏–π —Ñ–∞–π–ª–æ–≤–∏–π –∞—Ä—Ö—ñ–≤–∞—Ç–æ—Ä (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, WinRAR, 7-Zip —ñ —Ç. –¥.), —â–æ–± —Ä–æ–∑–ø–∞–∫—É–≤–∞—Ç–∏ –≤–º—ñ—Å—Ç ZIP-—Ñ–∞–π–ª—É.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ–∂–∏–º—É —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –≤ Chrome

–í—ñ–¥–∫—Ä–∏–π—Ç–µ Chrome —Ç–∞ –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ `chrome://extensions/`. –£–≤—ñ–º–∫–Ω—ñ—Ç—å "–†–µ–∂–∏–º —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞" —É –ø—Ä–∞–≤–æ–º—É –≤–µ—Ä—Ö–Ω—å–æ–º—É –∫—É—Ç—ñ. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ä–æ–∑–ø–∞–∫–æ–≤–∞–Ω–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è...". –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –∫–∞—Ç–∞–ª–æ–≥—É –≤–∞—à–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è. –¶–µ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥, –∞–ª–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É —Ç–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ–¥—É –≤–∂–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ–≥–æ –∞–±–æ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

## –®–∞–±–ª–æ–Ω –∞—É–¥–∏—Ç—É –±–µ–∑–ø–µ–∫–∏

–ù–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ —Ç–µ, —â–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞ –º–∞—é—Ç—å **–æ–±–º–µ–∂–µ–Ω—É –ø–æ–≤–µ—Ä—Ö–Ω—é –∞—Ç–∞–∫–∏**, –¥–µ—è–∫—ñ –∑ –Ω–∏—Ö –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ **–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ** –∞–±–æ **–ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è**. –û—Å—å –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à—ñ –∑ –Ω–∏—Ö:

* [ ] **–û–±–º–µ–∂—Ç–µ** —è–∫–æ–º–æ–≥–∞ –±—ñ–ª—å—à–µ –∑–∞–ø–∏—Ç–∞–Ω–∏—Ö **`–¥–æ–∑–≤–æ–ª—ñ–≤`**
* [ ] **–û–±–º–µ–∂—Ç–µ** —è–∫–æ–º–æ–≥–∞ –±—ñ–ª—å—à–µ **`host_permissions`**
* [ ] –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **—Å–∏–ª—å–Ω—É** **`content_security_policy`**
* [ ] **–û–±–º–µ–∂—Ç–µ** —è–∫–æ–º–æ–≥–∞ –±—ñ–ª—å—à–µ **`externally_connectable`**, —è–∫—â–æ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —ñ –º–æ–∂–ª–∏–≤–æ, –Ω–µ –∑–∞–ª–∏—à–∞–π—Ç–µ –π–æ–≥–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, –≤–∫–∞–∂—ñ—Ç—å **`{}`**
* [ ] –Ø–∫—â–æ —Ç—É—Ç –∑–≥–∞–¥–∞–Ω–æ **URL, –≤—Ä–∞–∑–ª–∏–≤–∏–π –¥–æ XSS –∞–±–æ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º–æ–∂–µ **–Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –¥–æ —Ñ–æ–Ω–æ–≤–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤**. –î—É–∂–µ –ø–æ—Ç—É–∂–Ω–∏–π –æ–±—Ö—ñ–¥.
* [ ] **–û–±–º–µ–∂—Ç–µ** —è–∫–æ–º–æ–≥–∞ –±—ñ–ª—å—à–µ **`web_accessible_resources`**, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –º–æ–∂–ª–∏–≤–æ, –Ω–∞–≤—ñ—Ç—å –ø–æ—Ä–æ–∂–Ω—å–æ.
* [ ] –Ø–∫—â–æ **`web_accessible_resources`** –Ω–µ —î –ø–æ—Ä–æ–∂–Ω—ñ–º, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**ClickJacking**](browext-clickjacking.md)
* [ ] –Ø–∫—â–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –±—É–¥—å-—è–∫–∞ **–∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è** –≤—ñ–¥ **—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è** –¥–æ **–≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏**, [**–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞ XSS**](browext-xss-example.md) **–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ**, —Å–ø—Ä–∏—á–∏–Ω–µ–Ω—ñ –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—î—é.
* [ ] –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è Post, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å Post**](../postmessage-vulnerabilities/)**.**
* [ ] –Ø–∫—â–æ **–°—Ü–µ–Ω–∞—Ä—ñ–π –≤–º—ñ—Å—Ç—É –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø –¥–æ –¥–µ—Ç–∞–ª–µ–π DOM**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ –≤–æ–Ω–∏ **–Ω–µ –≤–≤–æ–¥—è—Ç—å XSS**, —è–∫—â–æ —ó—Ö **–∑–º—ñ–Ω—é—î** –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∞
* [ ] –ü—Ä–∏–¥—ñ–ª—ñ—Ç—å –æ—Å–æ–±–ª–∏–≤—É —É–≤–∞–≥—É, —è–∫—â–æ —Ü—è –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è —Ç–∞–∫–æ–∂ –≤–∫–ª—é—á–∞—î **–∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—é –º—ñ–∂ —Å—Ü–µ–Ω–∞—Ä—ñ—î–º –≤–º—ñ—Å—Ç—É —Ç–∞ —Ñ–æ–Ω–æ–≤–∏–º —Å—Ü–µ–Ω–∞—Ä—ñ—î–º**
* [ ] **–ß—É—Ç–ª–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –Ω–µ –ø–æ–≤–∏–Ω–Ω–∞ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–¥—É —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞
* [ ] **–ß—É—Ç–ª–∏–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –Ω–µ –ø–æ–≤–∏–Ω–Ω–∞ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–∞–º'—è—Ç—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –±—Ä–∞—É–∑–µ—Ä–∞

## –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

### [**Tarnish**](https://thehackerblog.com/tarnish/)

* –í–∏—Ç—è–≥—É—î –±—É–¥—å-—è–∫–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome –∑ –Ω–∞–¥–∞–Ω–æ–≥–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –º–∞–≥–∞–∑–∏–Ω Chrome.
* [**–ü–µ—Ä–µ–≥–ª—è–¥–∞—á manifest.json**](https://developer.chrome.com/extensions/manifest): –ø—Ä–æ—Å—Ç–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î JSON-–ø—Ä–∏–∫—Ä–∞—à–µ–Ω—É –≤–µ—Ä—Å—ñ—é –º–∞–Ω—ñ—Ñ–µ—Å—Ç–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* **–ê–Ω–∞–ª—ñ–∑ –≤—ñ–¥–±–∏—Ç–∫—ñ–≤**: –í–∏—è–≤–ª–µ–Ω–Ω—è [web\_accessible\_resources](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources) —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è JavaScript –¥–ª—è –≤—ñ–¥–±–∏—Ç–∫—ñ–≤ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome.
* **–ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ Clickjacking**: –í–∏—è–≤–ª–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–æ–∫ HTML —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∑ –¥–∏—Ä–µ–∫—Ç–∏–≤–æ—é [web\_accessible\_resources](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources). –í–æ–Ω–∏ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤—Ä–∞–∑–ª–∏–≤—ñ –¥–æ clickjacking –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–æ–∫.
* **–ü–µ—Ä–µ–≥–ª—è–¥–∞—á –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å –ø—Ä–æ –¥–æ–∑–≤—ñ–ª(–∏)**: —è–∫–∏–π –ø–æ–∫–∞–∑—É—î —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å –ø—Ä–æ –¥–æ–∑–≤—ñ–ª Chrome, —è–∫—ñ –±—É–¥—É—Ç—å –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω—ñ –ø—Ä–∏ —Å–ø—Ä–æ–±—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* **–ù–µ–±–µ–∑–ø–µ—á–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó**: –ø–æ–∫–∞–∑—É—î –º—ñ—Å—Ü–µ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ñ—É–Ω–∫—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ innerHTML, chrome.tabs.executeScript).
* **–¢–æ—á–∫–∏ –≤—Ö–æ–¥—É**: –ø–æ–∫–∞–∑—É—î, –¥–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ø—Ä–∏–π–º–∞—î –∑–æ–≤–Ω—ñ—à–Ω—ñ–π/–∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏–π –≤–≤—ñ–¥. –¶–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è –ø–æ–≤–µ—Ä—Ö–Ω—ñ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ –ø–æ—à—É–∫—É –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏—Ö —Ç–æ—á–æ–∫ –¥–ª—è –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–æ —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö –¥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* –î–ª—è —ó—Ö –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏—Ö –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å —Å–∫–∞–Ω–µ—Ä–∏ Dangerous Function(s) —Ç–∞ Entry Point(s) –º–∞—é—Ç—å –Ω–∞—Å—Ç—É–ø–Ω–µ:
* –í—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥—É —Ç–∞ —Ä—è–¥–æ–∫, —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞–≤ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è.
* –û–ø–∏—Å –ø—Ä–æ–±–ª–µ–º–∏.
* –ö–Ω–æ–ø–∫–∞ "–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Ñ–∞–π–ª" –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É –ø–æ–≤–Ω–æ–≥–æ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É, —â–æ –º—ñ—Å—Ç–∏—Ç—å –∫–æ–¥.
* –®–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É, –Ω–∞ —è–∫–∏–π –±—É–ª–æ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è.
* –ü–æ–≤–Ω–∏–π URI —Ñ–∞–π–ª—É —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è Chrome, –Ω–∞ —è–∫–∏–π –±—É–ª–æ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è.
* –¢–∏–ø —Ñ–∞–π–ª—É, —Ç–∞–∫–∏–π —è–∫ —Å—Ü–µ–Ω–∞—Ä—ñ–π —Ñ–æ–Ω–æ–≤–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏, —Å—Ü–µ–Ω–∞—Ä—ñ–π –≤–º—ñ—Å—Ç—É, –¥—ñ—è –±—Ä–∞—É–∑–µ—Ä–∞ —Ç–æ—â–æ.
* –Ø–∫—â–æ –≤—Ä–∞–∑–ª–∏–≤–∏–π —Ä—è–¥–æ–∫ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ñ–∞–π–ª—ñ JavaScript, —à–ª—è—Ö–∏ –¥–æ –≤—Å—ñ—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫, –¥–µ –≤—ñ–Ω –≤–∫–ª—é—á–µ–Ω–∏–π, –∞ —Ç–∞–∫–æ–∂ —Å—Ç–∞—Ç—É—Å —Ü–∏—Ö —Å—Ç–æ—Ä—ñ–Ω–æ–∫ [web\_accessible\_resource](https://developer.chrome.com/extensions/manifest/web\_accessible\_resources).
* **–ê–Ω–∞–ª—ñ–∑–∞—Ç–æ—Ä –ø–æ–ª—ñ—Ç–∏–∫–∏ –±–µ–∑–ø–µ–∫–∏ –≤–º—ñ—Å—Ç—É (CSP) —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–±—Ö—ñ–¥—É**: –¶–µ –≤–∫–∞–∑—É—î –Ω–∞ —Å–ª–∞–±–∫–æ—Å—Ç—ñ —É –ø–æ–ª—ñ—Ç–∏—Ü—ñ CSP –≤–∞—à–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ —Ç–∞–∫–æ–∂ –ø—ñ–¥—Å–≤—ñ—á—É—î –±—É–¥—å-—è–∫—ñ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ —Å–ø–æ—Å–æ–±–∏ –æ–±—Ö—ñ–¥—É CSP —á–µ—Ä–µ–∑ CDN, —è–∫—ñ –≤–∫–ª—é—á–µ–Ω—ñ –¥–æ –±—ñ–ª–æ–≥–æ —Å–ø–∏—Å–∫—É —Ç–æ—â–æ.
* **–í—ñ–¥–æ–º—ñ –≤—Ä–∞–∑–ª–∏–≤—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏**: –¶–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î [Retire.js](https://retirejs.github.io/retire.js/) –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—ñ–¥–æ–º–æ –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫ JavaScript.
* –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ç–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω—ñ –≤–µ—Ä—Å—ñ—ó.
* –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.
* –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∫—Ä–∞—Å–∏–≤—É –≤–µ—Ä—Å—ñ—é —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏–∫—Ä–∞—à–µ–Ω–∏–π HTML —Ç–∞ JavaScript).
* –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∫–µ—à—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è, –∑–∞–ø—É—Å–∫ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –∑–∞–π–º–µ –±–∞–≥–∞—Ç–æ —á–∞—Å—É –≤–ø–µ—Ä—à–µ, –∫–æ–ª–∏ –≤–∏ –π–æ–≥–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ. –û–¥–Ω–∞–∫ –¥—Ä—É–≥–∏–π —Ä–∞–∑, –∑–∞ —É–º–æ–≤–∏, —â–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –Ω–µ –±—É–ª–æ –æ–Ω–æ–≤–ª–µ–Ω–æ, —Ü–µ –±—É–¥–µ –º–∞–π–∂–µ –º–∏—Ç—Ç—î–≤–æ —á–µ—Ä–µ–∑ –∫–µ—à—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.
* –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∑–≤—ñ—Ç–∏ URL, –ª–µ–≥–∫–æ –Ω–∞–¥–∞–π—Ç–µ –∫–æ–º—É—Å—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∑–≤—ñ—Ç –ø—Ä–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π tarnish.

### [Neto](https://github.com/elevenpaths/neto)

–ü—Ä–æ–µ–∫—Ç Neto - —Ü–µ –ø–∞–∫–µ—Ç Python 3, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É —Ç–∞ —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π –±—Ä–∞—É–∑–µ—Ä–Ω–∏—Ö –ø–ª–∞–≥—ñ–Ω—ñ–≤ —Ç–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω—å –¥–ª—è –≤—ñ–¥–æ–º–∏—Ö –±—Ä–∞—É–∑–µ—Ä—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ Firefox —Ç–∞ Chrome. –í—ñ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É—î –ø—Ä–æ—Ü–µ—Å —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è —É–ø–∞–∫–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ –¥–ª—è –≤–∏–ª—É—á–µ–Ω–Ω—è —Ü–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ —É —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—ñ, —Ç–∞–∫–∏—Ö —è–∫ `manifest.json`, –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ–π–Ω—ñ —Ç–µ–∫–∏ –∞–±–æ —Ñ–∞–π–ª–∏ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É JavaScript —Ç–∞ HTML.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* **–î—è–∫—É—î–º–æ** [**@naivenom**](https://twitter.com/naivenom) **–∑–∞ –¥–æ–ø–æ–º–æ–≥—É –∑ —Ü—ñ—î—é –º–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—î—é**
* [https://www.cobalt.io/blog/introduction-to-chrome-browser-extension-security-testing](https://www.cobalt.io/blog/introduction-to-chrome-browser-extension-security-testing)
* [https://palant.info/2022/08/10/anatomy-of-a-basic-extension/](https://palant.info/2022/08/10/anatomy-of-a-basic-extension/)
* [https://palant.info/2022/08/24/attack-surface-of-extension-pages/](https://palant.info/2022/08/24/attack-surface-of-extension-pages/)
* [https://palant.info/2022/08/31/when-extension-pages-are-web-accessible/](https://palant.info/2022/08/31/when-extension-pages-are-web-accessible/)
* [https://help.passbolt.com/assets/files/PBL-02-report.pdf](https://help.passbolt.com/assets/files/PBL-02-report.pdf)
* [https://developer.chrome.com/docs/extensions/develop/concepts/content-scripts](https://developer.chrome.com/docs/extensions/develop/concepts/content-scripts)
* [https://developer.chrome.com/docs/extensions/mv2/background-pages](https://developer.chrome.com/docs/extensions/mv2/background-pages)
* [https://thehackerblog.com/kicking-the-rims-a-guide-for-securely-writing-and-auditing-chrome-extensions/](https://thehackerblog.com/kicking-the-rims-a-guide-for-securely-writing-and-auditing-chrome-extensions/)
* [https://gist.github.com/LongJohnCoder/9ddf5735df3a4f2e9559665fb864eac0](https://gist.github.com/LongJohnCoder/9ddf5735df3a4f2e9559665fb864eac0)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>
