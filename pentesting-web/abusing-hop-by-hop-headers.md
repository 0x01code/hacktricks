# Hop-by-hop başlıkları

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

* Bir **cybersecurity şirketinde** çalışıyor musunuz? **Şirketinizi HackTricks'te reklamını görmek** ister misiniz? veya **PEASS'ın en son sürümüne veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonunu
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter'da** 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**'u takip edin**.
* **Hacking hilelerinizi [hacktricks repo'ya](https://github.com/carlospolop/hacktricks) ve [hacktricks-cloud repo'ya](https://github.com/carlospolop/hacktricks-cloud) PR göndererek paylaşın**.

</details>

**Bu, [https://nathandavison.com/blog/abusing-http-hop-by-hop-request-headers](https://nathandavison.com/blog/abusing-http-hop-by-hop-request-headers) adresindeki yazının bir özetidir.**

Hop-by-hop başlıkları, özellikle HTTP/1.1'de iki düğüm arasında (istemci-proxy veya proxy-proxy gibi) verileri yönetmek için kullanılan, tek bir taşıma düzeyi bağlantısına özgüdür ve iletilmemesi amaçlanmıştır. Standart hop-by-hop başlıklar arasında `Keep-Alive`, `Transfer-Encoding`, `TE`, `Connection`, `Trailer`, `Upgrade`, `Proxy-Authorization` ve `Proxy-Authenticate` bulunur ve [RFC 2616](https://tools.ietf.org/html/rfc2616#section-13.5.1)'da tanımlanmıştır. Ek başlıklar, `Connection` başlığı aracılığıyla hop-by-hop olarak belirlenebilir.

### Hop-by-Hop Başlıklarının Kötüye Kullanımı
Proxy'ler tarafından hop-by-hop başlıkların yanlış yönetimi güvenlik sorunlarına yol açabilir. Proxy'lerin bu başlıkları kaldırması beklenirken, tüm proxy'ler bunu yapmaz ve potansiyel güvenlik açıkları oluşturur.

### Hop-by-Hop Başlık İşleme Testi
Hop-by-hop başlıkların işlenmesi, belirli başlıklar hop-by-hop olarak işaretlendiğinde sunucu yanıtlarında meydana gelen değişikliklerin gözlemlenerek test edilebilir. Araçlar ve komut dosyaları bu süreci otomatikleştirebilir, proxy'lerin bu başlıkları nasıl yönettiğini belirleyebilir ve yanlış yapılandırmaları veya proxy davranışlarını ortaya çıkarabilir.

Hop-by-hop başlıklarının kötüye kullanılması çeşitli güvenlik sonuçlarına yol açabilir. Aşağıda, bu başlıkların potansiyel saldırılar için nasıl manipüle edilebileceğini gösteren birkaç örnek bulunmaktadır:

### `X-Forwarded-For` ile Güvenlik Kontrollerini Atlama
Bir saldırgan, IP tabanlı erişim kontrollerini atlatabilmek için `X-Forwarded-For` başlığını manipüle edebilir. Bu başlık, proxy'lerin istemcinin kaynak IP adresini takip etmek için sıklıkla kullandığı bir başlıktır. Ancak, bir proxy bu başlığı hop-by-hop olarak işlemeyi ve doğrulama yapmadan iletmeyi tercih ederse, bir saldırgan IP adresini sahteler.

**Saldırı Senaryosu:**
1. Saldırgan, bir proxy'nin arkasındaki bir web uygulamasına sahte bir IP adresini `X-Forwarded-For` başlığında içeren bir HTTP isteği gönderir.
2. Saldırgan ayrıca `Connection: close, X-Forwarded-For` başlığını da ekler, bu da proxy'nin `X-Forwarded-For`'u hop-by-hop olarak işlemesine neden olur.
3. Yanlış yapılandırılmış proxy, sahtelenmiş `X-Forwarded-For` başlığı olmadan isteği web uygulamasına iletiyor.
4. Web uygulaması, orijinal `X-Forwarded-For` başlığını görmeyerek isteği doğrudan güvenilir bir proxyden geliyormuş gibi değerlendirebilir ve yetkisiz erişime izin verebilir.

### Hop-by-Hop Başlık Enjeksiyonu ile Önbellek Zehirlenmesi
Bir önbellek sunucusu, hop-by-hop başlıklara dayalı olarak içeriği yanlış bir şekilde önbelleğe alıyorsa, bir saldırgan kötü amaçlı başlıklar enjekte ederek önbelleği zehirleyebilir. Bu, aynı kaynağı isteyen kullanıcılara yanlış veya kötü amaçlı içerik sunar.

**Saldırı Senaryosu:**
1. Bir saldırgan, önbelleğe alınmaması gereken bir hop-by-hop başlıkla bir web uygulamasına bir istek gönderir (örneğin, `Connection: close, Cookie`).
2. Kötü yapılandırılmış önbellek sunucusu hop-by-hop başlığı kaldırmaz ve saldırganın oturumuna özgü yanıtı önbelleğe alır.
3. Aynı kaynağı isteyen gelecekteki kullanıcılar, saldırgan için özelleştirilmiş önbelleğe alınmış yanıtı alır, bu da oturum ele geçirmeye veya hassas bilgilerin ortaya çıkmasına yol açabilir.

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

* Bir **cybersecurity şirketinde** çalışıyor musunuz? **Şirketinizi HackTricks'te reklamını görmek** ister misiniz? veya **PEASS'ın en son sürümüne veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonunu
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter'da** 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**'u takip edin**.
* **Hacking hilelerinizi [hacktricks repo'ya](https://github.com/carlospolop/hacktricks) ve [hacktricks-cloud repo'ya](https://github.com/carlospolop/hacktricks-cloud) PR göndererek paylaşın**.

</details>
