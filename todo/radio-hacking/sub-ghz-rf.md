# Sub-GHz RF

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Portas de Garagem

Os abridores de portas de garagem geralmente operam em frequ√™ncias na faixa de 300-190 MHz, sendo as frequ√™ncias mais comuns 300 MHz, 310 MHz, 315 MHz e 390 MHz. Essa faixa de frequ√™ncia √© comumente usada para abridores de portas de garagem porque √© menos congestionada do que outras bandas de frequ√™ncia e tem menos probabilidade de sofrer interfer√™ncia de outros dispositivos.

## Portas de Carro

A maioria dos controles remotos de chave de carro opera em **315 MHz ou 433 MHz**. Essas s√£o frequ√™ncias de r√°dio e s√£o usadas em uma variedade de aplica√ß√µes diferentes. A principal diferen√ßa entre as duas frequ√™ncias √© que 433 MHz tem um alcance maior do que 315 MHz. Isso significa que 433 MHz √© melhor para aplica√ß√µes que requerem um alcance maior, como entrada remota sem chave.\
Na Europa, √© comum usar 433,92 MHz e nos EUA e no Jap√£o √© 315 MHz.

## **Ataque de For√ßa Bruta**

<figure><img src="../../.gitbook/assets/image (4) (3) (2).png" alt=""><figcaption></figcaption></figure>

Se, em vez de enviar cada c√≥digo 5 vezes (enviado dessa forma para garantir que o receptor o receba), voc√™ enviar apenas uma vez, o tempo √© reduzido para 6 minutos:

<figure><img src="../../.gitbook/assets/image (1) (1) (2) (2).png" alt=""><figcaption></figcaption></figure>

e se voc√™ **remover o per√≠odo de espera de 2 ms** entre os sinais, voc√™ pode **reduzir o tempo para 3 minutos**.

Al√©m disso, usando a Sequ√™ncia de De Bruijn (uma maneira de reduzir o n√∫mero de bits necess√°rios para enviar todos os n√∫meros bin√°rios potenciais para for√ßa bruta), esse **tempo √© reduzido para apenas 8 segundos**:

<figure><img src="../../.gitbook/assets/image (5) (2) (3).png" alt=""><figcaption></figcaption></figure>

Um exemplo desse ataque foi implementado em [https://github.com/samyk/opensesame](https://github.com/samyk/opensesame)

Exigir **um pre√¢mbulo evitar√° a otimiza√ß√£o da Sequ√™ncia de De Bruijn** e **c√≥digos rolantes impedir√£o esse ataque** (supondo que o c√≥digo seja longo o suficiente para n√£o ser for√ßa bruta).

## Ataque Sub-GHz

Para atacar esses sinais com o Flipper Zero, verifique:

{% content-ref url="flipper-zero/fz-sub-ghz.md" %}
[fz-sub-ghz.md](flipper-zero/fz-sub-ghz.md)
{% endcontent-ref %}

## Prote√ß√£o de C√≥digos Rolantes

Os abridores autom√°ticos de portas de garagem geralmente usam um controle remoto sem fio para abrir e fechar a porta da garagem. O controle remoto **envia um sinal de frequ√™ncia de r√°dio (RF)** para o abridor da porta da garagem, que ativa o motor para abrir ou fechar a porta.

√â poss√≠vel para algu√©m usar um dispositivo conhecido como um capturador de c√≥digo para interceptar o sinal de RF e grav√°-lo para uso posterior. Isso √© conhecido como um **ataque de repeti√ß√£o**. Para evitar esse tipo de ataque, muitos abridores modernos de portas de garagem usam um m√©todo de criptografia mais seguro conhecido como um sistema de **c√≥digo rolante**.

O **sinal de RF √© transmitido usando um c√≥digo rolante**, o que significa que o c√≥digo muda a cada uso. Isso torna **dif√≠cil** para algu√©m **interceptar** o sinal e **us√°-lo** para obter acesso **n√£o autorizado** √† garagem.

Em um sistema de c√≥digo rolante, o controle remoto e o abridor da porta da garagem t√™m um **algoritmo compartilhado** que **gera um novo c√≥digo** cada vez que o controle remoto √© usado. O abridor da porta da garagem s√≥ responder√° ao **c√≥digo correto**, tornando muito mais dif√≠cil para algu√©m obter acesso n√£o autorizado √† garagem apenas capturando um c√≥digo.

### **Ataque de Elo Perdido**

Basicamente, voc√™ ouve o bot√£o e **captura o sinal enquanto o controle remoto est√° fora do alcance** do dispositivo (digamos o carro ou a garagem). Em seguida, voc√™ se move para o dispositivo e **usa o c√≥digo capturado para abri-lo**.

### Ataque de Jamming de Link Completo

Um atacante pode **interferir no sinal perto do ve√≠culo ou receptor** para que o **receptor n√£o consiga 'ouvir' o c√≥digo**, e uma vez que isso esteja acontecendo, voc√™ pode simplesmente **capturar e reproduzir** o c√≥digo quando parar de interferir.

A v√≠tima em algum momento usar√° as **chaves para trancar o carro**, mas ent√£o o ataque ter√° **gravado c√≥digos de "fechar a porta" suficientes** que, esperan√ßosamente, poderiam ser reenviados para abrir a porta (uma **mudan√ßa de frequ√™ncia pode ser necess√°ria**, pois existem carros que usam os mesmos c√≥digos para abrir e fechar, mas ouvem ambos os comandos em frequ√™ncias diferentes).

{% hint style="warning" %}
**O Jamming funciona**, mas √© percept√≠vel, pois se a **pessoa que tranca o carro simplesmente testar as portas** para garantir que estejam trancadas, ela perceber√° que o carro est√° destrancado. Al√©m disso, se estiverem cientes de tais ataques, eles podem at√© ouvir o fato de que as portas n√£o fizeram o **som** de travamento ou as **luzes** do carro n√£o piscaram quando pressionaram o bot√£o 'travar'.
{% endhint %}
### **Ataque de Captura de C√≥digo (tamb√©m conhecido como 'RollJam')**

Este √© uma t√©cnica de **interfer√™ncia mais furtiva**. O atacante ir√° interferir no sinal, de modo que quando a v√≠tima tente trancar a porta, n√£o funcione, mas o atacante ir√° **gravar esse c√≥digo**. Em seguida, a v√≠tima ir√° **tentar trancar o carro novamente** pressionando o bot√£o e o carro ir√° **gravar esse segundo c√≥digo**.\
Imediatamente ap√≥s isso, o **atacante pode enviar o primeiro c√≥digo** e o **carro ir√° trancar** (a v√≠tima pensar√° que a segunda press√£o o fechou). Em seguida, o atacante ser√° capaz de **enviar o segundo c√≥digo roubado para abrir** o carro (supondo que um **c√≥digo de "fechar carro" tamb√©m possa ser usado para abri-lo**). Uma mudan√ßa de frequ√™ncia pode ser necess√°ria (pois existem carros que usam os mesmos c√≥digos para abrir e fechar, mas escutam ambos os comandos em frequ√™ncias diferentes).

O atacante pode **interferir no receptor do carro e n√£o no seu receptor** porque se o receptor do carro estiver escutando, por exemplo, em uma banda larga de 1MHz, o atacante n√£o ir√° **interferir** na frequ√™ncia exata usada pelo controle remoto, mas sim **em uma pr√≥xima nesse espectro**, enquanto o **receptor do atacante estar√° escutando em uma faixa menor** onde ele pode escutar o sinal do controle remoto **sem o sinal de interfer√™ncia**.

{% hint style="warning" %}
Outras implementa√ß√µes vistas em especifica√ß√µes mostram que o **c√≥digo rolante √© uma parte** do c√≥digo total enviado. Ou seja, o c√≥digo enviado √© uma **chave de 24 bits**, onde os primeiros **12 s√£o o c√≥digo rolante**, os **segundos 8 s√£o o comando** (como trancar ou destrancar) e os √∫ltimos 4 s√£o o **checksum**. Ve√≠culos que implementam esse tipo tamb√©m s√£o naturalmente suscet√≠veis, pois o atacante s√≥ precisa substituir o segmento do c√≥digo rolante para poder **usar qualquer c√≥digo rolante em ambas as frequ√™ncias**.
{% endhint %}

{% hint style="danger" %}
Observe que se a v√≠tima enviar um terceiro c√≥digo enquanto o atacante estiver enviando o primeiro, o primeiro e o segundo c√≥digo ser√£o invalidados.
{% endhint %}

### Ataque de Interfer√™ncia com Alarme Sonoro

Testando contra um sistema de c√≥digo rolante de mercado instalado em um carro, **enviar o mesmo c√≥digo duas vezes** imediatamente **ativou o alarme** e o imobilizador, proporcionando uma oportunidade √∫nica de **nega√ß√£o de servi√ßo**. Ironicamente, a forma de **desativar o alarme** e o imobilizador era **pressionar** o **controle remoto**, fornecendo ao atacante a capacidade de **realizar continuamente um ataque de nega√ß√£o de servi√ßo**. Ou misturar esse ataque com o **anterior para obter mais c√≥digos**, j√° que a v√≠tima gostaria de interromper o ataque o mais r√°pido poss√≠vel.

## Refer√™ncias

* [https://www.americanradioarchives.com/what-radio-frequency-does-car-key-fobs-run-on/](https://www.americanradioarchives.com/what-radio-frequency-does-car-key-fobs-run-on/)
* [https://www.andrewmohawk.com/2016/02/05/bypassing-rolling-code-systems/](https://www.andrewmohawk.com/2016/02/05/bypassing-rolling-code-systems/)
* [https://samy.pl/defcon2015/](https://samy.pl/defcon2015/)
* [https://hackaday.io/project/164566-how-to-hack-a-car/details](https://hackaday.io/project/164566-how-to-hack-a-car/details)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Gostaria de ver sua **empresa anunciada no HackTricks**? Ou gostaria de ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e para o** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
