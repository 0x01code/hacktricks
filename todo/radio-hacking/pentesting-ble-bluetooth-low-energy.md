# Pentesting BLE - Bluetooth Low Energy

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a> <strong>рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ **рд╣рдореЗрдВ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)\*\* рдкрд░ рдлреЙрд▓реЛ\*\* рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдкрд░рд┐рдЪрдп

Bluetooth 4.0 рд╡рд┐рдирд┐рд░реНрджрд┐рд╖реНрдЯрд┐ рдХреЗ рдмрд╛рдж рд╕реЗ рдЙрдкрд▓рдмреНрдз, BLE рдХреЗрд╡рд▓ 40 рдЪреИрдирд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ 2400 рд╕реЗ 2483.5 рдореЗрдЧрд╛рд╣рд░реНрдЯреНрдЬ рдХреА рд╢реНрд░реЗрдгреА рдХреЛ рдХрд╡рд░ рдХрд░рддрд╛ рд╣реИред рдЙрдкрдпреБрдХреНрддрддрд╛, рдкрд╛рд░рдВрдкрд░рд┐рдХ рдмреНрд▓реВрдЯреВрде рдЙрд╕реА рд╢реНрд░реЗрдгреА рдореЗрдВ 79 рдЪреИрдирд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

BLE рдбрд┐рд╡рд╛рдЗрд╕ рдХрдореНрдпреБрдирд┐рдХреЗрдЯ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ **рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреИрдХреЗрдЯ** (**рдмреАрдХрдиреНрд╕**) рднреЗрдЬрдХрд░ рд╣реЛрддрд╛ рд╣реИ, рдпреЗ рдкреИрдХреЗрдЯреНрд╕ BLE рдбрд┐рд╡рд╛рдЗрд╕ рдХреА рдореМрдЬреВрджрдЧреА рдХреЛ рдЕрдиреНрдп рдирдЬрджреАрдХреА рдбрд┐рд╡рд╛рдЗрд╕реЛрдВ рдХреЛ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдпреЗ рдмреАрдХрдиреНрд╕ рдХрднреА-рдХрднреА **рдбреЗрдЯрд╛ рднреА рднреЗрдЬрддреЗ** рд╣реИрдВред

рд╕реБрдирдиреЗ рд╡рд╛рд▓реА рдбрд┐рд╡рд╛рдЗрд╕, рдЬрд┐рд╕реЗ рдХреЗрдВрджреНрд░реАрдп рдбрд┐рд╡рд╛рдЗрд╕ рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ **рд╕реНрдХреИрди рдЕрдиреБрд░реЛрдз** рдХреЗ рд╕рд╛рде рдПрдХ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреИрдХреЗрдЯ рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗ рд╕рдХрддреА рд╣реИ, рдЬреЛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЙрд╕ рд╕реНрдХреИрди рдХрд╛ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рд╡рд╣реА рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ **рд╡рд┐рдЬреНрдЮрд╛рдкрди** рдкреИрдХреЗрдЯ рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рд╣реИ рдЬреЛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдЕрдиреБрд░реЛрдз рдореЗрдВ рдлрд┐рдЯ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА, рдЬреИрд╕реЗ рдкреВрд░рд╛ рдбрд┐рд╡рд╛рдЗрд╕ рдирд╛рдоред

![](<../../.gitbook/assets/image (201) (2) (1) (1).png>)

рдкреНрд░реАрдПрдореНрдмрд▓ рдмрд╛рдЗрдЯ рдлреНрд░реАрдХреНрд╡реЗрдВрд╕реА рдХреЛ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝ рдХрд░рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЪрд╛рд░-рдмрд╛рдЗрдЯ рдПрдХреНрд╕реЗрд╕ рдкрддрд╛ рдПрдХ **рдХрдиреЗрдХреНрд╢рди рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛** рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд╣ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдбрд┐рд╡рд╛рдЗрд╕ рд╕рдорд╛рди рдЪреИрдирд▓ рдкрд░ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВред рдЕрдЧрд▓рд╛, рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдбреЗрдЯрд╛ рдЗрдХрд╛рдИ (**PDU**) рдореЗрдВ **рд╡рд┐рдЬреНрдЮрд╛рдкрди рдбреЗрдЯрд╛** рд╣реЛрддрд╛ рд╣реИред рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреА PDU рд╣реЛрддреА рд╣реИрдВ; рд╕рдмрд╕реЗ рдЖрдо рдЙрдкрдпреЛрдЧ рд╣реЛрдиреЗ рд╡рд╛рд▓реА ADV\_NONCONN\_IND рдФрд░ ADV\_IND рд╣реИрдВред рдбрд┐рд╡рд╛рдЗрд╕ рдЕрдЧрд░ **рдХрдиреЗрдХреНрд╢рди рд╕реНрд╡реАрдХрд╛рд░ рдирд╣реАрдВ рдХрд░рддреЗ** рд╣реИрдВ рддреЛ рд╡реЗ **ADV\_NONCONN\_IND** PDU рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдХреЗрд╡рд▓ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреИрдХреЗрдЯ рдореЗрдВ рдбреЗрдЯрд╛ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдбрд┐рд╡рд╛рдЗрд╕ **ADV\_IND** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЕрдЧрд░ рд╡реЗ **рдХрдиреЗрдХреНрд╢рди рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддреЗ** рд╣реИрдВ рдФрд░ **рдХрдиреЗрдХреНрд╢рди** рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж **рд╡рд┐рдЬреНрдЮрд╛рдкрди** рдкреИрдХреЗрдЯ рднреЗрдЬрдирд╛ рдмрдВрдж рдХрд░ рджреЗрддреЗ рд╣реИрдВред

### GATT

**рдЬреЗрдиреЗрд░рд┐рдХ рдЧреБрдг рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓** (GATT) рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ **рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдбреЗрдЯрд╛ рдХреЛ рдХреИрд╕реЗ рд╕реНрд╡рд░реВрдкрд┐рдд рдФрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП**ред рдЬрдм рдЖрдк рдПрдХ BLE рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд╣рдорд▓реЗ рдХреА рд╕рддрд╣ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░ рд░рд╣реЗ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЕрдХреНрд╕рд░ рдЧреИрдЯ (рдпрд╛ рдЧреИрдЯреНрд╕) рдкрд░ рдЕрдкрдирд╛ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╣реИ рдХрд┐ **рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдкреНрд░реЗрд░рд┐рдд** рдХрд░рддрд╛ рд╣реИ рдФрд░ рдбреЗрдЯрд╛ рдХреЛ рдХреИрд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд, рд╕рдореВрд╣рд┐рдд рдФрд░ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред GATT рдПрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ, рд╡рд┐рд╡рд░рдгрдХрд░реНрддрд╛, рдФрд░ рд╕реЗрд╡рд╛рдПрдБ рдПрдХ рд╕рд╛рд░рдгреА рдореЗрдВ 16- рдпрд╛ 32-рдмрд┐рдЯ рдорд╛рдиреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╣реЛрддреА рд╣реИрдВред рдПрдХ **рд╡рд┐рд╢реЗрд╖рддрд╛** рдПрдХ **рдбреЗрдЯрд╛** рдорд╛рди рд╣реИ рдЬреЛ рдХреЗрдВрджреНрд░реАрдп рдбрд┐рд╡рд╛рдЗрд╕ рдФрд░ рдкреЗрд░рд┐рдлреЗрд░рд▓ рдХреЗ рдмреАрдЪ **рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдЗрди рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЗ рдкрд╛рд╕ **рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╡рд┐рд╡рд░рдгрдХрд░реНрддрд╛** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред **рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ** рдЕрдХреНрд╕рд░ **рд╕реЗрд╡рд╛рдУрдВ** рдореЗрдВ **рд╕рдореВрд╣рд┐рдд** рд╣реЛрддреА рд╣реИрдВ рдЕрдЧрд░ рд╡реЗ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдХреНрд░рд┐рдпрд╛ рдХреЛ рдХрд░рдиреЗ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВред

## рдЧрдгрдирд╛

```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```

### GATTool

**GATTool** рджреВрд╕рд░реЗ рдЙрдкрдХрд░рдг рдХреЗ рд╕рд╛рде **рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЙрд╕ рдЙрдкрдХрд░рдг рдХреА **рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ** рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдиреЗ рдФрд░ рдЙрд╕рдХреА рдЧреБрдгрдзрд░реНрдореЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рдФрд░ рд▓рд┐рдЦрдиреЗ рдХреАред\
GATTTool рдПрдХ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рд╢реИрд▓реА рд▓реЙрдиреНрдЪ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ `-I` рд╡рд┐рдХрд▓реНрдк рд╣реЛрддрд╛ рд╣реИ:

```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```

### рдмреЗрдЯрд░рдХреИрдк

```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)\*\* рдкрд░ рдлреЙрд▓реЛ\*\* рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
