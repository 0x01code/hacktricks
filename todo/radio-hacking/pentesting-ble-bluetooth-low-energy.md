# Pentesting BLE - Bluetooth Low Energy

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories senden.

</details>

## Einf√ºhrung

Seit der Bluetooth-Spezifikation 4.0 verwendet BLE nur 40 Kan√§le, die den Bereich von 2400 bis 2483,5 MHz abdecken. Im Gegensatz dazu verwendet das traditionelle Bluetooth 79 Kan√§le in diesem Bereich.

BLE-Ger√§te kommunizieren, indem sie **Werbe-Pakete** (**Beacons**) senden, die die Existenz des BLE-Ger√§ts an andere nahegelegene Ger√§te √ºbertragen. Diese Beacons senden manchmal auch **Daten**.

Das empfangende Ger√§t, auch Zentralger√§t genannt, kann auf ein Werbepaket mit einer speziell an das Werbeger√§t gesendeten **SCAN-Anforderung** antworten. Die **Antwort** auf diesen Scan verwendet die gleiche Struktur wie das **Werbe**-Paket mit zus√§tzlichen Informationen, die nicht in der urspr√ºnglichen Werbeanfrage enthalten waren, wie z.B. der vollst√§ndige Ger√§tename.

![](<../../.gitbook/assets/image (201) (2) (1) (1).png>)

Das Pr√§ambelbyte synchronisiert die Frequenz, w√§hrend die vier Byte lange Zugriffsadresse eine **Verbindungsidentifikation** ist, die in Szenarien verwendet wird, in denen mehrere Ger√§te versuchen, Verbindungen auf den gleichen Kan√§len herzustellen. Als n√§chstes enth√§lt die Protocol Data Unit (**PDU**) die **Werbedaten**. Es gibt verschiedene Arten von PDU; die am h√§ufigsten verwendeten sind ADV\_NONCONN\_IND und ADV\_IND. Ger√§te verwenden den PDU-Typ **ADV\_NONCONN\_IND**, wenn sie **keine Verbindungen akzeptieren** und Daten nur im Werbepaket √ºbertragen. Ger√§te verwenden **ADV\_IND**, wenn sie **Verbindungen zulassen** und das Senden von Werbepaketen einstellen, sobald eine **Verbindung hergestellt** wurde.

### GATT

Das **Generic Attribute Profile** (GATT) definiert, wie die **Ger√§tedaten formatiert und √ºbertragen werden** sollen. Wenn Sie die Angriffsfl√§che eines BLE-Ger√§ts analysieren, konzentrieren Sie sich oft auf das GATT (oder GATTs), da es ausl√∂st, wie die **Ger√§tefunktionalit√§t ausgel√∂st wird** und wie Daten gespeichert, gruppiert und ge√§ndert werden. Das GATT listet die Eigenschaften, Deskriptoren und Dienste eines Ger√§ts in einer Tabelle als 16- oder 32-Bit-Werte auf. Eine **Eigenschaft** ist ein **Datenwert**, der zwischen dem Zentralger√§t und dem Peripherieger√§t **gesendet** wird. Diese Eigenschaften k√∂nnen **Deskriptoren** haben, die **zus√§tzliche Informationen √ºber sie bereitstellen**. **Eigenschaften** werden oft in **Diensten** gruppiert, wenn sie mit einer bestimmten Aktion zusammenh√§ngen.

## Enumeration

```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```

### GATTool

**GATTool** erm√∂glicht es, eine Verbindung zu einem anderen Ger√§t herzustellen, die Eigenschaften dieses Ger√§ts aufzulisten und seine Attribute zu lesen und zu schreiben.\
GATTTool kann mit der Option `-I` eine interaktive Shell starten:

```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```

### Bettercap

Bettercap ist ein leistungsstarkes Tool f√ºr das Pentesting von Bluetooth Low Energy (BLE). Es bietet eine Vielzahl von Funktionen, die es Hackern erm√∂glichen, Schwachstellen in BLE-Ger√§ten zu identifizieren und auszunutzen.

Mit Bettercap k√∂nnen Sie BLE-Ger√§te scannen, um Informationen wie Ger√§te-IDs, Dienste und Charakteristiken zu erhalten. Sie k√∂nnen auch den Datenverkehr zwischen einem BLE-Ger√§t und einem verbundenen Ger√§t abfangen und analysieren.

Dar√ºber hinaus bietet Bettercap Funktionen zum Spoofing von BLE-Ger√§ten, zum Erzwingen von Verbindungen zu bestimmten Ger√§ten und zum Senden von benutzerdefinierten BLE-Paketen. Dies erm√∂glicht es Hackern, Angriffe wie Man-in-the-Middle-Angriffe, Denial-of-Service-Angriffe und das Ausnutzen von Schwachstellen in BLE-Protokollen durchzuf√ºhren.

Bettercap ist ein √§u√üerst vielseitiges Tool, das sowohl f√ºr Anf√§nger als auch f√ºr erfahrene Hacker geeignet ist. Es bietet eine benutzerfreundliche Oberfl√§che und eine umfangreiche Dokumentation, die Ihnen bei der Durchf√ºhrung von BLE-Pentests hilft.

Um Bettercap zu verwenden, m√ºssen Sie es auf Ihrem Pentesting-System installieren und die erforderlichen Abh√§ngigkeiten installieren. Anschlie√üend k√∂nnen Sie das Tool √ºber die Befehlszeile aufrufen und die verschiedenen Funktionen nutzen, um BLE-Ger√§te zu hacken und Schwachstellen auszunutzen.

Bettercap ist ein unverzichtbares Tool f√ºr jeden Hacker, der sich mit BLE-Pentesting besch√§ftigt. Es bietet eine breite Palette von Funktionen, die Ihnen helfen, Schwachstellen in BLE-Ger√§ten zu identifizieren und auszunutzen, um Zugriff auf sensible Informationen zu erhalten.

```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
