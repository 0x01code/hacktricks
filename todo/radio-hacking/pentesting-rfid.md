# Pentesting RFID

<details>

<summary><strong>Jifunze kuhusu kuhack AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Je, unafanya kazi katika **kampuni ya usalama wa mtandao**? Je, ungependa kuona **kampuni yako ikionekana katika HackTricks**? au ungependa kupata **toleo jipya zaidi la PEASS au kupakua HackTricks kwa PDF**? Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* **Jiunge na** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **nifuate** kwenye **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kuhack kwa kuwasilisha PRs kwenye** [**repo ya hacktricks**](https://github.com/carlospolop/hacktricks) **na** [**repo ya hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Utangulizi

**Ufuatiliaji wa Kitambulisho cha Mzunguko wa Redio (RFID)** ni suluhisho maarufu zaidi la redio kwa umbali mfupi. Kawaida hutumiwa kuhifadhi na kuhamisha habari inayotambulisha kifaa.

Lebo ya RFID inaweza kutegemea **chanzo chake cha nguvu (active)**, kama betri iliyowekwa, au kupokea nguvu yake kutoka kwa antena ya kusoma kwa kutumia sasa **uliochochewa kutoka kwa mawimbi ya redio yaliyopokelewa** (**passive**).

### Madarasa

EPCglobal inagawanya vitambulisho vya RFID katika makundi sita. Kitambulisho katika kila kategoria kina uwezo wote uliotajwa katika kategoria ya awali, ikifanya iwe nyuma ya sambamba.

* Vitambulisho vya **Darasa 0** ni vitambulisho **passive** ambavyo hufanya kazi katika bendi za **UHF**. Muuzaji anaweka mipangilio yao kabla ya kuzalishwa kiwandani. Kama matokeo, huwezi **kubadilisha** habari iliyohifadhiwa kwenye kumbukumbu yao.
* Vitambulisho vya **Darasa 1** pia vinaweza kufanya kazi katika bendi za **HF**. Aidha, vinaweza kuandikwa **mara moja tu** baada ya kuzalishwa. Vitambulisho vingi vya Darasa 1 vinaweza pia kusindika **cyclic redundancy checks** (CRCs) ya amri wanazopokea. CRC ni baadhi ya herufi za ziada mwishoni mwa amri kwa ajili ya ugunduzi wa makosa.
* Vitambulisho vya **Darasa 2** vinaweza kuandikwa **marudio kadhaa**.
* Vitambulisho vya **Darasa 3** vinaweza kuwa na **sensori zilizojumuishwa** ambazo zinaweza kurekodi vigezo vya mazingira, kama vile joto la sasa au mwendo wa kadi. Vitambulisho hivi ni **nusu-passive**, kwa sababu ingawa vina chanzo cha nguvu kilichojumuishwa, kama vile **betri iliyowekwa**, haviwezi kuanzisha **mawasiliano** ya wireless na vitambulisho au wasomaji wengine.
* Vitambulisho vya **Darasa 4** vinaweza kuanzisha mawasiliano na vitambulisho vingine vya darasa moja, vikifanya kuwa vitambulisho **active**.
* Vitambulisho vya **Darasa 5** vinaweza kutoa **nguvu kwa vitambulisho vingine na kuwasiliana na vitambulisho vyote vya darasa la awali**. Vitambulisho vya Darasa 5 vinaweza kutenda kama **wasomaji wa RFID**.

### Habari Iliyohifadhiwa kwenye Vitambulisho vya RFID

Kawaida, kumbukumbu ya vitambulisho vya RFID inahifadhi aina nne za data: data ya **kitambulisho**, ambayo **inatambulisha** kifaa ambacho kitambulisho kimeambatanishwa (data hii inajumuisha uga uliowekwa na mtumiaji, kama akaunti za benki); data ya **nyongeza**, ambayo hutoa **maelezo zaidi** kuhusu kifaa; data ya **udhibiti**, inayotumiwa kwa **mpangilio** wa ndani wa kitambulisho; na data ya **mtengenezaji** ya kitambulisho, ambayo ina kitambulisho cha kipekee cha kitambulisho (**UID**) na maelezo kuhusu **uzalishaji**, **aina**, na **muuzaji** wa kitambulisho. Utapata aina mbili za kwanza za data katika vitambulisho vyote vya kibiashara; zingine mbili za mwisho zinaweza kutofautiana kulingana na muuzaji wa kitambulisho.

Kiwango cha ISO kinabainisha thamani ya Kitambulisho cha Familia ya Maombi (**AFI**), nambari inayoonyesha **aina ya kitu** ambacho kitambulisho kinamiliki. Usajili muhimu mwingine, uliobainishwa pia na ISO, ni Kitambulisho cha Muundo wa Uhifadhi wa Data (**DSFID**), ambayo inafafanua **muundo wa mantiki wa data ya mtumiaji**.

Vizuizi vingi vya **usalama** vya RFID vina mifumo ambayo **inazuia** shughuli za **kusoma** au **kuandika** kwenye kila kizuizi cha kumbukumbu ya mtumiaji na kwenye usajili maalum unaohifadhi thamani ya AFI na DSFID. Mifumo hii ya **kufunga** hutumia data iliyohifadhiwa kwenye kumbukumbu ya udhibiti na ina **nywila za chaguo-msingi** zilizowekwa mapema na muuzaji lakini inaruhusu wamiliki wa vitambulisho kuweka **nywila za desturi**.

### Linganisha Vitambulisho vya Mzunguko wa Chini na Mzunguko wa Juu

<figure><img src="../../.gitbook/assets/image (27).png" alt=""><figcaption></figcaption></figure>

## Vitambulisho vya Mzunguko wa Chini (125kHz)

**Vitambulisho vya mzunguko wa chini** mara nyingi hutumiwa katika mifumo ambayo **haitaji usalama mkubwa**: kuingia majengo, funguo za intercom, kadi za uanachama wa mazoezi, n.k. Kwa sababu ya umbali wao mpana, ni rahisi kutumia kwa maegesho ya gari ya kulipwa: dereva hahitaji kuleta kadi karibu na kusoma, kwani inaanzishwa kutoka umbali zaidi. Wakati huo huo, vitambulisho vya mzunguko wa chini ni vya kawaida sana, vina kiwango cha chini cha uhamishaji wa data. Kwa sababu hiyo, haiwezekani kutekeleza uhamishaji wa data wa pande mbili wa kina kwa mambo kama vile kudumisha usawa na kriptografia. Vitambulisho vya mzunguko wa chini hutoa tu kitambulisho fupi bila njia yoyote ya uwakilishi.

Vifaa hivi hutegemea teknolojia ya **RFID** **passive** na hufanya kazi katika **umbali wa 30 kHz hadi 300 kHz**, ingawa ni kawaida kutumia 125 kHz hadi 134 kHz:

* **Umbali Mrefu** - mzunguko wa chini unamaanisha umbali mkubwa. Kuna wasomaji wa EM-Marin na HID, ambao hufanya kazi kutoka umbali wa hadi mita moja. Mara nyingi hutumiwa katika maegesho ya gari.
* \*\*It

## Vitambulisho vya RFID vya Mzunguko wa Juu (13.56 MHz)

**Vitambulisho vya mzunguko wa juu** hutumiwa kwa mwingiliano wa kusoma na kuandika wa kina kati ya kifaa cha kusoma na kadi ya RFID, ambapo unahitaji kriptografia, uhamisho mkubwa wa data, uthibitisho, nk. Kawaida hupatikana kwenye kadi za benki, usafiri wa umma, na vitambulisho vingine vya usalama.

**Vitambulisho vya mzunguko wa juu wa 13.56 MHz ni seti ya viwango na itifaki**. Kawaida huitwa [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/), lakini hiyo sio sahihi kila wakati. Itifaki ya msingi inayotumiwa kwenye viwango vya kimwili na mantiki ni ISO 14443. Itifaki za kiwango cha juu, pamoja na viwango mbadala (kama vile ISO 19092), zimejengwa juu yake. Wengi huita teknolojia hii **Mawasiliano ya Uwanja wa Karibu (NFC)**, ambayo ni neno linalotumika kwa vifaa vinavyofanya kazi kwenye mzunguko wa 13.56 MHz.

<figure><img src="../../.gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>

Kwa kifupi, muundo wa NFC unafanya kazi kama ifuatavyo: itifaki ya uhamisho inachaguliwa na kampuni inayotengeneza kadi na kutekelezwa kulingana na kiwango cha chini cha ISO 14443. Kwa mfano, NXP iliunda itifaki yake ya uhamisho ya kiwango cha juu inayoitwa Mifare. Lakini kwenye kiwango cha chini, kadi za Mifare zimejengwa kwa msingi wa kiwango cha ISO 14443-A.

Flipper inaweza kuingiliana na itifaki ya ISO 14443 ya kiwango cha chini, pamoja na itifaki ya uhamisho wa data ya Mifare Ultralight na EMV inayotumiwa kwenye kadi za benki. Tunafanya kazi ya kuongeza msaada kwa Mifare Classic na NFC NDEF. Uchunguzi wa kina wa itifaki na viwango vinavyounda NFC unastahili makala tofauti ambayo tunapanga kuandika baadaye.

Vitambulisho vyote vya mzunguko wa juu vilivyojengwa kwa msingi wa kiwango cha ISO 14443-A vina kitambulisho cha chip kinachofanya kazi kama nambari ya kipekee ya kadi, kama anwani ya MAC ya kadi ya mtandao. **Kawaida, UID ina urefu wa byte 4 au 7**, lakini mara chache inaweza kwenda **hadi 10**. UIDs sio siri na inaweza kusomwa kwa urahisi, **wakati mwingine hata imechapishwa kwenye kadi yenyewe**.

Kuna mifumo mingi ya kudhibiti ufikiaji ambayo inategemea UID kwa **uthibitisho na kutoa ufikiaji**. Mara nyingi hii hufanyika **hata** wakati vitambulisho vya RFID **vinasaidia kriptografia**. Matumizi kama hayo yanawafanya kuwa sawa na vitambulisho **dumavu vya kHz 125** kwa suala la **usalama**. Kadi za kawaida (kama Apple Pay) hutumia UID ya kubadilika ili wamiliki wa simu wasifungue milango na programu yao ya malipo.

* **Upeo mdogo** - kadi za mzunguko wa juu zimeundwa maalum ili ziweze kuwekwa karibu na kifaa cha kusoma. Hii pia husaidia kulinda kadi kutokana na mwingiliano usiohalali. Upeo mkubwa wa kusoma ambao tumeweza kufikia ni takriban 15 cm, na hiyo ilikuwa na wasomaji maalum wenye upeo mkubwa.
* **Itifaki za juu** - kasi ya uhamisho wa data hadi 424 kbps inaruhusu itifaki ngumu na uhamisho kamili wa data kwa pande zote mbili. Ambayo kwa upande mwingine **inaruhusu kriptografia**, uhamisho wa data, nk.
* **Usalama wa juu** - kadi zisizo na mawasiliano za mzunguko wa juu haziko nyuma kwa kadi za akili kwa njia yoyote. Kuna kadi ambazo zinasaidia algorithm zenye nguvu za kriptografia kama AES na kutekeleza kriptografia isiyolingana.

### Shambulio

Unaweza **kushambulia Vitambulisho hivi na Flipper Zero**:

{% content-ref url="flipper-zero/fz-nfc.md" %}
[fz-nfc.md](flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Au kwa kutumia **proxmark**:

{% content-ref url="proxmark-3.md" %}
[proxmark-3.md](proxmark-3.md)
{% endcontent-ref %}

## Marejeo

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Je, unafanya kazi katika **kampuni ya usalama wa mtandao**? Je, ungependa kuona **kampuni yako ikitangazwa katika HackTricks**? au ungependa kupata upatikanaji wa **toleo jipya zaidi la PEASS au kupakua HackTricks kwa muundo wa PDF**? Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) za kipekee
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* **Jiunge na** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au **kikundi cha telegram**]\(https://t.me/peass) au **nifuate** kwenye **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PR kwa** [**repo ya hacktricks**](https://github.com/carlospolop/hacktricks) **na** [**repo ya hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
