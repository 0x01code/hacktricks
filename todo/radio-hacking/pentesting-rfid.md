# Pentesting RFID

<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

* Je, unafanya kazi katika **kampuni ya usalama wa mtandao**? Unataka kuona **kampuni yako ikitangazwa kwenye HackTricks**? au unataka kupata upatikanaji wa **toleo jipya zaidi la PEASS au kupakua HackTricks kwa PDF**? Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* **Jiunge na** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **fuata** kwenye **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**repo ya hacktricks**](https://github.com/carlospolop/hacktricks) **na** [**repo ya hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Utangulizi

**Kitambulisho cha Mzunguko wa Redio (RFID)** ndio suluhisho maarufu zaidi la redio kwa umbali mfupi. Kawaida hutumika kuhifadhi na kuhamisha habari inayotambua kipengee.

Lebo ya RFID inaweza kutegemea **chanzo chake cha umeme (active)**, kama betri iliyounganishwa, au kupokea umeme wake kutoka kwa antena ya kusoma kwa kutumia **sasa iliyosababishwa kutoka kwa mawimbi ya redio yaliyopokelewa** (**passive**).

### Madarasa

EPCglobal inagawa vitambulisho vya RFID katika vikundi sita. Lebo katika kila kategoria ina uwezo wote ulioorodheshwa katika kategoria iliyotangulia, ikifanya iwe nyuma ya sambamba.

* Vitambulisho vya **Darasa 0** ni vitambulisho **passive** vinavyofanya kazi katika **mizunguko ya UHF**. Mchuuzi anaweka programu yao kabla ya uzalishaji kiwandani. Kama matokeo, huwezi **kubadilisha** habari iliyohifadhiwa kwenye kumbukumbu yao.
* Vitambulisho vya **Darasa 1** pia vinaweza kufanya kazi katika **mizunguko ya HF**. Aidha, wanaweza **kuandikwa mara moja tu** baada ya uzalishaji. Vitambulisho vingi vya Darasa 1 pia vinaweza kusindika **uchunguzi wa redundancy wa mzunguko** (CRCs) wa amri wanazopokea. CRCs ni baadhi ya byte za ziada mwishoni mwa amri kwa ajili ya ugunduzi wa makosa.
* Vitambulisho vya **Darasa 2** vinaweza **kuandikwa mara nyingi**.
* Vitambulisho vya **Darasa 3** vinaweza kuwa na **sensori zilizojumuishwa** ambazo zinaweza kurekodi vigezo vya mazingira, kama vile joto la sasa au mwendo wa lebo. Vitambulisho hivi ni **nusu-passive**, kwa sababu ingawa **ina** chanzo chake cha umeme, kama vile **betri** iliyoundwa, haziwezi kuanzisha **mawasiliano ya waya** na vitambulisho au wasomaji wengine.
* Vitambulisho vya **Darasa 4** vinaweza kuanzisha mawasiliano na vitambulisho vingine vya darasa moja, hivyo kuwafanya kuwa vitambulisho **active**.
* Vitambulisho vya **Darasa 5** vinaweza kutoa **umeme kwa vitambulisho vingine na kusiliana na vitambulisho vyote vya darasa la awali**. Vitambulisho vya Darasa 5 vinaweza kufanya kazi kama **wasomaji wa RFID**.

### Habari Iliyohifadhiwa kwenye Vitambulisho vya RFID

Kumbukumbu ya lebo ya RFID kawaida inahifadhi aina nne za data: **data ya utambulisho**, ambayo **inatambua** **kipengee** ambacho lebo imeambatanishwa nacho (data hii inajumuisha uga ulioundwa na mtumiaji, kama vile akaunti za benki); **data ya ziada**, ambayo hutoa **maelezo zaidi** kuhusu kipengee; **data ya kudhibiti**, inayotumika kwa **usakinishaji wa ndani wa lebo**; na **data ya mtengenezaji** ya lebo, ambayo ina kitambulisho cha kipekee cha lebo (**UID**) na maelezo kuhusu **uzalishaji**, **aina**, na **muuzaji** wa lebo. Utapata aina mbili za kwanza za data katika vitambulisho vyote vya kibiashara; zile mbili za mwisho zinaweza kutofautiana kulingana na muuzaji wa lebo.

Kiwango cha ISO kinabainisha thamani ya Kitambulisho cha Familia ya Maombi (**AFI**), nambari inayoonyesha **aina ya kitu** ambacho lebo inahusiana nacho. Usajili muhimu mwingine, uliobainishwa pia na ISO, ni Kitambulisho cha Fomati ya Uhifadhi wa Data (**DSFID**), ambayo inafafanua **muundo wa mantiki wa data ya mtumiaji**.

Ulinzi wa RFID **kawaida una vifaa vinavyo** **zuia** **operesheni za kusoma** au **kuandika** kwenye kila bloku la kumbukumbu ya mtumiaji na kwenye usajili maalum unaohusisha thamani za AFI na DSFID. Vifaa hivi vya **kufunga** vinatumia data iliyohifadhiwa kwenye kumbukumbu ya kudhibiti na kuwa na **nywila za msingi** zilizowekwa mapema na muuzaji lakini kuruhusu wamiliki wa lebo kuweka **nywila za desturi**.

### Linganisha Vitambulisho vya Mzunguko wa Chini na wa Juu

<figure><img src="../../.gitbook/assets/image (983).png" alt=""><figcaption></figcaption></figure>

## Vitambulisho vya RFID vya Mzunguko wa Chini (125kHz)

**Vitambulisho vya mzunguko wa chini** mara nyingi hutumiwa katika mifumo ambayo **haitaji usalama wa juu**: ufikiaji wa majengo, funguo za intercom, kadi za uanachama wa mazoezi, n.k. Kwa sababu ya umbali wao mrefu, ni rahisi kutumia kwa maegesho ya gari ya kulipwa: dereva hahitaji kuleta kadi karibu na msomaji, kwani inaanzishwa kutoka mbali. Wakati huo huo, vitambulisho vya mzunguko wa chini ni vya msingi sana, vina kiwango cha chini cha uhamishaji wa data. Kwa sababu hiyo, haiwezekani kutekeleza uhamisho wa data wa njia mbili wa kina kwa mambo kama vile kudumisha usawa na kriptografia. Vitambulisho vya mzunguko wa chini hutoa kitambulisho chao fupi tu bila njia yoyote ya uthibitisho.

Vifaa hivi vinategemea teknolojia ya **RFID passive** na hufanya kazi katika **mbalimbali ya 30 kHz hadi 300 kHz**, ingawa ni kawaida kutumia 125 kHz hadi 134 kHz:

* **Umbali Mrefu** ‚Äî mzunguko wa chini hufanya umbali kuwa mrefu zaidi. Kuna wasomaji wa EM-Marin na HID, ambao hufanya kazi kutoka umbali wa hadi mita moja. Mara nyingi hutumiwa katika maegesho ya gari.
* **Itifaki ya Msingi** ‚Äî kutokana na kiwango cha chini cha uhamishaji wa data, vitambulisho hivi vinaweza tu kusambaza kitambulisho chao fupi. Kwa kawaida, data haijathibitishwa na haijalindwa kwa njia yoyote. Mara tu kadi iko katika umbali wa msomaji, inaanza tu kusambaza kitambulisho chake.
* **Usalama wa Chini** ‚Äî Kadi hizi zinaweza kunakiliwa kwa urahisi, au hata kusomwa kutoka mfukoni mwa mtu mwingine kutokana na upya wa itifaki.

**Itifaki maarufu za 125 kHz:**

* **EM-Marin** ‚Äî EM4100, EM4102. Itifaki maarufu zaidi katika CIS. Inaweza kusomwa kutoka umbali wa takriban mita moja kutokana na urahisi na utulivu wake.
* **HID Prox II** ‚Äî itifaki ya mzunguko wa chini iliyoanzishwa na HID Global. Itifaki hii ni maarufu zaidi katika nchi za magharibi. Ni ngumu zaidi na kadi na wasomaji kwa itifaki hii ni ghali kwa kulinganisha.
* **Indala** ‚Äî itifaki ya mzunguko wa chini sana iliyotangazwa na Motorola, na baadaye kununuliwa na HID. Ni nadra kukutana nayo ikilinganishwa na mbili zilizotangulia kwa sababu inapotea kutokana na kutotumika.

Kwa kweli, kuna itifaki nyingi zaidi za mzunguko wa chini. Lakini zote hutumia modulisheni sawa kwenye safu ya kimwili na zinaweza kuchukuliwa, kwa njia moja au nyingine, kuwa mabadiliko ya zile zilizoorodheshwa hapo juu.

### Shambulio

Unaweza **kushambulia Vitambulisho hivi na Flipper Zero**:

{% content-ref url="flipper-zero/fz-125khz-rfid.md" %}
[fz-125khz-rfid.md](flipper-zero/fz-125khz-rfid.md)
{% endcontent-ref %}
## Vitambulisho vya RFID vya High-Frequency (13.56 MHz)

**Vitambulisho vya high-frequency** hutumiwa kwa mwingiliano wa kusoma-tambulisha wa kina zaidi unapohitaji kriptografia, uhamisho mkubwa wa data pande zote, uthibitisho, n.k.\
Kawaida hupatikana kwenye kadi za benki, usafiri wa umma, na vitambulisho vingine vya usalama.

**Vitambulisho vya high-frequency 13.56 MHz ni seti ya viwango na itifaki**. Mara nyingi huitwa [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/), lakini hiyo sio sahihi kila wakati. Itifaki ya msingi inayotumiwa kwenye viwango vya kimwili na mantiki ni ISO 14443. Itifaki za kiwango cha juu, pamoja na viwango mbadala (kama ISO 19092), zinategemea hiyo. Wengi huita teknolojia hii **Mawasiliano Karibu (NFC)**, neno linalotumika kwa vifaa vinavyofanya kazi kwenye kipimo cha 13.56 MHz.

<figure><img src="../../.gitbook/assets/image (930).png" alt=""><figcaption></figcaption></figure>

Kwa ufupi, usanifu wa NFC hufanya kazi kama hivi: itifaki ya uhamisho huchaguliwa na kampuni inayotengeneza kadi na kutekelezwa kulingana na ISO 14443 ya kiwango cha chini. Kwa mfano, NXP iliunda itifaki yake ya uhamisho ya kiwango cha juu inayoitwa Mifare. Lakini kwenye kiwango cha chini, kadi za Mifare zinategemea kiwango cha ISO 14443-A.

Flipper inaweza kuingiliana na itifaki ya kiwango cha chini cha ISO 14443, pamoja na itifaki ya uhamisho wa data ya Mifare Ultralight na EMV inayotumiwa kwenye kadi za benki. Tunafanya kazi ya kuongeza msaada kwa Mifare Classic na NFC NDEF. Kutazama kwa undani itifaki na viwango vinavyounda NFC ni jambo linalostahili makala tofauti ambayo tunapanga kuichapisha baadaye.

Vitambulisho vyote vya high-frequency vinavyotegemea kiwango cha ISO 14443-A vina kitambulisho cha chip kipekee. Hufanya kazi kama nambari ya kadi, kama anwani ya MAC ya kadi ya mtandao. **Kawaida, UID ina urefu wa byte 4 au 7**, lakini mara chache inaweza kwenda **hadi 10**. UIDs sio siri na wanaweza kusomwa kwa urahisi, **wakati mwingine hata huandikwa kwenye kadi yenyewe**.

Kuna mifumo mingi ya kudhibiti ufikiaji inayotegemea UID kwa **uthibitisho na kutoa ufikiaji**. Mara nyingine hii hutokea **hata** wakati vitambulisho vya RFID **vinavyounga mkono kriptografia**. Matumizi kama hayo yanaleta vitambulisho hivyo chini hadi kiwango cha vitambulisho **dumavu vya kHz 125** kwa upande wa **usalama**. Vitambulisho vya kielektroniki (kama Apple Pay) hutumia UID ya kudumu ili wamiliki wa simu wasiende kufungua milango na programu yao ya malipo.

* **Umbali mdogo** ‚Äî vitambulisho vya high-frequency vimeundwa maalum ili viwe lazima viwekwe karibu na kisomaji. Hii pia husaidia kulinda kadi kutokana na mwingiliano usioruhusiwa. Umbali mkubwa wa kusoma ambao tumefanikiwa kufikia ulikuwa karibu cm 15, na huo ulikuwa na wasomaji maalum wenye umbali mrefu.
* **Itifaki za juu** ‚Äî kasi ya uhamisho wa data hadi 424 kbps inaruhusu itifaki ngumu zenye uhamisho kamili wa data pande zote. Ambayo kwa upande mwingine **inaruhusu kriptografia**, uhamisho wa data, n.k.
* **Usalama wa juu** ‚Äî kadi zisizo na mawasiliano za high-frequency haimpwi kwa njia yoyote kwa kadi za akili. Kuna kadi zinazounga mkono algorithm zenye nguvu za kriptografia kama AES na kutekeleza kriptografia isiyo na uwiano.

### Shambulio

Unaweza **kushambulia Vitambulisho hivi na Flipper Zero**:

{% content-ref url="flipper-zero/fz-nfc.md" %}
[fz-nfc.md](flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Au kutumia **proxmark**:

{% content-ref url="proxmark-3.md" %}
[proxmark-3.md](proxmark-3.md)
{% endcontent-ref %}

## Marejeo

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)
