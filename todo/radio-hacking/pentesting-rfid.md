# RFID Pentest

<details>

<summary><strong>AWS hackleme becerilerini sıfırdan kahramana kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> ile!</strong></summary>

* **Bir siber güvenlik şirketinde mi çalışıyorsunuz? HackTricks'te şirketinizin reklamını görmek ister misiniz? Ya da PEASS'ın en son sürümüne erişmek veya HackTricks'i PDF olarak indirmek ister misiniz? [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* **Katılın** [**💬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya **Twitter** 🐦[**@carlospolopm**](https://twitter.com/hacktricks\_live)**'u takip edin.**
* **Hacking püf noktalarınızı göndererek PR'larınızı** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ve** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ile paylaşın.**

</details>

## Giriş

**Radyo Frekansı Tanımlama (RFID)** en popüler kısa menzilli radyo çözümüdür. Genellikle bir varlığı tanımlayan bilgileri depolamak ve iletmek için kullanılır.

Bir RFID etiketi, **kendi güç kaynağına (aktif)**, örneğin gömülü bir pil, dayanabilir veya okuma anteninden gelen radyo dalgalarından alınan akımı kullanarak gücünü alabilir (**pasif**).

### Sınıflar

EPCglobal, RFID etiketlerini altı kategoriye ayırır. Her kategorideki bir etiket, önceki kategoride listelenen tüm yeteneklere sahiptir, bu da onu geriye dönük uyumlu yapar.

* **Sınıf 0** etiketler, **UHF** bantlarında çalışan **pasif** etiketlerdir. Satıcılar, bunları üretim fabrikasında **önceden programlar**. Sonuç olarak, belleklerinde depolanan bilgileri **değiştiremezsiniz**.
* **Sınıf 1** etiketler ayrıca **HF** bantlarında da çalışabilir. Ayrıca, üretim sonrası **yalnızca bir kez yazılabilirler**. Birçok Sınıf 1 etiketi, aldıkları komutların **döngüsel uyumsuzluk denetimlerini** (CRC'ler) işleyebilir. CRC'ler, hata tespiti için komutların sonuna eklenen birkaç ek bayttır.
* **Sınıf 2** etiketler **çok kez yazılabilir**.
* **Sınıf 3** etiketler, **gömülü sensörler** içerebilir ve ortam parametrelerini, örneğin mevcut sıcaklığı veya etiketin hareketini kaydedebilir. Bu etiketler **yarı-pasif**tir, çünkü **entegre bir pil** gibi bir gömülü güç kaynağı olmasına rağmen, diğer etiketler veya okuyucularla **kablosuz iletişim başlatamazlar**.
* **Sınıf 4** etiketler, aynı sınıftaki diğer etiketlerle iletişim başlatabilir, bu da onları **aktif etiketler** yapar.
* **Sınıf 5** etiketler, diğer tüm önceki etiket sınıflarına **güç sağlayabilir ve iletişim kurabilir**. Sınıf 5 etiketler, **RFID okuyucuları** olarak hareket edebilir.

### RFID Etiketlerinde Depolanan Bilgiler

Bir RFID etiketinin belleği genellikle dört tür veriyi depolar: etiketin bağlı olduğu varlığı **tanımlayan kimlik verileri** (bu veriler, banka hesapları gibi kullanıcı tanımlı alanları içerir); varlığa ilişkin **daha fazla ayrıntı** sağlayan **ek veriler**; etiketin iç **yapılandırması** için kullanılan **kontrol verileri**; ve etiketin **üretici verileri**, bir etiketin **UID** ve etiketin **üretim**, **tür** ve **satıcı** hakkındaki ayrıntılarını içerir. İlk iki veri türünü tüm ticari etiketlerde bulabilirsiniz; son iki veri, etiketin satıcısına bağlı olarak farklılık gösterebilir.

ISO standardı, etiketin ait olduğu **nesne türünü** gösteren bir kod olan **Uygulama Ailesi Kimliği (AFI)** değerini belirtir. ISO tarafından belirlenen başka bir önemli kayıt, **Kullanıcı Verilerinin Mantıksal Yapısını** tanımlayan **Veri Depolama Formatı Kimliği (DSFID)**'dir.

Çoğu RFID **güvenlik kontrolleri**, her kullanıcı bellek bloğunda ve AFI ve DSFID değerlerini içeren özel kayıtlarda **okuma** veya **yazma** işlemlerini **kısıtlayan** mekanizmalara sahiptir. Bu **kilit** **mekanizmaları**, kontrol belleğinde depolanan verileri kullanır ve satıcı tarafından önceden yapılandırılmış **varsayılan şifreleri** kullanır, ancak etiket sahiplerine **özel şifreler yapılandırma** izni verir.

### Düşük ve Yüksek Frekanslı Etiketler Karşılaştırması

<figure><img src="../../.gitbook/assets/image (983).png" alt=""><figcaption></figcaption></figure>

## Düşük-Frekanslı RFID Etiketleri (125kHz)

**Düşük frekanslı etiketler**, yüksek güvenlik gerektirmeyen sistemlerde sıklıkla kullanılır: bina girişi, interkom anahtarları, spor salonu üyelik kartları vb. Daha yüksek menzilleri nedeniyle, ödeme yapılırken araç parkı için kullanımı uygundur: sürücünün kartı okuyucuya yaklaştırması gerekmez, çünkü daha uzaktan tetiklenir. Aynı zamanda, düşük frekanslı etiketler çok ilkel olup, düşük veri transfer hızına sahiptir. Bu nedenle, denge tutma ve şifreleme gibi karmaşık iki yönlü veri transferini uygulamak imkansızdır. Düşük frekanslı etiketler yalnızca kimlik doğrulaması olmadan kısa kimliklerini ileterek çalışırlar.

Bu cihazlar, **pasif RFID** teknolojisine dayanır ve **30 kHz ila 300 kHz aralığında** çalışır, ancak genellikle 125 kHz ila 134 kHz kullanılır:

* **Uzun Menzil** — düşük frekans, daha yüksek menzile çevrilir. Bir metreye kadar mesafeden çalışan bazı EM-Marin ve HID okuyucuları bulunmaktadır. Bunlar genellikle araç parkında kullanılır.
* **İlkel protokol** — düşük veri transfer hızı nedeniyle bu etiketler yalnızca kısa kimliklerini iletebilir. Çoğu durumda, veri doğrulanmaz ve herhangi bir şekilde korunmaz. Kart okuyucunun menziline girdiği anda kimliğini iletmeye başlar.
* **Düşük güvenlik** — Bu kartlar kolayca kopyalanabilir veya protokolün ilkel olmasından dolayı başka birinin cebinden bile okunabilir.

**Popüler 125 kHz protokolleri:**

* **EM-Marin** — EM4100, EM4102. Gelişmişlik ve kararlılığı nedeniyle CIS'te en popüler protokol. Yaklaşık bir metre mesafeden okunabilir.
* **HID Prox II** — HID Global tarafından tanıtılan düşük frekanslı protokol. Bu protokol, batı ülkelerinde daha popülerdir. Daha karmaşıktır ve bu protokol için kartlar ve okuyucular nispeten pahalıdır.
* **Indala** — Motorola tarafından tanıtılan çok eski düşük frekanslı protokol, daha sonra HID tarafından satın alındı. Bu protokolü öncekilerden daha az rastlayabilirsiniz çünkü kullanımı azalmaktadır.

Gerçekte, çok daha fazla düşük frekanslı protokol bulunmaktadır. Ancak hepsi aynı modülasyonu kullanır ve bir şekilde yukarıda listelenenlerin bir varyasyonu olarak kabul edilebilir.

### Saldırı

Bu Etiketler **Flipper Zero ile saldırabilirsiniz**:

{% content-ref url="flipper-zero/fz-125khz-rfid.md" %}
[fz-125khz-rfid.md](flipper-zero/fz-125khz-rfid.md)
{% endcontent-ref %}
## Yüksek Frekanslı RFID Etiketleri (13.56 MHz)

**Yüksek frekanslı etiketler**, şifreleme, büyük iki yönlü veri transferi, kimlik doğrulama vb. gerektiğinde daha karmaşık bir okuyucu-etiket etkileşimi için kullanılır.\
Genellikle banka kartlarında, toplu taşıma araçlarında ve diğer güvenli geçişlerde bulunur.

**Yüksek frekanslı 13.56 MHz etiketler bir dizi standart ve protokoldür**. Genellikle [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/) olarak adlandırılır, ancak bu her zaman doğru değildir. Fiziksel ve mantıksal seviyelerde kullanılan temel protokol seti ISO 14443 olarak adlandırılır. Yüksek seviye protokoller ve alternatif standartlar (örneğin ISO 19092) buna dayanmaktadır. Birçok kişi bu teknolojiyi **Yakın Alan İletişimi (NFC)** olarak adlandırır, 13.56 MHz frekansı üzerinde çalışan cihazlar için bir terimdir.

<figure><img src="../../.gitbook/assets/image (930).png" alt=""><figcaption></figcaption></figure>

Basitçe ifade etmek gerekirse, NFC'nin mimarisi şu şekilde çalışır: kartları üreten şirket tarafından iletişim protokolü seçilir ve düşük seviyedeki ISO 14443'e dayalı olarak uygulanır. Örneğin, NXP kendi yüksek seviye iletişim protokolünü Mifare olarak adlandırmıştır. Ancak alt seviyede, Mifare kartları ISO 14443-A standardına dayanır.

Flipper, hem düşük seviyeli ISO 14443 protokolüyle hem de banka kartlarında kullanılan Mifare Ultralight veri transfer protokolü ve EMV ile etkileşimde bulunabilir. Mifare Classic ve NFC NDEF desteği eklemek üzerinde çalışıyoruz. NFC'yi oluşturan protokoller ve standartlara detaylı bir bakış ayrı bir makalede değerlendirilebilir, bu konuda ilerleyen zamanlarda yayınlamayı planlıyoruz.

ISO 14443-A standardına dayanan tüm yüksek frekanslı kartlar benzersiz bir çip kimliğine sahiptir. Bu, kartın seri numarası gibi davranır, bir ağ kartının MAC adresi gibi. **Genellikle UID 4 veya 7 bayt uzunluğundadır**, ancak nadiren **10'a kadar** gidebilir. UID'ler gizli değildir ve kolayca okunabilir, **bazen kartın üzerine bile yazdırılır**.

UID'yi **doğrulamak ve erişim izni vermek** için birçok erişim kontrol sistemi vardır. Bazen bu, RFID etiketleri **şifreleme**yi desteklese bile gerçekleşir. Bu **yanlış kullanım**, onları güvenlik açısından aptal **125 kHz kartları** seviyesine indirir. Sanal kartlar (örneğin Apple Pay) telefon sahiplerinin ödeme uygulamalarıyla kapıları açmasını engellemek için dinamik bir UID kullanır.

* **Düşük menzil** — yüksek frekanslı kartlar, okuyucuya yakın yerleştirilmeleri gerektiği şekilde özel olarak tasarlanmıştır. Bu aynı zamanda kartı yetkisiz etkileşimlerden korumaya yardımcı olur. Başardığımız maksimum okuma mesafesi yaklaşık 15 cm idi ve bu özel olarak yapılmış yüksek menzilli okuyucularla gerçekleştirildi.
* **Gelişmiş protokoller** — 424 kbps'ye kadar veri transfer hızları, tam teşekküllü iki yönlü veri transferi ile karmaşık protokollere izin verir. Bu da **şifreleme**, veri transferi vb. sağlar.
* **Yüksek güvenlik** — yüksek frekanslı temasız kartlar akıllı kartlara hiçbir şekilde aşağı değildir. AES gibi kriptografik güçlü algoritmaları destekleyen ve asimetrik şifreleme uygulayan kartlar bulunmaktadır.

### Saldırı

Bu Etiketlere **Flipper Zero ile saldırabilirsiniz**:

{% content-ref url="flipper-zero/fz-nfc.md" %}
[fz-nfc.md](flipper-zero/fz-nfc.md)
{% endcontent-ref %}

Ya da **proxmark** kullanarak:

{% content-ref url="proxmark-3.md" %}
[proxmark-3.md](proxmark-3.md)
{% endcontent-ref %}

## Referanslar

* [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)
