# Modbus协议

## Modbus协议简介

Modbus协议是工业自动化和控制系统中广泛使用的协议。Modbus允许各种设备之间进行通信，如可编程逻辑控制器（PLC）、传感器、执行器和其他工业设备。理解Modbus协议是至关重要的，因为这是ICS中最常用的通信协议，对于嗅探甚至向PLC注入命令具有很大的潜在攻击面。

这里，概念以逐点方式陈述，提供协议的背景和操作性质。ICS系统安全面临的最大挑战是实施和升级的成本。这些协议和标准是在80年代和90年代初设计的，但仍然被广泛使用。由于一个行业拥有大量设备和连接，升级设备非常困难，这为黑客提供了处理过时协议的优势。对Modbus的攻击几乎是不可避免的，因为它将在没有升级的情况下被使用，而其操作对于工业至关重要。

## 客户端-服务器架构

Modbus协议通常用作客户端服务器架构，其中主设备（客户端）与一个或多个从设备（服务器）进行通信。这也被称为主从架构，在电子设备和物联网中广泛使用SPI、I2C等。

## 串行和以太网版本

Modbus协议既设计用于串行通信，也设计用于以太网通信。串行通信在传统系统中被广泛使用，而现代设备支持以太网，提供高数据传输速率，更适用于现代工业网络。

## 数据表示

Modbus协议中的数据以ASCII或二进制形式传输，尽管由于其与旧设备的兼容性，通常使用二进制格式。

## 功能码

ModBus协议使用特定功能码进行传输，这些功能码用于操作PLC和各种控制设备。这部分很重要，因为通过重新传输功能码可以进行重放攻击。传统设备不支持任何加密传输数据，并且通常具有连接它们的长电线，这导致这些电线被篡改并捕获/注入数据。

## Modbus的寻址

网络中的每个设备都有一个唯一的地址，这对设备之间的通信至关重要。诸如Modbus RTU、Modbus TCP等的协议用于实现寻址，并充当数据传输的传输层。传输的数据采用Modbus协议格式，其中包含消息。

此外，Modbus还实现了错误检查以确保传输数据的完整性。但最重要的是，Modbus是一个开放标准，任何人都可以在其设备中实现它。这使得该协议成为全球标准，并在工业自动化行业中广泛应用。

由于其大规模使用和缺乏升级，攻击Modbus在攻击面上提供了显著优势。ICS高度依赖设备之间的通信，对它们进行的任何攻击都可能对工业系统的运行造成危险。如果攻击者识别了传输介质，就可以进行重放、数据注入、数据嗅探和泄露、拒绝服务、数据伪造等攻击。
