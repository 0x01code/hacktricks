# 脅威モデリング

## 脅威モデリング

脅威モデリングに関するHackTricksの包括的なガイドへようこそ！このサイバーセキュリティの重要な側面を探求し、システムの潜在的な脆弱性を特定し、理解し、戦略を立てることができます。このスレッドは、現実世界の例、役立つソフトウェア、わかりやすい説明が詰まったステップバイステップガイドとして機能します。セキュリティの初心者から経験豊富な実践者まで、セキュリティの防御策を強化したい方に最適です。

### よく使用されるシナリオ

1. **ソフトウェア開発**：セキュアソフトウェア開発ライフサイクル（SSDLC）の一環として、脅威モデリングは開発の初期段階での**潜在的な脆弱性の特定**に役立ちます。
2. **ペネトレーションテスト**：ペネトレーションテスト実行標準（PTES）フレームワークでは、テストを実施する前にシステムの脆弱性を理解するために**脅威モデリングが必要**です。

### 脅威モデルの要点

脅威モデルは通常、アプリケーションの計画されたアーキテクチャまたは既存のビルドを示す図、画像、または他の形式の視覚的なイラストレーションとして表されます。これは**データフローダイアグラム**に似ていますが、そのセキュリティ指向の設計が異なります。

脅威モデルには、潜在的な脆弱性、リスク、または障壁を示す赤でマークされた要素がよく含まれます。リスクの特定プロセスを効率化するために、CIA（機密性、完全性、可用性）トライアドが使用され、STRIDEが最も一般的な脅威モデリング手法の1つとなっています。ただし、選択する手法は特定のコンテキストと要件によって異なる場合があります。

### CIAトライアド

CIAトライアドは、情報セキュリティの分野で広く認識されているモデルであり、機密性、完全性、可用性を表しています。これらの3つの要素は、脅威モデリング手法を含む多くのセキュリティ対策やポリシーの基盤となります。

1. **機密性**：データやシステムが不正な個人によってアクセスされないようにすること。これはセキュリティの中心的な側面であり、適切なアクセス制御、暗号化、および他の対策を必要としてデータ漏洩を防止します。
2. **完全性**：データのライフサイクル全体での正確性、一貫性、信頼性。この原則は、データが不正な者によって変更または改ざんされないようにすることを保証します。これにはチェックサム、ハッシュなどのデータ検証方法がしばしば使用されます。
3. **可用性**：データとサービスが必要な時に認証されたユーザーに利用可能であること。これには冗長性、障害耐性、高可用性の構成がしばしば関与し、システムが障害に直面しても稼働し続けるようにします。

### 脅威モデリング手法

1. **STRIDE**：Microsoftによって開発されたSTRIDEは、**スプーフィング、改ざん、否認、情報開示、サービス妨害、特権昇格**を表す頭字語です。各カテゴリは脅威のタイプを表し、この手法はプログラムやシステムの設計フェーズで潜在的な脅威を特定するために一般的に使用されます。
2. **DREAD**：これはMicrosoftの別の手法で、特定された脅威のリスク評価に使用されます。DREADは**ダメージの可能性、再現性、悪用可能性、影響を受けるユーザー、発見可能性**を表しています。これらの要素にスコアを付け、特定された脅威の優先順位を決定するために使用されます。
3. **PASTA**（攻撃シミュレーションと脅威分析のプロセス）：これは7つのステップからなる**リスク中心**の手法です。セキュリティ目標の定義と特定、技術的な範囲の作成、アプリケーションの分解、脅威分析、脆弱性分析、リスク/トリアージ評価を含みます。
4. **Trike**：これは資産の防御に焦点を当てたリスクベースの手法です。リスク管理の観点から始まり、その文脈で脅威と脆弱性を見ます。
5. **VAST**（ビジュアル、アジャイル、シンプルな脅威モデリング）：このアプローチはよりアクセスしやすく、アジャイルな開発環境に統合されることを目指しています。他の手法から要素を組み合わせ、脅威の視覚的な表現に焦点を当てています。
6. **OCTAVE**（運用上重要な脅威、資産、脆弱性評価）：CERT Coordination Centerによって開発されたこのフレームワークは、特定のシステムやソフトウェアではなく、組織のリスク評価を対象としています。

## ツール

脅威モデルの作成と管理を**支援**するために利用できるいくつかのツールとソフトウェアソリューションがあります。以下にいくつかのツールを紹介します。

### [SpiderSuite](https://github.com/3nock/SpiderSuite)

サイバーセキュリティの専門家向けの高度なクロスプラットフォームおよびマルチ機能のGUIウェブスパイダー/クローラーです。Spider Suiteは攻撃面のマッピングと分析に使用できます。

**使用方法**

1. URLを選択してクロール

<figure><img src="../.gitbook/assets/threatmodel_spidersuite_1.png" alt=""><figcaption></figcaption></figure>

2. グラフを表示

<figure><img src="../.gitbook/assets/threatmodel_spidersuite_2.png" alt=""><figcaption></figcaption></figure>

### [OWASP Threat Dragon](https://github.com/OWASP/threat-dragon/releases)

OWASPのオープンソースプロジェクトであるThreat Dragonは、システムダイアグラム作成と脅威/緩和策の自動生成のためのルールエンジンを備えたWebおよびデスクトップアプリケーションです。

**使用方法**

1. 新しいプロジェクトを作成

<figure><img src="../.gitbook/assets/create_new_project_1.jpg" alt=""><figcaption></figcaption></figure>

場合によっては、次のように表示されることもあります。

<figure><img src="../.gitbook/assets/1_threatmodel_create_project.jpg" alt=""><figcaption></figcaption></figure>

2. 新しいプロジェクトを起動

<figure><img src="../.gitbook/assets/launch_new
### [Microsoft Threat Modeling Tool](https://aka.ms/threatmodelingtool)

これはMicrosoftの無料ツールであり、ソフトウェアプロジェクトの設計フェーズで脅威を見つけるのに役立ちます。STRIDEの方法論を使用しており、特にMicrosoftのスタックで開発している人に適しています。
