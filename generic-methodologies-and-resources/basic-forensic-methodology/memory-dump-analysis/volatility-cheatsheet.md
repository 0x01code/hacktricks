# Volatility - CheatSheet

<details>

<summary><strong>рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

тАЛ

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

тАЛтАЛ[**RootedCON**](https://www.rootedcon.com/) рд╕реНрдкреЗрди рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдШрдЯрдирд╛ рд╣реИ рдФрд░ рдпреВрд░реЛрдк рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред **рддрдХрдиреАрдХреА рдЬреНрдЮрд╛рди рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рджреЗрдиреЗ** рдХреЗ рдорд┐рд╢рди рдХреЗ рд╕рд╛рде, рдпрд╣ рдХрд╛рдВрдЧреНрд░реЗрд╕ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдФрд░ рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрддреНрддреЗрдЬрдХ рдорд┐рд▓рди рд╕реНрдерд▓ рд╣реИ рд╣рд░ рд╡рд┐рд╖рдп рдореЗрдВред

{% embed url="https://www.rootedcon.com/" %}

рдЕрдЧрд░ рдЖрдк рдХреБрдЫ **рддреЗрдЬрд╝ рдФрд░ рдкрд╛рдЧрд▓** рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдЬреЛ рдХрдИ Volatility рдкреНрд▓рдЧрдЗрдиреНрд╕ рдХреЛ рдкреИрд░рд▓рд▓ рдкрд░ рд▓реЙрдиреНрдЪ рдХрд░реЗрдЧрд╛ рддреЛ рдЖрдк рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [https://github.com/carlospolop/autoVolatility](https://github.com/carlospolop/autoVolatility)
```bash
python autoVolatility.py -f MEMFILE -d OUT_DIRECTORY -e /home/user/tools/volatility/vol.py # It will use the most important plugins (could use a lot of space depending on the size of the memory)
```
## рд╕реНрдерд╛рдкрдирд╛

### volatility3
```bash
git clone https://github.com/volatilityfoundation/volatility3.git
cd volatility3
python3 setup.py install
python3 vol.py тАФh
```
### volatility2

{% tabs %}
{% tab title="Method1" %}
```
Download the executable from https://www.volatilityfoundation.org/26
```
{% endtab %}

{% tab title="Method 2" %}рдпрд╣рд╛рдБ рд╣рдо рджреВрд╕рд░реА рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВрдЧреЗред{% endtab %}
```bash
git clone https://github.com/volatilityfoundation/volatility.git
cd volatility
python setup.py install
```
{% endtab %}
{% endtabs %}

## Volatility Commands

рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рдкрд╣реБрдВрдЪреЗрдВ [Volatility command reference](https://github.com/volatilityfoundation/volatility/wiki/Command-Reference#kdbgscan)

### "рд╕реВрдЪреА" рдмрдирд╛рдо "рд╕реНрдХреИрди" рдкреНрд▓рдЧрдЗрди рдкрд░ рдПрдХ рдиреЛрдЯ

Volatility рдХреЗ рдкрд╛рд╕ рдкреНрд▓рдЧрдЗрдиреНрд╕ рдХреЗ рд▓рд┐рдП рджреЛ рдореБрдЦреНрдп рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реИрдВ, рдЬреЛ рдХрднреА-рдХрднреА рдЙрдирдХреЗ рдирд╛рдореЛрдВ рдореЗрдВ рдкреНрд░рдХрдЯ рд╣реЛрддреЗ рд╣реИрдВред "рд╕реВрдЪреА" рдкреНрд▓рдЧрдЗрдиреНрд╕ рд╡рд┐рдВрдбреЛрдЬ рдХрд░реНрдиреЗрд▓ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВрдЧреЗ рддрд╛рдХрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ (рдпрд╛рдиреА рдореЗрдореЛрд░реА рдореЗрдВ `_EPROCESS` рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреА рд▓рд┐рдВрдХреНрдб рд╕реВрдЪреА рдХреЛ рдвреВрдВрдвреЗрдВ рдФрд░ рдЪрд▓реЗрдВ), рдУрдПрд╕ рд╣реИрдВрдбрд▓реНрд╕ (рд╣реИрдВрдбрд▓ рдЯреЗрдмрд▓ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдФрд░ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдирд╛, рдкрд╛рдП рдЧрдП рдХрд┐рд╕реА рднреА рдкреЙрдЗрдВрдЯрд░ рдХреЛ рдбрд┐рд░реЗрдлрд░реЗрдВрд╕ рдХрд░рдирд╛, рдЖрджрд┐) рдЬреИрд╕реА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред рд╡реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рд╡рдХреНрдд рд╡рд┐рдВрдбреЛрдЬ API рдХреА рддрд░рд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рдЕрдЧрд░ рдорд╛рдВрдЧ рдХреА рдЬрд╛рдП, рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рд╕реВрдЪреАрдмрджреНрдз рдХрд░реЗрдВред

рдпрд╣ "рд╕реВрдЪреА" рдкреНрд▓рдЧрдЗрдиреНрд╕ рдХрд╛рдлреА рддреЗрдЬ рд╣реЛрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡рд┐рдВрдбреЛрдЬ API рдХреЗ рд░реВрдк рдореЗрдВ рдореИрд▓рд╡реЗрдпрд░ рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рд╡рд░реНрддрди рдХреЗ рд▓рд┐рдП рдЙрддрдиреЗ рд╣реА рд╡рд┐рдХрд▓реНрдкрдирд╢реАрд▓ рд╣реЛрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдореИрд▓рд╡реЗрдпрд░ DKOM рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ `_EPROCESS` рд▓рд┐рдВрдХреНрдб рд╕реВрдЪреА рд╕реЗ рдЕрд▓рдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдХрд╛рд░реНрдп рдкреНрд░рдмрдВрдзрдХ рдореЗрдВ рдкреНрд░рдХрдЯ рдирд╣реАрдВ рд╣реЛрдЧрд╛ рдФрд░ рди рд╣реА рдпрд╣ pslist рдореЗрдВ рджрд┐рдЦреЗрдЧрд╛ред

рджреВрд╕рд░реА рдУрд░, "рд╕реНрдХреИрди" рдкреНрд▓рдЧрдЗрдиреНрд╕ рдПрдХ рдРрд╕рд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЕрдкрдирд╛рдПрдВрдЧреЗ рдЬреЛ рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдореЗрдореЛрд░реА рдХреЗ рд▓рд┐рдП рдЦреЛрджрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдорд╛рди рд╣реЛрдЧрд╛ рдЬреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЗ рд░реВрдк рдореЗрдВ dereferenced рд╣реЛ рд╕рдХрддрд╛ рд╣реИред `psscan` рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдореЗрдореЛрд░реА рдкрдврд╝реЗрдЧрд╛ рдФрд░ рдЗрд╕рд╕реЗ `_EPROCESS` рдСрдмреНрдЬ
```bash
./volatility_2.6_lin64_standalone --info | grep "Profile"
```
рдпрджрд┐ рдЖрдк **рдПрдХ рдирдпрд╛ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдЬрд┐рд╕реЗ рдЖрдкрдиреЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рд╣реИ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд┐рдирдХреНрд╕ рд╡рд╛рд▓рд╛) рдЙрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝реЛрд▓реНрдбрд░ рд╕рдВрд░рдЪрдирд╛ рдмрдирд╛рдиреА рд╣реЛрдЧреА: _plugins/overlays/linux_ рдФрд░ рдЗрд╕ рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА рдЬрд╝рд┐рдк рдлрд╝рд╛рдЗрд▓ рдбрд╛рд▓реЗрдВред рдлрд┐рд░, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреА рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:
```bash
./vol --plugins=/home/kali/Desktop/ctfs/final/plugins --info
Volatility Foundation Volatility Framework 2.6


Profiles
--------
LinuxCentOS7_3_10_0-123_el7_x86_64_profilex64 - A Profile for Linux CentOS7_3.10.0-123.el7.x86_64_profile x64
VistaSP0x64                                   - A Profile for Windows Vista SP0 x64
VistaSP0x86                                   - A Profile for Windows Vista SP0 x86
```
You can **рдбрд╛рдЙрдирд▓реЛрдб Linux and Mac profiles** from [https://github.com/volatilityfoundation/profiles](https://github.com/volatilityfoundation/profiles)

In the previous chunk you can see that the profile is called `LinuxCentOS7_3_10_0-123_el7_x86_64_profilex64`, and you can use it to execute something like:
```bash
./vol -f file.dmp --plugins=. --profile=LinuxCentOS7_3_10_0-123_el7_x86_64_profilex64 linux_netscan
```
#### рдЦреЛрдЬ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓
```
volatility imageinfo -f file.dmp
volatility kdbgscan -f file.dmp
```
#### **imageinfo рдФрд░ kdbgscan рдХреЗ рдмреАрдЪ рдЕрдВрддрд░**

[**рдпрд╣рд╛рдБ рд╕реЗ**](https://www.andreafortuna.org/2017/06/25/volatility-my-own-cheatsheet-part-1-image-identification/): imageinfo рдХреЗ рд╡рд┐рдкрд░реАрдд, рдЬреЛ рдХреЗрд╡рд▓ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рд╕реБрдЭрд╛рд╡ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, **kdbgscan** рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╕рд╣реА рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдФрд░ рд╕рд╣реА KDBG рдкрддрд╛ (рдпрджрд┐ рдХрдИ рд╣реЛрдВ) рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛ рд╣реИред рдпрд╣ рдкреНрд▓рдЧрдЗрди Volatility рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓реНрд╕ рд╕реЗ рдЬреБрдбрд╝реЗ KDBGHeader рд╣рд╕реНрддрд╛рдХреНрд╖рд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╕реНрдХреИрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлреЙрд▓реНрд╕ рдкреЙрдЬрд┐рдЯрд┐рд╡ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рдирд┐рддрд┐ рдЬрд╛рдВрдЪ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред рдЖрдЙрдЯрдкреБрдЯ рдХреА рд╡реНрдпрд╛рдкрдХрддрд╛ рдФрд░ рд╕рд╛рдирд┐рддрд┐ рдЬрд╛рдВрдЪреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИ рдХрд┐ Volatility рдХреНрдпрд╛ рдПрдХ DTB рдвреВрдВрдв рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдк рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рд╣реА рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЛ рдЬрд╛рдирддреЗ рд╣реИрдВ (рдпрд╛ рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ imageinfo рд╕реЗ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рд╕реБрдЭрд╛рд╡ рд╣реИ), рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк рдЗрд╕реЗ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред

рд╣рдореЗрд╢рд╛ **рджреЗрдЦреЗрдВ рдХрд┐ kdbgscan рдиреЗ рдХрд┐рддрдиреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдЦреЛрдЬреА рд╣реИрдВ**ред рдХрднреА-рдХрднреА imageinfo рдФрд░ kdbgscan **рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ** рдЙрдкрдпреБрдХреНрдд **рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓** рдвреВрдВрдв рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ **рд╡реИрдз рдПрдХ рдореЗрдВ рдХреБрдЫ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрдЧреА** (рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╣реА KDBG рдкрддрд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ)
```bash
# GOOD
PsActiveProcessHead           : 0xfffff800011977f0 (37 processes)
PsLoadedModuleList            : 0xfffff8000119aae0 (116 modules)
```

```bash
# BAD
PsActiveProcessHead           : 0xfffff800011947f0 (0 processes)
PsLoadedModuleList            : 0xfffff80001197ac0 (0 modules)
```
#### KDBG

**рдХрд░реНрдиреЗрд▓ рдбреАрдмрдЧрд░ рдмреНрд▓реЙрдХ**, рдЬрд┐рд╕реЗ Volatility рджреНрд╡рд╛рд░рд╛ **KDBG** рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд╛рдВрдЪрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдлреЛрд░реЗрдВрд╕рд┐рдХ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред `_KDDEBUGGER_DATA64` рдирд╛рдордХ `KdDebuggerDataBlock` рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрд╣ `PsActiveProcessHead` рдЬреИрд╕реА рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рдВрджрд░реНрднрдирд╛рдПрдВ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рдВрджрд░реНрдн рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реВрдЪреА рдХреЗ рд╢реАрд░реНрд╖ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╕рднреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХреЛ рд╕рдВрдкреВрд░реНрдг рд╕реНрдореГрддрд┐ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдореМрд▓рд┐рдХ рдмрдирд╛рддрд╛ рд╣реИред

## рдУрдПрд╕ рд╕реВрдЪрдирд╛
```bash
#vol3 has a plugin to give OS information (note that imageinfo from vol2 will give you OS info)
./vol.py -f file.dmp windows.info.Info
```
рдпрд╣ рдкреНрд▓рдЧрдЗрди `banners.Banners` рдбрдВрдк рдореЗрдВ **рд▓рд┐рдирдХреНрд╕ рдмреИрдирд░реНрд╕** рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП **vol3 рдореЗрдВ** рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## рд╣реИрд╢/рдкрд╛рд╕рд╡рд░реНрдб

SAM рд╣реИрд╢, [рдбреЛрдореЗрди рдХреИрд╢реНрдб рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕](../../../windows-hardening/stealing-credentials/credentials-protections.md#cached-credentials) рдФрд░ [lsa рд╕реАрдХреНрд░реЗрдЯреНрд╕](../../../windows-hardening/authentication-credentials-uac-and-efs.md#lsa-secrets) рдХреЛ рдирд┐рдХрд╛рд▓реЗрдВред
```bash
./vol.py -f file.dmp windows.hashdump.Hashdump #Grab common windows hashes (SAM+SYSTEM)
./vol.py -f file.dmp windows.cachedump.Cachedump #Grab domain cache hashes inside the registry
./vol.py -f file.dmp windows.lsadump.Lsadump #Grab lsa secrets
```
{% endtab %}

{% tab title="vol2" %}рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди

рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдЪреЗрдХ рдХрд░реЗрдВ:

```bash
volatility
```

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЙрдкрдпреЛрдЧ

рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

```bash
volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> <рдкреНрд▓рдЧрдЗрди> рдСрдкреНрд╢рди
```

рдЙрджрд╛рд╣рд░рдг:

```bash
volatility -f memdump.mem imageinfo
```

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдкреНрд▓рдЧрдЗрдиреНрд╕

рдХреБрдЫ рдЙрдкрдпреЛрдЧреА рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдкреНрд▓рдЧрдЗрдиреНрд╕:

- `imageinfo`: рдЗрдореЗрдЬ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ
- `pslist`: рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣
```bash
volatility --profile=Win7SP1x86_23418 hashdump -f file.dmp #Grab common windows hashes (SAM+SYSTEM)
volatility --profile=Win7SP1x86_23418 cachedump -f file.dmp #Grab domain cache hashes inside the registry
volatility --profile=Win7SP1x86_23418 lsadump -f file.dmp #Grab lsa secrets
```
## рдореЗрдореЛрд░реА рдбрдВрдк

рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдореЗрдореЛрд░реА рдбрдВрдк рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдХреЛ **рдирд┐рдХрд╛рд▓реЗрдЧрд╛**ред **Procdump** рдореЙрдбреНрдпреВрд▓ рдХреЗрд╡рд▓ **рдХреЛрдб** рдХреЛ **рдирд┐рдХрд╛рд▓реЗрдЧрд╛**ред
```
volatility -f file.dmp --profile=Win7SP1x86 memdump -p 2168 -D conhost/
```
<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

тАЛтАЛтАЛ[**RootedCON**](https://www.rootedcon.com/) рд╕реНрдкреЗрди рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдШрдЯрдирд╛ рд╣реИ рдФрд░ рдпреВрд░реЛрдк рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред **рддрдХрдиреАрдХреА рдЬреНрдЮрд╛рди рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рджреЗрдиреЗ** рдХреЗ рдорд┐рд╢рди рдХреЗ рд╕рд╛рде, рдпрд╣ рдХрд╛рдВрдЧреНрд░реЗрд╕ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдФрд░ рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдлрдирддреА рдмреИрдардХ рд╕реНрдерд╛рди рд╣реИ рд╣рд░ рд╡рд┐рд╖рдп рдореЗрдВред

{% embed url="https://www.rootedcon.com/" %}

## Processes

### List processes

**рд╕рдВрджреЗрд╣рдЬрдирдХ** рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ (рдирд╛рдо рджреНрд╡рд╛рд░рд╛) рдпрд╛ **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд** рдмрдЪреНрдЪрд╛ **рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП iexplorer.exe рдХреЗ рдмрдЪреНрдЪреЗ рдХреЗ рд░реВрдк рдореЗрдВ cmd.exe) рдЦреЛрдЬрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред\
рдпрд╣ рджрд┐рдЦрд╛рдИ рджреЗ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ pslist рдХрд╛ рдкрд░рд┐рдгрд╛рдо psscan рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рдирд╛ рджреБрд╖реНрдЯ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджрд┐рдЦрд╛рдИ рджреЗ рд╕рдХрддрд╛ рд╣реИред

{% tabs %}
{% tab title="vol3" %}
```bash
python3 vol.py -f file.dmp windows.pstree.PsTree # Get processes tree (not hidden)
python3 vol.py -f file.dmp windows.pslist.PsList # Get process list (EPROCESS)
python3 vol.py -f file.dmp windows.psscan.PsScan # Get hidden process list(malware)
```
{% endtab %}

{% tab title="vol2" %}рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди

- рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
  ```bash
  volatility -h
  ```

#### рдмреЗрд╕рд┐рдХ рдХрдорд╛рдВрдбреНрд╕

- рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
  ```bash
  volatility -f <memory_dump> imageinfo
  ```

- рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕реВрдЪреА рджреЗрдЦреЗрдВ
  ```bash
  volatility -f <memory_dump> pslist
  ```

- рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рдиреНрд╕ рдХреА рд╕реВрдЪреА рджреЗрдЦреЗрдВ
  ```bash
  volatility -f <memory_dump> connections
  ```

- рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреА рд╕реВрдЪреА рджреЗрдЦреЗрдВ
  ```bash
  volatility -f <memory_dump> hivelist
  ```

- рдлрд╛рдЗрд▓реНрд╕рд┐рд╕реНрдЯрдо рдХреА рд╕реВрдЪреА рджреЗрдЦреЗрдВ
  ```bash
  volatility -f <memory_dump> filescan
  ```

#### рдбреАрдмрдЧрд┐рдВрдЧ рдЯрд┐рдкреНрд╕

- рдбреАрдмрдЧрд┐рдВрдЧ рдореЛрдб рдореЗрдВ рдЪрд▓рд╛рдПрдВ
  ```bash
  volatility --plugins=</path/to/plugins> -f <memory_dump> <plugin_name>
  ```

- рдбреАрдмрдЧрд┐рдВрдЧ рд▓реЙрдЧрд┐рдВрдЧ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ
  ```bash
  volatility --plugins=</path/to/plugins> -f <memory_dump> <plugin_name> --output-file=<output_file>
  ```

#### рдбреЗрд╡рд▓рдкрдореЗрдВрдЯ рдЯрд┐рдкреНрд╕

- рдкреНрд▓рдЧрдЗрди рдбреЗрд╡рд▓рдкрдореЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдЯреЗрдореНрдкрд▓реЗрдЯ рдмрдирд╛рдПрдВ
  ```bash
  volatility --plugins=</path/to/plugins> --tpl <plugin_name>
  ```

- рдкреНрд▓рдЧрдЗрди рдбреЗрд╡рд▓рдкрдореЗрдВрдЯ рдХреЗ рд▓рд┐рдП рд╕реНрдХреЗрд▓рдлреЛрд▓реНрдб рдмрдирд╛рдПрдВ
  ```bash
  volatility --plugins=</path/to/plugins> --scaffold <plugin_name>
  ```
```bash
volatility --profile=PROFILE pstree -f file.dmp # Get process tree (not hidden)
volatility --profile=PROFILE pslist -f file.dmp # Get process list (EPROCESS)
volatility --profile=PROFILE psscan -f file.dmp # Get hidden process list(malware)
volatility --profile=PROFILE psxview -f file.dmp # Get hidden process list
```
{% endtab %}
{% endtabs %}

### рдбрдВрдк рдкреНрд░реЙрдХ

{% tabs %}
{% tab title="vol3" %}
```bash
./vol.py -f file.dmp windows.dumpfiles.DumpFiles --pid <pid> #Dump the .exe and dlls of the process in the current directory
```
{% endtab %}

{% tab title="vol2" %}рд╣реИрдХрд┐рдВрдЧ рддрдХрдиреАрдХрд┐рдпреЛрдВ рдХреА рдПрдХ рдкреБрд╕реНрддрдХ рд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд╛рдордЧреНрд░реА рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд╛рдордЧреНрд░реА рдлрд╝рд╛рдЗрд▓ generic-methodologies-and-resources/basic-forensic-methodology/memory-dump-analysis/volatility-cheatsheet.md рд╕реЗ рд╣реИред рдЕрдВрдЧреНрд░реЗрдЬреА рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рдкрд╛рда рдХрд╛ рд╣рд┐рдВрджреА рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░реЗрдВ рдФрд░ рдЕрдиреБрд╡рд╛рдж рдХреЛ рд╡рд╣реА рдорд╛рд░реНрдХрдбрд╛рдЙрди рдФрд░ рдПрдЪрдЯреАрдПрдордПрд▓ рд╡рд┐рдиреНрдпрд╛рд╕ рдмрдирд╛рдП рд░рдЦреЗрдВред рдХреЛрдб, рд╣реИрдХрд┐рдВрдЧ рддрдХрдиреАрдХ рдирд╛рдо, рд╣реИрдХрд┐рдВрдЧ рд╢рдмреНрдж, рдХреНрд▓рд╛рдЙрдб/рдПрд╕рдПрдПрд╕ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдирд╛рдо (рдЬреИрд╕реЗ Workspace, aws, gcp...), 'рд▓реАрдХ', рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдФрд░ рдорд╛рд░реНрдХрдбрд╛рдЙрди рдЯреИрдЧреНрд╕ рдЬреИрд╕реА рдЪреАрдЬреЗрдВ рдЕрдиреБрд╡рд╛рдж рди рдХрд░реЗрдВред рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдХреЛрдИ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рд╛рдордЧреНрд░реА рди рдЬреЛрдбрд╝реЗрдВред%}
```bash
volatility --profile=Win7SP1x86_23418 procdump --pid=3152 -n --dump-dir=. -f file.dmp
```
{% endtab %}
{% endtabs %}

### рдХрдорд╛рдВрдб рд▓рд╛рдЗрди

рдХреНрдпрд╛ рдХреЛрдИ рд╕рдВрджреЗрд╣рд╛рд╕реНрдкрдж рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреА рдЧрдИ рдереАрдВ?
```bash
python3 vol.py -f file.dmp windows.cmdline.CmdLine #Display process command-line arguments
```
{% endtab %}

{% рдЯреИрдм рд╢реАрд░реНрд╖рдХ="vol2" %}
```bash
volatility --profile=PROFILE cmdline -f file.dmp #Display process command-line arguments
volatility --profile=PROFILE consoles -f file.dmp #command history by scanning for _CONSOLE_INFORMATION
```
{% endtab %}
{% endtabs %}

**`cmd.exe`** рдореЗрдВ рдЪрд▓рд╛рдП рдЧрдП рдХрдорд╛рдВрдб **`conhost.exe`** (рдпрд╛ Windows 7 рд╕реЗ рдкрд╣рд▓реЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ `csrss.exe`) рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдпрджрд┐ рдХрд┐рд╕реА рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ **`cmd.exe`** рдХреЛ рдмрдВрдж рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдкрд╣рд▓реЗ рдореЗрдореЛрд░реА рдбрдВрдк рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдлрд┐рд░ рднреА рд╕рддреНрд░ рдХреЗ рдХрдорд╛рдВрдб рд╣рд┐рд╕реНрдЯреНрд░реА рдХреЛ **`conhost.exe`** рдХреА рдореЗрдореЛрд░реА рд╕реЗ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдХрдВрд╕реЛрд▓ рдХреЗ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рдЕрд╕рд╛рдорд╛рдиреНрдп рдЧрддрд┐рд╡рд┐рдзрд┐ рдХрд╛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ, рддреЛ рд╕рдВрдмрдВрдзрд┐рдд **`conhost.exe`** рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдореЗрдореЛрд░реА рдбрдВрдк рдХреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдПред рдлрд┐рд░, рдЗрд╕ рдбрдВрдк рдореЗрдВ **рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕** рдХреА рдЦреЛрдЬ рдХрд░рдХреЗ, рд╕рддреНрд░ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдХрдорд╛рдВрдб рд▓рд╛рдЗрдиреНрд╕ рдХреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### рдкрд░реНрдпрд╛рд╡рд░рдг

рдкреНрд░рддреНрдпреЗрдХ рдЪрд▓ рд░рд╣реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдПрдирд╡рд╛рдпрд░рдирдореЗрдВрдЯ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рдорд╛рдиреНрдпрддрд╛рдПрдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред
```bash
python3 vol.py -f file.dmp windows.envars.Envars [--pid <pid>] #Display process environment variables
```
{% endtab %}

{% tab title="vol2" %}рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди

рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ:

```bash
volatility
```

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЙрдкрдпреЛрдЧ

рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

```bash
volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> <рдкреНрд▓рдЧрдЗрди> рдСрдкреНрд╢рди
```

рдЙрджрд╛рд╣рд░рдг:

```bash
volatility -f memdump.mem imageinfo
```

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдкреНрд▓рдЧрдЗрдиреНрд╕

рдХреБрдЫ рдЙрдкрдпреЛрдЧреА рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдкреНрд▓рдЧрдЗрдиреНрд╕:

- `imageinfo`: рдЗрдореЗрдЬ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ
- `pslist`: рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣
```bash
volatility --profile=PROFILE envars -f file.dmp [--pid <pid>] #Display process environment variables

volatility --profile=PROFILE -f file.dmp linux_psenv [-p <pid>] #Get env of process. runlevel var means the runlevel where the proc is initated
```
### рдЯреЛрдХрди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░

рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЯреЛрдХрди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХреГрдд рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рдирд╛ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
```bash
#Get enabled privileges of some processes
python3 vol.py -f file.dmp windows.privileges.Privs [--pid <pid>]
#Get all processes with interesting privileges
python3 vol.py -f file.dmp windows.privileges.Privs | grep "SeImpersonatePrivilege\|SeAssignPrimaryPrivilege\|SeTcbPrivilege\|SeBackupPrivilege\|SeRestorePrivilege\|SeCreateTokenPrivilege\|SeLoadDriverPrivilege\|SeTakeOwnershipPrivilege\|SeDebugPrivilege"
```
{% endtab %}

{% рдЯреИрдм рд╢реАрд░реНрд╖рдХ = "vol2" %}
```bash
#Get enabled privileges of some processes
volatility --profile=Win7SP1x86_23418 privs --pid=3152 -f file.dmp | grep Enabled
#Get all processes with interesting privileges
volatility --profile=Win7SP1x86_23418 privs -f file.dmp | grep "SeImpersonatePrivilege\|SeAssignPrimaryPrivilege\|SeTcbPrivilege\|SeBackupPrivilege\|SeRestorePrivilege\|SeCreateTokenPrivilege\|SeLoadDriverPrivilege\|SeTakeOwnershipPrivilege\|SeDebugPrivilege"
```
{% endtab %}
{% endtabs %}

### SIDs

рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рдореЗрдВ рд░рдЦреЗ рдЧрдП рдкреНрд░рддреНрдпреЗрдХ SSID рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред\
рдпрд╣ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ SID рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рдирд╛ (рдФрд░ рдХреБрдЫ рд╕реЗрд╡рд╛ SID рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ)ред
```bash
./vol.py -f file.dmp windows.getsids.GetSIDs [--pid <pid>] #Get SIDs of processes
./vol.py -f file.dmp windows.getservicesids.GetServiceSIDs #Get the SID of services
```
{% endtab %}

{% tab title="vol2" %}рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдХрдорд╛рдВрдбреНрд╕

- **рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдЬрд╛рдирдХрд╛рд░реА:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> imageinfo`

- **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реВрдЪреА:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> pslist`

- **рдиреЗрдЯрд╡рд░реНрдХ рд╕рдВрджреЗрд╢:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> netscan`

- **рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдЬрд╛рдВрдЪ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> hivelist`

- **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЬрд╛рдирдХрд╛рд░реА:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> getsids`

- **рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдЗрддрд┐рд╣рд╛рд╕:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> cmdline`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> dlllist`

- **рдХрд░рдВрдЯ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> pwdump`

- **рд╕рд░реНрд╡рд┐рд╕реЗрдЬ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> svcscan`

- **рдХрд░рдВрдЯ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> consoles`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> filescan`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> malfind`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> yarascan`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> modscan`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> apihooks`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> callbacks`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> ldrmodules`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> handles`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> mutantscan`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> threads`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> psxview`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> psscan`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> pstree`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> vadinfo`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> vadtree`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> vadwalk`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> vadlist`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> dlldump -D <рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА> -p <рдкреНрд░рдХреНрд░рд┐рдпрд╛_ID>`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> procdump -p <рдкреНрд░рдХреНрд░рд┐рдпрд╛_ID> -D <рдбрд╛рдпрд░реЗрдХреНрддрд░реА>`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> memdump -p <рдкреНрд░рдХреНрд░рд┐рдпрд╛_ID> -D <рдбрд╛рдпрд░реЗрдХреНрддрд░реА>`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> memmap`

- **рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ:**
  - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> memstrings -p <рдкреНрд░рдХреНрд░рд┐рдпрд╛_ID>`

- **рдбрд╛рдпрд░реЗрдХ
```bash
volatility --profile=Win7SP1x86_23418 getsids -f file.dmp #Get the SID owned by each process
volatility --profile=Win7SP1x86_23418 getservicesids -f file.dmp #Get the SID of each service
```
### рд╣реИрдВрдбрд▓реНрд╕

рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕ рдЕрдиреНрдп рдлрд╝рд╛рдЗрд▓, рдХреБрдВрдЬрд┐рдпреЛрдВ, рдзрд╛рдЧреЛрдВ, рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ... рдХреЗ рд▓рд┐рдП **рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдкрд╛рд╕ рд╣реИрдВрдбрд▓** рд╣реИрдВ (рдЦреЛрд▓ рд░рдЦрд╛ рд╣реИ)
```bash
vol.py -f file.dmp windows.handles.Handles [--pid <pid>]
```
{% endtab %}

{% tab title="vol2" %}рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди

- рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
  ```bash
  volatility -h
  ```

#### рдмреЗрд╕рд┐рдХ рдХрдорд╛рдВрдбреНрд╕

- рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
  ```bash
  volatility
  ```

- рдЙрдкрдпреЛрдЧреА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдХреА рдорджрдж рджреЗрдЦреЗрдВ
  ```bash
  volatility -h
  ```

#### рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдЕрдзреНрдпрдпрди

- рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдЕрдзреНрдпрдпрди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
  ```bash
  volatility -f <memory_dump_file> imageinfo
  ```

- рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <memory_dump_file> pslist
  ```

- рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <memory_dump_file> hivelist
  ```

#### рдиреЗрдЯрд╡рд░реНрдХ рдЕрдзреНрдпрдпрди

- рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <memory_dump_file> connections
  ```

- рдиреЗрдЯрд╡рд░реНрдХ рдЕрдзреНрдпрдпрди рдХреЗ рд▓рд┐рдП рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <memory_dump_file> netscan
  ```

#### рдЕрдиреНрдп рдЙрдкрдпреЛрдЧреА рдХрдорд╛рдВрдбреНрд╕

- рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <memory_dump_file> imageinfo
  ```

- рдбрд┐рд╕реНрдХ рдЗрдиреНрдлреЙрд░реНрдореЗрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <memory_dump_file> mftparser
  ```

- рдлрд╛рдЗрд▓ рдХрд╛рд░реНрд╡рд┐рдВрдЧ рдХрд░реЗрдВ
  ```bash
  volatility -f <memory_dump_file> filescan
  ```

- рд░реИрдирд╕рдорд╡реЗрдпрд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
  ```bash
  volatility -f <memory_dump_file> yarascan
  ```
```bash
volatility --profile=Win7SP1x86_23418 -f file.dmp handles [--pid=<pid>]
```
### DLLs

{% tabs %}
{% tab title="vol3" %}
```bash
./vol.py -f file.dmp windows.dlllist.DllList [--pid <pid>] #List dlls used by each
./vol.py -f file.dmp windows.dumpfiles.DumpFiles --pid <pid> #Dump the .exe and dlls of the process in the current directory process
```
{% endtab %}

{% tab title="vol2" %}рдпрд╣рд╛рдБ рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ рдХрд╛ рдЕрдиреБрднрд╛рдЧ рд╣реИред рдпрд╣ рдЪреАрдЯрд╢реАрдЯ рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдлреНрд░реЗрдорд╡рд░реНрдХ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рддрдХрдиреАрдХреЛрдВ рдХреЛ рд╕рдВрдХреНрд╖реЗрдкрд┐рдд рд░реВрдк рд╕реЗ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреА рд╣реИред рдпрд╣ рдЖрдкрдХреЛ рдореЗрдореЛрд░реА рдбрдВрдк рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдЖрджреЗрд╢реЛрдВ рдФрд░ рдЙрдкрдХрд░рдгреЛрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред рдЗрд╕реЗ рдЕрдкрдиреЗ рдЕрдиреБрд╕рдВрдзрд╛рди рдХреЗ рджреМрд░рд╛рди рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред{% endtab %}
```bash
volatility --profile=Win7SP1x86_23418 dlllist --pid=3152 -f file.dmp #Get dlls of a proc
volatility --profile=Win7SP1x86_23418 dlldump --pid=3152 --dump-dir=. -f file.dmp #Dump dlls of a proc
```
### рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕

Volatility рд╣рдореЗрдВ рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдХрд┐ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд┐рд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИред
```bash
strings file.dmp > /tmp/strings.txt
./vol.py -f /tmp/file.dmp windows.strings.Strings --strings-file /tmp/strings.txt
```
{% endtab %}

{% рдЯреИрдм рд╢реАрд░реНрд╖рдХ = "vol2" %}
```bash
strings file.dmp > /tmp/strings.txt
volatility -f /tmp/file.dmp windows.strings.Strings --string-file /tmp/strings.txt

volatility -f /tmp/file.dmp --profile=Win81U1x64 memdump -p 3532 --dump-dir .
strings 3532.dmp > strings_file
```
{% endtab %}
{% endtabs %}

рдпрд╣ рдпрд╛рд░рд╛рд╕реНрдХреИрди рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреА рднреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ:
```bash
./vol.py -f file.dmp windows.vadyarascan.VadYaraScan --yara-rules "https://" --pid 3692 3840 3976 3312 3084 2784
./vol.py -f file.dmp yarascan.YaraScan --yara-rules "https://"
```
{% endtab %}

{% рдЯреИрдм рд╢реАрд░реНрд╖рдХ = "vol2" %}
```bash
volatility --profile=Win7SP1x86_23418 yarascan -Y "https://" -p 3692,3840,3976,3312,3084,2784
```
{% endtab %}
{% endtabs %}

### UserAssist

**Windows** рдЙрди рдкреНрд░реЛрдЧреНрд░рд╛рдореЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдЪрд▓рд╛рддреЗ рд╣реИрдВ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рдПрдХ рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрд┐рд╕реЗ **UserAssist keys** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдпреЗ рдХреБрдВрдЬреА рдпрд╣ рджрд░реНрдЬ рдХрд░рддреА рд╣реИрдВ рдХрд┐ рд╣рд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛ рдХрд┐рддрдиреА рдмрд╛рд░ рдЪрд▓рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдпрд╣ рдХрдм рдЖрдЦрд┐рд░реА рдмрд╛рд░ рдЪрд▓рд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред
```bash
./vol.py -f file.dmp windows.registry.userassist.UserAssist
```
{% endtab %}

{% рдЯреИрдм рд╢реАрд░реНрд╖рдХ="vol2" %}
```
volatility --profile=Win7SP1x86_23418 -f file.dmp userassist
```
{% endtab %}
{% endtabs %}

тАЛ

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

тАЛтАЛтАЛтАЛ[**RootedCON**](https://www.rootedcon.com/) рд╕реНрдкреЗрди рдХреА рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдШрдЯрдирд╛ рд╣реИ рдФрд░ рдпреВрд░реЛрдк рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред **рддрдХрдиреАрдХреА рдЬреНрдЮрд╛рди рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рджреЗрдиреЗ** рдХреЗ рдорд┐рд╢рди рдХреЗ рд╕рд╛рде, рдпрд╣ рдХрд╛рдВрдЧреНрд░реЗрд╕ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдФрд░ рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдлрдирддреА рдорд┐рд▓рди рд╕реНрдерд▓ рд╣реИ рд╣рд░ рд╡рд┐рд╖рдп рдореЗрдВред

{% embed url="https://www.rootedcon.com/" %}

## рд╕реЗрд╡рд╛рдПрдВ

{% tabs %}
{% tab title="vol3" %}
```bash
./vol.py -f file.dmp windows.svcscan.SvcScan #List services
./vol.py -f file.dmp windows.getservicesids.GetServiceSIDs #Get the SID of services
```
{% endtab %}

{% tab title="vol2" %}рдпрд╣рд╛рдБ рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ рдХрд╛ рдЕрдиреБрднрд╛рдЧ рд╣реИред рдпрд╣ рдЪреАрдЯрд╢реАрдЯ рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдлреНрд░реЗрдорд╡рд░реНрдХ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЕрдиреБрдХреВрд▓рди рдФрд░ рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рд╕рдВрдХрд▓рд┐рдд рдХрд░рддреА рд╣реИред рдпрд╣ рдЖрдкрдХреЛ рдореЗрдореЛрд░реА рдбрдВрдк рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдЖрджреЗрд╢реЛрдВ рдФрд░ рдЙрдкрдХрд░рдгреЛрдВ рдХреА рд╕рд╛рд░рдгреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЪреАрдЯрд╢реАрдЯ рд╡рд┐рднрд┐рдиреНрди рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдореНрд╕ рдкрд░ рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред %}
```bash
#Get services and binary path
volatility --profile=Win7SP1x86_23418 svcscan -f file.dmp
#Get name of the services and SID (slow)
volatility --profile=Win7SP1x86_23418 getservicesids -f file.dmp
```
## рдиреЗрдЯрд╡рд░реНрдХ

{% tabs %}
{% tab title="vol3" %}
```bash
./vol.py -f file.dmp windows.netscan.NetScan
#For network info of linux use volatility2
```
{% endtab %}

{% tab title="vol2" %}рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди

- рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
  ```bash
  volatility
  ```

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдмреЗрд╕рд┐рдХ рдХрдорд╛рдВрдбреНрд╕

- рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
  ```bash
  volatility -h
  ```

- рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> imageinfo
  ```

- рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> pslist
  ```

- рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> hivelist
  ```

- рдлрд╝рд╛рдЗрд▓реНрд╕рд┐рд╕реНрдЯ рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> files
  ```

- рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рдиреНрд╕ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> connections
  ```

- рдбрдВрдк рдХреА рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> psscan
  ```

- рдбрдВрдк рд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> pstree
  ```

- рдбрдВрдк рд╕реЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> printkey -o <рдСрдлрд╕реЗрдЯ>
  ```

- рдбрдВрдк рд╕реЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> printkey -o <рдСрдлрд╕реЗрдЯ>
  ```

- рдбрдВрдк рд╕реЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> printkey -o <рдСрдлрд╕реЗрдЯ>
  ```

- рдбрдВрдк рд╕реЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> printkey -o <рдСрдлрд╕реЗрдЯ>
  ```

- рдбрдВрдк рд╕реЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> printkey -o <рдСрдлрд╕реЗрдЯ>
  ```

- рдбрдВрдк рд╕реЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> printkey -o <рдСрдлрд╕реЗрдЯ>
  ```

- рдбрдВрдк рд╕реЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> printkey -o <рдСрдлрд╕реЗрдЯ>
  ```

- рдбрдВрдк рд╕реЗ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
  ```bash
  volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> printkey -o <рдСрдлрд╕реЗрдЯ>
  ```
```bash
volatility --profile=Win7SP1x86_23418 netscan -f file.dmp
volatility --profile=Win7SP1x86_23418 connections -f file.dmp#XP and 2003 only
volatility --profile=Win7SP1x86_23418 connscan -f file.dmp#TCP connections
volatility --profile=Win7SP1x86_23418 sockscan -f file.dmp#Open sockets
volatility --profile=Win7SP1x86_23418 sockets -f file.dmp#Scanner for tcp socket objects

volatility --profile=SomeLinux -f file.dmp linux_ifconfig
volatility --profile=SomeLinux -f file.dmp linux_netstat
volatility --profile=SomeLinux -f file.dmp linux_netfilter
volatility --profile=SomeLinux -f file.dmp linux_arp #ARP table
volatility --profile=SomeLinux -f file.dmp linux_list_raw #Processes using promiscuous raw sockets (comm between processes)
volatility --profile=SomeLinux -f file.dmp linux_route_cache
```
## рд░рдЬрд┐рд╕реНрдЯреНрд░реА рд╣рд╛рдЗрд╡

### рдЙрдкрд▓рдмреНрдз рд╣рд╛рдЗрд╡реНрд╕ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ

{% tabs %}
{% tab title="vol3" %}
```bash
./vol.py -f file.dmp windows.registry.hivelist.HiveList #List roots
./vol.py -f file.dmp windows.registry.printkey.PrintKey #List roots and get initial subkeys
```
{% endtab %}

{% tab title="vol2" %}рд╣реИрдХрд┐рдВрдЧ рддрдХрдиреАрдХреЛрдВ рдХреА рдПрдХ рдкреБрд╕реНрддрдХ рд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд╛рдордЧреНрд░реА рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд╛рдордЧреНрд░реА рдлрд╝рд╛рдЗрд▓ generic-methodologies-and-resources/basic-forensic-methodology/memory-dump-analysis/volatility-cheatsheet.md рд╕реЗ рд╣реИред рдЕрдВрдЧреНрд░реЗрдЬреА рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рдкрд╛рда рдХрд╛ рд╣рд┐рдВрджреА рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░реЗрдВ рдФрд░ рдЕрдиреБрд╡рд╛рдж рдХреЛ рд╡рд╣реА рдорд╛рд░реНрдХрдбрд╛рдЙрди рдФрд░ HTML рд╕рд┐рдВрдЯреЗрдХреНрд╕ рдХреЗ рд╕рд╛рде рд╡рд╛рдкрд╕ рднреЗрдЬреЗрдВред рдХреЛрдб, рд╣реИрдХрд┐рдВрдЧ рддрдХрдиреАрдХ рдирд╛рдо, рд╣реИрдХрд┐рдВрдЧ рд╢рдмреНрдж, рдХреНрд▓рд╛рдЙрдб / SaaS рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдирд╛рдо (рдЬреИрд╕реЗ Workspace, aws, gcp ...), 'рд▓реАрдХ', рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ, рдФрд░ рдорд╛рд░реНрдХрдбрд╛рдЙрди рдЯреИрдЧреНрд╕ рдЬреИрд╕реА рдЪреАрдЬреЗрдВ рдЕрдиреБрд╡рд╛рдж рди рдХрд░реЗрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдХреЛрдИ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рд╛рдордЧреНрд░реА рди рдЬреЛрдбрд╝реЗрдВред{% endtab %}
```bash
volatility --profile=Win7SP1x86_23418 -f file.dmp hivelist #List roots
volatility --profile=Win7SP1x86_23418 -f file.dmp printkey #List roots and get initial subkeys
```
### рдПрдХ рдорд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

{% tabs %}
{% tab title="vol3" %}
```bash
./vol.py -f file.dmp windows.registry.printkey.PrintKey --key "Software\Microsoft\Windows NT\CurrentVersion"
```
{% endtab %}

{% рдЯреИрдм рд╢реАрд░реНрд╖рдХ = "vol2" %}
```bash
volatility --profile=Win7SP1x86_23418 printkey -K "Software\Microsoft\Windows NT\CurrentVersion" -f file.dmp
# Get Run binaries registry value
volatility -f file.dmp --profile=Win7SP1x86 printkey -o 0x9670e9d0 -K 'Software\Microsoft\Windows\CurrentVersion\Run'
```
### рдбрдВрдк
```bash
#Dump a hive
volatility --profile=Win7SP1x86_23418 hivedump -o 0x9aad6148 -f file.dmp #Offset extracted by hivelist
#Dump all hives
volatility --profile=Win7SP1x86_23418 hivedump -f file.dmp
```
## рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо

### рдорд╛рдЙрдВрдЯ

{% tabs %}
{% tab title="vol3" %}
```bash
#See vol2
```
{% endtab %}

{% рдЯреИрдм рд╢реАрд░реНрд╖рдХ = "vol2" %}
```bash
volatility --profile=SomeLinux -f file.dmp linux_mount
volatility --profile=SomeLinux -f file.dmp linux_recover_filesystem #Dump the entire filesystem (if possible)
```
### рд╕реНрдХреИрди/рдбрдВрдк

{% tabs %}
{% tab title="vol3" %}
```bash
./vol.py -f file.dmp windows.filescan.FileScan #Scan for files inside the dump
./vol.py -f file.dmp windows.dumpfiles.DumpFiles --physaddr <0xAAAAA> #Offset from previous command
```
{% endtab %}

{% tab title="vol2" %}рд╣рд┐рдВрджреА{% endtab %}
```bash
volatility --profile=Win7SP1x86_23418 filescan -f file.dmp #Scan for files inside the dump
volatility --profile=Win7SP1x86_23418 dumpfiles -n --dump-dir=/tmp -f file.dmp #Dump all files
volatility --profile=Win7SP1x86_23418 dumpfiles -n --dump-dir=/tmp -Q 0x000000007dcaa620 -f file.dmp

volatility --profile=SomeLinux -f file.dmp linux_enumerate_files
volatility --profile=SomeLinux -f file.dmp linux_find_file -F /path/to/file
volatility --profile=SomeLinux -f file.dmp linux_find_file -i 0xINODENUMBER -O /path/to/dump/file
```
### рдорд╛рд╕реНрдЯрд░ рдлрд╝рд╛рдЗрд▓ рдЯреЗрдмрд▓

{% tabs %}
{% tab title="vol3" %}
```bash
# I couldn't find any plugin to extract this information in volatility3
```
{% endtab %}

{% tab title="vol2" %}рд╣реИрдХрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдЪреНрдЫрд╛ рдЙрдкрдХрд░рдг рд╣реИ Volatility, рдЬреЛ рд░реВрдкрд╛рдВрддрд░рдг рдФрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдЦреБрд▓рд╛ рд╕реНрд░реЛрддреАрдп рд░реВрдкрд╛рдВрддрд░рдг рдЙрдкрдХрд░рдг рд╣реИред рдпрд╣ рдПрдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдореЗрдореЛрд░реА рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рд░рдирдЯрд╛рдЗрдо рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣ред рдпрд╣ рдЪреАрдЬреЗрдВ рдЬреИрд╕реЗ рдХрд┐ рдкреНрд░рдХреНрд░рд┐рдпрд╛, рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рди, рд▓реЙрдЧрди, рдФрд░ рдЕрдиреНрдп рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИред рдпрд╣ рдЪреАрдЬреЗрдВ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЖрдХрд▓рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рд░реВрдЯрдХрд┐рдЯреНрд╕, рд░рдирд╕реЛрдорд╡реЗрдпрд░, рдФрд░ рдЕрдиреНрдп рдореБрджреНрджреЗред рдпрд╣ рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рдбрд┐рдлреЗрдВрд╕ рдФрд░ рдЕрдзреНрдпрдпрди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИред{% endtab %}
```bash
volatility --profile=Win7SP1x86_23418 mftparser -f file.dmp
```
{% endtab %}
{% endtabs %}

**NTFS рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо** рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдШрдЯрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ _рдорд╛рд╕реНрдЯрд░ рдлрд╝рд╛рдЗрд▓ рдЯреЗрдмрд▓_ (MFT) рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рдХрдо рд╕реЗ рдХрдо рдПрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рд╣реЛрддреА рд╣реИ рд╣рд░ рд╡реЙрд▓реНрдпреВрдо рдкрд░ рд╣рд░ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП, MFT рдЦреБрдж рдХреЛ рднреА рд╢рд╛рдорд┐рд▓ рдХрд░рддреЗ рд╣реБрдПред рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рд╡рд░рдг, рдЬреИрд╕реЗ **рдЖрдХрд╛рд░, рд╕рдордп рдЪрд┐рд╣реНрди, рдЕрдиреБрдорддрд┐рдпрд╛рдБ, рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдбреЗрдЯрд╛**, MFT рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдореЗрдВ рдпрд╛ MFT рдХреЗ рдмрд╛рд╣рд░реА рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рд╕рдВрдХреЗрддрд┐рдд рдХрд┐рдП рдЧрдП рдЗрди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдмрдВрдзреА рд╣реЛрддреЗ рд╣реИрдВред рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг [рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг](https://docs.microsoft.com/en-us/windows/win32/fileio/master-file-table) рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИред

### SSL рдХреБрдВрдЬреА/рдкреНрд░рдорд╛рдгрдкрддреНрд░
```bash
#vol3 allows to search for certificates inside the registry
./vol.py -f file.dmp windows.registry.certificates.Certificates
```
{% endtab %}

{% tab title="vol2" %}рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди

- рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
  ```bash
  volatility -h
  ```

#### рдмреЗрд╕рд┐рдХ рдлреЙрд░реЗрдВрд╕рд┐рдХ рдореЗрдердбреЛрд▓реЙрдЬреА

- рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЪреЗрдХ
  ```bash
  volatility -f <memory_dump> imageinfo
  ```

- рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╕реВрдЪреА
  ```bash
  volatility -f <memory_dump> pslist
  ```

- рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рдиреНрд╕
  ```bash
  volatility -f <memory_dump> connections
  ```

- рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА
  ```bash
  volatility -f <memory_dump> printkey -o <offset>
  ```

- рдлрд╝рд╛рдЗрд▓реНрд╕ рд╕рд┐рд╕реНрдЯрдо рдХреА рдЬрд╛рдВрдЪ
  ```bash
  volatility -f <memory_dump> filescan
  ```

- рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЪреЗрдХ рдФрд░ рддрд╛рдЬрдЧреА рдХреА рдЬрд╛рдВрдЪ
  ```bash
  volatility -f <memory_dump> --profile=<profile> imageinfo
  ```

- рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЪреЗрдХ рдФрд░ рддрд╛рдЬрдЧреА рдХреА рдЬрд╛рдВрдЪ (рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд)
  ```bash
  volatility -f <memory_dump> --profile=<profile> imageinfo -v
  ```

- рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЪреЗрдХ рдФрд░ рддрд╛рдЬрдЧреА рдХреА рдЬрд╛рдВрдЪ (рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдФрд░ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдЬрд╛рдВрдЪ)
  ```bash
  volatility -f <memory_dump> --profile=<profile> imageinfo -v -r <registry_hive>
  ```

- рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЪреЗрдХ рдФрд░ рддрд╛рдЬрдЧреА рдХреА рдЬрд╛рдВрдЪ (рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд, рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдЬрд╛рдВрдЪ рдФрд░ рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдХреБрдВрдЬреА рдХреА рдЬрд╛рдВрдЪ)
  ```bash
  volatility -f <memory_dump> --profile=<profile> imageinfo -v -r <registry_hive> --kdbg <kdbg_address>
  ```

#### рдбрд┐рдмрдЧрд┐рдВрдЧ

- рдбрд┐рдмрдЧрд┐рдВрдЧ рд╢реБрд░реВ рдХрд░реЗрдВ
  ```bash
  volatility -f <memory_dump> -D <output_directory> --profile=<profile> procdump -p <process_id>
  ```

- рдбрд┐рдмрдЧрд┐рдВрдЧ рдФрд░ рдбрдВрдк рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ
  ```bash
  volatility -f <memory_dump> --profile=<profile> -D <output_directory> memdump -p <process_id>
  ```

- рдбрд┐рдмрдЧрд┐рдВрдЧ рдФрд░ рдбрдВрдк рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ (рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд)
  ```bash
  volatility -f <memory_dump> --profile=<profile> -D <output_directory> memdump -p <process_id> --dump-dir <dump_directory>
  ```

- рдбрд┐рдмрдЧрд┐рдВрдЧ рдФрд░ рдбрдВрдк рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ (рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдФрд░ рдбрдВрдк рдХрд╛ рдЖрдХрд╛рд░)
  ```bash
  volatility -f <memory_dump> --profile=<profile> -D <output_directory> memdump -p <process_id> --dump-dir <dump_directory> --dump-size <dump_size>
  ```

#### рдЕрдиреНрдп рдЙрдкрдпреЛрдЧреА рдЖрджрд╛рди-рдкреНрд░рджрд╛рди

- рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреА рд╕реВрдЪреА
  ```bash
  volatility --plugins=<plugin_directory>
  ```

- рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреА рд╕реВрдЪреА (рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд)
  ```bash
  volatility --plugins=<plugin_directory> --info
  ```

- рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреА рд╕реВрдЪреА (рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдФрд░ рд╡рд░реНрдмреЛрд╕)
  ```bash
  volatility --plugins=<plugin_directory> --info -v
  ```

- рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреА рд╕реВрдЪреА (рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд, рд╡рд░реНрдмреЛрд╕ рдФрд░ рдбрд┐рдмрдЧ)
  ```bash
  volatility --plugins=<plugin_directory> --info -v -d
  ```

{% endtab %}
```bash
#vol2 allos you to search and dump certificates from memory
#Interesting options for this modules are: --pid, --name, --ssl
volatility --profile=Win7SP1x86_23418 dumpcerts --dump-dir=. -f file.dmp
```
## рдореИрд▓рд╡реЗрдпрд░

{% tabs %}
{% tab title="vol3" %}
```bash
./vol.py -f file.dmp windows.malfind.Malfind [--dump] #Find hidden and injected code, [dump each suspicious section]
#Malfind will search for suspicious structures related to malware
./vol.py -f file.dmp windows.driverirp.DriverIrp #Driver IRP hook detection
./vol.py -f file.dmp windows.ssdt.SSDT #Check system call address from unexpected addresses

./vol.py -f file.dmp linux.check_afinfo.Check_afinfo #Verifies the operation function pointers of network protocols
./vol.py -f file.dmp linux.check_creds.Check_creds #Checks if any processes are sharing credential structures
./vol.py -f file.dmp linux.check_idt.Check_idt #Checks if the IDT has been altered
./vol.py -f file.dmp linux.check_syscall.Check_syscall #Check system call table for hooks
./vol.py -f file.dmp linux.check_modules.Check_modules #Compares module list to sysfs info, if available
./vol.py -f file.dmp linux.tty_check.tty_check #Checks tty devices for hooks
```
{% endtab %}

{% рдЯреИрдм рд╢реАрд░реНрд╖рдХ="vol2" %}
```bash
volatility --profile=Win7SP1x86_23418 -f file.dmp malfind [-D /tmp] #Find hidden and injected code [dump each suspicious section]
volatility --profile=Win7SP1x86_23418 -f file.dmp apihooks #Detect API hooks in process and kernel memory
volatility --profile=Win7SP1x86_23418 -f file.dmp driverirp #Driver IRP hook detection
volatility --profile=Win7SP1x86_23418 -f file.dmp ssdt #Check system call address from unexpected addresses

volatility --profile=SomeLinux -f file.dmp linux_check_afinfo
volatility --profile=SomeLinux -f file.dmp linux_check_creds
volatility --profile=SomeLinux -f file.dmp linux_check_fop
volatility --profile=SomeLinux -f file.dmp linux_check_idt
volatility --profile=SomeLinux -f file.dmp linux_check_syscall
volatility --profile=SomeLinux -f file.dmp linux_check_modules
volatility --profile=SomeLinux -f file.dmp linux_check_tty
volatility --profile=SomeLinux -f file.dmp linux_keyboard_notifiers #Keyloggers
```
{% endtab %}
{% endtabs %}

### рдпрд╛рд░рд╛ рдХреЗ рд╕рд╛рде рд╕реНрдХреИрдирд┐рдВрдЧ

рдЗрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЧрд┐рдердм рд╕реЗ рд╕рднреА рдпрд╛рд░рд╛ рдореИрд▓рд╡реЗрдпрд░ рдирд┐рдпрдо рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рдорд░реНрдЬ рдХрд░реЗрдВ: [https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9](https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9)\
_**rules**_ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдмрдирд╛рдПрдВ рдФрд░ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВред рдЗрд╕рд╕реЗ _**malware\_rules.yar**_ рдирд╛рдо рдХреА рдПрдХ рдлрд╝рд╛рдЗрд▓ рдмрдиреЗрдЧреА рдЬрд┐рд╕рдореЗрдВ рд╕рднреА рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рд▓рд┐рдП рдпрд╛рд░рд╛ рдирд┐рдпрдо рд╣реЛрдВрдЧреЗред
```bash
wget https://gist.githubusercontent.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9/raw/4ec711d37f1b428b63bed1f786b26a0654aa2f31/malware_yara_rules.py
mkdir rules
python malware_yara_rules.py
#Only Windows
./vol.py -f file.dmp windows.vadyarascan.VadYaraScan --yara-file /tmp/malware_rules.yar
#All
./vol.py -f file.dmp yarascan.YaraScan --yara-file /tmp/malware_rules.yar
```
{% endtab %}

{% tab title="vol2" %}рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЯреВрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмреБрдирд┐рдпрд╛рджреА рдлреЛрд░реЗрдВрд╕рд┐рдХ рдореЗрдердбреЛрд▓реЙрдЬреА

1. **рдбреЗрдЯрд╛ рдХрд▓реЗрдХреНрд╢рди:**
   - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> imageinfo` - рдбрдВрдк рдлрд╝рд╛рдЗрд▓ рдХреА рдореЗрдЯрд╛рдбреЗрдЯрд╛ рджреЗрдЦреЗрдВ
   - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> --profile=<рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓> pslist` - рдкреНрд░реЛрд╕реЗрд╕ рд▓рд┐рд╕реНрдЯ рджреЗрдЦреЗрдВ
   - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> --profile=<рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓> cmdline` - рдХрдорд╛рдВрдбрд▓рд╛рдЗрди рджреЗрдЦреЗрдВ

2. **рдбреЗрдЯрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг:**
   - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> --profile=<рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓> pstree` - рдкреНрд░реЛрд╕реЗрд╕ рдЯреНрд░реА рджреЗрдЦреЗрдВ
   - `volvatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> --profile=<рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓> filescan` - рдлрд╝рд╛рдЗрд▓ рд╕реНрдХреИрди рдХрд░реЗрдВ
   - `volatility -f <рдбрдВрдк_рдлрд╝рдЗрд▓> --profile=<рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓> netscan` - рдиреЗрдЯрд╡рд░реНрдХ рдХрдиреЗрдХреНрд╢рдиреНрд╕ рджреЗрдЦреЗрдВ

3. **рдбреЗрдЯрд╛ рд░рд┐рдХрд╡рд░реА:**
   - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> --profile=<рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓> dumpfiles -Q <рдСрдлрд╕реЗрдЯ>` - рдлрд╝рд╛рдЗрд▓реНрд╕ рдХреЛ рдбрдВрдк рдХрд░реЗрдВ
   - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> --profile=<рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓> memdump -p <рдкреНрд░реЛрд╕реЗрд╕_ID> -D <рдбреЗрд╕реНрдЯрд┐рдиреЗрд╢рди_рдлрд╝реЛрд▓реНрдбрд░>` - рдореЗрдореЛрд░реА рдбрдВрдк рдХрд░реЗрдВ

4. **рдбреЗрдЯрд╛ рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ:**
   - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> --profile=<рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓> connscan` - рдХрдиреЗрдХреНрд╢рдиреНрд╕ рд╕реНрдХреИрди рдХрд░реЗрдВ
   - `volatility -f <рдбрдВрдк_рдлрд╝рд╛рдЗрд▓> --profile=<рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓> timeliner` - рдЯрд╛рдЗрдорд▓рд╛рдЗрди рдмрдирд╛рдПрдВ

{% endtab %}
```bash
wget https://gist.githubusercontent.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9/raw/4ec711d37f1b428b63bed1f786b26a0654aa2f31/malware_yara_rules.py
mkdir rules
python malware_yara_rules.py
volatility --profile=Win7SP1x86_23418 yarascan -y malware_rules.yar -f ch2.dmp | grep "Rule:" | grep -v "Str_Win32" | sort | uniq
```
## рдЕрдиреНрдп

### рдмрд╛рд╣рд░реА рдкреНрд▓рдЧрдЗрди

рдпрджрд┐ рдЖрдк рдмрд╛рд╣рд░реА рдкреНрд▓рдЧрдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдкреНрд▓рдЧрдЗрди рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдлрд╝реЛрд▓реНрдбрд░ рдкрд╣рд▓рд╛ рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИред
```bash
./vol.py --plugin-dirs "/tmp/plugins/" [...]
```
{% endtab %}

{% рдЯреИрдм рд╢реАрд░реНрд╖рдХ="vol2" %}
```bash
volatilitye --plugins="/tmp/plugins/" [...]
```
{% endtab %}
{% endtabs %}

#### Autoruns

рдЗрд╕реЗ [https://github.com/tomchop/volatility-autoruns](https://github.com/tomchop/volatility-autoruns) рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред
```
volatility --plugins=volatility-autoruns/ --profile=WinXPSP2x86 -f file.dmp autoruns
```
### рдореНрдпреВрдЯреЗрдХреНрд╕

{% tabs %}
{% tab title="vol3" %}
```
./vol.py -f file.dmp windows.mutantscan.MutantScan
```
{% endtab %}

{% рдЯреИрдм рд╢реАрд░реНрд╖рдХ = "vol2" %}
```bash
volatility --profile=Win7SP1x86_23418 mutantscan -f file.dmp
volatility --profile=Win7SP1x86_23418 -f file.dmp handles -p <PID> -t mutant
```
### рд╕рд┐рдорд▓рд┐рдВрдХреНрд╕

{% tabs %}
{% tab title="vol3" %}
```bash
./vol.py -f file.dmp windows.symlinkscan.SymlinkScan
```
{% endtab %}

{% tab title="vol2" %}рд╣реИрдХрд┐рдВрдЧ рддрдХрдиреАрдХрд┐рдпреЛрдВ рдХреА рдПрдХ рдХрд┐рддрд╛рдм рд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд╛рдордЧреНрд░реА рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд╛рдордЧреНрд░реА рдлрд╝рд╛рдЗрд▓ generic-methodologies-and-resources/basic-forensic-methodology/memory-dump-analysis/volatility-cheatsheet.md рд╕реЗ рд╣реИред рдЕрдВрдЧреНрд░реЗрдЬреА рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рдкрд╛рда рдХрд╛ рд╣рд┐рдВрджреА рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░реЗрдВ рдФрд░ рдЕрдиреБрд╡рд╛рдж рдХреЛ рд╡рд╣реА рдорд╛рд░реНрдХрдбрд╛рдЙрди рдФрд░ рдПрдЪрдЯреАрдПрдордПрд▓ рд╡рд┐рдиреНрдпрд╛рд╕ рдмрдирд╛рдП рд░рдЦреЗрдВред рдХреЛрдб, рд╣реИрдХрд┐рдВрдЧ рддрдХрдиреАрдХ рдирд╛рдо, рд╣реИрдХрд┐рдВрдЧ рд╢рдмреНрдж, рдХреНрд▓рд╛рдЙрдб/рдПрд╕рдПрдПрд╕ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдирд╛рдо (рдЬреИрд╕реЗ Workspace, aws, gcp...), 'рд▓реАрдХ', рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдФрд░ рдорд╛рд░реНрдХрдбрд╛рдЙрди рдЯреИрдЧреНрд╕ рдЬреИрд╕реА рдЪреАрдЬреЗрдВ рдЕрдиреБрд╡рд╛рдж рди рдХрд░реЗрдВред рдЕрдиреБрд╡рд╛рдж рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдХреЛрдИ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рд╛рдордЧреНрд░реА рди рдЬреЛрдбрд╝реЗрдВред%}
```bash
volatility --profile=Win7SP1x86_23418 -f file.dmp symlinkscan
```
### рдмреИрд╢

**рдпрд╛рдж рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ рдХрд┐ рдмреИрд╢ рд╣рд┐рд╕реНрдЯреНрд░реА рд╕реЗ рдкрдврд╝реЗрдВред** рдЖрдк _.bash\_history_ рдлрд╝рд╛рдЗрд▓ рдХреЛ рднреА рдбрдВрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрджрд┐ рдпрд╣ рдЕрдХреНрд╖рдо рд╣реИ рддреЛ рдЖрдк рдЗрд╕ рд╡реЙрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
```
./vol.py -f file.dmp linux.bash.Bash
```
{% endtab %}

{% tab title="vol2" %}рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЪреАрдЯрд╢реАрдЯ

#### рд╡реЛрд▓реЗрдЯрд┐рд▓рд┐рдЯреА рдЯреВрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ

- **рдбреЗрдЯрд╛ рдХрд▓реЗрдХреНрд╢рди:** `imagecopy`, `memdump`, `malfind`, `apihooks`, `dlldump`, `dumpfiles`, `handles`, `hollowfind`, `ldrmodules`, `malfind`, `memmap`, `modules`, `modscan`, `psscan`, `pslist`, `pstree`, `psxview`, `shimcache`, `sockets`, `svcscan`, `thrdscan`, `timeliner`, `vadinfo`, `vaddump`, `vadtree`, `vadwalk`, `wndscan`, `yarascan`
- **рдбреЗрдЯрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг:** `apihooks`, `atomscan`, `callbacks`, `connscan`, `deskscan`, `driverirp`, `drivermodule`, `driverscan`, `envars`, `filescan`, `gahti`, `gditimers`, `getservicesids`, `getsids`, `handles`, `hashdump`, `hivelist`, `idt`, `iehistory`, `imageinfo`, `joblinks`, `ldrmodules`, `malfind`, `mbrparser`, `memmap`, `messagehooks`, `modscan`, `modules`, `mutantscan`, `objtypescan`, `patcher`, `printkey`, `privs`, `pslist`, `psscan`, `pstree`, `psxview`, `registry`, `sessions`, `shellbags`, `shimcache`, `sockets`, `ssdt`, `strings`, `svcscan`, `symlinkscan`, `thrdscan`, `timeliner`, `unloadedmodules`, `userassist`, `userhandles`, `vadinfo`, `vaddump`, `vadtree`, `vadwalk`, `wndscan`, `yarascan`
- **рдбреЗрдЯрд╛ рд░рд┐рдХрд╡рд░реА:** `dumpfiles`, `filescan`, `hivelist`, `imagecopy`, `memdump`, `moddump`, `modscan`, `psscan`, `pstree`, `psxview`, `svcscan`, `vaddump`, `wndscan`
- **рдбреЗрдЯрд╛ рдирд┐рд░реАрдХреНрд╖рдг:** `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`, `atomscan`,
```
volatility --profile=Win7SP1x86_23418 -f file.dmp linux_bash
```
{% endtab %}
{% endtabs %}

### рд╕рдордпрд░реЗрдЦрд╛

{% tabs %}
{% tab title="vol3" %}
```bash
./vol.py -f file.dmp timeLiner.TimeLiner
```
{% endtab %}

{% tab title="vol2" %}рд╣рд┐рдВрджреА{% endtab %}
```
volatility --profile=Win7SP1x86_23418 -f timeliner
```
### рдбреНрд░рд╛рдЗрд╡рд░реНрд╕

{% tabs %}
{% tab title="vol3" %}
```
./vol.py -f file.dmp windows.driverscan.DriverScan
```
{% endtab %}

{% рдЯреИрдм рд╢реАрд░реНрд╖рдХ = "vol2" %}
```bash
volatility --profile=Win7SP1x86_23418 -f file.dmp driverscan
```
{% endtab %}
{% endtabs %}

### рдХреНрд▓рд┐рдкрдмреЛрд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
```bash
#Just vol2
volatility --profile=Win7SP1x86_23418 clipboard -f file.dmp
```
### IE рдЗрддрд┐рд╣рд╛рд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
```bash
#Just vol2
volatility --profile=Win7SP1x86_23418 iehistory -f file.dmp
```
### рдиреЛрдЯрдкреИрдб рдЯреЗрдХреНрд╕реНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
```bash
#Just vol2
volatility --profile=Win7SP1x86_23418 notepad -f file.dmp
```
### рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ
```bash
#Just vol2
volatility --profile=Win7SP1x86_23418 screenshot -f file.dmp
```
### рдорд╛рд╕реНрдЯрд░ рдмреВрдЯ рд░рд┐рдХреЙрд░реНрдб (MBR)
```bash
volatility --profile=Win7SP1x86_23418 mbrparser -f file.dmp
```
**рдорд╛рд╕реНрдЯрд░ рдмреВрдЯ рд░рд┐рдХреЙрд░реНрдб (MBR)** рдПрдХ рд╕реНрдЯреЛрд░реЗрдЬ рдореАрдбрд┐рдпрдо рдХреЗ рддрд╛рд░реНрдХрд┐рдХ рд╡рд┐рднрд╛рдЬрдиреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддрд╛ рд╣реИ, рдЬреЛ рд╡рд┐рднрд┐рдиреНрди [рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо](https://en.wikipedia.org/wiki/File_system) рдХреЗ рд╕рд╛рде рд╕рдВрд░рдЪрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред рдпрд╣ рдХреЗрд╡рд▓ рд╡рд┐рднрд╛рдЬрди рдЦрд╛рдХрд╛ рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рд░рдЦрддрд╛ рд╣реИ рдмрд▓реНрдХрд┐ рдПрдХ рдмреВрдЯ рд▓реЛрдбрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреНрд░рд┐рдпрд╛рддреНрдордХ рдХреЛрдб рднреА рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдмреВрдЯ рд▓реЛрдбрд░ рдпрд╛ рддреЛ рд╕реАрдзреЗ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреА рджреВрд╕рд░реЗ рд╕реНрдЯреЗрдЬ рд▓реЛрдбрд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░рддрд╛ рд╣реИ (рджреЗрдЦреЗрдВ [рджреНрд╡рд┐рддреАрдп рд╕реНрдЯреЗрдЬ рдмреВрдЯ рд▓реЛрдбрд░](https://en.wikipedia.org/wiki/Second-stage_boot_loader)) рдпрд╛ рдкреНрд░рддреНрдпреЗрдХ рд╡рд┐рднрд╛рдЬрди рдХреЗ [рд╡реЙрд▓реНрдпреВрдо рдмреВрдЯ рд░рд┐рдХреЙрд░реНрдб](https://en.wikipedia.org/wiki/Volume_boot_record) (VBR) рдХреЗ рд╕рд╛рде рд╕рдордиреНрд╡рдп рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, [MBR Wikipedia рдкреГрд╖реНрда](https://en.wikipedia.org/wiki/Master_boot_record) рдкрд░ рдЬрд╛рдПрдВред

# рд╕рдВрджрд░реНрдн
* [https://andreafortuna.org/2017/06/25/volatility-my-own-cheatsheet-part-1-image-identification/](https://andreafortuna.org/2017/06/25/volatility-my-own-cheatsheet-part-1-image-identification/)
* [https://scudette.blogspot.com/2012/11/finding-kernel-debugger-block.html](https://scudette.blogspot.com/2012/11/finding-kernel-debugger-block.html)
* [https://or10nlabs.tech/cgi-sys/suspendedpage.cgi](https://or10nlabs.tech/cgi-sys/suspendedpage.cgi)
* [https://www.aldeid.com/wiki/Windows-userassist-keys](https://www.aldeid.com/wiki/Windows-userassist-keys)
тАЛ* [https://learn.microsoft.com/en-us/windows/win32/fileio/master-file-table](https://learn.microsoft.com/en-us/windows/win32/fileio/master-file-table)
* [https://answers.microsoft.com/en-us/windows/forum/all/uefi-based-pc-protective-mbr-what-is-it/0fc7b558-d8d4-4a7d-bae2-395455bb19aa](https://answers.microsoft.com/en-us/windows/forum/all/uefi-based-pc-protective-mbr-what-is-it/0fc7b558-d8d4-4a7d-bae2-395455bb19aa)

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com/) **рд╕реНрдкреЗрди** рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдШрдЯрдирд╛ рд╣реИ рдФрд░ **рдпреВрд░реЛрдк** рдореЗрдВ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред **рддрдХрдиреАрдХреА рдЬреНрдЮрд╛рди рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рджреЗрдиреЗ** рдХреЗ рдорд┐рд╢рди рдХреЗ рд╕рд╛рде, рдпрд╣ рдХрд╛рдВрдЧреНрд░реЗрд╕ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдФрд░ рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдлрд╛рдирддрд╛ рд╕рдореНрдореЗрд▓рди рд╣реИред

{% embed url="https://www.rootedcon.com/" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
