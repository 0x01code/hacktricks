# Evil Twin EAP-TLS

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PRs aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Conseil pour les bug bounties** : **inscrivez-vous** sur **Intigriti**, une plateforme premium de **bug bounties cr√©√©e par des hackers, pour des hackers** ! Rejoignez-nous sur [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) aujourd'hui, et commencez √† gagner des bounties jusqu'√† **100 000 $** !

{% embed url="https://go.intigriti.com/hacktricks" %}

√Ä un moment donn√©, j'ai eu besoin d'utiliser la solution propos√©e par le post ci-dessous mais les √©tapes sur [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) ne fonctionnaient plus sur kali moderne (2019v3).\
Quoi qu'il en soit, il est facile de les faire fonctionner.\
Vous avez juste besoin de t√©l√©charger hostapd-2.6 d'ici : [https://w1.fi/releases/](https://w1.fi/releases/) et avant de compiler √† nouveau hostapd-wpe, installez : `apt-get install libssl1.0-dev`

### Analyse et Exploitation de EAP-TLS dans les R√©seaux Sans Fil

#### Contexte : EAP-TLS dans les R√©seaux Sans Fil
EAP-TLS est un protocole de s√©curit√© fournissant une authentification mutuelle entre le client et le serveur √† l'aide de certificats. La connexion est √©tablie uniquement si le client et le serveur authentifient les certificats de l'autre.

#### D√©fi Rencontr√©
Lors d'une √©valuation, une erreur int√©ressante a √©t√© rencontr√©e lors de l'utilisation de l'outil `hostapd-wpe`. L'outil a rejet√© la connexion du client en raison du certificat du client sign√© par une Autorit√© de Certification (CA) inconnue. Cela indiquait que le client faisait confiance au certificat du faux serveur, pointant vers des configurations de s√©curit√© laxistes du c√¥t√© client.

#### Objectif : Mise en Place d'une Attaque Man-in-the-Middle (MiTM)
L'objectif √©tait de modifier l'outil pour accepter n'importe quel certificat client. Cela permettrait d'√©tablir une connexion avec le r√©seau sans fil malveillant et de permettre une attaque MiTM, capturant potentiellement des identifiants en clair ou d'autres donn√©es sensibles.

#### Solution : Modification de `hostapd-wpe`
L'analyse du code source de `hostapd-wpe` a r√©v√©l√© que la validation du certificat client √©tait contr√¥l√©e par un param√®tre (`verify_peer`) dans la fonction OpenSSL `SSL_set_verify`. En changeant la valeur de ce param√®tre de 1 (valider) √† 0 (ne pas valider), l'outil a √©t√© modifi√© pour accepter n'importe quel certificat client.

#### Ex√©cution de l'Attaque
1. **V√©rification de l'Environnement :** Utilisez `airodump-ng` pour surveiller les r√©seaux sans fil et identifier les cibles.
2. **Configuration du Faux PA :** Ex√©cutez le `hostapd-wpe` modifi√© pour cr√©er un Point d'Acc√®s (PA) factice imitant le r√©seau cible.
3. **Personnalisation du Portail Captif :** Personnalisez la page de connexion du portail captif pour qu'elle paraisse l√©gitime et famili√®re √† l'utilisateur cible.
4. **Attaque de D√©sauthentification :** Optionnellement, effectuez une attaque de d√©sauthentification pour d√©connecter le client du r√©seau l√©gitime et le connecter au faux PA.
5. **Capture des Identifiants :** Une fois que le client se connecte au faux PA et interagit avec le portail captif, ses identifiants sont captur√©s.

#### Observations de l'Attaque
- Sur les machines Windows, le syst√®me pourrait se connecter automatiquement au faux PA, pr√©sentant le portail captif lors d'une tentative de navigation web.
- Sur un iPhone, l'utilisateur pourrait √™tre invit√© √† accepter un nouveau certificat, puis pr√©sent√© avec le portail captif.

#### Conclusion
Bien que EAP-TLS soit consid√©r√© comme s√©curis√©, son efficacit√© d√©pend fortement de la configuration correcte et du comportement prudent des utilisateurs finaux. Des appareils mal configur√©s ou des utilisateurs insouciants acceptant des certificats frauduleux peuvent compromettre la s√©curit√© d'un r√©seau prot√©g√© par EAP-TLS.

Pour plus de d√©tails, consultez https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

# R√©f√©rences
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Conseil pour les bug bounties** : **inscrivez-vous** sur **Intigriti**, une plateforme premium de **bug bounties cr√©√©e par des hackers, pour des hackers** ! Rejoignez-nous sur [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) aujourd'hui, et commencez √† gagner des bounties jusqu'√† **100 000 $** !

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PRs aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
