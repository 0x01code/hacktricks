# Evil Twin EAP-TLS

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**repository di HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Suggerimento per bug bounty**: **iscriviti** a **Intigriti**, una piattaforma premium per **bug bounty creata da hacker, per hacker**! Unisciti a noi su [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) oggi stesso e inizia a guadagnare ricompense fino a **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

A un certo punto ho avuto bisogno di utilizzare la soluzione proposta nel post sottostante, ma i passaggi in [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) non funzionavano pi√π in kali moderno (2019v3).\
Comunque, √® facile farli funzionare.\
√à sufficiente scaricare hostapd-2.6 da qui: [https://w1.fi/releases/](https://w1.fi/releases/) e prima di compilare nuovamente hostapd-wpe installare: `apt-get install libssl1.0-dev`

### Analisi ed Esploito di EAP-TLS nelle Reti Wireless

#### Contesto: EAP-TLS nelle Reti Wireless
EAP-TLS √® un protocollo di sicurezza che fornisce autenticazione reciproca tra client e server utilizzando certificati. La connessione viene stabilita solo se sia il client che il server autenticano i certificati reciproci.

#### Sfida Riscontrata
Durante una valutazione, √® stato riscontrato un errore interessante nell'utilizzo dello strumento `hostapd-wpe`. Lo strumento ha rifiutato la connessione del client a causa del certificato del client firmato da un'autorit√† di certificazione (CA) sconosciuta. Ci√≤ indicava che il client non si fidava del certificato del server falso, evidenziando una configurazione di sicurezza poco rigorosa sul lato del client.

#### Obiettivo: Configurare un Attacco Man-in-the-Middle (MiTM)
L'obiettivo era modificare lo strumento per accettare qualsiasi certificato del client. Ci√≤ avrebbe consentito di stabilire una connessione con la rete wireless malevola e abilitare un attacco MiTM, potenzialmente catturando credenziali in chiaro o altri dati sensibili.

#### Soluzione: Modifica di `hostapd-wpe`
L'analisi del codice sorgente di `hostapd-wpe` ha rivelato che la validazione del certificato del client era controllata da un parametro (`verify_peer`) nella funzione OpenSSL `SSL_set_verify`. Cambiando il valore di questo parametro da 1 (valida) a 0 (non valida), lo strumento √® stato modificato per accettare qualsiasi certificato del client.

#### Esecuzione dell'Attacco
1. **Controllo dell'Ambiente:** Utilizzare `airodump-ng` per monitorare le reti wireless e identificare i target.
2. **Creazione di un AP Falso:** Eseguire `hostapd-wpe` modificato per creare un falso Access Point (AP) che imiti la rete target.
3. **Personalizzazione del Captive Portal:** Personalizzare la pagina di accesso del captive portal in modo che appaia legittima e familiare all'utente target.
4. **Attacco di De-autenticazione:** Opzionalmente, eseguire un attacco di de-autenticazione per disconnettere il client dalla rete legittima e connetterlo al falso AP.
5. **Cattura delle Credenziali:** Una volta che il client si connette al falso AP e interagisce con il captive portal, le sue credenziali vengono catturate.

#### Osservazioni dall'Attacco
- Sui computer Windows, il sistema potrebbe connettersi automaticamente al falso AP, presentando il captive portal quando viene tentata la navigazione web.
- Su un iPhone, all'utente potrebbe essere richiesto di accettare un nuovo certificato e quindi visualizzare il captive portal.

#### Conclusione
Sebbene EAP-TLS sia considerato sicuro, la sua efficacia dipende fortemente dalla corretta configurazione e dal comportamento cauto degli utenti finali. Dispositivi mal configurati o utenti ignari che accettano certificati falsi possono compromettere la sicurezza di una rete protetta da EAP-TLS.

Per ulteriori dettagli, consulta https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Riferimenti
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Suggerimento per bug bounty**: **iscriviti** a **Intigriti**, una piattaforma premium per **bug bounty creata da hacker, per hacker**! Unisciti a noi su [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) oggi stesso e inizia a guadagnare ricompense fino a **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**repository di HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>
