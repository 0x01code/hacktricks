# Evil Twin EAP-TLS

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka mwanzo hadi kuwa bingwa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa kwenye HackTricks** au **kupakua HackTricks kwa muundo wa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwenye** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Mshauri wa tuzo ya mdudu**: **Jisajili** kwa **Intigriti**, jukwaa la malipo ya tuzo la premium lililoanzishwa na wadukuzi, kwa wadukuzi! Jiunge nasi kwenye [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) leo, na anza kupata tuzo hadi **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

Kwa wakati fulani nilihitaji kutumia suluhisho lililopendekezwa na chapisho hapo chini lakini hatua zilizopo kwenye [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) hazikuwa zinafanya kazi kwenye kali ya kisasa (2019v3).\
Hata hivyo, ni rahisi kuzifanya zifanye kazi.\
Unahitaji tu kupakua hostapd-2.6 kutoka hapa: [https://w1.fi/releases/](https://w1.fi/releases/) na kabla ya kusanikisha tena hostapd-wpe, sakinisha: `apt-get install libssl1.0-dev`

### Uchambuzi na Udukuzi wa EAP-TLS kwenye Mitandao ya Wireless

#### Msingi: EAP-TLS kwenye Mitandao ya Wireless
EAP-TLS ni itifaki ya usalama inayotoa uwakili wa pande zote kati ya mteja na seva kwa kutumia vyeti. Uunganisho unafanyika tu ikiwa mteja na seva wanathibitisha vyeti vya kila mmoja.

#### Changamoto Iliyokutwa
Wakati wa tathmini, kosa la kuvutia lilikutwa wakati wa kutumia zana ya `hostapd-wpe`. Zana ilikataa uunganisho wa mteja kwa sababu cheti cha mteja kilikuwa kimesainiwa na Mamlaka ya Cheti (CA) isiyojulikana. Hii ilionyesha kuwa mteja hakutegemea cheti bandia cha seva, ikionyesha mipangilio ya usalama dhaifu kwenye upande wa mteja.

#### Lengo: Kuweka Shambulio la Man-in-the-Middle (MiTM)
Lengo lilikuwa kubadilisha zana ili kukubali cheti chochote cha mteja. Hii ingewezesha kuundwa kwa uhusiano na mtandao wa wireless wenye nia mbaya na kuwezesha shambulio la MiTM, ambalo linaweza kukamata nywila za maandishi wazi au data nyeti nyingine.

#### Suluhisho: Kubadilisha `hostapd-wpe`
Uchambuzi wa nambari chanzo ya `hostapd-wpe` ulifunua kuwa uthibitishaji wa cheti cha mteja ulidhibitiwa na parameter (`verify_peer`) katika kazi ya OpenSSL `SSL_set_verify`. Kwa kubadilisha thamani ya parameter hii kutoka 1 (thibitisha) hadi 0 (usithibitishe), zana ilifanywa kukubali cheti chochote cha mteja.

#### Kutekeleza Shambulio
1. **Uchunguzi wa Mazingira:** Tumia `airodump-ng` kufuatilia mitandao ya wireless na kutambua malengo.
2. **Sanidi AP Bandia:** Chalisha `hostapd-wpe` iliyobadilishwa ili kuunda Kituo cha Upatikanaji (AP) bandia kinachofanana na mtandao wa lengo.
3. **Ubinafsishaji wa Portal ya Kuteka:** Geuza ukurasa wa kuingia wa portal ya kuteka ili uonekane halali na wa kawaida kwa mtumiaji wa lengo.
4. **Shambulio la Kukataa Huduma:** Hiari, fanya shambulio la kukataa huduma ili kumtoa mteja kwenye mtandao halali na kumwunganisha kwenye AP bandia.
5. **Kukamata Nywila:** Mara tu mteja anapounganisha kwenye AP bandia na kuingiliana na portal ya kuteka, nywila zao zinakamatwa.

#### Uchunguzi kutoka kwenye Shambulio
- Kwenye mashine za Windows, mfumo unaweza kuunganisha moja kwa moja kwenye AP bandia, ukionyesha portal ya kuteka wakati wa kujaribu kuvinjari wavuti.
- Kwenye iPhone, mtumiaji anaweza kuombwa kukubali cheti kipya na kisha kuonyeshwa na portal ya kuteka.

#### Hitimisho
Ingawa EAP-TLS inachukuliwa kuwa salama, ufanisi wake unategemea sana mipangilio sahihi na tabia ya tahadhari ya watumiaji wa mwisho. Vifaa vilivyowekwa vibaya au watumiaji wasio na shaka wanaokubali vyeti bandia wanaweza kudhoofisha usalama wa mtandao uliolindwa na EAP-TLS.

Kwa maelezo zaidi angalia https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Marejeo
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Mshauri wa tuzo ya mdudu**: **Jisajili** kwa **Intigriti**, jukwaa la malipo ya tuzo la premium lililoanzishwa na wadukuzi, kwa wadukuzi! Jiunge nasi kwenye [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) leo, na anza kupata tuzo hadi **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka mwanzo hadi kuwa bingwa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa kwenye HackTricks** au **kupakua HackTricks kwa muundo wa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwenye** [**HackTricks**](https://
