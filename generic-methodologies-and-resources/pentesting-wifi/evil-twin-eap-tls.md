# Bose Tweeling EAP-TLS

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty wenk**: **teken aan** vir **Intigriti**, 'n premium **bug bounty-platform wat deur hackers vir hackers geskep is**! Sluit vandag by ons aan by [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks), en begin om belonings tot **$100,000** te verdien!

{% embed url="https://go.intigriti.com/hacktricks" %}

Op 'n stadium moes ek die voorgestelde oplossing deur die onderstaande pos gebruik, maar die stappe in [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) het nie meer gewerk in moderne kali (2019v3) nie.\
In elk geval is dit maklik om hulle te laat werk.\
Jy hoef net die hostapd-2.6 van hier af te laai: [https://w1.fi/releases/](https://w1.fi/releases/) en voordat jy weer hostapd-wpe installeer, voer die volgende bevel uit: `apt-get install libssl1.0-dev`

### Analiseer en Exploiteer EAP-TLS in Draadlose Netwerke

#### Agtergrond: EAP-TLS in Draadlose Netwerke
EAP-TLS is 'n sekuriteitsprotokol wat wederkerige outentifikasie tussen klient en bediener bied deur middel van sertifikate. Die verbinding word slegs tot stand gebring as beide die klient en die bediener mekaar se sertifikate outentifiseer.

#### Uitdaging Te√´gekom
Tydens 'n assessering is 'n interessante fout te√´gekom toe die `hostapd-wpe`-instrument gebruik is. Die instrument het die klient se verbinding afgekeur omdat die klient se sertifikaat deur 'n onbekende Sertifikaatowerheid (CA) onderteken is. Dit dui daarop dat die klient die vals bediener se sertifikaat vertrou het, wat wys op lakse sekuriteitskonfigurasies aan die klientkant.

#### Doelwit: Opstel van 'n Man-in-die-Middel (MiTM) Aanval
Die doel was om die instrument te wysig om enige klient-sertifikaat te aanvaar. Dit sou die totstandbrenging van 'n verbinding met die kwaadwillige draadlose netwerk moontlik maak en 'n MiTM-aanval moontlik maak, wat moontlik platte tekslegitimasiebewyse of ander sensitiewe data kan vasvang.

#### Oplossing: Wysiging van `hostapd-wpe`
'n Ontleding van die bronkode van `hostapd-wpe` het aan die lig gebring dat die outentifikasie van die klient-sertifikaat beheer word deur 'n parameter (`verify_peer`) in die OpenSSL-funksie `SSL_set_verify`. Deur hierdie parameter se waarde te verander van 1 (valideer) na 0 (moenie valideer nie), is die instrument gemaak om enige klient-sertifikaat te aanvaar.

#### Uitvoering van die Aanval
1. **Omgewingskontrole:** Gebruik `airodump-ng` om draadlose netwerke te monitor en teikens te identifiseer.
2. **Stel Valse AP op:** Voer die gewysigde `hostapd-wpe` uit om 'n valse Toegangspunt (AP) te skep wat die teikennetwerk naboots.
3. **Aangepaste Vangnetportaal:** Pas die aantekenblad van die vangnetportaal aan om legitiem en bekend aan die teiken-gebruiker te lyk.
4. **De-authentifikasie-aanval:** Opsioneel, voer 'n de-authentifikasie-aanval uit om die klient van die regmatige netwerk af te koppel en hulle aan die valse AP te koppel.
5. **Vasvang van Legitimasiebewyse:** Sodra die klient aan die valse AP koppel en met die vangnetportaal interaksie het, word hul legitimasiebewyse vasgevang.

#### Waarnemings van die Aanval
- Op Windows-masjiene kan die stelsel outomaties aan die valse AP koppel en die vangnetportaal vertoon wanneer webnavigasie probeer word.
- Op 'n iPhone kan die gebruiker versoek word om 'n nuwe sertifikaat te aanvaar en dan die vangnetportaal vertoon te word.

#### Gevolgtrekking
Alhoewel EAP-TLS as veilig beskou word, hang sy doeltreffendheid sterk af van die korrekte konfigurasie en versigtige gedrag van eindgebruikers. Verkeerd gekonfigureerde toestelle of argeloos gebruikers wat vals sertifikate aanvaar, kan die sekuriteit van 'n EAP-TLS-beskermde netwerk ondermyn.

Vir verdere besonderhede, sien https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Verwysings
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty wenk**: **teken aan** vir **Intigriti**, 'n premium **bug bounty-platform wat deur hackers vir hackers geskep is**! Sluit vandag by ons aan by [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks), en begin om belonings tot **$100,000** te verdien!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>
