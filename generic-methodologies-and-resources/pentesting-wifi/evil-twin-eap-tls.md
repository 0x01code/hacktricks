# Kötü İkiz EAP-TLS

<details>

<summary><strong>AWS hackleme becerilerini sıfırdan kahraman seviyesine öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına **PR göndererek** paylaşın.

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Ödül avı ipucu**: **Hackerlar tarafından oluşturulan premium bir ödül avı platformu olan Intigriti'ye** kaydolun! Bugün [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresine katılın ve **100.000 $'a kadar ödüller kazanmaya başlayın**!

{% embed url="https://go.intigriti.com/hacktricks" %}

Bir noktada, aşağıdaki gönderide önerilen çözümü kullanmam gerekiyordu, ancak [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) adımları modern kali (2019v3) üzerinde çalışmıyordu.\
Neyse ki, onları çalıştırmak kolaydır.\
Sadece buradan hostapd-2.6'yı indirmeniz gerekiyor: [https://w1.fi/releases/](https://w1.fi/releases/) ve hostapd-wpe'yi yeniden derlemeden önce `apt-get install libssl1.0-dev` komutunu çalıştırın.

### Kablosuz Ağlarda EAP-TLS'nin Analizi ve Sömürülmesi

#### Arka Plan: Kablosuz Ağlarda EAP-TLS
EAP-TLS, sertifikalar kullanarak istemci ve sunucu arasında karşılıklı kimlik doğrulama sağlayan bir güvenlik protokolüdür. Bağlantı, istemci ve sunucunun birbirlerinin sertifikalarını doğrulaması durumunda yalnızca kurulur.

#### Karşılaşılan Zorluk
Bir değerlendirme sırasında, `hostapd-wpe` aracını kullanırken ilginç bir hatayla karşılaşıldı. Aracın, istemcinin sertifikasının bilinmeyen bir Sertifika Yetkilisi (CA) tarafından imzalanmış olması nedeniyle istemcinin bağlantısını reddettiği belirlendi. Bu durum, istemcinin sahte sunucunun sertifikasına güvendiğini göstererek istemci tarafındaki gevşek güvenlik yapılandırmalarını işaret etti.

#### Amaç: Orta Adam Saldırısı (MiTM) Kurulumu
Hedef, aracı herhangi bir istemci sertifikasını kabul edecek şekilde değiştirmekti. Bu, kötü niyetli kablosuz ağıyla bağlantı kurmayı ve MiTM saldırısı yapmayı, potansiyel olarak düz metin kimlik bilgilerini veya diğer hassas verileri ele geçirmeyi mümkün kılacaktı.

#### Çözüm: `hostapd-wpe`'yi Değiştirmek
`hostapd-wpe`'nin kaynak kodunun analizi, istemci sertifikası doğrulamasının OpenSSL işlevi `SSL_set_verify` içindeki bir parametre (`verify_peer`) tarafından kontrol edildiğini ortaya çıkardı. Bu parametrenin değerini 1 (doğrula) yerine 0 (doğrulama yapma) olarak değiştirerek, aracın herhangi bir istemci sertifikasını kabul etmesi sağlandı.

#### Saldırının Yürütülmesi
1. **Ortam Kontrolü:** Kablosuz ağları izlemek ve hedefleri belirlemek için `airodump-ng` kullanın.
2. **Sahte AP Kurulumu:** Değiştirilmiş `hostapd-wpe`'yi çalıştırarak hedef ağı taklit eden sahte bir Erişim Noktası (AP) oluşturun.
3. **Captive Portal Özelleştirme:** Hedef kullanıcıya gerçek ve tanıdık görünen bir captive portal giriş sayfası özelleştirin.
4. **De-auth Saldırısı:** İsteğe bağlı olarak, istemciyi meşru ağdan koparıp sahte AP'ye bağlamak için bir de-auth saldırısı gerçekleştirin.
5. **Kimlik Bilgilerini Yakalama:** İstemci sahte AP'ye bağlandığında ve captive portal ile etkileşime geçtiğinde, kimlik bilgileri yakalanır.

#### Saldırıdan Gözlemler
- Windows makinelerinde, web gezintisi denendiğinde sahte AP'ye otomatik olarak bağlanabilir ve captive portal sunulabilir.
- Bir iPhone'da, kullanıcı yeni bir sertifikayı kabul etmesi istenebilir ve ardından captive portal sunulabilir.

#### Sonuç
EAP-TLS güvenli kabul edilse de, etkinliği doğru yapılandırmaya ve dikkatli kullanıcı davranışına bağlıdır. Yanlış yapılandırılmış cihazlar veya şüphelenmeyen kullanıcılar tarafından kabul edilen sahte sertifikalar, EAP-TLS korumalı bir ağın güvenliğini zayıflatabilir.

Daha fazla ayrıntı için https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/ adresini kontrol edin.

## Referanslar
* [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Ödül avı ipucu**: **Hackerlar tarafından oluşturulan premium bir ödül avı platformu olan Intigriti'ye** kaydolun! Bugün [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) adresine katılın ve **100.000 $'a kadar ödüller kazanmaya başlayın**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>AWS hackleme becerilerini sıfırdan kahraman seviyesine öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)'ı **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlo
