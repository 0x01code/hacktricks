# Κακόβουλος Διπλός EAP-TLS

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Συμμετάσχετε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**Συμβουλή για bug bounty**: **εγγραφείτε** στο **Intigriti**, μια προηγμένη **πλατφόρμα bug bounty που δημιουργήθηκε από χάκερς, για χάκερς**! Γίνετε μέλος μας στο [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) σήμερα και αρχίστε να κερδίζετε αμοιβές έως και **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

Σε κάποιο σημείο χρειάστηκε να χρησιμοποιήσω την προτεινόμενη λύση από την παρακάτω ανάρτηση, αλλά τα βήματα στο [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) δεν λειτουργούσαν πλέον στο σύγχρονο kali (2019v3).\
Παρόλα αυτά, είναι εύκολο να τα κάνετε να λειτουργήσουν.\
Χρειάζεται μόνο να κατεβάσετε το hostapd-2.6 από εδώ: [https://w1.fi/releases/](https://w1.fi/releases/) και πριν εγκαταστήσετε ξανά το hostapd-wpe, εκτελέστε: `apt-get install libssl1.0-dev`

### Ανάλυση και Εκμετάλλευση του EAP-TLS σε Ασύρματα Δίκτυα

#### Υπόβαθρο: EAP-TLS σε Ασύρματα Δίκτυα
Το EAP-TLS είναι ένα πρωτόκολλο ασφαλείας που παρέχει αμοιβαία πιστοποίηση μεταξύ πελάτη και διακομιστή χρησιμοποιώντας πιστοποιητικά. Η σύνδεση διατηρείται μόνο εάν τόσο ο πελάτης όσο και ο διακομιστής επαληθεύουν τα πιστοποιητικά ο ένας του άλλου.

#### Πρόκληση που Αντιμετωπίστηκε
Κατά τη διάρκεια μιας αξιολόγησης, συναντήθηκε ένα ενδιαφέρον σφάλμα κατά τη χρήση του εργαλείου `hostapd-wpe`. Το εργαλείο απέρριπτε τη σύνδεση του πελάτη επειδή το πιστοποιητικό του πελάτη ήταν υπογεγραμμένο από μια άγνωστη Αρχή Πιστοποίησης (CA). Αυτό υποδείκνυε ότι ο πελάτης δεν εμπιστευόταν το πλαστό πιστοποιητικό του διακομιστή, δείχνοντας ανεπαρκείς ρυθμίσεις ασφαλείας στην πλευρά του πελάτη.

#### Στόχος: Δημιουργία Επίθεσης Man-in-the-Middle (MiTM)
Ο στόχος ήταν να τροποποιηθεί το εργαλείο ώστε να αποδέχεται οποιοδήποτε πιστοποιητικό πελάτη. Αυτό θα επέτρεπε τη δημιουργία μιας σύνδεσης με το κακόβουλο ασύρματο δίκτυο και θα επέτρεπε μια επίθεση MiTM, με τη δυνατότητα καταγραφής απλού κειμένου διαπιστευτήρια ή άλλα ευαίσθητα δεδομένα.

#### Λύση: Τροποποίηση του `hostapd-wpe`
Η ανάλυση του πηγαίου κώδικα του `hostapd-wpe` έδειξε ότι η επαλήθευση του πιστοποιητικού του πελάτη ελέγχεται από ένα παράμετρο (`verify_peer`) στη συνάρ
