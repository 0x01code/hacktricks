# 渗透测试方法论

<details>

<summary><strong>通过</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>从零开始学习AWS黑客攻击成为英雄！</strong></summary>

支持HackTricks的其他方式：

* 如果您想在**HackTricks中看到您的公司广告**或**下载HackTricks的PDF版本**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS & HackTricks商品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs系列**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram群组**](https://t.me/peass) 或在 **Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。**

</details>

<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

\
**Bug bounty小贴士**：**注册** **Intigriti**，一个由黑客创建的高级**bug赏金平台**！立即加入我们 [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)，开始赚取高达**$100,000**的赏金！

{% embed url="https://go.intigriti.com/hacktricks" %}

## 渗透测试方法论

<figure><img src="../.gitbook/assets/HACKTRICKS-logo.svg" alt=""><figcaption></figcaption></figure>

_Hacktricks标志由_ [_@ppiernacho_](https://www.instagram.com/ppieranacho/) _设计。_

### 0- 物理攻击

您是否拥有想要攻击的机器的**物理访问权限**？您应该阅读一些关于[**物理攻击的技巧**](../physical-attacks/physical-attacks.md)以及其他关于[**逃离GUI应用程序**](../physical-attacks/escaping-from-gui-applications/)的内容。

### 1 - [发现网络内的主机](pentesting-network/#discovering-hosts)/ [发现公司的资产](external-recon-methodology/)

**根据**您执行的**测试是内部测试还是外部测试**，您可能对发现**公司网络内的主机**（内部测试）或**在互联网上发现公司的资产**（外部测试）感兴趣。

{% hint style="info" %}
请注意，如果您正在进行外部测试，一旦您设法获得对公司内部网络的访问权限，您应该重新开始本指南。
{% endhint %}

### **2-** [**与网络玩乐**](pentesting-network/) **（内部）**

**此部分仅适用于您正在进行内部测试。**\
在攻击主机之前，您可能更愿意**从网络中窃取一些凭证**或**嗅探**一些**数据**，以**被动/主动（MitM）**地了解您可以在网络内找到什么。您可以阅读[**渗透测试网络**](pentesting-network/#sniffing)。

### 3- [端口扫描 - 服务发现](pentesting-network/#scanning-hosts)

当**寻找主机中的漏洞**时，首先要知道哪些**服务在哪些端口上运行**。让我们看看[**扫描主机端口的基本工具**](pentesting-network/#scanning-hosts)。

### **4-** [搜索服务版本漏洞](search-exploits.md)

一旦您知道哪些服务正在运行，也许还知道它们的版本，您必须**搜索已知的漏洞**。也许您运气好，有一个漏洞可以给您一个shell...

### **5-** 渗透测试服务

如果没有任何运行服务的花哨漏洞，您应该寻找**每个运行服务的常见配置错误**。

**在本书中，您将找到渗透测试最常见服务的指南**（以及一些不那么常见的服务）。请在左侧索引中搜索**_**渗透测试**_**部分**（服务按其默认端口排序）。

**我想特别提到** [**渗透测试Web**](../network-services-pentesting/pentesting-web/) **部分（因为它是最广泛的部分）。**\
此外，关于如何[**找到软件中的已知漏洞**](search-exploits.md)的小指南可以在这里找到。

**如果您的服务不在索引中，请在Google中搜索其他教程，并告诉我是否希望我添加它。**如果您在Google中**找不到任何内容**，请执行您自己的**盲目渗透测试**，您可以从**连接到服务，对其进行模糊测试并阅读响应**（如果有的话）开始。

#### 5.1 自动化工具

还有几种工具可以执行**自动化漏洞评估**。**我建议您尝试** [**Legion**](https://github.com/carlospolop/legion)**，这是我创建的工具，它基于您可以在本书中找到的关于渗透测试服务的笔记。**

#### **5.2 暴力破解服务**

在某些情况下，**暴力破解**可能对**攻破服务**有用。[**在这里找到不同服务暴力破解的备忘单**](brute-force.md)**。**

<img src="../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty小贴士**：**注册** **Intigriti**，一个由黑客创建的高级**bug赏金平台**！立即加入我们 [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)，开始赚取高达**$100,000**的赏金！\\

{% embed url="https://go.intigriti.com/hacktricks" %}

### 6- [网络钓鱼](phishing-methodology/)

如果到目前为止您还没有发现任何有趣的漏洞，您**可能需要尝试一些网络钓鱼**以便进入网络。您可以在[这里](phishing-methodology/)阅读我的网络钓鱼方法论：

### **7-** [**获取Shell**](shells/)

不知何故，您应该已经找到了**在受害者身上执行代码的某种方式**。然后，[系统内部您可以使用的可能工具列表以获取反向Shell将非常有用](shells/)。

特别是在Windows中，您可能需要一些帮助来**避开杀毒软件**：[**查看此页面**](../windows-hardening/av-bypass.md)**。**\\

### 8- 内部

如果您在使用shell时遇到问题，您可以在这里找到一个小型**对渗透测试人员最有用的命令汇编**：

* [**Linux**](../linux-hardening/useful-linux-commands/)
* [**Windows (CMD)**](../windows-hardening/basic-cmd-for-pentesters.md)
* [**Windows (PS)**](../windows-hardening/basic-powershell-for-pentesters/)

### **9 -** [**数据泄露**](exfiltration.md)

您可能需要**从受害者那里提取一些数据**，甚至**引入一些东西**（如提权脚本）。**这里有一个** [**关于您可以使用的常见工具的帖子**](exfiltration.md)**。**

### **10- 权限提升**

#### **10.1- 本地权限提升**

如果您在盒子内**不是root/Administrator**，您应该找到一种**提升权限的方法**。\
在这里，您可以找到一个**在** [**Linux**](../linux-hardening/privilege-escalation/) **和** [**Windows**](../windows-hardening/windows-local-privilege-escalation/) **中本地提升权限的指南**。\
您还应该查看这些页面，了解**Windows的工作原理**：

* [**认证、凭证、令牌权限和UAC**](../windows-hardening/authentication-credentials-uac-and-efs.md)
* [**NTLM如何工作**](../windows-hardening/ntlm/)
* [**如何在Windows中窃取凭证**](broken-reference/) 
* 一些关于[_**活动目录**_](../windows-hardening/active-directory-methodology/)的技巧

**不要忘记查看最佳工具，以列举Windows和Linux本地权限提升路径：** [**Suite PEAS**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite)

#### **10.2- 域权限提升**

在这里，您可以找到一个[**方法论，解释在活动目录中枚举、权限提升和持久化的最常见操作**](../windows-hardening/active-directory-methodology/)。即使这只是一个小节，这个过程在渗透测试/红队任务中可能是**极其微妙**的。

### 11 - POST

#### **11**.1 - 掠夺

检查您是否可以在主机内找到更多**密码**，或者您是否拥有**使用您的** **用户权限**访问其他机器的**权限**。\
在这里找到不同的方法来[**在Windows中转储密码**](broken-reference/)。

#### 11.2 - 持久性

**使用2到3种不同类型的持久性机制，这样您就不需要再次利用系统了。**\
**在这里，您可以找到一些** [**在活动目录上持久化的技巧**](../windows-hardening/active-directory-methodology/#persistence)**。**

TODO: 完成Windows & Linux持久性Post&#x20;

### 12 - 转发

通过**收集到的凭证**，您可能可以访问其他机器，或者您可能需要**发现并扫描新主机**（重新开始渗透测试方法论）在您的受害者连接的新网络内。\
在这种情况下，隧道可能是必要的。在这里，您可以找到[**一篇关于隧道的帖子**](tunneling-and-port-forwarding.md)。\
您绝对也应该查看关于[活动目录渗透测试方法论](../windows-hardening/active-directory-methodology/)的帖子。在那里，您将找到横向移动、权限提升和转储凭证的酷技巧。\
还要查看关于[**NTLM**](../windows-hardening/ntlm/)的页面，它可能对在Windows环境中转发非常有用。

### 更多

#### [Android应用程序](../mobile-pentesting/android-app-pentesting/)

#### **利用**

* [**基础Linux利用**](../exploiting/linux-exploiting-basic-esp/)
* [**基础Windows利用**](../exploiting/windows-exploiting-basic-guide-oscp-lvl.md)
* [**基础利用工具**](../exploiting/tools/)

#### [**基础Python**](python/)

#### **加密技巧**

* [**ECB**](../cryptography/electronic-code-book-ecb.md)
* [**CBC-MAC**](../cryptography/cipher-block-chaining-cbc-mac-priv.md)
* [**Padding Oracle**](../cryptography/padding-oracle-priv.md)

<img src="../.gitbook/assets/i3.png" alt="" data-size="original">\
**Bug bounty小贴士**：**注册** **Intigriti**，一个由黑客创建的高级**bug赏金平台**！立即加入我们 [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)，开始赚取高达**$100,000**的赏金！

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>通过</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>从零开始学习AWS黑客攻击成为英雄！</strong></summary>

支持HackTricks的其他方式：

* 如果您想在**HackTricks中看到您的公司广告**或**下载HackTricks的PDF版本**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS & HackTricks商品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs系列**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram群组**](https://t.me/peass) 或在 **Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。**

</details>
