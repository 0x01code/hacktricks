# ペネトレーションテスト方法論

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)でゼロからヒーローまでAWSハッキングを学ぶ</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**PEASSファミリー**](https://opensea.io/collection/the-peass-family)を発見する、私たちの独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクション
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に**参加する**か、[**テレグラムグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローする**。
* **HackTricks**のPRを提出して、あなたのハッキングのコツを共有する [**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) githubリポジトリ。

</details>

<figure><img src="../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

\
**バグバウンティのヒント**: **Intigriti**に**登録**して、ハッカーのために作られたプレミアムな**バグバウンティプラットフォーム**で学びましょう！今日[**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)に参加して、最大**$100,000**のバウンティを獲得し始めましょう！

{% embed url="https://go.intigriti.com/hacktricks" %}

## ペネトレーションテスト方法論

<figure><img src="../.gitbook/assets/HACKTRICKS-logo.svg" alt=""><figcaption></figcaption></figure>

_Hacktricksのロゴは_ [_@ppiernacho_](https://www.instagram.com/ppieranacho/) _によってデザインされました。_

### 0- 物理的攻撃

攻撃したいマシンに**物理的アクセス**はありますか？[**物理的攻撃に関するいくつかのコツ**](../physical-attacks/physical-attacks.md)と[**GUIアプリケーションからの脱出**](../physical-attacks/escaping-from-gui-applications/)について読むべきです。

### 1 - [ネットワーク内のホストの発見](pentesting-network/#discovering-hosts)/ [会社のアセットの発見](external-recon-methodology/)

**内部テストか外部テストかによって**、会社のネットワーク内の**ホストを見つける**（内部テスト）か、インターネット上の**会社のアセットを見つける**（外部テスト）に興味があるかもしれません。

{% hint style="info" %}
外部テストを実施している場合、会社の内部ネットワークへのアクセスを管理すると、このガイドを再開する必要があります。
{% endhint %}

### **2-** [**ネットワークで楽しむ**](pentesting-network/) **（内部）**

**このセクションは内部テストを実施している場合にのみ適用されます。**\
ホストを攻撃する前に、ネットワークから**いくつかの資格情報を盗む**か、**データを嗅ぐ**ことで、ネットワーク内で何が見つかるかを**受動的/能動的（MitM）**に学ぶことを好むかもしれません。[**ネットワークのペネトレーションテスト**](pentesting-network/#sniffing)を読むことができます。

### 3- [ポートスキャン - サービス発見](pentesting-network/#scanning-hosts)

ホストの脆弱性を探す最初のステップは、どのポートでどの**サービスが実行されているか**を知ることです。[**ホストのポートをスキャンする基本的なツール**](pentesting-network/#scanning-hosts)を見てみましょう。

### **4-** [サービスバージョンのエクスプロイトを探す](search-exploits.md)

実行中のサービスとそのバージョンを知ったら、**既知の脆弱性を探す**必要があります。運が良ければ、シェルを与えるエクスプロイトがあるかもしれません...

### **5-** サービスのペネトレーションテスト

実行中のサービスに対する派手なエクスプロイトがない場合は、各サービスの**一般的な誤設定を探す**べきです。

**この本の中には、最も一般的なサービスのペネトレーションテストガイドがあります**（それほど一般的ではないものも含まれています）。左のインデックスで**_ペネトレーションテスト_** **セクションを探してください**（サービスはデフォルトのポートで順番に並んでいます）。

**特に** [**ウェブのペネトレーションテスト**](../network-services-pentesting/pentesting-web/) **部分に特別な言及をしたいと思います（最も広範な部分です）。**\
また、[**既知のソフトウェアの脆弱性を見つける方法**](search-exploits.md)についての小さなガイドもここにあります。

**インデックス内にあなたのサービスがない場合は、Googleで他のチュートリアルを検索し、追加してほしい場合は私に知らせてください。** Googleで何も見つからない場合は、**自分自身のブラインドペネトレーションテストを実行してください**。サービスに接続し、ファジングして応答を読む（あれば）ことから始めることができます。

#### 5.1 自動ツール

また、**自動脆弱性評価を実行できるいくつかのツールがあります。** [**Legion**](https://github.com/carlospolop/legion)を試すことをお勧めします。これは私が作成したツールで、この本にあるサービスのペネトレーションテストに関するノートに基づいています。

#### **5.2 サービスのブルートフォース**

いくつかのシナリオでは、**ブルートフォース**がサービスを**侵害する**のに役立つかもしれません。[**異なるサービスのブルートフォースのチートシートをここで見つけてください**](brute-force.md)**。**

<img src="../.gitbook/assets/i3.png" alt="" data-size="original">\
**バグバウンティのヒント**: **Intigriti**に**登録**して、ハッカーのために作られたプレミアムな**バグバウンティプラットフォーム**で学びましょう！今日[**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks)に参加して、最大**$100,000**のバウンティを獲得し始めましょう！

{% embed url="https://go.intigriti.com/hacktricks" %}

### 6- [フィッシング](phishing-methodology/)

この時点で興味深い脆弱性が見つからない場合は、ネットワーク内に入るために**フィッシングを試みる**必要があるかもしれません。私のフィッシング方法論は[こちら](phishing-methodology/)で読むことができます：

### **7-** [**シェルの取得**](shells/)

何らかの方法で、被害者のシステムで**コードを実行する方法を見つける**べきです。その後、[システム内でリバースシェルを取得するために使用できる可能性のあるツールのリストが非常に役立ちます](shells/)。

特にWindowsでは、**アンチウイルスを回避するのに助けが必要になるかもしれません**：[**このページをチェックしてください**](../windows-hardening/av-bypass.md)**。**\\

### 8- 内部

シェルに問題がある場合は、ペネトレーションテスターにとって最も役立つ**コマンドの小さなコンパイル**をここで見つけることができます：

* [**Linux**](../linux-hardening/useful-linux-commands/)
* [**Windows (CMD)**](../windows-hardening/basic-cmd-for-pentesters.md)
* [**Windows (PS)**](../windows-hardening/basic-powershell-for-pentesters/)

### **9 -** [**エクスフィルトレーション**](exfiltration.md)

おそらく、被害者から**いくつかのデータを抽出する**必要があるでしょう、または**何かを導入する**（特権昇格スクリプトのような）必要があるかもしれません。**これらの目的で使用できる一般的なツールについての** [**投稿はこちら**](exfiltration.md)**。**

### **10- 特権昇格**

#### **10.1- ローカルPrivesc**

ボックス内で**root/Administratorでない**場合は、**特権を昇格する方法を見つける**べきです。\
ここでは、[**Linux**](../linux-hardening/privilege-escalation/) **および** [**Windows**](../windows-hardening/windows-local-privilege-escalation/) **でローカルに特権を昇格するためのガイドを見つけることができます。**\
**Windowsの仕組み**についてのこのページもチェックするべきです：

* [**認証、資格情報、トークン権限、およびUAC**](../windows-hardening/authentication-credentials-uac-and-efs.md)
* [**NTLMの仕組み**](../windows-hardening/ntlm/)
* Windowsで[**資格情報を盗む方法**](broken-reference/)
* [_**アクティブディレクトリ**_](../windows-hardening/active-directory-methodology/)に関するいくつかのコツ

**WindowsとLinuxのローカル特権昇格パスを列挙するための最良のツールをチェックすることを忘れないでください：** [**Suite PEAS**](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite)

#### **10.2- ドメインPrivesc**

ここでは、[**アクティブディレクトリで最も一般的なアクションを列挙し、特権を昇格させ、永続化する方法論**](../windows-hardening/active-directory-methodology/)を見つけることができます。これは単なるセクションのサブセクションですが、このプロセスはペネトレーションテスト/レッドチームの割り当てで**非常に繊細**になる可能性があります。

### 11 - POST

#### **11**.1 - ルーティング

ホスト内で**さらに多くのパスワード**を見つけることができるか、または**ユーザー**の**特権**で**他のマシンにアクセス**できるかどうかを確認してください。\
[**Windowsでパスワードをダンプするさまざまな方法**](broken-reference/)をここで見つけることができます。

#### 11.2 - 永続性

**システムを再びエクスプロイトする必要がないように、2つまたは3つの異なるタイプの永続性メカニズムを使用してください。**\
**アクティブディレクトリでのいくつかの永続性のコツはこちらで見つけることができます** [**アクティブディレクトリでの永続性**](../windows-hardening/active-directory-methodology/#persistence)**。**

TODO: Windows & Linuxで永続性の投稿を完了する&#x20;

### 12 - ピボット

**収集した資格情報**を使用して、他のマシンにアクセスできるかもしれません。または、被害者が接続されている新しいネットワーク内で**新しいホストを発見してスキャンする**必要があるかもしれません（ペネトレーションテスト方法論を再開）。\
この場合、トンネリングが必要になるかもしれません。[**トンネリングについて話す投稿**](tunneling-and-port-forwarding.md)をここで見つけることができます。\
[アクティブディレクトリのペネトレーションテスト方法論](../windows-hardening/active-directory-methodology/)についての投稿も確認する必要があります。そこでは、横方向の移動、特権の昇格、および資格情報のダンプに関するクールなコツを見つけることができます。\
また、[**NTLM**](../windows-hardening/ntlm/)のページもチェックしてください。Windows環境でピボットするのに
