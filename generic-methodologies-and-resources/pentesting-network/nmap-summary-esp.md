<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ会社**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**最新バージョンのPEASSを入手したり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>
```text
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
**-iL** リスト\_IPs

**-iR** 数字 --&gt; ランダムなIPアドレスの数。**--exclude &lt;Ips&gt;** または **--excludefile &lt;fichero&gt;** で除外するIPアドレスを指定できる。

**ホストの発見:**

/24 マスクを使用できる

**-sL**: 非侵入的で、DNSリクエストを送信して名前を解決することで、対象のリストを表示する。例えば、www.prueba.es/24 のすべてのIPアドレスが対象であるかどうかを確認するために使用できる。

デフォルトでは、Nmapは以下の発見フェーズを実行する: -PA80 -PS443 -PE -PP

**-Pn** ピン応答なし --&gt; **すべてがアクティブであることがわかっている場合に便利**（そうでない場合、時間の浪費になる可能性があるが、このオプションはアクティブでないと誤ったネガティブな結果を返すことがある）、発見フェーズをスキップする

**-sn** ポートスキャンなし: レコネサンスフェーズの後に**ポートをスキャンしない**。比較的ステルス性が高く、ネットワークの軽微なリコネサンスが可能。特権を持つ場合、80にACK \(-PA\)、443にSYN \(-PS\)、エコーリクエストとタイムスタンプリクエストを送信し、特権を持たない場合は常に完全な接続を行う。ターゲットがネットワーク内の場合、ARP \(-PR\) のみを使用する。他のオプションと組み合わせて使用する場合、他のオプションのパケットのみが送信される。

**-PR** ARP Ping: ネットワーク内のホストをスキャンする場合にデフォルトで使用される。pingよりも高速。ARPパケットを使用しない場合は、--send-ipを使用する必要がある。

**-PS&lt;ports&gt;** SYN: SYNパケットを送信し、SYN/ACKで応答があればオープン（接続を終了しないようにRSTを送信）、RSTで応答があればクローズ、応答がなければ到達不能。特権がない場合は自動的に完全な接続が使用される。ポートが指定されていない場合、デフォルトで80に送信される。

**-PA&lt;ports&gt;** ACK: 前述のものと同様だが、ACKを使用する。両方を組み合わせることでより良い結果が得られる。

**-PU&lt;ports&gt;** UDP: 逆の目的で使用され、クローズされていると予想されるポートに送信される。一部のファイアウォールはTCP接続のみをチェックする。クローズされている場合はポート不可到達応答が返され、他のICMP応答が返されるか応答がない場合は到達不能として扱われる。

**-PE, -PP, -PM** ICMP PING: ターゲットがアクティブかどうかを確認するために送信される。echo replay、timestamp、addresmaskのPINGが送信される。

**-PY&lt;ports&gt;** SCTP: デフォルトでは80にSCTP INITパケットを送信し、INIT-ACK（オープン）またはABORT（クローズ）または何も応答しないかICMP到達不能（非アクティブ）で応答する。

-**PO&lt;protocols&gt;:** ヘッダにプロトコルを指定する。デフォルトでは1（ICMP）、2（IGMP）、4（Encap IP）が使用される。ICMP、IGMP、TCP（6）およびUDP（17）の場合、プロトコルのヘッダが送信され、それ以外の場合はIPヘッダのみが送信される。これにより、ヘッダの不正な形式によって、到達不能なプロトコルまたは同じプロトコルの応答が返されることで、ターゲットが起動しているかどうかを確認できる。

**-n** DNSなし

**-R** 常にDNS

**ポートスキャンのテクニック:**

**-sS** --&gt; 接続を完了しないため、トレースが残らない。使用できる場合は非常に良い。 \(特権が必要\) デフォルトで使用される。

**-sT** --&gt; 接続を完了するため、トレースが残るが、使用できる。特権なしの場合はデフォルトで使用される。

**-sU** --&gt; より遅い、UDP用。主に: DNS（53）、SNMP（161,162）、DHCP（67,68）、\(-sU53,161,162,67,68\): オープン（応答）、クローズ（ポート不可到達）、フィルタリング（他のICMP）、オープン/フィルタリング（なし）。オープン/フィルタリングの場合、-sVはnmapがサポートするバージョンのいずれかを検出するために多数のリクエストを送信し、実際の状態を検出できる。時間がかかる。

**-sY** --&gt; SCTPプロトコルは接続を確立しないため、レコードが残らない。-PYと同様に機能する。

**-sN,-sX,-sF** --&gt; Null、Fin、Xmas、いくつかのファイアウォールをバイパスして情報を取得できる。これらは、標準に準拠しているホストは、SYN、RST、ACKのフラグを持たないリクエストに対してすべてRSTで応答するという前提に基づいている: オープン/フィルタリング（なし）、クローズ（RST）、フィルタリング（ICMP不可到達）。Windows、Cisco、BSDI、OS/400では信頼性がないが、Unixでは信頼性がある。

**-sM Maimon scan:** FINとACKフラグを送信し、BSDに使用されるが、現在はすべてクローズとして返される。

**-sA, sW** --&gt; ACKとWindow、ファイアウォールを検出するために使用され、ポートがフィルタリングされているかどうかを確認する。-sWはオープン/クローズを区別することができる。オープンは異なるウィンドウ値でRSTで応答する: オープン（ウィンドウが0でないRST）、クローズ（ウィンドウが0のRST）、フィルタリング（ICMP不可到達またはなし）。すべてのホストがこのように機能するわけではないため、すべてがクローズされている場合は機能しないことを意味し、いくつかのオープンと少数のクローズが表示される場合は正常に機能していることを意味し、多
**-b&lt;server&gt;** FTPhost--&gt; 他のホストからホストをスキャンするために使用されます。これは、他のマシンのFTPに接続し、他のマシンのスキャンしたいポートにファイルを送信するように要求することで行われます。応答に基づいて、ポートが開いているかどうかを確認できます。\[&lt;username&gt;:&lt;password&gt;@\]&lt;server&gt;\[:&lt;port&gt;\] ほとんどのFTPサーバーではこれを許可しなくなっており、実用的な価値がほとんどありません。

**スキャンの中心化:**

**-p:** スキャンするポートを指定するために使用されます。65335を選択するには、**-p-**または**-p all**を使用します。 Nmapには、人気に基づいて内部的に分類されたポートがあります。デフォルトでは、主要な1000ポートを使用します。**-F**（高速スキャン）では、主要な100ポートを分析します。**--top-ports &lt;number&gt;**では、指定した数の主要なポート（1から65335まで）を分析します。ポートをランダムな順序でチェックするためには、**-r**を使用します。また、ポートを選択することもできます：20-30,80,443,1024- これは1024以降をチェックすることを意味します。また、プロトコルごとにポートをグループ化することもできます：U:53,T:21-25,80,139,S:9。また、nmapの人気のあるポートの範囲内で範囲を選択することもできます：-p \[-1024\]は、nmap-servicesに含まれるポートのうち1024までを分析します。**--port-ratio &lt;ratio&gt;**は、0から1の間の比率で最も一般的なポートを分析します。

**-sV** バージョンスキャン、強度を0から9まで調整できます。デフォルトは7です。

**--version-intensity &lt;number&gt;** 強度を調整します。より低い値では、最も可能性の高いプローブのみが送信されますが、すべてが送信されません。これにより、UDPスキャンの時間を大幅に短縮できます。

**-O** OSの検出

**--osscan-limit** ホストを正しくスキャンするには、少なくとも1つのポートが開いていて、もう1つが閉じている必要があります。この条件が満たされない場合、このオプションが設定されている場合、OSの予測を試みません（時間を節約します）。

**--osscan-guess** OSの検出が完璧でない場合、これによりより詳細な検出が行われます。

**スクリプト**

--script _&lt;filename&gt;_\|_&lt;category&gt;_\|_&lt;directory&gt;_\|_&lt;expression&gt;_\[,...\]

デフォルトのスクリプトを使用するには、-sCまたは--script=defaultを使用します。

利用可能なタイプは、auth、broadcast、default、discovery、dos、exploit、external、fuzzer、intrusive、malware、safe、version、およびvulnです。

* **Auth:** 利用可能なすべての認証スクリプトを実行します。
* **Default:** ツールのデフォルトの基本スクリプトを実行します。
* **Discovery:** ターゲットまたは被害者から情報を取得します。
* **External:** 外部リソースを使用するスクリプトです。
* **Intrusive:** 被害者またはターゲットに対して侵入的とされるスクリプトを使用します。
* **Malware:** 悪意のあるコードやバックドアによるオープンな接続をチェックします。
* **Safe:** 侵入的でないスクリプトを実行します。
* **Vuln:** 最も一般的な脆弱性を特定します。
* **All:** 使用可能なすべてのNSE拡張子を持つスクリプトを実行します。

スクリプトを検索するには：

**nmap --script-help="http-\*" -&gt; "http-"で始まるもの**

**nmap --script-help="not intrusive" -&gt; それ以外のすべて**

**nmap --script-help="default or safe" -&gt; どちらかまたは両方にあるもの**

**nmap --script-help="default and safe" --&gt; 両方にあるもの**

**nmap --script-help="\(default or safe or intrusive\) and not http-\*"**

--script-args _&lt;n1&gt;_=_&lt;v1&gt;_,_&lt;n2&gt;_={_&lt;n3&gt;_=_&lt;v3&gt;_},_&lt;n4&gt;_={_&lt;v4&gt;_,_&lt;v5&gt;_}

--script-args-file _&lt;filename&gt;_

--script-help _&lt;filename&gt;_\|_&lt;category&gt;_\|_&lt;directory&gt;_\|_&lt;expression&gt;_\|all\[,...\]

--script-trace ---&gt; スクリプトの進行状況に関する情報を表示します

--script-updatedb

**スクリプトを使用するには、単に次のように入力します：namp --script Script\_Name target** --&gt; スクリプトを指定すると、スクリプトとスキャナーの両方が実行されるため、スキャナーのオプションも指定できます。安全なスクリプトのみを実行するには、**"safe=1"**を追加できます。

**時間制御**

**Nmapは、秒、分、ミリ秒単位で時間を変更できます：--host-timeout arguments 900000ms, 900, 900s, and 15m all do the same thing.**

Nmapは、スキャンするホストの総数をグループに分割し、それらのグループをブロックごとに分析します。すべてのグループが分析されるまで、次のブロックには移動しません（ユーザーもブロックが分析されるまで更新を受け取りません）。これにより、Nmapは大きなグループを使用することが最適です。デフォルトでは、クラスCでは256を使用します。

**--min-hostgroup** _**&lt;numhosts&gt;**_**;** **--max-hostgroup** _**&lt;numhosts&gt;**_ （並列スキャングループのサイズを調整します）

並列スキャンの数を制御できますが、最善ではありません（Nmapはネットワークの状態に基づいて自動的に制御します）：**--min-parallelism** _**&lt;numprobes&gt;**_**;** **--max-parallelism** _**&lt;numprobes&gt;**_

RTTタイムアウトを変更できますが、通常は必要ありません：**--min-rtt-timeout** _**&lt;time&gt;**_**,** **--max-rtt-timeout** _**&lt;time&gt;**_**,** **--initial-rtt-timeout** _**&lt;time&gt;**_

試行回数を変更できます：**--max-retries** _**&lt;numtries&gt;**_

ホストのスキャン時間を変更できます：**--
以下は、ハッキング技術に関する本の内容です。次の内容は、/hive/hacktricks/generic-methodologies-and-resources/pentesting-network/nmap-summary-esp.mdというファイルからのものです。関連する英語のテキストを日本語に翻訳し、翻訳を返し、マークダウンとHTMLの構文を完全に保持してください。コード、ハッキング技術の名前、ハッキングの言葉、クラウド/SaaSプラットフォームの名前（Workspace、aws、gcpなど）、'leak'という単語、ペンテスト、およびマークダウンタグなどのものは翻訳しないでください。また、翻訳とマークダウンの構文以外の追加のものは追加しないでください。
特定のデータベースを使用するには：sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST_A_ESCANEAR



<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ会社で働いていますか？** HackTricksで**会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見しましょう。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>
