<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obt√©n la [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) **grupo de Discord** o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme en** **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PRs al repositorio [hacktricks](https://github.com/carlospolop/hacktricks) y al repositorio [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
```text
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
**-iL** lista\_IPs

**-iR** numero --&gt; N√∫mero de Ips aleatorias, se pueden excluir posibles Ips con **--exclude &lt;Ips&gt;** o **--excludefile &lt;fichero&gt;**

**Descubrimiento de equipos:**

Podemos usar m√°scaras/24

**-sL**: No es invasivo, lista los objetivos realizando peticiones de DNS para resolver nombres. Sirve para saber si por ejemplo www.prueba.es/24 todas las Ips son objetivos nuestros.

Por defecto Nmap lanza una fase de descubrimiento que consta de: -PA80 -PS443 -PE -PP

**-Pn** No ping --&gt; √∫til **si se sabe que todos est√°n activos** \(sino lo estuviera alguno se podr√≠a perder mucho tiempo, pero
**-f** Fragmenta paquetes en 8 bytes despu√©s de la cabecera por defecto. Para especificar el tama√±o, se usa ..mtu (sin usar -f). El offset debe ser m√∫ltiplo de 8. Los esc√°neres de versi√≥n y scripts no soportan la fragmentaci√≥n.

**-D decoy1,decoy2,ME** Nmap env√≠a esc√°neres con otras direcciones IP como origen para ocultar la direcci√≥n real. Si se incluye ME en la lista, Nmap te situar√° all√≠. Es mejor incluir 5 o 6 direcciones antes de la tuya para enmascararte completamente. Se pueden generar IPs aleatorias con RND:&lt;n√∫mero&gt; para generar &lt;n√∫mero&gt; de IPs aleatorias. No funcionan con detectores de versiones sin conexi√≥n TCP. Si est√°s dentro de una red, es mejor usar IPs que est√©n activas para no ser detectado f√°cilmente.

Para usar IPs aleatorias: nmap -D RND:10 Ip_objetivo

**-S IP** Se utiliza cuando Nmap no detecta tu direcci√≥n IP, para especificarla manualmente. Tambi√©n se puede usar para hacer pensar que hay otro objetivo escaneando.

**-e &lt;interface&gt;** Para elegir la interfaz.

Muchos administradores dejan puertos de entrada abiertos para que todo funcione correctamente y les sea m√°s f√°cil que buscar otra soluci√≥n. Estos pueden ser los puertos DNS o los de FTP. Para buscar esta vulnerabilidad, Nmap incorpora: **--source-port** _**&lt;n√∫mero de puerto&gt;**_ y **-g** _**&lt;n√∫mero de puerto&gt;**_. Son equivalentes.

**--data** _**&lt;cadena hexadecimal&gt;**_ Para enviar texto hexadecimal: --data 0xdeadbeef y --data \xCA\xFE\x09

**--data-string** _**&lt;cadena&gt;**_ Para enviar un texto normal: --data-string "Scan conducted by Security Ops, extension 7192"

**--data-length** _**&lt;n√∫mero&gt;**_ Nmap env√≠a solo cabeceras, con esto logramos que a√±ada a estar un n√∫mero de bytes m√°s (que se generar√°n aleatoriamente).

Para configurar el paquete IP completamente, se usa **--ip-options**.

Si se desea ver las opciones en los paquetes enviados y recibidos, se especifica **--packet-trace**. Para obtener m√°s informaci√≥n y ejemplos de uso de opciones IP con Nmap, consulte [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52).

**--ttl** _**&lt;valor&gt;**_

**--randomize-hosts** Para que el ataque sea menos obvio.

**--spoof-mac** _**&lt;direcci√≥n MAC, prefijo o nombre del fabricante&gt;**_ Para cambiar la direcci√≥n MAC. Ejemplos: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2 y Cisco.

**--proxies** _**&lt;lista separada por comas de URLs de proxy&gt;**_ Para usar proxies. A veces, un proxy no mantiene tantas conexiones abiertas como Nmap quiere, por lo que habr√≠a que modificar el paralelismo: --max-parallelism.

**-sP** Para descubrir hosts en la red en la que estamos por ARP.

Muchos administradores crean una regla en el firewall que permite pasar todos los paquetes que provienen de un puerto en particular (como el 20, 53 y 67). Podemos decirle a Nmap que mande nuestros paquetes desde esos puertos: **nmap --source-port 53 Ip**.

**Salidas**

**-oN file** Salida normal.

**-oX file** Salida XML.

**-oS file** Salida de script kiddies.

**-oG file** Salida grepable.

**-oA file** Todos menos -oS.

**-v level** Verbosidad.

**-d level** Depuraci√≥n.

**--reason** Por qu√© del host y estado.

**--stats-every time** Cada ese tiempo nos dice c√≥mo va.

**--packet-trace** Para ver qu√© paquetes salen, se pueden especificar filtros como: --version-trace o --script-trace.

**--open** Muestra los puertos abiertos, abiertos/filtrados y los no filtrados.

**--resume file** Saca un resumen.

**Miscel√°nea**

**-6** Permite IPv6.

**-A** Es lo mismo que -O -sV -sC --traceroute.

**Run time**

Mientras corre Nmap, se pueden cambiar opciones:

v / V Aumentar / disminuir el nivel de verbosidad.

d / D Aumentar / disminuir el nivel de depuraci√≥n.

p / P Activar / desactivar el rastreo de paquetes.

? Imprimir una pantalla de ayuda de interacci√≥n en tiempo de ejecuci√≥n.

**Vulscan**

Es un script de Nmap que mira las versiones de los servicios obtenidos en una base de datos offline (que descarga de otras muy importantes) y devuelve las posibles vulnerabilidades.

Las bases de datos que usa son:

1. Scipvuldb.csv \| [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv \| [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv \| [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv \| [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv \| [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv \| [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv \| [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv \| [http://www.openvas.org](http://www.openvas.org/)

Para descargarlo e instalarlo en la carpeta de Nmap:

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

Tambi√©n habr√≠a que descargar los paquetes de las bases de datos y a√±adirlos a /usr/share/nmap/scripts/vulscan/.

Uso:

Para usar todas las bases de datos: sudo nmap -sV --script=vulscan HOST_A_ESCANEAR.

Para usar una base de datos espec√≠fica: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST_A_ESCANEAR.
