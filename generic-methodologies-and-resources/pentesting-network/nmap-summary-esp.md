# Muhtasari wa Nmap (ESP)

<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
```
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
## Vigezo

### IPs za kutafuta

* **`<ip>,<net/mask>`:** Inaonyesha IPs moja kwa moja
* **`-iL <ips_file>`:** orodha_IPs
* **`-iR <number>`**: Idadi ya Ips za kubahatisha, unaweza kuepuka Ips zinazowezekana kwa kutumia `--exclude <Ips>` au `--excludefile <file>`.

### Ugunduzi wa Vifaa

Kwa chaguo-msingi, Nmap huanzisha awamu ya ugunduzi inayojumuisha: `-PA80 -PS443 -PE -PP`

* **`-sL`**: Si ya kuvamia, inaorodhesha malengo kwa kutuma maombi ya **DNS** kutatua majina. Ni muhimu kujua kama kwa mfano www.prueba.es/24 IPs zote ni malengo yetu.
* **`-Pn`**: **Hakuna ping**. Hii ni muhimu ikiwa unajua kuwa zote ziko hai (kama sivyo, unaweza kupoteza muda mwingi, lakini chaguo hili pia husababisha matokeo hasi yakisema kuwa haziko hai), inazuia awamu ya ugunduzi.
* **`-sn`** : **Hakuna uchunguzi wa bandari**. Baada ya kukamilisha awamu ya upelelezi, haitafuti bandari. Ni ya siri, na inaruhusu uchunguzi mdogo wa mtandao. Kwa mamlaka inatuma ACK (-PA) kwa 80, SYN(-PS) kwa 443 na ombi la echo na ombi la Timestamp, bila mamlaka daima inakamilisha mawasiliano. Ikiwa lengo ni mtandao, inatumia ARP(-PR). Ikitumiwa pamoja na chaguo lingine, pakiti za chaguo lingine tu ndizo zinazotupiliwa mbali.
* **`-PR`**: **Ping ARP**. Hutumiwa kwa chaguo-msingi wakati wa kuchambua kompyuta katika mtandao wetu, ni haraka kuliko kutumia pings. Ikiwa hautaki kutumia pakiti za ARP tumia `--send-ip`.
* **`-PS <ports>`**: Inatuma pakiti za SYN ambapo ikijibu SYN/ACK inafunguliwa (ikijibu na RST ili kuzuia mawasiliano), ikijibu RST inafungwa na ikijibu kwa kutofautiana inafikika. Ikiwa huna mamlaka, mawasiliano kamili yanatumika moja kwa moja. Ikiwa hakuna bandari zimetolewa, inatuma kwa 80.
* **`-PA <ports>`**: Kama ile ya awali lakini na ACK, kuchanganya zote mbili hutoa matokeo bora.
* **`-PU <ports>`**: Lengo ni kinyume chake, inatuma kwa bandari ambazo zinatarajiwa kuwa zimefungwa. Baadhi ya firewalls huchunguza tu mawasiliano ya TCP. Ikiwa imefungwa inajibiwa na bandari isiyopatikana, ikiwa inajibiwa na icmp nyingine au haipatikani inaachwa kama isiyopatikana kwa marudio.
* **`-PE, -PP, -PM`** : ICMP PINGS: jibu la echo, timestamp na addresmask. Hutumwa kujua ikiwa lengo lipo hai.
* **`-PY<ports>`**: Inatuma uchunguzi wa SCTP INIT kwa 80 kwa chaguo-msingi, INIT-ACK(funguliwa) au ABORT(fungwa) au hakuna kitu au ICMP isiyopatikana(isiyofanya kazi) inaweza kujibiwa.
* **`-PO <protocols>`**: Itifaki inaonyeshwa kwenye vichwa, kwa chaguo-msingi 1(ICMP), 2(IGMP) na 4(Encap IP). Kwa itifaki za ICMP, IGMP, TCP (6) na UDP (17) vichwa vya itifaki vinatumwa, kwa zingine ni kichwa cha IP tu kinatumwa. Lengo la hii ni kwamba kutokana na uharibifu wa vichwa, itifaki isiyopatikana au majibu ya itifaki hiyo hiyo yanajibiwa ili kujua ikiwa iko juu.
* **`-n`**: Hakuna DNS
* **`-R`**: DNS daima

### Mbinu za Uchunguzi wa Bandari

* **`-sS`**: Haikamilishi mawasiliano hivyo haioni alama, nzuri sana ikiwa inaweza kutumika. (mamlaka) Ni ile inayotumiwa kwa chaguo-msingi.
* **`-sT`**: Inakamilisha mawasiliano, hivyo inaacha alama, lakini inaweza kutumika kwa uhakika. Kwa chaguo-msingi bila mamlaka.
* **`-sU`**: Polepole, kwa UDP. Kwa kiasi kikubwa: DNS(53), SNMP(161,162), DHCP(67 na 68), (-sU53,161,162,67,68): wazi(jibu), imefungwa(bandari isiyopatikana), iliyofungwa (icmp nyingine), wazi/imefungwa (hakuna kitu). Kwa hali ya wazi/imefungwa, -sV inatuma maombi mengi kugundua toleo lolote ambalo nmap inasaidia na inaweza kugundua hali halisi. Inaongeza sana muda.
* **`-sY`**: Itifaki ya SCTP haiwezi kuanzisha mawasiliano, hivyo hakuna kumbukumbu, inafanya kazi kama -PY
* **`-sN,-sX,-sF`:** Null, Fin, Xmas, wanaweza kuingia kwenye baadhi ya firewalls na kutoa habari. Wanategemea ukweli kwamba mashine zinazofuata viwango zinapaswa kujibu na RST maombi yote ambayo hayana SYN, RST au ACK zilizoinuliwa: wazi/imefungwa(hakuna kitu), imefungwa(RST), iliyofungwa (icmp isiyopatikana). Sio ya kuaminika kwenye Windows, CIsco, BSDI na OS/400. Kwenye unix ndio.
* **`-sM`**: Uchunguzi wa Maimon: Inatuma alama za FIN na ACK, hutumiwa kwa BSD, kwa sasa itarudisha zote kama zilizofungwa.
* **`-sA, sW`**: ACK na Window, hutumiwa kugundua firewalls, kujua ikiwa bandari zimezuiwa au la. -sW inatofautisha kati ya wazi/imefungwa kwani zile zilizofunguliwa zinajibu na thamani tofauti ya dirisha: wazi (RST na dirisha tofauti na 0), imefungwa (RST dirisha = 0), iliyofungwa (icmp isiyopatikana au hakuna kitu). Sio kompyuta zote hufanya kazi kwa njia hii, hivyo ikiwa zote zimefungwa, haifanyi kazi, ikiwa chache zimefunguliwa, inafanya kazi vizuri, na ikiwa nyingi zimefunguliwa na chache zimefungwa, inafanya kazi kinyume.
* **`-sI`:** Uchunguzi wa Kimya. Kwa kesi ambapo kuna firewall inayofanya kazi lakini tunajua kuwa haizuii kwa Ip fulani (au tunapotaka tu kutokuwa na utambulisho) tunaweza kutumia skana ya zombie (inatumika kwa bandari zote), kutafuta zombies inayowezekana tunaweza kutumia skrini ya ipidseq au kuchunguza msaidizi/scanner/ip/ipidseq. Skana hii inategemea nambari ya IPID ya pakiti za IP.
* **`--badsum`:** Inatuma jumla isiyo sahihi, kompyuta zingetupa pakiti, lakini firewalls zingeweza kujibu kitu, hutumiwa kugundua firewalls.
* **`-sZ`:** Skana ya SCTP "isiyo ya kawaida", wakati wa kutuma uchunguzi na vipande vya cookie echo vinapaswa kutupwa ikiwa wazi au kujibiwa na ABORT ikiwa imefungwa. Inaweza kupita kwenye firewalls ambazo init haitapita, baya ni kwamba haitofautishi kati ya zilizofungwa na wazi.
* **`-sO`:** Uchunguzi wa Itifaki ya Ip. Inatuma vichwa vibaya na tupu ambapo mara nyingine hata itifaki haiwezi kutofautishwa. Ikiwa itifaki isiyopatikana inafika imefungwa, ikiwa itifaki ya bandari isiyopatikana inafika imefunguliwa, ikiwa kosa lingine linapokelewa, imezuiwa, ikiwa hakuna kitu kinapokelewa, imefunguliwa|imezuiwa.
* **`-b <server>`:** FTPhost--> Hutumiwa kutafuta mwenyeji kutoka kwa mwingine, hii inafanywa kwa kuunganisha ftp ya mashine nyingine na kuomba kutuma faili kwa bandari unazotaka kutafuta kutoka kwa mashine nyingine, kulingana na majibu tutajua ikiwa zimefunguliwa au la. \[\<user>:\<password>@]\<server>\[:\<port>] Karibu seva zote za ftp haziruhusu tena kufanya hivi na kwa hivyo ni ya matumizi kidogo. 

### **Uchambuzi wa Kati**

**-p:** Inatumika kutoa bandari za kutafuta. Kuchagua 65335: **-p-** au **-p all**. Nmap ina uainishaji wa ndani kulingana na umaarufu wake. Kwa chaguo-msingi hutumia 1000 kuu. Kwa **-F** (uchunguzi wa haraka) huchunguza 100 kuu. Kwa **--top-ports \<numero>** Huchunguza idadi hiyo ya kuu (kutoka 1 hadi 65335). Huchunguza bandari kwa mpangilio wa nasibu, ili hilo lisitoke **-r**. Pia tunaweza kuchagua bandari: 20-30,80,443,1024- Hii ya mwisho inamaanisha kuangalia mbele ya 1024. Pia tunaweza kugawa bandari kwa itifaki: U:53,T:21-25,80,139,S:9. Pia tunaweza kuchagua kikundi cha bandari ndani ya kuu maarufu za nmap: -p \[-1024] huchunguza hadi 1024 zilizomo katika huduma za nmap. **--port-ratio \<ratio>** Huchunguza bandari za kawaida zaidi kuliko uwiano ambao lazima uwe kati ya 0 na 1

**-sV** Uchunguzi wa toleo, unaweza kudhibiti ukali kutoka 0 hadi 9, kwa chaguo-msingi 7.

**--version-intensity \<numero>** Tunadhibiti ukali, hivyo kadri chini itatuma tu majaribio yanayowezekana zaidi, lakini sio yote. Hii inaweza kupunguza sana muda wa uchunguzi wa UDP

**-O** Ugunduzi wa os

**--osscan-limit** Ili kuchunguza mwenyeji vizuri inahitajika angalau kuwepo na bandari moja iliyofunguliwa na nyingine imefungwa, ikiwa hali hii haipo na tumeiweka hii, haitajaribu kutabiri os (inapunguza muda)
**--osscan-guess** Wakati uchunguzi wa mfumo wa uendeshaji si kamili hii inafanya iwe ngumu zaidi

**Scripts**

\--script _\<jina la faili>_|_\<jamii>_|_\<directory>_|_\<expression>_\[,...]

Kutumia zile za msingi kwa chaguo la -sC au --script=default

Aina zilizopo ni: auth, broadcast, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version, na vuln

* **Auth:** hutekeleza zote zilizopo kwa uthibitishaji
* **Default:** hutekeleza zile za msingi za zana
* **Discovery:** hupata taarifa kuhusu lengo au mhanga
* **External:** script kwa kutumia rasilimali za nje
* **Intrusive:** hutumia script zinazochukuliwa kuwa za kuvamia kwa lengo au mhanga
* **Malware:** huchunguza kama kuna uhusiano wa wazi kwa nambari za hasidi au mlango wa nyuma
* **Safe:** hutekeleza script ambazo si za kuvamia
* **Vuln:** hufunua mapungufu maarufu zaidi
* **All:** hutekeleza kikamilifu script zote za NSE zilizopo

Kutafuta scripts:

**nmap --script-help="http-\*" -> Zile zinazoanza na http-**

**nmap --script-help="not intrusive" -> Zote isipokuwa hizo**

**nmap --script-help="default or safe" -> Zile zilizo katika moja au nyingine au zote mbili**

**nmap --script-help="default and safe" --> Zile zilizo katika zote mbili**

**nmap --script-help="(default or safe or intrusive) and not http-\*"**

\--script-args _\<n1>_=_\<v1>_,_\<n2>_={_\<n3>_=_\<v3>_},_\<n4>_={_\<v4>_,_\<v5>_}

\--script-args-file _\<jina la faili>_

\--script-help _\<jina la faili>_|_\<jamii>_|_\<directory>_|_\<expression>_|all\[,...]

\--script-trace ---> Inatoa habari kuhusu jinsi script inavyoendelea

\--script-updatedb

**Kutumia script ni rahisi tu: nmap --script Jina\_la\_script lengo** --> Kwa kuweka script, script na skana zitatekelezwa, hivyo pia unaweza kuongeza **‚Äúsafe=1‚Äù** ili zitekelezwe tu zile salama.

**Kudhibiti Wakati**

**Nmap inaweza kurekebisha wakati kwa sekunde, dakika, ms:** --host-timeout arguments 900000ms, 900, 900s, na 15m yote yanafanya kitu kimoja.

Nmap huchukua idadi ya jumla ya vifaa vya kuchunguza na kugawanya katika vikundi na kuchambua vikundi hivyo kwa mafungu ili mpaka vyote vichunguzwe, haitoi kwa kundi la pili (na mtumiaji pia hupokea sasisho lolote hadi kundi limechambuliwa) kwa njia hii, ni bora kwa nmap kutumia vikundi vikubwa. Kwa chaguo-msingi katika darasa C hutumia 256.

Inaweza kubadilishwa na\*\*--min-hostgroup\*\* _**\<numhosts>**_**;** **--max-hostgroup** _**\<numhosts>**_ (Kurekebisha ukubwa wa vikundi vya uchunguzi wa pamoja)

Inaweza kudhibiti idadi ya skana kwa pamoja lakini ni bora kutofanya hivyo (nmap tayari ina udhibiti wa moja kwa moja kulingana na hali ya mtandao): **--min-parallelism** _**\<numprobes>**_**;** **--max-parallelism** _**\<numprobes>**_

Tunaweza kurekebisha rtt timeout, lakini mara nyingi si lazima: **--min-rtt-timeout** _**\<time>**_**,** **--max-rtt-timeout** _**\<time>**_**,** **--initial-rtt-timeout** _**\<time>**_

Tunaweza kurekebisha idadi ya majaribio:**--max-retries** _**\<numtries>**_

Tunaweza kurekebisha wakati wa kuchunguza kifaa: **--host-timeout** _**\<time>**_

Tunaweza kurekebisha wakati kati ya kila jaribio ili liende polepole: **--scan-delay** _**\<time>**_**;** **--max-scan-delay** _**\<time>**_

Tunaweza kurekebisha idadi ya pakiti kwa sekunde: **--min-rate** _**\<number>**_**;** **--max-rate** _**\<number>**_

Bandari nyingi huchukua muda mrefu kujibu kwa kuwa zimezuiwa au zimefungwa, ikiwa tunataka tu zile zilizofunguliwa, tunaweza kwenda haraka zaidi na: **--defeat-rst-ratelimit**

Kuamua jinsi kali tunavyotaka nmap iwe: -T paranoid|sneaky|polite|normal|aggressive|insane

\-T (0-1)

\-T0 --> Inachunguza bandari 1 kwa wakati mmoja na inangojea dakika 5 hadi inayofuata

\-T1 na T2 --> Sawa sana lakini zinangojea sekunde 15 na 0.4 kati ya majaribio

\-T3 --> Kazi ya chaguo-msingi, inajumuisha kwa pamoja

\-T4 --> --max-rtt-timeout 1250ms --min-rtt-timeout 100ms --initial-rtt-timeout 500ms --max-retries 6 --max-scan-delay 10ms

\-T5 --> --max-rtt-timeout 300ms --min-rtt-timeout 50ms --initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m --max-scan-delay 5ms

**Firewall/IDS**

Huzuia kupitisha bandari na kuchambua pakiti.

**-f** Kugawanya pakiti, kwa chaguo-msingi inagawa kwa 8bytes baada ya kichwa, kwa kubainisha ukubwa huo tunatumia ..mtu (kwa hili, usitumie -f), offset lazima iwe maradufu ya 8. **Skana za toleo na scripts hazisaidii kugawanyika**

**-D decoy1,decoy2,ME** Nmap hutoa skana lakini na anwani za IP nyingine kama asili, hivyo kukuficha. Ikiwa unaweka ME kwenye orodha, nmap itakupa hapo, ni bora kuweka 5 au 6 kabla yako ili kukuficha kabisa. Inaweza kuzalisha IPs za kubahatisha na RND:\<nambari> Ili kuzalisha \<nambari> ya IPs za kubahatisha. Hazifanyi kazi na detector ya toleo bila uhusiano wa TCP. Ikiwa uko ndani ya mtandao, ni bora kutumia IPs zilizo hai, vinginevyo itakuwa rahisi sana kugundua kuwa wewe ndiye pekee aliye hai.

Kutumia IPs za kubahatisha: nmap-D RND: 10 Ip\_lengo

**-S IP** Ikiwa Nmap haijapata anwani yako ya IP unapaswa kuipeana hiyo. Pia inafaa kufanya iweze kufikiri kuwa kuna lengo lingine linawachunguza.

**-e \<interface>** Kuchagua kiolesura

Wengi wa wasimamizi huacha bandari za kuingilia wazi ili kila kitu kifanye kazi vizuri na ni rahisi kwao kuliko kutafuta suluhisho lingine. Hizi zinaweza kuwa bandari za DNS au FTP... kwa kutafuta udhaifu huu nmap inajumuisha: **--source-port** _**\<nambari ya mlango>**_**;-g** _**\<nambari ya mlango>**_ _Zinafaana_

**--data** _**\<herufi za hexadecimal>**_ Kutuma maandishi ya hexadecimal: --data 0xdeadbeef na --data \xCA\xFE\x09

**--data-string** _**\<maandishi>**_ Kutuma maandishi ya kawaida: --data-string "Uchunguzi uliofanywa na Operesheni ya Usalama, upanuzi 7192"

**--data-length** _**\<nambari>**_ Nmap inatuma vichwa tu, hivyo tunaweza kuongeza idadi ya bayti zaidi (ambazo zitazalishwa kwa kubahatisha)

Kuweka pakiti ya IP kabisa kutumia **--ip-options**

Ikiwa unataka kuona chaguo katika pakiti zilizotumwa na kupokelewa, eleza --packet-trace. Kwa habari zaidi na mifano ya kutumia chaguo za IP na Nmap, angalia [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52).

**--ttl** _**\<thamani>**_

**--randomize-hosts** Ili shambulio liwe lisilo dhahiri

**--spoof-mac** _**\<anwani ya MAC, kiambishi, au jina la muuzaji>**_ Kubadilisha MAC mfano: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2, na Cisco
**--proxies** _**\<Orodha ya URL za proksi zilizotenganishwa na koma>**_ Ili kutumia proksi, mara nyingi proksi moja haitunzi idadi kubwa ya uhusiano wazi kama inavyotaka nmap hivyo inaweza kuhitaji kurekebisha upatanishi: --max-parallelism

**-sP** Ili kugundua mwenyeji kwenye mtandao tunao kwa ARP

Waadiministrata wengi huanzisha sheria kwenye firewall inayoruhusu pakiti zote zinazotoka kwenye bandari fulani (kama 20, 53, na 67) kupita, tunaweza kuambia nmap itume pakiti zetu kutoka kwenye bandari hizo: **nmap --source-port 53 Ip**

**Matokeo**

**-oN faili** Matokeo ya kawaida

**-oX faili** Matokeo ya XML

**-oS faili** Matokeo ya script kidies

**-oG faili** Matokeo yanayoweza kutafutika

**-oA faili** Yote isipokuwa -oS

**-v kiwango** maelezo zaidi

**-d kiwango** kurekebisha hitilafu

**--reason** Kwa nini ya mwenyeji na hali

**--stats-every muda** Kila muda huo inatuambia jinsi inavyokwenda

**--packet-trace** Ili kuona ni pakiti zipi zinazotoka, unaweza kutoa maelezo ya ziada kama: --version-trace au --script-trace

**--open** inaonyesha wazi, wazi|yaliyofutwa, na yasiyofutwa

**--resume faili** Inatoa muhtasari

**Mchanganyiko**

**-6** Inaruhusu ipv6

**-A** ni sawa na -O -sV -sC --traceroute

**Muda wa Kutekelezwa**

Wakati nmap inakimbia tunaweza kubadilisha chaguo:

v / V Ongeza / punguza kiwango cha maelezo

d / D Ongeza / punguza kiwango cha kutatua hitilafu

p / P Weka / toa ufuatiliaji wa pakiti

? Chapisha skrini ya msaada wa mwingiliano wa wakati wa kutekelezwa

**Vulscan**

Script ya nmap inayotazama toleo la huduma zilizopatikana kwenye hifadhidata ya nje ya mtandao (ambayo inapakuliwa kutoka kwa zingine muhimu sana) na kurudisha mapungufu yanayowezekana

Hifadhidata anazotumia ni:

1. Scipvuldb.csv | [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv | [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv | [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv | [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv | [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv | [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv | [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv | [http://www.openvas.org](http://www.openvas.org/)

Ili kuipakua na kuaislisha kwenye folda ya Nmap:

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

Pia unahitaji kupakua pakiti za hifadhidata na kuziweka kwenye /usr/share/nmap/scripts/vulscan/

Matumizi:

Kutumia zote: sudo nmap -sV --script=vulscan HOST\_A\_ESCANEAR

Kutumia hifadhidata maalum: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST\_A\_ESCANEAR

## Kuharakisha Uchunguzi wa Huduma za Nmap x16

Kulingana na [**chapisho hili**](https://joshua.hu/nmap-speedup-service-scanning-16x) unaweza kuharakisha uchambuzi wa huduma za nmap kwa kurekebisha thamani zote za **`totalwaitms`** kwenye **`/usr/share/nmap/nmap-service-probes`** kuwa **300** na **`tcpwrappedms`** kuwa **200**.

Zaidi ya hayo, uchunguzi ambao haujapata thamani maalum ya **`servicewaitms`** hutumia thamani ya msingi ya **`5000`**. Kwa hivyo, tunaweza kuongeza thamani kwa kila uchunguzi, au tunaweza **kukusanya upya nmap** wenyewe na kubadilisha thamani ya msingi katika [**service\_scan.h**](https://github.com/nmap/nmap/blob/master/service\_scan.h#L79).

Ikiwa hutaki kubadilisha thamani za **`totalwaitms`** na **`tcpwrappedms`** kabisa kwenye faili ya `/usr/share/nmap/nmap-service-probes`, unaweza kuhariri [msimbo wa uchambuzi](https://github.com/nmap/nmap/blob/master/service\_scan.cc#L1358) ili thamani hizi kwenye faili ya `nmap-service-probes` zisipuuzwe kabisa.

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka mwanzo hadi kuwa shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
