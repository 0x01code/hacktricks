# Nmap рд╕рд╛рд░рд╛рдВрд╢ (ESP)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
```
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
## рдкреИрд░рд╛рдореАрдЯрд░

### рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП IPs

* **`<ip>,<net/mask>`:** IPs рдХреЛ рд╕реАрдзреЗ рдЗрдВрдбрд┐рдХреЗрдЯ рдХрд░реЗрдВ
* **`-iL <ips_file>`:** рд╕реВрдЪреА_IPs
* **`-iR <number>`**: рд░реИрдВрдбрдо IPs рдХреА рд╕рдВрдЦреНрдпрд╛, рдЖрдк `--exclude <Ips>` рдпрд╛ `--excludefile <file>` рдХреЗ рд╕рд╛рде рд╕рдВрднрд╛рд╡рд┐рдд IPs рдХреЛ рдмрд╛рд╣рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### рдЙрдкрдХрд░рдг рдЦреЛрдЬ

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдбрд┐рд╕реНрдХрд╡рд░реА рдлреЗрдЬ рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рддрд╛ рд╣реИ Nmap: `-PA80 -PS443 -PE -PP`

* **`-sL`**: рдпрд╣ рдЕрддреНрдпрдзрд┐рдХ рдЖрдХреНрд░рд╛рдордХ рдирд╣реАрдВ рд╣реИ, рдпрд╣ рд▓рдХреНрд╖реНрдпреЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдирд╛рдореЛрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **DNS** рдЕрдиреБрд░реЛрдз рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реИ рдпрджрд┐ рдЖрдк рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП www.prueba.es/24 рд╕рднреА IPs рд╣рдорд╛рд░реЗ рд▓рдХреНрд╖реНрдп рд╣реИрдВред
* **`-Pn`**: **рдХреЛрдИ рдкрд┐рдВрдЧ рдирд╣реАрдВ**ред рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реИ рдЕрдЧрд░ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рд╕рднреА рд╡реЗ рд╕рдХреНрд░рд┐рдп рд╣реИрдВ (рдЕрдЧрд░ рдирд╣реАрдВ, рддреЛ рдЖрдк рдмрд╣реБрдд рд╕рдордп рдЦреЛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рд╡рд┐рдХрд▓реНрдк рднреА рдЧрд▓рдд рдирдХрд╛рд░рд╛рддреНрдордХ рдкрд░рд┐рдгрд╛рдо рджреЗрддрд╛ рд╣реИ рдХрд┐ рд╡реЗ рд╕рдХреНрд░рд┐рдп рдирд╣реАрдВ рд╣реИрдВ), рдпрд╣ рдбрд┐рд╕реНрдХрд╡рд░реА рдлреЗрдЬ рдХреЛ рд░реЛрдХрддрд╛ рд╣реИред
* **`-sn`** : **рдХреЛрдИ рдкреЛрд░реНрдЯ рд╕реНрдХреИрди рдирд╣реАрдВ**ред рдЕрдиреБрд╕рдВрдзрд╛рди рдлреЗрдЬ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдпрд╣ рдкреЛрд░реНрдЯ рд╕реНрдХреИрди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдЫрд┐рдкрдХрд▓реА рд╣реИ, рдФрд░ рдПрдХ рдЫреЛрдЯреЗ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде, рдпрд╣ 80 рдХреЛ ACK (-PA) рднреЗрдЬрддрд╛ рд╣реИ, 443 рдХреЛ SYN(-PS) рднреЗрдЬрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдЗрдХреЛ рдЕрдиреБрд░реЛрдз рдФрд░ рдПрдХ рд╕рдордпрдЪрд┐рд╣реНрди рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ, рдмрд┐рдирд╛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╣рдореЗрд╢рд╛ рдХрдиреЗрдХреНрд╢рди рдкреВрд░рд╛ рд╣реЛрддрд╛ рд╣реИред рдпрджрд┐ рд▓рдХреНрд╖реНрдп рдиреЗрдЯрд╡рд░реНрдХ рд╣реИ, рддреЛ рдХреЗрд╡рд▓ ARP(-PR) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рджреВрд╕рд░реЗ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХреЗрд╡рд▓ рджреВрд╕рд░реЗ рд╡рд┐рдХрд▓реНрдк рдХреЗ рдкреИрдХреЗрдЯ рдбреНрд░реЙрдк рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
* **`-PR`**: **рдкрд┐рдВрдЧ ARP**ред рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╣рдорд╛рд░реЗ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддреЗ рд╕рдордп рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рдкрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рддреЗрдЬ рд╣реИред рдпрджрд┐ рдЖрдк ARP рдкреИрдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ `--send-ip` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **`-PS <ports>`**: рдпрд╣ SYN рдкреИрдХреЗрдЯ рднреЗрдЬрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдпрджрд┐ рдпрд╣ SYN/ACK рдХреЗ рд╕рд╛рде рдЬрд╡рд╛рдм рджреЗрддрд╛ рд╣реИ рддреЛ рдЦреБрд▓рд╛ рд╣реИ (рдЬрд┐рд╕реЗ рдпрд╣ RST рдХреЗ рд╕рд╛рде рдЬрд╡рд╛рдм рджреЗрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдХрдиреЗрдХреНрд╢рди рд╕рдорд╛рдкреНрдд рди рд╣реЛ), рдпрджрд┐ рдпрд╣ RST рдХреЗ рд╕рд╛рде рдЬрд╡рд╛рдм рджреЗрддрд╛ рд╣реИ рддреЛ рдмрдВрдж рд╣реИ рдФрд░ рдпрджрд┐ рдпрд╣ рдЬрд╡рд╛рдм рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ рддреЛ рдЕрдЧрдореНрдп рд╣реИред рдпрджрд┐ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдирд╣реАрдВ рд╣реИрдВ, рддреЛ рд╕рдореНрдкреВрд░реНрдг рдХрдиреЗрдХреНрд╢рди рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдХреЛрдИ рдкреЛрд░реНрдЯ рдирд╣реАрдВ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ 80 рдкрд░ рдлреЗрдВрдХ рджреЗрддрд╛ рд╣реИред
* **`-PA <ports>`**: рдкрд┐рдЫрд▓реЗ рд╡рд╛рд▓реЗ рдХреА рддрд░рд╣ рд▓реЗрдХрд┐рди ACK рдХреЗ рд╕рд╛рде, рджреЛрдиреЛрдВ рдХреЛ рдорд┐рд▓рд╛рдХрд░ рдмреЗрд╣рддрд░ рдкрд░рд┐рдгрд╛рдо рдорд┐рд▓рддреЗ рд╣реИрдВред
* **`-PU <ports>`**: рдЙрджреНрджреЗрд╢реНрдп рдЙрд▓реНрдЯрд╛ рд╣реИ, рдпрд╣ рдмрдВрдж рд╣реЛрдиреЗ рдХреА рдЙрдореНрдореАрдж рд╣реИред рдХреБрдЫ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдХреЗрд╡рд▓ TCP рдХрдиреЗрдХреНрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВред рдпрджрд┐ рдпрд╣ рдмрдВрдж рд╣реИ рддреЛ рдпрд╣ рдкреЛрд░реНрдЯ рдЕрдкреНрд░рд╛рдкреНрдп рд╣реИ, рдпрджрд┐ рдпрд╣ рдХрд┐рд╕реА рдЕрдиреНрдп icmp рдХреЗ рд╕рд╛рде рдЬрд╡рд╛рдм рджреЗрддрд╛ рд╣реИ рдпрд╛ рдЬрд╡рд╛рдм рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ рддреЛ рдпрд╣ рдЧрдВрддрд╡реНрдп рдЕрдкреНрд░рд╛рдкреНрдп рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **`-PE, -PP, -PM`** : ICMP PINGS: рдЗрдХреЛ рдкреНрд░рддрд┐рджреНрд╡рдВрджреНрд╡реА, рд╕рдордпрдЪрд┐рд╣реНрди рдФрд░ рдПрдбреНрд░реЗрд╕рдорд╛рд╕реНрдХред рдпрд╣ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдкрддрд╛ рдЪрд▓реЗ рдХрд┐ рд▓рдХреНрд╖реНрдп рд╕рдХреНрд░рд┐рдп рд╣реИ рдпрд╛ рдирд╣реАрдВред
* **`-PY<ports>`**: 80 рдХреЗ рд▓рд┐рдП SCTP INIT рдкреНрд░реЛрдм рднреЗрдЬрддрд╛ рд╣реИ, INIT-ACK(рдЦреБрд▓рд╛) рдпрд╛ ABORT(рдмрдВрдж) рдпрд╛ рдХреБрдЫ рдирд╣реАрдВ рдпрд╛ ICMP рдЕрдкреНрд░рд╛рдкреНрдп(рдирд┐рд╖реНрдХреНрд░рд┐рдп) рдЬрд╡рд╛рдм рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **`-PO <protocols>`**: рд╣реЗрдбрд░ рдореЗрдВ рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ 1(ICMP), 2(IGMP) рдФрд░ 4(Encap IP)ред ICMP, IGMP, TCP (6) рдФрд░ UDP (17) рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реЗрдбрд░ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдмрд╛рдХреА рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ IP рд╣реЗрдбрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╣реИ рдХрд┐ рд╣реЗрдбрд░реНрд╕ рдХреА рдЧрд▓рдд рдмрдирд╛рд╡рдЯ рдХреЗ рдХрд╛рд░рдг рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЕрдкреНрд░рд╛рдкреНрдп рдпрд╛ рдЙрд╕реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдЬрд╡рд╛рдм рджрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдкрддрд╛ рдЪрд▓реЗ рдХрд┐ рдпрд╣ рдКрдкрд░ рд╣реИ рдпрд╛ рдирд╣реАрдВред
* **`-n`**: рдХреЛрдИ DNS рдирд╣реАрдВ
* **`-R`**: рд╣рдореЗрд╢рд╛ DNS

### рдкреЛрд░реНрдЯ рд╕реНрдХреИрдирд┐рдВрдЧ рддрдХрдиреАрдХреЗрдВ

* **`-sS`**: рдХрдиреЗрдХреНрд╢рди рдХреЛ рдкреВрд░рд╛ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рдЗрд╕рд▓рд┐рдП рдХреЛрдИ рдкрддрд╛ рдирд╣реАрдВ рдЫреЛрдбрд╝рддрд╛, рдЕрдЧрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддреЛ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рд╣реИред(рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░) рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **`-sT`**: рдХрдиреЗрдХреНрд╢рди рдкреВрд░рд╛ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдкрддрд╛ рдЫреЛрдбрд╝рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдирд╣реАрдВ рд╣реИред
* **`-sU`**: рдзреАрдорд╛, UDP рдХреЗ рд▓рд┐рдПред рдЕрдзрд┐рдХрд╛рдВрд╢: DNS(53), SNMP(161,162), DHCP(67 рдФрд░ 68), (-sU53,161,162,67,68): рдЦреБрд▓рд╛(рдЬрд╡рд╛рдм), рдмрдВрдж(рдкреЛрд░реНрдЯ рдЕрдкреНрд░рд╛рдкреНрдп), рдлрд╝рд┐рд▓реНрдЯрд░(рдЕрдиреНрдп ICMP), рдЦреБрд▓рд╛/рдлрд╝рд┐рд▓реНрдЯрд░(рдХреБрдЫ рдирд╣реАрдВ)ред рдЦреБрд▓рд╛/рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, -sV рдиреНрдпреВрдирддрдо рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рдХреЛ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ рдФрд░ nmap рд╕рдорд░реНрдерд┐рдд рдХрд┐рд╕реА рднреА рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реНрдерд┐рддрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕рдордп рдХреЛ рдмрд╣реБрдд рдмрдврд╝рд╛ рджреЗрддрд╛ рд╣реИред
* **`-sY`**: SCTP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╡рд┐рдлрд▓ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХреЛрдИ рд▓реЙрдЧ рдирд╣реАрдВ рд╣реЛрддрд╛, -PY рдХреА рддрд░рд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ
* **`-sN,-sX,-sF`:** рдирд▓, рдлрд┐рди, рдЦреНрд░рд┐рд╕рдорд╕, рд╡реЗ рдХреБрдЫ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдЙрд╕ рддрдереНрдп рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ рдХрд┐ рдорд╛рдирдХ рдЕрдиреБрд░реВрдк рдорд╢реАрдиреЗрдВ рдЙрди рд╕рднреА рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд╕рд╛рде RST рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рдирдореЗрдВ SYN, RST рдпрд╛ ACK рд▓реИрдЧ рдЙрдард╛рдП рдирд╣реАрдВ рд╣реИрдВ: рдЦреБрд▓рд╛/рдлрд╝рд┐рд▓реНрдЯрд░(рдХреБрдЫ рдирд╣реАрдВ), рдмрдВрдж(RST), рдлрд╝рд┐рд▓реНрдЯрд░(рдЕрдиреНрдп ICMP)ред рд╡рд┐рдВрдбреЛрдЬ, рд╕рд┐рд╕реНрдХреЛ, рдмреАрдПрд╕рдбреАрдЖрдИ рдФрд░ рдУрдПрд╕/400 рдкрд░ рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╣реИред рдпреВрдирд┐рдХреНрд╕ рдкрд░ рд╣рд╛рдВред
* **`-sM`**: рдореИрдорди рд╕реНрдХреИрди: FIN рдФрд░ ACK рдлреНрд▓реИрдЧ рднреЗрдЬрддрд╛ рд╣реИ, рд╡рд░реНрддрдорд╛рди рдореЗрдВ рд╕рднреА рдХреЛ рдмрдВрдж рдХреЗ рд░реВрдк рдореЗрдВ рд▓реМрдЯрд╛рдПрдЧрд╛ред
* **`-sA, sW`**: ACK рдФрд░ рд╡рд┐рдВрдбреЛ, рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдкреЛрд░реНрдЯ рдлрд╝рд┐рд▓реНрдЯрд░ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВред -sW рдЦреБрд▓рд╛/рдмрдВрдж рдХреЗ рдмреАрдЪ рднреЗрдж рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЦреБрд▓реЗ рд╡рд╛рд▓реЗ рдЕрд▓рдЧ рд╡рд┐рдВрдбреЛ рдорд╛рди рджреЗрддреЗ рд╣реИрдВ: рдЦреБрд▓рд╛ (рдЬрд╡рд╛рдм рд╡рд┐рдВрдбреЛ 0 рдХреЗ рдЕрд▓рд╛рд╡рд╛), рдмрдВрдж (рдмрдВрдж рд╡рд┐рдВрдбреЛ = 0), рдлрд╝рд┐рд▓реНрдЯрд░ (ICMP рдЕрдк
**--osscan-guess** рдЬрдм рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреА рдкрд╣рдЪрд╛рди рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рд╣реА рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ рддреЛ рдпрд╣ рдЕрдзрд┐рдХ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред

**Scripts**

\--script _\<рдирд╛рдо>_|_\<рд╢реНрд░реЗрдгреА>_|_\<рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛>_|_\<рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐>_\[,...]

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП -sC рдпрд╛ --script=default рдХрд╛рдлреА рд╣реИред

рдЙрдкрд▓рдмреНрдз рд╢реНрд░реЗрдгрд┐рдпрд╛рдБ рд╣реИрдВ: auth, broadcast, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version, рдФрд░ vuln

* **Auth:** рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рд╕рднреА рдЕрдкрдиреЗ _рд╕реНрдХреНрд░рд┐рдкреНрдЯ_ рдХреЛ рдЪрд▓рд╛рддрд╛ рд╣реИ
* **Default:** рдЙрдкрдХрд░рдг рдХреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдмреБрдирд┐рдпрд╛рджреА _рд╕реНрдХреНрд░рд┐рдкреНрдЯ_ рдХреЛ рдЪрд▓рд╛рддрд╛ рд╣реИ
* **Discovery:** _target_ рдпрд╛ рдкреАрдбрд╝рд┐рддрд╛ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ
* **External:** рдмрд╛рд╣реНрдп рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП _рд╕реНрдХреНрд░рд┐рдкреНрдЯ_
* **Intrusive:** рдкреАрдбрд╝рд┐рдд рдпрд╛ _target_ рдХреЗ рд▓рд┐рдП рдЕрднрд┐рдорд╛рдиреА рдорд╛рдиреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ _рд╕реНрдХреНрд░рд┐рдкреНрдЯ_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ
* **Malware:** рдХреНрдпрд╛ рдЦреБрд▓реЗ рд╣реИрдВ рдХреЛрдб рдпрд╛ _backdoors_ (рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ) рджреНрд╡рд╛рд░рд╛ рдХреЛрдИ рдЬреБрдбрд╝рд╛рд╡ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ
* **Safe:** рдЕрднрд┐рдорд╛рдиреА рдирд╣реАрдВ рд╣реИрдВ _рд╕реНрдХреНрд░рд┐рдкреНрдЯ_ рдХреЛ рдЪрд▓рд╛рддрд╛ рд╣реИ
* **Vuln:** рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЬрд╛рдиреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдХрдорд┐рдпреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ
* **All:** рдЙрдкрд▓рдмреНрдз NSE рд╡рд┐рд╕реНрддрд╛рд░ рд╡рд╛рд▓реЗ рд╕рднреА _рд╕реНрдХреНрд░рд┐рдкреНрдЯ_ рдХреЛ рдЪрд▓рд╛рддрд╛ рд╣реИ

рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП:

**nmap --script-help="http-\*" -> рдЬреЛ http- рд╕реЗ рд╢реБрд░реВ рд╣реЛрддреЗ рд╣реИрдВ**

**nmap --script-help="not intrusive" -> рдЙрдирдореЗрдВ рд╕реЗ рд╕рднреА рдЬреЛ рдирд╣реАрдВ рд╣реИрдВ**

**nmap --script-help="default or safe" -> рдЬреЛ рдПрдХ рдореЗрдВ рд╣реИрдВ рдпрд╛ рджреВрд╕рд░реЗ рдореЗрдВ рдпрд╛ рджреЛрдиреЛрдВ рдореЗрдВ**

**nmap --script-help="default and safe" --> рдЬреЛ рджреЛрдиреЛрдВ рдореЗрдВ рд╣реИрдВ**

**nmap --script-help="(default or safe or intrusive) and not http-\*"**

\--script-args _\<n1>_=_\<v1>_,_\<n2>_={_\<n3>_=_\<v3>_},_\<n4>_={_\<v4>_,_\<v5>_}

\--script-args-file _\<рдирд╛рдо рдлрд╝рд╛рдЗрд▓>_

\--script-help _\<рдирд╛рдо>_|_\<рд╢реНрд░реЗрдгреА>_|_\<рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛>_|_\<рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐>_|all\[,...]

\--script-trace ---> рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдкреНрд░рдЧрддрд┐ рджреЗрддрд╛ рд╣реИ

\--script-updatedb

**рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдирд╛рдо рджрд░реНрдЬ рдХрд░реЗрдВ: namp --script рдирд╛рдо_рджреЗрдирд╛_рд╣реИ\_рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓рдХреНрд╖реНрдп** --> рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рд╕реНрдХреИрдирд░ рджреЛрдиреЛрдВ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрдХреНрд░рд┐рдкреНрдЯ рджрд░реНрдЬ рдХрд░рдиреЗ рдкрд░, рдЗрд╕рд▓рд┐рдП рд╕реНрдХреИрдирд░ рдХреЗ рд╡рд┐рдХрд▓реНрдк рднреА рджрд░реНрдЬ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдо **тАЬsafe=1тАЭ** рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдХреЗрд╡рд▓ рд╕реБрд░рдХреНрд╖рд┐рдд рд╡рд╛рд▓реЗ рд╣реА рдЪрд▓реЗрдВред

**рд╕рдордп рдирд┐рдпрдВрддреНрд░рдг**

**Nmap рд╕реЗрдХрдВрдб, рдорд┐рдирдЯ, ms рдореЗрдВ рд╕рдордп рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ:** --host-timeout arguments 900000ms, 900, 900s, рдФрд░ 15m рд╕рднреА рдПрдХ рд╣реА рдЪреАрдЬ рдХрд░рддреЗ рд╣реИрдВред

Nmap рд╣реЛрд╕реНрдЯ рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ рдХреЛ рд╕рдореВрд╣реЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрди рд╕рдореВрд╣реЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдмреНрд▓реЙрдХ рдореЗрдВ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЬрдм рддрдХ рд╕рднреА рд╡рд┐рд╢реНрд▓реЗрд╖рд┐рдд рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ, рддрдм рддрдХ рдпрд╣ рдЕрдЧрд▓реЗ рдмреНрд▓реЙрдХ рдкрд░ рдирд╣реАрдВ рдЬрд╛рддрд╛ рд╣реИ (рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рддрдм рддрдХ рдХреЛрдИ рдЕрджреНрдпрддрди рдирд╣реАрдВ рдорд┐рд▓рддрд╛ рд╣реИ рдЬрдм рддрдХ рдмреНрд▓реЙрдХ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ) рдЗрд╕ рддрд░рд╣, nmap рдХреЗ рд▓рд┐рдП рдмрдбрд╝реЗ рд╕рдореВрд╣реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЕрдзрд┐рдХ рдЙрдкрдпреБрдХреНрдд рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХрдХреНрд╖рд╛ C рдореЗрдВ 256 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред

рдЗрд╕реЗ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ\*\*--min-hostgroup\*\* _**\<numhosts>**_**;** **--max-hostgroup** _**\<numhosts>**_ (рд╕рдорд╛рдирдХрд╛рд▓рд┐рдХ рд╕реНрдХреИрди рд╕рдореВрд╣ рдЖрдХрд╛рд░реЛрдВ рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░реЗрдВ)

рд╕рдорд╛рдирдХрд╛рд▓рд┐рдХ рд╕реНрдХреИрдирд░реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдпрд╣ рдмреЗрд╣рддрд░ рд╣реИ рдХрд┐ рди рдХрд░реЗрдВ (nmpa рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдиреЗрдЯрд╡рд░реНрдХ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдирд┐рдпрдВрддреНрд░рдг рд╢рд╛рдорд┐рд▓ рд╣реИ): **--min-parallelism** _**\<numprobes>**_**;** **--max-parallelism** _**\<numprobes>**_

рд╣рдо rtt рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЖрдо рддреМрд░ рдкрд░ рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реЛрддрд╛: **--min-rtt-timeout** _**\<time>**_**,** **--max-rtt-timeout** _**\<time>**_**,** **--initial-rtt-timeout** _**\<time>**_

рд╣рдо рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:**--max-retries** _**\<numtries>**_

рд╣рдо рд╣реЛрд╕реНрдЯ рдХреЗ рд╕реНрдХреИрдирд┐рдВрдЧ рдХреЗ рд╕рдордп рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: **--host-timeout** _**\<time>**_

рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдкрд░реАрдХреНрд╖рдг рдХреЗ рдмреАрдЪ рдХрд╛ рд╕рдордп рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдзреАрдореЗ рдЪрд▓реЗ: **--scan-delay** _**\<time>**_**;** **--max-scan-delay** _**\<time>**_

рд╣рдо рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдкреИрдХреЗрдЯ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: **--min-rate** _**\<number>**_**;** **--max-rate** _**\<number>**_

рдмрд╣реБрдд рд╕реЗ рдкреЛрд░реНрдЯ рдлрд╝рд┐рд▓реНрдЯрд░ рдпрд╛ рдмрдВрдж рд╣реЛрдиреЗ рдХреЗ рдХрд╛рд░рдг рдмрд╣реБрдд рджреЗрд░ рддрдХ рдЬрд╡рд╛рдм рдирд╣реАрдВ рджреЗрддреЗ, рдЕрдЧрд░ рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдЦреБрд▓реЗ рдкреЛрд░реНрдЯреЛрдВ рдХреА рдЬрд░реБрд░рдд рд╣реИ, рддреЛ рд╣рдо рдЗрд╕реЗ рддреЗрдЬрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: **--defeat-rst-ratelimit**

nmap рдХреЛ рдХрд┐рддрдирд╛ рдкреНрд░рдмрд▓ рдмрдирд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: -T paranoid|sneaky|polite|normal|aggressive|insane

\-T (0-1)

\-T0 --> рдХреЗрд╡рд▓ рдПрдХ рдкреЛрд░реНрдЯ рдХреА рдПрдХ рд╕рд╛рде рд╕реНрдХреИрдирд┐рдВрдЧ рдХреА рдЬрд╛рддреА рд╣реИ рдФрд░ рдЕрдЧрд▓реЗ рдХреЗ рд▓рд┐рдП 5 рдорд┐рдирдЯ рддрдХ рдЗрдВрддрдЬрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ

\-T1 рдФрд░ T2 --> рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИрдВ рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ 15 рдФрд░ 0.4 рд╕реЗрдХрдВрдб рдХреЗ рдмреАрдЪ рдкреНрд░рддреНрдпреЗрдХ рдкрд░реАрдХреНрд╖рдг рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ

\-T3 --> рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╡реНрдпрд╡рд╣рд╛рд░, рд╕рдорд╛рдирдХрд╛рд▓рд┐рдХ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ

\-T4 --> --max-rtt-timeout 1250ms --min-rtt-timeout 100ms --initial-rtt-timeout 500ms --max-retries 6 --max-scan-delay 10ms

\-T5 --> --max-rtt-timeout 300ms --min-rtt-timeout 50ms --initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m --max-scan-delay 5ms

**Firewall/IDS**

рдкреЛрд░реНрдЯреЛрдВ рдХреЛ рдЧреБрдЬрд╛рд░рдиреЗ рдирд╣реАрдВ рджреЗрддреЗ рдФрд░ рдкреИрдХреЗрдЯреЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддреЗ рд╣реИрдВред

**-f** рдкреИрдХреЗрдЯреЛрдВ рдХреЛ рдлреНрд░реИрдЧрдореЗрдВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╡реЗ 8 рдмрд╛рдЗрдЯ рдХреЗ рдмрд╛рдж рдлреНрд░реИрдЧрдореЗрдВрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕ рдЖрдХрд╛рд░ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдо ..mtu рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ (рдЗрд╕рдХреЗ рд╕рд╛рде, -f рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ), рдСрдлрд╝рд╕реЗрдЯ 8 рдХреЗ рдЧреБрдгрдХ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред **рд╕рдВрд╕реНрдХрд░рдг рдФрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдлреНрд░реИрдЧрдореЗрдВрдЯреЗрд╢рди рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддреЗ**

**-D рдбреЗрдХреЙрдп1,рдбреЗрдХреЙрдп2,рдореИрдВ** Nmap рдЕрдиреНрдп IP рдкрддреЛрдВ рдХреЗ рд╕рд╛рде рд╕реНрдХреИрдирд░ рднреЗрдЬрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдореВрд▓ рдкрддреЗ рдХреЗ рд░реВрдк рдореЗрдВ рдЫреБрдкрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдЖрдк рдореЗрдВ рд╕реВрдЪреА рдореЗрдВ ME рдбрд╛рд▓рддреЗ рд╣реИрдВ, рддреЛ nmap рдЖрдкрдХреЛ рд╡рд╣рд╛рдБ рд╕реНрдерд╛рдирд┐рдд рдХрд░реЗрдЧрд╛, рдЖрдкрдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдорд╛рд╕реНрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ 5 рдпрд╛ 6 рдбреЗрдХреЙрдп рдХреЛ рдбрд╛рд▓рдирд╛ рдмреЗрд╣рддрд░ рд╣реИред RND:\<рд╕рдВрдЦреНрдпрд╛> рдХреЗ рд╕рд╛рде рдпрд╛рджреГрдЪреНрдЫрд┐рдХ IP рдЙрддреНрдкрдиреНрди рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЯреАрд╕реАрдкреА рдХрдиреЗрдХреНрд╢рди рдХреЗ рдмрд┐рдирд╛ рд╕рдВрд╕реНрдХрд░рдг рдбрд┐рдЯреЗрдХреНрдЯрд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддреЗред рдпрджрд┐ рдЖрдк рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рд╕рдХреНрд░рд┐рдп IP рдкрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдХреНрдпреЛрдВрдХрд┐ рдЕрдиреНрдпрдерд╛ рдпрд╣ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реЛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ рдЖрдк рд╣реА рдПрдХрдорд╛рддреНрд░ рд╕рдХреНрд░рд┐рдп рд╣реИрдВред

рдпрд╛рджреГрдЪреНрдЫрд┐рдХ IP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: nmap-D RND: 10 Ip_рд▓рдХреНрд╖реНрдп

**-S IP** рдЬрдм Nmap рдЖрдкрдХрд╛ IP рдкрддрд╛ рдирд╣реАрдВ рдкрдХрдбрд╝рддрд╛ рд╣реИ рддреЛ рдЖрдкрдХреЛ рдЗрд╕реЗ рджреЗрдирд╛ рд╣реЛрдЧрд╛ред рдпрд╣рд╛рдБ рдПрдХ рдФрд░ рд▓рдХреНрд╖реНрдп рдЬреЛ рдЙрдиреНрд╣реЗрдВ рд╕реНрдХреИрди рдХрд░ рд░рд╣рд╛ рд╣реИ, рдЙрд╕реЗ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХ
**--proxies** _**\<рдХреЙрдорд╛-рд╕реЗрдкрд░реЗрдЯреЗрдб рд╕реВрдЪреА рдкреНрд░реЙрдХреНрд╕реА URL>**_ рдкреНрд░реЙрдХреНрд╕реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХрднреА-рдХрднреА рдПрдХ рдкреНрд░реЙрдХреНрд╕реА рдЙрддрдиреЗ рдЦреБрд▓реЗ рдХрдиреЗрдХреНрд╢рди рдирд╣реАрдВ рд░рдЦрддрд╛ рдЬрд┐рддрдиреЗ nmap рдЪрд╛рд╣рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкреИрд░рд╛рд▓реЗрд▓рд┐рдЬрд╝реНрдо рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛: --max-parallelism

**-sP** ARP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛрд╕реНрдЯ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреЛ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рд╣рдо рд╣реИрдВ

рдмрд╣реБрдд рд╕реЗ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдПрдХ рдирд┐рдпрдо рдмрдирд╛рддреЗ рд╣реИрдВ рдЬреЛ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдореЗрдВ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкреЛрд░реНрдЯ рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдкреИрдХреЗрдЯреЛрдВ рдХреЛ рдкрд╛рд░рд┐рдд рдХрд░рдиреЗ рджреЗрддрд╛ рд╣реИ (рдЬреИрд╕реЗ 20, 53 рдФрд░ 67), рд╣рдо nmap рдХреЛ рдпрд╣ рдХрд╣ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╣рдорд╛рд░реЗ рдкреИрдХреЗрдЯ рдЙрди рдкреЛрд░реНрдЯреНрд╕ рд╕реЗ рднреЗрдЬреЗрдВ: **nmap --source-port 53 Ip**

**рдЖрдЙрдЯрдкреБрдЯ**

**-oN рдлрд╝рд╛рдЗрд▓** рд╕рд╛рдорд╛рдиреНрдп рдЖрдЙрдЯрдкреБрдЯ

**-oX рдлрд╝рд╛рдЗрд▓** XML рдЖрдЙрдЯрдкреБрдЯ

**-oS рдлрд╝рд╛рдЗрд▓** рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдбреАрдЬ рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ

**-oG рдлрд╝рд╛рдЗрд▓** grepable рдЖрдЙрдЯрдкреБрдЯ

**-oA рдлрд╝рд╛рдЗрд▓** -oS рдХреЛ рдЫреЛрдбрд╝рдХрд░ рд╕рднреА

**-v рд╕реНрддрд░** рд╡рд░реНрдмреЛрд╕рд┐рдЯреА

**-d рд╕реНрддрд░** рдбреАрдмрдЧрд┐рдВрдЧ

**--reason** рд╣реЛрд╕реНрдЯ рдФрд░ рд╕реНрдерд┐рддрд┐ рдХрд╛ рдХрд╛рд░рдг

**--stats-every рд╕рдордп** рд╣рд░ рдЗрд╕ рд╕рдордп рд╣рдореЗрдВ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИ

**--packet-trace** рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреМрди рд╕реЗ рдкреИрдХреЗрдЯ рдирд┐рдХрд▓ рд░рд╣реЗ рд╣реИрдВ, рдлрд╝рд┐рд▓реНрдЯрд░ рдЬреИрд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ: --version-trace рдпрд╛ --script-trace

**--open** рдЦреБрд▓реЗ, рдЦреБрд▓реЗ|рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдП рдЧрдП рдФрд░ рдЕрдлрд╝рд┐рд▓реНрдЯрд░ рдХреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ

**--resume рдлрд╝рд╛рдЗрд▓** рдПрдХ рд╕рд╛рд░рд╛рдВрд╢ рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИ

**рд╡рд┐рд╡рд┐рдз**

**-6** ipv6 рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ

**-A** -O -sV -sC --traceroute рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ

**рд░рди рдЯрд╛рдЗрдо**

Nmap рдЪрд▓рддреЗ рд╕рдордп рд╣рдо рд╡рд┐рдХрд▓реНрдк рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ:

v / V рд╡рд░реНрдмреЛрд╕рд┐рдЯреА рд╕реНрддрд░ рдмрдврд╝рд╛рдПрдВ / рдХрдо рдХрд░реЗрдВ

d / D рдбреАрдмрдЧрд┐рдВрдЧ рд╕реНрддрд░ рдмрдврд╝рд╛рдПрдВ / рдХрдо рдХрд░реЗрдВ

p / P рдкреИрдХреЗрдЯ рдЯреНрд░реЗрд╕рд┐рдВрдЧ рдХреЛ рдЪрд╛рд▓реВ / рдмрдВрдж рдХрд░реЗрдВ

? рд░рдирдЯрд╛рдЗрдо рдЗрдВрдЯрд░реЗрдХреНрд╢рди рд╕рд╣рд╛рдпрддрд╛ рд╕реНрдХреНрд░реАрди рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВ

**Vulscan**

Nmap рдХрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЬреЛ рдПрдХ рдСрдлрд╝рд▓рд╛рдЗрди рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рджреЗрдЦрддрд╛ рд╣реИ (рдЬреЛ рдЕрдиреНрдп рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ) рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рднреЗрджрднрд╛рд╡ рджреЗрддрд╛ рд╣реИ

рдЙрд╕ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ:

1. Scipvuldb.csv | [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv | [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv | [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv | [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv | [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv | [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv | [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv | [http://www.openvas.org](http://www.openvas.org/)

рдЗрд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ Nmap рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдкреИрдХреЗрдЯ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЙрдиреНрд╣реЗрдВ /usr/share/nmap/scripts/vulscan/ рдореЗрдВ рдЬреЛрдбрд╝рдирд╛ рд╣реЛрдЧрд╛

рдЙрдкрдпреЛрдЧ:

рд╕рднреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: sudo nmap -sV --script=vulscan HOST\_A\_ESCANEAR

рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST\_A\_ESCANEAR

## Nmap рд╕реЗрд╡рд╛ рд╕реНрдХреИрди рдХреЛ рддреЗрдЬрд╝ рдХрд░реЗрдВ x16

рдЗрд╕ [**рдкреЛрд╕реНрдЯ**](https://joshua.hu/nmap-speedup-service-scanning-16x) рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдЖрдк nmap рд╕реЗрд╡рд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреА рдЧрддрд┐ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХреЛ рд╕рднреА **`totalwaitms`** рдорд╛рдиреЛрдВ рдХреЛ **300** рдФрд░ **`tcpwrappedms`** рдХреЛ **200** рдореЗрдВ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдЬреЛ рдкреНрд░реЛрдмреНрд╕ рдХрд╛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд **`servicewaitms`** рдирд╣реАрдВ рд╣реИ, рд╡реЗ рдПрдХ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди **`5000`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рд╣рдо рдЗрди рдкреНрд░реЛрдмреНрд╕ рдореЗрдВ рдорд╛рди рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╛ рд╣рдо **nmap рдХреЛ рдХрдВрдкрд╛рдЗрд▓** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ [**service\_scan.h**](https://github.com/nmap/nmap/blob/master/service\_scan.h#L79) рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред

рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ **`totalwaitms`** рдФрд░ **`tcpwrappedms`** рдХреЗ рдорд╛рдиреЛрдВ рдХреЛ `/usr/share/nmap/nmap-service-probes` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рд╕реЗ рди рдмрджрд▓реЗрдВ, рддреЛ рдЖрдк [рдкрд╛рд░реНрд╕рд┐рдВрдЧ рдХреЛрдб](https://github.com/nmap/nmap/blob/master/service\_scan.cc#L1358) рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ `nmap-service-probes` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдпреЗ рдорд╛рди рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд┐рдП рдЬрд╛рдПрдВред

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ **HackTricks** рдореЗрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
