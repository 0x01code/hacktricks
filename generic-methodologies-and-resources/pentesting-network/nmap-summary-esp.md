# Nmap Sumirano (ESP)

<details>

<summary><strong>Nauƒçite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naƒçini podr≈°ke HackTricks-u:

* Ako ≈æelite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniƒçni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), na≈°u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru≈æite se** üí¨ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
```
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
## Parametri

### IP adrese za skeniranje

* **`<ip>,<net/mask>`:** Oznaƒçava IP adrese direktno
* **`-iL <ips_file>`:** lista_IP-ova
* **`-iR <broj>`**: Broj sluƒçajno odabranih IP adresa, mo≈æete iskljuƒçiti moguƒáe IP adrese sa `--iskljuƒçi <IP adrese>` ili `--iskljuƒçifajl <fajl>`.

### Otkrivanje opreme

Podrazumevano, Nmap pokreƒáe fazu otkrivanja koja se sastoji od: `-PA80 -PS443 -PE -PP`

* **`-sL`**: Nije invazivan, nabraja ciljeve praveƒái **DNS** zahteve za re≈°avanje imena. Korisno je znati da li su svi IP-ovi na primer www.prueba.es/24 na≈°i ciljevi.
* **`-Pn`**: **Bez pinga**. Ovo je korisno ako znate da su svi aktivni (ako ne, mogli biste izgubiti puno vremena, ali ova opcija takoƒëe daje la≈æne negativne rezultate tvrdeƒái da nisu aktivni), spreƒçava fazu otkrivanja.
* **`-sn`** : **Bez skeniranja portova**. Nakon zavr≈°etka faze izviƒëanja, ne skenira portove. Relativno je neprimetan i omoguƒáava mali skeniranje mre≈æe. Sa privilegijama ≈°alje ACK (-PA) na 80, SYN(-PS) na 443 i zahtev za eho i zahtev za vremenski peƒçat, bez privilegija uvek zavr≈°ava konekcije. Ako je cilj mre≈æa, koristi samo ARP(-PR). Ako se koristi sa drugom opcijom, samo se odbacuju paketi druge opcije.
* **`-PR`**: **Ping ARP**. Koristi se podrazumevano prilikom analize raƒçunara u na≈°oj mre≈æi, br≈æi je od kori≈°ƒáenja pingova. Ako ne ≈æelite da koristite ARP pakete, koristite `--po≈°alji-ip`.
* **`-PS <portovi>`**: ≈†alje SYN pakete na koje ako odgovori SYN/ACK, port je otvoren (ako odgovori sa RST kako bi prekinuo konekciju), ako odgovori RST, port je zatvoren, a ako ne odgovori, nedostupan je. U sluƒçaju nedostatka privilegija, automatski se koristi ukupna konekcija. Ako nisu navedeni portovi, ≈°alje se na 80.
* **`-PA <portovi>`**: Kao prethodni, ali sa ACK, kombinovanje oba daje bolje rezultate.
* **`-PU <portovi>`**: Cilj je suprotan, ≈°alju se na portove za koje se oƒçekuje da su zatvoreni. Neki firewalli proveravaju samo TCP konekcije. Ako je zatvoren, odgovara se sa portom nedostupnim, ako se odgovori drugim icmp-om ili ne odgovori, ostaje kao destinacija nedostupna.
* **`-PE, -PP, -PM`** : ICMP PING-ovi: eho odgovor, vremenski peƒçat i maska adrese. Pokreƒáu se kako bi saznali da li je cilj aktivan.
* **`-PY<portovi>`**: ≈†alje SCTP INIT probe na 80 podrazumevano, INIT-ACK(otvoren) ili ABORT(zatvoren) ili ni≈°ta ili ICMP nedostupan(neaktivan) mo≈æe biti odgovor.
* **`-PO <protokoli>`**: Protokol je naznaƒçen u zaglavljima, podrazumevano 1(ICMP), 2(IGMP) i 4(Encap IP). Za ICMP, IGMP, TCP (6) i UDP (17) protokole ≈°alju se zaglavlja protokola, za ostale ≈°alje se samo IP zaglavlje. Svrha ovoga je da zbog deformacije zaglavlja, odgovori na nedostupan protokol ili odgovori istog protokola se ≈°alju kako bi se saznalo da li je aktivan.
* **`-n`**: Bez DNS-a
* **`-R`**: Uvek DNS

### Tehnike skeniranja portova

* **`-sS`**: Ne zavr≈°ava konekciju pa ne ostavlja trag, veoma dobro ako se mo≈æe koristiti (privilegije). Ovo je podrazumevano kori≈°ƒáeno.
* **`-sT`**: Zavr≈°ava konekciju, pa ostavlja trag, ali se mo≈æe koristiti sigurno. Podrazumevano bez privilegija.
* **`-sU`**: Sporije, za UDP. Najƒçe≈°ƒáe: DNS(53), SNMP(161,162), DHCP(67 i 68), (-sU53,161,162,67,68): otvoren(odgovor), zatvoren(port nedostupan), filtriran (drugi ICMP), otvoren/filtriran (ni≈°ta). U sluƒçaju otvoren/filtriran, -sV ≈°alje brojne zahteve kako bi otkrio bilo koju od podr≈æanih verzija koje nmap podr≈æava i mo≈æe otkriti pravo stanje. Znaƒçajno poveƒáava vreme.
* **`-sY`**: SCTP protokol ne uspeva da uspostavi konekciju, pa nema zapisa, radi kao -PY
* **`-sN,-sX,-sF`:** Null, Fin, Xmas, mogu proƒái kroz neke firewalle i izvuƒái informacije. Bazirane su na ƒçinjenici da standardno usklaƒëene ma≈°ine treba da odgovore sa RST na sve zahteve koji nemaju SYN, RST ili ACK oznake podignute: otvoren/filtriran(ni≈°ta), zatvoren(RST), filtriran (ICMP nedostupan). Nepouzdane na Windows-u, CIsco-u, BSDI i OS/400. Na unix-u da.
* **`-sM`**: Maimon skeniranje: ≈†alje FIN i ACK oznake, kori≈°ƒáeno za BSD, trenutno ƒáe sve vratiti kao zatvoreno.
* **`-sA, sW`**: ACK i Prozor, koristi se za otkrivanje firewalla, da bi se saznalo da li su portovi filtrirani ili ne. -sW razlikuje otvorene/zatvorene jer otvoreni odgovaraju sa razliƒçitom vredno≈°ƒáu prozora: otvoren (RST sa prozorom razliƒçitim od 0), zatvoren (RST prozor = 0), filtriran (ICMP nedostupan ili ni≈°ta). Ne svi raƒçunari rade na ovaj naƒçin, pa ako su svi zatvoreni, ne radi, ako su neki otvoreni, radi dobro, a ako su mnogi otvoreni i neki zatvoreni, radi obrnuto.
* **`-sI`:** Idle skeniranje. Za sluƒçajeve kada postoji aktivan firewall, ali znamo da ne filtrira odreƒëenu IP adresu (ili kada jednostavno ≈æelimo anonimnost) mo≈æemo koristiti zombie skener (radi za sve portove), za pronala≈æenje moguƒáih zombija mo≈æemo koristiti skriptu ipidseq ili eksploataciju pomoƒáni/skener/ip/ipidseq. Ovaj skener se zasniva na broju IPID paketa IP adrese.
* **`--badsum`:** ≈†alje pogre≈°an zbir, raƒçunari bi odbacili pakete, ali firewalli bi mogli odgovoriti ne≈°to, koristi se za otkrivanje firewalla.
* **`-sZ`:** "ƒåudan" SCTP skener, prilikom slanja proba sa fragmentima cookie eha, trebali bi biti odbaƒçeni ako su otvoreni ili odgovoreni sa ABORT ako su zatvoreni. Mo≈æe proƒái kroz firewalle kroz koje init ne mo≈æe proƒái, lo≈°a strana je ≈°to ne razlikuje izmeƒëu filtriranih i otvorenih.
* **`-sO`:** Skeniranje protokola Ip. ≈†alje lo≈°a i prazna zaglavlja u kojima se ponekad ne mo≈æe razlikovati ni protokol. Ako stigne ICMP nedostupan protokol, zatvoren je, ako stigne nedostupan port, otvoren je, ako stigne druga gre≈°ka, filtriran je, ako ni≈°ta ne stigne, otvoren|filtriran.
* **`-b <server>`:** FTPhost--> Koristi se za skeniranje hosta sa drugog, to se radi povezivanjem ftp-a druge ma≈°ine i tra≈æenjem da po≈°alje fajlove na portove koje ≈æelite skenirati sa druge ma≈°ine, prema odgovorima saznaƒáemo da li su otvoreni ili ne. \[\<korisnik>:\<≈°ifra>@]\<server>\[:\<port>] Skoro svi ftp serveri vi≈°e ne dozvoljavaju ovo i stoga je od malo praktiƒçne koristi.

### **Analiza portova**

**-p:** Koristi se za odreƒëivanje portova za skeniranje. Za odabir svih 65335: **-p-** ili **-p sve**. Nmap ima internu klasifikaciju prema popularnosti. Podrazumevano koristi prvih 1000. Sa **-F** (brzo skeniranje) analizira prvih 100. Sa **--top-ports \<broj>** Analizira taj broj glavnih portova (od 1 do 65335). Proverava portove u sluƒçajnom redosledu, da se to ne bi dogodilo **-r**. Takoƒëe mo≈æemo odabrati portove: 20-30,80,443,1024- Ovo poslednje znaƒçi da gleda portove od 1024 nadalje. Takoƒëe mo≈æemo grupisati portove po protokolima: U:53,T:21-25,80,139,S:9. Takoƒëe mo≈æemo odabrati opseg unutar popularnih nmap portova: -p \[-1024] analizira do 1024 ukljuƒçenih u nmap-servise. **--port-ratio \<ratio>** Analizira najƒçe≈°ƒáe kori≈°tene portove sa odnosom koji treba biti izmeƒëu 0 i 1

**-sV** Skeniranje verzije, mo≈æe se pode≈°avati intenzitet od 0 do 9, podrazumevano 7.

**--intenzitet-verzije \<broj>** Reguli≈°e intenzitet, tako da ≈°to je ni≈æi, samo ƒáe poslati najverovatnije sonde, ali ne sve. Sa ovim mo≈æemo znaƒçajno skratiti vreme skeniranja UDP

**-O** Detekcija OS-a

**--osscan-limit** Da bi dobro skenirao host, potrebno je da postoji barem jedan otvoren i jedan zatvoren port, ako se ovo ne dogodi i postavili smo ovo, neƒáe poku≈°ati predvideti OS (≈°tedi vreme)
**--osscan-guess** –ö–∞–¥–∞ –¥–µ—Ç–µ–∫—Ü–∏—ò–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥ —Å–∏—Å—Ç–µ–º–∞ –Ω–∏—ò–µ —Å–∞–≤—Ä—à–µ–Ω–∞, –æ–≤–æ –Ω–∞—Å—Ç–∞–≤—ô–∞ —Å–∞ –≤–∏—à–µ –Ω–∞–ø–æ—Ä–∞

**–°—Ü–µ–Ω–∞—Ä–∏—ò–∏**

\--script _\<filename>_|_\<category>_|_\<directory>_|_\<expression>_\[,...]

–ó–∞ –∫–æ—Ä–∏—à—õ–µ—ö–µ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–Ω–∏—Ö, –¥–æ–≤–æ—ô–Ω–æ —ò–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ -sC –∏–ª–∏ --script=default

–í—Ä—Å—Ç–µ —É–∫—ô—É—á—É—ò—É: auth, broadcast, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version, and vuln

* **Auth:** –∏–∑–≤—Ä—à–∞–≤–∞ —Å–≤–µ –¥–æ—Å—Ç—É–ø–Ω–µ —Å—Ü–µ–Ω–∞—Ä–∏—ò–µ –∑–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—ò—É
* **Default:** –∏–∑–≤—Ä—à–∞–≤–∞ –æ—Å–Ω–æ–≤–Ω–µ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–Ω–µ —Å—Ü–µ–Ω–∞—Ä–∏—ò–µ –∞–ª–∞—Ç–∫–µ
* **Discovery:** –ø—Ä–∏–∫—É–ø—ô–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ –æ –º–µ—Ç–∏ –∏–ª–∏ –∂—Ä—Ç–≤–∏
* **External:** —Å—Ü–µ–Ω–∞—Ä–∏—ò –∑–∞ –∫–æ—Ä–∏—à—õ–µ—ö–µ —Å–ø–æ—ô–Ω–∏—Ö —Ä–µ—Å—É—Ä—Å–∞
* **Intrusive:** –∫–æ—Ä–∏—Å—Ç–∏ —Å—Ü–µ–Ω–∞—Ä–∏—ò–µ –∫–æ—ò–∏ —Å–µ —Å–º–∞—Ç—Ä–∞—ò—É –∏–Ω—Ç—Ä—É–∑–∏–≤–Ω–∏–º –∑–∞ –∂—Ä—Ç–≤—É –∏–ª–∏ –º–µ—Ç—É
* **Malware:** –ø—Ä–æ–≤–µ—Ä–∞–≤–∞ –¥–∞ –ª–∏ –ø–æ—Å—Ç–æ—ò–µ –æ—Ç–≤–æ—Ä–µ–Ω–µ –≤–µ–∑–µ –æ–¥ –∑–ª–æ–Ω–∞–º–µ—Ä–Ω–∏—Ö –∫–æ–¥–æ–≤–∞ –∏–ª–∏ –∑–∞–¥—ö–∏—Ö –≤—Ä–∞—Ç–∞
* **Safe:** –∏–∑–≤—Ä—à–∞–≤–∞ —Å—Ü–µ–Ω–∞—Ä–∏—ò–µ –∫–æ—ò–∏ –Ω–∏—Å—É –∏–Ω—Ç—Ä—É–∑–∏–≤–Ω–∏
* **Vuln:** –æ—Ç–∫—Ä–∏–≤–∞ –Ω–∞—ò–ø–æ–∑–Ω–∞—Ç–∏—ò–µ —Ä–∞–Ω—ô–∏–≤–æ—Å—Ç–∏
* **All:** –∏–∑–≤—Ä—à–∞–≤–∞ —Å–≤–µ —Å—Ü–µ–Ω–∞—Ä–∏—ò–µ —Å–∞ NSE –µ–∫—Å—Ç–µ–Ω–∑–∏—ò–æ–º

–ó–∞ –ø—Ä–µ—Ç—Ä–∞–≥—É —Å—Ü–µ–Ω–∞—Ä–∏—ò–∞:

**nmap --script-help="http-\*" -> –û–Ω–∏ –∫–æ—ò–∏ –ø–æ—á–∏—ö—É —Å–∞ http-**

**nmap --script-help="not intrusive" -> –°–≤–∏ –æ—Å–∏–º —Ç–∏—Ö**

**nmap --script-help="default or safe" -> –û–Ω–∏ –∫–æ—ò–∏ —Å—É —É —ò–µ–¥–Ω–æ–º –∏–ª–∏ –¥—Ä—É–≥–æ–º –∏–ª–∏ –æ–±–∞**

**nmap --script-help="default and safe" --> –û–Ω–∏ –∫–æ—ò–∏ —Å—É —É –æ–±–∞**

**nmap --script-help="(default or safe or intrusive) and not http-\*"**

\--script-args _\<n1>_=_\<v1>_,_\<n2>_={_\<n3>_=_\<v3>_},_\<n4>_={_\<v4>_,_\<v5>_}

\--script-args-file _\<filename>_

\--script-help _\<filename>_|_\<category>_|_\<directory>_|_\<expression>_|all\[,...]

\--script-trace ---> –î–∞—ò–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ –æ —Ç–æ–∫—É —Å—Ü–µ–Ω–∞—Ä–∏—ò–∞

\--script-updatedb

**–ó–∞ –∫–æ—Ä–∏—à—õ–µ—ö–µ —Å—Ü–µ–Ω–∞—Ä–∏—ò–∞ —Å–∞–º–æ —Ç—Ä–µ–±–∞ —É–Ω–µ—Ç–∏: namp --script –ò–º–µ\_—Å—Ü–µ–Ω–∞—Ä–∏—ò–∞ —Ü–∏—ô** --> –£–Ω–æ—à–µ—ö–µ–º —Å—Ü–µ–Ω–∞—Ä–∏—ò–∞ –∏–∑–≤—Ä—à–∞–≤–∞—õ–µ —Å–µ –∏ —Å—Ü–µ–Ω–∞—Ä–∏—ò –∏ —Å–∫–µ–Ω–µ—Ä, —Ç–∞–∫–æ –¥–∞ —Å–µ –º–æ–≥—É –¥–æ–¥–∞—Ç–∏ –æ–ø—Ü–∏—ò–µ —Å–∫–µ–Ω–µ—Ä–∞, –º–æ–∂–µ–º–æ –¥–æ–¥–∞—Ç–∏ **‚Äúsafe=1‚Äù** –¥–∞ –±–∏ —Å–µ –∏–∑–≤—Ä—à–∞–≤–∞–ª–∏ —Å–∞–º–æ –±–µ–∑–±–µ–¥–Ω–∏ —Å—Ü–µ–Ω–∞—Ä–∏—ò–∏.

**–ö–æ–Ω—Ç—Ä–æ–ª–∞ –≤—Ä–µ–º–µ–Ω–∞**

**Nmap –º–æ–∂–µ –º–æ–¥–∏—Ñ–∏–∫–æ–≤–∞—Ç–∏ –≤—Ä–µ–º–µ —É —Å–µ–∫—É–Ω–¥–∞–º–∞, –º–∏–Ω—É—Ç–∞–º–∞, ms:** --host-timeout arguments 900000ms, 900, 900s, and 15m —Å–≤–∏ —Ä–∞–¥–µ –∏—Å—Ç—É —Å—Ç–≤–∞—Ä.

Nmap –¥–µ–ª–∏ —É–∫—É–ø–∞–Ω –±—Ä–æ—ò —Ö–æ—Å—Ç–æ–≤–∞ –∑–∞ —Å–∫–µ–Ω–∏—Ä–∞—ö–µ —É –≥—Ä—É–ø–µ –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞ —Ç–µ –≥—Ä—É–ø–µ —É –±–ª–æ–∫–æ–≤–∏–º–∞ —Ç–∞–∫–æ –¥–∞ –¥–æ–∫ —Å–µ —Å–≤–∏ –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞—ò—É, –Ω–µ –ø—Ä–µ–ª–∞–∑–∏ –Ω–∞ —Å–ª–µ–¥–µ—õ–∏ –±–ª–æ–∫ (–∏ –∫–æ—Ä–∏—Å–Ω–∏–∫ —Ç–∞–∫–æ—í–µ –Ω–µ –¥–æ–±–∏—ò–∞ –Ω–∏–∫–∞–∫–≤–æ –∞–∂—É—Ä–∏—Ä–∞—ö–µ –¥–æ–∫ —Å–µ –±–ª–æ–∫ –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞) –Ω–∞ –æ–≤–∞—ò –Ω–∞—á–∏–Ω, –∑–∞ Nmap —ò–µ –æ–ø—Ç–∏–º–∞–ª–Ω–∏—ò–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –≤–µ–ª–∏–∫–µ –≥—Ä—É–ø–µ. –ü–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–Ω–æ –∑–∞ –∫–ª–∞—Å—É C –∫–æ—Ä–∏—Å—Ç–∏ 256.

–ú–æ–∂–µ —Å–µ –ø—Ä–æ–º–µ–Ω–∏—Ç–∏ —Å–∞\*\*--min-hostgroup\*\* _**\<numhosts>**_**;** **--max-hostgroup** _**\<numhosts>**_ (–ü—Ä–∏–ª–∞–≥–æ–¥–∏—Ç–µ –ø–∞—Ä–∞–ª–µ–ª–Ω–µ –≤–µ–ª–∏—á–∏–Ω–µ –≥—Ä—É–ø–∞ —Å–∫–µ–Ω–∏—Ä–∞—ö–∞)

–ú–æ–∂–µ —Å–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Å–∞—Ç–∏ –±—Ä–æ—ò –ø–∞—Ä–∞–ª–µ–ª–Ω–∏—Ö —Å–∫–µ–Ω–µ—Ä–∞, –∞–ª–∏ —ò–µ –±–æ—ô–µ –¥–∞ –Ω–µ (nmpa –≤–µ—õ –∏–º–∞ –∞—É—Ç–æ–º–∞—Ç—Å–∫—É –∫–æ–Ω—Ç—Ä–æ–ª—É –Ω–∞ –æ—Å–Ω–æ–≤—É —Å—Ç–∞—ö–∞ –º—Ä–µ–∂–µ): **--min-parallelism** _**\<numprobes>**_**;** **--max-parallelism** _**\<numprobes>**_

–ú–æ–∂–µ–º–æ –ø—Ä–æ–º–µ–Ω–∏—Ç–∏ rtt —Ç–∞—ò–º–∞—É—Ç, –∞–ª–∏ –æ–±–∏—á–Ω–æ –Ω–∏—ò–µ –ø–æ—Ç—Ä–µ–±–Ω–æ: **--min-rtt-timeout** _**\<time>**_**,** **--max-rtt-timeout** _**\<time>**_**,** **--initial-rtt-timeout** _**\<time>**_

–ú–æ–∂–µ–º–æ –ø—Ä–æ–º–µ–Ω–∏—Ç–∏ –±—Ä–æ—ò –ø–æ–∫—É—à–∞—ò–∞:**--max-retries** _**\<numtries>**_

–ú–æ–∂–µ–º–æ –ø—Ä–æ–º–µ–Ω–∏—Ç–∏ –≤—Ä–µ–º–µ —Å–∫–µ–Ω–∏—Ä–∞—ö–∞ —Ö–æ—Å—Ç–∞: **--host-timeout** _**\<time>**_

–ú–æ–∂–µ–º–æ –ø—Ä–æ–º–µ–Ω–∏—Ç–∏ –≤—Ä–µ–º–µ –∏–∑–º–µ—í—É —Å–≤–∞–∫–æ–≥ —Ç–µ—Å—Ç–∞ –¥–∞ –±—É–¥–µ —Å–ø–æ—Ä–∏—ò–µ: **--scan-delay** _**\<time>**_**;** **--max-scan-delay** _**\<time>**_

–ú–æ–∂–µ–º–æ –ø—Ä–æ–º–µ–Ω–∏—Ç–∏ –±—Ä–æ—ò –ø–∞–∫–µ—Ç–∞ –ø–æ —Å–µ–∫—É–Ω–¥–∏: **--min-rate** _**\<number>**_**;** **--max-rate** _**\<number>**_

–ú–Ω–æ–≥–∏ –ø–æ—Ä—Ç–æ–≤–∏ —Ç—Ä–µ–±–∞—ò—É –¥—É–≥–æ –¥–∞ –æ–¥–≥–æ–≤–æ—Ä–µ —ò–µ—Ä —Å—É —Ñ–∏–ª—Ç—Ä–∏—Ä–∞–Ω–∏ –∏–ª–∏ –∑–∞—Ç–≤–æ—Ä–µ–Ω–∏, –∞–∫–æ –Ω–∞—Å –∑–∞–Ω–∏–º–∞—ò—É —Å–∞–º–æ –æ—Ç–≤–æ—Ä–µ–Ω–∏, –º–æ–∂–µ–º–æ –±—Ä–∂–µ —Å–∞: **--defeat-rst-ratelimit**

–ó–∞ –¥–µ—Ñ–∏–Ω–∏—Å–∞—ö–µ –∞–≥—Ä–µ—Å–∏–≤–Ω–æ—Å—Ç–∏ –Ω–º–∞–ø-–∞: -T paranoid|sneaky|polite|normal|aggressive|insane

\-T (0-1)

\-T0 --> –°–∫–µ–Ω–∏—Ä–∞ —Å–µ —Å–∞–º–æ 1 –ø–æ—Ä—Ç –æ–¥—ò–µ–¥–Ω–æ–º –∏ —á–µ–∫–∞ —Å–µ 5–º–∏–Ω –¥–æ —Å–ª–µ–¥–µ—õ–µ–≥

\-T1 –∏ T2 --> –í—Ä–ª–æ —Å–ª–∏—á–Ω–∏ –∞–ª–∏ —á–µ–∫–∞—ò—É —Å–∞–º–æ 15 –∏ 0,4—Å–µ–∫ –∏–∑–º–µ—í—É —Å–≤–∞–∫–æ–≥ —Ç–µ—Å—Ç–∞

\-T3 --> –ü–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–Ω–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Å–∞—ö–µ, —É–∫—ô—É—á—É—ò–µ –ø–∞—Ä–∞–ª–µ–ª–Ω–æ

\-T4 --> --max-rtt-timeout 1250ms --min-rtt-timeout 100ms --initial-rtt-timeout 500ms --max-retries 6 --max-scan-delay 10ms

\-T5 --> --max-rtt-timeout 300ms --min-rtt-timeout 50ms --initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m --max-scan-delay 5ms

**–ó–∞—à—Ç–∏—Ç–Ω–∏ –∑–∏–¥/IDS**

–ù–µ –¥–æ–∑–≤–æ—ô–∞–≤–∞—ò—É –ø—Ä–æ–ª–∞–∑–∞–∫ –ø–æ—Ä—Ç–æ–≤–∞ –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–∞—ò—É –ø–∞–∫–µ—Ç–µ.

**-f** –ó–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—ò—É –ø–∞–∫–µ—Ç–∞, –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–Ω–æ –∏—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—à–µ –Ω–∞ 8 –±–∞—ò—Ç–æ–≤–∞ –Ω–∞–∫–æ–Ω –∑–∞–≥–ª–∞–≤—ô–∞, –∑–∞ –Ω–∞–≤–æ—í–µ—ö–µ –≤–µ–ª–∏—á–∏–Ω–µ –∫–æ—Ä–∏—Å—Ç–∏–º–æ ..mtu (—Å —Ç–∏–º, –Ω–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ -f), –æ—Ñ—Å–µ—Ç —Ç—Ä–µ–±–∞ –±–∏—Ç–∏ –≤–∏—à–µ—Å—Ç—Ä—É–∫–æ –æ–¥ 8. **–°–∫–µ–Ω–µ—Ä–∏ –≤–µ—Ä–∑–∏—ò–∞ –∏ —Å—Ü–µ–Ω–∞—Ä–∏—ò–∏ –Ω–µ –ø–æ–¥—Ä–∂–∞–≤–∞—ò—É —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—ò—É**

**-D decoy1,decoy2,ME** Nmap —à–∞—ô–µ —Å–∫–µ–Ω–µ—Ä–µ –∞–ª–∏ —Å–∞ –¥—Ä—É–≥–∏–º IP –∞–¥—Ä–µ—Å–∞–º–∞ –∫–∞–æ –∏–∑–≤–æ—Ä, –Ω–∞ —Ç–∞—ò –Ω–∞—á–∏–Ω —Å–µ —Å–∞–∫—Ä–∏–≤–∞—Ç–µ. –ê–∫–æ —Å—Ç–∞–≤–∏—Ç–µ ME –Ω–∞ –ª–∏—Å—Ç—É, nmap —õ–µ –≤–∞—Å —Å—Ç–∞–≤–∏—Ç–∏ —Ç–∞–º–æ, –±–æ—ô–µ —ò–µ —Å—Ç–∞–≤–∏—Ç–∏ 5 –∏–ª–∏ 6 –∏—Å–ø—Ä–µ–¥ –≤–∞—Å –¥–∞ –±–∏—Å—Ç–µ —Å–µ –ø–æ—Ç–ø—É–Ω–æ –º–∞—Å–∫–∏—Ä–∞–ª–∏. –ú–æ–≥—É —Å–µ –≥–µ–Ω–µ—Ä–∏—Å–∞—Ç–∏ —Å–ª—É—á–∞—ò–Ω–µ IP –∞–¥—Ä–µ—Å–µ —Å–∞ RND:\<–±—Ä–æ—ò> –ó–∞ –≥–µ–Ω–µ—Ä–∏—Å–∞—ö–µ \<–±—Ä–æ—ò> —Å–ª—É—á–∞—ò–Ω–∏—Ö IP –∞–¥—Ä–µ—Å–∞. –ù–µ —Ä–∞–¥–µ —Å–∞ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–º –≤–µ—Ä–∑–∏—ò–∞ –±–µ–∑ TCP –≤–µ–∑–µ. –ê–∫–æ —Å—Ç–µ —É–Ω—É—Ç–∞—Ä –º—Ä–µ–∂–µ, –±–æ—ô–µ —ò–µ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ –∞–∫—Ç–∏–≤–Ω–µ IP –∞–¥—Ä–µ—Å–µ, —ò–µ—Ä —õ–µ –∏–Ω–∞—á–µ –±–∏—Ç–∏ –≤–µ–æ–º–∞ –ª–∞–∫–æ –æ—Ç–∫—Ä–∏—Ç–∏ –¥–∞ —Å—Ç–µ —ò–µ–¥–∏–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞.

–ó–∞ –∫–æ—Ä–∏—à—õ–µ—ö–µ —Å–ª—É—á–∞—ò–Ω–∏—Ö IP –∞–¥—Ä–µ—Å–∞: nmap-D RND: 10 Ip\_—Ü–∏—ô

**-S IP** –ö–∞–¥–∞ Nmap –Ω–µ –ø—Ä–∏–º–µ—Ç–∏ –≤–∞—à—É IP –∞–¥—Ä–µ—Å—É, –º–æ—Ä–∞—Ç–µ —ò–æ—ò —ò–µ –¥–∞—Ç–∏ –Ω–∞ –æ–≤–∞—ò –Ω–∞—á–∏–Ω. –¢–∞–∫–æ—í–µ —Å–ª—É–∂–∏ –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏ –¥–∞ –∏–∑–≥–ª–µ–¥–∞ –∫–∞–æ –¥–∞ –ø–æ—Å—Ç–æ—ò–∏ –¥—Ä—É–≥–∏ —Ü–∏—ô –∫–æ—ò–∏ –∏—Ö —Å–∫–µ–Ω–∏—Ä–∞.

**-e \<interface>** –ó–∞ –∏–∑–±–æ—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ—ò—Å–∞

–ú–Ω–æ–≥–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∏ –æ—Å—Ç–∞–≤—ô–∞—ò—É –æ—Ç–≤–æ—Ä–µ–Ω–µ —É–ª–∞–∑–Ω–µ –ø–æ—Ä—Ç–æ–≤–µ –∫–∞–∫–æ –±–∏ —Å–≤–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Å–∞–ª–æ –∏—Å–ø—Ä–∞–≤–Ω–æ –∏ –±–∏–ª–æ –∏–º —ò–µ —ò–µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–∏—ò–µ –Ω–µ–≥–æ —Ç—Ä–∞–∂–∏—Ç–∏ –¥—Ä—É–≥–æ —Ä–µ—à–µ—ö–µ. –û–≤–∏ –ø–æ—Ä—Ç–æ–≤–∏ –º–æ–≥—É –±–∏—Ç–∏ DNS –ø–æ—Ä—Ç–æ–≤–∏ –∏–ª–∏ FTP... –∑–∞ –ø—Ä–µ—Ç—Ä–∞–≥—É –æ–≤–µ —Ä–∞–Ω—ô–∏–≤–æ—Å—Ç–∏ nmap —É–∫—ô—É—á—É—ò–µ: **--source-port** _**\<portnumber>**_**;-g** _**\<portnumber>**_ _–à–µ–¥–Ω–∞–∫–∏ —Å—É_

**--data** _**\<hex string>**_ –ó–∞ —Å–ª–∞—ö–µ —Ö–µ–∫—Å–∞–¥–µ—Ü–∏–º–∞–ª–Ω–æ–≥ —Ç–µ–∫—Å—Ç–∞: --data 0xdeadbeef and --data \xCA\xFE\x09

**--data-string** _**\<string>**_ –ó–∞ —Å–ª–∞—ö–µ –æ–±–∏—á–Ω–æ–≥ —Ç–µ–∫—Å—Ç–∞: --data-string "Scan conducted by Security Ops, extension 7192"

**--data-length** _**\<number>**_ Nmap —à–∞—ô–µ —Å–∞–º–æ –∑–∞–≥–ª–∞–≤—ô–∞, —Å–∞ –æ–≤–∏–º –ø–æ—Å—Ç–∏–∂–µ–º–æ –¥–∞ –¥–æ–¥–∞ –æ–¥—Ä–µ—í–µ–Ω–∏ –±—Ä–æ—ò –±–∞—ò—Ç–æ–≤–∞ (–∫–æ—ò–∏ —õ–µ —Å–µ –≥–µ–Ω–µ—Ä–∏—Å–∞—Ç–∏ –Ω–∞—Å—É–º–∏—á–Ω–æ)

–ó–∞ –ø–æ—Ç–ø—É–Ω–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Å–∞—ö–µ IP –ø–∞–∫–µ—Ç–∞ –∫–æ—Ä–∏—Å—Ç–∏—Ç–∏ **--ip-options**

–ê–∫–æ –∂–µ–ª–∏—Ç–µ –≤–∏–¥–µ—Ç–∏ –æ–ø—Ü–∏—ò–µ —É –ø–æ—Å–ª–∞—Ç–∏–º –∏ –ø—Ä–∏–º—ô–µ–Ω–∏–º –ø–∞–∫–µ—Ç–∏–º–∞, –Ω–∞–≤–µ–¥–∏—Ç–µ --packet-trace. –ó–∞ –≤–∏—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞ –∏ –ø—Ä–∏–º–µ—Ä–∞ –∫–æ—Ä–∏—à—õ–µ—ö–∞ IP –æ–ø—Ü–∏—ò–∞ —Å–∞ Nmap, –≤–∏–¥–µ—Ç–∏ [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52).

**--ttl** _**\<value>**_

**--randomize-hosts** –î–∞ –±–∏ –Ω–∞–ø–∞–¥ –±–∏–æ –º–∞—ö–µ –æ—á–∏–≥–ª–µ–¥–∞–Ω

**--spoof-mac** _**\<MAC address, prefix, or vendor name>**_ –ó–∞ –ø—Ä–æ–º–µ–Ω—É MAC –∞–¥—Ä–µ—Å–µ –ø—Ä–∏–º–µ—Ä–∏: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2, and Cisco
**--proxies** _**\<Zarezom odvojeni spisak URL-ova proxy servera>**_ Za kori≈°ƒáenje proxy servera, ponekad proxy server ne odr≈æava toliko otvorenih veza koliko nmap ≈æeli, pa bi trebalo prilagoditi paralelizam: --max-parallelism

**-sP** Za otkrivanje hostova u mre≈æi u kojoj se nalazimo putem ARP-a

Mnogi administratori postavljaju pravilo u firewall-u koje dozvoljava prolaz svih paketa koji dolaze sa odreƒëenog porta (kao ≈°to su 20, 53 i 67), mo≈æemo reƒái nmap-u da ≈°alje na≈°e pakete sa tih portova: **nmap --source-port 53 IP**

**Izlazi**

**-oN file** Normalan izlaz

**-oX file** XML izlaz

**-oS file** Izlaz za skriptove

**-oG file** Grepable izlaz

**-oA file** Svi osim -oS

**-v level** nivo detaljnosti

**-d level** debagovanje

**--reason** Razlog hosta i stanja

**--stats-every time** Svaki put kada protekne to vreme, prikazuje nam kako ide

**--packet-trace** Za praƒáenje paketa koji se ≈°alju, mogu se specificirati filteri kao ≈°to su: --version-trace ili --script-trace

**--open** prikazuje otvorene, otvorene|filtrirane i ne filtrirane

**--resume file** Pravi rezime

**Razno**

**-6** Dozvoljava ipv6

**-A** isto ≈°to i -O -sV -sC --traceroute

**Vreme izvr≈°avanja**

Dok nmap radi, mo≈æemo menjati opcije:

v / V Poveƒáajte / smanjite nivo detaljnosti

d / D Poveƒáajte / smanjite nivo debagovanja

p / P Ukljuƒçite / iskljuƒçite praƒáenje paketa

? Prikazuje ekran pomoƒái za interakciju u toku izvr≈°avanja

**Vulscan**

Skripta nmap-a koja proverava verzije servisa dobijene iz offline baze podataka (koju preuzima sa drugih veoma va≈ænih) i vraƒáa moguƒáe ranjivosti

Baze podataka koje koristi su:

1. Scipvuldb.csv | [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv | [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv | [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv | [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv | [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv | [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv | [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv | [http://www.openvas.org](http://www.openvas.org/)

Za preuzimanje i instaliranje u Nmap folderu:

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

Takoƒëe treba preuzeti pakete baza podataka i dodati ih u /usr/share/nmap/scripts/vulscan/

Kori≈°ƒáenje:

Za kori≈°ƒáenje svih: sudo nmap -sV --script=vulscan HOST\_A\_ESCANEAR

Za kori≈°ƒáenje odreƒëene baze podataka: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST\_A\_ESCANEAR

## Ubrzanje Nmap skeniranja servisa x16

Prema [**ovom postu**](https://joshua.hu/nmap-speedup-service-scanning-16x) mo≈æete ubrzati analizu servisa nmap-a tako ≈°to ƒáete promeniti sve vrednosti **`totalwaitms`** u **`/usr/share/nmap/nmap-service-probes`** na **300** i **`tcpwrappedms`** na **200**.

Osim toga, sonde koje nemaju posebno definisanu vrednost **`servicewaitms`** koriste podrazumevanu vrednost **`5000`**. Stoga, mo≈æemo dodati vrednosti svakoj sondi ili mo≈æemo **kompajlirati nmap** sami i promeniti podrazumevanu vrednost u [**service\_scan.h**](https://github.com/nmap/nmap/blob/master/service\_scan.h#L79).

Ako ne ≈æelite uop≈°te menjati vrednosti **`totalwaitms`** i **`tcpwrappedms`** u fajlu `/usr/share/nmap/nmap-service-probes`, mo≈æete izmeniti [kod za parsiranje](https://github.com/nmap/nmap/blob/master/service\_scan.cc#L1358) tako da se ove vrednosti u fajlu `nmap-service-probes` potpuno ignori≈°u.

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>Nauƒçite hakovanje AWS-a od poƒçetka do naprednog nivoa sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi naƒçini podr≈°ke HackTricks-u:

* Ako ≈æelite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvaniƒçni PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), na≈°u kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridru≈æite se** üí¨ [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
