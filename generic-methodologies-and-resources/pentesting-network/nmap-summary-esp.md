# R√©sum√© de Nmap (ESP)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
```
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
## Param√®tres

### Adresses IP √† scanner

* **`<ip>,<net/mask>`:** Indique les adresses IP directement.
* **`-iL <ips_file>`:** liste_IPs
* **`-iR <number>`**: Nombre d'adresses IP al√©atoires, vous pouvez exclure les adresses IP possibles avec `--exclude <Ips>` ou `--excludefile <file>`.

### D√©couverte de l'√©quipement

Par d√©faut, Nmap lance une phase de d√©couverte compos√©e de : `-PA80 -PS443 -PE -PP`

* **`-sL`**: Non invasif, il liste les cibles en effectuant des requ√™tes **DNS** pour r√©soudre les noms. Il est utile pour savoir, par exemple, si toutes les adresses IP de www.prueba.es/24 sont nos cibles.
* **`-Pn`**: **Pas de ping**. C'est utile si vous savez qu'elles sont toutes actives (sinon, vous pourriez perdre beaucoup de temps), mais cette option produit √©galement des faux n√©gatifs en indiquant qu'elles ne sont pas actives. Elle emp√™che la phase de d√©couverte.
* **`-sn`** : **Pas de scan de port**. Apr√®s avoir termin√© la phase de reconnaissance, il ne scanne pas les ports. Il est relativement discret et permet un petit scan r√©seau. Avec des privil√®ges, il envoie un ACK (-PA) √† 80, un SYN(-PS) √† 443, une demande d'√©cho et une demande de timestamp. Sans privil√®ges, il termine toujours les connexions. Si la cible est le r√©seau, il utilise uniquement ARP(-PR). S'il est utilis√© avec une autre option, seuls les paquets de l'autre option sont abandonn√©s.
* **`-PR`**: **Ping ARP**. Il est utilis√© par d√©faut lors de l'analyse des ordinateurs de notre r√©seau, il est plus rapide que l'utilisation de pings. Si vous ne voulez pas utiliser les paquets ARP, utilisez `--send-ip`.
* **`-PS <ports>`**: Il envoie des paquets SYN auxquels il r√©pond SYN/ACK s'ils sont ouverts (auxquels il r√©pond avec RST pour ne pas terminer la connexion), s'il r√©pond RST, ils sont ferm√©s et s'il ne r√©pond pas, ils sont injoignables. En cas de manque de privil√®ges, une connexion totale est automatiquement utilis√©e. S'il n'y a pas de ports donn√©s, il les envoie √† 80.
* **`-PA <ports>`**: Comme le pr√©c√©dent, mais avec ACK, la combinaison des deux donne de meilleurs r√©sultats.
* **`-PU <ports>`**: L'objectif est inverse, ils sont envoy√©s √† des ports qui sont cens√©s √™tre ferm√©s. Certains pare-feu ne v√©rifient que les connexions TCP. S'il est ferm√©, il r√©pond avec un port injoignable, s'il r√©pond avec un autre ICMP ou s'il ne r√©pond pas, il est consid√©r√© comme injoignable.
* **`-PE, -PP, -PM`** : PINGS ICMP : r√©ponse d'√©cho, timestamp et masque d'adresse. Ils sont lanc√©s pour savoir si la cible est active.
* **`-PY<ports>`**: Envoie des sondes SCTP INIT √† 80 par d√©faut, peut r√©pondre avec INIT-ACK (ouvert) ou ABORT (ferm√©) ou rien ou ICMP injoignable (inactif).
* **`-PO <protocols>`**: Un protocole est indiqu√© dans les en-t√™tes, par d√©faut 1 (ICMP), 2 (IGMP) et 4 (Encap IP). Pour les protocoles ICMP, IGMP, TCP (6) et UDP (17), les en-t√™tes de protocole sont envoy√©s, pour les autres, seul l'en-t√™te IP est envoy√©. Le but de cela est que, en raison de la malformation des en-t√™tes, une r√©ponse de protocole injoignable ou des r√©ponses du m√™me protocole sont renvoy√©es pour savoir s'il est actif.
* **`-n`**: Pas de DNS
* **`-R`**: Toujours DNS

### Techniques de scan de port

* **`-sS`**: Ne termine pas la connexion, donc ne laisse aucune trace, tr√®s bon si cela peut √™tre utilis√© (privil√®ges). C'est celui utilis√© par d√©faut.
* **`-sT`**: Termine la connexion, donc laisse une trace, mais peut √™tre utilis√© en toute s√©curit√©. Par d√©faut sans privil√®ges.
* **`-sU`**: Plus lent, pour l'UDP. Principalement : DNS(53), SNMP(161,162), DHCP(67 et 68), (-sU53,161,162,67,68) : ouvert(r√©ponse), ferm√©(port injoignable), filtr√© (autre ICMP), ouvert/filtr√© (rien). En cas d'ouvert/filtr√©, -sV envoie de nombreuses requ√™tes pour d√©tecter l'une des versions prises en charge par nmap et peut d√©tecter le v√©ritable √©tat. Cela augmente consid√©rablement le temps.
* **`-sY`**: Le protocole SCTP √©choue √† √©tablir la connexion, donc il n'y a pas de journaux, fonctionne comme -PY.
* **`-sN,-sX,-sF`:** Null, Fin, Xmas, ils peuvent p√©n√©trer certains pare-feu et extraire des informations. Ils sont bas√©s sur le fait que les machines conformes aux normes doivent r√©pondre avec RST √† toutes les demandes qui n'ont pas de drapeaux SYN, RST ou ACK lev√©s : ouvert/filtr√©(rien), ferm√©(RST), filtr√© (ICMP injoignable). Peu fiable sur Windows, Cisco, BSDI et OS/400. Sur Unix, oui.
* **`-sM`**: Scan Maimon : Envoie des drapeaux FIN et ACK, utilis√© pour BSD, actuellement renvoie tout comme ferm√©.
* **`-sA, sW`**: ACK et Window, est utilis√© pour d√©tecter les pare-feu, pour savoir si les ports sont filtr√©s ou non. Le -sW fait la distinction entre ouvert/ferm√© car les ouverts r√©pondent avec une valeur de fen√™tre diff√©rente : ouvert (RST avec une fen√™tre autre que 0), ferm√© (RST fen√™tre = 0), filtr√© (ICMP injoignable ou rien). Tous les ordinateurs ne fonctionnent pas de cette mani√®re, donc s'ils sont tous ferm√©s, cela ne fonctionne pas, s'il y en a quelques-uns d'ouverts, cela fonctionne bien, et s'il y en a beaucoup d'ouverts et peu de ferm√©s, cela fonctionne dans l'autre sens.
* **`-sI`:** Scan en veille. Pour les cas o√π il y a un pare-feu actif mais nous savons qu'il ne filtre pas vers une certaine adresse IP (ou lorsque nous voulons simplement l'anonymat), nous pouvons utiliser le scanner zombie (il fonctionne pour tous les ports) pour rechercher d'√©ventuels zombies, nous pouvons utiliser le script ipidseq ou l'exploit auxiliary/scanner/ip/ipidseq. Ce scanner est bas√© sur le num√©ro IPID des paquets IP.
* **`--badsum`:** Il envoie la somme incorrecte, les ordinateurs rejetteraient les paquets, mais les pare-feu pourraient r√©pondre quelque chose, il est utilis√© pour d√©tecter les pare-feu.
* **`-sZ`:** Scanner SCTP "bizarre", lors de l'envoi de sondes avec des fragments d'√©cho de cookie, ils devraient √™tre abandonn√©s s'ils sont ouverts ou r√©pondus avec ABORT s'ils sont ferm√©s. Il peut passer √† travers les pare-feu que l'init ne peut pas traverser, le probl√®me est qu'il ne fait pas la distinction entre filtr√© et ouvert.
* **`-sO`:** Scan de protocole IP. Envoie des en-t√™tes incorrects et vides dans lesquels parfois m√™me le protocole ne peut pas √™tre distingu√©. Si un protocole injoignable ICMP arrive, il est ferm√©, si un port injoignable arrive, il est ouvert, si une autre erreur arrive, il est filtr√©, s'il n'y a rien, il est ouvert|filtr√©.
* **`-b <server>`:** FTPhost--> Il est utilis√© pour scanner un h√¥te √† partir d'un autre, cela se fait en se connectant au FTP d'une autre machine et en lui demandant d'envoyer des fichiers aux ports que vous souhaitez scanner √† partir d'une autre machine, en fonction des r√©ponses, nous saurons s'ils sont ouverts ou non. \[\<user>:\<password>@]\<server>\[:\<port>] Presque tous les serveurs FTP ne vous permettent plus de le faire et donc cela a peu d'utilit√© pratique.
### **Analyse cibl√©e**

**-p:** Utilis√© pour sp√©cifier les ports √† scanner. Pour s√©lectionner les 65335: **-p-** ou **-p all**. Nmap a une classification interne en fonction de leur popularit√©. Par d√©faut, il utilise les 1000 principaux ports. Avec **-F** (scan rapide), il analyse les 100 principaux ports. Avec **--top-ports \<nombre>**, il analyse ce nombre de ports principaux (de 1 √† 65335). Il v√©rifie les ports dans un ordre al√©atoire pour √©viter cela **-r**. Nous pouvons √©galement s√©lectionner des ports: 20-30,80,443,1024- Cela signifie qu'il regarde √† partir de 1024. Nous pouvons √©galement regrouper les ports par protocoles: U:53,T:21-25,80,139,S:9. Nous pouvons √©galement choisir une plage parmi les ports populaires de nmap: -p \[-1024] analyse jusqu'√† 1024 des ports inclus dans nmap-services. **--port-ratio \<ratio>** Analyse les ports les plus courants selon un ratio qui doit √™tre compris entre 0 et 1.

**-sV** Scan de version, l'intensit√© peut √™tre r√©gl√©e de 0 √† 9, par d√©faut 7.

**--version-intensity \<nombre>** R√©gule l'intensit√©, de sorte que plus elle est basse, seules les sondes les plus probables sont lanc√©es, mais pas toutes. Cela permet de r√©duire consid√©rablement le temps de scan UDP.

**-O** D√©tection de l'OS.

**--osscan-limit** Pour scanner correctement un h√¥te, il faut au moins un port ouvert et un port ferm√©. Si cette condition n'est pas remplie et que nous avons activ√© cela, il n'essaie pas de pr√©dire l'OS (gain de temps).

**--osscan-guess** Lorsque la d√©tection de l'OS n'est pas parfaite, cela lui fait faire plus d'efforts.

**Scripts**

\--script _\<nom_fichier>_|_\<cat√©gorie>_|_\<r√©pertoire>_|_\<expression>_\[,...]

Pour utiliser les scripts par d√©faut, il suffit de mettre -sC ou --script=default.

Les types disponibles sont : auth, broadcast, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version et vuln.

* **Auth:** ex√©cute tous les scripts disponibles pour l'authentification.
* **Default:** ex√©cute les scripts de base par d√©faut de l'outil.
* **Discovery:** r√©cup√®re des informations sur la cible ou la victime.
* **External:** script utilisant des ressources externes.
* **Intrusive:** utilise des scripts consid√©r√©s comme intrusifs pour la victime ou la cible.
* **Malware:** v√©rifie s'il y a des connexions ouvertes par des codes malveillants ou des portes d√©rob√©es.
* **Safe:** ex√©cute des scripts qui ne sont pas intrusifs.
* **Vuln:** d√©couvre les vuln√©rabilit√©s les plus connues.
* **All:** ex√©cute tous les scripts NSE disponibles.

Pour rechercher des scripts :

**nmap --script-help="http-\*" -> Ceux qui commencent par http-**

**nmap --script-help="not intrusive" -> Tous sauf ceux-l√†**

**nmap --script-help="default or safe" -> Ceux qui sont dans l'un ou l'autre ou les deux**

**nmap --script-help="default and safe" --> Ceux qui sont dans les deux**

**nmap --script-help="(default or safe or intrusive) and not http-\*"**

\--script-args _\<n1>_=_\<v1>_,_\<n2>_={_\<n3>_=_\<v3>_},_\<n4>_={_\<v4>_,_\<v5>_}

\--script-args-file _\<nom_fichier>_

\--script-help _\<nom_fichier>_|_\<cat√©gorie>_|_\<r√©pertoire>_|_\<expression>_|all\[,...]

\--script-trace ---> Fournit des informations sur l'ex√©cution du script.

\--script-updatedb

**Pour utiliser un script, il suffit de taper : nmap --script Nom_du_script cible** --> En sp√©cifiant le script, le script et le scanner seront ex√©cut√©s, vous pouvez donc √©galement sp√©cifier des options du scanner. Nous pouvons ajouter **"safe=1"** pour n'ex√©cuter que les scripts consid√©r√©s comme s√ªrs.

**Contr√¥le du temps**

**Nmap peut modifier le temps en secondes, minutes, ms :** --host-timeout arguments 900000ms, 900, 900s et 15m font tous la m√™me chose.

Nmap divise le nombre total d'h√¥tes √† scanner en groupes et analyse ces groupes par blocs, de sorte qu'il ne passe pas au bloc suivant tant que tous les h√¥tes n'ont pas √©t√© analys√©s (et l'utilisateur ne re√ßoit aucune mise √† jour tant que le bloc n'a pas √©t√© analys√©). De cette mani√®re, il est plus efficace pour nmap d'utiliser de grands groupes. Par d√©faut, en classe C, il utilise 256.

Cela peut √™tre modifi√© avec **--min-hostgroup** _**\<nombre_h√¥tes>**_**;** **--max-hostgroup** _**\<nombre_h√¥tes>**_ (Ajuste les tailles des groupes de scan parall√®le).

Le nombre de scanners parall√®les peut √™tre contr√¥l√©, mais il est pr√©f√©rable de ne pas le faire (nmap int√®gre d√©j√† un contr√¥le automatique en fonction de l'√©tat du r√©seau) : **--min-parallelism** _**\<nombre_sondes>**_**;** **--max-parallelism** _**\<nombre_sondes>**_

Nous pouvons modifier le d√©lai d'attente rtt, mais cela n'est g√©n√©ralement pas n√©cessaire : **--min-rtt-timeout** _**\<temps>**_**,** **--max-rtt-timeout** _**\<temps>**_**,** **--initial-rtt-timeout** _**\<temps>**_

Nous pouvons modifier le nombre de tentatives : **--max-retries** _**\<nombre_essais>**_

Nous pouvons modifier le temps de scan d'un h√¥te : **--host-timeout** _**\<temps>**_

Nous pouvons modifier le d√©lai entre chaque test pour ralentir le processus : **--scan-delay** _**\<temps>**_**;** **--max-scan-delay** _**\<temps>**_

Nous pouvons modifier le nombre de paquets par seconde : **--min-rate** _**\<nombre>**_**;** **--max-rate** _**\<nombre>**_

De nombreux ports mettent du temps √† r√©pondre lorsqu'ils sont filtr√©s ou ferm√©s, si nous ne nous int√©ressons qu'aux ports ouverts, nous pouvons aller plus vite avec : **--defeat-rst-ratelimit**

Pour d√©finir l'agressivit√© de nmap : -T paranoid|sneaky|polite|normal|aggressive|insane

\-T (0-1)

\-T0 --> Un seul port est scann√© √† la fois et il attend 5 minutes avant le suivant.

\-T1 et T2 --> Tr√®s similaires mais n'attendent que 15 et 0,4 secondes respectivement entre chaque test.

\-T3 --> Fonctionnement par d√©faut, inclut en parall√®le.

\-T4 --> --max-rtt-timeout 1250ms --min-rtt-timeout 100ms --initial-rtt-timeout 500ms --max-retries 6 --max-scan-delay 10ms

\-T5 --> --max-rtt-timeout 300ms --min-rtt-timeout 50ms --initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m --max-scan-delay 5ms

**Firewall/IDS**

Ils bloquent les ports et analysent les paquets.
**-f** Pour fragmenter les paquets, par d√©faut, ils sont fragment√©s en 8 octets apr√®s l'en-t√™te. Pour sp√©cifier cette taille, nous utilisons ..mtu (avec cela, n'utilisez pas -f), le d√©calage doit √™tre un multiple de 8. Les scanners de version et les scripts ne prennent pas en charge la fragmentation.

**-D decoy1,decoy2,ME** Nmap envoie des scanners mais avec d'autres adresses IP comme origine, de cette fa√ßon, ils vous cachent. Si vous mettez ME dans la liste, nmap vous placera l√†-bas, il vaut mieux mettre 5 ou 6 avant vous pour vous masquer compl√®tement. Vous pouvez g√©n√©rer des adresses IP al√©atoires avec RND:\<nombre> pour g√©n√©rer \<nombre> d'adresses IP al√©atoires. Ils ne fonctionnent pas avec la d√©tection de versions hors connexion TCP. Si vous √™tes dans un r√©seau, il est pr√©f√©rable d'utiliser des adresses IP qui sont actives, sinon il sera tr√®s facile de d√©couvrir que vous √™tes le seul actif.

Pour utiliser des adresses IP al√©atoires : nmap -D RND:10 Ip_cible

**-S IP** Lorsque Nmap ne d√©tecte pas votre adresse IP, vous devez la sp√©cifier avec cela. Cela sert √©galement √† faire croire qu'il y a une autre cible qui les scanne.

**-e \<interface>** Pour choisir l'interface

De nombreux administrateurs laissent des ports d'entr√©e ouverts pour que tout fonctionne correctement et il leur est plus facile de trouver une autre solution. Ceux-ci peuvent √™tre les ports DNS ou FTP... pour rechercher cette vuln√©rabilit√©, nmap inclut : **--source-port** _**\<num√©ro_de_port>**_**;-g** _**\<num√©ro_de_port>**_ _Ce sont des √©quivalents_

**--data** _**\<cha√Æne_hexad√©cimale>**_ Pour envoyer du texte hexad√©cimal : --data 0xdeadbeef et --data \xCA\xFE\x09

**--data-string** _**\<cha√Æne>**_ Pour envoyer un texte normal : --data-string "Scan r√©alis√© par Security Ops, extension 7192"

**--data-length** _**\<nombre>**_ Nmap envoie uniquement les en-t√™tes, avec cela, nous faisons en sorte qu'il ajoute un certain nombre d'octets de plus (qui seront g√©n√©r√©s de mani√®re al√©atoire)

Pour configurer compl√®tement le paquet IP, utilisez **--ip-options**

Si vous souhaitez voir les options dans les paquets envoy√©s et re√ßus, sp√©cifiez --packet-trace. Pour plus d'informations et d'exemples sur l'utilisation des options IP avec Nmap, consultez [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52).

**--ttl** _**\<valeur>**_

**--randomize-hosts** Pour rendre l'attaque moins √©vidente

**--spoof-mac** _**\<adresse_MAC, pr√©fixe ou nom du fournisseur>**_ Pour changer l'adresse MAC, exemples : Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2 et Cisco

**--proxies** _**\<liste_s√©par√©e_par_des_virgules_d'URL_de_proxy>**_ Pour utiliser des proxies, parfois un proxy ne maintient pas autant de connexions ouvertes que nmap le souhaite, il faudrait donc modifier la parall√©lisme : --max-parallelism

**-sP** Pour d√©couvrir les h√¥tes sur le r√©seau via ARP

De nombreux administrateurs cr√©ent une r√®gle dans le pare-feu qui permet de faire passer tous les paquets provenant d'un port particulier (comme le 20, 53 et 67), nous pouvons dire √† nmap d'envoyer nos paquets depuis ces ports : **nmap --source-port 53 Ip**

**Sorties**

**-oN fichier** Sortie normale

**-oX fichier** Sortie XML

**-oS fichier** Sortie pour les script kiddies

**-oG fichier** Sortie au format grepable

**-oA fichier** Toutes sauf -oS

**-v niveau** verbosit√©

**-d niveau** d√©bogage

**--reason** Raison de l'h√¥te et de l'√©tat

**--stats-every temps** Toutes les X secondes, il nous indique l'√©tat d'avancement

**--packet-trace** Pour voir les paquets sortants, des filtres peuvent √™tre sp√©cifi√©s tels que : --version-trace ou --script-trace

**--open** affiche les ports ouverts, ouverts|filtr√©s et non filtr√©s

**--resume fichier** G√©n√®re un r√©sum√©

**Divers**

**-6** Permet l'IPv6

**-A** √©quivaut √† -O -sV -sC --traceroute

**Temps d'ex√©cution**

Pendant l'ex√©cution de nmap, nous pouvons modifier les options :

v / V Augmenter / diminuer le niveau de verbosit√©

d / D Augmenter / diminuer le niveau de d√©bogage

p / P Activer / d√©sactiver la trace des paquets

? Afficher une aide interactive en cours d'ex√©cution

**Vulscan**

Script de nmap qui v√©rifie les versions des services obtenues dans une base de donn√©es hors ligne (t√©l√©charg√©e √† partir d'autres bases de donn√©es tr√®s importantes) et renvoie les vuln√©rabilit√©s possibles.

Les bases de donn√©es utilis√©es sont :

1. Scipvuldb.csv | [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv | [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv | [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv | [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv | [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv | [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv | [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv | [http://www.openvas.org](http://www.openvas.org/)

Pour le t√©l√©charger et l'installer dans le dossier de Nmap :

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

Il faudrait √©galement t√©l√©charger les packages des bases de donn√©es et les ajouter √† /usr/share/nmap/scripts/vulscan/

Utilisation :

Pour utiliser tous les scripts : sudo nmap -sV --script=vulscan HOST_A_ANALYSER

Pour utiliser une base de donn√©es sp√©cifique : sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST_A_ANALYSER
## Acc√©l√©rer l'analyse des services Nmap x16

Selon [**cet article**](https://joshua.hu/nmap-speedup-service-scanning-16x), vous pouvez acc√©l√©rer l'analyse des services Nmap en modifiant toutes les valeurs **`totalwaitms`** dans le fichier **`/usr/share/nmap/nmap-service-probes`** √† **300** et **`tcpwrappedms`** √† **200**.

De plus, les sondes qui n'ont pas de valeur **`servicewaitms`** sp√©cifiquement d√©finie utilisent une valeur par d√©faut de **`5000`**. Par cons√©quent, nous pouvons soit ajouter des valeurs √† chacune des sondes, soit **compiler Nmap** nous-m√™mes et changer la valeur par d√©faut dans [**service\_scan.h**](https://github.com/nmap/nmap/blob/master/service\_scan.h#L79).

Si vous ne souhaitez pas du tout modifier les valeurs de **`totalwaitms`** et **`tcpwrappedms`** dans le fichier `/usr/share/nmap/nmap-service-probes`, vous pouvez modifier le [code d'analyse](https://github.com/nmap/nmap/blob/master/service\_scan.cc#L1358) de mani√®re √† ce que ces valeurs dans le fichier `nmap-service-probes` soient compl√®tement ignor√©es.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
