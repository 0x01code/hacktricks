<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe seus truques de hacking enviando PRs para o [reposit√≥rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
```text
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
**-iL** lista\_IPs

**-iR** numero --&gt; N√∫mero de Ips aleatorias, se pueden excluir posibles Ips con **--exclude &lt;Ips&gt;** o **--excludefile &lt;fichero&gt;**

**Descoberta de equipamentos:**

Podemos usar m√°scaras/24

**-sL**: N√£o √© invasivo, lista os objetivos realizando pedidos de DNS para resolver nomes. Serve para saber se, por exemplo, www.prueba.es/24 todas as Ips s√£o objetivos nossos.

Por defeito, o Nmap lan√ßa uma fase de descoberta que consta de: -PA80 -PS443 -PE -PP

**-Pn** No ping --&gt; √∫til **se se sabe que todos est√£o ativos** \(caso contr√°rio, poderia perder-se muito tempo,
**-f** Para fragmentar paquetes, por padr√£o fragmenta em 8 bytes ap√≥s o cabe√ßalho, para especificar esse tamanho usamos ..mtu \(com isso, n√£o use -f\), o offset deve ser m√∫ltiplo de 8. **Scanners de vers√£o e scripts n√£o suportam fragmenta√ß√£o**

**-D decoy1,decoy2,ME** Nmap envia scanners, mas com outros endere√ßos IP como origem, dessa forma voc√™ se esconde. Se voc√™ colocar o ME na lista, o nmap o colocar√° l√°, √© melhor colocar 5 ou 6 antes de voc√™ para que voc√™ seja completamente mascarado. Voc√™ pode gerar IPs aleat√≥rios com RND:&lt;n√∫mero&gt; Para gerar &lt;n√∫mero&gt; de Ips aleat√≥rios. Eles n√£o funcionam com detec√ß√£o de vers√µes sem conex√£o TCP. Se voc√™ estiver dentro de uma rede, √© interessante usar IPs que estejam ativos, caso contr√°rio, ser√° muito f√°cil descobrir que voc√™ √© o √∫nico ativo.

Para usar Ips aleat√≥rias: nmap-D RND: 10 Ip\_objetivo

**-S IP** Quando o Nmap n√£o detecta seu endere√ßo IP, voc√™ deve fornec√™-lo com isso. Tamb√©m serve para fazer parecer que h√° outro alvo escaneando-os.

**-e &lt;interface&gt;** Para escolher a interface

Muitos administradores deixam portas de entrada abertas para que tudo funcione corretamente e seja mais f√°cil para eles encontrar outra solu√ß√£o. Essas podem ser portas DNS ou FTP... para procurar essa vulnerabilidade, o nmap incorpora: **--source-port** _**&lt;n√∫merodeporta&gt;**_**;-g** _**&lt;n√∫merodeporta&gt;**_ _S√£o equivalentes_

**--data** _**&lt;string hexadecimal&gt;**_ Para enviar texto hexadecimal: --data 0xdeadbeef e --data \xCA\xFE\x09

**--data-string** _**&lt;string&gt;**_ Para enviar um texto normal: --data-string "Scan conducted by Security Ops, extension 7192"

**--data-length** _**&lt;n√∫mero&gt;**_ Nmap envia apenas cabe√ßalhos, com isso conseguimos adicionar a eles um n√∫mero de bytes a mais \(que ser√£o gerados aleatoriamente\)

Para configurar completamente o pacote IP, use **--ip-options**

Se voc√™ deseja ver as op√ß√µes em pacotes enviados e recebidos, especifique --packet-trace. Para obter mais informa√ß√µes e exemplos de uso de op√ß√µes IP com o Nmap, consulte [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52).

**--ttl** _**&lt;valor&gt;**_

**--randomize-hosts** Para que o ataque seja menos √≥bvio

**--spoof-mac** _**&lt;endere√ßo MAC, prefixo ou nome do fornecedor&gt;**_ Para mudar o MAC, exemplos: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2 e Cisco

**--proxies** _**&lt;lista separada por v√≠rgulas de URLs de proxy&gt;**_ Para usar proxies, √†s vezes um proxy n√£o mant√©m tantas conex√µes abertas quanto o nmap deseja, portanto, seria necess√°rio modificar a paralelismo: --max-parallelism

**-sP** Para descobrir hosts na rede em que estamos por ARP

Muitos administradores criam uma regra no firewall que permite passar todos os pacotes que v√™m de uma porta espec√≠fica \(como 20,53 e 67\), podemos dizer ao nmap para enviar nossos pacotes a partir dessas portas: **nmap --source-port 53 Ip**

**Sa√≠das**

**-oN arquivo** Sa√≠da normal

**-oX arquivo** Sa√≠da XML

**-oS arquivo** Sa√≠da de script kidies

**-oG arquivo** Sa√≠da grepable

**-oA arquivo** Todos menos -oS

**-v n√≠vel** verbosidade

**-d n√≠vel** depura√ß√£o

**--reason** Por que do host e estado

**--stats-every tempo** A cada esse tempo, nos diz como vai

**--packet-trace** Para ver quais pacotes saem, voc√™ pode especificar filtros como: --version-trace ou --script-trace

**--open** mostra os abertos, abertos\|filtrados e os n√£o filtrados

**--resume arquivo** Gera um resumo

**Miscel√¢nea**

**-6** Permite ipv6

**-A** √© o mesmo que -O -sV -sC --traceroute

**Tempo de execu√ß√£o**

Enquanto o nmap est√° em execu√ß√£o, podemos alterar as op√ß√µes:

v / V Aumentar / diminuir o n√≠vel de verbosidade

d / D Aumentar / diminuir o n√≠vel de depura√ß√£o

p / P Ativar / desativar o rastreamento de pacotes

? Imprimir uma tela de ajuda de intera√ß√£o em tempo de execu√ß√£o

**Vulscan**

Script do nmap que verifica as vers√µes dos servi√ßos obtidos em um banco de dados offline \(que √© baixado de outros muito importantes\) e retorna as poss√≠veis vulnerabilidades.

Os bancos de dados que ele usa s√£o:

1. Scipvuldb.csv \| [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv \| [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv \| [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv \| [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv \| [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv \| [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv \| [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv \| [http://www.openvas.org](http://www.openvas.org/)

Para baix√°-lo e instal√°-lo na pasta do Nmap:

wget http://www.computec.ch/projekte/vulscan/download/nmap\_nse\_vulscan-2.0.tar.gz && tar -czvf nmap\_nse\_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

Tamb√©m seria necess√°rio baixar os pacotes dos bancos de dados e adicion√°-los a /usr/share/nmap/scripts/vulscan/

Uso:

Para usar todos: sudo nmap -sV --script=vulscan HOST\_A\_ESCANEAR

Para usar um banco de dados espec√≠fico: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST\_A\_ESCANEAR



<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring
