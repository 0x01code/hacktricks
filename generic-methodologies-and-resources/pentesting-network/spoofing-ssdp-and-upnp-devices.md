# EvilSSDPを使用したSSDPおよびUPnPデバイスのスプーフィング

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>でAWSハッキングをゼロからヒーローまで学ぶ</strong></a><strong>！</strong></summary>

* **サイバーセキュリティ企業**で働いていますか？ **HackTricksで企業を宣伝**したいですか？または**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションをご覧ください
* [**公式PEASS＆HackTricksスウェグ**](https://peass.creator-spring.com)を手に入れましょう
* **[💬](https://emojipedia.org/speech-balloon/) [Discordグループ](https://discord.gg/hRep4RUj7f)**に参加するか、[Telegramグループ](https://t.me/peass)に参加するか、**Twitter**で私をフォローする🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**
* **ハッキングトリックを共有するために、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>

**詳細については[https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/)をチェックしてください。**

## **SSDPおよびUPnPの概要**

SSDP（Simple Service Discovery Protocol）は、UDPポート1900で動作し、DHCPやDNSの設定を必要とせずにネットワークサービスの広告と検出に使用されます。これはUPnP（Universal Plug and Play）アーキテクチャで基本的であり、PC、プリンタ、モバイルデバイスなどのネットワークデバイス間のシームレスなやり取りを容易にします。UPnPのゼロ構成ネットワーキングは、デバイスの検出、IPアドレスの割り当て、およびサービスの広告をサポートします。

## **UPnPのフローと構造**

UPnPアーキテクチャには、アドレッシング、検出、記述、制御、イベント、プレゼンテーションの6つのレイヤーが含まれます。最初に、デバイスはIPアドレスを取得するか自己割り当てを試みます（AutoIP）。検出フェーズにはSSDPが関与し、デバイスはアクティブにM-SEARCHリクエストを送信したり、パッシブにNOTIFYメッセージをブロードキャストしてサービスをアナウンスします。クライアントデバイスの相互作用に不可欠な制御レイヤーは、XMLファイル内のデバイス記述に基づいてコマンドの実行にSOAPメッセージを利用します。

## **IGDおよびツールの概要**

IGD（Internet Gateway Device）は、標準のWANインターフェース制限にもかかわらず、NATセットアップで一時的なポートマッピングを可能にし、オープンなSOAPコントロールポイントを介してコマンドを受け入れることを可能にします。**Miranda**のようなツールはUPnPサービスの検出とコマンドの実行を支援します。**Umap**はWANアクセス可能なUPnPコマンドを公開し、**upnp-arsenal**のようなリポジトリはさまざまなUPnPツールを提供します。**Evil SSDP**は、スプーフィングされたUPnPデバイスを介したフィッシングに特化し、合法的なサービスを模倣するためのテンプレートを提供します。

## **Evil SSDPの実用的な使用法**

Evil SSDPは効果的に説得力のある偽のUPnPデバイスを作成し、ユーザーを見た目が本物のサービスとやり取りさせることで操作させます。ユーザーは本物の外観に騙され、資格情報などの機密情報を提供する可能性があります。このツールの柔軟性は、スキャナーやOffice365、さらにはパスワードボルトなどのサービスを模倣するさまざまなテンプレートに及び、ユーザーの信頼とネットワークの可視性を活用します。資格情報を取得した後、攻撃者は被害者を指定されたURLにリダイレクトし、欺瞞の信憑性を維持できます。

## **緩和策**

これらの脅威に対抗するための推奨される対策には次のものがあります：

- 不要な場合はデバイスでUPnPを無効にする。
- ユーザーにフィッシングとネットワークセキュリティについて教育する。
- 暗号化されていない機密データのネットワークトラフィックを監視する。

要するに、UPnPは便利さとネットワークの流動性を提供しますが、潜在的な悪用の可能性も開いてしまいます。ネットワークの整合性を確保するためには、意識と積極的な防御が重要です。
