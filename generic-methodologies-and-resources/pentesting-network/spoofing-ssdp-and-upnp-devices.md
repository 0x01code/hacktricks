# EvilSSDPを使用したSSDPおよびUPnPデバイスのスプーフィング

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> - <a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* **サイバーセキュリティ企業**で働いていますか？ **HackTricksで企業を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[NFTs](https://opensea.io/collection/the-peass-family)のコレクションを入手してください
* [**公式PEASS＆HackTricks swag**](https://peass.creator-spring.com)を手に入れましょう
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で **🐦**[**@carlospolopm**](https://twitter.com/hacktricks_live)**をフォロー**してください。
* **[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出して、あなたのハッキングトリックを共有してください。

</details>

**詳細については、[https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/)をチェックしてください。**

## **SSDP＆UPnP概要**

SSDP（Simple Service Discovery Protocol）は、UDPポート1900で動作し、DHCPやDNSの設定を必要とせずにネットワークサービスの広告と検出に使用されます。これはUPnP（Universal Plug and Play）アーキテクチャで基本的であり、PC、プリンタ、モバイルデバイスなどのネットワークデバイス間のシームレスなやり取りを容易にします。UPnPのゼロ構成ネットワーキングは、デバイスの検出、IPアドレスの割り当て、およびサービスの広告をサポートします。

## **UPnPフロー＆構造**

UPnPアーキテクチャには、アドレッシング、検出、説明、制御、イベント、プレゼンテーションの6つのレイヤーが含まれます。最初に、デバイスはIPアドレスを取得するか自己割り当てを試みます（AutoIP）。検出フェーズにはSSDPが関与し、デバイスはアクティブにM-SEARCHリクエストを送信したり、サービスをアナウンスするためにパッシブにNOTIFYメッセージをブロードキャストします。クライアントデバイス間の重要な相互作用に不可欠な制御レイヤーは、XMLファイル内のデバイスの説明に基づいてコマンドを実行するためにSOAPメッセージを利用します。

## **IGD＆ツール概要**

IGD（Internet Gateway Device）は、標準のWANインターフェース制限にもかかわらず、NATセットアップで一時的なポートマッピングを可能にし、オープンなSOAPコントロールポイントを介してコマンドを受け入れることを許可します。**Miranda**のようなツールはUPnPサービスの検出とコマンドの実行を支援します。**Umap**はWANアクセス可能なUPnPコマンドを公開し、**upnp-arsenal**のようなリポジトリはさまざまなUPnPツールを提供します。**Evil SSDP**は、スプーフィングされたUPnPデバイスを介したフィッシングに特化し、合法的なサービスを模倣するためのテンプレートをホスティングします。

## **Evil SSDPの実用的な使用法**

Evil SSDPは、説得力のある偽のUPnPデバイスを効果的に作成し、ユーザーを本物のサービスとやり取りさせることで操作を行わせます。ユーザーは、本物の外観に騙され、資格情報などの機密情報を提供する可能性があります。このツールの柔軟性は、スキャナーやOffice365、パスワードボルトなどのサービスを模倣するさまざまなテンプレートに及び、ユーザーの信頼とネットワークの可視性を活用します。資格情報を取得した後、攻撃者は被害者を指定されたURLにリダイレクトし、欺瞞の信憑性を維持できます。

## **緩和策**

これらの脅威に対抗するための推奨される対策には、次のものがあります：

- 不要な場合はデバイスでUPnPを無効にする。
- フィッシングやネットワークセキュリティについてユーザーに教育する。
- 暗号化されていない機密データのネットワークトラフィックを監視する。

要するに、UPnPは便利さとネットワークの流動性を提供しますが、潜在的な悪用の可能性も開いてしまいます。ネットワークの整合性を確保するためには、意識と積極的な防御が重要です。
