# Falsificação de Dispositivos SSDP e UPnP com EvilSSDP

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* Você trabalha em uma **empresa de cibersegurança**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou quer ter acesso à **última versão do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Família PEASS**](https://opensea.io/collection/the-peass-family), nossa coleção exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**💬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o [repositório hacktricks](https://github.com/carlospolop/hacktricks) e [repositório hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

**Confira [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) para mais informações.**

## **Visão Geral de SSDP & UPnP**

O SSDP (Protocolo de Descoberta de Serviço Simples) é utilizado para publicidade e descoberta de serviços de rede, operando na porta UDP 1900 sem a necessidade de configurações DHCP ou DNS. É fundamental na arquitetura UPnP (Plug and Play Universal), facilitando a interação contínua entre dispositivos em rede como PCs, impressoras e dispositivos móveis. A rede de configuração zero do UPnP suporta descoberta de dispositivos, atribuição de endereços IP e publicidade de serviços.

## **Fluxo e Estrutura do UPnP**

A arquitetura UPnP é composta por seis camadas: endereçamento, descoberta, descrição, controle, eventos e apresentação. Inicialmente, os dispositivos tentam obter um endereço IP ou atribuir um automaticamente (AutoIP). A fase de descoberta envolve o SSDP, com dispositivos enviando ativamente solicitações M-SEARCH ou transmitindo passivamente mensagens NOTIFY para anunciar serviços. A camada de controle, vital para a interação cliente-dispositivo, utiliza mensagens SOAP para execução de comandos com base em descrições de dispositivos em arquivos XML.

## **Visão Geral de IGD e Ferramentas**

O IGD (Dispositivo de Gateway de Internet) facilita mapeamentos temporários de portas em configurações NAT, permitindo a aceitação de comandos via pontos de controle SOAP abertos apesar das restrições padrão da interface WAN. Ferramentas como **Miranda** auxiliam na descoberta de serviços UPnP e execução de comandos. **Umap** expõe comandos UPnP acessíveis pela WAN, enquanto repositórios como **upnp-arsenal** oferecem uma variedade de ferramentas UPnP. **Evil SSDP** se especializa em phishing por meio de dispositivos UPnP falsificados, hospedando modelos para imitar serviços legítimos.

## **Uso Prático do Evil SSDP**

O Evil SSDP cria efetivamente dispositivos UPnP falsos convincentes, manipulando usuários para interagir com serviços aparentemente autênticos. Usuários, enganados pela aparência genuína, podem fornecer informações sensíveis como credenciais. A versatilidade da ferramenta se estende a vários modelos, imitando serviços como scanners, Office365 e até cofres de senhas, capitalizando a confiança do usuário e a visibilidade da rede. Após a captura de credenciais, os atacantes podem redirecionar as vítimas para URLs designados, mantendo a credibilidade da decepção.

## **Estratégias de Mitigação**

Para combater essas ameaças, medidas recomendadas incluem:

- Desativar o UPnP em dispositivos quando não necessário.
- Educar os usuários sobre phishing e segurança de rede.
- Monitorar o tráfego de rede em busca de dados sensíveis não criptografados.

Em essência, enquanto o UPnP oferece conveniência e fluidez de rede, também abre portas para possíveis explorações. Consciência e defesa proativa são essenciais para garantir a integridade da rede.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* Você trabalha em uma **empresa de cibersegurança**? Gostaria de ver sua **empresa anunciada no HackTricks**? ou quer ter acesso à **última versão do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Família PEASS**](https://opensea.io/collection/the-peass-family), nossa coleção exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**💬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o [repositório hacktricks](https://github.com/carlospolop/hacktricks) e [repositório hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
