# 通过EvilSSDP欺骗SSDP和UPnP设备

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> - <a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* 您在**网络安全公司**工作吗？想要在HackTricks中看到您的**公司广告**？或者想要访问**PEASS的最新版本或下载HackTricks的PDF**？请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 发现我们的独家[NFTs收藏品**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* 获取[**官方PEASS & HackTricks周边**](https://peass.creator-spring.com)
* **加入** [**💬**](https://emojipedia.org/speech-balloon/) [**Discord群**](https://discord.gg/hRep4RUj7f) 或 [**电报群**](https://t.me/peass) 或在**Twitter**上**🐦**[**@carlospolopm**](https://twitter.com/hacktricks_live)**上关注**我。
* 通过向[hacktricks repo](https://github.com/carlospolop/hacktricks)和[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)提交PR来分享您的黑客技巧。

</details>

**查看[https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/)获取更多信息。**

## **SSDP & UPnP概述**

SSDP（简单服务发现协议）用于网络服务的广告和发现，运行在UDP端口1900上，无需DHCP或DNS配置。它在UPnP（通用即插即用）架构中起着基础作用，促进了计算机、打印机和移动设备等网络设备之间的无缝交互。UPnP的零配置网络支持设备发现、IP地址分配和服务广告。

## **UPnP流程和结构**

UPnP架构包括六个层：寻址、发现、描述、控制、事件和呈现。最初，设备尝试获取IP地址或自动分配一个（AutoIP）。发现阶段涉及SSDP，设备主动发送M-SEARCH请求或被动广播NOTIFY消息以宣布服务。控制层对于客户端-设备交互至关重要，利用基于XML文件中设备描述的SOAP消息执行命令。

## **IGD和工具概述**

IGD（Internet Gateway Device）在NAT设置中支持临时端口映射，允许通过开放的SOAP控制点接受命令，尽管标准WAN接口有限制。像**Miranda**这样的工具有助于UPnP服务发现和命令执行。**Umap**公开了可通过WAN访问的UPnP命令，而像**upnp-arsenal**这样的存储库提供了各种UPnP工具。**Evil SSDP**专门用于通过欺骗的UPnP设备进行网络钓鱼，提供了模板来模仿合法服务。

## **Evil SSDP的实际用途**

Evil SSDP有效地创建了令人信服的虚假UPnP设备，诱使用户与看似真实的服务进行交互。用户被真实外观欺骗，可能提供诸如凭据之类的敏感信息。该工具的多功能性延伸到各种模板，模仿扫描仪、Office365甚至密码保险库等服务，利用用户的信任和网络可见性。在捕获凭据后，攻击者可以将受害者重定向到指定的URL，保持欺骗的可信度。

## **缓解策略**

为了应对这些威胁，建议采取以下措施：

- 在不需要时关闭设备上的UPnP。
- 教育用户有关网络钓鱼和网络安全。
- 监控网络流量以防止未加密的敏感数据泄露。

总的来说，虽然UPnP提供了便利和网络流动性，但也为潜在利用敞开了大门。意识和积极的防御是确保网络完整性的关键。 

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> - <a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* 您在**网络安全公司**工作吗？想要在HackTricks中看到您的**公司广告**？或者想要访问**PEASS的最新版本或下载HackTricks的PDF**？请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 发现我们的独家[NFTs收藏品**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* 获取[**官方PEASS & HackTricks周边**](https://peass.creator-spring.com)
* **加入** [**💬**](https://emojipedia.org/speech-balloon/) [**Discord群**](https://discord.gg/hRep4RUj7f) 或 [**电报群**](https://t.me/peass) 或在**Twitter**上**🐦**[**@carlospolopm**](https://twitter.com/hacktricks_live)**上关注**我。
* 通过向[hacktricks repo](https://github.com/carlospolop/hacktricks)和[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)提交PR来分享您的黑客技巧。

</details>
