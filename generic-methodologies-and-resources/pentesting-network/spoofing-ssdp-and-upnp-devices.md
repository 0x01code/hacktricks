# Spoofing SSDP e dispositivi UPnP con EvilSSDP

<details>

<summary><strong>Impara l'hacking di AWS da zero a esperto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Lavori in una **azienda di sicurezza informatica**? Vuoi vedere la tua **azienda pubblicizzata su HackTricks**? O vuoi avere accesso all'**ultima versione di PEASS o scaricare HackTricks in PDF**? Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* **Unisciti al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguimi** su **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR al [repo di hacktricks](https://github.com/carlospolop/hacktricks) e al [repo di hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

**Controlla [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) per ulteriori informazioni.**

## **Panoramica di SSDP e UPnP**

SSDP (Simple Service Discovery Protocol) viene utilizzato per la pubblicit√† e la scoperta dei servizi di rete, operando sulla porta UDP 1900 senza bisogno di configurazioni DHCP o DNS. √à fondamentale nell'architettura UPnP (Universal Plug and Play), facilitando l'interazione senza soluzione di continuit√† tra dispositivi in rete come PC, stampanti e dispositivi mobili. La rete a configurazione zero di UPnP supporta la scoperta dei dispositivi, l'assegnazione degli indirizzi IP e la pubblicit√† dei servizi.

## **Flusso e struttura di UPnP**

L'architettura UPnP comprende sei livelli: indirizzamento, scoperta, descrizione, controllo, eventi e presentazione. Inizialmente, i dispositivi cercano di ottenere un indirizzo IP o lo assegnano automaticamente (AutoIP). La fase di scoperta coinvolge SSDP, con i dispositivi che inviano attivamente richieste M-SEARCH o trasmettono passivamente messaggi NOTIFY per annunciare i servizi. Il livello di controllo, fondamentale per l'interazione tra client e dispositivo, utilizza messaggi SOAP per l'esecuzione di comandi basati sulle descrizioni dei dispositivi presenti nei file XML.

## **Panoramica di IGD e strumenti**

IGD (Internet Gateway Device) facilita la mappatura temporanea delle porte nelle configurazioni NAT, consentendo l'accettazione dei comandi tramite punti di controllo SOAP aperti nonostante le restrizioni dell'interfaccia WAN standard. Strumenti come **Miranda** aiutano nella scoperta dei servizi UPnP e nell'esecuzione dei comandi. **Umap** espone i comandi UPnP accessibili tramite WAN, mentre repository come **upnp-arsenal** offrono una serie di strumenti UPnP. **Evil SSDP** si specializza nel phishing tramite dispositivi UPnP contraffatti, ospitando modelli per imitare servizi legittimi.

## **Utilizzo pratico di Evil SSDP**

Evil SSDP crea efficacemente dispositivi UPnP falsi convincenti, manipolando gli utenti affinch√© interagiscano con servizi apparentemente autentici. Gli utenti, ingannati dall'aspetto genuino, potrebbero fornire informazioni sensibili come credenziali. La versatilit√† dello strumento si estende a vari modelli, imitando servizi come scanner, Office365 e persino password vaults, sfruttando la fiducia dell'utente e la visibilit√† di rete. Dopo la cattura delle credenziali, gli attaccanti possono reindirizzare le vittime verso URL designati, mantenendo la credibilit√† dell'inganno.

## **Strategie di mitigazione**

Per contrastare queste minacce, le misure consigliate includono:

- Disabilitare UPnP sui dispositivi quando non √® necessario.
- Educare gli utenti sul phishing e sulla sicurezza di rete.
- Monitorare il traffico di rete per dati sensibili non crittografati.

In sostanza, sebbene UPnP offra comodit√† e fluidit√† di rete, apre anche porte a potenziali sfruttamenti. La consapevolezza e la difesa proattiva sono fondamentali per garantire l'integrit√† della rete.

<details>

<summary><strong>Impara l'hacking di AWS da zero a esperto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Lavori in una **azienda di sicurezza informatica**? Vuoi vedere la tua **azienda pubblicizzata su HackTricks**? O vuoi avere accesso all'**ultima versione di PEASS o scaricare HackTricks in PDF**? Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* **Unisciti al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguimi** su **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR al [repo di hacktricks](https://github.com/carlospolop/hacktricks) e al [repo di hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
