<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ企業**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見しましょう。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)にPRを提出してください。**

</details>


# IPv6基本理論

## ネットワーク

IPv6アドレスでは、**最初の48ビットがネットワークプレフィックス**です。**次の16ビットはサブネットID**であり、サブネットを定義するために使用されます。最後の**64ビットはインターフェース識別子**（またはインターフェースIDまたはデバイスIDとも呼ばれる）です。必要に応じて、通常デバイスIDに予約されているビットは、追加のサブネットマスキングに使用できます。

IPv6にはARPはありません。代わりに、**ICMPv6 NS（Neighbor Solicitation）とNA（Neighbor Advertisement）**があります。**NS**はアドレスを解決するために使用され、**マルチキャスト**パケットを送信します。**NA**は**ユニキャスト**であり、NSに応答するために使用されます。NAパケットはNSパケットを必要とせずに送信することもあります。

**0:0:0:0:0:0:0:1** = 1（IPv4の127.0.0.1と同等） - これはIPv6の127.0.0.1と同等です。

**リンクローカルアドレス：**これらはインターネット上でルーティングされることを意図していないプライベートアドレスです。これらは、プライベートまたは一時的なLANでのファイルの共有と配布のために、LAN上のデバイス間でローカルに使用することができます。この種のアドレスを使用しているローカルLANの他のデバイスは、マルチキャストアドレスff02::01にpingを送信することで見つけることができます。\
**FE80::/10** - リンクローカルユニキャストアドレス範囲。
```bash
ping6 –I eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

#Or you could also use
alive6 eth0
```
もし、自分と同じネットワーク内にあるホストのMACアドレスを知っている場合（そのホストのIPv4アドレスにpingを送信し、arpテーブルを表示してMACアドレスを確認できます）、そのホストと通信するためにリンクローカルアドレスを計算することができます。
ホストのMACアドレスが`12:34:56:78:9a:bc`であると仮定します。

1. IPv6表記に変換します：`1234:5678:9abc`
2. 先頭に`fe80::`を追加し、中央に`fffe`を挿入します：`fe80::`**`1234:56`**`ff:fe`**`78:9abc`
3. 左から7番目のビットを反転させ、0001 0010から0001 0000に変更します：`fe80::1`**`0`**`34:56ff:fe78:9abc`
4. `fe80::1034:56ff:fe78:9abc`

**ユニークローカルアドレス**：このタイプのIPv6アドレスは、公共インターネット上でルーティングされることを意図していません。ユニークローカルアドレスは、サイト内での通信を可能にしながら、複数のローカルネットワークに対してルーティング可能なアドレスです。
**FEC00::/7** - ユニークローカルアドレスの範囲です。

**マルチキャストアドレス**：これはワン対多とも呼ばれます。マルチキャストアドレス宛てのパケットは、マルチキャストアドレスで識別されるすべてのインターフェースに配信されます。マルチキャストアドレスのタイプは、通常FFで始まるため、簡単に識別できます。
**FF00::/8** - マルチキャスト範囲です。

**エニーキャスト**：この形式のIPv6アドレスは、わずかな違いがあるマルチキャストアドレスに似ています。エニーキャストアドレスは、複数のインターフェースに対してパケットを送信するために使用されますが、通常はルーティングプロトコルで定義されたルーティング距離に従って最初のインターフェースにパケットを送信します。つまり、ルーティングプロトコルによって決定される最も近いインターフェースにパケットを送信します。
**20000::/3** - グローバルユニキャストアドレスの範囲です。

fe80::/10--> ユニークリンクローカル（169.254.x.x）\[fe80:0000:0000:0000:0000:0000:0000:0000,febf:ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff]\
fc00::/7 --> ユニークローカルユニキャスト（10.x.x.x、172.16.x.x、192.168.x.x）\[]\
2000::/3 --> グローバルユニキャスト\
ff02::1 --> マルチキャスト全ノード\
ff02::2 --> マルチキャストルーターノード

## **マシンのIPv6を推測する**

**方法1**

fe80::/10のIPv6はMACに基づいています。ネットワーク内のデバイスのIPv6を持っており、ネットワーク内の別のデバイスのIPv6を推測したい場合、pingを使用してそのデバイスのMACアドレスを取得できます（arpテーブル内）。

**方法2**

マルチキャストにping6を送信し、arpテーブル内のIPv6アドレスを取得することもできます。
```bash
service ufw stop #Stop firewall
ping6 -I <IFACE> ff02::1 #You could also make: ping6 -I <IPV6> ff02::1 if you want to make a ping to a specific IP Address
ip -6 neigh
alive6
use auxiliary/scanner/discovery/ipv6_neighbor_router_advertisement; set INTERFACE eth1; run
```
# IPv6 MitM

IPv6の中間者攻撃（MitM）は、偽のICMPv6ネイバーアドバタイズメントを使用します。

* 偽のICMPv6ルーターアドバタイズメントを使用した中間者攻撃
* ICMPv6リダイレクトまたはICMPv6 too bigを使用した中間者攻撃によるルートの埋め込み
* モバイルIPv6を攻撃する中間者攻撃ですが、ipsecが無効になっている必要があります。
* 偽のDHCPv6サーバーを使用した中間者攻撃

# 野生のIPv6アドレスの発見

## サブドメイン

Googleや他のブラウザを使用して、"ipv6.\*"のようなサブドメインを検索することができます。
```bash
site:ipv6./
```
## DNS

DNSで"**AXFR**"(ゾーン転送)、"**AAAA**"(IPv6)、または"**ANY**" (すべて)のレジストリを検索してIPv6アドレスを見つけることもできます。

## Ping6

組織のいくつかのIPv6デバイスが見つかったら、`ping6`を使用して近くのアドレスをチェックすることができます。

# 参考文献

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ企業**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- **[💬](https://emojipedia.org/speech-balloon/) Discordグループ**に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で**フォロー**するか、[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**を**。

- **ハッキングのトリックを共有するには、[hacktricksのリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudのリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>
