<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>


# Teor√≠a b√°sica de IPv6

## Redes

En una direcci√≥n IPv6, los **primeros 48 bits son el prefijo de red**. Los **pr√≥ximos 16 bits son el ID de subred** y se utilizan para definir subredes. Los √∫ltimos **64 bits son el identificador de interfaz** (tambi√©n conocido como ID de interfaz o ID de dispositivo, es para dispositivos). Si es necesario, los bits que normalmente est√°n reservados para el ID de dispositivo se pueden utilizar para enmascaramiento de subredes adicionales.

No hay ARP en IPv6. En su lugar, hay **ICMPv6 NS (Solicitud de vecino) y NA (Anuncio de vecino)**. El **NS** se utiliza para resolver una direcci√≥n, por lo que env√≠a paquetes **multidifusi√≥n**. El **NA** es **unidifusi√≥n** y se utiliza para responder al NS. Un paquete NA tambi√©n podr√≠a enviarse sin necesidad de un paquete NS.

**0:0:0:0:0:0:0:1** = 1 (`::1` de forma abreviada)  ‚Äì Esto es equivalente a 127.0.0.1 en IPv4.

**Direcciones de enlace local:** Estas son direcciones privadas que no est√°n destinadas a ser enrutadas en Internet. Pueden ser utilizadas localmente por LAN privadas o temporales para compartir y distribuir archivos entre dispositivos en la LAN. Otros dispositivos en tu LAN local que utilicen este tipo de direcciones pueden encontrarse enviando un ping a la direcci√≥n de multidifusi√≥n ff02::01\
**FE80::/10**  ‚Äì Rango de direcciones unicast de enlace local.
```bash
ping6 ‚ÄìI eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

#Or you could also use
alive6 eth0
```
Si **conoces la direcci√≥n MAC de un host en la misma red** que t√∫ (podr√≠as simplemente hacer ping a su direcci√≥n ipv4 y ver la tabla arp para encontrar su direcci√≥n MAC), puedes calcular su direcci√≥n Link-local para comunicarte con √©l.\
Supongamos que la **direcci√≥n MAC** es **`12:34:56:78:9a:bc`**

1. A notaci√≥n IPv6: **`1234:5678:9abc`**
2. Agrega `fe80::` al principio e inserta `fffe` en el medio: **`fe80::`**`1234:56`**`ff:fe`**`78:9abc`
3. Invierte el s√©ptimo bit de la izquierda, de 0001 0010 a 0001 0000: `fe80::1`**`0`**`34:56ff:fe78:9abc`
4. `fe80::1034:56ff:fe78:9abc`

**Direcci√≥n local √∫nica:** Este tipo de direcci√≥n IPv6 tampoco est√° destinada a ser enrutada en Internet p√∫blico. La direcci√≥n local √∫nica es un reemplazo de la direcci√≥n de sitio local, que permite la comunicaci√≥n dentro de un sitio mientras es enrutada a m√∫ltiples redes locales.\
**FEC00::/7**  ‚Äì El rango de direcciones locales √∫nicas.

**Direcci√≥n de multidifusi√≥n:** Tambi√©n puede ser referida como Uno a Muchos. Los paquetes dirigidos a una direcci√≥n de multidifusi√≥n se entregan a todas las interfaces identificadas por la direcci√≥n de multidifusi√≥n. Los tipos de direcciones de multidifusi√≥n son f√°cilmente identificables porque normalmente comienzan con FF.\
**FF00::/8**  ‚Äì El rango de direcciones de multidifusi√≥n.

**Anycast:** Esta forma de direcci√≥n IPv6 es similar a la direcci√≥n de multidifusi√≥n con una ligera diferencia. La direcci√≥n anycast tambi√©n puede ser referida como Uno al M√°s Cercano. Puede ser utilizada para dirigir paquetes destinados a m√∫ltiples interfaces; pero normalmente env√≠a paquetes a la primera interfaz que encuentra seg√∫n la distancia de enrutamiento. Esto significa que env√≠a paquetes a la interfaz m√°s cercana seg√∫n lo determinen los protocolos de enrutamiento.\
**20000::/3**  ‚Äì El rango de direcciones unicast global.

fe80::/10--> √önica Link-Local (169.254.x.x) \[fe80:0000:0000:0000:0000:0000:0000:0000,febf:ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff]\
fc00::/7 --> √önica Local-Unicast (10.x.x.x, 172.16.x.x, 192.168.x.x) \[]\
2000::/3 --> Unicast Global\
ff02::1 --> Multidifusi√≥n Todos los Nodos\
ff02::2 --> Multidifusi√≥n Nodos de Enrutador

## **Adivina la IPv6 de una m√°quina**

**Forma 1**

Las IPv6 de fe80::/10 se basan en la MAC. Si tienes la IPv6 de un dispositivo dentro de una red y quieres adivinar la IPv6 de otro dispositivo de la red, puedes obtener su direcci√≥n MAC usando un ping (dentro de la tabla arp).

**Forma 2**

Puedes enviar un ping6 a la multidifusi√≥n y obtener la direcci√≥n IPv6 dentro de la tabla arp.
```bash
service ufw stop #Stop firewall
ping6 -I <IFACE> ff02::1 #You could also make: ping6 -I <IPV6> ff02::1 if you want to make a ping to a specific IP Address
ip -6 neigh
alive6
use auxiliary/scanner/discovery/ipv6_neighbor_router_advertisement; set INTERFACE eth1; run
```
# IPv6 MitM

Hombre en el medio con anuncio de vecino ICMPv6 falsificado.

* Hombre en el medio con anuncio de router ICMPv6 falsificado.
* Hombre en el medio usando redirecci√≥n ICMPv6 o ICMPv6 demasiado grande para implantar ruta.
* Hombre en el medio para atacar IPv6 m√≥vil pero requiere que ipsec est√© deshabilitado.
* Hombre en el medio con servidor DHCPv6 falso



# Descubriendo direcciones IPv6 en la red

## Subdominios

Puedes usar Google y otros navegadores para buscar subdominios como "ipv6.\*"
```bash
site:ipv6./
```
## DNS

Tambi√©n podr√≠as intentar buscar "**AXFR**" (transferencia de zona), "**AAAA**" (IPv6) o incluso "**ANY**" (todo) en el DNS para encontrar direcciones IPv6.

## Ping6

Una vez que se hayan encontrado algunos dispositivos IPv6 de una organizaci√≥n, podr√≠as intentar usar `ping6` para verificar direcciones cercanas.

# Referencias

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)


<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
