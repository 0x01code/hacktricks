<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** (https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PRs рдЬрдорд╛ рдХрд░рдХреЗред

</details>


# IPv6 рдореВрд▓ рд╕рд┐рджреНрдзрд╛рдВрдд

## рдиреЗрдЯрд╡рд░реНрдХ

рдПрдХ IPv6 рдкрддреЗ рдореЗрдВ, **рдкрд╣рд▓реЗ 48 рдмрд┐рдЯ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рд┐рдлрд┐рдХреНрд╕ рд╣реЛрддреЗ рд╣реИрдВ**ред рдЕрдЧрд▓реЗ **16 рдмрд┐рдЯ рд╕рдмрдиреЗрдЯ рдЖрдИрдбреА рд╣реЛрддреЗ рд╣реИрдВ** рдФрд░ рдЙрдкрдиреЗрдЯреНрд╕ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдЕрдВрддрд┐рдо **64 рдмрд┐рдЯ рдЗрдВрдЯрд░рдлреЗрд╕ рдЖрдИрдбреЗрдВрдЯрд┐рдлрд╛рдпрд░ рд╣реЛрддреЗ рд╣реИрдВ** (рдЬрд┐рд╕реЗ рдЗрдВрдЯрд░рдлреЗрд╕ рдЖрдИрдбреА рдпрд╛ рдбрд┐рд╡рд╛рдЗрд╕ рдЖрдИрдбреА рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реИ)ред рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдиреЗ рдкрд░, рдбрд┐рд╡рд╛рдЗрд╕ рдЖрдИрдбреА рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдЖрд░рдХреНрд╖рд┐рдд рдмрд┐рдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдмрдиреЗрдЯ рдорд╛рд╕реНрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

IPv6 рдореЗрдВ ARP рдирд╣реАрдВ рд╣реИред рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, **ICMPv6 NS (Neighbor Solicitation) рдФрд░ NA (Neighbor Advertisement)** рд╣реИред **NS** рдХрд╛ рдЙрдкрдпреЛрдЧ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ рдкрддреЗ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ **рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ** рдкреИрдХреЗрдЯ рднреЗрдЬрддрд╛ рд╣реИред **NA** **рдпреВрдирд┐рдХрд╛рд╕реНрдЯ** рд╣реИ рдФрд░ NS рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред NA рдкреИрдХреЗрдЯ рдХреЛ NS рдкреИрдХреЗрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рди рд╣реЛрддреЗ рд╣реБрдП рднреА рднреЗрдЬрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**0:0:0:0:0:0:0:1** = 1 (`::1` рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд╖рд┐рдкреНрдд)  тАУ рдпрд╣ IPv4 рдореЗрдВ 127.0.0.1 рдХреЗ рд╕рдордХрдХреНрд╖ рд╣реИред

**рд▓рд┐рдВрдХ-рд╕реНрдерд╛рдиреАрдп рдкрддреЗ:** рдпреЗ рдирд┐рдЬреА рдкрддреЗ рд╣реИрдВ рдЬреЛ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдорд╛рд░реНрдЧреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдирд┐рдЬреА рдпрд╛ рдЕрд╕реНрдерд╛рдпреА рдПрд▓рдПрдПрдиреНрд╕ рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рд╕рд╛рдЭрд╛ рдФрд░ рд╡рд┐рддрд░рдг рдХреЗ рд▓рд┐рдПред рдЖрдкрдХреЗ рд╕реНрдерд╛рдиреАрдп рдПрд▓рдПрдПрди рдореЗрдВ рдЕрдиреНрдп рдЙрдкрдХрд░рдг рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдПрдлрдПрдл02::01 рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдкрддреЗ рдкрд░ рдкрд┐рдВрдЧ рднреЗрдЬрдХрд░ рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВред
**FE80::/10**  тАУ рд▓рд┐рдВрдХ-рд╕реНрдерд╛рдиреАрдп рдпреВрдирд┐рдХрд╛рд╕реНрдЯ рдкрддрд╛ рд╕реАрдорд╛ред
```bash
ping6 тАУI eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

#Or you could also use
alive6 eth0
```
If you **know the MAC address of a host in the same net** as you (you could just ping its ipv4 address and view the arp table to found its MAC address), you can calculate his Link-local address to communicate with him.\
Suppose the **MAC address** is **`12:34:56:78:9a:bc`**

1. To IPv6 notation: **`1234:5678:9abc`**
2. Append `fe80::` at the beginning and Insert `fffe` in the middle: **`fe80::`**`1234:56`**`ff:fe`**`78:9abc`
3. Invert seventh bit from the left, from 0001 0010 to 0001 0000: `fe80::1`**`0`**`34:56ff:fe78:9abc`
4. `fe80::1034:56ff:fe78:9abc`

**Unique local  address:**  This type of ipv6 address also  not intended to be routed on the public internet. Unique local is a replacement of site-local address, that allows communication within a site while being routable to a multiple local networks.\
**FEC00::/7**  тАУ The unique local address range.

**Multicast Address:** This can also be refered to as One-to-Many. Packets addressed to multicast address are delivered to all interface identified by the multicast address. Multicast address types are easily notable because they normally  begins with FF.\
**FF00::/8**  тАУ The multicast range.

**Anycast:**  This form of ipv6 address is similar to the multicast address with a slight difference. Anycast address can also be refered to as One to Nearest. It can be used to address packets meant for multiple interfaces; but usually it sends packets to the first interface it finds as defined in the routing distance. This means it send packets to the closest interface as determined by routing protocols.\
**20000::/3**  тАУ The global unicast address range.

fe80::/10--> Unique Link-Local (169.254.x.x) \[fe80:0000:0000:0000:0000:0000:0000:0000,febf:ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff]\
fc00::/7 --> Unique Local-Unicast (10.x.x.x, 172.16.x.x, 192.168.x.x) \[]\
2000::/3 --> Global Unicast\
ff02::1 --> Multicast All Nodes\
ff02::2 --> Multicast Router Nodes

## **Guess the IPv6 of a machine**

**Way 1**

The IPv6 of fe80::/10 are based on the MAC. If you have the IPv6 of a device inside a network and you want to guess the IPv6 of another device of the network, you can get its MAC address using a ping (inside the arp table).

**Way2**

You can send a ping6 to the multicast and get the IPv6 address inside the arp table.
```bash
service ufw stop #Stop firewall
ping6 -I <IFACE> ff02::1 #You could also make: ping6 -I <IPV6> ff02::1 if you want to make a ping to a specific IP Address
ip -6 neigh
alive6
use auxiliary/scanner/discovery/ipv6_neighbor_router_advertisement; set INTERFACE eth1; run
```
# IPv6 MitM

рдмреАрдЪ рдореЗрдВ рдЖрджрдореА рдЬреЛ рдЖрдИрд╕реАрдПрдордкреАрд╡реА6 рдкрдбрд╝реЛрд╕реА рд╡рд┐рдЬреНрдЮрд╛рдкрди рдХреЗ рд╕рд╛рде рдзреЛрдЦрд╛ рджреЗрддрд╛ рд╣реИред

* рдмреАрдЪ рдореЗрдВ рдЖрджрдореА рдЬреЛ рдЖрдИрд╕реАрдПрдордкреАрд╡реА6 рд░рд╛рдЙрдЯрд░ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдХреЗ рд╕рд╛рде рдзреЛрдЦрд╛ рджреЗрддрд╛ рд╣реИред
* рдмреАрдЪ рдореЗрдВ рдЖрджрдореА рдЬреЛ рдЖрдИрд╕реАрдПрдордкреАрд╡реА6 рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдпрд╛ рдЖрдИрд╕реАрдПрдордкреАрд╡реА6 рдмрд╣реБрдд рдмрдбрд╝рд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рд░реВрдЯ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдПред
* рдореЛрдмрд╛рдЗрд▓ рдЖрдИрдкреАрд╡реА6 рдХреЛ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдмреАрдЪ рдореЗрдВ рдЖрджрдореА рд▓реЗрдХрд┐рди рдЖрдИрдкреАрдПрд╕реЗрдХ рдЕрдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
* рдмреАрдЪ рдореЗрдВ рдЖрджрдореА рдЬреЛ рд░реЛрдЧ рдбреАрдПрдЪрдкреАрд╡реА6 рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рдеред



# Discovering IPv6 addresses in the wild

## Subdomains

рдЖрдк рдЧреВрдЧрд▓ рдФрд░ рдЕрдиреНрдп рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ "ipv6.\*" рдЬреИрд╕реЗ рд╕рдмрдбреЛрдореЗрди рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
site:ipv6./
```
## DNS

рдЖрдк "**AXFR**" (рдЬрд╝реЛрди рдЯреНрд░рд╛рдВрд╕рдлрд░), "**AAAA**" (IPv6) рдпрд╛ рдлрд┐рд░ "**ANY**" (рд╕рднреА) рд░рдЬрд┐рд╕реНрдЯреНрд░реА DNS рдореЗрдВ рдЦреЛрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ IPv6 рдкрддреЛрдВ рдХреЛ рдЦреЛрдЬ рд╕рдХреЗрдВред

## Ping6

рдЬрдм рдХрд┐рд╕реА рд╕рдВрдЧрдарди рдХреЗ рдХреБрдЫ IPv6 рдЙрдкрдХрд░рдг рдорд┐рд▓ рдЧрдП рд╣реЛрдВ, рддреЛ рдЖрдк `ping6` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╕рдкрд╛рд╕ рдХреЗ рдкрддреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

# References

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)


<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
