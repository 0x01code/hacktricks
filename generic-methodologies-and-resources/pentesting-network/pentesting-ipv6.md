<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **GitHub-Repositories** senden.

</details>


# IPv6 Grundlagen

## Netzwerke

IPv6-Adressen sind strukturiert, um die Organisation von Netzwerken und die Interaktion von Ger√§ten zu verbessern. Eine IPv6-Adresse ist in folgende Teile unterteilt:

1. **Netzwerkpr√§fix**: Die ersten 48 Bits, die das Netzwerksegment bestimmen.
2. **Subnetz-ID**: Die n√§chsten 16 Bits, die zur Definition spezifischer Subnetze innerhalb des Netzwerks verwendet werden.
3. **Schnittstellenkennung**: Die letzten 64 Bits, die ein Ger√§t innerhalb des Subnetzes eindeutig identifizieren.

W√§hrend IPv6 das in IPv4 gefundene ARP-Protokoll wegl√§sst, f√ºhrt es **ICMPv6** mit zwei Hauptnachrichten ein:
- **Neighbor Solicitation (NS)**: Multicast-Nachrichten zur Adressaufl√∂sung.
- **Neighbor Advertisement (NA)**: Unicast-Antworten auf NS oder spontane Ank√ºndigungen.

IPv6 enth√§lt auch spezielle Adresstypen:
- **Loopback-Adresse (`::1`)**: Entsprechend IPv4's `127.0.0.1`, f√ºr die interne Kommunikation innerhalb des Hosts.
- **Link-Local-Adressen (`FE80::/10`)**: F√ºr lokale Netzwerkaktivit√§ten, nicht f√ºr die Internet-Routing. Ger√§te im selben lokalen Netzwerk k√∂nnen sich mithilfe dieses Bereichs gegenseitig entdecken.

### Praktische Verwendung von IPv6 in Netzwerkbefehlen

Um mit IPv6-Netzwerken zu interagieren, k√∂nnen Sie verschiedene Befehle verwenden:
- **Ping Link-Local-Adressen**: √úberpr√ºfen Sie die Anwesenheit lokaler Ger√§te mit `ping6`.
- **Neighbor Discovery**: Verwenden Sie `ip neigh`, um Ger√§te auf der Linkschicht zu sehen.
- **alive6**: Ein alternatives Tool zum Auffinden von Ger√§ten im selben Netzwerk.

Nachfolgend finden Sie einige Beispiele f√ºr Befehle:
```bash
ping6 ‚ÄìI eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

# Alternatively, use alive6 for neighbor discovery
alive6 eth0
```
IPv6-Adressen k√∂nnen aus der MAC-Adresse eines Ger√§ts f√ºr die lokale Kommunikation abgeleitet werden. Hier ist eine vereinfachte Anleitung, wie man die Link-Local IPv6-Adresse aus einer bekannten MAC-Adresse ableitet, sowie ein kurzer √úberblick √ºber IPv6-Adresstypen und Methoden zur Entdeckung von IPv6-Adressen in einem Netzwerk.

## **Ableitung der Link-Local IPv6-Adresse aus der MAC-Adresse**

Gegeben sei eine MAC-Adresse **`12:34:56:78:9a:bc`**, kann die Link-Local IPv6-Adresse wie folgt konstruiert werden:

1. Konvertiere die MAC-Adresse in das IPv6-Format: **`1234:5678:9abc`**
2. F√ºge `fe80::` hinzu und f√ºge `fffe` in die Mitte ein: **`fe80::1234:56ff:fe78:9abc`**
3. Invertiere das siebte Bit von links, √§ndere `1234` zu `1034`: **`fe80::1034:56ff:fe78:9abc`**

## **IPv6-Adresstypen**

- **Unique Local Address (ULA)**: F√ºr lokale Kommunikation, nicht f√ºr √∂ffentliches Internet-Routing gedacht. Pr√§fix: **`FEC00::/7`**
- **Multicast-Adresse**: F√ºr eine-zu-viele-Kommunikation. Wird an alle Schnittstellen in der Multicast-Gruppe gesendet. Pr√§fix: **`FF00::/8`**
- **Anycast-Adresse**: F√ºr eine-zu-n√§chste-Kommunikation. Wird an die n√§chstgelegene Schnittstelle gem√§√ü Routing-Protokoll gesendet. Teil des globalen Unicast-Bereichs **`2000::/3`**.

## **Adresspr√§fixe**
- **fe80::/10**: Link-Local-Adressen (√§hnlich wie 169.254.x.x)
- **fc00::/7**: Unique Local-Unicast (√§hnlich wie private IPv4-Bereiche wie 10.x.x.x, 172.16.x.x, 192.168.x.x)
- **2000::/3**: Global Unicast
- **ff02::1**: Multicast Alle Knoten
- **ff02::2**: Multicast Router-Knoten

## **Entdeckung von IPv6-Adressen in einem Netzwerk**

### Methode 1: Verwendung von Link-Local-Adressen
1. Erhalten Sie die MAC-Adresse eines Ger√§ts im Netzwerk.
2. Leiten Sie die Link-Local IPv6-Adresse aus der MAC-Adresse ab.

### Methode 2: Verwendung von Multicast
1. Senden Sie einen Ping an die Multicast-Adresse `ff02::1`, um IPv6-Adressen im lokalen Netzwerk zu entdecken.
```bash
service ufw stop # Stop the firewall
ping6 -I <IFACE> ff02::1 # Send a ping to multicast address
ip -6 neigh # Display the neighbor table
```
## IPv6 Man-in-the-Middle (MitM) Angriffe
Es gibt mehrere Techniken, um MitM-Angriffe in IPv6-Netzwerken durchzuf√ºhren, wie zum Beispiel:

- Spoofing von ICMPv6-Nachbarn oder Router-Anzeigen.
- Verwendung von ICMPv6-Weiterleitung oder "Packet Too Big"-Nachrichten zur Manipulation der Routing-Tabelle.
- Angriffe auf mobile IPv6 (normalerweise erfordert das Deaktivieren von IPSec).
- Einrichtung eines Rogue-DHCPv6-Servers.


# Identifizierung von IPv6-Adressen im Netzwerk

## Erkunden von Subdomains
Eine Methode, um Subdomains zu finden, die potenziell mit IPv6-Adressen verkn√ºpft sind, besteht darin, Suchmaschinen zu nutzen. Zum Beispiel kann die Verwendung eines Suchmusters wie `ipv6.*` effektiv sein. Konkret kann der folgende Suchbefehl in Google verwendet werden:
```bash
site:ipv6./
```
## Verwendung von DNS-Abfragen
Um IPv6-Adressen zu identifizieren, k√∂nnen bestimmte DNS-Eintragstypen abgefragt werden:
- **AXFR**: Fordert eine vollst√§ndige Zonentransfer an und deckt m√∂glicherweise eine Vielzahl von DNS-Eintr√§gen auf.
- **AAAA**: Sucht direkt nach IPv6-Adressen.
- **ANY**: Eine umfassende Abfrage, die alle verf√ºgbaren DNS-Eintr√§ge zur√ºckgibt.

## Sondieren mit Ping6
Nachdem IPv6-Adressen einer Organisation ermittelt wurden, kann das Dienstprogramm `ping6` zum Sondieren verwendet werden. Dieses Tool hilft bei der Bewertung der Reaktionsf√§higkeit der identifizierten IPv6-Adressen und kann auch bei der Entdeckung benachbarter IPv6-Ger√§te helfen.


## Referenzen

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)


<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
