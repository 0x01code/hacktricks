<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>


# Teoria B√°sica do IPv6

## Redes

Em um endere√ßo IPv6, os **primeiros 48 bits s√£o o prefixo de rede**. Os **pr√≥ximos 16 bits s√£o o ID da sub-rede** e s√£o usados para definir sub-redes. Os √∫ltimos **64 bits s√£o o identificador de interface** (tamb√©m conhecido como ID de Interface ou ID de Dispositivo, √© para dispositivos). Se necess√°rio, os bits normalmente reservados para o ID do Dispositivo podem ser usados para mascaramento de sub-rede adicional.

N√£o h√° ARP no IPv6. Em vez disso, h√° **ICMPv6 NS (Neighbor Solicitation) e NA (Neighbor Advertisement)**. O **NS** √© usado para resolver um endere√ßo, ent√£o ele envia pacotes **multicast**. O **NA** √© **unicast** e √© usado para responder ao NS. Um pacote NA tamb√©m pode ser enviado sem precisar de um pacote NS.

**0:0:0:0:0:0:0:1** = 1 (`::1` para abreviar)  ‚Äì Este √© o equivalente a 127.0.0.1 no IPv4.

**Endere√ßos Link-local:** Estes s√£o endere√ßos privados que n√£o s√£o destinados a serem roteados na internet. Eles podem ser usados localmente por LANs privadas ou tempor√°rias para compartilhamento e distribui√ß√£o de arquivos entre dispositivos na LAN. Outros dispositivos em sua LAN local que usam esse tipo de endere√ßos podem ser encontrados enviando um ping para o endere√ßo multicast ff02::01\
**FE80::/10**  ‚Äì Faixa de endere√ßo unicast local de link.
```bash
ping6 ‚ÄìI eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

#Or you could also use
alive6 eth0
```
Se voc√™ **conhece o endere√ßo MAC de um host na mesma rede** que voc√™ (voc√™ poderia simplesmente fazer ping no seu endere√ßo ipv4 e visualizar a tabela arp para encontrar seu endere√ßo MAC), voc√™ pode calcular o endere√ßo Link-local dele para se comunicar com ele.\
Suponha que o **endere√ßo MAC** seja **`12:34:56:78:9a:bc`**

1. Para nota√ß√£o IPv6: **`1234:5678:9abc`**
2. Acrescente `fe80::` no in√≠cio e insira `fffe` no meio: **`fe80::`**`1234:56`**`ff:fe`**`78:9abc`
3. Inverta o s√©timo bit da esquerda, de 0001 0010 para 0001 0000: `fe80::1`**`0`**`34:56ff:fe78:9abc`
4. `fe80::1034:56ff:fe78:9abc`

**Endere√ßo local √∫nico:** Este tipo de endere√ßo ipv6 tamb√©m n√£o √© destinado a ser roteado na internet p√∫blica. O endere√ßo local √∫nico √© uma substitui√ß√£o do endere√ßo local de site, que permite a comunica√ß√£o dentro de um site enquanto √© rote√°vel para v√°rias redes locais.\
**FEC00::/7**  ‚Äì O intervalo de endere√ßos locais √∫nicos.

**Endere√ßo de Multicast:** Isso tamb√©m pode ser referido como Um-para-Muitos. Pacotes endere√ßados a um endere√ßo de multicast s√£o entregues a todas as interfaces identificadas pelo endere√ßo de multicast. Os tipos de endere√ßos de multicast s√£o facilmente identific√°veis porque normalmente come√ßam com FF.\
**FF00::/8**  ‚Äì O intervalo de endere√ßos de multicast.

**Anycast:** Esta forma de endere√ßo ipv6 √© semelhante ao endere√ßo de multicast com uma pequena diferen√ßa. O endere√ßo anycast tamb√©m pode ser referido como Um para o Mais Pr√≥ximo. Pode ser usado para endere√ßar pacotes destinados a v√°rias interfaces; mas geralmente envia pacotes para a primeira interface que encontra, conforme definido na dist√¢ncia de roteamento. Isso significa que envia pacotes para a interface mais pr√≥xima, conforme determinado pelos protocolos de roteamento.\
**20000::/3**  ‚Äì O intervalo de endere√ßos unicast global.

fe80::/10--> Link-Local √önico (169.254.x.x) \[fe80:0000:0000:0000:0000:0000:0000:0000,febf:ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff]\
fc00::/7 --> Local-unicast √önico (10.x.x.x, 172.16.x.x, 192.168.x.x) \[]\
2000::/3 --> Unicast Global\
ff02::1 --> Todos os N√≥s de Multicast\
ff02::2 --> N√≥s de Roteador de Multicast

## **Adivinhe o IPv6 de uma m√°quina**

**M√©todo 1**

Os IPv6 de fe80::/10 s√£o baseados no MAC. Se voc√™ tiver o IPv6 de um dispositivo dentro de uma rede e quiser adivinhar o IPv6 de outro dispositivo da rede, voc√™ pode obter seu endere√ßo MAC usando um ping (dentro da tabela arp).

**M√©todo 2**

Voc√™ pode enviar um ping6 para o multicast e obter o endere√ßo IPv6 dentro da tabela arp.
```bash
service ufw stop #Stop firewall
ping6 -I <IFACE> ff02::1 #You could also make: ping6 -I <IPV6> ff02::1 if you want to make a ping to a specific IP Address
ip -6 neigh
alive6
use auxiliary/scanner/discovery/ipv6_neighbor_router_advertisement; set INTERFACE eth1; run
```
# IPv6 MitM

Homem no meio com an√∫ncio de vizinho ICMPv6 falsificado.

* Homem no meio com an√∫ncio de roteador ICMPv6 falsificado.
* Homem no meio usando redirecionamento ICMPv6 ou ICMPv6 muito grande para implantar rota.
* Homem no meio para atacar o IPv6 m√≥vel, mas requer que o ipsec esteja desativado.
* Homem no meio com servidor DHCPv6 falso



# Descobrindo endere√ßos IPv6 na natureza

## Subdom√≠nios

Voc√™ pode usar o google e outros navegadores para procurar subdom√≠nios como "ipv6.\*"
```bash
site:ipv6./
```
## DNS

Tamb√©m pode tentar pesquisar por "**AXFR**" (transfer√™ncia de zona), "**AAAA**" (IPv6) ou at√© mesmo "**ANY**" (todos) no registro DNS para encontrar endere√ßos IPv6.

## Ping6

Uma vez que alguns dispositivos IPv6 de uma organiza√ß√£o tenham sido encontrados, pode tentar usar `ping6` para verificar endere√ßos pr√≥ximos.

# Refer√™ncias

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)


<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
