# GLBP рдФрд░ HSRP рд╣рдорд▓реЗ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓** рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдирд╛ рдпреЛрдЧрджрд╛рди рджреЗрдВред**

</details>

**рдпрд╣ рдкреГрд╖реНрда** [**https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9**](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9) **рд╕реЗ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред**

## FHRP рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ <a href="#6196" id="6196"></a>

### FHRP рдХреНрдпрд╛ рд╣реИ? <a href="#b12d" id="b12d"></a>

FHRP (рдкрд╣рд▓реА рд╣реЙрдк рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдкреНрд░реЛрдЯреЛрдХреЙрд▓) рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрдХреНрд╖рд╛ рд╣реИ рдЬреЛ рдПрдХ рдЧрд░реНрдо рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдорд╛рд░реНрдЧ рдкреНрд░рдгрд╛рд▓реА рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВред FHRP рдХреЗ рд╕рд╛рде, рднреМрддрд┐рдХ рд░рд╛рдЙрдЯрд░реЛрдВ рдХреЛ рдПрдХ рдПрдХрд▓ рддрд╛рд░реНрдХрд┐рдХ рдЙрдкрдХрд░рдг рдореЗрдВ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рддреНрд░реБрдЯрд┐ рд╕рд╣рдирд╢реАрд▓рддрд╛ рдмрдврд╝рд╛рддрд╛ рд╣реИ рдФрд░ рднрд╛рд░ рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред

**рд╕рд┐рд╕реНрдХреЛ рд╕рд┐рд╕реНрдЯрдо рдЗрдВрдЬреАрдирд┐рдпрд░реНрд╕ рдиреЗ рджреЛ FHRP рдкреНрд░реЛрдЯреЛрдХреЙрд▓, GLBP рдФрд░ HSRP, рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдП рд╣реИрдВ, рдЬрд┐рдиреНрд╣реЗрдВ рдореИрдВ рдЕрдЧрд▓реЗ рдореЗрдВ рджрд┐рдЦрд╛рдКрдВрдЧрд╛ред**

### GLBP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ <a href="#8a26" id="8a26"></a>

**рд╕рд┐рд╕реНрдХреЛ рд╕рд┐рд╕реНрдЯрдо рдЗрдВрдЬреАрдирд┐рдпрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рдХрд╕рд┐рддред** HSRP рдХреА рддрд░рд╣, рдпрд╣ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ TCP/IP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕реНрдЯреИрдХ рдХреЗ рдКрдкрд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╕реЗрд╡рд╛ рд╕реВрдЪрдирд╛ рдХреЗ рдЕрдиреБрд╡рд╛рдж рдХреЗ рд▓рд┐рдП UDP рдкрд░рд┐рд╡рд╣рди рдкрд░рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред GLBP рд░рд╛рдЙрдЯрд░ рд╕рдореВрд╣ рдХреЗ рднреАрддрд░ 3 рд╕реЗрдХрдВрдб рдореЗрдВ рд╡рд┐рд╢реЗрд╖ "рд╣реИрд▓реЛ" рдкреИрдХреЗрдЯ рдЖрдкрд╕ рдореЗрдВ рдЖрдкрд╕ рдореЗрдВ рд╡рд┐рдирд┐рдордп рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрджрд┐ 10 рд╕реЗрдХрдВрдб рдХреЗ рднреАрддрд░ рдПрдХ GLBP рд░рд╛рдЙрдЯрд░ рд╕рдореВрд╣ рдХреЗ рднреАрддрд░ рд╕реЗ рдПрдХ рд╣реИрд▓реЛ рдкреИрдХреЗрдЯ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ "рдорд░рд╛" рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЯрд╛рдЗрдорд░ рдорд╛рдиреЛрдВ рдХреЛ рдкреНрд░рд╢рд╛рд╕рдХ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдкрд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### GLBP рдХрд╛ рд╕рдВрд░рдЪрдирд╛ рдФрд░ рдпрд╛рдВрддреНрд░рд┐рдХреА <a href="#3bb3" id="3bb3"></a>

GLBP рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рдЖрдИрдкреА рдкрддреЗ рдФрд░ рдХрдИ рд╡рд░реНрдЪреБрдЕрд▓ рдореИрдХ рдкрддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд▓реНрдЯреАрдкрд▓ рд░рд╛рдЙрдЯрд░ (рдЧреЗрдЯрд╡реЗ) рдХреЛ рд▓реЛрдб рд╢реЗрдпрд░рд┐рдВрдЧ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ рдХреЛ рдПрдХ рд╣реА рд╡рд░реНрдЪреБрдЕрд▓ рдЖрдИрдкреА рдкрддрд╛ рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рд╕рдореВрд╣ рдореЗрдВ рд╕рднреА рд░рд╛рдЙрдЯрд░ рдкреИрдХреЗрдЯ рдкреНрд░рд╕рд╛рд░рдг рдореЗрдВ рднрд╛рдЧ рд▓реЗрддреЗ рд╣реИрдВред

рдпрд╣ HSRP рдФрд░ VRRP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рдЕрд▓рдЧ рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдЪреНрдЪреА рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд┐рдВрдЧ рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдореИрдВ рдиреАрдЪреЗ рджрд░реНрд╢рд╛рддрд╛ рд╣реВрдБ:

**рд╣реЛрд╕реНрдЯ-рдбрд┐рдкреЗрдВрдбреЗрдВрдЯред** рдПрдХ рдРрд╕рд╛ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд┐рдВрдЧ рдкреНрд░рдХрд╛рд░ рдЬреЛ NAT рд╣реЛрдиреЗ рдкрд░ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣реЛрд╕реНрдЯ-рдбрд┐рдкреЗрдВрдбреЗрдВрдЯ рдпрд╣ рдЧрд╛рд░рдВрдЯреА рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╣реЛрд╕реНрдЯ рдХреЛ рдкрд╣рд▓реЗ рдХреЗ рд╕рдордп рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП AVF рдЙрдкрдХрд░рдг рдХрд╛ рдПрдХ рд╣реА MAC рдкрддрд╛ рдорд┐рд▓реЗрдЧрд╛,
### GLBP рд╣рдорд▓рд╛ рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо <a href="#3260" id="3260"></a>

рдЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рд╣рдорд▓реЗ рдХреА рддрдХрдиреАрдХ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдк рдЕрдкрдиреА рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдореБрдЦреНрдп рд░рд╛рдЙрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдереЛрдкрддреЗ рд╣реИрдВ **рдПрдХ рдЦрддрд░рдирд╛рдХ GLBP рдкреИрдХреЗрдЯ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдЕрдзрд┐рдХрддрдо рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд╛рди рд╣реЛрддрд╛ рд╣реИред** **рд╕рдлрд▓ рдЙрдкрдпреЛрдЧ рд╕реЗ рдПрдХ рдбреАрдУрдПрд╕ рдпрд╛ MITM рд╣рдорд▓рд╛ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рднреАрддрд░ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдбреАрдУрдПрд╕ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рдЖрдк AVG рд░рд╛рдЙрдЯрд░ рдХреА рднреВрдорд┐рдХрд╛ рдЧреНрд░рд╣рдг рдХрд░рддреЗ рд╣реИрдВред** рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдПрдХ GLBP рдкреИрдХреЗрдЯ рдмрдирд╛рдирд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд╛рди 255 рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдУрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдирд╛ рд╣реИред

<figure><img src="../../.gitbook/assets/image (13) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (14) (2).png" alt=""><figcaption></figcaption></figure>

### GLBP рдЗрдВрдЬреЗрдХреНрд╢рди (рд▓реЛрдХреА) <a href="#fb69" id="fb69"></a>

рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдореИрдВ [**рд▓реЛрдХреА**](https://github.com/raizo62/loki\_on\_kali) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реВрдВрдЧрд╛ред рдЗрд╕рдореЗрдВ рдПрдХ рдЦрддрд░рдирд╛рдХ GLBP рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдЕрдзрд┐рдХрддрдо рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд╛рди 255 рдФрд░ рдЕрдзрд┐рдХрддрдо рд╡реЗрдЯ рдорд╛рди 255 рд╣реЛрддрд╛ рд╣реИред рд▓реЗрдХрд┐рди рд╣рдорд▓рд╛ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП:

* **GLBP рдбреЛрдореЗрди рдореЗрдВ рдЙрдкрдпреЛрдЧ рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╡рд░реНрдЪреБрдЕрд▓ рдЖрдИрдкреА рдкрддрд╛**
* **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЙрдкрд▓рдмреНрдзрддрд╛**
* **рд░рд╛рдЙрдЯрд░ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдХрд╛ рдорд╛рди**

рд╣рдо GLBP рдЯреНрд░реИрдлрд╝рд┐рдХ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдХреЗ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдирд┐рдХрд╛рд▓ рд╕рдХреЗрдВрдЧреЗред рд╣рдо **Wireshark** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред

рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ, GLBP рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдХреЗрд╡рд▓ рджреЛ рд░рд╛рдЙрдЯрд░ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ: **10.10.100.100 рдФрд░ 10.10.100.200ред**

<figure><img src="../../.gitbook/assets/image (158) (3).png" alt=""><figcaption><p><strong>GLBP рд╡рд┐рдЬреНрдЮрд╛рдкрди</strong></p></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (271).png" alt=""><figcaption><p>рдкрд╣рд▓реЗ рд░рд╛рдЙрдЯрд░ рд╕реЗ GLBP рд╡рд┐рдЬреНрдЮрд╛рдкрди</p></figcaption></figure>

GLBP рдЯреНрд░реИрдлрд╝рд┐рдХ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИ:

* **рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╕реЗрдЯрд┐рдВрдЧ рдореЗрдВ рдПрдХ рдЧрд▓рддреА рдХрд╛ рдкрддрд╛ рдЪрд▓рд╛ред AVG рд░рд╛рдЙрдЯрд░ рдХреЛ GLBP рд░рд╛рдЙрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдиреНрдпрддрд╛ рджреА рдЬрд╛рддреА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ 200 рд╣реИ, рдЕрд░реНрдерд╛рдд рд╣рдореЗрдВ GLBP рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реЗрдХреНрдЯрд░ рд╣реИ**
* **рдХреЛрдИ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдирд╣реАрдВ**
* **GLBP рдбреЛрдореЗрди рдореЗрдВ рдЙрдкрдпреЛрдЧ рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рд╡рд░реНрдЪреБрдЕрд▓ рдЖрдИрдкреА рдкрддрд╛ 10.10.100.254 рд╣реИ**

рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде, **рд╣рдо рдЖрд╕рд╛рдиреА рд╕реЗ GLBP рдкрд░ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред**

<figure><img src="../../.gitbook/assets/image (174).png" alt=""><figcaption><p>рд▓реЛрдХреА рдиреЗ рджреЛ рд░рд╛рдЙрдЯрд░реЛрдВ рд╕реЗ GLBP рд╡рд┐рдЬреНрдЮрд╛рдкрди рдЦреЛрдЬреЗ</p></figcaption></figure>

рд╣рдорд▓реЗ рд╕реЗ рдкрд╣рд▓реЗ, **рдкреНрд░реЛрдорд┐рд╕реНрдХрд┐рдпрд╕ рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдВ рдФрд░ рдЯреНрд░реИрдлрд╝рд┐рдХ рд░реВрдЯрд┐рдВрдЧ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВ:**
```
~$ sudo ip link set eth0 promisc on
~$ sudo sysctl -w net.ipv4.ip_forward=1
```
рдЖрдИрдкреА рдкрддреЗ **10.10.100.100** рдкрд░ рд░рд╛рдЙрдЯрд░ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ **рдЖрдИрдкреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ** рд╡рд┐рдХрд▓реНрдк рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░реЗрдВред рдЖрдкрдХреЛ рдПрдХ **рдЧреНрд░реЗрдЪреБрдЗрдЯрд╕ ARP** рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

<figure><img src="../../.gitbook/assets/image (222).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (161) (2).png" alt=""><figcaption><p>рдПрдХ рджреБрд╖реНрдЯ GLBP рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рд╕рдВрд░рдЪрдирд╛</p></figcaption></figure>

рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, AVG рд░рд╛рдЙрдЯрд░ рдЕрдм рдПрдХ рд╣рдорд▓рд╛рд╡рд░реНрдзреА рдкреНрд░рдгрд╛рд▓реА рдХреА рддрд░рд╣ рдмрди рд░рд╣рд╛ рд╣реИред **рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд╛рди 255 рд╣реИ, рд╡реЗрдЯ рдорд╛рди 255 рд╣реИ, рдЕрд░реНрдерд╛рдд рд╕рд░реНрд╡реЛрдЪреНрдЪред**

**рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рд╣рдореЗрдВ рдЕрдкрдиреЗ рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдкрд░ рдПрдХ рд╕реЗрдХреЗрдВрдбрд░реА рдЖрдИрдкреА рдкрддрд╛ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ GLBP рдбреЛрдореЗрди рдореЗрдВ рд╡рд░реНрдЪреБрдЕрд▓ рдЖрдИрдкреА рдкрддреЗ рдХрд╛ рдорд╛рди рд╣реЛрддрд╛ рд╣реИред рдЖрдкрдХреЛ рдПрдХ 24-рдмрд┐рдЯ рдорд╛рд╕реНрдХ рднреА рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред**

**рдЗрд╕ рддрд░рд╣ рд╡реИрдз рдЯреНрд░реИрдлрд┐рдХ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд▓реВрдкрдмреИрдХ рд╣реЛ рдЬрд╛рдПрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ GLBP рдбреЛрдореЗрди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╡рд░реНрдЪреБрдЕрд▓ рдЖрдИрдкреА рдкрддреЗ рдХреЛ рд╣реЛрд╕реНрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ рдкрддрд╛ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:**
```
~$ sudo ifconfig eth0:1 10.10.100.254 netmask 255.255.255.0
```
рдЗрдирдХрдорд┐рдВрдЧ рдЯреНрд░реИрдлрд┐рдХ рдХреЗ рд╕рд╛рде-рд╕рд╛рде рдЖрдЙрдЯрдЧреЛрдЗрдВрдЧ рдЯреНрд░реИрдлрд┐рдХ рднреА рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ **SNAT (рдорд╛рд╕реНрдХреЗрд░реЗрдбрд┐рдВрдЧ)** рдХреЗ рд▓рд┐рдП рдПрдХ рдЫреЛрдЯреЗ рд╕реЗ рдирд┐рдпрдо рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ:
```
~$ sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
```
**рд╣рдореЗрдВ рдЕрдкрдиреА рдорд╢реАрди рд╕реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдЯ рд╣рдЯрд╛рдиреА рд╣реЛрдЧреА рдФрд░ рдПрдХ рдирдИ рд░реВрдЯ рд▓рд┐рдЦрдиреА рд╣реЛрдЧреА рдЬреЛ рдкреВрд░реНрд╡ рдПрд╡реАрдЬреА рд░рд╛рдЙрдЯрд░** **(рдкрддрд╛ 10.10.100.100 рд╣реИ)** **рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдПрдЧреАред** **рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╣рдордиреЗ рд░рд╛рдЙрдЯрд░ рд╕реЗ рдПрд╡реАрдЬреА рднреВрдорд┐рдХрд╛ рдХреЛ рд╣рд╛рде рдореЗрдВ рд▓реЗ рд▓рд┐рдпрд╛ рд╣реИ, рдлрд┐рд░ рднреА рдпрд╣ рдЯреНрд░реИрдлрд┐рдХ рдХрд╛ рдорд╛рд░реНрдЧрджрд░реНрд╢рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд░рд╣реЗрдЧрд╛ред**
```
~$ sudo route del default
~$ sudo route add -net 0.0.0.0 netmask 0.0.0.0 gw 10.10.100.100
```
рдпрд╣реА рд╣реИ, **рдЕрдм рд╣рдо "рдордзреНрдп рдореЗрдВ рд╡реНрдпрдХреНрддрд┐" рд╣реИрдВ!** рдореИрдВ рдЙрдкрдХрд░рдг [**net-creds.py**](https://github.com/DanMcInerney/net-creds) рдЪрд▓рд╛рдКрдВрдЧрд╛ рддрд╛рдХрд┐ рдореИрдВ рдпрд╛рддрд╛рдпрд╛рдд рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░ рд╕рдХреВрдВ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдбреЗрдЯрд╛ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХреВрдВред **рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдирдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдПрдлрдЯреАрдкреА рдпрд╛рддрд╛рдпрд╛рдд рдпрд╛ рдПрдирдЯреАрдПрд▓рдПрдо рд╣реИрд╢ред**
```
~$ sudo python2 net-creds.py -i eth0
```
рдЙрдкрдпреЛрдЧреАрддрд╛ рдЪрд▓рд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдореИрдВ GLBP рд░рд╛рдЙрдЯрд░ рдХреЗ рдкреАрдЫреЗ рд╕реНрдерд┐рдд IP рдкрддреЗ **172.16.100.70** рдХреЗ рд╕рд╛рде SMB рд╢реЗрдпрд░ рдХреЛ рдкрдврд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реВрдВрдЧрд╛ред
```
user@Boundless:~$ smbclient -L \\172.16.100.70 --user mercy
```
<figure><img src="../../.gitbook/assets/image (243).png" alt=""><figcaption></figcaption></figure>

**рдпрд╣рд╛рдВ рдЖрдк рдЬреАрдПрд▓рдмреАрдкреА рдбреЛрдореЗрди рдХреЛ рд╣рдорд▓рд╛ рдХрд░рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдЖрдкрддреНрддрд┐ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред**

### HSRP рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ <a href="#595f" id="595f"></a>

**HSRP (рд╣реЙрдЯ рд╕реНрдЯреИрдВрдбрдмрд╛рдИ рд░рд╛рдЙрдЯрд░ / рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдкреНрд░реЛрдЯреЛрдХреЙрд▓) -** рдпрд╣ рд╕рд┐рд╕реНрдХреЛ рдХрд╛ рдкреНрд░реЛрдкреНрд░рд╛рдпрдЯрд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬреЛ рдиреЗрдЯрд╡рд░реНрдХ рдЧреЗрдЯрд╡реЗ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рдЪрд╛рд░ рдпрд╣ рд╣реИ рдХрд┐ рдХрдИ рднреМрддрд┐рдХ рд░рд╛рдЙрдЯрд░реЛрдВ рдХреЛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЖрдИрдкреА рдкрддреЗ рд╡рд╛рд▓реЗ рдПрдХ рдорд╛рдирдХ рд░рд╛рдЙрдЯрд░ рдореЗрдВ рдорд┐рд▓рд╛рдпрд╛ рдЬрд╛рдПред рд╡рд░реНрдЪреБрдЕрд▓ рд░рд╛рдЙрдЯрд░ рдХрд╛ рдпрд╣ рдкрддрд╛ рдорд╛рд╕реНрдЯрд░ рднреВрдорд┐рдХрд╛ рд╡рд╛рд▓реЗ рд░рд╛рдЙрдЯрд░ рдХреЗ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЛ рд╕реМрдВрдкрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж, рдпрд╣ рдЯреНрд░реИрдлрд┐рдХ рдлрд╝реЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдХрд╛ рдзреНрдпрд╛рди рд░рдЦреЗрдЧрд╛ред HSRP рдбреЛрдореЗрди рдореЗрдВ, рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдХрд╛ рдХрд╛рд░реНрдп рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдкреНрд░рд╛рдердорд┐рдХ рднреВрдорд┐рдХрд╛ рд╡рд╛рд▓реЗ рд░рд╛рдЙрдЯрд░ рдкрд░ рдкрдбрд╝рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ GLBP рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рдорд╛рдк (рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдФрд░ рд╡реЗрдЯ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЛрдб рдмреИрд▓реЗрдВрд╕рд┐рдВрдЧ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

### HSRP рдбреЛрдореЗрди рдФрд░ рд╢рдмреНрджрд╛рд╡рд▓реА рдореЗрдВ рднреВрдорд┐рдХрд╛рдПрдВ <a href="#4185" id="4185"></a>

**HSRP рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░** - рдПрдХ рдЙрдкрдХрд░рдг рдЬреЛ рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рд░рд╛рдЙрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕реНрд░реЛрдд рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдЧрдВрддрд╡реНрдп рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдлрд╝реЙрд░рд╡рд░реНрдб рдХрд░рддрд╛ рд╣реИред\
**HSRP рд╕реНрдЯреИрдВрдбрдмрд╛рдИ рд░рд╛рдЙрдЯрд░** - рдПрдХ рдЙрдкрдХрд░рдг рдЬреЛ рд╕реНрдЯреИрдВрдбрдмрд╛рдИ рд░рд╛рдЙрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ, рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░ рдХреЗ рдЕрд╕реНрддрд┐рддреНрд╡ рдореЗрдВ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИред рдкреНрд░рд╛рдердорд┐рдХ рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░ рдЕрд╕реНрддрд┐рддреНрд╡ рдореЗрдВ рдирд╣реАрдВ рд╣реЛрдиреЗ рдкрд░, рд╕реНрдЯреИрдВрдбрдмрд╛рдИ рд░рд╛рдЙрдЯрд░ рдкреНрд░рд╛рдердорд┐рдХ рднреВрдорд┐рдХрд╛ рдХреЛ рд╕рдВрднрд╛рд▓реЗрдЧрд╛ рдФрд░ рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░ рдХреЗ рдХрд░реНрддрд╡реНрдпреЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓реЗрдЧрд╛ред\
**HSRP рд╕рдореВрд╣** - рдПрдХ рд╕рдореВрд╣ рдЙрдкрдХрд░рдг рдЬреЛ рдПрдХ рддрд╛рд░реНрдХрд┐рдХ рд░рд╛рдЙрдЯрд░ рдХреА рд╕рдВрдЪрд╛рд▓рди рдФрд░ рддреНрд░реБрдЯрд┐ рд╕рд╣рдирд╢реАрд▓рддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИред\
**HSRP MAC рдкрддрд╛** - HSRP рдбреЛрдореЗрди рдореЗрдВ рддрд╛рд░реНрдХрд┐рдХ рд░рд╛рдЙрдЯрд░ рдХрд╛ рд╡рд░реНрдЪреБрдЕрд▓ MAC рдкрддрд╛ред\
**HSRP рд╡рд░реНрдЪреБрдЕрд▓ рдЖрдИрдкреА рдкрддрд╛** - рдпрд╣ HSRP рд╕рдореВрд╣ рдореЗрдВ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдЪреБрдЕрд▓ рдЖрдИрдкреА рдкрддрд╛ рд╣реИред рдЗрд╕ рдЖрдИрдкреА рдкрддреЗ рдХреЛ рдЕрдВрддрд┐рдо рдореЗрдЬрдмрд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬреЛ рддрд╛рд░реНрдХрд┐рдХ рд░рд╛рдЙрдЯрд░ рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

### HSRP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕рдВрд╕реНрдХрд░рдг <a href="#eda3" id="eda3"></a>

HSRP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рджреЛ рд╕рдВрд╕реНрдХрд░рдг рд╣реИрдВ - HSRPv1 рдФрд░ HSRPv2ред рдЗрдирдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдореЗрдВ рдЕрдВрддрд░ рд╣реЛрддрд╛ рд╣реИ:

* **рд╕рдВрднрд╛рд╡рд┐рдд рддрд╛рд░реНрдХрд┐рдХ рд╕рдореВрд╣реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ред** HSRPv1 рдореЗрдВ рддрдХрд░реАрдмрди 255 рд╕рдореВрд╣ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред HSRPv2 рдореЗрдВ рддрдХрд░реАрдмрди 4096 рд╕рдореВрд╣ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ
* **рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдЖрдИрдкреА рдкрддрд╛ред** HSRPv1 рд╕реЗрд╡рд╛ рд╕реВрдЪрдирд╛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдИрдкреА рдкрддрд╛ **224.0.0.2** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдФрд░ HSRPv2 **224.0.0.102** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ
* **рд╡рд░реНрдЪреБрдЕрд▓ MAC рдкрддрд╛ред** HSRPv1 рдЕрдкрдиреЗ рд╡рд░реНрдЪреБрдЕрд▓ MAC рдкрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ **00:00:0C:07:AC:XX** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред HSRPv2 рдХрд╛ рд╡рд░реНрдЪреБрдЕрд▓ MAC рдкрддрд╛ **00:00:0C:9F:FX:XX** рд╣реИ (рдпрд╣рд╛рдВ XX HSRP рд╕рдореВрд╣ рд╕рдВрдЦреНрдпрд╛ рд╣реИ)

HSRP рдиреЗ рдЖрд░рдХреНрд╖рд┐рдд рдЖрдИрдкреА рдкрддрд╛ **224.0.0.2** рдпрд╛ **224.0.0.102** (HSRP рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░) рдФрд░ UDP рдкрд░рд┐рд╡рд╣рди рдкрд░рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрд╡рд╛ рд╕реВрдЪрдирд╛ рдХреЛ рдкреНрд░рд╕рд╛рд░рд┐рдд рдФрд░ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдкреЛрд░реНрдЯ рд╕рдВрдЦреНрдпрд╛ **1985** рд╣реЛрддреА рд╣реИред рд╡рд┐рд╢реЗрд╖ HSRP рд╣реИрд▓реЛ рдкреИрдХреЗрдЯ рд╣рд░ **3 рд╕реЗрдХрдВрдб рдореЗрдВ** рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред рдпрджрд┐ HSRP рд░рд╛рдЙрдЯрд░ рдХреЛ рдкрдбрд╝реЛрд╕реА рд╕реЗ рд╣реИрд▓реЛ рдкреИрдХреЗрдЯ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ **10 рд╕реЗрдХрдВрдб рдХреЗ рднреАрддрд░**, рддреЛ рдкрдбрд╝реЛрд╕реА "рдорд░рд╛ рд╣реБрдЖ" рдорд╛рдирд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ HSRP рдбреЛрдореЗрди рд╕реЗ рдмрд╛рд╣рд░ рдЫреВрдЯ рдЬрд╛рдПрдЧрд╛ред

### HSRP рд╣рдорд▓рд╛ рдореЗрдХреЗрдирд┐рдЬрд╝рдо <a href="#d4a3" id="d4a3"></a>

**рдпрд╣ рдмрд┐рд▓реНрдХреБрд▓ GLBP рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдХреЗ рд╕рдорд╛рди рд╣реИред рд╣рдореЗрдВ рдПрдХ рдЕрдзрд┐рдХрддрдо рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд╛рди рдХреЗ рд╕рд╛рде рдПрдХ рдЦрддрд░рдирд╛рдХ HSRP рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред** рдЗрд╕рд╕реЗ рд╣рдореЗрдВ рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░ рдХреА рднреВрдорд┐рдХрд╛ рдХреЛ рд╣рд╛рдЗрдЬреИрдХ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ, рдЬреЛ рдПрдХ **MITM** рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рджрд░рд╡рд╛рдЬрд╛ рдЦреЛрд▓рддрд╛ рд╣реИред рд▓реЗрдХрд┐рди рдлрд┐рд░ рднреА, рд╣рдореЗрдВ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рд╣реЛрдЧреА:

* **HSRP рдбреЛрдореЗрди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд╡рд░реНрдЪреБрдЕрд▓ рдЖрдИрдкреА рдкрддрд╛**
* **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдореМрдЬреВрджрдЧреА**
* **рд░рд╛рдЙрдЯрд░ рдкреНрд░рд╛рдердорд┐рдХрддрд╛рдУрдВ рдХреА рдорд╛рди**

рд╣рдо HSRP рдЯреНрд░реИрдлрд┐рдХ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдХреЗ рдЗ
```
~/cisconightmare/exfiltrate$ python2 hsrp2john.py hsrp_with_authentication.pcap
```
<figure><img src="../../.gitbook/assets/image (287).png" alt=""><figcaption><p>HSRP рдЯреНрд░реИрдлрд┐рдХ рдбрдВрдк рд╕реЗ рдирд┐рдХрд╛рд▓реЗ рдЧрдП MD5 рд╣реИрд╢</p></figcaption></figure>

рдореИрдВ **рдЬреЙрди рдж рд░рд┐рдкрд░** рдХреЗ рд╕рд╛рде рд╣реИрд╢ рдХреЛ рдХреНрд░реИрдХ рдХрд░реВрдВрдЧрд╛, рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд╣реИрд╢ рд╕реНрд╡рдпрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реЗрдВрдЧрд╛ред рдФрд░ **рд╡рд░реНрдбрд▓рд┐рд╕реНрдЯ** рд╕реНрд╡рд┐рдЪ рдХреЗ рд╕рд╛рде рдореИрдВ рд╢рдмреНрджрдХреЛрд╢ рдХреЗ рдкрде рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░реВрдВрдЧрд╛:
```
~/cisconightmare/exfiltrate$ john hsrp_hashes --wordlist=wordlistforbrute
```
<figure><img src="../../.gitbook/assets/image (203).png" alt=""><figcaption><p>рдЯреВрдЯреА рд╣реБрдИ HSRP рдбреЛрдореЗрди рдкрд╛рд╕рд╡рд░реНрдб</p></figcaption></figure>

рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ HSRP рдбреЛрдореЗрди рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдХреБрдВрдЬреА рд╣реИ - **endgame**.

### HSRP Injection (Loki) <a href="#6a2b" id="6a2b"></a>

рдореИрдВ HSRP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╣реА Loki рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реВрдВрдЧрд╛ред рдЗрд╕рдореЗрдВ рдЕрдиреНрдп рдЪреАрдЬреЛрдВ рдХреЗ рдмреАрдЪ, рдпрд╣ рдПрдХ рдХреБрдВрдЬреА рдЗрдВрдЬреЗрдХреНрд╢рди рд╕реБрд╡рд┐рдзрд╛ рд╣реИ, рдЬреЛ рд╣рдореЗрдВ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдЫреЛрдбрд╝рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреА рд╣реИред рдкрд╣рд▓реЗ, HSRP рд╣рд╛рдЗрдЬреИрдХрд┐рдВрдЧ рдЦрдВрдб рдореЗрдВ, рд╣рдордиреЗ HSRP рдбреЛрдореЗрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХреА рдереАред

Loki рд╢реБрд░реВ рдХрд░рдирд╛ред

<figure><img src="../../.gitbook/assets/image (309).png" alt=""><figcaption><p>Loki рдиреЗ HSRP рд╡рд┐рдЬреНрдЮрд╛рдкрдиреЛрдВ рдХреЛ рдкрд╣рдЪрд╛рдирд╛</p></figcaption></figure>

рд╣рдорд▓рд╛ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдкреНрд░реЛрдорд┐рд╕реНрдХреНрдпреВрдЕрд╕ рдореЛрдб рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░рдирд╛ рдФрд░ рдЯреНрд░реИрдлрд┐рдХ рд░реВрдЯрд┐рдВрдЧ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рди рднреВрд▓реЗрдВ:
```
~$ sudo ip link set eth0 promisc on
~$ sudo sysctl -w net.ipv4.ip_forward=1
```
рдЪрдпрди рдХрд░реЗрдВ рд░рд╛рдЙрдЯрд░ рдЬрд┐рд╕рдХрд╛ рдкрддрд╛ рд╣реИ **10.10.100.100** рдФрд░ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╣реИ **200**ред **рд╕реАрдХреНрд░реЗрдЯ** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ, HSRP рдбреЛрдореЗрди рд╕реЗ **рдХреНрд░реИрдХреНрдб рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░реЗрдВ**ред рдЧреНрд░реЗрдЯрд┐рдЯрд╕ рдПрдЖрд░рдкреА рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ рдФрд░ **рдЖрдИрдкреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ** рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред

<figure><img src="../../.gitbook/assets/image (192).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (237).png" alt=""><figcaption></figcaption></figure>

**рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░ рдЕрдм рд╣рдорд╛рд░реА рд╣рдорд▓рд╛рд╡рд░ рд╕рд┐рд╕реНрдЯрдо рд╣реИред рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд╛рди 255 рд╣реИред**

**рд╕рдВрдХреНрд░рдордг рдХреЗ рдмрд╛рдж, рд╣рдореЗрдВ рдЕрдкрдиреЗ рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдкрд░ рдПрдХ рд╕реЗрдХреЗрдВрдбрд░реА рдЖрдИрдкреА рдкрддрд╛ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдорд╛рди HSRP рдбреЛрдореЗрди рдореЗрдВ рд╡рд░реНрдЪреБрдЕрд▓ рдЖрдИрдкреА рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИред рдЖрдкрдХреЛ 24-рдмрд┐рдЯ рдорд╛рд╕реНрдХ рднреА рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ, рд╡реИрдз рдЯреНрд░реИрдлрд┐рдХ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд▓реВрдкрдмреИрдХ рд╣реЛ рдЬрд╛рдПрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рд╣реЛрд╕реНрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд░реНрдЪреБрдЕрд▓ рдЖрдИрдкреА рдкрддрд╛ HSRP рдбреЛрдореЗрди рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИред**
```
~$ sudo ifconfig eth0:1 10.10.100.254 netmask 255.255.255.0
```
**рд╣рдордиреЗ рдкреНрд░рд╕рд┐рджреНрдз рд╕реНрд░реЛрдд NAT (рдорд╛рд╕реНрдХрд░реЗрдбрд┐рдВрдЧ) рд╕реЗрдЯрдЕрдк рдХрд┐рдпрд╛ рд╣реИ рддрд╛рдХрд┐ рд╣рдо рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░ рд╕рдХреЗрдВ:**
```
~$ sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
```
**рд╣рдо рдЕрдкрдиреА рдорд╢реАрди рд╕реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдЯ рдХреЛ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВ рдФрд░ рдПрдХ рдирдпрд╛ рд░реВрдЯ рд▓рд┐рдЦрддреЗ рд╣реИрдВ рдЬреЛ рдкрд╣рд▓реЗ рд╕рдХреНрд░рд┐рдп рд░рд╛рдЙрдЯрд░ (рдЗрд╕рдХрд╛ рдкрддрд╛ 10.10.100.100 рд╣реИ) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдПрдЧрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╣рдордиреЗ рд░рд╛рдЙрдЯрд░ рд╕реЗ рд╕рдХреНрд░рд┐рдп рднреВрдорд┐рдХрд╛ рдХреЛ рд╣рдерд┐рдпрд╛ рд▓рд┐рдпрд╛ рд╣реИ, рдлрд┐рд░ рднреА рдпрд╣ рдЯреНрд░реИрдлрд╝рд┐рдХ рд░реВрдЯ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд░рдЦреЗрдЧрд╛ред**
```
~$ sudo route del default
~$ sudo route add -net 0.0.0.0 netmask 0.0.0.0 gw 10.10.100.100
```
**рдЕрдм рд╣рдо "рдореИрди рдЗрди рдж рдорд┐рдбрд▓" рд╣реИрдВред рдЪрд▓реЛ** [**net-creds.py**](https://github.com/DanMcInerney/net-creds)** рдХреЛ рдЪрд▓рд╛рддреЗ рд╣реИрдВ:**
```
~$ sudo python2 net-creds.py -i eth0
```
рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдЪрд▓рд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдореИрдВ 172.16.100.140 рдкрд░ рд╕реНрдерд┐рдд FTP рд╕рд░реНрд╡рд░ рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдлрд┐рд░ рд╕реЗ рдХрд░реВрдВрдЧрд╛:
```
~$ ftp 172.16.100.140
```
<figure><img src="../../.gitbook/assets/image (179).png" alt=""><figcaption></figcaption></figure>

рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдо FTP рд╕рд░реНрд╡рд░ рд╕реЗ рд╡рд┐рд╢реНрд╡рд╛рд╕рдкрддреНрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ: **insomnia:betrayal**

рдпрд╣рд╛рдВ рдЖрдк HSRP рдбреЛрдореЗрди рдкрд░ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдореВрд▓ рд░реВрдк рд╕реЗ, рд╕рдм рдХреБрдЫ GLBP рдХреЗ рд╕рдорд╛рди рд╣реИред

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT рд╕рдВрдЧреНрд░рд╣**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛред**

</details>
