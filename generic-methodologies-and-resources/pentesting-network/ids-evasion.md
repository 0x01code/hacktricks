{% hint style="success" %}
Apprenez et pratiquez le piratage AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Formation HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le piratage GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Formation HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}


# **Manipulation du TTL**

Envoyez des paquets avec un TTL suffisant pour arriver √† l'IDS/IPS mais pas suffisant pour arriver au syst√®me final. Ensuite, envoyez d'autres paquets avec les m√™mes s√©quences que les premiers pour que l'IPS/IDS pense qu'il s'agit de r√©p√©titions et ne les v√©rifie pas, alors qu'en r√©alit√© ils transportent un contenu malveillant.

**Option Nmap :** `--ttlvalue <valeur>`

# √âviter les signatures

Ajoutez simplement des donn√©es inutiles aux paquets pour √©viter la signature de l'IPS/IDS.

**Option Nmap :** `--data-length 25`

# **Paquets fragment√©s**

Fragmentez simplement les paquets et envoyez-les. Si l'IDS/IPS n'a pas la capacit√© de les r√©assembler, ils arriveront √† l'h√¥te final.

**Option Nmap :** `-f`

# **Checksum invalide**

Les capteurs ne calculent g√©n√©ralement pas le checksum pour des raisons de performance. Ainsi, un attaquant peut envoyer un paquet qui sera **interpr√©t√© par le capteur mais rejet√© par l'h√¥te final.** Exemple :

Envoyez un paquet avec le drapeau RST et un checksum invalide, de sorte que l'IPS/IDS puisse penser que ce paquet va fermer la connexion, mais l'h√¥te final rejettera le paquet car le checksum est invalide.

# **Options IP et TCP non courantes**

Un capteur peut ignorer les paquets avec certains drapeaux et options d√©finis dans les en-t√™tes IP et TCP, tandis que l'h√¥te de destination accepte le paquet √† la r√©ception.

# **Chevauchement**

Il est possible que lors de la fragmentation d'un paquet, un certain chevauchement existe entre les paquets (peut-√™tre que les 8 premiers octets du paquet 2 chevauchent avec les 8 derniers octets du paquet 1, et les 8 derniers octets du paquet 2 chevauchent avec les 8 premiers octets du paquet 3). Ensuite, si l'IDS/IPS les r√©assemble de mani√®re diff√©rente de l'h√¥te final, un paquet diff√©rent sera interpr√©t√©.\
Ou peut-√™tre que 2 paquets avec le m√™me d√©calage arrivent et que l'h√¥te doit d√©cider lequel prendre.

* **BSD** : Il pr√©f√®re les paquets avec un _d√©calage_ plus petit. Pour les paquets avec le m√™me d√©calage, il choisira le premier.
* **Linux** : Comme BSD, mais il pr√©f√®re le dernier paquet avec le m√™me d√©calage.
* **Premier** (Windows) : La premi√®re valeur qui arrive, reste.
* **Dernier** (Cisco) : La derni√®re valeur qui arrive, reste.

# Outils

* [https://github.com/vecna/sniffjoke](https://github.com/vecna/sniffjoke)


{% hint style="success" %}
Apprenez et pratiquez le piratage AWS :<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**Formation HackTricks AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Apprenez et pratiquez le piratage GCP : <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**Formation HackTricks GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Soutenez HackTricks</summary>

* Consultez les [**plans d'abonnement**](https://github.com/sponsors/carlospolop)!
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Partagez des astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
{% endhint %}
