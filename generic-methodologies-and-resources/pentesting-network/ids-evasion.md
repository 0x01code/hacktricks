<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ会社**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**最新バージョンのPEASSにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- 独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションである[**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見してください。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**テレグラムグループ**](https://t.me/peass)に参加するか、**Twitter**で[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)を**フォロー**してください**.**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>


# **TTL Manipulation**

IDS/IPSに到達するだけのTTLを持つパケットをいくつか送信し、最終システムに到達するには十分ではないTTLを持つ別のパケットを送信します。そして、他のパケットと同じシーケンスを持つ別のパケットを送信することで、IPS/IDSはそれらが繰り返しであると思い込み、チェックしないでしょうが、実際には悪意のあるコンテンツを運んでいます。

**Nmapオプション:** `--ttlvalue <value>`

# 署名の回避

パケットにゴミデータを追加するだけで、IPS/IDSの署名を回避できます。

**Nmapオプション:** `--data-length 25`

# **フラグメント化されたパケット**

パケットをフラグメント化して送信します。IDS/IPSがそれらを再結合する能力を持っていない場合、それらは最終ホストに到着します。

**Nmapオプション:** `-f`

# **無効な** _**チェックサム**_

センサーは通常、パフォーマンスの理由からチェックサムを計算しません。したがって、攻撃者はチェックサムが無効なパケットを送信することができます。そのパケットはセンサーによって解釈されますが、最終ホストによっては拒否されます。例：

チェックサムが無効なRSTフラグを持つパケットを送信すると、IPS/IDSはこのパケットが接続を閉じるために送信されると思うかもしれませんが、最終ホストはチェックサムが無効であるため、パケットを破棄します。

# **一般的でないIPおよびTCPオプション**

センサーは、IPおよびTCPヘッダー内で特定のフラグとオプションが設定されたパケットを無視する場合がありますが、宛先ホストは受信時にパケットを受け入れます。

# **オーバーラップ**

パケットをフラグメント化すると、パケット間に重複が存在する可能性があります（たとえば、パケット2の最初の8バイトがパケット1の最後の8バイトと重複し、パケット2の最後の8バイトがパケット3の最初の8バイトと重複する）。その後、IDS/IPSが最終ホストとは異なる方法でそれらを再結合する場合、異なるパケットが解釈されます。\
または、同じオフセットを持つ2つのパケットが来て、ホストがどちらを選ぶかを決定しなければならない場合もあります。

* **BSD**: オフセットが小さいパケットを優先します。オフセットが同じ場合は、最初のパケットを選択します。
* **Linux**: BSDと同様ですが、同じオフセットの最後のパケットを優先します。
* **First** (Windows): 最初に来た値が残ります。
* **Last** (cisco): 最後に来た値が残ります。

# ツール

* [https://github.com/vecna/sniffjoke](https://github.com/vecna/sniffjoke)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ会社**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**最新バージョンのPEASSにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- 独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションである[**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見してください。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**テレグラムグループ**](https://t.me/peass)に参加するか、**Twitter**で[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)を**フォロー**してください**.**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>
