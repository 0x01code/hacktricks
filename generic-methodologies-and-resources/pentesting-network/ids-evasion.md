{% hint style="success" %}
Aprende y practica AWS Hacking: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}


# **Manipulaci칩n de TTL**

Env칤a algunos paquetes con un TTL suficiente para llegar al IDS/IPS pero no suficiente para llegar al sistema final. Luego, env칤a otros paquetes con las mismas secuencias que los anteriores para que el IPS/IDS piense que son repeticiones y no los verifique, pero en realidad llevan contenido malicioso.

**Opci칩n de Nmap:** `--ttlvalue <valor>`

# Evitar firmas

Simplemente agrega datos basura a los paquetes para evitar la firma del IPS/IDS.

**Opci칩n de Nmap:** `--data-length 25`

# **Paquetes fragmentados**

Simplemente fragmenta los paquetes y env칤alos. Si el IDS/IPS no tiene la capacidad de reensamblarlos, llegar치n al host final.

**Opci칩n de Nmap:** `-f`

# **Checksum** _**inv치lido**_

Los sensores generalmente no calculan el checksum por razones de rendimiento. Por lo tanto, un atacante puede enviar un paquete que ser치 **interpretado por el sensor pero rechazado por el host final.** Ejemplo:

Env칤a un paquete con la bandera RST y un checksum inv치lido, entonces, el IPS/IDS puede pensar que este paquete va a cerrar la conexi칩n, pero el host final descartar치 el paquete al ser el checksum inv치lido.

# **Opciones IP y TCP poco comunes**

Un sensor podr칤a ignorar paquetes con ciertas banderas y opciones establecidas dentro de los encabezados IP y TCP, mientras que el host de destino acepta el paquete al recibirlo.

# **Superposici칩n**

Es posible que al fragmentar un paquete, exista alg칰n tipo de superposici칩n entre los paquetes (quiz치s los primeros 8 bytes del paquete 2 se superponen con los 칰ltimos 8 bytes del paquete 1, y los 칰ltimos 8 bytes del paquete 2 se superponen con los primeros 8 bytes del paquete 3). Entonces, si el IDS/IPS los reensambla de manera diferente al host final, se interpretar치 un paquete diferente.\
O tal vez, lleguen 2 paquetes con el mismo desplazamiento y el host tenga que decidir cu치l tomar.

* **BSD**: Tiene preferencia por los paquetes con un _offset_ m치s peque침o. Para paquetes con el mismo offset, elegir치 el primero.
* **Linux**: Como BSD, pero prefiere el 칰ltimo paquete con el mismo offset.
* **Primero** (Windows): Primer valor que llega, valor que se queda.
* **칔ltimo** (cisco): 칔ltimo valor que llega, valor que se queda.

# Herramientas

* [https://github.com/vecna/sniffjoke](https://github.com/vecna/sniffjoke)


{% hint style="success" %}
Aprende y practica AWS Hacking: <img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Aprende y practica GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Apoya a HackTricks</summary>

* Revisa los [**planes de suscripci칩n**](https://github.com/sponsors/carlospolop)!
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤guenos** en **Twitter** 游냕 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Comparte trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
{% endhint %}
