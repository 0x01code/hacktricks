{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


# **TTL Manipulation**

IDS/IPSに到達するだけのTTLを持つパケットを送信し、最終システムに到達するには十分でないTTLを持つ別のパケットを送信します。そして、他のパケットと同じシーケンスで別のパケットを送信すると、IPS/IDSはそれらが繰り返しであると考えてチェックを行わず、実際には悪意のあるコンテンツを運んでいます。

**Nmapオプション:** `--ttlvalue <value>`

# シグネチャの回避

パケットにゴミデータを追加するだけで、IPS/IDSのシグネチャを回避できます。

**Nmapオプション:** `--data-length 25`

# **フラグメント化されたパケット**

パケットをフラグメント化して送信します。IDS/IPSがそれらを再結合する能力を持っていない場合、それらは最終ホストに到達します。

**Nmapオプション:** `-f`

# **無効なチェックサム**

通常、センサーはパフォーマンス上の理由からチェックサムを計算しません。したがって、攻撃者はチェックサムが無効なパケットを送信し、センサーによって解釈されますが、最終ホストによって拒否されます。例：

RSTフラグと無効なチェックサムを持つパケットを送信し、IPS/IDSはこのパケットが接続を閉じるために送信されると考えるかもしれませんが、最終ホストはチェックサムが無効であるためパケットを破棄します。

# **一般的でないIPおよびTCPオプション**

センサーは、IPおよびTCPヘッダー内で特定のフラグとオプションが設定されたパケットを無視する場合がありますが、宛先ホストは受信時にパケットを受け入れます。

# **オーバーラップ**

パケットをフラグメント化すると、パケット間にオーバーラップが存在する可能性があります（たとえば、パケット2の最初の8バイトがパケット1の最後の8バイトとオーバーラップし、パケット2の最後の8バイトがパケット3の最初の8バイトとオーバーラップする場合があります）。その後、IDS/IPSがそれらを最終ホストとは異なる方法で再組み立てる場合、異なるパケットが解釈される可能性があります。\
または、同じオフセットを持つ2つのパケットが来て、ホストはどちらを取るかを決定する必要があります。

* **BSD**: より小さいオフセットを持つパケットを優先します。同じオフセットを持つパケットの場合、最初のパケットを選択します。
* **Linux**: BSDと同様ですが、同じオフセットを持つ最後のパケットを優先します。
* **First** (Windows): 来た値が残る値です。
* **Last** (cisco): 来た最後の値が残る値です。

# ツール

* [https://github.com/vecna/sniffjoke](https://github.com/vecna/sniffjoke)


{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
