# Przejście obok segmentacji VLAN

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Pracujesz w **firmie zajmującej się cyberbezpieczeństwem**? Chcesz zobaczyć swoją **firmę reklamowaną w HackTricks**? A może chcesz mieć dostęp do **najnowszej wersji PEASS lub pobrać HackTricks w formacie PDF**? Sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* **Dołącz do** [**💬**](https://emojipedia.org/speech-balloon/) [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** mnie na **Twitterze** 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do repozytorium [hacktricks](https://github.com/carlospolop/hacktricks) i [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

Jeśli istnieje bezpośredni dostęp do przełącznika, można ominąć segmentację VLAN. Polega to na ponownej konfiguracji podłączonego portu w tryb trunks, ustanowieniu wirtualnych interfejsów dla docelowych VLAN-ów i ustawieniu adresów IP, dynamicznie (DHCP) lub statycznie, w zależności od scenariusza (**dodatkowe szczegóły można znaleźć pod adresem [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)).**

W pierwszej kolejności konieczne jest zidentyfikowanie konkretnego podłączonego portu. Można to zazwyczaj osiągnąć za pomocą wiadomości CDP lub poprzez wyszukiwanie portu za pomocą maski **include**.

**Jeśli CDP nie działa, można spróbować zidentyfikować port, wyszukując adres MAC**:
```
SW1(config)# show mac address-table | include 0050.0000.0500
```
Przed przejściem do trybu trunk, należy sporządzić listę istniejących VLAN-ów i ustalić ich identyfikatory. Następnie te identyfikatory są przypisywane do interfejsu, umożliwiając dostęp do różnych VLAN-ów poprzez trunk. Port, który jest używany, jest na przykład powiązany z VLAN-em 10.
```
SW1# show vlan brief
```
**Przejście do trybu trunk wymaga wejścia w tryb konfiguracji interfejsu**:
```
SW1(config)# interface GigabitEthernet 0/2
SW1(config-if)# switchport trunk encapsulation dot1q
SW1(config-if)# switchport mode trunk
```
Przełączenie na tryb trunk tymczasowo zakłóci łączność, ale można ją później przywrócić.

Następnie tworzone są wirtualne interfejsy, przypisywane są im identyfikatory VLAN i są aktywowane:
```bash
sudo vconfig add eth0 10
sudo vconfig add eth0 20
sudo vconfig add eth0 50
sudo vconfig add eth0 60
sudo ifconfig eth0.10 up
sudo ifconfig eth0.20 up
sudo ifconfig eth0.50 up
sudo ifconfig eth0.60 up
```
Następnie, zostaje wysłane żądanie adresu za pośrednictwem DHCP. W przypadkach, gdy DHCP nie jest możliwe, adresy mogą być skonfigurowane ręcznie:
```bash
sudo dhclient -v eth0.10
sudo dhclient -v eth0.20
sudo dhclient -v eth0.50
sudo dhclient -v eth0.60
```
Przykład ręcznego ustawienia statycznego adresu IP na interfejsie (VLAN 10):

```plaintext
1. Otwórz terminal i zaloguj się na urządzenie sieciowe.
2. Zidentyfikuj interfejs, na którym chcesz ustawić statyczny adres IP.
3. Wydaj polecenie `ifconfig` lub `ip addr show`, aby sprawdzić bieżące ustawienia interfejsu.
4. Wydaj polecenie `sudo ifconfig <interfejs> down`, aby wyłączyć interfejs.
5. Wydaj polecenie `sudo ifconfig <interfejs> <adres_IP> netmask <maska_sieci> up`, aby ustawić nowy adres IP i włączyć interfejs.
   Na przykład: `sudo ifconfig eth0 192.168.1.100 netmask 255.255.255.0 up`.
6. Sprawdź, czy nowy adres IP został pomyślnie ustawiony, wydając polecenie `ifconfig` lub `ip addr show`.
```

Pamiętaj, że powyższy przykład dotyczy ręcznego ustawienia statycznego adresu IP na interfejsie VLAN 10.
```bash
sudo ifconfig eth0.10 10.10.10.66 netmask 255.255.255.0
```
Konieczne jest przetestowanie łączności poprzez inicjowanie żądań ICMP do domyślnych bram dla VLAN 10, 20, 50 i 60.

Ostatecznie ten proces umożliwia obejście segmentacji VLAN, umożliwiając nielimitowany dostęp do dowolnej sieci VLAN i przygotowuje grunt dla kolejnych działań.

## Referencje

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Czy pracujesz w **firmie zajmującej się cyberbezpieczeństwem**? Chcesz zobaczyć, jak Twoja **firma jest reklamowana w HackTricks**? A może chcesz mieć dostęp do **najnowszej wersji PEASS lub pobrać HackTricks w formacie PDF**? Sprawdź [**PLAN SUBSKRYPCJI**](https://github.com/sponsors/carlospolop)!
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* **Dołącz do** [**💬**](https://emojipedia.org/speech-balloon/) [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** mnie na **Twitterze** 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR do repozytorium [hacktricks](https://github.com/carlospolop/hacktricks) i [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
