# Lateral VLAN Segmentation Bypass

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* **サイバーセキュリティ会社**で働いていますか？**HackTricksで会社の広告を掲載**したいですか？または、**最新版のPEASSを入手**したり、**HackTricksをPDFでダウンロード**したいですか？[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見してください。私たちの独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションです。
* [**公式のPEASS & HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* **[**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**テレグラムグループ**](https://t.me/peass)に**参加するか、**Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**に**フォローしてください。**
* **[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)にPRを提出して、ハッキングのコツを共有してください。**

</details>

スイッチへの直接アクセスが可能な場合、VLANセグメンテーションをバイパスすることができます。これには、接続されたポートをトランクモードに再設定し、対象VLANの仮想インターフェースを確立し、シナリオに応じて動的（DHCP）または静的にIPアドレスを設定することが含まれます（詳細についてはhttps://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9をチェックしてください）。

初めに、特定の接続ポートを識別する必要があります。これは通常、CDPメッセージを通じて、または**include**マスクを使用してポートを検索することで達成できます。

**CDPが動作していない場合、MACアドレスを検索することによってポート識別を試みることができます**：
```
SW1(config)# show mac address-table | include 0050.0000.0500
```
既存のVLANのリストを作成し、それらの識別子を決定することが、トランクモードに切り替える前に行うべきです。これらの識別子はインターフェースに割り当てられ、トランクを通じて様々なVLANへのアクセスを可能にします。例えば、使用中のポートはVLAN 10に関連付けられています。
```
SW1# show vlan brief
```
**トランクモードへの移行にはインターフェース設定モードへの入力が必要です**：
```
SW1(config)# interface GigabitEthernet 0/2
SW1(config-if)# switchport trunk encapsulation dot1q
SW1(config-if)# switchport mode trunk
```
```markdown
トランクモードへの切り替えは一時的に接続を中断しますが、その後で接続は回復できます。

仮想インターフェースを作成し、VLAN IDを割り当て、そして有効化します：
```
```
~$ sudo vconfig add eth0 10
~$ sudo vconfig add eth0 20
~$ sudo vconfig add eth0 50
~$ sudo vconfig add eth0 60
~$ sudo ifconfig eth0.10 up
~$ sudo ifconfig eth0.20 up
~$ sudo ifconfig eth0.50 up
~$ sudo ifconfig eth0.60 up
```
その後、DHCPを介してアドレス要求が行われます。DHCPが実行不可能な場合には、アドレスを手動で設定することもできます：
```
~$ sudo dhclient -v eth0.10
~$ sudo dhclient -v eth0.20
~$ sudo dhclient -v eth0.50
~$ sudo dhclient -v eth0.60
```
```
例：インターフェースに静的IPアドレスを手動で設定する（VLAN 10）：
```
```
~$ sudo ifconfig eth0.10 10.10.10.66 netmask 255.255.255.0
```
VLAN 10, 20, 50, および 60 のデフォルトゲートウェイに ICMP リクエストを開始することで接続性がテストされます。

最終的に、このプロセスにより VLAN セグメンテーションのバイパスが可能になり、任意の VLAN ネットワークへの制限なしのアクセスを容易にし、後続のアクションのための舞台を整えます。

# 参考文献

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* **サイバーセキュリティ会社**で働いていますか？ **HackTricksで会社の広告を掲載**したいですか？または、**最新版の PEASS を入手**したり、**HackTricks を PDF でダウンロード**したいですか？[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、私たちの独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションをご覧ください。
* [**公式の PEASS & HackTricks グッズ**](https://peass.creator-spring.com)を手に入れましょう。
* **[**💬**](https://emojipedia.org/speech-balloon/) [**Discord グループ**](https://discord.gg/hRep4RUj7f)や [**telegram グループ**](https://t.me/peass)に参加するか、**Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**にフォローしてください。**
* **[hacktricks リポジトリ](https://github.com/carlospolop/hacktricks)や [hacktricks-cloud リポジトリ](https://github.com/carlospolop/hacktricks-cloud)に PR を提出して、あなたのハッキングのコツを共有してください。**

</details>
