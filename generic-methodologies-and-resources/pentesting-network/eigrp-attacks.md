# Attaques EIGRP

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert AWS Red Team de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

**Cette page est bas√©e sur** [****](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9). Consultez-la pour plus d'informations.

## Compr√©hension des vuln√©rabilit√©s du protocole EIGRP <a href="#0f82" id="0f82"></a>

**EIGRP (Enhanced Interior Gateway Routing Protocol)** est identifi√© comme un protocole de routage dynamique de type vecteur de distance. Une vuln√©rabilit√© critique est observ√©e si l'authentification ou la configuration des interfaces passives sont n√©glig√©es, ce qui peut entra√Æner un empoisonnement potentiel des tables de routage. De plus, la structure du r√©seau EIGRP, ou du syst√®me autonome, n'est pas segment√©e, ne comportant aucune forme de divisions de zone. Cette structure plate implique que les routes inject√©es par un attaquant pourraient se propager dans l'ensemble du syst√®me autonome.

![](../../.gitbook/assets/image (25) (1).png)

La premi√®re √©tape pour exploiter un syst√®me EIGRP consiste √† √©tablir une connexion avec un routeur EIGRP l√©gitime. Cette connexion ouvre la voie √† diverses formes d'injections, allant de la reconnaissance √† diverses formes d'injections. Pour faciliter cela, [**FRRouting**](https://frrouting.org/), une solution open-source, est utilis√©e pour √©muler un routeur sur les syst√®mes Unix et Linux. **FRRouting** prend en charge plusieurs protocoles, y compris BGP, OSPF et EIGRP. Le d√©ploiement de FRRouting sur le syst√®me d'un attaquant leur permet de simuler un routeur l√©gitime dans le domaine de routage. Des instructions d√©taill√©es pour d√©ployer FRR sur votre syst√®me suivront.

### Collecte d'informations sur le r√©seau <a href="#41e6" id="41e6"></a>

L'int√©gration dans le domaine de routage permet l'√©num√©ration et la reconnaissance des r√©seaux, offrant une alternative efficace en termes de temps aux analyses approfondies. Cette approche permet non seulement de gagner du temps, mais aussi de r√©duire le risque de d√©tection par les syst√®mes de s√©curit√© IPS/IDS. Pour y parvenir, le d√©ploiement de **FRRouting** est n√©cessaire.

Des modifications sont n√©cessaires dans le fichier de configuration `daemons`, qui contr√¥le les activit√©s des d√©mons. L'activation du d√©mon **eigrpd** est n√©cessaire.
```bash
~# nano /etc/frr/daemons
eigrpd=yes
```
![](../../.gitbook/assets/image (15) (1).png)

De plus, des ajustements au fichier **vtysh.conf** sont n√©cessaires pour garantir que les configurations de divers protocoles sont consolid√©es dans un seul fichier.
```bash
~# nano /etc/frr/vtysh.conf
service integrated-vtysh-config
```
Apr√®s la configuration, le lancement du d√©mon FRR et l'activation du routage du trafic (d√©sactiv√© par d√©faut dans les distributions Linux) sont n√©cessaires.
```bash
~$ sudo systemctl start frr
~$ sudo sysctl -w net.ipv4.ip_forward=1
```
![](../../.gitbook/assets/image (32).png)

La commande **vtysh** fournit l'acc√®s au panneau de contr√¥le du routeur FRR.
```bash
~$ sudo vtysh
```
Exemple d'utilisation :
```bash
root# show version
```
> Note: Le domaine de routage EIGRP peut √™tre s√©curis√© avec une authentification. Cependant, un acc√®s potentiel est toujours possible en extrayant les hachages cryptographiques des paquets hello et en r√©initialisant le mot de passe.

Dans le mode de configuration global, initiez le processus **EIGRP** et d√©finissez le num√©ro du syst√®me autonome - **1**, ainsi que l'emplacement du r√©seau.
```bash
root# config
root(config)# router eigrp 1
root(config-router) network 10.10.100.50/32
```
Apr√®s l'√©tablissement des connexions de voisinage avec des routeurs EIGRP l√©gitimes (dans ce cas, **GW1 (10.10.100.100)** et **GW2 (10.10.100.200)**), les routeurs √©changent des informations de routage. Ce processus entra√Æne l'apparition de nouvelles routes dans la table de routage du syst√®me d'attaque, facilitant les tests de p√©n√©tration et √©conomisant du temps sur le balayage des sous-r√©seaux. √Ä ce stade, le syst√®me fait partie du domaine de routage EIGRP et est pr√™t pour le d√©veloppement de vecteurs d'attaque suppl√©mentaires.

![](../../.gitbook/assets/image (5) (1) (2).png)
![](../../.gitbook/assets/image (30) (1).png)
![](../../.gitbook/assets/image (29) (1) (2).png)

### Exploitation d'EIGRP : Vecteurs d'attaque <a href="#51ee" id="51ee"></a>

#### 1. Faux voisins EIGRP
L'envoi massif de paquets hello EIGRP peut entra√Æner une surcharge CPU sur les routeurs, ouvrant la voie aux attaques par d√©ni de service (DoS). Un script, **helloflooding.py**, est utilis√© √† cette fin, bien que sa vitesse d'envoi de paquets soit limit√©e par le GIL (Global Interpreter Lock). Des projets de r√©√©criture du script en C pour des performances am√©lior√©es sont en cours.

![](../../.gitbook/assets/image (2) (6) (1).png)

L'utilisation du script implique de sp√©cifier :
- Interface r√©seau (par exemple, eth0)
- Num√©ro de syst√®me autonome EIGRP (par exemple, 1)
- Emplacement du sous-r√©seau (par exemple, 10.10.100.0/24)
```bash
~$ sudo python3 helloflooding.py --interface eth0 --as 1 --subnet 10.10.100.0/24
```
#### 2. EIGRP Blackhole
Cette attaque implique l'injection d'une fausse route pour perturber le flux de trafic, commun√©ment appel√©e attaque Blackhole. Le script **routeinject.py** est utilis√© √† cette fin. Par exemple, rediriger le trafic pour `172.16.100.140/32` vers une destination inexistante.

![](../../.gitbook/assets/image (16) (1).png)

Les param√®tres du script incluent :
- Interface du syst√®me de l'attaquant
- Num√©ro AS EIGRP
- Adresse IP de l'attaquant
- IP du sous-r√©seau cible et son masque
```bash
~$ sudo python3 routeinject.py --interface eth0 --as 1 --src 10.10.100.50 --dst 172.16.100.140 --prefix 32
```
![](../../.gitbook/assets/image (20) (1).png)

Le r√©sultat est une perte de connectivit√© avec l'h√¥te cibl√© en raison de l'injection de route.

![](../../.gitbook/assets/image (6) (1) (1).png)

#### 3. Abus des valeurs K
Des valeurs K incompatibles entre les routeurs EIGRP peuvent perturber le domaine EIGRP. Le script **relationshipnightmare.py** exploite cela en injectant des valeurs K modifi√©es, d√©clenchant des perturbations et reconnexions continues au sein du domaine EIGRP, aboutissant efficacement √† une attaque par d√©ni de service (DoS).

![](../../.gitbook/assets/image (12) (2) (1).png)

Le script n√©cessite :
- Interface r√©seau
- Num√©ro AS EIGRP
- Adresse IP d'un routeur l√©gitime

Les alt√©rations inject√©es sont envoy√©es depuis l'IP sp√©cifi√©e vers l'adresse IP EIGRP multicast, provoquant la discordance.
```bash
~$ sudo python3 relationshipnightmare.py --interface eth0 --as 1 --src 10.10.100.100
```
![](../../.gitbook/assets/image (9) (1) (4).png)
![](../../.gitbook/assets/image (27) (1).png)

#### 4. D√©bordement de la table de routage
Cette attaque inonde la table de routage avec de fausses routes, surchargeant le processeur et la RAM du routeur. Le script **routingtableoverflow.py** facilite cela en envoyant rapidement de nombreuses fausses routes.

![](../../.gitbook/assets/image (3) (4).png)

Param√®tres du script :
- Interface r√©seau
- Num√©ro AS EIGRP
- Adresse IP de l'attaquant

Apr√®s l'ex√©cution du script, la table de routage est satur√©e de fausses routes, affectant gravement les performances du routeur.
```bash
sudo python3 routingtableoverflow.py --interface eth0 --as 1 --src 10.10.100.50
```
<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@hacktricks_live**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
