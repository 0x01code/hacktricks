# Attaques EIGRP

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

**Cette page est bas√©e sur** [****](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9). Consultez-le pour plus d'informations.

## Comprendre les vuln√©rabilit√©s du protocole EIGRP <a href="#0f82" id="0f82"></a>

**EIGRP (Enhanced Interior Gateway Routing Protocol)** est identifi√© comme un protocole de routage dynamique √† vecteur de distance. Une vuln√©rabilit√© critique est observ√©e si l'authentification ou la configuration des interfaces passives sont n√©glig√©es, conduisant √† un empoisonnement potentiel des tables de routage. De plus, la structure du r√©seau EIGRP, ou syst√®me autonome, est non segment√©e, sans aucune forme de divisions de zones. Cette structure plate implique que les routes inject√©es par un attaquant pourraient se propager √† travers tout le syst√®me autonome.

![](../../.gitbook/assets/image (25) (1).png)

La premi√®re √©tape pour exploiter un syst√®me EIGRP implique d'√©tablir une connexion avec un routeur EIGRP l√©gitime. Cette connexion ouvre des voies allant de la reconnaissance √† diverses formes d'injections. Pour faciliter cela, [**FRRouting**](https://frrouting.org/), une solution open-source, est utilis√©e pour √©muler un routeur sur les syst√®mes Unix et Linux. **FRRouting** prend en charge de multiples protocoles incluant BGP, OSPF et EIGRP. Le d√©ploiement de FRRouting sur le syst√®me d'un attaquant lui permet de mimer un routeur l√©gitime au sein du domaine de routage. Des instructions d√©taill√©es pour d√©ployer FRR sur votre syst√®me suivront.

### Collecte de renseignements sur le r√©seau <a href="#41e6" id="41e6"></a>

L'int√©gration dans le domaine de routage permet l'√©num√©ration et la reconnaissance des r√©seaux, offrant une alternative efficace en temps √† l'analyse extensive. Cette approche permet non seulement de gagner du temps, mais aussi de r√©duire le risque de d√©tection par les syst√®mes de s√©curit√© IPS/IDS. Pour y parvenir, le d√©ploiement de **FRRouting** est n√©cessaire.

Des modifications sont requises dans le fichier de configuration `daemons`, qui contr√¥le les activit√©s des daemons. L'activation du daemon **eigrpd** est n√©cessaire.
```bash
~# nano /etc/frr/daemons
eigrpd=yes
```
![](../../.gitbook/assets/image (15) (1).png)

De plus, des ajustements au fichier **vtysh.conf** sont n√©cessaires pour garantir que les configurations de divers protocoles soient consolid√©es dans un seul fichier.
```bash
~# nano /etc/frr/vtysh.conf
service integrated-vtysh-config
```
Apr√®s la configuration, l'initiation du d√©mon FRR et l'activation du routage du trafic (d√©sactiv√© par d√©faut dans les distributions Linux) sont n√©cessaires.
```bash
~$ sudo systemctl start frr
~$ sudo sysctl -w net.ipv4.ip_forward=1
```
```markdown
![](../../.gitbook/assets/image (32).png)

La commande **vtysh** donne acc√®s au panneau de contr√¥le du routeur FRR.
```
```bash
~$ sudo vtysh
```
Utilisation exemple :
```bash
root# show version
```
```markdown
![](../../.gitbook/assets/image (3) (2) (2).png)

> Remarque : Le domaine de routage EIGRP peut √™tre s√©curis√© avec une authentification. Cependant, un acc√®s potentiel est toujours possible en extrayant les hachages cryptographiques des paquets hello et en r√©initialisant le mot de passe.

Dans le mode de configuration globale, initiez le processus **EIGRP** et d√©finissez le num√©ro du syst√®me autonome ‚Äî **1**, ainsi que l'emplacement du r√©seau.
```
```bash
root# config
root(config)# router eigrp 1
root(config-router) network 10.10.100.50/32
```
Apr√®s l'√©tablissement de connexions de voisinage avec des routeurs EIGRP l√©gitimes (dans ce cas, **GW1 (10.10.100.100)** et **GW2 (10.10.100.200)**), les routeurs √©changent des informations de routage. Ce processus entra√Æne l'apparition de nouvelles routes dans la table de routage du syst√®me attaquant, aidant dans le pentesting et √©conomisant du temps sur le balayage des sous-r√©seaux. √Ä ce stade, le syst√®me fait partie du domaine de routage EIGRP et est pr√™t pour le d√©veloppement de vecteurs d'attaque suppl√©mentaires.

![](../../.gitbook/assets/image (5) (1) (2).png)
![](../../.gitbook/assets/image (30) (1).png)
![](../../.gitbook/assets/image (29) (1) (2).png)

### Exploitation d'EIGRP : Vecteurs d'Attaque <a href="#51ee" id="51ee"></a>

#### 1. Faux Voisins EIGRP
L'envoi massif de paquets hello EIGRP peut conduire √† une surcharge du CPU sur les routeurs, ouvrant la voie √† des attaques DoS. Un script, **helloflooding.py**, est utilis√© pour cela, bien que sa vitesse d'envoi de paquets soit limit√©e par le GIL (Global Interpreter Lock). Des plans pour r√©√©crire le script en C afin d'am√©liorer les performances sont en cours.

![](../../.gitbook/assets/image (2) (6) (1).png)

L'utilisation du script implique de sp√©cifier :
- L'interface r√©seau (par exemple, eth0)
- Le num√©ro de syst√®me autonome EIGRP (par exemple, 1)
- L'emplacement du sous-r√©seau (par exemple, 10.10.100.0/24)
```bash
~$ sudo python3 helloflooding.py --interface eth0 --as 1 --subnet 10.10.100.0/24
```
```markdown
![](../../.gitbook/assets/image (26) (1).png)

#### 2. Attaque par trou noir EIGRP
Cette attaque consiste √† injecter une fausse route pour perturber le flux de trafic, commun√©ment appel√©e attaque par trou noir. Le script **routeinject.py** est utilis√© √† cet effet. Par exemple, rediriger le trafic pour `172.16.100.140/32` vers une destination inexistante.

![](../../.gitbook/assets/image (16) (1).png)

Les param√®tres du script incluent :
- Interface syst√®me de l'attaquant
- Num√©ro AS EIGRP
- Adresse IP de l'attaquant
- IP du sous-r√©seau cible et son masque
```
```bash
~$ sudo python3 routeinject.py --interface eth0 --as 1 --src 10.10.100.50 --dst 172.16.100.140 --prefix 32
```
![](../../.gitbook/assets/image (20) (1).png)

Le r√©sultat est une perte de connectivit√© √† l'h√¥te cibl√© en raison de l'injection de route.

![](../../.gitbook/assets/image (6) (1) (1).png)

#### 3. Exploitation des K-Values
Des K-values incompatibles entre les routeurs EIGRP peuvent perturber le domaine EIGRP. Le script **relationshipnightmare.py** exploite cela en injectant des K-values modifi√©es, provoquant des perturbations continues et des reconnexions au sein du domaine EIGRP, aboutissant effectivement √† une attaque DoS.

![](../../.gitbook/assets/image (12) (2) (1).png)

Le script n√©cessite :
- Interface r√©seau
- Num√©ro AS EIGRP
- Adresse IP d'un routeur l√©gitime

Les modifications inject√©es sont envoy√©es de l'IP sp√©cifi√©e √† l'adresse IP multicast EIGRP, causant l'incompatibilit√©.
```bash
~$ sudo python3 relationshipnightmare.py --interface eth0 --as 1 --src 10.10.100.100
```
#### 4. D√©bordement de la Table de Routage
Cette attaque inonde la table de routage avec de fausses routes, sollicitant fortement le CPU et la RAM du routeur. Le script **routingtableoverflow.py** facilite cela en envoyant rapidement de nombreuses fausses routes.

Param√®tres du script :
- Interface r√©seau
- Num√©ro AS EIGRP
- Adresse IP de l'attaquant

Apr√®s l'ex√©cution du script, la table de routage est satur√©e de routes fallacieuses, affectant gravement les performances du routeur.
```bash
sudo python3 routingtableoverflow.py --interface eth0 --as 1 --src 10.10.100.50
```
![](../../.gitbook/assets/image (4) (4).png)
![](../../.gitbook/assets/image (21) (1).png)

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez**-moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
