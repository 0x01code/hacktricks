# iOS Fridaの設定

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* **サイバーセキュリティ会社**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。
* [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**。**
* **ハッキングのトリックを共有するには、PRを** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **と** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **に提出してください。**

</details>

## Fridaのインストール

Jailbrokenデバイスの**Cydia/Sileo**アプリに移動し、**Manage -> Sources -> Edit -> Add**に移動してFridaのリポジトリを追加します。[**https://build.frida.re** ](https://build.frida.re)を入力します。これにより、ソースリストに新しいソースが追加されます。Fridaのパッケージを**Frida** **ソース**に移動して**インストール**します。

![](https://miro.medium.com/max/614/0\*qSD26kBtgt\_UIZk1.png)

**Corellium**を使用している場合は、Fridaのリリースを[https://github.com/frida/frida/releases](https://github.com/frida/frida/releases)からダウンロードする必要があります（`frida-gadget-[yourversion]-ios-universal.dylib.gz`）。展開してFridaが要求するdylibの場所にコピーします。例：`/Users/[youruser]/.cache/frida/gadget-ios.dylib`

インストール後、PCでコマンド**`frida-ls-devices`**を使用してデバイスが表示されるかどうかを確認できます（PCはアクセスできる必要があります）。\
また、**`frida-ps -Uia`**を実行して、電話の実行中のプロセスを確認します。

## JailbrokenデバイスなしでのFridaの使用とアプリのパッチなし

アプリのパッチなしでJailbrokenデバイス以外でFridaを使用する方法については、次のブログ記事を参照してください：[https://mrbypass.medium.com/unlocking-potential-exploring-frida-objection-on-non-jailbroken-devices-without-application-ed0367a84f07](https://mrbypass.medium.com/unlocking-potential-exploring-frida-objection-on-non-jailbroken-devices-without-application-ed0367a84f07)

## Fridaクライアントのインストール

**fridaツール**をインストールします：
```bash
pip install frida-tools
pip install frida
```
Fridaサーバーがインストールされ、デバイスが実行され、接続されている場合、クライアントが動作しているかどうかを**確認**してください。
```bash
frida-ls-devices  # List devices
frida-ps -Uia     # Get running processes
```
## Fridaトレース

Frida Traceは、iOSアプリケーションの実行中に関数呼び出しやメソッド呼び出しをトレースするための強力なツールです。Frida Traceを使用すると、アプリケーションの内部動作を理解し、セキュリティ上の脆弱性を特定することができます。

### Frida Traceのセットアップ

Frida Traceを使用するには、まずFridaをiOSデバイスにインストールする必要があります。Fridaをインストールするには、以下の手順に従ってください。

1. iOSデバイスでCydiaを起動します。
2. 「ソース」タブを選択し、「編集」をタップします。
3. 「追加」をタップし、FridaのリポジトリURL（https://build.frida.re）を入力します。
4. リポジトリが追加されたら、「検索」タブを選択し、Fridaを検索します。
5. Fridaパッケージを選択し、「インストール」をタップします。

Fridaがインストールされたら、次にFrida Traceをセットアップします。以下の手順に従ってください。

1. iOSデバイスでTerminalを起動します。
2. `frida-ps -U`コマンドを実行して、デバイス上で実行中のプロセスを確認します。
3. プロセスの一覧からトレースしたいアプリケーションのバンドルIDを見つけます。
4. `frida-trace -U -p <バンドルID>`コマンドを実行して、Frida Traceを起動します。

### Frida Traceの使用方法

Frida Traceを使用すると、アプリケーション内の関数やメソッドの呼び出しをトレースすることができます。以下の手順に従って、Frida Traceを使用してトレースを実行します。

1. Frida Traceが起動したら、トレースしたい関数やメソッドのシグネチャを指定します。例えば、`-i "className.methodName"`のように指定します。
2. トレースしたい関数やメソッドの引数や戻り値を表示する場合は、`-I`オプションを使用します。
3. トレースを開始するには、`start()`関数を呼び出します。
4. アプリケーションを操作して、トレースしたい関数やメソッドが呼び出されるようにします。
5. トレースを停止するには、`exit()`関数を呼び出します。

トレースが終了したら、Frida Traceは関数やメソッドの呼び出しログを表示します。これにより、アプリケーションの内部動作を詳細に分析することができます。

### Frida Traceの応用

Frida Traceは、アプリケーションのセキュリティ評価や脆弱性診断に役立ちます。以下のような応用例があります。

- 機密情報の漏洩を防ぐために、特定の関数やメソッドが適切に処理されているかを確認する。
- パスワードやトークンなどの機密情報が正しく暗号化されているかを確認する。
- メモリ操作やネットワーク通信などのセキュリティ上のリスクを特定する。

Frida Traceを使用することで、iOSアプリケーションのセキュリティを向上させるための洞察を得ることができます。
```bash
# Trace all methods of all classes
frida-trace -U <program> -m "*[* *]"

# Trace all methods with the word "authentication" from classes that start with "NE"
frida-trace -U <program> -m "*[NE* *authentication*]"
```
### すべてのクラスとメソッドを取得する

* 使用可能なすべてのクラスを取得する（文字列でフィルタリング）

{% code title="/tmp/script.js" %}
```javascript
// frida -U <program> -l /tmp/script.js

var filterClass = "filterstring";

if (ObjC.available) {
for (var className in ObjC.classes) {
if (ObjC.classes.hasOwnProperty(className)) {
if (!filterClass || className.includes(filterClass)) {
console.log(className);
}
}
}
} else {
console.log("Objective-C runtime is not available.");
}
```
{% endcode %}

* クラスの**すべてのメソッド**を取得する（文字列でフィルタリング）

{% code title="/tmp/script.js" %}
```javascript
// frida -U <program> -l /tmp/script.js

var specificClass = "YourClassName";
var filterMethod = "filtermethod";

if (ObjC.available) {
if (ObjC.classes.hasOwnProperty(specificClass)) {
var methods = ObjC.classes[specificClass].$ownMethods;
for (var i = 0; i < methods.length; i++) {
if (!filterMethod || methods[i].includes(filterClass)) {
console.log(specificClass + ': ' + methods[i]);
}
}
} else {
console.log("Class not found.");
}
} else {
console.log("Objective-C runtime is not available.");
}
```
{% endcode %}

## Frida Android チュートリアル

{% content-ref url="../android-app-pentesting/frida-tutorial/" %}
[frida-tutorial](../android-app-pentesting/frida-tutorial/)
{% endcontent-ref %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* あなたは **サイバーセキュリティ会社**で働いていますか？ HackTricksであなたの会社を宣伝したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。
* [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローしてください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ハッキングのトリックを共有するために、PRを** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **と** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **に提出してください。**

</details>
