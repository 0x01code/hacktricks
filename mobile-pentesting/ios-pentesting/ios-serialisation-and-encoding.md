<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert de l'√©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

Code et plus d'informations sur [https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/#object-persistence](https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/#object-persistence).

## S√©rialisation d'objets dans le d√©veloppement iOS

En iOS, la **s√©rialisation d'objets** consiste √† convertir des objets dans un format pouvant √™tre facilement stock√© ou transmis, puis √† les reconstruire √† partir de ce format en cas de besoin. Deux protocoles principaux, **`NSCoding`** et **`NSSecureCoding`**, facilitent ce processus pour les sous-classes Objective-C ou `NSObject`, permettant aux objets d'√™tre s√©rialis√©s en **`NSData`**, un format qui enveloppe des tampons d'octets.

### Impl√©mentation de **`NSCoding`**
Pour impl√©menter `NSCoding`, une classe doit h√©riter de `NSObject` ou √™tre marqu√©e comme `@objc`. Ce protocole exige l'impl√©mentation de deux m√©thodes pour encoder et d√©coder les variables d'instance :
```swift
class CustomPoint: NSObject, NSCoding {
var x: Double = 0.0
var name: String = ""

func encode(with aCoder: NSCoder) {
aCoder.encode(x, forKey: "x")
aCoder.encode(name, forKey: "name")
}

required convenience init?(coder aDecoder: NSCoder) {
guard let name = aDecoder.decodeObject(forKey: "name") as? String else { return nil }
self.init(x: aDecoder.decodeDouble(forKey: "x"), name: name)
}
}
```
### **Am√©liorer la s√©curit√© avec `NSSecureCoding`**
Pour att√©nuer les vuln√©rabilit√©s o√π les attaquants injectent des donn√©es dans des objets d√©j√† construits, **`NSSecureCoding`** offre un protocole am√©lior√©. Les classes conformes √† `NSSecureCoding` doivent v√©rifier le type d'objets lors du d√©codage, garantissant que seuls les types d'objets attendus sont instanci√©s. Cependant, il est crucial de noter que bien que `NSSecureCoding` am√©liore la s√©curit√© des types, il n'encrypte pas les donn√©es ou n'assure pas leur int√©grit√©, n√©cessitant des mesures suppl√©mentaires pour prot√©ger les informations sensibles:
```swift
static var supportsSecureCoding: Bool {
return true
}

let obj = decoder.decodeObject(of: MyClass.self, forKey: "myKey")
```
## Archivage de donn√©es avec `NSKeyedArchiver`
`NSKeyedArchiver` et son homologue, `NSKeyedUnarchiver`, permettent d'encoder des objets dans un fichier et de les r√©cup√©rer ult√©rieurement. Ce m√©canisme est utile pour persister des objets :
```swift
NSKeyedArchiver.archiveRootObject(customPoint, toFile: "/path/to/archive")
let customPoint = NSKeyedUnarchiver.unarchiveObjectWithFile("/path/to/archive") as? CustomPoint
```
### Utilisation de `Codable` pour une s√©rialisation simplifi√©e
Le protocole `Codable` de Swift combine `Decodable` et `Encodable`, facilitant l'encodage et le d√©codage d'objets tels que `String`, `Int`, `Double`, etc., sans effort suppl√©mentaire :
```swift
struct CustomPointStruct: Codable {
var x: Double
var name: String
}
```
Cet approche prend en charge la s√©rialisation simple vers et depuis des listes de propri√©t√©s et du JSON, am√©liorant la manipulation des donn√©es dans les applications Swift.

## Alternatives d'encodage JSON et XML
Au-del√† du support natif, plusieurs biblioth√®ques tierces offrent des capacit√©s d'encodage/d√©codage JSON et XML, chacune avec ses propres caract√©ristiques de performance et consid√©rations de s√©curit√©. Il est imp√©ratif de s√©lectionner soigneusement ces biblioth√®ques, en particulier pour att√©nuer les vuln√©rabilit√©s telles que les attaques XXE (Entit√©s Externes XML) en configurant les analyseurs pour emp√™cher le traitement des entit√©s externes.

### Consid√©rations de s√©curit√©
Lors de la s√©rialisation des donn√©es, en particulier vers le syst√®me de fichiers, il est essentiel de rester vigilant quant √† l'√©ventuelle inclusion d'informations sensibles. Les donn√©es s√©rialis√©es, si elles sont intercept√©es ou mal g√©r√©es, peuvent exposer les applications √† des risques tels que des actions non autoris√©es ou des fuites de donn√©es. Il est recommand√© de chiffrer et de signer les donn√©es s√©rialis√©es pour renforcer la s√©curit√©.


## R√©f√©rences
* [https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/#object-persistence](https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/#object-persistence)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
