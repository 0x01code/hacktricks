<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe suas t√©cnicas de hacking enviando PRs para o [reposit√≥rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


**P√°gina copiada de** [**https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#universal-links**](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#universal-links)

Se voc√™ s√≥ tem o IPA do aplicativo ou simplesmente o aplicativo instalado em um dispositivo com jailbreak, normalmente n√£o poder√° encontrar arquivos `.entitlements`. Isso tamb√©m pode ser o caso do arquivo `embedded.mobileprovision`. Ainda assim, voc√™ deve ser capaz de extrair as listas de propriedades de direitos do aplicativo bin√°rio (que voc√™ obteve anteriormente, conforme explicado no cap√≠tulo "Teste de seguran√ßa b√°sica do iOS", se√ß√£o "Obtendo o bin√°rio do aplicativo").

As seguintes etapas devem funcionar mesmo ao direcionar um bin√°rio criptografado. Se, por algum motivo, eles n√£o funcionarem, voc√™ ter√° que descriptografar e extrair o aplicativo com, por exemplo, Clutch (se compat√≠vel com sua vers√£o do iOS), frida-ios-dump ou similar.

**Extraindo a lista de propriedades de direitos do aplicativo bin√°rio**

Se voc√™ tiver o bin√°rio do aplicativo em seu computador, uma abordagem √© usar o binwalk para extrair (`-e`) todos os arquivos XML (`-y=xml`):
```bash
$ binwalk -e -y=xml ./Telegram\ X

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1430180       0x15D2A4        XML document, version: "1.0"
1458814       0x16427E        XML document, version: "1.0"
```
Ou voc√™ pode usar o radare2 (`-qc` para executar silenciosamente um comando e sair) para pesquisar todas as strings no bin√°rio do aplicativo (`izz`) contendo "PropertyList" (`~PropertyList`):
```bash
$ r2 -qc 'izz~PropertyList' ./Telegram\ X

0x0015d2a4 ascii <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<!DOCTYPE plist PUBLIC
"-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">\n<plist version="1.0">
...<key>com.apple.security.application-groups</key>\n\t\t<array>
\n\t\t\t<string>group.ph.telegra.Telegraph</string>...

0x0016427d ascii H<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE plist PUBLIC
"-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">\n<plist version="1.0">\n
<dict>\n\t<key>cdhashes</key>...
```
Em ambos os casos (binwalk ou radare2), conseguimos extrair os mesmos dois arquivos `plist`. Se inspecionarmos o primeiro (0x0015d2a4), veremos que conseguimos recuperar completamente o [arquivo de direitos originais do Telegram](https://github.com/peter-iakovlev/Telegram-iOS/blob/77ee5c4dabdd6eb5f1e2ff76219edf7e18b45c00/Telegram-iOS/Telegram-iOS-AppStoreLLC.entitlements).

> Nota: o comando `strings` n√£o ajudar√° aqui, pois n√£o ser√° capaz de encontrar essas informa√ß√µes. √â melhor usar o grep com a op√ß√£o `-a` diretamente no bin√°rio ou usar o radare2 (`izz`)/rabin2 (`-zz`).

Se voc√™ acessar o bin√°rio do aplicativo no dispositivo com jailbreak (por exemplo, via SSH), pode usar o grep com a op√ß√£o `-a, --text` (trata todos os arquivos como texto ASCII):
```bash
$ grep -a -A 5 'PropertyList' /var/containers/Bundle/Application/
    15E6A58F-1CA7-44A4-A9E0-6CA85B65FA35/Telegram X.app/Telegram\ X

<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
    <dict>
        <key>com.apple.security.application-groups</key>
        <array>
        ...
```
Brinque com a flag `-A num, --after-context=num` para exibir mais ou menos linhas. Voc√™ tamb√©m pode usar ferramentas como as que apresentamos acima, se tiverem sido instaladas em seu dispositivo iOS com jailbreak.

> Este m√©todo deve funcionar mesmo se o bin√°rio do aplicativo ainda estiver criptografado (foi testado em v√°rios aplicativos da App Store).
