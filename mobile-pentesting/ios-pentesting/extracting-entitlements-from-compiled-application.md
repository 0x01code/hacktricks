# Extrahieren von Berechtigungen aus kompilierten Anwendungen

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github Repositories senden.

</details>


Zusammenfassung der Seite [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary)

### **Extrahieren von Berechtigungen und mobilen Bereitstellungsdateien**

Wenn es um eine IPA-Datei einer App oder eine installierte App auf einem gejailbreakten Ger√§t geht, ist es m√∂glicherweise nicht m√∂glich, direkt auf `.entitlements`-Dateien oder die Datei `embedded.mobileprovision` zuzugreifen. Dennoch k√∂nnen Berechtigungs-Property-Listen aus der App-Bin√§rdatei extrahiert werden, indem die in Kapitel "iOS Basic Security Testing" beschriebenen Verfahren befolgt werden, insbesondere der Abschnitt "Erwerben der App-Bin√§rdatei".

Auch bei verschl√ºsselten Bin√§rdateien k√∂nnen bestimmte Schritte angewendet werden, um diese Dateien zu extrahieren. Sollten diese Schritte fehlschlagen, k√∂nnen Tools wie Clutch (sofern mit der iOS-Version kompatibel), frida-ios-dump oder √§hnliche Dienstprogramme erforderlich sein, um die App zu entschl√ºsseln und zu extrahieren.

#### **Extrahieren der Entitlements-Plist aus der App-Bin√§rdatei**

Mit der auf einem Computer zug√§nglichen App-Bin√§rdatei kann **binwalk** verwendet werden, um alle XML-Dateien zu extrahieren. Der folgende Befehl zeigt, wie dies gemacht wird:
```bash
$ binwalk -e -y=xml ./Telegram\ X

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1430180       0x15D2A4        XML document, version: "1.0"
1458814       0x16427E        XML document, version: "1.0"
```
Alternativ kann **radare2** verwendet werden, um einen Befehl leise auszuf√ºhren und zu beenden, der nach allen Zeichenketten im App-Bin√§rcode sucht, die "PropertyList" enthalten:
```bash
$ r2 -qc 'izz~PropertyList' ./Telegram\ X

0x0015d2a4 ascii <?xml version="1.0" encoding="UTF-8" standalone="yes"?>...
0x0016427d ascii H<?xml version="1.0" encoding="UTF-8"?>...
```
Beide Methoden, binwalk und radare2, erm√∂glichen die Extraktion von `plist`-Dateien. Eine Inspektion der ersten Datei (0x0015d2a4) zeigt eine erfolgreiche Wiederherstellung der [urspr√ºnglichen Berechtigungsdatei von Telegram](https://github.com/peter-iakovlev/Telegram-iOS/blob/77ee5c4dabdd6eb5f1e2ff76219edf7e18b45c00/Telegram-iOS/Telegram-iOS-AppStoreLLC.entitlements).

F√ºr App-Bin√§rdateien, die auf gejailbreakten Ger√§ten (z. B. √ºber SSH) zugegriffen werden, kann das **grep**-Kommando mit der Option `-a, --text` verwendet werden, um alle Dateien als ASCII-Text zu behandeln:
```bash
$ grep -a -A 5 'PropertyList' /var/containers/Bundle/Application/...
```
Die Anpassung der `-A num, --after-context=num`-Flagge erm√∂glicht die Anzeige von mehr oder weniger Zeilen. Diese Methode ist auch f√ºr verschl√ºsselte App-Bin√§rdateien geeignet und wurde bei mehreren App Store-Apps verifiziert. Die zuvor erw√§hnten Tools k√∂nnen auch auf gejailbreakten iOS-Ger√§ten f√ºr √§hnliche Zwecke verwendet werden.

**Hinweis**: Die direkte Verwendung des `strings`-Befehls wird f√ºr diese Aufgabe aufgrund seiner Einschr√§nkungen bei der Suche nach relevanten Informationen nicht empfohlen. Stattdessen wird empfohlen, grep mit der `-a`-Flagge auf der Bin√§rdatei zu verwenden oder radare2 (`izz`)/rabin2 (`-zz`) f√ºr effektivere Ergebnisse einzusetzen.

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) **bei oder folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) **und** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **GitHub-Repositories senden.**

</details>
