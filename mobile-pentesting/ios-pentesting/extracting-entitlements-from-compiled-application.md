<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obt√©n la [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PR al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


**P√°gina copiada de** [**https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#universal-links**](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#universal-links)

Si solo tienes el IPA de la aplicaci√≥n o simplemente la aplicaci√≥n instalada en un dispositivo con jailbreak, normalmente no podr√°s encontrar archivos `.entitlements`. Esto tambi√©n podr√≠a ser el caso del archivo `embedded.mobileprovision`. A√∫n as√≠, deber√≠as ser capaz de extraer las listas de propiedades de los entitlements del binario de la aplicaci√≥n t√∫ mismo (que has obtenido previamente como se explica en el cap√≠tulo "Pruebas b√°sicas de seguridad en iOS", secci√≥n "Adquisici√≥n del binario de la aplicaci√≥n").

Los siguientes pasos deber√≠an funcionar incluso cuando se apunta a un binario cifrado. Si por alguna raz√≥n no lo hacen, tendr√°s que descifrar y extraer la aplicaci√≥n con, por ejemplo, Clutch (si es compatible con tu versi√≥n de iOS), frida-ios-dump o similar.

**Extracci√≥n del archivo Entitlements Plist del binario de la aplicaci√≥n**

Si tienes el binario de la aplicaci√≥n en tu ordenador, un enfoque es utilizar binwalk para extraer (`-e`) todos los archivos XML (`-y=xml`):
```bash
$ binwalk -e -y=xml ./Telegram\ X

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1430180       0x15D2A4        XML document, version: "1.0"
1458814       0x16427E        XML document, version: "1.0"
```
O puedes usar radare2 (`-qc` para ejecutar un comando en silencio y salir) para buscar todas las cadenas en el binario de la aplicaci√≥n (`izz`) que contengan "PropertyList" (`~PropertyList`):
```bash
$ r2 -qc 'izz~PropertyList' ./Telegram\ X

0x0015d2a4 ascii <?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<!DOCTYPE plist PUBLIC
"-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">\n<plist version="1.0">
...<key>com.apple.security.application-groups</key>\n\t\t<array>
\n\t\t\t<string>group.ph.telegra.Telegraph</string>...

0x0016427d ascii H<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE plist PUBLIC
"-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">\n<plist version="1.0">\n
<dict>\n\t<key>cdhashes</key>...
```
En ambos casos (binwalk o radare2) pudimos extraer los mismos dos archivos `plist`. Si inspeccionamos el primero (0x0015d2a4), vemos que pudimos recuperar completamente el [archivo de entitlements original de Telegram](https://github.com/peter-iakovlev/Telegram-iOS/blob/77ee5c4dabdd6eb5f1e2ff76219edf7e18b45c00/Telegram-iOS/Telegram-iOS-AppStoreLLC.entitlements).

> Nota: el comando `strings` no ayudar√° aqu√≠ ya que no podr√° encontrar esta informaci√≥n. Es mejor usar grep con la bandera `-a` directamente en el binario o usar radare2 (`izz`)/rabin2 (`-zz`).

Si accede al binario de la aplicaci√≥n en el dispositivo con jailbreak (por ejemplo, a trav√©s de SSH), puede usar grep con la bandera `-a, --text` (trata todos los archivos como texto ASCII):
```bash
$ grep -a -A 5 'PropertyList' /var/containers/Bundle/Application/
    15E6A58F-1CA7-44A4-A9E0-6CA85B65FA35/Telegram X.app/Telegram\ X

<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
    <dict>
        <key>com.apple.security.application-groups</key>
        <array>
        ...
```
Juega con la bandera `-A num, --after-context=num` para mostrar m√°s o menos l√≠neas. Tambi√©n puedes utilizar herramientas como las que presentamos anteriormente, si las tienes instaladas en tu dispositivo iOS con jailbreak.

> Este m√©todo deber√≠a funcionar incluso si el binario de la aplicaci√≥n todav√≠a est√° encriptado (se prob√≥ con varias aplicaciones de la App Store).
