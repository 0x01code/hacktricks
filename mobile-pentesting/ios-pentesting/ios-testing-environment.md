# iOS Testumgebung

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories senden.

</details>

## Apple Developer Program

Eine **Bereitstellungskennung** ist eine Sammlung von √∂ffentlichen und privaten Schl√ºsseln, die mit einem Apple-Entwicklerkonto verkn√ºpft sind. Um Apps zu **signieren**, m√ºssen Sie **99 $/Jahr** bezahlen, um sich im **Apple Developer Program** zu registrieren und Ihre Bereitstellungskennung zu erhalten. Ohne dies k√∂nnen Sie Anwendungen nicht vom Quellcode auf einem physischen Ger√§t ausf√ºhren. Eine andere M√∂glichkeit besteht darin, ein **gejailbreaktes Ger√§t** zu verwenden.

Ab Xcode 7.2 bietet Apple die M√∂glichkeit, ein **kostenloses iOS-Entwicklungsprofil** zu erstellen, mit dem Sie Ihre Anwendung auf einem echten iPhone schreiben und testen k√∂nnen. Gehen Sie zu _Xcode_ --> _Einstellungen_ --> _Accounts_ --> _+_ (Neue Appli ID zu Ihren Anmeldeinformationen hinzuf√ºgen) --> _Auf die erstellte Apple ID klicken_ --> _Zertifikate verwalten_ --> _+_ (Apple Development) --> _Fertig_\
\_\_Um Ihre Anwendung auf Ihrem iPhone ausf√ºhren zu k√∂nnen, m√ºssen Sie zuerst das iPhone anweisen, dem Computer zu vertrauen. Anschlie√üend k√∂nnen Sie versuchen, die Anwendung vom Xcode aus auf dem Mobilger√§t auszuf√ºhren, es wird jedoch ein Fehler angezeigt. Gehen Sie also zu _Einstellungen_ --> _Allgemein_ --> _Profile und Ger√§teverwaltung_ --> W√§hlen Sie das nicht vertrauensw√ºrdige Profil aus und klicken Sie auf "**Vertrauen**".

Beachten Sie, dass **Anwendungen, die mit demselben Signierungszertifikat signiert sind, Ressourcen auf sichere Weise gemeinsam nutzen k√∂nnen, z. B. Schl√ºsselbundelemente**.

Die Bereitstellungskennungen werden auf dem Telefon im Verzeichnis **`/Library/MobileDevice/ProvisioningProfiles`** gespeichert.

## **Simulator**

{% hint style="info" %}
Beachten Sie, dass ein **Simulator nicht dasselbe wie ein Emulator** ist. Der Simulator simuliert nur das Verhalten des Ger√§ts und die Funktionen, verwendet sie jedoch nicht tats√§chlich.
{% endhint %}

### **Simulator**

Das erste, was Sie wissen m√ºssen, ist, dass ein Pentest in einem Simulator **viel eingeschr√§nkter ist als in einem gejailbreakten Ger√§t**.

Alle f√ºr den Bau und die Unterst√ºtzung einer iOS-App erforderlichen Tools werden **nur offiziell unter Mac OS unterst√ºtzt**.\
Das von Apple de facto verwendete Tool zum Erstellen/Debuggen/Instrumentieren von iOS-Anwendungen ist **Xcode**. Es kann verwendet werden, um andere Komponenten wie **Simulatoren** und verschiedene **SDK-Versionen** herunterzuladen, die zum Erstellen und **Testen** Ihrer App erforderlich sind.\
Es wird dringend empfohlen, Xcode aus dem **offiziellen App Store** herunterzuladen. Andere Versionen k√∂nnen Malware enthalten.

Die Simulator-Dateien befinden sich in `/Users/<Benutzername>/Library/Developer/CoreSimulator/Devices`

Um den Simulator zu √∂ffnen, starten Sie Xcode und klicken Sie dann auf die Registerkarte _Xcode_ --> _Entwicklertools √∂ffnen_ --> _Simulator_\
\_\_In der folgenden Abbildung k√∂nnen Sie durch Klicken auf "iPod touch \[...]" ein anderes Ger√§t zum Testen ausw√§hlen:

![](<../../.gitbook/assets/image (457).png>)

![](<../../.gitbook/assets/image (458).png>)

### Anwendungen im Simulator

Im Verzeichnis `/Users/<Benutzername>/Library/Developer/CoreSimulator/Devices` finden Sie alle **installierten Simulatoren**. Wenn Sie auf die Dateien einer in einem der Emulatoren erstellten Anwendung zugreifen m√∂chten, kann es schwierig sein zu wissen, **in welchem Simulator die App installiert ist**. Ein schneller Weg, um die richtige UID zu finden, besteht darin, die App im Simulator auszuf√ºhren und Folgendes auszuf√ºhren:
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
Sobald Sie die UID kennen, k√∂nnen die installierten Apps darin unter `/Users/<Benutzername>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application` gefunden werden.

√úberraschenderweise finden Sie die Anwendung jedoch nicht hier. Sie m√ºssen auf `/Users/<Benutzername>/Library/Developer/Xcode/DerivedData/{Anwendung}/Build/Products/Debug-iphonesimulator/` zugreifen.

Und in diesem Ordner k√∂nnen Sie **das Paket der Anwendung finden**.

## Emulator

Corellium ist der einzige √∂ffentlich verf√ºgbare iOS-Emulator. Es handelt sich um eine Enterprise-SaaS-L√∂sung mit einem Lizenzmodell pro Benutzer und bietet keine Testlizenz an.

## Jailbreaking

Apple verlangt strikt, dass der Code, der auf dem iPhone ausgef√ºhrt wird, **von einem von Apple ausgestellten Zertifikat signiert sein muss**. **Jailbreaking** ist der Prozess, bei dem solche Beschr√§nkungen und andere Sicherheitskontrollen des Betriebssystems aktiv umgangen werden. Sobald das Ger√§t jailbroken ist, wird die **Integrit√§tspr√ºfung**, die f√ºr die √úberpr√ºfung der installierten Apps verantwortlich ist, gepatcht, sodass sie **umgangen** wird.

{% hint style="info" %}
Im Gegensatz zu Android k√∂nnen Sie in iOS nicht in den "Entwicklermodus" wechseln, um nicht signierten/nicht vertrauensw√ºrdigen Code auf dem Ger√§t auszuf√ºhren.
{% endhint %}

### Android Rooting vs. iOS Jailbreaking

Obwohl oft verglichen, sind **Rooting** auf Android und **Jailbreaking** auf iOS grundlegend unterschiedliche Prozesse. Das Rooten von Android-Ger√§ten kann das **Installieren der `su`-Bin√§rdatei** oder das **Ersetzen des Systems durch eine gerootete benutzerdefinierte ROM** umfassen, was nicht unbedingt Exploits erfordert, wenn der Bootloader entsperrt ist. Das **Flashen von benutzerdefinierten ROMs** ersetzt das Betriebssystem des Ger√§ts nach dem Entsperren des Bootloaders und erfordert manchmal einen Exploit.

Im Gegensatz dazu k√∂nnen iOS-Ger√§te aufgrund der Beschr√§nkung des Bootloaders auf das Booten von Apple-signierten Abbildern keine benutzerdefinierten ROMs flashen. Das **Jailbreaking von iOS** zielt darauf ab, die von Apple implementierten Codesignatur-Schutzma√ünahmen zu umgehen, um nicht signierten Code auszuf√ºhren. Dieser Prozess wird durch die kontinuierlichen Sicherheitsverbesserungen von Apple erschwert.

### Herausforderungen beim Jailbreaking

Das Jailbreaking von iOS wird zunehmend schwieriger, da Apple Sicherheitsl√ºcken schnell schlie√üt. Das **Downgraden von iOS** ist nur f√ºr eine begrenzte Zeit nach einer Ver√∂ffentlichung m√∂glich, wodurch das Jailbreaking zu einer zeitkritischen Angelegenheit wird. Ger√§te, die f√ºr Sicherheitstests verwendet werden, sollten nicht aktualisiert werden, es sei denn, das erneute Jailbreaking ist garantiert.

iOS-Updates werden durch einen **Challenge-Response-Mechanismus** (SHSH-Blobs) gesteuert, der nur die Installation von Apple-signierten Antworten erm√∂glicht. Dieser Mechanismus, bekannt als "Signing Window", begrenzt die M√∂glichkeit, OTA-Firmware-Pakete zu speichern und sp√§ter zu verwenden. Die Website [IPSW Downloads](https://ipsw.me) bietet eine Ressource zur √úberpr√ºfung der aktuellen Signing Windows.

### Arten von Jailbreaks

- **Tethered Jailbreaks** erfordern eine Computer-Verbindung f√ºr jeden Neustart.
- **Semi-tethered Jailbreaks** erm√∂glichen das Booten im nicht-jailbroken Modus ohne Computer.
- **Semi-untethered Jailbreaks** erfordern manuelles erneutes Jailbreaking ohne Computer.
- **Untethered Jailbreaks** bieten eine dauerhafte Jailbreak-L√∂sung ohne erneute Anwendung.

### Tools und Ressourcen f√ºr Jailbreaking

Die Jailbreaking-Tools variieren je nach iOS-Version und Ger√§t. Ressourcen wie [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com) und [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) bieten aktuelle Informationen. Beispiele sind:

- [Checkra1n](https://checkra.in/) f√ºr A7-A11-Chip-Ger√§te.
- [Palera1n](https://palera.in/) f√ºr Checkm8-Ger√§te (A8-A11) unter iOS 15.0-16.5.
- [Unc0ver](https://unc0ver.dev/) f√ºr iOS-Versionen bis zu 14.8.

Die Modifikation Ihres Ger√§ts birgt Risiken, und Jailbreaking sollte mit Vorsicht angegangen werden.

### Vorteile und Risiken des Jailbreakings

Jailbreaking **entfernt die durch das Betriebssystem auferlegte Sandbox**, sodass Apps auf das gesamte Dateisystem zugreifen k√∂nnen. Diese Freiheit erm√∂glicht die Installation von nicht genehmigten Apps und den Zugriff auf mehr APIs. F√ºr normale Benutzer wird das Jailbreaking jedoch aufgrund potenzieller Sicherheitsrisiken und Ger√§teinstabilit√§t **nicht empfohlen**.

### **Nach dem Jailbreaking**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Jailbreak-Erkennung**

**Einige Anwendungen versuchen zu erkennen, ob das Mobilger√§t jailbroken ist, und in diesem Fall wird die Anwendung nicht ausgef√ºhrt.**

* Nach dem Jailbreaking werden auf einem iOS-Ger√§t normalerweise **Dateien und Ordner installiert**, die durchsucht werden k√∂nnen, um festzustellen, ob das Ger√§t jailbroken ist.
* Auf einem jailbroken Ger√§t erhalten Anwendungen **Lese-/Schreibzugriff auf neue Dateien** au√üerhalb der Sandbox.
* Einige **API-Aufrufe** verhalten sich anders.
* Das Vorhandensein des **OpenSSH-Dienstes**.
* Der Aufruf von `/bin/sh` gibt anstelle von 0 eine 1 zur√ºck.

**Weitere Informationen zur Erkennung von Jailbreaking finden Sie** [**hier**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

Sie k√∂nnen versuchen, diese Erkennungen mit `ios jailbreak disable` von **objection** zu umgehen.

## **Umgehung der Jailbreak-Erkennung**

* Sie k√∂nnen versuchen, diese Erkennungen mit `ios jailbreak disable` von **objection** zu umgehen.
* Sie k√∂nnen auch das Tool **Liberty Lite** (https://ryleyangus.com/repo/) installieren. Sobald das Repository hinzugef√ºgt wurde, sollte die App im "Suchen"-Tab angezeigt werden.

## Referenzen
* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)

<details>

<summary><strong>Lernen Sie das Hacken von AWS von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen** m√∂chten, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder folgen Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) **und** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **GitHub-Repos senden.**

</details>
