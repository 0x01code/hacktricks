# iOS Test Ortamı

<details>

<summary><strong>AWS hacklemeyi sıfırdan kahraman olmak için öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* Hacking hilelerinizi **HackTricks** ve **HackTricks Cloud** github depolarına PR göndererek paylaşın.

</details>

## Apple Developer Programı

Bir **provisioning kimliği**, bir Apple geliştirici hesabıyla ilişkilendirilen bir dizi genel ve özel anahtardır. Uygulamaları **imzalamak** için **99$/yıl** ödeyerek **Apple Developer Programı'na** kaydolmanız gerekmektedir. Bu olmadan, kaynak kodundan uygulamaları fiziksel bir cihazda çalıştıramazsınız. Bunun için başka bir seçenek ise **jailbreak yapılmış bir cihaz** kullanmaktır.

Xcode 7.2'den itibaren Apple, gerçek bir iPhone üzerinde uygulamanızı yazıp test etmenize izin veren **ücretsiz bir iOS geliştirme provisioning profili** oluşturma seçeneği sunmaktadır. _Xcode_ --> _Tercihler_ --> _Hesaplar_ --> _+_ (Yeni Appli ID ekleme) --> _Oluşturulan Apple Kimliğine tıklayın_ --> _Sertifikaları Yönet_ --> _+_ (Apple Geliştirme) --> _Tamam_ adımlarını izleyin.\
\_\_Daha sonra, uygulamayı iPhone'da çalıştırmak için önce **iPhone'un bilgisayara güvenmesini belirtmeniz gerekmektedir**. Ardından, Xcode'dan mobil cihazda uygulamayı çalıştırmayı deneyebilirsiniz, ancak bir hata alacaksınız. Bu durumda, _Ayarlar_ --> _Genel_ --> _Profiller ve Cihaz Yönetimi_ --> Güvenilmeyen profili seçin ve "**Güven**"e tıklayın.

Unutmayın ki **aynı imzalama sertifikasıyla imzalanan uygulamalar, anahtar zinciri öğeleri gibi kaynakları güvenli bir şekilde paylaşabilir**.

Provisioning profilleri, telefonun içinde **`/Library/MobileDevice/ProvisioningProfiles`** dizininde saklanır.

## **Simülatör**

{% hint style="info" %}
Bir **simülatör, bir emülatörle aynı değildir**. Simülatör, cihazın davranışını ve işlevlerini taklit eder, ancak bunları gerçekten kullanmaz.
{% endhint %}

### **Simülatör**

Bir simülatör içinde bir pentest gerçekleştirmek, jailbreak yapılmış bir cihazda yapmaktan **daha sınırlı olacaktır**.

Bir iOS uygulaması oluşturmak ve desteklemek için gereken tüm araçlar yalnızca resmi olarak Mac OS üzerinde desteklenmektedir.\
Apple'ın iOS uygulamaları oluşturmak/hata ayıklamak/enstrümantasyon yapmak için de facto aracı olan **Xcode**'dur. Uygulamanızı oluşturmak ve test etmek için gereken **simülatörler** ve farklı **SDK sürümleri** gibi diğer bileşenleri indirmek için kullanılabilir.\
Xcode'u **resmi uygulama mağazasından** indirmeniz şiddetle tavsiye edilir. Diğer sürümler zararlı yazılım içerebilir.

Simülatör dosyaları `/Users/<kullanıcı adı>/Library/Developer/CoreSimulator/Devices` dizininde bulunabilir.

Simülatörü açmak için Xcode'u çalıştırın, ardından _Xcode sekmesine_ tıklayın --> _Geliştirici Araçlarını Aç_ --> _Simülatör_\
\_\_Aşağıdaki resimde "iPod touch \[...]" üzerine tıklayarak test etmek için başka bir cihaz seçebilirsiniz:

![](<../../.gitbook/assets/image (457).png>)

![](<../../.gitbook/assets/image (458).png>)

### Simülatördeki Uygulamalar

`/Users/<kullanıcı adı>/Library/Developer/CoreSimulator/Devices` dizininde **yüklü simülatörleri** bulabilirsiniz. Bir emülatör içinde oluşturulan bir uygulamanın dosyalarına erişmek istiyorsanız, uygulamanın hangi emülatöre yüklendiğini bilmek zor olabilir. Doğru UID'yi bulmanın hızlı bir yolu, uygulamayı simülatörde çalıştırmak ve şu komutu çalıştırmaktır:
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
UID bilindiği takdirde, içinde yüklü olan uygulamalar `/Users/<kullanıcıadı>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application` dizininde bulunabilir.

Ancak şaşırtıcı bir şekilde, uygulamayı burada bulamayacaksınız. `/Users/<kullanıcıadı>/Library/Developer/Xcode/DerivedData/{Uygulama}/Build/Products/Debug-iphonesimulator/` dizinine erişmeniz gerekmektedir.

Ve bu klasörde **uygulamanın paketini bulabilirsiniz.**

## Emülatör

Corellium, yalnızca halka açık olarak mevcut olan bir iOS emülatördür. Bu, kullanıcı başına lisans modeline sahip bir kurumsal SaaS çözümüdür ve herhangi bir deneme lisansı sunmamaktadır.

## Jailbreak

Apple, iPhone'da çalışan kodun **Apple tarafından verilen bir sertifika ile imzalanması gerektiğini** kesinlikle talep etmektedir. **Jailbreak**, bu tür kısıtlamaları ve işletim sistemi tarafından yerleştirilen diğer güvenlik kontrollerini aktif olarak **atlatma işlemidir**. Bu nedenle, cihaz jailbreak yapıldığında, yüklü olan uygulamaları kontrol eden **bütünlük kontrolü** yaması uygulanarak **atlatılır**.

{% hint style="info" %}
Android'in aksine, iOS'ta "Geliştirici Modu"na geçiş yapamazsınız** ve bu şekilde imzalanmamış/güvenilmeyen kodu cihazda çalıştıramazsınız.
{% endhint %}

### Android Rootlama vs. iOS Jailbreak

Genellikle karşılaştırılan Android'de **rootlama** ve iOS'ta **jailbreak** temel olarak farklı işlemlerdir. Android cihazlarında rootlama, **`su` ikilisinin yüklenmesini** veya **sistemin köklendirilmiş özel bir ROM ile değiştirilmesini** içerebilir ve bu, önyükleyici kilidi açıksa herhangi bir zafiyet gerektirmez. **Özel ROM'lar yüklemek**, önyükleyici kilidi açıldıktan sonra cihazın işletim sistemini değiştirir ve bazen bir zafiyet gerektirebilir.

Buna karşılık, iOS cihazları, önyükleyicinin yalnızca Apple tarafından imzalanan görüntüleri başlatabilmesi nedeniyle özel ROM'lar yükleyemez. **iOS jailbreak**, Apple'ın kod imzalama korumalarını atlamayı amaçlar ve Apple'ın sürekli güvenlik geliştirmeleri nedeniyle karmaşık bir süreçtir.

### Jailbreak Zorlukları

Apple, zafiyetleri hızlı bir şekilde yaması nedeniyle iOS jailbreak yapmak giderek zorlaşmaktadır. iOS'un eski sürümlerine **geri dönme** sadece bir süre için mümkündür, bu nedenle jailbreak yapmak zamanla sınırlı bir meseledir. Güvenlik testi için kullanılan cihazlar, tekrar jailbreak yapılması garanti edilmediği sürece güncellenmemelidir.

iOS güncellemeleri, Apple tarafından imzalanan yanıtların yalnızca kurulumuna izin veren bir **zorluk-yanıt mekanizması** (SHSH blobs) ile kontrol edilir. Bu mekanizma, "imzalama penceresi" olarak bilinen, OTA firmware paketlerini depolama ve daha sonra kullanma yeteneğini sınırlar. [IPSW Downloads](https://ipsw.me) web sitesi, mevcut imzalama pencerelerini kontrol etmek için bir kaynaktır.

### Jailbreak Çeşitleri

- **Tethered jailbreakler**, her yeniden başlatma için bir bilgisayar bağlantısı gerektirir.
- **Semi-tethered jailbreakler**, bir bilgisayar olmadan jailbreak yapılmamış modda başlatmayı sağlar.
- **Semi-untethered jailbreakler**, bir bilgisayar gerektirmeden manuel olarak tekrar jailbreak yapmayı gerektirir.
- **Untethered jailbreakler**, tekrar uygulama gerektirmeksizin kalıcı bir jailbreak çözümü sunar.

### Jailbreak Araçları ve Kaynaklar

Jailbreak araçları, iOS sürümüne ve cihaza göre değişir. [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com) ve [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) gibi kaynaklar güncel bilgiler sağlar. Örnekler şunları içerir:

- A7-A11 çip cihazlar için [Checkra1n](https://checkra.in/).
- Checkm8 cihazlar (A8-A11) için iOS 15.0-16.5 arası için [Palera1n](https://palera.in/).
- iOS 14.8'e kadar olan sürümler için [Unc0ver](https://unc0ver.dev/).

Cihazınızı değiştirmek riskler taşır ve jailbreak yapma işlemine dikkatle yaklaşılmalıdır.

### Jailbreakin Avantajları ve Riskleri

Jailbreak, OS tarafından uygulanan kum havuzunu kaldırarak uygulamaların tüm dosya sistemine erişmesine olanak tanır. Bu özgürlük, onaylanmamış uygulamaların yüklenmesine ve daha fazla API'ye erişime olanak sağlar. Bununla birlikte, düzenli kullanıcılar için jailbreak, potansiyel güvenlik riskleri ve cihaz kararsızlığı nedeniyle **tavsiye edilmez**.

### **Jailbreak Yapıldıktan Sonra**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Jailbreak Tespit Edilmesi**

**Birçok uygulama, mobil cihazın jailbreak yapılmış olup olmadığını tespit etmeye çalışır ve bu durumda uygulama çalışmaz**

* iOS'ta jailbreak yapıldıktan sonra genellikle **dosya ve klasörler yüklenir**, bu durum cihazın jailbreak yapılmış olup olmadığını belirlemek için aranabilir.
* Jailbreak yapılmış bir cihazda uygulamalar, kum havuzu dışında yeni dosyalara **okuma/yazma erişimi** elde eder.
* Bazı **API** **çağrıları** farklı davranır.
* **OpenSSH** servisinin varlığı
* `/bin/sh` çağrısı, 0 yerine 1 döndürecektir.

Jailbreak tespit etme hakkında daha fazla bilgi için [buraya](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/) bakabilirsiniz.

Jailbreak tespitini **objection**'ın `ios jailbreak disable` özelliğini kullanarak engellemeyi deneyebilirsiniz.

## **Jailbreak Tespitini Atlama**

* Jailbreak tespitini engellemek için **objection**'ın `ios jailbreak disable` özelliğini kullanmayı deneyebilirsiniz.
* Ayrıca **Liberty Lite** aracını da yükleyebilirsiniz (https://ryleyangus.com/repo/). Repo eklendikten sonra, uygulama 'Arama' sekmesinde görünmelidir.

## Referanslar
* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **tanıtmak veya HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**'da takip edin.**
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud** github depolarına PR göndererek paylaşın.

</details>
