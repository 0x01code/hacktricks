# Environnement de test iOS

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

- Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
- D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
- **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
- **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

## Programme de d√©veloppement Apple

Une **identit√© de provisionnement** est une collection de cl√©s publiques et priv√©es associ√©es √† un compte d√©veloppeur Apple. Pour **signer des applications**, vous devez payer **99 $/an** pour vous inscrire au **Programme de d√©veloppement Apple** et obtenir votre identit√© de provisionnement. Sans cela, vous ne pourrez pas ex√©cuter d'applications √† partir du code source sur un appareil physique. Une autre option est d'utiliser un **appareil jailbreak√©**.

√Ä partir de Xcode 7.2, Apple a fourni une option pour cr√©er un **profil de provisionnement de d√©veloppement iOS gratuit** qui permet d'√©crire et de tester votre application sur un v√©ritable iPhone. Allez dans _Xcode_ --> _Pr√©f√©rences_ --> _Comptes_ --> _+_ (Ajouter un nouvel identifiant Appli √† vos identifiants) --> _Cliquez sur l'identifiant Apple cr√©√©_ --> _G√©rer les certificats_ --> _+_ (D√©veloppement Apple) --> _Termin√©_\
\_\_Ensuite, pour ex√©cuter votre application sur votre iPhone, vous devez d'abord **indiquer √† l'iPhone de faire confiance √† l'ordinateur**. Ensuite, vous pouvez essayer de **lancer l'application sur le mobile depuis Xcode**, mais une erreur appara√Ætra. Allez donc dans _R√©glages_ --> _G√©n√©ral_ --> _Profils et gestion des appareils_ --> S√©lectionnez le profil non approuv√© et cliquez sur "**Faire confiance**".

Notez que **les applications sign√©es par le m√™me certificat de signature peuvent partager des ressources de mani√®re s√©curis√©e, comme des √©l√©ments de trousseau**.

Les profils de provisionnement sont stock√©s √† l'int√©rieur du t√©l√©phone dans **`/Library/MobileDevice/ProvisioningProfiles`**

## **Simulateur**

{% hint style="info" %}
Notez qu'un **simulateur n'est pas la m√™me chose qu'un √©mulateur**. Le simulateur simule simplement le comportement de l'appareil et ses fonctions mais ne les utilise pas r√©ellement.
{% endhint %}

### **Simulateur**

La premi√®re chose √† savoir est que **effectuer un test de p√©n√©tration dans un simulateur sera beaucoup plus limit√© que de le faire dans un appareil jailbreak√©**.

Tous les outils n√©cessaires pour construire et prendre en charge une application iOS ne sont **officiellement pris en charge que sur Mac OS**.\
L'outil de facto d'Apple pour cr√©er/d√©boguer/instrumenter des applications iOS est **Xcode**. Il peut √™tre utilis√© pour t√©l√©charger d'autres composants tels que des **simulateurs** et diff√©rentes **versions de SDK** n√©cessaires pour construire et **tester** votre application.\
Il est fortement recommand√© de **t√©l√©charger** Xcode depuis le **magasin d'applications officiel**. D'autres versions pourraient contenir des logiciels malveillants.

Les fichiers du simulateur se trouvent dans `/Users/<username>/Library/Developer/CoreSimulator/Devices`

Pour ouvrir le simulateur, ex√©cutez Xcode, puis cliquez sur l'onglet _Xcode_ --> _Ouvrir les outils de d√©veloppement_ --> _Simulateur_\
\_\_Dans l'image suivante, en cliquant sur "iPod touch \[...]", vous pouvez s√©lectionner un autre appareil √† tester :

![](<../../.gitbook/assets/image (457).png>)

![](<../../.gitbook/assets/image (458).png>)

### Applications dans le simulateur

√Ä l'int√©rieur de `/Users/<username>/Library/Developer/CoreSimulator/Devices`, vous pouvez trouver tous les **simulateurs install√©s**. Si vous souhaitez acc√©der aux fichiers d'une application cr√©√©e dans l'un des √©mulateurs, il peut √™tre difficile de savoir **dans lequel l'application est install√©e**. Une fa√ßon rapide de **trouver le bon UID** est d'ex√©cuter l'application dans le simulateur et d'ex√©cuter :
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
Une fois que vous connaissez l'UID, les applications install√©es peuvent √™tre trouv√©es dans `/Users/<username>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application`

Cependant, √©tonnamment, vous ne trouverez pas l'application ici. Vous devez acc√©der √† `/Users/<username>/Library/Developer/Xcode/DerivedData/{Application}/Build/Products/Debug-iphonesimulator/`

Et dans ce dossier, vous pouvez **trouver le package de l'application.**

## √âmulateur

Corellium est le seul √©mulateur iOS disponible publiquement. C'est une solution SaaS d'entreprise avec un mod√®le de licence par utilisateur et n'offre pas d'essai gratuit.

## Jailbreak

Apple exige strictement que le code s'ex√©cutant sur l'iPhone soit **sign√© par un certificat d√©livr√© par Apple**. Le **jailbreak** est le processus de **contournement actif de ces restrictions** et d'autres contr√¥les de s√©curit√© mis en place par le syst√®me d'exploitation. Par cons√©quent, une fois que l'appareil est jailbreak√©, le **contr√¥le d'int√©grit√©** charg√© de v√©rifier les applications install√©es est patch√© pour √™tre **contourn√©**.

{% hint style="info" %}
Contrairement √† Android, **vous ne pouvez pas passer en "Mode d√©veloppeur"** sur iOS pour ex√©cuter du code non sign√©/non fiable sur l'appareil.
{% endhint %}

### Rootage Android vs Jailbreak iOS

Bien qu'ils soient souvent compar√©s, le **rootage** sur Android et le **jailbreak** sur iOS sont des processus fondamentalement diff√©rents. Le rootage des appareils Android peut impliquer **l'installation du binaire `su`** ou **le remplacement du syst√®me par une ROM personnalis√©e root√©e**, ce qui ne n√©cessite pas n√©cessairement d'exploits si le chargeur d'amor√ßage est d√©verrouill√©. **Le flash de ROM personnalis√©es** remplace le syst√®me d'exploitation de l'appareil apr√®s le d√©verrouillage du chargeur d'amor√ßage, n√©cessitant parfois un exploit.

En revanche, les appareils iOS ne peuvent pas flasher de ROM personnalis√©es en raison de la restriction du chargeur d'amor√ßage √† l'amor√ßage uniquement des images sign√©es par Apple. Le **jailbreak iOS** vise √† contourner les protections de signature de code d'Apple pour ex√©cuter du code non sign√©, un processus compliqu√© par les am√©liorations continues de la s√©curit√© d'Apple.

### D√©fis du jailbreak

Le jailbreak iOS est de plus en plus difficile car Apple corrige rapidement les vuln√©rabilit√©s. **Revenir √† une version ant√©rieure d'iOS** n'est possible que pendant un temps limit√© apr√®s une sortie, ce qui rend le jailbreak une question sensible au temps. Les appareils utilis√©s pour les tests de s√©curit√© ne doivent pas √™tre mis √† jour √† moins que le re-jailbreak ne soit garanti.

Les mises √† jour iOS sont contr√¥l√©es par un **m√©canisme de d√©fi-r√©ponse** (blobs SHSH), permettant l'installation uniquement pour des r√©ponses sign√©es par Apple. Ce m√©canisme, connu sous le nom de "fen√™tre de signature", limite la capacit√© de stocker et d'utiliser ult√©rieurement des packages firmware OTA. Le site web [IPSW Downloads](https://ipsw.me) est une ressource pour v√©rifier les fen√™tres de signature actuelles.

### Vari√©t√©s de jailbreak

- Les **jailbreaks tethered** n√©cessitent une connexion √† un ordinateur √† chaque red√©marrage.
- Les **jailbreaks semi-tethered** permettent de d√©marrer en mode non jailbreak√© sans ordinateur.
- Les **jailbreaks semi-untethered** n√©cessitent un re-jailbreak manuel sans besoin d'un ordinateur.
- Les **jailbreaks untethered** offrent une solution de jailbreak permanente sans n√©cessit√© de r√©application.

### Outils et ressources de jailbreak

Les outils de jailbreak varient en fonction de la version d'iOS et de l'appareil. Des ressources telles que [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com) et [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) fournissent des informations √† jour. Exemples :

- [Checkra1n](https://checkra.in/) pour les appareils √† puce A7-A11.
- [Palera1n](https://palera.in/) pour les appareils Checkm8 (A8-A11) sur iOS 15.0-16.5.
- [Unc0ver](https://unc0ver.dev/) pour les versions d'iOS jusqu'√† 14.8.

Modifier votre appareil comporte des risques, et le jailbreak doit √™tre abord√© avec prudence.

### Avantages et risques du jailbreak

Le jailbreak **supprime l'isolement impos√© par le syst√®me d'exploitation**, permettant aux applications d'acc√©der √† l'ensemble du syst√®me de fichiers. Cette libert√© permet l'installation d'applications non approuv√©es et l'acc√®s √† davantage d'API. Cependant, pour les utilisateurs r√©guliers, le jailbreak n'est **pas recommand√©** en raison des risques potentiels pour la s√©curit√© et de l'instabilit√© de l'appareil.

### **Apr√®s le jailbreak**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **D√©tection du jailbreak**

**Plusieurs applications tenteront de d√©tecter si le mobile est jailbreak√© et dans ce cas l'application ne se lancera pas**

* Apr√®s le jailbreak d'un iOS, **des fichiers et dossiers sont g√©n√©ralement install√©s**, qui peuvent √™tre recherch√©s pour d√©terminer si l'appareil est jailbreak√©.
* Sur un appareil jailbreak√©, les applications obtiennent un **acc√®s en lecture/√©criture √† de nouveaux fichiers** en dehors du bac √† sable
* Certaines **appels d'API** se comporteront **diff√©remment**
* La pr√©sence du service **OpenSSH**
* L'appel √† `/bin/sh` renverra **1** au lieu de 0

**Plus d'informations sur la d√©tection du jailbreak** [**ici**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

Vous pouvez essayer d'√©viter ces d√©tections en utilisant `ios jailbreak disable` de **objection**

## **Contournement de la d√©tection du jailbreak**

* Vous pouvez essayer d'√©viter ces d√©tections en utilisant `ios jailbreak disable` de **objection**
* Vous pouvez √©galement installer l'outil **Liberty Lite** (https://ryleyangus.com/repo/). Une fois le d√©p√¥t ajout√©, l'application devrait appara√Ætre dans l'onglet ‚ÄòRecherche‚Äô

## R√©f√©rences
* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
