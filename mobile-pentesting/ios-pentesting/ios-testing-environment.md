# iOS Testumgebung

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositorys senden.

</details>

## Apple Developer Program

Eine **Bereitstellungsidentit√§t** ist eine Sammlung von √∂ffentlichen und privaten Schl√ºsseln, die mit einem Apple-Entwicklerkonto verkn√ºpft sind. Um **Apps zu signieren**, m√ºssen Sie **99 $/Jahr** bezahlen, um sich im **Apple Developer Program** zu registrieren und Ihre Bereitstellungsidentit√§t zu erhalten. Ohne dies k√∂nnen Sie Anwendungen nicht aus dem Quellcode auf einem physischen Ger√§t ausf√ºhren. Eine andere M√∂glichkeit, dies zu tun, ist die Verwendung eines **jailbroken Ger√§ts**.

Ab Xcode 7.2 bietet Apple die M√∂glichkeit, ein **kostenloses iOS-Entwicklungs-Bereitstellungsprofil** zu erstellen, mit dem Sie Ihre Anwendung auf einem echten iPhone schreiben und testen k√∂nnen. Gehen Sie zu _Xcode_ --> _Einstellungen_ --> _Konten_ --> _+_ (Neue Appli-ID hinzuf√ºgen) --> _Klicken Sie auf die erstellte Apple-ID_ --> _Zertifikate verwalten_ --> _+_ (Apple Development) --> _Fertig_\
\_\_Dann m√ºssen Sie zun√§chst das iPhone **anweisen, dem Computer zu vertrauen**, um Ihre Anwendung auf Ihrem iPhone ausf√ºhren zu k√∂nnen. Anschlie√üend k√∂nnen Sie versuchen, **die Anwendung vom Xcode aus auf dem Mobilger√§t auszuf√ºhren**, aber es wird ein Fehler angezeigt. Gehen Sie also zu _Einstellungen_ --> _Allgemein_ --> _Profile und Ger√§teverwaltung_ --> W√§hlen Sie das nicht vertrauensw√ºrdige Profil aus und klicken Sie auf "**Vertrauen**".

Beachten Sie, dass **von demselben Signierungszertifikat signierte Anwendungen Ressourcen auf sichere Weise gemeinsam nutzen k√∂nnen, wie z. B. Schl√ºsselbunde**.

Die Bereitstellungsprofile werden im Telefon unter **`/Library/MobileDevice/ProvisioningProfiles`** gespeichert.

## **Simulator**

{% hint style="info" %}
Beachten Sie, dass ein **Simulator nicht dasselbe wie ein Emulator ist**. Der Simulator simuliert nur das Verhalten des Ger√§ts und die Funktionen, verwendet sie jedoch nicht tats√§chlich.
{% endhint %}

### **Simulator**

Das erste, was Sie wissen m√ºssen, ist, dass **das Durchf√ºhren eines Pentests in einem Simulator viel eingeschr√§nkter ist als in einem jailbroken Ger√§t**.

Alle f√ºr den Bau und die Unterst√ºtzung einer iOS-App erforderlichen Tools werden **nur offiziell auf Mac OS unterst√ºtzt**.\
Apples Standardwerkzeug zum Erstellen/Debuggen/Instrumentieren von iOS-Anwendungen ist **Xcode**. Es kann verwendet werden, um andere Komponenten wie **Simulatoren** und verschiedene **SDK-Versionen** herunterzuladen, die zum Erstellen und **Testen** Ihrer App erforderlich sind.\
Es wird dringend empfohlen, Xcode aus dem **offiziellen App Store** herunterzuladen. Andere Versionen k√∂nnten Malware enthalten.

Die Simulator-Dateien finden Sie unter `/Users/<Benutzername>/Library/Developer/CoreSimulator/Devices`

Um den Simulator zu √∂ffnen, f√ºhren Sie Xcode aus, klicken Sie dann auf den _Xcode-Tab_ --> _Entwicklertools √∂ffnen_ --> _Simulator_\
\_\_In der folgenden Abbildung k√∂nnen Sie durch Klicken auf "iPod touch \[...]" ein anderes Ger√§t zum Testen ausw√§hlen:

![](<../../.gitbook/assets/image (270).png>)

![](<../../.gitbook/assets/image (520).png>)

### Anwendungen im Simulator

Innerhalb von `/Users/<Benutzername>/Library/Developer/CoreSimulator/Devices` finden Sie alle **installierten Simulatoren**. Wenn Sie auf die Dateien einer Anwendung zugreifen m√∂chten, die in einem der Emulatoren erstellt wurde, kann es schwierig sein zu wissen, **in welchem der App installiert ist**. Ein schneller Weg, um die richtige UID zu finden, besteht darin, die App im Simulator auszuf√ºhren und auszuf√ºhren:
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
```markdown
Sobald Sie die UID kennen, k√∂nnen die installierten Apps darin unter `/Users/<username>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application` gefunden werden.

Jedoch werden Sie √ºberraschenderweise die Anwendung hier nicht finden. Sie m√ºssen auf `/Users/<username>/Library/Developer/Xcode/DerivedData/{Application}/Build/Products/Debug-iphonesimulator/` zugreifen.

Und in diesem Ordner k√∂nnen Sie **das Paket der Anwendung finden**.

## Emulator

Corellium ist der einzige √∂ffentlich verf√ºgbare iOS-Emulator. Es handelt sich um eine Enterprise-SaaS-L√∂sung mit einem Lizenzmodell pro Benutzer und bietet keine Testlizenz an.

## Jailbreaking

Apple verlangt strikt, dass der Code, der auf dem iPhone l√§uft, **von einem von Apple ausgestellten Zertifikat signiert sein muss**. **Jailbreaking** ist der Prozess, der aktiv **solche Beschr√§nkungen** und andere Sicherheitskontrollen, die vom Betriebssystem implementiert wurden, umgeht. Daher, sobald das Ger√§t jailbroken ist, wird die **Integrit√§tspr√ºfung**, die f√ºr die √úberpr√ºfung der installierten Apps verantwortlich ist, gepatcht, sodass sie **umgangen wird**.

{% hint style="info" %}
Im Gegensatz zu Android k√∂nnen Sie in iOS nicht in den "Entwicklermodus" wechseln, um nicht signierten/nicht vertrauensw√ºrdigen Code auf dem Ger√§t auszuf√ºhren.
{% endhint %}

### Android Rooting vs. iOS Jailbreaking

Obwohl oft verglichen, sind **Rooting** auf Android und **Jailbreaking** auf iOS grundlegend unterschiedliche Prozesse. Das Rooten von Android-Ger√§ten kann das **Installieren des `su`-Bin√§rs** oder das **Ersetzen des Systems durch eine gerootete benutzerdefinierte ROM** beinhalten, was nicht unbedingt Exploits erfordert, wenn der Bootloader entsperrt ist. Das **Flashen von benutzerdefinierten ROMs** ersetzt das Betriebssystem des Ger√§ts nach dem Entsperren des Bootloaders, was manchmal einen Exploit erfordert.

Im Gegensatz dazu k√∂nnen iOS-Ger√§te keine benutzerdefinierten ROMs flashen, aufgrund der Beschr√§nkung des Bootloaders auf das Booten von Apple-signierten Images. **Jailbreaking von iOS** zielt darauf ab, Apples Codesignatur-Schutzmechanismen zu umgehen, um nicht signierten Code auszuf√ºhren, ein Prozess, der durch Apples kontinuierliche Sicherheitsverbesserungen kompliziert wird.

### Herausforderungen beim Jailbreaking

Das Jailbreaking von iOS wird zunehmend schwieriger, da Apple Sicherheitsl√ºcken schnell schlie√üt. Ein **Downgrade von iOS** ist nur f√ºr eine begrenzte Zeit nach einem Release m√∂glich, was das Jailbreaking zu einer zeitkritischen Angelegenheit macht. Ger√§te, die f√ºr Sicherheitstests verwendet werden, sollten nicht aktualisiert werden, es sei denn, ein erneutes Jailbreaking ist garantiert.

iOS-Updates werden durch einen **Herausforderungs-Antwort-Mechanismus** (SHSH-Blobs) gesteuert, der nur die Installation von Apple-signierten Antworten erm√∂glicht. Dieser Mechanismus, bekannt als "Signierungsfenster", begrenzt die F√§higkeit, OTA-Firmwarepakete zu speichern und sp√§ter zu verwenden. Die [IPSW-Downloads-Website](https://ipsw.me) ist eine Ressource zur √úberpr√ºfung der aktuellen Signierungsfenster.

### Arten von Jailbreaks

* **Tethered Jailbreaks** erfordern eine Computer-Verbindung f√ºr jeden Neustart.
* **Semi-tethered Jailbreaks** erm√∂glichen das Booten in den nicht-jailbroken Modus ohne Computer.
* **Semi-untethered Jailbreaks** erfordern manuelles erneutes Jailbreaking ohne Computer.
* **Untethered Jailbreaks** bieten eine dauerhafte Jailbreak-L√∂sung ohne erneute Anwendung.

### Tools und Ressourcen f√ºr Jailbreaking

Jailbreaking-Tools variieren je nach iOS-Version und Ger√§t. Ressourcen wie [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com) und [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) bieten aktuelle Informationen. Beispiele sind:

* [Checkra1n](https://checkra.in/) f√ºr A7-A11-Chip-Ger√§te.
* [Palera1n](https://palera.in/) f√ºr Checkm8-Ger√§te (A8-A11) auf iOS 15.0-16.5.
* [Unc0ver](https://unc0ver.dev/) f√ºr iOS-Versionen bis 14.8.

Die Modifizierung Ihres Ger√§ts birgt Risiken, und Jailbreaking sollte mit Vorsicht angegangen werden.

### Vorteile und Risiken des Jailbreakings

Jailbreaking **entfernt die vom Betriebssystem auferlegte Sandbox**, was Apps den Zugriff auf das gesamte Dateisystem erm√∂glicht. Diese Freiheit erm√∂glicht die Installation von nicht genehmigten Apps und den Zugriff auf mehr APIs. F√ºr normale Benutzer wird Jailbreaking jedoch aufgrund potenzieller Sicherheitsrisiken und Ger√§teinstabilit√§t **nicht empfohlen**.

### **Nach dem Jailbreaking**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Jailbreak-Erkennung**

**Mehrere Anwendungen werden versuchen zu erkennen, ob das Mobilger√§t jailbroken ist, und in diesem Fall wird die Anwendung nicht ausgef√ºhrt**

* Nach dem Jailbreaking eines iOS-Ger√§ts werden in der Regel **Dateien und Ordner installiert**, die durchsucht werden k√∂nnen, um festzustellen, ob das Ger√§t jailbroken ist.
* Auf einem jailbroken Ger√§t erhalten Anwendungen **Lese-/Schreibzugriff auf neue Dateien** au√üerhalb der Sandbox.
* Einige **API-Aufrufe** werden **sich anders verhalten**.
* Die Anwesenheit des **OpenSSH**-Dienstes.
* Der Aufruf von `/bin/sh` gibt anstelle von 0 eine **1** zur√ºck.

**Weitere Informationen zur Erkennung von Jailbreaking** [**hier**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

Sie k√∂nnen versuchen, diese Erkennungen zu umgehen, indem Sie `ios jailbreak disable` von **objection** verwenden.

## **Umgehung der Jailbreak-Erkennung**

* Sie k√∂nnen versuchen, diese Erkennungen zu umgehen, indem Sie `ios jailbreak disable` von **objection** verwenden.
* Sie k√∂nnten auch das Tool **Liberty Lite** (https://ryleyangus.com/repo/) installieren. Sobald das Repo hinzugef√ºgt ist, sollte die App im 'Suchen'-Tab erscheinen.

## Referenzen

* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)
```
