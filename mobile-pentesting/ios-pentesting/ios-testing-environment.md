# iOS Test Ortamı

<details>

<summary><strong>AWS hacklemeyi sıfırdan kahramana öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)'da **takip edin**.
* **Hacking püf noktalarınızı paylaşarak PR'lar göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>

## Apple Geliştirici Programı

Bir **provisioning kimliği**, bir Apple geliştirici hesabıyla ilişkilendirilen genel ve özel anahtarların bir koleksiyonudur. Uygulamaları **imzalamak** için **99$/yıl** ödeyerek **Apple Geliştirici Programı'na** kaydolmanız gerekmektedir. Bu olmadan, fiziksel bir cihazda kaynak kodundan uygulamaları çalıştıramazsınız. Bunun için başka bir seçenek ise **jailbreak yapılmış bir cihaz** kullanmaktır.

Xcode 7.2'den itibaren Apple, gerçek bir iPhone üzerinde uygulamanızı yazıp test etmenizi sağlayan **ücretsiz bir iOS geliştirme provisioning profili oluşturma seçeneği** sunmaktadır. _Xcode_ --> _Tercihler_ --> _Hesaplar_ --> _+_ (Yeni Appli ID ekleyin) --> _Oluşturulan Apple ID'ye tıklayın_ --> _Sertifikaları Yönet_ --> _+_ (Apple Geliştirme) --> _Tamam_\
\_\_Ardından, uygulamanızı iPhone'da çalıştırmak için önce **iPhonu bilgisayara güvenilir olarak işaretlemeniz gerekmektedir**. Daha sonra, uygulamayı Xcode'dan mobil cihazda çalıştırmayı deneyebilirsiniz, ancak bir hata alacaksınız. Bu durumda _Ayarlar_ --> _Genel_ --> _Profiller ve Cihaz Yönetimi_ --> Güvenilir olmayan profili seçin ve "**Güven**"e tıklayın.

**Aynı imzalama sertifikası ile imzalanmış uygulamalar, anahtarlık öğeleri gibi kaynakları güvenli bir şekilde paylaşabilir**.

Provisioning profilleri telefonun içinde **`/Library/MobileDevice/ProvisioningProfiles`** dizininde saklanmaktadır.

## **Simülatör**

{% hint style="info" %}
Bir **simülatörün bir emülatör olmadığını** unutmayın. Simülatör, cihazın davranışını ve işlevlerini sadece taklit eder, gerçekten kullanmaz.
{% endhint %}

### **Simülatör**

Bir simülatörde bir pentest gerçekleştirmenin, jailbreak yapılmış bir cihazda yapmaktan **çok daha sınırlı** olacağını bilmelisiniz.

Bir iOS uygulamasını oluşturmak ve desteklemek için gereken tüm araçlar **yalnızca resmi olarak Mac OS'ta desteklenmektedir**.\
Apple'ın iOS uygulamaları oluşturmak/hata ayıklamak/enstrümantasyon yapmak için de facto aracı **Xcode**'dur. Diğer **simülatörler** ve farklı **SDK** **sürümlerini** indirmek ve uygulamanızı **derlemek** ve **test etmek** için gereklidir.\
Xcode'u **resmi uygulama mağazasından indirmeniz** şiddetle tavsiye edilir. Diğer sürümler kötü amaçlı yazılımlar içerebilir.

Simülatör dosyaları `/Users/<kullanıcıadı>/Library/Developer/CoreSimulator/Devices` dizininde bulunabilir.

Simülatörü açmak için Xcode'u çalıştırın, ardından _Xcode sekmesine_ gidin --> _Geliştirici Araçlarını Aç_ --> _Simülatör_\
\_\_Aşağıdaki resimde "iPod touch \[...]" üzerine tıklayarak test etmek için başka bir cihazı seçebilirsiniz:

![](<../../.gitbook/assets/image (267).png>)

![](<../../.gitbook/assets/image (517).png>)
```bash
xcrun simctl list | grep Booted
iPhone 8 (BF5DA4F8-6BBE-4EA0-BA16-7E3AFD16C06C) (Booted)
```
Once you know the UID the apps installed within it can be found in `/Users/<username>/Library/Developer/CoreSimulator/Devices/{UID}/data/Containers/Data/Application`

However, surprisingly you won't find the application here. You need to access `/Users/<username>/Library/Developer/Xcode/DerivedData/{Application}/Build/Products/Debug-iphonesimulator/`

And in this folder you can **find the package of the application.**

## Emulator

Corellium is the only publicly available iOS emulator. It is an enterprise SaaS solution with a per user license model and does not offer any trial license.

## Jailbeaking

Apple strictly requires that the code running on the iPhone must be **signed by a certificate issued by Apple**. **Jailbreaking** is the process of actively **circumventing such restrictions** and other security controls put in places by the OS. Therefore, once the device is jailbroken, the **integrity check** which is responsible for checking apps being installed is patched so it is **bypassed**.

{% hint style="info" %}
Unlike Android, **you cannot switch to "Developer Mode"** in iOS to run unsigned/untrusted code on the device.
{% endhint %}

### Android Rooting vs. iOS Jailbreaking

While often compared, **rooting** on Android and **jailbreaking** on iOS are fundamentally different processes. Rooting Android devices might involve **installing the `su` binary** or **replacing the system with a rooted custom ROM**, which doesn't necessarily require exploits if the bootloader is unlocked. **Flashing custom ROMs** replaces the device's OS after unlocking the bootloader, sometimes requiring an exploit.

In contrast, iOS devices cannot flash custom ROMs due to the bootloader's restriction to only boot Apple-signed images. **Jailbreaking iOS** aims to bypass Apple's code signing protections to run unsigned code, a process complicated by Apple's continuous security enhancements.

### Jailbreaking Challenges

Jailbreaking iOS is increasingly difficult as Apple patches vulnerabilities quickly. **Downgrading iOS** is only possible for a limited time after a release, making jailbreaking a time-sensitive matter. Devices used for security testing should not be updated unless re-jailbreaking is guaranteed.

iOS updates are controlled by a **challenge-response mechanism** (SHSH blobs), allowing installation only for Apple-signed responses. This mechanism, known as a "signing window", limits the ability to store and later use OTA firmware packages. The [IPSW Downloads website](https://ipsw.me) is a resource for checking current signing windows.

### Jailbreak Varieties

* **Tethered jailbreaks** require a computer connection for each reboot.
* **Semi-tethered jailbreaks** allow booting into non-jailbroken mode without a computer.
* **Semi-untethered jailbreaks** require manual re-jailbreaking without needing a computer.
* **Untethered jailbreaks** offer a permanent jailbreak solution without the need for re-application.

### Jailbreaking Tools and Resources

Jailbreaking tools vary by iOS version and device. Resources such as [Can I Jailbreak?](https://canijailbreak.com), [The iPhone Wiki](https://www.theiphonewiki.com), and [Reddit Jailbreak](https://www.reddit.com/r/jailbreak/) provide up-to-date information. Examples include:

* [Checkra1n](https://checkra.in/) for A7-A11 chip devices.
* [Palera1n](https://palera.in/) for Checkm8 devices (A8-A11) on iOS 15.0-16.5.
* [Unc0ver](https://unc0ver.dev/) for iOS versions up to 14.8.

Modifying your device carries risks, and jailbreaking should be approached with caution.

### Jailbreaking Benefits and Risks

Jailbreaking **removes OS-imposed sandboxing**, allowing apps to access the entire filesystem. This freedom enables the installation of unapproved apps and access to more APIs. However, for regular users, jailbreaking is **not recommended** due to potential security risks and device instability.

### **After Jailbreaking**

{% content-ref url="basic-ios-testing-operations.md" %}
[basic-ios-testing-operations.md](basic-ios-testing-operations.md)
{% endcontent-ref %}

### **Jailbreak Detection**

**Several applications will try to detect if the mobile is jailbroken and in that case the application won't run**

* After jailbreaking an iOS **files and folders are usually installed**, these can be searched to determine if the device is jailbroken.
* In a jailbroken device applications get **read/write access to new files** outside the sandbox
* Some **API** **calls** will **behave differently**
* The presence of the **OpenSSH** service
* Calling `/bin/sh` will **return 1** instead of 0

**More information about how to detect jailbreaking** [**here**](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/jailbreak-detection-methods/)**.**

You can try to avoid this detections using **objection's** `ios jailbreak disable`

## **Jailbreak Detection Bypass**

* You can try to avoid this detections using **objection's** `ios jailbreak disable`
* You could also install the tool **Liberty Lite** (https://ryleyangus.com/repo/). Once the repo is added, the app should appear in the ‘Search’ tab

## References

* [https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/](https://mas.owasp.org/MASTG/iOS/0x06b-iOS-Security-Testing/)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Other ways to support HackTricks:

* If you want to see your **company advertised in HackTricks** or **download HackTricks in PDF** Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Join the** 💬 [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Share your hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
