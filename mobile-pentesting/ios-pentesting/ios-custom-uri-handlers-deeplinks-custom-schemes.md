<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>


рдХрд╕реНрдЯрдо URL рд╕реНрдХреАрдо [рдРрдкреНрд╕ рдХреЛ рдПрдХ рдХрд╕реНрдЯрдо рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрдЪрд╛рд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ](https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple\_ref/doc/uid/TP40007072-CH6-SW1)ред рдПрдХ рдРрдк рдХреЛ рд╕реНрдХреАрдо рдХреЛ рдШреЛрд╖рд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЙрди URL рдХреЛ рд╕рдВрднрд╛рд▓рдирд╛ рд╣реЛрдЧрд╛ рдЬреЛ рдЙрди рд╕реНрдХреАрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред

> URL рд╕реНрдХреАрдо рдЖрдкрдХреЗ рдРрдк рдореЗрдВ рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рд╣рдорд▓рд╛ рд╡реЗрдХреНрдЯрд░ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ **рд╕рднреА URL рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░реЗрдВ** рдФрд░ **рдЕрд╡реИрдз URL рдХреЛ рдЫреЛрдбрд╝ рджреЗрдВ**ред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдЬреЛрдЦрд┐рдо рдореЗрдВ рди рдбрд╛рд▓рдиреЗ рд╡рд╛рд▓реЗ **рдХреНрд░рд┐рдпрд╛рдПрдБ** рдХреЛ рд╣реА рдЙрдкрд▓рдмреНрдз рдХрд░рд╛рдПрдВред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, URI: `myapp://hostname?data=123876123` рдРрдкреНрд▓рд┐рдХреЗрд╢рди mydata (рдЬрд┐рд╕рдиреЗ рд╕реНрдХреАрдо `mydata` рдХреЛ **рд░рдЬрд┐рд╕реНрдЯрд░** рдХрд┐рдпрд╛ рд╣реИ) рдХреЛ **рд╣реЛрд╕реНрдЯрдиреЗрдо** `hostname` рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд **рдХреНрд░рд┐рдпрд╛** рдХреЛ рдмреБрд▓рд╛рдПрдЧрд╛ рдФрд░ рдорд╛рди `123876123` рдХреЗ рд╕рд╛рде **рдкреИрд░рд╛рдореАрдЯрд░** `data` рдХреЛ рднреЗрдЬреЗрдЧрд╛ред

рдПрдХ рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рдЙрджрд╛рд╣рд░рдг рд╣реИ [Skype Mobile рдРрдк рдореЗрдВ рдмрдЧ](http://www.dhanjani.com/blog/2010/11/insecure-handling-of-url-schemes-in-apples-ios.html), рдЬрд┐рд╕реЗ 2010 рдореЗрдВ рдЦреЛрдЬрд╛ рдЧрдпрд╛ рдерд╛: Skype рдРрдк рдиреЗ `skype://` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИрдВрдбрд▓рд░ рдХреЛ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд┐рдпрд╛ рдерд╛, рдЬрд┐рд╕рдиреЗ **рдЕрдиреНрдп рдРрдкреНрд╕ рдХреЛ рдЕрдиреНрдп Skype рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдФрд░ рдлрд╝реЛрди рдирдВрдмрд░реЛрдВ рдкрд░ рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА**ред рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, Skype рдиреЗ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рд╕реЗ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рдорд╛рдВрдЧреА, рдЗрд╕рд▓рд┐рдП рдХрд┐рд╕реА рднреА рдРрдк рдиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЬреНрдЮрд╛рди рдХреЗ рдмрд┐рдирд╛ рд╡рд┐рднрд┐рдиреНрди рдирдВрдмрд░реЛрдВ рдкрд░ рдХреЙрд▓ рдХрд░ рд╕рдХрддрд╛ рдерд╛ред рд╣рдорд▓рд╛рд╡рд░ рдиреЗ рдЗрд╕ рд╕рдВрдХреНрд░рдордг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдЕрджреГрд╢реНрдп `<iframe src="skype://xxx?call"></iframe>` (рдЬрд╣рд╛рдВ `xxx` рдХреЛ рдПрдХ рдкреНрд░реАрдорд┐рдпрдо рдирдВрдмрд░ рд╕реЗ рдмрджрд▓ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛) рд░рдЦрд╛, рдЗрд╕рд▓рд┐рдП рдХрд┐рд╕реА рднреА Skype рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдиреЗ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рдПрдХ рдЦрддрд░рдирд╛рдХ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдЬрд╛рдиреЗ рдкрд░ рдкреНрд░реАрдорд┐рдпрдо рдирдВрдмрд░ рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ред

рдЖрдк рдРрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ **рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд┐рдП рдЧрдП рд╕реНрдХреАрдо** рдХреЛ рдРрдк рдХреЗ **`Info.plist`** рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдвреВрдВрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ, **`CFBundleURLTypes`** рдХреЗ рд▓рд┐рдП рдЦреЛрдЬ рдХрд░рдХреЗ (рдЙрджрд╛рд╣рд░рдг [iGoat-Swift](https://github.com/OWASP/iGoat-Swift) рд╕реЗ):
```markup
<key>CFBundleURLTypes</key>
<array>
<dict>
<key>CFBundleURLName</key>
<string>com.iGoat.myCompany</string>
<key>CFBundleURLSchemes</key>
<array>
<string>iGoat</string>
</array>
</dict>
</array>
```
рдпрд╣рд╛рдВ рдзреНрдпрд╛рди рджреЗрдВ, рдХрд┐ **рджреБрд╖реНрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди URIs рдХреЛ рдкреБрдирдГ рдкрдВрдЬреАрдХреГрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рджреНрд╡рд╛рд░рд╛ рдкрдВрдЬреАрдХреГрдд рд╣реЛ рдЪреБрдХреЗ рд╣реЛрддреЗ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **URIs рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА рднреЗрдЬ рд░рд╣реЗ рд╣реИрдВ** (myapp://hostname?password=123456), рддреЛ рдПрдХ **рджреБрд╖реНрдЯ** рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЗрд╕ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓** **рдЬрд╛рдирдХрд╛рд░реА** рдХреЗ рд╕рд╛рде URI рдХреЛ **рдЕрд╡рд░реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддреА рд╣реИред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЗрди URIs рдХрд╛ **рдЗрдирдкреБрдЯ рдЬрд╛рдВрдЪрд╛ рдФрд░ рд╕реНрд╡рдЪреНрдЫ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП**, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ **рджреБрд╖реНрдЯ** **рдореВрд▓реЛрдВ** рд╕реЗ рдЖ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ SQLInjections, XSS, CSRF, Path Traversals рдпрд╛ рдЕрдиреНрдп рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реЛрдВред

## рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреНрд╡реЗрд░реА рд╕реНрдХреАрдо рдкрдВрдЬреАрдХрд░рдг

рдРрдкреНрд╕ [`canOpenURL:`](https://developer.apple.com/documentation/uikit/uiapplication/1622952-canopenurl?language=objc) рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ **рд▓рдХреНрд╖рд┐рдд рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрдкрд▓рдмреНрдз рд╣реИ рдпрд╛ рдирд╣реАрдВ** рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рд╡рд┐рдзрд┐ рджреБрд╖реНрдЯ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ **рд╕реНрдерд╛рдкрд┐рдд рдРрдкреНрд╕ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ** рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХреА рдЬрд╛ рд░рд╣реА рдереА, [iOS 9.0 рд╕реЗ URL рд╕реНрдХреАрдореНрд╕ рдХреЛ рднреА рдШреЛрд╖рд┐рдд](https://developer.apple.com/documentation/uikit/uiapplication/1622952-canopenurl?language=objc#discussion) рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдРрдк рдХреЗ `Info.plist` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ `LSApplicationQueriesSchemes` рдХреБрдВрдЬреА рдФрд░ **рдЕрдзрд┐рдХрддрдо 50 URL рд╕реНрдХреАрдореНрд╕** рдХреА рдПрдХ рд╕рд░рдгреА рдЬреЛрдбрд╝рдХрд░ред
```markup
<key>LSApplicationQueriesSchemes</key>
<array>
<string>url_scheme1</string>
<string>url_scheme2</string>
</array>
```
`canOpenURL` рд╣рдореЗрд╢рд╛ `NO` рд▓реМрдЯрд╛рдПрдЧрд╛ рдЕрд╡рд┐рдгрд┐рдпрдд рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП, рдЪрд╛рд╣реЗ рдЙрдкрдпреБрдХреНрдд рдРрдк рд╕реНрдерд╛рдкрд┐рдд рд╣реЛ рдпрд╛ рди рд╣реЛред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдкреНрд░рддрд┐рдмрдВрдз рдХреЗрд╡рд▓ `canOpenURL` рдХреЗ рд▓рд┐рдП рд╣реА рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИред

## URL рд╣реИрдВрдбрд▓рд┐рдВрдЧ рдФрд░ рдорд╛рдиреНрдпрддрд╛ рдХреА рдкрд░реАрдХреНрд╖рдг

URL рдкрде рдХреИрд╕реЗ рдмрдирд╛рдпрд╛ рдФрд░ рдорд╛рдиреНрдпрддрд╛ рдХреИрд╕реЗ рдХреА рдЬрд╛рддреА рд╣реИ рдЗрд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдореВрд▓ рд╕реНрд░реЛрдд рдХреЛрдб рд╣реИ, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* `application:didFinishLaunchingWithOptions:` рд╡рд┐рдзрд┐ рдпрд╛ `application:will-FinishLaunchingWithOptions:`: рдпрд╣ рдирд┐рд░реНрдгрдп рдХреИрд╕реЗ рд▓рд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ URL рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдХреИрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛рддреА рд╣реИ, рдЗрд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░реЗрдВред
* [`application:openURL:options:`](https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1623112-application?language=objc): рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░реЗрдВ рдХрд┐ рд╕рдВрд╕рд╛рдзрди рдХреИрд╕реЗ рдЦреЛрд▓рд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рдЕрд░реНрдерд╛рдд рдбреЗрдЯрд╛ рдХреИрд╕реЗ рдкрд╛рд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, [рд╡рд┐рдХрд▓реНрдк](https://developer.apple.com/documentation/uikit/uiapplication/openurloptionskey) рдХреА рд╕рддреНрдпрд╛рдкрди рдХрд░реЗрдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдпрджрд┐ рдХреЙрд▓рд┐рдВрдЧ рдРрдк рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдВрдЪ ([`sourceApplication`](https://developer.apple.com/documentation/uikit/uiapplication/openurloptionskey/1623128-sourceapplication)) рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреА рдЪрд╛рд╣рд┐рдП рдпрд╛ рдирд╣реАрдВред рдХрд╕реНрдЯрдо URL рдпреЛрдЬрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдРрдк рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЕрдиреБрдорддрд┐ рднреА рдЪрд╛рд╣рд┐рдП рд╕рдХрддреА рд╣реИред

рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдореЗрдВ [рдЪрд╛рд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ](https://github.com/peter-iakovlev/Telegram-iOS/blob/87e0a33ac438c1d702f2a0b75bf21f26866e346f/Telegram-iOS/AppDelegate.swift#L1250):
```swift
func application(_ application: UIApplication, open url: URL, sourceApplication: String?) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, open url: URL, sourceApplication: String?,
annotation: Any) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ app: UIApplication, open url: URL,
options: [UIApplicationOpenURLOptionsKey : Any] = [:]) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, handleOpen url: URL) -> Bool {
self.openUrl(url: url)
return true
}
```
## рдЕрдиреНрдп рдРрдкреНрд╕ рдХреЗ рд▓рд┐рдП URL рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг

рд╡рд┐рдзрд┐ [`openURL:options:completionHandler:`](https://developer.apple.com/documentation/uikit/uiapplication/1648685-openurl?language=objc) рдФрд░ [рд╡рд┐рдЪрд▓рд┐рдд `UIApplication` рдХреА `openURL:` рд╡рд┐рдзрд┐](https://developer.apple.com/documentation/uikit/uiapplication/1622961-openurl?language=objc) рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИрдВ **URL рдЦреЛрд▓рдиреЗ** рдХреЗ рд▓рд┐рдП (рдЕрд░реНрдерд╛рдд рдЕрдиреНрдп рдРрдкреНрд╕ рдХреЛ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ / рдкреНрд░рд╢реНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП) рдЬреЛ рд╡рд░реНрддрдорд╛рди рдРрдк рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдиреАрдп рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдпрд╣ рдПрдХ рдРрд╕рд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдПрдХ рдЕрд▓рдЧ рдРрдк рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдореВрд▓ рд╕реНрд░реЛрдд рдХреЛрдб рд╣реИ, рддреЛ рдЖрдк рд╕реАрдзреЗ рдЙрди рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ рдЖрдк рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдРрдк рд╡рд┐рд╢реЗрд╖ рд╕реЗрд╡рд╛рдУрдВ рдпрд╛ рдРрдкреНрд╕ рдХреЛ рдкреНрд░рд╢реНрди рдХрд░ рд░рд╣рд╛ рд╣реИ, рдФрд░ рдпрджрд┐ рдРрдк рд╡рд┐рдЦреНрдпрд╛рдд рд╣реИ, рддреЛ рдЖрдк рдСрдирд▓рд╛рдЗрди рд╕рд╛рдорд╛рдиреНрдп URL schemes рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЕрдкрдиреЗ **greps (l**[**iOS рдРрдк рд╕реНрдХреАрдореЛрдВ рдХреА рд╕реВрдЪреА**](https://ios.gadgethacks.com/how-to/always-updated-list-ios-app-url-scheme-names-paths-for-shortcuts-0184033/)**)** рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
egrep -nr "open.*options.*completionHandler" ./Telegram-iOS/
egrep -nr "openURL\(" ./Telegram-iOS/
egrep -nr "mt-encrypted-file://" ./Telegram-iOS/
egrep -nr "://" ./Telegram-iOS/
```
## рд╡рд┐рдЪрд▓рд┐рдд рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг

рдЗрд╕ рддрд░рд╣ рдХреЗ рд╡рд┐рдЪрд▓рд┐рдд рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ рдЬреИрд╕реЗ:

* [`application:handleOpenURL:`](https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1622964-application?language=objc)
* [`openURL:`](https://developer.apple.com/documentation/uikit/uiapplication/1622961-openurl?language=objc)
* [`application:openURL:sourceApplication:annotation:`](https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1623073-application)

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣рд╛рдВ рд╣рдо рдЙрди рддреАрдиреЛрдВ рдХреЛ рдЦреЛрдЬрддреЗ рд╣реИрдВ:
```bash
$ rabin2 -zzq Telegram\ X.app/Telegram\ X | grep -i "openurl"

0x1000d9e90 31 30 UIApplicationOpenURLOptionsKey
0x1000dee3f 50 49 application:openURL:sourceApplication:annotation:
0x1000dee71 29 28 application:openURL:options:
0x1000dee8e 27 26 application:handleOpenURL:
0x1000df2c9 9 8 openURL:
0x1000df766 12 11 canOpenURL:
0x1000df772 35 34 openURL:options:completionHandler:
...
```
## рдЕрдирд┐рдпрдорд┐рдд URL рдХреЛ рдмреБрд▓рд╛рдирд╛

* **Safari**: рдПрдХ URL scheme рдХреЛ рдЬрд▓реНрджреА рд╕реЗ рдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк Safari рдореЗрдВ URL рдХреЛ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдРрдк рдХреИрд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк `tel://123456789` рд▓рд┐рдЦрддреЗ рд╣реИрдВ рддреЛ Safari рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ рдХрд┐ рд╡рд╣ рдирдВрдмрд░ рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗред
* **Notes App**: рдХрд╕реНрдЯрдо URL scheme рдХреЛ рдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рд▓рд┐рдВрдХ рдХреЛ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рджрдмрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЙрдиреНрд╣реЗрдВ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдкрд╛рджрди рдореЛрдб рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдирд╛ рди рднреВрд▓реЗрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк рдХреЗрд╡рд▓ рдРрдк рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрдиреЗ рдкрд░ рд╣реА рдХрд╕реНрдЯрдо URL scheme рд╡рд╛рд▓реЗ рд▓рд┐рдВрдХ рдкрд░ рдХреНрд▓рд┐рдХ рдпрд╛ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рджрдмрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЕрдЧрд░ рдирд╣реАрдВ рд╣реИрдВ рддреЛ рд╡реЗ _рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд▓рд┐рдВрдХ_ рдХреЗ рд░реВрдк рдореЗрдВ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдирд╣реАрдВ рд╣реЛрдВрдЧреЗред
* [**IDB**](https://github.com/facebook/idb):
* IDB рд╢реБрд░реВ рдХрд░реЗрдВ, рдЕрдкрдиреА рдбрд┐рд╡рд╛рдЗрд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ рдФрд░ рд▓рдХреНрд╖рд┐рдд рдРрдк рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред рдЖрдк [IDB рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг](https://www.idbtool.com/documentation/setup.html) рдореЗрдВ рд╡рд┐рд╡рд░рдг рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
* **URL Handlers** рдЦрдВрдб рдореЗрдВ рдЬрд╛рдПрдВред **URL schemes** рдореЗрдВ, **Refresh** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдФрд░ рдмрд╛рдПрдВ рдУрд░ рдЖрдкрдХреЛ рдЯреЗрд╕реНрдЯ рд╣реЛ рд░рд╣реЗ рдРрдк рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╕рднреА рдХрд╕реНрдЯрдо schemes рдХреА рд╕реВрдЪреА рдорд┐рд▓реЗрдЧреАред рдЖрдк рдЗрди schemes рдХреЛ рдЦреЛрд▓рдХрд░ рдЙрдиреНрд╣реЗрдВ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рджрд╛рдПрдВ рдУрд░ **Open** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗред рдПрдХ рд╕рд╛рджрд╛ URI scheme (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `myURLscheme://` рдЦреЛрд▓рдХрд░) рдЦреЛрд▓рдХрд░ рдЖрдк рдЫрд┐рдкреА рд╣реБрдИ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдбрд┐рдмрдЧ рд╡рд┐рдВрдбреЛ) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕реНрдерд╛рдиреАрдп рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдЫрд▓рдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
*   **Frida**:

рдпрджрд┐ рдЖрдк рдХреЗрд╡рд▓ URL scheme рдХреЛ рдЦреЛрд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЗрд╕реЗ Frida рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```javascript
$ frida -U iGoat-Swift

[iPhone::iGoat-Swift]-> function openURL(url) {
var UIApplication = ObjC.classes.UIApplication.sharedApplication();
var toOpen = ObjC.classes.NSURL.URLWithString_(url);
return UIApplication.openURL_(toOpen);
}
[iPhone::iGoat-Swift]-> openURL("tel://234234234")
true
```

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ [Frida CodeShare](https://codeshare.frida.re/@dki/ios-url-scheme-fuzzing/) рд╕реЗ рд▓реЗрдЦрдХ рдиреЗ рдЧреИрд░-рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ API `LSApplicationWorkspace.openSensitiveURL:withOptions:` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ URL рдХреЛ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рд╣реИ (SpringBoard рдРрдк рд╕реЗ):

```javascript
function openURL(url) {
var w = ObjC.classes.LSApplicationWorkspace.defaultWorkspace();
var toOpen = ObjC.classes.NSURL.URLWithString_(url);
return w.openSensitiveURL_withOptions_(toOpen, null);
}
```

> рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЧреИрд░-рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ API рдХрд╛ рдЙрдкрдпреЛрдЧ рдРрдк рд╕реНрдЯреЛрд░ рдкрд░ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрдиреНрд╣реЗрдВ рдЯреЗрд╕реНрдЯ рднреА рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдЕрдкрдиреЗ рдбрд╛рдпрдирд╛рдорд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред

## URL Schemes рдХреЛ рдлрдЬрд╝рд┐рд▓рддрд╛ рдХрд░рдирд╛

рдпрджрд┐ рдРрдк URL рдХреЗ рднрд╛рдЧреЛрдВ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдореЗрдореЛрд░реА рдХреЛрд░рдкреНрд╢рди рдмрдЧреНрд╕ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдирдкреБрдЯ рдлрдЬрд╝рд┐рд▓рддрд╛ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдКрдкрд░ рдЬреЛ рд╣рдордиреЗ рд╕реАрдЦрд╛ рд╣реИ, рдЙрд╕реЗ рдЕрдм рдЕрдкрдиреА рдкрд╕рдВрдж рдХреА рднрд╛рд╖рд╛ рдореЗрдВ рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдлрдЬрд╝рд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ Python рдореЗрдВ рдФрд░ [Frida рдХреЗ RPC](https://www.frida.re/docs/javascript-api/#rpc) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ `openURL` рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВред рд╡рд╣ рдлрдЬрд╝рд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛рд░реНрдп рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП:

* рдкреЗрд▓реЛрдб рдЙрддреНрдкрдиреНрди рдХрд░реЗрдВред
* рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд▓рд┐рдП `openURL` рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВред
* рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдРрдк рдХреНрд░реИрд╢ рд░рд┐рдкреЛрд░реНрдЯ (`.ips`) рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ `/private/var/mobile/Library/Logs/CrashReporter` рдореЗрдВред

[FuzzDB](https://github.com/fuzzdb-project/fuzzdb) рдкрд░рд┐рдпреЛрдЬрдирд╛ рдлрдЬрд╝рд┐рд▓рддрд╛ рд╢рдмреНрджрдХреЛрд╢ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЖрдк рдкреЗрд▓реЛрдб рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## Frida рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрдЬрд╝рд┐рд▓рддрд╛ рдХрд░рдирд╛

Frida рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдХрд░рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реИ, рдЖрдк рдЗрд╕ [рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ](https://grepharder.github.io/blog/0x03\_learning\_about\_universal\_links\_and\_fuzzing\_url\_schemes\_on\_ios\_with\_frida.html) рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ iGoat-Swift рдРрдк (iOS 11.1.2 рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ) рдХреЛ рдлрдЬрд╝рд┐рд▓рддрд╛ рдХрд░рддрд╛ рд╣реИред

рдлрдЬрд╝рд░ рдЪрд▓рд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╣рдореЗрдВ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ URL schemes рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рд╕реНрдЯреЗрдЯрд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╕реЗ рд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ iGoat-Swift рдРрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд URL scheme рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ: `iGoat://?contactNumber={0}&message={0}`.
```bash
$ frida -U SpringBoard -l ios-url-scheme-fuzzing.js
[iPhone::SpringBoard]-> fuzz("iGoat", "iGoat://?contactNumber={0}&message={0}")
Watching for crashes from iGoat...
No logs were moved.
Opened URL: iGoat://?contactNumber=0&message=0
```
# рд╕рдВрджрд░реНрдн

{% embed url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-object-persistence-mstg-platform-8" %}



<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>
