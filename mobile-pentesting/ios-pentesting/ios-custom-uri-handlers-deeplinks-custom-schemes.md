<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк **HackTricks рдореЗрдВ рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВ**.
* [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>


рдХрд╕реНрдЯрдо URL рд╕реНрдХреАрдореНрд╕ [рдПрдкреНрд╕ рдХреЛ рдХрд╕реНрдЯрдо рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВ](https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW1). рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╕реНрдХреАрдореНрд╕ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдШреЛрд╖рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЙрди рд╕реНрдХреАрдореНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЖрдиреЗ рд╡рд╛рд▓реЗ URLs рдХреЛ рд╕рдВрднрд╛рд▓рдирд╛ рдЪрд╛рд╣рд┐рдПред

> URL рд╕реНрдХреАрдореНрд╕ рдЖрдкрдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рд╣рдорд▓реЗ рдХрд╛ рдорд╛рд░реНрдЧ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ **рд╕рднреА URL рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЛ рдорд╛рдиреНрдп рдХрд░реЗрдВ** рдФрд░ **рдХрд┐рд╕реА рднреА рдЧрд▓рдд рдмрдирд╛рдП рдЧрдП URLs рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ**. рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЙрдкрд▓рдмреНрдз **рдХреНрд░рд┐рдпрд╛рдУрдВ** рдХреЛ рд╕реАрдорд┐рдд рдХрд░реЗрдВ рдЬреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдбреЗрдЯрд╛ рдХреЗ рдЬреЛрдЦрд┐рдо рдореЗрдВ рдирд╣реАрдВ рд╣реИрдВ**ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, URI: `myapp://hostname?data=123876123` **рдПрдкреНрд▓рд┐рдХреЗрд╢рди** mydata рдХреЛ **рдЖрдордВрддреНрд░рд┐рдд** рдХрд░реЗрдЧрд╛ (рдЬрд┐рд╕рдиреЗ рд╕реНрдХреАрдо `mydata` рдХреЛ **рд░рдЬрд┐рд╕реНрдЯрд░** рдХрд┐рдпрд╛ рд╣реИ) **рдХреНрд░рд┐рдпрд╛** рдХреЗ рд▓рд┐рдП рдЬреЛ **hostname** `hostname` рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИ, **рдкреИрд░рд╛рдореАрдЯрд░** `data` рдХреЗ рд╕рд╛рде рдорд╛рди `123876123` рднреЗрдЬ рд░рд╣рд╛ рд╣реИред

рдПрдХ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЙрджрд╛рд╣рд░рдг рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд [Skype Mobile рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдмрдЧ](http://www.dhanjani.com/blog/2010/11/insecure-handling-of-url-schemes-in-apples-ios.html) рд╣реИ, рдЬреЛ 2010 рдореЗрдВ рдЦреЛрдЬрд╛ рдЧрдпрд╛ рдерд╛: Skype рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдиреЗ `skype://` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИрдВрдбрд▓рд░ рдХреЛ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд┐рдпрд╛ рдерд╛, рдЬрд┐рд╕рдиреЗ **рдЕрдиреНрдп рдПрдкреНрд╕ рдХреЛ рдЕрдиреНрдп Skype рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдФрд░ рдлреЛрди рдирдВрдмрд░реЛрдВ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА**ред рджреБрд░реНрднрд╛рдЧреНрдпрд╡рд╢, Skype рдиреЗ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рд╕реЗ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рдорд╛рдВрдЧреА, рдЗрд╕рд▓рд┐рдП рдХреЛрдИ рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдмрд┐рдирд╛ рдордирдорд╛рдиреЗ рдирдВрдмрд░реЛрдВ рдкрд░ рдХреЙрд▓ рдХрд░ рд╕рдХрддрд╛ рдерд╛ред рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдиреЗ рдЗрд╕ рдХрдордЬреЛрд░реА рдХрд╛ рдлрд╛рдпрджрд╛ рдЙрдард╛рдпрд╛ рдПрдХ рдЕрджреГрд╢реНрдп `<iframe src="skype://xxx?call"></iframe>` (рдЬрд╣рд╛рдВ `xxx` рдХреЛ рдПрдХ рдкреНрд░реАрдорд┐рдпрдо рдирдВрдмрд░ рд╕реЗ рдмрджрд▓ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛) рдбрд╛рд▓рдХрд░, рдЗрд╕рд▓рд┐рдП рдХреЛрдИ рднреА Skype рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЬреЛ рдЧрд▓рддреА рд╕реЗ рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдЧрдпрд╛, рдЙрд╕рдиреЗ рдкреНрд░реАрдорд┐рдпрдо рдирдВрдмрд░ рдкрд░ рдХреЙрд▓ рдХрд┐рдпрд╛ред

рдЖрдк рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ **рд░рдЬрд┐рд╕реНрдЯрд░ рдХреА рдЧрдИ рд╕реНрдХреАрдореНрд╕** рдХреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА **`Info.plist`** рдлрд╛рдЗрд▓ рдореЗрдВ **`CFBundleURLTypes`** рдХреА рдЦреЛрдЬ рдХрд░рдХреЗ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг [iGoat-Swift](https://github.com/OWASP/iGoat-Swift) рд╕реЗ):
```markup
<key>CFBundleURLTypes</key>
<array>
<dict>
<key>CFBundleURLName</key>
<string>com.iGoat.myCompany</string>
<key>CFBundleURLSchemes</key>
<array>
<string>iGoat</string>
</array>
</dict>
</array>
```
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди URIs рдХреЛ рдкреБрдирдГ рдкрдВрдЬреАрдХреГрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рджреНрд╡рд╛рд░рд╛ рдкрдВрдЬреАрдХреГрдд рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА URIs рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреЗрдЬ рд░рд╣реЗ рд╣реИрдВ** (myapp://hostname?password=123456) рддреЛ рдПрдХ **рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг** рдПрдкреНрд▓рд┐рдХреЗрд╢рди **рд╕рдВрд╡реЗрджрдирд╢реАрд▓** **рдЬрд╛рдирдХрд╛рд░реА** рд╡рд╛рд▓реЗ URI рдХреЛ **рдЕрд╡рд░реЛрдзрд┐рдд** рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рд╕рд╛рде рд╣реА, рдЗрди URIs рдХреЗ рдЗрдирдкреБрдЯ рдХреА **рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП рдФрд░ рд╕рд╛рдл рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП,** рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ **рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг** **рдореВрд▓** рд╕реЗ рдЖ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ SQLInjections, XSS, CSRF, Path Traversals, рдпрд╛ рдЕрдиреНрдп рд╕рдВрднрд╛рд╡рд┐рдд рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реЛрдВред

## рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреНрд╡реЗрд░реА рд╕реНрдХреАрдореНрд╕ рдкрдВрдЬреАрдХрд░рдг

рдПрдкреНрд▓рд┐рдХреЗрд╢рди [`canOpenURL:`](https://developer.apple.com/documentation/uikit/uiapplication/1622952-canopenurl?language=objc) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ **рд▓рдХреНрд╖реНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрдкрд▓рдмреНрдз рд╣реИ**ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЪреВрдВрдХрд┐ рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ **рд╕реНрдерд╛рдкрд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рдерд╛**, [iOS 9.0 рд╕реЗ рдЗрд╕рдореЗрдВ рдкрд╛рд╕ рдХрд┐рдП рдЧрдП URL рд╕реНрдХреАрдореНрд╕ рдХреЛ рднреА рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП](https://developer.apple.com/documentation/uikit/uiapplication/1622952-canopenurl?language=objc#discussion) рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА `Info.plist` рдлрд╛рдЗрд▓ рдореЗрдВ `LSApplicationQueriesSchemes` рдХреБрдВрдЬреА рдЬреЛрдбрд╝рдХрд░ рдФрд░ **50 URL рд╕реНрдХреАрдореНрд╕ рддрдХ рдХреА рдПрдХ рд╕рд░рдгреА**ред
```markup
<key>LSApplicationQueriesSchemes</key>
<array>
<string>url_scheme1</string>
<string>url_scheme2</string>
</array>
```
`canOpenURL` рд╣рдореЗрд╢рд╛ рдЕрдШреЛрд╖рд┐рдд рд╕реНрдХреАрдореЛрдВ рдХреЗ рд▓рд┐рдП `NO` рд▓реМрдЯрд╛рдПрдЧрд╛, рдЪрд╛рд╣реЗ рдЙрдЪрд┐рдд рдРрдк рд╕реНрдерд╛рдкрд┐рдд рд╣реЛ рдпрд╛ рди рд╣реЛред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдкреНрд░рддрд┐рдмрдВрдз рдХреЗрд╡рд▓ `canOpenURL` рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИред

## URL рд╣реИрдВрдбрд▓рд┐рдВрдЧ рдФрд░ рд╡реИрд▓рд┐рдбреЗрд╢рди рдХреА рдЬрд╛рдВрдЪ

URL рдкрде рдХреИрд╕реЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рд╡реИрд▓рд┐рдбреЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдореВрд▓ рд╕реНрд░реЛрдд рдХреЛрдб рд╣реИ, рддреЛ рдЖрдк **рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**:

* `application:didFinishLaunchingWithOptions:` рд╡рд┐рдзрд┐ рдпрд╛ `application:will-FinishLaunchingWithOptions:`: рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдирд┐рд░реНрдгрдп рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ URL рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдХреИрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛рддреА рд╣реИред
* [`application:openURL:options:`](https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1623112-application?language=objc): рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рд╕рдВрд╕рд╛рдзрди рдХреЛ рдХреИрд╕реЗ рдЦреЛрд▓рд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рдЕрд░реНрдерд╛рддреН рдбреЗрдЯрд╛ рдХреИрд╕реЗ рдкрд╛рд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, [рд╡рд┐рдХрд▓реНрдкреЛрдВ](https://developer.apple.com/documentation/uikit/uiapplication/openurloptionskey) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдпрджрд┐ рдХреЙрд▓рд┐рдВрдЧ рдРрдк рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдВрдЪ ([`sourceApplication`](https://developer.apple.com/documentation/uikit/uiapplication/openurloptionskey/1623128-sourceapplication)) рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП рдпрд╛ рдирд╣реАрдВред рдРрдк рдХреЛ рдХрд╕реНрдЯрдо URL рд╕реНрдХреАрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЕрдиреБрдорддрд┐ рднреА рдЪрд╛рд╣рд┐рдП рд╣реЛ рд╕рдХрддреА рд╣реИред

Telegram рдореЗрдВ рдЖрдк [рдЪрд╛рд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддреЗ рд╣реБрдП рдкрд╛рдПрдВрдЧреЗ](https://github.com/peter-iakovlev/Telegram-iOS/blob/87e0a33ac438c1d702f2a0b75bf21f26866e346f/Telegram-iOS/AppDelegate.swift#L1250):
```swift
func application(_ application: UIApplication, open url: URL, sourceApplication: String?) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, open url: URL, sourceApplication: String?,
annotation: Any) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ app: UIApplication, open url: URL,
options: [UIApplicationOpenURLOptionsKey : Any] = [:]) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, handleOpen url: URL) -> Bool {
self.openUrl(url: url)
return true
}
```
## рдЕрдиреНрдп рдРрдкреНрд╕ рдХреЗ рд▓рд┐рдП URL рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг

[`openURL:options:completionHandler:`](https://developer.apple.com/documentation/uikit/uiapplication/1648685-openurl?language=objc) рд╡рд┐рдзрд┐ рдФрд░ [`UIApplication`](https://developer.apple.com/documentation/uikit/uiapplication/1622961-openurl?language=objc) рдХреА рдкреБрд░рд╛рдиреА `openURL:` рд╡рд┐рдзрд┐ **URLs рдЦреЛрд▓рдиреЗ** (рдЕрд░реНрдерд╛рддреН рдЕрдиреНрдп рдРрдкреНрд╕ рдХреЛ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ / рдХреНрд╡реЗрд░реА рдХрд░рдиреЗ) рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИрдВ, рдЬреЛ рдореМрдЬреВрджрд╛ рдРрдк рдХреЗ рд▓реЛрдХрд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдлрд┐рд░ рдРрд╕реЗ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЕрд▓рдЧ рдРрдк рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдореВрд▓ рд╕реНрд░реЛрдд рдХреЛрдб рд╣реИ рддреЛ рдЖрдк рд╕реАрдзреЗ рдЙрди рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдЙрдкрдпреЛрдЧреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрджрд┐ рдЖрдк рдпрд╣ рдЬрд╛рдирдиреЗ рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдРрдк рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реЗрд╡рд╛рдУрдВ рдпрд╛ рдРрдкреНрд╕ рдХреА рдХреНрд╡реЗрд░реА рдХрд░ рд░рд╣рд╛ рд╣реИ, рдФрд░ рдпрджрд┐ рдРрдк рдкреНрд░рд╕рд┐рджреНрдз рд╣реИ, рддреЛ рдЖрдк рд╕рд╛рдорд╛рдиреНрдп URL рд╕реНрдХреАрдореЛрдВ рдХреЛ рдСрдирд▓рд╛рдЗрди рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЕрдкрдиреЗ **greps (l**[**ist of iOS app schemes**](https://ios.gadgethacks.com/how-to/always-updated-list-ios-app-url-scheme-names-paths-for-shortcuts-0184033/)**)** рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
egrep -nr "open.*options.*completionHandler" ./Telegram-iOS/
egrep -nr "openURL\(" ./Telegram-iOS/
egrep -nr "mt-encrypted-file://" ./Telegram-iOS/
egrep -nr "://" ./Telegram-iOS/
```
## рдкреБрд░рд╛рдиреА рдкрджреНрдзрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг

рдкреБрд░рд╛рдиреА рдкрджреНрдзрддрд┐рдпреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ рдЬреИрд╕реЗ:

* [`application:handleOpenURL:`](https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1622964-application?language=objc)
* [`openURL:`](https://developer.apple.com/documentation/uikit/uiapplication/1622961-openurl?language=objc)
* [`application:openURL:sourceApplication:annotation:`](https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1623073-application)

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣рд╛рдБ рд╣рдо рдЙрди рддреАрдиреЛрдВ рдХреЛ рдкрд╛рддреЗ рд╣реИрдВ:
```bash
$ rabin2 -zzq Telegram\ X.app/Telegram\ X | grep -i "openurl"

0x1000d9e90 31 30 UIApplicationOpenURLOptionsKey
0x1000dee3f 50 49 application:openURL:sourceApplication:annotation:
0x1000dee71 29 28 application:openURL:options:
0x1000dee8e 27 26 application:handleOpenURL:
0x1000df2c9 9 8 openURL:
0x1000df766 12 11 canOpenURL:
0x1000df772 35 34 openURL:options:completionHandler:
...
```
## рдЕрдирд┐рдпрдорд┐рдд URLs рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛

* **Safari**: рдПрдХ URL рд╕реНрдХреАрдо рдХрд╛ рддреНрд╡рд░рд┐рдд рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк Safari рдкрд░ URLs рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдРрдк рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк `tel://123456789` рд▓рд┐рдЦрддреЗ рд╣реИрдВ рддреЛ safari рдЙрд╕ рдирдВрдмрд░ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ред
* **Notes App**: рдХрд╕реНрдЯрдо URL рд╕реНрдХреАрдореНрд╕ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдиреЗ рдЬреЛ рд▓рд┐рдВрдХреНрд╕ рд▓рд┐рдЦреЗ рд╣реИрдВ рдЙрдиреНрд╣реЗрдВ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рджрдмрд╛рдПрдВред рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рд▓рд┐рдВрдХреНрд╕ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрдкрд╛рджрди рдореЛрдб рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдирд╛ рд╣реЛрдЧрд╛ред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк рдХрд╕реНрдЯрдо URL рд╕реНрдХреАрдореНрд╕ рд╕рд╣рд┐рдд рд▓рд┐рдВрдХреНрд╕ рдкрд░ рдХреНрд▓рд┐рдХ рдпрд╛ рд▓рдВрдмреЗ рд╕рдордп рддрдХ рджрдмрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХреЗрд╡рд▓ рдпрджрд┐ рдРрдк рд╕реНрдерд╛рдкрд┐рдд рд╣реИ, рдЕрдиреНрдпрдерд╛ рд╡реЗ _рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд▓рд┐рдВрдХреНрд╕_ рдХреЗ рд░реВрдк рдореЗрдВ рд╣рд╛рдЗрд▓рд╛рдЗрдЯ рдирд╣реАрдВ рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗред
* [**IDB**](https://github.com/facebook/idb):
* IDB рд╢реБрд░реВ рдХрд░реЗрдВ, рдЕрдкрдиреЗ рдбрд┐рд╡рд╛рдЗрд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ рдФрд░ рд▓рдХреНрд╖реНрдп рдРрдк рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред рдЖрдк [IDB рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг](https://www.idbtool.com/documentation/setup.html) рдореЗрдВ рд╡рд┐рд╡рд░рдг рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред
* **URL Handlers** рдЕрдиреБрднрд╛рдЧ рдкрд░ рдЬрд╛рдПрдВред **URL рд╕реНрдХреАрдореНрд╕** рдореЗрдВ, **Refresh** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдФрд░ рдмрд╛рдИрдВ рдУрд░ рдЖрдкрдХреЛ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдП рдЬрд╛ рд░рд╣реЗ рдРрдк рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рд╕рднреА рдХрд╕реНрдЯрдо рд╕реНрдХреАрдореНрд╕ рдХреА рд╕реВрдЪреА рдорд┐рд▓реЗрдЧреАред рдЖрдк рдЗрди рд╕реНрдХреАрдореНрд╕ рдХреЛ рджрд╛рдИрдВ рдУрд░ **Open** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдПрдХ рдЦрд╛рд▓реА URI рд╕реНрдХреАрдо рдХреЛ рд╕рд┐рд░реНрдл рдЦреЛрд▓рдХрд░ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `myURLscheme://` рдЦреЛрд▓рдирд╛), рдЖрдк рдЫрд┐рдкреЗ рд╣реБрдП рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ (рдЬреИрд╕реЗ, рдПрдХ рдбреАрдмрдЧ рд╡рд┐рдВрдбреЛ) рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╕реНрдерд╛рдиреАрдп рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
*   **Frida**:

рдпрджрд┐ рдЖрдк рд╕рд┐рд░реНрдл URL рд╕реНрдХреАрдо рдЦреЛрд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдЗрд╕реЗ Frida рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```javascript
$ frida -U iGoat-Swift

[iPhone::iGoat-Swift]-> function openURL(url) {
var UIApplication = ObjC.classes.UIApplication.sharedApplication();
var toOpen = ObjC.classes.NSURL.URLWithString_(url);
return UIApplication.openURL_(toOpen);
}
[iPhone::iGoat-Swift]-> openURL("tel://234234234")
true
```

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ [Frida CodeShare](https://codeshare.frida.re/@dki/ios-url-scheme-fuzzing/) рд╕реЗ рд▓реЗрдЦрдХ рдиреЗ SpringBoard рдРрдк рд╕реЗ URLs рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЧреИрд░-рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ API `LSApplicationWorkspace.openSensitiveURL:withOptions:` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИ:

```javascript
function openURL(url) {
var w = ObjC.classes.LSApplicationWorkspace.defaultWorkspace();
var toOpen = ObjC.classes.NSURL.URLWithString_(url);
return w.openSensitiveURL_withOptions_(toOpen, null);
}
```

> рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЧреИрд░-рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ APIs рдХрд╛ рдЙрдкрдпреЛрдЧ App Store рдкрд░ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрдирдХрд╛ рдкрд░реАрдХреНрд╖рдг рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдЕрдкрдиреЗ рдЧрддрд┐рд╢реАрд▓ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИред

## URL Schemes рдХреЛ Fuzzing рдХрд░рдирд╛

рдпрджрд┐ рдРрдк URL рдХреЗ рд╣рд┐рд╕реНрд╕реЛрдВ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдореЗрдореЛрд░реА рдХрд░рдкреНрд╢рди рдмрдЧреНрд╕ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдирдкреБрдЯ fuzzing рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЬреЛ рд╣рдордиреЗ рдКрдкрд░ рд╕реАрдЦрд╛ рд╣реИ рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдм рдЖрдк рдЕрдкрдиреА рдкрд╕рдВрдж рдХреА рднрд╛рд╖рд╛ рдореЗрдВ рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ fuzzer рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ Python рдореЗрдВ рдФрд░ [Frida's RPC](https://www.frida.re/docs/javascript-api/#rpc) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ `openURL` рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрд╕ fuzzer рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП:

* рдкреЗрд▓реЛрдбреНрд╕ рдЬрдирд░реЗрдЯ рдХрд░рдирд╛ред
* рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд▓рд┐рдП `openURL` рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ред
* рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдРрдк `/private/var/mobile/Library/Logs/CrashReporter` рдореЗрдВ рдХреНрд░реИрд╢ рд░рд┐рдкреЛрд░реНрдЯ (`.ips`) рдЬрдирд░реЗрдЯ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред

[FuzzDB](https://github.com/fuzzdb-project/fuzzdb) рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдкреЗрд▓реЛрдбреНрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП fuzzing рд╢рдмреНрджрдХреЛрд╢ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

## **Frida рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Fuzzing**

Frida рдХреЗ рд╕рд╛рде рдпрд╣ рдХрд░рдирд╛ рдХрд╛рдлреА рдЖрд╕рд╛рди рд╣реИ, рдЖрдк рдЗрд╕ [рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ](https://grepharder.github.io/blog/0x03\_learning\_about\_universal\_links\_and\_fuzzing\_url\_schemes\_on\_ios\_with\_frida.html) рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ iGoat-Swift рдРрдк рдХреЛ fuzz рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рджрд┐рдЦрд╛рддрд╛ рд╣реИ (iOS 11.1.2 рдкрд░ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИ)ред

fuzzer рдЪрд▓рд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╣рдореЗрдВ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ URL рд╕реНрдХреАрдореНрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рд╕реНрдерд┐рд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╕реЗ рд╣рдо рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ iGoat-Swift рдРрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд URL рд╕реНрдХреАрдо рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ: `iGoat://?contactNumber={0}&message={0}`ред
```bash
$ frida -U SpringBoard -l ios-url-scheme-fuzzing.js
[iPhone::SpringBoard]-> fuzz("iGoat", "iGoat://?contactNumber={0}&message={0}")
Watching for crashes from iGoat...
No logs were moved.
Opened URL: iGoat://?contactNumber=0&message=0
```
# рд╕рдВрджрд░реНрдн

{% embed url="https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#testing-object-persistence-mstg-platform-8" %}



<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдУрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) рдкрд░ **рдлреЙрд▓реЛ рдХрд░реЗрдВ**.
* **HackTricks** рдХреЗ [**github рд░реЗрдкреЛрдЬ**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ.

</details>
