<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

Αυτό είναι ένα σύνοψη από τις σχετικές πληροφορίες από το [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)

## Βασικές Πληροφορίες

Οι προσαρμοσμένοι URI handlers επιτρέπουν στις εφαρμογές να επικοινωνούν χρησιμοποιώντας ένα προσαρμοσμένο πρωτόκολλο, όπως περιγράφεται στην [τεκμηρίωση του Apple Developer](https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW1). Αυτά τα πρωτόκολλα πρέπει να δηλωθούν από την εφαρμογή, η οποία στη συνέχεια χειρίζεται τα εισερχόμενα URLs που ακολουθούν αυτά τα πρωτόκολλα. Είναι κρίσιμο να **επικυρώνονται όλοι οι παράμετροι του URL** και **να απορρίπτονται τα μη έγκυρα URLs** για να αποτραπούν επιθέσεις μέσω αυτού του διανύσματος.

Δίνεται ένα παράδειγμα όπου το URI `myapp://hostname?data=123876123` ενεργοποιεί μια συγκεκριμένη ενέργεια της εφαρμογής. Ένα ευπάθεια που παρατηρήθηκε ήταν στην εφαρμογή Skype Mobile, η οποία επέτρεπε μη εξουσιοδοτημένες κλήσεις μέσω του πρωτοκόλλου `skype://`. Οι εγγεγραμμένοι προσαρμοσμένοι πρωτόκολλα μπορούν να βρεθούν στο `Info.plist` της εφαρμογής στο πεδίο `CFBundleURLTypes`. Κακόβουλες εφαρμογές μπορούν να εκμεταλλευτούν αυτό επανεγγράφοντας τα URIs για να παρακολουθήσουν ευαίσθητες πληροφορίες.

### Εγγραφή Προσαρμοσμένων Πρωτοκόλλων Ερωτήματος Εφαρμογής

Από το iOS 9.0, για να ελέγξετε αν μια εφαρμογή είναι διαθέσιμη, η `canOpenURL:` απαιτεί τη δήλωση πρωτοκόλλων URL στο `Info.plist` στο πεδίο `LSApplicationQueriesSchemes`. Αυτό περιορίζει τα πρωτόκολλα που μια εφαρμογή μπορεί να ερωτήσει σε 50, βελτιώνοντας την ιδιωτικότητα αποτρέποντας την απαρίθμηση των εφαρμογών.
```xml
<key>LSApplicationQueriesSchemes</key>
<array>
<string>url_scheme1</string>
<string>url_scheme2</string>
</array>
```
### Δοκιμή Χειρισμού και Επικύρωσης των URL

Οι προγραμματιστές θα πρέπει να εξετάζουν συγκεκριμένες μεθόδους στον πηγαίο κώδικα για να κατανοήσουν την κατασκευή και την επικύρωση της διαδρομής του URL, όπως οι `application:didFinishLaunchingWithOptions:` και `application:openURL:options:`. Για παράδειγμα, η εφαρμογή Telegram χρησιμοποιεί διάφορες μεθόδους για το άνοιγμα των URL:
```swift
func application(_ application: UIApplication, open url: URL, sourceApplication: String?) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, open url: URL, sourceApplication: String?,
annotation: Any) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ app: UIApplication, open url: URL,
options: [UIApplicationOpenURLOptionsKey : Any] = [:]) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, handleOpen url: URL) -> Bool {
self.openUrl(url: url)
return true
}
```
### Δοκιμή αιτημάτων URL προς άλλες εφαρμογές

Μέθοδοι όπως η `openURL:options:completionHandler:` είναι κρίσιμες για το άνοιγμα URL για αλληλεπίδραση με άλλες εφαρμογές. Η αναγνώριση της χρήσης τέτοιων μεθόδων στον πηγαίο κώδικα της εφαρμογής είναι καίρια για την κατανόηση των εξωτερικών επικοινωνιών.

### Δοκιμή για αποσυντεθειμένες μεθόδους

Πρέπει να αναγνωριστούν και να ελεγχθούν οι αποσυντεθειμένες μέθοδοι που χειρίζονται το άνοιγμα URL, όπως οι `application:handleOpenURL:` και `openURL:`, για πιθανές επιπτώσεις στην ασφάλεια.

### Ανίχνευση σφαλμάτων URL Schemes

Η ανίχνευση σφαλμάτων στα URL schemes μπορεί να αναγνωρίσει προβλήματα μνήμης. Εργαλεία όπως το [Frida](https://codeshare.frida.re/@dki/ios-url-scheme-fuzzing/) μπορούν να αυτοματοποιήσουν αυτήν τη διαδικασία ανοίγοντας URLs με διάφορα φορτία για να παρακολουθήσουν τυχόν ανατροπές, όπως φαίνεται από την παραπλάνηση των URLs στην εφαρμογή iGoat-Swift:
```bash
$ frida -U SpringBoard -l ios-url-scheme-fuzzing.js
[iPhone::SpringBoard]-> fuzz("iGoat", "iGoat://?contactNumber={0}&message={0}")
Watching for crashes from iGoat...
No logs were moved.
Opened URL: iGoat://?contactNumber=0&message=0
```
## Αναφορές
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΠΛΑΝΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
