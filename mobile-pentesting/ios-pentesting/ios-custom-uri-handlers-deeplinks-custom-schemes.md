<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories senden.

</details>

Dies ist eine Zusammenfassung der relevanten Informationen von [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)

## Grundlegende Informationen

Benutzerdefinierte URL-Schemata erm√∂glichen es Apps, √ºber ein benutzerdefiniertes Protokoll zu kommunizieren, wie in der [Apple Developer-Dokumentation](https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Inter-AppCommunication/Inter-AppCommunication.html#//apple_ref/doc/uid/TP40007072-CH6-SW1) beschrieben. Diese Schemata m√ºssen von der App deklariert werden, die dann eingehende URLs gem√§√ü diesen Schemata verarbeitet. Es ist entscheidend, **alle URL-Parameter zu validieren** und **fehlerhafte URLs zu verwerfen**, um Angriffe √ºber diesen Vektor zu verhindern.

Ein Beispiel ist gegeben, bei dem die URI `myapp://hostname?data=123876123` eine bestimmte Aktion der Anwendung aufruft. Eine bekannte Schwachstelle bestand in der Skype Mobile-App, die unerlaubte Anrufaktionen √ºber das `skype://`-Protokoll erm√∂glichte. Die registrierten Schemata finden sich in der `Info.plist` der App unter `CFBundleURLTypes`. B√∂sartige Anwendungen k√∂nnen dies ausnutzen, indem sie URIs erneut registrieren, um sensible Informationen abzufangen.

### Registrierung von Anwendungsabfrageschemata

Ab iOS 9.0 erfordert `canOpenURL:` zur √úberpr√ºfung der Verf√ºgbarkeit einer App die Deklaration von URL-Schemata in der `Info.plist` unter `LSApplicationQueriesSchemes`. Dadurch werden die Schemata eingeschr√§nkt, die eine App abfragen kann, auf 50 begrenzt, um die Privatsph√§re durch Verhinderung der App-Aufz√§hlung zu verbessern.
```xml
<key>LSApplicationQueriesSchemes</key>
<array>
<string>url_scheme1</string>
<string>url_scheme2</string>
</array>
```
### Testen der URL-Behandlung und -Validierung

Entwickler sollten bestimmte Methoden im Quellcode √ºberpr√ºfen, um die Konstruktion und Validierung des URL-Pfads zu verstehen, wie z.B. `application:didFinishLaunchingWithOptions:` und `application:openURL:options:`. Zum Beispiel verwendet Telegram verschiedene Methoden zum √ñffnen von URLs:
```swift
func application(_ application: UIApplication, open url: URL, sourceApplication: String?) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, open url: URL, sourceApplication: String?,
annotation: Any) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ app: UIApplication, open url: URL,
options: [UIApplicationOpenURLOptionsKey : Any] = [:]) -> Bool {
self.openUrl(url: url)
return true
}

func application(_ application: UIApplication, handleOpen url: URL) -> Bool {
self.openUrl(url: url)
return true
}
```
### Testen von URL-Anfragen an andere Apps

Methoden wie `openURL:options:completionHandler:` sind entscheidend, um URLs zu √∂ffnen und mit anderen Apps zu interagieren. Die Identifizierung der Verwendung solcher Methoden im Quellcode der App ist entscheidend, um externe Kommunikation zu verstehen.

### Testen veralteter Methoden

Veraltete Methoden zur Behandlung von URL-√ñffnungen, wie `application:handleOpenURL:` und `openURL:`, sollten identifiziert und auf Sicherheitsimplikationen √ºberpr√ºft werden.

### Fuzzing von URL-Schemata

Das Fuzzing von URL-Schemata kann Speicherbesch√§digungsfehler identifizieren. Tools wie [Frida](https://codeshare.frida.re/@dki/ios-url-scheme-fuzzing/) k√∂nnen diesen Prozess automatisieren, indem sie URLs mit unterschiedlichen Payloads √∂ffnen, um auf Abst√ºrze zu √ºberwachen. Dies wird am Beispiel der Manipulation von URLs in der iGoat-Swift-App veranschaulicht:
```bash
$ frida -U SpringBoard -l ios-url-scheme-fuzzing.js
[iPhone::SpringBoard]-> fuzz("iGoat", "iGoat://?contactNumber={0}&message={0}")
Watching for crashes from iGoat...
No logs were moved.
Opened URL: iGoat://?contactNumber=0&message=0
```
## Referenzen
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0075/)

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
