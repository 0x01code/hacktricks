# Op√©rations de base de test iOS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Obtenir l'UDID d'un appareil iOS

{% hint style="info" %}
Effectuez ces actions en ayant **connect√©** l'appareil √† l'ordinateur via **USB** et en ayant l'appareil **d√©verrouill√©**.
{% endhint %}

L'UDID est une s√©quence unique de 40 chiffres et lettres permettant d'identifier un appareil iOS. Vous pouvez trouver l'UDID de votre appareil iOS sur macOS Catalina et ult√©rieur dans l'application **Finder**, car iTunes n'est plus disponible dans Catalina. Il suffit de s√©lectionner l'appareil iOS connect√© dans Finder et de **cliquer sur les informations sous le nom de l'appareil iOS** pour les parcourir. En plus de l'UDID, vous pouvez trouver le num√©ro de s√©rie, l'IMEI et d'autres informations utiles.

![](<../../.gitbook/assets/image (471).png>)

Si vous utilisez une version de macOS ant√©rieure √† Catalina, vous pouvez trouver l'[UDID de votre appareil iOS via iTunes](http://www.iclarified.com/52179/how-to-find-your-iphones-udid), en s√©lectionnant votre appareil et en cliquant sur "Num√©ro de s√©rie" dans l'onglet R√©sum√©. En cliquant dessus, vous parcourrez les diff√©rentes m√©tadonn√©es de l'appareil iOS, y compris son UDID.

Il est √©galement possible d'obtenir l'UDID via divers outils en ligne de commande sur macOS lorsque l'appareil est connect√© via USB :

* En utilisant l'outil [I/O Registry Explorer](https://developer.apple.com/library/archive/documentation/DeviceDrivers/Conceptual/IOKitFundamentals/TheRegistry/TheRegistry.html) `ioreg` :

```bash
$ ioreg -p IOUSB -l | grep "USB Serial"
|         "USB Serial Number" = "9e8ada44246cee813e2f8c1407520bf2f84849ec"
```
* En utilisant [ideviceinstaller](https://github.com/libimobiledevice/ideviceinstaller) (√©galement disponible sur Linux) :

```bash
$ brew install ideviceinstaller
$ idevice_id -l
316f01bd160932d2bf2f95f1f142bc29b1c62dbc
```
* En utilisant le system\_profiler :

```bash
$ system_profiler SPUSBDataType | sed -n -e '/iPad/,/Serial/p;/iPhone/,/Serial/p;/iPod/,/Serial/p' | grep "Serial Number:"
2019-09-08 10:18:03.920 system_profiler[13251:1050356] SPUSBDevice: IOCreatePlugInInterfaceForService failed 0xe00002be
Serial Number: 64655621de6ef5e56a874d63f1e1bdd14f7103b1
```
* En utilisant instruments :

```bash
$ instruments -s devices
```

## Acc√©der √† l'interpr√©teur de commandes de l'appareil

Apr√®s avoir jailbreak√© l'appareil, vous devriez avoir install√© un nouveau gestionnaire d'applications comme **Cydia**.

### SSH

Pour activer l'acc√®s SSH √† votre appareil iOS, vous pouvez installer le **paquet OpenSSH**. Une fois install√©, vous pouvez acc√©der √† votre appareil via ssh en ex√©cutant `ssh root@<adresse_ip_de_l'appareil>`, ce qui vous connectera en tant qu'utilisateur root :
```bash
$ ssh root@192.168.197.234
root@192.168.197.234's password:
iPhone:~ root#
```
Lorsque vous acc√©dez √† votre appareil iOS via SSH, tenez compte des √©l√©ments suivants :

* Les **utilisateurs par d√©faut sont `root` et `mobile`**.
* Le mot de passe par d√©faut pour les deux est **`alpine`**.

> N'oubliez pas de changer le mot de passe par d√©faut pour les utilisateurs `root` et `mobile`, car toute personne sur le m√™me r√©seau peut trouver l'adresse IP de votre appareil et se connecter avec le mot de passe par d√©faut bien connu, ce qui leur donnera un acc√®s root √† votre appareil.

### **Se connecter √† un appareil via SSH via USB**

Lors d'un test en bo√Æte noire r√©el, une connexion Wi-Fi fiable peut ne pas √™tre disponible. Dans cette situation, vous pouvez utiliser usbmuxd pour vous connecter au serveur SSH de votre appareil via USB.

Connectez macOS √† un appareil iOS en installant et en lan√ßant iproxy :
```bash
$ brew install libimobiledevice
$ iproxy 2222 22
waiting for connection
```
La commande ci-dessus mappe le port `22` de l'appareil iOS sur le port `2222` de localhost. Vous pouvez √©galement [faire en sorte que iproxy s'ex√©cute automatiquement en arri√®re-plan](https://iphonedevwiki.net/index.php/SSH\_Over\_USB) si vous ne souhaitez pas ex√©cuter le binaire √† chaque fois que vous souhaitez utiliser SSH via USB.

Avec la commande suivante dans une nouvelle fen√™tre de terminal, vous pouvez vous connecter √† l'appareil :
```bash
$ ssh -p 2222 root@localhost
root@localhost's password:
iPhone:~ root#
```
> Petite note sur l'USB d'un iDevice : sur un appareil iOS, vous ne pouvez plus √©tablir de connexions de donn√©es apr√®s 1 heure d'inactivit√©, √† moins de le d√©verrouiller √† nouveau en raison du mode restreint USB, qui a √©t√© introduit avec iOS 11.4.1.

### Application Shell sur l'appareil

Bien que l'utilisation d'un **shell sur l'appareil** (√©mulateur de terminal) puisse √™tre tr√®s fastidieuse par rapport √† un shell distant, elle peut s'av√©rer pratique pour le d√©bogage en cas, par exemple, de probl√®mes de r√©seau ou de v√©rification de certaines configurations. Par exemple, vous pouvez installer [NewTerm 2](https://repo.chariz.io/package/ws.hbang.newterm2/) via Cydia √† cette fin (il prend en charge iOS 6.0 √† 12.1.2 au moment de la r√©daction de ceci).

De plus, il existe quelques jailbreaks qui d√©sactivent explicitement SSH entrant _pour des raisons de s√©curit√©_. Dans ces cas, il est tr√®s pratique d'avoir une application shell sur l'appareil, que vous pouvez utiliser pour d'abord √©tablir une connexion SSH sortante depuis l'appareil avec un shell invers√©, puis vous connecter depuis votre ordinateur h√¥te.

Ouvrir un shell invers√© via SSH peut √™tre fait en ex√©cutant la commande `ssh -R <remote_port>:localhost:22 <username>@<host_computer_ip>`.

Sur l'application shell sur l'appareil, ex√©cutez la commande suivante et, lorsque vous y √™tes invit√©, saisissez le mot de passe de l'utilisateur `mstg` de l'ordinateur h√¥te :
```bash
ssh -R 2222:localhost:22 mstg@192.168.197.235
```
Sur votre ordinateur h√¥te, ex√©cutez la commande suivante et, lorsque vous y √™tes invit√©, saisissez le mot de passe de l'utilisateur `root` de l'appareil iOS :
```bash
$ ssh -p 2222 root@localhost
```
### **Mot de passe oubli√©**

Si vous oubliez votre mot de passe et souhaitez le r√©initialiser par d√©faut **`alpine`** :

1. Modifiez le fichier `/private/etc/master.passwd` sur votre appareil iOS jailbreak√© √† l'aide d'un **terminal** sur l'appareil ou en utilisant des applications comme **Filza** ou **iFile**.
2. Trouvez les lignes :

```bash
root:xxxxxxxxx:0:0::0:0:System Administrator:/var/root:/bin/sh
mobile:xxxxxxxxx:501:501::0:0:Mobile User:/var/mobile:/bin/sh
```
3. Changez `xxxxxxxxx` en `/smx7MYTQIi2M` (qui est le mot de passe hach√© `alpine`).
4. Enregistrez et quittez.

## Transfert de donn√©es

### Copie des fichiers de donn√©es de l'application via SSH et SCP

Comme nous le savons maintenant, les fichiers de notre application sont stock√©s dans le r√©pertoire Data. Vous pouvez maintenant simplement archiver le r√©pertoire Data avec `tar` et le r√©cup√©rer depuis l'appareil avec `scp` :
```bash
iPhone:~ root# tar czvf /tmp/data.tgz /private/var/mobile/Containers/Data/Application/8C8E7EB0-BC9B-435B-8EF8-8F5560EB0693
iPhone:~ root# exit
$ scp -P 2222 root@localhost:/tmp/data.tgz .
```
### Utilisation de iFunbox

[**iFunbox**](https://www.i-funbox.com/en/page-download.html) est une application GUI qui peut √™tre utilis√©e pour plusieurs choses (y compris le t√©l√©chargement/t√©l√©versement de fichiers).\
Un autre outil GUI √† cette fin est [**iExplorer**](https://macroplant.com/iexplorer).

{% hint style="info" %}
√Ä partir de la version iOS 8.4, Apple a **restreint l'acc√®s des gestionnaires tiers au sandbox de l'application**, donc des outils comme iFunbox et iExplorer n'affichent plus/r√©cup√®rent plus les fichiers des applications install√©es sur l'appareil si celui-ci n'est pas jailbreak√©.
{% endhint %}

### Utilisation de Objection

Lorsque vous d√©marrez objection (`objection --gadget com.apple.mobilesafari explorer`), vous trouverez l'invite dans le r√©pertoire Bundle.
```bash
org.owasp.MSTG on (iPhone: 10.3.3) [usb] # pwd print
Current directory: /var/containers/Bundle/Application/DABF849D-493E-464C-B66B-B8B6C53A4E76/org.owasp.MSTG.app
```
Utilisez la commande `env` pour obtenir les r√©pertoires de l'application et naviguez vers le r√©pertoire Documents.
```bash
org.owasp.MSTG on (iPhone: 10.3.3) [usb] # cd /var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/Documents
/var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/Documents
```
Avec la commande `file download <nom du fichier>`, vous pouvez t√©l√©charger un fichier depuis l'appareil iOS vers votre ordinateur h√¥te et l'analyser par la suite.
```bash
org.owasp.MSTG on (iPhone: 10.3.3) [usb] # file download .com.apple.mobile_container_manager.metadata.plist
Downloading /var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/.com.apple.mobile_container_manager.metadata.plist to .com.apple.mobile_container_manager.metadata.plist
Streaming file from device...
Writing bytes to destination...
Successfully downloaded /var/mobile/Containers/Data/Application/72C7AAFB-1D75-4FBA-9D83-D8B4A2D44133/.com.apple.mobile_container_manager.metadata.plist to .com.apple.mobile_container_manager.metadata.plist
```
Vous pouvez √©galement t√©l√©charger des fichiers sur l'appareil iOS avec `file upload <chemin_fichier_local>`.

## Obtention et extraction des applications

### Obtenir le fichier IPA √† partir d'un lien de distribution OTA

Pendant le d√©veloppement, les applications sont parfois fournies aux testeurs via une distribution over-the-air (OTA). Dans cette situation, vous recevrez un lien itms-services, comme celui-ci :
```
itms-services://?action=download-manifest&url=https://s3-ap-southeast-1.amazonaws.com/test-uat/manifest.plist
```
Vous pouvez utiliser l'outil [ITMS services asset downloader](https://www.npmjs.com/package/itms-services) pour t√©l√©charger l'IPA √† partir d'une URL de distribution OTA. Installez-le via npm :
```bash
$ npm install -g itms-services
```
Enregistrez le fichier IPA localement avec la commande suivante :
```bash
# itms-services -u "itms-services://?action=download-manifest&url=https://s3-ap-southeast-1.amazonaws.com/test-uat/manifest.plist" -o - > out.ipa
```
### Acquisition du binaire de l'application

1. **√Ä partir d'un IPA** :

Si vous avez l'IPA (probablement incluant un binaire d'application d√©j√† d√©crypt√©), d√©compressez-le et vous √™tes pr√™t √† commencer. Le binaire de l'application se trouve dans le r√©pertoire principal du bundle (.app), par exemple `Payload/Telegram X.app/Telegram X`. Consultez la sous-section suivante pour plus de d√©tails sur l'extraction des listes de propri√©t√©s.

> Dans le Finder de macOS, les r√©pertoires .app sont ouverts en faisant un clic droit dessus et en s√©lectionnant "Afficher le contenu du paquet". Dans le terminal, vous pouvez simplement vous d√©placer avec la commande `cd`.

2. √Ä partir d'un **appareil jailbreak√©** :

Si vous n'avez pas l'IPA d'origine, vous avez besoin d'un appareil jailbreak√© sur lequel vous allez **installer l'application** (par exemple via l'App Store). Une fois install√©e, vous devez **extraire le binaire de l'application de la m√©moire et reconstruire le fichier IPA**. En raison de la gestion des droits num√©riques (DRM), le fichier binaire de l'application est chiffr√© lorsqu'il est stock√© sur l'appareil iOS, il ne suffit donc pas de le r√©cup√©rer depuis le bundle (que ce soit via SSH ou Objection) pour le r√©tro-ing√©nierer (lire la section suivante).

### D√©cryptage (Manuel)

Contrairement √† une application Android, le binaire d'une application iOS **ne peut √™tre que d√©sassembl√©** et non d√©compil√©.\
Lorsqu'une application est soumise √† l'App Store, Apple v√©rifie d'abord le comportement de l'application et, avant de la publier sur l'App Store, **Apple chiffre le binaire √† l'aide de** [**FairPlay**](https://developer.apple.com/streaming/fps/). Ainsi, le t√©l√©chargement du binaire depuis l'App Store est chiffr√©, ce qui complique les t√¢ches de r√©tro-ing√©nierie.

Cependant, notez qu'il existe d'autres **logiciels tiers pouvant √™tre utilis√©s pour obfusquer** les binaires r√©sultants.

Pour ex√©cuter le binaire chiffr√©, l'appareil doit le d√©crypter en m√©moire. Ensuite, il est possible de **dump le binaire d√©crypt√© depuis la m√©moire**.

Tout d'abord, v√©rifiez si le binaire est compil√© avec le drapeau PIE (Position Independent Code) :
```bash
otool -Vh Original_App #Check the last word of the last line of this code
Home:
Mach header
magic  cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
MH_MAGIC_64   X86_64        ALL  0x00     EXECUTE    47       6080   NOUNDEFS DYLDLINK TWOLEVEL PIE
```
Si elle est d√©finie, vous pouvez utiliser le script [`change_macho_flags.py`](https://chromium.googlesource.com/chromium/src/+/49.0.2623.110/build/mac/change\_mach\_o\_flags.py) pour la supprimer avec python2 :
```bash
python change_mach_o_flags.py --no-pie Original_App
otool -Vh Hello_World
Hello_World:
Mach header
magic  cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
MH_MAGIC      ARM         V7  0x00     EXECUTE    22       2356   NOUNDEFS DYLDLINK TWOLEVEL MH_NO_HEAP_EXECUTION
```
Maintenant que le drapeau PIE n'est pas activ√©, le syst√®me d'exploitation chargera le programme √† un **emplacement de d√©part fixe** √† chaque fois. Pour trouver cet **emplacement**, vous pouvez utiliser :
```bash
otool -l Original_App | grep -A 3 LC_SEGMENT | grep -A 1 __TEXT
segname __TEXT
vmaddr 0x00004000
```
Ensuite, il est n√©cessaire d'extraire la plage de m√©moire qui doit √™tre dump√©e :
```bash
otool -l Original_App | grep -A 4 LC_ENCRYPTION_INFO
cmd LC_ENCRYPTION_INFO
cmdsize 20
cryptoff 16384
cryptsize 17416192
cryptid 0
```
La valeur de **`cryptoff`** indique l'adresse de d√©part du contenu chiffr√© et **`cryptsize`** indique la taille du contenu chiffr√©.

Ainsi, l'`adresse de d√©part` pour le vidage sera `vmaddr + cryptoff` et l'`adresse de fin` sera l'`adresse de d√©part + cryptsize`.\
Dans ce cas : `adresse_de_d√©part = 0x4000 + 0x4000 = 0x8000` \_\_ et `adresse_de_fin = 0x8000 + 0x109c000 = 0x10a4000`

Avec ces informations, il suffit d'ex√©cuter l'application sur l'appareil jailbreak√©, de se connecter au processus avec gdb (`gdb -p <pid>`) et de vider la m√©moire :
```bash
dump memory dump.bin 0x8000 0x10a4000
```
F√©licitations ! Vous avez d√©chiffr√© la section chiffr√©e dans dump.bin. Maintenant, **transf√©rez cette sauvegarde sur votre ordinateur et remplacez la section chiffr√©e par la version d√©chiffr√©e** :
```bash
dd bs=1 seek=<starting_address> conv=notrunc if=dump.bin of=Original_App
```
Il reste une √©tape √† compl√©ter. L'application **indique** toujours dans ses m√©tadonn√©es qu'elle est **crypt√©e**, mais ce n'est pas le cas. Ensuite, lors de l'ex√©cution, l'appareil va essayer de d√©crypter la section d√©j√† d√©crypt√©e et cela va √©chouer.\
Cependant, vous pouvez utiliser des outils comme [**MachOView**](https://sourceforge.net/projects/machoview/) pour modifier cette information. Il suffit d'ouvrir le binaire et de d√©finir le **cryptid** √† 0 :

![](<../../.gitbook/assets/image (470).png>)

### D√©cryptage (Automatiquement)

#### frida-ios-dump

Vous pouvez utiliser des outils comme [**frida-ios-dump**](https://github.com/AloneMonkey/frida-ios-dump) pour **supprimer automatiquement le chiffrement d'une application**.

Tout d'abord, assurez-vous que la configuration dans **Frida-ios-dump** `dump.py` est d√©finie soit sur localhost avec le port 2222 lorsque vous utilisez **iproxy**, soit sur l'adresse IP r√©elle et le port de l'appareil √† partir duquel vous souhaitez extraire le binaire.

Maintenant, vous pouvez utiliser en toute s√©curit√© l'outil pour **√©num√©rer** les **applications** **install√©es** :
```bash
$ python dump.py -l
PID  Name             Identifier
----  ---------------  -------------------------------------
860  Cydia            com.saurik.Cydia
1130  Settings         com.apple.Preferences
685  Mail             com.apple.mobilemail
834  Telegram         ph.telegra.Telegraph
-  Stocks           com.apple.stocks
...
```
et vous pouvez **extraire** **un** des binaires r√©pertori√©s :
```bash
$ python3 dump.py -u "root" -p "<PASSWORD>" ph.telegra.Telegraph

Start the target app ph.telegra.Telegraph
Dumping Telegram to /var/folders/qw/gz47_8_n6xx1c_lwq7pq5k040000gn/T
[frida-ios-dump]: HockeySDK.framework has been loaded.
[frida-ios-dump]: Load Postbox.framework success.
[frida-ios-dump]: libswiftContacts.dylib has been dlopen.
...
start dump /private/var/containers/Bundle/Application/14002D30-B113-4FDF-BD25-1BF740383149/Telegram.app/Frameworks/libswiftsimd.dylib
libswiftsimd.dylib.fid: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 343k/343k [00:00<00:00, 1.54MB/s]
start dump /private/var/containers/Bundle/Application/14002D30-B113-4FDF-BD25-1BF740383149/Telegram.app/Frameworks/libswiftCoreData.dylib
libswiftCoreData.dylib.fid: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 82.5k/82.5k [00:00<00:00, 477kB/s]
5.m4a: 80.9MB [00:14, 5.85MB/s]
0.00B [00:00, ?B/s]Generating "Telegram.ipa"
```
Apr√®s cela, le fichier `Telegram.ipa` sera cr√©√© dans votre r√©pertoire actuel. Vous pouvez valider le succ√®s du dump en supprimant l'application et en la r√©installant (par exemple, en utilisant [**ios-deploy**](https://github.com/ios-control/ios-deploy) `ios-deploy -b Telegram.ipa`). Notez que cela ne fonctionnera que sur des appareils jailbreak√©s, car sinon la signature ne sera pas valide.

#### flexdecrypt

Pour **obtenir le fichier ipa** √† partir d'une application install√©e, vous pouvez √©galement utiliser l'outil [**flexdecrypt**](https://github.com/JohnCoates/flexdecrypt) ou un wrapper de l'outil appel√© [**flexdump**](https://gist.github.com/defparam/71d67ee738341559c35c684d659d40ac)**.**\
Dans tous les cas, vous devrez **installer flexdecrypt sur l'appareil** en ex√©cutant quelque chose comme :
```markup
wget https://github.com/JohnCoates/flexdecrypt/releases/download/1.1/flexdecrypt.deb
dpkg -i flexdecrypt.deb
rm flexdecrypt.deb
```
et pour utiliser **flexdump** :
```bash
apt install zip unzip
wget https://gist.githubusercontent.com/defparam/71d67ee738341559c35c684d659d40ac/raw/30c7612262f1faf7871ba8e32fbe29c0f3ef9e27/flexdump -P /usr/local/bin; chmod +x /usr/local/bin/flexdump
flexdump list #List apps
flexdump dump Twitter.app #Create .ipa file from app
```
#### r2flutch

[**r2flutch**](https://github.com/as0ler/r2flutch) est un outil qui utilise **radare** et **frida** pour **d√©crypter** et **extraire** les applications iOS.

Consultez le **github** pour plus d'informations.

## Installation des applications

Lorsque vous installez une application sans utiliser l'App Store d'Apple, on parle de **sideloading**. Il existe diff√©rentes fa√ßons de faire du sideloading, qui sont d√©crites ci-dessous. Sur l'appareil iOS, le processus d'installation r√©el est ensuite g√©r√© par le **d√©mon installd**, qui va **d√©compresser** et **installer** l'application. Pour int√©grer des services d'application ou √™tre install√©es sur un appareil iOS, toutes les **applications doivent √™tre sign√©es avec un certificat d√©livr√© par Apple**. Cela signifie que l'application ne peut √™tre install√©e qu'apr√®s une v√©rification r√©ussie de la signature du code. Sur un t√©l√©phone jailbreak√©, cependant, vous pouvez **contourner cette fonctionnalit√© de s√©curit√© avec** [**AppSync**](http://repo.hackyouriphone.org/appsyncunified), un package disponible dans le magasin Cydia. Il contient de nombreuses applications utiles qui exploitent les privil√®ges root fournis par le jailbreak pour ex√©cuter des fonctionnalit√©s avanc√©es. **AppSync est un tweak qui patche installd**, permettant l'installation de packages IPA sign√©s de mani√®re frauduleuse.

Diff√©rentes m√©thodes existent pour installer un package IPA sur un appareil iOS, qui sont d√©crites en d√©tail ci-dessous.

> Veuillez noter qu'iTunes n'est plus disponible dans macOS Catalina. Si vous utilisez une version plus ancienne de macOS, iTunes est toujours disponible, mais depuis iTunes 12.7, il n'est pas possible d'installer des applications.

#### Cydia Impactor

[Cydia Impactor](http://www.cydiaimpactor.com) a √©t√© initialement cr√©√© pour jailbreaker les iPhones, mais a √©t√© r√©√©crit pour signer et installer des packages IPA sur les appareils iOS via le sideloading (et m√™me des fichiers APK sur les appareils Android). Cydia Impactor est disponible pour Windows, macOS et Linux. Un [guide √©tape par √©tape et des √©tapes de d√©pannage sont disponibles sur yalujailbreak.net](https://yalujailbreak.net/how-to-use-cydia-impactor/).

#### libimobiledevice

Sur Linux et macOS, vous pouvez √©galement utiliser [libimobiledevice](https://www.libimobiledevice.org), une biblioth√®que de protocoles logiciels multiplateformes et un ensemble d'outils pour la communication native avec les appareils iOS. Cela vous permet d'installer des applications via une connexion USB en ex√©cutant ideviceinstaller. La connexion est mise en ≈ìuvre avec le d√©mon de multiplexage USB [usbmuxd](https://www.theiphonewiki.com/wiki/Usbmux), qui fournit un tunnel TCP via USB.

Le package pour libimobiledevice sera disponible dans votre gestionnaire de paquets Linux. Sur macOS, vous pouvez installer libimobiledevice via brew:
```bash
$ brew install libimobiledevice
$ brew install ideviceinstaller
```
Apr√®s l'installation, vous disposez de plusieurs nouveaux outils en ligne de commande, tels que `ideviceinfo`, `ideviceinstaller` ou `idevicedebug`.
```bash
# The following command will show detailed information about the iOS device connected via USB.
$ ideviceinfo
# The following command will install the IPA to your iOS device.
$ ideviceinstaller -i iGoat-Swift_v1.0-frida-codesigned.ipa
...
Install: Complete
# The following command will start the app in debug mode, by providing the bundle name. The bundle name can be found in the previous command after "Installing".
$ idevicedebug -d run OWASP.iGoat-Swift
```
#### ipainstaller

L'IPA peut √©galement √™tre install√© directement sur l'appareil iOS via la ligne de commande avec [ipainstaller](https://github.com/autopear/ipainstaller). Apr√®s avoir copi√© le fichier sur l'appareil, par exemple via scp, vous pouvez ex√©cuter ipainstaller avec le nom de fichier de l'IPA :
```bash
$ ipainstaller App_name.ipa
```
#### ios-deploy

Sur macOS, vous pouvez √©galement utiliser l'outil **ios-deploy** pour installer des applications iOS √† partir de la ligne de commande. Vous devrez d√©compresser votre IPA car ios-deploy utilise les bundles d'applications pour installer les applications.
```bash
$ unzip Name.ipa
$ ios-deploy --bundle 'Payload/Name.app' -W -d -v
```
Apr√®s l'installation de l'application sur l'appareil iOS, vous pouvez simplement la d√©marrer en ajoutant le drapeau `-m` qui lancera directement le d√©bogage sans r√©installer l'application.
```bash
$ ios-deploy --bundle 'Payload/Name.app' -W -d -v -m
```
#### Xcode

Il est √©galement possible d'utiliser l'IDE Xcode pour installer des applications iOS en suivant les √©tapes suivantes :

1. Lancez Xcode
2. S√©lectionnez **Window/Devices and Simulators**
3. S√©lectionnez l'appareil iOS connect√© et cliquez sur le signe **+** dans **Installed Apps**.

#### Autoriser l'installation d'une application sur un appareil non iPad

Parfois, une application peut n√©cessiter d'√™tre utilis√©e sur un appareil iPad. Si vous n'avez que des appareils iPhone ou iPod touch, vous pouvez forcer l'application √† accepter d'√™tre install√©e et utilis√©e sur ce type d'appareils. Vous pouvez le faire en modifiant la valeur de la propri√©t√© **UIDeviceFamily** √† la valeur **1** dans le fichier **Info.plist**.
```markup
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>

<key>UIDeviceFamily</key>
<array>
<integer>1</integer>
</array>

</dict>
</plist>
```
Il est important de noter que modifier cette valeur rompra la signature originale du fichier IPA, vous devez donc resigner l'IPA, apr√®s la mise √† jour, afin de l'installer sur un appareil sur lequel la validation de la signature n'a pas √©t√© d√©sactiv√©e.

Cette m√©thode de contournement peut ne pas fonctionner si l'application n√©cessite des fonctionnalit√©s sp√©cifiques aux iPad modernes alors que votre iPhone ou iPod est un peu plus ancien.

Les valeurs possibles pour la propri√©t√© [UIDeviceFamily](https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple\_ref/doc/uid/TP40009252-SW11) peuvent √™tre trouv√©es dans la documentation du d√©veloppeur Apple.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
