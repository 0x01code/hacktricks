# iOS рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

**рдпрд╣рд╛рдВ рд╕реЗ рд╕рд╛рдордЧреНрд░реА рдХреЙрдкреА рдХреА рдЧрдИ рд╣реИ** [**https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#app-extensions**](https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06h-testing-platform-interaction#app-extensions)

рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдРрдкреНрд╕ рдХреЛ рдпрд╣ рд╕реБрд╡рд┐рдзрд╛ рдФрд░ рд╕рд╛рдордЧреНрд░реА рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдЬрдм рд╡реЗ рдЕрдиреНрдп рдРрдкреНрд╕ рдпрд╛ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕рд╛рде рдЗрдВрдЯрд░реИрдХреНрдЯ рдХрд░ рд░рд╣реЗ рд╣реЛрддреЗ рд╣реИрдВред рдХреБрдЫ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реИрдВ:

* **рдХрд╕реНрдЯрдо рдХреАрдмреЛрд░реНрдб**: iOS рд╕рд┐рд╕реНрдЯрдо рдХреАрдмреЛрд░реНрдб рдХреЛ рд╕рднреА рдРрдкреНрд╕ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрд╕реНрдЯрдо рдХреАрдмреЛрд░реНрдб рд╕реЗ рдмрджрд▓рддрд╛ рд╣реИред
* **рд╢реЗрдпрд░**: рд╢реЗрдпрд░рд┐рдВрдЧ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдкреЛрд╕реНрдЯ рдХрд░реЗрдВ рдпрд╛ рджреВрд╕рд░реЛрдВ рдХреЗ рд╕рд╛рде рд╕рд╛рдордЧреНрд░реА рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред
* **рдЯреБрдбреЗ**: рдЗрд╕реЗ **рд╡рд┐рдЬреЗрдЯреНрд╕** рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рдиреЛрдЯрд┐рдлрд┐рдХреЗрд╢рди рд╕реЗрдВрдЯрд░ рдХреЗ рдЯреБрдбреЗ рд╡реНрдпреВ рдореЗрдВ рд╕рд╛рдордЧреНрд░реА рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ рдпрд╛ рддреНрд╡рд░рд┐рдд рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ _рд╣реЛрд╕реНрдЯ рдРрдк_ рдореЗрдВ рдкрд╛рда рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ, "рд╢реЗрдпрд░" рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕реВрдЪреА рд╕реЗ "рдРрдк" рдпрд╛ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИред рдЗрд╕рд╕реЗ _рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди_ рдХреЛ _рд╕рдВрдмрдВрдзрд┐рдд рдРрдк_ рдХрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддрд╛ рд╣реИред рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╣реЛрд╕реНрдЯ рдРрдк рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдЕрдкрдирд╛ рджреГрд╢реНрдп рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдХрд╛рд░реНрдп (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ рд╕реЛрд╢рд▓ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдкреЛрд╕реНрдЯ рдХрд░реЗрдВ) рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЛрд╕реНрдЯ рдРрдк рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдЖрдЗрдЯрдо, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЪрдпрдирд┐рдд рдкрд╛рда, рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд╕рд╛рд░рд╛рдВрд╢рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА [Apple App Extension Programming Guide](https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/ExtensionOverview.html#//apple\_ref/doc/uid/TP40014214-CH2-SW13) рд╕реЗ рдпрд╣ рдЪрд┐рддреНрд░ рджреЗрдЦреЗрдВ:

![](https://gblobscdn.gitbook.com/assets%2F-LH00RC4WVf3-6Ou4e0l%2F-Lf1APQHyCHdAvoJSvc\_%2F-Lf1AQx9khfTwUwYuMti%2Fapp\_extensions\_communication.png?alt=media)

### **рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдмрдВрдзреА рд╡рд┐рдЪрд╛рд░рдгрд╛рдПрдВ**

рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐:

* рдПрдХ **рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрднреА рднреА рдЕрдкрдиреЗ рд╕рдВрдмрдВрдзрд┐рдд рдРрдк рдХреЗ рд╕рд╛рде рд╕реАрдзреЗ рд╕рдВрд╡рд╛рдж рдирд╣реАрдВ рдХрд░рддрд╛** рд╣реИ (рд╕рд╛рдорд╛рдиреНрдпрддрдГ, рдпрд╣ рдЪрд▓ рд░рд╣рд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЪрд▓ рд░рд╣рд╛ рд╣реЛрддрд╛ рд╣реИ)ред
* рдПрдХ **рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдФрд░ **рд╣реЛрд╕реНрдЯ рдРрдк** **рдЗрдВрдЯрд░-рдкреНрд░реЛрд╕реЗрд╕** рд╕рдВрд╡рд╛рдж рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рд╕рдВрд╡рд╛рдж рдХрд░рддреЗ** рд╣реИрдВред
* рдПрдХ **рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдРрдк** рдФрд░ **рд╣реЛрд╕реНрдЯ рдРрдк рдХрднреА рднреА рд╕рдВрд╡рд╛рдж рдирд╣реАрдВ рдХрд░рддреЗ** рд╣реИрдВред
* **рдЯреБрдбреЗ рд╡рд┐рдЬреЗрдЯ** (рдФрд░ рдХреЛрдИ рдЕрдиреНрдп рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкреНрд░рдХрд╛рд░ рдирд╣реАрдВ) рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рдЕрдкрдиреЗ рд╕рдВрдмрдВрдзрд┐рдд рдРрдк рдХреЛ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП `NSExtensionContext` рдХрдХреНрд╖рд╛ рдХреЗ `openURL:completionHandler:` рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдкреНрд░рдгрд╛рд▓реА рд╕реЗ рдкреВрдЫ рд╕рдХрддрд╛ рд╣реИред
* рдХрд┐рд╕реА рднреА **рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдФрд░ рдЙрд╕рдХреЗ **рд╕рдВрдмрдВрдзрд┐рдд рдРрдк** рдХреЛ рдПрдХ рдирд┐рдЬреА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕рд╛рдЭрд╛ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рд╕рд╛рдЭрд╛ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рдорд┐рд▓ рд╕рдХрддреА рд╣реИред
* рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди **рдХреБрдЫ рдПрдкреАрдЖрдИ рддрдХ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рдкрд╛ рд╕рдХрддреЗ**, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, HealthKitред
* рд╡реЗ **AirDrop рдХрд╛
```bash
$ grep -nr NSExtensionPointIdentifier Payload/Telegram\ X.app/
Binary file Payload/Telegram X.app//PlugIns/SiriIntents.appex/Info.plist matches
Binary file Payload/Telegram X.app//PlugIns/Share.appex/Info.plist matches
Binary file Payload/Telegram X.app//PlugIns/NotificationContent.appex/Info.plist matches
Binary file Payload/Telegram X.app//PlugIns/Widget.appex/Info.plist matches
Binary file Payload/Telegram X.app//Watch/Watch.app/PlugIns/Watch Extension.appex/Info.plist matches
```
рдЖрдк SSH рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ, рдРрдк рдмрдВрдбрд▓ рдХреЛ рдЦреЛрдЬреЗрдВ рдФрд░ рд╕рднреА рдЕрдВрджрд░ рдХреЗ рдкреНрд▓рдЧрдЗрди рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдВ (рдпреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╡рд╣рд╛рдВ рд░рдЦреЗ рдЬрд╛рддреЗ рд╣реИрдВ) рдпрд╛ рдЗрд╕реЗ objection рдХреЗ рд╕рд╛рде рдХрд░реЗрдВ:
```bash
ph.telegra.Telegraph on (iPhone: 11.1.2) [usb] # cd PlugIns
/var/containers/Bundle/Application/15E6A58F-1CA7-44A4-A9E0-6CA85B65FA35/
Telegram X.app/PlugIns

ph.telegra.Telegraph on (iPhone: 11.1.2) [usb] # ls
NSFileType      Perms  NSFileProtection    Read    Write     Name
------------  -------  ------------------  ------  -------   -------------------------
Directory         493  None                True    False     NotificationContent.appex
Directory         493  None                True    False     Widget.appex
Directory         493  None                True    False     Share.appex
Directory         493  None                True    False     SiriIntents.appex
```
рдЕрдм рд╣рдо рд╡рд╣реА рдЪрд╛рд░ рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╣рдордиреЗ рдкрд╣рд▓реЗ Xcode рдореЗрдВ рджреЗрдЦреЗ рдереЗред

#### **рд╕рдорд░реНрдерд┐рдд рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдирд╛**

рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдЬрдм рдбреЗрдЯрд╛ рдХреЛ рд╣реЛрд╕реНрдЯ рдРрдкреНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╛рдЭрд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╢реЗрдпрд░ рдпрд╛ рдПрдХреНрд╢рди рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ)ред рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╣реЛрд╕реНрдЯ рдРрдк рдореЗрдВ рдХрд┐рд╕реА рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдпрд╣рд╛рдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рддреЛ рд╣реЛрд╕реНрдЯ рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкреНрд░рджрд╛рди рдХрд░реЗрдЧрд╛ред рдЗрд╕реЗ рдпрд╣рд╛рдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде `UIActivity` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбреЗрдЯрд╛ рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рд╕реЗ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ, рдЬрд╣рд╛рдВ рд╣рдореЗрдВ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдирд╛ рдерд╛, UTI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред рдЙрд╕рдХреЗ рд▓рд┐рдП рдРрдк рдХреЛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред рдХреЗрд╡рд▓ `UIActivity` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЗрдЯрд╛ рд╕рд╛рдЭрд╛ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред

рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ `Info.plist` рдлрд╝рд╛рдЗрд▓ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ `NSExtensionActivationRule` рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдВред рдпрд╣ рдХреБрдВрдЬреА рд╕рдорд░реНрдерд┐рдд рдбреЗрдЯрд╛ рдХреЛ рд╕реНрдкрд╖реНрдЯ рдХрд░рддреА рд╣реИ рд╕рд╛рде рд╣реА рдЙрдЪреНрдЪрддрдо рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рд╕рдорд░реНрдерд┐рдд рдЖрдЗрдЯрдореЛрдВ рдХреЛ рднреАред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```markup
<key>NSExtensionAttributes</key>
<dict>
<key>NSExtensionActivationRule</key>
<dict>
<key>NSExtensionActivationSupportsImageWithMaxCount</key>
<integer>10</integer>
<key>NSExtensionActivationSupportsMovieWithMaxCount</key>
<integer>1</integer>
<key>NSExtensionActivationSupportsWebURLWithMaxCount</key>
<integer>1</integer>
</dict>
</dict>
```
рдХреЗрд╡рд▓ рдпрд╣рд╛рдВ рдореМрдЬреВрдж рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рд╕рдорд░реНрдерд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ `MaxCount` рдХреЗ рд░реВрдк рдореЗрдВ `0` рдирд╣реАрдВ рд╣реЛрдЧрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рдРрд╕реЗ рдкреНрд░реЗрдбрд┐рдХреЗрдЯ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рд╕рдВрднрд╡ рд╣реИ рдЬреЛ UTI рдХреЛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдЧрд╛ред рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдХреГрдкрдпрд╛ [Apple App Extension Programming Guide](https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/ExtensionScenarios.html#//apple\_ref/doc/uid/TP40014214-CH21-SW8) рдХрд╛ рд╕рдВрджрд░реНрдн рд▓реЗрдВред

**рд╕рдВрдЧреНрд░рд╣реАрдд рдРрдк рдХреЗ рд╕рд╛рде рдбреЗрдЯрд╛ рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреА рдЬрд╛рдВрдЪ**

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдФрд░ рдЙрдирдХреЗ рд╕рдВрдЧреНрд░рд╣реАрдд рдРрдк рдХреЗ рдкрд╛рд╕ рд╕реАрдзрд╛ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдбреЗрдЯрд╛ рд╕рд╛рдЭрд╛ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдЗрд╕реЗ ["рдРрдк рд╕рдореВрд╣"](https://developer.apple.com/library/archive/documentation/Miscellaneous/Reference/EntitlementKeyReference/Chapters/EnablingAppSandbox.html#//apple\_ref/doc/uid/TP40011195-CH4-SW19) рдФрд░ [`NSUserDefaults`](https://developer.apple.com/documentation/foundation/nsuserdefaults) рдПрдкреАрдЖрдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред [Apple App Extension Programming Guide](https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/ExtensionScenarios.html#//apple\_ref/doc/uid/TP40014214-CH21-SW11) рд╕реЗ рдЗрд╕ рдЪрд┐рддреНрд░ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрдЦреЗрдВ:

![](../../mobile-apps-pentesting/ios-pentesting/broken-reference)

рдЬреИрд╕рд╛ рдХрд┐ рдЧрд╛рдЗрдб рдореЗрдВ рднреА рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдРрдк рдХреЛ рд╕рд╛рдЭрд╛ рдХрдВрдЯреЗрдирд░ рд╕реЗрдЯрдЕрдк рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдпрджрд┐ рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди `NSURLSession` рдХрдХреНрд╖рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рдЕрдкрд▓реЛрдб рдпрд╛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИ, рддрд╛рдХрд┐ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдФрд░ рдЙрд╕рдХреЗ рд╕рдВрдЧреНрд░рд╣реАрдд рдРрдк рджреЛрдиреЛрдВ рд╕рдВрдЪрд╛рд▓рд┐рдд рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХреЗрдВред

**рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЬрд╛рдВрдЪ**

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рдХрд╛рд░ рдХреЗ рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:

* [`application:shouldAllowExtensionPointIdentifier:`](https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1623122-application?language=objc)

рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдпрд╣ рдХреЗрд╡рд▓ "рдХрд╕реНрдЯрдо рдХреАрдмреЛрд░реНрдб" рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд▓рд┐рдП рд╣реА рд╕рдВрднрд╡ рд╣реИ (рдФрд░ рдЗрд╕реЗ рдЬрд╛рдВрдЪрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрдм рдРрдкреНрд╕ рдХреЛ рдЯреЗрд╕реНрдЯ рдХрд░ рд░рд╣реЗ рд╣реЛрдВ рдЬреЛ рдХреАрдмреЛрд░реНрдб рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдХрд╛ рд╣реИрдВрдбрд▓ рдХрд░рддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдмреИрдВрдХрд┐рдВрдЧ рдРрдкреНрд╕ рдЖрджрд┐)ред

### рдЧрддрд┐рд╢реАрд▓ рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рдЧрддрд┐рд╢реАрд▓ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╣рдо рд╕реНрд░реЛрдд рдХреЛрдб рдХреЗ рдмрд┐рдирд╛ рдЬреНрдЮрд╛рди рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХреЗрдВ:

* рд╕рд╛рдЭрд╛ рдХреА рдЬрд╛ рд░рд╣реА рдЖрдЗрдЯрдо рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛
* рд╕рдВрдмрдВрдзрд┐рдд рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛

**рд╕рд╛рдЭрд╛ рдХреА рдЬрд╛ рд░рд╣реА рдЖрдЗрдЯрдо рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛**

рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдбреЗрдЯрд╛ рдореВрд▓ рдРрдк рдореЗрдВ `NSExtensionContext - inputItems` рдХреЛ рд╣реБрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред

Telegram рдХреЗ рдкрд┐рдЫрд▓реЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░рддреЗ рд╣реБрдП рд╣рдо рдЕрдм рдЯреЗрдХреНрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓ рдкрд░ "рд╢реЗрдпрд░" рдмрдЯрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ (рдЬреЛ рдЪреИрдЯ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛) рдФрд░ рдЗрд╕рдХреЗ рд╕рд╛рде рдиреЛрдЯреНрд╕ рдРрдк рдореЗрдВ рдПрдХ рдиреЛрдЯ рдмрдирд╛рдПрдВрдЧреЗ:

![](<../../.gitbook/assets/image (497).png>)

рдпрджрд┐ рд╣рдо рдПрдХ рдЯреНрд░реЗрд╕ рдЪрд▓рд╛рдПрдВ, рддреЛ рд╣рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрдЙрдЯрдкреБрдЯ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛:
```bash
(0x1c06bb420) NSExtensionContext - inputItems
0x18284355c Foundation!-[NSExtension _itemProviderForPayload:extensionContext:]
0x1828447a4 Foundation!-[NSExtension _loadItemForPayload:contextIdentifier:completionHandler:]
0x182973224 Foundation!__NSXPCCONNECTION_IS_CALLING_OUT_TO_EXPORTED_OBJECT_S3__
0x182971968 Foundation!-[NSXPCConnection _decodeAndInvokeMessageWithEvent:flags:]
0x182748830 Foundation!message_handler
0x181ac27d0 libxpc.dylib!_xpc_connection_call_event_handler
0x181ac0168 libxpc.dylib!_xpc_connection_mach_event
...
RET: (
"<NSExtensionItem: 0x1c420a540> - userInfo:
{
NSExtensionItemAttachmentsKey =     (
"<NSItemProvider: 0x1c46b30e0> {types = (\n \"public.plain-text\",\n \"public.file-url\"\n)}"
);
}"
)
```
рдпрд╣рд╛рдВ рд╣рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐:

* рдпрд╣ XPC рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдВрджрд░ рд╕реЗ рд╣реБрдЖ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЗрд╕реЗ `libxpc.dylib` рдлреНрд░реЗрдорд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ `NSXPCConnection` рджреНрд╡рд╛рд░рд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
* `NSItemProvider` рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдпреВрдЯреАрдЖрдИрдЖрдИрдПрд╕ `public.plain-text` рдФрд░ `public.file-url` рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рджреВрд╕рд░рд╛ [`рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рдХреЗ "рд╢реЗрдпрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди" рдХреЗ Info.plist`](https://github.com/TelegramMessenger/Telegram-iOS/blob/master/Telegram/Share/Info.plist) рд╕реЗ `NSExtensionActivationRule` рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИред

**рд╢рд╛рдорд┐рд▓ рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдирд╛**

рдЖрдк `NSExtension - _plugIn` рдХреЛ рд╣реБрдХ рдХрд░рдХреЗ рдпрд╣ рднреА рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреМрди рд╕рд╛ рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЖрдкрдХреА рдЕрдиреБрд░реЛрдз рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдзреНрдпрд╛рди рд░рдЦ рд░рд╣рд╛ рд╣реИ:

рд╣рдо рдЙрджрд╛рд╣рд░рдг рдХреЛ рдлрд┐рд░ рд╕реЗ рдЪрд▓рд╛рддреЗ рд╣реИрдВ:
```bash
(0x1c0370200) NSExtension - _plugIn
RET: <PKPlugin: 0x1163637f0 ph.telegra.Telegraph.Share(5.3) 5B6DE177-F09B-47DA-90CD-34D73121C785
1(2) /private/var/containers/Bundle/Application/15E6A58F-1CA7-44A4-A9E0-6CA85B65FA35
/Telegram X.app/PlugIns/Share.appex>

(0x1c0372300)  -[NSExtension _plugIn]
RET: <PKPlugin: 0x10bff7910 com.apple.mobilenotes.SharingExtension(1.5) 73E4F137-5184-4459-A70A-83
F90A1414DC 1(2) /private/var/containers/Bundle/Application/5E267B56-F104-41D0-835B-F1DAB9AE076D
/MobileNotes.app/PlugIns/com.apple.mobilenotes.SharingExtension.appex>
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣рд╛рдВ рджреЛ рдРрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* `Share.appex` рдЯреЗрдХреНрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓ (`public.plain-text` рдФрд░ `public.file-url`) рднреЗрдЬ рд░рд╣рд╛ рд╣реИред
* `com.apple.mobilenotes.SharingExtension.appex` рдЬреЛ рдЯреЗрдХреНрд╕реНрдЯ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдЧрд╛ рдФрд░ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░реЗрдЧрд╛ред

рдпрджрд┐ рдЖрдк XPC рдХреЗ рддрд╣рдд рдХреНрдпрд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо "libxpc.dylib" рд╕реЗ рдЖрдВрддрд░рд┐рдХ рдХреЙрд▓реНрд╕ рдкрд░ рдирдЬрд╝рд░ рдбрд╛рд▓рдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреЗрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк [`frida-trace`](https://www.frida.re/docs/frida-trace/) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЙрддреНрдкрдиреНрди рд╕реНрдЯрдмреНрд╕ рдХреЛ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд░рдХреЗ рдЖрдкрдХреЛ рдЕрдзрд┐рдХ рд░реБрдЪрд┐рдХрд░ рд▓рдЧрдиреЗ рд╡рд╛рд▓реЗ рд╡рд┐рдзрд┐рдпреЛрдВ рдореЗрдВ рдЦреБрдж рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЧрд╣рд░рд╛рдИ рдореЗрдВ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

###

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>
