# Extens√µes de Aplicativos iOS

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas dicas de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

As extens√µes de aplicativos aprimoram a funcionalidade dos aplicativos, permitindo que eles interajam com outros aplicativos ou com o sistema, fornecendo recursos ou conte√∫do personalizado. Essas extens√µes incluem:

- **Teclado Personalizado**: Oferece um teclado exclusivo em todos os aplicativos, substituindo o teclado padr√£o do iOS.
- **Compartilhar**: Permite compartilhar em redes sociais ou com outras pessoas diretamente.
- **Hoje (Widgets)**: Fornece conte√∫do ou realiza tarefas rapidamente a partir da visualiza√ß√£o Hoje do Centro de Notifica√ß√µes.

Quando um usu√°rio interage com essas extens√µes, como compartilhar texto de um aplicativo hospedeiro, a extens√£o processa essa entrada dentro de seu contexto, aproveitando as informa√ß√µes compartilhadas para realizar sua tarefa, conforme detalhado na documenta√ß√£o da Apple.

### **Considera√ß√µes de Seguran√ßa**

Aspectos de seguran√ßa chave incluem:

- As extens√µes e seus aplicativos cont√™ineres se comunicam via comunica√ß√£o entre processos, n√£o diretamente.
- O **widget Hoje** √© √∫nico, pois pode solicitar que seu aplicativo seja aberto por um m√©todo espec√≠fico.
- O acesso a dados compartilhados √© permitido dentro de um cont√™iner privado, mas o acesso direto √© restrito.
- Certas APIs, incluindo HealthKit, s√£o proibidas para extens√µes de aplicativos, que tamb√©m n√£o podem iniciar tarefas de longa dura√ß√£o, acessar a c√¢mera ou o microfone, exceto para extens√µes do iMessage.

### An√°lise Est√°tica

#### **Identificando Extens√µes de Aplicativos**

Para encontrar extens√µes de aplicativos no c√≥digo-fonte, procure por `NSExtensionPointIdentifier` no Xcode ou inspecione o pacote do aplicativo em busca de arquivos `.appex` que indicam extens√µes. Sem o c√≥digo-fonte, use grep ou SSH para localizar esses identificadores dentro do pacote do aplicativo.

#### **Tipos de Dados Suportados**

Verifique o arquivo `Info.plist` de uma extens√£o para `NSExtensionActivationRule` para identificar os tipos de dados suportados. Essa configura√ß√£o garante que apenas os tipos de dados compat√≠veis acionem a extens√£o nos aplicativos hospedeiros.

#### **Compartilhamento de Dados**

O compartilhamento de dados entre um aplicativo e sua extens√£o requer um cont√™iner compartilhado, configurado via "Grupos de Aplicativos" e acessado por meio de `NSUserDefaults`. Este espa√ßo compartilhado √© necess√°rio para transfer√™ncias em segundo plano iniciadas por extens√µes.

#### **Restringindo Extens√µes**

Os aplicativos podem restringir certos tipos de extens√µes, especialmente teclados personalizados, garantindo que o manuseio de dados sens√≠veis esteja alinhado com os protocolos de seguran√ßa.

### An√°lise Din√¢mica

A an√°lise din√¢mica envolve:

- **Inspecionar Itens Compartilhados**: Conecte-se a `NSExtensionContext - inputItems` para ver os tipos de dados compartilhados e suas origens.
- **Identificar Extens√µes**: Descubra quais extens√µes processam seus dados observando mecanismos internos, como `NSXPCConnection`.

Ferramentas como `frida-trace` podem ajudar a entender os processos subjacentes, especialmente para aqueles interessados nos detalhes t√©cnicos da comunica√ß√£o entre processos.

## Refer√™ncias
* [https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/](https://mas.owasp.org/MASTG/iOS/0x06h-Testing-Platform-Interaction/)
* [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0072/](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0072/)

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas dicas de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
