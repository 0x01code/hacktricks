# Configuraci√≥n de Burp Suite en iOS

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Usa [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) para construir y **automatizar flujos de trabajo** f√°cilmente con las herramientas comunitarias **m√°s avanzadas**.\
Obt√©n Acceso Hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Instalaci√≥n del Certificado Burp en iOS f√≠sico

Puedes instalar [**Burp Mobile Assistant**](https://portswigger.net/burp/documentation/desktop/tools/mobile-assistant/installing) **para ayudar a instalar el Certificado Burp, configurar el proxy y realizar SSL Pinning.**\
O puedes seguir manualmente los siguientes pasos:

* Configura **Burp** como el **proxy del iPhone en \_Ajustes**_\*\* --> \*\*_**Wifi**_\*\* --> \*\*_**Haz clic en la red**_\*\* --> \*\*_**Proxy**\_
* Accede a `http://burp` y descarga el certificado
* Accede a _**Ajustes**_ --> _**General**_ --> _**VPN y Gesti√≥n de Dispositivos**_ --> Selecciona el perfil descargado e inst√°lalo (se te pedir√° tu c√≥digo)
* Accede a _**Ajustes**_ --> _**General**_ --> _**Acerca de**_ --> _**Configuraci√≥n de Confianza de Certificados**_ y habilita PortSwigger CA

### Configuraci√≥n de un Proxy de Intercepci√≥n a trav√©s de localhost

Configurar Burp para proxy de tu tr√°fico es bastante sencillo. Suponemos que tanto tu dispositivo iOS como el ordenador anfitri√≥n est√°n conectados a una red Wi-Fi que permite el tr√°fico de cliente a cliente. Si no se permite el tr√°fico de cliente a cliente, puedes usar usbmuxd para conectarte a Burp a trav√©s de USB.

PortSwigger ofrece un buen [tutorial sobre c√≥mo configurar un dispositivo iOS para trabajar con Burp](https://support.portswigger.net/customer/portal/articles/1841108-configuring-an-ios-device-to-work-with-burp) y un [tutorial sobre c√≥mo instalar el certificado CA de Burp en un dispositivo iOS](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device).

#### Usando Burp a trav√©s de USB en un Dispositivo con Jailbreak

Cuando realizamos an√°lisis din√°mico, es interesante usar la conexi√≥n SSH para enrutar nuestro tr√°fico a Burp que se est√° ejecutando en nuestro ordenador. Empecemos:

Primero necesitamos usar **iproxy** para hacer que SSH desde iOS est√© disponible en localhost.
```bash
$ iproxy 2222 22
waiting for connection
```
El siguiente paso es realizar un reenv√≠o de puerto remoto del puerto 8080 en el dispositivo iOS a la interfaz localhost en nuestra computadora al puerto 8080.
```bash
ssh -R 8080:localhost:8080 root@localhost -p 2222
```
Ahora deber√≠as poder acceder a Burp en tu dispositivo iOS. Abre Safari en iOS y ve a **127.0.0.1:8080** y deber√≠as ver la p√°gina de Burp Suite. Este tambi√©n ser√≠a un buen momento para [instalar el certificado CA](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device) de Burp en tu dispositivo iOS.

El √∫ltimo paso ser√≠a configurar el proxy globalmente en tu dispositivo iOS:

1. Ve a **Ajustes** -> **Wi-Fi**
2. Con√©ctate a _cualquier_ Wi-Fi (puedes conectarte literalmente a cualquier Wi-Fi ya que el tr√°fico para el puerto 80 y 443 se redirigir√° a trav√©s de USB, ya que estamos utilizando la configuraci√≥n de Proxy para el Wi-Fi para poder establecer un Proxy global)
3. Una vez conectado, haz clic en el peque√±o icono azul en el lado derecho del Wi-Fi conectado
4. Configura tu Proxy seleccionando **Manual**
5. Escribe 127.0.0.1 como **Servidor**
6. Escribe 8080 como **Puerto**

### Monitoreo/An√°lisis completo de la red

Si necesitas **monitorear algo diferente a las comunicaciones HTTP** puedes analizar todo el tr√°fico del dispositivo con **wireshark**.\
Puedes analizar remotamente todo el tr√°fico en tiempo real en iOS [creando una Interfaz Virtual Remota](https://stackoverflow.com/questions/9555403/capturing-mobile-phone-traffic-on-wireshark/33175819#33175819) para tu dispositivo iOS. Primero aseg√∫rate de tener **Wireshark** **instalado** en tu computadora host macOS.

1. **Conecta** tu dispositivo iOS a tu computadora host macOS mediante USB.
2. Necesitar√°s saber el **UDID de tu dispositivo iOS**, antes de poder empezar a analizar. Abre el Terminal en macOS e introduce el siguiente comando, completando con el UDID de tu dispositivo iOS.
```bash
$ rvictl -s <UDID>
Starting device <UDID> [SUCCEEDED] with interface rvi0
```
1. Inicie **Wireshark** y seleccione "**rvi0**" como la interfaz de captura.
2. Filtre el tr√°fico con Filtros de Captura en Wireshark para mostrar lo que desea monitorear (por ejemplo, todo el tr√°fico HTTP enviado/recibido a trav√©s de la direcci√≥n IP 192.168.1.1).
```
ip.addr == 192.168.1.1 && http
```
```markdown
![](<../../.gitbook/assets/image (472).png>)

La documentaci√≥n de Wireshark ofrece muchos ejemplos de [Filtros de Captura](https://wiki.wireshark.org/CaptureFilters) que deber√≠an ayudarte a filtrar el tr√°fico para obtener la informaci√≥n que deseas.

## Instalaci√≥n del Certificado Burp en el Simulador

* **Exportar Certificado Burp**

En _Proxy_ --> _Opciones_ --> _Exportar certificado CA_ --> _Certificado en formato DER_

![](<../../.gitbook/assets/image (459).png>)

* **Arrastrar y Soltar** el certificado dentro del Emulador
* **Dentro del emulador** ir a _Ajustes_ --> _General_ --> _Perfil_ --> _PortSwigger CA_, y **verificar el certificado**
* **Dentro del emulador** ir a _Ajustes_ --> _General_ --> _Acerca de_ --> _Configuraci√≥n de Confianza de Certificados_, y **habilitar PortSwigger CA**

![](<../../.gitbook/assets/image (460).png>)

**Felicidades, has configurado con √©xito el Certificado CA de Burp en el simulador de iOS**

{% hint style="info" %}
**El simulador de iOS utilizar√° las configuraciones de proxy de MacOS.**
{% endhint %}

### Configuraci√≥n del Proxy en MacOS

Pasos para configurar Burp como proxy:

* Ir a _Preferencias del Sistema_ --> _Red_ --> _Avanzado_
* En la pesta√±a _Proxies_ marcar _Proxy Web (HTTP)_ y _Proxy Web Seguro (HTTPS)_
* En ambas opciones configurar _127.0.0.1:8080_

![](<../../.gitbook/assets/image (461).png>)

* Hacer clic en _**Ok**_ y luego en _**Aplicar**_

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) para construir y **automatizar flujos de trabajo** f√°cilmente con las herramientas comunitarias **m√°s avanzadas** del mundo.\
Obt√©n Acceso Hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
```
