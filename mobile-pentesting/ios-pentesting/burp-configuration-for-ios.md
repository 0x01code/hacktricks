# Configuración de Burp Suite para iOS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* ¿Trabajas en una **empresa de ciberseguridad**? ¿Quieres ver tu **empresa anunciada en HackTricks**? ¿O quieres tener acceso a la **última versión de PEASS o descargar HackTricks en PDF**? ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtén el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* **Únete al** [**💬**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **sígueme** en **Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** con las herramientas comunitarias más avanzadas del mundo.\
Obtén acceso hoy mismo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Instalación del certificado de Burp en iOS físico

Puedes instalar [**Burp Mobile Assistant**](https://portswigger.net/burp/documentation/desktop/tools/mobile-assistant/installing) **para ayudarte a instalar el certificado de Burp, configurar el proxy y realizar SSL Pinning.**\
O puedes seguir los siguientes pasos manualmente:

* Configura **Burp** como el **proxy del iPhone en \_Configuración**_\*\* --> \*\*_**Wi-Fi**_\*\* --> \*\*_**Haz clic en la red**_\*\* --> \*\*_**Proxy**\_
* Accede a `http://burp` y descarga el certificado
* Accede a _**Ajustes**_ --> _**General**_ --> _**VPN y administración de dispositivos**_ --> Selecciona el perfil descargado e instálalo (se te pedirá tu código)
* Accede a _**Ajustes**_ --> _**General**_ --> _**Acerca de**_ --> _**Configuración de confianza de certificados**_ y habilita PortSwigger CA

### Configuración de un proxy de intercepción a través de localhost

Configurar Burp para que actúe como proxy de tu tráfico es bastante sencillo. Suponemos que tanto tu dispositivo iOS como tu ordenador están conectados a una red Wi-Fi que permite el tráfico entre clientes. Si no se permite el tráfico entre clientes, puedes utilizar usbmuxd para conectar Burp a través de USB.

PortSwigger proporciona un buen [tutorial sobre cómo configurar un dispositivo iOS para trabajar con Burp](https://support.portswigger.net/customer/portal/articles/1841108-configuring-an-ios-device-to-work-with-burp) y un [tutorial sobre cómo instalar el certificado CA de Burp en un dispositivo iOS](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device).

#### Uso de Burp a través de USB en un dispositivo con Jailbreak

Cuando se realiza un análisis dinámico, es interesante utilizar la conexión SSH para dirigir nuestro tráfico a Burp que se está ejecutando en nuestro ordenador. Empecemos:

Primero necesitamos usar **iproxy** para hacer que SSH desde iOS esté disponible en localhost.
```bash
$ iproxy 2222 22
waiting for connection
```
El siguiente paso es realizar un reenvío remoto de puerto del puerto 8080 en el dispositivo iOS a la interfaz localhost en nuestra computadora al puerto 8080.
```bash
ssh -R 8080:localhost:8080 root@localhost -p 2222
```
Ahora deberías poder acceder a Burp en tu dispositivo iOS. Abre Safari en iOS y ve a **127.0.0.1:8080** y deberías ver la página de Burp Suite. Este sería también un buen momento para [instalar el certificado CA](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device) de Burp en tu dispositivo iOS.

El último paso sería configurar el proxy globalmente en tu dispositivo iOS:

1. Ve a **Configuración** -> **Wi-Fi**
2. Conéctate a _cualquier_ red Wi-Fi (literalmente puedes conectarte a cualquier red Wi-Fi ya que el tráfico de los puertos 80 y 443 se enrutarán a través de USB, ya que solo estamos utilizando la configuración de proxy para la red Wi-Fi para poder establecer un proxy global)
3. Una vez conectado, haz clic en el pequeño icono azul en el lado derecho de la red Wi-Fi conectada
4. Configura tu proxy seleccionando **Manual**
5. Escribe 127.0.0.1 como **Servidor**
6. Escribe 8080 como **Puerto**

### Monitoreo/Captura de red completa

Si necesitas **monitorear algo diferente a las comunicaciones HTTP**, puedes capturar todo el tráfico del dispositivo con **Wireshark**.\
Puedes capturar de forma remota todo el tráfico en tiempo real en iOS mediante [la creación de una Interfaz Virtual Remota](https://stackoverflow.com/questions/9555403/capturing-mobile-phone-traffic-on-wireshark/33175819#33175819) para tu dispositivo iOS. Primero asegúrate de tener **Wireshark** **instalado** en tu computadora host macOS.

1. **Conecta** tu dispositivo iOS a tu computadora host macOS mediante USB.
2. Necesitarás conocer el **UDID de tu dispositivo iOS** antes de poder comenzar a capturar. Abre la Terminal en macOS e ingresa el siguiente comando, reemplazando el UDID de tu dispositivo iOS.
```bash
$ rvictl -s <UDID>
Starting device <UDID> [SUCCEEDED] with interface rvi0
```
1. Inicie **Wireshark** y seleccione "**rvi0**" como interfaz de captura.
2. Filtrar el tráfico con los filtros de captura en Wireshark para mostrar lo que desea monitorear (por ejemplo, todo el tráfico HTTP enviado/recibido a través de la dirección IP 192.168.1.1).
```
ip.addr == 192.168.1.1 && http
```
![](<../../.gitbook/assets/image (472).png>)

La documentación de Wireshark ofrece muchos ejemplos de [Filtros de Captura](https://wiki.wireshark.org/CaptureFilters) que deberían ayudarte a filtrar el tráfico para obtener la información que deseas.

## Instalación del Certificado de Burp en el Simulador

* **Exporta el Certificado de Burp**

En _Proxy_ --> _Options_ --> _Export CA certificate_ --> _Certificate in DER format_

![](<../../.gitbook/assets/image (459).png>)

* **Arrastra y suelta** el certificado dentro del Emulador
* **Dentro del emulador**, ve a _Settings_ --> _General_ --> _Profile_ --> _PortSwigger CA_, y **verifica el certificado**
* **Dentro del emulador**, ve a _Settings_ --> _General_ --> _About_ --> _Certificate Trust Settings_, y **habilita PortSwigger CA**

![](<../../.gitbook/assets/image (460).png>)

**Felicidades, has configurado correctamente el Certificado de Burp CA en el simulador de iOS**

{% hint style="info" %}
**El simulador de iOS utilizará las configuraciones de proxy de MacOS.**
{% endhint %}

### Configuración del Proxy en MacOS

Pasos para configurar Burp como proxy:

* Ve a _System Preferences_ --> _Network_ --> _Advanced_
* En la pestaña _Proxies_, marca _Web Proxy (HTTP)_ y _Secure Web Proxy (HTTPS)_
* En ambas opciones, configura _127.0.0.1:8080_

![](<../../.gitbook/assets/image (461).png>)

* Haz clic en _**Ok**_ y luego en _**Apply**_

<figure><img src="../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** con las herramientas comunitarias más avanzadas del mundo.\
Obtén acceso hoy mismo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* ¿Trabajas en una **empresa de ciberseguridad**? ¿Quieres que tu **empresa sea anunciada en HackTricks**? ¿O quieres tener acceso a la **última versión de PEASS o descargar HackTricks en PDF**? ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtén el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* **Únete al** [**💬**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **sígueme** en **Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
