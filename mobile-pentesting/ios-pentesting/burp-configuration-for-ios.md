# Configuration de Burp Suite pour iOS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersécurité** ? Voulez-vous voir votre **entreprise annoncée dans HackTricks** ? ou voulez-vous avoir accès à la **dernière version de PEASS ou télécharger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Découvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**💬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

![](<../.gitbook/assets/image (9) (1) (2).png>)

\
Utilisez [**Trickest**](https://trickest.io/) pour créer et **automatiser des workflows** alimentés par les outils communautaires les plus avancés au monde.\
Obtenez l'accès aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Installation du certificat Burp sur iOS physique

Vous pouvez installer [**Burp Mobile Assistant**](https://portswigger.net/burp/documentation/desktop/tools/mobile-assistant/installing) **pour vous aider à installer le certificat Burp, configurer le proxy et effectuer le SSL Pinning.**\
Ou vous pouvez suivre manuellement les étapes suivantes :

* Configurez **Burp** comme le **proxy de l'iPhone dans les paramètres** --> **Wifi** --> **Cliquez sur le réseau** --> **Proxy**
* Accédez à `http://burp` et téléchargez le certificat
* Accédez à **Paramètres** --> **Général** --> **VPN et gestion des appareils** --> Sélectionnez le profil téléchargé et installez-le (vous devrez entrer votre code)
* Accédez à **Paramètres** --> **Général** --> **À propos de** --> **Paramètres de confiance du certificat** et activez PortSwigger CA

### Configuration d'un proxy d'interception via localhost

La configuration de Burp pour intercepter votre trafic est assez simple. Nous supposons que votre appareil iOS et votre ordinateur hôte sont connectés à un réseau Wi-Fi qui permet le trafic client-à-client. Si le trafic client-à-client n'est pas autorisé, vous pouvez utiliser usbmuxd pour vous connecter à Burp via USB.

PortSwigger fournit un bon [tutoriel sur la configuration d'un appareil iOS pour travailler avec Burp](https://support.portswigger.net/customer/portal/articles/1841108-configuring-an-ios-device-to-work-with-burp) et un [tutoriel sur l'installation du certificat CA de Burp sur un appareil iOS](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device).

#### Utilisation de Burp via USB sur un appareil jailbreaké

Lors de l'analyse dynamique, il est intéressant d'utiliser la connexion SSH pour router notre trafic vers Burp qui s'exécute sur notre ordinateur. Commençons :

Tout d'abord, nous devons utiliser **iproxy** pour rendre SSH d'iOS disponible sur localhost.
```bash
$ iproxy 2222 22
waiting for connection
```
La prochaine étape consiste à effectuer une redirection de port à distance du port 8080 sur l'appareil iOS vers l'interface localhost sur notre ordinateur sur le port 8080.
```bash
ssh -R 8080:localhost:8080 root@localhost -p 2222
```
Vous devriez maintenant pouvoir accéder à Burp sur votre appareil iOS. Ouvrez Safari sur iOS et allez sur **127.0.0.1:8080** et vous devriez voir la page de Burp Suite. C'est également le moment idéal pour [installer le certificat CA](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device) de Burp sur votre appareil iOS.

La dernière étape consiste à définir le proxy globalement sur votre appareil iOS :

1. Allez dans **Paramètres** -> **Wi-Fi**
2. Connectez-vous à _n'importe quel_ Wi-Fi (vous pouvez littéralement vous connecter à n'importe quel Wi-Fi car le trafic pour les ports 80 et 443 sera routé via USB, car nous utilisons simplement le paramètre Proxy pour le Wi-Fi afin de pouvoir définir un proxy global)
3. Une fois connecté, cliquez sur le petit icône bleu sur le côté droit du Wi-Fi connecté
4. Configurez votre proxy en sélectionnant **Manuel**
5. Tapez 127.0.0.1 comme **Serveur**
6. Tapez 8080 comme **Port**

### Surveillance/Sniffing complet du réseau

Si vous devez **surveiller autre chose que les communications HTTP**, vous pouvez renifler tout le trafic de l'appareil avec **wireshark**.\
Vous pouvez renifler à distance tout le trafic en temps réel sur iOS en [créant une interface virtuelle à distance](https://stackoverflow.com/questions/9555403/capturing-mobile-phone-traffic-on-wireshark/33175819#33175819) pour votre appareil iOS. Assurez-vous d'abord que **Wireshark** est **installé** sur votre ordinateur hôte macOS.

1. **Connectez** votre appareil iOS à votre ordinateur hôte macOS via USB.
2. Vous devez connaître l'**UDID de votre appareil iOS** avant de pouvoir commencer à renifler. Ouvrez le Terminal sur macOS et entrez la commande suivante, en remplissant l'UDID de votre appareil iOS.
```bash
$ rvictl -s <UDID>
Starting device <UDID> [SUCCEEDED] with interface rvi0
```
1. Lancez **Wireshark** et sélectionnez "**rvi0**" comme interface de capture.
2. Filtrez le trafic avec les filtres de capture dans Wireshark pour afficher ce que vous souhaitez surveiller (par exemple, tout le trafic HTTP envoyé/reçu via l'adresse IP 192.168.1.1).
```
ip.addr == 192.168.1.1 && http
```
![](<../../.gitbook/assets/image (472).png>)

La documentation de Wireshark offre de nombreux exemples de [filtres de capture](https://wiki.wireshark.org/CaptureFilters) qui devraient vous aider à filtrer le trafic pour obtenir les informations que vous souhaitez.

## Installation du certificat Burp dans le simulateur

* **Exporter le certificat Burp**

Dans _Proxy_ --> _Options_ --> _Export CA certificate_ --> _Certificate in DER format_

![](<../../.gitbook/assets/image (459).png>)

* **Faites glisser et déposez** le certificat dans l'émulateur
* **Dans l'émulateur**, allez dans _Réglages_ --> _Général_ --> _Profil_ --> _PortSwigger CA_, et **vérifiez le certificat**
* **Dans l'émulateur**, allez dans _Réglages_ --> _Général_ --> _À propos_ --> _Paramètres de confiance du certificat_, et **activez PortSwigger CA**

![](<../../.gitbook/assets/image (460).png>)

**Félicitations, vous avez configuré avec succès le certificat Burp CA dans le simulateur iOS**

{% hint style="info" %}
**Le simulateur iOS utilisera les configurations de proxy de MacOS.**
{% endhint %}

### Configuration du proxy MacOS

Étapes pour configurer Burp en tant que proxy :

* Allez dans _Préférences Système_ --> _Réseau_ --> _Avancé_
* Dans l'onglet _Proxies_, cochez _Proxy Web (HTTP)_ et _Proxy Web sécurisé (HTTPS)_
* Dans les deux options, configurez _127.0.0.1:8080_

![](<../../.gitbook/assets/image (461).png>)

* Cliquez sur _**OK**_ et sur _**Appliquer**_

![](<../.gitbook/assets/image (9) (1) (2).png>)

\
Utilisez [**Trickest**](https://trickest.io/) pour créer et **automatiser des workflows** alimentés par les outils communautaires les plus avancés au monde.\
Obtenez l'accès aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersécurité** ? Voulez-vous voir votre **entreprise annoncée dans HackTricks** ? ou voulez-vous avoir accès à la **dernière version de PEASS ou télécharger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Découvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**💬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
