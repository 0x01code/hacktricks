# Configuration de Burp Suite pour iOS

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-moi** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm).
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) pour construire et **automatiser des workflows** facilement, aliment√©s par les outils communautaires **les plus avanc√©s**.\
Acc√©dez-y d√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Installation du certificat Burp sur un iOS physique

Vous pouvez installer [**Burp Mobile Assistant**](https://portswigger.net/burp/documentation/desktop/tools/mobile-assistant/installing) **pour aider √† installer le certificat Burp, configurer le proxy et effectuer le SSL Pinning.**\
Ou vous pouvez suivre manuellement les √©tapes suivantes :

* Configurez **Burp** comme le **proxy de l'iPhone dans \_Param√®tres**_\*\* --> \*\*_**Wifi**_\*\* --> \*\*_**Cliquez sur le r√©seau**_\*\* --> \*\*_**Proxy**\_
* Acc√©dez √† `http://burp` et t√©l√©chargez le certificat
* Acc√©dez √† _**Param√®tres**_ --> _**G√©n√©ral**_ --> _**VPN & Gestion de l'appareil**_ --> S√©lectionnez le profil t√©l√©charg√© et installez-le (votre code vous sera demand√©)
* Acc√©dez √† _**Param√®tres**_ --> _**G√©n√©ral**_ --> _**√Ä propos**_ --> _**R√©glages de confiance des certificats**_ et activez PortSwigger CA

### Configuration d'un proxy d'interception via localhost

Configurer Burp pour proxyfier votre trafic est assez simple. Nous supposons que votre appareil iOS et votre ordinateur h√¥te sont connect√©s √† un r√©seau Wi-Fi qui autorise le trafic client-√†-client. Si le trafic client-√†-client n'est pas autoris√©, vous pouvez utiliser usbmuxd pour vous connecter √† Burp via USB.

PortSwigger fournit un bon [tutoriel pour configurer un appareil iOS pour fonctionner avec Burp](https://support.portswigger.net/customer/portal/articles/1841108-configuring-an-ios-device-to-work-with-burp) et un [tutoriel pour installer le certificat CA de Burp sur un appareil iOS](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device).

#### Utilisation de Burp via USB sur un appareil Jailbreak√©

Lors de l'analyse dynamique, il est int√©ressant d'utiliser la connexion SSH pour router notre trafic vers Burp qui fonctionne sur notre ordinateur. Commen√ßons :

D'abord, nous devons utiliser **iproxy** pour rendre SSH depuis iOS disponible sur localhost.
```bash
$ iproxy 2222 22
waiting for connection
```
La prochaine √©tape consiste √† effectuer une redirection de port √† distance du port 8080 sur l'appareil iOS vers l'interface localhost sur notre ordinateur au port 8080.
```bash
ssh -R 8080:localhost:8080 root@localhost -p 2222
```
Vous devriez maintenant pouvoir acc√©der √† Burp sur votre appareil iOS. Ouvrez Safari sur iOS et allez sur **127.0.0.1:8080** et vous devriez voir la page de Burp Suite. Ce serait √©galement le bon moment pour [installer le certificat CA](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device) de Burp sur votre appareil iOS.

La derni√®re √©tape consisterait √† d√©finir le proxy globalement sur votre appareil iOS :

1. Allez dans **R√©glages** -> **Wi-Fi**
2. Connectez-vous √† _n'importe quel_ Wi-Fi (vous pouvez litt√©ralement vous connecter √† n'importe quel Wi-Fi car le trafic pour les ports 80 et 443 sera rout√© via USB, comme nous utilisons juste le param√®tre de proxy pour le Wi-Fi afin de pouvoir d√©finir un proxy global)
3. Une fois connect√©, cliquez sur la petite ic√¥ne bleue √† droite du Wi-Fi connect√©
4. Configurez votre Proxy en s√©lectionnant **Manuel**
5. Tapez 127.0.0.1 comme **Serveur**
6. Tapez 8080 comme **Port**

### Surveillance/Interception compl√®te du r√©seau

Si vous avez besoin de **surveiller quelque chose d'autre que les communications HTTP**, vous pouvez intercepter tout le trafic de l'appareil avec **wireshark**.\
Vous pouvez intercepter √† distance tout le trafic en temps r√©el sur iOS en [cr√©ant une Interface Virtuelle √† Distance](https://stackoverflow.com/questions/9555403/capturing-mobile-phone-traffic-on-wireshark/33175819#33175819) pour votre appareil iOS. Assurez-vous d'abord d'avoir **Wireshark** **install√©** sur votre ordinateur h√¥te macOS.

1. **Connectez** votre appareil iOS √† votre ordinateur h√¥te macOS via USB.
2. Vous aurez besoin de conna√Ætre le **UDID de votre appareil iOS**, avant de pouvoir commencer l'interception. Ouvrez le Terminal sur macOS et entrez la commande suivante, en remplissant l'UDID de votre appareil iOS.
```bash
$ rvictl -s <UDID>
Starting device <UDID> [SUCCEEDED] with interface rvi0
```
1. Lancez **Wireshark** et s√©lectionnez "**rvi0**" comme interface de capture.
2. Filtrez le trafic avec les filtres de capture dans Wireshark pour afficher ce que vous souhaitez surveiller (par exemple, tout le trafic HTTP envoy√©/re√ßu via l'adresse IP 192.168.1.1).
```
ip.addr == 192.168.1.1 && http
```
![](<../../.gitbook/assets/image (472).png>)

La documentation de Wireshark propose de nombreux exemples de [Filtres de Capture](https://wiki.wireshark.org/CaptureFilters) qui devraient vous aider √† filtrer le trafic pour obtenir les informations que vous souhaitez.

## Installation du certificat Burp dans le simulateur

* **Exporter le certificat Burp**

Dans _Proxy_ --> _Options_ --> _Exporter le certificat CA_ --> _Certificat au format DER_

![](<../../.gitbook/assets/image (459).png>)

* **Glisser-d√©poser** le certificat dans l'√©mulateur
* **Dans l'√©mulateur**, aller dans _R√©glages_ --> _G√©n√©ral_ --> _Profil_ --> _PortSwigger CA_, et **v√©rifier le certificat**
* **Dans l'√©mulateur**, aller dans _R√©glages_ --> _G√©n√©ral_ --> _√Ä propos_ --> _R√©glages de confiance des certificats_, et **activer PortSwigger CA**

![](<../../.gitbook/assets/image (460).png>)

**F√©licitations, vous avez correctement configur√© le certificat CA Burp dans le simulateur iOS**

{% hint style="info" %}
**Le simulateur iOS utilisera les configurations de proxy de MacOS.**
{% endhint %}

### Configuration du proxy MacOS

√âtapes pour configurer Burp comme proxy :

* Aller dans _Pr√©f√©rences Syst√®me_ --> _R√©seau_ --> _Avanc√©_
* Dans l'onglet _Proxies_, cocher _Proxy Web (HTTP)_ et _Proxy Web S√©curis√© (HTTPS)_
* Dans les deux options, configurer _127.0.0.1:8080_

![](<../../.gitbook/assets/image (461).png>)

* Cliquer sur _**Ok**_ puis sur _**Appliquer**_

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) pour construire et **automatiser des workflows** facilement, aliment√©s par les outils communautaires **les plus avanc√©s**.\
Obtenez l'acc√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
