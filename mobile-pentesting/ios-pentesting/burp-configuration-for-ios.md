# iOS向けのBurp Suiteの設定

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* **サイバーセキュリティ会社**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。
* [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**。**
* **ハッキングのトリックを共有するには、PRを** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **と** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **に提出してください。**

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)を使用して、世界で最も高度なコミュニティツールによって強化された**ワークフローを簡単に構築**および**自動化**します。\
今すぐアクセスを取得：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## 物理的なiOSでのBurp証明書のインストール

[**Burp Mobile Assistant**](https://portswigger.net/burp/documentation/desktop/tools/mobile-assistant/installing)をインストールして、Burp証明書のインストール、プロキシの設定、およびSSLピニングの実行をサポートします。\
または、次の手順に従って手動で行うこともできます。

* **Burp**をiPhoneの**プロキシとして設定**するには、**\_Settings**_\*\* --> \*\*_**Wifi**_\*\* --> \*\*_**ネットワークをクリック**_\*\* --> \*\*_**プロキシ**\_
* `http://burp`にアクセスして証明書をダウンロードします
* _**設定**_ --> _**一般**_ --> _**VPNとデバイス管理**_ --> ダウンロードしたプロファイルを選択してインストールします（コードが要求されます）
* _**設定**_ --> _**一般**_ --> _**情報**_ --> _**証明書信頼設定**_ でPortSwigger CAを有効にします

### localhostを介したインターセプトプロキシの設定

トラフィックをプロキシするためにBurpを設定するのは非常に簡単です。iOSデバイスとホストコンピュータがクライアント間トラフィックを許可するWi-Fiネットワークに接続されていることを前提としています。クライアント間トラフィックが許可されていない場合は、usbmuxdを使用してUSB経由でBurpに接続することができます。

PortSwiggerは、iOSデバイスをBurpと連携させるための[チュートリアル](https://support.portswigger.net/customer/portal/articles/1841108-configuring-an-ios-device-to-work-with-burp)と、iOSデバイスにBurpのCA証明書をインストールするための[チュートリアル](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device)を提供しています。

#### ルート化されたデバイスでUSB経由でBurpを使用する

動的解析を行う際には、トラフィックをコンピュータ上で実行しているBurpにルーティングするためにSSH接続を使用することが興味深いです。始めましょう：

まず、iOSからlocalhostで利用可能なSSHを作成するために**iproxy**を使用する必要があります。
```bash
$ iproxy 2222 22
waiting for connection
```
次のステップは、iOSデバイス上のポート8080のリモートポートフォワーディングを、コンピュータ上のlocalhostインターフェースのポート8080に設定することです。
```bash
ssh -R 8080:localhost:8080 root@localhost -p 2222
```
iOSデバイスでBurpにアクセスできるはずです。iOSのSafariを開き、**127.0.0.1:8080**に移動すると、Burp Suiteのページが表示されます。また、iOSデバイスにBurpのCA証明書を[インストールする](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device)のも良いタイミングです。

最後のステップは、iOSデバイスでプロキシをグローバルに設定することです。

1. **設定** -> **Wi-Fi**に移動します。
2. _どの_ Wi-Fiに接続します（実際にはどのWi-Fiに接続しても構いません。ポート80と443のトラフィックはUSB経由でルーティングされます。Wi-Fiのプロキシ設定を使用してグローバルプロキシを設定するだけなので）
3. 接続したWi-Fiの右側にある小さな青いアイコンをクリックします。
4. **手動**を選択してプロキシを設定します。
5. **サーバー**として127.0.0.1を入力します。
6. **ポート**として8080を入力します。

### ネットワークの完全な監視/スニッフィング

もしHTTP通信以外のものを**監視する必要がある**場合、**Wireshark**を使用してデバイスのトラフィックをスニッフィングすることができます。\
iOSデバイスのトラフィックをリアルタイムでリモートでスニッフィングするには、[iOSデバイスのリモート仮想インターフェースを作成する](https://stackoverflow.com/questions/9555403/capturing-mobile-phone-traffic-on-wireshark/33175819#33175819)必要があります。まず、macOSホストコンピュータに**Wireshark**が**インストール**されていることを確認してください。

1. iOSデバイスをUSB経由でmacOSホストコンピュータに**接続**します。
2. スニッフィングを開始する前に、iOSデバイスの**UDID**を知る必要があります。macOSのターミナルを開き、以下のコマンドを入力し、iOSデバイスのUDIDを入力します。
```bash
$ rvictl -s <UDID>
Starting device <UDID> [SUCCEEDED] with interface rvi0
```
1. **Wireshark**を起動し、キャプチャインターフェースとして「**rvi0**」を選択します。
2. Wiresharkのキャプチャフィルタを使用してトラフィックをフィルタリングし、監視したい内容を表示します（例えば、IPアドレス192.168.1.1を介して送受信されるすべてのHTTPトラフィック）。
```
ip.addr == 192.168.1.1 && http
```
![](<../../.gitbook/assets/image (472).png>)

[Wiresharkのドキュメント](https://wiki.wireshark.org/CaptureFilters)には、トラフィックをフィルタリングして必要な情報を取得するための多くの[キャプチャフィルタ](https://wiki.wireshark.org/CaptureFilters)の例があります。

## シミュレータへのBurp証明書のインストール

* **Burp証明書のエクスポート**

_Proxy_ --> _Options_ --> _Export CA certificate_ --> _Certificate in DER format_

![](<../../.gitbook/assets/image (459).png>)

* エミュレータ内に証明書を**ドラッグアンドドロップ**します。
* エミュレータ内で、_Settings_ --> _General_ --> _Profile_ --> _PortSwigger CA_に移動し、証明書を**確認**します。
* エミュレータ内で、_Settings_ --> _General_ --> _About_ --> _Certificate Trust Settings_に移動し、**PortSwigger CA**を有効にします。

![](<../../.gitbook/assets/image (460).png>)

**おめでとうございます。iOSシミュレータでBurp CA証明書の設定が成功しました。**

{% hint style="info" %}
**iOSシミュレータは、MacOSのプロキシ設定を使用します。**
{% endhint %}

### MacOSのプロキシ設定

Burpをプロキシとして設定する手順：

* _System Preferences_ --> _Network_ --> _Advanced_に移動します。
* _Proxies_タブで、_Web Proxy (HTTP)_と_Secure Web Proxy (HTTPS)_にチェックを入れます。
* 両方のオプションで_127.0.0.1:8080_を設定します。

![](<../../.gitbook/assets/image (461).png>)

* _**Ok**_をクリックし、_**Apply**_をクリックします。

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)を使用して、世界で最も高度なコミュニティツールによって強化された**ワークフローを簡単に構築**および**自動化**します。\
今すぐアクセスを取得：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* **サイバーセキュリティ企業で働いていますか？** **HackTricksで会社を宣伝**したいですか？または、**最新バージョンのPEASSを入手**したいですか？または、HackTricksをPDFでダウンロードしたいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)をご覧ください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。
* [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**をフォローしてください。**
* **ハッキングのトリックを共有するには、**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **と** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **にPRを提出してください。**

</details>
