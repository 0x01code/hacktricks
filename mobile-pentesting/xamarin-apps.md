# Xamarin Apps

<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

- **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
- [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手する
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションをご覧ください
- **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**または[telegramグループ](https://t.me/peass)に**参加**するか、**Twitter**で私をフォローする🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
- **ハッキングトリックを共有するには、[HackTricks](https://github.com/carlospolop/hacktricks)と[HackTricks Cloud](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出してください。**

</details>

これはブログ記事[https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)の要約です。

## **基本情報**

Xamarinは、.NETおよびC#フレームワークを使用して、iOS、Android、およびWindows向けのアプリを開発するために設計された**オープンソースプラットフォーム**です。このプラットフォームは、現代的なアプリケーションを効率的に作成するための多数のツールと拡張機能へのアクセスを提供します。

### Xamarinのアーキテクチャ

- **Android**では、Xamarinは.NETバインディングを介してAndroidとJavaの名前空間と統合し、Androidランタイム（ART）と共にMono実行環境内で動作します。Managed Callable Wrappers（MCW）とAndroid Callable Wrappers（ACW）は、MonoとARTの間の通信を容易にし、いずれもLinuxカーネル上に構築されています。
- **iOS**では、アプリケーションはMonoランタイムで実行され、C# .NETコードをARMアセンブリ言語に変換するための完全なAhead of Time（AOT）コンパイルを利用します。このプロセスは、UNIXライクなカーネル上でObjective-Cランタイムと並行して実行されます。

### .NETランタイムとMonoフレームワーク

**.NETフレームワーク**には、アプリケーション開発のためのアセンブリ、クラス、および名前空間が含まれており、.NETランタイムがコードの実行を管理しています。これはプラットフォームの独立性と後方互換性を提供します。**Monoフレームワーク**は、2005年に.NETをLinuxに拡張するために開始された.NETフレームワークのオープンソースバージョンであり、現在はMicrosoftによってサポートされ、Xamarinが主導しています。

### Xamarinアプリのリバースエンジニアリング

#### Xamarinアセンブリの逆コンパイル

逆コンパイルはコンパイルされたコードをソースコードに戻すプロセスです。Windowsでは、Visual StudioのModulesウィンドウを使用して逆コンパイルのためのモジュールを特定し、サードパーティのコードに直接アクセスしてソースコードを抽出することができます。

#### JIT vs AOTコンパイル

- **Android**はJust-In-Time（JIT）およびAhead-Of-Time（AOT）コンパイルをサポートし、最適な実行速度のためのハイブリッドAOTモードを備えています。完全なAOTはエンタープライズライセンスにのみ含まれています。
- **iOS**は、Appleの動的コード実行に関する制限のため、AOTコンパイルのみを採用しています。

### APK/IPAからdllファイルを抽出する

APK/IPA内のアセンブリにアクセスするには、ファイルを解凍してアセンブリディレクトリを調査します。Android向けには、[XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ)や[xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress)などのツールを使用してdllファイルを解凍できます。
```bash
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
Androidのアセンブリブロブについて、[pyxamstore](https://github.com/jakev/pyxamstore)を使用して展開することができます。
```bash
pyxamstore unpack -d /path/to/decompressed/apk/assemblies/
```
iOSのdllファイルは簡単にアクセスでき、アプリケーションコードの重要な部分が明らかになります。これは、しばしば異なるプラットフォーム間で共通のベースを共有しています。

### 動的解析

動的解析には、SSLピニングのチェックやXamarinアプリの.NETバイナリのランタイム修正のための[Fridax](https://github.com/NorthwaveSecurity/fridax)などのツールの使用が含まれます。Fridaスクリプトを使用して、ルート検出やSSLピニングをバイパスし、解析能力を向上させることができます。

他の興味深いFridaスクリプト：

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)


## 追加情報
* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)
* [https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/](https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/)

<details>

<summary><strong>ゼロからヒーローまでのAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスウォッグ**](https://peass.creator-spring.com)を手に入れる
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[NFTs](https://opensea.io/collection/the-peass-family)コレクションを見つける
* **💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)をフォローする。
* **HackTricks**と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks)のGitHubリポジトリにPRを提出して、あなたのハッキングトリックを共有してください。

</details>
