# Aplicativos Xamarin

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

Este √© um resumo do post do blog [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)

## **Informa√ß√µes B√°sicas**

Xamarin √© uma plataforma **open-source** projetada para desenvolvedores **constru√≠rem aplicativos para iOS, Android e Windows** usando os frameworks .NET e C#. Esta plataforma oferece acesso a numerosas ferramentas e extens√µes para criar aplicativos modernos de forma eficiente.

### Arquitetura do Xamarin

- Para **Android**, o Xamarin integra-se com os namespaces do Android e Java por meio de liga√ß√µes .NET, operando dentro do ambiente de execu√ß√£o Mono ao lado do Android Runtime (ART). Managed Callable Wrappers (MCW) e Android Callable Wrappers (ACW) facilitam a comunica√ß√£o entre Mono e ART, ambos constru√≠dos no kernel Linux.
- Para **iOS**, os aplicativos s√£o executados sob o tempo de execu√ß√£o Mono, utilizando a compila√ß√£o Ahead of Time (AOT) completa para converter o c√≥digo C# .NET em linguagem de montagem ARM. Esse processo √© executado ao lado do Objective-C Runtime em um kernel semelhante ao UNIX.

### .NET Runtime e Mono Framework

O **framework .NET** inclui assemblies, classes e namespaces para o desenvolvimento de aplicativos, com o .NET Runtime gerenciando a execu√ß√£o de c√≥digo. Ele oferece independ√™ncia de plataforma e compatibilidade com vers√µes anteriores. O **Mono Framework** √© uma vers√£o open-source do framework .NET, iniciada em 2005 para estender o .NET para o Linux, agora suportada pela Microsoft e liderada pela Xamarin.

### Engenharia Reversa de Aplicativos Xamarin

#### Decompila√ß√£o de Assemblies Xamarin

A decompila√ß√£o transforma o c√≥digo compilado de volta em c√≥digo-fonte. No Windows, a janela M√≥dulos no Visual Studio pode identificar m√≥dulos para decompila√ß√£o, permitindo acesso direto ao c√≥digo de terceiros e extra√ß√£o do c√≥digo-fonte para an√°lise.

#### Compila√ß√£o JIT vs AOT

- **Android** suporta compila√ß√£o Just-In-Time (JIT) e Ahead-Of-Time (AOT), com um modo AOT h√≠brido para velocidade de execu√ß√£o ideal. O AOT completo √© exclusivo para licen√ßas Enterprise.
- **iOS** emprega exclusivamente a compila√ß√£o AOT devido √†s restri√ß√µes da Apple sobre a execu√ß√£o de c√≥digo din√¢mico.

### Extra√ß√£o de Arquivos dll de APK/IPA

Para acessar os assemblies em um APK/IPA, descompacte o arquivo e explore o diret√≥rio de assemblies. Para Android, ferramentas como [XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ) e [xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress) podem descompactar arquivos dll.
```bash
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
Para os blobs de assembly no Android, o [pyxamstore](https://github.com/jakev/pyxamstore) pode desempacot√°-los.
```bash
pyxamstore unpack -d /path/to/decompressed/apk/assemblies/
```
Os arquivos dll do iOS s√£o facilmente acess√≠veis para descompila√ß√£o, revelando partes significativas do c√≥digo do aplicativo, que frequentemente compartilha uma base comum em diferentes plataformas.

### An√°lise Din√¢mica

A an√°lise din√¢mica envolve a verifica√ß√£o de SSL pinning e o uso de ferramentas como [Fridax](https://github.com/NorthwaveSecurity/fridax) para modifica√ß√µes em tempo de execu√ß√£o do bin√°rio .NET em aplicativos Xamarin. Scripts do Frida est√£o dispon√≠veis para contornar a detec√ß√£o de root ou SSL pinning, aprimorando as capacidades de an√°lise.

Outros scripts interessantes do Frida:

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)


## Mais informa√ß√µes
* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)
* [https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/](https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/)

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
