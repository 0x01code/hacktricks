# Applications Xamarin

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

Il s'agit d'un r√©sum√© de l'article de blog [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)

## **Informations de base**

Xamarin est une plateforme **open-source** con√ßue pour les d√©veloppeurs afin de **cr√©er des applications pour iOS, Android et Windows** en utilisant les frameworks .NET et C#. Cette plateforme offre l'acc√®s √† de nombreux outils et extensions pour cr√©er des applications modernes de mani√®re efficace.

### Architecture de Xamarin

- Pour **Android**, Xamarin s'int√®gre aux espaces de noms Android et Java via des liaisons .NET, fonctionnant dans l'environnement d'ex√©cution Mono aux c√¥t√©s de l'Android Runtime (ART). Les Managed Callable Wrappers (MCW) et Android Callable Wrappers (ACW) facilitent la communication entre Mono et ART, tous deux √©tant construits sur le noyau Linux.
- Pour **iOS**, les applications s'ex√©cutent sous le runtime Mono, utilisant une compilation Ahead of Time (AOT) compl√®te pour convertir le code C# .NET en langage d'assemblage ARM. Ce processus s'ex√©cute aux c√¥t√©s de l'Objective-C Runtime sur un noyau de type UNIX.

### .NET Runtime et Mono Framework

Le **framework .NET** comprend des assemblies, des classes et des espaces de noms pour le d√©veloppement d'applications, le Runtime .NET g√©rant l'ex√©cution du code. Il offre une ind√©pendance de plateforme et une compatibilit√© ascendante. Le **Mono Framework** est une version open-source du framework .NET, initi√©e en 2005 pour √©tendre .NET √† Linux, maintenant soutenue par Microsoft et dirig√©e par Xamarin.

### R√©tro-ing√©nierie des applications Xamarin

#### D√©compilation des assemblages Xamarin

La d√©compilation transforme le code compil√© en code source. Sous Windows, la fen√™tre Modules dans Visual Studio peut identifier les modules √† d√©compiler, permettant un acc√®s direct au code tiers et l'extraction du code source pour l'analyse.

#### Compilation JIT vs AOT

- **Android** prend en charge la compilation Just-In-Time (JIT) et Ahead-Of-Time (AOT), avec un mode hybride AOT pour une vitesse d'ex√©cution optimale. Le AOT complet est exclusif aux licences Enterprise.
- **iOS** utilise uniquement la compilation AOT en raison des restrictions d'Apple sur l'ex√©cution de code dynamique.

### Extraction de fichiers dll √† partir d'APK/IPA

Pour acc√©der aux assemblages dans un APK/IPA, d√©compressez le fichier et explorez le r√©pertoire des assemblages. Pour Android, des outils comme [XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ) et [xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress) peuvent d√©compresser les fichiers dll.
```bash
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
Pour les blobs d'assembly sur Android, [pyxamstore](https://github.com/jakev/pyxamstore) peut les d√©compresser.
```bash
pyxamstore unpack -d /path/to/decompressed/apk/assemblies/
```
Les fichiers dll iOS sont facilement accessibles pour la d√©compilation, r√©v√©lant des portions significatives du code de l'application, qui partage souvent une base commune sur diff√©rentes plateformes.

### Analyse Dynamique

L'analyse dynamique implique de v√©rifier le SSL pinning et d'utiliser des outils comme [Fridax](https://github.com/NorthwaveSecurity/fridax) pour des modifications en temps d'ex√©cution du binaire .NET dans les applications Xamarin. Des scripts Frida sont disponibles pour contourner la d√©tection de root ou le SSL pinning, am√©liorant les capacit√©s d'analyse.

Autres scripts Frida int√©ressants :

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)


## Informations Suppl√©mentaires
* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)
* [https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/](https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
