# Xamarin Apps

<details>

<summary><strong>Lernen Sie das Hacken von AWS von Null bis zum Experten mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories senden.

</details>

Dies ist eine Zusammenfassung des Blog-Beitrags [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)

## **Grundlegende Informationen**

Xamarin ist eine **Open-Source-Plattform**, die f√ºr Entwickler entwickelt wurde, um Apps f√ºr iOS, Android und Windows mit den .NET- und C#-Frameworks zu erstellen. Diese Plattform bietet Zugriff auf zahlreiche Tools und Erweiterungen, um moderne Anwendungen effizient zu erstellen.

### Xamarin-Architektur

- F√ºr **Android** integriert Xamarin Android- und Java-Namespace √ºber .NET-Bindungen und arbeitet in der Mono-Ausf√ºhrungsumgebung neben der Android Runtime (ART). Managed Callable Wrappers (MCW) und Android Callable Wrappers (ACW) erleichtern die Kommunikation zwischen Mono und ART, die beide auf dem Linux-Kernel aufbauen.
- F√ºr **iOS** werden Anwendungen unter der Mono-Laufzeit ausgef√ºhrt und nutzen die vollst√§ndige Ahead-of-Time (AOT)-Kompilierung, um C# .NET-Code in ARM-Assemblercode umzuwandeln. Dieser Prozess l√§uft neben der Objective-C-Laufzeit auf einem UNIX-√§hnlichen Kernel.

### .NET-Laufzeit und Mono-Framework

Das **.NET-Framework** umfasst Assemblys, Klassen und Namespaces f√ºr die Anwendungsentwicklung, wobei die .NET-Laufzeit die Codeausf√ºhrung verwaltet. Es bietet Plattformunabh√§ngigkeit und Abw√§rtskompatibilit√§t. Das **Mono-Framework** ist eine Open-Source-Version des .NET-Frameworks, das 2005 gestartet wurde, um .NET auf Linux zu erweitern. Es wird jetzt von Microsoft unterst√ºtzt und von Xamarin geleitet.

### Reverse Engineering von Xamarin-Apps

#### Dekompilierung von Xamarin-Assemblys

Die Dekompilierung wandelt kompilierten Code wieder in Quellcode um. In Windows kann das Fenster "Module" in Visual Studio Module zur Dekompilierung identifizieren, was einen direkten Zugriff auf Code von Drittanbietern und die Extraktion von Quellcode zur Analyse erm√∂glicht.

#### JIT vs AOT-Kompilierung

- **Android** unterst√ºtzt Just-In-Time (JIT)- und Ahead-Of-Time (AOT)-Kompilierung mit einem Hybrid-AOT-Modus f√ºr optimale Ausf√ºhrungsgeschwindigkeit. Die vollst√§ndige AOT ist exklusiv f√ºr Enterprise-Lizenzen.
- **iOS** verwendet ausschlie√ülich AOT-Kompilierung aufgrund der Einschr√§nkungen von Apple f√ºr die Ausf√ºhrung von dynamischem Code.

### Extrahieren von DLL-Dateien aus APK/IPA

Um auf die Assemblys in einer APK/IPA zuzugreifen, entpacken Sie die Datei und erkunden Sie das Verzeichnis der Assemblys. F√ºr Android k√∂nnen Tools wie [XamAsmUnZ](https://github.com/cihansol/XamAsmUnZ) und [xamarin-decompress](https://github.com/NickstaDB/xamarin-decompress) DLL-Dateien entpacken.
```bash
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
F√ºr Assembly-Blobs in Android kann [pyxamstore](https://github.com/jakev/pyxamstore) sie entpacken.
```bash
pyxamstore unpack -d /path/to/decompressed/apk/assemblies/
```
iOS-DLL-Dateien sind leicht zug√§nglich und k√∂nnen dekompiliert werden, wodurch erhebliche Teile des Anwendungscode offengelegt werden, der oft eine gemeinsame Basis f√ºr verschiedene Plattformen hat.

### Dynamische Analyse

Die dynamische Analyse umfasst die √úberpr√ºfung von SSL-Pinning und die Verwendung von Tools wie [Fridax](https://github.com/NorthwaveSecurity/fridax) f√ºr Laufzeitmodifikationen der .NET-Bin√§rdatei in Xamarin-Apps. Frida-Skripte stehen zur Verf√ºgung, um die Root-Erkennung oder das SSL-Pinning zu umgehen und die Analysef√§higkeiten zu verbessern.

Andere interessante Frida-Skripte:

* [**xamarin-antiroot**](https://codeshare.frida.re/@Gand3lf/xamarin-antiroot/)
* [**xamarin-root-detect-bypass**](https://codeshare.frida.re/@nuschpl/xamarin-root-detect-bypass/)
* [**Frida-xamarin-unpin**](https://github.com/GoSecure/frida-xamarin-unpin)


## Weitere Informationen
* [https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers](https://www.appknox.com/security/xamarin-reverse-engineering-a-guide-for-penetration-testers)
* [https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/](https://thecobraden.com/posts/unpacking\_xamarin\_assembly\_stores/)

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
