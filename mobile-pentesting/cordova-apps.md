# Aplica√ß√µes Cordova

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Informa√ß√µes retiradas do post [https://infosecwriteups.com/recreating-cordova-mobile-apps-to-bypass-security-implementations-8845ff7bdc58](https://infosecwriteups.com/recreating-cordova-mobile-apps-to-bypass-security-implementations-8845ff7bdc58)

## Informa√ß√µes B√°sicas

Apache Cordova √© um framework popular que permite **criar aplica√ß√µes h√≠bridas** (Android & iOS) usando **JavaScript, HTML e CSS**.

Um dos principais problemas com o Cordova √© que ele **n√£o possui um m√©todo padr√£o para proteger** a **fonte** da aplica√ß√£o, ao contr√°rio do react-native. A fonte da aplica√ß√£o Cordova n√£o tem um m√©todo padr√£o para compil√°-la, o que facilita a **manipula√ß√£o do c√≥digo**. A aplica√ß√£o Cordova usa WebView para renderizar a aplica√ß√£o usando HTML e JS, o que revela o c√≥digo-fonte mesmo ap√≥s compil√°-lo para APK ou IPA, enquanto o react native usa JavaScript VM para executar o c√≥digo JavaScript.

### Clonando Aplica√ß√£o Cordova <a href="#8f50" id="8f50"></a>

Para criar uma aplica√ß√£o Cordova, precisamos instalar o NodeJS. Al√©m do NodeJS, precisamos de algumas outras coisas instaladas para completar o processo de constru√ß√£o, como Android SDK, Java JDK e Gradle. Voc√™ pode seguir a [documenta√ß√£o oficial](https://cordova.apache.org/docs/en/11.x/guide/cli/#install-pre-requisites-for-building) para a lista de requisitos.

Para este exemplo, podemos assumir que o nome da aplica√ß√£o original √© `Bank.apk` e o nome do pacote `com.android.bank`

Descompacte o `bank.apk` e abra a pasta `bank/assets/www`. Podemos visualizar a **fonte completa da aplica√ß√£o Cordova**. Todo o c√≥digo HTML e JS pode ser usado para criar um clone da aplica√ß√£o. Tamb√©m podemos encontrar o arquivo de configura√ß√£o da aplica√ß√£o em `bank/res/xml/config.xml`.

Agora podemos criar um novo projeto de aplica√ß√£o Cordova:
```bash
npm install -g cordova@latest
cordova create bank-new com.android.bank Bank
cd bank-new
```
Agora precisamos copiar todos os arquivos e pastas de `bank/assets/www` para `bank-new/www.`

Ao copiar o c√≥digo-fonte, precisamos excluir alguns arquivos e pastas como `cordova_plugins.js, cordova.js, cordova-js-src/, plugins/`. Podemos copiar todos os arquivos e pastas excluindo os mencionados acima.

Quando criamos um novo projeto Cordova, precisamos mencionar se o aplicativo √© para Android ou iOS. Como estamos clonando o aplicativo Android, precisamos adicionar uma plataforma Android a ele. No Cordova, temos as vers√µes da plataforma, cada vers√£o possui diferentes recursos e suporte para APIs do Android ou vers√µes do Android.

A API do Android e as vers√µes da plataforma Cordova Android s√£o diferentes. Voc√™ pode [verificar](https://cordova.apache.org/docs/en/11.x/guide/platforms/android/) a lista de vers√µes da plataforma e seu suporte para APIs do Android.

Para adicionar a plataforma Cordova Android, precisamos descobrir qual vers√£o foi originalmente usada pelo aplicativo. Se voc√™ usar uma vers√£o diferente, pode enfrentar problemas, pois estamos usando o mesmo c√≥digo-fonte para clonar o aplicativo. Voc√™ pode abrir o arquivo `cordova.js` e procurar `PLATFORM_VERSION_BUILD_LABEL` para encontrar a vers√£o usada pelo aplicativo.

\

Agora que adicionamos suporte √† plataforma Android, podemos adicionar todos os plugins necess√°rios usados pelo aplicativo. No aplicativo original `bank/assets/www/cordova_plugins.js`, podemos encontrar uma lista de todos os plugins usados pelo aplicativo. Precisamos instalar esses plugins um por um. Procure por `module.exports.metadata` no arquivo `cordova_plugins.js`. Tamb√©m podemos ver todos os plugins com suas vers√µes.

<figure><img src="https://miro.medium.com/v2/resize:fit:1124/1*Hap3DmxS6-1apNj5RfpC3g.png" alt="Cordova Plugins" height="570" width="562"><figcaption><p>Plugins Cordova</p></figcaption></figure>

Precisamos instalar todos os plugins um por um com a ajuda do comando abaixo
```bash
cd bank-new
cordova plugin add cordova-plugin-dialogs@2.0.1
```
{% hint style="warning" %}
Se um plugin n√£o estiver dispon√≠vel na pesquisa npm, procure-o no Github:
```bash
cd bank-new
cordova plugin add https://github.com/moderna/cordova-plugin-cache.git
```
{% endhint %}

Para compilar a aplica√ß√£o, precisamos garantir que todos os requisitos j√° estejam instalados.
```bash
cd bank-new
cordova requirements
```
Uma vez que tenhamos toda a configura√ß√£o pronta, podemos construir o apk.
```bash
cd bank-new
cordova build android ‚Äî packageType=apk
```
O comando de build acima criar√° um apk com o m√©todo de debug ativado, o que nos permite depurar a aplica√ß√£o usando o Google Chrome. Antes de instalar o apk, certifique-se de assin√°-lo. Se a aplica√ß√£o tiver detec√ß√£o de adultera√ß√£o de c√≥digo, ela ser√° contornada, a menos que n√£o haja uma configura√ß√£o espec√≠fica definida.

### Ferramenta Autom√°tica

[**MobSecco**](https://github.com/Anof-cyber/MobSecco): Uma ferramenta que automatiza o processo completo de clonagem da aplica√ß√£o Android.

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
