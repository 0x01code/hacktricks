# Tapjacking

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJATELJSTVO**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**Porodicu PEASS**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## **Osnovne informacije**

**Tapjacking** je napad gde se **zlonamerna aplikacija pokreće i pozicionira iznad aplikacije žrtve**. Kada vidljivo prekrije aplikaciju žrtve, njen korisnički interfejs je dizajniran na način da prevari korisnika da interaguje sa njom, dok zapravo ta interakcija ide ka aplikaciji žrtve.\
Na taj način, **korisnik je zaslepljen i ne zna da zapravo izvršava akcije na aplikaciji žrtve**.

### Detekcija

Da biste otkrili aplikacije koje su ranjive na ovaj napad, trebalo bi da tražite **izložene aktivnosti** u android manifestu (imajte na umu da aktivnost sa intent-filterom automatski biva izložena po default-u). Kada pronađete izložene aktivnosti, **proverite da li zahtevaju neku dozvolu**. To je zato što će **zlonamerna aplikacija takođe trebati tu dozvolu**.

### Zaštita

#### Android 12 (API 31,32) i noviji

[**Prema ovom izvoru**](https://www.geeksforgeeks.org/tapjacking-in-android/)**,** napadi tapjacking-a su automatski sprečeni od strane Androida od Androida 12 (API 31 & 30) i novijih verzija. Dakle, čak i ako je aplikacija ranjiva, **nećete moći da je iskoristite**.

#### `filterTouchesWhenObscured`

Ako je **`android:filterTouchesWhenObscured`** postavljen na **`true`**, `View` neće primati dodire kada je prozor prikaza prekriven drugim vidljivim prozorom.

#### **`setFilterTouchesWhenObscured`**

Atribut **`setFilterTouchesWhenObscured`** postavljen na true takođe može sprečiti iskorišćavanje ove ranjivosti ako je Android verzija niža.\
Ako je postavljen na **`true`**, na primer, dugme može automatski biti **onemogućeno ako je prekriveno**:
```xml
<Button android:text="Button"
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:filterTouchesWhenObscured="true">
</Button>
```
## Eksploatacija

### Tapjacking-ExportedActivity

Najnoviju **Android aplikaciju** koja izvodi napad tapjacking (+ pozivanje pre izvođenja aktivnosti izložene aplikacije) možete pronaći na: [**https://github.com/carlospolop/Tapjacking-ExportedActivity**](https://github.com/carlospolop/Tapjacking-ExportedActivity).

Pratite **uputstva u README datoteci** kako biste je koristili.

### FloatingWindowApp

Primer projekta koji implementira **FloatingWindowApp**, koja se može koristiti da se postavi preko drugih aktivnosti radi izvođenja napada clickjacking, možete pronaći na [**FloatingWindowApp**](https://github.com/aminography/FloatingWindowApp) (malo zastareo, srećno sa izgradnjom apk datoteke).

### Qark

{% hint style="danger" %}
Izgleda da ovaj projekat više nije održavan i ova funkcionalnost više ne radi ispravno
{% endhint %}

Možete koristiti [**qark**](https://github.com/linkedin/qark) sa parametrima `--exploit-apk` --sdk-path `/Users/username/Library/Android/sdk` da biste kreirali zlonamernu aplikaciju za testiranje mogućih ranjivosti na **Tapjacking**.

Mitigacija je relativno jednostavna jer programer može odlučiti da ne prima događaje dodira kada je prikazan drugi prikaz preko njega. Koristeći [Android Developer’s Reference](https://developer.android.com/reference/android/view/View#security):

> Ponekad je esencijalno da aplikacija može da potvrdi da se akcija izvršava uz punu saglasnost i znanje korisnika, kao što je odobravanje zahteva za dozvolu, obavljanje kupovine ili klikanje na oglas. Nažalost, zlonamerna aplikacija može pokušati da prevari korisnika da izvrši ove akcije, nesvestan, sakrivajući namenu prikaza. Kao lek, okvir nudi mehanizam filtriranja dodira koji se može koristiti za poboljšanje sigurnosti prikaza koji omogućavaju pristup osetljivoj funkcionalnosti.
>
> Da biste omogućili filtriranje dodira, pozovite [`setFilterTouchesWhenObscured(boolean)`](https://developer.android.com/reference/android/view/View#setFilterTouchesWhenObscured%28boolean%29) ili postavite android:filterTouchesWhenObscured atribut rasporeda na true. Kada je omogućeno, okvir će odbaciti dodire koji su primljeni kada je prozor prikaza zasenjen drugim vidljivim prozorom. Kao rezultat, prikaz neće primati dodire kada se prikazuje tost, dijalog ili drugi prozor iznad prozora prikaza.

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}
