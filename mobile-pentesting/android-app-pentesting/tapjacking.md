# Tapjacking

<details>

<summary><strong>AWS hackleme becerilerini sıfırdan ileri seviyeye öğrenmek için</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>'ı öğrenin!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**'ı takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR göndererek paylaşın**.

</details>

## **Temel Bilgiler**

**Tapjacking**, bir **kötü niyetli uygulamanın** başlatıldığı ve bir kurban uygulamanın üzerine yerleştiği bir saldırıdır. Kurban uygulamayı görünür şekilde engellediğinde, kullanıcı arayüzü, kullanıcıyı yanıltacak şekilde tasarlanırken, etkileşimi kurban uygulamaya iletmektedir.\
Bu şekilde, kullanıcıya, gerçekte kurban uygulamada eylemler gerçekleştirdiğini bilmemesi sağlanır.

### Tespit

Bu saldırıya karşı savunmasız uygulamaları tespit etmek için android manifestteki **dışa aktarılan aktiviteleri** aramalısınız (bir intent-filter'a sahip bir aktivite varsayılan olarak otomatik olarak dışa aktarılır). Dışa aktarılan aktiviteleri bulduktan sonra, **herhangi bir izin gerekip gerekmediğini kontrol edin**. Çünkü **kötü niyetli uygulama da o izne ihtiyaç duyacaktır**.

### Koruma

#### Android 12 (API 31,32) ve daha yüksek

[**Bu kaynağa göre**](https://www.geeksforgeeks.org/tapjacking-in-android/)**,** Android 12 (API 31 ve 30) ve daha yüksek sürümlerinden itibaren tapjacking saldırıları otomatik olarak Android tarafından engellenir. Bu nedenle, uygulama savunmasız olsa bile **sömürülemezsiniz**.

#### `filterTouchesWhenObscured`

Eğer **`android:filterTouchesWhenObscured`** **`true`** olarak ayarlanmışsa, `View`, görünür başka bir pencere tarafından engellendiğinde dokunmaları almayacaktır.

#### **`setFilterTouchesWhenObscured`**

Eğer Android sürümü daha düşükse, **`setFilterTouchesWhenObscured`** özelliği **`true`** olarak ayarlanırsa, bu zafiyetin sömürülmesini engelleyebilir.\
Örneğin, bir düğme **görünür şekilde engellendiğinde otomatik olarak devre dışı bırakılabilir**:
```xml
<Button android:text="Button"
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:filterTouchesWhenObscured="true">
</Button>
```
## Sömürü

### Tapjacking-ExportedActivity

En **son Android uygulaması** bir Tapjacking saldırısı gerçekleştiren (+ saldırıya uğrayan uygulamanın dışa aktarılan bir etkinliğini çağırmadan önce) şurada bulunabilir: [**https://github.com/carlospolop/Tapjacking-ExportedActivity**](https://github.com/carlospolop/Tapjacking-ExportedActivity).

Kullanmak için **README talimatlarını takip edin**.

### FloatingWindowApp

Tıklama hırsızlığı saldırısı gerçekleştirmek için diğer etkinliklerin üzerine yerleştirilebilen **FloatingWindowApp**'i uygulayan bir örnek proje [**FloatingWindowApp**](https://github.com/aminography/FloatingWindowApp) adresinde bulunabilir (biraz eski, apk oluştururken iyi şanslar).

### Qark

{% hint style="danger" %}
Bu proje artık bakımsız görünüyor ve bu işlevsellik artık düzgün çalışmıyor gibi görünüyor.
{% endhint %}

Muhtemel **Tapjacking** zafiyetlerini test etmek için kötü niyetli bir uygulama oluşturmak için [**qark**](https://github.com/linkedin/qark) aracını `--exploit-apk` --sdk-path `/Users/username/Library/Android/sdk` parametreleriyle kullanabilirsiniz.

Bu saldırıyı önlemek oldukça basittir çünkü geliştirici, bir görünüm başka bir görünüm tarafından kaplandığında dokunma olaylarını almayı seçmeyebilir. [Android Geliştirici Referansı](https://developer.android.com/reference/android/view/View#security) kullanılarak şu şekilde açıklanmıştır:

> Bir izin isteği vermek, bir satın alma yapmak veya bir reklama tıklamak gibi bir eylemin kullanıcının tam bilgisi ve onayıyla gerçekleştirildiğini doğrulamanın bazen önemli olduğu durumlar vardır. Ne yazık ki, kötü niyetli bir uygulama, kullanıcının bu eylemleri farkında olmadan gerçekleştirmesini sağlamak için görünümün amaçlanan amacını gizleyebilir. Bir çözüm olarak, çerçeve, hassas işlevselliğe erişim sağlayan görünümlerin güvenliğini artırmak için kullanılabilecek bir dokunma filtreleme mekanizması sunar.
>
> Dokunma filtrelemeyi etkinleştirmek için [`setFilterTouchesWhenObscured(boolean)`](https://developer.android.com/reference/android/view/View#setFilterTouchesWhenObscured%28boolean%29) yöntemini çağırın veya android:filterTouchesWhenObscured düzen özniteliğini true olarak ayarlayın. Etkinleştirildiğinde, çerçeve, görünümün penceresinin başka bir görünür pencere tarafından kaplandığı her zaman alınan dokunmaları atar. Sonuç olarak, bir tost, iletişim kutusu veya diğer bir pencere görünümün penceresinin üzerinde göründüğünde görünüm dokunmaları almayacaktır.

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahraman olmaya</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> öğrenin!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklam vermek veya HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)** takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına **PR göndererek paylaşın**.

</details>
