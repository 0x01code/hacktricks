# рдмрд░реНрдк рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж рдЯреНрд╡рд┐рдЯрд░ ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П рдЯреНрд╡рд┐рдЪ ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе рдпреВрдЯреНрдпреВрдм ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

## рдПрдХ рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рдкрд░

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ рдмрд░реНрдк рд╕реЗ Der рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдЖрдк рдЗрд╕реЗ _**рдкреНрд░реЙрдХреНрд╕реА**_ --> _**рд╡рд┐рдХрд▓реНрдк**_ --> _**рдЖрдпрд╛рдд / рдирд┐рд░реНрдпрд╛рдд рд╕реАрдП рдкреНрд░рдорд╛рдгрдкрддреНрд░**_ рдореЗрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ

![](<../../.gitbook/assets/image (367).png>)

**Der рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдВ** рдФрд░ рдЗрд╕реЗ рдПрдХ рдРрд╕реЗ рд░реВрдк рдореЗрдВ **рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░реЗрдВ** рдЬрд┐рд╕реЗ **Android** рд╕рдордЭ рд╕рдХреЗред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдПрд╡реАрдбреА рдорд╢реАрди рдореЗрдВ рдмрд░реНрдк рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдЖрдкрдХреЛ рдЗрд╕ рдорд╢реАрди рдХреЛ **`-writable-system`** рд╡рд┐рдХрд▓реНрдк рдХреЗ рд╕рд╛рде **рдЪрд▓рд╛рдирд╛** рд╣реЛрдЧрд╛ред\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк рдЗрд╕реЗ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
C:\Users\<UserName>\AppData\Local\Android\Sdk\tools\emulator.exe -avd "AVD9" -http-proxy 192.168.1.12:8080 -writable-system
```
{% endcode %}

рдлрд┐рд░, **рдмрд░реНрдк рдХрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕рдорд╛рдХреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдирд┐рдореНрди рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ:

{% code overflow="wrap" %}
```bash
openssl x509 -inform DER -in burp_cacert.der -out burp_cacert.pem
CERTHASHNAME="`openssl x509 -inform PEM -subject_hash_old -in burp_cacert.pem | head -1`.0"
mv burp_cacert.pem $CERTHASHNAME #Correct name
adb root && sleep 2 && adb remount #Allow to write on /syste
adb push $CERTHASHNAME /sdcard/ #Upload certificate
adb shell mv /sdcard/$CERTHASHNAME /system/etc/security/cacerts/ #Move to correct location
adb shell chmod 644 /system/etc/security/cacerts/$CERTHASHNAME #Assign privileges
adb reboot #Now, reboot the machine
```
{% endcode %}

рдЬрдм **рдорд╢реАрди рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд░рд┐рдмреВрдЯ рд╣реЛ рдЬрд╛рдП**, рддреЛ рдмрд░реНрдк рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдЙрд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдореЗрдВ рд╣реЛрдЧрд╛!

## рдореИрдЬрд┐рд╕реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ

рдпрджрд┐ рдЖрдкрдиреЗ рдЕрдкрдиреА рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдореИрдЬрд┐рд╕реНрдХ рдХреЗ рд╕рд╛рде **рд░реВрдЯ рдХрд┐рдпрд╛ рд╣реИ** (рд╢рд╛рдпрдж рдПрдХ рдПрдореНрдпреБрд▓реЗрдЯрд░), рдФрд░ рдЖрдк рдкрд┐рдЫрд▓реЗ **рд╕реНрдЯреЗрдкреНрд╕** рдХрд╛ рдкрд╛рд▓рди рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдмрд░реНрдк рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдХреЛ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░ рд╕рдХреЗрдВ рдХреНрдпреЛрдВрдХрд┐ **рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рд░реАрдб-рдУрдирд▓реА** рд╣реИ рдФрд░ рдЖрдк рдЗрд╕реЗ рд░рд╛рдЗрдЯреЗрдмрд▓ рд░реАрдорд╛рдЙрдВрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ, рддреЛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИред

[**рдЗрд╕ рд╡реАрдбрд┐рдпреЛ**](https://www.youtube.com/watch?v=qQicUW0svB8) рдореЗрдВ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реЛрдЧрд╛:

1. **CA рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ**: рдмрд╕ рдбрд┐рд╡рд╛рдЗрд╕ рдореЗрдВ рдбреЗрд░ рдмрд░реНрдк рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдХреЛ `.crt` рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдореЗрдВ рдмрджрд▓рдХрд░ рдбреНрд░реИрдЧ рдПрдВрдб рдбреНрд░реЙрдк рдХрд░реЗрдВ рддрд╛рдХрд┐ рдпрд╣ рдбрд╛рдЙрдирд▓реЛрдб рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛ рдФрд░ `рдЗрдВрд╕реНрдЯреЙрд▓ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ` -> `CA рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ` рдкрд░ рдЬрд╛рдПрдВ

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" width="164"><figcaption></figcaption></figure>

* рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░реЗрдВ рдХрд┐ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реБрдЖ рд╣реИ рдФрд░ `рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдкреНрд░рдорд╛рдгрдкрддреНрд░` -> `рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛` рдкрд░ рдЬрд╛рдПрдВ

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" width="334"><figcaption></figcaption></figure>

2. **рдЗрд╕реЗ рд╕рд┐рд╕реНрдЯрдо рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдмрдирд╛рдПрдВ**: рдореИрдЬрд┐рд╕реНрдХ рдореЙрдбреНрдпреВрд▓ [MagiskTrustUserCerts](https://github.com/NVISOsecurity/MagiskTrustUserCerts) (рдПрдХ .zip рдлрд╝рд╛рдЗрд▓) рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ, рдЗрд╕реЗ рдлрд╝реЛрди рдореЗрдВ рдбреНрд░реИрдЧ рдПрдВрдб рдбреНрд░реЙрдк рдХрд░реЗрдВ, рдлрд╝реЛрди рдореЗрдВ **рдореИрдЬрд┐рдХреНрд╕ рдРрдк** рдореЗрдВ рдЬрд╛рдПрдВ, **`рдореЙрдбреНрдпреВрд▓`** рдЦрдВрдб рдореЗрдВ рдЬрд╛рдПрдВ, **`рд╕реНрдЯреЛрд░реЗрдЬ рд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, `.zip` рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ рдПрдХ рдмрд╛рд░ рдЗрдВрд╕реНрдЯреЙрд▓ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдлрд╝реЛрди рдХреЛ **рд░рд┐рдмреВрдЯ** рдХрд░реЗрдВ:

<figure><img src="../../.gitbook/assets/image (2) (1) (1) (1) (1) (1) (1).png" alt="" width="345"><figcaption></figcaption></figure>

* рд░рд┐рдмреВрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, `рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдкреНрд░рдорд╛рдгрдкрддреНрд░` -> `рд╕рд┐рд╕реНрдЯрдо` рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдкреЛрд╕реНрдЯреНрд╕реНрд╡рд┐рдЧрд░ рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рд╡рд╣рд╛рдВ рд╣реИ

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt="" width="314"><figcaption></figcaption></figure>

## рдПрдВрдбреНрд░реЙрдЗрдб 14 рдХреЗ рдмрд╛рдж

рдкрд░рд┐рд╡рд░реНрддрди:

* рдЕрдм рддрдХ, рд╕рд┐рд╕реНрдЯрдо рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп CA рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ **`/system/etc/security/cacerts/`** рдореЗрдВ рд░рд╣рддреЗ рдереЗред рдПрдХ рдорд╛рдирдХ AOSP рдПрдореНрдпреБрд▓реЗрдЯрд░ рдкрд░, рдЙрдиреНрд╣реЗрдВ **рд░реВрдЯ рдПрдХреНрд╕реЗрд╕ рдХреЗ рд╕рд╛рде рд╕реАрдзреЗ рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рдерд╛, рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде, рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕рд╛рде рддрддреНрдкрд░рддрд╛ рдХреЗ рд╕
```bash
# Create a separate temp directory, to hold the current certificates
# Otherwise, when we add the mount we can't read the current certs anymore.
mkdir -p -m 700 /data/local/tmp/tmp-ca-copy

# Copy out the existing certificates
cp /apex/com.android.conscrypt/cacerts/* /data/local/tmp/tmp-ca-copy/

# Create the in-memory mount on top of the system certs folder
mount -t tmpfs tmpfs /system/etc/security/cacerts

# Copy the existing certs back into the tmpfs, so we keep trusting them
mv /data/local/tmp/tmp-ca-copy/* /system/etc/security/cacerts/

# Copy our new cert in, so we trust that too
mv $CERTIFICATE_PATH /system/etc/security/cacerts/

# Update the perms & selinux context labels
chown root:root /system/etc/security/cacerts/*
chmod 644 /system/etc/security/cacerts/*
chcon u:object_r:system_file:s0 /system/etc/security/cacerts/*

# Deal with the APEX overrides, which need injecting into each namespace:

# First we get the Zygote process(es), which launch each app
ZYGOTE_PID=$(pidof zygote || true)
ZYGOTE64_PID=$(pidof zygote64 || true)
# N.b. some devices appear to have both!

# Apps inherit the Zygote's mounts at startup, so we inject here to ensure
# all newly started apps will see these certs straight away:
for Z_PID in "$ZYGOTE_PID" "$ZYGOTE64_PID"; do
if [ -n "$Z_PID" ]; then
nsenter --mount=/proc/$Z_PID/ns/mnt -- \
/bin/mount --bind /system/etc/security/cacerts /apex/com.android.conscrypt/cacerts
fi
done

# Then we inject the mount into all already running apps, so they
# too see these CA certs immediately:

# Get the PID of every process whose parent is one of the Zygotes:
APP_PIDS=$(
echo "$ZYGOTE_PID $ZYGOTE64_PID" | \
xargs -n1 ps -o 'PID' -P | \
grep -v PID
)

# Inject into the mount namespace of each of those apps:
for PID in $APP_PIDS; do
nsenter --mount=/proc/$PID/ns/mnt -- \
/bin/mount --bind /system/etc/security/cacerts /apex/com.android.conscrypt/cacerts &
done
wait # Launched in parallel - wait for completion here

echo "System certificate injected"
```
### NSEnter рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдмрд╛рдЗрдВрдб-рдорд╛рдЙрдВрдЯрд┐рдВрдЧ

*   рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рдХрд╣реАрдВ рдПрдХ рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗрдЯ рдЕрдк рдХрд░рдиреА рд╣реЛрдЧреАред рдореМрдЬреВрджрд╛ рддрд░реАрдХреЗ рдХреЗ рд╕рд╛рде рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╕рдВрдЧрддрддрд╛ рдХреЗ рд▓рд┐рдП, рдореИрдВ рдЕрднреА рднреА рдореМрдЬреВрдж рдЧреИрд░-APEX рд╕рд┐рд╕реНрдЯрдо рд╕рд░реНрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдкрд░ рдПрдХ `tmpfs` рдорд╛рдЙрдВрдЯ рдХреЗ рд╕рд╛рде рдпрд╣ рдХрд░ рд░рд╣рд╛ рд╣реВрдВ:

```bash
mount -t tmpfs tmpfs /system/etc/security/cacerts
```
* рдлрд┐рд░ рдЖрдк рдЗрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдЕрдкрдиреЗ рдЗрдЪреНрдЫрд┐рдд рд╕реАрдП рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рд░рдЦреЗрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк рд╢рд╛рдпрдж рдореМрдЬреВрджрд╛ `/apex/com.android.conscrypt/cacerts/` рд╕реАрдП рд╕рд░реНрдЯрд┐рдлрд┐рдХреЗрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕реЗ рд╕рднреА рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреЙрдкреА рдХрд░рдирд╛ рдЪрд╛рд╣реЗрдВрдЧреЗ) рдФрд░ рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдФрд░ SELinux рд▓реЗрдмрд▓ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕реЗрдЯ рдХрд░реЗрдВред
*   рдлрд┐рд░, `nsenter` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Zygote рдХреЗ рдорд╛рдЙрдВрдЯ рдиреЗрдорд╕реНрдкреЗрд╕ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░реЗрдВ, рдФрд░ рдЗрд╕ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ APEX рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдкрд░ рдмрд╛рдЗрдВрдб рдорд╛рдЙрдВрдЯ рдХрд░реЗрдВ:

```bash
nsenter --mount=/proc/$ZYGOTE_PID/ns/mnt -- \
/bin/mount --bind /system/etc/security/cacerts /apex/com.android.conscrypt/cacerts
```

Zygote рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреНрд░рддреНрдпреЗрдХ рдРрдк рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рддреА рд╣реИ, рдЙрд╕реЗ рдХреЙрдкреА рдХрд░рдХреЗ рдЕрдкрдиреЗ рдорд╛рдЙрдВрдЯ рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕рд▓рд┐рдП рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рднреА рдирд╡реАрдирддрдо рд▓реЙрдиреНрдЪ рдХрд┐рдП рдЧрдП рдРрдкреНрд╕ (рдЕрдм рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реА рд╕рднреА рдЪреАрдЬреЗрдВ) рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреАред
*   рдлрд┐рд░, рдкрд╣рд▓реЗ рд╕реЗ рдЪрд▓ рд░рд╣реЗ рд╣рд░ рдРрдк рдХреЗ рдиреЗрдорд╕реНрдкреЗрд╕ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `nsenter` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдФрд░ рд╡рд╣реА рдХрд░реЗрдВ:

```bash
nsenter --mount=/proc/$APP_PID/ns/mnt -- \
/bin/mount --bind /system/etc/security/cacerts /apex/com.android.conscrypt/cacerts
```

рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рдпрджрд┐ рдЖрдкрдХреЛ рдЕрд╕рд╛рдорд╛рдиреНрдп UX рд╕реЗ рдХреЛрдИ рджрд┐рдХреНрдХрдд рдирд╣реАрдВ рд╣реИ, рддреЛ рдЖрдк `init` (PID 1) рдкрд░ рдмрд╛рдЗрдВрдб рдорд╛рдЙрдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ `stop && start` рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдкрдХреЗ рдмрджрд▓рд╛рд╡ рд╕рднреА рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЛ рдлрд┐рд░ рд╕реЗ рдмрдирд╛рдПрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдкреНрд░рд╕рд╛рд░рд┐рдд рдХрд░реЗрдВ (рд▓реЗрдХрд┐рди рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рдореБрдЭреЗ рдЕрд╕рд╛рдорд╛рдиреНрдп рд░рд┐рдмреВрдЯ рдХреА рдкрд░реЗрд╢рд╛рдиреА рд╣реЛрддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдореИрдВ рдЙрд╕ рдорд╛рд░реНрдЧ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдирдЬрд░рдЕрдВрджрд╛рдЬ рдХрд░ рд░рд╣рд╛ рд╣реВрдВ)ред

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks** рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХрд▓ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛред**

</details>
