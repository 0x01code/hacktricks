{% hint style="success" %}
Lernen & √ºben Sie AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lernen & √ºben Sie GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Unterst√ºtzen Sie HackTricks</summary>

* √úberpr√ºfen Sie die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Hacking-Tricks, indem Sie PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichen.

</details>
{% endhint %}

## Manuelle **Deobfuskationstechniken**

Im Bereich der **Software-Sicherheit** ist der Prozess, obfuskierten Code verst√§ndlich zu machen, bekannt als **Deobfuskation**, entscheidend. Dieser Leitfaden behandelt verschiedene Strategien zur Deobfuskation, wobei der Schwerpunkt auf statischen Analysetechniken und der Erkennung von Obfuskationsmustern liegt. Dar√ºber hinaus wird eine √úbung zur praktischen Anwendung vorgestellt und weitere Ressourcen f√ºr Interessierte an fortgeschritteneren Themen vorgeschlagen.

### **Strategien f√ºr statische Deobfuskation**

Beim Umgang mit **obfuskiertem Code** k√∂nnen je nach Art der Obfuskation mehrere Strategien angewendet werden:

- **DEX-Bytecode (Java)**: Ein effektiver Ansatz besteht darin, die Deobfuskationsmethoden der Anwendung zu identifizieren und diese Methoden dann in einer Java-Datei zu replizieren. Diese Datei wird ausgef√ºhrt, um die Obfuskation der Ziel-Elemente r√ºckg√§ngig zu machen.
- **Java und nativer Code**: Eine weitere Methode besteht darin, den Deobfuskationsalgorithmus in eine Skriptsprache wie Python zu √ºbersetzen. Diese Strategie hebt hervor, dass das Hauptziel nicht darin besteht, den Algorithmus vollst√§ndig zu verstehen, sondern ihn effektiv auszuf√ºhren.

### **Erkennung von Obfuskation**

Die Erkennung von obfuskiertem Code ist der erste Schritt im Deobfuskationsprozess. Wichtige Indikatoren sind:

- Das **Fehlen oder die Verwirrung von Strings** in Java und Android, was auf String-Obfuskation hindeuten kann.
- Die **Pr√§senz von Bin√§rdateien** im Assets-Verzeichnis oder Aufrufe an `DexClassLoader`, die auf das Entpacken von Code und dynamisches Laden hinweisen.
- Die Verwendung von **nativen Bibliotheken zusammen mit nicht identifizierbaren JNI-Funktionen**, was auf eine potenzielle Obfuskation von nativen Methoden hinweist.

## **Dynamische Analyse in der Deobfuskation**

Durch die Ausf√ºhrung des Codes in einer kontrollierten Umgebung erm√∂glicht die dynamische Analyse **die Beobachtung, wie sich der obfuskierten Code in Echtzeit verh√§lt**. Diese Methode ist besonders effektiv, um die inneren Abl√§ufe komplexer Obfuskationsmuster aufzudecken, die darauf ausgelegt sind, die wahre Absicht des Codes zu verbergen.

### **Anwendungen der dynamischen Analyse**

- **Laufzeit-Dekodierung**: Viele Obfuskationstechniken beinhalten die Verschl√ºsselung von Strings oder Code-Segmenten, die nur zur Laufzeit entschl√ºsselt werden. Durch dynamische Analyse k√∂nnen diese verschl√ºsselten Elemente zum Zeitpunkt der Entschl√ºsselung erfasst werden, wodurch ihre wahre Form sichtbar wird.
- **Identifizierung von Obfuskationstechniken**: Durch die √úberwachung des Verhaltens der Anwendung kann die dynamische Analyse helfen, spezifische Obfuskationstechniken zu identifizieren, die verwendet werden, wie z.B. Code-Virtualisierung, Packager oder dynamische Code-Generierung.
- **Aufdeckung versteckter Funktionalit√§ten**: Obfuskierter Code kann versteckte Funktionalit√§ten enthalten, die durch statische Analyse allein nicht offensichtlich sind. Die dynamische Analyse erm√∂glicht die Beobachtung aller Code-Pfade, einschlie√ülich der bedingt ausgef√ºhrten, um solche versteckten Funktionalit√§ten aufzudecken.

## Referenzen und weiterf√ºhrende Literatur
* [https://maddiestone.github.io/AndroidAppRE/obfuscation.html](https://maddiestone.github.io/AndroidAppRE/obfuscation.html)
* BlackHat USA 2018: ‚ÄúUnpacking the Packed Unpacker: Reverse Engineering an Android Anti-Analysis Library‚Äù \[[Video](https://www.youtube.com/watch?v=s0Tqi7fuOSU)]
* Dieser Vortrag behandelt das Reverse Engineering einer der komplexesten Anti-Analyse-nativen Bibliotheken, die ich in einer Android-Anwendung gesehen habe. Es behandelt haupts√§chlich Obfuskationstechniken im nativen Code.
* REcon 2019: ‚ÄúThe Path to the Payload: Android Edition‚Äù \[[Video](https://recon.cx/media-archive/2019/Session.005.Maddie_Stone.The_path_to_the_payload_Android_Edition-J3ZnNl2GYjEfa.mp4)]
* Dieser Vortrag diskutiert eine Reihe von Obfuskationstechniken, die ausschlie√ülich im Java-Code verwendet wurden, um das Verhalten eines Android-Botnets zu verbergen.
