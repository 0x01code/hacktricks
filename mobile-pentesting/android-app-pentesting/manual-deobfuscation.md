<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## C√≥mo Des-Ofuscar

Las estrategias de des-ofuscaci√≥n dependen del m√©todo de ofuscaci√≥n. Esta secci√≥n introduce t√©cnicas de des-ofuscaci√≥n est√°tica, adecuadas para an√°lisis est√°tico o reversing:

* Para bytecode DEX (Java), un enfoque com√∫n es identificar y replicar los m√©todos de des-ofuscaci√≥n de la aplicaci√≥n en un archivo Java, que luego se ejecuta contra los elementos ofuscados.
* Tanto para Java como para C√≥digo Nativo, otra t√©cnica implica traducir el algoritmo de des-ofuscaci√≥n a un lenguaje de scripting familiar como Python, enfatizando que comprender el algoritmo no es tan crucial como poder ejecutarlo.

## Indicadores de Ofuscaci√≥n

Reconocer la ofuscaci√≥n implica identificar ciertos indicadores, con los siguientes ejemplos proporcionados:

* Ausencia de cadenas o presencia de cadenas revueltas en Java y Android, lo que indica ofuscaci√≥n de cadenas.
* Existencia de archivos binarios en el directorio de assets o llamadas a DexClassLoader, indicando posible desempaquetado y carga de c√≥digo.
* Uso de bibliotecas Nativas sin funciones JNI identificables, sugiriendo ofuscaci√≥n de m√©todos nativos.

### Ejercicio de Des-Ofuscaci√≥n de Cadenas

Se proporciona un ejercicio para practicar la des-ofuscaci√≥n de cadenas dentro de un contexto de an√°lisis est√°tico. La tarea implica un archivo de muestra con un digest SHA256 espec√≠fico, requiriendo que el analista descubra una cadena Javascript ofuscada sin ejecutar la aplicaci√≥n de manera din√°mica.

La soluci√≥n implica un script de Python que descifra la cadena codificada, revelando un script incrustado que proviene de coinhive.com e inicia un minero.

### Recursos Adicionales

Se pueden explorar m√°s detalles sobre la des-ofuscaci√≥n de aplicaciones Android, especialmente enfoc√°ndose en t√©cnicas de ofuscaci√≥n avanzadas, en las charlas de BlackHat USA 2018 y REcon 2019, cada una cubriendo aspectos √∫nicos de la ofuscaci√≥n en aplicaciones Android.

Ejercicio de https://maddiestone.github.io/AndroidAppRE/obfuscation.html:
```python
enc_str = "773032205849207A3831326F1351202E3B306B7D1E5A3B33252B382454173735266C3D3B53163735222D393B475C7A37222D7F38421B6A66643032205849206477303220584920643D2223725C503A3F39636C725F5C237A082C383C7950223F65023F3D5F4039353E3079755F5F666E1134141F5C4C64377A1B671F565A1B2C7F7B101F42700D1F39331717161574213F2B2337505D27606B712C7B0A543D342E317F214558262E636A6A6E1E4A37282233256C"

length = len(enc_str)
count = 0
dec_str = [0] * (length/2)
while (count < length):
dec_str[count/2] = (int(enc_str[count], 16) << 4) + int(enc_str[count + 1], 16) & 0xFF
count += 2
print dec_str


key = [75, 67, 81, 82, 49, 57, 84, 90]
enc_str = dec_str
count = 0
length = len(enc_str)
while (count < length):
dec_str[count] = chr(enc_str[count] ^ key[count % len(key)])
count += 1
print ''.join(dec_str)
```
# Referencias y Lecturas Adicionales
* [https://maddiestone.github.io/AndroidAppRE/obfuscation.html](https://maddiestone.github.io/AndroidAppRE/obfuscation.html)
* BlackHat USA 2018: ‚ÄúDesempaquetando el Empaquetador Desempaquetado: Ingenier√≠a Inversa de una Biblioteca Anti-An√°lisis de Android‚Äù \[[video](https://www.youtube.com/watch?v=s0Tqi7fuOSU)]
* Esta charla trata sobre la ingenier√≠a inversa de una de las bibliotecas nativas anti-an√°lisis m√°s complejas que he visto utilizadas por una aplicaci√≥n de Android. Cubre principalmente t√©cnicas de ofuscaci√≥n en c√≥digo nativo.
* REcon 2019: ‚ÄúEl Camino hacia el Payload: Edici√≥n Android‚Äù \[[video](https://recon.cx/media-archive/2019/Session.005.Maddie_Stone.The_path_to_the_payload_Android_Edition-J3ZnNl2GYjEfa.mp4)]
* Esta charla discute una serie de t√©cnicas de ofuscaci√≥n, √∫nicamente en c√≥digo Java, que un botnet de Android estaba utilizando para ocultar su comportamiento.


<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
