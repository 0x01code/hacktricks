<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>

## Manuelle **De-Obfuscationstechniken**

Im Bereich der **Software-Sicherheit** ist der Prozess des Verst√§ndlichmachens von verschleiertem Code, bekannt als **De-Obfuscation**, entscheidend. Dieser Leitfaden geht auf verschiedene Strategien zur De-Obfuscation ein, wobei der Schwerpunkt auf statischen Analysetechniken und der Erkennung von Obfuscation-Mustern liegt. Dar√ºber hinaus stellt er eine √úbung zur praktischen Anwendung vor und schl√§gt weitere Ressourcen f√ºr diejenigen vor, die sich f√ºr fortgeschrittenere Themen interessieren.

### Strategien f√ºr die statische De-Obfuscation

Bei der Bearbeitung von **verschleiertem Code** k√∂nnen je nach Art der Verschleierung verschiedene Strategien angewendet werden:

- **DEX-Bytecode (Java)**: Ein effektiver Ansatz besteht darin, die De-Obfuscation-Methoden der Anwendung zu identifizieren und diese Methoden in einer Java-Datei zu replizieren. Diese Datei wird ausgef√ºhrt, um die Verschleierungseffekte auf den Zielobjekten umzukehren.
- **Java und nativer Code**: Eine andere Methode besteht darin, den De-Obfuscation-Algorithmus in eine Skriptsprache wie Python zu √ºbersetzen. Diese Strategie verdeutlicht, dass das Hauptziel nicht darin besteht, den Algorithmus vollst√§ndig zu verstehen, sondern ihn effektiv auszuf√ºhren.

### Erkennung von Obfuscation

Die Erkennung von verschleiertem Code ist der erste Schritt im De-Obfuscation-Prozess. Zu den wichtigsten Indikatoren geh√∂ren:

- Das **Fehlen oder Verschleiern von Zeichenketten** in Java und Android, was auf eine Zeichenketten-Verschleierung hinweisen kann.
- Das **Vorhandensein von Bin√§rdateien** im Assets-Verzeichnis oder Aufrufe von `DexClassLoader`, die auf Code-Entpackung und dynamisches Laden hinweisen.
- Die Verwendung von **nativen Bibliotheken zusammen mit nicht identifizierbaren JNI-Funktionen**, was auf eine m√∂gliche Verschleierung nativer Methoden hinweist.

## Dynamische Analyse in der De-Obfuscation

Durch die Ausf√ºhrung des Codes in einer kontrollierten Umgebung erm√∂glicht die dynamische Analyse die Beobachtung des Verhaltens des verschleierten Codes in Echtzeit. Diese Methode ist besonders effektiv, um die Funktionsweise komplexer Verschleierungsmuster aufzudecken, die darauf abzielen, die eigentliche Absicht des Codes zu verbergen.

### Anwendungen der dynamischen Analyse

- **Laufzeitentschl√ºsselung**: Viele Verschleierungstechniken beinhalten die Verschl√ºsselung von Zeichenketten oder Code-Segmenten, die erst zur Laufzeit entschl√ºsselt werden. Durch die dynamische Analyse k√∂nnen diese verschl√ºsselten Elemente zum Zeitpunkt der Entschl√ºsselung erfasst werden, um ihre wahre Form aufzudecken.
- **Erkennung von Obfuscationstechniken**: Durch die √úberwachung des Verhaltens der Anwendung kann die dynamische Analyse helfen, spezifische verwendete Obfuscationstechniken zu identifizieren, wie z.B. Code-Virtualisierung, Packer oder dynamische Code-Generierung.
- **Aufdecken versteckter Funktionalit√§ten**: Verschleierter Code kann versteckte Funktionalit√§ten enthalten, die allein durch statische Analyse nicht offensichtlich sind. Die dynamische Analyse erm√∂glicht die Beobachtung aller Code-Pfade, einschlie√ülich der bedingt ausgef√ºhrten Pfade, um solche versteckten Funktionalit√§ten aufzudecken.

## Referenzen und weiterf√ºhrende Literatur
* [https://maddiestone.github.io/AndroidAppRE/obfuscation.html](https://maddiestone.github.io/AndroidAppRE/obfuscation.html)
* BlackHat USA 2018: "Unpacking the Packed Unpacker: Reverse Engineering an Android Anti-Analysis Library" \[[Video](https://www.youtube.com/watch?v=s0Tqi7fuOSU)]
* Dieser Vortrag behandelt die Reverse Engineering einer der komplexesten Anti-Analyse-Native-Bibliotheken, die ich bei einer Android-Anwendung gesehen habe. Er behandelt haupts√§chlich Verschleierungstechniken im nativen Code.
* REcon 2019: "The Path to the Payload: Android Edition" \[[Video](https://recon.cx/media-archive/2019/Session.005.Maddie_Stone.The_path_to_the_payload_Android_Edition-J3ZnNl2GYjEfa.mp4)]
* Dieser Vortrag behandelt eine Reihe von Verschleierungstechniken, ausschlie√ülich im Java-Code, die von einem Android-Botnetz verwendet wurden, um sein Verhalten zu verbergen.


<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
