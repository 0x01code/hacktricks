# 안드로이드 작업 탈취

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션인 [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)을 **팔로우**하세요.
* **HackingTricks**와 **HackingTricks Cloud** github 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

가장 중요한 취약점을 찾아서 빠르게 수정하세요. Intruder는 공격 표면을 추적하고 적극적인 위협 스캔을 실행하여 API부터 웹 앱 및 클라우드 시스템까지 전체 기술 스택에서 문제를 찾습니다. [**무료로 시도해보세요**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) 오늘.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## 작업, 백 스택 및 포그라운드 활동

안드로이드에서 **작업**은 특정 작업을 완료하기 위해 사용자가 상호 작용하는 활동의 집합으로 구성된 **백 스택** 내에서 조직화됩니다. 이 스택은 활동이 열린 시간에 따라 정렬되며, 가장 최근의 활동이 **포그라운드 활동**으로 화면 상에 표시됩니다. 어떤 순간에도 이 활동만이 화면에 표시되어 **포그라운드 작업**의 일부가 됩니다.

다음은 활동 전환에 대한 간단한 설명입니다:

- **활동 1**은 처음에 포그라운드에서 단독으로 시작됩니다.
- **활동 2**를 시작하면 **활동 1**이 백 스택으로 이동하고 **활동 2**가 포그라운드로 이동합니다.
- **활동 3**을 시작하면 **활동 1**과 **활동 2**가 스택에서 더 뒤로 이동하고, **활동 3**이 앞에 표시됩니다.
- **활동 3**을 닫으면 **활동 2**가 다시 포그라운드로 돌아오며, 안드로이드의 간소화된 작업 탐색 메커니즘을 보여줍니다.

![https://developer.android.com/images/fundamentals/diagram_backstack.png](<../../.gitbook/assets/image (548).png>)

## 작업 친화성 공격

### 작업 친화성 및 시작 모드 개요

안드로이드 애플리케이션에서 **작업 친화성**은 활동의 선호 작업을 지정하며, 일반적으로 앱의 패키지 이름과 일치합니다. 이 설정은 공격을 시연하기 위한 개념 증명 (PoC) 앱을 만드는 데 중요한 역할을 합니다.

### 시작 모드

`launchMode` 속성은 작업 내에서 활동 인스턴스의 처리를 지시합니다. **singleTask** 모드는 기존 활동 인스턴스와 작업 친화성 일치에 따라 세 가지 시나리오를 지배합니다. 이 공격은 공격자의 앱이 대상 앱의 작업 친화성을 모방하여 의도한 대상 대신 공격자의 앱을 실행하도록 안드로이드 시스템을 속이는 능력에 의존합니다.

### 상세한 공격 단계

1. **악성 앱 설치**: 피해자가 자신의 장치에 공격자의 앱을 설치합니다.
2. **초기 활성화**: 피해자가 처음으로 악성 앱을 열어 공격을 위한 장치를 설정합니다.
3. **대상 앱 실행 시도**: 피해자가 대상 앱을 실행하려고 시도합니다.
4. **탈취 실행**: 일치하는 작업 친화성으로 인해 대상 앱 대신 악성 앱이 실행됩니다.
5. **속임수**: 악성 앱은 대상 앱과 유사한 가짜 로그인 화면을 제시하여 사용자로 하여금 민감한 정보를 입력하도록 속입니다.

이 공격의 실제 구현에 대해서는 GitHub의 Task Hijacking Strandhogg 저장소를 참조하세요: [Task Hijacking Strandhogg](https://github.com/az0mb13/Task_Hijacking_Strandhogg).

### 예방 조치

이러한 공격을 방지하기 위해 개발자는 `taskAffinity`를 빈 문자열로 설정하고 `singleInstance` 시작 모드를 선택하여 다른 앱과의 격리를 보장할 수 있습니다. `onBackPressed()` 함수를 사용자 정의하는 것은 작업 탈취에 대한 추가적인 보호 기능을 제공합니다.

## **참고 자료**

* [**https://blog.dixitaditya.com/android-task-hijacking/**](https://blog.dixitaditya.com/android-task-hijacking/)
* [**https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html**](https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html)

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

가장 중요한 취약점을 찾아서 빠르게 수정하세요. Intruder는 공격 표면을 추적하고 적극적인 위협 스캔을 실행하여 API부터 웹 앱 및 클라우드 시스템까지 전체 기술 스택에서 문제를 찾습니다. [**무료로 시도해보세요**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) 오늘.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션인 [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)을 **팔로우**하세요.
* **HackingTricks**와 **HackingTricks Cloud** github 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>
