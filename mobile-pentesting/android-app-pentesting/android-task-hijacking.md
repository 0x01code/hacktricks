# Android Task Hijacking

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Pronađite najvažnije ranjivosti kako biste ih brže popravili. Intruder prati vašu površinu napada, pokreće proaktivno skeniranje pretnji, pronalazi probleme u celokupnom tehnološkom sklopu, od API-ja do veb aplikacija i cloud sistema. [**Isprobajte ga besplatno**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) danas.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## Zadatak, Back Stack i Aktivnosti u prvom planu

U Androidu, **zadatak** je suštinski skup aktivnosti sa kojima korisnici interaguju kako bi završili određeni posao, organizovane unutar **back stack**-a. Ovaj stek naručuje aktivnosti na osnovu vremena kada su otvorene, pri čemu se najnovija aktivnost prikazuje na vrhu kao **aktivnost u prvom planu**. U svakom trenutku, samo ova aktivnost je vidljiva na ekranu, čime postaje deo **zadatka u prvom planu**.

Evo brzog pregleda prelazaka aktivnosti:

- **Aktivnost 1** počinje kao jedina aktivnost u prvom planu.
- Pokretanje **Aktivnosti 2** gura **Aktivnost 1** na back stack, dovodeći **Aktivnost 2** u prvi plan.
- Pokretanje **Aktivnosti 3** pomera **Aktivnost 1** i **Aktivnost 2** dalje unazad u steku, pri čemu je sada **Aktivnost 3** ispred.
- Zatvaranje **Aktivnosti 3** vraća **Aktivnost 2** u prvi plan, prikazujući Android-ov mehanizam za navigaciju zadataka.

![https://developer.android.com/images/fundamentals/diagram_backstack.png](<../../.gitbook/assets/image (548).png>)

## Napad na povezanost zadataka

### Pregled povezanosti zadataka i režima pokretanja

U Android aplikacijama, **povezanost zadatka** određuje preferirani zadatak aktivnosti, obično se podudarajući sa imenom paketa aplikacije. Ova postavka je ključna za izradu PoC (Proof-of-Concept) aplikacije koja demonstrira napad.

### Režimi pokretanja

Atribut `launchMode` usmerava rukovanje instancama aktivnosti unutar zadataka. Režim **singleTask** je ključan za ovaj napad, određujući tri scenarija na osnovu postojećih instanci aktivnosti i podudaranja povezanosti zadataka. Eksploatacija se oslanja na sposobnost napadačeve aplikacije da imitira povezanost zadatka ciljne aplikacije, zavaravajući Android sistem da pokrene napadačevu aplikaciju umesto ciljane.

### Detaljni koraci napada

1. **Instalacija zlonamerne aplikacije**: Žrtva instalira napadačevu aplikaciju na svoj uređaj.
2. **Početna aktivacija**: Žrtva prvo otvara zlonamernu aplikaciju, pripremajući uređaj za napad.
3. **Pokušaj pokretanja ciljane aplikacije**: Žrtva pokušava da otvori ciljanu aplikaciju.
4. **Izvršenje preuzimanja kontrole**: Zbog podudaranja povezanosti zadataka, zlonamerna aplikacija se pokreće umesto ciljane aplikacije.
5. **Prevara**: Zlonamerna aplikacija prikazuje lažni ekran za prijavljivanje koji liči na ciljanu aplikaciju, prevareći korisnika da unese osetljive informacije.

Za praktičnu implementaciju ovog napada, pogledajte repozitorijum Task Hijacking Strandhogg na GitHub-u: [Task Hijacking Strandhogg](https://github.com/az0mb13/Task_Hijacking_Strandhogg).

### Mere prevencije

Da bi se sprečili ovakvi napadi, programeri mogu postaviti `taskAffinity` na prazan string i odabrati režim pokretanja `singleInstance`, obezbeđujući izolaciju njihove aplikacije od drugih. Prilagođavanje funkcije `onBackPressed()` pruža dodatnu zaštitu protiv preuzimanja kontrole nad zadatkom.

## **Reference**

* [**https://blog.dixitaditya.com/android-task-hijacking/**](https://blog.dixitaditya.com/android-task-hijacking/)
* [**https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html**](https://blog.takemyhand.xyz/2021/02/android-task-hijacking-with.html)

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Pronađite najvažnije ranjivosti kako biste ih brže popravili. Intruder prati vašu površinu napada, pokreće proaktivno skeniranje pretnji, pronalazi probleme u celokupnom tehnološkom sklopu, od API-ja do veb aplikacija i cloud sistema. [**Isprobajte ga besplatno**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) danas.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
