# –ü–æ—Å—ñ–±–Ω–∏–∫ –∑ Frida 1

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>

<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**–ü—ñ–¥–∫–∞–∑–∫–∞ —â–æ–¥–æ –±–∞–≥—ñ–≤**: **–∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—è** –Ω–∞ **Intigriti**, –ø—Ä–µ–º—ñ–∞–ª—å–Ω—ñ–π **–ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ –¥–ª—è –ø–æ—à—É–∫—É –±–∞–≥—ñ–≤, —Å—Ç–≤–æ—Ä–µ–Ω—ñ–π —Ö–∞–∫–µ—Ä–∞–º–∏ –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤**! –ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) —Å—å–æ–≥–æ–¥–Ω—ñ, —ñ –ø–æ—á–Ω—ñ—Ç—å –∑–∞—Ä–æ–±–ª—è—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –¥–æ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

**–¶–µ –∫—Ä–∞—Ç–∫–∏–π –æ–≥–ª—è–¥ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó**: [https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1](https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1)\
**APK**: [https://github.com/t0thkr1s/frida-demo/releases](https://github.com/t0thkr1s/frida-demo/releases)\
**–í–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥**: [https://github.com/t0thkr1s/frida-demo](https://github.com/t0thkr1s/frida-demo)

## Python

Frida –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º **–≤—Å—Ç–∞–≤–ª—è—Ç–∏ –∫–æ–¥ JavaScript** –≤—Å–µ—Ä–µ–¥–∏–Ω—É —Ñ—É–Ω–∫—Ü—ñ–π –∑–∞–ø—É—â–µ–Ω–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏. –ê–ª–µ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **python** –¥–ª—è **–≤–∏–∫–ª–∏–∫—É** –≥–∞—á–∫—ñ–≤ —ñ –Ω–∞–≤—ñ—Ç—å –¥–ª—è **–≤–∑–∞—î–º–æ–¥—ñ—ó** –∑ **–≥–∞—á–∫–∞–º–∏**.

–û—Å—å –ø—Ä–æ—Å—Ç–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π –Ω–∞ python, —è–∫–∏–π –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑ —É—Å—ñ–º–∞ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–∏–º–∏ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏ —É —Ü—å–æ–º—É –ø–æ—Å—ñ–±–Ω–∏–∫—É:
```python
#hooking.py
import frida, sys

with open(sys.argv[1], 'r') as f:
jscode = f.read()
process = frida.get_usb_device().attach('infosecadventures.fridademo')
script = process.create_script(jscode)
print('[ * ] Running Frida Demo application')
script.load()
sys.stdin.read()
```
–í–∏–∫–ª–∏—á—Ç–µ —Å–∫—Ä–∏–ø—Ç:
```bash
python hooking.py <hookN.js>
```
–¶–µ –∫–æ—Ä–∏—Å–Ω–æ –∑–Ω–∞—Ç–∏, —è–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Python –∑ Frida, –∞–ª–µ –¥–ª—è —Ü–∏—Ö –ø—Ä–∏–∫–ª–∞–¥—ñ–≤ –≤–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ Frida –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ frida:
```bash
frida -U --no-pause -l hookN.js -f infosecadventures.fridademo
```
## –ü–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è 1 - –û–±—Ö—ñ–¥ –ª–æ–≥—ñ—á–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è

–¢—É—Ç –≤–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —è–∫ **–ø–µ—Ä–µ—Ö–æ–ø–∏—Ç–∏** –º–µ—Ç–æ–¥ –∑ **–ª–æ–≥—ñ—á–Ω–∏–º** –∑–Ω–∞—á–µ–Ω–Ω—è–º (_checkPin_) –∑ –∫–ª–∞—Å—É: _infosecadventures.fridademo.utils.PinUtil_
```javascript
//hook1.js
Java.perform(function() {
console.log("[ * ] Starting implementation override...")
var MainActivity = Java.use("infosecadventures.fridademo.utils.PinUtil");
MainActivity.checkPin.implementation = function(pin){
console.log("[ + ] PIN check successfully bypassed!")
return true;
}
});
```

```
python hooking.py hook1.js
```
–ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ: –§—É–Ω–∫—Ü—ñ—è –æ—Ç—Ä–∏–º—É—î —Ä—è–¥–æ–∫ —è–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è?

## –ü–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è 2 - –§—É–Ω–∫—Ü—ñ—è Bruteforce

### –ù–µ—Å—Ç–∞—Ç–∏—á–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è

–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –Ω–µ—Å—Ç–∞—Ç–∏—á–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é –∫–ª–∞—Å—É, –≤–∞–º **—Å–ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–µ–Ω –µ–∫–∑–µ–º–ø–ª—è—Ä** —Ü—å–æ–≥–æ –∫–ª–∞—Å—É. –ü–æ—Ç—ñ–º –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ–π –µ–∫–∑–µ–º–ø–ª—è—Ä –¥–ª—è –≤–∏–∫–ª–∏–∫—É —Ñ—É–Ω–∫—Ü—ñ—ó.\
–î–ª—è —Ü—å–æ–≥–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–Ω–∞–π—Ç–∏ —ñ—Å–Ω—É—é—á–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä** —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ:
```javascript
Java.perform(function() {
console.log("[ * ] Starting PIN Brute-force, please wait...");
Java.choose("infosecadventures.fridademo.utils.PinUtil", {
onMatch: function(instance) {
console.log("[ * ] Instance found in memory: " + instance);
for(var i = 1000; i < 9999; i++){
if(instance.checkPin(i + "") == true){
console.log("[ + ] Found correct PIN: " + i);
break;
}
}
},
onComplete: function() { }
});
});
```
### –°—Ç–∞—Ç–∏—á–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è

–Ø–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è —î —Å—Ç–∞—Ç–∏—á–Ω–æ—é, –≤–∏ –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —ó—ó:
```javascript
//hook2.js
Java.perform(function () {
console.log("[ * ] Starting PIN Brute-force, please wait...")
var PinUtil = Java.use("infosecadventures.fridademo.utils.PinUtil");

for(var i=1000; i < 9999; i++)
{
if(PinUtil.checkPin(i+"") == true){
console.log("[ + ] Found correct PIN: " + i);
}
}
});
```
## –ü–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è 3 - –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è, —â–æ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è

–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Ö–æ–ø–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é —ñ –∑—Ä–æ–±–∏—Ç–∏ —ó—ó **–≤–∏–≤–æ–¥–∏—Ç—å** –∑–Ω–∞—á–µ–Ω–Ω—è **–ø–µ—Ä–µ–¥–∞–Ω–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤** —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è **–∑–Ω–∞—á–µ–Ω–Ω—è, —â–æ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è:**
```javascript
//hook3.js
Java.perform(function() {
console.log("[ * ] Starting implementation override...")

var EncryptionUtil = Java.use("infosecadventures.fridademo.utils.EncryptionUtil");
EncryptionUtil.encrypt.implementation = function(key, value){
console.log("Key: " + key);
console.log("Value: " + value);
var encrypted_ret = this.encrypt(key, value); //Call the original function
console.log("Encrypted value: " + encrypted_ret);
return encrypted_ret;
}
});
```
## –í–∞–∂–ª–∏–≤–æ

–£ —Ü—å–æ–º—É –ø—ñ–¥—Ä—É—á–Ω–∏–∫—É –≤–∏ –ø—ñ–¥–∫–ª—é—á–∏–ª–∏ –º–µ—Ç–æ–¥–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –Ω–∞–∑–≤—É –º–µ—Ç–æ–¥—É —Ç–∞ _.implementation_. –ê–ª–µ —è–∫—â–æ —î **–±—ñ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ –º–µ—Ç–æ–¥—É** –∑ –æ–¥–Ω–∞–∫–æ–≤–æ—é –Ω–∞–∑–≤–æ—é, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ **–≤–∫–∞–∑–∞—Ç–∏ –º–µ—Ç–æ–¥**, —è–∫–∏–π –≤–∏ —Ö–æ—á–µ—Ç–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏, **–≤–∫–∞–∑–∞–≤—à–∏ —Ç–∏–ø –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤**.

–í–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —Ü–µ –≤ [–Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –ø—ñ–¥—Ä—É—á–Ω–∏–∫—É](frida-tutorial-2.md).

<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**–ü—ñ–¥–∫–∞–∑–∫–∞ —â–æ–¥–æ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –∑–∞ –ø–æ–º–∏–ª–∫–∏**: **–∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—è** –Ω–∞ **Intigriti**, –ø—Ä–µ–º—ñ–∞–ª—å–Ω—ñ–π **–ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ –¥–ª—è –≤–∏–Ω–∞–≥–æ—Ä–æ–¥ –∑–∞ –ø–æ–º–∏–ª–∫–∏, —Å—Ç–≤–æ—Ä–µ–Ω—ñ–π —Ö–∞–∫–µ—Ä–∞–º–∏ –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤**! –ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) —Å—å–æ–≥–æ–¥–Ω—ñ, —ñ –ø–æ—á–Ω—ñ—Ç—å –∑–∞—Ä–æ–±–ª—è—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –¥–æ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>
