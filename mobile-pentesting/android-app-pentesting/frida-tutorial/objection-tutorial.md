# Objection Tutorial

<details>

<summary><strong>Erfahren Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks in PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Bug-Bounty-Tipp**: **Melden Sie sich an** bei **Intigriti**, einer Premium-**Bug-Bounty-Plattform, die von Hackern f√ºr Hacker erstellt wurde**! Treten Sie noch heute bei [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) bei und beginnen Sie, Pr√§mien von bis zu **100.000 $** zu verdienen!

{% embed url="https://go.intigriti.com/hacktricks" %}

## **Einf√ºhrung**

**objection - Laufzeitmobile Exploration**

[**Objection**](https://github.com/sensepost/objection) ist ein Toolkit f√ºr die Laufzeitmobile-Exploration, das von [Frida](https://www.frida.re) unterst√ºtzt wird. Es wurde mit dem Ziel entwickelt, die Sicherheitslage von mobilen Anwendungen zu bewerten, ohne dass ein gejailbreaktes oder gerootetes Mobilger√§t erforderlich ist.

**Hinweis:** Dies ist keine Art von Jailbreak-/Root-Umgehung. Durch die Verwendung von `objection` sind Sie immer noch durch alle Beschr√§nkungen eingeschr√§nkt, die von der jeweiligen Sandbox auferlegt werden.

### Zusammenfassung

Das **Ziel** von **objection** ist es, dem Benutzer das Aufrufen der **Hauptaktionen, die Frida bietet**, zu erm√∂glichen. Andernfalls m√ºsste der Benutzer f√ºr jede Anwendung, die er testen m√∂chte, ein **einzelnens Skript erstellen**.

## Tutorial

F√ºr dieses Tutorial werde ich die APK verwenden, die Sie hier herunterladen k√∂nnen:

{% file src="../../../.gitbook/assets/app-release.zip" %}

Oder von seinem [urspr√ºnglichen Repository](https://github.com/asvid/FridaApp) (App-Release.apk herunterladen)

### Installation
```bash
pip3 install objection
```
### Verbindung

Stellen Sie eine **normale ADB-Verbindung** her und **starten** Sie den **Frida**-Server auf dem Ger√§t (und √ºberpr√ºfen Sie, ob Frida sowohl im Client als auch im Server funktioniert).

Wenn Sie ein **gerootetes Ger√§t** verwenden, m√ºssen Sie die Anwendung ausw√§hlen, die Sie im _**--gadget**_ -Parameter testen m√∂chten. In diesem Fall:
```bash
frida-ps -Uai
objection --gadget asvid.github.io.fridaapp explore
```
### Grundlegende Aktionen

Nicht alle m√∂glichen Befehle von Objection werden in diesem Tutorial aufgelistet, nur diejenigen, die ich am n√ºtzlichsten gefunden habe.

#### Umgebung

Einige interessante Informationen (wie Passw√∂rter oder Pfade) k√∂nnten in der Umgebung gefunden werden.
```bash
env
```
![](<../../../.gitbook/assets/image (220).png>)

#### Frida Informationen
```bash
frida
```
![](<../../../.gitbook/assets/image (1093).png>)

#### Hochladen/Herunterladen
```bash
file download <remote path> [<local path>]
file upload <local path> [<remote path>]
```
#### Fr√ºhere frida-Skript einbinden
```bash
import <local path frida-script>
```
#### SSL-Pinning
```bash
android sslpinning disable #Attempts to disable SSL Pinning on Android devices.
```
#### Root-Erkennung
```bash
android root disable  #Attempts to disable root detection on Android devices.
android root simulate #Attempts to simulate a rooted Android environment.
```
#### Ausf√ºhren von Befehlen
```bash
android shell_exec whoami
```
#### Bildschirmfotos
```bash
android ui screenshot /tmp/screenshot
android ui FLAG_SECURE false  #This may enable you to take screenshots using the hardware keys
```
### Statische Analyse wird dynamisch

In einer echten Anwendung sollten wir alle Informationen, die in diesem Teil entdeckt wurden, dank der **statischen Analyse** kennen, bevor wir Objection verwenden. Trotzdem k√∂nnen Sie auf diese Weise vielleicht **etwas Neues** sehen, da Sie hier nur eine vollst√§ndige Liste von Klassen, Methoden und exportierten Objekten haben.

Dies ist auch n√ºtzlich, wenn Sie aus irgendeinem Grund **keinen lesbaren Quellcode** der App erhalten k√∂nnen.

#### Auflisten von Aktivit√§ten, Empf√§ngern und Diensten
```bash
android hooking list activities
```
![](<../../../.gitbook/assets/image (1016).png>)
```bash
android hooking list services
android hooking list receivers
```
Frida wird einen Fehler anzeigen, wenn keiner gefunden wird

#### Aktuelle Aktivit√§t abrufen
```bash
android hooking get current_activity
```
![](<../../../.gitbook/assets/image (813).png>)

#### Klassen suchen

Lassen Sie uns damit beginnen, nach Klassen innerhalb unserer Anwendung zu suchen.
```bash
android hooking search classes asvid.github.io.fridaapp
```
![](<../../../.gitbook/assets/image (507).png>)

#### Suchmethoden einer Klasse suchen

Extrahieren wir nun die Methoden innerhalb der Klasse _MainActivity:_
```bash
android hooking search methods asvid.github.io.fridaapp MainActivity
```
![](<../../../.gitbook/assets/image (929).png>)

#### Auflisten deklarierter Methoden einer Klasse mit ihren Parametern

Lassen Sie uns herausfinden, welche Parameter die Methoden der Klasse ben√∂tigen:
```bash
android hooking list class_methods asvid.github.io.fridaapp.MainActivity
```
![](<../../../.gitbook/assets/image (299).png>)

#### Klassen auflisten

Sie k√∂nnten auch alle Klassen auflisten, die in der aktuellen Anwendung geladen wurden:
```bash
android hooking list classes #List all loaded classes, As the target application gets usedmore, this command will return more classes.
```
Dies ist sehr n√ºtzlich, wenn Sie die Methode einer Klasse **hooken m√∂chten und nur den Namen der Klasse kennen**. Sie k√∂nnten diese Funktion verwenden, um **herauszufinden, welches Modul die Klasse besitzt** und dann ihre Methode zu hooken.

### Das Hooken ist einfach

#### Hooken (√úberwachen) einer Methode

Aus dem [Quellcode](https://github.com/asvid/FridaApp/blob/master/app/src/main/java/asvid/github/io/fridaapp/MainActivity.kt) der Anwendung wissen wir, dass die **Funktion** _**sum()**_ **von** _**MainActivity**_ **jede Sekunde** ausgef√ºhrt wird. Versuchen wir, **jedes Mal alle m√∂glichen Informationen** zu dumpen, wenn die Funktion aufgerufen wird (Argumente, R√ºckgabewert und Backtrace):
```bash
android hooking watch class_method asvid.github.io.fridaapp.MainActivity.sum --dump-args --dump-backtrace --dump-return
```
![](<../../../.gitbook/assets/image (1086).png>)

#### Hooking (watching) an entire class

Eigentlich finde ich alle Methoden der Klasse MainActivity wirklich interessant, lass uns **sie alle hooken**. Sei vorsichtig, das k√∂nnte eine Anwendung **zum Absturz bringen**.
```bash
android hooking watch class asvid.github.io.fridaapp.MainActivity --dump-args --dump-return
```
Wenn Sie mit der Anwendung spielen, w√§hrend die Klasse gehookt ist, sehen Sie, wann **jede Funktion aufgerufen wird**, ihre **Argumente** und den **R√ºckgabewert**.

![](<../../../.gitbook/assets/image (861).png>)

#### √Ñndern des booleschen R√ºckgabewerts einer Funktion

Aus dem Quellcode k√∂nnen Sie sehen, dass die Funktion _checkPin_ ein _String_ als Argument erh√§lt und einen _boolean_ zur√ºckgibt. Lassen Sie die Funktion **immer true zur√ºckgeben**:

![](<../../../.gitbook/assets/image (883).png>)

Nun, wenn Sie etwas in das Textfeld f√ºr den PIN-Code eingeben, sehen Sie, dass alles g√ºltig ist:

![](<../../../.gitbook/assets/image (228).png>)

### Klasseninstanzen

Suchen und drucken Sie **live Instanzen einer bestimmten Java-Klasse** aus, die durch einen voll qualifizierten Klassennamen angegeben ist. Out ist das Ergebnis eines Versuchs, einen Zeichenfolgenwert f√ºr einen entdeckten Einwand zu erhalten, der typischerweise **Eigenschaftswerte f√ºr das Objekt enthalten w√ºrde**.
```
android heap print_instances <class>
```
![](<../../../.gitbook/assets/image (1095).png>)

### Keystore/Intents

Sie k√∂nnen mit dem Keystore und Intents spielen, indem Sie:
```bash
android keystore list
android intents launch_activity
android intent launch_service
```
### Speicher

#### Dump
```bash
memory dump all <local destination> #Dump all memory
memory dump from_base <base_address> <size_to_dump> <local_destination> #Dump a part
```
#### Liste
```bash
memory list modules
```
![](<../../../.gitbook/assets/image (286).png>)

Am unteren Ende der Liste k√∂nnen Sie frida sehen:

![](<../../../.gitbook/assets/image (1097).png>)

Lassen Sie uns √ºberpr√ºfen, was frida exportiert:

![](<../../../.gitbook/assets/image (298).png>)

#### Suche/Schreiben

Sie k√∂nnen auch im Speicher suchen und mit Objection schreiben:
```bash
memory search "<pattern eg: 41 41 41 ?? 41>" (--string) (--offsets-only)
memory write "<address>" "<pattern eg: 41 41 41 41>" (--string)
```
### SQLite

Sie k√∂nnen den Befehl `sqlite` verwenden, um mit SQLite-Datenbanken zu interagieren.

### Exit
```bash
exit
```
## Was mir in Objection fehlt

* Die Hooking-Methoden lassen die Anwendung manchmal abst√ºrzen (das liegt auch an Frida).
* Sie k√∂nnen die Instanzen der Klassen nicht verwenden, um Funktionen der Instanz aufzurufen. Und Sie k√∂nnen keine neuen Instanzen von Klassen erstellen und verwenden, um Funktionen aufzurufen.
* Es gibt keine Abk√ºrzung (wie die f√ºr sslpinnin), um alle g√§ngigen Kryptomethoden, die von der Anwendung verwendet werden, zu hooken, um verschl√ºsselten Text, Klartext, Schl√ºssel, IVs und verwendete Algorithmen zu sehen.

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Bug-Bounty-Tipp**: **Melden Sie sich an** bei **Intigriti**, einer Premium-**Bug-Bounty-Plattform, die von Hackern f√ºr Hacker erstellt wurde**! Treten Sie uns unter [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) bei und beginnen Sie noch heute, Pr√§mien von bis zu **$100.000** zu verdienen!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories einreichen.

</details>
