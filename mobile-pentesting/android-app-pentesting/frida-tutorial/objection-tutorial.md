# Tutorial di Objection

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Suggerimento per bug bounty**: **iscriviti** a **Intigriti**, una piattaforma premium di **bug bounty creata da hacker, per hacker**! Unisciti a noi su [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) oggi stesso e inizia a guadagnare ricompense fino a **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

## **Introduzione**

**objection - Esplorazione mobile in tempo di esecuzione**

**[Objection](https://github.com/sensepost/objection)** √® un toolkit di esplorazione mobile in tempo di esecuzione, alimentato da [Frida](https://www.frida.re). √à stato creato con l'obiettivo di aiutare a valutare le applicazioni mobili e la loro sicurezza senza la necessit√† di un dispositivo mobile jailbroken o rootato.

**Nota:** Questo non √® una forma di bypass di jailbreak / root. Utilizzando `objection`, sei comunque limitato da tutte le restrizioni imposte dal sandbox applicabile che stai affrontando.

### Riassunto

L'**obiettivo** di **objection** √® consentire all'utente di chiamare le **principali azioni offerte da Frida**. **In caso contrario**, l'utente dovr√† creare uno **script singolo per ogni applicazione** che desidera testare.

## Tutorial

Per questo tutorial user√≤ l'APK che puoi scaricare qui:

{% file src="../../../.gitbook/assets/app-release.zip" %}

O dal suo [repository originale](https://github.com/asvid/FridaApp)(scarica app-release.apk)

### Installazione
```bash
pip3 install objection
```
### Connessione

Effettua una **connessione ADB regolare** e **avvia** il server **frida** sul dispositivo (e verifica che frida funzioni sia sul client che sul server).

Se stai utilizzando un **dispositivo con root**, √® necessario selezionare l'applicazione che desideri testare all'interno dell'opzione _**--gadget**_. In questo caso:
```bash
frida-ps -Uai
objection --gadget asvid.github.io.fridaapp explore
```
### Azioni di base

Non verranno elencati tutti i comandi possibili di Objection in questo tutorial, solo quelli che ho trovato pi√π utili.

#### Ambiente

Alcune informazioni interessanti (come password o percorsi) potrebbero essere trovate all'interno dell'ambiente.
```bash
env
```
![](<../../../.gitbook/assets/image (64).png>)

#### Informazioni su Frida

Frida √® un framework open-source per il reverse engineering e il pentesting delle applicazioni Android e iOS. Utilizza l'iniezione di codice dinamico per consentire agli sviluppatori di manipolare il comportamento delle applicazioni in esecuzione. Frida supporta diversi linguaggi di scripting, tra cui JavaScript, Python e Swift, offrendo una vasta gamma di funzionalit√† per l'analisi e la manipolazione delle applicazioni mobili.

#### Cos'√® Objection?

Objection √® uno strumento basato su Frida che semplifica il processo di pentesting delle applicazioni Android. Fornisce un'interfaccia a riga di comando intuitiva per interagire con le applicazioni in esecuzione e sfruttare le vulnerabilit√†. Objection offre una serie di comandi utili per l'analisi delle applicazioni, come l'intercettazione del traffico di rete, l'ispezione delle API, la manipolazione dei dati e molto altro ancora.

#### Installazione di Objection

Per installare Objection, seguire i seguenti passaggi:

1. Assicurarsi di avere Frida installato nel sistema.
2. Aprire il terminale e digitare il comando `pip install objection`.
3. Attendere il completamento dell'installazione.

Una volta completata l'installazione, Objection sar√† pronto per essere utilizzato nel processo di pentesting delle applicazioni Android.

#### Utilizzo di Objection

Objection offre una vasta gamma di comandi per interagire con le applicazioni Android. Alcuni dei comandi pi√π comuni includono:

- `android hooking list`: elenca tutti i metodi hook disponibili nelle applicazioni.
- `android hooking watch class <class_name>`: monitora le chiamate ai metodi di una classe specifica.
- `android hooking watch method <class_name> <method_name>`: monitora le chiamate a un metodo specifico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una classe.
- `android hooking watch class_method <class_name> <method_name>`: monitora le chiamate a un metodo statico di una
```bash
frida
```
![](<../../../.gitbook/assets/image (65).png>)

#### Caricamento/Scaricamento
```bash
file download <remote path> [<local path>]
file upload <local path> [<remote path>]
```
#### Importa lo script di frida
```bash
import <local path frida-script>
```
#### SSLPinning

Il SSLPinning √® una tecnica utilizzata nelle applicazioni Android per proteggere le comunicazioni tramite SSL/TLS. Di solito, quando un'applicazione si connette a un server tramite HTTPS, verifica la validit√† del certificato del server per garantire che la connessione sia sicura. Tuttavia, il SSLPinning impedisce all'applicazione di accettare qualsiasi certificato diverso da quello specificato.

Questa tecnica pu√≤ essere bypassata utilizzando strumenti come Objection. Objection √® uno strumento di ispezione e manipolazione delle applicazioni Android che pu√≤ essere utilizzato per modificare il comportamento delle applicazioni in esecuzione sul dispositivo. Con Objection, √® possibile disabilitare o ignorare il controllo del SSLPinning, consentendo di intercettare e analizzare il traffico di rete tra l'applicazione e il server.

Per bypassare il SSLPinning con Objection, √® possibile utilizzare il comando `android sslpinning disable`. Questo comando disabilita il controllo del SSLPinning nell'applicazione in esecuzione, consentendo di intercettare il traffico di rete con strumenti come Burp Suite o Wireshark.

√à importante notare che il bypass del SSLPinning √® una pratica non etica e potrebbe essere illegale senza il consenso del proprietario dell'applicazione. Pertanto, √® fondamentale utilizzare queste tecniche solo a fini di pentesting legittimi e con il consenso scritto del proprietario dell'applicazione.
```bash
android sslpinning disable #Attempts to disable SSL Pinning on Android devices.
```
#### Rilevamento del root

Root detection is a common security measure implemented in Android applications to prevent them from running on rooted devices. Rooting a device gives users administrative privileges, which can be a security risk as it allows them to bypass certain security measures and access sensitive information.

Il rilevamento del root √® una misura di sicurezza comune implementata nelle applicazioni Android per impedire loro di essere eseguite su dispositivi con root. Il root di un dispositivo concede agli utenti privilegi amministrativi, il che pu√≤ rappresentare un rischio per la sicurezza poich√© consente loro di eludere alcune misure di sicurezza e accedere a informazioni sensibili.

There are various techniques used to detect root access on an Android device. Some common methods include checking for the presence of known root files or directories, checking the device's build properties for signs of root access, and using native libraries to detect root binaries.

Esistono varie tecniche utilizzate per rilevare l'accesso root su un dispositivo Android. Alcuni metodi comuni includono il controllo della presenza di file o directory root noti, il controllo delle propriet√† di compilazione del dispositivo per segni di accesso root e l'utilizzo di librerie native per rilevare binari root.

To bypass root detection, an attacker can use tools like Frida and Objection to hook into the application's code and modify the root detection logic. By intercepting the root detection function and modifying its return value, the attacker can trick the application into thinking that the device is not rooted.

Per eludere il rilevamento del root, un attaccante pu√≤ utilizzare strumenti come Frida e Objection per agganciarsi al codice dell'applicazione e modificare la logica di rilevamento del root. Intercettando la funzione di rilevamento del root e modificando il valore di ritorno, l'attaccante pu√≤ ingannare l'applicazione facendole credere che il dispositivo non sia rootato.

It is important for developers to implement additional security measures to protect their applications from being compromised on rooted devices. This can include encrypting sensitive data, implementing code obfuscation techniques, and using server-side validation to verify the integrity of data received from the client.

√à importante che gli sviluppatori implementino ulteriori misure di sicurezza per proteggere le proprie applicazioni da compromissioni su dispositivi rootati. Ci√≤ pu√≤ includere la crittografia dei dati sensibili, l'implementazione di tecniche di offuscamento del codice e l'utilizzo di convalida lato server per verificare l'integrit√† dei dati ricevuti dal client.
```bash
android root disable  #Attempts to disable root detection on Android devices.
android root simulate #Attempts to simulate a rooted Android environment.
```
#### Esegui Comando

The `exec` command in objection allows you to execute shell commands on the target Android device. This can be useful for various purposes, such as exploring the device's file system, running scripts, or interacting with the device's shell.

To use the `exec` command, you need to specify the command you want to execute as an argument. For example, to list the files in the current directory, you can use the following command:

```
objection> exec ls
```

This will execute the `ls` command on the target device and display the list of files in the current directory.

You can also use the `exec` command to execute commands with arguments. Simply provide the command and its arguments as separate arguments to the `exec` command. For example, to create a new directory named "test" in the current directory, you can use the following command:

```
objection> exec mkdir test
```

This will execute the `mkdir` command with the argument "test" on the target device, creating a new directory named "test" in the current directory.

Keep in mind that the `exec` command executes the specified command on the target device as the same user running the objection tool. Therefore, the command's permissions and limitations will be the same as the user running the tool.

Be cautious when using the `exec` command, as executing certain commands can have unintended consequences or cause damage to the target device. Always ensure that you have the necessary permissions and understand the potential impact of the command before executing it.
```bash
android shell_exec whoami
```
#### Screenshots

#### Screenshot
```bash
android ui screenshot /tmp/screenshot
android ui FLAG_SECURE false  #This may enable you to take screenshots using the hardware keys
```
### Analisi statica resa dinamica

In un'applicazione reale dovremmo conoscere tutte le informazioni scoperte in questa parte prima di utilizzare objection grazie all'**analisi statica**. Comunque, in questo modo forse puoi vedere **qualcosa di nuovo** poich√© qui avrai solo un elenco completo di classi, metodi e oggetti esportati.

Questo √® anche utile se in qualche modo non riesci a ottenere del codice sorgente leggibile dell'app.

#### Elenco delle attivit√†, dei ricevitori e dei servizi
```bash
android hooking list activities
```
# Objection Tutorial

Objection is a runtime mobile exploration toolkit, powered by Frida. It allows you to perform various tasks on Android devices, such as:

- Bypassing SSL certificate pinning
- Analyzing and manipulating method calls
- Modifying the behavior of an application
- Inspecting and modifying the application's memory
- Interacting with the application's UI

## Installation

To install Objection, follow these steps:

1. Install Frida by running the command `pip install frida-tools`.
2. Install Objection by running the command `pip install objection`.

## Starting Objection

To start Objection, run the command `objection`.

## Connecting to an Application

To connect to an application, use the command `android connect <package_name>`. Replace `<package_name>` with the package name of the application you want to connect to.

## Bypassing SSL Certificate Pinning

To bypass SSL certificate pinning, use the command `sslpinning disable`.

## Analyzing and Manipulating Method Calls

To analyze and manipulate method calls, use the command `method <class_name> <method_name>`. Replace `<class_name>` with the name of the class containing the method, and `<method_name>` with the name of the method you want to analyze or manipulate.

## Modifying the Behavior of an Application

To modify the behavior of an application, use the command `android hooking watch class_method <class_name> <method_name>`. Replace `<class_name>` with the name of the class containing the method, and `<method_name>` with the name of the method you want to modify.

## Inspecting and Modifying the Application's Memory

To inspect and modify the application's memory, use the command `memory list classes` to list all the classes in the application, and `memory search <class_name>` to search for a specific class. Replace `<class_name>` with the name of the class you want to inspect or modify.

## Interacting with the Application's UI

To interact with the application's UI, use the command `ui explore` to start the UI exploration mode. This mode allows you to interact with the application's UI elements and perform actions such as clicking buttons or entering text.

## Conclusion

Objection is a powerful tool for mobile pentesting on Android devices. It provides a wide range of features that can be used to analyze, manipulate, and modify the behavior of an application. By leveraging the capabilities of Frida, Objection makes it easier to perform various tasks during the mobile pentesting process.
```bash
android hooking list services
android hooking list receivers
```
Frida lancer√† un errore se nessuna attivit√† viene trovata

#### Ottenere l'attivit√† corrente
```bash
android hooking get current_activity
```
#### Ricerca delle classi

Iniziamo cercando le classi all'interno della nostra applicazione
```bash
android hooking search classes asvid.github.io.fridaapp
```
![](<../../../.gitbook/assets/image (69).png>)

#### Metodi di ricerca di una classe

Ora estraiamo i metodi all'interno della classe _MainActivity:_
```bash
android hooking search methods asvid.github.io.fridaapp MainActivity
```
![](<../../../.gitbook/assets/image (70) (1).png>)

#### Elenco dei metodi dichiarati di una classe con i loro parametri

Scopriamo quali parametri richiedono i metodi della classe:
```bash
android hooking list class_methods asvid.github.io.fridaapp.MainActivity
```
![](<../../../.gitbook/assets/image (79).png>)

#### Elenco delle classi

√à possibile anche elencare tutte le classi che sono state caricate all'interno dell'applicazione corrente:
```bash
android hooking list classes #List all loaded classes, As the target application gets usedmore, this command will return more classes.
```
Questo √® molto utile se si desidera agganciare il metodo di una classe e si conosce solo il nome della classe. √à possibile utilizzare questa funzione per cercare quale modulo possiede la classe e quindi agganciare il suo metodo.

### L'aggancio √® facile

#### Agganciare (osservare) un metodo

Dal [codice sorgente](https://github.com/asvid/FridaApp/blob/master/app/src/main/java/asvid/github/io/fridaapp/MainActivity.kt) dell'applicazione sappiamo che la **funzione** _**sum()**_ **dalla** _**MainActivity**_ viene eseguita **ogni secondo**. Proviamo a **dumpare tutte le informazioni possibili** ogni volta che la funzione viene chiamata (argomenti, valore di ritorno e backtrace):
```bash
android hooking watch class_method asvid.github.io.fridaapp.MainActivity.sum --dump-args --dump-backtrace --dump-return
```
![](<../../../.gitbook/assets/image (71).png>)

#### Hooking (watching) an entire class

In realt√† trovo tutti i metodi della classe MainActivity molto interessanti, **li agganceremo tutti**. Stai attento, questo potrebbe **far crashare** un'applicazione.
```bash
android hooking watch class asvid.github.io.fridaapp.MainActivity --dump-args --dump-return
```
Se giochi con l'applicazione mentre la classe √® agganciata, vedrai quando **ogni funzione viene chiamata**, i suoi **argomenti** e il valore di **ritorno**.

![](<../../../.gitbook/assets/image (72).png>)

#### Cambiare il valore booleano di ritorno di una funzione

Dal codice sorgente puoi vedere che la funzione _checkPin_ riceve una _Stringa_ come argomento e restituisce un _booleano_. Facciamo in modo che la funzione **restituisca sempre true**:

![](<../../../.gitbook/assets/image (74).png>)

Ora, se scrivi qualcosa nella casella di testo per il codice PIN, vedrai che qualsiasi cosa √® valida:

![](<../../../.gitbook/assets/image (77).png>)

### Istanze di classe

Cerca e stampa **istanze attive di una specifica classe Java**, specificata da un nome di classe completamente qualificato. Out √® il risultato di un tentativo di ottenere un valore di stringa per un'obiezione scoperta che tipicamente **contiene valori di propriet√† per l'oggetto**.
```
android heap print_instances <class>
```
![](<../../../.gitbook/assets/image (80).png>)

### Keystore/Intents

Puoi giocare con il keystore e gli intents utilizzando:
```bash
android keystore list
android intents launch_activity
android intent launch_service
```
To dump the memory of an Android application, you can use the `dump` command in Objection. This command allows you to extract the memory of the target application and save it to a file.

To use the `dump` command, you need to specify the package name of the target application. For example, if the package name is `com.example.app`, you can run the following command:

```
objection -g com.example.app explore
```

Once you are inside the Objection console, you can use the `dump` command to extract the memory. The syntax of the command is as follows:

```
dump memory <output_file>
```

Replace `<output_file>` with the desired name and path of the output file. For example, if you want to save the memory dump as `memory.bin` in the current directory, you can run the following command:

```
dump memory memory.bin
```

After executing the command, Objection will dump the memory of the target application and save it to the specified file.

#### Search

Once you have the memory dump, you can use the `search` command in Objection to search for specific strings or patterns in the memory. This can be useful for finding sensitive information or identifying potential vulnerabilities.

To use the `search` command, you need to specify the search pattern. For example, if you want to search for the string `password` in the memory dump, you can run the following command:

```
search password
```

Objection will search for the specified pattern in the memory dump and display the results.

#### Analyzing Memory Leaks

Memory leaks can be a common issue in Android applications. They occur when memory is allocated but not properly released, leading to a gradual increase in memory usage over time. Identifying and fixing memory leaks is important for improving the performance and stability of an application.

To analyze memory leaks in an Android application, you can use tools like LeakCanary or MAT (Memory Analyzer Tool). These tools can help you identify objects that are not being properly released and analyze the memory usage of your application.

LeakCanary is a popular open-source library for detecting memory leaks in Android applications. It automatically detects and reports memory leaks, making it easier to identify and fix them. You can integrate LeakCanary into your application by adding the necessary dependencies and initializing it in your code.

MAT is a powerful tool for analyzing memory usage in Java applications. It provides detailed information about the objects in memory, including their size, references, and allocation traces. You can use MAT to analyze memory dumps and identify potential memory leaks in your Android application.

By using these tools, you can effectively analyze memory leaks in your Android application and take appropriate measures to fix them. This will help improve the performance and stability of your application.
```bash
memory dump all <local destination> #Dump all memory
memory dump from_base <base_address> <size_to_dump> <local_destination> #Dump a part
```
#### Elenco
```bash
memory list modules
```
![](<../../../.gitbook/assets/image (66).png>)

In fondo alla lista puoi vedere frida:

![](<../../../.gitbook/assets/image (67).png>)

Controlliamo cosa sta esportando frida:

![](<../../../.gitbook/assets/image (68).png>)

#### Ricerca/Scrittura

Puoi anche cercare e scrivere nella memoria con objection:
```bash
memory search "<pattern eg: 41 41 41 ?? 41>" (--string) (--offsets-only)
memory write "<address>" "<pattern eg: 41 41 41 41>" (--string)
```
### SQLite

Puoi utilizzare il comando `sqlite` per interagire con i database sqlite.

### Uscita
```bash
exit
```
## Cosa manca in Objection

* I metodi di hooking a volte fanno crashare l'applicazione (questo √® anche a causa di Frida).
* Non puoi utilizzare le istanze delle classi per chiamare le funzioni dell'istanza. E non puoi creare nuove istanze di classi e usarle per chiamare le funzioni.
* Non c'√® una scorciatoia (come quella per sslpinnin) per hookare tutti i metodi di crittografia comuni utilizzati dall'applicazione per vedere testo cifrato, testo in chiaro, chiavi, IV e algoritmi utilizzati.

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Suggerimento per bug bounty**: **iscriviti** a **Intigriti**, una piattaforma premium per bug bounty creata da hacker, per hacker! Unisciti a noi su [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) oggi stesso e inizia a guadagnare ricompense fino a **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) **e** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github repos.**

</details>
