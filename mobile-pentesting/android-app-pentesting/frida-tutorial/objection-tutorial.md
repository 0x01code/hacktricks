# Objection Tutoriaal

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PRs in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Bug bounty wenk**: **teken aan** vir **Intigriti**, 'n premium **bug bounty-platform wat deur hackers geskep is, vir hackers**! Sluit vandag by ons aan by [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks), en begin om belonings tot **$100,000** te verdien!

{% embed url="https://go.intigriti.com/hacktricks" %}

## **Inleiding**

**objection - Runtime Mobile Exploration**

**[Objection](https://github.com/sensepost/objection)** is 'n runtime mobiele verkenningstoolkit, aangedryf deur [Frida](https://www.frida.re). Dit is ontwikkel met die doel om te help om mobiele toepassings en hul sekuriteitsposisie te assesseer sonder die nodigheid van 'n jailbroken of rooted mobiele toestel.

**Nota:** Dit is nie 'n vorm van jailbreak / root-omseil nie. Deur `objection` te gebruik, word jy steeds beperk deur al die beperkings wat deur die toepaslike sandboks wat jy in die gesig staar, opgel√™ word.

### Hervat

Die **doel** van **objection** is om die gebruiker die **hoofaksies wat Frida bied**, te laat oproep. **Andersins** sal die gebruiker 'n **enkele skrips vir elke toepassing** wat hy wil toets, moet skep.

## Tutoriaal

Vir hierdie tutoriaal gaan ek die APK gebruik wat jy hier kan aflaai:

{% file src="../../../.gitbook/assets/app-release.zip" %}

Of vanaf sy [oorspronklike bewaarplek](https://github.com/asvid/FridaApp)(laai app-release.apk af)

### Installasie
```bash
pip3 install objection
```
### Verbinding

Maak 'n **gewone ADB-verbinding** en **begin** die **frida**-bediener op die toestel (en kontroleer dat frida in beide die kli√´nt en die bediener werk).

As jy 'n **geroote toestel** gebruik, moet jy die toepassing wat jy wil toets, kies binne die _**--gadget**_ opsie. in hierdie geval:
```bash
frida-ps -Uai
objection --gadget asvid.github.io.fridaapp explore
```
### Basiese Aksies

Nie alle moontlike bevele van objections sal in hierdie handleiding gelys word nie, slegs diegene wat ek as meer nuttig beskou het.

#### Omgewing

Sommige interessante inligting (soos wagwoorde of paaie) kan binne die omgewing gevind word.
```bash
env
```
![](<../../../.gitbook/assets/image (64).png>)

#### Frida Inligting
```bash
frida
```
![](<../../../.gitbook/assets/image (65).png>)

#### Oplaai/Aflaai
```bash
file download <remote path> [<local path>]
file upload <local path> [<remote path>]
```
#### Voer frida-skrip in

```javascript
Java.perform(function() {
  // Your code here
});
```

#### Hooking a method
```bash
import <local path frida-script>
```
#### SSLPinning

SSLPinning is 'n tegniek wat gebruik word om die vertroue in die SSL-sertifikate van 'n Android-toepassing te versterk. Dit verhoed dat 'n aanvaller 'n vals sertifikaat gebruik om kommunikasie tussen die toepassing en die bediener te onderskep of te manipuleer. SSLPinning kan gebruik word om die veiligheid van 'n toepassing te verhoog deur die risiko van man-in-die-middel-aanvalle te verminder.

Objection bied 'n handige funksie aan om SSLPinning te omseil. Dit maak gebruik van die Frida-raamwerk om die SSL-sertifikaatverifikasieproses in die toepassing te onderskep en te manipuleer. Hierdie tegniek maak dit moontlik om 'n vals sertifikaat te gebruik sonder dat die toepassing dit besef.

Om SSLPinning met Objection te omseil, moet jy die volgende stappe volg:

1. Installeer Objection en die nodige afhanklikhede.
2. Begin die Frida-server op die doeltoestel.
3. Verbind Objection met die toepassing wat jy wil ondersoek.
4. Gebruik die `sslpinning disable`-bevel om SSLPinning te omseil.

Met hierdie tegniek kan jy die SSLPinning-meganisme van 'n Android-toepassing omseil en die kommunikasie tussen die toepassing en die bediener onderskep en manipuleer. Dit kan nuttig wees vir pentesters en ontwikkelaars om die veiligheid van hul toepassings te evalueer en te verbeter.
```bash
android sslpinning disable #Attempts to disable SSL Pinning on Android devices.
```
#### Root opsporing

Root-detectie is een belangrijk aspect van Android-app pentesting. Het verwijst naar het proces van het identificeren van of een Android-apparaat is geroot of niet. Een geroot apparaat kan de beveiligingsmaatregelen van een app omzeilen en mogelijk ongeautoriseerde toegang tot gevoelige gegevens mogelijk maken.

Er zijn verschillende technieken die kunnen worden gebruikt om root-detectie uit te voeren, zoals het controleren van de aanwezigheid van bekende root-bestanden, het controleren van de aanwezigheid van root-apps of het controleren van de status van de SELinux-beveiligingsfunctie.

Het is belangrijk om root-detectie uit te voeren tijdens het pentesten van een Android-app, omdat het helpt bij het identificeren van mogelijke beveiligingslekken en het nemen van de juiste maatregelen om deze te verhelpen.
```bash
android root disable  #Attempts to disable root detection on Android devices.
android root simulate #Attempts to simulate a rooted Android environment.
```
#### Uitvoeringsopdrag

The `exec` command in Objection allows you to execute shell commands on the target Android device. This can be useful for performing various actions during a mobile penetration test.

To use the `exec` command, you need to have a Frida session established with the target application. Once you have the session, you can run shell commands by using the following syntax:

```
objection> exec <command>
```

Replace `<command>` with the shell command you want to execute. For example, if you want to list the files in the current directory, you can use the `ls` command:

```
objection> exec ls
```

The output of the command will be displayed in the Objection console. You can use this command to perform tasks such as exploring the file system, checking the device's network configuration, or executing other shell commands to gather information during your mobile penetration test.

It's important to note that the `exec` command runs the shell command on the target device, so be cautious when executing commands that may have unintended consequences. Always ensure that you have the necessary permissions and authorization to perform the actions you intend to take.
```bash
android shell_exec whoami
```
#### Skermskote
```bash
android ui screenshot /tmp/screenshot
android ui FLAG_SECURE false  #This may enable you to take screenshots using the hardware keys
```
### Statische analise gemaak Dinamies

In 'n werklike toepassing moet ons al die inligting wat in hierdie gedeelte ontdek is, ken voordat ons objection gebruik, dankie aan **statische analise**. In elk geval kan jy dalk **iets nuuts sien** hier, aangesien jy slegs 'n volledige lys van klasse, metodes en uitgevoerde objekte sal h√™.

Dit is ook nuttig as jy op een of ander manier **nie toegang tot leesbare bronkode** van die app kan kry nie.

#### Lys aktiwiteite, ontvangers en dienste
```bash
android hooking list activities
```
![](<../../../.gitbook/assets/image (78).png>)
```bash
android hooking list services
android hooking list receivers
```
Frida sal 'n fout lewer as daar geen aktiwiteit gevind word

#### Kry huidige aktiwiteit
```bash
android hooking get current_activity
```
#### Soek Klasses

Laten ons begin om vir klasse binne ons toepassing te soek
```bash
android hooking search classes asvid.github.io.fridaapp
```
![](<../../../.gitbook/assets/image (69).png>)

#### Soekmetodes van 'n klas

Nou laat ons die metodes binne die klas _MainActivity_ onttrek:
```bash
android hooking search methods asvid.github.io.fridaapp MainActivity
```
![](<../../../.gitbook/assets/image (70) (1).png>)

#### Lys gedeclareerde Metodes van 'n klas met hul parameters

Laten ons uitvind watter parameters die metodes van die klas benodig:
```bash
android hooking list class_methods asvid.github.io.fridaapp.MainActivity
```
![](<../../../.gitbook/assets/image (79).png>)

#### Lys klasse

Jy kan ook 'n lys van al die klasse wat gelaai is binne die huidige toepassing lys:
```bash
android hooking list classes #List all loaded classes, As the target application gets usedmore, this command will return more classes.
```
Dit is baie nuttig as jy die metode van 'n klas wil **hook en jy ken net die naam van die klas**. Jy kan hierdie funksie gebruik om **te soek watter module die klas besit** en dan sy metode te hook.

### Hooking is maklik

#### Hooking (kyk) 'n metode

Vanuit die [bronkode](https://github.com/asvid/FridaApp/blob/master/app/src/main/java/asvid/github/io/fridaapp/MainActivity.kt) van die toepassing weet ons dat die **funksie** _**sum()**_ **vanaf** _**MainActivity**_ elke sekonde uitgevoer word. Laat ons probeer om **alle moontlike inligting** elke keer as die funksie geroep word te dump (argumente, terugkeerwaarde en backtrace):
```bash
android hooking watch class_method asvid.github.io.fridaapp.MainActivity.sum --dump-args --dump-backtrace --dump-return
```
![](<../../../.gitbook/assets/image (71).png>)

#### Hooking (watching) 'n hele klas

Eintlik vind ek al die metodes van die klas MainActivity baie interessant, laat ons **hulle almal hook**. Wees versigtig, dit kan 'n toepassing **crash**.
```bash
android hooking watch class asvid.github.io.fridaapp.MainActivity --dump-args --dump-return
```
As jy speel met die aansoek terwyl die klas gehook is, sal jy sien wanneer **elke funksie geroep word**, sy **argumente** en die **terugkeerwaarde**.

![](<../../../.gitbook/assets/image (72).png>)

#### Verander die booleaanse terugkeerwaarde van 'n funksie

Vanuit die bronkode kan jy sien dat die funksie _checkPin_ 'n _String_ as argument kry en 'n _boolean_ teruggee. Laat ons die funksie **altyd waar** maak:

![](<../../../.gitbook/assets/image (74).png>)

Nou, as jy iets in die teksboks vir die PIN-kode skryf, sal jy sien dat enigiets geldig is:

![](<../../../.gitbook/assets/image (77).png>)

### Klasinstansies

Soek na en druk **lewende instansies van 'n spesifieke Java-klas** af, gespesifiseer deur 'n volledig gekwalifiseerde klasnaam. Out is die resultaat van 'n poging om 'n stringwaarde vir 'n ontdekte beswaar te kry wat tipies **eiendomswaardes vir die objek** sou bevat.
```
android heap print_instances <class>
```
![](<../../../.gitbook/assets/image (80).png>)

### Keystore/Intents

Jy kan speel met die keystore en intents deur gebruik te maak van:
```bash
android keystore list
android intents launch_activity
android intent launch_service
```
#### Uitleg

Die `dump`-bevel word gebruik om die inhoud van die geheue van 'n Android-toepassing te onttrek. Hierdie bevel kan gebruik word om sensitiewe inligting soos wagwoorde, sleutels en ander geheime te onthul.

#### Gebruik

Om die geheue van 'n Android-toepassing te dump, gebruik die volgende bevel:

```plaintext
dump <klassenaam>
```

Hier is 'n voorbeeld van hoe om die geheue van 'n toepassing met die klassenaam `com.example.app` te dump:

```plaintext
dump com.example.app
```

Die uitset van die `dump`-bevel sal die inhoud van die geheue van die toepassing wees. Dit kan gebruik word om sensitiewe inligting te ondersoek en te analiseer.
```bash
memory dump all <local destination> #Dump all memory
memory dump from_base <base_address> <size_to_dump> <local_destination> #Dump a part
```
#### Lys
```bash
memory list modules
```
![](<../../../.gitbook/assets/image (66).png>)

Aan die onderkant van die lys kan jy frida sien:

![](<../../../.gitbook/assets/image (67).png>)

Laat ons kyk wat frida uitvoer:

![](<../../../.gitbook/assets/image (68).png>)

#### Soek/Skryf

Jy kan ook soek en skryf binne die geheue met objection:
```bash
memory search "<pattern eg: 41 41 41 ?? 41>" (--string) (--offsets-only)
memory write "<address>" "<pattern eg: 41 41 41 41>" (--string)
```
### SQLite

Jy kan die opdrag `sqlite` gebruik om met sqlite databasisse te kommunikeer.

### Uitgang
```bash
exit
```
## Wat ek mis in Objection

* Die hakmetodes laat soms die toepassing afkraak (dit is ook as gevolg van Frida).
* Jy kan nie die instansies van die klasse gebruik om funksies van die instansie te roep nie. En jy kan nie nuwe instansies van klasse skep en dit gebruik om funksies te roep nie.
* Daar is nie 'n kortpad (soos die een vir sslpinnin) om al die algemene kriptografiese metodes wat deur die toepassing gebruik word, te hak om gekripteerde teks, plain teks, sleutels, IV's en gebruikte algoritmes te sien nie.

<img src="../../../.gitbook/assets/i3.png" alt="" data-size="original">

**Bug bounty wenk**: **Teken aan** vir **Intigriti**, 'n premium **bug bounty platform wat deur hackers geskep is, vir hackers!** Sluit vandag by ons aan by [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks), en begin om belonings tot **$100,000** te verdien!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>Leer AWS hakwerk van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslagplekke.

</details>
