# –ü–æ—Å—ñ–±–Ω–∏–∫ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Frida

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>

<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**–ü—ñ–¥–∫–∞–∑–∫–∞ —â–æ–¥–æ –±–∞–≥—ñ–≤**: **–∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—è** –Ω–∞ **Intigriti**, –ø—Ä–µ–º—ñ–∞–ª—å–Ω—ñ–π **–ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ –¥–ª—è –±–∞–≥-–±–∞—É–Ω—Ç—ñ, —Å—Ç–≤–æ—Ä–µ–Ω—ñ–π —Ö–∞–∫–µ—Ä–∞–º–∏ –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤**! –ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) —Å—å–æ–≥–æ–¥–Ω—ñ, —ñ –ø–æ—á–Ω—ñ—Ç—å –∑–∞—Ä–æ–±–ª—è—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –¥–æ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å **—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ frida**:
```bash
pip install frida-tools
pip install frida
```
**–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å** –Ω–∞ Android **—Å–µ—Ä–≤–µ—Ä frida** ([–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –æ—Å—Ç–∞–Ω–Ω—é –≤–µ—Ä—Å—ñ—é](https://github.com/frida/frida/releases)).\
–û–¥–Ω–æ—Ä—è–¥–∫–æ–≤–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É adb —É —Ä–µ–∂–∏–º—ñ root, –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –Ω—å–æ–≥–æ, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è frida-server, –Ω–∞–¥–∞–Ω–Ω—è –ø—Ä–∞–≤ –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫—É –π–æ–≥–æ —É —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ:

{% code overflow="wrap" %}
```bash
adb root; adb connect localhost:6000; sleep 1; adb push frida-server /data/local/tmp/; adb shell "chmod 755 /data/local/tmp/frida-server"; adb shell "/data/local/tmp/frida-server &"
```
{% endcode %}

**–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ**, —á–∏ **–ø—Ä–∞—Ü—é—î**:
```bash
frida-ps -U #List packages and processes
frida-ps -U | grep -i <part_of_the_package_name> #Get all the package name
```
## –ü–æ—Å—ñ–±–Ω–∏–∫–∏

### [–ü–æ—Å—ñ–±–Ω–∏–∫ 1](frida-tutorial-1.md)

**–ó**: [https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1](https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1)\
**APK**: [https://github.com/t0thkr1s/frida-demo/releases](https://github.com/t0thkr1s/frida-demo/releases)\
**–í–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥**: [https://github.com/t0thkr1s/frida-demo](https://github.com/t0thkr1s/frida-demo)

**–ü–µ—Ä–µ–π–¥—ñ—Ç—å –∑–∞ [–ø–æ—Å–∏–ª–∞–Ω–Ω—è–º, —â–æ–± –ø—Ä–æ—á–∏—Ç–∞—Ç–∏](frida-tutorial-1.md).**

### [–ü–æ—Å—ñ–±–Ω–∏–∫ 2](frida-tutorial-2.md)

**–ó**: [https://11x256.github.io/Frida-hooking-android-part-2/](https://11x256.github.io/Frida-hooking-android-part-2/) (–ß–∞—Å—Ç–∏–Ω–∏ 2, 3 —Ç–∞ 4)\
**APK —Ç–∞ –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥**: [https://github.com/11x256/frida-android-examples](https://github.com/11x256/frida-android-examples)

**–ü–µ—Ä–µ–π–¥—ñ—Ç—å –∑–∞ [–ø–æ—Å–∏–ª–∞–Ω–Ω—è–º, —â–æ–± –ø—Ä–æ—á–∏—Ç–∞—Ç–∏.](frida-tutorial-2.md)**

### [–ü–æ—Å—ñ–±–Ω–∏–∫ 3](owaspuncrackable-1.md)

**–ó**: [https://joshspicer.com/android-frida-1](https://joshspicer.com/android-frida-1)\
**APK**: [https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/Android/Level\_01/UnCrackable-Level1.apk](https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/Android/Level\_01/UnCrackable-Level1.apk)

**–ü–µ—Ä–µ–π–¥—ñ—Ç—å –∑–∞ [–ø–æ—Å–∏–ª–∞–Ω–Ω—è–º, —â–æ–± –ø—Ä–æ—á–∏—Ç–∞—Ç–∏](owaspuncrackable-1.md).**

**–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –±—ñ–ª—å—à–µ —á—É–¥–æ–≤–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤ Frida —Ç—É—Ç:** [**https://codeshare.frida.re/**](https://codeshare.frida.re)

## –®–≤–∏–¥–∫—ñ –ü—Ä–∏–∫–ª–∞–¥–∏

### –í–∏–∫–ª–∏–∫ Frida –∑ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞
```bash
frida-ps -U

#Basic frida hooking
frida -l disableRoot.js -f owasp.mstg.uncrackable1

#Hooking before starting the app
frida -U --no-pause -l disableRoot.js -f owasp.mstg.uncrackable1
#The --no-pause and -f options allow the app to be spawned automatically,
#frozen so that the instrumentation can occur, and the automatically
#continue execution with our modified code.
```
### –ë–∞–∑–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç Python
```python
import frida, sys

jscode = open(sys.argv[0]).read()
process = frida.get_usb_device().attach('infosecadventures.fridademo')
script = process.create_script(jscode)
print('[ * ] Running Frida Demo application')
script.load()
sys.stdin.read()
```
### –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤

–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é `a()` –∫–ª–∞—Å—É `sg.vantagepoint.a.c`
```javascript
Java.perform(function () {
;  rootcheck1.a.overload().implementation = function() {
rootcheck1.a.overload().implementation = function() {
send("sg.vantagepoint.a.c.a()Z   Root check 1 HIT!  su.exists()");
return false;
};
});
```
–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å java `exit()`
```javascript
var sysexit = Java.use("java.lang.System");
sysexit.exit.overload("int").implementation = function(var_0) {
send("java.lang.System.exit(I)V  // We avoid exiting the application  :)");
};
```
–ó–∞—Ö–æ–ø–ª–µ–Ω–Ω—è MainActivity `.onStart()` —Ç–∞ `.onCreate()`
```javascript
var mainactivity = Java.use("sg.vantagepoint.uncrackable1.MainActivity");
mainactivity.onStart.overload().implementation = function() {
send("MainActivity.onStart() HIT!!!");
var ret = this.onStart.overload().call(this);
};
mainactivity.onCreate.overload("android.os.Bundle").implementation = function(var_0) {
send("MainActivity.onCreate() HIT!!!");
var ret = this.onCreate.overload("android.os.Bundle").call(this,var_0);
};
```
–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å android `.onCreate()`
```javascript
var activity = Java.use("android.app.Activity");
activity.onCreate.overload("android.os.Bundle").implementation = function(var_0) {
send("Activity HIT!!!");
var ret = this.onCreate.overload("android.os.Bundle").call(this,var_0);
};
```
### –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è

–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è. –í–∏–≤–µ–¥–µ–Ω–Ω—è –≤–≤–µ–¥–µ–Ω–Ω—è, –≤–∏–∫–ª–∏–∫ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –≤–≤–µ–¥–µ–Ω–Ω—è —Ç–∞, –Ω–∞—Ä–µ—à—Ç—ñ, –≤–∏–≤–µ–¥–µ–Ω–Ω—è —á–∏—Å—Ç–∏—Ö –¥–∞–Ω–∏—Ö:
```javascript
function getString(data){
var ret = "";
for (var i=0; i < data.length; i++){
ret += data[i].toString();
}
return ret
}
var aes_decrypt = Java.use("sg.vantagepoint.a.a");
aes_decrypt.a.overload("[B","[B").implementation = function(var_0,var_1) {
send("sg.vantagepoint.a.a.a([B[B)[B   doFinal(enc)  // AES/ECB/PKCS7Padding");
send("Key       : " + getString(var_0));
send("Encrypted : " + getString(var_1));
var ret = this.a.overload("[B","[B").call(this,var_0,var_1);
send("Decrypted : " + ret);

var flag = "";
for (var i=0; i < ret.length; i++){
flag += String.fromCharCode(ret[i]);
}
send("Decrypted flag: " + flag);
return ret; //[B
};
```
### –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π —Ç–∞ —ó—Ö –≤–∏–∫–ª–∏–∫ –∑ –Ω–∞—à–∏–º –≤–≤–µ–¥–µ–Ω–Ω—è–º

–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –æ—Ç—Ä–∏–º—É—î —Ä—è–¥–æ–∫, —ñ –≤–∏–∫–ª–∏—á—Ç–µ —ó—ó –∑ —ñ–Ω—à–∏–º —Ä—è–¥–∫–æ–º (–∑ [—Ç—É—Ç](https://11x256.github.io/Frida-hooking-android-part-2/))
```javascript
var string_class = Java.use("java.lang.String"); // get a JS wrapper for java's String class

my_class.fun.overload("java.lang.String").implementation = function(x){ //hooking the new function
var my_string = string_class.$new("My TeSt String#####"); //creating a new String by using `new` operator
console.log("Original arg: " +x );
var ret =  this.fun(my_string); // calling the original function with the new String, and putting its return value in ret variable
console.log("Return value: "+ret);
return ret;
};
```
### –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–∂–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –æ–±'—î–∫—Ç–∞ –∫–ª–∞—Å—É

–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏—Ç—è–≥–Ω—É—Ç–∏ –¥–µ—è–∫–∏–π –∞—Ç—Ä–∏–±—É—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –æ–±'—î–∫—Ç–∞, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ.

–£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ, —è–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ –æ–±'—î–∫—Ç –∫–ª–∞—Å—É my\_activity —Ç–∞ —è–∫ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é .secret(), —è–∫–∞ –≤–∏–≤–µ–¥–µ –Ω–∞ –µ–∫—Ä–∞–Ω –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∞—Ç—Ä–∏–±—É—Ç –æ–±'—î–∫—Ç–∞:
```javascript
Java.choose("com.example.a11x256.frida_test.my_activity" , {
onMatch : function(instance){ //This function will be called for every instance found by frida
console.log("Found instance: "+instance);
console.log("Result of secret func: " + instance.secret());
},
onComplete:function(){}
});
```
## –Ü–Ω—à—ñ –ø–æ—Å—ñ–±–Ω–∏–∫–∏ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Frida

* [https://github.com/DERE-ad2001/Frida-Labs](https://github.com/DERE-ad2001/Frida-Labs)
* [–ß–∞—Å—Ç–∏–Ω–∞ 1 —Å–µ—Ä—ñ—ó –±–ª–æ–≥—ñ–≤ –ø—Ä–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Frida: –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è IOS](https://8ksec.io/advanced-frida-usage-part-1-ios-encryption-libraries-8ksec-blogs/)



<figure><img src="../../../.gitbook/assets/i3.png" alt=""><figcaption></figcaption></figure>

**–ü—ñ–¥–∫–∞–∑–∫–∞ —â–æ–¥–æ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –∑–∞ –ø–æ–º–∏–ª–∫–∏**: **–∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—å** –Ω–∞ **Intigriti**, –ø—Ä–µ–º—ñ–∞–ª—å–Ω—ñ–π **–ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ –¥–ª—è –≤–∏–Ω–∞–≥–æ—Ä–æ–¥ –∑–∞ –ø–æ–º–∏–ª–∫–∏, —Å—Ç–≤–æ—Ä–µ–Ω—ñ–π —Ö–∞–∫–µ—Ä–∞–º–∏ –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤**! –ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) —Å—å–æ–≥–æ–¥–Ω—ñ, —ñ –ø–æ—á–Ω—ñ—Ç—å –∑–∞—Ä–æ–±–ª—è—Ç–∏ –≤–∏–Ω–∞–≥–æ—Ä–æ–¥–∏ –¥–æ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —Å–≤–æ—é **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>
