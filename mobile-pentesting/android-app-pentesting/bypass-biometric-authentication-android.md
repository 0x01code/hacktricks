# Bypass Biometriese Verifikasie (Android)


<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Werk jy in 'n **cybersecurity-maatskappy**? Wil jy jou **maatskappy adverteer in HackTricks**? Of wil jy toegang h√™ tot die **nuutste weergawe van die PEASS of HackTricks aflaai in PDF-formaat**? Kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Sluit aan by die** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** my op **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die [hacktricks repo](https://github.com/carlospolop/hacktricks) en [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

## **Metode 1 - Bypassing sonder Crypto Object-gebruik**

Die fokus hier is op die *onAuthenticationSucceeded* terugroep, wat krities is in die verifikasieproses. Navorsers by WithSecure het 'n [Frida-skrip](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js) ontwikkel wat die omseiling van die NULL *CryptoObject* in *onAuthenticationSucceeded(...)* moontlik maak. Die skrip dwing 'n outomatiese omseiling van die vingerafdrukverifikasie by die oproep van die metode. Hieronder is 'n vereenvoudigde snipper wat die omseiling demonstreer in 'n Android Vingerafdruk-konteks, met die volledige toepassing beskikbaar op [GitHub](https://github.com/St3v3nsS/InsecureBanking).
```javascript
biometricPrompt = new BiometricPrompt(this, executor, new BiometricPrompt.AuthenticationCallback() {
@Override
public void onAuthenticationSucceeded(@NonNull BiometricPrompt.AuthenticationResult result) {
Toast.makeText(MainActivity.this,"Success",Toast.LENGTH_LONG).show();
}
});
```
Opdrag om die Frida-skripsie uit te voer:
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass.js
```
## **Metode 2 - Uitsonderingshanteringbenadering**

'n Ander [Frida-skripsie](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass-via-exception-handling.js) deur WithSecure spreek die omseiling van onveilige kriptografiese objekgebruik aan. Die skripsie roep *onAuthenticationSucceeded* aan met 'n *CryptoObject* wat nie deur 'n vingerafdruk geoutoriseer is nie. As die toepassing probeer om 'n ander chiffreerobjek te gebruik, sal dit 'n uitsondering veroorsaak. Die skripsie berei voor om *onAuthenticationSucceeded* aan te roep en die *javax.crypto.IllegalBlockSizeException* in die _Cipher_-klas te hanteer, om te verseker dat daaropvolgende objekte wat deur die toepassing gebruik word, met die nuwe sleutel versleutel word.

Opdrag om die Frida-skripsie uit te voer:
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass-via-exception-handling.js
```
By die vingerafdruk skerm te bereik en die begin van `authenticate()`, tik `bypass()` in die Frida konsole om die omweg te aktiveer:
```
Spawning com.generic.insecurebankingfingerprint...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> Hooking BiometricPrompt.authenticate()...
Hooking BiometricPrompt.authenticate2()...
Hooking FingerprintManager.authenticate()...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> bypass()
```
## **Metode 3 - Instrumentasie Raamwerke**

Instrumentasie raamwerke soos Xposed of Frida kan gebruik word om in te haak by toepassingsmetodes tydens uitvoering. Vir vingerafdrukverifikasie kan hierdie raamwerke:

1. **Naboots die Verifikasie Terugroepings**: Deur in te haak by die `onAuthenticationSucceeded`, `onAuthenticationFailed`, of `onAuthenticationError` metodes van die `BiometricPrompt.AuthenticationCallback`, kan jy die uitkoms van die vingerafdrukverifikasieproses beheer.
2. **Bypass SSL Pinning**: Dit stel 'n aanvaller in staat om die verkeer tussen die kli√´nt en die bediener te onderskep en te wysig, moontlik die verifikasieproses te verander of sensitiewe data te steel.

Voorbeeldopdrag vir Frida:
```bash
frida -U -l script-to-bypass-authentication.js --no-pause -f com.generic.in
```
## **Metode 4 - Omgekeerde Ingenieurswese & Kode Wysiging**

Omgekeerde ingenieurswese hulpmiddels soos `APKTool`, `dex2jar`, en `JD-GUI` kan gebruik word om 'n Android-toepassing te dekompilieer, sy bronkode te lees, en sy outentiseringsmeganisme te verstaan. Die stappe behels gewoonlik die volgende:

1. **Dekompilering van die APK**: Omskakeling van die APK-l√™er na 'n meer mensleesbare formaat (soos Java-kode).
2. **Analise van die Kode**: Soek na die implementering van vingerafdruk-outentisering en identifiseer potensi√´le swakpunte (soos terugvalmeganismes of onvanpaste valideringskontroles).
3. **Heropbou van die APK**: Nadat die kode gewysig is om vingerafdruk-outentisering te omseil, word die toepassing heropgebou, onderteken, en op die toestel ge√Ønstalleer vir toetsdoeleindes.

## **Metode 5 - Gebruik van Aangepaste Outentiseringshulpmiddels**

Daar is gespesialiseerde hulpmiddels en skripte ontwerp om outentiseringmeganismes te toets en te omseil. Byvoorbeeld:

1. **MAGISK-modules**: MAGISK is 'n hulpmiddel vir Android wat gebruikers in staat stel om hul toestelle te root en modules by te voeg wat hardewarevlak-inligting, insluitend vingerafdrukke, kan wysig of vervals.
2. **Aangepaste Skripte**: Skripte kan geskryf word om te kommunikeer met die Android Debug Bridge (ADB) of direk met die toepassing se agterkant om vingerafdruk-outentisering te simuleer of te omseil.

## Verwysings
* [https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/](https://securitycafe.ro/2022/09/05/mobile-pentesting-101-bypassing-biometric-authentication/)

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Werk jy in 'n **cybersekuriteitsmaatskappy**? Wil jy jou **maatskappy adverteer in HackTricks**? Of wil jy toegang h√™ tot die **nuutste weergawe van die PEASS of HackTricks aflaai in PDF-formaat**? Kyk na die [**SUBSKRIPSIEPLANNE**](https://github.com/sponsors/carlospolop)!
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFT's**](https://opensea.io/collection/the-peass-family)
* Kry die [**amptelike PEASS & HackTricks-uitrusting**](https://peass.creator-spring.com)
* **Sluit aan by die** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** my op **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die [hacktricks repo](https://github.com/carlospolop/hacktricks) en [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
