# Biyometrik Kimlik Doğrulamayı Atlatma (Android)


<details>

<summary><strong>AWS hacklemeyi sıfırdan kahramanla öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

* Bir **cybersecurity şirketinde** çalışıyor musunuz? **Şirketinizi HackTricks'te reklamını görmek** ister misiniz? veya **PEASS'ın en son sürümüne veya HackTricks'i PDF olarak indirmek** ister misiniz? [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonunu
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) alın
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter**'da takip edin 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Hacking hilelerinizi [hacktricks repo](https://github.com/carlospolop/hacktricks) ve [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)'ya PR göndererek paylaşın**.

</details>

## **Yöntem 1 - Şifreleme Nesnesi Kullanmadan Atlatma**

Burada odak noktası, kimlik doğrulama sürecinde önemli olan *onAuthenticationSucceeded* geri çağırma işlevindedir. WithSecure araştırmacıları, *onAuthenticationSucceeded(...)* içindeki NULL *CryptoObject*'i atlatmayı sağlayan bir [Frida betiği](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js) geliştirdi. Betik, yöntemin çağrılmasıyla parmak izi doğrulamasının otomatik olarak atlatılmasını zorlar. Aşağıda, Android Parmak İzi bağlamında atlatmanın basitleştirilmiş bir örneği bulunmaktadır ve tam uygulama [GitHub](https://github.com/St3v3nsS/InsecureBanking)'da mevcuttur.
```javascript
biometricPrompt = new BiometricPrompt(this, executor, new BiometricPrompt.AuthenticationCallback() {
@Override
public void onAuthenticationSucceeded(@NonNull BiometricPrompt.AuthenticationResult result) {
Toast.makeText(MainActivity.this,"Success",Toast.LENGTH_LONG).show();
}
});
```
Frida betiği çalıştırmak için komut:
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass.js
```
## **Yöntem 2 - İstisna İşleme Yaklaşımı**

WithSecure tarafından geliştirilen başka bir [Frida betiği](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass-via-exception-handling.js), güvensiz şifreleme nesnesi kullanımını atlamayı ele almaktadır. Betik, parmak izi tarafından yetkilendirilmemiş bir *CryptoObject* ile *onAuthenticationSucceeded* çağırır. Uygulama farklı bir şifreleme nesnesi kullanmaya çalışırsa, bir istisna tetikleyecektir. Betik, *Cipher* sınıfındaki *javax.crypto.IllegalBlockSizeException* istisnasını işlemek için *onAuthenticationSucceeded* çağrısını hazırlar ve uygulama tarafından kullanılan sonraki nesnelerin yeni anahtarla şifrelenmesini sağlar.

Frida betiğini çalıştırmak için kullanılacak komut:
```bash
frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass-via-exception-handling.js
```
Frida konsolunda `bypass()` yazarak bypass'ı etkinleştirmek için parmak izi ekranına ulaşın ve `authenticate()` başlatın:
```
Spawning com.generic.insecurebankingfingerprint...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> Hooking BiometricPrompt.authenticate()...
Hooking BiometricPrompt.authenticate2()...
Hooking FingerprintManager.authenticate()...
[Android Emulator 5554::com.generic.insecurebankingfingerprint]-> bypass()
```
## **Yöntem 3 - Enstrümantasyon Çerçeveleri**

Xposed veya Frida gibi enstrümantasyon çerçeveleri, çalışma zamanında uygulama yöntemlerine bağlanmak için kullanılabilir. Parmak izi doğrulaması için, bu çerçeveler şunları yapabilir:

1. **Kimlik Doğrulama Geri Çağrılarını Sahteleyin**: `BiometricPrompt.AuthenticationCallback`'in `onAuthenticationSucceeded`, `onAuthenticationFailed` veya `onAuthenticationError` yöntemlerine bağlanarak, parmak izi doğrulama sürecinin sonucunu kontrol edebilirsiniz.
2. **SSL Pinning'i Atlayın**: Bu, bir saldırganın istemci ve sunucu arasındaki trafiği dinlemesine ve değiştirmesine olanak tanır, bu da kimlik doğrulama sürecini değiştirebilir veya hassas verileri çalabilir.

Frida için örnek komut:
```bash
frida -U -l script-to-bypass-authentication.js --no-pause -f com.generic.in
```
## **Yöntem 4 - Tersine Mühendislik ve Kod Değiştirme**

`APKTool`, `dex2jar` ve `JD-GUI` gibi tersine mühendislik araçları kullanılarak bir Android uygulaması decompile edilebilir, kaynak kodu okunabilir hale getirilebilir ve kimlik doğrulama mekanizması anlaşılabilir. Adımlar genellikle şunları içerir:

1. **APK'nın decompile edilmesi**: APK dosyası daha insan tarafından okunabilir bir formata (örneğin Java kodu) dönüştürülür.
2. **Kodun Analiz Edilmesi**: Parmak izi doğrulama uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının uygulamasının
