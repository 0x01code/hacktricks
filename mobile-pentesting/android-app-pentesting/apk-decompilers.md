# D√©compilateurs APK

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## [JD-Gui](https://github.com/java-decompiler/jd-gui)

Le premier d√©compilateur Java gui c√©l√®bre, vous pouvez l'utiliser pour examiner le code Java de l'APK une fois que vous l'avez obtenu.

## [Jadx](https://github.com/skylot/jadx)

D√©compilateur Java (multi-plateforme) int√©gr√© et en ce moment je pense que c'est celui recommand√©.\
Il suffit de **t√©l√©charger** la **derni√®re** version et de l'ex√©cuter √† partir du dossier _**bin**_:
```
jadx-gui
```
En utilisant l'interface graphique, vous pouvez effectuer une **recherche de texte**, acc√©der aux **d√©finitions de fonctions** (_CTRL + clic gauche_ sur la fonction) et aux r√©f√©rences crois√©es (_clic droit_ --> _Rechercher l'utilisation_).

Si vous voulez **seulement** le **code Java** mais sans utiliser une interface graphique, une m√©thode tr√®s simple est d'utiliser l'outil de ligne de commande jadx :
```
jadx app.apk
```
Quelques **options int√©ressantes de jadx** (versions GUI et CLI) sont :
```
-d <path to output dir>
--no-res #No resources
--no-src #No source code
--no-imports #Always write entire package name (very useful to know where is the function that you might want to hook)
```
## [Outil de r√©tro-ing√©nierie GDA-android](https://github.com/charles2gan/GDA-android-reversing-Tool)

GDA est √©galement une plateforme d'analyse inverse puissante et rapide. Elle ne prend pas en charge uniquement les op√©rations de d√©compilation de base, mais √©galement de nombreuses fonctions excellentes telles que la **d√©tection de comportements malveillants, la d√©tection de fuites de confidentialit√©, la d√©tection de vuln√©rabilit√©s, la r√©solution de chemin, l'identification de packer, l'analyse de suivi de variable, la d√©sobfuscation, les scripts Python et Java, l'extraction de la m√©moire de l'appareil, le chiffrement et le d√©chiffrement de donn√©es**, etc.

**Uniquement pour Windows.**

![](<../../.gitbook/assets/image (207) (1) (1).png>)

## [Visionneuse de bytecode](https://github.com/Konloch/bytecode-viewer/releases)

Un autre **outil int√©ressant pour effectuer une analyse statique est** : [**bytecode-viewer**](https://github.com/Konloch/bytecode-viewer/releases)**.** Il vous permet de d√©compiler l'APK en utilisant **plusieurs d√©compilateurs en m√™me temps**. Ensuite, vous pouvez voir par exemple, 2 d√©compilateurs Java diff√©rents et un d√©compilateur Smali. Il vous permet √©galement de **modifier** le code :

![](<../../.gitbook/assets/image (82).png>)

Si vous modifiez le code, vous pouvez alors **l'exporter**.\
Un mauvais point de bytecode-viewer est qu'il **n'a pas de r√©f√©rences** ou de **r√©f√©rences crois√©es**.

## [**Enjarify**](https://github.com/Storyyeller/enjarify)

Enjarify est un outil de traduction du bytecode Dalvik en bytecode Java √©quivalent. Cela permet aux outils d'analyse Java d'analyser les applications Android.\
Dex2jar est un outil plus ancien qui tente √©galement de traduire Dalvik en bytecode Java. Il fonctionne raisonnablement bien la plupart du temps, mais de nombreuses fonctionnalit√©s obscures ou des cas limites le feront √©chouer ou m√™me produire des r√©sultats incorrects en silence. En revanche, Enjarify est con√ßu pour fonctionner dans le plus grand nombre de cas possible, m√™me pour le code o√π Dex2jar √©chouerait. Entre autres choses, Enjarify g√®re correctement les noms de classe Unicode, les constantes utilis√©es comme plusieurs types, les conversions implicites, les gestionnaires d'exceptions sautant dans le flux de contr√¥le normal, les classes qui font r√©f√©rence √† trop de constantes, les m√©thodes tr√®s longues, les gestionnaires d'exceptions apr√®s un gestionnaire catchall et les valeurs initiales statiques du mauvais type.

## [CFR](https://github.com/leibnitz27/cfr)

CFR d√©compilera les fonctionnalit√©s Java modernes - [y compris une grande partie de Java ](https://www.benf.org/other/cfr/java9observations.html)[9](https://github.com/leibnitz27/cfr/blob/master/java9stringconcat.html), [12](https://www.benf.org/other/cfr/switch\_expressions.html) & [14](https://www.benf.org/other/cfr/java14instanceof\_pattern), mais est enti√®rement √©crit en Java 6, donc fonctionnera partout ! ([FAQ](https://www.benf.org/other/cfr/faq.html)) - Il fera m√™me un bon travail en transformant les fichiers de classe d'autres langages JVM en Java !

Ce fichier JAR peut √™tre utilis√© comme suit :
```
java -jar ./cfr.jar "$JARFILE" --outputdir "$OUTDIR"
```
Pour les fichiers JAR plus volumineux, j'ai constat√© que la m√©moire √©tait insuffisante. Vous pouvez simplement adapter la taille du pool d'allocation de m√©moire du JVM si cela vous arrive √©galement.
```
java -Xmx4G -jar ./cfr.jar "$JARFILE" --outputdir "$OUTDIR"
```
Cet exemple permettra d'allouer un maximum de 4 Go.

Dans le r√©pertoire de sortie, vous trouverez les fichiers `.java` d√©compil√©s, ainsi qu'un r√©sum√© de la d√©compilation.

## [Fernflower](https://github.com/JetBrains/intellij-community/tree/master/plugins/java-decompiler/engine)

Ensuite, il y a [Fernflower](https://github.com/JetBrains/intellij-community/tree/master/plugins/java-decompiler/engine), qui fait partie de [IntelliJ IDEA](https://www.jetbrains.com/idea/). Tout le monde mentionne que c'est un d√©compilateur _analytique_ (comme indiqu√© dans leur description de projet), mais personne ne pr√©cise ce que cela signifie r√©ellement. J'ai seulement trouv√© [cette question Stackoverflow](https://stackoverflow.com/q/62298929), qui malheureusement reste sans r√©ponse √† ce jour.

Quoi qu'il en soit, comme il n'y a pas de versions autonomes, vous devez le construire vous-m√™me. En tant que projet bas√© sur [Gradle](https://gradle.org), vous pouvez le cloner et ex√©cuter la commande suivante, √† condition que Gradle soit install√© sur votre machine.
```
cd ./plugins/java-decompiler/engine && gradle jar
```
Ici, nous commen√ßons par changer notre r√©pertoire de travail vers le r√©pertoire racine de Fernflower. Ensuite, nous demandons √† Gradle de construire le fichier `./build/libs/fernflower.jar`.

L'invocation de Fernflower est similaire √† celle de CFR.
```
java -jar ./fernflower.jar "$JARFILE" "$OUTDIR"
```
Parmi les d√©compileurs d√©crits ici, c'est le seul qui g√©n√®re les fichiers `.java` dans un fichier JAR. Vous pouvez facilement extraire les fichiers sources en utilisant `unzip`.

## [Krakatau](https://github.com/Storyyeller/Krakatau)

Vous vous souvenez d'Enjarify ci-dessus ? Le m√™me auteur est √©galement le d√©veloppeur d'un d√©compileur nomm√© [Krakatau](https://github.com/Storyyeller/Krakatau).

Contrairement aux autres projets, celui-ci est √©crit en Python. Et je pense que c'est la raison pour laquelle il est un peu diff√©rent des autres.

Permettez-moi de citer [le README du projet](https://github.com/Storyyeller/Krakatau/blob/master/README.md).

> Ensuite, assurez-vous d'avoir des fichiers JAR contenant les d√©finitions (sic!) de toutes les classes externes (c'est-√†-dire les biblioth√®ques) qui pourraient √™tre r√©f√©renc√©es par le JAR que vous essayez de d√©compiler. Cela inclut les classes de la biblioth√®que standard (c'est-√†-dire JRT).

Et selon la description, ces classes de biblioth√®que standard sont fournies jusqu'√† la version 8 de Java sous la forme du fichier `rt.jar`. Pour les versions ult√©rieures, l'auteur fournit [jrt-extractor](https://github.com/Storyyeller/jrt-extractor), qui peut g√©n√©rer ce fichier pour nous.

Nous t√©l√©chargeons donc cet outil et ex√©cutons les commandes suivantes.
```
cd ./jrt-extractor
javac JRTExtractor.java
java -ea JRTExtractor
```
Cela devrait avoir √©crit un fichier `rt.jar` √† l'int√©rieur du r√©pertoire.

Avec ce fichier, nous pouvons ex√©cuter Krakatau comme suit.
```
./Krakatau/decompile.py -out "$OUTDIR" -skip -nauto -path ./jrt-extractor/rt.jar "$JARFILE"
```
Je vais me r√©f√©rer au GitHub du projet pour une explication des param√®tres. Notez simplement que pour toutes les biblioth√®ques utilis√©es par votre fichier JAR, Krakatau vous demandera de l'ajouter en tant que fichier JAR au drapeau `-path`.

## [procyon](https://github.com/mstrobel/procyon)

Une fois install√©, l'utilisation est simple.
```
procyon -jar "$JARFILE" -o "$OUTDIR"
```
## R√©f√©rences

{% embed url="https://eiken.dev/blog/2021/02/how-to-break-your-jar-in-2021-decompilation-guide-for-jars-and-apks/#cfr" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
