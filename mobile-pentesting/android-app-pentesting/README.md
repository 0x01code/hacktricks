# Android Uygulamaları Pentesting

<details>

<summary><strong>AWS hacklemeyi sıfırdan kahraman olmak için</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> öğrenin!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına **PR göndererek** paylaşın.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve ödül avcılarıyla iletişim kurmak için [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katılın!

**Hacking İçgörüleri**\
Hacking'in heyecanına ve zorluklarına dalmış içeriklerle etkileşim kurun

**Gerçek Zamanlı Hack Haberleri**\
Hızlı tempolu hacking dünyasını gerçek zamanlı haberler ve içgörülerle takip edin

**En Son Duyurular**\
Yeni ödül avcılarının başlatıldığı ve önemli platform güncellemelerinin olduğu en son duyurularla bilgilenin

**Bize katılın** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugün en iyi hackerlarla işbirliği yapmaya başlayın!

## Android Uygulamaları Temelleri

Android güvenliği ile ilgili **en önemli bölümleri ve bir Android uygulamasındaki en tehlikeli bileşenleri** öğrenmek için bu sayfayı okumak çok önerilir:

{% content-ref url="android-applications-basics.md" %}
[android-applications-basics.md](android-applications-basics.md)
{% endcontent-ref %}

## ADB (Android Debug Köprüsü)

Bu, bir Android cihaza (emüle veya fiziksel) bağlanmak için ihtiyaç duyduğunuz ana araçtır.\
**ADB**, cihazları bir bilgisayardan **USB** veya **Ağ** üzerinden kontrol etmeyi sağlar. Bu yardımcı program, dosyaların **iki yönde kopyalanmasını**, uygulamaların **kurulmasını ve kaldırılmasını**, kabuk komutlarının **yürütülmesini**, verilerin **yedeklenmesini**, günlüklerin **okunmasını** ve diğer işlevleri sağlar.

ADB'yi nasıl kullanacağınızı öğrenmek için aşağıdaki [**ADB Komutları**](adb-commands.md) listesine göz atın.

## Smali

Bazen **uygulama kodunu değiştirmek** ilginç olabilir ve **gizli bilgilere** (belki de iyi gizlenmiş şifreler veya bayraklar) erişmek için apk'yı decompile etmek, kodu değiştirmek ve yeniden derlemek ilginç olabilir.\
[**Bu öğreticide** apk'yı decompile etmeyi, Smali kodunu değiştirmeyi ve APK'yi yeniden derlemeyi **yeni işlevsellikle** öğrenebilirsiniz](smali-changes.md). Bu, sunulacak olan dinamik analiz sırasında **çeşitli testler için alternatif bir seçenek olabilir**. Bu nedenle, **her zaman bu olasılığı aklınızda bulundurun**.

## Diğer ilginç hileler

* [Play Store'da konumunuzu sahte yapma](spoofing-your-location-in-play-store.md)
* **APK'ları indirin**: [https://apps.evozi.com/apk-downloader/](https://apps.evozi.com/apk-downloader/), [https://apkpure.com/es/](https://apkpure.com/es/), [https://www.apkmirror.com/](https://www.apkmirror.com), [https://apkcombo.com/es-es/apk-downloader/](https://apkcombo.com/es-es/apk-downloader/)
* Cihazdan APK çıkarın:
```bash
adb shell pm list packages
com.android.insecurebankv2

adb shell pm path com.android.insecurebankv2
package:/data/app/com.android.insecurebankv2-Jnf8pNgwy3QA_U5f-n_4jQ==/base.apk

adb pull /data/app/com.android.insecurebankv2- Jnf8pNgwy3QA_U5f-n_4jQ==/base.apk
```
## Statik Analiz

Öncelikle, bir APK'yı analiz etmek için bir decompiler kullanarak Java koduna **bir göz atmalısınız**.\
Lütfen, [**farklı mevcut decompiler'lar hakkında bilgi edinmek için burayı okuyun**](apk-decompilers.md).

### İlgili Bilgileri Arama

APK'nın **strings**'lerine sadece bir göz atarak **şifreler**, **URL'ler** ([https://github.com/ndelphit/apkurlgrep](https://github.com/ndelphit/apkurlgrep)), **api** anahtarları, **şifreleme**, **bluetooth uuid'leri**, **token'lar** ve ilginç herhangi bir şey arayabilirsiniz... hatta kod yürütme **arka kapıları** veya kimlik doğrulama arka kapıları (uygulamaya hardcoded yönetici kimlik bilgileri).

**Firebase**

Özellikle **firebase URL'lerine** dikkat edin ve yanlış yapılandırılmış olup olmadığını kontrol edin. [Firebase'in ne olduğu ve nasıl sömürüleceği hakkında daha fazla bilgi için buraya bakın.](../../network-services-pentesting/pentesting-web/buckets/firebase-database.md)

### Uygulamanın Temel Anlayışı - Manifest.xml, strings.xml

Bir uygulamanın **Manifest.xml** ve **strings.xml** dosyalarının incelenmesi, potansiyel güvenlik açıklarını ortaya çıkarabilir. Bu dosyalara decompiler'lar kullanarak veya APK dosyasının uzantısını .zip olarak yeniden adlandırıp ardından açarak erişilebilirler.

**Manifest.xml**'den tespit edilen **güvenlik açıkları** şunları içerir:

* **Hata Ayıklanabilir Uygulamalar**: _Manifest.xml_ dosyasında `debuggable="true"` olarak ayarlanan uygulamalar, bağlantılara izin vererek sömürülmeye yol açar. Hata ayıklanabilir uygulamaları bulma ve sömürme konusunda daha fazla anlayış için bir cihazda hata ayıklanabilir uygulamaları bulma ve sömürme konusunda bir öğreticiye başvurun.

* **Yedekleme Ayarları**: Hassas bilgilerle uğraşan uygulamalar için `android:allowBackup="false"` özniteliği açıkça ayarlanmalıdır. Bu, usb hata ayıklama etkinleştirildiğinde adb aracılığıyla yetkisiz veri yedeklemelerini önlemek için gereklidir.

* **Ağ Güvenliği**: _res/xml/_ içindeki özel ağ güvenliği yapılandırmaları (`android:networkSecurityConfig="@xml/network_security_config"`) sertifika pinleri ve HTTP trafiği ayarları gibi güvenlik ayrıntılarını belirtebilir. Örneğin, belirli alanlar için HTTP trafiğine izin vermek gibi.

* **Dışa Aktarılan Etkinlikler ve Hizmetler**: Manifest'te dışa aktarılan etkinlikleri ve hizmetleri belirlemek, yanlış kullanılabilecek bileşenleri vurgulayabilir. Dinamik test sırasında daha fazla analiz, bu bileşenlerin nasıl sömürüleceğini ortaya çıkarabilir.

* **İçerik Sağlayıcıları ve Dosya Sağlayıcıları**: Açığa çıkarılan içerik sağlayıcılar, yetkisiz erişime veya veri değişikliğine izin verebilir. Dosya sağlayıcılarının yapılandırması da dikkatlice incelenmelidir.

* **Yayın Alıcıları ve URL Şemaları**: Bu bileşenler, özellikle URL şemalarının giriş açıklarına nasıl yönetildiğine dikkat edilerek sömürülebilir.

* **SDK Sürümleri**: `minSdkVersion`, `targetSDKVersion` ve `maxSdkVersion` öznitelikleri desteklenen Android sürümlerini gösterir ve güvenlik nedenleriyle güncellenmeyen, güvenlik açıklarına sahip Android sürümlerini desteklememenin önemini vurgular.

**strings.xml** dosyasından, API anahtarları, özel şemalar ve diğer geliştirici notları gibi hassas bilgiler keşfedilebilir, bu nedenle bu kaynakların dikkatli bir şekilde gözden geçirilmesi gereklidir.


### Tapjacking

**Tapjacking**, **kötü niyetli** bir **uygulamanın** başlatıldığı ve bir kurban uygulamanın üzerine yerleştiği bir saldırıdır. Kurban uygulamayı görünür şekilde engelledikten sonra, kullanıcı arayüzü, kullanıcıyı yanıltacak şekilde tasarlanır ve kullanıcının gerçekte kurban uygulamada eylemler gerçekleştirdiğini bilmeden etkileşimi kurban uygulamaya aktarır.\
Sonuç olarak, kullanıcının gerçekte kurban uygulamada eylemler gerçekleştirdiğini bilmeden kullanıcıyı kör eder.

Daha fazla bilgi için:

{% content-ref url="tapjacking.md" %}
[tapjacking.md](tapjacking.md)
{% endcontent-ref %}

### Görev Kaçırma

**`launchMode`** özelliği **`singleTask`** olarak ayarlanmış bir **etkinlik** ve tanımlanmış bir **`taskAffinity`** olmadan, görev kaçırmaya karşı savunmasızdır. Bu, bir **uygulamanın** yüklenmesi ve gerçek uygulamadan önce başlatılması durumunda, gerçek uygulamanın görevini **kaçırabileceği** anlamına gelir (bu nedenle kullanıcı, gerçek uygulamayı kullandığını düşünerek **kötü niyetli bir uygulama ile etkileşimde bulunur**).

Daha fazla bilgi için:

{% content-ref url="android-task-hijacking.md" %}
[android-task-hijacking.md](android-task-hijacking.md)
{% endcontent-ref %}

### Güvensiz veri depolama

**Dahili Depolama**

Android'de, dahili depolamada **saklanan** dosyaların yalnızca **onları oluşturan uygulama** tarafından **erişilebilir** olması amaçlanmıştır. Bu güvenlik önlemi, Android işletim sistemi tarafından uygulanır ve genellikle çoğu uygulamanın güvenlik ihtiyaçları için yeterlidir. Bununla birlikte, geliştiriciler bazen `MODE_WORLD_READABLE` ve `MODE_WORLD_WRITABLE` gibi modları kullanarak dosyaların farklı uygulamalar arasında **paylaşılmasına izin verir**. Ancak, bu modlar bu dosyalara diğer uygulamalar tarafından, potansiyel olarak kötü niyetli olanlar dahil olmak üzere **sınırlama getirmez**.

1. **Statik Analiz:**
- `MODE_WORLD_READABLE` ve `MODE_WORLD_WRITABLE` kullanımının **dikkatlice incelenmesini sağlayın**. Bu modlar, dosyaların **istenmeyen veya yetkisiz erişime** maruz kalmasına neden olabilir.

2. **Dinamik Analiz:**
- Uygulama tarafından oluşturulan dosyalara ayarlanan **izinleri doğrulayın**. Özellikle, herhangi bir dosyanın **dünya çapında okunabilir veya yazılabilir olarak ayarlanıp ayarlanmadığını kontrol edin**. Bu, herhangi bir köken veya niyetine bakılmaksızın cihaza yüklenen **herhangi bir uygulamanın** bu dosyaları **okumasına veya değiştirmesine** izin vereceği ciddi bir güvenlik riski oluşturabilir.

**Harici Depolama**

SD Kart gibi **harici depolama** üzerindeki dosyalarla uğraşırken bazı önlemler alınmalıdır:

1. **Erişilebilirlik**:
- Harici depolamadaki dosyalar **genel olarak okunabilir ve yazılabilir**. Bu, herhangi bir uygulamanın veya kullanıcının bu dosyalara erişebileceği anlamına gelir.

2. **Güvenlik Endişeleri**:
- Erişimin kolaylığı göz önüne alındığında, harici depolamada **hassas bilgileri saklamamak** önerilir.
- Harici depolama, herhangi bir uygulama tarafından çıkarılabilir veya erişilebilir olduğundan, daha az güvenlidir.

3. **Harici Depolamadan Veri İşleme**:
- Harici depolamadan alınan veriler üzerinde her zaman **giriş doğrulaması** yapın. Bu, verinin güvenilmeyen bir kaynaktan geldiği için önemlidir.
- Dinamik yükleme için harici depolamada yürütülebilir
```java
SSLSocketFactory sf = new cc(trustStore);
sf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);
```
Bu testi yapmanın iyi bir yolu, cihaz içinde Burp CA'yı yetkilendirmeden Burp gibi bir proxy kullanarak trafiği yakalamaya çalışmaktır. Ayrıca, Burp ile farklı bir ana bilgisayar adı için bir sertifika oluşturabilir ve kullanabilirsiniz.

### Kırık Şifreleme

**Zayıf Anahtar Yönetimi Süreçleri**

Bazı geliştiriciler, hassas verileri yerel depolamada kaydedip kodda sabit/beklenen bir anahtarla şifreler. Bu, gizli bilgilerin saldırganlar tarafından çıkarılmasına izin verebilecek bazı tersine mühendislik işlemleriyle yapılmamalıdır.

**Güvensiz ve/veya Kullanımdan Kaldırılmış Algoritmaların Kullanımı**

Geliştiriciler, yetkilendirme kontrolü, veri depolama veya gönderme gibi işlemler için **kullanımdan kaldırılmış algoritmaları** kullanmamalıdır. Bu algoritmalardan bazıları: RC4, MD4, MD5, SHA1... Örneğin, şifreleri depolamak için karma kullanılıyorsa, tuz ile birlikte kaba kuvvet saldırılarına dayanıklı karma kullanılmalıdır.

### Diğer kontroller

* APK'nın tersine mühendislik işlemlerini zorlaştırmak için **APK'yi karıştırmanız** önerilir.
* Uygulama hassas ise (banka uygulamaları gibi), mobilin köklendirilip köklendirilmediğini kontrol etmeli ve buna göre hareket etmelidir.
* Uygulama hassas ise (banka uygulamaları gibi), bir emülatörün kullanılıp kullanılmadığını kontrol etmelidir.
* Uygulama hassas ise (banka uygulamaları gibi), değiştirilip değiştirilmediğini kontrol etmek için kendi bütünlüğünü kontrol etmelidir.
* APK'yi oluşturmak için hangi derleyici/paketleyici/obfuskatörün kullanıldığını kontrol etmek için [**APKiD**](https://github.com/rednaga/APKiD) kullanın.

### React Native Uygulaması

React uygulamalarının javascript koduna nasıl kolayca erişileceğini öğrenmek için aşağıdaki sayfayı okuyun:

{% content-ref url="react-native-application.md" %}
[react-native-application.md](react-native-application.md)
{% endcontent-ref %}

### Xamarin Uygulamaları

Xamarin uygulamalarının C# koduna nasıl kolayca erişileceğini öğrenmek için aşağıdaki sayfayı okuyun:

{% content-ref url="../xamarin-apps.md" %}
[xamarin-apps.md](../xamarin-apps.md)
{% endcontent-ref %}

### Süperpaketlenmiş Uygulamalar

Bu [**blog yazısına**](https://clearbluejar.github.io/posts/desuperpacking-meta-superpacked-apks-with-github-actions/) göre süperpaketlenmiş, bir uygulamanın içeriğini tek bir dosyaya sıkıştıran bir Meta algoritmadır. Blog, bu tür uygulamaları açabilen bir uygulama oluşturma olasılığından bahseder... ve daha hızlı bir yol olan **uygulamayı çalıştırıp dosya sistemi üzerinden açılan dosyaları toplamak**.

### Otomatik Statik Kod Analizi

[**mariana-trench**](https://github.com/facebook/mariana-trench) aracı, uygulamanın kodunu tarayarak **zafiyetleri** bulma yeteneğine sahiptir. Bu araç, **bilinen kaynaklar** (girişin kullanıcı tarafından kontrol edildiği yerleri araca belirten), **sızıntılar** (kötü niyetli kullanıcı girişinin zarar verebileceği tehlikeli yerleri belirten) ve **kurallar** içerir. Bu kurallar, bir zafiyeti belirten **kaynak-sızıntı** kombinasyonunu gösterir.

Bu bilgiyle, **mariana-trench kodu gözden geçirir ve olası zafiyetleri bulur**.

### Sızan Gizli Bilgiler

Bir uygulama, içinde keşfedebileceğiniz (API anahtarları, şifreler, gizli URL'ler, alt alan adları...) gizli bilgiler içerebilir. [https://github.com/dwisiswant0/apkleaks](https://github.com/dwisiswant0/apkleaks) gibi bir araç kullanabilirsiniz.

### Biyometrik Kimlik Doğrulamayı Atlama

{% content-ref url="bypass-biometric-authentication-android.md" %}
[bypass-biometric-authentication-android.md](bypass-biometric-authentication-android.md)
{% endcontent-ref %}

### Diğer ilginç fonksiyonlar

* **Kod yürütme**: `Runtime.exec(), ProcessBuilder(), native code:system()`
* **SMS gönderme**: `sendTextMessage, sendMultipartTestMessage`
* `native` olarak tanımlanan **yerel fonksiyonlar**: `public native, System.loadLibrary, System.load`
* **Yerel fonksiyonları tersine mühendislik yapmak için** [bunu okuyun](reversing-native-libraries.md)

### **Diğer ipuçları**

{% content-ref url="content-protocol.md" %}
[content-protocol.md](content-protocol.md)
{% endcontent-ref %}

***

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve hata ödül avcıları ile iletişim kurmak için [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katılın!

**Hacking Insights**\
Hacking'in heyecanını ve zorluklarını inceleyen içeriklerle etkileşim kurun

**Gerçek Zamanlı Hack Haberleri**\
Hızlı tempolu hacking dünyasını gerçek zamanlı haberler ve içgörülerle takip edin

**En Son Duyurular**\
Yeni hata ödülleri başlatma ve önemli platform güncellemeleri hakkında bilgi edinin

**Bize katılın** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugün en iyi hackerlarla işbirliği yapmaya başlayın!

***

## Dinamik Analiz

> İlk olarak, uygulamayı ve tüm ortamı (Burp CA sertifikası, Drozer ve Frida özellikle) yükleyebileceğiniz bir ortama ihtiyacınız var. Bu nedenle, köklendirilmiş bir cihaz (emüle edilmiş veya değil) kesinlikle önerilir.

### Çevrimiçi Dinamik analiz

[https://appetize.io/](https://appetize.io) adresinde **ücretsiz bir hesap** oluşturabilirsiniz. Bu platform, APK'leri **yüklemenize** ve **çalıştırmanıza** olanak tanır, bu nedenle bir APK'nin nasıl davrandığını görmek için kullanışlıdır.

Web üzerinde uygulamanızın **günlüklerini görebilir** ve **adb** aracılığıyla bağlanabilirsiniz.

![](<../../.gitbook/assets/image (60).png>)

ADB bağlantısı sayesinde emülatörler içinde **Drozer** ve **Frida** kullanabilirsiniz.

### Yerel Dinamik Analiz

#### Bir emülatör kullanarak

* [**Android Studio**](https://developer.android.com/studio) (x86 ve arm cihazlar oluşturabilirsiniz ve [**bu** ](https://android-developers.googleblog.com/2020/03/run-arm-apps-on-android-emulator.html)**en son x86** sürümleri yavaş bir arm emülatörüne ihtiyaç duymadan ARM kütüphanelerini destekler).
* Kurulumunu öğrenmek için bu sayfaya bakın:

{% content-ref url="avd-android-virtual-device.md" %}
[avd-android-virtual-device.md](avd-android-virtual-device.md)
{% endcontent-ref %}

* [**Genymotion**](https://www.genymotion.com/fun-zone/) **(Ücretsiz sürüm:** Kişisel Sürüm, bir hesap oluşturmanız gerekiyor. _Potansiyel hatalardan kaçınmak için **VirtualBox ile birlikte** indirmeniz önerilir._)
* [**Nox**](https://es.bignox.com) (Ücretsiz, ancak Frida veya Drozer'ı desteklemez).

{% hint style="info" %}
Herhangi bir platformda yeni bir emülatör oluştururken, ekran ne kadar büyükse, emülatör o kadar yavaş çalışır. Mümkünse küçük ekranları seçin.
{% endhint %}

Genymotion'da Google hizmetlerini (AppStore gibi) **yüklemek** için aşağıdaki resimde kırmızı
#### Fiziksel bir cihaz kullanın

**Hata ayıklama** seçeneklerini etkinleştirmeniz gerekiyor ve **root** yapabilirseniz harika olur:

1. **Ayarlar**.
2. (Android 8.0'dan itibaren) **Sistem** seçin.
3. **Telefon hakkında** seçin.
4. **Yapı numarası**na 7 kez dokunun.
5. Geri dönün ve **Geliştirici seçenekleri**ni bulacaksınız.

> Uygulamayı yükledikten sonra yapmanız gereken ilk şey, onu denemek ve ne yaptığını, nasıl çalıştığını araştırmak ve onunla rahat hissetmektir.\
> Başlangıçta bu ilk dinamik analizi MobSF dinamik analiz + pidcat kullanarak yapmanızı öneririm, böylece MobSF, daha sonra gözden geçirebileceğiniz birçok **ilginç veri** yakalarken uygulamanın nasıl çalıştığını öğrenme fırsatı elde ederiz.

### İstenmeyen Veri Sızıntısı

**Günlükleme**

Geliştiriciler, hassas veri sızıntılarına yol açabileceği için **hata ayıklama bilgilerini** genel olarak açığa çıkarmaktan kaçınmalıdır. Uygulama günlüklerini izlemek ve hassas bilgileri tespit etmek ve korumak için [**pidcat**](https://github.com/JakeWharton/pidcat) ve `adb logcat` araçları önerilir. **Pidcat**, kullanım kolaylığı ve okunabilirliği nedeniyle tercih edilir.

{% hint style="warning" %}
**Android 4.0'dan daha yeni sürümlerde**, **uygulamalar yalnızca kendi günlüklerine erişebilir**. Bu nedenle, uygulamalar diğer uygulamaların günlüklerine erişemez.\
Yine de, **hassas bilgileri günlükleme** önerilir.
{% endhint %}

**Kopyala/Yapıştır Arabellek Önbelleği**

Android'in **pano tabanlı** çerçevesi, uygulamalarda kopyala-yapıştır işlevselliğini sağlar, ancak başka uygulamalar panoya erişebilir ve hassas verilerin açığa çıkmasına neden olabilir. Hassas bölümlerde, örneğin kredi kartı bilgilerinde, veri sızıntısını önlemek için kopyala/yapıştır işlevlerini devre dışı bırakmak önemlidir.

**Çökme Günlükleri**

Bir uygulama **çöktüğünde ve günlükler kaydedildiğinde**, bu günlükler özellikle uygulama tersine mühendislik yapılamadığında saldırganlara yardımcı olabilir. Bu riski azaltmak için çökmelerde günlükleme yapmaktan kaçının ve günlüklerin ağ üzerinden iletilmesi gerekiyorsa, güvenlik için SSL kanalı üzerinden gönderildiğinden emin olun.

Pentester olarak, bu günlüklere **bir göz atmayı deneyin**.

**3. Taraf Hizmetlere Gönderilen Analitik Veriler**

Uygulamalar genellikle Google Adsense gibi hizmetleri entegre eder ve geliştiricilerin yanlış uygulama nedeniyle hassas veri sızıntısına neden olabilir. Potansiyel veri sızıntılarını tespit etmek için uygulamanın trafiğini **intercept** etmek ve üçüncü taraf hizmetlere gönderilen herhangi bir hassas bilgiyi kontrol etmek önerilir.

### SQLite Veritabanları

Çoğu uygulama bilgileri kaydetmek için **dahili SQLite veritabanlarını** kullanır. Pentest sırasında oluşturulan **veritabanlarına**, **tablo** ve **sütun** isimlerine ve kaydedilen **tüm verilere** bir **göz atın**, çünkü hassas bilgiler bulabilirsiniz (bu bir zafiyet olabilir).\
Veritabanları, `/data/data/the.package.name/databases` gibi bir konumda olmalıdır, örneğin `/data/data/com.mwr.example.sieve/databases`

Eğer veritabanı gizli bilgileri kaydediyor ve **şifrelenmiş** ise, ancak uygulama içinde **şifreyi bulabilirseniz**, hala bir **zafiyet** bulunmaktadır.

`.tables` komutunu kullanarak tabloları ve `.schema <table_name>` komutunu kullanarak tabloların sütunlarını listeleyin.

### Drozer (Exploit Etkinlikleri, İçerik Sağlayıcıları ve Hizmetler)

[Drozer Belgeleri'nden](https://labs.mwrinfosecurity.com/assets/BlogFiles/mwri-drozer-user-guide-2015-03-23.pdf): **Drozer**, bir Android uygulamasının rolünü **üstlenebilmenizi** ve diğer uygulamalarla etkileşimde bulunabilmenizi sağlar. Android'in İşlem Arası İletişim (IPC) mekanizmasını kullanmak ve altta yatan işletim sistemiyle etkileşimde bulunmak gibi, bir yüklü uygulama yapabileceği her şeyi yapabilir.\
Drozer, aşağıdaki bölümlerde öğreneceğiniz gibi, **ihraç edilen etkinlikleri, ihraç edilen hizmetleri ve İçerik Sağlayıcıları** sömürmek için kullanışlı bir araçtır.

### İhraç Edilen Etkinlikleri Sömürme

[**Bir Android Etkinliği nedir**](android-applications-basics.md#launcher-activity-and-other-activities) hakkında bilgi almak için okuyun.\
Ayrıca bir etkinliğin kodu **`onCreate`** yönteminde başlar.

**Yetkilendirme atlatma**

Bir etkinlik ihraç edildiğinde, dış bir uygulamadan ekranını çağırabilirsiniz. Bu nedenle, **hassas bilgileri** içeren bir etkinlik **ihraç edildiyse**, **kimlik doğrulama** mekanizmalarını **atlayarak erişebilirsiniz**.

[**Drozer ile ihraç edilen etkinlikleri nasıl sömürebileceğinizi öğrenin.**](drozer-tutorial/#activities)

Ayrıca adb üzerinden ihraç edilen bir etkinliği başlatabilirsiniz:

* Paket Adı: com.example.demo
* İhraç Edilen Etkinlik Adı: com.example.test.MainActivity
```bash
adb shell am start -n com.example.demo/com.example.test.MainActivity
```
**NOT**: MobSF, _**singleTask/singleInstance**_ olarak `android:launchMode` özelliğini kullanan bir etkinlik tespit ederse, bunun eski sürümlerde (API sürümleri < 21) sadece tehlikeli olduğu için kötü amaçlı olarak algılar.

{% hint style="info" %}
Bir yetkilendirme atlaması her zaman bir zayıflık olmayabilir, bu atlamaların nasıl çalıştığına ve hangi bilgilerin ortaya çıktığına bağlı olacaktır.
{% endhint %}

**Hassas bilgi sızıntısı**

**Etkinlikler sonuç da döndürebilir**. Eğer dışa aktarılmış ve korumasız bir etkinlik bulursanız ve **`setResult`** yöntemini çağırarak ve **hassas bilgileri döndürerek**, hassas bilgi sızıntısı oluşabilir.

#### Tapjacking

Tapjacking engellenmezse, dışa aktarılmış etkinliği kullanarak **kullanıcının beklenmeyen eylemler yapmasını** sağlayabilirsiniz. [**Tapjacking nedir hakkında daha fazla bilgi için bağlantıyı takip edin**](./#tapjacking).

### İçerik Sağlayıcılarından Yararlanma - Hassas Bilgilere Erişim ve Manipülasyon

[**Bir İçerik Sağlayıcının ne olduğunu hatırlamak için bunu okuyun.**](android-applications-basics.md#content-provider)\
İçerik sağlayıcıları temel olarak veri paylaşmak için kullanılır. Bir uygulamanın kullanılabilir içerik sağlayıcıları varsa, bunlardan hassas verileri çıkarabilirsiniz. Ayrıca, olası **SQL enjeksiyonları** ve **Yol Geçişleri**'ni test etmek de ilginç olabilir, çünkü bunlar zayıf olabilir.

[**Drozer ile İçerik Sağlayıcılarını nasıl sömürüleceğini öğrenin.**](drozer-tutorial/#content-providers)

### **Servisleri Sömürme**

[**Bir Servisin ne olduğunu hatırlamak için bunu okuyun.**](android-applications-basics.md#services)\
Bir servis, temel olarak **veri alabilen**, **işleyebilen** ve **yanıt** (veya yanıt vermeme) döndürebilen bir şeydir. Bu nedenle, bir uygulama bazı servisleri dışa aktarıyorsa, ne yaptığını anlamak için **kodu kontrol etmeli** ve gizli bilgileri çıkarmak, kimlik doğrulama önlemlerini atlamak için **dinamik olarak** test etmelisiniz.\
[**Drozer ile Servisleri nasıl sömürüleceğini öğrenin.**](drozer-tutorial/#services)

### **Yayın Alıcılarını Sömürme**

[**Bir Yayın Alıcının ne olduğunu hatırlamak için bunu okuyun.**](android-applications-basics.md#broadcast-receivers)\
Bir yayın alıcısı, bir tür mesajı bekleyecektir. Alıcı mesajı nasıl işlediğine bağlı olarak zayıf olabilir.\
[**Drozer ile Yayın Alıcılarını nasıl sömürüleceğini öğrenin.**](./#exploiting-broadcast-receivers)

### **Şemaları / Derin bağlantıları Sömürme**

Derin bağlantıları MobSF gibi araçlar veya [bu](https://github.com/ashleykinguk/FBLinkBuilder/blob/master/FBLinkBuilder.py) gibi betikler kullanarak manuel olarak arayabilirsiniz.\
Bir bildirilen **şemayı** **adb** veya bir **tarayıcı** kullanarak **açabilirsiniz**:

{% code overflow="wrap" %}
```bash
adb shell am start -a android.intent.action.VIEW -d "scheme://hostname/path?param=value" [your.package.name]
```
{% endcode %}

_Not etmek gerekir ki, paket adını **atlayabilirsiniz** ve mobil cihaz otomatik olarak o bağlantıyı açması gereken uygulamayı çağırır._

{% code overflow="wrap" %}
```markup
<!-- Browser regular link -->
<a href="scheme://hostname/path?param=value">Click me</a>
<!-- fallback in your url you could try the intent url -->
<a href="intent://hostname#Intent;scheme=scheme;package=your.package.name;S.browser_fallback_url=http%3A%2F%2Fwww.example.com;end">with alternative</a>
```
{% endcode %}

**Kod yürütüldü**

Uygulamada **çalıştırılacak kodu bulmak** için, derin bağlantı tarafından çağrılan etkinliğe gidin ve **`onNewIntent`** işlevini arayın.

![](<../../.gitbook/assets/image (436) (1) (1) (1).png>)

**Hassas bilgiler**

Her derin bağlantı bulduğunuzda, URL parametreleri aracılığıyla hassas verilerin (şifreler gibi) alınmadığından emin olun, çünkü başka bir uygulama derin bağlantıyı taklit edebilir ve bu verileri çalabilir!

**Yol parametreleri**

URL'nin yolunun içinde bir parametre kullanan herhangi bir derin bağlantının da kontrol edilmesi gerekmektedir, örneğin: `https://api.example.com/v1/users/{kullaniciadi}`, bu durumda `example://app/users?username=../../unwanted-endpoint%3fparam=value` gibi bir şeye erişerek bir yol geçişi zorlayabilirsiniz.\
Uygulama içinde doğru uç noktaları bulursanız, **Açık Yönlendirme** (yolun bir kısmı alan adı olarak kullanılıyorsa), **hesap ele geçirme** (CSRF belirteci olmadan kullanıcı ayrıntılarını değiştirebilir ve zayıf nokta uygulanan doğru yöntemi kullanıyorsa) ve diğer zayıf noktaları tetikleyebilirsiniz. Daha fazla [bilgi için buraya](http://dphoeniixx.com/2020/12/13-2/) bakın.

**Daha fazla örnek**

Bağlantılarla ilgili bir [ilginç ödül avı raporu](https://hackerone.com/reports/855618) (_/.well-known/assetlinks.json_).

### Taşıma Katmanı Denetimi ve Doğrulama Hataları

- Android uygulamaları genellikle uyarıları göz ardı eder ve öz-kimlik doğrulaması yapılmamış sertifikaları kabul eder veya bazı durumlarda HTTP bağlantılarına geri döner.
- SSL/TLS el sıkışması sırasında yapılan müzakereler bazen güvenli olmayan şifreleme süitlerini kullanır. Bu zayıflık, bağlantının ortadaki adam (MITM) saldırılarına karşı savunmasız olmasına neden olur ve saldırganların verileri şifresini çözmesine olanak tanır.
- Uygulamaların güvenli kanallar kullanarak kimlik doğrulama yapmasına rağmen diğer işlemler için güvensiz kanallar üzerinden iletişim kurması, oturum çerezleri veya kullanıcı ayrıntıları gibi hassas verilerin kötü niyetli kişiler tarafından ele geçirilmesini engellemez.

#### Sertifika Doğrulama

**Sertifika doğrulama** üzerinde odaklanacağız. Sunucunun sertifikasının bütünlüğü güvenliği artırmak için doğrulanmalıdır. Bu, güvensiz TLS yapılandırmaları ve şifrelenmemiş kanallar üzerinden hassas verilerin iletilmesi önemli riskler oluşturabilir. Sunucu sertifikalarını doğrulamak ve zayıf noktaları ele almak için ayrıntılı adımlar için **[bu kaynak](https://manifestsecurity.com/android-application-security-part-10/)** kapsamlı rehberlik sağlar.

#### SSL Pinning

SSL Pinning, uygulamanın sunucunun sertifikasını uygulama içinde depolanan bilinen bir kopya ile doğrulamasını sağlayan bir güvenlik önlemidir. Bu yöntem, MITM saldırılarını önlemek için önemlidir. Hassas bilgileri işleyen uygulamalar için SSL Pinning uygulaması kesinlikle önerilir.

#### Trafik İncelemesi

HTTP trafiğini incelemek için, proxy aracının sertifikasının **kurulması gerekmektedir** (örneğin, Burp). Bu sertifikayı kurmadan, şifreli trafiğin proxy üzerinden görünmeyebilir. Özel bir CA sertifikası kurulumu hakkında bir kılavuz için **[buraya tıklayın](avd-android-virtual-device.md#install-burp-certificate-on-a-virtual-machine)**.

**API Düzeyi 24 ve üzeri** hedefleyen uygulamalar, şifreli trafiği incelemek için ağ güvenlik yapılandırmasını proxy'nin CA sertifikasını kabul edecek şekilde değiştirmeyi gerektirir. Bu adım, şifreli trafiği incelemek için önemlidir. Ağ Güvenlik Yapılandırmasını değiştirmek için talimatlar için **[bu öğreticiye başvurun](make-apk-accept-ca-certificate.md)**.

#### SSL Pinning'i Atlatma

SSL Pinning uygulandığında, HTTPS trafiğini incelemek için SSL Pinning'i atlamak gerekebilir. Bu amaçla çeşitli yöntemler mevcuttur:

* SSL Pinning'i atlamak için **apk'yi otomatik olarak değiştirin** [**apk-mitm**](https://github.com/shroudedcode/apk-mitm) ile. Bu seçeneğin en iyi yanı, SSL Pinning'i atlamak için kök erişimi gerektirmemesidir, ancak uygulamayı silip yeni bir tane yeniden yüklemeniz gerekebilir ve bu her zaman çalışmayabilir.
* Bu korumayı atlamak için **Frida** kullanabilirsiniz (aşağıda tartışılmıştır). Burada Burp+Frida+Genymotion'u kullanmanın bir kılavuzu bulunmaktadır: [https://spenkk.github.io/bugbounty/Configuring-Frida-with-Burp-and-GenyMotion-to-bypass-SSL-Pinning/](https://spenkk.github.io/bugbounty/Configuring-Frida-with-Burp-and-GenyMotion-to-bypass-SSL-Pinning/)
* [**objection**](frida-tutorial/objection-tutorial.md) kullanarak SSL Pinning'i otomatik olarak atlamayı deneyebilirsiniz: `objection --gadget com.package.app explore --startup-command "android sslpinning disable"`
* **MobSF dinamik analizi** kullanarak SSL Pinning'i otomatik olarak atlamayı deneyebilirsiniz (aşağıda açıklanmıştır)
* Hala yakalayamadığınız bazı trafiğin olduğunu düşünüyorsanız, trafiği burp'a yönlendirmek için **iptables kullanarak trafiği yönlendirmeyi** deneyebilirsiniz. Bu blogu okuyun: [https://infosecwriteups.com/bypass-ssl-pinning-with-ip-forwarding-iptables-568171b52b62](https://infosecwriteups.com/bypass-ssl-pinning-with-ip-forwarding-iptables-568171b52b62)

#### Yaygın Web Zayıf Noktalarını Arama

Uygulama içinde yaygın web zayıf noktalarını da aramak önemlidir. Bu zayıf noktaların belirlenmesi ve azaltılmasıyla ilgili ayrıntılı bilgiler bu özetin kapsamı dışındadır, ancak başka yerlerde kapsamlı bir şekilde ele alınmaktadır.

### Frida

[Frida](https://www.frida.re), geliştiriciler, ters mühendisler ve güvenlik araştırmacıları için bir dinamik enstrümantasyon araç setidir.\
**Çalışan uygulamalara erişebilir ve çalışma zamanında yöntemleri kancalayarak davranışı değiştirebilir, değerleri değiştirebilir, değerleri çıkarabilir, farklı kodları çalıştırabilirsiniz...**\
Android uygulamalarını pentest etmek istiyorsanız, Frida'yı nasıl kullanacağınızı bilmelisiniz.

* Frida'yı nasıl kullanacağınızı öğrenin: [**Frida öğretici**](frida-tutorial/)
* Frida ile eylemler için bazı "GUI" araçlar: [**https://github.com/m0bilesecurity/RMS-Runtime-Mobile-Security**](https://github.com/m0bilesecurity/RMS-Runtime-Mobile-Security)
* Ojection, Frida'nın kullanımını otomatikleştirmek için harikadır: [**https://github.com/sensepost/objection**](https://github.com/sensepost/objection) **,** [**https://github.com/dpnishant/appmon**](https://github.com/dpnishant/appmon)
* Harika Frida betiklerini burada bulabilirsiniz: [**https://codeshare.frida.re/**](https://codeshare.frida.re)

### **Belleği Dökme - Fridump**

Uygulamanın, şifreler veya mnemonikler gibi saklanmaması gereken hassas bilgileri bellekte saklayıp saklamadığını kontrol edin.

[**Fridump3**](https://github.com/rootbsd/fridump3) kullanarak uygulamanın belleğini dökebilirsiniz:
```bash
# With PID
python3 fridump3.py -u <PID>

# With name
frida-ps -Uai
python3 fridump3.py -u "<Name>"
```
Bu, belleği ./dump klasörüne dökecek ve orada şuna benzer bir şeyle grep yapabilirsiniz:

{% code overflow="wrap" %}
```bash
strings * | grep -E "^[a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+ [a-z]+$"
```
{% endcode %}

### **Keystore'da Hassas Veri**

Android'de Keystore, hassas verileri saklamak için en iyi yerdir, ancak yeterli yetkilere sahipseniz **buna erişmek mümkündür**. Uygulamaların burada hassas verileri açık metin olarak saklama eğiliminde olduğu için pentestler, kök kullanıcı veya cihaza fiziksel erişimi olan birinin bu verileri çalabilme olasılığına karşı kontrol etmelidir.

Bir uygulama keystore'da veri saklasa bile, veriler şifrelenmelidir.

Keystore içindeki verilere erişmek için bu Frida betiğini kullanabilirsiniz: [https://github.com/WithSecureLabs/android-keystore-audit/blob/master/frida-scripts/tracer-cipher.js](https://github.com/WithSecureLabs/android-keystore-audit/blob/master/frida-scripts/tracer-cipher.js)
```bash
frida -U -f com.example.app -l frida-scripts/tracer-cipher.js
```
### **Parmak İzi/Biyometrik Atlama**

Aşağıdaki Frida betiği kullanılarak, Android uygulamalarının belirli hassas alanları korumak için gerçekleştirebileceği **parmak izi doğrulamasını atlama** olasıdır:

{% code overflow="wrap" %}
```bash
frida --codeshare krapgras/android-biometric-bypass-update-android-11 -U -f <app.package>
```
{% endcode %}

### **Arka Plan Görüntüleri**

Bir uygulamayı arka plana attığınızda, Android uygulamanın bir **anlık görüntüsünü** saklar, böylece uygulama öne çıkarıldığında uygulamadan önce görüntüyü yüklemeye başlar, böylece uygulama daha hızlı yüklenmiş gibi görünür.

Ancak, bu anlık görüntü **hassas bilgileri** içeriyorsa, anlık görüntüye erişimi olan biri bu bilgileri **çalabilir** (unutmayın, bunun için kök erişimi gereklidir).

Anlık görüntüler genellikle şurada saklanır: **`/data/system_ce/0/snapshots`**

Android, FLAG\_SECURE düzenleme parametresini ayarlayarak **ekran görüntüsü yakalama işlemini engellemek için bir yol sağlar**. Bu bayrak kullanılarak, pencere içeriği güvenli olarak işlenir, böylece ekran görüntülerinde görünmez veya güvenli olmayan ekranlarda görüntülenmez.
```bash
getWindow().setFlags(LayoutParams.FLAG_SECURE, LayoutParams.FLAG_SECURE);
```
### **Android Uygulama Analizörü**

Bu araç, dinamik analiz sırasında farklı araçları yönetmenize yardımcı olabilir: [https://github.com/NotSoSecure/android\_application\_analyzer](https://github.com/NotSoSecure/android\_application\_analyzer)

### Intent Enjeksiyonu

Geliştiriciler genellikle aktiviteler, servisler ve yayın alıcıları gibi proxy bileşenler oluşturur ve bu Intent'leri `startActivity(...)` veya `sendBroadcast(...)` gibi yöntemlere ileterek risk oluşturabilir.

Tehlike, saldırganların bu Intent'leri yanlış yönlendirerek, ihraç edilmeyen uygulama bileşenlerini tetiklemesine veya hassas içerik sağlayıcılarına erişmesine izin vermesinde yatar. Dikkate değer bir örnek, `WebView` bileşeninin URL'leri `Intent.parseUri(...)` aracılığıyla `Intent` nesnelerine dönüştürmesi ve ardından bunları yürütmesidir, bu da potansiyel olarak kötü niyetli Intent enjeksiyonlarına yol açabilir.

### Önemli Noktalar
- **Intent Enjeksiyonu**, web'in Açık Yönlendirme sorununa benzer.
- Saldırılar, `Intent` nesnelerini ekstralar olarak ileterek, güvensiz işlemlerin yürütülmesine yönlendirilebilir.
- İhraç edilmeyen bileşenleri ve içerik sağlayıcılarını saldırganlara açık edebilir.
- `WebView`'ın URL'yi `Intent`'e dönüştürmesi istenmeyen eylemleri kolaylaştırabilir.

### Android İstemci Tarafı Enjeksiyonları ve Diğerleri

Muhtemelen Web'den bu tür zayıflıkları biliyorsunuzdur. Bir Android uygulamasında bu tür zayıflıklara özellikle dikkat etmeniz gerekmektedir:

* **SQL Enjeksiyonu:** Dinamik sorgular veya İçerik Sağlayıcılarla uğraşırken, parametreli sorgular kullandığınızdan emin olun.
* **JavaScript Enjeksiyonu (XSS):** WebViews için JavaScript ve Eklenti desteğinin devre dışı bırakıldığından emin olun (varsayılan olarak devre dışıdır). [Daha fazla bilgi için buraya tıklayın](webview-attacks.md#javascript-enabled).
* **Yerel Dosya Dahil Etme:** WebViews, dosya sistemine erişime izin verilmemiş olmalıdır (varsayılan olarak etkinleştirilmiştir) - `(webview.getSettings().setAllowFileAccess(false);)`. [Daha fazla bilgi için buraya tıklayın](webview-attacks.md#javascript-enabled).
* **Kalıcı çerezler**: Android uygulaması oturumu sonlandırıldığında çerez iptal edilmez veya hatta diske kaydedilebilir.
* [**Güvenli Bayrak** çerezlerde](../../pentesting-web/hacking-with-cookies/#cookies-flags)

***

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve ödül avcılarıyla iletişim kurmak için [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katılın!

**Hacking İçgörüleri**\
Hacking'in heyecanını ve zorluklarını inceleyen içeriklerle etkileşime geçin

**Gerçek Zamanlı Hack Haberleri**\
Hızlı tempolu hacking dünyasını gerçek zamanlı haberler ve içgörülerle takip edin

**En Son Duyurular**\
Yeni ödül avları başlatma ve önemli platform güncellemeleri hakkında bilgi edinin

**Bize katılın** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugün en iyi hackerlarla işbirliği yapmaya başlayın!

## Otomatik Analiz

### [MobSF](https://github.com/MobSF/Mobile-Security-Framework-MobSF)

**Statik analiz**

![](<../../.gitbook/assets/image (61).png>)

Güzel bir web tabanlı ön uç kullanarak uygulamanın **zayıflık değerlendirmesi** yapabilirsiniz. Ayrıca dinamik analiz yapabilirsiniz (ancak ortamı hazırlamanız gerekmektedir).
```bash
docker pull opensecurity/mobile-security-framework-mobsf
docker run -it -p 8000:8000 opensecurity/mobile-security-framework-mobsf:latest
```
MobSF, **Android** (apk), IOS (ipa) ve Windows (apx) uygulamalarını analiz edebilir (_Windows uygulamaları, bir Windows ana bilgisayarında yüklü olan MobSF'den analiz edilmelidir_).\
Ayrıca, bir **ZIP** dosyası oluşturarak kaynak kodunu içeren bir **Android** veya **IOS** uygulamasını analiz edebilirsiniz (uygulamanın kök klasörüne gidin, her şeyi seçin ve bir ZIP dosyası oluşturun).

MobSF ayrıca analizi **karşılaştırma/diff** yapmanıza ve **VirusTotal**'ı entegre etmenize de olanak tanır (API anahtarınızı _MobSF/settings.py_ dosyasına ayarlamanız ve etkinleştirmeniz gerekecektir: `VT_ENABLED = TRUE` `VT_API_KEY = <API anahtarınız>` `VT_UPLOAD = TRUE`). `VT_UPLOAD`'ı `False` olarak ayarlayabilirsiniz, bu durumda dosya yerine **hash** yüklenecektir.

### MobSF ile Desteklenen Dinamik Analiz

MobSF, **Android** için dinamik analizde de çok yardımcı olabilir, ancak bu durumda MobSF ve **genymotion**'ı ana bilgisayarınıza yüklemeniz gerekecektir (bir sanal makine veya Docker çalışmayacaktır). _Not: **Önce genymotion'da bir sanal makine başlatmanız** ve **ardından MobSF'yi başlatmanız gerekmektedir.**_\
**MobSF dinamik analizörü**, aşağıdaki işlemleri yapabilir:

* Uygulama verilerini (URL'ler, günlükler, panoya kopyalanan veriler, sizin tarafından alınan ekran görüntüleri, "**Exported Activity Tester**" tarafından alınan ekran görüntüleri, e-postalar, SQLite veritabanları, XML dosyaları ve diğer oluşturulan dosyalar) **dökümleyebilir**. Ekran görüntüleri hariç, bunların hepsi otomatik olarak yapılır, ekran görüntüsü almak istediğinizde veya tüm dışa aktarılan aktivitelerin ekran görüntülerini almak için "**Exported Activity Tester**" düğmesine basmanız gerekmektedir.
* **HTTPS trafiğini** yakalayabilir
* **Frida** kullanarak **çalışma zamanı bilgileri** elde edebilir

Android **sürümleri > 5** için, otomatik olarak Frida'yı başlatacak ve trafiği yakalamak için genel **proxy** ayarlarını yapacaktır. Sadece test edilen uygulamadan trafiği yakalayacaktır.

**Frida**

Varsayılan olarak, SSL pinning'i atlamak, root tespiti ve hata ayıklama tespiti yapmak ve ilgi çekici API'leri izlemek için bazı Frida betiklerini kullanacaktır.\
MobSF ayrıca dışa aktarılan aktiviteleri **çağırabilir**, bunların **ekran görüntülerini** alabilir ve rapor için **kaydedebilir**.

Dinamik testi başlatmak için yeşil düğmeye basın: "**Start Instrumentation**". Frida betikleri tarafından oluşturulan günlükleri görmek için "**Frida Live Logs**" düğmesine basın ve kancalanan yöntemlere yapılan tüm çağrıları, iletilen argümanları ve döndürülen değerleri görmek için "**Live API Monitor**" düğmesine basın (bu, "Start Instrumentation" düğmesine bastıktan sonra görünecektir).\
MobSF ayrıca kendi **Frida betiklerinizi** yüklemenize (Frida betiklerinizin sonuçlarını MobSF'ye göndermek için `send()` işlevini kullanın) olanak tanır. Ayrıca yükleyebileceğiniz **birçok önceden yazılmış betik** bulunur (`MobSF/DynamicAnalyzer/tools/frida_scripts/others/` dizinine daha fazlasını ekleyebilirsiniz), sadece **seçin**, "**Load**" düğmesine basın ve "**Start Instrumentation**" düğmesine basın (bu betiklerin günlüklerini "**Frida Live Logs**" içinde görebileceksiniz).

![](<../../.gitbook/assets/image (215).png>)

Ayrıca, bazı Yardımcı Frida işlevleri bulunmaktadır:

* Yüklenen Sınıfları Sırala: Yüklenen tüm sınıfları yazdırır
* Dizeleri Yakala: Uygulamayı kullanırken yakalanan tüm dizeleri yazdırır (çok gürültülü)
* Dize Karşılaştırmalarını Yakala: Çok faydalı olabilir. Karşılaştırılan 2 diziyi ve sonucun Doğru veya Yanlış olup olmadığını gösterecektir.
* Sınıf Yöntemlerini Sırala: Sınıf adını (örneğin "java.io.File") girin ve sınıfın tüm yöntemlerini yazdırır.
* Sınıf Deseni Ara: Desene göre sınıfları ara
* Sınıf Yöntemlerini İzle: Bir sınıfı izle (sınıfın tüm yöntemlerinin girdi ve çıktılarını gör). Unutmayın, MobSF varsayılan olarak birçok ilgi çekici Android API yöntemini izler.

Kullanmak istediğiniz yardımcı modülü seçtikten sonra "**Start Intrumentation**" düğmesine basmanız ve tüm çıktıları "**Frida Live Logs**" içinde göreceksiniz.

**Shell**

MobSF, dinamik analiz sayfasının altında bazı **adb** komutları, **MobSF komutları** ve yaygın **shell** komutlarıyla bir kabuk sunar. İlginç bazı komutlar:
```bash
help
shell ls
activities
exported_activities
services
receivers
```
**HTTP araçları**

HTTP trafiği yakalandığında, yakalanan trafiğin "**HTTP(S) Trafik**" altında çirkin bir görünümünü veya "**HTTP Araçlarına Başla**" yeşil düğmeyle daha hoş bir görünümünü görebilirsiniz. İkinci seçenekten, yakalanan istekleri Burp veya Owasp ZAP gibi **proxy'lere** gönderebilirsiniz.\
Bunu yapmak için, _Burp'u açın -->_ _Intercept'i kapatın --> MobSB HTTP Araçları'nda isteği seçin_ --> "**Fuzzer'a Gönder**" düğmesine basın --> _proxy adresini seçin_ ([http://127.0.0.1:8080\\](http://127.0.0.1:8080)).

MobSF ile dinamik analizi tamamladıktan sonra, zafiyetleri aramak için "**Web API Fuzzer'ı Başlat**" düğmesine basabilirsiniz.

{% hint style="info" %}
MobSF ile dinamik analiz yapıldıktan sonra, proxy ayarları yanlış yapılandırılmış olabilir ve bunları GUI üzerinden düzeltemeyebilirsiniz. Proxy ayarlarını düzeltmek için aşağıdaki adımları izleyebilirsiniz:
```
adb shell settings put global http_proxy :0
```
{% endhint %}

### Inspeckage ile Desteklenen Dinamik Analiz

Araç [**Inspeckage**](https://github.com/ac-pm/Inspeckage) adresinden indirilebilir.\
Bu araç, bir **dinamik analiz** gerçekleştirirken uygulamada neler olduğunu öğrenmek için bazı **Hooks** kullanır.

### [Yaazhini](https://www.vegabird.com/yaazhini/)

Bu, bir GUI ile **statik analiz yapmak için harika bir araçtır**.

![](<../../.gitbook/assets/image (527).png>)

### [Qark](https://github.com/linkedin/qark)

Bu araç, **kaynak kodunda** veya **paketlenmiş APK'lerde** birkaç **güvenlikle ilgili Android uygulama açığı** aramak için tasarlanmıştır. Araç ayrıca bulunan bazı açıkları (açığa çıkan aktiviteler, intentler, tapjacking...) sömürmek için bir "Proof-of-Concept" dağıtılabilir APK ve ADB komutları oluşturma yeteneğine sahiptir. Drozer gibi, test cihazını rootlama ihtiyacı yoktur.
```bash
pip3 install --user qark  # --user is only needed if not using a virtualenv
qark --apk path/to/my.apk
qark --java path/to/parent/java/folder
qark --java path/to/specific/java/file.java
```
### [**ReverseAPK**](https://github.com/1N3/ReverseAPK.git)

* Kolay referans için tüm çıkarılan dosyaları görüntüler
* APK dosyalarını otomatik olarak Java ve Smali formatına decompile eder
* Yaygın güvenlik açıkları ve davranışlar için AndroidManifest.xml'yi analiz eder
* Yaygın güvenlik açıkları ve davranışlar için statik kaynak kodu analizi yapar
* Cihaz bilgisi
* ve daha fazlası
```bash
reverse-apk relative/path/to/APP.apk
```
### [SUPER Android Analyzer](https://github.com/SUPERAndroidAnalyzer/super)

SUPER, Windows, MacOS X ve Linux'ta kullanılabilen bir komut satırı uygulamasıdır. Bu uygulama, zayıflıkları aramak için _.apk_ dosyalarını analiz eder. Bunun için APK'ları açar ve bu zayıflıkları tespit etmek için bir dizi kural uygular.

Tüm kurallar, bir `rules.json` dosyasında merkezlenmiştir ve her şirket veya testçi ihtiyaçlarına göre kendi kurallarını oluşturabilir.

En son ikili dosyaları [indirme sayfasından](https://superanalyzer.rocks/download.html) indirebilirsiniz.
```
super-analyzer {apk_file}
```
### [StaCoAn](https://github.com/vincentcox/StaCoAn)

![](<../../.gitbook/assets/image (62).png>)

StaCoAn, mobil uygulamalar üzerinde [statik kod analizi](https://en.wikipedia.org/wiki/Static\_program\_analysis) gerçekleştiren geliştiricilere, bugbounty avcılarına ve etik hackerlara yardımcı olan **çok platformlu** bir araçtır.

Kavram şudur: Mobil uygulama dosyanızı (bir .apk veya .ipa dosyası) StaCoAn uygulamasına sürükleyip bırakırsınız ve size görsel ve taşınabilir bir rapor oluşturur. Ayarları ve kelime listelerini özelleştirebilirsiniz.

[En son sürümü indirin](https://github.com/vincentcox/StaCoAn/releases):
```
./stacoan
```
### [AndroBugs](https://github.com/AndroBugs/AndroBugs_Framework)

AndroBugs Framework, geliştiricilere veya hackerlara Android uygulamalarında potansiyel güvenlik açıklarını bulmalarına yardımcı olan bir Android zafiyet analiz sistemi.\
[Windows sürümleri](https://github.com/AndroBugs/AndroBugs_Framework/releases)
```
python androbugs.py -f [APK file]
androbugs.exe -f [APK file]
```
### [Androwarn](https://github.com/maaaaz/androwarn)

**Androwarn**, Android uygulamaları tarafından geliştirilen potansiyel kötü niyetli davranışları tespit etmek ve kullanıcıyı uyarıda bulunmak için kullanılan bir araçtır.

Tespit işlemi, uygulamanın Dalvik bytecode'ının **statik analizi** ile gerçekleştirilir ve bu bytecode **Smali** olarak temsil edilir. Bu analiz, [`androguard`](https://github.com/androguard/androguard) kütüphanesi kullanılarak yapılır.

Bu araç, Telefoni kimlik bilgilerinin dışarıya aktarılması, Ses/video akışının dinlenmesi, PIM verilerinin değiştirilmesi, Keyfi kod yürütme gibi **"kötü" uygulamaların yaygın davranışlarını** arar.
```
python androwarn.py -i my_application_to_be_analyzed.apk -r html -v 3
```
### [MARA Framework](https://github.com/xtiankisutsa/MARA_Framework)

![](<../../.gitbook/assets/image (81).png>)

**MARA**, Mobil Uygulama Tersine Mühendislik ve Analiz Çerçevesi anlamına gelir. OWASP mobil güvenlik tehditlerine karşı mobil uygulamaları test etmeye yardımcı olmak için yaygın olarak kullanılan mobil uygulama tersine mühendislik ve analiz araçlarını bir araya getiren bir araçtır. Amacı, bu görevi mobil uygulama geliştiricileri ve güvenlik uzmanları için daha kolay ve kullanıcı dostu hale getirmektir.

Aşağıdaki işlemleri yapabilir:

* Farklı araçlar kullanarak Java ve Smali kodunu çıkartır.
* APK'ları analiz eder: [smalisca](https://github.com/dorneanu/smalisca), [ClassyShark](https://github.com/google/android-classyshark), [androbugs](https://github.com/AndroBugs/AndroBugs_Framework), [androwarn](https://github.com/maaaaz/androwarn), [APKiD](https://github.com/rednaga/APKiD)
* APK'den özel bilgileri regexps kullanarak çıkartır.
* Manifest'i analiz eder.
* Bulunan alanları analiz eder: [pyssltest](https://github.com/moheshmohan/pyssltest), [testssl](https://github.com/drwetter/testssl.sh) ve [whatweb](https://github.com/urbanadventurer/WhatWeb)
* APK'yi [apk-deguard.com](http://www.apk-deguard.com) üzerinden deobfuscate eder.

### Koodous

Kötü amaçlı yazılımları tespit etmek için kullanışlıdır: [https://koodous.com/](https://koodous.com)

## Kodu Obfuscate/Deobfuscate Etme

Kodu obfuscate etmek için kullandığınız hizmet ve yapılandırmaya bağlı olarak, sırlar obfuscate edilmiş olabilir veya olmayabilir.

### [ProGuard](https://en.wikipedia.org/wiki/ProGuard\_\(software\))

[Wikipedia](https://en.wikipedia.org/wiki/ProGuard\_\(software\))'a göre, **ProGuard**, Java kodunu küçültme, optimize etme ve obfuscate etme işlemlerini gerçekleştiren açık kaynaklı bir komut satırı aracıdır. Bytecode'ı optimize edebilir ve kullanılmayan talimatları tespit edip kaldırabilir. ProGuard, özgür yazılımdır ve GNU Genel Kamu Lisansı, sürüm 2 altında dağıtılır.

ProGuard, Android SDK'nın bir parçası olarak dağıtılır ve uygulama release modunda derlenirken çalışır.

### [DexGuard](https://www.guardsquare.com/dexguard)

Apk'nın deobfuscate edilmesi için adım adım bir kılavuz [https://blog.lexfo.fr/dexguard.html](https://blog.lexfo.fr/dexguard.html)'de bulunabilir.

(O kılavuzdan) Son kontrol ettiğimizde, Dexguard'ın çalışma modu şu şekildedir:

* Bir kaynağı bir InputStream olarak yükle;
* Sonucu şifrelemek için FilterInputStream'den türeyen bir sınıfa besle;
* Bir ters mühendislikçinin birkaç dakikasını boşa harcamak için bazı gereksiz obfuscation yap;
* Şifrelenmiş sonucu bir ZipInputStream'e besle ve bir DEX dosyası elde et;
* Son olarak, `loadDex` yöntemini kullanarak elde edilen DEX'i bir Kaynak olarak yükle.

### [DeGuard](http://apk-deguard.com)

**DeGuard, Android obfuscation araçları tarafından gerçekleştirilen obfuscation işleminin tersine çevrilmesini sağlar. Bu, kod incelemesi ve kütüphanelerin tahmin edilmesi de dahil olmak üzere birçok güvenlik analizine olanak tanır.**

Obfuscate edilmiş bir APK'yı platformlarına yükleyebilirsiniz.

### [Simplify](https://github.com/CalebFenton/simplify)

Bu, **genel bir Android deobfuscator**'dır. Simplify, bir uygulamayı sanal olarak çalıştırarak davranışını anlamaya çalışır ve ardından kodu insanlar tarafından daha kolay anlaşılabilir hale getirmek için optimize etmeye çalışır. Her optimizasyon türü basit ve geneldir, bu nedenle özel bir obfuscation türü kullanılmış olması önemli değildir.

### [APKiD](https://github.com/rednaga/APKiD)

APKiD, bir APK'nın nasıl oluşturulduğu hakkında bilgi verir. Birçok derleyici, paketleyici, obfuscator ve diğer garip şeyleri tanır. Android için [_PEiD_](https://www.aldeid.com/wiki/PEiD)'dir.

### El ile

[Özel obfuscation'ı tersine çevirme hakkında bazı ipuçları öğrenmek için bu kılavuzu okuyun](manual-deobfuscation.md)

## Laboratuvarlar

### [Androl4b](https://github.com/sh4hin/Androl4b)

AndroL4b, tersine mühendislik ve kötü amaçlı yazılım analizi için farklı güvenlik uzmanları ve araştırmacıların en son çerçeve, öğreticiler ve laboratuvarları içeren ubuntu-mate tabanlı bir Android güvenlik sanal makinesidir.

## Referanslar

* [https://owasp.org/www-project-mobile-app-security/](https://owasp.org/www-project-mobile-app-security/)
* [https://appsecwiki.com/#/](https://appsecwiki.com/#/) Bu, kaynakların harika bir listesidir.
* [https://maddiestone.github.io/AndroidAppRE/](https://maddiestone.github.io/AndroidAppRE/) Android hızlı kursu
* [https://manifestsecurity.com/android-application-security/](https://manifestsecurity.com/android-application-security/)
* [https://github.com/Ralireza/Android-Security-Teryaagh](https://github.com/Ralireza/Android-Security-Teryaagh)
* [https://www.youtube.com/watch?v=PMKnPaGWxtg\&feature=youtu.be\&ab\_channel=B3nacSec](https://www.youtube.com/watch?v=PMKnPaGWxtg\&feature=youtu.be\&ab\_channel=B3nacSec)

## Henüz Denenmemiş

* [https://www.vegabird.com/yaazhini/](https://www.vegabird.com/yaazhini/)
* [https://github.com/abhi-r3v0/Adhrit](https://github.com/abhi-r3v0/Adhrit)

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve bug bounty avcıları ile iletişim kurmak için [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katılın!

**Hacking Insights**\
Hacking'in heyecanını ve zorluklarını inceleyen içeriklerle etkileşime geçin.

**Gerçek Zamanlı Hack Haberleri**\
Hızlı tempolu hacking dünyasını gerçek zamanlı haberler ve içgörülerle takip edin.

**En Son Duyurular**\
Yeni bug bounty'lerin başlatılmasını ve önemli platform güncellemelerini takip edin.

Bugün [**Discord**](https://discord.com/invite/N3FrSbmwdy)'a katılın ve en iyi hackerlarla işbirliği yapmaya başlayın!

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin!</summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklam vermek veya HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [
