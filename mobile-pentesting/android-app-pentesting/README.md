# Pentesting d'applications Android

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (7) (2).png" alt=""><figcaption></figcaption></figure>

[**Suivez HackenProof**](https://bit.ly/3xrrDrL) **pour en savoir plus sur les bugs web3**

üêû Lisez les tutoriels sur les bugs web3

üîî Recevez des notifications sur les nouveaux programmes de primes pour bugs

üí¨ Participez aux discussions de la communaut√©

## Fondamentaux des applications Android

Il est fortement recommand√© de commencer par lire cette page pour conna√Ætre les **parties les plus importantes li√©es √† la s√©curit√© Android et les composants les plus dangereux d'une application Android** :

{% content-ref url="android-applications-basics.md" %}
[android-applications-basics.md](android-applications-basics.md)
{% endcontent-ref %}

## ADB (Android Debug Bridge)

C'est l'outil principal dont vous avez besoin pour vous connecter √† un appareil Android (√©mul√© ou physique).\
Il vous permet de contr√¥ler votre appareil via **USB** ou **R√©seau** depuis un ordinateur, de **copier** des fichiers aller-retour, d'**installer** et de d√©sinstaller des applications, d'ex√©cuter des commandes **shell**, d'effectuer des **sauvegardes**, de lire des **logs** et plus encore.

Jetez un coup d'≈ìil √† la liste suivante des [**commandes ADB**](adb-commands.md) pour apprendre √† utiliser adb.

## Smali

Parfois, il est int√©ressant de **modifier le code de l'application** pour acc√©der √† des **informations cach√©es** (peut-√™tre des mots de passe bien obscurcis ou des indicateurs). Ensuite, il pourrait √™tre int√©ressant de d√©compiler l'apk, de modifier le code et de le recompiler.\
[**Dans ce tutoriel** vous pouvez **apprendre √† d√©compiler un APK, modifier le code Smali et recompiler l'APK** avec la nouvelle fonctionnalit√©](smali-changes.md). Cela pourrait √™tre tr√®s utile comme **alternative pour plusieurs tests pendant l'analyse dynamique** qui vont √™tre pr√©sent√©s. Ensuite, **gardez toujours √† l'esprit cette possibilit√©**.

## Autres astuces int√©ressantes

* [Fausser votre emplacement dans Play Store](spoofing-your-location-in-play-store.md)
* **T√©l√©charger des APK** : [https://apps.evozi.com/apk-downloader/](https://apps.evozi.com/apk-downloader/), [https://apkpure.com/es/](https://apkpure.com/es/), [https://www.apkmirror.com/](https://www.apkmirror.com), [https://apkcombo.com/es-es/apk-downloader/](https://apkcombo.com/es-es/apk-downloader/)
* Extraire l'APK de l'appareil :
```
adb shell pm list packages
com.android.insecurebankv2

adb shell pm path com.android.insecurebankv2 
package:/data/app/com.android.insecurebankv2-Jnf8pNgwy3QA_U5f-n_4jQ==/base.apk

adb pull /data/app/com.android.insecurebankv2- Jnf8pNgwy3QA_U5f-n_4jQ==/base.apk
```
<figure><img src="../../.gitbook/assets/image (7) (2).png" alt=""><figcaption></figcaption></figure>

[**Suivez HackenProof**](https://bit.ly/3xrrDrL) **pour en savoir plus sur les bugs web3**

üêû Lisez les tutoriels sur les bugs web3

üîî Recevez des notifications sur les nouveaux programmes de primes pour bugs

üí¨ Participez aux discussions de la communaut√©

## Analyse statique

Tout d'abord, pour analyser un APK, vous devriez **jeter un coup d'≈ìil au code Java** en utilisant un d√©compilateur.\
S'il vous pla√Æt, [**lisez ici pour trouver des informations sur les diff√©rents d√©compilateurs disponibles**](apk-decompilers.md).

### Recherche d'informations int√©ressantes

En regardant simplement les **cha√Ænes de caract√®res** de l'APK, vous pouvez rechercher des **mots de passe**, des **URL** ([https://github.com/ndelphit/apkurlgrep](https://github.com/ndelphit/apkurlgrep)), des **cl√©s API**, du **chiffrement**, des **UUID Bluetooth**, des **jetons** et tout ce qui est int√©ressant... cherchez m√™me des **backdoors** d'ex√©cution de code ou des backdoors d'authentification (identifiants administrateur cod√©s en dur dans l'application).

**Firebase**

Faites particuli√®rement attention aux **URL Firebase** et v√©rifiez si elles sont mal configur√©es. [Plus d'informations sur ce qu'est Firebase et comment l'exploiter ici.](../../network-services-pentesting/pentesting-web/buckets/firebase-database.md)

### Compr√©hension de base de l'application - Manifest.xml, strings.xml

En utilisant l'un des **d√©compilateurs** mentionn√©s [**ici**](apk-decompilers.md), vous pourrez lire le _Manifest.xml_. Vous pouvez √©galement **renommer** l'extension de fichier **apk en .zip** et le **d√©compresser**.\
En lisant le **manifeste**, vous pouvez trouver des **vuln√©rabilit√©s** :

* Tout d'abord, v√©rifiez si **l'application est d√©bogable**. Une APK de production ne devrait pas l'√™tre (sinon d'autres pourront s'y connecter). Vous pouvez v√©rifier si une application est d√©bogable en cherchant dans le manifeste l'attribut `debuggable="true"` √† l'int√©rieur de la balise _\<application_ Exemple : `<application theme="@2131296387" debuggable="true"`
  * [Apprenez ici](drozer-tutorial/#is-debuggeable) comment trouver des applications d√©bogables sur un t√©l√©phone et les exploiter
* **Sauvegarde**: L'attribut **`android:allowBackup`** d√©finit si les donn√©es de l'application peuvent √™tre sauvegard√©es et restaur√©es par un utilisateur qui a activ√© le d√©bogage USB. Si le drapeau de sauvegarde est d√©fini sur true, cela permet √† un attaquant de prendre la sauvegarde des donn√©es de l'application via adb m√™me si l'appareil n'est pas root√©. Par cons√©quent, les applications qui g√®rent et stockent des informations sensibles telles que les d√©tails de carte, les mots de passe, etc. doivent avoir ce param√®tre explicitement d√©fini sur **false** car par d√©faut, il est d√©fini sur **true** pour √©viter de tels risques.
  * `<application android:allowBackup="false"`
* **S√©curit√© r√©seau** : La s√©curit√© r√©seau de l'application peut √©craser les valeurs par d√©faut avec **`android:networkSecurityConfig="@xml/network_security_config"`**. Un fichier portant ce nom peut √™tre plac√© dans _**res/xml.**_ Ce fichier configurera des param√®tres de s√©curit√© importants tels que les broches de certificat ou s'il autorise le trafic HTTP. Vous pouvez lire ici plus d'informations sur toutes les choses qui peuvent √™tre configur√©es, mais v√©rifiez cet exemple sur la fa√ßon de configurer le trafic HTTP pour certains domaines :
  * `<domain-config cleartextTrafficPermitted="true"> <domain includeSubdomains="true">formation-software.co.uk </domain></domain-config>`
* **Activit√©s export√©es** : V√©rifiez les activit√©s export√©es dans le manifeste car cela peut √™tre dangereux. Plus tard, lors de l'analyse dynamique, il sera expliqu√© comment [vous pouvez exploiter ce comportement](./#exploiting-exported-activities-authorisation-bypass).
* **Fournisseurs de contenu** : Si un fournisseur export√© est expos√©, vous pourriez √™tre en mesure d'acc√©der/modifier des informations int√©ressantes. Dans l'analyse dynamique, [vous apprendrez comment les exploiter](./#exploiting-content-providers-accessing-and-manipulating-sensitive-information).
  * V√©rifiez les configurations des **FileProviders** √† l'int√©rieur de l'attribut `android:name="android.support.FILE_PROVIDER_PATHS"`. [Lisez ici pour en savoir plus sur les FileProviders](./#fileprovider).
* **Services expos√©s** : Selon ce que le service fait en interne, des vuln√©rabilit√©s pourraient √™tre exploit√©es. Dans l'analyse dynamique, [vous apprendrez comment les exploiter](./#exploiting-services).
* **R√©cepteurs de diffusion** : [Vous apprendrez comment vous pouvez √©ventuellement les exploiter](./#exploiting-broadcast-receivers) lors de l'analyse dynamique.
* **Sch√©ma d'URL** : Lisez le code de l'activit√© g√©rant le sch√©ma et recherchez des vuln√©rabilit√©s g√©rant l'entr√©e de l'utilisateur. Plus d'informations sur [ce qu'est un sch√©ma d'URL ici](./#url-schemes).
* **minSdkVersion**, **targetSDKVersion**, **maxSdkVersion** : Ils indiquent les versions d'Android sur lesquelles l'application fonctionnera. Il est important de les garder √† l'esprit car du point de vue de la s√©curit√©, le support des anciennes versions permettra aux versions vuln√©rables connues d'Android de l'ex√©cuter.

En lisant **resources.arsc/strings.xml**, vous pouvez trouver des **informations int√©ressantes** :

* Cl√©s API
* Sch√©mas personnalis√©s
* Autres informations int√©ressantes que les d√©veloppeurs enregistrent dans ce fichier

### Tapjacking

**Tapjacking** est une attaque o√π une **application malveillante** est lanc√©e et **se positionne au-dessus d'une application victime**. Une fois qu'elle obscurcit visiblement l'application victime, son interface utilisateur est con√ßue de mani√®re √† tromper l'utilisateur pour qu'il interagisse avec elle, tout en passant l'interaction √† l'application victime.\
En effet, cela **aveugle l'utilisateur en lui faisant croire qu'il effectue r√©ellement des actions sur l'application victime**.

Pour d√©tecter les applications vuln√©rables √† cette attaque, vous devriez rechercher des **activit√©s export√©es** dans le manifeste Android (notez qu'une activit√© avec un filtre d'intention est automatiquement export√©e par d√©faut). Une fois que vous avez trouv√© les activit√©s export√©es, **v√©rifiez si elles n√©cessitent une autorisation**. C'est parce que la **demande malveillante aura √©galement besoin de cette autorisation**.\
Enfin, il est important de v√©rifier le code pour d'√©ventuelles configurations de **`setFilterTouchesWhenObscured`**. Si elle est d√©finie sur **`true`**, un bouton peut √™tre automatiquement d√©sactiv√© s'il est obscurci :
```markup
<Button android:text="Button"
android:id="@+id/button1"
android:layout_width="wrap_content"
android:layout_height="wrap_content" 
android:filterTouchesWhenObscured="true">
</Button>
```
Vous pouvez utiliser [**qark**](https://github.com/linkedin/qark) avec le param√®tre `--exploit-apk` pour cr√©er une application malveillante afin de tester les vuln√©rabilit√©s potentielles de **Tapjacking**.\
Un projet d'exemple impl√©mentant ce type de fonctionnalit√© peut √™tre trouv√© dans [**FloatingWindowApp**](https://github.com/aminography/FloatingWindowApp).

La mitigation est relativement simple car le d√©veloppeur peut choisir de ne pas recevoir les √©v√©nements tactiles lorsqu'une vue est recouverte par une autre. En utilisant la [R√©f√©rence du d√©veloppeur Android](https://developer.android.com/reference/android/view/View#security):

> Parfois, il est essentiel qu'une application puisse v√©rifier qu'une action est effectu√©e avec la pleine connaissance et le consentement de l'utilisateur, comme accorder une demande d'autorisation, effectuer un achat ou cliquer sur une publicit√©. Malheureusement, une application malveillante pourrait essayer de tromper l'utilisateur en effectuant ces actions, sans le savoir, en dissimulant l'objectif pr√©vu de la vue. Pour rem√©dier √† cela, le framework offre un m√©canisme de filtrage tactile qui peut √™tre utilis√© pour am√©liorer la s√©curit√© des vues qui fournissent un acc√®s √† des fonctionnalit√©s sensibles.
>
> Pour activer le filtrage tactile, appelez [`setFilterTouchesWhenObscured(boolean)`](https://developer.android.com/reference/android/view/View#setFilterTouchesWhenObscured%28boolean%29) ou d√©finissez l'attribut de mise en page android:filterTouchesWhenObscured sur true. Lorsqu'il est activ√©, le framework supprimera les touches re√ßues chaque fois que la fen√™tre de la vue est masqu√©e par une autre fen√™tre visible. Par cons√©quent, la vue ne recevra pas de touches chaque fois qu'un toast, une bo√Æte de dialogue ou une autre fen√™tre appara√Ætra au-dessus de la fen√™tre de la vue.

### D√©tournement de t√¢che

{% content-ref url="android-task-hijacking.md" %}
[android-task-hijacking.md](android-task-hijacking.md)
{% endcontent-ref %}

### Stockage de donn√©es non s√©curis√©

**Stockage interne**

Les fichiers **cr√©√©s** sur le **stockage interne** sont **accessibles** uniquement par l'**application**. Cette protection est mise en ≈ìuvre par Android et est suffisante pour la plupart des applications. Mais les d√©veloppeurs utilisent souvent `MODE_WORLD_READBALE` & `MODE_WORLD_WRITABLE` pour donner acc√®s √† ces fichiers √† une autre application, mais cela ne limite pas les autres applications (malveillantes) √† y acc√©der.\
Lors de l'**analyse statique**, v√©rifiez l'utilisation de ces **modes**, lors de l'**analyse dynamique**, v√©rifiez les **autorisations** des fichiers cr√©√©s (peut-√™tre que certains d'entre eux sont lisibles/inscriptibles dans le monde entier).\
[Plus d'informations sur cette vuln√©rabilit√© et comment la corriger ici.](https://manifestsecurity.com/android-application-security-part-8/)

**Stockage externe**

Les fichiers cr√©√©s sur le **stockage externe**, tels que les cartes SD, sont **lisibles et inscriptibles √† l'√©chelle mondiale**. √âtant donn√© que le stockage externe peut √™tre supprim√© par l'utilisateur et √©galement modifi√© par n'importe quelle application, vous ne devez **pas stocker d'informations sensibles en utilisant le stockage externe**.\
Comme pour les donn√©es provenant de toute source non fiable, vous devez **valider les entr√©es** lors de la manipulation des **donn√©es provenant du stockage externe**. Nous vous recommandons vivement de ne pas stocker d'ex√©cutables ou de fichiers de classe sur le stockage externe avant le chargement dynamique. Si votre application r√©cup√®re des fichiers ex√©cutables √† partir du stockage externe, les fichiers doivent √™tre sign√©s et v√©rifi√©s cryptographiquement avant le chargement dynamique.\
Informations prises √† partir de [ici](https://manifestsecurity.com/android-application-security-part-8/).

Le stockage externe peut √™tre **acc√©d√©** dans `/storage/emulated/0` , `/sdcard` , `/mnt/sdcard`

{% hint style="info" %}
√Ä partir d'Android 4.4 (**API 17**), la carte SD dispose d'une structure de r√©pertoire qui **limite l'acc√®s d'une application au r√©pertoire sp√©cifiquement destin√© √† cette application**. Cela emp√™che les applications malveillantes d'obtenir un acc√®s en lecture ou en √©criture aux fichiers d'une autre application.
{% endhint %}

**Donn√©es sensibles stock√©es en clair**

* **Pr√©f√©rences partag√©es**: Android permet √† chaque application de facilement enregistrer des fichiers xml dans le chemin `/data/data/<nomdupackage>/shared_prefs/` et parfois il est possible de trouver des informations sensibles en clair dans ce dossier.
* **Bases de donn√©es**: Android permet √† chaque application de facilement enregistrer des bases de donn√©es sqlite dans le chemin `/data/data/<nomdupackage>/databases/` et parfois il est possible de trouver des informations sensibles en clair dans ce dossier.

### TLS cass√©

**Accepter tous les certificats**

Pour une raison quelconque, parfois les d√©veloppeurs acceptent tous les certificats m√™me si, par exemple, le nom d'h√¥te ne correspond pas avec des lignes de code comme celle-ci:
```java
SSLSocketFactory sf = new cc(trustStore);
sf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);
```
Une bonne fa√ßon de tester cela est d'essayer de capturer le trafic en utilisant un proxy comme Burp sans autoriser Burp CA √† l'int√©rieur de l'appareil. De plus, vous pouvez g√©n√©rer avec Burp un certificat pour un nom d'h√¥te diff√©rent et l'utiliser.

### Cryptographie cass√©e

**Mauvais processus de gestion de cl√©s**

Certains d√©veloppeurs enregistrent des donn√©es sensibles dans le stockage local et les chiffrent avec une cl√© cod√©e en dur/pr√©visible dans le code. Cela ne devrait pas √™tre fait car une r√©tro-ing√©nierie pourrait permettre aux attaquants d'extraire les informations confidentielles.

**Utilisation d'algorithmes non s√©curis√©s et/ou obsol√®tes**

Les d√©veloppeurs ne devraient pas utiliser des **algorithmes obsol√®tes** pour effectuer des **v√©rifications** d'autorisation, **stocker** ou **envoyer** des donn√©es. Certains de ces algorithmes sont : RC4, MD4, MD5, SHA1... Si des **hachages** sont utilis√©s pour stocker des mots de passe par exemple, des hachages r√©sistants √† la force brute devraient √™tre utilis√©s avec un sel.

### Autres v√©rifications

* Il est recommand√© d'**obfusquer l'APK** pour rendre plus difficile le travail de r√©tro-ing√©nierie des attaquants.
* Si l'application est sensible (comme les applications bancaires), elle devrait effectuer ses **propres v√©rifications pour voir si le mobile est root√©** et agir en cons√©quence.
* Si l'application est sensible (comme les applications bancaires), elle devrait v√©rifier si un **√©mulateur** est utilis√©.
* Si l'application est sensible (comme les applications bancaires), elle devrait **v√©rifier son int√©grit√© avant de l'ex√©cuter** pour v√©rifier si elle a √©t√© modifi√©e.
* Utilisez [**APKiD**](https://github.com/rednaga/APKiD) pour v√©rifier quel compilateur/packer/obfuscateur a √©t√© utilis√© pour construire l'APK.

### Application React Native

Lisez la page suivante pour apprendre comment acc√©der facilement au code JavaScript des applications React :

{% content-ref url="react-native-application.md" %}
[react-native-application.md](react-native-application.md)
{% endcontent-ref %}

### Applications Xamarin

Les applications **Xamarin** sont √©crites en **C#**, pour acc√©der au code C# **d√©compress√©**, vous devez obtenir les fichiers de l'**apk** :
```bash
7z r app.apk #Or any other zip decompression cmd
```
Ensuite, d√©compressez tous les fichiers DLsL √† l'aide de [**xamarin-decompress**](https://github.com/NickstaDB/xamarin-decompress)**:**
```
python3 xamarin-decompress.py -o /path/to/decompressed/apk
```
Et enfin, vous pouvez utiliser [**ces outils recommand√©s**](../../reversing/reversing-tools-basic-methods/#net-decompiler) pour **lire le code C#** des DLLs.

### Analyse de code statique automatis√©e

L'outil [**mariana-trench**](https://github.com/facebook/mariana-trench) est capable de trouver des **vuln√©rabilit√©s** en **scannant** le **code** de l'application. Cet outil contient une s√©rie de **sources connues** (qui indiquent √† l'outil les **endroits** o√π l'**entr√©e** est **contr√¥l√©e par l'utilisateur**), de **sinks** (qui indiquent √† l'outil les **endroits dangereux** o√π une entr√©e utilisateur malveillante pourrait causer des dommages) et de **r√®gles**. Ces r√®gles indiquent la **combinaison** de **sources-sinks** qui indique une vuln√©rabilit√©.

Avec cette connaissance, **mariana-trench examinera le code et trouvera les vuln√©rabilit√©s possibles**.

### Fuites de secrets

Une application peut contenir des secrets (cl√©s API, mots de passe, URL cach√©es, sous-domaines...) √† l'int√©rieur que vous pourriez √™tre en mesure de d√©couvrir. Vous pouvez utiliser un outil tel que [https://github.com/dwisiswant0/apkleaks](https://github.com/dwisiswant0/apkleaks)

### Contourner l'authentification biom√©trique

{% content-ref url="bypass-biometric-authentication-android.md" %}
[bypass-biometric-authentication-android.md](bypass-biometric-authentication-android.md)
{% endcontent-ref %}

### Autres fonctions int√©ressantes

* **Ex√©cution de code**: `Runtime.exec(), ProcessBuilder(), code natif:system()`
* **Envoyer des SMS**: `sendTextMessage, sendMultipartTestMessage`
* **Fonctions natives** d√©clar√©es comme `native`: `public native, System.loadLibrary, System.load`
  * [Lisez ceci pour apprendre **comment inverser les fonctions natives**](reversing-native-libraries.md)

### **Autres astuces**

{% content-ref url="content-protocol.md" %}
[content-protocol.md](content-protocol.md)
{% endcontent-ref %}

<figure><img src="../../.gitbook/assets/image (7) (2).png" alt=""><figcaption></figcaption></figure>

[**Suivez HackenProof**](https://bit.ly/3xrrDrL) **pour en savoir plus sur les bugs web3**

üêû Lire les tutoriels de bugs web3

üîî Recevoir des notifications sur les nouveaux programmes de primes pour bugs

üí¨ Participer aux discussions de la communaut√©

## Analyse dynamique

> Tout d'abord, vous avez besoin d'un environnement o√π vous pouvez installer l'application et tout l'environnement (certificat Burp CA, Drozer et Frida principalement). Par cons√©quent, un appareil enracin√© (√©mul√© ou non) est extr√™mement recommand√©.

### Analyse dynamique en ligne

Vous pouvez cr√©er un **compte gratuit** sur: [https://appetize.io/](https://appetize.io). Cette plateforme vous permet de **t√©l√©charger** et **ex√©cuter** des APK, il est donc utile de voir comment un APK se comporte.

Vous pouvez m√™me **voir les journaux de votre application** sur le web et vous connecter via **adb**.

![](<../../.gitbook/assets/image (60).png>)

Gr√¢ce √† la connexion ADB, vous pouvez utiliser **Drozer** et **Frida** √† l'int√©rieur des √©mulateurs.

### Analyse dynamique locale

Vous pouvez utiliser un **√©mulateur** comme:

* [**Android Studio**](https://developer.android.com/studio) (Vous pouvez cr√©er des appareils **x86** et **arm**, et selon [**ceci** ](https://android-developers.googleblog.com/2020/03/run-arm-apps-on-android-emulator.html)**les derni√®res versions x86** **supportent les biblioth√®ques ARM** sans avoir besoin d'un √©mulateur ARM lent).
  * Si vous voulez essayer d'**installer** une **image** et que vous voulez **la supprimer** ensuite, vous pouvez le faire sur Windows:`C:\Users\<User>\AppData\Local\Android\sdk\system-images\` ou Mac: `/Users/myeongsic/Library/Android/sdk/system-image`
  * C'est l'**√©mulateur principal que je recommande d'utiliser et vous pouvez**[ **apprendre √† le configurer sur cette page**](avd-android-virtual-device.md).
* [**Genymotion**](https://www.genymotion.com/fun-zone/) **(Version gratuite:** Personal Edition, vous devez cr√©er un compte. _Il est recommand√© de **t√©l√©charger** la version **AVEC**_ _**VirtualBox** pour √©viter les erreurs potentielles._)
* [Nox](https://es.bignox.com) (Gratuit, mais ne prend pas en charge Frida ou Drozer).

{% hint style="info" %}
Lors de la cr√©ation d'un nouvel √©mulateur sur n'importe quelle plateforme, rappelez-vous que plus l'√©cran est grand, plus l'√©mulateur sera lent. Choisissez donc des petits √©crans si possible.
{% endhint %}

Comme la plupart des gens utiliseront **Genymotion**, notez cette astuce. Pour **installer les services Google** (comme AppStore), vous devez cliquer sur le bouton marqu√© en rouge de l'image suivante:

![](<../../.gitbook/assets/image (200) (1).png>)

De plus, notez que dans la **configuration de la machine virtuelle Android dans Genymotion**, vous pouvez s√©lectionner le mode **Bridge Network** (ce sera utile si vous vous connectez √† la machine virtuelle Android √† partir d'une autre machine virtuelle avec les outils).

Ou vous pouvez utiliser un **appareil physique** (vous devez activer les options de d√©bogage et ce sera cool si vous pouvez le rooter):

1. **Param√®tres**.
2. (√Ä partir d'Android 8.0) S√©lectionnez **Syst√®me**.
3. S√©lectionnez **√Ä propos du t√©l√©phone**.
4. Appuyez sur **Num√©ro de build** 7 fois.
5. Revenez en arri√®re et vous trouverez les **Options pour les d√©veloppeurs**.

> Une fois que vous avez install√© l'application, la premi√®re chose √† faire est de l'essayer et d'investiguer ce qu'elle fait, comment elle fonctionne et de vous familiariser avec elle.\
> Je vous sugg√®re de **r√©aliser cette analyse dynamique initiale en utilisant l'analyse dynamique MobSF + pidcat**, afin que vous puissiez **apprendre comment l'application fonctionne** pendant que MobSF **capture** beaucoup de **donn√©es int√©ressantes** que vous pouvez examiner plus tard.

### Fuites de donn√©es involontaires

**Journalisation**

Souvent, les d√©veloppeurs laissent des informations de d√©bogage publiques. Ainsi, toute application avec l'autorisation `READ_LOGS` peut **acc√©der √† ces journaux** et peut obtenir des informations sensibles √† travers cela.\
Lors de la navigation dans l'application, utilisez [**pidcat**](https://github.com/JakeWharton/pidcat)_(Recommand√©, il est plus facile √† utiliser et √† lire_) ou [adb logcat](adb-commands.md#logcat) pour lire les journaux cr√©√©s et **rechercher des informations sensibles**.

{% hint style="warning" %}
Notez que depuis les versions ult√©rieures √† Android 4.0, **les applications ne peuvent acc√©der qu'√† leurs propres journaux**.
```
adb shell am start -n com.example.demo/com.example.test.MainActivity
```
**REMARQUE**: MobSF d√©tectera comme malveillante l'utilisation de _**singleTask/singleInstance**_ en tant que `android:launchMode` dans une activit√©, mais en raison de [ceci](https://github.com/MobSF/Mobile-Security-Framework-MobSF/pull/750), cela ne serait apparemment dangereux que sur les anciennes versions (versions API < 21).

{% hint style="info" %}
Notez qu'une violation d'autorisation n'est pas toujours une vuln√©rabilit√©, cela d√©pendrait de la fa√ßon dont la violation fonctionne et des informations expos√©es.
{% endhint %}

**Fuite d'informations sensibles**

**Les activit√©s peuvent √©galement renvoyer des r√©sultats**. Si vous parvenez √† trouver une activit√© export√©e et non prot√©g√©e appelant la m√©thode **`setResult`** et **renvoyant des informations sensibles**, il y a une fuite d'informations sensibles.

### Exploitation des fournisseurs de contenu - Acc√®s et manipulation d'informations sensibles

[**Lisez ceci si vous voulez vous rappeler ce qu'est un fournisseur de contenu.**](android-applications-basics.md#content-provider)\
Les fournisseurs de contenu sont essentiellement utilis√©s pour **partager des donn√©es**. Si une application dispose de fournisseurs de contenu disponibles, vous pourrez peut-√™tre **extraire des donn√©es sensibles** √† partir de ceux-ci. Il est √©galement int√©ressant de tester les **injections SQL** et les **travers√©es de chemin** possibles car ils pourraient √™tre vuln√©rables.\
[**Apprenez √† exploiter les fournisseurs de contenu avec Drozer.**](drozer-tutorial/#content-providers)

### **Exploitation des services**

[**Lisez ceci si vous voulez vous rappeler ce qu'est un service.**](android-applications-basics.md#services)\
Rappelez-vous que les actions d'un service commencent dans la m√©thode `onStartCommand`.

Un service est essentiellement quelque chose qui **peut recevoir des donn√©es**, les **traiter** et **renvoyer** (ou non) une r√©ponse. Ensuite, si une application exporte certains services, vous devez **v√©rifier** le **code** pour comprendre ce qu'il fait et le **tester** **dynamiquement** pour extraire des informations confidentielles, contourner les mesures d'authentification...\
[**Apprenez √† exploiter les services avec Drozer.**](drozer-tutorial/#services)

### **Exploitation des r√©cepteurs de diffusion**

[**Lisez ceci si vous voulez vous rappeler ce qu'est un r√©cepteur de diffusion.**](android-applications-basics.md#broadcast-receivers)\
Rappelez-vous que les actions d'un r√©cepteur de diffusion commencent dans la m√©thode `onReceive`.

Un r√©cepteur de diffusion attendra un type de message. Selon la mani√®re dont le r√©cepteur g√®re le message, il pourrait √™tre vuln√©rable.\
[**Apprenez √† exploiter les r√©cepteurs de diffusion avec Drozer.**](./#exploiting-broadcast-receivers)

### **Exploitation des sch√©mas / liens profonds**

Vous pouvez rechercher des liens profonds manuellement, en utilisant des outils comme MobSF ou des scripts comme [celui-ci](https://github.com/ashleykinguk/FBLinkBuilder/blob/master/FBLinkBuilder.py).\
Vous pouvez **ouvrir** un **sch√©ma** d√©clar√© en utilisant **adb** ou un **navigateur** :
```bash
adb shell am start -a android.intent.action.VIEW -d "scheme://hostname/path?param=value" [your.package.name]
```
_Notez que vous pouvez **omettre le nom du package** et le mobile appellera automatiquement l'application qui devrait ouvrir ce lien._
```markup
<!-- Browser regular link -->
<a href="scheme://hostname/path?param=value">Click me</a>
<!-- fallback in your url you could try the intent url -->
<a href="intent://hostname#Intent;scheme=scheme;package=your.package.name;S.browser_fallback_url=http%3A%2F%2Fwww.example.com;end">with alternative</a>
```
**Code ex√©cut√©**

Pour trouver le **code qui sera ex√©cut√© dans l'application**, allez dans l'activit√© appel√©e par le lien profond et recherchez la fonction **`onNewIntent`**.

![](<../../.gitbook/assets/image (436) (1) (1) (1).png>)

**Informations sensibles**

Chaque fois que vous trouvez un lien profond, v√©rifiez qu'il ne re√ßoit pas de donn√©es sensibles (comme des mots de passe) via des param√®tres d'URL, car toute autre application pourrait **usurper le lien profond et voler ces donn√©es !**

**Param√®tres dans le chemin**

Vous **devez √©galement v√©rifier si un lien profond utilise un param√®tre √† l'int√©rieur du chemin** de l'URL comme : `https://api.example.com/v1/users/{username}`, dans ce cas, vous pouvez forcer une travers√©e de chemin en acc√©dant √† quelque chose comme : `example://app/users?username=../../unwanted-endpoint%3fparam=value`.\
Notez que si vous trouvez les points d'extr√©mit√© corrects √† l'int√©rieur de l'application, vous pourriez √™tre en mesure de causer une **redirection ouverte** (si une partie du chemin est utilis√©e comme nom de domaine), une **prise de contr√¥le de compte** (si vous pouvez modifier les d√©tails des utilisateurs sans jeton CSRF et que le point d'extr√©mit√© vuln√©rable utilise la m√©thode correcte) et toute autre vuln√©rabilit√©. Plus d'informations √† ce sujet [ici](http://dphoeniixx.com/2020/12/13-2/).

**Plus d'exemples**

Un [rapport de prime de bug int√©ressant](https://hackerone.com/reports/855618) sur les liens (_/.well-known/assetlinks.json_).

### Protection insuffisante de la couche de transport

* **Manque d'inspection de certificat :** L'application Android ne v√©rifie pas l'identit√© du certificat qui lui est pr√©sent√©. La plupart des applications ignorent les avertissements et acceptent tout certificat auto-sign√© pr√©sent√©. Certaines applications passent plut√¥t le trafic par une connexion HTTP.
* **N√©gociation de poign√©e de main faible :** L'application et le serveur effectuent une poign√©e de main SSL/TLS mais utilisent une suite de chiffrement non s√©curis√©e qui est vuln√©rable aux attaques MITM. Ainsi, tout attaquant peut facilement d√©crypter cette connexion.
* **Fuite d'informations de confidentialit√© :** La plupart du temps, il arrive que les applications effectuent une authentification via un canal s√©curis√© mais que toutes les autres connexions se fassent via un canal non s√©curis√©. Cela n'ajoute pas de s√©curit√© √† l'application car les donn√©es sensibles restantes telles que le cookie de session ou les donn√©es utilisateur peuvent √™tre intercept√©es par un utilisateur malveillant.

Des 3 sc√©narios pr√©sent√©s, nous allons discuter de **comment v√©rifier l'identit√© du certificat**. Les 2 autres sc√©narios d√©pendent de la **configuration TLS** du serveur et si l'**application envoie des donn√©es non chiffr√©es**. Le testeur de p√©n√©tration doit v√©rifier par lui-m√™me la configuration TLS du serveur ([ici](../../network-services-pentesting/pentesting-web/#ssl-tls-vulnerabilites)) et d√©tecter si des **informations confidentielles sont envoy√©es par un canal non chiffr√©/vuln√©rable**.\
Plus d'informations sur la fa√ßon de d√©couvrir et de corriger ce type de vuln√©rabilit√©s [**ici**](https://manifestsecurity.com/android-application-security-part-10/).

**√âpinglage SSL**

Par d√©faut, lorsqu'une connexion SSL est √©tablie, le client (application Android) v√©rifie que le certificat du serveur a une cha√Æne de confiance v√©rifiable remontant √† un certificat de confiance (racine) et correspond au nom d'h√¥te demand√©. Cela conduit au probl√®me des **attaques de l'homme du milieu (MITM)**.\
Dans l'√©pinglage de certificat, une application Android contient elle-m√™me le certificat du serveur et ne transmet les donn√©es que si le m√™me certificat est pr√©sent√©.\
Il est recommand√© d'**appliquer l'√©pinglage SSL** pour les sites o√π des informations sensibles vont √™tre envoy√©es.

### Inspection du trafic HTTP

Tout d'abord, vous devez (devez) **installer le certificat** de l'**outil proxy** que vous allez utiliser, probablement Burp. Si vous n'installez pas le certificat CA de l'outil proxy, vous ne verrez probablement pas le trafic chiffr√© dans le proxy.\
**S'il vous pla√Æt,** [**lisez ce guide pour apprendre comment installer un certificat CA personnalis√©**](android-burp-suite-settings.md)**.**

Pour les applications ciblant **API Level 24+ il ne suffit pas d'installer le certificat Burp** sur l'appareil. Pour contourner cette nouvelle protection, vous devez modifier le fichier de configuration de s√©curit√© r√©seau. Ainsi, vous pouvez modifier ce fichier pour autoriser votre certificat CA ou vous pouvez [**lire cette page pour un tutoriel sur la fa√ßon de forcer l'application √† accepter √† nouveau tous les certificats install√©s sur l'appareil**](make-apk-accept-ca-certificate.md).

**√âpinglage SSL**

Nous avons d√©j√† discut√© de ce qu'est l'√©pinglage SSL juste 2 paragraphes avant. Lorsqu'il est impl√©ment√© dans une application, vous devrez le contourner pour inspecter le trafic HTTPS ou vous ne le verrez pas.\
Ici, je vais pr√©senter quelques options que j'ai utilis√©es pour contourner cette protection :

* **Modifier automatiquement** l'**apk** pour **contourner** l'**√©pinglage SSL** avec [**apk-mitm**](https://github.com/shroudedcode/apk-mitm). Le meilleur avantage de cette option est que vous n'aurez pas besoin de root pour contourner l'√©pinglage SSL, mais vous devrez supprimer l'application et r√©installer la nouvelle, et cela ne fonctionnera pas toujours.
* Vous pouvez utiliser **Frida** (discut√© ci-dessous) pour contourner cette protection. Voici un guide pour utiliser Burp+Frida+Genymotion : [https://spenkk.github.io/bugbounty/Configuring-Frida-with-Burp-and-GenyMotion-to-bypass-SSL-Pinning/](https://spenkk.github.io/bugbounty/Configuring-Frida-with-Burp-and-GenyMotion-to-bypass-SSL-Pinning/)
* Vous pouvez √©galement essayer de **contourner automatiquement l'√©pinglage SSL** en utilisant [**objection**](frida-tutorial/objection-tutorial.md)**:** `objection --gadget com.package.app explore --startup-command "android sslpinning disable"`
* Vous pouvez √©galement essayer de **contourner automatiquement l'√©pinglage SSL** en utilisant **MobSF dynamic analysis** (expliqu√© ci-dessous)
* Si vous pensez toujours qu'il y a du trafic que vous ne capturez pas, vous pouvez essayer de **rediriger le trafic vers burp en utilisant iptables**. Lisez ce blog : [https://infosecwriteups.com/bypass-ssl-pinning-with-ip-forwarding-iptables-568171b52b62](https://infosecwriteups.com/bypass-ssl-pinning-with
```
docker pull opensecurity/mobile-security-framework-mobsf
docker run -it -p 8000:8000 opensecurity/mobile-security-framework-mobsf:latest
```
Notez que MobSF peut analyser les applications **Android** (apk), **IOS** (ipa) et **Windows** (apx) (_les applications Windows doivent √™tre analys√©es √† partir d'un MobSF install√© sur un h√¥te Windows_).\
De plus, si vous cr√©ez un fichier **ZIP** avec le code source d'une application **Android** ou **IOS** (allez dans le dossier racine de l'application, s√©lectionnez tout et cr√©ez un fichier ZIP), il sera √©galement possible de l'analyser.

MobSF vous permet √©galement de **comparer/diff√©rencier** les analyses et d'int√©grer **VirusTotal** (vous devrez d√©finir votre cl√© API dans _MobSF/settings.py_ et l'activer : `VT_ENABLED = TRUE` `VT_API_KEY = <Votre cl√© API>` `VT_UPLOAD = TRUE`). Vous pouvez √©galement d√©finir `VT_UPLOAD` sur `False`, alors le **hash** sera **t√©l√©charg√©** au lieu du fichier.

### Analyse dynamique assist√©e avec MobSF

**MobSF** peut √©galement √™tre tr√®s utile pour l'**analyse dynamique** sur **Android**, mais dans ce cas, vous devrez installer MobSF et **genymotion** sur votre h√¥te (une VM ou Docker ne fonctionnera pas). _Note : Vous devez **d'abord d√©marrer une VM dans genymotion** et **ensuite MobSF.**_\
L'analyseur dynamique de **MobSF** peut :

* **Extraire les donn√©es de l'application** (URL, logs, presse-papiers, captures d'√©cran r√©alis√©es par vous, captures d'√©cran r√©alis√©es par "**Exported Activity Tester**", e-mails, bases de donn√©es SQLite, fichiers XML et autres fichiers cr√©√©s). Tout cela est fait automatiquement sauf pour les captures d'√©cran, vous devez appuyer lorsque vous voulez une capture d'√©cran ou vous devez appuyer sur "**Exported Activity Tester**" pour obtenir des captures d'√©cran de toutes les activit√©s export√©es.
* Capturer le **trafic HTTPS**
* Utiliser **Frida** pour obtenir des **informations d'ex√©cution**

√Ä partir des versions **> 5** d'Android, il d√©marrera **automatiquement Frida** et d√©finira les param√®tres de **proxy** globaux pour **capturer** le trafic. Il ne capturera que le trafic de l'application test√©e.

**Frida**

Par d√©faut, il utilisera √©galement certains scripts Frida pour **contourner la v√©rification de l'empreinte SSL**, la **d√©tection de root** et la **d√©tection de d√©bogueur** et pour **surveiller les API int√©ressantes**.\
MobSF peut √©galement **appeler des activit√©s export√©es**, capturer des **captures d'√©cran** et les **enregistrer** pour le rapport.

Pour **d√©marrer** le test dynamique, appuyez sur le bouton vert : "**Start Instrumentation**". Appuyez sur "**Frida Live Logs**" pour voir les journaux g√©n√©r√©s par les scripts Frida et "**Live API Monitor**" pour voir toutes les invocations des m√©thodes accroch√©es, les arguments pass√©s et les valeurs retourn√©es (cela appara√Ætra apr√®s avoir appuy√© sur "Start Instrumentation").\
MobSF vous permet √©galement de charger vos propres **scripts Frida** (pour envoyer les r√©sultats de vos scripts Frida √† MobSF, utilisez la fonction `send()`). Il dispose √©galement de **plusieurs scripts pr√©-√©crits** que vous pouvez charger (vous pouvez en ajouter d'autres dans `MobSF/DynamicAnalyzer/tools/frida_scripts/others/`), il vous suffit de les **s√©lectionner**, d'appuyer sur "**Load**" et d'appuyer sur "**Start Instrumentation**" (vous pourrez voir les journaux de ces scripts dans "**Frida Live Logs**").

![](<../../.gitbook/assets/image (215).png>)

De plus, vous disposez de certaines fonctionnalit√©s auxiliaires de Frida :

* **√ânum√©rer les classes charg√©es** : il affichera toutes les classes charg√©es
* **Capturer les cha√Ænes de caract√®res** : il affichera toutes les cha√Ænes de caract√®res captur√©es lors de l'utilisation de l'application (tr√®s bruyant)
* **Capturer les comparaisons de cha√Ænes de caract√®res** : pourrait √™tre tr√®s utile. Il **affichera les 2 cha√Ænes de caract√®res compar√©es** et si le r√©sultat √©tait vrai ou faux.
* **√ânum√©rer les m√©thodes de classe** : mettez le nom de la classe (comme "java.io.File") et il affichera toutes les m√©thodes de la classe.
* **Rechercher un mod√®le de classe** : recherche de classes par mod√®le
* **Tracer les m√©thodes de classe** : **tracer** une **classe enti√®re** (voir les entr√©es et sorties de toutes les m√©thodes de la classe). N'oubliez pas que par d√©faut, MobSF trace plusieurs m√©thodes Android Api int√©ressantes.

Une fois que vous avez s√©lectionn√© le module auxiliaire que vous souhaitez utiliser, vous devez appuyer sur "**Start Intrumentation**" et vous verrez toutes les sorties dans "**Frida Live Logs**".

**Shell**

Mobsf vous offre √©galement une shell avec quelques commandes **adb**, des commandes **MobSF** et des commandes **shell** courantes en bas de la page d'analyse dynamique. Quelques commandes int√©ressantes :
```
help
shell ls
activities
exported_activities
services
receivers
```
**Outils HTTP**

Lorsque le trafic http est captur√©, vous pouvez voir une vue peu attrayante du trafic captur√© sur "**HTTP(S) Traffic**" en bas ou une vue plus agr√©able sur "**Start HTTPTools**" en bas vert. √Ä partir de la deuxi√®me option, vous pouvez **envoyer** les **requ√™tes captur√©es** √† des **proxys** tels que Burp ou Owasp ZAP.\
Pour ce faire, _allumez Burp -->_ _d√©sactivez Intercept --> dans MobSB HTTPTools s√©lectionnez la requ√™te_ --> appuyez sur "**Send to Fuzzer**" --> _s√©lectionnez l'adresse du proxy_ ([http://127.0.0.1:8080\\](http://127.0.0.1:8080)).

Une fois que vous avez termin√© l'analyse dynamique avec MobSF, vous pouvez appuyer sur "**Start Web API Fuzzer**" pour **fuzzer les requ√™tes http** et rechercher des vuln√©rabilit√©s.

{% hint style="info" %}
Apr√®s avoir effectu√© une analyse dynamique avec MobSF, les param√®tres de proxy peuvent √™tre mal configur√©s et vous ne pourrez pas les corriger √† partir de l'interface graphique. Vous pouvez corriger les param√®tres de proxy en faisant:
```
adb shell settings put global http_proxy :0
```
{% endhint %}

### Analyse Dynamique Assist√©e avec Inspeckage

Vous pouvez obtenir l'outil √† partir de [**Inspeckage**](https://github.com/ac-pm/Inspeckage).\
Cet outil utilise des **Hooks** pour vous informer de **ce qui se passe dans l'application** pendant que vous effectuez une **analyse dynamique**.

{% content-ref url="inspeckage-tutorial.md" %}
[inspeckage-tutorial.md](inspeckage-tutorial.md)
{% endcontent-ref %}

### [Yaazhini](https://www.vegabird.com/yaazhini/)

C'est un **excellent outil pour effectuer une analyse statique avec une interface graphique**

![](<../../.gitbook/assets/image (527).png>)

### [Qark](https://github.com/linkedin/qark)

Cet outil est con√ßu pour rechercher plusieurs **vuln√©rabilit√©s de s√©curit√© li√©es aux applications Android**, soit dans le **code source** soit dans les **APK empaquet√©s**. L'outil est √©galement **capable de cr√©er un APK d√©ployable "Proof-of-Concept"** et des **commandes ADB** pour exploiter certaines des vuln√©rabilit√©s trouv√©es (activit√©s expos√©es, intents, tapjacking...). Comme avec Drozer, il n'est pas n√©cessaire de rooter l'appareil de test.
```bash
pip3 install --user qark  # --user is only needed if not using a virtualenv
qark --apk path/to/my.apk
qark --java path/to/parent/java/folder
qark --java path/to/specific/java/file.java
```
### [**ReverseAPK**](https://github.com/1N3/ReverseAPK.git)

* Affiche tous les fichiers extraits pour une r√©f√©rence facile
* D√©compile automatiquement les fichiers APK en format Java et Smali
* Analyse AndroidManifest.xml pour les vuln√©rabilit√©s et comportements courants
* Analyse de code source statique pour les vuln√©rabilit√©s et comportements courants
  * Informations sur l'appareil
  * Intents
  * Ex√©cution de commandes
  * R√©f√©rences SQLite
  * R√©f√©rences de journalisation
  * Fournisseurs de contenu
  * R√©cepteurs de diffusion
  * R√©f√©rences de service
  * R√©f√©rences de fichiers
  * R√©f√©rences de cryptographie
  * Secrets cod√©s en dur
  * URL
  * Connexions r√©seau
  * R√©f√©rences SSL
  * R√©f√©rences WebView
```
reverse-apk relative/path/to/APP.apk
```
### [SUPER Android Analyzer](https://github.com/SUPERAndroidAnalyzer/super)

SUPER est une application en ligne de commande qui peut √™tre utilis√©e sur Windows, MacOS X et Linux, pour analyser les fichiers _.apk_ √† la recherche de vuln√©rabilit√©s. Elle le fait en d√©compressant les APKs et en appliquant une s√©rie de r√®gles pour d√©tecter ces vuln√©rabilit√©s.

Toutes les r√®gles sont centr√©es dans un fichier `rules.json`, et chaque entreprise ou testeur peut cr√©er ses propres r√®gles pour analyser ce dont il a besoin.

T√©l√©chargez les derniers binaires sur la [page de t√©l√©chargement](https://superanalyzer.rocks/download.html).
```
super-analyzer {apk_file}
```
### [StaCoAn](https://github.com/vincentcox/StaCoAn)

![](<../../.gitbook/assets/image (62).png>)

StaCoAn est un outil **multiplateforme** qui aide les d√©veloppeurs, les chasseurs de primes et les hackers √©thiques √† effectuer une [analyse de code statique](https://en.wikipedia.org/wiki/Static\_program\_analysis) sur les applications mobiles\*.

Le concept est que vous faites glisser et d√©posez votre fichier d'application mobile (un fichier .apk ou .ipa) sur l'application StaCoAn et elle g√©n√©rera un rapport visuel et portable pour vous. Vous pouvez ajuster les param√®tres et les listes de mots pour obtenir une exp√©rience personnalis√©e.

T√©l√©chargez la [derni√®re version](https://github.com/vincentcox/StaCoAn/releases) :
```
./stacoan
```
### [AndroBugs](https://github.com/AndroBugs/AndroBugs\_Framework)

AndroBugs Framework est un syst√®me d'analyse de vuln√©rabilit√©s Android qui aide les d√©veloppeurs ou les hackers √† trouver des vuln√©rabilit√©s de s√©curit√© potentielles dans les applications Android.\
[Versions pour Windows](https://github.com/AndroBugs/AndroBugs\_Framework/releases)
```
python androbugs.py -f [APK file]
androbugs.exe -f [APK file]
```
### [Androwarn](https://github.com/maaaaz/androwarn)

**Androwarn** est un outil dont le but principal est de d√©tecter et d'avertir l'utilisateur des comportements malveillants potentiels d√©velopp√©s par une application Android.

La d√©tection est effectu√©e avec l'**analyse statique** du bytecode Dalvik de l'application, repr√©sent√© sous forme de **Smali**, avec la biblioth√®que [`androguard`](https://github.com/androguard/androguard).

Cet outil recherche les **comportements courants des "mauvaises" applications** tels que : l'exfiltration d'identifiants de t√©l√©phonie, l'interception de flux audio/vid√©o, la modification de donn√©es PIM, l'ex√©cution de code arbitraire...
```
python androwarn.py -i my_application_to_be_analyzed.apk -r html -v 3
```
### [MARA Framework](https://github.com/xtiankisutsa/MARA\_Framework)

![](<../../.gitbook/assets/image (81).png>)

**MARA** est un **F**ramework d'**A**nalyse et de **R**√©tro-ing√©nierie d'**A**pplications **M**obiles. C'est un outil qui rassemble des outils couramment utilis√©s pour la r√©tro-ing√©nierie et l'analyse d'applications mobiles, pour aider √† tester les applications mobiles contre les menaces de s√©curit√© mobiles OWASP. Son objectif est de rendre cette t√¢che plus facile et plus conviviale pour les d√©veloppeurs d'applications mobiles et les professionnels de la s√©curit√©.

Il est capable de :

* Extraire du code Java et Smali en utilisant diff√©rents outils
* Analyser les APK en utilisant : [smalisca](https://github.com/dorneanu/smalisca), [ClassyShark](https://github.com/google/android-classyshark), [androbugs](https://github.com/AndroBugs/AndroBugs\_Framework), [androwarn](https://github.com/maaaaz/androwarn), [APKiD](https://github.com/rednaga/APKiD)
* Extraire des informations priv√©es de l'APK en utilisant des expressions r√©guli√®res.
* Analyser le Manifeste.
* Analyser les domaines trouv√©s en utilisant : [pyssltest](https://github.com/moheshmohan/pyssltest), [testssl](https://github.com/drwetter/testssl.sh) et [whatweb](https://github.com/urbanadventurer/WhatWeb)
* D√©obfusquer l'APK via [apk-deguard.com](http://www.apk-deguard.com)

### Koodous

Utile pour d√©tecter les malwares : [https://koodous.com/](https://koodous.com)

<figure><img src="../../.gitbook/assets/image (7) (2).png" alt=""><figcaption></figcaption></figure>

[**Suivez HackenProof**](https://bit.ly/3xrrDrL) **pour en savoir plus sur les bugs web3**

üêû Lisez les tutoriels sur les bugs web3

üîî Soyez inform√© des nouveaux programmes de primes pour bugs

üí¨ Participez aux discussions de la communaut√©

## Obfuscation/D√©obfuscation de code

Notez que selon le service et la configuration que vous utilisez pour obfusquer le code, les secrets peuvent √™tre obfusqu√©s ou non.

### [ProGuard](https://en.wikipedia.org/wiki/ProGuard\_\(software\))

**ProGuard** est un outil en ligne de commande open source qui r√©duit la taille, optimise et obfusque le code Java. Il est capable d'optimiser le bytecode ainsi que de d√©tecter et supprimer les instructions inutilis√©es. ProGuard est un logiciel gratuit distribu√© sous la licence publique g√©n√©rale GNU, version 2.

ProGuard est distribu√© dans le cadre du kit de d√©veloppement Android et s'ex√©cute lors de la construction de l'application en mode release.

√Ä partir de : [https://en.wikipedia.org/wiki/ProGuard\_(software)](https://en.wikipedia.org/wiki/ProGuard\_\(software\))

### [DexGuard](https://www.guardsquare.com/dexguard)

Trouvez un guide √©tape par √©tape pour d√©obfusquer l'APK dans [https://blog.lexfo.fr/dexguard.html](https://blog.lexfo.fr/dexguard.html)

(Dans ce guide) La derni√®re fois que nous avons v√©rifi√©, le mode de fonctionnement de Dexguard √©tait :

* charger une ressource en tant que InputStream ;
* alimenter le r√©sultat dans une classe h√©ritant de FilterInputStream pour le d√©crypter ;
* faire une obfuscation inutile pour faire perdre quelques minutes de temps √† un r√©verseur ;
* alimenter le r√©sultat d√©crypt√© dans un ZipInputStream pour obtenir un fichier DEX ;
* enfin, charger le DEX r√©sultant en tant que ressource en utilisant la m√©thode `loadDex`.

### [DeGuard](http://apk-deguard.com)

**DeGuard inverse le processus d'obfuscation effectu√© par les outils d'obfuscation Android. Cela permet de nombreuses analyses de s√©curit√©, notamment l'inspection du code et la pr√©diction des biblioth√®ques.**

Vous pouvez t√©l√©charger un APK obfusqu√© sur leur plateforme.

### [Simplify](https://github.com/CalebFenton/simplify)

C'est un **d√©obfuscateur g√©n√©rique pour Android.** Simplify **ex√©cute virtuellement une application** pour comprendre son comportement, puis **essaie d'optimiser le code** pour qu'il se comporte de mani√®re identique mais soit plus facile √† comprendre pour un humain. Chaque type d'optimisation est simple et g√©n√©rique, donc peu importe le type sp√©cifique d'obfuscation utilis√©.

### [APKiD](https://github.com/rednaga/APKiD)

APKiD vous donne des informations sur **comment un APK a √©t√© cr√©√©**. Il identifie de nombreux **compilateurs**, **packers**, **obfuscateurs** et autres choses √©tranges. C'est [_PEiD_](https://www.aldeid.com/wiki/PEiD) pour Android.

### Manuel

[Lisez ce tutoriel pour apprendre quelques astuces sur **comment inverser l'obfuscation personnalis√©e**](manual-deobfuscation.md)

## Labs

### [Androl4b](https://github.com/sh4hin/Androl4b)

AndroL4b est une machine virtuelle de s√©curit√© Android bas√©e sur ubuntu-mate qui comprend la collection des derniers frameworks, tutoriels et laboratoires de diff√©rents geeks et chercheurs en s√©curit√© pour la r√©tro-ing√©nierie et l'analyse de malwares.

### OWASP

{% embed url="https://github.com/OWASP/owasp-mstg%0Ahttps://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06g-testing-network-communication" %}

### D√©p√¥ts Git

[https://github.com/riddhi-shree/nullCommunity/tree/master/Android](https://github.com/riddhi-shree/nullCommunity/tree/master/Android)\
[https://www.youtube.com/watch?v=PMKnPaGWxtg\&feature=youtu.be\&ab\_channel=B3nacSec](https://www.youtube.com/watch?v=PMKnPaGWxtg\&feature=youtu.be\&ab\_channel=B3nacSec)

## R√©f√©rences

Pour plus d'informations, visitez :

* [https://appsecwiki.com/#/](https://appsecwiki.com/#/) C'est une excellente liste de ressources
* [https://maddiestone.github.io/AndroidAppRE/](https://maddiestone.github.io/AndroidAppRE/) Cours rapide sur Android
* [https://manifestsecurity.com/android-application-security/](https://manifestsecurity.com/android-application-security/)
* [https://github.com/Ralireza/Android-Security-Teryaagh](https://github.com/Ralireza/Android-Security-Teryaagh)

## √Ä tester

* [https://www.vegabird.com/yaazhini/](https://www.vegabird.com/yaazhini/)
* [https://github.com/abhi-r3v0/Adhrit](https://github.com/abhi-r3v0/Adhrit)

<figure><img src="../../.gitbook/assets/image (7) (2).png" alt=""><figcaption></figcaption></figure>

[**Suivez HackenProof**](https://bit.ly/3xrrDrL) **pour en savoir plus sur les bugs web3**

üêû Lisez les tutoriels sur les bugs web3

üîî Soyez inform√© des nouveaux programmes de primes pour bugs

üí¨ Participez aux discussions de la communaut√©

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous
