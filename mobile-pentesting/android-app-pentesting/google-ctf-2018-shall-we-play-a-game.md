# Google CTF 2018 - Giochiamo a un gioco?

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team di HackTricks AWS)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos di github.

</details>

Scarica l'APK qui:

Sto per caricare l'APK su [https://appetize.io/](https://appetize.io) (account gratuito) per vedere come si comporta l'apk:

![](<../../.gitbook/assets/image (421).png>)

Sembra che tu debba vincere 1000000 volte per ottenere la flag.

Seguendo i passaggi del [pentesting Android](./) puoi decompilare l'applicazione per ottenere il codice smali e leggere il codice Java usando jadx.

Lettura del codice java:

![](<../../.gitbook/assets/image (495).png>)

Sembra che la funzione che stamper√† la flag sia **m().**

## **Modifiche Smali**

### **Chiamata a m() la prima volta**

Facciamo s√¨ che l'applicazione chiami m() se la variabile _this.o != 1000000_ per farlo, basta cambiare la condizione:
```
if-ne v0, v9, :cond_2
```
# Google CTF 2018: Shall we play a game?

---

## Introduction

In this challenge, we are provided with an Android application named `shall-we-play-a-game.apk`. The goal is to find the flag by analyzing the application.

## Steps

1. **Decompile the APK**: Use tools like JADX or APKTool to decompile the APK file.

2. **Analyzing the Code**: Look for interesting code snippets, API calls, or any suspicious behavior in the decompiled code.

3. **Identify the Vulnerability**: Try to identify any security vulnerabilities such as insecure data storage, improper input validation, or insecure network communication.

4. **Exploit the Vulnerability**: Once the vulnerability is identified, exploit it to extract the flag.

## Conclusion

By following these steps and carefully analyzing the Android application, we can successfully find and extract the flag in the Google CTF 2018 challenge.
```
if-eq v0, v9, :cond_2
```
![Prima](<../../.gitbook/assets/image (383).png>)

![Dopo](<../../.gitbook/assets/image (838).png>)

Segui i passaggi del [pentest Android](./) per ricompilare e firmare l'APK. Successivamente, caricalo su [https://appetize.io/](https://appetize.io) e vediamo cosa succede:

![](<../../.gitbook/assets/image (128).png>)

Sembra che il flag sia scritto senza essere completamente decifrato. Probabilmente la funzione m() dovrebbe essere chiamata 1000000 volte.

**Un altro modo** per fare questo √® non cambiare l'istruzione ma cambiare le istruzioni confrontate:

![](<../../.gitbook/assets/image (840).png>)

**Un'altra via** √® invece di confrontare con 1000000, impostare il valore a 1 in modo che this.o venga confrontato con 1:

![](<../../.gitbook/assets/image (629).png>)

Un quarto modo √® aggiungere un'istruzione per spostare il valore di v9(1000000) in v0 _(this.o)_:

![](<../../.gitbook/assets/image (414).png>)

![](<../../.gitbook/assets/image (424).png>)

## Soluzione

Fai eseguire all'applicazione il loop 100000 volte quando vinci la prima volta. Per farlo, devi solo creare il loop **:goto\_6** e far s√¨ che l'applicazione **salte l√¨ se `this.o`** non ha valore 100000:

![](<../../.gitbook/assets/image (1090).png>)

Devi fare questo su un dispositivo fisico poich√© (non so perch√©) non funziona su un dispositivo emulato.

<details>

<summary><strong>Impara l'hacking di AWS da zero a esperto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
