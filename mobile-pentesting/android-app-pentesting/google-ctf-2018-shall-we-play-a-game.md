# Google CTF 2018 - Sollen wir ein Spiel spielen?

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>

Laden Sie die APK hier herunter:

Ich werde die APK auf [https://appetize.io/](https://appetize.io) (kostenloses Konto) hochladen, um zu sehen, wie sich die APK verh√§lt:

![](<../../.gitbook/assets/image (46).png>)

Es scheint, als m√ºssten Sie 1000000 Mal gewinnen, um die Flagge zu erhalten.

Folgen Sie den Schritten von [Android-Pentesting](./), um die Anwendung zu dekompilieren und den Smali-Code zu erhalten und den Java-Code mit jadx zu lesen.

Lesen des Java-Codes:

![](<../../.gitbook/assets/image (47).png>)

Es scheint, als w√§re die Funktion, die die Flagge ausgeben wird, **m().**

## **Smali-√Ñnderungen**

### **Rufen Sie m() das erste Mal auf**

Lassen Sie die Anwendung m() aufrufen, wenn die Variable _this.o != 1000000_ ist. √Ñndern Sie dazu einfach die Bedingung:
```
if-ne v0, v9, :cond_2
```
/hive/hacktricks/mobile-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.md

# Shall we play a game?

## Challenge Description

This challenge is about a simple Android app that allows the user to play a game. The goal is to find a way to cheat and win the game.

## Challenge Solution

To solve this challenge, we need to analyze the app and find any vulnerabilities that can be exploited. 

### Step 1: Decompiling the APK

First, we need to decompile the APK file to get the source code. We can use tools like JADX or apktool for this task. Once we have the source code, we can analyze it for any potential vulnerabilities.

### Step 2: Analyzing the Source Code

In the source code, we can look for any insecure coding practices or logic flaws that can be exploited. We should pay attention to functions related to game logic, user input validation, and authentication.

### Step 3: Finding Vulnerabilities

Once we have identified potential vulnerabilities, we can start exploiting them. This may involve bypassing authentication, manipulating game logic, or finding ways to execute arbitrary code.

### Step 4: Exploiting the Vulnerabilities

After finding a vulnerability, we can exploit it to cheat and win the game. This may involve modifying game variables, injecting code, or manipulating network requests.

## Conclusion

In this challenge, we learned how to analyze an Android app for vulnerabilities and exploit them to cheat in a game. It is important to understand the app's source code and look for any insecure coding practices or logic flaws. By finding and exploiting vulnerabilities, we can gain an advantage and win the game.
```
if-eq v0, v9, :cond_2
```
![Vorher](<../../.gitbook/assets/image (48).png>)

![Nachher](<../../.gitbook/assets/image (49).png>)

Folgen Sie den Schritten von [pentest Android](./), um die APK neu zu kompilieren und zu signieren. Laden Sie sie dann auf [https://appetize.io/](https://appetize.io) hoch und schauen Sie, was passiert:

![](<../../.gitbook/assets/image (50).png>)

Es sieht so aus, als ob die Flagge geschrieben wird, ohne vollst√§ndig entschl√ºsselt zu werden. Wahrscheinlich sollte die Funktion m() 1000000 Mal aufgerufen werden.

**Eine andere M√∂glichkeit**, dies zu tun, besteht darin, die Anweisung nicht zu √§ndern, sondern die verglichenen Anweisungen zu √§ndern:

![](<../../.gitbook/assets/image (55).png>)

**Eine weitere M√∂glichkeit** besteht darin, anstelle von 1000000 mit dem Wert 1 zu vergleichen, sodass this.o mit 1 verglichen wird:

![](<../../.gitbook/assets/image (57).png>)

Eine vierte M√∂glichkeit besteht darin, eine Anweisung hinzuzuf√ºgen, um den Wert von v9 (1000000) nach v0 _(this.o)_ zu verschieben:

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## L√∂sung

Lassen Sie die Anwendung die Schleife 100000 Mal ausf√ºhren, wenn Sie das erste Mal gewinnen. Dazu m√ºssen Sie nur die Schleife **:goto\_6** erstellen und die Anwendung **dorthin springen lassen, wenn `this.o`** nicht den Wert 100000 hat\:

![](<../../.gitbook/assets/image (59).png>)

Sie m√ºssen dies auf einem physischen Ger√§t tun, da dies (aus unbekannten Gr√ºnden) auf einem emulierten Ger√§t nicht funktioniert.

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories senden.

</details>
