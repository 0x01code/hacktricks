# Google CTF 2018 - рдХреНрдпрд╛ рд╣рдо рдПрдХ рдЦреЗрд▓ рдЦреЗрд▓реЗрдВ?

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks рдХреНрд▓рд╛рдЙрдб тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж рдЯреНрд╡рд┐рдЯрд░ ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П рдЯреНрд╡рд┐рдЪ ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе рдпреВрдЯреНрдпреВрдм ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ**

</details>

рдпрд╣рд╛рдВ APK рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ:

рдореИрдВ [https://appetize.io/](https://appetize.io) (рдореБрдлреНрдд рдЦрд╛рддрд╛) рдкрд░ APK рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реВрдБ рддрд╛рдХрд┐ рджреЗрдЦ рд╕рдХреВрдБ рдХрд┐ APK рдХрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреИрд╕рд╛ рд╣реИ:

![](<../../.gitbook/assets/image (46).png>)

рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рдлрд╝реНрд▓реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 1000000 рдмрд╛рд░ рдЬреАрддрдирд╛ рд╣реЛрдЧрд╛ред

[Android рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ](./) рдХреЗ рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдХреЗ рдЖрдк рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдбрд┐рдХрдВрдкрд╛рдЗрд▓ рдХрд░рдХреЗ рд╕реНрдорд╛рд▓реА рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ jadx рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрд╛рд╡рд╛ рдХреЛрдб рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред

рдЬрд╛рд╡рд╛ рдХреЛрдб рдкрдврд╝рдирд╛:

![](<../../.gitbook/assets/image (47).png>)

рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдлрд╝реНрд▓реИрдЧ рдкреНрд░рд┐рдВрдЯ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдлрд╝рдВрдХреНрд╢рди **m()** рд╣реИред

## **рд╕реНрдорд╛рд▓реА рдмрджрд▓рд╛рд╡**

### **рдкрд╣рд▓реА рдмрд╛рд░ m() рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ**

рд╣рдо рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ m() рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдПрдВрдЧреЗ рдЕрдЧрд░ рдЪрд░ _this.o != 1000000_ рд╣реИ рддреЛ, рдмрд╕ рд╢рд░реНрдд рдХреЛ рдмрджрд▓реЗрдВ:
```
if-ne v0, v9, :cond_2
```
/hive/hacktricks/mobile-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.md

# Shall we play a game?

This challenge is about a simple Android app that asks the user to play a game. The app has a button that, when clicked, sends a request to the server with the user's input. The server then responds with a message indicating whether the user has won or lost the game.

## Analyzing the APK

To start, we need to analyze the APK file of the app. We can use tools like JADX or APKTool to decompile the APK and obtain the source code.

Once we have the source code, we can look for any vulnerabilities or interesting functions that could be exploited. In this case, we find a function called `sendRequest()` that is responsible for sending the user's input to the server.

## Intercepting the request

To intercept the request sent by the app, we can use a tool like Burp Suite. By configuring our device to use a proxy, we can intercept and modify the requests made by the app.

Once we have intercepted the request, we can modify the parameters to see how the server responds. In this case, we can modify the `input` parameter to test different scenarios.

## Exploiting the vulnerability

After analyzing the server's response, we can identify a vulnerability in the app. The server's response contains a flag that indicates whether the user has won or lost the game. However, the flag is not properly validated on the client side.

By modifying the server's response, we can change the flag to indicate that the user has won the game, regardless of their input. This can be done by intercepting the response and modifying the `flag` parameter.

## Conclusion

In this challenge, we were able to exploit a vulnerability in an Android app by intercepting and modifying the requests and responses. By changing the flag in the server's response, we were able to win the game regardless of our input.

This highlights the importance of properly validating and securing user input in mobile apps to prevent vulnerabilities like this.
```
if-eq v0, v9, :cond_2
```
![Before](<../../.gitbook/assets/image (48).png>)

![After](<../../.gitbook/assets/image (49).png>)

[Android рдкреЗрдВрдЯреЗрд╕реНрдЯ](./) рдХреЗ рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ рддрд╛рдХрд┐ APK рдХреЛ рдкреБрдирдГ рдХрдВрдкрд╛рдЗрд▓ рдФрд░ рд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдлрд┐рд░, рдЗрд╕реЗ [https://appetize.io/](https://appetize.io) рдкрд░ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (50).png>)

рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдлреНрд▓реИрдЧ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдП рдмрд┐рдирд╛ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИред рд╢рд╛рдпрдж m() рдлрд╝рдВрдХреНрд╢рди рдХреЛ 1000000 рдмрд╛рд░ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

рдЗрд╕реЗ рдХрд░рдиреЗ рдХрд╛ **рджреВрд╕рд░рд╛ рддрд░реАрдХрд╛** рдпрд╣ рд╣реИ рдХрд┐ рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рдмрдЬрд╛рдп рддреБрд▓рдирд╛ рдХреА рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдмрджрд▓реЗрдВ:

![](<../../.gitbook/assets/image (55).png>)

**рдПрдХ рдФрд░ рддрд░реАрдХрд╛** рд╣реИ рдХрд┐ 1000000 рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рдорд╛рди рдХреЛ 1 рд╕реЗрдЯ рдХрд░реЗрдВ рддрд╛рдХрд┐ this.o 1 рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХреА рдЬрд╛рдП:

![](<../../.gitbook/assets/image (57).png>)

рдЪреМрдерд╛ рддрд░реАрдХрд╛ рд╣реИ рдХрд┐ v9(1000000) рдХреЗ рдорд╛рди рдХреЛ v0 _(this.o)_ рдореЗрдВ рд▓реЗ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдирд┐рд░реНрджреЗрд╢ рдЬреЛрдбрд╝реЗрдВ:

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## рд╕рдорд╛рдзрд╛рди

рдЬрдм рдЖрдк рдкрд╣рд▓реА рдмрд╛рд░ рдЬреАрддрддреЗ рд╣реИрдВ, рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рджреМрд░ 100000 рдмрд╛рд░ рдЪрд▓рд╛рдПрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдХреЗрд╡рд▓ **:goto\_6** рд▓реВрдк рдмрдирд╛рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╡рд╣рд╛рдВ **рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдиреЗ рджреЗрдВ рдЕрдЧрд░ \_this.o**\_\*\* рдХрд╛ рдорд╛рди 100000 рдирд╣реАрдВ рд╣реИред

![](<../../.gitbook/assets/image (59).png>)

рдЖрдкрдХреЛ рдЗрд╕реЗ рдПрдХ рднреМрддрд┐рдХ рдЙрдкрдХрд░рдг рдХреЗ рдЕрдВрджрд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ (рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ рдХреНрдпреЛрдВ) рдЗрд╕реЗ рдПрдХ рдПрдореНрдпреБрд▓реЗрдЯреЗрдб рдЙрдкрдХрд░рдг рдореЗрдВ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдиреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ (https://github.com/carlospolop/hacktricks) рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ (https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗред

</details>
