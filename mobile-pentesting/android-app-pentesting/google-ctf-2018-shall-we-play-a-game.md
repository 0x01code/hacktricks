# Google CTF 2018 - Voulons-nous jouer √† un jeu?

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert de l'√©quipe rouge HackTricks AWS)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

T√©l√©chargez l'APK ici :

Je vais t√©l√©charger l'APK sur [https://appetize.io/](https://appetize.io) (compte gratuit) pour voir comment l'APK se comporte :

![](<../../.gitbook/assets/image (418).png>)

Il semble que vous devez gagner 1000000 fois pour obtenir le drapeau.

En suivant les √©tapes du [test d'intrusion Android](./), vous pouvez d√©compiler l'application pour obtenir le code smali et lire le code Java √† l'aide de jadx.

Lecture du code Java :

![](<../../.gitbook/assets/image (492).png>)

Il semble que la fonction qui va imprimer le drapeau est **m().**

## **Modifications Smali**

### **Appeler m() la premi√®re fois**

Faisons en sorte que l'application appelle m() si la variable _this.o != 1000000_ pour ce faire, il suffit de changer la condition :
```
if-ne v0, v9, :cond_2
```
# Google CTF 2018: Shall we play a game?

---

## Reconnaissance

### APK Analysis

- **APKTool**: Extract the APK file.
- **dex2jar**: Convert the APK to JAR.
- **JD-GUI**: Analyze the JAR file.
- **MobSF**: Scan the APK for vulnerabilities.

## Finding the Flag

- **Flag**: `CTF{********}`

## Conclusion

The Google CTF 2018 challenge "Shall we play a game?" involved analyzing an APK file to find the hidden flag. By using tools like APKTool, dex2jar, JD-GUI, and MobSF, the flag was successfully discovered.
```
if-eq v0, v9, :cond_2
```
![Avant](<../../.gitbook/assets/image (380).png>)

![Apr√®s](<../../.gitbook/assets/image (835).png>)

Suivez les √©tapes du [pentest Android](./) pour recompiler et signer l'APK. Ensuite, t√©l√©chargez-le sur [https://appetize.io/](https://appetize.io) et voyons ce qui se passe :

![](<../../.gitbook/assets/image (125).png>)

Il semble que le drapeau soit √©crit sans √™tre compl√®tement d√©chiffr√©. Probablement la fonction m() devrait √™tre appel√©e 1000000 fois.

**Une autre fa√ßon** de faire cela est de ne pas changer l'instruction mais de changer les instructions compar√©es :

![](<../../.gitbook/assets/image (837).png>)

**Une autre fa√ßon** est au lieu de comparer avec 1000000, d√©finir la valeur √† 1 pour que this.o soit compar√© √† 1 :

![](<../../.gitbook/assets/image (626).png>)

Une quatri√®me fa√ßon est d'ajouter une instruction pour d√©placer la valeur de v9 (1000000) vers v0 _(this.o)_ :

![](<../../.gitbook/assets/image (411).png>)

![](<../../.gitbook/assets/image (421).png>)

## Solution

Faites en sorte que l'application ex√©cute la boucle 100000 fois lorsque vous gagnez la premi√®re fois. Pour ce faire, vous devez simplement cr√©er la boucle **:goto\_6** et faire en sorte que l'application **saute l√†-bas si `this.o`** n'a pas la valeur 100000 :

![](<../../.gitbook/assets/image (1087).png>)

Vous devez faire cela sur un appareil physique car (je ne sais pas pourquoi) cela ne fonctionne pas sur un appareil √©mul√©.

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

D'autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez** üí¨ le groupe [**Discord**](https://discord.gg/hRep4RUj7f) ou le groupe [**telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
