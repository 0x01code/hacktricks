# Google CTF 2018 - Zagramy w grę?

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Zdobądź [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR-y do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>

Pobierz plik APK tutaj:

Zamierzam przesłać plik APK na [https://appetize.io/](https://appetize.io) (konto darmowe), aby zobaczyć, jak zachowuje się apk:

![](<../../.gitbook/assets/image (421).png>)

Wygląda na to, że musisz wygrać 1000000 razy, aby zdobyć flagę.

Postępując zgodnie z krokami [testowania penetracyjnego Androida](./), możesz zdekompilować aplikację, aby uzyskać kod smali i przeczytać kod Javy za pomocą jadx.

Czytanie kodu Javy:

![](<../../.gitbook/assets/image (495).png>)

Wygląda na to, że funkcja, która wydrukuje flagę, to **m().**

## **Zmiany w kodzie Smali**

### **Wywołanie m() po raz pierwszy**

Zmodyfikujmy aplikację tak, aby wywoływała m(), jeśli zmienna _this.o != 1000000_, aby to zrobić, po prostu zmień warunek:
```
if-ne v0, v9, :cond_2
```
## Google CTF 2018: Shall we play a game?

---

### Introduction

In this challenge, we are provided with an Android application named "Shall we play a game?". The goal is to find the flag by analyzing the app's behavior and identifying any vulnerabilities that can be exploited.

### Challenge Overview

The app presents a simple interface with a button that, when clicked, displays a message. By decompiling the APK and analyzing the source code, we can discover how the app processes user input and determine if there are any security flaws that can lead to the flag.

### Decompiling the APK

To decompile the APK, we can use tools like JADX or apktool. By examining the decompiled code, we can identify potential areas of interest such as input validation, cryptographic operations, or hidden functionalities that may reveal the flag.

### Finding the Flag

Through static analysis and dynamic testing, we can uncover vulnerabilities such as insecure data storage, improper input validation, or unintended behavior triggered by specific user actions. By exploiting these weaknesses, we can extract the flag and complete the challenge.

### Conclusion

The "Shall we play a game?" Android app challenge from Google CTF 2018 provides an opportunity to practice mobile application pentesting techniques and hone our skills in identifying and exploiting security issues in Android apps.
```
if-eq v0, v9, :cond_2
```
![Przed](<../../.gitbook/assets/image (383).png>)

![Po](<../../.gitbook/assets/image (838).png>)

Postępuj zgodnie z krokami [pentest Android](./), aby ponownie skompilować i podpisać plik APK. Następnie załaduj go na [https://appetize.io/](https://appetize.io) i zobaczmy, co się stanie:

![](<../../.gitbook/assets/image (128).png>)

Wygląda na to, że flaga jest zapisana bez pełnego odszyfrowania. Prawdopodobnie funkcja m() powinna być wywołana 1000000 razy.

**Inny sposób** na to jest nie zmieniać instrukcji, ale zmienić instrukcje porównywane:

![](<../../.gitbook/assets/image (840).png>)

**Innym sposobem** jest zamiast porównywać z 1000000, ustawić wartość na 1, aby this.o był porównywany z 1:

![](<../../.gitbook/assets/image (629).png>)

Czwarty sposób to dodanie instrukcji przeniesienia wartości v9(1000000) do v0 _(this.o)_:

![](<../../.gitbook/assets/image (414).png>)

![](<../../.gitbook/assets/image (424).png>)

## Rozwiązanie

Spowoduj, aby aplikacja wykonywała pętlę 100 000 razy po wygranej pierwszym razem. Aby to zrobić, wystarczy utworzyć pętlę **:goto\_6** i sprawić, aby aplikacja **przeskoczyła tam, jeśli `this.o`** nie ma wartości 100 000:

![](<../../.gitbook/assets/image (1090).png>)

Musisz to zrobić na fizycznym urządzeniu, ponieważ (nie wiem dlaczego) nie działa to na urządzeniu wirtualnym.

<details>

<summary><strong>Naucz się hakować AWS od zera do bohatera z</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Inne sposoby wsparcia HackTricks:

* Jeśli chcesz zobaczyć swoją **firmę reklamowaną w HackTricks** lub **pobrać HackTricks w formacie PDF**, sprawdź [**PLANY SUBSKRYPCYJNE**](https://github.com/sponsors/carlospolop)!
* Kup [**oficjalne gadżety PEASS & HackTricks**](https://peass.creator-spring.com)
* Odkryj [**Rodzinę PEASS**](https://opensea.io/collection/the-peass-family), naszą kolekcję ekskluzywnych [**NFT**](https://opensea.io/collection/the-peass-family)
* **Dołącz do** 💬 [**grupy Discord**](https://discord.gg/hRep4RUj7f) lub [**grupy telegramowej**](https://t.me/peass) lub **śledź** nas na **Twitterze** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podziel się swoimi sztuczkami hakerskimi, przesyłając PR do** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) na GitHubie.

</details>
