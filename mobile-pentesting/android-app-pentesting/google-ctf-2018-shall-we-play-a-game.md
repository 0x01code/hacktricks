# Google CTF 2018 - Da li da igramo igru?

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite svoju **kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitteru** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

Preuzmite APK ovde:

Nameravam da postavim APK na [https://appetize.io/](https://appetize.io) (besplatan nalog) da vidim kako se apk ponaša:

![](<../../.gitbook/assets/image (421).png>)

Izgleda da morate pobediti 1000000 puta da biste dobili zastavu.

Prateći korake iz [pentesting Android](./) možete dekompajlirati aplikaciju da biste dobili smali kod i pročitali Java kod koristeći jadx.

Čitanje Java koda:

![](<../../.gitbook/assets/image (495).png>)

Izgleda da je funkcija koja će odštampati zastavu **m().**

## **Smali promene**

### **Poziv funkcije m() prvi put**

Napravimo aplikaciju da pozove m() ako je promenljiva _this.o != 1000000_, da bismo to uradili, samo promenite uslov:
```
if-ne v0, v9, :cond_2
```
## Google CTF 2018: Shall we play a game?

---

### Introduction

In this challenge, we are provided with an Android application named "Shall we play a game?". The goal is to find the flag by analyzing the app's behavior and understanding how it works.

### Initial analysis

Upon launching the app, we are presented with a simple interface containing a button that says "Play". Tapping on the button triggers a series of actions, which we need to analyze to uncover any potential vulnerabilities.

### Reverse engineering

To understand the app's inner workings, we can decompile the APK file using tools like JADX or apktool. By examining the decompiled code, we can identify any suspicious or interesting functions that might lead us to the flag.

### Finding the flag

After analyzing the app's code, we discover a hidden function that reveals the flag when called with the correct input. By interacting with the app and triggering this function, we can successfully retrieve the flag and complete the challenge.

### Conclusion

Through reverse engineering and careful analysis of the Android application, we were able to uncover the hidden flag and solve the Google CTF 2018 challenge.
```
if-eq v0, v9, :cond_2
```
![Pre](<../../.gitbook/assets/image (383).png>)

![Posle](<../../.gitbook/assets/image (838).png>)

Pratite korake [pentest Androida](./) da biste ponovo kompajlirali i potpisali APK. Zatim ga otpremite na [https://appetize.io/](https://appetize.io) i vidimo šta će se desiti:

![](<../../.gitbook/assets/image (128).png>)

Izgleda da je zastava napisana bez potpune dešifrovanosti. Verovatno bi trebalo pozvati funkciju m() 1000000 puta.

**Drugi način** da se ovo uradi je da se ne menja instrukcija već da se promene upoređene instrukcije:

![](<../../.gitbook/assets/image (840).png>)

**Još jedan način** je umesto upoređivanja sa 1000000, postaviti vrednost na 1 tako da se this.o upoređuje sa 1:

![](<../../.gitbook/assets/image (629).png>)

Četvrti način je dodavanje instrukcije za premeštanje vrednosti v9(1000000) u v0 _(this.o)_:

![](<../../.gitbook/assets/image (414).png>)

![](<../../.gitbook/assets/image (424).png>)

## Rešenje

Naterajte aplikaciju da izvrši petlju 100000 puta kada pobedite prvi put. Da biste to uradili, samo treba da kreirate **:goto\_6** petlju i naterate aplikaciju da **skoči tamo ako `this.o`** nema vrednost 100000:

![](<../../.gitbook/assets/image (1090).png>)

Ovo morate uraditi na fizičkom uređaju jer (ne znam zašto) ovo ne funkcioniše na emuliranom uređaju.

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili da **preuzmete HackTricks u PDF formatu** proverite [**PLANOVE ZA PRIJAVU**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili **telegram grupi** ili nas **pratite** na **Twitteru** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
