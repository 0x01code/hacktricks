# Google CTF 2018 - Shall We Play a Game?

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

Laai die APK hier af:

Ek gaan die APK oplaai na [https://appetize.io/](https://appetize.io) (gratis rekening) om te sien hoe die apk optree:

![](<../../.gitbook/assets/image (46).png>)

Dit lyk asof jy 1000000 keer moet wen om die vlag te kry.

Deur die stappe van [pentesting Android](./) te volg, kan jy die toepassing dekompilieer om die smali-kode te kry en die Java-kode te lees met behulp van jadx.

Lees die Java-kode:

![](<../../.gitbook/assets/image (47).png>)

Dit lyk asof die funksie wat die vlag gaan druk **m()** is.

## **Smali-veranderinge**

### **Roep m() die eerste keer aan**

Laat ons die toepassing m() laat roep as die veranderlike _this.o != 1000000_ is, om dit te doen, verander net die voorwaarde:
```
if-ne v0, v9, :cond_2
```
/hive/hacktricks/mobile-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.md

# Shall we play a game?

## Introduction

In this challenge, we are given an Android application called "Game". The goal is to find a flag hidden within the app. We will use various techniques to analyze the app and uncover the flag.

## Decompiling the APK

To begin, we need to decompile the APK file. We can use tools like JADX or apktool to accomplish this. Once decompiled, we can analyze the source code and look for any potential vulnerabilities.

## Analyzing the Source Code

After decompiling the APK, we can start analyzing the source code. We should look for any sensitive information that may be hardcoded, such as API keys or passwords. Additionally, we should search for any insecure data storage or communication methods.

## Reverse Engineering

If we are unable to find the flag through source code analysis, we can resort to reverse engineering the app. This involves disassembling the APK and analyzing the bytecode. Tools like JADX, JEB, or IDA Pro can be used for this purpose.

## Dynamic Analysis

Dynamic analysis involves running the app and monitoring its behavior in real-time. We can use tools like Frida or Xposed to hook into the app and intercept function calls or modify data. This can help us identify any hidden functionality or vulnerabilities.

## Exploiting Vulnerabilities

Once we have identified a vulnerability, we can proceed to exploit it. This may involve crafting malicious inputs, bypassing security measures, or manipulating the app's behavior to our advantage. The goal is to gain unauthorized access or extract the flag.

## Conclusion

In this challenge, we explored various techniques for analyzing and hacking an Android app. By decompiling the APK, analyzing the source code, reverse engineering, and performing dynamic analysis, we can uncover vulnerabilities and exploit them to achieve our goals.
```
if-eq v0, v9, :cond_2
```
![Voor](<../../.gitbook/assets/image (48).png>)

![Na](<../../.gitbook/assets/image (49).png>)

Volg die stappe van [pentest Android](./) om die APK te herkompilieer en te onderteken. Laai dit dan op na [https://appetize.io/](https://appetize.io) en kyk wat gebeur:

![](<../../.gitbook/assets/image (50).png>)

Dit lyk asof die vlag geskryf is sonder om heeltemal ontsluit te word. Waarskynlik moet die m() funksie 1000000 keer geroep word.

**'n Ander manier** om dit te doen, is om nie die instruksie te verander nie, maar om die vergelykingsinstruksies te verander:

![](<../../.gitbook/assets/image (55).png>)

**'n Ander manier** is om in plaas daarvan met 1000000 te vergelyk, die waarde na 1 te stel sodat this.o met 1 vergelyk word:

![](<../../.gitbook/assets/image (57).png>)

'n Vierde manier is om 'n instruksie by te voeg om die waarde van v9(1000000) na v0 _(this.o)_ te skuif:

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## Oplossing

Maak die toepassing die lus 100000 keer loop as jy die eerste keer wen. Om dit te doen, hoef jy net die **:goto\_6** lus te skep en die toepassing **daarheen te laat spring as `this.o`** nie die waarde 100000 het nie\:

![](<../../.gitbook/assets/image (59).png>)

Jy moet dit in 'n fisiese toestel doen, want (ek weet nie waarom nie) dit werk nie in 'n ge√´muleerde toestel nie.

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
