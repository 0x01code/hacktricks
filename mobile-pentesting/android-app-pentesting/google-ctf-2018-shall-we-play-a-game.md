# Google CTF 2018 - 我们来玩个游戏吧？

<details>

<summary><strong>从零开始学习AWS黑客技术，成为专家</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS红队专家）</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想在HackTricks中看到您的**公司广告**或**下载PDF格式的HackTricks**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS & HackTricks周边产品**](https://peass.creator-spring.com)
* 探索[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)收藏品
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**电报群组**](https://t.me/peass) 或 **关注**我的 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* 通过向 [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>

在此下载APK：

我将上传APK到[https://appetize.io/](https://appetize.io)（免费账户）以查看APK的行为：

![](<../../.gitbook/assets/image (46).png>)

看起来您需要赢得1000000次才能获得flag。

按照[Android渗透测试](./)中的步骤，您可以反编译应用程序以获取smali代码，并使用jadx读取Java代码。

阅读Java代码：

![](<../../.gitbook/assets/image (47).png>)

看起来打印flag的函数是 **m().**

## **Smali更改**

### **第一次调用m()**

让应用程序在变量 _this.o != 1000000_ 时调用m()，只需更改条件：
```
if-ne v0, v9, :cond_2
```
## Google CTF 2018: Shall we play a game?

---

### Task 1: Install the APK

1. Download the APK from the challenge page.
2. Install the APK on your Android device.

---

### Task 2: Explore the app

1. Open the app and explore its functionalities.
2. Use tools like APKTool, JADX, and JEB to analyze the APK.
3. Look for interesting strings, APIs, and endpoints.

---

### Task 3: Analyze the network traffic

1. Use tools like Burp Suite or Wireshark to intercept and analyze the app's network traffic.
2. Look for any sensitive information being transmitted.
3. Identify any potential security vulnerabilities in the network communication.

---

### Task 4: Reverse engineering

1. Use tools like JADX, Ghidra, or IDA Pro to reverse engineer the APK.
2. Analyze the app's code and look for vulnerabilities or backdoors.
3. Try to understand the app's logic and how it handles user input.

---

### Task 5: Exploit the app

1. Exploit any vulnerabilities found during the analysis.
2. Try to bypass any security mechanisms implemented in the app.
3. Gain unauthorized access or control over the app.

---

### Task 6: Get the flag

1. Find and extract the flag from the app.
2. Submit the flag to complete the challenge.

---

By completing these tasks, you will gain a better understanding of Android app pentesting and hone your skills as a mobile security professional. Good luck!
```
if-eq v0, v9, :cond_2
```
![之前](<../../.gitbook/assets/image (48).png>)

![之后](<../../.gitbook/assets/image (49).png>)

按照[Android渗透测试](./)的步骤重新编译并签署APK。然后，将其上传到[https://appetize.io/](https://appetize.io)，看看会发生什么：

![](<../../.gitbook/assets/image (50).png>)

看起来旗标是未完全解密就被写入的。可能应该调用m()函数1000000次。

**另一种**方法是不更改指令，而是更改比较指令：

![](<../../.gitbook/assets/image (55).png>)

**另一种**方法是将值与1000000进行比较，将值设置为1，以便将this.o与1进行比较：

![](<../../.gitbook/assets/image (57).png>)

第四种方法是添加一条指令将v9(1000000)的值移动到v0 _(this.o)_：

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## 解决方案

当您第一次获胜时，使应用程序运行循环100000次。为此，您只需要创建**：goto\_6**循环，并使应用程序**跳转到那里，如果`this.o`**的值不是100000\：

![](<../../.gitbook/assets/image (59).png>)

您需要在物理设备内执行此操作，因为（我不知道为什么）在模拟设备中无法正常工作。
