# Google CTF 2018 - 게임을 할까요?

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)를 통해 제로에서 영웅까지 AWS 해킹을 배우세요</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사가 HackTricks에 광고되길 원하거나 HackTricks를 PDF로 다운로드하고 싶다면** [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왜그**](https://peass.creator-spring.com)를 구매하세요
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 당사의 독점 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션
* **💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **가입**하거나 **트위터** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**를** **팔로우**하세요.
* **HackTricks** 및 **HackTricks Cloud** github 저장소에 PR을 제출하여 **당신의 해킹 트릭을 공유**하세요.

</details>

APK를 여기서 다운로드하세요:

APK를 [https://appetize.io/](https://appetize.io) (무료 계정)에 업로드할 것입니다. APK가 어떻게 작동하는지 확인해보겠습니다:

![](<../../.gitbook/assets/image (421).png>)

플래그를 얻으려면 1000000번 이기어야 하는 것으로 보입니다.

[pentesting Android](./)에서의 단계를 따라 어플리케이션을 디컴파일하여 smali 코드를 얻고 jadx를 사용하여 Java 코드를 읽을 수 있습니다.

Java 코드 읽기:

![](<../../.gitbook/assets/image (495).png>)

플래그를 출력할 함수는 **m().** 인 것으로 보입니다.

## **Smali 변경**

### **첫 번째로 m() 호출**

애플리케이션이 _this.o != 1000000_이면 m()을 호출하도록 만들어봅시다. 이를 위해 조건을 변경하세요:
```
if-ne v0, v9, :cond_2
```
# Google CTF 2018: Shall we play a game?

---

## Challenge description
The challenge was an Android APK file. The app presents you with a login screen, and after logging in, you are greeted with a screen that says "Shall we play a game?". There is a button to start the game, which when clicked, opens a new screen with a grid of numbers from 1 to 9.

---

## Vulnerability
The vulnerability in this app was that the game screen allowed you to input any number, and when you clicked the "Check" button, it would tell you if the number was correct or not. By intercepting the traffic between the app and the server, you could see that the response from the server contained the flag.

---

## Solution
To solve this challenge, you needed to intercept the traffic using a proxy tool like Burp Suite, send a request with a specific number, intercept the response, and extract the flag from the response. The flag was in the format `CTF{...}`.
```
if-eq v0, v9, :cond_2
```
![이전](<../../.gitbook/assets/image (383).png>)

![이후](<../../.gitbook/assets/image (838).png>)

[Android 팬테스트](./) 단계를 따라 APK를 다시 컴파일하고 서명합니다. 그런 다음 [https://appetize.io/](https://appetize.io)에 업로드하고 결과를 확인해 봅시다:

![](<../../.gitbook/assets/image (128).png>)

완전히 해독되지 않은 채로 플래그가 작성된 것으로 보입니다. 아마도 m() 함수를 100만 번 호출해야 할 것입니다.

이를 수행하는 **다른 방법**은 명령을 변경하지 않고 비교 명령을 변경하는 것입니다:

![](<../../.gitbook/assets/image (840).png>)

**또 다른 방법**은 1000000과 비교하는 대신 값이 1로 설정되도록 하여 this.o가 1과 비교되도록 하는 것입니다:

![](<../../.gitbook/assets/image (629).png>)

네 번째 방법은 v9(1000000)의 값을 v0 _(this.o)_로 이동하는 명령을 추가하는 것입니다:

![](<../../.gitbook/assets/image (414).png>)

![](<../../.gitbook/assets/image (424).png>)

## 해결책

첫 번째로 이기면 응용 프로그램이 루프를 100,000번 실행하도록 만듭니다. 이를 위해 **:goto\_6** 루프를 생성하고 응용 프로그램이 **`this.o`**가 100,000이 아닌 경우 거기로 **점프하도록** 만들어야 합니다:

![](<../../.gitbook/assets/image (1090).png>)

이것은 물리적 장치 내에서 수행해야 합니다(왜인지는 모르겠습니다) 가상 장치에서는 작동하지 않습니다.
