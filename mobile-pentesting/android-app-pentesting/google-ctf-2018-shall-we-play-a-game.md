# Google CTF 2018 - ゲームをしましょうか？

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>でAWSハッキングをゼロからヒーローまで学ぶ</strong></a><strong>！</strong></summary>

HackTricks をサポートする他の方法：

* **HackTricks で企業を宣伝したい** または **HackTricks をPDFでダウンロードしたい** 場合は [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を発見し、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションを見つける
* **💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f) に参加するか、[**telegramグループ**](https://t.me/peass) に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live) をフォローする。**
* **ハッキングトリックを共有するために、** [**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) のGitHubリポジトリにPRを提出する。

</details>

APKはこちらからダウンロードできます：

APKをアップロードして、APKの動作を確認するために [https://appetize.io/](https://appetize.io)（無料アカウント）にアップロードする予定です：

![](<../../.gitbook/assets/image (46).png>)

フラグを取得するには1000000回勝つ必要があるようです。

[pentesting Android](./) の手順に従って、アプリケーションを逆コンパイルしてsmaliコードを取得し、jadxを使用してJavaコードを読み取ることができます。

Javaコードを読む：

![](<../../.gitbook/assets/image (47).png>)

フラグを表示する関数は **m().** のようです。

## **Smaliの変更**

### **最初のm()の呼び出し**

アプリケーションが _this.o != 1000000_ の場合にm()を呼び出すようにしましょう。そのために、条件を変更するだけです：
```
if-ne v0, v9, :cond_2
```
```markdown
## Google CTF 2018: Shall we play a game?

### Challenge Description
The challenge is an Android APK where you have to play a game to get the flag. The game is a simple number-guessing game. You can input a number, and the app will tell you if the number is too high or too low. The goal is to guess the correct number to win the game and obtain the flag.

### Tools Used
- APKTool
- jadx
- Android Emulator

### Methodology
1. **Decompile the APK**: Use APKTool to decompile the APK file.
2. **Understand the Code**: Analyze the decompiled code using jadx to understand how the game logic works.
3. **Identify Vulnerabilities**: Look for any vulnerabilities in the code that can be exploited to cheat in the game.
4. **Modify the Code**: Make necessary changes to the code to make it easier to win the game.
5. **Recompile and Test**: Recompile the APK with the modified code and test it in an Android Emulator to see if the changes work.
6. **Retrieve the Flag**: Play the game with the modified APK to guess the correct number and obtain the flag.

### Conclusion
By analyzing and modifying the game logic in the Android APK, we were able to cheat and win the game to retrieve the flag.
```
```html
<hr>
<p style="text-align:center">This content is from a hacking book about hacking techniques.</p>
```
```
if-eq v0, v9, :cond_2
```
![Before](<../../.gitbook/assets/image (48).png>)

![After](<../../.gitbook/assets/image (49).png>)

[pentest Android](./)の手順に従ってAPKを再コンパイルして署名します。その後、[https://appetize.io/](https://appetize.io)にアップロードして、何が起こるかを見てみましょう：

![](<../../.gitbook/assets/image (50).png>)

フラグが完全に復号化されずに書かれているようです。おそらくm()関数を1000000回呼び出す必要があります。

これを行う**別の方法**は、命令を変更せずに比較される命令を変更することです：

![](<../../.gitbook/assets/image (55).png>)

**別の方法**は、1000000と比較する代わりに、値を1に設定して、this.oが1と比較されるようにすることです：

![](<../../.gitbook/assets/image (57).png>)

四番目の方法は、v9（1000000）の値をv0（this.o）に移動する命令を追加することです：

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## 解決策

アプリケーションが最初に勝利したときにループを100000回実行するようにします。これを行うには、**:goto\_6**ループを作成し、アプリケーションが`this.o`の値が100000でない場合に**そこにジャンプ**するようにします\:

![](<../../.gitbook/assets/image (59).png>)

これは物理デバイス内で行う必要があります（なぜかはわかりません）仮想デバイスでは機能しません。

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）でAWSハッキングをゼロからヒーローまで学ぶ</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksのスウォッグ**](https://peass.creator-spring.com)を入手してください
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[NFTs](https://opensea.io/collection/the-peass-family)のコレクションを見つけます
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)を**フォロー**してください。
* **HackTricks**と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks)のGitHubリポジトリにPRを提出して、あなたのハッキングトリックを共有してください。

</details>
