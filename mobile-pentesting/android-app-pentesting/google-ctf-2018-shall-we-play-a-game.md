# Google CTF 2018 - ゲームをしましょうか？

<details>

<summary><strong>**htARTE (HackTricks AWS Red Team Expert)**</strong> から **ゼロからヒーローまでAWSハッキングを学ぶ**！</summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝したい** または **HackTricks をPDFでダウンロードしたい** 場合は [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を手に入れる
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を発見し、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションを見つける
* **💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f) に参加するか、[**telegramグループ**](https://t.me/peass) に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live) をフォローする**
* **ハッキングトリックを共有するために、PRを** [**HackTricks**](https://github.com/carlospolop/hacktricks) **と** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **のGitHubリポジトリに提出してください。**

</details>

APKはこちらからダウンロードできます:

APKをアップロードして、APKの動作を確認するために [https://appetize.io/](https://appetize.io)（無料アカウント）にアップロードする予定です:

![](<../../.gitbook/assets/image (421).png>)

フラグを取得するには1000000回勝つ必要があるようです。

[pentesting Android](./) の手順に従って、アプリケーションを逆コンパイルしてsmaliコードを取得し、jadxを使用してJavaコードを読み取ることができます。

Javaコードを読む:

![](<../../.gitbook/assets/image (495).png>)

フラグを印刷する関数は **m().** のようです。

## **Smaliの変更**

### **最初のm()の呼び出し**

アプリケーションが _this.o != 1000000_ の場合にm()を呼び出すようにしましょう。そのために、条件を変更するだけです:
```
if-ne v0, v9, :cond_2
```
# Google CTF 2018: Shall we play a game?

---

## Introduction

In this challenge, we are provided with an Android application named "Shall we play a game?". The goal is to find the flag by analyzing the app's behavior and identifying any vulnerabilities that can be exploited.

## Reconnaissance

### APK Analysis

1. **Decompiling the APK**: Use tools like JADX or apktool to decompile the APK file and analyze the source code.
2. **Static Analysis**: Look for hard-coded secrets, sensitive information, or any suspicious code that could lead to vulnerabilities.
3. **Dynamic Analysis**: Run the application in a controlled environment to observe its behavior at runtime.

## Exploitation

1. **Identifying Vulnerabilities**: Exploit common vulnerabilities like insecure storage, input validation issues, or insecure communication.
2. **Reverse Engineering**: Reverse engineer any obfuscated code to understand its functionality and identify potential attack vectors.
3. **Exploiting the Flag**: Once a vulnerability is identified, exploit it to retrieve the flag and complete the challenge.

By following these steps and leveraging your hacking skills, you can successfully complete the Google CTF 2018 challenge "Shall we play a game?" and enhance your penetration testing capabilities.
```
if-eq v0, v9, :cond_2
```
![前](<../../.gitbook/assets/image (383).png>)

![後](<../../.gitbook/assets/image (838).png>)

[pentest Android](./)の手順に従ってAPKを再コンパイルして署名します。その後、[https://appetize.io/](https://appetize.io)にアップロードして何が起こるか見てみましょう：

![](<../../.gitbook/assets/image (128).png>)

フラグが完全に復号化されずに書かれているようです。おそらくm()関数を1000000回呼び出す必要があります。

これを行う**別の方法**は、命令を変更せずに比較される命令を変更することです：

![](<../../.gitbook/assets/image (840).png>)

**別の方法**は、1000000と比較する代わりに、値を1に設定してthis.oが1と比較されるようにすることです：

![](<../../.gitbook/assets/image (629).png>)

4番目の方法は、v9(1000000)の値をv0 _(this.o)_ に移動する命令を追加することです：

![](<../../.gitbook/assets/image (414).png>)

![](<../../.gitbook/assets/image (424).png>)

## 解決策

アプリケーションが最初に勝利したときにループを100000回実行するようにします。これを行うには、**:goto\_6** ループを作成し、アプリケーションが **`this.o`** の値が100000でない場合に**そこにジャンプ**するようにします：

![](<../../.gitbook/assets/image (1090).png>)

これは物理デバイス内で行う必要があります（なぜかはわかりませんが、エミュレートされたデバイスでは機能しません）。

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> で **ゼロからヒーローまでのAWSハッキングを学びましょう**！</summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝したい**、または **HackTricks をPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を入手してください
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションを見つけてください
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f) に参加するか、[**telegramグループ**](https://t.me/peass) に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live) をフォローしてください。
* **HackTricks** と **HackTricks Cloud** のGitHubリポジトリにPRを提出して、あなたのハッキングトリックを共有してください。

</details>
