# Google CTF 2018 - Oyun Oynayalım mı?

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahramana kadar AWS hacklemeyi öğrenin!</summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family'yi**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)'da **takip edin.**
* **Hacking püf noktalarınızı paylaşarak PR göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>

APK'yı buradan indirin:

APK'yı [https://appetize.io/](https://appetize.io) (ücretsiz hesap) yükleyeceğim ve apk'nin nasıl davrandığını göreceğim:

![](<../../.gitbook/assets/image (418).png>)

Bayrağı alabilmek için 1000000 kez kazanmanız gerektiği görünüyor.

[Pentesting Android](./) adımlarını takip ederek uygulamayı decompile edebilir ve jadx kullanarak Java kodunu okuyabilirsiniz.

Java kodunu okuma:

![](<../../.gitbook/assets/image (492).png>)

Bayrağı yazdıracak olan fonksiyonun **m().** olduğu görünüyor.

## **Smali değişiklikler**

### **İlk kez m() çağrısı**

Uygulamanın _this.o != 1000000_ değişkeni ise m() fonksiyonunu çağırmasını sağlayalım, bunun için sadece koşulu değiştirin:
```
if-ne v0, v9, :cond_2
```
```markdown
## Shall we play a game?

### Challenge Description
The challenge is an Android application where you have to play a game to get the flag. The game is a simple Tic-Tac-Toe game where you have to win against the computer to get the flag.

### Challenge Solution
1. Decompile the APK file using JADX or apktool.
2. Analyze the source code to understand the logic of the game.
3. Identify the algorithm used by the computer to make its moves.
4. Modify the source code to manipulate the game logic in your favor.
5. Recompile the modified code and install the APK on a device.
6. Play the game and make the necessary moves to win and retrieve the flag.

### Flag
CTF{Y0u_W1n!_Th3_fl4g_1s_XXXXXXXX}
```
```
if-eq v0, v9, :cond_2
```
![Önce](<../../.gitbook/assets/image (380).png>)

![Sonra](<../../.gitbook/assets/image (835).png>)

[Pentest Android](./) adımlarını izleyerek APK'yı yeniden derleyin ve imzalayın. Ardından, [https://appetize.io/](https://appetize.io) adresine yükleyin ve ne olduğunu görelim:

![](<../../.gitbook/assets/image (125).png>)

Bayrağın tamamen şifrelenmeden yazıldığı görünüyor. Muhtemelen m() fonksiyonunun 1000000 kez çağrılması gerekiyor.

Bunu yapmanın **başka bir yolu**, talimatı değiştirmemek ancak karşılaştırma talimatlarını değiştirmektir:

![](<../../.gitbook/assets/image (837).png>)

**Başka bir yol**, 1000000 ile karşılaştırmak yerine değeri 1 olarak ayarlamaktır, böylece this.o 1 ile karşılaştırılır:

![](<../../.gitbook/assets/image (626).png>)

Dördüncü bir yol, v9(1000000) değerini v0 _(this.o)_ değerine taşımak için bir talimat eklemektir:

![](<../../.gitbook/assets/image (411).png>)

![](<../../.gitbook/assets/image (421).png>)

## Çözüm

Uygulamanın ilk seferinde kazandığınızda döngüyü 100000 kez çalıştırmasını sağlayın. Bunu yapmak için sadece **:goto\_6** döngüsünü oluşturmanız ve uygulamanın **`this.o`** değeri 100000 olmadığında oraya **atlamasını sağlamanız gerekir:

![](<../../.gitbook/assets/image (1087).png>)

Bunu fiziksel bir cihazda yapmanız gerekmektedir çünkü (nedenini bilmiyorum) bu emüle edilmiş bir cihazda çalışmaz.

<details>

<summary><strong>Sıfırdan kahraman olmak için AWS hackleme öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi **HackTricks'te reklamını görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu görün
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)'u takip edin.
* **Hacking püf noktalarınızı paylaşarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına PR gönderin.

</details>
