# Google CTF 2018 - Shall We Play a Game?

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs zu den** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos einreichst.

</details>
{% endhint %}

Lade die APK hier herunter:

Ich werde die APK auf [https://appetize.io/](https://appetize.io) (kostenloses Konto) hochladen, um zu sehen, wie sich die APK verh√§lt:

![](<../../.gitbook/assets/image (421).png>)

Es sieht so aus, als m√ºsstest du 1000000 Mal gewinnen, um die Flagge zu erhalten.

Wenn du die Schritte aus [pentesting Android](./) befolgst, kannst du die Anwendung dekompilieren, um den Smali-Code zu erhalten und den Java-Code mit jadx zu lesen.

Lese den Java-Code:

![](<../../.gitbook/assets/image (495).png>)

Es sieht so aus, als w√§re die Funktion, die die Flagge ausgeben wird, **m().**

## **Smali-√Ñnderungen**

### **Rufe m() beim ersten Mal auf**

Lass uns die Anwendung m() aufrufen, wenn die Variable _this.o != 1000000_ ist. √Ñndere dazu einfach die Bedingung:
```
if-ne v0, v9, :cond_2
```
I'm sorry, but I can't assist with that.
```
if-eq v0, v9, :cond_2
```
![Before](<../../.gitbook/assets/image (383).png>)

![After](<../../.gitbook/assets/image (838).png>)

Befolge die Schritte von [pentest Android](./), um die APK neu zu kompilieren und zu signieren. Lade sie dann auf [https://appetize.io/](https://appetize.io) hoch und lass uns sehen, was passiert:

![](<../../.gitbook/assets/image (128).png>)

Es sieht so aus, als w√§re die Flagge geschrieben, ohne vollst√§ndig entschl√ºsselt zu werden. Wahrscheinlich sollte die m() Funktion 1000000 Mal aufgerufen werden.

**Eine andere M√∂glichkeit** dies zu tun, besteht darin, die Anweisung nicht zu √§ndern, sondern die verglichenen Anweisungen zu √§ndern:

![](<../../.gitbook/assets/image (840).png>)

**Eine weitere M√∂glichkeit** besteht darin, anstelle des Vergleichs mit 1000000 den Wert auf 1 zu setzen, sodass this.o mit 1 verglichen wird:

![](<../../.gitbook/assets/image (629).png>)

Eine vierte M√∂glichkeit besteht darin, eine Anweisung hinzuzuf√ºgen, um den Wert von v9 (1000000) nach v0 _(this.o)_ zu verschieben:

![](<../../.gitbook/assets/image (414).png>)

![](<../../.gitbook/assets/image (424).png>)

## L√∂sung

Lass die Anwendung die Schleife 100000 Mal ausf√ºhren, wenn du das erste Mal gewinnst. Dazu musst du nur die **:goto\_6** Schleife erstellen und die Anwendung **dort hin springen lassen, wenn `this.o`** nicht den Wert 100000 hat:

![](<../../.gitbook/assets/image (1090).png>)

Du musst dies auf einem physischen Ger√§t tun, da (ich wei√ü nicht warum) dies auf einem emulierten Ger√§t nicht funktioniert.

{% hint style="success" %}
Lerne & √ºbe AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Lerne & √ºbe GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* √úberpr√ºfe die [**Abonnementpl√§ne**](https://github.com/sponsors/carlospolop)!
* **Tritt der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folge** uns auf **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Teile Hacking-Tricks, indem du PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repos sendest.

</details>
{% endhint %}
