# Google CTF 2018 - рдХреНрдпрд╛ рд╣рдо рдПрдХ рдЦреЗрд▓ рдЦреЗрд▓реЗрдВ?

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде рдЬреАрд░реЛ рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>!</strong></a></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

рдпрд╣рд╛рдВ APK рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ:

рдореИрдВ APK рдХреЛ [https://appetize.io/](https://appetize.io) (рдореБрдлреНрдд рдЦрд╛рддрд╛) рдкрд░ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реВрдБ рддрд╛рдХрд┐ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХреЗ рдХрд┐ apk рдХреИрд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░ рд░рд╣рд╛ рд╣реИ:

![](<../../.gitbook/assets/image (46).png>)

рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рдЭрдВрдЭрдЯ рдЬреАрддрдиреЗ рдХреЗ рд▓рд┐рдП 1000000 рдмрд╛рд░ рдЬреАрддрдирд╛ рд╣реЛрдЧрд╛ред

[pentesting Android](./) рд╕реЗ рдХрджрдореЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП рдЖрдк рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдбрд┐рдХреЙрдореНрдкрд╛рдЗрд▓ рдХрд░рдХреЗ smali рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ jadx рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЬрд╛рд╡рд╛ рдХреЛрдб рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред

рдЬрд╛рд╡рд╛ рдХреЛрдб рдкрдврд╝рдирд╛:

![](<../../.gitbook/assets/image (47).png>)

рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╡рд╣ рдлрд╝рдВрдХреНрд╢рди рдЬреЛ рдзреНрд╡рдЬ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдЧрд╛ **m().**

## **Smali рдкрд░рд┐рд╡рд░реНрддрди**

### **рдкрд╣рд▓реА рдмрд╛рд░ m() рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ**

рдЖрдЗрдП рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ m() рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдЧрд░ рдЪрд░ _this.o != 1000000_ рд╣реИ рддреЛ рдЙрд╕реЗ рдмрджрд▓ рджреЗрдВ, рдмрд╕ рд╢рд░реНрдд рдХреЛ рдмрджрд▓реЗрдВ:
```
if-ne v0, v9, :cond_2
```
# Google CTF 2018: Shall we play a game?

---

## Android Application Analysis

### Task 1: Peruse the app

1. **APK Analysis**
   - Decompile the APK using JADX or APKTool.
   - Look for interesting strings, APIs, and classes.

2. **Static Analysis**
   - Analyze the source code for vulnerabilities.
   - Look for sensitive data handling, insecure storage, etc.

3. **Dynamic Analysis**
   - Run the app in an emulator or device.
   - Monitor network traffic, API calls, and behavior.

### Task 2: Find the flag

1. **Reverse Engineering**
   - Use JADX, JEB, or Ghidra for disassembling.
   - Look for clues, hidden functionalities, or obfuscated code.

2. **File System Analysis**
   - Check for configuration files, databases, or shared preferences.
   - Look for hardcoded secrets or keys.

3. **Network Traffic Analysis**
   - Capture and analyze the app's network requests.
   - Look for any sensitive information being transmitted.

### Task 3: Exploit the vulnerability

1. **Code Injection**
   - Look for places where user input is not sanitized.
   - Try injecting code to execute arbitrary commands.

2. **Security Bypass**
   - Identify authentication or authorization flaws.
   - Attempt to bypass login screens or access restricted functionalities.

3. **Data Tampering**
   - Modify requests/responses to manipulate app behavior.
   - Try changing parameters to escalate privileges or access unauthorized data.

By following these steps, you can effectively analyze and exploit Android applications for security testing purposes.
```
if-eq v0, v9, :cond_2
```
![рдкрд╣рд▓реЗ](<../../.gitbook/assets/image (48).png>)

![рдмрд╛рдж рдореЗрдВ](<../../.gitbook/assets/image (49).png>)

[Android рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ](./) рдХреЗ рдЪрд░рдгреЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ рддрд╛рдХрд┐ APK рдХреЛ рдкреБрдирдГ рдХрдВрдкрд╛рдЗрд▓ рдФрд░ рд╕рд╛рдЗрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдлрд┐рд░, рдЗрд╕реЗ [https://appetize.io/](https://appetize.io) рдкрд░ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (50).png>)

рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдлреНрд▓реИрдЧ рдмрд┐рдирд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдП рдмрд┐рдирд╛ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИред рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИ рдХрд┐ m() рдлрд╝рдВрдХреНрд╢рди рдХреЛ 1000000 рдмрд╛рд░ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

**рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛** рдЗрд╕реЗ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдмрджрд▓рдиреЗ рдХреА рдмрдЬрд╛рдп рддреБрд▓рдирд╛ рдХреА рдЧрдИ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдмрджрд▓реЗрдВ:

![](<../../.gitbook/assets/image (55).png>)

**рдПрдХ рдФрд░ рддрд░реАрдХрд╛** рдпрд╣ рд╣реИ рдХрд┐ 1000000 рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреА рдмрдЬрд╛рдп, рдорд╛рди рдХреЛ 1 рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ рддрд╛рдХрд┐ this.o рдХреЛ 1 рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд┐рдпрд╛ рдЬрд╛рдП:

![](<../../.gitbook/assets/image (57).png>)

рдЪреМрдерд╛ рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ v9(1000000) рдХреЗ рдорд╛рди рдХреЛ v0 _(this.o)_ рдореЗрдВ рд▓реЗ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдирд┐рд░реНрджреЗрд╢ рдЬреЛрдбрд╝реЗрдВ:

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## рд╕рдорд╛рдзрд╛рди

рдЬрдм рдЖрдк рдкрд╣рд▓реА рдмрд╛рд░ рдЬреАрддрддреЗ рд╣реИрдВ, рддреЛ рдРрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд▓реВрдк рдХреЛ 100000 рдмрд╛рд░ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдЗрд╕реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдХреЗрд╡рд▓ **:goto\_6** рд▓реВрдк рдмрдирд╛рдирд╛ рд╣реИ рдФрд░ рдРрдкреНрд▓рд┐рдХреЗрд╢рди **рд╡рд╣рд╛рдБ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдЕрдЧрд░ `this.o`** 100000 рдХрд╛ рдореВрд▓реНрдп рдирд╣реАрдВ рд╣реИ\:

![](<../../.gitbook/assets/image (59).png>)

рдЖрдкрдХреЛ рдЗрд╕реЗ рдПрдХ рднреМрддрд┐рдХ рдЙрдкрдХрд░рдг рдХреЗ рдЕрдВрджрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ (рдореБрдЭреЗ рдирд╣реАрдВ рдкрддрд╛ рдХреНрдпреЛрдВ) рдпрд╣ рдПрдХ рдЕрдиреБрдХреГрдд рдЙрдкрдХрд░рдг рдореЗрдВ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ред
