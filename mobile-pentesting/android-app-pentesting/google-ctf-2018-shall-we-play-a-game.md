# Google CTF 2018 - ゲームをしましょうか？

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>でAWSハッキングをゼロからヒーローまで学ぶ</strong></a><strong>！</strong></summary>

HackTricks をサポートする他の方法：

- **HackTricks で企業を宣伝したい** または **HackTricks をPDFでダウンロードしたい** 場合は [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェック！
- [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family) を発見し、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションを見つける
- **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)** に参加するか、[telegramグループ](https://t.me/peass) に参加するか、**Twitter** 🐦 で **@carlospolopm** をフォローする
- **ハッキングトリックを共有するために** [**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) のGitHubリポジトリにPRを提出する

</details>

APKをこちらからダウンロードしてください：

APKを [https://appetize.io/](https://appetize.io)（無料アカウント）にアップロードして、APKの動作を確認します：

![](<../../.gitbook/assets/image (46).png>)

フラグを取得するには1000000回勝つ必要があるようです。

[pentesting Android](./) の手順に従って、アプリケーションを逆コンパイルして smali コードを取得し、jadx を使用して Java コードを読み取ることができます。

Javaコードを読む：

![](<../../.gitbook/assets/image (47).png>)

フラグを表示する関数は **m().** のようです。

## **Smaliの変更**

### **最初のm()の呼び出し**

アプリケーションが _this.o != 1000000_ の場合に m() を呼び出すようにしましょう。そのために、条件を変更します：
```
if-ne v0, v9, :cond_2
```
```markdown
## Google CTF 2018: Shall we play a game?

### Challenge Description
The challenge was an Android APK file. When the app is opened, it asks for a password. The goal is to find the correct password to proceed.

### Solution
1. **Decompile the APK**: Use tools like JADX or apktool to decompile the APK file.
2. **Analyzing the Code**: Look for clues in the decompiled code to understand how the password verification works.
3. **Finding the Password**: By analyzing the code, you can find the logic used to verify the password.
4. **Reverse Engineering**: If necessary, reverse engineer any obfuscated code to better understand the verification process.
5. **Testing Passwords**: Use the discovered logic to test different passwords until the correct one is found.
6. **Submit the Flag**: Once the correct password is found, submit it to the app to complete the challenge.

### Learning Points
- Android APK files can be decompiled for analysis.
- Understanding code logic is crucial for solving password verification challenges.
- Reverse engineering may be necessary for complex verification processes.
```
```
if-eq v0, v9, :cond_2
```
![Before](<../../.gitbook/assets/image (48).png>)

![After](<../../.gitbook/assets/image (49).png>)

[pentest Android](./)の手順に従ってAPKを再コンパイルして署名します。その後、[https://appetize.io/](https://appetize.io)にアップロードして、何が起こるか見てみましょう：

![](<../../.gitbook/assets/image (50).png>)

フラグは完全に復号化されずに書かれているようです。おそらくm()関数を1000000回呼び出す必要があります。

これを行う**別の方法**は、命令を変更せずに比較される命令を変更することです：

![](<../../.gitbook/assets/image (55).png>)

**別の方法**は、1000000と比較する代わりに、値を1に設定してthis.oが1と比較されるようにすることです：

![](<../../.gitbook/assets/image (57).png>)

四番目の方法は、v9(1000000)の値をv0 _(this.o)_に移動する命令を追加することです：

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## 解決策

最初に勝ったときにアプリケーションにループを100000回実行させます。これを行うには、**:goto\_6**ループを作成し、アプリケーションが`this.o`の値が100000でない場合に**そこにジャンプ**するようにします\:

![](<../../.gitbook/assets/image (59).png>)

これは物理デバイス内で行う必要があります（なぜかはわかりません）。

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>で**ゼロからヒーローまでAWSハッキングを学ぶ**</summary>

HackTricksをサポートする他の方法:

* **会社をHackTricksで宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスウォッグ**](https://peass.creator-spring.com)を入手してください
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[NFTs](https://opensea.io/collection/the-peass-family)コレクションを見つけてください
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォロー**してください。
* **HackTricks**と**HackTricks Cloud**のgithubリポジトリにPRを提出して、あなたのハッキングトリックを共有してください。

</details>
