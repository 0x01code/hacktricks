# Google CTF 2018 - Sollen wir ein Spiel spielen?

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>

Laden Sie die APK hier herunter:

Ich werde die APK auf [https://appetize.io/](https://appetize.io) (kostenloses Konto) hochladen, um zu sehen, wie sich die APK verh√§lt:

![](<../../.gitbook/assets/image (421).png>)

Es scheint, als m√ºssten Sie 1000000 Mal gewinnen, um die Flagge zu erhalten.

Folgen Sie den Schritten aus [Pentesting Android](./), um die Anwendung zu dekompilieren und den Smali-Code zu erhalten und den Java-Code mit jadx zu lesen.

Lesen des Java-Codes:

![](<../../.gitbook/assets/image (495).png>)

Es sieht so aus, als ob die Funktion, die die Flagge drucken wird, **m().** ist.

## **Smali-√Ñnderungen**

### **Rufen Sie m() das erste Mal auf**

Lassen Sie die Anwendung m() aufrufen, wenn die Variable _this.o != 1000000_ ist, um dies zu tun, √§ndern Sie einfach die Bedingung:
```
if-ne v0, v9, :cond_2
```
### Google CTF 2018: Shall we play a game?

---

#### Android App Pentesting

---

1. **Challenge Description:**

    You are provided with an APK file named `game.apk`. The challenge is to find the flag by playing the game.

2. **Tools Used:**

    - JADX
    - Apktool
    - Android Emulator

3. **Steps:**

    - **Decompile the APK using JADX or Apktool.**
    - **Analyze the source code to understand the game logic.**
    - **Identify any vulnerabilities or backdoors.**
    - **Use an Android Emulator to run the app and interact with it.**
    - **Exploit the vulnerabilities to find the flag.**

4. **Flag Format:**

    - `CTF{flag_here}`

5. **Conclusion:**

    This challenge tests your skills in reverse engineering and exploiting Android applications. It's a fun way to learn about mobile app security.
```
if-eq v0, v9, :cond_2
```
![Vorher](<../../.gitbook/assets/image (383).png>)

![Nachher](<../../.gitbook/assets/image (838).png>)

Folgen Sie den Schritten des [Pentest Android](./), um die APK neu zu kompilieren und zu signieren. Laden Sie sie dann auf [https://appetize.io/](https://appetize.io) hoch und schauen Sie, was passiert:

![](<../../.gitbook/assets/image (128).png>)

Es scheint, als w√§re die Flagge geschrieben, ohne vollst√§ndig entschl√ºsselt zu werden. Wahrscheinlich sollte die m() Funktion 1000000 Mal aufgerufen werden.

**Eine andere M√∂glichkeit**, dies zu tun, besteht darin, die Anweisung nicht zu √§ndern, sondern die verglichenen Anweisungen zu √§ndern:

![](<../../.gitbook/assets/image (840).png>)

**Eine weitere M√∂glichkeit** besteht darin, anstelle von 1000000 mit dem Wert 1 zu vergleichen, sodass this.o mit 1 verglichen wird:

![](<../../.gitbook/assets/image (629).png>)

Ein vierter Weg ist, eine Anweisung hinzuzuf√ºgen, um den Wert von v9 (1000000) nach v0 _(this.o)_ zu verschieben:

![](<../../.gitbook/assets/image (414).png>)

![](<../../.gitbook/assets/image (424).png>)

## L√∂sung

Lassen Sie die Anwendung die Schleife 100.000 Mal durchlaufen, wenn Sie das erste Mal gewinnen. Dazu m√ºssen Sie nur die **:goto\_6**-Schleife erstellen und die Anwendung **dorthin springen lassen, wenn `this.o`** nicht den Wert 100.000 hat:

![](<../../.gitbook/assets/image (1090).png>)

Sie m√ºssen dies auf einem physischen Ger√§t durchf√ºhren, da (ich wei√ü nicht warum) dies auf einem emulierten Ger√§t nicht funktioniert.

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie m√∂chten, dass Ihr **Unternehmen in HackTricks beworben wird** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
