# Google CTF 2018 - Vamos Jogar um Jogo?

<details>

<summary><strong>Aprenda hacking AWS do zero ao avan√ßado com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

Baixe o APK aqui:

Vou fazer upload do APK para [https://appetize.io/](https://appetize.io) (conta gratuita) para ver como o apk est√° se comportando:

![](<../../.gitbook/assets/image (46).png>)

Parece que voc√™ precisa ganhar 1000000 vezes para obter a flag.

Seguindo os passos de [pentesting Android](./) voc√™ pode descompilar o aplicativo para obter o c√≥digo smali e ler o c√≥digo Java usando o jadx.

Lendo o c√≥digo java:

![](<../../.gitbook/assets/image (47).png>)

Parece que a fun√ß√£o que vai imprimir a flag √© **m().**

## **Altera√ß√µes no Smali**

### **Chamando m() pela primeira vez**

Vamos fazer o aplicativo chamar m() se a vari√°vel _this.o != 1000000_ para fazer isso, basta mudar a condi√ß√£o:
```
if-ne v0, v9, :cond_2
```
# Google CTF 2018: Shall we play a game?

---

## Introduction

This challenge was part of the Google CTF 2018 and focused on Android application pentesting. The goal was to find the flag by analyzing the APK file provided.

## Challenge Description

The challenge involved an Android application where the user had to play a game to find the flag. The APK file was provided for analysis.

## Solution

1. **Decompiling the APK**: The first step was to decompile the APK file using tools like JADX or apktool to analyze the source code.

2. **Analyzing the Source Code**: By going through the decompiled source code, we could identify the logic of the game and any potential vulnerabilities.

3. **Identifying the Flag**: After understanding the game logic, we could locate where the flag was being generated or stored.

4. **Extracting the Flag**: Once the flag location was identified, we could extract it from the source code to obtain the flag.

By following these steps, we could successfully find the flag and complete the challenge.
```
if-eq v0, v9, :cond_2
```
![Antes](<../../.gitbook/assets/image (48).png>)

![Depois](<../../.gitbook/assets/image (49).png>)

Siga os passos do [pentest Android](./) para recompilar e assinar o APK. Em seguida, fa√ßa o upload para [https://appetize.io/](https://appetize.io) e veja o que acontece:

![](<../../.gitbook/assets/image (50).png>)

Parece que a flag est√° escrita sem estar completamente descriptografada. Provavelmente a fun√ß√£o m() deve ser chamada 1000000 vezes.

**Outra maneira** de fazer isso √© n√£o alterar a instru√ß√£o, mas mudar as instru√ß√µes comparadas:

![](<../../.gitbook/assets/image (55).png>)

**Uma outra maneira** √©, em vez de comparar com 1000000, definir o valor como 1 para que this.o seja comparado com 1:

![](<../../.gitbook/assets/image (57).png>)

Uma quarta maneira √© adicionar uma instru√ß√£o para mover o valor de v9 (1000000) para v0 _(this.o)_:

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## Solu√ß√£o

Fa√ßa o aplicativo executar o loop 100000 vezes quando voc√™ vencer pela primeira vez. Para fazer isso, voc√™ s√≥ precisa criar o loop **:goto\_6** e fazer o aplicativo **pular para l√° se `this.o`** n√£o tiver o valor 100000\:

![](<../../.gitbook/assets/image (59).png>)

Voc√™ precisa fazer isso em um dispositivo f√≠sico, pois (n√£o sei por que) isso n√£o funciona em um dispositivo emulado.

<details>

<summary><strong>Aprenda a hackear a AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
