# 137,138,139 - Pentesting NetBios

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

## NetBios Naamdiens

**NetBIOS Naamdiens** speel 'n belangrike rol en behels verskeie dienste soos **naamregistrasie en -oplossing**, **datagramverspreiding** en **sessiedienste**, wat spesifieke poorte vir elke diens gebruik.

[Vanaf Wikidepia](https://en.wikipedia.org/wiki/NetBIOS_over_TCP/IP):

* Naamdiens vir naamregistrasie en -oplossing (poorte: 137/udp en 137/tcp).
* Datagramverspreidingsdiens vir verbindingslose kommunikasie (poort: 138/udp).
* Sessiediens vir verbindingsgeori√´nteerde kommunikasie (poort: 139/tcp).

### Naamdiens

Om 'n toestel aan 'n NetBIOS-netwerk te laat deelneem, moet dit 'n unieke naam h√™. Dit word bereik deur 'n **uitsaaiingsproses** waar 'n "Naamnavraag" pakkie gestuur word. As geen besware ontvang word nie, word die naam as beskikbaar beskou. Alternatiewelik kan 'n **Naamdiens-bediener** direk ondervra word om naambeskikbaarheid te kontroleer of om 'n naam na 'n IP-adres op te los. Hulpmiddels soos `nmblookup`, `nbtscan` en `nmap` word gebruik om NetBIOS-dienste op te som, waardeur bedienername en MAC-adresse onthul word.
```bash
PORT    STATE SERVICE    VERSION
137/udp open  netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP)
```
### NetBIOS-dienste pentesting

By die ondersoek van 'n NetBIOS-diens kan jy die name verkry wat die bediener gebruik, sowel as die MAC-adres van die bediener.
```bash
nmblookup -A <IP>
nbtscan <IP>/30
sudo nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n <IP>
```
### Datagramverspreidingsdiens

NetBIOS-datagramme maak gebruik van UDP vir verbindingslose kommunikasie, wat direkte boodskappe of uitsaai na alle netwerkname ondersteun. Hierdie diens maak gebruik van poort **138/udp**.
```bash
PORT    STATE         SERVICE     VERSION
138/udp open|filtered netbios-dgm
```
### Sessiediens

Vir verbindingsgeori√´nteerde interaksies fasiliteer die **Sessiediens** 'n gesprek tussen twee toestelle deur gebruik te maak van **TCP**-verbindings deur poort **139/tcp**. 'n Sessie begin met 'n "Sessieversoek" pakkie en kan gevestig word op grond van die reaksie. Die diens ondersteun groter boodskappe, foutopsporing en herstel, met TCP wat vloeibeheer en pakkiehertransmissie hanteer.

Data-oordrag binne 'n sessie behels **Sessieboodskappakkies**, met sessies wat be√´indig word deur die TCP-verbinding te sluit.

Hierdie dienste is integraal tot die funksionaliteit van **NetBIOS**, wat doeltreffende kommunikasie en hulpbron-deling oor 'n netwerk moontlik maak. Vir meer inligting oor TCP- en IP-protokolle, verwys na hul onderskeie [TCP Wikipedia](https://en.wikipedia.org/wiki/Transmission_Control_Protocol) en [IP Wikipedia](https://en.wikipedia.org/wiki/Internet_Protocol) bladsye.
```bash
PORT      STATE SERVICE      VERSION
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
```
**Lees die volgende bladsy om te leer hoe om hierdie diens te ondersoek:**

{% content-ref url="137-138-139-pentesting-netbios.md" %}
[137-138-139-pentesting-netbios.md](137-138-139-pentesting-netbios.md)
{% endcontent-ref %}

## HackTricks Outomatiese Opdragte
```
Protocol_Name: Netbios    #Protocol Abbreviation if there is one.
Port_Number:  137,138,139     #Comma separated if there is more than one.
Protocol_Description: Netbios         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for NetBios
Note: |
Name service for name registration and resolution (ports: 137/udp and 137/tcp).
Datagram distribution service for connectionless communication (port: 138/udp).
Session service for connection-oriented communication (port: 139/tcp).

For a device to participate in a NetBIOS network, it must have a unique name. This is achieved through a broadcast process where a "Name Query" packet is sent. If no objections are received, the name is considered available. Alternatively, a Name Service server can be queried directly to check for name availability or to resolve a name to an IP address.

https://book.hacktricks.xyz/pentesting/137-138-139-pentesting-netbios

Entry_2:
Name: Find Names
Description: Three scans to find the names of the server
Command: nmblookup -A {IP} &&&& nbtscan {IP}/30 &&&& nmap -sU -sV -T4 --script nbstat.nse -p 137 -Pn -n {IP}
```
<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy wil sien dat jou **maatskappy geadverteer word in HackTricks** of **HackTricks aflaai in PDF-formaat**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-opslagplekke.

</details>
