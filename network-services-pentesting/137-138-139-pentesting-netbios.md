# 137,138,139 - ペンテスティング NetBios

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>でゼロからヒーローまでAWSハッキングを学ぶ</strong></a><strong>！</strong></summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝したい** または **HackTricks をPDFでダウンロードしたい** 場合は [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)、当社の独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) コレクションを発見する
* **💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f) に参加するか、[**telegramグループ**](https://t.me/peass) に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live) をフォローする。
* **ハッキングトリックを共有するには、** [**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) のGitHubリポジトリにPRを提出してください。

</details>

## NetBios 名前サービス

**NetBIOS 名前サービス** は、**名前登録と解決**、**データグラム配布**、**セッションサービス** など、さまざまなサービスに関与し、各サービスに特定のポートを利用します。

[ウィキペディアより](https://en.wikipedia.org/wiki/NetBIOS_over_TCP/IP):

* 名前登録と解決のための名前サービス（ポート: 137/udp および 137/tcp）。
* 接続レス通信のためのデータグラム配布サービス（ポート: 138/udp）。
* 接続指向通信のためのセッションサービス（ポート: 139/tcp）。

### 名前サービス

NetBIOS ネットワークに参加するデバイスは、一意の名前を持つ必要があります。これは、"名前クエリ" パケットが送信される **ブロードキャストプロセス** によって達成されます。異議がない場合、名前は利用可能と見なされます。また、名前の利用可能性を確認したり、名前をIPアドレスに解決するために **名前サービスサーバー** に直接問い合わせることもできます。`nmblookup`、`nbtscan`、`nmap` などのツールを使用して、NetBIOS サービスを列挙し、サーバー名とMACアドレスを特定します。
```bash
PORT    STATE SERVICE    VERSION
137/udp open  netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP)
```
NetBIOSサービスを列挙すると、サーバーが使用している名前とサーバーのMACアドレスを取得できます。
```bash
nmblookup -A <IP>
nbtscan <IP>/30
sudo nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n <IP>
```
### データグラム配信サービス

NetBIOSデータグラムは、UDPを介した接続レス通信を可能にし、直接メッセージングやネットワーク内のすべての名前へのブロードキャストをサポートします。このサービスは**138/udp**ポートを使用します。
```bash
PORT    STATE         SERVICE     VERSION
138/udp open|filtered netbios-dgm
```
### セッションサービス

接続指向のやり取りにおいて、**セッションサービス**は、**TCP**接続を介してポート**139/tcp**を通じて2つのデバイス間の会話を可能にします。セッションは「セッションリクエスト」パケットで始まり、応答に基づいて確立されます。このサービスは大きなメッセージ、エラー検出、回復をサポートし、TCPがフロー制御とパケットの再送信を処理します。

セッション内でのデータ転送には**セッションメッセージパケット**が使用され、セッションはTCP接続を閉じることで終了します。

これらのサービスは**NetBIOS**の機能に不可欠であり、ネットワーク全体で効率的な通信とリソース共有を可能にします。TCPおよびIPプロトコルに関する詳細情報については、それぞれの[TCP Wikipedia](https://en.wikipedia.org/wiki/Transmission_Control_Protocol)および[IP Wikipedia](https://en.wikipedia.org/wiki/Internet_Protocol)ページを参照してください。
```bash
PORT      STATE SERVICE      VERSION
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
```
**次のページを読んで、このサービスの列挙方法を学びます:**

{% content-ref url="137-138-139-pentesting-netbios.md" %}
[137-138-139-pentesting-netbios.md](137-138-139-pentesting-netbios.md)
{% endcontent-ref %}

## HackTricks自動コマンド
```
Protocol_Name: Netbios    #Protocol Abbreviation if there is one.
Port_Number:  137,138,139     #Comma separated if there is more than one.
Protocol_Description: Netbios         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for NetBios
Note: |
Name service for name registration and resolution (ports: 137/udp and 137/tcp).
Datagram distribution service for connectionless communication (port: 138/udp).
Session service for connection-oriented communication (port: 139/tcp).

For a device to participate in a NetBIOS network, it must have a unique name. This is achieved through a broadcast process where a "Name Query" packet is sent. If no objections are received, the name is considered available. Alternatively, a Name Service server can be queried directly to check for name availability or to resolve a name to an IP address.

https://book.hacktricks.xyz/pentesting/137-138-139-pentesting-netbios

Entry_2:
Name: Find Names
Description: Three scans to find the names of the server
Command: nmblookup -A {IP} &&&& nbtscan {IP}/30 &&&& nmap -sU -sV -T4 --script nbstat.nse -p 137 -Pn -n {IP}
```
<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)、当社の独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションを発見する
* **💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)で**フォロー**する。
* **ハッキングトリックを共有するために、PRを** [**HackTricks**](https://github.com/carlospolop/hacktricks) **および** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **githubリポジトリに提出してください。**

</details>
