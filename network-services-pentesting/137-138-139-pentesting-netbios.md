## NetBios Name Service

* Servi√ßo de nome para registro e resolu√ß√£o de nomes (portas: 137/udp e 137/tcp).
* Servi√ßo de distribui√ß√£o de datagramas para comunica√ß√£o sem conex√£o (porta: 138/udp).
* Servi√ßo de sess√£o para comunica√ß√£o orientada a conex√£o (porta: 139/tcp).

### Servi√ßo de Nome

Cada m√°quina deve ter um nome dentro da rede NetBios. Para solicitar um nome, uma m√°quina deve enviar um pacote "Consulta de Nome" em broadcast e, se algu√©m responder que j√° est√° usando esse nome, a m√°quina pode usar esse nome. Se houver um servidor de Servi√ßo de Nome, o computador poder√° perguntar ao servidor de Servi√ßo de Nome se algu√©m est√° usando o nome que ele deseja usar.

Para descobrir o endere√ßo IP de um Nome, um PC deve enviar um pacote "Consulta de Nome" e esperar se algu√©m responde. Se houver um servidor de Servi√ßo de Nome, o PC pode perguntar a ele o IP do nome.
```bash
PORT    STATE SERVICE    VERSION
137/udp open  netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP)
```
Enumerando um servi√ßo NetBIOS, voc√™ pode obter os nomes que o servidor est√° usando e o endere√ßo MAC do servidor.
```bash
nmblookup -A <IP>
nbtscan <IP>/30
sudo nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n <IP>
```
### Servi√ßo de Distribui√ß√£o de Datagramas

Os datagramas NetBIOS s√£o enviados por UDP. Um datagrama √© enviado com um pacote "Direto √önico" ou "Direto em Grupo" se estiver sendo enviado para um nome NetBIOS espec√≠fico, ou um pacote "Broadcast" se estiver sendo enviado para todos os nomes NetBIOS na rede.
```bash
PORT    STATE         SERVICE     VERSION
138/udp open|filtered netbios-dgm
```
### Servi√ßo de Sess√£o

O modo de sess√£o permite que dois computadores estabele√ßam uma conex√£o para uma "conversa", permitindo que mensagens maiores sejam tratadas e fornecendo detec√ß√£o e recupera√ß√£o de erros.

As sess√µes s√£o estabelecidas trocando pacotes. O computador que estabelece a sess√£o tenta fazer uma conex√£o [TCP](https://en.wikipedia.org/wiki/Transmission\_Control\_Protocol) √† porta 139 do computador com o qual a sess√£o deve ser estabelecida. Se a conex√£o for estabelecida, o computador que estabelece a sess√£o envia pela conex√£o um pacote "Solicita√ß√£o de Sess√£o" com os nomes NetBIOS do aplicativo que estabelece a sess√£o e o nome NetBIOS para o qual a sess√£o deve ser estabelecida. O computador com o qual a sess√£o deve ser estabelecida responder√° com uma "Resposta Positiva de Sess√£o" indicando que uma sess√£o pode ser estabelecida ou uma "Resposta Negativa de Sess√£o" indicando que nenhuma sess√£o pode ser estabelecida (seja porque esse computador n√£o est√° ouvindo sess√µes sendo estabelecidas para esse nome ou porque n√£o h√° recursos dispon√≠veis para estabelecer uma sess√£o para esse nome).

Os dados s√£o transmitidos durante uma sess√£o estabelecida por pacotes de Mensagem de Sess√£o.

O TCP lida com o controle de fluxo e retransmiss√£o de todos os pacotes de servi√ßo de sess√£o e a divis√£o do fluxo de dados sobre o qual os pacotes s√£o transmitidos em datagramas [IP](https://en.wikipedia.org/wiki/Internet\_Protocol) pequenos o suficiente para caber em pacotes de camada de link.

As sess√µes s√£o encerradas fechando a conex√£o TCP.
```bash
PORT      STATE SERVICE      VERSION
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
```
**Leia a pr√≥xima p√°gina para aprender como enumerar este servi√ßo:**

{% content-ref url="137-138-139-pentesting-netbios.md" %}
[137-138-139-pentesting-netbios.md](137-138-139-pentesting-netbios.md)
{% endcontent-ref %}

## Comandos Autom√°ticos do HackTricks
```
Protocol_Name: Netbios    #Protocol Abbreviation if there is one.
Port_Number:  137,138,139     #Comma separated if there is more than one.
Protocol_Description: Netbios         #Protocol Abbreviation Spelled out

Entry_1:
  Name: Notes
  Description: Notes for NetBios
  Note: |
    Name service for name registration and resolution (ports: 137/udp and 137/tcp).
    Datagram distribution service for connectionless communication (port: 138/udp).
    Session service for connection-oriented communication (port: 139/tcp).

    Every machine should have a name inside the NetBios network. To request a name, a machine should send a "Name Query" packet in broadcast and if anyone answer that it is already using that name, the machine can use that name. If there is a Name Service server, the computer could ask the Name Service server if someone is using the name that it wants to use.

    https://book.hacktricks.xyz/pentesting/137-138-139-pentesting-netbios

Entry_2:
  Name: Find Names
  Description: Three scans to find the names of the server
  Command: nmblookup -A {IP} &&&& nbtscan {IP}/30 &&&& nmap -sU -sV -T4 --script nbstat.nse -p 137 -Pn -n {IP}
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e para o** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
