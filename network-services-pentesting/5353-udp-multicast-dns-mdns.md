# 5353/UDP Multicast DNS (mDNS) et DNS-SD

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

## **Informations de base**

**Multicast DNS (mDNS)** permet des **op√©rations similaires √† DNS** au sein des r√©seaux locaux sans avoir besoin d'un serveur DNS traditionnel. Il fonctionne sur le port **UDP 5353** et permet aux appareils de se d√©couvrir mutuellement et de d√©couvrir leurs services, couramment observ√© dans divers appareils IoT. **La d√©couverte de services DNS (DNS-SD)**, souvent utilis√©e aux c√¥t√©s de mDNS, aide √† identifier les services disponibles sur le r√©seau gr√¢ce √† des requ√™tes DNS standard.
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **Fonctionnement de mDNS**

Dans les environnements sans serveur DNS standard, mDNS permet aux appareils de r√©soudre les noms de domaine se terminant par **.local** en interrogeant l'adresse de multidiffusion **224.0.0.251** (IPv4) ou **FF02::FB** (IPv6). Les aspects importants de mDNS incluent une valeur de **Time-to-Live (TTL)** indiquant la validit√© de l'enregistrement et un **bit QU** distinguant les requ√™tes unicast et multicast. En termes de s√©curit√©, il est crucial que les impl√©mentations de mDNS v√©rifient que l'adresse source du paquet correspond au sous-r√©seau local.

### **Fonctionnement de DNS-SD**

DNS-SD facilite la d√©couverte des services r√©seau en interrogeant des enregistrements de pointeur (PTR) qui font correspondre les types de service √† leurs instances. Les services sont identifi√©s en utilisant un motif **_\<Service>.\_tcp ou \_\<Service>.\_udp** dans le domaine **.local**, ce qui permet de d√©couvrir les enregistrements **SRV** et **TXT** correspondants fournissant des informations d√©taill√©es sur le service.

### **Exploration du R√©seau**

#### **Utilisation de nmap**

Une commande utile pour scanner le r√©seau local √† la recherche de services mDNS est :
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
Ce command permet d'identifier les ports mDNS ouverts et les services annonc√©s sur ces ports.

#### **√ânum√©ration du r√©seau avec Pholus**

Pour envoyer activement des requ√™tes mDNS et capturer le trafic, l'outil **Pholus** peut √™tre utilis√© comme suit :
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## Attaques

### **Exploitation de l'exploration mDNS**

Un vecteur d'attaque implique l'envoi de r√©ponses falsifi√©es aux sondes mDNS, sugg√©rant que tous les noms potentiels sont d√©j√† utilis√©s, emp√™chant ainsi les nouveaux appareils de s√©lectionner un nom unique. Cela peut √™tre ex√©cut√© en utilisant :
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
Cette technique bloque efficacement les nouveaux appareils d'enregistrer leurs services sur le r√©seau.

**En r√©sum√©**, comprendre le fonctionnement de mDNS et DNS-SD est crucial pour la gestion et la s√©curit√© du r√©seau. Des outils comme **nmap** et **Pholus** offrent des informations pr√©cieuses sur les services du r√©seau local, tandis que la prise de conscience des vuln√©rabilit√©s potentielles aide √† se prot√©ger contre les attaques.


### Spoofing/MitM

L'attaque la plus int√©ressante que vous pouvez effectuer sur ce service est de r√©aliser un **MitM** dans la **communication entre le client et le vrai serveur**. Vous pourriez √™tre en mesure d'obtenir des fichiers sensibles (MitM la communication avec l'imprimante) ou m√™me des informations d'identification (authentification Windows).\
Pour plus d'informations, consultez :

{% content-ref url="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## R√©f√©rences

* [Hacking pratique de l'IoT : Le guide d√©finitif pour attaquer l'Internet des objets](https://books.google.co.uk/books/about/Practical\_IoT\_Hacking.html?id=GbYEEAAAQBAJ\&redir\_esc=y)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
