# 5353/UDP Multicast DNS (mDNS) and DNS-SD

<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝したい** または **HackTricks をPDFでダウンロードしたい** 場合は [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family) のコレクションを見つける
* **💬** [**Discordグループ**](https://discord.gg/hRep4RUj7f) **または** [**telegramグループ**](https://t.me/peass) **に参加するか、Twitter 🐦** [**@carlospolopm**](https://twitter.com/hacktricks\_live) **をフォローする**
* **ハッキングトリックを共有するためにPRを** [**HackTricks**](https://github.com/carlospolop/hacktricks) **と** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **のGitHubリポジトリに提出する**

</details>

## **基本情報**

**マルチキャストDNS（mDNS）** は、従来のDNSサーバーを必要とせずにローカルネットワーク内で **DNSのような操作** を可能にします。 **UDPポート5353** で動作し、デバイスがお互いやそれらのサービスを発見できるようにし、さまざまなIoTデバイスでよく見られます。 **DNS Service Discovery（DNS-SD）** は、しばしばmDNSと併用され、標準DNSクエリを介してネットワーク上で利用可能なサービスを特定するのに役立ちます。

```
PORT     STATE SERVICE
5353/udp open  zeroconf
```

### **mDNSの動作**

標準DNSサーバーがない環境では、mDNSを使用して、マルチキャストアドレス**224.0.0.251**（IPv4）または**FF02::FB**（IPv6）にクエリを送信することで、**.local**で終わるドメイン名を解決することができます。mDNSの重要な側面には、レコードの有効性を示す**Time-to-Live（TTL）値と、ユニキャストとマルチキャストクエリを区別するQUビット**が含まれます。セキュリティの観点から、mDNSの実装では、パケットのソースアドレスがローカルサブネットと一致していることを検証することが重要です。

### **DNS-SDの機能**

DNS-SDは、サービスタイプをそのインスタンスにマップするポインタレコード（PTR）をクエリすることによって、ネットワークサービスの発見を容易にします。サービスは、**.local**ドメイン内の**\_\<Service>.\_tcp**または\*\*\_\<Service>.\_udp**パターンを使用して識別され、対応する**SRV**および**TXTレコード\*\*が提供する詳細なサービス情報を発見します。

### **ネットワークの探索**

#### **nmapの使用**

mDNSサービスをスキャンするための便利なコマンドは次のとおりです：

```bash
nmap -Pn -sUC -p5353 [target IP address]
```

このコマンドは、オープンなmDNSポートとそれらが広告するサービスを特定するのに役立ちます。

#### **Pholusを使用したネットワーク列挙**

アクティブにmDNSリクエストを送信してトラフィックをキャプチャするために、**Pholus**ツールを以下のように利用できます：

```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```

## 攻撃

### **mDNSプロービングの悪用**

攻撃ベクトルは、mDNSプローブに対してスプーフィングされた応答を送信し、すべての潜在的な名前がすでに使用中であると示唆することに関与し、新しいデバイスが一意の名前を選択するのを妨げることです。これは以下を使用して実行できます：

```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```

この技術は、新しいデバイスがネットワーク上でサービスを登録するのを効果的にブロックします。

**要約すると**、mDNSとDNS-SDの動作を理解することは、ネットワーク管理とセキュリティにとって重要です。 **nmap** や **Pholus** のようなツールは、ローカルネットワークサービスに関する貴重な情報を提供します。潜在的な脆弱性に対する認識は、攻撃から保護するのに役立ちます。

### スプーフィング/MitM

このサービス上で実行できる最も興味深い攻撃は、**クライアントと実際のサーバー間の通信**で**MitM**を実行することです。プリンターとの通信をMitMすることで、機密ファイルを入手したり（MitM the communication with the printer）、資格情報（Windows認証）を入手する可能性があります。\
詳細については、以下を参照してください：

{% content-ref url="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## 参考文献

* [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical\_IoT\_Hacking.html?id=GbYEEAAAQBAJ\&redir\_esc=y)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝したい**、または **HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を入手してください
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な [**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見つけてください
* **💬** [**Discordグループ**](https://discord.gg/hRep4RUj7f)**や** [**telegramグループ**](https://t.me/peass)**に参加するか、Twitter 🐦** [**@carlospolopm**](https://twitter.com/hacktricks\_live)**をフォローしてください。**
* **HackTricks**と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出して、あなたのハッキングトリックを共有してください。

</details>
