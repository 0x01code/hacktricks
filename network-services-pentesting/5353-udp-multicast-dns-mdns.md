# 5353/UDP Multicast DNS (mDNS) και DNS-SD

<details>

<summary><strong>Μάθετε το χάκινγκ στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

## **Βασικές Πληροφορίες**

Το **Multicast DNS (mDNS)** επιτρέπει λειτουργίες παρόμοιες με το DNS εντός τοπικών δικτύων χωρίς την ανάγκη για έναν παραδοσιακό διακομιστή DNS. Λειτουργεί στη θύρα **UDP 5353** και επιτρέπει στις συσκευές να ανακαλύπτουν η μία την άλλη και τις υπηρεσίες τους, κάτι που συνήθως βλέπουμε σε διάφορες συσκευές IoT. Η **Ανακάλυψη Υπηρεσιών DNS (DNS-SD)**, συχνά χρησιμοποιείται μαζί με το mDNS, βοηθά στον εντοπισμό των υπηρεσιών που είναι διαθέσιμες στο δίκτυο μέσω τυπικών ερωτημάτων DNS.
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **Λειτουργία του mDNS**

Σε περιβάλλοντα χωρίς έναν τυπικό διακομιστή DNS, το mDNS επιτρέπει στις συσκευές να αναλύουν ονόματα τομέων που τελειώνουν σε **.local** ερωτώντας την πολυεκπομπή διεύθυνση **224.0.0.251** (IPv4) ή **FF02::FB** (IPv6). Σημαντικά στοιχεία του mDNS περιλαμβάνουν μια τιμή **Time-to-Live (TTL)** που υποδεικνύει την ισχύ της εγγραφής και ένα **bit QU** που διακρίνει μεταξύ μονοκατευθυντικών και πολυκατευθυντικών ερωτημάτων. Όσον αφορά την ασφάλεια, είναι ζωτικής σημασίας για τις υλοποιήσεις του mDNS να επαληθεύουν ότι η διεύθυνση προέλευσης του πακέτου συμφωνεί με το τοπικό υποδίκτυο.

### **Λειτουργία του DNS-SD**

Το DNS-SD διευκολύνει την ανακάλυψη των υπηρεσιών δικτύου ερωτώντας για εγγραφές δείκτη (PTR) που αντιστοιχούν τους τύπους υπηρεσιών στις περιπτώσεις τους. Οι υπηρεσίες αναγνωρίζονται χρησιμοποιώντας ένα πρότυπο **_\<Υπηρεσία>.\_tcp ή \_\<Υπηρεσία>.\_udp** εντός του τομέα **.local**, οδηγώντας στην ανακάλυψη των αντίστοιχων εγγραφών **SRV** και **TXT** που παρέχουν λεπτομερείς πληροφορίες για την υπηρεσία.

### **Εξερεύνηση Δικτύου**

#### **Χρήση του nmap**

Ένα χρήσιμο παράδειγμα εντολής για σάρωση του τοπικού δικτύου για υπηρεσίες mDNS είναι:
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
Αυτή η εντολή βοηθά στον εντοπισμό ανοιχτών θυρών mDNS και τις υπηρεσίες που διαφημίζονται μέσω αυτών.

#### **Διακριτοποίηση Δικτύου με το Pholus**

Για να στείλετε ενεργά αιτήματα mDNS και να καταγράψετε την κίνηση, μπορείτε να χρησιμοποιήσετε το εργαλείο **Pholus** ως εξής:
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## Επιθέσεις

### **Εκμεταλλευόμενοι το mDNS Probing**

Ένα διάνυσμα επίθεσης περιλαμβάνει την αποστολή πλαστογραφημένων απαντήσεων σε αιτήματα mDNS, υποδεικνύοντας ότι όλα τα πιθανά ονόματα είναι ήδη σε χρήση, εμποδίζοντας έτσι τις νέες συσκευές να επιλέξουν ένα μοναδικό όνομα. Αυτό μπορεί να εκτελεστεί χρησιμοποιώντας:
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
Αυτή η τεχνική αποτρέπει αποτελεσματικά τις νέες συσκευές από το να καταχωρήσουν τις υπηρεσίες τους στο δίκτυο.

**Συνοψίζοντας**, η κατανόηση της λειτουργίας του mDNS και του DNS-SD είναι κρίσιμη για τη διαχείριση και την ασφάλεια του δικτύου. Εργαλεία όπως το **nmap** και το **Pholus** προσφέρουν πολύτιμες πληροφορίες για τις τοπικές υπηρεσίες του δικτύου, ενώ η επίγνωση των πιθανών ευπαθειών βοηθά στην προστασία από επιθέσεις.


### Παραπλάνηση/MitM

Η πιο ενδιαφέρουσα επίθεση που μπορείτε να πραγματοποιήσετε μέσω αυτής της υπηρεσίας είναι να πραγματοποιήσετε ένα **MitM** στη **επικοινωνία μεταξύ του πελάτη και του πραγματικού διακομιστή**. Μπορείτε να καταφέρετε να αποκτήσετε ευαίσθητα αρχεία (MitM την επικοινωνία με τον εκτυπωτή) ή ακόμα και διαπιστευτήρια (πιστοποίηση Windows).\
Για περισσότερες πληροφορίες, ανατρέξτε στο:

{% content-ref url="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## Αναφορές

* [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical\_IoT\_Hacking.html?id=GbYEEAAAQBAJ\&redir\_esc=y)

<details>

<summary><strong>Μάθετε το hacking στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF**, ελέγξτε τα [**ΠΑΚΕΤΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στην** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα κόλπα σας για το hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
