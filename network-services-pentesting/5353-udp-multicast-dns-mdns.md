# 5353/UDP Multicast DNS (mDNS) und DNS-SD

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **GitHub-Repositories** senden.

</details>

## **Grundlegende Informationen**

**Multicast DNS (mDNS)** erm√∂glicht **DNS-√§hnliche Operationen** innerhalb lokaler Netzwerke, ohne einen traditionellen DNS-Server zu ben√∂tigen. Es arbeitet auf **UDP-Port 5353** und erm√∂glicht es Ger√§ten, sich gegenseitig und ihre Dienste zu entdecken, was h√§ufig bei verschiedenen IoT-Ger√§ten zu sehen ist. **DNS Service Discovery (DNS-SD)**, oft zusammen mit mDNS verwendet, hilft bei der Identifizierung von auf dem Netzwerk verf√ºgbaren Diensten durch standardm√§√üige DNS-Abfragen.
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **Funktionsweise von mDNS**

In Umgebungen ohne einen Standard-DNS-Server erm√∂glicht mDNS Ger√§ten, Dom√§nennamen mit der Endung **.local** aufzul√∂sen, indem sie die Multicast-Adresse **224.0.0.251** (IPv4) oder **FF02::FB** (IPv6) abfragen. Wichtige Aspekte von mDNS sind ein **Time-to-Live (TTL)**-Wert, der die G√ºltigkeit des Eintrags angibt, und ein **QU-Bit**, das zwischen Unicast- und Multicast-Anfragen unterscheidet. In Bezug auf die Sicherheit ist es entscheidend, dass mDNS-Implementierungen √ºberpr√ºfen, ob die Quelladresse des Pakets mit dem lokalen Subnetz √ºbereinstimmt.

### **Funktionsweise von DNS-SD**

DNS-SD erleichtert die Entdeckung von Netzwerkdiensten, indem es nach Zeiger-Eintr√§gen (PTR) sucht, die Diensttypen ihren Instanzen zuordnen. Dienste werden mit einem Muster **_\<Service>.\_tcp oder \_\<Service>.\_udp** innerhalb der **.local**-Dom√§ne identifiziert, was zur Entdeckung entsprechender **SRV**- und **TXT-Eintr√§ge** f√ºhrt, die detaillierte Informationen √ºber den Dienst bereitstellen.

### **Netzwerkerkundung**

#### **Verwendung von nmap**

Ein n√ºtzlicher Befehl zum Scannen des lokalen Netzwerks nach mDNS-Diensten ist:
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
Dieser Befehl hilft dabei, offene mDNS-Ports zu identifizieren und die dar√ºber beworbenen Dienste zu ermitteln.

#### **Netzwerk-Enumeration mit Pholus**

Um aktiv mDNS-Anfragen zu senden und den Datenverkehr zu erfassen, kann das Tool **Pholus** wie folgt verwendet werden:
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## Angriffe

### **Ausnutzung von mDNS-Probing**

Ein Angriffsvektor besteht darin, gef√§lschte Antworten auf mDNS-Probes zu senden, die darauf hinweisen, dass alle potenziellen Namen bereits verwendet werden, um neue Ger√§te daran zu hindern, einen eindeutigen Namen auszuw√§hlen. Dies kann mit folgendem Befehl ausgef√ºhrt werden:
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
Diese Technik blockiert effektiv neue Ger√§te daran, ihre Dienste im Netzwerk zu registrieren.

**Zusammenfassend** ist es wichtig, das Funktionieren von mDNS und DNS-SD f√ºr das Netzwerkmanagement und die Sicherheit zu verstehen. Tools wie **nmap** und **Pholus** bieten wertvolle Einblicke in lokale Netzwerkdienste, w√§hrend das Bewusstsein f√ºr potenzielle Schwachstellen bei der Abwehr von Angriffen hilft.


### Spoofing/MitM

Der interessanteste Angriff, den Sie √ºber diesen Dienst durchf√ºhren k√∂nnen, besteht darin, einen **MitM-Angriff** in der **Kommunikation zwischen dem Client und dem echten Server** durchzuf√ºhren. M√∂glicherweise k√∂nnen Sie sensible Dateien (MitM-Angriff auf die Kommunikation mit dem Drucker) oder sogar Anmeldeinformationen (Windows-Authentifizierung) erhalten.\
Weitere Informationen finden Sie unter:

{% content-ref url="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## Referenzen

* [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical\_IoT\_Hacking.html?id=GbYEEAAAQBAJ\&redir\_esc=y)

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
