# 5671,5672 - AMQPのペンテスト

<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見つける
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**または[telegramグループ](https://t.me/peass)に**参加**するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)で**フォロー**してください。
* **HackTricks**および**HackTricks Cloud**のgithubリポジトリにPRを提出して、あなたのハッキングテクニックを共有してください。

</details>

## 基本情報

[cloudamqp](https://www.cloudamqp.com/blog/2015-05-18-part1-rabbitmq-for-beginners-what-is-rabbitmq.html)から：

> **RabbitMQ**は、_メッセージブローカー_または_キューマネージャー_としても知られる**メッセージキューソフトウェア**です。簡単に言えば、アプリケーションがメッセージを転送するために接続するキューが定義されているソフトウェアです。\
> **メッセージには任意の情報が含まれる**可能性があります。たとえば、別のアプリケーション（別のサーバー上にあるかもしれない）で開始すべきプロセスやタスクに関する情報が含まれているか、単なるテキストメッセージであるかもしれません。キューマネージャーソフトウェアは、受信アプリケーションが接続してキューからメッセージを取得するまでメッセージを保存します。受信アプリケーションはその後、メッセージを処理します。\
定義は。  

**デフォルトポート**: 5672,5671
```
PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
```
## 列挙

### マニュアル
```python
import amqp
#By default it uses default credentials "guest":"guest"
conn = amqp.connection.Connection(host="<IP>", port=5672, virtual_host="/")
conn.connect()
for k, v in conn.server_properties.items():
print(k, v)
```
### 自動
```bash
nmap -sV -Pn -n -T4 -p 5672 --script amqp-info <IP>

PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
| amqp-info:
|   capabilities:
|     publisher_confirms: YES
|     exchange_exchange_bindings: YES
|     basic.nack: YES
|     consumer_cancel_notify: YES
|   copyright: Copyright (C) 2007-2013 GoPivotal, Inc.
|   information: Licensed under the MPL.  See http://www.rabbitmq.com/
|   platform: Erlang/OTP
|   product: RabbitMQ
|   version: 3.1.5
|   mechanisms: PLAIN AMQPLAIN
|_  locales: en_US
```
### Brute Force

* [**AMQP Protocol Brute-Force**](../generic-methodologies-and-resources/brute-force.md#amqp-activemq-rabbitmq-qpid-joram-and-solace)
* [**STOMP Protocol Brute-Force**](../generic-methodologies-and-resources/brute-force.md#stomp-activemq-rabbitmq-hornetq-and-openmq)

## その他のRabbitMQポート

[https://www.rabbitmq.com/networking.html](https://www.rabbitmq.com/networking.html) によると、**rabbitmqは複数のポートを使用**しています:

* **1883, 8883**: ([MQTTクライアント](http://mqtt.org)、[MQTTプラグイン](https://www.rabbitmq.com/mqtt.html)が有効な場合はTLSあり/なし). [**MQTTのペンテスト方法について詳しくはこちら**](1883-pentesting-mqtt-mosquitto.md).
* **4369: epmd**, RabbitMQノードとCLIツールで使用されるピア検出サービス。[**このサービスのペンテスト方法について詳しくはこちら**](4369-pentesting-erlang-port-mapper-daemon-epmd.md).
* **5672, 5671**: AMQP 0-9-1および1.0クライアント用のポート（TLSあり/なし）
* **15672**: [HTTP API](https://www.rabbitmq.com/management.html)クライアント、[管理UI](https://www.rabbitmq.com/management.html)、[rabbitmqadmin](https://www.rabbitmq.com/management-cli.html)（[管理プラグイン](https://www.rabbitmq.com/management.html)が有効な場合のみ）. [**このサービスのペンテスト方法について詳しくはこちら**](15672-pentesting-rabbitmq-management.md).
* 15674: STOMP-over-WebSocketsクライアント（[Web STOMPプラグイン](https://www.rabbitmq.com/web-stomp.html)が有効な場合のみ）
* 15675: MQTT-over-WebSocketsクライアント（[Web MQTTプラグイン](https://www.rabbitmq.com/web-mqtt.html)が有効な場合のみ）
* 15692: Prometheusメトリクス（[Prometheusプラグイン](https://www.rabbitmq.com/prometheus.html)が有効な場合のみ）
* 25672: ノード間およびCLIツール間の通信に使用される（Erlangディストリビューションサーバーポート）. AMQPポート+20000で計算された動的範囲から割り当てられます（デフォルトでは1つのポートに制限されています）. これらのポートへの外部接続が本当に必要な場合（クラスターが[federation](https://www.rabbitmq.com/federation.html)を使用している場合や、サブネット外のマシンでCLIツールを使用している場合など）を除いて、これらのポートは公開されるべきではありません。詳細については[ネットワーキングガイド](https://www.rabbitmq.com/networking.html)を参照してください。**インターネット上で開かれているのはこれらのポートのみです**。
* 35672-35682: CLIツールによって使用される（Erlangディストリビューションクライアントポート）. サーバーディストリビューションポート+10000からサーバーディストリビューションポート+10010までの動的範囲から割り当てられます。詳細については[ネットワーキングガイド](https://www.rabbitmq.com/networking.html)を参照してください。
* 61613, 61614: [STOMPクライアント](https://stomp.github.io/stomp-specification-1.2.html)（TLSあり/なし）（[STOMPプラグイン](https://www.rabbitmq.com/stomp.html)が有効な場合のみ）. このポートが開いているデバイスは10台未満で、DHTノードのために主にUDPが使用されています。

## Shodan

* `AMQP`

<details>

<summary><strong>ゼロからヒーローまでのAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>!</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[NFTs](https://opensea.io/collection/the-peass-family)のコレクションを見つける
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**に参加するか、[telegramグループ](https://t.me/peass)に参加するか、**Twitter**で**@carlospolopm**をフォローする🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **HackTricks**と**HackTricks Cloud**のgithubリポジトリにPRを提出して、あなたのハッキングトリックを共有してください。

</details>
