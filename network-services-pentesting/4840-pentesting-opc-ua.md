# 4840 - Test d'intrusion OPC UA

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informations de base

OPC UA signifie Open Platform Communications Unified Access. C'est un protocole open-source de longue date pour l'√©change de donn√©es, la collecte de t√©l√©m√©trie et le contr√¥le des √©quipements industriels. Il est tr√®s largement utilis√© dans les environnements industriels, y compris la fabrication, l'√©nergie, l'a√©rospatiale et la d√©fense. C'est le seul moyen standardis√© de communiquer avec les automates programmables et permet aux √©quipements de diff√©rents fournisseurs de communiquer entre eux.

OPC UA est tr√®s flexible en termes de configuration. Il peut √™tre configur√© pour √™tre extr√™mement s√©curis√© ou non s√©curis√©. Souvent, les fonctionnalit√©s de s√©curit√© sont d√©sactiv√©es pour permettre la communication avec des appareils plus anciens. Tester la configuration pour d√©tecter les faiblesses peut donc r√©v√©ler un acc√®s facile aux syst√®mes critiques.

Les scanners de r√©seau ne reconnaissent pas OPC UA, donc la d√©couverte peut n√©cessiter un peu de travail si des ports non standards sont utilis√©s.

**Port par d√©faut :** 4840
```text
PORT     STATE SERVICE REASON
4840/tcp open  unknown syn-ack
```
## Test d'intrusion OPC UA

Pour r√©v√©ler les probl√®mes de s√©curit√© dans les serveurs OPC UA, analysez-les avec [OpalOPC](https://opalopc.com/).
```bash
opalopc -vv opc.tcp://$target_ip_or_hostname:$target_port
```
### Exploitation de vuln√©rabilit√©s

**‚ö†Ô∏è Avertissement ‚ö†Ô∏è**: Fouiller sans savoir ce que vous faites peut causer de graves dangers pour la sant√© des personnes et des pertes financi√®res pour votre client.

Si des vuln√©rabilit√©s de contournement d'authentification sont trouv√©es, vous pouvez configurer un [client OPC UA](https://www.prosysopc.com/products/opc-ua-browser/) en cons√©quence et voir ce √† quoi vous pouvez acc√©der. Cela peut permettre tout, de la simple lecture des valeurs de processus √† l'op√©ration r√©elle d'√©quipements industriels lourds.

Pour avoir une id√©e de l'appareil auquel vous avez acc√®s, lisez les valeurs du n≈ìud "ServerStatus" dans l'espace d'adressage et recherchez un manuel d'utilisation sur Google.

## Shodan

* `port:4840`

## R√©f√©rences

* https://opalopc.com/how-to-hack-opc-ua/

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez**-moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
