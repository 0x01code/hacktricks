# 4840 - OPC UAのペネトレーションテスト

<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>をチェック！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に**参加する**か、[**テレグラムグループ**](https://t.me/peass)に参加する、または**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローする**。
* [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングのコツを**共有する**。

</details>

## 基本情報

OPC UAはOpen Platform Communications Unified Accessの略です。これは、データ交換、テレメトリ収集、産業機器の制御のための長年にわたるオープンソースプロトコルです。製造、エネルギー、航空宇宙、防衛などの産業分野で広く使用されています。PLCと通信する唯一の標準化された方法であり、異なるベンダーの機器同士が通信できるようにします。

OPC UAは設定において非常に柔軟です。非常に安全に、または安全でないように設定することができます。多くの場合、古いデバイスとの通信を可能にするためにセキュリティ機能が無効にされています。したがって、設定の弱点をテストすることで、重要なシステムへの容易な入口が明らかになる可能性があります。

ネットワークスキャナーはOPC UAを認識しないため、非標準ポートが使用されている場合、発見にはいくらかの作業が必要になるかもしれません。

**デフォルトポート:** 4840
```text
PORT     STATE SERVICE REASON
4840/tcp open  unknown syn-ack
```
## OPC UAのペネトレーションテスト

OPC UAサーバーのセキュリティ問題を明らかにするために、[OpalOPC](https://opalopc.com/)でスキャンします。
```bash
opalopc -vv opc.tcp://$target_ip_or_hostname:$target_port
```
### 脆弱性の悪用

**⚠️ 警告 ⚠️**: 知識がないまま行動すると、人々の健康に深刻な危険を及ぼしたり、クライアントに金銭的損失をもたらす可能性があります。

認証バイパスの脆弱性が見つかった場合、[OPC UAクライアント](https://www.prosysopc.com/products/opc-ua-browser/)を適切に設定し、何にアクセスできるかを確認できます。これにより、単にプロセス値を読むだけでなく、実際に重工業機器を操作することも可能になるかもしれません。

アクセスできるデバイスについての手がかりを得るために、アドレス空間の"ServerStatus"ノードの値を読み、使用マニュアルをGoogleで検索してください。

## Shodan

* `port:4840`

## 参考文献

* https://opalopc.com/how-to-hack-opc-ua/

<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには、</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>をチェック！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手してください。
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、私たちの独占的な[**NFTコレクション**](https://opensea.io/collection/the-peass-family)をチェックしてください。
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**テレグラムグループ**](https://t.me/peass)に**参加するか**、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)で**フォローしてください。**
* [**HackTricks**](https://github.com/carlospolop/hacktricks)および[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出して、あなたのハッキングのコツを**共有してください。**

</details>
