# 4840 - Pentesting OPC UA

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

## Informations de base

**OPC UA**, qui signifie **Open Platform Communications Unified Access**, est un protocole open source crucial utilis√© dans diverses industries telles que la fabrication, l'√©nergie, l'a√©rospatiale et la d√©fense pour l'√©change de donn√©es et le contr√¥le d'√©quipements. Il permet de mani√®re unique √† des √©quipements de diff√©rents fournisseurs de communiquer, en particulier avec des automates programmables industriels (PLC).

Sa configuration permet des mesures de s√©curit√© renforc√©es, mais souvent, pour la compatibilit√© avec des appareils plus anciens, celles-ci sont r√©duites, exposant ainsi les syst√®mes √† des risques. De plus, trouver des services OPC UA peut √™tre d√©licat car les scanners r√©seau peuvent ne pas les d√©tecter s'ils sont sur des ports non standard.

**Port par d√©faut :** 4840
```text
PORT     STATE SERVICE REASON
4840/tcp open  unknown syn-ack
```
## Test d'intrusion OPC UA

Pour r√©v√©ler les probl√®mes de s√©curit√© dans les serveurs OPC UA, scannez-les avec [OpalOPC](https://opalopc.com/).
```bash
opalopc -vv opc.tcp://$target_ip_or_hostname:$target_port
```
### Exploiter les vuln√©rabilit√©s

Si des vuln√©rabilit√©s de contournement de l'authentification sont trouv√©es, vous pouvez configurer un [client OPC UA](https://www.prosysopc.com/products/opc-ua-browser/) en cons√©quence et voir ce √† quoi vous pouvez acc√©der. Cela peut permettre de simplement lire les valeurs de processus ou m√™me de faire fonctionner des √©quipements industriels lourds.

Pour avoir une id√©e de l'appareil auquel vous avez acc√®s, lisez les valeurs du n≈ìud "ServerStatus" dans l'espace d'adressage et recherchez un manuel d'utilisation sur Google.

## Shodan

* `port:4840`

## R√©f√©rences

* [https://opalopc.com/how-to-hack-opc-ua/](https://opalopc.com/how-to-hack-opc-ua/)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>
