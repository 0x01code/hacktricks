# 4840 - Pentesting OPC UA

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Informazioni di base

**OPC UA**, che sta per **Open Platform Communications Unified Access**, √® un cruciale protocollo open-source utilizzato in vari settori come Manifatturiero, Energia, Aerospaziale e Difesa per lo scambio di dati e il controllo degli equipaggiamenti. Consente in modo unico a diversi equipaggiamenti di fornitori di comunicare, specialmente con i PLC.

La sua configurazione consente l'implementazione di robuste misure di sicurezza, ma spesso, per la compatibilit√† con dispositivi pi√π vecchi, queste vengono ridotte, esponendo i sistemi a rischi. Inoltre, trovare servizi OPC UA pu√≤ essere complicato poich√© gli scanner di rete potrebbero non rilevarli se si trovano su porte non standard.

**Porta predefinita:** 4840
```text
PORT     STATE SERVICE REASON
4840/tcp open  unknown syn-ack
```
## Pentesting OPC UA

Per rivelare problemi di sicurezza nei server OPC UA, esegui una scansione con [OpalOPC](https://opalopc.com/).
```bash
opalopc -vv opc.tcp://$target_ip_or_hostname:$target_port
```
### Sfruttare le vulnerabilit√†

Se vengono trovate vulnerabilit√† di bypass dell'autenticazione, √® possibile configurare un [client OPC UA](https://www.prosysopc.com/products/opc-ua-browser/) di conseguenza e vedere a cosa si pu√≤ accedere. Ci√≤ potrebbe consentire di leggere semplicemente i valori di processo o addirittura di operare attrezzature industriali pesanti.

Per avere un'idea del dispositivo a cui si ha accesso, leggere i valori del nodo "ServerStatus" nello spazio degli indirizzi e cercare un manuale di utilizzo su Google.

## Shodan

* `port:4840`

## Riferimenti

* [https://opalopc.com/how-to-hack-opc-ua/](https://opalopc.com/how-to-hack-opc-ua/)

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF**, controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository GitHub di** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
