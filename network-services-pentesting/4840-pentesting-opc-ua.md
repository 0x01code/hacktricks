# 4840 - Pentesting OPC UA

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sigue** a **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informaci√≥n B√°sica

OPC UA significa Open Platform Communications Unified Access. Es un protocolo de c√≥digo abierto de larga data para el intercambio de datos, la recolecci√≥n de telemetr√≠a y el control de equipos industriales. Es muy utilizado en entornos industriales incluyendo Manufactura, Energ√≠a, Aeroespacial y Defensa. Es la √∫nica forma estandarizada de comunicarse con PLCs y permite que los equipos de diferentes proveedores se comuniquen entre s√≠.

OPC UA es muy flexible en t√©rminos de configuraci√≥n. Puede configurarse para ser extremadamente seguro o inseguro. Muchas veces, las caracter√≠sticas de seguridad est√°n desactivadas para permitir la comunicaci√≥n con dispositivos m√°s antiguos. Por lo tanto, probar la configuraci√≥n en busca de debilidades puede revelar una entrada f√°cil a sistemas cr√≠ticos.

Los esc√°neres de red no reconocen OPC UA, por lo que el descubrimiento puede requerir trabajo si se utilizan puertos no est√°ndar.

**Puerto predeterminado:** 4840
```text
PORT     STATE SERVICE REASON
4840/tcp open  unknown syn-ack
```
## Pentesting OPC UA

Para revelar problemas de seguridad en servidores OPC UA, escan√©alo con [OpalOPC](https://opalopc.com/).
```bash
opalopc -vv opc.tcp://$target_ip_or_hostname:$target_port
```
### Explotaci√≥n de vulnerabilidades

**‚ö†Ô∏è Advertencia ‚ö†Ô∏è**: Investigar sin saber lo que est√°s haciendo puede causar serios riesgos para la salud de las personas y p√©rdidas monetarias para tu cliente.

Si se encuentran vulnerabilidades de bypass de autenticaci√≥n, puedes configurar un [cliente OPC UA](https://www.prosysopc.com/products/opc-ua-browser/) en consecuencia y ver a qu√© puedes acceder. Esto puede permitir desde simplemente leer valores de procesos hasta operar equipos industriales de gran envergadura.

Para tener una idea del dispositivo al que tienes acceso, lee los valores del nodo "ServerStatus" en el espacio de direcciones y busca en Google un manual de uso.

## Shodan

* `port:4840`

## Referencias

* https://opalopc.com/how-to-hack-opc-ua/

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sigue** a **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
