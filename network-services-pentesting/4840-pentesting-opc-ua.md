# 4840 - OPC UAのペンテスト

<details>

<summary><strong>**htARTE（HackTricks AWS Red Team Expert）**でAWSハッキングをゼロからヒーローまで学ぶ！</strong></summary>

HackTricksをサポートする他の方法：

- **HackTricksで企業を宣伝したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
- [**公式PEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を入手する
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見つける
- 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に参加するか、[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)で**フォロー**する
- **ハッキングテクニックを共有するために、**[**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出する

</details>

## 基本情報

**OPC UA**は、**Open Platform Communications Unified Access**の略で、製造業、エネルギー、航空宇宙、防衛などのさまざまな産業でデータ交換や機器制御に使用される重要なオープンソースプロトコルです。異なるベンダーの機器が特にPLCと通信できるようにするために、異なるベンダーの機器が特にPLCと通信できるようにします。

その構成には強力なセキュリティ対策が可能ですが、古いデバイスとの互換性を確保するためにこれらが緩和されることがよくあり、システムがリスクにさらされることがあります。また、OPC UAサービスを見つけることは難しい場合があります。ネットワークスキャナーが非標準ポートにある場合、それらを検出しない可能性があるためです。

**デフォルトポート:** 4840
```text
PORT     STATE SERVICE REASON
4840/tcp open  unknown syn-ack
```
## OPC UAのペンテスト

OPC UAサーバーのセキュリティ問題を明らかにするには、[OpalOPC](https://opalopc.com/)でスキャンしてください。
```bash
opalopc -vv opc.tcp://$target_ip_or_hostname:$target_port
```
### 脆弱性の悪用

認証バイパスの脆弱性が見つかった場合、[OPC UAクライアント](https://www.prosysopc.com/products/opc-ua-browser/)を適切に構成してアクセスできる内容を確認できます。これにより、プロセス値の読み取りから実際に重い産業機器を操作するまで、さまざまなことが可能になるかもしれません。

アクセスできるデバイスの手掛かりを得るためには、アドレススペース内の「ServerStatus」ノードの値を読み取り、使用マニュアルを検索してください。

## Shodan

* `port:4840`

## 参考文献

* [https://opalopc.com/how-to-hack-opc-ua/](https://opalopc.com/how-to-hack-opc-ua/)

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）を使用して、ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>!</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksで企業を宣伝したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見つける
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)で**フォロー**してください。
* **HackTricks**と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出して、あなたのハッキングトリックを共有してください。

</details>
