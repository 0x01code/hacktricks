<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- ¿Trabajas en una **empresa de ciberseguridad**? ¿Quieres ver tu **empresa anunciada en HackTricks**? ¿O quieres tener acceso a la **última versión de PEASS o descargar HackTricks en PDF**? ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtén la [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **Únete al** [**💬**](https://emojipedia.org/speech-balloon/) **grupo de Discord** o al [**grupo de telegram**](https://t.me/peass) o **sígueme en** **Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PR al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# **Información del Protocolo**

**NDMP**, o **Protocolo de Gestión de Datos de Red**, es un protocolo destinado a transportar datos entre dispositivos de almacenamiento conectados a la red \([NAS](https://en.wikipedia.org/wiki/Network-attached_storage)\) y dispositivos de [backup](https://en.wikipedia.org/wiki/Backup). Esto elimina la necesidad de transportar los datos a través del servidor de backup en sí, mejorando así la velocidad y eliminando la carga del servidor de backup.  
De [Wikipedia](https://en.wikipedia.org/wiki/NDMP).

**Puerto predeterminado:** 10000
```text
PORT      STATE SERVICE REASON  VERSION
10000/tcp open  ndmp    syn-ack Symantec/Veritas Backup Exec ndmp
```
# Enumeración

## **NDMP Enumeration**

## **Enumeración de NDMP**

### **Port Scanning**

### **Escaneo de puertos**

We can start by scanning the target host for open ports using tools like Nmap or Masscan. NDMP uses port 10000 by default, but it can be configured to use a different port.

Podemos comenzar escaneando el host objetivo en busca de puertos abiertos utilizando herramientas como Nmap o Masscan. NDMP utiliza el puerto 10000 de forma predeterminada, pero se puede configurar para utilizar un puerto diferente.

```bash
nmap -p 10000 <target_ip>
```

### **Banner Grabbing**

### **Obtención de banner**

Once we have identified the open port, we can try to grab the banner to determine the NDMP version and the vendor.

Una vez que hemos identificado el puerto abierto, podemos intentar obtener el banner para determinar la versión y el proveedor de NDMP.

```bash
nc -nv <target_ip> 10000
```

### **NDMP Enumeration with ndmp-tool**

### **Enumeración de NDMP con ndmp-tool**

We can use the ndmp-tool to enumerate the NDMP service and gather information about the backup jobs, volumes, and file systems.

Podemos utilizar la herramienta ndmp-tool para enumerar el servicio NDMP y recopilar información sobre los trabajos de copia de seguridad, volúmenes y sistemas de archivos.

```bash
ndmp-tool <target_ip> -enum
```

The output will show the NDMP version, vendor, and supported authentication methods.

La salida mostrará la versión, el proveedor y los métodos de autenticación admitidos de NDMP.

```bash
NDMP Version: 4
Vendor: NetApp
Auth Methods: AUTH_NONE, AUTH_MD5
```

We can also use the ndmp-tool to list the backup jobs, volumes, and file systems.

También podemos utilizar la herramienta ndmp-tool para listar los trabajos de copia de seguridad, volúmenes y sistemas de archivos.

```bash
ndmp-tool <target_ip> -lj
ndmp-tool <target_ip> -lv
ndmp-tool <target_ip> -lf
```

### **NDMP Enumeration with Metasploit**

### **Enumeración de NDMP con Metasploit**

Metasploit also provides a module for NDMP enumeration.

Metasploit también proporciona un módulo para la enumeración de NDMP.

```bash
use auxiliary/scanner/ndmp/ndmp_enum
set RHOSTS <target_ip>
run
```

The output will show the NDMP version, vendor, and supported authentication methods.

La salida mostrará la versión, el proveedor y los métodos de autenticación admitidos de NDMP.

```bash
[*] NDMP Version: 4
[*] Vendor: NetApp
[*] Auth Methods: AUTH_NONE, AUTH_MD5
```
```bash
nmap -n -sV --script "ndmp-fs-info or ndmp-version" -p 10000 <IP> #Both are default scripts
```
## Shodan

`ndmp`

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- ¿Trabajas en una **empresa de ciberseguridad**? ¿Quieres ver tu **empresa anunciada en HackTricks**? ¿O quieres tener acceso a la **última versión de PEASS o descargar HackTricks en PDF**? ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtén el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)

- **Únete al** [**💬**](https://emojipedia.org/speech-balloon/) **grupo de Discord** o al [**grupo de telegram**](https://t.me/peass) o **sígueme en Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PR al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
