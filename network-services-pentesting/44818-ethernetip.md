# **Informaci√≥n del Protocolo**

Del art√≠culo de Wikipedia sobre EtherNet/IP [http://en.wikipedia.org/wiki/EtherNet/IP](http://en.wikipedia.org/wiki/EtherNet/IP)

> EtherNet/IP fue desarrollado a finales de los a√±os 90 por Rockwell Automation como parte de las soluciones de redes Ethernet industriales de Rockwell. Rockwell le dio a EtherNet/IP su nombre y lo entreg√≥ a ODVA, que ahora gestiona el protocolo y asegura la interoperabilidad de sistemas multi-vendedor exigiendo el cumplimiento de est√°ndares establecidos siempre que se desarrollen nuevos productos que utilicen el protocolo.

> EtherNet/IP se utiliza principalmente en sistemas de control de automatizaci√≥n industrial, como plantas de procesamiento de agua, instalaciones de fabricaci√≥n y servicios p√∫blicos. Varios proveedores de sistemas de control han desarrollado controladores de automatizaci√≥n programables y E/S capaces de comunicarse a trav√©s de EtherNet/IP.

Un dispositivo EtherNet/IP se identifica positivamente consultando TCP/44818 con un mensaje de lista de identidades (0x63). Los mensajes de respuesta determinar√°n si es un dispositivo EtherNet/IP y analizar√°n la informaci√≥n para enumerar el dispositivo.\
Desde [aqu√≠](https://github.com/digitalbond/Redpoint)

**Puerto predeterminado:** 44818 UDP/TCP
```
PORT      STATE SERVICE
44818/tcp open  EtherNet/IP
```
# Enumeraci√≥n

## **Discovering devices**

## **Descubriendo dispositivos**

### **ARP Scanning**

### **Escaneo ARP**

The first step to discover devices in the network is to perform an ARP scan. This will allow us to discover the IP addresses of the devices in the network.

El primer paso para descubrir dispositivos en la red es realizar un escaneo ARP. Esto nos permitir√° descubrir las direcciones IP de los dispositivos en la red.

```bash
nmap -sn 192.168.1.0/24
```

### **CIP Scanning**

### **Escaneo CIP**

Once we have the IP addresses of the devices, we can perform a CIP scan to discover the devices that support the CIP protocol.

Una vez que tenemos las direcciones IP de los dispositivos, podemos realizar un escaneo CIP para descubrir los dispositivos que admiten el protocolo CIP.

```bash
nmap -sU -p 2222 --script enip-info 192.168.1.1
```

## **Discovering services**

## **Descubriendo servicios**

### **Banner Grabbing**

### **Obtenci√≥n de banners**

Once we have discovered the devices and the services they are running, we can perform banner grabbing to obtain information about the services.

Una vez que hemos descubierto los dispositivos y los servicios que est√°n ejecutando, podemos realizar la obtenci√≥n de banners para obtener informaci√≥n sobre los servicios.

```bash
nmap -sV -p 2222 --script enip-info 192.168.1.1
```

### **Default Credentials**

### **Credenciales predeterminadas**

We can also try to log in to the services using default credentials.

Tambi√©n podemos intentar iniciar sesi√≥n en los servicios utilizando credenciales predeterminadas.

```bash
python3 ./enum4linux-ng.py -U users.txt -P passwords.txt 192.168.1.1
```

### **Brute Force**

### **Fuerza bruta**

If default credentials do not work, we can try to brute force the credentials.

Si las credenciales predeterminadas no funcionan, podemos intentar realizar un ataque de fuerza bruta contra las credenciales.

```bash
hydra -L users.txt -P passwords.txt 192.168.1.1 enip
```
```bash
nmap -n -sV --script enip-info -p 44818 <IP>
pip3 install cpppo
python3 -m cpppo.server.enip.list_services [--udp] [--broadcast] --list-identity -a <IP>
```
# Shodan

* `port:44818 "nombre del producto"`


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obt√©n el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)

- **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PR al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
