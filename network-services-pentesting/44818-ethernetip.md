<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ企業**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)にPRを提出してください。**

</details>


# **プロトコル情報**

EtherNet/IPに関するWikipediaの記事から引用 [http://en.wikipedia.org/wiki/EtherNet/IP](http://en.wikipedia.org/wiki/EtherNet/IP)

> EtherNet/IPは、Rockwell Automationによって1990年代後半に開発され、Rockwellの産業用イーサネットネットワーキングソリューションの一部として開発されました。RockwellはEtherNet/IPという名前を付け、現在はプロトコルを管理し、新しいプロトコルを利用する製品が開発される際には、確立された標準に準拠することを要求して、マルチベンダーシステムの相互運用性を保証しています。

> EtherNet/IPは、主に水処理プラント、製造施設、公益事業などの産業用自動制御システムで最も一般的に使用されています。いくつかの制御システムベンダーは、EtherNet/IPを介して通信できるプログラマブルオートメーションコントローラとI/Oを開発しています。

EtherNet/IPデバイスは、TCP/44818をクエリすることで正確に識別されます。リストIdentitiesメッセージ（0x63）を使用して、応答メッセージがEtherNet/IPデバイスであるかどうかを判断し、デバイスを列挙するための情報を解析します。\
[ここから](https://github.com/digitalbond/Redpoint)

**デフォルトポート:** 44818 UDP/TCP
```
PORT      STATE SERVICE
44818/tcp open  EtherNet/IP
```
# **列挙**

---

## **Ethernet/IP**

---

Ethernet/IP (Industrial Protocol) is a communication protocol widely used in industrial automation systems. It is based on the Common Industrial Protocol (CIP) and uses the TCP/IP stack for communication.

### **Protocol Overview**

Ethernet/IP uses the CIP protocol to exchange data between devices in an industrial network. It supports various types of devices, including programmable logic controllers (PLCs), human-machine interfaces (HMIs), and sensors.

The protocol operates at the application layer of the TCP/IP stack and uses the User Datagram Protocol (UDP) and Transmission Control Protocol (TCP) for communication. UDP is used for multicast and broadcast messages, while TCP is used for unicast messages.

### **Enumeration Techniques**

To enumerate Ethernet/IP devices, you can use the following techniques:

1. **ARP Scanning**: Send an Address Resolution Protocol (ARP) request to the network to discover Ethernet/IP devices. This technique is effective for devices on the same subnet.

2. **Port Scanning**: Perform a port scan on the target IP addresses to identify open ports associated with Ethernet/IP services. Common ports used by Ethernet/IP include TCP port 44818 and UDP port 2222.

3. **Banner Grabbing**: Connect to the target device's open ports and retrieve the banners or service information. This can provide valuable information about the device and its Ethernet/IP services.

4. **Protocol-Specific Tools**: Use specialized tools like `nmap` or `Wireshark` with Ethernet/IP protocol support to perform enumeration and analysis of Ethernet/IP devices.

### **Enumeration Results**

During the enumeration process, you may discover the following information about Ethernet/IP devices:

- IP addresses and MAC addresses of the devices
- Open ports associated with Ethernet/IP services
- Device names and descriptions
- Firmware versions and software information
- Network topology and device relationships

This information can be used to further analyze and exploit the Ethernet/IP devices during a penetration test.

---

## **Ethernet/IP**

---

Ethernet/IP（Industrial Protocol）は、産業オートメーションシステムで広く使用されている通信プロトコルです。これはCommon Industrial Protocol（CIP）に基づいており、通信にはTCP/IPスタックを使用しています。

### **プロトコルの概要**

Ethernet/IPは、産業ネットワーク内のデバイス間でデータを交換するためにCIPプロトコルを使用します。プログラマブルロジックコントローラ（PLC）、人間機械インターフェース（HMI）、センサーなど、さまざまなタイプのデバイスをサポートしています。

このプロトコルは、TCP/IPスタックのアプリケーション層で動作し、通信にはUser Datagram Protocol（UDP）とTransmission Control Protocol（TCP）を使用します。UDPはマルチキャストやブロードキャストメッセージに使用され、TCPはユニキャストメッセージに使用されます。

### **列挙の手法**

Ethernet/IPデバイスを列挙するために、次の手法を使用できます：

1. **ARPスキャン**：ネットワークにAddress Resolution Protocol（ARP）リクエストを送信して、Ethernet/IPデバイスを検出します。この手法は、同じサブネット上のデバイスに対して効果的です。

2. **ポートスキャン**：対象のIPアドレスに対してポートスキャンを実行し、Ethernet/IPサービスに関連付けられたオープンポートを特定します。Ethernet/IPで使用される一般的なポートには、TCPポート44818とUDPポート2222があります。

3. **バナーグラビング**：対象デバイスのオープンポートに接続し、バナーやサービス情報を取得します。これにより、デバイスとそのEthernet/IPサービスに関する貴重な情報が得られます。

4. **プロトコル固有のツール**：Ethernet/IPプロトコルをサポートする`nmap`や`Wireshark`などの専用ツールを使用して、Ethernet/IPデバイスの列挙と分析を行います。

### **列挙の結果**

列挙プロセス中に、Ethernet/IPデバイスに関する次の情報を発見することがあります：

- デバイスのIPアドレスとMACアドレス
- Ethernet/IPサービスに関連付けられたオープンポート
- デバイスの名前と説明
- ファームウェアバージョンとソフトウェア情報
- ネットワークのトポロジーとデバイスの関係

この情報は、ペネトレーションテスト中にEthernet/IPデバイスをさらに分析し、悪用するために使用できます。
```bash
nmap -n -sV --script enip-info -p 44818 <IP>
pip3 install cpppo
python3 -m cpppo.server.enip.list_services [--udp] [--broadcast] --list-identity -a <IP>
```
# Shodan

* `port:44818 "製品名"`


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ企業で働いていますか？** HackTricksで**会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見しましょう。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>
