# 111/TCP/UDP - Pentesting Portmapper

<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) za kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Taarifa Msingi

**Portmapper** ni huduma inayotumiwa kwa kufanya ramani ya bandari za huduma za mtandao kwa nambari za programu za **RPC** (Wito wa Mbali wa Utaratibu). Inafanya kazi kama sehemu muhimu katika **mifumo inayotumia Unix**, ikirahisisha kubadilishana taarifa kati ya mifumo hii. **Bandari** inayohusishwa na **Portmapper** mara nyingi huchunguzwa na wadukuzi kwani inaweza kufunua taarifa muhimu. Taarifa hizi ni pamoja na aina ya **Mfumo wa Uendeshaji wa Unix (OS)** unaoendeshwa na maelezo kuhusu huduma zilizopo kwenye mfumo. Aidha, **Portmapper** mara nyingi hutumiwa pamoja na **NFS (Mfumo wa Faili wa Mtandao)**, **NIS (Huduma ya Taarifa ya Mtandao)**, na huduma zingine za **RPC** kusimamia huduma za mtandao kwa ufanisi.

**Bandari ya default:** 111/TCP/UDP, 32771 kwenye Oracle Solaris
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## Uchambuzi
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
### Shodan

* `port:111 portmap`

## RPCBind + NFS

Ikiwa utapata huduma ya NFS basi labda utaweza kupata orodha na kupakua (na labda kupakia) faili:

![](<../.gitbook/assets/image (872).png>)

Soma [2049 - Pentesting NFS service](nfs-service-pentesting.md) kujifunza zaidi kuhusu jinsi ya kufanya majaribio ya itifaki hii.

## NIS

Kuchunguza udhaifu wa **NIS** kunahusisha mchakato wa hatua mbili, ukianza na kutambua huduma ya `ypbind`. Msingi wa uchunguzi huu ni kugundua **jina la kikoa cha NIS**, bila ambayo maendeleo yanakwama.

![](<../.gitbook/assets/image (859).png>)

Safari ya uchunguzi inaanza na usakinishaji wa pakiti muhimu (`apt-get install nis`). Hatua inayofuata inahitaji kutumia `ypwhich` kuthibitisha uwepo wa seva ya NIS kwa kuita kwa jina la kikoa na anwani ya seva, kuhakikisha vipengele hivi vimefichwa kwa usalama.

Hatua ya mwisho na muhimu inahusisha amri ya `ypcat` kutoa data nyeti, hasa nywila za watumiaji zilizofichwa. Vipande hivi, mara baada ya kuvunjwa kutumia zana kama **John the Ripper**, hufunua ufahamu kuhusu ufikiaji wa mfumo na mamlaka.
```bash
# Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d <domain-name> <server-ip>
# Extract user credentials
ypcat ‚Äìd <domain-name> ‚Äìh <server-ip> passwd.byname
```
### Faili za NIF

| **Faili Kuu**    | **Ramani(z)**               | **Maelezo**                           |
| ---------------- | --------------------------- | ------------------------------------- |
| /etc/hosts       | hosts.byname, hosts.byaddr  | Ina jina la mwenyeji na maelezo ya IP |
| /etc/passwd      | passwd.byname, passwd.byuid | Faili ya nenosiri ya mtumiaji wa NIS  |
| /etc/group       | group.byname, group.bygid   | Faili ya kikundi ya NIS               |
| /usr/lib/aliases | mail.aliases                | Maelezo ya anwani za barua pepe      |

## Watumiaji wa RPC

Ikiwa unapata huduma ya **rusersd** ikiwa imeorodheshwa kama hii:

![](<../.gitbook/assets/image (1041).png>)

Unaweza kuchunguza watumiaji wa sanduku. Ili kujifunza jinsi ya kufanya hivyo soma [1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md).

## Kupuuza Port ya Portmapper iliyofungwa

Unapofanya **uchunguzi wa nmap** na kugundua milango ya NFS wazi na mlango wa 111 ukiwa umefungwa, utekelezaji moja kwa moja wa milango hii hauwezekani. Walakini, kwa **kujenga huduma ya portmapper kwa kivuli kwenye mashine yako** na kuanzisha handaki kutoka kwenye mashine yako kwenda lengo, utekelezaji unawezekana kwa kutumia zana za kawaida. Mbinu hii inaruhusu kupuuza hali iliyofungwa ya mlango wa 111, hivyo kuruhusu ufikiaji wa huduma za NFS. Kwa mwongozo wa kina kuhusu mbinu hii, tazama makala inayopatikana kwenye [kiunga hiki](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc).

## Shodan

* `Portmap`

## Maabara za Mazoezi

* Fanya mazoezi ya mbinu hizi kwenye [**Mashine ya HTB ya Irked**](https://app.hackthebox.com/machines/Irked).

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Amri za Kiotomatiki za HackTricks
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kuhack kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
