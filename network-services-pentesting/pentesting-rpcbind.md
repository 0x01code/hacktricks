# 111/TCP/UDP - Pentesting Portmapper

<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) no github.

</details>

## Informa√ß√µes B√°sicas

Fornece informa√ß√µes entre sistemas baseados em Unix. A porta √© frequentemente sondada, pode ser usada para identificar o sistema operacional Nix e obter informa√ß√µes sobre servi√ßos dispon√≠veis. Porta usada com NFS, NIS ou qualquer servi√ßo baseado em rpc.

**Porta padr√£o:** 111/TCP/UDP, 32771 no Oracle Solaris
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## Enumera√ß√£o
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
√Äs vezes n√£o fornece nenhuma informa√ß√£o, em outras ocasi√µes voc√™ obter√° algo assim:

![](<../.gitbook/assets/image (230).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

Se voc√™ encontrar o servi√ßo NFS, provavelmente poder√° listar e baixar (e talvez enviar) arquivos:

![](<../.gitbook/assets/image (232).png>)

Leia [2049 - Pentesting no servi√ßo NFS](nfs-service-pentesting.md) para aprender mais sobre como testar este protocolo.

## NIS

Se voc√™ encontrar o servi√ßo `ypbind` em execu√ß√£o:

![](<../.gitbook/assets/image (233).png>)

Voc√™ pode tentar explor√°-lo. De qualquer forma, antes de tudo, voc√™ **precisar√° adivinhar o "nome de dom√≠nio" NIS** da m√°quina (quando o NIS √© instalado, √© configurado um "nome de dom√≠nio") e **sem conhecer este nome de dom√≠nio voc√™ n√£o pode fazer nada**.

Ap√≥s obter o nome de dom√≠nio NIS para o ambiente (example.org neste caso), use o comando ypwhich para pingar o servidor NIS e ypcat para obter material sens√≠vel. Voc√™ deve alimentar hashes de senhas criptografadas no John the Ripper e, uma vez quebradas, voc√™ pode us√°-las para avaliar o acesso ao sistema e privil√©gios.
```bash
root@kali:~# apt-get install nis
root@kali:~# ypwhich -d example.org 192.168.10.1
potatohead.example.org
root@kali:~# ypcat ‚Äìd example.org ‚Äìh 192.168.10.1 passwd.byname
tiff:noR7Bk6FdgcZg:218:101::/export/home/tiff:/bin/bash
katykat:d.K5tGUWCJfQM:2099:102::/export/home/katykat:/bin/bash
james:i0na7pfgtxi42:332:100::/export/home/james:/bin/tcsh
florent:nUNzkxYF0Hbmk:199:100::/export/home/florent:/bin/csh
dave:pzg1026SzQlwc:182:100::/export/home/dave:/bin/bash
yumi:ZEadZ3ZaW4v9.:1377:160::/export/home/yumi:/bin/bash
```
| **Arquivo mestre** | **Mapa(s)**                 | **Notas**                            |
| ------------------ | --------------------------- | ------------------------------------ |
| /etc/hosts         | hosts.byname, hosts.byaddr  | Cont√©m nomes de host e detalhes de IP |
| /etc/passwd        | passwd.byname, passwd.byuid | Arquivo de senha de usu√°rio do NIS    |
| /etc/group         | group.byname, group.bygid   | Arquivo de grupo do NIS               |
| /usr/lib/aliases   | mail.aliases                | Detalhes de aliases de email          |

## Usu√°rios RPC

Se voc√™ encontrar o servi√ßo **rusersd** listado assim:

![](<../.gitbook/assets/image (231).png>)

Voc√™ poder√° enumerar os usu√°rios da m√°quina. Para aprender como, leia [1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md).

## Contornar Porta do Portmapper Filtrada

Se durante uma varredura nmap voc√™ ver portas abertas como NFS, mas a porta 111 estiver filtrada, voc√™ n√£o ser√° capaz de explorar essas portas.\
No entanto, se voc√™ puder simular localmente um servi√ßo de portmapper e tunelar a porta NFS da sua m√°quina para a v√≠tima, voc√™ poder√° usar ferramentas regulares para explorar esses servi√ßos.\
Mais informa√ß√µes em [https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc)

## Shodan

* `Portmap`

## Laborat√≥rios para pr√°tica

* Pratique essas t√©cnicas na [**m√°quina Irked HTB**](https://app.hackthebox.com/machines/Irked).

## Comandos Autom√°ticos HackTricks
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Provides information between Unix based systems. Port is often probed, it can be used to fingerprint the Nix OS, and to obtain information about available services. Port used with NFS, NIS, or any rpc-based service.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios do github** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
