# 111/TCP/UDP - Test de p√©n√©tration Portmapper

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informations de base

Fournit des informations entre les syst√®mes bas√©s sur Unix. Le port est souvent sond√©, il peut √™tre utilis√© pour identifier l'OS Nix et pour obtenir des informations sur les services disponibles. Port utilis√© avec NFS, NIS ou tout service bas√© sur rpc.

**Port par d√©faut :** 111/TCP/UDP, 32771 dans Oracle Solaris
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## √ânum√©ration
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
Parfois, cela ne vous donne aucune information, dans d'autres occasions, vous obtiendrez quelque chose comme ceci:

![](<../.gitbook/assets/image (230).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

Si vous trouvez le service NFS, alors vous pourrez probablement lister et t√©l√©charger (et peut-√™tre t√©l√©verser) des fichiers:

![](<../.gitbook/assets/image (232).png>)

Lisez [2049 - Pentesting NFS service](nfs-service-pentesting.md) pour en savoir plus sur la fa√ßon de tester ce protocole.

## NIS

Si vous trouvez le service `ypbind` en cours d'ex√©cution:

![](<../.gitbook/assets/image (233).png>)

Vous pouvez essayer de l'exploiter. Quoi qu'il en soit, tout d'abord, vous devrez **deviner le "nom de domaine" NIS** de la machine (lorsque NIS est install√©, un "nom de domaine" est configur√©) et **sans conna√Ætre ce nom de domaine, vous ne pouvez rien faire**.

Apr√®s avoir obtenu le nom de domaine NIS pour l'environnement (example.org dans ce cas), utilisez la commande ypwhich pour envoyer une requ√™te au serveur NIS et ypcat pour obtenir du mat√©riel sensible. Vous devriez alimenter les hachages de mots de passe chiffr√©s dans John the Ripper, et une fois craqu√©s, vous pouvez l'utiliser pour √©valuer l'acc√®s et les privil√®ges du syst√®me.
```bash
root@kali:~# apt-get install nis
root@kali:~# ypwhich -d example.org 192.168.10.1
potatohead.example.org
root@kali:~# ypcat ‚Äìd example.org ‚Äìh 192.168.10.1 passwd.byname
tiff:noR7Bk6FdgcZg:218:101::/export/home/tiff:/bin/bash 
katykat:d.K5tGUWCJfQM:2099:102::/export/home/katykat:/bin/bash 
james:i0na7pfgtxi42:332:100::/export/home/james:/bin/tcsh 
florent:nUNzkxYF0Hbmk:199:100::/export/home/florent:/bin/csh 
dave:pzg1026SzQlwc:182:100::/export/home/dave:/bin/bash 
yumi:ZEadZ3ZaW4v9.:1377:160::/export/home/yumi:/bin/bash
```
| **Fichier principal** | **Carte(s)**                 | **Notes**                                            |
| --------------------- | ---------------------------- | ---------------------------------------------------- |
| /etc/hosts            | hosts.byname, hosts.byaddr   | Contient les noms d'h√¥tes et les d√©tails IP           |
| /etc/passwd           | passwd.byname, passwd.byuid  | Fichier de mot de passe utilisateur NIS              |
| /etc/group            | group.byname, group.bygid    | Fichier de groupe NIS                                |
| /usr/lib/aliases      | mail.aliases                 | D√©tails des alias de messagerie                       |

## Utilisateurs RPC

Si vous trouvez le service **rusersd** r√©pertori√© comme ceci :

![](<../.gitbook/assets/image (231).png>)

Vous pouvez √©num√©rer les utilisateurs de la machine. Pour savoir comment faire, lisez [1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md).

## Contourner le port Portmapper filtr√©

Si lors d'un scan nmap vous voyez des ports ouverts comme NFS mais que le port 111 est filtr√©, vous ne pourrez pas exploiter ces ports.\
Mais, si vous pouvez simuler localement un service de portmapper et que vous tunnelisez le port NFS de votre machine vers celle de la victime, vous pourrez utiliser des outils r√©guliers pour exploiter ces services.\
Plus d'informations sur [https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc)

## Shodan

* `Portmap`

## Laboratoires pour s'entra√Æner

* Pratiquez ces techniques sur la machine [**Irked HTB**](https://app.hackthebox.com/machines/Irked).

## Commandes automatiques HackTricks
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
  Name: Notes
  Description: Notes for PortMapper
  Note: |
    Provides information between Unix based systems. Port is often probed, it can be used to fingerprint the Nix OS, and to obtain information about available services. Port used with NFS, NIS, or any rpc-based service.

    https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
  Name: rpc info
  Description: May give netstat-type info
  Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
  Name: nmap
  Description: May give netstat-type info
  Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une entreprise de cybers√©curit√© ? Voulez-vous voir votre entreprise annonc√©e dans HackTricks ? ou voulez-vous avoir acc√®s √† la derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) **groupe Discord** ou le [**groupe telegram**](https://t.me/peass) ou **suivez-moi** sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live).
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
