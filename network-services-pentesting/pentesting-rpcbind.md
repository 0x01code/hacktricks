# 111/TCP/UDP - Test de p√©n√©tration Portmapper

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informations de base

Fournit des informations entre syst√®mes bas√©s sur Unix. Le port est souvent sond√©, il peut √™tre utilis√© pour identifier le syst√®me d'exploitation Nix, et pour obtenir des informations sur les services disponibles. Port utilis√© avec NFS, NIS, ou tout service bas√© sur rpc.

**Port par d√©faut :** 111/TCP/UDP, 32771 dans Oracle Solaris
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## √ânum√©ration
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
Parfois, cela ne vous donne aucune information, mais dans d'autres cas, vous pourriez obtenir quelque chose comme ceci :

![](<../.gitbook/assets/image (230).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

Si vous trouvez le service NFS, il est probable que vous pourrez lister et t√©l√©charger (et peut-√™tre t√©l√©verser) des fichiers :

![](<../.gitbook/assets/image (232).png>)

Lisez [2049 - Pentesting NFS service](nfs-service-pentesting.md) pour en savoir plus sur comment tester ce protocole.

## NIS

Si vous trouvez le service `ypbind` en cours d'ex√©cution :

![](<../.gitbook/assets/image (233).png>)

Vous pouvez essayer de l'exploiter. Cependant, avant tout, vous **devrez deviner le "nom de domaine" NIS** de la machine (lorsque NIS est install√©, un "nom de domaine" est configur√©) et **sans conna√Ætre ce nom de domaine, vous ne pouvez rien faire**.

Apr√®s avoir obtenu le nom de domaine NIS pour l'environnement (example.org dans ce cas), utilisez la commande ypwhich pour interroger le serveur NIS et ypcat pour obtenir du mat√©riel sensible. Vous devriez introduire les hachages de mots de passe chiffr√©s dans John the Ripper, et une fois d√©chiffr√©s, vous pouvez les utiliser pour √©valuer l'acc√®s au syst√®me et les privil√®ges.
```bash
root@kali:~# apt-get install nis
root@kali:~# ypwhich -d example.org 192.168.10.1
potatohead.example.org
root@kali:~# ypcat ‚Äìd example.org ‚Äìh 192.168.10.1 passwd.byname
tiff:noR7Bk6FdgcZg:218:101::/export/home/tiff:/bin/bash
katykat:d.K5tGUWCJfQM:2099:102::/export/home/katykat:/bin/bash
james:i0na7pfgtxi42:332:100::/export/home/james:/bin/tcsh
florent:nUNzkxYF0Hbmk:199:100::/export/home/florent:/bin/csh
dave:pzg1026SzQlwc:182:100::/export/home/dave:/bin/bash
yumi:ZEadZ3ZaW4v9.:1377:160::/export/home/yumi:/bin/bash
```
| **Fichier ma√Ætre** | **Carte(s)**                | **Notes**                            |
| ------------------ | --------------------------- | ------------------------------------ |
| /etc/hosts         | hosts.byname, hosts.byaddr  | Contient les noms d'h√¥te et les d√©tails IP |
| /etc/passwd        | passwd.byname, passwd.byuid | Fichier de mot de passe utilisateur NIS     |
| /etc/group         | group.byname, group.bygid   | Fichier de groupe NIS                       |
| /usr/lib/aliases   | mail.aliases                | D√©tails des alias de messagerie             |

## Utilisateurs RPC

Si vous trouvez le service **rusersd** list√© comme ceci :

![](<../.gitbook/assets/image (231).png>)

Vous pourriez √©num√©rer les utilisateurs de la machine. Pour apprendre comment, lisez [1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md).

## Contourner le port Portmapper filtr√©

Si lors d'un scan nmap vous voyez des ports ouverts comme NFS mais que le port 111 est filtr√©, vous ne pourrez pas exploiter ces ports.\
Cependant, si vous pouvez simuler localement un service portmapper et que vous tunnelisez le port NFS de votre machine √† celle de la victime, vous pourrez utiliser les outils habituels pour exploiter ces services.\
Plus d'informations sur [https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc)

## Shodan

* `Portmap`

## Laboratoires pour pratiquer

* Pratiquez ces techniques dans la [**machine Irked HTB**](https://app.hackthebox.com/machines/Irked).

## Commandes Automatiques HackTricks
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Provides information between Unix based systems. Port is often probed, it can be used to fingerprint the Nix OS, and to obtain information about available services. Port used with NFS, NIS, or any rpc-based service.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez**-moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
