# 111/TCP/UDP - Kupima Portmapper

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## Taarifa Msingi

**Portmapper** ni huduma inayotumiwa kwa kufanya ramani ya bandari za huduma za mtandao kwa nambari za programu za **RPC** (Remote Procedure Call). Inafanya kazi kama sehemu muhimu katika **mifumo inayotumia Unix**, ikirahisisha kubadilishana taarifa kati ya mifumo hii. **Bandari** inayohusishwa na **Portmapper** mara nyingi huchunguzwa na wadukuzi kwani inaweza kufunua taarifa muhimu. Taarifa hizi ni pamoja na aina ya **Mfumo wa Uendeshaji wa Unix (OS)** unaotumika na maelezo kuhusu huduma zilizopo kwenye mfumo. Aidha, **Portmapper** mara nyingi hutumiwa pamoja na **NFS (Network File System)**, **NIS (Network Information Service)**, na huduma zingine za msingi wa **RPC** kusimamia huduma za mtandao kwa ufanisi.

**Bandari ya chaguo:** 111/TCP/UDP, 32771 kwenye Oracle Solaris
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## Uchambuzi
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
### Shodan

* `port:111 portmap`

## RPCBind + NFS

Ikiwa utapata huduma ya NFS basi labda utaweza kupata orodha na kupakua (na labda kupakia) faili:

![](<../.gitbook/assets/image (869).png>)

Soma [2049 - Pentesting NFS service](nfs-service-pentesting.md) kujifunza zaidi kuhusu jinsi ya kufanya majaribio ya itifaki hii.

## NIS

Kuchunguza udhaifu wa **NIS** kunahusisha mchakato wa hatua mbili, ukiwaanza na kutambua huduma ya `ypbind`. Msingi wa uchunguzi huu ni kugundua **jina la kikoa cha NIS**, bila ambayo maendeleo hukwama.

![](<../.gitbook/assets/image (856).png>)

Safari ya uchunguzi inaanza na usakinishaji wa pakiti muhimu (`apt-get install nis`). Hatua inayofuata inahitaji kutumia `ypwhich` kuthibitisha uwepo wa seva ya NIS kwa kuitikia kwa jina la kikoa na anwani ya seva, kuhakikisha vipengele hivi vimefichwa kwa usalama.

Hatua ya mwisho na muhimu inahusisha amri ya `ypcat` kutoa data nyeti, hasa nywila za watumiaji zilizofichwa. Vipande hivi, mara baada ya kuvunjwa kwa kutumia zana kama **John the Ripper**, hufunua ufahamu kuhusu ufikiaji wa mfumo na mamlaka.
```bash
# Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d <domain-name> <server-ip>
# Extract user credentials
ypcat ‚Äìd <domain-name> ‚Äìh <server-ip> passwd.byname
```
### Faili za NIF

| **Faili Kuu**    | **Ramani**                  | **Maelezo**                         |
| ---------------- | --------------------------- | --------------------------------- |
| /etc/hosts       | hosts.byname, hosts.byaddr  | Ina jina la mwenyeji na maelezo ya IP |
| /etc/passwd      | passwd.byname, passwd.byuid | Faili ya nenosiri la mtumiaji wa NIS            |
| /etc/group       | group.byname, group.bygid   | Faili ya kikundi cha NIS                    |
| /usr/lib/aliases | mail.aliases                | Maelezo ya anwani za barua pepe              |

## Watumiaji wa RPC

Ikiwa unapata huduma ya **rusersd** ikiwa imeorodheshwa kama hii:

![](<../.gitbook/assets/image (1038).png>)

Unaweza kuchunguza watumiaji wa sanduku. Ili kujifunza jinsi ya kufanya hivyo soma [1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md).

## Kupita Kizuizi cha Bandari ya Portmapper

Unapofanya **uchunguzi wa nmap** na kugundua bandari za NFS zilizofunguliwa na bandari 111 ikiwa imezuiwa, utekelezaji moja kwa moja wa bandari hizi hauwezekani. Walakini, kwa **kujenga huduma ya portmapper kwa njia ya kielelezo kwenye mashine yako** na kuanzisha handaki kutoka kwenye mashine yako kwenda kwenye lengo, utekelezaji unawezekana kwa kutumia zana za kawaida. Mbinu hii inaruhusu kupita hali iliyozuiwa ya bandari 111, hivyo kuruhusu ufikiaji wa huduma za NFS. Kwa mwongozo wa kina kuhusu mbinu hii, tazama makala inayopatikana kwa [kiungo hiki](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc).

## Shodan

* `Portmap`

## Maabara za Mazoezi

* Fanyia mazoezi mbinu hizi kwenye [**Mashine ya HTB ya Irked**](https://app.hackthebox.com/machines/Irked).

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Amri za Kiotomatiki za HackTricks
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kuhack kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
