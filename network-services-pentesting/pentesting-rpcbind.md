# 111/TCP/UDP - Pentesting Portmapper

<details>

<summary><strong>AWS hacklemeyi sıfırdan kahramana öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**]'na göz atın (https://github.com/sponsors/carlospolop)!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**'da takip edin.**
* **Hacking püf noktalarınızı paylaşarak PR'lar göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## Temel Bilgiler

**Portmapper**, ağ hizmeti bağlantı noktalarını **RPC** (Uzak Prosedür Çağrısı) program numaralarına eşlemede kullanılan bir hizmettir. Bu, **Unix tabanlı sistemlerde** bilgi alışverişini kolaylaştıran kritik bir bileşen olarak işlev görür. **Portmapper** ile ilişkilendirilen **port**, değerli bilgileri ortaya çıkarabileceği için sık ​​sık saldırganlar tarafından taranır. Bu bilgiler, çalışmakta olan **Unix İşletim Sistemi (OS)** türünü ve sistemde mevcut olan hizmetler hakkında detayları içerir. Ayrıca, **Portmapper** genellikle **NFS (Ağ Dosya Sistemi)**, **NIS (Ağ Bilgi Servisi)** ve diğer **RPC tabanlı hizmetler** ile birlikte kullanılarak ağ hizmetlerini etkili bir şekilde yönetmek için kullanılır.

**Varsayılan port:** 111/TCP/UDP, Oracle Solaris'te 32771
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## Numaralandırma
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
### RPCBind + NFS

Eğer NFS servisini bulursanız, muhtemelen dosyaları listeleme ve indirme (ve belki yükleme) yeteneğine sahip olacaksınız:

![](<../.gitbook/assets/image (869).png>)

[NFS servisini pentest etme](nfs-service-pentesting.md) hakkında daha fazla bilgi edinmek için okuyun.

## NIS

**NIS** zafiyetlerini keşfetmek, `ypbind` servisinin tanımlanmasıyla başlayan iki adımlı bir süreci içerir. Bu keşif sürecinin temel noktası, **NIS alan adının** ortaya çıkarılmasıdır; aksi takdirde ilerleme durur.

![](<../.gitbook/assets/image (856).png>)

Keşif yolculuğu, gerekli paketlerin kurulumuyla başlar (`apt-get install nis`). Ardışık adım, güvenlik için bu unsurların anonimleştirilmesiyle NIS sunucusunun varlığını doğrulamak için alan adı ve sunucu IP'sini kullanarak ona ping atarak `ypwhich` kullanmaktır.

Son ve kritik adım, hassas verileri çıkarmak için `ypcat` komutunu kullanmaktır, özellikle şifrelenmiş kullanıcı parolaları. Bu hash'ler, **John the Ripper** gibi araçlar kullanılarak kırıldığında, sistem erişimi ve ayrıcalıkları hakkında içgörüler sunar.
```bash
# Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d <domain-name> <server-ip>
# Extract user credentials
ypcat –d <domain-name> –h <server-ip> passwd.byname
```
### NIF dosyaları

| **Ana dosya**  | **Harita(lar)**                  | **Notlar**                         |
| ---------------- | --------------------------- | --------------------------------- |
| /etc/hosts       | hosts.byname, hosts.byaddr  | Host adlarını ve IP ayrıntılarını içerir |
| /etc/passwd      | passwd.byname, passwd.byuid | NIS kullanıcı şifre dosyası            |
| /etc/group       | group.byname, group.bygid   | NIS grup dosyası                    |
| /usr/lib/aliases | mail.aliases                | Posta takma adları ayrıntıları              |

## RPC Kullanıcıları

Eğer **rusersd** servisini şu şekilde listelenmiş bulursanız:

![](<../.gitbook/assets/image (1038).png>)

Kutunun kullanıcılarını numaralandırabilirsiniz. Nasıl yapılacağını öğrenmek için [1026 - Rsusersd Pentesting](1026-pentesting-rusersd.md) makalesine bakın.

## Filtrelenmiş Portmapper portunu atlatma

Bir **nmap taraması** yaparken ve port 111'in filtreli olduğunu keşfettiğinizde, bu portların doğrudan istismarı mümkün değildir. Ancak, **yerel olarak bir portmapper servisi simüle ederek ve makinenizden hedefe bir tünel oluşturarak**, standart araçlar kullanarak istismar mümkün hale gelir. Bu teknik, port 111'in filtreli durumunu atlamayı sağlar, böylece NFS hizmetlerine erişim sağlanabilir. Bu yöntem hakkında detaylı rehberlik için [bu bağlantıdaki](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc) makaleye başvurun.

## Shodan

* `Portmap`

## Uygulama Labları

* Bu teknikleri [**Irked HTB makinesinde**](https://app.hackthebox.com/machines/Irked) uygulayın.

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## HackTricks Otomatik Komutları
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><strong>Sıfırdan kahramana kadar AWS hacklemeyi öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı paylaşarak PR göndererek HackTricks** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına.

</details>
