# 111/TCP/UDP - Ελεγκτής Εισροής Επιθέσεων (Pentesting Portmapper)

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι υποστήριξης του HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

## Βασικές Πληροφορίες

Ο **Ελεγκτής Εισροής Επιθέσεων (Portmapper)** είναι ένας υπηρεσία που χρησιμοποιείται για την αντιστοίχιση των θυρών των υπηρεσιών δικτύου σε αριθμούς προγραμμάτων **RPC (Remote Procedure Call)**. Λειτουργεί ως ένα κρίσιμο συστατικό στα **συστήματα βασισμένα σε Unix**, διευκολύνοντας την ανταλλαγή πληροφοριών μεταξύ αυτών των συστημάτων. Η **θύρα** που συσχετίζεται με τον **Ελεγκτή Εισροής Επιθέσεων** συχνά σαρώνεται από επιτιθέμενους καθώς μπορεί να αποκαλύψει πολύτιμες πληροφορίες. Αυτές οι πληροφορίες περιλαμβάνουν τον τύπο του λειτουργικού συστήματος **Unix (OS)** που εκτελείται και λεπτομέρειες για τις υπηρεσίες που είναι διαθέσιμες στο σύστημα. Επιπλέον, ο **Ελεγκτής Εισροής Επιθέσεων** χρησιμοποιείται συχνά σε συνδυασμό με το **NFS (Network File System)**, το **NIS (Network Information Service)** και άλλες **υπηρεσίες βασισμένες σε RPC** για την αποτελεσματική διαχείριση των υπηρεσιών δικτύου.

**Προεπιλεγμένη θύρα:** 111/TCP/UDP, 32771 στο Oracle Solaris
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## Απαρίθμηση

Η απαρίθμηση είναι η διαδικασία εντοπισμού και συλλογής πληροφοριών για το σύστημα που εξετάζεται. Αυτή η διαδικασία είναι σημαντική για την κατανόηση του συστήματος και των δυνητικών ευπαθειών του. Κατά τη διάρκεια της απαρίθμησης, μπορούν να χρησιμοποιηθούν διάφορες τεχνικές για την εξαγωγή πληροφοριών, όπως η σάρωση θυρών, η ανάλυση πρωτοκόλλων και η ανίχνευση υπηρεσιών.

Οι υπηρεσίες RPC (Remote Procedure Call) είναι ένα πρωτόκολλο που επιτρέπει σε έναν υπολογιστή να καλεί διαδικασίες σε άλλους υπολογιστές σε απομακρυσμένα δίκτυα. Οι υπηρεσίες αυτές μπορούν να είναι ευάλωτες σε επιθέσεις, επομένως είναι σημαντικό να εξετάζονται κατά τη διάρκεια της απαρίθμησης.

Για να εντοπιστούν οι υπηρεσίες RPC, μπορούν να χρησιμοποιηθούν εργαλεία όπως το `rpcinfo` και το `showmount`. Αυτά τα εργαλεία μπορούν να ανακαλύψουν τις υπηρεσίες RPC που εκτελούνται σε έναν συγκεκριμένο υπολογιστή και να επιστρέψουν πληροφορίες σχετικά με αυτές.

Μετά την εντοπισμό των υπηρεσιών RPC, μπορούν να γίνουν περαιτέρω ερευνητικές εργασίες για τον εντοπισμό πιθανών ευπαθειών και εκμεταλλεύσιμων κενών ασφαλείας. Αυτό μπορεί να περιλαμβάνει την ανάλυση των πρωτοκόλλων που χρησιμοποιούνται από τις υπηρεσίες RPC και την εκτέλεση επιθέσεων όπως η επίθεση buffer overflow.
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
Μερικές φορές δεν σας δίνει καμία πληροφορία, σε άλλες περιπτώσεις θα λάβετε κάτι τέτοιο:

![](<../.gitbook/assets/image (230).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

Εάν βρείτε την υπηρεσία NFS, τότε πιθανώς θα μπορείτε να καταλογογραφήσετε και να κατεβάσετε (και ίσως να ανεβάσετε) αρχεία:

![](<../.gitbook/assets/image (232).png>)

Διαβάστε [2049 - Ελέγχος ασφάλειας της υπηρεσίας NFS](nfs-service-pentesting.md) για να μάθετε περισσότερα σχετικά με το πώς να δοκιμάσετε αυτό το πρωτόκολλο.

## NIS

Η εξερεύνηση των ευπαθειών του **NIS** περιλαμβάνει ένα διαδικασία δύο βημάτων, ξεκινώντας με τον εντοπισμό της υπηρεσίας `ypbind`. Ο πυρήνας αυτής της εξερεύνησης είναι η αποκάλυψη του **ονόματος του τομέα NIS**, χωρίς το οποίο η πρόοδος σταματά.

![](<../.gitbook/assets/image (233).png>)

Το ταξίδι εξερεύνησης ξεκινά με την εγκατάσταση των απαραίτητων πακέτων (`apt-get install nis`). Το επόμενο βήμα απαιτεί τη χρήση της εντολής `ypwhich` για να επιβεβαιώσετε την παρουσία του διακομιστή NIS προσπελαύνοντάς τον με το όνομα τομέα και τη διεύθυνση IP του διακομιστή, εξασφαλίζοντας ότι αυτά τα στοιχεία είναι ανωνυμοποιημένα για λόγους ασφαλείας.

Το τελικό και κρίσιμο βήμα περιλαμβάνει την εντολή `ypcat` για την εξαγωγή ευαίσθητων δεδομένων, ιδιαίτερα κρυπτογραφημένων κωδικών πρόσβασης χρηστών. Αυτά τα hashes, αφού αποκρυπτογραφηθούν χρησιμοποιώντας εργαλεία όπως το **John the Ripper**, αποκαλύπτουν πληροφορίες σχετικά με την πρόσβαση και τα προνόμια του συστήματος.
```bash
# Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d <domain-name> <server-ip>
# Extract user credentials
ypcat –d <domain-name> –h <server-ip> passwd.byname
```
### Αρχεία NIF

| **Αρχείο Master** | **Χάρτης(ες)**             | **Σημειώσεις**                          |
| ---------------- | --------------------------- | ---------------------------------------- |
| /etc/hosts       | hosts.byname, hosts.byaddr  | Περιέχει τα ονόματα των κεντρικών υπολογιστών και τις λεπτομέρειες των IP |
| /etc/passwd      | passwd.byname, passwd.byuid | Αρχείο κωδικών χρηστών NIS               |
| /etc/group       | group.byname, group.bygid   | Αρχείο ομάδων NIS                        |
| /usr/lib/aliases | mail.aliases                | Λεπτομέρειες για τις αντιστοιχίες των email |

## Χρήστες RPC

Εάν βρείτε την υπηρεσία **rusersd** που εμφανίζεται ως εξής:

![](<../.gitbook/assets/image (231).png>)

Μπορείτε να απαριθμήσετε τους χρήστες του συστήματος. Για να μάθετε πώς να το κάνετε, διαβάστε το [1026 - Ελέγχος ασφάλειας Rsusersd](1026-pentesting-rusersd.md).

## Παράκαμψη φίλτρου στη θύρα Portmapper

Όταν πραγματοποιείτε ένα **σάρωση nmap** και ανακαλύπτετε ανοιχτές θύρες NFS με τη θύρα 111 να είναι φιλτραρισμένη, η άμεση εκμετάλλευση αυτών των θυρών δεν είναι εφικτή. Ωστόσο, με το **προσομοιωτή της υπηρεσίας portmapper τοπικά και τη δημιουργία ενός τούνελ από τον υπολογιστή σας** προς τον στόχο, η εκμετάλλευση γίνεται δυνατή χρησιμοποιώντας τα κανονικά εργαλεία. Αυτή η τεχνική επιτρέπει την παράκαμψη της φιλτραρισμένης κατάστασης της θύρας 111, επιτρέποντας έτσι την πρόσβαση στις υπηρεσίες NFS. Για λεπτομερείς οδηγίες για αυτήν τη μέθοδο, ανατρέξτε στο άρθρο που είναι διαθέσιμο στον ακόλουθο σύνδεσμο: [αυτός ο σύνδεσμος](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc).


## Shodan

* `Portmap`

## Εργαστήρια για εξάσκηση

* Εξασκηθείτε σε αυτές τις τεχνικές στη μηχανή [**Irked HTB**](https://app.hackthebox.com/machines/Irked).

## Αυτόματες εντολές HackTricks
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
