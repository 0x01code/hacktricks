# 111/TCP/UDP - рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдкреЛрд░реНрдЯрдореИрдкрд░

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

**рдкреЛрд░реНрдЯрдореИрдкрд░** рдПрдХ рд╕реЗрд╡рд╛ рд╣реИ рдЬреЛ **RPC** (Remote Procedure Call) рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛ рдкреЛрд░реНрдЯреЛрдВ рд╕реЗ рдореИрдкрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ **Unix рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдореЛрдВ** рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдШрдЯрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЗрди рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рдмреАрдЪ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рддрд╛ рд╣реИред **рдкреЛрд░реНрдЯрдореИрдкрд░** рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд **рдкреЛрд░реНрдЯ** рдХреЛ рд╣рдореЗрд╢рд╛ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕реНрдХреИрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдореВрд▓реНрдпрд╡рд╛рди рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рдХрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдореЗрдВ **Unix рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо (OS)** рдХреЗ рдкреНрд░рдХрд╛рд░ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЙрдкрд▓рдмреНрдз рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╡рд┐рд╡рд░рдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, **рдкреЛрд░реНрдЯрдореИрдкрд░** рдХреЛ рд╕рд╛рдорд╛рдиреНрдпрдд: **NFS (Network File System)**, **NIS (Network Information Service)**, рдФрд░ рдЕрдиреНрдп **RPC-рдЖрдзрд╛рд░рд┐рдд рд╕реЗрд╡рд╛рдУрдВ** рдХреЗ рд╕рд╛рде рд╕рд╛рдорд╛рдиреНрдпрдд: рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 111/TCP/UDP, 32771 рдУрд░реЗрдХрд▓ рд╕реЛрд▓рд░рд┐рд╕ рдореЗрдВ
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## рдЬрд╛рдВрдЪ
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
### Shodan

* `port:111 portmap`

## RPCBind + NFS

рдпрджрд┐ рдЖрдк рд╕реЗрд╡рд╛ NFS рдкрд╛рддреЗ рд╣реИрдВ рддреЛ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЖрдк рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕реВрдЪреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдФрд░ рд╢рд╛рдпрдж рдЕрдкрд▓реЛрдб рднреА):

![](<../.gitbook/assets/image (232).png>)

Read[ 2049 - Pentesting NFS service](nfs-service-pentesting.md) рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдПред

## NIS

**NIS** рдХреА рд╡рдВрд╢рд╛рд╡рд▓реА рдХреА рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖реЛрдВ рдХреА рдЦреЛрдЬ рдПрдХ рджреЛ-рд╕реНрдЯреЗрдк рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬрд┐рд╕рдХреА рд╢реБрд░реБрдЖрдд рд╕реЗрд╡рд╛ `ypbind` рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд╕рд╛рде рд╣реЛрддреА рд╣реИред рдЗрд╕ рдЦреЛрдЬ рдХрд╛ рдореВрд▓ рдЖрдзрд╛рд░ **NIS рдбреЛрдореЗрди рдирд╛рдо** рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд┐рдирд╛ рдкреНрд░рдЧрддрд┐ рд░реБрдХ рдЬрд╛рддреА рд╣реИред

![](<../.gitbook/assets/image (233).png>)

рдЦреЛрдЬ рдХреА рдпрд╛рддреНрд░рд╛ рдЙрди рдЖрд╡рд╢реНрдпрдХ рдкреИрдХреЗрдЬреЛрдВ рдХреА рд╕реНрдерд╛рдкрдирд╛ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ (`apt-get install nis`)ред рдЕрдЧрд▓рд╛ рдХрджрдо `ypwhich` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдбреЛрдореЗрди рдирд╛рдо рдФрд░ рд╕рд░реНрд╡рд░ рдЖрдИрдкреА рдХреЗ рд╕рд╛рде рдЗрд╕реЗ рдкрд┐рдВрдЧ рдХрд░рдХреЗ NIS рд╕рд░реНрд╡рд░ рдХреА рдореМрдЬреВрджрдЧреА рдХреА рдкреБрд╖реНрдЯрд┐ рдХреА рдЬрд╛ рд╕рдХреЗ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдпреЗ рддрддреНрд╡ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдЕрдирд╛рдорд┐рдд рд╣реИрдВред

рдЕрдВрддрд┐рдо рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрджрдо рдореЗрдВ `ypcat` рдХрдорд╛рдВрдб рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдирд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╛рд╕рд╡рд░реНрдбред рдпреЗ рд╣реИрд╢, рдЬреЛ рдЙрдкрдХрд░рдг рдЬреИрд╕реЗ **John the Ripper** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреНрд░реИрдХ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рд╕рд┐рд╕реНрдЯрдо рдПрдХреНрд╕реЗрд╕ рдФрд░ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдВрджрд░реВрдиреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рдХрдЯ рдХрд░рддреЗ рд╣реИрдВред
```bash
# Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d <domain-name> <server-ip>
# Extract user credentials
ypcat тАУd <domain-name> тАУh <server-ip> passwd.byname
```
### NIF рдлрд╝рд╛рдЗрд▓реЗрдВ

| **рдорд╛рд╕реНрдЯрд░ рдлрд╝рд╛рдЗрд▓** | **рдорд╛рдирдЪрд┐рддреНрд░(рдПрд╕)** | **рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдБ** |
| ---------------- | --------------------------- | --------------------------------- |
| /etc/hosts       | hosts.byname, hosts.byaddr  | рд╣реЛрд╕реНрдЯрдиреЗрдо рдФрд░ рдЖрдИрдкреА рд╡рд┐рд╡рд░рдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВ |
| /etc/passwd      | passwd.byname, passwd.byuid | NIS рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдлрд╝рд╛рдЗрд▓ |
| /etc/group       | group.byname, group.bygid   | NIS рд╕рдореВрд╣ рдлрд╝рд╛рдЗрд▓ |
| /usr/lib/aliases | mail.aliases                | рд╡рд┐рд╡рд░рдг рдореЗрд▓ рдЙрдкрдирд╛рдо |

## RPC рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛

рдпрджрд┐ рдЖрдкрдХреЛ **rusersd** рд╕реЗрд╡рд╛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╕реВрдЪреАрдд рджрд┐рдЦрд╛рдИ рджреЗрддреА рд╣реИ:

![](<../.gitbook/assets/image (231).png>)

рддреЛ рдЖрдк рдмреЙрдХреНрд╕ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md) рдкрдврд╝реЗрдВред

## рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдкреЛрд░реНрдЯрдореИрдкрд░ рдкреЛрд░реНрдЯ рдХреЛ рдЫреЛрдбрд╝реЗрдВ

**nmap рд╕реНрдХреИрди** рдХрд░рддреЗ рд╕рдордп рдЦреБрд▓реЗ NFS рдкреЛрд░реНрдЯреНрд╕ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдкрд░ рдкреЛрд░реНрдЯ 111 рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрди рдкреЛрд░реНрдЯреНрд╕ рдХрд╛ рд╕реАрдзрд╛ рд╢реЛрд╖рдг рд╕рдВрднрд╛рд╡рдирд╛рд╢реАрд▓ рдирд╣реАрдВ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, **рдЕрдкрдиреА рдорд╢реАрди рдкрд░ рдПрдХ рдкреЛрд░реНрдЯрдореИрдкрд░ рд╕реЗрд╡рд╛ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рддреЗ рд╣реБрдП рдФрд░ рдЕрдкрдиреА рдорд╢реАрди рд╕реЗ рд▓рдХреНрд╖реНрдп рддрдХ рдПрдХ рдЯрдирд▓ рдмрдирд╛рддреЗ рд╣реБрдП**, рдорд╛рдирдХ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╢реЛрд╖рдг рд╕рдВрднрд╡ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рддрдХрдиреАрдХ рдкреЛрд░реНрдЯ 111 рдХреА рдлрд╝рд┐рд▓реНрдЯрд░ рдХреА рдЧрдИ рд╕реНрдерд┐рддрд┐ рдХреЛ рдЫреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ NFS рд╕реЗрд╡рд╛рдУрдВ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛрддреА рд╣реИред рдЗрд╕ рд╡рд┐рдзрд┐ рдкрд░ рд╡рд┐рд╕реНрддреГрдд рдорд╛рд░реНрдЧрджрд░реНрд╢рди рдХреЗ рд▓рд┐рдП, [рдЗрд╕ рд▓рд┐рдВрдХ](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc) рдкрд░ рдЙрдкрд▓рдмреНрдз рд▓реЗрдЦ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрдВред

## рд╢реЛрдбрди

* `Portmap`

## рдЕрднреНрдпрд╛рд╕ рдХреЗ рд▓рд┐рдП рд▓реИрдмреНрд╕

* рдЗрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЕрднреНрдпрд╛рд╕ [**Irked HTB рдорд╢реАрди**](https://app.hackthebox.com/machines/Irked) рдореЗрдВ рдХрд░реЗрдВред

## HackTricks рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрдорд╛рдВрдб
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ **The PEASS Family** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
