# 111/TCP/UDP - Test di penetrazione Portmapper

<details>

<summary><strong>Impara l'hacking AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**Gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos di github.

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## Informazioni di Base

**Portmapper** √® un servizio utilizzato per mappare le porte dei servizi di rete ai numeri di programma **RPC** (Remote Procedure Call). Agisce come componente critico nei **sistemi basati su Unix**, facilitando lo scambio di informazioni tra questi sistemi. La **porta** associata a **Portmapper** viene frequentemente esaminata dagli attaccanti in quanto pu√≤ rivelare informazioni preziose. Queste informazioni includono il tipo di **Sistema Operativo Unix (OS)** in esecuzione e dettagli sui servizi disponibili nel sistema. Inoltre, **Portmapper** √® comunemente utilizzato insieme a **NFS (Network File System)**, **NIS (Network Information Service)** e altri **servizi basati su RPC** per gestire efficacemente i servizi di rete.

**Porta predefinita:** 111/TCP/UDP, 32771 in Oracle Solaris
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## Enumerazione
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
A volte non ti fornisce alcuna informazione, in altre occasioni otterrai qualcosa del genere:

![](<../.gitbook/assets/image (550).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

Se trovi il servizio NFS, probabilmente sarai in grado di elencare e scaricare (e forse caricare) file:

![](<../.gitbook/assets/image (869).png>)

Leggi [2049 - Pentesting servizio NFS](nfs-service-pentesting.md) per saperne di pi√π su come testare questo protocollo.

## NIS

Esplorare le vulnerabilit√† di **NIS** coinvolge un processo in due fasi, iniziando con l'identificazione del servizio `ypbind`. La pietra angolare di questa esplorazione √® scoprire il **nome di dominio NIS**, senza il quale il progresso viene interrotto.

![](<../.gitbook/assets/image (856).png>)

Il viaggio di esplorazione inizia con l'installazione dei pacchetti necessari (`apt-get install nis`). Il passaggio successivo richiede l'uso di `ypwhich` per confermare la presenza del server NIS pinging con il nome di dominio e l'IP del server, assicurandosi che questi elementi siano anonimizzati per motivi di sicurezza.

Il passaggio finale e cruciale coinvolge il comando `ypcat` per estrarre dati sensibili, in particolare password utente crittografate. Questi hash, una volta decifrati utilizzando strumenti come **John the Ripper**, rivelano informazioni sull'accesso al sistema e i privilegi.
```bash
# Install NIS tools
apt-get install nis
# Ping the NIS server to confirm its presence
ypwhich -d <domain-name> <server-ip>
# Extract user credentials
ypcat ‚Äìd <domain-name> ‚Äìh <server-ip> passwd.byname
```
### File NIF

| **File principale** | **Mappa(e)**                 | **Note**                            |
| ------------------- | ---------------------------- | ----------------------------------- |
| /etc/hosts          | hosts.byname, hosts.byaddr   | Contiene nomi host e dettagli IP    |
| /etc/passwd         | passwd.byname, passwd.byuid  | File password utente NIS            |
| /etc/group          | group.byname, group.bygid    | File gruppo NIS                     |
| /usr/lib/aliases    | mail.aliases                 | Dettagli alias mail                 |

## Utenti RPC

Se trovi il servizio **rusersd** elencato in questo modo:

![](<../.gitbook/assets/image (1038).png>)

Potresti enumerare gli utenti della macchina. Per saperne di pi√π, leggi [1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md).

## Bypass Porta Portmapper filtrata

Durante la scansione **nmap** e la scoperta di porte NFS aperte con la porta 111 filtrata, l'exploitation diretta di queste porte non √® fattibile. Tuttavia, **simulando un servizio portmapper in locale e creando un tunnel dalla tua macchina** al target, diventa possibile sfruttare questi strumenti standard. Questa tecnica consente di aggirare lo stato filtrato della porta 111, consentendo cos√¨ l'accesso ai servizi NFS. Per una guida dettagliata su questo metodo, consulta l'articolo disponibile a [questo link](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc).

## Shodan

* `Portmap`

## Laboratori per praticare

* Pratica queste tecniche sulla [**macchina HTB Irked**](https://app.hackthebox.com/machines/Irked).

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Comandi Automatici di HackTricks
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Portmapper is a service that is utilized for mapping network service ports to RPC (Remote Procedure Call) program numbers. It acts as a critical component in Unix-based systems, facilitating the exchange of information between these systems. The port associated with Portmapper is frequently scanned by attackers as it can reveal valuable information. This information includes the type of Unix Operating System (OS) running and details about the services that are available on the system. Additionally, Portmapper is commonly used in conjunction with NFS (Network File System), NIS (Network Information Service), and other RPC-based services to manage network services effectively.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><strong>Impara l'hacking AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se desideri vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos di github.

</details>
