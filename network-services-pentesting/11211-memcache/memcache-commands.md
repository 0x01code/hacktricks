# Amri za Memcache

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa kwenye HackTricks** au **kupakua HackTricks kwa muundo wa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PR kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## Orodha ya Amri za Haraka

**Kutoka** [**https://lzone.de/cheat-sheet/memcached**](https://lzone.de/cheat-sheet/memcached)

Amri zinazoungwa mkono (zile rasmi na zingine zisizo rasmi) zimeandikwa katika hati ya [doc/protocol.txt](https://github.com/memcached/memcached/blob/master/doc/protocol.txt).

Kwa bahati mbaya, maelezo ya sintaksia sio wazi sana na amri rahisi ya msaada inayoorodhesha amri zilizopo ingekuwa bora zaidi. Hapa kuna muhtasari wa amri unazoweza kupata kwenye [chanzo](https://github.com/memcached/memcached) (kufikia 19.08.2016):

| Amri                  | Maelezo                                                         | Mfano                                                                                                                                                                                                                                       |
| --------------------- | --------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| get                   | Soma thamani                                                     | `get mykey`                                                                                                                                                                                                                                 |
| set                   | Weka ufunguo bila masharti                                       | <p><code>set mykey &#x3C;flags> &#x3C;ttl> &#x3C;size></code><br><br>&#x3C;p>Hakikisha kutumia \r\n kama mabadiliko ya mstari unapotumia zana za Unix CLI. Kwa mfano&#x3C;/p> <code>printf "set mykey 0 60 4\r\ndata\r\n" | nc localhost 11211</code></p> |
| add                   | Ongeza ufunguo mpya                                              | `add newkey 0 60 5`                                                                                                                                                                                                                         |
| replace               | Badilisha ufunguo uliopo                                        | `replace key 0 60 5`                                                                                                                                                                                                                        |
| append                | Ongeza data kwenye ufunguo uliopo                                | `append key 0 60 15`                                                                                                                                                                                                                        |
| prepend               | Ongeza data kabla ya ufunguo uliopo                              | `prepend key 0 60 15`                                                                                                                                                                                                                       |
| incr                  | Ongeza thamani ya ufunguo wa nambari kwa idadi iliyopewa          | `incr mykey 2`                                                                                                                                                                                                                              |
| decr                  | Punguza thamani ya ufunguo wa nambari kwa idadi iliyopewa         | `decr mykey 5`                                                                                                                                                                                                                              |
| delete                | Futa ufunguo uliopo                                              | `delete mykey`                                                                                                                                                                                                                              |
| flush\_all            | Batilisha vitu vyote mara moja                                   | `flush_all`                                                                                                                                                                                                                                 |
| flush\_all            | Batilisha vitu vyote baada ya n sekunde                          | `flush_all 900`                                                                                                                                                                                                                             |
| stats                 | Chapisha takwimu za jumla                                        | `stats`                                                                                                                                                                                                                                     |
|                       | Chapisha takwimu za kumbukumbu                                   | `stats slabs`                                                                                                                                                                                                                               |
|                       | Chapisha takwimu za ugawaji wa kiwango cha juu                    | `stats malloc`                                                                                                                                                                                                                              |
|                       | Chapisha habari kuhusu vitu                                      | `stats items`                                                                                                                                                                                                                               |
|                       |                                                                 | `stats detail`                                                                                                                                                                                                                              |
|                       |                                                                 | `stats sizes`                                                                                                                                                                                                                               |
|                       | Rudisha vipimo vya takwimu                                       | `stats reset`                                                                                                                                                                                                                               |
| lru\_crawler metadump | Pindua (karibu) metadata ya (vitu vyote) kwenye hifadhi           | `lru_crawler metadump all`                                                                                                                                                                                                                  |
| version               | Chapisha toleo la seva.                                          | `version`                                                                                                                                                                                                                                   |
| verbosity             | Ongeza kiwango cha kuingiza kwenye kumbukumbu                     | `verbosity`                                                                                                                                                                                                                                 |
| quit                  | Kamilisha kikao                                                 | `quit`                                                                                                                                                                                                                                      |

#### Takwimu za Trafiki <a href="#takwimu-za-trafiki" id="takwimu-za-trafiki"></a>

Unaweza kuuliza takwimu za trafiki za sasa kwa kutumia amri
```
stats
```
Utapata orodha ambayo inahudumia idadi ya uunganisho, herufi zinazoingia/zingine na mengi zaidi.

Mfano wa Matokeo:
```
STAT pid 14868
STAT uptime 175931
STAT time 1220540125
STAT version 1.2.2
STAT pointer_size 32
STAT rusage_user 620.299700
STAT rusage_system 1545.703017
STAT curr_items 228
STAT total_items 779
STAT bytes 15525
STAT curr_connections 92
STAT total_connections 1740
STAT connection_structures 165
STAT cmd_get 7411
STAT cmd_set 28445156
STAT get_hits 5183
STAT get_misses 2228
STAT evictions 0
STAT bytes_read 2112768087
STAT bytes_written 1000038245
STAT limit_maxbytes 52428800
STAT threads 1
END
```
#### Takwimu za Kumbukumbu <a href="#takwimu-za-kumbukumbu" id="takwimu-za-kumbukumbu"></a>

Unaweza kuuliza takwimu za sasa za kumbukumbu kwa kutumia
```
stats slabs
```
# Memcache Commands

Memcache is an in-memory key-value store that is commonly used for caching data in web applications. It is a popular choice due to its simplicity and high performance. In this section, we will explore some of the most commonly used commands in Memcache.

## SET

The `SET` command is used to store a key-value pair in Memcache. It takes the following syntax:

```
SET <key> <flags> <exptime> <bytes> [noreply]\r\n
<data block>\r\n
```

- `<key>`: The key under which the data will be stored.
- `<flags>`: Optional flags that can be used to store additional metadata about the value.
- `<exptime>`: The expiration time for the key-value pair, in seconds.
- `<bytes>`: The number of bytes in the data block.
- `[noreply]`: An optional parameter that tells the server not to send a response.

## GET

The `GET` command is used to retrieve the value associated with a given key. It takes the following syntax:

```
GET <key>\r\n
```

- `<key>`: The key of the value to retrieve.

## DELETE

The `DELETE` command is used to remove a key-value pair from Memcache. It takes the following syntax:

```
DELETE <key> [noreply]\r\n
```

- `<key>`: The key of the value to delete.
- `[noreply]`: An optional parameter that tells the server not to send a response.

## INCR and DECR

The `INCR` and `DECR` commands are used to increment and decrement the value associated with a given key, respectively. They take the following syntax:

```
INCR <key> <value> [noreply]\r\n
DECR <key> <value> [noreply]\r\n
```

- `<key>`: The key of the value to increment or decrement.
- `<value>`: The amount by which to increment or decrement the value.
- `[noreply]`: An optional parameter that tells the server not to send a response.

## APPEND and PREPEND

The `APPEND` and `PREPEND` commands are used to append or prepend data to the value associated with a given key, respectively. They take the following syntax:

```
APPEND <key> <bytes> [noreply]\r\n
<data block>\r\n
PREPEND <key> <bytes> [noreply]\r\n
<data block>\r\n
```

- `<key>`: The key of the value to append or prepend data to.
- `<bytes>`: The number of bytes in the data block.
- `[noreply]`: An optional parameter that tells the server not to send a response.
- `<data block>`: The data to append or prepend.

## STATS

The `STATS` command is used to retrieve statistics about the Memcache server. It takes the following syntax:

```
STATS\r\n
```

## FLUSH_ALL

The `FLUSH_ALL` command is used to remove all key-value pairs from Memcache. It takes the following syntax:

```
FLUSH_ALL [noreply]\r\n
```

- `[noreply]`: An optional parameter that tells the server not to send a response.

These are just a few of the many commands available in Memcache. Understanding these commands is essential for effectively working with Memcache in web applications.
```
STAT 1:chunk_size 80
STAT 1:chunks_per_page 13107
STAT 1:total_pages 1
STAT 1:total_chunks 13107
STAT 1:used_chunks 13106
STAT 1:free_chunks 1
STAT 1:free_chunks_end 12886
STAT 2:chunk_size 100
STAT 2:chunks_per_page 10485
STAT 2:total_pages 1
STAT 2:total_chunks 10485
STAT 2:used_chunks 10484
STAT 2:free_chunks 1
STAT 2:free_chunks_end 10477
[...]
STAT active_slabs 3
STAT total_malloced 3145436
END
```
Ikiwa hauko hakika ikiwa una kumbukumbu ya kutosha kwa kifaa chako cha memcached, angalia mara kwa mara kwa idadi ya "evictions" inayotolewa na amri ya "stats". Ikiwa una kumbukumbu ya kutosha kwa kifaa hicho, idadi ya "evictions" inapaswa kuwa 0 au angalau isiongezeke.

#### Ni Funguo Gani Zinazotumiwa? <a href="#funguo-gani-zinazotumiwa" id="funguo-gani-zinazotumiwa"></a>

Hakuna kazi iliyojengwa ndani ya kujua moja kwa moja seti ya sasa ya funguo. Walakini, unaweza kutumia
```
stats items
```
**Swahili Translation:**

```
### Amri ya Kujua Idadi ya Maneno yaliyopo

Ili kujua idadi ya maneno yaliyopo, tumia amri ifuatayo:

```bash
stats items
```

Amri hii itakupa habari kuhusu vitu vyote vilivyopo katika kumbukumbu ya Memcache, pamoja na idadi ya maneno yaliyohifadhiwa.
```
```
stats items
STAT items:1:number 220
STAT items:1:age 83095
STAT items:2:number 7
STAT items:2:age 1405
[...]
END
```
Hii angalau inasaidia kuona ikiwa funguo zozote zinatumika. Ili kudump funguo kutoka kwenye script ya PHP ambayo tayari inafikia memcache unaweza kutumia kificho cha PHP kutoka [100days.de](http://100days.de/serendipity/archives/55-Dumping-MemcacheD-Content-Keys-with-PHP.html).

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka mwanzo hadi kuwa bingwa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa kwenye HackTricks** au **kupakua HackTricks kwa muundo wa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) za kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwenye** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
