# Memcache-Befehle

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>

## Befehls-Spickzettel

**Von** [**https://lzone.de/cheat-sheet/memcached**](https://lzone.de/cheat-sheet/memcached)

Die unterst√ºtzten Befehle (offizielle und inoffizielle) sind im Dokument [doc/protocol.txt](https://github.com/memcached/memcached/blob/master/doc/protocol.txt) dokumentiert.

Leider ist die Syntaxbeschreibung nicht wirklich klar, und ein einfacher Hilfsbefehl, der die vorhandenen Befehle auflistet, w√§re viel besser. Hier ist eine √úbersicht √ºber die Befehle, die Sie in der [Quelle](https://github.com/memcached/memcached) finden k√∂nnen (Stand 19.08.2016):

| Befehl                | Beschreibung                                                   | Beispiel                                                                                                                                                                                                                                     |
| --------------------- | --------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| get                   | Liest einen Wert                                                | `get mykey`                                                                                                                                                                                                                                 |
| set                   | Setzt einen Schl√ºssel bedingungslos                            | <p><code>set mykey &#x3C;flags> &#x3C;ttl> &#x3C;size></code><br><br>&#x3C;p>Stellen Sie sicher, dass Sie \r\n als Zeilenumbr√ºche verwenden, wenn Sie Unix CLI-Tools verwenden. Zum Beispiel&#x3C;/p> <code>printf "set mykey 0 60 4\r\ndata\r\n" | nc localhost 11211</code></p> |
| add                   | F√ºgt einen neuen Schl√ºssel hinzu                                | `add newkey 0 60 5`                                                                                                                                                                                                                         |
| replace               | √úberschreibt einen vorhandenen Schl√ºssel                        | `replace key 0 60 5`                                                                                                                                                                                                                        |
| append                | F√ºgt Daten an einen vorhandenen Schl√ºssel an                     | `append key 0 60 15`                                                                                                                                                                                                                        |
| prepend               | F√ºgt Daten am Anfang eines vorhandenen Schl√ºssels ein            | `prepend key 0 60 15`                                                                                                                                                                                                                       |
| incr                  | Erh√∂ht den numerischen Schl√ºsselwert um eine angegebene Zahl     | `incr mykey 2`                                                                                                                                                                                                                              |
| decr                  | Verringert den numerischen Schl√ºsselwert um eine angegebene Zahl | `decr mykey 5`                                                                                                                                                                                                                              |
| delete                | L√∂scht einen vorhandenen Schl√ºssel                              | `delete mykey`                                                                                                                                                                                                                              |
| flush\_all            | Invalidiert sofort alle Elemente                                | `flush_all`                                                                                                                                                                                                                                 |
| flush\_all            | Invalidiert alle Elemente in n Sekunden                         | `flush_all 900`                                                                                                                                                                                                                             |
| stats                 | Gibt allgemeine Statistiken aus                                 | `stats`                                                                                                                                                                                                                                     |
|                       | Gibt Speicherstatistiken aus                                    | `stats slabs`                                                                                                                                                                                                                               |
|                       | Gibt Statistiken zur h√∂heren Ebenenallokation aus               | `stats malloc`                                                                                                                                                                                                                              |
|                       | Gibt Informationen zu Elementen aus                              | `stats items`                                                                                                                                                                                                                               |
|                       |                                                                 | `stats detail`                                                                                                                                                                                                                              |
|                       |                                                                 | `stats sizes`                                                                                                                                                                                                                               |
|                       | Setzt Statistikz√§hler zur√ºck                                    | `stats reset`                                                                                                                                                                                                                               |
| lru\_crawler metadump | Gibt (die meisten) Metadaten f√ºr (alle) Elemente im Cache aus   | `lru_crawler metadump all`                                                                                                                                                                                                                  |
| version               | Gibt die Serverversion aus                                      | `version`                                                                                                                                                                                                                                   |
| verbosity             | Erh√∂ht das Protokolllevel                                       | `verbosity`                                                                                                                                                                                                                                 |
| quit                  | Beendet die Sitzung                                             | `quit`                                                                                                                                                                                                                                      |

#### Verkehrsstatistiken <a href="#traffic-statistics" id="traffic-statistics"></a>

Sie k√∂nnen die aktuellen Verkehrsstatistiken mit dem Befehl abfragen
```
stats
```
Sie erhalten eine Auflistung, die die Anzahl der Verbindungen, Bytes in/out und vieles mehr anzeigt.

Beispiel-Ausgabe:
```
STAT pid 14868
STAT uptime 175931
STAT time 1220540125
STAT version 1.2.2
STAT pointer_size 32
STAT rusage_user 620.299700
STAT rusage_system 1545.703017
STAT curr_items 228
STAT total_items 779
STAT bytes 15525
STAT curr_connections 92
STAT total_connections 1740
STAT connection_structures 165
STAT cmd_get 7411
STAT cmd_set 28445156
STAT get_hits 5183
STAT get_misses 2228
STAT evictions 0
STAT bytes_read 2112768087
STAT bytes_written 1000038245
STAT limit_maxbytes 52428800
STAT threads 1
END
```
#### Speicherstatistiken <a href="#speicherstatistiken" id="speicherstatistiken"></a>

Sie k√∂nnen die aktuellen Speicherstatistiken abfragen, indem Sie folgenden Befehl verwenden:
```
stats slabs
```
# Memcache Commands

Memcache is a widely used distributed memory caching system. It is often used to speed up dynamic web applications by caching data and reducing the load on the database.

## Basic Commands

### SET

**Command**: `set <key> <flags> <exptime> <bytes> [noreply]`

**Description**: Sets the value of a key in the cache.

**Parameters**:
- `<key>`: The key to set.
- `<flags>`: Optional flags for the value.
- `<exptime>`: Optional expiration time in seconds.
- `<bytes>`: The number of bytes in the value.
- `[noreply]`: Optional parameter to not wait for a response.

**Example**:
```
set mykey 0 3600 5
hello
```

### GET

**Command**: `get <key>`

**Description**: Retrieves the value of a key from the cache.

**Parameters**:
- `<key>`: The key to retrieve.

**Example**:
```
get mykey
```

### DELETE

**Command**: `delete <key>`

**Description**: Deletes a key from the cache.

**Parameters**:
- `<key>`: The key to delete.

**Example**:
```
delete mykey
```

## Advanced Commands

### STATS

**Command**: `stats`

**Description**: Retrieves statistics about the memcache server.

**Example**:
```
stats
```

### FLUSH_ALL

**Command**: `flush_all`

**Description**: Flushes all keys from the cache.

**Example**:
```
flush_all
```

### VERSION

**Command**: `version`

**Description**: Retrieves the version of the memcache server.

**Example**:
```
version
```

## Conclusion

These are some of the basic and advanced commands that can be used with memcache. Understanding and utilizing these commands can greatly enhance your ability to work with memcache and optimize your web applications.
```
STAT 1:chunk_size 80
STAT 1:chunks_per_page 13107
STAT 1:total_pages 1
STAT 1:total_chunks 13107
STAT 1:used_chunks 13106
STAT 1:free_chunks 1
STAT 1:free_chunks_end 12886
STAT 2:chunk_size 100
STAT 2:chunks_per_page 10485
STAT 2:total_pages 1
STAT 2:total_chunks 10485
STAT 2:used_chunks 10484
STAT 2:free_chunks 1
STAT 2:free_chunks_end 10477
[...]
STAT active_slabs 3
STAT total_malloced 3145436
END
```
Wenn Sie sich nicht sicher sind, ob Sie gen√ºgend Speicherplatz f√ºr Ihre Memcached-Instanz haben, achten Sie immer auf die "Evictions"-Z√§hler, die vom "stats"-Befehl angegeben werden. Wenn Sie gen√ºgend Speicherplatz f√ºr die Instanz haben, sollte der "Evictions"-Z√§hler 0 sein oder zumindest nicht ansteigen.

#### Welche Schl√ºssel werden verwendet? <a href="#which-keys-are-used" id="which-keys-are-used"></a>

Es gibt keine integrierte Funktion, um den aktuellen Satz von Schl√ºsseln direkt zu bestimmen. Sie k√∂nnen jedoch den
```
stats items
```
## Command to Determine How Many Keys Exist

To determine the number of keys that exist in a Memcache server, you can use the `stats` command. This command provides statistics about the server, including the total number of keys stored.

```bash
stats items
```

This command will return a list of items with their corresponding statistics. Look for the line that starts with `STAT items:`, which indicates the total number of items (keys) stored in the Memcache server.

For example:

```bash
STAT items:1:number 10
```

In this example, the Memcache server has a total of 10 keys stored.
```
stats items
STAT items:1:number 220
STAT items:1:age 83095
STAT items:2:number 7
STAT items:2:age 1405
[...]
END
```
Dies hilft zumindest, um zu sehen, ob Schl√ºssel verwendet werden. Um die Schl√ºsselnamen aus einem PHP-Skript abzurufen, das bereits auf den Memcache zugreift, k√∂nnen Sie den PHP-Code von [100days.de](http://100days.de/serendipity/archives/55-Dumping-MemcacheD-Content-Keys-with-PHP.html) verwenden.

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) **bei oder folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) **und** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **GitHub-Repositories senden.**

</details>
