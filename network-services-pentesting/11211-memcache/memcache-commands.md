# Amri za Memcache

<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kuhack kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}


## Mwongozo wa Amri

**Kutoka** [**https://lzone.de/cheat-sheet/memcached**](https://lzone.de/cheat-sheet/memcached)

Amri zilizoungwa mkono (zile rasmi na zingine zisizo rasmi) zimeelezewa katika hati ya [doc/protocol.txt](https://github.com/memcached/memcached/blob/master/doc/protocol.txt).

Kwa bahati mbaya maelezo ya sintaksia sio wazi sana na amri rahisi ya msaada inayoonyesha amri zilizopo ingekuwa bora zaidi. Hapa kuna muhtasari wa amri unazoweza kupata katika [chanzo](https://github.com/memcached/memcached) (kufikia 19.08.2016):

| Amri                 | Maelezo                                                     | Mfano                                                                                                                                                                                                                                     |
| --------------------- | --------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| get                   | Soma thamani                                                   | `get mykey`                                                                                                                                                                                                                                 |
| set                   | Weka funguo bila masharti                                       | <p><code>set mykey &#x3C;flags> &#x3C;ttl> &#x3C;size></code><br><br>&#x3C;p>Hakikisha kutumia \r\n kama viambishi vya mistari unapotumia zana za Unix CLI. Kwa mfano&#x3C;/p> <code>printf "set mykey 0 60 4\r\ndata\r\n" | nc localhost 11211</code></p> |
| add                   | Ongeza funguo mpya                                             | `add newkey 0 60 5`                                                                                                                                                                                                                         |
| replace               | Badilisha funguo lililopo                                       | `replace key 0 60 5`                                                                                                                                                                                                                        |
| append                | Ongeza data kwa funguo lililopo                                  | `append key 0 60 15`                                                                                                                                                                                                                        |
| prepend               | Weka data mbele ya funguo lililopo                               | `prepend key 0 60 15`                                                                                                                                                                                                                       |
| incr                  | Ongeza thamani ya funguo kwa idadi iliyopewa                    | `incr mykey 2`                                                                                                                                                                                                                              |
| decr                  | Punguza thamani ya funguo kwa idadi iliyopewa                    | `decr mykey 5`                                                                                                                                                                                                                              |
| delete                | Futa funguo lililopo                                           | `delete mykey`                                                                                                                                                                                                                              |
| flush\_all            | Batilisha vitu vyote mara moja                                  | `flush_all`                                                                                                                                                                                                                                 |
| flush\_all            | Batilisha vitu vyote baada ya sekunde n                          | `flush_all 900`                                                                                                                                                                                                                             |
| stats                 | Chapisha takwimu za jumla                                      | `stats`                                                                                                                                                                                                                                     |
|                       | Chapisha takwimu za kumbukumbu                                  | `stats slabs`                                                                                                                                                                                                                               |
|                       | Chapisha takwimu za ugawaji wa kiwango cha juu                  | `stats malloc`                                                                                                                                                                                                                              |
|                       | Chapisha habari kuhusu vitu                                    | `stats items`                                                                                                                                                                                                                               |
|                       |                                                                 | `stats detail`                                                                                                                                                                                                                              |
|                       |                                                                 | `stats sizes`                                                                                                                                                                                                                               |
|                       | Rejesha vipimo vya takwimu                                      | `stats reset`                                                                                                                                                                                                                               |
| lru\_crawler metadump | Pindua (karibu) metadata kwa (vitu vyote) kwenye hifadhi         | `lru_crawler metadump all`                                                                                                                                                                                                                  |
| version               | Chapisha toleo la seva.                                       | `version`                                                                                                                                                                                                                                   |
| verbosity             | Ongeza kiwango cha kuingia                                      | `verbosity`                                                                                                                                                                                                                                 |
| quit                  | Komesha kikao                                                 | `quit`                                                                                                                                                                                                                                      |

#### Takwimu za Trafiki <a href="#traffic-statistics" id="traffic-statistics"></a>

Unaweza kuuliza takwimu za trafiki za sasa kwa kutumia amri
```
stats
```
Utapata orodha ambayo inahudumia idadi ya uunganisho, herufi zinazoingia/ kutoka na mengi zaidi.

Mfano wa Matokeo:
```
STAT pid 14868
STAT uptime 175931
STAT time 1220540125
STAT version 1.2.2
STAT pointer_size 32
STAT rusage_user 620.299700
STAT rusage_system 1545.703017
STAT curr_items 228
STAT total_items 779
STAT bytes 15525
STAT curr_connections 92
STAT total_connections 1740
STAT connection_structures 165
STAT cmd_get 7411
STAT cmd_set 28445156
STAT get_hits 5183
STAT get_misses 2228
STAT evictions 0
STAT bytes_read 2112768087
STAT bytes_written 1000038245
STAT limit_maxbytes 52428800
STAT threads 1
END
```
#### Takwimu za Kumbukumbu <a href="#memory-statistics" id="memory-statistics"></a>
```
stats slabs
```
Mfano wa Matokeo:
```
STAT 1:chunk_size 80
STAT 1:chunks_per_page 13107
STAT 1:total_pages 1
STAT 1:total_chunks 13107
STAT 1:used_chunks 13106
STAT 1:free_chunks 1
STAT 1:free_chunks_end 12886
STAT 2:chunk_size 100
STAT 2:chunks_per_page 10485
STAT 2:total_pages 1
STAT 2:total_chunks 10485
STAT 2:used_chunks 10484
STAT 2:free_chunks 1
STAT 2:free_chunks_end 10477
[...]
STAT active_slabs 3
STAT total_malloced 3145436
END
```
Ikiwa haujathibitisha ikiwa una kumbukumbu za kutosha kwa kipengee chako cha memcached, angalia mara kwa mara viashiria vya "evictions" vinavyotolewa na amri ya "stats". Ikiwa una kumbukumbu za kutosha kwa kipengee hicho, kiashiria cha "evictions" kinapaswa kuwa 0 au angalau kisiongezeke.

#### Ni Funguo Gani Zinazotumiwa? <a href="#which-keys-are-used" id="which-keys-are-used"></a>

Hakuna kazi iliyojengwa kwa moja kwa moja kubaini seti ya sasa ya funguo. Walakini, unaweza kutumia
```
stats items
```
### Command to determine how many keys do exist

```bash
stats items
```
```
stats items
STAT items:1:number 220
STAT items:1:age 83095
STAT items:2:number 7
STAT items:2:age 1405
[...]
END
```
Hii angalau husaidia kuona ikiwa funguo zozote zimetumika. Ili kudump funguo kutoka kwenye script ya PHP ambayo tayari inatumia ufikivu wa memcache unaweza kutumia msimbo wa PHP kutoka [100days.de](http://100days.de/serendipity/archives/55-Dumping-MemcacheD-Content-Keys-with-PHP.html).


<figure><img src="/.gitbook/assets/WebSec_1500x400_10fps_21sn_lightoptimized_v2.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi wa PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kuhack kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
