# Memcache Befehle

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Befehls-Spickzettel

**Von** [**https://lzone.de/cheat-sheet/memcached**](https://lzone.de/cheat-sheet/memcached)

Die unterst√ºtzten Befehle (die offiziellen und einige inoffizielle) sind im Dokument [doc/protocol.txt](https://github.com/memcached/memcached/blob/master/doc/protocol.txt) dokumentiert.

Leider ist die Syntaxbeschreibung nicht wirklich klar, und ein einfacher Hilfsbefehl, der die vorhandenen Befehle auflistet, w√§re viel besser. Hier ist eine √úbersicht √ºber die Befehle, die Sie in der [Quelle](https://github.com/memcached/memcached) finden k√∂nnen (Stand 19.08.2016):

| Befehl               | Beschreibung                                                     | Beispiel                                                                                                                                                                                                                                     |
| --------------------- | --------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| get                   | Liest einen Wert                                                  | `get meinkey`                                                                                                                                                                                                                                 |
| set                   | Setzt einen Schl√ºssel bedingungslos                             | <p><code>set meinkey &#x3C;flags> &#x3C;ttl> &#x3C;size></code><br><br>&#x3C;p>Stellen Sie sicher, dass Sie \r\n als Zeilenumbr√ºche verwenden, wenn Sie Unix CLI-Tools verwenden. Zum Beispiel&#x3C;/p> <code>printf "set meinkey 0 60 4\r\ndaten\r\n" | nc localhost 11211</code></p> |
| add                   | F√ºgt einen neuen Schl√ºssel hinzu                                | `add neuerkey 0 60 5`                                                                                                                                                                                                                         |
| replace               | √úberschreibt einen vorhandenen Schl√ºssel                        | `replace schl√ºssel 0 60 5`                                                                                                                                                                                                                        |
| append                | H√§ngt Daten an einen vorhandenen Schl√ºssel an                   | `append schl√ºssel 0 60 15`                                                                                                                                                                                                                        |
| prepend               | F√ºgt Daten am Anfang eines vorhandenen Schl√ºssels ein           | `prepend schl√ºssel 0 60 15`                                                                                                                                                                                                                       |
| incr                  | Erh√∂ht den numerischen Schl√ºsselwert um die angegebene Zahl      | `incr meinkey 2`                                                                                                                                                                                                                              |
| decr                  | Verringert den numerischen Schl√ºsselwert um die angegebene Zahl  | `decr meinkey 5`                                                                                                                                                                                                                              |
| delete                | L√∂scht einen vorhandenen Schl√ºssel                               | `delete meinkey`                                                                                                                                                                                                                              |
| flush\_all            | Invalidiert sofort alle Elemente                                | `flush_all`                                                                                                                                                                                                                                 |
| flush\_all            | Invalidiert alle Elemente in n Sekunden                          | `flush_all 900`                                                                                                                                                                                                                             |
| stats                 | Druckt allgemeine Statistiken                                    | `stats`                                                                                                                                                                                                                                     |
|                       | Druckt Speicherstatistiken                                      | `stats slabs`                                                                                                                                                                                                                               |
|                       | Druckt Statistiken zur h√∂heren Zuordnungsebene                   | `stats malloc`                                                                                                                                                                                                                              |
|                       | Druckt Informationen zu Elementen                                | `stats items`                                                                                                                                                                                                                               |
|                       |                                                                 | `stats detail`                                                                                                                                                                                                                              |
|                       |                                                                 | `stats sizes`                                                                                                                                                                                                                               |
|                       | Setzt Statistikz√§hler zur√ºck                                    | `stats reset`                                                                                                                                                                                                                               |
| lru\_crawler metadump | Gibt (die meisten) Metadaten f√ºr (alle) Elemente im Cache aus    | `lru_crawler metadump all`                                                                                                                                                                                                                  |
| version               | Gibt Serverversion aus                                          | `version`                                                                                                                                                                                                                                   |
| verbosity             | Erh√∂ht das Protokollniveau                                      | `verbosity`                                                                                                                                                                                                                                 |
| quit                  | Beendet die Sitzung                                              | `quit`                                                                                                                                                                                                                                      |

#### Verkehrsstatistiken <a href="#traffic-statistics" id="traffic-statistics"></a>

Sie k√∂nnen die aktuellen Verkehrsstatistiken abfragen, indem Sie den Befehl verwenden.
```
stats
```
Sie erhalten eine Liste, die die Anzahl der Verbindungen, Bytes in/out und vieles mehr anzeigt.

Beispiel Ausgabe:
```
STAT pid 14868
STAT uptime 175931
STAT time 1220540125
STAT version 1.2.2
STAT pointer_size 32
STAT rusage_user 620.299700
STAT rusage_system 1545.703017
STAT curr_items 228
STAT total_items 779
STAT bytes 15525
STAT curr_connections 92
STAT total_connections 1740
STAT connection_structures 165
STAT cmd_get 7411
STAT cmd_set 28445156
STAT get_hits 5183
STAT get_misses 2228
STAT evictions 0
STAT bytes_read 2112768087
STAT bytes_written 1000038245
STAT limit_maxbytes 52428800
STAT threads 1
END
```
#### Speicherstatistiken <a href="#memory-statistics" id="memory-statistics"></a>

Sie k√∂nnen die aktuellen Speicherstatistiken abfragen, indem Sie
```
stats slabs
```
Beispiel Output:
```
STAT 1:chunk_size 80
STAT 1:chunks_per_page 13107
STAT 1:total_pages 1
STAT 1:total_chunks 13107
STAT 1:used_chunks 13106
STAT 1:free_chunks 1
STAT 1:free_chunks_end 12886
STAT 2:chunk_size 100
STAT 2:chunks_per_page 10485
STAT 2:total_pages 1
STAT 2:total_chunks 10485
STAT 2:used_chunks 10484
STAT 2:free_chunks 1
STAT 2:free_chunks_end 10477
[...]
STAT active_slabs 3
STAT total_malloced 3145436
END
```
Wenn Sie unsicher sind, ob Sie gen√ºgend Speicherplatz f√ºr Ihre Memcached-Instanz haben, achten Sie immer auf die "Evictions"-Z√§hler, die vom "stats"-Befehl angegeben werden. Wenn Sie gen√ºgend Speicherplatz f√ºr die Instanz haben, sollte der "Evictions"-Z√§hler 0 sein oder zumindest nicht zunehmen.

#### Welche Schl√ºssel werden verwendet? <a href="#which-keys-are-used" id="which-keys-are-used"></a>

Es gibt keine integrierte Funktion, um direkt den aktuellen Satz von Schl√ºsseln zu bestimmen. Sie k√∂nnen jedoch den
```
stats items
```
Befehl, um festzustellen, wie viele Schl√ºssel vorhanden sind.
```
stats items
STAT items:1:number 220
STAT items:1:age 83095
STAT items:2:number 7
STAT items:2:age 1405
[...]
END
```
Dies hilft zumindest zu sehen, ob Schl√ºssel verwendet werden. Um die Schl√ºsselnamen aus einem PHP-Skript abzurufen, das bereits auf den Memcache zugreift, k√∂nnen Sie den PHP-Code von [100days.de](http://100days.de/serendipity/archives/55-Dumping-MemcacheD-Content-Keys-with-PHP.html) verwenden.


<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>Erlernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks beworben sehen m√∂chten** oder **HackTricks im PDF-Format herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merch**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories einreichen.

</details>
