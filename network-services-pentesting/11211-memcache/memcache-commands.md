# –ö–æ–º–∞–Ω–¥–∏ Memcache

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>

## –®–ø–∞—Ä–≥–∞–ª–∫–∞ –∑ –∫–æ–º–∞–Ω–¥

**–ó** [**https://lzone.de/cheat-sheet/memcached**](https://lzone.de/cheat-sheet/memcached)

–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ (–æ—Ñ—ñ—Ü—ñ–π–Ω—ñ —Ç–∞ –¥–µ—è–∫—ñ –Ω–µ–æ—Ñ—ñ—Ü—ñ–π–Ω—ñ) –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ –≤ –¥–æ–∫—É–º–µ–Ω—Ç—ñ [doc/protocol.txt](https://github.com/memcached/memcached/blob/master/doc/protocol.txt).

–ù–∞ –∂–∞–ª—å, –æ–ø–∏—Å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É –Ω–µ —î –¥—É–∂–µ –∑—Ä–æ–∑—É–º—ñ–ª–∏–º, —ñ –ø—Ä–æ—Å—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–æ–≤—ñ–¥–∫–∏, —è–∫–∞ –ø–µ—Ä–µ–ª—ñ—á—É—î —ñ—Å–Ω—É—é—á—ñ –∫–æ–º–∞–Ω–¥–∏, –±—É–ª–∞ –± –Ω–∞–±–∞–≥–∞—Ç–æ –∫—Ä–∞—â–µ. –û—Å—å –æ–≥–ª—è–¥ –∫–æ–º–∞–Ω–¥, —è–∫—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –≤ [–¥–∂–µ—Ä–µ–ª—ñ](https://github.com/memcached/memcached) (–Ω–∞ 19.08.2016):

| –ö–æ–º–∞–Ω–¥–∞               | –û–ø–∏—Å                                                     | –ü—Ä–∏–∫–ª–∞–¥                                                                                                                                                                                                                                     |
| --------------------- | ------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| get                   | –ß–∏—Ç–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è                                           | `get mykey`                                                                                                                                                                                                                                 |
| set                   | –í—Å—Ç–∞–Ω–æ–≤–ª—é—î –∫–ª—é—á –±–µ–∑—É–º–æ–≤–Ω–æ                                | <p><code>set mykey &#x3C;flags> &#x3C;ttl> &#x3C;size></code><br><br>&#x3C;p>–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ \r\n —è–∫ —Ä–æ–∑–¥—ñ–ª—å–Ω–∏–∫ —Ä—è–¥–∫—ñ–≤ –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ Unix CLI. –ù–∞–ø—Ä–∏–∫–ª–∞–¥&#x3C;/p> <code>printf "set mykey 0 60 4\r\ndata\r\n" | nc localhost 11211</code></p> |
| add                   | –î–æ–¥–∞—î –Ω–æ–≤–∏–π –∫–ª—é—á                                         | `add newkey 0 60 5`                                                                                                                                                                                                                         |
| replace               | –ü–µ—Ä–µ–∑–∞–ø–∏—Å—É—î —ñ—Å–Ω—É—é—á–∏–π –∫–ª—é—á                                | `replace key 0 60 5`                                                                                                                                                                                                                        |
| append                | –î–æ–¥–∞—î –¥–∞–Ω—ñ –¥–æ —ñ—Å–Ω—É—é—á–æ–≥–æ –∫–ª—é—á–∞                            | `append key 0 60 15`                                                                                                                                                                                                                        |
| prepend               | –î–æ–¥–∞—î –¥–∞–Ω—ñ –¥–æ –ø–æ—á–∞—Ç–∫—É —ñ—Å–Ω—É—é—á–æ–≥–æ –∫–ª—é—á–∞                    | `prepend key 0 60 15`                                                                                                                                                                                                                       |
| incr                  | –ó–±—ñ–ª—å—à—É—î —á–∏—Å–ª–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∫–ª—é—á–∞ –Ω–∞ –≤–∫–∞–∑–∞–Ω–µ —á–∏—Å–ª–æ         | `incr mykey 2`                                                                                                                                                                                                                              |
| decr                  | –ó–º–µ–Ω—à—É—î —á–∏—Å–ª–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∫–ª—é—á–∞ –Ω–∞ –≤–∫–∞–∑–∞–Ω–µ —á–∏—Å–ª–æ          | `decr mykey 5`                                                                                                                                                                                                                              |
| delete                | –í–∏–¥–∞–ª—è—î —ñ—Å–Ω—É—é—á–∏–π –∫–ª—é—á                                    | `delete mykey`                                                                                                                                                                                                                              |
| flush\_all            | –ù–µ–≥–∞–π–Ω–æ –∞–Ω—É–ª—é—î –≤—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏                              | `flush_all`                                                                                                                                                                                                                                 |
| flush\_all            | –ê–Ω—É–ª—é—î –≤—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ —á–µ—Ä–µ–∑ n —Å–µ–∫—É–Ω–¥                      | `flush_all 900`                                                                                                                                                                                                                             |
| stats                 | –í–∏–≤–æ–¥–∏—Ç—å –∑–∞–≥–∞–ª—å–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É                             | `stats`                                                                                                                                                                                                                                     |
|                       | –í–∏–≤–æ–¥–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–∞–º'—è—Ç—ñ                              | `stats slabs`                                                                                                                                                                                                                               |
|                       | –í–∏–≤–æ–¥–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∏—â–æ–≥–æ —Ä—ñ–≤–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É               | `stats malloc`                                                                                                                                                                                                                              |
|                       | –í–∏–≤–æ–¥–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –µ–ª–µ–º–µ–Ω—Ç–∏                         | `stats items`                                                                                                                                                                                                                               |
|                       |                                                         | `stats detail`                                                                                                                                                                                                                              |
|                       |                                                         | `stats sizes`                                                                                                                                                                                                                               |
|                       | –°–∫–∏–¥–∞—î –ª—ñ—á–∏–ª—å–Ω–∏–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏                             | `stats reset`                                                                                                                                                                                                                               |
| lru\_crawler metadump | –í–∏–≤–æ–¥–∏—Ç—å (–±—ñ–ª—å—à—ñ—Å—Ç—å) –º–µ—Ç–∞–¥–∞–Ω—ñ (–≤—Å—ñ) –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –≤ –∫–µ—à—ñ     | `lru_crawler metadump all`                                                                                                                                                                                                                  |
| version               | –í–∏–≤–æ–¥–∏—Ç—å –≤–µ—Ä—Å—ñ—é —Å–µ—Ä–≤–µ—Ä–∞                                  | `version`                                                                                                                                                                                                                                   |
| verbosity             | –ó–±—ñ–ª—å—à—É—î —Ä—ñ–≤–µ–Ω—å –∂—É—Ä–Ω–∞–ª—É                                  | `verbosity`                                                                                                                                                                                                                                 |
| quit                  | –ó–∞–≤–µ—Ä—à—É—î —Å–µ–∞–Ω—Å                                           | `quit`                                                                                                                                                                                                                                      |

#### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–∞—Ñ—ñ–∫—É <a href="#traffic-statistics" id="traffic-statistics"></a>

–í–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Ç–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ç—Ä–∞—Ñ—ñ–∫—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–º–∞–Ω–¥–∏
```
stats
```
–í–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ —Å–ø–∏—Å–æ–∫, —è–∫–∏–π –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑'—î–¥–Ω–∞–Ω—å, –±–∞–π—Ç—ñ–≤ —É/–≤ —Ç–∞ –±–∞–≥–∞—Ç–æ —ñ–Ω—à–æ–≥–æ.

–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–≤–æ–¥—É:
```
STAT pid 14868
STAT uptime 175931
STAT time 1220540125
STAT version 1.2.2
STAT pointer_size 32
STAT rusage_user 620.299700
STAT rusage_system 1545.703017
STAT curr_items 228
STAT total_items 779
STAT bytes 15525
STAT curr_connections 92
STAT total_connections 1740
STAT connection_structures 165
STAT cmd_get 7411
STAT cmd_set 28445156
STAT get_hits 5183
STAT get_misses 2228
STAT evictions 0
STAT bytes_read 2112768087
STAT bytes_written 1000038245
STAT limit_maxbytes 52428800
STAT threads 1
END
```
#### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∞–º'—è—Ç—ñ <a href="#memory-statistics" id="memory-statistics"></a>

–í–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Ç–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é
```
stats slabs
```
```markdown
### Memcache commands

#### Stats
- **stats** - General statistics.
- **stats items** - Detailed statistics about items.
- **stats slabs** - Detailed statistics about slabs.
- **stats sizes** - Detailed statistics about sizes.
- **stats cachedump <slab_id> <number>** - Dump keys and values from a slab.
- **stats conns** - Detailed statistics about connections.
- **stats settings** - Detailed statistics about settings.
- **stats detail** - Detailed statistics about general stats.
- **stats sizes** - Detailed statistics about sizes.
- **stats reset** - Reset statistics.

#### Set
- **set <key> <flags> <exptime> <bytes> [noreply]** - Store data.
- **add <key> <flags> <exptime> <bytes> [noreply]** - Store data, but only if the server doesn't already hold data for this key.
- **replace <key> <flags> <exptime> <bytes> [noreply]** - Store data, but only if the server already holds data for this key.
- **append <key> <bytes> [noreply]** - Append data to an existing key.
- **prepend <key> <bytes> [noreply]** - Prepend data to an existing key.
- **cas <key> <flags> <exptime> <bytes> <cas_unique> [noreply]** - Store data with a check and set operation.

#### Get
- **get <key>** - Retrieve data.
- **gets <key>** - Retrieve data with CAS value.

#### Delete
- **delete <key> [noreply]** - Delete data.

#### Increment/Decrement
- **incr <key> <value> [noreply]** - Increment the value of a key.
- **decr <key> <value> [noreply]** - Decrement the value of a key.

#### Touch
- **touch <key> <exptime> [noreply]** - Update the expiration time of a key.

#### Flush
- **flush_all [delay]** - Flush all data after optional delay.
```
```
STAT 1:chunk_size 80
STAT 1:chunks_per_page 13107
STAT 1:total_pages 1
STAT 1:total_chunks 13107
STAT 1:used_chunks 13106
STAT 1:free_chunks 1
STAT 1:free_chunks_end 12886
STAT 2:chunk_size 100
STAT 2:chunks_per_page 10485
STAT 2:total_pages 1
STAT 2:total_chunks 10485
STAT 2:used_chunks 10484
STAT 2:free_chunks 1
STAT 2:free_chunks_end 10477
[...]
STAT active_slabs 3
STAT total_malloced 3145436
END
```
–Ø–∫—â–æ –≤–∏ –Ω–µ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —É –≤–∞—Å –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –ø–∞–º'—è—Ç—ñ –¥–ª—è –≤–∞—à–æ–≥–æ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ memcached, –∑–∞–≤–∂–¥–∏ —Å–ª—ñ–¥ —Å—Ç–µ–∂–∏—Ç–∏ –∑–∞ –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞–º–∏ "–≤–∏–¥–∞–ª–µ–Ω—å", —è–∫—ñ –Ω–∞–¥–∞—î –∫–æ–º–∞–Ω–¥–∞ "stats". –Ø–∫—â–æ —É –≤–∞—Å –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –ø–∞–º'—è—Ç—ñ –¥–ª—è –µ–∫–∑–µ–º–ø–ª—è—Ä–∞, –ª—ñ—á–∏–ª—å–Ω–∏–∫ "–≤–∏–¥–∞–ª–µ–Ω—å" –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ —Ä—ñ–≤–Ω–∏–º 0 –∞–±–æ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ –Ω–µ –∑–±—ñ–ª—å—à—É–≤–∞—Ç–∏—Å—è.

#### –Ø–∫—ñ –∫–ª—é—á—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è? <a href="#which-keys-are-used" id="which-keys-are-used"></a>

–ù–µ —ñ—Å–Ω—É—î –≤–±—É–¥–æ–≤–∞–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –ø—Ä—è–º–æ–≥–æ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É –∫–ª—é—á—ñ–≤. –û–¥–Ω–∞–∫ –≤–∏ –º–æ–∂–µ—Ç–µ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è
```
stats items
```
–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ —ñ—Å–Ω—É—é—á–∏—Ö –∫–ª—é—á—ñ–≤: `stats items`.
```
stats items
STAT items:1:number 220
STAT items:1:age 83095
STAT items:2:number 7
STAT items:2:age 1405
[...]
END
```
–¶–µ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ –¥–æ–ø–æ–º–∞–≥–∞—î –ø–æ–±–∞—á–∏—Ç–∏, —á–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —è–∫—ñ-–Ω–µ–±—É–¥—å –∫–ª—é—á—ñ. –©–æ–± –≤–∏–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∏ –∫–ª—é—á—ñ–≤ –∑ PHP-—Å–∫—Ä–∏–ø—Ç—É, —è–∫–∏–π –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –¥–æ—Å—Ç—É–ø –¥–æ memcache, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ PHP-–∫–æ–¥ –∑ [100days.de](http://100days.de/serendipity/archives/55-Dumping-MemcacheD-Content-Keys-with-PHP.html).
