# Protocolos B√°sicos de VoIP

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Protocolos de Sinaliza√ß√£o

### SIP (Session Initiation Protocol)

Este √© o padr√£o da ind√∫stria, para mais informa√ß√µes, consulte:

{% content-ref url="sip-session-initiation-protocol.md" %}
[sip-session-initiation-protocol.md](sip-session-initiation-protocol.md)
{% endcontent-ref %}

### MGCP (Media Gateway Control Protocol)

MGCP (Media Gateway Control Protocol) √© um **protocolo de sinaliza√ß√£o** e **controle de chamadas** descrito no RFC 3435. Ele opera em uma arquitetura centralizada, que consiste em tr√™s componentes principais:

1. **Agente de Chamada ou Controlador de Gateway de M√≠dia (MGC)**: O gateway principal na arquitetura MGCP √© respons√°vel por **gerenciar e controlar os gateways de m√≠dia**. Ele lida com o processo de configura√ß√£o, modifica√ß√£o e t√©rmino de chamadas. O MGC se comunica com os gateways de m√≠dia usando o protocolo MGCP.
2. **Gateways de M√≠dia (MGs) ou Gateways Escravos**: Esses dispositivos **convertem fluxos de m√≠dia digitais entre diferentes redes**, como telefonia comutada por circuito tradicional e redes IP comutadas por pacotes. Eles s√£o gerenciados pelo MGC e executam comandos recebidos dele. Os gateways de m√≠dia podem incluir fun√ß√µes como transcodifica√ß√£o, empacotamento e cancelamento de eco.
3. **Gateways de Sinaliza√ß√£o (SGs)**: Esses gateways s√£o respons√°veis por **converter mensagens de sinaliza√ß√£o entre diferentes redes**, permitindo comunica√ß√£o cont√≠nua entre sistemas de telefonia tradicionais (por exemplo, SS7) e redes baseadas em IP (por exemplo, SIP ou H.323). Os gateways de sinaliza√ß√£o s√£o cruciais para interoperabilidade e garantir que as informa√ß√µes de controle de chamada sejam comunicadas adequadamente entre as diferentes redes.

Em resumo, o MGCP centraliza a l√≥gica de controle de chamadas no agente de chamada, o que simplifica o gerenciamento de gateways de m√≠dia e sinaliza√ß√£o, fornecendo melhor escalabilidade, confiabilidade e efici√™ncia em redes de telecomunica√ß√µes.

### SCCP (Skinny Client Control Protocol)

O Skinny Client Control Protocol (SCCP) √© um **protocolo de sinaliza√ß√£o e controle de chamadas propriet√°rio** de propriedade da Cisco Systems. √â usado principalmente para comunica√ß√£o entre o **Cisco Unified Communications Manager** (anteriormente conhecido como CallManager) e telefones IP da Cisco ou outros endpoints de voz e v√≠deo da Cisco.

O SCCP √© um protocolo leve que simplifica a comunica√ß√£o entre o servidor de controle de chamadas e os dispositivos de endpoint. √â chamado de "Skinny" por causa de seu design minimalista e requisitos de largura de banda reduzidos em compara√ß√£o com outros protocolos VoIP como H.323 ou SIP.

Os principais componentes de um sistema baseado em SCCP s√£o:

1. **Servidor de Controle de Chamadas**: Este servidor, normalmente um Cisco Unified Communications Manager, gerencia o processo de configura√ß√£o, modifica√ß√£o e t√©rmino de chamadas, bem como outros recursos de telefonia, como encaminhamento de chamadas, transfer√™ncia de chamadas e espera de chamadas.
2. **Endpoints SCCP**: Estes s√£o dispositivos como telefones IP, unidades de videoconfer√™ncia ou outros endpoints de voz e v√≠deo da Cisco que usam SCCP para se comunicar com o servidor de controle de chamadas. Eles se registram no servidor, enviam e recebem mensagens de sinaliza√ß√£o e seguem as instru√ß√µes fornecidas pelo servidor de controle de chamadas para o tratamento de chamadas.
3. **Gateways**: Esses dispositivos, como gateways de voz ou gateways de m√≠dia, s√£o respons√°veis por converter fluxos de m√≠dia entre diferentes redes, como telefonia comutada por circuito tradicional e redes IP comutadas por pacotes. Eles tamb√©m podem incluir funcionalidades adicionais, como transcodifica√ß√£o ou cancelamento de eco.

O SCCP oferece um m√©todo de comunica√ß√£o simples e eficiente entre os servidores de controle de chamadas da Cisco
### RTP / RTCP / SRTP / ZRTP

1. **RTP (Real-time Transport Protocol)**: RTP √© um protocolo de rede projetado para a entrega de dados de √°udio e v√≠deo, ou outros meios de comunica√ß√£o em tempo real, por meio de redes IP. Desenvolvido pelo **IETF** e definido no **RFC 3550**, o RTP √© comumente usado com protocolos de sinaliza√ß√£o como SIP e H.323 para permitir a comunica√ß√£o multim√≠dia. O RTP fornece mecanismos de **sincroniza√ß√£o**, **sequenciamento** e **timestamping** de fluxos de m√≠dia, ajudando a garantir a reprodu√ß√£o de m√≠dia suave e oportuna.
2. **RTCP (Real-time Transport Control Protocol)**: RTCP √© um protocolo companheiro do RTP, usado para monitorar a qualidade de servi√ßo (QoS) e fornecer feedback sobre a transmiss√£o de fluxos de m√≠dia. Definido no mesmo **RFC 3550** que o RTP, o RTCP **troca periodicamente pacotes de controle entre os participantes de uma sess√£o RTP**. Ele compartilha informa√ß√µes como perda de pacotes, jitter e tempo de ida e volta, o que ajuda no diagn√≥stico e adapta√ß√£o √†s condi√ß√µes da rede, melhorando a qualidade geral da m√≠dia.
3. **SRTP (Secure Real-time Transport Protocol)**: SRTP √© uma extens√£o do RTP que fornece **criptografia**, **autentica√ß√£o de mensagem** e **prote√ß√£o contra replay** para fluxos de m√≠dia, garantindo a transmiss√£o segura de dados de √°udio e v√≠deo sens√≠veis. Definido no **RFC 3711**, o SRTP usa algoritmos criptogr√°ficos como AES para criptografia e HMAC-SHA1 para autentica√ß√£o de mensagem. O SRTP √© frequentemente usado em combina√ß√£o com protocolos de sinaliza√ß√£o seguros como SIP sobre TLS para fornecer seguran√ßa de ponta a ponta na comunica√ß√£o multim√≠dia.
4. **ZRTP (Zimmermann Real-time Transport Protocol)**: ZRTP √© um protocolo de acordo de chave criptogr√°fica que fornece **criptografia de ponta a ponta** para fluxos de m√≠dia RTP. Desenvolvido por Phil Zimmermann, o criador do PGP, o ZRTP √© descrito no **RFC 6189**. Ao contr√°rio do SRTP, que depende de protocolos de sinaliza√ß√£o para troca de chaves, o ZRTP √© projetado para funcionar independentemente do protocolo de sinaliza√ß√£o. Ele usa a **troca de chaves Diffie-Hellman** para estabelecer um segredo compartilhado entre as partes comunicantes, sem exigir confian√ßa pr√©via ou uma infraestrutura de chave p√∫blica (PKI). O ZRTP tamb√©m inclui recursos como **Short Authentication Strings (SAS)** para proteger contra ataques de homem no meio.

Esses protocolos desempenham pap√©is essenciais na **entrega e seguran√ßa da comunica√ß√£o multim√≠dia em tempo real por meio de redes IP**. Enquanto o RTP e o RTCP lidam com a transmiss√£o real da m√≠dia e monitoramento de qualidade, o SRTP e o ZRTP garantem que a m√≠dia transmitida esteja protegida contra espionagem, adultera√ß√£o e ataques de replay.
