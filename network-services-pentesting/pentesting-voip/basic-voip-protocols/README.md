# Grundlegende VoIP-Protokolle

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegramm-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) Github-Repositories senden.

</details>

## Signalisierungsprotokolle

### SIP (Session Initiation Protocol)

Dies ist der Branchenstandard, f√ºr weitere Informationen siehe:

{% content-ref url="sip-session-initiation-protocol.md" %}
[sip-session-initiation-protocol.md](sip-session-initiation-protocol.md)
{% endcontent-ref %}

### MGCP (Media Gateway Control Protocol)

MGCP (Media Gateway Control Protocol) ist ein **Signalisierungs- und Anrufsteuerungsprotokoll**, das in RFC 3435 beschrieben wird. Es arbeitet in einer zentralisierten Architektur, die aus drei Hauptkomponenten besteht:

1. **Call Agent oder Media Gateway Controller (MGC)**: Das Master-Gateway in der MGCP-Architektur ist f√ºr die **Verwaltung und Steuerung der Media Gateways** verantwortlich. Es handhabt den Anrufaufbau, die √Ñnderung und Beendigung von Prozessen. Der MGC kommuniziert mit den Media Gateways √ºber das MGCP-Protokoll.
2. **Media Gateways (MGs) oder Slave Gateways**: Diese Ger√§te **konvertieren digitale Mediendatenstr√∂me zwischen verschiedenen Netzwerken**, wie z. B. traditionelle schaltungsbasierte Telefonie und paketbasierte IP-Netzwerke. Sie werden vom MGC verwaltet und f√ºhren von ihm empfangene Befehle aus. Media Gateways k√∂nnen Funktionen wie Transcodierung, Paketierung und Echokompensation umfassen.
3. **Signalisierungsgateways (SGs)**: Diese Gateways sind f√ºr die **Konvertierung von Signalisierungsnachrichten zwischen verschiedenen Netzwerken** verantwortlich und erm√∂glichen eine nahtlose Kommunikation zwischen traditionellen Telefonsystemen (z. B. SS7) und IP-basierten Netzwerken (z. B. SIP oder H.323). Signalisierungsgateways sind entscheidend f√ºr die Interoperabilit√§t und stellen sicher, dass Informationen zur Anrufsteuerung ordnungsgem√§√ü zwischen den verschiedenen Netzwerken √ºbermittelt werden.

Zusammenfassend zentralisiert MGCP die Anrufsteuerungslogik im Call Agent, was die Verwaltung von Media- und Signalisierungsgateways vereinfacht und eine bessere Skalierbarkeit, Zuverl√§ssigkeit und Effizienz in Telekommunikationsnetzwerken bietet.

### SCCP (Skinny Client Control Protocol)

Das Skinny Client Control Protocol (SCCP) ist ein **propriet√§res Signalisierungs- und Anrufsteuerungsprotokoll**, das von Cisco Systems entwickelt wurde. Es wird haupts√§chlich f√ºr die Kommunikation zwischen Cisco Unified Communications Manager (fr√ºher bekannt als CallManager) und Cisco IP-Telefonen oder anderen Cisco-Sprach- und Videoendpunkten verwendet.

SCCP ist ein leichtgewichtiges Protokoll, das die Kommunikation zwischen dem Call Control Server und den Endger√§ten vereinfacht. Es wird als "Skinny" bezeichnet, aufgrund seines minimalistischen Designs und der reduzierten Bandbreitenanforderungen im Vergleich zu anderen VoIP-Protokollen wie H.323 oder SIP.

Die Hauptkomponenten eines SCCP-basierten Systems sind:

1. **Call Control Server**: Dieser Server, in der Regel ein Cisco Unified Communications Manager, verwaltet den Anrufaufbau, die √Ñnderung und Beendigung von Prozessen sowie andere Telefoniefunktionen wie Rufumleitung, Anrufweiterleitung und Anruf halten.
2. **SCCP-Endpunkte**: Dies sind Ger√§te wie IP-Telefone, Videokonferenzsysteme oder andere Cisco-Sprach- und Videoendpunkte, die SCCP zur Kommunikation mit dem Call Control Server verwenden. Sie registrieren sich beim Server, senden und empfangen Signalisierungsnachrichten und befolgen die Anweisungen des Call Control Servers zur Anrufbearbeitung.
3. **Gateways**: Diese Ger√§te wie Sprachgateways oder Mediagateways sind f√ºr die Konvertierung von Mediendatenstr√∂men zwischen verschiedenen Netzwerken, wie traditionelle schaltungsbasierte Telefonie und paketbasierte IP-Netzwerke, verantwortlich. Sie k√∂nnen auch zus√§tzliche Funktionen wie Transcodierung oder Echokompensation umfassen.

SCCP bietet eine einfache und effiziente Kommunikationsmethode zwischen Cisco Call Control Servern und Endger√§ten. Es ist jedoch zu beachten, dass **SCCP ein propriet√§res Protokoll** ist, das die Interoperabilit√§t mit Nicht-Cisco-Systemen einschr√§nken kann. In solchen F√§llen k√∂nnen andere standardisierte VoIP-Protokolle wie SIP m√∂glicherweise besser geeignet sein.

### H.323

H.323 ist eine **Protokollsuite** f√ºr Multimedia-Kommunikation, einschlie√ülich Sprach-, Video- und Datenkonferenzen √ºber paketvermittelte Netzwerke wie IP-basierte Netzwerke. Es wurde von der Internationalen Fernmeldeunion (ITU-T) entwickelt und bietet einen umfassenden Rahmen f√ºr die Verwaltung von Multimedia-Kommunikationssitzungen.

Einige wichtige Komponenten der H.323-Suite sind:

1. **Endger√§te**: Dies sind Endger√§te wie IP-Telefone, Videokonferenzsysteme oder Softwareanwendungen, die H.323 unterst√ºtzen und an Multimedia-Kommunikationssitzungen teilnehmen k√∂nnen.
2. **Gateways**: Diese Ger√§te konvertieren Mediendatenstr√∂me zwischen verschiedenen Netzwerken wie traditionelle schaltungsbasierte Telefonie und paketvermittelte IP-Netzwerke und erm√∂glichen die Interoperabilit√§t zwischen H.323 und anderen Kommunikationssystemen. Sie k√∂nnen auch zus√§tzliche Funktionen wie Transcodierung oder Echokompensation umfassen.
3. **Gatekeeper**: Dies sind optionale Komponenten, die Call Control- und Managementdienste in einem H.323-Netzwerk bereitstellen. Sie f√ºhren Funktionen wie Adress√ºbersetzung, Bandbreitenmanagement und Zulassungskontrolle durch und helfen bei der Verwaltung und Optimierung von Netzwerkressourcen.
4. **Multipoint Control Units (MCUs)**: Diese Ger√§te erm√∂glichen Multipoint-Konferenzen, indem sie Mediendatenstr√∂me von mehreren Endger√§ten verwalten und mischen. MCUs erm√∂glichen Funktionen wie die Steuerung des Videolayouts, sprachaktivierte Umschaltung und kontinuierliche Pr√§senz, sodass gro√üe Konferenzen mit mehreren Teilnehmern m√∂glich sind.

H.323 unterst√ºtzt eine Reihe von Audio- und Video-Codecs sowie andere erg√§nzende Dienste wie Rufumleitung, Anrufweiterleitung, Anruf halten und Anruf warten. Trotz seiner weiten Verbreitung in den Anfangstagen von VoIP wurde H.323 allm√§hlich durch modernere und flexiblere Protokolle wie das **Session Initiation Protocol (SIP)** ersetzt, das eine bessere Interoperabilit√§t und einfachere Implementierung bietet. Dennoch wird H.323 in vielen Legacy-Systemen verwendet und von verschiedenen Ger√§teherstellern unterst√ºtzt.

### IAX (Inter Asterisk eXchange)

IAX (Inter-Asterisk eXchange) ist ein **Signalisierungs- und Anrufsteuerungsprotokoll**, das haupts√§chlich f√ºr die Kommunikation zwischen Asterisk PBX (Private Branch Exchange)-Servern und anderen VoIP-Ger√§ten verwendet wird. Es wurde von Mark Spencer,
## √úbertragungs- und Transportprotokolle

### SDP (Session Description Protocol)

SDP (Session Description Protocol) ist ein **textbasiertes Format**, das verwendet wird, um die Eigenschaften von Multimedia-Sitzungen wie Sprach-, Video- oder Datenkonferenzen √ºber IP-Netzwerke zu beschreiben. Es wurde von der **Internet Engineering Task Force (IETF)** entwickelt und ist in **RFC 4566** definiert. SDP behandelt nicht die eigentliche Medien√ºbertragung oder Sitzungseinrichtung, sondern wird in Verbindung mit anderen Signalisierungsprotokollen wie **SIP (Session Initiation Protocol)** verwendet, um Informationen √ºber die Medienstr√∂me und ihre Attribute zu verhandeln und auszutauschen.

Einige wichtige Elemente von SDP sind:

1. **Sitzungsinformationen**: SDP beschreibt die Details einer Multimedia-Sitzung, einschlie√ülich Sitzungsname, Sitzungsbeschreibung, Startzeit und Endzeit.
2. **Medienstr√∂me**: SDP definiert die Eigenschaften von Medienstr√∂men, wie den Medientyp (Audio, Video oder Text), das Transportprotokoll (z. B. RTP oder SRTP) und das Medienformat (z. B. Codec-Informationen).
3. **Verbindungsinformationen**: SDP liefert Informationen √ºber die Netzwerkadresse (IP-Adresse) und Portnummer, an die die Medien gesendet oder empfangen werden sollen.
4. **Attribute**: SDP unterst√ºtzt die Verwendung von Attributen, um zus√§tzliche optionale Informationen √ºber eine Sitzung oder einen Medienstrom bereitzustellen. Attribute k√∂nnen verwendet werden, um verschiedene Funktionen wie Verschl√ºsselungsschl√ºssel, Bandbreitenanforderungen oder Mediensteuerungsmechanismen anzugeben.

SDP wird in der Regel in folgendem Prozess verwendet:

1. Eine initiierende Partei erstellt eine SDP-Beschreibung der vorgeschlagenen Multimedia-Sitzung, einschlie√ülich der Details der Medienstr√∂me und ihrer Attribute.
2. Die SDP-Beschreibung wird an die empfangende Partei gesendet, normalerweise eingebettet in eine Signalisierungsprotokollnachricht wie SIP oder RTSP.
3. Die empfangende Partei verarbeitet die SDP-Beschreibung und kann basierend auf ihren F√§higkeiten die vorgeschlagene Sitzung akzeptieren, ablehnen oder modifizieren.
4. Die endg√ºltige SDP-Beschreibung wird als Teil der Signalisierungsprotokollnachricht an die initiierende Partei zur√ºckgesendet und schlie√üt den Verhandlungsprozess ab.

Die Einfachheit und Flexibilit√§t von SDP machen es zu einem weit verbreiteten Standard zur Beschreibung von Multimedia-Sitzungen in verschiedenen Kommunikationssystemen und spielen eine entscheidende Rolle bei der Einrichtung und Verwaltung von Echtzeit-Multimedia-Sitzungen √ºber IP-Netzwerke.

### RTP / RTCP / SRTP / ZRTP

1. **RTP (Real-time Transport Protocol)**: RTP ist ein Netzwerkprotokoll, das f√ºr die √úbertragung von Audio- und Videodaten oder anderen Echtzeitmedien √ºber IP-Netzwerke entwickelt wurde. Entwickelt von der **IETF** und definiert in **RFC 3550**, wird RTP h√§ufig mit Signalisierungsprotokollen wie SIP und H.323 verwendet, um multimediale Kommunikation zu erm√∂glichen. RTP bietet Mechanismen zur **Synchronisierung**, **Sequenzierung** und **Zeitstempelung** von Medienstr√∂men, um eine reibungslose und rechtzeitige Wiedergabe der Medien zu gew√§hrleisten.
2. **RTCP (Real-time Transport Control Protocol)**: RTCP ist ein Begleitprotokoll zu RTP, das zur √úberwachung der Dienstqualit√§t (QoS) und zur Bereitstellung von R√ºckmeldungen √ºber die √úbertragung von Medienstr√∂men verwendet wird. Definiert im selben **RFC 3550** wie RTP, tauscht RTCP **periodisch Steuerungspakete zwischen den Teilnehmern einer RTP-Sitzung** aus. Es teilt Informationen wie Paketverlust, Jitter und Round-Trip-Zeit mit, die bei der Diagnose und Anpassung an Netzwerkbedingungen helfen und die Gesamtqualit√§t der Medien verbessern.
3. **SRTP (Secure Real-time Transport Protocol)**: SRTP ist eine Erweiterung von RTP, die **Verschl√ºsselung**, **Nachrichtenauthentifizierung** und **Wiederholungsschutz** f√ºr Medienstr√∂me bietet und so eine sichere √úbertragung sensibler Audio- und Videodaten gew√§hrleistet. Definiert in **RFC 3711**, verwendet SRTP kryptografische Algorithmen wie AES zur Verschl√ºsselung und HMAC-SHA1 zur Nachrichtenauthentifizierung. SRTP wird h√§ufig in Kombination mit sicheren Signalisierungsprotokollen wie SIP √ºber TLS verwendet, um Ende-zu-Ende-Sicherheit in der multimedialen Kommunikation zu bieten.
4. **ZRTP (Zimmermann Real-time Transport Protocol)**: ZRTP ist ein kryptographisches Schl√ºsselvereinbarungsprotokoll, das **Ende-zu-Ende-Verschl√ºsselung** f√ºr RTP-Medienstr√∂me bietet. Entwickelt von Phil Zimmermann, dem Sch√∂pfer von PGP, wird ZRTP in **RFC 6189** beschrieben. Im Gegensatz zu SRTP, das auf Signalisierungsprotokollen f√ºr den Schl√ºsselaustausch angewiesen ist, ist ZRTP so konzipiert, dass es unabh√§ngig vom Signalisierungsprotokoll funktioniert. Es verwendet den **Diffie-Hellman-Schl√ºsselaustausch**, um ein gemeinsames Geheimnis zwischen den kommunizierenden Parteien herzustellen, ohne dass vorheriges Vertrauen oder eine √∂ffentliche Schl√ºsselinfrastruktur (PKI) erforderlich ist. ZRTP enth√§lt auch Funktionen wie **Short Authentication Strings (SAS)** zum Schutz vor Man-in-the-Middle-Angriffen.

Diese Protokolle spielen eine wesentliche Rolle bei der **√úbermittlung und Sicherung von Echtzeit-Multimediakommunikation √ºber IP-Netzwerke**. W√§hrend RTP und RTCP die eigentliche Medien√ºbertragung und Qualit√§ts√ºberwachung √ºbernehmen, stellen SRTP und ZRTP sicher, dass die √ºbertragenen Medien vor Abh√∂ren, Manipulation und Wiederholungsangriffen gesch√ºtzt sind.
