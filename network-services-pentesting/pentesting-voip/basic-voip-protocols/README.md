# 基本的なVoIPプロトコル

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong>を通じてゼロからヒーローまでAWSハッキングを学ぶ！</summary>

HackTricksをサポートする他の方法：

- **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
- [**公式PEASS＆HackTricksスウォッグ**](https://peass.creator-spring.com)を入手する
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見る
- 💬 **Discordグループ**に**参加**する（https://discord.gg/hRep4RUj7f）または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦で**フォロー**する：[**@carlospolopm**](https://twitter.com/hacktricks_live)。

</details>

## シグナリングプロトコル

### SIP（Session Initiation Protocol）

これは業界標準であり、詳細については次を参照してください：

{% content-ref url="sip-session-initiation-protocol.md" %}
[sip-session-initiation-protocol.md](sip-session-initiation-protocol.md)
{% endcontent-ref %}

### MGCP（Media Gateway Control Protocol）

MGCP（Media Gateway Control Protocol）は、RFC 3435で概説された**シグナリング**および**コール** **コントロールプロトコル**です。これは、次の3つの主要コンポーネントで構成される中央集権型アーキテクチャで動作します：

1. **コールエージェントまたはメディアゲートウェイコントローラー（MGC）**：MGCPアーキテクチャのマスターゲートウェイは、**メディアゲートウェイの管理と制御**を担当します。通話の設定、変更、終了プロセスを処理します。 MGCはMGCPプロトコルを使用してメディアゲートウェイと通信します。
2. **メディアゲートウェイ（MG）またはスレーブゲートウェイ**：これらのデバイスは、異なるネットワーク間でデジタルメディアストリームを変換します。例：従来の回線交換電話網とパケット交換IPネットワーク。これらはMGCによって管理され、それから受け取ったコマンドを実行します。メディアゲートウェイには、トランスコーディング、パケット化、エコーキャンセルなどの機能が含まれる場合があります。
3. **シグナリングゲートウェイ（SG）**：これらのゲートウェイは、異なるネットワーク間でのシグナリングメッセージの変換を担当し、従来の電話システム（例：SS7）とIPベースのネットワーク（例：SIPまたはH.323）間のシームレスな通信を可能にします。シグナリングゲートウェイは、相互運用性を確保し、異なるネットワーク間で通話制御情報が適切に伝達されることを確認するために重要です。

要するに、MGCPは通話制御ロジックをコールエージェントに集約し、メディアおよびシグナリングゲートウェイの管理を簡素化し、通信ネットワークでのスケーラビリティ、信頼性、効率性を向上させます。

### SCCP（Skinny Client Control Protocol）

Skinny Client Control Protocol（SCCP）は、Cisco Systemsが所有する**プロプライエタリなシグナリングおよびコールコントロールプロトコル**です。主に**Cisco Unified Communications Manager**（以前はCallManagerとして知られていました）とCisco IP電話や他のCisco音声およびビデオエンドポイント間の通信に使用されます。

SCCPは、通話制御サーバーとエンドポイントデバイス間の通信を簡素化する軽量プロトコルです。その最小限の設計と他のVoIPプロトコル（H.323やSIPなど）と比較して帯域幅要件が少ないことから、「Skinny」と呼ばれています。

SCCPベースのシステムの主要コンポーネントは次のとおりです：

1. **コールコントロールサーバー**：通常はCisco Unified Communications Managerで、通話の設定、変更、終了プロセス、通話転送、通話転送、通話保留などの他の電話機能を管理します。
2. **SCCPエンドポイント**：これらは、SCCPを使用して通話制御サーバーと通信するIP電話、ビデオ会議ユニット、または他のCisco音声およびビデオエンドポイントなどのデバイスです。これらはサーバーに登録し、シグナリングメッセージを送受信し、通話処理のためにコールコントロールサーバーからの指示に従います。
3. **ゲートウェイ**：これらのデバイスは、従来の回線交換電話網とパケット交換IPネットワーク間でメディアストリームを変換する責任があります。トランスコーディングやエコーキャンセルなどの追加機能も含まれる場合があります。

SCCPは、Ciscoコールコントロールサーバーとエンドポイントデバイス間の簡単で効率的な通信方法を提供します。ただし、**SCCPはプロプライエタリプロトコル**であるため、非Ciscoシステムとの相互運用性が制限される可能性があります。そのような場合は、SIPなどの他の標準VoIPプロトコルがより適している場合があります。

### H.323

H.323は、IPベースのネットワークなどのパケット交換ネットワーク上での音声、ビデオ、データ会議を含むマルチメディア通信のための**プロトコルスイート**です。国際電気通信連合（ITU-T）によって開発され、マルチメディア通信セッションを管理する包括的なフレームワークを提供します。

H.323スイートの主要コンポーネントには次のものがあります：

1. **端末**：IP電話、ビデオ会議システム、またはソフトウェアアプリケーションなどのエンドポイントデバイスで、H.323をサポートし、マルチメディア通信セッションに参加できます。
2. **ゲートウェイ**：これらのデバイスは、従来の回線交換電話網とパケット交換IPネットワーク間でメディアストリームを変換し、H.323と他の通信システムとの間で相互運用性を実現します。トランスコーディングやエコーキャンセルなどの追加機能も含まれる場合があります。
3. **ゲートキーパー**：これらはH.323ネットワークでの通話制御および管理サービスを提供するオプションのコンポーネントです。アドレス変換、帯域幅管理、アドミッション制御などの機能を実行し、ネットワークリソースを管理および最適化するのに役立ちます。
4. **マルチポイントコントロールユニット（MCU）**：これらのデバイスは、複数のエンドポイントからのメディアストリームを管理およびミックスすることでマルチポイント会議を容易にします。MCUにより、ビデオレイアウト制御、音声アクティブスイッチング、連続プレゼンスなどの機能が可能になり、複数の参加者を持つ大規模な会議を開催できます。

H.323は、音声およびビデオコーデックを含むさまざまなオーディオおよびビデオコーデックをサポートし、転送、転送、保留、待機などのその他の補助サービスを提供します。VoIPの初期に広く採用されましたが、より現代的で柔軟なプロトコルである**Session Initiation Protocol（SIP）**などに徐々に置き換えられています。ただし、H.323は多くのレガシーシステムで使用され続けており、さまざまな機器ベンダーによってサポートされ続けています。

### IAX（Inter Asterisk eXchange）

IAX（Inter-Asterisk eXchange）は、Asterisk PBX（プライベートブランチ交換）サーバーと他のVoIPデバイス間の通信に主に使用される**シグナリングおよびコールコントロールプロトコル**です。AsteriskオープンソースPBXソフトウェアの作成者であるMark Spencerによって、SIPやH.323などの他のVoIPプロトコルの代替手段として開発されました。

IAXは、その**単純さ**、**効率性**、および**実装の容易さ**で知られています。IAXの主な特徴には次のものがあります：

1. **単一のUDPポート**：IAXは、シグナリングおよびメディアトラフィックの両方に単一のUDPポート（4569）を使用するため、ファイアウォールとNATトラバーサルを簡素化し、さまざまなネットワーク環境での展開を容易にします。
2. **バイナリプロトコル**：SIPなどのテキストベースのプロトコルとは異なり、IAXはバイナリプロトコルであり、帯域幅の消費を削減し、シグナリングおよびメディアデータの送信により効率的にします。
3. **トランキング**：IAXはトランキングをサポートし、複数の通話を単一のネットワーク接続に組み合わせることでオーバーヘッドを削減し、帯域幅の利用を向上させます。
4. **ネイティブ暗号化**：IAXは、RSAなどの暗号化のための鍵交換とAESなどのメディア暗号化のための暗号化を使用して、エンドポイント間のセキュアな通信を提供するための組み込みサポートを提供します。
5. **ピアツーピア通信**：IAXは、中央サーバーを必要とせずにエンドポイント間の直接通信に使用でき、よりシンプルで効率的な通話ルーティングを実現します。

IAXには、Asteriskエコシステムに主眼を置いていることや、SIPなどのより確立されたプロトコルと比較して普及が少ないという制限があります。その結果、IAXは非Asteriskシステムやデバイスとの相互運用性にとって最適な選択肢ではないかもしれません。ただし、Asterisk環境内で作業している場合、IAXはVoIP通信のための堅牢で効率的なソリューションを提供します。

## 伝送および輸送プロトコル

### SDP（Session Description Protocol）

SDP（Session Description Protocol）は、IPネットワーク上での音声、ビデオ、またはデータ会議などのマルチメディアセッションの特性を記述するために使用される**テキストベースの形式**です。これは**Internet Engineering Task Force（IETF）**によって開発され、**RFC 4566**で定義されています。SDPは実際のメディア伝送やセッション確立を処理しませんが、**SIP（Session Initiation Protocol）**などの他のシグナリングプロトコルと組み合わせて使用され、メディアストリームとその属性に関する情報を交渉および交換するために使用されます。

SDPの主要な要素には次のものがあります：

1. **セッション情報**：SDPは、セッション名、セッション説明、開始時間、終了時間など、マルチメディアセッションの詳細を記述します。
2. **メディアストリーム**：SDPは、メディアタイプ（オーディオ、ビデオ、またはテキスト）、トランスポートプロトコル（例：RTPまたはSRTP）、およびメディアフォーマット（例：コーデック情報）など、メディアストリームの特性を定義します。
3. **接続情報**：SDPは、メディアを送信または受信するネットワークアドレス（IPアドレス）およびポート番号に関する情報を提供します。
4. **属性**：SDPは、セ
