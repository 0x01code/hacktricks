# 기본 VoIP 프로토콜

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스왑**](https://peass.creator-spring.com)을 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)을 **팔로우**하세요.
* **Hacking 트릭을 공유하려면** [**HackTricks**](https://github.com/carlospolop/hacktricks) 및 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하세요.

</details>

## 시그널링 프로토콜

### SIP (세션 초기화 프로토콜)

이것은 산업 표준입니다. 자세한 정보는 다음을 참조하세요:

{% content-ref url="sip-session-initiation-protocol.md" %}
[sip-session-initiation-protocol.md](sip-session-initiation-protocol.md)
{% endcontent-ref %}

### MGCP (미디어 게이트웨이 제어 프로토콜)

MGCP (미디어 게이트웨이 제어 프로토콜)는 RFC 3435에서 설명된 **시그널링** 및 **통화 제어 프로토콜**입니다. 이는 세 개의 주요 구성 요소로 구성된 중앙 집중식 아키텍처에서 작동합니다.

1. **콜 에이전트 또는 미디어 게이트웨이 컨트롤러 (MGC)**: MGCP 아키텍처에서 마스터 게이트웨이로 MGC는 **미디어 게이트웨이를 관리하고 제어**하는 역할을 담당합니다. 콜 설정, 수정 및 종료 프로세스를 처리합니다. MGC는 MGCP 프로토콜을 사용하여 미디어 게이트웨이와 통신합니다.
2. **미디어 게이트웨이 (MG) 또는 슬레이브 게이트웨이**: 이러한 장치는 전통적인 회선 교환 전화망과 패킷 교환 IP 네트워크와 같은 다른 네트워크 간의 **디지털 미디어 스트림을 변환**합니다. 이들은 MGC에 의해 관리되며 그로부터 받은 명령을 실행합니다. 미디어 게이트웨이에는 트랜스코딩, 패킷화 및 에코 캔슬링과 같은 기능이 포함될 수 있습니다.
3. **시그널링 게이트웨이 (SG)**: 이 게이트웨이는 다른 네트워크 간의 **시그널링 메시지를 변환**하여 전통적인 전화 시스템 (예: SS7)과 IP 기반 네트워크 (예: SIP 또는 H.323) 간의 원활한 통신을 가능하게 합니다. 시그널링 게이트웨이는 상호 운용성을 위해 중요하며 다른 네트워크 간의 통화 제어 정보가 올바르게 통신되도록 보장합니다.

요약하면, MGCP는 콜 에이전트에서 통화 제어 논리를 중앙 집중화하여 미디어 및 시그널링 게이트웨이의 관리를 간소화하고 통신망에서 더 나은 확장성, 신뢰성 및 효율성을 제공합니다.

### SCCP (스키니 클라이언트 제어 프로토콜)

스키니 클라이언트 제어 프로토콜 (SCCP)은 Cisco Systems 소유의 **소프트웨어 및 통화 제어 프로토콜**입니다. 주로 Cisco Unified Communications Manager (이전에는 CallManager로 알려짐)와 Cisco IP 전화 또는 다른 Cisco 음성 및 비디오 엔드포인트 간의 통신에 **사용**됩니다.

SCCP는 최소한의 설계와 다른 VoIP 프로토콜 (예: H.323 또는 SIP)와 비교하여 대역폭 요구 사항이 줄어드는 것과 같은 특징으로 인해 "Skinny"라고 불립니다.

SCCP 기반 시스템의 주요 구성 요소는 다음과 같습니다.

1. **콜 제어 서버**: 일반적으로 Cisco Unified Communications Manager인 이 서버는 콜 설정, 수정 및 종료 프로세스를 관리하며 콜 전달, 콜 전송 및 콜 보류와 같은 기타 전화 기능도 처리합니다.
2. **SCCP 엔드포인트**: 이는 IP 전화, 비디오 회의 시스템 또는 다른 Cisco 음성 및 비디오 엔드포인트와 통신하기 위해 SCCP를 사용하는 장치입니다. 이들은 서버에 등록하고 시그널링 메시지를 보내고 받으며 콜 제어 서버에서 제공하는 지침에 따라 콜 처리를 수행합니다.
3. **게이트웨이**: 이러한 장치는 음성 게이트웨이 또는 미디어 게이트웨이와 같은 다른 네트워크 간의 미디어 스트림을 변환하는 역할을 담당합니다. 전통적인 회선 교환 전화망과 패킷 교환 IP 네트워크와 같은 다른 네트워크 간의 상호 운용성을 가능하게 할 수도 있습니다. 트랜스코딩이나 에코 캔슬링과 같은 추가 기능을 포함할 수도 있습니다.

SCCP는 Cisco 콜 제어 서버와 엔드포인트 장치 간의 간단하고 효율적인 통신 방법을 제공합니다. 그러나 SCCP는 **소유 프로토콜**이므로 비-Cisco 시스템과의 상호 운용성이 제한될 수 있습니다. 이러한 경우 SIP와 같은 다른 표준 VoIP 프로토콜이 더 적합할 수 있습니다.

### H.323

H.323는 IP 기반 네트워크와 같은 패킷 교환 네트워크를 통해 음성, 비디오 및 데이터 회의를 포함한 멀티미디어 통신을 위한 **프로토콜 스위트**입니다. 이는 국제 전기 통신 연합 (ITU-T)에서 개발되었으며 멀
## 전송 및 전송 프로토콜

### SDP (세션 설명 프로토콜)

SDP (세션 설명 프로토콜)는 IP 네트워크 상에서 음성, 비디오 또는 데이터 회의와 같은 멀티미디어 세션의 특성을 설명하기 위해 사용되는 **텍스트 기반 형식**입니다. 이는 **인터넷 공학 작업국 (IETF)**에 의해 개발되었으며 **RFC 4566**에서 정의되었습니다. SDP는 실제 미디어 전송이나 세션 설정을 처리하지 않지만, 다른 시그널링 프로토콜인 **SIP (세션 시작 프로토콜)**와 함께 사용되어 미디어 스트림 및 해당 속성에 대한 정보를 협상하고 교환하는 데 사용됩니다.

SDP의 주요 요소는 다음과 같습니다:

1. **세션 정보**: SDP는 세션 이름, 세션 설명, 시작 시간 및 종료 시간을 포함한 멀티미디어 세션의 세부 정보를 설명합니다.
2. **미디어 스트림**: SDP는 미디어 스트림의 특성을 정의합니다. 예를 들어 미디어 유형 (오디오, 비디오 또는 텍스트), 전송 프로토콜 (예: RTP 또는 SRTP) 및 미디어 형식 (예: 코덱 정보)입니다.
3. **연결 정보**: SDP는 미디어를 보내거나 받을 네트워크 주소 (IP 주소) 및 포트 번호에 대한 정보를 제공합니다.
4. **속성**: SDP는 세션 또는 미디어 스트림에 대한 추가적인 선택적 정보를 제공하기 위해 속성의 사용을 지원합니다. 속성은 암호화 키, 대역폭 요구 사항 또는 미디어 제어 메커니즘과 같은 다양한 기능을 지정하는 데 사용될 수 있습니다.

SDP는 일반적으로 다음과 같은 과정에서 사용됩니다:

1. 시작하는 당사자는 제안된 멀티미디어 세션에 대한 SDP 설명을 생성합니다. 이는 미디어 스트림 및 해당 속성의 세부 정보를 포함합니다.
2. SDP 설명은 일반적으로 SIP 또는 RTSP와 같은 시그널링 프로토콜 메시지 내에 포함되어 수신하는 당사자에게 전송됩니다.
3. 수신하는 당사자는 SDP 설명을 처리하고, 자신의 기능에 따라 제안된 세션을 수락, 거부 또는 수정할 수 있습니다.
4. 최종 SDP 설명은 시그널링 프로토콜 메시지의 일부로 시작하는 당사자에게 다시 전송되어 협상 프로세스를 완료합니다.

SDP의 간결성과 유연성은 다양한 통신 시스템에서 실시간 멀티미디어 세션을 설명하는 데 널리 채택되는 표준으로서의 역할을 수행하며, IP 네트워크 상에서 실시간 멀티미디어 세션을 설정하고 관리하는 데 중요한 역할을 합니다.

### RTP / RTCP / SRTP / ZRTP

1. **RTP (실시간 전송 프로토콜)**: RTP는 IP 네트워크 상에서 오디오 및 비디오 데이터 또는 기타 실시간 미디어의 전달을 위해 설계된 네트워크 프로토콜입니다. **IETF**에 의해 개발되었으며 **RFC 3550**에서 정의되었습니다. RTP는 주로 SIP 및 H.323와 같은 시그널링 프로토콜과 함께 사용되어 멀티미디어 통신을 가능하게 합니다. RTP는 미디어 스트림의 **동기화**, **순서 지정**, 및 **타임스탬프**에 대한 메커니즘을 제공하여 원활하고 적시에 미디어 재생을 보장합니다.
2. **RTCP (실시간 전송 제어 프로토콜)**: RTCP는 RTP의 동반 프로토콜로, 미디어 스트림의 서비스 품질 (QoS)을 모니터링하고 미디어 스트림의 전송에 대한 피드백을 제공하는 데 사용됩니다. RTP와 동일한 **RFC 3550**에서 정의된 RTCP는 RTP 세션 참가자 간에 주기적으로 제어 패킷을 교환합니다. 이는 패킷 손실, 지연, 왕복 시간과 같은 정보를 공유하여 네트워크 상태를 진단하고 적응하여 전체적인 미디어 품질을 향상시킵니다.
3. **SRTP (보안 실시간 전송 프로토콜)**: SRTP는 RTP의 확장으로, 민감한 오디오 및 비디오 데이터의 안전한 전송을 보장하기 위한 **암호화**, **메시지 인증**, 및 **재생 방지**를 제공합니다. **RFC 3711**에서 정의된 SRTP는 암호화에 AES와 같은 암호화 알고리즘, 메시지 인증에 HMAC-SHA1과 같은 암호화 알고리즘을 사용합니다. SRTP는 종종 SIP over TLS와 같은 안전한 시그널링 프로토콜과 함께 사용되어 멀티미디어 통신에서 종단 간 보안을 제공합니다.
4. **ZRTP (Zimmermann 실시간 전송 프로토콜)**: ZRTP는 RTP 미디어 스트림에 대한 **종단 간 암호화**를 제공하는 암호화 키 합의 프로토콜입니다. PGP의 창시자인 Phil Zimmermann에 의해 개발된 ZRTP는 **RFC 6189**에서 설명되어 있습니다. SRTP와 달리 키 교환을 위해 시그널링 프로토콜에 의존하지 않도록 설계된 ZRTP는 통신하는 당사자 간에 신뢰나 공개 키 인프라 (PKI)를 요구하지 않고 **Diffie-Hellman 키 교환**을 사용하여 공유 비밀을 설정합니다. ZRTP는 중간자 공격에 대한 보호를 위해 **짧은 인증 문자열 (SAS)**과 같은 기능도 포함하고 있습니다.

이러한 프로토콜은 IP 네트워크 상에서 **실시간 멀티미디어 통신을 전달하고 보안하는 데 필수적인 역할**을 합니다. RTP와 RTCP는 실제 미디어 전송과 품질 모니터링을 처리하며, SRTP와 ZRTP는 도청, 조작 및 재생 공격으로부터 전송된 미디어를 보호합니다.
