# 基本的なVoIPプロトコル

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* **サイバーセキュリティ企業**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。
* [**公式のPEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**をフォロー**してください。
* **ハッキングのトリックを共有する**ために、[**hacktricksリポジトリ**](https://github.com/carlospolop/hacktricks)と[**hacktricks-cloudリポジトリ**](https://github.com/carlospolop/hacktricks-cloud)にPRを提出してください。

</details>

## シグナリングプロトコル

### SIP（セッション開始プロトコル）

これは業界標準です。詳細については次を参照してください：

{% content-ref url="sip-session-initiation-protocol.md" %}
[sip-session-initiation-protocol.md](sip-session-initiation-protocol.md)
{% endcontent-ref %}

### MGCP（メディアゲートウェイ制御プロトコル）

MGCP（メディアゲートウェイ制御プロトコル）は、RFC 3435で概説された**シグナリング**および**コール制御プロトコル**です。MGCPは中央集権型アーキテクチャで動作し、次の3つの主要なコンポーネントで構成されています：

1. **コールエージェントまたはメディアゲートウェイコントローラ（MGC）**：MGCPアーキテクチャのマスターゲートウェイであり、**メディアゲートウェイの管理と制御**を担当します。通話のセットアップ、変更、終了プロセスを処理します。MGCはMGCPプロトコルを使用してメディアゲートウェイと通信します。
2. **メディアゲートウェイ（MG）またはスレーブゲートウェイ**：これらのデバイスは、従来の回線交換電話網とパケット交換IPネットワークなど、異なるネットワーク間のデジタルメディアストリームを変換します。MGCによって管理され、それから受け取ったコマンドを実行します。メディアゲートウェイには、トランスコーディング、パケット化、エコーキャンセルなどの機能が含まれる場合があります。
3. **シグナリングゲートウェイ（SG）**：これらのゲートウェイは、異なるネットワーク間のシグナリングメッセージを変換し、従来の電話システム（例：SS7）とIPベースのネットワーク（例：SIPまたはH.323）との間でシームレスな通信を可能にします。シグナリングゲートウェイは相互運用性を確保し、異なるネットワーク間で通話制御情報が適切に伝達されるようにします。

要約すると、MGCPは通信エージェントで通話制御ロジックを集中させることにより、メディアおよびシグナリングゲートウェイの管理を簡素化し、通信ネットワークのスケーラビリティ、信頼性、効率性を向上させます。

### SCCP（スキニークライアント制御プロトコル）

スキニークライアント制御プロトコル（SCCP）は、Cisco Systemsが所有する**プロプライエタリなシグナリングおよびコール制御プロトコル**です。これは主にCisco Unified Communications Manager（旧称CallManager）とCisco IP電話または他のCisco音声およびビデオエンドポイント間の通信に使用されます。

SCCPは、通話制御サーバーとエンドポイントデバイス間の通信を簡素化する軽量なプロトコルです。その名前の由来は、その最小限の設計と他のVoIPプロトコル（H.323やSIPなど）と比較して低い帯域幅要件にあります。

SCCPベースのシステムの主要なコンポーネントは次のとおりです：

1. **コール制御サーバー**：通常はCisco Unified Communications Managerで、通話のセットアップ、変更、終了プロセス、通話転送、通話転送、通話保留などの他の電話機能を管理します。
2. **SCCPエンドポイント**：これらは、IP電話、ビデオ会議ユニット、または他のCisco音声およびビデオエンドポイントなど、SCCPを使用して通話制御サーバーと通信するデバイスです。サーバーに登録し、シグナリングメッセージを送受信し、通話処理のために通話制御サーバーからの指示に従います。
3. **ゲートウェイ**：これらのデバイスは、従来の回線交換電話網とパケット交換IPネットワークなど、異なるネットワーク間のメディアストリームを変換する責任があります。トランスコーディングやエコーキャンセルなどの追加機能も含まれる場合があります。

SCCPは、Ciscoの通話制御サーバーとエンドポイントデバイス間の簡単で効率的な通信手段を提供します。ただし、SCCPは**プロプライエタリなプロトコル**であるため、非Ciscoシステムとの相互運用性が制限されることがあります。その場合、SIPなどの他の標準のVoIPプロトコルがより適している場合があります。

### H.323

H.323は、IPベースのネットワークなどのパケット交換ネットワークを介した音声、ビデオ、データ会議などのマルチメディア通信のための**プロトコルスイート**です。これは国際電気通信連合（ITU-T）によって開発され、マルチメディア通信セッションの管理のための包括的なフレ
### IAX（Inter Asterisk eXchange）

IAX（Inter-Asterisk eXchange）は、Asterisk PBX（Private Branch Exchange）サーバーと他のVoIPデバイス間の通信に主に使用される**シグナリングおよび通話制御プロトコル**です。AsteriskオープンソースPBXソフトウェアの作成者であるMark Spencerによって開発され、SIPやH.323などの他のVoIPプロトコルの代替として提供されました。

IAXは、**シンプルさ、効率性、実装の容易さ**で知られています。IAXの主な特徴には次のものがあります：

1. **単一のUDPポート**：IAXは、シグナリングとメディアトラフィックの両方に単一のUDPポート（4569）を使用するため、ファイアウォールとNATトラバーサルが簡素化され、さまざまなネットワーク環境での展開が容易になります。
2. **バイナリプロトコル**：SIPのようなテキストベースのプロトコルとは異なり、IAXはバイナリプロトコルです。これにより、シグナリングとメディアデータの送信がより効率的になり、帯域幅の消費が削減されます。
3. **トランキング**：IAXはトランキングをサポートしており、複数の通話を単一のネットワーク接続に組み合わせることができます。これによりオーバーヘッドが削減され、帯域幅の利用が向上します。
4. **ネイティブ暗号化**：IAXは、RSAなどの鍵交換のための暗号化とAESなどのメディア暗号化を使用した組み込みの暗号化サポートを持っており、エンドポイント間の安全な通信を提供します。
5. **ピアツーピア通信**：IAXは、中央サーバーなしでエンドポイント間の直接通信に使用することができます。これにより、よりシンプルで効率的な呼び出しルーティングが可能になります。

利点にもかかわらず、IAXにはいくつかの制限があります。Asteriskエコシステムへの主な焦点や、SIPなどのより確立されたプロトコルと比較して広く採用されていないなどの制限があります。そのため、非Asteriskシステムやデバイスとの相互運用性を考慮する場合、IAXは最適な選択肢ではないかもしれません。ただし、Asterisk環境内で作業する場合、IAXはVoIP通信のための堅牢で効率的なソリューションを提供します。

## 伝送およびトランスポートプロトコル

### SDP（セッション記述プロトコル）

SDP（セッション記述プロトコル）は、IPネットワーク上の音声、ビデオ、データ会議などのマルチメディアセッションの特性を記述するために使用される**テキストベースの形式**です。これは**Internet Engineering Task Force（IETF）**によって開発され、**RFC 4566**で定義されています。SDPは実際のメディア伝送やセッションの確立を処理しませんが、他のシグナリングプロトコル（SIPなど）と組み合わせて使用され、メディアストリームとその属性に関する情報を交渉および交換するために使用されます。

SDPの主な要素には次のものがあります：

1. **セッション情報**：SDPは、セッション名、セッションの説明、開始時刻、終了時刻など、マルチメディアセッションの詳細を記述します。
2. **メディアストリーム**：SDPは、メディアタイプ（音声、ビデオ、テキストなど）、トランスポートプロトコル（RTPやSRTPなど）、メディアフォーマット（コーデック情報など）など、メディアストリームの特性を定義します。
3. **接続情報**：SDPは、メディアを送信または受信するためのネットワークアドレス（IPアドレス）とポート番号に関する情報を提供します。
4. **属性**：SDPは、セッションやメディアストリームに関する追加のオプション情報を提供するために属性の使用をサポートしています。属性は、暗号化キー、帯域幅要件、メディア制御メカニズムなど、さまざまな機能の指定に使用できます。

SDPは通常、次のプロセスで使用されます：

1. 発信側は、提案されたマルチメディアセッションのSDP記述を作成し、メディアストリームとその属性の詳細を含めます。
2. SDP記述は、通常はSIPやRTSPなどのシグナリングプロトコルメッセージに埋め込まれて、受信側に送信されます。
3. 受信側は、SDP記述を処理し、その機能に基づいて提案されたセッションを受け入れるか、拒否するか、変更するかを決定します。
4. 最終的なSDP記述は、シグナリングプロトコルメッセージの一部として発信側に送信され、交渉プロセスが完了します。

SDPのシンプルさと柔軟性により、さまざまな通信システムでマルチメディアセッションを記述するための広く採用された標準となっており、IPネットワーク上のリアルタイムマルチメディアセッションの確立と管理に重要な役割を果たしています。

### RTP / RTCP / SRTP / ZRTP

1. **RTP（Real-time Transport Protocol）**：RTPは、IPネットワーク上で音声やビデオデータなどのリアルタイムメディアを配信するために設計されたネットワークプロトコルです。**IETF**によって開発され、**RFC 3550**で定義されています。RTPは、SIPやH.323などのシグナリングプロトコルと共に使用され、マルチメディア通信を可能にします。RTPは、メディアストリームの**同期**、**シーケンス**、**タイムスタンプ**を提供するメカニズムを提供し、スムーズでタイムリーなメディア再生を確保します。
2. **RTCP（Real-time Transport Control Protocol）**：RTCPは、RTPの補完プロトコルであり、メディアストリームの品質監視（QoS）およびメディアストリームの送信に関するフィードバックを提供するために使用されます。RTPと同じ**RFC 3550**で定義されているRTCPは、RTPセッションの参加者間で定期的に制御パケットを交換します。パケットロス、ジッター、ラウンドトリップタイムなどの情報を共有し、ネットワークの状態を診断し適応することで、全体的なメディア品質を向上させます。
3. **SRTP（Secure Real-time Transport Protocol）**：
* [💬](https://emojipedia.org/speech-balloon/) [Discordグループ](https://discord.gg/hRep4RUj7f)に参加するか、[Telegramグループ](https://t.me/peass)に参加するか、[Twitter](https://twitter.com/hacktricks_live)で私をフォローしてください[🐦](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[@carlospolopm](https://twitter.com/hacktricks_live)。

* ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)にPRを提出してください。
