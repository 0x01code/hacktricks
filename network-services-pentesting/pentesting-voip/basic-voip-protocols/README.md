# Protocoles VoIP de base

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert AWS Red Team de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

### [WhiteIntel](https://whiteintel.io)

<figure><img src="/.gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) est un moteur de recherche aliment√© par le **dark web** qui offre des fonctionnalit√©s **gratuites** pour v√©rifier si une entreprise ou ses clients ont √©t√© **compromis** par des **logiciels malveillants voleurs**.

Le but principal de WhiteIntel est de lutter contre les prises de contr√¥le de compte et les attaques de ransomware r√©sultant de logiciels malveillants volant des informations.

Vous pouvez consulter leur site Web et essayer leur moteur **gratuitement** sur :

{% embed url="https://whiteintel.io" %}

---

## Protocoles de signalisation

### SIP (Session Initiation Protocol)

Il s'agit de la norme de l'industrie, pour plus d'informations, consultez :

{% content-ref url="sip-session-initiation-protocol.md" %}
[sip-session-initiation-protocol.md](sip-session-initiation-protocol.md)
{% endcontent-ref %}

### MGCP (Media Gateway Control Protocol)

MGCP (Media Gateway Control Protocol) est un **protocole de signalisation** et de **contr√¥le d'appel** d√©crit dans la RFC 3435. Il fonctionne dans une architecture centralis√©e, qui se compose de trois composants principaux :

1. **Agent d'appel ou Contr√¥leur de passerelle multim√©dia (MGC)** : La passerelle ma√Ætre dans l'architecture MGCP est responsable de **la gestion et du contr√¥le des passerelles multim√©dias**. Elle g√®re les processus de configuration, de modification et de terminaison des appels. Le MGC communique avec les passerelles multim√©dias en utilisant le protocole MGCP.
2. **Passerelles multim√©dias (MG) ou Passerelles esclaves** : Ces appareils **convertissent les flux multim√©dias num√©riques entre diff√©rents r√©seaux**, tels que la t√©l√©phonie commut√©e traditionnelle et les r√©seaux IP commut√©s par paquets. Ils sont g√©r√©s par le MGC et ex√©cutent les commandes re√ßues de celui-ci. Les passerelles multim√©dias peuvent inclure des fonctions telles que le transcodage, la mise en paquets et l'annulation d'√©cho.
3. **Passerelles de signalisation (SG)** : Ces passerelles sont responsables de **la conversion des messages de signalisation entre diff√©rents r√©seaux**, permettant une communication transparente entre les syst√®mes de t√©l√©phonie traditionnels (par ex., SS7) et les r√©seaux bas√©s sur IP (par ex., SIP ou H.323). Les passerelles de signalisation sont cruciales pour l'interop√©rabilit√© et garantissent que les informations de contr√¥le d'appel sont correctement communiqu√©es entre les diff√©rents r√©seaux.

En r√©sum√©, le MGCP centralise la logique de contr√¥le d'appel dans l'agent d'appel, ce qui simplifie la gestion des passerelles multim√©dias et de signalisation, offrant une meilleure √©volutivit√©, fiabilit√© et efficacit√© dans les r√©seaux de t√©l√©communication.

### SCCP (Skinny Client Control Protocol)

Le protocole de contr√¥le client l√©ger (SCCP) est un **protocole de signalisation et de contr√¥le d'appel propri√©taire** d√©tenu par Cisco Systems. Il est principalement **utilis√©** pour la communication entre le **Cisco Unified Communications Manager** (anciennement CallManager) et les t√©l√©phones IP Cisco ou d'autres terminaux voix et vid√©o Cisco.

SCCP est un protocole l√©ger qui simplifie la communication entre le serveur de contr√¥le d'appel et les terminaux. Il est appel√© "Skinny" en raison de sa conception minimaliste et de ses exigences en bande passante r√©duites par rapport √† d'autres protocoles VoIP comme H.323 ou SIP.

Les principaux composants d'un syst√®me bas√© sur SCCP sont :

1. **Serveur de contr√¥le d'appel** : Ce serveur, g√©n√©ralement un Cisco Unified Communications Manager, g√®re les processus de configuration, de modification et de terminaison des appels, ainsi que d'autres fonctionnalit√©s t√©l√©phoniques telles que le renvoi d'appel, le transfert d'appel et la mise en attente.
2. **Terminaux SCCP** : Il s'agit de dispositifs tels que les t√©l√©phones IP, les unit√©s de visioconf√©rence ou d'autres terminaux voix et vid√©o Cisco qui utilisent SCCP pour communiquer avec le serveur de contr√¥le d'appel. Ils s'enregistrent aupr√®s du serveur, envoient et re√ßoivent des messages de signalisation, et suivent les instructions fournies par le serveur de contr√¥le d'appel pour la gestion des appels.
3. **Passerelles** : Ces dispositifs, tels que les passerelles voix ou multim√©dias, sont responsables de la conversion des flux multim√©dias entre diff√©rents r√©seaux, comme la t√©l√©phonie commut√©e traditionnelle et les r√©seaux IP commut√©s par paquets. Ils peuvent √©galement inclure des fonctionnalit√©s suppl√©mentaires, telles que le transcodage ou l'annulation d'√©cho.

SCCP offre une m√©thode de communication simple et efficace entre les serveurs de contr√¥le d'appel Cisco et les terminaux. Cependant, il convient de noter que **SCCP est un protocole propri√©taire**, ce qui peut limiter l'interop√©rabilit√© avec les syst√®mes non-Cisco. Dans de tels cas, d'autres protocoles VoIP standard comme SIP peuvent √™tre plus adapt√©s.

### H.323

H.323 est un **ensemble de protocoles** pour la communication multim√©dia, comprenant la voix, la vid√©o et la conf√©rence de donn√©es sur des r√©seaux commut√©s par paquets, tels que les r√©seaux bas√©s sur IP. Il a √©t√© d√©velopp√© par l'**Union internationale des t√©l√©communications** (UIT-T) et fournit un cadre complet pour la gestion des sessions de communication multim√©dia.

Certains composants cl√©s de la suite H.323 comprennent :

1. **Terminaux** : Il s'agit de dispositifs terminaux, tels que les t√©l√©phones IP, les syst√®mes de visioconf√©rence ou les applications logicielles, qui prennent en charge H.323 et peuvent participer √† des sessions de communication multim√©dia.
2. **Passerelles** : Ces dispositifs convertissent les flux multim√©dias entre diff√©rents r√©seaux, comme la t√©l√©phonie commut√©e traditionnelle et les r√©seaux IP commut√©s par paquets, permettant l'interop√©rabilit√© entre H.323 et d'autres syst√®mes de communication. Ils peuvent √©galement inclure des fonctionnalit√©s suppl√©mentaires, telles que le transcodage ou l'annulation d'√©cho.
3. **Contr√¥leurs de passerelle** : Il s'agit de composants facultatifs qui fournissent des services de contr√¥le et de gestion d'appels dans un r√©seau H.323. Ils effectuent des fonctions telles que la traduction d'adresses, la gestion de la bande passante et le contr√¥le d'admission, aidant √† g√©rer et √† optimiser les ressources r√©seau.
4. **Unit√©s de contr√¥le multipoint (MCU)** : Ces dispositifs facilitent les conf√©rences multipoint en g√©rant et en m√©langeant les flux multim√©dias de plusieurs terminaux. Les MCU permettent des fonctionnalit√©s telles que le contr√¥le de la disposition vid√©o, la commutation activ√©e par la voix et la pr√©sence continue, permettant d'organiser des conf√©rences √† grande √©chelle avec plusieurs participants.

H.323 prend en charge une gamme de codecs audio et vid√©o, ainsi que d'autres services suppl√©mentaires comme le renvoi d'appel, le transfert d'appel, la mise en attente et l'attente d'appel. Malgr√© son adoption g√©n√©ralis√©e au d√©but de la VoIP, H.323 a √©t√© progressivement remplac√© par des protocoles plus modernes et flexibles comme le **protocole d'initiation de session (SIP)**, qui offre une meilleure interop√©rabilit√© et une mise en ≈ìuvre plus facile. Cependant, H.323 reste utilis√© dans de nombreux syst√®mes h√©rit√©s et continue d'√™tre pris en charge par divers fournisseurs d'√©quipements.

### IAX (Inter Asterisk eXchange)

IAX (Inter-Asterisk eXchange) est un **protocole de signalisation et de contr√¥le d'appel** principalement utilis√© pour la communication entre les serveurs Asterisk PBX (Private Branch Exchange) et d'autres dispositifs VoIP. Il a √©t√© d√©velopp√© par Mark Spencer, le cr√©ateur du logiciel PBX open source Asterisk, comme une alternative √† d'autres protocoles VoIP comme SIP et H.323.

IAX est connu pour sa **simplicit√©, son efficacit√© et sa facilit√© de mise en ≈ìuvre**. Certaines caract√©ristiques cl√©s de l'IAX comprennent :

1. **Port UDP unique** : IAX utilise un seul port UDP (4569) pour le trafic de signalisation et de m√©dia, ce qui simplifie le travers√©e des pare-feu et des NAT, facilitant le d√©ploiement dans divers environnements r√©seau.
2. **Protocole binaire** : Contrairement aux protocoles bas√©s sur du texte comme SIP, IAX est un protocole binaire, ce qui r√©duit sa consommation de bande passante et le rend plus efficace pour la transmission de donn√©es de signalisation et de m√©dia.
3. **Troncage** : IAX prend en charge le troncage, ce qui permet de combiner plusieurs appels en une seule connexion r√©seau, r√©duisant les frais g√©n√©raux et am√©liorant l'utilisation de la bande passante.
4. **Chiffrement natif** : IAX prend en charge le chiffrement int√©gr√©, en utilisant des m√©thodes comme RSA pour l'√©change de cl√©s et AES pour le chiffrement des m√©dias, assurant une communication s√©curis√©e entre les points d'extr√©mit√©.
5. **Communication peer-to-peer** : IAX peut √™tre utilis√© pour une communication directe entre les points d'extr√©mit√© sans n√©cessiter de serveur central, permettant un routage d'appel plus simple et plus efficace.

Malgr√© ses avantages, IAX pr√©sente certaines limitations, telles que son accent principal sur l'√©cosyst√®me Asterisk et une adoption moins r√©pandue par rapport √† des protocoles plus √©tablis comme SIP. En cons√©quence, IAX pourrait ne pas √™tre le meilleur choix pour l'interop√©rabilit√© avec des syst√®mes ou des dispositifs non-Asterisk. Cependant, pour ceux travaillant dans l'environnement Asterisk, IAX offre une solution robuste et efficace pour la communication VoIP.
## Protocoles de transmission et de transport

### SDP (Session Description Protocol)

SDP (Session Description Protocol) est un **format bas√© sur du texte** utilis√© pour d√©crire les caract√©ristiques des sessions multim√©dias, telles que la voix, la vid√©o ou la conf√©rence de donn√©es, sur les r√©seaux IP. Il a √©t√© d√©velopp√© par le **Groupe de travail d'ing√©nierie de l'Internet (IETF)** et est d√©fini dans le **RFC 4566**. SDP ne g√®re pas la transmission r√©elle des m√©dias ou l'√©tablissement de session, mais est utilis√© en conjonction avec d'autres protocoles de signalisation, comme **SIP (Session Initiation Protocol)**, pour n√©gocier et √©changer des informations sur les flux m√©dias et leurs attributs.

Certains √©l√©ments cl√©s de SDP comprennent :

1. **Informations sur la session** : SDP d√©crit les d√©tails d'une session multim√©dia, y compris le nom de la session, la description de la session, l'heure de d√©but et l'heure de fin.
2. **Flux m√©dias** : SDP d√©finit les caract√©ristiques des flux m√©dias, tels que le type de m√©dia (audio, vid√©o ou texte), le protocole de transport (par exemple, RTP ou SRTP) et le format m√©dia (par exemple, informations sur le codec).
3. **Informations de connexion** : SDP fournit des informations sur l'adresse r√©seau (adresse IP) et le num√©ro de port o√π les m√©dias doivent √™tre envoy√©s ou re√ßus.
4. **Attributs** : SDP prend en charge l'utilisation d'attributs pour fournir des informations suppl√©mentaires facultatives sur une session ou un flux m√©dia. Les attributs peuvent √™tre utilis√©s pour sp√©cifier diverses fonctionnalit√©s telles que les cl√©s de chiffrement, les exigences de bande passante ou les m√©canismes de contr√¥le des m√©dias.

SDP est g√©n√©ralement utilis√© dans le processus suivant :

1. Une partie initiatrice cr√©e une description SDP de la session multim√©dia propos√©e, y compris les d√©tails des flux m√©dias et de leurs attributs.
2. La description SDP est envoy√©e √† la partie r√©ceptrice, g√©n√©ralement int√©gr√©e dans un message de protocole de signalisation comme SIP ou RTSP.
3. La partie r√©ceptrice traite la description SDP, et en fonction de ses capacit√©s, elle peut accepter, rejeter ou modifier la session propos√©e.
4. La description SDP finale est renvoy√©e √† la partie initiatrice dans le cadre du message de protocole de signalisation, compl√©tant le processus de n√©gociation.

La simplicit√© et la flexibilit√© de SDP en font une norme largement adopt√©e pour d√©crire des sessions multim√©dias dans divers syst√®mes de communication, jouant un r√¥le crucial dans l'√©tablissement et la gestion de sessions multim√©dias en temps r√©el sur les r√©seaux IP.

### RTP / RTCP / SRTP / ZRTP

1. **RTP (Real-time Transport Protocol)** : RTP est un protocole r√©seau con√ßu pour la livraison de donn√©es audio et vid√©o, ou d'autres m√©dias en temps r√©el, sur les r√©seaux IP. D√©velopp√© par l'**IETF** et d√©fini dans le **RFC 3550**, RTP est couramment utilis√© avec des protocoles de signalisation comme SIP et H.323 pour permettre la communication multim√©dia. RTP fournit des m√©canismes de **synchronisation**, de **s√©quen√ßage** et d'**horodatage** des flux m√©dias, contribuant √† assurer une lecture fluide et opportune des m√©dias.
2. **RTCP (Real-time Transport Control Protocol)** : RTCP est un protocole compagnon de RTP, utilis√© pour surveiller la qualit√© de service (QoS) et fournir des retours sur la transmission des flux m√©dias. D√©fini dans le m√™me **RFC 3550** que RTP, RTCP **√©change p√©riodiquement des paquets de contr√¥le entre les participants √† une session RTP**. Il partage des informations telles que la perte de paquets, le jitter et le temps de propagation, ce qui aide √† diagnostiquer et √† s'adapter aux conditions du r√©seau, am√©liorant ainsi la qualit√© globale des m√©dias.
3. **SRTP (Secure Real-time Transport Protocol)** : SRTP est une extension de RTP qui fournit **le chiffrement**, **l'authentification des messages** et **la protection contre les rejeux** pour les flux m√©dias, assurant une transmission s√©curis√©e des donn√©es audio et vid√©o sensibles. D√©fini dans le **RFC 3711**, SRTP utilise des algorithmes cryptographiques comme AES pour le chiffrement et HMAC-SHA1 pour l'authentification des messages. SRTP est souvent utilis√© en combinaison avec des protocoles de signalisation s√©curis√©s comme SIP sur TLS pour fournir une s√©curit√© de bout en bout dans la communication multim√©dia.
4. **ZRTP (Zimmermann Real-time Transport Protocol)** : ZRTP est un protocole d'accord de cl√© cryptographique qui fournit **le chiffrement de bout en bout** pour les flux m√©dias RTP. D√©velopp√© par Phil Zimmermann, le cr√©ateur de PGP, ZRTP est d√©crit dans le **RFC 6189**. Contrairement √† SRTP, qui repose sur des protocoles de signalisation pour l'√©change de cl√©s, ZRTP est con√ßu pour fonctionner ind√©pendamment du protocole de signalisation. Il utilise **l'√©change de cl√©s Diffie-Hellman** pour √©tablir un secret partag√© entre les parties communicantes, sans n√©cessiter de confiance pr√©alable ou d'infrastructure de cl√©s publiques (PKI). ZRTP inclut √©galement des fonctionnalit√©s telles que les **Cha√Ænes d'authentification courtes (SAS)** pour se prot√©ger contre les attaques de l'homme du milieu.

Ces protocoles jouent des r√¥les essentiels dans **la livraison et la s√©curisation de la communication multim√©dia en temps r√©el sur les r√©seaux IP**. Alors que RTP et RTCP g√®rent la transmission r√©elle des m√©dias et la surveillance de la qualit√©, SRTP et ZRTP veillent √† ce que les m√©dias transmis soient prot√©g√©s contre l'√©coute, la manipulation et les attaques de rejeu.
