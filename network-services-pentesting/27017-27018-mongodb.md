# 27017,27018 - –ü–µ–Ω—Ç–µ—Å—Ç–∏–Ω–≥ MongoDB

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) —Å–µ—Ä–≤–µ—Ä–∞, —â–æ–± —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ —Ç–∞ –º–∏—Å–ª–∏–≤—Ü—è–º–∏ –∑–∞ –±–∞–≥–∞–º–∏!

**–Ü–Ω—Å–∞–π—Ç–∏ —â–æ–¥–æ –•–∞–∫—ñ–Ω–≥—É**\
–í–∑–∞—î–º–æ–¥—ñ–π—Ç–µ –∑ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º, —è–∫–∏–π –¥–æ—Å–ª—ñ–¥–∂—É—î –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫–∏ —Ö–∞–∫—ñ–Ω–≥—É

**–ù–æ–≤–∏–Ω–∏ –ø—Ä–æ –•–∞–∫—ñ–Ω–≥ —É –†–µ–∞–ª—å–Ω–æ–º—É –ß–∞—Å—ñ**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ —à–≤–∏–¥–∫–æ–∑–º—ñ–Ω–Ω–æ–≥–æ —Å–≤—ñ—Ç—É —Ö–∞–∫—ñ–Ω–≥—É –∑–∞–≤–¥—è–∫–∏ –Ω–æ–≤–∏–Ω–∞–º —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∞–º —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–û—Å—Ç–∞–Ω–Ω—ñ –û–≥–æ–ª–æ—à–µ–Ω–Ω—è**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ –Ω–∞–π–Ω–æ–≤—ñ—à–∏—Ö –±–∞–≥-–±–∞—É–Ω—Ç—ñ, —è–∫—ñ –∑–∞–ø—É—Å–∫–∞—é—Ç—å—Å—è, —Ç–∞ –≤–∞–∂–ª–∏–≤–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏

**–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞** [**Discord**](https://discord.com/invite/N3FrSbmwdy) —Ç–∞ –ø–æ—á–Ω—ñ—Ç—å —Å–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ —Ç–æ–ø–æ–≤–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!

## –û—Å–Ω–æ–≤–Ω–∞ –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

**MongoDB** - —Ü–µ **—Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–∏—Ö –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –≤–∏—Ö—ñ–¥–Ω–∏–º –∫–æ–¥–æ–º**, —è–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **–º–æ–¥–µ–ª—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, –æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω—É –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏**, –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ä—ñ–∑–Ω–∏—Ö —Ñ–æ—Ä–º –¥–∞–Ω–∏—Ö. –í–æ–Ω–∞ –ø—Ä–æ–ø–æ–Ω—É—î –≥–Ω—É—á–∫—ñ—Å—Ç—å —Ç–∞ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω—ñ—Å—Ç—å –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–º–∏ –∞–±–æ –Ω–∞–ø—ñ–≤—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ –≤ –∑–∞—Å—Ç–æ—Å—É–Ω–∫–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º.
**–ü–æ—Ä—Ç –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º:** 27017, 27018
```
PORT      STATE SERVICE VERSION
27017/tcp open  mongodb MongoDB 2.6.9 2.6.9
```
## –ü–µ—Ä–µ–ª—ñ–∫

### –í—Ä—É—á–Ω—É
```python
from pymongo import MongoClient
client = MongoClient(host, port, username=username, password=password)
client.server_info() #Basic info
#If you have admin access you can obtain more info
admin = client.admin
admin_info = admin.command("serverStatus")
cursor = client.list_databases()
for db in cursor:
print(db)
print(client[db["name"]].list_collection_names())
#If admin access, you could dump the database also
```
**–î–µ—è–∫—ñ –∫–æ–º–∞–Ω–¥–∏ MongoDB:**
```bash
show dbs
use <db>
show collections
db.<collection>.find()  #Dump the collection
db.<collection>.count() #Number of records of the collection
db.current.find({"username":"admin"})  #Find in current db the username admin
```
### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π
```bash
nmap -sV --script "mongo* and default" -p 27017 <IP> #By default all the nmap mongo enumerate scripts are used
```
### Shodan

* –£—Å—ñ mongodb: `"—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Å–µ—Ä–≤–µ—Ä mongodb"`
* –ü–æ—à—É–∫ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö —Å–µ—Ä–≤–µ—Ä—ñ–≤ mongodb: `"—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Å–µ—Ä–≤–µ—Ä mongodb" -"—á–∞—Å—Ç–∫–æ–≤–æ —É–≤—ñ–º–∫–Ω–µ–Ω–æ"`
* –¢—ñ–ª—å–∫–∏ —á–∞—Å—Ç–∫–æ–≤–æ —É–≤—ñ–º–∫–Ω–µ–Ω–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è: `"—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Å–µ—Ä–≤–µ—Ä mongodb" "—á–∞—Å—Ç–∫–æ–≤–æ —É–≤—ñ–º–∫–Ω–µ–Ω–æ"`

## –í—Ö—ñ–¥

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º mongo –Ω–µ –ø–æ—Ç—Ä–µ–±—É—î –ø–∞—Ä–æ–ª—è.\
**Admin** - —Ü–µ –ø–æ—à–∏—Ä–µ–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö mongo.
```bash
mongo <HOST>
mongo <HOST>:<PORT>
mongo <HOST>:<PORT>/<DB>
mongo <database> -u <username> -p '<password>'
```
–°–∫—Ä–∏–ø—Ç nmap: _**mongodb-brute**_ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ.
```bash
nmap -n -sV --script mongodb-brute -p 27017 <ip>
```
### [**Brute force**](../generic-methodologies-and-resources/brute-force.md#mongo)

–ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ _/opt/bitnami/mongodb/mongodb.conf_, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ:
```bash
grep "noauth.*true" /opt/bitnami/mongodb/mongodb.conf | grep -v "^#" #Not needed
grep "auth.*true" /opt/bitnami/mongodb/mongodb.conf | grep -v "^#\|noauth" #Not needed
```
## –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è Mongo Objectid

–ü—Ä–∏–∫–ª–∞–¥ [–∑–≤—ñ–¥—Å–∏](https://techkranti.com/idor-through-mongodb-object-ids-prediction/).

Mongo Object IDs - —Ü–µ **12-–±–∞–π—Ç–Ω—ñ —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤—ñ** —Ä—è–¥–∫–∏:

![http://techidiocy.com/_id-objectid-in-mongodb/](../.gitbook/assets/id-and-objectids-in-mongodb.png)

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –æ—Å—å —è–∫ –º–∏ –º–æ–∂–µ–º–æ —Ä–æ–∑—ñ–±—Ä–∞—Ç–∏ —Ñ–∞–∫—Ç–∏—á–Ω–∏–π Object ID, –ø–æ–≤–µ—Ä–Ω—É—Ç–∏–π –¥–æ–¥–∞—Ç–∫–æ–º: 5f2459ac9fa6dc2500314019

1. 5f2459ac: 1596217772 —É –¥–µ—Å—è—Ç–∫–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ = –ü'—è—Ç–Ω–∏—Ü—è, 31 –ª–∏–ø–Ω—è 2020 17:49:32
2. 9fa6dc: –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –º–∞—à–∏–Ω–∏
3. 2500: –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—É
4. 314019: –Ü–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω–∏–π –ª—ñ—á–∏–ª—å–Ω–∏–∫

–ó –ø–µ—Ä–µ–ª—ñ—á–µ–Ω–∏—Ö –≤–∏—â–µ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –º–∞—à–∏–Ω–∏ –∑–∞–ª–∏—à–∏—Ç—å—Å—è —Ç–∞–∫–∏–º —Å–∞–º–∏–º, –¥–æ–∫–∏ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –ø—Ä–∞—Ü—é—î –Ω–∞ —Ç—ñ–π —Å–∞–º—ñ–π —Ñ—ñ–∑–∏—á–Ω—ñ–π/–≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ–π –º–∞—à–∏–Ω—ñ. –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –ø—Ä–æ—Ü–µ—Å—É –∑–º—ñ–Ω–∏—Ç—å—Å—è –ª–∏—à–µ —É –≤–∏–ø–∞–¥–∫—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É –ø—Ä–æ—Ü–µ—Å—É MongoDB. –ú—ñ—Ç–∫–∞ —á–∞—Å—É –±—É–¥–µ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏—Å—è –∫–æ–∂–Ω—É —Å–µ–∫—É–Ω–¥—É. –Ñ–¥–∏–Ω–∞ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å —É –≤–≥–∞–¥—É–≤–∞–Ω–Ω—ñ Object IDs —à–ª—è—Ö–æ–º –ø—Ä–æ—Å—Ç–æ–≥–æ —ñ–Ω–∫—Ä–µ–º–µ–Ω—Ç—É–≤–∞–Ω–Ω—è –∑–Ω–∞—á–µ–Ω—å –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ —Ç–∞ –º—ñ—Ç–∫–∏ —á–∞—Å—É –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ Mongo DB –≥–µ–Ω–µ—Ä—É—î Object IDs —Ç–∞ –ø—Ä–∏–∑–Ω–∞—á–∞—î —ó—Ö –Ω–∞ —Ä—ñ–≤–Ω—ñ —Å–∏—Å—Ç–µ–º–∏.

–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [https://github.com/andresriancho/mongo-objectid-predict](https://github.com/andresriancho/mongo-objectid-predict), –æ—Ç—Ä–∏–º–∞–≤—à–∏ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π Object ID (–≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å —Ç–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π ID), –ø–æ–≤–µ—Ä—Ç–∞—î –ø—Ä–∏–±–ª–∏–∑–Ω–æ 1000 –π–º–æ–≤—ñ—Ä–Ω–∏—Ö Object IDs, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –æ–±'—î–∫—Ç–∞–º, —Ç–æ–º—É –≤–∞–º –ø—Ä–æ—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ —ó—Ö –ø–µ—Ä–µ–±—Ä–∞—Ç–∏.

## –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

–Ø–∫—â–æ –≤–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á root, –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–º—ñ–Ω–∏—Ç–∏** —Ñ–∞–π–ª **mongodb.conf**, —â–æ–± –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –±—É–ª–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ (_noauth = true_) —Ç–∞ **—É–≤—ñ–π—Ç–∏ –±–µ–∑ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö**.

***

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy), —â–æ–± —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ —Ç–∞ –º–∏—Å–ª–∏–≤—Ü—è–º–∏ –∑–∞ –±–∞–≥–∞–º–∏!

**–Ü–Ω—Å–∞–π—Ç–∏ —â–æ–¥–æ –•–∞–∫—ñ–Ω–≥—É**\
–í–∑–∞—î–º–æ–¥—ñ–π—Ç–µ –∑ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º, —è–∫–∏–π –¥–æ—Å–ª—ñ–¥–∂—É—î –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–ª–∏–∫–∏ —Ö–∞–∫—ñ–Ω–≥—É

**–ù–æ–≤–∏–Ω–∏ –ø—Ä–æ –•–∞–∫—ñ–Ω–≥ —É –†–µ–∞–ª—å–Ω–æ–º—É –ß–∞—Å—ñ**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ —à–≤–∏–¥–∫–æ–∑–º—ñ–Ω–Ω–æ–≥–æ —Å–≤—ñ—Ç—É —Ö–∞–∫—ñ–Ω–≥—É –∑–∞–≤–¥—è–∫–∏ –Ω–æ–≤–∏–Ω–∞–º —Ç–∞ —ñ–Ω—Å–∞–π—Ç–∞–º —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–û—Å—Ç–∞–Ω–Ω—ñ –û–≥–æ–ª–æ—à–µ–Ω–Ω—è**\
–ë—É–¥—å—Ç–µ –≤ –∫—É—Ä—Å—ñ –Ω–∞–π–Ω–æ–≤—ñ—à–∏—Ö –±–∞–≥-–±–∞—É–Ω—Ç—ñ, —è–∫—ñ –∑–∞–ø—É—Å–∫–∞—é—Ç—å—Å—è, —Ç–∞ –≤–∞–∂–ª–∏–≤–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏

–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**Discord**](https://discord.com/invite/N3FrSbmwdy) —Ç–∞ –ø–æ—á–Ω—ñ—Ç—å —Å–ø—ñ–≤–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –Ω–∞–π–∫—Ä–∞—â–∏–º–∏ —Ö–∞–∫–µ—Ä–∞–º–∏ –≤–∂–µ —Å—å–æ–≥–æ–¥–Ω—ñ!
