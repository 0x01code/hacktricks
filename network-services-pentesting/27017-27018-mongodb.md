# 27017,27018 - Kupima Usalama wa MongoDB

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikionekana kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Jiunge na [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server ili kuwasiliana na wadukuzi wenye uzoefu na wawindaji wa tuzo za mdudu!

**Machapisho ya Kudukua**\
Shiriki na yaliyomo yanayochimba kina katika msisimko na changamoto za kudukua

**Taarifa za Kudukua Halisi**\
Kaa sawa na ulimwengu wa kudukua wenye kasi kupitia habari za wakati halisi na ufahamu

**Matangazo Mapya**\
Baki mwelekezi na tuzo mpya za mdudu zinazoanzishwa na sasisho muhimu za jukwaa

**Jiunge nasi kwenye** [**Discord**](https://discord.com/invite/N3FrSbmwdy) na anza kushirikiana na wadukuzi bora leo! 

## Taarifa Msingi

**MongoDB** ni mfumo wa usimamizi wa **open source** wa database ambao hutumia **mfano wa database uliolenga hati** kushughulikia aina mbalimbali za data. Inatoa mabadiliko na uwezo wa kusimamia data isiyopangwa au iliyo na muundo wa nusu-kupangwa katika maombi kama uchambuzi wa data kubwa na usimamizi wa maudhui. **Bandari ya chaguo:** 27017, 27018
```
PORT      STATE SERVICE VERSION
27017/tcp open  mongodb MongoDB 2.6.9 2.6.9
```
## Uchambuzi

### Kwa Mkono
```python
from pymongo import MongoClient
client = MongoClient(host, port, username=username, password=password)
client.server_info() #Basic info
#If you have admin access you can obtain more info
admin = client.admin
admin_info = admin.command("serverStatus")
cursor = client.list_databases()
for db in cursor:
print(db)
print(client[db["name"]].list_collection_names())
#If admin access, you could dump the database also
```
**Baadhi ya amri za MongoDB:**
```bash
show dbs
use <db>
show collections
db.<collection>.find()  #Dump the collection
db.<collection>.count() #Number of records of the collection
db.current.find({"username":"admin"})  #Find in current db the username admin
```
### Kiotomatiki
```bash
nmap -sV --script "mongo* and default" -p 27017 <IP> #By default all the nmap mongo enumerate scripts are used
```
### Shodan

* Zote mongodb: `"taarifa za seva ya mongodb"`
* Tafuta seva kamili za mongodb zilizofunguliwa: `"taarifa za seva ya mongodb" -"imezimwa sehemu"`
* Chagua sehemu tu ya uthibitishaji: `"taarifa za seva ya mongodb" "imezimwa sehemu"`

## Kuingia

Kwa chaguo-msingi mongo haitaji nenosiri.\
**Admin** ni kawaida katika database ya mongo.
```bash
mongo <HOST>
mongo <HOST>:<PORT>
mongo <HOST>:<PORT>/<DB>
mongo <database> -u <username> -p '<password>'
```
Skripti ya nmap: _**mongodb-brute**_ itaangalia ikiwa anahitajika creds.
```bash
nmap -n -sV --script mongodb-brute -p 27017 <ip>
```
### [**Kujaribu nguvu**](../generic-methodologies-and-resources/brute-force.md#mongo)

Angalia ndani ya _/opt/bitnami/mongodb/mongodb.conf_ kujua ikiwa sifa zinahitajika:
```bash
grep "noauth.*true" /opt/bitnami/mongodb/mongodb.conf | grep -v "^#" #Not needed
grep "auth.*true" /opt/bitnami/mongodb/mongodb.conf | grep -v "^#\|noauth" #Not needed
```
## Utabiri wa Mongo Objectid

Mfano [kutoka hapa](https://techkranti.com/idor-through-mongodb-object-ids-prediction/).

Mongo Object IDs ni **vitambulisho vya hexadecimal vya byte 12**:

![http://techidiocy.com/\_id-objectid-in-mongodb/](../.gitbook/assets/id-and-ObjectIds-in-MongoDB.png)

Kwa mfano, hapa ndivyo tunavyoweza kuchambua Object ID halisi iliyotolewa na programu: 5f2459ac9fa6dc2500314019

1. 5f2459ac: 1596217772 kwa decimal = Ijumaa, 31 Julai 2020 17:49:32
2. 9fa6dc: Kitambulisho cha Mashine
3. 2500: Kitambulisho cha Mchakato
4. 314019: Kinyume cha kawaida

Kati ya vipengele vilivyotajwa, kitambulisho cha mashine kitabaki sawa kwa muda mrefu kama database inaendesha mashine halisi/virtual ile ile. Kitambulisho cha mchakato kitabadilika tu ikiwa mchakato wa MongoDB unazimwa na kuanzishwa upya. Muda utasasishwa kila sekunde. Changamoto pekee katika kudhani Vitambulisho vya Vitu kwa kuzidi tu kwa thamani ya kinyume cha kawaida na muda, ni ukweli kwamba Mongo DB inazalisha Vitambulisho vya Vitu na kuyapanga kwenye kiwango cha mfumo.

Zana [https://github.com/andresriancho/mongo-objectid-predict](https://github.com/andresriancho/mongo-objectid-predict), ikipewa Object ID ya kuanzia (unaweza kuunda akaunti na kupata ID ya kuanzia), inarudisha takriban Vitambulisho vya Vitu 1000 vinavyoweza kuwa vimepewa vitu vifuatavyo, hivyo unahitaji tu kuziweka kwa nguvu.

## Chapisha

Ikiwa wewe ni mzizi unaweza **kurekebisha** faili ya **mongodb.conf** ili hakuna sifa zinahitajika (_noauth = true_) na **kuingia bila sifa**.

***

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

Jiunge na [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) server ili kuwasiliana na wadukuzi wenye uzoefu na wawindaji wa tuzo za mdudu!

**Machapisho ya Udukuzi**\
Shiriki na maudhui yanayochimba kina katika msisimko na changamoto za udukuzi

**Habari za Udukuzi za Wakati Halisi**\
Kaa up-to-date na ulimwengu wa udukuzi wenye kasi kupitia habari za wakati halisi na ufahamu

**Matangazo Mapya Zaidi**\
Baki mwelewa na tuzo mpya za mdudu zinazoanzishwa na sasisho muhimu za jukwaa

**Jiunge nasi kwenye** [**Discord**](https://discord.com/invite/N3FrSbmwdy) na anza kushirikiana na wadukuzi bora leo!

<details>

<summary><strong>Jifunze udukuzi wa AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJISAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ **kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au **kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
