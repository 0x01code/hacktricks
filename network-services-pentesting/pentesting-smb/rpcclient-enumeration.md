# rpcclient рдЬрд╛рдВрдЪ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдПрдХреНрд╕реЗрд╕ рдЪрд╛рд╣рд┐рдП**? [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ!
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж[**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдХреЛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

### **рдЖрд░рдЖрдИрдбреА рдХреНрдпрд╛ рд╣реИ**

### рд░рд┐рд▓реЗрдЯрд┐рд╡ рдЖрдИрдбреЗрдВрдЯрд┐рдлрд╛рдпрд░реНрд╕ (RID) рдФрд░ рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдЖрдИрдбреЗрдВрдЯрд┐рдлрд╛рдпрд░реНрд╕ (SID) рдХрд╛ рдЕрд╡рд▓реЛрдХрди

**рд░рд┐рд▓реЗрдЯрд┐рд╡ рдЖрдИрдбреЗрдВрдЯрд┐рдлрд╛рдпрд░реНрд╕ (RID)** рдФрд░ **рд╕рд┐рдХреНрдпреЛрд░рд┐рдЯреА рдЖрдИрдбреЗрдВрдЯрд┐рдлрд╛рдпрд░реНрд╕ (SID)** рд╡рд┐рдВрдбреЛрдЬ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдкрд╣рдЪрд╛рди рдФрд░ рдкреНрд░рдмрдВрдзрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдЕрджреНрд╡рд┐рддреАрдп рд░реВрдк рд╕реЗ рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдореБрдЦреНрдп рдШрдЯрдХ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдбреЛрдореЗрди рдХреЗ рднреАрддрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдФрд░ рд╕рдореВрд╣ред

- **SIDs** рдбреЛрдореЗрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ, рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдбреЛрдореЗрди рдХреЛ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рд╕рдХреЗред
- **RIDs** SIDs рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝реЗ рдЬрд╛рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЙрди рдбреЛрдореЗрдиреЛрдВ рдХреЗ рднреАрддрд░ рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд▓рд┐рдП рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдпрд╣ рд╕рдВрдпреЛрдЬрди рд╡рд╕реНрддреБрдУрдВ рдХреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдФрд░ рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рдг рдХрд╛ рд╕рдЯреАрдХ рдЯреНрд░реИрдХрд┐рдВрдЧ рдФрд░ рдкреНрд░рдмрдВрдзрди рд╕рдВрднрд╛рд╡рд┐рдд рдмрдирд╛рддрд╛ рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо `рдкреЗрдкреЗ` рд╣реИ, рдЙрд╕рдХреЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ RID рдХреЗ рд╕рд╛рде рдбреЛрдореЗрди рдХреЗ SID рдХреЛ рдорд┐рд▓рд╛рдХрд░ рдПрдХ рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╣реЗрдХреНрд╕рд╛рдбреЗрд╕рд┐рдорд▓ (`0x457`) рдФрд░ рдбреЗрд╕рд┐рдорд▓ (`1111`) рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рд╕реЗ рдкреЗрдкреЗ рдХреЗ рд▓рд┐рдП рдбреЛрдореЗрди рдХреЗ рднреАрддрд░ рдПрдХ рдкреВрд░реНрдг рдФрд░ рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╣реЛрддрд╛ рд╣реИ рдЬреИрд╕реЗ: `S-1-5-21-1074507654-1937615267-42093643874-1111`ред

### **rpcclient рдХреЗ рд╕рд╛рде рдЬрд╛рдВрдЪ**

**Samba** рд╕реЗ **`rpcclient`** рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ **рдирд╛рдорд┐рдд рдкрд╛рдЗрдк рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RPC рдЗрдВрдЯрд░рдлреЗрд╕** рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХреЗ рд▓рд┐рдПред рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдХрдорд╛рдВрдб рдЬреЛ рдПрдХ **SMB рд╕рддреНрд░ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж** SAMR, LSARPC, рдФрд░ LSARPC-DS рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЛ рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЕрдХреНрд╕рд░ рдкрд╣реБрдВрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

#### рд╕рд░реНрд╡рд░ рд╕реВрдЪрдирд╛

* **рд╕рд░реНрд╡рд░ рд╕реВрдЪрдирд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП: `srvinfo` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

#### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХрд╛ рдЬрд╛рдВрдЪ

* **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕реВрдЪреА** рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП: `querydispinfo` рдФрд░ `enumdomusers` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
* **рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рд╡рд┐рд╡рд░рдг** рджреНрд╡рд╛рд░рд╛: `queryuser <0xrid>`ред
* **рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рдореВрд╣** рдХреЗ рд╕рд╛рде: `queryusergroups <0xrid>`ред
* **рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ SID рдкреНрд░рд╛рдкреНрдд** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: `lookupnames <username>`ред
* **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд╕рд╣рд╛рдпрдХ** рджреНрд╡рд╛рд░рд╛: `queryuseraliases [builtin|domain] <sid>`ред
```bash
# Users' RIDs-forced
for i in $(seq 500 1100); do
rpcclient -N -U "" [IP_ADDRESS] -c "queryuser 0x$(printf '%x\n' $i)" | grep "User Name\|user_rid\|group_rid" && echo "";
done

# samrdump.py can also serve this purpose
```
#### рд╕рдореВрд╣реЛрдВ рдХреА рдЬрд╛рдБрдЪ

* **рд╕рдореВрд╣** рдХреЗ рд▓рд┐рдП: `enumdomgroups`ред
* **рдПрдХ рд╕рдореВрд╣ рдХрд╛ рд╡рд┐рд╡рд░рдг** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: `querygroup <0xrid>`ред
* **рд╕рдореВрд╣ рдХреЗ рд╕рджрд╕реНрдп** рдХреА рдЬрд╛рдБрдЪ рдХреЗ рд▓рд┐рдП: `querygroupmem <0xrid>`ред

#### рдЙрдкрдирд╛рдо рд╕рдореВрд╣реЛрдВ рдХреА рдЬрд╛рдБрдЪ

* **рдЙрдкрдирд╛рдо рд╕рдореВрд╣** рдХреЗ рд▓рд┐рдП: `enumalsgroups <builtin|domain>`ред
* **рдПрдХ рдЙрдкрдирд╛рдо рд╕рдореВрд╣ рдХреЗ рд╕рджрд╕реНрдп** рдХреА рдЬрд╛рдБрдЪ рдХреЗ рд▓рд┐рдП: `queryaliasmem builtin|domain <0xrid>`ред

#### рдбреЛрдореЗрдиреЛрдВ рдХреА рдЬрд╛рдБрдЪ

* **рдбреЛрдореЗрди** рдХреА рдЬрд╛рдБрдЪ рдХреЗ рд▓рд┐рдП: `enumdomains`ред
* **рдПрдХ рдбреЛрдореЗрди рдХрд╛ SID рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ** рдЗрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ: `lsaquery`ред
* **рдбреЛрдореЗрди рд╕реВрдЪрдирд╛ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛рддреА рд╣реИ** рдЗрд╕рдХреЗ рджреНрд╡рд╛рд░рд╛: `querydominfo`ред

#### рд╢реЗрдпрд░реЛрдВ рдХреА рдЬрд╛рдБрдЪ

* **рд╕рднреА рдЙрдкрд▓рдмреНрдз рд╢реЗрдпрд░** рдХреЗ рд▓рд┐рдП: `netshareenumall`ред
* **рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╢реЗрдпрд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА** рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛рддреА рд╣реИ: `netsharegetinfo <share>`ред

#### SIDs рдХреЗ рд╕рд╛рде рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рд░реНрд░рд╡рд╛рдИ

* **рдирд╛рдо рджреНрд╡рд╛рд░рд╛ SIDs** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ: `lookupnames <username>`ред
* **рдЕрдзрд┐рдХ SIDs** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ: `lsaenumsid`ред
* **рдЕрдзрд┐рдХ SIDs рдХреА рдЬрд╛рдБрдЪ рдХреЗ рд▓рд┐рдП RID рд╕рд╛рдЗрдХрд┐рд▓рд┐рдВрдЧ** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: `lookupsids <sid>`ред

#### **рдЕрддрд┐рд░рд┐рдХреНрдд рдХрдорд╛рдВрдб**

| **рдХрдорд╛рдВрдб**         | **рдЗрдВрдЯрд░рдлреЗрд╕**                                                                                                                                     | **рд╡рд┐рд╡рд░рдг**                                                                                                                           |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| queryuser           | SAMR                                                                                                                                              | рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реВрдЪрдирд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ                                                                                                                 |
| querygroup          | рд╕рдореВрд╣ рд╕реВрдЪрдирд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ                                                                                                                        |                                                                                                                                           |
| querydominfo        | рдбреЛрдореЗрди рд╕реВрдЪрдирд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ                                                                                                                       |                                                                                                                                           |
| enumdomusers        | рдбреЛрдореЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ                                                                                                                            |                                                                                                                                           |
| enumdomgroups       | рдбреЛрдореЗрди рд╕рдореВрд╣реЛрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ                                                                                                                           |                                                                                                                                           |
| createdomuser       | рдПрдХ рдбреЛрдореЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рдПрдВ                                                                                                                              |                                                                                                                                           |
| deletedomuser       | рдПрдХ рдбреЛрдореЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╣рдЯрд╛рдПрдВ                                                                                                                              |                                                                                                                                           |
| lookupnames         | LSARPC                                                                                                                                            | рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдореЛрдВ рдХреЛ SID рдорд╛рдиреЛрдВ[a](https://learning.oreilly.com/library/view/network-security-assessment/9781491911044/ch08.html#ch08fn8) рдорд╛рдиреЛрдВ |
| lookupsids          | SIDs рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдореЛрдВ рдореЗрдВ рдЦреЛрдЬреЗрдВ (RID[b](https://learning.oreilly.com/library/view/network-security-assessment/9781491911044/ch08.html#ch08fn9) рд╕рд╛рдЗрдХрд┐рд▓рд┐рдВрдЧ) |                                                                                                                                           |
| lsaaddacctrights    | рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдореЗрдВ рдЕрдзрд┐рдХрд╛рд░ рдЬреЛрдбрд╝реЗрдВ                                                                                                                      |                                                                                                                                           |
| lsaremoveacctrights | рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рд╕реЗ рдЕрдзрд┐рдХрд╛рд░ рд╣рдЯрд╛рдПрдВ                                                                                                                 |                                                                                                                                           |
| dsroledominfo       | LSARPC-DS                                                                                                                                         | рдкреНрд░рд╛рдердорд┐рдХ рдбреЛрдореЗрди рд╕реВрдЪрдирд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ                                                                                                            |
| dsenumdomtrusts     | AD рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди рд╡рди
