# Uchambuzi wa rpcclient

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

* Je, unafanya kazi katika **kampuni ya usalama wa mtandao**? Unataka kuona **kampuni yako ikionyeshwa kwenye HackTricks**? au unataka kupata upatikanaji wa **toleo jipya la PEASS au kupakua HackTricks kwa PDF**? Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* **Jiunge na** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **nifuata** kwenye **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwenye [repo ya hacktricks](https://github.com/carlospolop/hacktricks) na [repo ya hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

**Kikundi cha Usalama cha Try Hard**

<figure><img src="/.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

***

### Maelezo ya Vitambulisho vya Kihusiano (RID) na Vitambulisho vya Usalama (SID)

**Vitambulisho vya Kihusiano (RID)** na **Vitambulisho vya Usalama (SID)** ni sehemu muhimu katika mifumo ya uendeshaji wa Windows kwa kutambua na kusimamia vitu, kama vile watumiaji na vikundi, ndani ya kikoa cha mtandao.

- **SIDs** hutumika kama vitambulisho vya kipekee kwa maeneo, kuhakikisha kuwa kila kikoa kinaweza kutofautishwa.
- **RIDs** huongezwa kwenye SIDs ili kuunda vitambulisho vya kipekee kwa vitu ndani ya maeneo hayo. Kombinisheni hii inaruhusu kufuatilia kwa usahihi na usimamizi wa ruhusa za vitu.

Kwa mfano, mtumiaji anayeitwa `pepe` anaweza kuwa na kitambulisho kipekee kinachochanganya SID ya kikoa na RID yake maalum, iliyoonyeshwa kwa muundo wa hexadecimal (`0x457`) na decimal (`1111`). Hii husababisha kitambulisho kamili na kipekee kwa pepe ndani ya kikoa kama: `S-1-5-21-1074507654-1937615267-42093643874-1111`.


### **Uchambuzi na rpcclient**

Zana ya **`rpcclient`** kutoka Samba hutumiwa kwa kuingiliana na **vituo vya RPC kupitia mabomba yaliyopewa majina**. Amri zifuatazo zinaweza kutolewa kwa interfaces za SAMR, LSARPC, na LSARPC-DS baada ya **kikao cha SMB kuanzishwa**, mara nyingi ikihitaji vibali.

#### Taarifa za Seva

* Kupata **Taarifa za Seva**: Amri ya `srvinfo` hutumiwa.

#### Uchambuzi wa Watumiaji

* **Watumiaji wanaweza kuorodheshwa** kwa kutumia: `querydispinfo` na `enumdomusers`.
* **Maelezo ya mtumiaji** kwa: `queryuser <0xrid>`.
* **Vikundi vya mtumiaji** kwa: `queryusergroups <0xrid>`.
* **SID ya mtumiaji inapata** kupitia: `lookupnames <jina la mtumiaji>`.
* **Vidokezo vya watumiaji** kwa: `queryuseraliases [builtin|domain] <sid>`.
```bash
# Users' RIDs-forced
for i in $(seq 500 1100); do
rpcclient -N -U "" [IP_ADDRESS] -c "queryuser 0x$(printf '%x\n' $i)" | grep "User Name\|user_rid\|group_rid" && echo "";
done

# samrdump.py can also serve this purpose
```
#### Uchambuzi wa Vikundi

* **Vikundi** kwa: `enumdomgroups`.
* **Maelezo ya kikundi** kwa: `querygroup <0xrid>`.
* **Wanachama wa kikundi** kupitia: `querygroupmem <0xrid>`.

#### Uchambuzi wa Vikundi vya Kielelezo

* **Vikundi vya kielelezo** kwa: `enumalsgroups <builtin|domain>`.
* **Wanachama wa kikundi cha kielelezo** kwa: `queryaliasmem builtin|domain <0xrid>`.

#### Uchambuzi wa Maeneo

* **Maeneo** kwa kutumia: `enumdomains`.
* **SID ya eneo** inapokelewa kupitia: `lsaquery`.
* **Maelezo ya eneo** yanapatikana kwa: `querydominfo`.

#### Uchambuzi wa Hisa

* **Hisa zote zilizopo** kwa: `netshareenumall`.
* **Maelezo kuhusu hisa maalum** yanaletwa kwa: `netsharegetinfo <share>`.

#### Operesheni Zaidi na SIDs

* **SIDs kwa jina** kwa kutumia: `lookupnames <username>`.
* **SIDs zaidi** kupitia: `lsaenumsid`.
* **RID cycling kuchunguza SIDs zaidi** inatekelezwa kwa: `lookupsids <sid>`.

#### **Amri za ziada**

| **Amri**            | **Interface**                                                                                                                                     | **Maelezo**                                                                                                                               |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| queryuser           | SAMR                                                                                                                                              | Pata maelezo ya mtumiaji                                                                                                                 |
| querygroup          | Pata maelezo ya kikundi                                                                                                                        |                                                                                                                                           |
| querydominfo        | Pata maelezo ya eneo                                                                                                                          |                                                                                                                                           |
| enumdomusers        | Uorodhesha watumiaji wa eneo                                                                                                                  |                                                                                                                                           |
| enumdomgroups       | Uorodhesha vikundi vya eneo                                                                                                                   |                                                                                                                                           |
| createdomuser       | Unda mtumiaji wa eneo                                                                                                                        |                                                                                                                                           |
| deletedomuser       | Futa mtumiaji wa eneo                                                                                                                        |                                                                                                                                           |
| lookupnames         | LSARPC                                                                                                                                            | Tafuta majina ya watumiaji hadi SID[a](https://learning.oreilly.com/library/view/network-security-assessment/9781491911044/ch08.html#ch08fn8) thamani |
| lookupsids          | Tafuta SIDs hadi majina ya watumiaji (RID[b](https://learning.oreilly.com/library/view/network-security-assessment/9781491911044/ch08.html#ch08fn9) cycling) |                                                                                                                                           |
| lsaaddacctrights    | Ongeza haki kwa akaunti ya mtumiaji                                                                                                           |                                                                                                                                           |
| lsaremoveacctrights | Ondoa haki kutoka kwa akaunti ya mtumiaji                                                                                                     |                                                                                                                                           |
| dsroledominfo       | LSARPC-DS                                                                                                                                         | Pata maelezo ya msingi ya eneo                                                                                                          |
| dsenumdomtrusts     | Uorodhesha maeneo ya kuaminiwa ndani ya msitu wa AD                                                                                           |                                                                                                                                           |

Kuelewa vizuri jinsi zana za _**samrdump**_ **na** _**rpcdump**_ zinafanya kazi unapaswa kusoma [**Pentesting MSRPC**](../135-pentesting-msrpc.md).

**Kikundi cha Usalama cha Kujaribu Kwa Kujituma**

<figure><img src="/.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

<details>

<summary><strong>Jifunze kuhusu kuvamia AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Je, unafanya kazi katika **kampuni ya usalama wa mtandao**? Je, ungependa kuona **kampuni yako ikitangazwa kwenye HackTricks**? au ungependa kupata ufikiaji wa **toleo jipya zaidi la PEASS au kupakua HackTricks kwa PDF**? Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* **Jiunge na** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **nifuatilie** kwenye **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kuvamia kwa kuwasilisha PRs kwa [repo ya hacktricks](https://github.com/carlospolop/hacktricks) na [repo ya hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
