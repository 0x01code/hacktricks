# rpcclient opsporing

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Werk jy in 'n **cybersecurity-maatskappy**? Wil jy jou **maatskappy adverteer in HackTricks**? Of wil jy toegang h√™ tot die **nuutste weergawe van die PEASS of laai HackTricks af in PDF-formaat**? Kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Sluit aan by die** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** my op **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die [hacktricks repo](https://github.com/carlospolop/hacktricks) en [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Vind kwesbaarhede wat die belangrikste is sodat jy dit vinniger kan regstel. Intruder volg jou aanvalsoppervlak, voer proaktiewe dreigingsskanderings uit, vind probleme regoor jou hele tegnologie-stapel, van API's tot webtoepassings en wolkstelsels. [**Probeer dit vandag nog gratis**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks).

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

### **Wat is 'n RID**

### Oorsig van Relatiewe Identifiseerders (RID) en Sekuriteitsidentifiseerders (SID)

**Relatiewe Identifiseerders (RID)** en **Sekuriteitsidentifiseerders (SID)** is sleutelkomponente in Windows-bedryfstelsels om unieke identifikasie en bestuur van voorwerpe, soos gebruikers en groepe, binne 'n netwerkdomein te verseker.

- **SIDs** dien as unieke identifiseerders vir domeine, wat verseker dat elke domein onderskeibaar is.
- **RIDs** word by SIDs gevoeg om unieke identifiseerders vir voorwerpe binne daardie domeine te skep. Hierdie kombinasie maak noukeurige opsporing en bestuur van voorwerppermisies en toegangskontroles moontlik.

Byvoorbeeld, 'n gebruiker genaamd `pepe` kan 'n unieke identifiseerder h√™ wat die domein se SID met sy spesifieke RID kombineer, verteenwoordig in beide heksadesimale (`0x457`) en desimale (`1111`) formate. Dit lei tot 'n volledige en unieke identifiseerder vir pepe binne die domein soos: `S-1-5-21-1074507654-1937615267-42093643874-1111`.


### **Opsporing met rpcclient**

Die **`rpcclient`** nut van Samba word gebruik om met **RPC-eindpunte deur middel van genoemde pype** te kommunikeer. Hieronder is opdragte wat uitgereik kan word na die SAMR, LSARPC en LSARPC-DS koppelvlakke nadat 'n **SMB-sessie opgestel** is, wat dikwels legitimasie vereis.

#### Bedienerinligting

* Om **Bedienerinligting te verkry**: word die `srvinfo`-opdrag gebruik.

#### Opsporing van Gebruikers

* **Gebruikers kan gelys word** deur gebruik te maak van: `querydispinfo` en `enumdomusers`.
* **Besonderhede van 'n gebruiker** deur: `queryuser <0xrid>`.
* **Groepe van 'n gebruiker** met: `queryusergroups <0xrid>`.
* **'n Gebruiker se SID word opgehaal** deur: `lookupnames <gebruikersnaam>`.
* **Aliases van gebruikers** deur: `queryuseraliases [builtin|domain] <sid>`.
```bash
# Users' RIDs-forced
for i in $(seq 500 1100); do
rpcclient -N -U "" [IP_ADDRESS] -c "queryuser 0x$(printf '%x\n' $i)" | grep "User Name\|user_rid\|group_rid" && echo "";
done

# samrdump.py can also serve this purpose
```
#### Opname van Groepe

* **Groepe** deur: `enumdomgroups`.
* **Besonderhede van 'n groep** met: `querygroup <0xrid>`.
* **Lede van 'n groep** deur: `querygroupmem <0xrid>`.

#### Opname van Alias Groepe

* **Alias groepe** deur: `enumalsgroups <builtin|domain>`.
* **Lede van 'n alias groep** met: `queryaliasmem builtin|domain <0xrid>`.

#### Opname van Domeine

* **Domeine** deur: `enumdomains`.
* **'n Domein se SID word opgehaal** deur: `lsaquery`.
* **Domein inligting word verkry** deur: `querydominfo`.

#### Opname van Shares

* **Alle beskikbare shares** deur: `netshareenumall`.
* **Inligting oor 'n spesifieke share word opgehaal** met: `netsharegetinfo <share>`.

#### Addisionele Operasies met SIDs

* **SIDs volgens naam** deur: `lookupnames <username>`.
* **Meer SIDs** deur: `lsaenumsid`.
* **RID cycling om meer SIDs te kontroleer** word uitgevoer deur: `lookupsids <sid>`.

#### **Ekstra opdragte**

| **Opdrag**           | **Interface**                                                                                                                                     | **Beskrywing**                                                                                                                           |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| queryuser           | SAMR                                                                                                                                              | Haal gebruikersinligting op                                                                                                                 |
| querygroup          | Haal groepinligting op                                                                                                                        |                                                                                                                                           |
| querydominfo        | Haal domeininligting op                                                                                                                       |                                                                                                                                           |
| enumdomusers        | Tel domeingebruikers op                                                                                                                       |                                                                                                                                           |
| enumdomgroups       | Tel domeingroepe op                                                                                                                           |                                                                                                                                           |
| createdomuser       | Skep 'n domeingebruiker                                                                                                                       |                                                                                                                                           |
| deletedomuser       | Verwyder 'n domeingebruiker                                                                                                                   |                                                                                                                                           |
| lookupnames         | LSARPC                                                                                                                                            | Soek gebruikersname na SID[a](https://learning.oreilly.com/library/view/network-security-assessment/9781491911044/ch08.html#ch08fn8) waardes |
| lookupsids          | Soek SIDs na gebruikersname (RID[b](https://learning.oreilly.com/library/view/network-security-assessment/9781491911044/ch08.html#ch08fn9) cycling) |                                                                                                                                           |
| lsaaddacctrights    | Voeg regte by 'n gebruikersrekening                                                                                                            |                                                                                                                                           |
| lsaremoveacctrights | Verwyder regte van 'n gebruikersrekening                                                                                                       |                                                                                                                                           |
| dsroledominfo       | LSARPC-DS                                                                                                                                         | Kry prim√™re domeininligting                                                                                                            |
| dsenumdomtrusts     | Tel vertroue domeine binne 'n AD-bos                                                                                                           |                                                                                                                                           |

Om **beter te verstaan** hoe die gereedskap _**samrdump**_ **en** _**rpcdump**_ werk, moet jy [**Pentesting MSRPC**](../135-pentesting-msrpc.md) lees.

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Vind kwesbaarhede wat die belangrikste is sodat jy dit vinniger kan regstel. Intruder hou jou aanvalsoppervlak dop, voer proaktiewe dreigingsskanderings uit, vind probleme regoor jou hele tegniese stapel, van API's tot webtoepassings en wolkstelsels. [**Probeer dit vandag nog gratis**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks).

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}


<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Werk jy in 'n **cybersekuriteitsmaatskappy**? Wil jy jou **maatskappy adverteer in HackTricks**? Of wil jy toegang h√™ tot die **nuutste weergawe van die PEASS of laai HackTricks in PDF af**? Kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Sluit aan by die** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** my op **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die [hacktricks repo](https://github.com/carlospolop/hacktricks) en [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
