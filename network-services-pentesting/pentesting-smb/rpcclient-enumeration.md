# Απαρίθμηση rpcclient

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Εργάζεστε σε μια **εταιρεία κυβερνοασφάλειας**; Θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks**; Ή θέλετε να έχετε πρόσβαση στην **τελευταία έκδοση του PEASS ή να κατεβάσετε το HackTricks σε μορφή PDF**; Ελέγξτε τα [**ΠΑΚΕΤΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Ανακαλύψτε την [**Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Εγγραφείτε** στην [**💬**](https://emojipedia.org/speech-balloon/) [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** με στο **Twitter** 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στο [αποθετήριο hacktricks](https://github.com/carlospolop/hacktricks) και [αποθετήριο hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Βρείτε ευπάθειες που έχουν μεγαλύτερη σημασία, ώστε να μπορείτε να τις διορθώσετε πιο γρήγορα. Το Intruder παρακολουθεί την επιθετική επιφάνεια σας, εκτελεί προληπτικές απειλητικές αναζητήσεις, εντοπίζει προβλήματα σε ολόκληρο το τεχνολογικό σας στοίβα, από τις διεπαφές προς τις ιστοσελίδες και τα συστήματα στον νέφος. [**Δοκιμάστε το δωρεάν**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) σήμερα.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

### **Τι είναι ένα RID**

### Επισκόπηση των Σχετικών Αναγνωριστικών (RID) και των Αναγνωριστικών Ασφαλείας (SID)

Τα **Σχετικά Αναγνωριστικά (RID)** και τα **Αναγνωριστικά Ασφαλείας (SID)** είναι βασικά στοιχεία στα λειτουργικά συστήματα των Windows για τη μοναδική αναγνώριση και διαχείριση αντικειμένων, όπως χρήστες και ομάδες, εντός ενός δικτύου τομέα.

- Τα **SIDs** λειτουργούν ως μοναδικά αναγνωριστικά για τους τομείς, εξασφαλίζοντας ότι κάθε τομέας είναι διακρίσιμος.
- Τα **RID** προστίθενται στα SIDs για να δημιουργήσουν μοναδικά αναγνωριστικά για αντικείμενα εντός αυτών των τομέων. Αυτός ο συνδυασμός επιτρέπει την ακριβή παρακολούθηση και διαχείριση των δικαιωμάτων αντικειμένων και των ελέγχων πρόσβασης.

Για παράδειγμα, ένας χρήστης με το όνομα `pepe` μπορεί να έχει ένα μοναδικό αναγνωριστικό που συνδυάζει το SID του τομέα με το συγκεκριμένο RID του, αναπαριστώμενο και σε δεκαεξαδική (`0x457`) και δεκαδική (`1111`) μορφή. Αυτό οδηγεί σε ένα πλήρες και μοναδικό αναγνωριστικό για τον pepe εντός του τομέα όπως: `S-1-5-21-1074507654-1937615267-42093643874-1111`.


### **Απαρίθμηση με το rpcclient**

Το εργαλείο **`rpcclient`** από το Samba χρησιμοποιείται για την αλληλεπίδραση με **σημεία RPC μέσω ονομασμένων σωληνώσεων**. Παρακάτω παρατίθενται εντολές που μπορούν να εκδοθούν στις διεπαφές SAMR, LSARPC και LSARPC-DS μετά από μια **συνεδρία SMB**, συχνά απαιτώντας διαπιστευτήρια.

#### Πληροφορίες Διακομιστή

* Για να λάβετε τις **Πληροφορίες Διακομιστή**: χρησιμοποιείται η εντολή `srvinfo`.

#### Απαρίθμηση Χρηστών

* Οι **χρήστες μπορούν να απαριθμηθούν** χρησιμοποιώντας: οι εντολές `querydispinfo` και `enumdomusers`.
* **Λεπτομέρειες ενός χρήστη** με: `queryuser <0xrid>`.
* **Ομάδες ενός χρήστη** με: `queryusergroups <0xrid>`.
* **Το SID ενός χρήστη ανακτάται** μέσω: `lookupnames <username>`.
* **Οι ψευδώνυμοι των χρηστών** με: `queryuseraliases [builtin|domain] <sid>`.
```bash
# Users' RIDs-forced
for i in $(seq 500 1100); do
rpcclient -N -U "" [IP_ADDRESS] -c "queryuser 0x$(printf '%x\n' $i)" | grep "User Name\|user_rid\|group_rid" && echo "";
done

# samrdump.py can also serve this purpose
```
#### Απαρίθμηση Ομάδων

* **Ομάδες** με: `enumdomgroups`.
* **Λεπτομέρειες μιας ομάδας** με: `querygroup <0xrid>`.
* **Μέλη μιας ομάδας** με: `querygroupmem <0xrid>`.

#### Απαρίθμηση Ομάδων Ψευδωνύμων

* **Ομάδες ψευδωνύμων** με: `enumalsgroups <builtin|domain>`.
* **Μέλη μιας ομάδας ψευδωνύμων** με: `queryaliasmem builtin|domain <0xrid>`.

#### Απαρίθμηση Τομέων

* **Τομείς** με: `enumdomains`.
* **Ανάκτηση SID ενός τομέα** με: `lsaquery`.
* **Ανάκτηση πληροφοριών τομέα** με: `querydominfo`.

#### Απαρίθμηση Κοινόχρηστων Φακέλων

* **Όλοι οι διαθέσιμοι κοινόχρηστοι φάκελοι** με: `netshareenumall`.
* **Ανάκτηση πληροφοριών για έναν συγκεκριμένο κοινόχρηστο φάκελο** με: `netsharegetinfo <share>`.

#### Επιπλέον Λειτουργίες με SIDs

* **SIDs με βάση το όνομα** με: `lookupnames <username>`.
* **Περισσότερα SIDs** με: `lsaenumsid`.
* **Έλεγχος περισσότερων SIDs με κύκληση RID** με: `lookupsids <sid>`.

#### **Επιπλέον εντολές**

| **Εντολή**           | **Διεπαφή**                                                                                                                                     | **Περιγραφή**                                                                                                                           |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| queryuser           | SAMR                                                                                                                                              | Ανάκτηση πληροφοριών χρήστη                                                                                                                 |
| querygroup          | Ανάκτηση πληροφοριών ομάδας                                                                                                                        |                                                                                                                                           |
| querydominfo        | Ανάκτηση πληροφοριών τομέα                                                                                                                       |                                                                                                                                           |
| enumdomusers        | Απαρίθμηση χρηστών τομέα                                                                                                                            |                                                                                                                                           |
| enumdomgroups       | Απαρίθμηση ομάδων τομέα                                                                                                                           |                                                                                                                                           |
| createdomuser       | Δημιουργία χρήστη τομέα                                                                                                                             |                                                                                                                                           |
| deletedomuser       | Διαγραφή χρήστη τομέα                                                                                                                              |                                                                                                                                           |
| lookupnames         | LSARPC                                                                                                                                            | Αναζήτηση ονομάτων χρηστών σε τιμές SID[a](https://learning.oreilly.com/library/view/network-security-assessment/9781491911044/ch08.html#ch08fn8) |
| lookupsids          | Αναζήτηση SID σε ονόματα χρηστών (κύκληση RID[b](https://learning.oreilly.com/library/view/network-security-assessment/9781491911044/ch08.html#ch08fn9)) |                                                                                                                                           |
| lsaaddacctrights    | Προσθήκη δικαιωμάτων σε έναν λογαριασμό χρήστη                                                                                                      |                                                                                                                                           |
| lsaremoveacctrights | Αφαίρεση δικαιωμάτων από έναν λογαριασμό χρήστη                                                                                                     |                                                                                                                                           |
| dsroledominfo       | LSARPC-DS                                                                                                                                         | Ανάκτηση πληροφοριών κύριου τομέα                                                                                                        |
| dsenumdomtrusts     | Απαρίθμηση εμπιστευμένων τομέων εντός ενός AD δάσους                                                                                                 |                                                                                                                                           |

Για να **κατανοήσετε** καλύτερα πώς λειτουργούν τα εργαλεία _**samrdump**_ **και** _**rpcdump**_, πρέπει να διαβάσετε το [**Pentesting MSRPC**](../135-pentesting-msrpc.md).

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Βρείτε ευπάθειες που είναι πιο σημαντικές, ώστε να μπορείτε να τις διορθώσετε πιο γρήγορα. Το Intruder παρακολουθεί την επιθετική επιφάνειά σας, εκτελεί προληπτικές απειλητικές αναζητήσεις, εντοπίζει προβλήματα σε ολόκληρο το τεχνολογικό σας στοίβα, από τις διεπαφές προγραμματισμού εφαρμογών (APIs) μέχρι τις ιστοσελίδες και τα συστήματα στο cloud. [**Δοκιμάστε το δωρεάν**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) σήμερα.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}


<details>

<summary><strong>Μάθετε το hacking στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* Εργάζεστε σε μια **εταιρεία κυβερνοασφάλειας**; Θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks**; Ή θέλετε να έχετε πρόσβαση στην **τελευταία έκδοση του PEASS ή να κατεβάσετε το HackTricks σε μορφή PDF**; Ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Ανακαλύψτε την [**Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Εγγραφείτε στην** [**💬**](https://emojipedia.org/speech-balloon/) [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** με στο **Twitter** 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα κόλπα σας στο hacking υποβάλλοντας PRs στο [αποθετήριο hacktricks](https://github.com/carlospolop/hacktricks) και [αποθετήριο hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
