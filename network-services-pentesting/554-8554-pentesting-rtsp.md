# 554,8554 - Pentesting RTSP

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Informazioni di base

Da [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> Il **Real Time Streaming Protocol** (**RTSP**) √® un protocollo di controllo di rete progettato per l'uso in sistemi di intrattenimento e comunicazione per controllare i server multimediali in streaming. Il protocollo viene utilizzato per stabilire e controllare sessioni multimediali tra i punti finali. I client dei server multimediali emettono comandi simili a quelli di un videoregistratore, come play, record e pause, per facilitare il controllo in tempo reale dello streaming multimediale dal server a un client (Video On Demand) o da un client al server (Voice Recording).
>
> La trasmissione dei dati in streaming non √® di competenza di RTSP. La maggior parte dei server RTSP utilizza il protocollo di trasporto in tempo reale (RTP) in combinazione con il protocollo di controllo in tempo reale (RTCP) per la distribuzione dei flussi multimediali. Tuttavia, alcuni fornitori implementano protocolli di trasporto proprietari. Ad esempio, il software del server RTSP di RealNetworks utilizza anche il loro protocollo di trasporto proprietario Real Data Transport (RDT).

**Porte predefinite:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Dettagli chiave

**RTSP** √® simile a HTTP ma progettato specificamente per lo streaming multimediale. √à definito in una specifica semplice che pu√≤ essere trovata qui:

[RTSP - RFC2326](https://tools.ietf.org/html/rfc2326)

I dispositivi potrebbero consentire l'accesso **non autenticato** o **autenticato**. Per verificare, viene inviata una richiesta "DESCRIBE". Di seguito √® riportato un esempio di base:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\n`

Ricorda, il formato corretto include un doppio "\r\n" per una risposta coerente. Una risposta "200 OK" indica un accesso **non autenticato**, mentre "401 Unauthorized" segnala la necessit√† di autenticazione, rivelando se √® richiesta l'autenticazione **Basic** o **Digest**.

Per l'autenticazione **Basic**, codifichi il nome utente e la password in base64 e li includi nella richiesta in questo modo:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n`

Questo esempio utilizza "admin" e "1234" come credenziali. Ecco uno **script Python** per inviare una tale richiesta:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**Autenticazione di base** √® pi√π semplice e preferita. L'**autenticazione digest** richiede una gestione attenta dei dettagli di autenticazione forniti nella risposta "401 Unauthorized".

Questa panoramica semplifica il processo di accesso agli stream RTSP, concentrandosi sull'**autenticazione di base** per la sua semplicit√† e praticit√† nei tentativi iniziali.


## Enumerazione

Otteniamo informazioni sui metodi validi e gli URL supportati e proviamo a forzare l'accesso (se necessario) per ottenere l'accesso al contenuto.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Brute Force](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Altri programmi utili**

Per effettuare un attacco di forza bruta: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* Rileva host RTSP aperti su qualsiasi target accessibile
* Ottieni le loro informazioni pubbliche (nome host, porta, modello della telecamera, ecc.)
* Avvia attacchi automatizzati di dizionario per ottenere il percorso dello stream (ad esempio /live.sdp)
* Avvia attacchi automatizzati di dizionario per ottenere il nome utente e la password delle telecamere
* Genera miniature per verificare se gli stream sono validi e per avere una rapida anteprima dei loro contenuti
* Prova a creare una pipeline Gstreamer per verificare se sono codificati correttamente
* Stampa un riepilogo di tutte le informazioni ottenute da Cameradar

## Riferimenti
* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository github di** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
