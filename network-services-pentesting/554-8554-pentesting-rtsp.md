## Informaci√≥n B√°sica

> El **Protocolo de Transmisi√≥n en Tiempo Real** (**RTSP**) es un protocolo de control de red dise√±ado para su uso en sistemas de entretenimiento y comunicaciones para controlar servidores de transmisi√≥n de medios. El protocolo se utiliza para establecer y controlar sesiones de medios entre puntos finales. Los clientes de los servidores de medios emiten comandos de estilo VHS, como reproducir, grabar y pausar, para facilitar el control en tiempo real de la transmisi√≥n de medios desde el servidor a un cliente (Video On Demand) o desde un cliente al servidor (grabaci√≥n de voz).
>
> La transmisi√≥n de datos de transmisi√≥n en s√≠ no es una tarea de RTSP. La mayor√≠a de los servidores RTSP utilizan el Protocolo de Transporte en Tiempo Real (RTP) en conjunto con el Protocolo de Control en Tiempo Real (RTCP) para la entrega de transmisi√≥n de medios. Sin embargo, algunos proveedores implementan protocolos de transporte propietarios. El software del servidor RTSP de RealNetworks, por ejemplo, tambi√©n utiliz√≥ el Propietario de Transporte de Datos en Tiempo Real (RDT) de RealNetworks.

De [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol).

**Puertos predeterminados:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Informaci√≥n detallada

En primer lugar, RTSP es un protocolo similar a HTTP. Tiene una estructura y comandos de control diferentes, pero su formato es textual y una vez que se aprenden los conceptos b√°sicos de los comandos y c√≥mo interact√∫an, es bastante f√°cil de usar. La especificaci√≥n de RTSP es bastante sencilla. Aqu√≠ hay un enlace a ella:

[RTSP - RFC2326](https://tools.ietf.org/html/rfc2326)

RTSP se puede acceder sin autenticaci√≥n (com√∫n en dispositivos de estanter√≠a) o autenticado. El acceso autenticado es similar a HTTP en que tiene autenticaci√≥n b√°sica y de digesti√≥n, ambas casi id√©nticas a HTTP. Para averiguar si su dispositivo est√° autenticado o no, simplemente env√≠e una solicitud "DESCRIBE". Una solicitud DESCRIBE simple se ve as√≠:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\n\r`

Nota: se requiere el " \r\n" adicional para una respuesta confiable. Algunos sistemas aceptar√°n el " \r\n" √∫nico, pero la mayor√≠a no lo har√°.

Esto se puede enviar a trav√©s de un socket en bruto. Al igual que HTTP, una respuesta exitosa que indica acceso no autenticado estar√° disponible y contendr√° un "200 OK". En este caso, con DESCRIBE, tambi√©n contendr√° todos los par√°metros operativos de la transmisi√≥n de video.

Si el dispositivo requiere autenticaci√≥n, la respuesta contendr√° "401 Unauthorized". La respuesta tambi√©n indicar√° qu√© mecanismos de autenticaci√≥n est√°n disponibles. Si la autenticaci√≥n b√°sica est√° disponible, la cadena de respuesta contendr√° una l√≠nea de informaci√≥n que tenga "WWW-Authenticate: Basic". El resto de la informaci√≥n proporcionada con la autenticaci√≥n b√°sica es en gran parte irrelevante para realizar la autenticaci√≥n b√°sica.

Si se requiere autenticaci√≥n de digesti√≥n, entonces la respuesta "401 Unauthorized" tendr√° una l√≠nea de informaci√≥n que contenga "WWW-Authenticate: Digest". La informaci√≥n con la especificaci√≥n de Digesti√≥n es muy importante si va a realizar la autenticaci√≥n de Digesti√≥n, as√≠ que no la ignore.

La autenticaci√≥n b√°sica es la forma de proceder, con suerte, la respuesta recibida indica que est√° disponible. Si no, hay tres m√©todos diferentes para ensamblar un elemento de autenticaci√≥n de Digesti√≥n, por lo que Digesti√≥n puede volverse problem√°tico, especialmente a ciegas (sin autenticaci√≥n). El resto de este art√≠culo se centrar√° en la autenticaci√≥n b√°sica. Es posible que escriba un art√≠culo de seguimiento m√°s adelante una vez que descifre la salsa secreta para hacer la autenticaci√≥n de Digesti√≥n a ciegas.

Para formular un elemento de autenticaci√≥n b√°sica, simplemente se debe codificar en base 64 \<username> ":" \<password> y agregarlo a la solicitud. Entonces, una nueva solicitud se ver√≠a as√≠:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r`

Nuevamente, tenga en cuenta que la solicitud se termina con el doble " \r\n".

El valor YWRtaW46MTIzNA== es el nombre de usuario y la contrase√±a codificados en base 64 concatenados con ":". En este caso, he usado "admin" / "1234". Algunos scripts simples de Python para probar esto se ven as√≠:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
¬°Voil√†! Tienes acceso.

**De:** [**http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/**](https://web.archive.org/web/20161020202643/http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)

## Enumeraci√≥n

Obtengamos informaci√≥n sobre los m√©todos y URLs v√°lidos que son compatibles e intentemos forzar el acceso (si es necesario) para obtener acceso al contenido.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Fuerza Bruta](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Otros programas √∫tiles**

Para hacer fuerza bruta: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

**Cameradar**

Cameradar te permite:

* Detectar hosts RTSP abiertos en cualquier objetivo accesible
* Obtener su informaci√≥n p√∫blica (nombre de host, puerto, modelo de c√°mara, etc.)
* Lanzar ataques de diccionario automatizados para obtener su ruta de transmisi√≥n (por ejemplo, /live.sdp)
* Lanzar ataques de diccionario automatizados para obtener el nombre de usuario y la contrase√±a de las c√°maras
* Generar miniaturas de ellas para comprobar si las transmisiones son v√°lidas y tener una vista previa r√°pida de su contenido
* Intentar crear una tuber√≠a de Gstreamer para comprobar si est√°n codificadas correctamente
* Imprimir un resumen de toda la informaci√≥n que Cameradar pudo obtener
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Consigue el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PR al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
