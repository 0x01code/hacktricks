# 554,8554 - Pentesting RTSP

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka mwanzo hadi kuwa bingwa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikionekana kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwenye** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## Taarifa Msingi

Kutoka [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> **Itifaki ya Utoaji wa Muda Halisi** (**RTSP**) ni itifaki ya kudhibiti mtandao iliyoundwa kwa matumizi katika mifumo ya burudani na mawasiliano ili kudhibiti seva za media za utiririshaji. Itifaki hutumiwa kuanzisha na kudhibiti vikao vya media kati ya hatua za mwisho. Wateja wa seva za media hutuma amri kama vile kucheza, kurekodi na kusitisha, kusaidia udhibiti wa wakati halisi wa utiririshaji wa media kutoka kwa seva kwenda kwa mteja (Video On Demand) au kutoka kwa mteja kwenda kwa seva (Kurekodi Sauti).
>
> Uhamishaji wa data ya utiririshaji yenyewe sio jukumu la RTSP. Seva nyingi za RTSP hutumia Itifaki ya Uhamishaji wa Muda Halisi (RTP) pamoja na Itifaki ya Kudhibiti ya Muda Halisi (RTCP) kwa utoaji wa mtiririko wa media. Walakini, baadhi ya wauzaji hutumia itifaki za uhamishaji za kipekee. Kwa mfano, programu ya seva ya RTSP kutoka RealNetworks pia ilikuwa inatumia Usafirishaji wa Takwimu wa Halisi wa RealNetworks (RDT) ya kipekee.

**Bandari za chaguo-msingi:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Maelezo Muhimu

**RTSP** ni sawa na HTTP lakini imeundwa mahsusi kwa ajili ya utiririshaji wa media. Inaelezwa katika maelezo rahisi ambayo yanaweza kupatikana hapa:

[RTSP - RFC2326](https://tools.ietf.org/html/rfc2326)

Vifaa vinaweza kuruhusu ufikiaji **bila kuthibitishwa** au **kuthibitishwa**. Ili kuchunguza hili, ombi la "DESCRIBE" linatumwa. Mfano wa msingi unaonyeshwa hapa chini:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\n`

Kumbuka, muundo sahihi unajumuisha mara mbili "\r\n" kwa jibu thabiti. Jibu la "200 OK" linaashiria ufikiaji **bila kuthibitishwa**, wakati "401 Unauthorized" inaashiria hitaji la kuthibitishwa, ikifichua ikiwa inahitajika **uthibitishaji wa Msingi** au **uthibitishaji wa Digest**.

Kwa **uthibitishaji wa Msingi**, unakodisha jina la mtumiaji na nenosiri kwa base64 na kuongeza katika ombi kama ifuatavyo:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n`

Mfano huu unatumia "admin" na "1234" kama sifa. Hapa kuna **skrini ya Python** ya kutuma ombi kama hilo:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**Uthibitishaji wa msingi** ni rahisi na unapendelewa. **Uthibitishaji wa kumeng'enya** unahitaji kushughulikia kwa uangalifu maelezo ya uthibitishaji yaliyotolewa katika jibu la "401 Unauthorized".

Muhtasari huu unafanya mchakato wa kupata mito ya RTSP kuwa rahisi, ukilenga **uthibitishaji wa msingi** kwa sababu ya urahisi wake na umuhimu wake katika jaribio la kwanza.


## Uchunguzi

Tupate habari kuhusu njia na URL halali zinazoungwa mkono na jaribu kuvunja ufikiaji (ikiwa inahitajika) ili kupata ufikiaji wa yaliyomo.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Brute Force](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Programu nyingine muhimu**

Kwa kufanya nguvu ya brute: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* Tafuta watumiaji wazi wa RTSP kwenye lengo lolote linalopatikana
* Pata habari zao za umma (jina la mwenyeji, bandari, mfano wa kamera, nk)
* Anzisha mashambulizi ya orodha ya maneno kiotomatiki ili kupata njia yao ya mkondo (kwa mfano /live.sdp)
* Anzisha mashambulizi ya orodha ya maneno kiotomatiki ili kupata jina la mtumiaji na nenosiri la kamera
* Unda picha ndogo kutoka kwao ili kuhakiki ikiwa mkondo ni sahihi na kuwa na muhtasari wa haraka wa maudhui yao
* Jaribu kuunda mstari wa Gstreamer ili kuhakiki ikiwa wamekodishwa vizuri
* Chapisha muhtasari wa habari zote ambazo Cameradar inaweza kupata

## Marejeo
* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi wa PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PR kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
