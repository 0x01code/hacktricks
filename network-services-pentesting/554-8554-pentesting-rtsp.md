# 554,8554 - Pentesting RTSP

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **sigue** a **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informaci√≥n B√°sica

> El **Real Time Streaming Protocol** (**RTSP**) es un protocolo de control de red dise√±ado para su uso en sistemas de entretenimiento y comunicaciones para controlar servidores de medios de transmisi√≥n. El protocolo se utiliza para establecer y controlar sesiones de medios entre puntos finales. Los clientes de servidores de medios emiten comandos al estilo VHS, como play, record y pause, para facilitar el control en tiempo real de la transmisi√≥n de medios desde el servidor a un cliente (Video On Demand) o desde un cliente al servidor (Grabaci√≥n de Voz).
>
> La transmisi√≥n de datos en streaming en s√≠ misma no es una tarea de RTSP. La mayor√≠a de los servidores RTSP utilizan el Real-time Transport Protocol (RTP) en conjunto con el Real-time Control Protocol (RTCP) para la entrega de la transmisi√≥n de medios. Sin embargo, algunos proveedores implementan protocolos de transporte propietarios. Por ejemplo, el software del servidor RTSP de RealNetworks tambi√©n utilizaba el Real Data Transport (RDT) propietario de RealNetworks.

De [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol).

**Puertos predeterminados:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Informaci√≥n Detallada

En primer lugar, RTSP es un protocolo similar a HTTP. Tiene una estructura diferente y comandos de control, pero es textual en su formato y, una vez que aprendes los conceptos b√°sicos de los comandos y c√≥mo interact√∫an, es bastante f√°cil de usar. La especificaci√≥n para RTSP es bastante clara. Aqu√≠ hay un enlace a ella:

[RTSP ‚Äì RFC2326](https://tools.ietf.org/html/rfc2326)

RTSP se puede acceder sin autenticaci√≥n (com√∫n en dispositivos de venta al p√∫blico) o con autenticaci√≥n. El acceso autenticado es similar a HTTP en que tienes autenticaci√≥n B√°sica y Digest, ambas casi id√©nticas a HTTP. Para averiguar si tu dispositivo est√° autenticado o no, simplemente env√≠a una solicitud "DESCRIBE". Una solicitud DESCRIBE simple se ve as√≠:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\n`

Nota: el "\r\n" adicional es necesario para una respuesta confiable. Algunos sistemas aceptar√°n el √∫nico "\r\n", pero la mayor√≠a no.

Esto se puede enviar a trav√©s de un socket crudo. Al igual que HTTP, una respuesta exitosa que indica que el acceso sin autenticaci√≥n est√° disponible contendr√° un "200 OK". En este caso con DESCRIBE, tambi√©n contendr√° todos los par√°metros operativos de la transmisi√≥n de video.

Si el dispositivo requiere autenticaci√≥n, la respuesta ser√° "401 No autorizado". La respuesta tambi√©n indicar√° qu√© mecanismos de autenticaci√≥n est√°n disponibles. Si la autenticaci√≥n B√°sica est√° disponible, la cadena de respuesta contendr√° una l√≠nea de informaci√≥n que tiene "WWW-Authenticate: Basic". El resto de la informaci√≥n proporcionada con la autenticaci√≥n B√°sica es en gran parte irrelevante para realizar la autenticaci√≥n b√°sica.

Si se requiere autenticaci√≥n Digest, entonces la respuesta "401 No autorizado" tendr√° una l√≠nea de informaci√≥n que contiene "WWW-Authenticate: Digest". La informaci√≥n con la especificaci√≥n Digest ES muy importante si vas a realizar la autenticaci√≥n Digest, as√≠ que no la ignores.

La autenticaci√≥n B√°sica es el camino a seguir, con suerte la respuesta recibida indicar√° que est√° disponible. Si no, hay tres m√©todos diferentes para ensamblar un elemento de autenticaci√≥n Digest, por lo que Digest puede volverse problem√°tico, especialmente a ciegas (sin autenticaci√≥n). El resto de este art√≠culo se centrar√° en la autenticaci√≥n B√°sica. Puede que escriba un art√≠culo de seguimiento m√°s tarde una vez que descifre la salsa secreta para hacer la autenticaci√≥n Digest a ciegas.

Para formular un elemento de autenticaci√≥n B√°sica, simplemente hay que codificar en base 64 \<username> ":" \<password> y a√±adirlo a la solicitud. As√≠ que una nueva solicitud se ver√≠a as√≠:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n`

Nuevamente, nota que la solicitud termina con el doble "\r\n".

El valor YWRtaW46MTIzNA== es el nombre de usuario y la contrase√±a codificados en base 64 concatenados con ":". En este caso he usado "admin"/"1234". Algunos scripts simples de python para probar esto se ven as√≠:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
He aqu√≠ tu acceso.

**De:** [**http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/**](https://web.archive.org/web/20161020202643/http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)

## Enumeraci√≥n

Obtengamos informaci√≥n sobre qu√© m√©todos v√°lidos y URLs son compatibles e intentemos forzar bruscamente el acceso (si es necesario) para acceder al contenido.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Fuerza Bruta](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Otros programas √∫tiles**

Para hacer fuerza bruta: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

**Cameradar**

Cameradar te permite:

* Detectar hosts RTSP abiertos en cualquier objetivo accesible
* Obtener su informaci√≥n p√∫blica (nombre de host, puerto, modelo de c√°mara, etc.)
* Lanzar ataques de diccionario automatizados para obtener su ruta de transmisi√≥n (por ejemplo /live.sdp)
* Lanzar ataques de diccionario automatizados para obtener el nombre de usuario y la contrase√±a de las c√°maras
* Generar miniaturas de ellas para verificar si las transmisiones son v√°lidas y para tener una vista previa r√°pida de su contenido
* Intentar crear una tuber√≠a de Gstreamer para verificar si est√°n codificadas correctamente
* Imprimir un resumen de toda la informaci√≥n que Cameradar pudo obtener
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** revisa los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
