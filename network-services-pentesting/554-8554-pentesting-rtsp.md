# 554,8554 - Pentesting RTSP

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

## Informa√ß√µes B√°sicas

Do [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> O **Protocolo de Streaming em Tempo Real** (**RTSP**) √© um protocolo de controle de rede projetado para uso em sistemas de entretenimento e comunica√ß√µes para controlar servidores de m√≠dia de streaming. O protocolo √© usado para estabelecer e controlar sess√µes de m√≠dia entre pontos finais. Clientes de servidores de m√≠dia emitem comandos no estilo VHS, como reproduzir, gravar e pausar, para facilitar o controle em tempo real do streaming de m√≠dia do servidor para um cliente (V√≠deo sob Demanda) ou de um cliente para o servidor (Grava√ß√£o de Voz).
>
> A transmiss√£o de dados de streaming em si n√£o √© uma tarefa do RTSP. A maioria dos servidores RTSP usa o Protocolo de Transporte em Tempo Real (RTP) em conjunto com o Protocolo de Controle em Tempo Real (RTCP) para a entrega de fluxo de m√≠dia. No entanto, alguns fornecedores implementam protocolos de transporte propriet√°rios. O software do servidor RTSP da RealNetworks, por exemplo, tamb√©m usava o Transporte de Dados Real (RDT) propriet√°rio da RealNetworks.

**Portas padr√£o:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Detalhes Principais

**RTSP** √© semelhante ao HTTP, mas projetado especificamente para streaming de m√≠dia. √â definido em uma especifica√ß√£o direta que pode ser encontrada aqui:

[RTSP ‚Äì RFC2326](https://tools.ietf.org/html/rfc2326)

Dispositivos podem permitir acesso **n√£o autenticado** ou **autenticado**. Para verificar, √© enviada uma solicita√ß√£o "DESCRIBE". Um exemplo b√°sico √© mostrado abaixo:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r`

Lembre-se, o formato correto inclui um duplo "\r\n" para uma resposta consistente. Uma resposta "200 OK" indica **acesso n√£o autenticado**, enquanto "401 Unauthorized" sinaliza a necessidade de autentica√ß√£o, revelando se √© necess√°ria **autentica√ß√£o B√°sica** ou **Digest**.

Para **autentica√ß√£o B√°sica**, voc√™ codifica o nome de usu√°rio e senha em base64 e os inclui na solicita√ß√£o da seguinte forma:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r`

Este exemplo usa "admin" e "1234" para as credenciais. Aqui est√° um **script Python** para enviar tal solicita√ß√£o:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**Autentica√ß√£o b√°sica** √© mais simples e preferida. A **autentica√ß√£o digest** requer o manuseio cuidadoso dos detalhes de autentica√ß√£o fornecidos na resposta "401 N√£o autorizado".

Esta vis√£o geral simplifica o processo de acesso a fluxos RTSP, focando na **autentica√ß√£o b√°sica** por sua simplicidade e praticidade em tentativas iniciais.

## Enumera√ß√£o

Vamos obter informa√ß√µes sobre os m√©todos v√°lidos e URLs suportados e tentar for√ßar o acesso (se necess√°rio) para obter acesso ao conte√∫do.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Brute Force](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Outros programas √∫teis**

Para fazer brute force: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* Detectar hosts RTSP abertos em qualquer alvo acess√≠vel
* Obter suas informa√ß√µes p√∫blicas (nome do host, porta, modelo da c√¢mera, etc.)
* Lan√ßar ataques de dicion√°rio automatizados para obter a rota do stream (por exemplo /live.sdp)
* Lan√ßar ataques de dicion√°rio automatizados para obter o nome de usu√°rio e senha das c√¢meras
* Gerar miniaturas para verificar se os streams s√£o v√°lidos e ter uma pr√©via r√°pida do conte√∫do
* Tentar criar um pipeline do Gstreamer para verificar se est√£o codificados corretamente
* Imprimir um resumo de todas as informa√ß√µes que o Cameradar p√¥de obter

## Refer√™ncias

* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><strong>Aprenda hacking na AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
