## Informa√ß√µes B√°sicas

> O **Real Time Streaming Protocol** (**RTSP**) √© um protocolo de controle de rede projetado para uso em sistemas de entretenimento e comunica√ß√µes para controlar servidores de m√≠dia de streaming. O protocolo √© usado para estabelecer e controlar sess√µes de m√≠dia entre pontos finais. Os clientes dos servidores de m√≠dia emitem comandos no estilo VHS, como reproduzir, gravar e pausar, para facilitar o controle em tempo real do streaming de m√≠dia do servidor para um cliente (V√≠deo sob Demanda) ou de um cliente para o servidor (Grava√ß√£o de Voz).
>
> A transmiss√£o de dados de streaming em si n√£o √© uma tarefa do RTSP. A maioria dos servidores RTSP usa o Protocolo de Transporte em Tempo Real (RTP) em conjunto com o Protocolo de Controle em Tempo Real (RTCP) para a entrega de fluxo de m√≠dia. No entanto, alguns fornecedores implementam protocolos de transporte propriet√°rios. O software do servidor RTSP da RealNetworks, por exemplo, tamb√©m usava o Real Data Transport (RDT) propriet√°rio da RealNetworks.

De [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol).

**Portas padr√£o:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Informa√ß√£o Detalhada

Em primeiro lugar, o RTSP √© um protocolo semelhante ao HTTP. Ele tem uma estrutura diferente e comandos de controle, mas √© textual em seu formato e, uma vez que voc√™ aprende os conceitos b√°sicos dos comandos e como eles interagem, √© bastante f√°cil de usar. A especifica√ß√£o para o RTSP √© bastante direta. Aqui est√° um link para ela:

[RTSP - RFC2326](https://tools.ietf.org/html/rfc2326)

O RTSP pode ser acessado sem autentica√ß√£o (comum em dispositivos prontos para uso) ou autenticado. O acesso autenticado espelha o HTTP no sentido de que voc√™ tem autentica√ß√£o b√°sica e de digest√£o, ambas quase id√™nticas ao HTTP. Para descobrir se o seu dispositivo est√° autenticado ou n√£o autenticado, basta enviar uma solicita√ß√£o "DESCRIBE". Uma solicita√ß√£o DESCRIBE simples se parece com:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\n\r`

Nota: o " \r\n" adicional √© necess√°rio para uma resposta confi√°vel. Alguns sistemas aceitar√£o o √∫nico " \r\n", mas a maioria n√£o.

Isso pode ser enviado por um soquete bruto. Assim como o HTTP, uma resposta bem-sucedida indicando acesso n√£o autenticado estar√° dispon√≠vel e conter√° um "200 OK". Neste caso, com DESCRIBE, ele tamb√©m conter√° todos os par√¢metros operacionais da transmiss√£o de v√≠deo.

Se o dispositivo exigir autentica√ß√£o, a resposta de volta conter√° "401 N√£o autorizado". A resposta tamb√©m indicar√° quais mecanismos de autentica√ß√£o est√£o dispon√≠veis. Se a autentica√ß√£o b√°sica estiver dispon√≠vel, a string de resposta conter√° uma linha de informa√ß√£o que tem "WWW-Authenticate: Basic". O restante das informa√ß√µes fornecidas com a autentica√ß√£o b√°sica √© em grande parte irrelevante para realizar a autentica√ß√£o b√°sica.

Se a autentica√ß√£o de digest√£o for necess√°ria, ent√£o a resposta "401 N√£o autorizado" ter√° uma linha de informa√ß√£o contendo "WWW-Authenticate: Digest". As informa√ß√µes com a especifica√ß√£o de Digest s√£o muito importantes se voc√™ for fazer autentica√ß√£o de Digest, ent√£o n√£o as ignore.

A autentica√ß√£o b√°sica √© o caminho a percorrer, esperan√ßosamente a resposta recebida indica que ela est√° dispon√≠vel. Caso contr√°rio, existem tr√™s m√©todos diferentes para montar um elemento de autentica√ß√£o de Digest, ent√£o Digest pode se tornar problem√°tico, especialmente √†s cegas (n√£o autenticado). O restante deste artigo se concentrar√° na autentica√ß√£o b√°sica. Eu posso escrever um artigo de acompanhamento mais tarde, uma vez que eu decifrar o segredo para fazer autentica√ß√£o de Digest √†s cegas.

Para formular um elemento de autentica√ß√£o b√°sica, basta codificar em base 64 \<username> ":" \<password> e adicion√°-lo √† solicita√ß√£o. Ent√£o, uma nova solicita√ß√£o ficaria assim:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r`

Novamente, observe que a solicita√ß√£o √© encerrada com o duplo " \r\n".

O valor YWRtaW46MTIzNA== √© o nome de usu√°rio codificado em base 64 e a senha concatenada com ":". Neste caso, usei "admin" / "1234". Alguns scripts simples em Python para experimentar isso parecem:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
Voila! Voc√™ tem acesso.

**De:** [**http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/**](https://web.archive.org/web/20161020202643/http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)

## Enumera√ß√£o

Vamos obter informa√ß√µes sobre os m√©todos v√°lidos e URLs suportados e tentar for√ßar o acesso (se necess√°rio) para obter acesso ao conte√∫do.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [For√ßa Bruta](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Outros programas √∫teis**

Para for√ßa bruta: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

**Cameradar**

Cameradar permite que voc√™:

* Detecte hosts RTSP abertos em qualquer alvo acess√≠vel
* Obtenha suas informa√ß√µes p√∫blicas (nome do host, porta, modelo da c√¢mera, etc.)
* Inicie ataques de dicion√°rio automatizados para obter a rota do fluxo (por exemplo, /live.sdp)
* Inicie ataques de dicion√°rio automatizados para obter o nome de usu√°rio e senha das c√¢meras
* Gere miniaturas para verificar se os fluxos s√£o v√°lidos e ter uma visualiza√ß√£o r√°pida do conte√∫do
* Tente criar um pipeline Gstreamer para verificar se eles est√£o codificados corretamente
* Imprima um resumo de todas as informa√ß√µes que o Cameradar pode obter
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e para o** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
