# 554,8554 - RTSP 펜테스팅

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)을 **팔로우**하세요.
* **HackTricks**와 **HackTricks Cloud** github 저장소에 PR을 제출하여 **해킹 트릭을 공유**하세요.

</details>

## 기본 정보

[wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)에서 가져온 내용:

> **실시간 스트리밍 프로토콜** (**RTSP**)은 엔터테인먼트 및 통신 시스템에서 사용하기 위해 설계된 네트워크 제어 프로토콜로, 스트리밍 미디어 서버를 제어하는 데 사용됩니다. 이 프로토콜은 엔드 포인트 간의 미디어 세션을 설정하고 제어하는 데 사용됩니다. 미디어 서버의 클라이언트는 VHS 스타일의 명령(재생, 녹화, 일시 정지 등)을 사용하여 서버에서 클라이언트로의 미디어 스트리밍(Video On Demand) 또는 클라이언트에서 서버로의 미디어 스트리밍(음성 녹음)을 실시간으로 제어합니다.
>
> 스트리밍 데이터의 전송 자체는 RTSP의 작업이 아닙니다. 대부분의 RTSP 서버는 미디어 스트림 전달을 위해 실시간 전송 프로토콜(RTP)과 실시간 제어 프로토콜(RTCP)을 함께 사용합니다. 그러나 일부 공급업체는 독점적인 전송 프로토콜을 구현하기도 합니다. 예를 들어 RealNetworks의 RTSP 서버 소프트웨어는 RealNetworks의 독점적인 Real Data Transport (RDT)도 사용합니다.

**기본 포트:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## 주요 사항

**RTSP**는 HTTP와 유사하지만 미디어 스트리밍을 위해 특별히 설계되었습니다. 이는 간단한 명세로 정의되어 있으며 다음에서 찾을 수 있습니다:

[RTSP - RFC2326](https://tools.ietf.org/html/rfc2326)

장치는 **인증되지 않은** 또는 **인증된** 액세스를 허용할 수 있습니다. 확인하기 위해 "DESCRIBE" 요청을 보냅니다. 기본 예제는 다음과 같습니다:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\n`

올바른 형식은 일관된 응답을 위해 이중 "\r\n"을 포함해야 합니다. "200 OK" 응답은 **인증되지 않은 액세스**를 나타내며, "401 Unauthorized"는 인증이 필요하며 **Basic 인증** 또는 **Digest 인증**이 필요한지를 나타냅니다.

**Basic 인증**의 경우, 사용자 이름과 비밀번호를 base64로 인코딩하여 요청에 포함시킵니다:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n`

이 예제는 자격 증명으로 "admin"과 "1234"를 사용합니다. 다음은 이러한 요청을 보내기 위한 **Python 스크립트**입니다:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**기본 인증**은 더 간단하고 선호됩니다. **다이제스트 인증**은 "401 Unauthorized" 응답에서 제공된 인증 세부 정보를 주의 깊게 처리해야 합니다.

이 개요에서는 초기 시도에서의 간단함과 실용성을 위해 **기본 인증**에 초점을 맞추어 RTSP 스트림에 액세스하는 과정을 단순화합니다.


## 열거

유효한 메서드와 URL에 대한 정보를 얻고, 필요한 경우 액세스를 무차별 대입(brute-force)하여 콘텐츠에 액세스합니다.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [무차별 대입 공격](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **유용한 다른 프로그램들**

무차별 대입 공격에 사용할 수 있는 프로그램: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* 접근 가능한 모든 대상에서 열린 RTSP 호스트를 감지합니다.
* 호스트의 공개 정보(호스트명, 포트, 카메라 모델 등)를 가져옵니다.
* 스트림 경로(예: /live.sdp)를 얻기 위해 자동 사전 공격을 실행합니다.
* 카메라의 사용자 이름과 비밀번호를 얻기 위해 자동 사전 공격을 실행합니다.
* 유효한 스트림인지 확인하고 내용의 빠른 미리보기를 위해 썸네일을 생성합니다.
* 올바르게 인코딩되었는지 확인하기 위해 Gstreamer 파이프라인을 생성하려고 시도합니다.
* Cameradar가 얻을 수 있는 모든 정보에 대한 요약을 출력합니다.

## 참고 자료
* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>를 통해 AWS 해킹을 초보부터 전문가까지 배워보세요</strong></a><strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 상품**](https://peass.creator-spring.com)을 구매하세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)을 **팔로우**하세요.
* **HackTricks**와 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하여 여러분의 해킹 기법을 공유하세요.

</details>
