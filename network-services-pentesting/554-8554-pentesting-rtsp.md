# 554,8554 - Pentesting RTSP

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informations de base

> Le **Real Time Streaming Protocol** (**RTSP**) est un protocole de contr√¥le r√©seau con√ßu pour √™tre utilis√© dans les syst√®mes de divertissement et de communication afin de contr√¥ler les serveurs de m√©dias en streaming. Le protocole est utilis√© pour √©tablir et contr√¥ler des sessions multim√©dias entre des points d'extr√©mit√©. Les clients des serveurs multim√©dias √©mettent des commandes de style VHS, telles que play, record et pause, pour faciliter le contr√¥le en temps r√©el du streaming multim√©dia du serveur vers un client (Video On Demand) ou d'un client vers le serveur (Voice Recording).
>
> La transmission des donn√©es de streaming en elle-m√™me n'est pas une t√¢che du RTSP. La plupart des serveurs RTSP utilisent le Real-time Transport Protocol (RTP) en conjonction avec le Real-time Control Protocol (RTCP) pour la livraison du flux multim√©dia. Cependant, certains fournisseurs mettent en ≈ìuvre des protocoles de transport propri√©taires. Par exemple, le logiciel de serveur RTSP de RealNetworks utilise √©galement le Real Data Transport (RDT) propri√©taire de RealNetworks.

D'apr√®s [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol).

**Ports par d√©faut :** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Informations d√©taill√©es

Tout d'abord, RTSP est un protocole similaire √† HTTP. Il a une structure diff√©rente et des commandes de contr√¥le, mais il est textuel dans son format et une fois que vous avez appris les bases des commandes et de leur interaction, il est assez facile √† utiliser. La sp√©cification pour RTSP est assez simple. Voici un lien vers celle-ci :

[RTSP ‚Äì RFC2326](https://tools.ietf.org/html/rfc2326)

RTSP peut √™tre acc√©d√© sans authentification (courant dans les appareils pr√™ts √† l'emploi) ou avec authentification. L'acc√®s authentifi√© est similaire √† HTTP en ce sens que vous avez une authentification de type Basic et Digest, toutes deux presque identiques √† HTTP. Pour savoir si votre appareil n√©cessite une authentification ou non, envoyez simplement une requ√™te ‚ÄúDESCRIBE‚Äù. Une requ√™te DESCRIBE simple ressemble √† :

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\n`

Note : l'ajout de ‚Äú\r\n‚Äù suppl√©mentaires est n√©cessaire pour une r√©ponse fiable. Certains syst√®mes accepteront le simple ‚Äú\r\n‚Äù, mais la plupart non.

Cela peut √™tre envoy√© via un socket brut. Comme pour HTTP, une r√©ponse r√©ussie indiquant qu'un acc√®s non authentifi√© est disponible contiendra un ‚Äú200 OK‚Äù. Dans ce cas avec DESCRIBE, cela inclura √©galement tous les param√®tres op√©rationnels du flux vid√©o.

Si l'appareil n√©cessite une authentification, la r√©ponse contiendra ‚Äú401 Unauthorized‚Äù. La r√©ponse indiquera √©galement quels m√©canismes d'authentification sont disponibles. Si l'authentification Basic est disponible, la cha√Æne de r√©ponse contiendra une ligne d'information qui a ‚ÄúWWW-Authenticate: Basic‚Äù. Le reste des informations fournies avec l'authentification Basic est largement sans importance pour effectuer r√©ellement une authentification de base.

Si une authentification Digest est requise, alors la r√©ponse ‚Äú401 Unauthorized‚Äù aura une ligne d'information contenant ‚ÄúWWW-Authenticate: Digest‚Äù. Les informations avec la sp√©cification Digest SONT tr√®s importantes si vous allez faire une authentification Digest, donc ne les ignorez pas.

L'authentification Basic est la voie √† suivre, esp√©rons que la r√©ponse re√ßue indique qu'elle est disponible. Sinon, il existe trois m√©thodes diff√©rentes pour assembler un √©l√©ment d'authentification Digest, donc Digest peut devenir probl√©matique, surtout √† l'aveugle (non authentifi√©). Le reste de cet article se concentrera sur l'authentification Basic. Je pourrais √©crire un article de suivi plus tard une fois que j'aurai d√©chiffr√© la recette secr√®te pour faire une authentification Digest √† l'aveugle.

Pour formuler un √©l√©ment d'authentification Basic, il suffit de coder en base 64 \<username> ‚Äú:‚Äù \<password> et de l'ajouter √† la requ√™te. Ainsi, une nouvelle requ√™te ressemblerait √† :

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n`

Notez √† nouveau que la requ√™te se termine par le double ‚Äú\r\n‚Äù.

La valeur YWRtaW46MTIzNA== est le nom d'utilisateur et le mot de passe encod√©s en base 64 et concat√©n√©s avec ‚Äú:‚Äù. Dans ce cas, j'ai utilis√© ‚Äúadmin‚Äù/‚Äù1234‚Äù. Quelques scripts python simples pour essayer cela ressemblent √† :
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
Vous avez acc√®s.

**De :** [**http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/**](https://web.archive.org/web/20161020202643/http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)

## √ânum√©ration

Obtenons des informations sur les m√©thodes valides et les URL prises en charge et essayons de forcer brutalement l'acc√®s (si n√©cessaire) pour acc√©der au contenu.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Brute Force](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Autres programmes utiles**

Pour bruteforce : [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

**Cameradar**

Cameradar vous permet de :

* D√©tecter les h√¥tes RTSP ouverts sur toute cible accessible
* Obtenir leurs informations publiques (nom d'h√¥te, port, mod√®le de cam√©ra, etc.)
* Lancer des attaques automatis√©es par dictionnaire pour obtenir leur chemin de flux (par exemple /live.sdp)
* Lancer des attaques automatis√©es par dictionnaire pour obtenir le nom d'utilisateur et le mot de passe des cam√©ras
* G√©n√©rer des miniatures pour v√©rifier si les flux sont valides et pour avoir un aper√ßu rapide de leur contenu
* Essayer de cr√©er une pipeline Gstreamer pour v√©rifier s'ils sont correctement encod√©s
* Imprimer un r√©sum√© de toutes les informations que Cameradar a pu obtenir
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
