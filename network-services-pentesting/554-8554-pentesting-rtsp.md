# 554,8554 - Test di penetrazione RTSP

<details>

<summary><strong>Impara l'hacking AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se desideri vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**Gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos di github.

</details>

## Informazioni di Base

Da [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> Il **Real Time Streaming Protocol** (**RTSP**) √® un protocollo di controllo di rete progettato per l'uso in sistemi di intrattenimento e comunicazione per controllare i server multimediali in streaming. Il protocollo √® utilizzato per stabilire e controllare sessioni multimediali tra i punti finali. I client dei server multimediali emettono comandi in stile VHS, come play, record e pause, per facilitare il controllo in tempo reale dello streaming multimediale dal server a un client (Video On Demand) o da un client al server (Registrazione vocale).
>
> La trasmissione dei dati in streaming non √® un compito di RTSP. La maggior parte dei server RTSP utilizza il Real-time Transport Protocol (RTP) insieme al Real-time Control Protocol (RTCP) per la distribuzione dello stream multimediale. Tuttavia, alcuni fornitori implementano protocolli di trasporto proprietari. Ad esempio, il software del server RTSP di RealNetworks utilizzava anche il Real Data Transport (RDT) proprietario di RealNetworks.

**Porte predefinite:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Dettagli Chiave

**RTSP** √® simile all'HTTP ma progettato specificamente per lo streaming multimediale. √à definito in una specifica diretta che pu√≤ essere trovata qui:

[RTSP ‚Äì RFC2326](https://tools.ietf.org/html/rfc2326)

I dispositivi potrebbero permettere l'accesso **non autenticato** o **autenticato**. Per verificare, viene inviata una richiesta "DESCRIBE". Di seguito √® mostrato un esempio di base:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r`

Ricorda, il corretto formattazione include un doppio "\r\n" per una risposta coerente. Una risposta "200 OK" indica un **accesso non autenticato**, mentre "401 Unauthorized" segnala la necessit√† di autenticazione, rivelando se √® richiesta l'autenticazione **Basic** o **Digest**.

Per l'**autenticazione di base**, si codifica il nome utente e la password in base64 e li si include nella richiesta in questo modo:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r`

Questo esempio utilizza "admin" e "1234" come credenziali. Ecco uno **script Python** per inviare una tale richiesta:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**Autenticazione di base** √® pi√π semplice e preferita. L'**autenticazione digest** richiede un'attenta gestione dei dettagli di autenticazione forniti nella risposta "401 Non autorizzato".

Questa panoramica semplifica il processo di accesso ai flussi RTSP, concentrandosi sull'**autenticazione di base** per la sua semplicit√† e praticit√† nei tentativi iniziali.

## Enumerazione

Otteniamo informazioni sui metodi validi e sugli URL supportati e proviamo a forzare l'accesso (se necessario) per accedere ai contenuti.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Brute Force](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Altri programmi utili**

Per eseguire un attacco di forza bruta: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* Rileva host RTSP aperti su qualsiasi target accessibile
* Ottieni le loro informazioni pubbliche (nome host, porta, modello della telecamera, ecc.)
* Avvia attacchi di dizionario automatizzati per ottenere il percorso dello stream (ad esempio /live.sdp)
* Avvia attacchi di dizionario automatizzati per ottenere nome utente e password delle telecamere
* Genera miniature per controllare se gli stream sono validi e per avere un'anteprima rapida dei loro contenuti
* Prova a creare una pipeline Gstreamer per verificare se sono correttamente codificati
* Stampa un riepilogo di tutte le informazioni che Cameradar √® riuscito a ottenere

## Riferimenti

* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><strong>Impara l'hacking su AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se desideri vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
