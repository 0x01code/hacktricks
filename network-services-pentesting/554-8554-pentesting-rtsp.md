# 554,8554 - Πεντεστική επίθεση στο RTSP

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

## Βασικές πληροφορίες

Από την [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> Το **Real Time Streaming Protocol** (**RTSP**) είναι ένα πρωτόκολλο ελέγχου δικτύου που σχεδιάστηκε για χρήση σε συστήματα ψυχαγωγίας και επικοινωνίας για τον έλεγχο των διακομιστών μέσων ροής. Το πρωτόκολλο χρησιμοποιείται για την ίδρυση και έλεγχο των συνεδριών μέσων μεταξύ των σημείων άκρων. Οι πελάτες των διακομιστών μέσων εκδίδουν εντολές στυλ VHS, όπως αναπαραγωγή, εγγραφή και παύση, για να διευκολύνουν τον πραγματικό χρόνο έλεγχο της ροής των μέσων από τον διακομιστή σε έναν πελάτη (Video On Demand) ή από έναν πελάτη στον διακομιστή (Ηχογράφηση φωνής).
>
> Η μετάδοση των δεδομένων ροής καθαυτής δεν είναι μια εργασία του RTSP. Οι περισσότεροι διακομιστές RTSP χρησιμοποιούν το πρωτόκολλο μεταφοράς πραγματικού χρόνου (RTP) σε συνδυασμό με το πρωτόκολλο ελέγχου πραγματικού χρόνου (RTCP) για την παράδοση ροής μέσων. Ωστόσο, ορισμένοι προμηθευτές υλοποιούν προτοπρόσωπα πρωτόκολλα μεταφοράς. Το λογισμικό διακομιστή RTSP από την RealNetworks, για παράδειγμα, χρησιμοποιούσε επίσης το προτοπρόσωπο πρωτόκολλο μεταφοράς δεδομένων της RealNetworks (RDT).

**Προεπιλεγμένες θύρες:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Βασικές Πληροφορίες

Το **RTSP** είναι παρόμοιο με το HTTP, αλλά σχεδιάστηκε ειδικά για τη ροή πολυμέσων. Ορίζεται σε μια απλή προδιαγραφή που μπορείτε να βρείτε εδώ:

[RTSP - RFC2326](https://tools.ietf.org/html/rfc2326)

Οι συσκευές μπορεί να επιτρέπουν **μη εξουσιοδοτημένη** ή **εξουσιοδοτημένη** πρόσβαση. Για να το ελέγξετε, στέλνετε ένα αίτημα "DESCRIBE". Ένα βασικό παράδειγμα φαίνεται παρακάτω:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\n`

Θυμηθείτε, η σωστή μορφοποίηση περιλαμβάνει ένα διπλό "\r\n" για μια συνεπή απόκριση. Μια απόκριση "200 OK" υποδηλώνει **μη εξουσιοδοτημένη πρόσβαση**, ενώ η "401 Unauthorized" υποδεικνύει την ανάγκη για εξουσιοδότηση, αποκαλύπτοντας εάν απαιτείται **βασική εξουσιοδότηση** ή **αποτύπωση εξουσιοδότησης**.

Για τη **βασική εξουσιοδότηση**, κωδικοποιείτε το όνομα χρήστη και τον κωδικό πρόσβασης σε base64 και το περιλαμβάνετε στο αίτημα ως εξής:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n`

Αυτό το παράδειγμα χρησιμοποιεί τα διαπιστευτήρια "admin" και "1234". Παρακάτω υπάρχει ένα **Python script** για να στείλετε ένα τέτοιο αίτημα:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**Βασική πιστοποίηση** είναι πιο απλή και προτιμητέα. Η **πιστοποίηση με διαχείριση** απαιτεί προσεκτική χειρισμό των στοιχείων πιστοποίησης που παρέχονται στην απάντηση "401 Unauthorized".

Αυτή η επισκόπηση απλοποιεί τη διαδικασία πρόσβασης σε ροές RTSP, επικεντρώνοντας στη **βασική πιστοποίηση** για την απλότητα και την πρακτικότητά της στις αρχικές προσπάθειες.


## Απαρίθμηση

Ας αποκτήσουμε πληροφορίες σχετικά με τις έγκυρες μεθόδους και τις υποστηριζόμενες διευθύνσεις URL και ας προσπαθήσουμε να εκτελέσουμε επίθεση με βία για να αποκτήσουμε πρόσβαση στο περιεχόμενο (αν χρειαστεί).
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Βίαιη Δύναμη](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Άλλα χρήσιμα προγράμματα**

Για βίαιη δύναμη: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* Ανίχνευση ανοιχτών RTSP κόμβων σε οποιοδήποτε προσβάσιμο στόχο
* Λήψη δημόσιων πληροφοριών για αυτούς (όνομα κεντρικού υπολογιστή, θύρα, μοντέλο κάμερας κ.λπ.)
* Εκτέλεση αυτόματων επιθέσεων λεξικού για να λάβετε τη διαδρομή ροής (π.χ. /live.sdp)
* Εκτέλεση αυτόματων επιθέσεων λεξικού για να λάβετε το όνομα χρήστη και τον κωδικό πρόσβασης των καμερών
* Δημιουργία μικρογραφιών από αυτές για να ελέγξετε αν οι ροές είναι έγκυρες και για να έχετε μια γρήγορη προεπισκόπηση του περιεχομένου τους
* Προσπάθεια δημιουργίας ενός αγωγού Gstreamer για να ελέγξετε αν έχουν κωδικοποιηθεί σωστά
* Εκτύπωση σύνοψης όλων των πληροφοριών που μπορεί να λάβει το Cameradar

## Αναφορές
* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι υποστήριξης του HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** Ελέγξτε τα [**ΠΑΚΕΤΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
