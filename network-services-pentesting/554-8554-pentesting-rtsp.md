# 554,8554 - Pentesting RTSP

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Red Team de AWS de HackTricks)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>

## Informaci√≥n B√°sica

Desde [wikipedia](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol):

> El **Protocolo de Transmisi√≥n en Tiempo Real** (**RTSP**) es un protocolo de control de red dise√±ado para su uso en sistemas de entretenimiento y comunicaciones para controlar servidores de medios de transmisi√≥n. El protocolo se utiliza para establecer y controlar sesiones de medios entre puntos finales. Los clientes de los servidores de medios emiten comandos estilo VHS, como reproducir, grabar y pausar, para facilitar el control en tiempo real de la transmisi√≥n de medios desde el servidor a un cliente (Video On Demand) o desde un cliente al servidor (Grabaci√≥n de Voz).
>
> La transmisi√≥n de datos de transmisi√≥n en s√≠ no es una tarea de RTSP. La mayor√≠a de los servidores RTSP utilizan el Protocolo de Transporte en Tiempo Real (RTP) en conjunto con el Protocolo de Control en Tiempo Real (RTCP) para la entrega de transmisi√≥n de medios. Sin embargo, algunos proveedores implementan protocolos de transporte propietarios. El software del servidor RTSP de RealNetworks, por ejemplo, tambi√©n utilizaba el Transporte de Datos Real (RDT) propietario de RealNetworks.

**Puertos predeterminados:** 554,8554
```
PORT    STATE SERVICE
554/tcp open  rtsp
```
## Detalles Clave

**RTSP** es similar a HTTP pero dise√±ado espec√≠ficamente para la transmisi√≥n de medios. Est√° definido en una especificaci√≥n directa que se puede encontrar aqu√≠:

[RTSP ‚Äì RFC2326](https://tools.ietf.org/html/rfc2326)

Los dispositivos pueden permitir acceso **sin autenticaci√≥n** o **autenticado**. Para verificar, se env√≠a una solicitud "DESCRIBE". A continuaci√≥n se muestra un ejemplo b√°sico:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\n`

Recuerda, el formato correcto incluye un doble "\r\n" para una respuesta consistente. Una respuesta "200 OK" indica **acceso sin autenticaci√≥n**, mientras que "401 Unauthorized" se√±ala la necesidad de autenticaci√≥n, revelando si se requiere **autenticaci√≥n B√°sica** o **Digest**.

Para **autenticaci√≥n B√°sica**, codificas el nombre de usuario y la contrase√±a en base64 e incl√∫yelos en la solicitud de la siguiente manera:

`DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n`

Este ejemplo utiliza "admin" y "1234" como credenciales. Aqu√≠ tienes un **script en Python** para enviar dicha solicitud:
```python
import socket
req = "DESCRIBE rtsp://<ip>:<port> RTSP/1.0\r\nCSeq: 2\r\nAuthorization: Basic YWRtaW46MTIzNA==\r\n\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.1.1", 554))
s.sendall(req)
data = s.recv(1024)
print(data)
```
**Autenticaci√≥n b√°sica** es m√°s simple y preferida. **Autenticaci√≥n digest** requiere un manejo cuidadoso de los detalles de autenticaci√≥n proporcionados en la respuesta "401 No autorizado".

Esta visi√≥n general simplifica el proceso de acceso a flujos RTSP, centr√°ndose en la **autenticaci√≥n b√°sica** por su simplicidad y practicidad en intentos iniciales.


## Enumeraci√≥n

Obtenemos informaci√≥n sobre los m√©todos v√°lidos y las URL admitidas y tratamos de forzar el acceso (si es necesario) para acceder al contenido.
```bash
nmap -sV --script "rtsp-*" -p <PORT> <IP>
```
### [Fuerza bruta](../generic-methodologies-and-resources/brute-force.md#rtsp)

### **Otros programas √∫tiles**

Para realizar fuerza bruta: [https://github.com/Tek-Security-Group/rtsp\_authgrinder](https://github.com/Tek-Security-Group/rtsp\_authgrinder)

[**Cameradar**](https://github.com/Ullaakut/cameradar)

* Detecta hosts RTSP abiertos en cualquier objetivo accesible
* Obtiene su informaci√≥n p√∫blica (nombre de host, puerto, modelo de c√°mara, etc.)
* Lanza ataques de diccionario automatizados para obtener la ruta de transmisi√≥n (por ejemplo /live.sdp)
* Lanza ataques de diccionario automatizados para obtener el nombre de usuario y la contrase√±a de las c√°maras
* Genera miniaturas de ellas para verificar si las transmisiones son v√°lidas y tener una vista previa r√°pida de su contenido
* Intenta crear una canalizaci√≥n de Gstreamer para verificar si est√°n codificadas correctamente
* Imprime un resumen de toda la informaci√≥n que Cameradar pudo obtener

## Referencias
* [https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol](https://en.wikipedia.org/wiki/Real\_Time\_Streaming\_Protocol)
* [http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/](http://badguyfu.net/rtsp-brute-forcing-for-fun-and-naked-pictures/)
* [https://github.com/Ullaakut/cameradar](https://github.com/Ullaakut/cameradar)

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
