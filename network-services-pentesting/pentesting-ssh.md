# 22 - Pentesting SSH/SFTP

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рди**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

рдЕрдЧрд░ рдЖрдк **рд╣реИрдХрд┐рдВрдЧ рдХрд░рд┐рдпрд░** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдЕрд╣реИрдХреЗрдмрд▓ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - **рд╣рдо рднрд░реНрддреА рдХрд░ рд░рд╣реЗ рд╣реИрдВ!** (_рдлреНрд▓реВрдПрдВрдЯ рдкреЛрд▓рд┐рд╢ рд▓рд┐рдЦрд┐рдд рдФрд░ рдмреЛрд▓реА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП_).

{% embed url="https://www.stmcyber.com/careers" %}

## рдореМрд▓рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

**SSH (Secure Shell рдпрд╛ Secure Socket Shell)** рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬреЛ рдПрдХ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдХрдВрдкреНрдпреВрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрдиреЗрдХреНрд╢рди рд╕рдХреНрд╖рдо рдХрд░рддрд╛ рд╣реИред рдпрд╣ рджреВрд░рд╕реНрде рд╕рд┐рд╕реНрдЯрдо рддрдХ рдкрд╣реБрдВрдЪрддреЗ рд╕рдордп рдбреЗрдЯрд╛ рдХреА рдЧреЛрдкрдиреАрдпрддрд╛ рдФрд░ рдЕрдЦрдВрдбрддрд╛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 22
```
22/tcp open  ssh     syn-ack
```
**SSH рд╕рд░реНрд╡рд░:**

* [openSSH](http://www.openssh.org) тАУ OpenBSD SSH, BSD, Linux рд╡рд┐рддрд░рдгреЛрдВ рдФрд░ Windows рдореЗрдВ рд╢рд┐рдк рд╣реЛрддрд╛ рд╣реИ рдЬреЛ Windows 10 рд╕реЗ рд╢реБрд░реВ рд╣реБрдЖ
* [Dropbear](https://matt.ucc.asn.au/dropbear/dropbear.html) тАУ рдХрдо рдореЗрдореЛрд░реА рдФрд░ рдкреНрд░реЛрд╕реЗрд╕рд░ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рд╡рд╛рд▓реЗ рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП SSH рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди, OpenWrt рдореЗрдВ рд╢рд┐рдк рд╣реЛрддрд╛ рд╣реИ
* [PuTTY](https://www.chiark.greenend.org.uk/\~sgtatham/putty/) тАУ Windows рдХреЗ рд▓рд┐рдП SSH рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди, рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд╛рдорд╛рдиреНрдпрдд: рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдзрд┐рдХ рджреБрд░реНрд▓рдн рд╣реИ
* [CopSSH](https://www.itefix.net/copssh) тАУ Windows рдХреЗ рд▓рд┐рдП OpenSSH рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди

**SSH рдкреБрд╕реНрддрдХрд╛рд▓рдп (рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдирд╛):**

* [libssh](https://www.libssh.org) тАУ SSHv2 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА рдорд▓реНрдЯреАрдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рд╕реА рдкреБрд╕реНрддрдХрд╛рд▓рдп рдЬрд┐рд╕рдореЗрдВ [Python](https://github.com/ParallelSSH/ssh-python), [Perl](https://github.com/garnier-quentin/perl-libssh/) рдФрд░ [R](https://github.com/ropensci/ssh) рдореЗрдВ рдмрд╛рдЗрдВрдбрд┐рдВрдЧ рд╣реИ; рдпрд╣ KDE рджреНрд╡рд╛рд░рд╛ sftp рдХреЗ рд▓рд┐рдП рдФрд░ GitHub рджреНрд╡рд╛рд░рд╛ git SSH рдмреБрдирд┐рдпрд╛рдж рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ
* [wolfSSH](https://www.wolfssl.com/products/wolfssh/) тАУ ANSI C рдореЗрдВ рд▓рд┐рдЦреА рдЧрдИ SSHv2 рд╕рд░реНрд╡рд░ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдЬреЛ рдПрдореНрдмреЗрдбреЗрдб, рдЖрд░рдЯреАрдУрдПрд╕, рдФрд░ рд╕рдВрд╕рд╛рдзрди-рд╕реАрдорд┐рдд рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рд▓рдХреНрд╖рд┐рдд рд╣реИ
* [Apache MINA SSHD](https://mina.apache.org/sshd-project/index.html) тАУ Apache SSHD рдЬрд╛рд╡рд╛ рдкреБрд╕реНрддрдХрд╛рд▓рдп Apache MINA рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ
* [paramiko](https://github.com/paramiko/paramiko) тАУ Python SSHv2 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкреБрд╕реНрддрдХрд╛рд▓рдп

## рдЧрдгрдирд╛

### рдмреИрдирд░ рдЧреНрд░рдмрд┐рдВрдЧ
```bash
nc -vn <IP> 22
```
### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд ssh-audit

ssh-audit рдПрдХ рдЯреВрд▓ рд╣реИ рдЬреЛ ssh рд╕рд░реНрд╡рд░ рдФрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА рдорд╛рдиреНрдпрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рд╣реИред

[https://github.com/jtesta/ssh-audit](https://github.com/jtesta/ssh-audit) рдПрдХ рдЕрдкрдбреЗрдЯреЗрдб fork рд╣реИ [https://github.com/arthepsy/ssh-audit/](https://github.com/arthepsy/ssh-audit/)

**рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ:**

* SSH1 рдФрд░ SSH2 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕рд░реНрд╡рд░ рд╕рдорд░реНрдерди;
* SSH рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг;
* рдмреИрдирд░ рдкрдХрдбрд╝реЗрдВ, рдбрд┐рд╡рд╛рдЗрд╕ рдпрд╛ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдФрд░ рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдкрд╣рдЪрд╛рдиреЗрдВ, рд╕рдВрдкреАрдбрд╝рди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ;
* рдХреБрдВрдЬреА-рд╡рд┐рдирд┐рдордп, рд╣реЛрд╕реНрдЯ-рдХреБрдВрдЬреА, рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдФрд░ рд╕рдВрджреЗрд╢ рд╕рддреНрдпрд╛рдкрди рдХреЛрдб рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд░реЗрдВ;
* рдПрд▓реНрдЧреЛрд░рд┐рджрдо рд╕реВрдЪрдирд╛ рдЙрддреНрдкрд╛рджрди (рдЙрдкрд▓рдмреНрдз рдХрдм рд╕реЗ, рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛/рдЕрдХреНрд╖рдо, рдЕрд╕реБрд░рдХреНрд╖рд┐рдд/рдХрдордЬреЛрд░/рдкреБрд░рд╛рдирд╛, рдЖрджрд┐);
* рдПрд▓реНрдЧреЛрд░рд┐рджрдо рд╕рд┐рдлрд╛рд░рд┐рд╢реЗрдВ рдЙрддреНрдкрд╛рджрди (рдкрд╣рдЪрд╛рдиреЗ рдЧрдП рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЬреЛрдбрд╝реЗрдВ рдпрд╛ рд╣рдЯрд╛рдПрдВ);
* рд╕реБрд░рдХреНрд╖рд╛ рд╕реВрдЪрдирд╛ рдЙрддреНрдкрд╛рджрди (рд╕рдВрдмрдВрдзрд┐рдд рдореБрджреНрджреЗ, рдирд┐рд░реНрдзрд╛рд░рд┐рдд CVE рд╕реВрдЪреА, рдЖрджрд┐);
* рдПрд▓реНрдЧреЛрд░рд┐рджрдо рд╕реВрдЪрдирд╛ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ SSH рд╕рдВрд╕реНрдХрд░рдг рд╕рдВрдЧрддрддрд╛ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг;
* OpenSSH, Dropbear SSH рдФрд░ libssh рд╕реЗ рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рд╕реВрдЪрдирд╛;
* Linux рдФрд░ Windows рдкрд░ рдЪрд▓рддрд╛ рд╣реИ;
* рдХреЛрдИ рдирд┐рд░реНрднрд░рддрд╛ рдирд╣реАрдВ
```bash
usage: ssh-audit.py [-1246pbcnjvlt] <host>

-1,  --ssh1             force ssh version 1 only
-2,  --ssh2             force ssh version 2 only
-4,  --ipv4             enable IPv4 (order of precedence)
-6,  --ipv6             enable IPv6 (order of precedence)
-p,  --port=<port>      port to connect
-b,  --batch            batch output
-c,  --client-audit     starts a server on port 2222 to audit client
software config (use -p to change port;
use -t to change timeout)
-n,  --no-colors        disable colors
-j,  --json             JSON output
-v,  --verbose          verbose output
-l,  --level=<level>    minimum output level (info|warn|fail)
-t,  --timeout=<secs>   timeout (in seconds) for connection and reading
(default: 5)
$ python3 ssh-audit <IP>
```
### рд╕рд░реНрд╡рд░ рдХреА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ SSH рдХреБрдВрдЬреА
```bash
ssh-keyscan -t rsa <IP> -p <PORT>
```
### рдХрдордЬреЛрд░ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдПрд▓реНрдЧреЛрд░рд┐рджрдо

рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **nmap** рджреНрд╡рд╛рд░рд╛ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИред рд▓реЗрдХрд┐рди рдЖрдк **sslcan** рдпрд╛ **sslyze** рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

### Nmap рд╕реНрдХреНрд░рд┐рдкреНрдЯ
```bash
nmap -p22 <ip> -sC # Send default nmap scripts for SSH
nmap -p22 <ip> -sV # Retrieve version
nmap -p22 <ip> --script ssh2-enum-algos # Retrieve supported algorythms
nmap -p22 <ip> --script ssh-hostkey --script-args ssh_hostkey=full # Retrieve weak keys
nmap -p22 <ip> --script ssh-auth-methods --script-args="ssh.user=root" # Check authentication methods
```
### рд╢реЛрдбрди

* `ssh`

## рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо, рдкрд╛рд╕рд╡рд░реНрдб рдФрд░ рдирд┐рдЬреА рдХреБрдВрдЬреА

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рд╕реВрдЪреАрдХрд░рдг

рдХреБрдЫ OpenSSH рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ рдЖрдк рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕реВрдЪреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдордп рдЖрдХреНрд░рдордг рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рдЗрд╕реЗ рдЙрддреНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореЗрдЯрд╛рд╕реНрдкреНрд▓реЙрдЗрдЯ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
msf> use scanner/ssh/ssh_enumusers
```
### [рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕](../generic-methodologies-and-resources/brute-force.md#ssh)

рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп ssh рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ [рдпрд╣рд╛рдБ](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/ssh-betterdefaultpasslist.txt) рдФрд░ [рдпрд╣рд╛рдБ](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/top-20-common-SSH-passwords.txt) рдФрд░ рдиреАрдЪреЗред

### рдирд┐рдЬреА рдХреБрдВрдЬреА рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕

рдЕрдЧрд░ рдЖрдкрдХреЛ рдХреБрдЫ ssh рдирд┐рдЬреА рдХреБрдВрдЬреА рдкрддрд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ... рддреЛ рдЗрд╕реЗ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред рдЖрдк nmap рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
https://nmap.org/nsedoc/scripts/ssh-publickey-acceptance.html
```
рдпрд╛ MSF рдЕрддрд┐рд░рд┐рдХреНрдд рдореЙрдбреНрдпреВрд▓:
```
msf> use scanner/ssh/ssh_identify_pubkeys
```
#### рдпрд╛ `ssh-keybrute.py` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ (рдиреЗрдЯрд┐рд╡ рдкрд╛рдпрдерди3, рд╣рд▓реНрдХрд╛ рдФрд░ рдкреБрд░рд╛рдиреЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рд╕рдХреНрд╖рдо): [snowdroppe/ssh-keybrute](https://github.com/snowdroppe/ssh-keybrute).

#### рдпрд╣рд╛рдБ рдЬреНрдЮрд╛рдд рдмреБрд░реА рдХреБрдВрдЬреА рдорд┐рд▓ рд╕рдХрддреА рд╣реИ:

{% embed url="https://github.com/rapid7/ssh-badkeys/tree/master/authorized" %}

#### рдХрдордЬреЛрд░ SSH рдХреБрдВрдЬреА / Debian рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рдирдиреАрдп PRNG

рдХреБрдЫ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдореЗрдВ рдПрдХреНрд╕рд░реЛрдЯрд┐рдХ рд╕рд╛рдордЧреНрд░реА рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдмреАрдЬ рдореЗрдВ рдЬреНрдЮрд╛рдд рджреЛрд╖ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рд╕реЗ рдПрдХ рджреНрд░реБрдд рддрд╛рд▓рд┐рдХрд╛ рдХрдо рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрд┐рд╕реЗ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред Debian рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдЙрддреНрдкрдиреНрди рдХрдордЬреЛрд░ PRNG рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рд╕рд┐рд╕реНрдЯрдореЛрдВ рдкрд░ рдкреВрд░реНрд╡-рдЙрддреНрдкрдиреНрди рдХреБрдВрдЬреА рдХреЗ рд╕реЗрдЯ рдпрд╣рд╛рдБ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ: [g0tmi1k/debian-ssh](https://github.com/g0tmi1k/debian-ssh).

рдЖрдкрдХреЛ рдпрд╣рд╛рдБ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рдкреАрдбрд╝рд┐рдд рдорд╢реАрди рдХреЗ рд▓рд┐рдП рд╡реИрдз рдХреБрдВрдЬреА рдЦреЛрдЬ рд╕рдХреЗрдВред

### рдХреЗрд░рдмреЗрд░реЛрд╕

**crackmapexec** `ssh` рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдХреЗрд░рдмреЗрд░реЛрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд▓реНрдк `--kerberos` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИред\
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП `crackmapexec ssh --help` рдЪрд▓рд╛рдПрдВред

## рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕

| **рд╡рд┐рдХреНрд░реЗрддрд╛** | **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо**                                                                                         | **рдкрд╛рд╕рд╡рд░реНрдб**                                                                                                                                                                                              |
| ---------- | ----------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| APC        | apc, рдбрд┐рд╡рд╛рдЗрд╕                                                                                                 | apc                                                                                                                                                                                                        |
| Brocade    | рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ                                                                                                       | admin123, password, brocade, fibranne                                                                                                                                                                      |
| Cisco      | рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ, cisco, рд╕рдХреНрд╖рдо рдХрд░реЗрдВ, hsa, pix, pnadmin, ripeop, рд░реВрдЯ, shelladmin                                           | admin, Admin123, default, password, secur4u, cisco, Cisco, \_Cisco, cisco123, C1sco!23, Cisco123, Cisco1234, TANDBERG, change\_it, 12345, ipics, pnadmin, diamond, hsadb, c, cc, attack, blender, changeme |
| Citrix     | рд░реВрдЯ, nsroot, nsmaint, vdiadmin, kvm, cli, рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ                                                            | C1trix321, nsroot, nsmaint, kaviza, kaviza123, freebsd, public, rootadmin, wanscaler                                                                                                                       |
| D-Link     | рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛                                                                                                 | private, admin, user                                                                                                                                                                                       |
| Dell       | рд░реВрдЯ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛1, рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ, vkernel, cli                                                                            | calvin, 123456, password, vkernel, Stor@ge!, admin                                                                                                                                                         |
| EMC        | рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ, рд░реВрдЯ, рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рд╢рд╛рд╕рдХ                                                                                       | EMCPMAdm7n, Password#1, Password123#, sysadmin, changeme, emc                                                                                                                                              |
| HP/3Com    | рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ, рд░реВрдЯ, vcx, app, spvar, manage, hpsupport, opc\_op                                                    | admin, password, hpinvent, iMC123, pvadmin, passw0rd, besgroup, vcx, nice, access, config, 3V@rpar, 3V#rpar, procurve, badg3r5, OpC\_op, !manage, !admin                                                   |
| Huawei     | рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ, рд░реВрдЯ                                                                                                 | 123456, admin, root, Admin123, Admin@storage, Huawei12#$, HwDec@01, hwosta2.0, HuaWei123, fsp200@HW, huawei123                                                                                             |
| IBM        | USERID, рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ, рдкреНрд░рдмрдВрдзрдХ, mqm, db2inst1, db2fenc1, dausr1, db2admin, iadmin, рд╕рд┐рд╕реНрдЯрдо, рдбрд┐рд╡рд╛рдЗрд╕, ufmcli, рдЧреНрд░рд╛рд╣рдХ | PASSW0RD, passw0rd, admin, password, Passw8rd, iadmin, apc, 123456, cust0mer                                                                                                                               |
| Juniper    | netscreen                                                                                                   | netscreen                                                                                                                                                                                                  |
| NetApp     | рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ                                                                                                       | netapp123                                                                                                                                                                                                  |
| Oracle     | рд░реВрдЯ, oracle, oravis, applvis, ilom-admin, ilom-operator, nm2user                                           | changeme, ilom-admin, ilom-operator, welcome1, oracle                                                                                                                                                      |
| VMware     | vi-admin, рд░реВрдЯ, hqadmin, vmware, рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ                                                                      | vmware, vmw@re, hqadmin, default                                                                                                                                                                           |

## SSH-MitM

рдпрджрд┐ рдЖрдк рдкреАрдбрд╝рд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдерд╛рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рд╣реИрдВ рдЬреЛ SSH рд╕рд░реНрд╡рд░ рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрдЯ рд╣реЛрдиреЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк **рдЙрди рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рдЪреБрд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП MitM рд╣рдорд▓рд╛ рдХрд░рдиреЗ** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

**рд╣рдорд▓реЗ рдХрд╛ рдорд╛рд░реНрдЧ:**

* **рдЯреНрд░реИрдлрд┐рдХ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди:** рд╣рдорд▓рд╛рд╡рд░ **рдкреАрдбрд╝рд┐рдд рдХрд╛ рдЯреНрд░реИрдлрд┐рдХ рдЕрдкрдиреА рдорд╢реАрди рдкрд░ рднрдЯрдХрд╛рддрд╛ рд╣реИ**, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ **SSH рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдХрдиреЗрдХреНрд╢рди рдХреЛ рдЕрдВрддрд░реНрд╡рд░реНрддреА** рдХрд░рддрд╛ рд╣реИред
* **рдЕрдВрддрд░реНрд╡рд░реНрддреАрдХрд░рдг рдФрд░ рд▓реЙрдЧрд┐рдВрдЧ:** рд╣рдорд▓рд╛рд╡рд░ рдХреА рдорд╢реАрди рдПрдХ **рдкреНрд░реЙрдХреНрд╕реА** рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддреА рд╣реИ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓реЙрдЧрд┐рди рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЛ **рдкрдХрдбрд╝рддреА** рд╣реИ рдЬреИрд╕реЗ рдХрд┐ рд╡рд╛рд╕реНрддрд╡рд┐рдХ SSH рд╕рд░реНрд╡рд░ рдмрдирдиреЗ рдХрд╛ рджрд╛рд╡рд╛ рдХрд░рддреЗ рд╣реБрдПред
* **рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди рдФрд░ рд░рд┐рд▓реЗ:** рдЕрдВрдд рдореЗрдВ, рд╣рдорд▓рд╛рд╡рд░ рдХреА рд╕рд░реНрд╡рд░ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рд▓реЙрдЧ рдХрд░рддреА рд╣реИ**, **рд╡рд╛рд╕реНрддрд╡рд┐рдХ SSH рд╕рд░реНрд╡рд░ рдкрд░ рдХрдорд╛рдВрдб рдлреЙрд░рд╡рд░реНрдб** рдХрд░рддреА рд╣реИ, **рдЙрдиреНрд╣реЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░рддреА рд╣реИ, рдФрд░ **рдкрд░рд┐рдгрд╛рдо рд╡рд╛рдкрд╕** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рднреЗрдЬрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕реБрдЧрдо рдФрд░ рд╡реИрдз рд▓рдЧрддреА рд╣реИред

[**SSH MITM**](https://github.com/jtesta/ssh-mitm) рдЙрд╕реА рдХреЛ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рд╣реИред

рд╡рд╛рд╕реНрддрд╡рд┐рдХ MitM рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк ARP рд╕реНрдкреВрдлрд┐рдВрдЧ, DNS рд╕реНрдкреВрдлрд┐рдВрдЧ рдЬреИрд╕реА рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ [**рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдкреВрдлрд┐рдВрдЧ рд╣рдорд▓реЛрдВ**](../generic-methodologies-and-resources/pentesting-network/#spoofing) рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдЕрдиреНрдп рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## SSH-Snake

рдпрджрд┐ рдЖрдк рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдЪрд▓рд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдХреА рдЧрдИ SSH рдирд┐рдЬреА рдХреБрдВрдЬреАрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдгрд╛рд▓реА рдкрд░ рдирдП рд╣реЛрд╕реНрдЯ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рдирд┐рдЬреА рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ [**SSH-Snake**](https://github.com/MegaManSec/SSH-Snake) рдЖрдкрдХреЛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред

SSH-Snake рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдФрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХрд░рддрд╛ рд╣реИ:

1. рд╡рд░реНрддрдорд╛рди рдкреНрд░рдгрд╛рд▓реА рдкрд░, рдХрд┐рд╕реА рднреА SSH рдирд┐рдЬреА рдХреБрдВрдЬреАрдпреЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ,
2. рд╡рд░реНрддрдорд╛рди рдкреНрд░рдгрд╛рд▓реА рдкрд░, рдЙрди рд╕рднреА рд╣реЛрд╕реНрдЯ рдпрд╛ рдЧрдВрддрд╡реНрдп (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛@рд╣реЛрд╕реНрдЯ) рдХреЛ рдЦреЛрдЬреЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдирд┐рдЬреА рдХреБрдВрдЬреА рд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рд╕рдХрддреА рд╣реИ,
3. рдЦреЛрдЬреА рдЧрдИ рд╕рднреА рдЧрдВрддрд╡реНрдпреЛрдВ рдореЗрдВ рд╕рднреА рдирд┐рдЬреА рдХреБрдВрдЬреАрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ,
4. рдпрджрд┐ рдХрд┐рд╕реА рдЧрдВрддрд╡реНрдп рд╕реЗ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдХрдиреЗрдХреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдкреБрдирдГ #1 - #4 рдЪрд░рдгреЛрдВ рдХреЛ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХрд░рддрд╛ рд╣реИред

рдпрд╣ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕реНрд╡-рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдФрд░ рд╕реНрд╡-рдкреНрд░рд╕рд╛рд░реА рд╣реИ - рдФрд░ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдлрд╛рдЗрд▓ рд░рд╣рд┐рдд рд╣реИред

## рдХреЙрдиреНрдлрд╝рд┐рдЧ рдорд┐рд╕рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди

### рд░реВрдЯ рд▓реЙрдЧрд┐рди

SSH рд╕рд░реНрд╡рд░реЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд░реВрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧрд┐рди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдирд╛ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ, рдЬреЛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рдкреИрджрд╛ рдХрд░рддрд╛ рд╣реИред **рд░реВрдЯ рд▓реЙрдЧрд┐рди рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдирд╛** рд╕рд░реНрд╡рд░ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХрджрдо рд╣реИред рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдЕрдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рдФрд░ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рд╣рдорд▓реЛрдВ рдХреЛ рдЗрд╕ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рдХреЗ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**OpenSSH рдореЗрдВ рд░реВрдЯ рд▓реЙрдЧрд┐рди рдХреЛ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:**

1. **SSH рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕рдВрдкрд╛рджрд┐рдд** рдХрд░реЗрдВ: `sudoedit /etc/ssh/sshd_config`
2. **рд╕реЗрдЯрд┐рдВрдЧ рдмрджрд▓реЗрдВ** `#PermitRootLogin yes` рд╕реЗ **`PermitRootLogin no`** рдХрд░реЗрдВред
3. **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЛ рдкреБрдирдГ рд▓реЛрдб** рдХрд░реЗрдВ: `sudo systemctl daemon-reload`
4. рдкрд░рд┐рд╡рд░реНрддрди рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **SSH рд╕рд░реНрд╡рд░ рдХреЛ рдкреБрдирдГ рдЖрд░рдВрдн** рдХрд░реЗрдВ: `sudo systemctl restart sshd`

### SFTP рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕

* [**SFTP рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕**](../generic-methodologies-and-resources/brute-force.md#sftp)

### SFTP рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрди

SFTP рд╕реЗрдЯрдЕрдк рдХреЗ рд╕рд╛рде рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЕрд╡рдзрд╛рд░рдгрд╛ рд╣реЛрддреА рд╣реИ, рдЬрд╣рд╛рдВ рдкреНрд░рд╢рд╛рд╕рдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рджреВрд░рд╕реНрде рд╢реИрд▓реА рдкрд╣реБрдВрдЪ рд╕рдХреНрд╖рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрдЪреНрдЫреБрдХ рд╣реЛрддреЗ
```bash
ssh -v noraj@192.168.1.94 id
...
Password:
debug1: Authentication succeeded (keyboard-interactive).
Authenticated to 192.168.1.94 ([192.168.1.94]:22).
debug1: channel 0: new [client-session]
debug1: Requesting no-more-sessions@openssh.com
debug1: Entering interactive session.
debug1: pledge: network
debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0
debug1: Sending command: id
debug1: client_input_channel_req: channel 0 rtype exit-status reply 0
debug1: client_input_channel_req: channel 0 rtype eow@openssh.com reply 0
uid=1000(noraj) gid=100(users) groups=100(users)
debug1: channel 0: free: client-session, nchannels 1
Transferred: sent 2412, received 2480 bytes, in 0.1 seconds
Bytes per second: sent 43133.4, received 44349.5
debug1: Exit status 0

$ ssh noraj@192.168.1.94 /bin/bash
```
рдпрд╣рд╛рдБ рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд SFTP рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдЙрджрд╛рд╣рд░рдг рд╣реИ (`/etc/ssh/sshd_config` - openSSH) рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ `noraj` рдХреЗ рд▓рд┐рдП:
```
Match User noraj
ChrootDirectory %h
ForceCommand internal-sftp
AllowTcpForwarding no
PermitTunnel no
X11Forwarding no
PermitTTY no
```
### SFTP рдЯрдирд▓рд┐рдВрдЧ

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ SFTP рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪ рд╣реИ рддреЛ рдЖрдк рдЗрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдкрдирд╛ рдЯреНрд░реИрдлрд┐рдХ рдЯрдирд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╕рд╛рдорд╛рдиреНрдп рдкреЛрд░реНрдЯ рдлреЙрд░рд╡рд░реНрдбрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ:
```bash
sudo ssh -L <local_port>:<remote_host>:<remote_port> -N -f <username>@<ip_compromised>
```
### SFTP рд╕рд┐рдВрд▓рд┐рдВрдХ

**sftp** рдореЗрдВ "**symlink**" рдХрдорд╛рдВрдб рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХрд┐рд╕реА рдлреЛрд▓реНрдбрд░ рдореЗрдВ **writable rights** рд╣реИрдВ, рддреЛ рдЖрдк **other folders/files** рдХреЗ **symlinks** рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рд╢рд╛рдпрдж рдПрдХ chroot рдХреЗ рдЕрдВрджрд░ **trapped** рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдЖрдкрдХреЗ рд▓рд┐рдП **specially useful** рдирд╣реАрдВ рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди, рдЕрдЧрд░ рдЖрдк рдирд┐рд░реНрдорд┐рдд **symlink** рдХреЛ рдПрдХ **no-chroot service** рд╕реЗ **access** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдЧрд░ рдЖрдк рд╡реЗрдм рд╕реЗ symlink рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ), рддреЛ рдЖрдк **web** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **symlinked files** рдХреЛ **open** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдирдП рдлрд╝рд╛рдЗрд▓ **"**_**froot**_**" рд╕реЗ "**_**/**_**"** рддрдХ рдПрдХ **symlink** рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП:
```bash
sftp> symlink / froot
```
### рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╡рд┐рдзрд┐рдпрд╛рдБ

рдЙрдЪреНрдЪ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдХреЗрд╡рд▓ рдХреБрдВрдЬреА-рдЖрдзрд╛рд░рд┐рдд рдпрд╛ рджреЛ рдШрдЯрдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЕрднреНрдпрд╛рд╕ рд╣реИ рдмрдЬрд╛рдп рд╕рд╛рдзрд╛рд░рдг рдШрдЯрдХ рдкрд╛рд╕рд╡рд░реНрдб рдЖрдзрд╛рд░рд┐рдд рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗред рд▓реЗрдХрд┐рди рдЕрдХреНрд╕рд░ рдордЬрдмреВрдд рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╡рд┐рдзрд┐рдпрд╛рдБ рд╕рдХреНрд╖рдо рдХрд░ рджреА рдЬрд╛рддреА рд╣реИрдВ рдмрд┐рдирд╛ рдХрдордЬреЛрд░ рд╡рд┐рдз
```bash
ssh -v 192.168.1.94
OpenSSH_8.1p1, OpenSSL 1.1.1d  10 Sep 2019
...
debug1: Authentications that can continue: publickey,password,keyboard-interactive
```
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдпрджрд┐ рдХрд┐рд╕реА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╡рд┐рдлрд▓рддрд╛ рд╕реАрдорд╛ рд╕реЗрдЯ рдХреА рдЧрдИ рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдХрднреА рдкрд╛рд╕рд╡рд░реНрдб рд╡рд┐рдзрд┐ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдореМрдХрд╛ рдирд╣реАрдВ рдорд┐рд▓рддрд╛, рддреЛ рдЖрдк `PreferredAuthentications` рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╛рдзреНрдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
ssh -v 192.168.1.94 -o PreferredAuthentications=password
...
debug1: Next authentication method: password
```
рдПрд╕рдПрд╕рдПрдЪ рд╕рд░реНрд╡рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рддрд╛рдХрд┐ рдХреЗрд╡рд▓ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╡рд┐рдзрд┐рдпрд╛рдБ рдЕрдзрд┐рдХреГрдд рд╣реЛрдВред рдЧреНрд░рд╛рд╣рдХ рдкрд░ рд╡рд░реНрдмреЛрдЬ рдореЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА рдкреНрд░рднрд╛рд╡рдХрд╛рд░рд┐рддрд╛ рджреЗрдЦрдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓реЗрдВ
```bash
ssh_config
sshd_config
authorized_keys
ssh_known_hosts
known_hosts
id_rsa
```
## Fuzzing

* [https://packetstormsecurity.com/files/download/71252/sshfuzz.txt](https://packetstormsecurity.com/files/download/71252/sshfuzz.txt)
* [https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh\_version\_2](https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh\_version\_2)

## References

* рдЖрдк рдпрд╣рд╛рдБ [https://www.ssh-audit.com/hardening\_guides.html](https://www.ssh-audit.com/hardening\_guides.html) рдкрд░ SSH рдХреЛ рдордЬрдмреВрдд рдХрд░рдиреЗ рдХреЗ рд░реЛрдЪрдХ рдЧрд╛рдЗрдб рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
* [https://community.turgensec.com/ssh-hacking-guide](https://community.turgensec.com/ssh-hacking-guide)

<img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

рдпрджрд┐ рдЖрдк **рд╣реИрдХрд┐рдВрдЧ рдХрд░рд┐рдпрд░** рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ рдФрд░ рдЕрдирд╣реИрдХреЗрдмрд▓ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ - **рд╣рдо рднрд░реНрддреА рдХрд░ рд░рд╣реЗ рд╣реИрдВ!** (_рдлреНрд▓реВрдПрдВрдЯ рдкреЛрд▓рд┐рд╢ рд▓рд┐рдЦрд┐рдд рдФрд░ рдмреЛрд▓реА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП_).

{% embed url="https://www.stmcyber.com/careers" %}

## HackTricks Automatic Commands
```
Protocol_Name: SSH
Port_Number: 22
Protocol_Description: Secure Shell Hardening

Entry_1:
Name: Hydra Brute Force
Description: Need Username
Command: hydra -v -V -u -l {Username} -P {Big_Passwordlist} -t 1 {IP} ssh

Entry_2:
Name: consolesless mfs enumeration
Description: SSH enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/ssh/ssh_version; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use scanner/ssh/ssh_enumusers; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ssh/juniper_backdoor; set RHOSTS {IP}; set RPORT 22; run; exit'

```
<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ **The PEASS Family** рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** PRs рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
