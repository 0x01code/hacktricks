# 873 - Pentesting Rsync

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ quiser ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

## **Informa√ß√µes B√°sicas**

Do [wikipedia](https://en.wikipedia.org/wiki/Rsync):

> **rsync** √© um utilit√°rio para transferir e sincronizar arquivos de forma eficiente entre um computador e um disco r√≠gido externo e entre computadores em rede comparando os hor√°rios de modifica√ß√£o e tamanhos dos arquivos. √â comumente encontrado em sistemas operacionais do tipo Unix. O algoritmo rsync √© um tipo de codifica√ß√£o delta e √© usado para minimizar o uso da rede. Zlib pode ser usado para compress√£o de dados adicional, e SSH ou stunnel podem ser usados para seguran√ßa.

**Porta padr√£o:** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## Enumera√ß√£o

### Banner e Comunica√ß√£o Manual
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **Enumerating Pastas Compartilhadas**

**M√≥dulos Rsync** s√£o reconhecidos como **compartilhamentos de diret√≥rios** que podem estar **protegidos com senhas**. Para identificar os m√≥dulos dispon√≠veis e verificar se eles requerem senhas, os seguintes comandos s√£o utilizados:
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

# Example with IPv6 and alternate port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
Esteja ciente de que alguns compartilhamentos podem n√£o aparecer na lista, possivelmente ocultando-os. Al√©m disso, o acesso a alguns compartilhamentos pode ser restrito a **credenciais** espec√≠ficas, indicado por uma mensagem de **"Acesso Negado"**.

### [**For√ßa Bruta**](../generic-methodologies-and-resources/brute-force.md#rsync)

### Uso Manual do Rsync

Ap√≥s obter uma lista de **m√≥dulos**, as a√ß√µes dependem se a autentica√ß√£o √© necess√°ria. Sem autentica√ß√£o, **listar** e **copiar** arquivos de uma pasta compartilhada para um diret√≥rio local √© alcan√ßado atrav√©s de:
```bash
# Listing a shared folder
rsync -av --list-only rsync://192.168.0.123/shared_name

# Copying files from a shared folder
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
Este processo **transfere arquivos de forma recursiva**, preservando seus atributos e permiss√µes.

Com **credenciais**, a listagem e o download de uma pasta compartilhada podem ser feitos da seguinte forma, onde um prompt de senha aparecer√°:
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
Para **enviar conte√∫do**, como um arquivo _**authorized_keys**_ para acesso, use:
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

Para localizar o arquivo de configura√ß√£o do rsyncd, execute:
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
Dentro deste arquivo, um par√¢metro _secrets file_ pode apontar para um arquivo contendo **nomes de usu√°rio e senhas** para autentica√ß√£o do rsyncd.


## Refer√™ncias
* [https://www.smeegesec.com/2016/12/pentesting-rsync.html](https://www.smeegesec.com/2016/12/pentesting-rsync.html)

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
