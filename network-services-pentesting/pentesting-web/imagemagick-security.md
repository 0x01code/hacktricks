# Ασφάλεια του ImageMagick

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

Ελέγξτε περαιτέρω λεπτομέρειες στο [**https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)

Το ImageMagick, μια ευέλικτη βιβλιοθήκη επεξεργασίας εικόνας, αντιμετωπίζει προκλήσεις στην ρύθμιση της πολιτικής ασφαλείας του λόγω των εκτεταμένων επιλογών του και της έλλειψης λεπτομερούς online τεκμηρίωσης. Οι χρήστες συχνά δημιουργούν πολιτικές βασιζόμενοι σε κατακερματισμένες πηγές στο διαδίκτυο, με αποτέλεσμα πιθανές λανθασμένες ρυθμίσεις. Η βιβλιοθήκη υποστηρίζει μια μεγάλη ποικιλία από πάνω από 100 μορφές εικόνας, καθεμία από τις οποίες συντελεί στην πολυπλοκότητα και το προφίλ ευπάθειας της, όπως αποδεικνύεται από ιστορικά περιστατικά ασφαλείας.

## Προς ασφαλέστερες πολιτικές
Για να αντιμετωπιστούν αυτές οι προκλήσεις, έχει αναπτυχθεί ένα [εργαλείο](https://imagemagick-secevaluator.doyensec.com/) που βοηθά στο σχεδιασμό και τον έλεγχο των πολιτικών ασφαλείας του ImageMagick. Αυτό το εργαλείο βασίζεται σε εκτεταμένη έρευνα και στοχεύει να εξασφαλίσει όχι μόνο ροπή ασφάλειας αλλά και απουσία κενών που θα μπορούσαν να εκμεταλλευτούνται.

## Προσέγγιση λίστας επιτρεπόμενων έναντι λίστας αποκλεισμένων
Ιστορικά, οι πολιτικές του ImageMagick βασίζονταν σε μια προσέγγιση αποκλεισμού, όπου συγκεκριμένοι κωδικοποιητές αποκλείονταν από την πρόσβαση. Ωστόσο, οι αλλαγές στο ImageMagick 6.9.7-7 άλλαξαν αυτό το παράδειγμα, επιτρέποντας μια προσέγγιση λίστας επιτρεπόμενων. Αυτή η προσέγγιση αρχικά αποκλείει όλους τους κωδικοποιητές και στη συνέχεια επιτρέπει εκλεκτικά την πρόσβαση σε αξιόπιστους, βελτιώνοντας την ασφάλεια.
```xml
...
<policy domain="coder" rights="none" pattern="*" />
<policy domain="coder" rights="read | write" pattern="{GIF,JPEG,PNG,WEBP}" />
...
```
## Ευαισθησία στην περίπτωση των πολιτικών
Είναι ζωτικής σημασίας να σημειωθεί ότι οι πρότυποι πολιτικής στο ImageMagick είναι ευαίσθητοι στην περίπτωση. Επομένως, είναι απαραίτητο να εξασφαλίζεται ότι οι κωδικοί και οι ενότητες είναι σωστά γραμμένοι με κεφαλαία γράμματα στις πολιτικές, προκειμένου να αποφεύγονται ανεπιθύμητες άδειες.

## Όρια πόρων
Το ImageMagick είναι ευάλωτο σε επιθέσεις απόρριψης υπηρεσίας εάν δεν ρυθμιστεί σωστά. Η ορισμένη ρύθμιση όρων πόρων στην πολιτική είναι απαραίτητη για την πρόληψη τέτοιων ευπαθειών.

## Διάσπαση πολιτικής
Οι πολιτικές μπορεί να είναι διασπασμένες σε διάφορες εγκαταστάσεις του ImageMagick, προκαλώντας πιθανές συγκρούσεις ή αντικαταστάσεις. Συνιστάται να εντοπίζονται και να επαληθεύονται τα ενεργά αρχεία πολιτικής χρησιμοποιώντας εντολές όπως:
```shell
$ find / -iname policy.xml
```
## Ένα Αρχικό, Περιοριστικό Πολιτικής
Έχει προταθεί ένα πρότυπο περιοριστικής πολιτικής, με έμφαση σε αυστηρούς περιορισμούς πόρων και ελέγχους πρόσβασης. Αυτό το πρότυπο λειτουργεί ως βάση για την ανάπτυξη προσαρμοσμένων πολιτικών που συμμορφώνονται με τις συγκεκριμένες απαιτήσεις της εφαρμογής.

Η αποτελεσματικότητα μιας πολιτικής ασφαλείας μπορεί να επιβεβαιωθεί χρησιμοποιώντας την εντολή `identify -list policy` στο ImageMagick. Επιπλέον, το εργαλείο αξιολόγησης που αναφέρθηκε προηγουμένως μπορεί να χρησιμοποιηθεί για τη βελτίωση της πολιτικής βάσει των ατομικών αναγκών.

## Αναφορές
* [https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)



<details>

<summary><strong>Μάθετε το hacking στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας διαφημισμένη στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΠΑΚΕΤΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα hacking tricks σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
