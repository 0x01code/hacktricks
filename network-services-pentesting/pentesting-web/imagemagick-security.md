# S√©curit√© ImageMagick

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

Consultez plus de d√©tails sur [**https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)

ImageMagick, une biblioth√®que polyvalente de traitement d'images, pr√©sente un d√©fi dans la configuration de sa politique de s√©curit√© en raison de ses nombreuses options et du manque de documentation en ligne d√©taill√©e. Les utilisateurs cr√©ent souvent des politiques bas√©es sur des sources Internet fragment√©es, ce qui peut entra√Æner des configurations incorrectes. La biblioth√®que prend en charge une vaste gamme de plus de 100 formats d'image, contribuant chacun √† sa complexit√© et √† son profil de vuln√©rabilit√©, comme le d√©montrent les incidents de s√©curit√© historiques.

## Vers des politiques plus s√ªres
Pour relever ces d√©fis, un [outil a √©t√© d√©velopp√©](https://imagemagick-secevaluator.doyensec.com/) pour aider √† concevoir et auditer les politiques de s√©curit√© d'ImageMagick. Cet outil est bas√© sur une recherche approfondie et vise √† garantir que les politiques sont non seulement robustes, mais aussi exemptes de failles exploitables.

## Approche de la liste blanche vs liste noire
Historiquement, les politiques ImageMagick reposaient sur une approche de liste noire, o√π des codeurs sp√©cifiques se voyaient refuser l'acc√®s. Cependant, les changements dans ImageMagick 6.9.7-7 ont modifi√© ce paradigme, permettant une approche de liste blanche. Cette approche refuse d'abord l'acc√®s √† tous les codeurs, puis accorde s√©lectivement l'acc√®s √† ceux de confiance, renfor√ßant ainsi la posture de s√©curit√©.
```xml
...
<policy domain="coder" rights="none" pattern="*" />
<policy domain="coder" rights="read | write" pattern="{GIF,JPEG,PNG,WEBP}" />
...
```
## Sensibilit√© √† la casse dans les politiques
Il est crucial de noter que les mod√®les de politiques dans ImageMagick sont sensibles √† la casse. Ainsi, il est essentiel de s'assurer que les codeurs et les modules sont correctement en majuscules dans les politiques pour √©viter les autorisations non intentionnelles.

## Limites des ressources
ImageMagick est sujet aux attaques de d√©ni de service s'il n'est pas correctement configur√©. D√©finir des limites de ressources explicites dans la politique est essentiel pour pr√©venir de telles vuln√©rabilit√©s.

## Fragmentation des politiques
Les politiques peuvent √™tre fragment√©es √† travers diff√©rentes installations d'ImageMagick, ce qui peut entra√Æner des conflits ou des remplacements potentiels. Il est recommand√© de localiser et de v√©rifier les fichiers de politiques actifs en utilisant des commandes telles que :
```shell
$ find / -iname policy.xml
```
## Un mod√®le de politique restrictif
Un mod√®le de politique restrictif a √©t√© propos√©, mettant l'accent sur des limitations strictes des ressources et des contr√¥les d'acc√®s. Ce mod√®le sert de base pour √©laborer des politiques personnalis√©es qui correspondent aux exigences sp√©cifiques de l'application.

L'efficacit√© d'une politique de s√©curit√© peut √™tre confirm√©e en utilisant la commande `identify -list policy` dans ImageMagick. De plus, l'outil [√©valuateur](https://imagemagick-secevaluator.doyensec.com/) mentionn√© pr√©c√©demment peut √™tre utilis√© pour affiner la politique en fonction des besoins individuels.

## R√©f√©rences
* [https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)



<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
