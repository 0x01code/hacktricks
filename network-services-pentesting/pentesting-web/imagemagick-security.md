# ImageMagick Güvenliği

<details>

<summary><strong>AWS hacklemeyi sıfırdan kahramana dönüştürmek için</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>'ı öğrenin!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR göndererek** paylaşın.

</details>

Daha fazla ayrıntıyı [**https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html) adresinde kontrol edin.

ImageMagick, çok yönlü bir görüntü işleme kütüphanesi, geniş seçenekleri ve detaylı çevrimiçi belgelendirmenin eksikliği nedeniyle güvenlik politikasını yapılandırmada bir zorluk sunar. Kullanıcılar genellikle parçalanmış internet kaynaklarına dayalı politikalar oluştururlar, bu da potansiyel yanlış yapılandırmalara yol açar. Kütüphane, 100'den fazla görüntü formatını destekler ve her biri tarihsel güvenlik olayları tarafından gösterilen karmaşıklık ve zayıflık profiline katkıda bulunur.

## Daha Güvenli Politikalar İçin
Bu zorlukları ele almak için, ImageMagick'in güvenlik politikalarının tasarlanmasına ve denetlenmesine yardımcı olmak için bir [araç geliştirilmiştir](https://imagemagick-secevaluator.doyensec.com/). Bu araç, kapsamlı araştırmalara dayanmaktadır ve politikaların sadece sağlam değil, aynı zamanda istismar edilebilecek açıklar içermeyen şekilde olmasını amaçlamaktadır.

## Allowlist vs Denylist Yaklaşımı
Tarihsel olarak, ImageMagick politikaları, belirli kodlayıcılara erişimin reddedildiği bir denylist yaklaşımına dayanıyordu. Ancak, ImageMagick 6.9.7-7'deki değişiklikler bu paradigmayı değiştirdi ve bir allowlist yaklaşımını mümkün kıldı. Bu yaklaşım önce tüm kodlayıcılara erişimi reddeder ve daha sonra güvenilir olanlara seçici olarak erişim izni vererek güvenlik durumunu artırır.
```xml
...
<policy domain="coder" rights="none" pattern="*" />
<policy domain="coder" rights="read | write" pattern="{GIF,JPEG,PNG,WEBP}" />
...
```
## Politikalardaki Büyük-Küçük Harf Duyarlılığı
ImageMagick'teki politika desenlerinin büyük-küçük harf duyarlı olduğunu unutmamak önemlidir. Bu nedenle, kodlayıcıların ve modüllerin politikalarda doğru bir şekilde büyük harfle yazıldığından emin olmak, istenmeyen izinlerin önlenmesi için hayati öneme sahiptir.

## Kaynak Sınırları
ImageMagick, doğru bir şekilde yapılandırılmazsa hizmet reddi saldırılarına karşı hassastır. Politikada açık kaynak sınırlarını belirlemek, bu tür zayıflıkların önlenmesi için önemlidir.

## Politika Parçalanması
Politikalar, farklı ImageMagick kurulumları arasında parçalanabilir ve potansiyel çakışmalara veya geçersiz kılmalara neden olabilir. Etkin politika dosyalarını bulmak ve doğrulamak için aşağıdaki gibi komutları kullanmak önerilir:
```shell
$ find / -iname policy.xml
```
## Başlangıç, Kısıtlayıcı Politika
Kısıtlayıcı bir politika şablonu önerilmiştir ve sıkı kaynak sınırlamaları ve erişim kontrollerine odaklanmaktadır. Bu şablon, belirli uygulama gereksinimleriyle uyumlu özelleştirilmiş politikalar geliştirmek için bir temel olarak hizmet vermektedir.

Bir güvenlik politikasının etkinliği, ImageMagick'te `identify -list policy` komutunu kullanarak doğrulanabilir. Ayrıca, daha önce bahsedilen [değerlendirici araç](https://imagemagick-secevaluator.doyensec.com/), bireysel ihtiyaçlara dayalı olarak politikayı iyileştirmek için kullanılabilir.

## Referanslar
* [https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)



<details>

<summary><strong>AWS hacklemeyi sıfırdan kahraman olacak şekilde öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya HackTricks'i **PDF olarak indirmek** için [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family)
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**'u takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna PR göndererek paylaşın.

</details>
