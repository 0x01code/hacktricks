# –°–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF-—Ñ–æ—Ä–º–∞—Ç—ñ**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>

## –°–ø–∏—Å–∫–∏ —Å–ª—ñ–≤ —Ç–∞ –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

* [https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/web/http-request-headers](https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/web/http-request-headers)
* [https://github.com/rfc-st/humble](https://github.com/rfc-st/humble)

## –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –∑–º—ñ–Ω–∏ –º—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è

–ü–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ **IP-–¥–∂–µ—Ä–µ–ª–æ**:

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Forwarded-Host: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `X-Client-IP: 127.0.0.1`
* `X-Host: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `Via: 1.0 fred, 1.1 127.0.0.1`
* `Connection: close, X-Forwarded-For` (–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ hop-by-hop)

–ü–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ **–º—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è**:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`

## –ó–∞–≥–æ–ª–æ–≤–∫–∏ hop-by-hop

–ó–∞–≥–æ–ª–æ–≤–æ–∫ hop-by-hop - —Ü–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫, —è–∫–∏–π –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ç–∞ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –ø—Ä–æ–∫—Å—ñ, —è–∫–∏–π –≤ –¥–∞–Ω–∏–π –º–æ–º–µ–Ω—Ç –æ–±—Ä–æ–±–ª—è—î –∑–∞–ø–∏—Ç, –Ω–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞ end-to-end.

* `Connection: close, X-Forwarded-For`

{% content-ref url="../../pentesting-web/abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../../pentesting-web/abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## HTTP-–∑–∞–ø–∏—Ç –Ω–∞ –≤–∏–∫—Ä–∞–¥–µ–Ω–Ω—è

* `Content-Length: 30`
* `Transfer-Encoding: chunked`

{% content-ref url="../../pentesting-web/http-request-smuggling/" %}
[http-request-smuggling](../../pentesting-web/http-request-smuggling/)
{% endcontent-ref %}

## –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫–µ—à—É–≤–∞–Ω–Ω—è

**–ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫–µ—à—É–≤–∞–Ω–Ω—è —Å–µ—Ä–≤–µ—Ä–∞**:

* **`X-Cache`** –≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –º–æ–∂–µ –º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è **`miss`**, –∫–æ–ª–∏ –∑–∞–ø–∏—Ç –Ω–µ –±—É–≤ –∫–µ—à–æ–≤–∞–Ω–∏–π, —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è **`hit`**, –∫–æ–ª–∏ –≤—ñ–Ω –∫–µ—à–æ–≤–∞–Ω–∏–π
* –°—Ö–æ–∂–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫—É **`Cf-Cache-Status`**
* **`Cache-Control`** –≤–∫–∞–∑—É—î, —á–∏ –∫–µ—à—É—î—Ç—å—Å—è —Ä–µ—Å—É—Ä—Å —ñ –∫–æ–ª–∏ —Ä–µ—Å—É—Ä—Å –±—É–¥–µ –∫–µ—à–æ–≤–∞–Ω–∏–π –∑–Ω–æ–≤—É: `Cache-Control: public, max-age=1800`
* **`Vary`** —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –¥–ª—è **–≤–∫–∞–∑—ñ–≤–∫–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤**, —è–∫—ñ —Ä–æ–∑–≥–ª—è–¥–∞—é—Ç—å—Å—è —è–∫ **—á–∞—Å—Ç–∏–Ω–∞ –∫–ª—é—á–∞ –∫–µ—à—É–≤–∞–Ω–Ω—è**, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–æ–Ω–∏ –∑–∞–∑–≤–∏—á–∞–π –Ω–µ —î –∫–ª—é—á–æ–≤–∏–º–∏.
* **`Age`** –≤–∏–∑–Ω–∞—á–∞—î —á–∞—Å —É —Å–µ–∫—É–Ω–¥–∞—Ö, –ø—Ä–æ—Ç—è–≥–æ–º —è–∫–æ–≥–æ –æ–±'—î–∫—Ç –ø–µ—Ä–µ–±—É–≤–∞–≤ —É –∫–µ—à—ñ –ø—Ä–æ–∫—Å—ñ.
* **`Server-Timing: cdn-cache; desc=HIT`** —Ç–∞–∫–æ–∂ –≤–∫–∞–∑—É—î, —â–æ —Ä–µ—Å—É—Ä—Å –±—É–≤ –∫–µ—à–æ–≤–∞–Ω–∏–π

{% content-ref url="../../pentesting-web/cache-deception.md" %}
[cache-deception.md](../../pentesting-web/cache-deception.md)
{% endcontent-ref %}

**–ó–∞–≥–æ–ª–æ–≤–∫–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–µ—à—É–≤–∞–Ω–Ω—è**:

* `Clear-Site-Data`: –ó–∞–≥–æ–ª–æ–≤–æ–∫, —â–æ –≤–∫–∞–∑—É—î –∫–µ—à, —è–∫–∏–π —Å–ª—ñ–¥ –≤–∏–¥–∞–ª–∏—Ç–∏: `Clear-Site-Data: "cache", "cookies"`
* `Expires`: –ú—ñ—Å—Ç–∏—Ç—å –¥–∞—Ç—É/—á–∞—Å, –∫–æ–ª–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø–æ–≤–∏–Ω–Ω–∞ –∑–∞–∫—ñ–Ω—á–∏—Ç–∏—Å—è: `Expires: Wed, 21 Oct 2015 07:28:00 GMT`
* `Pragma: no-cache` —Ç–µ —Å–∞–º–µ, —â–æ —ñ `Cache-Control: no-cache`
* `Warning`: –ó–∞–≥–∞–ª—å–Ω–∏–π HTTP-–∑–∞–≥–æ–ª–æ–≤–æ–∫ **`Warning`** –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –º–æ–∂–ª–∏–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏ –∑—ñ —Å—Ç–∞—Ç—É—Å–æ–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è. –£ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –º–æ–∂–µ –∑'—è–≤–∏—Ç–∏—Å—è –±—ñ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Warning`. `Warning: 110 anderson/1.3.37 "Response is stale"`

## –£–º–æ–≤–Ω—ñ

* –ó–∞–ø–∏—Ç–∏ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Ü–∏—Ö –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤: **`If-Modified-Since`** —Ç–∞ **`If-Unmodified-Since`** –±—É–¥—É—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –¥–∞–Ω–∏–º–∏ –ª–∏—à–µ —É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ **`Last-Modified`** –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—à–∏–π —á–∞—Å.
* –£–º–æ–≤–Ω—ñ –∑–∞–ø–∏—Ç–∏ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º **`If-Match`** —Ç–∞ **`If-None-Match`** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è Etag, —Ç–æ–º—É –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–∞–¥—Å–∏–ª–∞—Ç–∏–º–µ –≤–º—ñ—Å—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, —è–∫—â–æ –¥–∞–Ω—ñ (Etag) –∑–º—ñ–Ω–∏–ª–∏—Å—è. `Etag` –±–µ—Ä–µ—Ç—å—Å—è –∑ HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.
* –ó–Ω–∞—á–µ–Ω–Ω—è **Etag** –∑–∞–∑–≤–∏—á–∞–π **–æ–±—á–∏—Å–ª—é—î—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ** –≤–º—ñ—Å—Ç—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, `ETag: W/"37-eL2g8DEyqntYlaLp5XLInBWsjWI"` –≤–∫–∞–∑—É—î, —â–æ `Etag` - —Ü–µ **Sha1** –∑ **37 –±–∞–π—Ç—ñ–≤**.

## –ó–∞–ø–∏—Ç–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω—É

* **`Accept-Ranges`**: –í–∫–∞–∑—É—î, —á–∏ —Å–µ—Ä–≤–µ—Ä –ø—ñ–¥—Ç—Ä–∏–º—É—î –∑–∞–ø–∏—Ç–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω—É, —ñ –≤ —è–∫–æ–º—É –æ–¥–∏–Ω–∏—Ü—ñ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏—Ä–∞–∂–µ–Ω–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω. `Accept-Ranges: <range-unit>`
* **`Range`**: –í–∫–∞–∑—É—î —á–∞—Å—Ç–∏–Ω—É –¥–æ–∫—É–º–µ–Ω—Ç–∞, —è–∫—É —Å–µ—Ä–≤–µ—Ä –ø–æ–≤–∏–Ω–µ–Ω –ø–æ–≤–µ—Ä–Ω—É—Ç–∏.
* **`If-Range`**: –°—Ç–≤–æ—Ä—é—î —É–º–æ–≤–Ω–∏–π –∑–∞–ø–∏—Ç –¥—ñ–∞–ø–∞–∑–æ–Ω—É, —è–∫–∏–π –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ª–∏—à–µ —É –≤–∏–ø–∞–¥–∫—É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –≤–∫–∞–∑–∞–Ω–æ–≥–æ etag –∞–±–æ –¥–∞—Ç–∏ –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—é –¥–≤–æ—Ö –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ–≤ –∑ –Ω–µ—Å—É–º—ñ—Å–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó —Ä–µ—Å—É—Ä—Å—É.
* **`Content-Range`**: –í–∫–∞–∑—É—î, –¥–µ –≤ –ø–æ–≤–Ω–æ–º—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ —Ç—ñ–ª–∞ –Ω–∞–ª–µ–∂–∏—Ç—å —á–∞—Å—Ç–∫–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.

## –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ç—ñ–ª–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

* **`Content-Length`:** –†–æ–∑–º—ñ—Ä —Ä–µ—Å—É—Ä—Å—É, —É –¥–µ—Å—è—Ç–∫–æ–≤–æ–º—É —á–∏—Å–ª—ñ –±–∞–π—Ç—ñ–≤.
* **`Content-Type`**: –í–∫–∞–∑—É—î –º–µ–¥—ñ–∞-—Ç–∏–ø —Ä–µ—Å—É—Ä—Å—É
* **`Content-Encoding`**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∫–∞–∑—ñ–≤–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º—É —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è.
* **`Content-Language`**: –û–ø–∏—Å—É—î –º–æ–≤—É(–∏) –¥–ª—è –∞—É–¥–∏—Ç–æ—Ä—ñ—ó, —â–æ–± –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º—ñ–≥ —Ä–æ–∑—Ä—ñ–∑–Ω—è—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ –≤–ª–∞—Å–Ω–æ—ó –≤–∏–±—Ä–∞–Ω–æ—ó –º–æ–≤–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
* **`Content-Location`**: –í–∫–∞–∑—É—î –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–µ –º—ñ—Å—Ü–µ –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö.

–ó —Ç–æ—á–∫–∏ –∑–æ—Ä—É –ø–µ–Ω—Ç–µ—Å—Ç—É —Ü—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∑–∞–∑–≤–∏—á–∞–π "–Ω–µ–∫–æ—Ä–∏—Å–Ω–∞", –∞–ª–µ —è–∫—â–æ —Ä–µ—Å—É—Ä—Å **–∑–∞—Ö–∏—â–µ–Ω–∏–π** 401 –∞–±–æ 403 —ñ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ —è–∫–∏–π—Å—å **—Å–ø–æ—Å—ñ–±** –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ü—é **—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é**, —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ **—Ü—ñ–∫–∞–≤–æ.**\
–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—è **`Range`** —Ç–∞ **`Etag`** –≤ –∑–∞–ø–∏—Ç—ñ HEAD –º–æ–∂–µ –≤–∏—Ç—ñ–∫–∞—Ç–∏ –≤–º—ñ—Å—Ç —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Ç–∏ HEAD:

* –ó–∞–ø–∏—Ç –∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Range: bytes=20-20` —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–¥—é, —â–æ –º—ñ—Å—Ç–∏—Ç—å `ETag: W/"1-eoGvPlkaxxP4HqHv6T3PNhV9g3Y"`, –≤–∏—Ç—ñ–∫–∞—î, —â–æ SHA1 –±–∞–π—Ç–∞ 20 - `ETag: eoGvPlkaxxP4HqHv6T3PNhV9g3Y`
## –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Å–µ—Ä–≤–µ—Ä

* `Server: Apache/2.4.1 (Unix)`
* `X-Powered-By: PHP/5.3.3`

## –ö–æ–Ω—Ç—Ä–æ–ª—å

* **`Allow`**: –¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∫–∞–∑—ñ–≤–∫–∏ HTTP-–º–µ—Ç–æ–¥—ñ–≤, —è–∫—ñ –º–æ–∂–µ –æ–±—Ä–æ–±–ª—è—Ç–∏ —Ä–µ—Å—É—Ä—Å. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –π–æ–≥–æ –º–æ–∂–µ –±—É—Ç–∏ –≤–∫–∞–∑–∞–Ω–æ —è–∫ `Allow: GET, POST, HEAD`, —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ —Ä–µ—Å—É—Ä—Å –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ü—ñ –º–µ—Ç–æ–¥–∏.
* **`Expect`**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∫–ª—ñ—î–Ω—Ç–æ–º –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –æ—á—ñ–∫—É–≤–∞–Ω—å, —è–∫—ñ —Å–µ—Ä–≤–µ—Ä –ø–æ–≤–∏–Ω–µ–Ω –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –∑–∞–ø–∏—Ç—É. –û–¥–∏–Ω –∑ —Ç–∏–ø–æ–≤–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è - —Ü–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Expect: 100-continue`, —è–∫–∏–π —Å–∏–≥–Ω–∞–ª—ñ–∑—É—î, —â–æ –∫–ª—ñ—î–Ω—Ç –º–∞—î –Ω–∞–º—ñ—Ä –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤–µ–ª–∏–∫–∏–π –æ–±—Å—è–≥ –¥–∞–Ω–∏—Ö. –ö–ª—ñ—î–Ω—Ç –æ—á—ñ–∫—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ `100 (Continue)` –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è–º –ø–µ—Ä–µ–¥–∞—á—ñ. –¶–µ–π –º–µ—Ö–∞–Ω—ñ–∑–º –¥–æ–ø–æ–º–∞–≥–∞—î –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ, —á–µ–∫–∞—é—á–∏ –Ω–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞.

## –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

* –ó–∞–≥–æ–ª–æ–≤–æ–∫ **`Content-Disposition`** –≤ HTTP-–≤—ñ–¥–ø–æ–≤—ñ–¥—è—Ö –≤–∫–∞–∑—É—î, —á–∏ —Ñ–∞–π–ª –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–∏–π **–≤–±—É–¥–æ–≤–∞–Ω–æ** (–Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω—Ü—ñ) –∞–±–æ —Ä–æ–∑–≥–ª—è–¥–∞—Ç–∏—Å—è —è–∫ **–≤–∫–ª–∞–¥–µ–Ω–Ω—è** (–∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏—Å—è). –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
```
Content-Disposition: attachment; filename="filename.jpg"
```
–¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Ñ–∞–π–ª –ø—ñ–¥ –Ω–∞–∑–≤–æ—é "filename.jpg" –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è.

## –ó–∞—Ö–∏—Å–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏

### –ü–æ–ª—ñ—Ç–∏–∫–∞ –±–µ–∑–ø–µ–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É (CSP) <a href="#csp" id="csp"></a>

{% content-ref url="../../pentesting-web/content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../../pentesting-web/content-security-policy-csp-bypass/)
{% endcontent-ref %}

### **–î–æ–≤—ñ—Ä–µ–Ω—ñ —Ç–∏–ø–∏**

–ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –î–æ–≤—ñ—Ä–µ–Ω–∏—Ö —Ç–∏–ø—ñ–≤ —á–µ—Ä–µ–∑ CSP, –¥–æ–¥–∞—Ç–∫–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–∞—Ö–∏—â–µ–Ω—ñ –≤—ñ–¥ –∞—Ç–∞–∫ DOM XSS. –î–æ–≤—ñ—Ä–µ–Ω—ñ —Ç–∏–ø–∏ –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å, —â–æ –ª–∏—à–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω—ñ –æ–±'—î–∫—Ç–∏, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–º –ø–æ–ª—ñ—Ç–∏–∫–∞–º –±–µ–∑–ø–µ–∫–∏, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –≤ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö –≤–∏–∫–ª–∏–∫–∞—Ö –≤–µ–±-API, —Ç–∏–º —Å–∞–º–∏–º –∑–∞—Ö–∏—â–∞—é—á–∏ –∫–æ–¥ JavaScript –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º.
```javascript
// Feature detection
if (window.trustedTypes && trustedTypes.createPolicy) {
// Name and create a policy
const policy = trustedTypes.createPolicy('escapePolicy', {
createHTML: str => str.replace(/\</g, '&lt;').replace(/>/g, '&gt;');
});
}
```

```javascript
// Assignment of raw strings is blocked, ensuring safety.
el.innerHTML = 'some string'; // Throws an exception.
const escaped = policy.createHTML('<img src=x onerror=alert(1)>');
el.innerHTML = escaped;  // Results in safe assignment.
```
### **X-Content-Type-Options**

–¶–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–ø–æ–±—ñ–≥–∞—î –ø–µ—Ä–µ–≤—ñ—Ä—Ü—ñ —Ç–∏–ø—É MIME, –ø—Ä–∞–∫—Ç–∏—Ü—ñ, —è–∫–∞ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π XSS. –í—ñ–Ω –∑–∞–±–µ–∑–ø–µ—á—É—î, —â–æ –±—Ä–∞—É–∑–µ—Ä–∏ –¥–æ—Ç—Ä–∏–º—É—é—Ç—å—Å—è —Ç–∏–ø—ñ–≤ MIME, –≤–∫–∞–∑–∞–Ω–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–º.
```
X-Content-Type-Options: nosniff
```
### **X-Frame-Options**

–î–ª—è –±–æ—Ä–æ—Ç—å–±–∏ –∑—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–º –≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è–º, —Ü–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–±–º–µ–∂—É—î —Å–ø–æ—Å–æ–±–∏ –≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ –≤ —Ç–µ–≥–∏ `<frame>`, `<iframe>`, `<embed>`, –∞–±–æ `<object>`, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—á–∏ –≤—Å—ñ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º —è–≤–Ω–æ –≤–∫–∞–∑—É–≤–∞—Ç–∏ —ó—Ö –¥–æ–∑–≤–æ–ª–∏ –Ω–∞ –≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è.
```
X-Frame-Options: DENY
```
### **Cross-Origin Resource Policy (CORP) —Ç–∞ Cross-Origin Resource Sharing (CORS)**

CORP —î –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è –≤–∫–∞–∑–∞–Ω–Ω—è, —è–∫—ñ —Ä–µ—Å—É—Ä—Å–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –≤–µ–±-—Å–∞–π—Ç–∞–º–∏, –ø–æ–º'—è–∫—à—É—é—á–∏ –≤–∏—Ç–æ–∫–∏ –º—ñ–∂ —Å–∞–π—Ç–∞–º–∏. CORS, –∑ —ñ–Ω—à–æ–≥–æ –±–æ–∫—É, –¥–æ–∑–≤–æ–ª—è—î –±—ñ–ª—å—à –≥–Ω—É—á–∫–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º —Å–ø—ñ–ª—å–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ –º—ñ–∂ –¥–∂–µ—Ä–µ–ª–∞–º–∏, –ø–æ—Å–ª–∞–±–ª—é—é—á–∏ –ø–æ–ª—ñ—Ç–∏–∫—É –æ–¥–Ω–∞–∫–æ–≤–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –∑–∞ –ø–µ–≤–Ω–∏—Ö —É–º–æ–≤.
```
Cross-Origin-Resource-Policy: same-origin
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Credentials: true
```
### **–ü–æ–ª—ñ—Ç–∏–∫–∞ –≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è –∑ —ñ–Ω—à–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è (COEP) —Ç–∞ –ü–æ–ª—ñ—Ç–∏–∫–∞ –≤—ñ–¥–∫—Ä–∏–≤–∞—á–∞ –∑ —ñ–Ω—à–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è (COOP)**

COEP —Ç–∞ COOP —î –≤–∞–∂–ª–∏–≤–∏–º–∏ –¥–ª—è –≤–≤—ñ–º–∫–Ω–µ–Ω–Ω—è —ñ–∑–æ–ª—è—Ü—ñ—ó –º—ñ–∂ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è–º–∏, —â–æ –∑–Ω–∞—á–Ω–æ –∑–º–µ–Ω—à—É—î —Ä–∏–∑–∏–∫ –∞—Ç–∞–∫ –ø–æ–¥—ñ–±–Ω–∏—Ö –¥–æ Spectre. –í–æ–Ω–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é—é—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤ –∑ —ñ–Ω—à–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è —Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ—é –∑ –≤—ñ–∫–Ω–∞–º–∏ –∑ —ñ–Ω—à–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ.
```
Cross-Origin-Embedder-Policy: require-corp
Cross-Origin-Opener-Policy: same-origin-allow-popups
```
### **HTTP Strict Transport Security (HSTS)**

–ù–∞–æ—Å—Ç–∞–Ω–æ–∫, HSTS - —Ü–µ —Ñ—É–Ω–∫—Ü—ñ—è –±–µ–∑–ø–µ–∫–∏, —è–∫–∞ –∑–º—É—à—É—î –±—Ä–∞—É–∑–µ—Ä–∏ —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –ª–∏—à–µ –∑ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ –±–µ–∑–ø–µ—á–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è HTTPS, —Ç–∏–º —Å–∞–º–∏–º –ø—ñ–¥–≤–∏—â—É—é—á–∏ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å —Ç–∞ –±–µ–∑–ø–µ–∫—É.
```
Strict-Transport-Security: max-age=3153600
```
## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers)
* [https://web.dev/security-headers/](https://web.dev/security-headers/)
* [https://web.dev/articles/security-headers](https://web.dev/articles/security-headers)

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ **—Ä–µ–∫–ª–∞–º—É –≤–∞—à–æ—ó –∫–æ–º–ø–∞–Ω—ñ—ó –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—ñ** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>
