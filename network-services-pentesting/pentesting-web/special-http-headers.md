# Vichwa Maalum vya HTTP

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

## Orodha za Maneno & Zana

* [https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/web/http-request-headers](https://github.com/danielmiessler/SecLists/tree/master/Miscellaneous/web/http-request-headers)
* [https://github.com/rfc-st/humble](https://github.com/rfc-st/humble)

## Vichwa vya Kubadilisha Mahali

Badilisha **IP chanzo**:

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Forwarded-Host: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `X-Client-IP: 127.0.0.1`
* `X-Host: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `Via: 1.0 fred, 1.1 127.0.0.1`
* `Connection: close, X-Forwarded-For` (Angalia vichwa vya hop-by-hop)

Badilisha **mahali**:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`

## Vichwa vya Hop-by-Hop

Kichwa cha hop-by-hop ni kichwa ambacho kimeundwa kusindika na kutumiwa na wakala unayeshughulikia ombi, tofauti na kichwa cha mwisho hadi mwisho.

* `Connection: close, X-Forwarded-For`

{% content-ref url="../../pentesting-web/abusing-hop-by-hop-headers.md" %}
[abusing-hop-by-hop-headers.md](../../pentesting-web/abusing-hop-by-hop-headers.md)
{% endcontent-ref %}

## Kudukua Ombi la HTTP

* `Content-Length: 30`
* `Transfer-Encoding: chunked`

{% content-ref url="../../pentesting-web/http-request-smuggling/" %}
[http-request-smuggling](../../pentesting-web/http-request-smuggling/)
{% endcontent-ref %}

## Vichwa vya Kuhifadhi Cache

**Vichwa vya Kuhifadhi Cache vya Seva**:

* **`X-Cache`** kwenye jibu inaweza kuwa na thamani ya **`miss`** wakati ombi halijahifadhiwa na thamani ya **`hit`** wakati inahifadhiwa
* **`Cache-Control`** inaonyesha ikiwa rasilimali inahifadhiwa na wakati itahifadhiwa tena: `Cache-Control: public, max-age=1800`
* **`Vary`** mara nyingi hutumiwa kwenye jibu kuonyesha **vichwa vingine vya ziada** ambavyo vinachukuliwa kama **sehemu ya ufunguo wa cache** hata kama kawaida hawana ufunguo.
* **`Age`** inafafanua wakati katika sekunde ambazo kitu kimekuwa kwenye hifadhi ya wakala.
* **`Server-Timing: cdn-cache; desc=HIT`** pia inaonyesha kwamba rasilimali ilihifadhiwa

{% content-ref url="../../pentesting-web/cache-deception.md" %}
[cache-deception.md](../../pentesting-web/cache-deception.md)
{% endcontent-ref %}

**Vichwa vya Kuhifadhi Cache vya Ndani**:

* `Clear-Site-Data`: Kichwa kinachoelezea cache ambayo inapaswa kuondolewa: `Clear-Site-Data: "cache", "cookies"`
* `Expires`: Ina tarehe/wakati ambapo jibu linapaswa kumalizika: `Expires: Wed, 21 Oct 2015 07:28:00 GMT`
* `Pragma: no-cache` sawa na `Cache-Control: no-cache`
* `Warning`: Kichwa cha jumla cha HTTP kinachotumika kutoa habari kuhusu matatizo yanayowezekana na hali ya ujumbe. Zaidi ya kichwa kimoja cha `Warning` kinaweza kuonekana kwenye jibu. `Warning: 110 anderson/1.3.37 "Response is stale"`

## Masharti

* Maombi yanayotumia vichwa hivi: **`If-Modified-Since`** na **`If-Unmodified-Since`** yatajibiwa na data tu ikiwa kichwa cha jibu **`Last-Modified`** kina wakati tofauti.
* Maombi ya masharti yanayotumia **`If-Match`** na **`If-None-Match`** hutumia thamani ya Etag ili seva ya wavuti itume maudhui ya jibu ikiwa data (Etag) imebadilika. `Etag` inachukuliwa kutoka kwenye jibu la HTTP.
* Thamani ya **Etag** kawaida **inahesabiwa kulingana** na **maudhui** ya jibu. Kwa mfano, `ETag: W/"37-eL2g8DEyqntYlaLp5XLInBWsjWI"` inaonyesha kuwa `Etag` ni **Sha1** ya **baiti 37**.

## Maombi ya Sehemu

* **`Accept-Ranges`**: Inaonyesha ikiwa seva inasaidia maombi ya sehemu, na ikiwa ndivyo, kwa kifaa gani sehemu inaweza kuelezea. `Accept-Ranges: <range-unit>`
* **`Range`**: Inaonyesha sehemu ya hati ambayo seva inapaswa kurudisha.
* **`If-Range`**: Inaunda ombi la sehemu la masharti ambalo linatimizwa tu ikiwa etag au tarehe iliyotolewa inalingana na rasilimali ya mbali. Hutumiwa kuzuia kupakua sehemu mbili kutoka kwa toleo lisilofaa la rasilimali.
* **`Content-Range`**: Inaonyesha sehemu gani ya ujumbe kamili wa mwili sehemu ndogo inahusika.

## Habari ya Mwili wa Ujumbe

* **`Content-Length`:** Ukubwa wa rasilimali, kwa idadi ya desimali ya baiti.
* **`Content-Type`**: Inaonyesha aina ya media ya rasilimali
* **`Content-Encoding`**: Hutumiwa kuelezea algorithm ya kubana.
*
## Taarifa za Seva

* `Seva: Apache/2.4.1 (Unix)`
* `X-Powered-By: PHP/5.3.3`

## Udhibiti

* **`Ruhusu`**: Kichwa hiki hutumiwa kuwasiliana na njia za HTTP ambazo rasilimali inaweza kushughulikia. Kwa mfano, inaweza kuwekwa kama `Ruhusu: PATA, TUMA, KICHWA`, ikionyesha kuwa rasilimali inasaidia njia hizi.
* **`Tarajia`**: Hutumiwa na mteja kuwasilisha matarajio ambayo seva inahitaji kukidhi ili ombi liweze kusindika kwa mafanikio. Matumizi ya kawaida ni pamoja na kichwa cha `Tarajia: 100-endelee`, ambacho kinamaanisha kuwa mteja anataka kutuma data kubwa. Mteja anatafuta jibu la `100 (Endelea)` kabla ya kuendelea na uhamishaji. Mfumo huu husaidia katika kuboresha matumizi ya mtandao kwa kusubiri uthibitisho wa seva.

## Upakuaji

* Kichwa cha **`Content-Disposition`** katika majibu ya HTTP kinawaelekeza ikiwa faili inapaswa kuonyeshwa **ndani** (ndani ya ukurasa wa wavuti) au kutendewa kama **kiambatisho** (kupakuliwa). Kwa mfano:
```
Content-Disposition: attachment; filename="filename.jpg"
```
Hii inamaanisha faili iliyoitwa "filename.jpg" inalenga kupakuliwa na kuokolewa.

## Vichwa vya Usalama

### Sera ya Usalama wa Yaliyomo (CSP) <a href="#csp" id="csp"></a>

{% content-ref url="../../pentesting-web/content-security-policy-csp-bypass/" %}
[content-security-policy-csp-bypass](../../pentesting-web/content-security-policy-csp-bypass/)
{% endcontent-ref %}

### **Aina Zilizothibitishwa**

Kwa kutekeleza Aina Zilizothibitishwa kupitia CSP, programu zinaweza kulindwa dhidi ya mashambulizi ya DOM XSS. Aina Zilizothibitishwa huhakikisha kuwa vitu vilivyoundwa kwa kuzingatia sera za usalama zilizowekwa pekee ndio vinaweza kutumika katika wito hatari wa API za wavuti, hivyo kuhakikisha usalama wa msimbo wa JavaScript kwa chaguo-msingi.
```javascript
// Feature detection
if (window.trustedTypes && trustedTypes.createPolicy) {
// Name and create a policy
const policy = trustedTypes.createPolicy('escapePolicy', {
createHTML: str => str.replace(/\</g, '&lt;').replace(/>/g, '&gt;');
});
}
```

```javascript
// Assignment of raw strings is blocked, ensuring safety.
el.innerHTML = 'some string'; // Throws an exception.
const escaped = policy.createHTML('<img src=x onerror=alert(1)>');
el.innerHTML = escaped;  // Results in safe assignment.
```
### **X-Content-Type-Options**

Kichwa hiki kinazuia MIME aina ya sniffing, mazoea ambayo yanaweza kusababisha udhaifu wa XSS. Inahakikisha kuwa vivinjari vinaheshimu MIME aina zilizotajwa na seva.
```
X-Content-Type-Options: nosniff
```
### **X-Frame-Options**

Ili kupambana na clickjacking, kichwa hiki kinazuia jinsi hati zinavyoweza kuingizwa katika vitambulisho vya `<frame>`, `<iframe>`, `<embed>`, au `<object>`, na kupendekeza hati zote kutoa ruhusa ya uingizaji wazi.
```
X-Frame-Options: DENY
```
### **Cross-Origin Resource Policy (CORP) na Cross-Origin Resource Sharing (CORS)**

CORP ni muhimu kwa kuelezea ni rasilimali zipi zinaweza kupakiawa na tovuti, kupunguza uvujaji wa tovuti kwa tovuti. CORS, kwa upande mwingine, inaruhusu utaratibu wa kugawana rasilimali kati ya asili tofauti kwa njia inayoruhusu sera ya asili sawa chini ya hali fulani.
```
Cross-Origin-Resource-Policy: same-origin
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Credentials: true
```
### **Cross-Origin Embedder Policy (COEP) na Cross-Origin Opener Policy (COOP)**

COEP na COOP ni muhimu kwa kuwezesha kujitenga kwa asili ya asili, kupunguza hatari kubwa ya mashambulizi kama Spectre. Wanadhibiti kupakia rasilimali za asili ya asili na mwingiliano na madirisha ya asili ya asili, mtawaliwa.
```
Cross-Origin-Embedder-Policy: require-corp
Cross-Origin-Opener-Policy: same-origin-allow-popups
```
### **HTTP Strict Transport Security (HSTS)**

Mwisho, HSTS ni kipengele cha usalama kinacholazimisha vivinjari kuwasiliana na seva tu kupitia uhusiano salama wa HTTPS, hivyo kuimarisha faragha na usalama.
```
Strict-Transport-Security: max-age=3153600
```
## Marejeo

* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers)
* [https://web.dev/security-headers/](https://web.dev/security-headers/)
* [https://web.dev/articles/security-headers](https://web.dev/articles/security-headers)

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa kwenye HackTricks** au **kupakua HackTricks kwa muundo wa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PR kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
