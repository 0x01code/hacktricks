# WebDav

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
使用 [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) 来轻松构建并**自动化工作流程**，这些工作流程由世界上**最先进的**社区工具提供支持。\
立即获取访问权限：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>从零开始学习 AWS 黑客技术，成为</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS 红队专家)</strong></a><strong>！</strong></summary>

其他支持 HackTricks 的方式：

* 如果您希望在 HackTricks 中看到您的**公司广告**或**下载 HackTricks 的 PDF**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* 发现[**PEASS 家族**](https://opensea.io/collection/the-peass-family)，我们独家的 [**NFTs 集合**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram 群组**](https://t.me/peass) 或在 **Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 仓库提交 PR 来**分享您的黑客技巧**。

</details>

一个**HTTP 服务器启用了 WebDav** 是一个你可能可以**更新、删除、移动、复制**文件的服务器。**有时**你**需要**有**有效的凭证**（通常使用 HTTP 基本认证检查）。

你应该尝试**上传**一些**webshell**并从 web 服务器**执行**它来控制服务器。\
通常，要**连接** WebDav 服务器，你需要有效的**凭证**：[**WebDav 暴力破解**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) _(基本认证)_。

另一个常见的配置是**禁止上传**将由 web 服务器**执行**的**扩展名**的文件，你应该检查如何**绕过这个限制**：

* **上传**带有**可执行扩展名**的文件（可能没有被禁止）。
* **上传**没有**可执行扩展名**的文件（如 .txt），然后尝试**重命名**文件（移动）为带有**可执行扩展名**。
* **上传**没有**可执行扩展名**的文件（如 .txt），然后尝试**复制**文件（移动）为带有**可执行扩展名**。

## DavTest

**Davtest** 尝试**上传具有不同扩展名的多个文件**并**检查**扩展名是否**被执行**：
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
输出样本：

![](<../../.gitbook/assets/image (19) (1).png>)

这并不意味着 **.txt** 和 **.html 扩展名正在执行**。这意味着你可以通过网络**访问这些文件**。

## Cadaver

你可以使用这个工具来**连接到 WebDav** 服务器并**手动**执行操作（如**上传**、**移动**或**删除**）。
```
cadaver <IP>
```
## PUT 请求
```
curl -T 'shell.txt' 'http://$ip'
```
## MOVE 请求
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
使用 [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) 轻松构建并**自动化工作流程**，由世界上**最先进**的社区工具提供支持。\
立即获取访问权限：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## IIS5/6 WebDav 漏洞

这个漏洞非常有趣。**WebDav** **不允许** **上传** 或 **重命名** 带有扩展名 **.asp** 的文件。但是你可以通过在文件名末尾**添加** **";.txt"** 来**绕过**这一限制，文件将会像 .asp 文件一样被**执行**（你也可以使用 ".html" 替代 ".txt"，但是**不要忘记 ";"**）。

然后你可以将你的 shell 作为一个 ".**txt" 文件** **上传**，并将其**复制/移动**为 ".asp;.txt" 文件。通过 web 服务器访问该文件时，它将被**执行**（cadaver 会说移动操作没有成功，但实际上它做到了）。

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## 提交凭证

如果 Webdav 使用的是 Apache 服务器，你应该查看 Apache 中配置的站点。通常是：\
_**/etc/apache2/sites-enabled/000-default**_

在其中你可能会找到像这样的内容：
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
正如您所见，这里有文件，其中包含用于**webdav**服务器的有效**凭据**：
```
/etc/apache2/users.password
```
在这类文件中，您会找到**用户名**和密码的**哈希值**。这些是webdav服务器用来认证用户的凭据。

您可以尝试**破解**它们，或者如果您出于某种原因想要**访问** **webdav** 服务器，可以**添加更多**凭据：
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
要检查新凭证是否有效，您可以执行以下操作：
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
<details>

<summary><strong>从零到英雄学习AWS黑客攻击</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想在**HackTricks中看到您的公司广告**或**下载HackTricks的PDF**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取[**官方PEASS & HackTricks商品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs系列**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f)或[**telegram群组**](https://t.me/peass)或在**Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
使用 [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) 轻松构建并**自动化工作流程**，由世界上**最先进**的社区工具提供支持。\
立即获取访问权限：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
