# WebDav

<figure><img src="/.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) pour construire facilement et **automatiser des flux de travail** aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Obtenez un acc√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Un serveur **HTTP avec WebDav** actif est un serveur o√π vous pouvez probablement **mettre √† jour, supprimer, d√©placer, copier** des fichiers. Parfois, vous avez besoin d'avoir des **identifiants valides** (g√©n√©ralement v√©rifi√©s avec l'authentification de base HTTP).

Vous devriez essayer de **t√©l√©charger** un **webshell** et de l'**ex√©cuter** √† partir du serveur web pour prendre le contr√¥le du serveur.\
G√©n√©ralement, pour **se connecter** √† un serveur WebDav, vous aurez besoin d'**identifiants valides** : [**WebDav bruteforce**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) _(Authentification de base)_.

Une autre configuration courante consiste √† **interdire le t√©l√©chargement** de fichiers avec des **extensions** qui seront **ex√©cut√©es** par le serveur web, vous devriez v√©rifier comment **contourner cela** :

* **T√©l√©chargez** des fichiers avec des **extensions ex√©cutables** (ce n'est peut-√™tre pas interdit).
* **T√©l√©chargez** des fichiers **sans extensions ex√©cutables** (comme .txt) et essayez de **renommer** le fichier (d√©placer) avec une **extension ex√©cutable**.
* **T√©l√©chargez** des fichiers **sans extensions ex√©cutables** (comme .txt) et essayez de **copier** le fichier (d√©placer) avec une **extension ex√©cutable**.

## DavTest

**Davtest** essaie de **t√©l√©charger plusieurs fichiers avec diff√©rentes extensions** et **v√©rifie** si l'extension est **ex√©cut√©e** :
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
Output sample:

![](<../../.gitbook/assets/image (19) (1).png>)

Cela ne signifie pas que les extensions **.txt** et **.html sont ex√©cut√©es**. Cela signifie que vous pouvez **acc√©der √† ces fichiers** via le web.

## Cadaver

Vous pouvez utiliser cet outil pour **vous connecter au serveur WebDav** et effectuer des actions (comme **t√©l√©charger**, **d√©placer** ou **supprimer**) **manuellement**.
```
cadaver <IP>
```
## Requ√™te PUT

A PUT request is an HTTP method used to update or create a resource on a server. It is commonly used in WebDAV (Web Distributed Authoring and Versioning) to upload files to a remote server.

Une requ√™te PUT est une m√©thode HTTP utilis√©e pour mettre √† jour ou cr√©er une ressource sur un serveur. Elle est couramment utilis√©e dans WebDAV (Web Distributed Authoring and Versioning) pour t√©l√©charger des fichiers vers un serveur distant.

### How it works

### Fonctionnement

When making a PUT request, the client sends the data to be uploaded in the body of the request. The server then processes the request and either updates the existing resource or creates a new one with the provided data.

Lorsqu'une requ√™te PUT est effectu√©e, le client envoie les donn√©es √† t√©l√©charger dans le corps de la requ√™te. Le serveur traite ensuite la requ√™te et met √† jour la ressource existante ou en cr√©e une nouvelle avec les donn√©es fournies.

### WebDAV and PUT

### WebDAV et PUT

WebDAV is an extension of the HTTP protocol that allows for more advanced file management capabilities. It includes support for methods like PUT, which enables clients to upload files to a remote server.

WebDAV est une extension du protocole HTTP qui permet des fonctionnalit√©s de gestion de fichiers plus avanc√©es. Il inclut la prise en charge de m√©thodes telles que PUT, qui permet aux clients de t√©l√©charger des fichiers vers un serveur distant.

By using the PUT method in WebDAV, users can upload files to a server and manage them remotely. This can be useful for collaborative editing, version control, and other file management tasks.

En utilisant la m√©thode PUT dans WebDAV, les utilisateurs peuvent t√©l√©charger des fichiers vers un serveur et les g√©rer √† distance. Cela peut √™tre utile pour l'√©dition collaborative, le contr√¥le de version et d'autres t√¢ches de gestion de fichiers.

### Security Considerations

### Consid√©rations de s√©curit√©

When using the PUT method, it is important to consider security implications. Unauthorized access to the server could lead to data leaks or unauthorized modifications.

Lors de l'utilisation de la m√©thode PUT, il est important de prendre en compte les implications de s√©curit√©. Un acc√®s non autoris√© au serveur pourrait entra√Æner des fuites de donn√©es ou des modifications non autoris√©es.

To mitigate these risks, it is recommended to implement proper authentication and access controls. Additionally, input validation should be performed to prevent malicious file uploads or other forms of attacks.

Pour att√©nuer ces risques, il est recommand√© de mettre en place une authentification et des contr√¥les d'acc√®s appropri√©s. De plus, une validation des entr√©es doit √™tre effectu√©e pour emp√™cher les t√©l√©chargements de fichiers malveillants ou d'autres formes d'attaques.
```
curl -T 'shell.txt' 'http://$ip'
```
## Requ√™te MOVE

The MOVE request is used in WebDAV to move a resource from one location to another. It is similar to the HTTP `PUT` request, but instead of creating a new resource, it moves an existing resource to a new location.

La requ√™te MOVE est utilis√©e dans WebDAV pour d√©placer une ressource d'un emplacement √† un autre. Elle est similaire √† la requ√™te HTTP `PUT`, mais au lieu de cr√©er une nouvelle ressource, elle d√©place une ressource existante vers un nouvel emplacement.

### Syntax

```
MOVE /source-resource HTTP/1.1
Host: example.com
Destination: /destination-resource
```

### Example

```
MOVE /files/document.txt HTTP/1.1
Host: example.com
Destination: /archive/document.txt
```

In this example, the `MOVE` request moves the `document.txt` file from the `/files` directory to the `/archive` directory on the `example.com` server.

Dans cet exemple, la requ√™te `MOVE` d√©place le fichier `document.txt` du r√©pertoire `/files` vers le r√©pertoire `/archive` sur le serveur `example.com`.
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="/.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) pour construire et automatiser facilement des flux de travail aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Obtenez un acc√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Vuln√©rabilit√© WebDav IIS5/6

Cette vuln√©rabilit√© est tr√®s int√©ressante. Le **WebDav** ne permet pas de t√©l√©charger ou de renommer des fichiers avec l'extension **.asp**. Mais vous pouvez contourner cela en ajoutant √† la fin du nom **";.txt"** et le fichier sera ex√©cut√© comme s'il s'agissait d'un fichier .asp (vous pouvez √©galement utiliser ".html" au lieu de ".txt" mais **N'OUBLIEZ PAS le ";"**).

Ensuite, vous pouvez t√©l√©charger votre shell en tant que fichier ".**txt"** et le copier/d√©placer vers un fichier ".asp;.txt". En acc√©dant √† ce fichier via le serveur web, il sera ex√©cut√© (cadaver indiquera que l'action de d√©placement n'a pas fonctionn√©, mais c'est le cas).

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## Poster les informations d'identification

Si Webdav utilisait un serveur Apache, vous devriez regarder les sites configur√©s dans Apache. G√©n√©ralement :\
_**/etc/apache2/sites-enabled/000-default**_

√Ä l'int√©rieur, vous pourriez trouver quelque chose comme :
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
Comme vous pouvez le voir, il y a les fichiers avec les **identifiants** valides pour le serveur **webdav** :
```
/etc/apache2/users.password
```
√Ä l'int√©rieur de ce type de fichiers, vous trouverez le **nom d'utilisateur** et un **hash** du mot de passe. Ce sont les informations d'identification que le serveur WebDAV utilise pour authentifier les utilisateurs.

Vous pouvez essayer de les **craquer**, ou en **ajouter davantage** si, pour une raison quelconque, vous souhaitez **acc√©der** au serveur **WebDAV** :
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Pour v√©rifier si les nouvelles informations d'identification fonctionnent, vous pouvez faire :
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? Ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="/.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) pour construire et **automatiser facilement des workflows** aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Obtenez un acc√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
