# WebDav

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir e automatizar facilmente fluxos de trabalho com as ferramentas comunit√°rias mais avan√ßadas do mundo.\
Acesse hoje:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? Ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Um servidor **HTTP com WebDav** ativo √© um servidor onde voc√™ provavelmente pode **atualizar, excluir, mover, copiar** arquivos. √Äs vezes, voc√™ precisa ter **credenciais v√°lidas** (geralmente verifique com Autentica√ß√£o B√°sica HTTP).

Voc√™ deve tentar **fazer upload** de algum **webshell** e **execut√°-lo** a partir do servidor web para assumir o controle sobre o servidor.\
Normalmente, para **conectar** a um servidor WebDav, voc√™ precisar√° de **credenciais v√°lidas**: [**WebDav bruteforce**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) _(Autentica√ß√£o B√°sica)_.

Outra configura√ß√£o comum √© **proibir o upload** de arquivos com **extens√µes** que ser√£o **executadas** pelo servidor web, voc√™ deve verificar como **burlar isso:**

* **Fazer upload** de arquivos com **extens√µes execut√°veis** (talvez n√£o seja proibido).
* **Fazer upload** de arquivos **sem extens√µes execut√°veis** (como .txt) e tentar **renomear** o arquivo (mover) com uma **extens√£o execut√°vel**.
* **Fazer upload** de arquivos **sem extens√µes execut√°veis** (como .txt) e tentar **copiar** o arquivo (mover) com **extens√£o execut√°vel**.

## DavTest

**Davtest** tenta **fazer upload de v√°rios arquivos com diferentes extens√µes** e **verifica** se a extens√£o √© **executada**:
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
Sa√≠da de exemplo:

![](<../../.gitbook/assets/image (19) (1).png>)

Isso n√£o significa que as extens√µes **.txt** e **.html est√£o sendo executadas**. Isso significa que voc√™ pode **acessar esses arquivos** atrav√©s da web.

## Cadaver

Voc√™ pode usar essa ferramenta para **conectar-se ao servidor WebDav** e realizar a√ß√µes (como **upload**, **mover** ou **excluir**) **manualmente**.
```
cadaver <IP>
```
## Pedido PUT

The PUT method is used to update or create a resource on a server. In the context of web applications, it is commonly used to upload files or modify existing data.

O m√©todo PUT √© usado para atualizar ou criar um recurso em um servidor. No contexto de aplica√ß√µes web, √© comumente usado para fazer upload de arquivos ou modificar dados existentes.

### WebDAV and PUT

WebDAV (Web Distributed Authoring and Versioning) is an extension of the HTTP protocol that allows for more advanced file management capabilities. One of the features provided by WebDAV is the ability to use the PUT method to upload files to a server.

WebDAV (Web Distributed Authoring and Versioning) √© uma extens√£o do protocolo HTTP que permite recursos avan√ßados de gerenciamento de arquivos. Uma das funcionalidades fornecidas pelo WebDAV √© a capacidade de usar o m√©todo PUT para fazer upload de arquivos para um servidor.

### Exploiting PUT Requests

In some cases, the server may not properly validate or restrict the use of the PUT method, allowing an attacker to upload arbitrary files to the server. This can be exploited to gain unauthorized access or to perform other malicious activities.

Em alguns casos, o servidor pode n√£o validar corretamente ou restringir o uso do m√©todo PUT, permitindo que um atacante fa√ßa upload de arquivos arbitr√°rios para o servidor. Isso pode ser explorado para obter acesso n√£o autorizado ou realizar outras atividades maliciosas.

To exploit this vulnerability, an attacker can send a PUT request to the target server with a specially crafted payload. The payload can be a malicious file that, when executed on the server, allows the attacker to gain control over the system.

Para explorar essa vulnerabilidade, um atacante pode enviar um pedido PUT para o servidor de destino com uma carga √∫til especialmente criada. A carga √∫til pode ser um arquivo malicioso que, quando executado no servidor, permite ao atacante obter controle sobre o sistema.

### Mitigating the Risk

To mitigate the risk of exploitation through PUT requests, it is important to properly validate and restrict the use of the PUT method on the server. This can be done by implementing access controls, input validation, and file type restrictions.

Para mitigar o risco de explora√ß√£o por meio de pedidos PUT, √© importante validar corretamente e restringir o uso do m√©todo PUT no servidor. Isso pode ser feito implementando controles de acesso, valida√ß√£o de entrada e restri√ß√µes de tipo de arquivo.
```
curl -T 'shell.txt' 'http://$ip'
```
## Pedido MOVE

The MOVE request is used in WebDAV to move a resource from one location to another. It is similar to the HTTP `PUT` request, but instead of creating a new resource, it moves an existing resource to a new location.

O pedido MOVE √© usado no WebDAV para mover um recurso de uma localiza√ß√£o para outra. √â semelhante ao pedido HTTP `PUT`, mas em vez de criar um novo recurso, move um recurso existente para uma nova localiza√ß√£o.

### Syntax

```
MOVE /source-resource HTTP/1.1
Host: example.com
Destination: /destination-resource
```

### Example

```
MOVE /files/document.txt HTTP/1.1
Host: example.com
Destination: /archive/document.txt
```

In this example, the `MOVE` request is used to move the `document.txt` file from the `/files` directory to the `/archive` directory.

Neste exemplo, o pedido `MOVE` √© usado para mover o arquivo `document.txt` do diret√≥rio `/files` para o diret√≥rio `/archive`.
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir e automatizar facilmente fluxos de trabalho com as ferramentas comunit√°rias mais avan√ßadas do mundo.\
Acesse hoje mesmo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Vulnerabilidade do WebDav no IIS5/6

Essa vulnerabilidade √© muito interessante. O **WebDav** n√£o permite **fazer upload** ou **renomear** arquivos com a extens√£o **.asp**. Mas voc√™ pode **burlar** isso adicionando ao final do nome **";.txt"** e o arquivo ser√° **executado** como se fosse um arquivo .asp (voc√™ tamb√©m pode **usar ".html" em vez de ".txt"**, mas **N√ÉO esque√ßa do ";"**).

Ent√£o voc√™ pode **fazer upload** do seu shell como um arquivo ".**txt"** e **copi√°-lo/mov√™-lo para um arquivo ".asp;.txt"**. Ao acessar esse arquivo pelo servidor web, ele ser√° **executado** (o cadaver dir√° que a a√ß√£o de movimento n√£o funcionou, mas funcionou).

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## Postar credenciais

Se o Webdav estiver usando um servidor Apache, voc√™ deve procurar nos sites configurados no Apache. Comumente:\
_**/etc/apache2/sites-enabled/000-default**_

Dentro dele, voc√™ pode encontrar algo como:
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
Como voc√™ pode ver, aqui est√£o os arquivos com as **credenciais** v√°lidas para o servidor **webdav**:
```
/etc/apache2/users.password
```
Dentro deste tipo de arquivos, voc√™ encontrar√° o **nome de usu√°rio** e um **hash** da senha. Essas s√£o as credenciais que o servidor webdav est√° usando para autenticar os usu√°rios.

Voc√™ pode tentar **quebr√°-las**, ou **adicionar mais** se, por algum motivo, voc√™ quiser **acessar** o servidor **webdav**:
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Para verificar se as novas credenciais est√£o funcionando, voc√™ pode fazer o seguinte:
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir e **automatizar fluxos de trabalho** com facilidade, utilizando as ferramentas comunit√°rias mais avan√ßadas do mundo.\
Obtenha acesso hoje:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
