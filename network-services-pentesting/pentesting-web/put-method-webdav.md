# WebDav

<figure><img src="../../.gitbook/assets/image (45).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) pour construire facilement et **automatiser des workflows** aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Acc√©dez d√®s aujourd'hui √† :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert de l'√©quipe rouge HackTricks AWS)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

Lorsque vous traitez avec un **serveur HTTP avec WebDav** activ√©, il est possible de **manipuler des fichiers** si vous avez les bonnes **informations d'identification**, g√©n√©ralement v√©rifi√©es via **l'authentification de base HTTP**. Prendre le contr√¥le d'un tel serveur implique souvent **le t√©l√©chargement et l'ex√©cution d'un webshell**.

L'acc√®s au serveur WebDav n√©cessite g√©n√©ralement des **informations d'identification valides**, avec le [**bruteforce WebDav**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) √©tant une m√©thode courante pour les acqu√©rir.

Pour contourner les restrictions sur les t√©l√©chargements de fichiers, en particulier ceux emp√™chant l'ex√©cution de scripts c√¥t√© serveur, vous pouvez :

* **T√©l√©charger** des fichiers avec des **extensions ex√©cutables** directement si ce n'est pas restreint.
* **Renommer** les fichiers t√©l√©charg√©s non ex√©cutables (comme .txt) en une extension ex√©cutable.
* **Copier** les fichiers t√©l√©charg√©s non ex√©cutables, en changeant leur extension pour une extension ex√©cutable.

## DavTest

**Davtest** essaie de **t√©l√©charger plusieurs fichiers avec diff√©rentes extensions** et **v√©rifie** si l'extension est **ex√©cut√©e** :
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
## Cadaver

Vous pouvez utiliser cet outil pour **se connecter au serveur WebDav** et effectuer des actions (comme **t√©l√©charger**, **d√©placer** ou **supprimer**) **manuellement**.
```
cadaver <IP>
```
## Requ√™te PUT
```
curl -T 'shell.txt' 'http://$ip'
```
## Requ√™te MOVE
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (45).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) pour construire facilement et **automatiser des workflows** aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Acc√©dez d√®s aujourd'hui √† :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Vuln√©rabilit√© WebDav IIS5/6

Cette vuln√©rabilit√© est tr√®s int√©ressante. Le **WebDav** ne permet pas de **t√©l√©charger** ou de **renommer** des fichiers avec l'extension **.asp**. Mais vous pouvez **contourner** cela en ajoutant √† la fin du nom **";.txt"** et le fichier sera **ex√©cut√©** comme s'il s'agissait d'un fichier .asp (vous pourriez √©galement **utiliser ".html" au lieu de ".txt"** mais **N'OUBLIEZ PAS le ";"**).

Ensuite, vous pouvez **t√©l√©charger** votre shell en tant que fichier ".**txt"** et le **copier/d√©placer dans un fichier ".asp;.txt"**. En acc√©dant √† ce fichier via le serveur web, il sera **ex√©cut√©** (cadaver indiquera que l'action de d√©placement n'a pas fonctionn√©, mais c'est le cas).

![](<../../.gitbook/assets/image (1089).png>)

## Post-identifiants

Si le Webdav utilisait un serveur Apache, vous devriez examiner les sites configur√©s dans Apache. G√©n√©ralement :\
_**/etc/apache2/sites-enabled/000-default**_

√Ä l'int√©rieur, vous pourriez trouver quelque chose comme :
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
Comme vous pouvez le voir, il y a les fichiers avec les **identifiants** valides pour le serveur **webdav** :
```
/etc/apache2/users.password
```
√Ä l'int√©rieur de ce type de fichiers, vous trouverez le **nom d'utilisateur** et un **hash** du mot de passe. Ce sont les informations d'identification que le serveur webdav utilise pour authentifier les utilisateurs.

Vous pouvez essayer de les **craquer**, ou d'en **ajouter davantage** si, pour une raison quelconque, vous souhaitez **acc√©der** au serveur **webdav**:
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Pour v√©rifier si les nouvelles informations d'identification fonctionnent, vous pouvez faire :
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
## R√©f√©rences

* [https://vk9-sec.com/exploiting-webdav/](https://vk9-sec.com/exploiting-webdav/)

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert Red Team AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="../../.gitbook/assets/image (45).png" alt=""><figcaption></figcaption></figure>

\
Utilisez [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) pour construire et **automatiser facilement des workflows** aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Acc√©dez d√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
