# WebDav

<figure><img src="../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)を使用して、世界で最も先進的なコミュニティツールによって強化された**ワークフローを簡単に構築**し、自動化します。\
今すぐアクセスを取得：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* **サイバーセキュリティ企業で働いていますか？** **HackTricksで会社を宣伝**したいですか？または、**最新バージョンのPEASSをダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです
* [**公式のPEASS＆HackTricks swag**](https://peass.creator-spring.com)を手に入れましょう
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ハッキングのトリックを共有するには、PRを** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **と** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **に提出してください。**

</details>

アクティブな**WebDavを持つHTTPサーバー**は、おそらくファイルの**更新、削除、移動、コピー**ができるサーバーです。**時には**有効な資格情報**（通常はHTTPベーシック認証で確認）が必要です。

Webサーバーから**いくつかのWebシェルをアップロード**して**実行**し、サーバーを制御しましょう。\
通常、WebDavサーバーに接続するには、有効な**資格情報**が必要です：[**WebDavブルートフォース**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth)（基本認証）。

他の一般的な設定は、Webサーバーによって**実行される**ファイルの**拡張子**で**ファイルのアップロードを禁止**することです。これを**バイパス**する方法を確認する必要があります。

* **実行可能な拡張子**を持つファイルを**アップロード**します（おそらく禁止されていない場合）。
* **実行可能な拡張子**を持たないファイル（.txtなど）を**アップロード**し、ファイルを**実行可能な拡張子**で**名前を変更**（移動）してみてください。
* **実行可能な拡張子**を持たないファイル（.txtなど）を**アップロード**し、ファイルを**実行可能な拡張子**で**コピー**（移動）してみてください。

## DavTest

**Davtest**は、さまざまな拡張子を持つ複数のファイルを**アップロード**し、拡張子が**実行されるかどうか**を**チェック**します：
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
出力サンプル：

![](<../../.gitbook/assets/image (19) (1).png>)

これは、**.txt** と **.html 拡張子が実行されている**ことを意味しません。これは、これらのファイルにウェブを通じて**アクセスできる**ことを意味します。

## Cadaver

このツールを使用して、**WebDav サーバーに接続**し、**アップロード**、**移動**、**削除**などの操作を**手動で**実行できます。
```
cadaver <IP>
```
## PUTリクエスト

A PUT request is an HTTP method used to update or create a resource on a server. It is commonly used in WebDAV (Web Distributed Authoring and Versioning) to upload files to a remote server.

PUTリクエストは、サーバー上のリソースを更新または作成するために使用されるHTTPメソッドです。これは、WebDAV（Web Distributed Authoring and Versioning）で一般的に使用され、リモートサーバーにファイルをアップロードするために使用されます。

To send a PUT request, you need to specify the URL of the resource you want to update or create, along with the data you want to send. The data can be in various formats such as JSON, XML, or plain text.

PUTリクエストを送信するには、更新または作成したいリソースのURLと、送信したいデータを指定する必要があります。データは、JSON、XML、またはプレーンテキストなど、さまざまな形式で提供できます。

When performing a penetration test, the PUT method can be used to test for vulnerabilities such as file upload functionality that may allow unauthorized access or code execution on the server. By sending a crafted PUT request with malicious data, an attacker can attempt to exploit these vulnerabilities.

ペネトレーションテストを実行する際には、PUTメソッドを使用して、不正なアクセスやサーバー上でのコード実行を許可する可能性のあるファイルのアップロード機能などの脆弱性をテストすることができます。攻撃者は、悪意のあるデータを含む特別なPUTリクエストを送信することで、これらの脆弱性を悪用しようとすることができます。

It is important to note that not all servers or web applications support the PUT method, and even if they do, they may have security measures in place to prevent unauthorized access or malicious uploads. Always ensure that you have proper authorization and permission before attempting any penetration testing activities.

すべてのサーバーやWebアプリケーションがPUTメソッドをサポートしているわけではなく、サポートしていても、不正なアクセスや悪意のあるアップロードを防ぐためのセキュリティ対策が施されている場合があります。ペネトレーションテストの活動を行う前に、適切な認可と許可を持っていることを常に確認してください。
```
curl -T 'shell.txt' 'http://$ip'
```
## MOVE リクエスト

The MOVE request is used in WebDAV to move a resource from one location to another. It is similar to the HTTP PUT method, but instead of creating a new resource, it moves an existing resource to a new location.

MOVE リクエストは、WebDAV でリソースを1つの場所から別の場所に移動するために使用されます。これは HTTP PUT メソッドと似ていますが、新しいリソースを作成する代わりに、既存のリソースを新しい場所に移動します。

The MOVE request is sent with the following syntax:

MOVE リクエストは、次の構文で送信されます:

```
MOVE /source-resource HTTP/1.1
Host: example.com
Destination: /destination-resource
```

The `source-resource` is the URL of the resource that needs to be moved, and the `destination-resource` is the URL of the new location where the resource should be moved to.

`source-resource` は移動する必要のあるリソースの URL であり、`destination-resource` はリソースを移動する新しい場所の URL です。

The server responds with a `200 OK` status code if the move is successful. If the resource cannot be moved, the server may respond with a `409 Conflict` status code.

サーバーは、移動が成功した場合に `200 OK` ステータスコードで応答します。リソースを移動できない場合、サーバーは `409 Conflict` ステータスコードで応答する場合があります。

The MOVE request can be used by an attacker to move sensitive files to a location where they can be accessed by unauthorized users. It can also be used to overwrite existing files, causing data loss or disruption of services.

MOVE リクエストは、攻撃者が機密ファイルを権限のないユーザーがアクセスできる場所に移動するために使用されることがあります。また、既存のファイルを上書きしてデータの損失やサービスの中断を引き起こすこともあります。
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)を使用して、世界で最も高度なコミュニティツールによって強化された**ワークフロー**を簡単に構築および自動化できます。\
今すぐアクセスを取得：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## IIS5/6 WebDavの脆弱性

この脆弱性は非常に興味深いです。**WebDav**は、拡張子**.asp**のファイルの**アップロード**や**名前の変更**を**許可しません**。しかし、名前の末尾に**";.txt"**を追加することで、この制限を**バイパス**することができ、ファイルは**.aspファイルとして実行**されます（".txt"の代わりに".html"を使用することもできますが、**";"を忘れないでください**）。

その後、シェルを".**txtファイル**"としてアップロードし、それを".asp;.txtファイル"に**コピー/移動**します。Webサーバーを介してそのファイルにアクセスすると、それが**実行**されます（cadaverは移動アクションが機能しなかったと言いますが、実際には機能しています）。

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## 認証情報の投稿

WebdavがApacheサーバーを使用している場合は、Apacheで構成されたサイトを確認する必要があります。一般的には：\
_**/etc/apache2/sites-enabled/000-default**_

その中には、次のようなものが見つかるかもしれません：
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
以下のように、**webdav**サーバーの有効な**資格情報**を持つファイルがあります：
```
/etc/apache2/users.password
```
この種のファイルの中には、**ユーザー名**とパスワードの**ハッシュ**が含まれています。これらは、WebDAVサーバーがユーザーを認証するために使用している資格情報です。

これらを**クラック**するか、何らかの理由で**WebDAV**サーバーに**アクセス**したい場合には、追加することもできます。
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
新しい資格情報が機能しているかどうかを確認するには、次の操作を行うことができます：
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* **サイバーセキュリティ企業**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。
* [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**。**
* **ハッキングのトリックを共有するには、PRを** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **と** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **に提出してください。**

</details>

<figure><img src="../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)を使用して、世界で最も**高度なコミュニティツール**によって強化された**ワークフローを簡単に構築**および**自動化**します。\
今すぐアクセスを取得：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
