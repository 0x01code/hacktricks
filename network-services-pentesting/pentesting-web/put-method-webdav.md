# WebDav

![](<../../.gitbook/assets/image (9) (1) (2).png>)

Utilisez [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) pour construire et automatiser facilement des flux de travail aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Obtenez l'acc√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une entreprise de **cybers√©curit√©** ? Voulez-vous voir votre entreprise annonc√©e dans HackTricks ? ou voulez-vous avoir acc√®s √† la derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Un serveur **HTTP avec WebDav** actif est un serveur o√π vous pouvez probablement **mettre √† jour, supprimer, d√©placer, copier** des fichiers. Parfois, vous avez besoin de **valides identifiants** (v√©rifiez g√©n√©ralement avec l'authentification de base HTTP).

Vous devriez essayer de **t√©l√©charger** un **webshell** et de l'**ex√©cuter** depuis le serveur web pour prendre le contr√¥le du serveur.\
G√©n√©ralement, pour **se connecter** √† un serveur WebDav, vous aurez besoin de **valides identifiants** : [**WebDav bruteforce**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) _(Authentification de base)_.

Une autre configuration courante consiste √† **interdire le t√©l√©chargement** de fichiers avec des **extensions** qui seront **ex√©cut√©es** par le serveur web, vous devriez v√©rifier comment **contourner cela** :

* **T√©l√©chargez** des fichiers avec des **extensions ex√©cutables** (peut-√™tre n'est-ce pas interdit).
* **T√©l√©chargez** des fichiers **sans extensions ex√©cutables** (comme .txt) et essayez de **renommer** le fichier (d√©placer) avec une **extension ex√©cutable**.
* **T√©l√©chargez** des fichiers **sans extensions ex√©cutables** (comme .txt) et essayez de **copier** le fichier (d√©placer) avec une **extension ex√©cutable**.

## DavTest

**Davtest** essaie de **t√©l√©charger plusieurs fichiers avec des extensions diff√©rentes** et **v√©rifie** si l'extension est **ex√©cut√©e** :
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
## Cadaver

Vous pouvez utiliser cet outil pour **se connecter au serveur WebDav** et effectuer des actions (comme **t√©l√©charger**, **d√©placer** ou **supprimer**) **manuellement**.

Cela ne signifie pas que les extensions **.txt** et **.html sont ex√©cut√©es**. Cela signifie que vous pouvez **acc√©der √† ces fichiers** via le web.

![](<../../.gitbook/assets/image (19) (1) (1).png>)
```
cadaver <IP>
```
## Requ√™te PUT

---

### Description

### Description

The HTTP PUT method is used to update a resource on a server. In the context of web applications, it is commonly used to update files on a web server. 

La m√©thode PUT HTTP est utilis√©e pour mettre √† jour une ressource sur un serveur. Dans le contexte des applications web, elle est couramment utilis√©e pour mettre √† jour des fichiers sur un serveur web.

---

### Vulnerability

### Vuln√©rabilit√©

The PUT method can be vulnerable to attacks such as directory traversal and file overwriting. If the server does not properly validate the input, an attacker can use a PUT request to write arbitrary files to the server or overwrite existing files. 

La m√©thode PUT peut √™tre vuln√©rable √† des attaques telles que la travers√©e de r√©pertoire et l'√©crasement de fichiers. Si le serveur ne valide pas correctement l'entr√©e, un attaquant peut utiliser une requ√™te PUT pour √©crire des fichiers arbitraires sur le serveur ou √©craser des fichiers existants.

---

### Exploitation

### Exploitation

To exploit this vulnerability, an attacker can use a tool such as cURL to send a PUT request to the server with a specially crafted payload. The payload can include directory traversal sequences or file content to be written to the server. 

Pour exploiter cette vuln√©rabilit√©, un attaquant peut utiliser un outil tel que cURL pour envoyer une requ√™te PUT au serveur avec une charge utile sp√©cialement con√ßue. La charge utile peut inclure des s√©quences de travers√©e de r√©pertoire ou du contenu de fichier √† √©crire sur le serveur.

---

### Mitigation

### Att√©nuation

To mitigate this vulnerability, the server should properly validate the input and restrict access to sensitive directories. Additionally, the use of a Web Application Firewall (WAF) can help to detect and block malicious PUT requests. 

Pour att√©nuer cette vuln√©rabilit√©, le serveur doit valider correctement l'entr√©e et restreindre l'acc√®s aux r√©pertoires sensibles. De plus, l'utilisation d'un pare-feu d'application Web (WAF) peut aider √† d√©tecter et bloquer les requ√™tes PUT malveillantes.
```
curl -T 'shell.txt' 'http://$ip'
```
## Requ√™te MOVE
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
![](<../../.gitbook/assets/image (9) (1) (2).png>)

Utilisez [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) pour construire et automatiser facilement des flux de travail aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Obtenez l'acc√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Vuln√©rabilit√© IIS5/6 WebDav

Cette vuln√©rabilit√© est tr√®s int√©ressante. Le **WebDav** ne permet pas de t√©l√©charger ou de renommer des fichiers avec l'extension **.asp**. Mais vous pouvez contourner cela en ajoutant √† la fin du nom **";.txt"** et le fichier sera ex√©cut√© comme s'il s'agissait d'un fichier .asp (vous pouvez √©galement utiliser ".html" au lieu de ".txt" mais n'oubliez pas le ";" ).

Ensuite, vous pouvez t√©l√©charger votre shell en tant que fichier ".**txt"** et le copier/d√©placer dans un fichier ".asp;.txt". En acc√©dant √† ce fichier via le serveur web, il sera ex√©cut√© (cadaver indiquera que l'action de d√©placement n'a pas fonctionn√©, mais c'est le cas).

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## Poster des informations d'identification

Si Webdav utilisait un serveur Apache, vous devriez regarder les sites configur√©s dans Apache. Couramment :\
_**/etc/apache2/sites-enabled/000-default**_

√Ä l'int√©rieur, vous pourriez trouver quelque chose comme :
```
ServerAdmin webmaster@localhost
        Alias /webdav /var/www/webdav
        <Directory /var/www/webdav>
                DAV On
                AuthType Digest
                AuthName "webdav"
                AuthUserFile /etc/apache2/users.password
                Require valid-user
```
Comme vous pouvez le voir, il y a des fichiers avec les **identifiants** valides pour le serveur **webdav** :
```
/etc/apache2/users.password
```
√Ä l'int√©rieur de ce type de fichiers, vous trouverez le **nom d'utilisateur** et un **hash** du mot de passe. Ce sont les informations d'identification que le serveur WebDAV utilise pour authentifier les utilisateurs.

Vous pouvez essayer de les **craquer**, ou d'en **ajouter davantage** si pour une raison quelconque vous souhaitez **acc√©der** au serveur **WebDAV** :
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Pour v√©rifier si les nouvelles informations d'identification fonctionnent, vous pouvez faire :
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une entreprise de **cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) **groupe Discord** ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
Utilisez [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) pour construire et **automatiser des workflows** aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Obtenez l'acc√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
