# WebDav

<figure><img src="../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y automatizar f√°cilmente flujos de trabajo con las herramientas comunitarias m√°s avanzadas del mundo.\
Obt√©n acceso hoy mismo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obt√©n el [**swag oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Un servidor **HTTP con WebDav** activo es un servidor donde probablemente puedas **actualizar, eliminar, mover, copiar** archivos. A veces, es necesario tener **credenciales v√°lidas** (generalmente se verifica con Autenticaci√≥n B√°sica HTTP).

Deber√≠as intentar **subir** una **webshell** y **ejecutarla** desde el servidor web para tomar el control del servidor.\
Por lo general, para **conectarte** a un servidor WebDav necesitar√°s **credenciales v√°lidas**: [**WebDav bruteforce**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) _(Autenticaci√≥n B√°sica)_.

Otra configuraci√≥n com√∫n es **prohibir la carga** de archivos con **extensiones** que ser√°n **ejecutadas** por el servidor web, debes verificar c√≥mo **bypassear esto**:

* **Sube** archivos con **extensiones ejecutables** (quiz√°s no est√© prohibido).
* **Sube** archivos **sin extensiones ejecutables** (como .txt) e intenta **renombrar** el archivo (moverlo) con una **extensi√≥n ejecutable**.
* **Sube** archivos **sin extensiones ejecutables** (como .txt) e intenta **copiar** el archivo (moverlo) con una **extensi√≥n ejecutable**.

## DavTest

**Davtest** intenta **subir varios archivos con diferentes extensiones** y **verifica** si la extensi√≥n es **ejecutada**:
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
Salida de ejemplo:

![](<../../.gitbook/assets/image (19) (1).png>)

Esto no significa que las extensiones **.txt** y **.html se est√©n ejecutando**. Esto significa que puedes **acceder a estos archivos** a trav√©s de la web.

## Cadaver

Puedes usar esta herramienta para **conectarte al servidor WebDav** y realizar acciones (como **subir**, **mover** o **eliminar**) **manualmente**.
```
cadaver <IP>
```
## Solicitud PUT

A PUT request is an HTTP method used to update or create a resource on a server. It is commonly used in WebDAV (Web Distributed Authoring and Versioning) to upload files to a remote server.

Una solicitud PUT es un m√©todo HTTP utilizado para actualizar o crear un recurso en un servidor. Se utiliza com√∫nmente en WebDAV (Web Distributed Authoring and Versioning) para cargar archivos en un servidor remoto.

### WebDAV and PUT method

WebDAV is an extension of the HTTP protocol that allows clients to perform remote web content authoring operations. The PUT method is one of the main methods used in WebDAV to upload files to a server.

WebDAV es una extensi√≥n del protocolo HTTP que permite a los clientes realizar operaciones de autor√≠a de contenido web de forma remota. El m√©todo PUT es uno de los principales m√©todos utilizados en WebDAV para cargar archivos en un servidor.

### How PUT method works

When a PUT request is sent to a server, it includes the file data in the request body and specifies the location where the file should be stored on the server. If the specified location already exists, the file will be updated with the new data. If the location does not exist, a new file will be created.

Cuando se env√≠a una solicitud PUT a un servidor, esta incluye los datos del archivo en el cuerpo de la solicitud y especifica la ubicaci√≥n donde el archivo debe almacenarse en el servidor. Si la ubicaci√≥n especificada ya existe, el archivo se actualizar√° con los nuevos datos. Si la ubicaci√≥n no existe, se crear√° un nuevo archivo.

### Security implications

The PUT method can introduce security vulnerabilities if not properly configured. Attackers can exploit misconfigurations to upload malicious files or overwrite existing files on the server. It is important to ensure that access controls and file permissions are properly configured to prevent unauthorized access and data leakage.

El m√©todo PUT puede introducir vulnerabilidades de seguridad si no se configura correctamente. Los atacantes pueden aprovechar las configuraciones incorrectas para cargar archivos maliciosos o sobrescribir archivos existentes en el servidor. Es importante asegurarse de que los controles de acceso y los permisos de archivo est√©n configurados correctamente para evitar el acceso no autorizado y la filtraci√≥n de datos.
```
curl -T 'shell.txt' 'http://$ip'
```
## Solicitud MOVE

The MOVE request is used in WebDAV to move a resource from one location to another. It is similar to the HTTP `PUT` request, but instead of creating a new resource, it moves an existing resource to a different location.

La solicitud MOVE se utiliza en WebDAV para mover un recurso de una ubicaci√≥n a otra. Es similar a la solicitud HTTP `PUT`, pero en lugar de crear un nuevo recurso, mueve un recurso existente a una ubicaci√≥n diferente.

### Syntax

```
MOVE /source-resource HTTP/1.1
Host: example.com
Destination: /destination-resource
```

### Example

```
MOVE /files/document.txt HTTP/1.1
Host: example.com
Destination: /archive/document.txt
```

In this example, the `MOVE` request moves the `document.txt` file from the `/files` directory to the `/archive` directory on the server.

En este ejemplo, la solicitud `MOVE` mueve el archivo `document.txt` del directorio `/files` al directorio `/archive` en el servidor.
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
<figure><img src="../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y automatizar f√°cilmente flujos de trabajo con las herramientas comunitarias m√°s avanzadas del mundo.\
Obt√©n acceso hoy mismo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Vulnerabilidad de WebDav en IIS5/6

Esta vulnerabilidad es muy interesante. El **WebDav** no permite **subir** o **renombrar** archivos con la extensi√≥n **.asp**. Pero puedes **burlar** esto agregando al final del nombre **";.txt"** y el archivo se ejecutar√° como si fuera un archivo .asp (tambi√©n puedes **usar ".html" en lugar de ".txt"** pero **NO olvides el ";"**).

Luego puedes **subir** tu shell como un archivo ".**txt"** y **copiar/moverlo a un archivo ".asp;.txt"**. Al acceder a ese archivo a trav√©s del servidor web, se ejecutar√° (cadaver dir√° que la acci√≥n de mover no funcion√≥, pero s√≠ lo hizo).

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## Publicar credenciales

Si el Webdav estaba utilizando un servidor Apache, debes buscar en los sitios configurados en Apache. Com√∫nmente:\
_**/etc/apache2/sites-enabled/000-default**_

Dentro de √©l podr√≠as encontrar algo como:
```
ServerAdmin webmaster@localhost
Alias /webdav /var/www/webdav
<Directory /var/www/webdav>
DAV On
AuthType Digest
AuthName "webdav"
AuthUserFile /etc/apache2/users.password
Require valid-user
```
Como puedes ver, aqu√≠ est√°n los archivos con las **credenciales** v√°lidas para el servidor **webdav**:
```
/etc/apache2/users.password
```
Dentro de este tipo de archivos encontrar√°s el **nombre de usuario** y un **hash** de la contrase√±a. Estas son las credenciales que el servidor webdav utiliza para autenticar a los usuarios.

Puedes intentar **descifrar** las contrase√±as, o **agregar m√°s** si por alguna raz√≥n deseas **acceder** al servidor **webdav**:
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Para verificar si las nuevas credenciales funcionan, puedes hacer lo siguiente:
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obt√©n el [**merchandising oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** con las herramientas comunitarias m√°s avanzadas del mundo.\
Obt√©n acceso hoy mismo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
