# Kupita 403 & 401

<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA USAJILI**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi wa PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<figure><img src="../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**Usanidi wa papo hapo wa upimaji wa udhaifu & udukuzi wa mtandao**. Tekeleza udukuzi kamili kutoka mahali popote na zana na vipengele zaidi ya 20 vinavyoanzia uchunguzi hadi ripoti. Hatuchukui nafasi ya wadukuzi - tunatengeneza zana za desturi, ugunduzi & moduli za kutumia ili kuwarudishia muda wa kuchimba kwa kina, kuvunja makompyuta, na kufurahi.

{% embed url="https://pentest-tools.com/" %}

## Kufanya Majaribio ya Maneno/Methodi za HTTP

Jaribu kutumia **methodi tofauti** kufikia faili: `GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`

* Angalia vichwa vya majibu, labda taarifa fulani inaweza kutolewa. Kwa mfano, majibu ya **200** kwa **HEAD** na `Content-Length: 55` inamaanisha kwamba **methodi ya HEAD inaweza kupata taarifa**. Lakini bado unahitaji kupata njia ya kutoa taarifa hiyo.
* Kutumia kichwa cha HTTP kama `X-HTTP-Method-Override: PUT` inaweza kubadilisha methodi iliyotumika.
* Tumia methodi ya **`TRACE`** na ikiwa una bahati labda katika majibu unaweza pia kuona **vichwa vilivyoongezwa na wakalisha wa kati** ambavyo vinaweza kuwa na manufaa.

## Kufanya Majaribio ya Vichwa vya HTTP

* **Badilisha kichwa cha Mwenyeji** kwa thamani isiyojulikana ([ambayo ilifanya kazi hapa](https://medium.com/@sechunter/exploiting-admin-panel-like-a-boss-fc2dd2499d31))
* Jaribu [**kutumia Wageni wengine wa Mtumiaji**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/User-Agents/UserAgents.fuzz.txt) kufikia rasilimali.
*   **Fanya majaribio ya Vichwa vya HTTP**: Jaribu kutumia **Vichwa vya HTTP vya Proxi**, Uthibitishaji wa Msingi wa HTTP na NTLM nguvu ya kufanya kazi (na mchanganyiko wa kidogo tu) na njia nyingine. Kufanya haya yote nimeunda zana [**fuzzhttpbypass**](https://github.com/carlospolop/fuzzhttpbypass).

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `Host: localhost`

Ikiwa **njia imekingwa** unaweza jaribu kukiuka ulinzi wa njia kwa kutumia vichwa vifuatavyo:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`
* Ikiwa ukurasa uko **nyuma ya proxi**, labda ni proxi ndiyo inayokuzuia kupata taarifa za siri. Jaribu kutumia [**Udukuzi wa Ombi la HTTP**](../../pentesting-web/http-request-smuggling/) **au** [**vichwa vya hatua kwa hatua**](../../pentesting-web/abusing-hop-by-hop-headers.md)**.**
* Fanya majaribio ya [**vichwa maalum vya HTTP**](special-http-headers.md) ukitafuta majibu tofauti.
* **Fanya majaribio ya vichwa maalum vya HTTP** wakati wa kufanya majaribio ya **Methodi za HTTP**.
* **Ondoa kichwa cha Mwenyeji** na labda utaweza kukiuka ulinzi.

## Kufanya Majaribio ya Njia

Ikiwa _/njia_ imezuiliwa:

* Jaribu kutumia _**/**_**%2e/njia \_(ikiwa ufikiaji umefungwa na proxi, hii inaweza kukiuka ulinzi). Jaribu pia**\_\*\* /%252e\*\*/njia (URL encode mara mbili)
* Jaribu **kukiuka Unicode**: _/**%ef%bc%8f**njia_ (Vichwa vilivyofungwa vya URL ni kama "/") kwa hivyo wakati inarudishwa itakuwa _//njia_ na labda tayari umeshavuka ukaguzi wa jina la _/njia_
* **Kukiuka njia nyingine**:
* tovuti.com/siri ‚Äì> HTTP 403 Imezuiwa
* tovuti.com/SIRI ‚Äì> HTTP 200 Sawa
* tovuti.com/siri/ ‚Äì> HTTP 200 Sawa
* tovuti.com/siri/. ‚Äì> HTTP 200 Sawa
* tovuti.com//siri// ‚Äì> HTTP 200 Sawa
* tovuti.com/./siri/.. ‚Äì> HTTP 200 Sawa
* tovuti.com/;/siri ‚Äì> HTTP 200 Sawa
* tovuti.com/.;/siri ‚Äì> HTTP 200 Sawa
* tovuti.com//;//siri ‚Äì> HTTP 200 Sawa
* tovuti.com/siri.json ‚Äì> HTTP 200 Sawa (ruby)
* Tumia [**orodha hii yote**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Unicode.txt) katika hali zifuatazo:
* /FUZZsiri
* /FUZZ/siri
* /siriFUZZ
* **Kukiuka API nyingine:**
* /v3/watumiaji_data/1234 --> 403 Imezuiwa
* /v1/watumiaji_data/1234 --> 200 Sawa
* {‚Äúid‚Äù:111} --> 401 Haujaidhinishwa
* {‚Äúid‚Äù:\[111]} --> 200 Sawa
* {‚Äúid‚Äù:111} --> 401 Haujaidhinishwa
* {‚Äúid‚Äù:{‚Äúid‚Äù:111\}} --> 200 Sawa
* {"user_id":"\<legit_id>","user_id":"\<victims_id>"} (Uchafuzi wa Parameta ya JSON)
* user_id=ID_YA_SHAMBULIZI\&user_id=ID_YA_MWATHIRIWA (Uchafuzi wa Parameta)
## **Ubadilishaji wa Parameta**

* Badilisha **thamani ya parameta**: Kutoka **`id=123` --> `id=124`**
* Ongeza parameta zaidi kwenye URL: `?`**`id=124` ‚Äî-> `id=124&isAdmin=true`**
* Ondoa parameta
* Badilisha mpangilio wa parameta
* Tumia herufi maalum.
* Fanya majaribio ya mipaka kwenye parameta ‚Äî toa thamani kama vile _-234_ au _0_ au _99999999_ (mfano wa thamani).

## **Toleo la Itifaki**

Ikiwa unatumia HTTP/1.1 **jaribu kutumia 1.0** au hata jaribu kama ina **unga mkono 2.0**.

## **Bypassing Nyingine**

* Pata **IP** au **CNAME** ya kikoa na jaribu **kuwasiliana moja kwa moja**.
* Jaribu **kuhujumu seva** kwa kutuma maombi ya kawaida ya GET ([Ilifanya kazi kwa mtu huyu na Facebook](https://medium.com/@amineaboud/story-of-a-weird-vulnerability-i-found-on-facebook-fc0875eb5125)).
* **Badilisha itifaki**: kutoka http kwenda https, au kutoka https kwenda http
* Nenda kwenye [**https://archive.org/web/**](https://archive.org/web/) na angalia kama hapo awali faili hiyo ilikuwa **inapatikana ulimwenguni**.

## **Mashambulizi ya Nguvu**

* **Ghaili nywila**: Jaribu nywila za kawaida zifuatazo. Je, unajua kitu kuhusu muathiriwa? Au jina la changamoto ya CTF?
* [**Mashambulizi ya Nguvu**](../../generic-methodologies-and-resources/brute-force.md#http-brute)**:** Jaribu uthibitishaji wa msingi, wa digest na wa NTLM.

{% code title="Nywila za Kawaida" %}
```
admin    admin
admin    password
admin    1234
admin    admin1234
admin    123456
root     toor
test     test
guest    guest
```
{% endcode %}

## Zana za Kiotomatiki

* [https://github.com/lobuhi/byp4xx](https://github.com/lobuhi/byp4xx)
* [https://github.com/iamj0ker/bypass-403](https://github.com/iamj0ker/bypass-403)
* [https://github.com/gotr00t0day/forbiddenpass](https://github.com/gotr00t0day/forbiddenpass)
* [Burp Extension - 403 Bypasser](https://portswigger.net/bappstore/444407b96d9c4de0adb7aed89e826122)
* [Forbidden Buster](https://github.com/Sn1r/Forbidden-Buster)

<figure><img src="../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**Usanidi wa papo hapo wa upimaji wa udhaifu & uchunguzi wa kuingilia**. Tekeleza pentest kamili kutoka mahali popote na zana na vipengele zaidi ya 20 vinavyoanzia uchunguzi hadi ripoti. Hatuchukui nafasi ya wapimaji wa pentesting - tunatengeneza zana za desturi, moduli za ugunduzi & uchexploitation ili kuwarudishia muda wa kuchimba kwa kina, kuzindua shells, na kufurahi.

{% embed url="https://pentest-tools.com/" %}

<details>

<summary><strong>Jifunze AWS hacking kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kuhack kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
