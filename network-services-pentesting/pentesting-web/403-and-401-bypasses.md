# Kuvuka 403 & 401

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikionekana kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PR kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**Usanidi uliopo mara moja kwa tathmini ya udhaifu na upenyezaji wa mtihani**. Fanya pentest kamili kutoka mahali popote na zana na huduma 20+ ambazo zinaenda kutoka kwa uchunguzi hadi ripoti. Hatuchukui nafasi ya wapenyezaji - tunatengeneza zana za desturi, moduli za ugunduzi na uvamizi ili kuwapa muda wa kuchimba kwa kina, kuvunja kabati, na kufurahi.

{% embed url="https://pentest-tools.com/" %}

## Fuzzing ya Verbs/Methods ya HTTP

Jaribu kutumia **verbi tofauti** kufikia faili: `GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`

* Angalia vichwa vya majibu, labda habari fulani inaweza kutolewa. Kwa mfano, majibu ya **200** kwa **HEAD** na `Content-Length: 55` inamaanisha kuwa **verb ya HEAD inaweza kupata habari hiyo**. Lakini bado unahitaji kupata njia ya kuihamisha habari hiyo.
* Kutumia kichwa cha HTTP kama `X-HTTP-Method-Override: PUT` inaweza kubadilisha verb iliyotumiwa.
* Tumia verb ya **`TRACE`** na ikiwa una bahati sana labda kwenye majibu unaweza kuona pia **vichwa vilivyotolewa na wakala wa kati** ambavyo vinaweza kuwa na manufaa.

## Fuzzing ya Vichwa vya HTTP

* **Badilisha kichwa cha Mwenyeji** na thamani isiyojulikana ([ambayo ilifanya kazi hapa](https://medium.com/@sechunter/exploiting-admin-panel-like-a-boss-fc2dd2499d31))
* Jaribu [**kutumia Wateja Wengine**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/User-Agents/UserAgents.fuzz.txt) kufikia rasilimali.
*   **Fuzz Vichwa vya HTTP**: Jaribu kutumia **Vichwa vya HTTP vya Proksi**, Uthibitishaji wa HTTP wa Msingi na NTLM nguvu ya kubadilisha (na mchanganyiko mdogo tu) na mbinu zingine. Kufanya haya yote nimeunda zana [**fuzzhttpbypass**](https://github.com/carlospolop/fuzzhttpbypass).

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `Host: localhost`

Ikiwa **njia imekingwa**, unaweza jaribu kuvuka ulinzi wa njia kwa kutumia vichwa vingine hivi:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`
* Ikiwa ukurasa uko **nyuma ya wakala**, labda ni wakala ndiye anayekuzuia kufikia habari ya kibinafsi. Jaribu kutumia [**HTTP Request Smuggling**](../../pentesting-web/http-request-smuggling/) **au** [**vichwa vya hop-by-hop**](../../pentesting-web/abusing-hop-by-hop-headers.md)**.**
* Fuzz [**vichwa vya HTTP maalum**](special-http-headers.md) ukitafuta majibu tofauti.
* **Fuzz vichwa vya HTTP maalum** wakati wa kufanya fuzzing ya **Verbs za HTTP**.
* **Ondoa kichwa cha Mwenyeji** na labda utaweza kuvuka ulinzi.

## Fuzzing ya Njia

Ikiwa _/njia_ imezuiliwa:

* Jaribu kutumia _**/**_**%2e/njia** \_(ikiwa ufikiaji umefungwa na wakala, hii inaweza kuvuka ulinzi). Jaribu pia**\_\*\* /%252e\*\*/njia (URL encode mara mbili)
* Jaribu **kuvuka Unicode**: _/**%ef%bc%8f**njia_ (Herufi zilizo na URL zimekodishwa kama "/") kwa hivyo wakati zinakodishwa tena itakuwa _//njia_ na labda tayari umeshavuka ukaguzi wa jina la _/njia_
* **Kuvuka njia nyingine**:
* site.com/siri ‚Äì> HTTP 403 Imezuiwa
* site.com/SIRI ‚Äì> HTTP 200 Sawa
* site.com/siri/ ‚Äì> HTTP 200 Sawa
* site.com/siri/. ‚Äì> HTTP 200 Sawa
* site.com//siri// ‚Äì> HTTP 200 Sawa
* site.com/./siri/.. ‚Äì> HTTP 200 Sawa
* site.com/;/siri ‚Äì> HTTP 200 Sawa
* site.com/.;/siri ‚Äì> HTTP 200 Sawa
* site.com//;//siri ‚Äì> HTTP 200 Sawa
* site.com/siri.json ‚Äì> HTTP 200 Sawa (ruby)
* Tumia [**orodha hii yote**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Unicode.txt) katika hali zifuatazo:
* /FUZZsiri
* /FUZZ/siri
* /siriFUZZ
* **Kuvuka API nyingine:**
* /v3/users\_data/1234 --> 403 Imezuiwa
* /v1/users\_data/1234 --> 200 Sawa
* {‚Äúid‚Äù:111} --> 401 Haujaidhinishwa
* {‚Äúid‚Äù:\[111]} --> 200 Sawa
* {‚Äúid‚Äù:111} --> 401 Haujaidhinishwa
* {‚Äúid‚Äù:{‚Äúid‚Äù:111\}} --> 200 Sawa
* {"user\_id":"\<legit\_id>","user\_id":"\<victims\_id>"} (Uchafuzi wa Parameta ya JSON)
* user\_id=ATTACKER\_ID\&user\_id=VICTIM\_ID (Uchafuzi wa Parameta)
## **Ubadilishaji wa Parameta**

* Badilisha **parameta ya thamani**: Kutoka **`id=123` --> `id=124`**
* Ongeza parameta nyingine kwenye URL: `?`**`id=124` ‚Äî-> `id=124&isAdmin=true`**
* Ondoa parameta
* Panga upya parameta
* Tumia herufi maalum.
* Fanya jaribio la mipaka kwenye parameta - toa thamani kama _-234_ au _0_ au _99999999_ (thamani za mfano tu).

## **Toleo la Itifaki**

Ikiwa unatumia HTTP/1.1 **jaribu kutumia 1.0** au hata jaribu kama ina **unga mkono 2.0**.

## **Bypassing Nyingine**

* Pata **IP** au **CNAME** ya kikoa na jaribu **kuwasiliana moja kwa moja**.
* Jaribu **kuishinikiza seva** kwa kutuma maombi ya kawaida ya GET ([Ilifanya kazi kwa mtu huyu na Facebook](https://medium.com/@amineaboud/story-of-a-weird-vulnerability-i-found-on-facebook-fc0875eb5125)).
* **Badilisha itifaki**: kutoka http kwenda https, au kutoka https kwenda http
* Nenda kwenye [**https://archive.org/web/**](https://archive.org/web/) na angalia ikiwa hapo awali faili hiyo ilikuwa **inapatikana kwa ulimwengu**.

## **Brute Force**

* **Ghushi nywila**: Jaribu nywila za kawaida zifuatazo. Je, unajua kitu kuhusu mwathiriwa? Au jina la changamoto ya CTF?
* [**Brute force**](../../generic-methodologies-and-resources/brute-force.md#http-brute)**:** Jaribu uwakilishi wa msingi, digest na NTLM.

{% code title="Nywila za Kawaida" %}
```
admin    admin
admin    password
admin    1234
admin    admin1234
admin    123456
root     toor
test     test
guest    guest
```
{% endcode %}

## Zana za Kiotomatiki

* [https://github.com/lobuhi/byp4xx](https://github.com/lobuhi/byp4xx)
* [https://github.com/iamj0ker/bypass-403](https://github.com/iamj0ker/bypass-403)
* [https://github.com/gotr00t0day/forbiddenpass](https://github.com/gotr00t0day/forbiddenpass)
* [Burp Extension - 403 Bypasser](https://portswigger.net/bappstore/444407b96d9c4de0adb7aed89e826122)
* [Forbidden Buster](https://github.com/Sn1r/Forbidden-Buster)

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**Usanidi uliopo mara moja kwa tathmini ya udhaifu na upimaji wa uingiliaji**. Tekeleza upimaji kamili kutoka mahali popote na zana na huduma 20+ ambazo zinaanzia uchunguzi hadi ripoti. Hatuchukui nafasi ya wapenyezaji - tunatengeneza zana za desturi, moduli za ugunduzi na uvamizi ili kuwapa muda wa kuchimba kwa kina, kuvunja mfumo, na kufurahi.

{% embed url="https://pentest-tools.com/" %}

<details>

<summary><strong>Jifunze kuhusu udukuzi wa AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa kwenye HackTricks** au **kupakua HackTricks kwa muundo wa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi wa PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) za kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za udukuzi kwa kuwasilisha PR kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) **na** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github repos.**

</details>
