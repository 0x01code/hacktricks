# Bypass 403 e 401

<details>

<summary><strong>Impara l'hacking AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Esperto Red Team AWS di HackTricks)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**La Famiglia PEASS**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**Configurazione immediatamente disponibile per valutazione delle vulnerabilit√† e test di penetrazione**. Esegui un pentest completo da qualsiasi luogo con oltre 20 strumenti e funzionalit√† che vanno dalla ricognizione alla segnalazione. Non sostituiamo i pentester - sviluppiamo strumenti personalizzati, moduli di rilevamento ed exploit per dare loro pi√π tempo per approfondire, aprire shell e divertirsi.

{% embed url="https://pentest-tools.com/" %}

## Fuzzing dei Verbi/ Metodi HTTP

Prova a utilizzare **verbi diversi** per accedere al file: `GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`

* Controlla gli header di risposta, forse possono essere fornite alcune informazioni. Ad esempio, una risposta **200** a **HEAD** con `Content-Length: 55` significa che il **verbo HEAD pu√≤ accedere alle informazioni**. Ma √® comunque necessario trovare un modo per esfiltrare tali informazioni.
* Utilizzare un header HTTP come `X-HTTP-Method-Override: PUT` pu√≤ sovrascrivere il verbo utilizzato.
* Utilizza il verbo **`TRACE`** e se sei molto fortunato forse nella risposta puoi vedere anche gli **header aggiunti dai proxy intermedi** che potrebbero essere utili.

## Fuzzing degli Header HTTP

* **Cambia l'header Host** con un valore arbitrario ([che ha funzionato qui](https://medium.com/@sechunter/exploiting-admin-panel-like-a-boss-fc2dd2499d31))
* Prova a [**usare altri User Agents**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/User-Agents/UserAgents.fuzz.txt) per accedere alla risorsa.
*   **Fuzz degli Header HTTP**: Prova ad utilizzare **Headers** di Proxy HTTP, Autenticazione HTTP di Base e forza bruta NTLM (con poche combinazioni) e altre tecniche. Per fare tutto ci√≤ ho creato lo strumento [**fuzzhttpbypass**](https://github.com/carlospolop/fuzzhttpbypass).

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `Host: localhost`

Se il **percorso √® protetto** puoi provare a bypassare la protezione del percorso utilizzando questi altri header:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`
* Se la pagina √® **dietro un proxy**, forse √® il proxy quello che ti impedisce di accedere alle informazioni private. Prova ad abusare di [**Smuggling delle Richieste HTTP**](../../pentesting-web/http-request-smuggling/) **o** [**header hop-by-hop**](../../pentesting-web/abusing-hop-by-hop-headers.md)**.**
* Fuzz di [**header HTTP speciali**](special-http-headers.md) cercando una risposta diversa.
* **Fuzz di header HTTP speciali** mentre fuzzi **Metodi HTTP**.
* **Rimuovi l'header Host** e forse sarai in grado di bypassare la protezione.

## Fuzzing del Percorso

Se _/percorso_ √® bloccato:

* Prova a utilizzare _**/**_**%2e/percorso \_(se l'accesso √® bloccato da un proxy, questo potrebbe bypassare la protezione). Prova anche**\_\*\* /%252e\*\*/percorso (doppio URL encoding)
* Prova il **bypass Unicode**: _/**%ef%bc%8f**percorso_ (I caratteri codificati URL sono come "/") quindi quando decodificati torneranno a essere _//percorso_ e forse avrai gi√† bypassato il controllo del nome _/percorso_
* **Altri bypass del percorso**:
* sito.com/segreto ‚Äì> HTTP 403 Forbidden
* sito.com/SEGRETO ‚Äì> HTTP 200 OK
* sito.com/segreto/ ‚Äì> HTTP 200 OK
* sito.com/segreto/. ‚Äì> HTTP 200 OK
* sito.com//segreto// ‚Äì> HTTP 200 OK
* sito.com/./segreto/.. ‚Äì> HTTP 200 OK
* sito.com/;/segreto ‚Äì> HTTP 200 OK
* sito.com/.;/segreto ‚Äì> HTTP 200 OK
* sito.com//;//segreto ‚Äì> HTTP 200 OK
* sito.com/segreto.json ‚Äì> HTTP 200 OK (ruby)
* Utilizza tutta [**questa lista**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Unicode.txt) nelle seguenti situazioni:
* /FUZZsegreto
* /FUZZ/segreto
* /segretoFUZZ
* **Altri bypass API:**
* /v3/dati_utenti/1234 --> 403 Forbidden
* /v1/dati_utenti/1234 --> 200 OK
* {‚Äúid‚Äù:111} --> 401 Non autorizzato
* {‚Äúid‚Äù:\[111]} --> 200 OK
* {‚Äúid‚Äù:111} --> 401 Non autorizzato
* {‚Äúid‚Äù:{‚Äúid‚Äù:111\}} --> 200 OK
* {"user\_id":"\<legit\_id>","user\_id":"\<victims\_id>"} (Inquinamento Parametri JSON)
* user\_id=ID_ATTACCANTE\&user\_id=ID_VITTIMA (Inquinamento Parametri)
## **Manipolazione dei parametri**

* Cambiare il **valore del parametro**: Da **`id=123` --> `id=124`**
* Aggiungere parametri aggiuntivi all'URL: `?`**`id=124` ‚Äî-> `id=124&isAdmin=true`**
* Rimuovere i parametri
* Riordinare i parametri
* Utilizzare caratteri speciali.
* Eseguire test di boundary testing nei parametri - fornire valori come _-234_ o _0_ o _99999999_ (solo alcuni valori di esempio).

## **Versione del protocollo**

Se si utilizza HTTP/1.1 **provare a utilizzare 1.0** o testare se **supporta 2.0**.

## **Altri bypass**

* Ottenere l'**IP** o il **CNAME** del dominio e provare a **contattarlo direttamente**.
* Provare a **stressare il server** inviando comuni richieste GET ([Ha funzionato per questo ragazzo con Facebook](https://medium.com/@amineaboud/story-of-a-weird-vulnerability-i-found-on-facebook-fc0875eb5125)).
* **Cambiare il protocollo**: da http a https, o da https a http
* Andare su [**https://archive.org/web/**](https://archive.org/web/) e verificare se in passato quel file era **accessibile in tutto il mondo**.

## **Forza bruta**

* **Indovinare la password**: Testare le seguenti credenziali comuni. Sai qualcosa sulla vittima? O sul nome della sfida CTF?
* [**Forza bruta**](../../generic-methodologies-and-resources/brute-force.md#http-brute)**:** Provare autenticazioni di base, digest e NTLM.

{% code title="Credenziali comuni" %}
```
admin    admin
admin    password
admin    1234
admin    admin1234
admin    123456
root     toor
test     test
guest    guest
```
{% endcode %}

## Strumenti Automatici

* [https://github.com/lobuhi/byp4xx](https://github.com/lobuhi/byp4xx)
* [https://github.com/iamj0ker/bypass-403](https://github.com/iamj0ker/bypass-403)
* [https://github.com/gotr00t0day/forbiddenpass](https://github.com/gotr00t0day/forbiddenpass)
* [Estensione Burp - 403 Bypasser](https://portswigger.net/bappstore/444407b96d9c4de0adb7aed89e826122)
* [Forbidden Buster](https://github.com/Sn1r/Forbidden-Buster)
* [NoMoreForbidden](https://github.com/akinerk/NoMoreForbidden)

<figure><img src="../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**Configurazione immediatamente disponibile per valutazione delle vulnerabilit√† e test di penetrazione**. Esegui un pentest completo da qualsiasi luogo con oltre 20 strumenti e funzionalit√† che vanno dalla ricognizione alla generazione di report. Non sostituiamo i pentester - sviluppiamo strumenti personalizzati, moduli di rilevamento ed exploit per permettere loro di dedicarsi a approfondire, ottenere shell e divertirsi.

{% embed url="https://pentest-tools.com/" %}

<details>

<summary><strong>Impara l'hacking su AWS da zero a esperto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se desideri vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
