# 403 & 401 バイパス

<details>

<summary><strong>htARTE（HackTricks AWS Red Team Expert）</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>でAWSハッキングをゼロからヒーローまで学ぶ</strong></a><strong>！</strong></summary>

HackTricks をサポートする他の方法:

* **HackTricks で企業を宣伝**したいか、**HackTricks をPDFでダウンロード**したい場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) をチェックしてください！
* [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見つける
* **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)** に参加するか、[telegramグループ](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live) をフォローする。
* **ハッキングトリックを共有するために、PRを** [**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) のGitHubリポジトリに提出してください。

</details>

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**脆弱性評価とペネトレーションテストのための即座に利用可能なセットアップ**。レコンからレポート作成まで、20以上のツールと機能を使用してどこからでも完全なペンテストを実行します。私たちはペンテスターを置き換えるのではなく、彼らに時間を戻してさらに深く掘り下げたり、シェルをポップしたり、楽しんだりするためのカスタムツール、検出、およびエクスプロイトモジュールを開発しています。

{% embed url="https://pentest-tools.com/" %}

## HTTP動詞/メソッドファジング

ファイルにアクセスするために**異なる動詞**を使用してみてください：`GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`

* 応答ヘッダーを確認して、情報が提供される可能性があります。たとえば、`Content-Length: 55` で **HEAD** に対する **200応答** は、**HEAD動詞で情報にアクセスできる**ことを意味します。ただし、その情報を外部に持ち出す方法を見つける必要があります。
* `X-HTTP-Method-Override: PUT` のようなHTTPヘッダーを使用すると、使用される動詞を上書きできます。
* **`TRACE`** 動詞を使用し、非常に幸運な場合は、応答に **中間プロキシによって追加されたヘッダー** も表示されるかもしれません。それらは役立つかもしれません。

## HTTPヘッダーファジング

* **Hostヘッダーを**任意の値に変更してみてください（[ここで機能した](https://medium.com/@sechunter/exploiting-admin-panel-like-a-boss-fc2dd2499d31)）
* リソースにアクセスするために [**他のユーザーエージェントを使用**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/User-Agents/UserAgents.fuzz.txt) してみてください。
* **HTTPヘッダーをファジング**：HTTPプロキシ **ヘッダー**、HTTP認証の基本的なNTLMブルートフォース（いくつかの組み合わせのみ）およびその他のテクニックを試してみてください。これらすべてを行うために、私はツール [**fuzzhttpbypass**](https://github.com/carlospolop/fuzzhttpbypass) を作成しました。

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `Host: localhost`

**パスが保護されている**場合は、次のヘッダーを使用してパス保護をバイパスできます：

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`
* ページが**プロキシの背後にある**場合、おそらくプライベート情報にアクセスを妨げているのはプロキシです。[**HTTPリクエストスマグリング**](../../pentesting-web/http-request-smuggling/) **または** [**hop-by-hopヘッダー**](../../pentesting-web/abusing-hop-by-hop-headers.md) を悪用してみてください。
* 異なる応答を探すために [**特別なHTTPヘッダー**](special-http-headers.md) をファジングしてください。
* **HTTPメソッド**をファジングしながら **特別なHTTPヘッダー** をファジングしてください。
* **Hostヘッダーを削除**して、保護をバイパスできるかもしれません。

## パス **ファジング**

_**/path**_ がブロックされている場合：

* _**/**_**%2e/path \_**を使用してみてください（アクセスがプロキシによってブロックされている場合、これにより保護がバイパスされる可能性があります）。**\_\*\* /%252e\*\*/path (ダブルURLエンコード) も試してみてください**
* **Unicodeバイパス**を試してみてください：_/**%ef%bc%8f**path_（URLエンコードされた文字は "/ "のようなものです）のため、エンコードを戻すと _//path_ になり、すでに _/path_ 名のチェックをバイパスしているかもしれません
* **その他のパスバイパス**:
* site.com/secret –> HTTP 403 Forbidden
* site.com/SECRET –> HTTP 200 OK
* site.com/secret/ –> HTTP 200 OK
* site.com/secret/. –> HTTP 200 OK
* site.com//secret// –> HTTP 200 OK
* site.com/./secret/.. –> HTTP 200 OK
* site.com/;/secret –> HTTP 200 OK
* site.com/.;/secret –> HTTP 200 OK
* site.com//;//secret –> HTTP 200 OK
* site.com/secret.json –> HTTP 200 OK (ruby)
* 以下の状況で [**このリスト**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Unicode.txt) を使用してください：
* /FUZZsecret
* /FUZZ/secret
* /secretFUZZ
* **その他のAPIバイパス**:
* /v3/users\_data/1234 --> 403 Forbidden
* /v1/users\_data/1234 --> 200 OK
* {“id”:111} --> 401 Unauthriozied
* {“id”:\[111]} --> 200 OK
* {“id”:111} --> 401 Unauthriozied
* {“id”:{“id”:111\}} --> 200 OK
* {"user\_id":"\<legit\_id>","user\_id":"\<victims\_id>"} (JSON Parameter Pollution)
* user\_id=ATTACKER\_ID\&user\_id=VICTIM\_ID (Parameter Pollution)

## **パラメータ操作**

* **パラメータ値を変更**：**`id=123` --> `id=124`**
* URLに追加のパラメータを追加：`?`**`id=124` —-> `id=124&isAdmin=true`**
* パラメータを削除
* パラメータを再配置
* 特殊文字を使用します。
* パラメータで境界テストを実行します — _-234_ や _0_ または _99999999_ のような値を提供します（単なる例の値）。

## **プロトコルバージョン**

HTTP/1.1 を使用している場合は、1.0 を使用してみたり、2.0 をサポートしているかどうかをテストしてみてください。

## **その他のバイパス**

* ドメインの**IP**または**CNAME**を取得し、**直接連絡**を試みてください。
* 一般的なGETリクエストを送信してサーバーを**ストレス**させてみてください（[この人にはFacebookで機能しました](https://medium.com/@amineaboud/story-of-a-weird-vulnerability-i-found-on-facebook-fc0875eb5125)）。
* **プロトコルを変更**：http から https に、または https から http に変更します
* [**https://archive.org/web/**](https://archive.org/web/) に移動し、過去にそのファイルが **世界中でアクセス可能** だったかどうかを確認してください。

## **ブルートフォース**

* **パスワードを推測**：以下の一般的な資格情報をテストしてみてください。被害者について何か知っていますか？またはCTFチャレンジの名前は？
* [**ブルートフォース**](../../generic-methodologies-and-resources/brute-force.md#http-brute)**:** 基本的な、ダイジェスト、NTLM認証を試してみてください。

{% code title="Common creds" %}
```
admin    admin
admin    password
admin    1234
admin    admin1234
admin    123456
root     toor
test     test
guest    guest
```
{% endcode %}

## 自動ツール

* [https://github.com/lobuhi/byp4xx](https://github.com/lobuhi/byp4xx)
* [https://github.com/iamj0ker/bypass-403](https://github.com/iamj0ker/bypass-403)
* [https://github.com/gotr00t0day/forbiddenpass](https://github.com/gotr00t0day/forbiddenpass)
* [Burp Extension - 403 Bypasser](https://portswigger.net/bappstore/444407b96d9c4de0adb7aed89e826122)
* [Forbidden Buster](https://github.com/Sn1r/Forbidden-Buster)

<figure><img src="/.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

**脆弱性評価およびペネトレーションテストのための即座に利用可能なセットアップ**。20以上のツールと機能を備えた完全なペネトレーションテストをどこからでも実行します。私たちはペンテスターを置き換えるのではなく、彼らに時間を戻してより深く掘り下げたり、シェルをポップしたり、楽しんだりするためのカスタムツール、検出、およびエクスプロイトモジュールを開発しています。

{% embed url="https://pentest-tools.com/" %}

<details>

<summary><strong>ゼロからヒーローまでのAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスウォッグ**](https://peass.creator-spring.com)を手に入れる
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)コレクションを見つける
* **💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)で**フォロー**してください。
* **HackTricks**および**HackTricks Cloud**のGitHubリポジトリにPRを提出して、あなたのハッキングトリックを共有してください。

</details>
