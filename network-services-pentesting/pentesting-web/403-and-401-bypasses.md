# 403 & 401 バイパス

<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい**、または**HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見する、私たちの独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクション
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に**参加する**か、[**テレグラムグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォロー**してください。
* **HackTricks**と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングのコツを共有してください。

</details>

<figure><img src="../../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conferenceは、国際的なサイバーセキュリティイベントです**](https://www.dragonjarcon.org/)。これは2023年9月7日と8日にコロンビアのボゴタで開催される10年以上の歴史を持つイベントです。技術的な内容が豊富なこのイベントでは、最新の研究がスペイン語で発表され、世界中のハッカーや研究者を引き付けます。
以下のリンクで今すぐ登録し、この素晴らしいカンファレンスをお見逃しなく！:

{% embed url="https://www.dragonjarcon.org/" %}

## HTTP動詞/メソッドのファジング

ファイルにアクセスするために**異なる動詞**を試してみてください: `GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`

* レスポンスヘッダーをチェックして、情報が提供されているかもしれません。例えば、`Content-Length: 55`を持つ**HEAD**への**200レスポンス**は、**HEAD動詞が情報にアクセスできる**ことを意味します。しかし、その情報を抽出する方法を見つける必要があります。
* `X-HTTP-Method-Override: PUT`のようなHTTPヘッダーを使用して、使用される動詞を上書きすることができます。
* **`TRACE`**動詞を使用し、非常に運が良ければ、中間プロキシによって追加された**ヘッダーもレスポンスで見ることができる**かもしれません。これは有用かもしれません。

## HTTPヘッダーのファジング

* **Hostヘッダーを変更**して任意の値にします（[ここで機能しました](https://medium.com/@sechunter/exploiting-admin-panel-like-a-boss-fc2dd2499d31)）
* リソースにアクセスするために[**他のユーザーエージェントを使用する**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/User-Agents/UserAgents.fuzz.txt)ことを試みてください。
*   **HTTPヘッダーをファジングする**: HTTPプロキシ**ヘッダー**、HTTP認証BasicとNTLMのブルートフォース（少数の組み合わせのみ）などの技術を使用してみてください。これをすべて行うために、私は[**fuzzhttpbypass**](https://github.com/carlospolop/fuzzhttpbypass)というツールを作成しました。

* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `Host: localhost`

**パスが保護されている**場合は、これらの他のヘッダーを使用してパス保護をバイパスしようとすることができます:

* `X-Original-URL: /admin/console`
* `X-Rewrite-URL: /admin/console`
* ページが**プロキシの後ろにある**場合、プライベート情報にアクセスするのを防いでいるのはプロキシかもしれません。[**HTTPリクエストスマグリング**](../../pentesting-web/http-request-smuggling/) **または** [**ホップバイホップヘッダー**](../../pentesting-web/abusing-hop-by-hop-headers.md)**を悪用してみてください。**
* [**特別なHTTPヘッダー**](special-http-headers.md)をファジングして、異なるレスポンスを探します。
* **特別なHTTPヘッダーをファジングする**と同時に**HTTPメソッドをファジングする**。
* **Hostヘッダーを削除する**と、保護をバイパスできるかもしれません。

## パスの**ファジング**

_/path_ がブロックされている場合:

* _**/**_**%2e/path** を使用してみてください（アクセスがプロキシによってブロックされている場合、これで保護をバイパスできるかもしれません）。また、**/%252e**/path（ダブルURLエンコード）も試してみてください。
* **Unicodeバイパスを試す**: _/**%ef%bc%8f**path_ (URLエンコードされた文字は"/"のようです)なので、デコードされると _//path_ になり、_/path_ の名前チェックをすでにバイパスしているかもしれません。
* **他のパスバイパス**:
* site.com/secret –> HTTP 403 Forbidden
* site.com/SECRET –> HTTP 200 OK
* site.com/secret/ –> HTTP 200 OK
* site.com/secret/. –> HTTP 200 OK
* site.com//secret// –> HTTP 200 OK
* site.com/./secret/.. –> HTTP 200 OK
* site.com/;/secret –> HTTP 200 OK
* site.com/.;/secret –> HTTP 200 OK
* site.com//;//secret –> HTTP 200 OK
* site.com/secret.json –> HTTP 200 OK (ruby)
* 以下の状況で[**このリスト全体**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Unicode.txt)を使用してください:
* /FUZZsecret
* /FUZZ/secret
* /secretFUZZ
* **他のAPIバイパス:**
* /v3/users\_data/1234 --> 403 Forbidden
* /v1/users\_data/1234 --> 200 OK
* {“id”:111} --> 401 Unauthorized
* {“id”:\[111]} --> 200 OK
* {“id”:111} --> 401 Unauthorized
* {“id”:{“id”:111\}} --> 200 OK
* {"user\_id":"\<legit\_id>","user\_id":"\<victims\_id>"} (JSONパラメータ汚染)
* user\_id=ATTACKER\_ID\&user\_id=VICTIM\_ID (パラメータ汚染)

## **パラメータ操作**

* **パラメータ値を変更**: **`id=123` --> `id=124`** に
* URLに追加のパラメータを追加する: `?`**`id=124` —-> `id=124&isAdmin=true`**
* パラメータを削除する
* パラメータの順序を変更する
* 特殊文字を使用する。
* パラメータで境界テストを実行する — _-234_ や _0_ や _99999999_ などの値を提供する（例としての値）。

## **プロトコルバージョン**

HTTP/1.1を使用している場合は、**1.0を試す**か、**2.0をサポートしているかどうかをテスト**してみてください。

## **その他のバイパス**

* ドメインの**IP**または**CNAME**を取得し、**直接連絡**を試みてください。
* 一般的なGETリクエストを送信して**サーバーにストレスをかける**ことを試みてください（[この人にFacebookで機能しました](https://medium.com/@amineaboud/story-of-a-weird-vulnerability-i-found-on-facebook-fc0875eb5125)）。
* **プロトコルを変更する**: httpからhttpsへ、またはhttpsからhttpへ
* [**https://archive.org/web/**](https://archive.org/web/)にアクセスし、過去にそのファイルが**世界中でアクセス可能だったかどうか**を確認してください。

## **ブルートフォース**

* **パスワードを推測する**: 以下の一般的な資格情報をテストしてください。被害者について何か知っていますか？またはCTFチャレンジの名前は？
* [**ブルートフォース**](../../generic-methodologies-and-resources/brute-force.md#http-brute)**:** 基本、ダイジェスト、NTLM認証を試してみてください。

{% code title="Common creds" %}
```
admin    admin
admin    password
admin    1234
admin    admin1234
admin    123456
root     toor
test     test
guest    guest
```
## 自動ツール

* [https://github.com/lobuhi/byp4xx](https://github.com/lobuhi/byp4xx)
* [https://github.com/iamj0ker/bypass-403](https://github.com/iamj0ker/bypass-403)
* [https://github.com/gotr00t0day/forbiddenpass](https://github.com/gotr00t0day/forbiddenpass)
* [Burp 拡張機能 - 403 Bypasser](https://portswigger.net/bappstore/444407b96d9c4de0adb7aed89e826122)
* [Forbidden Buster](https://github.com/Sn1r/Forbidden-Buster)

<figure><img src="../../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conference は国際的なサイバーセキュリティイベントです**](https://www.dragonjarcon.org/)。10年以上の歴史を持ち、2023年9月7日と8日にコロンビアのボゴタで開催されます。技術的な内容が豊富で、最新の研究がスペイン語で発表され、世界中のハッカーや研究者を引き付けます。\
以下のリンクから今すぐ登録し、この素晴らしいカンファレンスをお見逃しなく！:

{% embed url="https://www.dragonjarcon.org/" %}

<details>

<summary><strong>AWS ハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>をチェック！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい**、または **HackTricksをPDFでダウンロードしたい**場合は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式のPEASS & HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう。
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをチェックしてください。
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や [**テレグラムグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォロー**してください。
* **ハッキングのコツを共有するために、** [**HackTricks**](https://github.com/carlospolop/hacktricks) と [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) のgithubリポジトリにPRを提出してください。

</details>
