# Outils d'analyse de code

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) **groupe Discord** ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

## G√©n√©ral

* [**https://owasp.org/www-community/Source\_Code\_Analysis\_Tools**](https://owasp.org/www-community/Source\_Code\_Analysis\_Tools)\
  
* [**https://github.com/analysis-tools-dev/static-analysis**](https://github.com/analysis-tools-dev/static-analysis)
```bash
https://www.sonarqube.org/downloads/
https://deepsource.io/signup/
https://github.com/pyupio/safety
https://github.com/returntocorp/semgrep
https://github.com/WhaleShark-Team/cobra
https://github.com/insidersec/insider

# Find interesting strings
https://github.com/s0md3v/hardcodes
https://github.com/micha3lb3n/SourceWolf
https://libraries.io/pypi/detect-secrets
```
## JavaScript
### D√©couverte
1. Burp:
   - Spider et d√©couvrir le contenu
   - Sitemap > filtre
   - Sitemap > clic droit sur le domaine > Outils d'engagement > Trouver des scripts
2. [WaybackURLs](https://github.com/tomnomnom/waybackurls):
   - `waybackurls <domain> |grep -i "\.js" |sort -u`
### Analyse statique
#### D√©minifier/embellir
https://prettier.io/playground/
https://beautifier.io/
#### D√©obfusquer/D√©compresser
__Note__: Il peut ne pas √™tre possible de d√©obfusquer compl√®tement.
1. Trouver et utiliser les fichiers .map:
   - Si les fichiers .map sont expos√©s, ils peuvent √™tre utilis√©s pour d√©obfusquer facilement.
   - Couramment, foo.js.map est mapp√© √† foo.js. Recherchez-les manuellement.
   - Utilisez [JS Miner](https://github.com/PortSwigger/js-miner) pour les rechercher.
    - Assurez-vous qu'une analyse active est effectu√©e.
    - Lire '[Conseils/Notes](https://github.com/minamo7sen/burp-JS-Miner/wiki#tips--notes)'
   - Si vous les trouvez, utilisez [Maximize](https://www.npmjs.com/package/maximize) pour d√©obfusquer.
2. Sans fichiers .map, essayez JSnice:
   - R√©f√©rences: http://jsnice.org/ & https://www.npmjs.com/package/jsnice
   - Conseils:
     - Si vous utilisez jsnice.org, cliquez sur le bouton d'options √† c√¥t√© du bouton "Nicify JavaScript" et d√©s√©lectionnez "Infer types" pour r√©duire l'encombrement du code avec des commentaires.
     - Assurez-vous de ne laisser aucune ligne vide avant le script, car cela peut affecter le processus de d√©obfuscation et donner des r√©sultats inexacts.
3. Utilisez console.log(<packerReturnVariable>);
   - Trouvez la valeur de retour √† la fin et changez-la en `console.log(<packerReturnVariable>);` pour que le js d√©obfusqu√© soit imprim√© au lieu d'√™tre ex√©cut√©.
   - Ensuite, collez le js modifi√© (et toujours obfusqu√©) dans https://jsconsole.com/ pour voir le js d√©obfusqu√© enregistr√© dans la console.
   - Enfin, collez la sortie d√©obfusqu√©e dans https://prettier.io/playground/ pour l'embellir pour l'analyse.
   - __Note__: Si vous voyez toujours du js empaquet√© (mais diff√©rent), il peut √™tre empaquet√© de mani√®re r√©cursive. R√©p√©tez le processus.
#### Analyser
R√©f√©rences:
https://medium.com/techiepedia/javascript-code-review-guide-for-bug-bounty-hunters-c95a8aa7037a

 Recherchez:
- Chargement anti-d√©bogage
  - Angular: [enableProdMode](https://blog.nvisium.com/angular-for-pentesters-part-2)
- Secrets
  - Utilisez:
    - [JS Miner](https://github.com/PortSwigger/js-miner)
    - [RegHex](https://github.com/l4yton/RegHex) patterns
    - [gf](https://github.com/tomnomnom/gf/tree/master/examples) patterns
    - Recherchez des motifs de dictionnaire pertinents:
      - pass, user, admin
      - auth, login, sign, challenge, 2fa
      - key, apikey, api_key, api-key, jwt, token
      - secret, security, secure
      - ...
    - Examen manuel
  - Si une cl√© API est trouv√©e, v√©rifiez ici la syntaxe d'utilisation potentielle: https://github.com/streaak/keyhacks.
- Fonctions vuln√©rables
  - InnerHTML() - Si vous avez trouv√© cela, cela signifie qu'il y a une chance potentielle de XSS si aucune d√©sinfection appropri√©e n'a lieu. M√™me si votre charge utile est d√©sinfect√©e, ne vous inqui√©tez pas. Tracez le code pour savoir o√π se trouve la d√©sinfection. √âtudiez-le et essayez de contourner la d√©sinfection.
  - Postmessage() - Si vous avez lu mon pr√©c√©dent article (https://medium.com/techiepedia/what-are-sop-cors-and-ways-to-exploit-it-62a5e02100dc), vous remarquerez que Postmessage() pourrait entra√Æner un probl√®me potentiel de CORS. Si le deuxi√®me param√®tre de la fonction est d√©fini sur *, vous √™tes chanceux. Consultez mon article pr√©c√©dent pour comprendre davantage le m√©canisme derri√®re.
  - String.prototype.search() - Cette fonction semble normale. Pourquoi serait-ce une fonction dangereuse? Eh bien, c'est parce que certains d√©veloppeurs l'ont utilis√©e pour trouver l'occurrence d'une cha√Æne √† l'int√©rieur d'une autre cha√Æne. Cependant, "." est trait√© comme un caract√®re g√©n√©rique dans cette fonction. Donc, si cette fonction est utilis√©e comme v√©rification de d√©sinfection, vous pouvez simplement la contourner en entrant ".". Consultez le rapport hackerone de Filedescryptor: https://hackerone.com/reports/129873
- Endpoints et param√®tres
  - Utilisez [LinkFinder](https://github.com/GerbenJavado/LinkFinder) & [JS Miner](https://github.com/PortSwigger/js-miner).
- Biblioth√®ques et d√©pendances vuln√©rables
  - Utilisez [Retire.js](https://retirejs.github.io/retire.js/) et [NPM](https://snyk.io/advisor/) (faites d√©filer jusqu'√† la section s√©curit√© > lien toutes les versions).
- URLs Cloud
  - Utilisez [JS Miner](https://github.com/PortSwigger/js-miner).
- Sous-domaines
  - Utilisez [JS Miner](https://github.com/PortSwigger/js-miner).
- Erreurs de logique
  - Acqu√©rir une connaissance de la situation:
    - `use strict;`?
  - Recherchez des contr√¥les c√¥t√© client:
    - disable, enable, hidden, hide, show
    - catch, finally, throw, try
    - input, validate, verify, valid, correct, check, confirm, require, ..
  - Recherchez des non-primitifs:
    - function , =>
    - class
### Analyse dynamique

R√©f√©rences
- https://www.youtube.com/watch?v=_v8r_t4v6hQ
- https://blog.nvisium.com/angular-for-pentesters-part-1
- https://blog.nvisium.com/angular-for-pentesters-part-2

Outils
- https://portswigger.net/burp/documentation/desktop/tools/dom-invader

#### R√©f√©rences moins utilis√©es
- https://cyberchef.org/
- https://olajs.com/javascript-prettifier
- https://jshint.com/
- https://github.com/jshint/jshint/

## NodeJS
```
https://github.com/ajinabraham/nodejsscan
```
## Electron

Electron est un framework open source qui permet de cr√©er des applications de bureau multiplateformes en utilisant des technologies web telles que HTML, CSS et JavaScript. Il est utilis√© par de nombreuses applications populaires telles que Slack, Discord et Visual Studio Code.

Cependant, l'utilisation d'Electron peut pr√©senter des risques de s√©curit√©, car il permet aux d√©veloppeurs d'ex√©cuter du code JavaScript c√¥t√© client avec des privil√®ges √©lev√©s. Cela signifie que si une application Electron est compromise, un attaquant peut potentiellement acc√©der √† des informations sensibles telles que des jetons d'authentification ou des cl√©s API.

Il est donc important de prendre des mesures de s√©curit√© appropri√©es lors de la cr√©ation d'applications Electron, telles que la validation des entr√©es utilisateur, la d√©sactivation de l'ex√©cution de code √† distance et la mise en ≈ìuvre de politiques de s√©curit√© strictes pour les modules tiers utilis√©s dans l'application.
```
https://github.com/doyensec/electronegativity
```
## Python

Python est un langage de programmation interpr√©t√© de haut niveau, orient√© objet et multiplateforme. Il est souvent utilis√© pour le d√©veloppement web, l'analyse de donn√©es, l'automatisation de t√¢ches et la cr√©ation de scripts. Python est √©galement largement utilis√© dans le domaine de la s√©curit√© informatique pour l'automatisation de t√¢ches de pentesting et l'√©criture d'outils de hacking.

Les outils de code review pour Python incluent PyCharm, PyLint, Flake8 et Bandit. PyCharm est un environnement de d√©veloppement int√©gr√© (IDE) pour Python qui offre des fonctionnalit√©s de d√©bogage, de refactoring et de test. PyLint est un outil de v√©rification de code qui d√©tecte les erreurs de syntaxe, les erreurs de style et les erreurs logiques dans le code Python. Flake8 est un outil de v√©rification de code qui combine PyLint, PyFlakes et McCabe pour d√©tecter les erreurs de syntaxe, les erreurs de style et les erreurs de complexit√© dans le code Python. Bandit est un outil de s√©curit√© de code source qui d√©tecte les vuln√©rabilit√©s de s√©curit√© dans le code Python, telles que les injections SQL, les fuites d'informations et les vuln√©rabilit√©s de contr√¥le d'acc√®s.
```bash
# bandit
https://github.com/PyCQA/bandit
# pyt
https://github.com/python-security/pyt
```
## .NET

## Description
.NET is a free, open-source, cross-platform framework for building modern cloud-based applications. It is widely used for developing web applications, desktop applications, and mobile applications.

## Code Review Tools
- [Roslyn Security Guard](https://security-code-scan.github.io/RoslynSecurityGuard/)
- [.NET Security Guard](https://github.com/SecurityGuardNET/SecurityGuard)
- [SonarQube](https://www.sonarqube.org/)
- [Resharper](https://www.jetbrains.com/resharper/)
- [Visual Studio Code](https://code.visualstudio.com/)
- [Visual Studio](https://visualstudio.microsoft.com/)

## Useful .NET Libraries
- [Microsoft.AspNetCore.DataProtection](https://www.nuget.org/packages/Microsoft.AspNetCore.DataProtection/)
- [Microsoft.AspNetCore.Cryptography.KeyDerivation](https://www.nuget.org/packages/Microsoft.AspNetCore.Cryptography.KeyDerivation/)
- [Microsoft.AspNetCore.Identity](https://www.nuget.org/packages/Microsoft.AspNetCore.Identity/)
- [Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation/)
- [Microsoft.AspNetCore.WebUtilities](https://www.nuget.org/packages/Microsoft.AspNetCore.WebUtilities/)
- [Microsoft.Extensions.Caching.Memory](https://www.nuget.org/packages/Microsoft.Extensions.Caching.Memory/)
- [Microsoft.Extensions.Configuration](https://www.nuget.org/packages/Microsoft.Extensions.Configuration/)
- [Microsoft.Extensions.DependencyInjection](https://www.nuget.org/packages/Microsoft.Extensions.DependencyInjection/)
- [Microsoft.Extensions.Logging](https://www.nuget.org/packages/Microsoft.Extensions.Logging/)
- [Microsoft.Extensions.Options.ConfigurationExtensions](https://www.nuget.org/packages/Microsoft.Extensions.Options.ConfigurationExtensions/)
- [Microsoft.Extensions.Options.DataAnnotations](https://www.nuget.org/packages/Microsoft.Extensions.Options.DataAnnotations/)
- [Microsoft.Extensions.WebEncoders](https://www.nuget.org/packages/Microsoft.Extensions.WebEncoders/)
```bash
# dnSpy
https://github.com/0xd4d/dnSpy

# .NET compilation
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe test.cs
```
## Java

Java est un langage de programmation orient√© objet populaire utilis√© pour d√©velopper des applications pour une vari√©t√© de plates-formes. Il est souvent utilis√© pour d√©velopper des applications Web et mobiles. Java est √©galement utilis√© pour d√©velopper des applications pour les plates-formes cloud et SaaS.

Les outils de r√©vision de code Java sont des outils qui aident les d√©veloppeurs √† trouver des erreurs de code et des vuln√©rabilit√©s de s√©curit√© dans leur code Java. Ces outils peuvent √™tre utilis√©s pour d√©tecter des erreurs de syntaxe, des erreurs de logique, des vuln√©rabilit√©s de s√©curit√© et d'autres probl√®mes de code.

Certains des outils de r√©vision de code Java les plus populaires sont FindBugs, PMD et Checkstyle. Ces outils peuvent √™tre utilis√©s pour d√©tecter des erreurs de code courantes telles que les fuites de m√©moire, les erreurs de syntaxe et les vuln√©rabilit√©s de s√©curit√©. Ils peuvent √©galement √™tre utilis√©s pour d√©tecter des erreurs de logique et d'autres probl√®mes de code plus complexes.

Les outils de r√©vision de code Java peuvent √™tre utilis√©s pour am√©liorer la qualit√© du code et r√©duire les risques de s√©curit√©. Ils peuvent √©galement √™tre utilis√©s pour am√©liorer la productivit√© des d√©veloppeurs en leur permettant de trouver et de corriger rapidement les erreurs de code.
```bash
# JD-Gui
https://github.com/java-decompiler/jd-gui

# Java compilation step-by-step
javac -source 1.8 -target 1.8 test.java
mkdir META-INF
echo "Main-Class: test" > META-INF/MANIFEST.MF
jar cmvf META-INF/MANIFEST.MF test.jar test.class
```
| T√¢che           | Commande                                                  |
| --------------- | --------------------------------------------------------- |
| Ex√©cuter un Jar | java -jar \[jar]                                          |
| D√©compresser Jar| unzip -d \[r√©pertoire de sortie] \[jar]                   |
| Cr√©er un Jar    | jar -cmf META-INF/MANIFEST.MF \[jar de sortie] \*         |
| Base64 SHA256   | sha256sum \[fichier] \| cut -d' ' -f1 \| xxd -r -p \| base64 |
| Supprimer la signature | rm META-INF/_.SF META-INF/_.RSA META-INF/\*.DSA       |
| Supprimer du Jar| zip -d \[jar] \[fichier √† supprimer]                      |
| D√©compiler une classe | procyon -o . \[chemin de la classe]                  |
| D√©compiler un Jar | procyon -jar \[jar] -o \[r√©pertoire de sortie]            |
| Compiler une classe | javac \[chemin du fichier .java]                         |

## Go
```bash
https://github.com/securego/gosec
```
## PHP

[Psalm](https://phpmagazine.net/2018/12/find-errors-in-your-php-applications-with-psalm.html) et [PHPStan](https://phpmagazine.net/2020/09/phpstan-pro-edition-launched.html).

### Plugins Wordpress

[https://www.pluginvulnerabilities.com/plugin-security-checker/](https://www.pluginvulnerabilities.com/plugin-security-checker/)

## Solidity

* [https://www.npmjs.com/package/solium](https://www.npmjs.com/package/solium)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !

- D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)

- **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Partagez vos astuces de piratage en soumettant des PR au [repo hacktricks](https://github.com/carlospolop/hacktricks) et au [repo hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
