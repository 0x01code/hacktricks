# Kaynak Kod İncelemesi / SAST Araçları

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana dönüşmek için</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>'ı öğrenin!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek isterseniz** veya **HackTricks'i PDF olarak indirmek isterseniz** [**ABONELİK PLANLARINA**](https://github.com/sponsors/carlospolop) göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi paylaşarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına **PR göndererek** paylaşın.

</details>

## Kılavuz ve Araç Listeleri

* [**https://owasp.org/www-community/Source\_Code\_Analysis\_Tools**](https://owasp.org/www-community/Source\_Code\_Analysis\_Tools)
* [**https://github.com/analysis-tools-dev/static-analysis**](https://github.com/analysis-tools-dev/static-analysis)

## Çoklu Dil Araçları

### [Naxus - AI-Gents](https://www.naxusai.com/)

**PR'ları incelemek için ücretsiz bir paket** bulunmaktadır.

### [**Semgrep**](https://github.com/returntocorp/semgrep)

Bu bir **Açık Kaynak aracıdır**.

#### Desteklenen Diller

| Kategori      | Diller                                                                                                 |
| ------------- | ------------------------------------------------------------------------------------------------------ |
| GA            | C# · Go · Java · JavaScript · JSX · JSON · PHP · Python · Ruby · Scala · Terraform · TypeScript · TSX |
| Beta          | Kotlin · Rust                                                                                           |
| Deneysel      | Bash · C · C++ · Clojure · Dart · Dockerfile · Elixir · HTML · Julia · Jsonnet · Lisp ·               |

#### Hızlı Başlangıç

{% code overflow="wrap" %}
```bash
# Install https://github.com/returntocorp/semgrep#option-1-getting-started-from-the-cli
brew install semgrep

# Go to your repo code and scan
cd repo
semgrep scan --config auto
```
{% endcode %}

Ayrıca, bulguları VSCode içinde almak için [**semgrep VSCode Uzantısı**](https://marketplace.visualstudio.com/items?itemName=Semgrep.semgrep) kullanabilirsiniz.

### [**SonarQube**](https://www.sonarsource.com/products/sonarqube/downloads/)

Kurulabilir bir **ücretsiz sürüm** bulunmaktadır.

#### Hızlı Başlangıç

{% code overflow="wrap" %}
```bash
# Run the paltform in docker
docker run -d --name sonarqube -e SONAR_ES_BOOTSTRAP_CHECKS_DISABLE=true -p 9000:9000 sonarqube:latest
# Install cli tool
brew install sonar-scanner

# Go to localhost:9000 and login with admin:admin or admin:sonar
# Generate a local project and then a TOKEN for it

# Using the token and from the folder with the repo, scan it
cd path/to/repo
sonar-scanner \
-Dsonar.projectKey=<project-name> \
-Dsonar.sources=. \
-Dsonar.host.url=http://localhost:9000 \
-Dsonar.token=<sonar_project_token>
```
{% endcode %}

### CodeQL

Bir **kurulabilir ücretsiz sürüm** bulunmaktadır, ancak lisansa göre yalnızca **Açık Kaynak projelerinde ücretsiz CodeQL sürümünü kullanabilirsiniz**.

#### Kurulum

{% code overflow="wrap" %}
```bash
# Download your release from https://github.com/github/codeql-action/releases
## Example
wget https://github.com/github/codeql-action/releases/download/codeql-bundle-v2.14.3/codeql-bundle-osx64.tar.gz

# Move it to the destination folder
mkdir ~/codeql
mv codeql-bundle* ~/codeql

# Decompress it
cd ~/codeql
tar -xzvf codeql-bundle-*.tar.gz
rm codeql-bundle-*.tar.gz

# Add to path
echo 'export PATH="$PATH:/Users/username/codeql/codeql"' >> ~/.zshrc

# Check it's correctly installed
## Open a new terminal
codeql resolve qlpacks #Get paths to QL packs
```
{% endcode %}

#### Hızlı Başlangıç - Veritabanını Hazırlayın

{% hint style="success" %}
İlk yapmanız gereken şey, sorguların üzerinde çalıştırılacağı veritabanını **hazırlamaktır** (kod ağacını oluşturmak).
{% endhint %}

* Codeql'nin depodaki dilini otomatik olarak tanımasına ve veritabanını oluşturmasına izin verebilirsiniz.
```bash
codeql database create <database> --language <language>

# Example
codeql database create /path/repo/codeql_db --source-root /path/repo
## DB will be created in /path/repo/codeql_db
```
{% endcode %}

{% hint style="danger" %}
Bu genellikle birden fazla dilin belirtildiği (veya otomatik olarak algılandığı) bir hata oluşturur. Bunun düzeltilmesi için aşağıdaki seçeneklere bakın!
{% endhint %}

* Bu işlemi **manuel olarak yapabilirsiniz**, **repo** ve **dili** belirterek ([dil listesi](https://docs.github.com/en/code-security/codeql-cli/getting-started-with-the-codeql-cli/preparing-your-code-for-codeql-analysis#running-codeql-database-create))

{% code overflow="wrap" %}
```bash
codeql database create <database> --language <language> --source-root </path/to/repo>

# Example
codeql database create /path/repo/codeql_db --language javascript --source-root /path/repo
## DB will be created in /path/repo/codeql_db
```
{% endcode %}

* Eğer repo **1'den fazla dil** kullanıyorsa, her dil için **1 DB oluşturabilirsiniz** ve her dilin belirtilmesi gerekir.

{% code overflow="wrap" %}
```bash
export GITHUB_TOKEN=ghp_32849y23hij4...
codeql database create <database> --source-root /path/to/repo --db-cluster --language "javascript,python"

# Example
export GITHUB_TOKEN=ghp_32849y23hij4...
codeql database create /path/repo/codeql_db --source-root /path/to/repo --db-cluster --language "javascript,python"
## DBs will be created in /path/repo/codeql_db/*
```
{% endcode %}

* Ayrıca `codeql`'ye **tüm dilleri tanımasına** izin verebilir ve dil başına bir veritabanı oluşturabilirsiniz. Bunun için bir **GITHUB\_TOKEN** vermeniz gerekmektedir.

{% code overflow="wrap" %}
```bash
export GITHUB_TOKEN=ghp_32849y23hij4...
codeql database create <database> --db-cluster --source-root </path/to/repo>

# Example
export GITHUB_TOKEN=ghp_32849y23hij4...
codeql database create /tmp/codeql_db --db-cluster --source-root /path/repo
## DBs will be created in /path/repo/codeql_db/*
```
{% endcode %}

#### Hızlı Başlangıç - Kodu Analiz Et

{% hint style="success" %}
Şimdi nihayet kodu analiz etme zamanı geldi.
{% endhint %}

Unutmayın, birden fazla dil kullandıysanız, belirttiğiniz yol üzerinde **her dil için bir DB** oluşturulmuş olacaktır.

{% code overflow="wrap" %}
```bash
# Default analysis
codeql database analyze <database> --format=<format> --output=</out/file/path>
# Example
codeql database analyze /tmp/codeql_db/javascript --format=sarif-latest --output=/tmp/graphql_results.sarif

# Specify QL pack to use in the analysis
codeql database analyze <database> \
<qls pack> --sarif-category=<language> \
--sarif-add-baseline-file-info \ --format=<format> \
--output=/out/file/path>
# Example
codeql database analyze /tmp/codeql_db \
javascript-security-extended --sarif-category=javascript \
--sarif-add-baseline-file-info --format=sarif-latest \
--output=/tmp/sec-extended.sarif
```
{% endcode %}

#### Hızlı Başlangıç - Betikli

{% code overflow="wrap" %}
```bash
export GITHUB_TOKEN=ghp_32849y23hij4...
export REPO_PATH=/path/to/repo
export OUTPUT_DIR_PATH="$REPO_PATH/codeql_results"
mkdir -p "$OUTPUT_DIR_PATH"
export FINAL_MSG="Results available in: "

echo "Creating DB"
codeql database create "$REPO_PATH/codeql_db" --db-cluster --source-root "$REPO_PATH"
for db in `ls "$REPO_PATH/codeql_db"`; do
echo "Analyzing $db"
codeql database analyze "$REPO_PATH/codeql_db/$db" --format=sarif-latest --output="${OUTPUT_DIR_PATH}/$db).sarif"
FINAL_MSG="$FINAL_MSG ${OUTPUT_DIR_PATH}/$db.sarif ,"
echo ""
done

echo $FINAL_MSG
```
{% endcode %}

Buluntuları [**https://microsoft.github.io/sarif-web-component/**](https://microsoft.github.io/sarif-web-component/) adresindeki veya VSCode uzantısı [**SARIF viewer**](https://marketplace.visualstudio.com/items?itemName=MS-SarifVSCode.sarif-viewer) kullanarak görselleştirebilirsiniz.

Buluntuları VSCode içinde almak için [**VSCode uzantısını**](https://marketplace.visualstudio.com/items?itemName=GitHub.vscode-codeql) kullanabilirsiniz. Hala bir veritabanı oluşturmanız gerekecek, ancak sonra herhangi bir dosyayı seçebilir ve `Sağ Tıkla` -> `CodeQL: Run Queries in Selected Files` üzerine tıklayabilirsiniz.

### [**Snyk**](https://snyk.io/product/snyk-code/)

**Yüklenebilir ücretsiz bir sürüm** bulunmaktadır.

#### Hızlı Başlangıç
```bash
# Install
sudo npm install -g snyk

# Authenticate (you can use a free account)
snyk auth

# Test for open source vulns & license issues
snyk test [--all-projects]

# Test for code vulnerabilities
## This will upload your code and you need to enable this option in: Settings > Snyk Code
snyk test code

# Test for vulns in images
snyk container test [image]

# Test for IaC vulns
snyk iac test
```
[**snyk VSCode Extension**](https://marketplace.visualstudio.com/items?itemName=snyk-security.snyk-vulnerability-scanner) kullanarak VSCode içinde sonuçlara ulaşabilirsiniz.

### [Insider](https://github.com/insidersec/insider)

Bu **Açık Kaynaklı**dır, ancak **bakımsız** görünmektedir.

#### Desteklenen Diller

Java (Maven ve Android), Kotlin (Android), Swift (iOS), .NET Full Framework, C# ve Javascript (Node.js).

#### Hızlı Başlangıç
```bash
# Check the correct release for your environment
$ wget https://github.com/insidersec/insider/releases/download/2.1.0/insider_2.1.0_linux_x86_64.tar.gz
$ tar -xf insider_2.1.0_linux_x86_64.tar.gz
$ chmod +x insider
$ ./insider --tech javascript  --target <projectfolder>
```
### [**DeepSource**](https://deepsource.com/pricing)&#x20;

Halka açık depolar için ücretsiz.

## NodeJS

* **`yarn`**
```bash
# Install
brew install yarn
# Run
cd /path/to/repo
yarn audit
npm audit
```
* **`pnpm`**

`pnpm` is a fast and efficient package manager for JavaScript projects. It is similar to `npm` and `yarn`, but with some unique features. 

Some advantages of using `pnpm` include:

- **Faster installation**: `pnpm` uses a unique approach called "linking" to avoid duplicating dependencies. This results in faster installation times and saves disk space.

- **Efficient disk usage**: `pnpm` uses a shared store to store dependencies, which means that if multiple projects have the same dependencies, they will only be stored once on disk. This helps to reduce disk usage.

- **Parallel execution**: `pnpm` can execute multiple installation commands in parallel, which can significantly speed up the installation process.

- **Strict versioning**: `pnpm` enforces strict versioning, ensuring that only the specified versions of dependencies are installed. This helps to prevent compatibility issues.

To install `pnpm`, you can use the following command:

```bash
npm install -g pnpm
```

Once installed, you can use `pnpm` in your JavaScript projects by running commands such as `pnpm install` to install dependencies or `pnpm start` to start your project.

For more information on how to use `pnpm`, you can refer to the [official documentation](https://pnpm.io/).
```bash
# Install
npm install -g pnpm
# Run
cd /path/to/repo
pnpm audit
```
* [**nodejsscan**](https://github.com/ajinabraham/nodejsscan)**:** Node.js uygulamaları için statik güvenlik kod tarama aracı (SAST), [libsast](https://github.com/ajinabraham/libsast) ve [semgrep](https://github.com/returntocorp/semgrep) tarafından desteklenmektedir.
```bash
# Install & run
docker run -it -p 9090:9090 opensecurity/nodejsscan:latest
# Got to localhost:9090
# Upload a zip file with the code
```
* [**RetireJS**](https://github.com/RetireJS/retire.js)**:** Retire.js'nin amacı, bilinen güvenlik açıklarına sahip JS kütüphane sürümlerinin kullanımını tespit etmenize yardımcı olmaktır.
```bash
# Install
npm install -g retire
# Run
cd /path/to/repo
retire --colors
```
## Electron

* [**electronegativity**](https://github.com/doyensec/electronegativity)**:** Electron tabanlı uygulamalardaki yanlış yapılandırmaları ve güvenlik anti-örüntüleri belirlemek için bir araçtır.

## Python

* [**Bandit**](https://github.com/PyCQA/bandit)**:** Bandit, Python kodunda yaygın güvenlik sorunlarını bulmak için tasarlanmış bir araçtır. Bunun için Bandit, her dosyayı işler, ondan bir AST oluşturur ve AST düğümleri üzerinde uygun eklentileri çalıştırır. Bandit tüm dosyaları taradıktan sonra bir rapor oluşturur.
```bash
# Install
pip3 install bandit

# Run
bandit -r <path to folder>
```
* [**safety**](https://github.com/pyupio/safety): Safety, Python bağımlılıklarını bilinen güvenlik açıklarına karşı kontrol eder ve tespit edilen güvenlik açıkları için uygun çözümler önerir. Safety, geliştirici makinelerinde, CI/CD borularında ve üretim sistemlerinde çalıştırılabilir.
```bash
# Install
pip install safety
# Run
safety check
```
* [~~**Pyt**~~](https://github.com/python-security/pyt): Bakımsız.

## .NET
```bash
# dnSpy
https://github.com/0xd4d/dnSpy

# .NET compilation
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe test.cs
```
## RUST

Rust is a systems programming language that focuses on safety, speed, and concurrency. It is designed to be memory safe and thread safe, making it a good choice for building reliable and efficient software. Rust's syntax is similar to C++, but it includes modern features such as pattern matching, type inference, and ownership semantics.

### Code Review Tools

When performing a code review in Rust, there are several tools that can help identify potential vulnerabilities and improve code quality. Here are some commonly used code review tools for Rust:

- **Clippy**: Clippy is a linter for Rust that provides helpful suggestions and warnings to improve code quality. It can catch common mistakes, enforce best practices, and identify potential bugs.

- **Rustfmt**: Rustfmt is a tool for formatting Rust code according to the official Rust style guidelines. It automatically formats code to ensure consistency and readability.

- **Cargo Audit**: Cargo Audit is a tool that checks for known vulnerabilities in the dependencies used by a Rust project. It scans the project's Cargo.lock file and compares it against a database of known vulnerabilities.

- **RustSec**: RustSec is a community-driven database of security advisories for Rust crates. It provides information about vulnerabilities in specific crates and helps developers stay informed about potential security issues.

- **Rust Analyzer**: Rust Analyzer is an integrated development environment (IDE) extension for Rust that provides code analysis and navigation features. It offers real-time error highlighting, code completion, and documentation lookup.

These tools can be used individually or in combination to perform a comprehensive code review in Rust. By leveraging these tools, developers can identify and address potential security vulnerabilities, improve code quality, and ensure the reliability of their Rust applications.
```bash
# Install
cargo install cargo-audit

# Run
cargo audit

#Update the Advisory Database
cargo audit fetch
```
## Java

Java, birçok web uygulamasında kullanılan popüler bir programlama dilidir. Java kod incelemesi yaparken aşağıdaki araçları kullanabilirsiniz:

- **Checkstyle**: Java kodunun stil ve kalite kurallarına uygunluğunu kontrol etmek için kullanılır. Checkstyle, kodun okunabilirliğini ve sürdürülebilirliğini artırmak için kullanışlıdır.

- **FindBugs**: Potansiyel hataları ve hatalı kod kalıplarını tespit etmek için kullanılır. FindBugs, kodun güvenliğini ve performansını artırmak için kullanışlıdır.

- **PMD**: Kod kalitesini kontrol etmek ve hatalı kod kalıplarını tespit etmek için kullanılır. PMD, kodun daha temiz ve daha iyi yapılandırılmış olmasını sağlar.

- **SonarQube**: Kod kalitesini, güvenliğini ve sürdürülebilirliğini değerlendirmek için kullanılır. SonarQube, geniş bir kural setiyle kodunuzu analiz eder ve iyileştirme önerileri sunar.

Bu araçlar, Java kodunun güvenliğini, performansını ve kalitesini artırmak için önemli bir rol oynar. Kod incelemesi yaparken bu araçları kullanarak potansiyel hataları ve iyileştirme fırsatlarını tespit edebilirsiniz.
```bash
# JD-Gui
https://github.com/java-decompiler/jd-gui

# Java compilation step-by-step
javac -source 1.8 -target 1.8 test.java
mkdir META-INF
echo "Main-Class: test" > META-INF/MANIFEST.MF
jar cmvf META-INF/MANIFEST.MF test.jar test.class
```
| Görev            | Komut                                                     |
| --------------- | --------------------------------------------------------- |
| Jar Dosyasını Çalıştır | java -jar \[jar]                                          |
| Jar Dosyasını Çıkart | unzip -d \[çıktı dizini] \[jar]                       |
| Jar Dosyası Oluştur | jar -cmf META-INF/MANIFEST.MF \[çıktı jar] \*            |
| Base64 SHA256   | sha256sum \[dosya] \| cut -d' ' -f1 \| xxd -r -p \| base64 |
| İmzayı Kaldır  | rm META-INF/_.SF META-INF/_.RSA META-INF/\*.DSA           |
| Jardan Sil | zip -d \[jar] \[silinecek dosya]                           |
| Sınıfı Geri Derle | procyon -o . \[sınıfın yolu]                             |
| Jar Dosyasını Geri Derle   | procyon -jar \[jar] -o \[çıktı dizini]                |
| Sınıfı Derle   | javac \[.java dosyasının yolu]                               |

## Devam Et
```bash
https://github.com/securego/gosec
```
## PHP

[Psalm](https://phpmagazine.net/2018/12/find-errors-in-your-php-applications-with-psalm.html) ve [PHPStan](https://phpmagazine.net/2020/09/phpstan-pro-edition-launched.html).

### Wordpress Eklentileri

[https://www.pluginvulnerabilities.com/plugin-security-checker/](https://www.pluginvulnerabilities.com/plugin-security-checker/)

## Solidity

* [https://www.npmjs.com/package/solium](https://www.npmjs.com/package/solium)

## JavaScript

### Keşif

1. Burp:
* Spider ve içeriği keşfet
* Sitemap > filtrele
* Sitemap > alan üzerinde sağ tıkla > Engagement araçları > Scriptleri bul
2. [WaybackURLs](https://github.com/tomnomnom/waybackurls):
* `waybackurls <domain> |grep -i "\.js" |sort -u`

### Statik Analiz

#### Unminimize/Beautify/Prettify

* [https://prettier.io/playground/](https://prettier.io/playground/)
* [https://beautifier.io/](https://beautifier.io/)

#### Deobfuscate/Unpack

**Not**: Tamamen deobfuscate etmek mümkün olmayabilir.

1. .map dosyalarını bul ve kullan:
* Eğer .map dosyaları açığa çıkarılmışsa, kolayca deobfuscate etmek için kullanılabilirler.
* Genellikle, foo.js.map foo.js'e eşlenir. Manuel olarak onları ara.
* [JS Miner](https://github.com/PortSwigger/js-miner) kullanarak onları bul.
* Aktif tarama yapılmasını sağla.
* '[İpuçları/Notlar](https://github.com/minamo7sen/burp-JS-Miner/wiki#tips--notes)'ı oku.
* Bulunduysa, deobfuscate etmek için [Maximize](https://www.npmjs.com/package/maximize) kullan.
2. .map dosyaları olmadan, JSnice dene:
* Referanslar: http://jsnice.org/ & https://www.npmjs.com/package/jsnice
* İpuçları:
* jsnice.org'u kullanıyorsan, "Nicify JavaScript" düğmesinin yanındaki seçenekler düğmesine tıkla ve "Infer types" seçeneğini kaldırarak kodu yorumlarla karıştırmadan temizle.
* Scriptten önce boş satır bırakma, deobfuscation sürecini etkileyebilir ve yanlış sonuçlar verebilir.
3. console.log(); kullan:
* Sonunda dönen değeri bul ve `console.log(<packerReturnVariable>);` olarak değiştir, böylece deobfuscate edilmiş js yerine js konsola yazdırılır.
* Ardından, deobfuscate edilmiş js'in konsola kaydedildiğini görmek için değiştirilmiş (ve hala obfuscated) js'i https://jsconsole.com/ adresine yapıştır.
* Son olarak, analiz için deobfuscate edilmiş çıktıyı https://prettier.io/playground/ adresine yapıştırarak güzelleştir.
* **Not**: Hala paketlenmiş (ancak farklı) js görüyorsanız, muhtemelen tekrar paketlenmiştir. İşlemi tekrarlayın.

Referanslar

* https://www.youtube.com/watch?v=_v8r_t4v6hQ
* https://blog.nvisium.com/angular-for-pentesters-part-1
* https://blog.nvisium.com/angular-for-pentesters-part-2

Araçlar

* https://portswigger.net/burp/documentation/desktop/tools/dom-invader

#### Daha Az Kullanılan Referanslar

* https://cyberchef.org/
* https://olajs.com/javascript-prettifier
* https://jshint.com/
* https://github.com/jshint/jshint/

<details>

<summary><strong>AWS hacklemeyi sıfırdan kahraman olmak için öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya HackTricks'i **PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github reposuna **PR göndererek** paylaşın.

</details>
