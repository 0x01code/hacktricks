# Ferramentas de Revis√£o de C√≥digo

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe suas t√©cnicas de hacking enviando PRs para o [reposit√≥rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

## Geral

* [**https://owasp.org/www-community/Source\_Code\_Analysis\_Tools**](https://owasp.org/www-community/Source\_Code\_Analysis\_Tools)\
  
* [**https://github.com/analysis-tools-dev/static-analysis**](https://github.com/analysis-tools-dev/static-analysis)
```bash
https://www.sonarqube.org/downloads/
https://deepsource.io/signup/
https://github.com/pyupio/safety
https://github.com/returntocorp/semgrep
https://github.com/WhaleShark-Team/cobra
https://github.com/insidersec/insider

# Find interesting strings
https://github.com/s0md3v/hardcodes
https://github.com/micha3lb3n/SourceWolf
https://libraries.io/pypi/detect-secrets
```
## JavaScript
### Descoberta
1. Burp:
   - Spider e descobrir conte√∫do
   - Sitemap > filtro
   - Sitemap > clique com o bot√£o direito do mouse no dom√≠nio > Ferramentas de engajamento > Encontrar scripts
2. [WaybackURLs](https://github.com/tomnomnom/waybackurls):
   - `waybackurls <dom√≠nio> |grep -i "\.js" |sort -u`
### An√°lise est√°tica
#### Desminificar/Embelezar/Formatar
https://prettier.io/playground/
https://beautifier.io/
#### Desofuscar/Descompactar
__Nota__: Pode n√£o ser poss√≠vel desofuscar completamente.
1. Encontre e use arquivos .map:
   - Se os arquivos .map estiverem expostos, eles podem ser usados para desofuscar facilmente.
   - Comumente, foo.js.map mapeia para foo.js. Procure manualmente por eles.
   - Use [JS Miner](https://github.com/PortSwigger/js-miner) para procur√°-los.
    - Certifique-se de que a verifica√ß√£o ativa seja realizada.
    - Leia '[Dicas/Notas](https://github.com/minamo7sen/burp-JS-Miner/wiki#tips--notes)'
   - Se encontrados, use [Maximize](https://www.npmjs.com/package/maximize) para desofuscar.
2. Sem arquivos .map, tente JSnice:
   - Refer√™ncias: http://jsnice.org/ & https://www.npmjs.com/package/jsnice
   - Dicas:
     - Se estiver usando jsnice.org, clique no bot√£o de op√ß√µes ao lado do bot√£o "Nicify JavaScript" e desmarque "Infer types" para reduzir a desordem no c√≥digo com coment√°rios.
     - Certifique-se de n√£o deixar nenhuma linha vazia antes do script, pois isso pode afetar o processo de desofusca√ß√£o e fornecer resultados imprecisos.
3. Use console.log(<packerReturnVariable>);
   - Encontre o valor de retorno no final e altere-o para `console.log(<packerReturnVariable>);` para que o js desofuscado seja impresso em vez de ser executado.
   - Em seguida, cole o js modificado (e ainda ofuscado) em https://jsconsole.com/ para ver o js desofuscado registrado no console.
   - Finalmente, cole a sa√≠da desofuscada em https://prettier.io/playground/ para embelez√°-la para an√°lise.
   - __Nota__: Se voc√™ ainda estiver vendo js compactado (mas diferente), ele pode estar compactado recursivamente. Repita o processo.
#### Analisar
Refer√™ncias:
https://medium.com/techiepedia/javascript-code-review-guide-for-bug-bounty-hunters-c95a8aa7037a

 Procure por:
- Carregamento anti-depurador
  - Angular: [enableProdMode](https://blog.nvisium.com/angular-for-pentesters-part-2)
- Segredos
  - Use:
    - [JS Miner](https://github.com/PortSwigger/js-miner)
    - [RegHex](https://github.com/l4yton/RegHex) padr√µes
    - [gf](https://github.com/tomnomnom/gf/tree/master/examples) padr√µes
    - Grep padr√µes relevantes do dicion√°rio:
      - pass, user, admin
      - auth, login, sign, challenge, 2fa
      - key, apikey, api_key, api-key, jwt, token
      - secret, security, secure
      - ...
    - Revis√£o manual
  - Se a chave da API for encontrada, verifique aqui a sintaxe potencial de uso: https://github.com/streaak/keyhacks.
- Fun√ß√µes vulner√°veis
  - InnerHTML() - Se voc√™ encontrou isso, significa que h√° uma chance potencial de XSS se n√£o houver uma sanitiza√ß√£o adequada. Mesmo que sua carga √∫til esteja sanitizada, n√£o se preocupe. Trace o c√≥digo para descobrir onde a sanitiza√ß√£o ocorre. Estude-o e tente contornar a sanitiza√ß√£o.
  - Postmessage() - Se voc√™ leu meu post anterior (https://medium.com/techiepedia/what-are-sop-cors-and-ways-to-exploit-it-62a5e02100dc), voc√™ notaria que Postmessage() pode levar a um poss√≠vel problema de CORS. Se o segundo par√¢metro da fun√ß√£o for definido como *, voc√™ √© o sortudo. Confira meu post anterior para entender mais sobre o mecanismo por tr√°s.
  - String.prototype.search() - Esta fun√ß√£o parece normal. Por que seria uma fun√ß√£o perigosa? Bem, √© porque alguns desenvolvedores usaram isso para encontrar a ocorr√™ncia de uma string dentro de outra string. No entanto, "." √© tratado como curinga nesta fun√ß√£o. Ent√£o, se esta fun√ß√£o for usada como verifica√ß√£o de sanitiza√ß√£o, voc√™ pode simplesmente contorn√°-la inserindo ".". Confira o relat√≥rio do hackerone do Filedescryptor: https://hackerone.com/reports/129873
- Endpoints e par√¢metros
  - Use [LinkFinder](https://github.com/GerbenJavado/LinkFinder) & [JS Miner](https://github.com/PortSwigger/js-miner).
- Bibliotecas e depend√™ncias vulner√°veis
  - Use [Retire.js](https://retirejs.github.io/retire.js/) e [NPM](https://snyk.io/advisor/) (role para baixo at√© a se√ß√£o de seguran√ßa > link de todas as vers√µes).
- URLs de nuvem
  - Use [JS Miner](https://github.com/PortSwigger/js-miner).
- Subdom√≠nios
  - Use [JS Miner](https://github.com/PortSwigger/js-miner).
- Falhas de l√≥gica
  - Obtenha consci√™ncia situacional:
    - `use strict;`?
  - Grep para controles do lado do cliente:
    - disable, enable, hidden, hide, show
    - catch, finally, throw, try
    - input, validate, verify, valid, correct, check, confirm, require, ..
  - Grep para n√£o-primitivos:
    - function , =>
    - class
### An√°lise din√¢mica

Refer√™ncias
- https://www.youtube.com/watch?v=_v8r_t4v6hQ
- https://blog.nvisium.com/angular-for-pentesters-part-1
- https://blog.nvisium.com/angular-for-pentesters-part-2

Ferramentas
- https://portswigger.net/burp/documentation/desktop/tools/dom-invader

#### Refer√™ncias menos usadas
- https://cyberchef.org/
- https://olajs.com/javascript-prettifier
- https://jshint.com/
- https://github.com/jshint/jshint/

## NodeJS
```
https://github.com/ajinabraham/nodejsscan
```
## Electron

Electron √© um framework de c√≥digo aberto criado pela equipe do GitHub. Ele permite que os desenvolvedores criem aplicativos de desktop multiplataforma usando tecnologias web como HTML, CSS e JavaScript. O Electron √© usado por muitos aplicativos populares, incluindo o Slack, o Visual Studio Code e o Discord.

Embora o Electron seja uma ferramenta poderosa para criar aplicativos de desktop, ele tamb√©m pode ser uma fonte de vulnerabilidades de seguran√ßa. Os aplicativos do Electron s√£o executados em um ambiente de navegador incorporado, o que significa que eles t√™m acesso a muitos recursos do sistema operacional, como o sistema de arquivos e a rede. Isso pode ser √∫til para os desenvolvedores, mas tamb√©m pode ser explorado por atacantes.

Os testadores de seguran√ßa devem estar cientes das vulnerabilidades comuns do Electron, como a execu√ß√£o remota de c√≥digo (RCE) e a inje√ß√£o de c√≥digo malicioso. Eles tamb√©m devem estar familiarizados com as ferramentas de an√°lise de seguran√ßa do Electron, como o Electron Security Checklist e o Electron Scanner, para ajudar a identificar poss√≠veis vulnerabilidades em aplicativos do Electron.
```
https://github.com/doyensec/electronegativity
```
## Python

Python √© uma linguagem de programa√ß√£o popular usada em muitas aplica√ß√µes, incluindo desenvolvimento web. √â uma linguagem interpretada, o que significa que o c√≥digo √© executado linha por linha em tempo de execu√ß√£o. Python √© conhecido por sua sintaxe clara e concisa, tornando-o uma escolha popular para iniciantes em programa√ß√£o.

Algumas ferramentas √∫teis para revis√£o de c√≥digo Python incluem:

- **Pylint**: uma ferramenta de an√°lise de c√≥digo que verifica se o c√≥digo Python est√° em conformidade com as conven√ß√µes de codifica√ß√£o definidas pela PEP 8. Ele tamb√©m pode detectar erros comuns de programa√ß√£o, como vari√°veis n√£o utilizadas e refer√™ncias indefinidas.

- **Pyflakes**: uma ferramenta de an√°lise de c√≥digo que verifica se o c√≥digo Python tem erros de sintaxe ou refer√™ncias indefinidas.

- **Bandit**: uma ferramenta de seguran√ßa de c√≥digo que verifica se o c√≥digo Python tem vulnerabilidades de seguran√ßa conhecidas.

- **Mypy**: uma ferramenta de an√°lise de tipo est√°tico que verifica se o c√≥digo Python tem erros de tipo.

- **Black**: uma ferramenta de formata√ß√£o de c√≥digo que ajuda a manter a consist√™ncia do estilo de c√≥digo Python em um projeto.
```bash
# bandit
https://github.com/PyCQA/bandit
# pyt
https://github.com/python-security/pyt
```
## .NET

O .NET √© uma plataforma de desenvolvimento de software da Microsoft que √© amplamente utilizada para criar aplicativos Windows e Web. Ele fornece uma estrutura de desenvolvimento de software que inclui uma linguagem de programa√ß√£o (C # ou VB.NET), um ambiente de tempo de execu√ß√£o e uma biblioteca de classes. O .NET √© uma plataforma poderosa e flex√≠vel que permite aos desenvolvedores criar aplicativos de alta qualidade com facilidade.

### Ferramentas de Revis√£o de C√≥digo .NET

Existem v√°rias ferramentas de revis√£o de c√≥digo dispon√≠veis para o .NET que podem ajudar a identificar vulnerabilidades de seguran√ßa em seu c√≥digo. Algumas das ferramentas mais populares incluem:

- **Visual Studio**: O Visual Studio inclui uma s√©rie de ferramentas de an√°lise de c√≥digo que podem ajudar a identificar problemas de seguran√ßa em seu c√≥digo .NET. Essas ferramentas incluem o Code Analysis, que verifica seu c√≥digo em busca de problemas de seguran√ßa e o FxCop, que verifica seu c√≥digo em busca de conformidade com as diretrizes de codifica√ß√£o.

- **ReSharper**: O ReSharper √© uma ferramenta de revis√£o de c√≥digo para o Visual Studio que pode ajudar a identificar problemas de seguran√ßa em seu c√≥digo .NET. Ele fornece sugest√µes de corre√ß√£o de c√≥digo em tempo real e pode ajudar a melhorar a qualidade do seu c√≥digo.

- **NDepend**: O NDepend √© uma ferramenta de an√°lise de c√≥digo que pode ajudar a identificar problemas de seguran√ßa em seu c√≥digo .NET. Ele fornece uma an√°lise detalhada do seu c√≥digo e pode ajudar a identificar √°reas que precisam de melhorias de seguran√ßa.

- **SonarQube**: O SonarQube √© uma plataforma de an√°lise de c√≥digo que pode ajudar a identificar problemas de seguran√ßa em seu c√≥digo .NET. Ele fornece uma an√°lise detalhada do seu c√≥digo e pode ajudar a identificar √°reas que precisam de melhorias de seguran√ßa.

- **Fortify**: O Fortify √© uma ferramenta de an√°lise de seguran√ßa que pode ajudar a identificar vulnerabilidades de seguran√ßa em seu c√≥digo .NET. Ele fornece uma an√°lise detalhada do seu c√≥digo e pode ajudar a identificar √°reas que precisam de melhorias de seguran√ßa.
```bash
# dnSpy
https://github.com/0xd4d/dnSpy

# .NET compilation
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe test.cs
```
## Java

Java √© uma linguagem de programa√ß√£o popular usada para desenvolver aplicativos em v√°rias plataformas. √â uma linguagem orientada a objetos e √© executada em uma m√°quina virtual Java (JVM). A JVM permite que o c√≥digo Java seja executado em qualquer plataforma que tenha uma JVM instalada. O Java √© usado em muitos aplicativos da web e √© uma das linguagens mais populares para desenvolvimento de aplicativos Android.
```bash
# JD-Gui
https://github.com/java-decompiler/jd-gui

# Java compilation step-by-step
javac -source 1.8 -target 1.8 test.java
mkdir META-INF
echo "Main-Class: test" > META-INF/MANIFEST.MF
jar cmvf META-INF/MANIFEST.MF test.jar test.class
```
| Tarefa           | Comando                                                   |
| ---------------- | --------------------------------------------------------- |
| Executar Jar     | java -jar \[jar]                                          |
| Descompactar Jar | unzip -d \[diret√≥rio de sa√≠da] \[jar]                     |
| Criar Jar        | jar -cmf META-INF/MANIFEST.MF \[jar de sa√≠da] \*          |
| Base64 SHA256    | sha256sum \[arquivo] \| cut -d' ' -f1 \| xxd -r -p \| base64 |
| Remover Assinatura| rm META-INF/_.SF META-INF/_.RSA META-INF/\*.DSA           |
| Excluir do Jar   | zip -d \[jar] \[arquivo a ser removido]                   |
| Descompilar classe | procyon -o . \[caminho para a classe]                     |
| Descompilar Jar  | procyon -jar \[jar] -o \[diret√≥rio de sa√≠da]              |
| Compilar classe  | javac \[caminho para o arquivo .java]                     |
```bash
https://github.com/securego/gosec
```
## PHP

[Psalm](https://phpmagazine.net/2018/12/find-errors-in-your-php-applications-with-psalm.html) e [PHPStan](https://phpmagazine.net/2020/09/phpstan-pro-edition-launched.html).

### Plugins do Wordpress

[https://www.pluginvulnerabilities.com/plugin-security-checker/](https://www.pluginvulnerabilities.com/plugin-security-checker/)

## Solidity

* [https://www.npmjs.com/package/solium](https://www.npmjs.com/package/solium)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe suas t√©cnicas de hacking enviando PRs para o [reposit√≥rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
