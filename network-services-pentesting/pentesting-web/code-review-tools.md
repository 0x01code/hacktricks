# 代码审查工具

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks 云 ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 推特 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- 你在一家**网络安全公司**工作吗？你想在 HackTricks 中看到你的**公司广告**吗？或者你想获得**PEASS 的最新版本或下载 HackTricks 的 PDF 版本**吗？请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！

- 发现我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)收藏品[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- 获取[**官方 PEASS & HackTricks 商品**](https://peass.creator-spring.com)

- **加入** [**💬**](https://emojipedia.org/speech-balloon/) [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass)，或者**关注**我在**Twitter**上的[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**

- **通过向[hacktricks 仓库](https://github.com/carlospolop/hacktricks)和[hacktricks-cloud 仓库](https://github.com/carlospolop/hacktricks-cloud)提交 PR 来分享你的黑客技巧。**

</details>

## 通用

* [**https://owasp.org/www-community/Source\_Code\_Analysis\_Tools**](https://owasp.org/www-community/Source\_Code\_Analysis\_Tools)\

* [**https://github.com/analysis-tools-dev/static-analysis**](https://github.com/analysis-tools-dev/static-analysis)
```bash
https://www.sonarqube.org/downloads/
https://deepsource.io/signup/
https://github.com/pyupio/safety
https://github.com/returntocorp/semgrep
https://github.com/WhaleShark-Team/cobra
https://github.com/insidersec/insider

# Find interesting strings
https://github.com/s0md3v/hardcodes
https://github.com/micha3lb3n/SourceWolf
https://libraries.io/pypi/detect-secrets
```
## JavaScript
### 发现
1. Burp：
- 使用Spider发现内容
- Sitemap > 过滤器
- Sitemap > 右键点击域名 > Engagement工具 > 查找脚本
2. [WaybackURLs](https://github.com/tomnomnom/waybackurls)：
- `waybackurls <domain> |grep -i "\.js" |sort -u`
### 静态分析
#### 反混淆/美化/格式化
https://prettier.io/playground/
https://beautifier.io/
#### 解混淆/解包
__注意__：可能无法完全解混淆。
1. 查找并使用.map文件：
- 如果.map文件被公开，可以使用它们轻松解混淆。
- 通常，foo.js.map对应foo.js。手动查找它们。
- 使用[JS Miner](https://github.com/PortSwigger/js-miner)查找它们。
- 确保进行主动扫描。
- 阅读'[提示/笔记](https://github.com/minamo7sen/burp-JS-Miner/wiki#tips--notes)'
- 如果找到，请使用[Maximize](https://www.npmjs.com/package/maximize)进行解混淆。
2. 如果没有.map文件，请尝试JSnice：
- 参考：http://jsnice.org/ 和 https://www.npmjs.com/package/jsnice
- 提示：
- 如果使用jsnice.org，请点击“Nicify JavaScript”按钮旁边的选项按钮，并取消选择“Infer types”以减少代码中的注释。
- 确保在脚本之前没有留下空行，因为它可能会影响解混淆过程并导致不准确的结果。
3. 使用console.log(<packerReturnVariable>);
- 找到最后的返回值，并将其更改为`console.log(<packerReturnVariable>);`，以便打印解混淆的js而不是执行它。
- 然后，将修改后（仍然混淆的）js粘贴到https://jsconsole.com/中，以查看解混淆的js在控制台中记录。
- 最后，将解混淆的输出粘贴到https://prettier.io/playground/中进行美化以进行分析。
- __注意__：如果仍然看到打包的（但不同的）js，则可能是递归打包。重复此过程。
#### 分析
参考：
https://medium.com/techiepedia/javascript-code-review-guide-for-bug-bounty-hunters-c95a8aa7037a

查找：
- 反调试加载
- Angular：[enableProdMode](https://blog.nvisium.com/angular-for-pentesters-part-2)
- 密钥
- 使用：
- [JS Miner](https://github.com/PortSwigger/js-miner)
- [RegHex](https://github.com/l4yton/RegHex)模式
- [gf](https://github.com/tomnomnom/gf/tree/master/examples)模式
- Grep相关字典模式：
- pass, user, admin
- auth, login, sign, challenge, 2fa
- key, apikey, api_key, api-key, jwt, token
- secret, security, secure
- ...
- 手动审查
- 如果找到API密钥，请在此处检查潜在的使用语法：https://github.com/streaak/keyhacks。
- 漏洞函数
- InnerHTML() - 如果找到此函数，意味着如果没有进行适当的净化，可能存在XSS的潜在机会。即使您的有效负载已经被净化，也不用担心。跟踪代码以找出净化发生的位置。研究它并尝试绕过净化。
- Postmessage() - 如果您阅读过我的先前文章（https://medium.com/techiepedia/what-are-sop-cors-and-ways-to-exploit-it-62a5e02100dc），您会注意到Postmessage()可能导致潜在的CORS问题。如果函数的第二个参数设置为*，那么您是幸运的人。查看我的先前文章以了解更多相关机制。
- String.prototype.search() - 这个函数看起来很正常。为什么它会是一个危险的函数呢？因为一些开发人员使用它来查找一个字符串在另一个字符串中的出现。然而，“.”在这个函数中被视为通配符。因此，如果此函数用作净化检查，您可以通过输入“.”来简单地绕过它。查看Filedescryptor的hackerone报告：https://hackerone.com/reports/129873
- 端点和参数
- 使用[LinkFinder](https://github.com/GerbenJavado/LinkFinder)和[JS Miner](https://github.com/PortSwigger/js-miner)。
- 漏洞库和依赖项
- 使用[Retire.js](https://retirejs.github.io/retire.js/)和[NPM](https://snyk.io/advisor/)（向下滚动到安全部分 > 所有版本链接）。
- 云URL
- 使用[JS Miner](https://github.com/PortSwigger/js-miner)。
- 子域名
- 使用[JS Miner](https://github.com/PortSwigger/js-miner)。
- 逻辑漏洞
- 获得情境意识：
- `use strict;`？
- Grep客户端控件：
- disable, enable, hidden, hide, show
- catch, finally, throw, try
- input, validate, verify, valid, correct, check, confirm, require, ..
- Grep非原始类型：
- function , =>
- class
### 动态分析

参考资料
- https://www.youtube.com/watch?v=_v8r_t4v6hQ
- https://blog.nvisium.com/angular-for-pentesters-part-1
- https://blog.nvisium.com/angular-for-pentesters-part-2

工具
- https://portswigger.net/burp/documentation/desktop/tools/dom-invader

#### 不常用的参考资料
- https://cyberchef.org/
- https://olajs.com/javascript-prettifier
- https://jshint.com/
- https://github.com/jshint/jshint/

## NodeJS
```
https://github.com/ajinabraham/nodejsscan
```
## Electron

Electron is a popular framework for building cross-platform desktop applications using web technologies such as HTML, CSS, and JavaScript. It allows developers to create native-like applications for Windows, macOS, and Linux using a single codebase.

### Security Considerations

When conducting a code review of an Electron application, there are several security considerations to keep in mind:

1. **Remote Code Execution (RCE)**: Electron applications can execute remote code, which can introduce security vulnerabilities if not properly handled. Review the code for any instances where remote code is executed and ensure that proper security measures, such as input validation and sanitization, are in place.

2. **Electron APIs**: Electron provides a wide range of APIs that allow developers to access system resources and interact with the underlying operating system. Review the usage of these APIs to ensure that they are used securely and that any potential security risks, such as privilege escalation or unauthorized access, are mitigated.

3. **File System Access**: Electron applications have access to the file system, which can be a potential security risk if not properly controlled. Review the code for any file system operations and ensure that proper access controls and input validation are implemented to prevent unauthorized access or file manipulation.

4. **Network Communication**: Electron applications can communicate with remote servers and APIs. Review the code for any network communication and ensure that secure protocols, such as HTTPS, are used to protect sensitive data in transit. Additionally, validate any user input used in network requests to prevent common security vulnerabilities such as SQL injection or cross-site scripting (XSS).

5. **Third-Party Dependencies**: Electron applications often rely on third-party dependencies, such as npm packages. Review the usage of these dependencies and ensure that they are up to date and free from known security vulnerabilities. Use tools like npm audit to identify and address any security issues.

### Code Review Tools

There are several code review tools that can be used to assist in the review of Electron applications:

1. **Electronegativity**: Electronegativity is a static analysis tool specifically designed for Electron applications. It scans the codebase for potential security vulnerabilities and provides actionable recommendations for remediation.

2. **ESLint**: ESLint is a popular JavaScript linter that can be configured to enforce security best practices. It can help identify potential security issues, such as unsafe code patterns or insecure API usage, during the code review process.

3. **Dependency Checkers**: Tools like npm audit or Snyk can be used to identify known security vulnerabilities in the application's dependencies. These tools can help ensure that all third-party packages used in the Electron application are free from known vulnerabilities.

4. **Manual Code Review**: While automated tools can assist in the code review process, a manual code review is still essential to identify any potential security issues that may not be caught by automated tools. Review the codebase thoroughly, paying attention to areas such as input validation, authentication, and authorization.

By considering these security considerations and utilizing code review tools, you can help ensure the security of Electron applications and mitigate potential vulnerabilities.
```
https://github.com/doyensec/electronegativity
```
## Python

Python is a widely used programming language for web development, data analysis, artificial intelligence, and more. It is known for its simplicity and readability, making it a popular choice among developers.

### Code Review Tools

When conducting a code review in Python, there are several tools that can help identify potential vulnerabilities and improve the overall quality of the code. Here are some commonly used code review tools for Python:

1. **Pylint**: Pylint is a static code analysis tool that checks for errors, coding standards, and potential bugs in Python code. It provides detailed reports and can be integrated with various IDEs.

2. **Bandit**: Bandit is a security-focused code analysis tool specifically designed for Python. It scans for common security issues such as SQL injections, cross-site scripting (XSS), and hardcoded passwords.

3. **Pyflakes**: Pyflakes is a lightweight static analysis tool that focuses on finding errors in Python code. It checks for unused variables, undefined names, and other common mistakes.

4. **Mypy**: Mypy is a static type checker for Python that helps catch type-related errors. It can be used to enforce type annotations and improve code quality.

5. **Coverage.py**: Coverage.py is a code coverage tool that measures the extent to which your Python code is tested. It helps identify areas of code that are not covered by tests, allowing you to improve test coverage.

6. **Radon**: Radon is a Python code complexity analyzer that calculates various metrics such as cyclomatic complexity and maintainability index. It helps identify complex code that may be difficult to understand and maintain.

These code review tools can be used individually or in combination to ensure that your Python code is secure, efficient, and maintainable. By incorporating them into your development process, you can catch potential issues early on and deliver higher quality code.
```bash
# bandit
https://github.com/PyCQA/bandit
# pyt
https://github.com/python-security/pyt
```
## .NET

### Code Review Tools

#### .NET反编译器

- **dnSpy** - 一个开源的.NET反编译器和调试器，可以用于分析和修改.NET程序集。

#### .NET代码分析工具

- **SonarQube** - 一个开源的代码质量管理平台，可以用于分析和评估.NET代码的质量。

#### .NET代码审查工具

- **Roslynator** - 一个开源的.NET代码分析工具，可以用于自动化代码审查和修复。

#### .NET代码漏洞扫描工具

- **Security Code Scan** - 一个开源的Visual Studio扩展，可以用于扫描.NET代码中的安全漏洞。

#### .NET代码混淆工具

- **ConfuserEx** - 一个开源的.NET代码混淆工具，可以用于保护.NET应用程序免受逆向工程攻击。

#### .NET代码覆盖率工具

- **OpenCover** - 一个开源的.NET代码覆盖率工具，可以用于测量代码的测试覆盖率。

#### .NET代码审计工具

- **CodeQL** - 一个强大的代码审计工具，可以用于分析和发现.NET代码中的安全漏洞。

#### .NET代码静态分析工具

- **ReSharper** - 一个商业化的.NET代码静态分析工具，可以用于提供代码建议和自动化重构。

#### .NET代码漏洞挖掘工具

- **PeachPie** - 一个开源的.NET代码漏洞挖掘工具，可以用于发现和利用.NET应用程序中的漏洞。

#### .NET代码漏洞修复工具

- **Microsoft.CodeAnalysis.FxCopAnalyzers** - 一个开源的.NET代码漏洞修复工具，可以用于自动修复.NET代码中的安全漏洞。

#### .NET代码安全审计工具

- **Security Code Scan** - 一个开源的.NET代码安全审计工具，可以用于发现和修复.NET代码中的安全问题。

#### .NET代码性能分析工具

- **dotTrace** - 一个商业化的.NET代码性能分析工具，可以用于分析和优化.NET应用程序的性能。

#### .NET代码漏洞检测工具

- **Fortify** - 一个商业化的.NET代码漏洞检测工具，可以用于发现和修复.NET代码中的安全漏洞。

#### .NET代码漏洞扫描工具

- **Veracode** - 一个商业化的.NET代码漏洞扫描工具，可以用于发现和修复.NET代码中的安全漏洞。

#### .NET代码安全扫描工具

- **Checkmarx** - 一个商业化的.NET代码安全扫描工具，可以用于发现和修复.NET代码中的安全问题。

#### .NET代码漏洞分析工具

- **AppScan** - 一个商业化的.NET代码漏洞分析工具，可以用于分析和修复.NET代码中的安全漏洞。

#### .NET代码漏洞挖掘工具

- **RIPS** - 一个商业化的.NET代码漏洞挖掘工具，可以用于发现和利用.NET应用程序中的漏洞。

#### .NET代码漏洞修复工具

- **Coverity** - 一个商业化的.NET代码漏洞修复工具，可以用于自动修复.NET代码中的安全漏洞。

#### .NET代码安全审计工具

- **HP Fortify** - 一个商业化的.NET代码安全审计工具，可以用于发现和修复.NET代码中的安全问题。

#### .NET代码性能分析工具

- **ANTS Performance Profiler** - 一个商业化的.NET代码性能分析工具，可以用于分析和优化.NET应用程序的性能。

#### .NET代码漏洞检测工具

- **IBM Security AppScan** - 一个商业化的.NET代码漏洞检测工具，可以用于发现和修复.NET代码中的安全漏洞。

#### .NET代码漏洞扫描工具

- **Qualys** - 一个商业化的.NET代码漏洞扫描工具，可以用于发现和修复.NET代码中的安全漏洞。

#### .NET代码安全扫描工具

- **WhiteSource** - 一个商业化的.NET代码安全扫描工具，可以用于发现和修复.NET代码中的安全问题。
```bash
# dnSpy
https://github.com/0xd4d/dnSpy

# .NET compilation
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe test.cs
```
## Java

Java是一种广泛使用的编程语言，常用于开发Web应用程序和企业级应用程序。在进行代码审查时，以下工具可以帮助发现潜在的安全漏洞和代码质量问题。

### FindBugs

FindBugs是一个静态分析工具，用于查找Java代码中的常见错误和潜在的安全漏洞。它可以检测到空指针引用、资源未关闭、不安全的类型转换等问题。

使用方法：

```bash
$ findbugs -textui <jar文件>
```

### PMD

PMD是一个源代码静态分析工具，用于查找Java代码中的潜在问题和不良实践。它可以检测到未使用的变量、重复的代码、不必要的条件等问题。

使用方法：

```bash
$ pmd -d <源代码目录> -f text
```

### Checkstyle

Checkstyle是一个用于检查Java代码风格和编码规范的工具。它可以检测到缩进错误、命名规范不一致、代码注释不规范等问题。

使用方法：

```bash
$ checkstyle -c <配置文件> <源代码目录>
```

### SonarQube

SonarQube是一个用于代码质量管理的开源平台。它可以检测到代码重复、安全漏洞、代码覆盖率等问题，并提供详细的报告和建议。

使用方法：

1. 安装SonarQube服务器。
2. 在项目中集成SonarQube插件。
3. 运行SonarQube分析。

### FindSecBugs

FindSecBugs是一个基于FindBugs的插件，专门用于查找Java代码中的安全漏洞。它可以检测到不安全的加密算法、XSS漏洞、SQL注入等问题。

使用方法：

```bash
$ findsecbugs -textui <jar文件>
```

以上工具可以帮助您在进行Java代码审查时发现潜在的安全漏洞和代码质量问题。
```bash
# JD-Gui
https://github.com/java-decompiler/jd-gui

# Java compilation step-by-step
javac -source 1.8 -target 1.8 test.java
mkdir META-INF
echo "Main-Class: test" > META-INF/MANIFEST.MF
jar cmvf META-INF/MANIFEST.MF test.jar test.class
```
| 任务            | 命令                                                     |
| --------------- | --------------------------------------------------------- |
| 执行 Jar       | java -jar \[jar]                                          |
| 解压缩 Jar     | unzip -d \[output directory] \[jar]                       |
| 创建 Jar       | jar -cmf META-INF/MANIFEST.MF \[output jar] \*            |
| Base64 SHA256   | sha256sum \[file] \| cut -d' ' -f1 \| xxd -r -p \| base64 |
| 删除签名       | rm META-INF/_.SF META-INF/_.RSA META-INF/\*.DSA           |
| 从 Jar 中删除  | zip -d \[jar] \[file to remove]                           |
| 反编译类       | procyon -o . \[path to class]                             |
| 反编译 Jar     | procyon -jar \[jar] -o \[output directory]                |
| 编译类         | javac \[path to .java file]                               |

## 进行
```bash
https://github.com/securego/gosec
```
## PHP

[Psalm](https://phpmagazine.net/2018/12/find-errors-in-your-php-applications-with-psalm.html)和[PHPStan](https://phpmagazine.net/2020/09/phpstan-pro-edition-launched.html)。

### Wordpress插件

[https://www.pluginvulnerabilities.com/plugin-security-checker/](https://www.pluginvulnerabilities.com/plugin-security-checker/)

## Solidity

* [https://www.npmjs.com/package/solium](https://www.npmjs.com/package/solium)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks云 ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- 你在一家**网络安全公司**工作吗？你想在HackTricks中看到你的**公司广告**吗？或者你想获得**PEASS的最新版本或下载PDF格式的HackTricks**吗？请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！

- 发现我们的独家[NFTs](https://opensea.io/collection/the-peass-family)收藏品[**The PEASS Family**](https://opensea.io/collection/the-peass-family)

- 获得[**官方PEASS和HackTricks周边产品**](https://peass.creator-spring.com)

- **加入**[**💬**](https://emojipedia.org/speech-balloon/) [**Discord群组**](https://discord.gg/hRep4RUj7f)或[**电报群组**](https://t.me/peass)，或在**Twitter**上**关注**我[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**

- **通过向[hacktricks repo](https://github.com/carlospolop/hacktricks)和[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)提交PR来分享你的黑客技巧**。

</details>
