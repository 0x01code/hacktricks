# コードレビューツール

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ企業**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>

## 一般

* [**https://owasp.org/www-community/Source\_Code\_Analysis\_Tools**](https://owasp.org/www-community/Source\_Code\_Analysis\_Tools)\

* [**https://github.com/analysis-tools-dev/static-analysis**](https://github.com/analysis-tools-dev/static-analysis)
```bash
https://www.sonarqube.org/downloads/
https://deepsource.io/signup/
https://github.com/pyupio/safety
https://github.com/returntocorp/semgrep
https://github.com/WhaleShark-Team/cobra
https://github.com/insidersec/insider

# Find interesting strings
https://github.com/s0md3v/hardcodes
https://github.com/micha3lb3n/SourceWolf
https://libraries.io/pypi/detect-secrets
```
## JavaScript
### Discovery
1. Burp:
- スパイダーとコンテンツの発見
- Sitemap > フィルター
- Sitemap > ドメインを右クリック > Engagement tools > スクリプトの検索
2. [WaybackURLs](https://github.com/tomnomnom/waybackurls):
- `waybackurls <domain> |grep -i "\.js" |sort -u`
### 静的解析
#### Unminimize/Beautify/Prettify
https://prettier.io/playground/
https://beautifier.io/
#### Deobfuscate/Unpack
__注意__: 完全に復号化することはできない場合があります。
1. .map ファイルを見つけて使用する:
- .map ファイルが公開されている場合、簡単に復号化できます。
- 一般的に、foo.js.map は foo.js にマップされます。手動で探してください。
- [JS Miner](https://github.com/PortSwigger/js-miner) を使用して探します。
- アクティブスキャンを実行してください。
- '[Tips/Notes](https://github.com/minamo7sen/burp-JS-Miner/wiki#tips--notes)' を読んでください。
- 見つかった場合、[Maximize](https://www.npmjs.com/package/maximize) を使用して復号化します。
2. .map ファイルがない場合、JSnice を試してみてください:
- 参考: http://jsnice.org/ & https://www.npmjs.com/package/jsnice
- ヒント:
- jsnice.org を使用する場合、「Nicify JavaScript」ボタンの横にあるオプションボタンをクリックし、「Infer types」を選択解除して、コードにコメントを混在させないようにします。
- スクリプトの前に空行を残さないようにしてください。これは復号化プロセスに影響を与え、正確な結果を得ることができなくなる可能性があります。
3. console.log(<packerReturnVariable>); を使用する:
- 最後に返される値を見つけて、`console.log(<packerReturnVariable>);` に変更します。これにより、復号化された JavaScript が実行される代わりにコンソールに出力されます。
- 次に、変更された（まだ難読化された）JavaScript を https://jsconsole.com/ に貼り付けて、コンソールに復号化された JavaScript が表示されるか確認します。
- 最後に、復号化された出力を https://prettier.io/playground/ に貼り付けて、解析のために整形します。
- __注意__: まだパックされた（しかし異なる）JavaScript が表示される場合、再帰的にパックされている可能性があります。プロセスを繰り返してください。
#### 分析
参考:
https://medium.com/techiepedia/javascript-code-review-guide-for-bug-bounty-hunters-c95a8aa7037a

以下を探してください:
- アンチデバッグのローディング
- Angular: [enableProdMode](https://blog.nvisium.com/angular-for-pentesters-part-2)
- シークレット
- 使用:
- [JS Miner](https://github.com/PortSwigger/js-miner)
- [RegHex](https://github.com/l4yton/RegHex) パターン
- [gf](https://github.com/tomnomnom/gf/tree/master/examples) パターン
- 関連する辞書のパターンを grep する:
- pass, user, admin
- auth, login, sign, challenge, 2fa
- key, apikey, api_key, api-key, jwt, token
- secret, security, secure
- ...
- 手動でレビューする
- API キーが見つかった場合、潜在的な使用構文を確認するためにここをチェックしてください: https://github.com/streaak/keyhacks.
- 脆弱な関数
- InnerHTML() - これを見つけた場合、適切なサニタイズが行われていない場合、XSS の可能性があります。ペイロードがサニタイズされていても心配しないでください。コードを追跡して、サニタイズが行われている場所を特定してください。それを研究し、サニタイズを回避しようとしてください。
- Postmessage() - 以前の投稿 (https://medium.com/techiepedia/what-are-sop-cors-and-ways-to-exploit-it-62a5e02100dc) を読んだことがあれば、Postmessage() が潜在的な CORS 問題につながる可能性があることに気付いたでしょう。関数の第2パラメータが * に設定されている場合、ラッキーです。詳細については、以前の投稿をチェックしてメカニズムを理解してください。
- String.prototype.search() - この関数は普通に見えます。なぜ危険な関数なのでしょうか？それは、一部の開発者がこの関数を使用して、1つの文字列内の別の文字列の出現を検索するために使用しているためです。しかし、この関数では「.」がワイルドカードとして扱われます。したがって、この関数がサニタイズチェックとして使用されている場合、単純に「.」を入力することでバイパスできます。Filedescryptor の hackerone レポートをチェックしてください: https://hackerone.com/reports/129873
- エンドポイントとパラメータ
- [LinkFinder](https://github.com/GerbenJavado/LinkFinder) & [JS Miner](https://github.com/PortSwigger/js-miner) を使用してください。
- 脆弱なライブラリと依存関係
- [Retire.js](https://retirejs.github.io/retire.js/) と [NPM](https://snyk.io/advisor/) (セキュリティセクションまでスクロール > all versions リンク) を使用してください。
- クラウドの URL
- [JS Miner](https://github.com/PortSwigger/js-miner) を使用してください。
- サブドメイン
- [JS Miner](https://github.com/PortSwigger/js-miner) を使用してください。
- ロジックの欠陥
- 状況認識を得る:
- `use strict;`?
- クライアントサイドのコントロールを grep する:
- disable, enable, hidden, hide, show
- catch, finally, throw, try
- input, validate, verify, valid, correct, check, confirm, require, ..
- プリミティブでないものを grep する:
- function , =>
- class
### 動的解析

参考文献
- https://www.youtube.com/watch?v=_v8r_t4v6hQ
- https://blog.nvisium.com/angular-for-pentesters-part-1
- https://blog.nvisium.com/angular-for-pentesters-part-2

ツール
- https://portswigger.net/burp/documentation/desktop/tools/dom-invader

#### あまり使われていない参考文献
- https://cyberchef.org/
- https://olajs.com/javascript-prettifier
- https://jshint.com/
- https://github.com/jshint/jshint/

## NodeJS
```
https://github.com/ajinabraham/nodejsscan
```
## Electron

Electronは、クロスプラットフォームのデスクトップアプリケーションを構築するためのフレームワークです。HTML、CSS、JavaScriptを使用してアプリケーションを開発することができます。Electronは、Node.jsとChromiumをベースにしており、Web技術を使用してネイティブアプリケーションを作成することができます。

Electronアプリケーションのセキュリティを確保するためには、以下のポイントに注意する必要があります。

- 最新のバージョンのElectronを使用することで、セキュリティの脆弱性を最小限に抑えることができます。
- セキュリティのベストプラクティスに従って、アプリケーションの設定を適切に行いましょう。
- クロスオリジンリソース共有（CORS）の設定を適切に行い、不正なリクエストを防ぎましょう。
- インタープロセス通信（IPC）のセキュリティを確保するために、適切な認証と権限管理を実装しましょう。
- 外部モジュールやパッケージの使用には注意し、信頼性のあるソースからのみ取得しましょう。

Electronアプリケーションのコードレビューを行う際には、以下のツールを使用することができます。

- **Electronegativity**: Electronアプリケーションのセキュリティ診断を行うための静的解析ツールです。脆弱性やセキュリティの問題を検出し、修正するためのガイダンスを提供します。
- **Electron Security Checklist**: Electronアプリケーションのセキュリティを確保するためのチェックリストです。セキュリティのベストプラクティスに従って、アプリケーションの設定を確認することができます。
- **ESLint**: JavaScriptの静的解析ツールであり、コードの品質やセキュリティの問題を検出することができます。Electronアプリケーションのコードレビューに使用することができます。

これらのツールを使用して、Electronアプリケーションのセキュリティを確保し、脆弱性やセキュリティの問題を特定して修正することが重要です。
```
https://github.com/doyensec/electronegativity
```
## Python

Pythonは、人気のあるプログラミング言語であり、Webアプリケーションの開発に広く使用されています。Pythonのコードレビューツールを使用することで、セキュリティ上の脆弱性を特定し、修正することができます。

### Bandit

Banditは、Pythonコードのセキュリティ上の問題を検出するためのツールです。静的解析を使用して、潜在的な脆弱性やセキュリティ上のベストプラクティスに違反するコードを見つけることができます。

```bash
$ bandit -r /path/to/python/code
```

### Pylint

Pylintは、Pythonコードの品質とスタイルを評価するためのツールです。コードの構文エラーやスタイルガイドに違反する箇所を特定し、修正することができます。

```bash
$ pylint /path/to/python/code
```

### Safety

Safetyは、Pythonプロジェクトの依存関係にセキュリティ上の脆弱性があるかどうかをチェックするためのツールです。プロジェクトの依存関係をスキャンし、脆弱性のあるパッケージを特定することができます。

```bash
$ safety check
```

### Pyre

Pyreは、Pythonコードの型チェックを行うためのツールです。静的型チェックを使用して、コード内の型エラーや不整合を特定することができます。

```bash
$ pyre --source-directory=/path/to/python/code
```

これらのツールを使用して、Pythonコードのセキュリティと品質を向上させることができます。
```bash
# bandit
https://github.com/PyCQA/bandit
# pyt
https://github.com/python-security/pyt
```
## .NET

### Code Review Tools

#### .NET Reflector

[.NET Reflector](https://www.red-gate.com/products/dotnet-development/reflector/) is a popular code review tool for .NET applications. It allows you to decompile and analyze .NET assemblies, providing insights into the source code and internal workings of the application. With .NET Reflector, you can easily navigate through the code, view class hierarchies, and examine method implementations. It also supports debugging and integration with Visual Studio.

#### JustDecompile

[JustDecompile](https://www.telerik.com/products/decompiler.aspx) is another powerful code review tool for .NET. It enables you to decompile .NET assemblies and explore their contents. JustDecompile offers a user-friendly interface with features like code navigation, search functionality, and syntax highlighting. It also allows you to export decompiled code to various formats, making it convenient for further analysis and documentation.

#### ILspy

[ILspy](https://github.com/icsharpcode/ILSpy) is an open-source .NET assembly browser and decompiler. It provides a simple and intuitive interface for reviewing .NET code. With ILspy, you can decompile assemblies, navigate through the code, and analyze the implementation details. It supports various output formats, including C#, VB.NET, and XAML. Additionally, ILspy offers plugins for extending its functionality.

#### dnSpy

[dnSpy](https://github.com/dnSpy/dnSpy) is a versatile .NET debugger and assembly editor that can be used for code review purposes. It allows you to decompile and debug .NET assemblies, making it easier to understand the application's behavior and identify potential vulnerabilities. dnSpy offers features like code navigation, breakpoints, and variable inspection. It also supports editing and recompiling assemblies, enabling you to modify the code for testing or analysis.

#### Visual Studio

[Visual Studio](https://visualstudio.microsoft.com/) is a comprehensive integrated development environment (IDE) for .NET applications. While primarily used for development, it can also be utilized for code review purposes. Visual Studio provides powerful tools for analyzing and understanding .NET code, including features like code navigation, debugging, and performance profiling. It supports various languages and frameworks, making it suitable for reviewing different types of .NET applications.

#### Conclusion

These code review tools for .NET can greatly assist in analyzing and understanding the inner workings of .NET applications. By decompiling and reviewing the source code, you can identify potential security vulnerabilities, understand the application's logic, and gain insights into its implementation details. Whether you choose a commercial tool like .NET Reflector or opt for open-source alternatives like ILspy and dnSpy, these tools can be valuable assets in your code review arsenal.
```bash
# dnSpy
https://github.com/0xd4d/dnSpy

# .NET compilation
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe test.cs
```
## Java

Javaは、オブジェクト指向プログラミング言語であり、広く使用されています。Javaのコードレビューには、いくつかのツールがあります。

### 1. FindBugs

FindBugsは、Javaプログラムのバグや潜在的な問題を検出するための静的解析ツールです。コードの品質を向上させるために使用されます。

### 2. PMD

PMDは、Javaコードの静的解析を行い、コーディング規約に違反する箇所を見つけるためのツールです。コードの一貫性を確保するために使用されます。

### 3. Checkstyle

Checkstyleは、Javaコードのスタイルと品質をチェックするためのツールです。コーディング規約に準拠しているかどうかを確認するために使用されます。

### 4. SonarQube

SonarQubeは、Javaコードの品質を評価するための総合的なツールです。コードのバグ、セキュリティの脆弱性、コーディング規約の違反などを検出します。

これらのツールを使用してJavaコードをレビューすることで、バグやセキュリティの問題を特定し、コードの品質を向上させることができます。
```bash
# JD-Gui
https://github.com/java-decompiler/jd-gui

# Java compilation step-by-step
javac -source 1.8 -target 1.8 test.java
mkdir META-INF
echo "Main-Class: test" > META-INF/MANIFEST.MF
jar cmvf META-INF/MANIFEST.MF test.jar test.class
```
| タスク           | コマンド                                                 |
| --------------- | --------------------------------------------------------- |
| Jarを実行する     | java -jar \[jar]                                          |
| Jarを解凍する     | unzip -d \[出力ディレクトリ] \[jar]                       |
| Jarを作成する     | jar -cmf META-INF/MANIFEST.MF \[出力jar] \*            |
| Base64 SHA256   | sha256sum \[ファイル] \| cut -d' ' -f1 \| xxd -r -p \| base64 |
| 署名を削除する  | rm META-INF/_.SF META-INF/_.RSA META-INF/\*.DSA           |
| Jarから削除する | zip -d \[jar] \[削除するファイル]                           |
| クラスを逆コンパイルする | procyon -o . \[クラスへのパス]                             |
| Jarを逆コンパイルする   | procyon -jar \[jar] -o \[出力ディレクトリ]                |
| クラスをコンパイルする   | javac \[.javaファイルへのパス]                               |

## Go
```bash
https://github.com/securego/gosec
```
## PHP

[Psalm](https://phpmagazine.net/2018/12/find-errors-in-your-php-applications-with-psalm.html)と[PHPStan](https://phpmagazine.net/2020/09/phpstan-pro-edition-launched.html)。

### Wordpressプラグイン

[https://www.pluginvulnerabilities.com/plugin-security-checker/](https://www.pluginvulnerabilities.com/plugin-security-checker/)

## Solidity

* [https://www.npmjs.com/package/solium](https://www.npmjs.com/package/solium)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ企業で働いていますか？** HackTricksで**会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見しましょう。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- **[💬](https://emojipedia.org/speech-balloon/) Discordグループ**または**[telegramグループ](https://t.me/peass)**に参加するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ハッキングのトリックを共有するには、[hacktricks repo](https://github.com/carlospolop/hacktricks)と[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>
