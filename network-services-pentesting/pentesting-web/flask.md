# Flask

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? Ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (9) (1) (2).png" alt=""><figcaption></figcaption></figure>

Utilisez [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) pour construire et **automatiser des workflows** aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Obtenez un acc√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

**Probablement, si vous jouez √† un CTF, une application Flask sera li√©e √†** [**SSTI**](../../pentesting-web/ssti-server-side-template-injection/)**.**

## Cookies

Le nom de session par d√©faut pour les cookies est **`session`**.

### D√©codeur

D√©codeur de cookies Flask en ligne : [https://www.kirsle.net/wizards/flask-session.cgi](https://www.kirsle.net/wizards/flask-session.cgi)

#### Manuel

Obtenez la premi√®re partie du cookie jusqu'au premier point et d√©codez-le en Base64>
```bash
echo "ImhlbGxvIg" | base64 -d
```
Le cookie est √©galement sign√© √† l'aide d'un mot de passe

### **Flask-Unsign**

Outil en ligne de commande pour r√©cup√©rer, d√©coder, forcer par la m√©thode brute et cr√©er des cookies de session d'une application Flask en devinant les cl√©s secr√®tes.

{% embed url="https://pypi.org/project/flask-unsign/" %}
```bash
pip3 install flask-unsign
```
#### **D√©coder le Cookie**

To decode a cookie, you can use various tools and techniques. One common method is to use a base64 decoder to decode the cookie value. Base64 encoding is commonly used to encode binary data into ASCII characters, and it is often used to encode cookie values.

Here is an example of how you can decode a cookie using Python:

```python
import base64

def decode_cookie(cookie):
    decoded_cookie = base64.b64decode(cookie)
    return decoded_cookie.decode('utf-8')

cookie_value = 'SGVsbG8gV29ybGQh'
decoded_value = decode_cookie(cookie_value)
print(decoded_value)
```

In this example, we import the `base64` module and define a function called `decode_cookie` that takes a cookie value as input. The function uses the `b64decode` function from the `base64` module to decode the cookie value. We then return the decoded value as a UTF-8 encoded string.

We create a variable called `cookie_value` and assign it the value of the cookie we want to decode. We then call the `decode_cookie` function with `cookie_value` as the argument and assign the returned decoded value to a variable called `decoded_value`. Finally, we print the decoded value.

Keep in mind that decoding a cookie does not necessarily mean you will be able to understand its contents. Cookies can be encrypted or encoded in various ways, so decoding a cookie may not always provide meaningful information. It is important to analyze the decoded value and understand the context in which the cookie is used to gain insights from it.
```bash
flask-unsign --decode --cookie 'eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8'
```
#### **Brute Force**

La technique de **Brute Force** est une m√©thode d'attaque utilis√©e pour essayer toutes les combinaisons possibles de mots de passe jusqu'√† ce que le bon soit trouv√©. C'est une approche simple mais efficace pour contourner les mesures de s√©curit√© et acc√©der √† un syst√®me ou √† un compte. Les attaquants utilisent souvent des outils automatis√©s pour effectuer des attaques de force brute, ce qui leur permet de tester rapidement de nombreuses combinaisons en peu de temps. Pour se prot√©ger contre les attaques de force brute, il est important d'utiliser des mots de passe forts et de mettre en place des mesures de s√©curit√© suppl√©mentaires telles que des verrouillages de compte apr√®s un certain nombre de tentatives infructueuses.
```bash
flask-unsign --wordlist /usr/share/wordlists/rockyou.txt --unsign --cookie '<cookie>' --no-literal-eval
```
#### **Signature**

Une signature est une m√©thode utilis√©e pour v√©rifier l'int√©grit√© et l'authenticit√© des donn√©es. Elle est g√©n√©ralement utilis√©e pour s'assurer qu'un message n'a pas √©t√© modifi√© pendant le transit et qu'il provient bien de la source pr√©tendue.

Dans le contexte du d√©veloppement web, la signature est souvent utilis√©e pour prot√©ger les cookies de session. Lorsqu'un cookie est sign√©, il est crypt√© avec une cl√© secr√®te et une signature est ajout√©e pour v√©rifier son int√©grit√©. Lorsque le serveur re√ßoit le cookie, il peut v√©rifier la signature pour s'assurer que le cookie n'a pas √©t√© modifi√©.

Flask, un framework web populaire en Python, fournit une fonctionnalit√© int√©gr√©e pour signer les cookies. Pour signer un cookie dans Flask, vous pouvez utiliser la m√©thode `set_signed_cookie()` de l'objet `response`. Cette m√©thode prend le nom du cookie, sa valeur et une cl√© secr√®te comme arguments.

Voici un exemple de code qui signe un cookie dans Flask :

```python
from flask import Flask, make_response

app = Flask(__name__)

@app.route('/')
def index():
    response = make_response('Hello, World!')
    response.set_signed_cookie('session', '123456', secret='mysecretkey')
    return response

if __name__ == '__main__':
    app.run()
```

Dans cet exemple, le cookie de session est sign√© avec la cl√© secr√®te "mysecretkey". Lorsque le client envoie le cookie au serveur, Flask v√©rifie la signature pour s'assurer que le cookie n'a pas √©t√© modifi√©.

La signature des cookies est une mesure de s√©curit√© importante pour prot√©ger les donn√©es sensibles des utilisateurs. Il est essentiel de choisir une cl√© secr√®te forte et de garder cette cl√© confidentielle pour √©viter toute compromission de la signature.
```bash
flask-unsign --sign --cookie "{'logged_in': True}" --secret 'CHANGEME'
```
#### Signature en utilisant des versions obsol√®tes (anciennes versions)

Lors de l'√©valuation de la s√©curit√© d'une application Flask, il est important de v√©rifier si elle utilise des versions obsol√®tes qui pourraient pr√©senter des vuln√©rabilit√©s connues. Les versions obsol√®tes de Flask peuvent √™tre sujettes √† des attaques de contournement de s√©curit√© ou √† des failles connues qui pourraient √™tre exploit√©es par des attaquants.

Pour identifier si une application Flask utilise une version obsol√®te, vous pouvez effectuer les √©tapes suivantes :

1. Recherchez la version de Flask utilis√©e par l'application. Cela peut √™tre trouv√© dans le fichier `requirements.txt` ou dans le fichier `setup.py` de l'application.

2. Comparez la version de Flask avec la derni√®re version disponible sur le site officiel de Flask. Si la version utilis√©e par l'application est inf√©rieure √† la derni√®re version disponible, cela indique qu'elle utilise une version obsol√®te.

3. Consultez la documentation de Flask pour identifier les vuln√©rabilit√©s connues dans les versions obsol√®tes. Si des vuln√©rabilit√©s sont r√©pertori√©es pour la version utilis√©e par l'application, cela indique un risque potentiel.

Si vous identifiez l'utilisation d'une version obsol√®te de Flask, il est recommand√© de mettre √† jour l'application vers la derni√®re version stable. Les mises √† jour de Flask incluent souvent des correctifs de s√©curit√© importants qui peuvent pr√©venir les attaques connues.

Il est √©galement important de noter que la mise √† jour de Flask peut n√©cessiter des modifications dans le code de l'application pour s'adapter aux nouvelles fonctionnalit√©s ou aux changements de comportement. Par cons√©quent, il est recommand√© de tester soigneusement l'application apr√®s la mise √† jour pour s'assurer qu'elle fonctionne correctement.
```bash
flask-unsign --sign --cookie "{'logged_in': True}" --secret 'CHANGEME' --legacy
```
### **RIPsession**

Outil en ligne de commande pour effectuer une attaque par force brute sur des sites web en utilisant des cookies cr√©√©s avec flask-unsign.

{% embed url="https://github.com/Tagvi/ripsession" %}
```bash
ripsession -u 10.10.11.100 -c "{'logged_in': True, 'username': 'changeMe'}" -s password123 -f "user doesn't exist" -w wordlist.txt
```
### SQLi dans le cookie de session Flask avec SQLmap

[**Cet exemple**](../../pentesting-web/sql-injection/sqlmap/#eval) utilise l'option `eval` de sqlmap pour **automatiquement signer les charges utiles de sqlmap** pour Flask en utilisant un secret connu.

<figure><img src="../../.gitbook/assets/image (9) (1) (2).png" alt=""><figcaption></figcaption></figure>

Utilisez [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) pour cr√©er et **automatiser facilement des flux de travail** aliment√©s par les outils communautaires les plus avanc√©s au monde.\
Obtenez un acc√®s aujourd'hui :

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? Ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
