# CloudFlare Ortaya Çıkarma

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini keşfedin**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuzu
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)'da **takip edin**.
* **Hacking püf noktalarınızı paylaşarak PR'lar göndererek** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına katkıda bulunun.

</details>

## Cloudflare Ortaya Çıkarmak İçin Ortak Teknikler

* Alan adının **geçmiş DNS kayıtlarını veren bir hizmeti** kullanabilirsiniz. Belki web sayfası daha önce kullanılan bir IP adresinde çalışıyor.
* Aynı şekilde, **geçmiş SSL sertifikalarını kontrol ederek** orijin IP adresine işaret edebileceğiniz sonuçlar elde edebilirsiniz.
* Ayrıca, **IP'lere doğrudan işaret eden diğer alt alanların DNS kayıtlarını kontrol edin**, çünkü diğer alt alanlar aynı sunucuya işaret ediyor olabilir (belki FTP, posta veya başka bir hizmet sunmak için).
* Eğer bir **web uygulaması içinde SSRF bulursanız**, bunu kötüye kullanarak sunucunun IP adresini elde edebilirsiniz.
* Tarayıcılarda shodan (ve belki google ve benzeri?) gibi bir yerde web sayfasının benzersiz bir dizesini arayın. Belki bu içeriğe sahip bir IP adresi bulabilirsiniz.
* Benzer şekilde, benzersiz bir dize aramak yerine favicon simgesini aramak için [https://github.com/karma9874/CloudFlare-IP](https://github.com/karma9874/CloudFlare-IP) veya [https://github.com/pielco11/fav-up](https://github.com/pielco11/fav-up) aracını kullanabilirsiniz.
* Bu sık sık çalışmayabilir çünkü sunucu IP adresiyle erişildiğinde aynı yanıtı göndermelidir, ancak asla bilemezsiniz.

## Cloudflare Ortaya Çıkarmak İçin Araçlar

* Alan adını [http://www.crimeflare.org:82/cfs.html](http://www.crimeflare.org:82/cfs.html) veya [https://crimeflare.herokuapp.com](https://crimeflare.herokuapp.com) içinde arayın. Veya [CloudPeler](https://github.com/zidansec/CloudPeler) aracını kullanın (bu API'yi kullanan).
* Alan adını [https://leaked.site/index.php?resolver/cloudflare.0/](https://leaked.site/index.php?resolver/cloudflare.0/) içinde arayın.
* [**CloudFlair**](https://github.com/christophetd/CloudFlair), alan adını içeren Censys sertifikalarını arayacak, ardından bu sertifikalardaki IPv4'leri arayacak ve son olarak bu IP'lerdeki web sayfasına erişmeyi deneyecektir.
* [**CloakQuest3r**](https://github.com/spyboy-productions/CloakQuest3r): CloakQuest3r, Cloudflare ve diğer alternatifler tarafından korunan web sitelerinin gerçek IP adresini doğru bir şekilde belirlemek için özenle hazırlanmış güçlü bir Python aracıdır, geniş çapta benimsenen bir web güvenliği ve performans artırma hizmetidir. Temel misyonu, Cloudflare'ın koruyucu kalkanı arkasında gizlenen web sunucularının gerçek IP adresini doğru bir şekilde ayırt etmektir.
* [Censys](https://search.censys.io/)
* [Shodan](https://shodan.io/)
* [Bypass-firewalls-by-DNS-history](https://github.com/vincentcox/bypass-firewalls-by-DNS-history)
* Eğer web sayfasının bulunduğu potansiyel IP'lerin bir listesi varsa [https://github.com/hakluke/hakoriginfinder](https://github.com/hakluke/hakoriginfinder) kullanabilirsiniz.
```bash
# You can check if the tool is working with
prips 1.0.0.0/30 | hakoriginfinder -h one.one.one.one

# If you know the company is using AWS you could use the previous tool to search the
## web page inside the EC2 IPs
DOMAIN=something.com
WIDE_REGION=us
for ir in `curl https://ip-ranges.amazonaws.com/ip-ranges.json | jq -r '.prefixes[] | select(.service=="EC2") | select(.region|test("^us")) | .ip_prefix'`; do
echo "Checking $ir"
prips $ir | hakoriginfinder -h "$DOMAIN"
done
```
## Bulut altyapısından Cloudflare'ın ortaya çıkarılması

Unutmayın ki bu AWS makineleri için yapılmış olsa da, herhangi başka bir bulut sağlayıcı için de yapılabilir.

Bu sürecin daha iyi bir açıklaması için şuraya bakın:

{% embed url="https://trickest.com/blog/cloudflare-bypass-discover-ip-addresses-aws/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
```bash
# Find open ports
sudo masscan --max-rate 10000 -p80,443 $(curl -s https://ip-ranges.amazonaws.com/ip-ranges.json | jq -r '.prefixes[] | select(.service=="EC2") | .ip_prefix' | tr '\n' ' ') | grep "open"  > all_open.txt
# Format results
cat all_open.txt | sed 's,.*port \(.*\)/tcp on \(.*\),\2:\1,' | tr -d " " > all_open_formated.txt
# Search actual web pages
httpx -silent -threads 200 -l all_open_formated.txt -random-agent -follow-redirects -json -no-color -o webs.json
# Format web results and remove eternal redirects
cat webs.json | jq -r "select((.failed==false) and (.chain_status_codes | length) < 9) | .url" | sort -u > aws_webs.json

# Search via Host header
httpx -json -no-color -list aws_webs.json -header Host: cloudflare.malwareworld.com -threads 250 -random-agent -follow-redirects -o web_checks.json
```
## Cloudflare'ı Cloudflare Aracılığıyla Atlatma

### Doğrulanmış Köken Çekmeleri

Bu mekanizma, **Cloudflare'ın ters-proxy** sunucuları ile **köken** sunucusu arasındaki bağlantıları doğrulamak için **müşteri** [**SSL sertifikalarına**](https://socradar.io/how-to-monitor-your-ssl-certificates-expiration-easily-and-why/) **dayanır**, bu da **mTLS** olarak adlandırılır.

Müşterilerin kendi sertifikasını yapılandırmak yerine, Cloudflare'ın sertifikasını kullanarak Cloudflare'dan herhangi bir bağlantıya izin verebilirler, **kiracıdan bağımsız olarak**.

{% hint style="danger" %}
Bu nedenle, bir saldırgan sadece Cloudflare'ın sertifikasını kullanarak bir **alan adı belirleyebilir ve** bunu **kurban** alan adı **IP** adresine yönlendirebilir. Bu şekilde, kendi alanını tamamen korumasız bırakarak, Cloudflare gönderilen istekleri korumayacaktır.
{% endhint %}

Daha fazla bilgi [**burada**](https://socradar.io/cloudflare-protection-bypass-vulnerability-on-threat-actors-radar/).

### Cloudflare IP Adreslerini Beyaz Listeye Alma

Bu, **Cloudflare'ın dışından kaynaklanmayan bağlantıları reddedecektir** IP adres aralıklarından. Bu, bir saldırganın sadece **kendi alan adını Cloudflare'a yönlendirerek** kurbanın IP adresine saldırabileceği önceki kurulum için de savunmasızdır.

Daha fazla bilgi [**burada**](https://socradar.io/cloudflare-protection-bypass-vulnerability-on-threat-actors-radar/).

## Kazıma İçin Cloudflare'ı Atlatma

### Önbellek

Bazen sadece web sayfasını kazımak için Cloudflare'ı atlamak istersiniz. Bunun için bazı seçenekler vardır:

* Google önbelleğini kullanın: `https://webcache.googleusercontent.com/search?q=cache:https://www.petsathome.com/shop/en/pets/dog`
* [https://archive.org/web/](https://archive.org/web/) gibi diğer önbellek hizmetlerini kullanın

### Araçlar

Aşağıdaki gibi bazı araçlar, Cloudflare'ın kazımaya karşı korumasını atlamak için kullanılabilir (veya kullanılabilir):

* [https://github.com/sarperavci/CloudflareBypassForScraping](https://github.com/sarperavci/CloudflareBypassForScraping)

### Cloudflare Çözücüler

Birçok Cloudflare çözücü geliştirilmiştir:

* [FlareSolverr](https://github.com/FlareSolverr/FlareSolverr)
* [cloudscraper](https://github.com/VeNoMouS/cloudscraper) [Kılavuz burada](https://scrapeops.io/python-web-scraping-playbook/python-cloudscraper/)
* [cloudflare-scrape](https://github.com/Anorov/cloudflare-scrape)
* [CloudflareSolverRe](https://github.com/RyuzakiH/CloudflareSolverRe)
* [Cloudflare-IUAM-Solver](https://github.com/ninja-beans/cloudflare-iuam-solver)
* [cloudflare-bypass](https://github.com/devgianlu/cloudflare-bypass) \[Arşivlenmiş]
* [CloudflareSolverRe](https://github.com/RyuzakiH/CloudflareSolverRe)

### Güçlendirilmiş Başsız Tarayıcılar <a href="#option-4-scrape-with-fortified-headless-browsers" id="option-4-scrape-with-fortified-headless-browsers"></a>

Otomatik bir tarayıcı olarak algılanmayan bir başsız tarayıcı kullanın (bunu özelleştirmeniz gerekebilir). Bazı seçenekler şunlardır:

* **Puppeteer:** [Puppeteer](https://github.com/puppeteer/puppeteer) için [gizlilik eklentisi](https://github.com/berstend/puppeteer-extra/tree/master/packages/puppeteer-extra-plugin-stealth).
* **Playwright:** [Playwright](https://www.npmjs.com/package/playwright-stealth) için [gizlilik eklentisi](https://github.com/berstend/puppeteer-extra/issues/454) yakında gelecek. Gelişmeleri [buradan](https://github.com/berstend/puppeteer-extra/tree/master/packages/playwright-extra) ve [buradan](https://github.com/berstend/puppeteer-extra/tree/master/packages/playwright-extra) takip edin.
* **Selenium:** [undetected-chromedriver](https://github.com/ultrafunkamsterdam/undetected-chromedriver) optimize edilmiş bir Selenium Chromedriver yaması.

### Cloudflare Dahili Atlatma Özellikli Akıllı Proxy <a href="#option-5-smart-proxy-with-cloudflare-built-in-bypass" id="option-5-smart-proxy-with-cloudflare-built-in-bypass"></a>

**Akıllı proxy'ler**, Cloudflare'ın güvenlik önlemlerini atlamayı amaçlayan uzmanlaşmış şirketler tarafından sürekli güncellenen proxy'lerdir (çünkü bu onların işidir).

Bunlardan bazıları şunlardır:

* [ScraperAPI](https://www.scraperapi.com/?fp\_ref=scrapeops)
* [Scrapingbee](https://www.scrapingbee.com/?fpr=scrapeops)
* [Oxylabs](https://oxylabs.go2cloud.org/aff\_c?offer\_id=7\&aff\_id=379\&url\_id=32)
* [Smartproxy](https://prf.hn/click/camref:1100loxdG/\[p\_id:1100l442001]/destination:https%3A%2F%2Fsmartproxy.com%2Fscraping%2Fweb) özel Cloudflare atlatma mekanizmalarıyla bilinir.

Optimize edilmiş bir çözüm arayanlar için [ScrapeOps Proxy Aggregator](https://scrapeops.io/proxy-aggregator/) öne çıkar. Bu hizmet, 20'den fazla proxy sağlayıcısını tek bir API'ye entegre ederek, hedef alanlarınız için en iyi ve en maliyet etkin proxy'yi otomatik olarak seçer, böylece Cloudflare'ın savunmalarını geçmek için üstün bir seçenek sunar.

### Cloudflare Anti-Bot Korumasını Tersine Mühendislik Yapma <a href="#option-6-reverse-engineer-cloudflare-anti-bot-protection" id="option-6-reverse-engineer-cloudflare-anti-bot-protection"></a>

Cloudflare'ın anti-bot önlemlerini tersine mühendislik yapmak, birçok başsız tarayıcı çalıştırmanın yüksek maliyetinden kaçınmak için akıllı proxy sağlayıcıları tarafından kullanılan bir taktiktir.

**Avantajlar:** Bu yöntem, büyük ölçekli operasyonlar için ideal olan, Cloudflare'ın kontrollerine özel olarak hedeflenen son derece verimli bir atlatma oluşturmayı sağlar.

**Dezavantajlar:** Dezavantajı, Cloudflare'ın kasıtlı olarak belirsiz anti-bot sistemini anlama ve aldatma konusundaki karmaşıklıktır; bu, farklı stratejileri test etme ve Cloudflare korumalarını güçlendirdikçe atlatmayı güncelleme çabasını gerektirir.

Bu konuda daha fazla bilgiyi [orijinal makalede](https://scrapeops.io/web-scraping-playbook/how-to-bypass-cloudflare/) bulabilirsiniz.

## Referanslar

* [https://scrapeops.io/web-scraping-playbook/how-to-bypass-cloudflare/](https://scrapeops.io/web-scraping-playbook/how-to-bypass-cloudflare/)

<details>

<summary><strong>Sıfırdan kahraman olmak için AWS hackleme öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) koleksiyonumuzdaki özel [**NFT'leri**](https://opensea.io/collection/the-peass-family) keşfedin
* **💬 [Discord grubuna](https://discord.gg/hRep4RUj7f) veya [telegram grubuna](https://t.me/peass) katılın veya** Twitter'da 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)**'u takip edin.**
* **Hacking püf noktalarınızı göndererek HackTricks ve HackTricks Cloud github depolarına PR göndererek paylaşın.**

</details>
