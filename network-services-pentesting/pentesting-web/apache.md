# Extensiones PHP ejecutables

Verifique qué extensiones está ejecutando el servidor Apache. Para buscarlas, puede ejecutar:
```bash
 grep -R -B1 "httpd-php" /etc/apache2
```
También puedes encontrar esta configuración en:
```bash
/etc/apache2/mods-available/php5.conf
/etc/apache2/mods-enabled/php5.conf
/etc/apache2/mods-available/php7.3.conf
/etc/apache2/mods-enabled/php7.3.conf
```
# CVE-2021-41773

## Descripción

Apache HTTP Server 2.4.49, 2.4.50 - Path Traversal y DoS

Un atacante remoto no autenticado puede enviar una solicitud HTTP GET con una ruta de acceso especialmente diseñada utilizando caracteres de punto y barra diagonal para acceder a archivos que no están en la raíz del servidor web. Esto puede permitir la lectura de archivos que contienen información confidencial o la ejecución de código malicioso. Además, un atacante también puede utilizar esta vulnerabilidad para realizar un ataque de denegación de servicio (DoS) enviando solicitudes HTTP GET con rutas de acceso especialmente diseñadas que pueden causar que el servidor web se bloquee o se reinicie.

## Detalles técnicos

La vulnerabilidad se debe a una validación insuficiente de las rutas de acceso en el módulo mod_autoindex de Apache HTTP Server. El módulo mod_autoindex se utiliza para generar listas de directorios en el servidor web. Cuando se recibe una solicitud HTTP GET para una ruta de acceso que no existe en el servidor web, el módulo mod_autoindex intenta generar una lista de directorios para esa ruta de acceso. Si la ruta de acceso contiene caracteres de punto y barra diagonal, el módulo mod_autoindex puede generar una lista de directorios para una ruta de acceso que no está en la raíz del servidor web.

## Solución

Se recomienda actualizar a la versión 2.4.51 de Apache HTTP Server, que soluciona esta vulnerabilidad. Si no es posible actualizar, se puede mitigar la vulnerabilidad deshabilitando el módulo mod_autoindex o utilizando una regla de firewall para bloquear solicitudes HTTP GET con rutas de acceso que contengan caracteres de punto y barra diagonal.
```bash
curl http://172.18.0.15/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh --data 'echo Content-Type: text/plain; echo; id; uname'
uid=1(daemon) gid=1(daemon) groups=1(daemon)
Linux
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- ¿Trabajas en una **empresa de ciberseguridad**? ¿Quieres ver tu **empresa anunciada en HackTricks**? ¿O quieres tener acceso a la **última versión de PEASS o descargar HackTricks en PDF**? ¡Consulta los [**PLANES DE SUSCRIPCIÓN**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colección exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtén la [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **Únete al** [**💬**](https://emojipedia.org/speech-balloon/) **grupo de Discord** o al [**grupo de telegram**](https://t.me/peass) o **sígueme en** **Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PRs al repositorio [hacktricks](https://github.com/carlospolop/hacktricks) y al repositorio [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
