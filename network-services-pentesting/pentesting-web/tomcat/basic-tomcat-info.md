# 기본 Tomcat 정보

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 제로에서 영웅까지 AWS 해킹을 배워보세요<strong>!</strong></summary>

* **사이버 보안 회사**에서 일하시나요? **회사를 HackTricks에서 광고**하거나 **PEASS의 최신 버전에 액세스**하거나 HackTricks를 **PDF로 다운로드**하고 싶으신가요? [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인해보세요!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견해보세요. 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter**에서 저를 **팔로우**하세요 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **[hacktricks repo](https://github.com/carlospolop/hacktricks)와 [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**에 PR을 제출하여 여러분의 해킹 기교를 공유하세요.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

가장 중요한 취약점을 찾아서 더 빠르게 수정하세요. Intruder는 공격 대상을 추적하고 적극적인 위협 스캔을 실행하여 API부터 웹 앱 및 클라우드 시스템까지 전체 기술 스택에서 문제를 찾습니다. [**무료로 시도해보세요**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) 오늘부터.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

### root로 실행하지 않도록 주의하세요

Tomcat을 root로 실행하지 않기 위해 매우 일반적인 구성은 포트 80/443에서 Apache 서버를 설정하고, 요청된 경로가 정규식과 일치하는 경우 요청을 다른 포트에서 실행 중인 Tomcat으로 보냅니다.

### 기본 구조
```
├── bin
├── conf
│   ├── catalina.policy
│   ├── catalina.properties
│   ├── context.xml
│   ├── tomcat-users.xml
│   ├── tomcat-users.xsd
│   └── web.xml
├── lib
├── logs
├── temp
├── webapps
│   ├── manager
│   │   ├── images
│   │   ├── META-INF
│   │   └── WEB-INF
|   |       └── web.xml
│   └── ROOT
│       └── WEB-INF
└── work
└── Catalina
└── localhost
```
* `WEB-INF` folder: This folder contains the configuration files and classes specific to the web application.
* `META-INF` folder: This folder contains the metadata files for the web application.
* Other files and folders: These can include HTML, CSS, JavaScript, and other resources used by the web application.

To access the Tomcat server, you can use a web browser and navigate to `http://<ip_address>:<port>`. The default port for Tomcat is 8080.

To authenticate and access the Manager application, you need to have the appropriate credentials defined in the `tomcat-users.xml` file. The Manager application allows you to deploy, undeploy, and manage web applications.

It is important to secure the Tomcat server by changing default credentials, disabling unnecessary services, and keeping the server and its components up to date with the latest security patches.
```
webapps/customapp
├── images
├── index.jsp
├── META-INF
│   └── context.xml
├── status.xsd
└── WEB-INF
├── jsp
|   └── admin.jsp
└── web.xml
└── lib
|    └── jdbc_drivers.jar
└── classes
└── AdminServlet.class
```
가장 중요한 파일 중 하나는 `WEB-INF/web.xml`입니다. 이 파일은 애플리케이션에서 사용하는 경로와 해당 경로를 처리하는 클래스에 대한 정보를 저장하는 배포 기술자로 알려져 있습니다.\
애플리케이션이 사용하는 모든 컴파일된 클래스는 `WEB-INF/classes` 폴더에 저장되어야 합니다. 이러한 클래스에는 중요한 비즈니스 로직과 민감한 정보가 포함될 수 있습니다. 이러한 파일들의 취약점은 웹사이트의 완전한 침해로 이어질 수 있습니다. `lib` 폴더에는 해당 애플리케이션에 필요한 라이브러리가 저장됩니다. `jsp` 폴더에는 [Jakarta Server Pages (JSP)](https://en.wikipedia.org/wiki/Jakarta\_Server\_Pages)로 알려진 이전의 `JavaServer Pages`와 비슷한 기능을 하는 파일이 저장됩니다.

다음은 **web.xml** 파일의 예시입니다.
```xml
<?xml version="1.0" encoding="ISO-8859-1"?>

<!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN" "http://java.sun.com/dtd/web-app_2_3.dtd">

<web-app>
<servlet>
<servlet-name>AdminServlet</servlet-name>
<servlet-class>com.inlanefreight.api.AdminServlet</servlet-class>
</servlet>

<servlet-mapping>
<servlet-name>AdminServlet</servlet-name>
<url-pattern>/admin</url-pattern>
</servlet-mapping>
</web-app>
```
위의 `web.xml` 구성은 **`AdminServlet`**이라는 새로운 서블릿을 정의하며, 이 서블릿은 **`com.inlanefreight.api.AdminServlet`** 클래스에 매핑됩니다. Java는 패키지 이름을 만들기 위해 점 표기법을 사용하므로, 위에서 정의한 클래스의 디스크 경로는 다음과 같습니다:

* **`classes/com/inlanefreight/api/AdminServlet.class`**

다음으로, `/admin`에 대한 요청을 `AdminServlet`과 매핑하는 새로운 서블릿 매핑이 생성됩니다. 이 구성은 **`/admin`에 대한 모든 요청을 처리하기 위해 `AdminServlet.class`** 클래스로 보냅니다. **`web.xml`** 기술자는 많은 **민감한 정보**를 포함하고 있으며, **로컬 파일 포함 (LFI) 취약점**을 활용할 때 확인해야 하는 중요한 파일입니다.

### tomcat-users

**`tomcat-users.xml`** 파일은 **`/manager` 및 `host-manager` 관리 페이지**에 대한 액세스를 허용하거나 거부하는 데 사용됩니다.
```xml
<?xml version="1.0" encoding="UTF-8"?>

<SNIP>

<tomcat-users xmlns="http://tomcat.apache.org/xml"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://tomcat.apache.org/xml tomcat-users.xsd"
version="1.0">
<!--
By default, no user is included in the "manager-gui" role required
to operate the "/manager/html" web application.  If you wish to use this app,
you must define such a user - the username and password are arbitrary.

Built-in Tomcat manager roles:
- manager-gui    - allows access to the HTML GUI and the status pages
- manager-script - allows access to the HTTP API and the status pages
- manager-jmx    - allows access to the JMX proxy and the status pages
- manager-status - allows access to the status pages only

The users below are wrapped in a comment and are therefore ignored. If you
wish to configure one or more of these users for use with the manager web
application, do not forget to remove the <!.. ..> that surrounds them. You
will also need to set the passwords to something appropriate.
-->


<SNIP>

!-- user manager can access only manager section -->
<role rolename="manager-gui" />
<user username="tomcat" password="tomcat" roles="manager-gui" />

<!-- user admin can access manager and admin section both -->
<role rolename="admin-gui" />
<user username="admin" password="admin" roles="manager-gui,admin-gui" />


</tomcat-users>
```
파일은 `manager-gui`, `manager-script`, `manager-jmx` 및 `manager-status` 역할이 제공하는 각각의 액세스를 보여줍니다. 이 예제에서는 `tomcat` 사용자가 암호 `tomcat`으로 `manager-gui` 역할을 가지고 있으며, 두 번째로 약한 암호 `admin`이 `admin` 사용자 계정에 설정되어 있습니다.

## 참고 자료

* [https://academy.hackthebox.com/module/113/section/1090](https://academy.hackthebox.com/module/113/section/1090)

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

가장 중요한 취약점을 찾아서 빠르게 수정할 수 있습니다. Intruder는 공격 표면을 추적하고 예방적인 위협 스캔을 실행하여 API부터 웹 앱 및 클라우드 시스템까지 전체 기술 스택에서 문제를 찾습니다. [**무료로 시도해보세요**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) 오늘.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}


<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>로부터 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

* **사이버 보안 회사**에서 일하시나요? **회사를 HackTricks에서 광고**하거나 **PEASS의 최신 버전에 액세스**하거나 HackTricks를 **PDF로 다운로드**하고 싶으신가요? [**구독 요금제**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter**에서 저를 **팔로우**하세요 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **[hacktricks repo](https://github.com/carlospolop/hacktricks) 및 [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**에 PR을 제출하여 여러분의 해킹 기법을 공유하세요.

</details>
