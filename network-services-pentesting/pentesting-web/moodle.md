# Moodle

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikionekana kwenye HackTricks** au **kupakua HackTricks kwa muundo wa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwenye** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

Ikiwa una nia ya **kazi ya kudukua** na kudukua yasiyodukuliwa - **tunatoa ajira!** (_inahitajika uwezo wa kuandika na kuzungumza Kipolishi kwa ufasaha_).

{% embed url="https://www.stmcyber.com/careers" %}

## Uchunguzi wa Kiotomatiki

### droopescan
```bash
pip3 install droopescan
droopescan scan moodle -u http://moodle.example.com/<moodle_path>/

[+] Plugins found:
forum http://moodle.schooled.htb/moodle/mod/forum/
http://moodle.schooled.htb/moodle/mod/forum/upgrade.txt
http://moodle.schooled.htb/moodle/mod/forum/version.php

[+] No themes found.

[+] Possible version(s):
3.10.0-beta

[+] Possible interesting urls found:
Static readme file. - http://moodle.schooled.htb/moodle/README.txt
Admin panel - http://moodle.schooled.htb/moodle/login/

[+] Scan finished (0:00:05.643539 elapsed)
```
### moodlescan

moodlescan ni chombo cha kufanya uchunguzi wa usalama kwenye mfumo wa Moodle. Inatumia API ya Moodle ili kupata habari kuhusu toleo la Moodle, moduli zilizosanikishwa, na mipangilio ya usalama. Chombo hiki kinaweza kutumiwa kama sehemu ya mchakato wa pentesting kuchunguza udhaifu katika mfumo wa Moodle.

#### Matumizi

```
moodlescan <url>
```

#### Mifano

```
moodlescan https://example.com/moodle
```

#### Matokeo yanayowezekana

- Toleo la Moodle
- Moduli zilizosanikishwa
- Mipangilio ya usalama
- Udhaifu uliogunduliwa

#### Vidokezo

- moodlescan inaweza kutumiwa kwa uchunguzi wa usalama wa mfumo wa Moodle.
- Ni muhimu kufanya uchunguzi wa usalama mara kwa mara ili kugundua na kurekebisha udhaifu katika mfumo wa Moodle.
- moodlescan inaweza kusaidia kugundua udhaifu ambao unaweza kutumiwa na wadukuzi kuvunja mfumo wa Moodle.
```bash
#Install from https://github.com/inc0d3/moodlescan
python3 moodlescan.py -k -u http://moodle.example.com/<moodle_path>/

Version 0.7 - Dic/2020
.............................................................................................................

By Victor Herrera - supported by www.incode.cl

.............................................................................................................

Getting server information http://moodle.schooled.htb/moodle/ ...

server         	: Apache/2.4.46 (FreeBSD) PHP/7.4.15
x-powered-by   	: PHP/7.4.15
x-frame-options	: sameorigin
last-modified  	: Wed, 07 Apr 2021 21:33:41 GMT

Getting moodle version...

Version found via /admin/tool/lp/tests/behat/course_competencies.feature : Moodle v3.9.0-beta

Searching vulnerabilities...


Vulnerabilities found: 0

Scan completed.
```
### CMSMap

CMSMap ni chombo cha kupima usalama ambacho kinaweza kutumiwa kwa ajili ya kugundua na kuchunguza tovuti zinazotumia mfumo wa usimamizi wa maudhui (CMS). Chombo hiki kinaweza kufanya uchunguzi wa kina wa tovuti na kutoa habari muhimu kuhusu CMS inayotumiwa, matoleo yake, na hata kugundua udhaifu uliopo.

CMSMap kinaweza kutumiwa kwa njia mbalimbali, ikiwa ni pamoja na kuchunguza tovuti kwa kutumia orodha ya CMS maarufu, kuchunguza matoleo ya CMS, na hata kufanya uchunguzi wa kina wa tovuti ili kugundua udhaifu uliopo. Chombo hiki kinaweza kuwa muhimu kwa wataalamu wa usalama na wapenzi wa teknolojia ambao wanataka kuchunguza na kuboresha usalama wa tovuti zinazotumia CMS.

CMSMap ni chombo cha nguvu na kinaweza kutoa habari muhimu kwa watumiaji wake. Hata hivyo, ni muhimu kutumia chombo hiki kwa njia sahihi na kwa kuzingatia sheria na kanuni za kimaadili.
```bash
pip3 install git+https://github.com/dionach/CMSmap.git
cmsmap http://moodle.example.com/<moodle_path>
```
### CVEs

Nimegundua kuwa zana za otomatiki ni **za bure kabisa katika kutafuta udhaifu unaowaathiri toleo la moodle**. Unaweza **kuzitafuta** katika [**https://snyk.io/vuln/composer:moodle%2Fmoodle**](https://snyk.io/vuln/composer:moodle%2Fmoodle)

## **RCE**

Unahitaji kuwa na jukumu la **meneja** na unaweza **kusanikisha programu-jalizi** ndani ya kichupo cha **"Usimamizi wa Tovuti"**:

![](<../../.gitbook/assets/image (447).png>)

Ikiwa wewe ni meneja, bado unaweza kuwa na haja ya **kuamsha chaguo hili**. Unaweza kuona jinsi ya kufanya hivyo katika PoC ya kuongeza mamlaka ya moodle: [https://github.com/HoangKien1020/CVE-2020-14321](https://github.com/HoangKien1020/CVE-2020-14321).

Kisha, unaweza **kusanikisha programu-jalizi ifuatayo** ambayo ina kifaa cha kawaida cha pentest-monkey php **rev shell** (_kabla ya kuipakia, unahitaji kuifungua, kubadilisha anwani ya IP na bandari ya revshell, na kisha kuifunga tena_)

{% file src="../../.gitbook/assets/moodle-rce-plugin.zip" %}

Au unaweza kutumia programu-jalizi kutoka [https://github.com/HoangKien1020/Moodle\_RCE](https://github.com/HoangKien1020/Moodle\_RCE) ili kupata kifaa cha kawaida cha PHP na "cmd" kama parameter.

Ili kufikia programu-jalizi mbaya, unahitaji kufikia:
```bash
http://domain.com/<moodle_path>/blocks/rce/lang/en/block_rce.php?cmd=id
```
## POST

### Tafuta siri za kuingia kwenye hifadhidata

Ili kufanikiwa katika kazi ya kuingia kwenye hifadhidata, ni muhimu kwanza kupata siri za kuingia. Hapa kuna njia kadhaa za kufanya hivyo:

1. **Kuchunguza faili za konfigurisheni**: Angalia faili za konfigurisheni za mfumo wa Moodle ili kupata siri za kuingia kwenye hifadhidata. Faili kama `config.php` au `config-dist.php` zinaweza kutoa habari muhimu.

2. **Kuchunguza faili za logi**: Angalia faili za logi za mfumo wa Moodle ili kutafuta siri za kuingia kwenye hifadhidata. Mara nyingi, faili za logi zinaweza kuwa na habari muhimu kama vile majina ya mtumiaji na nywila.

3. **Kuchunguza ukurasa wa usajili**: Ikiwa Moodle inaruhusu usajili wa watumiaji, jaribu kusajili akaunti mpya na angalia ikiwa unaweza kupata siri za kuingia kwenye hifadhidata kupitia ukurasa wa usajili.

4. **Kuchunguza maelezo ya mtumiaji**: Ikiwa una ufikiaji wa akaunti ya mtumiaji wa Moodle, angalia maelezo yao ili kutafuta siri za kuingia kwenye hifadhidata. Mara nyingi, watumiaji wanaweza kutumia siri sawa kwa akaunti zao zote.

Kumbuka kuwa kufanya uchunguzi huu kunapaswa kufanywa kwa idhini ya mmiliki wa mfumo wa Moodle na kwa madhumuni ya kujaribu usalama tu.
```bash
find / -name "config.php" 2>/dev/null | grep "moodle/config.php"
```
### Tupa Vitambulisho kutoka kwenye hifadhidata

```html
To dump credentials from a database, you can use various techniques depending on the type of database you are targeting. Here are some common methods:

1. SQL Injection: If the target application is vulnerable to SQL injection, you can exploit it to extract credentials from the database. By injecting malicious SQL queries, you can retrieve usernames and passwords stored in the database.

2. Brute-forcing: If you have obtained a database dump file, you can use brute-forcing techniques to crack the hashed passwords. By trying different combinations of passwords and comparing the hashes, you can identify the correct credentials.

3. Exploiting Misconfigurations: Sometimes, databases are misconfigured, allowing unauthorized access. By exploiting these misconfigurations, you can gain access to the database and extract credentials.

4. Social Engineering: In some cases, you can trick individuals with database access into revealing their credentials. This can be done through phishing emails, phone calls, or other social engineering techniques.

Remember, it is important to have proper authorization and legal permission before attempting to dump credentials from a database. Unauthorized access is illegal and unethical.
```bash
/usr/local/bin/mysql -u <username> --password=<password> -e "use moodle; select email,username,password from mdl_user; exit"
```
<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

Ikiwa una nia ya **kazi ya kuhack** na kuhack mambo yasiyohackika - **tunatafuta wafanyakazi!** (_inahitajika uwezo wa kuandika na kuzungumza kwa ufasaha kwa Kipolishi_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><strong>Jifunze kuhack AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako inatangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**The PEASS Family**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa [**NFTs**](https://opensea.io/collection/the-peass-family) ya kipekee
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kuhack kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
