# Moodle

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu** proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

Ako vas zanima **hakerska karijera** i hakovanje nehakabilnog - **mi zapošljavamo!** (_potrebno je tečno poznavanje poljskog jezika, kako pisanog tako i govornog_).

{% embed url="https://www.stmcyber.com/careers" %}

## Automatsko skeniranje

### droopescan
```bash
pip3 install droopescan
droopescan scan moodle -u http://moodle.example.com/<moodle_path>/

[+] Plugins found:
forum http://moodle.schooled.htb/moodle/mod/forum/
http://moodle.schooled.htb/moodle/mod/forum/upgrade.txt
http://moodle.schooled.htb/moodle/mod/forum/version.php

[+] No themes found.

[+] Possible version(s):
3.10.0-beta

[+] Possible interesting urls found:
Static readme file. - http://moodle.schooled.htb/moodle/README.txt
Admin panel - http://moodle.schooled.htb/moodle/login/

[+] Scan finished (0:00:05.643539 elapsed)
```
### moodlescan

moodlescan je alat koji se koristi za skeniranje Moodle sistema kako bi se identifikovali ranjivosti i slabosti. Ovaj alat može da izvrši različite vrste skeniranja, uključujući skeniranje otvorenih portova, skeniranje ranjivosti i skeniranje direktorijuma. Takođe može da pruži informacije o verziji Moodle sistema i instaliranim dodacima.

Da biste koristili moodlescan, prvo morate da instalirate alat na svoj sistem. Zatim možete pokrenuti skeniranje tako što ćete uneti ciljnu IP adresu ili domen. Alat će automatski izvršiti skeniranje i prikazati rezultate.

Moodlescan može da bude veoma koristan alat za pentestiranje Moodle sistema, jer vam omogućava da identifikujete potencijalne ranjivosti i slabosti pre nego što ih iskoristi napadač. Takođe može da vam pomogne da poboljšate bezbednost vašeg Moodle sistema tako što ćete otkloniti identifikovane ranjivosti i primeniti preporučene sigurnosne mere.
```bash
#Install from https://github.com/inc0d3/moodlescan
python3 moodlescan.py -k -u http://moodle.example.com/<moodle_path>/

Version 0.7 - Dic/2020
.............................................................................................................

By Victor Herrera - supported by www.incode.cl

.............................................................................................................

Getting server information http://moodle.schooled.htb/moodle/ ...

server         	: Apache/2.4.46 (FreeBSD) PHP/7.4.15
x-powered-by   	: PHP/7.4.15
x-frame-options	: sameorigin
last-modified  	: Wed, 07 Apr 2021 21:33:41 GMT

Getting moodle version...

Version found via /admin/tool/lp/tests/behat/course_competencies.feature : Moodle v3.9.0-beta

Searching vulnerabilities...


Vulnerabilities found: 0

Scan completed.
```
### CMSMap

CMSMap je alat koji se koristi za skeniranje i identifikaciju CMS (Content Management System) platformi na ciljnom veb serveru. Ovaj alat može da otkrije različite CMS platforme kao što su WordPress, Joomla, Drupal i mnoge druge. Takođe, pruža informacije o verziji CMS-a, instaliranim dodacima i temama.

Da biste koristili CMSMap, jednostavno pokrenite sledeću komandu:

```bash
cmsmap -u <URL>
```

Gde `<URL>` predstavlja URL ciljnog veb servera koji želite da skenirate.

CMSMap takođe podržava opcije kao što su skeniranje određenih direktorijuma, skeniranje samo određenih CMS platformi i skeniranje sa određenim korisničkim agentom. Za više informacija o ovim opcijama, možete pogledati dokumentaciju alata.

Ovaj alat može biti koristan za pentestere i hakere koji žele da identifikuju ranjive CMS platforme i iskoriste poznate ranjivosti kako bi dobili neovlašćen pristup ciljnom sistemu. Međutim, važno je napomenuti da je korišćenje ovog alata u neovlašćene svrhe ilegalno i može imati ozbiljne pravne posledice.
```bash
pip3 install git+https://github.com/dionach/CMSmap.git
cmsmap http://moodle.example.com/<moodle_path>
```
### CVE-ovi

Uvideo sam da su automatski alati prilično **beskorisni u pronalaženju ranjivosti koje utiču na verziju moodle-a**. Možete **proveriti** za njih na [**https://snyk.io/vuln/composer:moodle%2Fmoodle**](https://snyk.io/vuln/composer:moodle%2Fmoodle)

## **RCE**

Potrebno je da imate ulogu **menadžera** i da **možete instalirati dodatke** unutar kartice **"Upravljanje sajtom"**\*\*:\*\*

![](<../../.gitbook/assets/image (447).png>)

Ako ste menadžer, možda ćete ipak morati **aktivirati ovu opciju**. Možete videti kako to uraditi u PoC-u za eskalaciju privilegija u moodle-u: [https://github.com/HoangKien1020/CVE-2020-14321](https://github.com/HoangKien1020/CVE-2020-14321).

Zatim, možete **instalirati sledeći dodatak** koji sadrži klasičnu pentest-monkey php **rev shell** (_pre nego što ga otpremite, morate ga dekompresovati, promeniti IP i port revshella i ponovo ga kompresovati_)

{% file src="../../.gitbook/assets/moodle-rce-plugin.zip" %}

Ili možete koristiti dodatak sa [https://github.com/HoangKien1020/Moodle\_RCE](https://github.com/HoangKien1020/Moodle\_RCE) da biste dobili običnu PHP ljusku sa parametrom "cmd".

Da biste pristupili zlonamernom dodatku, morate pristupiti:
```bash
http://domain.com/<moodle_path>/blocks/rce/lang/en/block_rce.php?cmd=id
```
## POST

### Pronađite podatke za pristup bazi podataka

Da biste pronašli podatke za pristup bazi podataka, možete iskoristiti POST zahtev kako biste pokušali da izvučete osetljive informacije. Ovaj metod se često koristi za pronalaženje korisničkih imena, lozinki ili drugih podataka za pristup bazi podataka.

Evo nekoliko tehnika koje možete primeniti:

1. **SQL Injection**: Ako je aplikacija podložna SQL Injection napadima, možete pokušati da ubacite SQL kod u POST zahtev kako biste izvršili upit nad bazom podataka. Na taj način možete dobiti pristup osetljivim informacijama, uključujući i podatke za pristup bazi podataka.

2. **Brute-forcing**: Možete pokušati da izvršite brute-force napad na POST endpoint kako biste otkrili ispravne kombinacije korisničkih imena i lozinki. Ovo može biti efikasno ako aplikacija nema zaštitu od brute-force napada.

3. **Directory traversal**: Ako je aplikacija podložna directory traversal napadima, možete pokušati da pristupite datotekama koje sadrže podatke za pristup bazi podataka. Ovo može biti moguće ako aplikacija ne pravilno proverava putanju do datoteka koje se koriste za čuvanje podataka o bazi podataka.

4. **Session hijacking**: Ako možete izvršiti session hijacking napad na aplikaciju, možete preuzeti sesiju nekog korisnika koji ima pristup bazi podataka. Na taj način možete dobiti pristup podacima za pristup bazi podataka.

Važno je napomenuti da je ova aktivnost ilegalna, osim ako je izričito dozvoljena od strane vlasnika sistema. Uvek se pridržavajte zakona i etičkih smernica prilikom izvođenja bilo kakvih hakeraških aktivnosti.
```bash
find / -name "config.php" 2>/dev/null | grep "moodle/config.php"
```
### Izvlačenje akreditacija iz baze podataka

Da biste izvukli akreditacije iz baze podataka, možete koristiti različite tehnike, kao što su:

- **SQL Injection**: Ova tehnika omogućava vam da izvršite zlonamerni SQL kod koji će vam omogućiti pristup podacima u bazi podataka, uključujući i akreditacije. Možete iskoristiti ranjivosti u unosu podataka kako biste ubacili zlonamerni SQL kod i izvukli akreditacije.

- **Brute-Force napadi**: Ova tehnika uključuje pokušaj različitih kombinacija korisničkih imena i lozinki kako biste pronašli ispravne akreditacije. Možete koristiti alate za Brute-Force napade koji će automatski pokušavati različite kombinacije sve dok ne pronađu ispravne akreditacije.

- **Phishing**: Ova tehnika uključuje stvaranje lažne stranice koja izgleda identično kao prava stranica za prijavu. Kada korisnik unese svoje akreditacije na lažnoj stranici, one se šalju vama umesto pravoj stranici. Možete koristiti različite metode za preusmeravanje korisnika na lažnu stranicu, kao što su slanje lažnih e-mailova ili korišćenje zlonamernih veza.

Važno je napomenuti da je izvlačenje akreditacija iz baze podataka nezakonito i može imati ozbiljne pravne posledice. Ove tehnike se mogu koristiti samo u okviru zakonitog testiranja penetracije ili uz pristanak vlasnika sistema.
```bash
/usr/local/bin/mysql -u <username> --password=<password> -e "use moodle; select email,username,password from mdl_user; exit"
```
<img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

Ako ste zainteresovani za **hakersku karijeru** i hakovanje nehakabilnog - **mi zapošljavamo!** (_potrebno je tečno poznavanje poljskog jezika, kako pisanog tako i govornog_).

{% embed url="https://www.stmcyber.com/careers" %}

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju oglašenu u HackTricks-u** ili **preuzmete HackTricks u PDF formatu** Pogledajte [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
