# 웹 API Pentesting

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**를** **팔로우**하세요.
* **Hacking 트릭을 공유하려면 PR을** [**HackTricks**](https://github.com/carlospolop/hacktricks) **및** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **github 저장소에 제출**하세요.

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)를 사용하여 세계에서 가장 **고급 커뮤니티 도구**를 활용한 **워크플로우를 쉽게 구축하고 자동화**하세요.\
오늘 바로 액세스하세요:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}


## API Pentesting 방법론 요약

API Pentesting은 취약점을 발견하기 위한 구조화된 접근 방식을 포함합니다. 이 가이드는 실용적인 기법과 도구에 중점을 둔 포괄적인 방법론을 담고 있습니다.

### **API 유형 이해하기**

- **SOAP/XML 웹 서비스**: 문서화를 위해 일반적으로 `?wsdl` 경로에서 찾을 수 있는 WSDL 형식을 사용합니다. **SOAPUI** 및 **WSDLer** (Burp Suite 확장 프로그램)와 같은 도구는 요청을 구문 분석하고 생성하는 데 도움이 됩니다. 예제 문서는 [DNE Online](http://www.dneonline.com/calculator.asmx)에서 확인할 수 있습니다.

- **REST API (JSON)**: 문서화는 주로 WADL 파일로 제공되지만, [Swagger UI](https://swagger.io/tools/swagger-ui/)와 같은 도구는 더 사용자 친화적인 인터페이스를 제공합니다. **Postman**은 예제 요청을 생성하고 관리하는 데 유용한 도구입니다.

- **GraphQL**: API에 대한 완전하고 이해하기 쉬운 데이터 설명을 제공하는 쿼리 언어입니다.

### **실습 랩**

- [**VAmPI**](https://github.com/erev0s/VAmPI): OWASP top 10 API 취약점을 다루는 실습을 위한 의도적으로 취약한 API입니다.

### **API Pentesting을 위한 효과적인 트릭**

- **SOAP/XML 취약점**: DTD 선언이 제한되는 경우에도 XXE 취약점을 탐색합니다. XML이 유효한 경우 CDATA 태그를 사용하여 페이로드를 삽입할 수 있습니다.

- **권한 상승**: 권한 수준이 다른 엔드포인트를 테스트하여 무단 액세스 가능성을 식별합니다.

- **CORS 구성 오류**: 인증된 세션에서 CSRF 공격을 통해 공격 가능성이 있는 CORS 설정을 조사합니다.

- **엔드포인트 탐색**: API 패턴을 활용하여 숨겨진 엔드포인트를 발견합니다. 퍼저와 같은 도구를 사용하여 이 과정을 자동화할 수 있습니다.

- **매개변수 조작**: 요청에 매개변수를 추가하거나 교체하여 무단 데이터 또는 기능에 액세스합니다.

- **HTTP 메서드 테스트**: 요청 메서드(GET, POST, PUT, DELETE, PATCH)를 다양하게 변화시켜 예상치 못한 동작이나 정보 노출을 발견합니다.

- **Content-Type 조작**: 다른 콘텐츠 유형(x-www-form-urlencoded, application/xml, application/json)으로 전환하여 구문 분석 문제나 취약점을 테스트합니다.

- **고급 매개변수 기법**: JSON 페이로드에서 예상치 못한 데이터 유형을 테스트하거나 XXE 삽입을 위해 XML 데이터를 조작합니다. 또한, 매개변수 오염과 와일드카드 문자를 사용하여 더 넓은 범위의 테스트를 시도합니다.

- **버전 테스트**: 오래된 API 버전은 공격에 더 취약할 수 있습니다. 항상 여러 API 버전을 확인하고 테스트하세요.

### **API Pentesting을 위한 도구 및 자료**

- **kiterunner**: API 엔드포인트를 발견하는 데 탁월한 도구입니다. 대상 API에 대해 경로와 매개변수를 스캔하고 브루트 포스할 때 사용할 수 있습니다.
```bash
kr scan https://domain.com/api/ -w routes-large.kite -x 20
kr scan https://domain.com/api/ -A=apiroutes-220828 -x 20
kr brute https://domain.com/api/ -A=raft-large-words -x 20 -d=0
kr brute https://domain.com/api/ -w /tmp/lang-english.txt -x 20 -d=0
```
- **automatic-api-attack-tool**, **Astra**, 그리고 **restler-fuzzer**와 같은 추가 도구들은 API 보안 테스트를 위한 특화된 기능을 제공합니다. 이는 공격 시뮬레이션부터 퍼징(fuzzing)과 취약점 스캐닝까지 다양한 기능을 포함합니다.

### **학습 및 실습 자료**

- **OWASP API Security Top 10**: 일반적인 API 취약점을 이해하기 위한 필수 독서 자료 ([OWASP Top 10](https://github.com/OWASP/API-Security/blob/master/2019/en/dist/owasp-api-security-top-10.pdf)).

- **API Security Checklist**: API 보안을 위한 포괄적인 체크리스트 ([GitHub 링크](https://github.com/shieldfy/API-Security-Checklist)).

- **Logger++ Filters**: API 취약점을 찾기 위해 유용한 필터를 제공하는 Logger++ ([GitHub 링크](https://github.com/bnematzadeh/LoggerPlusPlus-API-Filters)).

- **API Endpoints List**: 테스트 목적으로 사용할 수 있는 잠재적인 API 엔드포인트의 선별된 목록 ([GitHub gist](https://gist.github.com/yassineaboukir/8e12adefbd505ef704674ad6ad48743d)).


## 참고 자료
* [https://github.com/Cyber-Guy1/API-SecurityEmpire](https://github.com/Cyber-Guy1/API-SecurityEmpire)


<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)를 사용하여 세계에서 가장 고급스러운 커뮤니티 도구를 활용한 **워크플로우를 쉽게 구축하고 자동화**하세요.\
오늘 바로 액세스하세요:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>**htARTE (HackTricks AWS Red Team Expert)**로부터 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

HackTricks를 지원하는 다른 방법:

* **회사를 HackTricks에서 광고하거나 HackTricks를 PDF로 다운로드**하려면 [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인하세요!
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요. 독점적인 [**NFTs**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* 💬 [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**를** 팔로우하세요.
* **HackTricks**와 [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github 저장소에 PR을 제출하여 여러분의 해킹 기술을 공유하세요.

</details>
