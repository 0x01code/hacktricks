# Web API Pentesting

<details>

<summary><strong>ゼロからヒーローまでAWSハッキングを学ぶ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法：

- **HackTricksで企業を宣伝したい**または**HackTricksをPDFでダウンロードしたい**場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
- [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手する
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションを見つける
- **💬 [Discordグループ](https://discord.gg/hRep4RUj7f)**に参加するか、[telegramグループ](https://t.me/peass)に参加するか、**Twitter**で**@carlospolopm**をフォローする
- **HackTricks**および**HackTricks Cloud**のGitHubリポジトリにPRを提出して、あなたのハッキングトリックを共有する

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks)を使用して、世界で最も高度なコミュニティツールによって強化された**ワークフローを簡単に構築**および**自動化**します。\
今すぐアクセスしてください：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}


## API Pentesting Methodology Summary

APIのペンテストには脆弱性を発見するための構造化されたアプローチが必要です。このガイドは包括的な方法論をまとめ、実践的な技術とツールを重視しています。

### **APIの種類の理解**

- **SOAP/XML Webサービス**: 通常`?wsdl`パスで見つかるドキュメントのWSDL形式を利用します。**SOAPUI**や**WSDLer**（Burp Suite拡張機能）などのツールは、解析やリクエストの生成に役立ちます。例として、[DNE Online](http://www.dneonline.com/calculator.asmx)でアクセス可能なドキュメントがあります。

- **REST API（JSON）**: ドキュメントはしばしばWADLファイルで提供されますが、[Swagger UI](https://swagger.io/tools/swagger-ui/)などのツールはよりユーザーフレンドリーなインターフェースを提供します。**Postman**は、例のリクエストの作成と管理に役立つ貴重なツールです。

- **GraphQL**: API向けのクエリ言語であり、API内のデータの完全かつ理解しやすい説明を提供します。

### **練習用ラボ**

- [**VAmPI**](https://github.com/erev0s/VAmPI): OWASPトップ10 API脆弱性をカバーする実践的な脆弱性を持つAPI。

### **API Pentestingの効果的なトリック**

- **SOAP/XMLの脆弱性**: XXE脆弱性を調査しますが、DTD宣言は通常制限されています。XMLが有効であれば、CDATAタグを使用してペイロードを挿入できる場合があります。

- **特権昇格**: 権限レベルが異なるエンドポイントをテストして、不正アクセスの可能性を特定します。

- **CORSの誤構成**: 認証セッションからのCSRF攻撃を通じて潜在的な悪用可能性を調査するために、CORS設定を調査します。

- **エンドポイントの発見**: APIパターンを活用して隠れたエンドポイントを発見します。ファジングツールを使用してこのプロセスを自動化できます。

- **パラメータの改ざん**: リクエストにパラメータを追加または置換して、不正なデータや機能にアクセスする実験を行います。

- **HTTPメソッドのテスト**: リクエストメソッド（GET、POST、PUT、DELETE、PATCH）を変更して、予期しない動作や情報の漏洩を発見します。

- **Content-Typeの操作**: 異なるコンテンツタイプ（x-www-form-urlencoded、application/xml、application/json）に切り替えて、解析の問題や脆弱性をテストします。

- **高度なパラメータテクニック**: JSONペイロードで予期しないデータ型をテストしたり、XXEインジェクションのためにXMLデータを操作したりします。また、パラメータポリューションやワイルドカード文字を使用して、より広範なテストを行います。

- **バージョンのテスト**: 古いAPIバージョンは攻撃を受けやすい場合があります。常に複数のAPIバージョンを確認してテストしてください。

### **API Pentestingのツールとリソース**

- **kiterunner**: APIエンドポイントを発見するのに優れています。これを使用して、対象のAPIに対してパスやパラメータをスキャンおよびブルートフォースすることができます。
```bash
kr scan https://domain.com/api/ -w routes-large.kite -x 20
kr scan https://domain.com/api/ -A=apiroutes-220828 -x 20
kr brute https://domain.com/api/ -A=raft-large-words -x 20 -d=0
kr brute https://domain.com/api/ -w /tmp/lang-english.txt -x 20 -d=0
```
- 追加ツールである**automatic-api-attack-tool**、**Astra**、および**restler-fuzzer**は、攻撃シミュレーションからファジング、脆弱性スキャンまでのAPIセキュリティテスト向けの機能を提供しています。

### **学習と実践リソース**

- **OWASP APIセキュリティトップ10**: 一般的なAPI脆弱性を理解するための必読書 ([OWASP Top 10](https://github.com/OWASP/API-Security/blob/master/2019/en/dist/owasp-api-security-top-10.pdf))。

- **APIセキュリティチェックリスト**: APIを保護するための包括的なチェックリスト ([GitHubリンク](https://github.com/shieldfy/API-Security-Checklist))。

- **Logger++フィルター**: API脆弱性を探すために、Logger++は便利なフィルターを提供しています ([GitHubリンク](https://github.com/bnematzadeh/LoggerPlusPlus-API-Filters))。

- **APIエンドポイントリスト**: テスト目的のための潜在的なAPIエンドポイントのキュレーションリスト ([GitHub gist](https://gist.github.com/yassineaboukir/8e12adefbd505ef704674ad6ad48743d))。


## 参考文献
* [https://github.com/Cyber-Guy1/API-SecurityEmpire](https://github.com/Cyber-Guy1/API-SecurityEmpire)


<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks)を使用して、世界で最も高度なコミュニティツールによって強化された**ワークフローを簡単に構築**および**自動化**します。\
今すぐアクセスしてください：

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>**htARTE（HackTricks AWS Red Team Expert）**で**ゼロからヒーローまでAWSハッキングを学ぶ**</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE（HackTricks AWS Red Team Expert）</strong></a><strong>!</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksで企業を宣伝**したい場合や**HackTricksをPDFでダウンロード**したい場合は、[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS＆HackTricksスワッグ**](https://peass.creator-spring.com)を入手してください
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[NFTs](https://opensea.io/collection/the-peass-family)のコレクションをご覧ください
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)を**フォロー**してください。
* **HackTricks**と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のGitHubリポジトリにPRを提出して、あなたのハッキングトリックを共有してください。

</details>
