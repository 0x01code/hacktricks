# Pentesting de API web

<details>

<summary><strong>Aprende a hackear AWS desde cero hasta convertirte en un experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** f√°cilmente con las herramientas comunitarias m√°s avanzadas del mundo.\
¬°Accede hoy mismo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Resumen de la Metodolog√≠a de Pentesting de API

El pentesting de APIs implica un enfoque estructurado para descubrir vulnerabilidades. Esta gu√≠a encapsula una metodolog√≠a integral, enfatizando t√©cnicas y herramientas pr√°cticas.

### **Comprendiendo los Tipos de API**

* **Servicios Web SOAP/XML**: Utiliza el formato WSDL para la documentaci√≥n, que suele encontrarse en rutas `?wsdl`. Herramientas como **SOAPUI** y **WSDLer** (Extensi√≥n de Burp Suite) son fundamentales para analizar y generar solicitudes. La documentaci√≥n de ejemplo est√° disponible en [DNE Online](http://www.dneonline.com/calculator.asmx).
* **APIs REST (JSON)**: La documentaci√≥n a menudo se presenta en archivos WADL, aunque herramientas como [Swagger UI](https://swagger.io/tools/swagger-ui/) ofrecen una interfaz m√°s amigable para la interacci√≥n. **Postman** es una herramienta valiosa para crear y gestionar solicitudes de ejemplo.
* **GraphQL**: Un lenguaje de consulta para APIs que ofrece una descripci√≥n completa y comprensible de los datos en tu API.

### **Laboratorios de Pr√°ctica**

* [**VAmPI**](https://github.com/erev0s/VAmPI): Una API deliberadamente vulnerable para pr√°cticas pr√°cticas, que cubre las 10 principales vulnerabilidades de API de OWASP.

### **Trucos Efectivos para el Pentesting de API**

* **Vulnerabilidades SOAP/XML**: Explora vulnerabilidades XXE, aunque las declaraciones DTD suelen estar restringidas. Las etiquetas CDATA pueden permitir la inserci√≥n de payloads si el XML sigue siendo v√°lido.
* **Escalada de Privilegios**: Prueba los endpoints con diferentes niveles de privilegio para identificar posibles accesos no autorizados.
* **Configuraciones Incorrectas de CORS**: Investiga la configuraci√≥n de CORS para posibles explotaciones a trav√©s de ataques CSRF desde sesiones autenticadas.
* **Descubrimiento de Endpoints**: Aprovecha los patrones de API para descubrir endpoints ocultos. Las herramientas como los fuzzers pueden automatizar este proceso.
* **Manipulaci√≥n de Par√°metros**: Experimenta a√±adiendo o reemplazando par√°metros en las solicitudes para acceder a datos o funcionalidades no autorizados.
* **Pruebas de M√©todos HTTP**: Var√≠a los m√©todos de solicitud (GET, POST, PUT, DELETE, PATCH) para descubrir comportamientos inesperados o revelaciones de informaci√≥n.
* **Manipulaci√≥n de Tipo de Contenido**: Cambia entre diferentes tipos de contenido (x-www-form-urlencoded, application/xml, application/json) para probar problemas de an√°lisis o vulnerabilidades.
* **T√©cnicas Avanzadas de Par√°metros**: Prueba con tipos de datos inesperados en cargas JSON o juega con datos XML para inyecciones XXE. Tambi√©n prueba la contaminaci√≥n de par√°metros y caracteres comod√≠n para pruebas m√°s amplias.
* **Pruebas de Versiones**: Las versiones antiguas de API pueden ser m√°s susceptibles a ataques. Siempre verifica y prueba contra m√∫ltiples versiones de API.

### **Herramientas y Recursos para el Pentesting de API**

* **kiterunner**: Excelente para descubrir endpoints de API. √ösalo para escanear y realizar fuerza bruta en rutas y par√°metros contra APIs objetivo.
```bash
kr scan https://domain.com/api/ -w routes-large.kite -x 20
kr scan https://domain.com/api/ -A=apiroutes-220828 -x 20
kr brute https://domain.com/api/ -A=raft-large-words -x 20 -d=0
kr brute https://domain.com/api/ -w /tmp/lang-english.txt -x 20 -d=0
```
* Herramientas adicionales como **automatic-api-attack-tool**, **Astra** y **restler-fuzzer** ofrecen funcionalidades personalizadas para pruebas de seguridad de API, que van desde simulaci√≥n de ataques hasta fuzzing y escaneo de vulnerabilidades.

### **Recursos de Aprendizaje y Pr√°ctica**

* **OWASP API Security Top 10**: Lectura esencial para comprender las vulnerabilidades comunes de API ([OWASP Top 10](https://github.com/OWASP/API-Security/blob/master/2019/en/dist/owasp-api-security-top-10.pdf)).
* **Lista de Verificaci√≥n de Seguridad de API**: Una lista de verificaci√≥n completa para asegurar APIs ([enlace de GitHub](https://github.com/shieldfy/API-Security-Checklist)).
* **Filtros de Logger++**: Para la b√∫squeda de vulnerabilidades de API, Logger++ ofrece filtros √∫tiles ([enlace de GitHub](https://github.com/bnematzadeh/LoggerPlusPlus-API-Filters)).
* **Lista de Endpoints de API**: Una lista seleccionada de posibles endpoints de API con fines de prueba ([gist de GitHub](https://gist.github.com/yassineaboukir/8e12adefbd505ef704674ad6ad48743d)).

## Referencias

* [https://github.com/Cyber-Guy1/API-SecurityEmpire](https://github.com/Cyber-Guy1/API-SecurityEmpire)

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** f√°cilmente con las herramientas comunitarias m√°s avanzadas del mundo.\
¬°Accede hoy mismo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, ¬°consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Obt√©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠guenos** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
