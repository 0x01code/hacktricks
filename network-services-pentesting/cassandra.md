# 9042/9160 - Pentesting Cassandra

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling van eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>

## Basiese Inligting

**Apache Cassandra** is 'n **hoogs skaalbare**, **ho√´ prestasie** verspreide databasis wat ontwerp is om **groot hoeveelhede data** oor baie **gewone bedieners** te hanteer, en **ho√´ beskikbaarheid** te bied sonder **enige enkele foutpunt**. Dit is 'n tipe **NoSQL-databasis**.

In verskeie gevalle mag jy vind dat Cassandra **enige geloofsbriewe** aanvaar (aangesien daar geen geconfigureer is nie) en dit kan 'n aanvaller moontlik in staat stel om die databasis te **opnoem**.

**Verstekpoort:** 9042,9160
```
PORT     STATE SERVICE   REASON
9042/tcp open  cassandra-native Apache Cassandra 3.10 or later (native protocol versions 3/v3, 4/v4, 5/v5-beta)
9160/tcp open  cassandra syn-ack
```
### Handleiding

#### Poortscanning

Voer een poortscan uit om open poorten op het doelsysteem te identificeren. Dit kan worden gedaan met behulp van tools zoals Nmap of Masscan. Richt de scan op de standaardpoorten die door Cassandra worden gebruikt, zoals poort 9042 voor de CQL-native transport.

```
nmap -p 9042 <doel-IP>
```

#### Banner Grabbing

Gebruik een tool zoals Telnet of Netcat om de banner van de Cassandra-service op te halen. Dit kan informatie onthullen over de versie van Cassandra die wordt uitgevoerd, wat nuttig kan zijn bij het identificeren van kwetsbaarheden.

```
telnet <doel-IP> 9042
```

### Automatisch

#### NSE-scripts

Nmap heeft enkele NSE-scripts die specifiek zijn ontworpen voor het scannen van Cassandra-services. Deze scripts kunnen worden uitgevoerd met de volgende opdracht:

```
nmap -p 9042 --script cassandra* <doel-IP>
```

#### Metasploit-module

Metasploit heeft ook een module genaamd `auxiliary/scanner/cassandra/cassandra_enum` die kan worden gebruikt om Cassandra-services te scannen en informatie te verzamelen.

```
use auxiliary/scanner/cassandra/cassandra_enum
set RHOSTS <doel-IP>
run
```
```bash
pip install cqlsh
cqlsh <IP>
#Basic info enumeration
SELECT cluster_name, thrift_version, data_center, partitioner, native_protocol_version, rack, release_version from system.local;
#Keyspace enumeration
SELECT keyspace_name FROM system.schema_keyspaces;
desc <Keyspace_name>    #Decribe that DB
desc system_auth        #Describe the DB called system_auth
SELECT * from system_auth.roles;  #Retreive that info, can contain credential hashes
SELECT * from logdb.user_auth;    #Can contain credential hashes
SELECT * from logdb.user;
SELECT * from configuration."config";
```
### Outomaties

Daar is nie baie opsies hier nie en nmap verkry nie baie inligting nie.
```bash
nmap -sV --script cassandra-info -p <PORT> <IP>
```
### [**Brute force**](../generic-methodologies-and-resources/brute-force.md#cassandra)

### **Shodan**

`port:9160 Cluster`\
`port:9042 "Ongeldige of nie-ondersteunde protokolverise"`

<details>

<summary><strong>Leer AWS-hacking vanaf nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-repos.

</details>
