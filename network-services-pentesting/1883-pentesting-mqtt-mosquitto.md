# 1883 - рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ MQTT (Mosquitto)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреЗ рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud)** рдХреЛ PR рдЬрдорд╛ рдХрд░рдХреЗред

</details>

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

MQTT рдХрд╛ рдорддрд▓рдм рд╣реИ MQ Telemetry Transportред рдпрд╣ рдПрдХ рдкреНрд░рдХрд╛рд╢рд┐рдд/рд╕рджрд╕реНрдпрддрд╛, **рдЕрддреНрдпрдВрдд рд╕рд░рд▓ рдФрд░ рд╣рд▓реНрдХрд╛-рднрд╛рд░реА рд╕рдВрджреЗрд╢рди рдкреНрд░реЛрдЯреЛрдХреЙрд▓** рд╣реИ, рдЬреЛ рд╕реАрдорд┐рдд рдЙрдкрдХрд░рдгреЛрдВ рдФрд░ рдХрдо-рдмреИрдВрдбрд╡рд┐рдбреНрде, рдЙрдЪреНрдЪ-рд▓реНрдпрдЯреЗрдВрд╕реА рдпрд╛ рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрд╕рдХреЗ рдбрд┐рдЬрд╝рд╛рдЗрди рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рд╣реИрдВ рдХрд┐ рдиреЗрдЯрд╡рд░реНрдХ рдмреИрдВрдбрд╡рд┐рдбреНрде рдФрд░ рдЙрдкрдХрд░рдг рд╕рдВрд╕рд╛рдзрди рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдХрдо рд╕реЗ рдХрдо рдХрд░реЗрдВ, рд╕рд╛рде рд╣реА рдкрд╣реБрдВрдЪ рдХреА рдЧрд╛рд░рдВрдЯреА рдФрд░ рдХреБрдЫ рдорд╛рддреНрд░рд╛ рдореЗрдВ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдпрддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред рдпреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рднреА рд╕рд╛рдмрд┐рдд рд╣реЛрддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдорд╢реАрди-рд╕реЗ-рдорд╢реАрди (M2M) рдпрд╛ "рдЗрдВрдЯрд░рдиреЗрдЯ рдСрдл рдерд┐рдВрдЧреНрд╕" рджреБрдирд┐рдпрд╛ рдореЗрдВ рдЬреБрдбрд╝реЗ рд╣реБрдП рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдЖрджрд░реНрд╢ рд╣реИ, рдФрд░ рдмреИрдВрдбрд╡рд┐рдбреНрде рдФрд░ рдмреИрдЯрд░реА рдкрд╛рд╡рд░ рдорд╣рдВрдЧреЗ рд╣реЛрддреЗ рд╣реИрдВред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 1883
```
PORT     STATE SERVICE                 REASON
1883/tcp open  mosquitto version 1.4.8 syn-ack
```
## рдЯреНрд░реИрдлрд┐рдХ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛

MQTT рдмреНрд░реЛрдХрд░реНрд╕ CONNECT рдкреИрдХреЗрдЯ рдХреЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ CONNACK рдкреИрдХреЗрдЯ рднреЗрдЬрддреЗ рд╣реИрдВред **рд╡рд╛рдкрд╕реА рдХреЛрдб 0x00** рдорд╛рдиреНрдпрддрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЛ рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИ рдФрд░ **рд╡рд╛рдкрд╕реА рдХреЛрдб 0x05 рдорд╛рдиреНрдпрддрд╛ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЛ рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИ рдирд╣реАрдВред 0x05 рдЙрджрд╛рд╣рд░рдг:**

![](<../.gitbook/assets/image (645) (1).png>)

### [**MQTT рдХреЛ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕ рдХрд░рдирд╛**](../generic-methodologies-and-resources/brute-force.md#mqtt)

## MQTT рдХреЛ рдкреЗрдВрдЯреЗрд╕реНрдЯ рдХрд░рдирд╛

**рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╣реИ** рдФрд░ рдпрджрд┐ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рддреЛ **рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рд╣реЛрддрд╛** рд╣реИ (рдкреНрд░рдорд╛рдгрдкрддреНрд░ рд╕рд╛рдл рдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ рднреЗрдЬреЗ рдЬрд╛рддреЗ рд╣реИрдВ)ред MITM рд╣рдорд▓реЗ рдЕрднреА рднреА рдкрд╛рд╕рд╡рд░реНрдб рдЪреБрд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред

MQTT рд╕реЗрд╡рд╛ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдк рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [https://github.com/bapowell/python-mqtt-client-shell](https://github.com/bapowell/python-mqtt-client-shell) рдФрд░ рдЦреБрдж рдХреЛ рд╕рднреА рд╡рд┐рд╖рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдмреНрд╕рдХреНрд░рд╛рдЗрдм рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
> connect (NOTICE that you need to indicate before this the params of the connection, by default 127.0.0.1:1883)
> subscribe "#" 1
> subscribe "$SYS/#"
```
рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ [**https://github.com/akamai-threat-research/mqtt-pwn**](https://github.com/akamai-threat-research/mqtt-pwn)

рдЖрдк рднреА рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
apt-get install mosquitto mosquitto-clients
mosquitto_sub -t 'test/topic' -v #Subscriribe to 'test/topic'
```
рдпрд╛ рдЖрдк рдЗрд╕ рдХреЛрдб рдХреЛ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЖрдк MQTT рд╕реЗрд╡рд╛ рд╕реЗ рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХреЗрдВ, рд╣рд░ рд╡рд┐рд╖рдп рдХреА рд╕рджрд╕реНрдпрддрд╛ рд▓реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╕реБрдиреЗрдВ:
```python
#This is a modified version of https://github.com/Warflop/IOT-MQTT-Exploit/blob/master/mqtt.py
import paho.mqtt.client as mqtt
import time
import os

HOST = "127.0.0.1"
PORT = 1883

def on_connect(client, userdata, flags, rc):
client.subscribe('#', qos=1)
client.subscribe('$SYS/#')

def on_message(client, userdata, message):
print('Topic: %s | QOS: %s  | Message: %s' % (message.topic, message.qos, message.payload))

def main():
client = mqtt.Client()
client.on_connect = on_connect
client.on_message = on_message
client.connect(HOST, PORT)
client.loop_start()
#time.sleep(10)
#client.loop_stop()

if __name__ == "__main__":
main()
```
## рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА

рдпрд╣рд╛рдВ рд╕реЗ: [https://morphuslabs.com/hacking-the-iot-with-mqtt-8edaf0d07b9b](https://morphuslabs.com/hacking-the-iot-with-mqtt-8edaf0d07b9b)

### рдкрдмреНрд▓рд┐рд╢/рд╕рдмреНрд╕рдХреНрд░рд╛рдЗрдм рдкреИрдЯрд░реНрди <a href="#b667" id="b667"></a>

рдкрдмреНрд▓рд┐рд╢/рд╕рдмреНрд╕рдХреНрд░рд╛рдЗрдм рдореЙрдбрд▓ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╣реЛрддрд╛ рд╣реИ:

* **рдкрдмреНрд▓рд┐рд╢рд░**: рдмреНрд░реЛрдХрд░ рдореЗрдВ рдПрдХ (рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ) рдЯреЙрдкрд┐рдХ(рд╕) рдкрд░ рд╕рдВрджреЗрд╢ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред
* **рд╕рдмреНрд╕рдХреНрд░рд╛рдЗрдмрд░**: рдмреНрд░реЛрдХрд░ рдореЗрдВ рдПрдХ (рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ) рдЯреЙрдкрд┐рдХ(рд╕) рдХреА рд╕рджрд╕реНрдпрддрд╛ рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдкрдмреНрд▓рд┐рд╢рд░ рд╕реЗ рднреЗрдЬреЗ рдЧрдП рд╕рднреА рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред
* **рдмреНрд░реЛрдХрд░**: рдкрдмреНрд▓рд┐рд╢рд░реЛрдВ рд╕реЗ рд╕рдмреНрд╕рдХреНрд░рд╛рдЗрдмрд░реЛрдВ рддрдХ рд╕рднреА рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рдорд╛рд░реНрдЧрджрд░реНрд╢рди рдХрд░рддрд╛ рд╣реИред
* **рдЯреЙрдкрд┐рдХ**: рдПрдХ рдпрд╛ рдЕрдзрд┐рдХ рд╕реНрддрд░реЛрдВ рд╕реЗ рдорд┐рд▓рдХрд░ рдмрдирд╛ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рдЖрдЧреЗ рдХреА рдУрд░ рд╕реНрд▓реИрд╢ (/) рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рд╣реЛрддреЗ рд╣реИрдВ (рдЙрджрд╛., /smartshouse/livingroom/temperature)ред

![](https://miro.medium.com/max/1073/1\*sIxvchdgHSqAGebJjFHBAg.png)

### рдкреИрдХреЗрдЯ рдкреНрд░рд╛рд░реВрдк <a href="#f15a" id="f15a"></a>

рдкреНрд░рддреНрдпреЗрдХ MQTT рдкреИрдХреЗрдЯ рдореЗрдВ рдПрдХ рд╕реНрдерд┐рд░ рд╣реИрдбрд░ рд╣реЛрддрд╛ рд╣реИ (рдЪрд┐рддреНрд░ 02)ред рдЪрд┐рддреНрд░ 02: рд╕реНрдерд┐рд░ рд╣реИрдбрд░

![](https://miro.medium.com/max/838/1\*k6RkAHEk0576geQGUcKSTA.png)

рд╕реНрдерд┐рд░ рд╣реИрдбрд░ рдХрд╛ рдкрд╣рд▓рд╛ рдлрд╝реАрд▓реНрдб MQTT рдкреИрдХреЗрдЯ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рдкреНрд░рддрд┐рд╖реНрдард┐рдд рдХрд░рддрд╛ рд╣реИред рд╕рднреА рдкреИрдХреЗрдЯ рдкреНрд░рдХрд╛рд░ рдЯреЗрдмрд▓ 01 рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВред рдЯреЗрдмрд▓ 01: MQTT рдкреИрдХреЗрдЯ рдкреНрд░рдХрд╛рд░

![](https://miro.medium.com/max/1469/1\*z0fhdUVzGa0PLikH\_cyBmQ.png)

## рд╢реЛрдбрди

* `port:1883 MQTT`

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)** рдХрд╛** **рдЕрдиреБрд╕рд░рдг** рдХрд░реЗрдВред**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рдЕрдкрдирд╛ рдпреЛрдЧрджрд╛рди рджреЗрдВред**

</details>
