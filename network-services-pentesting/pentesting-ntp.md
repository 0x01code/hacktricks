# 123/udp - Pentesting NTP

<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **GitHub-Repositories** senden.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Treten Sie dem [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) Server bei, um mit erfahrenen Hackern und Bug-Bounty-J√§gern zu kommunizieren!

**Hacking Insights**\
Besch√§ftigen Sie sich mit Inhalten, die sich mit dem Nervenkitzel und den Herausforderungen des Hackens befassen.

**Echtzeit-Hack-News**\
Bleiben Sie mit der schnelllebigen Hacking-Welt durch Echtzeit-Nachrichten und Einblicke auf dem Laufenden.

**Neueste Ank√ºndigungen**\
Bleiben Sie √ºber die neuesten Bug-Bounties und wichtige Plattformupdates informiert.

**Treten Sie uns auf** [**Discord**](https://discord.com/invite/N3FrSbmwdy) **bei und beginnen Sie noch heute mit Top-Hackern zusammenzuarbeiten!**

## Grundlegende Informationen

Das **Network Time Protocol (NTP)** stellt sicher, dass Computer und Netzwerkger√§te in variabel verz√∂gerten Netzwerken ihre Uhren genau synchronisieren. Es ist entscheidend f√ºr die genaue Zeitmessung in IT-Betrieb, Sicherheit und Protokollierung. Die Genauigkeit von NTP ist wichtig, birgt aber auch Sicherheitsrisiken, wenn es nicht ordnungsgem√§√ü verwaltet wird.

### Zusammenfassung & Sicherheitstipps:
- **Zweck**: Synchronisiert Ger√§teuhren √ºber Netzwerke.
- **Bedeutung**: Kritisch f√ºr Sicherheit, Protokollierung und Betrieb.
- **Sicherheitsma√ünahmen**:
- Verwenden Sie vertrauensw√ºrdige NTP-Quellen mit Authentifizierung.
- Begrenzen Sie den Netzwerkzugriff auf NTP-Server.
- √úberwachen Sie die Synchronisation auf Anzeichen von Manipulation.

**Standardport:** 123/udp
```
PORT    STATE SERVICE REASON
123/udp open  ntp     udp-response
```
## Enumeration

Die Enumeration ist der Prozess, bei dem Informationen √ºber ein Zielsystem gesammelt werden, um Schwachstellen zu identifizieren und potenzielle Angriffspunkte zu finden. Bei der Enumeration von NTP (Network Time Protocol) k√∂nnen folgende Techniken verwendet werden:

### NTP-Scan

NTP-Scan ist ein Tool, das verwendet werden kann, um NTP-Server zu erkennen und Informationen √ºber sie zu sammeln. Es kann verwendet werden, um die Version des NTP-Servers, die verwendeten Algorithmen und die unterst√ºtzten Modi zu ermitteln.

```plaintext
ntp-scan <IP-Adresse>
```

### NTP-Server-Abfrage

Die Abfrage eines NTP-Servers kann Informationen √ºber den Server und seine Konfiguration liefern. Dies kann mit dem Befehl `ntpq` durchgef√ºhrt werden.

```plaintext
ntpq -p <IP-Adresse>
```

### NTP-Server-Reflektion

NTP-Server k√∂nnen f√ºr Reflektionsangriffe missbraucht werden, bei denen der Angreifer gef√§lschte Anfragen an den Server sendet und die Antworten an das Opfer weiterleitet. Dies kann mit dem Tool `ntpdc` √ºberpr√ºft werden.

```plaintext
ntpdc -c monlist <IP-Adresse>
```

### NTP-Paketsniffing

Durch das Sniffen von NTP-Paketen k√∂nnen Informationen √ºber den NTP-Verkehr und potenzielle Schwachstellen im Netzwerk erlangt werden. Tools wie Wireshark k√∂nnen verwendet werden, um den NTP-Verkehr zu analysieren.

```plaintext
wireshark
```

### NTP-Zeitstempel-Manipulation

NTP-Zeitstempel k√∂nnen manipuliert werden, um Angriffe wie Replay-Angriffe oder Denial-of-Service-Angriffe durchzuf√ºhren. Tools wie `ntpdate` k√∂nnen verwendet werden, um die Zeitstempel zu √§ndern.

```plaintext
ntpdate -q <IP-Adresse>
```

Die Enumeration von NTP-Servern kann wertvolle Informationen liefern, die bei der Durchf√ºhrung von Penetrationstests und Sicherheitsaudits verwendet werden k√∂nnen. Es ist wichtig, diese Techniken verantwortungsbewusst und im Rahmen der geltenden Gesetze und Vorschriften einzusetzen.
```bash
ntpq -c readlist <IP_ADDRESS>
ntpq -c readvar <IP_ADDRESS>
ntpq -c peers <IP_ADDRESS>
ntpq -c associations <IP_ADDRESS>
ntpdc -c monlist <IP_ADDRESS>
ntpdc -c listpeers <IP_ADDRESS>
ntpdc -c sysinfo <IP_ADDRESS>
```

```bash
nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 <IP>
```
## Untersuchung der Konfigurationsdateien

* ntp.conf

## NTP Amplification Attack

[**Wie der NTP DDoS-Angriff funktioniert**](https://resources.infosecinstitute.com/network-time-protocol-ntp-threats-countermeasures/#gref)

Das **NTP-Protokoll** verwendet UDP und erm√∂glicht den Betrieb ohne die Notwendigkeit von Handshake-Prozeduren im Gegensatz zu TCP. Diese Eigenschaft wird bei **NTP DDoS Amplification Attacks** ausgenutzt. Hier erstellen Angreifer Pakete mit einer gef√§lschten Quell-IP, sodass es so aussieht, als k√§men die Anfragen von dem Opfer. Diese anf√§nglich kleinen Pakete veranlassen den NTP-Server, mit viel gr√∂√üeren Datenmengen zu antworten und den Angriff zu verst√§rken.

Der Befehl **_MONLIST_**, obwohl selten verwendet, kann die letzten 600 Clients melden, die mit dem NTP-Dienst verbunden waren. Obwohl der Befehl selbst einfach ist, verdeutlicht sein Missbrauch bei solchen Angriffen kritische Sicherheitsl√ºcken.
```bash
ntpdc -n -c monlist <IP>
```
## Shodan

* `ntp`

## HackTricks Automatische Befehle
```
Protocol_Name: NTP    #Protocol Abbreviation if there is one.
Port_Number:  123     #Comma separated if there is more than one.
Protocol_Description: Network Time Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for NTP
Note: |
The Network Time Protocol (NTP) ensures computers and network devices across variable-latency networks sync their clocks accurately. It's vital for maintaining precise timekeeping in IT operations, security, and logging. NTP's accuracy is essential, but it also poses security risks if not properly managed.

https://book.hacktricks.xyz/pentesting/pentesting-ntp

Entry_2:
Name: Nmap
Description: Enumerate NTP
Command: nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 {IP}
```
<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Treten Sie dem [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) Server bei, um mit erfahrenen Hackern und Bug-Bounty-J√§gern zu kommunizieren!

**Hacking Insights**\
Besch√§ftigen Sie sich mit Inhalten, die sich mit dem Nervenkitzel und den Herausforderungen des Hackens befassen.

**Echtzeit-Hack-News**\
Bleiben Sie mit den neuesten Nachrichten und Einblicken aus der schnelllebigen Hacking-Welt auf dem Laufenden.

**Neueste Ank√ºndigungen**\
Bleiben Sie √ºber die neuesten Bug-Bounties und wichtige Plattform-Updates informiert.

**Treten Sie uns bei** [**Discord**](https://discord.com/invite/N3FrSbmwdy) bei und beginnen Sie noch heute mit der Zusammenarbeit mit Top-Hackern!

<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
