# 123/udp - Pentesting NTP

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR a** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Unisciti al server [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) per comunicare con hacker esperti e cacciatori di bug bounty!

**Insight sull'hacking**\
Interagisci con contenuti che approfondiscono l'emozione e le sfide dell'hacking

**Notizie sull'hacking in tempo reale**\
Resta aggiornato sul mondo dell'hacking frenetico attraverso notizie e approfondimenti in tempo reale

**Ultime notizie**\
Rimani informato sul lancio delle nuove bug bounty e sugli aggiornamenti cruciali della piattaforma

**Unisciti a noi su** [**Discord**](https://discord.com/invite/N3FrSbmwdy) e inizia a collaborare con i migliori hacker oggi stesso!

## Informazioni di base

Il **Network Time Protocol (NTP)** garantisce che i computer e i dispositivi di rete su reti a latenza variabile sincronizzino accuratamente i loro orologi. √à fondamentale per mantenere una precisa sincronizzazione del tempo nelle operazioni IT, nella sicurezza e nella registrazione. L'accuratezza di NTP √® essenziale, ma presenta anche rischi per la sicurezza se non viene gestito correttamente.

### Riassunto e consigli di sicurezza:
- **Scopo**: Sincronizza gli orologi dei dispositivi tramite reti.
- **Importanza**: Critico per la sicurezza, la registrazione e le operazioni.
- **Misure di sicurezza**:
- Utilizzare fonti NTP affidabili con autenticazione.
- Limitare l'accesso alla rete del server NTP.
- Monitorare la sincronizzazione per segni di manomissione.

**Porta predefinita:** 123/udp
```
PORT    STATE SERVICE REASON
123/udp open  ntp     udp-response
```
## Enumerazione

### NTP (Network Time Protocol)

NTP √® un protocollo di rete utilizzato per sincronizzare l'orologio di un sistema con un server di riferimento. Durante la fase di enumerazione, √® possibile eseguire diverse attivit√† per raccogliere informazioni sul server NTP target.

#### Scansione delle porte

Per iniziare, √® possibile eseguire una scansione delle porte per identificare se il server NTP √® in ascolto su una porta specifica. √à possibile utilizzare strumenti come Nmap per eseguire una scansione delle porte TCP e UDP.

```plaintext
nmap -p 123 <indirizzo_IP>
```

#### Query NTP

Successivamente, √® possibile eseguire una query NTP per ottenere informazioni sul server NTP target. √à possibile utilizzare il comando `ntpdate` per eseguire una query NTP.

```plaintext
ntpdate -q <indirizzo_IP>
```

#### Analisi delle risposte

Infine, √® possibile analizzare le risposte ottenute durante la query NTP per identificare eventuali vulnerabilit√† o informazioni utili. Ad esempio, √® possibile verificare se il server NTP √® configurato per consentire query anonime o se √® vulnerabile a attacchi di amplificazione NTP.

Durante l'analisi delle risposte, √® importante prestare attenzione a eventuali informazioni sensibili che potrebbero essere state rivelate, come indirizzi IP interni o nomi di host. Queste informazioni potrebbero essere utilizzate per condurre attacchi mirati o per ulteriori fasi di enumerazione.
```bash
ntpq -c readlist <IP_ADDRESS>
ntpq -c readvar <IP_ADDRESS>
ntpq -c peers <IP_ADDRESS>
ntpq -c associations <IP_ADDRESS>
ntpdc -c monlist <IP_ADDRESS>
ntpdc -c listpeers <IP_ADDRESS>
ntpdc -c sysinfo <IP_ADDRESS>
```

```bash
nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 <IP>
```
## Esaminare i file di configurazione

* ntp.conf

## Attacco di amplificazione NTP

[**Come funziona l'attacco DDoS NTP**](https://resources.infosecinstitute.com/network-time-protocol-ntp-threats-countermeasures/#gref)

Il protocollo **NTP**, utilizzando UDP, consente di funzionare senza la necessit√† di procedure di handshake, a differenza di TCP. Questa caratteristica viene sfruttata negli attacchi di amplificazione **DDoS NTP**. Qui, gli attaccanti creano pacchetti con un falso indirizzo IP di origine, facendo sembrare che le richieste di attacco provengano dalla vittima. Questi pacchetti, inizialmente di piccole dimensioni, inducono il server NTP a rispondere con volumi di dati molto pi√π grandi, amplificando l'attacco.

Il comando **_MONLIST_**, nonostante il suo raro utilizzo, pu√≤ riportare gli ultimi 600 client connessi al servizio NTP. Sebbene il comando stesso sia semplice, il suo uso improprio in tali attacchi evidenzia vulnerabilit√† di sicurezza critiche.
```bash
ntpdc -n -c monlist <IP>
```
## Shodan

* `ntp`

## Comandi Automatici di HackTricks
```
Protocol_Name: NTP    #Protocol Abbreviation if there is one.
Port_Number:  123     #Comma separated if there is more than one.
Protocol_Description: Network Time Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for NTP
Note: |
The Network Time Protocol (NTP) ensures computers and network devices across variable-latency networks sync their clocks accurately. It's vital for maintaining precise timekeeping in IT operations, security, and logging. NTP's accuracy is essential, but it also poses security risks if not properly managed.

https://book.hacktricks.xyz/pentesting/pentesting-ntp

Entry_2:
Name: Nmap
Description: Enumerate NTP
Command: nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 {IP}
```
<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Unisciti al server [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) per comunicare con hacker esperti e cacciatori di bug!

**Approfondimenti sull'hacking**\
Interagisci con contenuti che approfondiscono l'emozione e le sfide dell'hacking

**Notizie sull'hacking in tempo reale**\
Resta aggiornato sul mondo dell'hacking frenetico attraverso notizie e approfondimenti in tempo reale

**Ultime notizie**\
Rimani informato sul lancio dei nuovi bug bounty e sugli aggiornamenti cruciali della piattaforma

**Unisciti a noi su** [**Discord**](https://discord.com/invite/N3FrSbmwdy) e inizia a collaborare con i migliori hacker oggi stesso!

<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di [**NFT**](https://opensea.io/collection/the-peass-family) esclusivi
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository github di** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
