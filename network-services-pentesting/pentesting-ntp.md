# 123/udp - Pentesting NTP

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof est la plateforme des primes de bugs cryptographiques.**

**Obtenez des r√©compenses sans d√©lai**\
Les primes HackenProof sont lanc√©es uniquement lorsque les clients d√©posent le budget de r√©compense. Vous recevrez la r√©compense apr√®s la v√©rification du bug.

**Acqu√©rez de l'exp√©rience en pentesting web3**\
Les protocoles blockchain et les contrats intelligents sont le nouvel Internet ! Ma√Ætrisez la s√©curit√© web3 d√®s ses d√©buts.

**Devenez la l√©gende du hacker web3**\
Gagnez des points de r√©putation avec chaque bug v√©rifi√© et conqu√©rez le sommet du classement hebdomadaire.

[**Inscrivez-vous sur HackenProof**](https://hackenproof.com/register) commencez √† gagner gr√¢ce √† vos hacks !

{% embed url="https://hackenproof.com/register" %}

## Informations de base

Le protocole Network Time Protocol (**NTP**) est un protocole de r√©seau permettant la synchronisation des horloges entre les syst√®mes informatiques via des r√©seaux de donn√©es √† commutation de paquets et √† latence variable.

**Port par d√©faut :** 123/udp
```
PORT    STATE SERVICE REASON
123/udp open  ntp     udp-response
```
## √ânum√©ration

### NTP (Network Time Protocol)

Le protocole NTP (Network Time Protocol) est utilis√© pour synchroniser l'horloge des syst√®mes informatiques sur un r√©seau. Lors d'un test de p√©n√©tration, l'√©num√©ration du service NTP peut fournir des informations pr√©cieuses sur le r√©seau cible.

#### Analyse des ports

Utilisez un scanner de ports pour identifier les syst√®mes qui ex√©cutent le service NTP. Le port par d√©faut pour le protocole NTP est le port 123.

```
nmap -p 123 <cible>
```

#### Interrogation du serveur NTP

Une fois que vous avez identifi√© un serveur NTP, vous pouvez interroger le serveur pour obtenir des informations suppl√©mentaires. Utilisez la commande `ntpdate` pour interroger le serveur NTP et obtenir l'heure actuelle.

```
ntpdate -q <serveur NTP>
```

#### Analyse des r√©ponses

L'analyse des r√©ponses du serveur NTP peut r√©v√©ler des informations telles que l'adresse IP du serveur, le nom du serveur, la version du protocole NTP utilis√©e et d'autres d√©tails.

#### Exploitation des vuln√©rabilit√©s

Une fois que vous avez identifi√© les informations sur le serveur NTP, vous pouvez rechercher des vuln√©rabilit√©s connues et des exploits associ√©s. Certains exemples de vuln√©rabilit√©s courantes dans les serveurs NTP incluent les attaques par d√©ni de service (DoS) et les vuln√©rabilit√©s de d√©bordement de tampon.

#### Conclusion

L'√©num√©ration du service NTP peut fournir des informations pr√©cieuses lors d'un test de p√©n√©tration. En identifiant les serveurs NTP et en analysant leurs r√©ponses, vous pouvez d√©couvrir des vuln√©rabilit√©s potentielles √† exploiter.
```bash
ntpq -c readlist <IP_ADDRESS>
ntpq -c readvar <IP_ADDRESS>
ntpq -c peers <IP_ADDRESS>
ntpq -c associations <IP_ADDRESS>
ntpdc -c monlist <IP_ADDRESS>
ntpdc -c listpeers <IP_ADDRESS>
ntpdc -c sysinfo <IP_ADDRESS>
```

```bash
nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 <IP>
```
## Examiner les fichiers de configuration

* ntp.conf

## Attaque d'amplification NTP

[**Comment fonctionne l'attaque DDoS NTP**](https://resources.infosecinstitute.com/network-time-protocol-ntp-threats-countermeasures/#gref)

Le protocole NTP utilise par conception UDP pour fonctionner, ce qui ne n√©cessite aucune poign√©e de main comme TCP, donc aucun enregistrement de la demande. Ainsi, l'attaque d'amplification NTP DDoS commence lorsque un attaquant cr√©e des paquets avec une adresse IP source falsifi√©e pour que les paquets semblent provenir de la cible pr√©vue et les envoie au serveur NTP. L'attaquant cr√©e initialement le paquet de quelques octets, mais NTP r√©pond avec une grande quantit√© de donn√©es, contribuant ainsi √† l'amplification de cette attaque.

Commande _MONLIST_ : Il s'agit d'une commande du protocole NTP qui a tr√®s peu d'utilit√©, mais c'est cette commande qui est le principal coupable de cette attaque. Cependant, l'utilisation de la commande MONLIST est de donner des d√©tails sur les 600 derniers clients qui se sont connect√©s au service de temps NTP. Voici la syntaxe de la commande :
```bash
ntpdc -n -c monlist <IP>
```
## Shodan

* `ntp`

## Commandes automatiques HackTricks
```
Protocol_Name: NTP    #Protocol Abbreviation if there is one.
Port_Number:  123     #Comma separated if there is more than one.
Protocol_Description: Network Time Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for NTP
Note: |
The Network Time Protocol (NTP) is a networking protocol for clock synchronization between computer systems over packet-switched, variable-latency data networks.

https://book.hacktricks.xyz/pentesting/pentesting-ntp

Entry_2:
Name: Nmap
Description: Enumerate NTP
Command: nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 {IP}
```
<figure><img src="../../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof est le lieu de tous les programmes de primes pour les bugs de cryptographie.**

**Obtenez une r√©compense sans d√©lai**\
Les primes HackenProof ne sont lanc√©es que lorsque leurs clients d√©posent le budget de r√©compense. Vous recevrez la r√©compense apr√®s la v√©rification du bug.

**Acqu√©rez de l'exp√©rience en pentesting web3**\
Les protocoles blockchain et les contrats intelligents sont le nouvel Internet ! Ma√Ætrisez la s√©curit√© web3 d√®s ses d√©buts.

**Devenez la l√©gende du hacker web3**\
Gagnez des points de r√©putation avec chaque bug v√©rifi√© et conqu√©rez le sommet du classement hebdomadaire.

[**Inscrivez-vous sur HackenProof**](https://hackenproof.com/register) et commencez √† gagner gr√¢ce √† vos hacks !

{% embed url="https://hackenproof.com/register" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
