# 123/udp - NTP Pentesting

<details>

<summary><strong>AWS hacklemeyi sıfırdan kahraman olmak için</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI'na**](https://github.com/sponsors/carlospolop) göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi paylaşarak** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına **PR göndererek** katkıda bulunun.

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve ödül avcılarıyla iletişim kurmak için [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katılın!

**Hacking İçgörüleri**\
Hacking'in heyecanına ve zorluklarına dalmış içeriklerle etkileşim kurun

**Gerçek Zamanlı Hack Haberleri**\
Hızlı tempolu hacking dünyasını gerçek zamanlı haberler ve içgörülerle takip edin

**En Son Duyurular**\
Yeni ödül avları başlatma ve önemli platform güncellemeleri hakkında bilgi sahibi olun

**Bize katılın** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugün en iyi hackerlarla işbirliği yapmaya başlayın!

## Temel Bilgiler

**Network Time Protocol (NTP)**, değişken gecikmeli ağlar üzerindeki bilgisayarların ve ağ cihazlarının saatlerini doğru bir şekilde senkronize etmeyi sağlar. IT işlemleri, güvenlik ve günlükleme için hassas zaman tutma için önemlidir. NTP'nin doğruluğu önemlidir, ancak uygun şekilde yönetilmezse güvenlik riskleri oluşturabilir.

### Özet ve Güvenlik İpuçları:
- **Amaç**: Ağ üzerinde cihaz saatlerini senkronize eder.
- **Önemi**: Güvenlik, günlükleme ve işlemler için kritiktir.
- **Güvenlik Önlemleri**:
- Kimlik doğrulamalı güvenilir NTP kaynakları kullanın.
- NTP sunucusunun ağ erişimini sınırlayın.
- Sahtecilik belirtilerini tespit etmek için senkronizasyonu izleyin.

**Varsayılan port:** 123/udp
```
PORT    STATE SERVICE REASON
123/udp open  ntp     udp-response
```
## Numaralandırma

### NTP Sunucu Keşfi

NTP (Network Time Protocol), ağdaki cihazların zaman senkronizasyonunu sağlamak için kullanılan bir protokoldür. NTP sunucuları, ağdaki cihazlara doğru zamanı sağlamak için kullanılır. NTP sunucularını keşfetmek için aşağıdaki adımları izleyebilirsiniz:

1. **Nmap** kullanarak NTP sunucularını taramak için aşağıdaki komutu kullanın:
```bash
nmap -p 123 --script ntp-info <hedef-ip-adresi>
```
2. **ntpdate** komutunu kullanarak NTP sunucusuna bağlanmak için aşağıdaki komutu kullanın:
```bash
ntpdate -q <hedef-ip-adresi>
```
3. **ntpq** komutunu kullanarak NTP sunucusuna bağlanmak için aşağıdaki komutu kullanın:
```bash
ntpq -p <hedef-ip-adresi>
```

### NTP Sunucu Zayıflıkları

NTP sunucuları bazı zayıflıklara sahip olabilir. Bu zayıflıkları tespit etmek için aşağıdaki adımları izleyebilirsiniz:

1. **Nmap** kullanarak NTP sunucularını taramak için aşağıdaki komutu kullanın:
```bash
nmap -p 123 --script ntp-monlist <hedef-ip-adresi>
```
2. **ntpdc** komutunu kullanarak NTP sunucusuna bağlanmak için aşağıdaki komutu kullanın:
```bash
ntpdc -c monlist <hedef-ip-adresi>
```

### NTP Sunucu Saldırıları

NTP sunucuları, bazı saldırılara karşı savunmasız olabilir. Bu saldırıları gerçekleştirmek için aşağıdaki adımları izleyebilirsiniz:

1. **NTP Amplifikasyon Saldırısı**: NTP sunucusunu kullanarak bir hedefe büyük miktarda trafik göndermek için aşağıdaki adımları izleyin:
   - **Nmap** kullanarak NTP sunucularını taramak için aşağıdaki komutu kullanın:
   ```bash
   nmap -p 123 --script ntp-monlist <hedef-ip-adresi>
   ```
   - **hping3** kullanarak NTP sunucusuna büyük miktarda trafik göndermek için aşağıdaki komutu kullanın:
   ```bash
   hping3 -c <paket-sayısı> -d <paket-boyutu> -S -w 64 -p 123 --ntp-server <hedef-ip-adresi>
   ```
2. **NTP Zaman Saldırısı**: NTP sunucusunu kullanarak bir hedefin zamanını değiştirmek için aşağıdaki adımları izleyin:
   - **ntpdate** komutunu kullanarak NTP sunucusuna bağlanmak için aşağıdaki komutu kullanın:
   ```bash
   ntpdate -q <hedef-ip-adresi>
   ```
   - **ntpdate** komutunu kullanarak NTP sunucusuna bağlanmak ve hedefin zamanını değiştirmek için aşağıdaki komutu kullanın:
   ```bash
   ntpdate -u <hedef-ip-adresi>
   ```
```bash
ntpq -c readlist <IP_ADDRESS>
ntpq -c readvar <IP_ADDRESS>
ntpq -c peers <IP_ADDRESS>
ntpq -c associations <IP_ADDRESS>
ntpdc -c monlist <IP_ADDRESS>
ntpdc -c listpeers <IP_ADDRESS>
ntpdc -c sysinfo <IP_ADDRESS>
```

```bash
nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 <IP>
```
## Yapılandırma dosyalarını inceleyin

* ntp.conf

## NTP Amplifikasyon Saldırısı

[**NTP DDoS Saldırısı Nasıl Çalışır**](https://resources.infosecinstitute.com/network-time-protocol-ntp-threats-countermeasures/#gref)

UDP kullanan **NTP protokolü**, TCP gibi el sıkışma prosedürleri gerektirmeksizin çalışabilme özelliğine sahiptir. Bu özellik, **NTP DDoS amplifikasyon saldırılarında** istismar edilir. Burada saldırganlar, saldırı isteklerinin kurban tarafından geldiği gibi görünmesini sağlamak için sahte bir kaynak IP ile paketler oluştururlar. Bu paketler, başlangıçta küçük olsa da, NTP sunucusunu daha büyük veri hacimleriyle yanıtlamaya teşvik ederek saldırıyı büyütür.

**_MONLIST_** komutu, nadiren kullanılsa da, NTP hizmetine bağlanan son 600 istemciyi raporlayabilir. Komut kendisi basit olsa da, bu tür saldırılarda yanlış kullanımı, kritik güvenlik açıklarını ortaya çıkarır.
```bash
ntpdc -n -c monlist <IP>
```
## Shodan

* `ntp`

## HackTricks Otomatik Komutları
```
Protocol_Name: NTP    #Protocol Abbreviation if there is one.
Port_Number:  123     #Comma separated if there is more than one.
Protocol_Description: Network Time Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for NTP
Note: |
The Network Time Protocol (NTP) ensures computers and network devices across variable-latency networks sync their clocks accurately. It's vital for maintaining precise timekeeping in IT operations, security, and logging. NTP's accuracy is essential, but it also poses security risks if not properly managed.

https://book.hacktricks.xyz/pentesting/pentesting-ntp

Entry_2:
Name: Nmap
Description: Enumerate NTP
Command: nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 {IP}
```
<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Deneyimli hackerlar ve ödül avcıları ile iletişim kurmak için [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) sunucusuna katılın!

**Hacking İçgörüleri**\
Hacking'in heyecanına ve zorluklarına dalmış içeriklerle etkileşim kurun

**Gerçek Zamanlı Hack Haberleri**\
Gerçek zamanlı haberler ve içgörüler aracılığıyla hızlı tempolu hacking dünyasında güncel kalın

**En Son Duyurular**\
Yeni ödül avcılarının başlatılması ve önemli platform güncellemeleri hakkında bilgilendirin

**Bize katılın** [**Discord**](https://discord.com/invite/N3FrSbmwdy) ve bugün en iyi hackerlarla işbirliği yapmaya başlayın!

<details>

<summary><strong>Sıfırdan kahraman olmak için AWS hackleme öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* Şirketinizi **HackTricks'te reklam vermek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) katılın veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u takip edin**
* Hacking hilelerinizi **HackTricks** ve **HackTricks Cloud** github depolarına PR göndererek paylaşın.

</details>
