# 123/udp - Pentesting NTP

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? Ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Rejoignez le serveur [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) pour communiquer avec des hackers exp√©riment√©s et des chasseurs de primes !

**Perspectives de piratage**\
Engagez-vous avec du contenu qui explore les sensations et les d√©fis du piratage

**Actualit√©s de piratage en temps r√©el**\
Restez √† jour avec le monde du piratage rapide gr√¢ce aux actualit√©s et aux informations en temps r√©el

**Derni√®res annonces**\
Restez inform√© des derni√®res primes de bugs lanc√©es et des mises √† jour cruciales de la plateforme

**Rejoignez-nous sur** [**Discord**](https://discord.com/invite/N3FrSbmwdy) et commencez √† collaborer avec les meilleurs hackers d√®s aujourd'hui !

## Informations de base

Le protocole Network Time Protocol (**NTP**) est un protocole de r√©seau permettant la synchronisation des horloges entre les syst√®mes informatiques via des r√©seaux de donn√©es √† commutation de paquets et √† latence variable.

**Port par d√©faut :** 123/udp
```
PORT    STATE SERVICE REASON
123/udp open  ntp     udp-response
```
## √ânum√©ration

### NTP (Network Time Protocol)

Le protocole NTP (Network Time Protocol) est utilis√© pour synchroniser l'horloge des syst√®mes informatiques sur un r√©seau. Lors d'un test de p√©n√©tration, l'√©num√©ration du service NTP peut fournir des informations pr√©cieuses sur le r√©seau cible.

#### Analyse des ports

Utilisez un scanner de ports pour identifier les syst√®mes qui ex√©cutent le service NTP. Le port par d√©faut pour le protocole NTP est le port 123.

```
nmap -p 123 <cible>
```

#### Interrogation du serveur NTP

Une fois que vous avez identifi√© un serveur NTP, vous pouvez interroger le serveur pour obtenir des informations suppl√©mentaires. Utilisez la commande `ntpdate` pour interroger le serveur NTP et obtenir l'heure actuelle.

```
ntpdate -q <serveur NTP>
```

#### Analyse des r√©ponses

Analysez les r√©ponses du serveur NTP pour identifier les versions du protocole NTP et les informations sur le syst√®me d'exploitation. Ces informations peuvent √™tre utiles pour identifier les vuln√©rabilit√©s connues.

#### Attaques de d√©ni de service

Le protocole NTP est vuln√©rable aux attaques de d√©ni de service (DoS). Vous pouvez utiliser des outils tels que `ntpdc` pour envoyer des paquets NTP malveillants et perturber le fonctionnement du serveur NTP.

```
ntpdc -c monlist <serveur NTP>
```

#### Exploitation des vuln√©rabilit√©s

Si vous identifiez des vuln√©rabilit√©s connues dans le serveur NTP, vous pouvez les exploiter pour obtenir un acc√®s non autoris√© au syst√®me cible. Assurez-vous de disposer des autorisations appropri√©es avant de proc√©der √† une exploitation.

#### R√©sum√©

L'√©num√©ration du service NTP peut fournir des informations pr√©cieuses sur le r√©seau cible, y compris les versions du protocole NTP et les informations sur le syst√®me d'exploitation. Il est important de noter que l'exploitation de vuln√©rabilit√©s dans un serveur NTP peut √™tre ill√©gale et doit √™tre effectu√©e avec les autorisations appropri√©es.
```bash
ntpq -c readlist <IP_ADDRESS>
ntpq -c readvar <IP_ADDRESS>
ntpq -c peers <IP_ADDRESS>
ntpq -c associations <IP_ADDRESS>
ntpdc -c monlist <IP_ADDRESS>
ntpdc -c listpeers <IP_ADDRESS>
ntpdc -c sysinfo <IP_ADDRESS>
```

```bash
nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 <IP>
```
## Examiner les fichiers de configuration

* ntp.conf

## Attaque d'amplification NTP

[**Comment fonctionne l'attaque DDoS NTP**](https://resources.infosecinstitute.com/network-time-protocol-ntp-threats-countermeasures/#gref)

Le protocole NTP utilise par conception UDP pour fonctionner, ce qui ne n√©cessite aucune poign√©e de main comme TCP, donc aucun enregistrement de la demande. Ainsi, l'attaque d'amplification NTP DDoS commence lorsque un attaquant cr√©e des paquets avec une adresse IP source falsifi√©e pour que les paquets semblent provenir de la cible pr√©vue et les envoie au serveur NTP. L'attaquant cr√©e initialement le paquet de quelques octets, mais NTP r√©pond avec une grande quantit√© de donn√©es, contribuant ainsi √† l'amplification de cette attaque.

Commande _MONLIST_ : Il s'agit d'une commande du protocole NTP qui a tr√®s peu d'utilit√©, mais c'est cette commande qui est le principal coupable de cette attaque. Cependant, l'utilisation de la commande MONLIST est de donner des d√©tails sur les 600 derniers clients qui se sont connect√©s au service de temps NTP. Voici la syntaxe de la commande :
```bash
ntpdc -n -c monlist <IP>
```
## Shodan

* `ntp`

## Commandes automatiques HackTricks
```
Protocol_Name: NTP    #Protocol Abbreviation if there is one.
Port_Number:  123     #Comma separated if there is more than one.
Protocol_Description: Network Time Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for NTP
Note: |
The Network Time Protocol (NTP) is a networking protocol for clock synchronization between computer systems over packet-switched, variable-latency data networks.

https://book.hacktricks.xyz/pentesting/pentesting-ntp

Entry_2:
Name: Nmap
Description: Enumerate NTP
Command: nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 {IP}
```
<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

Rejoignez le serveur [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) pour communiquer avec des hackers exp√©riment√©s et des chasseurs de primes en s√©curit√© !

**Perspectives de piratage**\
Engagez-vous avec du contenu qui explore les sensations fortes et les d√©fis du piratage.

**Actualit√©s de piratage en temps r√©el**\
Restez √† jour avec le monde du piratage en constante √©volution gr√¢ce √† des actualit√©s et des informations en temps r√©el.

**Derni√®res annonces**\
Restez inform√© des derni√®res primes de bugs lanc√©es et des mises √† jour cruciales de la plateforme.

**Rejoignez-nous sur** [**Discord**](https://discord.com/invite/N3FrSbmwdy) et commencez √† collaborer avec les meilleurs hackers d√®s aujourd'hui !

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Travaillez-vous dans une **entreprise de cybers√©curit√©** ? Voulez-vous voir votre **entreprise annonc√©e dans HackTricks** ? Ou voulez-vous avoir acc√®s √† la **derni√®re version de PEASS ou t√©l√©charger HackTricks en PDF** ? Consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family).
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com).
* **Rejoignez le** [**üí¨**](https://emojipedia.org/speech-balloon/) [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR au** [**repo hacktricks**](https://github.com/carlospolop/hacktricks) **et au** [**repo hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
