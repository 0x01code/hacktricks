# 110,995 - POP Pentesting

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

* **사이버 보안 회사**에서 일하시나요? **회사를 HackTricks에서 광고**하거나 **PEASS의 최신 버전에 액세스**하거나 HackTricks를 **PDF로 다운로드**하고 싶으신가요? [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)를 확인해보세요!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견해보세요. 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter**에서 저를 **팔로우**하세요 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **해킹 트릭을 공유하려면 [hacktricks repo](https://github.com/carlospolop/hacktricks) 및 [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**에 PR을 제출하세요.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

가장 중요한 취약점을 찾아서 더 빠르게 수정하세요. Intruder는 공격 표면을 추적하고 적극적인 위협 스캔을 실행하여 API부터 웹 앱 및 클라우드 시스템까지 전체 기술 스택에서 문제를 찾습니다. [**무료로 시도해보세요**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) 오늘.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## 기본 정보

**포스트 오피스 프로토콜 (POP)**은 컴퓨터 네트워킹과 인터넷 영역에서 사용되는 프로토콜로, 원격 메일 서버에서 이메일을 추출하고 검색하여 로컬 장치에서 액세스할 수 있게 합니다. OSI 모델의 응용 계층에 위치한 이 프로토콜은 사용자가 이메일을 가져오고 받을 수 있도록 합니다. **POP 클라이언트**의 작동은 일반적으로 메일 서버에 연결을 설정하고 모든 메시지를 다운로드한 다음 이러한 메시지를 클라이언트 시스템에 로컬로 저장하고 서버에서 제거하는 것을 포함합니다. 이 프로토콜의 세 가지 버전이 있지만, **POP3**가 가장 널리 사용되는 버전입니다.


**기본 포트:** 110, 995(ssl)
```
PORT    STATE SERVICE
110/tcp open  pop3
```
### 배너 그랩핑

배너 그랩핑은 네트워크 서비스의 버전 및 운영 체제 정보를 수집하기 위해 사용되는 기술입니다. 이를 통해 공격자는 취약점을 찾고 악용할 수 있는 서비스를 식별할 수 있습니다.

배너 그랩핑은 다양한 도구를 사용하여 수행할 수 있습니다. 일반적으로 `telnet`, `nc`, `nmap` 등의 도구를 사용합니다. 이러한 도구를 사용하여 서비스에 연결하고 서비스가 응답하는 배너 정보를 확인할 수 있습니다.

배너 정보에는 서비스의 버전, 운영 체제, 패치 수준 등이 포함될 수 있습니다. 이 정보는 공격자에게 취약점을 찾고 악용하는 데 도움이 될 수 있습니다.

배너 그랩핑은 네트워크 서비스의 취약점 평가 및 펜테스팅 과정에서 중요한 단계입니다. 이를 통해 공격자는 취약한 서비스를 식별하고 적절한 공격 기술을 적용할 수 있습니다.
```bash
nc -nv <IP> 110
openssl s_client -connect <IP>:995 -crlf -quiet
```
## 매뉴얼

POP3 서버의 기능을 얻기 위해 `CAPA` 명령어를 사용할 수 있습니다.

## 자동화된 방법
```bash
nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -port <PORT> <IP> #All are default scripts
```
`pop3-ntlm-info` 플러그인은 일부 "**민감한**" 데이터(Windows 버전)를 반환합니다.

### [POP3 브루트포스](../generic-methodologies-and-resources/brute-force.md#pop)

## POP 구문

[여기](http://sunnyoasis.com/services/emailviatelnet.html)에서 POP 명령어 예제를 확인할 수 있습니다.
```bash
POP commands:
USER uid           Log in as "uid"
PASS password      Substitue "password" for your actual password
STAT               List number of messages, total mailbox size
LIST               List messages and sizes
RETR n             Show message n
DELE n             Mark message n for deletion
RSET               Undo any changes
QUIT               Logout (expunges messages if no RSET)
TOP msg n          Show first n lines of message number msg
CAPA               Get capabilities
```
# POP (Post Office Protocol)

POP (Post Office Protocol) is a protocol used by email clients to retrieve email messages from a mail server. It is commonly used for downloading emails from a remote server to a local device.

## POP Versions

There are two main versions of POP: POP3 and POP2. POP3 is the most widely used version and is supported by most email clients and servers. POP2 is an older version that is rarely used today.

## POP3 Authentication

POP3 authentication is typically done using a username and password. The username is usually the email address of the user, and the password is used to verify the user's identity.

## POP3 Commands

POP3 uses a set of commands to interact with the mail server. Some of the commonly used commands include:

- USER: Used to specify the username for authentication.
- PASS: Used to specify the password for authentication.
- LIST: Used to list the email messages on the server.
- RETR: Used to retrieve a specific email message.
- DELE: Used to delete a specific email message.
- QUIT: Used to end the POP3 session.

## POP3 Security Issues

POP3 has several security issues that can be exploited by attackers. Some of the common security issues include:

- Cleartext Authentication: POP3 authentication is done in plain text, which means that an attacker can intercept the username and password.
- Lack of Encryption: POP3 does not provide encryption by default, which means that an attacker can intercept the email messages.
- Brute Force Attacks: Attackers can use brute force attacks to guess the username and password combination.
- Email Spoofing: Attackers can spoof email messages and send them to the user's email client.

## POP3 Penetration Testing

During a POP3 penetration test, the following techniques can be used:

- Password Cracking: Brute force or dictionary attacks can be used to crack weak passwords.
- Man-in-the-Middle Attacks: Intercepting the communication between the email client and the mail server to capture sensitive information.
- Email Spoofing: Sending spoofed email messages to the user's email client to gain unauthorized access.
- User Enumeration: Enumerating valid usernames to identify potential targets for further attacks.

## References

- [POP3 - Wikipedia](https://en.wikipedia.org/wiki/Post_Office_Protocol)
```
root@kali:~# telnet $ip 110
+OK beta POP3 server (JAMES POP3 Server 2.3.2) ready
USER billydean
+OK
PASS password
+OK Welcome billydean

list

+OK 2 1807
1 786
2 1021

retr 1

+OK Message follows
From: jamesbrown@motown.com
Dear Billy Dean,

Here is your login for remote desktop ... try not to forget it this time!
username: billydean
password: PA$$W0RD!Z
```
## 위험한 설정

[https://academy.hackthebox.com/module/112/section/1073](https://academy.hackthebox.com/module/112/section/1073)에서 가져온 내용입니다.

| **설정**                   | **설명**                                                                                   |
| ------------------------- | ----------------------------------------------------------------------------------------- |
| `auth_debug`              | 모든 인증 디버그 로깅을 활성화합니다.                                                     |
| `auth_debug_passwords`    | 이 설정은 로그의 상세도, 제출된 비밀번호 및 스키마가 로깅되는 정도를 조정합니다.           |
| `auth_verbose`            | 인증 실패 시도 및 그 이유가 로깅됩니다.                                                  |
| `auth_verbose_passwords`  | 인증에 사용된 비밀번호가 로깅되며, 일부는 생략될 수도 있습니다.                             |
| `auth_anonymous_username` | ANONYMOUS SASL 메커니즘으로 로그인할 때 사용할 사용자 이름을 지정합니다.                   |

## HackTricks 자동 명령어
```
Protocol_Name:  POP   #Protocol Abbreviation if there is one.
Port_Number:  110     #Comma separated if there is more than one.
Protocol_Description: Post Office Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for POP
Note: |
Post Office Protocol (POP) is described as a protocol within the realm of computer networking and the Internet, which is utilized for the extraction and retrieval of email from a remote mail server**, making it accessible on the local device. Positioned within the application layer of the OSI model, this protocol enables users to fetch and receive email. The operation of POP clients typically involves establishing a connection to the mail server, downloading all messages, storing these messages locally on the client system, and subsequently removing them from the server. Although there are three iterations of this protocol, POP3 stands out as the most prevalently employed version.

https://book.hacktricks.xyz/network-services-pentesting/pentesting-pop

Entry_2:
Name: Banner Grab
Description: Banner Grab 110
Command: nc -nv {IP} 110

Entry_3:
Name: Banner Grab 995
Description: Grab Banner Secure
Command: openssl s_client -connect {IP}:995 -crlf -quiet

Entry_4:
Name: Nmap
Description: Scan for POP info
Command: nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -p 110 {IP}

Entry_5:
Name: Hydra Brute Force
Description: Need User
Command: hydra -l {Username} -P {Big_Passwordlist} -f {IP} pop3 -V

Entry_6:
Name: consolesless mfs enumeration
Description: POP3 enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/pop3/pop3_version; set RHOSTS {IP}; set RPORT 110; run; exit'

```
<details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

가장 중요한 취약점을 찾아서 빠르게 수정할 수 있습니다. Intruder는 공격 대상을 추적하고 예방적인 위협 스캔을 실행하여 API부터 웹 애플리케이션 및 클라우드 시스템까지 전체 기술 스택에서 문제를 찾습니다. [**무료로 시도해보세요**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) 오늘.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong>를 통해 AWS 해킹을 처음부터 전문가까지 배워보세요<strong>!</strong></summary>

* **사이버 보안 회사**에서 일하시나요? **회사를 HackTricks에서 광고**하거나 **PEASS의 최신 버전에 액세스**하거나 HackTricks를 **PDF로 다운로드**하고 싶으신가요? [**구독 플랜**](https://github.com/sponsors/carlospolop)을 확인해보세요!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)를 발견하세요, 독점적인 [**NFT**](https://opensea.io/collection/the-peass-family) 컬렉션입니다.
* [**공식 PEASS & HackTricks 스웨그**](https://peass.creator-spring.com)를 얻으세요.
* [**💬**](https://emojipedia.org/speech-balloon/) [**Discord 그룹**](https://discord.gg/hRep4RUj7f) 또는 [**텔레그램 그룹**](https://t.me/peass)에 **참여**하거나 **Twitter**에서 저를 **팔로우**하세요 🐦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **[hacktricks repo](https://github.com/carlospolop/hacktricks)와 [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**에 PR을 제출하여 여러분의 해킹 기법을 공유하세요.

</details>
