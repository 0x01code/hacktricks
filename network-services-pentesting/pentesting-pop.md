## Informa√ß√£o B√°sica

O **Protocolo de Correio** (**POP**) √© um tipo de protocolo padr√£o de Internet e de rede de computadores que extrai e recupera e-mails de um servidor de correio remoto para acesso pela m√°quina hospedeira. O **POP** √© um protocolo de camada de aplica√ß√£o no modelo OSI que fornece aos usu√°rios finais a capacidade de buscar e receber e-mails (a partir [daqui](https://www.techopedia.com/definition/5383/post-office-protocol-pop)).

Os clientes **POP** geralmente se conectam, recuperam todas as mensagens, as armazenam no sistema do cliente e as excluem do servidor. Existem 3 vers√µes do **POP**, mas o **POP3** √© o mais usado.

**Portas padr√£o:** 110, 995(ssl)
```
PORT    STATE SERVICE
110/tcp open  pop3
```
## Enumera√ß√£o

### Banner Grabbing
```bash
nc -nv <IP> 110
openssl s_client -connect <IP>:995 -crlf -quiet
```
## Manual

Voc√™ pode usar o comando `CAPA` para obter as capacidades do servidor POP3.

## Automatizado
```bash
nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -port <PORT> <IP> #All are default scripts
```
O plugin `pop3-ntlm-info` retornar√° alguns dados "**sens√≠veis**" (vers√µes do Windows).

### [Bruteforce POP3](../generic-methodologies-and-resources/brute-force.md#pop)

## Sintaxe POP
```bash
POP commands:
  USER uid           Log in as "uid"
  PASS password      Substitue "password" for your actual password
  STAT               List number of messages, total mailbox size
  LIST               List messages and sizes
  RETR n             Show message n
  DELE n             Mark message n for deletion
  RSET               Undo any changes
  QUIT               Logout (expunges messages if no RSET)
  TOP msg n          Show first n lines of message number msg
  CAPA               Get capabilities
```
De [aqui](http://sunnyoasis.com/services/emailviatelnet.html)

Exemplo:
```
root@kali:~# telnet $ip 110
 +OK beta POP3 server (JAMES POP3 Server 2.3.2) ready 
 USER billydean    
 +OK
 PASS password
 +OK Welcome billydean

 list

 +OK 2 1807
 1 786
 2 1021

 retr 1

 +OK Message follows
 From: jamesbrown@motown.com
 Dear Billy Dean,

 Here is your login for remote desktop ... try not to forget it this time!
 username: billydean
 password: PA$$W0RD!Z
```
## Configura√ß√µes Perigosas

De [https://academy.hackthebox.com/module/112/section/1073](https://academy.hackthebox.com/module/112/section/1073)

| **Configura√ß√£o**           | **Descri√ß√£o**                                                                                   |
| ------------------------- | ----------------------------------------------------------------------------------------------- |
| `auth_debug`              | Habilita todos os logs de depura√ß√£o de autentica√ß√£o.                                            |
| `auth_debug_passwords`    | Esta configura√ß√£o ajusta a verbosidade do log, as senhas enviadas e o esquema s√£o registrados.  |
| `auth_verbose`            | Registra tentativas de autentica√ß√£o malsucedidas e suas raz√µes.                                 |
| `auth_verbose_passwords`  | Senhas usadas para autentica√ß√£o s√£o registradas e tamb√©m podem ser truncadas.                   |
| `auth_anonymous_username` | Isso especifica o nome de usu√°rio a ser usado ao fazer login com o mecanismo SASL AN√îNIMO.       |

## Comandos Autom√°ticos do HackTricks
```
Protocol_Name:  POP   #Protocol Abbreviation if there is one.
Port_Number:  110     #Comma separated if there is more than one.
Protocol_Description: Post Office Protocol         #Protocol Abbreviation Spelled out

Entry_1:
  Name: Notes
  Description: Notes for POP
  Note: |
    Post Office Protocol (POP) is a type of computer networking and Internet standard protocol that extracts and retrieves email from a remote mail server for access by the host machine. POP is an application layer protocol in the OSI model that provides end users the ability to fetch and receive email (from here).
    The POP clients generally connect, retrieve all messages, store them on the client system, and delete them from the server. There are 3 versions of POP, but POP3 is the most used one.

    https://book.hacktricks.xyz/pentesting/pentesting-whois

Entry_2:
  Name: Banner Grab
  Description: Banner Grab 110
  Command: nc -nv {IP} 110

Entry_3:
  Name: Banner Grab 995
  Description: Grab Banner Secure
  Command: openssl s_client -connect {IP}:995 -crlf -quiet

Entry_4:
  Name: Nmap
  Description: Scan for POP info
  Command: nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -p 110 {IP}

Entry_5:
  Name: Hydra Brute Force
  Description: Need User
  Command: hydra -l {Username} -P {Big_Passwordlist} -f {IP} pop3 -V
  
Entry_6:
  Name: consolesless mfs enumeration
  Description: POP3 enumeration without the need to run msfconsole
  Note: sourced from https://github.com/carlospolop/legion
  Command: msfconsole -q -x 'use auxiliary/scanner/pop3/pop3_version; set RHOSTS {IP}; set RPORT 110; run; exit' 
  
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) **grupo do Discord** ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para o [reposit√≥rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
