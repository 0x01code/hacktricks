# 110,995 - Kupima Usalama wa POP

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka mwanzo hadi kuwa bingwa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

* Je, unafanya kazi katika **kampuni ya usalama wa mtandao**? Je, ungependa kuona **kampuni yako ikionekana katika HackTricks**? Au ungependa kupata ufikiaji wa **toleo jipya zaidi la PEASS au kupakua HackTricks kwa muundo wa PDF**? Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* **Jiunge na** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **nifuatilie** kwenye **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwenye [repo ya hacktricks](https://github.com/carlospolop/hacktricks) na [repo ya hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Tafuta udhaifu unaofaa zaidi ili uweze kuzirekebisha haraka. Intruder inafuatilia eneo lako la shambulio, inafanya uchunguzi wa vitisho kwa njia ya kujitolea, inapata matatizo katika mfumo wako mzima wa teknolojia, kutoka kwa APIs hadi programu za wavuti na mifumo ya wingu. [**Jaribu bure**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) leo.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## Taarifa Msingi

**Post Office Protocol (POP)** inaelezwa kama itifaki katika uwanja wa mtandao wa kompyuta na mtandao, ambayo hutumiwa kwa ajili ya kuchukua na **kupata barua pepe kutoka kwenye seva ya barua ya mbali**, na kuiruhusu kuwa inapatikana kwenye kifaa cha ndani. Iliyowekwa katika safu ya maombi ya mfano wa OSI, itifaki hii inawezesha watumiaji kupata na kupokea barua pepe. Uendeshaji wa **wateja wa POP** kwa kawaida unahusisha kuanzisha uhusiano na seva ya barua, kupakua ujumbe wote, kuhifadhi ujumbe huu kwenye mfumo wa mteja, na kisha kuwaondoa kutoka kwenye seva. Ingawa kuna matoleo matatu ya itifaki hii, **POP3** inajulikana zaidi kama toleo linalotumiwa sana.

**Bandari za chaguo-msingi:** 110, 995(ssl)
```
PORT    STATE SERVICE
110/tcp open  pop3
```
### Kuchunguza Bango

Kuchunguza bango ni mchakato wa kupata habari kuhusu huduma ya POP3 (Post Office Protocol 3) kwa kuchunguza bango lake. Bango ni ujumbe wa karibu ambao hutumwa na huduma ya POP3 wakati mteja anapojiunga nayo. Kwa kuchunguza bango, tunaweza kupata habari muhimu kama toleo la huduma, jina la mtumiaji, na maelezo mengine yanayoweza kutusaidia katika hatua zingine za udukuzi.

Kuna njia kadhaa za kuchunguza bango la huduma ya POP3. Moja ya njia hizo ni kutumia amri ya `telnet` kwenye terminal. Hapa kuna hatua za kufuata:

1. Fungua terminal na andika amri ifuatayo: `telnet <anwani ya IP> 110`
2. Ikiwa mstari wa amri unarudi kwa haraka, hii inamaanisha kuwa huduma ya POP3 inapatikana.
3. Tuma amri ya `USER <jina la mtumiaji>` na uangalie jibu. Ikiwa jibu ni `+OK`, hii inamaanisha kuwa jina la mtumiaji ni sahihi.
4. Tuma amri ya `PASS <nywila>` na uangalie jibu. Ikiwa jibu ni `+OK`, hii inamaanisha kuwa nywila ni sahihi.
5. Unaweza pia kutumia amri ya `QUIT` kuondoka kwenye huduma ya POP3.

Kwa kuchunguza bango la huduma ya POP3, tunaweza kupata habari muhimu ambayo inaweza kutusaidia katika hatua zingine za udukuzi.
```bash
nc -nv <IP> 110
openssl s_client -connect <IP>:995 -crlf -quiet
```
## Mwongozo

Unaweza kutumia amri `CAPA` ili kupata uwezo wa seva ya POP3.

## Kiotomatiki
```bash
nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -port <PORT> <IP> #All are default scripts
```
Kifaa cha `pop3-ntlm-info` kitatoa baadhi ya data "**nyeti**" (toleo la Windows).

### [POP3 nguvu ya nguvu](../generic-methodologies-and-resources/brute-force.md#pop)

## Sintaksia ya POP

Mifano ya amri za POP kutoka [hapa](http://sunnyoasis.com/services/emailviatelnet.html)
```bash
POP commands:
USER uid           Log in as "uid"
PASS password      Substitue "password" for your actual password
STAT               List number of messages, total mailbox size
LIST               List messages and sizes
RETR n             Show message n
DELE n             Mark message n for deletion
RSET               Undo any changes
QUIT               Logout (expunges messages if no RSET)
TOP msg n          Show first n lines of message number msg
CAPA               Get capabilities
```
### POP (Post Office Protocol)

POP (Post Office Protocol) ni itifaki ya mtandao inayotumiwa na wateja wa barua pepe kupakua ujumbe kutoka kwa seva ya barua pepe. Kuna matoleo tofauti ya POP, kama vile POP2 na POP3, ambapo POP3 ni maarufu zaidi.

#### POP2

POP2 ni toleo la awali la itifaki ya POP. Inatumia bandari ya 109 kwa mawasiliano na hutumia usimbuaji wa ASCII kwa ujumbe wa barua pepe. Hata hivyo, POP2 haifai sana kwa sababu inatumia usimbuaji dhaifu na haishughulikii vizuri vitambulisho vya barua pepe.

#### POP3

POP3 ni toleo la sasa la itifaki ya POP. Inatumia bandari ya 110 kwa mawasiliano na inasaidia usimbuaji wa SSL / TLS kwa usalama zaidi. POP3 inashughulikia vizuri vitambulisho vya barua pepe na inaruhusu watumiaji kudhibiti ujumbe kwenye seva ya barua pepe, kama vile kufuta, kuhamisha, au kusoma ujumbe.

#### Kuvunja POP

Kuna njia kadhaa za kuvunja itifaki ya POP. Baadhi ya mbinu hizo ni pamoja na:

- Kuvunja nywila za akaunti za barua pepe za POP kwa kutumia mbinu kama vile brute-forcing, dictionary attacks, au phishing.
- Kusikiliza mawasiliano kati ya mteja wa barua pepe na seva ya barua pepe ili kuiba nywila au ujumbe wa barua pepe.
- Kufanya man-in-the-middle (MITM) mashambulizi kwa kudanganya mteja wa barua pepe kuwasiliana na seva ya barua pepe bandia ambapo mshambuliaji anaweza kuchukua udhibiti wa ujumbe.

#### Kuzuia Mashambulizi ya POP

Kuna hatua kadhaa ambazo zinaweza kuchukuliwa ili kuzuia mashambulizi ya POP:

- Tumia usimbuaji wa SSL / TLS kwa mawasiliano ya POP ili kuhakikisha usalama wa ujumbe wa barua pepe.
- Tumia nywila ngumu na za kipekee kwa akaunti za barua pepe za POP ili kuzuia mashambulizi ya kuvunja nywila.
- Weka programu zote zinazohusiana na itifaki ya POP zisasishwe na toleo la karibuni ili kuepuka udhaifu uliojulikana.
- Fanya ukaguzi wa usalama mara kwa mara ili kugundua na kurekebisha mapungufu yoyote katika mfumo wa barua pepe.
```
root@kali:~# telnet $ip 110
+OK beta POP3 server (JAMES POP3 Server 2.3.2) ready
USER billydean
+OK
PASS password
+OK Welcome billydean

list

+OK 2 1807
1 786
2 1021

retr 1

+OK Message follows
From: jamesbrown@motown.com
Dear Billy Dean,

Here is your login for remote desktop ... try not to forget it this time!
username: billydean
password: PA$$W0RD!Z
```
## Mipangilio Hatari

Kutoka [https://academy.hackthebox.com/module/112/section/1073](https://academy.hackthebox.com/module/112/section/1073)

| **Mipangilio**               | **Maelezo**                                                                                   |
| ------------------------- | ----------------------------------------------------------------------------------------- |
| `auth_debug`              | Inawezesha ufuatiliaji wa kumbukumbu zote za uthibitishaji.                                                 |
| `auth_debug_passwords`    | Mipangilio hii inabadilisha kumbukumbu za kuingia, nywila zilizowasilishwa, na mpango wa kuingia.  |
| `auth_verbose`            | Kumbukumbu za majaribio yasiyofanikiwa ya uthibitishaji na sababu zao zinaandikwa.                              |
| `auth_verbose_passwords`  | Nywila zinazotumiwa kwa uthibitishaji zinaandikwa na pia zinaweza kukatwa.                   |
| `auth_anonymous_username` | Hii inabainisha jina la mtumiaji litakalotumiwa wakati wa kuingia kwa kutumia mfumo wa ANONYMOUS SASL. |

## Amri za Kiotomatiki za HackTricks
```
Protocol_Name:  POP   #Protocol Abbreviation if there is one.
Port_Number:  110     #Comma separated if there is more than one.
Protocol_Description: Post Office Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for POP
Note: |
Post Office Protocol (POP) is described as a protocol within the realm of computer networking and the Internet, which is utilized for the extraction and retrieval of email from a remote mail server**, making it accessible on the local device. Positioned within the application layer of the OSI model, this protocol enables users to fetch and receive email. The operation of POP clients typically involves establishing a connection to the mail server, downloading all messages, storing these messages locally on the client system, and subsequently removing them from the server. Although there are three iterations of this protocol, POP3 stands out as the most prevalently employed version.

https://book.hacktricks.xyz/network-services-pentesting/pentesting-pop

Entry_2:
Name: Banner Grab
Description: Banner Grab 110
Command: nc -nv {IP} 110

Entry_3:
Name: Banner Grab 995
Description: Grab Banner Secure
Command: openssl s_client -connect {IP}:995 -crlf -quiet

Entry_4:
Name: Nmap
Description: Scan for POP info
Command: nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -p 110 {IP}

Entry_5:
Name: Hydra Brute Force
Description: Need User
Command: hydra -l {Username} -P {Big_Passwordlist} -f {IP} pop3 -V

Entry_6:
Name: consolesless mfs enumeration
Description: POP3 enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/pop3/pop3_version; set RHOSTS {IP}; set RPORT 110; run; exit'

```
<details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

Tafuta udhaifu unaofaa zaidi ili uweze kuyatatua haraka. Intruder inafuatilia eneo lako la shambulio, inafanya uchunguzi wa vitisho wa kujitolea, inapata matatizo katika mfumo wako mzima wa teknolojia, kutoka kwa APIs hadi programu za wavuti na mifumo ya wingu. [**Jaribu bure**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks) leo.

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

* Je, unafanya kazi katika **kampuni ya usalama wa mtandao**? Je, ungependa kuona **kampuni yako ikionekana katika HackTricks**? au ungependa kupata ufikiaji wa **toleo jipya zaidi la PEASS au kupakua HackTricks kwa PDF**? Angalia [**MPANGO WA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* Pata [**swag rasmi ya PEASS & HackTricks**](https://peass.creator-spring.com)
* **Jiunge na** [**üí¨**](https://emojipedia.org/speech-balloon/) [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **nifuatilie** kwenye **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwenye [repo ya hacktricks](https://github.com/carlospolop/hacktricks) na [repo ya hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
