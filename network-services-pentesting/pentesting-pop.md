# 110,995 - Pentesting POP

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* 你在一个**网络安全公司**工作吗？你想在HackTricks中看到你的**公司广告**吗？或者你想获得**PEASS的最新版本或下载PDF格式的HackTricks**吗？请查看[**订阅计划**](https://github.com/sponsors/carlospolop)！
* 发现我们的独家[**NFTs**](https://opensea.io/collection/the-peass-family)收藏品[**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* 获得[**官方PEASS和HackTricks周边产品**](https://peass.creator-spring.com)
* **加入**[**💬**](https://emojipedia.org/speech-balloon/) [**Discord群组**](https://discord.gg/hRep4RUj7f)或[**电报群组**](https://t.me/peass)，或者**关注**我在**Twitter**上的[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**
* **通过向[hacktricks repo](https://github.com/carlospolop/hacktricks)和[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)提交PR来分享你的黑客技巧**。

</details>

## 基本信息

**邮局协议**（**POP**）是一种计算机网络和互联网标准**协议**，用于从远程邮件服务器提取和检索电子邮件，以供主机机器访问。**POP**是OSI模型中的应用层**协议**，为终端用户提供获取和接收电子邮件的能力（来自[这里](https://www.techopedia.com/definition/5383/post-office-protocol-pop)）。

POP客户端通常连接，检索所有消息，将其存储在客户端系统上，并从服务器上删除。有3个版本的POP，但POP3是最常用的版本。

**默认端口：**110，995（ssl）
```
PORT    STATE SERVICE
110/tcp open  pop3
```
### 横幅抓取

横幅抓取是一种用于获取目标主机上运行的POP3服务器版本和其他相关信息的技术。通过发送特定的请求到POP3服务器，我们可以从服务器的响应中提取有用的信息，如软件版本、操作系统类型和其他配置细节。这些信息对于后续的攻击和漏洞利用非常有用。

#### 使用Telnet进行横幅抓取

使用Telnet工具可以方便地进行横幅抓取。以下是使用Telnet进行横幅抓取的步骤：

1. 打开命令行终端并输入以下命令：

   ```
   telnet <目标IP地址> <POP3端口号>
   ```

   例如：

   ```
   telnet 192.168.0.1 110
   ```

2. 连接成功后，输入以下命令以获取横幅信息：

   ```
   USER <任意用户名>
   ```

   例如：

   ```
   USER test
   ```

3. 服务器将返回横幅信息，其中包括服务器版本和其他相关细节。

#### 使用Nmap进行横幅抓取

Nmap是一款功能强大的网络扫描工具，也可以用于横幅抓取。以下是使用Nmap进行横幅抓取的步骤：

1. 打开命令行终端并输入以下命令：

   ```
   nmap -p <POP3端口号> --script pop3-capabilities <目标IP地址>
   ```

   例如：

   ```
   nmap -p 110 --script pop3-capabilities 192.168.0.1
   ```

2. Nmap将发送特定的POP3请求到目标主机，并从服务器的响应中提取横幅信息。

#### 使用Metasploit进行横幅抓取

Metasploit是一款流行的渗透测试工具，也可以用于横幅抓取。以下是使用Metasploit进行横幅抓取的步骤：

1. 打开Metasploit控制台并输入以下命令：

   ```
   use auxiliary/scanner/pop3/pop3_version
   ```

2. 设置目标主机的IP地址和POP3端口号：

   ```
   set RHOSTS <目标IP地址>
   set RPORT <POP3端口号>
   ```

   例如：

   ```
   set RHOSTS 192.168.0.1
   set RPORT 110
   ```

3. 运行模块以获取横幅信息：

   ```
   run
   ```

   Metasploit将发送特定的POP3请求到目标主机，并从服务器的响应中提取横幅信息。
```bash
nc -nv <IP> 110
openssl s_client -connect <IP>:995 -crlf -quiet
```
## 手动

您可以使用命令`CAPA`来获取POP3服务器的功能。

## 自动化
```bash
nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -port <PORT> <IP> #All are default scripts
```
`pop3-ntlm-info`插件将返回一些“**敏感**”数据（Windows版本）。

### [POP3暴力破解](../generic-methodologies-and-resources/brute-force.md#pop)

## POP语法
```bash
POP commands:
USER uid           Log in as "uid"
PASS password      Substitue "password" for your actual password
STAT               List number of messages, total mailbox size
LIST               List messages and sizes
RETR n             Show message n
DELE n             Mark message n for deletion
RSET               Undo any changes
QUIT               Logout (expunges messages if no RSET)
TOP msg n          Show first n lines of message number msg
CAPA               Get capabilities
```
从[这里](http://sunnyoasis.com/services/emailviatelnet.html)

示例：
```
root@kali:~# telnet $ip 110
+OK beta POP3 server (JAMES POP3 Server 2.3.2) ready
USER billydean
+OK
PASS password
+OK Welcome billydean

list

+OK 2 1807
1 786
2 1021

retr 1

+OK Message follows
From: jamesbrown@motown.com
Dear Billy Dean,

Here is your login for remote desktop ... try not to forget it this time!
username: billydean
password: PA$$W0RD!Z
```
## 危险设置

来自[https://academy.hackthebox.com/module/112/section/1073](https://academy.hackthebox.com/module/112/section/1073)

| **设置**                   | **描述**                                                                                   |
| ------------------------- | ----------------------------------------------------------------------------------------- |
| `auth_debug`              | 启用所有身份验证调试日志记录。                                                             |
| `auth_debug_passwords`    | 此设置调整日志详细程度，记录提交的密码和方案。                                             |
| `auth_verbose`            | 记录未成功的身份验证尝试及其原因。                                                         |
| `auth_verbose_passwords`  | 记录用于身份验证的密码，也可以进行截断。                                                   |
| `auth_anonymous_username` | 指定在使用ANONYMOUS SASL机制登录时要使用的用户名。                                          |

## HackTricks自动命令
```
Protocol_Name:  POP   #Protocol Abbreviation if there is one.
Port_Number:  110     #Comma separated if there is more than one.
Protocol_Description: Post Office Protocol         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for POP
Note: |
Post Office Protocol (POP) is a type of computer networking and Internet standard protocol that extracts and retrieves email from a remote mail server for access by the host machine. POP is an application layer protocol in the OSI model that provides end users the ability to fetch and receive email (from here).
The POP clients generally connect, retrieve all messages, store them on the client system, and delete them from the server. There are 3 versions of POP, but POP3 is the most used one.

https://book.hacktricks.xyz/pentesting/pentesting-whois

Entry_2:
Name: Banner Grab
Description: Banner Grab 110
Command: nc -nv {IP} 110

Entry_3:
Name: Banner Grab 995
Description: Grab Banner Secure
Command: openssl s_client -connect {IP}:995 -crlf -quiet

Entry_4:
Name: Nmap
Description: Scan for POP info
Command: nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -p 110 {IP}

Entry_5:
Name: Hydra Brute Force
Description: Need User
Command: hydra -l {Username} -P {Big_Passwordlist} -f {IP} pop3 -V

Entry_6:
Name: consolesless mfs enumeration
Description: POP3 enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/pop3/pop3_version; set RHOSTS {IP}; set RPORT 110; run; exit'

```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks 云 ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 推特 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

* 你在一家 **网络安全公司** 工作吗？想要在 HackTricks 中 **宣传你的公司** 吗？或者你想要获取 **PEASS 的最新版本或下载 HackTricks 的 PDF** 吗？请查看 [**订阅计划**](https://github.com/sponsors/carlospolop)！
* 发现我们的独家 [**NFTs**](https://opensea.io/collection/the-peass-family) 集合 [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* 获取 [**官方 PEASS & HackTricks 商品**](https://peass.creator-spring.com)
* **加入** [**💬**](https://emojipedia.org/speech-balloon/) [**Discord 群组**](https://discord.gg/hRep4RUj7f) 或 [**Telegram 群组**](https://t.me/peass)，或者在 **Twitter** 上 **关注** 我 [**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**
* **通过向 [hacktricks 仓库](https://github.com/carlospolop/hacktricks) 和 [hacktricks-cloud 仓库](https://github.com/carlospolop/hacktricks-cloud) 提交 PR 来分享你的黑客技巧**。

</details>
