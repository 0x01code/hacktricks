# 8009 - Apache JServ Protocol (AJP) рдХрд╛ рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof рдореЗрдВ рд╕рднреА рдХреНрд░рд┐рдкреНрдЯреЛ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рд╣реЛрддреА рд╣реИред**

**рджреЗрд░реА рдХреЗ рдмрд┐рдирд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
HackenProof рдмрд╛рдЙрдВрдЯреА рддрдм рд╢реБрд░реВ рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдЙрдирдХреЗ рдЧреНрд░рд╛рд╣рдХ рдЗрдирд╛рдо рдмрдЬрдЯ рдЬрдорд╛ рдХрд░рддреЗ рд╣реИрдВред рдмрдЧ рд╕рддреНрдпрд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЖрдкрдХреЛ рдЗрдирд╛рдо рдорд┐рд▓реЗрдЧрд╛ред

**рд╡реЗрдм3 рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ рдЕрдиреБрднрд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
рдмреНрд▓реЙрдХрдЪреЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдФрд░ рд╕реНрдорд╛рд░реНрдЯ рдХреЙрдиреНрдЯреНрд░реИрдХреНрдЯреНрд╕ рдирдИ рдЗрдВрдЯрд░рдиреЗрдЯ рд╣реИрдВ! рдЙрдирдХреЗ рдЙрднрд░рддреЗ рджрд┐рдиреЛрдВ рдореЗрдВ рд╡реЗрдм3 рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдорд╛рд╕реНрдЯрд░ рдХрд░реЗрдВред

**рд╡реЗрдм3 рд╣реИрдХрд░ рд▓реАрдЬреЗрдВрдб рдмрдиреЗрдВ**\
рдкреНрд░рддреНрдпреЗрдХ рд╕рддреНрдпрд╛рдкрд┐рдд рдмрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╖реНрдард╛ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рд╕рд╛рдкреНрддрд╛рд╣рд┐рдХ рд▓реАрдбрд░рдмреЛрд░реНрдб рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╡рд┐рдЬрдпреА рдмрдиреЗрдВред

[**HackenProof рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**](https://hackenproof.com/register) рдФрд░ рдЕрдкрдиреЗ рд╣реИрдХреНрд╕ рд╕реЗ рдХрдорд╛рдИ рдХрд░реЗрдВ!

{% embed url="https://hackenproof.com/register" %}

## рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА

рд╕реНрд░реЛрдд: [https://diablohorn.com/2011/10/19/8009-the-forgotten-tomcat-port/](https://diablohorn.com/2011/10/19/8009-the-forgotten-tomcat-port/)

> AJP рдПрдХ рддрд╛рд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред рдпрд╣ рдПрдХ HTTP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЕрдиреБрдХреВрд▓рд┐рдд рд╕рдВрд╕реНрдХрд░рдг рд╣реИ рдЬреЛ рдПрдХ рд╕реНрд╡рддрдВрддреНрд░ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдЬреИрд╕реЗ [Apache](http://httpd.apache.org/) рдХреЛ Tomcat рд╕реЗ рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рд░реВрдк рд╕реЗ, Apache рд╕реНрдЯреЗрдЯрд┐рдХ рд╕рд╛рдордЧреНрд░реА рдХреЛ рд╕реЗрд╡рд╛ рдХрд░рдиреЗ рдореЗрдВ Tomcat рд╕реЗ рдмрд╣реБрдд рддреЗрдЬ рд░рд╣рд╛ рд╣реИред рд╡рд┐рдЪрд╛рд░ рдпрд╣ рд╣реИ рдХрд┐ Apache рдХреЛ рд╕рдВрднрд╡ рд╣реЛрдиреЗ рдкрд░ рд╕реНрдЯреЗрдЯрд┐рдХ рд╕рд╛рдордЧреНрд░реА рдХреА рд╕реЗрд╡рд╛ рдХрд░рдиреЗ рджреЗрдВ, рд▓реЗрдХрд┐рди Tomcat рд╕рдВрдмрдВрдзрд┐рдд рд╕рд╛рдордЧреНрд░реА рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХреЛ Tomcat рдХреЗ рдкреНрд░рддрд┐ рдкреНрд░реЙрдХреНрд╕реА рдХрд░реЗрдВред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ рд░реЛрдЪрдХ рд╣реИ:

> ajp13 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдкреИрдХреЗрдЯ-рдЖрдзрд╛рд░рд┐рдд рд╣реИред рдкреНрд░рджрд░реНрд╢рди рдХреЗ рдХрд╛рд░рдг, рдПрдХ рдмрд╛рдЗрдирд░реА рдкреНрд░рд╛рд░реВрдк рдХреЛ рд╕реБрдкреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рдЬреЛ рдкрдардиреАрдп рд╕рд╛рджрд╛ рдкрд╛рда рдХреЗ рдмрдЬрд╛рдп рдЪреБрдирд╛ рдЧрдпрд╛ред рд╡реЗрдм рд╕рд░реНрд╡рд░ TCP рдХрдиреЗрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд░реНрд╡рд▓реЗрдЯ рдХрдВрдЯреЗрдирд░ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рддрд╛ рд╣реИред рд╕реЙрдХреЗрдЯ рдирд┐рд░реНрдорд╛рдг рдХреА рдорд╣рдВрдЧреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╡реЗрдм рд╕рд░реНрд╡рд░ рд╕рд░реНрд╡рд▓реЗрдЯ рдХрдВрдЯреЗрдирд░ рдХреЗ рд╕рд╛рде рд╕реНрдерд╛рдпреА TCP рдХрдиреЗрдХреНрд╢рди рдмрдирд╛рдП рд░рдЦрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛, рдФрд░ рдПрдХ рдХрдиреЗрдХреНрд╢рди рдХреЛ рдПрдХрд╛рдзрд┐рдХ рдЕрдиреБрд░реЛрдз / рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЪрдХреНрд░ рдХреЗ рд▓рд┐рдП рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдЧрд╛ред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 8009
```
PORT     STATE SERVICE
8009/tcp open  ajp13
```
## CVE-2020-1938 ['Ghostcat'](https://www.chaitin.cn/en/ghostcat)

рдпрджрд┐ AJP рдкреЛрд░реНрдЯ рдЙрдЬрд╛рдЧрд░ рд╣реИ, рддреЛ рдЯреЙрдордХреИрдЯ рдШреЛрд╕реНрдЯрдХреИрдЯ рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрддрддрд╛ рдХреЗ рдкреНрд░рддрд┐ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣рд╛рдВ рдПрдХ [рд╢реЛрдз](https://www.exploit-db.com/exploits/48143) рд╣реИ рдЬреЛ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред

рдШреЛрд╕реНрдЯрдХреИрдЯ рдПрдХ LFI рд╕рдВрдХрдЯрдЧреНрд░рд╕реНрддрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреБрдЫ рд╣рдж рддрдХ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реИ: рдХреЗрд╡рд▓ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдкрде рд╕реЗ рдлрд╝рд╛рдЗрд▓реЗрдВ рдЦреАрдВрдЪреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред рдлрд┐рд░ рднреА, рдЗрд╕рдореЗрдВ `WEB-INF/web.xml` рдЬреИрд╕реА рдлрд╝рд╛рдЗрд▓реЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреА рд╣реИрдВ рдЬреЛ рд╕рд░реНрд╡рд░ рд╕реЗрдЯрдЕрдк рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдЯреЙрдордХреИрдЯ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рд▓рд┐рдП рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдЬреИрд╕реА рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рд▓реАрдХ рд╣реЛ рд╕рдХрддреА рд╣реИред

рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 9.0.31, 8.5.51 рдФрд░ 7.0.100 рдпрд╛ рдЙрдЪреНрдЪрддрд░ рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рдкреИрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

## рдЬрд╛рдБрдЪ

### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд
```bash
nmap -sV --script ajp-auth,ajp-headers,ajp-methods,ajp-request -n -p 8009 <IP>
```
### [**рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕**](../generic-methodologies-and-resources/brute-force.md#ajp)

## AJP рдкреНрд░реЙрдХреНрд╕реА

### рдЕрдкрд╛рдЪреЗ AJP рдкреНрд░реЙрдХреНрд╕реА

рдпрд╣ рдЕрджреНрднреБрдд рдмрд╛рдд рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЖрдк рдкреЛрд░реНрдЯ 8009 рдЦреЛрд▓рддреЗ рд╣реИрдВ рдФрд░ рдХреЛрдИ рдЕрдиреНрдп рд╡реЗрдм рдкреЛрд░реНрдЯ рдирд╣реАрдВ рдЦреЛрд▓рддреЗ рд╣реИрдВред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рдЕрдЪреНрдЫрд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдЖрдк рдореЗрдЯрд╛рд╕реНрдкреНрд▓реЛрдЗрдЯ рдЬреИрд╕реЗ рдореМрдЬреВрджрд╛ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред рдПрдХ рдЙрджреНрдзрд░рдг рдореЗрдВ рдХрд╣рд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдЖрдк (рдЕрд╡рд╢реНрдп) рдЕрдкрд╛рдЪреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдЯреЙрдордХреИрдЯ рдкреЛрд░реНрдЯ 8009 рдкрд░ рдкреНрд░реЙрдХреНрд╕реА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╕рдВрджрд░реНрднреЛрдВ рдореЗрдВ рдЖрдкрдХреЛ рдЗрд╕реЗ рдХреИрд╕реЗ рдХрд░рдирд╛ рд╣реИ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рдЕрдЪреНрдЫрд╛ рдорд╛рд░реНрдЧрджрд░реНрд╢рд┐рдХрд╛ рдорд┐рд▓реЗрдЧреА (рдкрд╣рд▓реЗ рдЗрд╕реЗ рдкрдврд╝реЗрдВ), рдЬреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрд░реА рдЦреБрдж рдХреА рдорд╢реАрди рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдХрдорд╛рдВрдбреЛрдВ рдХреА рдПрдХ рд╕рдВрдХреНрд╖реЗрдк рдорд╛рддреНрд░рд╛ рд╣реИред рдореИрдВрдиреЗ рдХреБрдЫ рдореВрд▓ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд▓рдЧреЗред
```bash
sudo apt-get install libapache2-mod-jk
sudo vim /etc/apache2/apache2.conf # append the following line to the config
Include ajp.conf
sudo vim /etc/apache2/ajp.conf     # create the following file, change HOST to the target address
ProxyRequests Off
<Proxy *>
Order deny,allow
Deny from all
Allow from localhost
</Proxy>
ProxyPass       / ajp://HOST:8009/
ProxyPassReverse    / ajp://HOST:8009/
sudo a2enmod proxy_http
sudo a2enmod proxy_ajp
sudo systemctl restart apache2
```
рдЗрд╕ рд╕реЗрдЯрдЕрдк рдХрд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рдлрд╛рдпрджрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдк IDS/IPS рд╕рд┐рд╕реНрдЯрдо рдХреЛ рд░реЛрдХ рд╕рдХрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ AJP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреБрдЫ рд╣рдж рддрдХ рдмрд╛рдЗрдирд░реА рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдореИрдВрдиреЗ рдЗрд╕реЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реИред рдЕрдм рдЖрдк рдЕрдкрдиреЗ рдирд┐рдпрдорд┐рдд рдореЗрдЯрд╛рд╕реНрдкреНрд▓реЛрдЗрдЯ рдЯреЙрдордХреИрдЯ рдЕрднрд┐рдХреНрд░рд┐рдпрд╛ рдХреЛ 127.0.0.1:80 рдкрд░ рдкреЙрдЗрдВрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдЕрдзрд┐рдХрд╛рд░ рдореЗрдВ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣рд╛рдВ рдореЗрдЯрд╛рд╕реНрдкреНрд▓реЛрдЗрдЯ рдХреА рдЖрдЙрдЯрдкреБрдЯ рднреА рд╣реИ:
```bash
msf  exploit(tomcat_mgr_deploy) > show options

Module options (exploit/multi/http/tomcat_mgr_deploy):

Name      Current Setting  Required  Description
----      ---------------  --------  -----------
PASSWORD  tomcat           no        The password for the specified username
PATH      /manager         yes       The URI path of the manager app (/deploy and /undeploy will be used)
Proxies                    no        Use a proxy chain
RHOST     localhost        yes       The target address
RPORT     80               yes       The target port
USERNAME  tomcat           no        The username to authenticate as
VHOST                      no        HTTP server virtual host
```
### Nginx рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА рдФрд░ AJP

[AJP рдХреЗ рдбреЙрдХрд░рд╛рдЗрдЬрд╝реНрдб рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ](#рдбреЙрдХрд░рд╛рдЗрдЬрд╝реНрдб-рд╕рдВрд╕реНрдХрд░рдг)

рдЬрдм рд╣рдореЗрдВ рдПрдХ рдЦреБрд▓рд╛ AJP рдкреНрд░реЙрдХреНрд╕реА рдкреЛрд░реНрдЯ (8009 TCP) рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рд╣рдо Nginx рдХрд╛ рдЙрдкрдпреЛрдЧ `ajp_module` рдХреЗ рд╕рд╛рде рдХрд░рдХреЗ "рдЫрд┐рдкрд╛ рд╣реБрдЖ" Tomcat рдкреНрд░рдмрдВрдзрдХ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

* Nginx рд╕реНрд░реЛрдд рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ
* рдЖрд╡рд╢реНрдпрдХ рдореЙрдбреНрдпреВрд▓ рдХреЛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ
* `ajp_module` рдХреЗ рд╕рд╛рде Nginx рд╕реНрд░реЛрдд рдХреЛ рдХрдВрдкрд╛рдЗрд▓ рдХрд░реЗрдВред
* AJP рдкреЛрд░реНрдЯ рдХреЛ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реА рдПрдХ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ
```bash
# Download Nginx code
wget https://nginx.org/download/nginx-1.21.3.tar.gz
tar -xzvf nginx-1.21.3.tar.gz

# Compile Nginx source code with the ajp module
git clone https://github.com/dvershinin/nginx_ajp_module.git
cd nginx-1.21.3
sudo apt install libpcre3-dev
./configure --add-module=`pwd`/../nginx_ajp_module --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --modules-path=/usr/lib/nginx/modules
make
sudo make install
nginx -V
```
рдПрдХреНрд╕рдЯрд░реНрдирд▓ рдЖрдИрдкреА рдПрдбреНрд░реЗрд╕ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд▓рд╛рдЗрдиреЛрдВ рдХреЛ `http` рдмреНрд▓реЙрдХ рдХреЗ рдЕрдВрджрд░ `/etc/nginx/conf/nginx.conf` рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред рдПрдХреНрд╕рдЯрд░реНрдирд▓ рдЖрдИрдкреА рдПрдбреНрд░реЗрд╕ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд▓рд╛рдЗрдиреЛрдВ рдХреЛ `http` рдмреНрд▓реЙрдХ рдХреЗ рдЕрдВрджрд░ `/etc/nginx/conf/nginx.conf` рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред
```shell-session
upstream tomcats {
server <TARGET_SERVER>:8009;
keepalive 10;
}
server {
listen 80;
location / {
ajp_keep_conn on;
ajp_pass tomcats;
}
}
```
рдПрдирдЬрд┐рдирдХреНрд╕ рдХреЛ рд╢реБрд░реВ рдХрд░реЗрдВ рдФрд░ рд╕рдм рдХреБрдЫ рд╕рд╣реА рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рд╕реНрдерд╛рдиреАрдп рд╣реЛрд╕реНрдЯ рдкрд░ рдПрдХ cURL рдЕрдиреБрд░реЛрдз рдЬрд╛рд░реА рдХрд░рдХреЗ рдЬрд╛рдВрдЪреЗрдВред
```html
sudo nginx
curl http://127.0.0.1:80

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Apache Tomcat/X.X.XX</title>
<link href="favicon.ico" rel="icon" type="image/x-icon" />
<link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
<link href="tomcat.css" rel="stylesheet" type="text/css" />
</headas
<body>
<div id="wrapper">
<div id="navigation" class="curved container">
<span id="nav-home"><a href="https://tomcat.apache.org/">Home</a></span>
<span id="nav-hosts"><a href="/docs/">Documentation</a></span>
<span id="nav-config"><a href="/docs/config/">Configuration</a></span>
<span id="nav-examples"><a href="/examples/">Examples</a></span>
<span id="nav-wiki"><a href="https://wiki.apache.org/tomcat/FrontPage">Wiki</a></span>
<span id="nav-lists"><a href="https://tomcat.apache.org/lists.html">Mailing Lists</a></span>
<span id="nav-help"><a href="https://tomcat.apache.org/findhelp.html">Find Help</a></span>
<br class="separator" />
</div>
<div id="asf-box">
<h1>Apache Tomcat/X.X.XX</h1>
</div>
<div id="upper" class="curved container">
<div id="congrats" class="curved container">
<h2>If you're seeing this, you've successfully installed Tomcat. Congratulations!</h2>
<SNIP>
```
### рдбреЙрдХрд░рд╛рдЗрдЬрд╝реНрдб-рд╕рдВрд╕реНрдХрд░рдг

рдпрджрд┐ рдЖрдк рдбреЙрдХрд░рд╛рдЗрдЬрд╝реНрдб рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдПрдХ рдбреЙрдХрд░ рдЗрдореЗрдЬ рдмрдирд╛рдиреА рд╣реЛрдЧреА рдЬрд┐рд╕рдореЗрдВ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЖрд╡рд╢реНрдпрдХ рд╕рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рд╣реЛрдВрдЧреАред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ:

1. рдПрдХ рдирдпрд╛ рдбреЙрдХрд░ рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ рдФрд░ рдЙрд╕реЗ `Dockerfile` рдирд╛рдо рджреЗрдВред
2. рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдХреЛ `Dockerfile` рдореЗрдВ рдЬреЛрдбрд╝реЗрдВ:

```docker
FROM tomcat:latest
COPY your_app.war /usr/local/tomcat/webapps/
CMD ["catalina.sh", "run"]
```

3. `your_app.war` рдХреЛ рдЕрдкрдиреЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд╛рдо рд╕реЗ рдмрджрд▓реЗрдВред
4. рдбреЙрдХрд░ рдЗрдореЗрдЬ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

```bash
docker build -t your_image_name .
```

5. рдбреЙрдХрд░ рдЗрдореЗрдЬ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:

```bash
docker run -p 8080:8080 your_image_name
```

6. рдЕрдм рдЖрдкрдХрд╛ рдбреЙрдХрд░рд╛рдЗрдЬрд╝реНрдб рдЕрдиреБрдкреНрд░рдпреЛрдЧ `localhost:8080` рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реЛрдЧрд╛ред

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдирд┐рд░реНрджреЗрд╢ рдЯреЙрдордХреИрдЯ рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рд╣реИ, рд▓реЗрдХрд┐рди рдЖрдк рдЕрдкрдиреЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рд╡реЗрдм рд╕рд░реНрд╡рд░ рднреА рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВред
```bash
git clone https://github.com/ScribblerCoder/nginx-ajp-docker
cd nginx-ajp-docker
```
рдЕрдкрдиреЗ `nginx.conf` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ `TARGET-IP` рдХреЛ AJP IP рдХреЗ рд╕рд╛рде рдмрджрд▓реЗрдВ рдФрд░ рдлрд┐рд░ рдЙрд╕реЗ рдмрд┐рд▓реНрдб рдФрд░ рдЪрд▓рд╛рдПрдВред
``` bash
docker build . -t nginx-ajp-proxy
docker run -it --rm -p 80:80 nginx-ajp-proxy
```
## рд╕рдВрджрд░реНрдн

* [https://academy.hackthebox.com/module/145/section/1295](https://academy.hackthebox.com/module/145/section/1295)

<figure><img src="../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

**HackenProof рдХреНрд░рд┐рдкреНрдЯреЛ рдмрдЧ рдмрд╛рдЙрдВрдЯреА рдХреЗ рд▓рд┐рдП рдШрд░ рд╣реИред**

**рджреЗрд░реА рдХреЗ рдмрд┐рдирд╛ рдкреБрд░рд╕реНрдХрд╛рд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
HackenProof рдмрд╛рдЙрдВрдЯреА рдХреЗрд╡рд▓ рддрдм рд╢реБрд░реВ рд╣реЛрддреА рд╣реИрдВ рдЬрдм рдЙрдирдХреЗ рдЧреНрд░рд╛рд╣рдХ рдкреБрд░рд╕реНрдХрд╛рд░ рдмрдЬрдЯ рдЬрдорд╛ рдХрд░рддреЗ рд╣реИрдВред рдЖрдкрдХреЛ рдмрдЧ рд╕рддреНрдпрд╛рдкрд┐рдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдкреБрд░рд╕реНрдХрд╛рд░ рдорд┐рд▓реЗрдЧрд╛ред

**рд╡реЗрдм3 рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдореЗрдВ рдЕрдиреБрднрд╡ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**\
рдмреНрд▓реЙрдХрдЪреЗрди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдФрд░ рд╕реНрдорд╛рд░реНрдЯ рдХреЙрдиреНрдЯреНрд░реИрдХреНрдЯреНрд╕ рдирдИ рдЗрдВрдЯрд░рдиреЗрдЯ рд╣реИрдВ! рдЙрдирдХреЗ рдЙрднрд░рддреЗ рджрд┐рдиреЛрдВ рдореЗрдВ рд╡реЗрдм3 рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдорд╛рд╕реНрдЯрд░ рдХрд░реЗрдВред

**рд╡реЗрдм3 рд╣реИрдХрд░ рд▓реАрдЬреЗрдВрдб рдмрдиреЗрдВ**\
рдкреНрд░рддреНрдпреЗрдХ рд╕рддреНрдпрд╛рдкрд┐рдд рдмрдЧ рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рд╖реНрдард╛ рдЕрдВрдХ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдФрд░ рд╕рд╛рдкреНрддрд╛рд╣рд┐рдХ рд▓реАрдбрд░рдмреЛрд░реНрдб рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рд╡рд┐рдЬрдпреА рдмрдиреЗрдВред

[**HackenProof рдкрд░ рд╕рд╛рдЗрди рдЕрдк рдХрд░реЗрдВ**](https://hackenproof.com/register) рдФрд░ рдЕрдкрдиреЗ рд╣реИрдХреНрд╕ рд╕реЗ рдХрдорд╛рдИ рдХрд░реЗрдВ!

{% embed url="https://hackenproof.com/register" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рд╢рд╛рдорд┐рд▓** рд╣реЛрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ рд╣рдореЗрдВ PR рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗред**

</details>
