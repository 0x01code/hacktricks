<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks クラウド ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ企業**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**最新バージョンのPEASSを入手したり、HackTricksをPDFでダウンロード**したいですか？[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！

- 独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションである[**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見してください。

- [**公式のPEASS＆HackTricksグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- **[💬](https://emojipedia.org/speech-balloon/) Discordグループ**に参加するか、[**Telegramグループ**](https://t.me/peass)に参加するか、**Twitter**で**フォロー**する[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)にPRを提出してください。**

</details>


# スキャナー

MFP（マルチファンクションプリンタ/周辺機器）のスキャン機能へのアクセスは標準化されておらず、PJLコマンドを使用しているベンダーはほんの一部のようです。公開されたドキュメントは存在せず、[SANEプロジェクト](http://www.sane-project.org/sane-backends.html#SCANNERS)はさまざまなスキャナデバイスのプロトコルを逆分析しました。Brother MFPでは、独自のPostScriptオペレータである\_brpdfscanが使用される可能性があります。

**この攻撃をテストする方法**

特定のモデルのプリンタドライバをインストールし、スキャン機能を（悪用して）使用します。

**この攻撃を実行できるのは誰ですか**

- スキャン機能が[プリンタ制御](http://hacking-printers.net/wiki/index.php/Fundamentals#Printer_Control_Languages)または[ページ記述](http://hacking-printers.net/wiki/index.php/Fundamentals#Page_Description_Languages)言語を介してアクセスできる場合、印刷できる人なら誰でも
- MFPのWebインターフェースにアクセスできる人なら誰でも、Webインターフェースを使用してドキュメントをスキャンできる場合
- スキャンに別のTCPポートが使用されている場合、特定のネットワークサービスにアクセスできる攻撃者のみ

# テレファックス

ファックスメッセージは音声周波数トーンの形式で送信されます。これらは電話システムを介して利用可能なテレファックス対応デバイスに送信することができます。そのため、これらは通常の企業の保護メカニズム（TCP/IPファイアウォールや侵入検知システムなど）をバイパスし、内部ネットワークのプリンタやMFPに悪意のあるコマンドを実行するために使用される可能性があります。90年代中盤にAdobeは「PostScriptファックス」という言語の補完として導入しました[[1]](http://hacking-printers.net/wiki/index.php/Fax_and_Scanner#cite_note-1)。これにより、互換性のあるデバイスは通常の電話システムを使用してPostScriptファイルを直接ファックスで受信できるようになりました。これにより、攻撃者は通常の電話システムを使用してプリンタに悪意のあるPostScriptコードを展開することができます。残念ながら、PostScriptファックスは普及せず、ごく一部のデバイスにのみ実装されました。代わりに、テレファックスメッセージは通常、[TIFF](https://en.wikipedia.org/wiki/TIFF#TIFF_Compression_Tag)などのグラフィカルイメージとして送信されます。ただし、他のベンダーが生のファックスイメージの代わりに任意のPDLデータストリームを**受信**するための独自のファックス拡張を実装している可能性は排除できません。理論的には、「ファックスウイルス」を作成し、MFPのアドレス帳の番号に基づいて他のデバイスに感染させるか、従来のワードダイヤリングによって拡散させることができます。

さらに、**送信**ファックスは、現在のMFPでは独自のPJLコマンドで制御することができます。これを利用して、0900番号（攻撃者自身が登録した可能性があります）に電話をかけることで機関に財務的損失を引き起こすことができます。または、機密情報を漏洩させるためのバックチャネルとして使用することもできます。PDLデータストリームを介してファックスを送信するためのベンダー固有の例は以下に示します。

### HP

[1]によると、HPデバイスではPMLを使用してファックスにアクセスできます。

### Xerox

[2]によると、Xeroxは独自のPJLコマンドを使用しています：`@PJL COMMENT OID_ATT_FAX_DESTINATION_PHONE "..."`

### Brother

[3]によると、Brotherは独自のFCL（Fax Control Language）を使用しています：`<Esc>DIALNUM[ (...) ]`

### Lexmark

[4]によると、Lexmarkは独自のPJLコマンドを使用しています：`@PJL LFAX PHONENUMBER="..."`

### Kyocera

[5]によると、Kyoceraは独自のPJLコマンドを使用しています：`@PJL SET FAXTEL = ...`

### Ricoh

[6]によると、Ricohは独自のPJLコマンドを使用しています：`@PJL ENTER LANGUAGE=RFAX`

\
**この攻撃をテストする方法**

特定のモデルのプリンタドライバをインストールし、ファックス機能を（悪用して）使用します。


<details>
- **[💬](https://emojipedia.org/speech-balloon/)Discordグループ**に参加するか、[**テレグラムグループ**](https://t.me/peass)に参加するか、**Twitter**で私をフォローする[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**

- **あなたのハッキングトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)にPRを提出してください**。

</details>
