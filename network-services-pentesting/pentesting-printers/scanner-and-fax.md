# Scanner

O acesso à funcionalidade de digitalização em MFPs (periféricos/multifuncionais) não é padronizado e parece que apenas alguns fornecedores aplicam comandos PJL para essa tarefa. A documentação pública está faltando, o [projeto SANE](http://www.sane-project.org/sane-backends.html#SCANNERS) conseguiu engenharia reversa dos protocolos para vários dispositivos de digitalização. Em MFPs Brother, o operador PostScript proprietário \_brpdfscan pode ser possivelmente usado.

**Como testar esse ataque?**

Instale os drivers da impressora para o modelo específico e (ab)use a função de digitalização.

**Quem pode realizar esse ataque?**

* Qualquer pessoa que possa imprimir, se a funcionalidade de digitalização puder ser acessada por meio de uma linguagem de controle de impressora ou descrição de página
* Qualquer pessoa que possa acessar a interface da web, em MFPs onde os documentos podem ser digitalizados usando a interface da web
* Somente atacantes que podem acessar determinados serviços de rede, se uma porta TCP separada for usada para digitalização

# Telefax

As mensagens de fax são transmitidas na forma de tons de frequência de áudio. Eles podem ser enviados para qualquer dispositivo telefax disponível no sistema telefônico. Portanto, eles poderiam ser usados ​​potencialmente para contornar mecanismos típicos de proteção da empresa, como firewalls TCP/IP ou sistemas de detecção de intrusão e executar comandos maliciosos em impressoras ou MFPs em redes internas. No meio dos anos 90, a Adobe introduziu o 'fax PostScript' como um suplemento de linguagem [\[1\]](http://hacking-printers.net/wiki/index.php/Fax_and_Scanner#cite_note-1), permitindo que dispositivos compatíveis recebessem arquivos PostScript diretamente via fax. Isso permite que um invasor use o sistema telefônico comum como um canal para implantar código PostScript malicioso em uma impressora. Infelizmente, o fax PostScript nunca se estabeleceu e foi implementado apenas em alguns dispositivos. As mensagens de telefax, em vez disso, são tipicamente transmitidas como imagens gráficas como [TIFF](https://en.wikipedia.org/wiki/TIFF#TIFF_Compression_Tag). No entanto, não se pode descartar que outros fornecedores implementem extensões de fax proprietárias para receber fluxos de dados PDL arbitrários em vez de imagens de fax brutas. Teoricamente, um 'vírus de fax' poderia ser criado que se espalharia infectando outros dispositivos com base em números do livro de endereços do MFP ou por wardialing tradicional.

Além disso, o fax **de saída** pode ser controlado por comandos PJL proprietários em MFPs atuais. Isso pode ser usado para causar perda financeira a uma instituição chamando um número 0900 (que pode ser registrado pelo próprio atacante) ou como um canal de retorno para vazar informações confidenciais. Exemplos específicos do fornecedor para enviar fax via fluxos de dados PDL são dados abaixo.

### HP

De acordo com [\[1\]](http://hplipopensource.com), o fax pode ser acessado usando PML em dispositivos HP.

### Xerox

De acordo com [\[2\]](http://www.office.xerox.com/support/dctips/dc02cc0280.pdf), a Xerox usa comandos PJL proprietários: `@PJL COMMENT OID_ATT_FAX_DESTINATION_PHONE "..."`

### Brother

De acordo com [\[3\]](http://brother-mfc.sourceforge.net/faxlanguage.txt), a Brother usa a linguagem de controle de fax proprietária FCL (Fax Control Language): `<Esc>DIALNUM[ (...) ]`

### Lexmark

De acordo com [\[4\]](https://www.lexmark.com/publications/pdfs/techref_WB.pdf), a Lexmark usa comandos PJL proprietários: `@PJL LFAX PHONENUMBER="..."`

### Kyocera

De acordo com [\[5\]](http://material.karlov.mff.cuni.cz/people/hajek/bizhub/femperonpsc200mu.pl), a Kyocera usa comandos PJL proprietários: `@PJL SET FAXTEL = ...`

### Ricoh

De acordo com [\[6\]](http://www.objectiflune.com/forum2/ubbthreads.php?ubb=showflat\&Number=29462\&page=1), a Ricoh usa comandos PJL proprietários: `@PJL ENTER LANGUAGE=RFAX`

\
**Como testar esse ataque?**

Instale os drivers da impressora para o modelo específico e (ab)use a função de fax.
