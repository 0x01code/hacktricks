Los peligros de las actualizaciones de firmware maliciosas son bien conocidos y han sido discutidos tempranamente por [\[1\]](http://hacking-printers.net/wiki/index.php/Firmware_updates#cite_note-1) y [\[2\]](http://hacking-printers.net/wiki/index.php/Firmware_updates#cite_note-2). A diferencia de otros dispositivos en red, sin embargo, **es com√∫n que las impresoras implementen actualizaciones de firmware como trabajos de impresi√≥n ordinarios**. Esto abre una amplia puerta de entrada para los atacantes porque el acceso a la funcionalidad de impresi√≥n suele ser un obst√°culo bajo. Solo se puede especular sobre la motivaci√≥n de tales decisiones de dise√±o inseguras, pero parece l√≥gico que las razones hist√≥ricas jueguen un papel: las impresoras sol√≠an estar conectadas por cable paralelo o USB. Sin conectividad de red, la seguridad era menos importante y sin un servidor web protegido por contrase√±a o una funcionalidad similar, el canal de impresi√≥n era la √∫nica forma de enviar datos al dispositivo.

Se han demostrado ataques de modificaci√≥n de firmware contra impresoras de red por [\[3\]](http://hacking-printers.net/wiki/index.php/Firmware_updates#cite_note-cui2011print-3) para dispositivos HP, por [\[4\]](http://hacking-printers.net/wiki/index.php/Firmware_updates#cite_note-j
| bin, squashfs | 79 | imagen squashfs |  |
| bin, kmmfp | 41 | u-boot legacy uImage |  |
| efi, kmpanel | 13 | formato de imagen propietario |  |
| Konica Minolta | bin | 38 | archivo binario desconocido, archivo adicional de suma de comprobaci√≥n |
| ps | 20 | PostScript \(t√≠tulo: M√≥dulos de carga suave de la impresora\) |  |
| ftp, prn | 11 | @PJL ENTER LANGUAGE=FIRMUPDATE |  |
| upg | 1 | @PJL ENTER LANGUAGE=UPGRADE |  |

**¬øC√≥mo probar este ataque?**

La seguridad de la firma de c√≥digo se basa en mantener la clave privada como un secreto comercial a largo plazo. Sin embargo, todav√≠a hay impresoras en el mercado que son potencialmente vulnerables a firmware malicioso, ya sea porque a√∫n no se han actualizado o porque los algoritmos de suma de comprobaci√≥n propietarios se venden como esquemas de firma digital criptogr√°ficamente seguros. Ciertamente, hay que se√±alar que analizar el firmware puede ser dif√≠cil si los proveedores no documentan sus formatos de firmware y rutinas de actualizaci√≥n. Por lo general, esto requiere ingenier√≠a inversa. Por lo tanto, probar la viabilidad de los ataques de modificaci√≥n de firmware no es trivial. En una prueba simple, se puede **cambiar un solo bit** y comprobar si el firmware modificado sigue siendo aceptado por el dispositivo de impresora. Si no es as√≠, la impresora verifica una suma de comprobaci√≥n o una firma digital. Encontrar la diferencia no siempre es f√°cil y escribir firmware malicioso \(con una suma de comprobaci√≥n correcta\) puede ser un proyecto que consume mucho tiempo.

Otros escenarios de ataque incluyen:

* Incluso si el firmware est√° firmado, se puede volver a una cierta versi√≥n de firmware \(firmada\) que tiene debilidades de seguridad conocidas.
* Incluso si el firmware est√° firmado, a veces se puede montar para obtener m√°s informaci√≥n \(especialmente el firmware de Konica Minolta es f√°cilmente montable\).
* El hecho de que el firmware est√© firmado no significa que sea seguro. Usando binwalk/grep, etc., se pueden encontrar componentes con vulnerabilidades conocidas como [CVE-2015-7547](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2015-7547). 

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de exclusivos [**NFTs**](https://opensea.io/collection/the-peass-family)

- Consigue el [**swag oficial de PEASS & HackTricks**](https://peass.creator-spring.com)

- **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PR al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
