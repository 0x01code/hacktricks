Os perigos das atualiza√ß√µes de firmware maliciosas s√£o bem conhecidos e foram discutidos anteriormente por [\[1\]](http://hacking-printers.net/wiki/index.php/Firmware_updates#cite_note-1) e [\[2\]](http://hacking-printers.net/wiki/index.php/Firmware_updates#cite_note-2). Em contraste com outros dispositivos em rede, **√© comum que as impressoras implantem atualiza√ß√µes de firmware como trabalhos de impress√£o comuns**. Isso abre uma ampla porta de entrada para os atacantes, porque o acesso √† funcionalidade de impress√£o geralmente √© um obst√°culo baixo. Pode-se apenas especular sobre a motiva√ß√£o para essas decis√µes de design inseguras, mas parece l√≥gico que raz√µes hist√≥ricas desempenhem um papel: as impressoras costumavam ser conectadas por cabo paralelo ou USB. Sem conectividade de rede, a seguran√ßa era menos importante e sem um servidor web protegido por senha ou funcionalidade semelhante, o canal de impress√£o era a √∫nica maneira de enviar dados para o dispositivo.

Ataques de modifica√ß√£o de firmware contra impressoras de rede foram demonstrados por [\[3\]](http://hacking-printers.net/wiki/index.php/Firmware_updates#cite_note-cui2011print-3) para dispositivos HP, por [\[4\]](http://hacking-printers.net/wiki/index.php/Firmware_updates
| bin, squashfs | 79 | imagem squashfs |  |
| bin, kmmfp | 41 | u-boot legacy uImage |  |
| efi, kmpanel | 13 | formato de imagem propriet√°rio |  |
| Konica Minolta | bin | 38 | bin√°rio desconhecido, arquivo de checksum adicional |
| ps | 20 | PostScript \(t√≠tulo: Softload printer modules\) |  |
| ftp, prn | 11 | @PJL ENTER LANGUAGE=FIRMUPDATE |  |
| upg | 1 | @PJL ENTER LANGUAGE=UPGRADE |  |

**Como testar esse ataque?**

A seguran√ßa da assinatura de c√≥digo √© baseada em manter a chave privada como um segredo comercial de longo prazo. No entanto, ainda existem impressoras que podem ser potencialmente vulner√°veis a firmware malicioso - seja porque ainda n√£o foram atualizadas ou porque algoritmos de checksum propriet√°rios s√£o vendidos como esquemas de assinatura digital criptograficamente seguros. Certamente, deve-se destacar que analisar o firmware pode ser dif√≠cil se os fornecedores n√£o documentarem seus formatos de firmware e rotinas de atualiza√ß√£o. Geralmente, isso requer engenharia reversa. Testar a viabilidade de ataques de modifica√ß√£o de firmware, portanto, n√£o √© trivial. Em um teste simples, pode-se **alterar um √∫nico bit** e verificar se o firmware modificado ainda √© aceito pelo dispositivo da impressora. Se n√£o, um checksum ou uma assinatura digital √© verificada pela impressora. Encontrar a diferen√ßa nem sempre √© f√°cil e escrever firmware malicioso \(com um checksum correto\) pode ser um projeto demorado.

Outros cen√°rios de ataque incluem:

* Mesmo que o firmware esteja assinado, pode-se ser capaz de fazer downgrade para uma determinada vers√£o de firmware \(assinada\) que tenha vulnerabilidades de seguran√ßa conhecidas.
* Mesmo que o firmware esteja assinado, √†s vezes pode ser montado para obter mais informa√ß√µes \(especialmente o firmware da Konica Minolta √© facilmente mont√°vel\).
* S√≥ porque o firmware est√° assinado n√£o significa que √© seguro. Usando binwalk/grep etc., pode-se encontrar componentes com vulnerabilidades conhecidas como [CVE-2015-7547](https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2015-7547). 

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

- Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe suas t√©cnicas de hacking enviando PRs para o [reposit√≥rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
