<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>


# **рдкрд░рд┐рдЪрдп**

**рдЕрдиреБрдорддрд┐ рдХреЗ рдмрд┐рдирд╛ рдкреНрд░рд┐рдВрдЯ рдХрд░рдирд╛** рд╕реНрд╡рдпрдВ рдореЗрдВ рдПрдХ рд╕реБрд░рдХреНрд╖рд╛ рдЬреЛрдЦрд┐рдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдХрдВрдкрдиреА рдиреАрддрд┐ рдХрд╛ рдЙрд▓реНрд▓рдВрдШрди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред рдЬрд╣рд╛рдВ рдкреНрд░рд┐рдВрдЯ рдЬреЙрдм рдХреЗ рд▓рд┐рдП рд╢реБрд▓реНрдХ рд▓рд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдПрдХ рдЕрдВрджрд░ рд╕реЗ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рдЦрд╛рддрд╛ рдкреНрд░рдгрд╛рд▓реА рдХреЛ рджреМрдбрд╝рд╛рдиреЗ рдХрд╛ рдкреНрд░реЗрд░рдгрд╛ рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, 'рдкреНрд░рд┐рдВрдЯ' рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░рд┐рдВрдЯрд░ рдХреЗ рдЦрд┐рд▓рд╛рдл рдЕрдзрд┐рдХрд╛рдВрд╢ рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреВрд░реНрд╡-рд╢рд░реНрдд рд╣реИред

рдкреНрд░рд┐рдВрдЯ рдЬреЙрдм рд▓реЗрдЦрд╛ рдХрд░рдиреЗ рдХреЗ рджреЛ рдореБрдЦреНрдп рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реИрдВ: рдпрд╛ рддреЛ **рдкреНрд░рд┐рдВрдЯрд░ рдХреЛ рд╕реАрдзреЗ рдЗрд╕реЗ рд╕рдВрднрд╛рд▓рдиреЗ рджреЗрдВ рдпрд╛ рдмреАрдЪ рдореЗрдВ рдкреНрд░рд┐рдВрдЯ рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ**ред рдкрд╣рд▓рд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╡рд┐рдХреНрд░реЗрддрд╛-рд╡рд┐рд╢реЗрд╖ рд╣реЛрддрд╛ рд╣реИ, рдЖрдорддреМрд░ рдкрд░ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ 'рдкреНрд░рд┐рдВрдЯрд░ рдбреНрд░рд╛рдЗрд╡рд░' рдХреЗ рд░реВрдк рдореЗрдВ рдХреБрдЫ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╡рд┐рд╢реЗрд╖ рд╢рд╛рдорд┐рд▓ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдпрд╣рд╛рдВ рдЕрдзрд┐рдХ рдЪрд░реНрдЪрд╛ рдирд╣реАрдВ рдХреА рдЬрд╛рддреА рд╣реИред рджреВрд╕рд░рд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдПрдХ рдЕрд▓рдЧ рдкреНрд░рд┐рдВрдЯ рд╕рд░реНрд╡рд░ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд░рддрд╛ рд╣реИ - рдЖрдорддреМрд░ рдкрд░ [CUPS](https://en.wikipedia.org/wiki/CUPS) рдпрд╛ [LPRng](https://en.wikipedia.org/wiki/LPRng) рдЬреИрд╕реЗ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди - рд▓реЗрдЦрд╛ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдХрдВрдкрдирд┐рдпреЛрдВ рдФрд░ рд╕рдВрд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рдХрд╛рдлреА рд╕рд╛рдорд╛рдиреНрдп рд╣реИред рдкреНрд░рд┐рдВрдЯ рд╕рд░реНрд╡рд░ LPD, IPP рдпрд╛ рдЕрдиреНрдп рдкреНрд░рд┐рдВрдЯрд┐рдВрдЧ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдмреЛрд▓ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдирд┐рдпрдд рдкреНрд░рд┐рдВрдЯрд░ рдХреЛ рдЬреЙрдм рднреЗрдЬрддрд╛ рд╣реИред **рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдкреНрд░рд┐рдВрдЯрд░ рдХреЗ рд▓рд┐рдП рд╕реАрдзрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдкрд╣реБрдВрдЪ рд╕реАрдорд┐рдд рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП**, рдЕрдиреНрдпрдерд╛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЖрд╕рд╛рдиреА рд╕реЗ рдкреНрд░рд┐рдВрдЯ рд╕рд░реНрд╡рд░ рдФрд░ рдЗрд╕рдХреЗ рд▓реЗрдЦрд╛ рддрдВрддреНрд░реЛрдВ рдХреЛ **рджреМрдбрд╝рд╛ рд╕рдХрддрд╛ рд╣реИ**ред рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдкреНрд░рд╛рдорд╛рдгрд┐рдХ рдФрд░ рдЕрдкреНрд░рд╛рдорд╛рдгрд┐рдХ рдкреЛрд░реНрдЯ (LPD, IPP, raw, HTTP, SMB, FTP, SNMP) рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЕрд╡рд░реЛрдзрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред

рдкреНрд░рд┐рдВрдЯ рдЬреЙрдм рд▓реЗрдЦрд╛ рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдХреЛ рджреМрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореВрд▓ рд░реВрдк рд╕реЗ рджреЛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реИрдВ: рдпрд╛ рддреЛ **рджреВрд╕рд░реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░реЗрдВ рдпрд╛ рдореБрджреНрд░рд┐рдд рдкреГрд╖реНрдареЛрдВ рдХреА рдЧрд┐рдирддреА рдореЗрдВ рдмрджрд▓рд╛рд╡ рдХрд░реЗрдВ**ред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЗрдВ LPRng (v3.8.B) рдФрд░ CUPS (v2.1.4) рд╕реНрдерд╛рдкрдирд╛рдУрдВ рдХреЗ рд▓рд┐рдП рджреЛрдиреЛрдВ рд╡рд┐рдХрд▓реНрдкреЛрдВ рдкрд░ рдЪрд░реНрдЪрд╛ рдХреА рдЬрд╛рддреА рд╣реИ рдЬреЛ рд╢рд┐рдХреНрд╖рдг рдФрд░ рдХреЙрд░реНрдкреЛрд░реЗрдЯ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдЙрдкрдпреЛрдЧ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд▓реЛрдХрдкреНрд░рд┐рдп рдУрдкрди-рд╕реЛрд░реНрд╕ рдкреНрд░рд┐рдВрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рд╣реИрдВред рджреЛрдиреЛрдВ рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреА рддреБрд▓рдирд╛ рдиреАрдЪреЗ рджреА рдЧрдИ рд╣реИред

| рдкреНрд░рд┐рдВрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо | рдкреНрд░реЛрдЯреЛрдХреЙрд▓ | рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди | рдкреНрд░рдорд╛рдгреАрдХрд░рдг | рдкреГрд╖реНрда рдЧрдгрдирд╛ |
| --------------- | -------- | ---------- | -------------- | ------------ |
| **LPRng**       | LPD      | SSL/TLS    | Kerberos, PGP  | рд╣рд╛рд░реНрдбрд╡реЗрдпрд░    |
| **CUPS**        | IPP      | SSL/TLS    | Kerberos, HTTP | рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░    |

# рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдмрд╛рдИрдкрд╛рд╕

LPRng рдФрд░ CUPS рджреЛрдиреЛрдВ рд╣реА SSL рдЖрдзрд╛рд░рд┐рдд рдЪреИрдирд▓ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдФрд░ [Kerberos](https://en.wikipedia.org/wiki/Kerberos\_\(protocol\)), [PGP](https://en.wikipedia.org/wiki/Pretty\_Good\_Privacy) рд╕рд╛рдЗрди рдХреА рдЧрдИ рдкреНрд░рд┐рдВрдЯ рдЬреЙрдмреНрд╕ рдпрд╛ HTTP [рдореВрд▓](https://en.wikipedia.org/wiki/Basic\_access\_authentication)/[digest](https://en.wikipedia.org/wiki/Digest\_access\_authentication) рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЬреИрд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдпреЛрдЬрдирд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред рдпрджрд┐ **рдареАрдХ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ** рдФрд░ рдпрджрд┐ рд╣рдорд▓рд╛рд╡рд░ рдкреНрд░рд┐рдВрдЯрд░ рдХрд╛ рд╕реАрдзрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рддреЛ рд╡рд╣ **рджреВрд╕рд░реЗ
```
lp -U nobody test.ps
```
# рдкреЗрдЬ рдХрд╛рдЙрдВрдЯрд░ рдореЗрдВ рдЫреЗрджрди

## рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдкреЗрдЬ рдХрд╛рдЙрдВрдЯрд░

рд╕рд╣реА рд▓реЗрдЦрд╛рдВрдХрди рдХреЗ рд▓рд┐рдП **рдореБрджреНрд░рдг рдкреНрд░рдгрд╛рд▓реА рджреНрд╡рд╛рд░рд╛ рдореБрджреНрд░рд┐рдд рдкреЗрдЬреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд** рдХреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП, рдЬреЛ рдХрд┐ рдПрдХ рдЖрд╕рд╛рди рдХрд╛рд░реНрдп рдирд╣реАрдВ рд╣реИред **LPRng** рдХреЗ рд▓реЗрдЦрдХ _рдпрд╣ рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рд┐рдВрдЯрд░ рдореЗрдВ рдХреЛрдИ рдРрд╕рд╛ рдЕрд╕реНрдерд╛рдпреА рдкреЗрдЬ рдХрд╛рдЙрдВрдЯрд░ рдореЗрдХреЗрдирд┐рдЬреНрдо рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдмрд┐рдЬрд▓реА рдЪрд╛рд▓реВ/рдмрдВрдж рдХрд░рдиреЗ рдХреЗ рдЪрдХреНрд░реЛрдВ рдХреЗ рдкреНрд░рддрд┐ рд╕реБрд░рдХреНрд╖рд┐рдд рдФрд░ рдкреНрд░рднрд╛рд╡реА рд╣реЛрддрд╛ рд╣реИред_ рдРрд╕реЗ **рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдкреЗрдЬ рдХрд╛рдЙрдВрдЯрд░** рдХреЛ рдЕрдзрд┐рдХрд╛рдВрд╢ рдкреНрд░рд┐рдВрдЯрд░реНрд╕ рд╕рдорд░реНрдерд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдФрд░ LPRng рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд┐рдВрдЯ рдЬреЙрдм рдХреЗ рдмрд╛рдж PJL рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдкрдврд╝рд╛** рдЬрд╛рддрд╛ рд╣реИред **HP** рдиреЗ рдпрд╣ рднреА рджрд╕реНрддрд╛рд╡реЗрдЬреАрдХреГрдд рдХрд┐рдпрд╛ рд╣реИ рдХрд┐ рдкреНрд░рд┐рдВрдЯрд░ рдХреЛ рд╕реЗрд╡рд╛ рдореЛрдб рдореЗрдВ рд╕реЗрдЯ рдХрд░рдХреЗ **рдкреЗрдЬ рдХрд╛рдЙрдВрдЯрд░** рдЪрд░ рдХреЛ **рд▓рд┐рдЦрд╛** рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рддрд░реАрдХреЗ рд╕реЗ, _HP LaserJet 1200, HP LaserJet 4200N_ рдФрд░ _HP LaserJet 4250N_ рдХреЗ **рдкреЗрдЬ рдХрд╛рдЙрдВрдЯрд░** рдХреЛ рдкреНрд░рд┐рдВрдЯ рдЬреЙрдм рдХреЗ рджреМрд░рд╛рди **рдЫреЗрджрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ**ред рдореБрджреНрд░рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рдЕрдВрдд рдореЗрдВ рдФрд░ [UEL](./#uel) рджреНрд╡рд╛рд░рд╛ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХрд╛рдЙрдВрдЯрд░ рдХреЛ рдмрд╕ рдЕрдкрдиреЗ рдореВрд▓реНрдп (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, `2342`) рдкрд░ рд░реАрд╕реЗрдЯ рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП:
```
\x1b%-12345X@PJL JOB
This page was printed for free
\x1b%-12345X@PJL EOJ
\x1b%-12345X@PJL JOB
@PJL SET SERVICEMODE=HPBOISEID
@PJL SET PAGES=2342
\x1b%-12345X@PJL EOJ
```
рдПрдХ рд╣рдорд▓рд╛рд╡рд░реНрдзреА рдПрдХ рдирдХрд╛рд░рд╛рддреНрдордХ рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдореБрджреНрд░рд┐рдд рдкреГрд╖реНрдареЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреБрдЫ рдЯреЗрд╕реНрдЯ рдХрд┐рдП рдЧрдП рдЙрдкрдХрд░рдгреЛрдВ рдкрд░ рдпрд╣ рдирд╡реАрдиреАрдХрд░рдг рдЙрдкрдХрд░рдг рдХреЛ [рдлреИрдХреНрдЯреНрд░реА рдбрд┐рдлрд╝реЙрд▓реНрдЯ](factory-defaults.md) рдкрд░ рд░реАрд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдкреГрд╖реНрда рдЧрд┐рдирддреА рдХреЛ рд╢реВрдиреНрдп рдкрд░ рд░реАрд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред\
рдкреГрд╖реНрда рдЧрд┐рдирддреА рдХреЛ рдХрдо рдХрд░рдирд╛ рдПрдХ рдкреНрд░рд┐рдВрдЯрд░ рдХреА рдХреАрдордд рд╕реЗ рдКрдкрд░ рдмреЗрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ рдПрдХ рджреВрд╕рд░реЗ рд╣рд╛рде рд╕реЗ рдЦрд░реАрджреЗ рдЧрдП рдХрд╛рд░ рдХреЛ рдЦрд░реАрджрддреЗ рд╕рдордп рдУрдбреЛрдореАрдЯрд░ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рдкреГрд╖реНрда рдЧрд┐рдирддреА рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рдирд╛ рдЖрдкрддреНрддрд┐рдЬрдирдХ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ: рдпрд╣ рдПрдХ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдХрдо рдХреАрдордд рд╡рд╛рд▓реЗ рдЗрдВрдХрдЬреЗрдЯ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдорд╣рдВрдЧреЗ рдЗрдВрдХ рдмреЗрдЪрдиреЗ рдФрд░ рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рд░рд┐рдлрд┐рд▓ рдХрд┐рдЯ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡реНрдпрд╛рдкрд╛рд░ рдореЙрдбрд▓ рд╣реИ - рдРрд╕реЗ рдЕрдиреИрддрд┐рдХ рдЕрднреНрдпрд╛рд╕реЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдкреГрд╖реНрда рдЧрд┐рдирддреА рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рдирд╛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╡реИрдз рд╣реИред

рдкреБрд░рд╛рдиреЗ рдПрдЪрдкреА рд▓реЗрдЬрд░рдЬреЗрдЯреНрд╕ рдкрд░ [PRET](https://github.com/RUB-NDS/PRET) рдХреЗ `pagecount` рдХрдорд╛рдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдкреГрд╖реНрдардЧрдгрдХреЛрдВ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```
./pret.py -q printer pjl
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> pagecount 10
Old pagecounter: 53214
New pagecounter: 10
```
## рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдкреЗрдЬ рдХрд╛рдЙрдВрдЯрд░реНрд╕

**CUPS** рд╕рднреА рдкреНрд░рдореБрдЦ рдкреЗрдЬ рд╡рд┐рд╡рд░рдг рднрд╛рд╖рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ рдХрд┐рдП рдЧрдП **рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдкреЗрдЬ рдХрд╛рдЙрдВрдЯрд░реНрд╕** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдкреЛрд╕реНрдЯрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд▓рд┐рдП, рдПрдХ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдЦрд╛рддрд╛ рджреБрд░реНрдШрдЯрдирд╛ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ PageCount рд╕рд┐рд╕реНрдЯрдо рдкреИрд░рд╛рдореАрдЯрд░ рдореМрдЬреВрдж рд╣реИ - рдЬреЛ CUPS/Ghostscript рдореЗрдВ рдЕрдиреБрдкреНрд░реЗрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рддреЛ рдпрд╣ рдЧрд▓рдд рд░реВрдк рд╕реЗ рд▓реМрдЯреЗрдЧрд╛ - рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЛ рдореБрджреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПред рдиреАрдЪреЗ рджрд┐рдЦрд╛рдП рдЧрдП рддрд░реАрдХреЗ рдХреЗ рдЕрдиреБрд╕рд╛рд░ред
```
currentsystemparams (PageCount) known {
<@\textit{[...] code which is only executed on a printer device [...]}@>
} if
```
рдЗрд╕ рддрд░рд╣, CUPS рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рд▓реЗрдЦрд╛рдВрдХрди рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдиреЗ рдкреНрд░рд┐рдВрдЯрд░ рд╕реЗ рдЕрд▓рдЧ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдмрдирд╛рдпрд╛ рд╣реИред **CUPS рдХреЗрд╡рд▓ рдПрдХ рдкреГрд╖реНрда рдХреЗ рд▓рд┐рдП рд▓реЗрдЦрд╛рдВрдХрди рдХрд░рддрд╛ рд╣реИ** - рдЬреЛ рдПрдХ **рд╣рд╛рд░реНрдбрдХреЛрдб рдорд┐рдирд┐рдордо** рдХреА рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ - рдЬрдмрдХрд┐ **рд╡рд╛рд╕реНрддрд╡рд┐рдХ** рдкреНрд░рд┐рдВрдЯ рдЬреЙрдм рдореЗрдВ **рд╕реИрдВрдбреНрд░реЗрдбреЛрдВ** **рдХреЗ рд╕реИрдВрдбреНрд░реЗрдбреЛрдВ** рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ IPP 'рдХрдЪреНрдЪрд╛' рдХрддрд╛рд░ / рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЕрдирд┐рд╡рд╛рд░реНрдп рд╣реИ, рдЕрдиреНрдпрдерд╛ CUPS рдкреГрд╖реНрда рдЧрд┐рдирддреА рддрдХ рдкреЛрд╕реНрдЯрд╕реНрдХреНрд░рд┐рдкреНрдЯ-рдЯреВ-рдкреЛрд╕реНрдЯрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдлрд╝рд┐рд▓реНрдЯрд░ (рдШреЛрд╕реНрдЯрд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХрд╛ ps2write) рдХреЗ рд╕рд╛рде рдХреЛрдб рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддрд╛ рд╣реИред

**рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрд╕реЗ?**

**рдКрдкрд░ рдХреЗ рдХреЛрдб рдореЗрдВ** рдПрдХ рдЕрдирд┐рд╢реНрдЪрд┐рдд **рдорд▓реНрдЯреА-рдкреЗрдЬ рдкреЛрд╕реНрдЯрд╕реНрдХреНрд░рд┐рдкреНрдЯ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝** рдХреЛ **рд▓рдкреЗрдЯреЗрдВ** рдФрд░ рдкреНрд░рд┐рдВрдЯ рдХрд░реЗрдВред рдлрд┐рд░ [`http://printserver:631/jobs?which_jobs=all`](http://printserver:631/jobs?which_jobs=all) рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдЗрд╕ рдкреНрд░рд┐рдВрдЯ рдЬреЙрдм рдХреЗ рд▓рд┐рдП CUPS рдХреА рдкреГрд╖реНрда рдЧрд┐рдирддреА рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдХ рдХрдЪреНрдЪрд╛ рдХрддрд╛рд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред рдпрд╛рдиреА, рдПрдХ рдХрддрд╛рд░ рдЬрд╣рд╛рдВ рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдкреНрд░рд┐рдВрдЯ рдЬреЙрдм рд╕реАрдзреЗ рдкреНрд░рд┐рдВрдЯрд░ рдХреЛ рдЬрд╛рддрд╛ рд╣реИред CUPS рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ `application/vnd.cups-raw` рдХреЛ рд╕реЗрдЯ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдЖрдкрдХрд╛ рд╕рд┐рд╕реНрдЯрдо рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдкреНрд░рд┐рдВрдЯ рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ:
```
lp -o raw test.ps
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>
