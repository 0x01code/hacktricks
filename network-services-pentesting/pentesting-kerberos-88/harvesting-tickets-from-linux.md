<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>！</strong></summary>

HackTricksをサポートする他の方法:

* **HackTricksに広告を掲載したい場合**や**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください。
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に**参加する**か、[**テレグラムグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローする**。
* [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングのコツを共有する。

</details>


Linuxでは、**チケットはクレデンシャルキャッシュまたはccachesに保存されます**。主に3つのタイプがあり、**チケットが見つかる場所を示しています:**

* **ファイル**は、デフォルトでは**/tmp**ディレクトリの下にあり、**krb5cc\_%{uid}**の形式です。
* **カーネルキーリング**は、キーを保存するためにLinuxカーネルに提供される特別なスペースです。
* **プロセスメモリ**は、チケットを使用する必要があるプロセスが1つだけの場合に使用されます。

特定のマシンでどのタイプのストレージが使用されているかを確認するには、**/etc/krb5.conf**ファイル内の変数 _**default\_ccache\_name**_ をチェックする必要があります。これはデフォルトで任意のユーザーが読み取り権限を持っています。このパラメータが欠落している場合、そのデフォルト値は _FILE:/tmp/krb5cc\_%{uid}_ です。

**他の2つのソースからチケットを抽出する**ために（keyringsとプロセス）、2017年に公開された素晴らしい論文、[**Kerberos Credential Thievery (GNU/Linux)**](https://www.delaat.net/rp/2016-2017/p97/report.pdf)では、それらからチケットを回復する方法について説明しています。

### Keyring - 論文から

> **Linuxカーネル**には**keyrings**と呼ばれる機能があります。これはカーネル内に存在するメモリの領域で、キーの**管理と保持**に使用されます。
>
> **keyctlシステムコール**はカーネルバージョン2.6.10で導入されました。これにより、**ユーザースペースアプリケーションはカーネルキーリングと対話するためのAPI**を使用できます。

> 使用中の**keyringの名前**は、デフォルトで誰でも読み取り権限が有効になっている（8進数644）**Kerberos設定ファイル/etc/krb5.conf**から解析できます。攻撃者はこの情報を利用して、チケットを含むkeyringsを**検索し、チケットを抽出**できます。この機能を実装した証明コンセプトスクリプトは、セクションA.2 **(hercules.sh)**で見ることができます。keyringでは、ccacheはコンポーネントとして保存されます。図2に示すように、ファイルccacheはヘッダー、デフォルトプリンシパル、および一連のクレデンシャルの3つの異なるコンポーネントで構成されています。**keyringはデフォルトプリンシパルとクレデンシャルを保持**します。このスクリプトはこれらのコンポーネントを別々のファイルにダンプします。次に、**攻撃者が合成したヘッダー**を使用して、これらのピースを正しい順序で組み合わせて**ファイルccacheを再構築**します。この再構築されたファイルは、攻撃者のマシンに持ち出され、Kerberosユーザーになりすますために使用できます。有効なccacheヘッダーを生成するためのシンプルなプログラムは、セクションA.3で見ることができます。

論文の**heracles.shスクリプト**に基づいて、あなたが使用できるCツール（完全な投稿の著者によって作成された）は[**tickey**](https://github.com/TarlogicSecurity/tickey)であり、**keyringsからチケットを抽出します**：
```
/tmp/tickey -i
```
**この情報は以下から取得しました：** [**https://www.tarlogic.com/en/blog/how-to-attack-kerberos/**](https://www.tarlogic.com/en/blog/how-to-attack-kerberos/)


<details>

<summary><strong>AWSハッキングをゼロからヒーローまで学ぶには</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>をご覧ください！</strong></summary>

HackTricksをサポートする他の方法：

* **HackTricksにあなたの会社を広告したい場合**や**HackTricksをPDFでダウンロードしたい場合**は、[**サブスクリプションプラン**](https://github.com/sponsors/carlospolop)をチェックしてください！
* [**公式PEASS & HackTricksグッズ**](https://peass.creator-spring.com)を入手する
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を発見し、独占的な[**NFTs**](https://opensea.io/collection/the-peass-family)のコレクションをチェックする
* 💬 [**Discordグループ**](https://discord.gg/hRep4RUj7f)に**参加する**か、[**テレグラムグループ**](https://t.me/peass)に参加するか、**Twitter** 🐦 [**@carlospolopm**](https://twitter.com/carlospolopm)を**フォローする**。
* [**HackTricks**](https://github.com/carlospolop/hacktricks)と[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)のgithubリポジトリにPRを提出して、あなたのハッキングのコツを**共有する**。

</details>
