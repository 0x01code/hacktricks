```markdown
<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


Sur Linux, **les tickets sont stock√©s dans des caches d'identifiants ou ccaches**. Il existe 3 types principaux, qui indiquent o√π **les tickets peuvent √™tre trouv√©s :**

* **Fichiers**, par d√©faut sous le r√©pertoire **/tmp**, sous la forme **krb5cc\_%{uid}.**
* **Porte-cl√©s du noyau**, un espace sp√©cial dans le noyau Linux pr√©vu pour stocker les cl√©s.
* **M√©moire du processus**, utilis√©e lorsqu'un seul processus a besoin d'utiliser les tickets.

Pour v√©rifier quel type de stockage est utilis√© sur une machine sp√©cifique, la variable _**default\_ccache\_name**_ doit √™tre v√©rifi√©e dans le fichier **/etc/krb5.conf**, qui par d√©faut a la permission de lecture pour tout utilisateur. Si ce param√®tre est manquant, sa valeur par d√©faut est _FILE:/tmp/krb5cc\_%{uid}_.

Pour extraire **les tickets des 2 autres sources** (porte-cl√©s et processus), un excellent article, [**Kerberos Credential Thievery (GNU/Linux)**](https://www.delaat.net/rp/2016-2017/p97/report.pdf), publi√© en 2017, explique les m√©thodes de r√©cup√©ration des tickets √† partir de ceux-ci.

### Porte-cl√©s - D'apr√®s l'article

> Le **noyau Linux** dispose d'une fonctionnalit√© appel√©e **porte-cl√©s**. Il s'agit d'une **zone de m√©moire r√©sidant** dans le noyau qui est utilis√©e pour **g√©rer et conserver les cl√©s**.
>
> L'appel syst√®me **keyctl** a √©t√© introduit dans la version du noyau 2.6.10 5 . Cela fournit aux **applications de l'espace utilisateur une API** qui peut √™tre utilis√©e pour interagir avec les porte-cl√©s du noyau.

> Le **nom du porte-cl√©s** utilis√© peut √™tre analys√© √† partir du **fichier de configuration Kerberos /etc/krb5.conf** qui a par d√©faut la permission de lecture activ√©e pour tout le monde (octal 644). Un attaquant peut alors utiliser cette information pour **rechercher des porte-cl√©s contenant des tickets** et extraire les tickets. Un script de preuve de concept qui impl√©mente cette fonctionnalit√© peut √™tre vu dans la Section A.2 **(hercules.sh)**. Dans un porte-cl√©s, le ccache est stock√© sous forme de composants. Comme on peut le voir dans la Figure 2, un ccache de fichier est compos√© de 3 composants distincts : en-t√™te, principal par d√©faut et une s√©quence de justificatifs d'identit√©. Un **porte-cl√©s contient le principal par d√©faut et les justificatifs d'identit√©**. Ce script va d√©charger ces composants dans des fichiers s√©par√©s. Ensuite, en utilisant un **en-t√™te synth√©tis√© par l'attaquant**, ces pi√®ces sont combin√©es dans le bon ordre pour **reconstruire un ccache de fichier**. Ce fichier reconstruit peut ensuite √™tre exfiltr√© vers une machine d'attaquant et ensuite utilis√© pour se faire passer pour un utilisateur Kerberos. Un programme simple pour g√©n√©rer un en-t√™te de ccache valide peut √™tre vu dans la Section A.3.

Bas√© sur le **script heracles.sh** (de l'article), un outil C que vous pouvez utiliser (cr√©√© par l'auteur du post complet) est [**tickey**](https://github.com/TarlogicSecurity/tickey)**, et il extrait les tickets des porte-cl√©s :**
```
```
/tmp/tickey -i
```
**Cette information a √©t√© prise sur :** [**https://www.tarlogic.com/en/blog/how-to-attack-kerberos/**](https://www.tarlogic.com/en/blog/how-to-attack-kerberos/)


<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong> !</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez**-moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
