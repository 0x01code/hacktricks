<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ企業**で働いていますか？ **HackTricksで会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください、独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>


Linuxでは、**チケットは資格情報キャッシュまたはccacheに保存**されます。3つの主要なタイプがあり、それぞれが**チケットの場所を示しています**。

* **ファイル**は、デフォルトでは**/tmp**ディレクトリの下に、**krb5cc\_%{uid}**という形式で保存されます。
* **カーネルキーリング**は、キーを保存するためにLinuxカーネル内に提供される特別な領域です。
* **プロセスメモリ**は、1つのプロセスだけがチケットを使用する場合に使用されます。

特定のマシンで使用されているストレージのタイプを確認するには、デフォルトの_ccache_name_変数を**/etc/krb5.conf**ファイルで確認する必要があります。デフォルトでは、このパラメータが欠落している場合、そのデフォルト値は_FILE:/tmp/krb5cc\_%{uid}_です。

他の2つのソース（キーリングとプロセス）から**チケットを抽出するために**は、2017年に公開された優れた論文[**Kerberos Credential Thievery (GNU/Linux)**](https://www.delaat.net/rp/2016-2017/p97/report.pdf)が、それらからチケットを回復する方法を説明しています。

### キーリング - 論文から

> **Linuxカーネル**には、**キーリング**と呼ばれる機能があります。これは、キーを管理および保持するためにカーネル内に存在する**メモリ領域**です。
>
> **keyctlシステムコール**は、カーネルバージョン2.6.10 5で導入されました。これは、ユーザースペースのアプリケーションがカーネルキーリングと対話するために使用できるAPIを提供します。

> 使用中のキーリングの**名前**は、デフォルトでは誰でも読み取り許可（8進数644）が有効になっている**Kerberos設定ファイル/etc/krb5.conf**から解析できます。攻撃者はこの情報を利用して、キーリングを含むチケットを検索し、チケットを抽出することができます。この機能を実装した概念実証スクリプトは、セクションA.2 **(hercules.sh)**で確認できます。キーリングでは、ccacheはコンポーネントとして保存されます。図2に示すように、ファイルccacheはヘッダー、デフォルトのプリンシパル、および一連の資格情報の3つの異なるコンポーネントで構成されています。**キーリングにはデフォルトのプリンシパルと資格情報が格納**されます。このスクリプトは、これらのコンポーネントを別々のファイルにダンプします。そして、**攻撃者が合成したヘッダー**を使用して、これらのピースを正しい順序で組み合わせて**ファイルccacheを再構築**します。この再構築されたファイルは、攻撃者のマシンに外部送信され、Kerberosユーザーをなりすますために使用できます。有効なccacheヘッダーを生成するための簡単なプログラムは、セクションA.3に示されています。

論文の**heracles.shスクリプト**に基づいて、Cツールである[**tickey**](https://github.com/TarlogicSecurity/tickey)**を使用して、キーリングからチケットを抽出**することができます。
```
/tmp/tickey -i
```
**この情報は以下から取得されました:** [**https://www.tarlogic.com/en/blog/how-to-attack-kerberos/**](https://www.tarlogic.com/en/blog/how-to-attack-kerberos/)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>☁️ HackTricks Cloud ☁️</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>🐦 Twitter 🐦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>🎙️ Twitch 🎙️</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>🎥 Youtube 🎥</strong></a></summary>

- **サイバーセキュリティ企業で働いていますか？** **HackTricksで会社を宣伝**したいですか？または、**PEASSの最新バージョンにアクセスしたり、HackTricksをPDFでダウンロード**したいですか？[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)をチェックしてください！

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)を見つけてください。独占的な[**NFT**](https://opensea.io/collection/the-peass-family)のコレクションです。

- [**公式のPEASS＆HackTricksのグッズ**](https://peass.creator-spring.com)を手に入れましょう。

- [**💬**](https://emojipedia.org/speech-balloon/) [**Discordグループ**](https://discord.gg/hRep4RUj7f)または[**telegramグループ**](https://t.me/peass)に**参加**するか、**Twitter**で**フォロー**してください[**🐦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**。**

- **ハッキングのトリックを共有するには、[hacktricksリポジトリ](https://github.com/carlospolop/hacktricks)と[hacktricks-cloudリポジトリ](https://github.com/carlospolop/hacktricks-cloud)**にPRを提出してください。

</details>
