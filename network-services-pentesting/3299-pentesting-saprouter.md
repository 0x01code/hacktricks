<details>

<summary><strong>рдЬрд╛рдиреЗрдВ AWS рд╣реИрдХрд┐рдВрдЧ рдХреЛ рд╢реВрдиреНрдп рд╕реЗ рд╣реАрд░реЛ рддрдХ</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

рджреВрд╕рд░реЗ рддрд░реАрдХреЗ HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП:

* рдЕрдЧрд░ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХрд╛ рд╡рд┐рдЬреНрдЮрд╛рдкрди HackTricks рдореЗрдВ рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рдпрд╛ **HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ** рддреЛ [**рд╕рдмреНрд╕рдХреНрд░рд┐рдкреНрд╢рди рдкреНрд▓рд╛рдиреНрд╕**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks рд╕реНрд╡реИрдЧ**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* рд╣рдорд╛рд░реЗ рд╡рд┐рд╢реЗрд╖ [**NFTs**](https://opensea.io/collection/the-peass-family) рдХрд▓реЗрдХреНрд╢рди, [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдЦреЛрдЬреЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рд╣рдореЗрдВ **рдЯреНрд╡рд┐рдЯрд░** ЁЯРж [**@carlospolopm**](https://twitter.com/hacktricks_live)** рдкрд░ рдлреЙрд▓реЛ** рдХрд░реЗрдВред
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ** рджреНрд╡рд╛рд░рд╛ PRs рд╕рдмрдорд┐рдЯ рдХрд░рдХреЗ [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos рдореЗрдВред

</details>
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
## рд╕рдордЭреЗрдВ SAProuter Penetration Metasploit рдХреЗ рд╕рд╛рде

SAProuter рдПрдХ рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕реАрдзреЗ рд╕реАрдкреА рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдмреАрдЪ рдкрд╣реБрдВрдЪ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдореБрдЦрддрдГ рдЗрдВрдЯрд░рдиреЗрдЯ рдФрд░ рдЖрдВрддрд░рд┐рдХ SAP рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдмреАрдЪ. рд╕рд╛рдорд╛рдиреНрдпрдд: рд╕рдВрдЧрдардирд┐рдХ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ TCP рдкреЛрд░реНрдЯ 3299 рдХреЛ рдЕрдиреБрдорддрд┐ рджреЗрдХрд░ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдЙрдкрд▓рдмреНрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ. рдпрд╣ рд╕реЗрдЯрдЕрдк SAProuter рдХреЛ рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рдЖрдХрд░реНрд╖рдХ рд▓рдХреНрд╖реНрдп рдмрдирд╛рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЙрдЪреНрдЪ рдореВрд▓реНрдпрд╡рд╛рди рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдХреА рдУрд░ рдПрдХ рдЧреЗрдЯрд╡реЗ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ.

**рд╕реНрдХреИрдирд┐рдВрдЧ рдФрд░ рдЬрд╛рдирдХрд╛рд░реА рдПрдХрддреНрд░ рдХрд░рдирд╛**

рдкрд╣рд▓реЗ, рдПрдХ рд╕реНрдХреИрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдПрдХ рджрд┐рдП рдЧрдП рдЖрдИрдкреА рдкрд░ SAP рд░рд╛рдЙрдЯрд░ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВ, **sap_service_discovery** рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ. рдпрд╣ рдХрджрдо рдПрдХ SAP рд░рд╛рдЙрдЯрд░ рдФрд░ рдЙрд╕рдХреЗ рдЦреБрд▓реЗ рдкреЛрд░реНрдЯ рдХреА рдореМрдЬреВрджрдЧреА рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```
рдЦреЛрдЬ рдХреЗ рдмрд╛рдж, SAP рд░рд╛рдЙрдЯрд░ рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдореЗрдВ рдФрд░ рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИ **sap_router_info_request** рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕рд╛рде, рдЬрд┐рд╕рд╕реЗ рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рд╡рд┐рд╡рд░рдг рдкреНрд░рдХрдЯ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```
**рдЖрдВрддрд░рд┐рдХ рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ**

рдкреНрд░рд╛рдкреНрдд рдХреА рдЧрдИ рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде, **sap_router_portscanner** рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ SAProuter рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯ рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдФрд░ рд╕реЗрд╡рд╛ рд╡рд┐рдиреНрдпрд╛рд╕ рдХреА рдЧрд╣рд░реА рд╕рдордЭ рдорд┐рд▓рддреА рд╣реИред
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```
**рдЙрдиреНрдирдд рдЧрдгрдирд╛ рдФрд░ рдПрд╕реАрдПрд▓ рдореИрдкрд┐рдВрдЧ**

рдФрд░ рд╕реНрдХреИрдирд┐рдВрдЧ рд╕реЗ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ SAProuter рдкрд░ рдПрдХреНрд╕реЗрд╕ рдХрдВрдЯреНрд░реЛрд▓ рд╕реВрдЪреА (ACLs) рдХреИрд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдпрд╣ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реА рдХрдиреЗрдХреНрд╢рди рдЕрдиреБрдорддрд┐ рджреА рдЧрдИ рд╣реИ рдФрд░ рдХреМрди рд╕реА рдмреНрд▓реЙрдХ рдХреА рдЧрдИ рд╣реИред рдпрд╣ рдЬрд╛рдирдХрд╛рд░реА рд╕реБрд░рдХреНрд╖рд╛ рдиреАрддрд┐рдпреЛрдВ рдФрд░ рд╕рдВрднрд╛рд╡рд┐рдд рдХрдорд┐рдпреЛрдВ рдХреЛ рд╕рдордЭрдиреЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```
**рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯ рдХреА рдЕрдВрдзрдХрд░рдг**

рдЬрдм SAProuter рд╕реЗ рд╕реАрдзреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рд╣реЛрддреА рд╣реИ, рддреЛ рдЕрдВрдзрдХрд░рдг рдЬреИрд╕реА рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯрдирд╛рдо рдХреА рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдФрд░ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ, рд╕реАрдзреЗ рдЖрдИрдкреА рдкрддреЛрдВ рдХреЗ рдмрд┐рдирд╛ рд╕рдВрднрд╛рд╡рд┐рдд рд▓рдХреНрд╖реНрдпреЛрдВ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддрд╛ рд╣реИред

**рдкреНрд░рд╡реЗрд╢ рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ**

рдиреЗрдЯрд╡рд░реНрдХ рдХреЛ рдорд╛рдирдЪрд┐рддреНрд░рд┐рдд рдХрд░рдиреЗ рдФрд░ рдкрд╣реБрдВрдЪрдиреЗ рдпреЛрдЧреНрдп рд╕реЗрд╡рд╛рдУрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдкреНрд░рд╡реЗрд╢ рдкрд░реАрдХреНрд╖рдХ Metasploit рдХреА рдкреНрд░реЙрдХреНрд╕реА рдХреНрд╖рдорддрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ SAP рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЖрдВрддрд░рд┐рдХ рдЬрд╛рдВрдЪ рдФрд░ рд╢реЛрд╖рдг рдХреЗ рд▓рд┐рдП SAProuter рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдШреБрд╕рд╛рд╡ рдХрд░ рд╕рдХреЗрдВред
```text
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```
**рдирд┐рд╖реНрдХрд░реНрд╖рдг**

рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реБрд░рдХреНрд╖рд┐рдд SAProuter рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреЗ рдорд╣рддреНрд╡ рдХреЛ рдЬреЛрд░ рджреЗрддрд╛ рд╣реИ рдФрд░ рд▓рдХреНрд╖рд┐рдд рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИред SAP рд░рд╛рдЙрдЯрд░реНрд╕ рдХреЛ рдареАрдХ рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд░рдирд╛ рдФрд░ рдЙрдирдХреА рднреВрдорд┐рдХрд╛ рдХреЛ рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдореЗрдВ рд╕рдордЭрдирд╛, рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рд╕реЗ рдмрдЪрд╛рд╡ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред

Metasploit рдореЙрдбреНрдпреВрд▓реНрд╕ рдФрд░ рдЙрдирдХреЗ рдЙрдкрдпреЛрдЧ рдкрд░ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, [Rapid7 рдХреА рдбреЗрдЯрд╛рдмреЗрд╕](http://www.rapid7.com/db) рдкрд░ рдЬрд╛рдПрдВред


## **рд╕рдВрджрд░реНрдн**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

## Shodan

* `port:3299 !HTTP Network packet too big`
