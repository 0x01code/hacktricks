<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras maneiras de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF** Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) reposit√≥rios do github.

</details>
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
## Compreens√£o da Penetra√ß√£o do SAProuter com o Metasploit

O SAProuter atua como um proxy reverso para sistemas SAP, principalmente para controlar o acesso entre a internet e as redes internas do SAP. √â comum que ele seja exposto √† internet permitindo a porta TCP 3299 atrav√©s dos firewalls organizacionais. Essa configura√ß√£o torna o SAProuter um alvo atraente para testes de penetra√ß√£o, pois pode servir como uma porta de entrada para redes internas de alto valor.

**Escaneamento e Coleta de Informa√ß√µes**

Inicialmente, √© realizado um escaneamento para identificar se um roteador SAP est√° em execu√ß√£o em um determinado IP usando o m√≥dulo **sap_service_discovery**. Este passo √© crucial para estabelecer a presen√ßa de um roteador SAP e sua porta aberta.
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```
Ap√≥s a descoberta, √© realizada uma investiga√ß√£o mais aprofundada na configura√ß√£o do SAP router com o m√≥dulo **sap_router_info_request** para potencialmente revelar detalhes da rede interna.
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```
**Enumerando Servi√ßos Internos**

Com as informa√ß√µes obtidas sobre a rede interna, o m√≥dulo **sap_router_portscanner** √© utilizado para sondar hosts e servi√ßos internos atrav√©s do SAProuter, permitindo uma compreens√£o mais profunda das redes internas e configura√ß√µes de servi√ßo.
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```
**Enumera√ß√£o Avan√ßada e Mapeamento de ACL**

Escaneamentos adicionais podem revelar como as Listas de Controle de Acesso (ACLs) est√£o configuradas no SAProuter, detalhando quais conex√µes s√£o permitidas ou bloqueadas. Essas informa√ß√µes s√£o cruciais para entender as pol√≠ticas de seguran√ßa e poss√≠veis vulnerabilidades.
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```
**Enumera√ß√£o Cega de Hosts Internos**

Em cen√°rios onde as informa√ß√µes diretas do SAProuter s√£o limitadas, t√©cnicas como a enumera√ß√£o cega podem ser aplicadas. Esta abordagem tenta adivinhar e verificar a exist√™ncia de nomes de host internos, revelando poss√≠veis alvos sem endere√ßos IP diretos.

**Alavancando Informa√ß√µes para Testes de Penetra√ß√£o**

Ap√≥s mapear a rede e identificar os servi√ßos acess√≠veis, os testadores de penetra√ß√£o podem utilizar as capacidades de proxy do Metasploit para pivotar atrav√©s do SAProuter para uma explora√ß√£o e explora√ß√£o adicionais dos servi√ßos internos do SAP.
```text
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```
**Conclus√£o**

Esta abordagem destaca a import√¢ncia de configura√ß√µes seguras do SAProuter e destaca o potencial de acesso √†s redes internas por meio de testes de penetra√ß√£o direcionados. Proteger adequadamente os roteadores SAP e entender seu papel na arquitetura de seguran√ßa de rede √© crucial para proteger contra acessos n√£o autorizados.

Para obter informa√ß√µes mais detalhadas sobre os m√≥dulos do Metasploit e seu uso, visite o [banco de dados da Rapid7](http://www.rapid7.com/db).


## **Refer√™ncias**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

## Shodan

* `port:3299 !HTTP Network packet too big`



<details>

<summary><strong>Aprenda hacking AWS do zero ao her√≥i com</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Outras formas de apoiar o HackTricks:

* Se voc√™ deseja ver sua **empresa anunciada no HackTricks** ou **baixar o HackTricks em PDF**, verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Adquira o [**swag oficial PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Junte-se ao** üí¨ [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-nos** no **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para os reposit√≥rios do** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
