<details>

<summary><strong>Μάθετε το χάκινγκ του AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**την Οικογένεια PEASS**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στη [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα χάκινγκ κόλπα σας υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) αποθετήρια του github.

</details>
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
Αυτό είναι ένα σύνοψη της ανάρτησης από [https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/](https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/)

## Κατανόηση της Διείσδυσης SAProuter με το Metasploit

Ο SAProuter λειτουργεί ως αντίστροφος διαμεσολαβητής για τα συστήματα SAP, κυρίως για τον έλεγχο της πρόσβασης μεταξύ του διαδικτύου και των εσωτερικών δικτύων SAP. Συνήθως εκτίθεται στο διαδίκτυο επιτρέποντας τη θύρα TCP 3299 μέσω των πυραμίδων των οργανισμών. Αυτή η ρύθμιση καθιστά το SAProuter ένα ελκυστικό στόχο για τη δοκιμή διείσδυσης, καθώς μπορεί να λειτουργήσει ως πύλη πρόσβασης σε εσωτερικά δίκτυα υψηλής αξίας.

**Σάρωση και Συλλογή Πληροφοριών**

Αρχικά, πραγματοποιείται μια σάρωση για τον εντοπισμό εάν ένας SAP router λειτουργεί σε μια δεδομένη IP χρησιμοποιώντας τον ενότητα **sap_service_discovery**. Αυτό το βήμα είναι κρίσιμο για τον καθορισμό της ύπαρξης ενός SAP router και της ανοιχτής θύρας του.
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```
Ακολουθεί η ανακάλυψη, όπου πραγματοποιείται περαιτέρω έρευνα στη διαμόρφωση του SAP router με τη χρήση του module **sap_router_info_request** για να αποκαλυφθούν πιθανές λεπτομέρειες του εσωτερικού δικτύου.
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```
**Απαρίθμηση Εσωτερικών Υπηρεσιών**

Με τις αποκτηθείσες εσωτερικές πληροφορίες δικτύου, το αρθρώματος **sap_router_portscanner** χρησιμοποιείται για να εξετάσει εσωτερικούς κόμβους και υπηρεσίες μέσω του SAProuter, επιτρέποντας μια πιο βαθιά κατανόηση των εσωτερικών δικτύων και των ρυθμίσεων υπηρεσιών.
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```
Η ευελιξία αυτού του ενότητας στον στόχο συγκεκριμένων περιπτώσεων SAP και θυρών το καθιστά ένα αποτελεσματικό εργαλείο για λεπτομερή εξερεύνηση του εσωτερικού δικτύου.

**Προχωρημένη Απαρίθμηση και Χαρτογράφηση ACL**

Περαιτέρω σάρωση μπορεί να αποκαλύψει πώς οι λίστες ελέγχου πρόσβασης (ACLs) έχουν διαμορφωθεί στο SAProuter, αποκαλύπτοντας ποιες συνδέσεις επιτρέπονται ή αποκλείονται. Αυτές οι πληροφορίες είναι κρίσιμες για την κατανόηση των πολιτικών ασφαλείας και των πιθανών ευπαθειών.
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```
**Τυφλή Απαρίθμηση Εσωτερικών Υπολογιστών**

Σε περιπτώσεις όπου οι άμεσες πληροφορίες από το SAProuter είναι περιορισμένες, μπορούν να εφαρμοστούν τεχνικές όπως η τυφλή απαρίθμηση. Αυτή η προσέγγιση προσπαθεί να μαντέψει και να επαληθεύσει την ύπαρξη εσωτερικών ονομάτων υπολογιστών, αποκαλύπτοντας πιθανούς στόχους χωρίς άμεσες διευθύνσεις IP.

**Αξιοποίηση Πληροφοριών για Τεστ Πενετράρισμα**

Έχοντας χαρτογραφήσει το δίκτυο και εντοπίσει προσβάσιμες υπηρεσίες, οι ελεγκτές διείσδυσης μπορούν να εκμεταλλευτούν τις δυνατότητες του Metasploit για προώθηση μέσω του SAProuter για περαιτέρω εξερεύνηση και εκμετάλλευση εσωτερικών υπηρεσιών SAP.
```text
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```
**Συμπέρασμα**

Αυτή η προσέγγιση υπογραμμίζει τη σημασία της ασφαλούς διαμόρφωσης των SAProuter και αναδεικνύει τη δυνατότητα πρόσβασης σε εσωτερικά δίκτυα μέσω στοχευμένων δοκιμών διείσδυσης. Η σωστή ασφάλεια των SAP routers και η κατανόηση του ρόλου τους στην αρχιτεκτονική ασφάλειας του δικτύου είναι ζωτικής σημασίας για την προστασία από μη εξουσιοδοτημένη πρόσβαση.

Για περισσότερες λεπτομερείς πληροφορίες σχετικά με τα αρθρώματα Metasploit και τη χρήση τους, επισκεφθείτε τη [βάση δεδομένων της Rapid7](http://www.rapid7.com/db).


## **Αναφορές**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

## Shodan

* `port:3299 !HTTP Network packet too big`



<details>

<summary><strong>Μάθετε το hacking στο AWS από το μηδέν μέχρι τον ήρωα με το</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Άλλοι τρόποι για να υποστηρίξετε το HackTricks:

* Εάν θέλετε να δείτε την **εταιρεία σας να διαφημίζεται στο HackTricks** ή να **κατεβάσετε το HackTricks σε μορφή PDF** ελέγξτε τα [**ΣΧΕΔΙΑ ΣΥΝΔΡΟΜΗΣ**](https://github.com/sponsors/carlospolop)!
* Αποκτήστε το [**επίσημο PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ανακαλύψτε [**The PEASS Family**](https://opensea.io/collection/the-peass-family), τη συλλογή μας από αποκλειστικά [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Εγγραφείτε στη** 💬 [**ομάδα Discord**](https://discord.gg/hRep4RUj7f) ή στην [**ομάδα telegram**](https://t.me/peass) ή **ακολουθήστε** μας στο **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Μοιραστείτε τα κόλπα σας στο hacking υποβάλλοντας PRs στα** [**HackTricks**](https://github.com/carlospolop/hacktricks) και [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
