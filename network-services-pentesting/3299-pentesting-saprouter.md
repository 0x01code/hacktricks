<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert de l'√©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

D'autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
## Compr√©hension de la P√©n√©tration de SAProuter avec Metasploit

SAProuter agit comme un proxy inverse pour les syst√®mes SAP, principalement pour contr√¥ler l'acc√®s entre Internet et les r√©seaux internes SAP. Il est couramment expos√© √† Internet en autorisant le port TCP 3299 √† travers les pare-feu organisationnels. Cette configuration rend SAProuter une cible attrayante pour les tests de p√©n√©tration car il pourrait servir de passerelle vers des r√©seaux internes de grande valeur.

**Balayage et Collecte d'Informations**

Initialement, un balayage est effectu√© pour identifier si un routeur SAP fonctionne sur une adresse IP donn√©e en utilisant le module **sap_service_discovery**. Cette √©tape est cruciale pour √©tablir la pr√©sence d'un routeur SAP et de son port ouvert.
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```
Suite √† la d√©couverte, une enqu√™te approfondie sur la configuration du routeur SAP est effectu√©e avec le module **sap_router_info_request** afin de potentiellement r√©v√©ler des d√©tails sur le r√©seau interne.
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```
**√ânum√©ration des services internes**

Avec les informations obtenues sur le r√©seau interne, le module **sap_router_portscanner** est utilis√© pour sonder les h√¥tes et les services internes via le SAProuter, permettant une compr√©hension plus approfondie des r√©seaux internes et des configurations de services.
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```
Ce module offre une flexibilit√© permettant de cibler des instances SAP sp√©cifiques et des ports, en faisant un outil efficace pour une exploration d√©taill√©e du r√©seau interne.

**√ânum√©ration avanc√©e et cartographie des ACL**

Des scans suppl√©mentaires peuvent r√©v√©ler comment les listes de contr√¥le d'acc√®s (ACL) sont configur√©es sur le SAProuter, d√©taillant quelles connexions sont autoris√©es ou bloqu√©es. Ces informations sont cruciales pour comprendre les politiques de s√©curit√© et les vuln√©rabilit√©s potentielles.
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```
**√ânum√©ration aveugle des h√¥tes internes**

Dans les sc√©narios o√π les informations directes provenant du SAProuter sont limit√©es, des techniques telles que l'√©num√©ration aveugle peuvent √™tre appliqu√©es. Cette approche tente de deviner et de v√©rifier l'existence de noms d'h√¥tes internes, r√©v√©lant ainsi des cibles potentielles sans adresses IP directes.

**Exploitation des informations pour les tests de p√©n√©tration**

Apr√®s avoir cartographi√© le r√©seau et identifi√© les services accessibles, les testeurs de p√©n√©tration peuvent utiliser les capacit√©s de proxy de Metasploit pour pivoter √† travers le SAProuter afin d'explorer et d'exploiter davantage les services SAP internes.
```text
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```
**Conclusion**

Cette approche souligne l'importance des configurations s√©curis√©es des SAProuter et met en lumi√®re le potentiel d'acc√®s aux r√©seaux internes gr√¢ce √† des tests de p√©n√©tration cibl√©s. S√©curiser correctement les routeurs SAP et comprendre leur r√¥le dans l'architecture de s√©curit√© r√©seau est crucial pour se prot√©ger contre les acc√®s non autoris√©s.

Pour des informations plus d√©taill√©es sur les modules Metasploit et leur utilisation, visitez la [base de donn√©es de Rapid7](http://www.rapid7.com/db).


## **R√©f√©rences**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

## Shodan

* `port:3299 !HTTP Network packet too big`



<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) d√©p√¥ts github.

</details>
