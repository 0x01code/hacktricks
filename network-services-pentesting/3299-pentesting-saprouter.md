<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata su HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PIANI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo Telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai repository github di** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
## Comprensione della penetrazione di SAProuter con Metasploit

SAProuter funge da proxy inverso per i sistemi SAP, principalmente per controllare l'accesso tra Internet e le reti interne SAP. √à comunemente esposto su Internet consentendo la porta TCP 3299 attraverso i firewall organizzativi. Questa configurazione rende SAProuter un obiettivo interessante per i test di penetrazione perch√© potrebbe fungere da gateway per reti interne di alto valore.

**Scansione e raccolta di informazioni**

Inizialmente, viene eseguita una scansione per identificare se un router SAP √® in esecuzione su un determinato IP utilizzando il modulo **sap_service_discovery**. Questo passaggio √® cruciale per stabilire la presenza di un router SAP e la sua porta aperta.
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```
Dopo la scoperta, viene effettuata un'ulteriore indagine sulla configurazione del router SAP con il modulo **sap_router_info_request** per potenzialmente rivelare dettagli sulla rete interna.
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```
**Enumerazione dei servizi interni**

Con le informazioni ottenute sulla rete interna, il modulo **sap_router_portscanner** viene utilizzato per sondare gli host e i servizi interni tramite SAProuter, consentendo una comprensione pi√π approfondita delle reti interne e delle configurazioni dei servizi.
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```
Questo modulo, grazie alla sua flessibilit√† nel mirare istanze e porte SAP specifiche, si rivela uno strumento efficace per l'esplorazione dettagliata della rete interna.

**Enumerazione avanzata e mappatura ACL**

Scansioni ulteriori possono rivelare come le Access Control List (ACL) sono configurate sul SAProuter, fornendo dettagli su quali connessioni sono consentite o bloccate. Queste informazioni sono fondamentali per comprendere le politiche di sicurezza e le potenziali vulnerabilit√†.
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```
**Enumerazione cieca degli host interni**

In scenari in cui le informazioni dirette dal SAProuter sono limitate, √® possibile applicare tecniche come l'enumerazione cieca. Questo approccio cerca di indovinare e verificare l'esistenza dei nomi degli host interni, rivelando potenziali obiettivi senza indirizzi IP diretti.

**Sfruttare le informazioni per il penetration testing**

Dopo aver mappato la rete e identificato i servizi accessibili, i penetration tester possono utilizzare le capacit√† di proxy di Metasploit per pivotare attraverso il SAProuter per ulteriori esplorazioni e sfruttamenti dei servizi interni SAP.
```text
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```
**Conclusion**

Questo approccio sottolinea l'importanza di configurazioni sicure per SAProuter e mette in evidenza il potenziale di accesso alle reti interne attraverso test di penetrazione mirati. La corretta protezione dei router SAP e la comprensione del loro ruolo nell'architettura della sicurezza di rete sono cruciali per proteggersi dall'accesso non autorizzato.

Per ulteriori informazioni dettagliate sui moduli Metasploit e il loro utilizzo, visita il [database di Rapid7](http://www.rapid7.com/db).


## **Riferimenti**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

## Shodan

* `port:3299 !HTTP Network packet too big`



<details>

<summary><strong>Impara l'hacking di AWS da zero a eroe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Altri modi per supportare HackTricks:

* Se vuoi vedere la tua **azienda pubblicizzata in HackTricks** o **scaricare HackTricks in PDF** Controlla i [**PACCHETTI DI ABBONAMENTO**](https://github.com/sponsors/carlospolop)!
* Ottieni il [**merchandising ufficiale di PEASS & HackTricks**](https://peass.creator-spring.com)
* Scopri [**The PEASS Family**](https://opensea.io/collection/the-peass-family), la nostra collezione di esclusive [**NFT**](https://opensea.io/collection/the-peass-family)
* **Unisciti al** üí¨ [**gruppo Discord**](https://discord.gg/hRep4RUj7f) o al [**gruppo telegram**](https://t.me/peass) o **seguici** su **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Condividi i tuoi trucchi di hacking inviando PR ai** [**HackTricks**](https://github.com/carlospolop/hacktricks) e [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
