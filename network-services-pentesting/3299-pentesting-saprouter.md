<details>

<summary><strong>Lernen Sie AWS-Hacking von Null auf Held mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie PRs an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
## Verst√§ndnis der SAProuter-Penetration mit Metasploit

SAProuter fungiert als Reverse-Proxy f√ºr SAP-Systeme, haupts√§chlich um den Zugriff zwischen dem Internet und internen SAP-Netzwerken zu kontrollieren. Es wird h√§ufig √ºber TCP-Port 3299 durch organisatorische Firewalls dem Internet zug√§nglich gemacht. Diese Konfiguration macht SAProuter zu einem attraktiven Ziel f√ºr Penetrationstests, da es als Gateway zu hochwertigen internen Netzwerken dienen k√∂nnte.

**Scannen und Informationsbeschaffung**

Zun√§chst wird ein Scan durchgef√ºhrt, um festzustellen, ob ein SAP-Router auf einer bestimmten IP l√§uft, indem das Modul **sap_service_discovery** verwendet wird. Dieser Schritt ist entscheidend, um die Anwesenheit eines SAP-Routers und seines offenen Ports festzustellen.
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
msf auxiliary(sap_service_discovery) > run
```
Nach der Entdeckung wird eine weitere Untersuchung der Konfiguration des SAP-Routers mit dem Modul **sap_router_info_request** durchgef√ºhrt, um m√∂glicherweise interne Netzwerkinformationen aufzudecken.
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
msf auxiliary(sap_router_info_request) > run
```
**Ermittlung interner Dienste**

Mit den erhaltenen Einblicken in das interne Netzwerk wird das Modul **sap_router_portscanner** verwendet, um interne Hosts und Dienste √ºber den SAProuter zu sondieren und so ein tieferes Verst√§ndnis f√ºr interne Netzwerke und Servicekonfigurationen zu erlangen.
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
```
Dieses Modul bietet aufgrund seiner Flexibilit√§t bei der gezielten Ausrichtung auf bestimmte SAP-Instanzen und Ports ein effektives Werkzeug f√ºr eine detaillierte interne Netzwerkerkundung.

**Erweiterte Enumeration und ACL-Mapping**

Durch weitere Scans kann herausgefunden werden, wie die Zugriffskontrolllisten (ACLs) auf dem SAProuter konfiguriert sind und welche Verbindungen erlaubt oder blockiert werden. Diese Informationen sind entscheidend, um Sicherheitsrichtlinien und potenzielle Schwachstellen zu verstehen.
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
```
**Blind Enumeration der internen Hosts**

In Szenarien, in denen direkte Informationen vom SAProuter begrenzt sind, k√∂nnen Techniken wie die blinde Enumeration angewendet werden. Dieser Ansatz versucht, die Existenz interner Hostnamen zu erraten und zu √ºberpr√ºfen, um potenzielle Ziele ohne direkte IP-Adressen aufzudecken.

**Nutzung von Informationen f√ºr Penetrationstests**

Nachdem das Netzwerk kartiert und zug√§ngliche Dienste identifiziert wurden, k√∂nnen Penetrationstester die Proxy-F√§higkeiten von Metasploit nutzen, um √ºber den SAProuter weiterhin interne SAP-Dienste zu erkunden und auszunutzen.
```text
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run
```
**Fazit**

Dieser Ansatz unterstreicht die Bedeutung einer sicheren Konfiguration von SAProuter und verdeutlicht das Potenzial f√ºr den Zugriff auf interne Netzwerke durch gezieltes Penetration Testing. Eine ordnungsgem√§√üe Absicherung von SAP-Routern und das Verst√§ndnis ihrer Rolle in der Netzwerksicherheitsarchitektur sind entscheidend, um sich vor unbefugtem Zugriff zu sch√ºtzen.

F√ºr weitere detaillierte Informationen zu Metasploit-Modulen und ihrer Verwendung besuchen Sie die [Datenbank von Rapid7](http://www.rapid7.com/db).


## **Referenzen**

* [https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/](https://www.rapid7.com/blog/post/2014/01/09/piercing-saprouter-with-metasploit/)

## Shodan

* `port:3299 !HTTP Network packet too big`



<details>

<summary><strong>Lernen Sie AWS-Hacking von Grund auf mit</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Andere M√∂glichkeiten, HackTricks zu unterst√ºtzen:

* Wenn Sie Ihr **Unternehmen in HackTricks bewerben m√∂chten** oder **HackTricks als PDF herunterladen m√∂chten**, √ºberpr√ºfen Sie die [**ABONNEMENTPL√ÑNE**](https://github.com/sponsors/carlospolop)!
* Holen Sie sich das [**offizielle PEASS & HackTricks-Merchandise**](https://peass.creator-spring.com)
* Entdecken Sie [**The PEASS Family**](https://opensea.io/collection/the-peass-family), unsere Sammlung exklusiver [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Treten Sie der** üí¨ [**Discord-Gruppe**](https://discord.gg/hRep4RUj7f) oder der [**Telegram-Gruppe**](https://t.me/peass) bei oder **folgen** Sie uns auf **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Teilen Sie Ihre Hacking-Tricks, indem Sie Pull Requests an die** [**HackTricks**](https://github.com/carlospolop/hacktricks) und [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) GitHub-Repositories senden.

</details>
