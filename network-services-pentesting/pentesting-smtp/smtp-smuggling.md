# SMTP Kaçakçılığı

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı göndererek HackTricks ve HackTricks Cloud** github depolarına PR göndererek paylaşın.

</details>

## Temel Bilgiler

Bu tür bir zayıflık [**bu gönderide orijinal olarak keşfedildi**](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/), burada SMTP protokolünün bir e-postayı tamamlarken nasıl yorumlandığındaki farklılıklardan yararlanarak, bir saldırganın meşru bir e-postanın gövdesine daha fazla e-posta kaçırmasına izin verdiği açıklanmıştır, etkilenen alanın diğer kullanıcılarını (örneğin admin@outlook.com gibi) taklit etmesine olanak tanırken SPF gibi savunmaları atlamasına izin verir.

### Neden

Bu, SMTP protokolünde, e-postada gönderilecek olan **mesajın verisinin** bir kullanıcı (saldırgan) tarafından kontrol edildiği için mümkündür ve bu, alıcının içine daha fazla e-posta kaçırabilecek şekilde özel olarak oluşturulmuş veriler gönderen bir saldırganın farklı ayrıştırıcılardaki farklılıkları istismar etmesine izin verir. Bu konuda orijinal gönderiden yapılan bu resimli örneğe bakın:

<figure><img src="../../.gitbook/assets/image (5).png" alt=""><figcaption><p><a href="https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png">https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png</a></p></figcaption></figure>

### Nasıl

Bu zayıflığı sömürmek için bir saldırganın, **Giden SMTP sunucusunun bir e-posta olduğunu düşündüğü ancak Gelen SMTP sunucusunun birden fazla e-posta olduğunu düşündüğü bazı veriler göndermesi gerekir**.

Araştırmacılar, farklı **Gelen sunucuların e-posta mesajının verisinin sonu olarak farklı karakterleri** düşündüğünü keşfettiler.\
Örneğin, düzenli bir veri sonu `\r\n.\r\n`'dir. Ancak Gelen SMTP sunucusu ayrıca `\n.\n`'yi de destekliyorsa, bir saldırgan sadece **bu veriyi e-postasına ekleyebilir ve yeni bir e-postayı kaçırmak için SMTP komutlarını** belirtmeye başlayabilir, önceki resimde olduğu gibi.

Tabii ki, bu yalnızca **Giden SMTP sunucusunun bu veriyi** de mesaj verisinin sonu olarak işlememesi durumunda çalışabilir, çünkü o zaman 1 yerine 2 e-posta görecektir, bu nedenle bu, bu zayıflıktan yararlanılan bu desenkronizasyondur.

Potansiyel desenkronizasyon verileri:

* `\n.\n`
* `\n.\r\n`

Ayrıca SPF'nin atlatıldığını unutmayın çünkü `admin@outlook.com`'dan bir e-postayı `user@outlook.com`'dan kaçırırsanız, **gönderen hala `outlook.com` olacaktır.**

## **Referanslar**

* [https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/)

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong> ile!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* [**PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking püf noktalarınızı göndererek HackTricks ve HackTricks Cloud** github depolarına PR göndererek paylaşın.

</details>
