# SMTP Smuggling

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>

## Taarifa Msingi

Aina hii ya udhaifu uligunduliwa [**awali katika chapisho hili**](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/) ambapo imeelezwa kwamba Inawezekana **kutumia tofauti katika jinsi itifaki ya SMTP inavyotafsiriwa** wakati wa kumalizia barua pepe, kuruhusu mshambuliaji kusafirisha barua pepe zaidi katika mwili wa ile halali, kuruhusu kujifanya kuwa watumiaji wengine wa kikoa kilichoathiriwa (kama vile admin@outlook.com) kwa kukiuka ulinzi kama SPF.

### Kwa Nini

Hii ni kwa sababu katika itifaki ya SMTP, **data ya ujumbe** utakaotumwa kwenye barua pepe inadhibitiwa na mtumiaji (mshambuliaji) ambaye anaweza kutuma data iliyoundwa maalum ikidanganya tofauti katika wapambanuzi ambao watasafirisha barua pepe zaidi kwa mpokeaji. Angalia mfano ulioonyeshwa kutoka kwenye chapisho la awali:

<figure><img src="../../.gitbook/assets/image (2) (1).png" alt=""><figcaption><p><a href="https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png">https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png</a></p></figcaption></figure>

### Jinsi

Ili kutumia udhaifu huu, mshambuliaji anahitaji kutuma data fulani ambayo **server ya SMPT ya kutoka inadhani ni barua pepe 1 tu lakini server ya SMPT ya kuingia inadhani kuna barua pepe kadhaa**.

Watafiti waligundua kuwa **server tofauti za kuingia zinachukulia wahusika tofauti kama mwisho wa data** ya ujumbe wa barua pepe ambayo server za kutoka hazifanyi.\
Kwa mfano, mwisho wa kawaida wa data ni `\r\n.\r`. Lakini ikiwa server ya SMPT ya kuingia pia inasaidia `\n.`, mshambuliaji anaweza tu kuongeza **data hiyo kwenye barua pepe yake na kuanza kutaja amri za SMPT** za mpya kusafirisha kama ilivyo kwenye picha iliyotangulia.

Bila shaka, hii inaweza kufanya kazi ikiwa **server ya SMPT ya kutoka pia haichukulii data hii** kama mwisho wa data ya ujumbe, kwa sababu katika kesi hiyo itaona barua pepe 2 badala ya 1 tu, kwa hivyo mwishowe hii ndio kutofautisha ambayo inatumika katika udhaifu huu.

Data ya kutofautisha inayowezekana:

* `\n.`
* `\n.\r`

Pia elewa kuwa SPF inapuuzwa kwa sababu ikiwa unachukua barua pepe kutoka `admin@outlook.com` kutoka kwa barua pepe kutoka `user@outlook.com`, **mtumaji bado ni `outlook.com`.**

## **Vyanzo**

* [https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/)

<details>

<summary><strong>Jifunze kuhusu kudukua AWS kutoka sifuri hadi shujaa na</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Mtaalam wa Timu Nyekundu ya AWS ya HackTricks)</strong></a><strong>!</strong></summary>

Njia nyingine za kusaidia HackTricks:

* Ikiwa unataka kuona **kampuni yako ikitangazwa kwenye HackTricks** au **kupakua HackTricks kwa PDF** Angalia [**MIPANGO YA KUJIUNGA**](https://github.com/sponsors/carlospolop)!
* Pata [**bidhaa rasmi za PEASS & HackTricks**](https://peass.creator-spring.com)
* Gundua [**Familia ya PEASS**](https://opensea.io/collection/the-peass-family), mkusanyiko wetu wa kipekee wa [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Jiunge na** üí¨ [**Kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au kikundi cha [**telegram**](https://t.me/peass) au **tufuate** kwenye **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu zako za kudukua kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
