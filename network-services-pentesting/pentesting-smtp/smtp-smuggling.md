# SMTP Smuggling

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini alın**](https://peass.creator-spring.com)
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking hilelerinizi göndererek HackTricks ve HackTricks Cloud** github depolarına PR gönderin.

</details>

## Temel Bilgiler

Bu tür bir zayıflık [**bu yazıda orijinal olarak keşfedildi**](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/), burada SMTP protokolünün bir e-postayı sonlandırırken nasıl yorumlandığındaki farklılıklardan yararlanarak, bir saldırganın meşru bir e-postanın gövdesine daha fazla e-posta sokmasına izin verdiği ve etkilenen alanın diğer kullanıcılarını (örneğin admin@outlook.com gibi) taklit etmesine olanak tanıdığı açıklanmıştır.

### Neden

Bu, SMTP protokolünde, e-postada gönderilecek olan **mesaj verisinin** bir kullanıcı (saldırgan) tarafından kontrol edildiği için mümkündür ve bu, alıcının içine daha fazla e-posta sokacak şekilde ayrımcılıkları istismar eden özel olarak oluşturulmuş veriler gönderebilecek bir saldırganın, etkilenen alanın diğer kullanıcılarını taklit etmesine olanak tanır. SPF gibi savunmaları atlayabilir.

### Nasıl

Bu zayıflığı sömürmek için bir saldırganın, **Giden SMTP sunucusunun bunun sadece 1 e-posta olduğunu düşündüğü bazı veriler göndermesi gerekmektedir, ancak Gelen SMTP sunucusunun birden fazla e-posta olduğunu düşündüğü veriler göndermesi gerekmektedir**.

Araştırmacılar, **Gelen sunucuların e-posta mesajının veri sonunu farklı karakterler olarak kabul ettiğini** keşfettiler.\
Örneğin, düzenli bir veri sonu `\r\n.\r\n`'dir. Ancak Gelen SMTP sunucusu aynı zamanda `\n.\n`'yi de destekliyorsa, bir saldırgan sadece **bu veriyi e-postasına ekleyebilir ve önceki resimde olduğu gibi onu kaçırmak için yeni SMTP komutlarını belirtmeye başlayabilir**.

Tabii ki, bu yalnızca **Giden SMTP sunucusunun bu veriyi aynı zamanda mesaj verisinin sonu olarak işlememesi** durumunda çalışabilir, çünkü o zaman 1 yerine 2 e-posta görecektir, bu nedenle sonuçta bu, bu zayıflıktan yararlanılan bu desenkronizasyondur.

Potansiyel desenkronizasyon verileri:

* `\n.\n`
* `\n.\r\n`

Ayrıca SPF'nin atlatıldığını unutmayın çünkü `admin@outlook.com` adresinden bir e-postayı `user@outlook.com` adresinden kaçırırsanız, **gönderen hala `outlook.com` olacaktır.**

## **Referanslar**

* [https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/)

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahramana kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini alın**](https://peass.creator-spring.com)
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking hilelerinizi göndererek HackTricks ve HackTricks Cloud** github depolarına PR gönderin.

</details>
