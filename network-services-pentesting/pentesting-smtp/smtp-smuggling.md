# SMTP Smuggling

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahraman olmaya kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini alın**](https://peass.creator-spring.com)
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking hilelerinizi göndererek HackTricks ve HackTricks Cloud** github depolarına PR göndererek paylaşın.

</details>

## Temel Bilgiler

Bu tür bir zayıflık [**bu yazıda orijinal olarak keşfedildi**](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/) ve SMTP protokolünün nasıl yorumlandığındaki farklılıklardan yararlanarak bir e-postayı sonlandırırken daha fazla e-postayı kaçırma olanağı sağladığı açıklanmıştır, saldırganın etkilenen alanın diğer kullanıcılarını (örneğin admin@outlook.com gibi) taklit etmesine olanak tanırken SPF gibi savunmaları atlamasına izin verir.

### Neden

Bu, SMTP protokolünde, e-postada gönderilecek olan **mesaj verisinin** bir kullanıcı (saldırgan) tarafından kontrol edildiği için mümkündür ve bu, alıcıya ekstra e-postaları kaçıracak ayrıntılarda istismar edebilecek bir saldırganın özel olarak oluşturulmuş veriler göndermesine olanak tanır. Orijinal yazıdan bu örnekli örneğe bir göz atın:

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption><p><a href="https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png">https://sec-consult.com/fileadmin/user_upload/sec-consult/Dynamisch/Blogartikel/2023_12/SMTP_Smuggling-Overview__09_.png</a></p></figcaption></figure>

### Nasıl

Bu zayıflığı sömürmek için bir saldırganın yapması gereken, **Giden SMTP sunucusunun sadece 1 e-posta olduğunu düşündüğü bazı veriler göndermektir, ancak Gelen SMTP sunucusunun birden fazla e-posta olduğunu düşündüğü verilerdir**.

Araştırmacılar, farklı **Gelen sunucuların e-posta mesajının veri sonunu farklı karakterler olarak düşündüğünü keşfettiler**.\
Örneğin, düzenli bir veri sonu `\r\n.\r\n`'dir. Ancak Gelen SMTP sunucusu aynı zamanda `\n.\n`'yi de destekliyorsa, bir saldırgan sadece e-postasına **bu veriyi ekleyebilir ve önceki resimde olduğu gibi kaçırmak için yeni SMTP komutlarını belirtmeye başlayabilir**.

Tabii ki, bu yalnızca **Giden SMTP sunucusunun bu veriyi** mesaj verisinin sonu olarak da işlemediği durumda çalışabilir, çünkü o zaman 1 yerine 2 e-posta görecektir, bu nedenle sonuçta bu, bu zayıflıktan yararlanılan desenkronizasyondur.

Potansiyel desenkronizasyon verileri:

* `\n.\n`
* `\n.\r\n`

Ayrıca SPF'nin atlatıldığını unutmayın çünkü `admin@outlook.com` adresinden bir e-postayı `user@outlook.com` adresinden kaçırırsanız, **gönderen hala `outlook.com` olacaktır.**

## **Referanslar**

* [https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/](https://sec-consult.com/blog/detail/smtp-smuggling-spoofing-e-mails-worldwide/)

<details>

<summary><strong>AWS hackleme konusunda sıfırdan kahraman olmaya kadar öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamını görmek istiyorsanız** veya **HackTricks'i PDF olarak indirmek istiyorsanız** [**ABONELİK PLANLARINI**](https://github.com/sponsors/carlospolop) kontrol edin!
* [**Resmi PEASS & HackTricks ürünlerini alın**](https://peass.creator-spring.com)
* [**The PEASS Ailesi'ni**](https://opensea.io/collection/the-peass-family) keşfedin, özel [**NFT'lerimiz**](https://opensea.io/collection/the-peass-family) koleksiyonumuz
* **Katılın** 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) veya bizi **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks\_live)** takip edin.**
* **Hacking hilelerinizi göndererek HackTricks ve HackTricks Cloud** github depolarına PR göndererek paylaşın.

</details>
