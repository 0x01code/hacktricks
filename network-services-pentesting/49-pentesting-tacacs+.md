# 49 - Pentestiranje TACACS+

<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu**, proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>

## Osnovne informacije

Protokol **Terminal Access Controller Access Control System (TACACS)** se koristi za centralnu validaciju korisnika koji pokušavaju da pristupe ruterima ili Network Access Serverima (NAS). Njegova nadograđena verzija, **TACACS+**, razdvaja usluge na autentifikaciju, autorizaciju i evidentiranje (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Podrazumevani port:** 49

## Presretanje autentifikacionog ključa

Ako komunikacija između klijenta i TACACS servera bude presretnuta od strane napadača, **može se presresti šifrovani autentifikacioni ključ**. Napadač može zatim pokušati **lokalni napad brute force-om na ključ bez otkrivanja u logovima**. Ako uspe u brute force napadu na ključ, napadač dobija pristup mrežnoj opremi i može dešifrovati saobraćaj koristeći alate poput Wireshark-a.

### Izvođenje MitM napada

**Napad ARP spoofing-om može se koristiti za izvođenje napada Man-in-the-Middle (MitM)**.

### Brute force napad na ključ

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) se može koristiti za brute force napad na ključ:
```
sudo loki_gtk.py
```
Ako ključ uspešno bude **bruteforsovan** (**obično u formatu MD5 enkripcije)**, **možemo pristupiti opremi i dešifrovati TACACS-enkriptovani saobraćaj**.

### Dešifrovanje saobraćaja
Kada ključ bude uspešno probijen, sledeći korak je **dešifrovanje TACACS-enkriptovanog saobraćaja**. Wireshark može obraditi enkriptovani TACACS saobraćaj ako je ključ obezbeđen. Analizom dešifrovanog saobraćaja, mogu se dobiti informacije kao što su **korišćeni baner i korisničko ime admin korisnika**.

Dobijanjem pristupa kontrolnoj tabli mrežne opreme korišćenjem dobijenih akreditiva, napadač može imati kontrolu nad mrežom. Važno je napomenuti da su ove radnje isključivo u edukativne svrhe i ne bi trebalo koristiti bez odgovarajuće autorizacije.

## Reference

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


<details>

<summary><strong>Naučite hakovanje AWS-a od nule do heroja sa</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Drugi načini podrške HackTricks-u:

* Ako želite da vidite **vašu kompaniju reklamiranu na HackTricks-u** ili **preuzmete HackTricks u PDF formatu**, proverite [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Nabavite [**zvanični PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Otkrijte [**The PEASS Family**](https://opensea.io/collection/the-peass-family), našu kolekciju ekskluzivnih [**NFT-ova**](https://opensea.io/collection/the-peass-family)
* **Pridružite se** 💬 [**Discord grupi**](https://discord.gg/hRep4RUj7f) ili [**telegram grupi**](https://t.me/peass) ili nas **pratite** na **Twitter-u** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Podelite svoje hakovanje trikove slanjem PR-ova na** [**HackTricks**](https://github.com/carlospolop/hacktricks) i [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repozitorijume.

</details>
