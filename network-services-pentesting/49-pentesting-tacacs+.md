# 49 - Test d'intrusion TACACS+

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Expert en √©quipe rouge AWS de HackTricks)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop) !
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFT**](https://opensea.io/collection/the-peass-family)
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez-nous** sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>

**Groupe de s√©curit√© Try Hard**

<figure><img src="../.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

***

## Informations de base

Le protocole **Terminal Access Controller Access Control System (TACACS)** est utilis√© pour valider de mani√®re centralis√©e les utilisateurs tentant d'acc√©der aux routeurs ou aux serveurs d'acc√®s r√©seau (NAS). Sa version am√©lior√©e, **TACACS+**, s√©pare les services en authentification, autorisation et comptabilit√© (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Port par d√©faut :** 49

## Intercepter la cl√© d'authentification

Si la communication entre le client et le serveur TACACS est intercept√©e par un attaquant, **la cl√© d'authentification chiffr√©e peut √™tre intercept√©e**. L'attaquant peut ensuite tenter une **attaque de force brute locale contre la cl√© sans √™tre d√©tect√© dans les journaux**. En cas de succ√®s dans la force brute de la cl√©, l'attaquant obtient l'acc√®s aux √©quipements du r√©seau et peut d√©crypter le trafic en utilisant des outils comme Wireshark.

### R√©alisation d'une attaque MitM

Une attaque de **spoofing ARP peut √™tre utilis√©e pour r√©aliser une attaque de l'Homme du Milieu (MitM)**.

### Force brute de la cl√©

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) peut √™tre utilis√© pour effectuer une force brute sur la cl√© :
```
sudo loki_gtk.py
```
Si la cl√© est r√©ussie **bruteforc√©e** (**g√©n√©ralement au format crypt√© MD5)**, **nous pouvons acc√©der √† l'√©quipement et d√©crypter le trafic chiffr√© TACACS.**

### D√©cryptage du trafic
Une fois la cl√© r√©ussie, la prochaine √©tape consiste √† **d√©crypter le trafic chiffr√© TACACS**. Wireshark peut g√©rer le trafic TACACS chiffr√© si la cl√© est fournie. En analysant le trafic d√©crypt√©, des informations telles que la **banni√®re utilis√©e et le nom d'utilisateur de l'administrateur** peuvent √™tre obtenues.

En acc√©dant au panneau de contr√¥le de l'√©quipement r√©seau en utilisant les identifiants obtenus, l'attaquant peut exercer un contr√¥le sur le r√©seau. Il est important de noter que ces actions sont strictement √† des fins √©ducatives et ne doivent pas √™tre utilis√©es sans autorisation appropri√©e.

## R√©f√©rences

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

**Try Hard Security Group**

<figure><img src="../.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres fa√ßons de soutenir HackTricks:

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**swag officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**The PEASS Family**](https://opensea.io/collection/the-peass-family), notre collection exclusive de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Rejoignez** üí¨ [**le groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe Telegram**](https://t.me/peass) ou **suivez** nous sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
