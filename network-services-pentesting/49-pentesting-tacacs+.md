## Informaci√≥n B√°sica

**Terminal Access Controller Access Control System (TACACS)** es un protocolo de seguridad que proporciona validaci√≥n centralizada de usuarios que intentan obtener **acceso a un router o NAS**. TACACS+, una versi√≥n m√°s reciente del protocolo TACACS original, proporciona servicios separados de autenticaci√≥n, autorizaci√≥n y contabilidad (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Puerto predeterminado:** 49

## Interceptar la clave de autenticaci√≥n

Si un atacante logra interponerse entre el cliente y el servidor TACACS, **puede interceptar la clave de autenticaci√≥n** en forma cifrada y luego realizar un ataque de fuerza bruta local contra ella. De esta manera, se puede realizar el ataque de fuerza bruta sin aparecer en los registros. Si se logra descifrar la clave, **se podr√° acceder al equipo de red y descifrar el tr√°fico** en **Wireshark**.

### MitM

Para realizar un ataque MitM, se puede utilizar un [**ataque de suplantaci√≥n de ARP**](../generic-methodologies-and-resources/pentesting-network/#arp-spoofing).

### Fuerza bruta de la clave

Ahora es necesario ejecutar [Loki](https://c0decafe.de/svn/codename\_loki/trunk/). Esta es una herramienta especial dise√±ada para analizar la seguridad de los protocolos L2/L3. Sus capacidades son tan buenas como las del popular **Yersinia** y es un competidor serio. Loki tambi√©n puede realizar ataques de fuerza bruta contra claves TACACS. Si se logra **descifrar** la clave con √©xito (**generalmente en formato cifrado MD5)**, **se puede acceder al equipo y descifrar el tr√°fico cifrado de TACACS**.
```
sudo loki_gtk.py
```
<figure><img src="../.gitbook/assets/image (31) (2).png" alt=""><figcaption></figcaption></figure>

Tambi√©n es necesario especificar la ruta al diccionario para realizar un ataque de fuerza bruta a la clave encriptada. Aseg√∫rate de desmarcar la opci√≥n **Use Bruteforce**, de lo contrario Loki intentar√° forzar la contrase√±a sin usar el diccionario.

<figure><img src="../.gitbook/assets/image (11) (2).png" alt=""><figcaption></figcaption></figure>

Ahora debemos esperar a que un administrador inicie sesi√≥n en el dispositivo a trav√©s del servidor TACACS. Se asume que el administrador de red ya ha iniciado sesi√≥n, y nosotros, **interceptando el tr√°fico en el medio a trav√©s de ARP spoofing**, interceptamos el tr√°fico. Y al hacerlo, los hosts leg√≠timos no se dan cuenta de que alguien m√°s ha interferido en su conexi√≥n.

<figure><img src="../.gitbook/assets/image (8) (2) (3).png" alt=""><figcaption></figcaption></figure>

Ahora haz clic en el bot√≥n **CRACK** y espera a que **Loki** rompa la contrase√±a.

<figure><img src="../.gitbook/assets/image (17) (2).png" alt=""><figcaption></figcaption></figure>

### Descifrar el tr√°fico

Genial, logramos desbloquear la clave, ahora necesitamos descifrar el tr√°fico TACACS. Como dije, Wireshark puede manejar el tr√°fico TACACS encriptado si la clave est√° presente.

<figure><img src="../.gitbook/assets/image (28) (1).png" alt=""><figcaption></figcaption></figure>

Vemos qu√© banner se us√≥.

<figure><img src="../.gitbook/assets/image (24) (1) (2).png" alt=""><figcaption></figcaption></figure>

Encontramos el nombre de usuario del usuario `admin`

<figure><img src="../.gitbook/assets/image (7) (1) (1).png" alt=""><figcaption></figcaption></figure>

Como resultado, **tenemos las credenciales `admin:secret1234`,** que se pueden usar para acceder al hardware en s√≠. **Creo que verificar√© su validez.**

<figure><img src="../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

As√≠ es como puedes atacar TACACS+ y **obtener acceso** al panel de control del equipo de red.

## Referencias

* La secci√≥n de clave de intercepci√≥n se copi√≥ de [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos.
* Obt√©n el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PR al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
