# 49 - Pentesting TACACS+

<details>

<summary><strong>Apprenez le piratage AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de piratage en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informations de base

**Terminal Access Controller Access Control System (TACACS)** est un protocole de s√©curit√© qui fournit une validation centralis√©e des utilisateurs qui tentent d'obtenir **l'acc√®s √† un routeur ou √† un NAS**. TACACS+, une version plus r√©cente du protocole TACACS original, fournit des services d'authentification, d'autorisation et de comptabilit√© (AAA) s√©par√©s.
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Port par d√©faut :** 49

## Intercepter la cl√© d'authentification

Si la communication entre le client et le serveur TACACS est intercept√©e par un attaquant, la **cl√© d'authentification chiffr√©e peut √™tre intercept√©e**. L'attaquant peut alors tenter une **attaque par force brute locale contre la cl√© sans √™tre d√©tect√© dans les journaux**. Si l'attaque par force brute est r√©ussie, l'attaquant obtient l'acc√®s √† l'√©quipement r√©seau et peut d√©chiffrer le trafic en utilisant des outils comme Wireshark.

### R√©aliser une attaque MitM

Une **attaque de spoofing ARP peut √™tre utilis√©e pour r√©aliser une attaque de l'homme du milieu (MitM)**.

### Forcer la cl√© par brute-force

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) peut √™tre utilis√© pour forcer la cl√© par brute-force :
```
sudo loki_gtk.py
```
```markdown
Si la cl√© est **bruteforc√©e** avec succ√®s (**g√©n√©ralement au format chiffr√© MD5)**, **nous pouvons acc√©der √† l'√©quipement et d√©crypter le trafic chiffr√© TACACS.**

### D√©cryptage du trafic
Une fois la cl√© correctement craqu√©e, l'√©tape suivante consiste √† **d√©crypter le trafic chiffr√© TACACS**. Wireshark peut g√©rer le trafic TACACS chiffr√© si la cl√© est fournie. En analysant le trafic d√©crypt√©, des informations telles que le **banner utilis√© et le nom d'utilisateur de l'administrateur** peuvent √™tre obtenues.

En acc√©dant au panneau de contr√¥le de l'√©quipement r√©seau √† l'aide des identifiants obtenus, l'attaquant peut exercer un contr√¥le sur le r√©seau. Il est important de noter que ces actions sont strictement √† des fins √©ducatives et ne doivent pas √™tre utilis√©es sans autorisation appropri√©e.

## R√©f√©rences

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


<details>

<summary><strong>Apprenez le hacking AWS de z√©ro √† h√©ros avec</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Autres moyens de soutenir HackTricks :

* Si vous souhaitez voir votre **entreprise annonc√©e dans HackTricks** ou **t√©l√©charger HackTricks en PDF**, consultez les [**PLANS D'ABONNEMENT**](https://github.com/sponsors/carlospolop)!
* Obtenez le [**merchandising officiel PEASS & HackTricks**](https://peass.creator-spring.com)
* D√©couvrez [**La Famille PEASS**](https://opensea.io/collection/the-peass-family), notre collection d'[**NFTs**](https://opensea.io/collection/the-peass-family) exclusifs
* **Rejoignez le** üí¨ [**groupe Discord**](https://discord.gg/hRep4RUj7f) ou le [**groupe telegram**](https://t.me/peass) ou **suivez** moi sur **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Partagez vos astuces de hacking en soumettant des PR aux d√©p√¥ts github** [**HackTricks**](https://github.com/carlospolop/hacktricks) et [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
```
