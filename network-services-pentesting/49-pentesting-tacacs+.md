# 49 - Pentesting TACACS+

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

**Try Hard Security Group**

<figure><img src="/.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

***

## Informations de base

Le protocole **Terminal Access Controller Access Control System (TACACS)** est utilis√© pour valider de mani√®re centralis√©e les utilisateurs essayant d'acc√©der aux routeurs ou aux serveurs d'acc√®s r√©seau (NAS). Sa version am√©lior√©e, **TACACS+**, s√©pare les services en authentification, autorisation et comptabilit√© (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Port par d√©faut :** 49

## Intercepter la cl√© d'authentification

Si la communication entre le client et le serveur TACACS est intercept√©e par un attaquant, la **cl√© d'authentification chiffr√©e peut √™tre intercept√©e**. L'attaquant peut alors tenter une **attaque par force brute locale contre la cl√© sans √™tre d√©tect√© dans les journaux**. S'il r√©ussit √† forcer la cl√©, l'attaquant obtient un acc√®s √† l'√©quipement r√©seau et peut d√©chiffrer le trafic en utilisant des outils comme Wireshark.

### R√©aliser une attaque MitM

Une **attaque par spoofing ARP peut √™tre utilis√©e pour r√©aliser une attaque Man-in-the-Middle (MitM)**.

### Forcer la cl√©

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) peut √™tre utilis√© pour forcer la cl√© :
```
sudo loki_gtk.py
```
If the key is successfully **bruteforced** (**usually in MD5 encrypted format)**, **we can access the equipment and decrypt the TACACS-encrypted traffic.**

### Decrypting Traffic
Une fois la cl√© correctement craqu√©e, l'√©tape suivante consiste √† **d√©crypter le trafic TACACS chiffr√©**. Wireshark peut g√©rer le trafic TACACS chiffr√© si la cl√© est fournie. En analysant le trafic d√©crypt√©, des informations telles que le **banni√®re utilis√©e et le nom d'utilisateur de l'utilisateur admin** peuvent √™tre obtenues.

En acc√©dant au panneau de contr√¥le de l'√©quipement r√©seau en utilisant les identifiants obtenus, l'attaquant peut exercer un contr√¥le sur le r√©seau. Il est important de noter que ces actions sont strictement √† des fins √©ducatives et ne doivent pas √™tre utilis√©es sans autorisation appropri√©e.

## References

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

**Try Hard Security Group**

<figure><img src="/.gitbook/assets/telegram-cloud-document-1-5159108904864449420.jpg" alt=""><figcaption></figcaption></figure>

{% embed url="https://discord.gg/tryhardsecurity" %}

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}
