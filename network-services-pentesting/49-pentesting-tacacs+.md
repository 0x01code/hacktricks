# 49 - Pentesting TACACS+

<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks swag**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou hacking-truuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>

## Basiese Inligting

Die **Terminal Access Controller Access Control System (TACACS)**-protokol word gebruik om gebruikers wat probeer om roeteryers of Netwerktoegangbedieners (NAS) te benader, sentraal te valideer. Sy opgegradeerde weergawe, **TACACS+**, skei die dienste in outentifikasie, magtiging en rekeningkunde (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Verstekpoort:** 49

## Onderskep Verifikasiesleutel

As die kommunikasie tussen die klient en TACACS-bediener deur 'n aanvaller onderskep word, kan die **versleutelde verifikasiesleutel onderskep** word. Die aanvaller kan dan 'n **plaaslike brute force-aanval teen die sleutel uitvoer sonder om in die logboeke opgespoor te word**. As die aanval suksesvol is en die sleutel gekraak word, verkry die aanvaller toegang tot die netwerktoerusting en kan die verkeer dekodeer met behulp van hulpmiddels soos Wireshark.

### Uitvoering van 'n MitM-aanval

'n **ARP-spoofing-aanval kan gebruik word om 'n Man-in-the-Middle (MitM) aanval** uit te voer.

### Brute force-aanval op die Sleutel

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) kan gebruik word om die sleutel te kraak:
```
sudo loki_gtk.py
```
As die sleutel suksesvol **bruteforced** word (**gewoonlik in MD5 versleutelde formaat)**, **kan ons toegang verkry tot die toerusting en die TACACS-versleutelde verkeer ontsluit.**

### Ontsluiting van Verkeer
Sodra die sleutel suksesvol gekraak is, is die volgende stap om die TACACS-versleutelde verkeer te **ontsluit**. Wireshark kan versleutelde TACACS-verkeer hanteer as die sleutel voorsien word. Deur die ontslote verkeer te analiseer, kan inligting soos die **banier wat gebruik word en die gebruikersnaam van die admin-gebruiker** verkry word.

Deur toegang tot die beheerpaneel van netwerktoerusting te verkry deur die verkryde geloofsbriewe, kan die aanvaller beheer oor die netwerk uitoefen. Dit is belangrik om daarop te let dat hierdie aksies slegs vir opvoedkundige doeleindes is en nie sonder behoorlike magtiging gebruik moet word nie.

## Verwysings

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


<details>

<summary><strong>Leer AWS-hacking van nul tot held met</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Ander maniere om HackTricks te ondersteun:

* As jy jou **maatskappy geadverteer wil sien in HackTricks** of **HackTricks in PDF wil aflaai**, kyk na die [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!
* Kry die [**amptelike PEASS & HackTricks-uitrusting**](https://peass.creator-spring.com)
* Ontdek [**The PEASS Family**](https://opensea.io/collection/the-peass-family), ons versameling eksklusiewe [**NFTs**](https://opensea.io/collection/the-peass-family)
* **Sluit aan by die** üí¨ [**Discord-groep**](https://discord.gg/hRep4RUj7f) of die [**telegram-groep**](https://t.me/peass) of **volg** ons op **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Deel jou haktruuks deur PR's in te dien by die** [**HackTricks**](https://github.com/carlospolop/hacktricks) en [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github-opslag.

</details>
