# 49 - TACACS+ Pentesting

<details>

<summary><strong>AWS hackleme becerilerini sıfırdan kahraman seviyesine öğrenin</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Kırmızı Takım Uzmanı)</strong></a><strong>!</strong></summary>

HackTricks'ı desteklemenin diğer yolları:

* Şirketinizi HackTricks'te **reklamınızı görmek** veya **HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'i keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi** [**HackTricks**](https://github.com/carlospolop/hacktricks) ve [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github depolarına **PR göndererek paylaşın**.

</details>

## Temel Bilgiler

**Terminal Access Controller Access Control System (TACACS)** protokolü, yönlendiricilere veya Ağ Erişim Sunucularına (NAS) erişmeye çalışan kullanıcıları merkezi olarak doğrulamak için kullanılır. Geliştirilmiş versiyonu olan **TACACS+**, hizmetleri kimlik doğrulama, yetkilendirme ve hesaplama (AAA) olarak ayırır.
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Varsayılan port:** 49

## Kimlik Doğrulama Anahtarını İntercept Etme

Eğer istemci ve TACACS sunucusu arasındaki iletişim bir saldırgan tarafından ele geçirilirse, **şifrelenmiş kimlik doğrulama anahtarı ele geçirilebilir**. Saldırgan daha sonra bu anahtar üzerinde **günlüklerde tespit edilmeden yerel bir brute-force saldırısı deneyebilir**. Anahtarı brute-force ile başarıyla kırarsa, saldırgan ağ ekipmanına erişim elde eder ve Wireshark gibi araçlar kullanarak trafiği deşifre edebilir.

### MitM Saldırısı Gerçekleştirme

Bir **ARP spoofing saldırısı, Man-in-the-Middle (MitM) saldırısı gerçekleştirmek için kullanılabilir**.

### Anahtarı Brute-force İle Kırma

Anahtarı brute-force ile kırmak için [Loki](https://c0decafe.de/svn/codename\_loki/trunk/) kullanılabilir:
```
sudo loki_gtk.py
```
Anahtar başarıyla **bruteforce** edildiğinde (**genellikle MD5 şifreli biçimde**), **donanıma erişebilir ve TACACS-şifreli trafiği çözebiliriz**.

### Trafik Çözme
Anahtar başarıyla kırıldıktan sonra, bir sonraki adım **TACACS-şifreli trafiği çözmektir**. Wireshark, anahtar sağlandığında şifreli TACACS trafiğiyle başa çıkabilir. Çözülen trafiği analiz ederek, **kullanılan banner ve yönetici kullanıcısının kullanıcı adı gibi bilgilere ulaşılabilir**.

Elde edilen kimlik bilgilerini kullanarak ağ ekipmanının kontrol paneline erişim sağlayarak, saldırgan ağ üzerinde kontrol sağlayabilir. Bu eylemlerin sadece eğitim amaçlı olduğunu ve uygun yetkilendirme olmadan kullanılmaması gerektiğini unutmamak önemlidir.

## Referanslar

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)</strong> ile sıfırdan kahraman olmak için AWS hackleme öğrenin<strong>!</strong></summary>

HackTricks'i desteklemenin diğer yolları:

* **Şirketinizi HackTricks'te reklamınızı görmek veya HackTricks'i PDF olarak indirmek** için [**ABONELİK PLANLARI**](https://github.com/sponsors/carlospolop)'na göz atın!
* [**Resmi PEASS & HackTricks ürünlerini**](https://peass.creator-spring.com) edinin
* Özel [**NFT'lerden**](https://opensea.io/collection/the-peass-family) oluşan koleksiyonumuz [**The PEASS Family**](https://opensea.io/collection/the-peass-family)'yi keşfedin
* 💬 [**Discord grubuna**](https://discord.gg/hRep4RUj7f) veya [**telegram grubuna**](https://t.me/peass) **katılın** veya **Twitter** 🐦 [**@carlospolopm**](https://twitter.com/hacktricks_live)'u **takip edin**.
* **Hacking hilelerinizi HackTricks ve HackTricks Cloud** github depolarına **PR göndererek paylaşın**.

</details>
