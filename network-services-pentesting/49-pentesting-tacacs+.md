## Informa√ß√£o B√°sica

O **Terminal Access Controller Access Control System (TACACS)** √© um protocolo de seguran√ßa que fornece valida√ß√£o centralizada de usu√°rios que est√£o tentando obter **acesso a um roteador ou NAS**. O TACACS+, uma vers√£o mais recente do protocolo TACACS original, fornece servi√ßos separados de autentica√ß√£o, autoriza√ß√£o e contabilidade (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Porta padr√£o:** 49

## Intercepta√ß√£o da chave de autentica√ß√£o

Se um atacante conseguir se colocar no meio do cliente e do servidor TACACS, **ele pode interceptar a chave de autentica√ß√£o** em forma criptografada e, em seguida, fazer uma for√ßa bruta local contra ela. Assim, voc√™ pode fazer a for√ßa bruta na chave e n√£o aparecer nos logs. E se voc√™ conseguir fazer a for√ßa bruta na chave, **voc√™ poder√° acessar o equipamento de rede e decifrar o tr√°fego** no **Wireshark**.

### MitM

Para realizar um ataque MitM, voc√™ pode usar um [ataque de spoofing ARP](../generic-methodologies-and-resources/pentesting-network/#arp-spoofing).

### For√ßa bruta na chave

Agora voc√™ precisa executar o [Loki](https://c0decafe.de/svn/codename\_loki/trunk/). Esta √© uma ferramenta especial projetada para analisar a seguran√ßa de protocolos L2/L3. Suas capacidades s√£o t√£o boas quanto as do popular **Yersinia** e √© um concorrente s√©rio para ele. Loki tamb√©m pode fazer a for√ßa bruta nas chaves TACACS. Se a chave for **for√ßada com sucesso (geralmente em formato criptografado MD5)**, **podemos acessar o equipamento e decifrar o tr√°fego criptografado do TACACS.**
```
sudo loki_gtk.py
```
<figure><img src="../.gitbook/assets/image (31) (2).png" alt=""><figcaption></figcaption></figure>

Voc√™ tamb√©m precisa especificar o caminho para o dicion√°rio para fazer a for√ßa bruta da chave criptografada. Certifique-se de desmarcar a op√ß√£o **Use Bruteforce**, caso contr√°rio, o Loki far√° a for√ßa bruta da senha sem usar o dicion√°rio.

<figure><img src="../.gitbook/assets/image (11) (2).png" alt=""><figcaption></figcaption></figure>

Agora temos que esperar um administrador fazer login no dispositivo atrav√©s do servidor TACACS. Sup√µe-se que o administrador de rede j√° tenha feito login e n√≥s, **estando no meio via ARP spoofing**, interceptamos o tr√°fego. E ao fazer isso, os hosts leg√≠timos n√£o percebem que outra pessoa interferiu em sua conex√£o.

<figure><img src="../.gitbook/assets/image (8) (2).png" alt=""><figcaption></figcaption></figure>

Agora clique no bot√£o **CRACK** e aguarde o **Loki** quebrar a senha.

<figure><img src="../.gitbook/assets/image (17) (2).png" alt=""><figcaption></figcaption></figure>

### Decrypt Traffic

√ìtimo, conseguimos desbloquear a chave, agora precisamos descriptografar o tr√°fego TACACS. Como eu disse, o Wireshark pode lidar com o tr√°fego TACACS criptografado se a chave estiver presente.

<figure><img src="../.gitbook/assets/image (28) (1).png" alt=""><figcaption></figcaption></figure>

Vemos qual banner foi usado.

<figure><img src="../.gitbook/assets/image (24) (1) (2).png" alt=""><figcaption></figcaption></figure>

Encontramos o nome de usu√°rio do usu√°rio `admin`

<figure><img src="../.gitbook/assets/image (7) (1) (1).png" alt=""><figcaption></figcaption></figure>

Como resultado, **temos as credenciais `admin:secret1234`,** que podem ser usadas para acessar o pr√≥prio hardware. **Acho que vou verificar sua validade.**

<figure><img src="../.gitbook/assets/image (19) (2).png" alt=""><figcaption></figcaption></figure>

√â assim que voc√™ pode atacar o TACACS+ e **ganhar acesso** ao painel de controle do equipamento de rede.

## Refer√™ncias

* A se√ß√£o de chave de intercepta√ß√£o foi copiada de [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* Voc√™ trabalha em uma **empresa de seguran√ßa cibern√©tica**? Voc√™ quer ver sua **empresa anunciada no HackTricks**? ou voc√™ quer ter acesso √† **√∫ltima vers√£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A Fam√≠lia PEASS**](https://opensea.io/collection/the-peass-family), nossa cole√ß√£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe suas t√©cnicas de hacking enviando PRs para o** [**reposit√≥rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>
